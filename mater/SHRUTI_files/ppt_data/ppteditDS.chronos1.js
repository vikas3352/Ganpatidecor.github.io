'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{1014:function(J,V,d){J=d(0);var h=d(17),e=d(146),m=d(660),r=d(372),v=d(261),A=d(440),w=d(158),y=d(176),u=d(175),D=d(118),F=d(105);class I{constructor(ia){this.vb=ia;this.azc=this.C3d()}BG(){return"Add-ins"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:3}HD(ia,ja){ia=new u.a(ia);ja.resultsUpdated(ia)}tRa(ia,ja,C){let pa;pa=this.vb.rH?new y.a(26):new y.a(24);pa.displayName=CommonUIStrings.l_TellMeAddinProviderTitle;
C&&this.qfl(ia.Gf,ja,pa)}qfl(ia,ja,C){const pa=[];let Z;Z=this.vb.UDj?this.vb.rH&&this.vb.TNa?F.a.xQa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1_Bolded,ia)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_1,ia):this.vb.VDj?this.vb.rH&&this.vb.TNa?F.a.xQa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2_Bolded,ia)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_2,ia):this.vb.rH&&this.vb.TNa?F.a.xQa(String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0_Bolded,
ia)):String.format(CommonUIStrings.l_TellMeLaunchAddinDialogButtonText_0,ia);this.vb.eja?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",Z)),D.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",ia))):(pa.push(appChrome.actions.setControlLabel("LaunchAddinDialogFromTellMe",Z)),pa.push(appChrome.actions.setButtonCommandValueId("LaunchAddinDialogFromTellMe",ia)),appChrome.api.dispatch(pa));C.Qv(new w.a("LaunchAddinDialogFromTellMe",
27));ja.Is(C)}C3d(){const ia=[];this.vb.VSc&&Array.add(ia,"Addin");return ia}}Object(J.a)(I,"AddinStoreResultsProvider",null,[693]);var H=d(950),L=d(325),E=d(373),aa=d(951),Q=d(982),O=d(952),T=d(439),K=d(25),X=d(33),P=d(106);d.d(V,"a",function(){return ea});class ea{constructor(ia,ja,C){this.hSb=this.Iyc=this.Jyc=this.Hyc=!1;this.KH=null;this.vR=-1;this.W2a=this.ySb=null;this.GSb="";this.m1a=0;this.vb=ia;const pa=F.a.Oja();this.tLa=ja||[];this.$h=K.AFrameworkApplication.Ge;this.Uwf=ia.cze;this.Kyc=
ia.bze;this.XDd=pa&&this.nhb();this.YDd=pa&&this.ohb();this.uXh=pa&&this.phb();this.$Dd=this.lIb();this.Wwf=this.kIb();ia.vQe&&F.a.aNe(ia)&&(this.ySb=new Q.a(ia),this.Hyc=ia.wnc,this.Jyc=ia.xnc,this.Iyc=ia.ZSa,this.hSb=this.Hyc&&this.Nx("File")||this.Jyc&&this.Nx("People")||this.Iyc&&this.Nx("Notes"));this.Gyc=this.Fbl();this.Myc=ia.tfc;this.ZDd=this.Tbl();this.Twf=this.Ebl();this.Aya=this.zhj();this.JYe=new H.a(ia);this.nPh=new aa.a(ia);this.WYh=new O.a(ia);this.hJh=new I(ia);this.ARb=C;this.rDd=
new m.a;this.Myc&&(this.JYe=new H.a(ia))}Nx(ia){return Array.contains(this.tLa,ia)?!0:!1}BG(){return"TellMeService"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:this.Nx("Command")||this.Nx("Recommended")?2:3}whj(ia){let ja="";if(!ia&&this.Nx("Command")&&this.vb.Yae){ja+="CommandSearch_DLIS,";var C=this.vb.Qxh;0<C.length&&(ja+=C+",")}ia&&this.Nx("Recommended")&&this.Kyc&&(C=this.vb.Rxh,0<C.length&&(ja+=C+","));!ia&&this.Nx("Help")&&(ia=this.vb.Pxh,0<ia.length&&(ja+=ia+","));0<ja.length&&(ja=ja.substr(0,
ja.length-1));return ja}HD(ia,ja,C,pa=e.a.tellMe,Z=null){const qa=new u.a(ia);C=F.a.pN(ia);if(this.hSb&&(!this.m1a||window.performance.now()-this.m1a>=F.a.pmd)){var ya=this.rDd.Ahj();if(ya)this.m1a=window.performance.now(),ya.then(ma=>{this.GSb=ma},ma=>{D.TellMeActor.instance.Cd.onError("TellMeServiceProvider:issueQuery","tellMeServiceToken promise rejected: "+ma)});else if(D.TellMeActor.instance.Cd)D.TellMeActor.instance.Cd.onError("TellMeServiceProvider:IssueQuery","undefined token promise")}var Ka=
this.hSb&&!!this.GSb;ya=Ka||C&&this.Nx("Recommended")&&this.Kyc;Ka=Ka||!C&&(this.Uwf&&this.Nx("Command")||this.XDd&&this.Nx("Answer")||this.YDd&&this.Nx("Definition")||this.Wwf&&this.Nx("Image")||this.Myc&&this.Nx("Help")||this.$Dd&&this.Nx("WolframAnswer")||this.ZDd&&this.Nx("Template")||this.Twf&&this.Nx("Addin"));if(ya||Ka)if(this.W2a=pa,pa={"Content-Type":"application/json",Accept:"application/json"},pa["X-Office-Version"]=K.AFrameworkApplication.buildVersion,pa["X-Office-Application"]=K.AFrameworkApplication.fa.Ga("Application"),
pa["X-Office-Platform"]="WAC",pa["X-TellMe-SqmUserId"]=K.AFrameworkApplication.fa.Ga("LoggableUserId")||"",pa["X-TellMe-SessionId"]=D.TellMeActor.instance.sPc(),this.GSb&&(pa.Authorization="Bearer "+this.GSb),ya=this.whj(C),0<ya.length&&(pa["X-TellMe-Flights"]=ya),ya=[],!C&&this.Nx("Answer")&&this.XDd&&(Z?Array.contains(Z,9):1)&&Array.add(ya,"Answer"),!C&&this.Nx("Command")&&this.Uwf&&!L.CommandResultsUtility.m$d(ia.Gf)&&(Z?Array.contains(Z,17):1)&&Array.add(ya,"Command"),!C&&this.Nx("Definition")&&
this.YDd&&(Z?Array.contains(Z,10):1)&&Array.add(ya,"Definition"),!C&&this.Nx("Help")&&this.Myc&&(Z?Array.contains(Z,8):1)&&Array.add(ya,"Help"),!C&&this.Nx("WolframAnswer")&&this.$Dd&&(Z?Array.contains(Z,12):1)&&Array.add(ya,"WolframAnswer"),C&&this.Nx("Recommended")&&this.Kyc&&!D.TellMeActor.instance.opc&&(Z?Array.contains(Z,18):1)&&Array.add(ya,"Recommended"),!C&&this.Nx("Image")&&this.Wwf&&(Z?Array.contains(Z,19):1)&&Array.add(ya,"Image"),this.GSb&&this.hSb&&(Z?Array.contains(Z,14)||Array.contains(Z,
15)||Array.contains(Z,20):1)&&(this.ySb.b5(),this.Hyc&&this.Nx("File")&&Array.add(ya,"File"),this.Jyc&&this.Nx("People")&&Array.add(ya,"People"),this.Iyc&&this.Nx("Notes")&&Array.add(ya,"Notes")),!C&&this.Nx("Template")&&this.ZDd&&(Z?Array.contains(Z,23):1)&&Array.add(ya,"Template"),!C&&this.Nx("Addin")&&this.Twf&&(Z?Array.contains(Z,24):1)&&Array.add(ya,"Addin"),ya.length){pa["X-TellMe-SuggestionTypes"]=ya.join(",");pa["X-TellMe-Culture"]=K.AFrameworkApplication.uiCulture;pa["X-TellMe-ProcessSessionId"]=
K.AFrameworkApplication.userSessionId;var Da=this.KH=P.a.create().toString();pa["Client-Request-Id"]=Da;var la=window.performance.now();this.Pha();this.vR=window.setTimeout(()=>{if(Da===this.KH){this.KH="";this.vR=-1;ja.resultsUpdated(qa);const ma={};ma[r.a.provider]=this.BG();ma[r.a.afb]=ia.pXa;D.TellMeActor.instance.Cd.iH(v.a.timedOut,this.ARb,ma)}},this.ARb);this.$h.yj(this.Aya,2,this.yhj(ia.Gf),pa,!1,0,ma=>{this.eeb(ma,ia,ja,Da,la,Z)},ma=>{this.Udb(ma,ia,ja,Da,la)},null,null,!1,4E3,6E3)}else D.TellMeActor.instance.Cd.onError("IssueQuery",
"Empty Online Provider List: No online calls by provider"),ja.resultsUpdated(qa);else ja.resultsUpdated(qa)}Pha(){-1!==this.vR&&(window.clearTimeout(this.vR),this.vR=-1)}eeb(ia,ja,C,pa,Z,qa){const ya=new u.a(ja);if(pa===this.KH){this.Pha();D.TellMeActor.instance.Cd.K4(ja.Gf.length,this.tLa.join(","),ia.data.Le.toString(),Math.round(window.performance.now()-Z),T.a.tellMe,!0,A.a.xsa);pa=ia.data.Sd;ia=null;try{ia=X.b(pa)}catch(ta){D.TellMeActor.instance.Cd.onError("OnSuccessCallBack","Exception occured while deserializing response:"+
ta);return}pa=F.a.pN(ja);if("Groups"in ia&&ia.Groups){var Ka=ia.Groups;for(var Da of Ka)if("GroupType"in Da&&"Suggestions"in Da&&Da.Suggestions)if("Commands"===Da.GroupType&&(qa?Array.contains(qa,17):1)||"Recommended"===Da.GroupType&&(qa?Array.contains(qa,18):1)){var la=(Ka="Recommended"===Da.GroupType)?"DLIS":"NaiveBayes";"Source"in Da&&Da.Source&&(la=Da.Source);var ma=Da.Suggestions;new h.a;var Ea=[];for(const ta of ma)this.YRj(ta)&&(ma=ta.Type,("Command"===ma||Ka&&"Recommended"===ma)&&Ea.push(new E.a(ta.CommandId,
ta.Score)));L.CommandResultsUtility.zXc(Ea,!ja.Gf.trim().length,Da.GroupType,la);la=D.TellMeActor.instance.HR;ma=[];for(const ta of Ea)Ka&&la&&la.RPd(ta.commandId)||ma.push(ta);Ea=L.CommandResultsUtility.KOc(ja,ma,this.vb,null,null,null,Ka?18:17,0);0<Ea.results.length&&(this.W2a!==e.a.contextMenu&&(Ea.displayName=Ka?CommonUIStrings.l_TellMeTryCommandTitle:CommonUIStrings.l_TellMeCommandProviderTitle),ya.Is(Ea))}else if("Answer"===Da.GroupType){ma=Da.Suggestions;Ka=null;Ea=2147483647;la="";for(const ta of ma)if(this.VRj(ta))if(la=
ta.Type,ma=this.Ptb(la),"Answer"===la&&this.XDd){Ka=this.jVf(la,ta,ja.Gf);break}else ma&&ma<Ea&&(Ea=ma,Ka=this.jVf(la,ta,ja.Gf));Ea=F.a.fXk(ja.Gf,la);Ka&&(qa?Array.contains(qa,Ka.type):1)&&(la=[],this.Gyc?this.vb.eja?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ka.value,Ka.jJ)),D.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(Ka.value,Ka.description)),D.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(Ka.value,
Ea))):(la.push(appChrome.actions.setControlLabel(Ka.value,Ka.jJ)),la.push(appChrome.actions.updateCompoundButtonDescription(Ka.value,Ka.description)),la.push(appChrome.actions.setCompoundButtonCommandValueId(Ka.value,Ea)),appChrome.api.dispatch(la)):this.vb.eja?(D.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Ka.value,Ka.jJ+" - "+Ka.description)),D.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ka.value,Ea))):(la.push(appChrome.actions.setControlLabel(Ka.value,
Ka.jJ+" - "+Ka.description)),la.push(appChrome.actions.setButtonCommandValueId(Ka.value,Ea)),appChrome.api.dispatch(la)),Ea=this.RCi(Ka.type),Ea.Qv(Ka),ya.Is(Ea))}else"Help"===Da.GroupType&&Da.Suggestions.length&&(qa?Array.contains(qa,8):1)?this.Myc&&(Ka=this.JYe.tRa(ja,Da.Suggestions))&&0<Ka.results.length&&ya.Is(Ka):"Template"===Da.GroupType&&(qa?Array.contains(qa,23):1)?(Ka=Da.Suggestions)&&0<Ka.length&&this.WYh.tRa(ja,ya,Ka):"Addin"===Da.GroupType&&(qa?Array.contains(qa,24):1)?(Ka=Da.Suggestions)&&
0<Ka.length&&this.hJh.tRa(ja,ya,Ka):"Substrate"===Da.GroupType&&this.hSb&&"Type"in Da&&("File"===Da.Type&&this.Hyc&&(qa?Array.contains(qa,15):1)?(Ka=this.ySb.Mag(Da.Suggestions,pa,this.W2a))&&0<Ka.results.length&&ya.Is(Ka):"People"===Da.Type&&this.Jyc&&(qa?Array.contains(qa,14):1)?(Ka=this.ySb.aeg(Da.Suggestions,pa,this.W2a))&&0<Ka.results.length&&ya.Is(Ka):"Notes"===Da.Type&&this.Iyc&&(qa?Array.contains(qa,14):1)&&(Ka=this.ySb.udg(Da.Suggestions,pa,ja))&&0<Ka.results.length&&ya.Is(Ka));else D.TellMeActor.instance.Cd.onError("OnSuccessCallBack",
"GroupType"in Da?"Invalid group suggestions found for "+Da.GroupType:"Invalid group found")}if(ia.Intents){Da=ia.Intents;for(const ta of Da)this.Vce(ta)&&("Image"===ta.GroupType&&ta.ConfidenceScore>ta.ConfidenceThreshold&&(qa?Array.contains(qa,19):1)?this.nPh.tRa(ja,ya,0,ta):"Commands"===ta.GroupType&&ta.ConfidenceScore<ta.ConfidenceThreshold&&(qa?Array.contains(qa,17):1)&&(Da=new y.a(17),ya.Is(Da)))}C.resultsUpdated(ya);D.TellMeActor.instance.Cd.K4(ja.Gf.length,this.tLa.join(","),"",Math.round(window.performance.now()-
Z),"",!0,A.a.provider)}}Udb(ia,ja,C,pa,Z){const qa=new u.a(ja);pa===this.KH&&(this.Pha(),D.TellMeActor.instance.Cd.K4(ja.Gf.length,this.tLa.join(","),ia.data.Le.toString(),Math.round(window.performance.now()-Z),T.a.tellMe,!1,A.a.xsa));C.resultsUpdated(qa)}Ptb(ia){switch(ia){case "Entity":return this.uXh?3:0;case "Definition":return this.YDd?5:0;case "WolframAnswer":return this.$Dd?2:0;default:return 0}}jVf(ia,ja,C){switch(ia){case "Answer":return new w.a(this.Gyc?"AnswerForSearch":"AnswerForSearchSingleLine",
0,""===ja.Title?C:ja.Title,ja.Description,0);case "Entity":return new w.a(this.Gyc?"AnswerForSearch":"AnswerForSearchSingleLine",2,""===ja.Title?C:ja.Title,ja.Description,0);case "Definition":return new w.a(this.Gyc?"AnswerForSearch":"AnswerForSearchSingleLine",1,""===ja.Title?C:ja.Title,ja.Description,0);case "WolframAnswer":return new w.a("WolframForSearch",3,""===ja.Title?C:ja.Title,ja.Description,0);default:return null}}RCi(ia){switch(ia){case 0:return new y.a(9,CommonUIStrings.l_TellMeAnswersTitle);
case 2:return new y.a(11,CommonUIStrings.l_TellMeEntityTitle);case 1:return new y.a(10,CommonUIStrings.l_TellMeDefinitionTitle);case 3:return new y.a(12,CommonUIStrings.l_TellMeAnswersTitle);case 12:return new y.a(19,this.vb.gIb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);default:return null}}VRj(ia){return"Type"in ia&&!!ia.Type&&""!==ia.Type&&"Description"in ia&&!!ia.Description&&""!==ia.Description}YRj(ia){return"Type"in ia&&!!ia.Type&&""!==ia.Type&&"CommandId"in ia&&
!!ia.CommandId&&""!==ia.CommandId&&"Score"in ia&&!!ia.Score}Vce(ia){if("GroupType"in ia&&ia.GroupType&&"ConfidenceScore"in ia&&"ConfidenceThreshold"in ia)return!0;D.TellMeActor.instance.Cd.onError("IsValidIntentGroup","Invalid intents found");return!1}yhj(ia){const ja=F.a.yzg(ia),C={};C.Query=ia;ja&&this.Kyc&&(this.yLj()?C.UserActionEvents=D.TellMeActor.instance.SAf:(C.CommandClickedEvents=D.TellMeActor.instance.Yrd,C.CommandActionEvents=D.TellMeActor.instance.M_e),C.TellMeCommandClickMruEvents=D.TellMeActor.instance.Kgf,
C.ContentType=D.TellMeActor.instance.nHc);this.ZDd&&(ia={},ia.Application=this.vb.application,C.TemplateInfo=ia);return X.c(C)}nhb(){return!!this.vb&&this.vb.nhb||!!K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.jb.nhb}ohb(){return!!this.vb&&this.vb.ohb||!!K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.jb.ohb}phb(){return!!this.vb&&this.vb.phb||!!K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.jb.phb}lIb(){return!!this.vb&&this.vb.lIb||!!K.AFrameworkApplication.Aa&&K.AFrameworkApplication.Aa.jb.lIb}kIb(){return!!this.vb&&
(this.vb.kIb||this.vb.rH)}Fbl(){return!!this.vb&&!this.vb.YSa}Tbl(){return!!this.vb&&this.vb.q6b}Ebl(){return!!this.vb&&this.vb.WDj&&this.vb.TDj}Yzg(){return!!K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceEdogEndpointOverride",!1)}Zzg(){return!!K.AFrameworkApplication.fa&&K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceProdEndpointOverride",!1)}yLj(){return!!K.AFrameworkApplication.fa&&
K.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.NewZeroSearchTermModel",!1)}zhj(){if(!K.AFrameworkApplication.fa)return"";if(this.Zzg())return K.AFrameworkApplication.fa.Ga("TellMeServiceProdEndpointForSearch");if(this.Yzg())return K.AFrameworkApplication.fa.Ga("TellMeServiceEdogEndpointForSearch");if(F.a.F$d())return K.AFrameworkApplication.fa.Ga("TellMeServiceIntEndpointForSearch");let ia=K.AFrameworkApplication.fa.Ga("TellMeServiceSearchEndpoint");ia&&""!==ia||(ia=
K.AFrameworkApplication.Oxh);return ia}static GVf(ia,ja){if(ja)return new ea(ia,["Command","Recommended"],ia.o5i);ja=F.a.Oja()?"Answer Definition Help WolframAnswer Image File People Notes Template Addin".split(" "):"Help WolframAnswer File People Notes Template Addin".split(" ");return new ea(ia,ja,ia.Zfg)}}Object(J.a)(ea,"TellMeServiceProvider",null,[693])},105:function(J,V,d){J=d(0);var h=d(15);class e{constructor(){this.userId=this.email=this.displayName=null}}Object(J.a)(e,"InsertMentionParameters",
null,[]);class m{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(J.a)(m,"InsightsParameters",null,[]);var r=d(946),v=d(947),A=d(948),w=d(949),y=d(25),u=d(438),D=d(437),F=d(33),I=d(54),H=d(45),L=d(123);d.d(V,"a",function(){return E});class E{static get tCj(){return"Insights_16x16x32"}static get JTi(){return"Find_16x16x32"}static get t5g(){return"-Parameterized"}static get TOe(){return"Parameterized"}static get Ymd(){return"bTryQuery"}static get $Te(){return"TellMeSuggestion_"}static get TAh(){return"bTryQueryAlternate"}static get CRe(){return"MenuTellMe"}static get Vwk(){const aa=
{},Q=[];Array.add(Q,{Term:{PeopleType:"Person"}});aa.And=Q;return aa}static hEi(aa){return aa+E.t5g}static getParameter(aa){let Q="",O="";if(aa)for(let T=0;T<aa.E4f;++T)"Type"===aa.W_d(T)?Q=aa.getValue(T):"Value"===aa.W_d(T)&&(O=aa.getValue(T));return new h.a(Q,O)}static ERd(aa){aa=Object.assign(new m,{neighborhood:aa,mentionStart:0,mentionLength:aa.length});return F.c(aa)}static pVf(aa,Q,O){aa=Object.assign(new e,{displayName:aa,email:Q,userId:O});return F.c(aa)}static VOa(aa,Q,O=null){aa=Object.assign(new D.a,
{neighborhood:aa,mentionStart:0,mentionLength:aa?aa.length:0});Q=Object.assign(new u.a,{selection:aa,userIntent:null,entryPoint:Q,launchData:O});return F.c(Q)}static fXk(aa,Q){return E.VOa(aa,E.gXk(Q))}static gXk(aa){switch(aa){case "Answer":return 3;case "Definition":return 2;case "DocFindResult":return 15;case "Entity":return 16;case "InsightsResult":return 1;default:return 0}}static awg(){return!!y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.ka("IsGoLocalEnvironment")}static D9a(){const aa=
y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ga("SovereignEnvironmentName"):null;return!!aa&&0<aa.length}static isEnterpriseUser(){const aa=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ga("HostAuthType"):null;return!!aa&&"aad"===aa.toLowerCase()||"external"===aa&&E.F$d()}static bNe(aa){return aa.Zml&&!E.D9a()}static Yyg(){const aa=y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Ga("UiHostIntegrationType"):"";return!!y.AFrameworkApplication.fa&&"UnifiedUiHostTeams"===aa&&y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UnifiedAppsShowSearchInHeader",
!1)}static aNe(aa){return aa.Rxa&&aa.CSi&&(aa.xnc||aa.wnc||aa.ZSa)&&!E.Yyg()&&E.isEnterpriseUser()&&!E.D9a()}static Oja(){return y.AFrameworkApplication.fa?y.AFrameworkApplication.wxa||y.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane"):y.AFrameworkApplication.wxa}static pN(aa){return!aa||E.yzg(aa.Gf)}static yzg(aa){return!aa||!aa.trim().length}static Hmd(aa){if(!aa)return 0;const Q=Math.pow(10,5);return Math.round(aa*Q)/Q}static Kol(){var aa=new Date;return aa?new Date(aa.getUTCFullYear(),
aa.getUTCMonth(),aa.getUTCDate(),aa.getUTCHours(),aa.getUTCMinutes(),aa.getUTCSeconds(),aa.getUTCMilliseconds()):null}static c4d(aa){return(E.Kol().getTime()-(new Date(aa)).getTime())/1E3}static Vzg(aa){const {InsightsMenuItemFactory:Q}=d(945);switch(aa){case r.a.t6d:case v.a.a6f:case Q.jsg:case A.a.eXg:case "FindParameterized":case "FindWithMatchesParameterized":case "AnswerForSearch":case "AnswerForSearchSingleLine":case "WolframForSearch":case "LearningForSearch":case "ImageForSearch":case "TellMeFeedback":case "TemplateForSearch":case "LaunchAddinDialogFromTellMe":return!0}return aa.startsWith(E.Ymd)||
aa.startsWith(E.$Te)||aa.startsWith(E.TAh)||aa.startsWith("PeopleSuggestion")||aa.startsWith("FileSuggestion")||aa.startsWith("FindInDocumentSuggestion")||aa.startsWith("NotesSuggestion")||aa.startsWith("OnenoteNotesSuggestion")||aa.startsWith("SmartLookupFromTellMe")||aa.startsWith("GetHelpFromTellMe")||aa.startsWith("GetHelpWithDescriptionFromTellMe")||aa.startsWith("AddinSuggestion")||aa.startsWith("OfficeScripts")?!0:!1}static q0d(aa,Q){const O=[];Array.add(O,new w.a(400,aa));Array.add(O,new w.a(200,
Q));aa={};aa.parts=O;return JSON.stringify(aa)}static xQa(aa){const Q=aa.indexOf("<b0>"),O=aa.lastIndexOf("</b0>"),T=[];Array.add(T,new w.a(400,aa.substring(0,Q)));Array.add(T,new w.a(600,aa.substring(Q+4,O)));Array.add(T,new w.a(400,aa.substring(O+5,aa.length)));aa={};aa.parts=T;return JSON.stringify(aa)}static nhg(aa){const Q=E.c4d(aa);return 60>Q?CommonUIStrings.l_TimeSince_SecsAgo:3600>Q?String.format(CommonUIStrings.l_TimeSince_MinsAgo,Math.floor(Q/60).toString()):86400>Q?String.format(CommonUIStrings.l_TimeSince_HoursAgo,
Math.floor(Q/3600).toString()):172800>Q?CommonUIStrings.l_TimeSince_Yesterday:String.format(CommonUIStrings.l_TimeSince_Date,(new Date(aa)).localeFormat("MMMM dd, yyyy"))}static D1i(aa){const Q=Array(aa.length);for(let O=0;O<aa.length;O++)Q[O]=aa[O].commandId;return Q}static F$d(){if("Dev Box"===y.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse"))return!0;let aa=y.AFrameworkApplication.fa.Ga("UserPrincipalName");aa=L.b(aa)?"":H.a.wg(aa);const Q=y.AFrameworkApplication.fa.Kw("TellMeIntEnabledForFeatureCrew")?
y.AFrameworkApplication.fa.XB("TellMeIntEnabledForFeatureCrew"):[];return 0<=Array.indexOf(Q,aa)&&"inner"===y.AFrameworkApplication.fa.Ga("Microsoft365Ring")}static S6i(aa){switch(aa.toLowerCase()){case "pptx":case "ppt":case "pot":case "ppa":case "pps":case "pptm":case "odp":case "ppsx":case "ppsm":case "potx":case "potm":return"SaveAsPowerPointPotx_20";case "docx":case "doc":case "docm":case "dot":case "dotx":case "odt":case "dotm":return"SaveAsWordDocx_20";case "xlsx":case "xls":case "xlb":case "xlc":case "xlsb":case "xlsm":case "xlt":case "odc":case "ods":return"SaveAsExcelXlsx_20";
case "pdf":return"PdfFile_32";case "one":case "onepkg":return"OneNote_32";case "vsd":case "vsdx":case "vss":case "vst":case "vdx":case "vtx":case "vsx":case "vstx":case "vssm":case "vdw":case "vsdm":case "vssx":case "vstm":case "vsw":return"Visio_32"}return""}static Vw(){return I.a.US&&!I.a.Nj}}E.pmd=9E5;Object(J.a)(E,"TellMeUtils",null,[])},1098:function(J,V,d){d.r(V);d.d(V,"SurfaceStringTokenStringGenerator",function(){return e});J=d(0);var h=d(538);class e extends h.a{constructor(m){super(m);this.Ia=
m}apply(m,r,v,A,w,y,u){null==y&&(y=m.uhg(w,r));u=h.a.xEf(m,y,this.Ia.score,v,A,u);return{joc:y,wVb:u}}}e.xVb=0;Object(J.a)(e,"SurfaceStringTokenStringGenerator",h.a,[])},1099:function(J,V,d){d.r(V);d.d(V,"QueryTokenStringGenerator",function(){return m});J=d(0);var h=d(538),e=d(76);class m extends h.a{constructor(r){super(r);this.Ia=r}apply(r,v,A,w,y,u,D){v=this.Ia.query.load(v,null);y=0;let F=null;this.Ia.query.iU===e.Annotations.Bfa?v&&(F=this.Ia.name):((F=this.Ia.name)&&(F+="_"),F+=this.Ia.annotations.a1(this.Ia.query.iU,
v));null!=F&&(y=h.a.xEf(r,F,this.Ia.score,A,w,y));return{joc:u,wVb:D+y}}}m.xVb=1;Object(J.a)(m,"QueryTokenStringGenerator",h.a,[])},1100:function(J,V,d){d.r(V);d.d(V,"FuzzyMatchTokenStringGenerator",function(){return e});J=d(0);var h=d(538);class e extends h.a{constructor(m){super(m);this.Ia=m}apply(m,r,v,A,w,y,u){null==y&&(y=m.uhg(w,r));m=this.Ia.p2f.R_j(y);if(this.Ia.I3g)for(var D of m)if(!D.uG&&D.aLc)return{joc:y,wVb:u};D=0;for(const F of m)if(F.uG&&!({uMd:D}=this.yIf(F,!0,v,A,D)).returnValue)return{joc:y,
wVb:u};if(this.Ia.Vng)for(const F of m)if(!({uMd:D}=this.yIf(F,!1,v,A,D)).returnValue)break;return{joc:y,wVb:u}}yIf(m,r,v,A,w){let y;r?(r=0,y=m.aLc?1:0):(r=m.aLc?1:0,y=m.count-r);for(let u=0;u<y;++u)if(h.a.yEf(m.jQa+r+u,this.Ia.score,v,A),++w,0<this.Ia.$te&&w>=this.Ia.$te)return{returnValue:!1,uMd:w};return{returnValue:!0,uMd:w}}}e.xVb=2;Object(J.a)(e,"FuzzyMatchTokenStringGenerator",h.a,[])},1108:function(J,V,d){d.r(V);J=d(0);var h=d(301),e=d(17),m=d(15),r=d(1166),v=d(176);class A{constructor(E,
aa,Q,O=0){this.bjg=E;this.groupType=aa;this.V4d=O;this.Zjc=Q}}Object(J.a)(A,"SortingGroup",null,[]);class w{constructor(E,aa,Q,O){this.order=E;this.P7a=aa;this.ylj=Q;this.groupType=O}}Object(J.a)(w,"SortingProp",null,[]);var y=d(118),u=d(146),D=d(105),F=d(123);class I{constructor(E,aa){this.ZPg={};this.YPg={};this.uPg=this.ETg=1;this.pLf(E,aa)}uhl(E,aa,Q){var O=D.a.pN(Q)?this.ZPg:this.YPg;Q=new e.a;for(var T of aa)aa=Object(r.a)(w,O[h.a[T.groupType].toLowerCase()]),F.b(aa)||Q.add(new m.a(aa,T));Q.Sc((X,
P)=>X.key.order<P.key.order?-1:1);Array.clear(E);T=y.TellMeActor.instance.mP;for(aa=0;aa<Q.count;){O=Q.ga(aa).key.P7a;var K=Q.ga(aa).value;const X=new v.a(Q.ga(aa).key.groupType);F.b(T)||T.Location===u.a.contextMenu||(X.displayName=Q.ga(aa).key.ylj);for(const P of K.results)X.Qv(P);for(K=++aa;K<Q.count&&Q.ga(K).key.P7a===O;)this.VHd(X,Q.ga(K).value),K=++aa;E.push(X)}}Eyl(E,aa){this.uPg=this.ETg=1;this.pLf(E,aa)}pLf(E,aa){this.kuh(E);for(var Q=0;Q<E.length;Q++){let O=E[Q];for(const T of O.Zjc)this.$1h(T,
Q,O.bjg,O.groupType)}this.kuh(aa);for(E=0;E<aa.length;E++){Q=aa[E];for(const O of Q.Zjc)this.Z1h(O,E,Q.bjg,Q.groupType)}}kuh(E){E.sort((aa,Q)=>Object(r.a)(A,aa).V4d>Object(r.a)(A,Q).V4d?-1:1)}$1h(E,aa,Q,O){this.ZPg[h.a[E].toLowerCase()]=new w(this.ETg++,aa,Q,O)}Z1h(E,aa,Q,O){this.YPg[h.a[E].toLowerCase()]=new w(this.uPg++,aa,Q,O)}VHd(E,aa){for(let Q=0;Q<aa.results.length;Q++)E.Qv(aa.results[Q])}}Object(J.a)(I,"BaseGroupingSorter",null,[]);class H{constructor(){this.t6c=[new A(CommonUIStrings.l_TellMeRecentlyUsedTitleV2,
4,[4,2]),new A(CommonUIStrings.l_TellMeCommandProviderTitle,7,[18,16,7]),new A(CommonUIStrings.l_TellMeSuggestionsProviderTitle,30,[15,14,19,3]),new A("",13,[13]),new A("",22,[22])];this.z3c=[new A(CommonUIStrings.l_TellMeCommandProviderTitle,28,[17,0,1,8,25]),new A(CommonUIStrings.l_TellMeSuggestedSearchesProviderTitle,29,[2,19,23,26]),new A(CommonUIStrings.l_TellMePotentialMatchesProviderTitle,30,[15,14,20,9,12,10,11,24]),new A("",13,[13]),new A("",22,[22])];this.sJg=new I(this.t6c,this.z3c)}Bmc(E,
aa,Q,O=null,T=null){let K=!1;if(O){for(const X of D.a.pN(Q)?this.t6c:this.z3c)this.iJk(X,O);K=!0}if(T){for(const X of D.a.pN(Q)?this.t6c:this.z3c)this.Fyl(aa,X,T);K=!0}K&&this.sJg.Eyl(this.t6c,this.z3c);this.sJg.uhl(E,aa,Q)}iJk(E,aa){const Q=new e.a;for(var O of E.Zjc){const T=aa[h.a[O].toLowerCase()];Q.add(new m.a(F.b(T)?Number.MAX_VALUE:T,O))}if(Q.count){Q.Sc((T,K)=>T.key<K.key?-1:1);aa=Array(Q.count);for(O=0;O<Q.count;O++)aa[O]=Q.ga(O).value;E.Zjc=aa}}Fyl(E,aa,Q){let O=0;for(const T of aa.Zjc)if(h.a[T].toLowerCase()in
Q&&Q[h.a[T].toLowerCase()])for(const K of E)if(K.groupType===T){O+=Q[h.a[T].toLowerCase()];break}aa.V4d=O}}Object(J.a)(H,"SimplifiedGroupingSorter",null,[]);d.d(V,"GroupsPlacementInfo",function(){return L});class L{constructor(E){this.XPg={};this.VPg={};this.WPg={};this.$Pg={};this.fre={};this.sQg=this.lbk=this.D$j=this.bak=1;this.pRg=null;this.Tx=E;this.ohi();this.Qyk();this.khi();this.tgi();E.rH&&(this.pRg=new H)}FB(E){this.XPg[h.a[E].toLowerCase()]=this.bak++}YE(E,aa){this.VPg[h.a[E].toLowerCase()]=
aa}Vpa(E){this.WPg[h.a[E].toLowerCase()]=this.D$j++}XR(E){this.$Pg[h.a[E].toLowerCase()]=this.lbk++}wy(E){this.fre[h.a[E].toLowerCase()]=this.sQg++}ohi(){const E=!!this.Tx&&this.Tx.YSa,aa=!!this.Tx&&this.Tx.tfc,Q=!!this.Tx&&this.Tx.ZSa,O=!!this.Tx&&this.Tx.Kce&&!D.a.D9a(),T=!!this.Tx&&this.Tx.q6b,K=!!this.Tx&&this.Tx.VSc,X=!!this.Tx&&this.Tx.dbe;this.FB(4);this.FB(18);this.FB(16);this.FB(7);this.FB(17);this.FB(0);this.FB(1);X&&this.FB(25);T&&this.FB(23);E||this.FB(2);E&&!aa||this.FB(8);this.FB(15);
Q&&this.FB(20);this.FB(14);this.FB(9);this.FB(12);this.FB(10);this.FB(11);E&&this.FB(2);E&&!aa&&this.FB(8);this.FB(19);K&&this.FB(24);this.FB(21);this.FB(13);O&&this.FB(22)}Qyk(){this.YE(21,1);this.YE(4,3);this.YE(18,3);this.YE(16,3);this.YE(7,3);this.YE(17,5);this.YE(0,5);this.YE(1,1);this.YE(25,2);this.YE(2,1);this.YE(8,2);this.YE(15,3);this.YE(14,2);this.YE(24,3);this.YE(9,1);this.YE(12,1);this.YE(10,1);this.YE(11,1);this.YE(19,1);this.YE(23,1);this.YE(13,1);this.YE(20,2);this.YE(22,1)}khi(){this.Vpa(4);
this.Vpa(0);this.Vpa(17);this.Vpa(7);this.Vpa(16);this.Vpa(18);this.Vpa(15);this.Vpa(20);this.Vpa(8);this.Vpa(14)}tgi(){this.XR(14);this.XR(10);this.XR(12);this.XR(9);this.XR(11);this.XR(20);this.XR(15);this.XR(8);this.XR(2);this.XR(1);this.XR(24);this.XR(7);this.XR(18);this.XR(16);this.XR(17);this.XR(0);this.XR(4)}WVk(){this.fre={};this.sQg=1}wdj(E,aa,Q){this.WVk();const O=!!this.Tx&&this.Tx.YSa,T=!!this.Tx&&this.Tx.tfc,K=!!this.Tx&&this.Tx.ZSa,X=!!this.Tx&&this.Tx.Kce&&!D.a.D9a(),P=!!this.Tx&&this.Tx.q6b,
ea=!!this.Tx&&this.Tx.VSc,ia=!!this.Tx&&this.Tx.dbe;E=E&&T;this.wy(4);this.wy(18);this.wy(16);this.wy(7);this.wy(17);this.wy(0);this.wy(1);ia&&this.wy(25);P&&this.wy(23);O&&!T||!E||this.wy(8);aa&&this.wy(15);O||this.wy(2);ea&&this.wy(24);Q&&this.wy(14);O&&!T||E||this.wy(8);aa||this.wy(15);K&&this.wy(20);Q||this.wy(14);this.wy(9);this.wy(12);this.wy(10);this.wy(11);O&&this.wy(2);O&&!T&&this.wy(8);this.wy(19);this.wy(21);this.wy(13);X&&this.wy(22);return this.fre}xG(){return this.Tx}}Object(J.a)(L,
"GroupsPlacementInfo",null,[])},1111:function(J,V,d){d.r(V);J=d(0);var h=d(695),e=d(440),m=d(301),r=d(1014),v=d(439);class A{constructor(L="",E="",aa="",Q=-99999,O=-1,T=0){this.Type=this.Description=this.Title=null;this.Count=this.Age=this.Score=0;this.Title=L?L:"";this.Description=E?E:"";this.Type=aa?aa:"";this.Score=Q;this.Age=O;this.Count=T}}Object(J.a)(A,"Suggestion",null,[]);class w{constructor(L,E){this.GroupType=this.Suggestions=null;this.Suggestions=L;this.GroupType=E}}Object(J.a)(w,"SuggestionGroup",
null,[]);class y{}y.help="help";y.answer="answer";y.commands="commands";y.U1k="servicecommands";y.Sxh="template";Object(J.a)(y,"SuggestionGroupType",null,[]);var u=d(118),D=d(105),F=d(25),I=d(33);d.d(V,"InteractionLogger",function(){return H});class H{constructor(L,E,aa){this.ttd=0;this.kFd=this.FPb=null;this.Eh=L;this.kEd=this.lsd=this.Qvd=!1;this.MLh=E;this.$h=F.AFrameworkApplication.Ge;this.vb=aa;this.bsc=this.WAd=0}get Fma(){return this.Eh.Fma}Vhd(L){this.Eh.Vhd(L)}GDg(){if(this.FPb){var L=0;
for(const E of this.FPb)this.Eh.OZj(E,L++);this.FPb=null}}beginQuery(L,E,aa){this.Eh.EZj(L,E,aa)}l0g(L,E){this.Eh.Ldi(L,E);this.Qvd=!0;this.kEd=!1}k0g(){this.Qvd=!1;this.lsd||(this.GDg(),this.Eh.Y0f(this.ttd))}FZj(L,E){this.Eh.GZj(L,E)}Pkk(L,E,aa,Q,O){for(const T of this.MLh)if(L.startsWith(T)){this.kEd=!0;break}this.Eh.KXj(L,E,aa,Q,O)}$kk(L){this.lsd=!1;this.ttd=L;this.Qvd||this.kEd||(this.GDg(),this.Eh.Y0f(this.ttd,!1))}Zkk(L,E){this.Eh.OXj(L,E);this.lsd=!0}eZd(L,E){if(!L.count)return"";let aa=
"";const Q=Date.now();for(let O of L)L=(Q-O.timeStamp)/1E3,L=D.a.Hmd(L),0<aa.length&&(aa+=";"),aa+=E?O.commandId:O.controlId,aa+=":",aa+=L.toString();return aa}Jec(){var L=this.eZd(h.a.instance.BMb,!1);0<L.length&&this.Eh.IXj(L);L=this.eZd(h.a.instance.S_a,!0);0<L.length&&this.Eh.hXj(L);L=this.eZd(h.a.instance.dtc,!0);0<L.length&&this.Eh.rYj(L);L=u.TellMeActor.instance.Lgf;0<L.length&&this.Eh.DZj(I.c(L))}ZZj(L){this.Eh.wXj(L)}K4(L,E,aa,Q,O,T,K,X=null){this.Eh.aZj(L,E,aa,Q,O,T,K,X)}Uee(L,E,aa,Q){this.Eh.Uee(L,
E,aa,Q)}iH(L,E,aa=null){this.Eh.EEa(L,E,aa)}onError(L,E,aa=null){this.Eh.r7b(L,E,aa)}e5k(L){this.FPb=L}Pgj(L){const E=[];if(!L)return E;for(let aa=0;aa<L.length;aa++){const Q=m.a[L[aa].groupType].toLowerCase(),O=[],T=L[aa].results;if(T){for(let K=0;K<T.length;K++)"findindocument"===Q?Array.add(O,new A("","",Q,T[K].score,T[K].XBc,T[K].count)):Array.add(O,new A(T[K].label,T[K].description,Q,T[K].score,T[K].XBc,T[K].count));"answer"===Q||"definition"===Q||"wolframanswer"===Q||"entity"===Q?Array.add(E,
new w(O,y.answer)):"classifier"===Q||"appsforoffice"===Q?Array.add(E,new w(O,y.commands)):"serviceclassifier"===Q?Array.add(E,new w(O,y.U1k)):"assistance"===Q?Array.add(E,new w(O,y.help)):("document"===Q||"people"===Q||"findindocument"===Q||"notes"===Q||"image"===Q||"template"===Q)&&Array.add(E,new w(O,Q))}}return E}B3d(L,E){const aa={};aa.Query=E;aa.SuggestionGroups=I.c(this.Pgj(L));return I.c(aa)}Vgg(L){const E={"Content-Type":"application/json",Accept:"application/json"};E["X-Office-Version"]=
F.AFrameworkApplication.buildVersion;E["X-Office-Application"]=F.AFrameworkApplication.fa.Ga("Application");E["X-Office-Platform"]="WAC";E["X-TellMe-SqmUserId"]=F.AFrameworkApplication.fa.Ga("LoggableUserId")||"";E["X-TellMe-SessionId"]=this.Eh.Fma.W7;E["X-TellMe-SuggestionTypes"]="Ranker";E["X-TellMe-Culture"]=F.AFrameworkApplication.uiCulture;E["X-TellMe-ProcessSessionId"]=F.AFrameworkApplication.userSessionId;E["X-TellMe-Flights"]=L;E["X-TellMe-PartialQueryIndex"]=this.WAd;return E}eeb(L,E,aa){this.K4(E.length,
"RankerLogging",L.data.Le.toString(),Math.round(window.performance.now()-aa),v.a.Nxh,!0,e.a.xsa)}Udb(L,E,aa){this.K4(E.length,"RankerLogging",L.data.Le.toString(),Math.round(window.performance.now()-aa),v.a.Nxh,!1,e.a.xsa)}Wgg(){this.kFd||(this.kFd=new r.a(this.vb,null,6E3));return this.kFd.Aya}Xee(L){const E=this.B3d(this.FPb,L),aa=this.Vgg("RankerLogging"),Q=window.performance.now();this.$h.yj(this.Wgg(),2,E,aa,!1,0,O=>{this.eeb(O,L,Q)},O=>{this.Udb(O,L,Q)},null,null,!1,4E3,6E3);this.WAd++}MVk(){this.WAd=
0}xKe(L){this.bsc=L}}Object(J.a)(H,"InteractionLogger",null,[])},118:function(J,V,d){d.r(V);J=d(0);var h=d(13),e=d(22),m=d(1166),r=d(695),v=d(263);class A{constructor(kb,ab,Pb,rc,ic,md){this.groupType=kb;this.resultType=ab;this.sQe=Pb;this.P7a=rc;this.bUd=ic;this.resultIndex=md}}Object(J.a)(A,"ClickLoggingInfo",null,[]);const w=kb=>{const ab=[];for(;kb;)Array.add(ab,"{ContextId:"+kb.contextId+", IsGraphNodeContext:"+kb.Qk+"}"),kb=kb.fE;ab.reverse();return"{"+ab.join(", ")+"}"};class y{constructor(){this.W7=
this.sessionId=null}}Object(J.a)(y,"CorrelationRecord",null,[704]);var u=d(261);class D{constructor(kb,ab){this.Id=null;this.TimeStamp=0;this.Id=kb;this.TimeStamp=ab}}Object(J.a)(D,"MRUControl",null,[]);var F;(function(kb){kb[kb.Answer=0]="Answer";kb[kb.Definition=1]="Definition";kb[kb.Entity=2]="Entity";kb[kb.WolframAnswer=3]="WolframAnswer";kb[kb.Assistance=4]="Assistance";kb[kb.Command=5]="Command";kb[kb.Document=6]="Document";kb[kb.TryQuery=7]="TryQuery";kb[kb.FindInDocument=8]="FindInDocument";
kb[kb.HelpAction=9]="HelpAction";kb[kb.Insights=10]="Insights";kb[kb.People=11]="People";kb[kb.Image=12]="Image";kb[kb.FirstRunResult=13]="FirstRunResult";kb[kb.NoCommandsFoundResult=14]="NoCommandsFoundResult";kb[kb.TestResult=15]="TestResult";kb[kb.AppsForOffice_Installed=16]="AppsForOffice_Installed";kb[kb.AppsForOffice_Recommandation=17]="AppsForOffice_Recommandation";kb[kb.AppsForOffice_Query=18]="AppsForOffice_Query";kb[kb.Notes_Onenote=19]="Notes_Onenote";kb[kb.Notes_Samsung=20]="Notes_Samsung";
kb[kb.Notes_Sticky=21]="Notes_Sticky";kb[kb.Learning=22]="Learning";kb[kb.Feedback=23]="Feedback";kb[kb.Template=24]="Template";kb[kb.Addin=25]="Addin";kb[kb.OfficeScript=26]="OfficeScript";kb[kb.AddinStoreEntry=27]="AddinStoreEntry";kb[kb.Unknown=28]="Unknown"})(F||(F={}));Object(J.b)("ResultType",F);var I=d(678),H=d(105),L=d(25),E=d(364);class aa{constructor(kb,ab){this.vSh=10;this.fV=[];this.Ega=[];this.aaf=this.$$e=!1;this.lQb=this.kQb="";this.Lvc=ab;this.vb=kb;this.ycf=kb.Do}F0b(){!this.$$e&&
this.ycf&&this.vb&&I.a.Xwg()&&(this.kQb="58F514FD-AA7A-4A06-BF46-85FF3444BEA4-"+this.vb.application,this.fV=this.t9f(),this.$$e=!0);return this.fV}Ybj(){!this.aaf&&this.ycf&&this.vb&&I.a.Xwg()&&(this.lQb="21E7F47B-086F-41D1-9E5D-8A9FD31A7C4B-"+this.vb.application,this.Ega=this.t9f(!0),this.aaf=!0);return this.Ega}ZQj(kb){return kb.startsWith("TellMeUpsell")||"OpenInClientUpsell"===kb||"TryOfficeUpsell"===kb}v$d(kb){return this.tEj(kb)||this.ZQj(kb)||H.a.Vzg(kb)?!1:!0}p1h(kb){kb=kb.ControlId;this.v$d(kb)&&
(kb=this.aGe(kb),this.qQk(kb),this.Dck(),Array.insert(this.fV,0,new D(kb,Date.now())),this.kQb.length&&(kb=JSON.stringify(this.fV),E.a.instance.setItem(this.kQb,kb)))}kD(kb){this.Cck();Array.insert(this.Ega,0,new D(F[kb],Date.now()));this.lQb.length&&(kb=JSON.stringify(this.Ega),E.a.instance.setItem(this.lQb,kb))}t9f(kb=!1){if(!this.fV.length){var ab=kb?E.a.instance.getItem(this.lQb):E.a.instance.getItem(this.kQb);if(!ab||""===ab)return kb?this.Ega:this.fV;let Pb=null;try{Pb=JSON.parse(ab)}catch(rc){this.Voi(kb),
Pb=null}if(!Pb||!Pb.length||10<Pb.length)return kb?this.Ega:this.fV;ab=0;for(const rc of Pb)if(kb||this.vb.fWc(rc.Id)&&this.v$d(rc.Id))if(kb?Array.insert(this.Ega,ab++,rc):Array.insert(this.fV,ab++,rc),ab===this.Lvc)break}return kb?this.Ega:this.fV}RPd(kb){kb=this.aGe(kb);for(const ab of this.fV)if(ab.Id===kb)return!0;return!1}Voi(kb=!1){E.a.instance.setItem(kb?this.lQb:this.kQb,"")}FGj(kb){kb=this.aGe(kb.ControlId);return this.v$d(kb)?this.RPd(kb):!1}qQk(kb){if(0<this.fV.length){let ab=0;for(const Pb of this.fV){if(Pb.Id===
kb){Array.removeAt(this.fV,ab);break}ab++}}}aGe(kb){return"Excel"===this.vb.application&&kb.startsWith("m_excelWebRenderer_ewaCtl_")?kb.substr(26,kb.length):kb}Dck(){this.fV.length===this.Lvc&&Array.removeAt(this.fV,this.fV.length-1)}Cck(){this.Ega.length===this.vSh&&Array.removeAt(this.Ega,this.Ega.length-1)}tEj(kb){kb=kb.split("|");let ab="";if(6<=kb.length)ab=kb[0];else if(3<=kb.length){if("3"===kb[0])return!0;ab=kb[1]}return ab.startsWith("WA")}static createInstance(kb){let ab=3;L.AFrameworkApplication.fa&&
(ab=L.AFrameworkApplication.fa.Cc("TellMeMaxRecommendedResultsToReturn",3));return new aa(kb,ab)}}Object(J.a)(aa,"MruControlsManager",null,[703]);class Q{constructor(kb){this.Q1a=kb}vK(kb,ab){let Pb;return kb.jJ&&(Pb=this.Q1a[kb.value])?Pb.vK(kb,ab):(Pb=this.f$f(kb.value))?Pb.vK(Pb.Nfk,ab):null}Jaj(kb,ab){if(kb=this.Q1a[kb])for(const Pb of ab)if(ab=H.a.getParameter(Pb),ab.key===kb.$uk)return ab.value;return null}dik(kb){(kb=this.f$f(kb))&&kb.bik()}f$f(kb){const ab=kb.indexOf(H.a.t5g);return 0<ab?
this.Q1a[kb.substring(0,ab)]:null}}Object(J.a)(Q,"ParameterizedCommandManager",null,[702]);var O=d(301);class T{constructor(kb,ab){this.Gf=kb;this.pXa=ab}}Object(J.a)(T,"TellMeQuery",null,[]);var K=d(679);class X{constructor(kb,ab){this.Id=null;this.TimeElapsedSinceClick=0;this.Id=kb;this.TimeElapsedSinceClick=ab}}Object(J.a)(X,"CommandClickedEvent",null,[]);var P=d(123);class ea{constructor(kb,ab){this.CTh=kb;this.Kaa=ab}resultsUpdated(kb){this.CTh(P.b(kb.query)?"":kb.query.Gf,kb.Ck,kb.attributes,
this.Kaa,kb.vwb)}}Object(J.a)(ea,"ResultsUpdatedCallback",null,[701]);class ia{constructor(kb,ab,Pb,rc,ic){this.CommandId=this.ControlId=null;this.TimeElapsedSinceClick=0;this.TerminalParentControlId=this.CommandSurface=null;this.ControlId=kb;this.TimeElapsedSinceClick=Pb;this.CommandSurface=rc;this.CommandId=ab;this.TerminalParentControlId=ic}}Object(J.a)(ia,"UserActionEvent",null,[]);var ja=d(17);class C{constructor(kb,ab){this.menuModel=kb;this.resultCount=ab}}Object(J.a)(C,"GeneratedMenuModel",
null,[]);class pa{constructor(){this.ariaLabel=this.sections=this.title=null;this.shouldAutoOpen=!1;this.ariaRoleDescription=null}}Object(J.a)(pa,"MenuModel",null,[]);class Z{constructor(kb,ab,Pb){this.vb=kb;this.Q1a=ab;this.a3a=Pb}WYi(kb,ab,Pb){const {TellMeActor:rc}=d(118);let ic=0;const md=new pa,Fd=[];let ne="";md.sections=[];let ud=new ja.a;const gb=!!this.vb&&this.vb.YSa;var Vb=!!this.vb&&this.vb.fIb||L.AFrameworkApplication.Aa.jb.fIb;for(const Xc of kb){kb=0;gb||(ud=new ja.a);const Ib=new ja.a;
let gc=Xc.displayName;for(const Fb of Xc.results){if(0<=Fb.value.indexOf(H.a.TOe)){if(Fb.jJ){var Lc=this.Q1a[Fb.value];if(Lc&&Fb.value.endsWith(H.a.TOe)){if("FindParameterized"!==Fb.value&&!Vb){const fb=[];fb.push(appChrome.actions.setControlLabel(Fb.value,Lc.Y7i(Fb)));fb.push(appChrome.actions.setButtonCommandValueId(Fb.value,Lc.G1i(Fb)));appChrome.api.dispatch(fb)}Lc=Fb.value.replace(H.a.TOe,"");ud.remove(Lc)?kb--:Ib.add(Lc);ud.add(Fb.value);kb++}}}else switch(Fb.type){case 5:Ib.contains(Fb.value)||
(ud.add(Fb.value),kb++);break;case 7:ud.add(Fb.jJ);kb++;break;case 10:case 4:case 8:case 0:case 9:case 1:case 2:case 3:case 11:case 12:case 22:case 23:case 24:case 6:case 19:case 20:case 21:case 25:case 27:case 26:ud.add(Fb.value),kb++}13===Xc.groupType&&(gc=H.a.Oja()?0<ab.length?String.format(CommonUIStrings.l_SeeMoreResultsButtonText,ab):CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteried:String.format(CommonUIStrings.l_InsightsButtonText,ab));21===Xc.groupType&&(gc=CommonUIStrings.l_LearningUILiveText)}ic+=
kb;""!==gc&&0<kb&&(ne+=" , "+kb.toString()+" "+CommonUIStrings.l_TellMeSectionLiveNotification+" "+gc+" , ");0<ud.count&&!gb&&(kb=appChrome.api.menuSection(ud.toArray(),Xc.displayName,null,O.a[Xc.groupType]),Fd.push(kb))}Vb=null;0<ic&&(Vb=0<ab.length?1!==ic?String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResults,ic,ab):String.format(CommonUIStrings.l_SearchLiveNotificationForTermedQueryResult,ab):1!==ic?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,
ic):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText,gb?(ab=appChrome.api.menuSection(ud.toArray(),"",null,null),Fd.push(ab)):Vb+=ne);Pb&&(this.vb.eja?rc.instance.actions.push(appChrome.actions.updateTellMeAriaLiveRegionText(Vb)):appChrome.api.dispatch(appChrome.actions.updateTellMeAriaLiveRegionText(Vb)));md.sections=Fd;return new C(md,ic,[])}static get bVd(){return Z.k3e||(Z.k3e=new C(Object.assign(new pa,{sections:[]}),0,[]))}}Z.k3e=null;Object(J.a)(Z,"TellMeMenuDefintionGenerator",
null,[]);var qa;(function(kb){kb[kb.TellMeControlActivated=0]="TellMeControlActivated";kb[kb.TellMeQueryExecuted=1]="TellMeQueryExecuted";kb[kb.TellMeResultsRendered=2]="TellMeResultsRendered";kb[kb.TellMeControlDeactivated=3]="TellMeControlDeactivated"})(qa||(qa={}));Object(J.b)("PerformanceMarker",qa);var ya;(function(kb){kb[kb.TellMeTimeToRender=0]="TellMeTimeToRender";kb[kb.TellMeSessionLength=1]="TellMeSessionLength";kb[kb.TellMeResultTriageTime=2]="TellMeResultTriageTime"})(ya||(ya={}));Object(J.b)("PerformanceMeasure",
ya);class Ka{mark(kb){window.performance.mark(qa[kb])}measure(kb,ab,Pb){const {TellMeActor:rc}=d(118);try{window.performance.measure(ya[kb],qa[ab],qa[Pb])}catch(ic){rc.instance.Cd.onError("TellMePerformance:Measure","error measuring "+ya[kb])}}Lee(kb,ab,Pb){const {TellMeActor:rc}=d(118);rc.instance.Cd.Uee(ab,Pb,kb,this.o9i(kb))}zOa(kb){for(const ab of kb)window.performance.clearMarks(qa[ab])}clearMeasures(kb){for(const ab of kb)window.performance.clearMeasures(ya[ab])}o9i(kb){let ab=0;(kb=this.QZi(kb))&&
0<kb.length&&(ab=kb[kb.length-1].duration);return ab}QZi(kb){return window.performance.getEntriesByName(ya[kb],"measure")}}Object(J.a)(Ka,"TellMePerformance",null,[]);var Da=d(440),la=d(439),ma=d(33);class Ea{constructor(kb){this.UYh=kb}Jye(kb,ab,Pb){const {TellMeActor:rc}=d(118);rc.instance.Cd.K4(ab,la.a.gFb,kb.data.Le.toString(),Math.round(window.performance.now()-Pb),la.a.gFb,!0,Da.a.xsa);kb=ma.b(kb.data.Sd);ab=-1;kb.Index&&(ab=kb.Index);rc.instance.Cd.FZj(ab,this.UYh)}Dec(kb,ab,Pb){const {TellMeActor:rc}=
d(118);rc.instance.Cd.K4(ab,la.a.gFb,kb.data.Le.toString(),Math.round(window.performance.now()-Pb),la.a.gFb,!1,Da.a.xsa)}acj(kb){if(kb&&""!==kb.trim()){const Pb=window.performance.now(),rc=L.AFrameworkApplication.Lxh;var ab={};ab.Text=kb;ab.IsFileHash="false";ab=ma.c(ab);L.AFrameworkApplication.Ge.yj(rc,2,ab,{"Content-Type":"application/json",Accept:"application/json"},!1,0,ic=>{this.Jye(ic,kb.length,Pb)},ic=>{this.Dec(ic,kb.length,Pb)},null,null,!1,4E3,6E3)}}}Object(J.a)(Ea,"TellMeQueryIndexCallback",
null,[]);var ta=d(146);class Ga{constructor(kb,ab,Pb){this.xml=kb;this.resultCount=ab;this.uJi=Pb}}Object(J.a)(Ga,"GeneratedMenuXml",null,[]);var oa=d(946),sa=d(45);class Ha{constructor(kb,ab){this.Lrc=kb||{};this.wza=ab}get Tfb(){return 5}vK(kb,ab=null){return this.wza.vK(kb,ab)||this.Tfi(kb.value)}Tfi(kb){return Ha.Sfi(kb,this.Lrc[kb]||null)}static Sfi(kb,ab=null){kb=String.format('<ClonedControl Id="{0}" ',kb);for(let ic in ab){var Pb=ic,rc=ab[ic];rc=rc?sa.a.je(rc.toString()):"";kb+=String.format('{0}="{1}" ',
Pb,rc)}return kb+"/>"}}Object(J.a)(Ha,"CommandMenuItemFactory",null,[681]);var bb=d(134);class Ya{constructor(){this.ONh=CommonUIStrings.l_FindInDocumentText}get Tfb(){return 8}vK(kb){var ab=kb.jJ;kb=sa.a.je(kb.value);const Pb=sa.a.je(ab);ab=sa.a.je(String.format(this.ONh,ab));return this.pYi(kb,Pb,ab)}pYi(kb,ab,Pb){return bb.a(kb,"1540292897",Pb,H.a.JTi,null,ab,Pb,null,null)}}Object(J.a)(Ya,"FindInDocumentMenuItemFactory",null,[681]);var ua=d(947),Ma=d(945),Ca=d(948);class Va{get Tfb(){return 7}vK(kb){const ab=
Object(m.a)(K.a,kb);return this.bZi(sa.a.je(kb.value),ab.id)}bZi(kb,ab){return bb.a(ab,"1404166600",kb,null,null,kb,kb,null,null)}}Object(J.a)(Va,"TryQueryMenuItemFactory",null,[681]);class Za{constructor(kb){this.Boa=[];this.vb=kb}m5i(kb){for(const ab of this.Boa)if(ab.Tfb===kb)return ab;return null}EXa(kb){this.Boa.push(kb)}QMk(kb){this.EXa(new Ha(this.vb.dwi,kb));this.EXa(new Ca.a(this.vb.phk));this.EXa(new oa.a(this.vb.I_k,this.vb.H_k,this.vb.jnl,this.vb.luj,this.vb.Cal));this.EXa(new Ma.InsightsMenuItemFactory);
this.EXa(new Ya);this.EXa(new ua.a);this.EXa(new Va)}}Object(J.a)(Za,"MenuItemFactoryRegistry",null,[]);var Db=d(158);class Lb{constructor(kb,ab){this.vb=kb;this.lgf=new Za(this.vb);this.lgf.QMk(ab)}XYi(kb,ab){let Pb=0;const rc=[],ic=[];for(const Fd of kb){kb=H.a.CRe;var md=[];for(const ne of Fd.results){const ud=this.lgf.m5i(ne.type).vK(ne,ab);kb=H.a.CRe;md.push(ud);if(13===ne.type||14===ne.type)kb="Menu32";17===ne.type&&(kb="MenuTellMeExtended");ne.groupType=Fd.groupType;ic.push(Object(m.a)(Db.a,
ne))}Pb=Pb?Pb:md.length;md=bb.c("TellMeDropdownControls",md);kb=bb.e("TellMeDropdownMenuSection",md,kb,Fd.displayName);rc.push(kb)}ab=bb.f(rc,"LookupDropdownMenu");return new Ga(ab,Pb,ic)}static get kJc(){return Lb.l3e||(Lb.l3e=new Ga(bb.f([],"LookupDropdownMenu"),0,[]))}}Lb.l3e=null;Object(J.a)(Lb,"TellMeXmlGenerator",null,[]);class yb{}yb.jgk="MRU";yb.test="Test";Object(J.a)(yb,"ActionType",null,[]);var Bc=d(372),tb;(function(kb){kb[kb.Service=0]="Service";kb[kb.Local=1]="Local";kb[kb.MRU=2]="MRU";
kb[kb.TestResult=3]="TestResult";kb[kb.Unknown=4]="Unknown"})(tb||(tb={}));Object(J.b)("SubResultType",tb);var Mb=d(101);class Hb{constructor(kb,ab,Pb,rc,ic=null){this.CommandId=null;this.IsEnabled=!1;this.OptionalData=this.SubResultType=this.ResultType=null;this.CommandId=kb;this.IsEnabled=ab;this.ResultType=F[Pb];this.SubResultType=tb[rc];this.OptionalData=ic?Mb.a.toJSON(ic):null}}Object(J.a)(Hb,"ResultInfo",null,[]);var vb=d(168),Xb=d(135),Uc=d(179);class hb{constructor(kb,ab=null){this.u8e="TellMeWAC.";
this.gUh=kb;this.wZh=ab}ina(kb,ab,Pb){ab=vb.a.sD(ab);kb=vb.a.URd(kb,this.gUh,this.wZh,Pb,ab);Xb.a.ina(kb,this.u8e)}PIa(kb,ab,Pb=0){ab=vb.a.sD(ab);Xb.a.PIa(Object.assign(new Uc.a,{name:kb,dataFields:ab,durationMs:Pb}),this.u8e)}}Object(J.a)(hb,"TellMeOtelLogger",null,[720]);var Zb=d(106);class Fc{constructor(kb,ab,Pb,rc,ic,md,Fd){this.gV=this.UY=this.S_e=null;this.hoa=kb;this.osd=ab;this.jpa=Pb;this.ULa=rc;this.iza=ic;this.bRh=md;this.gV=Fd?Fd:new hb(this.ULa?v.CuiHelper.SOe:v.CuiHelper.LRe)}get Do(){return this.ULa}get Fma(){return this.jpa}Vhd(kb){this.S_e=
kb;switch(kb){case ta.a.contextMenu:this.UY=ta.a.contextMenu;break;default:this.UY=ta.a.tellMe}}Ldi(kb,ab){this.jpa.W7||(this.jpa.W7=Zb.a.create().toString(),this.bDg(kb,!0,ab))}Y0f(kb,ab=!0){this.jpa.W7&&this.eYj(kb,ab);this.ULa&&appChrome.api.updateTellMeCorrelationId("");this.jpa.W7=null}bDg(kb,ab,Pb){const {TellMeActor:rc}=d(118),ic=this.KV(u.a.tvb);ic[Bc.a.culture]=this.osd;ic[Bc.a.appName]=this.hoa;ic[Bc.a.context]=kb;ic[Bc.a.sVc]=this.iza;ic[Bc.a.VQj]=this.bRh;ic[Bc.a.EPj]=Pb;ic[Bc.a.YJj]=
ab;ic[Bc.a.contentType]=rc.instance.nHc;this.gV.ina(u.a.tvb,ic,this.S_e);this.ULa&&appChrome.api.updateTellMeCorrelationId(this.jpa.W7)}eYj(kb,ab){const Pb=this.KV(u.a.psg);Pb[Bc.a.rLi]=kb;Pb[Bc.a.XJj]=ab;this.gV.PIa(u.a.psg,Pb)}EZj(kb,ab,Pb){let rc=0;!Pb&&0<kb.length&&(rc=kb.trim().split(" ").length);const ic=this.KV(u.a.query);ic[Bc.a.query]="!";ic[Bc.a.afb]=ab;ic[Bc.a.B$g]=kb.length;ic[Bc.a.NAg]=Pb;ic[Bc.a.yDl]=rc;this.gV.ina(u.a.query,ic,this.UY)}aZj(kb,ab,Pb,rc,ic,md,Fd,ne=null){const ud=this.KV(u.a.latency);
ud[Bc.a.culture]=this.osd;ud[Bc.a.B$g]=kb;ud[Bc.a.CBh]=ab;ud[Bc.a.statusCode]=Pb;ud[Bc.a.T1k]=ic;ud[Bc.a.isSuccess]=md;ud[Bc.a.YTj]=Fd;ne&&(ud[Bc.a.cpl]=ne);this.gV.PIa(u.a.latency,ud,rc)}Uee(kb,ab,Pb,rc){const ic=this.KV(u.a.performance);ic[Bc.a.culture]=this.osd;ic[Bc.a.Odi]=qa[kb];ic[Bc.a.ZMi]=qa[ab];ic[Bc.a.exk]=ya[Pb];this.gV.PIa(u.a.performance,ic,rc)}OZj(kb,ab){var {TellMeActor:Pb}=d(118);const {CommandResultsUtility:rc}=d(325);if(kb.results.length){var ic=this.KV(u.a.ugh);ic[Bc.a.P7a]=ab.toString();
ic[Bc.a.groupType]=O.a[kb.groupType];16===kb.groupType&&(ic[Bc.a.hPj]=Pb.instance.opc);ab=[];Pb=[];var md=[];for(const Fd of kb.results)ic[Bc.a.resultType]||(ic[Bc.a.resultType]=F[Fd.type]),kb={},25===Fd.type&&(kb.AssetId=Fd.jJd),Pb.push(rc.E4b(Fd.value)),ab.push(Fd.value),md.push(new Hb(Fd.value,rc.E4b(Fd.value),Fd.type,Fd.subType,kb));0<ab.length&&(ic[Bc.a.iXk]="{"+ab.join(", ")+"}",ic[Bc.a.CMi]="{"+Pb.join(", ")+"}",ic[Bc.a.dXk]=ma.c(md));this.gV.ina(u.a.ugh,ic,this.UY)}}qZi(kb,ab){if(4===kb)return yb.jgk;
switch(ab){case 5:case 16:case 17:case 18:return"Command";case 0:case 1:case 2:case 10:case 12:return"Insights";case 19:case 20:case 21:return"Notes"}return F[ab]}KXj(kb,ab,Pb,rc,ic){const md=this.KV(u.a.click);md[Bc.a.CBh]=kb;md[Bc.a.bvk]=ab;md[Bc.a.commandId]=Pb;md[Bc.a.A4a]=rc;md[Bc.a.actionType]=this.qZi(ic.groupType,ic.resultType);md[Bc.a.resultType]=F[ic.resultType];md[Bc.a.sQe]=tb[ic.sQe];md[Bc.a.groupType]=O.a[ic.groupType];md[Bc.a.P7a]=ic.P7a.toString();md[Bc.a.bUd]=ic.bUd.toString();md[Bc.a.resultIndex]=
ic.resultIndex.toString();this.gV.ina(u.a.click,md,this.UY)}OXj(kb,ab){this.jpa.W7||(this.jpa.W7=Zb.a.create().toString(),this.bDg("",!1,ab));ab=this.KV(u.a.MSf);ab[Bc.a.afb]=kb;this.gV.PIa(u.a.MSf,ab)}kDg(kb,ab,Pb){if(kb){if(Pb)for(let rc in Pb)kb[rc]=Pb[rc];this.gV.PIa(u.a.events,kb,ab)}}EEa(kb,ab,Pb=null){const rc=this.KV(u.a.events);rc[Bc.a.event]=kb;this.kDg(rc,Math.round(ab),Pb)}r7b(kb,ab,Pb=null){const rc=this.KV(u.a.events);rc[Bc.a.event]=u.a.error;rc[Bc.a.module]=kb;rc[Bc.a.errorMessage]=
ab;rc[Bc.a.message]=ab;this.kDg(rc,Math.round(window.performance.now()),Pb)}IXj(kb){const ab=this.KV(u.a.cRf);ab[Bc.a.value]=kb;ab[Bc.a.Sdd]=this.ULa;this.gV.ina(u.a.cRf,ab,this.UY)}hXj(kb){const ab=this.KV(u.a.oCf);ab[Bc.a.value]=kb;ab[Bc.a.Sdd]=this.ULa;this.gV.ina(u.a.oCf,ab,this.UY)}rYj(kb){const ab=this.KV(u.a.R4f);ab[Bc.a.value]=kb;ab[Bc.a.Sdd]=this.ULa;this.gV.ina(u.a.R4f,ab,this.UY)}DZj(kb){const ab=this.KV(u.a.c$g);ab[Bc.a.value]=kb;ab[Bc.a.Sdd]=this.ULa;this.gV.ina(u.a.c$g,ab,this.UY)}wXj(kb){const ab=
this.KV(u.a.bmh);ab[Bc.a.value]=kb;this.gV.ina(u.a.bmh,ab,this.UY)}GZj(kb,ab){const Pb=this.KV(u.a.s$g);Pb[Bc.a.gFb]=kb;ab&&(Pb[Bc.a.W7]=ab);this.gV.PIa(u.a.s$g,Pb)}KV(kb){return{["SessionID"]:this.jpa.sessionId,["CorrelationID"]:this.jpa.W7,["Time"]:(new Date).getTime(),["Event"]:kb,["Scenario"]:this.UY}}}Object(J.a)(Fc,"UsageLogger",null,[700]);var ob=d(93);class ac{}ac.Callback="action";Object(J.a)(ac,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var pb=d(525),nb=d(78),Tb=d(133),Ub=d(479),
hc=d(232),Wb=d(54),fd=d(268),fc=d(70),bc=d(35);d.d(V,"TellMeActor",function(){return cc});class cc{constructor(){this.wza=this.HR=this.Kd=this.eb=this.R5=this.XF=this.Rd=this.Ca=this.Cd=this.fD=this.izd=this.YBf=this.Laa=this.vb=null;this.Klb=!1;this.Yrd=[];this.M_e=[];this.SAf=[];this.Kgf=[];this.Lgf=[];this.rcf=!1;this.kkb=this.a3a=null;this.cPb=this.iza=!1;this.Xvc=!0;this.mP=this.Vtc=this.n6e=this.tzd=this.Cgf=null;this.e1=[];this.jLa=this.Ekb=this.dga=null;this.tlb=!1;this.nzd=0;this.ckb=null;
this.Kaa=-1;this.mgf=0;this.jPb=!1;this.tLa=null;this.MAf=!1;this.PR=null}get nHc(){return this.R5?this.R5.contentType:cc.unknown}get actions(){return this.e1}set actions(kb){this.e1=kb}sPc(){return this.Cd?this.Cd.Fma.W7:null}xG(){return this.vb}get Bfk(){return this.Xvc}get rCl(){return this.Cgf}performance(){return this.fD}get opc(){return this.MAf}set opc(kb){this.MAf=kb}VF(kb){const ab=window.performance.now();this.a3a&&!P.b(kb)&&(this.a3a(kb),this.Cd.iH(u.a.VF,window.performance.now()-ab))}initialize(kb,
ab=null,Pb=null,rc=null,ic=null,md=null,Fd=null,ne=null,ud=null,gb=null,Vb=null){const {InteractionLogger:Lc}=d(1111),{GroupsPlacementInfo:Xc}=d(1108),{AggregatorResultsProvider:Ib}=d(972);this.vb=kb;this.iza=!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.Nwb;this.Cd=rc;if(!rc){rc=new y;rc.sessionId=L.AFrameworkApplication.userSessionId;const gc=fd.a.oe(L.AFrameworkApplication.lcid)||fd.a.n4b;this.Cd=new Lc(new Fc(this.vb.application,gc.name,rc,this.vb.Do,this.iza,kb.Rxa,null),this.vb.ewi,
this.vb)}this.wza=new Q(this.vb.parameterData);this.YBf=Pb||new Lb(this.vb,this.wza);this.a3a=Fd;this.izd=this.izd||new Z(this.vb,this.vb.parameterData,Fd);this.Kd=ob.FocusManager.instance();this.HR=aa.createInstance(this.vb);this.n6e=new Xc(kb);this.Ca=ic||L.AFrameworkApplication.Ta;this.Rd=md||L.AFrameworkApplication.pe;this.XF=ud;this.Laa=ab;this.PR=Vb;this.fD=new Ka;ud?ud.execute(gc=>{gc.isFeatureEnabled(cc.Yml,!0).then(Fb=>{const {AggregatorResultsProvider:fb}=d(972);this.jPb=Fb;this.Laa=this.Laa||
fb.createInstance(this.HR,this.vb,this.wza,this.jPb);return null})}):(this.jPb=!0,this.Laa=this.Laa||Ib.createInstance(this.HR,this.vb,this.wza,this.jPb));this.eb=ne;this.dga=Lb.kJc;this.Cgf=new Promise(gc=>{this.tzd=gc});gb&&gb.execute(gc=>{this.R5=gc});this.vb.Do&&H.a.Yyg()&&(kb=String.format(CommonUIStrings.l_TeamsUnifiedAppHelpText,this.vb.application),appChrome.api.dispatch(appChrome.actions.updateTellMePlaceholderText(kb,kb)))}ub(){this.c4h()}c4h(){this.Ca.pa(bc.a.tellMe,fc.a.frame,Object(h.a)(this,
this.tellMe,"tellMe"),96);this.Ca.pa(bc.a.BRe,fc.a.frame,Object(h.a)(this,this.FMf,"cacheAsyncMenuRefreshFunction"),96);this.Ca.pa(bc.a.FRe,fc.a.frame,Object(h.a)(this,this.wDg,"logItemExecuted"),96);this.Ca.pa(bc.a.IRe,fc.a.frame,Object(h.a)(this,this.gDg,"logControlDeactivation"),96);this.Ca.pa(bc.a.HRe,fc.a.frame,Object(h.a)(this,this.sDg,"logInputFocus"),96);this.Ca.pa(bc.a.ERe,fc.a.frame,Object(h.a)(this,this.tvb,"interactionBegin"),96);this.Ca.pa(bc.a.KRe,fc.a.frame,Object(h.a)(this,this.tvb,
"interactionBegin"),96);this.Ca.pa(bc.a.GRe,fc.a.frame,Object(h.a)(this,this.rDg,"logInputBlur"),96);this.Ca.pa(bc.a.JRe,fc.a.frame,Object(h.a)(this,this.fDg,"logControlActivated"),96);this.Ca.pa(bc.a.wld,fc.a.frame,Object(h.a)(this,this.K6f,"focusSearchBox"),96);this.Ca.pa(bc.a.ARe,fc.a.frame,Object(h.a)(this,this.fSf,"constructLiveNotificationForMenu"),96);this.Ca.pa(bc.a.MRe,fc.a.frame,Object(h.a)(this,this.c9d,"insertTryQuery"),96);this.Ca.pa(bc.a.Wde,fc.a.frame,Object(h.a)(this,this.c9d,"insertTryQuery"),
96);this.Ca.pa(bc.a.lXd,fc.a.frame,Object(h.a)(this,this.Yva,"openOrInsertUrl"),96);this.Ca.pa(bc.a.mXd,fc.a.frame,Object(h.a)(this,this.Yva,"openOrInsertUrl"),96);this.Ca.pa(bc.a.nXd,fc.a.frame,Object(h.a)(this,this.Yva,"openOrInsertUrl"),96);this.Ca.pa(bc.a.oXd,fc.a.frame,Object(h.a)(this,this.Yva,"openOrInsertUrl"),96);this.Ca.pa(bc.a.pXd,fc.a.frame,Object(h.a)(this,this.Yva,"openOrInsertUrl"),96);this.Ca.pa(bc.a.Zye,fc.a.frame,Object(h.a)(this,this.Yva,"openOrInsertUrl"),96);this.Ca.pa(bc.a.$ye,
fc.a.frame,Object(h.a)(this,this.Yva,"openOrInsertUrl"),96);this.Ca.pa(bc.a.aze,fc.a.frame,Object(h.a)(this,this.Yva,"openOrInsertUrl"),96);this.Ca.pa(bc.a.eAe,fc.a.frame,Object(h.a)(this,this.$3b,"insertMention"),96);this.Ca.pa(bc.a.fAe,fc.a.frame,Object(h.a)(this,this.$3b,"insertMention"),96);this.Ca.pa(bc.a.gAe,fc.a.frame,Object(h.a)(this,this.$3b,"insertMention"),96);this.Ca.pa(bc.a.DRe,fc.a.frame,Object(h.a)(this,this.O3g,"openFeedback"),96);this.Ca.pa(bc.a.NRe,fc.a.frame,Object(h.a)(this,this.Yva,
"openOrInsertUrl"),96);this.Ca.pa(bc.a.fJd,fc.a.frame,Object(h.a)(this,this.sxb,"launchAddin"),96);this.Ca.pa(bc.a.gJd,fc.a.frame,Object(h.a)(this,this.sxb,"launchAddin"),96);this.Ca.pa(bc.a.hJd,fc.a.frame,Object(h.a)(this,this.sxb,"launchAddin"),96);this.Ca.pa(bc.a.xhb,fc.a.frame,Object(h.a)(this,this.xhb,"showTellMeCoachmark"),96);this.Ca.pa(bc.a.Nde,fc.a.frame,Object(h.a)(this,this.NBg,"launchAddinStore"),96)}pMk(kb){this.Xvc=!1;const ab=window.performance.now();kb.BEa.isCompleted?(this.Xvc=!0,
this.tzd(!0)):kb.ZR(()=>{this.Xvc=!0;this.tzd(!0);this.Cd.iH(u.a.SGi,window.performance.now()-ab)});this.VMk(kb)}VMk(kb){hc.a.ied(Object(h.a)(this,this.hJi,"dispatcher"));hc.a.JZb([new Ub.a(bc.a.tellMe,fc.a.frame,96),new Ub.a(bc.a.BRe,fc.a.frame,96),new Ub.a(bc.a.FRe,fc.a.frame,96),new Ub.a(bc.a.IRe,fc.a.frame,96),new Ub.a(bc.a.HRe,fc.a.frame,96),new Ub.a(bc.a.ERe,fc.a.frame,96),new Ub.a(bc.a.KRe,fc.a.frame,96),new Ub.a(bc.a.GRe,fc.a.frame,96),new Ub.a(bc.a.JRe,fc.a.frame,96),new Ub.a(bc.a.wld,fc.a.frame,
96),new Ub.a(bc.a.ARe,fc.a.frame,96),new Ub.a(bc.a.MRe,fc.a.frame,96),new Ub.a(bc.a.Wde,fc.a.frame,96),new Ub.a(bc.a.lXd,fc.a.frame,96),new Ub.a(bc.a.mXd,fc.a.frame,96),new Ub.a(bc.a.nXd,fc.a.frame,96),new Ub.a(bc.a.oXd,fc.a.frame,96),new Ub.a(bc.a.pXd,fc.a.frame,96),new Ub.a(bc.a.Zye,fc.a.frame,96),new Ub.a(bc.a.$ye,fc.a.frame,96),new Ub.a(bc.a.aze,fc.a.frame,96),new Ub.a(bc.a.eAe,fc.a.frame,96),new Ub.a(bc.a.fAe,fc.a.frame,96),new Ub.a(bc.a.gAe,fc.a.frame,96),new Ub.a(bc.a.DRe,fc.a.frame,96),new Ub.a(bc.a.NRe,
fc.a.frame,96),new Ub.a(bc.a.fJd,fc.a.frame,96),new Ub.a(bc.a.gJd,fc.a.frame,96),new Ub.a(bc.a.hJd,fc.a.frame,96),new Ub.a(bc.a.xhb,fc.a.frame,96),new Ub.a(bc.a.Nde,fc.a.frame,96)],kb)}hJi(kb,ab,Pb,rc,ic){if(ab.contextId===fc.a.frame)switch(kb){case bc.a.tellMe:return this.tellMe(kb,ab,Pb,rc,ic);case bc.a.BRe:return this.FMf(kb,ab,Pb,rc,ic);case bc.a.FRe:return this.wDg(kb,ab,Pb,rc,ic);case bc.a.IRe:return this.gDg(kb,ab,Pb,rc,ic);case bc.a.HRe:return this.sDg(kb,ab,Pb,rc,ic);case bc.a.ERe:return this.tvb(kb,
ab,Pb,rc,ic);case bc.a.KRe:return this.restoreFocus(kb,ab,Pb,rc,ic);case bc.a.GRe:return this.rDg(kb,ab,Pb,rc,ic);case bc.a.JRe:return this.fDg(kb,ab,Pb,rc,ic);case bc.a.wld:return this.K6f(kb,ab,Pb,rc,ic);case bc.a.ARe:return this.fSf(kb,ab,Pb,rc,ic);case bc.a.MRe:case bc.a.Wde:return this.c9d(kb,ab,Pb,rc,ic);case bc.a.lXd:case bc.a.mXd:case bc.a.nXd:case bc.a.oXd:case bc.a.pXd:case bc.a.Zye:case bc.a.$ye:case bc.a.aze:case bc.a.NRe:return this.Yva(kb,ab,Pb,rc,ic);case bc.a.eAe:case bc.a.fAe:case bc.a.gAe:return this.$3b(kb,
ab,Pb,rc,ic);case bc.a.DRe:return this.O3g(kb,ab,Pb,rc,ic);case bc.a.fJd:case bc.a.gJd:case bc.a.hJd:return this.sxb(kb,ab,Pb,rc,ic);case bc.a.xhb:return this.xhb(kb,ab,Pb,rc,ic);case bc.a.Nde:return this.NBg(kb,ab,Pb,rc,ic)}return 2}K6f(kb,ab,Pb){if(1===Pb)return 32;this.Hoh();kb=!1;(this.vb.Rxa||this.iza)&&(ab=document.getElementById("SearchButton"))&&ab.click();if(!this.vb.Rxa&&this.iza)for(ab=document.getElementsByClassName("ms-suiteux-search-box"),Pb=0;Pb<ab.length;Pb++){const rc=ab[Pb].querySelector("input[type=search]");
rc&&(kb=ob.FocusManager.Mr(rc))}else kb=ob.FocusManager.Mr($get(this.vb.Do?v.CuiHelper.SOe:v.CuiHelper.LRe));this.cPb=!0;return kb?32:8}c9d(kb,ab,Pb,rc,ic){if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:InsertTryQuery","actiondata comes null"),16;this.Hoh();kb=ic.CommandValueId;ab=this.vb.Do?v.CuiHelper.SOe:v.CuiHelper.LRe;this.vb.Do&&!P.b(ic[pb.a.ffa])&&(ic[pb.a.ffa]=!1);if(kb){if(this.vb.Do)return appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(kb)),this.tLa=
[19],32;if(ic=$get(ab))ic.value=kb}return ob.FocusManager.Mr($get(ab))?32:8}Hoh(){this.Kd.NX(this.vb.Rxa||this.iza?this.vb.SQc:this.vb.IIa,!1)}lZi(kb,ab){switch(kb){case 0:return String.format(CommonUIStrings.l_TellMeClassifierCommandAccessibleLabelFormat,ab);case 4:return String.format(CommonUIStrings.l_TellMeRecentlyUsedAccessibleLabelFormat,ab);case 5:return String.format(CommonUIStrings.l_TellMeTryQueryAccessibleLabelFormat,ab);case 7:case 16:return String.format(CommonUIStrings.l_TellMeTryCommandAccessibleLabelFormat,
ab)}return ab}fSf(kb,ab,Pb,rc,ic){if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:ConstructLiveNotificationForMenu","actiondata comes null"),16;kb=this.dga?this.dga.resultCount:0;ic.Value=1!==kb?String.format(CommonUIStrings.l_LookupLiveNotificationResultPluralFormText,kb):CommonUIStrings.l_LookupLiveNotificationResultSingularFormText;if(this.dga)for(const md of this.dga.uJi)ic=Object(e.a)(K.a,md)?md.id:sa.a.replaceAll(md.value,'"',""),(ic=$get(ic+"-"+H.a.CRe))&&Tb.a.BO(ic,Tb.a.Wr,
sa.a.je(this.lZi(md.groupType,ic.innerText)));return 32}FMf(kb,ab,Pb,rc,ic){if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:CacheAsyncMenuRefreshFunction","actiondata comes null"),16;this.ckb=new nb.a(2,1,0,()=>{ic[ac.Callback]()},97);this.dga&&this.Rd.Cb(this.ckb);return 32}wDg(kb,ab,Pb,rc,ic){if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:LogItemExecuted","actiondata comes null"),16;ic.CloseAllMenus&&(kb=void 0===ic.ParentControlId||null===ic.ParentControlId?
"<NA>":ic.ParentControlId,ab=this.kkb?this.kkb[ic.ControlId]:null,!ab&&this.kkb&&"<NA>"!==kb&&(ab=this.kkb[kb]),ab||(ab=this.Klb&&this.HR.FGj(ic),ab=this.MHi(ab,ic.ControlId),ab=new A(ab,28,4,-1,-1,-1),this.Cd.onError("TellMeActor:ItemExecuted","Missing ClickLoggingInfo for "+ic.ControlId+" determined group:"+O.a[ab.groupType])),this.Cd.Pkk(ic.ControlId,kb,ic.CommandId,ic.CloseAllMenus,ab),this.wza.dik(ic.ControlId),ic.Location!==ta.a.contextMenu&&(this.HR.p1h(ic),this.HR.kD(ab.resultType),this.vb.gjd&&
this.Laa.z2h(ic.CommandId)));return 32}gDg(kb,ab,Pb,rc,ic){if(1===Pb)return 32;I.a.WQj()&&(new Ea(this.sPc())).acj(this.Ekb);kb=this.Ekb;ab=this.Kaa;Pb=this.Cd.bsc;if(P.b(ic))return this.Cd.onError("TellMeActor:LogControlDeactivation","actiondata comes null"),16;ic=ic.UILocation;kb&&0<kb.length&&this.jPb&&H.a.bNe(this.vb)&&this.vb.SVc&&19!==ic&&ab>Pb&&!this.vb.rH&&(this.Cd.Xee(kb),this.Cd.xKe(ab));this.Cd.MVk();this.vb.pod&&19!==ic&&(this.fD.mark(3),this.fD.measure(1,0,3),this.fD.measure(2,2,3),this.fD.Lee(0,
1,2),this.fD.Lee(2,2,3),this.fD.Lee(1,0,3),this.fD.zOa([0,1,2,3]),this.fD.clearMeasures([0,2,1]));this.Cd.$kk(window.performance.now()-this.nzd);this.vb.Do&&(this.jLa=null,this.Cd.k0g());this.cPb=this.tlb=!1;this.Ekb="";return 32}sDg(kb,ab,Pb){if(1===Pb)return 32;this.Cd.l0g(w(ab),this.cPb);return 32}rDg(kb,ab,Pb){if(1===Pb)return 32;this.Cd.k0g();this.tlb=!1;return 32}fDg(kb,ab,Pb,rc,ic){if(1===Pb)return 32;this.mP=null;ic&&(this.mP=ic);this.vb.pod&&(P.b(this.mP)||this.mP.Location!==ta.a.contextMenu)&&
this.fD.mark(0);this.Cd.Vhd(P.b(this.mP)||P.b(this.mP.Location)?ta.a.unknown:this.mP.Location);this.Cd.Zkk(this.mgf,this.cPb);this.tlb||this.Jec();return 32}jUf(kb,ab){const Pb=[],rc=Date.now();for(let ic of kb)kb=(rc-ic.timeStamp)/1E3,kb=H.a.Hmd(kb),Array.add(Pb,new X(ab?ic.commandId:ic.controlId,kb));return Pb}gEi(kb){const ab=[],Pb=Date.now();for(let rc of kb)if(rc.controlId||"keyboardShortcut"===rc.commandSurface)kb=(Pb-rc.timeStamp)/1E3,kb=H.a.Hmd(kb),Array.add(ab,new ia(rc.controlId,rc.commandId,
kb,rc.commandSurface,rc.zld));return ab}IUf(kb=!1){var ab=kb?this.HR.Ybj():this.HR.F0b();kb=[];const Pb=Date.now();for(const rc of ab)ab=(Pb-rc.TimeStamp)/1E3,ab=H.a.Hmd(ab),Array.add(kb,new X(rc.Id,ab));return kb}Jec(){if(!this.tlb){this.Klb=this.tlb=!0;""!==this.vb.Pkh&&L.AFrameworkApplication.Wj(this.vb.Pkh);if(!this.rcf){this.rcf=!0;const kb={};kb.IsMLREnabled=this.vb.mLj;kb.IsReactRibbonEnabled=this.vb.Do;kb.IsSharedHeaderEnabled=!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.xN;
kb.IsSearchUxEnabled=this.iza;kb.IsTellMeInHeaderEnabled=this.vb.Rxa;kb.IsGoLocalEnv=H.a.awg();kb.IsSovereignEnvironment=H.a.D9a();kb.IsTellMeServiceResultsEnabled=H.a.bNe(this.vb);kb.IsSubstrateProviderEnabled=H.a.aNe(this.vb);kb.ShouldFetchTokens=!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.eIb;kb.IsSerpletEnabled=H.a.Oja();kb.FirstOnClickTimeInMS=Math.round(window.performance.now());kb.IsHeaderHidden=L.AFrameworkApplication.hideHeader||L.AFrameworkApplication.bQ;kb.IsSearchInHeaderHidden=
L.AFrameworkApplication.eRc;void 0!==window.performance.timing&&null!==window.performance.timing&&(kb.TimeSinceFetchStart=Math.round(Date.now()-window.performance.timing.fetchStart));kb.IsFindWithMatchesEnabled=this.vb.g5f;kb.HelpShowsTopSearchResult=this.vb.Qlc;kb.HelpShowsNumberOfMatches=this.vb.Plc;L.AFrameworkApplication.fa&&(kb.UiHost=L.AFrameworkApplication.fa.Ga("UiHostIntegrationType"));this.Cd.ZZj(JSON.stringify(kb))}this.Yrd=this.jUf(r.a.instance.BMb,!1);this.M_e=this.jUf(r.a.instance.S_a,
!0);this.SAf=this.gEi(r.a.instance.S_a);this.Kgf=this.IUf();this.Lgf=this.IUf(!0);this.Cd.Jec()}}tvb(kb,ab,Pb,rc,ic){if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:InteractionBegin","actiondata comes null"),16;if(Wb.a.oW)return 32;this.nzd=window.performance.now();this.Jec();kb=new ea(Object(h.a)(this,this.qea,"onRequestCompleted"),0);this.Kaa++;this.Cd.beginQuery("",this.Kaa,this.Klb);this.dga=Lb.kJc;this.jLa=Z.bVd;if(this.Laa)cc.instance.actions=[],this.Laa.HD(new T("",this.Kaa),
kb,this.vb.Do);else this.Cd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.ckb&&this.Rd.Cb(this.ckb);return 32}restoreFocus(kb,ab,Pb){if(1===Pb)return 32;this.Kd.R4(this.vb.Rxa||this.iza?this.vb.SQc:this.vb.IIa,!1);return 32}tellMe(kb,ab,Pb,rc,ic){if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:TellMe","actiondata comes null"),16;this.mP=ic;this.Cd.Vhd(P.b(this.mP.Location)?ta.a.unknown:this.mP.Location);kb=this.mP.Value;this.vb.Do||kb&&""!==
kb.trim()?(!this.jLa&&this.vb.Do&&(this.Cd.l0g(w(ab),this.cPb),this.Jec()),this.SPi(kb,this.mP.Location),this.mP.PopulationXML=this.dga.xml):this.Klb?this.mP.PopulationXML=this.dga.xml:(this.mP.PopulationXML=Lb.kJc.xml,this.jLa=Z.bVd,this.Ekb="");return 32}SPi(kb,ab){this.nzd=window.performance.now();this.vb.pod&&ab!==ta.a.contextMenu&&this.fD.mark(1);this.vb.Do&&appChrome.api.dispatch(appChrome.actions.updateTellMeSearchText(kb));kb&&0<kb.trim().length&&(this.Klb=!1);this.vb.KOi();ab=P.b(ab)?ta.a.tellMe:
ab;if(kb!==this.Ekb||this.vb.Do){this.Kaa++;this.Cd.beginQuery(kb,this.Kaa,this.Klb);const Pb=new T(kb,this.Kaa),rc=new ea(Object(h.a)(this,this.qea,"onRequestCompleted"),this.Kaa);this.dga=Lb.kJc;this.jLa=Z.bVd;if(this.Laa)cc.instance.actions=[],this.Laa.HD(Pb,rc,this.vb.Do,ab,this.tLa),this.tLa=null;else this.Cd.onError("TellMeActor:ExecuteTellMeQuery","Aggregator provider not resolved yet");this.mgf=this.Kaa;this.Ekb=kb}}$wl(kb){if(this.vb.Do){var ab=appChrome.selectors.getActiveControlStates();
if(ab=Object(m.a)(Object,ab[kb.value])){kb.label=ab.label;let Pb=null;"description"in ab&&(Pb=ab.description);Pb&&Object.getType(Pb)===String?kb.description=Pb:"secondaryText"in ab?kb.description=ab.secondaryText:"fullDescriptionLabel"in ab&&(kb.description=ab.fullDescriptionLabel)}}}pyk(kb){this.kkb={};let ab=0,Pb=0;for(const rc of kb){kb=0;for(const ic of rc.results)this.kkb[ic.value]=new A(ic.groupType,ic.type,ic.subType,ab,kb,Pb),kb++,Pb++,ic.label||5!==ic.type||this.$wl(ic);0<kb&&ab++}}QDb(kb,
ab,Pb,rc,ic){if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:OpenUrlInNewTab","actiondata comes null"),16;(kb=ic.CommandValueId)&&window.open(kb,"_blank");return 32}$3b(kb,ab,Pb,rc,ic){if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:InsertMention","actiondata comes null"),16;kb=ic.UILocation;let md;ic=ic.CommandValueId;try{md=ma.a(ic)}catch(Fd){return this.Cd.onError("TellMeActor:InsertMention","commandValueId is not in proper format"),16}return P.b(md)?(this.Cd.onError("TellMeActor:InsertMention",
"insertMentionParameters comes null"),16):P.b(this.Vtc)?(this.Cd.onError("TellMeActor:InsertMention","_iInsertContentHandler comes null"),16):19!==kb?(this.Cd.onError("TellMeActor:InsertMention","location "+kb+" is unexpected"),16):this.Vtc.$3b(md.displayName,md.email,md.userId)?32:(this.Cd.onError("TellMeActor:InsertMention","mention is not inserted"),16)}Yva(kb,ab,Pb,rc,ic){return 1===Pb?32:P.b(ic)?(this.Cd.onError("TellMeActor:OpenOrInsertUrl","actiondata comes null"),16):19===ic.UILocation?this.nCj(Pb,
ic):this.QDb(kb,ab,Pb,rc,ic)}O3g(kb,ab,Pb,rc,ic){if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:OpenFeedback","actiondata comes null"),16;this.PR&&window.setTimeout(()=>{this.PR.execute(md=>{md.yIb("TellMeSurvey",null)})},cc.eSi);return 32}nCj(kb,ab){if(1===kb)return 32;if(P.b(ab))return this.Cd.onError("TellMeActor:InsertUrl","actiondata comes null"),16;if(P.b(this.Vtc))return this.Cd.onError("TellMeActor:InsertUrl","_iInsertContentHandler comes null"),16;kb=ab.CommandValueId;
return P.b(kb)?(this.Cd.onError("TellMeActor:InsertUrl","commandValueId comes null"),16):this.Vtc.insertHtmlText(kb)?32:(this.Cd.onError("TellMeActor:InsertUrl","url is not inserted"),16)}qea(kb,ab,Pb,rc,ic){Pb=window.performance.now();this.pyk(ab);this.Cd.e5k(ab);this.vb.Do?(this.jLa=this.izd.WYi(ab,kb,ic),this.vb.eja?(this.e1.push(appChrome.actions.updateTellMeSearchResults(this.jLa.menuModel,kb,ic)),appChrome.api.dispatch(this.e1)):appChrome.api.dispatch(appChrome.actions.updateTellMeSearchResults(this.jLa.menuModel,
kb,ic)),this.vb.pod&&this.tlb&&(P.b(this.mP)||this.mP.Location!==ta.a.contextMenu)&&(this.fD.mark(2),this.fD.measure(0,1,2))):this.dga=this.YBf.XYi(ab,this.Cd.Fma);this.ckb&&this.Rd.Cb(this.ckb);ic={};ic.GroupsCount=ab.length;ic.QueryID=rc;ic.QueryLength=kb.length;this.Cd.iH(u.a.jCi,window.performance.now()-Pb,ic)}MHi(kb,ab){return ab.startsWith(this.vb.Do?H.a.$Te:H.a.Ymd)?5:kb?4:"bSearchHelp"===ab||ab.startsWith("GetHelpFromTellMe")?8:"bInsights"===ab||ab.startsWith("SmartLookupFromTellMe")?13:ab===
this.vb.f5f?2:0}kD(kb,ab){this.Laa&&this.Laa.kD(kb,ab)}NBg(kb,ab,Pb,rc,ic){if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:LaunchAddinStore","actiondata comes null"),16;if(this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinActionDataRefactor",!1)){kb={};kb.SourceControlId=ic.SourceControlId;kb.Query=ic.CommandValueId;ic=this.Ca.La(bc.a.Ode,2,kb);if(32!==ic)this.Cd.onError("TellMeActor:LaunchAddinStore","CommonCommands.LaunchAppforOfficeDialog failed. Response: "+
ic+".");return ic}return this.Ca.La(bc.a.Ode,2,ic)}sxb(kb,ab,Pb,rc,ic){({AddinResultsProvider:kb}=d(692));if(1===Pb)return 32;if(P.b(ic))return this.Cd.onError("TellMeActor:LaunchAddin","actiondata comes null"),16;Pb=ic.CommandValueId;if(P.a(Pb))return this.Cd.onError("TellMeActor:LaunchAddin","Add-in assetId is null"),16;if(!kb.E3a[Pb])return this.Cd.onError("TellMeActor:LaunchAddin","Add-in with assetId "+Pb+" doesn't not exist in entitlements"),16;ic=d(692).AddinResultsProvider.E3a[Pb];kb={};kb.solutionId=
ic.id;kb.version=ic.appVersion;kb.storeType=ic.storeType;kb.storeId=ic.storeId;kb.assetId=ic.assetId;kb.assetStoreId=ic.assetStoreId;kb.displayName=ic.displayName;kb.targetType=ic.targetType;kb.height=ic.height;kb.width=ic.width;ic=this.Ca.La(bc.a.npg,2,kb);if(32!==ic)this.Cd.onError("TellMeActor:LaunchAddin","CommonCommands.InsertOfficeAddin failed. Response: "+ic+". AssetId: "+Pb);return ic}xhb(){if(!P.b(this.PR))for(let kb of r.a.instance.S_a){if("ShowContextMenuWithFloatie"===kb.commandId)return this.PR.execute(ab=>
{ab.logActivity("TellMe1TabSwitchCoachMarkActivity",null)}),32;if(kb.commandId&&-1===kb.commandId.indexOf("Tab"))break}return 8}static get instance(){return cc.Ja||(cc.Ja=new cc)}}cc.Ja=null;cc.Yml="mso_tellMeService";cc.unknown="Unknown";cc.eSi=500;Object(J.a)(cc,"TellMeActor",null,[])},1208:function(J,V,d){d.r(V);var h=d(0),e=d(25),m=d(68),r=d(376),v=d(914),A=d(93),w=d(55),y=d(1165),u=d(13),D=d(1200),F=d(90),I=d(65),H=d(169),L=d(1016),E=d(82);class aa{static get mg(){return E.a.UB(aa.fo,Box4Intl.Box4Strings.L_SymbolUnicodeNameLabel,
"")}}aa.fo="<div class='WACDialogRow' id='SymbolsTable'> <div id='symbolsContainer'></div> </div> <div class='WACDialogRow' id='SymbolName'> <label id='SymbolNameLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='SymbolNameValue'> <label id='SymbolNameValueLabel' class='WACDialogLabel' >{1}</label> </div>";Object(h.a)(aa,"InsertSymbolsDialogHtml",null,[]);var Q=d(32),O=d(210);class T extends D.a{constructor(La,lb,Nb){super();this.qef=this.xpa=this.mNa=null;this.Yvd=0;
this.Ca=La;this.Kd=lb;this.Zza=Nb;this.Ue(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText);this.Ue(0,CommonUIStrings.l_DialogClose);this.cV=!1;this.mg=aa.mg;this.ng="InsertSymbolsDialog"}dispose(){0<T.QFd&&r.ULS.sendTraceTag(8778014,348,50,"InsertSymbolsDialog: InsertedSymbolCount={0}, TotalInsertedSymbolCount={1}",this.Yvd,T.QFd);T.T1e++;r.ULS.sendTraceTag(8778015,348,50,"InsertSymbolsDialog: DialogCloseCount={0}",T.T1e);this.Ca=this.Zza=null;super.dispose()}n5(){this.tj(Box4Intl.Box4Strings.L_SymbolSingle,
Object(u.a)(this,this.jCj,"insertSymbolsDialogHandler"),null);this.Yvd=0;T.Y1e++;r.ULS.sendTraceTag(8778013,348,50,"InsertSymbolsDialog: DialogOpenCount={0}",T.Y1e);const La=this.G3d("symbol_d_"+T.CPb);La&&La.focus()}hide(){var La=document.getElementById("symbolsContainer");if(La&&(La=La.getElementsByTagName("a")))for(let lb=0;lb<La.length;lb++)F.a.removeHandler(La[lb],I.a.focus,Object(u.a)(this,this.Dwh,"symbolFocusHandler"));super.hide()}jCj(La){1===La?(this.Oxe("symbol_d_"+T.CPb),this.Kd.NX(this.DK,
!0),this.Kd.il().uj.wE(this.XC),this.XC.focus()):this.hide()}get qxb(){return T.Lef}set qxb(La){T.Lef=La}get mxb(){return T.yef}set mxb(La){T.yef=La}Mva(){super.Mva();var La=document.getElementById("symbolsContainer");if(La&&(L.a.Fhd(La,this.Zza.rgi(),"InsertSymbolsDialog"),La=La.getElementsByTagName("a")))for(let lb=0;lb<La.length;lb++)F.a.addHandler(La[lb],I.a.focus,Object(u.a)(this,this.Dwh,"symbolFocusHandler"))}X6(){const La=document.getElementById("symbolsContainer");La&&(this.mNa||(this.mNa=
Object(u.a)(this,this.Zkl,"symbolClickHandler"),this.en.ob(I.a.click,La,this.mNa),this.en.ob(I.a.doubleClick,La,this.mNa)),this.xpa||(this.xpa=Object(u.a)(this,this.bll,"symbolKeyHandler"),this.Lg.ob(I.a.Xf,La,this.xpa),this.Lg.ob(I.a.Qx,La,this.xpa),this.Lg.ob(I.a.wl,La,this.xpa)));super.X6()}$qa(){const La=document.getElementById("symbolsContainer");La&&(this.mNa&&(this.en.xb(I.a.click,La,this.mNa),this.en.xb(I.a.doubleClick,La,this.mNa),this.mNa=null),this.xpa&&(this.Lg.xb(I.a.Xf,La,this.xpa),
this.Lg.xb(I.a.Qx,La,this.xpa),this.Lg.xb(I.a.wl,La,this.xpa),this.xpa=null));super.$qa()}hqk(La){this.Ioh("symbol_d_"+T.CPb,!1);T.CPb=parseInt(La.substr(La.lastIndexOf("_")+1));this.Ioh(La,!0);if(La=document.getElementById("SymbolNameValueLabel")){const lb=this.mPc(T.CPb);La.innerText=lb.altText}}mPc(La){const lb=this.Zza.dnc.Rkd.value,Nb=O.a(lb);return lb[Nb[La]]}Dwh(La){if(La.target!==this.qef){const lb=this.Kd.il();lb&&lb.uj&&(lb.uj.wE(La.target),this.qef=La.target)}this.hqk(La.target.id)}Zkl(La){const lb=
La.Ac;if("a"!==lb.tagName.toLowerCase())return!1;La.eventName===I.a.doubleClick&&this.Oxe(lb.id);this.Kd.NX(this.DK,!0);this.Kd.il().uj.wE(lb);lb.focus();return!0}bll(La){var lb=La.Ac;if("a"!==lb.tagName.toLowerCase())return!1;const Nb=parseInt(lb.id.substr(lb.id.lastIndexOf("_")+1));if(La.mc.ctrlKey||La.mc.altKey||La.mc.keyCode>=H.a.sjb&&La.mc.keyCode<=H.a.tya)return!1;if(La.eventName===I.a.Xf){La=La.mc.keyCode;let lc=-1;La===Sys.UI.Key.enter?(this.Oxe(lb.id),this.Kd.NX(this.DK,!0),this.Kd.il().uj.wE(lb),
lb.focus()):La===Sys.UI.Key.up?lc=Nb-15:La===Sys.UI.Key.down?lc=Nb+15:La===Sys.UI.Key.left?lc=e.AFrameworkApplication.isRtl?Nb+1:Nb-1:La===Sys.UI.Key.right&&(lc=e.AFrameworkApplication.isRtl?Nb-1:Nb+1);0<=lc&&(lb=this.G3d("symbol_d_"+lc))&&lb.focus()}return!0}Oxe(La){this.Yvd++;T.QFd++;La=parseInt(La.substr(La.lastIndexOf("_")+1));const lb=this.mPc(La),Nb={};Nb.SourceControlId="symbol_"+La+"_"+lb.Qkd;this.Ca.La(Q.a.dSa,2,Nb);r.ULS.sendTraceTag(8778016,348,50,"InsertSymbolsDialog: Insert symbol, index={0}",
La)}G3d(La){const lb=document.getElementById("symbolsContainer");return lb?lb.querySelector("#"+La):null}Ioh(La,lb){(La=this.G3d(La))&&(lb?La.setAttribute("selected","true"):La.removeAttribute("selected"))}}T.CPb=0;T.Lef=null;T.yef=null;T.Y1e=0;T.T1e=0;T.QFd=0;Object(h.a)(T,"InsertSymbolsDialog",D.a,[]);var K=d(42),X=d(50),P=d(39),ea=d(181),ia=d(114);class ja{constructor(La,lb,Nb,lc,Rc,Ud,Pd,Sd){this.Ca=La;this.YJ=lb;this.nYh=new y.a(Object(u.a)(this,this.Zgj,"getSymbolsDropDownMenuProps"));this.oYh=
new y.a(Object(u.a)(this,this.H3d,"getSymbolsDropDownXml"));this.WEd=lc.dnc.Rkd;this.rk=Nb;this.Zza=lc;this.dD=Rc;this.QO=Ud;this.Qc=Pd;this.xm=Sd}Zgj(){return this.Zza.bhi()}H3d(){return this.Zza.build()}ub(){this.Ca.pa(Q.a.wcd,P.a.application,Object(u.a)(this,this.wcd,"queryInsertSymbols"),96);this.Ca.ya(Q.a.xEb,P.a.view,Object(u.a)(this,this.xEb,"populateSymbolsDropDown"));this.Ca.ya(Q.a.SQe,P.a.view,Object(u.a)(this,this.Ewh,"symbolsDropDownOpenHandler"));this.Ca.ya(Q.a.PDe,P.a.view,Object(u.a)(this,
this.hah,"querySymbolPositionHandler"));this.Ca.ya(Q.a.dSa,P.a.view,Object(u.a)(this,this.CDa,"insertSymbolViewHandler"));this.Ca.ya(Q.a.xEb,P.a.Of,Object(u.a)(this,this.xEb,"populateSymbolsDropDown"));this.Ca.ya(Q.a.SQe,P.a.Of,Object(u.a)(this,this.Ewh,"symbolsDropDownOpenHandler"));this.Ca.ya(Q.a.PDe,P.a.Of,Object(u.a)(this,this.hah,"querySymbolPositionHandler"));this.Ca.ya(Q.a.dSa,P.a.Of,Object(u.a)(this,this.iCj,"insertSymbolHandler"));this.Ca.he(Q.a.xEb,1124);this.Ca.he(Q.a.SQe,1036);this.Ca.he(Q.a.PDe,
1124);this.Ca.he(Q.a.dSa,1036);e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&(this.Ca.ya(Q.a.J8d,P.a.view,Object(u.a)(this,this.Fsh,"showInsertMoreSymbolsDialogHandler")),this.Ca.ya(Q.a.J8d,P.a.Of,Object(u.a)(this,this.Fsh,"showInsertMoreSymbolsDialogHandler")),this.Ca.he(Q.a.J8d,1124))}hah(La,lb,Nb,lc,Rc){if(1===Nb)return 32;La=this.Zza.D5g(Rc);La=String.format(this.Zza.$kl,La.character);Rc[v.a.InnerHTML]=La;Rc[v.a.On]=!1;return 32}CDa(La,lb,Nb,lc,Rc){if(({Ef:La,
selected:Nb,CDa:Sd}=this.OWf(lb,Nb)).returnValue)return Sd;var Ud=K.SelectionEditor.Pg(Nb);let Pd=!0;Nb=8;var Sd=this.rk.ke(15);Sd.gd(La.vg);Ud||(Nb=this.Ca.ki(lb,Q.a.ABa,2,!0,lc,null),lb=32===Nb,r.ULS.shipAssertTag(6407387,348,lb,"DeleteForReplace did not succeed. Response is {0}",Nb),Pd=lb);Pd&&(lb=La.Gb.Kj,Ud=K.SelectionEditor.Pg(lb),r.ULS.shipAssertTag(6407388,348,Ud,"Context is not an InsertionPointContext after DeleteForReplace. Context is {0}",lb.contextId),Nb=8,Ud&&(Nb=this.Ca.ki(lb,Q.a.dSa,
2,!1,lc,Rc),r.ULS.shipAssertTag(6407389,348,32===Nb,"Insertion at IP context did not succeed. Response is {0}",Nb),32===Nb&&A.FocusManager.instance().Bf(La.eI)));Sd.dispose();return Nb}OWf(La,lb){let Nb,lc;Nb=null;La.view.Lh&&(Nb=La.view);lc=null;return Nb&&Nb.Gb?(lc=Nb.Gb.Kj)?this.QO.ga(14)&&this.dD.N4a(lc)?{returnValue:!0,Ef:Nb,selected:lc,CDa:8}:Nb.Gb.Oa.MG||this.xm&&this.xm.instance&&this.xm.instance.lW(lc)||K.SelectionEditor.cTc(La.fE)?{returnValue:!0,Ef:Nb,selected:lc,CDa:2}:1===lb?{returnValue:!0,
Ef:Nb,selected:lc,CDa:32}:{returnValue:!1,Ef:Nb,selected:lc,CDa:32}:{returnValue:!0,Ef:Nb,selected:lc,CDa:2}:(ia.c(16851359,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",La.toString()),{returnValue:!0,Ef:Nb,selected:lc,CDa:8})}iCj(La,lb,Nb,lc,Rc){if(1===Nb)return 32;if(K.SelectionEditor.cTc(lb))return 2;La=this.Zza.D5g(Rc);lc.IP=La.index;lc=this.YJ.Kc(lb.node);Nb=lc.pc(11);r.ULS.shipAssertTag(6379466,324,Nb,"could not root iterator at ancestor of type OutlineElement. NodeType: {0}",
ea.a[lb.node.type]);Nb=this.rk.ke(15);Nb.iy(lc);ja.characterPropertiesEditor.replaceTextRange(lb,La.character,!0,!1);lb=X.SelectionFactory.Mg(lc.currentNode,lb.Qa+1);this.Qc.setSelection(lb);Nb.dispose();return 32}xEb(La,lb,Nb,lc,Rc){if(1===Nb)return 32;e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.jb.Up?Rc.MenuItems=this.nYh.value:Rc.PopulationXML=this.oYh.value;return 32}Ewh(La,lb,Nb){({CDa:La}=this.OWf(lb,Nb));return La}Fsh(La,lb,Nb){2===Nb&&(new T(this.Ca,A.FocusManager.instance(),w.a.instance.resolve("Box4.Symbols.ISymbolsUIBuilder"))).n5();
return 32}wcd(){return 32}static get characterPropertiesEditor(){return ja.Yg||(ja.Yg=w.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static set characterPropertiesEditor(La){ja.Yg=La}}ja.Yg=null;Object(h.a)(ja,"SymbolsActor",null,[604]);class C{constructor(La,lb){this.Qkd=La;this.altText=lb}}Object(h.a)(C,"Symbol",null,[]);class pa{constructor(){this.VEd=null;this.WEd=new y.a(pa.MRd)}get Rkd(){return this.WEd}P7i(La){this.VEd||(this.VEd=O.a(this.WEd.value));return Array.indexOf(this.VEd,
La)}static MRd(){const La={};La["\u2022"]=new C("\u2022",Box4Intl.Box4Strings.L_Bullet);La["\u20ac"]=new C("\u20ac",Box4Intl.Box4Strings.L_EuroSign);La["\u00a3"]=new C("\u00a3",Box4Intl.Box4Strings.L_PoundSign);La["\u00a5"]=new C("\u00a5",Box4Intl.Box4Strings.L_YenSign);La["\u00a9"]=new C("\u00a9",Box4Intl.Box4Strings.L_CopyrightSign);La["\u00ae"]=new C("\u00ae",Box4Intl.Box4Strings.L_RegisteredSign);La["\u2122"]=new C("\u2122",Box4Intl.Box4Strings.L_TradeMarkSign);La["\u00b1"]=new C("\u00b1",Box4Intl.Box4Strings.L_PlusMinusSign);
La["\u2260"]=new C("\u2260",Box4Intl.Box4Strings.L_NotEqualTo);La["\u2264"]=new C("\u2264",Box4Intl.Box4Strings.L_LessThanOrEqualTo);La["\u2265"]=new C("\u2265",Box4Intl.Box4Strings.L_GreaterThanOrEqualTo);La["\u00f7"]=new C("\u00f7",Box4Intl.Box4Strings.L_DivisionSign);La["\u00d7"]=new C("\u00d7",Box4Intl.Box4Strings.L_MultiplicationSign);La["\u221e"]=new C("\u221e",Box4Intl.Box4Strings.L_Infinity);La["\u00b5"]=new C("\u00b5",Box4Intl.Box4Strings.L_MicroSign);La["\u03b1"]=new C("\u03b1",Box4Intl.Box4Strings.L_GreekSmallLetterAlpha);
La["\u03b2"]=new C("\u03b2",Box4Intl.Box4Strings.L_GreekSmallLetterBeta);La["\u03c0"]=new C("\u03c0",Box4Intl.Box4Strings.L_GreekSmallLetterPi);La["\u03a9"]=new C("\u03a9",Box4Intl.Box4Strings.L_OhmSign);La["\u03a3"]=new C("\u03a3",Box4Intl.Box4Strings.L_NArySummation);La["\u00b0"]=new C("\u00b0",Box4Intl.Box4Strings.L_DegreeSign);La["\u0394"]=new C("\u0394",Box4Intl.Box4Strings.L_CapitalLetterDelta);La["\u263a"]=new C("\u263a",Box4Intl.Box4Strings.L_WhiteSmilingFace);La["\u2665"]=new C("\u2665",
Box4Intl.Box4Strings.L_BlackHeartSuit);La["\u20b9"]=new C("\u20b9",Box4Intl.Box4Strings.L_IndianRupeeSign);La["\u00bf"]=new C("\u00bf",Box4Intl.Box4Strings.L_InvertedQuestionMark);La["\u00a1"]=new C("\u00a1",Box4Intl.Box4Strings.L_InvertedExclamationMark);La["\u2014"]=new C("\u2014",Box4Intl.Box4Strings.L_EmDash);La["\u2026"]=new C("\u2026",Box4Intl.Box4Strings.L_HorizontalEllipsis);La["\u00c0"]=new C("\u00c0",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithGrave);La["\u00c1"]=new C("\u00c1",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithAcute);
La["\u00c2"]=new C("\u00c2",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithCircumflex);La["\u00c3"]=new C("\u00c3",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithTilde);La["\u00c4"]=new C("\u00c4",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithDiaeresis);La["\u00c5"]=new C("\u00c5",Box4Intl.Box4Strings.L_LatinCapitalLetterAWithRingAbove);La["\u00c6"]=new C("\u00c6",Box4Intl.Box4Strings.L_LatinCapitalLetterAe);La["\u00c7"]=new C("\u00c7",Box4Intl.Box4Strings.L_LatinCapitalLetterCWithCedilla);La["\u00c8"]=
new C("\u00c8",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithGrave);La["\u00c9"]=new C("\u00c9",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithAcute);La["\u00ca"]=new C("\u00ca",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithCircumflex);La["\u00cb"]=new C("\u00cb",Box4Intl.Box4Strings.L_LatinCapitalLetterEWithDiaeresis);La["\u00cc"]=new C("\u00cc",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithGrave);La["\u00cd"]=new C("\u00cd",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithAcute);La["\u00ce"]=new C("\u00ce",
Box4Intl.Box4Strings.L_LatinCapitalLetterIWithCircumflex);La["\u00cf"]=new C("\u00cf",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDiaeresis);La["\u00d1"]=new C("\u00d1",Box4Intl.Box4Strings.L_LatinCapitalLetterNWithTilde);La["\u00d2"]=new C("\u00d2",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithGrave);La["\u00d3"]=new C("\u00d3",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithAcute);La["\u00d4"]=new C("\u00d4",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithCircumflex);La["\u00d5"]=new C("\u00d5",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithTilde);
La["\u00d6"]=new C("\u00d6",Box4Intl.Box4Strings.L_LatinCapitalLetterOWithDiaeresis);La["\u00d9"]=new C("\u00d9",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithGrave);La["\u00da"]=new C("\u00da",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithAcute);La["\u00db"]=new C("\u00db",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithCircumflex);La["\u00dc"]=new C("\u00dc",Box4Intl.Box4Strings.L_LatinCapitalLetterUWithDiaeresis);La["\u00df"]=new C("\u00df",Box4Intl.Box4Strings.L_LatinSmallLetterSharpS);La["\u00e0"]=
new C("\u00e0",Box4Intl.Box4Strings.L_LatinSmallLetterAWithGrave);La["\u00e1"]=new C("\u00e1",Box4Intl.Box4Strings.L_LatinSmallLetterAWithAcute);La["\u00e2"]=new C("\u00e2",Box4Intl.Box4Strings.L_LatinSmallLetterAWithCircumflex);La["\u00e3"]=new C("\u00e3",Box4Intl.Box4Strings.L_LatinSmallLetterAWithTilde);La["\u00e4"]=new C("\u00e4",Box4Intl.Box4Strings.L_LatinSmallLetterAWithDiaeresis);La["\u00e5"]=new C("\u00e5",Box4Intl.Box4Strings.L_LatinSmallLetterAWithRingAbove);La["\u00e6"]=new C("\u00e6",
Box4Intl.Box4Strings.L_LatinSmallLetterAe);La["\u00e7"]=new C("\u00e7",Box4Intl.Box4Strings.L_LatinSmallLetterCWithCedilla);La["\u00e8"]=new C("\u00e8",Box4Intl.Box4Strings.L_LatinSmallLetterEWithGrave);La["\u00e9"]=new C("\u00e9",Box4Intl.Box4Strings.L_LatinSmallLetterEWithAcute);La["\u00ea"]=new C("\u00ea",Box4Intl.Box4Strings.L_LatinSmallLetterEWithCircumflex);La["\u00eb"]=new C("\u00eb",Box4Intl.Box4Strings.L_LatinSmallLetterEWithDiaeresis);La["\u00ec"]=new C("\u00ec",Box4Intl.Box4Strings.L_LatinSmallLetterIWithGrave);
La["\u00ed"]=new C("\u00ed",Box4Intl.Box4Strings.L_LatinSmallLetterIWithAcute);La["\u00ee"]=new C("\u00ee",Box4Intl.Box4Strings.L_LatinSmallLetterIWithCircumflex);La["\u00ef"]=new C("\u00ef",Box4Intl.Box4Strings.L_LatinSmallLetterIWithDiaeresis);La["\u00f1"]=new C("\u00f1",Box4Intl.Box4Strings.L_LatinSmallLetterNWithTilde);La["\u00f2"]=new C("\u00f2",Box4Intl.Box4Strings.L_LatinSmallLetterOWithGrave);La["\u00f3"]=new C("\u00f3",Box4Intl.Box4Strings.L_LatinSmallLetterOWithAcute);La["\u00f4"]=new C("\u00f4",
Box4Intl.Box4Strings.L_LatinSmallLetterOWithCircumflex);La["\u00f5"]=new C("\u00f5",Box4Intl.Box4Strings.L_LatinSmallLetterOWithTilde);La["\u00f6"]=new C("\u00f6",Box4Intl.Box4Strings.L_LatinSmallLetterOWithDiaeresis);La["\u00f9"]=new C("\u00f9",Box4Intl.Box4Strings.L_LatinSmallLetterUWithGrave);La["\u00fa"]=new C("\u00fa",Box4Intl.Box4Strings.L_LatinSmallLetterUWithAcute);La["\u00fb"]=new C("\u00fb",Box4Intl.Box4Strings.L_LatinSmallLetterUWithCircumflex);La["\u00fc"]=new C("\u00fc",Box4Intl.Box4Strings.L_LatinSmallLetterUWithDiaeresis);
La["\u00ff"]=new C("\u00ff",Box4Intl.Box4Strings.L_LatinSmallLetterYWithDiaeresis);La["\u011e"]=new C("\u011e",Box4Intl.Box4Strings.L_LatinCapitalLetterGWithBreve);La["\u011f"]=new C("\u011f",Box4Intl.Box4Strings.L_LatinSmallLetterGWithBreve);La["\u0130"]=new C("\u0130",Box4Intl.Box4Strings.L_LatinCapitalLetterIWithDotAbove);La["\u0131"]=new C("\u0131",Box4Intl.Box4Strings.L_LatinSmallLetterDotlessI);La["\u0152"]=new C("\u0152",Box4Intl.Box4Strings.L_LatinCapitalLigatureOe);La["\u0153"]=new C("\u0153",
Box4Intl.Box4Strings.L_LatinSmallLigatureOe);La["\u015e"]=new C("\u015e",Box4Intl.Box4Strings.L_LatinCapitalLetterSWithCedilla);La["\u015f"]=new C("\u015f",Box4Intl.Box4Strings.L_LatinSmallLetterSWithCedilla);La["\u0178"]=new C("\u0178",Box4Intl.Box4Strings.L_LatinCapitalLetterYWithDiaeresis);return La}}Object(h.a)(pa,"SymbolsLoader",null,[603]);var Z=d(45),qa=d(346),ya=d(290),Ka=d(221),Da=d(774),la=d(1196),ma=d(134),Ea=d(73);class ta{constructor(La){this.pYh=La}get dnc(){return this.pYh}get $kl(){return'<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>'}D5g(La){La=
La.SourceControlId.split("_");const lb={};2===La.length?(lb.character=La[1],lb.index=this.dnc.P7i(lb.character)):(lb.character=La[2],lb.index=parseInt(La[1]));return lb}bhi(){return this.Fgg()}build(){return this.H3d()}rgi(){const La=new Sys.StringBuilder;La.append('<table class="moreSymbolsTable">');const lb=this.dnc.Rkd.value,Nb=O.a(lb);let lc=0;for(;lc<Nb.length;){lc%15||La.append('<tr role="presentation">');const Rc=lb[Nb[lc]];La.append(String.format('<td unselectable="on">\r\n\t\t\t\t\t<div unselectable="on" role="presentation">\r\n\t\t\t\t\t\t<a id="{0}" aria-label="{2}" title="{2}" role="button" tabindex="0" unselectable="on">{1}</a>\r\n\t\t\t\t\t</div></td>',
"symbol_d_"+lc,Z.a.URa(Rc.Qkd),Z.a.URa(Rc.altText)));lc++;lc%15&&lc!==Nb.length||La.append("</tr>")}La.append("</table>");return La.toString()}H3d(){const La=this.Fgg();return ma.l(La)}Fgg(){const La=Object.assign(new qa.a,{Id:"menuSymbolsDropDown",MenuSectionList:[]});Array.add(La.MenuSectionList,this.W3h());e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("InsertMoreSymbolsIsEnabled")&&Array.add(La.MenuSectionList,this.E2h());return La}E2h(){const La=Object.assign(new ya.a,{Id:"msMoreSymbols",
Title:"",DisplayMode:"Menu16",ControlsId:"ctrlMoreSymbols",ControlList:[]}),lb=Object.assign(new Ka.a,{Id:"btnMoreSymbols",Command:"3574218963",LabelText:Z.a.je(Box4Intl.Box4Strings.L_InsertMoreSymbols),Alt:Z.a.je(Box4Intl.Box4Strings.L_InsertMoreSymbols),Image16by16:e.AFrameworkApplication.gm,Image16by16Class:Ea.getImageClass("Symbol_16x16x32"),KeyTip:CommonUIStrings.l_InsertMoreSymbolsKeytip});Array.add(La.ControlList,lb);return La}W3h(){const La=Object.assign(new ya.a,{Id:"msSymbolsPosition",ShowMenuSectionSeparator:!1,
ControlList:[]}),lb=Object.assign(new Da.a,{Type:1,Id:"gallerySymbolsPosition",ExternalId:"InsertSymbols",ExternalGalleryId:"InsertSymbolGallery",Width:5,ElementDimensions:"Size16by16",GalleryItems:[]}),Nb=this.dnc.Rkd.value,lc=O.a(Nb),Rc=Math.min(25,lc.length);for(let Pd=0;Pd<Rc;Pd++){var Ud=Nb[lc[Pd]];Ud=Object.assign(new la.a,{Id:String.format("{0}{1}_{2}","symbol_",Pd,Ud.Qkd),Character:Ud.Qkd,Command:"3966968829",QueryCommand:"816646517",Alt:Z.a.je(Ud.altText)});lb.GalleryItems.push(Ud)}Array.add(La.ControlList,
lb);return La}}Object(h.a)(ta,"SymbolsUiBuilder",null,[602]);var Ga=d(62),oa=d(120),sa=d(34),Ha=d(504),bb=d(292);class Ya{constructor(){this.Da=null}get name(){return"Box4.Symbols"}init(){e.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled")&&this.Da.resolve("Box4.Symbols.ISymbolsActor").ub()}dispose(){}Wb(La){this.Da=La;this.Da.register(pa,"Box4.Symbols.SymbolsLoader").as("Box4.Symbols.ISymbolsLoader").ma();this.Da.register(ta,"Box4.Symbols.SymbolsUiBuilder").as("Box4.Symbols.ISymbolsUIBuilder").ma().na(()=>
new ta(this.Da.resolve("Box4.Symbols.ISymbolsLoader")));this.Da.register(ja,"Box4.Symbols.SymbolsActor").as("Box4.Symbols.ISymbolsActor").ma().na(()=>new ja(e.AFrameworkApplication.Ta,new Ha.a,new bb.a,this.Da.resolve("Box4.Symbols.ISymbolsUIBuilder"),oa.a.instance,sa.a.instance,Ga.a.instance,this.Da.Ka("Box4.IExternalSelectionManager")))}static main(){m.a.instance.Bc(new Ya)}}Object(h.a)(Ya,"Box4SymbolsPackage",null,[2,3]);var ua=d(1029),Ma=d(33),Ca=d(80),Va=d(436);class Za{constructor(La,lb){this.ODd=
this.NDd=null;this.Ymb=new ua.a;this.$h=La;this.Waa=lb.appSettings[Za.zCl]||""}get p$k(){return this.Ymb.task}get oba(){return this.$h.value}iVk(){const La={};La[Za.Asj]=e.AFrameworkApplication.hh;La["Content-Type"]="application/json; charset=utf-8";r.ULS.sendTraceTag(6612806,215,50,"Client is sending a request to get the code for the O365 switcher");const lb=Ca.a.Ri(this.Waa+Za.q$k,Za.Pik,e.AFrameworkApplication.Aa.jb.rm.toString());this.oba.yj(lb,1,"",La,!0,2,Object(u.a)(this,this.Jye,"onSuccessCallback"),
Object(u.a)(this,this.Dec,"onFailureCallback"),null,void 0,void 0,void 0,void 0,"20")}oZj(La){try{const lb={};lb.FlightName=La.FlightName;lb.SessionID=La.SessionID;r.ULS.sendTraceTag(594883776,215,50,Ma.c(lb))}catch(lb){r.ULS.sendTraceTag(594883747,215,10,"Unable to log NavBarData")}}Jye(La){if((La=La.data.Sd)&&La.length)try{const lb=Ma.a(La);this.NDd=lb.NavBarDataJson;r.ULS.sendTraceTag(41551899,215,50,"Skipping call to TryLoadResources for React Shared Header.");this.NDd?({ou:this.ODd}=Ma.d(lb.NavBarDataJson)).returnValue?
(this.oZj(this.ODd),this.Ymb.Dg(this.ODd)):(r.ULS.sendTraceTag(7660113,215,10,"Failed to deserialize : {0}",{["ShellData"]:Va.a.woc(this.NDd)}),this.Ymb.w0()):(r.ULS.sendTraceTag(9000737,215,15,"ShellData is null"),this.Ymb.w0())}catch(lb){r.ULS.sendTraceTag(6362370,215,10,"Unable to parse the response from O365ShellServiceProxy."),this.Ymb.w0()}else r.ULS.sendTraceTag(6362369,215,10,"Response from O365ShellServiceProxy is null.")}Dec(){this.Ymb.w0();r.ULS.sendTraceTag(7608091,215,10,"Call to O365ShellServiceProxy failed.")}static get instance(){return Za.Ja||
(Za.Ja=Za.J6a())}static J6a(){return new Za(new y.a(()=>e.AFrameworkApplication.Ge),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.jb.rm)}}Za.Asj="X-qs";Za.Pik="at";Za.q$k="O365ShellServiceProxy.ashx";Za.Ja=null;Za.zCl="ShellWebServiceBase";Object(h.a)(Za,"O365ShellActor",null,[648]);class Db{constructor(){this.Da=null}get name(){return"Common.App.O365Shell"}Wb(La){this.Da=La;this.Da.register(Za,"Common.App.O365Shell.O365ShellActor").as("Common.App.O365Shell.IO365ShellActor").ma().na(()=>new Za(new y.a(()=>
e.AFrameworkApplication.Ge),e.AFrameworkApplication.fa,e.AFrameworkApplication.Aa.jb.rm))}init(){e.AFrameworkApplication.fa.ff(Object(u.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){e.AFrameworkApplication.ood&&e.AFrameworkApplication.Aa.jb.xN&&this.Da.resolve("Common.App.O365Shell.O365ShellActor").iVk()}dispose(){}static main(){m.a.instance.Bc(new Db)}}Object(h.a)(Db,"PackageManager",null,[2,3]);var Lb=d(77),yb=d(281);class Bc{constructor(La){this.Pa=new Lb.a;this.yH=La}CBc(La){this.Pa.addHandler(Bc.Wxa,
La)}oGe(La){this.Pa.removeHandler(Bc.Wxa,La)}LNe(){this.Pa.raiseEvent(Bc.XGb)}KNe(){this.Pa.raiseEvent(Bc.YGb)}}Bc.XGb="SE";Bc.YGb="SEP";Bc.Wxa="SER";Bc.OSe="TRP";Object(h.a)(Bc,"NullSessionExpirationManager",null,[616,617]);var tb=d(163);class Mb{constructor(){this.aSb=this.fNa=!1;const La=e.AFrameworkApplication.Wl;0>=La||(this.Wl=La,r.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{["AccessTokenTtl"]:this.Wl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.hba}),
yb.a.instance.TId(Object(u.a)(this,this.GDb,"onSessionExpiredDetected")),yb.a.instance.RId(Object(u.a)(this,this.afc,"onSessionExpiringDetected")))}GDb(){yb.a.instance.Nfh(Object(u.a)(this,this.GDb,"onSessionExpiredDetected"));r.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.B5d()}afc(){yb.a.instance.HSk(Object(u.a)(this,this.afc,"onSessionExpiringDetected"));this.aSb||this.fNa||(r.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.aSb=!0,
this.xOe())}B5d(){this.fNa||(e.AFrameworkApplication.jp(tb.a.sessionAccessTokenExpired),this.fNa=!0,this.Jjd())}}Object(h.a)(Mb,"ASessionExpirationManager",null,[]);var Hb=d(286),vb=d(35);class Xb{constructor(La,lb,Nb,lc){this.dSe="";this.lqc=La;this.rwf=Nb;this.owf=lc;this.P9e=lb;La=(new Date(this.lqc)).format(e.AFrameworkApplication.nqh);this.dSe=this.P9e?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,La)}VGb(La){1===La?this.rwf&&this.rwf(this.P9e):
0===La&&e.AFrameworkApplication.Ta.La(vb.a.close,2,Hb.g)}dispose(){this.owf&&this.owf()}}Xb.id="SessionExpirationDialog";Object(h.a)(Xb,"SessionExpirationDialogSharedProperties",null,[]);class Uc{}Uc.mg="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>";Object(h.a)(Uc,"SessionExpirationDialogHtml",null,[]);class hb extends E.a{constructor(La,lb,Nb,lc){super(lb);const Rc={};this.Tza=new Xb(La,lb,Nb,
lc);this.ng=Xb.id;e.AFrameworkApplication.xNf?(this.yd=1,this.Ue(0,CommonUIStrings.l_DialogClose)):(this.yd=0,this.qr=!1);lb||1===e.AFrameworkApplication.Aa.mode?this.Ue(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ue(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.mg=Uc.mg;Rc.WACSessionExpirationText=this.Tza.dSe;this.tj(CommonUIStrings.l_DefaultDialogTitle,Object(u.a)(this,this.VGb,"sessionExpirationDialogHandler"),Rc);this.i5(this.ji("WACSessionExpirationText"))}VGb(La){this.Tza.VGb(La)}BTc(){return this.iQ}i3b(){this.hide()}dispose(){super.dispose();
this.Tza&&this.Tza.dispose()}}Object(h.a)(hb,"LegacySessionExpirationDialog",E.a,[719]);var Zb=d(104);class Fc extends Zb.StandardDialog{constructor(La,lb,Nb,lc){super(lb);this.Tza=new Xb(La,lb,Nb,lc);this.ng=Xb.id;e.AFrameworkApplication.xNf?(this.yd=1,this.Ue(0,CommonUIStrings.l_DialogClose)):(this.yd=0,this.qr=!1);lb||1===e.AFrameworkApplication.Aa.mode?this.Ue(1,CommonUIStrings.l_SessionExpirationRefreshButton):this.Ue(1,CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);this.nx(CommonUIStrings.l_DefaultDialogTitle,
this.Tza.dSe,0,Object(u.a)(this,this.VGb,"sessionExpirationDialogHandler"))}VGb(La){this.Tza.VGb(La)}BTc(){return this.iQ}i3b(){this.hide()}dispose(){super.dispose();this.Tza&&this.Tza.dispose()}}Object(h.a)(Fc,"SessionExpirationDialog",Zb.StandardDialog,[719]);const ob=(La,lb,Nb,lc)=>e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.jb.gC&&e.AFrameworkApplication.fa.ka("ReactStandardSessionExpirationDialogIsEnabled")?new Fc(La,lb,Nb,lc):new hb(La,lb,Nb,lc);var ac=d(245);class pb extends Mb{constructor(La){super();
this.$mb=this.anb=!0;this.kP=null;this.Pa=new Lb.a;this.yH=La}CBc(La){this.Pa.addHandler(pb.Wxa,La)}oGe(La){this.Pa.removeHandler(pb.Wxa,La)}LNe(La){this.anb=La}KNe(La){this.$mb=La}xOe(){if(!this.kP&&!ac.a.Mw){if(this.$mb){const La=Object(u.a)(this,this.srb,"disposeCallback");this.kP=ob(this.Wl,!1,Object(u.a)(this,this.WGb,"sessionExpirationHandler"),La)}this.Pa.raiseEvent(pb.YGb)}}Jjd(){this.kP&&(this.kP.BTc()&&this.kP.i3b(),this.kP=null);if(this.anb){const La=Object(u.a)(this,this.srb,"disposeCallback");
this.kP=ob(this.Wl,!0,Object(u.a)(this,this.WGb,"sessionExpirationHandler"),La)}this.Pa.raiseEvent(pb.XGb)}srb(){this.kP=null}WGb(){this.yH.refreshDocument(null)}}pb.XGb="SE";pb.YGb="SEP";pb.Wxa="SER";pb.OSe="TRP";Object(h.a)(pb,"SessionExpirationManager",Mb,[616,617]);var nb=d(17);class Tb{}Tb.Q_h="Aborting";Tb.JAc="ActivityDuration";Tb.error="Error";Tb.XVd="Errors";Tb.failed="Failed";Tb.WKc="FirstActivity";Tb.initialized="Initialized";Tb.ETj="KickedOut";Tb.MTj="LastActivity";Tb.sih="RetryOverride";
Tb.lfd="RequestGroups";Tb.QXa="Requests";Tb.wfd="Responses";Tb.ehd="SessionDuration";Tb.status="Status";Tb.success="Success";Tb.pkl="Successful";Tb.tokens="Tokens";Tb.NAe="PollingDuration";Object(h.a)(Tb,"SessionExpirationStrings",null,[]);var Ub=d(78);class hc{constructor(La){this.ry={};this.S5={};this.LMa={};this.uDg=15;this.Jcf=!1;this.JWh=new Date;this.fvc=new Date;this.Rd=La;this.K6=new Ub.a(2,2,6E4*this.uDg,Object(u.a)(this,this.JGh,"writeMeasures"),135,"SL",!1);this.Rd.Cb(this.K6);this.bAj()}JGh(){r.ULS.sendTraceTag(41964821,
217,50,r.ULS.lde({["Aggregate"]:this.S5,["Current"]:this.ry}))}bAj(){this.S5[Tb.lfd]=0;this.S5[Tb.QXa]=0;this.S5[Tb.wfd]=0;this.S5[Tb.status]=Tb.initialized;this.S5[Tb.WKc]=new Date;this.S5[Tb.ehd]=0;this.S5[Tb.JAc]=0;this.S5[Tb.ehd]=0;this.ry[Tb.ehd]=0;this.S5[Tb.JAc]=0;this.ry[Tb.JAc]=0}get dyk(){this.LMa[Tb.NAe]=+new Date-+this.LMa[Tb.WKc];return this.LMa}G7d(La,lb){var Nb=La[lb];Nb=Nb?Nb:0;Nb++;La[lb]=Nb;this.VKe(La)}VKe(La){const lb=new Date;La[Tb.JAc]=+lb-+this.fvc;this.fvc=lb;La[Tb.ehd]=+this.fvc-
+this.JWh;La[Tb.MTj]=this.fvc}aY(La,lb){this.ry[La]=lb;this.VKe(this.ry)}wKe(La,lb){this.ry[La]=lb;this.VKe(this.ry)}bvb(La){this.G7d(this.ry,La);this.G7d(this.S5,La);this.G7d(this.LMa,La)}flush(){this.Jcf||(this.S5[Tb.status]=this.ry[Tb.status],this.JGh(this.K6),this.Rd.a5(this.K6,6E4*this.uDg))}IVk(){const La=this.ry[Tb.status];La&&(this.S5[Tb.status]=La);this.ry={}}QVk(){this.LMa={};this.LMa[Tb.NAe]=0;this.LMa[Tb.WKc]=new Date}stop(){r.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");
this.flush();this.Jcf=!0;this.Rd.Ng(this.K6)}}Object(h.a)(hc,"SessionLogger",null,[612]);class Wb{constructor(La,lb){this.Jzc=La;this.iga=lb}get tokens(){return this.Jzc}get errors(){return this.iga}}Object(h.a)(Wb,"TokenRefreshArgs",null,[649]);var fd=d(94),fc=d(195),bc=d(132);class cc extends Sys.EventArgs{constructor(La,lb,Nb,lc,Rc,Ud,Pd){super();this.LMa=La;this.lfd=lc;this.failed=Rc;this.QXa=Ud;this.wfd=Pd}}Object(h.a)(cc,"WaitingForTokenRefreshPollingArgs",Sys.EventArgs,[]);var kb=d(87);class ab{constructor(La,
lb=null,Nb=null){this.aSb=this.fNa=!1;this.$mb=this.anb=!0;this.Pa=new Lb.a;this.cSb=this.uPb=this.Ixc=!1;this.sBd=null;this.vlf=10;this.Kuc=!1;this.KFd=La;this.Gxd=e.AFrameworkApplication.ISj;this.Rd=bc.a.instance;r.ULS.sendTraceTag(39408093,217,50,"Initializing SessionExpirationManagerWithRefresh. {0}",{["AccessTokenTtl"]:e.AFrameworkApplication.Wl,["NowGetTime"]:(new Date).getTime(),["BootTime"]:e.AFrameworkApplication.hba});this.Eh=lb||new hc(bc.a.instance);this.$ga=Nb;yb.a.instance.TId(Object(u.a)(this,
this.L_h,"aSessionExpirationManagerWithRefresh_OnSessionExpired"));yb.a.instance.RId(Object(u.a)(this,this.XGd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));fc.SessionStatusManager.instance.JId(Object(u.a)(this,this.XGd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"));fc.SessionStatusManager.instance.r7h(Object(u.a)(this,this.qBk,"preemptiveTokenRefresh"));this.xef=new Date;e.AFrameworkApplication.HSj&&(yb.a.instance.yNd=Object(u.a)(this,this.RLk,"refreshAccessTokenWhenSessionExpired"));
La=!1;e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollingIsEnabled",!1),this.vlf=e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.TokenRefreshPollInterval",10),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),La=e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShouldResetLastAttemptWhenNetworkResumed",!1));
La?fc.SessionStatusManager.instance.JId(Object(u.a)(this,this.M_h,"aSessionExpirationManagerWithRefresh_OnSessionExpiringNetworkResumed")):fc.SessionStatusManager.instance.JId(Object(u.a)(this,this.XGd,"aSessionExpirationManagerWithRefresh_OnSessionExpiring"))}CBc(La){this.Pa.addHandler(ab.Wxa,La)}oGe(La){this.Pa.removeHandler(ab.Wxa,La)}RLk(){this.M2b(!1);return!yb.a.instance.nEa(e.AFrameworkApplication.Wl)}L_h(La,lb){yb.a.instance.EVc?this.GDb(La,lb):this.Gxd?(this.uPb=!1,this.M2b(!1)):(this.fNa||
r.ULS.sendTraceTag(520954892,217,15,"Detected session expiry before token refresh got blocked"),this.GDb(La,lb))}M_h(La,lb){yb.a.instance.CVc?this.afc(La,lb):(ia.c(512247769,306,50,"Refreshing tokens since the user has network and session is expiring."),this.uPb=!1,this.M2b(!0))}XGd(La,lb){yb.a.instance.CVc?this.afc(La,lb):this.M2b(!0)}M2b(La){if(!this.Ixc&&!this.uPb)if(this.$ga&&this.$ga.m9a)this.cSb=!0,this.Eh.aY(Tb.status,Tb.ETj),this.Eh.flush(),this.Eh.stop();else if(r.ULS.sendTraceTag(40420955,
217,50,"HandleTokenRefresh, IsExpiring:{0}. ShouldAbort: {1}",La,this.cSb),this.cSb)this.Jjd();else{this.Eh.flush();this.Eh.IVk();this.Eh.bvb(Tb.lfd);this.Ixc=!0;this.Kuc||(this.Eh.QVk(),this.Kuc=!0,this.Mxi());const lb=this.KFd.kMk(La);lb.continueWith(()=>{if(this.KFd.RDk(lb))this.Eh.bvb(Tb.pkl),this.Eh.aY(Tb.status,Tb.success),this.$mb=!1,this.Gxd&&(this.anb=!1),this.uPb=!1,this.xef=new Date,this.Bjl(),this.Pa.raiseEvent(ab.Wxa,new Wb(lb.result.tokens,null));else{const Nb=lb.result.errors;this.Eh.bvb(Tb.failed);
this.Eh.aY(Tb.status,Tb.failed);La||(this.cSb=this.KFd.E5b(Nb));this.cSb&&(this.Eh.aY(Tb.Q_h,JSON.stringify(Nb)),r.ULS.sendTraceTag(520954891,217,15,"Aborting token refresh"));this.uPb=!0;this.Pa.raiseEvent(ab.Wxa,new Wb(null,Nb))}this.Eh.flush();this.Ixc=!1})}}GDb(){this.Gxd||yb.a.instance.Nfh(Object(u.a)(this,this.GDb,"onSessionExpiredDetected"));r.ULS.sendTraceTag(39408094,217,50,"SessionExpiredDetected");this.B5d(yb.a.instance.EVc)}afc(){this.aSb||this.fNa||(r.ULS.sendTraceTag(39408095,217,50,
"SessionExpiringDetected - Showing expiring dialog."),this.aSb=!0,this.xOe(yb.a.instance.CVc))}B5d(La){if(!this.fNa){var lb=La?tb.a.Y1k:tb.a.sessionAccessTokenExpired;const Nb=Object.assign(new kb.a,{extendedProperties:new Map});Nb.extendedProperties.set("ErrorCode",String.format("{0}",lb));e.AFrameworkApplication.jp(lb,void 0,["SessionExpired"],Nb);La||(La=new Date,lb=new Date(e.AFrameworkApplication.hba),r.ULS.sendTraceTag(51642974,217,50,"Sending data to QoS. BootTime=[{0}], Now=[{1}], Duration=[{2}]",
lb,La,+La-+lb),864E5>+La-+lb&&fd.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanOneDay",["SessionExpired"],!0,!0,!1,!0,Nb),2592E5>+La-+lb&&fd.Health.instance.recordQosError("SessionAccessTokenExpiredInLessThanThreeDays",["SessionExpired"],!0,!0,!1,!0,Nb));this.fNa=!0;this.Jjd()}}Bjl(){this.Kuc&&(this.Rd.Ng(this.sBd),this.Kuc=!1)}Mxi(){this.sBd=new Ub.a(2,2,1E3*this.vlf,Object(u.a)(this,this.epl,"tokenRefreshPolling"),135);this.Rd.Cb(this.sBd)}epl(){const La=this.Eh.dyk;r.ULS.sendTraceTag(555255521,
217,50,"{0}",Ma.c(La));this.Pa.raiseEvent(ab.OSe,new cc(La,La[Tb.NAe],La[Tb.WKc],La[Tb.lfd],La[Tb.failed],La[Tb.QXa],La[Tb.wfd]))}qBk(){3E5<+new Date-+this.xef?(r.ULS.sendTraceTag(528867867,217,50,"Attempting pre-emptive token refresh."),this.M2b(!1)):r.ULS.sendTraceTag(528867868,217,50,"Last Token Refresh was performed less than 5 mins ago. Not refreshing token.")}}ab.XGb="SE";ab.YGb="SEP";ab.Wxa="SER";ab.OSe="TRP";Object(h.a)(ab,"ASessionExpirationManagerWithRefresh",null,[]);class Pb extends ab{constructor(La,
lb,Nb=null,lc=null){super(lb,Nb,lc);this.kP=null;this.yH=La}LNe(La){this.anb=La}KNe(La){this.$mb=La}xOe(La){if(!this.kP&&!ac.a.Mw){if(La){var lb=Object(u.a)(this,this.srb,"disposeCallback");this.kP=ob(e.AFrameworkApplication.BGb,!1,Object(u.a)(this,this.WGb,"sessionExpirationHandler"),lb)}else if(this.$mb){if(this.Ixc)return;lb=Object(u.a)(this,this.srb,"disposeCallback");this.kP=ob(e.AFrameworkApplication.Wl,!1,Object(u.a)(this,this.WGb,"sessionExpirationHandler"),lb)}r.ULS.sendTraceTag(39408096,
217,50,"Raising event: [{0}] IsScheduledShutdown: [{1}]",ab.YGb,La);this.Pa.raiseEvent(ab.YGb)}}Jjd(){this.kP&&(this.kP.BTc()&&this.kP.i3b(),this.kP=null);if(this.anb){this.Eh.stop();if(this.$ga&&this.$ga.m9a)return;const La=Object(u.a)(this,this.srb,"disposeCallback");this.kP=ob(e.AFrameworkApplication.Wl,!0,Object(u.a)(this,this.WGb,"sessionExpirationHandler"),La)}r.ULS.sendTraceTag(39408097,217,50,"Raising event {0}",ab.XGb);this.Pa.raiseEvent(ab.XGb)}srb(){this.kP=null}WGb(){this.yH.refreshDocument(null)}}
Object(h.a)(Pb,"SessionExpirationManagerWithRefresh",ab,[616,617]);class rc{constructor(La,lb,Nb=null,lc=null){this.DAf=!1;this.Ja=null;this.utc=La;this.kMa=lb;this.Eh=Nb||new hc(bc.a.instance);this.$ga=lc}create(){this.DAf=e.AFrameworkApplication.Kz;if(!this.DAf)return new pb(this.utc);e.AFrameworkApplication.Wj("WOPITokenRefreshIsEnabled");r.ULS.sendTraceTag(39408088,217,50,"App has requested custom Session Expiration Manager");if(!this.Ja)switch(e.AFrameworkApplication.MCl){case 1:r.ULS.sendTraceTag(39408090,
217,50,"Creating new NullSessionExpirationManager");this.Ja=new Bc(this.utc);break;case 2:r.ULS.sendTraceTag(39408091,217,50,"Creating new SessionExpirationManagerWithRefresh");this.Ja=new Pb(this.utc,this.kMa,this.Eh,this.$ga);break;default:r.ULS.sendTraceTag(39408092,217,50,"Creating new legacy SessionExpirationManager"),this.Ja=new pb(this.utc)}r.ULS.sendTraceTag(39408089,217,50,"Returning instance of Session Expiration Manager: {0}",Object.getType(this.Ja).getName());return this.Ja}}Object(h.a)(rc,
"SessionExpirationManagerFactory",null,[615]);var ic=d(1166),md=d(22);class Fd{}Object(h.a)(Fd,"Error",null,[]);class ne{}Object(h.a)(ne,"NamedResult",null,[]);class ud extends ne{}Object(h.a)(ud,"ErrorInfo",ne,[]);var gb=d(106),Vb=d(171),Lc=d(125),Xc=d(694);class Ib{constructor(La,lb,Nb,lc=null,Rc=!1,Ud=null,Pd=!1,Sd=!1){this.Kza=0;this.Bpa=this.Lm=null;this.Jzc=new nb.a;this.iga=new nb.a;this.Nv=null;this.lPb=!1;this.QSb=this.RSb=null;this.Rd=La;this.Elf=lb;this.Elf.execute(Le=>{Le.kB(Lc.a.W6d,
Object(u.a)(this,this.$mk,"onHostResponseReceived"))});this.LR=Nb;this.Izf=new Xc.a("WebServiceCall","TokenRefresh");this.Eh=lc||new hc(La);this.EWh=Rc;this.tpa=Ud?Ud:fc.SessionStatusManager.instance;this.u3e=Pd;this.Msc=Sd}$mk(La){if(La.MessageId!==Lc.a.W6d)ia.c(39408099,306,15,"Unexpected message.");else{var lb=new nb.a,Nb=new nb.a;this.Eh.bvb(Tb.wfd);var lc=La.Values[Vb.a.emh];if(!lc||0>=lc.length)ia.c(40122317,306,15,"Found no tokens in the dictionary"),lc=La.Values;ia.c(40122318,306,100,"The Tokens array contains {0} tokens",
lc.length);this.Eh.aY("Correlation",La.CorrelationId);var Rc="";for(let Sd=0;Sd<lc.length;Sd++){this.Eh.wKe(Tb.tokens,lc.length);var Ud=lc[Sd],Pd=Ud;if(!Pd||!Pd.Name)continue;this.Eh.bvb(Pd.Name);const Le=Ud;if(Le&&Le.Value)ia.c(39408128,306,100,"Received token with name: {0}",Le.Name),lb.add(Le),this.Jzc.add(Le),this.Msc||this.Eh.aY(Tb.status,Tb.success),this.u3e&&this.tpa&&this.tpa.cWk();else if(Ud=this.Ndj(Ud),ia.c(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",
Pd.Name,JSON.stringify(Ud),this.Bpa),Nb.add(Ud),this.Msc||(this.iga.add(Ud),Rc=JSON.stringify(Ud),this.Eh.aY(Tb.error,JSON.stringify(Ud)),this.Eh.aY(Tb.status,Tb.failed)),this.u3e)for(const af of Ud.Errors)Pd=this.b5i(af),this.tpa&&this.tpa.q4h(Pd)}this.Msc?(0<Nb.count?this.QSb?this.QSb(new Wb(lb,Nb)):ia.c(512267295,306,15,"Received errors but the promise has completed"):this.RSb?this.RSb(new Wb(lb,Nb)):ia.c(512267294,306,15,"Received valid tokens but the promise has completed"),ia.c(512344162,306,
50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",lb.count,Nb.count,La.CorrelationId,this.Bpa)):(0<Nb.count&&""!==Rc?(lc=Object.assign(new kb.a,{extendedProperties:new Map}),lc.extendedProperties.set("Errors",Rc),lc.extendedProperties.set("RetryCount",this.Kza.toString()),lc.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString()),lc.extendedProperties.set("IsTokenExpiring",this.lPb.toString()),fd.Health.instance.recordKpiFailure("WACTokenRefresh",
"TokenRefreshFailed",!1,!1,lc)):fd.Health.instance.recordKpiSuccess("WACTokenRefresh",null),ia.c(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",lb.count,Nb.count,La.CorrelationId,this.Bpa),0<Nb.count&&!this.E5b(Nb)?(La=this.LR.Zeg(Nb),La!==this.LR.pGb&&(this.Eh.wKe(Tb.sih,La),this.Rd.a5(this.Lm,La))):(this.Eh.flush(),this.Lm&&(ia.c(39408131,306,100,"Deleting task {0} from task manager",this.Lm.name),this.Rd.Ng(this.Lm)),this.Nv&&!this.Nv.task.isCompleted?
this.Nv.Dg(new Wb(lb,Nb)):ia.c(512267293,306,15,"Received results but the task has completed")))}}Ndj(La){if(!La)return null;const lb=Object.assign(new ud,{Name:La.Name,Errors:[]});for(const Nb of La.Errors)La=new Fd,La.Id=Nb.Id,La.Details=Z.a.ROc(Nb.Details,500),lb.Errors.push(La);return lb}requestTokensOnce(){this.whh()}whh(){e.AFrameworkApplication.qta("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.Kza>=this.LR.DUg?(ia.c(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",
this.Bpa),this.kzi(this.Nv)):(fd.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.zlh())}zlh(){const La={};La[Vb.a.emh]=this.LR.tokens;const lb=gb.a.create().toString();ia.c(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.LR.tokens),this.Kza+1,lb,this.Bpa);this.Elf.execute(Nb=>{Nb.sendMessage(Lc.a.OJd,La,lb)});this.Kza++;this.Eh.bvb(Tb.QXa)}kzi(La){const lb=new nb.a;for(let Nb=0;Nb<this.LR.tokens.length;Nb++){const lc=Object.assign(new ud,
{Name:this.LR.tokens[Nb],Errors:[Object.assign(new Fd,{Id:"TOO_MANY_ATTEMPTS",Details:"We did not receive a new token from the host after the maximum allowed number of attempts"})]});lb.add(lc);this.iga.add(lc)}this.Rd.Ng(this.Lm);this.Eh.aY(Tb.XVd,JSON.stringify(this.iga));this.Eh.aY(Tb.status,Tb.failed);La&&!La.task.isCompleted&&La.Dg(new Wb(new nb.a,this.iga))}kMk(La){e.AFrameworkApplication.qta("258ec738;j5j99381");e.AFrameworkApplication.qta("85gid169;g470d326");this.Izf.start();this.lPb=La;
this.Bpa=gb.a.create().toString();ia.c(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Bpa,this.lPb);this.Kza=0;this.iga.clear();this.Jzc.clear();this.Nv=new ua.a;this.Msc?this.xhh(this.LR.DUg).then(lb=>{this.Nv&&!this.Nv.task.isCompleted&&this.Nv.Dg(lb);this.QSb=this.RSb=null;this.Eh.aY(Tb.XVd,JSON.stringify(this.iga));this.Eh.aY(Tb.status,Tb.success);this.Eh.flush()}).catch(lb=>{this.Nv&&!this.Nv.task.isCompleted&&this.Nv.Dg(Object(ic.a)(649,lb));this.QSb=this.RSb=
null;this.Eh.aY(Tb.XVd,JSON.stringify(this.iga));this.Eh.aY(Tb.status,Tb.failed);this.Eh.flush()}):(this.Lm=new Ub.a(this.LR.priority,2,this.LR.pGb,Object(u.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,Lc.a.OJd,!0),this.EWh&&this.whh(),this.Rd.Cb(this.Lm));return this.Nv.task}xhh(La){const lb=this,Nb=new Promise((Sd,Le)=>{lb.RSb=Sd;lb.QSb=Le;fd.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null);lb.zlh()}),lc=this,Rc=new Promise((Sd,Le)=>{window.setTimeout(()=>{Le(lc.mUf("TIMEOUT",
"We did not receive a new token from the host after the maximum allowed time"))},lc.LR.pGb)});let Ud=La;const Pd=this;return new Promise((Sd,Le)=>{Ud--;Promise.race([Nb,Rc]).then(af=>{fd.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Sd(af)}).catch(af=>{var zf=Pd.LR.pGb;if(Object(md.a)(649,af)&&(af=Object(ic.a)(649,af),0<af.errors.count)){Pd.hYj(af.errors);Pd.eDf(af.errors);if(Pd.E5b(af.errors)){Le(af);return}const yh=Pd.LR.Zeg(af.errors);yh!==Pd.LR.pGb?(Pd.Eh.wKe(Tb.sih,yh),zf=yh):Pd.hRj(af.errors)&&
(zf=0)}Ud?window.setTimeout(()=>{Pd.xhh(Ud).then(Sd).catch(Le)},zf):(zf=Pd.mUf("TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts"),Pd.eDf(zf.errors),Le(zf),ia.c(512267292,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",Pd.Bpa))})})}eDf(La){for(let lb of La)this.iga.add(lb)}hRj(La){if(!La.count)return!1;La=La.ga(La.count-1);return La.Errors.length?"TIMEOUT"==La.Errors[0].Id:!1}mUf(La,lb){const Nb=new nb.a;for(let lc=0;lc<
this.LR.tokens.length;lc++){const Rc=this.lzi(this.LR.tokens[lc],La,lb);Nb.add(Rc)}return new Wb(new nb.a,Nb)}lzi(La,lb,Nb){return Object.assign(new ud,{Name:La,Errors:[Object.assign(new Fd,{Id:lb,Details:Nb})]})}hYj(La){if(La.count){La=La.ga(La.count-1);La=JSON.stringify(La);var lb=Object.assign(new kb.a,{extendedProperties:new Map});lb.extendedProperties.set("Errors",La);lb.extendedProperties.set("RetryCount",this.Kza.toString());lb.extendedProperties.set("NavigatorOnline",window.navigator.onLine.toString());
lb.extendedProperties.set("IsTokenExpiring",this.lPb.toString());fd.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,lb);this.Eh.aY(Tb.error,La);this.Eh.aY(Tb.status,Tb.failed)}}RDk(La){this.Izf.stop();const lb=this.Wsj(La.result.errors);r.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",!lb,this.Bpa,this.lPb,
this.Kza,this.iga.count,0<La.result.errors.count?La.result.errors.ga(0).Name:"",0<La.result.errors.count&&0<La.result.errors.ga(0).Errors.length?La.result.errors.ga(0).Errors[0].Id:"",0<La.result.errors.count&&0<La.result.errors.ga(0).Errors.length?La.result.errors.ga(0).Errors[0].Details:"");return lb?!1:this.QDk(La.result.tokens)}E5b(La){return this.LR.E5b(La)}QDk(La){for(let lb=0;lb<La.count;lb++){const Nb=La.ga(lb);if(Nb.Name===Vb.a.accessToken){const lc=(new Date).getTime();Nb.Expiry>e.AFrameworkApplication.Wl?
(r.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",{["AccessTokenTtl"]:Nb.Expiry,["NowGetTime"]:lc,["BootTime"]:e.AFrameworkApplication.hba},"PreviousAccessTokenTtl",e.AFrameworkApplication.Wl),e.AFrameworkApplication.accessToken=Nb.Value,e.AFrameworkApplication.Wl=Math.floor(Nb.Expiry),e.AFrameworkApplication.OWe=lc,e.AFrameworkApplication.M6=Math.floor(Nb.Expiry)):r.ULS.sendTraceTag(39706828,217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",{["AccessTokenTtl"]:Nb.Expiry,
["NowGetTime"]:lc,["BootTime"]:e.AFrameworkApplication.hba},"PreviousAccessTokenTtl",e.AFrameworkApplication.Wl)}}return!0}Wsj(La){let lb=!1;for(let Nb=0;Nb<La.count;Nb++){lb=!0;const lc=La.ga(Nb);r.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",lc.Name,JSON.stringify(lc.Errors),this.Bpa)}return lb}b5i(La){let lb=tb.a.sessionAccessTokenExpired;La=parseInt(La.Id);if(isNaN(La))lb=tb.a.QCl;else{switch(La){case 401:lb=tb.a.TCl;break;case 403:lb=tb.a.OCl;break;
case 500:lb=tb.a.PCl;break;case 503:lb=tb.a.SCl}lb===tb.a.sessionAccessTokenExpired&&(lb=500<La?tb.a.RCl:tb.a.NCl)}return lb}}Object(h.a)(Ib,"TokenRefreshManager",null,[614]);class gc{constructor(){this.pGb=e.AFrameworkApplication.WCl;this.DUg=e.AFrameworkApplication.UCl;this.tokens=e.AFrameworkApplication.Gkj();this.priority=e.AFrameworkApplication.XCl;this.Buf=this.M6k();this.KGd=e.AFrameworkApplication.Fkj()}E5b(La){La=JSON.stringify(La);if(this.KGd&&0<this.KGd.length)for(const lb of this.KGd)if(0<
lb.length&&0<=La.indexOf(lb))return!0;return!1}Zeg(La){try{if(La)for(let lb of La)if(lb.Errors)for(const Nb of lb.Errors)if(Nb.Id in this.Buf)return Number.parseInvariant(this.Buf[Nb.Id].toString())}catch(lb){r.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",lb.toString())}return this.pGb}M6k(){const La={};try{if(!e.AFrameworkApplication.RPc()||0>=e.AFrameworkApplication.RPc().length||""===e.AFrameworkApplication.RPc()[0])return La;for(const lb of e.AFrameworkApplication.RPc())0<
lb.length&&(La[lb]=e.AFrameworkApplication.VCl)}catch(lb){r.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",lb.toString())}return La}}Object(h.a)(gc,"TokenRefreshPolicy",null,[613]);class Fb{constructor(){this.Da=null}get name(){return"Common.App.SessionExpiration"}init(){e.AFrameworkApplication.fa.ff(()=>{this.rDa()})}rDa(){this.Da.resolve("Common.ISessionExpirationManagerFactory");this.Da.resolve("Common.ISessionExpirationManager");this.Da.resolve("Common.ISessionExpirationManagerWithDialog")}dispose(){}Wb(La){this.Da=
La;La.register(612,"Common.App.SessionExpiration.ISessionLogger").ma().na(()=>new hc(bc.a.instance));La.register(613,"Common.App.SessionExpiration.ITokenRefreshPolicy").ma().na(()=>new gc);La.register(614,"Common.App.SessionExpiration.ITokenRefreshManager").ma().na(()=>new Ib(bc.a.instance,e.AFrameworkApplication.ES(),La.resolve("Common.App.SessionExpiration.ITokenRefreshPolicy"),La.resolve("Common.App.SessionExpiration.ISessionLogger"),e.AFrameworkApplication.fa.ka("WopiTokenRefreshSendTokenRequestWithoutTasks"),
La.qb("Common.ISessionStatus"),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ReportLastKnownTokenRefreshError",!1),e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.SyncMessageWithTimeout",!1)));La.register(615,"Common.ISessionExpirationManagerFactory").ma().na(()=>new rc(e.AFrameworkApplication.Aa,La.resolve("Common.App.SessionExpiration.ITokenRefreshManager"),La.resolve("Common.App.SessionExpiration.ISessionLogger"),La.qb("Common.ISessionStatus")));
La.register(616,"Common.ISessionExpirationManagerWithDialog").ma().na(()=>La.resolve("Common.ISessionExpirationManagerFactory").create());La.register(617,"Common.ISessionExpirationManager").ma().na(()=>La.resolve("Common.ISessionExpirationManagerWithDialog"))}static main(){m.a.instance.Bc(new Fb)}}Object(h.a)(Fb,"SessionExpirationPackage",null,[2,3]);var fb=d(54),Pc=d(430),dd=d(37),kd=d(153),Td=d(119),ce=d(133),ld=d(58),ad=d(26),Yf=d(38),Xd=d(28);class fg extends ac.a{constructor(La,lb){super();this.Xda=
null;this.R0j=!1;this.M1j="";this.ONg=this.PNg=this.BFg=this.CFg=null;this.yd=3;this.Ue(1,ResourceStrings.L_SetSlideOrientationMaximize);this.Ue(2,ResourceStrings.L_SetSlideOrientationEnsure);this.ia=La;this.BOg=lb.hk(ld.a.Twk)}dispose(){this.Xda=null;super.dispose()}showDialog(La){this.tj(La);this.CFg=document.getElementById("btnMaximize");this.PNg=Object(u.a)(this,this.dqk,"onScaleUpButton");F.a.addHandler(this.CFg,"click",this.PNg);this.BFg=document.getElementById("btnEnsure");this.ONg=Object(u.a)(this,
this.cqk,"onScaleDownButton");F.a.addHandler(this.BFg,"click",this.ONg)}tj(La){this.Roa=Object(u.a)(this,this.x7k,"setSlideOrientationRatio");this.$wa(La);this.sz.style.width="420px";this.show()}hide(){this.rc&&(e.AFrameworkApplication.Aa.Aw.zo(Td.AFrame.S9),super.hide())}dqk(La){this.ia.processAction(Xd.a.nlc,2);La.preventDefault();this.cV&&this.hide()}cqk(La){this.ia.processAction(Xd.a.mlc,2);La.preventDefault();this.cV&&this.hide()}x7k(La){1===La?this.ia.processAction(Xd.a.nlc,2):2===La?this.ia.processAction(Xd.a.mlc,
2):ad.a.J(25277209,822,50,"Cancle the slide orientation change.");this.cV&&this.hide()}$wa(){this.px();this.QF()}px(){super.px();Sys.UI.DomElement.addCssClass(this.rc,this.M1j);var La=$get("WACDialogTitleText");La.innerText=ResourceStrings.l_SetSlideScaleTitle;La.setAttribute("title",ResourceStrings.l_SetSlideScaleTitle);La=document.createElement("div");La.id=this.ji("WACDialogHtmlPanel");La.className="WACDialogHtmlPanel";this.sz.appendChild(La);this.Xda=document.createElement("div");this.Xda.id=
this.ji("WACDialogText");La.appendChild(this.Xda);La=document.createElement("div");La.id=this.ji("Scalediv");La.className="WACDialogRow";this.Xda.appendChild(La);var lb=document.createElement("label");lb.id=this.ji("Scalelabel");lb.innerText=ResourceStrings.L_SetSlideOrientationInformation;La.appendChild(lb);La=document.createElement("div");La.id=this.ji("ScaleMode");La.setAttribute("style","margin-left: 20px;");La.className="WACDialogRow";this.Xda.appendChild(La);lb=fg.sUf(ld.a.m6g+"_MaximizeFit_170x130x32",
this.BOg,ResourceStrings.L_SetSlideOrientationMaximize);lb.id=this.ji("btnMaximize");var Nb=document.createElement("td");Nb.className=String.format("clip{0}x{1}","170","130");Nb.setAttribute("style","border: #ccc 1px solid");Nb.appendChild(lb);lb=fg.sUf(ld.a.m6g+"_Ensurefit_170x130x32",this.BOg,ResourceStrings.L_SetSlideOrientationEnsure);lb.id=this.ji("btnEnsure");var lc=document.createElement("td");lc.className=String.format("clip{0}x{1}","170","130");lc.setAttribute("style","border: #ccc 1px solid");
lc.appendChild(lb);var Rc=document.createElement("td");Rc.setAttribute("style","width: 30px;");lb=document.createElement("tr");lb.appendChild(Nb);lb.appendChild(Rc);lb.appendChild(lc);Nb=document.createElement("td");Nb.setAttribute("align","center");lc=document.createElement("label");lc.id=this.ji("Maxlabel");lc.className="UIFontBold";lc.innerText=ResourceStrings.L_SetSlideOrientationMaximize;Nb.appendChild(lc);lc=document.createElement("td");lc.setAttribute("align","center");Rc=document.createElement("label");
Rc.id=this.ji("Ensurelabel");Rc.className="UIFontBold";Rc.innerText=ResourceStrings.L_SetSlideOrientationEnsure;lc.appendChild(Rc);const Ud=document.createElement("td");Ud.setAttribute("style","width: 30px;");Rc=document.createElement("tr");Rc.appendChild(Nb);Rc.appendChild(Ud);Rc.appendChild(lc);Nb=document.createElement("table");Nb.appendChild(lb);Nb.appendChild(Rc);La.appendChild(Nb)}QF(){this.Qjd(ac.a.Bgc+(ac.a.tma-fg.oii)/2-12,ac.a.Agc+(ac.a.vea-fg.tii)/2-12)}Qjd(La,lb){this.rc.style.top=(0>
La?0:La)+"px";Yf.a("DeprecateIE.SetSlideOrientation")?this.rc.style.left=(0>lb?0:lb)+"px":fb.a.j9a&&e.AFrameworkApplication.isRtl?this.rc.style.right=(0>lb?0:lb)+"px":this.rc.style.left=(0>lb?0:lb)+"px";this.R0j||(this.rc.style.width=String.format("{0}em",this.width));this.rc.style.display="Block"}static sUf(La,lb,Nb){const lc=document.createElement("img");lc.className=La;lc.setAttribute("Unselectable","on");lc.setAttribute(ce.a.Ye,ce.a.KM);lc.src=lb;Nb&&(lc.alt=Nb,lc.title=Nb);return lc}}fg.tii=
350;fg.oii=200;Object(h.a)(fg,"SetSlideOrientationDialog",ac.a,[]);var ue=d(52),Sa=d(108),rb=d(242),pc=d(72);class cd extends E.a{constructor(La,lb){super(!1,!1,!0);this.OSf=this.t2=null;if(!La)throw Error.argumentNull("actionManager");if(!lb)throw Error.argumentNull("presentationReader");this.ia=La;this.uc=lb}sDa(){this.t2=Object(u.a)(this,this.y7k,"setSlideSizeAndLayoutDialogResultHandler");this.OSf=this.jYi(this.getCurrentSlideDimensions());this.tj(ResourceStrings.L_SetSlideSize,this.t2,this.OSf)}y7k(La,
lb){1===La&&this.ia.La(Xd.a.Aoh,2,lb);this.dispose()}getCurrentSlideDimensions(){const La=this.uc.su(),lb={};lb.height=La.height;lb.width=La.width;lb.slideType=this.uc.Hfj();return lb}jYi(La){return{["id"]:"SlideSizeAndLayoutDialog",["bodyControls"]:La,["numberFormatInfo"]:pc.e().numberFormatInfo}}}Object(h.a)(cd,"SlideSizeAndLayoutDialog",E.a,[]);class zd{constructor(La,lb,Nb,lc,Rc,Ud,Pd,Sd,Le){this.IGa=this.yla=this.KT=0;this.slideSizeType="O_screen4x3 O_letterPaper O_A4paper O_35mm O_overhead O_banner O_custom O_ledgerPaper O_A3Paper O_B4ISOPaper O_B5ISOPaper O_B4JISPaper O_B5JISPaper O_HagakiCard O_screen16x9 O_screen16x10 O_Widescreen".split(" ");
this.Dth=[4320,4320,4320,4320,4320,576,4896,5754,6048,5115,3387,5184,3456,1872,3240,3600,4320];this.Qth=[5760,5760,6240,6480,5760,4608,6336,7672,8064,6820,4516,6912,4608,2880,5760,5760,7680];this.ia=La;this.Fa=lb;this.Af=Nb;this.Fb=lc;this.Zb=Rc;this.ua=Ud;this.ra=Sd;this.uc=Pd;this.fe=Le}ub(){this.ia.pa(Xd.a.MDe,ue.a.application,Object(u.a)(this,this.KDe,"querySlideSize"),96);this.ia.pa(Xd.a.LDe,ue.a.application,Object(u.a)(this,this.KDe,"querySlideSize"),96);this.ia.pa(Xd.a.$$g,ue.a.application,
Object(u.a)(this,this.KDe,"querySlideSize"),96);this.ia.ya(Xd.a.A7k,ue.a.application,Pc.a.GG);this.ia.pa(Xd.a.yFk,ue.a.application,Pc.a.m0,96);this.ia.pa(Xd.a.eid,ue.a.application,Object(u.a)(this,this.qrj,"handleSetSlideSize"),4);this.ia.pa(Xd.a.ELe,ue.a.application,Object(u.a)(this,this.srj,"handleSetSlideSize4x3"),4);this.ia.pa(Xd.a.DLe,ue.a.application,Object(u.a)(this,this.rrj,"handleSetSlideSize16x9"),4);this.ia.pa(Xd.a.a4g,ue.a.application,Object(u.a)(this,this.pUj,"launchSlideSizeAndLayoutDialogHandler"),
4);this.ia.pa(Xd.a.Tsk,ue.a.application,Object(u.a)(this,this.WBg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.pa(Xd.a.Usk,ue.a.application,Object(u.a)(this,this.WBg,"launchSetSlideOrientationScaleTypeDialogHandler"),4);this.ia.pa(Xd.a.nlc,ue.a.application,Object(u.a)(this,this.zoh,"setSlideOrientationHandler"),4);this.ia.pa(Xd.a.mlc,ue.a.application,Object(u.a)(this,this.zoh,"setSlideOrientationHandler"),4);this.ia.pa(Xd.a.Aoh,ue.a.application,Object(u.a)(this,this.z7k,"setSlideSizeAndLayoutHandler"),
4);this.ia.ya(Xd.a.B7k,ue.a.application,Pc.a.GG);this.ia.ya(Xd.a.setSlideHeight,ue.a.application,Pc.a.GG);this.ia.pa(Xd.a.AFk,ue.a.application,Pc.a.m0,96);this.ia.pa(Xd.a.zFk,ue.a.application,Pc.a.m0,96);this.ia.ya(Xd.a.Vhl,ue.a.application,Pc.a.GG);this.ia.ya(Xd.a.Uhl,ue.a.application,Pc.a.GG)}xe(){}KDe(La,lb,Nb,lc,Rc){ad.a.J(34936782,822,50,"Click slide size drop down.");if(lb.contextId!==ue.a.application)return 2;if(lb=Object(ic.a)(Sa.a,Rc))La=zd.RGj(this.uc.su(),La),lb.Nf(La);return 32}pUj(La,
lb,Nb){lb=this.ua.Ba;return!lb||this.Af.Zc(lb)||!Yf.a("DeprecateIE.CustomizeSlideSizeActor")&&fb.a.Vw?8:1===Nb?32:kd.a("CustomizeSlideSizeActor::LaunchSetSlideSizeAndLayoutDialogHandler ",La,()=>{(new cd(this.ia,this.uc)).sDa();ad.a.J(557158615,822,50,"Open set slide size and layout dialog.");return 32})}WBg(La,lb,Nb,lc,Rc){La=this.ua.Ba;if(!La||this.Af.Zc(La))return 16;if(1===Nb)return 32;if("slideType"in Rc&&"slideWidth"in Rc&&"slideHeight"in Rc)if(this.IGa=6,"o_custom"===Rc.slideType.toString().toLowerCase())this.KT=
6*Math.round(Rc.slideWidth),this.yla=6*Math.round(Rc.slideHeight);else{Nb=0;for(const Ud of this.slideSizeType){if(Rc.slideType.toString().toLowerCase()===Ud.toLowerCase()){this.IGa=Nb;break}Nb++}"landscape"===Rc.orientation.toString()?(this.yla=this.Dth[Nb],this.KT=this.Qth[Nb]):(this.KT=this.Dth[Nb],this.yla=this.Qth[Nb])}(new fg(this.ia,this.fe)).showDialog(ResourceStrings.l_SetSlideScaleTitle);ad.a.J(34936786,822,50,"Open set slide scale type dialog.");return 32}qrj(La,lb,Nb){La=this.ua.Ba;return!La||
this.Af.Zc(La)?8:this.ia.processAction(Xd.a.vrb,Nb)}srj(La,lb,Nb){ad.a.J(34936788,822,50,"click set slide size 4:3.");lb=this.ua.Ba;if(!lb||this.Af.Zc(lb))return 16;if(1===Nb||960===this.uc.su().width)return 32;this.KT=5760;this.yla=4320;this.IGa=0;return this.DHb(this.KT,this.yla,La,this.IGa,"EnsureFit")}rrj(La,lb,Nb){ad.a.J(34936792,822,50,"click set slide size 16:9.");lb=this.ua.Ba;if(!lb||this.Af.Zc(lb))return 16;if(1===Nb)return 32;Nb=this.uc.su();if(1280===Nb.width)return 32;this.KT=7680;this.yla=
4320;this.IGa=16;return 960===Nb.width&&720===Nb.height?this.DHb(this.KT,this.yla,La,this.IGa,""):this.DHb(this.KT,this.yla,La,this.IGa,"EnsureFit")}z7k(La,lb,Nb,lc,Rc){lb=this.ua.Ba;return!lb||this.Af.Zc(lb)?8:1===Nb?32:this.DHb(Rc.width,Rc.height,La,Rc.slideType,Rc.slideScaleType)}zoh(La,lb,Nb){lb=this.ua.Ba;return!lb||this.Af.Zc(lb)?16:1===Nb?32:this.yla&&this.KT?La===Xd.a.nlc?this.DHb(this.KT,this.yla,La,this.IGa,"Maximize"):La===Xd.a.mlc?this.DHb(this.KT,this.yla,La,this.IGa,"EnsureFit"):32:
(ad.a.J(34936796,822,10,"CustomizeSlideSizeActor::SetSlideOrientationHandler fail to get slide width/height."),8)}DHb(La,lb,Nb,lc,Rc){const Ud=this.ua.Ba;let Pd=!1;if(Ud){var Sd=Ud.jl();if(Sd&&0<Sd.length)for(const Le of Sd)if(Le.KDa){Pd=!0;break}}Sd=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()});try{Sd.gd(Ud),Sd.fd=Nb,Sd.Dy[rb.a.wub]=Pd,Ud.setValue(dd.a.slideWidth,La),Ud.setValue(dd.a.slideHeight,lb),Ud.setValue(dd.a.slideScaleType,Rc),Ud.setValue(dd.a.slideSizeType,lc)}finally{Sd&&Sd.dispose()}ad.a.J(34936798,
822,50,"Set slide width: {0}, height: {1}, scale type: {2}.",La,lb,Rc);this.Af.fVb(this.Zb.yf,Ud,Nb);return 32}static RGj(La,lb){La=La.width/La.height;switch(lb){case Xd.a.MDe:return.01>Math.abs(La-1.33);case Xd.a.LDe:return.01>Math.abs(La-1.77);default:return!1}}}Object(h.a)(zd,"CustomizeSlideSizeActor",null,[229]);class wd{}wd.Phh=0;wd.OVk=22711;Object(h.a)(wd,"ImageConstants",null,[]);var Oa=d(225),jb=d(317),qc=d(434),ib=d(41),Cb=d(103),yc=d(240),gd=d(107);class od extends gd.a{constructor(){super();
this.ImageToken=null;this.ErrorCode=0}Ok(){return 78}}Object(h.a)(od,"NotifyImageUploadFailureRequest",gd.a,[]);class Mc{constructor(La,lb,Nb,lc,Rc,Ud,Pd,Sd,Le,af,zf,yh,gg,Dh,Ug,ui,Uh,Yi,lh,jg,cj,oj){this.GGa=this.RTa=this.VI=null;this.$Bb=!1;this.ia=La;this.nb=Nb;this.Xb=lb;this.ua=Rc;this.Fb=Ud;this.Fa=lc;this.Yz=Pd;this.DF=Sd;this.Dm=Le;this.noe=af;this.Yx=zf;this.Md=yh;this.Mb=gg;this.$pe=Dh;this.y$b=Ug;this.AUa=ui;this.pi=Uh;this.ol=Yi;this.Ha=lh;this.yl=jg;this.Lc=cj;this.rT=lh.KEb;this.I4j=
lh.vmi;this.m5j=lh.fCj;this.Ea=oj}ub(){this.ia.pa(Xd.a.insertPicture,P.a.application,Object(u.a)(this,this.Pjg,"handleInsertPicture"),4);this.ia.pa(Xd.a.MKc,P.a.view,Object(u.a)(this,this.ksj,"handleUploadPictureAll"),4);this.ia.pa(Xd.a.smi,P.a.application,Object(u.a)(this,this.ymj,"handleChangePicture"),4);this.ia.pa(Xd.a.xHe,P.a.application,Object(u.a)(this,this.Qqj,"handleResetPicture"),4);this.ia.pa(Xd.a.NVk,P.a.application,Object(u.a)(this,this.Rqj,"handleResetPictureAndSize"),4);this.ia.pa(Xd.a.PVk,
P.a.application,Object(u.a)(this,this.Sqj,"handleResetPictureSplitButton"),4);this.ia.pa(Xd.a.tOa,P.a.application,Object(u.a)(this,this.zmj,"handleChangePictureStyle"),4);this.ia.pa(Xd.a.BUd,P.a.application,Object(u.a)(this,this.Pjg,"handleInsertPicture"),4);this.ia.pa(Xd.a.s_f,P.a.application,Object(u.a)(this,this.nnj,"handleDragAndInsertImage"),4)}xe(){}Pjg(La,lb,Nb){this.Ha.Uug&&!Yf.a("DummyChangeGateForTest")&&ad.a.J(512500500,830,100,"HandleInsertPicture::DummyChangeGateForTest is disabled");
this.I4j&&ad.a.J(512500499,822,50,"HandleInsertPicture::m_isChangePictureMenuOrderingEnabled is Enabled");this.m5j&&ad.a.J(512500498,822,50,"HandleInsertPicture::m_isInsertStockImageInMLRFlightEnabled is Enabled");lb=this.ua.Ba;lb=this.Ha.aVc&&!!lb&&!this.Xb.Zc(lb);lb=(this.y$b=this.$pe.tFj()&&this.y$b)?lb&&!!this.Yz&&this.Yz.jod:this.DF.zvg&&lb;if(!lb)return 16;if(1===Nb)return 32;this.$Bb=!0;this.GGa=this.ua.Ba;this.nmc(La!==Xd.a.BUd,!0);return 32}ksj(La,lb,Nb,lc,Rc){var Ud=this.ua?this.ua.Ba:null;
if(!Ud||!Ud.isConnected)return 16;if(!this.ol.yI(Ud,1))return this.ol.AJ(Ud),16;ad.a.J(512500497,822,50,"Start picture upload");lb=Mc.BQj(Rc);(lc=ib.a.Eb)&&lc.Wa(Cb.a.qCj,lb?"1":"0");this.Lc.cJk();let Pd=!1;if(this.$Bb&&this.y$b&&!this.Yz.khb&&this.PKj(lb)){if(Ud=Ud.L2(this.nb.Yd())){if(15!==Ud.Cj){const Sd=Ud.jU;Sd.BottomLeft.X!==Sd.TopLeft.X&&(Pd=!0)}lc&&lc.Wa(Cb.a.XXk,Pd?"1":"0")}Ud&&(15===Ud.Cj||Pd)?(lc&&lc.Wa(Cb.a.q4f,Pd?"PlaceHolder Rotated":"Picture Type PlaceHolder"),La=this.Pkg(La,Nb,Rc)):
La=this.lsj(La,Nb,Rc)}else this.Yz.khb=!1,La=this.Pkg(La,Nb,Rc);lb&&32===La&&ad.a.J(512500496,822,50,"Upload a svg file successfully.");return La}PKj(La){return La?this.Ha.powerPointInsertSVGFileLocalRenderingEnabled:!0}nnj(La,lb,Nb,lc,Rc){if(!this.Yz.Axk)return ad.a.J(512500495,822,15,"PictureActor::HandleDragAndInsertImage - PictureUploadLargeImageEnabled is false"),16;if(!Rc)return 16;La=[];lb=0;Nb=!1;for(const Ud of Rc)if(lb++,"string"===typeof Ud.type)if(Rc=Z.a.wg(Ud.type),ad.a.J(512500494,822,
50,"PictureActor::HandleDragAndInsertImage - No.{0} file  Size In Bytes:{1}; Tpye:{2} ",lb,Ud.size,Rc),0<=Rc.indexOf("image")&&0===this.Yz.Aod(Ud.name))if(La.length<this.Ha.powerPointDragInsertMultipleImageQuantityLimit)Array.add(La,Ud);else{this.yl.ZM(19);break}else Nb||(this.yl.ZM(18),Nb=!0);if(1>La.length)return ad.a.J(512500493,822,15,"PictureActor::HandleDragAndInsertImage - unlegal image format"),16;this.Yz.YKi(La);return 32}Pkg(La,lb,Nb){if(!(this.ua&&this.ua.Ba&&this.Yz))return 16;if(1===
lb)return 32;this.DF.kwa=new Date;this.$Bb&&this.nb.kj();this.Fa.Ad();this.Xb.blockContent(this.ua.presentation,La);const lc=ib.a.Eb;this.Yz.kkd(Nb,Rc=>{ib.a.BK(lc,()=>{ad.a.J(512500492,822,50,"Picture upload successful");this.u5d(Nb,Rc,La);this.f7f()})},Rc=>{ad.a.J(512500491,822,10,"Upload picture failed");this.T7a(Rc.error);this.f7f()});return 32}lsj(La,lb,Nb){if(!(this.ua&&this.ua.Ba&&this.Yz))return 16;if(1===lb)return 32;const lc=String.format("{0}{1}","client",gb.a.create().toString());ad.a.J(512500490,
822,50,"Client generated imageToken:{0}, imageSize:{1}",lc,Nb.RK);this.DF.Wdi(lc);const Rc=ib.a.Eb;Rc&&(lb="InsertPicture",this.$Bb||(lb="ChangePicture"),Rc.actionName=lb,Rc.Oj=!0);const Ud=new Date;ib.a.qk("PictureUploadStart",ib.a.$e(Ud));ib.a.qk("ImageSize",Nb.RK.toString());ib.a.qk("ImageToken",lc);const Pd=this.ua.Ba.sid;this.ia.La(Xd.a.P8d,2,Pd);this.Yz.kkd(Nb,Sd=>{ib.a.BK(Rc,()=>{ad.a.J(512500489,822,50,"Upload picture completed");ib.a.qk("PictureUploadDurationMS",(+new Date-+Ud).toString());
this.zxk(lc,Sd);this.ia.La(Xd.a.tSc,2,Pd)})},Sd=>{this.DF.h1f(lc);var Le=Object.assign(new od,{ImageToken:lc,ErrorCode:Sd.error.Code});Rc&&Rc.Wa("UploadPictureErrorCode",Oa.a[Le.ErrorCode]);Le=new yc.a(Le,null,()=>Mc.tok());this.pi.Cb(Le);ad.a.J(512500488,822,10,"Upload picture failed, ImageToken:{0}, ErrorCode:{1}, Error Message:{2}",lc,Oa.a[Sd.error.Code],Sd.error.Message);this.ia.La(Xd.a.tSc,2,Pd)},lc);this.insertPicture(lc,La,Nb);return 32}ymj(La,lb,Nb){La=this.rT?this.X6a():this.qtb();if(!(this.rT?
this.F5b(La):this.Yxg(La)&&this.Ha.aVc&&this.DF.zvg&&!this.Xb.Zc(La)))return 16;if(1===Nb)return 32;this.$Bb=!1;this.nmc(!0,!1);return 32}Qqj(La,lb,Nb){return this.tOa(lb,Nb,wd.Phh,La)}Rqj(La,lb,Nb){return this.tOa(lb,Nb,wd.OVk,La)}Sqj(La,lb,Nb,lc,Rc){return this.tOa(lb,1,Rc,La)}zmj(La,lb,Nb,lc,Rc){return this.tOa(lb,Nb,Rc,La)}tOa(La,lb,Nb,lc){const Rc=this.nb.Yd();if(!(Rc&&0<Rc.length))return 8;La=[];if(Yf.a("FixForPictureAndGraphicsStyleForGrpShapes"))this.Vdj(Rc,La);else for(const Pd of Rc){if(this.lxg(Pd)||
this.Xb.Zc(Pd))return 8;(this.rT?this.F5b(Pd):this.Yxg(Pd))&&La.push(Pd)}if(0>=La.length)return 8;if(1===lb)return 32;ad.a.J(512500487,822,15,"PictureStyle change started. PictureStyleId: '{0}'",Nb);lb=ib.a.Eb?ib.a.Eb.actionName:null;for(var Ud of La)this.QPa(Ud);Ud=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{Ud.kc(La[0]);Ud.fd=lc;for(const Pd of La)Pd.Aeb=Nb}finally{Ud&&Ud.dispose()}if(lc=ib.a.Eb)lb&&(lc.actionName=lb),lc.Wa("PictureStyleId",Nb.toString()),ib.a.Lea(lc);return 32}Vdj(La,
lb){let Nb=!1;for(const lc of La){if(!lc||this.lxg(lc)||this.Xb.Zc(lc))return;lc.Og&&(Nb=!0)}if(Nb)for(const lc of La)lc.Og&&this.F5b(lc)&&lb.push(lc);else for(const lc of La)if(this.F5b(lc))lb.push(lc);else if(lc.Jf){La=this.Ea.Ow(lc);for(const Rc of La)this.F5b(Rc)&&lb.push(Rc)}}u5d(La,lb,Nb){this.DF.jwa=new Date;const lc=lb.result;if(La){if(this.$Bb?(lb="InsertPicture",this.VBj(lc,La,Nb)):(lb="ChangePicture",Yf.a("ChangePictureOnMultiSelectFixEnabled")?this.PNd(lc,La,Nb):this.tmi(lc,La,Nb)),La=
ib.a.Eb)La.actionName=lb,La.Wa("PictureUploadStart",ib.a.$e(this.DF.kwa)),La.Wa("PictureUploadDurationMS",(+this.DF.jwa-+this.DF.kwa).toString())}else La=Object.assign(new jb.a,{Code:94}),this.T7a(La)}zxk(La,lb){this.DF.h1f(La);lb.result||ad.a.J(512500486,822,50,"Upload picture completed with null response")}VBj(La,lb,Nb){const lc=this.ua.Ba;if(lc&&lc.isConnected){this.RTa=lc.L2(this.nb.Yd());var Rc=this.Fb.ud(15,void 0,void 0,()=>{this.nb.selectShape(this.VI,!0);this.Fa.Ad()});try{Rc.kc(lc),Rc.fd=
Nb,Rc.Dy[rb.a.PBa]=rb.a.z7f,this.VI=this.Dm.jzi(lc.Bb),this.RTa&&(this.VI.kba=this.RTa.id),this.VI.sHb(La.ItemId,this.Ha.uSa?null:lb.fileName,lb.fileName),lc.GB(this.VI)}finally{Rc&&Rc.dispose()}this.Xb.sqa(this.ua.Ba,this.VI,this.Mb.Ma,"InsertPictureAfterUpload");this.Yx.CI=this.VI}}PNd(La,lb,Nb){var lc=this.nb.Yd();if(lc){var Rc=[];for(const Ud of lc)Ud.Jf||Rc.push(Ud);for(const Ud of Rc)this.QPa(Ud);lc=this.Fb.ud(15);try{lc.fd=Nb;lc.kc(Rc[0]);for(const Ud of Rc)Ud.kba=Ud.id,this.Ha.uSa?(Ud.sHb(La.ItemId,
null,lb.fileName),Ud.set_alt("")):Ud.sHb(La.ItemId,lb.fileName,lb.fileName)}finally{lc&&lc.dispose()}for(const Ud of Rc)this.Xb.sqa(this.ua.Ba,Ud,this.Mb.Ma,"ChangePictureAfterUpload")}}tmi(La,lb,Nb){const lc=this.rT?this.X6a():this.qtb();if(lc){this.QPa(lc);var Rc=this.Fb.ud(15);try{Rc.fd=Nb,Rc.kc(lc),lc.kba=lc.id,this.Ha.uSa?(lc.sHb(La.ItemId,null,lb.fileName),lc.set_alt("")):lc.sHb(La.ItemId,lb.fileName,lb.fileName)}finally{Rc&&Rc.dispose()}this.Xb.sqa(this.ua.Ba,lc,this.Mb.Ma,"changePictureAfterUploadSingleImage")}}T7a(La){this.DF.jwa=
new Date;ad.a.J(512500484,822,50,"Upload picture failed");this.Md.FG(La.Code,lb=>{lb.NB=1;lb.XPa=La.ExtraErrorParam;return!1})}f7f(){this.Xb.GJ(this.ua.presentation)}nmc(La,lb){this.noe?qc.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.Yz&&(this.Yz.tXc=this.y$b,this.Yz.QKb=0,La&&this.Yz.S9g(lb))}qtb(){const La=this.nb.Yd();for(const lb of La)if(lb&&lb.wk)return lb;return null}X6a(){const La=this.nb.Yd();return La&&La.length?this.GKd(La)?La[0]:this.qtb():null}GKd(La){if(!La||
!La.length)return!1;let lb=La[0].wk,Nb=1===La[0].mediaType;for(const lc of La)lb=lb&&lc.wk,Nb=Nb&&1===lc.mediaType;return lb||Nb}Pk(La){return La?Object(ic.a)(121,La.oc(this.Mb.Ma)):null}QPa(La){La&&La.Mx&&(La=this.Pk(La))&&La.x0(!1)}Yxg(La){return this.ua&&this.ua.Ba&&La&&La.wk?!0:!1}F5b(La){return this.ua&&this.ua.Ba&&La&&(La.wk||1===La.mediaType)?!0:!1}lxg(La){return this.ua&&this.ua.Ba&&La&&La.Tp?!0:!1}insertPicture(La,lb,Nb){var lc=this.ua.Ba;const Rc=Object(ic.a)(553,lc.oc(this.Mb.Ma)),Ud=this.GGa.Bb;
if(lc&&lc.isConnected&&Rc&&this.GGa&&this.GGa.isConnected){lc=this.GGa.ev();this.RTa=this.GGa.L2(this.nb.Yd());var Pd,Sd;({cXd:Sd,MC:Pd}=this.AUa.HPd(this.RTa,Nb.imageWidth,Nb.imageHeight));var Le=this.Fb.ud(15,void 0,()=>{this.nb.Cy();this.nb.Uh();this.Fa.Ad()},()=>{this.Yx.CI=this.VI;this.nb.selectShape(this.VI,!0)});try{Le.kc(this.GGa);Le.fd=lb;this.VI=this.Dm.Qqa(!0,Ud.cid,Ud.sid,0,Pd.x,Pd.y,Sd.width,Sd.height,lc+1,!1);const af=this.AUa.ULd(this.Mb.Fd,Sd,Pd,Rc.bW);this.VI.jU=af;this.RTa&&(this.VI.kba=
this.RTa.id,this.GGa.gU([this.RTa]));this.VI.sHb(La,this.Ha.uSa?null:Nb.fileName,Nb.fileName);this.VI.isResizable=!0;this.VI.p5b=!0;this.VI.ZK=!0;this.VI.mHa=!0;this.VI.wk=!0;this.VI.esb=!!Nb.fDb;this.VI.Yca=Nb.fDb||Nb.CRc;this.GGa.GB(this.VI)}finally{Le&&Le.dispose()}ib.a.iUe()}}static BQj(La){return!!La&&!!La.fileName&&La.fileName.toLowerCase().indexOf(".svg")===La.fileName.length-4}static tok(){ad.a.J(512500483,822,50,"NotifyImageUploadFailureRequest failed");return!0}}Object(h.a)(Mc,"PictureActor",
null,[229]);var Rd=d(111),ye=d(206),oe=d(705),Bb=d(890),Ff=d(84);class pg extends Sys.EventArgs{constructor(La,lb){super();this.fNj=La;this.YVc=lb}}Object(h.a)(pg,"TokenRefreshEventArgs",Sys.EventArgs,[]);class xf{constructor(La,lb,Nb,lc,Rc,Ud,Pd){this.VBb=0;this.Mc=La;this.pre=lb;this.Ut=Nb;this.ia=lc;this.Ho=Rc;this.yb=Ud;this.Ha=Pd;this.pre&&this.pre.CBc(Object(u.a)(this,this.q3g,"onTokenRefreshed"))}WNd(La){!this.Ha.podTokenRefreshImprovementEnabled&&this.yb.tsa&&this.yb.VXa();const lb=yb.a.instance.nEa(e.AFrameworkApplication.Wl),
Nb=yb.a.instance.BVc(e.AFrameworkApplication.Wl,e.AFrameworkApplication.iha);ad.a.J(41562886,801,lb||Nb?15:50,"SessionRehydrationController::CheckAccessTokenExpiry - IsExpired:{0}, IsExpiring:{1}, Trigger:{2}, Improvement:{3}, RetryCount:{4}",lb,Nb,La,this.Ha.podTokenRefreshImprovementEnabled,this.VBb);yb.a.instance.o4a();this.Ha.podTokenRefreshImprovementEnabled&&this.yb.tsa&&this.yb.VXa()}q3g(La,lb){ad.a.J(41562888,809,50,"PPTTokenRefreshManager::OnTokenRefreshed");try{const Nb=Object(ic.a)(Wb,
lb)||new Wb(null,null),lc=Nb.tokens,Rc=Nb.errors;La="";if(void 0===Rc||null===Rc||0>=Rc.count)for(lb=0;lb<lc.count;lb++)if(lc.ga(lb).Name===Vb.a.b2k){const Pd=lc.ga(lb)?lc.ga(lb):null;La=Pd&&Pd.Value&&0<Pd.Value.length?Pd.Value:"";break}const Ud=yb.a.instance.nEa(e.AFrameworkApplication.Wl);ad.a.J(540366599,809,50,"PPTTokenRefreshManager::OnTokenRefreshed fTokenExpired:{0} m_applicationSettings.PPTOTokenRefreshRetryEnabled:{1} m_tokenRefreshRetryCount:{2} m_applicationSettings.PPTOTokenRefreshRetryLimit:{3}",
Ud,this.Ha.vBe,this.VBb,this.Ha.h8g);if(0<La.length&&Ud&&this.Ha.vBe&&this.VBb<this.Ha.h8g)ad.a.J(51205124,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token refreshed successfully but is expired. NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}, RetryEnabled:{4}, CurrentRetryCount:{5}",(new Date).getTime(),new Date,e.AFrameworkApplication.Wl,new Date(e.AFrameworkApplication.Wl),this.Ha.vBe,this.VBb),this.VBb++,this.WNd(2);else if(0<La.length&&!Ud){ad.a.J(41562890,809,Ud?
15:50,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed successfully, NowTicket:{0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime:{3}",(new Date).getTime(),new Date,e.AFrameworkApplication.Wl,new Date(e.AFrameworkApplication.Wl));ye.App.b0d=e.AFrameworkApplication.orb=Z.a.Qe(La);const Pd=this.Ut.nhc.presentationId.$Pe+"&access_token="+encodeURIComponent(e.AFrameworkApplication.accessToken)+"&access_token_ttl="+encodeURIComponent(e.AFrameworkApplication.Wl.toString());this.Ut.nhc=
new Bb.a(new oe.a(Pd));this.Mc.Vbh(new pg(this.Ho?this.Ho.CZ:!1,!0))}else{if(Yf.a("CleanPIIFromC49mm")&&Rc)for(let Pd of Rc)if(Pd.Errors)for(const Sd of Pd.Errors)"403"===Sd.Id&&Sd.Details&&Sd.Details.startsWith("<")&&(Sd.Details=null);ad.a.J(41562892,809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed, errors: {0}, RetryCount:{1}",Rc?Rd.c(Rc):"There is no error in Refreshed Token, but GetFileUrl is empty",this.VBb);Rc&&0<=Rd.c(Rc).indexOf("The caller is not authenticated")?
(e.AFrameworkApplication.jp(Ff.a.Qh(383)),fd.Health.instance.recordQosError("WopiTokenRefreshFailedOnHostUnauth",["SessionExpired"],!1,!0,!1,!0,null)):(e.AFrameworkApplication.jp(Ff.a.Qh(380)),fd.Health.instance.recordQosError("WopiTokenRefreshFailed",["SessionExpired"],!1,!0,!0,!0,null));e.AFrameworkApplication.Ku&&e.AFrameworkApplication.Ku.v7();this.Mc.Vbh(new pg(this.Ho?this.Ho.CZ:!1,!1));this.ia.La(Xd.a.refresh,2,{refreshtrigger:"PPTTokenRefreshManager::OnTokenRefreshed"})}}catch(Nb){ad.a.J(41562894,
809,15,"PPTTokenRefreshManager::OnTokenRefreshed - Token was refreshed failed and throw exception, exception: {0}",Rd.c(Nb))}}dispose(){this.pre.oGe(Object(u.a)(this,this.q3g,"onTokenRefreshed"))}}Object(h.a)(xf,"PPTTokenRefreshManager",null,[584]);var qe=d(85),Oh=d(640);class Cf{constructor(La,lb,Nb,lc,Rc,Ud){this.xX=this.tCl=this.VGe=null;this.h_b=this.qXd=!1;this.L5c=0;this.xjb=ib.a.Pl("SeamlessFailover");1!==lb&&2!==lb||ib.a.O9a();this.Fj=new Date;ib.a.rxb=this.startTime;this.PTh=Nb;this.TOa=
0;this.BVh=lb;this.ANh=lc;this.fxc=Rc;this.Cql=Ud;this.FRi=!1;this.resultCode=0;this.h4e=!0;if(La=e.AFrameworkApplication.$c)this.Vc.Wa("Host",Object(ic.a)(String,La.Host)),this.Vc.Wa("Ring",Object(ic.a)(String,La.Ring))}Soh(La,lb){this.L5c=window.setTimeout(La,lb)}Djl(){this.h4e=!1}dispose(){ib.a.T6b=new Date;0<=this.L5c&&(window.clearTimeout(this.L5c),this.L5c=-1)}get CRi(){return this.h4e}get Vc(){return this.xjb}get startTime(){return this.Fj}get itk(){return this.PTh}get zwa(){return this.BVh}get TQi(){return this.ANh}get podsCleaningRequestPattern(){return this.fxc}}
Object(h.a)(Cf,"SeamlessFailoverState",null,[106]);const Bg=La=>{La=String.format("{0}/PodHandler.ashx?action=TriggerFontsInstallation&PodsID={1}",e.AFrameworkApplication.fa.Ga("361"),La);e.AFrameworkApplication.Ge.sV(La,1,null,null,null,0,()=>{ad.a.J(512263E3,801,50,"CustomFontHelper::TriggerFontsInstallation - Succeeded")},()=>{ad.a.J(512262999,801,15,"CustomFontHelper::TriggerFontsInstallation - Failed to set document settings")},null)};var Gf;(function(La){La[La.unknown=0]="unknown";La[La.mouse=
1]="mouse";La[La.keyboard=2]="keyboard";La[La.podsPopsUnavailable=4]="podsPopsUnavailable"})(Gf||(Gf={}));Object(h.b)("RehydrationTrigger",Gf);var dh=d(650),qg=d(944);class Pf{constructor(La,lb,Nb,lc,Rc,Ud,Pd,Sd,Le,af,zf,yh,gg,Dh,Ug,ui,Uh,Yi,lh,jg,cj,oj,hk){this.Be=this.ihe=null;this.zte=this.q6c=-1;this.EQg=0;this.Vbb=La;this.la=lb;this.Zb=Nb;this.ia=lc;this.yb=Rc;this.UD=Ud;this.Fe=Pd;this.We=Le;this.Wy=af;this.Md=zf;this.Bm=yh;this.Ei=gg;this.jc=Dh;this.cO=Ug;this.ew=Yi;this.qre=new Date;this.qv=
ui;this.WG=Uh;this.ua=lh;this.fc=jg;this.Cac=cj;hk.execute(Vh=>{this.ihe=Vh});this.z_c=[];this.d$j=this.fc.Cc("SeamlessFailoverMaxRetryAttempts",0);this.c$j=this.fc.ka("SeamlessFailoverIncludePopsInfoInFinalLog");this.e$j=this.fc.ka("SeamlessRehydrationAbortOnAbortedOnExitAppQosEnabled");ad.a.J(512497885,809,50,"PodSeamlessFailoverManager::PodSeamlessFailoverManager()")}get CZ(){return!!this.Be&&this.Be.CRi}get m4f(){return this.EQg}YGd(La){if(this.CZ){e.AFrameworkApplication.Kz&&(this.Ei.zjc(Object(u.a)(this,
this.uea,"onWopiTokenRefreshed")),this.iWb());var lb=0;if(this.la.bwb)this.Be.Vc.sB("Result","abortedOnIrmProtectedFile"),lb=365;else if(this.Be.Vc.sB("Result",La),"abortedOnExitApp"!==La||this.e$j)lb=4===this.Be.zwa?356:357;this.lgb(!1,lb,!this.Be.h_b&&"abortedOnRefreshDoc"!==La)}}mTe(La,lb,Nb){if(this.CZ)ad.a.J(512497884,801,15,"PodSeamlessFailoverManager::TriggerFailover skipped");else{e.AFrameworkApplication.Ku||(e.AFrameworkApplication.Ku=ad.a.DXb());this.Md.disabled=!1;this.Md.jja=!1;this.Be=
new Cf(La,lb,this.Fe.podSessionId,this.la.podsCleanPendingTasksAndRequestsWhenFailover,this.la.podsCleaningRequestPattern,Nb);this.la.wopiTokenRefreshLongerTimeoutIsEnable||this.Be.Soh(Object(u.a)(this,this.w_g,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs);this.Be.Vc.Wa("PopsAvailable",this.We.hA.toString());this.Be.Vc.Wa("OrderlyShutdown",La.toString());this.Be.Vc.Wa("Trigger",Gf[lb]);this.Be.Vc.Wa("TriggerErrorCode",Oa.a[Nb]);this.Be.Vc.Wa("OldPodsId",this.Be.itk);this.Be.Vc.Wa("OldPopsId",
this.Fe.Bk);ad.a.J(512497883,809,50,"PodSeamlessFailoverManager::TriggerFailover:ActionID:{0}; ActionDetails:{1}",this.Be.Vc.actionId,this.Be.Vc.JJb());if(1===lb||2===lb)e.AFrameworkApplication.Vg=!1,this.ua.presentation&&this.ua.presentation.AHe();this.Ei.KBc(Object(u.a)(this,this.uea,"onWopiTokenRefreshed"));e.AFrameworkApplication.Kz&&yb.a.instance.o4a()?(ad.a.J(512497882,809,15,"FileUrlExpired on TriggerFailover, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),
new Date,e.AFrameworkApplication.Wl,new Date(e.AFrameworkApplication.Wl)),this.iWb(),this.q6c=window.setTimeout(Object(u.a)(this,this.hsk,"onWopiTokenRefreshTimeout"),this.la.wopiTokenRefreshTimeoutDuringRehydrationInMs),this.la.Q6g&&this.Cac.d7f(!1)):(this.Ei.zjc(Object(u.a)(this,this.uea,"onWopiTokenRefreshed")),this.Ezh(lb))}}IRi(La){if(Array.contains(this.la.podTriggerFailoverOnServerErrorsCandidates,Ff.a.Qh(La).toString())){if(!this.z_c.length)return!0;const lb=new Date;let Nb=0;for(let lc=this.z_c.length-
1;0<=lc;lc--){const Rc=this.z_c[lc];if(+lb-+Rc.startTime>this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)break;Rc.Cql===La&&Nb++}if(Nb<this.la.podTriggerFailoverOnServerErrorsMaxTry)return!0;ad.a.J(512497881,809,10,"PodSeamlessFailoverManager::FTriggerFailoverForServerError - Failover for Error[{0}] has been triggered for {1} times within {2}ms. Skip.",La,Nb,this.la.podTriggerFailoverOnServerErrorsLookbackWindowInMs)}return!1}Ezh(La){e.AFrameworkApplication.Kz&&(this.Ei.zjc(Object(u.a)(this,
this.uea,"onWopiTokenRefreshed")),this.iWb());if(++this.EQg>this.d$j)this.b5d("SeamlessFailoverMaxRetryCountReached",392);else if(this.la.wopiTokenRefreshLongerTimeoutIsEnable&&this.Be.Soh(Object(u.a)(this,this.w_g,"onFailoverTimeout"),this.la.podsSeamlessFailoverTimeoutDurationInMs),+new Date-+this.qre>=36E5*this.la.powerPointPodRecoveryStorageAgeThreshold)this.b5d("RecoveryStreamExpired",358);else{if(this.Be.qXd&&(this.Be.Vc.sB("Trigger",Gf[La]+"_GetFileUrlExpired"),this.XEj())){this.b5d("GetFileUrlExpired_NoAzureBackup",
364);return}this.Be.TQi&&this.yoi();this.Ei.Mdd(new dh.a(4===La?5:2));this.Ei.iIk();this.la.podsClosePopSessionBeforeSeamlessFailoverEnabled&&4===La&&(ad.a.J(512497880,801,15,"PodSeamlessFailoverManager::TriggerFailover - Close PopSesion: {0}",this.Fe.Bk),this.cO.Gpb(()=>{},()=>{}));this.Bm.isPaused||this.Bm.pause();this.Be.Vc.Om("CreatePodsWithRetryST",new Date);this.Be.Vc.Om("SessionStartTime",this.qre);this.Pdh()}}b5d(La,lb){this.yb.tsa&&this.yb.VXa();this.Be.Vc.sB("Result",La);this.lgb(!1,lb)}hsk(){this.Ei.zjc(Object(u.a)(this,
this.uea,"onWopiTokenRefreshed"));this.iWb();ad.a.J(512497879,809,50,"WopiTokenRefreshed timeout during TriggerFailover");this.Be.Vc.Wa("WopiTokenRefreshed","TO");e.AFrameworkApplication.jp(Ff.a.Qh(382));fd.Health.instance.recordQosError("WopiTokenRefreshTimeoutOnRehydration",["SessionExpired"],!1,!0,!0,!0,null);e.AFrameworkApplication.Ku&&e.AFrameworkApplication.Ku.v7();this.Be.h_b=!0;this.ia.La(Xd.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::OnWopiTokenRefreshTimeout"})}uea(La,lb){La=
lb.YVc;this.Ei.zjc(Object(u.a)(this,this.uea,"onWopiTokenRefreshed"));this.iWb();this.la.Q6g&&this.Cac.d7f(!0);lb=0<e.AFrameworkApplication.Wl&&(new Date).getTime()>=e.AFrameworkApplication.Wl-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs;ad.a.J(512497878,809,50,"WopiTokenRefreshed during TriggerFailover, IsTokenRefreshedSuccessfully: {0}, NowTicket: {1}, NowDateTime:{2}, AccessTtl:{3}, AccessTtlDateTime: {4}",La,(new Date).getTime(),new Date,e.AFrameworkApplication.Wl,new Date(e.AFrameworkApplication.Wl));
this.Be.Vc.Wa("WopiTokenRefreshed","True");this.Be.Vc.Wa("WopiTokenRefreshedSuccessfully",La.toString());this.Be.qXd=lb;La?this.Ezh(this.Be.zwa):this.Be.h_b=!0}iWb(){-1!==this.zte&&(window.clearTimeout(this.zte),this.zte=-1);-1!==this.q6c&&(window.clearTimeout(this.q6c),this.q6c=-1)}XEj(){const La=Z.a.wg(this.fc.Ga("152")||""),lb=!e.AFrameworkApplication.Tg.IsRealEdit&&1!==this.Be.zwa&&2!==this.Be.zwa;return".pptx"!==La&&".ppsx"!==La||lb}yoi(){try{let La=0,lb=0;const Nb={},lc={};this.ew.P_h(Rc=>{if(-1<
Rc.request.get_url().search(new RegExp(this.Be.podsCleaningRequestPattern,"i")))return this.jzh(Nb,this.Ueg(Rc.request.get_url())),La++,!0;this.jzh(lc,this.Ueg(Rc.request.get_url()));lb++;return!1});ad.a.J(512497877,801,15,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests - abort {0} requests: {1}, remain {2} request: {3}",La,Nb,lb,lc)}catch(La){ad.a.J(512497876,801,10,"PodSeamlessFailoverManager::CleanPendingTasksAndRequests failed. {0}",La)}}Ueg(La){let lb=La;const Nb=La.indexOf("?");0<
Nb&&(lb=La.substr(0,Nb));La=lb.lastIndexOf("/");0<La&&(lb=lb.substr(La+1));return lb}jzh(La,lb){La[lb]=lb in La?La[lb]+1:1}w_g(){this.CZ&&(this.Be.Vc.sB("Result","Timeout"),this.Be.Vc.Wa("TimeoutDuration",(+new Date-+this.Be.startTime).toString()),this.lgb(!1,4===this.Be.zwa?354:355))}lgb(La,lb=0,Nb=!0){if(this.CZ){this.Wy.Ffb(Object(u.a)(this,this.oea,"onPodSessionRefreshed"));this.Zb.Ci.contentReplicator.vjc(Object(u.a)(this,this.IYg,"onAfterReplication"));var lc=+new Date-+this.qre>=6E4*this.la.pptEditorFileGetUrlExpireTimeInMinutes;
e.AFrameworkApplication.Kz&&(lc=0<e.AFrameworkApplication.Wl&&(new Date).getTime()>=e.AFrameworkApplication.Wl-this.la.wopiTokenRefreshFileUrlExpiredBufferTimeInMs)&&ad.a.J(512497875,809,15,"FileUrlExpired on SeamlessFailoverEnd, NowTicket: {0}, NowDateTime:{1}, AccessTtl:{2}, AccessTtlDateTime: {3}",(new Date).getTime(),new Date,e.AFrameworkApplication.Wl,new Date(e.AFrameworkApplication.Wl));La&&lc&&this.Be.Vc.Wa("SkipPopsReason","FileUrlExpired");this.jc.PDg();var Rc=this.Be.zwa;this.Be.Vc.Wa("IsInEditingMode",
this.jc.un.toString());this.Be.Vc.Wa("IsPreviousModeEditing",this.jc.K5b.toString());this.Be.Vc.Wa("IsLastKnownModeEditing",this.jc.Jae.toString());this.Be.Vc.Wa("PopSessionEverInitialized",this.We.sgc.toString());this.Be.Vc.Wa("ResultErrorCode",Oa.a[lb]);this.Be.Vc.Wa("RefreshPage",Nb.toString());this.Be.Vc.Wa("FRehydrationInitiatedPageRefresh",this.Be.h_b.toString());this.Be.FRi=La;this.Be.resultCode=lb;this.Be.Djl();this.z_c.push(this.Be);this.c$j||this.iLc();La?(this.Ei.vbh(new qg.a(Rc)),this.Mzh(lc,
Rc)):(this.iLc(),0!==lb&&(La=Ff.a.Qh(lb),e.AFrameworkApplication.jp(La),fd.Health.instance.recordQosError(Ff.a.tba(La),["UnexpectedAppRefresh"],399===lb,!1,!0,Nb,null)),Nb?(e.AFrameworkApplication.Ku&&e.AFrameworkApplication.Ku.v7(),this.ia.La(Xd.a.refresh,2,{refreshtrigger:"PodSeamlessFailoverManager::SeamlessFailoverEnd"})):(this.Ei.vbh(new qg.a(Rc)),this.Mzh(lc,Rc)))}}i_b(){return this.Be&&this.Be.Vc?!0:!1}iLc(){this.i_b()&&(ad.a.J(512497874,801,15,"Action Telemetry: {0}",this.Be.Vc.JJb()),this.Be.Vc.finish(!0),
this.Be.dispose(),this.Be=null)}Mzh(La,lb){!this.jc.WK||La||2!==lb&&1!==lb&&4!==lb?(this.i_b()&&this.Be.Vc.Wa("PopsRehydrationAttempted","false"),ad.a.J(512497873,809,15,"TriggerRehydrateHostSession is skipped isFileUrlExpired:{0}, rehydrationTriger:{1}",La,lb),this.cVf(null)):(this.i_b()&&this.Be.Vc.Wa("PopsRehydrationAttempted","true"),this.cO.Mea(4===lb?6:7,Object(u.a)(this,this.MBi,"createPopSessionSucceededCallback"),Object(u.a)(this,this.cVf,"createPopSessionFailedCallback")))}MBi(){this.i_b()&&
(this.h6f(),this.Be.Vc.Wa("POPSessionCreated","true"),this.iLc())}cVf(){if(!this.i_b())return!1;this.h6f();this.Be.Vc.Wa("POPSessionCreated","false");this.iLc();return!1}h6f(){this.Be.Vc.sB("IsInEditingMode",this.jc.un.toString());this.Be.Vc.sB("IsPreviousModeEditing",this.jc.K5b.toString());this.Be.Vc.sB("PopSessionEverInitialized",this.We.sgc.toString())}Eql(La){ad.a.J(512497872,801,50,"PodSeamlessfailoverManager TriggerFontsInstallationCallback started with UserHasValidLicenseForEnterpriseFonts:{0}, PPTOEnterpriseFontsEnabled:{1}",
this.fc.ka("UserHasValidLicenseForEnterpriseFonts"),this.fc.ka("PPTOEnterpriseFontsEnabled"));this.fc.ka("UserHasValidLicenseForEnterpriseFonts")&&this.fc.ka("PPTOEnterpriseFontsEnabled")&&Bg(La)}Pdh(){this.Be.xX=Oh.a();this.yb.tsa||this.yb.stop();let La=this.la.restoreRCInCreatePodSessionRequest&&this.ua.Tj?this.ua.Tj.toString():"";La=Z.a.replaceAll(La,"#","%23");this.Vbb.createPodSession(this.Be.xX,"SeamlessFailover_"+this.Be.zwa,this.Be.TOa,+new Date-+this.Be.startTime,Object(u.a)(this,this.LBi,
"createPodSessionSucceededCallback"),Object(u.a)(this,this.KBi,"createPodSessionFailedCallback"),this.UD,this.Fe.podSessionId,La);this.Vbb.Mxl(this.Be.xX,Object(u.a)(this,this.Eql,"triggerFontsInstallationCallback"));this.yb.VXa()}LBi(La){if(this.CZ){ib.a.Sld=[];this.Be.Vc.Wa("NewPodsId",this.Be.xX);this.Fe.podSessionId=this.Be.xX;this.Be.Vc.Wa("CreatePodsWithRetryResult","true");this.Be.Vc.Wa("CreatePodsRetryCount",this.Be.TOa.toString());this.Be.Vc.Wa("CreatePodsDuration",(+new Date-+this.Be.startTime).toString());
this.Bm.isPaused&&this.Bm.Qib();try{this.Bm.QNf()}catch(lb){ad.a.J(512497871,801,15,"PodSeamlessfailoverManager CancelBlockedOperation failed. {0}",lb)}if(this.la.restoreRCInCreatePodSessionRequest&&La&&qe.a.Wfc in La&&!Z.a.Va(La[qe.a.Wfc])){const lb=Boolean.parse(La[qe.a.Wfc]);this.Be.Vc.Wa("RCRestoredWhenCreatePodSession",La[qe.a.Wfc]);lb?(this.Be.Vc.sB("Result","Success"),this.lgb(!0)):(this.ihe&&this.ihe.Ooi(),this.Be.Vc.Wa("DocRefreshTriggered","true"),La={failedMachineId:null,isPlanedShutdown:!1,
fromSeamlessFailoverManager:!0},La.podSessionId=this.Fe.podSessionId,this.Be.h_b=!0,this.ia.La(Xd.a.xFb,2,La))}else this.Hzh()}}Hzh(){this.Zb.Ci.contentReplicator.vBc(Object(u.a)(this,this.IYg,"onAfterReplication"));this.Iql()}Iql(){const La=()=>{this.Be.VGe=new Date;this.Be.Vc.Om("InboundStartTime",this.Be.VGe);this.Zb.Ci.contentReplicator.fF(null,null,null)};ad.a.J(512497870,801,50,"PodSeamlessFailoverManager::TriggerInbound - ForceInboundSlide:{0}; ActiveSlide.Sid:{1}; PodSessionID:{2};",!0,this.ua.Ba?
this.ua.Ba.sid:0,this.Be.xX);4===this.Be.zwa&&this.la.podsSeamlessFailoverForceInboundSlideEnabled&&this.ua.Ba?(this.WG.DRc&&this.WG.DRc.Osg(this.ua.Ba.Bb),this.Be.Vc.Om("ForceInboundSlideStartTime",new Date),this.qv.FYd(this.ua.Ba,(lb,Nb)=>{ad.a.J(512497869,801,50,"PodSeamlessFailoverManager::TriggerInbound after ForceInboundSlide - SlideId:{0}; SlideStale:{1};",lb,Nb);this.CZ&&(this.Be.Vc.Om("ForceInboundSlideEndTime",new Date),La())},!0,!1)):La()}KBi(La){if(!this.CZ)return!0;const lb=+new Date-
+this.Be.startTime;if(399===La)return ad.a.J(512497868,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, unsupported client - PodSessionID:{0}; Time:{1};",this.Fe.podSessionId,lb),this.Md.FG(La,null),this.lgb(!1,La,!1),!0;if(this.Be.qXd&&230===La)return ad.a.J(512497867,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, file url expired - PodSessionID:{0}; Time:{1};",this.Fe.podSessionId,lb),this.f1f("CreatePodSessionFailed_GetFileUrlFailed",
La),!0;if(this.Be.TOa<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryCount&&lb<this.la.podsFailoverRehydrationCreatePodSessionMaxRetryDurationInMs){let Nb;(Nb=this.Be).TOa=Nb.TOa+1;ad.a.J(512497866,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, continue retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",this.Fe.podSessionId,this.Be.TOa,lb,La);this.Pdh();return!0}ad.a.J(512497865,801,15,"PodSeamlessFailoverManager::CreatePodSessionFailedCallback - Create Pod session failed, stopped retrying - PodSessionID:{0}; Attempts:{1}; Time:{2}; ErrorCode:{3};",
this.Fe.podSessionId,this.Be.TOa,lb,La);this.f1f("CreatePodSessionFailed",La);return!0}f1f(La,lb){this.Be.Vc.Wa("CreatePodsWithRetryResult","false");this.Be.Vc.Wa("CreatePodsRetryCount",this.Be.TOa.toString());this.Be.Vc.Om("CreatePodsWithRetryET",new Date);this.Be.Vc.sB("Result",La);this.Be.Vc.Wa("CreatePodsDuration",(+new Date-+this.Be.startTime).toString());this.lgb(!1,lb)}IYg(La,lb){this.CZ&&(lb.yxg?ad.a.J(512497864,801,50,"PodSeamlessFailoverManager::OnAfterReplication() - Current replication is outbound, replication result: {0}",
lb.S$c):(this.Be.Vc.sB("InboundDuration",(+new Date-+this.Be.VGe).toString()),this.Be.Vc.sB("Result","Success"),this.lgb(!0)))}oea(La,lb){this.CZ&&(this.Be.Vc.Wa("WaitPodsRefreshedDuration",(+new Date-+this.Be.tCl).toString()),this.Be.Vc.Wa("NewPodsId",lb.xX),this.Wy.Ffb(Object(u.a)(this,this.oea,"onPodSessionRefreshed")),this.Bm.isPaused&&this.Bm.Qib(),this.Hzh())}}Object(h.a)(Pf,"PodSeamlessFailoverManager",null,[583]);class qd{constructor(La,lb,Nb){this.Hta=La;this.Xa=Nb}cZ(){}QTb(){}o3a(La){La&&
(Array.add(La,qe.a.Mze),Array.add(La,qe.a.g$),Array.add(La,qe.a.iEb),Array.add(La,qe.a.Ouk),Array.add(La,qe.a.Wfc))}nca(La,lb){lb?((lb=La[qe.a.iEb])&&lb.toLowerCase()!==(this.Xa.h$?this.Xa.h$.toLowerCase():"")&&(ad.a.J(512497857,821,15,"HandleResponseHeaders: PodInstance was updated. Id:{0};",lb),this.Xa.h$=lb),this.Hta?(La=La[qe.a.Mze])?(this.Hta.ccpInfo=La,ad.a.J(512497827,826,50,"HandleResponseHeaders: CCPInfo was updated, length: {0}",La.length)):ad.a.J(512497826,826,15,"HandleResponseHeaders: CCPInfo couldn't be found in response headers."):
ad.a.J(512497856,826,15,"HandleResponseHeaders: ccpInfoOwner is null so skip the response headers.")):ad.a.J(512497858,826,15,"HandleResponseHeaders: abort since argument 'responseHeaders' is null.")}}Object(h.a)(qd,"RehydrationHeaderHandler",null,[611]);class Tf{constructor(La,lb,Nb,lc,Rc,Ud,Pd,Sd,Le,af){this.$N=null;this.w_c=!1;this.Mjg=zf=>{if(zf.keyCode===H.a.tod||zf.keyCode===H.a.wKa||zf.keyCode===H.a.bjb||zf.keyCode>=H.a.sjb&&zf.keyCode<=H.a.tya)return!1;this.CFe(2);return!0};this.gf=La;this.Mc=
lb;this.N$b=Nb;this.Ar=lc;this.Wc=Rc;this.De=Ud;this.RQg=Le;this.Ha=Pd;this.Ho=Sd;this.N5c=af}init(){this.Mc&&(this.Mc.SId(Object(u.a)(this,this.sessionExpired,"sessionExpired")),this.Mc.A3a(Object(u.a)(this,this.Apk,"onRehydrateSession")))}sessionExpired(){this.zsh(!0);r.ULS.sendTraceTag(594616334,821,50,"Pausing health heartbeat");fd.Health.instance.stopAllHealthTimers()}CFe(La){this.zsh(!1);const lb=e.AFrameworkApplication.Kz||!Yf.a("Rehyrdation.StopRefreshIfWopiRefreshDisable");r.ULS.sendTraceTag(544789148,
821,100,"Should refresh token: {0}",lb);lb&&this.N5c&&this.N5c.WNd(0);this.Ha.podsSeamlessFailoverEnabled&&this.Ho.mTe(!1,La,223)}Apk(){r.ULS.sendTraceTag(594616333,821,50,"Resuming health heartbeat");fd.Health.instance.resumeAllHealthTimers()}zsh(La){this.w_c!==La&&this.gf&&(La?(this.$N||(this.$N=this.De.Ce(),this.$N.id="sessiontimeoutoverlay",this.$N.className="SessionTimeoutOverlay",this.$N.tabIndex=-1,this.zci(this.$N),this.gf.appendChild(this.$N)),this.w_c=!0,this.RQg(this.$N)):(this.mYf(this.$N),
this.$N&&this.$N.parentNode&&this.$N.parentNode.removeChild(this.$N),this.$N=null,this.w_c=!1))}zci(La){La&&(this.Wc.ob(I.a.click,La,Object(u.a)(this,this.Q7a,"handleClickEvent")),this.Wc.ob(I.a.doubleClick,La,Object(u.a)(this,this.Q7a,"handleClickEvent")),Yf.a("FixRehydrationOnKeyPress")?this.Ar.addHandler(La,I.a.Xf,this.Mjg):this.N$b.ob(I.a.Xf,La,Object(u.a)(this,this.Rjg,"handleKeyEvent")),$addHandler(window,"visibilitychange",Object(u.a)(this,this.onVisibilityChange,"onVisibilityChange")))}mYf(La){La&&
(this.Wc.xb(I.a.click,La,Object(u.a)(this,this.Q7a,"handleClickEvent")),this.Wc.xb(I.a.doubleClick,La,Object(u.a)(this,this.Q7a,"handleClickEvent")),Yf.a("FixRehydrationOnKeyPress")?this.Ar.removeHandler(La,I.a.Xf,this.Mjg):this.N$b.xb(I.a.Xf,La,Object(u.a)(this,this.Rjg,"handleKeyEvent")),$removeHandler(window,"visibilitychange",Object(u.a)(this,this.onVisibilityChange,"onVisibilityChange")))}Q7a(){this.CFe(1);return!0}Rjg(La){if(La.mc.ctrlKey||La.mc.altKey||La.mc.shiftKey||La.mc.keyCode>=H.a.sjb&&
La.mc.keyCode<=H.a.tya)return!1;this.CFe(2);return!0}onVisibilityChange(){e.AFrameworkApplication.Kz&&!window.document.hidden&&this.N5c&&this.N5c.WNd(1)}dispose(){this.Mc.Mfh(Object(u.a)(this,this.sessionExpired,"sessionExpired"));this.$N&&(this.mYf(this.$N),this.$N.parentNode&&this.$N.parentNode.removeChild(this.$N));this.Ar=this.N$b=this.Wc=null;this.w_c=!1;this.RQg=null}}Object(h.a)(Tf,"SessionRehydrationController",null,[]);class Pg{constructor(){this.Da=null}Wb(La){this.Da=La||w.a.instance}dispose(){}}
Object(h.a)(Pg,"TellMePackage",null,[2,3]);var Ee=d(118),xe=d(27),jh=d(15),yg=d(105),xc=d(917);class me{constructor(La=null,lb=null,Nb=null,lc,Rc=null){this.eqd=null;this.dYe=!1;this.C4e=this.Njb=null;this.zXh=this.Jwf=this.CJh=this.D4e=!1;this.Lrc=null;this.LJh=null==lb?e.AFrameworkApplication.Tob:lb;this.DPh=null==Nb?e.AFrameworkApplication.DDa:Nb;this.UXh=null==Rc?e.AFrameworkApplication.wxa:Rc;this.SOh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeHelpOnHelpIsEnabled");this.ZYh=
!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled");this.l9k(!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIgnoreQueryForHelp"));this.QYh=!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.jb.p6b;this.RYh=!yg.a.Vw()&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMePeopleSuggestionIsEnabled");this.PYh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeFileSuggestionIsEnabled");this.GNh=!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.jb.eIb;this.SYh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeSeeMoreButtonIsEnabledInZeroTerm");this.kXh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("HelpShowsTopSearchResult");this.ITh=this.Qlc||this.Plc;this.GTh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("OnlineCommandSuggestionsIsEnabled");this.HTh=this.Yae;this.WQh=!!e.AFrameworkApplication.fa&&this.Rxa&&e.AFrameworkApplication.fa.ka("StyledHeaderInLabelIsEnabled");
this.oOh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceFastSetRequestTimeOut",1400):1400;this.wOh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMeServiceSlowSetRequestTimeOut",1400):1400;this.lOh=e.AFrameworkApplication.fa?parseFloat(e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.ClassifierHighConfidenceThreshold","-0.6")):-.6;this.TQh=
!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1));this.jYh=e.AFrameworkApplication.fa?e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateSearchEndpointUrl","https://substrate.office.com/search/api/v1/suggestions"):"https://substrate.office.com/search/api/v1/suggestions";this.zOh=e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SubstrateUrlParameters",""):"";this.lXh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.ShouldHideQueryInResults",!1);this.IXh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SimplifiedGroupingExpEnabled",!1);this.vXh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("ShowFindInDocumentInZeroTermSearchBox")||
this.rH;this.dRh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeTemplateProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.TemplateProviderEnabled",!1));this.BQh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TellMe.OfficeScriptsSamplesProvidersEnabled",!1);this.QQh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeIsRuleBasedSortingEnabled")&&
"en-US"===e.AFrameworkApplication.uiCulture;this.aRh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.ka("TellMeFeedbackProviderIsEnabled")||e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.FeedbackProviderEnabled",!1));this.oRh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeZeroTermContextualCommandSuggestionsEnabled");this.EJh=this.Rxa&&!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UseBoldedSuggestedSearchesStrings",
!1);this.NOh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.GroupReduxActionUpdates",!1);this.NXh=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.SkipFindCount",!1)||"Word"!==e.AFrameworkApplication.fa.Ga("Application"));this.lKh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.BreakIssueQueryIntoTasks",
!1);this.b_h=!!e.AFrameworkApplication.fa&&(e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.UsePerformanceMarker",!1)||e.AFrameworkApplication.fa.ka("TellMePerformanceMarkerEnabled"));this.LPh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinProviderEnabled",!1);this.PPh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinStoreLinkEnabled",
!1);this.RQh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchDescriptionEnabled",!1);this.vWh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SearchAddinByKeywords",!1);this.eJh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinSearchKeywordsContainDescription",!1);this.vOh=e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.TellMe.MenuUpdatePolicy",0):0;this.cRh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeNotesSuggestionIsEnabled")||this.Xzg;this.NPh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText1Enabled",!1);this.OPh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchStoreEntryButtonText2Enabled",
!1);this.MPh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchIntegratedTellMeServiceEnabled",!1);this.TYh=this.XQj&&(this.bze||this.cze||this.tfc||this.Rxa&&yg.a.Oja()&&!!e.AFrameworkApplication.fa&&(this.kIb||this.nhb||this.ohb||this.phb||this.lIb||e.AFrameworkApplication.fa.ka("ShowAnswerSearchResults")||e.AFrameworkApplication.fa.ka("ShowDefinitionSearchResults")||e.AFrameworkApplication.fa.ka("ShowEntitySearchResults")||
e.AFrameworkApplication.fa.ka("ShowWolframSearchResults")));this.fJh=!!e.AFrameworkApplication.fa&&!e.AFrameworkApplication.fa.ka("AppsForOfficeThirdPartyIsDisabled")&&e.AFrameworkApplication.fa.ka("AppsForOfficeAllowExternalMarketplace")&&e.AFrameworkApplication.jqa;this.gJh=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("AppsForOfficePrivateCatalogIsEnabled");this.uzj(La||{});this.pDd="2918242107";this.oDd="1454393937";this.Q1a={};this.sNa=[];this.ewi=[yg.a.Ymd]}get application(){return this.Njb}get Tob(){return this.LJh}get I_k(){return this.pDd}get H_k(){return this.oDd}get f5f(){return this.C4e}get KTi(){return this.D4e}get DDa(){return this.DPh}get wxa(){return this.UXh}get K3a(){return this.CJh}get luj(){return this.SOh}get jnl(){return this.ZYh}get XQj(){return!0}get Zml(){return this.TYh}get Cal(){return this.Jwf}l9k(La){this.Jwf=
La}get Rxa(){return this.QYh}get xnc(){return this.RYh}get wnc(){return this.PYh}get CSi(){return this.GNh}get Xml(){return this.SYh}get vTe(){return!1}get tfc(){return this.ITh}get bze(){return this.GTh}get cze(){return this.HTh}get YSa(){return!1}get SVc(){return!1}get xce(){return this.WQh}get BNe(){return this.zXh}get kIb(){return!1}get Nbl(){return!1}get NUj(){return""}get bcj(){return 4}get ccj(){return 5}get vej(){return""}get o5i(){return this.oOh}get Zfg(){return this.wOh}get xej(){return 1E3}get wej(){return 1E-6}get nkl(){return this.jYh}get vQe(){return!1}get mkl(){return!1}get GOj(){return this.QQh}get AVc(){return!1}get cce(){return!1}get hLj(){return!1}get gLj(){return!1}get Xzg(){return!1}get $zg(){return!1}get g5f(){return!1}get fIb(){return!1}get nhb(){return!1}get ohb(){return!1}get phb(){return!1}get lIb(){return!1}get Qlc(){return this.kXh}get gIb(){return this.lXh}get Plc(){return!1}get q_d(){return null}get Ybe(){return!1}get gjd(){return this.vXh}get ydg(){return 0}get V0i(){return this.lOh}get Agg(){return this.zOh}get dQj(){return this.TQh}get gdg(){return-3.9}get rH(){return this.IXh}get q6b(){return this.dRh}get dbe(){return this.BQh}get Kce(){return this.aRh}get TNa(){return this.EJh}get TSj(){return this.oRh}get eja(){return this.NOh}get wth(){return this.NXh}get bfi(){return this.lKh}get pod(){return this.b_h}get VSc(){return this.LPh}get WDj(){return this.PPh}get YOj(){return this.RQh}get Mkh(){return this.vWh}get P8h(){return this.eJh}get pr(){return this.vOh}get ZSa(){return this.cRh}get UDj(){return this.NPh}get VDj(){return this.OPh}get TDj(){return this.MPh}get PFf(){return this.fJh}get QFf(){return this.gJh}get Up(){return!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.jb.Do}get Do(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.jb.Do}get mLj(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.jb.una}get phk(){return Ea.getImageClass("OfficeAssistant_32x32x32")}z5i(){return Promise.reject("GetFindMatchCount method is not overridden")}fWc(La){return Array.contains(appChrome.selectors.getVisibleControlIds(),La)}u$d(){return!1}get Uae(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeModelRankerEnabled")}get Pxh(){return e.AFrameworkApplication.fa?
e.AFrameworkApplication.fa.Ga("TellMeServiceHelpClassifierModelName"):""}get Yae(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("TellMeMultiLingualCommandModelEnabled")}get SQc(){return"NoOpHeaderUi"}get dwi(){return this.Lrc}get parameterData(){return this.Q1a}get Msl(){return this.sNa}KOi(){if(this.eqd&&!this.dYe&&(this.dYe=!0,this.vid(this.eqd),this.Do)){var La=w.a.instance.resolve("Common.IExternalUICommandDefinitionMapping");La=(new xc.a(La)).oZd(this.eqd.M$);appChrome.api.dispatch(La)}}get Pkh(){return""}vid(){}RHi(La){const lb=
[];for(let Nb=0;Nb<La.length;++Nb)La[Nb].vcl?lb.push(new jh.a(La[Nb].alternate,yg.a.TAh+Nb.toString())):lb.push(new jh.a(La[Nb].standard,yg.a.Ymd+Nb.toString()));return lb}uzj(La){const lb={};for(let Nb in La){const lc=Nb,Rc=La[Nb];for(let Ud in Rc){const Pd=Ud,Sd=Rc[Ud];(lb[Pd]||(lb[Pd]={}))[lc]=Sd}}this.Lrc=lb}get Rxh(){return""}get Qxh(){return""}get Ksh(){return!1}}Object(h.a)(me,"TellMeApplicationData",null,[662]);class Dd{constructor(La,lb=null,Nb=!1){this.standard=La;this.alternate=lb;this.vcl=
Nb}}Object(h.a)(Dd,"TryQuerySet",null,[]);class Qe{constructor(){this.Hgf=this.Igf=null}get Nfk(){return this.Hgf}vK(La){this.Igf=La;return this.LAi(La)}bik(){this.Hgf=this.Igf}Y7i(La){return 8===La.type?String.format(CommonUIStrings.l_FindInDocumentText,La.jJ):La.jJ}G1i(La){return La.jJ}}Object(h.a)(Qe,"ParameterizedCommand",null,[]);class tf extends Qe{constructor(La){super();this.KPj=La}get commandId(){return this.KPj?"FindParameterized":"EditingFind"}get $uk(){return"Find"}LAi(La){if(!La)return null;
const lb=Z.a.je(String.format(ResourceStrings.l_ParamFindInDocTitle,La.jJ));return ma.a(yg.a.hEi(La.value),"1540292897",lb,"Find_16x16x32",null,Z.a.je(La.jJ),lb,null,null)}}Object(h.a)(tf,"FindParameterizedCommand",Qe,[]);var Rb=d(122);class Jc extends me{constructor(){super(window.TellMeControlMetadataOverrides);this.Njb="PowerPoint";if(e.AFrameworkApplication.fa.ka("TellMeTryQueriesIsEnabled")){var La=[new Dd(ResourceStrings.l_TellMeTryQuery01,"",!1),new Dd(ResourceStrings.l_TellMeTryQuery02,"",
!1),new Dd(ResourceStrings.l_TellMeTryQuery03,"",!1),new Dd(ResourceStrings.l_TellMeTryQuery04,"",!1),new Dd(ResourceStrings.l_TellMeTryQuery05,"",!1)];this.sNa=this.RHi(La)}e.AFrameworkApplication.fa.ka("TellMeFindInDocumentIsEnabled")&&(La=new tf(Jc.JPj()),this.parameterData[La.commandId]=La,this.D4e=!0,this.C4e=La.commandId)}get IIa(){return Rb.a.TLf}vid(La){if(La){La=La.M$;var lb=e.AFrameworkApplication.fa;La["PptTellMe.Animation"]=!lb.ka("TellMeAnimationsTransitionsIsEnabled")||lb.ka("241");
La["PptTellMe.Transition"]=!lb.ka("TellMeAnimationsTransitionsIsEnabled");La["PptTellMe.SelectAll"]=!lb.ka("TellMeSelectAllResultIsEnabled");La["PptTellMe.AnimationNew"]=!lb.ka("241")||!lb.ka("TellMeAnimationsTransitionsIsEnabled");La["PptTellMe.Designer"]=!lb.ka("248");lb=lb.ka("TellMeDesktopUpSellIsEnabled");var Nb=e.AFrameworkApplication.YQj;La["PptTellMe.WordArtUpSellButton"]=!lb||Nb;La["PptTellMe.SpellCheckDictUpSellButton"]=!lb||Nb;La["PptTellMe.InsertAudioUpSellButton"]=!lb||Nb;La["PptTellMe.InsertChartUpSellButton"]=
!lb||Nb;La["PptTellMe.WordArtUpSellButtonEnterprise"]=!lb||!Nb;La["PptTellMe.SpellCheckDictUpSellButtonEnterprise"]=!lb||!Nb;La["PptTellMe.InsertAudioUpSellButtonEnterprise"]=!lb||!Nb;La["PptTellMe.InsertChartUpSellButtonEnterprise"]=!lb||!Nb}}get Xzg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeNotesSuggestionIsEnabled",!1)}get $zg(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermNotesSuggestionIsEnabled",
!1)}get ydg(){return e.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.PowerPointOnline.NumberOfNotesSuggestionsToShow",2)}get Rxh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeZeroTermModelName","")}get Qxh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMultiLanguageModelName","")}get vQe(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeServiceAADAuthIsEnabled",
!1)}get Pxh(){return e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMeHelpClassifierModelName","")}get kIb(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowImageSearchResults",!1)}get Yae(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeMLCModelIsEnabled",!1)}get Ksh(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeShowMoreFileResults",
!1)}get SVc(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMeEnableRankerLogging",!1)}get q_d(){const La={};e.AFrameworkApplication.fa.ka("PPTOModernFontPickerIsEnabled")?La.FontName="FontPicker":La.FontPicker="FontName";e.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")?(La.NewSlide="NewSlideSplit",La.ChangeLayout="ChangeLayoutFlyout"):(La.NewSlideSplit="NewSlide",La.ChangeLayoutFlyout="ChangeLayout");return La}get gdg(){var La=e.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.NBClassifierScoreThreshold",
"-3.9");La=parseFloat(La);return isNaN(La)?-3.9:La}get AVc(){return e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TellMe.IsSerpletClassifierEnabled",!1)}get PFf(){return e.AFrameworkApplication.fa.ka("51")}get QFf(){return e.AFrameworkApplication.fa.ka("305")}static JPj(){return!!e.AFrameworkApplication.Aa&&e.AFrameworkApplication.Aa.jb.Up}}Object(h.a)(Jc,"PowerPointTellMeApplicationData",me,[]);class Qc extends Pg{constructor(){super()}get name(){return"PowerPointEditor.TellMe"}load(){this.init()}init(){if(e.AFrameworkApplication.Kxh){var La=
xe.App.Hb.jb.i3d(vb.a.tellMe);La.GTc?Qc.a7g():La.ZR(Object(u.a)(this,this.u_k,"scriptResource_LoadFinished"));var lb=new Jc;Ee.TellMeActor.instance.initialize(lb,null,null,null,null,null,Object(u.a)(xe.App.Hb,xe.App.Hb.g7f,"forceUpdateRibbonControls"),e.AFrameworkApplication.fa,this.Da.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.Da.Ka("Common.IActionContextProvider"),this.Da.Ka("Common.ISystemInitiatedFeedback"));Ee.TellMeActor.instance.pMk(La)}}u_k(){Qc.a7g()}static a7g(){xe.App.Hb.updateCommandUI()}}
Object(h.a)(Qc,"PowerPointTellMePackage",Pg,[]);var Ph=d(207);class ng{constructor(){this.mh=this.f4=this.K=null}get name(){return"PowerPointWebEditor.Chronos1"}Wb(La){this.K=La;this.f4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.mh=this.f4.NCa(4,this.name);this.K.register(qd,"PowerPointWebEditor.RehydrationHeaderHandler").ma().na(()=>new qd(this.K.resolve("PowerPointWebEditor.ICCPInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));
this.K.register(Tf,"PowerPointWebEditor.SessionRehydrationController").ma().na(()=>new Tf(this.K.resolve("Box4.IAppFrame").hF(),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IKeyInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
lb=>{A.FocusManager.Mr(lb)},e.AFrameworkApplication.Kz?this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"):null));this.K.register(583,"PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager").ma().na(()=>new Pf(this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IActionManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.RehydrationHeaderHandler"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.IPopSessionState"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),
this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),e.AFrameworkApplication.Ge,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPPTOfflineManager"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.Ka("PowerPointWebEditor.ICommentSessionManager")));e.AFrameworkApplication.Kz&&this.K.register(584,"PowerPointWebEditor.IPPTTokenRefreshManager").ma().na(()=>
new xf(this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("Common.ISessionExpirationManagerWithDialog"),this.K.resolve("PowerPointWebEditor.PresentationContext"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){let La=this.mh.ju("resolvechronos1");const lb=this.K.resolve("Common.AFrameworkApplication"),Nb=
this.K.resolve("PowerPointWebEditor.IApplicationContext").ld;var lc=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const Rc=this.K.resolve("Common.IActionManagerExtended"),Ud=this.K.resolve("PowerPointWebEditor.IFocusManager"),Pd=this.K.resolve("Common.Transaction.ITransactionFactory"),Sd=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Le=this.K.resolve("PowerPointWebEditor.IShapeEditor"),af=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
zf=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),yh=this.K.resolve("PowerPointWebEditor.PictureContext"),gg=this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Dh=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),Ug=this.K.resolve("PowerPointWebEditor.IPictureUploader");this.mh.qu(La);La=this.mh.ju("regactorschronos1");lc=[new Mc(Rc,af,Sd,Ud,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Pd,Ug,yh,Le,e.AFrameworkApplication.mQ,Dh,this.K.resolve("PowerPointWebEditor.IErrorHandler"),
lc,this.K.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),Nb.rJj,this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),gg,zf,Nb,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IShapeReader"))];for(var ui of lc)ui.ub(),ui.xe();this.fzj();this.mh.qu(La);La=this.mh.ju("tellme");ui=new Qc;ui.Wb(this.K);ui.load(lb);this.mh.qu(La);Nb.pptEditorTimeoutDialogRemovalIsEnabled&&Nb.tg&&(La=this.mh.ju("initrehydrationcontroller"),
this.K.resolve("PowerPointWebEditor.SessionRehydrationController").init(),this.mh.qu(La));Nb.podsSeamlessFailoverEnabled&&this.K.resolve("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager");e.AFrameworkApplication.Kz&&(La=this.mh.ju("posttokenrefresh"),this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager"),this.mh.qu(La));this.NVj()}fzj(){const La=this.K.resolve("Common.IActionManagerExtended"),lb=this.K.resolve("PowerPointWebEditor.IFocusManager"),Nb=this.K.resolve("Common.AFrameworkApplication").kr.Hd,
lc=this.K.resolve("Common.Transaction.ITransactionFactory"),Rc=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Ud=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Pd=this.K.resolve("PowerPoint.IPathManager"),Sd=this.K.resolve("PowerPointWebEditor.IPresentationReader"),Le=this.K.resolve("Common.IDynamicScriptLoaderProvider").Jv;Le.loadScript("powerpoint-editor-intl").then(()=>{ad.a.J(512497373,801,50,"Editor script is loaded successfully");Le.loadScript("powerpoint-ribbon-intl").then(()=>
{ad.a.J(512497372,801,50,"Ribbon script is loaded successfully");const af=[];af.push(new zd(La,lb,Ud,lc,Nb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Sd,Rc,Pd));for(const zf of af)zf.ub(),zf.xe()}).catch(()=>{ad.a.J(512497371,801,10,"Failed to load Ribbon script")})}).catch(()=>{ad.a.J(512497370,801,10,"Failed to load Editor script")})}NVj(){ad.a.J(512497369,809,50,"Start to download chronos2 js file");this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Rba("pptedit.chronos2",
()=>{const La=this.K.resolve("PowerPointWebEditor.ISessionState");La&&La.V4("Chronos2DownloadFinished")},()=>d.e(8).then(d.bind(null,1202)))}dispose(){const La=this.K.resolve("PowerPointWebEditor.IApplicationSettings");La.pptEditorTimeoutDialogRemovalIsEnabled&&La.tg&&this.K.resolve("PowerPointWebEditor.SessionRehydrationController").dispose();e.AFrameworkApplication.Kz&&La.tg&&this.K.resolve("PowerPointWebEditor.IPPTTokenRefreshManager").dispose()}static main(){e.AFrameworkApplication.Vg&&fb.a.eg?
ad.a.J(512497368,809,15,"Firefox attempts to load chronos1 package when App is disposing"):m.a.instance.Bc(Ph.a(new ng,4))}}Object(h.a)(ng,"Chronos1Package",null,[2,3]);var se=d(637),pf=d(141),$d=d(573),Ye=d(57),Kd=d(47);class Yd{constructor(La,lb,Nb,lc,Rc,Ud){this.type="FormatPictureTaskPaneProps";this.top=this.left=this.height=this.width=this.numberFormatInfo=null;this.disabled=!1;this.onChange=null;this.emptyValueFields=0;const Pd=Object(ic.a)(Object,pc.e().numberFormatInfo);if(!Pd)throw Error.argumentNull("numberFormatInfo");
this.numberFormatInfo=Pd;this.width=La;this.height=lb;this.top=lc;this.left=Nb;this.disabled=Rc;this.emptyValueFields=Ud}}Object(h.a)(Yd,"FormatPictureTaskPaneProps",null,[]);class Zf{constructor(La,lb,Nb,lc,Rc,Ud,Pd,Sd,Le,af,zf,yh){this.dab=!0;this.LSg=this.SMg=this.z_=this.$_=0;this.sVa=this.Db=this.IHg=!1;yh.loadScript("powerpoint-editor-intl").then(()=>{this.sVa=!0}).catch(gg=>{ad.a.J(512350083,801,10,"Failed to load powerpoint-editor-intl "+gg.toString())});this.nb=La;this.Ob=lb;this.ia=Nb;this.Fa=
lc;this.Ig=Rc;this.ua=Ud;this.Mb=Pd;this.hj=Sd;this.C8=Le;this.Xb=af;this.Lc=zf;this.Ig.vAa(Object(u.a)(this,this.G8c,"onChangeRenderFormatPicturePane"));this.Ob.JM(Object(u.a)(this,this.lw,"onAppFrameModeSwitched"));this.Lc.JNa(Object(u.a)(this,this.G8c,"onChangeRenderFormatPicturePane"))}dispose(){this.Ig.GXa(Object(u.a)(this,this.G8c,"onChangeRenderFormatPicturePane"));this.Ob.QX(Object(u.a)(this,this.lw,"onAppFrameModeSwitched"));this.Lc.Efb(Object(u.a)(this,this.G8c,"onChangeRenderFormatPicturePane"))}xe(){}ub(){this.ia.pa(Xd.a.ndd,
ue.a.application,Object(u.a)(this,this.ndd,"queryShowHideReactPictureCropPane"),96);this.ia.pa(Xd.a.bOe,ue.a.application,Object(u.a)(this,this.bOe,"showHideReactPictureCropPane"),4);this.ia.pa(Xd.a.GKb,ue.a.application,Object(u.a)(this,this.GKb,"updatePictureCropPane"),4)}ndd(La,lb,Nb,lc,Rc){(La=Object(ic.a)(Sa.a,Rc))&&La.Nf(this.Db);return 32}bOe(La,lb,Nb){if(!this.sVa)return 8;if(1===Nb)return 32;lb=this.ua.presentation;return this.ua.Ba&&lb&&!this.Xb.Zc(lb)?kd.b("ShowHideReactPictureCropPane:",
this.Db.toString(),La,()=>{if(this.Db=!this.Db){if(this.Tl(),Yf.a("CropControlEnableOnDisplayingFormatPicturePane")){const lc=this.nb.rq();(null===lc||void 0===lc?0:lc.Mx)||this.ia.processAction(Xd.a.SVf,2)}}else this.Ns();return 32}):16}GKb(La,lb,Nb){if(!this.Db)return 8;2===Nb&&this.Tl(!0);return 32}Tl(La=!1){var lb=this.SOc();lb=this.YB(lb);const Nb=Object.assign(new se.a,{title:ResourceStrings.L_FormatPicture,hideHeader:!1,width:320,location:2,contentProps:lb,onOpen:()=>{},onClose:()=>{this.Db=
!1},isModernPane:!0});pf.UISurfaces.Ms().then(lc=>{La?lc.updateTaskPane(Kd.a.dXa,Nb):lc.showTaskPane(Kd.a.dXa,Nb);return null}).catch(lc=>{ad.a.J(512350082,822,10,"Failed to show picture crop pane. Exception: "+lc.toString())})}Ns(){pf.UISurfaces.Ms().then(La=>{La.hideTaskPane(Kd.a.dXa,2);return null}).catch(La=>{ad.a.J(512350081,822,10,"Failed to hide picture crop pane. Exception: "+La.toString())})}YB(La){if(La){const lb=La.t_d(),Nb=this.Mb.Fd;this.z_=$d.a.Av(Nb.Ff(this.hj.YL(Ye.a.$l(lb.ga(0),lb.ga(3)),
La.zoom),1));this.$_=$d.a.Av(Nb.Ff(this.hj.YL(Ye.a.$l(lb.ga(0),lb.ga(1)),La.zoom),0));this.SMg=$d.a.Av(Nb.Ff(this.hj.YL(lb.ga(0).x,La.zoom),0));this.LSg=$d.a.Av(Nb.Ff(this.hj.YL(lb.ga(0).y,La.zoom),1));this.dab=!1;this.IHg=!0}else this.dab=!0;La=new Yd(this.$_,this.z_,this.SMg,this.LSg,this.dab,this.IHg?0:15);La.onChange=Object(u.a)(this,this.Rva,"onPropertyChange");return La}SOc(){const La=this.nb.rq();return La&&La.Mx&&La.isConnected?this.C8.kF(La):null}Rva(La,lb){const Nb={};Nb.Number=La;switch(lb){case 0:this.ia.La(Xd.a.AVe,
2,Nb);break;case 1:this.ia.La(Xd.a.xVe,2,Nb);break;case 2:this.ia.La(Xd.a.yVe,2,Nb);break;case 3:this.ia.La(Xd.a.zVe,2,Nb)}this.Tl(!0)}G8c(){this.Db&&this.Tl(!0)}lw(La){1===La.mode&&this.Db&&(this.Db=!1,this.Ns(),this.Fa.Gj(Kd.a.dXa,this.Db))}}Object(h.a)(Zf,"FormatPicturePaneActor",null,[]);var ef=d(839);class Ke{constructor(La,lb,Nb,lc,Rc,Ud,Pd,Sd,Le,af,zf,yh,gg,Dh,Ug,ui,Uh,Yi){this.qzb=!1;if(!Ug)throw Error.argumentNull("shapeReader");if(ui&&!Uh)throw Error.argumentNull("shapeSVGDependencyLoader");
if(!Yi)throw Error.argumentNull("businessBarController");this.ia=La;this.ra=lb;this.Fb=Nb;this.pi=lc;this.Xb=Rc;this.dne=Ud;this.MKg=Pd;this.Eo=Sd;this.Mb=Le;this.ua=af;this.hj=zf;this.C8=yh;this.nL=gg;this.D_=Dh;this.Ea=Ug;this.fla=ui;this.sBb=Uh;this.yl=Yi}ub(){this.ia.pa(Xd.a.SVf,P.a.application,Object(u.a)(this,this.F2b,"handlePictureCropEvent"),4);this.MKg?(this.ia.pa(Xd.a.PVf,P.a.application,Object(u.a)(this,this.ojg,"handleCropSplitButton"),4),this.ia.pa(Xd.a.QVf,P.a.application,Object(u.a)(this,
this.ojg,"handleCropSplitButton"),4)):(this.ia.pa(Xd.a.PVf,P.a.application,Object(u.a)(this,this.F2b,"handlePictureCropEvent"),4),this.ia.pa(Xd.a.QVf,P.a.application,Object(u.a)(this,this.F2b,"handlePictureCropEvent"),4));this.ia.pa(Xd.a.M$g,P.a.application,Object(u.a)(this,this.bFk,"queryIsActive"),101);this.ia.pa(Xd.a.Mkc,P.a.application,Object(u.a)(this,this.nrj,"handleSendCropInfo"),4);this.ia.pa(Xd.a.vxk,P.a.application,Object(u.a)(this,this.v5d,"handlePictureCropToShapeEvent"),4);this.ia.pa(Xd.a.uxk,
P.a.application,Object(u.a)(this,this.v5d,"handlePictureCropToShapeEvent"),4);this.ia.pa(Xd.a.Lhc,P.a.application,Object(u.a)(this,this.Jcd,"queryPictureCropBounding"),100);this.ia.pa(Xd.a.Nhc,P.a.application,Object(u.a)(this,this.Jcd,"queryPictureCropBounding"),100);this.ia.pa(Xd.a.Mhc,P.a.application,Object(u.a)(this,this.Jcd,"queryPictureCropBounding"),100);this.ia.pa(Xd.a.Kcd,P.a.application,Object(u.a)(this,this.Jcd,"queryPictureCropBounding"),100);this.ia.pa(Xd.a.xVe,P.a.application,Object(u.a)(this,
this.Wnd,"updatePictureCropBounding"),4);this.ia.pa(Xd.a.AVe,P.a.application,Object(u.a)(this,this.Wnd,"updatePictureCropBounding"),4);this.ia.pa(Xd.a.yVe,P.a.application,Object(u.a)(this,this.Wnd,"updatePictureCropBounding"),4);this.ia.pa(Xd.a.zVe,P.a.application,Object(u.a)(this,this.Wnd,"updatePictureCropBounding"),4)}ojg(La,lb,Nb,lc,Rc){return 1===Nb?32===this.v5d(La,lb,Nb,lc,Rc)||32===this.F2b(La,lb,Nb,lc,Rc)?32:8:this.F2b(La,lb,Nb,lc,Rc)}nrj(La,lb,Nb,lc,Rc){if(!Rc)return ad.a.J(512500482,824,
50,"Send Crop Info called with no cropping info"),8;lb=Rc.pictCropperInfo;Rc=Rc.shapeNode;if(!Rc||!Rc.pictureCropInfo)return ad.a.J(512500481,824,10,"Send Crop Info called with invalid ShapeMoniker"),8;if(1===Nb)return 32;if(Nb=ib.a.Eb)Nb.actionName="EndCropPicture",Nb.Oj=!1,Nb.Kr=!0;Nb=this.Fb.ud(15);try{Nb.kc(Rc),Nb.fd=La,Rc.igc=lb}finally{Nb&&Nb.dispose()}return 32}v5d(La,lb,Nb,lc,Rc){if(!this.MKg||this.Xb.Zc(this.ra.rn()))return 8;lb=this.ra.og();if(!lb||!lb.length)return 8;const Ud=[];for(var Pd of lb)Pd&&
Ud.push(Pd);if(!Ud.length)return 8;for(const af of Ud)if(af.isLocal||this.nL.kW(af)||!this.VMj(af))return 8;if(1===Nb)return 32;ad.a.J(512500480,824,15,"HandlePictureCropToShapeEvent:: Crop to Shape operation started");const Sd=Rc?Rc.SourceControlId:"";Pd=0;Nb=Sd.split("_");if(3===Nb.length)Pd=Number.parseInvariant(Nb[2]);else return ad.a.J(512500451,824,10,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with unknown shapeName: '{0}'",Sd),16;Nb=window.performance.now();Rc=new ef.a;
Rc.TargetShapeTypeAsInt=Pd;Pd=this.Fb.ud(15,void 0,()=>{for(const af of Ud)if(af.Mx){const zf=this.Pk(af);zf&&zf.x0(!1)}ad.a.J(512500450,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation called with shapeName: '{0}'",Sd)});try{Pd.kc(Ud[0]);Pd.fd=La;for(var Le of Ud)Le.jgc=Rc}finally{Pd&&Pd.dispose()}La=window.performance.now();if(Le=ib.a.Eb)Le.actionName="PictureCropToShape",Le.Wa("PictureCropShapeType",Rc.TargetShapeTypeAsInt.toString()),Le.Wa("PictureCropToShapeDuration",(La-Nb).toString()),
ib.a.Lea(Le);ad.a.J(512500449,824,50,"HandlePictureCropToShapeEvent:: Crop to Shape operation completed for shapeType : '{0}'",Rc.TargetShapeTypeAsInt);return 32}F2b(La,lb,Nb){if(!this.dne||this.Xb.Zc(this.ra.rn()))return 16;if(this.fla&&!this.sBb.Fwg)return ad.a.J(512500448,824,10,"HandlePictureCropEvent:: Crop operation failed m_shapeSVGDependencyLoader is not loaded"),8;lb=this.ra.Yd();const lc=this.ra.i0d(lb);if(1!==lb.length)return Yf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Nb&&this.BZf(),
8;if(!lc)return 8;if(this.Ea.Ow(lc).length)return Yf.a("CropCannotBePerformedOnCurrentSelection")&&1!==Nb&&this.BZf(),8;if(!this.ube(lc))return 8;if(1===Nb)return 32;if(lc.isLocal||this.nL.kW(lc))return 16;if(lc.Mx){La=this.Pk(lc);if(!La)return 8;La.x0(!1);lc.pictureCropInfo=null;xe.App.Hb.updateCommandUI();this.ia.processAction(Xd.a.GKb,2);return 32}this.ra.kj();const Rc=this.ua.Ba;this.Xb.blockContent(Rc,La);const Ud=ib.a.Eb;Ud&&(Ud.actionName="BeginCropPicture",Ud.Oj=!1,Ud.Kr=!0);this.pi.deg(lc.get_sid(),
lc.get_cid(),lc.get_shapeId(),Pd=>{ib.a.cF(Ud,()=>{this.Emk(lc,Rc,Pd)})},()=>this.Dmk(lc,Rc),!0);return 32}bFk(La,lb,Nb,lc,Rc){if(!Object(md.a)(Sa.a,Rc))return 8;La=this.ra.rq();Rc.Nf(La?La.Mx:!1);return 32}SOc(){const La=this.ra.rq();return La&&La.Mx&&La.isConnected?this.C8.kF(La):null}Pk(La){return La?Object(ic.a)(121,La.oc(this.Mb.Ma)):null}BZf(){this.yl.ZM(26)}Jcd(La,lb,Nb,lc,Rc){if(!this.dne||!Rc)return 16;lb=this.SOc();if(!lb)return 16;Nb=lb.t_d();lc=this.Mb.Fd;La=La===Xd.a.Lhc?lc.Ff(this.hj.YL(Ye.a.$l(Nb.ga(0),
Nb.ga(3)),lb.zoom),1):La===Xd.a.Nhc?lc.Ff(this.hj.YL(Ye.a.$l(Nb.ga(0),Nb.ga(1)),lb.zoom),0):La===Xd.a.Mhc?lc.Ff(this.hj.YL(Nb.ga(0).x,lb.zoom),0):lc.Ff(this.hj.YL(Nb.ga(0).y,lb.zoom),1);Rc=Rc.queryResult;null!==Rc&&(Rc.C$=parseFloat($d.a.Av(La).toFixed(2)).toString());return 32}Wnd(La,lb,Nb,lc,Rc){if(!this.dne||this.fla&&!this.sBb.Fwg)return 16;lb=this.SOc();if(1===Nb)return lb?32:16;if(!lb||!Rc)return 16;if(2===Nb){Nb=!1;lc=lb.t_d().copy();Rc=$d.a.cW(Rc.Number);const Ud=Ye.a.$l(lc.ga(0),lc.ga(1)),
Pd=Ye.a.$l(lc.ga(0),lc.ga(3)),Sd=this.Mb.Fd;La===Xd.a.xVe?(Rc=this.hj.cM(Sd.Ie(Rc,1),lb.zoom),La=Rc-Pd,lc.ga(2).IL(0,La),lc.ga(3).IL(0,La)):La===Xd.a.AVe?(Rc=this.hj.cM(Sd.Ie(Rc,0),lb.zoom),La=Rc-Ud,lc.ga(1).IL(La,0),lc.ga(2).IL(La,0)):La===Xd.a.yVe?(Nb=!0,Rc=this.hj.cM(Sd.Ie(Rc,0),lb.zoom),La=Rc-lc.ga(0).x,lc.move(La,0)):La===Xd.a.zVe&&(Nb=!0,Rc=this.hj.cM(Sd.Ie(Rc,1),lb.zoom),La=Rc-lc.ga(0).y,lc.move(0,La));lb.Xvl(lc,Nb)}return 32}VMj(La){let lb=[];La.Jf?lb=this.Ea.Ow(La):La.Og&&(lb=this.Ea.Ow(La.ds()));
if(lb.length){for(const Nb of lb)if(!this.ube(Nb))return!1;return!0}return this.ube(La)}ube(La){const lb=this.Eo.EQe&&!La.isGif&&(La.wk||1===La.mediaType)&&!La.get_isSVGBlipFilled();return this.D_?lb&&!La.WCb:lb}Dmk(La,lb){this.Xb.GJ(lb);if(!this.isActive||!La.isConnected)return!0;this.isActive=!1;La.pictureCropInfo=null;ad.a.J(512500446,824,10,"Error: Failed to perform command of Get picture crop info.");return!1}Emk(La,lb,Nb){this.Xb.GJ(lb);if(La.isConnected)if(lb=ib.a.Eb,ib.a.cF(lb,()=>{this.ia.processAction(Xd.a.G4a,
2)}),this.nL.kW(La))ad.a.J(512500445,822,50,"Crop is cancelled due to shape manipulation");else{var lc=La.sg(this.Mb.Ma);if(lc){var Rc=new Date;La.pictureCropInfo=JSON.parse(Nb.PictureCropInfoStr);this.C8.AG(La).Gil();La=new Date;lb&&(lb.Om("ParseCropInfoStart",Rc),lb.Om("ParseCropInfoEnd",La),ib.a.Lea(lb));lc.oA();this.ia.processAction(Xd.a.GKb,2)}}}get isActive(){return this.qzb}set isActive(La){this.qzb=La}}Object(h.a)(Ke,"PictureCropActor",null,[]);var gi=d(1174),Rf=d(192),Uf=d(184),Ed=d(211),
vg=d(131),Jd=d(164),Ie=d(322),gf=d(838),eh=d(615),rg=d(46),Cg=d(66),kh=d(709),De=d(113),Nd=d(205),Od=d(167),mj=d(871),qi=d(321),Vf=d(204),Ai=d(185),$g=d(186),Ch=d(282);class nf{constructor(La,lb,Nb,lc,Rc,Ud,Pd,Sd,Le,af,zf,yh,gg,Dh){this.Db=!0;this.zk=!1;this.vn=[];this.N3=this.QA=this.LW=this.gH=this.QI=this.wb=null;this.tC=Array(8);this.dua=this.Zm=this.sv=null;this.MT=this.nd=1;this.Nre=new Ye.a(0,0);this.xn=new Rf.a;this.U_=new Uf.a;this.rcc=new Ye.a(0,0);this.Kcb=0;this.Xt=new Uf.a;this.uua=new Ye.a(0,
0);this.Yka=new Ye.a(0,0);this.Jcc=this.GUa=!1;this.R$b=new Ye.a(0,0);this.G9=this.g9=null;this.nHg=new Lb.a;this.vv=null;if(!lc)throw Error.argumentNull("clickInputManager");if(!La)throw Error.argumentNull("shapeNode");if(zf&&!yh)throw Error.argumentNull("transformFactory");if(zf&&!gg)throw Error.argumentNull("presReader");this.ta=La;this.Ea=lb;this.lc=Nb;this.Wc=lc;this.ia=Rc;this.vC=Ud;this.Ee=Pd;this.I8=Sd;this.h$j=Le;this.Sbb=af;this.fla=zf;this.pk=yh;this.i3j=Dh}ym(La){this.wb=new Ai.a;this.wb.Rj(1);
this.wb.Ld(!1);this.wb.jna(Cg.a.$jl);La.appendChild(this.wb.viewport);this.QI=new kh.a(!1,this.fla);this.wb.appendChild(this.QI);this.gH=new kh.a(!1,this.fla);this.wb.appendChild(this.gH);this.gH.Rj(1);this.LW=new Od.a;this.LW.Hu(ld.a.F0);this.LW.ar(ld.a.rE);this.LW.oE(De.a.none);this.LW.Rj(1);this.wb.appendChild(this.LW);this.N3=new Od.a;this.N3.Rj(1);this.N3.Yk(Cg.a.Cxa);this.N3.jna("ShapeMoveHandle");this.N3.oE(De.a.none);this.wb.appendChild(this.N3);this.QA=new Nd.a;this.NXb(this.QA);this.wb.appendChild(this.QA);
this.wb.viewport.xa.setAttribute("class",Cg.a.mgc);this.wb.Ld(!1);this.Wc.ob(I.a.click,this.N3.xa,Object(u.a)(this,this.W7c,"noOpHandler"));this.Wc.ob(I.a.click,this.LW.xa,Object(u.a)(this,this.W7c,"noOpHandler"))}NXb(La){for(let lc=0;8>lc;++lc){var lb="cropHandle"+lc;const Rc=new Nd.a;Rc.xa.id=lb;if(fb.a.FJa){var Nb=new qi.a;Nb.xa.id=lb;Nb.setVisibility(!1);Nb.setPosition(-10,-10);Nb.gh(20,20);Rc.appendChild(Nb)}Nb=new Jd.a(lc);lb=Nb.G4b()?this.Jyi(Nb,lb):this.OCi(Nb,lb);Rc.appendChild(lb);Rc.Rj(1);
this.tC[lc]=Rc;La.appendChild(Rc)}}g7d(La){for(let lb=0;8>lb;++lb)if(this.tC[lb].xa.id===La.id)return new Jd.a(lb);return null}rOj(La){return La.id.startsWith("cropHandle")}dispose(){this.I8();this.zk=!0;this.Db=!1;this.wb&&this.wb.qq();this.wb=null;this.N3&&this.Wc.xb(I.a.click,this.N3.xa,Object(u.a)(this,this.W7c,"noOpHandler"));this.N3=null;this.LW&&this.Wc.xb(I.a.click,this.LW.xa,Object(u.a)(this,this.W7c,"noOpHandler"));this.QA=this.LW=null;this.tC&&Array.clear(this.tC);this.g9=this.G9=this.tC=
null;this.R$b=new Ye.a(0,0)}Vid(La,lb,Nb,lc){const Rc=this.f3d(),Ud=La-Rc.x+this.Yka.x+Nb,Pd=lb-Rc.y+this.Yka.y+lc;return isNaN(Ud)||isNaN(Pd)?(ad.a.J(512497029,822,15,"PictureCropShapeView::ShiftPositionRelativeToShape - x:{0}, nodeTopLeft.X:{1}, m_maskViewPositionDiff.X:{2}, distX:{3}, y:{4}, nodeTopLeft.Y:{5}, m_maskViewPositionDiff.Y:{6}, distY:{7}, m_zoom:{8}",La,Rc.x,this.Yka.x,Nb,lb,Rc.y,this.Yka.y,lc,this.nd),new Ye.a(0,0)):new Ye.a(Ud,Pd)}setPosition(La,lb){this.GUa&&this.ta.pictureCropInfo&&
(this.uua=La=new Ye.a(La/this.nd,lb/this.nd),this.Sbb?(this.g9&&this.QI&&(lb=this.Vid(this.g9.Position.X,this.g9.Position.Y,La.x,La.y),this.QI.setPosition(lb.x,lb.y)),this.G9&&this.gH&&this.gH.image&&(La=this.Vid(this.G9.Position.X,this.G9.Position.Y,La.x,La.y),this.gH.image.setPosition(La.x,La.y))):((lb=this.ta.pictureCropInfo.MaskViewElem)&&this.QI&&(lb=this.Vid(lb.Position.X,lb.Position.Y,La.x,La.y),this.QI.setPosition(lb.x,lb.y)),(lb=this.ta.pictureCropInfo.TextureViewElem)&&this.gH&&this.gH.image&&
(La=this.Vid(lb.Position.X,lb.Position.Y,La.x,La.y),this.gH.image.setPosition(La.x,La.y))),this.wb.Gl())}phl(La,lb){const Nb=new Ye.a(this.Ea.GA(this.ta,this.vC).x/this.nd,this.Ea.GA(this.ta,this.vC).y/this.nd),lc=new Ye.a(this.Yka.x+this.uua.x,this.Yka.y+this.uua.y);if(this.Sbb)this.g9&&this.QI&&this.QI.setPosition(this.g9.Position.X-Nb.x+lc.x+La/this.nd,this.g9.Position.Y-Nb.y+lc.y+lb/this.nd),this.G9&&this.gH&&this.gH.image.setPosition(this.G9.Position.X-Nb.x+lc.x+La/this.nd,this.G9.Position.Y-
Nb.y+lc.y+lb/this.nd);else{var Rc=this.ta.pictureCropInfo.MaskViewElem;Rc&&this.QI.setPosition(Rc.Position.X-Nb.x+lc.x+La/this.nd,Rc.Position.Y-Nb.y+lc.y+lb/this.nd);(Rc=this.ta.pictureCropInfo.TextureViewElem)&&this.gH.image.setPosition(Rc.Position.X-Nb.x+lc.x+La/this.nd,Rc.Position.Y-Nb.y+lc.y+lb/this.nd)}this.wb.Gl()}qhl(La,lb){lb.Dj(1/this.MT);this.fph(La,Rf.a.add(this.AWa,lb))}resize(La,lb){lb.Dj(1/this.MT);this.fph(La,lb)}fph(La,lb){La=this.mMd(La,lb);this.Gq(La);this.setOffsets(lb)}f3d(){const La=
this.Ea.GA(this.ta,this.vC);return new Ye.a(La.x/this.nd,La.y/this.nd)}zEh(){this.ta.Mx&&(this.MT=this.lc.ig(this.ta).hq/this.Nre.x)}Gil(){const La=this.lc.ig(this.ta);this.Nre.update(La.hq,La.Kk)}Dj(La){this.nd=La;this.wb.Dj(this.nd);La=new Uf.a;La.aba(1/this.nd,1/this.nd);this.QA.pE(La,Vf.a.iba);this.i3j?this.KX(!1):this.KX(!0)}get zoom(){return this.nd/this.MT}t_d(){this.zEh();this.sv||(this.sv=this.ta.Uo);var La=Ye.a.$l(this.sv.ga(0),this.sv.ga(1));const lb=Ye.a.$l(this.sv.ga(0),this.sv.ga(3)),
Nb=this.sv.Vf(),lc=new vg.a(new Ye.a(0,0),new Ye.a(La,0),new Ye.a(La,lb),new Ye.a(0,lb));lc.move(Nb.x-La/2,Nb.y-lb/2);La=this.f3d();lc.move(La.x,La.y);lc.scale(this.MT,this.MT);return lc}Xvl(La,lb){La=La.copy();La.scale(1/this.MT,1/this.MT);var Nb=this.f3d();La.move(-1*Nb.x,-1*Nb.y);Nb=La.Vf();const lc=new Uf.a;lb?lc.Q6(this.ta.get_shapeRotation(),Nb):lc.Q6(this.ta.get_shapeRotation(),this.sv.ga(0));lc.ql(La);lb||La.move(this.sv.ga(0).x-La.ga(0).x,this.sv.ga(0).y-La.ga(0).y);this.sv=La;this.LW.ht(this.sv.points);
lb=this.gH.clipPath;Yf.a("SVGCreationOnChangesFromFormatPane")&&this.fla&&lb?(lb.uWb=this.UGc(La),this.pBc(La.ga(0))):lb&&lb.w4a&&lb.w4a.BVe(this.sv.points);this.Jcc=!0;this.KX(!0);this.wb.Gl()}setZIndex(La){this.wb.pB(La+2*Ie.a.baa)}setOffsets(La){this.sv||(this.sv=this.ta.Uo);this.q9h(La);this.xn=La;var lb=this.QA.hyb;La=new Ye.a(lb[0].x/this.nd,lb[0].y/this.nd);var Nb=new Ye.a(lb[2].x/this.nd,lb[2].y/this.nd);const lc=new Ye.a(lb[4].x/this.nd,lb[4].y/this.nd);lb=new Ye.a(lb[6].x/this.nd,lb[6].y/
this.nd);La=new vg.a(La,Nb,lc,lb);this.LW.ht(this.sv.points);Nb=this.gH.clipPath;this.fla&&Nb?(this.pBc(Ye.a.yU(La.points[this.Kcb],this.rcc)),Nb.uWb=this.UGc(La)):Nb&&Nb.w4a&&Nb.w4a.BVe(La.points);this.wb.Gl()}q9h(La){var lb=this.sv,Nb=Ye.a.$l(lb.ga(0),lb.ga(1));lb=Ye.a.$l(lb.ga(0),lb.ga(3));La.bottom-La.top<-1*lb&&(lb+=La.bottom-La.top,La.top+=lb,La.bottom-=lb);La.right-La.left<-1*Nb&&(Nb+=La.right-La.left,La.left+=Nb,La.right-=Nb)}Gq(La){this.U_=La;this.LW.pE(La,Vf.a.iba);this.KX(!0)}Gu(La){this.Xt=
La;this.wb.pE(La,Vf.a.Apb);this.wb.Gl()}Ay(){Array.clear(this.vn)}CD(La){return this.rOj(La)?this.g7d(La):null}jB(La){const lb=[];var Nb=this.ta.pictureCropInfo;if(this.ta.Mx){const lc=this.lc.ig(this.ta);if(Nb.MaskViewElem){let Rc=Ch.a.SGc(6,lc.hq,lc.Kk);Array.add(lb,Rc)}Nb.TextureViewElem&&(Nb=Ch.a.SGc(7,lc.hq,lc.Kk),Array.add(lb,Nb));Array.add(this.vn,La)}else this.Db=!1,this.wb.Ld(!1);return lb}LC(){}ozl(){this.R$b.x!==this.QI.x&&this.R$b.y!==this.QI.y&&(ad.a.J(512497026,822,50,"PictureCropShapeView::UpdateViewElementPositionForRedraw - Updating maskViewElements and PictureViewElements "),
this.g9.Position.X=this.QI.x+this.Ea.GA(this.ta,this.vC).x/this.nd,this.g9.Position.Y=this.QI.y+this.Ea.GA(this.ta,this.vC).y/this.nd,this.G9.Position.X=this.gH.image.x+this.Ea.GA(this.ta,this.vC).x/this.nd,this.G9.Position.Y=this.gH.image.y+this.Ea.GA(this.ta,this.vC).y/this.nd,this.Yka.update(0,0))}qVb(La,lb){const Nb=this.pk.$Gc();this.ta.get_isVerticallyFlipped()&&(Nb.aba(1,-1),Nb.HB(0,2*lb._y));this.ta.get_isHorizontallyFlipped()&&(Nb.aba(-1,1),Nb.HB(2*lb._x,0));Nb.Q6(La,lb);return Nb}ngg(){return this.ta.get_isVerticallyFlipped()&&
this.ta.get_isHorizontallyFlipped()?2:this.ta.get_isVerticallyFlipped()?3:this.ta.get_isHorizontallyFlipped()?1:0}pBc(La){const lb=new Uf.a;lb.HB(La._x,La._y);this.gH.clipPath.pE(lb,Vf.a.iba)}UGc(La){ad.a.J(512497025,809,15,"PictureCropShapeView:: createSVG operation started");var lb=this.ta.get_shapeRotation();this.pk.zba(-lb,La.Vf()).ql(La);this.vv||(this.vv=svgShape.FactoryGlobal.createShape());this.vv.setSVGRoot(this.wb.xa,!1);this.ta.cS?this.vv.setShapeType(this.ta.cS):(this.vv.setShapeType(4),
ad.a.J(539760099,809,50,"ShapeNode ArtShapeType is null"));this.vv.setOffsets(this.ta.get_xPersisted()+gi.a.JX(La.ga(0).x/this.MT,0),this.ta.get_yPersisted()+gi.a.JX(La.ga(0).y/this.MT,1));this.vv.setExtents(gi.a.JX(La.ga(1).x-La.ga(0).x,0),gi.a.JX(La.ga(2).y-La.ga(1).y,1));var Nb=svgShape.FactoryGlobal.getConvertor().getPath(this.vv,!1,this.MT,this.MT);if(!Nb||!Nb.length)throw ad.a.J(512497024,822,15,"PictureCropShapeView::CreateSVG -No response received from getPath"),Error.invalidOperation(" Invalid response for svgpath element");
La=Array(Nb.length);lb=0;for(const lc of Nb)Nb=new Od.a,Nb.y0(lc),Nb.xa.setAttribute(De.a.WJb,this.Xt.xib()),La[lb++]=Nb;ad.a.J(512496995,809,15,"PictureCropShapeView:: createSVG operation ended");return La}draw(La,lb){if(Array.contains(this.vn,La)){Array.remove(this.vn,La);if(this.ta.pictureCropInfo&&!this.GUa){if(this.ta.pictureCropInfo.MaskViewElem){La=this.ta.pictureCropInfo.MaskViewElem;var Nb=La.Clip,lc=this.lc.ig(this.ta);lc=Ch.a.SGc(6,lc.hq,lc.Kk);if(lc=lb[lc.toString()])this.QI.I4k(lc.Base64Data,
La.Id.toString(),Nb.Bounds.Left,Nb.Bounds.Top,Nb.TotalWidth,Nb.TotalHeight,Nb.Bounds.Right-Nb.Bounds.Left,Nb.Bounds.Bottom-Nb.Bounds.Top),this.QI.Ld(!0),this.QI.setPosition(La.Position.X-this.Ea.GA(this.ta,this.vC).x/this.nd,La.Position.Y-this.Ea.GA(this.ta,this.vC).y/this.nd);this.g9=La;this.R$b=new Ye.a(this.QI.x,this.QI.y)}this.ta.pictureCropInfo.TextureViewElem?(La=this.lc.ig(this.ta),lc=Ch.a.SGc(7,La.hq,La.Kk),La=this.ta.pictureCropInfo.TextureViewElem,Nb=La.Clip,(lb=lb[lc.toString()])?this.fla?
(this.Kcb=this.ngg(),this.rcc=this.Zm.points[this.Kcb].copy(),this.pBc(Ye.a.yU(this.ta.Uo.points[this.Kcb],this.rcc)),this.Xt=this.qVb(this.ta.get_shapeRotation(),this.ta.Uo.Vf()),this.gH.J4k(lb.Base64Data,La.Id.toString(),La.Position.X-this.Ea.GA(this.ta,this.vC).x/this.nd,La.Position.Y-this.Ea.GA(this.ta,this.vC).y/this.nd,Nb.TotalWidth,Nb.TotalHeight,this.Zm.copy().points,this.UGc(this.Zm.copy()))):this.gH.H4k(lb.Base64Data,La.Id.toString(),La.Position.X-this.Ea.GA(this.ta,this.vC).x/this.nd,La.Position.Y-
this.Ea.GA(this.ta,this.vC).y/this.nd,Nb.TotalWidth,Nb.TotalHeight,this.ta.Uo.points):ad.a.J(512496993,822,50,"PictureCropShapeView::Draw - No Crop Texture Image Downloaded"),this.G9=La):ad.a.J(512496992,822,50,"PictureCropShapeView::Draw - Unable to set image and bounds to polygon as TextureViewElem is null");this.sv&&Ye.a.$l(this.sv.ga(0),this.sv.ga(2))||(this.sv=this.ta.Uo);this.dua=this.ta.XWa;this.N3.ht(this.dua.points);this.LW.ht(this.sv.points);this.GUa=!0;this.KX(!0);this.visible=this.Db}else this.Sbb&&
this.g9&&this.G9&&(this.ozl(),this.QI.setPosition(this.g9.Position.X-this.Ea.GA(this.ta,this.vC).x/this.nd,this.g9.Position.Y-this.Ea.GA(this.ta,this.vC).y/this.nd),this.gH.image.setPosition(this.G9.Position.X-this.Ea.GA(this.ta,this.vC).x/this.nd,this.G9.Position.Y-this.Ea.GA(this.ta,this.vC).y/this.nd),this.fla?(this.Kcb=this.ngg(),this.rcc=this.Zm.points[this.Kcb].copy(),this.pBc(Ye.a.yU(this.ta.Uo.points[this.Kcb],this.rcc)),this.Xt=this.qVb(this.ta.get_shapeRotation(),this.ta.Uo.Vf()),this.gH.clipPath.uWb=
this.UGc(this.ta.Uo)):this.gH.clipPath.w4a=new mj.a(this.ta.Uo.points,0),this.R$b=new Ye.a(this.QI.x,this.QI.y),this.sv=this.ta.Uo,this.dua=this.ta.XWa,this.N3.ht(this.dua.points),this.LW.ht(this.sv.points),this.KX(!0),ad.a.J(512496991,822,50,"PictureCropShapeView::Draw - Redrawed crop views "));this.wb.Gl();this.wb.Ld(this.Db)}}Gvl(){if(this.sv){var La=this.QA.hyb;const lb=new Ye.a(La[0].x/this.nd,La[0].y/this.nd),Nb=new Ye.a(La[2].x/this.nd,La[2].y/this.nd),lc=new Ye.a(La[4].x/this.nd,La[4].y/this.nd);
La=new Ye.a(La[6].x/this.nd,La[6].y/this.nd);this.sv=new vg.a(lb,Nb,lc,La)}else this.sv=this.ta.Uo;this.Zm=this.sv.copy();this.dua||(this.dua=this.ta.XWa);this.dua.move(this.uua.x,this.uua.y);this.N3.ht(this.dua.points);this.Yka.IL(this.uua.x,this.uua.y);this.uua.update(0,0);this.Ee.mz(new $g.a(1))}e1i(){var La=this.QA.hyb;const lb=new Ye.a(La[0].x,La[0].y),Nb=new Ye.a(La[2].x,La[2].y),lc=new Ye.a(La[4].x,La[4].y);La=new Ye.a(La[6].x,La[6].y);return new vg.a(lb,Nb,lc,La)}Z2i(){var La=this.ta.XWa.copy().points,
lb=new Ye.a(La[0].x*this.nd,La[0].y*this.nd);const Nb=new Ye.a(La[1].x*this.nd,La[1].y*this.nd),lc=new Ye.a(La[2].x*this.nd,La[2].y*this.nd);La=new Ye.a(La[3].x*this.nd,La[3].y*this.nd);lb=new vg.a(lb,Nb,lc,La);lb.scale(1/this.MT,1/this.MT);lb.move((this.Yka.x+this.uua.x)*this.nd,(this.Yka.y+this.uua.y)*this.nd);return lb}nE(La){this.GUa&&(this.QA.Ld(!La),La?(this.zEh(),this.Jcc=!0):(this.Gvl(),this.ia.processAction(Xd.a.GKb,2),this.Sbb&&(La={["pictCropperInfo"]:this.VKf(),["shapeNode"]:this.ta},
this.ia.La(Xd.a.Mkc,2,La))))}Qp(){return this.wb.Qp()}KX(La){if(this.GUa){var lb=this.sv.copy();La&&this.U_.ql(lb);La=new Uf.a;La.$nb(this.ta.get_shapeRotation());var Nb=2*Math.ceil((this.ta.get_shapeRotation()-45)/90)%8;for(let lc=0;8>lc;++lc){const Rc=this.tC[lc];Rc.Yk(rg.a.GP(Ed.a.box4Image(nf.qkc[Nb]),Cg.a.mA));this.YIa(Rc,lb.ik(new Jd.a(lc)));Rc.pE(La,Vf.a.Apb);Nb=(Nb+1)%8}}}YIa(La,lb){La.x===lb.x*this.nd&&La.y===lb.y*this.nd||La.setPosition(lb.x*this.nd,lb.y*this.nd)}get visible(){return this.Db}set visible(La){this.Db=
La;!La&&this.GUa&&(this.UPi(),this.GUa=!1);this.wb.Ld(this.Db)}UPi(){if(this.GUa){if(this.Jcc){const La={["pictCropperInfo"]:this.VKf(),["shapeNode"]:this.ta};this.ia.La(Xd.a.Mkc,2,La)}this.f2()}}VKf(){let La,lb,Nb,lc;const Rc=this.Rji();({left:La,top:lb,right:Nb,bottom:lc}=this.Jsi());return Object.assign(new gf.a,{Left:La,Top:lb,Right:Nb,Bottom:lc,X:Rc.x,Y:Rc.y})}Jsi(){let La,lb,Nb,lc;({left:La,top:lb,right:Nb,bottom:lc}=this.IHi());({left:La,top:lb,right:Nb,bottom:lc}=this.uwi(La,lb,Nb,lc));({left:La,
top:lb,right:Nb,bottom:lc}=nf.WAl(La,lb,Nb,lc));return{left:La,top:lb,right:Nb,bottom:lc}}IHi(){let La,lb,Nb;var lc=this.dua.points;const Rc=this.sv.points;La=eh.a(lc[3],lc[0],Rc[3],Rc[0]);lb=eh.a(lc[0],lc[1],Rc[0],Rc[1]);Nb=eh.a(lc[1],lc[2],Rc[1],Rc[2]);lc=eh.a(lc[2],lc[3],Rc[2],Rc[3]);return{left:La,top:lb,right:Nb,bottom:lc}}uwi(La,lb,Nb,lc){var Rc=this.dua.points;const Ud=Ye.a.$l(Rc[0],Rc[1]);Rc=Ye.a.$l(Rc[1],Rc[2]);La=Math.floor(La/Ud*1E6)/1E6;lb=Math.floor(lb/Rc*1E6)/1E6;Nb=Math.floor(Nb/Ud*
1E6)/1E6;lc=Math.floor(lc/Rc*1E6)/1E6;return{left:La,top:lb,right:Nb,bottom:lc}}Rji(){var La=this.sv.copy(),lb=new Uf.a,Nb=La.Vf();lb.Q6(-1*this.ta.get_shapeRotation(),Nb);lb.ql(La);Nb=this.Ea.GA(this.ta,this.vC);this.h$j?(lb=this.vC.Ff(La.Yb*this.nd+Nb.x,0),La=this.vC.Ff(La.$b*this.nd+Nb.y,1),La=new Ye.a(lb,La)):La=new Ye.a(La.Yb+Nb.x/this.nd,La.$b+Nb.y/this.nd);return Ye.a.scale(La,this.MT,this.MT)}W7c(){return!0}f2(){this.LW.pE(new Uf.a,Vf.a.iba);this.N3.setPosition(0,0);this.xn=new Rf.a;this.Zm=
this.sv=this.U_=this.ta.pictureCropInfo=null;this.Yka.update(0,0);this.Jcc=!1;this.Nre.update(0,0);this.MT=1}mMd(La,lb){const Nb=new Uf.a;this.Zm||(this.Zm=La);La=this.Zm.Vf();const lc=Ye.a.$l(this.Zm.ga(0),this.Zm.ga(1)),Rc=Ye.a.$l(this.Zm.ga(0),this.Zm.ga(3)),Ud=lc?1+(lb.right-lb.left)/lc:1,Pd=Rc?1+(lb.bottom-lb.top)/Rc:1,Sd=La.copy();Sd.IL(-1*lc/2,-1*Rc/2);Nb.Q6(-1*this.ta.get_shapeRotation(),La);Nb.HB(-1*Sd.x,-1*Sd.y);Nb.aba(Ud,Pd);Nb.HB(lb.left+Sd.x,lb.top+Sd.y);Nb.Q6(this.ta.get_shapeRotation(),
La);return Nb}Jyi(La,lb){var Nb=[new Ye.a(0,0),new Ye.a(20,0),new Ye.a(20,5),new Ye.a(5,5),new Ye.a(5,20),new Ye.a(0,20)];Nb=new mj.a(Nb,0);Nb.xa.id=lb;Nb.oE("black");Nb.Hu("white");Nb.ar(1);La.equals(Jd.a.gE)?Nb.dJa(90):La.equals(Jd.a.Bu)?Nb.dJa(0):La.equals(Jd.a.uE)?Nb.dJa(180):La.equals(Jd.a.sH)&&Nb.dJa(-90);return Nb}OCi(La,lb){const Nb=new qi.a;Nb.xa.id=lb;Nb.oE("black");Nb.Hu("white");Nb.ar(1);Nb.gh(20,5);La.equals(Jd.a.north)?Nb.setPosition(-10,0):La.equals(Jd.a.south)?Nb.setPosition(-10,-5):
La.equals(Jd.a.east)?(Nb.setPosition(-5,-10),Nb.gh(5,20)):La.equals(Jd.a.west)&&(Nb.setPosition(0,-10),Nb.gh(5,20));return Nb}get AWa(){return this.xn}get ie(){return this.wb.viewport}B2d(La){return!this.ta.Mx&&8>La.index?this.tC[La.index].xa:null}kN(){return!1}xx(La){La&&(this.Jcc=!1)}setSelection(){}static WAl(La,lb,Nb,lc){.999999<La+Nb&&(ad.a.J(512496987,822,15,"Invalid crop region inset values: left({0}), right({1})",La,Nb),Nb=(999999-1E6*La)/1E6);.999999<lb+lc&&(ad.a.J(512496986,822,15,"Invalid crop region inset values: top({0}), bottom({1})",
lb,lc),lc=(999999-1E6*lb)/1E6);return{left:La,top:lb,right:Nb,bottom:lc}}}nf.qkc=[Cg.a.Mvh,Cg.a.Kvh,Cg.a.Lvh,Cg.a.Jvh,Cg.a.Ovh,Cg.a.Nvh,Cg.a.Pvh,Cg.a.Qvh];Object(h.a)(nf,"PictureCropShapeView",null,[618,535,536,106]);var qf=d(649);class Wi{constructor(La,lb,Nb){this.Ea=La;this.vC=lb;this.C8=Nb}setPosition(La,lb,Nb){this.C8.kF(La.shapeNode).phl(lb,Nb)}setOffsets(La,lb){this.C8.kF(La.shapeNode).qhl(La.KUe.copy(),lb)}iI(La,lb){const Nb=new Uf.a,lc=this.C8.kF(La.shapeNode);lb=lb?lc.e1i().copy():lc.Z2i().copy();
La=this.Ea.GA(La.shapeNode,this.vC);Nb.HB(La.x,La.y);Nb.ql(lb);return new qf.a(lb)}PF(La){return La.shapeNode.Mx}}Object(h.a)(Wi,"ShapeCropMoveResizeHandler",null,[610]);class Tg{constructor(La,lb,Nb){this.C8=La;this.Sbb=lb;this.q8j=Nb}x0(La,lb,Nb){if((La=this.C8.kF(La))&&La.visible!==Nb){for(const lc of lb)this.q8j&&(lb=Object(ic.a)(607,lc))&&lb.setSelected(!Nb),lc!==La&&(lc.visible=!Nb);La.visible=Nb}}njd(){return!1}Bnd(La,lb,Nb){this.C8.kF(La).resize(Nb,lb)}ojd(){return!1}Cnd(La,lb,Nb,lc){lc&&
this.C8.kF(La).setPosition(lb,Nb)}lWc(){return!this.Sbb}P6a(La,lb){return this.Sbb?lb:[this.C8.kF(La)]}PF(La){return La.Mx}}Object(h.a)(Tg,"ShapeViewCropUpdateStrategyHandler",null,[608,609]);var rd=d(277);class ze{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PictureCrop"}Wb(La){this.K=La;this.K.register(488,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>").ma().na(()=>new rd.a((lb,Nb)=>{let lc=null;const Rc=Object(ic.a)(121,
lb.oc(this.K.resolve("Box4.IPageView").Ma));Rc&&!Rc.ll&&(lc=new nf(lb,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IPageView").Fd,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),Nb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingSetPictureCropInfoCommandUsingMU,this.K.resolve("PowerPointWebEditor.IApplicationSettings").CAe,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Qad,this.K.resolve("PowerPointWebEditor.ITransformFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").dYd),lc.ym(Rc.xa),lc.setZIndex(3),lc.visible=!1,Rc.hM(lc.ie.xa,!0),Rc.Ypa(lc,3));return lc}));this.K.register(Ke,"PowerPointWebEditor.PictureCropActor").ma().na(()=>new Ke(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").WMj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").BAe,this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").dja,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Qad,this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),this.K.resolve("PowerPointWebEditor.IBusinessBarController")));this.K.register(Zf,
"PowerPointWebEditor.FormatPicturePaneActor").ma().na(()=>new Zf(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Jv))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.ICompositeShapeViewUpdateStrategy").addHandler(new Tg(this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").CAe,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Rad));this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new Wi(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView").Fd,this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IPictureCropShapeView>")));this.K.resolve("PowerPointWebEditor.PictureCropActor").ub();this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").ub();
this.K.resolve("PowerPointWebEditor.FormatPicturePaneActor").xe()}dispose(){}static main(){m.a.instance.Bc(Ph.a(new ze,0))}}Object(h.a)(ze,"PPTWebEditorPictureCropPackage",null,[2,3]);var xh=d(36),Qj=d(241);class ae{constructor(La,lb,Nb,lc,Rc){this.Mz=[xh.a.Ni,xh.a.font,dd.a.autonumberBulletType];this.Nb=La;this.Cl=lb;this.Hh=Nb;this.mbc=lc;this.VN=Rc}format(La){if(La&&La.$wb){La=this.Nb.Kc(La);for(var lb=this.Cl.n2(La,La.currentNode);lb.moveNext();){var Nb=lb.currentNode;if(Nb&&this.Hh.Vd(Nb)){const lc=
this.VN.PP(La,this.Hh.oeb(Nb));(Nb=this.mbc.YNc(Nb))&&Qj.d(lc,Nb,this.Mz)}}}}}Object(h.a)(ae,"BeautifyListFormatter",null,[580]);class nj{constructor(La,lb,Nb,lc,Rc){this.ia=La;this.ua=Nb;this.Fb=lb;this.Ea=lc;this.X0j=Rc}initialize(){this.ub()}ub(){this.ia.pa(Xd.a.zKd,P.a.application,Object(u.a)(this,this.zKd,"applyTextFormatterSuggestion"),4)}zKd(La,lb,Nb){if(1===Nb)return 32;La=this.ua.Ba;if(!La)return 16;lb=La.jl();if(!lb||!lb.length)return 16;lb=this.Ea.KZ(lb);if(!lb.length)return 16;Nb=this.Fb.ud(15);
Nb.kc(La);for(const lc of lb)this.X0j.format(lc);Nb.dispose();return 32}}Object(h.a)(nj,"TextFormatterActor",null,[]);class Xi{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatter"}Wb(La){this.K=La;La.register(580,"PowerPointWebEditor.IBeautifyListFormatter").ma().na(()=>new ae(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),
this.K.resolve("PowerPointWebEditor.IPptListEditor")));La.register(nj,"PowerPointWebEditor.TextFormatter.TextFormatterActor").ma().na(()=>new nj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.IBeautifyListFormatter")))}init(){const La=this.K.resolve("Common.IAppSettingsManager");La.ff(()=>
{La.ka("818")&&this.K.resolve("PowerPointWebEditor.TextFormatter.TextFormatterActor").initialize()})}dispose(){}static main(){m.a.instance.Bc(Ph.a(new Xi,0))}}Object(h.a)(Xi,"PPTWebEditorTextFormatterPackage",null,[2,3]);Type.registerNamespace("Box4.Symbols");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.PictureCrop");Type.registerNamespace("PowerPointWebEditor.TellMe");Type.registerNamespace("PowerPointWebEditor.TextFormatter");Ya.main();Type.registerNamespace("Common.App.O365Shell");
Db.main();Type.registerNamespace("Common.App.SessionExpiration");Type.registerNamespace("Common.App.SessionExpiration");Fb.main();Type.registerNamespace("Common.App.TellMe");Type.registerNamespace("Common.App.TellMe.CommandRanker.NaiveBayesModel");Type.registerNamespace("Common.App.TellMe.Suggestions.LRModel");ng.main();window.TellMeAdditionalControls={name:"CommandUI",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Animation",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",
attrs:{Id:"PptTellMe.Animation.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Animation.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Animation.Gallery",ElementDimensions:"Size64by48",Width:"3"},children:[{name:"GalleryButton",attrs:{Id:"Existing",Command:"0x11CFD1C3",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}},{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFadeIn",Alt:"STR@L_AnimationFadeIn"}},{name:"GalleryButton",
attrs:{Id:"FlyIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.AnimationNew",Command:"0x9F8ACB60",LabelText:"STR@L_AnimationTab"},children:[{name:"Menu",attrs:{Id:"AnimationGallery"},children:[{name:"MenuSection",attrs:{Id:"AnimationGalleryNone"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery1",ElementDimensions:"Size64by48",Width:"5"},
children:[{name:"GalleryButton",attrs:{Id:"ExistingInMenu",Command:"0x4B65244F",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingButtonDescription"}},{name:"GalleryButton",attrs:{Id:"None",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationNone",Alt:"STR@L_AnimationNone"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEntrance",Id:"AnimationGalleryEntrance"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery2",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Appear",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationAppear",Alt:"STR@L_AnimationAppear"}},{name:"GalleryButton",attrs:{Id:"FadeIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"FlyIn",Command:"0x9F8ACB60",
QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyIn",Alt:"STR@L_AnimationFlyIn"}},{name:"GalleryButton",attrs:{Id:"Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},
{name:"GalleryButton",attrs:{Id:"RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"GrowAndTurn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowAndTurn",Alt:"STR@L_AnimationGrowAndTurn"}},{name:"GalleryButton",attrs:{Id:"Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},{name:"GalleryButton",attrs:{Id:"Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},
{name:"GalleryButton",attrs:{Id:"Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Expand",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationExpand",Alt:"STR@L_AnimationExpand"}},{name:"GalleryButton",attrs:{Id:"PeekIn",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekIn",Alt:"STR@L_AnimationPeekIn"}},{name:"GalleryButton",attrs:{Id:"RiseUp",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRiseUp",Alt:"STR@L_AnimationRiseUp"}},{name:"GalleryButton",
attrs:{Id:"Stretch",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretch",Alt:"STR@L_AnimationStretch"}},{name:"GalleryButton",attrs:{Id:"Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationEmphasis",Id:"AnimationGalleryEmphasis"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery3",
ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Emphasis_Spin",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSpin",Alt:"STR@L_AnimationSpin"}},{name:"GalleryButton",attrs:{Id:"Emphasis_GrowShrink",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationGrowShrink",Alt:"STR@L_AnimationGrowShrink"}},{name:"GalleryButton",attrs:{Id:"Emphasis_Transparency",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationTransparency",Alt:"STR@L_AnimationTransparency"}},{name:"GalleryButton",attrs:{Id:"Emphasis_LineColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationLineColor",Alt:"STR@L_AnimationLineColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FillColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",
LabelText:"STR@L_AnimationFillColor",Alt:"STR@L_AnimationFillColor"}},{name:"GalleryButton",attrs:{Id:"Emphasis_FontColor",Command:"0xA1B5DDD6",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFontColor",Alt:"STR@L_AnimationFontColor"}}]}]},{name:"MenuSection",attrs:{Title:"STR@L_AnimationExit",Id:"AnimationGalleryExit"},children:[{name:"Gallery",attrs:{Id:"AnimationGallery4",ElementDimensions:"Size64by48",Width:"5"},children:[{name:"GalleryButton",attrs:{Id:"Exit_Disappear",
Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationDisappear",Alt:"STR@L_AnimationDisappear"}},{name:"GalleryButton",attrs:{Id:"Exit_Fade",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFade",Alt:"STR@L_AnimationFade"}},{name:"GalleryButton",attrs:{Id:"Exit_FlyOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationFlyOut",
Alt:"STR@L_AnimationFlyOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Split",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationSplit",Alt:"STR@L_AnimationSplit"}},{name:"GalleryButton",attrs:{Id:"Exit_Wipe",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationWipe",Alt:"STR@L_AnimationWipe"}},{name:"GalleryButton",attrs:{Id:"Exit_RandomBars",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",
InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationRandomBars",Alt:"STR@L_AnimationRandomBars"}},{name:"GalleryButton",attrs:{Id:"Exit_Zoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationZoom",Alt:"STR@L_AnimationZoom"}},{name:"GalleryButton",attrs:{Id:"Exit_BasicZoom",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBasicZoom",Alt:"STR@L_AnimationBasicZoom"}},
{name:"GalleryButton",attrs:{Id:"Exit_Blinds",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBlinds",Alt:"STR@L_AnimationBlinds"}},{name:"GalleryButton",attrs:{Id:"Exit_Box",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationBox",Alt:"STR@L_AnimationBox"}},{name:"GalleryButton",attrs:{Id:"Exit_Checkerboard",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",
ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationCheckerboard",Alt:"STR@L_AnimationCheckerboard"}},{name:"GalleryButton",attrs:{Id:"Exit_PeekOut",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationPeekOut",Alt:"STR@L_AnimationPeekOut"}},{name:"GalleryButton",attrs:{Id:"Exit_Stretchy",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStretchy",Alt:"STR@L_AnimationStretchy"}},
{name:"GalleryButton",attrs:{Id:"Exit_Strips",Command:"0x9F8ACB60",QueryCommand:"0x6E71FDE6",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_AnimationStrips",Alt:"STR@L_AnimationStrips"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.Transition",Command:"0x78ACF6A1",LabelText:"STR@L_TransitionTab"},children:[{name:"Menu",attrs:{Id:"PptTellMe.Transition.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptTellMe.Transition.MenuSection",DisplayMode:"Thin"},children:[{name:"Gallery",attrs:{Id:"PptTellMe.Transition.Gallery",
ElementDimensions:"Size64by48",Width:"2"},children:[{name:"GalleryButton",attrs:{Id:"TransitionExisting",Command:"0xDFACB0EC",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",Alt:"STR@L_ExistingTransitionButtonDescription"}},{name:"GalleryButton",attrs:{Id:"TransitionNone",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionNone",Alt:"STR@L_TransitionNone"}},{name:"GalleryButton",attrs:{Id:"TransitionFade",Command:"0x78ACF6A1",
QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionFade",Alt:"STR@L_TransitionFade"}},{name:"GalleryButton",attrs:{Id:"TransitionPush",Command:"0x78ACF6A1",QueryCommand:"0x08E3C66D",InnerHTML:"",ElementDimensions:"Size64by48",LabelText:"STR@L_TransitionPush",Alt:"STR@L_TransitionPush"}}]}]}]}]},{name:"Button",attrs:{Id:"PptTellMe.Designer",Command:"0x9531543E",LabelText:"STR@L_ShowHideDesignerPane"}},{name:"Button",attrs:{Id:"PptTellMe.Ideas",Command:"0x76FF601A",
Image16by16:"IMGMAP@per@LightningIdeasHandraiseState_16x16x32",LabelText:"STR@L_IdeasButtonHomeRibbon"}},{name:"Button",attrs:{Id:"PptTellMe.SelectAll",Command:"0x148D0534",Image16by16:"IMGMAP@per@SelectAll_16x16x32",LabelText:"STR@L_SelectAllButton"}},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.GroupShapesUpSellButton",LabelText:"STR@L_GroupShapesUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTGroupShapes",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButton",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",
LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTWordArt",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",
Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButton",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",
Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButton",LabelText:"STR@L_InsertAudioUpSell",
Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",
DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertAudio",LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButton",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",
DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]},{name:"MenuSection",attrs:{Id:"UpSellInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"Menu48"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnTryOfficeThroughTellMeForPPTInsertChart",
LabelText:"STR@L_DesktopUpSellTitle",Description:"STR@L_DesktopUpSellDescription",Image48by48:"IMGMAP@prt2@TryOffice_48x48x32",Command:"0x0CDCFF89"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.WordArtUpSellButtonEnterprise",LabelText:"STR@L_WordArtUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.SpellCheckDictUpSellButtonEnterprise",LabelText:"STR@L_SpellCheckDictUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},children:[{name:"Controls",
attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertAudioUpSellButtonEnterprise",LabelText:"STR@L_InsertAudioUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",Title:"STR@L_DesktopFeature"},
children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptTellMe.InsertChartUpSellButtonEnterprise",LabelText:"STR@L_InsertChartUpSell",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuUpSell"},children:[{name:"MenuSection",attrs:{Id:"OpenInClientMenuSection",DisplayMode:"Menu48",
Title:"STR@L_DesktopFeature"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"UpSellOpenInClient",LabelText:"STR@L_OpenInDesktopWord",Description:"STR@L_OpenInDesktopDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A"}}]}]}]}]}]};ze.main();Xi.main();Type.registerNamespace("NLRT")},139:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(216);class e{constructor(m,r){this.VLa=!1;const {Annotations:v}=d(76);if(!m)throw Error.argumentNull("annotations");
if(!m.Zce(r))throw Error.argument("memberTypeID","Invalid type ID");if(v.tB(r))throw Error.argument("memberTypeID","Lists of lists are not permitted");this.vr=m;this.DSh=r;this.zB=[]}get Aob(){return this.vr}get isReadOnly(){return this.VLa}get WT(){return this.DSh}get items(){return this.zB}a1(){const {Annotations:m}=d(76);let r="[";for(let v=0,A=this.items.length;v<A;++v){0<v&&(r+=", ");const w=this.vr.a1(this.WT,this.items[v]);this.WT===m.tY?(r+='"',r+=h.a.ZVd(w),r+='"'):r+=w}return r+"]"}isEqual(m){const {Annotations:r}=
d(76);if(this===m)return!0;if(!m||m.Aob!==this.vr||m.WT!==this.WT||m.items.length!==this.items.length)return!1;for(let v=0;v<this.items.length;++v)if(!r.k_a(this.WT,this.items[v],m.items[v]))return!1;return!0}clone(){const m=new e(this.vr,this.WT);Array.addRange(m.items,this.items);return m}sK(){return this.isReadOnly?this.clone():this}yee(){const {Annotations:m}=d(76);if(!this.isReadOnly){this.VLa=!0;for(const r of this.items)m.d$a(r)}}toString(){return this.a1()}}Object(J.a)(e,"ListValue",null,
[873,870])},146:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.tellMe="TellMe";h.contextMenu="ContextMenu";h.unknown="Unknown";Object(J.a)(h,"TellMeScenario",null,[])},158:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,r=null,v=null,A=4,w=-99999,y=0){this.jJd="";this.XBc=-1;this.value=e;this.type=m;this.subType=A;this.label=this.jJ=r;this.groupType=27;this.description=v;this.score=w;this.count=y}}Object(J.a)(h,"ResultBinding",null,[])},175:function(J,
V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.attributes=null;this.query=e;this.Ck=[]}Is(e){this.Ck.push(e)}Feh(e){const m=[];for(const r of this.Ck)r.groupType!==e&&m.push(r);this.Ck.length!==m.length&&(this.Ck=m)}get vwb(){return!1}}Object(J.a)(h,"SimpleResultsUpdatedEventArgs",null,[667])},176:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e=27,m=""){this.$Vh=[];this.groupType=e;this.displayName=m}get results(){return this.$Vh}Qv(e){e.groupType=
this.groupType;Array.add(this.results,e)}TFe(e=1){if(this.results.length>=e)for(let m=0;m<e;m++)Array.removeAt(this.results,this.results.length-1)}}Object(J.a)(h,"SimpleResultGroup",null,[668])},216:function(J,V,d){J=d(0);class h{constructor(m,r){this.VNa=m;this.value=r}}Object(J.a)(h,"AttrValuePair",null,[]);d.d(V,"a",function(){return e});class e{constructor(m){this.VLa=!1;if(!m)throw Error.argumentNull("annotations");this.vr=m;this.HN=[]}get Aob(){return this.vr}get isReadOnly(){return this.VLa}get N5d(){return 0<
this.HN.length}Im(m){if(!this.vr.dxb(m))throw Error.argument("attributeID","Invalid attribute ID");for(const r of this.HN)if(m===r.VNa)return m=r.value,{returnValue:!0,value:m};return{returnValue:!1,value:null}}$t(m,r){var {Annotations:v}=d(76);if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only FeatureBundle");if(!this.vr.dxb(m))throw Error.argument("attributeID","Invalid attribute ID");if(!this.vr.dwb(this.vr.getAttributeType(m),r))throw Error.argument("value",
"Value is not of the correct type for the specified attribute");v.d$a(r);for(v=0;v<this.HN.length;++v){const A=this.HN[v];if(m===A.VNa){A.value=r;return}}Array.add(this.HN,new h(m,r))}zed(m){if(this.isReadOnly)throw Error.invalidOperation("Attempt to remove annotation from read-only FeatureBundle");if(!this.vr.dxb(m))throw Error.argument("attributeID","Invalid attribute ID");for(let r=0;r<this.HN.length;++r)if(m===this.HN[r].VNa){Array.removeAt(this.HN,r);break}}rLc(m){if(!m)throw Error.argumentNull("action");
for(const r of this.HN)m(r.VNa,r.value)}clone(){const m=new e(this.vr);m.gBa(this);return m}gBa(m){if(this.isReadOnly)throw Error.invalidOperation("Attempt to copy annotations onto read-only FeatureBundle");if(!m)throw Error.argumentNull("other");if(m.Aob!==this.vr)throw Error.argument("other","Incompatible feature bundle");Array.clear(this.HN);m.rLc((r,v)=>{this.$t(r,v)})}a1(){const {Annotations:m}=d(76);let r="[",v=!0;for(const A of this.HN){v?v=!1:r+=", ";r+=this.vr.S8f(A.VNa);r+="=";const w=this.vr.getAttributeType(A.VNa),
y=this.vr.a1(w,A.value);w===m.tY?(r+='"',r+=e.ZVd(y),r+='"'):r+=y}return r+"]"}isEqual(m){const {Annotations:r}=d(76);if(!m)throw Error.argumentNull("other");if(this===m)return!0;if(!m||this.vr!==m.Aob||this.N5d!==m.N5d)return!1;let v=0,A=null,w=!1;m.rLc((y,u)=>{++v;if(!w){var D=-1;for(let F=0,I=this.HN.length;F<I;++F)if(this.HN[F].VNa===y){D=F;break}0>D?w=!0:(A||(A=Array(this.HN.length)),A[D]=u)}});if(this.HN.length!==v||w)return!1;for(let y=0,u=this.HN.length;y<u;++y)if(!r.k_a(this.vr.getAttributeType(this.HN[y].VNa),
this.HN[y].value,A[y]))return!1;return!0}sK(){return this.isReadOnly?this.clone():this}yee(){const {Annotations:m}=d(76);if(!this.isReadOnly){this.VLa=!0;for(const r of this.HN)m.d$a(r.value)}}toString(){return this.a1()}static ZVd(m){return m.replace("\\","\\\\").replace("[","\\[").replace("]","\\]").replace(",","\\,")}}Object(J.a)(e,"FeatureBundle",null,[869,870])},261:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.click="Click";h.tvb="InteractionBegin";h.psg="InteractionEnd";
h.MSf="ControlActivated";h.query="Query";h.s$g="QueryIndexRecorded";h.cRf="Clicks";h.oCf="ActionEvents";h.R4f="FilteredActionEvents";h.bmh="SessionContext";h.latency="Latency";h.performance="Performance";h.ugh="RenderedResults";h.events="Events";h.jCi="CreateResultsMenu";h.VF="UpdateRibbonControls";h.hXk="ResultsAggregation";h.HD="IssueQuery";h.Dri="CommandSuggestions";h.error="Error";h.oee="LoadModelData";h.SGi="DepsResolveTime";h.Cfk="ModelDataWaitTime";h.timedOut="TimedOut";h.O8h="AddinQueryCommandReady";
h.EZi="GetAddinEntitlements";h.c$g="ProviderMRUEvents";h.tMi="EnableAddinSearchCommands";Object(J.a)(h,"EventNames",null,[])},278:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.xqe=null;this.Vy=this.gse=0}JLc(e,m,r){if(!e)throw Error.argumentNull("referenceList");if(0>m||m>e.length)throw Error.argumentOutOfRange("startIndex");if(0>r||r>e.length)throw Error.argumentOutOfRange("length");if(m+r>e.length)throw Error.argument("Invalid start-length range");this.xqe=e;
this.gse=m;this.Vy=r}qQa(e,m,r){this.JLc(e.xqe,e.gse+m,r)}ga(e){if(0>e||e>=this.Vy)throw Error.argumentOutOfRange("index");return this.xqe[this.gse+e]}get count(){return this.Vy}static ARd(e){const m=new h;m.JLc(e,0,e.length);return m}}Object(J.a)(h,"ReadOnlyList",null,[904])},301:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.Classifier=0]="Classifier";e[e.AppsForOffice=1]="AppsForOffice";e[e.FindInDocument=2]="FindInDocument";e[e.FindInDocumentScopedSearch=3]="FindInDocumentScopedSearch";
e[e.RecentlyUsed=4]="RecentlyUsed";e[e.TryQuery=5]="TryQuery";e[e.Empty=6]="Empty";e[e.TryCommand=7]="TryCommand";e[e.Assistance=8]="Assistance";e[e.Answer=9]="Answer";e[e.Definition=10]="Definition";e[e.Entity=11]="Entity";e[e.WolframAnswer=12]="WolframAnswer";e[e.Insights=13]="Insights";e[e.People=14]="People";e[e.Document=15]="Document";e[e.Recommended=16]="Recommended";e[e.ServiceClassifier=17]="ServiceClassifier";e[e.ServiceRecommended=18]="ServiceRecommended";e[e.Image=19]="Image";e[e.Notes=
20]="Notes";e[e.Learning=21]="Learning";e[e.Feedback=22]="Feedback";e[e.Template=23]="Template";e[e.Addin=24]="Addin";e[e.OfficeScript=25]="OfficeScript";e[e.AddinStoreEntry=26]="AddinStoreEntry";e[e.None=27]="None";e[e.MergedActions=28]="MergedActions";e[e.MergedScopedSearches=29]="MergedScopedSearches";e[e.MergedSuggestedSearches=30]="MergedSuggestedSearches"})(h||(h={}));Object(J.b)("ResultGroupType",h)},325:function(J,V,d){d.r(V);d.d(V,"CommandResultsUtility",function(){return u});J=d(0);var h=
d(372),e=d(261),m=d(373),r=d(158),v=d(176),A=d(118),w=d(105),y=d(25);class u{static wKb(D,F){if(F&&F.Do){const I={};for(const H of D)F.fWc(H)&&(I[H]=appChrome.selectors.getModelType(H));A.TellMeActor.instance.VF(I)}}static lnl(D){return D.startsWith("btnTellMeOfficeAddIn")}static E4b(D){const F=A.TellMeActor.instance.xG();return!!F&&F.Do&&!appChrome.selectors.isControlDisabled(D)}static zXc(D,F,I,H){if(A.TellMeActor.instance.Cd&&D){const L=[];for(const E of D)L.push(String.format('{{"Id":"{0}","Score":{1}}}',
E.commandId,E.score));D={};D[h.a.suggestions]="[{"+L.join(",")+"}]";D[h.a.NAg]=F;D[h.a.groupType]=I;D[h.a.provider]=H;A.TellMeActor.instance.Cd.iH(e.a.Dri,window.performance.now(),D)}}static w2i(D,F){const I=[],H=[];for(const L of F){F=L.commandId;let E=L;L.commandId in D&&(F=D[L.commandId],E=new m.a(F,L.score));Array.contains(H,F)||(I.push(E),H.push(F))}return I}static KOc(D,F,I,H,L,E,aa,Q){I.q_d&&(F=u.w2i(I.q_d,F));var O=w.a.D1i(F);u.wKb(O,I);var T=[],K=[];O=[];const X=new v.a(aa);aa=16===aa||18===
aa||7===aa||4===aa?y.AFrameworkApplication.fa?y.AFrameworkApplication.fa.Cc("TellMeMaxRecommendedResultsToReturn",3):3:0===aa||17===aa?5:0;for(const P of F)if(!u.DGj(P.commandId)){F=u.lnl(P.commandId);if(I.fWc(P.commandId)&&!F){if(w.a.Vzg(P.commandId))continue;F=null;L&&E&&(F=L.Jaj(P.commandId,E));u.E4b(P.commandId)?Array.add(T,new r.a(P.commandId,5,F,null,Q,P.score)):Array.add(K,new r.a(P.commandId,5,F,null,Q,P.score))}else I.K3a&&F&&H&&Array.add(O,P.commandId.substr(21));if(T.length+O.length>=aa)break}I=
0;for(L=0;L<T.length&&I<aa;L++,I++)X.Qv(T[L]);for(T=0;T<K.length&&I<aa;T++,I++)X.Qv(K[T]);for(K=0;K<O.length&&I<aa;K++,I++)H.$Gl(D,O[K],X);return X}static DGj(D){u.mKf||(y.AFrameworkApplication.fa&&y.AFrameworkApplication.fa.Kw("TellMeControlPredictionBlockList")&&y.AFrameworkApplication.fa.XB("TellMeControlPredictionBlockList").forEach(F=>{Array.add(u.lKf,F.toLowerCase())}),u.mKf=!0);return Array.contains(u.lKf,D.toLowerCase())}static m$d(D){return 2<D.length&&";"===D.charAt(0)&&";"===D.charAt(D.length-
1)&&!!y.AFrameworkApplication.fa&&(y.AFrameworkApplication.fa.ka("TellMeCommandHookIsEnabled")||y.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeCommandHookIsEnabled",!1))}static h$f(D){const F=new v.a(0);var I=D.split(";");D=A.TellMeActor.instance.xG();for(const H of I)if(0<H.length){I=H.split(":");const L=2===I.length?I[0]:H;if(!D.fWc(L))break;if(1===I.length)I=new r.a(L,5,null,null,1),F.Qv(I);else if(2===I.length)I=new r.a(L,5,I[1],null,1),F.Qv(I);else break}return F}static d2h(D,
F,I){if(!(F&&F.results&&D&&D.results&&D.results.length))return{returnValue:!1,KHd:D,gId:F};const H=[];for(var L of F.results)Array.add(H,L.value);L=0;const E=0<F.results.length?F.results[0].score:0;for(const aa of D.results)if(aa.score>I&&!Array.contains(H,aa.value)&&u.E4b(aa.value)&&(0<E&&(aa.score=E),Array.insert(F.results,L,aa),L++),2===L)break;return 0<L?(I=F.results.length-5,0<I&&F.TFe(I),{returnValue:!0,KHd:D,gId:F}):{returnValue:!1,KHd:D,gId:F}}}u.mKf=!1;u.lKf=[];Object(J.a)(u,"CommandResultsUtility",
null,[])},372:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.appName="AppName";h.A4a="CloseAllMenus";h.commandId="CommandId";h.context="Context";h.culture="Culture";h.message="Message";h.errorMessage="ErrorMessage";h.event="Event";h.W7="CorrelationID";h.bvk="ParentUiElement";h.query="Input";h.afb="QueryID";h.B$g="QueryLength";h.gFb="QueryIndex";h.iXk="ResultsList";h.suggestions="Suggestions";h.scenario="Scenario";h.sessionId="SessionID";h.source="Source";h.timeStamp="Time";h.CBh=
"UiElement";h.Sdd="ReactUx";h.value="Val";h.statusCode="StatusCode";h.T1k="Service";h.isSuccess="IsSuccess";h.cpl="TokenAcquired";h.YTj="LatencyType";h.groupName="GroupName";h.P7a="GroupIndex";h.groupType="GroupType";h.dXk="ResultInfoList";h.resultType="ResultType";h.sQe="SubResultType";h.XJj="IsInputBlur";h.YJj="IsInputFocus";h.EPj="IsShortCutUsed";h.actionType="ActionType";h.count="Count";h.rLi="DwellTime";h.NAg="IsZeroTerm";h.yDl="WordsCount";h.sVc="IsSearchUxEnabled";h.VQj="IsTellMeInHeaderEnabled";
h.module="Module";h.resultIndex="ResultIndex";h.bUd="DisplayIndex";h.CMi="EnableList";h.provider="Provider";h.contentType="ContentType";h.hPj="IsSelectionBased";h.Odi="BeginPerformanceMarker";h.ZMi="EndPerformanceMarker";h.exk="PerformanceMeasure";Object(J.a)(h,"Columns",null,[])},373:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.commandId=e;this.score=m}}Object(J.a)(h,"CommandSuggestion",null,[])},436:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{static woc(e){if(!e)return"{NULL}";
const m=e.length;return 600>=m?e:e.substring(0,400)+"[...]"+e.substring(m-195,m)}}Object(J.a)(h,"LogUtils",null,[])},437:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"SmartLookupSelection",null,[])},438:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(25);class e{constructor(){this.currentDocumentPath=h.AFrameworkApplication.fa.Ga("EditDocInClientUrl")}}Object(J.a)(e,"SmartLookupApplicationInterface",null,[])},439:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{}h.tellMe="TellMe";h.loki="Loki";h.substrate="Substrate";h.gFb="QueryIndex";h.Mxh="TellMeRanker";h.Nxh="TellMeRankerLogging";Object(J.a)(h,"Services",null,[])},440:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.xsa="HttpRequest";h.provider="Provider";Object(J.a)(h,"LatencyTypes",null,[])},441:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.data=this.landingTab=null}}Object(J.a)(h,"LaunchData",null,[])},538:function(J,V,d){J=d(0);
class h{constructor(){this.ioc=this.U3b=null;this.$te=this.score=this.mdc=0}Oze(I,H,L){this.score=I.ga(H);++H;this.U3b=I.ga(H)?L.G7(I.ga(H)):null;++H;this.ioc=I.ga(H)?L.G7(I.ga(H)):null;++H;this.mdc=I.ga(H);++H;this.$te=I.ga(H);++H;return H}}Object(J.a)(h,"TokenStringGeneratorInit",null,[]);class e{constructor(I,H,L,E,aa){this.jQa=I;this.count=H;this.aLc=L;this.uG=E;this.depth=aa}}Object(J.a)(e,"ErrorTolerantTrieMatch",null,[]);var m=d(689),r=d(954);class v{constructor(I=null,H=0,L=0,E=0){this.uZh=
I||new r.a;this.Wba=H;this.uG=L;this.depth=E}get JU(){return this.uZh}getKey(){return this.JU.Ps.toString()+":"+this.Wba.toString()}}Object(J.a)(v,"TrieBookmark",null,[]);class A{constructor(I,H){this.qva=I;this.Foe=H}R_j(I){if(null==I)throw Error.argumentNull("prefix");let H={};var L=H[""]=new v;this.wRc(L,H);for(L=0;L<I.length;++L){const E=I.charCodeAt(L),aa={};for(let Q in H)this.H9h(E,H[Q],aa);H=aa}return this.kql(H)}wRc(I,H){if(!(I.uG>=this.Foe)&&(I=new v(m.a.NOd(I.JU),I.Wba,I.uG+1,I.depth),
I.JU.rz&m.a.GKa&&(I.Wba+=1),this.qva.Fib(I.JU))){I.depth+=1;let L=!0;for(;L;)A.Vnd(I,H),this.wRc(I,H),I.Wba+=this.qva.etb(I.JU,!0)+(I.JU.rz&m.a.GKa?1:0),L=this.qva.roc(I.JU)}}H9h(I,H,L){H.uG+1<=this.Foe&&(H.uG+=1,A.Vnd(H,L),--H.uG);H.JU.rz&m.a.GKa&&(H.Wba+=1);if(this.qva.Fib(H.JU)){H.depth+=1;let E=!0;for(;E;)H.JU.gjb===I?(A.Vnd(H,L),this.wRc(H,L)):H.uG+1<=this.Foe&&(H.uG+=1,A.Vnd(H,L),this.wRc(H,L),--H.uG),H.Wba+=this.qva.etb(H.JU,!0)+(H.JU.rz&m.a.GKa?1:0),E=this.qva.roc(H.JU)}}kql(I){const H=[];
for(var L in I){const E=I[L];if(!E.JU.Ps)continue;const aa=!!(E.JU.rz&m.a.GKa),Q=this.qva.etb(E.JU,!1)+(aa?1:0);Array.add(H,new e(E.Wba,Q,aa,E.uG,E.depth))}H.sort((E,aa)=>{let Q=E.jQa-aa.jQa;return Q||(Q=-(E.count-aa.count))?Q:Q=E.depth-aa.depth});if(2>H.length)return H;I=[];for(L=0;L<H.length;)L+=A.uzh(L,H,I);return I}static Vnd(I,H){const L=I.getKey();L in H?(H=H[L],H.uG=Math.min(H.uG,I.uG)):H[L]=new v(m.a.NOd(I.JU),I.Wba,I.uG,I.depth)}static uzh(I,H,L){const E=H[I];let aa=E.jQa;const Q=aa+E.count;
let O=1,T=E.aLc;for(;I+O<H.length&&H[I+O].jQa<Q;){const K=H[I+O];K.jQa>aa&&(Array.add(L,new e(aa,K.jQa-aa,T,E.uG,E.depth)),T=!1);O+=A.uzh(I+O,H,L);aa=K.jQa+K.count}aa<Q&&Array.add(L,new e(aa,Q-aa,T,E.uG,E.depth));return O}}Object(J.a)(A,"ErrorTolerantTrieLookupEngine",null,[993]);class w extends h{constructor(I,H,L){super();this.Vng=this.I3g=!1;this.p2f=null;if(I){var E=0;try{E=this.Oze(I,E,H);this.I3g=1===I.ga(E);++E;this.Vng=1===I.ga(E);++E;const aa=I.ga(E);this.p2f=this.rvk(L,aa)}catch(aa){throw Error.argument("initData");
}}}rvk(I,H){return new A(I,H)}}Object(J.a)(w,"FuzzyMatchTokenStringGeneratorInit",h,[]);class y extends h{constructor(I,H){super();this.query=this.name=null;if(I){this.annotations=H.annotations;var L=0;try{L=this.Oze(I,L,H),this.name=H.aC(I.ga(L)),++L,this.query=H.vD(I.ga(L))}catch(E){throw Error.argument("initData");}}}}Object(J.a)(y,"QueryTokenStringGeneratorInit",h,[]);class u extends h{constructor(I,H){super();if(I)try{this.Oze(I,0,H)}catch(L){throw Error.argument("initData");}}}Object(J.a)(u,
"SurfaceStringTokenStringGeneratorInit",h,[]);var D=d(278);d.d(V,"a",function(){return F});class F{constructor(I){this.jge=I}get U3b(){return this.jge.U3b}get ioc(){return this.jge.ioc}get mdc(){return this.jge.mdc}static create(I,H,L){const {SurfaceStringTokenStringGenerator:E}=d(1098),{QueryTokenStringGenerator:aa}=d(1099),{FuzzyMatchTokenStringGenerator:Q}=d(1100);let O=0;try{if(I.ga(O)!==F.b4a)throw Error.argument("initData","Input does not represent a token string generator");++O;const T=I.ga(O);
++O;const K=new D.a;K.qQa(I,O,I.count-O);switch(T){case E.xVb:return new E(new u(K,H));case aa.xVb:return new aa(new y(K,H));case Q.xVb:return new Q(new w(K,H,L));default:throw Error.argument("initData");}}catch(T){throw Error.argument("initData");}}static xEf(I,H,L,E,aa,Q){I=I.jpl.getId(H,null);if(0>I)return++Q,Q;F.yEf(I,L,E,aa);return Q}static yEf(I,H,L,E){Array.add(E.ZPe,I);Array.add(E.Bvh,H);++E.QJb[L]}}F.b4a=1099767983;Object(J.a)(F,"TokenStringGenerator",null,[973])},678:function(J,V,d){d.d(V,
"a",function(){return e});J=d(0);var h=d(105);d=d(25);class e{static WQj(){return!h.a.awg()&&!h.a.D9a()&&e.isFeatureEnabled(0)}static tzg(){return e.isFeatureEnabled(1)}static Xwg(){return e.isFeatureEnabled(2)}static isFeatureEnabled(m){return!!(e.ENh&1<<m)}}e.ENh=d.AFrameworkApplication.fa?d.AFrameworkApplication.fa.Cc("TellMeFeatureConfigValue",0):0;Object(J.a)(e,"TellMeFeatureAvailability",null,[])},679:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(158);class h extends d.a{constructor(e,
m,r,v,A=null){super(e,m,A,null,r);this.id=v}}Object(J.a)(h,"TryQueryResultBinding",d.a,[])},680:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.Ia=e}get pHa(){return this.Ia.pHa}get Ekl(){return 4!==this.Ia.style}get Hkl(){return!0}get trie(){return this.Ia.trie}getId(e,m){if(!this.Ekl)throw Error.invalidOperation("ID lookup not supported on this string table");switch(this.Ia.style){case 0:return this.T6i(e,m);default:throw Error.notImplemented();}}aC(e){if(!this.Hkl)throw Error.invalidOperation("String lookup not supported on this string table");
if(0>e||e>=this.pHa)throw Error.argumentOutOfRange("id","Invalid string ID");switch(this.Ia.style){case 0:return this.pgj(e);case 4:return this.ogj(e);default:throw Error.notImplemented();}}T6i(e,m){e=this.Ia.trie.eEg(e,0,e.length,m);if(!e.succeeded)return-1;if(0>e.ZJb||e.ZJb>=this.Ia.pHa)throw Error.invalidOperation("Trie with invalid trie ID in StringTable");return this.Ia.soc?this.Ia.Pic.Zt(this.Ia.soc+4*e.ZJb,4):e.ZJb}pgj(e){if(this.Ia.soc){let m=0;for(;m<this.Ia.pHa&&this.Ia.Pic.Zt(this.Ia.soc+
4*m,4)!==e;++m);if(m>=this.Ia.pHa)throw Error.invalidOperation("Malformed TrieId2StringTableId in StringTable");return this.Ia.trie.sgg(m)}return this.Ia.trie.sgg(e)}ogj(e){const m=this.Ia.Pic.Zt(this.Ia.zvh+4*e,4);e=this.Ia.Pic.Zt(this.Ia.Avh+4*e,4);if(0>e||0>m)throw Error.invalidOperation("Hash table string invalid byte range in StringTable");const r=Array(m);for(let v=0;v<m;++v)r[v]=({Evj:e}=this.WJk(e)).returnValue;return String.fromCharCode.apply(null,r)}WJk(e){let m=0;for(let r=0;3>r;++r){const v=
this.Ia.Pic.ga(this.Ia.EOf+e)^182;++e;m|=(v&127)<<7*r;if(!(v&128))break}return{returnValue:m,Evj:e}}}Object(J.a)(h,"StringTable",null,[905])},681:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(689);class e{constructor(m){this.trie=null;this.EOf=this.zvh=this.Avh=this.soc=0;if(m){this.Pic=m;var r=0;if(m.Zt(r,4)!==e.b4a)throw Error.argument("bytes","Input does not represent a string table");r+=4;this.pHa=m.Zt(r,4);r+=4;this.style=m.Zt(r,4);r+=4;switch(this.style){case 0:const v=1===
m.Zt(r,4);r+=4;v||(this.soc=r,r+=4*this.pHa);m.Zt(r,4);this.trie=this.Tvk(m,r+4);break;case 4:this.Avh=r;this.zvh=r+=4*this.pHa;r+=4*this.pHa;m.Zt(r,4);this.EOf=r+4;break;default:throw Error.argument("bytes");}}}Tvk(m,r){return new h.a(m,r)}}e.b4a=1025118440;Object(J.a)(e,"StringTableInit",null,[])},689:function(J,V,d){J=d(0);class h{constructor(w){this.YWg=w;this.succeeded=!1;this.ZJb=w?w.ZJb:0;this.TQj=!1;this.length=this.yml=0}}Object(J.a)(h,"TrieResult",null,[]);class e{constructor(w,y,u){this.qo=
new h(null);this.W6j=w;this.T9b=y;this.wHg=y+u-1}get result(){return this.qo}kdg(){let w;return this.T9b<=this.wHg?(w=this.W6j.charAt(this.T9b),++this.T9b,{returnValue:!0,ch:w}):{returnValue:!1,ch:"\x00"}}AFe(w,y,u){w&&(this.qo.TQj=!0,this.qo.yml=y);this.qo.length=this.T9b;this.qo.succeeded=!0;this.qo.ZJb=u;this.T9b!==this.wHg+1&&(this.qo=new h(this.qo))}}Object(J.a)(e,"LookUpStringVisitor",null,[954]);var m=d(954);class r{constructor(){this.oOf=this.NLf=this.PLf=this.MLf=this.OLf=this.tMd=this.sMd=
this.vMd=this.rMd=0}}Object(J.a)(r,"TRIESTATS",null,[]);class v{constructor(){this.symbol=this.hec=0}}Object(J.a)(v,"TrieSymbol",null,[]);d.d(V,"a",function(){return A});class A{constructor(w,y){this.NT=null;this.m0c=this.VJg=this.TJg=this.XJg=this.PJg=this.WJg=this.UJg=this.YJg=this.QJg=0;this.hC=w;if(w.Zt(y,4)!==A.b4a)throw Error.argument("Input does not represent a trie");y+=4;this.VHg=1===w.Zt(y,4);y+=4;this.L2j=1===w.Zt(y,4);y+=4;this.v2j=w.Zt(y,4);y+=4;if(w.Zt(y,4)){w=y+4;this.NT=this.YJk(w);
this.QJg=y=w+A.kii;this.YJg=y+=A.vDc*(this.NT.rMd+(this.NT.rMd%2?1:0));this.UJg=y+=A.vDc*(this.NT.vMd+(this.NT.vMd%2?1:0));this.WJg=y+=A.vDc*(this.NT.sMd+(this.NT.sMd%2?1:0));this.PJg=y+=A.vDc*(this.NT.tMd+(this.NT.tMd%2?1:0));this.XJg=y+=A.zMd*this.NT.MLf;this.TJg=y+=A.AMd*this.NT.PLf;this.VJg=y+=A.AMd*this.NT.NLf;y+=A.AMd*this.NT.OLf;if(y!==w+this.NT.oOf)throw Error.argument("Corrupted trie binary");this.m0c=y}else this.NT=null}eEg(w,y,u,D){w=new e(w,y,u);this.$Fh(w,D);return w.result}sgg(w){if(this.VHg)if(w)--w;
else return"";if(!this.NT)throw Error.argument("Invalid trieID");const y=new m.a;y.rz=0;this.Fib(y);const u=[];for(;;){if(y.rz&A.GKa)if(w)--w;else return Array.add(u,y.gjb),String.fromCharCode.apply(null,u);const D=!!(y.rz&A.npd),F=this.etb(y,!0);if(D||w<F){if(Array.add(u,y.gjb),!this.Fib(y))throw Error.argument("Invalid trieID");}else if(w-=F,!this.roc(y))throw Error.argument("Invalid trieID");}}$Fh(w,y){let u=0;this.VHg&&(w.AFe(this.L2j,this.v2j,0),++u);if(this.NT){var D=new m.a;D.rz=0;if(this.Fib(D))for(;;){var F=
void 0;if(!({ch:F}=w.kdg()).returnValue)break;y&&(F=y(F));F=F.toString().charCodeAt(0);let I=!1;for(;!I;){const H=!!(D.rz&A.GKa);if(D.gjb===F){if(I=!0,H&&w.AFe(!!(D.rz&A.pXe),D.mld,u),!this.Fib(D))return}else if(u+=this.etb(D,!0),!this.roc(D))return;H&&++u}}}}Fib(w){if(!w.rz)return this.fTe(w),!0;if(!(w.rz&A.mpd))return!1;w.zsa=0;w.Ps=w.VRa;this.fTe(w);return!0}roc(w){if(w.rz&A.npd)return!1;this.fTe(w);return!0}etb(w,y){return w.rz&A.oXe?w.sDc:w.rz&A.mpd?!y&&w.rz&A.npd?this.C2i(w):1:0}C2i(w){w=A.NOd(w);
if(!this.Fib(w))return 0;let y=0;do w.rz&A.GKa&&++y,y+=this.etb(w,!1);while(this.roc(w));return y}fTe(w){w.rz||(w.zsa=0,w.Ps=this.m0c);var y=this.AHc(this.QJg,w.Ps),u=y.symbol;w.Ps+=y.hec;y=this.hC.Zt(this.PJg+A.zMd*u,A.zMd);w.gjb=y&65535;w.rz=y>>16;w.rz&A.oXe&&(w.sDc=this.sFi(w));w.rz&A.pXe&&(y=this.AHc(this.YJg,w.Ps),u=y.symbol,w.Ps+=y.hec,w.mld=this.hC.Zt(this.XJg+4*u,4));w.rz&A.hIh?(w.VRa=this.m0c+((this.hC.ga(w.Ps)<<8|this.hC.ga(w.Ps+1))<<8|this.hC.ga(w.Ps+2)),w.Ps+=3):w.rz&A.iIh?(w.VRa=w.Ps,
w.zsa=w.VRa):w.rz&A.jIh?(y=this.AHc(this.UJg,w.Ps),u=y.symbol,w.Ps+=y.hec,w.VRa=this.m0c+this.hC.Zt(this.TJg+4*u,4)):w.rz&A.mpd&&(y=this.AHc(this.WJg,w.Ps),u=y.symbol,w.Ps+=y.hec,w.zsa||(w.zsa=w.Ps),w.zsa+=this.hC.Zt(this.VJg+4*u,4),w.VRa=w.zsa)}AHc(w,y){const u=new v;let D=0;for(;;){D+=this.hC.ga(y);++y;++u.hec;const F=this.hC.Zt(w,2);if(D<F)break;u.symbol+=F;D-=F;w+=2;D<<=8}u.symbol+=D;return u}sFi(w){let y=this.hC.ga(w.Ps);192<=y?(y=(y&63)<<15|(this.hC.ga(w.Ps+1)&127)<<8,y|=this.hC.ga(w.Ps+2),
w.Ps+=3):128<=y?(y=(y&127)<<8|this.hC.ga(w.Ps+1),w.Ps+=2):w.Ps+=1;return y}YJk(w){const y=new r;y.rMd=this.hC.Zt(w+12,2);y.vMd=this.hC.Zt(w+14,2);y.sMd=this.hC.Zt(w+16,2);y.tMd=this.hC.Zt(w+18,2);y.OLf=this.hC.Zt(w+24,4);y.MLf=this.hC.Zt(w+28,4);y.PLf=this.hC.Zt(w+32,4);y.NLf=this.hC.Zt(w+36,4);y.oOf=this.hC.Zt(w+40,4);return y}static NOd(w){const y=new m.a;y.gjb=w.gjb;y.rz=w.rz;y.sDc=w.sDc;y.Ps=w.Ps;y.VRa=w.VRa;y.zsa=w.zsa;y.mld=w.mld;return y}}A.b4a=1654263084;A.kii=48;A.vDc=2;A.AMd=4;A.zMd=4;A.GKa=
1;A.npd=2;A.oXe=4;A.pXe=8;A.mpd=16;A.iIh=64;A.jIh=128;A.hIh=256;Object(J.a)(A,"Trie",null,[918])},692:function(J,V,d){d.r(V);J=d(0);d(146);var h=d(261);class e{}e.marketPlace=0;e.catalog=1;e.privateCatalog=10;Object(J.a)(e,"AppsForOfficeStoreType",null,[]);var m=d(118),r=d(25),v=d(78),A=d(35);class w{constructor(){this.yEd=0}bDe(E,aa){this.yEd=window.performance.now();this.l_a(()=>{const Q=window.performance.now(),O={},T=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinUseLocalStoreTypeClass",
!0);aa.PFf&&(O.callback=K=>{E(K,e.marketPlace,Q)},T&&(O.storeType=e.marketPlace),r.AFrameworkApplication.Ta.La(A.a.oXa,2,O));aa.QFf&&(O.callback=K=>{E(K,e.privateCatalog,Q)},T?O.storeType=e.privateCatalog:r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeFixOSFUndefinedBug",!0)?O.storeType=10:O.storeType=e.privateCatalog,r.AFrameworkApplication.Ta.La(A.a.oXa,2,O))},0,()=>{if(m.TellMeActor.instance.Cd)m.TellMeActor.instance.Cd.onError("AddinEntitlementsQuery:QueryEntitlementAsync",
"Query entitlements timeout after "+(window.performance.now()-this.yEd)+" ms")})}l_a(E,aa=0,Q=null){2!==r.AFrameworkApplication.Ta.processAction(A.a.oXa,1)?(m.TellMeActor.instance.Cd&&m.TellMeActor.instance.Cd.iH(h.a.O8h,window.performance.now()-this.yEd),E()):aa<w.jek?r.AFrameworkApplication.pe.Cb(new v.a(2,1,w.sCl,()=>{this.l_a(E,aa+1,Q)})):Q&&Q()}static get instance(){w.Ja||(w.Ja=new w);return w.Ja}}w.Ja=null;w.jek=20;w.sCl=500;Object(J.a)(w,"AddinEntitlementsQuery",null,[]);class y{constructor(){this.description=
this.id=this.displayName=null;this.targetType=0;this.assetStoreId=this.assetId=this.appVersion=null;this.height=this.width=0;this.sde=this.storeType=this.storeId=this.uEk=this.iconUrl=null}}Object(J.a)(y,"AddinInfo",null,[]);var u=d(158),D=d(176),F=d(175),I=d(105),H=d(72);d.d(V,"AddinResultsProvider",function(){return L});class L{constructor(E){this.oCd=[];this.vb=E;this.Amk=(aa,Q,O)=>{if(aa){const T=aa.errorCode;if(m.TellMeActor.instance.Cd){const K={};K.StoreType=Q;K.ErrorCode=T;K.AddinCount=aa.value?
aa.value.length:0;m.TellMeActor.instance.Cd.iH(h.a.EZi,window.performance.now()-O,K)}if(0===T&&aa.value){L.E3a=L.E3a||{};aa=aa.value;for(const K of aa)aa=new y,aa.displayName=K[0],aa.id=K[1],aa.description=K[2],aa.targetType=K[3],aa.appVersion=4<K.length?K[4]:"",aa.assetId=5<K.length?K[5]:"",aa.assetStoreId=6<K.length?K[6]:"",aa.width=7<K.length?K[7]:0,aa.height=8<K.length?K[8]:0,aa.iconUrl=9<K.length?K[9]:"",aa.uEk=10<K.length?K[10]:"",aa.storeId=11<K.length?K[11]:"",aa.storeType=12<K.length?K[12]:
"",this.vb.Mkh&&(aa.sde=this.R7i(aa)),L.E3a[aa.id]=aa,0<aa.iconUrl.length&&(Q="AddinIcon_"+aa.id,r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)?this.ydh(Q,aa.iconUrl):appChrome.addInApi.registerAddinIcon(Q,aa.iconUrl))}}};w.instance.bDe(this.Amk,this.vb)}BG(){return"Add-ins"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}HD(E,aa,Q,O,T=null){Q=new F.a(E);T&&!Array.contains(T,24)||I.a.pN(E)||(T=new D.a(24),T.displayName=CommonUIStrings.l_TellMeAddinProviderTitle,
this.z7i(E.Gf,T),Q.Is(T));aa.resultsUpdated(Q)}z7i(E,aa){if((E=this.F_k(E))&&0<E.length){let Q=0;E.forEach(O=>{if(!(3<++Q)){var T="AddinSuggestion"+Q,K={};if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinCheckAppChromeReady",!0)){var X="AddinIcon_"+O.id;0>Array.indexOf(this.oCd,X)&&0<O.iconUrl.length&&this.ydh(X,O.iconUrl);K["default"]=0<=Array.indexOf(this.oCd,X)?X:"AppForOfficeLogo_20"}else K["default"]=0<O.iconUrl.length?"AddinIcon_"+O.id:"AppForOfficeLogo_20";
X=[];X.push(appChrome.actions.setControlLabel(T,O.displayName));X.push(appChrome.actions.setControlIconSet(T,K));X.push(appChrome.actions.setCompoundButtonCommandValueId(T,O.id));X.push(appChrome.actions.updateCompoundButtonDescription(T,O.description));r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMeAddinSearchEnableCommands",!0)&&(K=window.performance.now(),X.push(appChrome.actions.updateControlEnabledDisabledState(T,!1)),m.TellMeActor.instance.Cd&&m.TellMeActor.instance.Cd.iH(h.a.tMi,
window.performance.now()-K));appChrome.api.dispatch(X);T=new u.a(T,25,void 0,void 0,1);T.jJd=Telemetry.PrivacyRules.GetPrivacyCompliantId(O.id,O.storeType,O.assetId,null,null,O.storeId);aa.Qv(T)}})}}ydh(E,aa){H.c()&&appChrome.addInApi.registerAddinIcon&&(appChrome.addInApi.registerAddinIcon(E,aa),Array.add(this.oCd,E))}F_k(E){if(!L.E3a)return null;const aa=[],Q=L.E3a;for(let T in Q){var O=Q[T];O&&(this.vb.Mkh?L.Bdk(E,O)&&Array.add(aa,O):0<=O.displayName.toLowerCase().indexOf(E.toLowerCase())?Array.add(aa,
O):this.vb.YOj&&0<=O.description.toLowerCase().indexOf(E.toLowerCase())&&Array.add(aa,O))}return aa}R7i(E){const aa=L.Euh(E.displayName);this.vb.P8h&&Array.addRange(aa,L.Euh(E.description));return aa}static Bdk(E,aa){if(!aa.sde)return!1;for(const Q of E.split(" ")){E=!1;for(const O of aa.sde)if(O.toLowerCase().startsWith(Q.toLowerCase())){E=!0;break}if(!E)return!1}return!0}static Euh(E){const aa=[];for(const Q of E.split(" ")){E=0;for(let O=0;O<Q.length;O++){const T=Q.charAt(O);T.toString().toUpperCase()===
T.toString()&&O>E&&(Array.add(aa,Q.substring(E,O)),E=O)}Array.add(aa,Q.substring(E,Q.length));E&&Array.add(aa,Q.substring(0,Q.length))}return aa}}L.E3a=null;Object(J.a)(L,"AddinResultsProvider",null,[693])},76:function(J,V,d){d.r(V);J=d(0);var h=d(22),e=d(216),m=d(139),r=d(680),v=d(681);class A{constructor(y,u){this.VLa=!1;this.F3=null;if(!y)throw Error.argumentNull("annotations");if(!y.exb(u))throw Error.argument("structTypeID","Invalid struct type ID");this.vr=y;this.eyb=this.vr.vdg(u);this.hYh=
u}get Aob(){return this.vr}get isReadOnly(){return this.VLa}get Bxa(){return this.hYh}LQa(y){if(0>y||y>=this.eyb)throw Error.argument("iField","Invalid field index");return this.F3&&null!=this.F3[y]?this.F3[y]:this.vr.tgg(this.Bxa,y)}EKe(y,u){if(this.isReadOnly)throw Error.invalidOperation("Attempt to set annotation on read-only StructValue");if(0>y||y>=this.eyb)throw Error.argument("iField","Invalid field index");if(!this.vr.dwb(this.vr.y7a(this.Bxa,y),u))throw Error.argument("value","Value is not of the correct type for the specified field");
(this.F3||(this.F3=Array(this.eyb)))[y]=u}a1(){const {Annotations:y}=d(76);let u="[";if(this.F3){let D=!0;for(let F=0;F<this.eyb;++F){if(null==this.F3[F])continue;const I=this.vr.y7a(this.Bxa,F);if(y.k_a(I,this.F3[F],this.vr.tgg(this.Bxa,F)))continue;D?D=!1:u+=", ";u+=this.vr.ugg(this.Bxa,F);u+="=";const H=this.vr.a1(I,this.F3[F]);I===y.tY?(u+='"',u+=e.a.ZVd(H),u+='"'):u+=H}}return u+"]"}isEqual(y){const {Annotations:u}=d(76);if(this===y)return!0;if(!y||this.vr!==y.Aob||this.Bxa!==y.Bxa)return!1;
for(let D=0;D<this.eyb;++D)if(!u.k_a(this.vr.y7a(this.Bxa,D),this.LQa(D),y.LQa(D)))return!1;return!0}clone(){const y=new A(this.vr,this.Bxa);this.F3&&(y.F3=Array.clone(this.F3));return y}sK(){return this.isReadOnly?this.clone():this}yee(){const {Annotations:y}=d(76);if(!this.isReadOnly&&(this.VLa=!0,this.F3))for(let u=0;u<this.eyb;++u){const D=this.F3[u];null!=D&&y.d$a(D)}}toString(){return this.a1()}}Object(J.a)(A,"StructValue",null,[874,870]);d.d(V,"Annotations",function(){return w});class w{constructor(y,
u){if(!y)throw Error.argumentNull("initData");if(!u)throw Error.argumentNull("objectFetcher");this.l2j=u.HKi;let D=0;var F=u.zQa(y.ga(D));++D;this.kse=new r.a(new v.a(F));this.mNh=y.ga(D);++D;this.AHg=Array(this.NJc);this.e9b=Array(this.NJc);this.fUa=Array(this.NJc);for(F=0;F<this.NJc;++F){this.AHg[F]=u.aC(y.ga(D));++D;this.e9b[F]=y.ga(D);++D;var I=y.ga(D);++D;this.fUa[F]=Array(I);for(var H=0;H<I;++H)this.fUa[F][H]=u.aC(y.ga(D)),++D}this.gYh=y.ga(D);++D;this.QRg=Array(this.Omc);this.k5c=Array(this.Omc);
this.l5c=Array(this.Omc);this.j5c=Array(this.Omc);for(F=0;F<this.Omc;++F)for(this.QRg[F]=u.aC(y.ga(D)),++D,I=y.ga(D),++D,this.k5c[F]=Array(I),this.l5c[F]=Array(I),this.j5c[F]=Array(I),H=0;H<I;++H)this.k5c[F][H]=u.aC(y.ga(D)),++D,this.l5c[F][H]=y.ga(D),++D,this.j5c[F][H]=({Z2:D}=this.Xqa(this.l5c[F][H],y,D,null,null,null)).returnValue,w.d$a(this.j5c[F][H]);this.OJh=y.ga(D);++D;this.$fe=Array(this.Xob);this.age=Array(this.Xob);this.Zfe=Array(this.Xob);for(F=0;F<this.Xob;++F)this.$fe[F]=u.aC(y.ga(D)),
++D,this.age[F]=y.ga(D),++D,this.Zfe[F]=({Z2:D}=this.Xqa(this.age[F],y,D,null,null,null)).returnValue,w.d$a(this.Zfe[F])}k0b(y){for(let u=0;u<this.Xob;++u)if(this.$fe[u]===y)return u;return-1}S8f(y){if(!this.dxb(y))throw Error.argument("attrID","Invalid attribute ID");return this.$fe[y]}getAttributeType(y){if(!this.dxb(y))throw Error.argument("attrID","Invalid attribute ID");return this.age[y]}y7a(y,u){if(!this.exb(y))throw Error.argument("structTypeID","Invalid struct type ID");y=this.l5c[w.Pmc(y)];
if(0>u||u>=y.length)throw Error.argument("iField","Invalid field index");return y[u]}a1(y,u){if(!this.Zce(y))throw Error.argument("typeID","Invalid type ID");if(!this.dwb(y,u))throw Error.argument("value","Value is not of the correct type");switch(y){case w.tY:return u;case w.Bfa:return u?"True":"False";case w.Mna:case w.O$:return u.toString();case w.kM:return u.a1();default:if(!w.tB(y)&&w.Hoc(y)){y=w.TVd(y);const I=this.fUa[y].length;switch(this.e9b[y]){case 0:return this.fUa[y][u];case 1:if(u){var D=
"";for(var F=1;F<I;++F)u&1<<F-1&&(0<D.length&&(D+=" & "),D+=this.fUa[y][F]);return D}return this.fUa[y][0];case 2:D="";for(F=0;F<I;++F)u&1<<F&&(0<D.length&&(D+=" & "),D+=this.fUa[y][F]);return D;default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.e9b[y]);}}else return u.a1()}}Zce(y){switch(y){case w.tY:case w.Bfa:case w.Mna:case w.O$:case w.kM:return!0;default:return w.tB(y)?this.Zce(w.ICa(y)):w.Hoc(y)?this.$Rj(y):this.exb(y)}}$Rj(y){y=w.TVd(y);return 0<=y&&y<this.AHg.length}exb(y){y=
w.Pmc(y);return 0<=y&&y<this.QRg.length}dxb(y){return 0<=y&&y<this.Xob}dwb(y,u){if(null==u)return!1;switch(y){case w.tY:return"string"===typeof u;case w.Bfa:return"boolean"===typeof u;case w.Mna:return"number"===typeof u;case w.O$:return"number"===typeof u;case w.kM:return Object(h.a)(869,u);default:if(w.tB(y))return Object(h.a)(873,u)&&u.WT===w.ICa(y);if(w.Hoc(y)){if("number"!==typeof u)return!1;y=w.TVd(y);const D=this.fUa[y].length;switch(this.e9b[y]){case 0:return 0<=u&&u<D;case 1:return!(u&-1<<
D-1);case 2:return!!u&&!(u&-1<<D);default:throw Error.invalidOperation("Unrecognized enum type flavor "+this.e9b[y]);}}else return Object(h.a)(874,u)&&u.Bxa===y}}get Xob(){return this.OJh}get NJc(){return this.mNh}get Omc(){return this.gYh}w_i(y){if(!this.dxb(y))throw Error.argument("attrID","Invalid attribute ID");return this.Zfe[y]}vdg(y){if(!this.exb(y))throw Error.argument("structTypeID","Invalid struct type ID");return this.k5c[w.Pmc(y)].length}ugg(y,u){if(!this.exb(y))throw Error.argument("structTypeID",
"Invalid struct type ID");return this.k5c[w.Pmc(y)][u]}tgg(y,u){if(!this.exb(y))throw Error.argument("structTypeID","Invalid struct type ID");y=this.j5c[w.Pmc(y)];if(0>u||u>=y.length)throw Error.argument("iField","Invalid field index");return y[u]}Xqa(y,u,D,F,I,H){if(!u)throw Error.argumentNull("initData");if(w.tB(y)){var L=u.ga(D);++D;y=w.ICa(y);var E=new m.a(this,y);for(var aa=0;aa<L;++aa)Array.add(E.items,({Z2:D}=this.Xqa(y,u,D,F,I,H)).returnValue);return{returnValue:E,Z2:D}}switch(y){case w.tY:return{returnValue:(F||
this.kse).aC(u.ga(D++)),Z2:D};case w.Bfa:return{returnValue:1===u.ga(D++),Z2:D};case w.Mna:return{returnValue:u.ga(D++),Z2:D};case w.O$:return{returnValue:(I||this.l2j)[u.ga(D++)],Z2:D};case w.kM:y=u.ga(D++);L=new e.a(this);for(E=0;E<y;++E)aa=u.ga(D),++D,H&&(aa=H[aa]),L.$t(aa,({Z2:D}=this.Xqa(this.getAttributeType(aa),u,D,F,I,H)).returnValue);return{returnValue:L,Z2:D};default:if(w.Hoc(y))return{returnValue:u.ga(D++),Z2:D};if(w.yBh(y)){L=u.ga(D++);E=new A(this,y);for(aa=0;aa<L;++aa){const Q=u.ga(D);
++D;E.EKe(Q,({Z2:D}=this.Xqa(this.y7a(y,Q),u,D,F,I,H)).returnValue)}return{returnValue:E,Z2:D}}throw Error.argument("typeID","Invalid type ID");}}static Hoc(y){return 16<=(y&16383)&&16384!==(y&16384)&&32768!==(y&32768)}static yBh(y){return 16<=(y&16383)&&16384===(y&16384)&&32768!==(y&32768)}static tB(y){return 32768===(y&32768)}static P8i(y){if(w.tB(y))throw Error.argument("nonListTypeID","Non-list type ID required");return y|32768}static ICa(y){if(!w.tB(y))throw Error.argument("listTypeID","List type ID required");
return y&-32769}static k_a(y,u,D){switch(y){case w.tY:case w.Bfa:case w.Mna:case w.O$:return u===D;case w.kM:return u.isEqual(D);default:return w.tB(y)?u.isEqual(D):w.Hoc(y)?u===D:u.isEqual(D)}}static d$a(y){Object(h.a)(870,y)&&y.yee()}static sK(y){return Object(h.a)(870,y)?y.sK():y}static TVd(y){return y-16}static Pmc(y){return(y&-16385)-16}}w.tY=1;w.Bfa=2;w.Mna=3;w.O$=5;w.kM=9;Object(J.a)(w,"Annotations",null,[875])},944:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.zwa=e}}Object(J.a)(h,"SessionRehydratedEventArgs",Sys.EventArgs,[])},945:function(J,V,d){d.r(V);d.d(V,"InsightsMenuItemFactory",function(){return r});J=d(0);var h=d(105),e=d(134),m=d(45);class r{constructor(v=null){this.CPh=v||CommonUIStrings.l_InsightsButtonText}get Tfb(){return 10}vK(v){var A=v.jJ;v=h.a.Oja()?h.a.VOa(A,1):h.a.ERd(A);A=String.format(this.CPh,A);return this.FYi(v,A)}FYi(v,A){return e.a(r.jsg,h.a.Oja()?"1914896509":"3317204163",m.a.je(A),h.a.tCj,null,m.a.je(v),m.a.je(A),null,
null)}}r.jsg="bInsights";Object(J.a)(r,"InsightsMenuItemFactory",null,[681])},946:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(134),e=d(45);class m{constructor(r,v,A,w,y){this.pDd=r;this.oDd=v;this.YYh=A;this.ROh=w;this.y7e=y}get Tfb(){return 4}vK(r,v=null){v=v.sessionId+"|"+v.W7+"|"+r.jJ;if(this.y7e||this.ROh){let A=this.y7e||e.a.rB(CommonUIStrings.l_HelpTooltip)===e.a.rB(r.jJ.trim());if(this.YYh&&2<r.jJ.length){const w=r.jJ;";"===w.charAt(0)&&";"===w.charAt(w.length-1)&&w.substring(1,
w.length-1)===m.t6d&&(A=!0)}r=A?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,r.jJ);return this.j8f(v,e.a.je(r),A)}return this.j8f(v,e.a.je(String.format(CommonUIStrings.l_TextWithQuotation,r.jJ)),!1)}j8f(r,v,A){return h.a(m.t6d,A?this.oDd:this.pDd,v,"OfficeAssistant_16x16x32","A0",e.a.je(r),v,null,null)}}m.t6d="bSearchHelp";Object(J.a)(m,"AssistanceMenuItemFactory",null,[681])},947:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(25),
e=d(134),m=d(73),r=d(45);class v{get Tfb(){return 13}vK(){return v.kgi()}static kgi(){return e.b(v.a6f,"798637440",r.a.je(CommonUIStrings.l_LookupFirstRunExperienceTitle),h.AFrameworkApplication.gm,m.getImageClass("Info_32x32x32"),null,null,r.a.je(CommonUIStrings.l_LookupFirstRunExperienceTitle),"Menu32",null,null,r.a.je(CommonUIStrings.l_LookupFirstRunExperienceDescription),null,null)}}v.a6f="bTellMeFirstRun";Object(J.a)(v,"FirstRunMenuItemFactory",null,[681])},948:function(J,V,d){d.d(V,"a",function(){return r});
J=d(0);var h=d(25),e=d(134),m=d(45);class r{constructor(v=null,A=null){this.nhf=v;this.gTh=A||CommonUIStrings.l_LookupNoResultsDescription}get Tfb(){return 14}vK(v){v=String.format(this.gTh,v.jJ);return this.Qgi(v)}Qgi(v){return e.b(r.eXg,"798637440",m.a.je(CommonUIStrings.l_LookupNoResultsTitle),this.nhf?h.AFrameworkApplication.gm:null,this.nhf,null,null,m.a.je(CommonUIStrings.l_LookupNoResultsTitle),"Menu32",null,null,m.a.je(v),null,null)}}r.eXg="lookupNoResults";Object(J.a)(r,"NoCommandsFoundMenuItemFactory",
null,[681])},949:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.FontWeight=0;this.Text=null;this.FontWeight=e;this.Text=m}}Object(J.a)(h,"LabelFormatted",null,[])},950:function(J,V,d){d.d(V,"a",function(){return A});J=d(0);d(146);var h=d(158),e=d(176),m=d(175),r=d(105),v=d(45);class A{constructor(w){this.vb=w}BG(){return"Assistance"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:this.vb.tfc?3:2}HD(w,y,u=!1,D,F=null){D=new m.a(w);if((!F||Array.contains(F,8))&&!r.a.pN(w)){F=
new e.a(8);if(u){u=v.a.rB(CommonUIStrings.l_HelpTooltip)===v.a.rB(w.Gf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,w.Gf);const I=[];this.vb.YSa&&(this.vb.BNe||I.push(appChrome.actions.setControlIconSet("GetHelpFromTellMe",{"default":"search_20"})),u=this.pdg(w.Gf));const H="||"+w.Gf;I.push(appChrome.actions.setControlLabel("GetHelpFromTellMe",u));I.push(appChrome.actions.setButtonCommandValueId("GetHelpFromTellMe",H));appChrome.api.dispatch(I);
w=new h.a("GetHelpFromTellMe",4,w.Gf,null,1)}else w=new h.a("bSearchHelp",4,w.Gf,null,1);F.Qv(w);F.displayName=CommonUIStrings.l_HelpButtonTitle;D.Is(F)}y.resultsUpdated(D)}tRa(w,y=null){const u=new e.a(8),D=v.a.rB(CommonUIStrings.l_HelpTooltip)===v.a.rB(w.Gf.trim())?CommonUIStrings.l_HelpButtonTextNoPlaceholder:String.format(CommonUIStrings.l_TextWithQuotation,w.Gf);for(let I=0;I<y.length&&2>I;I++){var F=void 0;F=[];let H="GetHelpWithDescriptionFromTellMe"+(I+1).toString(),L=4;if(this.vb.Plc)F.push(appChrome.actions.setControlLabel(H,
D)),F.push(appChrome.actions.setCompoundButtonCommandValueId(H,w.Gf)),F.push(appChrome.actions.updateCompoundButtonDescription(H,this.wij(y.length)));else if(this.vb.Qlc){let E=this.xhg(y[I]);H="GetHelpFromTellMe"+(I+1).toString();this.vb.YSa&&(E=this.pdg(E));L=9;F.push(appChrome.actions.setControlLabel(H,E));F.push(appChrome.actions.setButtonCommandValueId(H,this.uij(y[I])))}appChrome.api.dispatch(F);F=new h.a(H,L,null,null,0);F.label=this.xhg(y[I]);F.description=this.tij(y[I]);u.Qv(F);if(this.vb.Qlc)break}u.displayName=
CommonUIStrings.l_HelpButtonTitle;return u}wij(w){return 1===w?String.format(CommonUIStrings.l_SearchResultText,w):String.format(CommonUIStrings.l_SearchResultsText,w)}pdg(w){return this.vb.xce?r.a.q0d(w,CommonUIStrings.l_HelpScopedButtonText):w+CommonUIStrings.l_HelpScopedButtonText}xhg(w){return w.name?w.name:""}tij(w){return w.description?w.description:""}uij(w){return w.id?"AssetID="+w.id:""}}Object(J.a)(A,"AssistanceResultsProvider",null,[693])},951:function(J,V,d){d.d(V,"a",function(){return w});
J=d(0);d(146);var h=d(158),e=d(176),m=d(175),r=d(118),v=d(105),A=d(441);class w{constructor(y){this.vb=y}BG(){return"Image"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:3===this.vb.pr?3:2}HD(y,u,D,F,I=null){D=new m.a(y);(!I||Array.contains(I,19))&&v.a.pN(y)&&this.vb.rH&&this.tRa(y,D,1);u.resultsUpdated(D)}tRa(y,u,D,F=null){var I=[];let H;r.TellMeActor.instance.xG()&&r.TellMeActor.instance.xG().YSa?(H=this.vb.xce?v.a.q0d(y.Gf,CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader):y.Gf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextNoHeader,
this.vb.BNe||I.push(appChrome.actions.setControlIconSet("ImageForSearch",{"default":"search_20"}))):H=this.vb.rH?v.a.pN(y)?this.vb.TNa?v.a.xQa(CommonUIStrings.l_TellMeImageSuggestionButtonTextV2Bolded):CommonUIStrings.l_TellMeImageSuggestionButtonTextV2:this.vb.TNa?v.a.xQa(String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonTextBolded,y.Gf)):String.format(CommonUIStrings.l_TellMeScopedImageSuggestionButtonText,y.Gf):this.vb.gIb?CommonUIStrings.l_TellMeImageSuggestionButtonText:y.Gf+CommonUIStrings.l_TellMeImageSuggestionScopedButtonTextWithHeader;
this.vb.eja?(r.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel("ImageForSearch",H)),I=v.a.VOa(y.Gf,9,Object.assign(new A.a,{landingTab:"Image"})),r.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",I))):(I.push(appChrome.actions.setControlLabel("ImageForSearch",H)),y=v.a.VOa(y.Gf,9,Object.assign(new A.a,{landingTab:"Image"})),I.push(appChrome.actions.setButtonCommandValueId("ImageForSearch",y)),appChrome.api.dispatch(I));D=new h.a("ImageForSearch",
12,null,null,D);F&&(D.score=F.ConfidenceScore);F=new e.a(19,this.vb.gIb?CommonUIStrings.l_TellMeImageTitleV2:CommonUIStrings.l_TellMeImageTitle);F.Qv(D);u.Is(F)}}Object(J.a)(w,"ImageResultsProvider",null,[693])},952:function(J,V,d){d.d(V,"a",function(){return A});J=d(0);d(146);var h=d(158),e=d(176),m=d(175),r=d(105),v=d(25);class A{constructor(w){this.vb=w}BG(){return"Template"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:3}HD(w,y){w=new m.a(w);y.resultsUpdated(w)}tRa(w,y,u){var D=[];let F;F=this.vb.rH?
this.vb.TNa?r.a.xQa(String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2Bolded,w.Gf)):String.format(CommonUIStrings.l_TellMeTemplateButtonTextV2,w.Gf):String.format(CommonUIStrings.l_TellMeTemplateButtonText,w.Gf);D.push(appChrome.actions.setControlLabel("TemplateForSearch",F));D.push(appChrome.actions.setButtonCommandValueId("TemplateForSearch",String.format(v.AFrameworkApplication.fa.Ga("TellMeTemplateProviderURL"),v.AFrameworkApplication.uiCulture,w.Gf)));appChrome.api.dispatch(D);w=new e.a(23);
w.displayName=CommonUIStrings.l_TellMeTemplateProviderTitle;D=new h.a("TemplateForSearch",24,null,null,0);D.label=u[0].Title?u[0].Title:"";D.description=u[0].Description?u[0].Description:"";w.Qv(D);y.Is(w)}}Object(J.a)(A,"TemplateResultsProvider",null,[693])},953:function(J,V,d){d.d(V,"a",function(){return u});J=d(0);d(146);var h=d(325),e=d(158),m=d(176),r=d(175),v=d(679),A=d(118),w=d(105),y=d(45);class u{constructor(D,F,I,H){this.HR=D;this.sNa=F;this.eAf=H;this.TNh=I;this.vb=A.TellMeActor.instance.xG()}BG(){return"EmptyQuery"}RP(){return 1===
this.vb.pr?1:0}HD(D,F,I=!1,H,L=null){H=new r.a(D);if((!L||Array.contains(L,5)||Array.contains(L,6)||Array.contains(L,4))&&w.a.pN(D)){this.HR.F0b().length||!this.TNh||this.eAf||(D=new m.a(6),L=new e.a(null,13,void 0,void 0,1),D.Qv(L),H.Is(D));D=new m.a(4);if(0<this.HR.F0b().length){D.displayName=CommonUIStrings.l_TellMeRecentlyUsedTitle;L=this.HR.F0b();var E=[];for(var aa of L)E.push(aa.Id);h.CommandResultsUtility.wKb(E,this.vb);for(var Q of L)h.CommandResultsUtility.E4b(Q.Id)&&D.Qv(new e.a(Q.Id,5,
null,null,2));H.Is(D)}if(this.eAf&&0<this.sNa.length&&this.HR.F0b().length<u.CUg){aa=new m.a(5);aa.displayName=CommonUIStrings.l_TellMeTryQueryTitle;Q=u.CUg-D.results.length;D=[];for(L=0;L<this.sNa.length&&L<Q;++L){if(I){E=w.a.$Te+(L+1);const O=this.sNa[L].key,T=y.a.replaceAll(O,'"',"");D.push(appChrome.actions.setControlLabel(E,O));D.push(appChrome.actions.setButtonCommandValueId(E,T));E=new v.a(O,7,0,T,E)}else E=new v.a(this.sNa[L].key,7,0,this.sNa[L].value);aa.Qv(E)}0<D.length&&appChrome.api.dispatch(D);
H.Is(aa)}}F.resultsUpdated(H)}}u.CUg=5;Object(J.a)(u,"EmptyQueryResultsProvider",null,[693])},954:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.mld=this.zsa=this.VRa=this.Ps=this.sDc=this.rz=this.gjb=0}}Object(J.a)(h,"TRIESCAN",null,[])},972:function(J,V,d){d.r(V);var h=d(0),e=d(146),m=d(372),r=d(261),v=d(692);class A{constructor(va,Qa){this.lqd=va;this.Ph=Qa}resultsUpdated(va){this.lqd.K6k(this.Ph,va)}}Object(h.a)(A,"AggregatorResultsProviderCallback",null,[701]);
var w=d(176),y=d(175);class u{constructor(va){this.eaa=null;this.vb=va;this.vb.K3a&&(this.eaa=null)}BG(){return"AppsForOffice"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}HD(va,Qa,db,Gb,jc=null){db=new y.a(va);if(!jc||Array.contains(jc,1))jc=new w.a(1),this.eaa.IEl(jc,va.Gf),db.Is(jc);Qa.resultsUpdated(db)}}Object(h.a)(u,"AppsForOfficeRecommendationResultsProvider",null,[693]);var D=d(950),F=d(76),I=d(216),H=d(22);class L{constructor(va,Qa){this.Ia=va;this.H2j=Qa}isMatch(va,Qa){if(!Object(H.a)(869,
va))throw Error.argument("objToTest","Expected feature bundle");let db;return({value:db}=va.Im(this.Ia.eba)).returnValue?this.Ia.sWe.isMatch(db,Qa):this.H2j}}Object(h.a)(L,"AnnotatedWithAndValueMatchesAnnotationFilter",null,[953]);class E{constructor(va,Qa){this.Ia=va;this.Gje=Qa}isMatch(va){if(!Object(H.a)(869,va))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Gje^va.Im(this.Ia.eba).returnValue)}}Object(h.a)(E,"AnnotatedWithAnnotationFilter",null,[953]);class aa{constructor(va){this.Ia=
va}isMatch(va,Qa){if(!Object(H.a)(874,va))throw Error.argument("objToTest","Expected struct value");return this.Ia.sWe.isMatch(va.LQa(this.Ia.Dra),Qa)}}Object(h.a)(aa,"FieldValueMatchesStructFilter",null,[953]);class Q{constructor(va,Qa){va&&(this.Dra=va.ga(0),this.sWe=Qa.G7(va.ga(1)))}}Object(h.a)(Q,"FieldValueMatchesStructFilterInit",null,[]);class O{constructor(va){this.Gje=va}isMatch(va){if(!Object(H.a)(869,va))throw Error.argument("objToTest","Expected feature bundle");return!!(this.Gje^va.N5d)}}
Object(h.a)(O,"HasAnnotationsAnnotationFilter",null,[953]);class T{constructor(va,Qa){this.Ia=va;this.Gp=Qa}isMatch(va,Qa){if(!Object(H.a)(873,va))throw Error.argument("objToTest","Expected list value");switch(this.Gp){case 0:for(const db of va.items)if(this.Ia.filter.isMatch(db,Qa))return!0;return!1;case 1:for(const db of va.items)if(!this.Ia.filter.isMatch(db,Qa))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(T,"ItemTestListFilter",null,[953]);class K{constructor(va){this.Ia=
va}isMatch(va,Qa){if(!Object(H.a)(873,va))throw Error.argument("objToTest","Expected list value");return this.Ia.filter.isMatch(va.items.length,Qa)}}Object(h.a)(K,"LengthMatchesListFilter",null,[953]);class X{constructor(va,Qa){this.Ia=va;this.Gp=Qa}isMatch(va,Qa,db=null){let Gb=0===this.Gp;for(const jc of this.Ia.gPf)if((Gb=jc.isMatch(va,Qa,db))?1===this.Gp:0===this.Gp)return Gb;2===this.Gp&&(Gb=!Gb);return Gb}}Object(h.a)(X,"NonterminalFilter",null,[953]);class P{constructor(va,Qa){if(va){var db=
va.ga(0);this.gPf=Array(db);for(let Gb=0;Gb<db;++Gb)this.gPf[Gb]=Qa.G7(va.ga(1+Gb))}}}Object(h.a)(P,"NonterminalFilterInit",null,[]);class ea{constructor(va,Qa){this.Ia=va;this.Gp=Qa}isMatch(va,Qa){if("number"!==typeof va)throw Error.argument("objToTest","Expected number value");let db=this.Ia.number;if(this.Ia.query){Qa=this.Ia.query.ap(null,Qa);if("number"!==typeof Qa)throw Error.invalidOperation("Query did not return number");db+=Qa}switch(this.Gp){case 0:return va===db;case 1:return va<db;case 2:return va<=
db;case 3:return va>db;case 4:return va>=db;default:throw Error.notImplemented();}}}Object(h.a)(ea,"NumberFilter",null,[953]);class ia{constructor(va,Qa){va&&(this.number=va.ga(0),this.query=va.ga(1)?Qa.vD(va.ga(1)):null)}}Object(h.a)(ia,"NumberFilterInit",null,[]);class ja{constructor(va,Qa,db){this.qNc=this.p5i;this.ZFa=va;this.DIg=Qa;this.BIg=db}INd(va){this.DIg=va}p5i(va){if(!va)throw Error.argument("name","Invalid named feature bundle reference");const Qa=va.substr(1);return 1===va.charCodeAt(0)&&
Qa===this.ZFa?this.DIg:this.BIg?this.BIg.qNc(va):null}}Object(h.a)(ja,"SimpleNamedFeatureBundleResolver",null,[985]);class C{constructor(va){this.Ia=va}isMatch(va,Qa){if(!Object(H.a)(869,va))throw Error.argument("objToTest","Expected feature bundle");va=this.Ia.query.ap(null,new ja(this.Ia.Dod,va,Qa));if("boolean"!==typeof va)throw Error.invalidOperation("Query did not return bool");return va}}Object(h.a)(C,"PredicateAnnotationFilter",null,[953]);class pa{constructor(va,Qa){va&&(this.Dod=Qa.aC(va.ga(0)),
this.query=Qa.vD(va.ga(1)))}}Object(h.a)(pa,"PredicateAnnotationFilterInit",null,[]);class Z{constructor(va){this.Ia=va}isMatch(va,Qa){if("boolean"!==typeof va)throw Error.argument("objToTest","Expected bool value");Qa=this.Ia.query.ap(null,Qa);if("boolean"!==typeof Qa)throw Error.invalidOperation("Query did not return bool");return va===Qa}}Object(h.a)(Z,"QueryBooleanFilter",null,[953]);class qa{constructor(va,Qa){this.Ia=va;this.Gp=Qa}isMatch(va,Qa){if("number"!==typeof va)throw Error.argument("objToTest",
"Expected integer");Qa=this.Ia.query.ap(null,Qa);if("number"!==typeof Qa)throw Error.invalidOperation("Query did not return an enum value");switch(this.Gp){case 0:return va===Qa;case 1:return 0!==(va&Qa);case 2:return va===(va&Qa);case 3:return Qa===(va&Qa);default:throw Error.notImplemented();}}}Object(h.a)(qa,"QueryEnumFilter",null,[953]);class ya{constructor(va,Qa){va&&(this.BUc=1===va.ga(0),this.query=Qa.vD(va.ga(1)))}}Object(h.a)(ya,"QueryEnumFilterInit",null,[]);class Ka{constructor(va,Qa){this.Ia=
va;this.Gp=Qa}isMatch(va,Qa){if(!Object(H.a)(873,va))throw Error.argument("objToTest","Expected list value");Qa=this.Ia.query.ap(null,Qa);if(!Object(H.a)(873,Qa))throw Error.invalidOperation("Query did not return list value");if(va.WT!==Qa.WT)return!1;switch(this.Gp){case 0:return F.Annotations.k_a(F.Annotations.P8i(va.WT),va,Qa);case 1:for(const db of va.items)for(const Gb of Qa.items)if(F.Annotations.k_a(va.WT,db,Gb))return!0;return!1;case 2:for(const db of va.items)for(const Gb of Qa.items)if(!F.Annotations.k_a(va.WT,
db,Gb))return!1;return!0;case 3:for(const db of Qa.items)for(const Gb of va.items)if(!F.Annotations.k_a(va.WT,db,Gb))return!1;return!0;default:throw Error.notImplemented();}}}Object(h.a)(Ka,"QueryListFilter",null,[953]);class Da{constructor(va,Qa){this.Ia=va;this.Gp=Qa}isMatch(va,Qa){if("string"!==typeof va)throw Error.argument("objToTest","Expected string");Qa=this.Ia.query.ap(null,Qa);if("string"!==typeof Qa)throw Error.invalidOperation("Query did not return string");this.Ia.e$d&&(va=va.toUpperCase(),
Qa=Qa.toUpperCase());switch(this.Gp){case 0:return va===Qa;case 1:return 0<=va.indexOf(Qa);case 2:return va.startsWith(Qa);case 3:return va.endsWith(Qa);case 4:return 0<=Qa.indexOf(va);case 5:return Qa.startsWith(va);case 6:return Qa.endsWith(va);default:throw Error.notImplemented();}}}Object(h.a)(Da,"QueryStringFilter",null,[953]);class la{constructor(va,Qa){va&&(this.query=Qa.vD(va.ga(0)),this.e$d=1===va.ga(1))}}Object(h.a)(la,"QueryStringFilterInit",null,[]);class ma{constructor(va){this.Ia=va}isMatch(va,
Qa){if(!Object(H.a)(874,va))throw Error.argument("objToTest","Expected struct value");Qa=this.Ia.query.ap(null,Qa);if(!Object(H.a)(874,Qa))throw Error.invalidOperation("Query did not return struct value");return va.isEqual(va)}}Object(h.a)(ma,"QueryStructFilter",null,[953]);class Ea{constructor(va){this.Ia=va}isMatch(va,Qa){va=this.Ia.query.ap(null,Qa);if("boolean"!==typeof va)throw Error.invalidOperation("Query did not return bool");return va}}Object(h.a)(Ea,"QueryWhereConstraintFilter",null,[953]);
class ta{constructor(va){this.Ia=va}isMatch(va){if("string"!==typeof va)throw Error.argument("objToTest","Expected string");return this.Ia.regex.test(va)}}Object(h.a)(ta,"RegexStringFilter",null,[953]);class Ga{constructor(va,Qa){va&&(this.regex=Qa.Leg(va.ga(0)))}}Object(h.a)(Ga,"RegexStringFilterInit",null,[]);class oa{constructor(va,Qa){va&&(this.filter=Qa.G7(va.ga(0)))}}Object(h.a)(oa,"SingleFilterFilterInit",null,[]);class sa{constructor(va,Qa){va&&(this.query=Qa.vD(va.ga(0)))}}Object(h.a)(sa,
"SingleQueryFilterInit",null,[]);class Ha{constructor(va){this.Ia=va}isMatch(va){if("boolean"!==typeof va)throw Error.argument("objToTest","Expected bool value");return va===this.Ia.value}}Object(h.a)(Ha,"StoredValueBooleanFilter",null,[953]);class bb{constructor(va){va&&(this.value=1===va.ga(0))}}Object(h.a)(bb,"StoredValueBooleanFilterInit",null,[]);class Ya{constructor(va,Qa){this.Ia=va;this.Gp=Qa}isMatch(va){if("number"!==typeof va)throw Error.argument("objToTest","Expected integer");switch(this.Gp){case 0:return this.Ia.BUc?
this.Ia.value?!!(va&this.Ia.value):!va:va===this.Ia.value;case 1:return this.Ia.BUc?(va&this.Ia.value)===this.Ia.value:32>va&&(1<<va&this.Ia.value)===this.Ia.value;case 2:return this.Ia.BUc?!!(va&this.Ia.value):32>va&&!!(1<<va&this.Ia.value);default:throw Error.notImplemented();}}}Object(h.a)(Ya,"StoredValueEnumFilter",null,[953]);class ua{constructor(va){va&&(this.BUc=1===va.ga(0),this.value=va.ga(1))}}Object(h.a)(ua,"StoredValueEnumFilterInit",null,[]);class Ma{constructor(){this.avk=null;this.wMd=
this.l8a=0}}Object(h.a)(Ma,"WHEREConstraintData",null,[]);class Ca{constructor(va){this.Ia=va}isMatch(va,Qa){if(!Object(H.a)(Ma,va))throw Error.argument("objToTest","Expected WHERE constraint data");let db=-1,Gb=-1;const jc=va.avk;switch(this.Ia.BNd){case 4:db=jc.F_b;Gb=jc.sPe;break;case 5:db=va.l8a;Gb=jc.F_b-va.l8a;break;case 6:db=jc.F_b+jc.sPe;Gb=va.l8a+va.wMd-db;break;case 1:case 2:case 3:let Ac=!1;for(let W=jc.VEl;W;W=W.next)if(this.Ia.eAl===W.name){Ac=!0;1===this.Ia.BNd?(db=W.F_b,Gb=W.sPe):2===
this.Ia.BNd?(db=va.l8a,Gb=W.F_b-va.l8a):(db=W.F_b+W.sPe,Gb=va.l8a+va.wMd-db);break}if(!Ac)return!1;break;case 7:db=va.l8a;Gb=va.wMd;break;default:throw Error.notImplemented();}return null!==this.Ia.lil.sFl(jc.QGl,db,Gb,db,!0,2,Qa)}}Object(h.a)(Ca,"SubSreWhereConstraintFilter",null,[953]);class Va{constructor(va,Qa){if(va){var db=Qa.aC(va.ga(0));this.BNd=db.charCodeAt(0);this.eAl=db.substr(1);this.lil=Qa.ydj(va.ga(1))}}}Object(h.a)(Va,"SubSreWhereConstraintFilterInit",null,[]);class Za{constructor(va){this.Ia=
va}isMatch(va,Qa,db=null){if(!Object(H.a)(869,va))throw Error.argument("objToTest","Expected feature bundle");if(null==db)throw Error.argumentNull("parentTextForSpan");if(this.Ia.MGf&&!this.Ia.MGf.isMatch(va,Qa))return!1;if(this.Ia.QRe){let Gb;if(({value:Gb}=va.Im(this.Ia.Ghl)).returnValue){if(!this.Ia.QRe.isMatch(Gb,Qa))return!1}else{let jc,Ac;if(!({value:jc}=va.Im(this.Ia.ruh)).returnValue||!({value:Ac}=va.Im(this.Ia.quh)).returnValue||0>jc||0>Ac||jc+Ac>db.length||!this.Ia.QRe.isMatch(db.substr(jc,
Ac),Qa))return!1}}if(this.Ia.Tuh){let Gb;if(!({value:Gb}=va.Im(this.Ia.ruh)).returnValue||!this.Ia.Tuh.isMatch(Gb,Qa))return!1}if(this.Ia.cCg){let Gb;if(!({value:Gb}=va.Im(this.Ia.quh)).returnValue||!this.Ia.cCg.isMatch(Gb,Qa))return!1}return!0}}Object(h.a)(Za,"TextSpanFilter",null,[953]);class Db{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.ruh=va.ga(0),this.quh=va.ga(1),this.Ghl=va.ga(2),this.QRe=va.ga(3)?Qa.G7(va.ga(3)):null,this.MGf=va.ga(4)?Qa.G7(va.ga(4)):null,this.Tuh=va.ga(5)?
Qa.G7(va.ga(5)):null,this.cCg=va.ga(6)?Qa.G7(va.ga(6)):null)}}Object(h.a)(Db,"TextSpanFilterInit",null,[]);class Lb{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.eba=va.ga(0),this.sWe=va.ga(1)?Qa.G7(va.ga(1)):null)}}Object(h.a)(Lb,"ValueFilterAnnotationFilterInit",null,[]);var yb=d(278);class Bc{G7(va,Qa){const db=va.ga(0),Gb=new yb.a;Gb.qQa(va,1,va.count-1);switch(db){case 1:return new X(new P(Gb,Qa),0);case 2:return new X(new P(Gb,Qa),1);case 3:return new X(new P(Gb,Qa),2);case 101:return new ta(new Ga(Gb,
Qa));case 103:return new Da(new la(Gb,Qa),0);case 104:return new Da(new la(Gb,Qa),1);case 105:return new Da(new la(Gb,Qa),2);case 106:return new Da(new la(Gb,Qa),3);case 107:return new Da(new la(Gb,Qa),4);case 108:return new Da(new la(Gb,Qa),5);case 109:return new Da(new la(Gb,Qa),6);case 201:return new Ha(new bb(Gb));case 202:return new Z(new sa(Gb,Qa));case 301:return new ea(new ia(Gb,Qa),0);case 302:return new ea(new ia(Gb,Qa),1);case 303:return new ea(new ia(Gb,Qa),2);case 304:return new ea(new ia(Gb,
Qa),3);case 305:return new ea(new ia(Gb,Qa),4);case 401:return new Ya(new ua(Gb),0);case 402:return new Ya(new ua(Gb),1);case 403:return new Ya(new ua(Gb),2);case 404:return new qa(new ya(Gb,Qa),0);case 405:return new qa(new ya(Gb,Qa),1);case 406:return new qa(new ya(Gb,Qa),2);case 407:return new qa(new ya(Gb,Qa),3);case 501:return new aa(new Q(Gb,Qa));case 502:return new ma(new sa(Gb,Qa));case 601:return new T(new oa(Gb,Qa),0);case 602:return new T(new oa(Gb,Qa),1);case 603:return new K(new oa(Gb,
Qa));case 604:return new Ka(new sa(Gb,Qa),0);case 605:return new Ka(new sa(Gb,Qa),1);case 606:return new Ka(new sa(Gb,Qa),2);case 607:return new Ka(new sa(Gb,Qa),3);case 701:return new O(!1);case 702:return new O(!0);case 703:return new E(new Lb(Gb,Qa),!1);case 704:return new E(new Lb(Gb,Qa),!0);case 705:return new L(new Lb(Gb,Qa),!1);case 706:return new L(new Lb(Gb,Qa),!0);case 707:return new C(new pa(Gb,Qa));case 901:return new Za(new Db(Gb,Qa));case 1002:return new Ea(new sa(Gb,Qa));case 1001:return new Ca(new Va(Gb,
Qa));default:throw Error.argument("initData");}}}Object(h.a)(Bc,"FilterFactory",null,[868]);var tb=d(139);class Mb{constructor(va){this.Ia=va}get Lx(){return this.Ia.Lx}get iU(){return this.Ia.iU}get Hkd(){return this.Ia.Hkd}get pTc(){return this.Ia.pTc}load(va,Qa){return this.ap(va,va?new ja("root",va,Qa):Qa)}store(va,Qa,db){this.QIb(va,Qa,va?new ja("root",va,db):db,null)}ap(va,Qa){if(!this.pTc&&!this.Ia.annotations.dwb(this.Lx,va))throw Error.argument("input","Input value not of expected type");
let db=this.Ia.e6f;for(;db;)va=db.load(va,Qa),db=db.next;return va}QIb(va,Qa,db,Gb){if(!this.Hkd)throw Error.invalidOperation("Attempt to store into query that supports only loading");if(!this.pTc&&!this.Ia.annotations.dwb(this.Lx,va))throw Error.argument("lvalue","Lvalue not of expected type");if(!this.Ia.annotations.dwb(this.iU,Qa))throw Error.argument("rvalue","Rvalue not of expected type");return this.Ia.e6f.store(va,Qa,db,Gb)}static SQf(va,Qa,db,Gb){if(db===Gb)return Qa;if(F.Annotations.tB(db)&&
F.Annotations.tB(Gb)){db=F.Annotations.ICa(db);Gb=F.Annotations.ICa(Gb);const jc=new tb.a(va,Gb);for(const Ac of Qa.items)Array.add(jc.items,Mb.SQf(va,Ac,db,Gb));return jc}if(db===F.Annotations.Mna){if(Gb===F.Annotations.O$)return Qa;if(Gb===F.Annotations.tY)return Qa.toString()}else if(db===F.Annotations.O$){if(Gb===F.Annotations.Mna)return Math.floor(Qa);if(Gb===F.Annotations.tY)return Qa.toString()}else if(db===F.Annotations.tY){if(Gb===F.Annotations.Mna)return parseInt(Qa);if(Gb===F.Annotations.O$)return parseFloat(Qa)}throw Error.invalidOperation("Type conversion failure in query step");
}}Object(h.a)(Mb,"AnnotationQuery",null,[977]);class Hb{constructor(){this.iU=this.Lx=0;this.next=null}store(){throw Error.invalidOperation("Store not supported");}MCa(va){if(this.next)return{returnValue:this.next,Bna:va};if(va){const Qa=va.KSf;va=va.O8g;return{returnValue:Qa,Bna:va}}return{returnValue:null,Bna:va}}}Object(h.a)(Hb,"AnnotationQueryStep",null,[998]);class vb extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){Qa=this.Ia.query.ap(va,Qa);if(F.Annotations.tB(this.Lx)){var db=F.Annotations.ICa(this.Lx);
let jc=new tb.a(this.Ia.annotations,db);if(F.Annotations.tB(this.Ia.query.iU)){if(va.items.length!==Qa.items.length)throw Error.invalidOperation("List length mismatch in itemwise numeric query step");for(let Ac=0,W=va.items.length;Ac<W;++Ac)Array.add(jc.items,this.ODc(va.items[Ac],Qa.items[Ac],db===F.Annotations.O$))}else for(var Gb of va.items)Array.add(jc.items,this.ODc(Gb,Qa,db===F.Annotations.O$));return jc}if(F.Annotations.tB(this.Ia.query.iU)){Gb=new tb.a(this.Ia.annotations,this.Lx);for(db of Qa.items)Array.add(Gb.items,
this.ODc(va,db,this.Lx===F.Annotations.O$));return Gb}return this.ODc(va,Qa,this.Lx===F.Annotations.O$)}ODc(va,Qa,db){va=this.Dpb(va,Qa);return db?va:Math.floor(va)}}Object(h.a)(vb,"NumericAnnotationQueryStep",Hb,[]);class Xb extends vb{constructor(va){super(va)}Dpb(va,Qa){return va+Qa}}Object(h.a)(Xb,"AddAnnotationQueryStep",vb,[]);class Uc extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){if(this.Lx===F.Annotations.Bfa&&this.Ia.query.iU===F.Annotations.Bfa){let jc;if(({result:jc}=this.KNf(va)).returnValue)return jc}if(F.Annotations.tB(this.Lx)){var db=
new tb.a(this.Ia.annotations,F.Annotations.Bfa);Qa=this.Ia.query.ap(va,Qa);if(F.Annotations.tB(this.Ia.query.iU)){if(va.items.length!==Qa.items.length)throw Error.invalidOperation("List length mismatch in itemwise boolean query step");for(let jc=0,Ac=va.items.length;jc<Ac;++jc)Array.add(db.items,this.UWb(Qa.items[jc],va.items[jc]))}else for(var Gb of va.items)Array.add(db.items,this.UWb(Qa,Gb));return db}Gb=this.Ia.query.ap(va,Qa);if(F.Annotations.tB(this.Ia.query.iU)){Qa=new tb.a(this.Ia.annotations,
F.Annotations.Bfa);for(db of Gb.items)Array.add(Qa.items,this.UWb(db,va));return Qa}return this.UWb(Gb,va)}}Object(h.a)(Uc,"BinaryBooleanAnnotationQueryStep",Hb,[]);class hb extends Uc{constructor(va){super(va)}KNf(va){return{returnValue:!va,result:!1}}UWb(va,Qa){return va&&Qa}}Object(h.a)(hb,"AndAnnotationQueryStep",Uc,[]);class Zb{constructor(va){va&&(this.annotations=va)}}Object(h.a)(Zb,"AnnotationsOnlyQueryStepInit",null,[]);class Fc extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){Qa=
this.Ia.query.ap(va,Qa);va=va.clone();F.Annotations.tB(this.Ia.query.iU)?Array.addRange(va.items,Qa.items):Array.add(va.items,Qa);return va}}Object(h.a)(Fc,"AppendAnnotationQueryStep",Hb,[]);class ob extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){if(this.Lx===F.Annotations.kM)return this.$Zb(va,Qa);const db=new tb.a(this.Ia.annotations,F.Annotations.kM);for(const Gb of va.items)Array.add(db.items,this.$Zb(Gb,Qa));return db}$Zb(va,Qa){const db=new I.a(this.Ia.annotations);db.gBa(va);va=
new I.a(this.Ia.annotations);this.Ia.script.t7(null,new ja("Input",db,new ja("Output",va,Qa)));return va}}Object(h.a)(ob,"ApplyAnnotationQueryStep",Hb,[]);class ac extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){if(this.Lx===F.Annotations.kM)return Qa=this.$Zb(va,Qa),Qa.Im(this.Ia.LGf).returnValue||new tb.a(this.Ia.annotations,F.Annotations.kM),Qa;const db=new tb.a(this.Ia.annotations,F.Annotations.kM);for(const Gb of va.items)if(va=this.$Zb(Gb,Qa),({value:va}=va.Im(this.Ia.LGf)).returnValue)for(const jc of va.items)Array.add(db.items,
jc);return db}$Zb(va,Qa){const db=new I.a(this.Ia.annotations);db.gBa(va);va=new I.a(this.Ia.annotations);this.Ia.script.t7(null,new ja("Input",db,new ja("Output",va,Qa)));return va}}Object(h.a)(ac,"ApplyExpandAnnotationQueryStep",Hb,[]);class pb{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.script=Qa.K6a(va.ga(0)),this.LGf=va.ga(1))}}Object(h.a)(pb,"ApplyExpandQueryStepInit",null,[]);class nb{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.script=Qa.K6a(va.ga(0)))}}Object(h.a)(nb,
"ApplyQueryStepInit",null,[]);class Tb extends Hb{constructor(va){super();this.Ia=va}load(va){if(this.Lx===F.Annotations.kM)return this.sXc(va);const Qa=new tb.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.eba));for(const db of va.items)Array.add(Qa.items,this.sXc(db));return Qa}store(va,Qa,db,Gb){if(this.Lx===F.Annotations.kM){var jc=Qa,Ac=({Bna:Gb}=this.MCa(Gb)).returnValue;Ac&&(jc=Ac.store(F.Annotations.sK(this.sXc(va)),Qa,db,Gb));va.$t(this.Ia.eba,jc)}else{var W=Qa;if(jc=
({Bna:Gb}=this.MCa(Gb)).returnValue){W=new tb.a(this.Ia.annotations,this.Ia.annotations.getAttributeType(this.Ia.eba));for(Ac of va.items)Array.add(W.items,this.sXc(Ac));W=jc.store(W,Qa,db,Gb)}Qa=W;if(Qa.items.length!==va.items.length)throw Error.invalidOperation("RValue list length mismatch in Attr query step store");for(let xa=0,da=va.items.length;xa<da;++xa)db=va.items[xa],db.isReadOnly&&(db=db.clone(),va.items[xa]=db),db.$t(this.Ia.eba,Qa.items[xa])}return va}sXc(va){({value:va}=va.Im(this.Ia.eba)).returnValue||
(va=this.Ia.annotations.w_i(this.Ia.eba));return va}}Object(h.a)(Tb,"AttrAnnotationQueryStep",Hb,[]);class Ub{constructor(va,Qa){va&&(this.annotations=Qa,this.eba=va.ga(0))}}Object(h.a)(Ub,"AttrQueryStepInit",null,[]);class hc extends Hb{constructor(va){super();this.Ia=va}load(va){const Qa=new I.a(this.Ia.annotations);Qa.gBa(va);return this.Ia.module.execute(Qa)}}Object(h.a)(hc,"CallModuleAnnotationQueryStep",Hb,[]);class Wb{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.module=Qa.C1d(va.ga(0)))}}
Object(h.a)(Wb,"CallModuleQueryStepInit",null,[]);class fd extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){if(F.Annotations.tB(this.Lx)){var db=this.Ia.query.ap(va,Qa);Qa=new tb.a(this.Ia.annotations,F.Annotations.tY);let Ac="string"===typeof db;for(var Gb of va.items)if(Ac)Array.add(Qa.items,Gb+db);else for(var jc of db.items)Array.add(Qa.items,Gb+jc);return Qa}Gb=this.Ia.query.ap(va,Qa);if("string"===typeof Gb)return va+Gb;jc=new tb.a(this.Ia.annotations,F.Annotations.tY);for(db of Gb.items)Array.add(jc.items,
va+db);return jc}}Object(h.a)(fd,"ConcatAnnotationQueryStep",Hb,[]);class fc extends Hb{constructor(va){super();this.Ia=va}load(va){return Mb.SQf(this.Ia.annotations,va,this.Lx,this.iU)}}Object(h.a)(fc,"ConvertAnnotationQueryStep",Hb,[]);class bc extends Hb{constructor(){super()}load(va){return va.items.length}}Object(h.a)(bc,"CountAnnotationQueryStep",Hb,[]);class cc extends vb{constructor(va){super(va)}Dpb(va,Qa){return va/Qa}}Object(h.a)(cc,"DivideAnnotationQueryStep",vb,[]);class kb extends Hb{constructor(va){super();
this.Ia=va}load(va,Qa){Qa=new ja(this.Ia.Dod,null,Qa);for(const db of va.items)if(Qa.INd(db),this.Ia.query.ap(db,Qa))return!0;return!1}}Object(h.a)(kb,"ExistsAnnotationQueryStep",Hb,[]);class ab extends vb{constructor(va){super(va)}Dpb(va,Qa){return Math.pow(va,Qa)}}Object(h.a)(ab,"ExpAnnotationQueryStep",vb,[]);class Pb{constructor(va,Qa){va&&(this.Bra=Qa.aC(va.ga(0)))}}Object(h.a)(Pb,"FeatureBundleNameQueryStepInit",null,[]);class rc extends Hb{constructor(va){super();this.Ia=va}load(va){if(F.Annotations.tB(this.Lx)){const Qa=
new tb.a(this.Ia.annotations,this.Ia.annotations.y7a(F.Annotations.ICa(this.Lx),this.Ia.Dra));for(const db of va.items)Array.add(Qa.items,db.LQa(this.Ia.Dra));return Qa}return va.LQa(this.Ia.Dra)}store(va,Qa,db,Gb){if(F.Annotations.tB(this.Lx)){var jc=Qa,Ac=({Bna:Gb}=this.MCa(Gb)).returnValue;if(Ac){jc=new tb.a(this.Ia.annotations,this.Ia.annotations.y7a(F.Annotations.ICa(this.Lx),this.Ia.Dra));for(var W of va.items)Array.add(jc.items,W.LQa(this.Ia.Dra));jc=Ac.store(jc,Qa,db,Gb)}Qa=jc;if(Qa.items.length!==
va.items.length)throw Error.invalidOperation("RValue list length mismatch in Field query step store");for(let xa=0,da=va.items.length;xa<da;++xa)db=va.items[xa],db.isReadOnly&&(db=db.clone(),va.items[xa]=db),db.EKe(this.Ia.Dra,Qa.items[xa])}else Ac=Qa,(W=({Bna:Gb}=this.MCa(Gb)).returnValue)&&(Ac=W.store(F.Annotations.sK(va.LQa(this.Ia.Dra)),Qa,db,Gb)),va.EKe(this.Ia.Dra,Ac);return va}}Object(h.a)(rc,"FieldAnnotationQueryStep",Hb,[]);class ic{constructor(va,Qa){va&&(this.annotations=Qa,this.Dra=va.ga(0))}}
Object(h.a)(ic,"FieldQueryStepInit",null,[]);class md extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){for(const db of va.items)if(this.Ia.filter.isMatch(db,Qa))return db;throw Error.invalidOperation("No matching item found in FirstItemMatching load step");}store(va,Qa,db,Gb){let jc=Qa,Ac=-1;for(let xa=0,da=va.items.length;xa<da;xa++)if(this.Ia.filter.isMatch(va.items[xa],db)){Ac=xa;break}if(0>Ac)throw Error.invalidOperation("No matching item found in FirstItemMatching store step");const W=
({Bna:Gb}=this.MCa(Gb)).returnValue;W&&(jc=W.store(F.Annotations.sK(va.items[Ac]),Qa,db,Gb));va.items[Ac]=jc;return va}}Object(h.a)(md,"FirstItemMatchingAnnotationQueryStep",Hb,[]);class Fd extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){Qa=new ja(this.Ia.Dod,null,Qa);for(const db of va.items)if(Qa.INd(db),!this.Ia.query.ap(db,Qa))return!1;return!0}}Object(h.a)(Fd,"ForAllAnnotationQueryStep",Hb,[]);class ne extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){va=Qa?Qa.qNc(this.Ia.Bra):
null;if(!va)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.Bra+'"');return va}store(va,Qa,db,Gb){va=db?db.qNc(this.Ia.Bra):null;if(!va)throw Error.invalidOperation('Feature bundle resolution failure: "'+this.Ia.Bra+'"');let jc=Qa;const Ac=({Bna:Gb}=this.MCa(Gb)).returnValue;Ac&&(jc=Ac.store(va,Qa,db,Gb));va!==jc&&va.gBa(jc);return va}}Object(h.a)(ne,"GetAnnotationQueryStep",Hb,[]);class ud{constructor(va,Qa){this.GLh=va;this.KUh=Qa}get KSf(){return this.GLh}get O8g(){return this.KUh}}
Object(h.a)(ud,"AnnotationQueryStoreContinuation",null,[1015]);class gb extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){return this.Ia.Ald.ap(va,Qa)?this.Ia.Wzh.ap(va,Qa):this.Ia.tKc?this.Ia.tKc.ap(va,Qa):va}store(va,Qa,db,Gb){var jc=this.Ia.Ald.ap(va,db);this.next&&(Gb=new ud(this.next,Gb));if(jc)return this.Ia.Wzh.QIb(va,Qa,db,Gb);if(this.Ia.tKc)return this.Ia.tKc.QIb(va,Qa,db,Gb);jc=Qa;let Ac=null;Gb&&(Ac=Gb.KSf,Gb=Gb.O8g);Ac&&(jc=Ac.store(F.Annotations.sK(va),Qa,db,Gb));return jc}}Object(h.a)(gb,
"IfAnnotationQueryStep",Hb,[]);class Vb{constructor(va,Qa){va&&(this.Ald=Qa.vD(va.ga(0)),this.Wzh=Qa.vD(va.ga(1)),this.tKc=va.ga(2)?Qa.vD(va.ga(2)):null)}}Object(h.a)(Vb,"IfQueryStepInit",null,[]);class Lc{constructor(va,Qa){va&&(this.Hxj=Qa.vD(va.ga(0)),this.PAg=Qa.vD(va.ga(1)))}}Object(h.a)(Lc,"IndexAndItemQueryStepInit",null,[]);class Xc extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){const db=this.Ia.Hxj.ap(va,Qa);Qa=this.Ia.PAg.ap(va,Qa);va=va.clone();if(0>db||db>va.items.length)throw Error.invalidOperation("Index out of range in InsertAt() query step");
if(F.Annotations.tB(this.Ia.PAg.iU))for(let Gb=0;Gb<Qa.items.length;++Gb)Array.insert(va.items,db+Gb,Qa.items[Gb]);else Array.insert(va.items,db,Qa);return va}}Object(h.a)(Xc,"InsertAtAnnotationQueryStep",Hb,[]);class Ib extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){return!(!Qa||!Qa.qNc(this.Ia.Bra))}}Object(h.a)(Ib,"IsDefinedAnnotationQueryStep",Hb,[]);class gc extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){Qa=this.xtb(va,Qa);return va.items[Qa]}store(va,Qa,db,Gb){const jc=
this.xtb(va,db);let Ac=Qa;const W=({Bna:Gb}=this.MCa(Gb)).returnValue;W&&(Ac=W.store(F.Annotations.sK(va.items[jc]),Qa,db,Gb));va.items[jc]=Ac;return va}xtb(va,Qa){Qa=this.Ia.query.ap(va,Qa);if(0>Qa||Qa>=va.items.length)throw Error.invalidOperation("Index out of range in Item store step");return Qa}}Object(h.a)(gc,"ItemAnnotationQueryStep",Hb,[]);class Fb extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){const db=new tb.a(this.Ia.annotations,F.Annotations.ICa(this.Lx));for(const Gb of va.items)this.Ia.filter.isMatch(Gb,
Qa)&&Array.add(db.items,Gb);return db}}Object(h.a)(Fb,"ItemsMatchingAnnotationQueryStep",Hb,[]);class fb extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){Qa=this.xtb(va,Qa);return va.items[va.items.length-Qa-1]}store(va,Qa,db,Gb){const jc=this.xtb(va,db);let Ac=Qa;const W=({Bna:Gb}=this.MCa(Gb)).returnValue;W&&(Ac=W.store(F.Annotations.sK(va.items[va.items.length-jc-1]),Qa,db,Gb));va.items[va.items.length-jc-1]=Ac;return va}xtb(va,Qa){Qa=this.Ia.query?this.Ia.query.ap(va,Qa):0;if(0>Qa||Qa>=
va.items.length)throw Error.invalidOperation("Index out of range in LastItem load step");return Qa}}Object(h.a)(fb,"LastItemAnnotationQueryStep",Hb,[]);class Pc extends Hb{constructor(va){super();this.Ia=va}load(va){if(F.Annotations.tB(this.Lx)){const Qa=new tb.a(this.Ia.annotations,F.Annotations.Mna);for(const db of va.items)Array.add(Qa.items,db.length);return Qa}return va.length}}Object(h.a)(Pc,"LengthAnnotationQueryStep",Hb,[]);class dd extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){if(F.Annotations.tB(this.Lx)){const db=
new tb.a(this.Ia.annotations,F.Annotations.Bfa);for(const Gb of va.items)Array.add(db.items,this.Ia.filter.isMatch(Gb,Qa));return db}return this.Ia.filter.isMatch(va,Qa)}}Object(h.a)(dd,"MatchesAnnotationQueryStep",Hb,[]);class kd extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){return this.Ia.filter.isMatch(va,Qa)}}Object(h.a)(kd,"MatchesAsListAnnotationQueryStep",Hb,[]);class Td extends vb{constructor(va){super(va)}Dpb(va,Qa){return va%Qa}}Object(h.a)(Td,"ModuloAnnotationQueryStep",vb,
[]);class ce extends vb{constructor(va){super(va)}Dpb(va,Qa){return va*Qa}}Object(h.a)(ce,"MultiplyAnnotationQueryStep",vb,[]);class ld extends Hb{constructor(va){super();this.Ia=va}load(va){if(F.Annotations.tB(this.Lx)){const Qa=new tb.a(this.Ia.annotations,F.Annotations.Bfa);for(const db of va.items)Array.add(Qa.items,!db);return Qa}return!va}}Object(h.a)(ld,"NotAnnotationQueryStep",Hb,[]);class ad extends Uc{constructor(va){super(va)}KNf(va){return{returnValue:va,result:!0}}UWb(va,Qa){return va||
Qa}}Object(h.a)(ad,"OrAnnotationQueryStep",Uc,[]);class Yf extends Hb{constructor(va){super();this.Ia=va}load(va,Qa){const db=this.Ia.LPe.ap(va,Qa);va=this.Ia.tXb.ap(va,Qa);Qa=new tb.a(this.Ia.annotations,F.Annotations.Mna);for(let Gb=0;Gb<va;++Gb)Array.add(Qa.items,db+Gb);return Qa}}Object(h.a)(Yf,"RangeAnnotationQueryStep",Hb,[]);class Xd{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.filter=Qa.G7(va.ga(0)))}}Object(h.a)(Xd,"SingleFilterQueryStepInit",null,[]);class fg{constructor(va,
Qa){va&&(this.annotations=Qa.annotations,this.query=va.ga(0)?Qa.vD(va.ga(0)):null)}}Object(h.a)(fg,"SingleOptionalQueryQueryStepInit",null,[]);class ue{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.query=Qa.vD(va.ga(0)))}}Object(h.a)(ue,"SingleQueryQueryStepInit",null,[]);class Sa{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.LPe=Qa.vD(va.ga(0)),this.tXb=va.ga(1)?Qa.vD(va.ga(1)):null)}}Object(h.a)(Sa,"StartAndCountOrLengthQueryStepInit",null,[]);class rb extends Hb{constructor(va){super();
this.Ia=va}load(va,Qa){let db;({BJa:Qa,length:db}=this.iPc(va,Qa));const Gb=new tb.a(this.Ia.annotations,va.WT);for(let jc=0;jc<db;++jc)Array.add(Gb.items,va.items[Qa+jc]);return Gb}store(va,Qa,db,Gb){let jc,Ac;({BJa:jc,length:Ac}=this.iPc(va,db));var W=Qa;const xa=({Bna:Gb}=this.MCa(Gb)).returnValue;if(xa){W=new tb.a(this.Ia.annotations,va.WT);for(let da=0;da<Ac;++da)Array.add(W.items,va.items[jc+da]);W=xa.store(W,Qa,db,Gb)}Qa=W;for(db=0;db<Ac;++db)Array.removeAt(va.items,jc);for(let da=0,Fa=Qa.items.length;da<
Fa;++da)Array.insert(va.items,jc+da,Qa.items[da]);return va}iPc(va,Qa){let db;db=this.Ia.LPe.ap(va,Qa);if(0>db)throw Error.invalidOperation("Invalid start index in Sublist() query step");Qa=this.Ia.tXb?this.Ia.tXb.ap(va,Qa):va.items.length-db;if(0>Qa||db+Qa>va.items.length)throw Error.invalidOperation("Start index or length out of range in Sublist() query step");return{BJa:db,length:Qa}}}Object(h.a)(rb,"SublistAnnotationQueryStep",Hb,[]);class pc extends Hb{constructor(va){super();this.Ia=va}load(va,
Qa){if(F.Annotations.tB(this.Lx)){const db=new tb.a(this.Ia.annotations,F.Annotations.tY);for(let Gb=0,jc=va.items.length;Gb<jc;++Gb)Array.add(db.items,this.getSubstring(va.items[Gb],Qa));return db}return this.getSubstring(va,Qa)}store(){throw Error.invalidOperation("Substring() store not yet supported by the runtime");}getSubstring(va,Qa){let db;({BJa:Qa,length:db}=this.iPc(va,Qa));return va.substr(Qa,db)}iPc(va,Qa){let db;db=this.Ia.LPe.ap(va,Qa);if(0>db)throw Error.invalidOperation("Invalid start index in Substring() query step");
Qa=this.Ia.tXb?this.Ia.tXb.ap(va,Qa):va.length-db;if(0>Qa||db+Qa>va.length)throw Error.invalidOperation("Start index or length out of range in Substring() query step");return{BJa:db,length:Qa}}}Object(h.a)(pc,"SubstringAnnotationQueryStep",Hb,[]);class cd extends vb{constructor(va){super(va)}Dpb(va,Qa){return va-Qa}}Object(h.a)(cd,"SubtractAnnotationQueryStep",vb,[]);class zd extends Hb{constructor(va){super();this.Ia=va}load(va){const Qa=new tb.a(this.Ia.annotations,F.Annotations.tY);for(let db=
0;db<va.length;++db)Array.add(Qa.items,va.charAt(db).toString());return Qa}}Object(h.a)(zd,"ToCharListAnnotationQueryStep",Hb,[]);class wd extends Hb{constructor(va){super();this.Ia=va}load(va){const Qa=new tb.a(this.Ia.annotations,this.Lx);Array.add(Qa.items,va);return Qa}}Object(h.a)(wd,"ToListAnnotationQueryStep",Hb,[]);class Oa extends Hb{constructor(va){super();this.Ia=va}load(){return this.Ia.value}}Object(h.a)(Oa,"ValueAnnotationQueryStep",Hb,[]);class jb{constructor(va,Qa){if(va){var db=va.ga(0),
Gb=1;this.value=({Z2:Gb}=Qa.Xqa(db,va,Gb,null,null,null)).returnValue;F.Annotations.d$a(this.value)}}}Object(h.a)(jb,"ValueQueryStepInit",null,[]);class qc{constructor(va,Qa){va&&(this.Dod=Qa.aC(va.ga(0)),this.query=Qa.vD(va.ga(1)))}}Object(h.a)(qc,"VarNameAndQueryQueryStepInit",null,[]);class ib{constructor(va,Qa){this.N4e=null;if(va){this.annotations=Qa.annotations;var db=0;this.Lx=va.ga(db);++db;this.iU=va.ga(db);++db;this.Hkd=1===va.ga(db);++db;this.pTc=1===va.ga(db);++db;var Gb=va.ga(db);++db;
if(Gb){var jc=db,Ac=db+Gb,W=db+2*Gb;db+=3*Gb;var xa=va.count-db,da=null;for(let Ua=0;Ua<Gb;++Ua){var Fa=db+va.ga(W+Ua);const cb=(Ua===Gb-1?xa:va.ga(W+Ua+1))-va.ga(W+Ua),Jb=new yb.a;Jb.qQa(va,Fa,cb);Fa=ib.s$i(va.ga(Ac+Ua),Jb,Qa);Fa.Lx=va.ga(jc+Ua);Fa.iU=Ua===Gb-1?this.iU:va.ga(jc+Ua+1);da?da.next=Fa:this.N4e=Fa;da=Fa}}}}get e6f(){return this.N4e}static s$i(va,Qa,db){switch(va){case 1:return new ne(new Pb(Qa,db));case 2:return new Ib(new Pb(Qa,db));case 3:return new Tb(new Ub(Qa,db.annotations));case 4:return new rc(new ic(Qa,
db.annotations));case 5:return new gb(new Vb(Qa,db));case 6:return new dd(new Xd(Qa,db));case 43:return new kd(new Xd(Qa,db));case 45:return new ob(new nb(Qa,db));case 49:return new ac(new pb(Qa,db));case 46:return new Oa(new jb(Qa,db.annotations));case 51:return new hc(new Wb(Qa,db));case 52:return new Yf(new Sa(Qa,db));case 53:return new fc(new Zb(db.annotations));case 13:return new gc(new ue(Qa,db));case 14:return new fb(new fg(Qa,db));case 15:return new bc;case 18:return new md(new Xd(Qa,db));
case 16:return new Fd(new qc(Qa,db));case 17:return new kb(new qc(Qa,db));case 22:return new Xc(new Lc(Qa,db));case 24:return new Fc(new ue(Qa,db));case 26:return new rb(new Sa(Qa,db));case 27:return new Fb(new Xd(Qa,db));case 30:return new wd(new Zb(db.annotations));case 31:return new pc(new Sa(Qa,db));case 32:return new fd(new ue(Qa,db));case 47:return new Pc(new Zb(db.annotations));case 48:return new zd(new Zb(db.annotations));case 34:return new Xb(new ue(Qa,db));case 35:return new cd(new ue(Qa,
db));case 36:return new ce(new ue(Qa,db));case 37:return new cc(new ue(Qa,db));case 38:return new Td(new ue(Qa,db));case 39:return new ab(new ue(Qa,db));case 40:return new hb(new ue(Qa,db));case 41:return new ad(new ue(Qa,db));case 42:return new ld(new Zb(db.annotations));default:throw Error.argument("currStepInitData");}}}Object(h.a)(ib,"AnnotationQueryInit",null,[]);class Cb{constructor(va){this.Ia=va}execute(va,Qa){this.t7(va,va?new ja("root",va,Qa):Qa)}t7(va,Qa){for(const db of this.Ia.commands)Qa=
db.execute(va,Qa)}}Object(h.a)(Cb,"AnnotationScript",null,[976]);class yc{constructor(va){this.Ia=va}execute(va,Qa){const db=this.Ia.oBj.ap(va,Qa),Gb=this.Ia.Jtk.ap(va,Qa);this.Ia.script.t7(va,new ja("Input",db,new ja("Output",Gb,Qa)));return Qa}}Object(h.a)(yc,"ApplyAnnotationScriptCommand",null,[999]);class gd{constructor(va,Qa){va&&(this.oBj=Qa.vD(va.ga(0)),this.Jtk=Qa.vD(va.ga(1)),this.script=Qa.K6a(va.ga(2)))}}Object(h.a)(gd,"ApplyScriptCommandInit",null,[]);class od{constructor(va){this.Ia=
va}execute(va,Qa){const db=this.Ia.tIe.ap(va,Qa);this.Ia.MXc.QIb(va,db,Qa,null);return Qa}}Object(h.a)(od,"AssignAnnotationScriptCommand",null,[999]);class Mc{constructor(va){this.Ia=va}execute(va,Qa){const db=this.Ia.MXc.ap(va,Qa);va=this.Ia.tIe.ap(va,Qa);db!==va&&db.gBa(va);return Qa}}Object(h.a)(Mc,"CopyAnnotationScriptCommand",null,[999]);class Rd{constructor(va){this.Ia=va}execute(va,Qa){let db=this.Ia.jee.ap(va,Qa);if(this.Ia.jee.Hkd){db=F.Annotations.sK(db);var Gb=new ja(this.Ia.Bra,null,Qa);
for(let Ac=0,W=db.items.length;Ac<W;++Ac){var jc=this.H2f(va,db.items[Ac],Gb);if(0>this.Ia.yfd)db.items[Ac]=jc;else if(({value:jc}=jc.Im(this.Ia.yfd)).returnValue)db.items[Ac]=jc;else throw Error.invalidOperation("Expected result attribute missing in Enumerate() script command");}this.Ia.jee.QIb(va,db,Qa,null)}else{Gb=new ja(this.Ia.Bra,null,Qa);for(let Ac=0,W=db.items.length;Ac<W;++Ac)this.H2f(va,db.items[Ac],Gb)}return Qa}H2f(va,Qa,db){let Gb;0>this.Ia.yfd?Gb=F.Annotations.sK(Qa):(Gb=new I.a(this.Ia.annotations),
Gb.$t(this.Ia.yfd,Qa));db.INd(Gb);this.Ia.Cei.t7(va,db);return Gb}}Object(h.a)(Rd,"EnumerateAnnotationScriptCommand",null,[999]);class ye{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.Bra=Qa.aC(va.ga(0)),this.jee=Qa.vD(va.ga(1)),this.Cei=Qa.K6a(va.ga(2)),this.yfd=va.ga(3))}}Object(h.a)(ye,"EnumerateScriptCommandInit",null,[]);class oe{constructor(va){this.Ia=va}execute(va,Qa){this.Ia.Ald.ap(va,Qa)?this.Ia.krl.t7(va,Qa):this.Ia.r4f&&this.Ia.r4f.t7(va,Qa);return Qa}}Object(h.a)(oe,"IfAnnotationScriptCommand",
null,[999]);class Bb{constructor(va,Qa){va&&(this.Ald=Qa.vD(va.ga(0)),this.krl=Qa.K6a(va.ga(1)),this.r4f=va.ga(2)?Qa.K6a(va.ga(2)):null)}}Object(h.a)(Bb,"IfScriptCommandInit",null,[]);class Ff{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.MXc=Qa.vD(va.ga(0)),this.tIe=Qa.vD(va.ga(1)))}}Object(h.a)(Ff,"LvalueAndRvalueQueryScriptCommandInit",null,[]);class pg{constructor(va){this.Ia=va}execute(va,Qa){const db=this.Ia.tIe.ap(this.Ia.MXc.ap(va,Qa),Qa);this.Ia.MXc.QIb(va,db,Qa,null);return Qa}}
Object(h.a)(pg,"ModifyAnnotationScriptCommand",null,[999]);class xf{constructor(va){this.Ia=va}execute(va,Qa){const db=new I.a(this.Ia.annotations);this.Ia.query&&db.gBa(this.Ia.query.ap(va,Qa));return Qa=new ja(this.Ia.Bra,db,Qa)}}Object(h.a)(xf,"NewAnnotationScriptCommand",null,[999]);class qe{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.Bra=Qa.aC(va.ga(0)),this.query=va.ga(1)?Qa.vD(va.ga(1)):null)}}Object(h.a)(qe,"NewScriptCommandInit",null,[]);class Oh{constructor(va){this.Ia=
va}execute(va,Qa){va=this.Ia.query.ap(va,Qa);if(this.Ia.query.iU===F.Annotations.kM)va.zed(this.Ia.eba);else for(const db of va.items)db.zed(this.Ia.eba);return Qa}}Object(h.a)(Oh,"RemoveAnnotationScriptCommand",null,[999]);class Cf{constructor(va,Qa){va&&(this.annotations=Qa.annotations,this.query=Qa.vD(va.ga(0)),this.eba=va.ga(1))}}Object(h.a)(Cf,"RemoveScriptCommandInit",null,[]);class Bg{constructor(va,Qa){if(va){var db=0,Gb=va.ga(db);++db;if(Gb){var jc=db,Ac=db+Gb;db+=2*Gb;var W=va.count-db;
this.commands=Array(Gb);for(let xa=0;xa<Gb;++xa){const da=db+va.ga(Ac+xa),Fa=(xa===Gb-1?W:va.ga(Ac+xa+1))-va.ga(Ac+xa),Ua=new yb.a;Ua.qQa(va,da,Fa);this.commands[xa]=Bg.o$i(va.ga(jc+xa),Ua,Qa)}}}}static o$i(va,Qa,db){switch(va){case 1:return new od(new Ff(Qa,db));case 2:return new pg(new Ff(Qa,db));case 3:return new Oh(new Cf(Qa,db));case 6:return new xf(new qe(Qa,db));case 7:return new Rd(new ye(Qa,db));case 8:return new oe(new Bb(Qa,db));case 9:return new Mc(new Ff(Qa,db));case 10:return new yc(new gd(Qa,
db));default:throw Error.argument("initData");}}}Object(h.a)(Bg,"AnnotationScriptInit",null,[]);var Gf=d(689);class dh{constructor(va){this.zH=va;this.wM=0}PX(){const va=this.zH.Zt(this.wM,4);this.wM+=4;return va}get OUb(){return this.zH}get offset(){return this.wM}set offset(va){this.wM=va}}Object(h.a)(dh,"ByteArrayReader",null,[]);class qg{constructor(){this.hC=null;this.RJg=this.Vy=0}ga(va){if(0>va||va>=this.Vy)throw Error.argumentOutOfRange("index");return this.hC.Zt(this.RJg+4*va,4)}get count(){return this.Vy}static Dzi(va,
Qa,db){const Gb=new qg;Gb.hC=va;Gb.RJg=Qa;Gb.Vy=db;return Gb}}Object(h.a)(qg,"ReadOnlyListOverByteArray",null,[904]);class Pf{constructor(va,Qa){this.tIg=this.bIg=!1;this.vr=this.qva=this.Kfe=this.EIg=null;try{this.vr=Qa.annotations;const db=Qa.zQa(va.ga(0)),Gb=new dh(db);if(-914743053!==Gb.PX())throw Error.argument("Input does not represent a flat lexicon");this.bIg=1===Gb.PX();this.tIg=1===Gb.PX();const jc=Gb.PX();Gb.offset+=jc;const Ac=Gb.PX();this.Kfe=Pf.fvk(Gb,Ac,this.vr);const W=Gb.PX();this.EIg=
Pf.svk(Gb,W);const xa=Gb.PX();this.qva=new Gf.a(Gb.OUb,Gb.offset);Gb.offset+=xa}catch(db){throw Error.argument("initData");}}get trie(){return this.qva}y0i(va){return"i"===va&&this.tIg?"\u0130":va.toUpperCase()}e$d(){return this.bIg}c_i(va){let Qa;Qa=new tb.a(this.vr,F.Annotations.kM);if(1!==va)if(0===va)va=new I.a(this.vr),Array.add(Qa.items,va);else if(va&1073741824){va=this.EIg[va&-1073741825];for(let Gb=0;Gb<va.length;++Gb){var db=va[Gb];db=0===db?new I.a(this.vr):this.Kfe[db-2];Array.add(Qa.items,
db)}}else Array.add(Qa.items,this.Kfe[va-2]);return{returnValue:!0,ZUj:Qa}}static fvk(va,Qa,db){if(Qa%4)throw Error.argument("reader");const Gb=qg.Dzi(va.OUb,va.offset,Qa/4);va.offset+=Qa;va=[];for(Qa=0;Qa<Gb.count;){const jc=({Z2:Qa}=db.Xqa(F.Annotations.kM,Gb,Qa,null,null,null)).returnValue;Array.add(va,jc)}return va}static svk(va,Qa){Qa=va.offset+Qa;const db=[];for(;va.offset<Qa;){const Gb=va.PX(),jc=Array(Gb);for(let Ac=0;Ac<Gb;++Ac){const W=va.PX();jc[Ac]=W}Array.add(db,jc)}return db}}Object(h.a)(Pf,
"RawFlatLexicon",null,[975]);var qd=d(680),Tf=d(681);class Pg{constructor(va){if(null==va)throw Error.argumentNull("base64String");const Qa=va.length;if(Qa%4)throw Error.argument("base64String's length must be a multiple of 4");this.Vy=.75*Qa;this.Qta=Array(Math.ceil(this.Vy/4));va.endsWith("==")?this.Vy-=2:va.endsWith("=")&&--this.Vy;let db=0;for(let Gb=0;Gb<Qa;Gb+=4){const jc=Pg.ngd[va.charCodeAt(Gb)-43]<<18|Pg.ngd[va.charCodeAt(Gb+1)-43]<<12|Pg.ngd[va.charCodeAt(Gb+2)-43]<<6|Pg.ngd[va.charCodeAt(Gb+
3)-43];let Ac=jc>>16&255;this.Qta[Math.floor(db/4)]|=Ac<<db%4*8;++db;Ac=jc>>8&255;this.Qta[Math.floor(db/4)]|=Ac<<db%4*8;++db;Ac=jc&255;this.Qta[Math.floor(db/4)]|=Ac<<db%4*8;++db}}get length(){return this.Vy}ga(va){if(0>va||va>=this.Vy)throw Error.argumentOutOfRange("i");return this.o9f(va)}Zt(va,Qa){if(0>va||0>Qa||va+Qa>this.Vy)throw Error.argument("Bad range");let db=0;for(let Gb=0;Gb<Qa;++Gb)db|=this.o9f(va+Gb)<<8*Gb;return db}$Jk(va,Qa){let db=0,Gb=0,jc=Math.floor(va/8);for(va%=8;Gb<Qa;){const Ac=
8-va>Qa-Gb?Qa-Gb:8-va,W=this.ga(jc);db|=(W>>va&~(255<<Ac))<<Gb;Gb+=Ac;++jc;va=0}return db}o9f(va){return this.Qta[Math.floor(va/4)]>>va%4*8&255}}Pg.ngd=[62,0,0,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,0,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];Object(h.a)(Pg,"ByteArray",null,[]);class Ee{constructor(va,Qa,db){this.Xx=va;this.e3j=Qa;this.y7j=db;this.sKg=Array(va.b?va.b.length:
0);this.kse=new qd.a(new Tf.a(this.zQa(this.Xx.s)));this.WW=Array(va.t.length);this.tJh=new F.Annotations(this.wQa(0),this)}get annotations(){return this.tJh}get HKi(){return this.Xx.d}U9i(){if(!(""in this.Xx.m))throw Error.argument("name","Unrecognized module");return this.C1d(this.Xx.m[""])}zQa(va){if(0>va||!this.Xx.b||va>=this.Xx.b.length)throw Error.argumentOutOfRange("byteArrayID");return this.sKg[va]||(this.sKg[va]=new Pg(this.Xx.b[va]))}aC(va){if(1>va||va>=this.Xx.t.length)throw Error.argumentOutOfRange("blobID");
if(1!==this.Xx.t[va])throw Error.argument("blobID","Requested blob is not a string");if(null==this.WW[va]){const Qa=this.wQa(va).ga(0);this.WW[va]=this.kse.aC(Qa)}return this.WW[va]}Leg(va){if(1>va||va>=this.Xx.t.length)throw Error.argumentOutOfRange("blobID");if(2!==this.Xx.t[va])throw Error.argument("blobID","Requested blob is not a Regex");if(!this.WW[va]){var Qa=this.wQa(va);const db=this.aC(Qa.ga(0));Qa=1===Qa.ga(1);this.WW[va]=new RegExp(db,Qa?"i":"")}return this.WW[va]}ydj(va){if(1>va||va>=
this.Xx.t.length)throw Error.argumentOutOfRange("blobID");if(3!==this.Xx.t[va])throw Error.argument("blobID","Requested blob is not an SRE");throw Error.notImplemented();}C1d(va){if(1>va||va>=this.Xx.t.length)throw Error.argumentOutOfRange("blobID");if(4!==this.Xx.t[va])throw Error.argument("blobID","Requested blob is not an NL module");return this.WW[va]||(this.WW[va]=this.y7j.j$i(this.wQa(va),this))}vD(va){if(1>va||va>=this.Xx.t.length)throw Error.argumentOutOfRange("blobID");if(5!==this.Xx.t[va])throw Error.argument("blobID",
"Requested blob is not an annotation query");return this.WW[va]||(this.WW[va]=new Mb(new ib(this.wQa(va),this)))}K6a(va){if(1>va||va>=this.Xx.t.length)throw Error.argumentOutOfRange("blobID");if(6!==this.Xx.t[va])throw Error.argument("blobID","Requested blob is not an annotation script");return this.WW[va]||(this.WW[va]=new Cb(new Bg(this.wQa(va),this)))}G7(va){if(1>va||va>=this.Xx.t.length)throw Error.argumentOutOfRange("blobID");if(7!==this.Xx.t[va])throw Error.argument("blobID","Requested blob is not a filter");
return this.WW[va]||(this.WW[va]=this.e3j.G7(this.wQa(va),this))}hcj(va){if(1>va||va>=this.Xx.t.length)throw Error.argumentOutOfRange("blobID");if(10!==this.Xx.t[va])throw Error.argument("blobID","Requested blob is not a raw flat lexicon");return this.WW[va]||(this.WW[va]=new Pf(this.wQa(va),this))}wQa(va){const Qa=this.Xx.n[va];va=(va<this.Xx.t.length-1?this.Xx.n[va+1]:this.Xx.n.length)-Qa;if(0>Qa||0>va||Qa+va>this.Xx.n.length)throw Error.invalidOperation("Resource contains illegal int array range ("+
Qa+","+va+")");const db=new yb.a;db.JLc(this.Xx.n,Qa,va);return db}}Object(h.a)(Ee,"ObjectFetcher",null,[866]);class xe{constructor(va,Qa,db){if(!va)throw Error.argumentNull("prediction");if(!Qa)throw Error.argumentNull("fieldNames");if(!db)throw Error.argumentNull("values");if(Qa.length!==db.length)throw Error.argument("values","fieldNames and values do not have same length");this.AUh=va;this.qab=Qa;this.ddb=db}get prediction(){return this.AUh}get E4f(){return this.qab.length}W_d(va){return 0<=va&&
va<this.qab.length?this.qab[va]:null}getValue(va){return 0<=va&&va<this.ddb.length?this.ddb[va]:null}}Object(h.a)(xe,"PredictionData",null,[]);class jh{constructor(va,Qa){if(!va)throw Error.argumentNull("predictions");if(!Qa)throw Error.argumentNull("tokenAttributes");this.R8j=va;this.ebk=Qa}n2d(){return this.R8j}D8f(){return this.ebk}}Object(h.a)(jh,"PredictionDataWithTokenAttributes",null,[]);class yg{constructor(va,Qa){this.prediction=null;this.score=0;this.prediction=va;this.score=Qa}}Object(h.a)(yg,
"PredictionWithScore",null,[]);class xc{constructor(va,Qa){if(!va)throw Error.argumentNull("predictions");if(!Qa)throw Error.argumentNull("attributes");this.BUh=va;this.QJh=Qa}n2d(){return this.BUh}D8f(){return this.QJh}}Object(h.a)(xc,"PredictionsWithTokenAttributes",null,[]);class me{constructor(va,Qa,db){if(!va)throw Error.argumentNull("attributeName");if(!Qa)throw Error.argumentNull("fieldNames");if(!db)throw Error.argumentNull("values");if(Qa.length!==db.length)throw Error.argument("values",
"fieldNames and values do not have same length");this.PJh=va;this.qab=Qa;this.ddb=db}get attributeName(){return this.PJh}get E4f(){return this.qab.length}W_d(va){return 0<=va&&va<this.qab.length?this.qab[va]:null}getValue(va){return 0<=va&&va<this.ddb.length?this.ddb[va]:null}}Object(h.a)(me,"TokenAttributes",null,[]);var Dd=d(13),Qe=d(21);class tf{constructor(va,Qa,db,Gb,jc){this.Xpc=0;this.$We=null;this.Ypc=this.lLb=0;this.jpd=this.ljb=this.aaa=this.mLb=null;this.aXe=0;this.F1a=this.ry=null;this._state=
-1;this.$$ge=this.getEnumerator;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.IJ=va;this.ZGh=this.dHh=Qa;this.YGh=this.aHh=db;this.Tpc=this.$Gh=Gb;this.Upc=this.bHh=jc}gpd(){this.Ypc=0;return this.kLb}kLb(){if(!(this.Ypc<this.Tpc))return this.Wpc;this.mLb=this.ZGh.items[this.Ypc+this.YGh];this.aaa=new I.a(this.IJ.Ia.annotations);1!==this.Tpc&&this.IJ.Ia.C4b||this.aaa.gBa(this.mLb);if(0<=this.IJ.Ia.G7c){({value:this.ljb}=this.aaa.Im(this.IJ.Ia.G7c)).returnValue?this.ljb=
this.ljb.sK():this.ljb=new tb.a(this.IJ.Ia.annotations,F.Annotations.kM);this.jpd=this.Upc.items;this.aXe=this.jpd.length;for(this.Xpc=0;this.Xpc<this.aXe;++this.Xpc)this.$We=this.jpd[this.Xpc],Array.add(this.ljb.items,this.$We);this.aaa.$t(this.IJ.Ia.G7c,this.ljb)}else 0<=this.IJ.Ia.UOe?this.aaa.$t(this.IJ.Ia.UOe,this.Upc.items[0]):0<=this.IJ.Ia.SLd?this.aaa.$t(this.IJ.Ia.SLd,!0):this.IJ.Ia.Gxg?this.Upc.items[0].rLc((va,Qa)=>this.aaa.$t(va,Qa)):(this.aaa.gBa(this.Upc.items[0]),1!==this.Tpc&&this.IJ.Ia.C4b||
(({value:this.lLb}=this.mLb.Im(this.IJ.Ia.dS)).returnValue&&this.aaa.$t(this.IJ.Ia.dS,this.lLb),({value:this.lLb}=this.mLb.Im(this.IJ.Ia.zV)).returnValue&&this.aaa.$t(this.IJ.Ia.zV,this.lLb),this.mLb.Im(this.IJ.Ia.WNa).returnValue&&this.aaa.$t(this.IJ.Ia.WNa,this.lLb)));this.ry=this.aaa;this._state=2;return this.ipd}Wpc(){this._state=3}hpd(){this.Ypc++;return this.kLb}ipd(){return 1<this.Tpc&&this.IJ.Ia.C4b?this.Wpc:this.hpd}dispose(){}getEnumerator(){return-1===this._state?(this._state=0,this):(new tf(this.IJ,
this.dHh,this.aHh,this.$Gh,this.bHh)).getEnumerator()}[Symbol.iterator](){return Object(Qe.a)(this.getEnumerator())}moveNext(){if(3===this._state)return!1;this._state?this._state=1:(this._state=1,this.F1a=this.gpd());for(;1===this._state;)this.F1a=this.F1a();return 3!==this._state}reset(){throw Error.invalidOperation("Reset() is not supported");}get_current(){return this.ry}}Object(h.a)(tf,"$$sm_Microsoft$NaturalLanguage$Runtime$ScriptSharp$NLModules$FlatLexiconNLModule$CreateNewTokenAndApplyLexicalAnalyses",
null,[106,141,142]);class Rb{constructor(va,Qa,db){this.U9b=this.SJg=0;this.qyb=null;this.vse=this.xge=this.dyb=this.kZc=this.yhe=0;this.i_c=!1;this.Soe=va;this.Mse=Qa;this.l8j=db}kdg(){null===this.qyb&&({eyh:this.qyb,$mg:this.yhe,length:this.kZc,$Qi:va}=this.Soe.vhg(this.Mse.items[this.U9b],this.l8j),this.i_c=va||this.i_c);if(this.dyb<this.kZc){var va=this.qyb.charAt(this.yhe+this.dyb);++this.dyb;return{returnValue:!0,ch:va}}if(this.U9b===this.Mse.items.length-1)return{returnValue:!1,ch:"\x00"};
++this.U9b;this.dyb=0;this.qyb=null;return{returnValue:!0,ch:" "}}AFe(va,Qa){this.dyb===this.kZc&&this.qyb&&(this.vse=Qa,this.xge=this.U9b-this.SJg+1)}$Vk(va){if(0>va||va>=this.Mse.items.length)throw Error.argumentOutOfRange("iToken");this.U9b=this.SJg=va;this.qyb=null;this.xge=this.dyb=this.kZc=this.yhe=0;this.vse=-1;this.i_c=!1}e9i(){return{Qhi:this.xge,vTj:this.vse,NQi:this.i_c}}}Object(h.a)(Rb,"TriePrefixVisitor",null,[954]);class Jc{constructor(va){this.Ia=va}execute(va){if(!({value:db}=va.Im(this.Ia.oqa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");
let Qa;({value:Qa}=va.Im(this.Ia.HAa)).returnValue||(Qa=null);var db=this.KZi(db,Qa);va=F.Annotations.sK(va);va.$t(this.Ia.oqa,db);return va}KZi(va,Qa){let db=null;const Gb=this.Ia.flatLexicon.trie,jc=new Rb(this,va,Qa);let Ac=null;this.Ia.flatLexicon.e$d()&&(Ac=Object(Dd.a)(this.Ia.flatLexicon,this.Ia.flatLexicon.y0i,"getCaseInsensitiveForm"));let W=0,xa;var da;let Fa;for(;W<va.items.length;){const Ua=va.items[W];jc.$Vk(W);Gb.$Fh(jc,Ac);({Qhi:xa,vTj:da,NQi:Fa}=jc.e9i());if(0<xa){({ZUj:da}=this.Ia.flatLexicon.c_i(da));
for(let cb of this.aBi(va,W,xa,da)){1<xa&&this.Ia.C4b&&this.GBi(va,Qa,W,Ua,xa,Fa,cb);if(!db)for(db=new tb.a(this.Ia.annotations,F.Annotations.kM),da=0;da<W;++da)Array.add(db.items,va.items[da]);Array.add(db.items,cb)}W+=xa}else db&&Array.add(db.items,Ua),++W}return db||va}GBi(va,Qa,db,Gb,jc,Ac,W){if(Ac)Ac=!0;else if(this.Ia.nxg){Ac=!1;var xa=-1;for(var da=0;da<jc;da++){var Fa=va.items[db+da];let Gc;var Ua=void 0;if(!({value:Gc}=Fa.Im(this.Ia.dS)).returnValue||!({value:Ua}=Fa.Im(this.Ia.zV)).returnValue)throw Error.invalidOperation("FlatLexiconNLModule: token unexpectedly missing one or more required Span.* annotations");
if(0<da){if(Gc>xa+1){Ac=!0;break}if(0>xa||null===Qa||xa>=Qa.length)throw Error.invalidOperation("FlatLexiconNLModule: token with unexpectedly out of range Span.StartIndex/Span.Length annotations");if(" "!==Qa.charAt(xa)){Ac=!0;break}}xa=Gc+Ua}}else Ac=!1;if(Ac){Ua=new Sys.StringBuilder;for(Ac=0;Ac<jc;++Ac)({eyh:xa,$mg:da,length:Fa}=this.vhg(va.items[db+Ac],Qa)),0<Ac&&Ua.append(" "),Ua.append(xa.substr(da,Fa));W.$t(this.Ia.WNa,Ua.toString())}va=va.items[db+jc-1];let cb,Jb;({value:Gb}=Gb.Im(this.Ia.dS)).returnValue&&
({value:cb}=va.Im(this.Ia.dS)).returnValue&&({value:Jb}=va.Im(this.Ia.zV)).returnValue?(W.$t(this.Ia.dS,Gb),W.$t(this.Ia.zV,cb+Jb-Gb)):(W.zed(this.Ia.dS),W.zed(this.Ia.zV))}aBi(va,Qa,db,Gb){return new tf(this,va,Qa,db,Gb)}vhg(va,Qa){let db,Gb;if(({value:db}=va.Im(this.Ia.WNa)).returnValue)Gb=!0,Qa=0,va=db.length;else{Gb=!1;if(null===Qa)throw Error.argument("parentText","Expected parameter NLMod.ParentText not found");db=Qa;if(!({value:Qa}=va.Im(this.Ia.dS)).returnValue)throw Error.argument("Token missing required Span.StartIndex annotation",
"token");if(!({value:va}=va.Im(this.Ia.zV)).returnValue)throw Error.argument("Token missing required Span.Length annotation","token");if(0>Qa||0>va||Qa+va>db.length)throw Error.argument("Token start/length values out of range","token");}return{eyh:db,$mg:Qa,length:va,$Qi:Gb}}}Object(h.a)(Jc,"FlatLexiconNLModule",null,[919]);class Qc{constructor(va,Qa){this.SLd=this.G7c=this.UOe=this.WNa=this.zV=this.dS=this.HAa=this.oqa=0;this.Gxg=this.nxg=this.C4b=!1;this.flatLexicon=null;this.annotations=Qa.annotations;
let db=0;try{this.oqa=va.ga(db),++db,this.HAa=va.ga(db),++db,this.dS=va.ga(db),++db,this.zV=va.ga(db),++db,this.WNa=va.ga(db),++db,this.UOe=va.ga(db),++db,this.G7c=va.ga(db),++db,this.SLd=va.ga(db),++db,this.C4b=1===va.ga(db),++db,this.nxg=1===va.ga(db),++db,this.Gxg=1===va.ga(db),++db,this.flatLexicon=Qa.hcj(va.ga(db))}catch(Gb){throw Error.argument("initData");}}}Object(h.a)(Qc,"FlatLexiconNLModuleInit",null,[]);class Ph{constructor(){this.B3b=0;this.uXd=null;this.xkc=0}}Object(h.a)(Ph,"FeatureGenStackRec",
null,[]);class ng{constructor(va){this.LSe=Array(va);this.QJb=Array(va);this.ZPe=[];this.Bvh=[]}}Object(h.a)(ng,"TokenStringLattice",null,[]);const se=(va,Qa,db)=>{for(let Gb=0;Gb<va.length;Gb++)db=Qa(db,va[Gb]);return db},pf=(va,Qa)=>{const db=Array(va.length);for(let Gb=0;Gb<va.length;Gb++)db[Gb]=Qa(va[Gb]);return db},$d=(va,Qa)=>{Qa=Array(Math.min(Qa,va.length));for(let db=0;db<Qa.length;db++)Qa[db]=va[db];return Qa},Ye=(va,Qa)=>{const db=[];for(const Gb of va)Qa(Gb)&&Array.add(db,Gb);return db};
class Kd{constructor(va,Qa){this.key=va;this.value=Qa}}Object(h.a)(Kd,"KeyValuePair",null,[]);const Yd=(va,Qa)=>({returnValue:Qa in va,value:va[Qa]}),Zf=va=>{const Qa=[];for(let db in va){const Gb=new Kd(db,va[db]);Array.add(Qa,Gb)}return Qa};class ef{constructor(va){this.uhg=this.nij;this.Ia=va;this.i2c=this.Hoe=this.Ioe=0;for(const Qa of this.Ia.vKc)this.Ioe=Math.max(this.Ioe,Qa.yBe),this.Hoe=Math.max(this.Hoe,Qa.$Ae),this.i2c=Math.max(this.i2c,Qa.EIb.length)}get mTi(){return this.Ia.qmd.trie}execute(va){if(!va)throw Error.argumentNull("input");
let Qa,db;({tokens:Qa,ZTj:db}=this.oij(va));let Gb=null,jc=null,Ac={};if(this.Ia.V4b){Qa=F.Annotations.sK(Qa);for(var W=0;W<Qa.items.length;++W)Qa.items[W]=F.Annotations.sK(Qa.items[W])}else({w4f:jc,returnValue:Gb}=this.Jdg(va,Ac));W=Array(this.i2c);const xa=Array(this.i2c);for(var da=0;da<xa.length;++da)xa[da]=new Ph;for(da=-this.Ioe;da<Qa.items.length+this.Hoe;++da){let Fa=null;this.Ia.V4b&&(Fa=Qa.items[da],Ac={},{w4f:jc,returnValue:Gb}=this.Jdg(Fa,Ac));for(const Ua of this.Ia.vKc){if(0>da&&-da>
Ua.yBe||da>=Qa.items.length&&da-Qa.items.length+1>Ua.$Ae)continue;let cb=!0;for(let Jb=0;Jb<Ua.EIb.length;++Jb){const Gc=da+Ua.EIb[Jb];W[Jb]=Gc;if(0>Gc?0>this.Ia.zBe:Gc>=Qa.items.length?0>this.Ia.aBe:!db.QJb[Gc]){cb=!1;break}}cb&&({HEi:Gb,IEi:jc}=this.yCj(Ua,db,Gb,jc,Ac,xa,W))}this.Ia.V4b&&(Fa.$t(this.Ia.PDa?this.Ia.Wob:this.Ia.Uob,Gb),this.Ia.PDa&&Fa.$t(this.Ia.Vob,jc))}va=F.Annotations.sK(va);this.Ia.V4b?va.$t(this.Ia.oqa,Qa):(va.$t(this.Ia.PDa?this.Ia.Wob:this.Ia.Uob,Gb),this.Ia.PDa&&va.$t(this.Ia.Vob,
jc));return va}oij(va){let Qa,db;if(!va||!({value:Qa}=va.Im(this.Ia.oqa)).returnValue)throw Error.argument("Expected input parameter NLMod.Tokens not found");let Gb;({value:Gb}=va.Im(this.Ia.HAa)).returnValue||(Gb="");db=new ng(Qa.items.length);const jc=Ye(this.Ia.PSe,Ac=>!Ac.U3b||Ac.U3b.isMatch(va,null));for(let Ac=0;Ac<Qa.items.length;++Ac){const W=Qa.items[Ac];let xa=null;db.LSe[Ac]=db.ZPe.length;let da=db.QJb[Ac]=0;for(const Fa of jc)0<Fa.mdc&&db.QJb[Ac]+da>=Fa.mdc||Fa.ioc&&!Fa.ioc.isMatch(W,
null)||({joc:xa,wVb:da}=Fa.apply(this,W,Ac,db,Gb,xa,da))}return{tokens:Qa,ZTj:db}}yCj(va,Qa,db,Gb,jc,Ac,W){let xa=0;Ac[0].B3b=-1;for(Ac[0].uXd=va.Nih;;){var da=W[xa],Fa=0>da||da>=Qa.QJb.length?1:Qa.QJb[da];let Jb=!1;for(;Ac[xa].B3b<Fa-1;){++Ac[xa].B3b;var Ua=void 0,cb=void 0;0>da?(Ua=this.Ia.zBe,cb=1):da>=Qa.LSe.length?(Ua=this.Ia.aBe,cb=1):(cb=Qa.LSe[da]+Ac[xa].B3b,Ua=Qa.ZPe[cb],cb=Qa.Bvh[cb]);Ac[xa].xkc=cb*(xa?Ac[xa-1].xkc:va.score);if(({value:Ua}=Yd(Ac[xa].uXd,Ua.toString())).returnValue){xa===
va.EIb.length-1?(da=Ua,Ac[xa].xkc&&(({value:Fa}=Yd(jc,da.toString())).returnValue||(Fa=-1),0>Fa&&(db=F.Annotations.sK(db),Array.add(db.items,da)),this.Ia.PDa&&(Gb=F.Annotations.sK(Gb),0>Fa?Array.add(Gb.items,Ac[xa].xkc):Gb.items[Fa]+=Ac[xa].xkc),0>Fa&&(this.Ia.sAg||this.Ia.PDa)&&(jc[da.toString()]=db.items.length-1))):(++xa,Ac[xa].B3b=-1,Ac[xa].uXd=Ua);Jb=!0;break}}if(!Jb&&(--xa,0>xa))break}return{HEi:db,IEi:Gb}}Jdg(va,Qa){let db;if(({value:db}=va.Im(this.Ia.PDa?this.Ia.Wob:this.Ia.Uob)).returnValue)for(let Gb=
0;Gb<db.items.length;++Gb)Qa[db.items[Gb].toString()]=Gb;else db=new tb.a(this.Ia.annotations,F.Annotations.Mna);if(this.Ia.PDa){if(({value:Qa}=va.Im(this.Ia.Vob)).returnValue||(Qa=new tb.a(this.Ia.annotations,F.Annotations.O$)),Qa.items.length!==db.items.length)throw Error.argument("Length mismatch between NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureValues on item "+this.Ia.annotations.a1(F.Annotations.kM,va));}else Qa=null;return{returnValue:db,w4f:Qa}}get jpl(){return this.Ia.qmd}nij(va,
Qa){var db;if(({value:db}=Qa.Im(this.Ia.WNa)).returnValue)va=db;else{if(!({value:db}=Qa.Im(this.Ia.dS)).returnValue)throw Error.argument("Token is missing Span.StartIndex");if(!({value:Qa}=Qa.Im(this.Ia.zV)).returnValue)throw Error.argument("Token is missing Span.Length");if(0>db||0>Qa||db+Qa>va.length)throw Error.argument("Token indices are out of range");va=va.substr(db,Qa)}return va}}Object(h.a)(ef,"NGramNLModule",null,[919,951]);class Ke{constructor(va){this.EIb=null;this.score=this.$Ae=this.yBe=
0;this.Nih=null;if(va){var Qa=0;try{if(va.ga(Qa)!==Ke.b4a)throw Error.argument("initData","Input does not represent a feature template");++Qa;const db=va.ga(Qa);++Qa;this.EIb=Array(db);for(let Gb=0;Gb<db;++Gb)this.EIb[Gb]=va.ga(Qa),++Qa;this.yBe=va.ga(Qa);++Qa;this.$Ae=va.ga(Qa);++Qa;this.score=va.ga(Qa);++Qa;this.Nih=({Xmg:Qa}=Ke.fch(va,Qa)).returnValue}catch(db){throw Error.argument("initData");}}}static fch(va,Qa){const db=va.ga(Qa);++Qa;const Gb={};for(let jc=0;jc<db;++jc){const Ac=va.ga(Qa);
++Qa;va.ga(Qa)?Gb[Ac.toString()]=({Xmg:Qa}=Ke.fch(va,Qa)).returnValue:(++Qa,Gb[Ac.toString()]=va.ga(Qa),++Qa)}return{returnValue:Gb,Xmg:Qa}}}Ke.b4a=240803228;Object(h.a)(Ke,"FeatureTemplate",null,[974]);var gi=d(538);class Rf{constructor(va,Qa){this.PDa=this.sAg=this.V4b=!1;this.WNa=this.zV=this.dS=this.oqa=this.HAa=this.Vob=this.Wob=this.Uob=0;this.qmd=null;this.aBe=this.zBe=0;this.vKc=this.PSe=null;if(va){this.annotations=Qa.annotations;var db=0;try{this.V4b=1===va.ga(db);++db;this.sAg=1===va.ga(db);
++db;this.PDa=1===va.ga(db);++db;this.Uob=va.ga(db);++db;this.Wob=va.ga(db);++db;this.Vob=va.ga(db);++db;this.HAa=va.ga(db);++db;this.oqa=va.ga(db);++db;this.dS=va.ga(db);++db;this.zV=va.ga(db);++db;this.WNa=va.ga(db);++db;this.qmd=this.Ovk(Qa.zQa(va.ga(db)));++db;this.zBe=va.ga(db);++db;this.aBe=va.ga(db);++db;const Gb=va.ga(db);++db;this.PSe=Array(Gb);for(let Ac=0;Ac<Gb;++Ac){const W=va.ga(db);++db;const xa=this.qmd.trie,da=new yb.a;da.qQa(va,db,W);this.PSe[Ac]=this.Svk(da,Qa,xa);db+=W}const jc=
va.ga(db);++db;this.vKc=Array(jc);for(Qa=0;Qa<jc;++Qa){const Ac=va.ga(db);++db;const W=new yb.a;W.qQa(va,db,Ac);this.vKc[Qa]=this.tvk(W);db+=Ac}}catch(Gb){throw Error.argument("initData");}}}Ovk(va){return new qd.a(new Tf.a(va))}Svk(va,Qa,db){return gi.a.create(va,Qa,db)}tvk(va){return new Ke(va)}}Object(h.a)(Rf,"NGramNLModuleInit",null,[]);class Uf{constructor(va){this.Ia=va}execute(va){if(!va)throw Error.argumentNull("input");va=va.clone();this.Ia.script.execute(va,null);return va}}Object(h.a)(Uf,
"ScriptNLModule",null,[919]);class Ed{constructor(va,Qa){va&&(this.script=Qa.K6a(va.ga(0)))}}Object(h.a)(Ed,"ScriptNLModuleInit",null,[]);const vg=va=>{va=pf(va,Qa=>Qa*Qa);return Math.sqrt(se(va,(Qa,db)=>Qa+db,0))},Jd=va=>se(va,(Qa,db)=>Qa>db?Qa:db,va[0]);class Ie{constructor(va){this.Ia=va}execute(va){if(!va)throw Error.argumentNull("input");var Qa=[],db=[];this.iri(va,Qa,db);this.U8h(Qa,db);const Gb={};for(let Ac=0;Ac<Qa.length;++Ac){var jc=Qa[Ac];const W=this.Ia.usg.ga(jc);jc=this.Ia.vsg.ga(jc);
for(let xa=0;xa<jc;++xa){const da=this.Ia.toi.ga(this.Ia.pPf.ga(W+xa)),Fa=this.Ia.qPf.ga(W+xa);let Ua;({value:Ua}=Yd(Gb,da)).returnValue||(Ua=0);Gb[da]=Ua+db[Ac]*Fa}}db=Zf(Gb);db.sort((Ac,W)=>{var xa=Ac.value,da=W.value;(xa=-(xa>da?1:xa<da?-1:0))||(xa=Ac.key.localeCompare(W.key));return xa});Qa=new tb.a(this.Ia.annotations,F.Annotations.kM);for(const Ac of $d(db,this.Ia.Ldk))db=new I.a(this.Ia.annotations),db.$t(this.Ia.Eci,Ac.key),db.$t(this.Ia.Gci,Ac.value),Array.add(Qa.items,db);va.$t(this.Ia.Fci,
Qa);return va}iri(va,Qa,db){if(({value:va}=va.Im(this.Ia.Dci)).returnValue){let Gb;if(({value:Gb}=va.Im(this.Ia.Wob)).returnValue){let jc;if(!({value:jc}=va.Im(this.Ia.Vob)).returnValue||Gb.items.length!==jc.items.length)throw Error.argument("NLMod.FloatingPointFeatureIDs and NLMod.FloatingPointFeatureIDValues are mismatched");this.lFc(Gb,jc,Qa,db)}if(({value:Gb}=va.Im(this.Ia.Ici)).returnValue){let jc;if(!({value:jc}=va.Im(this.Ia.Jci)).returnValue||Gb.items.length!==jc.items.length)throw Error.argument("NLMod.FloatingPointFeatureNames and NLMod.FloatingPointFeatureValues are mismatched");
this.lFc(Gb,jc,Qa,db)}({value:Gb}=va.Im(this.Ia.Uob)).returnValue&&this.lFc(Gb,null,Qa,db);({value:Gb}=va.Im(this.Ia.Hci)).returnValue&&this.lFc(Gb,null,Qa,db)}}lFc(va,Qa,db,Gb){for(let Ac=0;Ac<va.items.length;++Ac){var jc=void 0;va.WT===F.Annotations.tY?({value:jc}=Yd(this.Ia.J_f,va.items[Ac])).returnValue||(jc=-1):(jc=va.items[Ac],jc=jc>=this.Ia.rue&&jc<=this.Ia.fek?this.Ia.Bve?this.Ia.Bve.ga(jc-this.Ia.rue)-1:jc-this.Ia.rue:-1);if(0<=jc){let W;W=Qa?Qa.items[Ac]:1;0<W&&(Array.add(db,jc),Array.add(Gb,
W))}}}U8h(va,Qa){if(va.length){switch(this.Ia.TEk){case 0:break;case 1:for(var db=0;db<Qa.length;++db)Qa[db]=1+Math.log(Qa[db]);break;case 2:db=Jd(Qa);for(let Gb=0;Gb<Qa.length;++Gb)Qa[Gb]=.5+Qa[Gb]/db*.5;break;case 3:for(db=0;db<Qa.length;++db)Qa[db]=1;break;default:throw Error.notImplemented();}if(this.Ia.GSc)for(db=0;db<Qa.length;++db)Qa[db]*=this.Ia.GSc.ga(va[db]);va=vg(Qa);for(db=0;db<Qa.length;++db)Qa[db]/=va}}}Object(h.a)(Ie,"TfIdfRankerNLModule",null,[919]);class gf{constructor(va,Qa=0){if(!va)throw Error.argumentNull("byteArray");
this.RI=Qa;if(604662927!==va.Zt(this.RI+0,4))throw Error.argument("byteArray","Input does not represent a compact int array");this.Mk=va.Zt(this.RI+4,4);this.vFg=va.Zt(this.RI+8,4);this.d1j=va}ga(va){if(0>va||va>=this.count)throw Error.argumentOutOfRange("index");return this.d1j.$Jk(8*this.RI+96+va*this.vFg,this.vFg)}get count(){return this.Mk}}Object(h.a)(gf,"CompactIntArray",null,[904]);const eh=(va,Qa)=>{Qa=Array(Qa);for(let Ac=0;Ac<Qa.length;Ac++){var db=Ac,Gb=va.PX(),jc=1===(Gb>>31&1)?-1:1;const W=
Gb&8388607;Gb=Gb>>23&255;256===Gb+1?jc=W?Number.NaN:1===jc?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:Gb?(Gb-=127,jc=jc*rg(W,1)*Math.pow(2,Gb)):jc=jc*rg(W,0)*Math.pow(2,-126);Qa[db]=jc}return Qa},rg=(va,Qa)=>{let db=0;for(let Gb=0;23>Gb;Gb++)db+=(va>>22-Gb&1)/Math.pow(2,Gb+1);return Qa+db};class Cg{constructor(va,Qa){this.Bve=null;this.NXg=0;this.vsg=this.usg=this.GSc=null;this.MXg=0;this.qPf=this.pPf=null;this.annotations=Qa.annotations;let db=0;this.Hci=va.ga(db);++db;this.Uob=va.ga(db);
++db;this.Ici=va.ga(db);++db;this.Jci=va.ga(db);++db;this.Wob=va.ga(db);++db;this.Vob=va.ga(db);++db;this.Dci=va.ga(db);++db;this.Fci=va.ga(db);++db;this.Eci=va.ga(db);++db;this.Gci=va.ga(db);++db;var Gb=va.ga(db);++db;var jc=Array(Gb);for(var Ac=0;Ac<Gb;++Ac)jc[Ac]=Qa.aC(va.ga(db)),++db;this.toi=yb.a.ARd(jc);this.Ldk=va.ga(db);++db;this.TEk=va.ga(db);++db;Gb=va.ga(db);++db;this.J_f={};for(jc=0;jc<Gb;++jc){Ac=Qa.aC(va.ga(db));++db;const W=va.ga(db);++db;this.J_f[Ac]=W}this.rue=va.ga(db);++db;this.fek=
va.ga(db);++db;Gb=va.ga(db);++db;0<Gb&&(Gb=Qa.zQa(va.ga(db)),++db,this.Bve=this.pad(new dh(Gb)));++db;va=Qa.zQa(va.ga(db));this.Evk(va)}pad(va){return new gf(va.OUb,va.offset)}Evk(va){try{const Qa=new dh(va);this.NXg=Qa.PX();1===Qa.PX()?this.GSc=yb.a.ARd(eh(Qa,this.NXg)):this.GSc=null;const db=Qa.PX();this.usg=this.pad(Qa);Qa.offset+=db;const Gb=Qa.PX();this.vsg=this.pad(Qa);Qa.offset+=Gb;this.MXg=Qa.PX();const jc=Qa.PX();this.pPf=this.pad(Qa);Qa.offset+=jc;this.qPf=yb.a.ARd(eh(Qa,this.MXg))}catch(Qa){throw Error.argument("byteReader");
}}}Object(h.a)(Cg,"TfIdfRankerNLModuleInit",null,[]);class kh{constructor(va,Qa,db,Gb){this.Nze=va;this.R5f=db;this.tokens=Gb;this.j7=Qa;this.TGb=-1;this.ahd=0}}Object(h.a)(kh,"TokenizerData",null,[]);class De{constructor(va){this.Ia=va}execute(va){if(!va)throw Error.argumentNull("input");if(!({value:Gb}=va.Im(this.Ia.HAa)).returnValue)throw Error.argument("input","Expected to see annotation for attribute NLMod.ParentText");let Qa;({value:Qa}=va.Im(this.Ia.dS)).returnValue||(Qa=0);let db;({value:db}=
va.Im(this.Ia.zV)).returnValue||(db=Gb.length-Qa);if(0>Qa||Qa>Gb.length)throw Error.argument("input","Start index out of range");if(0>db||db>Gb.length)throw Error.argument("input","Length out of range");if(Qa+db>Gb.length)throw Error.argument("input","Bad start-length range");var Gb=new kh(Gb,Qa,Qa+db,new tb.a(this.Ia.annotations,F.Annotations.kM));this.kpl(Gb);va=va.isReadOnly?va.clone():va;va.$t(this.Ia.oqa,Gb.tokens);return va}kpl(va){for(;va.j7<va.R5f;){if(this.Ia.U4d){var Qa=this.Ia.U4d.eEg(va.Nze,
va.j7,va.R5f-va.j7,null);!Qa.succeeded&&Qa.YWg&&(Qa=Qa.YWg);if(Qa.succeeded){this.R0g(va,Qa.length,this.Ia.$ig);va.j7+=Qa.length;continue}}Qa=va.Nze.substr(va.j7);let db=-1,Gb=-1,jc=-1;for(let Ac=0;Ac<this.Ia.fgd.length;++Ac){const W=this.Ia.fgd[Ac].exec(Qa);W&&0<W[1].length&&(0>db||W[0].length>Gb)&&(db=Ac,Gb=W[0].length,jc=W[1].length)}0<=db?(this.R0g(va,jc,this.Ia.kIe[db]),va.j7+=jc):va.j7+=1}}R0g(va,Qa,db){if(this.Ia.czg)db!==De.uji&&(0>va.TGb&&(va.TGb=va.j7),va.ahd=va.j7+Qa-va.TGb,db===De.tji&&
(0<=va.TGb&&0<va.ahd&&(Qa=new I.a(this.Ia.annotations),Qa.$t(this.Ia.dS,va.TGb),Qa.$t(this.Ia.zV,va.ahd),Qa.$t(this.Ia.cLd,De.vji),Qa.$t(this.Ia.HAa,va.Nze),Array.add(va.tokens.items,Qa)),va.TGb=-1,va.ahd=0));else{let Gb=new I.a(this.Ia.annotations);Gb.$t(this.Ia.dS,va.j7);Gb.$t(this.Ia.zV,Qa);Gb.$t(this.Ia.cLd,db);Array.add(va.tokens.items,Gb)}}}De.uji="GAP";De.tji="EOS_CHUNK";De.vji="SENTENCE";Object(h.a)(De,"TokenizerNLModule",null,[919]);class Nd{constructor(va,Qa){this.zV=this.dS=this.cLd=this.oqa=
this.HAa=0;this.czg=!1;this.kIe=this.fgd=this.$ig=this.U4d=null;if(va){this.annotations=Qa.annotations;var db=0;try{this.HAa=va.ga(db);++db;this.oqa=va.ga(db);++db;this.cLd=va.ga(db);++db;this.dS=va.ga(db);++db;this.zV=va.ga(db);++db;this.czg=1===va.ga(db);++db;var Gb=va.ga(db);++db;0<Gb&&(this.U4d=Qa.C1d(Gb).mTi);this.$ig=va.ga(db)?Qa.aC(va.ga(db)):"";++db;const jc=va.ga(db);++db;this.fgd=Array(jc);this.kIe=Array(jc);for(Gb=0;Gb<jc;++Gb)this.fgd[Gb]=new RegExp(Qa.aC(va.ga(db))),++db,this.kIe[Gb]=
Qa.aC(va.ga(db)),++db}catch(jc){throw Error.argument("initData");}}}}Object(h.a)(Nd,"TokenizerNLModuleInit",null,[]);class Od{constructor(va){this.Ia=va}execute(va){if(!va)throw Error.argumentNull("input");let Qa;if(!({value:Qa}=va.Im(this.Ia.rJf)).returnValue)throw Error.argument("Expected input parameter NLMod.StringToTransliterate not found");for(const db of this.Ia.CPe)Qa=db.apply(Qa);va=F.Annotations.sK(va);va.$t(this.Ia.sJf,Qa);return va}static CKd(va,Qa){const db=new Sys.StringBuilder;for(let Gb=
0;Gb<va.length;++Gb)db.append(Qa(va.substr(Gb,1)));return db.toString()}}Object(h.a)(Od,"TransliteratorNLModule",null,[919]);class mj{constructor(va){va&&(this.style=va.ga(0))}apply(va){return Od.CKd(va,Qa=>mj.imi(Qa,this.style))}static imi(va,Qa){switch(Qa){case 0:return va.toLowerCase();case 1:return"I"===va?"\u0131":va.toLowerCase();case 2:return va.toUpperCase();case 3:return"i"===va?"\u0130":va.toUpperCase();default:throw Error.invalidOperation();}}}mj.d4a=0;Object(h.a)(mj,"ChangeCaseTransliterationStage",
null,[955]);class qi{apply(va){return Od.CKd(va,qi.aql)}static aql(va){const Qa=va.charCodeAt(0);return 65281<=Qa&&65374>=Qa?String.fromCharCode(Qa-65248):va}}qi.d4a=4;Object(h.a)(qi,"LatinFullWidthToHalfWidthTransliterationStage",null,[955]);class Vf{constructor(va,Qa){va&&(this.regex=Qa.Leg(va.ga(0)),this.lUk=Qa.aC(va.ga(1)))}apply(va){return va.replace(this.regex,this.lUk)}}Vf.d4a=1;Object(h.a)(Vf,"RegexReplaceTransliterationStage",null,[955]);class Ai{constructor(va,Qa){if(va){var db=va.ga(0),
Gb=Qa.aC(va.ga(1)),jc=new gf(Qa.zQa(va.ga(2)));va=0>va.ga(3)?null:new gf(Qa.zQa(va.ga(3)));this.tQe={};for(Qa=0;Qa<db;++Qa)this.tQe[Gb.charAt(Qa).toString()]=Gb.substr(jc.ga(Qa),va?va.ga(Qa):1)}}apply(va){return Od.CKd(va,Qa=>Qa in this.tQe?this.tQe[Qa]:Qa)}}Ai.d4a=2;Object(h.a)(Ai,"SingleCharSubstitutionsTransliterationStage",null,[955]);class $g{constructor(va,Qa){this.sJf=this.rJf=0;this.CPe=null;if(va){this.annotations=Qa.annotations;var db=0;try{this.rJf=va.ga(db);++db;this.sJf=va.ga(db);++db;
const Gb=va.ga(db);++db;this.CPe=Array(Gb);for(let jc=0;jc<Gb;++jc){const Ac=va.ga(db);++db;const W=va.ga(db);++db;const xa=new yb.a;xa.qQa(va,db,W);db+=W;this.CPe[jc]=this.Nvk(Ac,xa,Qa)}}catch(Gb){throw Error.argument("initData");}}}Nvk(va,Qa,db){switch(va){case mj.d4a:return new mj(Qa);case Vf.d4a:return new Vf(Qa,db);case Ai.d4a:return new Ai(Qa,db);case qi.d4a:return new qi;default:throw Error.invalidOperation("Unrecognized or unsupported transliteration stage flavor");}}}Object(h.a)($g,"TransliteratorNLModuleInit",
null,[]);class Ch{j$i(va,Qa){const db=va.ga(0),Gb=new yb.a;Gb.qQa(va,1,va.count-1);switch(db){case 0:return new Uf(new Ed(Gb,Qa));case 2:return new De(new Nd(Gb,Qa));case 3:return new ef(new Rf(Gb,Qa));case 5:return new Jc(new Qc(Gb,Qa));case 9:return new Od(new $g(Gb,Qa));case 10:return new Ie(new Cg(Gb,Qa));default:throw Error.notImplemented();}}}Object(h.a)(Ch,"NLModuleFactory",null,[871]);class nf{constructor(va){this.pji=";";if(!va)throw Error.argumentNull("resource");this.a4=new Ee(va,new Bc,
new Ch);this.Soe=this.a4.U9i();this.lFg=this.a4.annotations.k0b("Text.Text");this.jFg=this.a4.annotations.k0b("Classification.Predictions");this.bge=this.a4.annotations.k0b("Classification.PredictionString");this.kFg=this.a4.annotations.k0b("Classification.Probability");this.M0j=this.a4.annotations.k0b("NLMod.Tokens");if(0>this.lFg||0>this.jFg||0>this.bge||0>this.kFg)throw Error.argument("resourceObj","Resource does not represent a ranker");}P_i(){const va=[];this.hWd(void 0,this.e9f(va),null);return va}R_i(va,
Qa){const db=[],Gb=[];this.hWd(va,this.e9f(db),(jc,Ac)=>{const W=this.a4.annotations.S8f(jc),xa=[],da=[];Qa&&Qa.length&&-1===Array.indexOf(Qa,W)||(jc=this.a4.annotations.getAttributeType(jc),this.o7g(jc,Ac,xa,da),Ac=new me(W,xa,da),Array.add(Gb,Ac))});return new xc(db,Gb)}Q_i(va){const Qa=[];this.hWd(va,db=>{let Gb;if(({value:Gb}=db.Im(this.bge)).returnValue){let jc;({value:jc}=db.Im(this.kFg)).returnValue&&Array.add(Qa,new yg(Gb,jc))}},null);return Qa}hWd(va,Qa,db){var Gb=new I.a(this.a4.annotations);
Gb.$t(this.lFg,va);va=this.Soe.execute(Gb);if(({value:Gb}=va.Im(this.jFg)).returnValue)for(const jc of Gb.items)Qa(jc);if(db&&({value:Qa}=va.Im(this.M0j)).returnValue)for(const jc of Qa.items)jc.rLc(db)}o7g(va,Qa,db,Gb){if(F.Annotations.tB(va))for(var jc of Qa.items)this.o7g(Qa.WT,jc,db,Gb);else if(F.Annotations.yBh(va)){jc=this.a4.annotations.vdg(va);for(let Ac=0;Ac<jc;Ac++)Array.add(db,this.a4.annotations.ugg(va,Ac)),Array.add(Gb,this.a4.annotations.a1(this.a4.annotations.y7a(va,Ac),Qa.LQa(Ac)))}else Array.add(db,
"VALUE"),Array.add(Gb,this.a4.annotations.a1(va,Qa))}e9f(va){return Qa=>{let db;({value:db}=Qa.Im(this.bge)).returnValue&&Array.add(va,this.xbj(db))}}xbj(va){const Qa=va.indexOf(this.pji);return 0>Qa?va:va.substring(0,Qa)}}Object(h.a)(nf,"Ranker",null,[]);var qf=d(325),Wi=d(373),Tg=d(158),rd=d(118),ze=d(105),xh=d(25);class Qj{constructor(va,Qa){this.Eef="";this.YBd=null;this.ZBd=!1;this.eaa=null;this.SJh=["TellMe.TellMeParamCollection"];this.vb=va;this.wza=Qa;this.vb.K3a&&(this.eaa=null)}get Ocd(){if(!this.YBd&&
!this.ZBd){let va=null;try{va=window.TellMeModel}catch(Qa){if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("QueryRanker","TellMeModel not found. Exception: "+Qa)}if(va){try{this.YBd=new nf(va)}catch(Qa){if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("QueryRanker","Exception thrown while loading classifier. Exception: "+Qa)}this.ZBd=!0}else if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("QueryRanker","Classifier model not found")}return this.YBd}BG(){return"Command"}RP(){return 0===
this.vb.pr?0:1===this.vb.pr?1:2}HD(va,Qa,db=!1,Gb=e.a.tellMe,jc=null){const Ac=new y.a(va);if((!jc||Array.contains(jc,0))&&!ze.a.pN(va)){if(!this.Ocd&&this.ZBd){if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("CRASH","CommandResultsProvider: Found invalid Model data");throw Error.create("CommandResultsProvider: Model data invalid/corrupted");}this.vb.K3a&&this.eaa&&this.eaa.initialize();if(qf.CommandResultsUtility.m$d(va.Gf)&&(jc=qf.CommandResultsUtility.h$f(va.Gf),0<jc.results.length)){jc.displayName=
"Classifier Debug";Ac.Is(jc);Qa.resultsUpdated(Ac);return}jc=va?this.Eef=va.Gf:this.Eef;if(xh.AFrameworkApplication.fa.ka("TellMeParameterizedQueriesEnabled")){jc=this.zbj(jc);var W=this.GMc(jc.n2d());jc=jc.D8f()}else jc=this.ybj(jc),W=this.F1i(jc),jc=[];qf.CommandResultsUtility.zXc(W,!1,"Classifier","TFIDF");W=qf.CommandResultsUtility.KOc(va,W,this.vb,this.eaa,this.wza,jc,0,1);0<W.results.length&&Gb!==e.a.contextMenu&&(W.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);db||W.results.length||
this.vb.DDa||this.vb.wxa||(va=new Tg.a("lookupNoResults",14,va.Gf,null,1),W.Qv(va));0<W.results.length&&Ac.Is(W);Ac.attributes=jc}Qa.resultsUpdated(Ac)}n2d(){let va=[];try{va=this.Ocd.P_i()}catch(Qa){if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("GetPredictions","Exception: "+Qa)}return va}ybj(va){let Qa=[];try{Qa=this.Ocd.Q_i(va)}catch(db){if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("GetPredictionsWithScore","Exception: "+db)}return Qa}zbj(va){try{return this.Ocd.R_i(va,
this.SJh)}catch(Qa){if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("GetPredictionsWithTokenAttributes","Exception: "+Qa)}return new xc([],[])}GMc(va){const Qa=[];if(va)for(const db of va)Qa.push(new Wi.a(db,-99999));return Qa}F1i(va){const Qa=[];if(va)for(const db of va)Qa.push(new Wi.a(db.prediction,db.score));return Qa}}Object(h.a)(Qj,"CommandResultsProvider",null,[693]);var ae=d(953);class nj{constructor(va){this.vb=va}BG(){return"Feedback"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?
1:2}HD(va,Qa,db,Gb,jc=null){va=new y.a(va);if(!jc||Array.contains(jc,21))jc=[],jc.push(appChrome.actions.setControlLabel("TellMeFeedback",CommonUIStrings.l_TellMeFeedbackText)),appChrome.api.dispatch(jc),jc=new w.a(22),jc.displayName="",jc.Qv(new Tg.a("TellMeFeedback",23,null,null,1)),va.Is(jc);Qa.resultsUpdated(va)}}Object(h.a)(nj,"FeedbackResultsProvider",null,[693]);class Xi{constructor(va,Qa,db,Gb){this.InputText=this.CommandValueId=this.CommandId=this.Label=null;this.Label=va;this.CommandId=
Qa;this.CommandValueId=db;this.InputText=Gb}}Object(h.a)(Xi,"FindInDocumentProp",null,[]);var La=d(441),lb=d(45);class Nb{constructor(va){this.bzd=2;this.C1a=[];this.sMa=[];this.vb=va;Nb.zia=va.f5f;Nb.k5f="FindInDocumentSuggestion";Nb.A6g="FindInDocumentSuggestion3";this.wRh=Object.assign(new La.a,{landingTab:"Indoc",data:null});this.SWh=this.vb.fIb||!!xh.AFrameworkApplication.Aa&&xh.AFrameworkApplication.Aa.jb.fIb}BG(){return"FindInDocument"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:3===this.vb.pr?
this.vb.wth?2:3:2}HD(va,Qa,db=!1,Gb,jc=null){const Ac=new y.a(va);if(jc&&!Array.contains(jc,2))Qa.resultsUpdated(Ac);else if(Array.clear(this.C1a),ze.a.pN(va)){if(db&&this.qrh()){db=new w.a(2);db.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;jc=1;Gb="";if(0<this.sMa.length&&!this.vb.gIb)for(var W of this.sMa)if(""!==W.Label.toLowerCase()){if(jc>=this.bzd)break;this.gEh(db,W.Label,W.CommandValueId,Nb.k5f+jc,W.InputText);jc++}W="";this.vb.rH?(Ac.Is(db),db=new w.a(3),W=this.vb.TNa?ze.a.xQa(CommonUIStrings.l_TellMeOpenFindPaneTextV2Bolded):
CommonUIStrings.l_TellMeOpenFindPaneTextV2):W=CommonUIStrings.l_TellMeOpenFindPaneText;Gb=this.g$f("");this.gEh(db,W,Gb,Nb.A6g,"");Ac.Is(db)}Qa.resultsUpdated(Ac)}else W="",db&&(db=this.g$f(va.Gf),Gb=[],this.vb.YSa?(this.vb.BNe&&Gb.push(appChrome.actions.setControlIconSet(Nb.zia,{"default":"FindInDocument_20"})),W=this.vb.xce?ze.a.q0d(va.Gf,CommonUIStrings.l_FindInDocumentScopedButtonText):va.Gf+CommonUIStrings.l_FindInDocumentScopedButtonText):this.vb.rH?(W=this.vb.TNa?ze.a.xQa(String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2Bolded,
va.Gf)):String.format(CommonUIStrings.l_FindInDocumentScopedButtonTextV2,va.Gf),Gb.push(appChrome.actions.setControlIconSet(Nb.zia,{"default":"FindInDocument_20"}))):W=this.vb.gIb?CommonUIStrings.l_TellMeOpenFindPaneText:String.format(CommonUIStrings.l_TextWithQuotation,va.Gf),this.vb.eja?(rd.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(Nb.zia,W)),rd.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Nb.zia,db))):(Gb.push(appChrome.actions.setControlLabel(Nb.zia,
W)),Gb.push(appChrome.actions.setButtonCommandValueId(Nb.zia,db)),appChrome.api.dispatch(Gb)),this.Bnh(W,Nb.zia,db,va.Gf)),this.vb.wth?(W=new Tg.a(Nb.zia,8,va.Gf),db=new w.a(2),db.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle,db.Qv(W),Ac.Is(db),Qa.resultsUpdated(Ac)):this.vb.z5i().then(xa=>{const da=new Tg.a(Nb.zia,8,va.Gf,null,1);da.count=xa;xa=new w.a(2);xa.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;xa.Qv(da);Ac.Is(xa);Qa.resultsUpdated(Ac)},xa=>{rd.TellMeActor.instance.Cd.onError("FindInDocumentResultsProvider:issueQuery",
"Find manager promise rejected: "+xa);xa=new Tg.a(Nb.zia,8,va.Gf,null,1);const da=new w.a(2);da.displayName=CommonUIStrings.l_TellMeFindInDocProviderTitle;da.Qv(xa);Ac.Is(da);Qa.resultsUpdated(Ac)})}qrh(){return!!this.vb&&this.vb.gjd}gEh(va,Qa,db,Gb,jc=null){const Ac=[];Qa&&Ac.push(appChrome.actions.setControlLabel(Gb,Qa));this.vb.rH&&Ac.push(appChrome.actions.setControlIconSet(Gb,{"default":"FindInDocument_20"}));Ac.push(appChrome.actions.setButtonCommandValueId(Gb,db));appChrome.api.dispatch(Ac);
this.Bnh(Qa,Gb,db,"");va.Qv(new Tg.a(Gb,8,jc,null,1,-99999))}g$f(va){return this.SWh?ze.a.VOa(va,15,this.wRh):lb.a.je(va)}Bnh(va,Qa,db,Gb){this.qrh()&&this.C1a.length<this.bzd&&(va=new Xi(va,Qa,db,Gb),Array.add(this.C1a,va))}r5k(va){for(let Qa=0;Qa<this.C1a.length;Qa++)if(this.C1a[Qa].CommandId===va){const db=this.C1a[Qa].Label;let Gb=!1;if(0<this.sMa.length){let jc=0;for(const Ac of this.sMa){if(Ac.Label===db){Array.removeAt(this.sMa,jc);Gb=!0;break}jc++}}!Gb&&this.sMa.length>=this.bzd-1&&Array.removeAt(this.sMa,
1);Array.insert(this.sMa,0,this.C1a[Qa])}}}Nb.zia=null;Nb.k5f=null;Nb.A6g=null;Object(h.a)(Nb,"FindInDocumentResultsProvider",null,[693]);var lc=d(951);class Rc{constructor(va){this.vb=va}BG(){return"Insights"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}HD(va,Qa,db=!1,Gb,jc=null){Gb=new y.a(va);if(!jc||Array.contains(jc,13))if(this.Mbl()||!ze.a.pN(va)){jc=new w.a(13);var Ac=""===va.Gf.trim(),W=Ac?"SmartLookupFromTellMeZeroTerm":"SmartLookupFromTellMe",xa=new Tg.a(W,10,va.Gf,null,1);db&&(db=null,
ze.a.Oja()?Ac?Ac=CommonUIStrings.l_SeeMoreOpenSearchPaneLabel:(Ac=this.vb.gIb?CommonUIStrings.l_SeeMoreResultsButtonTextNonParameteriedV2:String.format(CommonUIStrings.l_SeeMoreResultsButtonText,va.Gf),db=ze.a.VOa(va.Gf,1)):(Ac=String.format(CommonUIStrings.l_InsightsButtonText,va.Gf),db=ze.a.ERd(va.Gf)),this.vb.eja?(rd.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(W,Ac)),db&&rd.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",
db))):(va=[],va.push(appChrome.actions.setControlLabel(W,Ac)),db&&va.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMe",db)),appChrome.api.dispatch(va)),xa.label=Ac);jc.Qv(xa);Gb.Is(jc)}Qa.resultsUpdated(Gb)}Mbl(){return ze.a.Oja()&&this.vb.Xml}}Object(h.a)(Rc,"InsightsResultsProvider",null,[693]);var Ud=d(949);class Pd{constructor(va){this.vb=va}BG(){return"Learning"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}HD(va,Qa,db,Gb,jc=null){db=new y.a(va);jc&&!Array.contains(jc,
21)||!ze.a.pN(va)||(jc=[],Gb=this.vb.NUj,jc.push(appChrome.actions.setButtonCommandValueId("LearningForSearch",Gb)),Gb=Pd.$5i(Gb),jc.push(appChrome.actions.setControlLabel("LearningForSearch",Gb)),appChrome.api.dispatch(jc),va=new Tg.a("LearningForSearch",22,va.Gf,null,1),jc=new w.a(21),jc.Qv(va),db.Is(jc));Qa.resultsUpdated(db)}static $5i(va){const Qa=[];Array.add(Qa,new Ud.a(600,CommonUIStrings.l_TellMeLearningButtonTipText));Array.add(Qa,new Ud.a(400,CommonUIStrings.l_TellMeLearningButtonText));
Array.add(Qa,new Ud.a(600,va));Array.add(Qa,new Ud.a(400,CommonUIStrings.l_TellMeLearningButtonPunctuation));va={};va.parts=Qa;return JSON.stringify(va)}}Object(h.a)(Pd,"LearningProvider",null,[693]);var Sd=d(1030);class Le{constructor(va,Qa){this.Llb=this.Jnb=this.MMa=this.Wvc=null;this.Lv=!1;this.amb=va;this.dMh=Qa;va&&this.x3f(va)}Smd(){this.amb.Smd()&&this.x3f(this.amb)}Ugj(va){let Qa=[];var db=[];va=Le.Ahk(va);var Gb="";Array.clear(db);for(let jc=0;jc<va.length;jc++){const Ac=va.charAt(jc);-1!==
" ".indexOf(Ac)?(Gb.length&&Array.add(db,Gb),Gb=""):-1!=="_-,@;.[]{}()$%*&^!\"':?/<>~`+=|\\".indexOf(Ac)?(Gb.length&&Array.add(db,Gb),Gb=Ac,Array.add(db,Gb),Gb=""):Gb+=Ac}Gb.length&&Array.add(db,Gb);for(va=0;va<db.length;va++)Gb=this.E1i(db[va]),Gb=this.Bwi(Gb),Qa=Le.Dek(Qa,Gb);return Qa=this.g3h(Qa)}Vae(){this.Lv||this.Smd();return this.Lv}zHc(va){return this.Wvc[va.toString()]}g3h(va){for(let Qa=0;Qa<va.length;Qa++){const db=this.MMa[Qa];if(va[Qa].commandId!==this.zHc(db[0]))throw Error.create("Incorrect Tcid orders with Priors data");
let Gb;(Gb=va[Qa]).score=Gb.score+db[1]}return va}Bwi(va){const Qa=[];for(var db=0;db<this.MMa.length;db++)Qa.push(new Wi.a(this.zHc(this.MMa[db][0]),-5));db=new Sd.a;for(var Gb=0;Gb<va.length;Gb++)db.add(this.zHc(va[Gb][0]));for(Gb=0;Gb<Qa.length;Gb++){const Ac=Qa[Gb];for(let W=0;W<va.length;W++){var jc=va[W];const xa=this.zHc(jc[0]);jc=jc[1];if(xa===Ac.commandId){Ac.score=jc;db.remove(xa);break}}if(!db.count)break}return Qa}E1i(va){const Qa=1>va.length;for(let W=0;2>=W;W++){const xa=this.Llb;for(let da in xa){var db=
xa[da],Gb=va,jc=da;const Fa=jc.length+1,Ua=Array((Gb.length+1)*Fa);for(var Ac=0;Ac<=Gb.length;Ac++)Ua[Ac*Fa]=Ac;for(Ac=0;Ac<=jc.length;Ac++)Ua[Ac]=Ac;for(Ac=0;Ac<jc.length;Ac++)for(let cb=0;cb<Gb.length;cb++)Ua[(cb+1)*Fa+(Ac+1)]=Gb.charAt(cb)===jc.charAt(Ac)?Ua[cb*Fa+Ac]:Math.min(Math.min(Ua[cb*Fa+(Ac+1)]+1,Ua[(cb+1)*Fa+Ac]+1),Ua[cb*Fa+Ac]+1);Gb=Ua[Gb.length*Fa+jc.length];if((!Gb||!Qa)&&Gb<=W)return db}}return this.Jnb}x3f(va){this.Wvc=va.B1d();this.MMa=va.Kbj();this.Jnb=va.Qij();this.Llb=va.U7i();
if(this.Lv=!!this.Wvc&&!!this.MMa&&!!this.Llb&&!!this.Jnb)this.Lv=0<this.MMa.length&&Le.S9d(this.MMa);this.Lv&&(this.Lv=0<this.Jnb.length&&Le.S9d(this.Jnb));this.Lv&&(this.Llb=Le.rjj(this.Llb));this.Lv||(this.Llb=this.Jnb=this.MMa=this.Wvc=null)}vij(va){va=this.Ugj(va);return this.ZSi(va,this.dMh)}ZSi(va,Qa){let db=[];for(let Gb=0;Gb<va.length;Gb++)va[Gb].score>=Qa&&db.push(va[Gb]);db.sort((Gb,jc)=>Gb.score<jc.score?1:Gb.score>jc.score?-1:0);0<db.length-10&&(db=db.slice(0,10));return db}static Dek(va,
Qa){if(!va.length)return Qa;if(va.length!==Qa.length)throw Error.create("commandSuggestionsMerged and commandSuggestionsToMerge are not of same length");for(let db=0;db<va.length;db++){if(va[db].commandId!==Qa[db].commandId)throw Error.create("Incorrect CommandId");let Gb;(Gb=va[db]).score=Gb.score+Qa[db].score}return va}static Ahk(va){return lb.a.wg(va)}static S9d(va){for(let Qa=0;Qa<va.length;Qa++)if(2!==va[Qa].length)return!1;return!0}static rjj(va){const Qa={};for(let jc in va){var db=jc,Gb=va[jc];
const Ac=Gb;Ac.length&&Le.S9d(Ac)&&(Qa[db]=Gb)}return Qa}}Object(h.a)(Le,"NaiveBayesClassifierModel",null,[]);class af{constructor(va,Qa){this.eaa=null;this.vb=va;this.jQb=new Le(Qa,va.gdg);this.vb.K3a&&(this.eaa=null)}BG(){return"NBCommand"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}HD(va,Qa,db=!1,Gb=e.a.tellMe,jc=null){const Ac=new y.a(va);if((!jc||Array.contains(jc,0))&&!ze.a.pN(va)){if(qf.CommandResultsUtility.m$d(va.Gf)&&(jc=qf.CommandResultsUtility.h$f(va.Gf),0<jc.results.length)){jc.displayName=
"Classifier Debug";Ac.Is(jc);Qa.resultsUpdated(Ac);return}if(!this.jQb.Vae()){if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("CRASH","NaiveBayesCommandProvider: Found invalid Model data");throw Error.create("NaiveBayesCommandProvider: Model data invalid/corrupted");}this.vb.K3a&&this.eaa&&this.eaa.initialize();jc=this.jQb.vij(va.Gf);qf.CommandResultsUtility.zXc(jc,!1,"Classifier","NaiveBayesian");jc=qf.CommandResultsUtility.KOc(va,jc,this.vb,this.eaa,null,null,0,1);0<jc.results.length&&
Gb!==e.a.contextMenu&&(jc.displayName=CommonUIStrings.l_TellMeCommandProviderTitle);db||jc.results.length||this.vb.DDa||this.vb.wxa||(va=new Tg.a("lookupNoResults",14,va.Gf,null,1),jc.Qv(va));0<jc.results.length&&Ac.Is(jc)}Qa.resultsUpdated(Ac)}}Object(h.a)(af,"NaiveBayesCommandProvider",null,[693]);class zf{constructor(){this.A1a=null;this.Lv=!1;this.Smd()}Smd(){this.Lv||(this.A1a=window.NBCRM)&&4===this.A1a.length&&(this.Lv=!0);return this.Lv}Kbj(){return this.Lv?this.A1a[1]:null}Qij(){return this.Lv?
this.A1a[2]:null}U7i(){return this.Lv?this.A1a[3][0]:null}B1d(){return this.Lv?this.A1a[0][0]:null}}Object(h.a)(zf,"NaiveBayesModelAdapter",null,[723]);var yh=d(233);class gg{constructor(va){this.vb=va}BG(){return"OfficeScript"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}HD(va,Qa){const db=new y.a(va);if(!ze.a.pN(va)){va=yh.d(va.Gf);var Gb=new w.a(25);Gb.displayName=CommonUIStrings.l_TellMeOfficeScriptsTitle;Gb=this.$Df(va,gg.bul,"OfficeScriptsUnhideAllRowsCols","samples-11",CommonUIStrings.l_TellMeUnhideAllRowsColsTitle,
Gb);Gb=this.$Df(va,gg.jXi,"OfficeScriptsFreezeSelection","samples-12",CommonUIStrings.l_TellMeFreezeSelectionTitle,Gb);db.Is(Gb)}Qa.resultsUpdated(db)}$Df(va,Qa,db,Gb,jc,Ac){const W=[];for(const xa of Qa)if(yh.a(va,xa)){this.vb.eja?(rd.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(db,jc)),rd.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(db,Gb))):(W.push(appChrome.actions.setControlLabel(db,jc)),W.push(appChrome.actions.setButtonCommandValueId(db,
Gb)),appChrome.api.dispatch(W));Ac.Qv(new Tg.a(db,26,null,null,1));break}return Ac}}gg.bul="unhide row rows col cols column columns".split(" ");gg.jXi=["freeze","selection","pane","panes"];Object(h.a)(gg,"OfficeScriptsSamplesProvider",null,[693]);var Dh=d(17),Ug=d(15),ui=d(440),Uh=d(301),Yi=d(439),lh=d(33),jg=d(106),cj=d(123);class oj{constructor(va){this.KH=null;this.vR=-1;this.aue=14;this.bue=12;this.attributes=this.gGd=this.query=null;this.vwb=!1;this.Lmb=[];this.$h=xh.AFrameworkApplication.Ge;
xh.AFrameworkApplication.fa&&(this.aue=xh.AFrameworkApplication.fa.Cc("TellMeMaxTermedResults",this.aue),this.bue=xh.AFrameworkApplication.fa.Cc("TellMeMaxZeroTermResults",this.bue));this.qL=va}get Ck(){return this.Lmb}get tnd(){return this.gGd}Is(va){let Qa=!1;for(let db=0;db<this.Ck.length;db++)if(27!==this.Ck[db].groupType&&this.Ck[db].groupType===va.groupType){this.VHd(this.Ck[db],va);Qa=!0;break}Qa||this.Ck.push(va)}VHd(va,Qa){for(let db=0;db<Qa.results.length;db++)va.Qv(Qa.results[db])}Feh(va){const Qa=
[];for(const db of this.Ck)db.groupType!==va&&Qa.push(db);this.Ck.length!==Qa.length&&(this.Lmb=Qa)}lQk(va){let Qa=null,db=null,Gb=null;for(let jc=0;jc<va.length;jc++){const Ac=va[jc];if(Ac&&Ac.Ck&&Ac.Ck.length)for(const W of Ac.Ck)if(17===W.groupType||18===W.groupType)Qa=W;else if(0===W.groupType||16===W.groupType)db=W,Gb=Ac}Qa&&db&&0<db.results.length&&(17===Qa.groupType&&({KHd:db,gId:Qa}=qf.CommandResultsUtility.d2h(db,Qa,this.qL.xG()?this.qL.xG().V0i:-.6)),Gb.Feh(db.groupType))}rhl(){new Dh.a;
this.Bmc(this.qL.XPg)}j6b(va,Qa){return this.query.Gf.length>this.qL.xG().bcj&&this.ENj(va,Qa)||this.query.Gf.length>this.qL.xG().ccj&&this.mQj(va,Qa)?!0:!1}mQj(va,Qa){return va&&va.length&&Qa&&Qa.length?-1===Qa.toLowerCase().indexOf(va.toLowerCase())?!1:!0:!1}ENj(va,Qa){return va&&va.length&&Qa&&Qa.length?Qa.toLowerCase().startsWith(va.toLowerCase()):!1}lTi(va){const Qa=[];for(const db of this.qL.xG().rH?this.tnd:this.Ck)va.contains(db.groupType)||Qa.push(db);this.qL.xG().rH?this.gGd=Qa:this.Lmb=
Qa}dyl(va,Qa){const db=[];for(const Gb of this.Ck){const jc=Gb;if(13!==jc.groupType){const Ac=va[Uh.a[jc.groupType].toLowerCase()];let W="False";Ac<Qa&&(W="True");jc.displayName=jc.displayName+" ("+W+": "+Ac+")"}db.push(jc)}this.Lmb=db}Bmc(va,Qa=!1,db=null){if(this.qL.xG().rH){if(!Qa)for(this.gGd=Array(this.Ck.length),Qa=0;Qa<this.Ck.length;Qa++)this.tnd[Qa]=this.Ck[Qa];this.qL.pRg.Bmc(this.Ck,this.tnd,this.query,va,db)}else{for(db=new Dh.a;this.Ck.length;){Qa=this.Ck.pop();const Gb=Uh.a[Qa.groupType].toLowerCase(),
jc=va[Gb];if(cj.b(jc))throw Error.create("GroupId "+Gb+" missed from group SortingOrder");db.add(new Ug.a(jc,Qa))}db.Sc((Gb,jc)=>Gb.key<jc.key?-1:1);for(va=0;va<db.count;va++)Qa=db.ga(va).value,this.Ck.push(Qa)}}shl(){var va=!1;let Qa=!1,db=!1;for(let jc=0;jc<this.Ck.length;jc++){var Gb=this.Ck[jc];const Ac=Gb.groupType;if(8===Ac||15===Ac||14===Ac){Gb=Gb.results;for(let W=0;W<Gb.length;W++){if(8===Ac&&this.j6b(this.query.Gf,Gb[W].label)){va=!0;break}if(15===Ac&&this.j6b(this.query.Gf,Gb[W].label)){Qa=
!0;break}if(14===Ac){if(this.j6b(this.query.Gf,Gb[W].label)||this.j6b(this.query.Gf,Gb[W].description)){db=!0;break}const xa=Gb[W].label.split(" ");for(const da of xa)if(this.j6b(this.query.Gf,da)){db=!0;break}}}}}va=this.qL.wdj(va,Qa,db);this.Bmc(va)}eeb(va,Qa,db,Gb,jc,Ac){if(jc===this.KH){var W=va.data.Sd;jc=null;try{jc=lh.b(W)}catch(Ld){rd.TellMeActor.instance.Cd.onError("OnSuccessCallBack","Exception occured while deserializing ranker inference response:"+Ld);return}if("RankerResults"in jc&&jc.RankerResults){this.Pha();
var xa=jc.RankerResults,da=new Dh.a,Fa=new Dh.a;W=0;for(var Ua of xa){xa=Ua.ProviderId;var cb=Ua.Score;W+=cb;da.add(new Ug.a(xa,cb))}da.Sc((de,Be)=>de.value>Be.value?-1:1);cb=Ac?Ac.wej:1E-6;Ua={};xa={};let Ld=0;for(var Jb=0;Jb<da.count;Jb++){let de=parseInt(da.ga(Jb).key),Be=da.ga(Jb).value/W;1===de&&(xa.answer=Ld++,xa.entity=Ld++,xa.definition=Ld++,xa.wolframanswer=Ld++,Be<cb&&(Fa.add(9),Fa.add(11),Fa.add(10),Fa.add(12)),Ua.answer=Be,Ua.entity=Be,Ua.definition=Be,Ua.wolframanswer=Be);2===de&&(xa.assistance=
Ld++,Be<cb&&Fa.add(8),Ua.assistance=Be);3===de&&(xa.classifier=Ld++,xa.serviceclassifier=Ld++,Be<cb&&(Fa.add(0),Fa.add(17)),Ua.classifier=Be,Ua.serviceclassifier=Be);4===de&&(xa.people=Ld++,Be<cb&&Fa.add(14),Ua.people=Be);5===de&&(xa.document=Ld++,Be<cb&&Fa.add(15),Ua.document=Be);6===de&&(xa.findindocument=Ld++,Be<cb&&Fa.add(2),Ua.findindocument=Be);7===de&&(xa.notes=Ld++,Be<cb&&Fa.add(20),Ua.notes=Be);8===de&&(xa.image=Ld++,Be<cb&&Fa.add(19),Ua.image=Be)}da=new Dh.a;da.add("classifier");da.add("serviceclassifier");
da.add("appsforoffice");da.add("addin");da.add("findindocument");da.add("assistance");da.add("document");da.add("people");da.add("answer");da.add("wolframanswer");da.add("definition");da.add("entity");da.add("image");da.add("template");da.add("officescript");for(Jb=0;Jb<da.count;Jb++)da.ga(Jb)in xa||(xa[da.ga(Jb)]=Ld++);xa.learning=Ld++;xa.insights=Ld++;xa.feedback=Ld++;Ac&&Ac.gLj&&this.dyl(Ua,cb);Ac&&Ac.hLj&&this.lTi(Fa);Fa={};for(var Gc in Ua)Fa[Gc]=Ua[Gc]*W;this.Bmc(xa,!0,Fa)}if(Ac.AVc&&"Intents"in
jc&&jc.Intents){Gc=jc.Intents;for(var pd of Gc)if(this.Vce(pd)&&"Serplet"===pd.GroupType&&pd.ConfidenceScore>pd.ConfidenceThreshold){Gc=!1;jc=0;if(Ac.cce){W=new Tg.a("",28);for(Fa=0;Fa<this.Ck.length;Fa++)if((da=this.Ck[Fa].results)&&0<da.length){jc=Fa;W=da[0];break}2===W.groupType&&(Gc=!0)}W=new w.a(13);Gc&&Ac.cce&&(W=new w.a(13,CommonUIStrings.l_TellMeWebTitle));Fa=new Tg.a("SmartLookupFromTellMeQueryTermAtTop",10,this.query.Gf,null,0);da=[];Ua=null;Ua=ze.a.Oja()?ze.a.VOa(this.query.Gf,1):ze.a.ERd(this.query.Gf);
da.push(appChrome.actions.setButtonCommandValueId("SmartLookupFromTellMeQueryTermAtTop",Ua));Ua=String.format(CommonUIStrings.l_SeeMoreResultsButtonTextAtTop,this.query.Gf);da.push(appChrome.actions.setControlLabel("SmartLookupFromTellMeQueryTermAtTop",Ua));appChrome.api.dispatch(da);W.Qv(Fa);Fa=[];if(Gc&&Ac.cce)for(Fa.push(this.Ck[jc]),Fa.push(W),Gc=jc+1;Gc<this.Ck.length;Gc++)(jc=this.Ck[Gc].results)&&0<jc.length&&Fa.push(this.Ck[Gc]);else for(Fa.push(W),Gc=0;Gc<this.Ck.length;Gc++)(jc=this.Ck[Gc].results)&&
0<jc.length&&Fa.push(this.Ck[Gc]);this.Lmb=Fa}}if(Ac.q6b&&!Ac.rH){pd=Gc=-1;for(jc=0;jc<this.Ck.length;jc++)switch(this.Ck[jc].groupType){case 23:Gc=jc;break;case 0:case 17:case 2:-1===pd&&(pd=jc)}if(-1!==Gc){pd=-1===pd?0:Gc>pd?pd+1:pd;Gc=this.Ck[Gc];jc=Array(this.Ck.length);W=0;for(Fa=0;Fa<jc.length;Fa++)Fa===pd?jc[Fa]=Gc:(23===this.Ck[W].groupType&&W++,jc[Fa]=this.Ck[W],W++);this.Lmb=jc}}Gb.resultsUpdated(this);Gb=rd.TellMeActor.instance.Cd;Gb.K4(Qa.length,"RankerInference",va.data.Le.toString(),
Math.round(window.performance.now()-db),Yi.a.Mxh,!0,ui.a.xsa);this.vwb&&Gb&&(va=this.query.pXa,Qa=Gb.bsc,Ac.SVc&&va>Qa&&!Ac.rH&&(Gb.Xee(this.query.Gf),Gb.xKe(va)))}}Vce(va){if("GroupType"in va&&va.GroupType&&"ConfidenceScore"in va&&"ConfidenceThreshold"in va)return!0;rd.TellMeActor.instance.Cd.onError("IsValidIntentGroup","Invalid intents found");return!1}Udb(va,Qa,db,Gb,jc){Gb===this.KH&&(this.Pha(),rd.TellMeActor.instance.Cd.K4(Qa.length,"RankerInference",va.data.Le.toString(),Math.round(window.performance.now()-
db),Yi.a.Mxh,!1,ui.a.xsa));jc.resultsUpdated(this)}Pha(){-1!==this.vR&&(window.clearTimeout(this.vR),this.vR=-1)}thl(va){let Qa;Qa=this.qL.xG().rH?rd.TellMeActor.instance.Cd.B3d(this.tnd,this.query.Gf):rd.TellMeActor.instance.Cd.B3d(this.Ck,this.query.Gf);var db=this.qL.xG().vej;""!==db&&(db="_"+db);let Gb="";this.qL.xG().Uae&&(Gb="RankerInference"+db+",");this.qL.xG().AVc&&(Gb+="SerpletClassifier");","===Gb.charAt(Gb.length-1)&&(Gb=Gb.substring(0,Gb.length-1));db=rd.TellMeActor.instance.Cd.Vgg(Gb);
const jc=this.KH=jg.a.create().toString();db["Client-Request-Id"]=jc;const Ac=window.performance.now(),W=this.qL.xG()?this.qL.xG().xej:600;this.Pha();this.vR=window.setTimeout(()=>{if(jc===this.KH){this.KH="";this.vR=-1;va.resultsUpdated(this);const xa={};xa[m.a.provider]="Ranker";xa[m.a.afb]=this.query.pXa;rd.TellMeActor.instance.Cd.iH(r.a.timedOut,W,xa)}},W);this.$h.yj(rd.TellMeActor.instance.Cd.Wgg(),2,Qa,db,!1,0,xa=>{this.eeb(xa,this.query.Gf,Ac,va,jc,this.qL.xG())},xa=>{this.Udb(xa,this.query.Gf,
Ac,jc,va)},null,null,!1,4E3,6E3)}$ql(){var va=0,Qa=new Dh.a,db=this.qL.VPg,Gb=this.qL.WPg;for(var jc=0;jc<this.Ck.length;jc++){var Ac=this.Ck[jc],W=Uh.a[Ac.groupType].toLowerCase(),xa=db[W];va+=Ac.results.length;Ac.results.length>xa&&(W=Gb[W],cj.b(W)||Qa.add(new Ug.a(W,Ac)))}Gb=!this.query||""===this.query.Gf.trim();jc=va-(Gb?this.bue:this.aue);if(!(0>=jc)){Gb=window.performance.now();va=va.toString()+" total,"+jc.toString()+" to remove.";if(0<Qa.count)for(Qa.Sc((da,Fa)=>da.key>Fa.key?-1:1),Ac=0;Ac<
Qa.count&&0<jc;Ac++){W=Qa.ga(Ac).value;xa=Uh.a[W.groupType].toLowerCase();let da=W.results.length-db[xa];da>jc&&(da=jc);0<da&&(W.TFe(da),va+=xa+": "+da.toString()+" results removed.",jc-=da)}if(0<jc){va+=jc.toString()+" results left after trimming.";Qa=new Dh.a;db=this.qL.$Pg;for(Ac=0;Ac<this.Ck.length;Ac++)W=this.Ck[Ac],xa=db[Uh.a[W.groupType].toLowerCase()],cj.b(xa)||Qa.add(new Ug.a(xa,W));Qa.Sc((da,Fa)=>da.key<Fa.key?-1:1);for(db=0;0<jc;)Ac=Qa.ga(db++).value,jc>=Ac.results.length?(Array.remove(this.Ck,
Ac),va+=Uh.a[Ac.groupType]+": "+Ac.results.length.toString()+" results force removed.",jc-=Ac.results.length):(Ac.TFe(jc),va+=Uh.a[Ac.groupType]+": "+jc.toString()+" results force removed.",jc=0)}rd.TellMeActor.instance.Cd&&(Qa={},Qa[m.a.message]=va,rd.TellMeActor.instance.Cd.iH("ShowOptimal",window.performance.now()-Gb,Qa))}}}Object(h.a)(oj,"CombineResultsUpdatedEventArgs",null,[667]);var hk=d(678);class Vh{constructor(va,Qa,db,Gb=!1,jc=""){this.gBd=this.DCd=!1;this.YC=va;this.h2a=[];this.Xsf=Qa.length;
this.vb=rd.TellMeActor.instance.xG();this.Wuc=Gb;this.W2a=jc;this.rnb={};for(va=0;va<Qa.length;++va)this.rnb[va.toString()]=db?0:Qa[va].RP()}K6k(va,Qa){Qa&&Qa.query&&Qa.query.pXa<rd.TellMeActor.instance.Kaa||(this.h2a[va]=Qa,this.gBd?this.DCd=!0:(!this.vb||3!==this.vb.pr||3!==this.rnb[va.toString()]||this.VYf())&&this.NSc())}Lwk(){this.gBd=!0}lul(){this.gBd=!1;this.DCd&&(this.DCd=!1,this.NSc())}VYf(){if(this.h2a.length<this.Xsf)return!1;for(let va=0;va<this.Xsf;++va)if(!this.h2a[va])return!1;return!0}NSc(){var va=
this.VYf();const Qa=window.performance.now(),db=new oj(rd.TellMeActor.instance.n6e);db.lQk(this.h2a);for(var Gb=0;Gb<this.h2a.length;++Gb){var jc=this.h2a[Gb];if(jc&&jc.Ck&&jc.Ck.length&&(db.query=jc.query,jc.attributes&&0<jc.attributes.length&&(db.attributes=jc.attributes),jc&&jc.Ck&&(va||this.Uni(Gb,this.h2a))))for(const Ac of jc.Ck)db.Is(Ac)}db.Ck&&db.Ck.length&&(db.vwb=va,this.vb&&this.vb.vTe&&db.$ql(),hk.a.tzg()&&(this.vb&&this.vb.GOj&&db.query.Gf&&0<db.query.Gf.length?db.shl():db.rhl()),hk.a.tzg()&&
this.vb&&(this.vb.Uae||this.vb.AVc)&&this.Wuc&&db.query.Gf&&0<db.query.Gf.length&&db.vwb&&this.W2a!==e.a.contextMenu?(3===this.vb.pr&&va||this.YC.resultsUpdated(db),db.thl(this.YC)):this.YC.resultsUpdated(db),va=rd.TellMeActor.instance.Cd,db.vwb&&va&&(Gb=db.query.pXa,jc=va.bsc,db.query.Gf&&0<db.query.Gf.length&&this.Wuc&&this.vb.SVc&&this.W2a!==e.a.contextMenu&&Gb>jc&&!this.vb.Uae&&!this.vb.rH&&(va.Xee(db.query.Gf),va.xKe(Gb)),va.iH(r.a.hXk,window.performance.now()-Qa)))}Uni(va,Qa){if(!(this.rnb&&
va.toString()in this.rnb)||Qa.length<=va||!Qa[va])return!1;if(!Qa[va].Ck.length)return!0;const db=this.rnb[va.toString()];if(0===db)return!0;const Gb=this.rnb;for(let Ac in Gb){var jc=Gb[Ac];const W=Number.parseInvariant(Ac);if(W!==va&&jc===db&&!(Qa.length>W&&Qa[W]))return!1}return!0}}Object(h.a)(Vh,"ResultsAggregator",null,[]);var Ji=d(982);class Bi{constructor(){this.FJb=this.GJb=this.EJb=this.logCount=this.logRank=this.invertedRank=0}J1h(va,Qa){switch(va){case 1:this.invertedRank=Qa;break;case 3:this.logRank=
Qa;break;case 2:this.logCount=Qa;break;case 5:this.EJb=Qa;break;case 4:this.GJb=Qa;break;case 6:this.FJb=Qa}}}Object(h.a)(Bi,"CommandFeatures",null,[]);class Eh{constructor(va){this.p4e=0;this.NSh=va;this.gLh={}}get modelId(){return this.NSh}get featureIntercept(){return this.p4e}get CWb(){return this.gLh}O0h(va,Qa,db){0===Qa?this.p4e=db:(this.CWb[va]||(this.CWb[va]=new Bi),this.CWb[va].J1h(Qa,db))}}Object(h.a)(Eh,"CoefficientsModel",null,[]);const rh=(va,Qa)=>Math.pow(10,-Qa/(60*Math.LN10/Math.LN2*
va));class sg{constructor(va,Qa){this.Mk=1;this.Zsc=new Bi;this.features.logCount=1+Math.log(this.count)/Math.LN2;this.features.invertedRank=va?1/va:0;this.features.logRank=2/Math.pow(2,va);this.features.EJb=rh(10,Qa);this.features.GJb=rh(2,Qa);this.features.FJb=rh(1,Qa)}get count(){return this.Mk}get features(){return this.Zsc}yxj(){this.Mk=this.count+1;this.features.logCount=1+Math.log(this.count)/Math.LN2}Xxl(va){const Qa=2/Math.pow(2,va);this.features.invertedRank=Math.max(this.features.invertedRank,
va?1/va:0);this.features.logRank=Math.max(this.features.logRank,Qa)}ezl(va){const Qa=rh(10,va),db=rh(2,va);va=rh(1,va);this.features.EJb=Math.max(this.features.EJb,Qa);this.features.GJb=Math.max(this.features.GJb,db);this.features.FJb=Math.max(this.features.FJb,va)}}Object(h.a)(sg,"CommandModel",null,[]);class ci{constructor(va){this.mMb=null;if(!va&&rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("PredictionEngine","IModelAdapter can't be null");this.amb=va;this.Vvc=this.oee()}oee(){const va=
this.amb.O9i(),Qa=this.amb.B1d();if(void 0===va||null===va||void 0===Qa||null===Qa)return!1;try{window.performance.now();this.mMb={};for(let db=0;db<va.length;db++){const Gb=va[db],jc=Qa[Gb[0].toString()].trim(),Ac=Gb[1],W=0!==Ac?Qa[Gb[2].toString()].trim():"",xa=Gb[3];jc in this.mMb||(this.mMb[jc]=new Eh(jc));this.mMb[jc].O0h(W,Ac,xa)}}catch(db){if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("LoadModelData","Error Loading Suggestions Model: "+db);return!1}return!0}EYi(){const va=
this.amb.s7i(),Qa={};if(!va)return Qa;let db=1;for(let Gb=0;Gb<va.length;Gb++){const jc=va[Gb];jc.Id in Qa?(Qa[jc.Id].yxj(),Qa[jc.Id].Xxl(db),Qa[jc.Id].ezl(jc.TimeElapsedSinceClick)):Qa[jc.Id]=new sg(db,jc.TimeElapsedSinceClick);db++}return Qa}Vae(){this.Vvc||(this.Vvc=this.oee());return this.Vvc}vbj(){let va=[];if(!this.Vvc){if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("GetPredictedCommands","IModelAdapter returned no data");return va}const Qa=this.EYi(),db=this.mMb;for(let jc in db){const Ac=
db[jc],W=Ac.modelId;let xa=0;for(let da in Qa){var Gb=da;const Fa=Qa[da].features;(Gb=Gb in Ac.CWb?Ac.CWb[Gb]:null)&&(xa+=Fa.invertedRank*Gb.invertedRank+Fa.logRank*Gb.logRank+Fa.logCount*Gb.logCount+Fa.EJb*Gb.EJb+Fa.GJb*Gb.GJb+Fa.FJb*Gb.FJb)}xa+=Ac.featureIntercept;va.push(new Wi.a(W,xa))}va.sort((jc,Ac)=>jc.score<Ac.score?1:jc.score>Ac.score?-1:0);0<va.length-10&&(va=va.slice(0,10));return va}}Object(h.a)(ci,"PredictionEngine",null,[]);class dj{constructor(){this.Yvf={"Multiselect,Paragraph,SelectionRange":"LineSpacing WordCountSplitButton Find RemoveSpaceAfterParagraph ParagraphOptions SpacingAfter".split(" "),
"Paragraph,SelectionRange":"Find LineSpacing WordCountSplitButton Strikethrough Superscript Subscript".split(" "),"Paragraph,SelectionRange,Image":"CropPictureMenu PrintDocument Find EditPictureAltText FormatPictureOptions MarginsCustom".split(" "),"Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton Spelling Find SetProofingLanguage Strikethrough".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),
"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton RemoveSpaceAfterParagraph Find WordCount ParagraphOptions".split(" "),"Paragraph,SelectionRange,Table":"Find Strikethrough CellShading Superscript Subscript OpenInClientWithIcon".split(" "),"Multiselect,Paragraph,SelectionRange,Table":"CellShading MergeCells Strikethrough Find LineSpacing NoBorder".split(" "),"Paragraph,SelectionRange,List":"Find Strikethrough Superscript InsertLink Subscript Highlighter".split(" "),
"Paragraph,SelectionRange,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing WordCount ApplyStyle Find Strikethrough".split(" "),"Multiselect,EmptyParagraph,SelectionRange":"LineSpacing WordCountSplitButton Find SetProofingLanguage ParagraphOptions RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,List":"LineSpacing Strikethrough WordCountSplitButton Find DistributeColumns SpacingAfter".split(" "),"EmptyParagraph,SelectionRange":"Find InsertHeaderFooter LineSpacing BorderGallery_MLR InsertPageNumber LineSpacing".split(" "),
"Multiselect,EmptyParagraph,SelectionRange,Table":"MergeCells CellShading DeleteRow BorderGallery_MLR NoBorder Find".split(" "),"EmptyParagraph,SelectionRange,Table":"MergeCells CellShading NoBorder Find BorderGallery_MLR DeleteRow".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"LineSpacing WordCountSplitButton SetProofingLanguage Find RemoveSpaceAfterParagraph ParagraphOptions".split(" "),"Paragraph,SelectionRange,SpellingError,WhiteSpaceAtCursor":"WordCountSplitButton LineSpacing SetProofingLanguage WordCount Find IndentHanging".split(" "),
"Paragraph,SelectionRange,SpellingError,Table":"Find Strikethrough SetProofingLanguage Spelling ChangeCaseUpper WordCountSplitButton".split(" "),"Paragraph,SelectionRange,Hyperlink":"IndentHanging Find InsertLink LineSpacing Strikethrough BorderGallery_MLR".split(" "),"Paragraph,SelectionRange,SpellingError,List":"Strikethrough Spelling Find WordCountSplitButton SetProofingLanguage Subscript".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,Table":"SetProofingLanguage LineSpacing Find CellShading MergeCells Strikethrough".split(" "),
"Multiselect,Paragraph,SelectionRange,Hyperlink":"LineSpacing IndentHanging Find ParagraphOptions WordCountSplitButton RemoveSpaceAfterParagraph".split(" "),"Multiselect,Paragraph,SelectionRange,WhiteSpaceAtCursor,Table":"CellShading MergeCells LineSpacing Strikethrough Find NoBorder".split(" "),"Multiselect,Paragraph,SelectionRange,SpellingError,List":"LineSpacing SetProofingLanguage Strikethrough WordCountSplitButton Find ParagraphOptions".split(" ")}}GMc(va,Qa){return Qa&&"word"===Qa.application.toLowerCase()&&
va in this.Yvf?this.Yvf[va]:[]}}Object(h.a)(dj,"SuggestionResultsUtility",null,[]);class Zi{constructor(va,Qa,db){this.vb=Qa;this.jQb=new ci(va);this.HR=db;this.pyf=new dj}BG(){return"Suggestion"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:2}HD(va,Qa,db,Gb=e.a.tellMe,jc=null){db=new y.a(va);rd.TellMeActor.instance.opc=!1;if((!jc||Array.contains(jc,16))&&ze.a.pN(va)){if(!this.jQb.Vae()){if(rd.TellMeActor.instance.Cd)rd.TellMeActor.instance.Cd.onError("CRASH","SuggestionResultsProvider: Found invalid Model data");
throw Error.create("SuggestionResultsProvider: Model data invalid/corrupted");}Date.now();if(this.Ybe()&&0<this.pyf.GMc(rd.TellMeActor.instance.nHc,this.vb).length){const W=this.pyf.GMc(rd.TellMeActor.instance.nHc,this.vb);jc=[];for(var Ac of W)this.vb.gjd&&"Find"===Ac||jc.push(new Wi.a(Ac,0));rd.TellMeActor.instance.opc=!0}else jc=this.jQb.vbj();qf.CommandResultsUtility.zXc(jc,!0,"Recommended","LRE");Ac=[];for(const W of jc)this.HR&&this.HR.RPd(W.commandId)||Ac.push(W);va=qf.CommandResultsUtility.KOc(va,
Ac,this.vb,null,null,null,16,1);0<va.results.length&&Gb!==e.a.contextMenu&&(va.displayName=CommonUIStrings.l_TellMeTryCommandTitle);0<va.results.length&&db.Is(va)}Qa.resultsUpdated(db)}Ybe(){return!!this.vb&&(this.vb.Ybe||this.vb.TSj)}}Object(h.a)(Zi,"SuggestionResultsProvider",null,[693]);class Ri{s7i(){return rd.TellMeActor.instance.Yrd}O9i(){return window.TellMeSuggestionModel}B1d(){return window.CoefficientModelIdMap}}Object(h.a)(Ri,"SuggestionsModelAdapter",null,[722]);var Fh=d(1014),Rj=d(952);
d.d(V,"AggregatorResultsProvider",function(){return mh});class mh{constructor(va=!1){this.ymb={};this.ymb[e.a.tellMe]=[];this.ymb[e.a.contextMenu]=[];this.Wuc=va}OAg(va,Qa,db,Gb,jc=null){let Ac;var W=!1;switch(Gb){case e.a.contextMenu:Ac=this.ymb[e.a.contextMenu];W=!0;break;default:Ac=this.ymb[e.a.tellMe]}Qa=new Vh(Qa,Ac,W,this.Wuc,Gb);Qa.Lwk();for(let xa=0;xa<Ac.length;++xa){const da=window.performance.now(),Fa=new A(Qa,xa);(W=rd.TellMeActor.instance.xG())&&W.bfi?window.setTimeout(()=>{Ac[xa].HD(va,
Fa,db,Gb,jc);if(rd.TellMeActor.instance.Cd){const Ua={};Ua[m.a.provider]=Ac[xa].BG();Ua[m.a.afb]=va.pXa;rd.TellMeActor.instance.Cd.iH(r.a.HD,window.performance.now()-da,Ua)}},0):(Ac[xa].HD(va,Fa,db,Gb,jc),rd.TellMeActor.instance.Cd&&(W={},W[m.a.provider]=Ac[xa].BG(),W[m.a.afb]=va.pXa,rd.TellMeActor.instance.Cd.iH(r.a.HD,window.performance.now()-da,W)))}Qa.lul()}BG(){return"Aggregator"}RP(){return 0}HD(va,Qa,db=!1,Gb=e.a.tellMe,jc=null){if(rd.TellMeActor.instance.Bfk)this.OAg(va,Qa,db,Gb,jc);else{const Ac=
window.performance.now();rd.TellMeActor.instance.rCl.then(()=>{rd.TellMeActor.instance.Cd&&rd.TellMeActor.instance.Cd.iH(r.a.Cfk,window.performance.now()-Ac);this.OAg(va,Qa,db,Gb,jc);return!0})}}kD(va,Qa){this.ymb[Qa].push(va)}z2h(va){switch(va){case "FindParameterized":case "FindInDocumentSuggestion1":case "FindInDocumentSuggestion2":const Qa=this.ymb[e.a.tellMe];for(const db of Qa)if("FindInDocument"===db.BG()){db.r5k(va);break}}}static createInstance(va,Qa,db,Gb){const jc=Gb&&ze.a.bNe(Qa);var Ac=
jc&&Qa.bze;const W=Qa.Kce&&!ze.a.D9a(),xa=Qa.dbe,da=new mh(jc);if(Qa.Nbl){var Fa=new Pd(Qa);da.kD(Fa,e.a.tellMe)}Fa=Qa.Do?xh.AFrameworkApplication.fa.ka("TellMeIsSuggestionsForSimplifiedUxEnabled"):xh.AFrameworkApplication.fa.ka("TellMeSuggestionsIsEnabled");const Ua=!Fa&&xh.AFrameworkApplication.fa.ka("TellMeFirstRunExperienceIsEnabled");da.kD(new ae.a(va,Qa.Msl,Ua,!1),e.a.tellMe);Fa&&da.kD(new Zi(new Ri,Qa,va),e.a.tellMe);va=xh.AFrameworkApplication.Aa.jb.Wzg?new af(Qa,new zf):new Qj(Qa,db);da.kD(va,
e.a.contextMenu);(jc&&Qa.cze||Ac)&&da.kD(Fh.a.GVf(Qa,!0),e.a.tellMe);da.kD(va,e.a.tellMe);!Qa.KTi||"Word"===Qa.application&&Qa.g5f||da.kD(new Nb(Qa),e.a.tellMe);Qa.K3a&&(Ac=new u(Qa),da.kD(Ac,e.a.tellMe),da.kD(Ac,e.a.contextMenu));!Qa.Tob||Qa.Qlc||Qa.Plc||da.kD(new D.a(Qa),e.a.tellMe);Gb&&(Qa.DDa||ze.a.Oja())&&(Ac=new Rc(Qa),da.kD(Ac,e.a.tellMe),da.kD(Ac,e.a.contextMenu));jc&&da.kD(Fh.a.GVf(Qa,!1),e.a.tellMe);Gb&&!Qa.vQe&&ze.a.aNe(Qa)&&(da.kD(new Ji.a(Qa),e.a.tellMe),Qa.mkl&&da.kD(new Ji.a(Qa),e.a.contextMenu));
W&&da.kD(new nj(Qa),e.a.tellMe);(Qa.kIb||Qa.rH)&&da.kD(new lc.a(Qa),e.a.tellMe);Qa.q6b&&da.kD(new Rj.a(Qa),e.a.tellMe);Gb&&Qa.VSc&&da.kD(new v.AddinResultsProvider(Qa),e.a.tellMe);xa&&"Excel"===Qa.application&&da.kD(new gg(Qa),e.a.tellMe);return da}}Object(h.a)(mh,"AggregatorResultsProvider",null,[693])},982:function(J,V,d){J=d(0);var h=d(146),e=d(660),m=d(372),r=d(261),v=d(440);class A{constructor(ja,C){this.DimensionValue=this.DimensionName=null;this.DimensionName=ja;this.DimensionValue=C}}Object(J.a)(A,
"Dimension",null,[]);class w{constructor(ja,C,pa,Z,qa){this.Query=this.EntityType=null;this.Size=this.From=0;this.Filter=null;this.EntityType=ja;this.Query=C;this.From=pa;this.Size=Z;qa&&(this.Filter=qa)}}Object(J.a)(w,"EntityRequest",null,[]);class y{constructor(ja){this.QueryString=null;this.QueryString=ja}}Object(J.a)(y,"Query",null,[]);var u=d(158);class D{constructor(ja,C){this.Dimensions=this.Name=null;this.Name=ja;this.Dimensions=C}}Object(J.a)(D,"Scenario",null,[]);var F=d(176),I=d(175);class H{constructor(ja,
C,pa,Z){this.Scenario=this.Cvid=this.TimeZone=this.EntityRequests=null;this.EntityRequests=ja;this.TimeZone=C;this.Cvid=pa;this.Scenario=Z}}Object(J.a)(H,"SubstrateBody",null,[]);var L=d(439),E=d(118),aa=d(105),Q=d(25),O=d(916),T=d(915),K=d(441),X=d(33),P=d(45),ea=d(106);d.d(V,"a",function(){return ia});class ia{constructor(ja){this.xQb=this.ZMa=this.gwc=this.JNb=this.XQb=0;this.qhf=this.mjf=this.KH=null;this.m1a=0;this.vR=-1;this.zSb="";this.$h=Q.AFrameworkApplication.Ge;this.vb=ja;this.azc=this.C3d();
this.rDd=new e.a;this.bgf=this.vb.vTe?3:2;this.$yf=this.vb.vTe&&this.vb.Ksh?5:3;this.ZBf=this.vb.gjd?2:3;this.$Bf=1;this.Jvc=this.vb.ydg;this.Ixf=this.vb.dQj;this.ARb=ja.Zfg;Q.AFrameworkApplication.fa&&(this.mjf=Q.AFrameworkApplication.fa.Ga("AppCatalogUrl")+Q.AFrameworkApplication.fa.Ga("SearchPersonaPhotoBaseUrl"))}BG(){return"Substrate"}RP(){return 0===this.vb.pr?0:1===this.vb.pr?1:3}HD(ja,C,pa,Z=h.a.tellMe,qa=null){const ya=new I.a(ja);if(!qa||Array.contains(qa,14)||Array.contains(qa,15)||Array.contains(qa,
20))if(!this.m1a||window.performance.now()-this.m1a>=aa.a.pmd)if(pa=this.rDd.zgg())this.m1a=window.performance.now(),pa.then(Ka=>{Ka&&""!==Ka?(this.zSb=Ka,""!==this.KH&&this.ygg(ja,Z,this.zSb,C,qa)):(E.TellMeActor.instance.Cd.onError("SubstrateResultsProvider:IssueQuery","Empty or null token returned"),C.resultsUpdated(ya))},Ka=>{E.TellMeActor.instance.Cd.onError("SubstrateResultsProvider:IssueQuery","SubstrateTokenPromise rejected "+Ka);C.resultsUpdated(ya)});else{if(E.TellMeActor.instance.Cd)E.TellMeActor.instance.Cd.onError("SubstrateResultsProvider:IssueQuery",
"undefined token promise");C.resultsUpdated(ya)}else this.zSb&&""!==this.zSb?this.ygg(ja,Z,this.zSb,C,qa):(C.resultsUpdated(ya),E.TellMeActor.instance.Cd.onError("SubstrateResultsProvider:IssueQuery","Not able to acquire token"));else C.resultsUpdated(ya)}b5(){this.ZMa=this.xQb=this.gwc=this.JNb=this.XQb=0}ygg(ja,C,pa,Z,qa){this.b5();const ya=new I.a(ja),Ka=this.KH=ea.a.create().toString();this.Pha();this.vR=window.setTimeout(()=>{if(Ka===this.KH){this.KH="";this.vR=-1;Z.resultsUpdated(ya);const ma=
{};ma[m.a.provider]=this.BG();ma[m.a.afb]=ja.pXa;E.TellMeActor.instance.Cd.iH(r.a.timedOut,this.ARb,ma)}},this.ARb);const Da={"Content-Type":"application/json",Accept:"application/json"};Da.Authorization="Bearer "+pa;Da["X-Office-Version"]=Q.AFrameworkApplication.buildVersion;Da["X-Office-Application"]=Q.AFrameworkApplication.fa.Ga("Application");Da["X-Office-Platform"]="WAC";Da["X-TellMe-SessionId"]=E.TellMeActor.instance.sPc();Da["X-TellMe-Culture"]=Q.AFrameworkApplication.uiCulture;Da["X-TellMe-ProcessSessionId"]=
Q.AFrameworkApplication.userSessionId;Da["Client-Request-Id"]=Ka;const la=window.performance.now();this.$h.yj(this.Hgj(),2,this.Igj(ja.Gf,this.vb.application,E.TellMeActor.instance.sPc(),aa.a.pN(ja)),Da,!1,0,ma=>{this.eeb(ma,ja,Z,Ka,la,C,qa)},ma=>{this.Udb(ma,ja,Z,Ka,la)},null,null,!1,4E3,6E3)}Pha(){-1!==this.vR&&(window.clearTimeout(this.vR),this.vR=-1)}eeb(ja,C,pa,Z,qa,ya,Ka){E.TellMeActor.instance.Cd.K4(C.Gf.length,this.azc.join(","),ja.data.Le.toString(),Math.round(window.performance.now()-qa),
L.a.substrate,!0,v.a.xsa);const Da=aa.a.pN(C),la=new I.a(C);if(Z===this.KH){this.Pha();ja=X.b(ja.data.Sd);if(ja.Groups){ja=ja.Groups;for(const ma of ja)"People"===ma.Type&&this.vb.xnc&&(Ka?Array.contains(Ka,14):1)?(ja=this.aeg(ma.Suggestions,Da,ya),0<ja.results.length&&la.Is(ja)):"File"===ma.Type&&this.vb.wnc&&(Ka?Array.contains(Ka,15):1)?(ja=this.Mag(ma.Suggestions,Da,ya),0<ja.results.length&&la.Is(ja)):"Notes"===ma.Type&&this.vb.ZSa&&ya!==h.a.contextMenu&&(Ka?Array.contains(Ka,20):1)&&(ja=this.udg(ma.Suggestions,
Da,C),0<ja.results.length&&la.Is(ja))}pa.resultsUpdated(la);E.TellMeActor.instance.Cd.K4(C.Gf.length,this.azc.join(","),"",Math.round(window.performance.now()-qa),"",!0,v.a.provider)}else pa.resultsUpdated(la)}udg(ja,C,pa){const Z=new F.a(20);Z.displayName=CommonUIStrings.l_TellMeNotesProviderTitle;for(const qa of ja)this.jSj(qa)&&(ja=qa.NotesType,ja=P.a.wg(ja),ja=this.P$i(ja,qa.LastModifiedTime,qa.BodyPreview,qa.Subject,C,pa,qa))&&(ja.groupType=20,Z.Qv(ja));return Z}aeg(ja,C,pa){const Z=new F.a(14);
Z.displayName=CommonUIStrings.l_TellMePeopleProviderTitle;for(const ya of ja)if(this.kSj(ya)){var qa=ya.Id.split("@")[0];ja=ya.EmailAddresses[0];let Ka=ya.Type;if(void 0===Ka||null===Ka)Ka="User";if(qa=this.$aj(Ka,ya.DisplayName,ya.JobTitle,ja,qa,pa,C))qa.description=ja,ja=ya.JobTitle,"Department"in ya&&"CompanyName"in ya&&(ja+="@"+ya.Department+"@"+ya.CompanyName),qa.jJd=ja,Z.Qv(qa)}return Z}Mag(ja,C,pa){const Z=new F.a(15);Z.displayName=CommonUIStrings.l_TellMeFileProviderTitle;for(const Ka of ja)if(this.aSj(Ka)){var qa=
Ka.FileName;ja=Ka.FileExtension;const Da=qa.length>ja.length?qa.substr(0,qa.length-ja.length-1):Ka.Title;var ya=void 0;ja=0;"DateCreated"in Ka?(ja=aa.a.c4d(Ka.DateCreated),ya=aa.a.nhg(Ka.DateCreated),ya=String.format(CommonUIStrings.l_CreatedTimeFormatString,Ka.Author,ya)):ya=Ka.Author;const la=Ka.AccessUrl+"?web=1",ma=P.a.t3b(la);qa=String.format('<a href="{0}">{1}</a>',ma,P.a.URa(qa));if(pa!==h.a.contextMenu||P.a.g8(la))if(qa=this.t5i(Da,pa===h.a.contextMenu?qa:la,ya,Ka.FileExtension,Ka.Text,C))qa.description=
Ka.Author,qa.XBc=ja,Z.Qv(qa)}return Z}Udb(ja,C,pa,Z,qa){Z===this.KH&&(this.Pha(),E.TellMeActor.instance.Cd.K4(C.Gf.length,this.azc.join(","),ja.data.Le.toString(),Math.round(window.performance.now()-qa),L.a.substrate,!1,v.a.xsa));ja=new I.a(C);pa.resultsUpdated(ja)}$aj(ja,C,pa,Z,qa,ya,Ka){Ka=Ka?this.$Bf:this.bgf;if(!window.LPC&&!aa.a.F$d()||this.XQb===Ka)return null;this.XQb+=1;Ka="PeopleSuggestion"+this.XQb.toString();var Da=this.mjf+"?size=1&accountName="+Z;ja=Object.assign(new O.a,{PersonaType:ja,
Smtp:Z,ProfilePictureUrl:Da,AadObjectId:qa});const la=Object.assign(new T.a,{identifiers:ja,displayName:C});ja=ya===h.a.contextMenu;this.vb.eja?(E.TellMeActor.instance.actions.push(appChrome.actions.setPersonaButtonCoauthor(Ka,la,C,pa)),ya===h.a.contextMenu&&(pa=aa.a.pVf(C,Z,qa),E.TellMeActor.instance.actions.push(appChrome.actions.setButtonCommandValueId(Ka,pa))),E.TellMeActor.instance.actions.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ka,ja))):(Da=[],Da.push(appChrome.actions.setPersonaButtonCoauthor(Ka,
la,C,pa)),ya===h.a.contextMenu&&(pa=aa.a.pVf(C,Z,qa),Da.push(appChrome.actions.setButtonCommandValueId(Ka,pa))),Da.push(appChrome.actions.updatePersonaButtonLPCEnabledDisabledState(Ka,ja)),appChrome.api.dispatch(Da));return new u.a(Ka,11,C,Z,0)}P$i(ja,C,pa,Z,qa,ya,Ka){if(qa&&!this.vb.$zg||this.gwc===this.Jvc||this.xQb===this.Jvc||this.ZMa===this.Jvc)return null;var Da=null;this.gwc+=1;qa="";const la=[],ma={};Ka.type="Notes";this.qhf=Object.assign(new K.a,{landingTab:"Notes",data:Ka});ya=aa.a.VOa(ya.Gf,
33,this.qhf);if("onenotepagepreviews"===ja){if(!("ClickthroughUrl"in Ka&&Ka.ClickthroughUrl)||""===Ka.ClickthroughUrl)return null;this.xQb+=1;qa="OnenoteNotesSuggestion"+this.xQb.toString();ma["default"]="SaveAsonetoc2_20";Da=Ka.ClickthroughUrl;la.push(appChrome.actions.setControlIconSet(qa,ma));la.push(appChrome.actions.setCompoundButtonCommandValueId(qa,Da));Da=new u.a(qa,19,null,null,0)}else if("stickynote"===ja){if(!this.Ixf)return null;this.ZMa+=1;qa="NotesSuggestion"+this.ZMa.toString();ma["default"]=
"ShowAllNotes_20";la.push(appChrome.actions.setControlIconSet(qa,ma));la.push(appChrome.actions.setCompoundButtonCommandValueId(qa,ya));Da=new u.a(qa,21,null,null,0)}else if("samsung"===ja){if(!this.Ixf)return null;this.ZMa+=1;qa="NotesSuggestion"+this.ZMa.toString();ma["default"]="CategoryCollapsed_20";la.push(appChrome.actions.setControlIconSet(qa,ma));la.push(appChrome.actions.setCompoundButtonCommandValueId(qa,ya));Da=new u.a(qa,20,null,null,0)}""!==qa&&(ja=aa.a.nhg(C),ja=String.format(CommonUIStrings.l_LastModifiedString,
ja),Da.label=Z,Da.XBc=aa.a.c4d(C),la.push(appChrome.actions.setControlLabel(qa,Z)),la.push(appChrome.actions.updateCompoundButtonDescription(qa,ja)),la.push(appChrome.actions.setControlCustomTooltip(qa,pa)),appChrome.api.dispatch(la));return Da}t5i(ja,C,pa,Z,qa,ya){if(this.JNb===(ya?this.ZBf:this.$yf))return null;this.JNb+=1;ya="FileSuggestion"+this.JNb.toString();const Ka=[],Da={};Da["default"]=aa.a.S6i(Z);this.vb.eja?(E.TellMeActor.instance.actions.push(appChrome.actions.setControlLabel(ya,ja)),
E.TellMeActor.instance.actions.push(appChrome.actions.setControlIconSet(ya,Da)),E.TellMeActor.instance.actions.push(appChrome.actions.updateCompoundButtonDescription(ya,pa)),E.TellMeActor.instance.actions.push(appChrome.actions.setCompoundButtonCommandValueId(ya,C)),E.TellMeActor.instance.actions.push(appChrome.actions.setControlCustomTooltip(ya,qa))):(Ka.push(appChrome.actions.setControlLabel(ya,ja)),Ka.push(appChrome.actions.setControlIconSet(ya,Da)),Ka.push(appChrome.actions.updateCompoundButtonDescription(ya,
pa)),Ka.push(appChrome.actions.setCompoundButtonCommandValueId(ya,C)),Ka.push(appChrome.actions.setControlCustomTooltip(ya,qa)),appChrome.api.dispatch(Ka));return new u.a(ya,6,ja,pa,0)}C3d(){const ja=[];this.vb.xnc&&Array.add(ja,"People");this.vb.wnc&&Array.add(ja,"File");this.vb.ZSa&&Array.add(ja,"Notes");return ja}Igj(ja,C,pa,Z){var qa=new y(ja);ja=new w("File",qa,0,Z?this.ZBf:this.$yf,null);Z=new w("People",qa,0,Z?this.$Bf:this.bgf,aa.a.Vwk);qa=new w("Notes",qa,0,this.Jvc,null);C=new A("app",C.toLowerCase());
var ya=[];Array.add(ya,C);C=new D("tellmesearch",ya);ya=[];this.vb.wnc&&Array.add(ya,ja);this.vb.xnc&&Array.add(ya,Z);this.vb.ZSa&&Array.add(ya,qa);pa=new H(ya,"UTC",pa,C);return X.c(pa)}Hgj(){let ja=this.vb.nkl;this.vb.ZSa&&(ja+="?&setflight=NotesFrom3S");""!==this.vb.Agg&&(ja=ja+"&"+this.vb.Agg);return ja}kSj(ja){return"DisplayName"in ja&&"Id"in ja&&"EmailAddresses"in ja&&!!ja.Id&&!!ja.EmailAddresses}aSj(ja){return"FileExtension"in ja&&!!ja.FileExtension&&"FileName"in ja&&!!ja.FileName&&""!==ja.FileName&&
"AccessUrl"in ja&&!!ja.AccessUrl&&""!==ja.AccessUrl}jSj(ja){return"Id"in ja&&!!ja.Id&&"NotesType"in ja&&!!ja.NotesType&&"Subject"in ja&&!!ja.Subject&&""!==ja.Subject}}Object(J.a)(ia,"SubstrateResultsProvider",null,[693])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.chronos1.js.map