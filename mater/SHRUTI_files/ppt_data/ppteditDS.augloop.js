'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[10],{1206:function(J,V,d){d.r(V);var h=d(0),e=d(376),m=d(25),r=d(54),v=d(68),A=d(17),w=d(13);class y{constructor(){this.ContextId=this.SessionId=this.AppId=this.Payload=this.Topic=null}}Object(h.a)(y,"AugmentationServiceRequest",null,[]);var u=d(33),D=d(67);class F{constructor(da,Fa,Ua){this.Enb=this.Lpa=null;this.zJh=Ua;this.eb=Fa;this.$h=da}initialize(){e.ULS.sendTraceTag(25747911,306,50,"Start initialing augmentation loop ...");
const da=this.eb.Ga("AugmentationLoopWebServiceBase"),Fa=this.eb.Ga("WebServiceBase");this.Lpa=(void 0===da?Fa:da)+"proofing.ashx?"+m.AFrameworkApplication.hh+"&apitype=AL";this.Enb=new D.a;e.ULS.sendTraceTag(25747912,306,50,"Augmentation Loop initialized")}addEventHandler(da,Fa){if(da&&""!==da)if(Fa){if(!({value:Ua}=this.Enb.Rf(da)).returnValue){var Ua=new A.a;this.Enb.add(da,Ua)}Ua.contains(Fa)||Ua.add(Fa)}else e.ULS.sendTraceTag(25747914,306,15,"eventHandler is null");else e.ULS.sendTraceTag(25747913,
306,15,"topic is empty or null")}removeEventHandler(da,Fa){da&&""!==da?Fa?this.Enb.Jb(da)?({value:da}=this.Enb.Rf(da),da&&da.contains(Fa)&&da.remove(Fa)):e.ULS.sendTraceTag(25747917,306,15,"Topic {0} doesn't exist in handler map.",da):e.ULS.sendTraceTag(25747916,306,15,"Try to remove null handler"):e.ULS.sendTraceTag(25747915,306,15,"topic is empty or null")}EJe(da,Fa,Ua){this.Njc(da,Fa,Ua,Object(w.a)(this,this.BIa,"requestSucceeded"),Object(w.a)(this,this.zIa,"requestFailed"))}Njc(da,Fa,Ua,cb,Jb,
Gc=null){da=Object.assign(new y,{Topic:da,Payload:Fa,AppId:this.zJh,SessionId:this.$h.userSessionId,ContextId:Ua});this.$h.yj(this.Lpa,2,u.c(da),{"Content-Type":"application/json; charset=utf-8"},!1,3,cb,Jb,Gc?Gc:da,void 0,void 0,void 0,void 0,"18")}BIa(da){!m.AFrameworkApplication.Vg&&da&&da.data&&this.Ujk(da.data.Sd)}zIa(da){!m.AFrameworkApplication.Vg&&da&&da.data&&e.ULS.sendTraceTag(25747918,306,15,"{0}",da.data.Sd)}Ujk(da){if(da){try{var Fa=u.a(da)}catch(Ua){e.ULS.sendTraceTag(36284437,306,10,
"Try parse aug response failed:{0}",Ua.message);return}if(({value:da}=this.Enb.Rf(Fa.Topic)).returnValue)for(let Ua of da)Ua(Fa.ContextId,Fa.Payload);else e.ULS.sendTraceTag(25747919,306,50,"Cannot find handlers for Topic:{0};",Fa.Topic)}}}Object(h.a)(F,"AugmentationManager",null,[760]);var I=d(1166);class H{}Object(h.a)(H,"HostMetadata",null,[]);class L{}Object(h.a)(L,"Lambda",null,[]);class E extends L{constructor(){super()}}Object(h.a)(E,"WrapperLambda",L,[]);var aa=d(386),Q=d(135);class O{constructor(){this.handler=
this.schemaName=null}}Object(h.a)(O,"AddEventHandlerParameters",null,[]);var T=d(648);class K{constructor(){this.lambda=this.name=null}}Object(h.a)(K,"RegisterSimpleLocalWorkflowParameters",null,[]);class X{constructor(){this.lambdaAfter=this.lambdaRemote=this.lambdaBefore=this.name=null}}Object(h.a)(X,"RegisterSimpleRemoteWorkflowParameters",null,[]);var P=d(943);class ea{constructor(){this.requestAuthTokenCallback=null}}Object(h.a)(ea,"SetRequestAuthTokenCallbackParameters",null,[]);class ia{constructor(){this.sendOTelEvent=
null}}Object(h.a)(ia,"SetSendOTelEventCallbackParameters",null,[]);class ja{constructor(){this.ulsLogger=null}}Object(h.a)(ja,"SetULSLoggerParameters",null,[]);var C=d(898);class pa{constructor(){this.correlationVector=this.input=this.inputSchema=null}}Object(h.a)(pa,"SubmitParameters",null,[]);var Z=d(522);class qa{constructor(da,Fa=null){this.AY=null;new D.a;new H;this.MWh=da;this.yMa=Fa}initialize(da){this.AY?e.ULS.sendTraceTag(51185349,306,15,"Initialize called multiple times."):(da||(da=new T.a),
this.AY=new Promise(Fa=>{e.ULS.sendTraceTag(51185350,306,50,"Start download and initialize augloop runtime ...");const Ua=m.AFrameworkApplication.Jj("al",2);this.MWh.Cxb(Ua).continueWith(()=>{e.ULS.sendTraceTag(51185351,306,50,"augloop: Successfully loaded script");const cb=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();cb.setRequestAuthTokenCallback(Object.assign(new ea,{requestAuthTokenCallback:Object(w.a)(this,this.aVk,"requestAuthToken")}));cb.setULSLogger(Object.assign(new ja,{ulsLogger:new aa.a}));
cb.setSendOTelEventCallback(Object.assign(new ia,{sendOTelEvent:Object(w.a)(this,this.sendOTelEvent,"sendOTelEvent")}));let Jb=m.AFrameworkApplication.fa.Ga("OfficeApplicationName")||"";Jb=Jb.replace("Web","");da.appName=da.appName||Jb;da.serviceUrl=da.serviceUrl||m.AFrameworkApplication.fa.Ga("AugLoopCloudALServiceUrl");da.appVersion=da.appVersion||m.AFrameworkApplication.fa.Ga("BuildVersion")||"";da.releaseAudienceGroup=da.releaseAudienceGroup||(m.AFrameworkApplication.$c?Object(I.a)(String,m.AFrameworkApplication.$c.AudienceGroup)||
"":"");da.sessionId=da.sessionId||m.AFrameworkApplication.fa.Ga("SessionId")||"";da.uiLanguage=da.uiLanguage||m.AFrameworkApplication.uiCulture;da.flights=da.flights||this.hZi();da.initSession=da.initSession||!0;da.downloadBaseUrl=da.downloadBaseUrl||m.AFrameworkApplication.fa.Ga("AugLoopDownloadBaseUrl");cb.initialize(da);Fa({})})}))}registerSchemas(){e.ULS.sendTraceTag(51185352,306,50,"RegisterSchemas is a No-Op");return this.AY}registerSimpleLocalWorkflow(da,Fa){return this.AY.then(()=>{e.ULS.sendTraceTag(51185353,
306,50,"Registering local workflow: {0} to AugLoop.",da);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleLocalWorkflow(Object.assign(new K,{name:da,lambda:this.Bmd(Fa)}))})}registerSimpleRemoteWorkflow(da,Fa,Ua,cb){return this.AY.then(()=>{e.ULS.sendTraceTag(51185354,306,50,"Registering remote workflow: {0} to AugLoop.",da);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().registerSimpleRemoteWorkflow(Object.assign(new X,{name:da,lambdaBefore:this.Bmd(Fa),lambdaRemote:this.Bmd(Ua),
lambdaAfter:this.Bmd(cb)}))})}registerReduceWorkflow(){e.ULS.sendTraceTag(51185355,306,100,"RegisterReduceWorkflow is NYI");return this.AY}submit(da,Fa){this.AY.then(()=>{e.ULS.sendTraceTag(51185356,306,100,"Submitting event: {0} to AugLoop.",da);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submit(Object.assign(new pa,{inputSchema:da,input:Fa}))})}flushTelemetry(){e.ULS.sendTraceTag(51185357,306,100,"FlushTelemetry is NYI")}submitOperation(da){this.AY.then(()=>{e.ULS.sendTraceTag(51185358,306,
100,"Submitting Operation: {0} to AugLoop.",da);augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().submitOperation(Object.assign(new C.a,{operation:da}))})}setSessionDataCallback(da){this.AY.then(()=>{e.ULS.sendTraceTag(592318537,306,100,"Setting SessionData Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionDataCallback(da)})}setInitSessionCallback(da){this.AY.then(()=>{e.ULS.sendTraceTag(594384065,306,100,"Setting init session override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setInitSessionCallback(da)})}setSessionInitOverrideCallback(da){this.AY.then(()=>
{e.ULS.sendTraceTag(594384064,306,100,"Setting session init override Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setSessionInitOverrideCallback(da)})}setAnnotationResultCallback(da){this.AY.then(()=>{e.ULS.sendTraceTag(51185359,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().setAnnotationResultCallback(Object.assign(new P.a,{handler:da}))})}activateAnnotation(da){return this.AY.then(()=>{e.ULS.sendTraceTag(51226247,306,100,"Activating Annotation: {0}",
da.annotationType);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().activateAnnotation(da)})}releaseAnnotation(da){return this.AY.then(()=>{e.ULS.sendTraceTag(51226248,306,100,"Releasing Annotation: {0}",da.token);return augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().releaseAnnotation(da)})}addEventHandler(da,Fa){da&&""!==da?Fa?this.AY.then(()=>{e.ULS.sendTraceTag(51185362,306,100,"Setting Result Callback");augLoop.ALFactoryGlobal.getAugLoopRuntimeManager().addEventHandler(Object.assign(new O,
{schemaName:da,handler:Ua=>{Ua&&Fa(Ua.inputSchema,Ua.input,Ua.outputSchema,Ua.output)}}))}):e.ULS.sendTraceTag(51185361,306,15,"eventHandler is null"):e.ULS.sendTraceTag(51185360,306,15,"schemaName is empty or null")}removeEventHandler(){e.ULS.sendTraceTag(51185363,306,100,"RemoveEventHandler is NYI.")}aVk(){const da=m.AFrameworkApplication.fa.Ga("AugLoopOAuthResourceUriV2");if(this.yMa)return new Promise(Fa=>{this.yMa.execute(Ua=>{Ua.KU("AugLoop",da).then(cb=>{cb.IsSuccess?Fa(cb.Token):(e.ULS.sendTraceTag(51499467,
306,15,cb.ErrorMessage),Fa(m.AFrameworkApplication.fa.Ga("AugloopACLPUserDataSignature")||""));return{}})})});e.ULS.sendTraceTag(51499468,306,50,"Auth requested without a IOAuthManager");return Promise.resolve("")}sendOTelEvent(da){Q.a.sendOtelEvent(Object.assign(new Z.a,{otelEvent:da}))}Bmd(da){if(da){let Fa=null;da.func&&(Fa=(Ua,cb,Jb,Gc)=>{da.func(Ua,cb,Gc)});return Object.assign(new E,{name:da.name,inputSchema:da.inputSchema,outputSchema:da.outputSchema,func:Fa})}return null}hZi(){var da=m.AFrameworkApplication.fa.Ga("FlightId");
const Fa=m.AFrameworkApplication.fa.XB("AugLoopFlightKeywordList"),Ua=[];if(da&&""!==da&&Fa&&0<Fa.length){da=da.split(";");for(let cb=0;cb<da.length;cb++)for(let Jb=0;Jb<Fa.length;Jb++)-1<da[cb].toLowerCase().indexOf(Fa[Jb].toLowerCase())&&Array.add(Ua,da[cb])}return 0<Ua.length?Ua.join(";"):""}}Object(h.a)(qa,"NewAugLoopRuntimeManager",null,[759]);var ya=d(55),Ka=d(1197),Da=d(45);class la{}Object(h.a)(la,"Lambda",null,[801]);var ma=d(896);class Ea{constructor(){this.documentOpenType=this.getItemsEndPoint=
this.downloadUrl=null}}Object(h.a)(Ea,"PowerPointParameters",null,[]);class ta{constructor(){this.initSessionCallback=null}}Object(h.a)(ta,"SetInitSessionCallbackParameters",null,[]);class Ga{constructor(){this.sessionDataCallback=this.handler=null}}Object(h.a)(Ga,"SetSessionDataCallbackParameters",null,[]);class oa{constructor(){this.handler=null}}Object(h.a)(oa,"SetSessionInitOverrideCallbackParameters",null,[]);var sa=d(454),Ha=d(511),bb=d(128);class Ya extends Ha.a{constructor(){super();this.H_=
Object.assign(new bb.a,{T_:Ya.getTypeName(),B_:Ya.ul()})}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static ul(){return["AugLoop_Core_Operation"]}}Object(h.a)(Ya,"DeleteOperation",Ha.a,[]);var ua=d(676),Ma=d(255);class Ca extends Ma.a{constructor(){super();this.bridgeId=this.cv=this.messageId=null;this.H_=Object.assign(new bb.a,{T_:Ca.getTypeName(),B_:Ca.ul()})}static getTypeName(){return"AugLoop_Session_Protocol_Message"}static ul(){return[]}}Object(h.a)(Ca,"Message",Ma.a,[]);class Va extends Ca{constructor(){super();
this.protocolVersion=0;this.enableRemoteExecutionNotification=this.enableSessionInspectorLogs=this.returnWorkflowInputTypes=this.extensionConfigs=this.authToken=this.origin=this.sessionKey=this.serviceUrl=this.clientMetadata=null;this.H_=Object.assign(new bb.a,{T_:Va.getTypeName(),B_:Va.ul()})}static getTypeName(){return"AugLoop_Session_Protocol_SessionInitMessage"}static ul(){return["AugLoop_Session_Protocol_Message"]}}Object(h.a)(Va,"SessionInitMessage",Ca,[]);class Za extends Va{constructor(){super();
this.documentOpenType=this.getItemsEndPoint=this.downloadUrl=null;this.H_=Object.assign(new bb.a,{T_:Za.getTypeName(),B_:Za.ul()})}static getTypeName(){return"AugLoop_Powerpoint_Session_Protocol_PowerPointSessionInitMessage"}static ul(){return["AugLoop_Session_Protocol_SessionInitMessage","AugLoop_Session_Protocol_Message"]}}Object(h.a)(Za,"PowerPointSessionInitMessage",Va,[]);var Db=d(38);class Lb{constructor(){this.authToken=this.origin=this.gmh=null}}Object(h.a)(Lb,"SessionData",null,[]);var yb=
d(527);class Bc{constructor(da,Fa,Ua){this.Lfe=new D.a;this.nYc=new D.a;this.mfe=new D.a;this.qBb=this.z4c=this.Hyb=this.xQ=null;this.OG=da;this.Ha=Fa;this.pi=Ua;const cb=new T.a;cb.powerpoint=new Ea;if(Db.a("AL.SendSlideTile"))if(Db.a("AL.EnableRehydration"))this.OG.initialize(new T.a),this.OG.setInitSessionCallback(Object.assign(new ta,{initSessionCallback:Object(w.a)(this,this.pqk,"onSessionInit")})),this.OG.setSessionInitOverrideCallback(Object.assign(new oa,{handler:Object(w.a)(this,this.qqk,
"onSessionInitOverride")})),this.qBb=this.aSc(),this.OG.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult")),this.J8=Promise.resolve(null);else{da=ya.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;Fa=ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;da=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",Fa,da);Fa=ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").i7a?
ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").RNc:ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var Jb=String.format("{0}getitems.ashx",Fa);Fa=new Ka.a(m.AFrameworkApplication.Ge);this.J8=yb.b(Fa.QJe(da));this.J8.then(Gc=>{try{const pd=JSON.parse(Gc),Ld=pd.downloadUrl;Da.a.Va(Ld)?e.ULS.sendTraceTag(51422528,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",pd):(cb.powerpoint.downloadUrl=Ld,cb.powerpoint.getItemsEndPoint=
Jb,this.Ha.DZb&&(cb.powerpoint.documentOpenType=this.Edg()))}catch(pd){e.ULS.sendTraceTag(51422529,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",pd)}this.OG.initialize(cb);this.qBb=this.aSc();this.OG.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult"));return null}).catch(Gc=>{e.ULS.sendTraceTag(51422530,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Gc);this.OG.initialize(cb);this.qBb=this.aSc();
this.OG.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult"))})}else this.J8=new Promise(Gc=>{this.OG.initialize(cb);this.qBb=this.aSc();this.OG.setAnnotationResultCallback(Object(w.a)(this,this.onAnnotationResult,"onAnnotationResult"));Gc("")})}Pnb(da){this.J8.then(Fa=>{this.OG.activateAnnotation(Object.assign(new ma.a,{annotationType:da}));return Fa})}cjc(da,Fa){if(da)if(Fa){if(!({value:Ua}=this.Lfe.Rf(da)).returnValue){var Ua=new A.a;this.Lfe.add(da,Ua)}Ua.contains(Fa)||
Ua.add(Fa)}else e.ULS.sendTraceTag(51388803,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(51388802,306,15,"Annotation Type is null or empty")}vMk(da,Fa){if(da)if(Fa){if(!({value:Ua}=this.nYc.Rf(da)).returnValue){var Ua=new A.a;this.nYc.add(da,Ua)}Ua.contains(Fa)||Ua.add(Fa)}else e.ULS.sendTraceTag(575931363,306,15,"AnnotationHandler is null");else e.ULS.sendTraceTag(575931362,306,15,"Annotation Type is null or empty")}addEventHandler(da,Fa){this.J8.then(()=>{this.OG.addEventHandler(da,
Fa);return null})}removeEventHandler(da,Fa){this.J8.then(()=>{this.OG.removeEventHandler(da,Fa);return null})}registerSimpleLocalWorkflow(da,Fa){return this.J8.then(()=>this.OG.registerSimpleLocalWorkflow(da,this.Cmd(Fa)))}registerSimpleRemoteWorkflow(da,Fa,Ua,cb){return this.J8.then(()=>this.OG.registerSimpleRemoteWorkflow(da,this.Cmd(Fa),this.Cmd(Ua),this.Cmd(cb)))}submit(da,Fa){this.J8.then(()=>{this.OG.submit(da,Fa);return null})}submitOperation(da){this.J8.then(()=>{this.OG.submitOperation(da);
return null})}Czl(da,Fa,Ua,cb,Jb){this.qBb&&this.qBb.then(()=>{this.pi.augmentImage(da,Fa,Ua,!0,this.z4c.gmh,this.z4c.origin,this.z4c.authToken,cb,Jb);return null})}qqk(da){e.ULS.sendTraceTag(594609494,306,50,"PPTAugLoopRuntimeManager: OnSessionInitOverride");const Fa=Object.assign(new Za,{protocolVersion:da.protocolVersion,clientMetadata:da.clientMetadata,sessionKey:da.sessionKey,origin:da.origin,authToken:da.authToken,messageId:da.messageId,cv:da.cv});try{this.Ha.DZb&&(Fa.documentOpenType=this.Edg())}catch(Ua){e.ULS.sendTraceTag(578155528,
306,10,"PPTWebEditorAugLoopRunTimeManager::OnSessionInitOverride exception:{0}",Ua)}this.g4k(da);if(Da.a.Va(this.xQ)||Da.a.Va(this.Hyb))return e.ULS.sendTraceTag(594609493,306,15,"PPTAugLoopRuntimeManager: Failed to override sessionInitMessage, null or empty downloadUrl obtained"),da;Fa.downloadUrl=this.xQ;Fa.getItemsEndPoint=this.Hyb;this.Hyb=this.xQ=null;return Fa}pqk(){e.ULS.sendTraceTag(594609492,306,50,"PPTAugLoopRuntimeManager: OnSessionInit");var da=ya.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;
const Fa=ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;var Ua=ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").i7a?ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").RNc:ya.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;da=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",Fa,da);const cb=String.format("{0}getitems.ashx",Ua);Ua=new Ka.a(m.AFrameworkApplication.Ge);return yb.b(Ua.QJe(da)).then(Jb=>
{try{const Gc=JSON.parse(Jb),pd=Gc.downloadUrl;Da.a.Va(pd)?e.ULS.sendTraceTag(594609491,306,15,"PPTAugLoopRuntimeManager: GetSnappedDownloadLink returned a bad response: {0}",Gc):(this.xQ=pd,this.Hyb=cb)}catch(Gc){e.ULS.sendTraceTag(594609490,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Gc)}return null}).catch(Jb=>{e.ULS.sendTraceTag(594609489,306,15,"PPTAugLoopRuntimeManager: Failed to retreive document download URL: {0}",Jb)})}aSc(){return new Promise(da=>{this.OG.setSessionDataCallback(Object.assign(new Ga,
{sessionDataCallback:(Fa,Ua,cb)=>{this.z4c=Object.assign(new Lb,{gmh:Fa,origin:Ua,authToken:cb});da(null)}}))})}onAnnotationResult(da){if(da&&da.items)if(Ma.a.BPc(da)!==sa.a.getTypeName()&&Ma.a.BPc(da)!==ua.a.getTypeName())this.Ha.z0f&&Ma.a.BPc(da)===Ya.getTypeName()&&this.llk(da);else for(const Ua of da.items){if(!Ua||!Ua.body)continue;const cb=Ma.a.BPc(Ua.body);if(!cb)continue;var Fa=Ua.body||{};da.parentPath&&(Fa.parentPath=da.parentPath);let Jb=null;if(!({value:Jb}=this.Lfe.Rf(cb)).returnValue)e.ULS.sendTraceTag(51388804,
306,50,"Cannot find handlers for annotation:{0};",cb);else if(Jb)for(let Gc of Jb)Gc(Fa);if(this.Ha.z0f){Fa=null;if(({value:Fa}=this.nYc.Rf(cb)).returnValue)for(let Gc of Fa)Gc(Ua,!1);Da.a.Va(Ua.id)||this.mfe.$(Ua.id,cb)}}}llk(da){for(const Fa of da.items){if(!Fa||!Fa.id)continue;if(!({value:da}=this.mfe.Rf(Fa.id)).returnValue)continue;let Ua=null;if(({value:Ua}=this.nYc.Rf(da)).returnValue)for(let cb of Ua)cb(Fa,!0);this.mfe.remove(Fa.id)}}Cmd(da){return da?Object.assign(new la,{name:da.name,inputSchema:da.inputSchema,
outputSchema:da.outputSchema,func:da.func}):null}Edg(){try{return this.Ha.NS?0:this.Ha.fTa?2:1}catch(da){return e.ULS.sendTraceTag(578697036,306,50,"PPTWebEditorAugLoopRunTimeManager::GetOpenType :{0};",da),2}}g4k(da){try{Da.a.Va(da.clientMetadata.flights)?da.clientMetadata.flights=";":da.clientMetadata.flights+=";",this.Ha.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",!1)?da.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Treatment;":
da.clientMetadata.flights+="Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled-Control;"}catch(Fa){e.ULS.sendTraceTag(559445142,306,50,"PPTWebEditorAugLoopRunTimeManager::SetFlights :{0};",Fa)}}}Object(h.a)(Bc,"PPTAugLoopRuntimeManager",null,[758]);class tb{constructor(da){this.eT=da;this.eT.initialize()}addEventHandler(da,Fa){this.eT.addEventHandler(da,Fa)}removeEventHandler(da,Fa){this.eT.removeEventHandler(da,Fa)}EJe(da,Fa,Ua){this.eT.EJe(da,Fa,Ua)}Njc(da,Fa,Ua,cb,Jb,Gc=
null){this.eT.Njc(da,Fa,Ua,cb,Jb,Gc)}}Object(h.a)(tb,"PPTAugmentationManager",null,[757]);class Mb{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AugmentationLoop"}Wb(da){this.K=da;this.K.register(tb,"PowerPointWebEditor.AugmentationLoop.PPTAugmentationManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager").ma().na(()=>new tb(new F(m.AFrameworkApplication.Ge,da.resolve("Common.IAppSettingsManager"),"PowerPoint_Online")));this.K.register(Bc,"PowerPointWebEditor.AugmentationLoop.PPTAugLoopRuntimeManager").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").ma().na(()=>
{const Fa=r.a.CSj();e.ULS.sendTraceTag(40235107,306,50,"IsWebSocketSupported: {0}",Fa);m.AFrameworkApplication.fa.appSettings.AugLoopUseWebSocket=Fa.toString();return new Bc(new qa(da.resolve("Common.ISharedDependencyLoader"),da.Ka("Common.App.OAuth.IOAuthManager")),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"))})}init(){this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager");this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled&&
this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")}dispose(){}static main(){v.a.instance.Bc(new Mb)}}Object(h.a)(Mb,"PPTWebEditorAugmentationLoopPackage",null,[2,3]);var Hb=d(1165),vb=d(897),Xb=d(895),Uc=d(541),hb=d(62),Zb=d(31),Fc=d(26);class ob{constructor(da){if(!da)throw Error.argumentNull("Handler for Text Prediction is Null- unable to retrieve initial text prediction signal state");this.Z_=da}G2b(da){this.cTe(da)}cTe(da){if(da){try{const Jb=da.parentPath;if(!Jb||
4>Jb.length){Fc.a.J(590181647,820,50,"ParentPath is Null or Empty.");return}const Gc=Jb[3];var Fa=Jb[2];if(!Gc){Fc.a.J(590181645,820,50,"Unable to retreive original paragraph text");return}var Ua=this.Z_.u7i(Gc);this.Z_.$Pk(Gc);const pd=da.predictions;if(!pd||!pd.length){Fc.a.J(590181643,820,50,"Augloop Annotations Null or Empty.");return}const Ld=pd[0];if(!Ld)return;var cb=Ld.text;if(!cb||!cb.length){Fc.a.J(590181641,820,50,"Text Predictions Null or Empty.");return}}catch(Jb){Fc.a.J(590710030,820,
10,"Unable to parse output because of modified output type from Augloop");return}cb&&ob.qJi(cb,Ua,Fa)}else Fc.a.J(590181649,820,50,"Annotations returned from service is null.")}static qJi(da,Fa,Ua){da&&da.length&&(Fa=ob.wbj(da,Fa),-1!==Fa&&(Fa=da.substring(Fa,da.length),Ua=Object.assign(new Xb.a,{text:da,M7:Fa,ox:Ua}),Uc.a.pD.S4=Ua,Uc.a.fKd(da,Fa)))}static wbj(da,Fa){var Ua=hb.a.instance.Oa.kb.Ve.node;if(!Ua||!Fa)return-1;Ua=Zb.ParagraphReader.text(Ua);if(!Ua)return-1;if(Ua!==Fa)if(Ua.length>Fa.length&&
Ua.substring(0,Fa.length)===Fa){if(!da.startsWith(Ua.substring(Fa.length,Ua.length-Fa.length)))return-1;Fc.a.J(590181638,820,50,"Ghost Text matches part of the Prediction Text.")}else return-1;return" "===Ua.substring(Ua.length-1,1)?0:ob.qcg(Ua)}static qcg(da){return da?da.length-1-da.lastIndexOf(" "):-1}}Object(h.a)(ob,"TextPredictionAugLoopResponseManager",null,[]);var ac=d(106),pb=d(426);class nb extends Ha.a{constructor(){super();this.H_=Object.assign(new bb.a,{T_:nb.getTypeName(),B_:nb.ul()})}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static ul(){return["AugLoop_Core_Operation"]}}
Object(h.a)(nb,"SignalOperation",Ha.a,[]);var Tb=d(1015);class Ub{constructor(){this.ABe=!1}}Object(h.a)(Ub,"PredictionSettings",null,[]);class hc{constructor(da,Fa){this.E4c=null;this.Kle={};this.OG=da;this.Ob=Fa;this.Ob.zBc(Object(w.a)(this,this.skg,"handleResize"))}u7i(da){return this.Kle[da]}U4k(da,Fa){this.Kle[da]=Fa}$Pk(da){da&&delete this.Kle[da]}get settings(){this.E4c||(this.E4c=Object.assign(new Ub,{ABe:!1}));return this.E4c}set settings(da){this.E4c=da}Trl(da){if(this.settings.ABe&&da){var Fa=
da.id.toString(),Ua=Uc.a.pD.S4,cb=hb.a.instance.Oa.kb;if(cb&&1===cb.length&&cb.Ve){cb=cb.Ve;var Jb=cb.node;if(Zb.ParagraphReader.textLength(Jb)===cb.Qa){if(Ua&&Jb&&Fa===Ua.ox&&Fa===Jb.id.toString()&&(cb=this.v0d(Ua,Jb))){Ua.M7=cb;Uc.a.fKd(Ua.text,cb);return}Uc.a.pD.S4=null;Ua=ac.a.create().toString();cb=Zb.ParagraphReader.text(da);this.U4k(Ua,cb);da=["Signal",Tb.a.getTypeName(),Fa,Ua];Ua=hc.r$i(cb);Fa=[Object.assign(new pb.a,{id:Fa,body:Ua})];var Gc=Object.assign(new nb,{parentPath:da,items:Fa});
this.OG.execute(pd=>{pd.submitOperation(Gc);Fc.a.J(512493778,820,50,"TextPrediction Signal sent to Augloop Service")})}}}}KFb(){Uc.a.pD.S4=null;Uc.a.TRa()}H2b(da){!da||1<da.length?this.KFb():1>da.length||((da=da[0])&&da.context?(da=da.context,da.Qa===da.Kb&&Zb.ParagraphReader.textLength(da.node)===da.Qa||this.KFb()):this.KFb())}v0d(da,Fa){var Ua=null;if(da&&Fa){Fa=Zb.ParagraphReader.text(Fa);da=da.text;if(!Fa||!da)return Ua;Fa=Fa.replace(RegExp("\\u00a0","g")," ");da=da.replace(RegExp("\\u00a0","g"),
" ");if(Fa){if(Fa.endsWith(da))return this.KFb(),Ua;Ua=hc.raj(Fa,da);Ua=da.substring(Ua,da.length)}}return Ua}skg(){Uc.a.TRa()}dispose(){this.Ob.Ned(Object(w.a)(this,this.skg,"handleResize"))}static r$i(da){return Object.assign(new Tb.a,{languageId:"en-US",startOfSentence:!0,text:da})}static raj(da,Fa){for(let Ua=Fa.length;0<Ua;Ua--){const cb=Fa.substring(0,Ua);if(da.endsWith(cb.trimStart()))return cb.length}return 0}}hc.KSa=!1;Object(h.a)(hc,"TextPredictionHandler",null,[785]);var Wb=d(52),fd=d(28);
class fc{constructor(da,Fa){this.ia=da;this.uc=Fa}ub(){this.ia.ya(fd.a.lBk,Wb.a.application,Object(w.a)(this,this.oBk,"predictionHandler"))}oBk(da,Fa,Ua){return m.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?1===Ua?this.uc.Hj()?32:2:8:8}}Object(h.a)(fc,"TextPredictorActor",null,[]);class bc{constructor(){this.Gse=this.K=null}get name(){return"PowerPointWebEditor.TextPrediction"}Wb(da){this.K=da;da.register(fc,"PowerPointWebEditor.TextPrediction.TextPredictorActor").ma().na(()=>new fc(da.resolve("Common.IActionManagerExtended"),
da.resolve("PowerPointWebEditor.IPresentationReader")));da.register(785,"PowerPointWebEditor.TextPrediction.ITextPredictionHandler").ma().na(()=>new hc(da.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),da.resolve("PowerPointWebEditor.Core.IPPTAppFrame")))}init(){this.K.resolve("PowerPointWebEditor.TextPrediction.TextPredictorActor").ub();this.Gse=new Hb.a(()=>new ob(this.K.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(da=>
{da.Pnb(vb.a.getTypeName());da.cjc(vb.a.getTypeName(),Object(w.a)(this.Gse.value,this.Gse.value.G2b,"handleResponse"))})}dispose(){}static main(){v.a.instance.Bc(new bc)}}Object(h.a)(bc,"TextPredictionPackage",null,[2,3]);var cc=d(268),kb=d(27);class ab{}Object(h.a)(ab,"AugContextId",null,[]);class Pb{}Object(h.a)(Pb,"AugParagraph",null,[]);class rc{}Object(h.a)(rc,"AugShape",null,[]);class ic{}Object(h.a)(ic,"ShapeTextTile",null,[]);class md{constructor(da,Fa,Ua,cb){this.Ea=Ua;this.Hh=cb;this.Nb=
da;this.Cl=Fa}SXb(da,Fa){return da&&da.isConnected&&this.Ea.oEa(da)?(da=Object(I.a)(4,da))?Object.assign(new ic,{Topic:"ShapeText",ContextId:u.c(md.Sui(da,Fa)),Data:u.c(this.Tui(da))}):null:null}rXb(da){return da&&da.get_shapeId()&&da.hasText&&!da.Sp?da.t$d:!1}Tui(da){const Fa=[];da=this.Nb.Kc(da);for(da=this.Cl.n2(da,da.currentNode);da.moveNext();){var Ua=da.currentNode;const cb=Ua;this.Hh.Vd(cb)&&(Ua=Object.assign(new Pb,{t:this.Hh.text(cb),l:this.Hh.oeb(Ua)}),Array.add(Fa,Ua))}return Object.assign(new rc,
{p:Fa,c:cc.a.oe(m.AFrameworkApplication.lcid).Bsb})}static Sui(da,Fa){return Object.assign(new ab,{gid:da.id,sid:da.slideSid,cid:da.slideCid,shapeId:da.get_shapeId(),rid:(da.QWc||da.vEa||kb.App.Mm).toString(),t:Fa,c:(new Date).getTime()})}}Object(h.a)(md,"ShapeTextTileManager",null,[781,809]);var Fd=d(101),ne=d(1187),ud=d(198),gb=d(78),Vb;(function(da){da[da.none=0]="none";da[da.onParagraphPropertyChanged=1]="onParagraphPropertyChanged";da[da.onSelectionFinished=2]="onSelectionFinished";da[da.onActiveSlideDomReady=
4]="onActiveSlideDomReady";da[da.onShapeChildTopologyChanged=8]="onShapeChildTopologyChanged";da[da.onParagraphDisconnect=16]="onParagraphDisconnect";da[da.onNumberListPropertyChanged=32]="onNumberListPropertyChanged";da[da.onNumberListDisconnect=64]="onNumberListDisconnect";da[da.onSlideConnected=128]="onSlideConnected";da[da.onSlideDisconnected=256]="onSlideDisconnected"})(Vb||(Vb={}));Object(h.b)("EventNames",Vb);class Lc{constructor(){this.GZa=this.graphNode=null;this.jTa=0;this.lSe=null}}Object(h.a)(Lc,
"TileGraphNode",null,[]);class Xc{constructor(){this.xkh=this.RIe=this.O4d=this.Qig=0}}Object(h.a)(Xc,"TileTelemetry",null,[]);var Ib;(function(da){da[da.unknown=0]="unknown";da[da.activeSlideChanged=1]="activeSlideChanged";da[da.shapeSelected=2]="shapeSelected";da[da.listLevelChanged=3]="listLevelChanged";da[da.richEditTextUnicodeChanged=4]="richEditTextUnicodeChanged";da[da.shapeChildTopologyChanged=5]="shapeChildTopologyChanged";da[da.paragraphDeleted=6]="paragraphDeleted";da[da.numberListDeleted=
7]="numberListDeleted";da[da.numberListPropertyChanged=8]="numberListPropertyChanged";da[da.slideAdded=9]="slideAdded";da[da.slideDeleted=10]="slideDeleted"})(Ib||(Ib={}));Object(h.b)("TriggerName",Ib);var gc=d(420);class Fb{constructor(da,Fa,Ua,cb){this.yb=Fa;this.f3j=Ua;this.$ak=da;this.Ise={};this.N8b={};this.Ob=cb}initialize(){this.ow()}dispose(){this.Ona()}onParagraphPropertyChanged(da,Fa){this.Hra(Fa,1)}DDb(da,Fa){this.Hra(Fa,2)}onActiveSlideDomReady(da,Fa){this.Hra(Fa,4)}onShapeChildTopologyChanged(da,
Fa){this.Hra(Fa,8)}wHa(da,Fa){this.Hra(Fa,16)}p3g(da,Fa){da=new gc.a(!1,null,Fa.Ba);this.Hra(da,4)}get ny(){return this.$ak}get xZ(){return this.Ise}get mia(){return this.N8b}Hra(da,Fa){try{if(2===this.Ob.mode&&Object(ne.a)(Vb,Fa)in this.Ise){var Ua=Date.now();Object(I.a)(832,this.Ise[Object(ne.a)(Vb,Fa)]).P2(da,(cb,Jb)=>{this.olk(cb,Jb,Ua)})}}catch(cb){Fc.a.J(36495880,306,10,"Exception thrown at DetectTiles: "+cb)}}olk(da,Fa,Ua){if(!ud.a.Va(da))try{for(const cb of da){if(!Fd.a.count(this.N8b)){const pd=
new gb.a(3,1,this.f3j,Object(w.a)(this,this.fireTileEvents,"fireTileEvents"),90,"24");this.yb.Cb(pd)}let Jb;if(cb.id.toString()in this.N8b)Jb=Object(I.a)(Lc,this.N8b[cb.id.toString()]),Jb.jTa=Fa;else{const pd=new Xc;Jb=Object.assign(new Lc,{graphNode:cb,jTa:Fa,GZa:{},lSe:pd});this.N8b[cb.id.toString()]=Jb;this.rjk(pd,Ua)}const Gc=Ib[Fa];Jb.GZa[Gc]=(Gc in Jb.GZa?Jb.GZa[Gc]:0)+1}}catch(cb){Fc.a.J(36495882,306,10,"Exception thrown at FireTiles: "+cb)}}rjk(da,Fa){da&&(da.Qig=Fa,da.O4d=Date.now())}JYg(da,
Fa){da&&(da.RIe=Fa,da.xkh=Date.now())}g8f(da){return da?String.format("GraphDetectDuration: {0}, QueueDuration: {1}, ScanGraphSpaceDuration: {2}",da.O4d-da.Qig,da.RIe-da.O4d,da.xkh-da.RIe):""}}Object(h.a)(Fb,"TileTriggerControllerBase",null,[835,106]);class fb extends Fb{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld,de,Be,Mf,Dg,yd){super(pd&31,Ld,Be,Dg);this.wT=da.vd(12);this.CL=da.vd(10);this.ra=Fa;this.od=Ua;this.eT=cb;this.o9=Jb;this.JT=Gc;this.ua=de;this.QT=Mf;this.ybk=yd}ow(){1===(this.ny&1)&&(this.wT.Yj(Object(w.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.xZ[Object(ne.a)(Vb,1)]=this.QT.LCi());2===(this.ny&2)&&(this.ra.VH(Object(w.a)(this,this.DDb,"onProcessSetSelectionFinished")),this.xZ[Object(ne.a)(Vb,2)]=this.QT.MCi());4===(this.ny&4)&&(this.od.uV(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.xZ[Object(ne.a)(Vb,4)]=this.QT.JCi());8===(this.ny&8)&&(this.CL.nG(Object(w.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.xZ[Object(ne.a)(Vb,
8)]=this.QT.NCi());16===(this.ny&16)&&(this.wT.wAa(Object(w.a)(this,this.wHa,"onBeforeParagraphDisconnect")),this.xZ[Object(ne.a)(Vb,16)]=this.QT.KCi())}Ona(){this.wT.tm(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.ra.Ewa(Object(w.a)(this,this.DDb,"onProcessSetSelectionFinished"));this.od.Tma(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.CL.yO(Object(w.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"));this.wT.uIa(Object(w.a)(this,
this.wHa,"onBeforeParagraphDisconnect"))}fireTileEvents(){try{if(this.ua&&this.ua.Ba){var da=this.ua.Ba.jl();for(const Fa of da){const Ua=Fa.id.toString();Ua in this.mia&&(this.z_b(Object(I.a)(Lc,this.mia[Ua])),delete this.mia[Ua])}Fd.a.forEach(this.mia,Fa=>{delete this.mia[Fa]},null)}}catch(Fa){Fc.a.J(36525510,306,10,"Exception thrown at FireTileEvents: "+Fa)}}z_b(da){if(da){var Fa=Date.now(),Ua=this.JT.SXb(da.graphNode,Ib[da.jTa]);if(Ua){this.ybk?this.o9.execute(Jb=>{Jb.submit("ShapeTextTile",Ua)}):
this.eT.execute(Jb=>{Jb.EJe(Ua.Topic,Ua.Data,Ua.ContextId)});const cb=da.lSe;this.JYg(cb,Fa);Fc.a.J(26007383,306,50,"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, {2}",Ib[da.jTa],da.GZa,this.g8f(cb))}}}}Object(h.a)(fb,"ShapeTextTileTriggerController",Fb,[]);var Pc=d(22),dd=d(75),kd=d(36),Td=d(92),ce=d(81),ld=d(165),ad=d(37);class Yf{constructor(){this.lcid=this.end=this.start=0;this.noProof=!1}}Object(h.a)(Yf,"TextSpan",null,[]);class Xd{}Object(h.a)(Xd,"AugCharFormat",null,[]);class fg{}Object(h.a)(fg,
"AugCharFormatRun",null,[]);class ue{}Object(h.a)(ue,"AugDrawingElement",null,[]);class Sa{}Object(h.a)(Sa,"AugDrawingElementMoniker",null,[]);class rb{}Object(h.a)(rb,"AugPara",null,[]);class pc{}Object(h.a)(pc,"AugParaFormat",null,[]);class cd{}Object(h.a)(cd,"AugParaFormatRun",null,[]);class zd{}Object(h.a)(zd,"AugSlide",null,[]);class wd{}Object(h.a)(wd,"AugSlideMoniker",null,[]);class Oa{}Object(h.a)(Oa,"AugText",null,[]);class jb{}Object(h.a)(jb,"AugTextTile",null,[]);class qc{constructor(da,
Fa,Ua,cb,Jb,Gc,pd,Ld,de,Be,Mf,Dg){this.Hh=da;this.Nl=Fa;this.sqe=Ua;this.Nb=cb;this.qX=Jb;this.tc=Gc;this.Cl=pd;this.lbc=Mf;this.$1c=Ld;this.mbc=de;this.Wz=Be;this.F8j=Dg}SXb(da){if(!da||!da.isConnected)return null;var Fa=Object(I.a)(120,da);if(!Fa)return null;let Ua=da=0;Fa=({fad:da,jIc:Ua}=this.eDi(Fa)).returnValue;if(!Fa)return null;Fa=Object.assign(new jb,{Id:ac.a.create().toString(),Content:u.c(Fa)});Fc.a.J(37091038,306,50,"TileId: {0}; ParaCount: {1}; DirtyParaCount: {2};",Fa.Id,da,Ua);return Fa}eDi(da){let Fa=
0,Ua=0;const cb=[];var Jb=da?da.jl():[];for(Gc of Jb)if(!this.Nl.$Da(Gc)||this.lbc)if(Gc.qd){if(Jb=this.tc.iN(Gc))Jb=this.Nb.Kc(Jb),this.qX.sLc(Jb,pd=>{(pd=Object(I.a)(127,pd.currentNode))&&!pd.isGhostCell&&({fad:Fa,jIc:Ua}=this.Z7f(pd,Fa,Ua,cb));return!0})}else({fad:Fa,jIc:Ua}=this.Z7f(Gc,Fa,Ua,cb));var Gc=Fa;Jb=Ua;return{returnValue:Object.assign(new zd,{id:da.id.toString(),mk:Object.assign(new wd,{sId:da.sid,cId:da.cid}),drawingElems:cb,isSlideCritiqueReady:da.isSlideCritiqueReady}),fad:Gc,jIc:Jb}}Z7f(da,
Fa,Ua,cb){const Jb=[];let Gc=0;var pd=this.Nb.Kc(da);for(pd=this.Cl.n2(pd,pd.currentNode);pd.moveNext();){var Ld=pd.currentNode;Ld&&this.Hh.Vd(Ld)&&Ld.Sa(kd.a.iq)&&(Ld=this.gYi(Ld))&&(Ld.pfRuns&&0<Ld.pfRuns.length&&Ld.pfRuns[0].pf.proofingDirty&&Gc++,Array.add(Jb,Ld))}0<Jb.length&&(Fa+=Jb.length,Ua+=Gc,da=Object.assign(new ue,{id:da.id.toString(),mk:this.eYi(da),text:Object.assign(new Oa,{paragraphs:Jb})}),Array.add(cb,da));return{fad:Fa,jIc:Ua}}eYi(da){if(!da)return null;var Fa="";let Ua=0,cb=0;
if(Object(Pc.a)(127,da))Fa=Object(I.a)(127,da),cb=3,Fa=Fa.cellId.toString();else if(Object(Pc.a)(4,da))if(da=Object(I.a)(4,da),Fa=da.get_shapeId().toString(),Ua=da.get_cid(),da.q3)cb=1;else if(da.Pf)cb=2;else if(da.Ny||da.Sk)cb=4;return Object.assign(new Sa,{id:Fa,cId:Ua,type:cb})}gYi(da){if(!da)return null;da=Object(I.a)(dd.AParagraphNode,da);if(!da)return null;var Fa=da.sa(ad.a.VS,!1);Fa=Object.assign(new rb,{id:da.id.toString(),chars:Fa?"":this.Hh.text(da)});const Ua=this.fYi(da);Ua&&0<Ua.length&&
(Fa.pfRuns=Ua);(da=this.dYi(da))&&0<da.length&&(Fa.cfRuns=da);return Fa}fYi(da){const Fa=[],Ua=Object(I.a)(ce.a,this.mbc.YNc(da));let cb=16,Jb="",Gc=0,pd=0;if(Ua&&this.F8j){const Ld=this.Wz.k7a(Ua);if(Ld)if(cb=Ld.listType,1===cb)Jb=this.$1c.yxb(Ua);else if(0===cb){Gc=Ua.sa(ad.a.autonumberBulletType,8);const de=Object(I.a)(810,this.$1c);de&&(pd=de.z8i(Ld,Ua))}}da=Object.assign(new cd,{pf:Object.assign(new pc,{lvl:this.Hh.oeb(da),proofingDirty:!da.sa(ld.a.Lca,!1),revisionId:da.sa(ld.a.WWc,0).toString(),
listType:cb,listTag:Jb,listNumeration:Gc,listElementIndex:pd})});Array.add(Fa,da);return Fa}dYi(da){const Fa=[];let Ua=this.c8i(da);if(0<Ua.count){Ua=this.afi(this.sqe.dNc(da),Ua);for(let cb of Ua)da=cb.end-cb.start,Array.add(Fa,Object.assign(new fg,{len:da,cf:Object.assign(new Xd,{lang:cb.lcid,noProof:cb.noProof})}))}return Fa}c8i(da){const Fa=new A.a,Ua=da.characterData;let cb=-1,Jb=-1,Gc=0;for(let pd=0;pd<da.Ra.length;pd++){const Ld=da.Ra.ga(pd).formatting;Ld&&(Jb=Td.a.language(Ld),-1!==cb&&cb!==
Jb&&(Fa.add(Object.assign(new Yf,{start:Gc,end:da.Ra.ga(pd).cp,lcid:cb,noProof:!1})),Gc=da.Ra.ga(pd).cp),cb=Jb)}Fa.add(Object.assign(new Yf,{start:Gc,end:Ua.length,lcid:Jb,noProof:!1}));return Fa}afi(da,Fa){if(!da)return Fa;for(const Ua of da){da=!1;for(let cb=0;cb<Fa.count;cb++){if(!da)if(Fa.ga(cb).start===Ua.begin)da=!0,Fa.ga(cb).noProof=!0;else if(Ua.begin>Fa.ga(cb).start&&Ua.begin<Fa.ga(cb).end){Fa.insert(cb+1,Object.assign(new Yf,{start:Ua.begin,end:Fa.ga(cb).end,lcid:Fa.ga(cb).lcid,noProof:!0}));
da=!0;Fa.ga(cb).end=Ua.begin;continue}if(da)if(Ua.end>Fa.ga(cb).end)Fa.ga(cb).noProof=!0;else{if(Ua.end===Fa.ga(cb).end){Fa.ga(cb).noProof=!0;break}if(Ua.end<Fa.ga(cb).end){Fa.insert(cb+1,Object.assign(new Yf,{start:Ua.end,end:Fa.ga(cb).end,lcid:Fa.ga(cb).lcid,noProof:!1}));Fa.ga(cb).end=Ua.end;Fa.ga(cb).noProof=!0;break}}}}return Fa}}Object(h.a)(qc,"SlideTextTileManager",null,[782,809]);var ib=d(429);class Cb extends Fb{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld,de,Be,Mf){super(Fa&125,Ua,cb,Mf);this.od=
da;this.QT=Jb;this.T$j=Gc;this.wT=pd.vd(12);this.CL=pd.vd(10);this.o9=Ld;this.ua=de;this.ISg=Be;this.F2c=pd.vd(22)}ow(){4===(this.ny&4)&&(this.od.uV(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.ISg.t8h(Object(w.a)(this,this.p3g,"onTilingModuleLoaded")),this.xZ[Object(ne.a)(Vb,4)]=this.QT.ZCi());16===(this.ny&16)&&(this.wT.wAa(Object(w.a)(this,this.wHa,"onBeforeParagraphDisconnect")),this.xZ[Object(ne.a)(Vb,16)]=this.QT.bDi());1===(this.ny&1)&&(this.wT.Yj(Object(w.a)(this,
this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.xZ[Object(ne.a)(Vb,1)]=this.QT.cDi());8===(this.ny&8)&&(this.CL.nG(Object(w.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged")),this.xZ[Object(ne.a)(Vb,8)]=this.QT.dDi());64===(this.ny&64)&&(this.F2c.wAa(Object(w.a)(this,this.fZg,"onBeforeNumberListDicsonnect")),this.xZ[Object(ne.a)(Vb,64)]=this.QT.$Ci());32===(this.ny&32)&&(this.F2c.Yj(Object(w.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged")),
this.xZ[Object(ne.a)(Vb,32)]=this.QT.aDi())}Ona(){this.od.Tma(Object(w.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.wT.tm(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.wT.uIa(Object(w.a)(this,this.wHa,"onBeforeParagraphDisconnect"));this.ISg.gTk(Object(w.a)(this,this.p3g,"onTilingModuleLoaded"));this.F2c.uIa(Object(w.a)(this,this.fZg,"onBeforeNumberListDicsonnect"));this.F2c.tm(Object(w.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"))}fZg(da,
Fa){this.Hra(Fa,64)}onNumberListPropertyChanged(da,Fa){this.Hra(Fa,32)}fireTileEvents(){try{Fd.a.forEach(this.mia,da=>{this.z_b(Object(I.a)(Lc,this.mia[da]));delete this.mia[da]},null)}catch(da){Fc.a.J(36525513,306,10,"Exception thrown at FireTileEvents: "+da)}}z_b(da){if(da&&this.ua.Ba&&da.graphNode&&this.ua.Ba.id===da.graphNode.id){var Fa=Date.now(),Ua=this.T$j.SXb(da.graphNode,Ib[da.jTa]);if(Ua){this.o9.execute(Jb=>{Jb.submit(ib.a.wmc,Ua)});const cb=da.lSe;this.JYg(cb,Fa);Fc.a.J(36525515,306,50,
"Fire a tile. LatestTrigger: {0}, TriggerCount: {1}, TileSize: {2}, TileId: {3}, {4}",Ib[da.jTa],da.GZa,u.c(Ua).length,Ua.Id,this.g8f(cb))}}}}Object(h.a)(Cb,"SlideTextTileTriggerController",Fb,[]);class yc extends Ma.a{constructor(){super();this.shapeType=this.textTiles=null;this.H_=Object.assign(new bb.a,{T_:yc.getTypeName(),B_:yc.ul()})}static getTypeName(){return"AugLoop_Powerpoint_PowerPointShape"}static ul(){return[]}}Object(h.a)(yc,"PowerPointShape",Ma.a,[]);class gd extends Ma.a{constructor(){super();
this.cid=this.sid=this.themeId=this.isSlideHidden=this.shapes=null;this.H_=Object.assign(new bb.a,{T_:gd.getTypeName(),B_:gd.ul()})}static getTypeName(){return"AugLoop_Powerpoint_PowerPointSlide"}static ul(){return[]}}Object(h.a)(gd,"PowerPointSlide",Ma.a,[]);class od extends Ma.a{constructor(){super();this.content=null;this.H_=Object.assign(new bb.a,{T_:od.getTypeName(),B_:od.ul()})}static getTypeName(){return"AugLoop_Text_TextTile"}static ul(){return[]}}Object(h.a)(od,"TextTile",Ma.a,[]);class Mc extends od{constructor(){super();
this.isColdIp=this.ipPosition=this.queryRange=this.fontKerning=this.specialIndentBy=this.specialIndentType=this.bulletAndNumberFontFamily=this.bulletAndNumberFontSize=this.listId=this.rightIndentation=this.lineSpacing=this.spacingAfterParagraph=this.spacingBeforeParagraph=this.objectReferences=this.isInsideTOC=this.isInsideTable=this.formattedRanges=this.alignment=this.listType=this.outlineLevel=this.indentation=null;this.H_=Object.assign(new bb.a,{T_:Mc.getTypeName(),B_:Mc.ul()})}static getTypeName(){return"AugLoop_Text_FormattedTextTile"}static ul(){return["AugLoop_Text_TextTile"]}}
Object(h.a)(Mc,"FormattedTextTile",od,[]);class Rd{constructor(da,Fa,Ua,cb,Jb,Gc){this.Nb=da;this.Cl=Fa;this.Hh=cb;this.Ha=Ua;this.Rak=Jb;this.uc=Gc}SXb(da){if(!da||!da.isConnected)return null;da=Object(I.a)(120,da);if(!da)return null;let Fa=null;const Ua=new A.a;var cb=da.jl();for(var Jb of cb)(cb=this.h8f(Jb,!1))&&Ua.add(cb);(Jb=da.VQa())&&Jb.isConnected&&(Jb=this.h8f(Jb,!0))&&Ua.add(Jb);if(0<Ua.count&&(Fa=Object.assign(new gd,{shapes:Ua.toArray()}),this.Ha.DZb)){Fa.isSlideHidden=da.Rm;Fa.themeId=
this.$1b(da);try{Fa.cid=da.cid.toString(),Fa.sid=da.sid.toString()}catch(Gc){Fc.a.J(575494306,822,50,"Exception message: "+Gc.message)}}return Fa}h8f(da,Fa){if(!da)return null;var Ua=this.Nb.Kc(da);Ua=this.Cl.n2(Ua,Ua.currentNode);let cb=null;const Jb=new A.a;for(;Ua.moveNext();){var Gc=Ua.currentNode;if(Gc&&this.Hh.Vd(Gc)){Gc=Object(I.a)(dd.AParagraphNode,Gc);var pd=this.Hh.text(Gc);pd&&(pd=Object.assign(new Mc,{content:pd}),this.Ha.DZb&&this.Rak.Dyk(pd,Gc),Jb.add(pd))}}0<Jb.count&&(cb=Object.assign(new yc,
{textTiles:Jb.toArray()}));this.Ha.DZb&&cb&&(cb.shapeType=this.zSi(da,Fa));return cb}zSi(da,Fa){if(Fa)return 3;if(!da)return 9;switch(da.Cj){case 0:case 2:return 0;case 3:return 1;case 10:return 7;case 15:return 5;case 9:case 12:return 8;case 8:return this.$ej(da)}return 9}$ej(da){return da?0<da.r3d().length?4:da.Kca?9:da.Ny?6:2:9}$1b(da){if(!da)return"";da=da.pj;let Fa=null;const Ua=this.uc.hI();if(Ua&&0<Ua.length&&da)for(const cb of Ua)if(cb.Id===da){Fa=cb;break}return Fa&&Fa.ThemeFamilyId?Fa.ThemeFamilyId:
""}}Object(h.a)(Rd,"SlideTileManager",null,[809]);class ye extends Fb{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld){super(Fa&401,Ua,cb,Ld);this.W4c=da.vd(8);this.wT=da.vd(12);this.QT=Jb;this.U$j=Gc;this.o9=pd}ow(){16===(this.ny&16)&&(this.wT.wAa(Object(w.a)(this,this.wHa,"onBeforeParagraphDisconnect")),this.xZ[Object(ne.a)(Vb,16)]=this.QT.XCi());1===(this.ny&1)&&(this.wT.Yj(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged")),this.xZ[Object(ne.a)(Vb,1)]=this.QT.YCi());128===(this.ny&
128)&&(this.W4c.rha(Object(w.a)(this,this.onSlideConnected,"onSlideConnected")),this.xZ[Object(ne.a)(Vb,128)]=this.QT.VCi());256===(this.ny&256)&&(this.W4c.R6(Object(w.a)(this,this.onSlideDisconnected,"onSlideDisconnected")),this.xZ[Object(ne.a)(Vb,256)]=this.QT.WCi())}Ona(){this.wT.tm(Object(w.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.wT.uIa(Object(w.a)(this,this.wHa,"onBeforeParagraphDisconnect"));this.W4c.Uma(Object(w.a)(this,this.onSlideConnected,"onSlideConnected"));
this.W4c.vIa(Object(w.a)(this,this.onSlideDisconnected,"onSlideDisconnected"))}onSlideConnected(da,Fa){this.Hra(Fa,128)}onSlideDisconnected(da,Fa){this.Hra(Fa,256)}fireTileEvents(){try{Fd.a.forEach(this.mia,da=>{this.z_b(Object(I.a)(Lc,this.mia[da]));delete this.mia[da]},null)}catch(da){Fc.a.J(512496604,306,10,"Exception thrown at FireTileEvents: "+da)}}z_b(da){if(da&&da.graphNode){var Fa=this.U$j.SXb(da.graphNode,Ib[da.jTa]),Ua=null,cb=Object(I.a)(120,da.graphNode);if(cb&&!cb.qN&&!cb.Qwb){var Jb=
Db.a("AL.SlideTileIdOriginalFormat")?cb.sid.toString()+cb.cid.toString():cb.sid.toString()+"#"+cb.cid.toString();cb=["session","doc"];Fa=[Object.assign(new pb.a,{id:Jb,body:Fa})];10===da.jTa?"slideAdded"in da.GZa||(Ua=Object.assign(new Ya,{parentPath:cb,items:Fa})):Ua="slideAdded"in da.GZa?Object.assign(new sa.a,{parentPath:cb,items:Fa}):Object.assign(new ua.a,{parentPath:cb,items:Fa});Ua&&this.o9.execute(Gc=>{Gc.submitOperation(Ua)})}}}}Object(h.a)(ye,"SlideTileTriggerController",Fb,[]);var oe=d(1174),
Bb=d(30);class Ff{constructor(da,Fa){this.Wz=da;this.j9=Fa}Dyk(da,Fa){try{da.listType=this.Btb(Fa),da.outlineLevel=Zb.ParagraphReader.sOc(Fa),da.indentation=Ff.n8i(this.j9.I7(Fa))}catch(Ua){Fc.a.J(587313229,822,50,"Exception message: "+Ua.message)}}Btb(da){const Fa=new Bb.GraphIterator;Fa.set(da);Fa.pc(11);Fa.Rg(11);return(da=this.Wz.Pw(Fa))?Ff.Hwi(da.listType):6}static Hwi(da){switch(da){case 15:return 5;case 1:return 1;case 42:return 7;case 13:return 3;case 14:return 4;case 16:return 6;case 0:return 2;
default:return 7}}static n8i(da){return 2===da.Sf?Math.floor(oe.a.FOf(da.value)/20):Math.floor(da.value/20)}}Object(h.a)(Ff,"TextTileFormatter",null,[783]);var pg=d(77);class xf{constructor(){this.mSe="TML";this.va=new pg.a}t8h(da){this.va.addHandler(this.mSe,da)}gTk(da){this.va.removeHandler(this.mSe,da)}UIk(da){this.va.raiseEvent(this.mSe,da)}}Object(h.a)(xf,"TilingEventSource",null,[806,807,808]);class qe{}qe.P9k="ShapeTextOnActiveSlideDomReady";qe.S9k="ShapeTextOnSelectionFinished";qe.R9k="ShapeTextOnParagraphPropertyChanged";
qe.T9k="ShapeTextOnShapeChildTopologyChanged";qe.Q9k="ShapeTextOnParagraphDisconnect";qe.Hgl="SlideTextOnActiveSlideDomReady";qe.Lgl="SlideTextOnParagraphPropertyChanged";qe.Kgl="SlideTextOnParagraphDisconnect";qe.Mgl="SlideTextOnShapeChildTopologyChanged";qe.Jgl="SlideTextOnNumberListPropertyChanged";qe.Igl="SlideTextOnNumberListDisconnect";qe.Egl="SlideOnParagraphPropertyChanged";qe.Dgl="SlideOnParagraphDisconnect";qe.Bgl="SlideOnConnect";qe.Cgl="SlideOnDisconnect";Object(h.a)(qe,"DetectStrategyName",
null,[]);class Oh{constructor(da){this.JT=da}get ny(){return 4}P2(da,Fa){const Ua=[];if((da=Object(I.a)(gc.a,da))&&da.Ba&&(da=Object(I.a)(120,da.Ba))){da=da.jl();for(const cb of da)this.JT.rXb(cb)&&Array.add(Ua,cb);0<Ua.length&&Fa(Ua,1)}}}Object(h.a)(Oh,"ShapeTextOnActiveSlideDomReadyDetectStrategy",null,[832]);var Cf=d(251);class Bg{constructor(da,Fa,Ua){this.Ea=da;this.JT=Fa;this.ra=Ua}get ny(){return 16}P2(da,Fa){if((da=Object(I.a)(Cf.a,da))&&da.node&&12===da.node.type&&(da=this.Ea.tn(da.node))&&
this.JT.rXb(da)){var Ua=this.ra.JZ();Ua&&Ua.id===da.id&&(Ua=[],Array.add(Ua,da),Fa(Ua,6))}}}Object(h.a)(Bg,"ShapeTextOnParagraphDisconnectDetectStrategy",null,[832]);var Gf=d(40),dh=d(349);class qg{constructor(da,Fa,Ua){this.Ea=da;this.JT=Fa;this.ra=Ua}get ny(){return 1}P2(da,Fa){if((da=Object(I.a)(dh.a,da))&&da.node&&12===da.node.type){const cb=this.Ea.tn(da.node);if(cb&&this.JT.rXb(cb)){var Ua=this.ra.JZ();Ua&&Ua.id===cb.id&&(da.property===Gf.a.listLevel?this.mrb(3,cb,Fa):da.property===kd.a.iq&&
this.mrb(4,cb,Fa))}}}mrb(da,Fa,Ua){if(Fa){var cb=[];Array.add(cb,Fa);Ua(cb,da)}}}Object(h.a)(qg,"ShapeTextOnParagraphPropertyChangedDetectStrategy",null,[832]);var Pf=d(827);class qd{constructor(da,Fa,Ua,cb){this.ra=da;this.JT=Fa;this.Z_=Ua;this.zcc=cb}get ny(){return 2}P2(da,Fa){const Ua=[];if(da=Object(I.a)(Pf.a,da))if(this.zcc&&this.Z_&&this.Z_.H2b(da.NF),!this.ra.e3())this.zcc&&this.Z_&&this.Z_.KFb();else if(da.hE&&da.hE.length){this.zcc&&this.Z_&&this.Z_.KFb();da=this.ra.Yd();for(const cb of da)this.JT.rXb(cb)&&
Array.add(Ua,cb);0<Ua.length&&Fa(Ua,2)}}}Object(h.a)(qd,"ShapeTextOnSelectionFinishedDetectStrategy",null,[832]);var Tf=d(577);class Pg{constructor(da,Fa){this.ra=da;this.JT=Fa}get ny(){return 8}P2(da,Fa){const Ua=[];if((da=Object(I.a)(Tf.a,da))&&da.node&&10===da.node.type&&1===da.lZ&&(da=Object(I.a)(4,da.node))&&this.JT.rXb(da)){var cb=this.ra.JZ();cb&&cb.get_shapeId()===da.get_shapeId()&&(Array.add(Ua,da),Fa(Ua,5))}}}Object(h.a)(Pg,"ShapeTextOnShapeChildTopologyChangedDetectStrategy",null,[832]);
class Ee{constructor(da){this.wEg=da}get ny(){return 1===this.wEg?128:256}P2(da,Fa){if((da=Object(I.a)(Cf.a,da))&&da.node&&8===da.node.type){const Ua=[];Array.add(Ua,da.node);1===this.wEg?Fa(Ua,9):Fa(Ua,10)}}}Object(h.a)(Ee,"SlideOnConnectOrDisconnectDetectStrategy",null,[832]);class xe{constructor(da){this.lc=da}get ny(){return 16}P2(da,Fa){if((da=Object(I.a)(Cf.a,da))&&da.node&&12===da.node.type){const Ua=this.lc.ig(da.node);Ua&&(da=[],Array.add(da,Ua),Fa(da,6))}}}Object(h.a)(xe,"SlideOnParagraphDisconnectDetectStrategy",
null,[832]);class jh{constructor(da){this.lc=da}get ny(){return 1}P2(da,Fa){var Ua=Object(I.a)(dh.a,da);if(Ua&&Ua.node&&12===Ua.node.type){const cb=this.lc.ig(Ua.node);cb&&Object(I.a)(dd.AParagraphNode,Ua.node)&&(da=0,Ua.property===Gf.a.listLevel?da=3:Ua.property===kd.a.iq&&(da=4),Ua=[],Array.add(Ua,cb),Fa(Ua,da))}}}Object(h.a)(jh,"SlideOnParagraphPropertyChangedDetectStrategy",null,[832]);class yg{get ny(){return 4}P2(da,Fa){if((da=Object(I.a)(gc.a,da))&&da.Ba&&(da=Object(I.a)(120,da.Ba))){var Ua=
da.jl();for(var cb of Ua)if(cb.hasText){cb=[];Array.add(cb,da);Fa(cb,1);break}}}}Object(h.a)(yg,"SlideTextOnActiveSlideDomReadyDetectStrategy",null,[832]);class xc{constructor(da,Fa){this.lc=da;this.ua=Fa}get ny(){return 64}P2(da,Fa){if((da=Object(I.a)(Cf.a,da))&&this.ua.Ba&&da.node&&22===da.node.type&&(da=this.lc.ig(da.node))&&da.id===this.ua.Ba.id){const Ua=[];Array.add(Ua,da);Fa(Ua,7)}}}Object(h.a)(xc,"SlideTextOnNumberListDisconnectDetectStrategy",null,[832]);class me{constructor(da,Fa){this.lc=
da;this.ua=Fa}get ny(){return 32}P2(da,Fa){var Ua=Object(I.a)(dh.a,da);Ua&&Ua.node&&22===Ua.node.type&&(da=this.lc.ig(Ua.node))&&this.ua.Ba&&da.id===this.ua.Ba.id&&Ua.property===kd.a.Ni&&(Ua=[],Array.add(Ua,da),Fa(Ua,8))}}Object(h.a)(me,"SlideTextOnNumberListPropertyChangedDetectStrategy",null,[832]);class Dd{constructor(da,Fa,Ua,cb){this.ua=da;this.Nl=Fa;this.lc=Ua;this.lbc=cb}get ny(){return 16}P2(da,Fa){if((da=Object(I.a)(Cf.a,da))&&da.node&&this.ua.Ba&&12===da.node.type){const Ua=this.lc.ig(da.node);
!Ua||Ua.id!==this.ua.Ba.id||this.Nl.xja(da.node)&&!this.lbc||(da=[],Array.add(da,this.ua.Ba),Fa(da,6))}}}Object(h.a)(Dd,"SlideTextOnParagraphDisconnectDetectStrategy",null,[832]);class Qe{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld){this.ua=da;this.Nl=Fa;this.lc=Ua;this.Ea=cb;this.lbc=Jb;this.Z_=pd;this.zcc=Ld}get ny(){return 1}P2(da,Fa){if((da=Object(I.a)(dh.a,da))&&da.node&&this.ua.Ba&&12===da.node.type){var Ua=this.lc.ig(da.node);if(Ua&&Ua.id===this.ua.Ba.id&&(Ua=Object(I.a)(dd.AParagraphNode,da.node))&&
(!this.Nl.xja(Ua)||this.lbc)){var cb=this.Ea.tn(Ua);cb.bta||cb.Ny||cb.Pf||cb.qd||!cb.Sk||!this.zcc||(this.Z_.settings.ABe=!0,this.Z_.Trl(Ua));da.property===Gf.a.listLevel?this.mrb(3,this.ua.Ba,Fa):da.property===kd.a.iq?this.mrb(4,this.ua.Ba,Fa):da.property===ld.a.Lca&&(Ua.sa(ld.a.Lca,!1)||this.mrb(4,this.ua.Ba,Fa))}}}mrb(da,Fa,Ua){if(Fa){var cb=[];Array.add(cb,Fa);Ua(cb,da)}}}Object(h.a)(Qe,"SlideTextOnParagraphPropertyChangedDetectStrategy",null,[832]);class tf{constructor(da,Fa){this.ua=da;this.lc=
Fa}get ny(){return 8}P2(da,Fa){da=Object(I.a)(Tf.a,da);this.ua.Ba&&da&&da.node&&10===da.node.type&&1===da.lZ&&(da=Object(I.a)(4,da.node))&&(da=this.lc.ig(da))&&da.id===this.ua.Ba.id&&(da=[],Array.add(da,this.ua.Ba),Fa(da,5))}}Object(h.a)(tf,"SlideTextOnShapeChildTopologyChangedDetectStrategy",null,[832]);class Rb{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld,de){this.lc=da;this.Ea=Fa;this.nb=Ua;this.JT=cb;this.ua=Jb;this.Nl=Gc;this.Ha=pd;this.OG=Ld;this.Z_=de}S4i(da){if(ud.a.Va(da))return 0;let Fa=0;for(const Ua of da)Fa|=
this.xWk(Ua);return Fa}U4i(da){if(ud.a.Va(da))return 0;let Fa=0;for(const Ua of da)Fa|=this.zWk(Ua);return Fa}T4i(da){if(ud.a.Va(da))return 0;let Fa=0;for(const Ua of da)Fa|=this.yWk(Ua);return Fa}LCi(){return new qg(this.Ea,this.JT,this.nb)}MCi(){return new qd(this.nb,this.JT,this.Z_,this.Ha.ghc)}JCi(){return new Oh(this.JT)}NCi(){return new Pg(this.nb,this.JT)}KCi(){return new Bg(this.Ea,this.JT,this.nb)}ZCi(){return new yg}bDi(){return new Dd(this.ua,this.Nl,this.lc,this.Ha.pptNotesInSlideTextTileIsEnabled)}cDi(){return new Qe(this.ua,
this.Nl,this.lc,this.Ea,this.Ha.pptNotesInSlideTextTileIsEnabled,this.OG,this.Z_,this.Ha.ghc)}dDi(){return new tf(this.ua,this.lc)}aDi(){return new me(this.lc,this.ua)}$Ci(){return new xc(this.lc,this.ua)}XCi(){return new xe(this.lc)}YCi(){return new jh(this.lc)}WCi(){return new Ee(2)}VCi(){return new Ee(1)}xWk(da){return da===qe.R9k?1:da===qe.S9k?2:da===qe.P9k?4:da===qe.T9k?8:da===qe.Q9k?16:0}zWk(da){return da===qe.Hgl?4:da===qe.Kgl?16:da===qe.Lgl?1:da===qe.Mgl?8:da===qe.Jgl?32:da===qe.Igl?64:0}yWk(da){return da===
qe.Dgl?16:da===qe.Egl?1:da===qe.Bgl?128:da===qe.Cgl?256:0}}Object(h.a)(Rb,"TilingFactory",null,[784]);class Jc extends Sys.EventArgs{constructor(da){super();this.Ba=da}}Object(h.a)(Jc,"TilingModuleLoadEventArgs",Sys.EventArgs,[]);class Qc{constructor(){this.K=null;this.Sre=this.ege=!1}get name(){return"PowerPointWebEditor.ContentUpdateDetection"}Wb(da){this.K=da;da.register(xf,"PowerPointWebEditor.ContentUpdateDetection.TilingEventSource").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers").as("PowerPointWebEditor.ContentUpdateDetection.ITilingEventSource").ma().na(()=>
new xf);da.register(781,"PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager").ma().na(()=>new md(da.resolve("Box4.Graph.IGraphIteratorFactory"),da.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),da.resolve("PowerPointWebEditor.IShapeReader"),da.resolve("Box4.IParagraphReader")));da.register(782,"PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager").ma().na(()=>new qc(da.resolve("Box4.IParagraphReader"),da.resolve("PowerPointWebEditor.Graph.INotesReader"),da.resolve("Box4.Proofing.IProofingTextUtility"),
da.resolve("Box4.Graph.IGraphIteratorFactory"),da.resolve("Box4.ITableNavigator"),da.resolve("PowerPointWebEditor.Graph.ITableReader"),da.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),da.resolve("Box4.IListMarkerUtility"),da.resolve("PowerPointWebEditor.IPPTParagraphReader"),da.resolve("Box4.List.IListReader"),da.resolve("PowerPointWebEditor.IApplicationSettings").pptNotesInSlideTextTileIsEnabled,da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTopologyAndListInfoInSlideTileIsEnabled));
da.register(783,"PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter").ma().na(()=>new Ff(da.resolve("Box4.List.IListReader"),da.resolve("Box4.IParagraphIndentationReader")));da.register(Rd,"PowerPointWebEditor.ContentUpdateDetection.SlideTileManager").ma().na(()=>new Rd(da.resolve("Box4.Graph.IGraphIteratorFactory"),da.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),da.resolve("PowerPointWebEditor.IApplicationSettings"),da.resolve("Box4.IParagraphReader"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITextTileFormatter"),
da.resolve("PowerPointWebEditor.IPresentationReader")));da.register(784,"PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").ma().na(()=>new Rb(da.resolve("PowerPointWebEditor.ISlideReader"),da.resolve("PowerPointWebEditor.IShapeReader"),da.resolve("PowerPointWebEditor.IPptSelectionManager"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),da.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),da.resolve("PowerPointWebEditor.Graph.INotesReader"),da.resolve("PowerPointWebEditor.IApplicationSettings"),
da.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),da.resolve("PowerPointWebEditor.TextPrediction.ITextPredictionHandler")));da.register(fb,"PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").ma().na(()=>new fb(da.resolve("Box4.Graph.IGraphInstance"),da.resolve("PowerPointWebEditor.IPptSelectionManager"),da.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),da.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),da.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
da.resolve("PowerPointWebEditor.ContentUpdateDetection.IShapeTextTileManager"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").S4i(da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),da.resolve("Common.ITaskManager"),da.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireTileEventsIntervalInMilliseconds,da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),
da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),da.resolve("PowerPointWebEditor.IApplicationSettings").replaceObjectUseClientAL));da.register(Cb,"PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").ma().na(()=>new Cb(da.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").U4i(da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),da.resolve("Common.ITaskManager"),
da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ISlideTextTileManager"),da.resolve("Box4.Graph.IGraphInstance"),da.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),da.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventHandlers"),
da.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));da.register(ye,"PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").ma().na(()=>new ye(da.resolve("Box4.Graph.IGraphInstance"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory").T4i(da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTileDetectStrategyList),da.resolve("Common.ITaskManager"),da.resolve("PowerPointWebEditor.IApplicationSettings").powerPointFireSlideTileEventsIntervalInMilliseconds,
da.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingFactory"),da.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileManager"),da.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),da.resolve("PowerPointWebEditor.IApplicationSettings")))}R3f(){return Db.a("AL.SendSlideTile")}init(){const da=this.K.resolve("Common.IAppSettingsManager");da.ff(()=>{this.ege=da.ka("497");this.Sre=da.ka("810")||da.ka("809");this.ege&&
(da.ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").initialize(),(this.Sre||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").initialize(),this.R3f()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize());this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ITilingEventNotifier").UIk(new Jc(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba))})}dispose(){this.ege&&
(this.K.resolve("Common.IAppSettingsManager").ka("473")&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.ShapeTextTileTriggerController").dispose(),(this.Sre||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointInfraredMakeItVisualEnabled)&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTextTileTriggerController").dispose(),this.R3f()&&this.K.resolve("PowerPointWebEditor.ContentUpdateDetection.SlideTileTriggerController").initialize())}static main(){v.a.instance.Bc(new Qc)}}
Object(h.a)(Qc,"PPTWebEditorContentUpdateDetectionPackage",null,[2,3]);var Ph=d(989),ng=d(637),se=d(141),pf=d(153),$d=d(517),Ye=d(108),Kd=d(47);class Yd{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld){this.type="EditorPaneProps";this.critiqueCountInclusiveness=this.critiqueCountClarity=this.critiqueCountConciseness=this.critiqueCountVocabulary=this.critiqueCountPunctuationConvention=this.critiqueCountFormality=this.critiqueCountGrammar=this.critiqueCountSpelling=null;this.critiqueCountSpelling=da;this.critiqueCountGrammar=
Fa;this.critiqueCountFormality=Ua;this.critiqueCountPunctuationConvention=cb;this.critiqueCountVocabulary=Jb;this.critiqueCountConciseness=Gc;this.critiqueCountClarity=pd;this.critiqueCountInclusiveness=Ld}}Object(h.a)(Yd,"EditorPaneProps",null,[]);class Zf{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld,de,Be,Mf,Dg,yd,td,id){this.Db=!1;this.yii=320;this.sVa=!1;this.K$={};if(!da)throw Error.argumentNull("pptSelectionManager");if(!Fa)throw Error.argumentNull("appFrame");if(!Ua)throw Error.argumentNull("actionManager");
if(!cb)throw Error.argumentNull("focusManager");if(!Jb)throw Error.argumentNull("editorPane");if(!pd)throw Error.argumentNull("graphOperationEventHandler");if(!Ld)throw Error.argumentNull("viewElementEventHandlers");if(!de)throw Error.argumentNull("viewEventSource");if(!Be)throw Error.argumentNull("pageView");if(!Dg)throw Error.argumentNull("workspace");if(!yd)throw Error.argumentNull("dynamicScriptLoader");if(!id)throw Error.argumentNull("graphTopologyManager");yd.loadScript("powerpoint-editor-intl").then(()=>
{this.sVa=!0}).catch(ed=>{Fc.a.J(512267606,801,10,"Failed to load powerpoint-editor-intl "+ed.toString())});this.Ob=Fa;this.ia=Ua;this.Sge=td;this.Fa=cb;this.Ig=pd;this.od=Ld;this.Lc=de;this.o9=Mf;this.ua=id;this.Ig.UH(this.yHa.bind(this));this.Ig.vAa(this.yHa.bind(this));this.Lc.JNa(this.yHa.bind(this));this.od.yAa(this.yHa.bind(this));this.Ob.JM(this.lw.bind(this));this.initialize()}initialize(){this.o9.execute(da=>{da.addEventHandler($d.a.WOd,this.wnj.bind(this))})}dispose(){this.Ig.Y4(this.yHa.bind(this));
this.Ig.GXa(this.yHa.bind(this));this.Lc.Efb(this.yHa.bind(this));this.od.Gfb(this.yHa.bind(this));this.Ob.QX(this.yHa.bind(this))}ub(){this.ia.pa(fd.a.xjd,Wb.a.application,this.xjd.bind(this),4);this.ia.pa(fd.a.rcd,Wb.a.application,this.rcd.bind(this),96)}xe(){}yHa(){this.Db&&this.Tl(!0)}lw(da){1===da.mode&&this.Db&&(this.Db=!1,this.Ns(),this.Fa.Gj(Kd.a.Mba,this.Db))}rcd(da,Fa,Ua,cb,Jb){(da=Object(I.a)(Ye.a,Jb))&&da.Nf(this.Db);return 32}xjd(da,Fa,Ua){return this.sVa?1===Ua?32:2===Ua?(this.Db=!this.Db,
pf.b("EditorPaneActor::ShowHideEditorPane PaneOpen: ",this.Db.toString(),da,()=>{this.Db?this.Tl():this.Ns();return 32})):8:8}Tl(da=!1){const Fa=this.YB(),Ua=Object.assign(new ng.a,{title:"Editor Pane",hideHeader:!1,width:this.yii,location:2,contentProps:Fa,onOpen:()=>{},onClose:()=>{this.Db=!1},isModernPane:!0});se.UISurfaces.Ms().then(cb=>{da?cb.updateTaskPane(Kd.a.Mba,Ua):cb.showTaskPane(Kd.a.Mba,Ua);return null}).catch(cb=>{Fc.a.J(512267605,822,10,"EditorPaneActor::ShowPane, Failed to show editor pane. Exception: "+
cb.toString())})}Ns(){se.UISurfaces.Ms().then(da=>{da.hideTaskPane(Kd.a.Mba,2);return null}).catch(da=>{Fc.a.J(512267604,822,10,"EditorPaneActor::HidePane, Failed to hide editor pane. Exception: "+da.toString())})}YB(){let da=0,Fa=0,Ua=0,cb=0,Jb=0,Gc=0,pd=0,Ld=0;const de=this.ua.Ba?this.ua.Ba.cid:void 0;de&&this.K$[de]&&Object.keys(this.K$[de]).forEach(Be=>{this.K$[de][Be].forEach(Mf=>{switch(Mf.CategoryTitle){case "Spelling":da+=1;break;case "Grammar":Fa+=1;break;case "Conciseness":Gc+=1;break;case "Formality":Ua+=
1;break;case "PunctuationConventions":cb+=1;break;case "Clarity":pd+=1;break;case "Inclusiveness":Ld+=1;break;case "Vocabulary":Jb+=1;break;default:Fc.a.J(509727769,822,50,"Unknown Critique Type: "+Mf.CategoryTitle)}})});return new Yd(da,Fa,Ua,cb,Jb,Gc,pd,Ld)}Wvl(da,Fa){const Ua={};Object.keys(da).forEach(cb=>{this.K$[Fa]?(Object.keys(this.K$[Fa]).includes(cb),this.K$[Fa][cb]=da[cb]):(Ua[cb]=da[cb],this.K$[Fa]=Ua)})}wnj(da,Fa,Ua,cb){Fa&&cb&&(da=JSON.parse(Fa.Content),cb=this.Sge.SSf(cb.critiques),
Fa=this.ua.Ba.cid,null!=cb&&0<cb.length?this.Wvl(this.z0i(cb),Fa):0==cb.length&&this.K$[Fa]&&this.zLi(da.drawingElems,Fa),this.K$[Fa]&&this.JQk(da.drawingElems,Fa),this.Tl(!0))}JQk(da,Fa){const Ua=Object.keys(this.K$[Fa]),cb=this.xij(da);Ua.forEach(Jb=>{cb.includes(Jb)||delete this.K$[Fa][Jb]})}xij(da){const Fa=[];da.forEach(Ua=>{0<Ua.text.paragraphs.length&&Ua.text.paragraphs.forEach(cb=>{Fa.push(cb.id)})});return Fa}zLi(da,Fa){da.forEach(Ua=>{0<Ua.text.paragraphs.length&&this.Jni(Ua.text.paragraphs,
Fa)})}Jni(da,Fa){da.forEach(Ua=>{this.K$[Fa][Ua.id]&&(Ua.pfRuns[0].pf.proofingDirty||""==Ua.chars)&&delete this.K$[Fa][Ua.id]})}z0i(da){const Fa={};if(da)for(const Ua of da)Ua.TileId in Fa?Array.add(Fa[Ua.TileId],Ua):Fa[Ua.TileId]=[Ua];return Fa}}Object(h.a)(Zf,"DexLitePaneActor",null,[106,229]);class ef{constructor(){this.va=new pg.a}iEe(da){this.va.raiseEvent("OnEditorConsistencyCritiqueOnActiveSlide",da)}$Ef(da){this.va.addHandler("OnEditorConsistencyCritiqueOnActiveSlide",da)}}Object(h.a)(ef,
"EditorRuntimeEventSource",null,[824,825,826]);var Ke=d(15),gi=d(49),Rf=d(672),Uf=d(32);class Ed{constructor(da,Fa){this.paragraph=da;this.critiqueId=Fa}}Object(h.a)(Ed,"CritiqueToHighlight",null,[]);class vg{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld,de,Be){this.rda=da;this.K1j=Fa;this.ua=Ua;this.mC=cb;this.Fb=Jb;this.JW=Gc;this.ra=pd;this.rhe=Ld;this.Fa=de;this.m3j=Be;this.rda.rFe(this.K1j)}kRc(da){da.length?(da=this.xaj(da),da.length&&(da=Object.assign(new Rf.a,{action:0,type:2,sca:da,Qeb:this.rda.V9a?
this.rda.V9a.sca:null}),this.rda.shd(da))):this.nGi()}nGi(){var da=this.rda.V9a?this.rda.V9a.sca:null;da=Object.assign(new Rf.a,{action:1,type:2,sca:da,Qeb:da});this.rda.shd(da)}xaj(da){const Fa=[];if(!this.rhe.isEnabled(2))return Fa;var Ua=this.ua.Ba;if(Ua&&Ua.isSlideCritiqueReady){var cb=Ua.tJa;if(!cb.count)return this.Tee(2),Fa;Ua=0;for(let Gc of cb)if(cb=Object(I.a)(dd.AParagraphNode,Gc)){var Jb=this.J0d(cb);for(const pd of Jb)Jb=Object(I.a)(658,pd.Gh),Jb.UM&&Array.contains(da,Jb.UM.TraceId)&&
(Ua++,Jb=new Ed(cb,Jb.UM.TraceId),Array.add(Fa,Jb))}Ua!==da.length&&this.dfe(2,Ua,da.length)}else this.afe(2,Ua);return Fa}vxh(da){if(!this.rhe.isEnabled(3))return!1;var Fa=this.ua.Ba;if(Fa&&Fa.isSlideCritiqueReady){Fa=Fa.tJa;if(!Fa.count)return this.Tee(3),!1;let Ua=0;const cb=this.Fb.ud(15,void 0,()=>{this.i8g()});try{let Jb=!1;cb.kc(Fa.ga(0));cb.fd=Uf.a.nld;for(let Gc of Fa){const pd=Object(I.a)(dd.AParagraphNode,Gc);if(pd){const Ld=new A.a,de=this.J0d(pd);for(const Be of de){const Mf=Object(I.a)(658,
Be.Gh);if(Mf.UM&&da.Jb(Mf.UM.TraceId)){const Dg=da.ga(Mf.UM.TraceId);let yd;try{yd=Mf.UM.Suggestions[Dg].Text;const td=new Ke.a(Be,yd);Ld.add(td);Jb||(Mf.dKa(this.Pck(Dg)),Jb=!0);Ua++}catch(td){Fc.a.J(38843398,375,10,"Take suggestion: Parse failed with exception: {0}",td)}}}Ld.count&&(Ld.Sc((Be,Mf)=>Mf.key.begin-Be.key.begin),this.gUk(pd,Ld))}}Ua!==da.count&&this.dfe(3,Ua,da.count)}finally{cb&&cb.dispose()}}else return this.afe(3,Fa),!1;return!0}Pck(da){switch(da){case 0:return Uf.a.Mxa;case 1:return Uf.a.Nxa;
case 2:return Uf.a.Oxa;case 3:return Uf.a.MJa;case 4:return Uf.a.NJa;default:return 0}}gUk(da,Fa){for(let Ua of Fa)this.JW.replaceTextRange(gi.a.createTextRange(da,0<Ua.key.begin?Ua.key.begin:0,Ua.key.end),Ua.value,!0,!1)}ignoreCritiques(da,Fa){if(!this.rhe.isEnabled(Fa))return!1;var Ua=this.ua.Ba;if(Ua&&Ua.isSlideCritiqueReady){var cb=Ua.tJa;if(!cb.count)return this.Tee(Fa),!1;this.i8g();Ua=!1;let Jb=0;for(let Gc of cb)if(cb=Object(I.a)(dd.AParagraphNode,Gc)){cb=this.J0d(cb);for(const pd of cb)cb=
Object(I.a)(658,pd.Gh),cb.UM&&Array.contains(da,cb.UM.TraceId)&&(cb.mDa=!0,Ua||(cb.dKa(Uf.a.h7d),Ua=!0),Jb++)}Jb!==da.length&&this.dfe(Fa,Jb,da.length)}else return this.afe(Fa,Ua),!1;return!0}J0d(da){return this.mC.iF(da,Fa=>{Fa=Object(I.a)(658,Fa.Gh);return!!Fa&&5===Fa.proofingType&&!Fa.mDa})}Tee(da){Fc.a.J(38843400,375,15,"{0}: No slide critique in active slide. Skipping",da)}dfe(da,Fa,Ua){Fc.a.J(38843402,375,15,"{0}: ErrorRange number mismatch. Actual: {1}, expected: {2}",da,Fa,Ua)}afe(da,Fa){Fc.a.J(38843404,
375,15,"{0}: Active slide is null or slide critiques are not ready. Active slide null: {1}",da,!!Fa)}i8g(){this.ra.Cy();this.ra.kj();this.m3j&&this.Fa.Bf(Kd.a.Bg,!0)}}Object(h.a)(vg,"ConsistencyCheckActor",null,[770]);var Jd=d(308),Ie=d(95),gf=d(891),eh=d(669),rg=d(48),Cg=d(670),kh=d(671);class De extends eh.a{constructor(da,Fa){super();this.$Zc=[gf.a.xve,gf.a.fXc,gf.a.Sfd,gf.a.cDc];this.ua=da;this.I5j=Fa;this.Ele=[new Cg.a("InconsistentCritiquesHighlight",null),new Cg.a("InconsistentCritiquesLeftSidebar",
null),new Cg.a("InconsistentCritiquesRightSidebar",null)]}get Kub(){return this.I5j}get M6d(){return this.Ele}k4b(da,Fa){da=Object(Pc.a)(Array,da)?Array.isArray(da)?da:null:null;if(!da||0<da.length&&!Object(I.a)(Ed,da[0]))return Fa;const Ua=new rg.GraphTransaction(3);try{Ua.gd(this.ua.presentation);for(const cb of da)kh.b(cb.paragraph),Fa.add(cb.paragraph)}finally{Ua&&Ua.dispose()}return Fa}Vec(da,Fa){if(this.Kub&&this.OZ&&this.OZ.cia&&this.OZ.cia.sca&&2===this.OZ.cia.type){var Ua=[],cb=[];this.d7g(this.OZ.cia.sca,
Ua,cb);var Jb=[];this.d7g(this.OZ.cia.Qeb,null,Jb);Fa=Fa.querySelectorAll("*");for(let Gc=0;Gc<Fa.length;Gc++){let pd="",Ld="";const de=Fa[Gc];for(let Be=0;Be<this.$Zc.length;Be++)Jd.a.te(de,this.$Zc[Be])&&(Ld=this.$Zc[Be],pd=Jd.a.te(de,this.$Zc[Be]));pd.length&&2===this.OZ.cia.type&&(0===this.OZ.cia.action?Array.contains(cb,da)&&Array.contains(Ua,pd)?this.Nuj(de,Ld):this.yed(de):1===this.OZ.cia.action&&Array.contains(Jb,da)&&this.yed(de))}}}Nuj(da,Fa){Ie.a.bI(da,"InconsistentCritiquesHighlight");
switch(Fa){case gf.a.fXc:Ie.a.bI(da,"InconsistentCritiquesLeftSidebar");break;case gf.a.Sfd:Ie.a.bI(da,"InconsistentCritiquesRightSidebar");break;case gf.a.cDc:Ie.a.bI(da,"InconsistentCritiquesLeftSidebar"),Ie.a.bI(da,"InconsistentCritiquesRightSidebar")}}d7g(da,Fa,Ua){if(da)for(const cb of da)Array.add(Ua,cb.paragraph),Fa&&Array.add(Fa,cb.critiqueId)}}Object(h.a)(De,"CritiquesHighlightActor",eh.a,[]);class Nd{}Object(h.a)(Nd,"Critique",null,[]);class Od{}Object(h.a)(Od,"Suggestion",null,[]);class mj{QSf(da,
Fa){if(!da)return[];const Ua=Array(da.length);for(let cb=0;cb<da.length;cb++)Ua[cb]=Fa(da[cb]);return Ua}jwi(da){return Object.assign(new Nd,{critiqueId:da.TraceId,typeId:da.TypeId,tag:da.Tag,bucketId:da.BucketId,paragraphId:da.TileId,start:da.Start,length:da.Length,categoryTitle:da.CategoryTitle,explanationTitle:da.ExplanationTitle,explanationLabel:da.ExplanationLabel,explanation:da.Explanation,suggestions:this.QSf(da.Suggestions,Object(w.a)(this,this.kwi,"convertBox4Suggestion"))})}kwi(da){return Object.assign(new Od,
{text:da.Text,description:da.Description,bucketId:da.BucketId,numberOfInstances:da.NumberOfInstances})}}Object(h.a)(mj,"DataContractMapper",null,[773]);class qi extends Sys.EventArgs{constructor(da){super();this.instanceId=da}}Object(h.a)(qi,"PaneClosedEventArgs",Sys.EventArgs,[]);var Vf=d(186);class Ai{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld){this.ia=da;this.Zd=Fa;this.Lc=Ua;this.nie=cb;this.uAb=Jb;this.hzb=Gc;this.Nle=pd;this.Abk=Ld;this.Be=0;this.Zd.execute(de=>{de.GId(Object(w.a)(this,this.Ydb,"onPaneClosed"))})}get state(){return this.Be}yid(da){this.Be!==
da&&(this.Be=da,this.Lc.mz(new Vf.a(1)))}Y3g(da){0===this.state&&(Fc.a.J(36966754,375,50,"[EditorPane] Begin opening Editor pane, reason: {0} Time: {1}",da,(new Date).getTime()),this.yid(1),da={},da.CU=ResourceStrings.L_EditorPaneTitle,da.assetId=this.uAb.getAssetId(),da.Tva=Object(w.a)(this,this.fye,"onPaneRendered"),da.nonPersistedSettings={},da.nonPersistedSettings.IdeasEnabled=this.Nle.toString(),da.npc=this.Abk,32!==this.ia.La(fd.a.nJa,2,da)&&(Fc.a.J(36966784,375,15,"[EditorPane] Failed to open Editor pane"),
this.yid(0)))}tK(da){if(2===this.state){var Fa=this.uAb.PNc();Fa&&(Fc.a.J(36966786,375,50,"[EditorPane] Begin closing Editor pane, reason: {0}",da),32!==this.ia.La(fd.a.ZEc,2,Fa)&&Fc.a.J(36966788,375,15,"[EditorPane] Failed to close Editor pane"))}}Ydb(da,Fa){2===this.state&&Fa&&(da=Fa.instanceId)&&da.length&&(Fa=this.uAb.PNc(),Fa!==da&&Fa||(Fc.a.J(37626588,375,50,"[EditorPane] Pane closed"),this.nie.JHk(new qi(da)),this.yid(0),this.hzb.sessionEnd()))}fye(){const da=this.uAb.PNc();1!==this.state?
Fc.a.J(37626590,375,15,"[EditorPaneActor] Received pane rendered event even though we weren't in opening state. Instance id={0}",da):(Fc.a.J(37626592,375,50,"[EditorPane] Pane rendered. Instance id={0}",da),this.yid(2),this.hzb.f2k())}}Object(h.a)(Ai,"EditorPane",null,[775]);var $g=d(342);class Ch{constructor(da,Fa){this.type=0;this.id=null;this.type=da;this.id=Fa}static Kib(da){return da.id&&da.id.toString().length&&Object(Pc.a)(Number,da.type)?new Ch(da.type,da.id.toString()):null}}Object(h.a)(Ch,
"Message",null,[]);var nf=d(2);class qf{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld,de,Be,Mf,Dg,yd,td,id,ed){this.dWd=new Ph.a;this.ia=da;this.s_=Fa;this.Fyb=Ua;this.rHg=cb;this.t_=Jb;this.vOg=Gc;this.iL=pd;this.nie=Ld;this.ua=de;this.ila=Be;this.T4c=Mf;this.Hk=Dg;this.u2j=yd;this.Lc=td;this.x3j=id;this.uc=ed;this.TJc=new Ph.a(0);this.TJc.add(0,2001);this.TJc.add(1,2002);this.TJc.add(2,2003)}ub(){this.ia.pa(fd.a.Fzk,Wb.a.application,Object(w.a)(this,this.e0f,"editorPaneButtonClicked"),4);this.ia.pa(fd.a.O$g,
Wb.a.application,Object(w.a)(this,this.n$g,"queryEditorPaneButton"),96);this.ia.pa(fd.a.Gzk,Wb.a.application,Object(w.a)(this,this.e0f,"editorPaneButtonClicked"),4);this.ia.pa(fd.a.P$g,Wb.a.application,Object(w.a)(this,this.n$g,"queryEditorPaneButton"),96);this.ia.pa(fd.a.fBe,Wb.a.application,Object(w.a)(this,this.f0f,"editorPaneExtenal"),4);this.ia.pa(fd.a.F7g,Wb.a.application,Object(w.a)(this,this.f0f,"editorPaneExtenal"),4);this.rHg.xId(Object(w.a)(this,this.Rlk,"onEditorPaneMessageReceived"));
this.ila.B3a(Object(w.a)(this,this.f0,"onSlidePresenceChanged"));this.T4c.Yj(Object(w.a)(this,this.qma,"onSlidePropertyChanged"));this.Hk.UH(Object(w.a)(this,this.dB,"onActiveSlideChanged"));this.nie.j7h(Object(w.a)(this,this.Ydb,"onPaneClosed"))}xe(){}f0f(da,Fa,Ua){if(1===Ua)return 32;switch(da){case fd.a.fBe:this.s_.Y3g(2);break;case fd.a.F7g:this.s_.tK(2);break;default:return Fc.a.J(38412318,375,10,"[EditorPaneActor] Unsupported actionId: {0}",da),16}return 32}e0f(da,Fa,Ua){if(1===Ua)return this.uc.Hj()?
32:16;switch(this.s_.state){case 0:return this.s_.Y3g(1),32;case 2:return this.s_.tK(1),32;case 1:return Fc.a.J(37626594,375,50,"[EditorPaneActor] User double clicked to open pane before it was rendered"),this.Lc.mz(new Vf.a(1)),32;default:return Fc.a.J(36966800,375,10,"[EditorPaneActor] Unsupported EditorPaneState"),16}}n$g(da,Fa,Ua,cb,Jb){if(!Jb||!Object(Pc.a)(Ye.a,Jb))return 8;Jb.Nf(2===this.s_.state||1===this.s_.state);return 32}Rlk(da,Fa){this.Slk(Fa)}Slk(da){const Fa=this.t_.fHi(da.message);
if(Fa){var Ua;({value:Ua}=this.vOg.Rf(Fa.type)).returnValue||(Ua=this.vOg.ga(0));var cb=Ua.process(da,Fa);cb.continueWith(()=>{const Jb=cb.result,Gc=this.t_.P0f(Jb);this.sendMessage(da.instanceId,Gc);this.OYj(da,Fa,Jb)})}else Fc.a.J(37025985,375,15,"[EditorPaneActor] OnEditorPaneMessageReceived, can't deserialize message."),nf.Task.Gt(!1)}jEe(da){this.dWd.Jb(da)||this.dWd.$(da,this.x3j.$Qd(200,()=>{const Fa=this.Fyb.Ggj(da);if(Fa.length){var Ua=new Ch(this.TJc.ga(da),$g.a.create().toString());Ua=
this.t_.P0f(Ua);this.c1k(Fa,Ua)}this.u2j.iEe(da)}));this.dWd.ga(da).perform()}c1k(da,Fa){for(const Ua of da)this.sendMessage(Ua,Fa)}sendMessage(da,Fa){this.rHg.sendMessage(da,Fa)}OYj(da,Fa,Ua){const cb=new Date,Jb=+cb-+da.rch;2E3<=Jb&&Fc.a.J(39331167,375,1E4<=Jb?10:15,"[EditorPaneActor] Host was slow to respond to the message receivedInstanceId={0} receivedIsFromEditorPane={1} receivedTimestamp={2} currentTime={3} passedMilliseconds={4} receivedId={5} receivedType={6} responseId={7} responseType={8}",
da.instanceId,da.jae,da.rch.toUTCString(),cb.getTime(),Jb.toString(),Fa.id,Fa.type,Ua.id,Ua.type)}qma(da,Fa){Fa.property===ld.a.isSlideCritiqueReady&&this.jEe(1)}dB(){this.jEe(0)}f0(da,Fa){(da=this.ua.Ba)&&Fa.slideId.equals(da.Bb)&&this.jEe(2)}Ydb(da,Fa){this.Fyb.Pul(Fa.instanceId);this.iL.visualizeCritiques([])}}Object(h.a)(qf,"EditorPaneActor",null,[]);class Wi{constructor(){this.va=new pg.a}j7h(da){this.va.addHandler("PaneClosed",da)}JHk(da){this.va.raiseEvent("PaneClosed",da)}}Object(h.a)(Wi,
"EditorPaneEventSource",null,[776,821,822]);var Tg=d(4);class rd{}Object(h.a)(rd,"Paragraph",null,[]);var ze=d(208);class xh{constructor(da,Fa,Ua,cb,Jb,Gc,pd,Ld,de){this.ua=da;this.mC=Fa;this.VTa=Ua;this.ia=cb;this.Ea=Jb;this.g9j=Gc;this.Ghe=pd;this.Hh=Ld;this.P5j=de}checkProofingDirty(da){const Fa=da.includedTags;if(2===da.critiqueSelection&&1===Fa)return da=(da=this.ua.Ba)&&da.isConnected?!da.isSlideCritiqueReady:!0,this.pta(0,!0),da;this.XDg("CheckProofingDirty");return!0}getCritiques(da){var Fa=
da.includedTags;if(2===da.critiqueSelection&&1===Fa){da=this.ua.Ba;if(!da||!da.isConnected||!da.isSlideCritiqueReady)return null;Fa=da.tJa;da=[];for(let Ua of Fa)if((Fa=Ua)&&Fa.isConnected){Fa=this.mC.iF(Fa,cb=>{cb=Object(I.a)(658,cb.Gh);return!!cb&&5===cb.proofingType&&!cb.mDa});for(const cb of Fa)(Fa=Object(I.a)(658,cb.Gh))&&da.push(Fa.UM)}this.pta(1,!0);return this.Ghe.QSf(da,Object(w.a)(this.Ghe,this.Ghe.jwi,"convertBox4Critique"))}this.XDg("GetCritiques");return null}Ydg(da){var Fa=this.ua.Ba;
if(!Fa||!Fa.isConnected)return null;const Ua=[];da=xh.Jgk(da);Fa=Fa.Mha;for(const cb of da)(da=Object(I.a)(ce.a,Fa.te($g.a.Mf(cb))))&&da.isConnected&&Ua.push(Object.assign(new rd,{paragraphId:cb,text:this.Hh.OGe(da,"\n")}));return Ua}getSupportedLanguages(da){return this.g9j.K2i(da.includedTags).CWR(Fa=>{const Ua=[];if(Fa=Object(I.a)(Tg.a,Fa)){Fa=Fa.result;for(let cb of Fa)(Fa=cc.a.oe(cb))&&Array.add(Ua,Fa.name)}this.pta(6,!0);return Ua})}getLanguagesOnCurrentSlide(){const da=[],Fa=[],Ua=this.ua.Ba;
let cb=[];Ua&&(cb=Ua.jl());for(const Jb of cb)this.Ea.kJ(Jb,Gc=>{if(Gc&&Object(Pc.a)(dd.AParagraphNode,Gc)){Gc=Object(I.a)(dd.AParagraphNode,Gc);var pd=Gc.characterData;if(pd&&pd.length){var Ld=-1,de;for(pd=0;pd<Gc.Ra.length;pd++)if(de=Gc.Ra.ga(pd).formatting)de=Td.a.language(de),Ld===de||Array.contains(da,de)||(Array.add(da,de),(Ld=cc.a.oe(de))&&Array.add(Fa,Ld.name)),Ld=de}}});this.pta(7,!0);return Fa}visualizeCritiques(da){if(!da)return this.pta(2,!1),1;const Fa=Array(da.length);if(!da.length)return this.VTa.kRc(Fa),
this.pta(2,!0),0;for(let Ua=0;Ua<da.length;Ua++)Fa[Ua]=da[Ua].critiqueId;this.VTa.kRc(Fa);this.pta(2,!0);return 0}resolveCritiques(da){if(!da||!da.length)return 1;const Fa=new Ph.a(0);for(const Ua of da)Fa.add(Ua.critiqueId,Ua.suggestionIndex);da=this.VTa.vxh(Fa);this.pta(3,da);return da?0:1}ignoreCritiques(da){if(!da||!da.length)return 1;const Fa=[];for(const Ua of da)Array.add(Fa,Ua.critiqueId);da=this.VTa.ignoreCritiques(Fa,4);this.pta(4,da);return da?0:1}openProofingSettingsDialog(){if(this.P5j){const da=
this.ia.processAction(Uf.a.Q$c,2);this.pta(5,32===da)}}pta(da,Fa){Fc.a.J(37266337,375,50,"{0}: {1}",da,Fa?0:1)}XDg(da){Fc.a.J(36750081,375,15,"{0}: Unsupported CritiqueFilter",da)}static Jgk(da){const Fa=new ze.a;for(var Ua of da)Fa.contains(Ua.paragraphId)||Fa.add(Ua.paragraphId);da=Array(Fa.count);Ua=0;for(let cb of Fa)da[Ua++]=cb;return da}}Object(h.a)(xh,"EditorPaneHost",null,[772]);class Qj{}Object(h.a)(Qj,"EditorRuntimeNotificationData",null,[]);class ae extends Sys.EventArgs{constructor(){super();
this.uZb=this.nja=null}}Object(h.a)(ae,"EditorRuntimeNotificationEventArgs",Sys.EventArgs,[]);class nj{constructor(){this.notificationConfidence=0;this.shouldRaiseNotification=!1;this.confidence=0;this.resultStatus=null}}Object(h.a)(nj,"InfraredResultBase",null,[]);var Xi=d(328),La=d(518);class lb{constructor(da,Fa){this.includedTags=this.critiqueSelection=0;this.critiqueSelection=da;this.includedTags=Fa}static uH(da){return Object(Pc.a)(Number,da.critiqueSelection)&&Object(Pc.a)(Number,da.includedTags)?
new lb(da.critiqueSelection,da.includedTags):null}}Object(h.a)(lb,"CritiqueFilter",null,[]);class Nb{constructor(da,Fa,Ua,cb){this.ia=da;this.iL=Fa;this.ua=Ua;this.sHg=cb}iEe(da){if(this.sHg){var Fa=new lb(2,1),Ua=this.iL.checkProofingDirty(Fa),cb=Ua?[]:this.iL.getCritiques(Fa),Jb=Ua?[]:this.iL.Ydg(cb);Fa=this.Wve();da=Object.assign(new Qj,{isProofingDirty:Ua,critiques:cb,paragraphs:Jb,numberOfCoAuthors:Fa,contextChanged:0===da});Jb=(cb=!!cb&&0<cb.length)?1:0;let Gc=Xi.a.success;0<Fa?Gc=Xi.a.nHa:
Ua?Gc=Xi.a.pending:cb||(Gc=Xi.a.nHa);Ua=Object.assign(new ae,{nja:Object.assign(new nj,{notificationConfidence:Jb,shouldRaiseNotification:!1,confidence:1,resultStatus:Gc}),uZb:da});this.sHg.iEe(Ua)}}Wve(){var da=this.ua.Ba;if(!da||!da.isConnected)return 0;da=Object.assign(new La.a,{slideId:da.Bb});this.ia.La(fd.a.uXa,2,da);return da.vmc}}Object(h.a)(Nb,"EditorRuntimeEventRaiser",null,[771]);var lc=d(534),Rc=d(684);class Ud{constructor(da){this.q4j=da}f2k(){this.rYa(0,0)}sessionEnd(){this.rYa(1,0)}tkl(){this.rYa(2,
4)}ukl(){this.rYa(2,3)}rYa(da,Fa){this.q4j.execute(Ua=>{const cb=Object.assign(new Rc.a,{cardId:lc.a.c0f,actionType:da,actionEngagement:Fa});Ua.f8c(cb)})}}Object(h.a)(Ud,"InfraredTelemetryLogger",null,[774]);class Pd extends Ch{constructor(da,Fa,Ua){super(da,Fa);this.payload=null;this.payload=Ua}}Object(h.a)(Pd,"MessageWithPayload",Ch,[]);class Sd extends Pd{constructor(da,Fa,Ua){super(da,Fa,Ua)}}Object(h.a)(Sd,"CheckProofingDirtyAndGetCritiquesResponse",Pd,[]);class Le extends Pd{constructor(da,
Fa,Ua){super(da,Fa,Ua)}}Object(h.a)(Le,"ResponseMessage",Pd,[]);class af{constructor(da){this.statusCode=0;this.logErrorMessage=null;this.statusCode=da;this.logErrorMessage="";0!==da&&(this.logErrorMessage=da.toString())}}Object(h.a)(af,"Response",null,[]);class zf extends af{constructor(da,Fa,Ua,cb){super(0);this.isProofingDirty=!1;this.languagesOnTheCurrentSlide=this.paragraphs=this.critiques=null;this.isProofingDirty=da;this.critiques=Fa;this.paragraphs=Ua;this.languagesOnTheCurrentSlide=cb}}Object(h.a)(zf,
"ProofingDirtyAndCritiques",af,[]);class yh{constructor(da,Fa,Ua){this.ua=da;this.iL=Fa;this.t_=Ua}process(da,Fa){var Ua=this.t_.rFi(da.message);if(!Ua)return Fc.a.J(37025993,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Can't decode message."),da=new af(1),nf.Task.Gt(new Le(1003,Fa.id,da));da=this.ua.Ba;if(!da||!da.isConnected)return Fc.a.J(37025995,375,50,"[CheckProofingDirtyAndGetCritiquesProcessor] Active slide doesn't exist or is not connected"),da=new zf(!1,[],[],[]),Fa=new Sd(1003,Fa.id,
da),nf.Task.Gt(Fa);Ua=(da=this.iL.checkProofingDirty(Ua.payload))?[]:this.iL.getCritiques(Ua.payload);if(!Ua)return Fc.a.J(38418246,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] No box4 critiques were returned by host"),da=new af(2),nf.Task.Gt(new Le(1003,Fa.id,da));const cb=da?[]:this.iL.Ydg(Ua),Jb=da?[]:this.iL.getLanguagesOnCurrentSlide();if(!Jb)return Fc.a.J(38418248,375,15,"[CheckProofingDirtyAndGetCritiquesProcessor] Failed to query languages on current slide"),da=new af(7),nf.Task.Gt(new Le(1003,
Fa.id,da));da=new zf(da,Ua,cb,Jb);Fa=new Sd(1003,Fa.id,da);return nf.Task.Gt(Fa)}}Object(h.a)(yh,"CheckProofingDirtyAndGetCritiquesProcessor",null,[820]);class gg{constructor(da,Fa,Ua){this.iL=da;this.t_=Fa;this.hzb=Ua}process(da,Fa){var Ua=this.t_.tFi(da.message);if(!Ua)return Fc.a.J(37087328,375,15,"[IgnoreProcessor] Can't decode message."),da=new af(1),nf.Task.Gt(new Le(1006,Fa.id,da));Ua=this.iL.ignoreCritiques(Ua.payload);0===Ua&&da.jae&&this.hzb.ukl();da=0===Ua?new af(0):new af(6);return nf.Task.Gt(new Le(1006,
Fa.id,da))}}Object(h.a)(gg,"IgnoreProcessor",null,[820]);class Dh extends Pd{constructor(da,Fa,Ua){super(da,Fa,Ua)}}Object(h.a)(Dh,"NumberOfCoAuthorsResponse",Pd,[]);class Ug extends af{constructor(da){super(0);this.numberOfCoAuthors=0;this.numberOfCoAuthors=da}}Object(h.a)(Ug,"NumberOfCoAuthorsModel",af,[]);class ui{constructor(da,Fa){this.ia=da;this.ua=Fa}process(da,Fa){da=this.Wve();da=new Ug(da);return nf.Task.Gt(new Dh(1009,Fa.id,da))}Wve(){var da=this.ua.Ba;if(!da||!da.isConnected)return 0;
da=Object.assign(new La.a,{slideId:da.Bb});this.ia.La(fd.a.uXa,2,da);return da.vmc}}Object(h.a)(ui,"NumberOfCoAuthorsProcessor",null,[820]);class Uh{constructor(da,Fa,Ua){this.ia=da;this.s_=Fa;this.Nle=Ua}process(da,Fa){if(!this.Nle)return Fc.a.J(38412446,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Ideas disabled, but we were asked to open Ideas pane"),da=new af(10),nf.Task.Gt(new Le(1011,Fa.id,da));this.s_.tK(3);da=this.ia.processAction(fd.a.eOe,2);32!==da&&Fc.a.J(38412448,375,15,"[OpenIdeasPaneAndCloseEditorPaneProcessor] Failed to open Ideas pane");
da=new af(32!==da?9:0);return nf.Task.Gt(new Le(1011,Fa.id,da))}}Object(h.a)(Uh,"OpenIdeasPaneAndCloseEditorPaneProcessor",null,[820]);class Yi{constructor(da){this.iL=da}process(da,Fa){this.iL.openProofingSettingsDialog();da=new af(0);return nf.Task.Gt(new Le(1007,Fa.id,da))}}Object(h.a)(Yi,"OpenProofingSettingsProcessor",null,[820]);class lh{constructor(da,Fa,Ua){this.iL=da;this.t_=Fa;this.hzb=Ua}process(da,Fa){var Ua=this.t_.uFi(da.message);if(!Ua)return Fc.a.J(37087330,375,15,"[ResolveProcessor] Can't decode message."),
da=new af(1),nf.Task.Gt(new Le(1005,Fa.id,da));Ua=this.iL.resolveCritiques(Ua.payload);0===Ua&&da.jae&&this.hzb.tkl();da=0===Ua?new af(0):new af(5);return nf.Task.Gt(new Le(1005,Fa.id,da))}}Object(h.a)(lh,"ResolveProcessor",null,[820]);class jg extends Pd{constructor(da,Fa,Ua){super(da,Fa,Ua)}}Object(h.a)(jg,"SubscriptionResponse",Pd,[]);class cj extends af{constructor(da){super(0);this.telemetryCorrelationId=null;this.telemetryCorrelationId=da}}Object(h.a)(cj,"SubscriptionModel",af,[]);class oj{constructor(da,
Fa){this.Fyb=da;this.t_=Fa}process(da,Fa){const Ua=this.t_.vFi(da.message);if(!Ua)return Fc.a.J(39331169,375,15,"[SubscribeProcessor] Can't decode message."),da=new af(1),nf.Task.Gt(new Le(1001,Fa.id,da));Fc.a.J(39331171,375,50,"Editor pane telemetry correlation id={0}",Ua.payload.telemetryCorrelationId);this.Fyb.subscribe(da.instanceId,0);this.Fyb.subscribe(da.instanceId,1);this.Fyb.subscribe(da.instanceId,2);da=new cj("not available");return nf.Task.Gt(new jg(1001,Fa.id,da))}}Object(h.a)(oj,"SubscribeProcessor",
null,[820]);class hk extends Pd{constructor(da,Fa,Ua){super(da,Fa,Ua)}}Object(h.a)(hk,"SupportedLanguagesResponse",Pd,[]);class Vh extends af{constructor(da){super(0);this.supportedLanguages=null;this.supportedLanguages=da}}Object(h.a)(Vh,"SupportedLanguagesModel",af,[]);class Ji{constructor(da,Fa){this.iL=da;this.t_=Fa}process(da,Fa){da=this.t_.wFi(da.message);if(!da)return Fc.a.J(38094432,375,15,"[SupportedLanguagesProcessor] Can't decode message."),da=new af(1),nf.Task.Gt(new Le(1010,Fa.id,da));
const Ua=this.iL.getSupportedLanguages(da.payload);return Ua.CWR(()=>{var cb=Ua.result;if(!cb)return Fc.a.J(38094434,375,15,"[SupportedLanguagesProcessor] Failed to query supported languages"),cb=new af(8),new Le(1010,Fa.id,cb);cb=new Vh(cb);return new hk(1010,Fa.id,cb)})}}Object(h.a)(Ji,"SupportedLanguagesProcessor",null,[820]);class Bi{process(da,Fa){Fc.a.J(37025999,375,15,"[UnsupportedMessageProcessor] Unsupported message type: {0}",Fa.type);da=new af(3);return nf.Task.Gt(new Le(Fa.type,Fa.id,
da))}}Object(h.a)(Bi,"UnsupportedMessageProcessor",null,[820]);class Eh{constructor(da,Fa){this.iL=da;this.t_=Fa}process(da,Fa){da=this.t_.xFi(da.message);if(!da)return Fc.a.J(37026001,375,15,"[VisualizeProcessor] Can't decode message."),da=new af(1),nf.Task.Gt(new Le(1004,Fa.id,da));da=0===this.iL.visualizeCritiques(da.payload)?new af(0):new af(4);return nf.Task.Gt(new Le(1004,Fa.id,da))}}Object(h.a)(Eh,"VisualizeProcessor",null,[820]);class rh extends Pd{constructor(da,Fa,Ua){super(da,Fa,Ua)}static uH(da){const Fa=
Ch.Kib(da);return Fa&&da.payload?(da=lb.uH(da.payload))?new rh(Fa.type,Fa.id,da):null:null}}Object(h.a)(rh,"CheckProofingDirtyAndGetCritiquesMessage",Pd,[]);class sg{constructor(da){this.EMb=da}get critiqueId(){return this.EMb}static uH(da){return da.critiqueId&&Object(I.a)(String,da.critiqueId)?new sg(da.critiqueId.toString()):null}}Object(h.a)(sg,"CritiqueIgnore",null,[]);class ci extends Pd{constructor(da,Fa,Ua){super(da,Fa,Ua)}static uH(da){const Fa=Ch.Kib(da);if(!Fa||!da.payload||!Object(Pc.a)(Array,
da.payload))return null;da=da.payload;const Ua=Array(da.length);for(let cb=0;cb<da.length;cb++){const Jb=sg.uH(da[cb]);if(!Ua)return null;Ua[cb]=Jb}return new ci(Fa.type,Fa.id,Ua)}}Object(h.a)(ci,"IgnoreCritiquesMessage",Pd,[]);class dj{constructor(da,Fa){this.EMb=da;this.kYh=Fa}get critiqueId(){return this.EMb}get suggestionIndex(){return this.kYh}static uH(da){return da.critiqueId&&Object(I.a)(String,da.critiqueId)&&Object(Pc.a)(Number,da.suggestionIndex)?new dj(da.critiqueId.toString(),da.suggestionIndex):
null}}Object(h.a)(dj,"CritiqueResolution",null,[]);class Zi extends Pd{constructor(da,Fa,Ua){super(da,Fa,Ua)}static uH(da){const Fa=Ch.Kib(da);if(!Fa||!da.payload||!Object(Pc.a)(Array,da.payload))return null;da=da.payload;const Ua=Array(da.length);for(let cb=0;cb<da.length;cb++){const Jb=dj.uH(da[cb]);if(!Ua)return null;Ua[cb]=Jb}return new Zi(Fa.type,Fa.id,Ua)}}Object(h.a)(Zi,"ResolveCritiquesMessage",Pd,[]);class Ri{constructor(da){this.telemetryCorrelationId=null;this.telemetryCorrelationId=da}static uH(da){let Fa=
"unavailable";da.telemetryCorrelationId&&Object(I.a)(String,da.telemetryCorrelationId)&&da.telemetryCorrelationId.toString().length&&50>=da.telemetryCorrelationId.toString().length&&(Fa=da.telemetryCorrelationId.toString());return new Ri(Fa)}}Object(h.a)(Ri,"Subscription",null,[]);class Fh extends Pd{constructor(da,Fa,Ua){super(da,Fa,Ua)}static uH(da){const Fa=Ch.Kib(da);if(!Fa)return null;da.payload||(da.payload={});return(da=Ri.uH(da.payload))?new Fh(Fa.type,Fa.id,da):null}}Object(h.a)(Fh,"SubscribeMessage",
Pd,[]);class Rj extends Pd{constructor(da,Fa,Ua){super(da,Fa,Ua)}static uH(da){const Fa=Ch.Kib(da);return Fa&&da.payload?(da=lb.uH(da.payload))?new Rj(Fa.type,Fa.id,da):null:null}}Object(h.a)(Rj,"SupportedLanguagesMessage",Pd,[]);class mh{constructor(da){this.EMb=da}get critiqueId(){return this.EMb}static uH(da){return da.critiqueId&&Object(I.a)(String,da.critiqueId)&&da.critiqueId.toString().length?new mh(da.critiqueId.toString()):null}}Object(h.a)(mh,"CritiqueToVisualize",null,[]);class va extends Pd{constructor(da,
Fa,Ua){super(da,Fa,Ua)}static uH(da){const Fa=Ch.Kib(da);if(!Fa||!da.payload||!Object(Pc.a)(Array,da.payload))return null;da=da.payload;const Ua=Array(da.length);for(let cb=0;cb<da.length;cb++){const Jb=mh.uH(da[cb]);if(!Ua)return null;Ua[cb]=Jb}return new va(Fa.type,Fa.id,Ua)}}Object(h.a)(va,"VisualizeCritiquesMessage",Pd,[]);class Qa{fHi(da){return this.Jib(da,Ch.Kib)}vFi(da){return this.Jib(da,Fh.uH)}rFi(da){return this.Jib(da,rh.uH)}xFi(da){return this.Jib(da,va.uH)}uFi(da){return this.Jib(da,
Zi.uH)}tFi(da){return this.Jib(da,ci.uH)}wFi(da){return this.Jib(da,Rj.uH)}Jib(da,Fa){try{let Ua;return({ou:Ua}=u.d(da)).returnValue?Fa(Ua):null}catch(Ua){return null}}P0f(da){return u.c(da)}}Object(h.a)(Qa,"MessageEncoder",null,[780]);var db=d(80);class Gb extends Sys.EventArgs{constructor(da,Fa,Ua){super();this.instanceId=da;this.message=Fa;this.jae=Ua;this.rch=new Date}}Object(h.a)(Gb,"MessageReceivedEventArgs",Sys.EventArgs,[]);class jc{constructor(da,Fa,Ua){this.va=new pg.a;this.uAb=da;this.QEg=
Fa;this.f4j=new RegExp(Ua,"i")}initialize(){try{if(window.addEventListener)return window.addEventListener("message",Object(w.a)(this,this.Adc,"messageReceivedHandler"),!1),!0;if(-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent)return window.attachEvent("onmessage",Object(w.a)(this,this.Adc,"messageReceivedHandler")),!0;Fc.a.J(37026003,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window")}catch(da){Fc.a.J(37026005,375,10,"[EditorPane.Messaging.Messenger] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",
da.message,da.stack)}return!1}xId(da){this.va.addHandler("MessageReceived",da)}afh(da){this.va.removeHandler("MessageReceived",da)}sendMessage(da,Fa){if(da&&Fa){var Ua={};Ua.message=Fa;Ua.editorPaneWildCard=".";this.$0k(da,Ua)}}$0k(da,Fa){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(da,"onCustomMessage",Fa,Ua=>{Ua&&Fc.a.J(37026007,375,15,"Couldn't deliver the message to Editor pane, status: {0}.",Ua)})}Adc(da){const Fa=da.origin;if(this.w5b(Fa)){var Ua;({ou:Ua}=u.d(da.data)).returnValue&&
Ua&&"."===Ua.editorPaneWildCard&&Ua.message&&this.va.raiseEvent("MessageReceived",new Gb(this.uAb.PNc(),Ua.message,Fa===this.QEg))}}w5b(da){const Fa=db.a.AS(window.location.href);return!!da&&0<da.length&&"null"!==da&&(da===this.QEg||da===Fa||this.f4j.test(da))}}Object(h.a)(jc,"Messenger",null,[779]);class Ac{constructor(da,Fa){this.Zd=da;this.assetId=Fa.R7g}PNc(){if(!this.Zd.instance)return Fc.a.J(37025987,375,15,"[EditorPaneManager] App for office manager not present"),null;const da=this.Zd.instance.DZ(this.assetId);
return da?da.instanceId?da.instanceId:(Fc.a.J(37025991,375,15,"[EditorPaneManager] App for office doesn't have instance id"),null):(Fc.a.J(37025989,375,200,"[EditorPaneManager] App for office not found"),null)}getAssetId(){return this.assetId}}Object(h.a)(Ac,"PaneIdsProvider",null,[777]);class W{constructor(){this.us=new Ph.a}subscribe(da,Fa){da&&(this.us.Jb(Fa)||this.us.add(Fa,[]),Array.contains(this.us.ga(Fa),da)||this.us.ga(Fa).push(da))}unsubscribe(da,Fa){da&&this.us.Jb(Fa)&&(da=Array.indexOf(this.us.ga(Fa),
da),-1!==da&&Array.removeAt(this.us.ga(Fa),da))}Pul(da){da&&(this.unsubscribe(da,0),this.unsubscribe(da,1),this.unsubscribe(da,2))}Ggj(da){return this.us.Jb(da)?this.us.ga(da):[]}}Object(h.a)(W,"EditorPaneSubscriptionsManager",null,[778]);class xa{constructor(){this.K=null}get name(){return"PowerPointWebEditor.EditorPane"}Wb(da){da&&(this.K=da,this.K.register(De,"PowerPointWebEditor.Proofing.CritiquesHighlightActor").ma().na(()=>new De(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorConsistencyCheckIsEnabled)),this.K.register(770,"PowerPointWebEditor.Proofing.IConsistencyCheckActor").ma().na(()=>new vg(this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.Proofing.CritiquesHighlightActor"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFocusDocumentAfterActionOnEditorPaneIsEnabled)),this.K.register(qf,"PowerPointWebEditor.EditorPane.EditorPaneActor").ma().na(()=>new qf(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.SAi(),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").vd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),this.K.resolve("PowerPointWebEditor.IPresentationReader"))),xa.bHj&&this.K.register(Zf,"PowerPointWebEditor.EditorPane.DexLitePaneActor").ma().na(()=>new Zf(this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.View.IDexLitePane"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Jv,this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(771,"PowerPointWebEditor.EditorPane.IEditorRuntimeEventRaiser").ma().na(()=>new Nb(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"))),this.K.register(ef,"PowerPointWebEditor.Editor.Common.Model.EditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventNotifier").as("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventHandler").ma().na(()=>new ef),this.K.register(772,"PowerPointWebEditor.EditorPane.IEditorPaneHost").ma().na(()=>new xh(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckActor"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IDataContractMapper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Common.IAppSettingsManager").ka("299"))),this.K.register(773,"PowerPointWebEditor.EditorPane.IDataContractMapper").ma().na(()=>
new mj),this.K.register(774,"PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger").ma().na(()=>new Ud(this.K.Ka("PowerPointWebEditor.IInfraredTelemetryListener"))),this.K.register(775,"PowerPointWebEditor.EditorPane.IEditorPane").ma().na(()=>new Ai(this.K.resolve("Common.IActionManagerExtended"),this.K.Ka("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneEventSource"),this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled,!0)),this.K.register(776,"PowerPointWebEditor.EditorPane.IEditorPaneEventSource").ma().na(()=>new Wi),this.K.register(777,"PowerPointWebEditor.EditorPane.IPaneIdsProvider").ma().na(()=>new Ac(this.K.Ka("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(778,"PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager").ma().na(()=>
new W),this.K.register(779,"PowerPointWebEditor.EditorPane.Messaging.IMessenger").ma().na(()=>new jc(this.K.resolve("PowerPointWebEditor.EditorPane.IPaneIdsProvider"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pAk,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasApprovedOriginPattern)),this.K.register(780,"PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder").ma().na(()=>new Qa),this.K.register(Bi,"PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor").ma().na(()=>
new Bi),this.K.register(oj,"PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor").ma().na(()=>new oj(this.K.resolve("PowerPointWebEditor.EditorPane.Subscription.IEditorPaneSubscriptionsManager"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(lh,"PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor").ma().na(()=>new lh(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),
this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(gg,"PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor").ma().na(()=>new gg(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"),this.K.resolve("PowerPointWebEditor.EditorPane.IInfraredTelemetryLogger"))),this.K.register(Yi,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor").ma().na(()=>
new Yi(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"))),this.K.register(yh,"PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor").ma().na(()=>new yh(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Eh,"PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor").ma().na(()=>
new Eh(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(ui,"PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor").ma().na(()=>new ui(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"))),this.K.register(Ji,"PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor").ma().na(()=>new Ji(this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPaneHost"),
this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessageEncoder"))),this.K.register(Uh,"PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor").ma().na(()=>new Uh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.EditorPane.IEditorPane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointIdeasIsEnabled)))}init(){this.K&&this.K.resolve("Common.IAppSettingsManager").ff(()=>{var da=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
xa.Mal(da)&&this.K.resolve("PowerPointWebEditor.EditorPane.Messaging.IMessenger").initialize()&&(da=this.K.resolve("PowerPointWebEditor.EditorPane.EditorPaneActor"),da.ub(),da.xe(),da=this.K.resolve("PowerPointWebEditor.EditorPane.DexLitePaneActor"),da.ub(),da.xe())})}dispose(){}SAi(){const da=new Ph.a;da.$(0,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.UnsupportedMessageProcessor"));da.$(1,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SubscribeProcessor"));
da.$(3,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.CheckProofingDirtyAndGetCritiquesProcessor"));da.$(4,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.VisualizeProcessor"));da.$(5,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.ResolveProcessor"));da.$(6,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.IgnoreProcessor"));da.$(7,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenProofingSettingsProcessor"));da.$(9,
this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.NumberOfCoAuthorsProcessor"));da.$(10,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.SupportedLanguagesProcessor"));da.$(11,this.K.resolve("PowerPointWebEditor.EditorPane.MessageProcessing.OpenIdeasPaneAndCloseEditorPaneProcessor"));return da}static main(){v.a.instance.Bc(new xa)}static Mal(da){return da.pptEditorConsistencyCheckIsEnabled&&xa.GEj(da.R7g)}static bHj(da){return da.zYf}static GEj(da){return!!da&&0<da.length}}
Object(h.a)(xa,"PptWebEditorEditorPanePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.ContentUpdateDetection");Type.registerNamespace("PowerPointWebEditor.EditorPane");Type.registerNamespace("PowerPointWebEditor.EditorPane.MessageProcessing");Type.registerNamespace("PowerPointWebEditor.EditorPane.Messaging");Type.registerNamespace("PowerPointWebEditor.EditorPane.Model");Type.registerNamespace("PowerPointWebEditor.EditorPane.Subscription");
Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.TextPrediction");Mb.main();bc.main();Qc.main();xa.main()},669:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(17),e=d(95),m=d(27),r=d(48);d(96);class v{constructor(){this.OZ=null}get Kub(){return!1}Gzh(A,w){let y=new h.a;const u=new r.GraphTransaction(3);try{u.gd(m.App.Hb.Hd.nn.vg),this.A6b(w)&&(y=this.k4b(w,y)),w!==A&&this.A6b(A)&&(y=this.k4b(A,y))}finally{u&&u.dispose()}return y.toArray()}A6b(A){return!!A}yed(A){let w=
!1;for(const y of this.M6d)w||!Sys.UI.DomElement.containsCssClass(A,y.className)&&!Sys.UI.DomElement.containsCssClass(A,y.v2b)||(w=!0),e.a.sIa(A,y.className),e.a.sIa(A,y.v2b)}}Object(J.a)(v,"AHighlightActor",null,[837])},670:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.className=e;this.v2b=m}}Object(J.a)(h,"HighlightCssClassPair",null,[])},671:function(J,V,d){d.d(V,"b",function(){return r});d.d(V,"a",function(){return v});var h=d(95);d(27);var e=d(48);d(31);
d(91);var m=d(96);const r=A=>{const w=new e.GraphTransaction(3);try{w.gd(A),A.kv(32,!0)}finally{w&&w.dispose()}},v=A=>{if(A){A=h.a.Iia(A);if(-1===A.indexOf(m.a.h7)&&-1!==A.indexOf(m.a.MM)&&-1===A.indexOf(m.a.bYb))return 2;if(-1===A.indexOf(m.a.h7)&&(-1!==A.indexOf(m.a.aYb)||-1!==A.indexOf(m.a.aN)||-1!==A.indexOf(m.a.bYb)||-1!==A.indexOf(m.a.xFc)||-1!==A.indexOf(m.a.iHc)||-1!==A.indexOf(m.a.gHc)||-1!==A.indexOf(m.a.fHc)||-1!==A.indexOf(m.a.gSd)||-1!==A.indexOf(m.a.bSd)||-1!==A.indexOf(m.a.dSd)||-1!==
A.indexOf(m.a.hHc)||-1!==A.indexOf(m.a.aSd)))return 1;if(-1!==A.indexOf("WACImageContainer"))return 3}return 0}},672:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.type=this.action=0;this.Qeb=this.sca=null}}Object(J.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.augloop.js.map