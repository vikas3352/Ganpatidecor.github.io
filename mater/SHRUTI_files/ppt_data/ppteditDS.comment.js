'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1207:function(J,V,d){d.r(V);var h=d(0),e=d(25),m=d(376),r=d(17),v=d(22);class A{}A.beginDraftingAsync="OSC:BDA";A.OVi="OSC:FEQ";A.selectComment="OSC:SC";Object(h.a)(A,"CommentTaskNames",null,[]);class w{constructor(W){this.qFa=W;this.E2j=[]}get handler(){return this.qFa}get r7(){return this.E2j}}Object(h.a)(w,"RegisteredListener",null,[]);class y{constructor(W,xa){this.type=0;this.payload=null;this.type=W;this.payload=
xa}}Object(h.a)(y,"OfficeSharedCommentsEvent",null,[1481]);class u{constructor(){this.eventType=0;this.newViewContainer=null;this.viewContainerVisibilityState=1}}Object(h.a)(u,"ViewContainerEvent",null,[1481]);var D=d(654);class F{constructor(W){this.ele=!1;this.eX=new r.a;this.yb=W}vNk(W){W=new w(W);this.eX.add(W)}mCh(W){for(let xa=0;xa<this.eX.count;++xa)if(this.eX.ga(xa).handler===W){this.eX.removeAt(xa);break}}fna(W=!1){const xa=()=>{if(e.AFrameworkApplication.Vg)m.ULS.sendTraceTag(40420181,201,
50,"Skipped processing comment pane events since app is shutting down.");else for(let Ua=0;Ua<this.eX.count;++Ua){const cb=this.eX.ga(Ua);for(;0<cb.r7.length;){var da=Array.dequeue(cb.r7);if(Object(v.a)(u,da)){var Fa=cb.handler;Fa(da)}else Object(v.a)(y,da)&&(Fa=cb.handler,Fa(da.type,da.payload))}}};W?xa():this.ele||(this.ele=!0,D.a.cob(this.yb,()=>{xa();this.ele=!1},A.OVi))}}Object(h.a)(F,"GenericEventHost",null,[]);class I extends F{constructor(W){super(W)}LOk(W){this.vNk(W)}Kul(W){this.mCh(W)}Zoh(W){W=
this.Byi(W);for(let xa=0;xa<this.eX.count;++xa)Array.enqueue(this.eX.ga(xa).r7,W);this.fna(!0)}Byi(W){const xa=new u;xa.eventType=3;xa.viewContainerVisibilityState=W;return xa}ZVi(){const W=this.ZDi();for(let xa=0;xa<this.eX.count;++xa)Array.enqueue(this.eX.ga(xa).r7,W);this.fna(!0)}ZDi(){const W=new u;W.eventType=2;return W}}Object(h.a)(I,"ViewContainerEventHost",F,[1461]);class H{constructor(){this.numberOfThreads=this.numberOfComments=0;this.contextDetails=this.changes=this.commentId=this.comment=
this.comments=null;this.virtualized=!1;this.index=0;this.tempId=this.threadIds=null;this.errorType=0;this.tasks=null;this.richTextCapabilityFlags=this.modelCapabilityFlags=0;this.rehydrationDrafts=this.contextDrafts=this.smartReplies=null}}Object(h.a)(H,"BasicEventPayload",null,[1528]);class L{constructor(W){this.nextPopulatedContextDetails=0;this.commentThreadCounts=null;this.isReadOnly=!1;this.isReadOnly=W}}Object(h.a)(L,"CommentContextDetails",null,[]);class E{constructor(){this.numberOfThreads=
this.numberOfComments=0;this.contextDetails=null;this.selectedThreadIndex=0;this.virtualized=!1;this.rehydrationDrafts=this.contextDrafts=null}}Object(h.a)(E,"ContextChangeWithSelectedThreadIndex",null,[1528]);class aa{constructor(){this.tasks=this.comments=null}}Object(h.a)(aa,"LoadCommentsNoVirtualization",null,[1528]);class Q extends F{constructor(W){super(W);this.gWh=0}ONk(W,xa,da,Fa,Ua,cb,Jb=0){W=new w(W);cb&&Array.enqueue(W.r7,this.kyi(cb,this.gWh));cb=xa?xa.length:0;Array.enqueue(W.r7,this.VTf(cb,
da,Fa,Jb,null));cb&&Array.enqueue(W.r7,this.HUf(xa,Ua));this.eX.add(W);this.fna()}qCh(W){this.mCh(W)}IJe(W,xa,da,Fa=0,Ua=null){this.bSa(this.VTf(W,xa,da,Fa,Ua));this.fna()}P0k(W,xa,da,Fa,Ua=null){this.bSa(this.Fyi(W,xa,da,Fa,Ua));this.fna()}Clh(W,xa,da){this.bSa(this.Iyi(W,xa,da));this.fna()}NJe(W,xa){this.bSa(this.HUf(W,xa));this.fna()}selectComment(W){this.bSa(this.nVf(W,6));this.fna()}highlightComment(W){this.bSa(this.nVf(W,7));this.fna()}WZa(W,xa){this.bSa(this.bBi(W,xa));this.fna()}czk(W,xa){this.bSa(this.hDi(W,
xa));this.fna()}kyi(W,xa=0){const da=new H;da.modelCapabilityFlags=W;da.richTextCapabilityFlags=xa;return new y(12,da)}VTf(W,xa,da,Fa,Ua=null){const cb=new H;cb.numberOfComments=W;cb.numberOfThreads=xa;cb.contextDetails=Object.assign(new L(da),{nextPopulatedContextDetails:Fa});cb.contextDrafts=Ua;cb.rehydrationDrafts=null;return new y(0,cb)}Fyi(W,xa,da,Fa,Ua=null){const cb=new E;cb.numberOfComments=W;cb.numberOfThreads=xa;cb.selectedThreadIndex=da;cb.contextDetails=Object.assign(new L(Fa),{nextPopulatedContextDetails:0});
cb.contextDrafts=Ua;cb.rehydrationDrafts=null;return new y(0,cb)}Iyi(W,xa,da){const Fa=new H;Fa.comments=W;Fa.numberOfThreads=xa;Fa.tasks=da;return new y(2,Fa)}HUf(W,xa){const da=new aa;da.comments=W;da.tasks=xa;return new y(1,da)}nVf(W,xa){const da=new H;da.commentId="";W&&(da.commentId=W);return new y(xa,da)}bBi(W,xa){const da=new H;da.changes=[];da.contextDetails=Object.assign(new L(xa),{nextPopulatedContextDetails:W});return new y(10,da)}hDi(W,xa){const da=new H;da.commentId=W;da.smartReplies=
xa;return new y(15,da)}bSa(W){for(let xa=0;xa<this.eX.count;++xa)Array.enqueue(this.eX.ga(xa).r7,W)}}Object(h.a)(Q,"OfficeSharedCommentsEventHost",F,[1520]);var O=d(1165);class T{constructor(){this.vwf=this.qyf=!1;this.rZh=[]}get XJb(){return this.rZh}get Rhb(){return this.qyf}set Rhb(W){this.qyf=W;for(const xa of this.XJb)xa.Rhb=W}get Mgb(){return this.vwf}set Mgb(W){this.vwf=W;for(const xa of this.XJb)xa.Mgb=W}eKa(W){for(const xa of this.XJb)W=xa.eKa(W);return W}}Object(h.a)(T,"AggregateCommentTaskPersonTransformer",
null,[1548]);var K=d(106);class X{constructor(W,xa,da,Fa,Ua=!1){this.priority=this.completion=-1;this.type=W;this.user=xa;this.time=da;this.recordId=Fa;this.isLossy=Ua}}Object(h.a)(X,"HistoryRecord",null,[]);class P{constructor(W,xa){this.zRh=new O.a(()=>xa.eKa(W.value))}o3i(){return new Date}kBa(W,xa,da){if(0===W)throw m.ULS.sendTraceTag(594650201,327,10,"CreateBlankHistoryRecord: we do not expect user to be able to create a record of type Unknown in the browser."),Error.argument("recordType");const Fa=
K.a.create().toString();da=new X(W,this.zRh.value,da,Fa,!1);da.commentId=xa;m.ULS.sendTraceTag(42796192,327,50,"History Record Generated. [RecordType: {0}]",W);return da}}Object(h.a)(P,"HistoryRecordFactory",null,[1549]);class ea{constructor(){this.endDate=this.startDate=null}}Object(h.a)(ea,"CommentTaskSchedule",null,[]);class ia{constructor(W,xa,da,Fa,Ua,cb){this.isLossy=W;this.title=xa;this.assignees=da;this.schedule=Fa;this.completion=Ua;this.priority=cb}}Object(h.a)(ia,"CommentTaskState",null,
[]);class ja{constructor(){this.commentId=null}}Object(h.a)(ja,"HistoryItem",null,[]);class C{constructor(W,xa,da,Fa,Ua,cb,Jb){this.rwd=!1;if(1!==xa.type)throw Error.argument("createRecord");this.RMb=da;this.OMb=Fa;this.PMb=Ua;this.khf=1;this.Wtc=W;this.SSh=cb;this._state=new ia(!1,this.RMb,Jb,new ea,this.PMb,this.OMb);this._history=[];this.SUf(xa)}Uqb(W,xa){if(1!==W.type)throw Error.argument("createRecordTemplate");const da=C.$gj(W,this.khf);this.khf++;return Object.assign(new X(xa,W.user,W.time,
da),{commentId:W.commentId})}get yBg(){return this.history[this.history.length-1]}get ilg(){return this.state.completion===this.PMb}get hlg(){return this.state.priority===this.OMb}get jlg(){return(void 0===this.state.schedule.startDate||null===this.state.schedule.startDate)&&(void 0===this.state.schedule.endDate||null===this.state.schedule.endDate)}get klg(){return this.state.title===this.RMb}SUf(W){W=Object.assign(new ja,{commentId:W.commentId,records:[W]});this.history.push(W)}R8f(W){let xa=-1;
for(let da=0;da<this.state.assignees.length;da++)if(this.Wtc.equals(this.state.assignees[da],W)){xa=da;break}return xa}v$k(W){const xa=this.yBg,da=xa.records[xa.records.length-1];return this.Wtc.equals(da.user,W.user)&&xa.commentId===W.commentId&&da.time.getTime()===W.time.getTime()?!0:!1}rzl(W){switch(W.type){case 2:-1===this.R8f(W.assignee)&&this.state.assignees.push(W.assignee);break;case 3:const xa=this.R8f(W.assignee);0<=xa&&this.state.assignees.splice(xa,1);break;case 4:Array.clear(this.state.assignees);
break;case 5:this.state.schedule=W.schedule;break;case 6:this.state.completion=W.completion;break;case 9:this.state.title=W.title;break;case 10:this.state.priority=W.priority;break;case 0:this.state.isLossy=!0;break;case 1:m.ULS.sendTraceTag(595198540,327,10,"Create record passed for state evaluation");break;case 7:this.rwd=!0;break;case 8:this.rwd=!1;break;case -1:m.ULS.sendTraceTag(51139905,327,10,"Undo record passed for state evaluation");break;default:this.state.isLossy=!0}W.isLossy&&(this.state.isLossy=
!0);this.v$k(W)?this.yBg.records.push(W):this.SUf(W)}get isDeleted(){return this.rwd}get state(){return this._state}get history(){return this._history}H6i(W){if(!W)return this.history;const xa=Array.clone(this.history),da=xa[0],Fa=da.records.shift();if(!this.SSh){var Ua=this.Uqb(Fa,4);da.records.unshift(Ua)}!W.ilg&&this.ilg&&(Ua=this.Uqb(Fa,6),Ua.completion=this.PMb,da.records.unshift(Ua));!W.hlg&&this.hlg&&(Ua=this.Uqb(Fa,10),Ua.priority=this.OMb,da.records.unshift(Ua));!W.jlg&&this.jlg&&(Ua=this.Uqb(Fa,
5),Ua.schedule=new ea,da.records.unshift(Ua));!W.klg&&this.klg&&(Ua=this.Uqb(Fa,9),Ua.title=this.RMb,da.records.unshift(Ua));W.isDeleted&&(W=this.Uqb(Fa,8),da.records.unshift(W));return xa}static $gj(W,xa){return"Synthesized-"+W.recordId+"-"+xa}}Object(h.a)(C,"CommentTaskStateBuilder",null,[]);var pa=d(703);class Z{constructor(W,xa,da,Fa){this.id=W;this.commentId=xa;this.currentState=da;this.history=Fa}}Object(h.a)(Z,"CommentTaskItem",null,[]);class qa{constructor(W,xa="",da="",Fa=""){this.IsCurrentUser=
!1;this.UserId=W;this.Provider=xa;this.DisplayName=da;this.Email=Fa}}Object(h.a)(qa,"CommentTaskPerson",null,[1543]);const ya=W=>{const xa=new qa(W.UserId,W.Provider,W.DisplayName,W.Email);xa.IsCurrentUser=W.IsCurrentUser;return xa};var Ka=d(989);d(283);class Da{constructor(W){this.extensions=W}}Object(h.a)(Da,"ExtensionList",null,[]);class la{static clone(W){W=la.lqi(W.extensions);return new Da(W)}static wQf(W){return W?la.clone(W):null}static isEmpty(W){return!W.extensions||!W.extensions.count}static Va(W){return!W||
la.isEmpty(W)}static lqi(W){if(!W)return null;const xa=new Ka.a;W.forEach((da,Fa)=>{xa.add(da,Fa);return!0});return xa}}Object(h.a)(la,"ExtensionListExtensions",null,[]);class ma{static clone(W){var xa=ya(W.user);xa=new X(W.type,xa,W.time,W.recordId,W.isLossy);xa.commentId=W.commentId;xa.anchorExtensionList=la.wQf(W.anchorExtensionList);xa.recordExtensionList=la.wQf(W.recordExtensionList);W.assignee&&(xa.assignee=ya(W.assignee));if(W.schedule){var da=W.schedule;const Fa=new ea;Fa.startDate=da.startDate;
Fa.endDate=da.endDate;xa.schedule=Fa}xa.completion=W.completion;xa.title=W.title;xa.priority=W.priority;xa.undoId=W.undoId;return xa}}Object(h.a)(ma,"HistoryRecordExtensions",null,[]);class Ea{constructor(W,xa,da,Fa,Ua,cb,Jb,Gc=!1){this.Wtc=W;this.cxc=xa;this.kpa=da;this.CLh=Fa;this.RMb=Ua;this.OMb=cb;this.PMb=Jb;this.Huc=Gc}FDi(W,xa,da,Fa=null){if(!W)throw m.ULS.sendTraceTag(42796181,327,10,"taskId cannot be null."),Error.argumentNull("taskId");if(!xa)throw m.ULS.sendTraceTag(42796182,327,10,"parentCommentId cannot be null."),
Error.argumentNull("parentCommentId");if(!da||!da.length)throw m.ULS.sendTraceTag(42796183,327,10,"records cannot be null or empty."),Error.argumentNull("records");if(1!==da[0].type)throw m.ULS.sendTraceTag(42796184,327,10,"First record must be a Create record."),Error.argument("First record must be a Create record.");var Ua=[],cb=null,Jb=this.SDk(da);for(var Gc of da)if(!Jb.contains(Gc.recordId))if(da=this.Chg(Gc.commentId,Fa),da=this.aZi(Gc,da),1===da.type){let Ld=[];this.Huc&&cb&&cb.state&&(Ld=
cb.state.assignees);cb=new C(this.Wtc,da,this.RMb,this.OMb,this.PMb,this.Huc,Ld);Ua.push(cb)}else if(cb)cb.rzl(da);else throw m.ULS.sendTraceTag(595198539,327,10,"Undo resulted in ignoring of Task creation without also ignoring records after the create record."),Error.argument("Undo resulted in ignoring of Task creation without also ignoring records after the create record.");Jb=null;Gc=[];if(cb){cb.isDeleted||(Jb=cb.state);cb=null;for(var pd of Ua)Ua=pd.H6i(cb),Array.addRange(Gc,Ua),cb=pd}pd=this.Chg(xa,
Fa);Jb&&(Jb.completion=this.Gsi(xa,Fa,Jb.completion));return new Z(W,pd,Jb,Gc)}xYi(W,xa,da,Fa=null){if(!xa)throw m.ULS.sendTraceTag(42796185,327,10,"update cannot be null."),Error.argumentNull("update");if(da&&!W)throw m.ULS.sendTraceTag(42796187,327,10,"CommentId must be specified for task creation."),Error.argument("commentId");const Ua=[],cb=this.kpa.o3i();if(da){var Jb=this.kpa.kBa(1,W,cb);Ua.push(Jb)}Jb=null;if(xa.assigneeUpdate){if(!xa.assigneeUpdate.assigneesToAdd||!xa.assigneeUpdate.assigneesToRemove)throw m.ULS.sendTraceTag(536999254,
327,15,"Invalid AssigneeUpdate."),Error.argument("Schedule","Invalid AssigneeUpdate.");for(var Gc=0;Gc<xa.assigneeUpdate.assigneesToAdd.length;Gc++){var pd=this.TUf(2,xa.assigneeUpdate.assigneesToAdd[Gc],W,cb);pd&&Ua.push(pd)}for(Gc=0;Gc<xa.assigneeUpdate.assigneesToRemove.length;Gc++)(pd=this.TUf(3,xa.assigneeUpdate.assigneesToRemove[Gc],W,cb))&&Ua.push(pd)}else xa.assignee&&(da||(Jb=this.kpa.kBa(4,W,cb),Ua.push(Jb)),Gc=this.kpa.kBa(2,W,cb),Jb=this.cxc.eKa(xa.assignee),Gc.assignee=Jb,Ua.push(Gc));
xa.title?(Fa=this.kpa.kBa(9,W,cb),Fa.title=xa.title,Ua.push(Fa)):da&&Fa&&(Gc=this.kpa.kBa(9,W,cb),Gc.title=this.CLh.Jij(Fa,Jb),Ua.push(Gc));if(xa.schedule){if(xa.schedule.startDate>xa.schedule.endDate)throw m.ULS.sendTraceTag(42796188,327,10,"Invalid schedule."),Error.argument("Schedule","Invalid schedule.");Fa=this.kpa.kBa(5,W,cb);Fa.schedule=xa.schedule;Ua.push(Fa)}if(void 0!==xa.completion&&null!==xa.completion){Fa=xa.completion;if(0>Fa||100<Fa)throw m.ULS.sendTraceTag(42796189,327,10,"Invalid completion state."),
Error.argumentOutOfRange("completion");da||m.ULS.sendTraceTag(595198538,327,50,"Task progress change. [Progress: {0}]",Fa);da=this.kpa.kBa(6,W,cb);da.completion=Fa;Ua.push(da)}if(void 0!==xa.priority&&null!==xa.priority){xa=xa.priority;if(0>xa||10<xa)throw m.ULS.sendTraceTag(42796190,327,10,"Invalid priority state."),Error.argumentOutOfRange("priority");W=this.kpa.kBa(10,W,cb);W.priority=xa;Ua.push(W)}return Ua}TUf(W,xa,da,Fa){if(2!==W&&3!==W)return m.ULS.sendTraceTag(0,327,10,"Assignee field should only be used for an Assign or Unassign HistoryRecord."),
null;W=this.kpa.kBa(W,da,Fa);W.assignee=this.cxc.eKa(xa);return W}SDk(W){const xa=new pa.a,da=new pa.a;for(let Fa=W.length-1;0<=Fa;Fa--){const Ua=W[Fa],cb=da.contains(Ua.recordId);cb||-1!==Ua.type||(da.contains(Ua.undoId)?m.ULS.sendTraceTag(578670598,327,50,"Multiple Undo records attempting to undo the same record."):da.add(Ua.undoId));if(cb||-1===Ua.type)xa.contains(Ua.recordId)?m.ULS.sendTraceTag(578670599,327,50,"Record was already added to records to ignore. There must be multiple records with same ID."):
xa.add(Ua.recordId)}return xa}aZi(W,xa){const da=ma.clone(W);da.commentId=xa;da.user=this.cxc.eKa(W.user);da.assignee=this.cxc.eKa(W.assignee);return da}Gsi(W,xa,da){let Fa=da;W&&xa&&(({value:xa}=xa.Rf(W)).returnValue?(Fa=xa.ResolveState?100:100===da?0:da,Fa!==da&&m.ULS.sendTraceTag(592719873,327,50,"Task completion state has been changed to match comment resolution state for comment {0}",W)):m.ULS.sendTraceTag(592719874,327,50,"Comment {0} not found in translation map. Completion unchanged",W));
return Fa}Chg(W,xa){let da=W;W&&xa&&(({value:xa}=xa.Rf(W)).returnValue?da=xa.CommentId:(m.ULS.sendTraceTag(42796191,327,50,"Id not found in translation map. Possible Orphan task candidate [CommentId: {0}]",W),da=W));return da}}Object(h.a)(Ea,"CommentTaskTranslatorImpl",null,[1061]);class ta{constructor(){this.j0a={};this.j0a.ops=[]}XBj(W){const xa=this.j0a.ops;if(xa.length){var da=xa.length-1;const Fa=xa[da];if(!Fa.attributes){Fa.insert+=W;xa[da]=Fa;this.j0a.ops=xa;return}}da={};da.insert=W;Array.add(xa,
da)}rBj(W,xa,da){var Fa={};Fa.fullName=xa.fullName;Fa.email=xa.email;Fa.resolveState=xa.resolveState;xa={};xa.atmention=Fa;W=this.rRd(W,xa);da&&(Fa={},Fa.contentId=da.contentId,da={},da.atmention=Fa,W.optional=da);Array.add(this.j0a.ops,W)}insertImage(W,xa){W=this.rRd(W,{});const da={};da.base64=xa.base64;xa={};xa.image=da;W.optional=xa;Array.add(this.j0a.ops,W)}insertHyperLink(W,xa){const da={};da.link=xa.link;this.P6k(da,xa);Array.add(this.j0a.ops,this.rRd(W,da))}P3i(){return Sys.Serialization.JavaScriptSerializer.serialize(this.j0a)}rRd(W,
xa){const da={};da.insert=W;da.attributes=xa;return da}P6k(W,xa){this.Bgb(xa.weight>=ta.jfk,W,"weight",xa.weight);this.Bgb(xa.italic,W,"italic",!0);this.Bgb(xa.underline,W,"underline",!0);this.Bgb(xa.strikethrough,W,"strikethrough",!0);this.Bgb(!!xa.highlight,W,"highlight",xa.highlight);this.Bgb(!!xa.color,W,"color",xa.color);this.Bgb(!!xa.paragraph,W,"paragraph",xa.paragraph)}Bgb(W,xa,da,Fa){W&&(xa[da]=Fa)}static aag(W){return Sys.Serialization.JavaScriptSerializer.deserialize(W,!0)}}ta.jfk=700;
Object(h.a)(ta,"DeltaFormatCreator",null,[1513]);var Ga=d(520),oa=d(1113);class sa{constructor(){this.ellipsis=CommonUIStrings.l_Ellipsis}Jij(W,xa){if(!W)throw m.ULS.sendTraceTag(592998807,327,10,"Missing commentRichText"),Error.argumentNull("commentRichText");try{var da=ta.aag(W)}catch(pd){throw m.ULS.sendTraceTag(592998806,327,10,"commentRichText not in Delta Format"),Error.format("Improperly formatted Delta text in commentRichText");}var Fa=W=0,Ua=0;const cb=RegExp("\\s+","g"),Jb=new Sys.StringBuilder;
for(var Gc of da.ops)Gc.attributes&&Gc.attributes.atmention&&Gc.attributes.atmention.email&&xa&&(da=Gc.attributes.atmention.email,0<da.length&&(da===xa.UserId||da===xa.Email||da===Ga.a.Z5a(xa.UserId))&&(Fa=W,Ua=Fa+Gc.insert.length)),da=Gc.insert.replace(cb," "),W+=da.length,Jb.append(da);!Ua&&xa&&m.ULS.sendTraceTag(592998805,327,10,"Assignee was not found in comment text",xa.Provider);xa=Jb.toString().trimEnd();W=xa.length;255<W?(Gc=(255-(Ua-Fa))/2,0>Fa-Gc?(W=oa.a.instance.LZd(xa,255-this.ellipsis.length),
Ua=xa.substring(0,W)+this.ellipsis,W="Trimmed End"):Ua+Gc>W?(Fa=oa.a.instance.yNc(xa,W-255+this.ellipsis.length),Ua=this.ellipsis+xa.substring(Fa,W),W="Trimmed Start"):(Fa=oa.a.instance.yNc(xa,Fa-Gc+this.ellipsis.length),W=oa.a.instance.LZd(xa,Ua+Gc-this.ellipsis.length),Ua=this.ellipsis+xa.substring(Fa,W)+this.ellipsis,W="Trimmed Both")):(W="No Trim",Ua=xa);m.ULS.sendTraceTag(592998804,327,50,W);return Ua}}Object(h.a)(sa,"ContentExtractor",null,[]);class Ha{constructor(W,xa){this.iPh=W;this.ARh=
xa;this.Mgb=this.Rhb=!1}eKa(W){if(!W)return null;if(void 0===W.UserId||null===W.UserId)throw m.ULS.sendTraceTag(593368219,327,10,"Unexpected user missing UserId field"),Error.argumentType();if(W.IsCurrentUser||!this.iPh.equals(this.ARh.value,W))return W;W=ya(W);W.IsCurrentUser=!0;return W}}Object(h.a)(Ha,"EnsureIsCurrentUserSetTransformer",null,[1548]);class bb{constructor(){this.Mgb=this.Rhb=!1}eKa(W){if(!W)return null;if(void 0===W.UserId||null===W.UserId)return W;if(!W.Email||""===W.Email){let xa;
if(xa=Ga.a.Z5a(W.UserId))return W=ya(W),W.Email=xa,W}return W}}Object(h.a)(bb,"RestoreEmailTransformer",null,[1548]);class Ya{constructor(){this.Mgb=this.Rhb=!1}eKa(W){if(!W)return null;if(void 0!==W.UserId&&null!==W.UserId)return W;switch(this.Rhb?this.Mgb?2:1:0){case 0:if(void 0===W.UserId||null===W.UserId)throw m.ULS.sendTraceTag(593368215,327,10,"assignee missing UserId"),Error.argument("assignee.UserId");W=ya(W);break;case 1:if(void 0===W.Id||null===W.Id)throw m.ULS.sendTraceTag(593368214,327,
10,"assignee missing Id"),Error.argument("assignee.Id");if(void 0===W.Email||null===W.Email)throw m.ULS.sendTraceTag(593368213,327,10,"assignee missing Email"),Error.argument("assignee.Email");var xa=Ya.F5g(W.Id,W.Email,null);if(!xa||""===xa)throw m.ULS.sendTraceTag(593368212,327,10,"Failed to generate UserId"),Error.argument("UserId");var da=e.AFrameworkApplication.fa.Ga("HostAuthType")||"";if("aad"!==da.toLowerCase()||xa.startsWith("S::")){if("msa"===da.toLowerCase())throw m.ULS.sendTraceTag(593368210,
327,10,"Unexpected IPersonObject in MSA Environment"),Error.argument("CommentTaskUserType");m.ULS.sendTraceTag(593368209,327,50,"Receiving IPersonObject with AuthType {0}",da)}else throw m.ULS.sendTraceTag(593368211,327,10,"Unexpected UserID format"),Error.argument("userId");W=new qa(xa,"AD",W.DisplayName,W.Email);break;case 2:if(void 0===W.UserPrincipalName||null===W.UserPrincipalName)throw m.ULS.sendTraceTag(593368208,327,10,"assignee missing UserPrincipalName"),Error.argument("assignee.UserPrincipalName");
if(void 0!==W.SuggestionSubtype&&null!==W.SuggestionSubtype)if("OrganizationUser"===W.SuggestionSubtype)xa="AD";else throw m.ULS.sendTraceTag(593368207,327,10,"Unexpected LPP SuggestionSubtype : {0}",W.SuggestionSubtype),Error.argument("assignee.SuggestionSubtype");else throw m.ULS.sendTraceTag(593368206,327,10,"Missing SuggestionSubtype"),Error.argument("assignee.SuggestionSubtype");da=Ya.F5g(W.Id,W.UserPrincipalName,W.AadObjectId);if(!da||""===da)throw m.ULS.sendTraceTag(593368205,327,10,"Failed to generate UserId"),
Error.argument("UserId");if("AD"===xa&&!da.startsWith("S::"))throw m.ULS.sendTraceTag(593368204,327,10,"Unexpected UserID and Provider combination"),Error.argument("userId");W=new qa(da,xa,W.Name,W.UserPrincipalName);break;default:throw m.ULS.sendTraceTag(593368203,327,10,"Unexpected UserType"),Error.argument("assignee.UserType");}return W}static F5g(W,xa,da){if(!xa||""===xa)return m.ULS.sendTraceTag(593368218,327,50,"Missing UPN"),W;if(da&&""!==da)return"S::"+xa+"::"+da;if(!W||""===W)return m.ULS.sendTraceTag(593368217,
327,50,"Missing ID"),W;if(W.startsWith("S::"))return W;if(-1!==W.indexOf("@")){da=W.split("@");if(K.a.isValid(da[0]))return"S::"+xa+"::"+da[0];m.ULS.sendTraceTag(593368216,327,50,"ID is not in AadObjectId@TenantId format")}return W}}Object(h.a)(Ya,"UserIdCanonicalizationTransformer",null,[1548]);class ua{constructor(W,xa,da=!1,Fa=!1){this.jNh=W;this.PZe=xa;this.TRh=da;this.Huc=Fa}zyi(){const W=new Ga.a;var xa=new O.a(ua.c3i);const da=new T;this.PZe&&(da.XJb.push(new Ya),da.XJb.push(new bb));this.jNh&&
da.XJb.push(new Ha(W,xa));da.Rhb=this.PZe;da.Mgb=this.TRh;xa=new P(xa,da);const Fa=new sa;return new Ea(W,da,xa,Fa,ua.jGi,ua.WFi,ua.XFi,this.Huc)}static c3i(){const W=new qa(e.AFrameworkApplication.fa.Ga("PresenceUserId")||"",e.AFrameworkApplication.fa.Ga("PresenceProvider")||"",e.AFrameworkApplication.userName||"");W.IsCurrentUser=!0;return W}}ua.jGi="";ua.WFi=5;ua.XFi=0;Object(h.a)(ua,"CommentTaskTranslatorFactory",null,[1542]);class Ma{constructor(){this.MDd=this.WXe=!1;this.dnb=this.nt=this.T7e=
this.mff=this.kBf=this.gjf=this.Pyf=this.U_e=this.Jv=this.bSb=null}initialize(W,xa,da,Fa=null,Ua=null,cb=null,Jb=null,Gc=null,pd=null,Ld=null){this.Jv=W;this.U_e=xa;this.Pyf=da;this.gjf=Fa;this.kBf=Ua;this.mff=cb;this.T7e=Jb;this.nt=Gc;this.WXe=!0;this.dnb=pd;this.bSb=Ld}f4b(W=null,xa=null){if(!this.WXe)return m.ULS.sendTraceTag(41424203,201,10,"InstantiateSharedComments called before activation manager initialization."),new Promise((da,Fa)=>{Fa(D.a.mu(-2130915313))});if(this.MDd)return m.ULS.sendTraceTag(41424204,
201,10,"InstantiateSharedComments called after shared comments was already instantiated."),new Promise(()=>{});this.bSb||(e.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?this.bSb=appResourceLoader.loadChunk("sharedComments"):this.bSb=this.Jv.loadScript("sharedComments"));return this.bSb.then(()=>{W&&W();this.MDd||(this.dnb&&this.dnb.execute(da=>{da.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}),xa&&xa(),sharedComments.instantiate(this.U_e,
this.Pyf,this.gjf,this.kBf,this.mff,this.T7e,this.nt));this.MDd=!0})}}Object(h.a)(Ma,"CommentActivationManager",null,[1544]);var Ca=d(13);class Va{constructor(){this.actionBehavior=this.actionType=0}}Object(h.a)(Va,"CommentUIActionPayload",null,[]);var Za=d(257);class Db{constructor(W,xa){this.Ca=W;this.v_a=xa;this.Mpd=new Za.a;for(let da of this.v_a)this.Mpd.$(da.value.canvasActionId,da.key),W=da.value,W.delayActionsUntilRegistration||this.ya(W)}ya(W){W.withFlags?this.Ca.pa(W.canvasActionId,W.canvasContextId,
Object(Ca.a)(this,this.BTb,"actionHandler"),97):this.Ca.ya(W.canvasActionId,W.canvasContextId,Object(Ca.a)(this,this.BTb,"actionHandler"))}xwa(W,xa){this.v_a.Jb(W)&&(this.v_a.ga(W).delayActionsUntilRegistration&&this.ya(this.v_a.ga(W)),this.v_a.ga(W).registeredCallback=xa)}BTb(W,xa,da,Fa,Ua){if(this.Mpd.Jb(W)){var cb=this.Mpd.ga(W);if(!this.v_a.Jb(cb))return 8;const Jb=this.v_a.ga(cb);if(Jb.preCallback){const Gc=Jb.preCallback(W,xa,da,Fa,Ua);if(2!==Gc)return Gc}if(!Jb.registeredCallback)return 1===
da?8:2;cb=Object.assign(new Va,{actionType:cb});1===da&&(cb.actionBehavior=1);cb=Jb.registeredCallback(cb);return Jb.postCallback?Jb.postCallback(cb,W,xa,da,Fa,Ua):cb?32:8}return 2}}Object(h.a)(Db,"OfficeSharedCommentsActionHost",null,[1522]);var Lb=d(336),yb=d(35),Bc=d(189);class tb{}Object(h.a)(tb,"CommentActivityData",null,[]);var Mb=d(135),Hb=d(70);class vb{constructor(W,xa,da,Fa,Ua,cb,Jb,Gc,pd,Ld=null,de=null){this.CCf={["CancelCommentCreateThreadAction"]:yb.a.Vph,["CommitComment"]:yb.a.Wph,
["CommitDraftAction"]:yb.a.Xph,["CommitDraftCreateAction"]:yb.a.EMe,["CommitDraftEditAction"]:yb.a.GMe,["CommitDraftReplyAction"]:yb.a.DMe,["CreateReplyAction"]:yb.a.DMe,["CreateReplyWithMentions"]:yb.a.Yph,["CreateReplyWithTaskAssigned"]:yb.a.Zph,["CreateThreadAction"]:yb.a.EMe,["CreateThreadWithMentions"]:yb.a.$ph,["CreateThreadWithTaskAssigned"]:yb.a.aqh,["DeletePostAction"]:yb.a.bqh,["DeleteThreadAction"]:yb.a.cqh,["DeleteThreadWithTask"]:yb.a.dqh,["DiscardDraftAsync"]:yb.a.eqh,["PresentLinkToCommentAction"]:yb.a.fqh,
["ResolveThreadAction"]:yb.a.jqh,["ResolveThreadWithTask"]:yb.a.kqh,["ReopenThreadAction"]:yb.a.gqh,["ReopenThreadWithTask"]:yb.a.hqh,["RequestInitCommentSession"]:yb.a.iqh,["SelectCommentAction"]:yb.a.lqh,["UpdateCommentBodyAction"]:yb.a.GMe};this.dataCenter=this.ring=this.sessionId=this.releaseChannel=this.releaseAudience=this.appVersion=this.appName=null;this.disableUpload=!1;this.sovereignEnvironmentName=null;this.appName=W;this.appVersion=xa;this.releaseAudience=da;this.releaseChannel=Fa;this.sessionId=
Ua;this.ring=cb;this.dataCenter=Jb;this.disableUpload=Gc;this.sovereignEnvironmentName=de;this.Ca=pd;this.ijf=Ld;this.UAj()}UAj(){this.Ca.ya(yb.a.Vph,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.Wph,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.Xph,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.DMe,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.Yph,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.Zph,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.EMe,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.$ph,
Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.aqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.bqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.cqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.dqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.eqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.fqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.jqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.kqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.gqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.hqh,
Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.iqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.lqh,Hb.a.frame,Bc.ActionManager.Hg);this.Ca.ya(yb.a.GMe,Hb.a.frame,Bc.ActionManager.Hg)}sendULSTrace(W,xa,da,Fa){m.ULS.sendTraceTag(W,xa,da,Fa)}recordActivity(W){this.CCf[W]&&this.Ca.processAction(this.CCf[W],2)}sendOtelEvent(W){Mb.a.sendOtelEvent(W)}recordPerfData(W,xa){this.ijf&&(W=Object.assign(new tb,{durationMs:xa,name:W}),this.ijf.Fma(W))}}Object(h.a)(vb,"OfficeSharedCommentsTelemetry",null,[]);
var Xb=d(268);class Uc{constructor(W,xa,da,Fa){this.isRightToLeft=!1;this.dataCulture=this.uiCulture=this.appLocale=null;this.isRightToLeft=W;this.appLocale=xa;this.uiCulture=da;this.dataCulture=Fa}}Object(h.a)(Uc,"LocalizationDetails",null,[]);var hb=d(287),Zb=d(65),Fc=d(90);class ob{constructor(W,xa){this.s_h=W;this.W3e=xa}getViewContainer(){return this.s_h}registerForViewContainerEvents(W){this.W3e.LOk(W)}unregisterForViewContainerEvents(W){this.W3e.Kul(W)}}Object(h.a)(ob,"ViewContainerProvider",
null,[1460]);var ac=d(68),pb=d(1166),nb=d(33),Tb=d(27),Ub=d(246),hc=d(206),Wb=d(26),fd=d(243),fc=d(626);class bc{static $bg(W){return W===bc.create?0:W===bc.reply?1:W===bc.edit?2:W===bc.metadata?3:null}}bc.create="CREATE";bc.reply="REPLY";bc.edit="EDIT";bc.metadata="METADATA";Object(h.a)(bc,"CommentSessionType",null,[]);class cc{constructor(){this.insertIndex=0;this.author=this.updatedSessionParams=this.anchorHintText=this.authorIdentity=this.authorName=null}}Object(h.a)(cc,"InitCommentSessionResult",
null,[]);class kb extends cc{constructor(){super();this.updatedDraftSessionConfiguration=null}}Object(h.a)(kb,"BeginDraftingHostResult",cc,[]);class ab{constructor(W,xa="",da="",Fa="",Ua=!1){this.Email=this.DisplayName=this.Provider=this.UserId=null;this.IsCurrentUser=!1;this.UserId=W;this.Provider=xa;this.DisplayName=da;this.Email=Fa;this.IsCurrentUser=Ua}}Object(h.a)(ab,"OfficeSharedCommentUser",null,[]);var Pb=d(45),rc=d(55),ic=d(233),md=d(38);class Fd{constructor(W,xa,da){this.Gp=W;this.o2j=xa;
this.x1j=da;this.LHg=null;this.JLg=!1}get GOa(){return this.Gp}get TB(){return this.o2j}get commentId(){return this.x1j}get u7(){return this.LHg}set u7(W){this.LHg=W}get tVc(){return this.JLg}set tVc(W){this.JLg=W}}Object(h.a)(Fd,"ActiveCommentSession",null,[]);var ne=d(667);class ud{static get $dk(){return 50}static f_i(W){return ud.L1i(W)}static fbj(W){if(""===W)return"";let xa=0,da="";try{const Fa=ta.aag(W);for(const Ua of Fa.ops)if(ud.Ksa(Ua))xa||(da+=ud.I5i(Ua.attributes.atmention.fullName)),
xa+=1;else{const cb=Ua.insert?Ua.insert:"";" "!==cb&&0<cb.length&&(xa=0,da+=cb)}}catch(Fa){m.ULS.sendTraceTag(558428681,327,10,"Comment formatString could not be deserialized since it is not in a proper Delta Format.")}return da}static L1i(W){W=ud.fbj(W);return 0<W.length&&W.split(" ").length<=ud.$dk?W:null}static I5i(W){let xa="";W&&(W=W.split(" "),0<W.length&&(xa=W[0]));return xa}static Ksa(W){return!!W.attributes&&!!W.attributes.atmention}}Object(h.a)(ud,"BaseCommentSmartReplyHelpers",null,[]);
class gb{constructor(W){this.jhe=W}SAl(W,xa,da,Fa){-1===da||xa||(xa=Fa[da],da=xa.author?xa.author.IsCurrentUser:!1,xa&&xa.commentBody&&!da&&(xa=ud.f_i(xa.commentBody))&&this.jhe.invoke(W,xa))}}Object(h.a)(gb,"CommentSmartReplyHelpers",null,[]);class Vb{constructor(W,xa,da,Fa,Ua,cb,Jb,Gc,pd,Ld,de,Be,Mf,Dg,yd,td){this.C2c=!1;this.hb=W;this.ZUa=xa;this.vie=da;this.l0j=Fa;this.yb=Ua;this.fc=cb;this.R5c=Jb;this.D1j=Gc;this.Dua=pd;this.jhe=de;this.J2j=Be;this.Vta=Mf;this.B8j=Dg;this.v1j=yd;this.ia=td}beginDraftingAsync(W){if(!W)return new Promise((da,
Fa)=>{Fa(D.a.mu(-2130915327))});const xa=bc.$bg(W.sessionType);return void 0===xa||null===xa?new Promise((da,Fa)=>{Fa(D.a.mu(-2130915317))}):2===xa&&W.commentId===Vb.QCb?new Promise((da,Fa)=>{Fa(D.a.mu(-2130915324))}):new Promise((da,Fa)=>{D.a.cob(this.yb,()=>{var Ua=this.hb.N1d(),cb=null;let Jb=-1;Wb.a.J(512496833,805,50,"CommentAPI::BeginDraftingAsync - SessionType: {0}",xa);try{switch(xa){case 0:if(this.B8j)try{Jb=this.hb.Ubg(!0)}catch(de){Wb.a.J(512496832,801,10,"GetIndexForDraftCommentCardInsertion threw en exception{0}",
de),Jb=Ua.length}else Jb=Ua.length;cb=new Fd(xa,W,"");this.C2c=!0;break;case 1:if(!W.threadId||!W.threadId.length)throw D.a.mu(-2130915324);Jb=Vb.l7i(Ua,W.threadId);if(-1===Jb)throw D.a.mu(-2130915323);if(this.fc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)){var Gc=W.threadId;(new gb(this.jhe)).SAl(Gc,Vb.Ksj(Ua,Gc),Vb.K0d(Ua,Gc),Ua)}cb=new Fd(xa,W,W.threadId);break;case 2:if(!W.commentId||!W.commentId.length)throw D.a.mu(-2130915324);Jb=Vb.K0d(Ua,W.commentId);
if(-1===Jb)throw D.a.mu(-2130915323);cb=new Fd(xa,W,W.commentId);break;case 3:Jb=Vb.K0d(Ua,W.threadId);cb=new Fd(xa,W,W.threadId);break;default:throw D.a.mu(-2130915322);}if(!cb)throw D.a.mu(-2130915322);var pd=this.hb.$xj(cb);if(pd)throw pd;}catch(de){Fa(de);return}Ua=new kb;cb=this.fc.Ga("UserName");pd=this.fc.Ga("387");Gc=this.fc.Ga("388");const Ld=md.a("PPTPlumbEmailThroughCG")?Ga.a.Z5a(pd||""):"";pd=new ab(pd,Gc,cb,Ld,!0);Ua.author=pd;Ua.insertIndex=Jb;Ua.authorName=cb;Ua.authorIdentity=new String;
da(Ua)})})}commit(W,xa,da){if(!this.hb.kHc)throw Wb.a.J(512496803,805,10,"CommentAPI::Commit - CurrentCommentSession is null; CommentSessionEndReason:{0}",this.hb.Vri),D.a.mu(-2130915320);var Fa=this.hb.kHc.TB;if(!Fa)throw Wb.a.J(512496802,805,15,"CommentAPI::Commit - CurrentCommentSession.DraftConfiguration is null"),D.a.mu(-2130915320);const Ua=bc.$bg(Fa.sessionType);if(void 0===Ua||null===Ua)throw D.a.mu(-2130915317);if(W!==Fa.draftId)throw D.a.mu(-2130915327);const cb=this.Vta?ic.e(K.a.create().toString()):
"";this.hb.fZf();switch(Ua){case 0:return Wb.a.J(512496801,805,50,"CommentAPI::Commit - Create Comment {0}",cb),Fa={},this.hb.aUk(cb),Fa.commentId=cb,this.C2c=!1,this.hb.SWg=cb,Vb.Qzh(da),Vb.Pzh(),this.createComment(xa,Fa,da);case 1:return Wb.a.J(512496800,805,50,"CommentAPI::Commit - Create Reply {0}:{1}",Fa.threadId,cb),W={},W.parentId=Fa.threadId,W.commentId=cb,Vb.Qzh(da),Vb.Pzh(),this.createComment(xa,W,da);case 2:return Wb.a.J(512496799,805,50,"CommentAPI::Commit - Edit comment {0}",Fa.commentId),
da={},da.commentBody=xa,this.Mvl(Fa.commentId,da),W;case 3:return Wb.a.J(512496798,805,50,"CommentAPI::Commit - Update Metadata {0}",Fa.threadId),this.Nvl(Fa.threadId,da),Fa.threadId;default:throw D.a.mu(-2130915322);}}endCommentSession(W){Wb.a.J(512496797,805,50,"CommentAPI::EndCommentSession - DraftId: {0}",W);this.hb.endCommentSession(W,this.C2c?9:1);this.C2c=!1}createComment(W,xa,da){const Fa=this.R5c.Emd(W,new Date);let Ua="";this.Vta&&(Ua=Pb.a.Va(xa.commentId)?K.a.create().toString():xa.commentId);
let cb=null;void 0!==da&&null!==da&&(cb=this.R5c.oql(Ua,da.Task,W));W=this.hb.Ogd;if(da=xa.parentId?null:this.hb.Ehj())W=this.hb.u0k;this.ZUa.l1h(Ua,Fa.plainText,xa.parentId,W,this.hb.anchorNode,Fa.NWg,cb,da);return Pb.a.Va(Ua)?Vb.QCb:Ua}deleteComment(W){if(W===Vb.QCb)throw D.a.mu(-2130915327);Wb.a.J(512496796,805,50,"CommentAPI::DeleteComment - {0}",W);this.ZUa.deleteComment(W)}selectComment(W){W!==Vb.QCb&&this.hb.Zea(W,0,!1)}highlightComment(W){W!==Vb.QCb&&this.hb.o0h(W)}SCh(W,xa,da){const Fa=Array.clone(this.hb.N1d());
var Ua=null;for(var cb of Fa)if(cb.commentId===W){Ua=cb;break}if(!Ua)throw Wb.a.J(512496795,805,10,"Comment ID not found, UI and model in a mismatched state."),D.a.mu(-2130915323);(cb=e.AFrameworkApplication.userName)&&0<cb.length&&cb!==Ua.author.DisplayName&&Wb.a.J(512496794,805,50,"Author of comment being edited is not the current user (isAnonymous={0})",e.AFrameworkApplication.$ib||e.AFrameworkApplication.mQ);cb=new Date;Ua=this.R5c.Emd(Ua.commentBody,null).plainText;xa=this.R5c.Emd(xa.commentBody,
cb);this.ZUa.yLi(xa.plainText,W,xa.NWg);da||Ua!==xa.plainText||this.vie.Clh(Fa,this.hb.TXg,Array.clone(this.hb.Bdg()))}Mvl(W,xa){if(W===Vb.QCb)throw D.a.mu(-2130915327);xa.commentBody&&(this.fc.ka("896")?this.SCh(W,xa,!0):D.a.cob(this.yb,()=>{this.SCh(W,xa,!1)}))}Nvl(W,xa){if(void 0===xa.Resolve||null===xa.Resolve)throw D.a.mu(-2130915327);const da=xa.Resolve.isResolved;let Fa=da?100:0;void 0!==xa.Task&&null!==xa.Task&&(Fa=xa.Task.completion);this.ZUa.TCh(W,da?1:0,Fa);da&&this.hb.m3k()}setThreadResolvedState(W,
xa){this.ZUa.TCh(W,xa?1:0,xa?100:0);xa&&this.hb.kYf(W)}selectFirstThreadInNextCommentContext(){this.hb.e0k()}selectLastThreadInPreviousCommentContext(){this.hb.h0k()}presentLinkToComment(W){if(W=this.ZUa.vfj(W)){W=JSON.stringify({["sId"]:W.sid,["cId"]:W.cid});var xa={};xa.nav=ne.a(W);xa.mode="copy";Wb.a.J(512496792,805,50,"PresentLinkToComment: nav:{0}",W);this.ia.La(yb.a.fCa,2,xa)}else Wb.a.J(512496793,805,50,"PresentLinkToComment failed")}registerForCommentEvents(W){this.v1j.N9i().then(xa=>{this.vie.ONk(W,
this.hb.N1d(),this.hb.TXg,this.hb.isReadOnly,this.hb.Bdg(),xa,this.D1j.OWc)})}unregisterForCommentEvents(W){this.vie.qCh(W)}registerForAction(W,xa){this.l0j.xwa(W,xa);this.hb.eMk()}unregisterForAction(){}loadThreads(){Wb.a.J(512496791,805,10,"LoadThreads is not supported on WAC")}checkAtMentionCapability(){return new Promise(W=>{e.AFrameworkApplication.fa.ff(()=>{this.Dua?this.Dua.atMentionsEnabledAsync().then(xa=>{W(xa);return null}):W(!1)})})}resolveSupported(){return this.J2j}static l7i(W,xa){let da=
!1;for(let Fa=0;Fa<W.length;Fa++){if(da&&W[Fa].commentId!==xa&&W[Fa].parentId!==xa)return Fa;W[Fa].commentId===xa&&(da=!0)}return da?W.length:-1}static Ksj(W,xa){let da=!1;for(let Fa=0;Fa<W.length;Fa++)if(W[Fa].commentId===xa&&(da=!0),da&&W[Fa].parentId===xa)return!0;return!1}static K0d(W,xa){for(let da=0;da<W.length;da++)if(W[da].commentId===xa)return da;return-1}static Pzh(){if(md.a("CommentsFpsIsEnabled"))try{const W=rc.a.instance.Ka("Common.ISystemInitiatedFeedback");W&&W.execute(xa=>{xa.logActivity("PPTWebCommitNewCommentActivity",
"CommentsFpsIsEnabledBRS")})}catch(W){Wb.a.J(512496790,805,10,"Exception thrown while triggering PPTWebCommitNewCommentActivity. Exception: {0}",W)}}static Qzh(W){if(md.a("CommentsTasksFpsIsEnabled")&&W&&W.Task)try{const xa=rc.a.instance.Ka("Common.ISystemInitiatedFeedback");xa&&xa.execute(da=>{da.logActivity("PPTWebCommitTaskActivity","CommentsTasksFpsIsEnabledBRS")})}catch(xa){Wb.a.J(512496789,805,10,"Exception thrown while triggering PPTWebCommitTaskActivity. Exception: {0}",xa)}}}Vb.QCb="temp-id";
Object(h.a)(Vb,"CommentAPI",null,[1091,1092]);var Lc=d(198),Xc=d(342),Ib=d(672);class gc{constructor(W,xa,da){this.Pfc=W;this.commentId=xa;this.state=da}}Object(h.a)(gc,"CommentTextAnchorToHighlight",null,[]);var Fb=d(54),fb=d(75),Pc=d(31),dd=d(88),kd=d(92),Td=d(49);class ce{constructor(){this.Ftd=this.xEd=this.GMa=null;this.glg=!1;this.Dld=this.Eld=this.endPos=this.startPos=0}get paragraphs(){return this.GMa}get vU(){return this.xEd}set vU(W){this.xEd=W;this.GMa=[];this.GMa.push(this.xEd)}get z2(){return this.Ftd}set z2(W){this.Ftd=
W;this.GMa&&this.h6b&&this.GMa.push(this.Ftd)}zRi(){for(const W of this.GMa){const xa=Object(pb.a)(5,W);if(xa&&-1!==xa.ntb().indexOf("\ufffc"))return!0}return!1}bAg(W){const xa=(this.Dld&4294967295)>>>0;W.TextBodyLength!==this.Eld||xa===W.TextBodyHash||ce.Njh.contains(this.Dld)||(ce.Njh.add(this.Dld),Wb.a.J(554280861,805,50,"IsTextBodyLengthValid - text body length matches but hash does not; ContainsObjectReplaceChar:{0}",this.zRi()));return W.TextBodyLength===this.Eld}get Xbh(){let W=0;if(this.isValid)if(this.h6b){W+=
Pc.ParagraphReader.textLength(this.vU)-this.startPos;W+=this.endPos;for(let xa=1;xa<this.paragraphs.length-1;xa++){const da=this.paragraphs[xa];da&&(W+=Pc.ParagraphReader.textLength(da)+1)}}else W=this.endPos-this.startPos;return W}get TJa(){if(!this.isValid)return dd.a.auto;var W=Td.a.ak(this.vU,this.startPos+1);if(!W)return dd.a.auto;W=kd.a.Ls(W);return W?(W=W.cache)&&W.Y2?W.fontColor:dd.a.auto:dd.a.auto}get isValid(){return!!this.vU&&!!this.z2&&!!this.paragraphs}get h6b(){return!this.vU.equals(this.z2)}U2h(W){this.GMa&&
W&&this.GMa.push(W)}ZCj(){if(this.isValid&&(this.vU.kv(16,!0),this.h6b))for(let W=1;W<this.paragraphs.length;W++){const xa=this.paragraphs[W];xa&&xa.kv(16,!0)}}zGj(W,xa){if(!this.isValid)return!1;const da=Object(pb.a)(fb.AParagraphNode,W.node),Fa=Object(pb.a)(fb.AParagraphNode,xa.node);return!(da&&Fa&&Array.contains(this.paragraphs,da)&&Array.contains(this.paragraphs,Fa))||da.equals(this.vU)&&(0>W.Qa||W.Qa<this.startPos)||Fa.equals(this.z2)&&(0>xa.Kb||xa.Kb>this.endPos)?!1:!0}sag(W){let xa=3;W&&(!this.h6b&&
this.vU.equals(W)?xa=2:this.vU.equals(W)?xa=0:this.z2.equals(W)&&(xa=1));return xa}}ce.Njh=new pa.a;Object(h.a)(ce,"TextAnchorParagraphInfo",null,[]);class ld{static hsb(W,xa){return W||xa?W&&xa?W.commentId===xa.commentId:!1:!0}static hKc(W){return!!W.Children&&0<W.Children.length}static Aaj(W,xa){W=W.ntb()+"\r";for(let da=0;da<W.length;da++){let Fa=W.charCodeAt(da);160===Fa&&(Fa=32);xa=(xa<<5>>>0)+xa+Fa}return xa}static cN(W){return!!W&&!!W.textAnchoringInfo&&W.textAnchoringInfo.EndPos>W.textAnchoringInfo.StartPos&&
0<W.textAnchoringInfo.TextBodyLength}static W1b(W,xa){if(!ld.cN(W))return null;if(!xa||1>xa.AD().length)return Wb.a.J(574179520,805,xa?10:15,"CommentUtilities::GetTextAnchoredCommentParagraph - CommentAnchorShape is null:{0}, else text anchored shape has no paragraphs",!xa),null;let da=null,Fa=null,Ua=null;W.textAnchoringInfo.AnchoringShape&&(W.textAnchoringInfo.AnchoringShape.TableCell?(da=K.a.Mf(W.textAnchoringInfo.AnchoringShape.TableCell.RowId),Fa=K.a.Mf(W.textAnchoringInfo.AnchoringShape.TableCell.ColId)):
W.textAnchoringInfo.AnchoringShape.SmartArtNodeId&&(Ua=W.textAnchoringInfo.AnchoringShape.SmartArtNodeId,Ua.startsWith("{")||(Ua="{"+Ua),Ua.endsWith("}")||(Ua+="}")));let cb=W.textAnchoringInfo.StartPos;W=W.textAnchoringInfo.EndPos;let Jb=0,Gc=0;const pd=new ce;xa=xa.AD();for(let de=0;de<xa.length;de++){const Be=xa[de],Mf=Pc.ParagraphReader.textLength(Object(pb.a)(fb.AParagraphNode,Be));if(da&&Fa){var Ld=Be.HK();if(!Ld||!da.equals(Ld.rowId)||!Fa.equals(Ld.cellId))continue}else if(Ua&&(!Be.get_smartArtModelId()||
Ua!==Be.get_smartArtModelId()))continue;if(!pd.isValid&&(Mf>cb||pd.vU)){if(!pd.vU&&(pd.vU=Object(pb.a)(fb.AParagraphNode,Be),pd.startPos=cb,!pd.vU))return null;Ld=de===xa.length-1||!!Ua&&ld.ALj(Ua,xa[de+1])||!!da&&!!Fa&&ld.zLj(da,Fa,xa[de+1]);Ld=Mf<W&&0<Mf&&Ld;if((Mf>=W||Ld)&&!pd.z2){if(Ld&&(W=Mf),pd.z2=Object(pb.a)(fb.AParagraphNode,Be),pd.endPos=W,!pd.z2)return null}else Be.equals(pd.vU)||pd.U2h(Object(pb.a)(fb.AParagraphNode,Be))}Jb+=Mf+1;Gc=ld.Aaj(Be,Gc);pd.vU||(cb-=Mf+1);W-=Mf+1}pd.Eld=Jb;pd.Dld=
Gc;return pd}static ALj(W,xa){return xa.get_smartArtModelId()&&xa.get_smartArtModelId()===W?!1:!0}static zLj(W,xa,da){return(da=da.HK())&&W.equals(da.rowId)&&xa.equals(da.cellId)?!1:!0}static Dhj(W,xa,da,Fa){da=Fa=-1;if(!W)return Wb.a.J(554574735,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape is null."),{returnValue:null,AJa:da,SBa:Fa};let Ua=Object(pb.a)(5,xa.Ua.node);const cb=Object(pb.a)(5,xa.Ve.node);if(!Ua||!cb)return Wb.a.J(554574736,805,15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Start paragraph node is null:{0}; end paragraph node is null:{1}.",
!Ua,!cb),{returnValue:null,AJa:da,SBa:Fa};const Jb=xa.Ua.n3a,Gc=xa.Ve.GTb;var pd=Pc.ParagraphReader.textLength(xa.Ua.node);xa=Pc.ParagraphReader.textLength(xa.Ve.node);if(0>Jb||0>=Gc||Jb===Gc&&Ua===cb||Jb>pd||Gc>xa)return Wb.a.J(554574737,805,50,"CommentUtilities::GetTextAnchorParagraphFromSelection - Invalid start/end character positions. StartCp:{0}; EndCp{1}; FirstCtxTextLength:{2}; LastCtxTextLenth:{3}.",Jb,Gc,pd,xa),{returnValue:null,AJa:da,SBa:Fa};W=W.AD();if(!W)return Wb.a.J(554574738,805,
15,"CommentUtilities::GetTextAnchorParagraphFromSelection - Parent shape paragraph node list is null."),{returnValue:null,AJa:da,SBa:Fa};pd=0;for(const Ld of W){if(cb.get_smartArtModelId()){if(Ld.get_smartArtModelId()!==cb.get_smartArtModelId())continue;Ua.get_smartArtModelId()!==cb.get_smartArtModelId()&&(Ua=Ld)}if(cb.hs()){if(Ld.HK()!==cb.HK())continue;Ua.HK()!==cb.HK()&&(Ua=Ld)}Ua===Ld&&(da=Jb+pd);cb===Ld&&(Fa=Gc+pd);if(0<=da&&0<=Fa)return{returnValue:Ua,AJa:da,SBa:Fa};pd+=Ld.ntb().length+1}0<=
da&&-1===Fa&&(Ua.get_smartArtModelId()||Ua.hs())&&(Fa=pd-1);return{returnValue:Ua,AJa:da,SBa:Fa}}static get gDc(){return Fb.a.eg||Fb.a.xSa}static get lKc(){return!Fb.a.Ki}}Object(h.a)(ld,"CommentUtilities",null,[]);class ad extends Sys.EventArgs{constructor(W){super();this.K9k=W}}Object(h.a)(ad,"CommentsVisibilityOnSmartArtChangeEventArgs",Sys.EventArgs,[]);class Yf{constructor(W,xa,da,Fa,Ua,cb,Jb,Gc,pd,Ld){this.aRg=[];this.I6c=null;this.$id=!1;if(!Ld)throw Error.argumentNull("viewElementEventNotifier");
this.Hc=xa;this.Gre=this.icc=!1;this.$Yc=W;this.i$j=da;this.P$a=this.ZTa=null;this.Tk=Fa;this.ra=Ua;this.LTa=cb;this.VEa=Jb;this.rda=Gc;this.y1j=pd;this.A4=Ld;this.rda.rFe(this.y1j)}get OV(){return this.ZTa&&this.ZTa.isConnected?this.ZTa:null}get Ith(){return this.icc}klc(W,xa,da=!1,Fa=!1){const Ua=this.i$j.AG(W);if(Ua)switch(xa){case 0:Ua.display(da,Fa);this.ZTa=W;break;case 1:Ua.activate();this.P$a=W;break;case 2:Ua.dismiss();this.ZTa=null;break;case 3:this.OV&&this.OV===W&&this.a5a&&this.PWd(this.a5a,
W)?Ua.display(ld.cN(this.a5a),Fa):Ua.dismiss();this.P$a=null;break;case 4:Ua.mJi(da),this.ZTa=W}}did(W){if(this.Hc&&this.Hc.Gc)switch(W){case 0:this.Hc.Gc.highlight();this.icc=!0;break;case 2:this.Hc.Gc.aCh();this.icc=!1;break;case 1:this.Hc.Gc.highlight();this.Gre=!0;break;case 3:this.Hc.Gc.aCh(),this.Gre=!1}}VHc(){this.$Yc&&(this.icc?this.did(2):this.OV&&this.klc(this.OV,2),this.nrb(null))}PWd(W,xa){if(!ld.cN(W))return!0;W=this.Tk.Fy();return Lc.a.any(W,da=>!ld.cN(da)&&da.anchorShape===xa.get_shapeId())}lJe(W,
xa,da,Fa=!1,Ua=!1){if(this.$Yc&&W&&(!Fa||Yf.yrb(this.Tk.Fy(),W))){Fa=this.y7(W);var cb=this.OV!==Fa&&!!this.OV;cb&&this.ra.n7(this.OV);this.VHc();if(Fa){const Jb=ld.cN(W);this.P$a===Fa?this.PWd(W,Fa)?this.klc(Fa,4,Jb,Jb&&cb):this.ZTa=Fa:this.PWd(W,Fa)?this.klc(Fa,0,Jb,da&&cb):this.ZTa=Fa;xa=!!xa&&xa===W.commentId;(Jb||xa)&&Ua||this.N0k(Fa,String.format(ResourceStrings.L_CommentAnchoringShapeSelection,W.authorName,W.dt.toDateString(),W.dt.toLocaleTimeString()))}else this.did(0),this.Hc&&this.Hc.Gc&&
this.Hc.Gc.Ed&&this.Ugd(String.format(ResourceStrings.L_CommentAnchoringSlideCommentSelection,(this.Hc.Gc.Ed.we+1).toString(),this.Hc.Gc.Ed.title));!Ua&&cb&&this.ra.selectShape(this.OV,!0,!1);this.nrb(null)}}n0h(W){if(this.$Yc){var xa=this.y7(W);xa?ld.cN(W)?this.P$a=xa:this.klc(xa,1):this.did(1);this.nrb(W)}}xHc(){this.P$a&&this.klc(this.P$a,3);this.Gre&&!this.icc&&this.did(3);this.nrb(null)}y7(W){if(!W)return null;try{return this.VEa.dMc(W)}catch(xa){return Wb.a.J(512496788,805,15,"GetAnchoredShapeForComment - Exception while getting anchored shape: {0}",
xa),null}}nrb(W){const xa=[];var da=this.P$a;W&&!da&&(da=this.OV);const Fa=this.OV?this.OV:this.ra.rq();Fa||W&&da||this.Ozh(xa);let Ua=null;const cb=[];var Jb=!1;if(ld.cN(W)&&da&&0<da.AD().length&&(!this.a5a||W.commentId!==this.a5a.commentId)){var Gc=ld.W1b(W,da);Gc&&Gc.isValid&&(Jb=Xc.a.Mf("{"+W.commentId+"}{1}"),xa.push(new gc(Gc,Jb,1)),Jb=!0,da=this.VEa.Pk(da))&&(cb.push(da),(da=da.shapeNode)&&da.Pf&&(Ua=da))}if(this.$id||Fa&&0<Fa.AD().length)if(da=this.Tk.Fy())for(var pd of da){if(!ld.cN(pd)||
!this.$id&&pd.anchorShape!==Fa.get_shapeId()||Jb&&pd.commentId===W.commentId)continue;Gc=this.$id?this.y7(pd):Fa;if(!Gc)continue;let Ld=ld.W1b(pd,Gc);if(!Ld||!Ld.isValid)continue;let de=5;(da=!!this.a5a&&pd.commentId===this.a5a.commentId)&&(de=0);const Be=Xc.a.Mf("{"+pd.commentId+"}{1}");xa.push(new gc(Ld,Be,de));if(Gc=this.VEa.Pk(Gc))cb.push(Gc),Gc=Gc.shapeNode,!Ua&&Gc&&da&&Gc.Pf&&(Ua=Gc)}for(const Ld of this.aRg)!Ld||Array.contains(cb,Ld)||Ld.shapeNode&&Ld.shapeNode.Pf||(Ld.W$d=!1,Ld.Sp||!Ld.Kn||
Ld.Ox||Ld.kJb());W=null;for(const Ld of cb)(pd=Ld.shapeNode)&&pd.Pf?(W||(W=pd),Ua||Fa!==pd||(Ua=pd)):(Ld.W$d=!0,Ld.Kn||(Wb.a.J(512496787,805,50,"DetermineTextAnchorHighlighting - Switched from FidelityView to EditView to display text anchors"),Ld.Pkd()));Ua||this.ra.aL()||!W||(Ua=W);this.aRg=cb;this.A4.FGk(new ad(Ua));this.Ozh(xa)}Ozh(W){W=Object.assign(new Ib.a,{action:0,type:0,sca:W,Qeb:this.rda.V9a?this.rda.V9a.sca:null});this.rda.shd(W)}Ugd(W){this.LTa.Kea(W)}N0k(W,xa){this.LTa.lch(W,xa)}tKe(W){this.$Yc=
W}get a5a(){return this.I6c&&this.I6c.MGb?this.I6c.MGb.comment:null}static yrb(W,xa){if(W)for(const da of W)if(xa.commentId===da.commentId)return!0;return!1}}Object(h.a)(Yf,"CommentAnchoringHighlightsHelper",null,[]);var Xd=d(41);class fg{constructor(W,xa,da,Fa,Ua,cb,Jb){this.uc=W;this.ua=xa;this.D_c=da;this.JN=Fa;this.q$j=Ua;this.Ob=cb;this.yb=Jb;this.kef=0}WZa(W,xa){if(W||1!==this.OWc)if(2>this.uc.Hj())this.t0h?this.eLe(5):this.eLe(1);else{const da=Xd.a.Pl("UpdateNextPopulatedContextDetails",2);
this.D_c.HXd((Fa,Ua,cb)=>{this.dmk(Fa,Ua,cb,da,xa)},da)}}get OWc(){return this.kef}dmk(W,xa,da,Fa,Ua){let cb=1;if(this.ua.Ba){const Jb=this.ua.Ba.we;let Gc=!1,pd=!1,Ld=!1;xa&&W&&(W=W.we,W<Jb?Gc=!0:W===Jb?pd=!0:(Ld=!0,da||(Gc=!0)));0<=Ua&&(Ua<Jb?Gc=!0:Ua===Jb?pd=!0:Ld=!0);Ld?cb=Gc||pd?3:2:Gc?cb=4:pd&&(cb=5)}this.eLe(cb);Fa.finish();D.a.cob(this.yb,()=>{this.Ob.updateCommandUI()})}eLe(W){this.kef=W;this.q$j.WZa(W,1===this.Ob.mode)}get t0h(){return!!this.ua.Ba&&this.JN.BKi(this.ua.Ba)}}Object(h.a)(fg,
"CommentContextDetailsUpdateHelper",null,[1063]);var ue=d(37);class Sa{n3k(W){if(null===W)throw Error.argumentNull("comment");W.setValue(ue.a.commentId,"")}j3k(W,xa){if(null===W)throw Error.argumentNull("comment");W.setValue(ue.a.GOd,xa)}l3k(W){if(null===W)throw Error.argumentNull("comment");if(W=Object(pb.a)(1087,W))W.rqb=ResourceStrings.anonymousCommentAuthor}$kc(W){if(null===W)throw Error.argumentNull("comment");W.setValue(ue.a.LWb,!0)}Fmh(W,xa,da,Fa){if(null===W)throw Error.argumentNull("comment");
if(W=Object(pb.a)(1087,W))W.authorName=xa,W.TUb=da,W.NCc=Fa}o3k(W,xa){if(null===W)throw Error.argumentNull("comment");W.setValue(ue.a.MWb,xa)}}Object(h.a)(Sa,"CommentEditor",null,[1090]);var rb=d(30),pc=d(81),cd=d(57);class zd{constructor(){this.anchorShape=0;this.dt=this.commentId=this.Children=this.changesData=this.authorName=null;this.isUnread=!1;this.reactions=this.providerId=this.pos=null;this.status=0;this.userId=this.textAnchoringInfo=this.text=this.taskInfo=null}}Object(h.a)(zd,"Comment",
null,[]);var wd=d(295),Oa=d(881),jb=d(447),qc=d(28);class ib{constructor(W,xa,da,Fa,Ua,cb,Jb,Gc,pd,Ld,de,Be,Mf,Dg,yd){this.$ca=null;this.iyb=Fa;this.Fb=Ua;this.ua=cb;this.PA=Jb;this.oka=Gc;this.fc=pd;this.Nb=Ld;this.ra=de;this.OD=Be;this.Hhe=Mf;this.lc=Dg;this.IQ=yd;this.MQ=W;this.w1j=da;this.I2j=0===xa;this.ACh();this.Fee()}dispose(){}get userName(){return this.fc.appSettings.UserName}get userId(){return this.fc.appSettings["387"]}get providerId(){return this.fc.appSettings["388"]}get isTasksHistoryEnabled(){return this.fc.ka("TasksHistoryEnabled")}get y4b(){return this.fc.ka("PPTOBlueDotsForComments")}get Twg(){return md.a("Comments.LogTasksTelemetry")}get cCa(){return this.fc.ka("SlideResizePerfImprovementEnabled")}addComment(W,
xa,da){this.TCf("",W,xa,da,null,null,null,null)}l1h(W,xa,da,Fa,Ua,cb,Jb,Gc){this.TCf(W,xa,da,Fa,Ua,cb,Jb,Gc)}TCf(W,xa,da,Fa,Ua,cb,Jb,Gc){const pd=this.MQ.zi("UserAction","AddComment");e.AFrameworkApplication.fa.Eca?this.VCf(W,xa,da,Fa,Ua,cb,Jb,Gc,pd):this.fc.ff(()=>{this.VCf(W,xa,da,Fa,Ua,cb,Jb,Gc,pd)})}VCf(W,xa,da,Fa,Ua,cb,Jb,Gc,pd){this.w1j.Qqb().then(Ld=>{ib.Cjh&&(Wb.a.J(512262931,805,15,"FirstCommentBeingAdded - IsBlank:{0}; CreateNewCommentPolicyEnabled:{1}",this.I2j,Ld),this.OD.RXj(Ld),ib.Cjh=
!1);this.k1h(W,xa,da,Fa,Ua,cb,Jb,Gc);pd&&pd.stop();return Ld}).catch(Ld=>{Wb.a.J(512262930,805,10,JSON.stringify(Ld));throw Error.create("CreateNewEnabledAsync or AddCommentOnFullAppSettingsReady failed");})}k1h(W,xa,da,Fa,Ua,cb,Jb,Gc){if(this.F4b()){var pd=!1,Ld=0,de=0;Fa&&(pd=!0,Ld=Fa.x,de=Fa.y);Fa=this.Fb.ke(15);try{var Be=this.$ca;Fa.kc(Be);const Mf=rb.GraphIterator.mb(Be),Dg=Object(pb.a)(pc.a,this.iyb.createInstance(1074135127));this.oka.$kc(Dg);this.oka.n3k(Dg);this.oka.j3k(Dg,W);Be=null;const yd=
Object(pb.a)(1087,Dg);if(yd){if(yd.tqb=pd)yd.qba=Object.assign(new Oa.a,{X:Ld,Y:de});yd.Cyh=this.Hhe.jij();yd.ICc=cb;if(Be=Object(pb.a)(4,Ua))yd.JWb=Be.get_shapeId();da&&(yd.ewa=da);Jb&&(yd.taskInfo=Jb);Gc&&(yd.textAnchoringInfo=Gc);yd.Gqa=xa}let td=this.userId;Ua=!td;const id=!this.providerId,ed=!this.userName;(Ua||id)&&Wb.a.J(512262928,805,Ua&&!id?15:10,"CommentEditor UserID null: {0}; ProviderID null: {1} UserName null: {2};",Ua,id,ed);md.a("Comments.UseNameInPlaceOfUserId")&&Ua&&!id&&(td=ed?ResourceStrings.anonymousCommentAuthor:
this.userName);this.oka.Fmh(Dg,this.userName,td,this.providerId);ed&&this.oka.l3k(Dg);Mf.pl(Dg,1);Wb.a.J(512262927,805,50,"CommentManager::AddCommentOnFullAppSettingsReady - Added comment: {0}; Has Task: {1}; Is Text Anchored: {2}, Is Shape Anchored: {3}",W,!!Jb,!!Gc,!!Be)}finally{Fa&&Fa.dispose()}this.jXj(W,da,xa,Gc,Jb)}else Wb.a.J(512262929,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - CommentContentNode is unavailable")}jXj(W,xa,da,Fa,Ua){this.Twg?xa?(xa=this.GCa(xa))?(xa=this.Wra(xa))?
this.OD.kXj(W,da.length-1,!!Fa,xa.taskInfo,Ua):Wb.a.J(512262925,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment not found"):Wb.a.J(512262926,805,10,"CommentManager::AddCommentOnFullAppSettingsReady - Parent comment node not found"):this.OD.lXj(W,da.length-1,!!Fa,!!Ua):this.OD.Cee(W,da.length-1,!!Fa,!!Ua)}deleteComment(W){this.OD.b_j();if(this.F4b()){var xa=this.Fb.ud(15);try{xa.kc(this.$ca),this.dTd(W,this.$ca),xa.fd=qc.a.deleteComment}finally{xa&&xa.dispose()}}else Wb.a.J(512262924,
805,10,"CommentManager::DeleteComment - CommentContentNode is unavailable")}dTd(W,xa){md.a("IsDeselectShapeOnDeleteCommentEnabled")&&this.ra.a8()&&(Wb.a.J(512262923,805,15,"CommentManager::DeleteCommentHelper - Removing shape selection in text edit while deleting comment"),this.ra.Uh());const da=this.I1i(W,xa);if(da&&0<da.count){this.oka.$kc(xa);for(let Fa of da)xa=rb.GraphIterator.mb(Fa),xa.pc(39),xa.Ii();Wb.a.J(512262922,805,50,"CommentManager::DeleteCommentHelper - Deleted comment {0}",W)}else Wb.a.J(512262921,
805,10,"CommentManager::DeleteCommentHelper - Failed to find comment node {0}",W);this.OD.wLk()}m5a(){const W=Date.now();this.OD.VXj();const xa=this.Fy();if(xa){var da=this.Fb.ud(15);try{da.kc(this.ua.Ba);for(const Fa of xa)this.dTd(Fa.commentId,this.$ca);da.fd=qc.a.m5a}finally{da&&da.dispose()}Wb.a.J(512262919,805,50,"CommentManager::DeleteAllCommentsInSlide - Time taken: {0} ms",Date.now()-W)}else Wb.a.J(512262920,805,10,"CommentManager::DeleteAllCommentsInSlide - Failed to retrieve comments of active slide")}zYb(W){const xa=
Date.now();W?this.OD.WXj():this.OD.UXj();const da=this.ua.presentation;if(da){var Fa=da.slides;if(Fa){var Ua=this.Fb.ud(15);try{Ua.kc(da);for(const cb of Fa){const Jb=Object(pb.a)(120,cb);if(!Jb||!Jb.xD()){Wb.a.J(512262918,805,10,"CommentManager::DeleteAllComments - slideNode not found or has no comments node: {0}",Jb);continue}const Gc=rb.GraphIterator.mb(Jb).Ab(16);for(const pd of this.Xra(Jb.xD()))(W?1===pd.status:1)&&this.dTd(pd.commentId,Gc)}Ua.fd=W?qc.a.BYb:qc.a.AYb}finally{Ua&&Ua.dispose()}Wb.a.J(512262917,
805,50,"CommentManager::DeleteAllComments - Time taken: {0} ms - fOnlyDeleteResolved: {1}",Date.now()-xa,W)}}}editComment(W,xa){this.N_f(W,xa,null)}yLi(W,xa,da){this.N_f(W,xa,da)}N_f(W,xa,da){if(this.F4b()){var Fa=this.GCa(xa);if(Fa){const Ua=this.Fb.ke(15);try{Ua.kc(Fa);this.oka.$kc(Fa);const cb=Object(pb.a)(1087,Fa);cb&&(cb.Gqa=W,cb.ICc=da)}finally{Ua&&Ua.dispose()}Wb.a.J(512262915,805,50,"CommentManager::EditCommentInternal - Edited comment {0}",xa)}else Wb.a.J(512262914,805,10,"CommentManager::EditCommentInternal - Failed to find comment node {0}",
xa);this.OD.$Xj()}else Wb.a.J(512262916,805,10,"CommentManager::EditCommentInternal - CommentContentNode is unavailable")}BCb(W,xa){if(this.F4b()){var da=this.GCa(W);if(da){if(null===xa)throw Error.argumentNull("pos");const Fa=this.Fb.ke(15);try{Fa.kc(da),this.oka.$kc(da),Object(pb.a)(1087,da).qba=Object.assign(new Oa.a,{X:xa.x,Y:xa.y})}finally{Fa&&Fa.dispose()}Wb.a.J(512262912,805,50,"CommentManager::MoveComment - Moved comment {0}",W)}else Wb.a.J(512262883,805,10,"CommentManager::MoveComment - Failed to find comment node {0}",
W);this.OD.lZj(W)}else Wb.a.J(512262913,805,10,"CommentManager::MoveComment - CommentContentNode is unavailable")}TCh(W,xa,da){if(this.F4b()){var Fa=this.GCa(W);if(Fa){const Ua=this.Fb.ke(15);try{Ua.kc(Fa),this.oka.$kc(Fa),this.oka.o3k(Fa,xa),Object(pb.a)(1087,Fa).gib=da,this.isTasksHistoryEnabled&&this.oka.Fmh(Fa,this.userName,this.userId,this.providerId)}finally{Ua&&Ua.dispose()}if(this.Twg){da=this.Wra(Fa);if(!da){Wb.a.J(512262881,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment");
return}1===xa?this.OD.LZj(!!da.taskInfo):0===xa&&this.OD.B_j(!!da.taskInfo)}else 1===xa&&this.OD.MZj();Wb.a.J(512262880,805,50,"CommentManager::UpdateCommentStatus - Updated comment status {0}:{1}",W,xa)}else Wb.a.J(512262879,805,10,"CommentManager::UpdateCommentStatus - Failed to find comment node {0}",W)}else Wb.a.J(512262882,805,10,"CommentManager::UpdateCommentStatus - CommentContentNode is unavailable")}Fy(){return this.Xra(this.$ca)}Xra(W){const xa=[];if(!W||39!==W.type)return xa;W=rb.GraphIterator.mb(W);
for(var da=W.Ji();da;){if(40===da.type){const Fa=Object(pb.a)(1087,da).ewa;da=this.Wra(da);if(Fa)for(const Ua of xa)Ua.commentId===Fa&&(Ua.Children||(Ua.Children=[]),Ua.Children.push(da));else xa.push(da)}da=W.yp()}return xa}ACh(){const W=this.ua.Ba;this.$ca=W?rb.GraphIterator.mb(W).Ab(16):null}m6i(){if(!this.$ca)return!1;const W=rb.GraphIterator.mb(this.$ca);if(this.PA.j$f(this.$ca))return!0;let xa=W.Ji();for(;xa;){if(this.PA.j$f(xa))return!0;xa=W.yp()}return!1}ATi(W,xa){return this.a5f(W,xa,!1)}MTi(W,
xa){return this.a5f(W,xa,!0)}a5f(W,xa,da){if(!W)return null;if(W=W.xD()){W=this.Nb.Kc(W);let Fa=da?W.o2b():W.Ji();for(;Fa;){if(!(this.PA.nVc(Fa)||xa&&0!==this.PA.JMc(Fa)))return this.Wra(Fa);Fa=da?W.gDa():W.yp()}}return null}BKi(W){return W?(W=W.xD())?!!this.Nb.Kc(W).Ji():!1:!1}KMc(W){if(!W)return 0;var xa=W.xD();W=0;if(xa){xa=this.Nb.Kc(xa);let da=xa.Ji();for(;da;)this.PA.nVc(da)||W++,da=xa.yp()}return W}F4b(){return!!this.$ca&&this.$ca.isConnected}I1i(W,xa){xa=rb.GraphIterator.mb(xa);var da=xa.Ji();
const Fa=new r.a;for(;da;){const Ua=this.PA.HMc(da),cb=Object(pb.a)(1087,da).ewa;W!==Ua&&W!==cb||Fa.add(da);da=xa.yp()}return Fa}GCa(W){const xa=rb.GraphIterator.mb(this.$ca);let da=xa.Ji();for(;da;){const Fa=this.PA.HMc(da);if(W===Fa)return da;da=xa.yp()}return null}G2d(W){W=this.GCa(W);if(!W)return null;const xa=Object(pb.a)(1087,W).ewa;return Pb.a.Va(xa)?W:this.GCa(xa)}Wra(W){if(md.a("GetCommentFromGraphNodeNullSafety")){var xa=Object(pb.a)(1087,W);if(!xa)return null;var da=new zd;da.dt=xa.XXb;
da.text=xa.Gqa;da.status=this.PA.JMc(W);da.userId=xa.TUb;da.commentId=this.PA.HMc(W);da.authorName=xa.authorName;da.providerId=xa.NCc;da.anchorShape=xa.JWb;da.pos=Object.assign(new wd.a,{X:xa.qba.X,Y:xa.qba.Y});da.taskInfo=xa.taskInfo;da.textAnchoringInfo=xa.textAnchoringInfo;this.y4b&&(da.changesData=xa.changesData,da.isUnread=this.IQ.instance&&this.IQ.instance.gug(xa));return da}if(W){xa=this.PA.HMc(W);da=new zd;const Fa=Object(pb.a)(1087,W);if(Fa){da.dt=Fa.XXb;da.anchorShape=Fa.JWb;const Ua=Fa.qba;
da.pos=Object.assign(new wd.a,{X:Ua.X,Y:Ua.Y});da.text=Fa.Gqa;da.authorName=Fa.authorName;da.userId=Fa.TUb;da.providerId=Fa.NCc;this.y4b&&(da.changesData=Fa.changesData,da.isUnread=this.IQ.instance&&this.IQ.instance.gug(Fa))}da.status=this.PA.JMc(W);da.commentId=xa;da.taskInfo=Object(pb.a)(1087,Fa).taskInfo;da.textAnchoringInfo=Object(pb.a)(1087,Fa).textAnchoringInfo;return da}return null}Q6a(W){if(!W)return[];const xa=this.Xra(W.xD());if(!xa||this.cCa&&!xa.length){if(!xa)throw Error.create("GetCommentsSortedByPositionForSlide - Comments should not be null");
return xa}xa.sort((da,Fa)=>{var Ua=this.lc.b3d(W,da.anchorShape);Ua=Ua?Ua.MC:new cd.a(0,0);var cb=this.lc.b3d(W,Fa.anchorShape);cb=cb?cb.MC:new cd.a(0,0);Ua.y+=da.pos.Y;cb.y+=Fa.pos.Y;Ua.x+=da.pos.X;cb.x+=Fa.pos.X;let Jb=Ua.y-cb.y;Jb||(Jb=Ua.x-cb.x)||(Jb=+da.dt-+Fa.dt);return Jb});return xa}vfj(W){var xa=this.ua.presentation;if(!xa)return null;xa=xa.slides;if(!xa)return null;for(const da of xa)if(xa=Object(pb.a)(jb.a,da))for(const Fa of this.Xra(xa.xD())){if(W===Fa.commentId)return da;if(Fa.Children)for(const Ua of Fa.Children)if(W===
Ua.commentId)return da}return null}Fee(){let W=0,xa=0;var da=this.ua.presentation;if(da){var Fa=da.slides;if(Fa){da=new r.a;for(const Ua of Fa)if((Fa=Object(pb.a)(jb.a,Ua))&&Fa.xD())for(const cb of this.Xra(Fa.xD()))ld.cN(cb)?xa+=1:cb.textAnchoringInfo&&da.add(cb.commentId),W+=1;this.OD.Fee(W,xa,da)}}}}ib.Cjh=!0;Object(h.a)(ib,"CommentManager",null,[1088,1089,106]);var Cb=d(131);class yc{constructor(W,xa,da,Fa){this.JN=W;this.Hc=xa;this.Mb=da;this.tc=Fa}Hej(W){if(null===W)throw Error.argumentNull("comment");
if(W=this.dMc(W))if(W=this.Pk(W))return W.xa.xa;return null}d_i(W){if(null===W)throw Error.argumentNull("comment");if(W=this.dMc(W)){if(W.qd){var xa=this.tc.iN(W);if(!xa)return Wb.a.J(595133523,805,10,"GetAnchorBoundingRegion: Shape {0} is table shape but has no table node",W.get_shapeId()),null;xa=xa.oc(this.Mb.Ma);return xa&&xa.htmlElement?Cb.a.Zba(new Sys.UI.Bounds(xa.htmlElement.clientLeft,xa.htmlElement.clientTop,xa.htmlElement.clientWidth,xa.htmlElement.clientHeight)):(Wb.a.J(595133521,805,
10,"GetAnchorBoundingRegion: cannot find table view element for table shape {0}",W.get_shapeId()),null)}if(W=this.Pk(W))return W=W.xa.xa,Cb.a.Zba(new Sys.UI.Bounds(W.clientLeft,W.clientTop,W.clientWidth,W.clientHeight))}return null}dMc(W){if(null===W)throw Error.argumentNull("comment");if(!W.anchorShape)return null;W=this.JN.G2d(W.commentId);W=this.JN.Wra(W);if(!W)return null;const xa=this.Hc.Gc?this.Hc.Gc.Ed:null;return xa?xa.ZB(W.anchorShape):(Wb.a.J(557090388,805,50,"ActiveSlide is null"),null)}e_i(W){if(null===
W)throw Error.argumentNull("comment");if(!W.anchorShape)return 0;if(W=this.dMc(W))if(W=this.Pk(W))return W.rotation;return 0}Pk(W){if(null===W)throw Error.argumentNull("shapeNode");return Object(pb.a)(121,W.oc(this.Mb.Ma))}}Object(h.a)(yc,"CommentMarkerAnchorHelper",null,[1057]);var gd=d(573),od=d(112);class Mc{constructor(W,xa,da){this.H8=W;this.Hc=xa;this.hhe=da}AKi(W){const xa=Object(pb.a)(1087,this.hhe.GCa(W.commentId));if(!xa)throw m.ULS.sendTraceTag(595203538,805,10,"There is no graph node for comment {0}",
W.commentId),Error.invalidOperation("GraphNodeNotFoundForComment");return!!xa.qba}Kcj(W,xa){if(!W)throw Error.argumentNull("commentMarkerViewElement");if(!xa)throw Error.argumentNull("comment");if(!this.hhe.GCa(xa.commentId))return m.ULS.sendTraceTag(595141910,805,10,"GetRenderingPosition: There is no graph node for comment {0}",xa.commentId),new cd.a(0,Number.MIN_VALUE);const da=W.Uo;W=W.oad;if(!this.AKi(xa)||!xa.pos.X&&!xa.pos.Y){if(da)return xa=new cd.a(da.Vb-da.Yb-Mc.ogd.width-Mc.yjh.width,Mc.yjh.height),
Mc.xkg(xa,da,W),xa;if(this.Hc.Gc&&this.Hc.Gc.mB)return new cd.a(this.Hc.Gc.mB.clientWidth-Mc.ogd.width,0);m.ULS.sendTraceTag(595203537,805,10,"m_activeSlideViewManager.ActiveSlideView || m_activeSlideViewManager.ActiveSlideView.ScreenBoundsElement is null");return new cd.a(0,0)}xa=new cd.a(this.H8.Ie(xa.pos.X,0),this.H8.Ie(xa.pos.Y,1));xa=new cd.a(xa._x-Mc.cYa._x,xa._y-Mc.cYa._y);da&&(xa._x=Math.max(0,xa._x),xa._y=Math.max(0,xa._y),xa._x=Math.min(xa._x,da.Vb-da.Yb-Mc.ogd.width),xa._y=Math.min(xa._y,
da.Ub-da.$b-Mc.ogd.height),Mc.xkg(xa,da,W));return xa}Ovl(W,xa){var da=new cd.a(W.element.offsetLeft,W.element.offsetTop);da=new cd.a(da._x+Mc.cYa._x,da._y+Mc.cYa._y);const Fa=W.Uo;Fa&&W.oad%360&&Mc.hIf(da,0-W.oad,Fa.Vf());xa.pos.X=this.H8.Ff(da._x,0);xa.pos.Y=this.H8.Ff(da._y,1);this.hhe.BCb(xa.commentId,new cd.a(xa.pos.X,xa.pos.Y))}static xkg(W,xa,da){if(xa&&da%360){var Fa=new cd.a(W._x+Mc.cYa._x,W._y+Mc.cYa._y);Mc.hIf(Fa,da,xa.Vf());W.update(Fa._x-Mc.cYa._x,Fa._y-Mc.cYa._y)}}static hIf(W,xa,da){W.IL(0-
da._x,0-da._y);xa=gd.a.ZSd(xa);W.update(W._x*Math.cos(xa)-W._y*Math.sin(xa)+da._x,W._x*Math.sin(xa)+W._y*Math.cos(xa)+da._y)}}Mc.ogd=new od.a(20,20);Mc.yjh=new od.a(4,4);Mc.cYa=new cd.a(4,20);Object(h.a)(Mc,"CommentMarkerPositionHelper",null,[1058]);var Rd=d(133),ye=d(73),oe=d(46);class Bb{constructor(W,xa){this.NGa=this.dGa=this.spe=null;this.o8b=W;this.Dq=xa}mv(){return!0}Du(W){if(!W)return!1;this.NGa=this.o8b.element.style;this.spe=new cd.a(W.clientPoint.x,W.clientPoint.y);this.dGa=new cd.a(parseInt(this.NGa.left),
parseInt(this.NGa.top));this.mw(W);return!0}mw(W){if(!W)return!1;W=this.fdg(new cd.a(W.clientPoint.x,W.clientPoint.y),this.spe);this.NGa.left=oe.a.Nc(this.dGa._x+W._x);this.NGa.top=oe.a.Nc(this.dGa._y+W._y);return!0}Sn(W){if(W){W=this.fdg(new cd.a(W.clientPoint.x,W.clientPoint.y),this.spe);var xa=this.dGa._x+W._x,da=this.dGa._y+W._y,Fa=this.o8b.Uo;Fa&&(xa=Math.max(Fa.Yb,xa),xa=Math.min(Fa.Vb-this.o8b.element.clientWidth,xa),da=Math.max(Fa.$b,da),da=Math.min(Fa.Ub-this.o8b.element.clientHeight,da),
W._x=xa-this.dGa._x,W._y=da-this.dGa._y);this.NGa.left=oe.a.Nc(xa);this.NGa.top=oe.a.Nc(da);this.o8b.SVg(W)}}Yt(){this.NGa.left=oe.a.Nc(this.dGa._x);this.NGa.top=oe.a.Nc(this.dGa._y)}fdg(W,xa){W=cd.a.yU(W,xa);return new cd.a(this.Dq.Hm(W.x),this.Dq.Hm(W.y))}}Object(h.a)(Bb,"CommentMarkerDragAdapter",null,[232]);class Ff{constructor(W,xa,da,Fa,Ua,cb,Jb,Gc){this.K8=null;this.gUa=this.hUa=!1;if(!xa)throw Error.argumentNull("parentElement");this.Nyb=Gc;this.A8=W;this.aq=da;this.Aka=Fa;this.jC=Ua;this.s_c=
Jb;this.nm=document.createElement("div");this.nm.className=ld.hKc(W)?this.jC.kUg:this.jC.jUg;this.nm.title=ResourceStrings.L_CommentMarkerTooltip;this.nm.style.display=this.s_c||this.Nyb?"none":"block";this.nm.setAttribute("data-pptcommentid",String.format("{0}",W.commentId));this.Tz=document.createElement("img");this.Tz.alt=ResourceStrings.L_CommentMarkerTooltip;this.Tz.src=da.frame.hk(da.frame.iS+".png");this.Tz.setAttribute(Rd.a.Ye,Rd.a.hu);this.nm.appendChild(this.Tz);this.RZa();this.frame.Wc.ob(Zb.a.click,
this.nm,Object(Ca.a)(this,this.MB,"clickHandler"));ld.lKc&&(Fc.a.addHandler(this.nm,Zb.a.fq,Object(Ca.a)(this,this.zva,"mouseOverHandler")),Fc.a.addHandler(this.nm,Zb.a.ys,Object(Ca.a)(this,this.Gdc,"mouseOutHandler")));ld.gDc&&Fc.a.addHandler(this.Tz,Zb.a.mouseDown,Object(Ca.a)(this,this.phc,"preventNativeDragMouseDownHandler"));xa.appendChild(this.nm);cb||this.WQd()}dispose(){this.Tz&&(ld.gDc&&Fc.a.removeHandler(this.Tz,Zb.a.mouseDown,Object(Ca.a)(this,this.phc,"preventNativeDragMouseDownHandler")),
this.frame.Wc.xb(Zb.a.click,this.nm,Object(Ca.a)(this,this.MB,"clickHandler")),this.Tz.parentNode&&this.Tz.parentNode.removeChild(this.Tz),this.Tz=null);this.nm&&(ld.lKc&&(Fc.a.removeHandler(this.nm,Zb.a.fq,Object(Ca.a)(this,this.zva,"mouseOverHandler")),Fc.a.removeHandler(this.nm,Zb.a.ys,Object(Ca.a)(this,this.Gdc,"mouseOutHandler"))),this.Aka&&(this.Aka.vNd(),this.Aka.yE(this.nm,this.K8)),this.nm.parentNode&&this.nm.parentNode.removeChild(this.nm));this.aq=this.A8=null}get comment(){return this.A8}get element(){return this.nm}get frame(){return this.aq.frame}WQd(){this.Aka&&
(this.K8=new Bb(this,rc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Aka.nJ(this.nm,this.K8))}updatePosition(W){this.nm.style.left=oe.a.Nc(W._x-(this.aq.isRightToLeft?this.jC.Tte:0));this.nm.style.top=oe.a.Nc(W._y)}SVg(W){this.aq.BCb(this.A8,W)}select(W){this.hUa=W;this.RZa()}activate(W){this.gUa=W;this.RZa()}qsh(){}setVisibility(W){this.nm.style.display=W&&!this.Nyb?"block":"none"}RZa(){this.Nyb||(this.Tz.className=ld.hKc(this.A8)?this.hUa?ye.getImageClassWithCluster(this.frame.iS,
this.jC.nUg):this.gUa?ye.getImageClassWithCluster(this.frame.iS,this.jC.lUg):ye.getImageClassWithCluster(this.frame.iS,this.jC.mUg):this.hUa?ye.getImageClassWithCluster(this.frame.iS,this.jC.iUg):this.gUa?ye.getImageClassWithCluster(this.frame.iS,this.jC.Ste):ye.getImageClassWithCluster(this.frame.iS,this.jC.kdc))}get Uo(){return null}get oad(){return 0}MB(W){if(W.dA!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.A8,null,!1,!0,W.Wf,1,!1);W=W.mc;W.preventDefault();W.stopPropagation();
return!0}zva(){this.frame.Qnb(this.A8,1)}Gdc(){this.frame.Qnb(null,1)}phc(W){W.preventDefault()}}Object(h.a)(Ff,"LegacyCommentMarkerViewElement",null,[1100]);var pg=d(95),xf=d(631);class qe{constructor(W,xa,da,Fa,Ua,cb,Jb,Gc,pd){this.K8=null;this.fIg=this.gUa=this.hUa=!1;if(!xa)throw Error.argumentNull("parentElement");this.A8=W;this.aq=da;this.Aka=Fa;this.jC=Ua;this.VEa=cb;this.YYc=Jb;this.s_c=pd;this.nm=document.createElement("div");this.nm.className=ld.hKc(W)?this.jC.kUg:this.jC.jUg;Sys.UI.DomElement.addCssClass(this.nm,
"CommentMarker");this.nm.title=ResourceStrings.L_CommentMarkerTooltip;this.nm.style.display="none";this.nm.setAttribute("data-pptcommentid",String.format("{0}",W.commentId));this.Tz=document.createElement("img");this.Tz.alt=ResourceStrings.L_CommentMarkerTooltip;this.Tz.src=da.frame.hk(da.frame.iS+".png");this.Tz.setAttribute(Rd.a.Ye,Rd.a.hu);this.nm.appendChild(this.Tz);this.RZa();this.frame.Wc.ob(Zb.a.click,this.nm,Object(Ca.a)(this,this.MB,"clickHandler"));ld.lKc&&(Fc.a.addHandler(this.nm,Zb.a.fq,
Object(Ca.a)(this,this.zva,"mouseOverHandler")),Fc.a.addHandler(this.nm,Zb.a.ys,Object(Ca.a)(this,this.Gdc,"mouseOutHandler")));ld.gDc&&Fc.a.addHandler(this.Tz,Zb.a.mouseDown,Object(Ca.a)(this,this.phc,"preventNativeDragMouseDownHandler"));xa.appendChild(this.nm);Gc||this.WQd()}dispose(){this.Tz&&(ld.gDc&&Fc.a.removeHandler(this.Tz,Zb.a.mouseDown,Object(Ca.a)(this,this.phc,"preventNativeDragMouseDownHandler")),this.frame.Wc.xb(Zb.a.click,this.nm,Object(Ca.a)(this,this.MB,"clickHandler")),this.Tz.parentNode&&
this.Tz.parentNode.removeChild(this.Tz),this.Tz=null);this.nm&&(ld.lKc&&(Fc.a.removeHandler(this.nm,Zb.a.fq,Object(Ca.a)(this,this.zva,"mouseOverHandler")),Fc.a.removeHandler(this.nm,Zb.a.ys,Object(Ca.a)(this,this.Gdc,"mouseOutHandler"))),this.Aka&&(this.Aka.vNd(),this.Aka.yE(this.nm,this.K8)),this.nm.parentNode&&this.nm.parentNode.removeChild(this.nm));this.aq=this.A8=null}get comment(){return this.A8}get element(){return this.nm}get frame(){return this.aq.frame}WQd(){this.Aka&&(this.K8=new Bb(this,
rc.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion")),this.Aka.nJ(this.nm,this.K8))}updatePosition(){const W=this.YYc.Kcj(this,this.comment);this.nm.style.left=W._x+"px";this.nm.style.top=W._y+"px"}SVg(){this.YYc.Ovl(this,this.comment)}select(W){this.hUa=W;this.RZa();this.onVisibilityChange()}activate(W){this.gUa=W;this.RZa();this.onVisibilityChange()}qsh(W){this.fIg=W;this.RZa();this.onVisibilityChange()}setVisibility(W){this.s_c=!W;this.onVisibilityChange()}onVisibilityChange(){!this.s_c&&
(this.hUa||this.gUa||this.fIg)?(this.updatePosition(this.frame.fBa(this.comment.pos.X,this.comment.pos.Y)),this.nm.style.display="block",pg.a.bI(this.nm,xf.a.zFc)):(this.nm.style.display="none",pg.a.sIa(this.nm,xf.a.zFc))}get Uo(){return this.VEa.d_i(this.A8)}get oad(){return this.VEa.e_i(this.A8)}RZa(){this.Tz.className=ld.hKc(this.A8)?this.hUa?ye.getImageClassWithCluster(this.frame.iS,this.jC.nUg):this.gUa?ye.getImageClassWithCluster(this.frame.iS,this.jC.lUg):ye.getImageClassWithCluster(this.frame.iS,
this.jC.mUg):this.hUa?ye.getImageClassWithCluster(this.frame.iS,this.jC.iUg):this.gUa?ye.getImageClassWithCluster(this.frame.iS,this.jC.Ste):ye.getImageClassWithCluster(this.frame.iS,this.jC.kdc)}MB(W){if(W.dA!==Sys.UI.MouseButton.leftButton)return!1;this.frame.selectComment(this.A8,null,!1,!0,W.Wf,1,!1);W=W.mc;W.preventDefault();W.stopPropagation();return!0}zva(){this.Tz.className=ye.getImageClassWithCluster(this.frame.iS,this.jC.Ste)}Gdc(){this.Tz.className=ye.getImageClassWithCluster(this.frame.iS,
this.jC.kdc)}phc(W){W.preventDefault()}}Object(h.a)(qe,"ModernCommentMarkerViewElement",null,[1100]);class Oh{constructor(W,xa,da,Fa,Ua,cb){this.VEa=W;this.YYc=xa;this.jC=da;this.q9b=Ua;this.Nyb=cb;Fa.Qqb().then(Jb=>{Jb||this.VLe(!1)})}dispose(){this.jC=null}create(W,xa,da,Fa,Ua,cb){if(this.q9b){const Jb=this.VEa.Hej(W);return new qe(W,Jb||xa,da,Fa,this.jC,this.VEa,this.YYc,Ua,cb)}return new Ff(W,xa,da,Fa,this.jC,Ua,cb,this.Nyb)}VLe(W){this.Nyb=this.q9b=W;this.jC.VLe(W)}}Object(h.a)(Oh,"CommentMarkerViewElementFactory",
null,[1059,106]);var Cf=d(77);class Bg extends Cf.a{constructor(){super()}k8h(W){this.addHandler(Bg.ivh,W)}yXg(){this.raiseEvent(Bg.ivh)}}Bg.ivh="S";Object(h.a)(Bg,"ATransactionCompletedProcessor",Cf.a,[1099]);var Gf=d(36);class dh extends Bg{constructor(W,xa,da){super();this.qbk=W;this.T_c=xa;this.VW=da}get index(){return 0}run(){this.qbk()}ERf(W,xa){xa.property!==ue.a.qba&&xa.property!==ue.a.Gqa&&xa.property!==ue.a.commentId&&xa.property!==ue.a.LWb&&xa.property!==ue.a.MWb&&xa.property!==ue.a.Bnc&&
xa.property!==ue.a.Anc||this.yXg()}oRf(W,xa){xa.property!==Gf.a.BA&&xa.property!==ue.a.LWb||this.yXg()}Puj(){this.T_c.vd(39).Yj(Object(Ca.a)(this,this.oRf,"commentContentPropertyChanged"));this.T_c.vd(40).Yj(Object(Ca.a)(this,this.ERf,"commentPropertyChanged"));this.VW.M2k(this)}Htl(){this.T_c.vd(40).tm(Object(Ca.a)(this,this.ERf,"commentPropertyChanged"));this.T_c.vd(39).tm(Object(Ca.a)(this,this.oRf,"commentContentPropertyChanged"))}}Object(h.a)(dh,"CommentPropertyTracker",Bg,[]);var qg=d(899),
Pf=d(128);class qd extends qg.a{constructor(){super();this.comment=this.commentId=null;this.H_=Object.assign(new Pf.a,{T_:qd.getTypeName(),B_:qd.ul()})}static getTypeName(){return"AugLoop_SmartReply_CommentSmartReplySignal"}static ul(){return["AugLoop_Signals_Signal"]}}Object(h.a)(qd,"CommentSmartReplySignal",qg.a,[]);var Tf=d(599);class Pg extends Tf.a{constructor(){super();this.DomainName=this.CommentId=null;this.ConfidenceLevel=0;this.ElapsedTime=this.ResultSets=null;this.H_=Object.assign(new Pf.a,
{T_:Pg.getTypeName(),B_:Pg.ul()})}static getTypeName(){return"AugLoop_SmartReply_SmartReply"}static ul(){return["AugLoop_Core_Annotation"]}}Object(h.a)(Pg,"SmartReply",Tf.a,[]);var Ee=d(454),xe=d(426);class jh{constructor(W,xa){this.lLh=W;this.NYe=xa}initialize(){this.NYe.execute(W=>{const xa=Pg.getTypeName();W.Pnb(xa);W.cjc(xa,Object(Ca.a)(this,this.pRa,"handleAnnotationEvent"))})}invoke(W,xa){const da=Object.assign(new Ee.a,{parentPath:["Signal",qd.getTypeName()],items:[Object.assign(new xe.a,{body:Object.assign(new qd,
{commentId:W,comment:xa})})]});this.NYe.execute(Fa=>{Fa.submitOperation(da)})}pRa(W){if(W){var xa=new r.a;if(W&&W.CommentId&&W.ResultSets&&0<W.ResultSets.length&&W.ResultSets[0].Documents&&0<W.ResultSets[0].Documents.length){for(const da of W.ResultSets[0].Documents)xa.add(da.Caption);0<xa.count&&this.lLh.czk(W.CommentId,xa.toArray())}else Wb.a.J(557593412,327,10,"Invalid response from SmartReplies request")}else Wb.a.J(557593411,327,50,"Smart reply invocation returned null annotations.")}}Object(h.a)(jh,
"CommentSmartReplyProvider",null,[]);var yg=d(308),xc=d(284),me=d(279),Dd=d(96),Qe=d(179),tf=d(124),Rb=d(61),Jc=d(425);class Qc{constructor(W,xa,da,Fa,Ua){this.khe=this.Qhe=this.mie=this.jYc=0;this.qGg=new r.a;this.Dse=this.zGg=this.mhe=this.Jbc=this.Uoe=0;this.vqe=new r.a;this.Ffe=this.Efe=this.Gfe=this.Dfe=0;this.SEg=new r.a;this.A4c=new r.a;this.Ohe=this.Mhe=this.Nhe=this.Phe=this.dme=this.cme=this.eme=this.fme=0;this.mYc=this.cle=this.aZc=Tb.App.Mm;this.RUa=null;this.yse=this.zse=this.C5c=this.Y5c=
this.R3c=this.Cfe=0;if(!W)throw Error.argumentNull("coreEventHandler");if(!xa)throw Error.argumentNull("appSettingsManager");this.Mc=W;this.fc=xa;this.ua=da;this.PA=Fa;this.fhe=Ua;this.Mc.JB(Object(Ca.a)(this,this.to,"onSessionRehydrated"));this.Mc.IB(Object(Ca.a)(this,this.gB,"onSessionEnd"))}get qPd(){return this.fc.ka("CommentTextAnchoringCreateNewEnabled")}get Jml(){return this.fc.ka("TasksForCommentsEnabled")}Cee(W,xa,da,Fa){this.jYc+=1;this.khe+=xa;da&&(this.Dfe+=1,this.vqe.add(W));Fa&&(this.Cfe+=
1)}lXj(W,xa,da,Fa){this.C5c=Fa?this.C5c+1:this.C5c;this.Cee(W,xa,da,Fa)}kXj(W,xa,da,Fa,Ua){(Ua=!!Ua)&&Fa?this.zse+=1:Ua&&(this.yse+=1);this.Cee(W,xa,da,Ua)}n_j(){this.Gfe+=1}k_j(){this.Efe+=1}l_j(){this.Ffe+=1}m_j(W,xa,da,Fa){this.Cwg(W.commentId)||(da&&!this.aRj(xa,da.AD(),Fa)?this.SDg(W,da,!0):this.SDg(W,da,!1))}wLk(){this.Qhe+=1}b_j(){this.Phe+=1}VXj(){this.Nhe+=1}UXj(){this.Mhe+=1}WXj(){this.Ohe+=1}$Xj(){this.mie+=1}lZj(W){this.qGg.contains(W)||(this.Uoe+=1,this.qGg.add(W))}LZj(W){this.R3c=W?
this.R3c+1:this.R3c;this.Jbc+=1}B_j(W){this.Y5c=W?this.Y5c+1:this.Y5c}MZj(){this.Jbc+=1}Fee(W,xa,da){this.mhe=W;this.Dse=xa;this.SEg=da;this.CDg()}RXj(W){this.zGg=W?1:2}Mkk(W){this.aZc===Tb.App.Mm&&(this.aZc=new Date,this.EEa("OnCollabCornerCommentsEnabled",this.aZc,W),this.HJe("CollabCornerCommentsEnabled",this.aZc))}hmk(W){this.cle===Tb.App.Mm&&(this.cle=new Date,this.EEa("OnFloatingCommentsRendered",this.cle,W))}Ljk(W){this.mYc===Tb.App.Mm&&(this.mYc=new Date,this.EEa("OnAllFloatingContainersVisible",
this.mYc,W),this.HJe("AllFloatingContainersVisible",this.mYc))}jlk(W){const xa=new Date;this.EEa("OnDeepLinkedCommentSelected",xa,W);this.HJe("DeepLinkedCommentSelected",xa)}Cwg(W){return this.SEg.contains(W)||this.A4c.contains(W)}aRj(W,xa,da){let Fa=0;for(const cb of xa)if(xa=Object(pb.a)(419,cb.oc(da))){xa=xa.htmlElement.getElementsByClassName(Dd.a.aYb);for(let Jb=0;Jb<xa.length;Jb++){var Ua=xa[Jb];const Gc=yg.a.te(Ua,Dd.a.oPd);Gc&&(Fa+=Lc.a.contains(Gc,W)?1:0);(Ua=yg.a.te(Ua,Dd.a.kPd))&&(Fa+=Lc.a.contains(Ua,
W)?1:0);if(2===Fa)return!0}}return!1}SDg(W,xa,da){if(W&&W.textAnchoringInfo&&!this.Cwg(W.commentId))if(W.textAnchoringInfo.EndPos<=W.textAnchoringInfo.StartPos){if(xa){if(da){this.dme+=1;this.A4c.add(W.commentId);return}this.eme+=1}else this.fme+=1;this.A4c.add(W.commentId)}else 0>=W.textAnchoringInfo.TextBodyLength&&(this.vqe.contains(W.commentId)?this.vqe.remove(W.commentId):(this.cme+=1,this.A4c.add(W.commentId)))}EEa(W,xa,da){const Fa={};Fa.Event=W;Fa.Time=xa.getTime();Fa.SlideId=da.toString();
Fa.LandingSlide=this.Z7i();Fa.SessionDimensions=this.T2d();Fa.PerfMetrics=this.q_i();Fa.CommentPerfMetrics=this.K1i();Fa.CommentFileType=this.fhe;Fa.CommentDeepLinkedOpen=!!this.fc.Ga("CurrentCommentId");Fa.StandaloneCommentJsEnabled=!0;Fa.LoadSharedCommentsEarly=!0;Fa.FetchFullAppSettingsOnBoot=this.fc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.FetchFullAppSettingsOnBoot",!1);Fa.PrefetchCommentCloudPolicy=this.fc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.PrefetchCommentCloudPolicy",
!1);Wb.a.J(509703831,805,15,nb.c(Fa))}CDg(){Wb.a.J(509703830,805,15,"Comment(s) - OnOpen:{0}; FileType:{1}",this.mhe,this.fhe);Wb.a.J(509703829,805,15,"Text Anchor(s) - OnOpen:{0}",this.Dse);Wb.a.J(509703828,805,15,"Comment/Tasks BRSs - TextAnchoringCreateNewEnabled:{0}; TasksForCommentsEnabled:{1}; ",this.qPd,this.Jml)}log(){Wb.a.J(509703827,805,15,"Comment(s) - Added:{0}; Edited:{1}; Deleted:{2}; AverageLength:{3}; Moved:{4}; Resolved:{5}; OnOpen:{6}; FileType:{7}; CreateNewPolicy:{8}",this.jYc,
this.mie,this.Qhe,this.khe/this.jYc,this.Uoe,this.Jbc,this.mhe,this.fhe,this.zGg);Wb.a.J(509703826,805,15,"Text Anchor(s) - OnOpen:{0}; Added:{1}; WithMultiPara:{2}; InSmartArt{3}; InTable:{4}; InvalidStartEndPos:{5}; InvalidBodyLength:{6}; InvalidShape:{7}; InvalidTextDelete:{8}",this.Dse,this.Dfe,this.Gfe,this.Efe,this.Ffe,this.eme,this.cme,this.fme,this.dme);Wb.a.J(509703825,805,15,"Deleted Comment(s) - Single:{0}; InSlide:{1}; InPresentation:{2}; Resolved:{3}",this.Phe,this.Nhe,this.Mhe,this.Ohe);
this.i_j()}i_j(){Wb.a.J(509703824,845,15,"Task(s) - Added:{0}",this.Cfe);const W={};W.ResolvedTasksCount=this.R3c;W.UnresolvedTasksCount=this.Y5c;W.TasksCreatedNewThreadCount=this.C5c;W.TasksReassignedInReplyCount=this.zse;W.TasksCreatedInReplyCount=this.yse;Wb.a.J(509703823,845,15,nb.c(W))}to(){this.CDg()}gB(){this.log()}Z7i(){if(this.RUa)return this.RUa;this.RUa={};var W=parseInt(this.fc.Ga("CurrentSlideId"));W=W!==Rb.a.empty.sid?Rb.a.tE(W,0):this.ua.presentation.cub(0);if(!W)return this.RUa;this.RUa.SlideId=
W.toString();if(W=this.ua.presentation.k3d(W.sid))W=Object(pb.a)(120,W).xD(),this.RUa.HasComments=this.PA.elg(W),this.RUa.HasActiveComments=this.PA.Skg(W);return this.RUa}T2d(){const W={};W.Ring=e.AFrameworkApplication.$c.Ring;W.Host=e.AFrameworkApplication.$c.Host;W.UiHost=e.AFrameworkApplication.$c.UiHost;W.SessionOrigin=e.AFrameworkApplication.$c.SessionOrigin;W.ApplicationMode=e.AFrameworkApplication.$c.ApplicationMode;W.Browser=e.AFrameworkApplication.$c.Browser;W.Os=e.AFrameworkApplication.$c.Os;
return W}q_i(){const W={};W[xc.a.XKb]=Lb.a.instance.$g(xc.a.XKb);W.DocPageNavigationStart=Lb.a.instance.$g("DocPageNavigationStart");W[xc.a.Z_b]=Lb.a.instance.$g(xc.a.Z_b);W[Jc.a.mHe]=Lb.a.instance.$g(Jc.a.mHe);W[Jc.a.lHe]=Lb.a.instance.$g(Jc.a.lHe);W[Jc.a.rhh]=Lb.a.instance.$g(Jc.a.rhh);W[Jc.a.rWd]=Lb.a.instance.$g(Jc.a.rWd);W[Jc.a.sWd]=Lb.a.instance.$g(Jc.a.sWd);W[Jc.a.qWd]=Lb.a.instance.$g(Jc.a.qWd);W[Jc.a.lOd]=Lb.a.instance.$g(Jc.a.lOd);W[xc.a.Lod]=0<me.a.instance.Qch();return W}K1i(){const W=
{};W[fc.a.nPd]=Lb.a.instance.$g(fc.a.nPd);W[fc.a.sPd]=Lb.a.instance.$g(fc.a.sPd);W[fc.a.Q3b]=Lb.a.instance.$g(fc.a.Q3b);W[fc.a.Z7d]=Lb.a.instance.$g(fc.a.Z7d);W[fc.a.FMe]=Lb.a.instance.$g(fc.a.FMe);W[fc.a.f4b]=Lb.a.instance.$g(fc.a.f4b);W[fc.a.$7d]=Lb.a.instance.$g(fc.a.$7d);W[fc.a.mee]=Lb.a.instance.$g(fc.a.mee);W[fc.a.eYd]=Lb.a.instance.$g(fc.a.eYd);W[fc.a.fYd]=Lb.a.instance.$g(fc.a.fYd);W[fc.a.Qid]=Lb.a.instance.$g(fc.a.Qid);W[fc.a.oRd]=Lb.a.instance.$g(fc.a.oRd);W[fc.a.nRd]=Lb.a.instance.$g(fc.a.nRd);
return W}zej(){const W=Lb.a.instance.$g("DocPageNavigationStart");if(!Lb.a.instance.$g(xc.a.XKb))return W;const xa=Lb.a.instance.$g(xc.a.XKb);return 6E4>W-xa?xa:W}HJe(W,xa){const da=[];Array.add(da,Object.assign(new tf.a,{name:"EventName",string:W}));Mb.a.sendActivityEvent(Object.assign(new Qe.a,{name:"CommentsBootEvents",durationMs:xa.getTime()-this.zej(),dataFields:da}))}}Object(h.a)(Qc,"CommentTelemetryManager",null,[1085]);var Ph=d(669),ng=d(670),se=d(671);class pf extends Ph.a{constructor(W,
xa){super();this.P4j=W;this.yi=xa;this.Ele=[new ng.a(Dd.a.rRf,null),new ng.a(Dd.a.sRf,null),new ng.a(Dd.a.tRf,null),new ng.a(Dd.a.wRf,null),new ng.a(Dd.a.ARf,null),new ng.a(Dd.a.BRf,null),new ng.a(Dd.a.zRf,null),new ng.a(Dd.a.uRf,null),new ng.a(Dd.a.vRf,null),new ng.a(Dd.a.xRf,null),new ng.a(Dd.a.yRf,null)]}get isInHighContrastMode(){return!!this.yi&&this.yi.isInHighContrastMode}get Kub(){return this.P4j}get M6d(){return this.Ele}Vec(W,xa){var da=this.OZ.cia;if(da&&0===da.type&&(da=this.OZ.cia.sca,
da=Object(v.a)(Array,da)?da:null)){var Fa=null,Ua=null,cb=new Ka.a;for(const Jb of da)Jb.Pfc.isValid&&Array.contains(Jb.Pfc.paragraphs,W)&&(0===Jb.state?Fa=Jb.commentId:1===Jb.state&&(Ua=Jb.commentId),cb.$(Jb.commentId,Jb.Pfc));this.zai(xa.querySelectorAll("*"),cb,W,Fa,Ua)}}k4b(W,xa){W=Object(v.a)(Array,W)?Array.isArray(W)?W:null:null;if(!W||0<W.length&&!Object(pb.a)(gc,W[0]))return xa;for(const da of W)if(da.Pfc.isValid)for(const Fa of da.Pfc.paragraphs)Fa&&(se.b(Fa),xa.add(Fa));return xa}vRi(W,
xa){W=W.TJa;const da=xa?pf.Q1j:pf.R1j;xa=dd.a.a$f(W,xa?pf.D6j:pf.E6j);W=dd.a.a$f(W,da);return xa<W}zai(W,xa,da,Fa,Ua){const cb=new pa.a,Jb=new pa.a;for(let Ld=0;Ld<W.length;Ld++){const de=W[Ld];this.yed(de);if(!de.parentNode)continue;var Gc=yg.a.te(de,Dd.a.oPd),pd=yg.a.te(de,Dd.a.kPd);const Be=[!1,!1,!1];if(Gc)for(const Mf of Gc)if(xa.Jb(Mf)){Gc=xa.ga(Mf).sag(da);if(xa.ga(Mf).glg||(2===Gc||0===Gc)&&!this.isInHighContrastMode&&this.vRi(xa.ga(Mf),Mf===Ua))xa.ga(Mf).glg=!0,cb.add(Mf);Jb.add(Mf);this.xYf(xa,
da,Mf,Fa,Ua,Be,!0)}if(pd)for(const Mf of pd)Jb.contains(Mf)&&(Jb.remove(Mf),cb.remove(Mf),this.xYf(xa,da,Mf,Fa,Ua,Be,!1));if(0!==se.a(de)){pd=(Gc=0<cb.count)&&!!Ua&&cb.contains(Ua);const Mf=!!Fa&&Jb.contains(Fa),Dg=!!Ua&&Jb.contains(Ua);0<Jb.count&&!this.isInHighContrastMode&&0<=de.parentNode.className.indexOf(Dd.a.UJa)&&(pg.a.bI(de.parentNode,Dd.a.rRf),Dg?pg.a.bI(de.parentNode,pd?Dd.a.vRf:Dd.a.uRf):Mf?(pg.a.bI(de.parentNode,Dd.a.sRf),Gc=de.parentNode.className.match(new RegExp("\\b"+Dd.a.zmg+"\\b")),
(!Gc||1>Gc.length)&&pg.a.bI(de.parentNode,Dd.a.tRf)):pg.a.bI(de.parentNode,Gc?Dd.a.BRf:Dd.a.ARf));Be[1]?pg.a.bI(de,pd?Dd.a.yRf:Dd.a.xRf):Be[0]?pg.a.bI(de,Dd.a.wRf):Be[2]&&pg.a.bI(de,Dd.a.zRf)}}}xYf(W,xa,da,Fa,Ua,cb,Jb){W=W.ga(da).sag(xa);if(2===W||(Jb?0===W:1===W))Fa&&Fa.equals(da)&&(cb[0]=!0),Ua&&Ua.equals(da)&&(cb[1]=!0),cb[2]=!0}}pf.E6j="#F5E7F6";pf.R1j="#503355";pf.D6j="#F2E1F4";pf.Q1j="#4C3050";Object(h.a)(pf,"CommentTextAnchorHighlightActor",Ph.a,[]);class $d{constructor(W){let xa;this.oSh=
20;xa=W?W="SharedCommentBubble":W="SharedCommentBubbleSelected";this.jSh=this.nQa("SharedCommentBubble");this.iSh=this.nQa("SharedCommentBubbleHover");this.Uff=this.nQa(W);this.nSh=this.nQa("SharedCommentBubble");this.mSh=this.nQa("SharedCommentBubbleHover");this.Vff=this.nQa(xa);this.kSh="ModernCommentMarkerElementSingle cui-img-cont-float";this.lSh="ModernCommentMarkerElementWithReplies cui-img-cont-float"}get jUg(){return this.kSh}get kUg(){return this.lSh}get Tte(){return this.oSh}get kdc(){return this.jSh}get Ste(){return this.iSh}get iUg(){return this.Uff}get mUg(){return this.nSh}get lUg(){return this.mSh}get nUg(){return this.Vff}VLe(W){const xa=
W?this.kdc:"SharedCommentBubbleSelected";W=W?this.kdc:xa;this.Uff=this.nQa(xa);this.Vff=this.nQa(W)}nQa(W){return String.format("{0}_{1}x{2}x32",W,this.Tte,this.Tte)}}Object(h.a)($d,"CommentViewHelper",null,[]);class Ye{constructor(W,xa,da,Fa,Ua,cb){this.Mc=W;this.ua=xa;this.yb=da;this.iPg=Fa;this.hb=cb;this.iPg.nG(Object(Ca.a)(this,this.u$c,"onSlideOrderChanged"));this.Mc.$4h(Object(Ca.a)(this,this.HZg,"onCommentsChanged"))}dispose(){this.Mc.$Qk(Object(Ca.a)(this,this.HZg,"onCommentsChanged"));this.iPg.yO(Object(Ca.a)(this,
this.u$c,"onSlideOrderChanged"))}HZg(){const W=this.ua.Ba;D.a.cob(this.yb,()=>{this.tzk(W)})}u$c(W,xa){if(2===xa.lZ){const da=this.ua.Ba;D.a.cob(this.yb,()=>{this.y7g(da)})}}y7g(W){this.ua.Ba===W&&W&&this.hb.WZa(!0)}tzk(W){this.y7g(W)}}Object(h.a)(Ye,"CommentsChangeListener",null,[106]);var Kd=d(141),Yd=d(276),Zf=d(169);class ef{static lBa(W,xa,da,Fa,Ua,cb,Jb){const Gc=oe.a.SB();Gc.alt=cb;Gc.className=ye.getImageClassWithCluster(xa,Ua);Gc.setAttribute(Rd.a.Ye,Rd.a.hu);Gc.src=W.hk(xa+".png");Gc.setAttribute("Unselectable",
"on");W=oe.a.Fn();W.className=da+" cui-img-cont-float";W.setAttribute(Rd.a.Ye,Rd.a.hu);W.appendChild(Gc);da=oe.a.Fn();da.className=Fa;da.setAttribute("Unselectable","on");da.setAttribute(Rd.a.Ye,Rd.a.hu);da.appendChild(W);Fa=oe.a.vba();Fa.className=ef.yYk+" cui-ctl";Fa.title=cb;Fa.setAttribute(Rd.a.Ye,Rd.a.hu);Fa.setAttribute(Rd.a.Wr,cb);Fa.appendChild(da);Jb&&(cb=oe.a.Fn(),cb.className="cui-ctl-mediumlabel",cb.setAttribute("Unselectable","on"),cb.setAttribute(Rd.a.Ye,Rd.a.hu),cb.innerText=Jb,Fa.appendChild(cb));
return Fa}static mBa(W,xa){return ef.lBa(W,W.iS,"cui-img-16by16","cui-ctl-iconContainer",xa,CommonUIStrings.l_DialogClose,null)}}ef.wYk="CommentPaneLTR";ef.xYk="CommentPaneRTL";ef.yYk="CommentPaneWithBorderButton";ef.MYk=300;Object(h.a)(ef,"CommentPaneHelper",null,[]);var Ke=d(47);class gi{constructor(W,xa,da,Fa,Ua){this.S9b=this.wGa=null;new Yd.a(0,0,0,0);this.EUa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.rGg=null;this.Xqh=!1;this.YG=Ua;
this.MI=W;this.Ob=xa;this.YG||(this.wGa=document.createElement("div"),this.wGa.className="CommentPanel",this.wGa.style.position="absolute");this.Db=!1;this.cX=da;this.lSg=Fa}dispose(){}layout(W,xa){if(this.EUa)return W;if(null===W)throw Error.argumentNull("availableArea");const da=xa?W.PC(this.width):W.QC(this.width);this.isVisible&&(xa?da.PC(1):da.QC(1));this.YG||oe.a.A0(this.wGa,da);return W}Z6d(W){this.S9b=W}p3k(W){this.rGg=W}kp(W,xa){this.Db=W;this.EUa?this.YG?this.bM(this.Db):this.lSg.bM(this,
this.Db,ResourceStrings.L_Comments,Ke.a.Op):(this.Ob.Hdb(this.cX&&xa?1:2),this.MI.updateCommandUI())}bM(W){Kd.UISurfaces.Ms().then(xa=>{W?xa.showTaskPane(Ke.a.Op,this.rGg):xa.hideTaskPane(Ke.a.Op,2);return null}).catch(xa=>{Wb.a.J(572339907,833,10,"CommentsPane::ShowHidePane exception: {0}. isVisible: {1}",xa.toString(),W.toString())})}zJe(){Kd.UISurfaces.Ms().then(W=>{W.setSelectedTaskPane(Ke.a.Op);return null}).catch(W=>{Wb.a.J(572339909,833,10,"CommentsPane::SelectPane exception: {0}",W.toString())})}a0k(){try{this.YG?
this.zJe():this.lSg.zJe(Ke.a.Op)}catch(W){Wb.a.J(592591050,805,100," Task pane couldn't be selected as it is not present in tabbed task pane group",W)}}Hdb(W){this.Ob.Hdb(this.cX&&W?1:2)}get isVisible(){return this.Db}get xa(){return this.wGa}get order(){return 18}get width(){return this.isVisible?ef.MYk+1:0}}Object(h.a)(gi,"CommentsPane",null,[1064,716,106,1081]);class Rf{constructor(){this.PXa=this.BJa=0;this.Vc=this.sYa=this.Qha=null}}Object(h.a)(Rf,"FindCommentContext",null,[]);var Uf;(function(W){W[W.findNextComment=
0]="findNextComment";W[W.findPreviousComment=1]="findPreviousComment";W[W.findNextActiveComment=2]="findNextActiveComment";W[W.findPreviousActiveComment=3]="findPreviousActiveComment"})(Uf||(Uf={}));Object(h.b)("FindCommentRequestType",Uf);class Ed{constructor(W,xa,da,Fa,Ua,cb){this.uc=W;this.ua=xa;this.Wke=da;this.JN=Fa;this.YKg=Ua;this.xd=new Rf;this.v3j=cb}get bBa(){return this.v3j.value}dispose(){this.Wke.dispose();this.xd=this.Wke=null}GXd(W,xa,da){this.CXd(0,!1,W,xa,da)}NXd(W,xa,da){this.CXd(1,
!1,W,xa,da)}HXd(W,xa){this.CXd(0,!0,W,xa,!1)}CXd(W,xa,da,Fa,Ua){var cb=this.ua.presentation;if(!cb)throw Error.argumentNull("Presentation is null");Fa||(Fa=Xd.a.Pl("FindComment",0),Fa.Wa("FindCommentRequestType",Uf[W]));Fa.Wa(Ed.EMd,"true");if(this.YKg&&this.ua.Ba){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const Jb=this.ua.Ba.we;cb=cb.slides||[];this.xd.Qha=da;this.xd.PXa=Ed.y5i(W,Ua);this.xd.Vc=Fa;xa?this.DXd(cb[Jb>=cb.length-1?0:Jb+1]):1===W?this.p5f(cb,Jb-1,Ua):this.m5f(cb,
Jb+1,Ua)}else Fa.Wa(Ed.Hii,this.YKg.toString()),da(null,null,!1,!1)}m5f(W,xa,da){this.xd.sYa=null;this.xd.BJa=xa;for(let Fa=xa;Fa<W.length;Fa++)if(W[Fa]&&this.qzg(W[Fa])){const Ua=this.D5i(W[Fa],da);if(Ua){this.xd.Qha(W[Fa],Ua,!1,!1);return}}else{this.DXd(W[Fa]);return}0<xa?this.PTi(da):this.notFound()}p5f(W,xa,da){this.xd.sYa=null;this.xd.BJa=xa;for(let Fa=xa;-1<Fa;Fa--)if(W[Fa]&&this.qzg(W[Fa])){const Ua=this.e8i(W[Fa],da);if(Ua){this.xd.Qha(W[Fa],Ua,!1,!1);return}}else{this.DXd(W[Fa]);return}xa<
W.length-1?this.XTi(da):this.notFound()}DXd(W){this.xd.Vc.Om(Ed.lji,new Date);W&&this.Wke.find(W.Bb,this.xd.PXa,Object(Ca.a)(this,this.oqk,"onServerFindSucceeded"),Object(Ca.a)(this,this.nqk,"onServerFindFailed"))}oqk(W){this.xd.Vc.sB(Ed.EMd,"false");this.xd.Vc.Om(Ed.BMf,new Date);this.xd.Vc.Wa(Ed.jMf,"true");W?(this.xd.sYa=W,-1===this.E1b(this.xd.sYa.TargetSlideId)?this.notFound():this.xd.Qha(this.Jol(this.xd.sYa.TargetSlideId),this.xd.sYa.TargetComment,this.xd.sYa.IsFirstComment,this.xd.sYa.IsLastComment)):
this.notFound()}nqk(){this.xd.Vc.sB(Ed.EMd,"false");this.xd.Vc.Om(Ed.BMf,new Date);this.xd.Vc.Wa(Ed.jMf,"false");Wb.a.J(512496786,805,50,"OnServerFindFailed");this.notFound()}PTi(W){var xa=this.ua.presentation;if(!xa)throw Error.argumentNull("Presentation is null");xa=xa.slides||[];Lc.a.Va(xa)?this.notFound():this.m5f(xa,0,W)}XTi(W){var xa=this.ua.presentation;if(!xa)throw Error.argumentNull("Presentation is null");xa=xa.slides||[];Lc.a.Va(xa)?this.notFound():this.p5f(xa,xa.length-1,W)}D5i(W,xa){W=
this.uc.kl(W.Bb);if(this.bBa){const da=(W=this.JN.Q6a(W))?W.length:0;for(let Fa=0;Fa<da;Fa++){const Ua=W[Fa];if(Ed.yAg(Ua,xa))return Ua}return null}return this.JN.ATi(W,xa)}e8i(W,xa){W=this.uc.kl(W.Bb);if(this.bBa){var da=(W=this.JN.Q6a(W))?W.length:0;for(--da;0<=da;da--){const Fa=W[da];if(Ed.yAg(Fa,xa))return Fa}return null}return this.JN.MTi(W,xa)}qzg(W){return W.DD}E1b(W){var xa=this.ua.presentation;if(!xa)throw Error.argumentNull("Presentation is null");if(W){xa=xa.slides||[];W=new Rb.a(W);for(let da=
0;da<xa.length;da++)if(xa[da]&&Rb.a.DFc(xa[da].Bb,W))return da}return-1}Jol(W){return W?this.uc.Via(new Rb.a(W)):null}notFound(){this.xd.Qha&&this.xd.Qha(null,null,!1,!1)}static y5i(W,xa){if(xa)switch(W){case 0:return 2;case 1:return 3}return W}static yAg(W,xa){return!xa||0===W.status}}Ed.EMd="IsCompletedSearchInClient";Ed.lji="ServerSearchStartTime";Ed.BMf="ServerSearchEndTime";Ed.jMf="IsServerSearchSucceeded";Ed.Hii="IsBRSOn";Object(h.a)(Ed,"FindCommentLogic",null,[1062,106]);var vg=d(78);class Jd{constructor(){this.type=
0;this.Qha=this.Vc=null;this.hHd=!1}}Object(h.a)(Jd,"Entry",null,[]);class Ie{constructor(W,xa){this.g_c=null;this.Dp=W;this.yb=xa;this.lla=[];this.Noe=0}dispose(){this.Dp.dispose();this.lla=this.Dp=null;Wb.a.J(25985481,805,50,"MaxQueuedEntryNum: {0}",this.Noe)}GXd(W,xa,da){this.enqueue(1,W,xa,da)}NXd(W,xa,da){this.enqueue(0,W,xa,da)}HXd(W,xa){this.enqueue(2,W,xa,!1)}enqueue(W,xa,da,Fa){da.Wa("AlreadyQueuedEntryCount",this.lla.length.toString());W=Object.assign(new Jd,{type:W,Qha:(Ua,cb,Jb,Gc)=>{xa(Ua,
cb,Jb,Gc);this.g_c=null;this.k6g()},Vc:da,hHd:Fa});Array.enqueue(this.lla,W);this.Noe=Math.max(this.Noe,this.lla.length);this.k6g()}k6g(){0<this.lla.length&&!this.g_c&&(this.g_c=new vg.a(2,1,0,Object(Ca.a)(this,this.uDk,"processOneEntry"),90,"49"),this.yb.Cb(this.g_c))}uDk(){const W=Array.dequeue(this.lla);1===W.type?this.Dp.GXd(W.Qha,W.Vc,W.hHd):0===W.type?this.Dp.NXd(W.Qha,W.Vc,W.hHd):this.Dp.HXd(W.Qha,W.Vc)}}Object(h.a)(Ie,"FindCommentLogicDecorator",null,[1062,106]);var gf=d(378),eh=d(107);class rg extends eh.a{constructor(W,
xa){super();this.StartSlideId=null;this.RequestType=0;this.FFindModernComments=!1;if(null===W)throw Error.argumentNull("slideId");this.RequestType=xa;this.StartSlideId=W.toString();this.FFindModernComments=!0}Ok(){return 88}}Object(h.a)(rg,"FindCommentRequest",eh.a,[]);class Cg extends gf.a{constructor(W){super();this.HVa=null;this.OPg=0;this.QGa=this.mFa=null;this.enabled=2;this.mAb=0;this.zk=!1;this.Bm=W;this.Bm.register(this)}dispose(){this.zk||(1===this._state&&this.Bm.unregister(this),this.zk=
!0,this.mAb=0)}find(W,xa,da,Fa){0<this.mAb&&null!==da&&(Wb.a.J(523249091,805,15,"FindCommentReplicator::Find() - NumPendingFindRequests={0}",this.mAb),da(null));this.HVa=W;this.OPg=xa;this.fF(da,Fa,null)}fja(){return 0<this.mAb&&!this.zk}$P(){return!1}GRa(){return this.Iyg||this.fja()}$Fb(){if(1===this._state)this.Od.oH=new rg(this.HVa,this.OPg),this.Od.status=1,this._state=3;else if(3===this._state&&this.Iyg)if(Wb.a.J(523249092,805,50,"FindCommentRequest EnqeueTime={0}, InvokedTime={1}, CompletedTime={2}",
this.Od.kfd,this.Od.Kt,this.Od.Wu),2===this.Od.statusCode&&this.Od.Gr&&1===this.Od.Gr.length){const W=this.Od.Gr[0];0!==W.StatusCode?this.jH(W):this.e0(W)}else this.jH()}fF(W,xa){this.mAb++;this.QGa=W;this.mFa=xa;this.Bm.s$()}forceOutbound(){}jH(W=null){Wb.a.J(523249094,805,50,"FindCommentReplicator Inbound failed: HttpStatusCode={0}, OperationStatusCode={1}, FindCommentResponseStatusCode={2}",this.Od.gv,this.Od.statusCode,W?W.StatusCode:-1);this.i0g(W,!1)}e0(W){this.i0g(W,!0)}get Iyg(){return!!this.Od&&
2===this.Od.status}i0g(W,xa){this.mAb--;this._state=1;if(xa){xa=null;try{xa=Sys.Serialization.JavaScriptSerializer.deserialize(W.FindCommentResult)}catch(da){Wb.a.J(523249095,805,10,"Cannot parse find comment result: {0}",da)}this.QGa(xa)}else this.mFa(null,-1)}}Object(h.a)(Cg,"FindCommentReplicator",gf.a,[106]);class kh{constructor(){this.nt=null;this.Fqc=this.usf=this.KYe=this.szc=this.qBf=this.ihf=this.ruf=!1}efj(){this.nt||(m.ULS.sendTraceTag(588292828,327,10,"OfficeSharedCommentsAppCapabilities: AppSettings object should not be empty"),
this.voh());return this.nt}N9i(){return new Promise((W,xa)=>{this.Fqc?W(this.$cg()):this.smh().then(()=>{W(this.$cg())}).catch(da=>{xa(da)})})}$cg(){this.Fqc||m.ULS.sendTraceTag(588292829,327,10,"OfficeSharedCommentsAppCapabilities: GetModelCapabilitiesInternal should not be called before AtMentions are resolved");let W;W=33;this.KYe&&(W|=2);this.ruf&&(W|=8);this.qBf&&(W|=16);this.ihf&&(W|=4);this.szc&&(W|=64);this.usf&&(W|=128);return W}}Object(h.a)(kh,"OfficeSharedCommentsAppCapabilities",null,
[1521]);class De extends kh{constructor(W,xa,da,Fa,Ua,cb){super();this.fc=W;this.Ha=xa;this.EOg=da;this.v7j=cb;this.S7k(Fa,Ua);this.voh();this.smh()}S7k(W,xa){this.szc=this.fc.ka("TasksForCommentsEnabled")&&!W;this.qBf=!1;this.ruf=xa;this.usf=this.ihf=!0}voh(){this.nt={};const W=this.szc&&e.AFrameworkApplication.fa.ka("TasksCreationFromReplyEnabled");this.nt.CommentsFluentUI="true";this.nt.CommentsFluentUIV2="true";this.nt.CommentTasks=this.szc.toString();md.a("DeprecateIE.SharedCommentAppCapabilities")?
this.nt.DisabledChangeGates=this.fc.Ga("DisabledChangeGatesInSharedComments"):this.nt.DisabledChangeGates=Fb.a.Aj?"WebThemeIntegrationHighContrastFixes,":""+this.fc.Ga("DisabledChangeGatesInSharedComments");this.nt.DiscreteHostedComments="true";this.nt.NewCommentButton="true";this.nt.PersonaColor="true";this.nt.LivePersonaPicker="true";this.nt.AtMentionFloodgateSurvey=e.AFrameworkApplication.fa.ka("AtMentionUserFloodGateCampaignIsEnabled").toString();this.nt.CommentTasksFromReply=W.toString();this.nt.LogDraftCommentIdPair=
this.v7j.toString();this.nt.HyperlinksInComments="true";this.nt.SmartReplies=this.fc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1).toString();this.nt.NewModelState="true";this.nt.TaskPaneWithNewInfrastructure=this.Ha.tPd.toString();this.nt.NewSelectionInteractions="true";this.nt.ExtendedDrafting="true";this.nt.LinkToComment="true";this.nt.PersonaIconImageForWeb="true";this.nt.NoDiscardOnFocusLoss="true";this.nt.WebThemeIntegration="true";this.nt.TaskHistoryRecordIDs=
this.fc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TaskHistoryRecordIDs",!1).toString()}smh(){return new Promise((W,xa)=>{this.EOg?this.EOg.atMentionsEnabledAsync().then(da=>{this.KYe=da;this.Fqc=!0;W(this.Fqc)}):(m.ULS.sendTraceTag(528307426,327,10,"OfficeSharedCommentsAppCapabilities: SetAtMentionCapabilityAsync should not be called before _peopleAPIInstance is initialized"),xa(D.a.mu(-2130915320)))})}}Object(h.a)(De,"PPTSharedCommentAppCapabilities",kh,[]);class Nd{constructor(W){this.zg=
W}display(W,xa){this.zg.OUe(W?0:2,xa);this.zg.setVisibility()}dismiss(){this.zg.Qoi();this.zg.setVisibility()}activate(){this.zg.OUe(1);this.zg.setVisibility()}mJi(W){this.zg.OUe(W?0:2)}ym(W){this.zg.ym(W)}LC(W){this.zg.LC(W)}Qp(){return this.zg.Qp()}kN(W){return this.zg.Ivb(W)}xx(W){this.zg.xx(W)}dispose(){this.zg.dispose()}Ay(){this.zg.Ay()}CD(W){return this.zg.CD(W)}jB(W){return this.zg.jB(W)}draw(W,xa){this.zg.draw(W,xa)}get visible(){return this.zg.visible}set visible(W){this.zg.visible=W}setPosition(W,
xa){this.zg.setPosition(W,xa)}Dj(W){this.zg.Dj(W)}Gq(W){this.zg.Gq(W)}Gu(W){this.zg.Gu(W)}setZIndex(W){this.zg.setZIndex(W)}nE(W,xa){this.zg.nE(W,xa)}setSelection(){}}Object(h.a)(Nd,"ShapeCommentsAnchoredSelectionView",null,[1080,535,536,106]);class Od{constructor(W,xa){this.canvasContextId=this.canvasActionId=0;this.withFlags=!1;this.postCallback=this.registeredCallback=this.preCallback=null;this.delayActionsUntilRegistration=!1;this.canvasActionId=W;this.canvasContextId=xa}}Object(h.a)(Od,"CommentUIAction",
null,[]);var mj=d(63),qi=d(637),Vf=d(119),Ai=d(178),$g=d(1088),Ch=d(524);class nf{constructor(){this.draftId=null;this.insertIndex=0;this.anchorHintText=null}}Object(h.a)(nf,"CurrentContextDraft",null,[]);class qf{constructor(){this.contentId=null;this.anchorTop=this.containerContentType=0;this.anchorBottom=this.anchorRight=this.anchorLeft=null}}Object(h.a)(qf,"IContentAnchorPosition",null,[]);class Wi{constructor(){this.y=this.x=this.height=this.width=0}}Object(h.a)(Wi,"IViewportInfo",null,[]);class Tg{constructor(){this.allContainersVisibleCallback=
this.positionsUpdatedScrollHeightCallback=this.positionsUpdatedCallback=this.paneOpenedCallback=this.paneClosedCallback=null}}Object(h.a)(Tg,"FloatingContainerManagerCreationParams",null,[]);var rd=d(140),ze=d(50),xh=d(805),Qj=d(406),ae=d(374),nj=d(884),Xi;(function(W){W[W.line=0]="line";W[W.lineInv=1]="lineInv";W[W.triangle=2]="triangle";W[W.rtTriangle=3]="rtTriangle";W[W.rect=4]="rect";W[W.diamond=5]="diamond";W[W.parallelogram=6]="parallelogram";W[W.trapezoid=7]="trapezoid";W[W.nonIsoscelesTrapezoid=
8]="nonIsoscelesTrapezoid";W[W.pentagon=9]="pentagon";W[W.hexagon=10]="hexagon";W[W.heptagon=11]="heptagon";W[W.octagon=12]="octagon";W[W.decagon=13]="decagon";W[W.dodecagon=14]="dodecagon";W[W.star4=15]="star4";W[W.star5=16]="star5";W[W.star6=17]="star6";W[W.star7=18]="star7";W[W.star8=19]="star8";W[W.star10=20]="star10";W[W.star12=21]="star12";W[W.star16=22]="star16";W[W.star24=23]="star24";W[W.star32=24]="star32";W[W.roundRect=25]="roundRect";W[W.round1Rect=26]="round1Rect";W[W.round2SameRect=
27]="round2SameRect";W[W.round2DiagRect=28]="round2DiagRect";W[W.snipRoundRect=29]="snipRoundRect";W[W.snip1Rect=30]="snip1Rect";W[W.snip2SameRect=31]="snip2SameRect";W[W.snip2DiagRect=32]="snip2DiagRect";W[W.plaque=33]="plaque";W[W.ellipse=34]="ellipse";W[W.teardrop=35]="teardrop";W[W.homePlate=36]="homePlate";W[W.chevron=37]="chevron";W[W.pieWedge=38]="pieWedge";W[W.pie=39]="pie";W[W.blockArc=40]="blockArc";W[W.donut=41]="donut";W[W.noSmoking=42]="noSmoking";W[W.rightArrow=43]="rightArrow";W[W.leftArrow=
44]="leftArrow";W[W.upArrow=45]="upArrow";W[W.downArrow=46]="downArrow";W[W.stripedRightArrow=47]="stripedRightArrow";W[W.notchedRightArrow=48]="notchedRightArrow";W[W.bentUpArrow=49]="bentUpArrow";W[W.leftRightArrow=50]="leftRightArrow";W[W.upDownArrow=51]="upDownArrow";W[W.leftUpArrow=52]="leftUpArrow";W[W.leftRightUpArrow=53]="leftRightUpArrow";W[W.quadArrow=54]="quadArrow";W[W.leftArrowCallout=55]="leftArrowCallout";W[W.rightArrowCallout=56]="rightArrowCallout";W[W.upArrowCallout=57]="upArrowCallout";
W[W.downArrowCallout=58]="downArrowCallout";W[W.leftRightArrowCallout=59]="leftRightArrowCallout";W[W.upDownArrowCallout=60]="upDownArrowCallout";W[W.quadArrowCallout=61]="quadArrowCallout";W[W.bentArrow=62]="bentArrow";W[W.uturnArrow=63]="uturnArrow";W[W.circularArrow=64]="circularArrow";W[W.leftCircularArrow=65]="leftCircularArrow";W[W.leftRightCircularArrow=66]="leftRightCircularArrow";W[W.curvedRightArrow=67]="curvedRightArrow";W[W.curvedLeftArrow=68]="curvedLeftArrow";W[W.curvedUpArrow=69]="curvedUpArrow";
W[W.curvedDownArrow=70]="curvedDownArrow";W[W.swooshArrow=71]="swooshArrow";W[W.cube=72]="cube";W[W.can=73]="can";W[W.lightningBolt=74]="lightningBolt";W[W.heart=75]="heart";W[W.sun=76]="sun";W[W.moon=77]="moon";W[W.smileyFace=78]="smileyFace";W[W.irregularSeal1=79]="irregularSeal1";W[W.irregularSeal2=80]="irregularSeal2";W[W.foldedCorner=81]="foldedCorner";W[W.bevel=82]="bevel";W[W.frame=83]="frame";W[W.halfFrame=84]="halfFrame";W[W.corner=85]="corner";W[W.diagStripe=86]="diagStripe";W[W.chord=87]=
"chord";W[W.arc=88]="arc";W[W.leftBracket=89]="leftBracket";W[W.rightBracket=90]="rightBracket";W[W.leftBrace=91]="leftBrace";W[W.rightBrace=92]="rightBrace";W[W.bracketPair=93]="bracketPair";W[W.bracePair=94]="bracePair";W[W.straightConnector1=95]="straightConnector1";W[W.bentConnector2=96]="bentConnector2";W[W.bentConnector3=97]="bentConnector3";W[W.bentConnector4=98]="bentConnector4";W[W.bentConnector5=99]="bentConnector5";W[W.curvedConnector2=100]="curvedConnector2";W[W.curvedConnector3=101]=
"curvedConnector3";W[W.curvedConnector4=102]="curvedConnector4";W[W.curvedConnector5=103]="curvedConnector5";W[W.callout1=104]="callout1";W[W.callout2=105]="callout2";W[W.callout3=106]="callout3";W[W.accentCallout1=107]="accentCallout1";W[W.accentCallout2=108]="accentCallout2";W[W.accentCallout3=109]="accentCallout3";W[W.borderCallout1=110]="borderCallout1";W[W.borderCallout2=111]="borderCallout2";W[W.borderCallout3=112]="borderCallout3";W[W.accentBorderCallout1=113]="accentBorderCallout1";W[W.accentBorderCallout2=
114]="accentBorderCallout2";W[W.accentBorderCallout3=115]="accentBorderCallout3";W[W.wedgeRectCallout=116]="wedgeRectCallout";W[W.wedgeRoundRectCallout=117]="wedgeRoundRectCallout";W[W.wedgeEllipseCallout=118]="wedgeEllipseCallout";W[W.cloudCallout=119]="cloudCallout";W[W.cloud=120]="cloud";W[W.ribbon=121]="ribbon";W[W.ribbon2=122]="ribbon2";W[W.ellipseRibbon=123]="ellipseRibbon";W[W.ellipseRibbon2=124]="ellipseRibbon2";W[W.leftRightRibbon=125]="leftRightRibbon";W[W.verticalScroll=126]="verticalScroll";
W[W.horizontalScroll=127]="horizontalScroll";W[W.wave=128]="wave";W[W.doubleWave=129]="doubleWave";W[W.plus=130]="plus";W[W.flowChartProcess=131]="flowChartProcess";W[W.flowChartDecision=132]="flowChartDecision";W[W.flowChartInputOutput=133]="flowChartInputOutput";W[W.flowChartPredefinedProcess=134]="flowChartPredefinedProcess";W[W.flowChartInternalStorage=135]="flowChartInternalStorage";W[W.flowChartDocument=136]="flowChartDocument";W[W.flowChartMultidocument=137]="flowChartMultidocument";W[W.flowChartTerminator=
138]="flowChartTerminator";W[W.flowChartPreparation=139]="flowChartPreparation";W[W.flowChartManualInput=140]="flowChartManualInput";W[W.flowChartManualOperation=141]="flowChartManualOperation";W[W.flowChartConnector=142]="flowChartConnector";W[W.flowChartPunchedCard=143]="flowChartPunchedCard";W[W.flowChartPunchedTape=144]="flowChartPunchedTape";W[W.flowChartSummingJunction=145]="flowChartSummingJunction";W[W.flowChartOr=146]="flowChartOr";W[W.flowChartCollate=147]="flowChartCollate";W[W.flowChartSort=
148]="flowChartSort";W[W.flowChartExtract=149]="flowChartExtract";W[W.flowChartMerge=150]="flowChartMerge";W[W.flowChartOfflineStorage=151]="flowChartOfflineStorage";W[W.flowChartOnlineStorage=152]="flowChartOnlineStorage";W[W.flowChartMagneticTape=153]="flowChartMagneticTape";W[W.flowChartMagneticDisk=154]="flowChartMagneticDisk";W[W.flowChartMagneticDrum=155]="flowChartMagneticDrum";W[W.flowChartDisplay=156]="flowChartDisplay";W[W.flowChartDelay=157]="flowChartDelay";W[W.flowChartAlternateProcess=
158]="flowChartAlternateProcess";W[W.flowChartOffpageConnector=159]="flowChartOffpageConnector";W[W.actionButtonBlank=160]="actionButtonBlank";W[W.actionButtonHome=161]="actionButtonHome";W[W.actionButtonHelp=162]="actionButtonHelp";W[W.actionButtonInformation=163]="actionButtonInformation";W[W.actionButtonForwardNext=164]="actionButtonForwardNext";W[W.actionButtonBackPrevious=165]="actionButtonBackPrevious";W[W.actionButtonEnd=166]="actionButtonEnd";W[W.actionButtonBeginning=167]="actionButtonBeginning";
W[W.actionButtonReturn=168]="actionButtonReturn";W[W.actionButtonDocument=169]="actionButtonDocument";W[W.actionButtonSound=170]="actionButtonSound";W[W.actionButtonMovie=171]="actionButtonMovie";W[W.gear6=172]="gear6";W[W.gear9=173]="gear9";W[W.funnel=174]="funnel";W[W.mathPlus=175]="mathPlus";W[W.mathMinus=176]="mathMinus";W[W.mathMultiply=177]="mathMultiply";W[W.mathDivide=178]="mathDivide";W[W.mathEqual=179]="mathEqual";W[W.mathNotEqual=180]="mathNotEqual";W[W.cornerTabs=181]="cornerTabs";W[W.squareTabs=
182]="squareTabs";W[W.plaqueTabs=183]="plaqueTabs";W[W.chartX=184]="chartX";W[W.chartStar=185]="chartStar";W[W.chartPlus=186]="chartPlus"})(Xi||(Xi={}));Object(h.b)("ST_ShapeType",Xi);var La=d(152);class lb{constructor(){this.RowId=this.ColId=null}}Object(h.a)(lb,"TableCellInfo",null,[]);var Nb=d(883),lc=d(52),Rc=d(183),Ud=d(122),Pd=d(166),Sd=d(1085),Le=d(911),af=d(912),zf=d(340),yh=d(104);class gg{constructor(W,xa){this.Rua=this.tyb=null;this.VLg=!1;this.tre=W;this.lh=xa}get jQj(){return this.VLg}GFb(W,
xa){xa&&W.removeNotification(xa);return xa}zPk(W){this.tyb=this.GFb(W,this.tyb);this.GFb(W,this.Rua);this.Rua=this.tyb=null}cfl(W,xa,da){W?this.tre.om.isVisible&&1===W.VL.length&&xa.Ba&&Rb.a.kfa(W.l6a.Bb,xa.Ba.Bb)||Kd.UISurfaces.gN().then(Fa=>{this.Rua=this.GFb(Fa,this.Rua);this.Rua=null;var Ua=Object.assign(new Sd.a,{label:W.SEb,onExecute:()=>{W.primaryButtonAction(this.tre,xa);xa.Ba.we!==W.l6a.we&&da.U9(W.l6a.we);this.GFb(Fa,this.Rua);this.Rua=null}}),cb=Object.assign(new Sd.a,{label:W.Egd,onExecute:()=>
{this.VLg=!0;this.GFb(Fa,this.Rua);this.Rua=null}});cb=Object.assign(new Le.a,{target:".EditingRibbonPanel",title:W.title,content:W.content,primaryButtonProps:Ua,secondaryButtonProps:cb,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new af.a,{directionalHint:6,gapSpace:4,isBeakVisible:!1,onDismiss:()=>{this.lh.zo(Ke.a.ihb)},preventDismissOnScroll:!0,preventDismissOnResize:!0})});Ua=Object.assign(new zf.a,{onShow:()=>{this.lh.lK(Ke.a.ihb)}});cb=Fa.callout(cb);this.Rua=Fa.addNotification(cb,
Ua)}):Wb.a.J(546153881,805,50,"SharedCommentFrame::ShowReviewResolvedCommentsCallout - Trying to show review resolved comments callout when params are null.")}ash(W,xa){const da=new yh.StandardDialog;da.yd=4;da.nx(ResourceStrings.l_DeleteAllCommentsConfirmationTitle,xa?ResourceStrings.l_DeleteAllResolvedCommentsConfirmation:ResourceStrings.l_DeleteAllCommentsConfirmation,1,Fa=>{1===Fa?(W.zYb(xa),this.tre.LWd(xa)?this.bsh():this.$rh(xa?ResourceStrings.l_DeleteAllResolvedCommentsInPresentationCallout:
ResourceStrings.l_DeleteAllCommentsInPresentationCallout),Wb.a.J(546153882,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - Yes button clicked for DeleteAllComments - fDeleteAllResolved: {0}",xa)):Wb.a.J(546153883,805,50,"SharedCommentFrame::ShowDeleteAllConfirmationDialog - No button clicked for DeleteAllComments - fDeleteAllResolved: {0}",xa)})}bsh(){const W=new yh.StandardDialog;W.yd=0;W.nx(ResourceStrings.l_DeleteAllCommentsErrorTitle,ResourceStrings.l_DeleteAllCommentsError,1,null)}$rh(W){const xa=
()=>{this.lh.lK(Ke.a.ihb)},da=()=>{this.lh.zo(Ke.a.ihb)};Kd.UISurfaces.gN().then(Fa=>{this.GFb(Fa,this.tyb);this.tyb=null;var Ua=Object.assign(new Le.a,{target:".EditingRibbonPanel",title:ResourceStrings.l_DeleteAllCommentsCalloutTitle,content:W,showCloseIcon:!0,useTeachingStyles:!1,calloutProps:Object.assign(new af.a,{directionalHint:6,isBeakVisible:!1,onDismiss:da,preventDismissOnScroll:!0,preventDismissOnResize:!0})});const cb=Object.assign(new zf.a,{onShow:xa});Ua=Fa.callout(Ua);this.tyb=Fa.addNotification(Ua,
cb)})}}Object(h.a)(gg,"CommentCalloutDialogManager",null,[]);var Dh=d(939);class Ug{constructor(W){this.ZUa=W;this.lla=[];this.Lhe=new Dh.a(1E3,Object(Ca.a)(this,this.perform,"perform"))}qzk(W){Array.contains(this.lla,W)||Array.add(this.lla,W);this.Lhe.perform()}perform(){const W=this.lla;this.lla=[];for(let xa=0;xa<W.length;xa++){const da=W[xa];this.ZUa.BCb(da.commentId,new cd.a(da.pos.X,da.pos.Y))}}}Object(h.a)(Ug,"CommentKeyboardMoveController",null,[]);class ui{constructor(W,xa,da,Fa,Ua){this.HEa=
this.Uua=null;this.Cda=[];if(!W)throw Error.argumentNull("parentElement");if(!xa)throw Error.argumentNull("frame");this.bAb=da;this.Zh=W;this.hb=xa;this.nIg=Fa;this.xIg=Ua}dispose(){this.GFe();this.hb=this.Zh=null}GFe(){this.HEa=this.Uua=null;if(this.Cda&&0<this.Cda.length){for(const W of this.Cda)W&&W.dispose();Array.clear(this.Cda)}}BZ(W){if(!this.cCa)return!0;if(!W||!W.length)return!1;W=Pd.e(W,xa=>0===xa.status);return!!W&&0<W.length}ded(W){this.GFe();if(W&&this.Zh){var xa=this.hb.isReadOnly?null:
this.hb.Mt;for(const da of W)this.Cda.push(this.bAb.create(da,this.Zh,this,xa,this.hb.isReadOnly,ld.cN(da)||!this.xIg));this.BZ(W)&&this.qVe()}}selectComment(W,xa){if(!(!W&&!this.Uua||this.Uua&&ld.hsb(W,this.Uua.comment))&&(this.Uua&&this.Uua.select(!1),this.Uua=null,W))for(const da of this.Cda){if(ld.hsb(da.comment,W)){this.Uua=da;da.select(!0);break}if(xa&&da.comment.Children)for(const Fa of da.comment.Children)if(ld.hsb(Fa,W)){this.Uua=da;da.select(!0);return}}}Qnb(W,xa){if(!(!W&&!this.HEa||this.HEa&&
ld.hsb(W,this.HEa.comment))&&(this.HEa&&this.HEa.activate(!1),this.HEa=null,W))for(const da of this.Cda){if(ld.hsb(da.comment,W)){this.HEa=da;da.activate(!0);break}if(xa&&da.comment.Children)for(const Fa of da.comment.Children)if(ld.hsb(Fa,W)){this.HEa=da;da.activate(!0);return}}}rsh(W){for(const xa of this.Cda)xa.qsh(W)}qVe(){for(const W of this.Cda)W.updatePosition(this.hb.fBa(W.comment.pos.X,W.comment.pos.Y))}BCb(W,xa){xa=this.hb.gTf(xa._x,xa._y);W.pos.X+=xa._x;W.pos.Y+=xa._y;xa=new cd.a(W.pos.X,
W.pos.Y);this.hb.selectComment(W,null,!0,!1,0,1,!1);this.hb.manager.BCb(W.commentId,xa)}pxl(W){for(const xa of this.Cda)if(xa.comment===W){xa.updatePosition(this.hb.fBa(xa.comment.pos.X,xa.comment.pos.Y));break}}qxl(W){for(const xa of W)for(const da of this.Cda)da.comment.commentId===xa.commentId&&da.updatePosition(this.hb.fBa(da.comment.pos.X,da.comment.pos.Y))}setVisibility(W){this.xIg=W;for(const xa of this.Cda)xa.setVisibility(!ld.cN(xa.comment)&&W)}get frame(){return this.hb}get isRightToLeft(){return this.nIg}set isRightToLeft(W){this.nIg=
W}get parentElement(){return this.Zh}set parentElement(W){this.Zh=W}get MGb(){return this.Uua}get cCa(){return!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("SlideResizePerfImprovementEnabled")}}Object(h.a)(ui,"CommentMarkerView",null,[]);class Uh{constructor(){this.comment=this.slide=null;this.direction=0;this.kJe=null}}Object(h.a)(Uh,"CommentSelectContext",null,[]);var Yi;(function(W){W[W.previous=0]="previous";W[W.next=1]="next"})(Yi||(Yi={}));Object(h.b)("CommentSelectDirection",
Yi);class lh{constructor(W,xa){if(!W||1>W.length)throw Error.argument("ISlideNode[] slides");if(!xa)throw Error.argumentNull("ICommentGraphManager graphManager");this.X$j=W;this.Tk=xa;this.Pqe=[];this.init()}get OHa(){return this.X$j}get VL(){return this.Pqe}get l6a(){return this.VL[this.VL.length-1]}get SEb(){return 1<this.VL.length?ResourceStrings.L_CommentReviewResolvedCalloutGoToButton:ResourceStrings.L_CommentReviewResolvedCalloutReviewButton}get Egd(){return ResourceStrings.L_CommentReviewResolvedCalloutDontShowButton}get title(){return ResourceStrings.L_CommentReviewResolvedCalloutTitle}get content(){return this.Agl()}init(){for(const W of this.OHa)for(const xa of this.Tk.Xra(W.xD()))if(1===
xa.status){this.Pqe.push(W);break}if(1>this.Pqe.length)throw Error.argument("ISlideNode[] slides contains no resolved comments.");}Agl(){switch(this.VL.length){case 1:return ResourceStrings.L_CommentReviewResolvedCalloutContentSlides1;case 2:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides2,this.VL[1].we+1,this.VL[0].we+1);case 3:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides3,this.VL[2].we+1,this.VL[1].we+1,this.VL[0].we+1);case 4:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlides4,
this.VL[3].we+1,this.VL[2].we+1,this.VL[1].we+1);default:return String.format(ResourceStrings.L_CommentReviewResolvedCalloutContentSlidesN,this.VL[this.VL.length-1].we+1,this.VL[this.VL.length-2].we+1,this.VL[this.VL.length-3].we+1,this.VL.length-3)}}N5i(){for(const W of this.Tk.Q6a(this.l6a))if(1===W.status)return W;return null}primaryButtonAction(W,xa){if(!xa.presentation||!xa.presentation.slides)return Wb.a.J(571269902,805,10,"ResolvedCommentsCalloutParams::PrimaryButtonAction - Failed to show callout due to null {0}",
xa.presentation?"Presentation.Slides":"Presentation"),null;const da=this.N5i();if(!da)return null;W.om.isVisible||W.qjd();if(xa.Ba&&Rb.a.kfa(xa.Ba.Bb,this.l6a.Bb))W.Zea(da.commentId,1,!0);else for(const Fa of xa.presentation.slides)if(Rb.a.kfa(Fa.Bb,this.l6a.Bb))return Object.assign(new Uh,{slide:this.l6a,comment:da,direction:1,kJe:Xd.a.Pl("SelectResolvedCommentCrossSlide",1)});return null}}Object(h.a)(lh,"ResolvedCommentsCalloutParams",null,[]);class jg{constructor(){this.type="SharedCommentsTaskPaneProps";
this.focusCallback=null}}Object(h.a)(jg,"SharedCommentsTaskPaneProps",null,[]);var cj=d(942),oj=d(424),hk=d(161);class Vh{constructor(W,xa,da,Fa,Ua,cb,Jb,Gc,pd,Ld,de,Be,Mf,Dg,yd,td,id,ed,Oc,Wl,Wh,ik,Vj,Zm,Ok,rf,Af,qk,Dk,ej,xj,Wj,rk,ol,jm,xd,Xl,dl,kg,km,Ki,vm,pj,Df,Qh,Yl,qj,pl,Il,$m,Hj,el,ql,ri,un,vn,Ci){this.lre=this.Um=null;this.nab=!0;this.Go=this.yje=this.t9b=this.gje=this.pab=!1;this.xbb=0;this.q4c=this.fBb=!1;this.WEa=this.E3c=this.Yh=this.JTa=this.Bcb=this.w9=this.UEg=null;this.qIg=this.HUa=
!1;this.yr=null;this.yre=this.Tie=!1;this.TPg=null;this.cMf=[Ke.a.HC,Ke.a.Op,Ke.a.k2,Ke.a.Iri];this.pjb=2147483647;this.Ixb=0;this.FMg=-1;this.oGg=0;this.wac=null;this.u3c=this.dhe=!1;this.RWa=(Jl,Aa)=>{Aa.slide===this.ua.Ba&&(Jl=this.IQ.instance.I5d||this.IQ.instance.J5d,!Aa.slide.isUnread||Jl)&&(Aa=this.Tk.Fy(),this.wFb(Aa,e.AFrameworkApplication.isRtl,!0))};if(!xd)throw Error.argumentNull("appSettingsManager");if(!ik)throw Error.argumentNull("commentEventHost");if(!xa)throw Error.argumentNull("commentTelemetryManager");
this.YG=Hj;this.ia=da;this.Ob=Fa;this.om=Ua;this.Mt=cb;this.Wc=Jb;this.Fa=Gc;this.lh=pd;this.fe=Ld;this.ra=de;this.Hc=Mf;this.ay=Dg;this.eq=yd;this.Tk=W;this.OD=xa;this.s6j=new Ug(W);this.kX=td;this.ua=id;this.D5c=ed.vd(40);this.rOg=md.a("PreventCommentDraftDeletionOnPageContentChange")?ed.vd(7):ed.vd(8);this.wAb=Be;this.WN=Mf.Gc?Mf.Gc.mPd:null;this.nua=Ok;this.yb=Wl;this.n_=ik;this.fdb=Vj;this.vNg=Wh;this.k4c=Zm;this.ehe=rf;this.D_c=Af;this.Je=ej;this.T2c=qk;this.Eq=Dk;this.hZc=xj;this.yv=Wj;this.bAb=
rk;this.MQ=ol;this.Nn=jm;this.fc=xd;this.ks=dl;this.THg=kg;this.v3=new r.a;this.Md=km;this.Xa=Ki;this.ycb=pj;this.Vta=vm;this.Lc=Df;this.Ea=qj;this.$9j=pl;this.JW=Il;this.x9b=$m;this.Ha=ql;this.Uk=ri;this.NW=un;this.q9b=Yl;this.KFa=!1;this.ia.Jma(this);this.K$a=new gg(this,this.lh);this.IQ=vn;this.m4=Ci;if(!Xl)throw Error.argumentNull("InteractiveViewManagerFuture");this.vKg=Xl;this.p0j=this.Gxi();this.YG&&this.om.p3k(this.vaj());this.Nb=el;Qh.Qqb().then(Jl=>{Jl||this.tKe(!1)})}get fKc(){return this.THg}get QWd(){return this.fc.ka("195")}get N3f(){return this.Vta}get tYb(){return this.fc.Ga("CurrentCommentId")}get JSd(){return this.fc.Ga("CurrentSlideId")}get NWb(){return this.fc.ka("PptReactTabbedTaskPanesM2IsEnabled")}get SAk(){return this.fc.ka("PPTSafeLinksIsEnabledForModernComments")}get Xri(){return this.fc.ka("CommentTextAnchoringReadWriteEnabled")}get qPd(){return this.fc.ka("CommentTextAnchoringCreateNewEnabled")}get A0f(){return this.fc.ka("EnableDeleteAllComments")}get cCa(){return this.fc.ka("SlideResizePerfImprovementEnabled")}get Mrb(){return md.a("CompactingDHCsEnabled")}get D3f(){return md.a("CanvasToCommentFocusFix")}get y4b(){return this.fc.ka("PPTOBlueDotsForComments")}initialize(){this.Go=
1===this.Ob.mode;this.YG||(this.nua?Sys.UI.DomElement.addCssClass(this.wAb,ef.xYk):Sys.UI.DomElement.addCssClass(this.wAb,ef.wYk));const W=this.Fa.Dc(Ke.a.Op);W.cL=!0;W.d_a=!0;W.$aa(da=>{const Fa=!md.a("FixAltF12KeboardingInCommentPane")||!da||da.name!==Ke.a.IO;this.Eec(!0,!da||da.name!==Ke.a.HC&&Fa,!0)});W.rAa((da,Fa)=>{da=(Fa.name===Ke.a.tO||Fa.name===Ke.a.Wea)&&da.name===Ke.a.Op;this.Eec(!1,!1,Fa.name===Ke.a.Op||Fa.name===Ke.a.Bg||Fa.name===Ke.a.HC||Fa.name===Ke.a.k2||this.NWb&&Fa.name===Ke.a.IO||
da)});const xa=this.Fa.Dc(Ke.a.HC);xa.$aa((da,Fa)=>{this.ppk(da,Fa)});xa.rAa(()=>{this.opk()});this.YG||this.Wc.DFb(Zb.a.click,this.wAb,Object(Ca.a)(this,this.pDb,"onCommentPaneParentDivClick"),null,W.d_a);this.ub();this.ay.zId(Object(Ca.a)(this,this.xHa,"onBeforeSlideSwitched"));this.ay.uV(Object(Ca.a)(this,this.RUe,"updateCommentsWhenNavigateSlide"));this.eq.GNa(Object(Ca.a)(this,this.zCf,"activeSlideDOMDisplayed"));this.Eq.i7h(Object(Ca.a)(this,this.g1g,"onPageViewZoomChanged"));this.ks.GFf(Object(Ca.a)(this,
this.onShapeSelected,"onShapeSelected"));this.ks.L7h(Object(Ca.a)(this,this.c2g,"onShapeDeselected"));this.ay.dUb(Object(Ca.a)(this,this.n2g,"onShapeTextSelected"));this.ay.VId(Object(Ca.a)(this,this.PWa,"onSlideBackgroundClicked"));this.q9b&&(this.ay.eUb(Object(Ca.a)(this,this.Tqk,"onSlideSizeUpdated")),this.ay.S7h(Object(Ca.a)(this,this.l2g,"onShapeRotatedOrBoundsUpdated")),this.ay.O7h(Object(Ca.a)(this,this.l2g,"onShapeRotatedOrBoundsUpdated")));this.D5c.Yj(Object(Ca.a)(this,this.g3g,"onTextAnchorPropertyChanged"));
this.rOg.nG(Object(Ca.a)(this,this.fB,"onChildTopologyChanged"));this.D5c.wAa(Object(Ca.a)(this,this.kZg,"onBeforeTextAnchorDisconnect"));this.ycb.Yj(Object(Ca.a)(this,this.efc,"onShapePropertyChange"));this.ycb.f7h(Object(Ca.a)(this,this.g2g,"onShapeInvalidation"));this.Lc.l5h(Object(Ca.a)(this,this.s_g,"onF6FocusDocument"));this.y4b&&this.m4.execute(da=>{da.WId(this.RWa)});this.hZc.SId(Object(Ca.a)(this,this.n$c,"onSessionExpired"));this.hZc.IB(Object(Ca.a)(this,this.ceb,"onSessionEnded"));this.Hc.Gc&&
this.Hc.Gc.mPd&&(this.xHa(this,null),this.RUe(this,null));this.Ob.JM(Object(Ca.a)(this,this.SYg,"onAppModeSwitched"));this.Ob.y3a(Object(Ca.a)(this,this.zX,"onSetOffline"));this.eq.iob(Object(Ca.a)(this,this.q$c,"onShapeViewElementAddedOrRemoved"));this.eq.IFf(Object(Ca.a)(this,this.q$c,"onShapeViewElementAddedOrRemoved"));this.ra.VH(Object(Ca.a)(this,this.kH,"onSelectionChanged"))}q$c(W,xa){this.Um&&(W=xa.xw)&&W.shapeNode&&this.xPj(W.shapeNode.slideId)&&this.Um.ded(this.Tk.Fy())}xPj(W){return!!this.ua&&
!!this.ua.Tj&&this.ua.Tj.equals(W)}tKe(W){this.Vta=this.THg=W;this.Nn.tKe(W)}Tqk(){this.Um&&this.Um.qVe()}l2g(W,xa){if(this.Um){const da=xa.xw.shapeNode;if(da){if((W=this.Tk.Fy())&&W.length){xa=[];for(const Fa of W)Fa.anchorShape===da.get_shapeId()&&xa.push(Fa);this.Um.qxl(xa)}}else Wb.a.J(512496785,805,10,"SharedCommentFrame:OnShapeRotatedOrBoundsUpdated shape is null")}}Pwl(){try{if(this.NWb&&this.om){const W=Object(pb.a)(1081,this.om);W&&(W.Xqh=!!this.Yh)}}catch(W){Wb.a.J(512496784,805,10,"TabbedTaskPane - Exception while updating if draft comment is closed for tabbed flow",
W)}}I3f(){return this.Yh&&this.Yh.u7&&this.ua.Ba?!Rb.a.kfa(this.Yh.u7,this.ua.Ba.Bb):!1}asb(){return this.Yh&&this.ua.Ba?!this.Yh.u7||Rb.a.kfa(this.Yh.u7,this.ua.Ba.Bb):!1}ggh(){if(this.yr&&this.yr.isIntegratedExtensionEnabled()){const W=this.Tk.Fy(),xa=!this.cCa||!this.KFa;W&&0<W.length&&(this.aR(!0,!0,xa),this.Wed());this.asb()&&this.fgh(this.Yh)}}Nok(){if(this.yr){this.Pwl();this.ggh();const W=this.JGb;W&&0!==W.status&&this.nKa(1)}}Ook(){this.GYb();const W=!this.cCa||!(this.BZ()&&this.KFa);this.aR(!1,
!1,W)}$ok(W){this.Ixb!==W&&(this.Ixb=W,this.Hc&&this.Hc.Gc&&this.Hc.Gc.QDh(2,!1,this.Ixb))}pog(){const W=Object.assign(new Tg,{paneClosedCallback:Object(Ca.a)(this,this.Nok,"onPaneClosedCallback"),paneOpenedCallback:Object(Ca.a)(this,this.Ook,"onPaneOpenedCallback"),positionsUpdatedScrollHeightCallback:Object(Ca.a)(this,this.$ok,"onPositionUpdatedScrollHeightCallback")});W.allContainersVisibleCallback=Object(Ca.a)(this,this.Kjk,"onAllContainersVisible");this.yr=floatingContainerManager.FactoryGlobal.createFloatingContainerManagerInstance(W)}BAj(){this.SAk&&
this.$9j.execute(W=>{const xa=sharedComments.RichContentEditAPIFactoryGlobal.getRichContentEditAPI();xa?xa.registerSafelinksNavigator(Object(Ca.a)(W,W.Vmd,"tryNavigate")):Wb.a.J(512496783,805,15,"SharedCommentFrame:InitializeRichContentEditAPI consumerAPI is null. Created successfully:{0}")})}jyj(){this.pog();this.aR(!0,!1,!0);this.Tie=!0;const W=this.A0b();Fc.a.jed(W,[Zb.a.contextMenu]);if(this.yr){this.yr.setDhcContainerPanel(W,this.nua);var xa=Object.assign(new Wi,{width:parseFloat(W.style.width),
height:this.pjb,x:0,y:0});this.yr.updateViewport(xa);this.yr.setCompactContainers(this.Mrb)}this.Wed();this.OD.hmk(this.ua.Tj);xa=this.Fa.Dc(Ke.a.k2);xa.cL=!0;xa.d_a=!0;xa.$aa(da=>{this.Eec(!0,!da||da.name!==Ke.a.HC,!0)});xa.rAa((da,Fa)=>{da=(Fa.name===Ke.a.tO||Fa.name===Ke.a.Wea)&&da.name===Ke.a.k2;this.Eec(!1,!1,Fa.name===Ke.a.Op||Fa.name===Ke.a.Bg||Fa.name===Ke.a.HC||Fa.name===Ke.a.k2||this.NWb&&Fa.name===Ke.a.IO||da)});this.Fa.XRc(Ke.a.k2,Ke.a.jj,W);this.xdh();this.ia.ya(qc.a.qxa,Hb.a.frame,Object(Ca.a)(this,
this.qxa,"showHideComments"))}Wed(){const W=this.Tk.Fy();this.cgh(W)}xdh(){if(this.yr){const W=this.A0b();if(W){const xa=this.Fa.Dc(Ke.a.k2);this.Wc.DFb(Zb.a.click,W,Object(Ca.a)(this,this.pDb,"onCommentPaneParentDivClick"),null,xa.d_a)}}}pCh(){if(this.yr){const W=this.A0b();W&&this.Wc.xb(Zb.a.click,W,Object(Ca.a)(this,this.pDb,"onCommentPaneParentDivClick"))}}A0b(){const W=this.Hc&&this.Hc.Gc?this.Hc.Gc.rba:null;return W?W.xa:null}cgh(W){if(this.Hc.Gc&&this.Tie){if(!this.yr)try{this.pog(),Wb.a.J(512496782,
801,15,"SharedCommentFrame::RenderCommentContainers - m_containerManager is null. Created successfully:{0}",!!this.yr)}catch(Fa){Wb.a.J(512496781,801,10,"SharedCommentFrame::RenderCommentContainers - Error creating m_containerManager: {0}",Fa);return}var xa=Date.now();if((W=this.lYf(W))&&W.length){var da=this.A0b();da.setAttribute(Rd.a.Ye,"group");if(da){this.v3=this.$1i(W);Wb.a.J(512496780,801,50,"SharedCommentFrame::RenderCommentContainers - Content anchor positions: {0}",this.v3.count);if(!this.v3.count&&
!this.rSa){this.aR(!1,!1,!0);Wb.a.J(512496779,801,50,"SharedCommentFrame::RenderCommentContainers - Time taken:{0} ms",Date.now()-xa);return}this.yr.setDhcContainerPanel(da,this.nua);this.yr.attachContainers(this.v3.toArray());this.aR(!0,!1,!0)}Wb.a.J(512496778,801,50,"SharedCommentFrame::RenderCommentContainers Time taken:{0} ms",Date.now()-xa)}}}lYf(W){if(!W||!W.length)return W;const xa=new r.a;for(const da of W)0!==da.status?this.kYf(da.commentId):xa.add(da);return xa.toArray()}oyl(){this.dhe=
!1;if(!this.Nn.Ith&&!this.Nn.OV&&this.Hc.Gc){var W=this.Tk.Q6a(this.Hc.Gc.Ed);for(const xa of W)if(0===xa.status){this.selectComment(xa,null,!0,!0,0,0,!1);break}}}xfj(){if(!this.Hc||!this.Hc.Gc||!this.Hc.Gc.Ed)return this.pjb;var W=this.Hc.Gc.Ed;if(isNaN(W.Kk))return this.pjb;W=W.Kk;return 0>W?this.pjb:W}G8f(W){var xa=this.Nn.y7(W);W=W.pos.Y;xa&&(W+=xa.MC.y,xa.Og&&(xa=this.Ea.ds(xa),W+=xa&&xa.MC?xa.MC.y:0));return this.fBa(0,W).y}UUe(){if(this.yr){const W=this.xfj();W!==this.FMg&&(this.FMg=W,this.yr.setSlideHeight(W))}}fgh(W){if(W&&
0===W.GOa){var xa=0;if(this.Mrb)xa=-this.pjb,this.UUe();else{const da=this.ra.rq();da&&(xa=this.fBa(0,da.MC.y).y)}xa=Object.assign(new qf,{contentId:W.TB.draftId,containerContentType:0,anchorTop:xa,anchorLeft:0});this.aR(!0,!0,!0);this.yr.setDhcContainerPanel(this.A0b(),this.nua);this.yr.updateDrafting(xa,!0);this.yr.selectContainer(W.TB.draftId,!0)}}aUk(W){if(this.v3){var xa=0,da="";if(this.Mrb){var Fa=this.ra.rq();Fa&&(xa=this.fBa(0,Fa.MC.y).y);if(Fa=this.Tk.Fy())for(const Ua of Fa)Pb.a.Va(Ua.commentId)||
this.G8f(Ua)!==xa||(da=Ua.commentId)}xa=Object.assign(new qf,{contentId:W,containerContentType:0,anchorTop:xa,anchorLeft:0});this.Mrb?this.yr.updateDraftingAndPosition(xa,!1,da):this.yr.updateDrafting(xa,!1);this.yr.selectContainer(W,!0)}}kYf(W){if(this.yr&&this.v3){for(let xa of this.v3)Vh.pUg(xa,W)&&(this.yr.detachContainers([xa]),this.v3.remove(xa));this.BZ()||this.rSa||this.aR(!1,!1,!0)}}m3k(){this.dhe=!0}zJc(){this.NWb&&this.om&&this.om.isVisible&&this.om.a0k()}XQi(){var W=this.ua.presentation;
if(!W)return!1;W=W.slides;if(!W)return!1;for(const xa of W)if(W=Object(pb.a)(jb.a,xa))for(const da of this.Tk.Xra(W.xD()))if(ld.cN(da))return!0;return!1}m3d(W){var xa=this.ua.presentation;if(!xa)return null;xa=xa.slides;if(!xa)return null;for(const da of xa)if(xa=Object(pb.a)(jb.a,da),Rb.a.kfa(xa.Bb,W))return xa;return null}PQi(){return this.qPd||this.Xri&&this.XQi()}Jgg(){const W=this.ra.Oa.kb,xa=this.ra.Oa.y5;if(!W||!xa)return null;var da=Object(pb.a)(5,W.Ua.node),Fa=Object(pb.a)(5,xa.Ua.node);
if(!da||!Fa)return null;da=Object(pb.a)(Rc.TableCellNode,da.HK());Fa=Object(pb.a)(Rc.TableCellNode,Fa.HK());return da&&Fa?da.rowIndex>Fa.rowIndex?W:xa:null}Ehj(){if(!this.PQi()||!this.ra.a8())return null;Wb.a.J(512496777,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Begin.");var W=0,xa=0;if(this.ra.Oa.vl){var da=this.Jgg();if(!da)return Wb.a.J(512496776,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell selection is null."),null;var Fa=da}else Fa=
this.ra.Oa.kb;if(!Fa)return Wb.a.J(512496775,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, current selection is null."),null;const Ua=({AJa:W,SBa:xa}=ld.Dhj(this.ra.JZ(),Fa,W,xa)).returnValue;if(!Ua||0>W||0>xa||0>=xa-W)return Wb.a.J(512496774,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, invalid text anchor ParagraphNode is null:{0}, EndPos:{1}, StartPos:{2}.",!Ua,xa,W),null;da=new Nb.a;da.StartPos=W;da.EndPos=xa;if(this.ra.USa()&&Ua.get_smartArtModelId()){Wb.a.J(512496773,
805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in SmartArt.");da.AnchoringShape=new nj.a;W=K.a.Mf(Ua.get_smartArtModelId()).toString();if(!W||!K.a.isValid(W))return Wb.a.J(512496772,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Smart Art node ID string is null:{0} or invalid.",!W),null;da.AnchoringShape.SmartArtNodeId=W;this.OD.k_j()}else if(Ua.hs()){Wb.a.J(512496771,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Text selection in table.");
xa=Object(pb.a)(Rc.TableCellNode,Ua.HK());if(!xa)return Wb.a.J(512496770,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, table cell node is null."),null;W=xa.rowId.toString();xa=xa.cellId.toString();if(!(W&&xa&&K.a.isValid(W)&&K.a.isValid(xa)))return Wb.a.J(512496769,805,15,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Failed, Row/Col ID string is null:{0}/{1} or invalid.",!W,!xa),null;da.AnchoringShape=new nj.a;da.AnchoringShape.TableCell=new lb;da.AnchoringShape.TableCell.RowId=
W;da.AnchoringShape.TableCell.ColId=xa;this.OD.l_j()}W=Object(pb.a)(5,Fa.Ua.node);Fa=Object(pb.a)(5,Fa.Ve.node);W!==Fa&&this.OD.n_j();Wb.a.J(512496768,805,50,"SharedCommentFrame::GetTextAnchoringInfoFromSelection - Succeeded.");return da}zHi(W){if(this.yr&&W){for(const xa of this.v3.toArray()){let da=!1;for(const Fa of W)if(Vh.pUg(xa,Fa.commentId)){da=!0;break}da||(this.yr.detachContainers([xa]),this.v3.remove(xa),Wb.a.J(512496739,801,50,"SharedCommentFrame::DetachDeletedCommentContainers {0}",xa.contentId))}this.BZ()||
this.rSa||this.aR(!1,!1,!0)}}GYb(){if(this.yr){for(const W of this.v3.toArray())this.yr.detachContainers([W]);this.v3.clear()}this.BZ()||this.rSa||(this.cCa&&!this.KFa?this.aR(!1,!1,!1):this.aR(!1,!1,!0))}lPe(W){if(!W)return null;W.sort((xa,da)=>{var Fa=this.Nn.y7(xa);Fa=Fa?Fa.MC:new cd.a(0,0);var Ua=this.Nn.y7(da);Ua=Ua?Ua.MC:new cd.a(0,0);Fa.y+=xa.pos.Y;Ua.y+=da.pos.Y;Fa.x+=xa.pos.X;Ua.x+=da.pos.X;let cb=Fa.y-Ua.y;cb||(cb=Fa.x-Ua.x)||(cb=+xa.dt-+da.dt);return cb});return W}$1i(W){const xa=new r.a;
if(W){this.Mrb&&this.UUe();for(const da of W)Pb.a.Va(da.commentId)||(W=this.G8f(da),W=Object.assign(new qf,{contentId:da.commentId,containerContentType:0,anchorTop:W,anchorLeft:0}),xa.add(W))}return xa}zX(W){this.q0g(W)}aeh(W,xa){for(let da=0;da<W.Ra.length;da++){const Fa=W.Ra.ga(da);if(!Fa.xg)continue;const Ua=[];for(let cb=0;cb<Fa.xg.length;cb++){const Jb=Fa.xg.ga(cb);Jb.YH.equals(xa)&&Ua.push(Jb)}if(!(1>Ua.length))try{W.Ena=!0;for(const cb of Ua)Fa.xg.remove(cb)}catch(cb){Wb.a.J(512496738,805,
10,"SharedCommentFrame::RemoveCommentRange - Exception{0} when trying to remove start/end comment GUIDs",cb.toString())}finally{W.Ena=!1}}}UCf(W,xa,da){W.xg||(W.xg=new Qj.a(W));const Fa=W.xg.ye.paragraph;xa=new xh.a(W.xg.ye,null,xa,da);W.xg.add(xa);Fa.Nu()}wGc(W){return Xc.a.Mf("{"+W+"}{1}")}NTb(W,xa,da,Fa){let Ua=null;for(let cb=0;cb<W.Ra.length;cb++){let Jb=W.Ra.ga(cb);if(Jb.cp>=da){try{W.Ena=!0;if(Jb.cp>da||!Jb.formatting)this.JW.mfa(W,cb,da,Ua),Jb=W.Ra.ga(cb);this.UCf(Jb,xa,Fa)}catch(Gc){Wb.a.J(512496737,
805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",Gc.toString())}finally{W.Ena=!1}return}Jb.formatting&&(Ua=Jb.formatting)}if(Pc.ParagraphReader.textLength(W)>=da)try{W.Ena=!0;this.JW.mfa(W,W.Ra.length,da,Ua);const cb=W.Ra.ga(W.Ra.length-1);this.UCf(cb,xa,Fa)}catch(cb){Wb.a.J(512496736,805,10,"SharedCommentFrame::AddCommentRange - Exception{0} when trying to add start/end comment GUIDs",cb.toString())}finally{W.Ena=!1}}nZb(){var W=this.Tk.Fy();
if(W){var xa=Date.now(),da=!1,Fa=new Ka.a;for(var Ua of W){var cb=ld.W1b(Ua,this.Nn.y7(Ua));Fa.$(Ua.commentId,cb)}for(var Jb of W)if(Jb.textAnchoringInfo&&(Ua=this.Nn.y7(Jb))&&(cb=Fa.ga(Jb.commentId),!cb||!cb.isValid||cb.bAg(Jb.textAnchoringInfo)))for(var Gc of Ua.AD())this.aeh(Object(pb.a)(fb.AParagraphNode,Gc),this.wGc(Jb.commentId));for(const pd of W)if((W=Fa.ga(pd.commentId))&&W.isValid&&W.bAg(pd.textAnchoringInfo)&&(this.om.isVisible||0===pd.status)){da=this.wGc(pd.commentId);this.NTb(W.vU,da,
W.startPos,!0);if(W.h6b)for(Jb=1;Jb<W.paragraphs.length;Jb++){if(Gc=W.paragraphs[Jb])this.NTb(Gc,da,0,!0),W.z2.equals(Gc)?this.NTb(W.z2,da,W.endPos,!1):this.NTb(Gc,da,Pc.ParagraphReader.textLength(Gc),!1)}else this.NTb(W.z2,da,W.endPos,!1);W.ZCj();da=!0}da&&Wb.a.J(512496735,805,100,"SharedCommentFrame::EditCommentParagraphMarkers - time taken:{0} ms",Date.now()-xa)}}g3g(W,xa){if((W=this.Tk.Wra(xa.node))&&(xa.property===ue.a.Bnc||xa.property===ue.a.Anc||xa.property===ue.a.Bld||xa.property===ue.a.Cld)){const da=
ld.cN(W);da&&this.nZb();!W.textAnchoringInfo||da||xa.property!==ue.a.Cld&&xa.property!==ue.a.Bld||this.OD.m_j(W,this.wGc(W.commentId),this.Nn.y7(W),this.Hc.Gc.Ma)}}W0f(){this.Yh&&this.w9&&(this.n_.IJe(this.w9.length,this.xbb,this.Go,this.ehe.OWc),this.n_.NJe(Array.clone(this.w9),Array.clone(this.Bcb)),this.MOf(2))}aQj(W,xa){xa=this.Nb.Kc(xa);for(var da=xa.Ab(2);da;da=xa.vf(2))if((da=Object(pb.a)(119,da))&&Rb.a.kfa(da.Bb,W))return!0;return!1}fB(W,xa){xa&&(W=Object(pb.a)(526,xa.node),xa=xa.lZ,W&&2===
xa&&((xa=this.kX.yf)&&xa.slides&&0>=xa.slides.length&&this.om.isVisible&&this.ajc(!1,!1),this.Yh&&(xa=this.Yh.u7,!xa&&this.ua.Ba&&(xa=this.ua.Ba.Bb),this.aQj(xa,W)||this.W0f())))}kZg(W,xa){if((W=this.Tk.Wra(xa.node))&&ld.cN(W)&&(xa=this.Nn.y7(W)))for(const da of xa.AD())this.aeh(Object(pb.a)(fb.AParagraphNode,da),this.wGc(W.commentId))}g2g(W,xa){(W=Object(pb.a)(4,xa.node))&&0<W.AD().length&&(xa.Fsg&192||xa.Fsg&4)&&this.nZb()}efc(W,xa){W=xa.property;xa=xa.node;if(W===Gf.a.fz||W===Gf.a.gz)if(W=this.Tk.Fy()){for(const da of W)da.pos.Y=
xa.MC.y,da.pos.X=xa.MC.x;this.Wed()}}n$c(){Wb.a.J(512496734,805,this.U7a?15:50,"SharedCommentFrame::OnSessionExpired - HasActiveDraft:{0}",this.U7a)}ceb(W,xa){Wb.a.J(512496733,805,this.U7a?15:50,"SharedCommentFrame::OnSessionEnded - SessionEndedReason:{0};HasActiveDraft:{1}",oj.a[xa.vJ],this.U7a)}dispose(){this.Um&&(this.Um.dispose(),this.Um=null);this.bAb&&(this.bAb.dispose(),this.bAb=null);this.ay.efh(Object(Ca.a)(this,this.xHa,"onBeforeSlideSwitched"));this.ay.Tma(Object(Ca.a)(this,this.RUe,"updateCommentsWhenNavigateSlide"));
this.ay.QFb(Object(Ca.a)(this,this.zCf,"activeSlideDOMDisplayed"));this.Eq.vSk(Object(Ca.a)(this,this.g1g,"onPageViewZoomChanged"));this.ks.Pfh(Object(Ca.a)(this,this.onShapeSelected,"onShapeSelected"));this.ks.ISk(Object(Ca.a)(this,this.c2g,"onShapeDeselected"));this.ay.Red(Object(Ca.a)(this,this.n2g,"onShapeTextSelected"));this.ay.uGe(Object(Ca.a)(this,this.PWa,"onSlideBackgroundClicked"));this.ycb.tm(Object(Ca.a)(this,this.efc,"onShapePropertyChange"));this.ycb.sSk(Object(Ca.a)(this,this.g2g,"onShapeInvalidation"));
this.Lc.gRk(Object(Ca.a)(this,this.s_g,"onF6FocusDocument"));this.y4b&&this.m4.execute(W=>{W.wGe(this.RWa)});this.D5c.tm(Object(Ca.a)(this,this.g3g,"onTextAnchorPropertyChanged"));this.rOg.yO(Object(Ca.a)(this,this.fB,"onChildTopologyChanged"));this.D5c.uIa(Object(Ca.a)(this,this.kZg,"onBeforeTextAnchorDisconnect"));this.Ob.QX(Object(Ca.a)(this,this.SYg,"onAppModeSwitched"));this.hZc.Mfh(Object(Ca.a)(this,this.n$c,"onSessionExpired"));this.hZc.Oea(Object(Ca.a)(this,this.ceb,"onSessionEnded"));this.Ob.SFb(Object(Ca.a)(this,
this.zX,"onSetOffline"));this.YG||this.Wc.xb(Zb.a.click,this.wAb,Object(Ca.a)(this,this.pDb,"onCommentPaneParentDivClick"));this.pCh();this.WN=this.wAb=null;this.eq.yjc(Object(Ca.a)(this,this.q$c,"onShapeViewElementAddedOrRemoved"));this.eq.NSk(Object(Ca.a)(this,this.q$c,"onShapeViewElementAddedOrRemoved"));this.ra.Ewa(Object(Ca.a)(this,this.kH,"onSelectionChanged"))}get isReadOnly(){return this.Go}get rSa(){return!!this.Yh}get hasFocus(){return this.gje}Gxi(){const W=new hk.a;var xa=new Od(qc.a.hvb,
lc.a.application);xa.preCallback=Object(Ca.a)(this,this.FEc,"claimFocus");xa.postCallback=Object(Ca.a)(this,this.eZf,"disableOnEmptyDeckAndReadOnly");W.$(0,xa);xa=new Od(qc.a.deleteComment,lc.a.application);xa.preCallback=Object(Ca.a)(this,this.FEc,"claimFocus");xa.postCallback=Object(Ca.a)(this,this.eZf,"disableOnEmptyDeckAndReadOnly");W.$(3,xa);xa=new Od(qc.a.N8g,lc.a.application);xa.preCallback=Object(Ca.a)(this,this.FEc,"claimFocus");xa.postCallback=Object(Ca.a)(this,this.q7g,"postCommentAction");
W.$(2,xa);xa=new Od(qc.a.TWg,lc.a.application);xa.preCallback=Object(Ca.a)(this,this.FEc,"claimFocus");xa.postCallback=Object(Ca.a)(this,this.q7g,"postCommentAction");W.$(1,xa);xa=new Od(yb.a.eoc,lc.a.application);xa.preCallback=Object(Ca.a)(this,this.Tdl,"showHideActionPreCallback");xa.postCallback=Object(Ca.a)(this,this.Sdl,"showHideActionPostCallback");xa.delayActionsUntilRegistration=this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&md.a("DelayCommentsShowHideAction");
W.$(6,xa);return W}Tdl(W,xa,da,Fa,Ua){if(1===da)return!this.ua.Ba||this.isDisabled?8:2;Wb.a.J(36983504,805,50,"New Comment Pane opened.");this.om.Hdb(!!Ua&&Ua.AutoShowHide);return 2}Sdl(W,xa,da,Fa,Ua,cb){if(1===Fa)return W&&this.OD.Mkk(this.ua.Tj),W?32:8;this.dGf(this.om.isVisible,!!cb&&cb.AutoShowHide);return W?32:8}FEc(W,xa,da,Fa,Ua){if(1===da&&this.ra.kSa())return 8;1!==da&&((this.t9b=!!Ua&&Ua.ShouldCanvasTakeFocus)||this.pra(),this.ra.Cy(),this.yje=!0);return 2}q7g(W,xa,da,Fa){if(1===Fa&&(this.HUa||
!this.w9))return 8;this.t9b=!1;return W?32:8}eZf(W,xa,da,Fa){return(1!==Fa||!this.Go&&this.w9)&&this.Hc.Gc?W?32:8:8}fBa(W,xa){return new cd.a(this.T2c.Ie(W,0),this.T2c.Ie(xa,1))}gTf(W,xa){return new cd.a(this.T2c.Ff(W,0),this.T2c.Ff(xa,1))}$sb(W){W=this.Tk.GCa(W);return this.Tk.Wra(W)}Zea(W,xa,da){!this.I3f()||W!==this.Yh.TB.draftId&&W!==this.Yh.commentId?this.asb()&&W===this.Yh.TB.draftId?(this.n_.selectComment(W),this.yr&&this.yr.selectContainer(W,!0),this.D3f&&!this.hasFocus&&1!==xa&&this.pra()):
this.selectComment(this.$sb(W),null,!0,!0,0,xa,da):(W=this.m3d(this.Yh.u7),W)?1!==xa&&(this.Yh.tVc=!0,this.Je.U9(W.we)):(Wb.a.J(512496732,805,10,"SharedCommentFrame::SelectCommentId - InvalidCommentDataState - slide for extended draft not found"),this.endCommentSession(this.Yh.TB.draftId,0))}selectComment(W,xa,da,Fa,Ua,cb,Jb){this.ra.Cy();xa=this.JGb?this.JGb.commentId:null;Jb||this.zJc();0!==cb?W?this.n_.selectComment(W.commentId):this.n_.selectComment(null):0===cb&&(cb=this.Nn.y7(W))&&cb.cS&&this.Nn.Ugd(Xi[cb.cS]);
this.Um&&this.Um.selectComment(W,!0);!this.om.isVisible&&this.yr&&W&&W!==this.JTa&&(cb=this.Tk.G2d(W.commentId))&&(cb=this.Tk.Wra(cb),this.yr.selectContainer(cb.commentId,!this.t9b&&!Jb&&!this.yje),this.yje=!1,this.Hc&&this.Hc.Gc&&this.Hc.Gc.Und(5,!1,this.Ixb));Jb||this.t9b||this.pra();!this.Nn||!this.om.isVisible&&this.om.isVisible||(this.Nn.lJe(W,xa,!0,!1,Jb),ld.cN(W)&&!Jb&&this.nZb());this.Ob.updateCommandUI()}get JGb(){return this.Um&&this.Um.MGb?this.Um.MGb.comment:null}e0k(){if(!this.HUa){const W=
Xd.a.Pl("SelectNextCommentCrossSlide",1),xa=!this.om.isVisible;this.HUa=!0;this.D_c.GXd((da,Fa)=>{this.J_g(da,Fa,1,W)},W,xa)}}h0k(){if(!this.HUa){const W=Xd.a.Pl("SelectPreviousCommentCrossSlide",1),xa=!this.om.isVisible;this.HUa=!0;this.D_c.NXd((da,Fa)=>{this.J_g(da,Fa,0,W)},W,xa)}}J_g(W,xa,da,Fa){Fa.Om("FindCommentEndTime",new Date);this.yb.Cb(new vg.a(2,1,100,()=>{this.HUa&&(this.HUa=!1,this.Ral(W,xa,da)?this.Zea(this.Yh.commentId||this.Yh.TB.draftId,0,!1):xa&&W&&this.Hc.Gc.Ed?W.Bb.equals(this.Hc.Gc.Ed.Bb)?
(this.selectComment(xa,null,!0,!0,2,1,!1),Fa.Wa("CircularSelectCommentInSingleSlide",Yi[da]),Fa.finish()):(this.WEa=Object.assign(new Uh,{slide:W,comment:xa,direction:da,kJe:Fa}),this.Je.U9(W.we)):(this.Ob.updateCommandUI(),Fa.Wa("NoCommentFound",Yi[da]),Fa.finish()))},90,"47"))}Ybg(){let W=-1;if(!this.Yh)return W;if(this.Yh.u7){const xa=this.m3d(this.Yh.u7);xa&&(W=xa.we)}else this.Hc.Gc&&this.Hc.Gc.Ed&&(W=this.Hc.Gc.Ed.we);return W}Ral(W,xa,da){if(!this.Yh||this.Yh.TB.sessionType!==bc.create)return!1;
const Fa=this.Ybg();if(0>Fa)return!1;if(!xa||!W)return!0;xa=this.Hc.Gc.Ed.we;if(1===da)return da=Fa<=xa&&xa<W.we,xa=W.we<=xa&&xa<Fa,Fa<=W.we&&!da||xa;da=Fa>=xa&&xa>W.we;xa=W.we>=xa&&xa>Fa;return Fa>W.we&&!da||xa}nKa(W){0!==W&&this.n_.selectComment(null);this.Um&&this.Um.selectComment(null,!1);if(this.yr&&(this.yr.deselectContainer(),this.Hc&&this.Hc.Gc)){let xa=5;const da=this.ra.rq();da&&da.Pf&&(xa=2);this.Hc.Gc.Und(xa,!1,this.Ixb)}this.Nn&&0!==W&&(this.Nn.VHc(),this.Nn.xHc());this.Ob.updateCommandUI()}o0h(W){this.Qnb(this.$sb(W),
0)}Qnb(W,xa){this.JTa!==W&&(this.Nn&&(W?this.Nn.n0h(W):this.Nn.xHc()),this.JTa=W,0!==xa&&(this.JTa?this.n_.highlightComment(this.JTa.commentId):this.n_.highlightComment(null)),this.Um&&this.Um.Qnb(this.JTa,!0))}c0k(){if(this.tYb){var W=this.$sb(this.tYb),xa=this.Hc.Gc.Ed.sid,da=xa===parseInt(this.JSd);W?(1!==W.status&&2!==W.status||this.qjd(),this.selectComment(W,null,!0,!0,0,1,!1),this.OD.jlk(this.ua.Tj),Wb.a.J(512496730,804,15,"Deep link - Comment successfully found.  CommentId: {0}; DeepLinkedSlideId: {1};",
this.tYb,this.JSd)):(da&&this.Md.es(Object.assign(new La.a,{Code:389,Source:4}),this.Xa.podSessionId),Wb.a.J(512496731,804,15,"Deep link - Comment not found. CommentId: {0}; DeepLinkedSlideId: {1}; CurrentSlideId: {2}",this.tYb,this.JSd,parseInt(xa)))}}get manager(){return this.Tk}get iS(){return"per"}get oUg(){return this.WN}set oUg(W){this.WN=W;this.Um&&(this.Um.parentElement=W)}get SWg(){return this.wac}set SWg(W){this.wac=W}ded(W){this.wFb(W,void 0,!0)}XT(W,xa){xa=!md.a("FixAltF12KeboardingInCommentPane")||
xa;this.Eec(W,xa,!0)}jFe(){!this.YG&&this.om&&(this.wAb.style.display=this.om.isVisible?"flex":"none");this.Um&&(this.Um.setVisibility(this.nab),this.Um.rsh(this.pab),this.Nn.nrb(this.JTa))}ajc(W,xa){this.gBh(W,xa);this.jFe();this.dGf(W,xa)}g1g(){this.Um&&!this.q9b&&this.Um.qVe();this.Wed();this.Mrb&&this.UUe()}u8g(){this.HUa=!1;this.n1f();this.Um&&this.Um.GFe();this.fBb=!1;this.pCh()}n1f(){this.Tk.ACh()}xHa(){this.KFa=this.BZ()||this.asb();this.Nn&&this.KFa&&(this.Nn.VHc(),this.Nn.xHc());this.QWd&&
(this.u8g(),this.LJf())}tbl(){return this.Yh&&this.Yh.u7&&this.ua.Ba?this.Yh.tVc&&Rb.a.kfa(this.Yh.u7,this.ua.Ba.Bb):!1}RUe(){this.QWd||this.u8g();this.ua.Ba||this.xHa(this,null);this.n1f();this.Hc.Gc&&(this.oUg=this.Hc.Gc.mPd);const W=this.Hc&&this.Hc.Gc?this.Tk.Q6a(this.Hc.Gc.Ed):this.Tk.Fy(),xa=this.m7i(W),da=this.BZ()||this.asb();this.u3c||da||(this.Uk.Y9(this.Uk.ANd,this.Uk.pPd),this.u3c=!0);this.om.isVisible||(da?(this.GYb(),this.ggh()):this.BZ()?(this.GYb(),this.aR(!0,!1,!0)):this.cCa&&!this.KFa?
this.aR(!1,!1,!1):this.aR(!1,!1,!0),this.xdh());this.wFb(W,e.AFrameworkApplication.isRtl,!1,xa);this.tbl()?(this.Zea(this.Yh.commentId||this.Yh.TB.draftId,0,!1),this.Yh.tVc=!1):-1<xa&&this.Zea(W[xa].commentId,0,!1);this.WEa&&(this.WEa.kJe.finish(),this.WEa=null);this.WZa(!1);-1!==xa&&this.Um&&(this.Um.Qnb(null,!1),this.Um.selectComment(W[xa],!1));this.QWd||this.LJf()}zCf(){if(this.yre){try{this.K$a.cfl(this.TPg,this.ua,this.Je)}catch(W){Wb.a.J(512496729,805,10,"ActiveSlideDOMDisplayed - Exception while attempting to show resolved comment callout: {0}",
W)}this.yre=!1}}WZa(W){const xa=this.Ybg();this.ehe.WZa(W,xa)}iwl(W){this.Yh&&!this.Yh.u7&&(this.Yh.u7=W)}onShapeSelected(W,xa){this.fKc&&(W=xa.shapeNode,this.zMe(W),W&&0<W.AD().length&&this.nZb())}n2g(W,xa){this.fKc&&(this.zMe(xa.xw.shapeNode),this.nZb())}kH(W,xa){this.D3f&&this.U7a&&this.nKa(1);if(xa&&xa.Xk&&this.ra.a8()&&(W=this.Tk.Fy())){xa=!1;for(var da of W)if(ld.cN(da)){xa=!0;break}xa&&((da=this.ra.JZ())?this.zMe(da):Wb.a.J(512496728,805,10,"SharedCommentFrame::OnSelectionChanged - Text selection exists but associated shape is null."))}}zMe(W){W.get_shapeId()&&
(this.Nn&&W!==this.Nn.OV&&this.nKa(1),this.alh(W.get_shapeId(),!0))}alh(W,xa){var da=this.Tk.Fy();if(da){var Fa=null,Ua=null,cb=0,Jb=null;for(const Gc of da)if((this.om.isVisible||0===Gc.status)&&Gc.anchorShape===W)if(this.ra.a8()&&ld.cN(Gc)){da=this.ra.Oa.kb.Ua;const pd=this.ra.Oa.kb.Ve,Ld=ld.W1b(Gc,this.Nn.y7(Gc));Ld&&Ld.isValid?(this.JGb&&this.JGb.commentId===Gc.commentId||Ld.Eld===Gc.textAnchoringInfo.TextBodyLength)&&Ld.zGj(da,pd)&&(Ua?(da=Ld.Xbh,da<cb&&(Ua=Gc,cb=da)):(Ua=Gc,cb=Ld.Xbh)):(Fa=
Gc,Wb.a.J(512496727,805,10,"SharedCommentFrame::SelectCommentWithShapeId - Comment anchor shape paragraph is null."))}else Ua||Jb||ld.cN(Gc)||(Jb=Gc);Ua?this.Zea(Ua.commentId,1,xa):Jb?this.Zea(Jb.commentId,1,xa):this.ra.a8()&&!Fa?this.Nn&&this.nKa(1):Fa&&this.Zea(Fa.commentId,1,xa)}}c2g(){if(this.fKc){var W=this.y_d();this.Nn.Ugd(String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,W.toString()));this.nKa(1)}}y_d(){const W=this.Tk.Fy();let xa=[];W&&(xa=Pd.e(W,da=>0===da.status));
return xa.length}PWa(){this.fKc&&this.nKa(1)}s_g(W,xa){xa.UCb===Ke.a.Bg&&this.Nn.Ugd(ResourceStrings.l_SlidePanel+", "+String.format(ResourceStrings.L_CommentAnchoringSlideActiveCommentCount,this.y_d().toString()));xa.ohc===Ke.a.Bg&&this.nKa(1)}m7i(W){let xa=-1;if(this.WEa&&this.Hc.Gc)if(this.WEa.slide!==this.Hc.Gc.Ed)Wb.a.J(512496726,805,50,"GetIndexOfCommentToSelect() - Active slide doesn't match expected slide in select context");else if(W&&0<W.length){if(this.om.isVisible)xa=1===this.WEa.direction?
0:W.length-1;else if(1===this.WEa.direction)for(var da=0;da<W.length;da++){if(0===W[da].status){xa=da;break}}else for(da=W.length-1;0<=da;da--)if(0===W[da].status){xa=da;break}0<=xa&&xa<W.length&&(W=W[xa],da=this.WEa.comment,da.dt===W.dt&&da.commentId===W.commentId&&da.authorName===W.authorName||Wb.a.J(512496725,805,15,"GetIndexOfCommentToSelect() - Expected comment doesn't exist in active slide"))}return xa}GZg(){this.Tk.m6i()?this.Yh&&(0===this.Yh.GOa||1===this.Yh.GOa?(this.N3f&&this.wFb(this.Tk.Fy(),
e.AFrameworkApplication.isRtl,!0),0===this.Yh.GOa&&(this.q4c=!0)):this.Yh&&2===this.Yh.GOa&&this.N3f&&this.wFb(this.Tk.Fy(),e.AFrameworkApplication.isRtl,!0)):this.wFb(this.Tk.Fy(),e.AFrameworkApplication.isRtl,!0)}get Ogd(){const W=this.ra.rq();if(W){const xa=W.MC;this.lre=new cd.a(e.AFrameworkApplication.isRtl?xa.x:xa.x+W.Rx,xa.y)}else this.lre=null;return this.lre}get u0k(){if(!this.ra.a8())return null;var W=Object(pb.a)(5,this.ra.Oa.kb.Ve.node);if(!W)return null;const xa=Object(pb.a)(419,W.oc(this.Hc.Gc.Ma));
if(!xa)return null;var da=null,Fa=xa.htmlElement.getElementsByClassName("Selected");if(0<Fa.length)da=Fa[Fa.length-1];else if(this.ra.Oa.vl){if(Fa=this.Jgg())if(Fa=Object(pb.a)(5,Fa.Ve.node))if(Fa!==W){if(W=Object(pb.a)(419,Fa.oc(this.Hc.Gc.Ma)))da=W.htmlElement}else da=xa.htmlElement}else return null;W=this.ra.rq();if(!W||!da)return null;W=Object(pb.a)(121,W.oc(this.Hc.Gc.Ma));if(!W)return null;da=mj.a.ei(da);W=mj.a.ei(W.jq);if(0>=da.width+da.height&&0>=W.width+W.height)return null;W=cd.a.yU(new cd.a(da.x,
da.y),new cd.a(W.x,W.y));return this.gTf(W.x+da.width-5,W.y+10)}get anchorNode(){const W=this.ra.rq();return this.UEg=W?W:this.Hc.Gc.Ed}gBh(W,xa){this.om&&(xa||this.Gmh(),this.fdb.Zoh(W?3:1),!this.isDisabled&&W&&md.a("CommentShimmerBugFix")&&this.NW&&this.NW.isVisible&&(this.NW.tmg(),this.Ob.Hdb(1)),this.aR(!W,!1,!0),this.om.kp(!this.isDisabled&&W,xa),this.om.isVisible&&(this.nab=!0))}aR(W,xa,da){const Fa=this.BZ();da&&(!Fa&&!this.KFa||Fa&&this.KFa)&&Wb.a.J(512496724,805,50,"Slide Resize and render was called for Navigation between slides without comments or both slides with comments but it was unnecessary.");
!this.BZ()&&!this.rSa&&W&&!xa||this.om.isVisible&&W&&!xa||this.BZ()&&this.NW&&this.NW.isVisible&&!W&&!xa||!this.Hc.Gc||!(xa=this.Hc.Gc.rba)||(xa.setVisibility(W),W=new cj.a(W),this.ay.Pah(W),da?this.Ob.Hdb(1):Wb.a.J(512496723,805,50,"Slide Resize and render was redundant. Navigation was between both slides without comments or both slides with comments"),this.Hc.Gc.Und(5,!1,this.Ixb))}ctl(W){this.om&&(this.nab=!this.isDisabled&&W,this.nab||(this.fdb.Zoh(1),this.om.kp(!1,!1),this.Fa.Gj(Ke.a.Op,!1)))}vaj(){const W=
new jg;W.focusCallback=Object(Ca.a)(this,this.kLc,"focusFirstPaneElement");return Object.assign(new qi.a,{title:ResourceStrings.L_Comments,hideHeader:!1,width:parseInt(this.YFl?300:320),contentProps:W,location:2,onOpen:xa=>{Fc.a.jed(xa,[Zb.a.contextMenu]);const da=this.Fa.Dc(Ke.a.Op);this.Wc.DFb(Zb.a.click,xa,Object(Ca.a)(this,this.pDb,"onCommentPaneParentDivClick"),null,da.d_a)},onClose:xa=>{this.ajc(!1,!1);this.Wc.xb(Zb.a.click,xa,Object(Ca.a)(this,this.pDb,"onCommentPaneParentDivClick"))},isModernPane:!0})}LJf(){if(!this.qIg){var W=
this.Tk.Fy();W=!!W&&0<W.length;Wb.a.J(512496722,805,50,"SharedCommentPane::AutoShowHideCommentsPane hasComments:{0}",W);W?this.BZ()&&this.aR(!0,!1,!0):(this.GYb(),this.cCa&&!this.KFa?this.aR(!1,!1,!1):this.aR(!1,!1,!0))}}qjd(){this.om.isVisible||this.ia.processAction(qc.a.qxa,2);this.zJc()}suj(){this.om.isVisible&&this.ia.processAction(qc.a.qxa,2)}hk(W){return this.fe.hk(W)}get isDisabled(){const W=this.kX.yf;return W?W.X7a:!0}VDf(){this.E3c||(this.E3c=new vg.a(0,1,0,Object(Ca.a)(this,this.WLk,"refreshCommentsTask"),
90,"48"),this.yb.Cb(this.E3c))}SYg(W){this.q0g(1===W.mode)}q0g(W){this.Go=W;this.VDf();md.a("PreventCommentPaneCloseOnReadOnlyChanged")?this.W0f():this.om.isVisible&&this.Go&&this.suj()}N1d(){return this.w9?this.w9:[]}Bdg(){return this.Bcb?this.Bcb:[]}get TXg(){return this.xbb}get kHc(){return this.Yh}Ubg(W){const xa=this.Hc&&this.Hc.Gc?this.Tk.Q6a(this.Hc.Gc.Ed):this.lPe(this.Tk.Fy());if(!xa||!xa.length)return 0;let da=null;this.Ogd&&(da=this.fBa(this.Ogd.x,this.Ogd.y));let Fa=-1,Ua=0;for(let pd=
0;pd<xa.length;pd++){var cb=this.Nn.y7(xa[pd]);if(!da&&cb)break;if(cb&&da){var Jb=cb.MC.x,Gc=cb.MC.y;Jb+=xa[pd].pos.X;Gc+=xa[pd].pos.Y;cb.Og&&(cb=this.Ea.ds(cb),Jb+=cb&&cb.MC?cb.MC.x:0,Gc+=cb&&cb.MC?cb.MC.y:0);Gc=this.fBa(Jb,Gc);Jb=Gc.y;Gc=Gc.x;if(da.y<Jb)break;if(da.y>Jb||da.y===Jb&&da.x>=Gc)Fa=pd,xa[pd].Children&&W&&(Ua+=xa[pd].Children.length)}else cb||(Fa=pd,xa[pd].Children&&W&&(Ua+=xa[pd].Children.length))}return Fa+Ua+1}$xj(W){if(!this.Tie)throw Wb.a.J(512496721,805,10,"SharedCommentFrame::InitCommentSession - InvalidCommentDataState - floating container not loaded"),
D.a.mu(-2130915320);if(this.Yh)return Wb.a.J(512496720,805,15,"SharedCommentFrame::InitCommentSession - CommentSessionAlreadyActive"),D.a.mu(-2130915319);if(null===W)throw Error.argumentNull("session");if(!W.commentId.length&&0!==W.GOa)return D.a.mu(-2130915327);this.Yh=W;this.WZa(!0);0===W.GOa&&(this.nKa(0),this.om.isVisible||this.fgh(W));if(this.om.isVisible||!this.om.isVisible)this.pra(),this.IMi();let xa="";W.TB&&(xa=W.TB.draftId);Wb.a.J(512496719,805,50,"SharedCommentFrame::InitCommentSession - Success; DraftId:{0}",
xa);return null}endCommentSession(W,xa){if(this.Yh){if(this.Yh.TB&&this.Yh.TB.draftId!==W)throw Wb.a.J(512496718,805,10,"SharedCommentFrame::EndCommentSession - InvalidArgument; EndingDraftId:{0}, ActiveDraftId:{1}",W,this.Yh.TB.draftId),D.a.mu(-2130915327);this.oGg=xa}9!==xa||this.om.isVisible||this.Fa.IC(Ke.a.Bg);this.Yh=null;this.Ob.updateCommandUI();if(this.yr&&!this.om.isVisible){const da=[Object.assign(new qf,{contentId:W,containerContentType:0,anchorTop:0,anchorLeft:0})];this.yr.detachContainers(da);
this.BZ()||this.aR(!1,!1,!0)}this.k4c.Nyg&&this.fZf();Wb.a.J(512496717,805,50,"SharedCommentFrame::EndCommentSession - Success; DraftId:{0}; EndReason:{1}",W,xa)}get Vri(){return this.oGg}j5(){this.pra()}tYf(W){if(this.Ha.ka("CommentCopyPasteEnabled")&&!this.K$a.jQj)for(const xa of W)for(const da of this.Tk.Xra(xa.xD()))if(1===da.status){this.TPg=new lh(W,this.Tk);this.yre=!0;return}}ub(){1!==this.x9b.Sha&&(this.ia.ya(qc.a.wjd,lc.a.application,Object(Ca.a)(this,this.qxa,"showHideComments")),this.ia.pa(qc.a.V$g,
lc.a.application,Object(Ca.a)(this,this.eIa,"queryShowHideComments"),97));this.A0f&&(this.ia.ya(qc.a.m5a,lc.a.application,Object(Ca.a)(this,this.zYb,"deleteAllComments")),this.ia.ya(qc.a.AYb,lc.a.application,Object(Ca.a)(this,this.zYb,"deleteAllComments")),this.ia.ya(qc.a.BYb,lc.a.application,Object(Ca.a)(this,this.zYb,"deleteAllComments")));this.ia.ya(qc.a.yjd,lc.a.application,Object(Ca.a)(this,this.qxa,"showHideComments"));this.ia.pa(yb.a.Fah,Hb.a.frame,Object(Ca.a)(this,this.eIa,"queryShowHideComments"),
97);this.ia.pa(qc.a.eIa,lc.a.application,Object(Ca.a)(this,this.eIa,"queryShowHideComments"),97);this.ia.pa(qc.a.X$g,lc.a.application,Object(Ca.a)(this,this.eIa,"queryShowHideComments"),97);this.ia.pa(qc.a.Y$g,lc.a.application,Object(Ca.a)(this,this.eIa,"queryShowHideComments"),97);this.ia.ya(qc.a.Jue,lc.a.application,Object(Ca.a)(this,this.h8c,"nudgeCommentMarker"));this.ia.ya(qc.a.Kue,lc.a.application,Object(Ca.a)(this,this.h8c,"nudgeCommentMarker"));this.ia.ya(qc.a.Lue,lc.a.application,Object(Ca.a)(this,
this.h8c,"nudgeCommentMarker"));this.ia.ya(qc.a.Mue,lc.a.application,Object(Ca.a)(this,this.h8c,"nudgeCommentMarker"));this.ia.ya(qc.a.LJb,lc.a.application,Object(Ca.a)(this,this.LJb,"toggleCommentAnchoringFocus"));this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)&&(this.ia.ya(yb.a.yrb,lc.a.application,Object(Ca.a)(this,this.yrb,"doesCommentExist")),this.ia.ya(yb.a.IWb,lc.a.application,Object(Ca.a)(this,this.IWb,"commentActivitySelected")));this.xe()}xe(){var W=
this.Fa.Dc(Vf.AFrame.jj),xa=this.Fa.Dc(Ke.a.HC);const da=this.Fa.Dc(Ke.a.sU);W.bindAction(Ai.KeyInputManager.Na(Zf.a.tya,1),qc.a.LJb);xa.bindAction(Ai.KeyInputManager.Na(Zf.a.tya,1),qc.a.LJb);da.bindAction(Ai.KeyInputManager.Na(Zf.a.tya,1),qc.a.LJb);W=this.Fa.Dc(Ke.a.Op);xa=[W,this.Fa.Dc(Ud.a.oD),this.Fa.Dc(Ud.a.c2),this.Fa.Dc(Ke.a.Bg),this.Fa.Dc(Ke.a.LP)];for(const Fa of xa)Fa.bindAction(Ai.KeyInputManager.Na(Zf.a.Mfa,Ai.KeyInputManager.He|(Fb.a.lk?4:1)),qc.a.hvb);W.bindAction(Ai.KeyInputManager.Na(Zf.a.uya,
1),qc.a.hvb)}wFb(W,xa,da,Fa=-1){this.nua=xa;!this.Um&&this.WN&&(this.Um=new ui(this.WN,this,this.bAb,this.nua,this.nab),this.Nn.I6c=this.Um);if(W){Vh.LXj(W);xa=null;this.ra.a8()&&(xa=this.ra.Oa);var Ua=0<W.length?W[W.length-1]:null;if(this.Um){var cb=this.Um.MGb?this.Um.MGb.comment:null;const Jb=cb?cb.commentId:null;this.Um.isRightToLeft=this.nua;this.Um.ded(W);this.Nn&&(this.BZ()||this.asb())&&(this.Nn.VHc(),this.Nn.xHc());this.Um.selectComment(null,!1);if(this.Yh)cb=this.$sb(this.Yh.commentId),
this.Nn&&this.Nn.lJe(cb,Jb,!1),this.Um.selectComment(cb,!0);else if(da&&cb){const Gc=this.$sb(cb.commentId);this.Nn&&(this.om.isVisible||!Gc||1!==Gc.status&&2!==Gc.status)&&(this.Um.selectComment(cb,!1),this.Nn.lJe(cb,Jb,!1,!0))}else this.q4c&&Ua&&(this.Zea(Ua.commentId,1,!1),this.Um.selectComment(Ua,!1));this.Um.rsh(this.pab);this.pab&&this.Nn.nrb(this.JTa)}this.xbb=W.length;W=this.lPe(W);this.w9=this.vNg.jql(W,this.Go);this.Bcb=this.vNg.iql(W);da?(this.WZa(!0),this.n_.Clh(Array.clone(this.w9),this.xbb,
Array.clone(this.Bcb)),this.q4c&&Ua&&this.n_.selectComment(Ua.commentId)):(da=[],this.asb()&&(da=this.Ubg(!1),da=[Object.assign(new nf,{draftId:this.Yh.TB.draftId,insertIndex:0>Fa?0:da})]),0>Fa?this.n_.IJe(this.w9.length,this.xbb,this.Go,this.ehe.OWc,da):this.n_.P0k(this.w9.length,this.xbb,Fa,this.Go,da),this.n_.NJe(Array.clone(this.w9),Array.clone(this.Bcb)));if(this.wac){if(Fa=this.$sb(this.wac))this.selectComment(Fa,null,!0,!0,0,1,!1),this.wac=null}else xa&&this.ra.qE(xa);W=this.lYf(W);this.v3&&
W&&this.v3.count>W.length&&this.zHi(W);this.cgh(W);this.dhe&&this.oyl();this.q4c=!1}else this.n_.IJe(0,0,this.Go,1),this.n_.NJe([],[]),this.xbb=0,this.Um&&(this.Um.isRightToLeft=this.nua,this.Um.ded(null)),this.Bcb=this.w9=null,this.gBh(!1,!1),this.GYb()}pra(){this.NWb&&this.zJc();this.hasFocus?this.Yh&&this.k4c.Nyg&&!this.I3f()&&this.Fa.IC(Ke.a.HC):this.Fa.IC(this.om.isVisible?Ke.a.Op:Ke.a.k2)}WLk(){this.E3c=null;this.GZg()}pDb(){this.pra();this.ra.Cy();return!1}MOf(W){if(this.Yh){if(!this.Yh.TB)throw Wb.a.J(512496716,
805,10,"CheckDraftConfigurationAndEndCommentSession - InvalidCommentDataState DraftConfiguration is null. EndReason: {0}",W),D.a.mu(-2130915320);this.endCommentSession(this.Yh.TB.draftId,W)}else Wb.a.J(512496715,805,50,"Calling EndCommentSession when there is no currentCommentSession. EndReason: {0}",W),this.endCommentSession("",W)}IMi(){this.fBb=this.Fa.ze.name===(this.om.isVisible?Ke.a.Op:Ke.a.k2);this.k4c.ZFf(!0)}fZf(){this.k4c.ZFf(!1);this.fBb&&(this.Fa.IC(this.om.isVisible?Ke.a.Op:Ke.a.k2),this.fBb=
!1)}ppk(W,xa){if(W&&W.name!==Ke.a.Op&&W.name!==Ke.a.k2&&xa.name===Ke.a.HC)if(this.om.isVisible)this.kLc();else if(this.Yh){W="";switch(this.Yh.GOa){case 0:W=this.Yh.TB?this.Yh.TB.draftId:"";break;case 1:case 2:if(xa=this.Tk.G2d(this.Yh.commentId))W=this.Tk.Wra(xa).commentId}this.yr.selectContainer(W,!0)}this.fBb=!0}opk(){this.fBb=!1}kLc(){this.om.isVisible&&this.fdb.ZVi()}Eec(W,xa,da){this.gje=W;this.Ob.updateCommandUI();(md.a("FixAltF12KeboardingInCommentPane")||!this.YG)&&this.gje&&xa&&this.kLc();
W||da||this.nKa(1)}LWd(W){var xa=this.ua.presentation;if(!xa)return!1;xa=xa.slides;if(!xa)return!1;for(const da of xa)if(xa=Object(pb.a)(jb.a,da))if(xa=this.Tk.Xra(xa.xD()),W)for(const Fa of xa){if(1===Fa.status)return!0}else{if(xa&&0<xa.length)return!0}else Wb.a.J(512496714,805,10,"SharedCommentFrame::FPresentationHasComments - slideNode not found");return!1}AGi(){this.Tk.m5a();const W=this.Tk.Fy();W&&W.length?this.K$a.bsh():this.K$a.$rh(ResourceStrings.l_DeleteAllCommentsOnSlideCallout)}h8c(W,xa,
da){if(1===da)return 32;if(null!==this.olh){xa=this.olh;switch(W){case qc.a.Jue:xa.pos.Y+=20;break;case qc.a.Kue:xa.pos.X-=20;break;case qc.a.Lue:xa.pos.X+=20;break;case qc.a.Mue:xa.pos.Y-=20}this.Um.pxl(xa);this.s6j.qzk(xa)}return 32}zYb(W,xa,da){return!this.A0f||this.Go||this.Yh&&this.Yh.TB?8:1===da?this.L3i(W):this.yGi(W)}L3i(W){switch(W){case qc.a.m5a:return this.Tk.Fy()&&this.Tk.Fy().length?32:8;case qc.a.AYb:return this.LWd(!1)?32:8;case qc.a.BYb:return 1!==this.x9b.Sha&&this.LWd(!0)?32:8;default:return Wb.a.J(512496712,
805,15,"SharedCommentFrame::GetDeleteAllCommentsState - Unexpected actionId: {0}",W),2}}yGi(W){switch(W){case qc.a.m5a:this.AGi();break;case qc.a.AYb:this.K$a.ash(this.Tk,!1);break;case qc.a.BYb:this.K$a.ash(this.Tk,!0);break;default:return Wb.a.J(512496711,805,15,"SharedCommentFrame::DeleteAllCommentsExecute - Unexpected actionId, cannot execute: {0}",W),2}return 32}qxa(W,xa,da,Fa,Ua){if(1===da)return!this.ua.Ba||this.isDisabled?8:32;xa=!this.om.isVisible;da=this.MQ.zi("UserAction",String.format("ShowHideComments: {0}",
xa?"ShowPane":"HidePane"));Wb.a.J(36983504,805,50,"New Comment Pane opened.");W===qc.a.yjd?(this.ctl(!this.nab),this.jFe()):W===qc.a.wjd?(this.pab=!this.pab,this.Nn.$id=this.pab,this.jFe()):this.ajc(xa,!!Ua&&Ua.AutoShowHide);da&&da.stop();return 32}vNi(){this.om.isVisible&&this.Zea(this.Yh.TB.draftId,1,!1)}LJb(){var W=this.Fa.ze.name;if(this.Yh&&this.Yh.TB)return W===Ke.a.Bg?(this.pra(),md.a("FixAltF12KeboardingInCommentPane")||md.a("SelectCommentDuringAlt12ActiveDraftEnable")&&this.vNi()):this.Fa.Bf(Ke.a.Bg),
32;if(this.Nn.Ith||this.Nn.OV){if(W===Ke.a.Bg||W===Ke.a.sU){var xa=this.Nn.OV;this.om.isVisible||(W=0,xa&&(W=xa.get_shapeId()),this.alh(W,!1));this.pra();return 32}if(Lc.a.contains(this.cMf,W)){if((xa=this.JGb)&&ld.cN(xa)){if(W=ld.W1b(xa,this.Nn.OV),W.isValid){const da=[];for(let Ua=0;Ua<W.paragraphs.length;Ua++){const cb=W.paragraphs[Ua];cb&&da.push(ze.SelectionFactory.p2(cb,W.vU.equals(cb)?W.startPos:0,W.z2.equals(cb)?W.endPos:Pc.ParagraphReader.textLength(cb)))}const Fa=new rd.SelectionCollection(da,
0);xa.textAnchoringInfo.AnchoringShape&&xa.textAnchoringInfo.AnchoringShape.SmartArtNodeId?(this.Fa.Bf(Ke.a.sU),this.vKg.execute(Ua=>{(Ua=Object(pb.a)(294,Ua.Nd))&&this.vKg.instance.Yoh(Object(pb.a)(ae.a,Ua),Fa)})):(this.Fa.Bf(Ke.a.Bg),this.ra.qE(Fa))}}else this.Fa.Bf(Ke.a.Bg);return 32}}else{if(Lc.a.contains(this.cMf,W))this.Fa.Bf(Ke.a.Bg);else{W=null;W=this.Hc&&this.Hc.Gc?this.Tk.Q6a(this.Hc.Gc.Ed):this.lPe(this.Tk.Fy());if(!Lc.a.Va(W))for(xa of W)if(this.om.isVisible||0===xa.status){this.Zea(xa.commentId,
1,!1);break}this.pra()}return 32}return 8}dGf(W,xa){W&&!xa?this.YG?this.zJc():(this.Fa.Gj(Ke.a.Op,!0),this.pra(),this.kLc()):xa?W&&this.Fa.T7(Ke.a.Op,Ke.a.jj,this.om,!1):0<this.y_d()||this.Yh&&this.Yh.TB?this.Fa.Gj(Ke.a.k2,!0):this.Fa.Gj(Ke.a.Op,!1);xa||this.Gmh()}Kjk(){this.u3c||(this.Uk.jea(this.Uk.ANd,this.Uk.pPd),this.Uk.iea(this.Uk.ANd,this.Uk.pPd),this.u3c=!0,this.OD.Ljk(this.ua.Tj));this.NW&&this.NW.MRi()}Gmh(){const W=this.Tk.Fy();W&&0<W.length&&(this.qIg=!0)}BZ(){var W=this.Tk.Fy();if(!W||
!W.length)return!1;W=Pd.e(W,xa=>0===xa.status);return!!W&&0<W.length}eIa(W,xa,da,Fa,Ua){W===qc.a.eIa?Ua[$g.a.On]=this.om.isVisible:W===qc.a.X$g||W===yb.a.Fah?Ua[Ch.a.On]=this.om.isVisible:W===qc.a.Y$g?Ua[Ch.a.On]=this.nab:W===qc.a.V$g&&(Ua[Ch.a.On]=this.pab);return!this.ua.Ba||this.isDisabled?16:32}yrb(W,xa,da,Fa,Ua){return 2!==da?32:(W=this.y3f(Ua))&&this.findComment(W)?32:8}IWb(W,xa,da,Fa,Ua){return 2!==da?32:(W=this.y3f(Ua))&&this.zgk(W)?32:8}y3f(W){if(!W)return null;W=W.NavigationId;if(!W)return null;
try{return JSON.parse(W)}catch(xa){return Wb.a.J(512496710,805,10,"ExtractNavParams - Exception while parsing navigation id",xa),null}}zgk(W){if(W.sId!==this.Hc.Gc.Ed.sid){var xa=Rb.a.tE(W.sId,W.cId);xa=this.m3d(xa);if(!xa)return!1;this.Je.U9(xa.we)}xa=this.findComment(W);if(!xa)return!1;1!==xa.status&&2!==xa.status||this.qjd();this.Zea(W.commentId,1,!1);return!0}findComment(W){var xa=this.ua.presentation;if(!xa)return null;xa=xa.slides;if(!xa)return null;for(const da of xa)if((xa=Object(pb.a)(jb.a,
da))&&xa.sid===W.sId){xa=this.Tk.Xra(xa.xD());for(const Fa of xa){if(Fa.commentId===W.commentId)return Fa;if(Fa.Children&&Fa.Children.length)for(const Ua of Fa.Children)if(Ua.commentId===W.commentId)return Ua}}return null}isCollapsed(){return!1}get olh(){return null}clearSelection(){}eMk(){this.Ob.updateCommandUI()}get U7a(){return!!this.Yh}Ooi(){this.Yh&&this.MOf(8)}a$(W){2===W.behavior&&W.actionId===qc.a.Oeb&&(W=this.yv.XMc(!0),W!==qc.a.Cad&&W!==qc.a.qS&&W!==qc.a.m5a&&W!==qc.a.AYb&&W!==qc.a.BYb||
Kd.UISurfaces.gN().then(xa=>{this.K$a.zPk(xa)}))}Z9(){}static pUg(W,xa){return W.contentId===xa}static LXj(W){let xa="";if(W){for(const da of W)if(xa+=da.commentId+";",da.Children)for(const Fa of da.Children)xa+=Fa.commentId+";";Wb.a.J(512496659,805,15,"LogCommentIds() - {0}",xa)}}}Object(h.a)(Vh,"SharedCommentFrame",null,[1082,106,1083,147]);class Ji{constructor(W,xa,da,Fa,Ua,cb,Jb=null){this.date=this.author=this.commentBody=this.parentId=this.commentId=null;this.commentFlags=0;this.usersByReactionType=
null;this.commentId=W;this.parentId=xa;this.commentBody=da;this.author=Fa;this.date=Ua;this.commentFlags=cb;this.usersByReactionType=Jb}}Object(h.a)(Ji,"OfficeSharedCommentModel",null,[]);class Bi{constructor(W,xa){this.CommentId=W;this.ResolveState=xa}}Object(h.a)(Bi,"CommentProperties",null,[]);class Eh{constructor(){this.email=this.fullName="";this.resolveState=0}}Object(h.a)(Eh,"AtMentionAttributes",null,[]);class rh{constructor(){this.contentId=""}}Object(h.a)(rh,"AtMentionOptionalAttributes",
null,[]);class sg{constructor(){this.atmention=this.altText=this.lang=null;this.italic=!1;this.link=null;this.underline=this.strikethrough=!1;this.weight=0;this.paragraph=this.color=this.highlight=null}}Object(h.a)(sg,"DeltaAttributes",null,[]);var ci;(function(W){W[W.Undo=-1]="Undo";W[W.Unknown=0]="Unknown";W[W.Create=1]="Create";W[W.Assign=2]="Assign";W[W.Unassign=3]="Unassign";W[W.UnassignAll=4]="UnassignAll";W[W.Schedule=5]="Schedule";W[W.Progress=6]="Progress";W[W.Delete=7]="Delete";W[W.Restore=
8]="Restore";W[W.SetTitle=9]="SetTitle";W[W.Priority=10]="Priority"})(ci||(ci={}));Object(h.b)("HistoryRecordType",ci);class dj{constructor(){this.Id=this.FullName=this.Email=this.DispName=null}}Object(h.a)(dj,"CommentAtMention",null,[]);var Zi=d(882);class Ri{constructor(){this.UserId=this.ProviderId=this.FullName=this.Email=this.DisplayName=null}}Object(h.a)(Ri,"UserInfo",null,[]);class Fh{constructor(W,xa){this.plainText=W;this.NWg=xa}}Object(h.a)(Fh,"TextTranslationResult",null,[]);var Rj=d(67);
class mh{constructor(W,xa,da){this.DWk="[";this.oci=RegExp("\\<\\@(.*?)\\>|\\[\\@(.*?)\\]");this.mVj=RegExp("(?:https?:\\/\\/|www\\.)[^\\s]+","gi");this.pci=RegExp("(\\<\\@.*?\\>|\\[\\@.*?\\]|(?:https?:\\/\\/|www\\.)[^\\s]+)","gi");this.aEg=!1;this.fc=W;this.ure=xa;this.Ine=da}get userId(){return this.fc.appSettings["387"]}get providerId(){return this.fc.appSettings["388"]}dfj(W,xa){let da=0;if(1===W.status||2===W.status)da|=8;xa&&(da|=1);this.mbl(W)&&(da|=16);this.fc.ka("PPTOBlueDotsForComments")&&
W.isUnread&&(da|=32);return da}isCurrentUser(W){return Pb.a.Va(W.userId)?!1:"Author"===W.userId||this.userId===W.userId&&this.providerId===W.providerId?!0:!1}mbl(W){return""===W.userId||"Author"===W.userId||!this.pBl(W.userId)||this.userId===W.userId&&this.providerId===W.providerId?!1:!0}pBl(W){return 3===W.split("::").length}tzh(W,xa,da){if(null===W)throw Error.argumentNull("comment");const Fa=this.lql(W.text);var Ua=W.authorName;const cb=md.a("PPTPlumbEmailThroughCG")?Ga.a.Z5a(W.userId||""):"",
Jb=W.dt;da=this.dfj(W,da);Ua=new ab(W.userId,W.providerId,Ua,cb,this.isCurrentUser(W));return new Ji(W.commentId,xa,Fa,Ua,Jb,da)}jql(W,xa){if(null===W)throw Error.argumentNull("comments");const da=new r.a;for(const Fa of W)if(da.add(this.tzh(Fa,"",xa)),Fa.Children&&0<Fa.Children.length)for(const Ua of Fa.Children)da.add(this.tzh(Ua,Fa.commentId,xa));return da.toArray()}pql(W,xa,da,Fa){const Ua=Object.assign(new Zi.a,{Asignees:[]});W=this.ure.xYi(W,xa,!xa.taskId,da);for(const cb of W)2===cb.type?cb.assignee?
(W=Object.assign(new Ri,{DisplayName:cb.assignee.DisplayName,FullName:cb.assignee.DisplayName,UserId:cb.assignee.UserId,ProviderId:cb.assignee.Provider,Email:cb.assignee.Email}),Ua.Asignees.push(W)):Wb.a.J(512496658,845,10,"TranslateSharedTaskMetadataToTaskInfo - History record type is assign, but Assignee is null."):9===cb.type&&(Ua.Title=cb.title);if(!Ua.Asignees)return Wb.a.J(512496657,845,10,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo assignee is null and not set."),null;Ua.Title||(Wb.a.J(512496656,
845,15,"TranslateSharedTaskMetadataToTaskInfo - TaskInfo title is null and not set."),Ua.Title=Fa);return Ua}nql(W,xa){const da=new Zi.a;if(W.assignee){const Fa=new Ri,Ua=W.assignee;Fa.DisplayName=Ua.Name;Fa.FullName=Ua.Name;Fa.UserId=Ua.UserPrincipalName;Fa.ProviderId="O365";Fa.Email=Ua.UserPrincipalName;da.Asignees=[Fa]}da.Title=W.title?W.title:xa;return da}oql(W,xa,da){if(!xa)return null;try{const Fa=this.Emd(da,new Date).plainText,Ua=this.Ine?this.pql(W,xa,da,Fa):this.nql(xa,Fa);if(!Ua)return null;
Ua.CompletionPercentage=xa.completion?xa.completion:0;return Ua}catch(Fa){Wb.a.J(512496655,845,10,"TranslateSharedTaskMetadataToTaskInfo - Exception thrown: {0}",Fa)}return null}iql(W){if(null===W)throw Error.argumentNull("comments");const xa=new r.a;for(const da of W)da.taskInfo&&da.taskInfo.Asignees&&0<da.taskInfo.Asignees.length&&(W=this.hql(da))&&xa.add(W);return xa.toArray()}hql(W){if(this.Ine&&this.ure&&0<W.taskInfo.TaskHistoryRecords.length)try{const xa=mh.swi(W.taskInfo.TaskHistoryRecords),
da=new Rj.a;da.add(W.commentId,new Bi(W.commentId,100===W.taskInfo.CompletionPercentage));const Fa=this.ure.FDi(W.commentId,W.commentId,xa,da);mh.Smi(W,Fa,this.Ine);return Fa}catch(xa){return Wb.a.J(512496654,845,10,"TranslateCommentTaskToSharedCommentTaskItem Failed due to [{0}]",xa.message),this.szh(W)}else return this.szh(W)}szh(W){var xa=new ea;xa.startDate=W.taskInfo.StartDate;xa.endDate=W.taskInfo.DueDate;const da=new qa(W.taskInfo.Asignees[0].UserId);da.DisplayName=W.taskInfo.Asignees[0].DisplayName;
da.Provider=W.taskInfo.Asignees[0].ProviderId;da.Email=W.taskInfo.Asignees[0].Email;const Fa=Array(1);Fa[0]=da;xa=new ia(!1,W.taskInfo.Title,Fa,xa,W.taskInfo.CompletionPercentage,0);return new Z(W.commentId,W.commentId,xa,[])}lql(W){if(null===W)throw Error.argumentNull("nativeText");const xa=new ta;W=W.split(this.pci);for(const Fa of W){var da=this.oci.exec(Fa);da&&3===da.length?(W=new Eh,da[0].substring(0,1)===this.DWk?(W.fullName=da[2],W.resolveState=1):(W.fullName=da[1],W.resolveState=0),W.email=
"UnknownEmail",da=new rh,da.contentId="Pre-existing Mention",xa.rBj("@"+W.fullName,W,da),this.aEg||(this.aEg=!0,Wb.a.J(512496653,845,15,"Rendering mention when AtMentions are disabled."))):(W=this.mVj.exec(Fa))&&1===W.length?(W=W[0],xa.insertHyperLink(W,Object.assign(new sg,{link:W}))):xa.XBj(Fa)}return xa.P3i()}Emd(W,xa){var da=Sys.Serialization.JavaScriptSerializer.deserialize(W);W=[];xa||(xa=new Date);const Fa=new Sys.StringBuilder;for(const Ua of da.ops)if(Ua.attributes){if(Ua.attributes.atmention){const cb=
1<Ua.insert.length?Ua.insert.substring(1,Ua.insert.length):"";if(Ua.optional&&Ua.optional.atmention&&Ua.optional.atmention.contentId)da=mh.ecg(cb,1===Ua.attributes.atmention.resolveState);else{da=mh.ecg(cb,1===Ua.attributes.atmention.resolveState);const Jb=mh.q$i(xa,1===Ua.attributes.atmention.resolveState);Array.add(W,Object.assign(new dj,{FullName:Ua.attributes.atmention.fullName,DispName:cb,Id:Jb,Email:Ua.attributes.atmention.email}));xa=new Date(xa.getTime()+1)}}else Ua.attributes.link||Wb.a.J(512496652,
845,10,"Unsupported formatting discovered in Delta. Stripping out rich text."),da=Ua.insert;Fa.append(da)}else Fa.append(Ua.insert);return new Fh(Fa.toString(),W)}static Rwi(W){switch(W){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;case 6:return 6;case 7:return 10;case 8:return 9;case 9:return-1;default:return 0}}static Owi(W){var xa=null;W.User&&(xa=new qa(W.User.UserId,W.User.ProviderId,W.User.DisplayName));xa=new X(mh.Rwi(W.HistoryRecordType),
xa,W.DtTime,W.RecordId);xa.commentId=W.CommentId;W.Assignee&&(xa.assignee=new qa(W.Assignee.UserId,W.Assignee.ProviderId,W.Assignee.DisplayName));W.StartDate&&W.DueDate?(xa.schedule=new ea,xa.schedule.startDate=W.StartDate?W.StartDate:null,xa.schedule.endDate=W.DueDate?W.DueDate:null):W.StartDate&&!W.DueDate?Wb.a.J(512496651,845,10,"ConvertToOfficeSharedHistoryRecord schedule end date is null but start date is not"):!W.StartDate&&W.DueDate&&Wb.a.J(512496650,845,10,"ConvertToOfficeSharedHistoryRecord schedule start date is null but end date is not");
var da=W.Priority;0<da?xa.priority=da:Wb.a.J(512496649,845,10,"Priority is negative");da=W.CompletionPercentage;0<=da?xa.completion=da:Wb.a.J(512496648,845,10,"Percent complete is negative");xa.title=W.Title;xa.undoId=W.UndoId;return xa}static swi(W){const xa=W.length,da=Array(xa);for(let Fa=0;Fa<xa;++Fa)da[Fa]=mh.Owi(W[Fa]);return da}static Smi(W,xa,da){const Fa=xa.currentState,Ua=W.taskInfo;let cb=!1;const Jb=md.a("SetTaskFromTaskStateInsteadOfHistory");Ua.StartDate.toString()!==Fa.schedule.startDate.toString()&&
(Jb&&(Fa.schedule.startDate=Ua.StartDate),cb=!0,Wb.a.J(512496647,845,10,"Start Date does not match."));Ua.DueDate.toString()!==Fa.schedule.endDate.toString()&&(Jb&&(Fa.schedule.endDate=Ua.DueDate),cb=!0,Wb.a.J(512496646,845,10,"End Date does not match."));Ua.CompletionPercentage!==Fa.completion&&(Jb&&(Fa.completion=Ua.CompletionPercentage),cb=!0,Wb.a.J(512496645,845,10,"Completion percentage does not match."));Ua.Title!==Fa.title&&(Jb&&(Fa.title=Ua.Title),cb=!0,Wb.a.J(512496644,845,10,"Title does not match."));
Ua.Asignees[0].UserId!==Fa.assignees[0].UserId&&(Jb&&(Fa.assignees[0].UserId=Ua.Asignees[0].UserId),cb=!0,Wb.a.J(512496643,845,10,"Assigned to user id does not match."));Ua.Asignees[0].DisplayName!==Fa.assignees[0].DisplayName&&(Jb&&(Fa.assignees[0].DisplayName=Ua.Asignees[0].DisplayName),cb=!0,Wb.a.J(512496642,845,10,"Assigned to display name does not match."));Ua.Asignees[0].ProviderId!==Fa.assignees[0].Provider&&(Jb&&(Fa.assignees[0].Provider=Ua.Asignees[0].ProviderId),cb=!0,Wb.a.J(512496641,845,
10,"Assigned to provider id does not match."));Ua.Asignees[0].Email!==Fa.assignees[0].Email&&(Jb&&(Fa.assignees[0].Email=Ua.Asignees[0].Email),da||(cb=!0,Wb.a.J(512496640,845,10,"Assigned to email does not match.")));cb&&da&&mh.h_j(W,xa)}static h_j(W,xa){const da=new r.a;for(const Fa of xa.history)for(const Ua of Fa.records)da.add(ci[Ua.type]);if(da.count!==W.taskInfo.TaskHistoryRecords.length){xa=new r.a;for(const Fa of W.taskInfo.TaskHistoryRecords)xa.add(ci[Fa.HistoryRecordType]);Wb.a.J(512496611,
845,10,"LogTaskHistoryDetailsForMismatch")}}static q$i(W,xa){W=W._toFormattedString("yyyy-MM-ddThh:mm:ss:fff",Sys.CultureInfo.InvariantCulture);return xa?W+"_Z":W}static ecg(W,xa){return xa?"[@"+W+"]":"<@"+W+">"}}Object(h.a)(mh,"SharedCommentModelTranslator",null,[1079]);class va{constructor(W,xa,da){this.EUa=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled")&&e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesF6LoopFixesIsEnabled");this.mcf=!1;this.Fa=
W;this.lh=xa;this.myb=da}ZFf(W){W?(this.EUa&&this.myb&&this.myb.isVisible||this.lh.lK(Ke.a.HC),this.lh.zo(Ke.a.Op),this.Fa.IC(Ke.a.HC)):(this.lh.zo(Ke.a.HC),this.myb.isVisible&&!this.EUa&&this.lh.lK(Ke.a.Op));this.mcf=W}get Nyg(){return this.mcf}}Object(h.a)(va,"SharedCommentsRTEFocusActionHelper",null,[1060]);class Qa{constructor(W,xa,da,Fa){this.cancelButton=this.confirmButton=this.body=this.title=null;this.title=W;this.body=xa;this.confirmButton=da;this.cancelButton=Fa}}Object(h.a)(Qa,"ViewContainerModalDialogStrings",
null,[]);class db{constructor(W,xa,da){this.containerType="full-pane";this.identifier=null;this.hb=W;this.Fa=xa;this.identifier=da}closeView(){this.hb.ajc(!1,!1)}openView(){this.hb.ajc(!0,!1)}invokeModalConfirmationDialog(W,xa,da){const Fa=new yh.StandardDialog;da&&da.title&&da.body&&da.confirmButton&&da.cancelButton||(Wb.a.J(35496838,805,10,"InvokeModalConfirmationDialog: No localized strings provided."),da=new Qa("","","",""));Fa.yd=1;Fa.Ue(1,da.confirmButton);Fa.Ue(0,da.cancelButton);Fa.t5a=this.Fa.ze.name;
Fa.gec=!0;Fa.nx(da.title,da.body,1,Ua=>{1===Ua?(W(),Fa.t5a=null):xa()})}}Object(h.a)(db,"ViewContainerAPI",null,[1074,1075]);class Gb extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Gb,"CommentsPackageLoadedEventArgs",Sys.EventArgs,[]);var jc=d(277);class Ac{constructor(){this.XMg=this.oSg=this.fdb=this.kTg=this.Dua=this.XYc=this.wGa=this.ZYc=this.uQ=this.K=null;this.lab=this.Vta=this.Oyb=!1;this.MQ=this.lhe=null;this.tOg="6F1926CF-E872-4C4C-9393-3956FCFEB98A";this.JN=null;this.EUa=!!e.AFrameworkApplication.fa&&
e.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesM2IsEnabled");this.YG=!1}Wb(W){this.K=W;this.YG=this.K.resolve("PowerPointWebEditor.IApplicationSettings").tPd;this.MQ=this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");this.fdb=new I(e.AFrameworkApplication.pe,"CommentPane");W.register(Sa,"PowerPointWebEditor.CommentEditor").as("PowerPointWebEditor.ICommentEditor").ma().na(()=>new Sa);const xa=this.K.resolve("PowerPointWebEditor.IFileInfo").Sha,da=2===xa||3===xa;this.Oyb=da;
this.lab=1===xa;W.register(Qc,"PowerPointWebEditor.CommentTelemetryManager").as("PowerPointWeb.Comments.ICommentTelemetryManager").ma().na(()=>new Qc(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),xa));W.register(ib,"PowerPointWebEditor.CommentManager").as("PowerPointWeb.Comments.ICommentGraphManager").ma().na(()=>new ib(this.MQ,
xa,this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),this.K.resolve("PowerPointWebEditor.IClassFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader"),this.K.resolve("PowerPointWebEditor.ICommentEditor"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.Ka("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager")));const Fa=this.Oyb||!this.lab;this.JN=this.K.resolve("PowerPointWeb.Comments.ICommentGraphManager");Fa&&W.register(488,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>").ma().na(()=>new jc.a((pd,Ld)=>
{let de=null;const Be=Object(pb.a)(121,pd.oc(W.resolve("Box4.IPageView").Ma));Be&&!Be.ll&&(pd=W.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").IRd(W.resolve("PowerPointWebEditor.IPptSelectionManager"),null,pd,Ld,Be.nU),de=new Nd(pd),de.ym(Be.nU),Be.Ypa(de,5),de.visible=Be.aQ||Be.Kn);return de}));this.K.register(1057,"PowerPointWeb.Comments.ICommentMarkerAnchorHelper").ma().na(()=>new yc(this.JN,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),
W.resolve("PowerPointWebEditor.Graph.ITableReader")));this.K.register(1058,"PowerPointWeb.Comments.ICommentMarkerPositionHelper").ma().na(()=>new Mc(this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Fd,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.JN));const Ua=this.Oyb||!this.lab;this.K.register(1059,"PowerPointWeb.Comments.ICommentMarkerViewElementFactory").ma().na(()=>new Oh(this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerPositionHelper"),
new $d(Ua),this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Ua,Ua));this.K.register(pf,"PowerPointWebEditor.CommentTextAnchorHighlightActor").ma().na(()=>new pf(!this.lab,this.K.resolve("Common.Utils.IHighContrastDetector")));const cb=new Yf(Fa,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),Fa?this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeCommentsAnchoredSelectionView>"):null,this.JN,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("PowerPointWebEditor.IAriaManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerAnchorHelper"),this.K.resolve("Box4.Highlight.IHighlightManager"),this.K.resolve("PowerPointWebEditor.CommentTextAnchorHighlightActor"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"));W.register(1060,"PowerPointWebEditor.IRTEFocusActionHelper").ma().na(()=>new va(W.resolve("Common.IFocusManager"),W.resolve("Common.IF6Manager"),W.resolve("PowerPointWebEditor.ICommentsPane")));
this.K.register(Q,"Common.Comments.OfficeSharedCommentsEventHost").as("Common.Comments.IOfficeSharedCommentsEventHost").ma().na(()=>new Q(this.K.resolve("Common.ITaskManager")));const Jb=this.K.resolve("Common.IAppSettingsManager").ka("TasksHistoryEnabled");Jb&&this.K.register(1061,"Common.Comments.ICommentTaskTranslator").ma().na(()=>(new ua(!0,Jb,!0)).zyi());this.K.register(mh,"PowerPointWebEditor.SharedCommentModelTranslator").as("PowerPointWeb.Comments.ISharedCommentModelTranslator").ma().na(()=>
new mh(this.K.resolve("Common.IAppSettingsManager"),Jb?this.K.resolve("Common.Comments.ICommentTaskTranslator"):null,Jb));this.K.register(Ma,"Common.Comments.CommentActivationManager").as("Common.Comments.ICommentActivationManager").ma().na(()=>new Ma);this.Vta=this.K.resolve("Common.IAppSettingsManager").ka("896")&&(da||!this.lab);this.K.register(Vh,"PowerPointWebEditor.SharedCommentFrame").as("PowerPointWeb.Comments.ICommentFrame").as("PowerPointWebEditor.ICommentSessionManager").ma().na(()=>new Vh(this.JN,
this.K.resolve("PowerPointWeb.Comments.ICommentTelemetryManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.ICommentsPane"),this.K.resolve("Common.DragInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.ICommentsPane").xa,
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPoint.IDateHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),
this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.fdb,this.K.resolve("PowerPointWebEditor.IRTEFocusActionHelper"),e.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Fd,this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWeb.Comments.ICommentMarkerViewElementFactory"),this.MQ,cb,this.K.resolve("Common.IAppSettingsManager"),this.K.Ka("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),Fa,W.resolve("PowerPointWebEditor.IErrorHandler"),W.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Vta,W.resolve("Box4.Graph.IGraphInstance").vd(10),W.resolve("PowerPointWebEditor.View.IViewEventSource"),
W.resolve("PowerPointWebEditor.ICommentCloudPolicy"),Ua,W.resolve("PowerPointWebEditor.IShapeReader"),W.Ka("Common.App.SafeLinks.ISafeLinksManager"),W.resolve("Box4.ICharacterPropertiesEditor"),W.resolve("PowerPointWebEditor.IFileInfo"),this.YG,W.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").vCb?this.K.resolve("PowerPointWebEditor.ICommentShimmerView"):
null,this.K.Ka("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.Ka("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers")));this.K.register(Db,"Common.Comments.OfficeSharedCommentsActionHost").as("Common.Comments.IOfficeSharedCommentsActionHost").ma().na(()=>new Db(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame").p0j));this.K.register(db,"PowerPointWebEditor.ViewContainerAPI").as("PowerPointWeb.Comments.IPptViewContainerAPI").ma().na(()=>
new db(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.tOg));const Gc=new Ed(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new Cg(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler")),this.JN,this.K.resolve("Common.IAppSettingsManager").ka("459"),this.K.le("PowerPointWeb.Comments.ICommentFrame"));this.K.register(1062,"PowerPointWebEditor.IFindCommentLogic").ma().na(()=>
new Ie(Gc,this.K.resolve("Common.ITaskManager")));this.K.register(Ye,"PowerPointWebEditor.CommentsChangeListener").ma().na(()=>new Ye(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").vd(7),this.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),this.K.resolve("PowerPointWeb.Comments.ICommentFrame")));this.K.register(1063,"PowerPointWebEditor.ICommentContextDetailsUpdateHelper").ma().na(()=>
new fg(this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFindCommentLogic"),this.JN,this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("Common.ITaskManager")));this.K.register(dh,"PowerPointWebEditor.CommentPropertyTracker").ma().na(()=>new dh(Object(Ca.a)(this.K.resolve("PowerPointWeb.Comments.ICommentFrame"),
this.K.resolve("PowerPointWeb.Comments.ICommentFrame").GZg,"onCommentPropertiesUpdated"),Tb.App.JO.DU,Ub.GraphTransactionManager.instance));this.K.register(1064,"PowerPointWebEditor.ICommentsPane").ma().na(()=>new gi(this.K.resolve("PowerPointWebEditor.IFrameContext"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").eta,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),this.YG));this.K.register(jh,"PowerPointWebEditor.CommentSmartReplyProvider").ma().na(()=>
new jh(this.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager")))}init(){Lb.a.instance.hc(fc.a.sPd,(new Date).getTime());const W=this.MQ.zi("UserAction","InitCommentsPackage"),xa={};this.YG||(this.wGa=this.K.resolve("PowerPointWebEditor.ICommentsPane").xa);this.uQ=this.K.resolve("PowerPointWeb.Comments.ICommentFrame");this.uQ.initialize();var da=W.Kq;xa.CommentFrameInitMS=da;this.K.resolve("PowerPointWebEditor.ICommentSessionManager");
this.ZYc=this.K.resolve("PowerPointWebEditor.CommentPropertyTracker");this.ZYc.Puj();const Fa=W.Kq;xa.CommentPropertyTrackerInitMS=Fa-da;this.lhe=this.K.resolve("PowerPointWebEditor.CommentsChangeListener");this.kTg=this.K.resolve("PowerPointWeb.Comments.IPptViewContainerAPI");var Ua=nb.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());da=Ua.Ring||"Unknown";Ua=Ua.WACDatacenter||"Unknown";const cb=this.K.resolve("PowerPointWebEditor.IApplicationSettings").AEj;var Jb=e.AFrameworkApplication.fa.Ga("LokiComplianceEnvironment");
Jb=Jb&&""!==Jb?Jb:e.AFrameworkApplication.fa.Ga("SovereignEnvironmentName");this.oSg=new vb("PowerPoint",e.AFrameworkApplication.buildVersion,null,null,e.AFrameworkApplication.userSessionId,da,Ua,!cb,this.K.resolve("Common.IActionManagerExtended"),null,Jb);da=Xb.a.oe(e.AFrameworkApplication.lcid);this.XMg=new Uc(e.AFrameworkApplication.isRtl,da?da.name:Sys.CultureInfo.CurrentCulture.name,e.AFrameworkApplication.uiCulture,e.AFrameworkApplication.dataCulture);this.YG||(this.wGa.id=this.tOg);this.Q3b();
e.AFrameworkApplication.fa.ff(Object(Ca.a)(this,this.Gm,"onFullAppSettingsReady"));(da=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"))&&da.EGk(new Gb);da=W.Kq;xa.CommentReactPaneInitMS=da-Fa;this.ayj();xa.CommentPaneInitMS=W.Kq-da;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartRepliesIsEnabled",!1)&&this.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider").initialize();W.stop();Wb.a.J(512262878,805,15,"CommentsPackage::Init telemetry InitTimeMS:{0}; ModernCommentsReloadEnabledWithoutRoundtrip:{1}",
xa,this.K.resolve("Common.IAppSettingsManager").ka("896"))}ayj(){const W=this.K.resolve("PowerPointWebEditor.ICommentsPane"),xa=this.K.resolve("PowerPointWebEditor.IPaneManager");this.YG||(!this.EUa||this.EUa&&!document.getElementsByClassName("CommentPanel").length)&&xa.pP(W);xa.txb(2);this.K.resolve("PowerPointWebEditor.IFocusManager").T7(Ke.a.Op,Ke.a.jj,W,!W.isVisible)}Q3b(){Lb.a.instance.hc(fc.a.Q3b,(new Date).getTime());const W=this;this.K.resolve("PowerPointWebEditor.ICommentCloudPolicy").Qqb().then(xa=>
{Lb.a.instance.hc(fc.a.Z7d,(new Date).getTime());hb.a.Ju(W.K.Ka("Common.App.People.IExternalPeopleAPI")).continueWith(da=>{W.Dua=da.result;W.Dua||Wb.a.J(512262877,805,10,"InitOfficeSharedComments: IExternalPeopleAPI instance is null");W.K.resolve("PowerPointWebEditor.IApplicationSettings").tg&&(da=W.K.resolve("Common.IAppSettingsManager").Ga("368"),W.Dua.x4g(da+"p"));da=[Zb.a.contextMenu];W.YG||Fc.a.jed(W.wGa,da);const Fa=xa&&(W.Oyb||!W.lab),Ua=W.K.resolve("Common.IAppSettingsManager").ka("PositionDraftCommentCardOnCommentsPaneBasedOnAnchorPositionEnabled");
W.K.register(De,"PowerPointWebEditor.PPTSharedCommentAppCapabilities").as("Common.Comments.IOfficeSharedCommentsAppCapabilities").ma().na(()=>new De(W.K.resolve("Common.IAppSettingsManager"),W.K.resolve("PowerPointWebEditor.IApplicationSettings"),W.Dua,W.lab,Fa,W.Vta));W.K.register(Vb,"PowerPointWebEditor.CommentAPI").as("PowerPointWebEditor.IPptOfficeSharedCommentAPI").ma().na(()=>new Vb(W.K.resolve("PowerPointWeb.Comments.ICommentFrame"),W.JN,W.K.resolve("Common.Comments.IOfficeSharedCommentsEventHost"),
W.K.resolve("Common.Comments.IOfficeSharedCommentsActionHost"),W.K.resolve("Common.ITaskManager"),W.K.resolve("Common.IAppSettingsManager"),W.K.resolve("PowerPointWeb.Comments.ISharedCommentModelTranslator"),W.K.resolve("PowerPointWebEditor.ICommentContextDetailsUpdateHelper"),W.Dua,W.K.resolve("PowerPointWebEditor.ICommentCloudPolicy"),W.K.resolve("PowerPointWebEditor.CommentSmartReplyProvider"),Fa,W.Vta,Ua,W.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),W.K.resolve("Common.IActionManagerExtended"),
W.K.resolve("PowerPointWebEditor.IApplicationSettings")));W.XYc=W.K.resolve("PowerPointWebEditor.IPptOfficeSharedCommentAPI")},11).continueWith(()=>{W.XYc&&W.XYc.checkAtMentionCapability().then(da=>{da&&((da=W.K.Ka("Common.ISystemInitiatedFeedback"))?da.execute(Fa=>{Fa.logActivity("Office_Docs_SharedComments_InitializeWebFloodgate","InitializeFloodgateServiceInCommentsPane")}):Wb.a.J(512262876,805,10,"InitOfficeSharedComments:InitOfficeSharedComments sifFuture should not be null."))});W.Zxj()})})}Zxj(){Lb.a.instance.hc(fc.a.FMe,
(new Date).getTime());const W=this.K.resolve("Common.IDynamicScriptLoaderProvider").Jv,xa=this.K.resolve("Common.Comments.IOfficeSharedCommentsAppCapabilities"),da=this.K.resolve("Common.Comments.ICommentActivationManager");Lb.a.instance.hc("CommentActivationManagerInitStart",(new Date).getTime());da.initialize(W,this.XYc,this.oSg,this.Dua,new ob(this.kTg,this.fdb),this.XMg,null,xa.efj());Lb.a.instance.hc(fc.a.f4b,(new Date).getTime());da.f4b().then(()=>{Lb.a.instance.hc(fc.a.$7d,(new Date).getTime());
this.uQ.BAj();Lb.a.instance.hc(fc.a.mee,(new Date).getTime());fd.a(this.K)("floatingContainerManager").then(()=>{Lb.a.instance.hc(fc.a.eYd,(new Date).getTime());this.uQ.jyj();Lb.a.instance.hc(fc.a.fYd,(new Date).getTime());if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").vbi){const Fa=this.JN.Fy();Fa&&0<Fa.length?(this.uQ.c0k(),Lb.a.instance.hc(fc.a.Qid,(new Date).getTime()),hc.App.RGb(null,fc.a.Qid)):Wb.a.J(512262875,805,50,"InitCommentActivationManager: Deep link to a slide without comments")}}).catch(Fa=>
{Wb.a.J(512262874,801,10,"Failed to load the resources for the floating container UI + "+Fa.toString())})})}Gm(){this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").updateCommandUI()}dispose(){this.ZYc&&this.ZYc.Htl();this.uQ&&this.uQ.dispose();this.lhe&&this.lhe.dispose();this.Dua=null}get name(){return"PowerPointWebEditor.CommentsPackage"}static main(){Lb.a.instance.hc(fc.a.nPd,(new Date).getTime());ac.a.instance.Bc(new Ac)}}Object(h.a)(Ac,"CommentsPackage",null,[2,3]);Type.registerNamespace("Common.App.SharedComments");
Type.registerNamespace("FloatingContainer");Type.registerNamespace("FloatingContainerManager");Type.registerNamespace("PowerPointWeb.Comments");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("RichContentEditAPI");Ac.main()},277:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(989);class e{constructor(m){this.Wk=new h.a;this.ZVa=m}AG(m){const r=m.id;let v=null;this.Wk.Jb(r)?v=this.Wk.ga(r):(this.ZVa&&(v=this.ZVa(m,()=>{this.pjc(r)})),v&&this.Wk.$(r,v));return v}kF(m){m=
m.id;return this.Wk.Jb(m)?this.Wk.ga(m):null}pjc(m){this.Wk.remove(m)}}Object(J.a)(e,"ShapeComponentViewManager",null,[488])},669:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(17),e=d(95),m=d(27),r=d(48);d(96);class v{constructor(){this.OZ=null}get Kub(){return!1}Gzh(A,w){let y=new h.a;const u=new r.GraphTransaction(3);try{u.gd(m.App.Hb.Hd.nn.vg),this.A6b(w)&&(y=this.k4b(w,y)),w!==A&&this.A6b(A)&&(y=this.k4b(A,y))}finally{u&&u.dispose()}return y.toArray()}A6b(A){return!!A}yed(A){let w=
!1;for(const y of this.M6d)w||!Sys.UI.DomElement.containsCssClass(A,y.className)&&!Sys.UI.DomElement.containsCssClass(A,y.v2b)||(w=!0),e.a.sIa(A,y.className),e.a.sIa(A,y.v2b)}}Object(J.a)(v,"AHighlightActor",null,[837])},670:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.className=e;this.v2b=m}}Object(J.a)(h,"HighlightCssClassPair",null,[])},671:function(J,V,d){d.d(V,"b",function(){return r});d.d(V,"a",function(){return v});var h=d(95);d(27);var e=d(48);d(31);
d(91);var m=d(96);const r=A=>{const w=new e.GraphTransaction(3);try{w.gd(A),A.kv(32,!0)}finally{w&&w.dispose()}},v=A=>{if(A){A=h.a.Iia(A);if(-1===A.indexOf(m.a.h7)&&-1!==A.indexOf(m.a.MM)&&-1===A.indexOf(m.a.bYb))return 2;if(-1===A.indexOf(m.a.h7)&&(-1!==A.indexOf(m.a.aYb)||-1!==A.indexOf(m.a.aN)||-1!==A.indexOf(m.a.bYb)||-1!==A.indexOf(m.a.xFc)||-1!==A.indexOf(m.a.iHc)||-1!==A.indexOf(m.a.gHc)||-1!==A.indexOf(m.a.fHc)||-1!==A.indexOf(m.a.gSd)||-1!==A.indexOf(m.a.bSd)||-1!==A.indexOf(m.a.dSd)||-1!==
A.indexOf(m.a.hHc)||-1!==A.indexOf(m.a.aSd)))return 1;if(-1!==A.indexOf("WACImageContainer"))return 3}return 0}},672:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.type=this.action=0;this.Qeb=this.sca=null}}Object(J.a)(h,"HighlightOperation",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.comment.js.map