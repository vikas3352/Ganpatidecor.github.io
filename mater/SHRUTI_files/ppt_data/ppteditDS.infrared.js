'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[13],{1212:function(J,V,d){d.r(V);J=d(0);var h=d(68),e=d(26),m=d(189),r=d(52),v=d(28);class A{constructor(ma,Ea){this.ia=ma;this.ia.pa(v.a.cwj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.dwj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.ewj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.fwj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.gwj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.hwj,
r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.iwj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Ovj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Pvj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Qvj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Rvj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Svj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Tvj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Uvj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Nvj,
r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Vvj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Wvj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Yvj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.Zvj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.$vj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.awj,r.a.application,m.ActionManager.$u,4);this.ia.pa(v.a.bwj,r.a.application,m.ActionManager.$u,4);this.KGg=JSON.parse(Ea.Ga("674"));for(const ta of this.KGg)ta.regex=
new RegExp(ta.pattern)}trackAction(ma){for(const Ea of this.KGg)Ea.regex.test(ma)&&this.ia.processAction(Ea.actionId,2)}}Object(J.a)(A,"IdeasActionTracker",null,[766]);class w{constructor(){this.Gab=this.Hse=this.Rre=null;this.EJj=this.JGl}addSlideSuggestionsListener(ma){this.Rre=ma}addTextToSmartArtSuggestionListener(ma){this.Hse=ma}OHd(ma){this.Gab=ma}notifySlideSuggestion(ma,Ea){this.Rre&&(this.Rre(ma,Ea),e.a.J(512496328,829,50,"data: count: {0}, correlation: {1}",Ea?Ea.suggestions.length:0,Ea?
Ea.correlationId:"0"))}notifyTextToSmartArtSuggestion(ma,Ea){this.Hse&&(this.Hse(ma,Ea),e.a.J(512496327,829,50,"data: count: {0}, correlation: {1}",Ea?Ea.suggestions.length:0,Ea?Ea.correlationId:"0"))}f8c(ma){this.Gab&&this.Gab(ma)}}Object(J.a)(w,"InfraredDesignerServiceProvider",null,[765]);class y{constructor(){this.Gab=null}OHd(ma){this.Gab=ma}f8c(ma){this.Gab&&this.Gab(ma)}}Object(J.a)(y,"InfraredTelemetryListener",null,[764]);var u=d(198),D=d(989),F=d(45),I=d(13),H=d(33);class L{}Object(J.a)(L,
"EntityGroup",null,[]);class E extends L{}Object(J.a)(E,"Idea",L,[]);var aa=d(534);class Q{}Object(J.a)(Q,"ProviderResult",null,[]);var O=d(328),T=d(429),K=d(428),X=d(327),P=d(533),ea=d(25),ia=d(268);class ja{}ja.Azk="PowerPoint";ja.lCl="WAC";Object(J.a)(ja,"ApplicationPropertiesConstants",null,[]);class C{}Object(J.a)(C,"EnterpriseUserInfo",null,[]);class pa{}Object(J.a)(pa,"Message",null,[]);class Z extends pa{}Z.PowerPointTextTileChangedMessageType="PowerPoint.TextTileChanged";Object(J.a)(Z,"PowerPointTextTileChangedMessage",
pa,[]);class qa{}Object(J.a)(qa,"RankerConfiguration",null,[]);class ya{constructor(ma){this.ATg=ma}jZi(ma,Ea){return new Promise((ta,Ga)=>{this.ATg&&ma&&Ea||Ga("wopiIdentityManager or tokenParameter or clientWoipId is null");this.ATg.getAccessToken(ma,Ea).then(oa=>{oa?ta(oa.accessToken):Ga("auth token is null")},oa=>{Ga(oa)})})}}Object(J.a)(ya,"AuthenticationProvider",null,[800]);class Ka{constructor(ma,Ea,ta,Ga,oa=""){this.resource=ma;this.scope=Ea;this.silentLogin=ta;this.options=Ga;this.correlationId=
oa}}Object(J.a)(Ka,"InfraredTokenParameters",null,[589]);class Da{constructor(ma,Ea,ta,Ga,oa,sa,Ha,bb,Ya){this.mKg=this.fge=this.t7e=null;this.bKg=!1;this.coe=null;this.xre=!1;e.a.J(512262852,809,50,"PPTWebEditorInfraredRuntimeManager - Initialize");this.rBb=ma;this.e4j=Ha;this.Mle=Ya;this.Y6j=ma.ka("659");this.O4c=ma.Ga("750");Ha=window.location.hostname;Ya=ma.Ga("816");Ha&&0<Ha.length&&Ya&&0<Ya.length&&0<=Ya.toLowerCase().indexOf(Ha.toLowerCase())&&(this.O4c="");this.wUa=Ea;this.a9b=sa;if(this.cck=
ma.ka("688"))this.mKg=ma.Ga("689"),this.fge=new ya(bb);this.wUa.addSlideSuggestionsListener(Object(I.a)(this,this.Vqk,"onSlideSuggestion"));this.wUa.addTextToSmartArtSuggestionListener(Object(I.a)(this,this.wrk,"onTextToSmartArtSuggestion"));this.wUa.OHd(Object(I.a)(this,this.d0g,"onIdeasSessionTelemetry"));ta.OHd(Object(I.a)(this,this.d0g,"onIdeasSessionTelemetry"));this.a9b&&this.a9b.execute(ua=>{ua.$Ef(Object(I.a)(this,this.pxe,"onEditorCritiques"))});this.ia=Ga;(this.eT=oa)&&this.eT.execute(ua=>
{ua.registerSimpleLocalWorkflow("InfraredSlideTextTileWorkflow",Object.assign(new K.a,{name:"InfraredSlideTextTileLambda",inputSchema:T.a.wmc,outputSchema:T.a.wmc,func:(Ma,Ca,Va)=>{this.Wqk(Ma);Va(null)}}))});this.w9k()}get Pub(){return this.t7e}w9k(){var ma=JSON.parse(this.rBb.Ga("612"));ma=Object.assign(new qa,{rankingOrder:ma});var Ea=IdeasInfraredConnector,ta=Ea.setup,Ga=e.a.J,oa=Object(I.a)(this,this.jwj,"ideasPaneVisibilityStatusCallback"),sa=this.rBb;const Ha={};Ha.appName=2===ea.AFrameworkApplication.Aa.jb.rm?
ja.Azk:"unknown";Ha.appVersion=ea.AFrameworkApplication.buildVersion;Ha.appPlatform=ja.lCl;Ha.lcid=ea.AFrameworkApplication.lcid;var bb=ia.a.oe(ea.AFrameworkApplication.lcid);bb=bb?bb.name:null;const Ya=bb.split("-");Ha.market=Ya[Ya.length-1];Ha.uiLanguage=bb;Ha.sessionId=ea.AFrameworkApplication.userSessionId;Ha.tenantRoot=sa.Ga("748");Ha.shredderServiceEndpoint=sa.Ga("749");this.t7e=ta.call(Ea,ma,Ga,oa,Ha,this.e4j,Object(I.a)(this,this.Lfg,"getShredderServiceAuthTokenPromise"))}jwj(ma){this.bKg=
ma;(this.wUa.EJj=ma)?(this.ia.processAction(v.a.xKc,2),this.n9g()):this.ia.La(v.a.Xma,2,new P.a(!0,X.a.f7d))}Vqk(ma,Ea){const ta=[];ta.push(Object.assign(new E,{providerId:aa.a.Oth,groupTypeId:aa.a.Nth,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Ea}));try{this.Pub.pushProviderResult(Object.assign(new Q,{providerId:aa.a.Oth,resultStatus:ma,entityGroups:ta}))}catch(Ga){e.a.J(512262851,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",
Ga)}"Success"===ma&&(u.a.Va(Ea.suggestions)||this.Mle.tmd(0))}wrk(ma,Ea){const ta=[];ta.push(Object.assign(new E,{providerId:aa.a.Xth,groupTypeId:aa.a.Wth,notificationConfidence:0,shouldRaiseNotification:!1,confidence:1,data:Ea}));try{this.Pub.pushProviderResult(Object.assign(new Q,{providerId:aa.a.Xth,resultStatus:ma,entityGroups:ta}))}catch(Ga){e.a.J(512262850,811,10,"OnTextToSmartArtSuggestion: Exception occured while posting message to IR, Exception is: {0} ",Ga)}}d0g(ma){try{this.Pub.trackIdeasProviderAction(ma.cardId,
ma.actionType,ma.actionEngagement)}catch(Ea){e.a.J(512262849,811,10,"OnIdeasSessionTelemetry: Exception occured while calling TrackIdeasProviderAction in IR, Exception is: {0} ",Ea)}}Wqk(ma){if(this.Y6j)if(ma)if(ma){try{const Ea=H.a(ma.Content);this.Vci(this.coe,Ea)&&(this.coe=Ea,this.xre=!0)}catch(Ea){e.a.J(512262818,811,10,"Deserializing tile response failed");return}this.bKg&&this.n9g()}else e.a.J(512262819,811,50,"ProcessSlideTextTileChange,TileNull");else e.a.J(512262848,811,50,"ProcessSlideTextTileChange,InputNull")}Vci(ma,
Ea){if(!ma&&Ea||ma&&!Ea)return!0;if(!ma&&!Ea)return!1;if(!ma.drawingElems&&Ea.drawingElems||ma.drawingElems&&!Ea.drawingElems)return!0;const ta=new D.a;for(const Ga of ma.drawingElems)if(ma=Ga.text)for(const oa of ma.paragraphs)oa&&(F.a.Va(oa.id)||F.a.Va(oa.chars)||ta.$(oa.id,oa.chars));for(const Ga of Ea.drawingElems)if(Ea=Ga.text)for(const oa of Ea.paragraphs)if(oa&&!(F.a.Va(oa.id)||F.a.Va(oa.chars)||ta.Jb(oa.id)&&ta.ga(oa.id)===oa.chars))return!0;return!1}n9g(){if(this.xre){try{this.Pub.postMessage(Object.assign(new Z,
{messageType:Z.PowerPointTextTileChangedMessageType,data:this.coe}))}catch(ma){e.a.J(512262817,811,10,"OnSlideTextTileChange: Exception occured while posting message to IR Exception is: {0} ",ma)}this.Mle.tmd(1);this.xre=!1}}pxe(ma,Ea){try{ma=[],ma.push(Object.assign(new E,{groupTypeId:aa.a.c0f,providerId:aa.a.i0f,notificationConfidence:Ea.nja?Ea.nja.notificationConfidence:0,shouldRaiseNotification:Ea.nja?Ea.nja.shouldRaiseNotification:!1,confidence:Ea.nja?Ea.nja.confidence:0,data:Ea.uZb})),this.Pub.pushProviderResult(Object.assign(new Q,
{providerId:aa.a.i0f,resultStatus:Ea.nja?Ea.nja.resultStatus:O.a.invalid,entityGroups:ma}))}catch(ta){e.a.J(512262816,811,10,"OnEditorCritiques: Exception occured while calling PushProviderResult in IR, Exception is: {0} ",ta)}Ea.nja&&"Success"===Ea.nja.resultStatus&&Ea.uZb&&!u.a.Va(Ea.uZb.critiques)&&this.Mle.tmd(2)}Lfg(){if(!this.fge)return e.a.J(512262815,811,50,"authenticationProvider is null"),null;try{if(this.O4c&&0<this.O4c.length)return this.fge.jZi(new Ka(this.O4c,"user_impersonation",!0,
{}),this.mKg);e.a.J(512262814,811,50,"ShredderServiceResourceId is null or empty");return null}catch(ma){return e.a.J(512262813,811,10,"Exception occured while retrieving auth token from wopi identity, Exception is: {0} ",ma),null}}Z4i(){return new Promise(ma=>{const Ea=this.rBb.Ga("749"),ta=this.Lfg();Ea&&Ea.length&&ta?ta.then(Ga=>{Ga&&Ga.length?(Ga=new C,Ga.CountryCode="US",Ga.IsEnabled=!1,Ga.IsEnterpriseEnabled=!0,Ga.IsGoLocal=!1,Ga.ServiceEndpoint=Ea,Ga.TenantRoot="",ma(Ga)):ma(null)},()=>{ma(null)}):
ma(null)})}}Object(J.a)(Da,"PPTWebEditorInfraredRuntimeManager",null,[756]);class la{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Infrared"}Wb(ma){this.K=ma;this.K.register(w,"PowerPointWebEditor.Infrared.InfraredDesignerServiceProvider").as("PowerPointWebEditor.IDesignerServiceProvider").ma().na(()=>new w);this.K.register(y,"PowerPointWebEditor.Infrared.InfraredTelemetryListener").as("PowerPointWebEditor.IInfraredTelemetryListener").ma().na(()=>new y);this.K.register(A,"PowerPointWebEditor.Infrared.IdeasActionTracker").as("PowerPointWebEditor.Infrared.IIdeasActionTracker").ma().na(()=>
new A(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IAppSettingsManager")));e.a.J(512262812,809,50,"PPTWebEditorInfraredRuntimePackage - Registering IInfraredRuntimeManager");this.K.register(Da,"PowerPointWebEditor.Infrared.PPTWebEditorInfraredRuntimeManager").as("PowerPointWebEditor.Infrared.IInfraredRuntimeManager").ma().na(()=>new Da(this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IDesignerServiceProvider"),this.K.resolve("PowerPointWebEditor.IInfraredTelemetryListener"),
this.K.resolve("Common.IActionManager"),this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.Ka("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasActionTracker"),this.K.resolve("Common.App.WopiIdentity.WopiIdentityManager"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext")))}init(){const ma=this.K.resolve("Common.IAppSettingsManager");ma.ff(()=>{ma.ka("610")&&(e.a.J(512262811,809,50,"PPTWebEditorInfraredRuntimePackage - Initialize IInfraredRuntimeManager"),
this.K.resolve("PowerPointWebEditor.Infrared.IInfraredRuntimeManager"))})}dispose(){}static main(){h.a.instance.Bc(new la)}}Object(J.a)(la,"PPTWebEditorInfraredRuntimePackage",null,[2,3]);Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PowerPointWebEditor.Infrared");la.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.infrared.js.map