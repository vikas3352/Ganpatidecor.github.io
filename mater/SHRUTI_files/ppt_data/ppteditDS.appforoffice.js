'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[9],{1205:function(J,V,d){d.r(V);var h=d(0),e=d(17),m=d(376),r=d(290);class v{constructor(){this.BKh=new e.a}get JDc(){return this.BKh}baj(M){m.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",M);const ca=new e.a;for(let Na of this.JDc)for(let zb of Na.mec)zb.id===M&&ca.add(zb);return ca}Zfi(){var M=this.baj("ContextMenuText");if(M&&0<M.count){const ca=Object.assign(new r.a,{ControlList:[]});for(let Na of M)M=
Na.aoc(),0<M.length&&Array.addRange(ca.ControlList,M);return ca}return null}YCf(M){this.JDc.add(M)}CPk(M){for(let ca of this.JDc)if(ca.oGf===M.oGf){this.JDc.remove(ca);break}}static GIi(M,ca,Na=null){M=v.f2i(M);0<M.length&&(v.whd(M,!1),Na&&Na(ca,M))}static f2i(M){const ca=[];if(M&&M.mec&&0<M.mec.count)for(let Na of M.mec)if(Na.controls&&0<Na.controls.count)for(let zb of Na.controls)if(zb.menuItems&&0<zb.menuItems.count)for(let $b of zb.menuItems)Array.add(ca,$b.id);return ca}static whd(M,ca){if(M.length){var Na=
[];for(const zb of M)Na.push(appChrome.actions.updateControlEnabledDisabledState(zb,ca));appChrome.api.dispatch(Na)}}}Object(h.a)(v,"ContextMenuExtensibilityCache",null,[902,903]);var A=d(25),w=d(364),y=d(104),u=d(68),D=d(13);class F{constructor(M,ca,Na){this._id=M;this.bJh=ca;this.iLh=Na;this.Xsg=OfficeExt.CommandInvokeMode.Default}get id(){return this._id}get cJd(){return this.bJh}get zri(){return this.iLh}execute(M,ca,Na){Na=Na||{};Na.commandMode=this.Xsg;ca.invokeAppCommand(this.cJd,this.zri,
Na,(zb,$b)=>{M.P0g(this.id,this.cJd,zb,$b)})}}Object(h.a)(F,"AddinNativeActionBase",null,[718]);class I extends F{constructor(M,ca){super(1,M,ca);this.Xsg=OfficeExt.CommandInvokeMode.ExclusiveForNew}}Object(h.a)(I,"AddinTakeSnapshotAction",F,[]);class H{ETf(M,ca){let Na=null;switch(M){case 1:Na=new I(ca,this.qZd().getNativeActionName(M));break;case 2:Na=new F(2,ca,this.qZd().getNativeActionName(M));break;case 3:Na=new F(3,ca,this.qZd().getNativeActionName(M))}return Na}qZd(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()}}
Object(h.a)(H,"AddinNativeActionManager",null,[698]);class L{invokeAppCommand(M,ca,Na,zb){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(M,ca,Na,zb)}static getInstance(){L.Ja||(L.Ja=new L);return L.Ja}}L.Ja=null;Object(h.a)(L,"OSFAddinCommandsRuntimeManager",null,[699]);var E=d(77);class aa{constructor(){this.L_f=this.displayName=this.dXb=this.tJ=this.OL=null;this.isUpgraded=!1}Qyg(M,ca){return this.OL.getStoreType().toLowerCase()===M.toLowerCase()&&this.OL.getSolutionId().toLowerCase()===
ca.toLowerCase()}}Object(h.a)(aa,"AddinCommandsResourceItem",null,[]);class Q{constructor(){this.cqd=null;this.Yud=0;this.Awd=!1;this.Pa=new E.a;this.EPh=new e.a}K4h(M){this.Pa.addHandler("AddinCommandsLoadingMessageChanged",M)}get hUb(){return this.cqd}QHb(M){M!==this.cqd&&(this.cqd=M,this.Pa.raiseEvent("AddinCommandsLoadingMessageChanged"))}N2k(){this.Yud++;this.hUb||this.QHb(CommonUIStrings.l_LoadingAddInsTitle)}DKe(){this.Yud--;this.uee()&&(this.Awd?this.hUb!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&
this.QHb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.QHb(null))}b4k(){this.Awd=!0;this.QHb(CommonUIStrings.l_ErrorLoadingAddInsTitle)}rPf(){this.Awd=!1;this.uee()?this.QHb(null):this.QHb(CommonUIStrings.l_LoadingAddInsTitle)}uee(){return 0>=this.Yud}get rvb(){return this.EPh}j6a(M,ca,Na=0){for(let zb of this.rvb)if(zb.Qyg(M,ca)&&(!zb.tJ||zb.tJ.cZi===Na))return zb;return null}JDf(M,ca,Na,zb){const $b=new aa;$b.OL=M;$b.tJ=ca;$b.dXb=Na;$b.displayName=zb;this.rvb.add($b)}H2h(M,ca,Na,zb){const $b=
new aa;$b.OL=M;$b.tJ=ca;$b.dXb=null;$b.L_f=Na;$b.displayName=zb;this.rvb.add($b)}jPk(M,ca){let Na=0;for(let zb of this.rvb)zb.OL.getStoreType()===M&&zb.OL.getSolutionId()===ca?this.rvb.removeAt(Na):Na++}static getInstance(){Q.Ja||(Q.Ja=new Q);return Q.Ja}}Q.Ja=null;Object(h.a)(Q,"AddinCommandsResourceManager",null,[]);var O=d(231),T=d(532),K=d(168),X=d(135);class P extends Sys.EventArgs{constructor(){super();this.tJ=this.tu=null}}Object(h.a)(P,"InsertionParamEventArgs",Sys.EventArgs,[]);class ea{constructor(M,
ca,Na,zb,$b,Tc){this.Yw=M;this.tu=ca;this.q$=Na;this.displayName=$b;this.uBg=Tc}}Object(h.a)(ea,"PostLaunchAddinCommandsParameters",null,[]);var ia=d(33),ja=d(45),C=d(1166);class pa{constructor(M,ca,Na,zb=null){this.gkc=A.AFrameworkApplication.fa.Ga("RoamingServiceHandlerWebServiceBase");this.appName=M;this.fOb=ca;this.cOb=Na;this.bRb=zb}YJc(M){this.EPi(M,Object(D.a)(this,this.PCa,"getRequestSuccessCallback"),Object(D.a)(this,this.Tia,"getRequestFailureCallback"))}EPi(M,ca,Na){const zb=new Sys.StringBuilder(this.gkc);
zb.append("RoamingServiceHandler.ashx?action=");zb.append("getAddinTeachingCalloutSettings");zb.append("&");zb.append(this.p2d(M));zb.append("&");zb.append(A.AFrameworkApplication.hh);A.AFrameworkApplication.Ge.yj(zb.toString(),1,null,null,!0,2,ca,Na,null)}Xrb(M){this.LPi(M)}LPi(M){var ca=new Sys.StringBuilder(this.gkc);ca.append("RoamingServiceHandler.ashx?action=");ca.append("saveAddinTeachingCalloutSettings");ca.append("&");ca.append(A.AFrameworkApplication.hh);ca=ca.toString();M=ia.c(M);A.AFrameworkApplication.Ge.yj(ca,
2,M,null,!0,4,null,Object(D.a)(this,this.i$,"postRequestFailureCallback"),null)}PCa(M){let ca=!1,Na=null;try{if(0<M.data.Sd.length){const zb=Object(C.a)(Object,ia.a(M.data.Sd)),$b=zb?zb[this.appName]:null;$b&&(Na=Object(C.a)(Object,ia.a($b.toString())))}ca=!0}catch(zb){this.Tia(null)}ca&&this.fOb&&this.fOb(Na)}Tia(M){this.cOb&&this.cOb(M?M.data:null)}i$(M){this.bRb&&this.bRb(M?M.data:null)}p2d(M){const ca=new Sys.StringBuilder("requestedsettings=");for(let Na=0;Na<M.count;Na++)ca.append(M.ga(Na)),
Na<M.count-1&&ca.append(";");return ca.toString()}}Object(h.a)(pa,"AddinTeachingUIRoamingRequestHandler",null,[]);var Z=d(180);class qa{constructor(M,ca,Na){this.fkc=!1;this.faa=null;this.Pa=M;this.KOb=ca;this.DLb=Na}GHd(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(D.a)(this,this.Uxe,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(D.a)(this,this.kxe,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",
Object(D.a)(this,this.Xwe,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(D.a)(this,this.uec,"onCampaignLaunchedHandler"),!0)):m.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}Uxe(){const M={["AppTeachingUICalloutAction"]:"ClickOnLaunch",["SDX.Id"]:qa.ZV(this.KOb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};this.DLb&&this.DLb.tabs&&!this.DLb.tabs[0].isOfficeTab&&
(M["SDX.FeatureFlags"]="NonOfficeTab");X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.sD(M)}));this.fHa();this.DLb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.DLb,()=>{const ca=new P;ca.tu=this.KOb;this.Pa.raiseEvent(O.a.Mde,ca)}):m.ULS.sendTraceTag(525112602,220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}Xwe(){const M={["AppTeachingUICalloutAction"]:"ClickOnClose",["SDX.Id"]:qa.ZV(this.KOb),
["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.sD(M)}));this.fHa()}kxe(){const M={["AppTeachingUICalloutAction"]:"ClickOnDismiss",["SDX.Id"]:qa.ZV(this.KOb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:K.a.sD(M)}));this.fHa()}uec(M){if(M&&(M=M.detail)&&M.id&&this.d$d(M.id)){const Na=(M.action||"").toLowerCase();if(M.success&&"opened"===Na){var ca={["AppTeachingUICalloutAction"]:"CampaignLaunched",["SDX.Id"]:qa.ZV(this.KOb),["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.sD(ca)}));m.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming.");
this.fHa();window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",Object(D.a)(this,this.uec,"onCampaignLaunchedHandler"),!0)}else try{ca=JSON.stringify(M),m.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+ca)}catch(zb){ca="id : "+M.id+" telemetryEventName: "+M.telemetryEventName,m.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+ca+" Error: "+(zb?zb.toString():""))}}}d$d(M){M=ja.a.wg(M);return-1!==M.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||
-1!==M.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==M.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||-1!==M.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==M.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==M.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}dYa(M){const ca=A.AFrameworkApplication.fa.Ga("WebAppShortName");if(ca){const Na={},zb={};zb.LastTeachingUIShowTime=(new Date).toUTCString();zb.AddinHasShown=M;Na[ca]=ia.c(zb);this.faa=new pa(ca,null,null,Object(D.a)(this,
this.i$,"postRequestFailureCallback")),this.faa.Xrb(Na),m.ULS.sendTraceTag(523535564,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else m.ULS.sendTraceTag(523535565,220,10,"Fail to save roaming service since AppName is null")}fHa(){if(!this.fkc){const M=window.g_roamingAddinList;M&&(this.dYa(M),this.fkc=!0)}}i$(M){m.ULS.sendTraceTag(523535566,220,10,"failed to POST data to Roaming Settings Service with status: {0}",M?M.Le:-1)}static ZV(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,
M.storeType,M.assetId,null,null,M.storeId)}}Object(h.a)(qa,"PrivateCatalogTeachingCalloutHandler",null,[]);var ya=d(14),Ka=d(15),Da=d(964);class la{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(h.a)(la,"AddinAbstract",null,[]);class ma extends Sys.EventArgs{constructor(M){super();this.solutionId=M.solutionId;this.assetId=M.assetId;this.storeType=M.storeType;this.storeId=M.storeId;this.assetStoreId=M.assetStoreId;this.targetType=M.targetType;this.width=M.width;this.height=
M.height;this.displayName=M.displayName;this.version=M.version}}Object(h.a)(ma,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Ea=d(123);class ta{constructor(M){this.pob=this.tu=null;this.fkc=!1;this.eLa=this.vqc=this.iIa=this.En=this.faa=this.u0=null;this.xp=M}get appName(){return A.AFrameworkApplication.fa.Ga("WebAppShortName")}get RFf(){this.faa||(this.faa=new pa(this.appName,Object(D.a)(this,this.PCa,"getRequestSuccessCallback"),Object(D.a)(this,this.Tia,"getRequestFailureCallback"),
Object(D.a)(this,this.i$,"postRequestFailureCallback")));return this.faa}get MNa(){this.vqc||(this.vqc=new e.a);return this.vqc}set MNa(M){this.vqc=M}get L4a(){this.eLa||(this.eLa=new e.a);return this.eLa}set L4a(M){this.eLa=M}GHd(M,ca){window.addEventListener?(this.tu=M,this.pob=ca,window.addEventListener("LaunchAddinTaskpane",Object(D.a)(this,this.Uxe,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(D.a)(this,this.kxe,"onDismissButtonClickedEventHandler"),
!0),window.addEventListener("CloseCallout",Object(D.a)(this,this.Xwe,"onCloseButtonClickedEventHandler"),!0),window.addEventListener("FGWebSurfaceEvent",Object(D.a)(this,this.uec,"onCampaignLaunchedHandler"),!0)):m.ULS.sendTraceTag(525112601,220,15,"AddEventListenerForTeachingCallout failed to get Window")}Tql(M,ca,Na,zb){this.En=M;this.MNa=ca;this.L4a=Na;this.iIa=zb;m.ULS.sendTraceTag(0,220,50,"Calls into TriggerTeachingCallout with addin entitlements: command addins: {0}, content addins: {1}",ca?
ca.count.toString():"null",Na?Na.count.toString():"null");0<this.MNa.count||0<this.L4a.count?(M=new e.a,M.add(this.appName),this.RFf.YJc(M)):this.iIa(new e.a,null)}Uxe(){const M=new ya.ScriptSharpLegacyMap;this.pob&&this.pob.tabs&&!this.pob.tabs[0].isOfficeTab&&M.$("SDX.FeatureFlags","NonOfficeTab");this.DEa(ta.ZV(this.tu),"ClickOnLaunch",M);this.fHa();this.pob?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.pob,()=>{const ca=new P;ca.tu=this.tu;this.xp.raiseEvent(O.a.Mde,ca)}):m.ULS.sendTraceTag(525112602,
220,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")}Xwe(){this.DEa(ta.ZV(this.tu),"ClickOnClose");this.fHa()}kxe(){this.DEa(ta.ZV(this.tu),"ClickOnDismiss");this.fHa()}uec(M){if(M&&(M=M.detail)&&M.id&&this.d$d(M.id)){const ca=(M.action||"").toLowerCase();if(M.success&&"opened"===ca)this.DEa(ta.ZV(this.tu),"CampaignLaunched"),m.ULS.sendTraceTag(523355483,220,50,"CD addin UI has been launched. Attempting to save roaming."),this.fHa(),window.removeEventListener&&window.removeEventListener("FGWebSurfaceEvent",
Object(D.a)(this,this.uec,"onCampaignLaunchedHandler"),!0);else{let Na;try{Na=JSON.stringify(M),m.ULS.sendTraceTag(523321995,220,15,"Campaign launch failure. Event:"+Na)}catch(zb){Na="id : "+M.id+" telemetryEventName: "+M.telemetryEventName,m.ULS.sendTraceTag(523321996,220,50,"Error serializing campaign event. "+Na+" Error: "+(zb?zb.toString():""))}}}}d$d(M){M=ja.a.wg(M);return-1!==M.indexOf("d7f1cbbb-3631-4cae-bc2d-177774aa1190")||-1!==M.indexOf("7f5167e4-54e6-4353-a9d7-686741f379b7")||-1!==M.indexOf("cbb7eaa0-6e95-422d-9647-2be7d2737d4a")||
-1!==M.indexOf("f210940e-28e4-4d7c-90dd-0093db1f7df3")||-1!==M.indexOf("d30cc3b5-1c10-414f-9390-b59949be99f8")||-1!==M.indexOf("912b80fb-c00f-4c89-ab73-2e14c3511993")}dYa(M){if(this.appName){const ca={},Na={};Na.LastTeachingUIShowTime=(new Date).toUTCString();Na.AddinHasShown=M;ca[this.appName]=ia.c(Na);this.RFf.Xrb(ca);m.ULS.sendTraceTag(539530527,220,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}else m.ULS.sendTraceTag(539530528,220,
10,"Fail to save roaming service since AppName is null")}fHa(){if(!this.fkc){const M=window.g_roamingAddinList;M&&(this.dYa(M),this.fkc=!0)}}PCa(M){M?this.uNe(M)?(m.ULS.sendTraceTag(527523845,220,50,"should show teaching UI"),this.u0="AddinHasShown"in M&&M.AddinHasShown?M.AddinHasShown.toString():null,this.RWb()):(m.ULS.sendTraceTag(538248466,220,50,"Not Show TeachingUI this time"),this.iIa(this.MNa,null)):(m.ULS.sendTraceTag(527523844,220,50,"userSettings is null"),this.u0=null,this.RWb())}Tia(M){m.ULS.sendTraceTag(539530529,
220,10,"GET data from Roaming Settings Service with status: {0}, fallback",M?M.Le:-1);this.iIa(this.MNa,null)}i$(M){m.ULS.sendTraceTag(539530530,220,10,"failed to POST data to Roaming Settings Service with status: {0}",M?M.Le:-1)}RWb(){const M=this.ATd();0===M.targetType?(M.solutionId?this.aDe(M):this.DEa(null,"NoSolutionId"),this.jEh(M),this.iIa(this.MNa,null)):this.iIa(this.MNa,M);m.ULS.sendTraceTag(528023563,220,50,"Show teaching callout for: {0}",M.addinId)}aDe(M){const ca=new Da.a;ca.callbackFunc=
Na=>{if(Na.errorCode){this.DEa(M.solutionId,"FailToGetAppDetails");var zb=window.g_roamingAddinList;zb&&this.dYa(zb)}else if(Na.value)for(zb of Na.value)if(Na=zb[1],Na===M.solutionId){const $b={};$b.solutionId=Na;$b.assetId=zb[5];$b.storeType=zb[12];$b.storeId=zb[11];$b.assetStoreId=zb[6];$b.targetType=zb[3];$b.width=zb[7];$b.height=zb[8];$b.displayName=zb[0];$b.version=zb[4];m.ULS.sendTraceTag(0,220,50,"Raise a teaching callout event for content addin: {0}.",M.solutionId);zb=new ma($b);this.xp.raiseEvent(O.a.HNe,
zb);break}};ca.storeType=OSF.StoreTypeEnum.PrivateCatalog;ca.fromInsertDialog=!1;ca.refresh=!1;this.En.queryEntitlementDetails(ca)}uNe(M){if("LastTeachingUIShowTime"in M){if(M=+new Date-+new Date(M.LastTeachingUIShowTime.toString()),M<A.AFrameworkApplication.fa.QP("AddinShowTeachingUIIntervalInMS",864E5))return m.ULS.sendTraceTag(538248467,220,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",M),!1}else m.ULS.sendTraceTag(527523846,220,50,"userSetting has no date key");return!0}ATd(){let M=
new Ka.a(new la,0),ca=new Ka.a(new la,0),Na=0,zb=0,$b=0;var Tc=new e.a;for(var hd of this.MNa)Tc.add(hd);for(let Hd of this.L4a)Tc.add(Hd);for(let Hd of Tc)if(!("excatalog"!==Hd.storeType||Ea.b(Hd.installTimeInMS)||!Hd.installTimeInMS||Hd.installTimeInMS<=A.AFrameworkApplication.fa.QP("DateTimeInMSForNewAddin",16409952E5))){Tc=ta.f0b(Hd);if(this.u0&&(hd=this.u0.split(","),0<hd.length&&Array.contains(hd,Tc))){$b++;m.ULS.sendTraceTag(528345032,220,50,"This addin has shown teaching UI before");continue}Tc.startsWith("private_")?
(M=ta.ucg(Hd,M),zb++):(ca=ta.ucg(Hd,ca),Na++)}m.ULS.sendTraceTag(528345033,220,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",zb,Na,$b);return 0<ca.value?ca.key:0<M.value?M.key:Object.assign(new la,{addinId:null,targetType:-1,solutionId:null})}DEa(M,ca,Na=null){M={["AppTeachingUICalloutAction"]:ca,["SDX.Id"]:M,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};if(Na)for(let zb of Na.keys)M[zb]=Na.ga(zb);X.a.sendTelemetryEvent(Object.assign(new Z.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.sD(M)}))}jEh(M){M&&(window.g_roamingAddinList=this.u0?this.u0+","+M.addinId:M.addinId)}static ZV(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}static ucg(M,ca){return ca.value<M.installTimeInMS?new Ka.a(Object.assign(new la,{addinId:ta.f0b(M),targetType:M.targetType,solutionId:M.solutionId}),M.installTimeInMS):ca}static f0b(M){return Telemetry.PrivacyRules.IsPrivateAddin(M.storeType,
M.assetId,null,null,M.storeId)?"private_"+M.installTimeInMS:M.solutionId}}Object(h.a)(ta,"PrivateCatalogTeachingCalloutHandler2",null,[]);class Ga{constructor(M){this.fef=null;this.V7e=M}get hTa(){return this.fef}Ynb(M,ca=null){this.V7e.Ynb(M,ca);this.fef=M}VFe(M){this.V7e.VFe(M)}}Object(h.a)(Ga,"RibbonExtensibilityManagerWithChangeDetection",null,[917]);var oa=d(80);const sa=()=>{const M=oa.a.Ktb(window.location.href.toLowerCase(),"wdomexsrctype");return!!M&&"4"===M},Ha=()=>oa.a.Ktb(window.location.href.toLowerCase(),
"wdtpl"),bb=()=>{const M=oa.a.Ktb(window.location.href.toLowerCase(),"wdomexsrctype");return!!M&&"1"===M},Ya=M=>{let ca=null;switch(M){case 0:ca="omex";break;case 1:ca="spcatalog";break;case 2:ca="spapp";break;case 3:ca="filesystem";break;case 4:ca="exchange";break;case 6:ca="registry";break;case 7:ca="inmemory";break;case 8:ca="uploadfiledevcatalog";break;case 9:ca="hardcodedpreinstall";break;case 10:ca="excatalog";break;case 16:ca="wopicatalog"}return ca},ua=M=>{let ca=-1;switch(M.toLowerCase()){case "omex":ca=
0;break;case "spcatalog":ca=1;break;case "spapp":ca=2;break;case "filesystem":ca=3;break;case "exchange":ca=4;break;case "registry":ca=6;break;case "inmemory":ca=7;break;case "uploadfiledevcatalog":ca=8;break;case "hardcodedpreinstall":ca=9;break;case "excatalog":ca=10;break;case "wopicatalog":ca=16}return ca};class Ma{constructor(){this.title=this.id=this.tabs=null}}Object(h.a)(Ma,"AddInDataTransferObject",null,[]);class Ca{constructor(M,ca,Na){this.sqc=M;this.YIh=ca;this.ZIh=Na}get ZE(){return this.sqc}get k2h(){return this.YIh}get l2h(){return this.ZIh}static Ksb(M){return(M=
M.f$)?Object.assign(new Ma,{tabs:M.ZE.toArray(),id:M.k2h,title:M.l2h}):null}}Object(h.a)(Ca,"OneLineRibbonExtensibility",null,[]);class Va{Ynb(M,ca=null){if(M=Ca.Ksb(M)){appChrome.addInApi.dispatchActionsToInstallAddIn(M,ca);for(const Na of M.tabs)if(Na.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(M,()=>{});break}}}VFe(M){(M=Ca.Ksb(M))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(M)}static MIi(M,ca,Na=null){M=Va.Vcj(M);0<M.length&&(Va.whd(M,!1),Na&&Na(ca,M))}static Vcj(M){const ca=
[];if(M&&(M=M.f$,M.ZE&&0<M.ZE.count))for(let Na of M.ZE)if(Na.groups&&0<Na.groups.length)for(const zb of Na.groups)if(zb.controls&&0<zb.controls.length)for(const $b of zb.controls)Array.add(ca,$b.id);return ca}static whd(M){if(M.length){var ca=[];for(const Na of M)ca.push(appChrome.actions.updateControlEnabledDisabledState(Na,!0));appChrome.api.dispatch(ca)}}}Object(h.a)(Va,"OneLineRibbonExtensibilityManager",null,[917]);var Za=d(1008);class Db{constructor(){new Za.a(w.a.instance)}mmh(M,ca){M=O.a.$ag()+
M;w.a.instance.setItem(M,ca.toString())}veg(){var M=O.a.yeg();m.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",M);M=w.a.instance.getItem(M);return ia.a(M)}Unh(M){const ca=O.a.yeg();m.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",ca);w.a.instance.setItem(ca,ia.c(M))}Rwg(){return!!w.a.instance.localStorage}static get instance(){Db.Ja||(Db.Ja=new Db);return Db.Ja}}Db.Ja=null;Object(h.a)(Db,"AddInCommandsCacheManager",null,[892]);var Lb=d(531),yb=d(67);class Bc{static Gbg(M){const ca=new e.a;
if(Bc.HRf)for(var Na of Bc.HRf)ca.add(Na);Na=null;switch(M){case "Workbook":Na=Bc.ADl;break;case "Document":Na=Bc.sKi;break;case "Presentation":Na=Bc.$Bk}if(Na)for(const zb of Na)ca.add(zb);return ca}}Bc.HRf=["PrimaryCommandSurface","ContextMenu"];Bc.ADl=null;Bc.sKi=null;Bc.$Bk=null;Object(h.a)(Bc,"ExtensionPointType",null,[]);class tb{constructor(M){this.Mhf=null;if(Ea.b(M))throw m.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");
this.jJh=M}get mec(){return this.Mhf||(this.Mhf=new e.a)}get oGf(){return this.jJh}}Object(h.a)(tb,"ContextMenuExtensibility",null,[901]);class Mb{constructor(M,ca=null,Na=0){if(Ea.b(M))throw m.ULS.sendTraceTag(9041814,220,10,"OneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("OneLineRibbonExtensibilityObject should not be null or undefined.");this.FTh=M;this.aYh=ca;this.kOh=Na}get f$(){return this.FTh}get startedNode(){return this.aYh}get cZi(){return this.kOh}}Object(h.a)(Mb,
"RibbonExtensibility",null,[972]);class Hb{constructor(M){this.lNh=M.entitlement}get entitlement(){return this.lNh}createActionContext(M,ca){M={};M.ownerAddinInfo=this.entitlement;M.action=ca;return M}}Object(h.a)(Hb,"AddInCommandsContextProvider",null,[]);class vb{constructor(M,ca,Na){this.cYe=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=M;this.eventBuilder=ca;this.contextMenuBuilder=Na}get addinInfo(){return this.cYe}Hyi(M){return new Hb(M)}createActionBuilder(M,
ca){return OfficeExt.DefaultControlActionBinder.createActionBuilder(M,ca.entitlement,ca.manifest)}startApplyAddin(M){this.cYe=M;const ca=this.Hyi(M);this.actionBuilder=this.createActionBuilder(ca,M)}endApplyAddin(){}gZd(M,ca,Na=0){return this.ribbonBuilder.ZE&&0<this.ribbonBuilder.ZE.count?new Mb(this.OYi(M,ca),this.addinInfo.startedNode,Na):null}a8f(){var M=null;if(this.contextMenuBuilder.Y6c&&0<this.contextMenuBuilder.Y6c.count){M||(M=this.addinInfo.entitlement.solutionId);M=new tb(M);for(let ca of this.contextMenuBuilder.Y6c)M.mec.add(ca);
return M}return null}OYi(M,ca){return this.ribbonBuilder.ZE&&0<this.ribbonBuilder.ZE.count?new Ca(this.ribbonBuilder.ZE,M,ca):null}}Object(h.a)(vb,"AddinCommandsBuilder",null,[]);class Xb{constructor(M,ca,Na,zb,$b,Tc,hd){this.Nhb=new yb.a;this.Yw=M;this.En=ca;this.aS=Na;this.ckc=zb;this.eQd=$b;this.FIa=Tc;this.mob=hd;this.E$=A.AFrameworkApplication.Aa.EU}$Wc(M,ca,Na,zb,$b,Tc,hd){const Hd=(le,ge,Zd,Oe)=>{$b(le,ge,Zd,Oe);le=Lb.a[this.Yw]+ge.assetId;({value:ge}=this.Nhb.Rf(le)).returnValue&&(ge.stop(),
this.Nhb.remove(le))};if(0!==this.Yw&&M){m.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",M.count);4===this.Yw&&(m.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",zb)),this.Poi(M,zb),Tc());for(let le of M)if(M=le,m.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.aS.HS,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId))),this.LFh(M))if(hd&&M.requireConsent)hd(M,
ge=>{try{if(this.E$){const Oe=Lb.a[this.Yw]+ge.solutionId,tc=this.E$.zi("ComponentAttach",Oe);this.Nhb.$(Oe,tc)}const Zd=this.FIa.j6a(ge.storeType,ge.solutionId);6!==this.Yw&&(Zd&&(this.JEc(Zd),Zd.OL.purge(!1)),this.En.insertOsfControl(this.khc(ge,ca,Na,Hd)),Zd&&this.En.ownerAddinControlRecreated(ge.solutionId,ge.storeType))}catch(Zd){m.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",
this.aS.HS,Telemetry.PrivacyRules.GetPrivacyCompliantId(ge.solutionId,ge.ownerAddinStoreType||ge.storeType,ge.assetId,null,null,ge.storeId),ge.version,ge.storeType,ge.storeId,Zd.message)),Hd(!1,ge,null,null)}});else try{if(this.E$){const Zd=Lb.a[this.Yw]+M.solutionId,Oe=this.E$.zi("ComponentAttach",Zd);this.Nhb.$(Zd,Oe)}const ge=this.FIa.j6a(M.storeType,M.solutionId);6!==this.Yw&&(ge&&(this.JEc(ge),ge.OL.purge(!1)),this.En.insertOsfControl(this.khc(M,ca,Na,Hd)),ge&&this.En.ownerAddinControlRecreated(M.solutionId,
M.storeType))}catch(ge){m.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.aS.HS,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId,ge.message)),Hd(!1,M,null,null)}else Hd(!1,M,null,null)}}eUj(M,ca,Na,zb,$b,Tc){const hd=(Hd,le,ge,Zd)=>{Tc(Hd,le,ge,Zd);Hd=Lb.a[this.Yw]+le.solutionId;
({value:le}=this.Nhb.Rf(Hd)).returnValue&&(le.stop(),this.Nhb.remove(Hd))};if(6===this.Yw&&M)if(m.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.aS.HS,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId))),this.LFh(M))try{if(this.E$){const le=Lb.a[this.Yw]+M.solutionId,ge=this.E$.zi("ComponentAttach",le);this.Nhb.$(le,ge)}const Hd=this.FIa.j6a(M.storeType,M.solutionId);Hd||hd(!1,M,null,null);
A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.jb.sXf?this.q8f(M,ca,zb,$b,Na,le=>{hd(le,M,Na,Hd.displayName)}):(this.q8f(M,ca,zb,$b,Na),hd(!0,M,Na,Hd.displayName))}catch(Hd){m.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.aS.HS,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,
M.storeType,M.storeId,Hd.message)),hd(!1,M,null,null)}else hd(!1,M,null,null)}kjk(M,ca,Na,zb,$b,Tc){if(Tc)if(Tc._isAddinCommandsManifest(this.aS.HS))try{A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.jb.sXf?this.p8f(M,ca,Na,$b,Tc,hd=>{zb(hd,M,Tc,Tc.getDefaultDisplayName())}):(this.p8f(M,ca,Na,$b,Tc),zb(!0,M,Tc,Tc.getDefaultDisplayName()))}catch(hd){m.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",
this.aS.HS,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId,hd.message)),zb(!1,M,Tc,Tc.getDefaultDisplayName())}else m.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.aS.HS,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,
M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId)),zb(!1,M,null,null);else m.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.aS.HS,Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.ownerAddinStoreType||M.storeType,M.assetId,null,null,M.storeId),M.version,M.storeType,M.storeId)),zb(!1,M,null,null)}khc(M,ca,Na,zb){const $b={},Tc=document.createElement("div");Tc.setAttribute("visible",
"false");$b.div=Tc;$b.id=M.solutionId;$b.solutionId=M.solutionId;$b.version=M.version;$b.storeType=M.storeType;$b.storeId=M.storeId;$b.assetId=M.assetId;$b.assetStoreId=M.assetStoreId;$b.isvirtualOsfControl=!0;$b.virtualOsfControlActivationCallback=(hd,Hd)=>{const le=this.FIa.j6a(M.storeType,M.solutionId);le&&(le.isUpgraded&&(M.isUpgraded=!0),this.JEc(le));this.kjk(M,ca,Na,zb,hd,Hd)};$b.reason=3===this.Yw?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;
return $b}p8f(M,ca,Na,zb,$b,Tc=null){const hd={};hd.solutionId=zb.getSolutionId();hd.version=zb.getVersion();hd.storeType=zb.getStoreType();hd.storeId=zb.getStoreId();hd.assetId=zb.getAssetId();hd.assetStoreId=zb.getAssetStoreId();hd.targetType=zb.getOsfControlType();let Hd=null,le=null;if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Hd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.aS.HS,this.aS.formFactor)).parseExtensions(hd,
$b,this.mob),le=Bc.Gbg(this.aS.HS);else try{Hd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.aS.HS,this.aS.formFactor)).parseExtensions(hd,$b,this.mob),le=Bc.Gbg(this.aS.HS)}catch(Zd){throw m.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Zd.message),Zd;}if(le&&0<le.count){if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var ge=ca(M);ca=Na(M);Na=!!A.AFrameworkApplication.fa&&
A.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");ge=new vb(ge,null,ca);for(let Zd of le)ge.commandSurface=Zd,Hd.apply(ge,this.mob,Na)}else try{let Zd=ca(M),Oe=Na(M),tc=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("AddinCommandsMultipleCustomTabsEnabled");ge=new vb(Zd,null,Oe);for(let Xh of le)ge.commandSurface=Xh,Hd.apply(ge,this.mob,tc)}catch(Zd){throw m.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Zd.message),Zd;
}if(OSF.OUtil.checkFlight(14))try{let Zd=ge.gZd(M.solutionId,$b.getDefaultDisplayName()),Oe=ge.a8f();Zd&&this.ckc.Ynb(Zd,Tc);Oe&&this.eQd.YCf(Oe);this.FIa.JDf(zb,Zd,Oe,$b.getDefaultDisplayName());m.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",$b.getDefaultDisplayName())}catch(Zd){throw OfficeExt.DevConsole.log(Zd),m.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Zd.message),Zd;}else try{let Zd=ge.gZd(M.solutionId,$b.getDefaultDisplayName()),Oe=ge.a8f();
Zd&&this.ckc.Ynb(Zd);Oe&&this.eQd.YCf(Oe);this.FIa.JDf(zb,Zd,Oe,$b.getDefaultDisplayName());m.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",$b.getDefaultDisplayName())}catch(Zd){throw m.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Zd.message),Zd;}}}q8f(M,ca,Na,zb,$b,Tc=null){const hd={};hd.solutionId=M.solutionId;hd.version=M.version;hd.storeType=M.storeType;hd.storeId=M.storeId;hd.assetId=M.assetId;hd.assetStoreId=M.assetStoreId;hd.targetType=M.targetType;
const Hd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.aS.HS,this.aS.formFactor);try{const le=ca.getManifest(),ge=Hd.parse(hd,le,$b,this.mob,ca.getSharedRuntimeId(),ca),Zd=Na(M),Oe=zb(M),tc=new vb(Zd,null,Oe);tc.commandSurface="PrimaryCommandSurface";ge.apply(tc,this.mob,!0);if(tc.ribbonBuilder.ZE&&0<tc.ribbonBuilder.ZE.count){const Xh=tc.gZd(M.solutionId,ca.getManifest().getDefaultDisplayName(),1);A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",
!1)?this.ckc.Ynb(Xh,Tc):Xh&&this.ckc.Ynb(Xh,Tc);this.FIa.H2h(ca,Xh,$b,ca.getManifest().getDefaultDisplayName());m.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",ca.getManifest().getDefaultDisplayName())}}catch(le){m.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ca.getManifest().getDefaultDisplayName(),le.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(le)}}JEc(M){M.tJ&&this.ckc.VFe(M.tJ);M.dXb&&this.eQd.CPk(M.dXb);
this.FIa.jPk(M.OL.getStoreType(),M.OL.getSolutionId())}Poi(M,ca){ca=Ya(ca);for(let Na of this.FIa.rvb){if(Na.OL.getStoreType()!==ca)continue;let zb=!0;for(let $b of M){const Tc=$b;if(Tc&&Na.Qyg(Tc.storeType,Tc.solutionId)){zb=!1;break}}zb&&(this.JEc(Na),Na.OL.purge(!1))}}LFh(M){return!!M&&!!M.solutionId&&!!M.version&&!!M.storeType&&!!M.storeId}}Object(h.a)(Xb,"AddInCommandsIntegration",null,[]);var Uc=d(1116),hb=d(163),Zb=d(911),Fc=d(569),ob=d(340),ac=d(912),pb=d(141),nb=d(95),Tb=d(63),Ub=d(55);class hc{static get W6(){return hc.YF||
(hc.YF=Ub.a.instance.qb("Common.Utils.IAriaNotifier"))}static ITf(M,ca,Na,zb){hc.eV&&hc.eV.VK&&hc.eV.dismiss();hc.eV=Uc.a.mRd(ca,M,M,3);hc.eV.content=Na;Ea.a(zb)||(hc.eV.title=zb,hc.eV.c3b=!0);M=new Sys.UI.Bounds(0,0,nb.a.LPc(),nb.a.KPc());hc.eV.iZ=hc.WZd(M,ca,hc.eV.Y$,1);hc.eV.show();hc.W6&&hc.W6.sendNotification(Na.innerText,!0)}static GQd(M,ca,Na,zb=null){pb.UISurfaces.gN().then($b=>{let Tc=null;hc.kRb&&($b.removeNotification(hc.kRb),hc.kRb=null);const hd=$b.callout(Object.assign(new Zb.a,{target:M,
title:ca,content:Na,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new ac.a,{onDismiss:()=>{$b.removeNotification(Tc)},directionalHint:null!=zb?zb:null})})),Hd=Object.assign(new ob.a,{expirationOptions:Object.assign(new Fc.a,{displayTimeoutSeconds:7,onExpire:()=>{$b.removeNotification(hc.kRb)}})});Tc=hc.kRb=$b.addNotification(hd,Hd);return null},$b=>{m.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",$b);return null})}static FNe(M){hc.eV&&
hc.eV.VK&&hc.eV.dismiss();const ca=new y.StandardDialog;ca.XYa=!1;ca.yd=0;ca.jy(hb.a.$Tj,CommonUIStrings.l_DialogError,Ea.a(M)?hc.eag():M,null)}static Kcl(M){hc.eV&&hc.eV.VK&&hc.eV.dismiss();m.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",M.errorCode));const ca=Ea.a(M.description)?hc.eag():M.description,Na=new y.StandardDialog;let zb=null;M.vVb?(Na.yd=1,Na.Ue(1,M.buttonText),Na.Zwa(1)):Na.yd=0;zb=$b=>{1===$b?M.vVb():M.NYb&&M.NYb()};Na.XYa=!1;0===M.T7d?
Na.jy(M.errorCode,M.title?M.title:CommonUIStrings.l_DialogError,ca,zb):1===M.T7d?Na.DO(M.title?M.title:CommonUIStrings.l_DialogWarning,ca,zb):Na.whb(M.title?M.title:CommonUIStrings.l_DialogInfo,ca,zb)}static WZd(M,ca,Na,zb){let $b=0===zb?0:4;const Tc=M.x+M.width-ca.x-ca.width;ca.x-M.x+ca.width/2<=Na/2?$b=0===zb?2:5:Tc+ca.width/2<=Na/2&&($b=0===zb?3:6);return $b}static Vcl(M,ca,Na,zb=!1){(ca=Ca.Ksb(ca))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ca,
$b=>{$b&&(zb||hc.GQd($b,Na,M,5))})}static Wcl(M,ca,Na=!1){hc.Vcl(ca.startedNode?ca.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,M),ca,ca.startedNode?ca.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,M),Na)}static Ucl(M,ca,Na,zb){if(hc.eFh)M=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Na,zb,CommonUIStrings.l_InsertionDialogRefresh)),hc.GQd(ca,M,CommonUIStrings.l_ErrorLoadingAddInsTitle,
1);else{ca=Tb.a.ei(ca);var $b=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Tc=document.createElement("span");Tc.innerText=$b[0];var hd=document.createElement("span");hd.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,Na,zb,CommonUIStrings.l_InsertionDialogRefresh);hd.className="UIFontBold";Na=document.createElement("span");Na.innerText=$b[1];zb=document.createElement("div");Sys.UI.DomElement.addCssClass(zb,"ModalCalloutControl");zb.appendChild(Tc);
zb.appendChild(hd);zb.appendChild(Na);hc.ITf(M,ca,zb,CommonUIStrings.l_ErrorLoadingAddInsTitle)}}static vel(M,ca){var Na=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,zb=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;hc.eFh?hc.GQd(ca,Na,zb):(ca=Tb.a.ei(ca),hc.ITf(M,ca,hc.whi(zb),Na))}static whi(M){const ca=document.createElement("div");Sys.UI.DomElement.addCssClass(ca,"ModalCalloutControl");ca.innerText=M;return ca}static eag(){return CommonUIStrings.l_InternalError+" "+
CommonUIStrings.l_InternalError_Directive}static get eFh(){return A.AFrameworkApplication.Aa.jb.Do&&A.AFrameworkApplication.Aa.jb.MSa}}hc.eV=null;hc.kRb=null;hc.YF=null;Object(h.a)(hc,"AddInCommandsNotificationFactory",null,[]);class Wb{constructor(M,ca,Na,zb,$b,Tc,hd,Hd=null){this.Pa=new E.a;this.dqd=M;this.ELh=ca;this.tR=Na;this.kAf=zb;this.Jmb=$b;this.$Ih=Tc;this.wqc=hd;this.wTh=Hd;this.eQh=A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled");this.gwd=
A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")}J4h(M){this.Pa.addHandler(O.a.MFf,M)}F5h(M){this.Pa.addHandler(O.a.Mde,M)}W7h(M){this.Pa.addHandler(O.a.Wrh,M)}W4h(M){this.Pa.addHandler(O.a.tLd,M)}oUj(M,ca,Na){const zb=Na[O.a.MBc],$b=void 0===Na[O.a.S6]?0:Na[O.a.S6];if(zb&&0!==$b)if(0>=zb.count&&4!==$b)this.w7g(new ea($b,null,null,ca,null,!0));else{var Tc=zb.count,hd=new Ga(new Va),Hd=void 0===Na[O.a.bqa]?-1:Na[O.a.bqa],le=new Xb($b,this.tR,this.dqd,
hd,this.ELh,this.Jmb,this.wqc),ge=ii=>this.kAf.Ugi(ii.solutionId,this.wqc,this.dqd,M),Zd=ii=>this.kAf.Yfi(ii.solutionId),Oe=(ii,Rh,Wf)=>{Tc--;Wf=new ea($b,Rh,hd,ca,Wf,0>=Tc);if(ii&&Rh)this.w7g(Wf);else{if(3===$b||Rh&&Rh.isUpgraded)ii="",Rh&&(ii=Telemetry.PrivacyRules.GetPrivacyCompliantId(Rh.solutionId,Rh.ownerAddinStoreType||Rh.storeType,Rh.assetId,null,null,Rh.storeId)),Rh={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"onAddinCompletedBase.fail",["SDX_Id"]:ii},X.a.sendTelemetryEvent(Object.assign(new Z.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.sD(Rh)}));this.v7g(Wf)}Tc||A.AFrameworkApplication.Aa.updateCommandUI()},tc=(ii,Rh,Wf,Yh)=>{Oe(ii,Rh,Yh)},Xh=()=>{this.Ove();0>=zb.count&&4===$b&&this.Jmb.DKe()};6===$b?(Hd=Na[O.a.sLi],Na=Na[O.a.tLi],le.eUj(zb.ga(0),Hd,Na,ge,Zd,(ii,Rh,Wf,Yh)=>{Oe(ii,Rh,Yh)})):le.$Wc(zb,ge,Zd,Hd,tc,Xh,this.wTh)}else X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.sD({["SDX_AppInstallOrigin"]:"User",
["SDX_AppInstallErrorCode"]:"LaunchOneLineRibbonAddinCommands.fail",["SDX_Id"]:""})})),m.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.dqd.HS)),this.v7g(new ea($b,null,null,ca,null,!0))}v7g(M){this.Ove(M);this.Msh(!1,M)}w7g(M){const ca=M.tu;let Na=null;null!==ca&&(Na=ca.storeType,Na=Na.toLowerCase());if(M&&"omex"===Na&&(3===M.Yw||ca.isUpgraded)){var zb={["SDX_AppInstallOrigin"]:"User",["SDX_AppInstallErrorCode"]:"0",["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,
ca.ownerAddinStoreType||ca.storeType,ca.assetId,null,null,ca.storeId)};X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.sD(zb)}))}this.Ove(M);zb=this.gwd&&bb()&&"omex"===Na&&!!M.q$&&!!ca.solutionId&&2===M.Yw&&ca.solutionId.toLowerCase()===Ha().toLowerCase();var $b="omex"===Na&&!!M.q$&&(3===M.Yw&&"hardcodedpreinstall"!==Na||ca.isUpgraded);const Tc=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableLaunchCDAddIn",
!1)&&"excatalog"===Na&&3===M.Yw;if($b||zb||Tc)zb=new P,zb.tu=ca,zb.tJ=M.q$.hTa,this.Pa.raiseEvent(O.a.tLd,zb);this.eQh&&(zb=sa(),$b=Ha(),zb&&ca&&"excatalog"===ca.storeType&&M.q$&&5===M.Yw&&$b&&(ca.storeId&&ca.storeId.toLowerCase()===$b.toLowerCase()||ca.assetId&&ca.assetId.toLowerCase()===$b.toLowerCase())&&(zb=new P,zb.tu=ca,zb.tJ=M.q$.hTa,this.Pa.raiseEvent(O.a.tLd,zb),m.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event.")));ca&&(Db.instance.mmh(ua(Na),!0),"uploadfiledevcatalog"===
Na&&(zb=this.$Ih.createAddinDataProvider(Na,this.tR))&&zb.localCacheAddinCommands(this.tR.Zva,ca.solutionId,ca.version,ca.storeId),T.a.kKb(O.a.gUb,"true",ua(Na)));this.Msh(!0,M)}Msh(M,ca){M?A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&ca.q$&&5===ca.Yw&&ca.q$.hTa&&void 0!==ca.tu.showCallout&&null!==ca.tu.showCallout&&ca.tu.showCallout?(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",
!1)?(new ta(this.Pa)).GHd(ca.tu,Ca.Ksb(ca.q$.hTa)):(new qa(this.Pa,ca.tu,Ca.Ksb(ca.q$.hTa))).GHd(),M=new P,M.tJ=ca.q$.hTa,M.tu=ca.tu,this.Pa.raiseEvent(O.a.Wrh,M)):3!==ca.Yw?ca.uBg&&this.Jmb.DKe():ca.q$&&ca.q$.hTa&&"hardcodedpreinstall"!==ca.tu.storeType&&hc.Wcl(ca.displayName,ca.q$.hTa,ca.tu.isAutoLaunched):3===ca.Yw?ca.tu&&"uploadfiledevcatalog"===ca.tu.storeType.toLowerCase()?(ca=this.wqc.c5i(ca.tu.solutionId),hc.FNe(ca?ca:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.Jmb.b4k():ca.uBg&&this.Jmb.DKe()}Ove(M=null){var ca=M?M.tu:null;const Na=new P;if(Na.tu=ca){var zb=this.Jmb.j6a(ca.storeType,ca.solutionId,6===M.Yw?1:0);if(zb&&zb.tJ){Na.tJ=zb.tJ;var $b=this.gwd?Ha():null;$b=this.gwd&&bb()&&!!ca.solutionId&&!!$b&&ca.solutionId.toLowerCase()===$b.toLowerCase()&&2===M.Yw;if(3===M.Yw&&"hardcodedpreinstall"!==ca.storeType||$b)M="",zb.tJ.f$&&zb.tJ.f$.ZE&&(zb=zb.tJ.f$.ZE.ga(0))&&(M=zb.id),ca={["SDX_CommandPlacement"]:M,["SDX_PinningAction"]:"Pinning",["SDX_PinningActionErrorCode"]:"0",
["SDX_Id"]:Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,ca.ownerAddinStoreType||ca.storeType,ca.assetId,null,null,ca.storeId)},X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:K.a.sD(ca)}))}}this.Pa.raiseEvent(O.a.MFf,Na)}}Object(h.a)(Wb,"LaunchAddinCommandsHandler",null,[898]);class fd{constructor(M){this.QTh=M}get Zva(){return this.QTh}insertOsfControl(M){return this.Zva.insertOsfControl(M)}getManifestInvaildErrorString(){return this.Zva.getManifestInvaildErrorString()}isAddinCommandsAsync(M,
ca){this.Zva.isAddinCommandsAsync(M,ca)}isAddinCommandsExAsync(M,ca){this.Zva.isAddinCommandsExAsync(M,ca)}ownerAddinControlRecreated(M,ca){this.Zva.ownerAddinControlRecreated(M,ca)}queryEntitlementDetails(M){this.Zva.queryEntitlementDetails(M)}}Object(h.a)(fd,"ContextActivationMgrWrapper",null,[899]);class fc{}fc.mjb="Alt";fc.njb="Command";fc.id="Id";fc.m_a="Image16by16";fc.ojb="LabelText";fc.button="Button";fc.kYd="FlyoutAnchor";Object(h.a)(fc,"AddinDataNodeConstants",null,[]);var bc=d(221),cc=
d(396),kb=d(346),ab=d(72);class Pb{constructor(M,ca){this.Qvc=this.k0e=null;if(Ea.b(M)||Ea.b(ca))throw m.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.msd=ca;this._id=M;this.RM[fc.id]=this._id}get id(){return this._id||""}get RM(){return this.k0e||(this.k0e={})}get controlType(){return this.msd||""}get menuItems(){return this.Qvc||(this.Qvc=new e.a)}aoc(){let M=null;
this.msd===fc.kYd?M=Object.assign(new cc.a,{Menu:this.uek()}):this.msd===fc.button&&(M=Object.assign(new bc.a,{}));M&&(this.RM[fc.id]&&(M.ExternalId=this.RM[fc.id]),this.RM[fc.njb]&&(M.Command=this.RM[fc.njb].toString()),this.RM[fc.ojb]&&(M.LabelText=this.RM[fc.ojb]),this.RM[fc.mjb]&&(M.Alt=this.RM[fc.mjb]),this.RM[fc.m_a]&&(ab.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.RM[fc.m_a]),M.ExternalImageId=this._id));return M}uek(){const M=Object.assign(new kb.a,
{UpdateDynamically:!0,MenuSectionList:[]});if(this.Qvc){const ca=Object.assign(new r.a,{ControlList:[]});for(let Na of this.Qvc)Array.add(ca.ControlList,Na.aoc());Array.add(M.MenuSectionList,ca)}return M}}Object(h.a)(Pb,"ControlDefinition",null,[897]);class rc{constructor(M){this.Caa=null;if(Ea.b(M))throw m.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=M;this.tdc[fc.id]=this._id}get tdc(){return this.Caa||
(this.Caa={})}get id(){return this._id||""}aoc(){const M=Object.assign(new bc.a,{});this.Caa[fc.id]&&(M.ExternalId=this.Caa[fc.id]);this.Caa[fc.njb]&&(M.Command=this.Caa[fc.njb].toString());this.Caa[fc.ojb]&&(M.LabelText=this.Caa[fc.ojb]);this.Caa[fc.mjb]&&(M.Alt=this.Caa[fc.mjb]);this.Caa[fc.m_a]&&(ab.c()&&appChrome.addInApi.registerAddinIcon&&appChrome.addInApi.registerAddinIcon(this._id,this.Caa[fc.m_a]),M.ExternalImageId=this._id);return M}}Object(h.a)(rc,"MenuItemDefinition",null,[937]);class ic{constructor(M){this.Prc=
null;if(Ea.b(M))throw m.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=M}get id(){return this._id}get controls(){return this.Prc||(this.Prc=new e.a)}aoc(){const M=[];if(this.Prc)for(let ca of this.Prc){const Na=ca.aoc();Na&&M.push(Na)}return M}}Object(h.a)(ic,"OfficeMenuDefinition",null,[894]);var md=d(35);class Fd{constructor(M,ca,Na){this.UU=this.Bkb=null;this.Hzd=M;this.jkb=
ca;this.wjb=Na;this.FSh=new e.a}get I7c(){return this.Hzd}get HWb(){return this.jkb}get bHd(){return this.wjb}addButton(M){m.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",M.actionType);this.UU=new Pb(this.jOa(M.id),fc.button);this.UU.RM[fc.ojb]=M.label;this.UU.RM[fc.mjb]=M.label;this.UU.RM[fc.m_a]=M.icon["16"];this.cVb(this.UU.RM[fc.id],M.action);this.q3a(this.UU.RM);this.Bkb.controls.add(this.UU);this.UU=null}startBuildMenu(M){if(Ea.b(this.Bkb))this.Bkb=new ic(M.id);else{const ca=
this.jOa(M.id);this.UU=new Pb(ca,fc.kYd);this.ppb(this.UU.RM,M);this.UU.RM[fc.m_a]=M.icon["16"];this.UU.RM[fc.njb]=md.a.xob}}addMenuItem(M){m.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",M.actionType);const ca=new rc(this.jOa(M.id));this.ppb(ca.tdc,M);M.icon&&(ca.tdc[fc.m_a]=M.icon["16"]);this.cVb(ca.tdc[fc.id],M.action);this.q3a(ca.tdc);this.UU.menuItems.add(ca)}endBuildMenu(){Ea.b(this.UU)?(this.Y6c.add(this.Bkb),this.Bkb=null):(this.Bkb.controls.add(this.UU),this.UU=
null)}get Y6c(){return this.FSh}cVb(M,ca){this.bHd.bindAction(M,ca)}q3a(M){this.HWb.q3a(M)}jOa(M){return this.I7c.zCa(M)}ppb(M,ca){M[fc.ojb]=ca.label;M[fc.mjb]=ca.label}}Object(h.a)(Fd,"ContextMenuExtensibilityCreator",null,[916,912]);class ne{constructor(M){this.mQb=M}get Udc(){return this.mQb}zCa(M){return this.Udc+M}}Object(h.a)(ne,"DefaultContextMenuNamingProvider",null,[915]);class ud{constructor(M,ca,Na,zb){this.mQb=M;A.AFrameworkApplication.fa.ka("AddInCommandsMissingTabIsEnabled")&&Na.y9i();
this.Kxf=ca;this.nXh=zb}get Udc(){return this.mQb}get solutionId(){return this.Kxf}get jNe(){return this.nXh}zCa(M){M=this.Udc+this.solutionId+M;return this.jNe?(M in ud.NBc||(ud.NBc[M]="AddinControl"+ud.L8h++),ud.NBc[M]):M}BWf(M){if(this.jNe){const Na=ud.NBc;for(let zb in Na){var ca=zb;if(M===Na[zb])return ca.substr(this.Udc.length+this.solutionId.length)}}return M}ahj(M){M=this.Udc+this.solutionId+M;return this.jNe?(M in ud.iJd||(ud.iJd[M]="AddinTab"+ud.Q8h++),ud.iJd[M]):M}}ud.NBc={};ud.iJd={};
ud.Q8h=0;ud.L8h=0;Object(h.a)(ud,"DefaultRibbonNamingProvider",null,[896]);class gb{bindAction(M,ca){OfficeExt.DefaultControlActionBinder.bindAction(M,ca)}}Object(h.a)(gb,"DefaultUIControlActionBinder",null,[914]);class Vb{constructor(M){this.hLh=M}get command(){return this.hLh}q3a(M){M[fc.njb]=this.command}}Object(h.a)(Vb,"DefaultUIControlCommandBinder",null,[913]);var Lc=d(523);class Xc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=
null}}Object(h.a)(Xc,"AddInControl",null,[]);class Ib{constructor(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}}Object(h.a)(Ib,"AddInGroup",null,[]);class gc{constructor(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}}Object(h.a)(gc,"AddInMenuItem",null,[]);class Fb{constructor(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=
!1}}Object(h.a)(Fb,"AddInTab",null,[]);class fb{constructor(M,ca,Na,zb,$b,Tc){this.sqc=new e.a;this.IMb=this.Lya=this.Ckb=null;this.Hzd=M;this.wjb=ca;this.jkb=Na;this.Kxf=zb;this.wqc=$b;this.c4e=Tc}get I7c(){return this.Hzd}get ZE(){return this.sqc}get bHd(){return this.wjb}get HWb(){return this.jkb}startBuildTab(M){const ca=M.isOfficeTab?M.id:this.I7c.ahj(M.id),Na=M.isOfficeTab?null:M.label;this.Ckb=Object.assign(new Fb,{id:ca,title:Na,isOfficeTab:M.isOfficeTab,visible:M.visible,groups:[],tabType:M.tabType,
insertBefore:M.insertBefore,insertAfter:M.insertAfter,autoFocus:M.autoFocus})}startBuildGroup(M){const ca=this.jOa(M.id);this.Lya=Object.assign(new Ib,{id:ca,mlrId:M.mlrId,title:M.label,controls:[],groupType:0})}addNativeGroup(M){this.Lya=Object.assign(new Ib,{id:M.id,mlrId:M.mlrId,title:M.label,controls:[],groupType:1});this.Ckb.groups.push(this.Lya)}addButton(M){const ca=this.jOa(M.id);ca&&(this.cVb(ca,M.action),m.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",
M.actionType),M=Object.assign(new Xc,{id:ca,title:M.label,iconLocation:this.E0d(M),enabled:M.enabled,controlType:0,attributes:this.ppb()}),this.c4e.ECf(new Lc.a(ca,this.HWb.command.toString())),this.Lya.controls.push(M))}addNativeControl(M){M.id&&(m.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",M.actionType),M=Object.assign(new Xc,{id:M.id,title:"",iconLocation:"",enabled:M.enabled,controlType:2,attributes:this.ppb()}),this.Lya.controls.push(M))}startBuildMenu(M){const ca=
this.jOa(M.id);ca&&(this.IMb=Object.assign(new Xc,{id:ca,title:M.label,iconLocation:this.E0d(M),controlType:1,attributes:{},menuItems:[]}))}addMenuItem(M){const ca=this.jOa(M.id);ca&&(this.cVb(ca,M.action),m.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",M.actionType),M=Object.assign(new gc,{id:ca,title:M.label,iconLocation:this.E0d(M),enabled:M.enabled,attributes:this.ppb()}),this.c4e.ECf(new Lc.a(ca,this.HWb.command.toString())),this.IMb.menuItems.push(M))}endBuildMenu(){Ea.b(this.IMb.id)||
this.Lya.controls.push(this.IMb);this.IMb=null}endBuildGroup(){Ea.b(this.Lya.id)||this.Ckb.groups.push(this.Lya);this.Lya=null}endBuildTab(){Ea.b(this.Ckb.id)||this.sqc.add(this.Ckb);this.Ckb=null}ppb(){const M={};this.q3a(M);return M}E0d(M){return M.icon["80"]?M.icon["80"]:M.icon["32"]}q3a(M){this.HWb.q3a(M)}jOa(M){return this.I7c.zCa(M)}cVb(M,ca){this.bHd.bindAction(M,ca)}}Object(h.a)(fb,"OneLineRibbonExtensibilityCreator",null,[911,912]);class Pc{constructor(M,ca){this.mQb=M;this.wjb=new gb;this.jkb=
new Vb(ca)}Yfi(M){M=new ne(M);return new Fd(M,this.jkb,this.wjb)}Ugi(M,ca,Na,zb){Na=new ud(this.mQb,M,Na,!0);return new fb(Na,this.wjb,this.jkb,M,ca,zb)}}Object(h.a)(Pc,"UIExtensibilityFactory",null,[893]);class dd{createAddinDataProvider(M,ca){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(M,ca.Zva)}static get instance(){dd.Ja||(dd.Ja=new dd);return dd.Ja}}dd.Ja=null;Object(h.a)(dd,"OSFAddinDataProviderFactory",null,[895]);class kd{constructor(){this.nob=null}setErrorMessageForAddin(M,
ca){this.nob||(this.nob={});this.nob[M]=ca}c5i(M){return this.nob&&M in this.nob?this.nob[M]:null}}Object(h.a)(kd,"AddinCommandsErrorManager",null,[]);class Td{constructor(){this.T7d=0;this.vVb=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.xmg=!1;this.lwj=this.NYb=null}}Object(h.a)(Td,"AddInCommandsNotificationParameters",null,[]);class ce{constructor(){this.VYe=this.Kpd=null}get cHd(){return this.Kpd||(this.Kpd=OfficeExt.DefaultControlActionBinder.retrieveActionContext)}set cHd(M){this.Kpd=
M}get idi(){return this.VYe||(this.VYe=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}getTaskPaneControlIdFromSolutionIdRuntimeId(M,ca){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromSolutionIdRuntimeId(M,ca)}getTaskPaneControlIdFromAssetIdRuntimeId(M,ca){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(M,ca)}y2b(M,ca,Na,zb,$b){m.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",M);if((M=ca.j6a($b.ownerAddinInfo.storeType,
$b.ownerAddinInfo.solutionId))&&M.OL&&!M.OL.getIsUpgrading())if(ca=null,0<M.OL.getNotificationParams().length&&(ca=this.fLf(M.OL.getNotificationParams()[0]))&&2147758681===ca.errorCode&&(M.isUpgraded=!0),2!==M.OL.getStatus()&&(1!==M.OL.getStatus()||ca&&2147758681===ca.errorCode))ca&&this.Trh(M,ca,null);else try{Na.setOwnerAddinEToken(M.OL.getEToken()),$b.action(Na,zb.Zva)}catch(Tc){m.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",A.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?
Tc.stack:Tc.message)),hc.FNe(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}}Trh(M,ca,Na=null){const zb=M.OL;if(1===zb.getNotificationParams().length||ca.xmg){const $b=ca.vVb,Tc=ca.NYb;ca.vVb=()=>{zb.removeFirstNotification();if(0<zb.getNotificationParams().length){const hd=this.fLf(zb.getNotificationParams()[0]);this.Trh(M,hd)}2147758681===ca.errorCode&&(Va.MIi(M.tJ,zb,Object(D.a)(this,this.tog,"initUpgradeStateDetectTask")),v.GIi(M.dXb,zb,Object(D.a)(this,this.tog,
"initUpgradeStateDetectTask")));$b&&$b()};ca.NYb=()=>{Tc&&Tc();Na&&Na()};hc.Kcl(ca)}}tog(M,ca){let Na=null;Na=()=>{M.getIsUpgrading()?window.setTimeout(Na,1E3):M.getUpgradingFailed()?Va.whd(ca,!0):A.AFrameworkApplication.Aa.updateCommandUI()};window.setTimeout(Na,1E3)}fLf(M){const ca=new Td;ca.T7d=M.infoType;ca.id=M.id;ca.title=M.title;ca.description=M.description;ca.buttonText=M.buttonTxt;ca.vVb=M.buttonCallback;ca.xmg=M.highPriority;ca.NYb=M.dismissCallback;ca.errorCode=M.errorCode;ca.lwj=M.iframeNotificationUrl;
return ca}}Object(h.a)(ce,"AddinCommandsActionHandler",null,[978]);class ld{constructor(){this.labelText=null;this.visible=!1}}Object(h.a)(ld,"AddinStatusCommandValues",null,[]);class ad{static eFk(M){const ca=new ld;ca.labelText=M.hUb;ca.visible=ca.labelText?!0:!1;return ca}static lOe(){const M=document.getElementById(void 0);M?ad.Hsh(void 0,void 0,M,void 0,void 0):m.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",void 0))}static Hsh(M,ca,Na,zb,$b){Na?M.hUb===CommonUIStrings.l_ErrorLoadingAddInsTitle?
hc.Ucl(ca,Na,zb,$b):M.hUb===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&hc.vel(ca,Na):m.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))}}Object(h.a)(ad,"AddinCommandsStatusHandler",null,[]);class Yf{constructor(){this.Yw=this.k0=0;this.$Id=null;this.acd=this.rmd=0;this.eLa=this.vud=this.bqd=this.SFc=this.oCa=this.aqa=null}get ZId(){this.bqd||(this.bqd=new e.a);return this.bqd}get $Yd(){this.vud||(this.vud=new e.a);return this.vud}get L4a(){this.eLa||
(this.eLa=new e.a);return this.eLa}}Object(h.a)(Yf,"AddinCommandsListLoaderContext",null,[]);const Xd=M=>{const ca={};ca.solutionId=M.solutionId;ca.version=M.version;ca.storeType=M.storeType;ca.storeId=M.storeId;ca.assetId=M.assetId;ca.assetStoreId=M.assetStoreId;ca.targetType=M.targetType;ca.requireConsent=M.requireConsent||!1;ca.isAddinCommands=!0;ca.addinCommandsActionType=0;return ca};class fg{constructor(M,ca){this.entitlement=M;this.metadata=ca}Hyh(){const M=Xd(this.entitlement);M.targetType=
this.targetType;return M}get solutionId(){return this.entitlement.solutionId}get version(){return this.entitlement.version}get storeType(){return this.entitlement.storeType}get storeId(){return this.entitlement.storeId}get assetId(){return this.entitlement.assetId}get assetStoreId(){return this.entitlement.assetStoreId}get targetType(){return-1!==this.entitlement.targetType?this.entitlement.targetType:this.metadata.targetType}get eToken(){return this.entitlement.eToken}get requireConsent(){return this.entitlement.requireConsent}get installTimeInMS(){return this.entitlement.installTimeInMS}}
Object(h.a)(fg,"AddinEntitlementEx",null,[]);var ue=d(21);class Sa{constructor(M){this.rg=null;this.qaa=M}get_current(){if(!this.rg)throw Error.argumentOutOfRange();return this.rg.data}moveNext(){if(!this.rg)return this.rg=this.qaa,!!this.qaa;if(!this.rg.next)return!1;this.rg=this.rg.next;return!0}reset(){this.rg=this.qaa}}Object(h.a)(Sa,"ListEnumerator",null,[0]);class rb{constructor(M,ca,Na){this.next=Na;this.previous=ca;this.data=M}}Object(h.a)(rb,"ListNode",null,[]);class pc{constructor(){this.I2a=
this.oga=null;this.Mk=0}add(M){this.oga?this.I2a=this.I2a.next=new rb(M,this.I2a,null):this.oga=this.I2a=new rb(M,null,null);this.Mk=this.count+1}insert(M,ca){if(M>this.count||0>M)throw Error.argumentOutOfRange("pos");if(M===this.count)this.add(ca);else{for(var Na=this.oga;0!==M--;)Na=Na.next;M=new rb(ca,Na.previous,Na);M.previous?M.previous.next=M:this.oga=M;M.next?M.next.previous=M:this.I2a=M;this.Mk=this.count+1}}remove(M){let ca=this.oga;for(;ca&&ca.data!==M;)ca=ca.next;if(!ca)return!1;ca.previous?
ca.previous.next=ca.next:this.oga=ca.next;ca.next?ca.next.previous=ca.previous:this.I2a=ca.previous;this.Mk=this.count-1;return!0}clear(){let M=this.oga,ca;for(this.I2a=this.oga=null;M;)ca=M.next,M.previous=null,M.next=null,M=ca;this.Mk=0}indexOf(M){let ca=this.oga,Na=0;for(;ca&&ca.data!==M;)ca=ca.next,Na++;return ca?Na:-1}ga(M){return this.at(M).data}get count(){return this.Mk}getEnumerator(){return new Sa(this.oga)}[Symbol.iterator](){return Object(ue.a)(this.getEnumerator())}toArray(){const M=
Array(this.count);let ca=0;for(let Na of this)M[ca]=Na,ca++;return M}at(M){let ca=this.oga,Na=0;for(;Na!==M;){if(!ca)throw Error.argumentOutOfRange("pos");ca=ca.next;Na++}return ca}}Object(h.a)(pc,"List",null,[1]);class cd extends Sys.EventArgs{constructor(M){super();this.properties=M}}Object(h.a)(cd,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);class zd{constructor(){this.addinId=null;this.targetType=0;this.solutionId=null}}Object(h.a)(zd,"MiniAddinInfo",null,[]);class wd{constructor(M,
ca,Na){this.xp=new E.a;this.context=new Yf;this.iFd=this.kPe=this.C3a=this.u0=this.faa=null;this.contextActivationMgr=M;this.M8h=ca;this.D3a=Na;this.appName=A.AFrameworkApplication.fa.Ga("WebAppShortName")}get Fxh(){this.iFd||(this.iFd=new ta(this.xp));return this.iFd}I4h(M){this.xp.addHandler(O.a.fUb,M)}Y7h(M){this.xp.addHandler(O.a.HNe,M)}Rsl(M){null!==M&&(this.context.k0=M[O.a.bqa],this.context.Yw=M[O.a.S6],this.context.rmd=this.context.acd=0,M=O.a.oob in M?M[O.a.oob]:0,-1!==this.context.k0&&0!==
this.context.Yw&&(this.context.aqa=new pc,this.context.oCa=new pc,this.context.SFc=new pc,this.context.$Id=this.M8h.createAddinDataProvider(Ya(this.context.k0),this.contextActivationMgr),this.context.$Id?this.context.$Id.getEntitlementsAsync(this.contextActivationMgr.Zva,!0,M,ca=>{this.Nnk(ca)}):m.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.k0)))}Nnk(M){if(M&&0<M.length){this.context.rmd=M.length;const Na=A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")?
Ha():null;for(let zb=0;zb<M.length;zb++){const $b=M[zb];if(A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:6635045_FixAutoLaunchAddinFromDeeplink")&&bb()&&$b&&$b.storeType&&"omex"===$b.storeType.toLowerCase()&&$b.assetId&&Na&&$b.assetId.toLowerCase()===Na.toLowerCase()){var ca={["SDX_AppInstallOrigin"]:"DeeplinkUser",["SDX_Id"]:wd.ZV($b)};X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.sD(ca)}))}!$b||1!==$b.targetType&&-1!==$b.targetType?
this.r8c():(ca={},A.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.VSO6786086_RetireAddinCommandsCheckingContextProperties")?(ca.solutionId=$b.solutionId,ca.version=$b.version):(ca.marketplaceId=$b.solutionId,ca.marketplaceVersion=$b.version),ca.storeType=$b.storeType,ca.storeId=$b.storeId,ca.targetData=$b,wd.unc?this.contextActivationMgr.isAddinCommandsExAsync(ca,Object(D.a)(this,this.vnk,"onIsAddinCommandsExCompleted")):this.contextActivationMgr.isAddinCommandsAsync(ca,
(Tc,hd,Hd)=>{Tc?(hd&&this.context.aqa.add(Hd.targetData),10===this.context.k0&&(Tc=Hd.targetData,hd=Tc.targetType,Ea.b(Hd.targetTypeForExp)||(hd=Hd.targetTypeForExp,Tc.targetType=hd),this.context.oCa.add(Tc),0===hd&&this.context.SFc.add(Tc))):(Hd=Hd.targetData,m.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Hd.solutionId,Hd.storeType,Hd.assetId,null,null,Hd.storeId),Hd.storeType));this.r8c()}))}}else this.r8c()}r8c(){var M;
(M=this.context).acd=M.acd+1;this.context.acd>=this.context.rmd&&(this.D3a.mmh(this.context.k0,!1),0<this.context.rmd&&10===this.context.k0&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(M=!1,A.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&sa()&&(M=this.cYj()),this.tXj(),A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!M?wd.unc?this.Fxh.Tql(this.contextActivationMgr,
this.context.ZId,this.context.L4a,(ca,Na)=>{const zb=new e.a;for(let $b of ca)ca=$b.Hyh(),Na&&Na.solutionId===$b.solutionId&&(ca.showCallout=!0,this.Fxh.jEh(Na)),zb.add(ca);this.iIa(zb)}):this.GZi(this.context.aqa):this.VAc(this.context.aqa)):this.VAc(this.context.aqa))}VAc(M){if(wd.unc)this.iIa(this.wsi(this.context.ZId));else{var ca=new e.a;if(M)for(let Na of this.context.aqa)ca.add(Xd(Na));this.context.aqa&&1>this.context.aqa.count&&T.a.kKb(O.a.gUb,"false",this.context.k0);M={["ack2"]:ca};M[O.a.bqa]=
this.context.k0;M[O.a.S6]=this.context.Yw;this.xp.raiseEvent(O.a.fUb,new cd(M),this)}}wsi(M){const ca=new e.a;if(M)for(let Na of M)ca.add(Na.Hyh());return ca}iIa(M){M&&M.count||T.a.kKb(O.a.gUb,"false",this.context.k0);M={["ack2"]:M};M[O.a.bqa]=this.context.k0;M[O.a.S6]=this.context.Yw;this.xp.raiseEvent(O.a.fUb,new cd(M),this)}dYa(M){if(this.appName){const ca={},Na={};Na.LastTeachingUIShowTime=(new Date).toUTCString();Na.AddinHasShown=M;ca[this.appName]=ia.c(Na);this.faa&&(this.faa.Xrb(ca),m.ULS.sendTraceTag(539530527,
306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else m.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")}GZi(M){(this.C3a=M)?(M=new e.a,M.add(this.appName),this.faa=new pa(this.appName,Object(D.a)(this,this.PCa,"getRequestSuccessCallback"),Object(D.a)(this,this.Tia,"getRequestFailureCallback"),Object(D.a)(this,this.i$,"postRequestFailureCallback")),this.faa.YJc(M)):(M={["ack2"]:new e.a},M[O.a.bqa]=
this.context.k0,M[O.a.S6]=this.context.Yw,this.xp.raiseEvent(O.a.fUb,new cd(M),this))}PCa(M){M?this.uNe(M)?(m.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.u0="AddinHasShown"in M&&M.AddinHasShown?M.AddinHasShown.toString():null,this.RWb()):(m.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.VAc(this.C3a)):(m.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.u0=null,this.RWb())}Tia(M){m.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",
M?M.Le:-1);this.VAc(this.C3a)}i$(M){m.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",M?M.Le:-1)}RWb(){const M=this.ATd();0===M.targetType?(M.solutionId?(this.kPe=M.solutionId,this.aDe()):this.DEa("NoSolutionId"),M.addinId&&(window.g_roamingAddinList=this.u0?this.u0+","+M.addinId:M.addinId),this.ADf(null)):this.ADf(M.addinId);m.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",M.addinId)}aDe(){const M=new Da.a;M.callbackFunc=ca=>
{if(ca.errorCode){this.DEa("FailToGetAppDetails");var Na=window.g_roamingAddinList;Na&&this.dYa(Na)}else if(ca.value)for(Na of ca.value)if(ca=Na[1],ca===this.kPe){const zb={};zb.solutionId=ca;zb.assetId=Na[5];zb.storeType=Na[12];zb.storeId=Na[11];zb.assetStoreId=Na[6];zb.targetType=Na[3];zb.width=Na[7];zb.height=Na[8];zb.displayName=Na[0];zb.version=Na[4];Na=new ma(zb);this.xp.raiseEvent(O.a.HNe,Na);break}};M.storeType=OSF.StoreTypeEnum.PrivateCatalog;M.fromInsertDialog=!1;M.refresh=!1;this.contextActivationMgr.queryEntitlementDetails(M)}uNe(M){if("LastTeachingUIShowTime"in
M){if(M=+new Date-+new Date(M.LastTeachingUIShowTime.toString()),M<A.AFrameworkApplication.fa.QP("AddinShowTeachingUIIntervalInMS",864E5))return m.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",M),!1}else m.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0}ATd(){let M=new Ka.a(new zd,0),ca=new Ka.a(new zd,0),Na=0,zb=0,$b=0;var Tc=new pc;if(0<this.context.aqa.count)for(var hd of this.context.aqa)Tc.add(hd);if(0<this.context.SFc.count)for(let Hd of this.context.SFc)Tc.add(Hd);
for(let Hd of Tc)if(!("excatalog"!==Hd.storeType||Ea.b(Hd.installTimeInMS)||!Hd.installTimeInMS||Hd.installTimeInMS<=A.AFrameworkApplication.fa.QP("DateTimeInMSForNewAddin",16409952E5))){Tc=wd.f0b(Hd);if(this.u0&&(hd=this.u0.split(","),0<hd.length&&Array.contains(hd,Tc))){$b++;m.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}Tc.startsWith("private_")?(M.value<Hd.installTimeInMS&&(M=new Ka.a(Object.assign(new zd,{addinId:Tc,targetType:Hd.targetType,solutionId:Hd.solutionId}),
Hd.installTimeInMS)),zb++):(ca.value<Hd.installTimeInMS&&(ca=new Ka.a(Object.assign(new zd,{addinId:Tc,targetType:Hd.targetType,solutionId:Hd.solutionId}),Hd.installTimeInMS)),Na++)}m.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",zb,Na,$b);return 0<ca.value?ca.key:0<M.value?M.key:Object.assign(new zd,{addinId:null,targetType:-1,solutionId:null})}ADf(M){const ca=new e.a;for(let Na of this.C3a){const zb=Xd(Na);if(M){const $b=
wd.f0b(Na);M===$b&&(zb.showCallout=!0,window.g_roamingAddinList=this.u0?this.u0+","+M:M)}ca.add(zb)}this.C3a&&1>this.C3a.count&&T.a.kKb(O.a.gUb,"false",this.context.k0);M={["ack2"]:ca};M[O.a.bqa]=this.context.k0;M[O.a.S6]=this.context.Yw;this.xp.raiseEvent(O.a.fUb,new cd(M),this)}cYj(){if(wd.unc)return this.dYj(this.context.$Yd);var M=!1;if(this.context.oCa&&1>this.context.oCa.count)return M;const ca=Ha();if(!ca)return M;for(let Na of this.context.oCa)if(Na.storeId&&Na.storeId.toLowerCase()===ca.toLowerCase()||
Na.assetId&&Na.assetId.toLowerCase()===ca.toLowerCase())M={["SDX_Id"]:wd.ZV(Na),["SDX_TargetType"]:Ea.b(Na.targetType)?"":Na.targetType.toString()},X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:K.a.sD(M)})),M=!0;return M}tXj(){if(wd.unc)this.uXj(this.context.$Yd);else if(!(this.context.oCa&&1>this.context.oCa.count))if(this.D3a.Rwg()){var M=this.D3a.veg();M?(M=this.F$f(this.context.oCa,M),m.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):
(M=this.F$f(this.context.oCa,null),m.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.D3a.Unh(M)}else m.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}F$f(M,ca){const Na={};let zb=!1;for(let $b of M)if(M=wd.ZV($b))!ca||M in ca||(this.xTa($b,M),m.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===M.toLowerCase()?zb||(zb=!0,Na[M]=null):Na[M]=null;return Na}xTa(M,ca){var Na=M.installTimeInMS?(new Date(M.installTimeInMS)).toISOString():
"";Na={["SDX.Id"]:ca,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ea.b(M.targetType)?"":M.targetType.toString(),["SDX.AdminDeploymentTime"]:Na};X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.sD(Na)}));1===M.targetType&&(M={["SDX.Id"]:ca,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:K.a.sD(M)})))}dYj(M){let ca=
!1;if(M&&1>M.count)return ca;const Na=Ha();if(!Na)return ca;for(let zb of M)if(zb.storeId&&zb.storeId.toLowerCase()===Na.toLowerCase()||zb.assetId&&zb.assetId.toLowerCase()===Na.toLowerCase())M={["SDX_Id"]:wd.xeg(zb),["SDX_TargetType"]:Ea.b(zb.targetType)?"":zb.targetType.toString()},X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:K.a.sD(M)})),ca=!0;return ca}uXj(M){if(!(M&&1>M.count))if(this.D3a.Rwg()){var ca=this.D3a.veg();ca?(M=this.G$f(M,
ca),m.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(M=this.G$f(M,null),m.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.D3a.Unh(M)}else m.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")}G$f(M,ca){const Na={};let zb=!1;for(let $b of M)if(M=wd.xeg($b))!ca||M in ca||(this.j_j($b,M),m.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===M.toLowerCase()?zb||(zb=!0,Na[M]=null):Na[M]=null;return Na}j_j(M,ca){var Na=
M.installTimeInMS?(new Date(M.installTimeInMS)).toISOString():"";Na={["SDX.Id"]:ca,["SDX.AppInstallOrigin"]:"Organization",["SDX.TargetType"]:Ea.b(M.targetType)?"":M.targetType.toString(),["SDX.AdminDeploymentTime"]:Na};X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:K.a.sD(Na)}));1===M.targetType&&(M={["SDX.Id"]:ca,["SDX.AppInstallOrigin"]:"Organization",["SDX.CommandPlacement"]:"Ribbon"},X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppPinning",
dataFields:K.a.sD(M)})))}vnk(M,ca,Na,zb){M?(-1===zb.targetType&&(zb.targetType=Na.targetTypeForExp),M=new fg(Na.targetData,zb),ca&&this.context.ZId.add(M),10===this.context.k0&&(this.context.$Yd.add(M),0===M.targetType&&this.context.L4a.add(M))):(ca=Na.targetData,m.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,ca.storeType,ca.assetId,null,null,ca.storeId),ca.storeType));this.r8c()}DEa(M){M={["AppTeachingUICalloutAction"]:M,
["SDX.Id"]:this.kPe,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.sD(M)}))}static get unc(){return A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingCalloutRefactorEnabled",!1)}static ZV(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}static xeg(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,
M.storeType,M.assetId,null,null,M.storeId)}static f0b(M){return Telemetry.PrivacyRules.IsPrivateAddin(M.storeType,M.assetId,null,null,M.storeId)?"private_"+M.installTimeInMS:M.solutionId}}Object(h.a)(wd,"AddInCommandsListLoader",null,[]);var Oa=d(1097),jb=d(177),qc=d(1199),ib=d(27),Cb=d(58);class yc{constructor(M,ca,Na){this.n$a=this.IEa=this.xda=this.ncb=null;this.Dqe=this.G3c=-1;this.QG=null;this.lQg=!1;this.HEg=M;this.fc=ca;this.KEg=this.fc.Cc("AddinMaxTabSwitchDetectionTimesForTeachingUI",3);
this.t0j=this.fc.Cc("AddinMaxDOMElementDetectionTimesForTeachingUI",10);this.pYc=this.fc.Ga("WebAppShortName");this.Lc=Na;ja.a.Va(this.pYc)&&(this.pYc="PowerPoint")}ZV(M){return Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)}BOk(M){this.QG=M;this.Lc.z3a(Object(D.a)(this,this.m0g,"onInsertTabSwitched_ContentAddin"));window.addEventListener("LaunchContentAddin",Object(D.a)(this,this.Irk,"onTryItButtonClicked_ContentAddin"),!0);window.addEventListener("DismissCallout",
Object(D.a)(this,this.Elk,"onDismissButtonClicked_ContentAddin"),!0);window.addEventListener("CloseCallout",Object(D.a)(this,this.Dkk,"onCloseButtonClicked_ContentAddin"),!0)}Fnk(){this.xda&&this.n$a&&(this.HEg.y2b({["SourceControlId"]:this.n$a}),m.ULS.sendTraceTag(512499854,220,50,"Launch addin command has been triggered"))}$cl(M,ca){ca?(this.xda=ca.tu,(this.ncb=ca.tJ)&&this.ncb.f$&&this.ncb.f$.ZE&&(this.IEa=this.ncb.f$.ZE.ga(0)),this.IEa?this.IEa.isOfficeTab?(M=this.xda.solutionId,ca=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),
M in ca?this.n$a=ca[M]:(m.ULS.sendTraceTag(512499852,220,15,"OnLaunchAddinButtonClicked failed to get button id from controlIdMap for add-in: {0}",this.ZV(this.xda)),this.n$a=this.DZi(this.ncb)),this.n$a?0<this.IEa.id.indexOf(Cb.a.bch)?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Ca.Ksb(this.ncb),()=>{this.Ysh(this.GOc(this.n$a))}):this.Lc.z3a(Object(D.a)(this,this.Z2g,"onTabSwitched")):(this.yTa("NoEnabledButtonFound",this.xda),m.ULS.sendTraceTag(512499851,220,10,"OnLaunchAddinButtonClicked failed to get button id for addin"),
this.eHa())):this.$sh(this.GOc(this.IEa.id),0):(this.yTa("NoTabFound",this.xda),m.ULS.sendTraceTag(512499853,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),this.eHa())):this.eHa()}Z2g(M,ca){!this.IEa||void 0===this.IEa.id||null===this.IEa.id||0>ja.a.wg(this.IEa.id).indexOf(ja.a.wg(ca.V9))||(this.Lc.TFb(Object(D.a)(this,this.Z2g,"onTabSwitched")),this.fOd(ca.pYg,ca.V9,this.KEg,!1))}m0g(M,ca){"Insert"===ca.V9&&(this.Lc.TFb(Object(D.a)(this,this.m0g,"onInsertTabSwitched_ContentAddin")),
this.fOd(ca.pYg,ca.V9,this.KEg,!0))}fOd(M,ca,Na,zb){if(0>Na)this.yTa("TabSwitchTimeOut",this.xda);else{var $b=document.querySelector("button"+this.GOc(ca));$b.hasAttribute("aria-selected")&&"false"!==$b.getAttribute("aria-selected")?(0<this.Dqe&&window.clearTimeout(this.Dqe),zb?this.wfl():this.Ysh(this.GOc(this.n$a))):this.Dqe=window.setTimeout(()=>{this.fOd(M,ca,Na-1,zb)},1E3)}}GOc(M){return"[id="+M+"]"}wfl(){let M=document.querySelector("button[data-unique-id = 'Ribbon-InsertAddIns']");var ca=M?
window.getComputedStyle(M,null):null;if(!M||ca&&"none"===ca.display)if(M=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']"))m.ULS.sendTraceTag(512499849,220,15,"Callout show on Overflow button");else{this.Hxb("NoAnchor",this.QG);m.ULS.sendTraceTag(512499850,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}else m.ULS.sendTraceTag(512499848,220,15,"Callout show on OfficeAddin Button");(ca=Ub.a.instance.Ka("Common.ISystemInitiatedFeedback"))&&
M?(ca.execute(Na=>{Na.logActivity("ShowTeachingUIForContentAddin",null)}),this.Hxb("Show",this.QG),m.ULS.sendTraceTag(512499846,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity")):(this.Hxb("NoSifFutureObject",this.QG),m.ULS.sendTraceTag(512499847,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture"))}Irk(){this.Hxb("ClickOnLaunch",this.QG);this.eHa();const M={};M.solutionId=this.QG.solutionId;M.assetId=this.QG.assetId;M.assetStoreId=this.QG.assetStoreId;M.height=
this.QG.height?this.QG.height:600;M.storeId=this.QG.storeId;M.targetType=this.QG.targetType;M.width=this.QG.width?this.QG.width:600;M.displayName=this.QG.displayName;M.version=this.QG.version;M.storeType=this.QG.storeType;M.isAddinCommands=!1;this.HEg.re.sxb("0",3,M)}Dkk(){this.Hxb("ClickOnClose",this.QG);this.eHa()}Elk(){this.Hxb("ClickOnDismiss",this.QG);this.eHa()}$sh(M,ca){if(ca>this.t0j)window.clearTimeout(this.G3c),this.Zsh("[data-unique-id='pivotOverflowButton']"),m.ULS.sendTraceTag(512499845,
220,50,"ShowTeachingCalloutWithPoll did not find the Addin Tab in time");else{var Na=document.querySelector("button"+M);!Na||Na.hasAttribute("tabIndex")&&"-1"===Na.getAttribute("tabIndex")?this.G3c=window.setTimeout(()=>{this.$sh(M,ca+1)},1E3):(0<this.G3c&&window.clearTimeout(this.G3c),this.Zsh(M))}}Ysh(M){let ca=document.querySelector("button[data-unique-id='RightPaddle']");if(ca)this.yTa("RightPaddlePresent",this.xda);else if(M=(ca=document.querySelector("button"+M))?window.getComputedStyle(ca,
null):null,!ca||M&&"none"===M.display)if(ca=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ca){this.yTa("NoAnchor",this.xda);m.ULS.sendTraceTag(512499844,220,15,"ShowTeachingCalloutToAddinButton failed to get an anchorElement");this.eHa();return}this.Izh(ca,"ShowTeachingUIForAddinButton")}Zsh(M){let ca=document.querySelector("button"+M);if(!ca&&("[data-unique-id='pivotOverflowButton']"!==M&&(ca=document.querySelector("button[data-unique-id='pivotOverflowButton']")),!ca)){this.yTa("NoAnchor",
this.xda);m.ULS.sendTraceTag(512499843,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");this.eHa();return}this.Izh(ca,"ShowTeachingUIForAddinTab")}Izh(M,ca){M.setAttribute("lpp-id","latestAddin");const Na=Ub.a.instance.Ka("Common.ISystemInitiatedFeedback");Na&&M?(this.yTa("Show",this.xda),Na.execute(zb=>{zb.logActivity(ca,null)}),m.ULS.sendTraceTag(512499841,220,50,"TriggerLPPActivity triggered an LPP activity")):(this.yTa("NoSifFutureObject",this.xda),m.ULS.sendTraceTag(512499842,
220,15,"TriggerLPPActivity failed to get a sifFuture"),this.eHa())}DZi(M){if(!M||!M.f$||!M.f$.ZE)return null;for(let ca of M.f$.ZE)if(ca)for(const Na of ca.groups)if(Na)for(const zb of Na.controls){if(zb&&zb.attributes&&0===zb.controlType&&zb.enabled)return zb.id;if(zb.menuItems)for(const $b of zb.menuItems)if($b.attributes&&$b.enabled)return zb.id}return null}yTa(M,ca){yc.xTa(M,this.ZV(ca))}Hxb(M,ca){ca=Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,ca.storeType,ca.assetId,null,null,
ca.storeId);yc.xTa(M,ca)}dYa(M){const ca={};ca[this.pYc]=ia.c({["LastTeachingUIShowTime"]:(new Date).toUTCString(),["AddinHasShown"]:M});(new pa(this.pYc,null,null,Object(D.a)(this,this.i$,"postRequestFailureCallback"))).Xrb(ca);m.ULS.sendTraceTag(512499840,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service")}i$(M){m.ULS.sendTraceTag(512499811,306,15,"failed to POST data to Roaming Settings Service with status: {0}",M?M.Le:-1)}eHa(){if(this.fc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIRoamingFix",
!1)&&!this.lQg){const M=window.g_roamingAddinList;M&&(this.dYa(M),this.lQg=!0)}}static xTa(M,ca){M={["AppTeachingUICalloutAction"]:M,["SDX.Id"]:ca,["AppTeachingUICalloutGoal"]:"NewAdminDeployment",["SDX.AppInstallOrigin"]:"Organization"};X.a.sendTelemetryEvent(Object.assign(new Z.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:K.a.sD(M)}))}}Object(h.a)(yc,"AddinTeachingCalloutHandler",null,[]);class gd{}Object(h.a)(gd,"AddinCommandsHost",null,[]);var od=d(82),Mc=d(133);class Rd extends od.a{constructor(){super(void 0,
void 0,void 0,!0);this.XMb="AddinCommandsUILessDialog";this.IFd="WACDialogTitleText";this.nkb="0";this.k0a=380;this.$Mb=190;this.ng=this.XMb;this.yd=5;this.xLh=String.format("{0}px",this.k0a);this.mkb=String.format("{0}px",this.$Mb);this.O5d=this.qr=!1;this.px()}px(){super.px();this.sz.style.width=this.xLh;this.sz.style.height=this.mkb;this.sz.style.padding=this.nkb}$wa(M){this.QF();document.getElementById(this.ji(this.IFd)).innerText=M}QF(){super.QF();this.rc.style.width=String.format("{0}px",this.k0a);
this.rc.style.height=String.format("{0}px",this.$Mb);this.rc.removeAttribute(Mc.a.Ye);this.rc.removeAttribute(Mc.a.W1)}hide(){this.D6d()}get r5a(){return this.sz}initializeAndShowWithTitle(){this.tj(CommonUIStrings.l_NotificationUITitle,null,null)}}Object(h.a)(Rd,"AddinCommandsUILessDialog",od.a,[900]);var ye=d(40),oe=d(165),Bb=d(37),Ff=d(326);class pg extends gd{constructor(M,ca,Na,zb){super();this.NE=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.jb&&A.AFrameworkApplication.Aa.jb.tW;
this.i9=M;this.Zd=ca;this.F4j=Na;this.Zcb=zb}setOwnerAddinEToken(M){this.i9.eToken=M}showTaskpane(M,ca,Na){m.ULS.sendTraceTag(509699670,220,50,String.format("ShowTaskpane action called."));this.cpg(M,ca,Na,!0)||m.ULS.sendTraceTag(509699669,806,10,String.format("ShowTaskpane : instance id is null."))}showDialog(){}createUILessSandbox(M,ca,Na){m.ULS.sendTraceTag(509699668,220,50,String.format("UILess action called."));this.cpg(M,ca,Na,!1,this.F4j)||m.ULS.sendTraceTag(509699667,806,10,String.format("UILess : instance id is null."))}disposeHost(){}cpg(M,
ca,Na,zb,$b=!1){var Tc=this.Zd.DZ(M.solutionId);Tc||(Tc=this.Zd.jUi(M,ca,this.i9.solutionId,$b));if(Tc&&this.Zd.Ssa(Tc.instanceId))return this.Zd.Hfb(Tc.instanceId),Na(Tc.instanceId,0),$b||this.Zd.$Gb(Tc.instanceId,zb),!0;let hd=null;if(!Tc)if(Tc=this.Zd.Lfi(M,ca,zb,this.i9.solutionId,$b),Tc.setValue(Bb.a.ownerAddinStoreType,this.i9.storeType),hd=Tc.sa(oe.a.sharedRuntimeId,null),this.MDg(!!hd,!0),$b&&($b=$b&&!hd),ca=$b?new Rd:null,$b?this.Zd.rhb(Tc,ca.r5a):(Tc.setValue(ye.a.xUb,zb||!!hd),this.Zd.$fh(Tc)),
Tc=this.Zd.DZ(M.solutionId))if($b&&this.Zcb.$(Tc.instanceId,ca),M=this.Zd.hCa(this.i9.solutionId)){if(M=new Ff.a(M),this.Zd.HCh(M.id,Tc.instanceId),hd&&!this.Zd.w_b(M.vwa)&&(M=this.Zd.CZd(M.vwa)))M.Rv||M.E0h(hd),this.Zd.dBc(this.i9.solutionId,M)}else{M=this.Zd.Kfi(this.i9,hd);if(!M)return Na(null,5001),!1;this.Zd.dBc(this.i9.solutionId,M);this.nXj(!!hd)}else return Na(null,5001),!1;Na(Tc.instanceId,0);this.NE&&(Na=this.Zd.Ssa(Tc.instanceId),this.Zd.$Gb(Tc.instanceId,Na?zb:!0));this.MDg(!!hd,!1);return!0}MDg(M,
ca){M&&window.performance&&window.performance.memory&&m.ULS.sendTraceTag(509699666,802,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",ca,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)}nXj(M){m.ULS.sendTraceTag(509699665,802,50,"PPT WAC add-in created: SolutionId: {0}, StoreType: {1}, IsShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(this.i9.solutionId,
this.i9.storeType,this.i9.assetId,null,null,this.i9.storeId),this.i9.storeType,M)}}Object(h.a)(pg,"WACPowerPointAddInCommandsHost",gd,[]);var xf=d(186);class qe{constructor(M,ca,Na,zb,$b,Tc,hd,Hd,le,ge,Zd){this.QG=this.mSg=null;if(!M)throw Error.argumentNull("app");this.wta=new Q;this.vGg=Na;this.Ob=M.kr;this.Ee=hd;this.Zd=ca;this.cka=Tc;this.Zd.y6h(Object(D.a)(this,this.rpi,"clearLoadingAddinMessage"));this.wta.K4h(Object(D.a)(this,this.Hlj,"handleAddinCommandsLoadingMessageChanged"));this.Ha=zb;
this.fc=$b;Oa.a.p3b=Oa.a.Q7g;this.Zcb=new yb.a;this.Myb=le;this.yl=ge;this.U1j=new e.a;this.yyb=new e.a;this.Lc=Zd}get re(){return this.Zd}$Wc(M){m.ULS.sendTraceTag(512499869,220,50,"LaunchOperationType {0}.",M[O.a.S6]);if(this.Ha.LUc||!this.Ha.jqa){var ca=M[O.a.MBc];if(ca&&0<ca.count){const zb=ca.count;for(let $b=zb-1;0<=$b;$b--){const Tc=ca.ga($b);OSF.OsfControl.isFirstPartyStoreString(Tc.storeType)||ca.remove(ca.ga($b))}ca.count<zb&&(this.Ha.LUc&&!this.yl.Dca(22)&&this.yl.IBa(22),this.Ha.jqa||
this.yl.Dca(36)||this.yl.IBa(36));if(!ca.count)return}}let Na=null;Na=A.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled")?new Wb(this.cka,this.vGg,new fd(this.Zd.En),new Pc("",md.a.t3a),this.wta,dd.instance,new kd,(zb,$b)=>{const Tc={};Tc.solutionId=zb.solutionId;Tc.version=zb.version;Tc.storeType=zb.storeType;Tc.storeId=zb.storeId;Tc.assetId=zb.assetId;Tc.assetStoreId=zb.assetStoreId;this.Zd.Dfl(Tc,()=>{$b(zb)})}):new Wb(this.cka,this.vGg,new fd(this.Zd.En),new Pc("",md.a.t3a),this.wta,dd.instance,
new kd);Na.W4h(Object(D.a)(this,this.Vjk,"onAutoLaunchAddin"));Na.J4h(Object(D.a)(this,this.Gnk,"onLaunchAddinCommandsCompleted"));this.fc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&(ca=new yc(this,this.fc,this.Lc),Na.F5h(Object(D.a)(ca,ca.Fnk,"onLaunchAddinButtonClicked")),Na.W7h(Object(D.a)(ca,ca.$cl,"showCalloutOnAddin")));try{jb.a.get_instance().gk(5,null).continueWith(()=>{Na.oUj(this.Myb,ib.App.Hb.hF(),M)},11)}catch(zb){m.ULS.sendTraceTag(512499868,
220,10,String.format("LaunchAddinCommands error message : {0}.",zb.message))}}Flj(M){M=M[this.cka.JOa];M=(new ce).cHd(M);return A.AFrameworkApplication.jqa||OSF.OsfControl.isFirstPartyStoreString(M.ownerAddinInfo.storeType)}y2b(M){const ca=new ce;this.X4d(ca,M[this.cka.JOa])}X4d(M,ca){const Na=M.cHd(ca),zb=new pg(Na.ownerAddinInfo,this.Zd,this.Ha.uja,this.Zcb);M.y2b(ca,this.wta,zb,new fd(this.Zd.En),Na)}j$g(M){const ca=ad.eFk(this.wta);M[qc.a.LabelText]=ca.labelText;M[qc.a.Visible]=ca.visible}Lcl(){this.lOe()}mIb(M){M&&
O.a.bJd in M&&M[O.a.bJd]&&hc.FNe(M[O.a.bJd].toString())}SLk(){if(this.wta.uee()){this.wta.rPf();const M=this.HZd();if(M&&0<M.count)for(let ca of M)this.mGb({["ack1"]:ca,["ack0"]:4,["ak0"]:(new Date).getTime()})}}Hlj(){this.Ee.mz(new xf.a(2));this.lOe()}mGb(M){m.ULS.sendTraceTag(512499867,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",M[O.a.S6],M[O.a.bqa]);this.wta.N2k();window.setTimeout(()=>{const ca=new wd(new fd(this.Zd.En),dd.instance,Db.instance);
ca.I4h((Na,zb)=>{this.$Wc(zb.properties)});ca.Y7h((Na,zb)=>{this.QG=zb;this.mSg=new yc(this,this.fc,this.Lc);this.mSg.BOk(this.QG)});ca.Rsl(M)},0)}rpi(){this.wta.rPf()}ddi(M){var ca=this.Zd.DZ(M);if(ca&&ca.Rv&&ca.Rv.Nwa&&!(0>=ca.Rv.state)){var Na=new ce,zb=Na.getTaskPaneControlIdFromSolutionIdRuntimeId(M,ca.Rv.Nwa);zb&&(this.Zd.dBc(M,ca),this.X4d(Na,zb),this.Zd.yQf(M),(ca=this.Zd.DZ(M+zb))?this.Zd.setInitialDisplayMode(ca.instanceId,1):m.ULS.sendTraceTag(512499866,802,10,"Failed to find auto-loaded shared runtime pane for "+
M))}}hdi(M){if(M&&M.solutionId){var ca=new ce,Na=ca.idi;if(Na=M.solutionId in Na?Na[M.solutionId]:null){let zb=this.Zd.DZ(M.solutionId);if(!zb){zb=this.Zd.CZd(M.solutionId);if(!zb){m.ULS.sendTraceTag(512499864,220,15,String.format("AutoShowTaskPane appForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)));return}this.Zd.dBc(M.solutionId,zb)}M=zb.settings;(M=O.a.LFf in M?M[O.a.LFf]:null)&&"true"===M.toLowerCase()&&this.X4d(ca,
Na)}}else m.ULS.sendTraceTag(512499865,220,10,"LaunchAddInCommands AutoShowTaskPane failed. Invalid solution id.")}Q$k(M){if(void 0===M||null===M||void 0===M[this.cka.JOa]||null===M[this.cka.JOa])return!1;M=M[this.cka.JOa];return ja.a.Va(M)?!1:this.yyb.contains(M)}N6k(M){M=M.f$;if(!M)m.ULS.sendTraceTag(512499863,220,15,"Ribbon Extensibility for React ribbons should not be null.");else if(M.ZE)for(let ca of M.ZE)if(ca.groups)for(const Na of ca.groups)if(Na.controls)for(const zb of Na.controls)if(this.TQe(zb.id,
zb.enabled),1===zb.controlType&&zb.menuItems)for(const $b of zb.menuItems)this.TQe($b.id,$b.enabled)}TQe(M,ca){if(M&&M.length){var Na=this.yyb.contains(M);Na&&ca&&this.yyb.remove(M);Na||ca||this.yyb.add(M)}}Uvl(M){let ca=null,Na=null,zb=!0;void 0!==M[O.a.OUd]&&null!==M[O.a.OUd]&&void 0!==M[this.cka.JOa]&&null!==M[this.cka.JOa]&&void 0!==M[O.a.MUd]&&null!==M[O.a.MUd]&&(ca=M[O.a.OUd],Na=M[this.cka.JOa],zb=M[O.a.MUd]);ja.a.Va(ca)||ja.a.Va(Na)||(M=(new ud("",ca,this.cka,!0)).zCa(Na),this.TQe(M,zb),this.Ob.updateCommandUI())}ZZb(M){if(void 0!==
M&&null!==M&&void 0!==M[O.a.NUd]&&null!==M[O.a.NUd])switch(M[O.a.NUd]){case 1:this.Uvl(M);break;case 4:this.yyb.clear(),this.yyb.addRange(this.U1j)}}Vjk(M,ca){if(ca)if(ca)if(M=ca.tu,ca=ca.tJ,this.fc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CheckIsDeepLinkTemplateFile",!1)&&(bb()||sa())&&!this.Zd.CZd(M.solutionId))m.ULS.sendTraceTag(512259016,220,15,String.format("AppForOffice is null for {0}",Telemetry.PrivacyRules.GetPrivacyCompliantId(M.solutionId,M.storeType,M.assetId,null,null,M.storeId)));
else{var Na=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();(ca=M.solutionId in Na?Na[M.solutionId]:this.n2i(ca))?(this.y2b({["SourceControlId"]:ca}),M.isAutoLaunched=!0):m.ULS.sendTraceTag(512499860,220,15,"addinCommandControlId is null")}else m.ULS.sendTraceTag(512499861,220,15,"agaveParams is null");else m.ULS.sendTraceTag(512499862,220,15,"No args for OnAutoLaunchAddin event")}n2i(M){if(!M)return m.ULS.sendTraceTag(512499859,220,10,"Failed to get button id for addin"),
null;M=M.f$;if(!M||!M.ZE||!M.ZE.count)return m.ULS.sendTraceTag(512499858,220,15,"It has 0 or multiple tabs"),null;M=M.ZE.ga(0);if(!M.groups||1!==M.groups.length)return m.ULS.sendTraceTag(512499857,220,15,"It has 0 or multiple groups"),null;M=M.groups[0];if(!M.controls||1!==M.controls.length)return m.ULS.sendTraceTag(512499856,220,15,"It has 0 or multiple buttons"),null;M=M.controls[0];return M.attributes&&0===M.controlType&&M.enabled?M.id:null}Gnk(M,ca){let Na=null;ca&&(Na=ca);Na&&Na.tJ&&this.N6k(Na.tJ);
Na?(Na.tu&&this.ddi(Na.tu.solutionId),this.Ha.RDj&&window.setTimeout(()=>{Na.tu&&this.hdi(Na.tu)},0)):m.ULS.sendTraceTag(512499855,220,10,String.format("OnLaunchAddinCommandsCompleted EventArgs is null."))}HZd(){const M=new e.a;this.Ha.Hsa&&(this.Ha.otg&&M.add(0),this.fc.ka("187")&&M.add(1),this.fc.ka("305")&&M.add(10),M.add(8));return M}lOe(){const M=document.querySelector("[data-unique-id='ShowAddInCommandsLoadStatusCallout']");ad.Hsh(this.wta,this.Ob.hF(),M,ResourceStrings.L_Insert,CommonUIStrings.L_ButtonOfficeAddins)}lmc(M){M&&
this.Zcb.Jb(M)&&this.Zcb.ga(M).initializeAndShowWithTitle()}l3b(M){M&&this.Zcb.Jb(M)&&this.Zcb.ga(M).hide()}}Object(h.a)(qe,"AddinCommandsManager",null,[858]);class Oh{constructor(){this.WRg={["tabhome"]:"PptRibbon.Home",["tabinsert"]:"PptRibbon.InsertTab",["tabdesign"]:"PptRibbon.Design",["tabtransitions"]:"PptRibbon.Transition",["tabanimations"]:"PptRibbon.Animation",["tabview"]:"PptRibbon.View"};this.uNg={["tabslideshow"]:["PptRibbon.SlideShow",ResourceStrings.l_SlideShowTab,CommonUIStrings.l_SlideShowTabKeytip],
["tabreview"]:["PptRibbon.Review",ResourceStrings.L_ReviewTab,CommonUIStrings.l_ReviewTabKeytip],["tabdeveloper"]:["PptRibbon.Developer",ResourceStrings.l_DeveloperTab,CommonUIStrings.l_DeveloperTabKeytip],["tabaddins"]:["PptRibbon.AddIns",ResourceStrings.l_AddInsTab,CommonUIStrings.l_AddInsTabKeytip]};this.n2c=null}get JOa(){return"SourceControlId"}get HS(){return"Presentation"}get formFactor(){return"DesktopFormFactor"}y9i(){if(!this.n2c){this.n2c={};for(const M of Object.keys(this.WRg))this.n2c[M]=
this.WRg[M];for(const M of Object.keys(this.uNg))this.n2c[M]=this.uNg[M][0]}}}Object(h.a)(Oh,"AddinCommandsStringProvider",null,[857]);class Cf{constructor(M){this.Uvi=M}oYi(){return this.Uvi.Zfi()}}Object(h.a)(Cf,"ContextMenuExtensibilityHandler",null,[856]);var Bg=d(78),Gf=d(38);class dh{constructor(M,ca,Na,zb){this.boe=null;this.Zd=M;this.jSg=ca;this.ra=Na;this.Ig=zb}get P6b(){return this.boe}set P6b(M){this.boe=M}register(){this.ra.VH(Object(D.a)(this,this.Sgd,"selectionChangeEventHandler"));
Gf.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Ig.job(Object(D.a)(this,this.Sgd,"selectionChangeEventHandler"))}dispose(){this.ra.Ewa(Object(D.a)(this,this.Sgd,"selectionChangeEventHandler"));Gf.a("ExtensibilitySlideSelectionChangedEventFix")&&this.Ig.Sed(Object(D.a)(this,this.Sgd,"selectionChangeEventHandler"))}Sgd(){try{this.P6b&&this.jSg.Ng(this.P6b),this.boe=new Bg.a(4,1,0,()=>{this.P6b=null;this.zql()},90,"50"),this.jSg.Cb(this.P6b)}catch(M){m.ULS.sendTraceTag(18442309,802,10,M.toString())}}zql(){try{this.Zd.Rah(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),
null);const ca=this.ra.rn();if(ca){var M=ca.jl();if(M)for(const Na of M)if(Na.Uq){const zb=new Ff.a(Na);this.Zd.wXa(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent.toString(),zb.id,null)}}}catch(ca){m.ULS.sendTraceTag(18442310,802,10,ca.toString())}}}Object(h.a)(dh,"AppForOfficeApiSelectionChangeEventListener",null,[848,106]);var qg=d(540),Pf=d(971),qd=d(708);class Tf{}Tf.generalException="generalException";Tf.invalidArgument="invalidArgument";Tf.notAllowed="notAllowed";Tf.apiNotAvailable=
"apiNotAvailable";Tf.unresolvedPendingRequest="unresolvedPendingRequest";Tf.timeout="timeout";Tf.adalTimeout="adalTimeout";Tf.userNotSignedIn="userNotSignedIn";Tf.userAborted="userAborted";Tf.silentSignInFailed="silentSignInFailed";Tf.invalidResourceUrl="invalidResourceUrl";Tf.invalidGrant="invalidGrant";Tf.connectionLost="connectionLost";Tf.clientError="clientError";Tf.serverError="serverError";Object(h.a)(Tf,"WopiHostErrorCodes",null,[]);var Pg=d(234);class Ee{}Object(h.a)(Ee,"OAuthCallerMetadata",
null,[]);var xe=d(54);class jh{constructor(M){this.wL=M;this.fNh=A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}b0h(M,ca,Na,zb,$b,Tc){if(!this.wL)return zb=new Pf.a,zb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(zb);const hd=new Ee;hd.AddinName=$b;hd.AddinTrustId=Tc;let Hd=-1;Tc=null;if(zb&&this.zwg())Tc=this.wL.wAh(O.a.Old,M,zb,jh.Aeg($b),hd);else{const le=Date.now();Tc=this.wL.KU(O.a.Old,M,hd).then(ge=>
{Hd=Date.now()-le;const Zd=(ca||Na)&&"login_required"===ge.ErrorCode;return(ca&&("interaction_required"===ge.ErrorCode||"consent_required"===ge.ErrorCode||"invalid_grant"===ge.ErrorCode)||Zd)&&this.zwg()?this.wL.wAh(O.a.Old,M,null,jh.Aeg($b),hd):Promise.resolve(ge)})}return Tc.then(le=>{const ge=new Pf.a;le.IsSuccess?(ge.token=le.Token,le.Telemetry&&(ge.zib=le.Telemetry.fromCache,ge.expiresOn=le.Telemetry.expiresOn)):(ge.errorCode=this.Rck(le),ge.wRe=this.dvk(le));return ge}).catch(()=>{const le=
new Pf.a;le.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(le)}).then(le=>{le.IAa="OauthManager";0<=Hd&&(le.c2b=Hd);return le})}QHj(M){const ca=(A.AFrameworkApplication.fa.Ga(A.AFrameworkApplication.FJ)||"").toLowerCase();return(xe.a.rEa||"teams"===ca&&Pg.OAuthManagerSettings.i8a)&&!jh.kHj(M)||!this.wL||!this.wL.KEj()?!1:!0}zwg(){return this.fNh||1!==qd.a.kMc()}Rck(M){switch(M.ErrorCode){case "UserCancelled":case "interaction_required":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;
break;case "consent_required":case "invalid_grant":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;break;case "invalid_resource":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":M=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;
default:M=M.ErrorCode===Tf.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:M.ErrorCode===Tf.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:M.ErrorCode===Tf.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:M.ErrorCode===Tf.invalidGrant?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:M.ErrorCode===Tf.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return M}dvk(M){let ca=
"";(M=RegExp("AADSTS(\\d+)").exec(M.ErrorMessage))&&1<M.length&&(ca=M[1]);return ca}static Aeg(M){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,M)}static kHj(M){if(!M)return!1;M=M.toLowerCase();for(const ca of qg.AppsForOfficeSingleSignOnManager.ZKc)if(ca===M)return!0;return!1}}Object(h.a)(jh,"AppsforOfficeTokenFromOauthManager",null,[964]);class yg{constructor(M){this.fbk=M}static RTe(){if(A.AFrameworkApplication.fa.ka("AppForOfficeSSOV2IsEnabled")){var M=
null;try{M=Ub.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ca){m.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+ca)}M=new jh(M);yg.Ja=new yg(M)}}static getInstance(){yg.O7e||(yg.RTe(),yg.O7e=!0);return yg.Ja}}yg.Ja=null;yg.O7e=!1;Object(h.a)(yg,"AppsForOfficeOauthManagerFactory",null,[929]);class xc{constructor(M){const ca=yg.getInstance();this.kxf=new qg.AppsForOfficeSingleSignOnManager(M,ca)}getAccessTokenAsync(M,ca){return new Promise(Na=>{const zb=A.AFrameworkApplication.fa.ka("342");
this.kxf.getAccessToken(M,zb,ca,($b,Tc)=>{const hd={};hd.errorCode=$b;hd.accessToken=Tc?Tc.accessToken:"";Na(hd)})})}removeCallbackForAddin(M){this.kxf.removeCallbackForAddin(M)}}Object(h.a)(xc,"AppForOfficeAuthProvider",null,[888]);class me{dyi(M){return new xc(M)}}Object(h.a)(me,"AppForOfficeAuthFactory",null,[834]);var Dd=d(227),Qe=d(61),tf=d(46),Rb=d(616);class Jc{constructor(M,ca,Na,zb,$b,Tc,hd){this.Ure=this.Tre=this.wpe=this.vpe=0;this.kOg=.5;this.Nzb=null;this.ple=0;this.I0j={};this.Qac=document.createElement("div");
this.Qac.className="OsfAddinOverlay";ca.appendChild(this.Qac);Na.G4k(this.Qac);this.gck=M;this.cJ=hd;this.cJ.rBc(Object(D.a)(this,this.NDb,"onZoomed"));this.ua=zb;this.Hc=$b;this.Eq=Tc;this.Eq.uV(Object(D.a)(this,this.xFe,"registerSlideViewElementEvents"))}dispose(){this.cJ.Ied(Object(D.a)(this,this.NDb,"onZoomed"));this.Eq.Tma(Object(D.a)(this,this.xFe,"registerSlideViewElementEvents"))}initialize(){if(this.ua.Ba){this.xFe(null,null);const M=this.Hc.Gc;M&&(this.vpe=parseFloat(M.$T.style.left),this.wpe=
parseFloat(M.$T.style.top),this.Tre=parseFloat(M.ie.xa.style.left),this.Ure=parseFloat(M.ie.xa.style.top))}this.uVe();this.NDb(null,new Rb.a(this.gck.zoom))}xFe(M,ca){(M=this.Hc.Gc)&&M!==this.Nzb&&(M.f8h(Object(D.a)(this,this.SDh,"updateOffsetFromSlideView")),M.g7h(Object(D.a)(this,this.RDh,"updateOffsetFromPageContentContainer")),this.Nzb&&(this.Nzb.XSk(Object(D.a)(this,this.SDh,"updateOffsetFromSlideView")),this.Nzb.uSk(Object(D.a)(this,this.RDh,"updateOffsetFromPageContentContainer")),this.RQe(this.Nzb,
!1)),ca&&ca.HVc&&1!==this.ple&&this.RQe(M,!0),this.Nzb=M)}RQe(M,ca){if(M&&(M=M.Ed)&&M.isConnected){var Na=M.jl();if(Na&&Na.length)for(const Tc of Na)if(Tc.Uq){Na=Tc.sa(Bb.a.dZ,null);var zb=M.getValue(Bb.a.sid),$b=M.getValue(Bb.a.cid);zb=Qe.a.tE(zb,$b).toString();$b=Tc.get_shapeId().toString();Na=Na+$b+zb;Gf.a("Microsoft.Office.SharedOnline.FixBug6808089")?(zb=Tc.sg(0),(null===zb||void 0===zb?0:zb.xa)?this.TIa(Na,ca,zb.xa.ee):this.TIa(Na,ca,null)):this.TIa(Na,ca,null)}}}w5(M){this.ple=M;const ca=this.Hc.Gc;
ca?(m.ULS.sendTraceTag(512369926,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: Hide the addin container on active slide('{0}#{1}').",ca.Ed.sid,ca.Ed.cid),this.RQe(ca,2===M)):m.ULS.sendTraceTag(512369925,806,50,"AppForOfficeContentAppsContainer.SwitchToMode: SlideViewElement is null.")}RDh(M,ca){this.vpe=ca.x;this.wpe=ca.y;this.uVe()}SDh(M,ca){this.Tre=ca.x;this.Ure=ca.y;this.uVe()}uVe(){this.Qac.style.left=tf.a.Nc(this.vpe+this.Tre+Dd.a.q5-this.kOg);this.Qac.style.top=tf.a.Nc(this.wpe+this.Ure+
Dd.a.q5-this.kOg)}uEj(M){return M in this.gqa}oZk(M,ca){this.gqa[M]=ca}TIa(M,ca,Na){1===this.ple&&ca||M in this.gqa&&this.gqa[M].TIa(ca,Na)}Ydh(M){M in this.gqa&&(this.gqa[M].dispose(),delete this.gqa[M])}pKe(M,ca){M in this.gqa&&this.gqa[M].pKe(ca)}NDb(){}get gqa(){return this.I0j}}Object(h.a)(Jc,"AppForOfficeContentAppsContainer",null,[855,106]);var Qc=d(390);class Ph extends y.StandardDialog{constructor(M,ca){super();this.NKh=CommonUIStrings.l_AppsforOfficeDeveloperModeCheckboxLabel;this.wNh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrlText;
this.xNh=CommonUIStrings.l_AppsforOfficeDeveloperModeHelpUrl;this.uMh=M;this.WMb=ca}showDialog(M,ca){const Na=new od.a(void 0,void 0,!1);Na.yd=0;Na.ng=Qc.a.Rdd(Number.MAX_VALUE).toString();Na.mg=String.format("<div style=\ufffdheight:100px;width:400px;border:none;\ufffd><body><p>{0}<a href='{1}'target='_blank'>{2}</a></p><br/><br/><input type='checkbox' id='optInCheckbox'>  {3}</input></body></div>",ca,this.xNh,this.wNh,this.NKh);Na.tj(M,Object(D.a)(this,this.ykk,"onCheckboxExecute$4"),{optInCheckbox:!1})}ykk(M,
ca){1===M&&ca.optInCheckbox&&(w.a.instance.getItem("optedIntoAddinDeveloperMode")?w.a.instance.removeItem("optedIntoAddinDeveloperMode"):(w.a.instance.setItem("optedIntoAddinDeveloperMode","true"),this.pmc()))}pmc(){const M=new y.StandardDialog;M.yd=4;const ca=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.uMh)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;M.DO(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
ca,this.WMb)}}Object(h.a)(Ph,"AppForOfficeDeveloperModeOptInDialog",y.StandardDialog,[]);const ng=M=>{const ca=[];if(!M)return ca;ca[OSF.DDA.Marshaling.ThemingKeys.Accent1]=se(M.Accent1);ca[OSF.DDA.Marshaling.ThemingKeys.Accent2]=se(M.Accent2);ca[OSF.DDA.Marshaling.ThemingKeys.Accent3]=se(M.Accent3);ca[OSF.DDA.Marshaling.ThemingKeys.Accent4]=se(M.Accent4);ca[OSF.DDA.Marshaling.ThemingKeys.Accent5]=se(M.Accent5);ca[OSF.DDA.Marshaling.ThemingKeys.Accent6]=se(M.Accent6);ca[OSF.DDA.Marshaling.ThemingKeys.Background1]=
se(M.OsfColorScheme?M.OsfColorScheme.Background1:null);ca[OSF.DDA.Marshaling.ThemingKeys.Background2]=se(M.OsfColorScheme?M.OsfColorScheme.Background2:null);ca[OSF.DDA.Marshaling.ThemingKeys.Text1]=se(M.OsfColorScheme?M.OsfColorScheme.Text1:null);ca[OSF.DDA.Marshaling.ThemingKeys.Text2]=se(M.OsfColorScheme?M.OsfColorScheme.Text2:null);ca[OSF.DDA.Marshaling.ThemingKeys.Hyperlink]=se(M.Hyperlink);ca[OSF.DDA.Marshaling.ThemingKeys.FollowedHyperlink]=se(M.FollowedHyperlink);const Na=M.OsfFontScheme;Na&&
(ca[OSF.DDA.Marshaling.ThemingKeys.HdEastAsian]=Na.HdEaFt,ca[OSF.DDA.Marshaling.ThemingKeys.HdLatin]=Na.HdLtnFt,ca[OSF.DDA.Marshaling.ThemingKeys.HdLocalized]=Na.HdLclFt,ca[OSF.DDA.Marshaling.ThemingKeys.HdScript]=Na.HdSptFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdEastAsian]=Na.BdEaFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdLatin]=Na.BdLtnFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdLocalized]=Na.BdLclFt,ca[OSF.DDA.Marshaling.ThemingKeys.BdScript]=Na.BdSptFt);ca[OSF.DDA.Marshaling.ThemingKeys.BackgroundColor]=
se(M.Background);return ca},se=M=>{if(!M)return null;let ca;ca=M.b;ca+=M.g<<8;return ca+=M.r<<16};class pf{constructor(M,ca,Na){this.pOg=M;this.cT=ca;this.W2j=Na}register(){this.pOg.Yj(Object(D.a)(this,this.lyh,"themeChangedCallback"))}dispose(){this.pOg.tm(Object(D.a)(this,this.lyh,"themeChangedCallback"))}lyh(M,ca){if(ca.node.Sa(Bb.a.Pe)&&(ca.property===Bb.a.Pe||ca.property===Bb.a.W$)){M=ca.node;try{var Na=ng(M?M.Pe:null)}catch(zb){return}if(M){M=M.jl();for(const zb of M)zb.Uq&&(M=this.W2j.m2(zb),
this.cT.wXa(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),M.id,Na))}this.cT.Rah(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent.toString(),Na)}}}Object(h.a)(pf,"AppForOfficeDocumentThemeListener",null,[848,106]);var $d=d(245);class Ye extends od.a{constructor(M,ca,Na){super();this.Hpa=null;this.IFd="WACDialogTitleText";this.nkb="0";this.Crc="15px";this.wLh="0px";this.mkb="calc(100% - 30px)";this.vLh="100%";this.Gtf=0;this.Pa=new E.a;this.dJh=new H;this.yd=5;this.ng=this.XMb=Na;
this.atd=M;this.U1e=ca;this.Btd=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}i6h(M){this.Pa.addHandler("OnDialogClosedEventKey",M)}t5k(){this.Roa=null}px(){super.px();this.sz.style.width="100%";this.sz.style.height=this.OQc?this.mkb:this.vLh;this.sz.style.marginTop=this.OQc?this.Crc:this.wLh;this.sz.style.padding=this.nkb}QF(){super.QF();this.rc.style.width=String.format("{0}px",this.atd*window.innerWidth/100);this.rc.style.height=String.format("{0}px",
this.U1e*window.innerHeight/100);this.rc.style.minWidth="0px";this.Btd&&A.AFrameworkApplication.isRtl&&100===this.atd&&(this.rc.style.right="0px",this.rc.style.marginRight="0px");this.Hpa=document.getElementById(this.ji(this.IFd));this.Hpa.style.position="absolute";this.Hpa.style.whiteSpace="nowrap";this.Hpa.style.textOverflow="ellipsis";A.AFrameworkApplication.isRtl?(this.Hpa.style.right="14px",this.Hpa.style.left="44px"):(this.Hpa.style.right="44px",this.Hpa.style.left="14px")}$wa(M){super.$wa(M);
this.Hpa&&this.Hpa.setAttribute("title",M)}get r5a(){return this.sz}qHe(){this.rc.style.width=String.format("{0}px",this.atd*window.innerWidth/100);this.rc.style.height=String.format("{0}px",this.U1e*window.innerHeight/100);this.rc.style.overflowY="hidden";this.rc.style.overflowX="hidden";this.rc.style.marginTop="";this.rc.style.top="";xe.a.j9a&&A.AFrameworkApplication.isRtl?(this.rc.style.right="",this.rc.style.marginRight=""):(this.rc.style.left="",this.rc.style.marginLeft="")}hide(){this.dJh.ETf(3,
this.XMb).execute(this,L.getInstance(),{});this.Gtf=window.setTimeout(()=>{this.Pa.raiseEvent("OnDialogClosedEventKey",this.XMb);$d.a.prototype.hide.call(this)},500)}P0g(M){3===M&&(window.clearTimeout(this.Gtf),this.Pa.raiseEvent("OnDialogClosedEventKey",this.XMb),super.hide())}}Object(h.a)(Ye,"AppsForOfficeDialog",od.a,[665,666]);class Kd{constructor(){this.dialog=this.ng=null}}Object(h.a)(Kd,"DialogInfo",null,[]);class Yd{}Yd.url="url";Yd.height="height";Yd.width="width";Yd.aUd="displayInIframe";
Yd.iRc="hideTitle";Object(h.a)(Yd,"DialogSettings",null,[]);class Zf{constructor(){this.height=this.width=0;this.ng=this.controlId=this.pageUrl=null;this.iRc=this.aUd=!1}}Object(h.a)(Zf,"DisplayDialogParams",null,[]);class ef extends Sys.EventArgs{constructor(M,ca,Na=null,zb="",$b=""){super();this.controlId=M;this.messageType=ca;this.messageContent=Na;this.oue=zb;this.OJa=$b}}Object(h.a)(ef,"OnMessageDialogEventArgs",Sys.EventArgs,[]);class Ke extends Sys.EventArgs{constructor(M,ca,Na=null,zb="",
$b=""){super();this.controlId=M;this.messageType=ca;this.messageContent=Na;this.oue=zb;this.OJa=$b}}Object(h.a)(Ke,"OnMessageParentEventArgs",Sys.EventArgs,[]);var gi=d(106);class Rf{constructor(M){this.Pa=new E.a;this.tR=M}D6h(M){this.Pa.addHandler("OnMessageParentEventKey",M)}rfh(M){this.Pa.removeHandler("OnMessageParentEventKey",M)}C6h(M){this.Pa.addHandler("OnMessageDialogEventKey",M)}ZRk(M){this.Pa.removeHandler("OnMessageDialogEventKey",M)}showDialog(M,ca,Na,zb){if(Rf.eoa.Jb(ca))m.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Na(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{const Zd=ia.b(M),Oe=Zd[Yd.url];if(this.tR.getOsfControl(ca).checkAppDomains(Oe)){var $b=new Zf;$b.width=Zd[Yd.width];$b.height=Zd[Yd.height];$b.pageUrl=Oe;$b.aUd=Zd[Yd.aUd];$b.iRc=Zd[Yd.iRc];$b.controlId=ca;$b.ng=gi.a.create().toString();var Tc=new Kd;Tc.ng=$b.ng;var hd=this.tR.getOsfControl($b.controlId).getManifest().getDefaultDisplayName(),Hd=this.tR.getOsfControl($b.controlId).getStoreType().toLowerCase();
M=null;M=(4===A.AFrameworkApplication.Aa.jb.rm&&"hardcodedpreinstall"===Hd||"sdxcatalog"===Hd)&&$b.iRc?this.createAndShowAppsForOfficeDialog($b.width,$b.height,$b.ng,!0,hd):this.createAndShowAppsForOfficeDialog($b.width,$b.height,$b.ng,!1,hd);var le=this.tR.getOsfControl($b.controlId),ge=le.getManifest();ca={};ca.id=$b.ng;ca.solutionId=le.getSolutionId();ca.version=le.getVersion();ca.storeType=Hd;ca.storeId=le.getStoreId();ca.assetId=le.getAssetId();ca.assetStoreId=le.getAssetStoreId();ca.ownerAddinSolutionId=
le.getOwnerAddinSolutionId();ca.ownerAddinStoreType=le.getOwnerAddinStoreType();ca.appDomains=ge.getAppDomains();ca.dialogUrl=Oe;ca.osfControlType=1;ca.agaveName=hd;ca.div=M.r5a;m.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(ca.solutionId,ca.ownerAddinStoreType||ca.storeType,ca.assetId,null,null,ca.storeId),ja.a.NM($b.pageUrl));this.tR.insertDialogControl(ca);M.i6h(Object(D.a)(this,this.qlk,"onDialogClosed"));Tc.dialog=
M;Rf.eoa.$($b.controlId,Tc);zb&&zb(ca);Na(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else m.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Na(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Zd){m.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Zd.message),Na(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}bfk(M,ca,Na,zb){A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===zb&&(zb=Na);try{const $b=this.zCa(M);$b&&this.Pa.raiseEvent("OnMessageParentEventKey",new Ke($b,OSF.DialogMessageType.DialogMessageReceived,ca,Na,zb))}catch($b){return m.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",$b.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}tqi(M,ca){if(Rf.eoa.Jb(M))try{const Na=Rf.eoa.ga(M);Na.dialog&&Na.dialog.hide();this.tR.purgeDialogControl(Na.ng);
Rf.eoa.remove(M);ca(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Na){m.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Na.message),ca(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else m.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),ca(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}a1k(M,ca,Na,zb){A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===zb&&(zb=Na);if(Rf.eoa.Jb(M)&&(M=Rf.eoa.ga(M),M.dialog))try{this.Pa.raiseEvent("OnMessageDialogEventKey",new ef(M.ng,OSF.DialogMessageType.DialogParentMessageReceived,ca,Na,zb))}catch($b){m.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",$b.message)}}zCa(M){let ca=null;for(let Na of Rf.eoa)if(Na.value.ng===M){ca=Na.key;break}return ca}qlk(M,ca){if(M=this.zCa(ca))this.tR.purgeDialogControl(ca),Rf.eoa.remove(M),this.Pa.raiseEvent("OnMessageParentEventKey",
new Ke(M,OSF.DialogMessageType.DialogClosed,null,null,"*"))}createAndShowAppsForOfficeDialog(M,ca,Na,zb,$b){M=new Ye(M,ca,Na);$b=zb?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,$b);zb&&(M.OQc=!1,M.qr=!1);M.tj($b,null,null);M.t5k();return M}static eig(){return Rf.eoa}static getInstance(M){Rf.Ja||(Rf.Ja=new Rf(M));return Rf.Ja}}Rf.Ja=null;Rf.eoa=new yb.a;Object(h.a)(Rf,"AppsForOfficeDialogManager",null,[647]);var Uf=d(703),Ed=d(65),vg=d(119),Jd=d(93),Ie=d(169),gf=d(122);class eh extends Sys.EventArgs{constructor(M){super();
this.wha=M}}Object(h.a)(eh,"AppForOfficeFocusOnAddinPaneEventArgs",Sys.EventArgs,[]);var rg=d(47);class Cg{constructor(M,ca,Na,zb,$b,Tc){this.qQ=[];this.ste=new Uf.a;this.NE=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.jb&&A.AFrameworkApplication.Aa.jb.tW;this.jX=M;this.u4j=this.jX.firstChild;this.Fa=ca;this.Ar=Na;this.nb=zb;this.Zd=$b;this.Ee=Tc}get R1(){return this.qQ}get re(){return this.Zd.value}M5d(){return 0<this.iec}pP(M){if(M){this.R1.push(M);var ca=M.xa;ca&&!this.NE&&this.jX.insertBefore(ca,
this.u4j);1===this.iec&&this.Fa.Gj(gf.a.xMd,!0);M.isVisible&&this.Ar.addHandler(M.xa,Ed.a.Xf,Object(D.a)(this,this.Ekg,"handleShortCutsOnAddinPane"))}}zeh(M){M&&(Array.remove(this.qQ,M),M=M.xa,this.Ar.removeHandler(M,Ed.a.Xf,Object(D.a)(this,this.Ekg,"handleShortCutsOnAddinPane")),M&&!this.NE&&this.jX.removeChild(M),this.iec||this.Fa.Gj(gf.a.xMd,!1))}w5(M){if(1===M||2===M){if(1===M){this.ste=new Uf.a;for(const ca of this.R1)ca.isVisible&&this.ste.add(ca.id.toLowerCase())}M=2===M;for(const ca of this.R1)this.ste.contains(ca.id.toLowerCase())&&
(ca.kp(M),(M&&1===this.iec||!M&&!this.iec)&&this.Fa.Gj(gf.a.xMd,M))}}Doj(M,ca){for(const Na of this.qQ)M=Na.layout(M,ca)}XT(M,ca){if(M){M=null;if(ca===rg.a.Bg)for(ca=this.qQ.length-1;0<=ca;ca--){if(this.qQ[ca].isVisible){M=this.qQ[ca];break}}else if(ca===gf.a.QLf||ca===gf.a.Vhi||ca===vg.AFrame.$Y||ca===vg.AFrame.cLc||ca===gf.a.c2||ca===gf.a.$hi||ca===rg.a.OF||ca===rg.a.PK||ca===rg.a.FZ)for(ca=0;ca<this.qQ.length;ca++)if(this.qQ[ca].isVisible){M=this.qQ[ca];break}this.rYd(M)}}rYd(M){if(M){var ca=this.re.PXd(M.id);
ca&&this.Ee.sGk(new eh(ca.wha));this.re.notifyAgave(M.id,11)}else m.ULS.sendTraceTag(19014042,806,10,"Focus could not be put on the null addin pane!")}YVi(M,ca){var Na;for(Na=0;Na<this.qQ.length&&this.qQ[Na].id!==M;Na++);if(Na===this.qQ.length)m.ULS.sendTraceTag(19014043,806,10,String.format("Failed to find the taskpane with instance id: {0}",M)),this.qTe(ca);else{M=null;if(5===ca)for(--Na;0<=Na;Na--){if(this.qQ[Na].isVisible){M=this.qQ[Na];break}}else if(6===ca)for(Na+=1;Na<this.qQ.length;Na++)if(this.qQ[Na].isVisible){M=
this.qQ[Na];break}M?this.rYd(M):this.qTe(ca)}}H6f(M){for(const ca of this.qQ)if(ca.id===M){Jd.FocusManager.Mr(ca.Aqi);return}m.ULS.sendTraceTag(19014044,806,10,String.format("Failed to focus on addinpane's the close button with instance id: {0}",M))}lsl(M){for(let ca of Rf.eig())if(ca.value.ng.toLowerCase()===M.toLowerCase())return ca.value.dialog.hide(),ca.key;return null}qTe(M){5===M?this.Fa.R7a(!1):6===M&&this.Fa.R7a(!0)}c3f(){const M=this.nb.Yd();M&&1===M.length&&(this.nb.selectShape(M[0],!0),
this.Fa.Ad())}get iec(){let M=0;for(const ca of this.R1)ca.isVisible&&M++;return M}Ekg(M){if(M.keyCode===Ie.a.xY&&M.ctrlKey)for(var ca=0;ca<this.R1.length;ca++){var Na=this.R1[ca];if(Na.isVisible&&Na.xa.contains(M.target)){Na=null;if(M.shiftKey)for(ca+=1;ca<this.R1.length;ca++){if(this.R1[ca].isVisible){Na=this.R1[ca];break}}else for(--ca;0<=ca;ca--)if(this.R1[ca].isVisible){Na=this.R1[ca];break}Na&&(this.rYd(Na),M.preventDefault(),M.stopPropagation());break}}}Bf(M){this.Fa.Bf(M)}}Object(h.a)(Cg,
"AppForOfficeFocusManager",null,[854]);var kh=d(930);class De{Eyi(M,ca,Na){M=kh.a.qgg(M.xeb);M.appName=OSF.AppName.PowerpointWebApp;M.clientMode=1;M.formFactor="DefaultSettings";M.hostControl=ca;ca=Ub.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager");M.allowExternalMarketplace=M.allowExternalMarketplace&&ca.eXb;Na.register(M);Na=new OSF.ContextActivationManager(M);Na.setWSA(A.AFrameworkApplication.ej);return Na}}Object(h.a)(De,"AppForOfficeImportedClassFactory",null,[853]);class Nd{constructor(M){this.$Eg=
M}mFe(){for(const M of this.$Eg)M.register()}dispose(){for(const M of this.$Eg)M.dispose()}}Object(h.a)(Nd,"AppForOfficeListenerManager",null,[852,106]);var Od=d(198),mj=d(342);class qi extends od.a{constructor(){super();this.mkb="calc(100% - 46px)";this.Crc="15px";this.nkb="0";this.EMh="WACDialogPanel";this.k0a=695;this.FMh=462;this.$Mb="80%";this.jKh=350;this.gZe="100%";this.yd=5;this.ng="AppsForOfficeInsertionDialog";this.Btd=!!A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("OfficeAddinEnableInsertDialogAccessibilityFix")}px(){super.px();
this.sz.style.width=this.gZe;this.sz.style.height=this.mkb;this.sz.style.marginTop=this.Crc;this.sz.style.padding=this.nkb}Ema(){this.sz.style.width=this.gZe;this.sz.style.height=this.mkb;this.sz.style.marginTop=this.Crc;this.sz.style.padding=this.nkb;this.k0a>$d.a.vea?(this.rc.style.width=String.format("{0}px",$d.a.vea),this.rc.style.overflowX="scroll",A.AFrameworkApplication.isRtl?this.rc.style.right="0":this.rc.style.left="0"):(this.rc.style.width=String.format("{0}px",this.k0a),this.rc.style.overflowX=
"hidden");this.rc.offsetHeight>$d.a.tma||this.FMh+50>$d.a.tma?(this.rc.style.height=String.format("{0}px",$d.a.tma),this.rc.style.overflowY="scroll",this.rc.style.top="0",A.AFrameworkApplication.isRtl?this.rc.style.right="0":this.rc.style.left="0",this.Btd||(this.rc.style.marginTop="-48px"),this.sz.style.minHeight=String.format("{0}px",this.jKh)):(this.rc.style.overflowY="hidden",this.rc.style.top="10%",this.rc.style.height=this.$Mb);this.RVb()}RVb(){if(this.rc){var M=this.rc.style.zIndex;this.rc.style.zIndex=
"-9999";if(this.k0a>$d.a.vea)A.AFrameworkApplication.isRtl?this.rc.style.marginRight="0":this.rc.style.marginLeft="0";else{const ca=String.format("{0}px",Math.floor(-this.rc.offsetWidth/2));A.AFrameworkApplication.isRtl?this.rc.style.marginRight=ca:this.rc.style.marginLeft=ca;A.AFrameworkApplication.isRtl?this.rc.style.right="50%":this.rc.style.left="50%"}this.rc.style.zIndex=String(M)}else m.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")}QF(){super.QF();const M=document.getElementById(this.ji(this.EMh));
M.style.width=String.format("{0}px",this.k0a);M.style.height=this.$Mb}get r5a(){return this.sz}}Object(h.a)(qi,"AppsForOfficeInsertionDialog",od.a,[624]);var Vf=d(1168),Ai=d(172);class $g{constructor(M,ca,Na){this.Tub=M;this.onSuccess=ca;this.onError=Na;$addHandler(window,"message",Object(D.a)(this,this.G2b,"handleResponse"))}G2b(M){try{if(M&&M.rawEvent&&M.rawEvent.origin&&this.Tub&&this.Tub.id){var ca=this.x5g(M.rawEvent.origin);const Na=this.x5g(document.domain);if(Vf.a.Tq().equals(Na,ca))if(M.rawEvent.source&&
M.rawEvent.source.frameElement&&M.rawEvent.source.frameElement.id&&Vf.a.Tq().equals(M.rawEvent.source.frameElement.id,this.Tub.id)){ca=null;try{ca=JSON.parse(M.rawEvent.data)}catch(zb){m.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",zb.message)}ca?(ca.statusCode!==Ai.a.py||void 0!==ca.error&&ca.error?(m.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",
ca.statusCode,ca.error),this.onError()):(m.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(ca.authorizationCode?ca.authorizationCode:ca.signInUrl)),$removeHandler(window,"message",Object(D.a)(this,this.G2b,"handleResponse")),this.Tub?document.body.contains(this.Tub)?document.body.removeChild(this.Tub):m.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):m.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):m.ULS.sendTraceTag(575976219,
344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else m.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else m.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else m.ULS.sendTraceTag(51418200,344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Na){m.ULS.sendTraceTag(23707649,
344,10,"Exception in authentication proxy message handler: {0}.",Na.message)}}x5g(M){let ca="";try{M&&(ca=-1<M.indexOf("//")?M.split("/")[2]:M.split("/")[0])&&(ca=ca.split(":")[0],ca=ca.split("?")[0])}catch(Na){m.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Na.message)}return ca}static Hx(M,ca,Na){new $g(M,ca,Na)}}Object(h.a)($g,"ResponseHandler",null,[]);var Ch=d(217);class nf{constructor(M){this.Lpa=M}tryAuthenticate(M,ca){this.Oad(nf.jPh,()=>{M()},ca)}tryAuthorize(M,
ca){this.Oad(nf.TJh,M,ca)}getSignInUrl(M,ca){this.Oad(nf.ixf,M,ca)}signOut(M,ca){this.Oad(nf.FXh,M,ca)}Oad(M,ca,Na){var zb=new Ch.QueryStringBuilder("AuthenticationProxyHandler.aspx");zb.Ti("responseType",M);A.AFrameworkApplication.BNa(zb);zb=String.format("{0}{1}&{2}",this.Lpa,zb.toString(),A.AFrameworkApplication.hh);const $b=document.createElement("iframe");$b.setAttribute("id","privateCatalogIframe");$b.setAttribute("name","privateCatalogIframe");$b.setAttribute("style","display: none");Vf.a.Tq().equals(M,
nf.ixf)||$b.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");$g.Hx($b,ca,Na);$b.setAttribute("src",zb);document.body.appendChild($b)}}nf.TJh="authcode";nf.jPh="identitytoken";nf.ixf="signinurl";nf.FXh="signout";Object(h.a)(nf,"AuthenticationProxy",null,[]);class qf{}qf.getUserId="getUserId";qf.getLastStoreUpdate="laststoreupdate";qf.getEntitlement="getEntitlements";qf.getEToken="getEToken";qf.getManifest="getManifest";qf.getAppState="getAppState";
qf.getKilledApps="getRemovedAddins";qf.getAppDetails="getAppDetails";qf.removeApps="removeAddin";qf.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";qf.getPrivateCatalogAddIns="getAddIns";qf.getPrivateCatalogManifests="getAppManifests";qf.isStoreDisabled="isStoreDisabled";Object(h.a)(qf,"S2SWebRequestActions",null,[]);var Wi=d(516);class Tg{getUserId(M,ca){const Na=new e.a;Na.add(new Ka.a("corr",M));this.ux(qf.getUserId,Na,1,ca)}getLastStoreUpdate(M,ca,Na){const zb=new e.a;zb.add(new Ka.a("lc",
M));zb.add(new Ka.a("corr",ca));this.ux(qf.getLastStoreUpdate,zb,1,Na)}getEntitlement(M,ca,Na,zb){M=new e.a;M.add(new Ka.a("av",ca));M.add(new Ka.a("corr",Na));this.ux(qf.getEntitlement,M,1,zb)}getEToken(M,ca,Na,zb,$b,Tc){const hd=new e.a;hd.add(new Ka.a("cmu",M));hd.add(new Ka.a("cmf",ca));hd.add(new Ka.a("assetid",Na));hd.add(new Ka.a("expver",zb));hd.add(new Ka.a("corr",$b));this.ux(qf.getEToken,hd,1,Tc)}getManifest(M,ca,Na,zb){const $b=new e.a;$b.add(new Ka.a("cmu",M));$b.add(new Ka.a("assetid",
ca));$b.add(new Ka.a("corr",Na));this.ux(qf.getManifest,$b,1,zb)}getAppState(M,ca,Na){const zb=new e.a;zb.add(new Ka.a("ma",M));zb.add(new Ka.a("corr",ca));this.ux(qf.getAppState,zb,1,Na)}getKilledApps(M,ca){const Na=new e.a;Na.add(new Ka.a("corr",M));this.ux(qf.getKilledApps,Na,1,ca)}getAppDetails(M,ca,Na,zb){const $b=new e.a;$b.add(new Ka.a("cmo",M));$b.add(new Ka.a("corr",Na));this.sendWithBody(qf.getAppDetails,$b,ca,2,zb,!1)}removeApps(M,ca,Na){const zb=new e.a;zb.add(new Ka.a("corr",ca));this.sendWithBody(qf.removeApps,
zb,M,2,Na,!1)}getLastPrivateCatalogUpdate(M,ca,Na,zb,$b,Tc){const hd=new e.a;hd.add(new Ka.a("catalog","privatecatalog"));hd.add(new Ka.a("clientCode",M));hd.add(new Ka.a("clientVersion",ca));hd.add(new Ka.a("corr",$b));M=String.format("authorizationCode={0}&refreshToken={1}",Na?ja.a.Qe(Na):"",zb?ja.a.Qe(zb):"");this.sendWithBody(qf.getLastPrivateCatalogUpdate,hd,M,2,Tc,!0)}getPrivateCatalogAddIns(M,ca,Na,zb,$b,Tc){const hd=new e.a;hd.add(new Ka.a("catalog","privatecatalog"));hd.add(new Ka.a("clientCode",
M));hd.add(new Ka.a("clientVersion",ca));hd.add(new Ka.a("corr",$b));M=String.format("authorizationCode={0}&refreshToken={1}",Na?ja.a.Qe(Na):"",zb?ja.a.Qe(zb):"");this.sendWithBody(qf.getPrivateCatalogAddIns,hd,M,2,Tc,!0)}getPrivateCatalogManifests(M,ca,Na,zb,$b){const Tc=new e.a;Tc.add(new Ka.a("catalog","privatecatalog"));Tc.add(new Ka.a("corr",zb));M=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",ja.a.Qe(M),ca?ja.a.Qe(ca):"",Na?ja.a.Qe(Na):"");this.sendWithBody(qf.getPrivateCatalogManifests,
Tc,M,2,$b,!0)}isStoreDisabled(M,ca){const Na=new e.a;Na.add(new Ka.a("corr",M));this.ux(qf.isStoreDisabled,Na,2,ca)}ux(M,ca,Na,zb){this.sendWithBody(M,ca,null,Na,zb,!1)}sendWithBody(M,ca,Na,zb,$b,Tc){const hd=new Ch.QueryStringBuilder("AddinServiceHandler.ashx");hd.Ti("action",M);hd.Ti("app",Wi.a[A.AFrameworkApplication.Aa.jb.rm]);for(let Hd of ca)hd.Ti(Hd.key,Hd.value);ca=String.format("{0}{1}&{2}",A.AFrameworkApplication.Aa.jb.Xla,hd.toString(),A.AFrameworkApplication.hh);A.AFrameworkApplication.Ge.yj(ca,
zb,Na,null,!1,2,Hd=>{let le=null,ge=null;Hd&&Hd.data&&(Hd.data.qj["X-BlockedForMinor"]&&"1"===Hd.data.qj["X-BlockedForMinor"].toString()&&(Hd.data.Le=451),le=Hd.data.Sd,ge=Hd.data.qj);$b(Hd.data.Le,le,ge)},Hd=>{var le=null;let ge=null;Tc&&Hd&&Hd.data&&Hd.data.Sd&&(le=Hd.data.Sd,ge=Hd.data.qj);$b(Hd.data.Le,le,ge);if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){le={message:"AddinServiceHandler request failed"};le.code=Hd.data.Le;
le.action=M;if(Hd.data.request||Hd.data.request.get_headers())le["X-UserSessionId"]=Hd.data.request.get_headers()["X-UserSessionId"];408===Hd.data.Le||503===Hd.data.Le?m.ULS.sendTraceTag(538784582,220,10,JSON.stringify(le)):m.ULS.sendTraceTag(18392345,220,50,JSON.stringify(le))}else m.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Hd.data.Le)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+M,void 0,void 0,void 0,["X-UserKey"])}}Object(h.a)(Tg,"S2SWebRequestManager",
null,[]);var rd=d(233),ze=d(30),xh=d(81);class Qj{constructor(M,ca){this.state=M;this.Nwa=ca}}Object(h.a)(Qj,"BackgroundAppData",null,[889]);class ae{constructor(M,ca,Na,zb,$b,Tc,hd){this.wha=null;this.xJh=M;this.MYh=zb;this.Zvd=ca;this.Vza=Na;this.settings=$b;this.T5=Tc;this.Rv=hd}get So(){return this.xJh}get taskpane(){return this.MYh}get instanceId(){return this.Zvd}get shape(){return this.Vza}get yy(){return this.T5}E0h(M){this.Rv=new Qj(0,M)}}Object(h.a)(ae,"AppForOffice",null,[850]);var nj=
d(29);class Xi{}Xi.c_Error="Error";Object(h.a)(Xi,"ApiResponseKeyStrings",null,[]);class La{constructor(M,ca,Na,zb,$b){this.EventDispId=M;this.ControlId=ca;this.TargetId=Na;this.Handler=zb;this.Callback=$b}}Object(h.a)(La,"EventRegistrationParams",null,[]);var lb=d(26);class Nb{constructor(M,ca){this.invokeDdaMethod=this.InvokeDdaMethod;this.registerDdaEventAsync=this.RegisterDdaEventAsync;this.yb=A.AFrameworkApplication.pe;this.Qoe=M;this.GHg=ca}InvokeDdaMethod(M,ca,Na){const zb=M.DdaMethod.DispatchId,
$b=this.Qoe.j_i(zb);$b?($b.parameters=M,$b.callback=ca,$b.T8h=Na,$b.controlId=M.DdaMethod.ControlId,this.yb.Cb(new Bg.a(2,1,0,Object(D.a)($b,$b.go,"go"),90,"51"))):(M="API Call for method ID "+zb+" does not exist:"+nj.Debug.Ht(),lb.a.J(8958091,802,10,M),this.cNd(ca))}RegisterDdaEventAsync(M,ca,Na,zb,$b){const Tc=new Bg.a(2,1,0,Object(D.a)(this,this.bNk,"registerEventTaskProcess"),90,"52");Tc.customData=new La(M,ca,Na,zb,$b);this.yb.Cb(Tc)}UnregisterDdaEventAsync(M,ca,Na,zb,$b){const Tc=new Bg.a(2,
1,0,Object(D.a)(this,this.uul,"unregisterEventTaskProcess"),90,"53");Tc.customData=new La(M,ca,Na,zb,$b);this.yb.Cb(Tc)}bNk(M){M=M.customData;var ca=this.GHg.zZd(M.EventDispId);ca?ca.addHandler(M.ControlId,M.Handler,M.Callback,M.TargetId):(ca="Event for dispatch ID "+M.EventDispId+" does not exist:"+nj.Debug.Ht(),lb.a.J(8958093,802,10,ca),this.cNd(M.Callback))}uul(M){M=M.customData;var ca=this.GHg.zZd(M.EventDispId);ca?ca.removeHandler(M.ControlId,M.Handler,M.Callback,M.TargetId):(ca="Event for dispatch ID "+
M.EventDispId+" does not exist:"+nj.Debug.Ht(),lb.a.J(8958095,802,10,ca),this.cNd(M.Callback))}cNd(M){if(M){var ca={};ca[Xi.c_Error]=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;M(ca)}}}Object(h.a)(Nb,"AppForOfficeApiAdapter",null,[981]);class lc{constructor(M,ca,Na,zb){this.menuItemId=M;this.tU=ca;this.Qjl=Na;this.PSi=zb}}Object(h.a)(lc,"NewDocumentParameters",null,[]);var Rc=d(573),Ud=d(129),Pd=d(140),Sd=d(42),Le=d(50),af=d(75),zf=d(31),yh=d(36),gg=d(49),Dh=d(39),Ug=d(32),ui=d(57);class Uh{constructor(M,
ca,Na){this.vcb=[];this.m_c=this.Pyb=!1;this.ta=M;this.vF=ca;this.Vy=Na}build(){const M=this.ta.AD();if(!M)return this.vcb;for(const ca of M)if(this.wDk(ca),this.m_c)break;return this.vcb}wDk(M){const ca=zf.ParagraphReader.textLength(M);this.xDk(M,ca);this.m_c||this.bDk(M)}xDk(M,ca){this.Pyb||(this.vF>=ca?this.vF-=ca:(this.Pyb=!0,this.Vy||this.vcb.push(gg.a.ak(Object(C.a)(xh.a,M),this.vF))));this.Pyb&&(this.Vy>ca-this.vF?0<ca&&(this.vcb.push(gg.a.createTextRange(Object(C.a)(xh.a,M),this.vF,ca)),this.Vy-=
ca-this.vF,this.vF=0):0<this.Vy&&(this.vcb.push(gg.a.createTextRange(Object(C.a)(xh.a,M),this.vF,this.vF+this.Vy)),this.Vy=0));0>=this.Vy&&(this.m_c=!0)}bDk(M){this.Pyb||(0<this.vF?--this.vF:(this.Pyb=!0,this.Vy||this.vcb.push(gg.a.QOa(Object(C.a)(xh.a,M)))));this.Pyb&&0<this.Vy&&(this.vcb.push(gg.a.wba(Object(C.a)(xh.a,M))),--this.Vy);0>=this.Vy&&(this.m_c=!0)}}Object(h.a)(Uh,"TextSelectionBuilder",null,[]);var Yi=d(965),lh=d(28);class jg{constructor(M,ca,Na,zb,$b,Tc,hd,Hd,le,ge,Zd,Oe,tc,Xh,ii,Rh,
Wf,Yh,Jg,sb,Xa,hl,sl){this.Ha=M;this.fc=ca;this.MI=Na;this.Oac=zb;this.ra=$b;this.JW=Tc;this.V1c=hd;this.Fb=Hd;this.ia=le;this.ua=Zd;this.Zb=ge;this.Qb=Oe;this.lc=tc;this.E0j=Xh;this.nb=ii;this.Mb=Rh;this.Dm=Wf;this.Ea=Yh;this.Nb=Jg;this.Fbb=sb;this.Hh=Xa;this.Yx=hl;this.E7j=sl}eej(){let M;M="";if(this.nb.JG()){if(1<this.nb.Pgd())return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Dkc:M};const ca=this.nb.rq();if(this.vQj(ca)){const Na=[];this.Ea.kJ(ca,zb=>{zb&&Na.push(zb.characterData)});
M=Na.join(jg.DMf);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Dkc:M}}}else if(this.nb.cC())return this.getSelectedTextRange();return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Dkc:M}}aej(){let M;M="";return{returnValue:({bPe:M}=this.getSelectedSlides()).returnValue,s0k:M}}htb(){return this.MI.xeb.documentUrl}Xkj(M){if(!M)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;var ca=this.Qb.Hj();if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");
const Na=this.ua.Ba.we;switch(M){case "previous":M=Na-1;break;case "next":M=Na+1;break;case "first":M=0;break;case "last":M=ca-1;break;default:if(M=parseInt(M),isNaN(M))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo}if(0>M||M>ca-1)return OSF.DDA.ErrorCodeManager.errorCodes.ooeNavOutOfBound;ca=this.Qb.CG(M);if(!ca)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;this.Zb.Ba=ca;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}Ykj(M){if(!M)return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;
M=parseInt(M);if(isNaN(M))return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotNavTo;M=this.k3d(M);if(!M)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist;this.Zb.Ba=M;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}f7k(M){var ca=this.nb.Yd();if(!ca.length){if(ca=Object(C.a)(120,this.nb.rn()||this.ua.Ba)){var Na=ca.Bb;M=this.Dm.wRd(Na.cid,Na.sid,ca.ev()+1,M,"");Na=this.Fb.ud(7);Na.kc(ca);ca.GB(M);this.nb.selectShape(M,!0);Na.dispose();this.Yx.CI=M;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}else if(1===
ca.length){if(this.nb.JG())return this.f8k(M);if(this.nb.cC())return this.g8k(M)}return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}a7k(M,ca,Na,zb,$b,Tc,hd){if(this.jKc($b,0,jg.qjb)||this.jKc(Tc,0,jg.qjb)||this.jKc(Na,-jg.qjb,jg.qjb)||this.jKc(zb,-jg.qjb,jg.qjb)||0!==hd&&1!==hd)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam;if(M.length>this.Ha.pptEditorAppsForOfficeImageMaxSizeInBytes)return OSF.DDA.ErrorCodeManager.errorCodes.ooeSetDataIsTooLarge;var Hd=this.nb.Yd().length;
if(ca||$b||Tc||!Hd){Hd=this.ua.Ba;if(!Hd)throw Error.argumentNull("ActiveSlide is null");const le=Hd.Bb,ge=Hd.ev();let Zd=!0,Oe=new ui.a(0,0);ca?Oe=new ui.a(Na,zb):!this.Ha.Hzk||$b&&Tc?Oe=this.Qb.hsa($b,Tc):Zd=!1;ca=this.Dm.Qqa(!1,le.cid,le.sid,0,Rc.a.mH(Oe.x),Rc.a.mH(Oe.y),Rc.a.mH($b),Rc.a.mH(Tc),ge+1,!0);Zd||(ca.Un(yh.a.fz),ca.Un(yh.a.gz));ca.wk=!0;ca.Gjd=!0;ca.Hy=hd;ca.kja=0===hd?this.ZTf(M):M;ca.Evb=!0;M=this.Fb.ud(7);try{M.kc(Hd),Hd.GB(ca),this.nb.selectShape(ca,!0)}finally{M&&M.dispose()}this.Yx.CI=
ca;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}if(1===Hd&&(Hd=this.nb.rq())&&Hd.WDc){ca=this.ua.Ba;if(!ca)throw Error.argumentNull("ActiveSlide is null");Na=this.x7a(ca,Hd);Na.wk=!0;Na.Hy=hd;Na.kja=0===hd?this.ZTf(M):M;Na.Evb=!0;M=this.Fb.ud(7);try{M.kc(ca),ca.gU([Hd]),ca.GB(Na),this.nb.selectShape(Na,!0)}finally{M&&M.dispose()}this.Yx.CI=Na;return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}lb.a.J(512263113,802,10,"No placehoder seleted or multi-shape seleted.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}uja(){return this.Ha.uja}yEj(){return this.fc.ka("342")}p4i(M){if(!M)return null;
M=this.E0j.m2(M);M=0===M.yy?M.node:this.ua.Ba;if(!M)return null;M=Object(C.a)(119,this.lc.ig(M));return ng(M.Pe)}NIe(M,ca){if(M&&ca)if(Gf.a("UseUndoTransactionForSaveSettingToApp")){var Na=this.Fb.ud(15,void 0,void 0,void 0,!0);try{Na.kc(M),Na.fd=lh.a.dpg,Yi.a.GCh(this.V1c.value,M,ca)}finally{Na&&Na.dispose()}}else{Na=this.Fb.ud(4);try{Na.kc(M),Yi.a.GCh(this.V1c.value,M,ca),this.Zb.Ci.Yea()}finally{Na&&Na.dispose()}}}W4a(M,ca,Na){const zb=new y.StandardDialog;zb.yd=4;zb.nx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,
CommonUIStrings.l_NewFileAPIConsentMessage,1,$b=>{2===$b||0===$b?Na(OSF.DDA.ErrorCodeManager.errorCodes.ooeOperationCancelled):($b=new lc("blank","agave",M?jg.Sgk:jg.Tgk,M),this.E7j.create(ca,Na,$b).W4a())})}nf(){return this.nb.nf()}Yd(){return this.nb.Yd()}iej(){var M=this.nb.Yd();if(!(M.length&&this.nb.cC()&&this.ra.value&&this.ra.value.Oa.length))return[];const ca=this.ra.value.Oa.ga(0);return(M=jg.gcj(M[0],ca))&&2===M.length?M:[]}Vsl(M){if(!M)return!1;this.nb.FYb();if(!M.length)return!0;M[0]!==
this.ua.Ba&&(this.Zb.Ba=M[0]);for(const ca of M)ca&&this.nb.w3a(ca);return!0}Usl(M){if(!M)return!1;if(!M.length)return this.nb.Uh(),!0;this.nb.mYa(M,!0);return!0}Wsl(M,ca,Na){if(!jg.Gzg(M))return!1;if(0>ca)return!0;M=(new Uh(M,ca,Na)).build();M=[new Ud.Selection(M,!0)];M=new Pd.SelectionCollection(M,0);this.nb.qE(M);return!0}getSelectedSlides(){let M;M="";var ca=null;if(!ca||!ca.length){var Na=this.nb.rn()||this.ua.Ba;ca||(ca=[]);Na&&ca.push(Na)}if(!ca.length)return lb.a.J(512263111,802,10,"Unexpected error: cannot get current slide."),
{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,bPe:M};Na=[];for(const zb of ca){ca=zb.we+1;if(!ca)return lb.a.J(512263110,802,10,"Returned slide index is invalid."),{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,bPe:M};Array.add(Na,[zb.sid.toString(),zb.title||"",ca.toString()])}M=ia.c(Na);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,bPe:M}}getSelectedTextRange(){var M=[];for(let ca=0;ca<this.ra.value.Oa.length;ca++){const Na=this.ra.value.Oa.ga(ca);
Array.add(M,this.UOc(Na))}M=M.join(jg.DMf);if(M===af.AParagraphNode.AZ)return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeGetSelectionNotMatchDataType,Dkc:M};M=af.AParagraphNode.Fed(M);return{returnValue:OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,Dkc:M}}vQj(M){if(!M)return!1;let ca=M.bta||M.Ny||M.Pf||M.qd;if(!ca&&M.Sk)switch(M.Cj){case 0:case 2:case 1:case 3:case 10:case 8:ca=!0}return ca}wQj(M){if(!M)return!1;let ca=M.bta||M.Ny;if(!ca&&M.Sk)switch(M.Cj){case 0:case 2:case 1:case 3:case 8:ca=
!0}return ca}UOc(M){let ca="";if(M)for(let Na=0;Na<M.length;Na++){const zb=M.ga(Na),$b=zb.Qa,Tc=zb.Kb-$b;let hd="";zf.ParagraphReader.Vd(zb.node)&&(hd=zb.node.characterData);switch(zb.contextId){case Dh.a.paragraph:ca+=hd+"\r";break;case Dh.a.textRange:0<Tc&&(ca+=hd.substr($b,Tc));break;case Dh.a.endOfParagraph:ca+="\r"}}return ca}k3d(M){var ca=this.ua.presentation;if(!ca)throw Error.argumentNull("Presentation is null");ca=ca.slides||[];for(let Na=0;Na<ca.length;Na++)if(ca[Na].Bb.sid===M)return Object(C.a)(120,
ca[Na]);return null}g8k(M){if(!this.ra.value||!this.JW.value||!this.Oac.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(1===this.ra.value.Oa.length){if(!Sd.SelectionEditor.Uw(this.ra.value.Oa.kb)&&32!==this.ia.processAction(Ug.a.ABa,2))return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;var ca=this.ra.value.Oa.kb.Ua;const Na=ca.node,zb=ca.Qa;ca=ca.Kb;const $b=this.Fb.ud(7);try{$b.kc(Na);let Tc=null;Tc=zb===ca?gg.a.ak(Na,zb):gg.a.createTextRange(Na,zb,ca);this.JW.value.replaceTextRange(Tc,
M)}finally{$b.dispose()}ca=zb+M.length;this.ra.value.setSelection(Le.SelectionFactory.p2(Na,zb,ca));return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}lb.a.J(512263107,802,10,"SetTextForSelectedTextRange is called when there are more than one shape selected.");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}f8k(M){if(!this.ra.value||!this.JW.value||!this.Oac.value)return OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;const ca=this.nb.rq();if(!ca)return M="Fail to get shape while setting selected shape's text: shape returned as null: "+
nj.Debug.Ht(),lb.a.J(512263106,802,10,M),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.wQj(ca)){const Na=this.Nb.Kc(ca),zb=this.Fb.ud(7);try{zb.kc(Na);ca.deleteParagraph();this.Oac.value.eZ(Na,!0);this.Fbb.ri(Na);const $b=Na.currentNode,Tc=this.Hh.textLength($b),hd=gg.a.createTextRange($b,0,Tc);this.JW.value.replaceTextRange(hd,M)}finally{zb.dispose()}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}lb.a.J(512263105,802,10,"Shape is not supported by SetDataAsync");return OSF.DDA.ErrorCodeManager.errorCodes.ooeCannotWriteToSelection}jKc(M,
ca,Na){return M<ca||Na<M}ZTf(M){return"data:image/png;base64,"+M}x7a(M,ca){if(!M)return null;var Na=M.Bb;M=M.ev();let zb;const $b=Cb.a.uX,Tc=Cb.a.E4;zb=ca?ca.Ftb(Cb.a.uX,Cb.a.E4):this.Qb.hsa(Cb.a.uX,Cb.a.E4);Na=this.Dm.Qqa(!0,Na.cid,Na.sid,0,zb.x,zb.y,$b,Tc,M+1,!0);ca&&(Na.kba=ca.id);return Na}static Gzg(M){if(!M)return!1;let ca=M.bta||M.Ny;if(!ca&&M.Sk)switch(M.Cj){case 0:case 2:case 1:case 3:case 5:case 6:case 8:ca=!0}return ca}static Qhj(M,ca){M=M.AD();if(!M||!ca)return 0;let Na=0;for(const zb of M){if(zb===
ca)break;Na+=zf.ParagraphReader.textLength(Object(C.a)(xh.a,zb))+1}return Na}static gcj(M,ca){if(!jg.Gzg(M)||!ca)return[];var Na=-1;let zb=0;for(let $b of ca){ca=zf.ParagraphReader.Vd($b.node)?zf.ParagraphReader.textLength($b.node):0;if(-1===Na)switch(Na=zf.ParagraphReader.Vd($b.node)?jg.Qhj(M,Object(C.a)(5,$b.node)):0,$b.contextId){case Dh.a.paragraph:break;case Dh.a.textRange:case Dh.a.Of:Na+=$b.Qa;break;case Dh.a.endOfParagraph:Na+=ca;break;default:return[]}switch($b.contextId){case Dh.a.paragraph:zb+=
ca+1;break;case Dh.a.textRange:zb+=Math.max(0,$b.Kb-$b.Qa);break;case Dh.a.endOfParagraph:zb+=1}}return[Na,zb]}}jg.DMf=" ";jg.qjb=169056;jg.Tgk="streamEmpty";jg.Sgk="streamBase64";Object(h.a)(jg,"AppForOfficeApiFacadeEditorImpl",null,[980]);class cj{hkg(M,ca,Na){if(Na.hCa(M))m.ULS.sendTraceTag(512360733,806,10,"[HandlePersistedOwnerApp]This method should not be invoked when OwnerApp already exists.");else if(M=Na.w_b(M)){const zb={};zb.solutionId=M.So.id;zb.version=M.So.version;zb.storeType=M.So.storeType;
zb.storeId=M.So.store;zb.assetId=null;zb.assetStoreId=null;zb.targetType=1;zb.isAddinCommands=!0;zb.addinCommandsActionType=1;zb.sharedRuntimeId=M.Rv?M.Rv.Nwa:null;zb.backgroundState=M.Rv?M.Rv.state:-1;M.settings=ca;Na.UJd.EK().La(lh.a.dSc,2,zb);return!0}return!1}vEj(M,ca){if(!M&&!ca)return!0;if(!M||!ca||Object.keys(M).length!==Object.keys(ca).length)return!1;for(let $b in M){var Na=$b,zb=M[$b];if(!(Na in ca)||ca[Na]!==zb)return!1}return!0}}Object(h.a)(cj,"AppForOfficeAppSettingProxy",null,[]);class oj{constructor(M,
ca,Na,zb){this._id=M;this.Knb=ca;this.I6=Na;this.fyf=zb}get id(){return this._id}get version(){return this.Knb}get store(){return this.I6}get storeType(){return this.fyf}}Object(h.a)(oj,"AppForOfficeReference",null,[979]);class hk{constructor(M,ca){this._id=M;this.RXh=ca}get id(){return this._id}get slideId(){return this.RXh}}Object(h.a)(hk,"AppForOfficeShape",null,[891]);class Vh{constructor(M,ca,Na,zb,$b,Tc=null,hd=!1){this.HMh=M;this.v_h=ca;this.h3a=Na;this.nWh=zb;this.OAd=$b;this.isForUILessAction=
hd;this.WTh=Tc}get $Zf(){return this.HMh}get visibility(){return this.v_h}get width(){return this.h3a}get row(){return this.nWh}get ownerAddinSolutionId(){return this.OAd}get ownerAddinStoreType(){return this.WTh}}Object(h.a)(Vh,"AppForOfficeTaskpane",null,[890]);class Ji{constructor(M,ca,Na,zb=null){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=M;this.controlId=ca;this.ddaBinding=Na;this.ArrayData=zb}getDispid(){return this.dispid}getDdaBinding(){return this.ddaBinding}}
Object(h.a)(Ji,"DdaEventArgs",null,[]);class Bi{constructor(M,ca){this.Jyb=null;this.Zd=M;this.ia=ca}zZd(M){this.Jyb||this.vyk();if(!M||!this.Jyb[M])return null;M=this.Jyb[M];M.re=this.Zd;M.kn=this.ia;return M}MPf(M){const ca=this.Jyb;for(let Na in ca)ca[Na].removeHandler(M)}set(M,ca){this.Jyb[M]=ca}}Object(h.a)(Bi,"ApiEventStore",null,[]);class Eh{constructor(){this.qo=this.ia=this.Zd=null;this.nl={}}get handlers(){return this.nl}get kn(){return this.ia}set kn(M){this.ia=M}get re(){return this.Zd}set re(M){this.Zd=
M}raiseEvent(M,ca=null){M=this.isa(M);if(ca){var Na=this.nl[ca];Na&&Na(M)}else for(Na in ca=this.nl,ca){const zb=ca[Na];zb&&zb(M)}}addHandler(M,ca,Na=null){this.nl[M]=ca;this.i4a(Na)}removeHandler(M,ca,Na=null){delete this.nl[M];this.i4a(Na)}get result(){return this.qo}i4a(M){this.wA(M,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}wA(M,ca){M&&(this.qo={},this.qo[Xi.c_Error]=ca,M(this.qo))}}Object(h.a)(Eh,"ApiEvent",null,[932]);class rh extends Eh{constructor(){super()}isa(M){return M}static get instance(){rh.Dp||
(rh.Dp=new rh);return rh.Dp}}rh.Dp=null;Object(h.a)(rh,"ActivationStatusChangedEvent",Eh,[]);class sg extends Eh{constructor(){super()}isa(){return"view"}static get instance(){sg.Dp||(sg.Dp=new sg);return sg.Dp}}sg.Dp=null;Object(h.a)(sg,"ActiveViewChangedEvent",Eh,[]);var ci=d(101);class dj extends Eh{constructor(){super();this.Wfe=null}isa(){return null}get bra(){!this.Wfe&&this.re&&(this.Wfe=Rf.getInstance(this.re.En));return this.Wfe}addHandler(M,ca,Na=null,zb=null){this.re?this.re.gu.uja()?M in
this.handlers?this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(m.ULS.sendTraceTag(20247126,802,50,"AddHandler was called."),this.showDialog(M,zb,$b=>{$b===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(ci.a.count(this.handlers)||this.bra.D6h(Object(D.a)(this,this.Yxe,"onMessageParentEvent")),this.handlers[M]=ca,this.re.En?({value:$b}=Rf.eig().Rf(M),$b?(this.re.En.setActivationCompletedStatus($b.ng,!0),this.re.wXa(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent.toString(),
$b.ng,!0)):m.ULS.sendTraceTag(24463263,806,15,"Show dialog successed but get dialogInfo failed")):m.ULS.sendTraceTag(24463264,806,15,"Show dialog successed but ContextActivationManager is null"),this.i4a(Na)):(m.ULS.sendTraceTag(20247127,806,10,"Show dialog failed. Error code: {0}",$b.toString()),this.wA(Na,$b))})):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(M,ca,Na=null){this.re?this.re.gu.uja()?
M in this.handlers?(m.ULS.sendTraceTag(20247128,802,50,"RemoveHandler was called."),this.bra.tqi(M,zb=>{delete this.handlers[M];ci.a.count(this.handlers)||this.bra.rfh(Object(D.a)(this,this.Yxe,"onMessageParentEvent"));zb!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&m.ULS.sendTraceTag(20247129,806,10,"Close dialog failed. Error code: {0}",zb.toString());this.wA(Na,zb)})):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):
this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}showDialog(M,ca,Na){try{this.bra.showDialog(ca,M,Na,null)}catch(zb){m.ULS.sendTraceTag(19535264,806,10,"DialogMessageReceivedEvent: Show dialog failed. Exception message: {0}",zb.message),Na(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Yxe(M,ca){if(ca.controlId in this.nl){M={};M[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageType]=ca.messageType;M[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageContent]=
ca.messageContent;M[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.MessageOrigin]=ca.oue;M[OSF.DDA.Marshaling.Dialog.DialogMessageReceivedEventKeys.TargetOrigin]=ca.OJa;const Na=this.nl[ca.controlId];Na&&Na(M);ca.messageType===OSF.DialogMessageType.DialogClosed&&(delete this.nl[ca.controlId],ci.a.count(this.nl)||this.bra.rfh(Object(D.a)(this,this.Yxe,"onMessageParentEvent")))}}static get instance(){dj.Dp||(dj.Dp=new dj);return dj.Dp}}dj.Dp=null;Object(h.a)(dj,"DialogMessageReceivedEvent",
Eh,[]);class Zi extends Eh{constructor(){super()}isa(){return null}addHandler(M,ca,Na=null){this.re?this.re.gu.uja()?(ca=this.re.Psb(M))&&ca.taskpane&&ca.taskpane.isForUILessAction?(this.kn.La(md.a.lmc,2,M),this.i4a(Na)):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(M,ca,Na=null){this.re?this.re.gu.uja()?(ca=this.re.Psb(M))&&ca.taskpane?
ca.taskpane.isForUILessAction?(this.kn.La(md.a.l3b,2,M),this.i4a(Na)):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}}Object(h.a)(Zi,"DialogNotificationShownInAddinEvent",Eh,[]);class Ri extends Eh{constructor(){super();this.En=this.DKd=null}isa(){return null}get bra(){this.DKd||
(this.DKd=Rf.getInstance(this.contextActivationMgr));return this.DKd}get contextActivationMgr(){!this.En&&this.re&&(this.En=this.re.En);return this.En}addHandler(M,ca,Na=null){this.re&&!this.re.gu.uja()?this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):M in this.nl?this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):(ci.a.count(this.nl)||this.bra.C6h(Object(D.a)(this,this.K0g,"onMessageDialogEvent")),this.nl[M]=ca,this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess))}removeHandler(M,
ca,Na=null){this.re&&!this.re.gu.uja()?this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported):M in this.nl?(delete this.nl[M],ci.a.count(this.nl)||this.bra.ZRk(Object(D.a)(this,this.K0g,"onMessageDialogEvent")),this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}K0g(M,ca){ca.controlId in this.nl&&(M={},M[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageType]=ca.messageType,M[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageContent]=
ca.messageContent,M[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.MessageOrigin]=ca.oue,M[OSF.DDA.Marshaling.Dialog.DialogParentMessageReceivedEventKeys.TargetOrigin]=ca.OJa,(ca=this.nl[ca.controlId])&&ca(M))}static get instance(){Ri.Dp||(Ri.Dp=new Ri);return Ri.Dp}}Ri.Dp=null;Object(h.a)(Ri,"DialogParentMessageReceivedEvent",Eh,[]);class Fh extends Eh{constructor(){super()}isa(){return{}}static get instance(){Fh.Dp||(Fh.Dp=new Fh);return Fh.Dp}}Fh.Dp=null;Object(h.a)(Fh,"DocumentSelectionChangedEvent",
Eh,[]);class Rj extends Eh{constructor(){super()}isa(){return null}raiseEvent(M,ca){try{const Na=this.nl[ca];Na&&(ca={},ca[OSF.DDA.Marshaling.ThemingKeys.DocumentTheme.toString()]=M,Na(ca))}catch(Na){lb.a.J(17687447,802,10,"DocumentThemeChanged Event failed, message: "+Na.message)}}static get instance(){Rj.Dp||(Rj.Dp=new Rj);return Rj.Dp}}Rj.Dp=null;Object(h.a)(Rj,"DocumentThemeChangedEvent",Eh,[]);class mh extends Eh{constructor(){super()}isa(){return null}addHandler(M,ca,Na=null){this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}removeHandler(M,
ca,Na=null){this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext)}static get instance(){mh.Dp||(mh.Dp=new mh);return mh.Dp}}mh.Dp=null;Object(h.a)(mh,"OfficeThemeChangedEvent",Eh,[]);class va{constructor(){}}Object(h.a)(va,"RichApiEventManagerHost",null,[933]);class Qa extends Eh{constructor(){super();this.NCd=null}isa(M){return M}addHandler(M,ca,Na=null,zb=null){this.re&&Ea.a(zb)?(this.NCd||(this.NCd=new va(this),OfficeExtension.WacRuntime.RichApi.initEventManagerHost(this.NCd)),
this.nl[M]=ca,this.i4a(Na)):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}removeHandler(M,ca,Na=null,zb=null){this.re&&Ea.a(zb)&&M in this.nl?(delete this.nl[M],this.i4a(Na)):this.wA(Na,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}static get instance(){return Qa.Ja||(Qa.Ja=new Qa)}}Qa.Ja=null;Object(h.a)(Qa,"RichApiMessageEvent",Eh,[]);class db extends Eh{constructor(){super()}isa(M){return M}static get instance(){db.Dp||(db.Dp=new db);return db.Dp}}db.Dp=null;Object(h.a)(db,
"SettingsChangedEvent",Eh,[]);class Gb extends Bi{constructor(M,ca){super(M,ca)}vyk(){this.Jyb={};this.set(OSF.DDA.EventDispId.dispidSettingsChangedEvent,db.instance);this.set(OSF.DDA.EventDispId.dispidActiveViewChangedEvent,sg.instance);this.set(OSF.DDA.EventDispId.dispidActivationStatusChangedEvent,rh.instance);this.set(OSF.DDA.EventDispId.dispidDocumentThemeChangedEvent,Rj.instance);this.set(OSF.DDA.EventDispId.dispidOfficeThemeChangedEvent,mh.instance);this.set(OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent,
Fh.instance);this.set(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,dj.instance);this.set(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Ri.instance);this.set(OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent,new Zi);this.set(OSF.DDA.EventDispId.dispidRichApiMessageEvent,Qa.instance)}}Object(h.a)(Gb,"EditorEventStore",Bi,[]);class jc{constructor(M){this.nac=null;this.Zd=M}j_i(M){this.nac||this.Nyk();if(!M||!this.nac[M])return null;if(M=this.nac[M]())M.re=this.Zd;return M}set(M,
ca){this.nac[M]=ca}}Object(h.a)(jc,"ApiMethodFactory",null,[]);class Ac{constructor(M,ca,Na,zb){this.instanceId=M.toLowerCase();this.fileSize=ca;this.iXd=zb;this.Sth=Na}}Object(h.a)(Ac,"DocumentCopy",null,[]);var W=d(379),xa=d(275);class da extends W.a{constructor(M,ca,Na,zb,$b,Tc,hd){super();this.TA=M.string;this.XG=ca;this.Eka=Na;this.Rda=$b;this.K$j=zb;this.B7b=Tc;this.CTa=hd;this.JWa=Object(D.a)(this,this.xmk,"onGetDocumentCopyChunkFinished");this.onError=Object(D.a)(this,this.wmk,"onGetDocumentCopyChunkError")}start(){this.ejd=
!1;xa.a.mag(this.TA,this.XG,this.Eka,this.K$j,this.Rda,Object(D.a)(this,this.pca,"handleWebserviceResponse"),Object(D.a)(this,this.oca,"handleWebserviceError"))}xmk(M){if(M.cQa){const ca={};M=M.result;ca.value=M.FileData;ca.errorCode=M.ErrorCode;this.B7b(this.XG,ca)}else this.handleError(M)}wmk(M){this.handleError(M)}handleError(M){this.CTa&&(M=M.error,this.CTa(this.XG,!!M&&2===M.type))}}Object(h.a)(da,"GetDocumentCopyChunkTask",W.a,[]);class Fa extends W.a{constructor(M,ca,Na,zb,$b,Tc){super();this.TA=
M.string;this.XG=ca;this.Eka=Na;this.Rda=zb;this.B7b=$b;this.CTa=Tc;this.JWa=Object(D.a)(this,this.zmk,"onGetDocumentCopyFinished");this.onError=Object(D.a)(this,this.ymk,"onGetDocumentCopyError")}start(){this.ejd=!1;xa.a.m4i(this.TA,this.XG,this.Eka,Object(D.a)(this,this.pca,"handleWebserviceResponse"),Object(D.a)(this,this.oca,"handleWebserviceError"))}zmk(M){if(M.cQa){const ca={};M=M.result;ca.fileSize=M.FileSize;ca.errorCode=M.ErrorCode;ca.format=this.Eka;ca.sliceSize=this.Rda;this.B7b(this.XG,
ca)}else this.handleError(M)}ymk(M){this.handleError(M)}handleError(M){this.CTa&&(M=M.error,this.CTa(this.XG,!!M&&2===M.type))}}Object(h.a)(Fa,"GetDocumentCopyTask",W.a,[]);class Ua extends W.a{constructor(M,ca,Na,zb,$b,Tc,hd){super();this.TA=M.string;this.XG=ca;this.Eka=Na;this.U5j=zb;this.T5j=$b;this.B7b=Tc;this.CTa=hd;this.JWa=Object(D.a)(this,this.Cpk,"onReleaseDocumentCopyFinished");this.onError=Object(D.a)(this,this.Bpk,"onReleaseDocumentCopyError")}start(){this.ejd=!1;xa.a.jjc(this.TA,this.XG,
this.Eka,this.U5j,this.T5j,Object(D.a)(this,this.pca,"handleWebserviceResponse"),Object(D.a)(this,this.oca,"handleWebserviceError"))}Cpk(M){if(M.cQa){const ca={};ca.errorCode=M.result.ErrorCode;this.B7b(this.XG,ca)}else this.handleError(M)}Bpk(M){this.handleError(M)}handleError(M){this.CTa&&(M=M.error,this.CTa(this.XG,!!M&&2===M.type))}}Object(h.a)(Ua,"ReleaseGetDocumentCopyTask",W.a,[]);class cb{constructor(){this.B5c=null}start(){this.B5c.start()}static Jzi(M,ca,Na,zb,$b,Tc){const hd=new cb;hd.B5c=
new Fa(M,ca,Na,zb,$b,Tc);return hd}static Izi(M,ca,Na,zb,$b,Tc,hd){const Hd=new cb;Hd.B5c=new da(M,ca,Na,zb,$b,Tc,hd);return Hd}static gVf(M,ca,Na,zb,$b,Tc,hd){const Hd=new cb;Hd.B5c=new Ua(M,ca,Na,zb,$b,Tc,hd);return Hd}}Object(h.a)(cb,"AppForOfficeTask",null,[]);class Jb{constructor(){this.Che=1;this.s4e=new yb.a}get eCa(){return this.s4e}Eji(M,ca,Na,zb){const $b=this.ldg();M=new Ac(M,ca,Na,zb);this.eCa.$($b.toString(),M);return $b}Qug(M,ca){for(let Na of this.eCa){const zb=Na.value;if(zb.instanceId===
M.toLowerCase()&&zb.iXd===ca)return!0}return!1}r9f(M){return this.eCa.ga(M.toString())}tPk(M){this.eCa.remove(M.toString())}jjc(M,ca,Na,zb){(zb&&this.uPk(ca)||Na&&this.lPk())&&cb.gVf(M,ca,4,Na,zb,()=>{},()=>{}).start()}lPk(){let M=!1;0<this.eCa.count&&(this.s4e=new yb.a,M=!0);return M}uPk(M){if(!M)return!1;const ca=[];for(let Na of this.eCa)Na.value.instanceId===M.toLowerCase()&&ca.push(Na.key);for(M=0;M<ca.length;M++)this.eCa.remove(ca[M]);return 0<ca.length}ldg(){return this.Che++}}Object(h.a)(Jb,
"GetDocumentCopyHelper",null,[844]);class Gc{constructor(M,ca){this.JIg=ca.length;this.Rda=M;this.J$j=Math.ceil(this.JIg/M);this.Kwi(ca)}Kwi(M){for(let ca=0;ca<this.J$j;ca++){const Na=ca*this.Rda;M.slice(Na,Math.min(Na+this.Rda,this.JIg))}}}Object(h.a)(Gc,"DocumentCopyCache",null,[]);class pd{constructor(){this.Gpe=this.fqe=null;this.Hpe=this.gqe=0}add(M,ca,Na,zb){4===ca?(this.gqe=M,this.fqe=new Gc(Na,zb)):3===ca&&(this.Hpe=M,this.Gpe=new Gc(Na,zb))}remove(M){this.gqe===M?(this.gqe=0,this.fqe=null):
this.Hpe===M&&(this.Hpe=0,this.Gpe=null)}contains(M){return 4===M&&!!this.fqe||3===M&&!!this.Gpe}}Object(h.a)(pd,"PerAppCache",null,[]);class Ld{get cache(){return Ld.hi}get jXd(){return Ld.$2j}Qug(M,ca){return M in this.cache&&this.cache[M].contains(ca)}mag(){}jjc(M){if(M.toString()in this.jXd){const ca=this.jXd[M.toString()];delete this.jXd[M.toString()];this.cache[ca].remove(M)}}ldg(){return Ld.Che++}}Ld.hi={};Ld.$2j={};Ld.Che=1;Object(h.a)(Ld,"GetFileApiProxy",null,[961]);class de{constructor(M,
ca,Na){this.uh=0;this.controlId=this.eza=this.$D=this.Vxb=this.Zd=this.qo=null;this.parameters=M;this.callback=ca;this.T8h=Na;new Ld;this.s$a=new cj;this.nUa=new Jb}get gCc(){this.s$a||(this.s$a=new cj);return this.s$a}get cca(){return this.nUa}get nZk(){this.$D||(this.$D=Ub.a.instance.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"));return this.$D}get fvj(){return this.eza||(this.eza=Ub.a.instance.Ka("Postmessage.IHostPostmessenger"))}get errorCode(){return this.uh}set errorCode(M){this.uh=
M}get result(){return this.qo}set result(M){this.qo=M}get gu(){return this.Vxb}get re(){return this.Zd}set re(M){(this.Zd=M)?(this.Vxb=this.Zd.gu,this.nUa=this.Zd.cca):this.nUa=this.Vxb=null}go(){this.qo={};try{this.Pq()}catch(M){this.sXj(M)}this.qH()}sXj(M){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;lb.a.J(18396573,802,10,"Error when executing API: {0}",M.toString())}qH(){this.uh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&lb.a.J(18985232,802,10,"Error when API method failed. m_errorCode = {0}",
this.uh);this.qo[Xi.c_Error]=this.uh;this.callback(this.qo)}BZd(){return this.controlId?this.re?this.re.RZ.UV(this.controlId):null:null}p_i(){if(!this.controlId)return null;let M=null;this.re&&(M=this.re.RZ.UV(this.controlId));return M?0===M.yy?this.re.$4f(M.shape.slideId,M.shape.id):1===M.yy?this.re.hCa(M.So.id):null:null}T3d(M){return M?this.re?this.re.T3d(M):null:null}}Object(h.a)(de,"ApiMethod",null,[]);class Be extends de{constructor(){super()}Pq(){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(this.parameters[O.a.I8h][O.a.H8h],
this.parameters);this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}get description(){return"Run AddinCommandsRuntimeManager InvocationCompleted."}}Object(h.a)(Be,"AppCommandInvocationCompletedMethod",de,[]);class Mf extends de{constructor(){super()}go(){this.qo={};this.Pq()}Pq(){if(this.gu)try{const M=this.parameters[OSF.DDA.Marshaling.CreateDocument.Base64].toString();M&&M.length>this.re.UJd.ld.pptEditorAppsForOfficeCreateDocumentApiMaxAllowedBase64?(m.ULS.sendTraceTag(587747342,802,15,"Too large base64 stream size:{0}",
M.length),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam,this.qH()):this.gu.W4a(M,Object(D.a)(this,this.ezi,"createDocumentSuccessCallback"),Object(D.a)(this,this.dzi,"createDocumentFailCallback"))}catch(M){lb.a.J(35156300,802,10,"Exception thrown at CreateDocumentMethod: "+M.toString()),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.qH()}else this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.qH()}ezi(M){const ca=new y.StandardDialog;ca.yd=4;ca.nx(CommonUIStrings.l_GeneralAddInMessageDialogTitle,
CommonUIStrings.l_OpenWindowConsentMessage,1,Na=>{1===Na&&window.open(M);this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess;this.qH()})}dzi(M){this.uh=M?M:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.qH()}get description(){return"Create a new ppt document in the user's default folder."}}Object(h.a)(Mf,"CreateDocumentMethod",de,[]);var Dg=d(94),yd=d(87);class td{static sKk(M){const ca=new Map;ca.set("ApiId",M.toString());Dg.Health.instance.recordKpiUsage(td.Ijh,1,td.Ejh,ca)}static rKk(M,
ca,Na){const zb=new Map;zb.set("ApiId",M.toString());M=Object.assign(new yd.a,{extendedProperties:zb,durationMs:td.uag(ca,Na)});Dg.Health.instance.recordKpiSuccess(td.Ijh,M)}static Kch(M){const ca=new Map;ca.set("fWacPartition",M.toString());Dg.Health.instance.recordKpiUsage(td.Jjh,1,td.Ejh,ca)}static $Ee(M,ca){M=Object.assign(new yd.a,{durationMs:td.uag(M,ca)});Dg.Health.instance.recordKpiSuccess(td.Jjh,M)}static uag(M,ca){let Na=null;M&&ca&&(Na=ca-M);return Na}}td.Ijh="PptApiCall";td.Jjh="PptApiRequest";
td.Ejh="pptom";Object(h.a)(td,"PptWacApiTelemetry",null,[]);class id{constructor(){this.ver=0;this.exec=this.sel=null}}Object(h.a)(id,"ApiRequest",null,[]);class ed{constructor(){this.txRn=this.shpLst=this.sldLst=null}}Object(h.a)(ed,"SelectionData",null,[]);const Oc=(M,ca)=>{var Na=Object,zb=Na.assign,$b=new id,Tc=Object,hd=Tc.assign,Hd=new ed,le=M.gu.nf();const ge=[];if(le){ge.length=le.length;for(var Zd=0;Zd<le.length;Zd++)ge[Zd]=le[Zd].Bb.toString()}le=M.gu.Yd();Zd=[];if(le){Zd.length=le.length;
for(let Oe=0;Oe<le.length;Oe++)Zd[Oe]=le[Oe].get_shapeId().toString()}M=zb.call(Na,$b,{ver:1,exec:ca,sel:hd.call(Tc,Hd,{sldLst:ge,shpLst:Zd,txRn:M.gu.iej()})});return Sys.Serialization.JavaScriptSerializer.serialize(M)},Wl=M=>{let ca,Na;ca=M.addType("Microsoft.Office.PowerPoint.Application","{549654b5-691c-491b-bed1-3eccfa85e525}","{64189aae-7617-40e1-ba92-365392bd2387}",3,0);Na=ca.addMethod("InsertHyperLink",1001,"Void",0,0,"InsertHyperLink",4);Na.addParameter("address","String",1,null,0);Na.addParameter("displayName",
"String",1,null,0);Na=ca.addMethod("InsertSlideFromContent",1002,"Microsoft.Office.PowerPoint.InsertSlideReturnCode",1,0,"InsertSlideFromContent",4);Na.addParameter("slideContent","String",1,null,0);ca=M.addType("Microsoft.Office.PowerPoint.Presentation","{a8af8473-88c1-49d7-a986-565cb7100e9e}","",3,0);ca.addProperty("SlideMasters",3,"Microsoft.Office.PowerPoint.SlideMasterCollection",3,!0,null,0);ca.addProperty("Slides",2,"Microsoft.Office.PowerPoint.SlideCollection",3,!0,null,0);ca.addProperty("Tags",
4,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ca.addProperty("Title",1,"String",1,!0,null,0);ca.addMethod("GetSelectedShapes",5,"Microsoft.Office.PowerPoint.ShapeScopedCollection",3,0,"SelectedShapes",0);ca.addMethod("GetSelectedSlides",6,"Microsoft.Office.PowerPoint.SlideScopedCollection",3,0,"SelectedSlides",0);ca.addMethod("GetSelectedTextRange",7,"Microsoft.Office.PowerPoint.TextRange",3,0,"SelectedTextRange",0);ca.addMethod("GetSelectedTextRangeOrNullObject",9,"Microsoft.Office.PowerPoint.TextRange",
3,0,"SelectedTextRangeOrNullObject",0);Na=ca.addMethod("InsertSlidesFromBase64",1003,"Void",0,0,"InsertSlidesFromBase64",0);Na.addParameter("base64File","String",1,null,0);Na.addParameter("options","Microsoft.Office.PowerPoint.InsertSlideOptions",2,null,0);Na=ca.addMethod("SetSelectedSlides",8,"Void",0,0,"SetSelectedSlides",0);Na.addParameter("slideIds","String[]",1,null,0);Na=ca.addMethod("_RegisterEvent",1001,"Void",0,1,"_RegisterEvent",0);Na.addParameter("referenceId","String",1,null,0);Na.addParameter("eventType",
"Int32",1,null,0);Na=ca.addMethod("_UnregisterEvent",1002,"Void",0,1,"_UnregisterEvent",0);Na.addParameter("referenceId","String",1,null,0);Na.addParameter("eventType","Int32",1,null,0);ca=M.addType("Microsoft.Office.PowerPoint.AddSlideOptions","{171a8d61-4952-4d67-b7e1-0197ac277d6a}","{af133e5f-ae0b-4a2b-8316-7b26d0a6b4f6}",2,0);ca.addProperty("LayoutId",1,"String",1,!1,null,0);ca.addProperty("SlideMasterId",2,"String",1,!1,null,0);ca=M.addType("Microsoft.Office.PowerPoint.BulletFormat","{43bd46c0-809f-4417-b22c-84e44ab6e592}",
"",3,0);ca.addProperty("Visible",2,"Boolean",1,!1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=M.addEnumType("Microsoft.Office.PowerPoint.ConnectorType");ca.addEnumField("Straight",0);ca.addEnumField("Elbow",1);ca.addEnumField("Curve",2);ca=M.addEnumType("Microsoft.Office.PowerPoint.GeometricShapeType");ca.addEnumField("LineInverse",0);ca.addEnumField("Triangle",1);ca.addEnumField("RightTriangle",2);ca.addEnumField("Rectangle",3);ca.addEnumField("Diamond",4);ca.addEnumField("Parallelogram",
5);ca.addEnumField("Trapezoid",6);ca.addEnumField("NonIsoscelesTrapezoid",7);ca.addEnumField("Pentagon",8);ca.addEnumField("Hexagon",9);ca.addEnumField("Heptagon",10);ca.addEnumField("Octagon",11);ca.addEnumField("Decagon",12);ca.addEnumField("Dodecagon",13);ca.addEnumField("Star4",14);ca.addEnumField("Star5",15);ca.addEnumField("Star6",16);ca.addEnumField("Star7",17);ca.addEnumField("Star8",18);ca.addEnumField("Star10",19);ca.addEnumField("Star12",20);ca.addEnumField("Star16",21);ca.addEnumField("Star24",
22);ca.addEnumField("Star32",23);ca.addEnumField("RoundRectangle",24);ca.addEnumField("Round1Rectangle",25);ca.addEnumField("Round2SameRectangle",26);ca.addEnumField("Round2DiagonalRectangle",27);ca.addEnumField("SnipRoundRectangle",28);ca.addEnumField("Snip1Rectangle",29);ca.addEnumField("Snip2SameRectangle",30);ca.addEnumField("Snip2DiagonalRectangle",31);ca.addEnumField("Plaque",32);ca.addEnumField("Ellipse",33);ca.addEnumField("Teardrop",34);ca.addEnumField("HomePlate",35);ca.addEnumField("Chevron",
36);ca.addEnumField("PieWedge",37);ca.addEnumField("Pie",38);ca.addEnumField("BlockArc",39);ca.addEnumField("Donut",40);ca.addEnumField("NoSmoking",41);ca.addEnumField("RightArrow",42);ca.addEnumField("LeftArrow",43);ca.addEnumField("UpArrow",44);ca.addEnumField("DownArrow",45);ca.addEnumField("StripedRightArrow",46);ca.addEnumField("NotchedRightArrow",47);ca.addEnumField("BentUpArrow",48);ca.addEnumField("LeftRightArrow",49);ca.addEnumField("UpDownArrow",50);ca.addEnumField("LeftUpArrow",51);ca.addEnumField("LeftRightUpArrow",
52);ca.addEnumField("QuadArrow",53);ca.addEnumField("LeftArrowCallout",54);ca.addEnumField("RightArrowCallout",55);ca.addEnumField("UpArrowCallout",56);ca.addEnumField("DownArrowCallout",57);ca.addEnumField("LeftRightArrowCallout",58);ca.addEnumField("UpDownArrowCallout",59);ca.addEnumField("QuadArrowCallout",60);ca.addEnumField("BentArrow",61);ca.addEnumField("UturnArrow",62);ca.addEnumField("CircularArrow",63);ca.addEnumField("LeftCircularArrow",64);ca.addEnumField("LeftRightCircularArrow",65);
ca.addEnumField("CurvedRightArrow",66);ca.addEnumField("CurvedLeftArrow",67);ca.addEnumField("CurvedUpArrow",68);ca.addEnumField("CurvedDownArrow",69);ca.addEnumField("SwooshArrow",70);ca.addEnumField("Cube",71);ca.addEnumField("Can",72);ca.addEnumField("LightningBolt",73);ca.addEnumField("Heart",74);ca.addEnumField("Sun",75);ca.addEnumField("Moon",76);ca.addEnumField("SmileyFace",77);ca.addEnumField("IrregularSeal1",78);ca.addEnumField("IrregularSeal2",79);ca.addEnumField("FoldedCorner",80);ca.addEnumField("Bevel",
81);ca.addEnumField("Frame",82);ca.addEnumField("HalfFrame",83);ca.addEnumField("Corner",84);ca.addEnumField("DiagonalStripe",85);ca.addEnumField("Chord",86);ca.addEnumField("Arc",87);ca.addEnumField("LeftBracket",88);ca.addEnumField("RightBracket",89);ca.addEnumField("LeftBrace",90);ca.addEnumField("RightBrace",91);ca.addEnumField("BracketPair",92);ca.addEnumField("BracePair",93);ca.addEnumField("Callout1",94);ca.addEnumField("Callout2",95);ca.addEnumField("Callout3",96);ca.addEnumField("AccentCallout1",
97);ca.addEnumField("AccentCallout2",98);ca.addEnumField("AccentCallout3",99);ca.addEnumField("BorderCallout1",100);ca.addEnumField("BorderCallout2",101);ca.addEnumField("BorderCallout3",102);ca.addEnumField("AccentBorderCallout1",103);ca.addEnumField("AccentBorderCallout2",104);ca.addEnumField("AccentBorderCallout3",105);ca.addEnumField("WedgeRectCallout",106);ca.addEnumField("WedgeRRectCallout",107);ca.addEnumField("WedgeEllipseCallout",108);ca.addEnumField("CloudCallout",109);ca.addEnumField("Cloud",
110);ca.addEnumField("Ribbon",111);ca.addEnumField("Ribbon2",112);ca.addEnumField("EllipseRibbon",113);ca.addEnumField("EllipseRibbon2",114);ca.addEnumField("LeftRightRibbon",115);ca.addEnumField("VerticalScroll",116);ca.addEnumField("HorizontalScroll",117);ca.addEnumField("Wave",118);ca.addEnumField("DoubleWave",119);ca.addEnumField("Plus",120);ca.addEnumField("FlowChartProcess",121);ca.addEnumField("FlowChartDecision",122);ca.addEnumField("FlowChartInputOutput",123);ca.addEnumField("FlowChartPredefinedProcess",
124);ca.addEnumField("FlowChartInternalStorage",125);ca.addEnumField("FlowChartDocument",126);ca.addEnumField("FlowChartMultidocument",127);ca.addEnumField("FlowChartTerminator",128);ca.addEnumField("FlowChartPreparation",129);ca.addEnumField("FlowChartManualInput",130);ca.addEnumField("FlowChartManualOperation",131);ca.addEnumField("FlowChartConnector",132);ca.addEnumField("FlowChartPunchedCard",133);ca.addEnumField("FlowChartPunchedTape",134);ca.addEnumField("FlowChartSummingJunction",135);ca.addEnumField("FlowChartOr",
136);ca.addEnumField("FlowChartCollate",137);ca.addEnumField("FlowChartSort",138);ca.addEnumField("FlowChartExtract",139);ca.addEnumField("FlowChartMerge",140);ca.addEnumField("FlowChartOfflineStorage",141);ca.addEnumField("FlowChartOnlineStorage",142);ca.addEnumField("FlowChartMagneticTape",143);ca.addEnumField("FlowChartMagneticDisk",144);ca.addEnumField("FlowChartMagneticDrum",145);ca.addEnumField("FlowChartDisplay",146);ca.addEnumField("FlowChartDelay",147);ca.addEnumField("FlowChartAlternateProcess",
148);ca.addEnumField("FlowChartOffpageConnector",149);ca.addEnumField("ActionButtonBlank",150);ca.addEnumField("ActionButtonHome",151);ca.addEnumField("ActionButtonHelp",152);ca.addEnumField("ActionButtonInformation",153);ca.addEnumField("ActionButtonForwardNext",154);ca.addEnumField("ActionButtonBackPrevious",155);ca.addEnumField("ActionButtonEnd",156);ca.addEnumField("ActionButtonBeginning",157);ca.addEnumField("ActionButtonReturn",158);ca.addEnumField("ActionButtonDocument",159);ca.addEnumField("ActionButtonSound",
160);ca.addEnumField("ActionButtonMovie",161);ca.addEnumField("Gear6",162);ca.addEnumField("Gear9",163);ca.addEnumField("Funnel",164);ca.addEnumField("MathPlus",165);ca.addEnumField("MathMinus",166);ca.addEnumField("MathMultiply",167);ca.addEnumField("MathDivide",168);ca.addEnumField("MathEqual",169);ca.addEnumField("MathNotEqual",170);ca.addEnumField("CornerTabs",171);ca.addEnumField("SquareTabs",172);ca.addEnumField("PlaqueTabs",173);ca.addEnumField("ChartX",174);ca.addEnumField("ChartStar",175);
ca.addEnumField("ChartPlus",176);ca=M.addEnumType("Microsoft.Office.PowerPoint.InsertSlideFormatting");ca.addEnumField("KeepSourceFormatting",0);ca.addEnumField("UseDestinationTheme",1);ca=M.addType("Microsoft.Office.PowerPoint.InsertSlideOptions","{9ca3e504-5701-467b-9596-15521056bac3}","{806c3519-08f4-41ba-b0d9-3c323c51c3e9}",2,0);ca.addProperty("Formatting",1,"Microsoft.Office.PowerPoint.InsertSlideFormatting",1,!1,null,0);ca.addProperty("SourceSlideIds",4,"String[]",1,!1,null,0);ca.addProperty("TargetSlideId",
5,"String",1,!1,null,0);ca=M.addEnumType("Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment");ca.addEnumField("Left",0);ca.addEnumField("Center",1);ca.addEnumField("Right",2);ca.addEnumField("Justify",3);ca.addEnumField("JustifyLow",4);ca.addEnumField("Distributed",5);ca.addEnumField("ThaiDistributed",6);ca=M.addType("Microsoft.Office.PowerPoint.ParagraphFormat","{c164d05d-7a4f-409f-8a5e-ef5f1d2ffa54}","",3,0);ca.addProperty("BulletFormat",1,"Microsoft.Office.PowerPoint.BulletFormat",3,!0,
null,0);ca.addProperty("HorizontalAlignment",2,"Microsoft.Office.PowerPoint.ParagraphHorizontalAlignment",1,!1,null,0);ca.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.Office.PowerPoint.ShapeAddOptions","{b75ad347-9abe-4531-a338-3ba7a70bf9e1}","{2b45cbde-9fbf-4aa2-9972-5508e4c99ad8}",2,0);ca.addProperty("Height",1,"Double",1,!1,null,0);ca.addProperty("Left",2,"Double",1,!1,null,0);ca.addProperty("Top",3,"Double",1,!1,null,0);ca.addProperty("Width",4,"Double",1,!1,null,
0);ca=M.addType("Microsoft.Office.PowerPoint.ShapeCollection","{27a07ec1-bcc6-45bf-9c60-07250facfbca}","",3,0);Na=ca.addMethod("AddGeometricShape",6,"Microsoft.Office.PowerPoint.Shape",3,0,"AddGeometricShape",0);Na.addParameter("geometricShapeType","Microsoft.Office.PowerPoint.GeometricShapeType",1,null,0);Na.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Na=ca.addMethod("AddLine",7,"Microsoft.Office.PowerPoint.Shape",3,0,"AddLine",0);Na.addParameter("connectorType",
"Microsoft.Office.PowerPoint.ConnectorType",1,null,0);Na.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);Na=ca.addMethod("AddTextBox",8,"Microsoft.Office.PowerPoint.Shape",3,0,"AddTextBox",0);Na.addParameter("text","String",1,null,0);Na.addParameter("options","Microsoft.Office.PowerPoint.ShapeAddOptions",2,null,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Na=ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Shape",3,0);Na.addParameter("key","String",1,null,0);
Na=ca.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Na.addParameter("index","Int32",1,null,0);Na=ca.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Na.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);ca=M.addType("Microsoft.Office.PowerPoint.SlideLayout","{4494143a-d362-45fd-89c6-506e97741384}","",3,0);ca.addProperty("Id",
1,"String",1,!0,null,0);ca.addProperty("Name",3,"String",1,!0,null,0);ca.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.Office.PowerPoint.SlideLayoutCollection","{8f09fea3-67af-49f9-b42a-0a8f8cd02615}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Na=ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.SlideLayout",3,0);Na.addParameter("key","String",1,null,0);Na=ca.addMethod("GetItemAt",
3,"Microsoft.Office.PowerPoint.SlideLayout",3,1,"ItemAt",0);Na.addParameter("index","Int32",1,null,0);Na=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ItemOrNullObject",0);Na.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.SlideLayout",!0);ca=M.addType("Microsoft.Office.PowerPoint.SlideMaster","{4a835b29-4422-4659-ab73-2e1e0096e7c1}","",3,0);ca.addProperty("Id",1,"String",
1,!0,null,0);ca.addProperty("Layouts",3,"Microsoft.Office.PowerPoint.SlideLayoutCollection",3,!0,null,0);ca.addProperty("Name",4,"String",1,!0,null,0);ca.addProperty("Shapes",5,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.Office.PowerPoint.Tag","{f26bc228-f6da-40de-b9ef-2a57ad2b5162}","",3,0);ca.addProperty("Key",2,"String",1,!0,null,0);ca.addProperty("Value",3,"String",1,!1,null,0);ca.addMethod("_OnAccess",
1,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.Office.PowerPoint.TagCollection","{edf01799-a99c-4e57-94f2-5830600f5da4}","",3,0);Na=ca.addMethod("Add",1,"Void",0,0,"Add",0);Na.addParameter("key","String",1,null,0);Na.addParameter("value","String",1,null,0);Na=ca.addMethod("Delete",2,"Void",0,0,"Delete",0);Na.addParameter("key","String",1,null,0);ca.addMethod("GetCount",3,"Int32",1,1,"Count",0);Na=ca.addIndexerMethod(4,"Microsoft.Office.PowerPoint.Tag",3,0);Na.addParameter("key","String",1,null,
0);Na=ca.addMethod("GetItemAt",5,"Microsoft.Office.PowerPoint.Tag",3,1,"ItemAt",0);Na.addParameter("index","Int32",1,null,0);Na=ca.addMethod("GetItemOrNullObject",6,"Microsoft.Office.PowerPoint.Tag",3,0,"ItemOrNullObject",0);Na.addParameter("key","String",1,null,0);ca.addMethod("_OnAccess",7,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Tag",!0);ca=M.addType("Microsoft.Office.PowerPoint.Slide","{61c859a3-9c46-44a7-a415-aeb6f43a1dc7}","",3,0);ca.addProperty("Id",1,"String",
1,!0,null,0);ca.addProperty("Layout",5,"Microsoft.Office.PowerPoint.SlideLayout",3,!0,null,0);ca.addProperty("Shapes",4,"Microsoft.Office.PowerPoint.ShapeCollection",3,!0,null,0);ca.addProperty("SlideMaster",6,"Microsoft.Office.PowerPoint.SlideMaster",3,!0,null,0);ca.addProperty("Tags",7,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ca.addMethod("Delete",3,"Void",0,0,"Delete",0);Na=ca.addMethod("SetSelectedShapes",8,"Void",0,0,"SetSelectedShapes",0);Na.addParameter("shapeIds","String[]",
1,null,0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=M.addEnumType("Microsoft.Office.PowerPoint.ShapeFillType");ca.addEnumField("NoFill",0);ca.addEnumField("Solid",1);ca.addEnumField("Gradient",2);ca.addEnumField("Pattern",3);ca.addEnumField("PictureAndTexture",4);ca.addEnumField("SlideBackground",5);ca=M.addType("Microsoft.Office.PowerPoint.ShapeFill","{2df31ab1-fa27-4e46-9704-1fb3f49bed4b}","",3,0);ca.addProperty("ForegroundColor",2,"String",1,!1,null,0);ca.addProperty("Transparency",
5,"Double",1,!1,null,0);ca.addProperty("Type",6,"Microsoft.Office.PowerPoint.ShapeFillType",1,!0,null,0);ca.addMethod("Clear",1,"Void",0,0,"Clear",0);Na=ca.addMethod("SetSolidColor",4,"Void",0,0,"SetSolidColor",0);Na.addParameter("color","String",1,null,0);ca.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ca=M.addEnumType("Microsoft.Office.PowerPoint.ShapeLineStyle");ca.addEnumField("Single",0);ca.addEnumField("ThickBetweenThin",1);ca.addEnumField("ThickThin",2);ca.addEnumField("ThinThick",3);
ca.addEnumField("ThinThin",4);ca=M.addEnumType("Microsoft.Office.PowerPoint.ShapeLineDashStyle");ca.addEnumField("Dash",0);ca.addEnumField("DashDot",1);ca.addEnumField("DashDotDot",2);ca.addEnumField("LongDash",3);ca.addEnumField("LongDashDot",4);ca.addEnumField("RoundDot",5);ca.addEnumField("Solid",6);ca.addEnumField("SquareDot",7);ca.addEnumField("LongDashDotDot",8);ca.addEnumField("SystemDash",9);ca.addEnumField("SystemDot",10);ca.addEnumField("SystemDashDot",11);ca=M.addType("Microsoft.Office.PowerPoint.ShapeLineFormat",
"{f275eab8-4363-41e8-b11a-e41e3c725f21}","",3,0);ca.addProperty("Color",1,"String",1,!1,null,0);ca.addProperty("DashStyle",2,"Microsoft.Office.PowerPoint.ShapeLineDashStyle",1,!1,null,0);ca.addProperty("Style",4,"Microsoft.Office.PowerPoint.ShapeLineStyle",1,!1,null,0);ca.addProperty("Transparency",5,"Double",1,!1,null,0);ca.addProperty("Visible",6,"Boolean",1,!1,null,0);ca.addProperty("Weight",7,"Double",1,!1,null,0);ca.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ca=M.addEnumType("Microsoft.Office.PowerPoint.ShapeType");
ca.addEnumField("Unsupported",0);ca.addEnumField("Image",1);ca.addEnumField("GeometricShape",2);ca.addEnumField("Group",3);ca.addEnumField("Line",4);ca=M.addEnumType("Microsoft.Office.PowerPoint.ShapeAutoSize");ca.addEnumField("AutoSizeNone",0);ca.addEnumField("AutoSizeTextToFitShape",1);ca.addEnumField("AutoSizeShapeToFitText",2);ca.addEnumField("AutoSizeMixed",3);ca=M.addEnumType("Microsoft.Office.PowerPoint.TextVerticalAlignment");ca.addEnumField("Top",0);ca.addEnumField("Middle",1);ca.addEnumField("Bottom",
2);ca.addEnumField("TopCentered",3);ca.addEnumField("MiddleCentered",4);ca.addEnumField("BottomCentered",5);ca=M.addEnumType("Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle");ca.addEnumField("None",0);ca.addEnumField("Single",1);ca.addEnumField("Double",2);ca.addEnumField("Heavy",3);ca.addEnumField("Dotted",4);ca.addEnumField("DottedHeavy",5);ca.addEnumField("Dash",6);ca.addEnumField("DashHeavy",7);ca.addEnumField("DashLong",8);ca.addEnumField("DashLongHeavy",9);ca.addEnumField("DotDash",10);
ca.addEnumField("DotDashHeavy",11);ca.addEnumField("DotDotDash",12);ca.addEnumField("DotDotDashHeavy",13);ca.addEnumField("Wavy",14);ca.addEnumField("WavyHeavy",15);ca.addEnumField("WavyDouble",16);ca=M.addType("Microsoft.Office.PowerPoint.ShapeFont","{06c9e9fa-f317-4016-b9f4-aea94e9690f4}","",3,0);ca.addProperty("Bold",1,"Boolean",1,!1,null,0);ca.addProperty("Color",2,"String",1,!1,null,0);ca.addProperty("Italic",3,"Boolean",1,!1,null,0);ca.addProperty("Name",5,"String",1,!1,null,0);ca.addProperty("Size",
6,"Double",1,!1,null,0);ca.addProperty("Underline",7,"Microsoft.Office.PowerPoint.ShapeFontUnderlineStyle",1,!1,null,0);ca.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.Office.PowerPoint.TextRange","{1eb59e56-2d48-4b16-b3bb-4fe7debe51c2}","",3,0);ca.addProperty("Font",1,"Microsoft.Office.PowerPoint.ShapeFont",3,!0,null,0);ca.addProperty("Length",7,"Int32",1,!1,null,0);ca.addProperty("ParagraphFormat",4,"Microsoft.Office.PowerPoint.ParagraphFormat",3,!0,null,0);ca.addProperty("Start",
9,"Int32",1,!1,null,0);ca.addProperty("Text",5,"String",1,!1,null,0);ca.addMethod("GetParentTextFrame",10,"Microsoft.Office.PowerPoint.TextFrame",3,0,"ParentTextFrame",0);Na=ca.addMethod("GetSubstring",2,"Microsoft.Office.PowerPoint.TextRange",3,0,"Substring",0);Na.addParameter("start","Int32",1,null,0);Na.addParameter("length","Int32",1,null,0);ca.addMethod("SetSelected",8,"Void",0,0,"SetSelected",0);ca.addMethod("_OnAccess",3,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.Office.PowerPoint.TextFrame",
"{b5929948-a2b9-4816-8e79-fe9deef82e48}","",3,0);ca.addProperty("AutoSizeSetting",1,"Microsoft.Office.PowerPoint.ShapeAutoSize",1,!1,null,0);ca.addProperty("BottomMargin",2,"Double",1,!1,null,0);ca.addProperty("HasText",4,"Boolean",1,!0,null,0);ca.addProperty("LeftMargin",6,"Double",1,!1,null,0);ca.addProperty("RightMargin",7,"Double",1,!1,null,0);ca.addProperty("TextRange",8,"Microsoft.Office.PowerPoint.TextRange",3,!0,null,0);ca.addProperty("TopMargin",9,"Double",1,!1,null,0);ca.addProperty("VerticalAlignment",
10,"Microsoft.Office.PowerPoint.TextVerticalAlignment",1,!1,null,0);ca.addProperty("WordWrap",11,"Boolean",1,!1,null,0);ca.addMethod("DeleteText",3,"Void",0,0,"DeleteText",0);ca.addMethod("GetParentShape",13,"Microsoft.Office.PowerPoint.Shape",3,0,"ParentShape",0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.Office.PowerPoint.Shape","{62ed0f8f-a9ce-46bd-8ad2-61634aee155d}","",3,0);ca.addProperty("Fill",11,"Microsoft.Office.PowerPoint.ShapeFill",3,!0,null,0);ca.addProperty("Height",
5,"Double",1,!1,null,0);ca.addProperty("Id",1,"String",1,!0,null,0);ca.addProperty("Left",6,"Double",1,!1,null,0);ca.addProperty("LineFormat",12,"Microsoft.Office.PowerPoint.ShapeLineFormat",3,!0,null,0);ca.addProperty("Name",7,"String",1,!1,null,0);ca.addProperty("Tags",3,"Microsoft.Office.PowerPoint.TagCollection",3,!0,null,0);ca.addProperty("TextFrame",13,"Microsoft.Office.PowerPoint.TextFrame",3,!0,null,0);ca.addProperty("Top",8,"Double",1,!1,null,0);ca.addProperty("Type",9,"Microsoft.Office.PowerPoint.ShapeType",
1,!0,null,0);ca.addProperty("Width",10,"Double",1,!1,null,0);ca.addMethod("Delete",4,"Void",0,0,"Delete",0);ca.addMethod("GetParentSlide",15,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlide",0);ca.addMethod("GetParentSlideLayout",16,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayout",0);ca.addMethod("GetParentSlideLayoutOrNullObject",18,"Microsoft.Office.PowerPoint.SlideLayout",3,0,"ParentSlideLayoutOrNullObject",0);ca.addMethod("GetParentSlideMaster",17,"Microsoft.Office.PowerPoint.SlideMaster",
3,0,"ParentSlideMaster",0);ca.addMethod("GetParentSlideMasterOrNullObject",19,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ParentSlideMasterOrNullObject",0);ca.addMethod("GetParentSlideOrNullObject",20,"Microsoft.Office.PowerPoint.Slide",3,0,"ParentSlideOrNullObject",0);ca.addMethod("_OnAccess",2,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.Office.PowerPoint.ShapeScopedCollection","{607dbfd7-bd79-4651-b5ff-3a66bc46be74}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Na=ca.addIndexerMethod(2,
"Microsoft.Office.PowerPoint.Shape",3,0);Na.addParameter("key","String",1,null,0);Na=ca.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Shape",3,1,"ItemAt",0);Na.addParameter("index","Int32",1,null,0);Na=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Shape",3,0,"ItemOrNullObject",0);Na.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Shape",!0);ca=M.addType("Microsoft.Office.PowerPoint.SlideCollection",
"{450b9577-a7dd-4d69-8dc9-afa8fba58465}","",3,0);Na=ca.addMethod("Add",6,"Void",0,0,"Add",0);Na.addParameter("options","Microsoft.Office.PowerPoint.AddSlideOptions",2,null,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Na=ca.addIndexerMethod(5,"Microsoft.Office.PowerPoint.Slide",3,0);Na.addParameter("key","String",1,null,0);Na=ca.addMethod("GetItemAt",2,"Microsoft.Office.PowerPoint.Slide",3,1,"ItemAt",0);Na.addParameter("index","Int32",1,null,0);Na=ca.addMethod("GetItemOrNullObject",3,"Microsoft.Office.PowerPoint.Slide",
3,0,"ItemOrNullObject",0);Na.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",4,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);ca=M.addType("Microsoft.Office.PowerPoint.SlideScopedCollection","{574045cb-b56d-4fca-89e5-b567250b9ce5}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Na=ca.addIndexerMethod(2,"Microsoft.Office.PowerPoint.Slide",3,0);Na.addParameter("key","String",1,null,0);Na=ca.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.Slide",
3,1,"ItemAt",0);Na.addParameter("index","Int32",1,null,0);Na=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.Slide",3,0,"ItemOrNullObject",0);Na.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.Slide",!0);ca=M.addType("Microsoft.Office.PowerPoint.SlideMasterCollection","{d5e75669-5fac-49ec-aaad-e1f6181f6fbd}","",3,0);ca.addMethod("GetCount",1,"Int32",1,1,"Count",0);Na=ca.addIndexerMethod(2,
"Microsoft.Office.PowerPoint.SlideMaster",3,0);Na.addParameter("key","String",1,null,0);Na=ca.addMethod("GetItemAt",3,"Microsoft.Office.PowerPoint.SlideMaster",3,1,"ItemAt",0);Na.addParameter("index","Int32",1,null,0);Na=ca.addMethod("GetItemOrNullObject",4,"Microsoft.Office.PowerPoint.SlideMaster",3,0,"ItemOrNullObject",0);Na.addParameter("id","String",1,null,0);ca.addMethod("_OnAccess",5,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.Office.PowerPoint.SlideMaster",!0);ca=M.addType("Microsoft.AppRuntime.AppRuntimeService",
"{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ca.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Na=ca.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Na.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ca=M.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ca.addEnumField("Inactive",0);ca.addEnumField("Background",1);ca.addEnumField("Visible",2);ca=M.addEnumType("Microsoft.AppRuntime.Visibility");
ca.addEnumField("Hidden",1);ca.addEnumField("Visible",2);ca=M.addType("Microsoft.AppRuntime.AppRuntimePersistenceService","{e8c34c73-c596-41e3-8943-dd7dd03839c7}","{7b93e367-9ccc-4d0e-8d75-79387538164b}",3,0);ca.addMethod("GetAppRuntimeStartState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeStartState",0);Na=ca.addMethod("SetAppRuntimeStartState",1,"Void",0,0,"SetAppRuntimeStartState",0);Na.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ca=M.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");
ca.addEnumField("Unknown",0);ca.addEnumField("Basic",1);ca.addEnumField("Premium",2);ca=M.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Na=ca.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Na.addParameter("feature","String",1,null,0);Na.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Na=ca.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",
3,1,"LicenseFeature",0);Na.addParameter("feature","String",1,null,0);Na=ca.addMethod("GetMsaDeviceTicket",7,"String",1,1,"MsaDeviceTicket",4);Na.addParameter("resource","String",1,null,0);Na.addParameter("policy","String",1,null,0);Na.addParameter("options","Microsoft.Office.Licensing.MsaDeviceTicketOptions",3,null,0);Na=ca.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Na.addParameter("feature","String",1,null,0);Na.addParameter("fallbackValue","Boolean",1,null,0);ca.addMethod("IsFreemiumUpsellEnabled",
3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Na=ca.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Na.addParameter("experienceId","String",1,null,0);Na=ca.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Na.addParameter("feature","String",1,null,0);ca=M.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);ca.addProperty("Id",5,"String",1,!0,null,0);ca.addMethod("_RegisterStateChange",6,"Void",
0,1,"_RegisterStateChange",0);ca.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ca=M.addType("Microsoft.Office.Licensing.MsaDeviceTicketOptions","{b20df140-2e7a-4b77-bb33-14fa3f7871aa}","{fdd1b6d0-e5d9-4e98-bdbd-bdcf387c7835}",3,0);ca.addProperty("Scopes",1,"String",1,!1,null,0);ca=M.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ca.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",
3,!0,null,0);Na=ca.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Na.addParameter("jsonCreate","String",1,null,0);Na=ca.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Na.addParameter("jsonUpdate","String",1,null,0);Na=ca.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Na.addParameter("id","String",1,null,0);Na=ca.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Na.addParameter("id","String",1,null,
0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ca.addProperty("Id",2,"String",1,!0,null,0);Na=ca.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Na.addParameter("visibility","Boolean",1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ca.addProperty("Enabled",3,"Boolean",
1,!1,null,0);ca.addProperty("Id",2,"String",1,!0,null,0);ca.addProperty("Label",4,"String",1,!0,null,0);Na=ca.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Na.addParameter("enabled","Boolean",1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca=M.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ca.addMethod("GetCount",3,"Int32",1,1,"Count",0);Na=ca.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Na.addParameter("key",
"String",1,null,0);ca.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ca.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0)};var Wh=d(41);class ik{constructor(M,ca){this.Nbc=M;this.sbc=ca}kUf(M){return[200,null,M]}PPi(M,ca,Na,zb,$b,Tc){const hd=Wh.a.rY(),Hd=this.Nbc.create(ca,Na,zb);zb.xCf=Hd;const le=this.sbc.create(Tc);le.context.appId=ca;le.context.controlId=Na;const ge=()=>{td.Kch(!0);Hd.OBe=!1;OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Hd,Wl,le,M).then(Oe=>{if(!Oe)return m.ULS.sendTraceTag(587745500,
802,10,"ExecuteRichApiRequest failed."),$b(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError),null;td.$Ee(hd,Wh.a.rY());$b(Oe,OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},Oe=>{m.ULS.sendTraceTag(587745499,802,10,"A PPT Rich API batch execution was failed, AppId: {0}  Reason: {1}",ca,Oe);$b(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})},Zd=()=>{td.Kch(!1);let Oe=M[4];Gf.a("ExtensibilityUseSerializedPayloads")&&(Oe=Oc(zb,Oe));OfficeExtension.WacRuntime.Utility.createPromise(tc=>
{const Xh={};Xh.promiseToResolve=tc;Xh.requestBody=Oe;A.AFrameworkApplication.Ta.La(lh.a.gWd,2,Xh)}).then(tc=>{Gf.a("ExtensibilityResetResponse")&&A.AFrameworkApplication.Ta.La(lh.a.gWd,2,{promiseToResolve:null,requestBody:""});if(Gf.a("ExtensibilityUseSerializedPayloads")){a:if((tc=Sys.Serialization.JavaScriptSerializer.deserialize(tc.toString()))&&tc.sel&&tc.sel.sldLst){var Xh=Tc.presentation,ii=tc.sel.sldLst,Rh=[];if(ii)for(Wf of ii)({slideId:ii}=Qe.a.uAh(Wf)).returnValue&&(ii=Object(C.a)(120,
Xh.$B(ii)))&&Rh.push(ii);var Wf=Rh;if(Wf.length&&!zb.gu.Vsl(Wf))tc=null;else{Wf=1===Wf.length?Wf[0]:null;Xh=null;if(Wf&&tc.sel.shpLst){Rh=tc.sel.shpLst;Xh=[];if(Rh)for(Yh of Rh)(Rh=Wf.DS(parseInt(Yh)))&&Xh.push(Rh);var Yh=Xh;if(Yh.length&&!zb.gu.Usl(Yh)){tc=null;break a}Xh=1===Yh.length?Yh[0]:null}tc=Xh&&tc.sel.txRn&&(tc.sel.txRn.length&&2!==tc.sel.txRn.length||2===tc.sel.txRn.length&&0<=tc.sel.txRn[0]&&!zb.gu.Wsl(Xh,tc.sel.txRn[0],tc.sel.txRn[1]))?null:tc.rst}}else tc=null;tc?(td.$Ee(hd,Wh.a.rY()),
$b(this.kUf(tc),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)):$b(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else td.$Ee(hd,Wh.a.rY()),$b(this.kUf(tc),OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess);return null},()=>{$b(null,OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);return null})};M?(Hd.OBe=!0,OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Hd,Wl,le,M).then(Oe=>{Oe&&Hd.YHg?ge():Zd();return null},()=>{Zd();return null})):ge()}}Object(h.a)(ik,"RichApiRequest",
null,[]);class Vj extends de{constructor(M,ca,Na){super();this.Nbc=M;this.sbc=ca;this.ua=Na}go(){this.qo={};this.Pq()}Pq(){const M=this.parameters.ArrayData;if(M){var ca=null,Na=this.BZd();Gf.a("SetOwnerAddinAssetIdForSharedRuntimeAPIsInPptWac")?Na&&Na.taskpane&&(ca=Na.taskpane.ownerAddinSolutionId):Na&&(ca=Na.So.id);try{(new ik(this.Nbc,this.sbc)).PPi(M,ca,this.controlId,this.re,Object(D.a)(this,this.QPi,"executeRichApiRequestCallback"),this.ua)}catch(zb){lb.a.J(36804577,802,10,"Exception thrown at ExecuteRichApiRequestMethod: "+
zb.toString()),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.qH()}}else this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,this.qH()}QPi(M,ca){this.errorCode=ca;this.errorCode===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&(this.qo.Data=M);this.qH()}get description(){return"Run ExecuteRichApi Invocation Completed."}}Object(h.a)(Vj,"ExecuteRichApiRequestMethod",de,[]);class Zm extends de{constructor(){super()}go(){this.qo={};this.Pq()}Pq(){const M=this.Vxb.yEj();m.ULS.sendTraceTag(587747344,
802,50,"GetAccessToken was called!");const ca=(Na,zb)=>{Na===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(zb=zb.accessToken,this.qo[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=zb):(zb=this.re.RZ.UV(this.controlId),m.ULS.sendTraceTag(587747343,802,10,"{0}",{["errorCode"]:Na.toString(),["appId"]:zb.So.id,["storeType"]:zb.So.storeType}));this.uh=Na;this.qH()};this.fvj.execute(Na=>{const zb=this.re.En,$b=yg.getInstance();qg.AppsForOfficeSingleSignOnManager.getInstance(zb,Na,
$b).getAccessToken(this.controlId,M,this.parameters,ca)})}get description(){return"Postmessage to wac host layer to get an access token for Addin."}}Object(h.a)(Zm,"GetAccessTokenMethod",de,[]);class Ok extends de{constructor(){super()}Pq(){let M=null;this.gu&&(M=Microsoft.Office.WebExtension.ActiveView.Edit);M?(this.result[Microsoft.Office.WebExtension.Parameters.Data]=M,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Returns the ActiveView value for current mode."}}
Object(h.a)(Ok,"GetActiveViewMethod",de,[]);var rf=d(1104);class Af extends de{constructor(){super()}go(){this.qo={};this.Pq()}Pq(){var M=this.Zd.En.getOsfControl(this.controlId);if(!A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!1)||M.isFirstParty()){M=M.getManifest();var ca=M.getMarketplaceID(),Na=M.getWebApplicationId(),zb=M.getWebApplicationMsaId();Ub.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(ca).then($b=>{this.errorCode=
0;const Tc={};Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=$b.upn;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=$b.userId;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Na;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=zb?zb:Na;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=$b.authority;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=rf.a.z_i($b.authorityType);Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=
$b.isAnonymous;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=$b.tenantId;Tc[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=$b.supportsAuthToken;this.qo[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Tc;this.qH()},$b=>{this.uh=1;this.qo[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=$b;this.qH()})}}get description(){return"Return authentication context needed by WebAuth stack."}}Object(h.a)(Af,"GetAuthContextMethod",de,[]);class qk extends de{constructor(){super()}go(){this.qo=
{};this.Pq();this.uh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.qH()}Pq(){var M=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const ca=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];M=this.cca.r9f(M);!M||ca*M.Sth>=M.fileSize?this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeIndexOutOfRange:(cb.Izi(this.re.presentationId,this.controlId,M.iXd,ca,M.Sth,Object(D.a)(this,this.oYb,"customizedOnFinished"),Object(D.a)(this,this.nYb,"customizedOnError")).start(),
this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}oYb(M,ca){M?0===ca.errorCode?(M=ca.value,this.qo[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=M,this.qo[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=M.length,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.qH()}nYb(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
this.qH()}get description(){return"Returns the specified slice."}}Object(h.a)(qk,"GetDocumentCopyChunkMethod",de,[]);class Dk extends de{constructor(){super();this.Rda=this.Eka=0}go(){this.qo={};this.Pq();this.uh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.qH()}Pq(){try{const M=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()];this.Rda=this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()];if(1>this.Rda||4194304<this.Rda)lb.a.J(17310339,802,
50,"GetDocumentCopyMethod: Invalid slice size: "+this.Rda),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidSliceSize;else{switch(M){case 1:this.Eka=4;break;case 2:this.Eka=3;break;default:lb.a.J(17310341,802,50,"GetDocumentCopyMethod: Unsupported file type: "+M);this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeFileTypeNotSupported;return}this.cca.Qug(this.controlId,this.Eka)?this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:this.cca.eCa.count>=this.re.UJd.ld.pptEditorAppForOfficeMaxDocumentReaders?
this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:(this.nZk.G2(!1,!0,()=>{this.yZk()},Object(D.a)(this,this.Owa,"saveFailureCallback")),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}}catch(M){lb.a.J(17310343,802,10,"Exception thrown at GetDocumentCopyMethod: "+M.toString()),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}}yZk(){cb.Jzi(this.re.presentationId,this.controlId,this.Eka,this.Rda,Object(D.a)(this,this.oYb,"customizedOnFinished"),Object(D.a)(this,
this.nYb,"customizedOnError")).start()}Owa(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.qH();return!1}oYb(M,ca){if(M&&M.length){M=ca.format;var Na=ca.sliceSize,zb=ca.errorCode;0===zb?(ca=ca.fileSize,this.qo[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=ca,ca=this.cca.Eji(this.controlId,ca,Na,M),this.qo[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=ca,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=174===zb?OSF.DDA.ErrorCodeManager.errorCodes.ooeMemoryFileLimit:
175===zb?OSF.DDA.ErrorCodeManager.errorCodes.ooeTooManyIncompleteRequests:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.qH()}nYb(M,ca){this.uh=ca?OSF.DDA.ErrorCodeManager.errorCodes.ooeNetworkProblemRetrieveFile:OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.qH()}get description(){return"Returns the entire document file in slices."}}Object(h.a)(Dk,"GetDocumentCopyMethod",de,[]);class ej extends de{constructor(){super()}Pq(){this.uh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;try{const M=this.p_i(),ca=this.gu.p4i(M);ca&&(this.qo[""+OSF.DDA.Marshaling.ThemingKeys.DocumentTheme]=ca,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(M){lb.a.J(17687510,802,10,"Exception thrown at GetDocumentThemeMethod: "+M)}}get description(){return"Returns the DocumentTheme (equivalent to AppForOfficeTheme) value for slide."}}Object(h.a)(ej,"GetDocumentThemeMethod",de,[]);class xj extends de{constructor(){super()}Pq(){this.uh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;let M=null;if(this.gu&&void 0!==(M=this.gu.htb())&&null!==(M=this.gu.htb())){var ca={};ca[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=M;this.result[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=ca;this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}}get description(){return"Returns the file properties. Now it only returns the URL."}}Object(h.a)(xj,"GetFilePropertiesMethod",de,[]);class Wj extends de{constructor(){super()}Pq(){this.uh=
OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidApiCallInContext}get description(){return"(Not implemented) Returns OfficeTheme properties."}}Object(h.a)(Wj,"GetOfficeThemeMethod",de,[]);class rk extends de{constructor(){super()}Pq(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.gu)try{var M=this.parameters[OSF.DDA.WAC.UniqueArguments.GetData].CoerceType.toString();M===Microsoft.Office.WebExtension.CoercionType.SlideRange?(M=null,this.uh=({s0k:M}=this.gu.aej()).returnValue,this.qo[OSF.DDA.WAC.UniqueArguments.Data]=
M):M===Microsoft.Office.WebExtension.CoercionType.Text?(M=null,this.uh=({Dkc:M}=this.gu.eej()).returnValue,this.qo[OSF.DDA.WAC.UniqueArguments.Data]=M):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported}catch(ca){lb.a.J(8958164,802,10,"Exception thrown at GetSelectedDataMethod: "+ca.toString())}}get description(){return"Get data contained in the current selection of the document."}}Object(h.a)(rk,"GetSelectedDataMethod",de,[]);class ol extends de{constructor(){super()}Pq(){var M=
this.BZd();if(M){const ca={};ca.Settings=this.RYd(M.settings);this.qo[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]=ca;this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else M="AppForOffice instance could not be found for ID "+this.controlId+nj.Debug.Ht(),lb.a.J(8958160,802,10,M),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Loads/Refreshes Settings object for an app"}RYd(M){const ca={};let Na=0;for(let zb in M)ca[Na.toString()]=[zb,M[zb]],Na++;return ca}}
Object(h.a)(ol,"LoadSettingsMethod",de,[]);class jm extends de{constructor(){super()}Pq(){m.ULS.sendTraceTag(587747346,802,50,"ExecuteAsync was called!");this.Vxb.uja()?(this.uh=dj.instance.bra.bfk(this.controlId,this.parameters[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],this.parameters[O.a.dJd],this.parameters[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin]),this.uh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&m.ULS.sendTraceTag(587747345,806,10,"ExecuteAsync failed. Error code: {0}",
this.uh.toString())):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run messageParent method."}}Object(h.a)(jm,"MessageParentMethod",de,[]);class xd extends de{constructor(){super()}Pq(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.gu)try{const M=this.parameters[OSF.DDA.Marshaling.NavigationKeys.NavigationRequest],ca=M[OSF.DDA.Marshaling.NavigationKeys.GoToType],Na=M[OSF.DDA.Marshaling.NavigationKeys.Id].toString();this.uh=ca===
OSF.DDA.Marshaling.GoToType.Index?this.gu.Xkj(Na):ca===OSF.DDA.Marshaling.GoToType.Slide?this.gu.Ykj(Na):OSF.DDA.ErrorCodeManager.errorCodes.ooeUnsupportedEnumeration}catch(M){lb.a.J(8958162,802,10,"Exception thrown at navigatetomethod: "+M.toString())}}get description(){return"Go to the slide specified by user."}}Object(h.a)(xd,"NavigateToMethod",de,[]);class Xl extends de{constructor(){super();this.Uke=0}go(){this.qo={};this.Pq();this.uh!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&this.qH()}Pq(){this.Uke=
this.parameters[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];const M=this.cca.r9f(this.Uke);M?(cb.gVf(this.re.presentationId,this.controlId,M.iXd,!1,!1,Object(D.a)(this,this.oYb,"customizedOnFinished"),Object(D.a)(this,this.nYb,"customizedOnError")).start(),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSpecifiedIdNotExist}oYb(M,ca){M?0===ca.errorCode?(this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess,this.cca.tPk(this.Uke)):
this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError:this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.qH()}nYb(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;this.qH()}get description(){return"Closes the document file."}}Object(h.a)(Xl,"ReleaseDocumentCopyMethod",de,[]);class dl extends de{constructor(){super();this.AGa=null}Pq(){var M=this.BZd();if(M){var ca=this.parameters[OSF.DDA.WAC.UniqueArguments.SettingsRequest];this.AGa=this.RYd(Array.isArray(ca[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings])?
ca[OSF.DDA.Marshaling.SettingsKeys.SerializedSettings]:null);ca=null;M.taskpane&&(ca=M.taskpane.ownerAddinSolutionId);var Na;if(M.taskpane&&ca)if(Na=this.re.hCa(ca)){this.gu.NIe(Na,this.AGa);if(Na=this.re.RZ.AZd(ca))Na.settings=this.AGa;M.settings=this.AGa;this.re.MVe(ca,this.AGa);this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess}else this.gCc.hkg(ca,this.AGa,this.Zd)?(M.settings=this.AGa,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;
else(Na=0===M.yy?this.re.$4f(M.shape.slideId,M.shape.id):this.re.hCa(M.So.id))?(this.gu.NIe(Na,this.AGa),M.settings=this.AGa,this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}else M="AppForOffice instance could not be found for ID "+this.controlId+nj.Debug.Ht(),lb.a.J(9052994,802,10,M),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}get description(){return"Saves settings to document."}RYd(M){const ca={};if(M)for(let Na=
0;Na<M.length;Na++){const zb=Array.isArray(M[Na])?M[Na]:null;zb&&1<zb.length&&(ca[zb[0]]=zb[1])}return ca}}Object(h.a)(dl,"SaveSettingsMethod",de,[]);class kg extends de{constructor(){super()}Pq(){this.Vxb.uja()?(dj.instance.bra.a1k(this.controlId,this.parameters[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],this.parameters[O.a.dJd],this.parameters[OSF.DDA.Marshaling.SendMessageKeys.TargetOrigin]),this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess):this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported}get description(){return"Run sendMessage/messageChild method."}}
Object(h.a)(kg,"SendMessageMethod",de,[]);class km extends de{constructor(){super()}Pq(){this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError;if(this.gu)try{const ca=this.parameters[OSF.DDA.WAC.UniqueArguments.SetData];var M=ca.CoerceType.toString();const Na=ca[OSF.DDA.WAC.UniqueArguments.Data];if(M===Microsoft.Office.WebExtension.CoercionType.Text)this.uh=this.gu.f7k(Na);else{let zb;if(M===Microsoft.Office.WebExtension.CoercionType.Image)zb=0;else if(M===Microsoft.Office.WebExtension.CoercionType.XmlSvg)zb=
1;else{this.uh=OSF.DDA.ErrorCodeManager.errorCodes.ooeCoercionTypeNotSupported;return}M=!1;let $b=0,Tc=0,hd=0,Hd=0;({ztj:M,x:$b,y:Tc,width:hd,height:Hd}=this.HQi(ca,M,$b,Tc,hd,Hd));this.uh=this.gu.a7k(Na,M,$b,Tc,hd,Hd,zb)}}catch(ca){lb.a.J(17310337,802,10,"Exception thrown at SetSelectedDataMethod: "+ca)}}HQi(M,ca,Na,zb,$b,Tc){const hd=M[OSF.DDA.Marshaling.SetDataKeys.ImageLeft],Hd=M[OSF.DDA.Marshaling.SetDataKeys.ImageTop];void 0!==hd&&null!==hd&&"number"===typeof hd&&void 0!==Hd&&null!==Hd&&"number"===
typeof Hd&&(ca=!0,Na=hd,zb=Hd);M[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]&&($b=M[OSF.DDA.Marshaling.SetDataKeys.ImageWidth]);M[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]&&(Tc=M[OSF.DDA.Marshaling.SetDataKeys.ImageHeight]);return{ztj:ca,x:Na,y:zb,width:$b,height:Tc}}get description(){return"Writes data to the current selection in the document."}}Object(h.a)(km,"SetSelectedDataMethod",de,[]);class Ki extends jc{constructor(M){super(M)}Nyk(){this.nac={};this.set(OSF.DDA.MethodDispId.dispidLoadSettingsMethod,
()=>new ol);this.set(OSF.DDA.MethodDispId.dispidSaveSettingsMethod,()=>new dl);this.set(OSF.DDA.MethodDispId.dispidGetActiveViewMethod,()=>new Ok);this.set(OSF.DDA.MethodDispId.dispidNavigateToMethod,()=>new xd);this.set(OSF.DDA.MethodDispId.dispidGetSelectedDataMethod,()=>new rk);this.set(OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod,()=>new xj);this.set(OSF.DDA.MethodDispId.dispidGetDocumentThemeMethod,()=>new ej);this.set(OSF.DDA.MethodDispId.dispidGetOfficeThemeMethod,()=>new Wj);this.set(OSF.DDA.MethodDispId.dispidSetSelectedDataMethod,
()=>new km);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod,()=>new Dk);this.set(OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod,()=>new qk);this.set(OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod,()=>new Xl);this.set(OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod,()=>new Be);this.set(OSF.DDA.MethodDispId.dispidMessageParentMethod,()=>new jm);this.set(OSF.DDA.MethodDispId.dispidSendMessageMethod,()=>new kg);this.set(OSF.DDA.MethodDispId.dispidGetAccessTokenMethod,
()=>new Zm);this.set(OSF.DDA.MethodDispId.dispidGetAuthContextMethod,()=>new Af);this.set(OSF.DDA.MethodDispId.dispidCreateDocumentMethod,()=>new Mf);this.set(OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod,()=>new Vj(this.Zd.KXk,this.Zd.aCk,this.Zd.S4d))}}Object(h.a)(Ki,"EditorMethodFactory",jc,[]);class vm extends Sys.EventArgs{constructor(M){super();this.Zvd=M}get instanceId(){return this.Zvd}}Object(h.a)(vm,"FirstPartyAddInHidingEventArgs",Sys.EventArgs,[]);class pj{constructor(){this.CUa=
{};this.bme={};this.D3c={};this.w0c={}}ICf(M,ca){ca&&M&&(this.CUa[M]=ca,this.w0c[M]=!1)}n1h(M,ca){M&&ca&&(this.D3c[M]=ca)}pPk(M){if(M){var ca=this.CUa[M];ca&&(delete this.D3c[ca.So.id],delete this.CUa[M],delete this.bme[M],delete this.w0c[M])}}UV(M){return M?this.CUa[M]:null}F7i(M){return M?this.w0c[M]:!1}Pfj(M){return M?this.bme[M]:null}zDh(M,ca){M&&(this.w0c[M]=ca)}Dyl(M,ca){M&&(this.bme[M]=ca)}AZd(M){if(!M)return null;const ca=this.CUa;for(let Na in ca){const zb=ca[Na];if(zb&&zb.So.id.toLowerCase()===
M.toLowerCase())return zb}return null}l_i(M,ca,Na){if(!M||!ca||!Na)return null;const zb=this.CUa;for(let $b in zb){const Tc=zb[$b];if(Tc&&Tc.taskpane&&Tc.taskpane.ownerAddinSolutionId&&Tc.taskpane.ownerAddinSolutionId.toLowerCase()===M.toLowerCase()){const hd=Na.getOsfControl(Tc.instanceId);if(hd&&hd.getSharedRuntimeId()===ca)return Tc}}return null}BYd(M){ci.a.forEach(this.CUa,(ca,Na)=>{ca=Object(C.a)(850,Na);1===ca.yy&&M(ca)},null)}aTi(M){const ca=this.CUa;for(let Na in ca){const zb=Object(C.a)(850,
ca[Na]);if(zb&&M(zb))return zb}return null}Z4f(M){return M in this.D3c?this.D3c[M]:null}}Object(h.a)(pj,"OsfAppInstacneCache",null,[]);class Df{constructor(M,ca,Na,zb,$b,Tc,hd,Hd,le,ge,Zd,Oe,tc,Xh,ii,Rh,Wf,Yh,Jg,sb,Xa,hl,sl,Tn,fj){this.Fzb=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.jb&&A.AFrameworkApplication.Aa.jb.tW;this.eXb=!1;this.Wxb=this.sFa=this.Mfe=this.xCf=null;this.va=new E.a;this.OKg=!1;this.wq=M;this.MI=ca;this.Qoe=new Ki(this);this.oYc=new Gb(this,sb);this.nUa=Xa;this.WTa=
zb;this.LFg={};this.AF=new pj;this.F0j=Na;this.iyb=$b.value;this.Nz=hd;this.Nb=Tc;this.kX=Hd;this.Ob=le;this.u0j=Wf;this.u$a=ge;this.fc=Zd;this.pi=Oe;this.ua=tc;this.Ea=Xh;this.lc=ii;this.uc=Rh;this.O7b=Jg;this.s$a=new cj;this.r0j=Yh;this.yl=hl;this.Nbc=sl;this.sbc=Tn;this.N7j=fj}initialize(){this.w5(this.Ob.mode);this.Ob.JM(Object(D.a)(this,this.Vjg,"handleModeSwitch"))}dispose(){this.Ob.QX(Object(D.a)(this,this.Vjg,"handleModeSwitch"))}get gCc(){this.s$a||(this.s$a=new cj);return this.s$a}get En(){if(!Df.yta){this.wq&&
(this.wq.ld.xEj&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Tg),this.fc.ka("305")&&OfficeExt.PrivateCatalogService.initRequestHandler(new Tg,new nf(this.wq.ld.tg?A.AFrameworkApplication.fa.appSettings.AuthProxyHandlerWebServiceBase:A.AFrameworkApplication.fa.appSettings.WebServiceBase),this.fc.ka("306")),OfficeExt.MosRequestHandler.init(new Tg),OfficeExt.ProxyBasedCatalogService.initRequestHandler&&OfficeExt.ProxyBasedCatalogService.initRequestHandler(new Tg));const M=new Nb(this.Qoe,
this.oYc);this.Wxb=this.$E.Txi(this.AF);Df.yta=this.F0j.Eyi(this.MI,M,this.Wxb);Df.yta.setOAuthManager(this.N7j);Df.yta&&"undefined"!==typeof Df.yta.hostCheckReadyHandler&&A.AFrameworkApplication.B5h(Object(D.a)(Df.yta,Df.yta.hostCheckReadyHandler,"hostCheckReadyHandler"))}return Df.yta}XCh(M){(M=this.En.getOsfControl(M))&&this.Wxb&&this.Wxb.LZg(M)}sxb(M,ca,Na){this.Wxb?this.Wxb.aUj(M,ca,Na):m.ULS.sendTraceTag(512508178,806,10,"m_appEventListener is null")}rhb(M,ca,Na=null){const zb=this.$E.m2(M);
if(this.fc.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Fqb(zb.storeType)))this.yl.Dca(22)||this.yl.IBa(22);else if(0===zb.yy)this.WTa.uEj(zb.id)?(Na=this.WTa.gqa[zb.id],Gf.a("Microsoft.Office.SharedOnline.FixBug6808089")?this.WTa.TIa(zb.id,this.ZMe(M),ca):(Na.oKe(ca),this.WTa.TIa(zb.id,this.ZMe(M),null))):(M=this.GNe(M,ca),M.oKe(ca),this.WTa.oZk(zb.id,M));else if(1===zb.yy){const $b=zb.node.sa(Bb.a.dZ,null);this.Ssa(zb.id)?zb.ktg||this.$Gb($b,!0):this.GNe(M,ca,Na);this.wq.ld.Hsa&&!zb.ownerAddinSolutionId&&
(ca=this.T3d(zb.vwa),this.MVe(zb.vwa,ca.settings))}}launchInsertDialog(){this.va.raiseEvent("OnInsertionDialogOpened");this.sFa=new qi;this.sFa.tj("",null,null);this.En.launchInsertDialog(this.sFa.r5a)}iUj(M){this.va.raiseEvent("OnInsertionDialogOpened");this.sFa=new qi;this.sFa.tj("",null,null);if(M){const ca={navigationMode:0};ca.assetId=M;this.En.launchInsertDialog(this.sFa.r5a,"{98143890-AC66-440E-A448-ED8771A02D52}",ca)}else this.En.launchInsertDialog(this.sFa.r5a)}lmg(){this.sFa&&this.sFa.hide()}Hfb(M){const ca=
this.A5f(M);ca?this.$fh(ca):m.ULS.sendTraceTag(512508177,806,10,String.format("Failed to find the AppNode with instance id: {0}",M))}$fh(M){const ca=this.$E.m2(M);if(this.fc.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Fqb(ca.storeType)))this.yl.Dca(22)||this.yl.IBa(22);else{var Na=(zb,$b)=>{const Tc=this.$E.m2(zb),hd=this.$E.oGc(A.AFrameworkApplication.isRtl,Tc.id,Tc.width,Tc.visibility);$b.pP(hd);this.Fzb||hd.kp(Tc.visibility);let Hd=$b=null;this.wq.ld.Hsa&&this.wq.ld.UQj&&(Hd=this.Tdd(M),
$b=()=>{this.tK(hd,!0,!1);this.$Jb(Hd)});this.rhb(zb,hd.fCc,$b);this.Fzb&&(Hd&&(zb=this.DZ(Hd.So.id).wha,hd.n8k(zb)),hd.kp(Tc.visibility))};if(this.wq.ld.Hsa){const zb=this.$E.m2(M),$b={};$b.solutionId=zb.vwa;$b.version=zb.version;$b.storeType=this.Fqb(zb.storeType);$b.storeId=zb.store;$b.targetData=M;this.En.isAddinCommandsAsync($b,(Tc,hd)=>{const Hd=this.Tdd(M);var le=M.sa(oe.a.isForUILessAction,!1);const ge=M.sa(oe.a.sharedRuntimeId,null),Zd=zb.ownerAddinSolutionId,Oe=!!Hd.Rv&&0<Hd.Rv.state&&!!Hd.Rv.Nwa;
if(!hd&&zb.visibility||hd&&Zd&&!Oe||le&&!ja.a.Va(ge))Na(M,this.Nz),this.RZ.zDh(zb.id,hd);else if(hd){if(le=this.w_b(zb.vwa))Hd.settings=le.settings,this.gu.NIe(M,Hd.settings);this.RZ.ICf(Hd.instanceId,Hd);this.RZ.zDh(Hd.instanceId,hd);this.MVe(Hd.So.id,Hd.settings);if(zb.visibility&&this.u$a.installVisibleAddinCommandsEnabled||Oe){if("omex"!==$b.storeType.toLowerCase()&&!Oe)return;let tc=!1;this.bDe(Xh=>{if(!Xh[O.a.N8h]){if(Xh[O.a.NFf])for(const ii of Xh[O.a.NFf])if(tc=rd.e(ii[1])===rd.e(zb.vwa))break;
tc||this.FAc(Hd)}})}}Tc||lb.a.J(512508176,220,10,"Checking AddinCommands fails for {0} from {1}",zb.vwa,this.Fqb(zb.storeType))})}else Na(M,this.Nz)}}c0b(M){return M&&M.assetId?M.sourceLocationOverrideResourceId?String.format("{0}.{1}",M.assetId,M.sourceLocationOverrideResourceId):M.assetId:null}yTk(M){const ca=this.jgi(M),Na=this.$E.m2(ca);if(A.AFrameworkApplication.Vbe(Na.vwa)){const zb=this.$E.oGc(A.AFrameworkApplication.isRtl,Na.id,Na.width,Na.visibility,M);this.Nz.pP(zb);zb.kp(Na.visibility);
this.GNe(ca,zb.fCc,null,M)}}bDe(M){const ca={};ca.callback=M;A.AFrameworkApplication.Ta.La(md.a.oXa,2,ca)}FAc(M){const ca=this.$E.oGc(A.AFrameworkApplication.isRtl,M.instanceId,M.taskpane.width,M.taskpane.visibility);this.Nz.pP(ca);ca.kp(M.taskpane.visibility);const Na=ca.fCc;Object(C.a)(849,this.$E.KQd(this.wq.ld,M,Na,A.AFrameworkApplication.isRtl,this)).FAc(this.En,Na,()=>{this.$Jb(M);this.tK(ca,!1,!!M.Rv&&!!M.Rv.Nwa);w.a.instance.setItem(O.a.aJd,"true")})}tK(M,ca,Na){M.kp(!1);Na||(Df.yta.purgeOsfControl(M.id,
!1),ca?this.wq.EK().La(lh.a.$Qc,2,M.id):this.oYc.MPf(M.id),M.dispose())}$Jb(M){var ca={};ca.solutionId=M.So.id;ca.version=M.So.version;ca.storeType=M.So.storeType;ca.storeId=M.So.store;ca.assetId=null;ca.assetStoreId=null;ca.sharedRuntimeId=M.Rv?M.Rv.Nwa:null;ca.backgroundState=M.Rv?M.Rv.state:-1;M=new e.a;M.add(ca);ca={};ca[O.a.MBc]=M;ca[O.a.S6]=3;this.wq.EK().La(md.a.ZWc,2,ca)}hMc(){const M=this.kX.yf;var ca=null;M&&(ca=new ze.GraphIterator,ca.set(M),ca=ca.Ab(18));return ca}DZ(M){return M?(M=this.AF.AZd(M))&&
M.taskpane?M:null:null}jUi(M,ca,Na,zb){if(!M||!ca||!Na)return null;M=this.getSharedRuntimeId(ca,zb,M.solutionId,Na);return(Na=this.AF.l_i(Na,M,this.En))&&Na.taskpane?Na:null}PXd(M){return M?(M=this.AF.UV(M))&&M.taskpane?M:null:null}hCa(M){if(!M)return null;var ca=this.hMc();if(ca&&(ca=this.Nb.Kc(ca))&&ca.Ab(19)){do{const Na=ca.currentNode;if(this.LUb(Na.sa(ye.a.Cob,null),M))return Na}while(ca.zj(19))}return null}A5f(M){if(!M)return null;var ca=this.hMc();if(ca&&(ca=this.Nb.Kc(ca))&&ca.Ab(19)){do{const Na=
ca.currentNode;if(this.LUb(Na.sa(Bb.a.dZ,null),M))return Na}while(ca.zj(19))}return null}$4f(M,ca){return(M=this.uc.kl(M))?M.DS(ca):null}SDj(M){return M?this.AF.F7i(M):!1}Lfi(M,ca,Na,zb,$b){if(!M||!M)return null;let Tc;if(!(M.solutionId&&M.version&&M.storeId&&M.storeType))return m.ULS.sendTraceTag(512508175,802,15,"Invalid entitlement"),null;Tc=Object(C.a)(xh.a,this.iyb.createInstance(1074135137));Tc.setValue(ye.a.Cob,M.solutionId);Tc.setValue(ye.a.oCc,M.version);Tc.setValue(ye.a.nCc,M.storeId);Tc.setValue(Bb.a.uUb,
this.$Fc(M.storeType));Tc.setValue(ye.a.jCc,!1);Tc.setValue(Bb.a.dZ,gi.a.create().toString());Tc.setValue(ye.a.QJd,"right");Tc.setValue(ye.a.xUb,Na);$b&&Tc.setValue(oe.a.isForUILessAction,$b);zb&&(Tc.setValue(Bb.a.B4g,zb),(M=this.getSharedRuntimeId(ca,$b,M.solutionId,zb))&&Tc.setValue(oe.a.sharedRuntimeId,M));return Tc}CZd(M){M=this.hCa(M);return this.Tdd(M)}Kfi(M,ca){if(!(M&&M&&M.solutionId&&M.version&&M.storeId&&M.storeType))return null;M=new oj(M.solutionId,M.version,M.storeId,M.storeType);ca=
ca?new Qj(0,ca):null;return new ae(M,null,null,null,{},1,ca)}fUd(M){qg.AppsForOfficeSingleSignOnManager.Lmi(M);const ca=this.AF.UV(M);ca&&(Df.yta.purgeOsfControl(ca.instanceId,!1),this.oYc.MPf(ca.instanceId),this.AF.pPk(ca.instanceId),this.WTa.Ydh(ca.instanceId),this.nUa.jjc(this.presentationId,M,!1,!0))}notifyAgave(M,ca){this.En.notifyAgave(M,ca)}wMk(M){!this.OKg&&M.Mj&&(M=M.Mj,M.vd(47).R6(Object(D.a)(this,this.PGf,"appDisposeHandler")),M.vd(10).R6(Object(D.a)(this,this.PGf,"appDisposeHandler")),
this.OKg=!0)}PGf(M,ca){M=ca.node;ca=1074135137===M.Oe;if(M.sa(Bb.a.Uq,!1)||ca)M=this.$E.m2(M),this.fUd(M.id)}jgi(M){const ca=Object(C.a)(9,this.iyb.createInstance(1074135137));ca.setValue(ye.a.oCc,"1.0.0.0");ca.setValue(ye.a.nCc,"en-US");ca.setValue(Bb.a.dZ,gi.a.create().toString());ca.setValue(ye.a.xUb,!0);ca.setValue(Bb.a.JJd,null);ca.setValue(Bb.a.NGf,null);ca.setValue(ye.a.Cob,this.c0b(M));M.npc?(ca.setValue(ye.a.vUb,"sdxcatalog"),ca.setValue(Bb.a.uUb,this.$Fc("sdxcatalog"))):(ca.setValue(ye.a.vUb,
"firstparty"),ca.setValue(Bb.a.uUb,this.$Fc("firstparty")));ca.setValue(Bb.a.isAddinCommands,!1);ca.setValue(ye.a.jCc,!1);ca.setValue(ye.a.QJd,"right");return ca}Tdd(M,ca=null){if(!M)return null;M=this.$E.m2(M);const Na=this.Fqb(M.storeType),zb=new oj(M.vwa,M.version,M.store,Na);let $b=null,Tc=null;if(0===M.yy)$b=new hk(M.shapeId,M.slideId);else if(1===M.yy)Tc=new Vh(M.$Zf,M.visibility,M.width,M.row,M.ownerAddinSolutionId,M.ownerAddinStoreType,M.ktg);else return null;let hd={};ca&&OSF.OsfControl.isFirstPartyStoreString(Na)?
hd=OSF.OUtil.serializeSettings(ca.nonPersistedSettings):M.ownerAddinSolutionId||(hd=M.settings);ca=M.R3a?new Qj(M.Zob,M.R3a):null;return new ae(zb,M.id,$b,Tc,hd,M.yy,ca)}cdh(M,ca=null){if(this.fc.ka("883")){var Na=this.En.getOsfControl(M);if(Na&&ca){ca.nonPersistedSettings&&Na.setSettings(OSF.OUtil.serializeSettings(ca.nonPersistedSettings));if(ca.CU){const zb=Object(C.a)(850,this.PXd(M));zb&&(zb.wha=ca.CU,this.Fzb&&this.$Gb(M,!0))}Na.refresh();this.XCh(M)}}}GNe(M,ca,Na=null,zb=null){const $b=this.Tdd(M,
zb);if(!$b||OSF.OsfControl.isFirstPartyStoreString($b.So.storeType)&&!A.AFrameworkApplication.Vbe($b.So.id))return null;var Tc=this.$E.m2(M);if(this.fc.ka("569")&&!OSF.OsfControl.isFirstPartyStoreString(this.Fqb(Tc.storeType)))return this.yl.Dca(22)||this.yl.IBa(22),null;zb&&zb.CU&&($b.wha=zb.CU);Tc=Object(C.a)(849,this.$E.KQd(this.wq.ld,$b,ca,A.AFrameworkApplication.isRtl,this));this.AF.ICf($b.instanceId,$b);this.AF.n1h($b.So.id,ca);zb&&zb.Tva&&zb.Tva();this.wq.ld.Hsa&&$b.taskpane&&$b.taskpane.ownerAddinSolutionId&&
(ca=this.AF.AZd($b.taskpane.ownerAddinSolutionId))&&this.HCh(ca.instanceId,$b.instanceId);Tc.Pcl(this.En,this.ZMe(M),Na,zb,this.u$a.powerPointDragInsertImageIsEnabled);$b.taskpane&&$b.taskpane.ownerAddinSolutionId||this.wMk(M);return Tc}txh(M){if(this.u$a.LRj){const Na=this.RZ.UV(M);if(Na&&0===Na.yy&&Na.shape){var ca=this.RZ.Pfj(M);const zb=new Date;!ca||zb.getTime()-ca.getTime()>=this.u$a.pptEditorAppForOfficeSnapshotIntervalTime?(m.ULS.sendTraceTag(512508173,806,50,"Start to generate addin [{0}] {1} snapshot",
Na.So.id,M),(ca=this.u0j.ETf(1,M))?(this.RZ.Dyl(M,zb),ca.execute(this,this.r0j,null)):m.ULS.sendTraceTag(512508172,806,50,"Snapshot action is null for addin [{0}] {1}.",Na?Na.So.id:"AppNotExist",M)):m.ULS.sendTraceTag(512508171,806,50,"Addin [{0}] {1} snapshot interval is less than config interval threshold.",Na?Na.So.id:"AppNotExist",M)}}}P0g(M,ca,Na,zb){1===M&&this.rrk(ca,Na,zb)}rrk(M,ca,Na){let zb=null;Na&&Na.result&&(Na=Na.result,zb=Na.substr(Na.indexOf("base64,")+7));const $b=this.RZ.UV(M);ca===
OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess&&zb&&0<zb.length&&$b?0===$b.yy&&$b.shape&&$b.So&&this.pi.WCh($b.shape.slideId.toString(),$b.shape.id,zb,()=>{m.ULS.sendTraceTag(512508170,806,50,"Update addin [{0}] {1} snapshot succeed with {2} bytes",$b.So.id,M,zb.length)},()=>{m.ULS.sendTraceTag(512508169,806,10,"Update addin [{0}] {1} snapshot failed",$b.So.id,M);return!1}):m.ULS.sendTraceTag(512508168,806,10,"Generate addin [{0}] {1} snapshot failed with {2} bytes",$b?$b.So.id:"AppNotExist",M,zb?
zb.length:0)}w_b(M){return M?this.LFg[M]:null}dBc(M,ca){M&&ca&&(this.LFg[M]=ca)}get gu(){this.Mfe||(this.Mfe=new jg(this.wq.ld,Ub.a.instance.resolve("Common.IAppSettingsManager"),this.MI,Ub.a.instance.le("Box4.IOutlineEditor"),Ub.a.instance.le("Box4.ISelectionManager"),Ub.a.instance.le("Box4.ICharacterPropertiesEditor"),Ub.a.instance.le("PowerPointWebEditor.IClassFactory"),Ub.a.instance.resolve("Common.Transaction.ITransactionFactory"),this.wq.EK(),Ub.a.instance.resolve("PowerPointWebEditor.IPPTWorkspace"),
Ub.a.instance.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ub.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),Ub.a.instance.resolve("PowerPointWebEditor.ISlideReader"),Ub.a.instance.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"),Ub.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),Ub.a.instance.resolve("PowerPointWebEditor.View.IPPTPageView"),Ub.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),Ub.a.instance.resolve("PowerPointWebEditor.IShapeReader"),
Ub.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),Ub.a.instance.resolve("Box4.IOutlineElementNavigator"),Ub.a.instance.resolve("Box4.IParagraphReader"),Ub.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager"),Ub.a.instance.resolve("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory")));return this.Mfe}get cca(){return this.nUa}wXa(M,ca,Na){this.oYc.zZd(M).raiseEvent(Na,ca)}Rah(M,ca){this.AF.BYd(Na=>{this.wXa(M,Na.instanceId,ca)})}HCh(M,ca){if(M&&ca){M=this.RZ.UV(M);var Na=
this.RZ.UV(ca);M&&Na&&(Na.settings=M.settings,this.U0g(ca,M.settings))}}MVe(M,ca){M&&ca&&this.RZ.BYd(Na=>{this.LUb(Na.taskpane.ownerAddinSolutionId,M)&&!this.gCc.vEj(Na.settings,ca)&&(Na.settings=ca,this.U0g(Na.instanceId,ca))})}Vjg(M){this.w5(M.mode)}w5(M){if(1!==M&&2!==M)throw Error.invalidOperation(String.format("The mode '{0}' being swtiched to is unsupported.",M));m.ULS.sendTraceTag(512508167,806,50,"AppForOfficeManager.SwitchToMode: {0} the content add-in's container on active slide.",2===M?
"Show":"Edit");this.WTa.w5(M);this.Nz.w5(M)}U0g(M,ca){const Na=OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString();this.wXa(Na,M,ca)}Fqb(M){switch(M){case 0:M="spcatalog";break;case 1:M="filesystem";break;case 2:M="omex";break;case 3:M="spapp";break;case 4:M="registry";break;case 5:M="inmemory";break;case 6:M="uploadfiledevcatalog";break;case 7:M="excatalog";break;case 8:M="firstparty";break;case 9:M="sdxcatalog";break;default:throw Error.create(String.format("[{0}] is not the valid store type int value.",
M));}return M}$Fc(M){if(!M)throw Error.create("Store Type should not be null.");Df.f5||Df.Qyj();if(M in Df.f5)return Df.f5[M];throw Error.create(String.format("[{0}] is not the valid store type.",M));}T3d(M){return M?this.AF.aTi(ca=>this.LUb(ca.So.id,M)):null}get UJd(){return this.wq}y6h(M){this.va.addHandler("OnInsertionDialogOpened",M)}GId(M){this.va.addHandler("OnFirstPartyAddInHidden",M)}QRk(M){this.va.removeHandler("OnFirstPartyAddInHidden",M)}YGk(M){this.va.raiseEvent("OnFirstPartyAddInHidden",
new vm(M))}OOd(M){const ca=Od.a.Zna(this.Nz.R1,Na=>Na.id===M);if(1!==ca.length)return!1;this.tK(ca[0],!0,this.Ssa(M));return!0}$Gb(M,ca){const Na=Od.a.Zna(this.Nz.R1,zb=>zb.id===M);1!==Na.length?lb.a.J(512508166,220,50,"Panes with appropriate instance id are {0}",Na.length):Na[0].kp(ca)}zZi(M){const ca=Od.a.Zna(this.Nz.R1,Na=>Na.id===M);return 1!==ca.length?(lb.a.J(512508165,220,50,"Panes with appropriate instance id are {0}",ca.length),!1):ca[0].isVisible}$sl(M,ca){const Na=this.w_b(M);Na&&Na.Rv&&
Na.Rv.Nwa&&(Na.Rv.state=ca?1:0,(this.hCa(M)||this.gCc.hkg(M,Na.settings,this))&&this.wq.EK().La(lh.a.KCh,2,Na))}AZi(M){return(M=this.w_b(M))&&M.Rv?1===M.Rv.state:!1}yQf(M){this.RZ.BYd(ca=>{this.LUb(ca.taskpane.ownerAddinSolutionId,M)&&this.OOd(ca.instanceId)})}Psb(M){return this.AF.UV(M)}Ssa(M){if(!M||4===this.En.getOsfControlStatus(M))return!1;M=this.En.getOsfControl(M);return!!M&&!!M.getSharedRuntimeId()}setInitialDisplayMode(M,ca){(M=this.En.getOsfControl(M))&&M.setInitialDisplayMode(ca)}getSharedRuntimeId(M,
ca,Na,zb){if(!M)return null;const $b=new Oh;if(!$b)return null;if(ca)return M.getSharedRuntimeId($b.HS,ca,null);Na=(new ud("",zb,$b,!0)).BWf(Na.substr(zb.length));return M.getSharedRuntimeId($b.HS,ca,Na)}EUi(M,ca){const Na={};Na.visibility=ca?"Visible":"Hidden";ca=JSON.stringify(Na);this.P5f(M,65539,"",ca)}GUi(M,ca,Na){this.P5f(M,1,ca,Na)}Dfl(M,ca){M=new oj(M.solutionId,M.version,M.storeId,M.storeType);var Na=new Vh("right",!0,350,0,null,null,!1);M=new ae(M,mj.a.create().toString(),null,Na,{},1,null);
const zb=this.$E.oGc(A.AFrameworkApplication.isRtl,M.instanceId,M.taskpane.width,M.taskpane.visibility);this.Nz.pP(zb);zb.kp(M.taskpane.visibility);Na=zb.fCc;Object(C.a)(849,this.$E.KQd(this.wq.ld,M,Na,A.AFrameworkApplication.isRtl,this)).FAc(this.En,Na,()=>{this.tK(zb,!1,!1);ca()})}P5f(M,ca,Na,zb){var $b=Array(6);$b[0]=65536;$b[1]=ca;$b[2]=Na;$b[3]=zb;$b[4]=-1;$b[5]=!1;ca=Array(1);ca[0]=$b;$b=new Ji(OSF.DDA.EventDispId.dispidRichApiMessageEvent,M,null,ca);this.wXa(OSF.DDA.EventDispId.dispidRichApiMessageEvent.toString(),
M,$b)}LUb(M,ca){return M&&ca?M.toLowerCase()===ca.toLowerCase():!1}ZMe(M){return!this.Ob||1!==this.Ob.mode||M&&"FA000000012"===M.sa(Bb.a.JJd,null)?1===this.$E.m2(M).yy?!0:this.Ea.oEa(M)?this.ua.Ba===this.lc.ig(M):!1:!1}get presentationId(){return this.wq.aRa().presentationId}get wSf(){return this.WTa}get RZ(){return this.AF}get $E(){return this.O7b.value}get KXk(){return this.Nbc}get aCk(){return this.sbc}get S4d(){return this.ua}static Qyj(){Df.f5={};Df.f5.inmemory=5;Df.f5.uploadfiledevcatalog=6;
Df.f5.spcatalog=0;Df.f5.omex=2;Df.f5.registry=4;Df.f5.spapp=3;Df.f5.filesystem=1;Df.f5.excatalog=7;Df.f5.firstparty=8;Df.f5.sdxcatalog=9}}Df.f5=null;Df.yta=null;Object(h.a)(Df,"AppForOfficeManager",null,[851,106,666]);class Qh{constructor(M,ca,Na){this.cT=M;this.qJg=ca;this.Nb=Na}register(){this.qJg.Yj(Object(D.a)(this,this.YGf,"appSettingChangedEventHandler"))}dispose(){this.qJg.tm(Object(D.a)(this,this.YGf,"appSettingChangedEventHandler"))}YGf(M,ca){M=ca.node;ca=ca.property;try{if(1074135139===
M.Oe&&ca===ye.a.mCc){ca=null;var Na=this.Nb.Kc(M);Na.pc(47)||Na.pc(10);Na.yc();this.s$d(Na.currentNode)&&(ca=new Ff.a(Na.currentNode));var zb=ca.settings;Gf.a("RefreshAppSettingsValue")&&(this.cT.Psb(ca.id).settings=zb);this.cT.wXa(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),ca.id,zb)}}catch($b){m.ULS.sendTraceTag(18442307,802,10,"Failed to execute AppSettingChangedEventHanlder: {0}.",$b)}}s$d(M){if(!M)return!1;const ca=Object(C.a)(4,M);return 1074135137===M.Oe||!!ca&&ca.Uq}}Object(h.a)(Qh,
"AppForOfficeSettingChangedEventListener",null,[848,106]);class Yl{constructor(M,ca,Na){this.cT=M;this.cFg=ca;this.Nb=Na}register(){for(const M of this.cFg)M.nG(Object(D.a)(this,this.ZGf,"appSettingCreatedEventHandler"))}dispose(){for(const M of this.cFg)M.yO(Object(D.a)(this,this.ZGf,"appSettingCreatedEventHandler"))}ZGf(M,ca){M=ca.node;try{if(this.s$d(M)&&21===ca.lZ){this.Nb.Kc(M).o2b()||m.ULS.sendTraceTag(20821900,802,15,"Got OnChildTopologyChanged event but no child found.");const Na=new Ff.a(M),
zb=Na.settings;this.cT.wXa(OSF.DDA.EventDispId.dispidSettingsChangedEvent.toString(),Na.id,zb)}}catch(Na){m.ULS.sendTraceTag(20821901,802,10,"Failed to execute AppSettingCreatedEventHandler: {0}.",Na)}}s$d(M){if(!M)return!1;const ca=Object(C.a)(4,M);return 1074135137===M.Oe||!!ca&&ca.Uq}}Object(h.a)(Yl,"AppForOfficeSettingCreatedEventListener",null,[848,106]);class qj{constructor(M,ca){this.ia=M;this.Ot=ca}register(){this.Ot.Yj(Object(D.a)(this,this.Dxh,"taskpaneAppCreatedEventHandler"))}dispose(){this.Ot.tm(Object(D.a)(this,
this.Dxh,"taskpaneAppCreatedEventHandler"))}Dxh(M,ca){if(M=ca.node)M=new Ff.a(M),ca.property.id===Bb.a.dZ.id&&1===M.yy&&(ca=ca.node.sa(Bb.a.dZ,null))&&this.ia.La(lh.a.Hfb,2,ca)}}Object(h.a)(qj,"AppForOfficeTaskpaneAppCreatedEventListener",null,[848,106]);var pl=d(637),Il=d(522),$m=d(878);class Hj{constructor(M,ca,Na,zb,$b){this.Fzb=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.jb&&A.AFrameworkApplication.Aa.jb.tW;this.cT=M;this.wq=ca;this.Ob=Na;this.AF=zb;this.Nz=$b}register(M){M.controlStatusChanged=
Object(D.a)(this,this.LZg,"onControlStatusChanged");M.notifyHost=Object(D.a)(this,this.V0g,"onOsfNotifyHost")}LZg(M){let ca=this.AF.Z4f(M.getSolutionId());const Na=this.AF.UV(M.getID());Na&&Na.So&&M.isFirstParty()&&(ca=this.AF.Z4f(Na.So.id));if(ca&&Na&&ca.previousSibling){var zb=M.getSolutionId(),$b=M.getVersion(),Tc=null,hd=null;hd=M.isFirstParty()?OSF.OsfManifestManager.getCachedManifest(zb,""):OSF.OsfManifestManager.getCachedManifest(zb,$b);M.isFirstParty()&&Na.wha?Tc=Na.wha:hd&&(Tc=hd.getDefaultDisplayName(),
Na.wha=Tc);if(0!==Na.yy){if(Gf.a("TaskpaneIconUrlPassing")&&this.Fzb){$b=null;hd&&($b=hd.getDefaultIconUrl());hd=null;Gf.a("UpdateTaskpaneWithInstanceId")&&(hd=Object.assign(new $m.a,{getContent:()=>ca,type:"LegacyTaskPaneProps"}));const Hd=Object.assign(new pl.a,{title:Tc,hideHeader:Gf.a("UpdateTaskpaneWithInstanceId"),iconUrl:$b,width:320,location:2,contentProps:hd,onOpen:()=>{},onClose:()=>{},isModernPane:!0});pb.UISurfaces.Ms().then(le=>{if(Gf.a("UpdateTaskpaneWithInstanceId")){const ge=M.getID();
le.updateTaskPane(ge,Hd)}else le.updateTaskPane(zb,Hd);return null}).catch(()=>{lb.a.J(512360770,220,10,"taskPaneAPI.UpdateTaskpane() fails for {0}",zb)})}ca.previousSibling&&(ca.previousSibling.innerText===Tc||!M.isFirstParty()&&""!==ca.previousSibling.innerText)||!Tc||!Na.taskpane||Na.taskpane.isForUILessAction||(ca.previousSibling.innerText=Tc,this.Ob.rRa())}}}aUj(M,ca,Na){this.V0g(M,ca,Na)}V0g(M,ca,Na){3===ca?(this.cT.lmg(),this.Nz.Bf(rg.a.vE),Na?this.wq.EK().La(lh.a.dSc,2,Na):m.ULS.sendTraceTag(512360769,
806,10,"InsertAgave: should have valid insert agave parameters")):36===ca?Na?this.wq.EK().La(lh.a.dSc,2,Na):m.ULS.sendTraceTag(512360768,806,10,"InsertDevManifest: should have valid insert agave parameters"):37===ca?Na&&(M=Object(C.a)(Object,Na),M={["ak1"]:this.cT.En.getDevManifestInvalidUrlErrorString(M.manifestUrl)},this.wq.EK().La(md.a.mIb,2,M)):2===ca?this.cT.lmg():9===ca?this.wq.ld.Hsa&&this.wq.ld.htg&&this.wq.EK().La(md.a.bFe,2,Na):5===ca||6===ca?(Na=this.AF.UV(M))?0===Na.yy?this.Nz.qTe(ca):
this.Nz.YVi(M,ca):m.ULS.sendTraceTag(512360738,806,10,String.format("Failed to find the cached app with instance Id: {0}",M)):13===ca||14===ca?(Na=this.AF.UV(M))?0===Na.yy||Na.taskpane&&Na.taskpane.isForUILessAction?this.cT.notifyAgave(M,13===ca?11:12):(xe.a.eg&&document.activeElement.blur(),this.Fzb&&13===ca?Jd.FocusManager.instance().vLe(rg.a.IO):this.Nz.H6f(M)):m.ULS.sendTraceTag(512360737,806,10,String.format("Failed to find the cached app with instance Id: {0}",M)):16===ca?(ca=this.AF.UV(M))?
0===ca.yy&&this.Nz.c3f():m.ULS.sendTraceTag(512360736,806,10,String.format("Failed to find the cached app with instance Id: {0}",M)):17===ca||18===ca?(ca=this.AF.UV(M))?0===ca.yy?this.Nz.c3f():(xe.a.eg&&document.activeElement.blur(),this.Nz.H6f(M)):m.ULS.sendTraceTag(512360735,806,10,String.format("Failed to find the cached app with instance Id: {0}",M)):1===ca||10===ca?(ca=this.AF.UV(M))?0===ca.yy&&this.cT.txh(M):m.ULS.sendTraceTag(512360734,806,10,String.format("Failed to find the cached app with instance Id: {0}",
M)):8===ca?(M={["ak1"]:this.cT.En.getManifestInvaildErrorString()},this.wq.EK().La(md.a.mIb,2,M)):15===ca?(M=this.Nz.lsl(M))&&(ca=this.cT.Psb(M))&&ca.taskpane&&!ca.taskpane.isForUILessAction&&this.cT.notifyAgave(M,11):23===ca?X.a.sendOtelEvent(Object.assign(new Il.a,{otelEvent:Na})):38===ca?X.a.sendOtelCustomerContent(Object.assign(new Il.a,{otelEvent:Na})):32===ca?(M=Object(C.a)(Object,Na).solutionId,this.cT.yQf(M)):34===ca&&(M=Object(C.a)(Object,Na),ca=M.controlId,Na=new ud("",M.ownerAddinSolutionId,
new Oh,!0),M.originalControlId=Na?Na.BWf(ca):ca)}}Object(h.a)(Hj,"AppForOfficeAppEventHandler",null,[887]);var el=d(248),ql=d(1184);class ri{static a3h(M){var ca=M.getAttribute("style");ca=ca?ca.toString():"";0>ca.indexOf("pointer-events: auto")&&M.className!==ri.wGb&&(Gf.a("Microsoft.Office.SharedOnline.FixBug6808089")?M.style.pointerEvents="auto":M.setAttribute("style",ca+" pointer-events: auto"))}static TDf(M){var ca=M.getAttribute("style");ca=ca?ca.toString():"";0>ca.indexOf("pointer-events: none")&&
M.className===ri.wGb&&(Gf.a("Microsoft.Office.SharedOnline.FixBug6808089")?M.style.pointerEvents="none":M.setAttribute("style",ca+" pointer-events: none"))}static wQk(M){var ca=M.getAttribute("style");ca=ca?ca.toString():"";0<=ca.indexOf("pointer-events: none")&&M.className===ri.wGb&&(Gf.a("Microsoft.Office.SharedOnline.FixBug6808089")?M.style.pointerEvents="":(ca=ca.replace("pointer-events: none",""),M.setAttribute("style",ca)))}}ri.vYk="AppForOfficeContainer EditAppForOfficeContainer";ri.wGb="AppForOfficeContainer EditAppForOfficeHidden EditAppForOfficeContainer";
ri.vIe="";Object(h.a)(ri,"AppForOfficeViewHelper",null,[]);var un=d(963),vn=d(138);class Ci{constructor(M,ca,Na,zb,$b){this.Oz=this.JEg=null;this.IAb=!1;this.OA=ca;this.Zh=Na;ca&&ca.taskpane&&ca.taskpane.isForUILessAction?(this.Oz=null,this.JEg=Na):(this.Oz=new vn.a,this.Oz.ee.className=ri.wGb,this.Oz.ee.id="AppForOffice_"+this.OA.instanceId,this.Oz.ee.style.width="100%",this.Oz.ee.style.height="100%",this.Oz.ee.style.position="relative",this.Oz.ee.style.left="0",this.Oz.ee.style.top="0",Na.appendChild(this.Oz.ee));
this.Zd=$b}dispose(){this.qPk();this.OA=null}qPk(){this.Oz&&this.Oz.qq()}oKe(M){M&&this.Oz&&M!==this.Zh&&(this.Zh=M,M.appendChild(this.Oz.ee),this.IAb&&this.wca())}TAa(M){M&&(M.ee.innerHTML="")}Pcl(M,ca,Na=null,zb=null,$b=!1){this.l0h(M,ca,Na,zb,$b)}FAc(M,ca,Na){ca=this.khc(ca);M.insertBlankControlWithErrorUX(ca,()=>{Na()})}l0h(M,ca,Na=null,zb=null,$b=!1){this.IAb=$b;this.TAa(this.Oz);this.OA&&M&&(this.TIa(ca,null),ca=this.khc(this.Oz?this.Oz.ee:this.JEg,zb,M),ca.virtualOsfControlActivationCallback=
Na,M.insertOsfControl(ca),M.setActivationCompletedStatus(this.OA.instanceId,!0),$b&&this.wca())}wca(){if(this.Oz){var M=this.Oz.xa;if(M){var ca=M.parentNode;ca&&"OsfAddinOverlay"!==ca.className&&(el.a.instance.ob(Ed.a.Sla,ca,Object(D.a)(this,this.Ceh,"removePointerEventsStyleHandler")),ql.a.instance.ob(Ed.a.drop,ca,Object(D.a)(this,this.Ceh,"removePointerEventsStyleHandler")),el.a.instance.ob(Ed.a.Tla,ca,Object(D.a)(this,this.b3h,"addPointerEventsStyleHandler")),ri.TDf(M))}}}Ceh(M){M=M.mc.target;
for(let ca=0;ca<M.childNodes.length;++ca)ri.wQk(M.childNodes[ca]);return!0}b3h(M){M=M.mc.target;for(let ca=0;ca<M.childNodes.length;++ca)ri.TDf(M.childNodes[ca]);return!0}TIa(M,ca){this.Oz&&(M?(null!=ca&&this.oKe(ca),this.Oz.ee.className=""===ri.vIe?ri.vYk:ri.vIe,ri.a3h(this.Oz.xa)):(this.Oz.ee.className!==ri.wGb&&(ri.vIe=this.Oz.ee.className),this.Oz.ee.className=ri.wGb))}pKe(M){this.Oz&&(this.Oz.ee.style.zIndex=String(M))}khc(M,ca=null,Na=null){const zb={};zb.div=M;zb.id=this.OA.instanceId;M=this.OA.So.id;
const $b=this.OA.taskpane?this.OA.taskpane.ownerAddinSolutionId:null;if(Na&&$b){const Tc=this.OA.taskpane.isForUILessAction;this.OA.Rv?zb.sharedRuntimeId=this.OA.Rv.Nwa:(Na=Na.getOsfControl($b).getManifest(),zb.sharedRuntimeId=this.Zd.getSharedRuntimeId(Na,Tc,M,$b));zb.initialDisplayMode=Tc?1:2}zb.hostInfoFlags=0;zb.sharedRuntimeId?(zb.hostInfoFlags|=1,zb.solutionId=$b):ca?(zb.solutionId=ca.assetId,zb.sourceLocationOverrideResourceId=ca.sourceLocationOverrideResourceId,zb.featureGates=A.AFrameworkApplication.fa.S5i(ca.assetId)):
zb.solutionId=M;zb.version=this.OA.So.version;zb.storeId=this.OA.So.store;zb.storeType=this.OA.So.storeType;zb.assetId=null;zb.assetStoreId=null;zb.settings=this.OA.settings;zb.reason=un.a.contains(this.OA.So.id,this.OA.yy,this.OA.So.store,this.OA.So.storeType,this.OA.So.version)?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;0===this.OA.yy?zb.osfControlType=0:1===this.OA.yy&&(zb.osfControlType=1);A.AFrameworkApplication.jqa||
OSF.OsfControl.isFirstPartyStoreString(zb.storeType)||(m.ULS.sendTraceTag(512369924,802,50,(0===this.OA.yy?"Content":"Taskpane")+" web add-in disabled by doc IRM"),zb.hostInfoFlags|=4);this.OA.taskpane?(zb.isForUILessAction=this.OA.taskpane.isForUILessAction,zb.ownerAddinSolutionId=$b,zb.ownerAddinStoreType=this.OA.taskpane.ownerAddinStoreType):zb.isForUILessAction=!1;return zb}}Object(h.a)(Ci,"AppForOfficeView",null,[849]);var Jl=d(276),Aa=d(73);class wn{constructor(M,ca,Na,zb,$b,Tc,hd,Hd,le,ge,
Zd,Oe,tc,Xh,ii){new Jl.a(0,0,0,0);this.t$a=this.GN=this.mo=null;this.KSg=ResourceStrings.l_AddinPane;this.NE=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.jb&&A.AFrameworkApplication.Aa.jb.tW;this.pb=tf.a.Ce();this.Ob=Tc;this.Wc=Hd;this.Nz=hd;this.fe=le;this.Qt=M;this.XG=ca;this.wq=Na;this.v0j=zb;this.Db=$b;this.Ar=ge;this.Zd=Zd;this.Mc=Oe;this.jc=tc;this.fH=Xh;this.Xta=ii;this.initialize()}dispose(){this.Wc&&this.mo&&(this.Wc.xb(Ed.a.click,this.mo,Object(D.a)(this,this.$Aa,"closePaneButtonClickHandler")),
this.Ar.removeHandler(this.mo,Ed.a.Xf,Object(D.a)(this,this.Fkg,"handleShortCutsOnCloseButton")),this.mo=null);this.Mc.UFb(Object(D.a)(this,this.jz,"onUnifiedAppStateChanged"));this.Ob.SFb(Object(D.a)(this,this.zX,"onSetOffline"));this.Nz.zeh(this)}initialize(){const M="label_"+this.XG;this.pb.className=this.Qt?"AddinPane AddinPaneRTL":"AddinPane AddinPaneLTR";this.pb.style.position="absolute";this.pb.style.display="none";this.pb.setAttribute(Mc.a.Ye,Mc.a.GAa);this.pb.setAttribute(Mc.a.W1,M);this.mo=
this.mBa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.mo,"AddinPaneCloseButton");this.Wc.ob(Ed.a.click,this.mo,Object(D.a)(this,this.$Aa,"closePaneButtonClickHandler"));this.Ar.addHandler(this.mo,Ed.a.Xf,Object(D.a)(this,this.Fkg,"handleShortCutsOnCloseButton"));this.pb.appendChild(this.mo);this.t$a=tf.a.Ce();this.t$a.className="PaneLabel";this.t$a.id=M;this.t$a.setAttribute(Mc.a.Ye,Mc.a.OIf);this.t$a.setAttribute(Mc.a.MUb,"1");this.pb.appendChild(this.t$a);this.GN=tf.a.Ce();
this.GN.className="AddinPanePanelResize";this.pb.appendChild(this.GN);this.Mc.cba(Object(D.a)(this,this.jz,"onUnifiedAppStateChanged"));this.Ob.y3a(Object(D.a)(this,this.zX,"onSetOffline"))}jz(M,ca){ca.R8a&&!this.jc.un&&this.isVisible&&this.amg()}zX(M){M&&this.isVisible&&this.amg()}amg(){this.kp(!1);this.wq.EK().La(lh.a.$Qc,2,this.XG);this.nde()||this.dispose()}layout(M,ca){const Na=ca?M.PC(this.width):M.QC(this.width);this.isVisible&&(ca?Na.PC(1):Na.QC(1),this.GN.style.height=(M.height-this.mo.clientHeight-
this.t$a.clientHeight).toString()+"px",this.GN.style.width="100%");tf.a.A0(this.pb,Na);return M}n8k(M){this.KSg=M}kp(M){const ca=this.Db!==M;if(this.Db=M)this.pb.style.display="block";const Na=this.nde();this.fH.Y4k(this.XG,Na);this.NE?this.fH.bM(this,this.Db,this.Xta?this.Xta.CU:this.KSg,this.XG):this.Ob.rRa();Na&&(this.mo.style.visibility=M?"visible":"hidden",ca&&this.Zd.EUi(this.XG,M))}nde(){return this.Zd.Ssa(this.XG)}$Aa(){this.kp(!1);this.wq.EK().La(lh.a.$Qc,2,this.XG);this.nde()||this.dispose();
return!0}lBa(M,ca,Na,zb,$b,Tc){const hd=tf.a.SB();hd.alt=$b;hd.className=Aa.getImageClassWithCluster(M,zb);hd.src=this.fe.hk(M+".png");hd.setAttribute("Unselectable","on");M=tf.a.Fn();M.className=ca+" cui-img-cont-float";M.appendChild(hd);ca=tf.a.Fn();ca.className=Na;ca.setAttribute("Unselectable","on");ca.appendChild(M);Na=tf.a.vba();Na.className="CommentPaneNoBorderButton cui-ctl";Na.title=$b;Na.setAttribute(Mc.a.Ye,Mc.a.hu);Na.tabIndex=0;Na.appendChild(ca);Tc&&($b=tf.a.Fn(),$b.className="cui-ctl-mediumlabel",
$b.setAttribute("Unselectable","on"),$b.innerText=Tc,Na.appendChild($b));return Na}mBa(M,ca){return this.lBa(M,"cui-img-16by16","cui-ctl-iconContainer",ca,CommonUIStrings.l_DialogClose,null)}Fkg(M){M.keyCode===Ie.a.lq||M.keyCode===Ie.a.NO?(this.$Aa(null),M.preventDefault(),M.stopPropagation()):M.keyCode===Ie.a.Iq&&(M.shiftKey?this.Zd.notifyAgave(this.XG,12):this.Zd.notifyAgave(this.XG,11),M.preventDefault(),M.stopPropagation())}get isVisible(){return this.Db}get xa(){return this.pb}get order(){return 6}get width(){return this.isVisible?
this.v0j:0}get fCc(){return this.GN}get Aqi(){return this.mo}get id(){return this.XG}}Object(h.a)(wn,"AddInPane",null,[885,716,106]);class Ij{constructor(M,ca,Na,zb,$b,Tc,hd,Hd,le,ge){this.wq=M;this.Ob=ca;this.Nz=Na;this.Wc=zb;this.fe=$b;this.A_=Tc;this.Zd=hd;this.Mc=Hd;this.jc=le;this.fH=ge}oGc(M,ca,Na,zb,$b){return new wn(M,ca,this.wq,Na,zb,this.Ob,this.Nz,this.Wc,this.fe,this.A_,this.Zd,this.Mc,this.jc,this.fH,$b)}m2(M){return new Ff.a(M)}Txi(M){return new Hj(this.Zd,this.wq,this.Ob,M,this.Nz)}KQd(M,
ca,Na,zb,$b){return new Ci(M,ca,Na,zb,$b)}}Object(h.a)(Ij,"AppforOfficeClassFactory",null,[845]);class Ig{constructor(M){this.sIg=this.AQ=!1;this.Fm=Wh.a.rY();this.XEg=M;td.sKk(this.XEg)}Dv(){this.sIg=!0}dispose(){if(this.sIg&&!this.AQ){var M=Wh.a.rY();td.rKk(this.XEg,this.Fm,M);this.AQ=!0}}}Object(h.a)(Ig,"ApiCallLogger",null,[106]);class vf{get formatting(){return 0}set formatting(M){}get sourceSlideIds(){return null}set sourceSlideIds(M){}get targetSlideId(){return null}set targetSlideId(M){}getTypeName(){return"Microsoft.Office.PowerPoint.InsertSlideOptions"}invokePropertyGet(M){switch(M){case 1:return this.formatting;
case 4:return this.sourceSlideIds;case 5:return this.targetSlideId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,ca){switch(M){case 1:this.formatting=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"int");return;case 4:this.sourceSlideIds=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"Array<string>");
return;case 5:this.targetSlideId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}
Object(h.a)(vf,"InsertSlideOptions",null,[]);class xn{constructor(){this.controlId=this.appId=null}}Object(h.a)(xn,"RequestContext",null,[]);class sc{constructor(){this.xxf=this.Qef=null}get layoutId(){return this.Qef}set layoutId(M){this.Qef=M}get slideMasterId(){return this.xxf}set slideMasterId(M){this.xxf=M}getTypeName(){return"Microsoft.Office.PowerPoint.AddSlideOptions"}invokePropertyGet(M){switch(M){case 1:return this.layoutId;case 2:return this.slideMasterId}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,ca){switch(M){case 1:this.layoutId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return;case 2:this.slideMasterId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}Object(h.a)(sc,"AddSlideOptions",null,[]);class Xf{constructor(M,ca,Na){this.P7b=M;this.B8=ca;this.Zd=Na}getAppRuntimeStartState(){if(!this.Zd.Ssa(this.B8))throw Error.invalidOperation("GetAppRuntimeStartState: Invalid controlId or it is not shared runtime.");return this.Zd.AZi(this.P7b)?1:0}setAppRuntimeStartState(M){if(!this.Zd.Ssa(this.B8)||0!==M&&1!==M)throw Error.invalidOperation("SetAppRuntimeStartState: Invalid controlId or state, or it is not shared runtime.");
this.Zd.$sl(this.P7b,1===M)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimePersistenceService"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,
ca){switch(M){case 2:return this.r_i();case 1:return this.A2k(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}r_i(){return this.getAppRuntimeStartState()}A2k(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");this.setAppRuntimeStartState(M);return null}}Object(h.a)(Xf,"AppRuntimePersistenceService",null,[]);class Nc{constructor(M,
ca){this.B8=M;this.Zd=ca}getAppRuntimeState(){if(!this.Zd.Ssa(this.B8))throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or it is not shared runtime.");return this.Zd.zZi(this.B8)?2:1}setAppRuntimeState(M){if(!this.Zd.Ssa(this.B8)||2!==M&&1!==M)throw Error.invalidOperation("GetAppRuntimeState: Invalid controlId or state, or it is not shared runtime.");this.Zd.$Gb(this.B8,2===M)}getTypeName(){return"Microsoft.AppRuntime.AppRuntimeService"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,ca){switch(M){case 2:return this.s_i();case 1:return this.B2k(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,
ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}s_i(){return this.getAppRuntimeState()}B2k(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");this.setAppRuntimeState(M);return null}}Object(h.a)(Nc,"AppRuntimeService",null,[]);class Jf{insertHyperLink(){}insertSlideFromContent(){return 0}getTypeName(){return"Microsoft.Office.PowerPoint.Application"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,ca){switch(M){case 1001:return this.FBj(ca);case 1002:return this.cCj(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}FBj(M){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"string");this.insertHyperLink(ca,M);return null}cCj(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.insertSlideFromContent(M)}}Object(h.a)(Jf,"Application",null,[]);class fl{constructor(M,
ca){this.bG=!1;this._id=M;this.OAd=ca}get enabled(){return this.bG}set enabled(M){this.bG=M;A.AFrameworkApplication.Ta.La(md.a.ZZb,2,{["DynamicAddinCommandsMethodDispatchId"]:1,["SolutionId"]:this.OAd,["SourceControlId"]:this.id,["MethodData"]:this.enabled})}get id(){return this._id}get label(){return null}setEnabled(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonButton"}invokePropertyGet(M){switch(M){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,ca){switch(M){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,ca){switch(M){case 5:return this.T3k(ca);
case 1:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}T3k(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"boolean");this.setEnabled(M);return null}xH(){this._OnAccess();return null}}Object(h.a)(fl,"RibbonButton",null,[]);class Xj{constructor(){}get id(){return null}setVisibility(){}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.RibbonTab"}invokePropertyGet(M){switch(M){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,ca){switch(M){case 3:return this.N8k(ca);case 1:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,
ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}N8k(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"boolean");this.setVisibility(M);return null}xH(){this._OnAccess();return null}}Object(h.a)(Xj,"RibbonTab",null,[]);class ff{constructor(M,ca){this.QKa=this.tR=this.Jwc=null;this.Irc=M;this.B_a=ca;ja.a.Va(this.Irc)||(this.QKa=ca.Psb(M),this.Jwc=(this.tR=this.B_a?this.B_a.En:null)?this.tR.getOsfControl(this.Irc):null)}get buttons(){return null}executeRequestCreate(){return null}executeRequestUpdate(){return null}getButton(M){let ca=
null;if(!this.Vug())return this.MTf();if(!ja.a.Va(M)&&this.QKa&&this.QKa.taskpane){if(!this.ZOf(M))return this.XTf(M);ca=new fl(M,this.QKa.taskpane.ownerAddinSolutionId)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)}getTab(M){let ca=null;if(!this.Vug())return this.MTf();if(!ja.a.Va(M)&&this.QKa&&this.QKa.taskpane){if(!this.ZOf(M))return this.XTf(M);ca=new Xj(M)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(ca)}_OnAccess(){}getTypeName(){return"Microsoft.DynamicRibbon.DynamicRibbon"}invokePropertyGet(M){switch(M){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){switch(M){case 1:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){switch(M){case 7:return this.NPi(ca);
case 6:return this.OPi(ca);case 3:return this.l0i(ca);case 5:return this.bhj(ca)}M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}NPi(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.executeRequestCreate(M)}OPi(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.executeRequestUpdate(M)}l0i(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getButton(M)}bhj(M){M=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getTab(M)}xH(){this._OnAccess();return null}XTf(M){return this.iUf("ControlIdNotFound",ResourceStrings.L_RichApiErrorMessage_ControlIdNotFound+M)}MTf(){return this.iUf("ApiNotAvailable",ResourceStrings.L_RichApiErrorMessage_ApiNotAvailable)}Vug(){const M=!ja.a.Va(this.Jwc.getSharedRuntimeId());lb.a.J(512497821,802,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",M));return M}ZOf(M){if(this.Jwc){var ca=
this.Jwc.getManifest();if(ca&&(ca=ca.getRibbonExtensionControlMap()))return M in ca||this.Wmi(M)}return!1}Wmi(M){var ca=this.aUi();if(ca){ca=ca.L_f;for(const Na of ca.tabs){if(Na.id===M)return!0;for(const zb of Na.groups)for(const $b of zb.controls){if($b.id===M)return!0;if("Menu"===$b.type){ca=$b;for(const Tc of ca.items)if(Tc.id===M)return!0}}}}return!1}aUi(){return Q.getInstance().j6a(this.QKa.taskpane.ownerAddinStoreType,this.QKa.taskpane.ownerAddinSolutionId,1)}iUf(M,ca){return OfficeExtension.WacRuntime.Utility.createPromise((Na,
zb)=>{zb(OfficeExtension.WacRuntime.Utility.createRichApiException(M,ca))})}}Object(h.a)(ff,"DynamicRibbon",null,[]);class rl{constructor(M,ca,Na,zb){this.BZe="";this.Ysc=0;this.XF=M;this._id=ca;this.EQb=Na;this.B_a=zb}get id(){return this._id}_RegisterStateChange(){this.Ysc||this.XF.execute(M=>{OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.EQb,this._id,1);this.BZe=M.sfb(this._id,ca=>{this.B_a.GUi(this.EQb,this._id,JSON.stringify(ca))})});this.Ysc++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}_UnregisterStateChange(){this.Ysc--;
this.Ysc||this.XF.execute(M=>{M.HFb(this._id,this.BZe)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}getTypeName(){return"Microsoft.Office.Licensing.LicenseFeature"}invokePropertyGet(M){switch(M){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){switch(M){case 6:return this.EIh();case 7:return this.IIh()}M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}EIh(){return this._RegisterStateChange()}IIh(){return this._UnregisterStateChange()}}Object(h.a)(rl,"LicenseFeature",
null,[]);class Jj{get scopes(){return null}set scopes(M){}getTypeName(){return"Microsoft.Office.Licensing.MsaDeviceTicketOptions"}invokePropertyGet(M){switch(M){case 1:return this.scopes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,ca){switch(M){case 1:this.scopes=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");
return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}Object(h.a)(Jj,"MsaDeviceTicketOptions",null,[]);class ba{constructor(M,ca){this.XF=
Ub.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.EQb=M;this.B_a=ca}getFeatureTier(M,ca){return OfficeExtension.WacRuntime.Utility.createPromise(Na=>{const zb=1===ca?1:2===ca?2:0;this.XF.execute($b=>{$b.getFeatureTier(M,zb).then(Tc=>{Na(this.s8i(Tc))},()=>{Na(ca)})})})}getLicenseFeature(M){M=new rl(this.XF,M,this.EQb,this.B_a);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}getMsaDeviceTicket(){return null}isFeatureEnabled(M,ca){return OfficeExtension.WacRuntime.Utility.createPromise(Na=>
{this.XF.execute(zb=>{zb.isFeatureEnabled(M,ca).then($b=>{Na($b)},()=>{Na(ca)})})})}isFreemiumUpsellEnabled(){return OfficeExtension.WacRuntime.Utility.createPromise(M=>{this.XF.execute(ca=>{ca=ca.isFreemiumUpsellEnabled();M(ca)})})}launchUpsellExperience(M){if(this.B_a.En.getOsfControl(this.EQb).isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(()=>{this.XF.execute(ca=>{ca.launchUpsellExperience(M)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException("AccessDenied",
"");}_TestFireStateChangedEvent(){}getTypeName(){return"Microsoft.Office.Licensing.License"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,
ca){switch(M){case 7:return this.g$i(ca);case 6:return this.GIh(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){switch(M){case 2:return this.r5i(ca);case 5:return this.r8i(ca);case 1:return this.eIj(ca);case 3:return this.RIj();case 4:return this.qUj(ca)}M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}r5i(M){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
1,"int");return this.getFeatureTier(ca,M)}r8i(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getLicenseFeature(M)}g$i(M){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string"),Na=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,2,Jj);return this.getMsaDeviceTicket(ca,Na,M)}eIj(M){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"boolean");return this.isFeatureEnabled(ca,M)}RIj(){return this.isFreemiumUpsellEnabled()}qUj(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.launchUpsellExperience(M)}GIh(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");this._TestFireStateChangedEvent(M);return null}s8i(M){switch(M){case 1:return 1;case 2:return 2;default:return 0}}}Object(h.a)(ba,"License",
null,[]);class Zl{get height(){return 0}set height(M){}get left(){return 0}set left(M){}get top(){return 0}set top(M){}get width(){return 0}set width(M){}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeAddOptions"}invokePropertyGet(M){switch(M){case 1:return this.height;case 2:return this.left;case 3:return this.top;case 4:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,
ca){switch(M){case 1:this.height=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 2:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 3:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 4:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,
ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}}Object(h.a)(Zl,"ShapeAddOptions",null,[]);class bg{constructor(M,ca,Na){this.OBe=!1;this.YHg=!0;this.P7b=M;this.B8=ca;this.Zd=Na}hostName(){return"PowerPointOnline"}appId(){return this.P7b}controlId(){return this.B8}createInstance(M){switch(M){case "Microsoft.Office.PowerPoint.AddSlideOptions":return new sc;
case "Microsoft.Office.PowerPoint.Application":return new Jf;case "Microsoft.Office.PowerPoint.InsertSlideOptions":return new vf;case "Microsoft.Office.PowerPoint.ShapeAddOptions":return new Zl;case "Microsoft.AppRuntime.AppRuntimeService":return new Nc(this.B8,this.Zd);case "Microsoft.AppRuntime.AppRuntimePersistenceService":return new Xf(this.P7b,this.B8,this.Zd);case "Microsoft.Office.Licensing.License":return new ba(this.B8,this.Zd);case "Microsoft.DynamicRibbon.DynamicRibbon":return new ff(this.B8,
this.Zd)}m.ULS.sendTraceTag(588375570,802,10,"Typename: {0} is an invalid parameter. Only instance for Application can be created through this method.",M);return null}static Qq(M){const ca=Ub.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManager").xCf;M||(ca.YHg=!1);return!ca.OBe}}Object(h.a)(bg,"RichApiHost",null,[886]);class vi{constructor(M,ca,Na){this.Gpd=this.Ph=-1;this.zB=Na;0<=M&&(this.Ph+=M,this.Gpd=0<ca?M+ca<this.zB.getCount()?M+ca:this.zB.getCount():this.zB.getCount())}get_current(){return-1<
this.Ph&&this.Ph<this.Gpd?this.zB.getItemAt(this.Ph):null}moveNext(){const M=this.zsl();return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}zsl(){return this.Ph+1<this.Gpd?(this.Ph++,!0):!1}}Object(h.a)(vi,"ElementEnumerator",null,[930]);class Vg{constructor(M,ca){this.Vza=M;this.NR=ca}get fill(){bg.Qq(!1);return null}get height(){bg.Qq(!1);return 0}set height(M){bg.Qq(!1)}get id(){const M=new Ig(28);try{lb.a.J(572643292,802,50,"PptApi Call - Shape.GetId");if(!this.Vza)return lb.a.J(577525073,
802,10,"Shape is null."),"";const ca=this.Vza.get_shapeId().toString();M.Dv();return ca}finally{M&&M.dispose()}}get left(){bg.Qq(!1);return 0}set left(M){bg.Qq(!1)}get lineFormat(){bg.Qq(!1);return null}get name(){bg.Qq(!1);return null}set name(M){bg.Qq(!1)}get tags(){bg.Qq(!1);return null}get textFrame(){bg.Qq(!1);return null}get top(){bg.Qq(!1);return 0}set top(M){bg.Qq(!1)}get type(){bg.Qq(!1);return 0}get width(){bg.Qq(!1);return 0}set width(M){bg.Qq(!1)}deleteObject(){if(bg.Qq(!0)){var M=new Ig(45);
try{lb.a.J(572527067,802,50,"PptApi Call - Shape.Delete");const ca=Object(C.a)(120,this.NR);ca&&(ca.LGi(Object(C.a)(4,this.Vza)),M.Dv())}finally{M&&M.dispose()}}}getParentSlide(){bg.Qq(!1);return null}getParentSlideLayout(){bg.Qq(!1);return null}getParentSlideLayoutOrNullObject(){bg.Qq(!1);return null}getParentSlideMaster(){bg.Qq(!1);return null}getParentSlideMasterOrNullObject(){bg.Qq(!1);return null}getParentSlideOrNullObject(){bg.Qq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Shape"}invokePropertyGet(M){switch(M){case 11:return this.fill;
case 5:return this.height;case 1:return this.id;case 6:return this.left;case 12:return this.lineFormat;case 7:return this.name;case 3:return this.tags;case 13:return this.textFrame;case 8:return this.top;case 9:return this.type;case 10:return this.width}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M,ca){switch(M){case 5:this.height=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 6:this.left=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 7:this.name=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"string");return;case 8:this.top=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return;case 10:this.width=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ca,0,"number");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){switch(M){case 4:return this.hTd();case 15:return this.Laj();case 16:return this.Maj();case 18:return this.Naj();case 17:return this.Oaj();case 19:return this.Paj();case 20:return this.Qaj();case 2:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}hTd(){this.deleteObject();
return null}Laj(){return this.getParentSlide()}Maj(){return this.getParentSlideLayout()}Naj(){return this.getParentSlideLayoutOrNullObject()}Oaj(){return this.getParentSlideMaster()}Paj(){return this.getParentSlideMasterOrNullObject()}Qaj(){return this.getParentSlideOrNullObject()}xH(){this._OnAccess();return null}}Object(h.a)(Vg,"Shape",null,[]);class Di{constructor(M){this.wOb=this.Wmb=null;this.NR=M;if(M=Object(C.a)(120,this.NR))this.Wmb=M.gRa();this.Gyk()}Gyk(){this.wOb=new ya.ScriptSharpLegacyMap;
if(this.Wmb)for(const M of this.Wmb){const ca=new Vg(M,this.NR);this.wOb.add(ca.id,ca)}}addGeometricShape(){bg.Qq(!1);return null}addLine(){bg.Qq(!1);return null}addTextBox(){bg.Qq(!1);return null}getCount(){const M=new Ig(29);try{lb.a.J(572643288,802,50,"PptApi Call - ShapeCollection.GetCount");if(!this.Wmb)return lb.a.J(577525071,802,50,"In Shape.GetCount(), _shapes is null"),0;M.Dv();return this.Wmb.length}finally{M&&M.dispose()}}getItem(M){const ca=new Ig(31);try{lb.a.J(572643289,802,50,"PptApi Call - ShapeCollection.GetItem");
try{const Na=this.wOb.ga(M);ca.Dv();return Na}catch(Na){throw lb.a.J(577525069,802,15,String.format("In Shape.GetItem(id), Exception: {0} ",Na.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(M){const ca=new Ig(30);try{lb.a.J(572643290,802,50,"PptApi Call - ShapeCollection.GetItemAt");try{const Na=this.Wmb[M].get_shapeId().toString(),zb=this.wOb.ga(Na);
ca.Dv();return zb}catch(Na){throw lb.a.J(577525067,802,15,String.format("In Shape.GetItemAt(index), Exception: {0} ",Na.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");}}finally{ca&&ca.dispose()}}getItemOrNullObject(M){const ca=new Ig(32);try{lb.a.J(572643291,802,50,"PptApi Call - ShapeCollection.GetItemOrNullObject");let Na;({value:Na}=this.wOb.Rf(M));ca.Dv();return Na}finally{ca&&
ca.dispose()}}_OnAccess(){}getAsyncEnumerator(M,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new vi(M,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.ShapeCollection"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,ca){switch(M){case 6:return this.U1h(ca);case 7:return this.t2h(ca);case 8:return this.d4h(ca);case 1:return this.S6a();case 2:return this.g7a(ca);case 5:return this.f7a(ca);case 3:return this.h7a(ca);case 4:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}U1h(M){const ca=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,Zl);return this.addGeometricShape(ca,M)}t2h(M){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,Zl);return this.addLine(ca,M)}d4h(M){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
1,Zl);return this.addTextBox(ca,M)}S6a(){return this.getCount()}g7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItem(M)}f7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");return this.getItemAt(M)}h7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItemOrNullObject(M)}xH(){this._OnAccess();return null}}Object(h.a)(Di,"ShapeCollection",null,[909]);class Ei{constructor(M){this.Ryc=M}get id(){const M=
new Ig(15);try{lb.a.J(572643276,802,50,"PptApi Call - SlideLayout.GetId");if(!this.Ryc)return lb.a.J(576581654,802,10,"SlideLayout is null."),"";const ca=this.Ryc.Id.toString();M.Dv();return ca}finally{M&&M.dispose()}}get name(){const M=new Ig(16);try{lb.a.J(572643277,802,50,"PptApi Call - SlideLayout.GetName");if(!this.Ryc)return lb.a.J(576581655,802,10,"SlideLayout is null."),"";const ca=this.Ryc.Name;M.Dv();return ca}finally{M&&M.dispose()}}get shapes(){bg.Qq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayout"}invokePropertyGet(M){switch(M){case 1:return this.id;
case 3:return this.name;case 4:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){switch(M){case 2:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}xH(){this._OnAccess();return null}}Object(h.a)(Ei,"SlideLayout",null,[]);class Li{constructor(M){this.xOb=null;this.oSb=M;this.Hyk()}Hyk(){this.xOb=new ya.ScriptSharpLegacyMap;if(this.oSb)for(const M of this.oSb){const ca=new Ei(M);this.xOb.add(ca.id,ca)}}getCount(){const M=new Ig(17);try{lb.a.J(572643272,802,50,"PptApi Call - SlideLayoutCollection.GetCount");if(!this.oSb)return lb.a.J(576581651,
802,50,"In SlideLayouts.GetCount(), _slideLayouts is null"),0;M.Dv();return this.oSb.length}finally{M&&M.dispose()}}getItem(M){const ca=new Ig(19);try{lb.a.J(572643273,802,50,"PptApi Call - SlideLayoutCollection.GetItem");try{const Na=this.xOb.ga(M);ca.Dv();return Na}catch(Na){throw lb.a.J(576581652,802,15,String.format("In SlideLayout.GetItem(id), Exception: {0} ",Na.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(M){const ca=new Ig(18);try{lb.a.J(572643274,802,50,"PptApi Call - SlideLayoutCollection.GetItemAt");try{const Na=this.xOb.ga(this.oSb[M].Id.toString());ca.Dv();return Na}catch(Na){throw lb.a.J(576581653,802,15,String.format("In SlideLayouts.GetItemAt(index), Exception: {0} ",Na.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{ca&&ca.dispose()}}getItemOrNullObject(M){const ca=new Ig(20);try{lb.a.J(572643275,802,50,"PptApi Call - SlideLayoutCollection.GetItemOrNullObject");let Na;({value:Na}=this.xOb.Rf(M));ca.Dv();return Na}finally{ca&&ca.dispose()}}_OnAccess(){}getAsyncEnumerator(M,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new vi(M,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideLayoutCollection"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,ca){switch(M){case 1:return this.S6a();case 2:return this.g7a(ca);case 3:return this.f7a(ca);case 4:return this.h7a(ca);case 5:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}S6a(){return this.getCount()}g7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItem(M)}f7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");return this.getItemAt(M)}h7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItemOrNullObject(M)}xH(){this._OnAccess();return null}}
Object(h.a)(Li,"SlideLayoutCollection",null,[909]);class Kl{constructor(M){this.fnb=M}get id(){const M=new Ig(21);try{lb.a.J(572643269,802,50,"PptApi Call - SlideMaster.GetId");if(!this.fnb)return lb.a.J(576581648,802,10,"SlideMaster is null."),"";const ca=this.fnb.Id.toString();M.Dv();return ca}finally{M&&M.dispose()}}get layouts(){const M=new Ig(23);try{lb.a.J(572643270,802,50,"PptApi Call - SlideMaster.GetLayouts");if(!this.fnb)return lb.a.J(576581649,802,10,"SlideMaster is null."),null;const ca=
new Li(this.fnb.ContentMasters);M.Dv();return ca}finally{M&&M.dispose()}}get name(){const M=new Ig(22);try{lb.a.J(572643271,802,50,"PptApi Call - SlideMaster.GetName");if(!this.fnb)return lb.a.J(576581650,802,10,"SlideMaster is null."),"";const ca=this.fnb.Name;M.Dv();return ca}finally{M&&M.dispose()}}get shapes(){bg.Qq(!1);return null}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMaster"}invokePropertyGet(M){switch(M){case 1:return this.id;case 3:return this.layouts;case 4:return this.name;
case 5:return this.shapes}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M){switch(M){case 2:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}xH(){this._OnAccess();return null}}Object(h.a)(Kl,"SlideMaster",null,[]);class gl{constructor(M,ca){this.NR=M;this.Bza=ca}get id(){const M=new Ig(5);try{lb.a.J(572643283,802,50,"PptApi Call - Slide.GetId");if(!this.NR)return lb.a.J(587747398,802,10,"Slide is null."),"";const ca=this.NR.Bb.toString();M.Dv();return ca}finally{M&&M.dispose()}}get layout(){const M=new Ig(9);try{lb.a.J(572643284,
802,50,"PptApi Call - Slide.GetLayout");const ca=this.Bza.P9;for(let Na=0;Na<ca.length;Na++){const zb=ca[Na].ContentMasters;for(let $b=0;$b<zb.length;$b++)if(this.NR.Cn===zb[$b].Id){const Tc=new Ei(zb[$b]);M.Dv();return Tc}}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a Layout.");}finally{M&&M.dispose()}}get shapes(){const M=new Ig(6);try{lb.a.J(572643285,802,50,"PptApi Call - Slide.GetShapes");
const ca=new Di(this.NR);M.Dv();return ca}finally{M&&M.dispose()}}get slideMaster(){const M=new Ig(8);try{lb.a.J(572643286,802,50,"PptApi Call - Slide.GetSlideMaster");const ca=this.Bza.P9;for(let Na=0;Na<ca.length;Na++)if(this.NR.pj===ca[Na].Id){const zb=new Kl(ca[Na]);M.Dv();return zb}throw OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError.toString(),"Slide does not have a SlideMaster.");}finally{M&&M.dispose()}}get tags(){bg.Qq(!1);return null}deleteObject(){if(bg.Qq(!0)){var M=
new Ig(7);try{lb.a.J(572643287,802,50,"PptApi Call - Slide.Delete"),this.Bza.WM(this.NR),M.Dv()}finally{M&&M.dispose()}}}setSelectedShapes(){bg.Qq(!1)}_OnAccess(){}getTypeName(){return"Microsoft.Office.PowerPoint.Slide"}invokePropertyGet(M){switch(M){case 1:return this.id;case 5:return this.layout;case 4:return this.shapes;case 6:return this.slideMaster;case 7:return this.tags}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,ca){switch(M){case 3:return this.hTd();case 8:return this.d7k(ca);case 2:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){M=this.invokeMethod(M,
ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}hTd(){this.deleteObject();return null}d7k(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"Array<string>");this.setSelectedShapes(M);return null}xH(){this._OnAccess();return null}}Object(h.a)(gl,"Slide",null,[]);class lm{constructor(M){this.yOb=null;this.Bza=M;this.gnb=this.Bza.slides;this.Iyk()}Iyk(){this.yOb=new ya.ScriptSharpLegacyMap;if(this.gnb)for(const M of this.gnb){const ca=new gl(M,this.Bza);this.yOb.add(ca.id,
ca)}}z3i(){return 0<this.getCount()?this.gnb[this.getCount()-1]:null}F3i(M){return M?M.pj:this.Bza.P9[0].Id}B3i(M){const ca=this.Bza.P9;for(let Na=0;Na<ca.length;Na++)if(M===ca[Na].Id)return ca[Na].ContentMasters[0].Id;return 0}add(M){if(bg.Qq(!0)){var ca=new Ig(10);try{lb.a.J(572643278,802,50,"PptApi Call - SlideCollection.Add");const Na=this.z3i();let zb=0;zb=M&&M.slideMasterId?parseInt(M.slideMasterId):this.F3i(Na);let $b=0;$b=M&&M.layoutId?parseInt(M.layoutId):this.B3i(zb);this.Bza.cBc(Na,null,
zb,$b);ca.Dv()}finally{ca&&ca.dispose()}}}getCount(){const M=new Ig(11);try{lb.a.J(572643279,802,50,"PptApi Call - SlideCollection.GetCount");if(!this.gnb)return lb.a.J(587747396,802,50,"In Slides.GetCount(), _slides is null"),0;M.Dv();return this.gnb.length}finally{M&&M.dispose()}}getItem(M){const ca=new Ig(13);try{lb.a.J(572643280,802,50,"PptApi Call - SlideCollection.GetItem");try{const Na=this.yOb.ga(M);ca.Dv();return Na}catch(Na){throw lb.a.J(587747394,802,15,String.format("In Slide.GetItem(id), Exception: {0} ",
Na.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(M){const ca=new Ig(12);try{lb.a.J(572643281,802,50,"PptApi Call - SlideCollection.GetItemAt");try{const Na=this.yOb.ga(this.gnb[M].Bb.toString());ca.Dv();return Na}catch(Na){throw lb.a.J(587747392,802,15,String.format("In Slide.GetItemAt(index), Exception: {0} ",Na.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItemAt(index)");}}finally{ca&&ca.dispose()}}getItemOrNullObject(M){const ca=new Ig(14);try{lb.a.J(572643282,802,50,"PptApi Call - SlideCollection.GetItemOrNullObject");let Na;({value:Na}=this.yOb.Rf(M));ca.Dv();return Na}finally{ca&&ca.dispose()}}_OnAccess(){}getAsyncEnumerator(M,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new vi(M,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideCollection"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,ca){switch(M){case 6:return this.r2h(ca);case 1:return this.S6a();case 5:return this.g7a(ca);case 2:return this.f7a(ca);case 3:return this.h7a(ca);
case 4:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}r2h(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,sc);this.add(M);return null}S6a(){return this.getCount()}g7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItem(M)}f7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,
0,"int");return this.getItemAt(M)}h7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItemOrNullObject(M)}xH(){this._OnAccess();return null}}Object(h.a)(lm,"SlideCollection",null,[909]);class Gm{constructor(M){this.zOb=null;this.pSb=M;this.Jyk()}Jyk(){this.zOb=new ya.ScriptSharpLegacyMap;if(this.pSb)for(const M of this.pSb){const ca=new Kl(M);this.zOb.add(ca.id,ca)}}getCount(){const M=new Ig(24);try{lb.a.J(572643265,802,50,"PptApi Call - SlideMasterCollection.GetCount");
if(!this.pSb)return lb.a.J(576581645,802,50,"In SlideMasters.GetCount(), _slideMasters is null"),0;M.Dv();return this.pSb.length}finally{M&&M.dispose()}}getItem(M){const ca=new Ig(26);try{lb.a.J(572643266,802,50,"PptApi Call - SlideMasterCollection.GetItem");try{const Na=this.zOb.ga(M);ca.Dv();return Na}catch(Na){throw lb.a.J(576581646,802,15,String.format("In SlideMaster.GetItem(id), Exception: {0} ",Na.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),
"InvalidParam passed to GetItem(id)");}}finally{ca&&ca.dispose()}}getItemAt(M){const ca=new Ig(25);try{lb.a.J(572643267,802,50,"PptApi Call - SlideMasterCollection.GetItemAt");try{const Na=this.zOb.ga(this.pSb[M].Id.toString());ca.Dv();return Na}catch(Na){throw lb.a.J(576581647,802,15,String.format("In SlideMasters.GetItemAt(index), Exception: {0} ",Na.message)),OfficeExtension.WacRuntime.Utility.createRichApiException(OSF.DDA.ErrorCodeManager.errorCodes.ooeInvalidParam.toString(),"InvalidParam passed to GetItemAt(index)");
}}finally{ca&&ca.dispose()}}getItemOrNullObject(M){const ca=new Ig(27);try{lb.a.J(572643268,802,50,"PptApi Call - SlideMasterCollection.GetItemOrNullObject");let Na;({value:Na}=this.zOb.Rf(M));ca.Dv();return Na}finally{ca&&ca.dispose()}}_OnAccess(){}getAsyncEnumerator(M,ca){return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new vi(M,ca,this))}getTypeName(){return"Microsoft.Office.PowerPoint.SlideMasterCollection"}invokePropertyGet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,ca){switch(M){case 1:return this.S6a();case 2:return this.g7a(ca);case 3:return this.f7a(ca);case 4:return this.h7a(ca);case 5:return this.xH()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}S6a(){return this.getCount()}g7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItem(M)}f7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"int");return this.getItemAt(M)}h7a(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");return this.getItemOrNullObject(M)}xH(){this._OnAccess();return null}}
Object(h.a)(Gm,"SlideMasterCollection",null,[909]);class Gh{constructor(M){this.PD=new xn;this.e4=M.presentation}get context(){return this.PD}get slideMasters(){const M=new Ig(2);try{lb.a.J(572643293,802,50,"PptApi Call - Presentation.GetSlideMasters");const ca=new Gm(this.e4.P9);M.Dv();return ca}finally{M&&M.dispose()}}get slides(){const M=new Ig(3);try{lb.a.J(572643294,802,50,"PptApi Call - Presentation.GetSlides");const ca=new lm(this.e4);M.Dv();return ca}finally{M&&M.dispose()}}get tags(){bg.Qq(!1);
return null}get title(){const M=new Ig(4);try{return lb.a.J(572643295,802,50,"PptApi Call - Presentation.GetTitle"),M.Dv(),"This is the title property"}finally{M&&M.dispose()}}getSelectedShapes(){bg.Qq(!1);return null}getSelectedSlides(){bg.Qq(!1);return null}getSelectedTextRange(){bg.Qq(!1);return null}getSelectedTextRangeOrNullObject(){bg.Qq(!1);return null}insertSlidesFromBase64(){bg.Qq(!1)}setSelectedSlides(){bg.Qq(!1)}_RegisterEvent(M,ca){OfficeExtension.WacRuntime.RichApi.getEventManager().register(this.context.controlId,
M,ca)}_UnregisterEvent(M,ca){OfficeExtension.WacRuntime.RichApi.getEventManager().unregister(this.context.controlId,M,ca)}getTypeName(){return"Microsoft.Office.PowerPoint.Presentation"}invokePropertyGet(M){switch(M){case 3:return this.slideMasters;case 2:return this.slides;case 4:return this.tags;case 1:return this.title}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokePropertyGetAsync(M){M=this.invokePropertyGet(M);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}invokePropertySet(M){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);
}invokePropertySetAsync(M,ca){this.invokePropertySet(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)}invokeMethod(M,ca){switch(M){case 5:return this.$dj();case 6:return this.bej();case 7:return this.gej();case 9:return this.hej();case 1003:return this.dCj(ca);case 8:return this.e7k(ca);case 1001:return this.DIh(ca);case 1002:return this.HIh(ca)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(M);}invokeMethodAsync(M,ca){M=this.invokeMethod(M,ca);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(M)}$dj(){return this.getSelectedShapes()}bej(){return this.getSelectedSlides()}gej(){return this.getSelectedTextRange()}hej(){return this.getSelectedTextRangeOrNullObject()}dCj(M){const ca=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,vf);this.insertSlidesFromBase64(ca,M);return null}e7k(M){M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"Array<string>");this.setSelectedSlides(M);return null}DIh(M){const ca=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"int");this._RegisterEvent(ca,M);return null}HIh(M){const ca=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,0,"string");M=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(M,1,"int");this._UnregisterEvent(ca,M);return null}}Object(h.a)(Gh,"Presentation",null,[]);class bf{create(M){return new Gh(M)}}Object(h.a)(bf,"PresentationFactory",null,[847]);class Ll{create(M,ca,Na){return new bg(M,ca,Na)}}Object(h.a)(Ll,"RichApiHostFactory",null,[846]);class Hm{constructor(M){this.pb=document.createElement("div");this.pb.className="AddinPaneFrame";
this.Nz=M}dispose(){}layout(M,ca){this.Nz.value.Doj(M,ca);return M}get isVisible(){return!1}get xa(){return this.pb}get order(){return 13}}Object(h.a)(Hm,"AddinPaneFrame",null,[833,716,106]);class re{constructor(){this.$$a=this.DZc=this.K=this.Zd=this.JI=null;this.NE=!!A.AFrameworkApplication.Aa&&!!A.AFrameworkApplication.Aa.jb&&A.AFrameworkApplication.Aa.jb.tW}get name(){return"PowerPointWebEditor.AppForOffice"}Wb(M){this.JI=M.resolve("Common.AFrameworkApplication");this.K=M;this.K.register(Jb,"PowerPointWebEditor.AppForOfficeApi.GetDocumentCopyHelper").as("PowerPointWebEditor.IGetDocumentCopyHelper").na(()=>
new Jb).ma();this.K.register(Cg,"PowerPointWebEditor.AppForOfficeFocusManager").as("PowerPointWebEditor.IAppForOfficeFocusManager").na(()=>new Cg(this.K.resolve("PowerPointWebEditor.IAddinPaneFrame").xa,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.le("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"))).ma();this.K.register(Jc,
"PowerPointWebEditor.AppForOfficeContentAppsContainer").as("PowerPointWebEditor.IAppForOfficeContentAppsContainer").na(()=>new Jc(this.K.resolve("PowerPointWebEditor.IPPTZoomManager"),this.K.resolve("Box4.IPageView").container,this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"))).ma();
this.K.register(Df,"PowerPointWebEditor.AppForOfficeManager").as("PowerPointWebEditor.IAppForOfficeManager").na(()=>new Df(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.IFrameContext"),new De,this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer"),this.K.le("PowerPointWebEditor.IClassFactory"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),
this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),new H,L.getInstance(),this.K.le("PowerPointWebEditor.IAppforOfficeClassFactory"),
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IGetDocumentCopyHelper"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory"),this.K.resolve("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory"),this.K.resolve("Common.App.OAuth.IOAuthManager"))).ma();const ca=new v;this.K.register(qe,"PowerPointWebEditor.AddinCommandsManager").as("PowerPointWebEditor.IAddinCommandsManager").na(()=>
new qe(this.JI,this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),ca,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),new Oh,this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("Common.IRibbonExternal"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();this.K.register(Cf,"PowerPointWebEditor.ContextMenuExtensibilityHandler").as("PowerPointWebEditor.IContextMenuExtensibilityHandler").na(()=>
new Cf(ca)).ma();this.K.register(Nd,"PowerPointWebEditor.AppForOfficeListenerManager").as("PowerPointWebEditor.IAppForOfficeListenerManager").na(()=>new Nd(this.nYi())).ma();this.K.register(Ij,"PowerPointWebEditor.AppforOfficeClassFactory").as("PowerPointWebEditor.IAppforOfficeClassFactory").na(()=>new Ij(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager"),this.K.resolve("Common.IClickInputManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager"))).ma();this.K.register(Ll,"PowerPointWebEditor.AppForOfficeApi.RichApiHostFactory").as("PowerPointWebEditor.AppForOfficeApi.IRichApiHostFactory").na(()=>new Ll).ma();
this.K.register(bf,"PowerPointWebEditor.AppForOfficeApi.PresentationFactory").as("PowerPointWebEditor.AppForOfficeApi.IPresentationFactory").na(()=>new bf).ma();this.K.register(833,"PowerPointWebEditor.IAddinPaneFrame").ma().na(()=>new Hm(this.K.le("PowerPointWebEditor.IAppForOfficeFocusManager")));this.K.register(834,"PowerPointWebEditor.IAppForOfficeAuthFactory").ma().na(()=>new me)}init(){A.AFrameworkApplication.dra||this.K.resolve("Common.IAppSettingsManager").ff(Object(D.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){this.Zd=
this.K.resolve("PowerPointWebEditor.IAppForOfficeManager");this.Zd.eXb=!0;A.AFrameworkApplication.fa.ka("OcpsIsEnabled")?this.K.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(M=>{M.isFeatureEnabled(re.Q7j,!0).then(ca=>{this.Zd.eXb=ca;this.dvb();return null})}):this.dvb()}dvb(){this.K.resolve("PowerPointWebEditor.IAddinCommandsManager");this.K.resolve("PowerPointWebEditor.IAppForOfficeAuthFactory");this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").mFe();
this.K.resolve("PowerPointWebEditor.IAppForOfficeContentAppsContainer").initialize();const M=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");M.Oql();M.Pql();M.Lmj();this.Psl();this.hzj();this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").initialize()}dispose(){this.K.resolve("PowerPointWebEditor.IAppForOfficeManager").dispose();this.K.resolve("PowerPointWebEditor.IAppForOfficeListenerManager").dispose()}hzj(){const M=this.K.resolve("PowerPointWebEditor.IAddinPaneFrame");
this.NE||this.K.resolve("PowerPointWebEditor.IPaneManager").pP(M);const ca=this.K.resolve("PowerPointWebEditor.IFocusManager"),Na=this.K.resolve("PowerPointWebEditor.IAppForOfficeFocusManager");ca.T7(rg.a.AAa,rg.a.jj,M,!Na.M5d());this.JI.kr.Fq()}nYi(){const M=[];var ca=[];ca.push(this.K.resolve("Box4.Graph.IGraphInstance").vd(47));ca.push(this.K.resolve("Box4.Graph.IGraphInstance").vd(10));ca=new Yl(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),ca,this.K.resolve("Box4.Graph.IGraphIteratorFactory"));
M.push(ca);ca=new Qh(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Box4.Graph.IGraphInstance").vd(49),this.K.resolve("Box4.Graph.IGraphIteratorFactory"));M.push(ca);ca=new dh(this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"));M.push(ca);ca=new qj(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("Box4.Graph.IGraphInstance").vd(47));M.push(ca);ca=new pf(this.K.resolve("Box4.Graph.IGraphInstance").vd(8),this.K.resolve("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IAppforOfficeClassFactory"));M.push(ca);return M}Psl(){this.$$a=A.AFrameworkApplication.fa.Ga("DevAddinManifestFileUrl");this.DZc=A.AFrameworkApplication.fa.Ga("DevAddinManifestGuid");var M=A.AFrameworkApplication.fa.Ga("IsDevAddinTest");if(this.$$a&&this.DZc&&M)if(M="true"===M,w.a.instance.getItem("optedIntoAddinDeveloperMode")||
M&&A.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))if(w.a.instance.getItem(this.DZc)||M&&A.AFrameworkApplication.fa.ka("SuppressDeveloperAddinDialogs"))this.Zd.En.validateAndCacheNewDevAddinManifest(this.$$a);else{M=new y.StandardDialog;M.yd=4;const ca=CommonUIStrings.l_AppsforOfficeL_RegisterDeveloperAddinManifestWarningMessage+String.format(CommonUIStrings.l_AppsForOfficeDeveloperManifestUrl,this.$$a)+CommonUIStrings.l_AppsforOfficeLoadManifestUrl;M.DO(CommonUIStrings.l_AppsforOfficeRegisterDeveloperAddinManifestWarningTitle,
ca,Object(D.a)(this,this.tdh,"registerDevAddinManifestHandler"))}else M=Object(D.a)(this,this.tdh,"registerDevAddinManifestHandler"),M=new Ph(this.$$a,M),M.yd=0,M.showDialog(CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeTitle,CommonUIStrings.l_AppsforOfficeNotOptedIntoAddinDeveloperModeMessage)}tdh(M){1===M&&this.$$a&&this.TMk()}TMk(){this.Zd&&(this.Zd.En.validateAndCacheNewDevAddinManifest(this.$$a),w.a.instance.setItem(this.DZc,"true"))}static main(){u.a.instance.Bc(new re)}}re.Q7j=
"mso_officeStore";Object(h.a)(re,"AppForOfficePackage",null,[2,3]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("OSF");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.AppForOfficeApi");Type.registerNamespace("CommandUI.AddInCommands");re.main()},540:function(J,V,d){d.r(V);J=d(0);var h=d(17),e=d(376),m=d(67);class r{constructor(){this.startTime=0;this.callback=null}}Object(J.a)(r,"SSOCallbackInfo",null,[]);class v{constructor(){this.accessToken=
null}}Object(J.a)(v,"AccessTokenInformation",null,[962]);var A=d(971);class w{constructor(){this.token=null;this.expiresOn=0;this.IAa=this.AV=null}}Object(J.a)(w,"CachedTokenInfo",null,[]);class y{constructor(){this.brc=new h.a;this.eqa=this.dqa=!1;this.cKa=this.AV=null;this.startTime=this.retryCount=0;this.SFf=null}get dNd(){return this.brc}}Object(J.a)(y,"SSORequestInfo",null,[]);class u extends y{constructor(){super();this.errorCode=0}}Object(J.a)(u,"SSOFailedRequestInfo",y,[]);var D=d(25);class F{constructor(X,
P,ea,ia){this.E6=new h.a;this.AR=new h.a;this.ZKa=null;this.oRb=new h.a;this.Gef=Promise.resolve(null);this.gxf=!1;this.SVh=P;this.Irc=X;this.fyf=ea;this.cJh=ia}nbl(X){if(this.ZKa&&this.ZKa.AV===X.AV){if(Date.now()/1E3+F.Qdk>this.ZKa.expiresOn)return this.ZKa=null,!1;X=new A.a;X.token=this.ZKa.token;X.expiresOn=this.ZKa.expiresOn;X.IAa=this.ZKa.IAa;X.zib=!0;X.c2b=0;this.N2b(X);return!0}return!1}N$k(X){for(let P=0;P<this.AR.count;P++)if(this.AR.ga(P).AV===X.AV&&this.AR.ga(P).cKa===X.cKa){let ea;(ea=
this.AR.ga(P)).retryCount=ea.retryCount+1;X.retryCount=this.AR.ga(P).retryCount;if(this.AR.ga(P).retryCount<F.iWa||!this.AR.ga(P).dqa&&X.dqa||!this.AR.ga(P).eqa&&X.eqa){if(!this.AR.ga(P).dqa&&X.dqa||!this.AR.ga(P).eqa&&X.eqa)X.retryCount=0;this.AR.removeAt(P);break}X=new A.a;X.errorCode=this.AR.ga(P).errorCode;this.N2b(X);return!0}return!1}j4h(X,P){for(let ea=0;ea<this.AR.count;ea++)if(this.AR.ga(ea).cKa===X.cKa&&this.AR.ga(ea).AV===X.AV)return;this.AR.add(Object.assign(new u,{dqa:X.dqa,eqa:X.eqa,
AV:X.AV,cKa:X.cKa,errorCode:P,retryCount:X.retryCount}))}get resource(){return this.SVh}mZd(X,P,ea,ia,ja,C){const {AppsForOfficeSingleSignOnManager:pa}=d(540);""===ea&&(ea=null);if(this.gxf)pa.aka(C,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{var Z=null;for(let qa of this.E6)if(qa.dqa===X&&qa.eqa===P&&qa.AV===ea&&qa.cKa===ja){Z=qa;break}Z||(Z=Object.assign(new y,{dqa:X,eqa:P,AV:ea,SFf:ia,cKa:ja,retryCount:0,startTime:pa.gF()}),this.E6.add(Z));Z.retryCount=0;Z.dNd.add(C);
this.Gef=this.Gef.then(()=>{var {AppsForOfficeSingleSignOnManager:qa}=d(540);if(0<this.E6.count){var ya=this.E6.ga(0);if(this.nbl(ya)||this.N$k(ya))return null;for(let Da=0;Da<this.oRb.count;)this.oRb.ga(Da)+F.Vnl<qa.gF()?this.oRb.removeAt(Da):Da++;if(this.oRb.count>=F.gek||this.E6.count>=F.Ndk)return ya=new A.a,ya.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,this.N2b(ya),null;let Ka=null;D.AFrameworkApplication.Aa&&(qa=D.AFrameworkApplication.Aa.EU)&&(Ka=qa.zi("ComponentAttach",
this.Irc+F.fYh));return ya.cKa.b0h(this.resource,ya.dqa,ya.eqa,ya.AV,this.cJh,ya.SFf).then(Da=>{Ka&&Ka.stop();this.N2b(Da)},()=>{Ka&&Ka.stop();const Da=new A.a;Da.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;this.N2b(Da)})}return null})}}N2b(X){const {AppsForOfficeSingleSignOnManager:P}=d(540);try{if(this.E6.count){var ea=this.E6.ga(0);this.E6.removeAt(0);var ia=null;X.errorCode||(ia=new v,ia.accessToken=X.token);X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&
X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&X.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.j4h(ea,X.errorCode);var ja={};null!=X.c2b&&(ja.getTokenSilentTime=X.c2b.toString());null!=X.e4d&&(ja.getTokenPopupTime=X.e4d.toString());null!=X.D0d&&(ja.getIDTokenTime=X.D0d.toString());null!=X.zib&&(ja.tokenCached=X.zib.toString());X.wRe&&(ja.detailedError=X.wRe);X.IAa&&(ja.authLibrary=
X.IAa);ea.retryCount&&(ja.retryCount=ea.retryCount);for(var C of ea.dNd)P.aka(C,X.errorCode,ia,ja);null!=X.zib&&X.zib||this.oRb.add(ea.startTime);if(!X.errorCode)for(null!=X.expiresOn&&(this.ZKa=Object.assign(new w,{token:X.token,expiresOn:X.expiresOn,AV:ea.AV,IAa:X.IAa})),this.AR.clear(),C=0;C<this.E6.count;)if(this.E6.ga(C).AV===ea.AV){for(let pa of this.E6.ga(C).dNd)P.aka(pa,X.errorCode,ia,ja);this.E6.removeAt(C)}else C++}}catch(pa){e.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",
pa.message)}}shutdown(){this.gxf=!0;this.E6.clear()}}F.Vnl=6E4;F.gek=6;F.Ndk=6;F.iWa=3;F.Qdk=300;F.fYh="GetAccessToken";Object(J.a)(F,"SSOCallbackManager",null,[]);var I=d(231),H=d(234),L=d(168),E=d(80),aa=d(54),Q=d(45),O=d(135),T=d(180);d.d(V,"AppsForOfficeSingleSignOnManager",function(){return K});class K{constructor(X,P,ea=null){this.Djb=new m.a;const ia=new h.a;P&&ia.add(P.fbk);ea&&ia.addRange(ea);this.tR=X;this.oZh=ia}removeCallbackForAddin(X){this.Djb.Jb(X)&&(this.Djb.ga(X).shutdown(),this.Djb.remove(X))}nZd(X,
P,ea,ia,ja,C,pa,Z,qa,ya){ya=Object.assign(new r,{startTime:K.gF(),callback:ya});try{const la=!!ea&&""!==ea;var Ka=ya.startTime;const ma=this.getOsfControl(X);let Ea=ma.getStoreType()||"",ta=ma.getOwnerAddinStoreType()||"",Ga=ma.getSolutionId()||"";const oa=ma.getVersion()||"";Ea=Ea.toLowerCase();ta=ta.toLowerCase();Ga=Ga.toLowerCase();var Da=E.a.DNc(P)||"";const sa=E.a.DNc(ma.getIframeUrl())||"",Ha=Da.toLowerCase()===sa.toLowerCase();Da=Ea;"inmemory"===Ea&&(Da=ta);const bb=Telemetry.PrivacyRules.GetPrivacyCompliantId(Ga,
Da,ma.getAssetId(),null,null,ma.getStoreId()),Ya={["callInstanceId"]:Ka.toString(),["controlSolutionId"]:bb,["controlVersion"]:oa,["storeType"]:Ea,["ownerStoreType"]:ta,["allowConsentPrompt"]:ia.toString(),["forMSGraphAccess"]:ja.toString(),["allowSignInPrompt"]:C.toString(),["hasAddinAuthChallenge"]:la.toString(),["securityOriginEqualsSourceLocation"]:Ha.toString(),["singleSignOnEnabled"]:pa.toString(),["accountTypeFilter"]:Z||""};e.ULS.sendTraceTag(51401115,344,50,"{0}",Ya);O.a.sendTelemetryEvent(Object.assign(new T.a,
{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:L.a.sD(Ya)}));Ka=!0;const ua=D.AFrameworkApplication.fa.Ga("HostAuthType");switch(Z){case "aad":Ka="aad"===ua;break;case "msa":Ka="msa"===ua;break;default:Ka=!Z||"noFilter"===Z}if(Ka){Z=null;if(pa)for(let Ma of this.oZh)if(Ma.QHj(Ga)){Z=Ma;break}Z?this.isSSOAddin(X)?(pa=!0,"omex"===Da&&(pa=!1),"spapp"===Da||"spcatalog"===Da?(e.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),K.aka(ya,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):ja&&!pa?(e.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),K.aka(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(ja&&"exchange"===Da&&(ia=!1),this.mZd(X,P,ea,Da,ia,C,qa,Z,ya))):(e.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),K.aka(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):K.aka(ya,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else K.aka(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(la){this.yXc(),e.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",la.message),K.aka(ya,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}}getAccessToken(X,P,ea,ia){this.nZd(X,ea[I.a.dJd]||null,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||
!1,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,P,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,ea[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,ia)}mZd(X,P,ea,ia,ja,C,pa,Z,qa){this.Djb.Jb(X)?ia=this.Djb.ga(X):(ia=new F(X,this.getWebApplicationResource(X).split(",")[0],ia,this.getDefaultDisplayName(X)),this.Djb.add(X,ia));const ya=ia.resource;
X=K.Pcj(ya,this.getWebApplicationId(X));const Ka=OfficeExt.WACUtils.getHostSecure(P);X&&Ka?X.toLowerCase()===Ka.toLowerCase()?ia.mZd(ja,C,ea,pa,Z,qa):(K.i$a('SSO Resource "'+ya+'" cannot be used from "'+P+'" origin due to domain mismatch.'),e.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),K.aka(qa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(X||e.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),
Ka||e.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),K.aka(qa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))}yXc(){e.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",{["UserAgent"]:window.navigator.userAgent})}getOsfControl(X){return this.tR.getOsfControl(X)}isSSOAddin(X){return this.getOsfControl(X).getManifest().isSSOAddin()}getWebApplicationId(X){return this.getOsfControl(X).getManifest().getWebApplicationId()}getWebApplicationResource(X){return this.getOsfControl(X).getManifest().getWebApplicationResource()}getDefaultDisplayName(X){return this.getOsfControl(X).getManifest().getDefaultDisplayName()}static Qfg(){try{const X=
{};aa.a.rEa&&H.OAuthManagerSettings.i8a&&(X.UiHostSupportsAuthTokenAddinList=K.ZKc);X.UiHostSupportsAuthToken=H.OAuthManagerSettings.i8a;return X}catch(X){e.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",X.message)}return null}static getInstance(X,P,ea=null){K.Ja||(K.Ja=new K(X,ea));return K.Ja}static Lmi(X){K.Ja&&K.Ja.removeCallbackForAddin(X)}static i$a(X){window.console.warn&&window.console.warn(X)}static Pcj(X,P){if(!X)return"";P||(P="");let ea=X.toLowerCase();
var ia=P.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(ia)||(K.i$a('SSO App Id "'+P+'" is not a valid format. It will be rejected from store submission.'),e.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));ea.endsWith(ia)||(K.i$a('SSO Resource "'+X+'" does not end with App Id "'+P+'". It will be rejected from store submission.'),e.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!ea.startsWith("https://")&&
!ea.startsWith("api://"))return K.i$a('SSO Resource "'+X+'" must be https:// or api:// protocol.'),e.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(P=0;P<X.length;P++){ia=X.charAt(P);const ja=Q.a.charCodeAt(X,P);if(33>ja||126<ja||"&"===ia||"?"===ia||"#"===ia||"%"===ia||"\\"===ia)return K.i$a('SSO Resource "'+X+'" contains an invalid character "'+ia+'".'),e.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+ia+"' in resource URI."),""}if(0<=X.indexOf("::"))return K.i$a('SSO Resource "'+
X+'" contains an invalid string "::".'),e.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<X.length)return K.i$a('SSO Resource "'+X+'" is '+X.length+" characters and exceeds the max length of 120 characters."),e.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+X.length+"."),"";ea.startsWith("api://")&&(ea="https://"+ea.substring(6,ea.length));return 8===ea.length?"":OfficeExt.WACUtils.getHostSecure(ea)||""}static aka(X,P,ea,ia){var ja=X.startTime;let C=0;0<ja&&(C=K.gF()-
ja);ja={["callInstanceId"]:ja.toString(),["callDuration"]:C.toString(),["errorCode"]:P.toString()};if(ia)for(let pa in ia)ja[pa]=ia[pa];e.ULS.sendTraceTag(51401116,344,50,"{0}",ja);O.a.sendTelemetryEvent(Object.assign(new T.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:L.a.sD(ja)}));X.callback(P,ea)}static gF(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(X){}return Date.now()}}K.ZKc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
K.Ja=null;Object(J.a)(K,"AppsForOfficeSingleSignOnManager",null,[910])},971:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.token=null;this.errorCode=0;this.expiresOn=this.IAa=this.zib=this.D0d=this.e4d=this.c2b=this.wRe=null}}Object(J.a)(h,"AppsForOfficeOauthResult",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.appforoffice.js.map