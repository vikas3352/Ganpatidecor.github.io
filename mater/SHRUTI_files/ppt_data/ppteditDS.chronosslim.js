'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[5],{1005:function(J,V,d){J=d(0);var h;(function(m){m[m.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";m[m.peopleImageClassName=1]="peopleImageClassName";m[m.peopleImageClusterPath=4]="peopleImageClusterPath";m[m.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";m[m.imageDimension=6]="imageDimension";m[m.rtl=8]="rtl";m[m.pointerInputManager=9]="pointerInputManager";m[m.clickInputManager=
10]="clickInputManager";m[m.vertical=11]="vertical";m[m.zIndex=12]="zIndex";m[m.contextMenuInputManager=13]="contextMenuInputManager";m[m.imageDomElement=14]="imageDomElement";m[m.useIdleTooltip=15]="useIdleTooltip";m[m.viewportBoundsCallback=16]="viewportBoundsCallback";m[m.flipHorizontalDirection=17]="flipHorizontalDirection";m[m.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";m[m.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";m[m.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||
(h={}));Object(J.b)("PresenceTooltipSettingKeys",h);d.d(V,"a",function(){return e});class e{constructor(){this.ty={}}get(m,r=null){m=h[m];return"number"===typeof r?(r=this.ty[m])?Number.parseInvariant(r.toString()):0:this.ty[m]}add(m,r){this.ty[h[m]]=r}lD(m,r){h[m]in this.ty||(this.ty[h[m]]=r)}remove(m){delete this.ty[h[m]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])},1097:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.Q7g="WAC_Powerpoint";h.p3b=null;Object(J.a)(h,"AddinHostApp",
null,[])},1110:function(J,V,d){J=d(0);var h=d(13),e=d(1166),m=d(229),r=d(230),v=d(65),A=d(95);class w extends m.a{constructor(Q,O){super(Q);this.xf=null;this.OH=O.get(8,!1);this.wR=O.get(6,0);this.element=Q;this.element.className=w.p6a;this.Y2a=this.createElement("ul");this.element.appendChild(this.Y2a);this.zn=O.get(10);this.zn.ob(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.Qo=O.get(9);this.Qo.ob(v.a.pointerOut,this.element,Object(h.a)(this,this.iz,"onPointerOut"));this.Qo.ob(v.a.pointerDown,
this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior"));this.vM=O.get(13);this.vM.ob(this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior"))}vV(Q){this.addHandler(r.a.Zo,Q)}p0(Q){this.removeHandler(r.a.Zo,Q)}get U$(){return this.xf}dispose(){this.element&&(this.zn.xb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.Qo.xb(v.a.pointerDown,this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),this.Qo.xb(v.a.pointerOut,
this.element,Object(h.a)(this,this.iz,"onPointerOut")),this.vM.xb(this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(Q,O,T){this.hide();!Q||0>=Q.length||(this.OH?this.element.style.right=O+"px":this.element.style.left=O+"px",this.element.style.top=T+"px",this.lId(Q),this.visible=!0)}lId(Q){this.xf=Q;A.a.ku(this.Y2a);for(let O=Q.length-1;0<=O;O--)this.Fx(Q[O])}Fx(Q){const O=document.createElement("li");O.style.backgroundColor=
Q.color;O.style.height=this.wR+"px";O.id="fly_"+Q.clientId;O.style.lineHeight=this.wR+"px";A.a.wx(O,Q.userName);O.setAttribute("dir","auto");this.Y2a.appendChild(O)}onClick(){this.hide();return!1}iz(Q){this.raiseEvent(r.a.Zo,new r.a(3,Q));return!1}}w.p6a="prFlyout UIFont";Object(J.a)(w,"PresenceTooltipFlyoutControl",m.a,[]);var y=d(73);class u extends m.a{constructor(Q,O,T){super(Q);this.AM=null;this.xf=[];this.element.className="prGlyph";this.Ic=O;this.B6=this.Ic.get(9);this.en=this.Ic.get(10);this.vM=
this.Ic.get(13);this.O6d();this.Fx(T);this.a1a=!1}get nO(){return this.xf.length}get U$(){return this.xf}vV(Q){this.addHandler(r.a.Zo,Q)}p0(Q){this.removeHandler(r.a.Zo,Q)}dispose(){this.BUe();super.dispose()}Fx(Q){Array.add(this.xf,Q);2===this.nO?this.R$(!0):1===this.nO?this.R$(!1):this.R$(this.a1a)}qJ(Q){this.yXd(Q)&&(1<this.nO&&this.R$(!0),1===this.nO?this.R$(!1):1>this.nO&&this.hide())}show(){this.R$(2<=this.nO);this.visible=!0}hide(){this.visible=!1}I0d(Q){return Q?this.y0b(0,5):this.y0b(1,4)}yXd(Q){for(let O=
0;O<this.nO;O++)if(this.xf[O].clientId===Q)return Q=this.xf[O],Array.removeAt(this.xf,O),Q;return null}R$(Q){this.a1a!==Q&&(this.AM&&this.element.removeChild(this.AM),this.AM=this.I0d(Q),this.element.appendChild(this.AM),this.a1a=Q);this.AM.childNodes[0].style.backgroundColor=this.xf[this.xf.length-1].color}y0b(Q,O){const T=this.Ic.get(6,0),K=this.Ic.get(14);return y.createClusteredImageFromClusterWithImageClass(T,T,this.Ic.get(Q),this.Ic.get(O),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,
K?K.cloneNode(!0):null)}zC(Q){3!==Q.Wf&&this.raiseEvent(r.a.Zo,new r.a(2,Q));return!1}onClick(Q){this.raiseEvent(r.a.Zo,new r.a(1,Q));return!0}iz(Q){3!==Q.Wf&&this.raiseEvent(r.a.Zo,new r.a(3,Q));return!1}BUe(){this.element&&(this.B6.xb(v.a.pointerDown,this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),this.B6.xb(v.a.pointerOver,this.element,Object(h.a)(this,this.zC,"onPointerOver")),this.B6.xb(v.a.pointerOut,this.element,Object(h.a)(this,this.iz,"onPointerOut")),this.en.xb(v.a.doubleClick,
this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),this.en.xb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.vM.xb(this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")))}O6d(){this.element&&(this.B6.ob(v.a.pointerDown,this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),this.B6.ob(v.a.pointerOver,this.element,Object(h.a)(this,this.zC,"onPointerOver")),this.B6.ob(v.a.pointerOut,this.element,
Object(h.a)(this,this.iz,"onPointerOut")),this.en.ob(v.a.doubleClick,this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),this.en.ob(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.vM.ob(this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")))}}Object(J.a)(u,"PresenceTooltipGlyph",m.a,[]);var D=d(115);d(63);var F=d(198);class I extends m.a{constructor(Q,O,T){super(Q);this.xf=[];this.Vl=[];this.LH=0;this.Yga=this.i6=!1;
this.yLb=null;this.pga={};this.Ic=T;this.Qi=T.get(8,!1);this.eG=T.get(11,!1);Q=T.get(12,0);this.imageDimension=T.get(6,0);this.B2a=O;this.element.id=I.F6a();this.element.className=m.a.Sqb("prControl",this.Qi);Q&&(this.zIndex=Q);this.rtl=this.Qi;this.Fgb(O);this.vz=this.createElement("div");this.vz.className=this.eG?"prContainerV":"prContainerHr";this.element.appendChild(this.vz);this.ONb=Array(this.LH);for(O=0;O<this.LH;O++)this.Tv[O]=new w(this.createElement("div"),this.Ic),this.Tv[O].vV(Object(h.a)(this,
this.IF,"onInteractivityChanged")),this.element.appendChild(this.Tv[O].element)}get Leb(){return F.a.clone(this.xf)}getGlyph(Q){return this.pga[Q]}get Tv(){return this.ONb}get FTb(){return this.yLb}get xJa(){return this.imageDimension+2}get width(){return this.eG?this.xJa:this.B2a}get height(){return this.eG?this.B2a:this.xJa}vV(Q){this.addHandler(r.a.Zo,Q)}p0(Q){this.removeHandler(r.a.Zo,Q)}dispose(){if(this.Tv)for(const Q of this.Tv)Q.p0(Object(h.a)(this,this.IF,"onInteractivityChanged")),D.a.rx(Q);
D.a.rgd(this.Vl);this.Vl=this.ONb=null;super.dispose()}jfa(){this.lN();this.thb();this.visible=!0;this.i6=!1}vhb(){!this.Vl||1>this.Vl.length||(this.lN(),this.visible=!0,this.thb(),this.WHa(this.Vl[this.Vl.length-1]),this.i6=!0)}mxa(){if(this.Vl&&!(1>this.Vl.length)){this.visible=!0;this.thb();var Q=0;for(const O of this.Vl)this.WHa(O,Q++);this.i6=!1;this.Yga=!0}}hide(){this.visible=!1;this.lN();for(let Q=0;Q<this.Vl.length;Q++)this.Vl[Q].hide();this.i6=!1}fWb(){if(!this.Yga)return!1;let Q=0;for(const O of this.Tv)O.visible&&
Q++;return this.Yga=0<Q&&(this.xf.length<=this.LH?Q===this.xf.length:Q===this.LH)}Fx(Q){if(!(0>=this.LH)){Q.clientId||(Q.clientId=(I.vga++).toString());if(Q.clientId in this.pga){var O=this.vS(Q.clientId);if(0<=O){O=this.xf[O];if(O.color===Q.color&&O.userName===Q.userName)return;this.qJ(Q.clientId)}}O=this.fWb();var T=0;if(this.xf.length<this.LH){var K=new u(this.createElement("div"),this.Ic,Q);K.vV(Object(h.a)(this,this.IF,"onInteractivityChanged"));this.Qi&&!this.eG&&0<this.xf.length?this.vz.insertBefore(K.element,
this.vz.firstChild):(this.vz.appendChild(K.element),T=this.Vl.length);Array.add(this.Vl,K)}else this.Qi&&!this.eG?K=this.Vl[0]:(T=this.Vl.length-1,K=this.Vl[T]),K.Fx(Q);K.show();this.pga[Q.clientId]=K;Array.add(this.xf,Q);this.Woc(K,T);O&&this.mxa()}}qJ(Q){const O=this.fWb();O&&this.lN();this.Sma(Q);this.xf.length>=this.LH&&this.Vl.length<this.LH&&this.IEe();0>=this.xf.length?this.hide():O&&this.mxa()}Adb(){}Sma(Q){var O=this.vS(Q);0>O||(Q=this.xf[O],Array.removeAt(this.xf,O),O=this.pga[Q.clientId],
delete this.pga[Q.clientId],O.qJ(Q.clientId),this.Woc(O),0>=O.nO&&(this.vz.removeChild(O.element),Array.remove(this.Vl,O),O.dispose()))}$gb(){}IEe(){var Q=this.R1d();!Q||1>=Q.U$.length||(Q=Array.clone(this.xf),Q.forEach(O=>{this.Sma(O.clientId)}),Q.forEach(O=>{this.Fx(O)}))}vS(Q){for(let O=0;O<this.xf.length;O++)if(this.xf[O].clientId===Q)return O;return-1}R1d(){return this.Qi&&!this.eG?this.Vl[0]:this.Vl[this.Vl.length-1]}position(Q,O){this.element.style.top=O+"px";this.element.style.left=Q+"px"}thb(){for(let Q=
0;Q<this.Vl.length;Q++)this.Vl[Q].show()}lN(){for(let Q=0;Q<this.LH;Q++)this.Tv[Q].hide();this.Yga=!1}WHa(Q,O=0){if(Q)if(this.yLb=Q,this.eG){const T=this.imageDimension;if(1<Q.U$.length)this.Tv[O].show(Q.U$,T,this.height-this.imageDimension);else{const K=this.vz.children.length;for(let X=0;X<this.vz.children.length;X++)Q.element===this.vz.children[X]&&this.Tv[O].show(Q.U$,T,this.height-(K-X)*this.xJa+2)}}else this.Tv[O].show(Q.U$,this.width,0)}IF(Q,O){var T=Object(e.a)(u,Q);T=T?this.q_b(T):-1;if(2===
O.type||1===O.type&&-1!==T&&!this.Tv[T].visible)this.WHa(Q);else if(1===O.type)this.lN(),this.i6=!1;else if(3===O.type){if(this.WZb(O.Vi))return;this.i6||this.lN()}this.raiseEvent(r.a.Zo,O)}WZb(Q){Q=I.q7a(Q);let O=!1;for(const T of this.Tv)if(A.a.Qsa(T.element,Q)){O=!0;break}return this.vz!==Q&&A.a.Qsa(this.vz,Q)||O}Woc(Q,O=0){const T=this.J9d(Q);T&&0>=Q.nO?this.Tv[O].hide():T?this.WHa(Q):this.Tv[O].hide()}q_b(Q){let O=0;for(const T of this.Vl){if(Q===T)return O;O++}return-1}J9d(Q){const O=this.q_b(Q);
return!!this.FTb&&Q===this.FTb&&-1!==O&&this.Tv[O].visible}Fgb(Q){this.LH=Q===this.imageDimension?1:Math.floor(Q/this.xJa);this.eG?(this.element.style.height=Q+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=Q+"px",this.element.style.height=this.imageDimension+"px")}static F6a(){return String.format("{0}-{1}","presencetooltip",I.vga++)}static q7a(Q){Q=Q.mc.rawEvent;return Q.relatedTarget||Q.toElement}}I.vga=0;Object(J.a)(I,"PresenceTooltipControl",m.a,[572,106]);
var H=d(219),L=d(285),E=d(265);d.d(V,"a",function(){return aa});class aa{constructor(Q){this.Ic=Q;this.Ic.lD(10,H.a.instance);this.Ic.lD(9,E.a.instance);this.Ic.lD(6,16);this.Ic.lD(13,L.a.instance)}CGc(Q,O){return new I(Q,O,this.Ic)}Lqb(Q){return new I(Q,16,this.Ic)}}Object(J.a)(aa,"PresenceTooltipFactory",null,[571])},1124:function(J,V,d){J=d(0);class h{}h.taskPaneWidth=330;Object(J.a)(h,"AppsForOfficeConstants",null,[]);d.d(V,"a",function(){return e});class e{constructor(){this.JV=null;this.resizeMaxWidth=
this.resizeMinWidth=0;this.taskPaneWidth=h.taskPaneWidth;this.CU=this.sourceLocationOverrideResourceId=null;this.nonPersistedSettings={};this.onTaskPaneClose=null;this.isResizable=this.isModernPane=!1;this.sharedRuntimeId=null;this.isPaneAutoOpened=this.isPreload=!1}}Object(J.a)(e,"FirstPartyAddInOptionalParameters",null,[])},1200:function(J,V,d){d.d(V,"a",function(){return A});J=d(0);var h=d(82),e=d(119),m=d(25),r=d(93),v=d(245);class A extends h.a{constructor(w,y=!1){super(w,!1,y)}get n5b(){return!1}get DK(){return v.a.JYb+
"/modeless"}get qxb(){return null}set qxb(w){}get mxb(){return null}set mxb(w){}tj(w,y=null,u=null){this.kK&&(u.isModal=!1);super.tj(w,y,u)}hide(){if(m.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.HideReactModelessDialogEnabled")||this.rc)this.DDh(),m.AFrameworkApplication.Aa.Aw.zo(e.AFrame.S9),super.hide()}I1h(){const w=m.AFrameworkApplication.Aa.Aw,y=m.AFrameworkApplication.Aa.Lr;w.P1(this.DK);w.Tpa(this.DK);y.Dc(this.DK).parent=e.AFrame.jj}Upa(){r.FocusManager.mM()&&
(super.Upa(),this.I1h(),m.AFrameworkApplication.Aa.Aw.lK(e.AFrame.S9))}Bfb(){if(r.FocusManager.mM()&&!m.AFrameworkApplication.Vg){const w=r.FocusManager.instance();w.R4(this.DK);const y=w.SP(this.DK);y&&y.uj.wE(null);w.MFb(this.DK)}}Ema(){"DL"===this.Mpa||"DP"===this.Mpa?super.Ema():m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.ka("WacAutoFitNonModalDialogIsEnabled")?(this.DDh(),this.EJf()&&this.tth(this.rc.clientHeight,this.rc.clientWidth)):this.QF()}QF(){this.tth(h.a.M0e,h.a.Q0e)}tth(w,
y){if(this.mxb&&this.qxb){let u,D;u=v.a.Bgc+this.qxb;D=v.a.Agc+this.mxb;u+w>this.Qia()&&(u=this.Qia()-w);D+y>this.esa()&&(D=this.esa()-y);this.Qjd(u,D)}else super.QF()}L1d(w){if(!w)return null;w.endsWith("px")&&(w=w.substring(0,w.length-2));return v.a.pwb(w)?((w=parseInt(w))||(w=1),w):null}DDh(){if(this.rc&&this.rc.style){var w=this.L1d(this.rc.style.top);w&&(this.qxb=w-v.a.Bgc);if(w=m.AFrameworkApplication.isRtl?this.L1d(this.rc.style.right):this.L1d(this.rc.style.left))this.mxb=w-v.a.Agc}}}Object(J.a)(A,
"ModelessCustomDialog",h.a,[])},1204:function(J,V,d){d.r(V);var h=d(0),e=d(376),m=d(1167),r=d(1168),v=d(13),A=d(1166),w;(function(z){z[z.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";z[z.cloudPolicySettings=1]="cloudPolicySettings";z[z.alternateAuthToken=2]="alternateAuthToken"})(w||(w={}));Object(h.b)("ApplicationFeatureHelperRequestType",w);class y{constructor(){this.message=null;this.gv=0}}Object(h.a)(y,"HttpRequstToPromiseRejectData",null,[]);var u=d(94),D=d(80),F=d(172),
I=d(45);class H{constructor(z,U){this.eb=z;this.$h=U}EXb(z,U,ka,Ba=null,Ia=null,Ab=null,Ob=null,Yb=null){const uc=w[ka],mc=uc+"RequestFailure";u.Health.instance.recordKpiUsage(mc,0,"jpittsdirects",null);return new Promise((Ec,Yc)=>{e.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",uc);const jd=null!=Ob?Ob:this.eb.Cc("ApplicationFeatureHelperRequestQueueTimeout",15E3),vd=null!=Yb?Yb:this.eb.Cc("ApplicationFeatureHelperRequestSentTimeout",
3E4);this.$h.sV(z,1,null,this.z0d(ka,Ba),Ab,1,he=>{e.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",uc);try{if(void 0===he||null===he||void 0===he.data||null===he.data||void 0===he.data.Sd||null===he.data.Sd){u.Health.instance.recordKpiFailure(mc,"Invalid RequestSucceededEventArgs",!1,!0,null);let ee=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
uc);Yc(this.Sia(ee,he))}else if(he.data.Le!==F.a.py){u.Health.instance.recordKpiFailure(mc,"HttpStatusCode_"+he.data.Le.toString(),!1,!0,null);let ee=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",he.data.Le,uc);Yc(this.Sia(ee,he))}else{void 0!==Ia&&null!==Ia&&void 0!==he.data.qj&&null!==he.data.qj&&Ia(he.data.qj);var nd=U(he.data.Sd);if(nd)e.ULS.sendTraceTag(50622690,3004,
50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",uc),Ec(nd);else{u.Health.instance.recordKpiFailure(mc,"Parse Failure",!1,!0,null);let ee=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",uc);Yc(this.Sia(ee,he))}}}catch(ee){u.Health.instance.recordKpiFailure(mc,"Unexpected Failure",!1,!0,null),nd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
ee,uc),Yc(this.Sia(nd,he))}},he=>{if(he.data){u.Health.instance.recordKpiFailure(mc,"HttpStatusCode_"+he.data.Le.toString(),!1,!0,null);var nd=I.a.ROc(he.data.Sd||"No Data");nd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",he.data.Le,nd,uc)}else u.Health.instance.recordKpiFailure(mc,"Invalid RequestFailedEventArgs",!1,!0,null),nd=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",
uc);Yc(this.Sia(nd,he))},null,void 0,void 0,jd,vd)})}Sia(z,U){const ka=new y;ka.message=z;ka.gv=U&&U.data?U.data.Le:-1;return ka}z0d(z,U){const ka={};ka["x-UserDataSignature"]=this.eb.Ga("UserDataSignature");ka["x-LicensingIsEnabled"]=this.eb.ka("LicensingIsEnabled").toString();ka["x-CacheIsEnabled"]=this.eb.ka("LicensingRedisIsEnabled").toString();ka["x-OcpsIsEnabled"]=this.eb.ka("OcpsIsEnabled").toString();ka["x-LicensingAADIdIsEnabled"]=this.eb.ka("LicensingAadIdIsEnabled").toString();0===z&&(ka["x-LicenseCheckOnTenantEnabled"]=
"true",ka["x-SupportUserConsentDependentFeatures"]="true",ka["x-AFHUserConsentGroupValue"]="0",ka["x-UseShellServiceForUserConsentGroup"]="true",ka["x-SMBUserLicensingEnabled"]="true",ka["x-AFHPIPLComplianceEnabled"]=D.a.BS(window.location.href,"wd_afhpipl")||"false");if(U)for(let Ba of U.keys)ka[Ba]=U.ga(Ba);return ka}}Object(h.a)(H,"HttpRequestToPromiseUtility",null,[]);var L=d(25),E;(function(z){z[z.loki=0]="loki";z[z.augloopACLP=1]="augloopACLP"})(E||(E={}));Object(h.b)("AlternateAuthSupportApp",
E);var aa=d(234),Q=d(33);class O{constructor(){this.Token=null;this.ExpirationTime=0}}Object(h.a)(O,"WacAlternateAuthToken",null,[]);class T{constructor(z,U){this.fpl=3E5;if(void 0===z||null===z||void 0===U||null===U)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.eb=z;this.Bqc=new m.a(r.a.Tq());this.uOb=new H(z,U);void 0!==aa.OAuthManagerSettings.ffe&&null!==aa.OAuthManagerSettings.ffe&&void 0!==aa.OAuthManagerSettings.KXc&&null!==aa.OAuthManagerSettings.KXc&&0<aa.OAuthManagerSettings.KXc&&
(z=new O,z.Token=aa.OAuthManagerSettings.ffe,z.ExpirationTime=aa.OAuthManagerSettings.KXc,this.Bqc.$("loki",z))}b_i(){let z=null;this.Bqc.Jb(E[0])&&(z=this.Bqc.ga(E[0]));return void 0===z||null===z||this.oRj(z)?this.uSi():Promise.resolve(z.Token)}oRj(z){return z.ExpirationTime-Date.now()<this.fpl}uSi(){const z=new m.a(r.a.Tq());z.$("X-AlternateAuthApp",E[0]);return this.uOb.EXb(this.JQa("/afhs/AlternateAuthHelperHandler.ashx"),Object(v.a)(this,this.evk,"parseAlternateAuthTokenResponse"),2,z).then(U=>
{e.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",E[0]);this.Bqc.$(E[0],U);return U.Token},U=>{U=Object(A.a)(y,U);e.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",U.message,U.gv);return null})}evk(z){let U=null;({ou:U}=Q.d(z));e.ULS.sendTraceTag(545821457,3004,U?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",z);return U}JQa(z){return String.format("{0}{1}?{2}",
this.eb.Ga("WebServiceBase"),z,L.AFrameworkApplication.hh)}}Object(h.a)(T,"AlternateAuthHelper",null,[440]);var K=d(1030);class X{constructor(z,U,ka){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=z;this.isEnabled=U;this.tierName=ka}}Object(h.a)(X,"FeatureStateChangeArgs",null,[]);var P=d(214),ea=d(217),ia=d(54),ja=d(101),C=d(106),pa;(function(z){z[z.Enabled=0]="Enabled";z[z.Disabled=1]="Disabled"})(pa||(pa={}));Object(h.b)("FeatureState",pa);var Z=d(55),qa=d(35),ya=d(87);
class Ka{constructor(z,U,ka=null,Ba=null,Ia=null){this.fQa=this.jV=this.nuf=this.cMa=this.Zyc=null;this.uOb=new H(z,U);this.eb=z;this.NRh=z.Cc("LicensingMaxRetryAttempts",0);this.Iuc=z.ka("IsO365ConsumerHost");this.axd=z.ka("IsO365CommercialHost");this.yuc=z.ka("PremiumUpsellIsEnabled");this.uyd=0;this.D_e=ka;this.ZAf=Ba;this.Ca=Ia;this.bMa=z.ka("LicensingIsEnabled");this.Xoa=z.ka("OcpsIsEnabled")&&this.axd;this.vGd=z.ka("ShowPrivacyDialog")&&!!Ba;this.fwd=z.ka("IsAnonymousUser");this.WWd=new Promise(Ab=>
{Ab(!1)});this.IZa=new Promise(Ab=>{Ab(!0)});this.eQa=new m.a(r.a.Tq());this.iAc=!0;this.Vef=this.t8i();this.bbe()&&!this.fwd?(void 0!==L.AFrameworkApplication.Aa&&null!==L.AFrameworkApplication.Aa&&(this.Zyc=L.AFrameworkApplication.Aa.EU,void 0!==this.Zyc&&null!==this.Zyc&&(this.cMa=this.Zyc.nCb("WebServiceCall","ApplicationFeatureHelperService"))),this.fQa=this.STe()):this.fQa=new Promise(Ab=>{Ab({})});this.fQa.catch(Ab=>{Ab=Object(A.a)(y,Ab);e.ULS.sendTraceTag(42513088,3004,10,"ApplicationFeatureHelper initialization failed, HttpStatus={0}",
Ab?Ab.gv.toString():"Unknown")});this.iAc&&(this.yuc=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(Ab=>{this.yuc=this.eb.ka("PremiumUpsellIsEnabled")&&Ab;return null}))}t8i(){const z=this.eb.Kw("AllLicensedFeatures")?this.eb.XB("AllLicensedFeatures"):[],U=new K.a;for(let ka=0;ka<z.length;ka++)U.add(z[ka]);return U}bbe(){return this.axd||this.Iuc}STe(z=0,U=!1){e.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",U);const ka=P.a.Fz();ka&&(ka.set("retryAttempt",
z.toString()),ka.set("forceRefresh",U.toString()),ka.set("isO365ConsumerHost",this.Iuc.toString()),ka.set("isO365CommercialHost",this.axd.toString()),ka.set("isFreemiumUpsellSettingEnabled",this.yuc.toString()));u.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",ka);u.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",ka);void 0!==this.cMa&&null!==this.cMa&&this.cMa.start();let Ba=null;U&&(Ba=new m.a(r.a.Tq()),Ba.$("x-LicensingForceRefresh",
"true"));this.nuf=new Date;return(this.bMa?this.uOb.EXb(this.JQa("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(v.a)(this,this.hvk,"parseApplicationFeatureHelperResponse"),0,Ba,Object(v.a)(this,this.NCk,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(Ia=>{const Ab=Object.assign(new ya.a,{durationMs:this.rvh()});Ab.extendedProperties=ka;Ab.extendedProperties&&Ia&&(Ab.extendedProperties.set("featureCount",ja.a.count(Ia).toString()),Ab.extendedProperties.set("licensingTestFeatureEnabled",
("LicensingTestFeature"in Ia).toString()),Ab.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Ia).toString()),"FreemiumUpsell"in Ia&&Ab.extendedProperties.set("isFreemiumUpsellEnabled",Ia.FreemiumUpsell.toString()),this.jV&&Ab.extendedProperties.set("fromCache",(this.jV<this.nuf).toString()));u.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Ab);return Ia},Ia=>{const Ab=Object.assign(new ya.a,{durationMs:this.rvh()}),Ob=Object(A.a)(y,Ia);if(!Ob)return e.ULS.sendTraceTag(51491471,
3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),u.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Ab),new Promise((Yb,uc)=>{uc(Ia)});Ab.extendedProperties=ka;Ab.extendedProperties&&Ab.extendedProperties.set("status",Ob.gv.toString());u.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Ab);return 408===Ob.gv&&++z<=this.NRh?this.STe(z):new Promise((Yb,
uc)=>{uc(Ob)})})}hvk(z){(z=Q.b(z))?(e.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),e.ULS.sendTraceTag(50938594,3004,50,"{0}",z)):e.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return z.Features}JQa(z){var U=String.format("{0}{1}",this.eb.Ga("WebServiceBase"),z);this.eb.Kw("ApplicationFeatureHelperHttpCachingEnabled")&&this.eb.ka("ApplicationFeatureHelperHttpCachingEnabled")&&
(z=Ka.$Nc(this.eb))&&0<z.length&&(this.iAc&&(z+="ucbf"),U=new ea.QueryStringBuilder(U),U.Ti("afhskey",z),U=U.toString());return U}isFeatureEnabled(z,U){if(!this.Xoa&&!this.vGd&&!this.bMa)return this.IZa;e.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",z);if("ConnectedServices"===z){var ka=this.Xoa?this.D_e.M2("ControllerConnectedServicesEnabled"):this.IZa;const Ab=this.vGd?this.ZAf.getSettings().then(Ob=>2!==Ob.QB,()=>
U):this.IZa;return ka.then(Ob=>Ob?Ab:this.WWd)}ka=null;ka=this.Xoa?this.D_e.isFeatureEnabled(z):this.IZa;let Ba=null;Ba=this.bMa?this.dIj(z,U):this.IZa;let Ia=null;Ia=this.vGd?this.ZAf.isFeatureEnabled(z):this.IZa;return ka.then(Ab=>Ab?Ia.then(Ob=>Ob?Ba:this.WWd):this.WWd).then(Ab=>{this.lDg(z,Ab,!0);return Ab},()=>{this.lDg(z,U,!1);return U})}lDg(z,U,ka){e.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",z,U,ka)}getFeatureTier(z,U){if(!this.bMa)return new Promise(ka=>
{ka(2)});e.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",z);return this.fQa.then(ka=>this.xPc(z,ka,U),()=>U)}isFreemiumUpsellEnabled(){const z=this.yuc&&this.Iuc&&!this.fwd;if(z&&2!==this.uyd||!z&&1!==this.uyd)e.ULS.sendTraceTag(509728161,3004,20,"ApplicationFeatureHelper_IsFreemiumUpsellEnabled: isO365ConsumerHost={0}, isAnonymousUser={1}, isFreemiumUpsellEnabled={2}",this.Iuc.toString(),this.fwd.toString(),z.toString()),this.uyd=z?
2:1;return z}launchUpsellExperience(z,U=null){e.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",z));var ka=P.a.Fz();ka&&(ka.set("experienceId",z),U&&ka.set("campaignId",U));u.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",ka);if(ka=Z.a.instance.qb("Common.IInProductMessagingUIManager")){const Ba=Object(v.a)(this,this.knj,"handleDimeTaskComplete");ka.PBg(z,Ba,U)}else e.ULS.sendTraceTag(594367561,
3004,15,"InProductMessaging was not initialized"),u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),this.Ca.La(qa.a.ILc,2,{["experience"]:z})}sfb(z,U){if(!this.bMa)return null;if(!z||!U)return e.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;const ka=C.a.create().toString();this.eQa.Jb(z)||this.eQa.$(z,new m.a(r.a.Tq()));this.eQa.ga(z).add(ka,U);e.ULS.sendTraceTag(594564812,
3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",ka,z));return ka}HFb(z,U){this.bMa&&(z&&this.eQa.Jb(z)?U&&C.a.isValid(U)?this.eQa.ga(z).Jb(U)?(e.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",U,z)),this.eQa.ga(z).remove(U)):e.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",
U,z)):e.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",U,z)):e.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",z)))}xPc(z,U,ka){return this.iAc?z in U?U[z].LicenseTier:ka:z in U?this.Qvk(U[z],ka):ka}Qvk(z,U){switch(z.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;
default:return U}}knj(){e.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.fQa.then(z=>{this.ddh(z)}).catch(()=>{this.ddh({})})}ddh(z){e.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");const U=this.STe(0,!0);U.then(ka=>{this.fQa=U;ja.a.count(ka)>ja.a.count(z)?u.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",
!1,!0,null);for(let Ba of this.eQa.keys)if(Ba in ka){const Ia=this.xPc(Ba,ka,0);Ba in z?this.xPc(Ba,z,0)!==Ia&&this.Nve(Ba,!0,Ia):this.Nve(Ba,!0,Ia)}else Ba in z&&this.Nve(Ba,!1,this.xPc(Ba,z,0))}).catch(ka=>{u.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);e.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(ka))})}Nve(z,U,ka){e.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
z,U,ka);U=new X(z,U,ka);ka=this.eQa.ga(z);for(let Ba of ka)try{Ba.value(U)}catch(Ia){e.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",z,Ba.key,Ia.message))}}cIj(z,U){if(this.bMa){const ka=this.Vef.contains(z);let Ba=!0,Ia="",Ab=!1;return this.fQa.then(Ob=>{z in Ob?(Ob=Ob[z],Ia=pa[Ob.FeatureState],Ba=1!==Ob.FeatureState):Ba=!ka;this.vDg(z,ka,Ia,Ab,U,Ba);return Ba},
()=>{Ab=!0;ka&&(Ba=U);this.vDg(z,ka,Ia,Ab,U,Ba);return Ba})}return this.IZa}vDg(z,U,ka,Ba,Ia,Ab){e.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",z,U,Ba,ka,Ia,Ab)}dIj(z,U){if(this.iAc)return this.cIj(z,U);if(this.bMa){if(this.Vef.contains(z))return this.fQa.then(ka=>z in ka,()=>U);e.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",
z)}return this.IZa}NCk(z){try{z&&"Date"in z&&(this.jV=new Date(z.Date),e.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.jV.toString()))}catch(U){e.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",U)}}rvh(){if(void 0!==this.cMa&&null!==this.cMa){const z=this.cMa.Kq;this.cMa.stop();return z}return null}static $Nc(z){try{if(ia.a.GQe){const U=z.Ga("UserDataSignature").split(".");if(1<U.length){const ka=
window.self.atob(U[1]),Ba=JSON.parse(ka).LocalStorageKey;if(void 0!==Ba&&null!==Ba&&0<Ba.length)return Ba}}}catch(U){e.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",U.toString())}return null}}Object(h.a)(Ka,"ApplicationFeatureHelper",null,[441]);var Da=d(17);class la{constructor(z,U){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=z.PolicySettings;z=new Date;z.setMinutes(z.getMinutes()+U);this.ExpirationTime=z.getTime()}}Object(h.a)(la,"CloudPolicySettingsCacheData",
null,[]);var ma=d(364),Ea=d(232),ta=d(280);class Ga{static kth(){return L.AFrameworkApplication.fa.ka("SideCarIsEnabled")?Ga.zgd&&Ga.GTc?new Promise(z=>{z(!0)}):new Promise((z,U)=>{Ga.zgd=ta.a.create(L.AFrameworkApplication.fa.Ga("SideCarUrl"));Ea.a.Kx(Ga.zgd);Ga.zgd.ZR((ka,Ba)=>{(Ga.GTc=Ba.succeeded)?z(Ba.succeeded):U(Ba.succeeded)})}):new Promise(z=>{z(!1)})}}Ga.GTc=!1;Ga.zgd=null;Object(h.a)(Ga,"SideCarLoader",null,[]);class oa{constructor(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=
null}}Object(h.a)(oa,"CloudPolicySettingsData",null,[]);class sa{constructor(z,U){this.Hrd=0;this.eFc=null;this.uOb=new H(z,U);this.eb=z;U=z.Ga("HostAuthType");this.Xoa=z.ka("OcpsIsEnabled")&&z.ka("IsO365CommercialHost")&&!(void 0===U||null===U)&&"aad"===U.toLowerCase();this.Jhf=Q.b(z.Ga("OcpsDefaultSettings")||"{}");this.PPb=this.$Nc();U=this.eb.Kw("ServicesControlsMicrosoftControllerServicesList")?this.eb.XB("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.Orc=new K.a;for(let ka=0;ka<
U.length;ka++)this.Orc.add(U[ka]);this.Xoa&&!z.ka("IsAnonymousUser")&&z.ka("SideCarIsEnabled")?this.eFc=this.psl():this.eFc=this.RTe(this.Xoa,this.JQa("/afhs/CloudPolicySettings.ashx"),Object(v.a)(this,this.ovk,"parseCloudPolicySettingsResponse"));this.eFc.then(()=>null).catch(ka=>{ka=Object(A.a)(y,ka);e.ULS.sendTraceTag(50622685,3004,10,"CloudPolicySettingsHelper initialization failed, HttpStatus={0}",ka?ka.gv.toString():"Unknown")})}M2(z,U=!0){if(!this.Xoa){const Ab=this;return new Promise(Ob=>
{Ob(Ab.c1b(z))})}let ka=this,Ba=this;const Ia=this.eFc.then(Ab=>{try{let Ob=null;Ab.PolicySettings&&"unknown"in Ab.PolicySettings&&(Ob=Ab.PolicySettings.unknown);if(Ob){if(z in Ob&&void 0!==Ob[z]&&null!==Ob[z])return new Promise(uc=>{uc("0"!==Ob[z])});const Yb=z.toLowerCase();if(Yb in Ob&&void 0!==Ob[Yb]&&null!==Ob[Yb])return new Promise(uc=>{uc("0"!==Ob[Yb])});e.ULS.sendTraceTag(51512667,3004,50,"Policy"+z+" not found, using default");return new Promise(uc=>{uc(ka.c1b(z))})}return new Promise(Yb=>
{Yb(ka.c1b(z))})}catch(Ob){return e.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+z+" policy value. Error Message: {0}",Ob.message),ka.handleError(Ob.toString(),U,ka.c1b(z))}},Ab=>Ba.handleError(Ab,U,Ba.c1b(z)));Ia.then(Ab=>{e.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",z,Ab);return null});return Ia}isFeatureEnabled(z,U=!0){if(this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))return this.fIj(z,U);let ka=new Promise(Ia=>{Ia(!0)}),Ba="";this.Orc.contains(z)&&(Ba="ControllerConnectedServicesEnabled",ka=this.M2(Ba,U));ka.then(Ia=>{e.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",z,Ia,Ba);return null});return ka}fIj(z,U=!0){let ka=new Promise(Ia=>{Ia(!0)}),Ba="";"mso_sendASmile"===z?Ba="Enabled":"Survey"===z||"FloodgateSurvey"===z?Ba="SurveyEnabled":this.Orc.contains(z)&&(Ba="ControllerConnectedServicesEnabled");
""!==Ba&&(ka=this.M2(Ba,U));ka.then(Ia=>{e.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",z,Ia,Ba);return null});return ka}handleError(z,U,ka){return U?new Promise(Ba=>{Ba(ka)}):new Promise((Ba,Ia)=>{Ia(z)})}RTe(z,U,ka){if(!z)return Promise.resolve(new oa);let Ba=!1,Ia=null;u.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);let Ab=this.HQd("GetCloudPolicySettings");return(new Promise((Ob,
Yb)=>{if(void 0!==this.PPb&&null!==this.PPb&&0<this.PPb.length){const uc=this.Wrl();if(void 0!==uc&&null!==uc){Ba=!0;Ob(uc);return}}this.uOb.EXb(U,ka,1,null,Object(v.a)(this,this.UCk,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this.eb.Cc("CloudPolicySettingsRequestQueueTimeout",15E3),this.eb.Cc("CloudPolicySettingsRequestSentTimeout",3E4)).then(uc=>{e.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");this.atl(uc);Ob(uc);return uc},uc=>{Yb(uc);return null})})).then(Ob=>
{({ly:Ab,returnValue:Ia}=this.okd(Ab));var Yb=P.a.Fz();Yb&&Yb.set("FromCache",Ba.toString());Yb=Object.assign(new ya.a,{durationMs:Ia,extendedProperties:Yb});u.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Yb);return Ob})}psl(){return Ga.kth().then(()=>{e.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})}JQa(z){return String.format("{0}{1}",this.eb.Ga("WebServiceBase"),
z)}ovk(z){let U=null;({ou:U}=Q.d(z));z=!!U;e.ULS.sendTraceTag(50622687,3004,z?50:10,"ParseCloudPolicySettingsResponse: Success={0}",z);return U}UCk(z){try{if(void 0!==z&&null!==z&&"CheckIn-Interval"in z){const U=parseInt(z["CheckIn-Interval"]);void 0!==U&&null!==U&&0<U&&(this.Hrd=U)}}catch(U){e.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",U)}}c1b(z){return z in this.Jhf?"0"!==this.Jhf[z]:!0}Wrl(){try{const z=ma.a.instance.getItem(this.PPb);if(void 0===
z||null===z)return e.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;e.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",z);const U=JSON.parse(z);if(void 0===U||null===U)return e.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===U.ExpirationTime||null===U.ExpirationTime)return e.ULS.sendTraceTag(51662939,
3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(U.ExpirationTime)).getTime()<Date.now())return e.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;const ka=new oa;ka.PolicySettings=U.PolicySettings;ka.ControllerConnectedServicesFeatureNames=new Da.a;this.eb.Kw("ServicesControlsMicrosoftControllerServicesList")&&this.eb.XB("ServicesControlsMicrosoftControllerServicesList");for(let Ba of this.Orc)ka.ControllerConnectedServicesFeatureNames.add(Ba);
e.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return ka}catch(z){return e.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",z.toString()),null}}atl(z){try{if(void 0===z||null===z||void 0===z.PolicySettings||null===z.PolicySettings)e.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.Hrd)e.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");
else{const U=new la(z,this.Hrd),ka=JSON.stringify(U);e.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",ka);ma.a.instance.setItem(this.PPb,ka);e.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(U){e.ULS.sendTraceTag(51662976,3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",U.toString())}}$Nc(){const z=Ka.$Nc(this.eb);return z&&0<z.length?"OCPS"+z:null}HQd(z){const U=Z.a.instance.qb("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");
return void 0!==U&&null!==U?U.zi("WebServiceCall",z):null}okd(z){if(void 0!==z&&null!==z){const U=z.Kq;z.stop();return{returnValue:U,ly:null}}return{returnValue:null,ly:z}}}Object(h.a)(sa,"CloudPolicySettingsHelper",null,[438]);class Ha{constructor(){this.l_f=this.jFh=this.QB=0;this.m_f=this.kFh=this.P4a="";this.uEd=this.nya=2}clone(){const z=new Ha;z.QB=this.QB;z.jFh=this.jFh;z.l_f=this.l_f;z.P4a=this.P4a;z.kFh=this.kFh;z.m_f=this.m_f;z.nya=this.nya;z.uEd=this.src;return z}get src(){return this.uEd}serialize(z=
null){const U={};if(!z||z.contains(Ha.Mdb))U[Ha.Mdb]=this.QB;if(!z||z.contains(Ha.nec))U[Ha.nec]=this.P4a;if(!z||z.contains(Ha.oec))U[Ha.oec]=this.nya;return JSON.stringify(U)}static create(z,U=null){const ka=new Ha;ka.uEd=z;void 0!==U&&null!==U&&(Ha.Mdb in U&&(ka.QB=U[Ha.Mdb]),Ha.nec in U&&(ka.P4a=U[Ha.nec]),Ha.oec in U&&(ka.nya=U[Ha.oec]));return ka}static deserialize(z,U){try{const ka=JSON.parse(z);if(void 0!==ka&&null!==ka)return Ha.create(U,ka);e.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",
z);throw Error.argument("settingsData");}catch(ka){throw e.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",ka.toString()),ka;}}}Ha.Mdb="CCS";Ha.nec="CCSTime";Ha.oec="OfficePrivacyRoamedNoticeShown";Object(h.a)(Ha,"UserPrivacySettings",null,[]);var bb=d(213);class Ya{constructor(z,U){if(void 0===z||null===z||void 0===U||null===U)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.eb=z;this.$h=U;this.KDd=this.Ic=null}JQa(z){var U=this.eb.appSettings.RoamingServiceHandlerWebServiceBase||
"";this.eb.isChangeGateEnabled("OfficeVSO:7445267_RoamingServiceBaseURLFix")&&!U.endsWith("/")&&(U+="/");U=String.format("{0}RoamingServiceHandler.ashx?action=",U);U=new Sys.StringBuilder(U);U.append(z);U.append("&");U.append(L.AFrameworkApplication.hh);return U.toString()}executeRequest(z,U,ka,Ba=null){return this.$h.Xnb(z,U,Ba,null,2,ka,"33",!1,null,6E4)}saveSettings(z){return new Promise((U,ka)=>{try{if(void 0===this.Ic||null===this.Ic||void 0===z||null===z)e.ULS.sendTraceTag(51258443,3004,15,
"SaveUserPrivacySettings: Can't determine setting changes to save"),ka("Can't determine setting changes to save");else{var Ba=this.Ic.QB!==z.QB;if(2===this.Ic.src&&Ba)this.NZk(z),U(!0);else{var Ia=this.P1k(z);if(void 0===Ia||null===Ia||!Ia.length)e.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),ka("No changes to save");else if(1===this.Ic.src)U(this.cBh(Ia));else if(0===this.Ic.src){e.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",
Ia);const Ab=this.executeRequest(this.JQa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Ia);Ab.continueWith(()=>{if(Ab.Jn||Ab.hm)e.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),U(!1);else{var Ob=Ab.result;void 0!==Ob.Ui&&null!==Ob.Ui&&void 0!==Ob.Ui.data&&null!==Ob.Ui.data&&Ob.Ui.data.Le===F.a.py?(e.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),U(!0)):(e.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),
U(!1))}})}}}}catch(Ab){e.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",Ab.toString()),U(!1)}})}P1k(z){if(void 0===this.Ic||null===this.Ic||void 0===z||null===z)throw Error.invalidOperation("User Privacy settings have not been initialized");const U=new Da.a;0===z.src?(this.Ic.QB!==z.QB&&(U.add(Ha.Mdb),U.add(Ha.nec)),this.Ic.nya!==z.nya&&U.add(Ha.oec)):1===z.src&&this.Ic.QB!==z.QB&&U.add(Ha.Mdb);return U.count?z.serialize(U):(e.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),
null)}getSettings(){if(!this.KDd){const z=this;this.KDd=new Promise(U=>{try{z.Ic?U(z.Ic.clone()):z.esl().then(ka=>{z.Ic=ka;U(z.Ic.clone());return null},()=>{z.csl().then(ka=>{z.Ic=ka;U(z.Ic.clone());return null},()=>{z.dsl().then(ka=>{z.Ic=ka;U(z.Ic.clone());return null},()=>{e.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");z.Ic=new Ha;U(z.Ic.clone());return null});return null});return null})}catch(ka){e.ULS.sendTraceTag(50860932,3004,10,
"UserPrivacySettings GetSettings: Exception = {0}",ka.toString()),z.Ic=new Ha,U(z.Ic.clone())}})}return this.KDd}esl(){return new Promise((z,U)=>{try{const Ba=-1!==window.location.href.indexOf("&wd_pn=2");if(this.eb.ka("PrivacyDialogShouldCheckRoaming")||Ba){var ka=this.executeRequest(this.JQa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");ka.continueWith(()=>{try{if(ka.Jn||ka.hm)e.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{const Ia=
ka.result;if(Ia&&Ia.Ui&&Ia.Ui.data)if(Ia.Ui.data.Le!==F.a.py)e.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Ia.Ui.data.Le);else{if(Ia.Ui.data.Sd){z(Ya.parse(Ia.Ui.data.Sd,0));e.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Ia.Ui.data.Sd);return}e.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else e.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");U("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Ia){e.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Ia.toString()),U("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else e.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),U("Roaming should not be used")}catch(Ba){e.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",Ba.toString()),U("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})}csl(){return new Promise((z,U)=>{try{const ka=bb.a.get("WacUPToggleState");let Ba=null;void 0!==ka&&null!==ka&&0<ka.length&&(Ba=decodeURIComponent(ka));if(void 0!==Ba&&null!==Ba&&0<Ba.length){const Ia=Ya.parse(Ba,1);e.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Ia.toString());z(Ia)}else{const Ia=Ha.create(1),
Ab=new Da.a;Ab.add(Ha.Mdb);const Ob=Ia.serialize(Ab);this.cBh(Ob)?(e.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Ob),z(Ia)):(e.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Ob),U("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(ka){e.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
ka.toString()),U("UserPrivacySettings TryGetSettingsFromCookie Eception")}})}dsl(){return new Promise(z=>{try{var U=-1!==window.location.href.indexOf("&wdccsoff=1");let ka=Ha.create(2);U?(ka.QB=2,L.AFrameworkApplication.$Yf(),e.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",ka.toString())):(ka.QB=1,e.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",ka.toString()));z(ka)}catch(ka){e.ULS.sendTraceTag(50967431,
3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",ka.toString()),U=Ha.create(2),U.QB=1,z(U)}})}NZk(z){e.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===z.QB?L.AFrameworkApplication.$Yf():L.AFrameworkApplication.vMi();e.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",z)}cBh(z){try{e.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",z);const U=this.eb.Ga("PrivacyCookieDomain")||
"";if(!U||!U.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");e.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",z);return bb.a.cph("WacUPToggleState",z,bb.a.JL,U)}catch(U){return e.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",U.toString()),!1}}isFeatureEnabled(z){return this.getSettings().then(U=>{const ka=this.eb.Kw("ServicesControlsMicrosoftControllerServicesList")?this.eb.XB("ServicesControlsMicrosoftControllerServicesList"):
[],Ba=new K.a;for(let Ia=0;Ia<ka.length;Ia++)Ba.add(ka[Ia]);return Ba.contains(z)?2!==U.QB:!0},()=>{e.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",z);return!0})}static parse(z,U){try{return e.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",z,U),Ha.deserialize(z,U)}catch(ka){throw e.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",ka.toString()),ka;}}}Object(h.a)(Ya,"UserPrivacySettingsHelper",null,[439]);
var ua=d(68);class Ma{constructor(){this.Da=null}get name(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}Wb(z){this.Da=z;this.Da.register(438,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").ma().na(()=>new sa(L.AFrameworkApplication.fa,L.AFrameworkApplication.Ge));this.Da.register(439,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").ma().na(()=>new Ya(L.AFrameworkApplication.fa,L.AFrameworkApplication.Ge));this.Da.register(440,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").ma().na(()=>
new T(L.AFrameworkApplication.fa,L.AFrameworkApplication.Ge));this.Da.register(441,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").ma().na(()=>new Ka(L.AFrameworkApplication.fa,L.AFrameworkApplication.Ge,this.Da.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),this.Da.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),L.AFrameworkApplication.Ta))}init(){L.AFrameworkApplication.fa.ff(()=>{const z=this.Da.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");
L.AFrameworkApplication.fa.ka("LicensingIsEnabled")&&(z.isFeatureEnabled("LicensingTestFeature",!1).then(U=>{e.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",U,L.AFrameworkApplication.fa.Ga("IsAnonymousUser"));return null}),z.getFeatureTier("LicensingTestFeature",0).then(U=>{e.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",
U,L.AFrameworkApplication.fa.Ga("IsAnonymousUser"));return null}));this.Da.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");this.fnl()})}dispose(){}fnl(){try{L.AFrameworkApplication.fa.ka("SideCarIsEnabled")&&Ga.kth().then(z=>{e.ULS.sendTraceTag(594057429,3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",z);return z})}catch(z){}}static main(){ua.a.instance.Bc(new Ma)}}Object(h.a)(Ma,"ApplicationFeatureHelperPackage",null,[2,3]);var Ca=d(505),Va=d(6);class Za{constructor(z,
U){this.$h=z;this.fD=U}ux(z,U,ka,Ba=null){return this.fKi(z,Ba,Ia=>this.$h.Xnb(Ia,2,ka,U,2,void 0,void 0,void 0,void 0,void 0,"2"))}fKi(z,U,ka){const Ba=!!U&&""!==U;let Ia=z;Ba&&(Ia=D.a.u3a(z,"perfTag",U));const Ab=new Date;return Ca.a.then(ka(Ia),Ob=>{const Yb=+new Date-+Ab;if(!Ob||!Ob.Ui||!Ob.Ui.data)return Ob;Ba&&Ob.Ui.data.request&&this.h1k(Ob.Ui.data.request.getResolvedUrl(),U,Yb);return Ob})}h1k(z,U,ka){z=this.fD.Ocj(z);if(z.count&&(z=Va.last(z))){const Ba={Message:"Request durations for activities calls."};
Ba.PerfTag=U;Ba.CustomDuration=ka;Ba.PerformanceDuration=z.duration;e.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Ba))}}}Object(h.a)(Za,"CatchUpNetworkingWrapper",null,[605]);var Db=d(370);class Lb extends Db.a{constructor(z,U){super(z,U)}Ok(){return 6}}Object(h.a)(Lb,"GetActivityFeedRequest",Db.a,[]);class yb extends Db.a{constructor(z,U,ka,Ba,Ia,Ab){super(z,U);this.ItemIds=null;this.ActivityStatesToReset=this.ActivityStatesToSet=0;this.ResetUnseenCount=!1;this.ItemIds=ka;this.ActivityStatesToSet=
Ba;this.ActivityStatesToReset=Ia;this.ResetUnseenCount=Ab}Ok(){return 7}}Object(h.a)(yb,"UpdateActivityFeedStateRequest",Db.a,[]);var Bc=d(519);class tb{constructor(z,U,ka){this.dhf=z;this.I_a=U;this.T_a=ka}getActivityFeed(z){return Ca.a.then(this.T_a.execute(new Lb(this.I_a(),null),(U,ka,Ba)=>this.dhf.ux(U,ka,Ba,"ActivityFeed"),z),U=>{if(!U)return e.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!U.Ui)return e.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeed: Response.Args is null"),
null;if(!U.Ui.data)return e.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!U.Ui.data.Sd)return e.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;U=Bc.a.o5a(U.Ui.data.Sd);return U?U:(e.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})}Zul(z,U,ka,Ba,Ia){return Ca.a.then(this.T_a.execute(new yb(this.I_a(),null,U,ka,Ba,Ia),(Ab,Ob,Yb)=>this.dhf.ux(Ab,Ob,Yb,"UpdateActivityFeedState"),
z),Ab=>{try{return Ab.succeeded}catch(Ob){return e.ULS.sendTraceTag(523121054,3012,10,"UpdateActivityFeed: Exception: "+Ob.message),!1}})}}Object(h.a)(tb,"CatchUpRequestHandler",null,[606]);var Mb=d(208);class Hb{constructor(z){this.dnb=z;this.xff=new Mb.a}FXj(){this.wYj()}wYj(){if(this.dnb){var z=U=>{this.xff.contains("CatchUpChangesFeedback")||(this.xff.add("CatchUpChangesFeedback"),U.logActivity("CatchUpChangesFeedback",null))};this.dnb.execute(U=>{window.setTimeout(()=>{z(U)},2E4)})}else e.ULS.sendTraceTag(571586199,
383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")}}Object(h.a)(Hb,"FloodgateEventLogger",null,[]);class vb{constructor(z){this.rUh=z}get duration(){return this.rUh.duration}}Object(h.a)(vb,"PerformanceResourceTimingWrapper",null,[]);class Xb{constructor(z){this.fD=z}Ocj(z){const U=new Da.a;if(!this.fD)return U;z=this.fD.getEntriesByName(z,"resource");if(!z)return U;for(const ka of z)U.add(new vb(ka));return U}}Object(h.a)(Xb,"PerformanceWrapper",null,[]);class Uc{constructor(){this.Da=
null}get name(){return"Common.App.CatchUpActivity"}Wb(z){this.Da=z;this.Da.register(Za,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").ma().na(()=>new Za(L.AFrameworkApplication.Ge,new Xb(window.performance)));this.Da.register(tb,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").ma().na(()=>new tb(this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),()=>L.AFrameworkApplication.hh,
new Bc.a));this.Da.register(Hb,"Common.App.CatchUpActivity.FloodgateEventLogger").ma().na(()=>new Hb(this.Da.Ka("Common.ISystemInitiatedFeedback")))}init(){this.Da.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");this.Da.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")}dispose(){}static main(){ua.a.instance.Bc(new Uc)}}Object(h.a)(Uc,"CatchUpActivityPackage",null,[2,3]);var hb=d(1165),Zb=d(104);class Fc{constructor(z,U,ka){this.nOe=this.oOe=this.pOe=!1;this.AOe=!z&&!U;this.BOe=
!z&&!ka;this.AOe||this.BOe||(this.pOe=!z,this.oOe=!U,this.nOe=!ka)}}Object(h.a)(Fc,"RenameDisabledDialogInfo",null,[]);class ob extends Zb.StandardDialog{constructor(z,U,ka,Ba,Ia){super();this.PRe=[];this.z1=new Fc(z,U,ka);this.vNa=Ba;this.WLa=Ia;this.ng="RenameDisabledDialog";this.yd=0;this.Ue(1,CommonUIStrings.l_DialogClose);this.d8k();this.JTk()}d8k(){this.z1.AOe?this.imc(this.vNa?this.WLa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.z1.BOe?this.imc(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.v2h();this.KAc(this.PRe)}imc(z){Array.add(this.PRe,z)}v2h(){const z=[];this.z1.pOe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledSignIn);this.z1.oOe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.z1.nOe||Array.add(z,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<z.length&&Array.add(this.PRe,z)}}Object(h.a)(ob,"ReactRenameDisabledDialogBase",
Zb.StandardDialog,[]);class ac extends ob{constructor(z,U,ka,Ba,Ia){super(z,U,ka,Ba,Ia)}JTk(){this.pCb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)}}Object(h.a)(ac,"ReactRenameDisabledDialog",ob,[]);var pb=d(82);class nb{static get mg(){return pb.a.UB(nb.fo,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}nb.fo="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(h.a)(nb,"RenameDisabledDialogHtml",null,[]);class Tb extends pb.a{constructor(z,U,ka,Ba,Ia){super();this.z1=new Fc(z,U,ka);this.vNa=Ba;this.WLa=Ia;this.ng="RenameDisabledDialog";this.yd=0;this.Ue(1,CommonUIStrings.l_DialogClose);this.mg=nb.mg;this.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);this.i5("RenameRow")}Mva(){if(this.z1.AOe){let z;z=this.vNa?this.WLa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:
CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;Tb.imc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),z)}else this.z1.BOe?Tb.imc(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.Juj()}Juj(){this.z1.pOe&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.z1.oOe&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display=
"none");this.z1.nOe&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")}static imc(z,U,ka){z.style.display="none";U.innerText=ka}}Object(h.a)(Tb,"RenameDisabledDialog",pb.a,[]);var Ub=d(70);class hc{constructor(z,U){this.y1a=0;this.Ca=z;this.woa=U}initialize(z){if(!this.Ca||!this.woa)return!1;this.y1a=z;this.ub();return!0}ub(){this.Ca.ya(qa.a.uPd,Ub.a.frame,Object(v.a)(this,this.uPd,"commitNewDocumentTitle"))}uPd(z,U,ka,Ba,Ia){if(1===ka)return this.Ca.processAction(qa.a.renameFile,
1);z=I.a.yG(this.woa.Ix);Ia=(0,Ia.getNewDocumentTitle)();Ia.length>this.y1a&&(Ia=Ia.substr(0,this.y1a));if(32!==this.Ca.La(qa.a.renameFile,2,Ia))return this.MKb(z),8;this.MKb(Ia);return 32}MKb(z){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(z))}static WB(){return new hc(L.AFrameworkApplication.Ta,L.AFrameworkApplication.pu)}}Object(h.a)(hc,"ReactRenameUIHandler",null,[656]);var Wb=d(263),fd=d(659),fc=d(566),bc=d(65),cc=d(178),kb=d(265),ab=d(133),Pb=d(63);class rc{constructor(z,U,ka,
Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc){this._initialized=!1;this._element=null;this.y1a=0;this.vDd=this.Hvd=!1;this.Ca=z;this.Qqd=U;this.Lg=ka;this.Qo=Ba;this.woa=Ia;this.Dvf=Ab;this.qyc=Ob;this.Mrd=Yb;this.Ioa=uc;this.qaf=mc;this.fj=Ec;this.Ewd=Yc}get isActive(){return"true"===this._element.getAttribute("contentEditable")}initialize(z,U,ka){if(!(this.Ca&&this.woa&&this.Dvf&&this.qyc&&this.Mrd&&U)||0>=z)return!1;this._element=U;this._element.title=ka;this._element.setAttribute(ab.a.Ye,ab.a.hu);this._element.setAttribute("Unselectable",
"on");this.y1a=z;this.oJ();return this._initialized=!0}oJ(){this.Qqd&&(this.Qqd.ob(bc.a.blur,this._element,Object(v.a)(this,this.onBlur,"onBlur")),this.Qqd.ob(bc.a.paste,this._element,Object(v.a)(this,this.Tok,"onPaste")));this.Lg.ob(bc.a.Xf,this._element,Object(v.a)(this,this.onKeyDown,"onKeyDown"));this.Qo.ob(bc.a.pointerDown,this._element,Object(v.a)(this,this.Pva,"onPointerDown"));this.Qo.ob(bc.a.XQ,this._element,Object(v.a)(this,this.lye,"onPointerUp"))}onBlur(){this.isActive&&!this.Hvd&&(this.qaf||
this.Mrd(this._element),this.FRf(),this.HSd(!1));return this.Hvd=!1}Tok(){e.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0}onKeyDown(z){return this.isActive?this.Ank(z):this.Bnk(z)}Ank(z){let U=!1;switch(z.mc.keyCode){case Sys.UI.Key.enter:this.FRf();this.HSd(this.fj||this.Ewd);U=!0;break;case Sys.UI.Key.tab:this.qaf&&this.Mrd(this._element);break;case Sys.UI.Key.esc:this.JHe(),this.HSd(this.fj||this.Ewd),U=!0}return U}Bnk(z){let U=!1;switch(z.mc.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Xzh(this.Ewd),
this.isActive&&this.qyc(this._element),U=!0}return U}Pva(){this.isActive||(this.Xzh(!1),this.isActive&&(this._element.focus(),this.qyc(this._element),this.vDd=!0));return!1}lye(){return this.vDd?(this.qyc(this._element),this.vDd=!1,!0):!1}Bwb(){return 32===this.Ca.processAction(qa.a.renameFile,1)}FRf(){const z=I.a.yG(this.woa.Ix);let U=this._element.innerText.trim();U.length>this.y1a&&(U=U.substr(0,this.y1a));U!==z&&""!==U?32!==this.Ca.La(qa.a.renameFile,2,U)?this.JHe():this.MKb(U):this.JHe()}JHe(){this.MKb(I.a.yG(this.woa.Ix))}MKb(z){this._initialized&&
(this._element.innerText=z,this.Dvf())}Xzh(z){this.Bwb()?this.isActive||(z&&(this.Hvd=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(ab.a.Ye,ab.a.UIf),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Wb.CuiHelper.V_f),this.Ioa&&this.Ioa.execute(U=>{U.nbh(!0)}),z&&this._element.focus(),e.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):this.Ca.processAction(qa.a.wIb,
2)}HSd(z){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(ab.a.Ye,ab.a.hu);Sys.UI.DomElement.removeCssClass(this._element,Wb.CuiHelper.V_f);this.Ioa&&this.Ioa.execute(U=>{U.nbh(!1)});z&&(this._element.blur(),this._element.focus())}static fYa(){fd.a.fYa(L.AFrameworkApplication.isRtl)}static WB(){return new rc(L.AFrameworkApplication.Ta,fc.a.instance,cc.KeyInputManager.instance,kb.a.instance,L.AFrameworkApplication.pu,rc.fYa,
Pb.a.Y_k,Pb.a.aQf,Z.a.instance.Ka("Common.App.Header.HeaderEventSource"),ia.a.qF,ia.a.Ki,ia.a.eg)}}Object(h.a)(rc,"RenameUIHandler",null,[656]);class ic{static get instance(){return L.AFrameworkApplication.Aa.jb.xN?ic.Ja||(ic.Ja=hc.WB()):ic.Ja||(ic.Ja=rc.WB())}}ic.Ja=null;Object(h.a)(ic,"RenameUIHandlerFactory",null,[]);class md{constructor(){this.qve=this.Pgk=this.KEi=null}}Object(h.a)(md,"RenameMruEntryProperties",null,[]);var Fd=d(171),ne=d(125),ud=d(427),gb;(function(z){z[z.unknown=-1]="unknown";
z[z.success=0]="success";z[z.renameInvalidFileName=1]="renameInvalidFileName";z[z.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";z[z.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";z[z.permissionDenied=4]="permissionDenied";z[z.serverCommunicationFailure=5]="serverCommunicationFailure";z[z.fileNameTooLong=6]="fileNameTooLong"})(gb||(gb={}));Object(h.b)("CommonOperationResult",gb);class Vb{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc){this.ecf=z;this.Ca=U;this.Yfa=ka;this.HE=
Ba;this.o1a=Ia;this.e_h=Ab;this.vNa=Ob;this.AAf=Yb;this.FVh=uc;this.WLa=mc;this.eb=Ec;this.EVh=Yc}ub(){L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.xN||this.kn.ya(qa.a.R3b,Ub.a.frame,Object(v.a)(this,this.R3b,"initializeRenameUIHandler"));this.kn.ya(qa.a.wIb,Ub.a.frame,Object(v.a)(this,this.wIb,"showRenameDisabledDialog"));this.kn.ya(qa.a.renameFile,Ub.a.frame,Object(v.a)(this,this.renameFile,"renameFile"));this.kn.pa(qa.a.fileNameUpdate,Ub.a.frame,Object(v.a)(this,this.bMk,"refreshFilename"),
64);this.kn.pa(qa.a.B7c,Ub.a.frame,Object(v.a)(this,this.B7c,"moveToFolderCompleteByHost"),64);this.kn.ya(qa.a.zdb,Ub.a.frame,Object(v.a)(this,this.zdb,"moveToFolder"));(L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IgnorePostMessageChecksForMove",!0)||L.AFrameworkApplication.Aa&&(L.AFrameworkApplication.fa.ka("PostMessageEmbedded")||L.AFrameworkApplication.fa.ka("IsJsApi"))&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0))&&L.AFrameworkApplication.ES().execute(z=>{z.fu(ne.a.$Vg);z.kB(ne.a.$Vg,Vb.iKk);z.fu(ne.a.kXd);z.kB(ne.a.kXd,Vb.gKk)})}Bwb(){return 0===this.EVh.Qeg()?32:8}bAl(){return this.yA?this.vNa?this.yA.qUd:this.yA.rCa:!0}R3b(){return ic.instance.initialize(L.AFrameworkApplication.BKc,L.AFrameworkApplication.NIc,L.AFrameworkApplication.Wfh||CommonUIStrings.l_RenameFileTooltip)?32:8}wIb(){const z=this.bAl(),U=this.e_h();e.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",
this.o1a,U,z,this.vNa);L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.gC&&L.AFrameworkApplication.fa.ka("ReactRenameDisabledDialogIsEnabled")?new ac(this.o1a,!U,!z,this.vNa,this.WLa()):new Tb(this.o1a,!U,!z,this.vNa,this.WLa());return 32}renameFile(z,U,ka,Ba,Ia){if(1===ka)return this.Bwb();if(!L.AFrameworkApplication.R5a)return 8;if(8===this.Bwb())return this.kn.processAction(qa.a.wIb,2),8;e.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");L.AFrameworkApplication.R5a(Ia,Object(v.a)(this,
this.Yec,"onRenameFileSuccess"),Object(v.a)(this,this.Dpk,"onRenameFileFailure"));return 32}Yec(z,U){z?0!==z.OperationResult?this.zjg(z.OperationResult):(this.b1k(U,z.NewName),this.kvl(z,Object(v.a)(L.AFrameworkApplication.Aa.jb,L.AFrameworkApplication.Aa.jb.TDh,"updateOpenInClientDocumentUrl")),L.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&L.AFrameworkApplication.Aa.updateCommandUI(),this.FVh.DCh()):this.zjg(5)}b1k(z,U){const ka={};ka[Fd.a.OSi]=U;z.sendMessage(ne.a.kXd,ka)}kvl(z,
U){this.xvl(z);L.AFrameworkApplication.hIc=z.DirectInvokeDavUrl;U=U(z.EditDocInClientUrl);const ka=new md;ka.qve=this.HE.Ix;ka.KEi=U;ka.Pgk=z.EditDocInClientUrl;this.kn.La(qa.a.Xfh,2,ka)}zjg(z){switch(z){case 1:z=new Zb.StandardDialog,z.yd=0,z.DO(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.gih()}}xvl(z){this.HE.Ix=Vb.T$h(this.HE.Ix,z.NewName);z.BreadcrumbFolderName&&(this.HE.breadcrumbFolderName=z.BreadcrumbFolderName);z.BreadcrumbFolderUrl&&(this.HE.breadcrumbFolderUrl=
z.BreadcrumbFolderUrl);this.AAf(z.NewName)}Dpk(z){const U=new Zb.StandardDialog;U.yd=0;switch(z){case 1:e.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");U.whb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:e.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");U.whb(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:e.ULS.sendTraceTag(38114565,
203,15,"OnRenameFileFailure: {0}",{["Result"]:z}),U.whb(CommonUIStrings.l_RenameFileGenericErrorTitle,CommonUIStrings.l_RenameFileGenericError,null)}L.AFrameworkApplication.ES().execute(ka=>{ka.sendMessage(ne.a.NSi,{["FailureMessage"]:gb[z]})});this.gih()}bMk(z,U,ka){if(1===ka)return this.Bwb();if(!L.AFrameworkApplication.rra)return 8;L.AFrameworkApplication.rra(Object(v.a)(this,this.EDb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.h$c,"onRefreshFilenameFailure"),!1);return 32}zdb(z,U,ka,Ba,
Ia){if(1===ka)return L.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?32:8;if(2===ka){const Ab={};z=L.AFrameworkApplication.K9a;U=L.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");z=(!z||z&&U)&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);Ab[Fd.a.xkl]=z;Ia&&Ia.MoveButtonClickedTime&&(Ab[Fd.a.Qfk]=Ia.MoveButtonClickedTime.getTime());L.AFrameworkApplication.ES().execute(Ob=>{Ob.sendMessage(ne.a.zdb,Ab)});Ia&&Ia.MoveButtonClickedTime&&
((z=P.a.Fz())&&z.set("MovePostDuration",((new Date).getTime()-Ia.MoveButtonClickedTime.getTime()).toString()),u.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",z));return 32}return 8}B7c(z,U,ka,Ba,Ia){if(1===ka)return L.AFrameworkApplication.fa.ka("UiHostSupportsMoveToFolder")?this.Bwb():8;if(2===ka){if(!L.AFrameworkApplication.Ikc)return u.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Ia)return u.Health.instance.recordKpiFailure("MoveToFolder",
"Null actiondata",!1,!1,null),8;if(Ia[Fd.a.OGj])if(Ia[Fd.a.NEh])if(z=Ia[Fd.a.NEh].toLowerCase(),U=L.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),ka=L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),U&&L.AFrameworkApplication.K9a&&ka){const Ab={};Ab[Fd.a.sFb]="1";Ab[Fd.a.documentUrl]=z;Ab[Fd.a.reason]=ud.a.GIe;u.Health.instance.recordKpiSuccess("MoveToFolder",null);L.AFrameworkApplication.ES().execute(Ob=>{Ob.sendMessage(ne.a.KBa,Ab)})}else if(!L.AFrameworkApplication.K9a&&
ka)u.Health.instance.recordKpiSuccess("MoveToFolder",null),Pb.a.an(z,Pb.a.Z$(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return u.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else u.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else L.AFrameworkApplication.rra(Object(v.a)(this,this.EDb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.h$c,"onRefreshFilenameFailure"),!1),L.AFrameworkApplication.Ikc(),u.Health.instance.recordKpiSuccess("MoveToFolder",
null)}return 32}rcl(z,U){return z&&U?z!==this.HE.breadcrumbFolderName||U!==this.HE.breadcrumbFolderUrl:!1}EDb(z,U){z&&(z.NewName!==I.a.yG(this.HE.Ix)||this.rcl(z.BreadcrumbFolderName,z.BreadcrumbFolderUrl))&&this.Yec(z,U)}h$c(){}gih(){this.AAf(I.a.yG(this.HE.Ix))}get kn(){return this.Ca.value}get yA(){return this.Yfa.value}static get instance(){return Vb.Ja||(Vb.Ja=Vb.J6a())}static J6a(){return new Vb(L.AFrameworkApplication.N5b,new hb.a(()=>L.AFrameworkApplication.Ta),new hb.a(()=>L.AFrameworkApplication.yA),
L.AFrameworkApplication.pu,L.AFrameworkApplication.mQ,()=>L.AFrameworkApplication.rpc,L.AFrameworkApplication.Ajc,Object(v.a)(ic.instance,ic.instance.MKb,"updateTitle"),Z.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),()=>L.AFrameworkApplication.WS,L.AFrameworkApplication.fa,Z.a.instance.resolve("Common.IRenameProps"))}static T$h(z,U){z=I.a.WV(z);return U+z}static iKk(z){const U=z.Values[Fd.a.lLj];e.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",U);U?
L.AFrameworkApplication.Ta.La(qa.a.B7c,2,z.Values):u.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)}static gKk(z){L.AFrameworkApplication.Ta.La(qa.a.renameFile,2,z.Values.NewName)}}Vb.Ja=null;Object(h.a)(Vb,"RenameActor",null,[]);var Lc=d(377),Xc=d(644),Ib=d(585),gc=d(195);class Fb{constructor(z,U){this.Ca=z;this.Usd=U}ub(){this.Ca.ya(qa.a.$el,Ub.a.frame,Object(v.a)(this,this.afl,"showRenameDialogAction"))}afl(z,U,ka){z=32;if(1===ka)return gc.SessionStatusManager.instance.gja||
L.AFrameworkApplication.hQ?8:32;2===ka&&(32!==this.Ca.processAction(qa.a.renameFile,1)?(this.Ca.processAction(qa.a.wIb,2),Lc.a.instance.Tb(Xc.a.wia,{["Reason"]:Ib.a.lTk}),z=8):32===this.Ca.processAction(qa.a.hmc,1)?this.Ca.processAction(qa.a.hmc,2):this.Usd.value.create().n5());return z}}Object(h.a)(Fb,"RenameDialogActor",null,[641]);class fb{constructor(z,U,ka){this.dialog=null;this.Ca=z;this.HE=U;this.yLa=ka}Hcj(){const z={};z.nameInputProps={["type"]:"AppInputProps",["id"]:fb.wrb,["label"]:CommonUIStrings.l_RenameDialogLabel,
["value"]:I.a.yG(this.HE.Ix),["maxLength"]:this.yLa};return z}n5(){const z={["id"]:"RenameDialog",["bodyControls"]:this.Hcj()};this.dialog=new pb.a(!1,!1,!0);this.dialog.yd=1;this.dialog.ng="RenameDialog";this.dialog.tj(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.zGe,"renameDialogHandler"),z)}zGe(z,U){if(U&&1===z){if(U[fb.wrb]&&(z=I.a.yG(this.HE.Ix),U=(U[fb.wrb]||"").trim(),U!==z&&""!==U)){this.Ca.La(qa.a.renameFile,2,U);return}Lc.a.instance.Tb(Xc.a.XYb,{["Reason"]:Ib.a.K4f})}}}fb.wrb=
"txtDocumentName";Object(h.a)(fb,"ReactRenameDialog",null,[657]);class Pc{static get mg(){return pb.a.UB(Pc.fo,CommonUIStrings.l_RenameDialogLabel)}}Pc.fo="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(h.a)(Pc,"RenameDialogHtml",null,[]);class dd extends pb.a{constructor(z,U,ka){super();this.Ca=z;this.HE=U;this.yLa=
ka;this.ng="RenameDialog";this.mg=Pc.mg}n5(){var z={["txtDocumentName"]:I.a.yG(this.HE.Ix)};this.tj(CommonUIStrings.l_RenameDialogTitle,Object(v.a)(this,this.zGe,"renameDialogHandler"),z);z=document.getElementById(dd.wrb);0<this.yLa&&(z.maxLength=this.yLa);z.focus()}zGe(z,U){if(1===z&&(z=I.a.yG(this.HE.Ix),U=(U[dd.wrb]||"").trim(),U!==z&&""!==U)){this.Ca.La(qa.a.renameFile,2,U);return}Lc.a.instance.Tb(Xc.a.XYb,{["Reason"]:Ib.a.K4f})}}dd.wrb="txtDocumentName";Object(h.a)(dd,"RenameDialog",pb.a,[657]);
class kd{constructor(z){this.woa=null;this.yLa=0;this.Ca=z;this._initialized=!1}initialize(z,U){this.woa=z;this.yLa=U;this._initialized=!0}create(){return this._initialized?L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.gC&&L.AFrameworkApplication.fa.ka("ReactRenameDialogIsEnabled")?new fb(this.Ca,this.woa,this.yLa):new dd(this.Ca,this.woa,this.yLa):null}}Object(h.a)(kd,"RenameDialogFactory",null,[640]);var Td=d(119),ce=d(100),ld=d(72),ad=d(78),Yf=d(132);class Xd{constructor(z,U){this.Ca=
z;this.Kd=U}ub(){this.Ca.ya(qa.a.hmc,Ub.a.frame,Object(v.a)(this,this.bfl,"showRenameFlyoutAction"))}fli(){return ld.d("setDocumentTitleFlyoutOpened")&&L.AFrameworkApplication.Aa.jb.xN}bfl(z,U,ka){if(1===ka)return this.fli()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32}D3h(){Xd.GPj&&L.AFrameworkApplication.Zsa&&Yf.a.instance.Cb(new ad.a(5,1,5E3,()=>{32===this.Ca.processAction(qa.a.hmc,1)&&this.Kd&&this.Kd.ze.name===Td.AFrame.PV&&(ce.a("RenameFloatieShownOnNewDocumentLoad",
!0),this.Ca.processAction(qa.a.hmc,2))}))}static get GPj(){Xd.Ruc&&null!=Xd.Ruc||(L.AFrameworkApplication.qta("ShowRenameFlyoutOnNewDocumentLoad;ShowRenameFlyoutOnNewDocumentLoadCf"),Xd.Ruc=L.AFrameworkApplication.fa?L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShowRenameFlyoutOnNewDocumentLoadIsEnabled",!1):!1);return Xd.Ruc}}Xd.Ruc=null;Object(h.a)(Xd,"RenameFlyoutActor",null,[637]);class fg{constructor(z,U,ka,Ba,Ia){this.YOd=null;this.Yfa=Ia;this.fcf=ka;this.ecf=
Ba;this.g_h=z;this.WLa=U}get yA(){return this.Yfa.value}Qeg(){if(!this.ecf())return 5;if(this.WLa())return 1;if(this.yA){if(this.fcf&&!this.yA.qUd)return 3;if(!this.fcf&&!this.yA.rCa)return 4}return this.g_h()?0:2}}Object(h.a)(fg,"RenameProps",null,[638]);var ue=d(67);class Sa{constructor(z,U,ka,Ba,Ia,Ab){this.Lp=!1;this.nyd=new ue.a;this.Lkb=U;this.fsc=ka;this.rrc=Ba;this.eb=Ia;this.$ga=Ab}enable(){this.Lp||(this.DCh(),this.MPe(),this.Lp=!0)}generateKey(z,U,ka){return String.format("{0}/{1}/{2}",
ka,z,U)}N7i(){const z=I.a.yG(this.Lkb().Ix);return this.generateKey(this.Lkb().breadcrumbFolderName,this.Lkb().breadcrumbFolderUrl,z)}O7i(z,U,ka){return z&&U?this.generateKey(z,U,ka):ka}xIi(z,U,ka){return z&&z!==this.Lkb().breadcrumbFolderName||U&&U!==this.Lkb().breadcrumbFolderUrl?!0:ka!==I.a.yG(this.Lkb().Ix)}DCh(){const z=this.N7i();this.nyd.$(z,new Date)}nAe(z){this.Zal(z)&&this.mCf(z)}Zal(z){const U=this.rrc();return U?this.$ga&&this.$ga.m9a||!U.X$d||!L.AFrameworkApplication.rra?(this.vvh(z),
this.Lp=!1):!0:!1}M2g(z,U,ka,Ba){const Ia=this.xIi(z,U,ka);z=this.O7i(z,U,ka);U=this.nyd.Rf(z).returnValue;Ia&&!U&&(this.Cjg(Ba),e.ULS.sendTraceTag(591734297,203,50,"{0} forced FileNameUpdate",this.Ree));Ia||this.nyd.$(z,this.fsc())}}Object(h.a)(Sa,"ARenamedFileChecker",null,[598]);class rb extends Sa{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb){super(z,U,ka,Ba,Ia,Ab);this.vtf=Ia;this.DVh=Ob;this.vvd=Yb}get Ree(){return"RenamedFileCheckerUsingSettingsRefresh"}MPe(){this.vtf.LId(Object(v.a)(this,this.Ckg,"handleSettingsRefresh"))}Ckg(z,
U){U&&U.aec&&U.Yik&&(U.Mwb("BreadcrumbDocName")||U.Mwb("BreadcrumbFolderName")||U.Mwb("BreadcrumbFolderUrl")||U.Mwb("DirectInvokeDAVUrl")||U.Mwb("EditDocInClientUrl"))&&(e.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",this.Ree),this.nAe(U))}vvh(){this.vtf.mSk(Object(v.a)(this,this.Ckg,"handleSettingsRefresh"))}mCf(z){if(z&&z.aec){const U=z.aec;this.M2g(U.Ga("BreadcrumbFolderName"),U.Ga("BreadcrumbFolderUrl"),U.Ga("BreadcrumbDocName"),z)}}Cjg(z){const U={OperationResult:0,classId:1};
z=z.aec;U.BreadcrumbFolderName=z.Ga("BreadcrumbFolderName");U.BreadcrumbFolderUrl=z.Ga("BreadcrumbFolderUrl");U.DirectInvokeDavUrl=z.Ga("DirectInvokeDAVUrl");U.EditDocInClientUrl=z.Ga("EditDocInClientUrl");z=z.Ga("BreadcrumbDocName");U.NewName=L.AFrameworkApplication.JIc?z:I.a.yG(z);this.vvd.execute(ka=>{this.wDj(U,ka)})}wDj(z,U){this.DVh().Yec(z,U)}}Object(h.a)(rb,"RenamedFileCheckerUsingSettingsRefresh",Sa,[]);class pc extends Sa{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc){super(z,ka,Ba,Ia,Ab,uc);
this.uRb=this.qAc=null;this.wUh=U;this.Ca=Ob;this.Rd=Yb;mc&&mc.execute(Ec=>{this.MOk(Ec)})}get Ree(){return"RenamedFileCheckerUsingTask"}MOk(z){this.qAc=z;this.qAc.EBc(Object(v.a)(this,this.P2b,"handleVisibilityChange"))}P2b(z,U){!this.Lp||0!==U.newState&&1!==U.newState||this.uRb||(this.MPe(),this.nAe(this.uRb))}MPe(){this.uRb=new ad.a(3,2,this.wUh(),Object(v.a)(this,this.nAe,"performRenameFileCheckTick"),89);this.Rd.Cb(this.uRb)}vvh(z){this.Rd.Ng(z)}mCf(z){this.qAc&&2===this.qAc.G3a?this.RPk(z):
L.AFrameworkApplication.rra(Object(v.a)(this,this.EDb,"onRefreshFilenameSuccess"),Object(v.a)(this,this.h$c,"onRefreshFilenameFailure"),!0)}RPk(z){this.Rd.Ng(z);this.uRb=null}EDb(z){z&&this.M2g(z.BreadcrumbFolderName,z.BreadcrumbFolderUrl,z.NewName,null)}Cjg(){this.Ca.processAction(qa.a.fileNameUpdate,2)}h$c(){}}Object(h.a)(pc,"RenamedFileCheckerUsingTask",Sa,[]);var cd=d(93);class zd{constructor(){this.eb=this.Da=null}get name(){return"Common.App.RenameFile"}Wb(z){this.Da=z;this.eb=L.AFrameworkApplication.fa;
this.Da.register(Fb,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").na(()=>new Fb(L.AFrameworkApplication.Ta,this.Da.le("Common.App.Rename.IRenameDialogFactory"))).ma();this.Da.register(kd,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").na(()=>new kd(L.AFrameworkApplication.Ta)).ma();this.Da.register(598,"Common.App.Rename.IRenamedFileChecker").na(()=>this.cCi()).ma();this.Da.register(Xd,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").na(()=>
new Xd(L.AFrameworkApplication.Ta,cd.FocusManager.instance())).ma()}cCi(){if(this.eb.ka("RenamedFileCheckerWithSettingsRefreshIsEnabled")){const z=this.Da.qb("Common.IRefreshableAppSettings");if(z&&z.gOj)return new rb(()=>z.Cc("RenamedFileCheckerMaxCachedAgeInMs",48E4),()=>L.AFrameworkApplication.pu,()=>new Date,()=>L.AFrameworkApplication.yA,z,this.Da.qb("Common.ISessionStatus"),()=>Vb.instance,this.Da.Ka("Postmessage.IHostPostmessenger"))}return new pc(()=>this.eb.Cc("RenamedFileCheckerMaxCachedAgeInMs",
48E4),()=>this.eb.Cc("RenamedFileCheckerPingIntervalInMs",12E4),()=>L.AFrameworkApplication.pu,()=>new Date,()=>L.AFrameworkApplication.yA,L.AFrameworkApplication.fa,L.AFrameworkApplication.Ta,L.AFrameworkApplication.pe,this.Da.qb("Common.ISessionStatus"),this.Da.Ka("Common.App.VisibilityManagement.IVisibilityManager"))}init(){this.eb.ff(Object(v.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){const z=L.AFrameworkApplication.Aa.jb.xN;L.AFrameworkApplication.N5b()&&ic.instance.initialize(L.AFrameworkApplication.BKc,
z?null:L.AFrameworkApplication.NIc,z?null:L.AFrameworkApplication.Wfh||CommonUIStrings.l_RenameFileTooltip)&&(this.Da.register(fg,"Common.App.Rename.RenameProps").as("Common.IRenameProps").na(()=>new fg(()=>L.AFrameworkApplication.rpc,()=>L.AFrameworkApplication.WS,L.AFrameworkApplication.Ajc,L.AFrameworkApplication.N5b,new hb.a(()=>L.AFrameworkApplication.yA))).ma(),Vb.instance.ub(),this.eb.ka("RenameDialogIsEnabled")&&(this.Da.resolve("Common.App.Rename.RenameDialogFactory").initialize(L.AFrameworkApplication.pu,
L.AFrameworkApplication.BKc),this.Da.resolve("Common.App.Rename.IRenameDialogActor").ub()),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").ub(),L.AFrameworkApplication.Ajc&&this.Da.resolve("Common.App.Rename.IRenamedFileChecker").enable(),this.Da.resolve("Common.App.Rename.IRenameFlyoutActor").D3h())}dispose(){}}Object(h.a)(zd,"PackageManager",null,[2,3]);const wd=z=>{try{return Q.a(z)}catch(U){}return null};class Oa{constructor(z,U,ka,Ba,Ia,Ab){this.t1=!1;this.MR=null;this.lBd=!1;this.Ca=
z;this.$h=U;this.Yfa=ka;this.Sef=Ba;this.eb=Ia;this.GRh=Ab}init(z,U){U&&z.Ka("Common.Interface.IRtcBasicProvider").execute(Object(v.a)(this,this.vLd,"awaitRtc"))}vLd(z){const U=z.GL.task;U.continueWith(()=>{this.MR=U.result;this.lBd&&(this.MR.$ea(2,null,!0),this.lBd=!1);this.MR.zAa((ka,Ba)=>{2===Ba.type&&this.kn.processAction(qa.a.fileNameUpdate,2)});this.MR.x3a((ka,Ba)=>{2===Ba.newState&&this.kn.processAction(qa.a.fileNameUpdate,2)});2===this.MR.connectionState&&this.kn.processAction(qa.a.fileNameUpdate,
2)})}rra(z){this.U2f(z,!0)}U2f(z,U){const ka=this.dhi(z.vth),Ba={};Ba[Oa.BSf]=Oa.CSf;this.phh.yj(ka,2,"",Ba,!1,2,Object(v.a)(this,this.EDb,"onRefreshFilenameSuccess"),U?Object(v.a)(this,this.ypk,"onRefreshFilenameFailureRetry"):Object(v.a)(this,this.D1g,"onRefreshFilenameFailureNoRetry"),z)}EDb(z){this.t1=!1;const U=wd(z.data.Sd);z.data.state.onSuccess(U,this.Sef.value)}ypk(z){5!==z.data.status||this.t1?this.D1g(z):(this.t1=!0,this.U2f(z.data.state,!1))}D1g(z){z.data.state.hz(-1)}R5a(z){this.V2f(z,
!0)}V2f(z,U){const ka=this.ehi(),Ba={};Ba[Oa.BSf]=Oa.CSf;Ba[Oa.ysj]=I.a.Qe(z.zhh);Ba[Oa.wsj]=this.GRh.value.YOd;this.phh.yj(ka,2,"",Ba,!1,2,Object(v.a)(this,this.Yec,"onRenameFileSuccess"),U?Object(v.a)(this,this.Epk,"onRenameFileFailureRetry"):Object(v.a)(this,this.J1g,"onRenameFileFailureNoRetry"),z)}ehi(){return this.oLf()}dhi(z){let U=this.oLf();return U=D.a.Ri(U,Oa.Csj,z?"2":"1")}oLf(){let z=(this.eb.value.appSettings.RenameWebServiceBase||"")+Oa.xsj;z=D.a.Ri(z,Oa.zsj,I.a.Qe(L.AFrameworkApplication.hh));
this.yA&&this.yA.X$d&&(z=D.a.Ri(z,Oa.Bsj,"1"));return z}Yec(z){this.t1=!1;const U=wd(z.data.Sd);z.data.state.onSuccess(U,this.Sef.value);this.AXg()}AXg(){this.MR?this.MR.$ea(2,null,!0):this.lBd=!0}Epk(z){5!==z.data.status||this.t1?this.J1g(z):(this.t1=!0,this.V2f(z.data.state,!1))}J1g(z){z.data.state.hz(-1)}get kn(){return this.Ca.value}get phh(){return this.$h.value}get yA(){return this.Yfa.value}static get instance(){return Oa.Ja||(Oa.Ja=Oa.J6a())}static J6a(){return new Oa(new hb.a(()=>L.AFrameworkApplication.Ta),
new hb.a(()=>L.AFrameworkApplication.Ge),new hb.a(()=>L.AFrameworkApplication.yA),new hb.a(()=>Z.a.instance.resolve("Postmessage.IHostPostmessenger")),new hb.a(()=>L.AFrameworkApplication.fa),new hb.a(()=>Z.a.instance.resolve("Common.IRenameProps")))}}Oa.BSf="Content-Type";Oa.CSf="application/json; charset=utf-8";Oa.xsj="renamehandler.ashx";Oa.zsj="qs";Oa.ysj="n";Oa.Bsj="sl";Oa.wsj="X-CoauthLockId";Oa.Csj="u";Oa.Ja=null;Object(h.a)(Oa,"ExecuteRenameFileHandler",null,[]);class jb{constructor(){this.hz=
this.onSuccess=null;this.vth=!1}}Object(h.a)(jb,"ExecuteRefreshFilenameData",null,[]);class qc{constructor(){this.hz=this.onSuccess=this.zhh=null}}Object(h.a)(qc,"ExecuteRenameFileData",null,[]);class ib{constructor(){this.Da=null;this.Utd=Oa.instance}get name(){return"Common.App.RenameFile.RenameExecutor"}Wb(z){this.Da=z}init(){L.AFrameworkApplication.fa.ff(Object(v.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){L.AFrameworkApplication.N5b()&&(Oa.instance.init(this.Da,L.AFrameworkApplication.Ajc),
L.AFrameworkApplication.R5a=Object(v.a)(this,this.R5a,"executeRenameFile"),L.AFrameworkApplication.rra=Object(v.a)(this,this.rra,"executeRefreshFilename"),L.AFrameworkApplication.Ikc=Object(v.a)(this,this.Ikc,"sendFileNameAndLocationUpdateNotification"))}R5a(z,U,ka){const Ba=new qc;Ba.zhh=z;Ba.onSuccess=U;Ba.hz=ka;this.Utd.R5a(Ba)}rra(z,U,ka){const Ba=new jb;Ba.onSuccess=z;Ba.hz=U;Ba.vth=ka;this.Utd.rra(Ba)}Ikc(){this.Utd.AXg()}dispose(){}}Object(h.a)(ib,"PackageManager",null,[2,3]);class Cb{constructor(z,
U,ka,Ba,Ia,Ab){this.PolicyCookie=this.WebAffinitizedUrl=this.IsSafeLinksEnabled=null;this.PolicyCookieTTL=0;this.WasServiceDown=!1;this.AffinitizedUrl=null;this.IsSafeLinksEnabled=z;this.WebAffinitizedUrl=U;this.PolicyCookie=ka;this.PolicyCookieTTL=Ba;this.WasServiceDown=Ia;this.AffinitizedUrl=Ab}}Object(h.a)(Cb,"SafeLinksData",null,[]);class yc{constructor(z,U){this.old=z;this.ly=U}}Object(h.a)(yc,"SafeLinksGetUrlReputationRequestData",null,[]);class gd{constructor(z,U,ka,Ba){this.eb=z;this.$h=U;
this.BOh=ka;gd.Vh=Ba}Vmd(z,U,ka){try{var Ba=null;gd.Vh&&(Ba=gd.Vh.zi("WebServiceCall","SafeLinksGetUrlReputation"));const Ia=new yc(U,Ba);Ba={};Ba.AffinitizedUrl=z;Ba.TargetUrl=U;Ba.PolicyCookie=ka;const Ab=Q.c(Ba);this.$h.yj(this.BOh,2,Ab,null,!1,2,Object(v.a)(this,this.Lmk,"onGetUrlReputationSuccessCallback"),Object(v.a)(this,this.Kmk,"onGetUrlReputationFailureCallback"),Ia,void 0,void 0,3E3,3E3,"36");return!0}catch(Ia){e.ULS.sendTraceTag(588788033,378,10,Ia.message)}return!1}Lmk(z){let U="OnGetUrlReputationSuccessCallback: ",
ka=10;const Ba=z.data.state;try{const Ia=Q.b(z.data.Sd).reputationResults[0],Ab=Ia.navigateUrl.length,Ob=Ba.old.length,Yb=Ia.navigateUrl===Ba.old;Ia.navigateUrl&&0<Ia.navigateUrl.length&&(Ba.old=Ia.navigateUrl);U+=String.format("HttpStatus {0}, verdict {1}, clickedUrlLength = {2} navigateUrlLength {3}, navigateUrlSameAsClickedUrl {4}",z.data.Le,Ia.verdict,Ob.toString(),Ab.toString(),Yb.toString());ka=50}catch(Ia){U+=String.format("Exception {0}",Ia.message)}this.Hjg(Ba,U,ka)}Kmk(z){let U="OnGetUrlReputationFailureCallback: ";
const ka=z.data.state;try{U+=String.format("HttpStatus {0}",z.data.Le)}catch(Ba){U+=String.format("Exception {0}",Ba.message)}this.Hjg(ka,U,10)}Hjg(z,U,ka){z.ly&&(z.ly.stop(),z.ly=null);e.ULS.sendTraceTag(588788034,378,ka,U);Pb.a.an(z.old,void 0,"noopener,noreferrer","SafeLinksNav")}}gd.Vh=null;Object(h.a)(gd,"SafeLinksNavigationHelper",null,[]);var od;(function(z){z[z.enabledByPolicy=0]="enabledByPolicy";z[z.disabledByPolicy=1]="disabledByPolicy";z[z.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure";
z[z.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"})(od||(od={}));Object(h.b)("SafeLinksNavigationState",od);var Mc=d(489);class Rd{constructor(z,U,ka,Ba=!1,Ia=null,Ab=null){this.F0a=this.E0a=0;this.X4b=this.Atc=!1;this.IMa=null;this.Hlb=!0;this.yyc=null;e.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager.");this.eb=z;this.$h=U;this.hoa=ka;Rd.Vh=Ab;this.z_h=Ba?this.eb.Ga("SafeLinksHandlerWebServiceBase"):this.eb.Ga("WebServiceBase");this.h_h=this.eb.Ga("SafeLinksHashedUserId");
this.DDl=this.eb.Ga("SafeLinksWorkloadIdHeaderValue");this.Hvc=this.eb.Cc("SafeLinksMaxGetPolicyBootRetries",2);this.Ivc=this.eb.Cc("SafeLinksMaxGetPolicyOnLinkClickRetries",1);this.suc=this.KOj();this.ruc=this.JOj();e.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this.suc,this.ruc);if(this.suc&&this.ruc){U=(z=this.Tsb())?z.IsSafeLinksEnabled.toLowerCase():"";ka=this.wbe();e.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",
U,ka);var Ob=!z||"unknown"===U||z.WasServiceDown||ka,Yb=P.a.Fz();Yb&&(Yb.set("shouldGetSafeLinksDataFromServer",Ob.toString()),Yb.set("isSafeLinksEnabledCacheValue",U.toString()));Ia?(this.Hlb=!1,Ia.execute(uc=>{uc.isFeatureEnabled("MsoUrlreputation",!0).then(mc=>{this.Hlb=mc;Yb.set("isUserLicensedForSafeLinks",this.Hlb.toString());u.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",0,"jpittsdirects",Yb);this.Hlb&&Ob&&this.OOc(!0);return null})})):(u.Health.instance.recordKpiUsage("SafeLinksGetPolicy1",
0,"jpittsdirects",Yb),Ob&&this.OOc(!0))}}get appName(){return this.hoa}get Pod(){return this.z_h}get userId(){return this.h_h}get nbj(){const z=this.Pod?this.Pod+"/":"",U=new ea.QueryStringBuilder("SafeLinksHandler.ashx");U.Ti("app",this.appName);this.eb.ka("SafeLinksUseDebugHeader")&&U.Ti("action","debug");this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&U.Ti("s2satpop","1");this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",
!1)&&U.Ti("s2se03","1");return String.format("{0}{1}&{2}",z,U.toString(),L.AFrameworkApplication.hh)}get Zij(){const z=this.Pod?this.Pod+"/":"",U=new ea.QueryStringBuilder("SafeLinksHandler.ashx");U.Ti("app",this.appName);this.eb.ka("SafeLinksUseDebugHeader")&&U.Ti("action","debug");this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAATPOP",!1)&&U.Ti("s2satpop","1");this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthAAT",!1)&&U.Ti("s2saat","1");
this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksS2SAuthUseE03App",!1)&&U.Ti("s2se03","1");U.Ti("slrt","GetUrlReputation");return String.format("{0}{1}&{2}",z,U.toString(),L.AFrameworkApplication.hh)}get Cgk(){Rd.eDd||(Rd.eDd=new gd(this.eb,this.$h,this.Zij,Rd.Vh));return Rd.eDd}Vmd(z){if(!z)return e.ULS.sendTraceTag(593367827,378,10,"SafeLinksManager.TryNavigate: Null/Empty targetUrl"),!1;var U=this.BJj(z);e.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",
U,this.suc,this.ruc,this.Hlb);if(!(U&&this.suc&&this.ruc&&this.Hlb))return!1;U=0;const ka=({state:U}=this.pcl()).returnValue;e.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",od[U]);const Ba=P.a.Fz();Ba&&Ba.set("SafeLinksNavigationState",od[U]);u.Health.instance.recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",Ba);if(!ka)return 2!==U&&3!==U||u.Health.instance.recordKpiFailure("SafeLinksNavigations",od[U],!1,!0,null),!1;e.ULS.sendTraceTag(26019601,
378,50,"Using safelinks to navigate hyperlink");if(this.Ccl())return this.wbe()?!1:this.Cgk.Vmd(this.LZi(),z,this.jeg());if(!this.wbe())return this.MAh(z),!0;this.IMa=z;e.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired.");this.X4b=!1;this.OOc();return!0}BJj(z){z=z.toLowerCase();const U=this.eb.XB("SafeLinksUnsupportedProtocols");if(U)for(let ka=0;ka<U.length;ka++)if(z.startsWith(U[ka]))return!1;return!0}OOc(z=!1){var U=P.a.Fz();U&&U.set("isOnBootRequest",z.toString());
u.Health.instance.recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",U);u.Health.instance.recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",U);U=this.HQd("SafeLinksGetPolicy");this.$h.yj(this.nbj,1,null,null,!0,2,Object(v.a)(this,this.Edj,"getSafeLinksDataFromServer_OnSuccessCallback"),Object(v.a)(this,this.Ddj,"getSafeLinksDataFromServer_OnFailureCallback"),U,void 0,void 0,void 0,void 0,"23");this.X4b=z;this.Atc=!0;z?this.E0a++:this.F0a++}Edj(z){let U=F.a.Ehk,
ka="";try{this.Atc=this.X4b=!1;var Ba=z.data.state;const Yc=({ly:Ba}=this.okd(Ba)).returnValue,jd=Object.assign(new ya.a,{durationMs:Yc});u.Health.instance.recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",jd);e.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",z.data.Le,z.data.Sd.length,Yc);if(z.data.Le!==F.a.py)ka="Unexpected httpStatus: "+z.data.Le.toString();else{Ba=null;try{Ba=Q.b(z.data.Sd)}catch(vd){ka="Exception:"+
vd.toString()+" deserializing response";return}if(Ba){var Ia=Ba.IsSafeLinksEnabled;if(void 0===Ia||null===Ia||0>=Ia.length)ka="Invalid isSafeLinksEnabledString";else{e.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",Ia);var Ab=Rd.Rze(Ia);if(void 0===Ba.WebAffinitizedUrl||null===Ba.WebAffinitizedUrl||0>=Ba.WebAffinitizedUrl.length)ka="Invalid WebAffinitizedUrl";else if(void 0===Ba.PolicyCookie||null===Ba.PolicyCookie||0>=Ba.PolicyCookie.length)ka="Invalid PolicyCookie";else if(void 0===
Ba.PolicyCookieTTL||null===Ba.PolicyCookieTTL)ka="Invalid PolicyCookieTTL";else{var Ob=Ba.WebAffinitizedUrl,Yb=Ba.PolicyCookie,uc=Ba.AffinitizedUrl,mc=new Date;mc.setMinutes(mc.getMinutes()+(5<Ba.PolicyCookieTTL?Ba.PolicyCookieTTL-5:0));var Ec=new Cb(Ia,Ob,Yb,mc.getTime(),!1,uc);this.wmh(Ec);U=z.data.Le;this.IMa&&(Ab?(this.MAh(this.IMa),this.F0a=this.E0a=0):(e.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),u.Health.instance.recordKpiFailure("SafeLinksNavigations",
"disabledByPolicy",!0,!0,null),Pb.a.mLc(this.IMa)),this.IMa=null)}}}else ka="Error when serializing response into SafeLinksData. SafeLinksData is null."}}catch(Yc){ka="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+Yc.toString()}finally{U!==F.a.py&&this.Gjg(U,ka)}}Ddj(z){this.Atc=!1;let U=500,ka="";try{let Ba=z.data.state;const Ia=({ly:Ba}=this.okd(Ba)).returnValue,Ab=Object.assign(new ya.a,{durationMs:Ia});U=z.data.Le;u.Health.instance.recordKpiFailure("SafeLinksGetPolicyFailedRequest",
"HttpStatusCode_"+U.toString(),!1,!0,Ab);ka="Request Failed, Status="+Mc.a[z.data.status]+" Duration: "+Ia}catch(Ba){ka="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+Ba.toString()}finally{this.Gjg(U,ka)}}Gjg(z,U=""){try{if(e.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",z,U),this.E0a<this.Hvc&&this.F0a<this.Ivc)this.OOc(this.X4b);else{this.X4b=!1;e.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",
this.E0a,this.F0a,z,U);U=null;const ka=P.a.Fz();ka&&(ka.set("HttpStatus",z.toString()),U=Object.assign(new ya.a,{extendedProperties:ka}));u.Health.instance.recordKpiFailure("SafeLinksGetPolicy1","GetPolicyRequestError",!1,!0,U);const Ba=new Cb("false","","",0,!0,"");this.wmh(Ba);this.IMa&&(e.ULS.sendTraceTag(26019603,378,50,"Error occurred during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),u.Health.instance.recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",
!1,!0,null),Pb.a.mLc(this.IMa),this.IMa=null)}}catch(ka){e.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",ka.toString())}}MAh(z){const U=this.jeg(),ka=this.Rjj(),Ba={};Ba.Url=z;Ba.SafeLinksCookie=U;Ba.CorrelationId=C.a.create().toString();Ba.WorkloadId=this.DDl;Ba.UserAgentInfo=ia.a.zy+"|"+this.appName;e.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",Ba.CorrelationId);Pb.a.qbd(Pb.a.Z$(4),ka,Ba)}KOj(){const z=this.eb.Ga("IsSafeLinksEnabledForUser");
return z?Rd.Rze(z):!1}JOj(){const z=this.eb.XB("SafeLinksDisabledBrowsers");if(ia.a.QS){if(this.eb.Kw("SafeLinksForTeamsIsEnabled")&&this.eb.ka("SafeLinksForTeamsIsEnabled"))return!0;if(Array.contains(z,"Electron"))return!1}else if(Array.contains(z,ia.a.zy))return!1;return"officecomhwa"===(this.eb.Ga(L.AFrameworkApplication.FJ)||"").toLowerCase()?!1:!0}Ccl(){return-1!==window.location.href.indexOf("&wd_slnh=1")||this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SafeLinksUseNavigationHelperForMobile",
!1)&&ia.a.Tae?!0:ia.a.QS}pcl(){let z;z=0;const U=this.Tsb(),ka=U?U.IsSafeLinksEnabled:"";if(""!==ka)return U.WasServiceDown?(e.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),{returnValue:!1,state:2}):"false"===ka.toLowerCase()?(e.ULS.sendTraceTag(51664E3,378,50,"SafeLinks disabled for the user"),{returnValue:!1,state:1}):{returnValue:Rd.Rze(ka),state:z};if(this.Atc)return z=3,e.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),{returnValue:!1,state:z};if(this.E0a>=
this.Hvc||this.F0a>=this.Ivc)return z=2,e.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this.E0a,this.Hvc,this.F0a,this.Ivc),{returnValue:!1,state:z};e.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this.Hvc+this.Ivc-(this.E0a+this.F0a));return{returnValue:!0,state:z}}jeg(){const z=
this.Tsb();return z?z.PolicyCookie:""}Rjj(){const z=this.Tsb();return z?z.WebAffinitizedUrl:""}LZi(){const z=this.Tsb();return z?z.AffinitizedUrl:""}j5i(){const z=new Date;try{const U=this.Tsb();z.setTime(U?U.PolicyCookieTTL:0)}catch(U){e.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",U)}return z}wbe(){const z=this.j5i();return!!z&&z.getTime()<Date.now()}Tsb(){if(!this.yyc){const z=ma.a.instance.getItem(this.userId);if(!z||""===z)return null;this.yyc=
JSON.parse(z)}return this.yyc}wmh(z){if(void 0===z||null===z)throw Error.argumentNull("safeLinksData");if(void 0===z.IsSafeLinksEnabled||null===z.IsSafeLinksEnabled||0>=z.IsSafeLinksEnabled.length)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this.yyc=z;z.WasServiceDown||this.KDl(z)}KDl(z){z=JSON.stringify(z);ma.a.instance.setItem(this.userId,z)}HQd(z){return void 0!==Rd.Vh&&null!==Rd.Vh?Rd.Vh.zi("WebServiceCall",z):null}okd(z){if(void 0!==z&&null!==z){const U=z.Kq;z.stop();return{returnValue:U,
ly:null}}return{returnValue:null,ly:z}}static Rze(z){return"false"!==z.toLowerCase()?!0:!1}}Rd.Vh=null;Rd.eDd=null;Object(h.a)(Rd,"SafeLinksManager",null,[560]);const ye=z=>{switch(z){case 3:return"Word";case 2:return"PowerPoint";case 1:return"Excel";default:return"Unknown"}},oe=z=>{switch(z){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}};var Bb=d(207);class Ff{constructor(){this.K=null}get name(){return"PowerPointSafeLinks"}Wb(z){this.K=z}init(){L.AFrameworkApplication.fa.ff(Object(v.a)(this,
this.Gm,"onFullAppSettingsReady"))}Gm(){const z=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),U=z?z.tg:!1;z.pptSafeLinksIsEnabled&&(this.K.register(Rd,"Common.App.SafeLinks.SafeLinksManager").as("Common.App.SafeLinks.ISafeLinksManager").ma().na(()=>new Rd(L.AFrameworkApplication.fa,L.AFrameworkApplication.Ge,String.format("{0}-{1}",ye(L.AFrameworkApplication.Aa.jb.rm),oe(L.AFrameworkApplication.Aa.jb.rHa)),U)).ma(),this.K.qb("Common.App.SafeLinks.ISafeLinksManager"))}dispose(){}static main(){ua.a.instance.Bc(Bb.a(new Ff,
0))}}Object(h.a)(Ff,"SafeLinksPackage",null,[2,3]);var pg=d(336),xf=d(284),qe=d(1171),Oh=d(85),Cf=d(27),Bg=d(169),Gf=d(90),dh=d(1007);class qg{constructor(z,U,ka,Ba,Ia,Ab){this.fG=z;this._id=U;this.htd=Ba;this.LMh=Ia;this.MMh=Ab;this.qsc=this.crb;void 0!==ka&&null!==ka&&(this.crb=ka)}get defaultValue(){return this.qsc}get lcid(){return this.fG}get id(){return this._id}get crb(){return(this.LMh||qg.T2e)(this.htd)}set crb(z){(this.MMh||qg.U2e)(this.htd,z)}get Uf(){return this.htd}static fr(){qg.T2e=
()=>null;qg.U2e=()=>{}}}qg.T2e=null;qg.U2e=null;Object(h.a)(qg,"GrammarSettingOption",null,[710]);qg.fr();class Pf{constructor(z,U,ka){this.VXd=z;this.aJe=U;this.Vgk=ka}}Object(h.a)(Pf,"TwoLevelCacheKey",null,[]);var qd=d(32),Tf=d(210),Pg=d(2);class Ee extends pb.a{constructor(z,U,ka,Ba){super();this.ACd=this.N6=this.p5e=this.KMb=null;this.Bo=Ba;this.qsd=z;this.ng=Ee.id;this.BTh=()=>{this.KMb=ka?ja.a.Alc(ka):{};this.p5e=ka?ja.a.Alc(ka):{};const Ia=this.Hfi(),Ab=Ee.Oyi(Ia,Ee.chd(Object(v.a)(this,this.Nyi,
"createCritiqueTypeSettingsTracker"))(Ee.psi(Yb=>this.KMb=Yb)));Ab(ka||{});var Ob=Ee.chd(Ee.PDi())(Yb=>Yb.cloneNode(!0));Ee.Pyi(Ia,Ee.lyi(Ee.gCi(U),Ee.Myi(Ob))(ka))(z.toString());this.ACd=this.ghi();Ob=Yb=>{if("click"===Yb.type||Yb.keyCode===Bg.a.lq||Yb.keyCode===Bg.a.YKb)this.KMb[z.toString()]={},Ia.reset(),Ee.tVk(Ab)};Gf.a.addHandler(this.RXa,bc.a.click,Ob);Gf.a.addHandler(this.RXa,bc.a.Xf,Ob)};this.mg=""}get RXa(){return this.ACd}QRj(){var z=Ee.KFe(this.KMb),U=Ee.KFe(this.p5e);if(!z&&!U)return!1;
let ka;try{ka=z?Object(A.a)(Object,z[this.qsd.toString()]):{};var Ba=U?Object(A.a)(Object,U[this.qsd.toString()]):{}}catch(Ob){return e.ULS.sendTraceTag(36489288,375,15,"Parse to dictionary failed"),!1}if(!ka&&!Ba)return!1;ka=ka?ka:{};Ba=Ba?Ba:{};z=String.format("language: {0}",this.qsd.toString());U=!1;for(let Ob in ka){var Ia=Ob,Ab=ka[Ob];Ia in Ba&&Ba[Ia]===Ab||(U=!0,z=String.format("{0}, [{1}, {2}]",z,Ia,Ab))}for(let Ob in Ba)Ba=Ob,Ba in ka||(U=!0,z=String.format("{0}, [{1}, default]",z,Ba));U&&
e.ULS.sendTraceTag(37319685,375,50,"User changed settings: {0}",z);return U}tj(z,U,ka){super.tj(z,U,ka);this.eKk()}XM(z){return z.Ac.id===Ee.Hhh?!1:super.XM(z)}f0k(){this.Bo.il().u7c();this.N6=this.Bo.il().uj.vZ}eKk(){this.Bo.il().scope.np(cd.FocusManager.instance().ypa);this.Bo.il().scope.np(cd.FocusManager.instance().zpa);this.Bo.il().scope.bindAction(cd.FocusManager.instance().ypa,qd.a.t2b);this.Bo.il().scope.bindAction(cd.FocusManager.instance().zpa,qd.a.s2b);this.Bo.il().scope.bindAction(cc.KeyInputManager.Na(Bg.a.V$,
0),qd.a.YPc);this.Bo.il().scope.bindAction(cc.KeyInputManager.Na(Bg.a.Ifa,0),qd.a.XPc);this.Bo.il().scope.bindAction(cc.KeyInputManager.Na(Bg.a.vY,0),qd.a.YPc);this.Bo.il().scope.bindAction(cc.KeyInputManager.Na(Bg.a.P5,0),qd.a.XPc)}get settings(){return Ee.KFe(this.KMb)}Mva(){super.Mva();this.BTh()}Hfi(){const z=Ee.bgi(),U=Ee.lVb("WACDialogRow",z);this.nP.insertBefore(U,this.nP.firstChild);return z}Nyi(z){const U=dh.a.merge(null,z);return ka=>{ka.crb===(z&&z[ka.lcid]?z[ka.lcid][ka.id]:null)||ka.crb!==
ka.defaultValue?Ee.Idg(U,ka.lcid)[ka.id]=ka.crb:delete Ee.Idg(U,ka.lcid)[ka.id];this.N6=this.U5i(ka.Uf);return U}}U5i(z){return z?(z=z.getElementsByTagName(Sys.UI.DomElement.containsCssClass(z,Ee.KTj)?"select":"input"))?z[0]:null:null}dispose(){this.RXa&&(Gf.a.Xdh(this.RXa),this.ACd=null);super.dispose()}ghi(){const z=document.createElement("input");z.id=Ee.Hhh;z.type="reset";z.setAttribute("form",Ee.i7f);z.className="WACButton WACDialogButtonNormal GrammarSettingsDialogResetButton";z.value=CommonUIStrings.l_ResetAll;
const U=Ee.lVb("GrammarSettingsDialogResetButtonContainer",z),ka=document.getElementById("WACDialogButtonPanel");ka.parentNode.insertBefore(U,ka);return z}static get YXb(){return"CritiqueType"}static psi(z){return U=>ka=>z(U(ka))}static chd(z){return U=>ka=>U(z(ka))}static KFe(z){const U={};ja.a.forEach(z,(ka,Ba)=>{0<Tf.a(Ba).length&&(U[ka]=Ba)},null);return U}static bgi(){const z=document.createElement("form");z.id=Ee.i7f;Sys.UI.DomElement.addCssClass(z,"WACDialogList");Sys.UI.DomElement.addCssClass(z,
Ee.jEi);return z}static Oyi(z,U){const ka=Ee.kJk(z,bc.a.change);return Ba=>{const Ia=U(Ba);ka(Ab=>{Ab=Ab.target.parentNode;Sys.UI.DomElement.containsCssClass(Ab,Ee.YXb)&&Ia(Ab[Ee.lJf])})}}static kJk(z,U){let ka=null;return Ba=>{ka&&Gf.a.removeHandler(z,U,ka);Gf.a.addHandler(z,U,Ba);ka=Ba}}static Idg(z,U){return z[U]=z[U]||{}}static tVk(z){e.ULS.sendTraceTag(36489289,375,50,"User click reset all button");z(null)}static gCi(z){let U=null;return ka=>{U=ka;return z.request(Number.parseInvariant(ka)).CWRCo(Ba=>
U===ka?Ba.result:null,Ee.KSd)}}static Pyi(z,U){const ka=Ee.C_i(Ba=>Ee.Bol(Ba.children));return Ba=>{const Ia=ka(Ba,z);z.innerHTML="";(Ia?Pg.Task.Gt(Ia):U(Ba)).continueWith(Ab=>{Ab=Ab.result;for(let Ob=0;Ob<Ab.length;Ob++)z.appendChild(Ab[Ob])},Ee.KSd)}}static lyi(z,U){return ka=>Ba=>z(Ba).CWRCo(Ia=>Va.toArray(Va.select(Va.asEnumerable(Ia.result),Ab=>U(ka,Ab,Ba))),Ee.KSd)}static Bol(z){const U=[];for(let ka=0;ka<z.length;ka++)U.push(z[ka]);return U}static C_i(z){const U={};let ka=null;return(Ba,Ia)=>
{ka&&!U[ka]&&(Ia=z(Ia))&&(U[ka]=Ia);ka=Ba;return U[Ba]}}static PDi(){const z={};return U=>{z[U.VXd]=z[U.VXd]||{};const ka=z[U.VXd];ka[U.aJe]=ka[U.aJe]||U.Vgk();return ka[U.aJe]}}static Myi(z){return(U,ka,Ba)=>{const Ia=z(new Pf(Ba,ka.Id,()=>Ee.Pfi(ka)));Ia.setAttribute("role","group");const Ab=Ee.nOf+ka.Name;Ia.setAttribute("aria-labelledby",Ab);for(const Ob of ka.CritiqueTypeInfoList){const Yb=Ee.kYi(Ba,Ob,U,z);Ia.appendChild(Yb);Yb.setAttribute("aria-labelledby",Ab)}return Ia}}static kYi(z,U,ka,
Ba){Ba=Ba(new Pf(z,U.Id,()=>U.IsBinaryCritiqueType?Ee.Nfi(U):Ee.Rgi(U)));z=new qg(z,U.Id,ka&&ka[z]?ka[z][U.Id]:null,Ba,U.IsBinaryCritiqueType?Ia=>Ia.children[0].checked:Ia=>Ia.children[1].selectedIndex,U.IsBinaryCritiqueType?(Ia,Ab)=>{Ia.children[0].checked=Ab}:(Ia,Ab)=>{Ia.children[1].selectedIndex=Ab});Ba[Ee.lJf]=z;return Ba}static Pfi(z){z=Ee.Qfi(z.Name);z.className="WACWritingStylesDialogCategoryTitle";return Ee.lVb("CritiqueCategory",z)}static Nfi(z){const U=Ee.Rfi();U.id=z.Id;0<z.DefaultCritiqueValue&&
U.setAttribute("checked","checked");z=Ee.bLf(z.Name,z.Id);z.className="WACDialogLabel";const ka=Ee.lVb(Ee.YXb,U,z);ka.appendChild(U);ka.appendChild(z);return ka}static Rgi(z){z=Ee.Egi(z.Id,z.Name,Ee.Wgi(z.CritiqueTypeValues,z.DefaultCritiqueValue),z.DefaultCritiqueValue);Sys.UI.DomElement.addCssClass(z,Ee.YXb);return z}static Wgi(z,U){return Va.toArray(Va.Si(Va.asEnumerable(z||[]),(ka,Ba)=>{ka=Ee.Vgi(ka,Ba.toString());Ba===U&&ka.setAttribute("selected","selected");return ka}))}static Egi(z,U,ka,Ba){U=
Ee.bLf(U,z);const Ia=document.createElement("select");Ia.id=z;Ia.className="WACDialogList";ka=ka||[];for(z=0;z<ka.length;z++)Ia.appendChild(ka[z]),Ba===z&&(ka[z].selected=!0);return Ee.lVb("GrammarSettingsDialogLabeledInlineList",U,Ia)}static Vgi(z,U){const ka=document.createElement("option");ka.text=z;ka.value=U;return ka}static Rfi(){const z=document.createElement("input");z.type="checkbox";z.className="WACDialogCheckBox";return z}static bLf(z,U){const ka=document.createElement("label");ka.innerText=
z;ka.setAttribute("for",U);return ka}static Qfi(z){const U=document.createElement("div");U.innerText=z;U.id=Ee.nOf+z;return U}static lVb(z=null,...U){const ka=document.createElement("div");ka.className=z;for(const Ba of U)ka.appendChild(Ba);return ka}}Ee.id="GrammarSettingsDialog";Ee.i7f="CritiqueTypeSettings";Ee.jEi="CritiquesList";Ee.KTj="GrammarSettingsDialogLabeledInlineList";Ee.Hhh="ResetButton";Ee.nOf="WritingStylesCategory_";Ee.KSd=11;Ee.lJf="CritiqueType";Object(h.a)(Ee,"GrammarSettingsDialog",
pb.a,[]);var xe=d(141),jh=d(346),yg=d(1198),xc=d(39),me=d(339),Dd=d(58),Qe=d(153),tf=d(47),Rb=d(874),Jc=d(26),Qc=d(28);class Ph{constructor(){this.Color=null;this.Transparency=this.Scale=this.EffectDataPropType=this.Degree=0}}Object(h.a)(Ph,"EffectDataInfo",null,[]);var ng=d(837);class se{constructor(){this.EffectType=this.EffectId=0;this.FRemoveExisting=!1;this.ShapeIds=null}}Object(h.a)(se,"AddAnimationInfo",null,[]);class pf{constructor(){this.TargetEffects=null}}Object(h.a)(pf,"DeleteAnimationInfo",
null,[]);class $d{constructor(){this.EffectNodeId=0;this.ShapeId=null}}Object(h.a)($d,"TargetEffect",null,[]);class Ye{constructor(){this.EffectType=this.EffectId=0;this.IsReplaceShapeAnimations=!1;this.TargetEffects=null}}Object(h.a)(Ye,"ReplaceAnimationInfo",null,[]);class Kd{constructor(){this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.ModifyAnimPropType=0;this.TargetEffects=null}}Object(h.a)(Kd,"ModifyAnimationInfo",null,[]);class Yd{constructor(){this.StartType=0;this.TargetEffects=
null}}Object(h.a)(Yd,"ChangeAnimationRelationshipInfo",null,[]);var Zf=d(342),ef=d(149),Ke=d(88);class gi{constructor(){this.BuildType=0;this.TargetEffects=null}}Object(h.a)(gi,"ChangeAnimationBuildTypeInfo",null,[]);class Rf{constructor(){this.IsLater=!1;this.TargetEffects=this.RefEffect=null}}Object(h.a)(Rf,"ReorderAnimationEffectsInfo",null,[]);var Uf;(function(z){z[z.Degree=0]="Degree";z[z.Color=1]="Color";z[z.Transparency=2]="Transparency";z[z.Scale=3]="Scale"})(Uf||(Uf={}));Object(h.b)("EffectDataPropType",
Uf);var Ed;(function(z){z[z.Delay=0]="Delay";z[z.Duration=1]="Duration";z[z.Direction=2]="Direction";z[z.EffectData=3]="EffectData"})(Ed||(Ed={}));Object(h.b)("ModifyAnimationPropertyType",Ed);var vg;(function(z){z[z.OnClick=0]="OnClick";z[z.WithPrevious=1]="WithPrevious";z[z.AfterPrevious=2]="AfterPrevious";z[z.Invalid=3]="Invalid"})(vg||(vg={}));Object(h.b)("AnimationStartType",vg);var Jd;(function(z){z[z.Default=0]="Default";z[z.AsOneObject=1]="AsOneObject";z[z.AllAtOnce=2]="AllAtOnce";z[z.ByParagraph=
3]="ByParagraph";z[z.OnyByOne=4]="OnyByOne"})(Jd||(Jd={}));Object(h.b)("AnimationBuildType",Jd);class Ie{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc){this.s5="Existing";this.vJa="ExistingInMenu";this.qPe="AnimationExisting";this.rPe="AnimationExistingInMenu";this.rzb=!1;this.uEb=(mc,Ec,Yc,jd,vd)=>{mc=this.QD.bE;Ec=this.ra.rn();if(!Ec||!mc||!mc.length)return 8;if(1===Yc)return 32;Yc=this.Uia(mc,Ec);vd.MenuItems=this.Jfi(mc,Ec,Yc);return 32};this.Zeb=(mc,Ec,Yc,jd,vd)=>{mc=vd.queryResult;vd=vd.SourceControlId;
jd=Ec=-1;vd!==this.s5&&({effectType:jd,effectId:Ec}=this.yk.gNc(vd));var he=this.QD.bE;if(!this.ra.rn())return 8;if(1!==Yc)return 32;Yc=this.yk.hNc(vd);var nd=Yc.label;if(vd===this.s5||vd===this.vJa)nd=ResourceStrings.L_ExistingButtonDescription;this.E6a(vd,Yc.image,Yc.label,mc,nd);let ee=nd=!1;const Ue=0==he.length?0:he[0].EffectId,n=0==he.length?0:he[0].EffectType,Y=!this.yk.Rvb(he);he=this.yk.O4b(he);Y||he||(nd=Ec===Ue&&jd===n,ee=this.yk.JTc(n,Ue));vd===this.s5?(ee=this.REk(this.s5,mc,he,ee,Y,
Yc.image,n,Ue),mc.pU(Y||he||ee)):vd===this.vJa?(ee=Ie.PEk(mc,he,Y,ee),mc.pU(Y||he||ee)):mc.pU(nd);return 32};this.nB=(mc,Ec,Yc,jd,vd)=>{Ec=this.QD.bE;var he=this.ra.rn();let nd=!0;jd=this.getSelectedShapes();if(!jd||!jd.length)if(nd=!1,jd=this.Uia(Ec,he),!jd||!jd.length)return Jc.a.J(509677843,800,10,"AnimationActor::setAnimation: selected shapes info is null"),8;if(!Ie.ePj(he,jd)||this.mEa(jd))return 8;if(1===Yc)return he=0<Ec.length&&!this.yk.Rvb(Ec),Yc=Ie.cPj(jd),he&&Yc?8:mc===Qc.a.Pkc||mc===Qc.a.zgb?
(jd=0<Ec.length&&this.yk.O4b(Ec),Yc=!1,he||jd||(Yc=this.yk.JTc(0<Ec.length?Ec[0].EffectType:-1,0<Ec.length?Ec[0].EffectId:-1)),mc===Qc.a.zgb&&(Yc=he?!0:!1),he||jd||Yc?32:16):mc===Qc.a.bHb?Ie.dPj(jd)?32:16:32;mc=vd.SourceControlId;if(!mc)return 8;if(mc===this.s5||mc===this.vJa||mc===this.qPe||mc===this.rPe)return 32;mc=this.yk.gNc(mc);(mc=Ie.i_i(jd,mc.effectId,mc.effectType,nd,Ec))&&this.ZBa(he,mc);return 32};this.LVg=(mc,Ec,Yc)=>{Ec=this.QD.bE;const jd=this.ra.rn();if(!jd||!Ec||!Ec.length)return 8;
var vd=this.Uia(Ec,jd);if(!vd||!vd.length)return Jc.a.J(509670021,800,10,"AnimationActor::moveAnimationHandler: selected shapes info is null"),8;if(this.mEa(vd))return 8;switch(mc){case Qc.a.KVg:mc=!1;break;case Qc.a.MVg:mc=!0;break;default:return 8}vd=this.yk.Z9i(jd,Ec,mc);if(1===Yc)return vd.isEnabled?32:8;if(!vd.aed)return Jc.a.J(509670020,800,10,"AnimationActor::moveAnimationHandler: move animation info ref target is null"),8;Yc=new ng.a;Yc.AnimationAction=6;let he=new Rf;he.TargetEffects=Ie.nsa(Ec);
he.IsLater=mc;he.RefEffect=vd.aed;Yc.ReorderAnimationEffectsInfo=he;this.ZBa(jd,Yc);return 32};this.wgb=(mc,Ec,Yc,jd,vd)=>{Ec=this.QD.bE;mc=this.ra.rn();if(!mc||!Ec||!Ec.length)return 8;jd=this.Uia(Ec,mc);if(!jd||!jd.length)return Jc.a.J(509677842,800,10,"AnimationActor::setAnimationColor: selected shapes info is null"),8;if(this.mEa(jd))return 8;if(1===Yc)return 32;Yc=ef.Box4ColorHelper.sY(vd);if(!Yc)return Jc.a.J(509677841,800,10,"AnimationActor::setAnimationColor:  solid is null"),8;Yc=ef.Box4ColorHelper.Rfb(Yc,
mc.Pe);if(!Yc)return Jc.a.J(509677840,800,10,"AnimationActor::setAnimationColor:  color is null"),8;vd=new ng.a;vd.AnimationAction=1;jd=new Kd;jd.TargetEffects=Ie.nsa(Ec);jd.ModifyAnimPropType=Ed.EffectData;Ec=new Ph;Ec.Color=[Yc.r,Yc.g,Yc.b];Ec.EffectDataPropType=Uf.Color;jd.EffectData=Ec;vd.ModifyAnimationInfo=jd;this.ZBa(mc,vd);return 32};this.$Ce=()=>{const mc=this.QD.bE;var Ec=this.ra.rn();if(!Ec||!mc||!mc.length)return 8;Ec=this.Uia(mc,Ec);return Ec&&Ec.length?this.yk.Oki(Ec,this.Ea,mc)?32:
16:(Jc.a.J(509677839,800,10,"AnimationActor::queryEffectOptions: selected shapes info is null"),8)};this.xgb=(mc,Ec,Yc,jd,vd)=>{mc=this.QD.bE;Ec=this.ra.rn();if(!Ec||!mc||!mc.length)return 8;jd=this.Uia(mc,Ec);if(!jd||!jd.length)return Jc.a.J(509677838,800,10,"AnimationActor::setAnimationDirection: selected shapes info is null"),8;if(this.mEa(jd))return 8;if(1===Yc)return 32;Yc=this.yk.H0b(vd.MenuItemId);vd=new ng.a;vd.AnimationAction=1;jd=new Kd;jd.TargetEffects=Ie.nsa(mc);jd.ModifyAnimPropType=
Ed.Direction;jd.Direction=Yc;vd.ModifyAnimationInfo=jd;this.ZBa(Ec,vd);return 32};this.Veb=(mc,Ec,Yc,jd,vd)=>{mc=this.QD.bE;if(!this.ra.rn()||!mc||!mc.length)return 8;Ec=vd.queryResult;vd=this.yk.H0b(vd.MenuItemId);Ie.kEj(mc)&&Ec.Nf(mc[0].Direction===vd);return 32};this.SIa=(mc,Ec,Yc,jd,vd)=>{mc=this.QD.bE;Ec=this.ra.rn();if(!Ec||!mc||!mc.length)return 8;jd=this.Uia(mc,Ec);if(!jd||!jd.length)return Jc.a.J(509677652,800,10,"AnimationActor::setAnimationSequence: selected shapes info is null"),8;if(this.mEa(jd))return 8;
if(1===Yc)return 32;Yc=vd.MenuItemId;vd=new ng.a;vd.AnimationAction=5;jd=new gi;jd.TargetEffects=Ie.nsa(mc);jd.BuildType=Ie.h0i(Yc);vd.ChangeAnimationBuildTypeInfo=jd;this.ZBa(Ec,vd);return 32};this.$eb=(mc,Ec,Yc,jd,vd)=>{mc=this.QD.bE;if(!this.ra.rn()||!mc||!mc.length)return 8;Ec=vd.queryResult;vd=this.yk.R2d(vd.MenuItemId);Ie.iEj(mc)&&Ec.Nf(mc[0].BuildType===vd);return 32};this.ygb=(mc,Ec,Yc,jd,vd)=>{Ec=this.QD.bE;mc=this.ra.rn();if(!mc||!Ec||!Ec.length)return 8;jd=this.Uia(Ec,mc);if(!jd||!jd.length)return Jc.a.J(509677837,
800,10,"AnimationActor::setAnimationEffectData: selected shapes info is null"),8;if(this.mEa(jd))return 8;if(1===Yc)return 32;jd=vd.MenuItemId;Yc=new ng.a;Yc.AnimationAction=1;vd=new Kd;vd.TargetEffects=Ie.nsa(Ec);vd.ModifyAnimPropType=Ed.EffectData;Ec=this.D4i(jd);if(!Ec)return Jc.a.J(509703439,800,15,"AnimationActor::setAnimationEffectData:  effect data info is null"),16;vd.EffectData=Ec;Yc.ModifyAnimationInfo=vd;this.ZBa(mc,Yc);return 32};this.Yeb=(mc,Ec,Yc,jd,vd)=>{mc=this.QD.bE;if(!this.ra.rn()||
!mc||!mc.length)return 8;vd.queryResult.Nf(this.yk.JRf(Ie.E4i(mc[0].EffectData),vd.MenuItemId));return 32};this.y2k=(mc,Ec,Yc,jd,vd)=>{Ec=this.QD.bE;mc=this.ra.rn();if(!mc||!Ec||!Ec.length)return 8;jd=this.Uia(Ec,mc);if(!jd||!jd.length)return Jc.a.J(509677836,800,10,"AnimationActor::setAnimationStartHandler: selected shape info is null"),8;if(this.mEa(jd))return 8;if(1===Yc)return 32;jd=vd.CommandValueId;if(!jd||!jd.trim().length)return Jc.a.J(509703438,800,10,"AnimationActor::setAnimationStartHandler:  startoption value is null or empty"),
16;Yc=new ng.a;Yc.AnimationAction=4;vd=new Yd;vd.TargetEffects=Ie.nsa(Ec);Ec=Ie.fgj(jd);if(Ec==vg.Invalid)return Jc.a.J(509703437,800,15,"AnimationActor::setAnimationStartHandler:  startoption value is invalid"),16;vd.StartType=Ec;Yc.ChangeAnimationRelationshipInfo=vd;this.ZBa(mc,Yc);return 32};this.mcd=(mc,Ec,Yc,jd,vd)=>{mc=this.QD.bE;if(!this.ra.rn()||!mc||!mc.length)return this.nKe(vd,""),32;Ec=mc[0].StartType;Yc=!0;for(const he of mc)if(Ec!=he.StartType){Yc=!1;break}Yc?this.nKe(vd,vg[Ec].toString()):
this.nKe(vd,"");return 32};this.x2k=(mc,Ec,Yc,jd,vd)=>{mc=this.ra.rn();Ec=this.QD.bE;if(!mc||!Ec||!Ec.length)return 8;jd=this.Uia(Ec,mc);if(!jd||!jd.length)return Jc.a.J(509677835,800,10,"AnimationActor::setAnimationDurationHandler: selected shape info is null"),8;if(this.mEa(jd))return 8;const he=!this.yk.Rvb(Ec);if(Ie.$yg(jd)&&he)return 8;if(1===Yc)return 32;(Yc=Math.floor(1E3*vd.Number))||(Yc=10);vd=new ng.a;vd.AnimationAction=1;jd=new Kd;jd.TargetEffects=Ie.nsa(Ec);jd.ModifyAnimPropType=Ed.Duration;
jd.Duration=Yc;vd.ModifyAnimationInfo=jd;this.ZBa(mc,vd);return 32};this.Xeb=(mc,Ec,Yc,jd,vd)=>{mc=this.QD.bE;if(!this.ra.rn()||!mc||!mc.length)return this.cHb(vd,"0.00"),32;Ec=mc[0].Duration;Yc=!0;for(const he of mc)if(Ec!=he.Duration){Yc=!1;break}Yc?this.cHb(vd,Number(Ec/1E3).toFixed(2)):this.cHb(vd,"0.01");return 32};this.vrj=(mc,Ec,Yc)=>1==Yc?32:Qe.b("AnimationPaneActor::ShowHideAnimationPane PaneOpen:",this.rzb.toString(),mc,()=>{(this.rzb=!this.rzb)?this.Ocl():this.ruj();return 32});this.lcd=
(mc,Ec,Yc,jd,vd)=>{vd&&vd.Nf(this.rzb);return 32};this.Ocl=()=>{const mc=this.YB(),Ec={title:ResourceStrings.L_AnimationGalleryGroup,hideHeader:!1,width:mc.kuk,location:2,contentProps:mc,onOpen:()=>{},onClose:()=>{this.rzb=!1},isModernPane:!0};xe.UISurfaces.Ms().then(Yc=>{Yc.showTaskPane(tf.a.F3a,Ec);return null}).catch(Yc=>{Jc.a.J(512500804,833,10,"AnimationActor::showAnimationPane exception: {0}",Yc.toString())})};this.YB=()=>({type:"AnimationPaneProps",kuk:Rb.a,GFl:!0,IFl:!0,KFl:!0});this.ruj=
()=>{xe.UISurfaces.Ms().then(mc=>{mc.hideTaskPane(tf.a.F3a,2);return null}).catch(mc=>{Jc.a.J(512500803,833,10,"AnimationActor::hideAnimationPane exception: {0}",mc.toString())})};this.w2k=(mc,Ec,Yc,jd,vd)=>{mc=this.QD.bE;Ec=this.ra.rn();if(!Ec||!mc||!mc.length)return 8;jd=this.Uia(mc,Ec);if(!jd||!jd.length)return Jc.a.J(509677834,800,10,"AnimationActor::setAnimationDelayHandler: selected shapes info is null"),8;if(this.mEa(jd))return 8;const he=!this.yk.Rvb(mc);if(Ie.$yg(jd)&&he)return 8;if(1===
Yc)return 32;Yc=Math.floor(1E3*vd.Number);vd=new ng.a;vd.AnimationAction=1;jd=new Kd;jd.TargetEffects=Ie.nsa(mc);jd.ModifyAnimPropType=Ed.Delay;jd.Delay=Yc;vd.ModifyAnimationInfo=jd;this.ZBa(Ec,vd);return 32};this.Ueb=(mc,Ec,Yc,jd,vd)=>{mc=this.QD.bE;if(!this.ra.rn()||!mc||!mc.length)return this.cHb(vd,"0.00"),32;Ec=mc[0].Delay;Yc=!0;for(const he of mc)if(Ec!=he.Delay){Yc=!1;break}Yc?this.cHb(vd,Number(Ec/1E3).toFixed(2)):this.cHb(vd,"0.00");return 32};this.Jfi=(mc,Ec,Yc)=>{var jd;const vd=new jh.a;
vd.Id="AnimationMenuEffectOptions";vd.UpdateDynamically=!0;vd.Title=ResourceStrings.L_EffectOptions;vd.MenuSectionList=[];if(!this.yk.O4b(mc)){vd.MenuSectionList.push(this.yk.HOc(mc[0].EffectId,mc[0].EffectType,"Direction","2289594085","3782857737"));if(this.yk.Uce(mc[0]))if(vd.MenuSectionList.push(me.f(Ec.Pe,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),vd.MenuSectionList.push(me.d("Standard Colors","Color.Menu.Controls","standardColor",
"AnimationEffectOptionsStandardColorPicker","679168237",!1)),this.jEj(mc)){const he=null===(jd=mc[0].EffectData)||void 0===jd?void 0:jd.Color;jd=new Ke.a(Ke.a.Aih(he));me.h(vd,jd,Ec.Pe)}else me.h(vd,null,Ec.Pe);vd.MenuSectionList.push(this.yk.HOc(mc[0].EffectId,mc[0].EffectType,"EffectData","2949363495","4132852551"))}vd.MenuSectionList.push(this.yk.mcj(Yc,this.Ea,mc));return vd};this.D4i=mc=>{let Ec=new Ph;const Yc=this.yk.K_d(mc);return mc.toLowerCase().startsWith("spin")?(Ec.Degree=parseFloat(Yc),
Ec.EffectDataPropType=Uf.Degree,Ec):mc.toLowerCase().startsWith("transparency")?(Ec.Transparency=parseFloat(Yc),Ec.EffectDataPropType=Uf.Transparency,Ec):mc.toLowerCase().startsWith("growshrink")?(Ec.Scale=parseFloat(Yc),Ec.EffectDataPropType=Uf.Scale,Ec):null};this.REk=(mc,Ec,Yc,jd,vd,he,nd,ee)=>{if(vd)return!1;if(Yc)return this.E6a(mc,he,ResourceStrings.L_AnimationMultiple,Ec,ResourceStrings.L_AnimationMultiple),jd;jd&&(he=this.yk.fPc(nd,ee),{image:he,label:Yc}=this.yk.hNc(he),this.E6a(mc,he,Yc,
Ec,Yc));return jd};this.E6a=(mc,Ec,Yc,jd,vd)=>{let he;he=mc===this.s5?"298832323":mc===this.vJa?"1264919631":"2676673376";Ec=Ec.substring((Dd.a.fgc+"_").length,Ec.length-6);const nd=new yg.a;nd.Id=mc;nd.ExternalId="Animation"+mc;nd.Icon=Ec;nd.Command=he;nd.QueryCommand="1852964326";nd.LabelText=Yc;nd.FullIconStyle={root:{width:"32px",height:"32px"}};nd.PreviewIconStyle={root:{width:"24px",height:"24px"}};nd.Alt=vd;jd.J2=nd};this.getSelectedShapes=()=>{let mc=[];const Ec=this.ra.Yd();if(!Ec)return mc;
for(const Yc of Ec)Yc.get_smartArtModelId()?mc.push(this.Ea.nr(Yc)):Yc.Og?mc.push(this.Ea.ds(Yc)):mc.push(Yc);return mc};this.Uia=(mc,Ec)=>{const Yc=[];if(!mc||!mc.length||!Ec)return Yc;const jd=Ec.jl();if(!jd||!jd.length)return Yc;Ec=new Map;for(const vd of jd)Ec.set(vd.id.toString(),vd);for(const vd of mc){mc=Zf.a.Mf(vd.ShapeId);mc=Ec.get(mc.toString());if(!mc)return[];Yc.push(mc)}return Yc};this.ZBa=(mc,Ec)=>{const Yc=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{Yc.kc(mc),mc.fqa=Ec}finally{Yc&&
Yc.dispose()}};this.mEa=mc=>{if(!mc||0==mc.length)return!1;for(const Ec of mc)if(this.Xb.Zc(Ec))return!0;return!1};this.nKe=(mc,Ec)=>{mc.qZ=Ec;mc.Qkc()};this.cHb=(mc,Ec)=>{mc.queryResult.C$=Ec};if(!z)throw Error.argumentNull("actionManager");if(!U)throw Error.argumentNull("selectionManager");if(!ka)throw Error.argumentNull("focusManager");if(!Ba)throw Error.argumentNull("transactionFactory");if(!Ia)throw Error.argumentNull("animationHelper");if(!Ab)throw Error.argumentNull("graphActionBlockingManager");
if(!Ob)throw Error.argumentNull("shapeReader");if(!Yb)throw Error.argumentNull("pathManager");if(!uc)throw Error.argumentNull("effectSelectionManager");this.ia=z;this.ra=U;this.Fa=ka;this.Fb=Ba;this.abc=Yb.hk(Dd.a.Kad);this.yk=Ia;this.Xb=Ab;this.Ea=Ob;this.QD=uc}ub(){this.ia.pa(Qc.a.HGf,xc.a.application,this.y2k,4);this.ia.pa(Qc.a.mcd,xc.a.application,this.mcd,97);this.ia.pa(Qc.a.pmh,xc.a.application,this.x2k,4);this.ia.pa(Qc.a.Xeb,xc.a.application,this.Xeb,97);this.ia.pa(Qc.a.Udl,xc.a.application,
this.vrj,4);this.ia.pa(Qc.a.lcd,xc.a.application,this.lcd,96);this.ia.pa(Qc.a.omh,xc.a.application,this.w2k,4);this.ia.pa(Qc.a.Ueb,xc.a.application,this.Ueb,97);this.ia.pa(Qc.a.Zeb,xc.a.application,this.Zeb,97);this.ia.pa(Qc.a.nB,xc.a.application,this.nB,5);this.ia.pa(Qc.a.bHb,xc.a.application,this.nB,5);this.ia.pa(Qc.a.Pkc,xc.a.application,this.nB,5);this.ia.pa(Qc.a.zgb,xc.a.application,this.nB,5);this.ia.pa(Qc.a.o$g,xc.a.application,this.$Ce,100);this.ia.pa(Qc.a.xgb,xc.a.application,this.xgb,5);
this.ia.pa(Qc.a.Veb,xc.a.application,this.Veb,97);this.ia.pa(Qc.a.ygb,xc.a.application,this.ygb,4);this.ia.pa(Qc.a.Yeb,xc.a.application,this.Yeb,96);this.ia.pa(Qc.a.jKe,xc.a.application,this.SIa,5);this.ia.pa(Qc.a.kKe,xc.a.application,this.SIa,5);this.ia.pa(Qc.a.lKe,xc.a.application,this.SIa,5);this.ia.pa(Qc.a.mKe,xc.a.application,this.SIa,5);this.ia.pa(Qc.a.$eb,xc.a.application,this.$eb,97);this.ia.pa(Qc.a.uEb,xc.a.application,this.uEb,96);this.ia.pa(Qc.a.wgb,xc.a.application,this.wgb,4);this.ia.pa(Qc.a.KVg,
xc.a.application,this.LVg,4);this.ia.pa(Qc.a.MVg,xc.a.application,this.LVg,4)}xe(){}jEj(z){var U;if(!(z&&z.length&&!this.yk.O4b(z)&&this.yk.Uce(z[0])&&z[0].EffectData&&z[0].EffectData.Color))return!1;const ka=null===(U=z[0].EffectData)||void 0===U?void 0:U.Color;for(const Ba of z){if(!Ba.EffectData||!Ba.EffectData.Color)return!1;z=Ba.EffectData.Color;if(z[0]!=ka[0]||z[1]!=ka[1]||z[2]!=ka[2])return!1}return!0}}Ie.h0i=z=>{switch(z){case "AsOneObject":return Jd.AsOneObject;case "AllAtOnce":return Jd.AllAtOnce;
case "ByParagraph":return Jd.ByParagraph;case "OneByOne":return Jd.OnyByOne;default:return Jd.Default}};Ie.i_i=(z,U,ka,Ba,Ia)=>0==U&&0==ka?Ie.M3i(Ia):Ba?Ie.yZi(z,U,ka):Ie.Lcj(Ia,U,ka);Ie.Lcj=(z,U,ka)=>{let Ba=new ng.a;Ba.AnimationAction=2;let Ia=new Ye;if(!z||!z.length)return Jc.a.J(509703434,800,15,"AnimationActor::getReplaceAnimationCommandInfo:  animation info is null or empty"),null;Ia.TargetEffects=Ie.nsa(z);Ia.EffectId=U;Ia.EffectType=ka;Ba.ReplaceAnimationInfo=Ia;return Ba};Ie.M3i=z=>{let U=
new ng.a;U.AnimationAction=3;let ka=new pf;if(!z||!z.length)return Jc.a.J(509703433,800,15,"AnimationActor::getDeleteAnimationCommandInfo:  animation info is null or empty"),null;ka.TargetEffects=Ie.nsa(z);U.DeleteAnimationInfo=ka;return U};Ie.yZi=(z,U,ka)=>{let Ba=new ng.a;Ba.AnimationAction=0;let Ia=new se;Ia.EffectId=U;Ia.EffectType=ka;Ia.ShapeIds=[];Ia.FRemoveExisting=!0;for(const Ab of z)Ia.ShapeIds.push(Ab.id.toString());Ba.AddAnimationInfo=Ia;return Ba};Ie.fgj=z=>{switch(z.toLocaleLowerCase()){case "on click":return vg.OnClick;
case "with previous":return vg.WithPrevious;case "after previous":return vg.AfterPrevious}return vg.Invalid};Ie.nsa=z=>{if(!z||!z.length)return null;const U=[];for(const ka of z)z=new $d,z.EffectNodeId=ka.EffectNodeId,z.ShapeId=ka.ShapeId,U.push(z);return U};Ie.cPj=z=>{if(!z||0==z.length)return!1;for(const U of z)if(U.d3)return!0;return!1};Ie.$yg=z=>{if(!z||0==z.length)return!1;for(const U of z)if(1===U.mediaType||2===U.mediaType)return!0;return!1};Ie.ePj=(z,U)=>{if(!z||!U||!U.length)return!1;for(const ka of U)if(ka.hW||
ka.Uq||ka.Tp)return!1;return!0};Ie.dPj=z=>{if(!z||!z.length)return!1;for(const U of z)if(U.qd||U.Wq||U.Tp)return!1;return!0};Ie.kEj=z=>{if(!z||!z.length)return!1;const U=z[0].Direction;for(let ka=1;ka<z.length;ka++)if(z[ka].Direction!=U)return!1;return!0};Ie.iEj=z=>{if(!z||!z.length)return!1;const U=z[0].BuildType;for(let ka=1;ka<z.length;ka++)if(z[ka].BuildType!=U)return!1;return!0};Ie.E4i=z=>{if(!z)return"";switch(z.EffectDataPropType){case Uf.Degree:return z.Degree.toString();case Uf.Scale:return z.Scale.toString();
case Uf.Transparency:return z.Transparency.toString()}return""};Ie.PEk=(z,U,ka,Ba)=>{ka?(z.C6a=ResourceStrings.L_AnimationExisting,Ba&&(Ba=!1)):U&&(z.C6a=ResourceStrings.L_AnimationMultiple);return Ba};Object(h.a)(Ie,"AnimationActor",null,[229]);class gf{constructor(){this.BuildId=0;this.BuildIds=null;this.Duration=this.Direction=this.Delay=0;this.EffectData=null;this.EffectType=this.EffectId=0;this.HasTrigger=this.HasMultiple=this.HasExisting=!1;this.Id=null;this.IsTrigger=this.IsTextRangeType=!1;
this.ParaRangeStart=this.ParaRangeEnd=0;this.RenderAnimationImage=!1;this.StartType=this.SequenceIndex=this.SequenceId=0}}Object(h.a)(gf,"EditAnimationInfo",null,[]);var eh;(function(z){z[z.invalid=0]="invalid";z[z.basicBlockList=1]="basicBlockList";z[z.alternatingHexagons=2]="alternatingHexagons";z[z.pictureCaptionList=3]="pictureCaptionList";z[z.linedList=4]="linedList";z[z.verticalBulletList=5]="verticalBulletList";z[z.verticalBoxList=6]="verticalBoxList";z[z.verticalBracketList=7]="verticalBracketList";
z[z.varyingWidthList=8]="varyingWidthList";z[z.tabList=9]="tabList";z[z.horizontalBulletList=10]="horizontalBulletList";z[z.squareAccentList=11]="squareAccentList";z[z.pictureAccentList=12]="pictureAccentList";z[z.bendingPictureAccentList=13]="bendingPictureAccentList";z[z.stackedList=14]="stackedList";z[z.increasingCircleProcess=15]="increasingCircleProcess";z[z.pieProcess=16]="pieProcess";z[z.detailedProcess=17]="detailedProcess";z[z.groupedList=18]="groupedList";z[z.horizontalPictureList=19]="horizontalPictureList";
z[z.continuousPictureList=20]="continuousPictureList";z[z.pictureStrips=21]="pictureStrips";z[z.verticalPictureList=22]="verticalPictureList";z[z.alternatingPictureBlocks=23]="alternatingPictureBlocks";z[z.verticalPictureAccentList=24]="verticalPictureAccentList";z[z.titledPictureAccentList=25]="titledPictureAccentList";z[z.verticalBlockList=26]="verticalBlockList";z[z.verticalChevronList=27]="verticalChevronList";z[z.verticalAccentList=28]="verticalAccentList";z[z.verticalArrowList=29]="verticalArrowList";
z[z.trapezoidList=30]="trapezoidList";z[z.descendingBlockList=31]="descendingBlockList";z[z.tableList=32]="tableList";z[z.segmentedProcess=33]="segmentedProcess";z[z.verticalCurvedList=34]="verticalCurvedList";z[z.pyramidList=35]="pyramidList";z[z.targetList=36]="targetList";z[z.hierarchyList=37]="hierarchyList";z[z.verticalCircleList=38]="verticalCircleList";z[z.tableHierarchy=39]="tableHierarchy";z[z.architectureLayout=40]="architectureLayout";z[z.basicProcess=41]="basicProcess";z[z.stepUpProcess=
42]="stepUpProcess";z[z.stepDownProcess=43]="stepDownProcess";z[z.accentProcess=44]="accentProcess";z[z.pictureAccentProcess=45]="pictureAccentProcess";z[z.alternatingFlow=46]="alternatingFlow";z[z.continuousBlockProcess=47]="continuousBlockProcess";z[z.increasingArrowsProcess=48]="increasingArrowsProcess";z[z.interconnectedBlockProcess=49]="interconnectedBlockProcess";z[z.continuousArrowProcess=50]="continuousArrowProcess";z[z.convergingText=51]="convergingText";z[z.processArrows=52]="processArrows";
z[z.circleAccentTimeline=53]="circleAccentTimeline";z[z.basicTimeline=54]="basicTimeline";z[z.circleProcess=55]="circleProcess";z[z.basicChevronProcess=56]="basicChevronProcess";z[z.chevronAccentProcess=57]="chevronAccentProcess";z[z.closedChevronProcess=58]="closedChevronProcess";z[z.chevronList=59]="chevronList";z[z.subStepProcess=60]="subStepProcess";z[z.phasedProcess=61]="phasedProcess";z[z.randomtoResultProcess=62]="randomtoResultProcess";z[z.verticalProcess=63]="verticalProcess";z[z.staggeredProcess=
64]="staggeredProcess";z[z.processList=65]="processList";z[z.circleArrowProcess=66]="circleArrowProcess";z[z.basicBendingProcess=67]="basicBendingProcess";z[z.repeatingBendingProcess=68]="repeatingBendingProcess";z[z.verticalBendingProcess=69]="verticalBendingProcess";z[z.ascendingPictureAccentProcess=70]="ascendingPictureAccentProcess";z[z.upwardArrow=71]="upwardArrow";z[z.descendingProcess=72]="descendingProcess";z[z.circularBendingProcess=73]="circularBendingProcess";z[z.equation=74]="equation";
z[z.verticalEquation=75]="verticalEquation";z[z.funnel=76]="funnel";z[z.gear=77]="gear";z[z.arrowRibbon=78]="arrowRibbon";z[z.opposingArrows=79]="opposingArrows";z[z.convergingArrows=80]="convergingArrows";z[z.divergingArrows=81]="divergingArrows";z[z.basicCycle=82]="basicCycle";z[z.textCycle=83]="textCycle";z[z.blockCycle=84]="blockCycle";z[z.nondirectionalCycle=85]="nondirectionalCycle";z[z.continuousCycle=86]="continuousCycle";z[z.multidirectionalCycle=87]="multidirectionalCycle";z[z.segmentedCycle=
88]="segmentedCycle";z[z.basicPie=89]="basicPie";z[z.hexagonRadial=90]="hexagonRadial";z[z.radialCycle=91]="radialCycle";z[z.basicRadial=92]="basicRadial";z[z.divergingRadial=93]="divergingRadial";z[z.radialVenn=94]="radialVenn";z[z.cycleMatrix=95]="cycleMatrix";z[z.radialCluster=96]="radialCluster";z[z.organizationChart=97]="organizationChart";z[z.pictureOrganizationChart=98]="pictureOrganizationChart";z[z.nameandTitleOrganizationChart=99]="nameandTitleOrganizationChart";z[z.halfCircleOrganizationChart=
100]="halfCircleOrganizationChart";z[z.circlePictureHierarchy=101]="circlePictureHierarchy";z[z.hierarchy=102]="hierarchy";z[z.labeledHierarchy=103]="labeledHierarchy";z[z.horizontalOrganizationChart=104]="horizontalOrganizationChart";z[z.horizontalMultiLevelHierarchy=105]="horizontalMultiLevelHierarchy";z[z.horizontalHierarchy=106]="horizontalHierarchy";z[z.horizontalLabeledHierarchy=107]="horizontalLabeledHierarchy";z[z.balance=108]="balance";z[z.circleRelationship=109]="circleRelationship";z[z.hexagonCluster=
110]="hexagonCluster";z[z.opposingIdeas=111]="opposingIdeas";z[z.plusandMinus=112]="plusandMinus";z[z.reverseList=113]="reverseList";z[z.counterbalanceArrows=114]="counterbalanceArrows";z[z.segmentedPyramid=115]="segmentedPyramid";z[z.nestedTarget=116]="nestedTarget";z[z.convergingRadial=117]="convergingRadial";z[z.radialList=118]="radialList";z[z.tabbedArc=119]="tabbedArc";z[z.basicTarget=120]="basicTarget";z[z.basicVenn=121]="basicVenn";z[z.linearVenn=122]="linearVenn";z[z.stackedVenn=123]="stackedVenn";
z[z.interconnectedRings=124]="interconnectedRings";z[z.basicMatrix=125]="basicMatrix";z[z.titledMatrix=126]="titledMatrix";z[z.gridMatrix=127]="gridMatrix";z[z.basicPyramid=128]="basicPyramid";z[z.invertedPyramid=129]="invertedPyramid";z[z.accentedPicture=130]="accentedPicture";z[z.circularPictureCallout=131]="circularPictureCallout";z[z.radialPictureList=132]="radialPictureList";z[z.snapshotPictureList=133]="snapshotPictureList";z[z.spiralPicture=134]="spiralPicture";z[z.captionedPictures=135]="captionedPictures";
z[z.bendingPictureCaption=136]="bendingPictureCaption";z[z.pictureFrame=137]="pictureFrame";z[z.bendingPictureSemiTransparentText=138]="bendingPictureSemiTransparentText";z[z.bendingPictureBlocks=139]="bendingPictureBlocks";z[z.bendingPictureCaptionList=140]="bendingPictureCaptionList";z[z.titledPictureBlocks=141]="titledPictureBlocks";z[z.pictureGrid=142]="pictureGrid";z[z.pictureAccentBlocks=143]="pictureAccentBlocks";z[z.themePictureAccent=144]="themePictureAccent";z[z.themePictureGrid=145]="themePictureGrid";
z[z.themePictureAlternatingAccent=146]="themePictureAlternatingAccent";z[z.alternatingPictureCircles=147]="alternatingPictureCircles";z[z.titlePictureLineup=148]="titlePictureLineup";z[z.pictureLineup=149]="pictureLineup";z[z.framedTextPicture=150]="framedTextPicture";z[z.bubblePictureList=151]="bubblePictureList";z[z.linearArrowProcessNumbered=152]="linearArrowProcessNumbered";z[z.linearBlockProcessNumbered=153]="linearBlockProcessNumbered";z[z.basicLinearProcessNumbered=154]="basicLinearProcessNumbered";
z[z.accentHomeChevronProcess=155]="accentHomeChevronProcess";z[z.basicProcessNew=156]="basicProcessNew";z[z.basicTimelineNew=157]="basicTimelineNew";z[z.chevronBlockProcess=158]="chevronBlockProcess";z[z.hexagonTimeline=159]="hexagonTimeline";z[z.horizontalActionList=160]="horizontalActionList";z[z.repeatingBendingProcessNew=161]="repeatingBendingProcessNew";z[z.roundedRectangleTimeline=162]="roundedRectangleTimeline";z[z.verticalDownArrowProcess=163]="verticalDownArrowProcess";z[z.verticalHollowActionList=
164]="verticalHollowActionList";z[z.verticalSolidActionList=165]="verticalSolidActionList";z[z.dropPinTimeline=166]="dropPinTimeline";z[z.horizontalLabelsTimeline=167]="horizontalLabelsTimeline";z[z.horizontalPathTimeline=168]="horizontalPathTimeline";z[z.iconLabelList=169]="iconLabelList";z[z.iconCircleList=170]="iconCircleList";z[z.iconLabelDescriptionList=171]="iconLabelDescriptionList";z[z.iconVerticalSolidList=172]="iconVerticalSolidList";z[z.iconCircleLabelList=173]="iconCircleLabelList";z[z.iconCircleOutlineLabelList=
174]="iconCircleOutlineLabelList";z[z.iconLeafLabelList=175]="iconLeafLabelList";z[z.iconLeafOutlineLabelList=176]="iconLeafOutlineLabelList";z[z.centeredIconLabelDescriptionList=177]="centeredIconLabelDescriptionList"})(eh||(eh={}));Object(h.b)("SmartArtLayout",eh);var rg;(function(z){z[z.title=0]="title";z[z.body=1]="body";z[z.centerTitle=2]="centerTitle";z[z.subTitle=3]="subTitle";z[z.slideNum=5]="slideNum";z[z.footer=6]="footer";z[z.object=8]="object";z[z.graph=9]="graph";z[z.table=10]="table";
z[z.clipArt=11]="clipArt";z[z.orgChart=12]="orgChart";z[z.media=13]="media";z[z.picture=15]="picture"})(rg||(rg={}));Object(h.b)("PlaceholderType",rg);class Cg{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc){this.s5="Existing";this.vJa="ExistingInMenu";this.qPe="AnimationExisting";this.rPe="AnimationExistingInMenu";this.ia=z;this.$p=U;this.ra=ka;this.abc=mc.hk(Dd.a.Kad);this.Fb=Ia;this.Fa=Ba;this.yk=Ab;this.Xb=Ob;this.E4j=Yb.pptAnimationMarkersEnabled;this.Ea=uc}ub(){this.ia.pa(Qc.a.Zeb,xc.a.application,
Object(v.a)(this,this.Zeb,"queryAnimationGallery"),97);this.ia.pa(Qc.a.sDe,xc.a.application,Object(v.a)(this,this.sDe,"queryMoreAnimationGallery"),96);this.ia.pa(Qc.a.nB,xc.a.application,Object(v.a)(this,this.nB,"setAnimation"),5);this.ia.pa(Qc.a.bHb,xc.a.application,Object(v.a)(this,this.nB,"setAnimation"),5);this.ia.pa(Qc.a.Pkc,xc.a.application,Object(v.a)(this,this.nB,"setAnimation"),5);this.ia.pa(Qc.a.zgb,xc.a.application,Object(v.a)(this,this.nB,"setAnimation"),5);this.ia.pa(Qc.a.o$g,xc.a.application,
Object(v.a)(this,this.$Ce,"queryEffectOptions"),100);this.ia.pa(Qc.a.xgb,xc.a.application,Object(v.a)(this,this.xgb,"setAnimationDirection"),5);this.ia.pa(Qc.a.Veb,xc.a.application,Object(v.a)(this,this.Veb,"queryAnimationDirection"),97);this.ia.pa(Qc.a.ygb,xc.a.application,Object(v.a)(this,this.ygb,"setAnimationEffectData"),4);this.ia.pa(Qc.a.Yeb,xc.a.application,Object(v.a)(this,this.Yeb,"queryAnimationEffectData"),96);this.ia.pa(Qc.a.jKe,xc.a.application,Object(v.a)(this,this.SIa,"setAnimationSequence"),
5);this.ia.pa(Qc.a.kKe,xc.a.application,Object(v.a)(this,this.SIa,"setAnimationSequence"),5);this.ia.pa(Qc.a.lKe,xc.a.application,Object(v.a)(this,this.SIa,"setAnimationSequence"),5);this.ia.pa(Qc.a.mKe,xc.a.application,Object(v.a)(this,this.SIa,"setAnimationSequence"),5);this.ia.pa(Qc.a.$eb,xc.a.application,Object(v.a)(this,this.$eb,"queryAnimationSequence"),97);this.ia.pa(Qc.a.xgh,xc.a.application,Object(v.a)(this,this.m$,"reorderAnimation"),4);this.ia.pa(Qc.a.ygh,xc.a.application,Object(v.a)(this,
this.m$,"reorderAnimation"),4);this.ia.pa(Qc.a.uEb,xc.a.application,Object(v.a)(this,this.uEb,"populateAnimationEffectOptions"),96);this.ia.pa(Qc.a.wgb,xc.a.application,Object(v.a)(this,this.wgb,"setAnimationColor"),4)}xe(){}uEb(z,U,ka,Ba,Ia){z=this.CS();U=this.ra.rn();if(!U||!z)return 8;if(1===ka)return 32;ka=Cg.U2(U,z);if(!ka||0===ka.EffectId)return 16;Ia.MenuItems=this.Ifi(ka,U,z);return 32}Zeb(z,U,ka,Ba,Ia){z=Ia.queryResult;Ia=Ia.SourceControlId;var Ab=Ba=-1;Ia!==this.s5&&({effectType:Ab,effectId:Ba}=
this.yk.gNc(Ia));U=this.CS();var Ob=this.ra.rn();if(!Ob||!U)return 8;if(1!==ka)return 32;({image:ka,label:mc}=this.yk.hNc(Ia));var Yb=mc;if(Ia===this.s5||Ia===this.vJa)Yb=ResourceStrings.L_ExistingButtonDescription;this.E6a(Ia,ka,mc,z,Yb);var uc=Cg.U2(Ob,U);var mc=uc?uc.EffectId:0;Yb=uc?uc.EffectType:0;const Ec=!this.yk.S8a(uc,U);uc=this.yk.$ae(uc,U);this.E4j&&(Ob=Ob?Ob.fRa(U):null,uc=uc&&!this.yk.NOj(Ob));Ba=!Ec&&!uc&&Ba===mc&&Ab===Yb;Ab=Ec?!1:this.yk.JTc(Yb,mc);Ia===this.s5||Ia===this.vJa?(Ab=Ia===
this.s5?this.SEk(this.s5,z,uc,Ab,ka,Yb,mc):Cg.QEk(z,uc,Ab),z.pU(Ec||uc||Ab)):U&&z.pU(Ba);return 32}SEk(z,U,ka,Ba,Ia,Ab,Ob){ka?this.E6a(z,Ia,ResourceStrings.L_AnimationMultiple,U,ResourceStrings.L_AnimationMultiple):Ba&&(Ia=this.yk.fPc(Ab,Ob),{image:Ia,label:ka}=this.yk.hNc(Ia),this.E6a(z,Ia,ka,U,ka));return Ba}E6a(z,U,ka,Ba,Ia){let Ab;Ab=z===this.s5?"298832323":z===this.vJa?"1264919631":"2676673376";U=U.substring((Dd.a.fgc+"_").length,U.length-6);z=Object.assign(new yg.a,{Id:z,ExternalId:"Animation"+
z,Icon:U,Command:Ab,QueryCommand:"1852964326",LabelText:ka,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Ia});Ba.J2=z}sDe(z,U){if(U.contextId!==xc.a.application)return 2;z=this.CS();return!this.ra.rn()||!z||z.hW||z.Uq||z.Tp?8:this.Xb.Zc(z)?16:32}nB(z,U,ka,Ba,Ia){U=this.CS();var Ab=this.ra.rn();if(!Ab||!U||U.hW||U.Uq||U.Tp)return 8;if(this.Xb.Zc(U))return 16;var Ob=(Ba=Cg.U2(Ab,U))?Ba.EffectId:-1,Yb=Ba?Ba.EffectType:-1;if(1===ka)return z===
Qc.a.Pkc||z===Qc.a.zgb?(Ab=this.yk.JTc(Yb,Ob),ka=!!Ba&&!this.yk.S8a(Ba,U),z===Qc.a.zgb&&(Ab=ka?!0:!1),U=!!Ba&&this.yk.$ae(Ba,U),U=ka||U,Ab||U?32:16):z===Qc.a.bHb?U.qd||U.Wq||U.Tp?16:32:32;z=Ia.SourceControlId;if(!z)return 8;if(z===this.s5||z===this.vJa||z===this.qPe||z===this.rPe)return 32;({effectType:Ia,effectId:ka}=this.yk.gNc(z));Ob=this.yk.w3i(z);Yb=this.yk.t3i(z);Ba=U.H8a()?Cg.y1b(Ab,U):Ba;Ba||(Ba=new gf,Ba.Id=U.id.toString(),Ba.BuildIds=[Ab.kZb+1],Ba.HasTrigger=!1,Ba.BuildId=Ab.kZb+1,Ba.SequenceIndex=
0,Ba.IsTextRangeType=!1);Ba.HasExisting=!1;Ba.HasMultiple=!1;Ba.EffectType=Ia;Ba.SequenceId=1;Ba.EffectId=ka;Ba.Direction=Ob;Ba.EffectData=Yb;Ba.IsTrigger=!1;this.a_b(Ab,U,Ba);e.ULS.sendTraceTag(512500802,800,50,"AnimationActorLegacy.SetAnimation: Effect={0}, SlideId.Sid={1}, ShapeId={2}",z,Ab.Bb.sid,U.id);this.c_j(Ab);return 32}wgb(z,U,ka,Ba,Ia){U=this.$p.presentation;if(!U)throw Error.argumentNull("Presentation is null");z=this.CS();if(!z)return 8;U=Object(A.a)(120,U.$B(z.slideId));if(!U)return 8;
Ba=Cg.U2(U,z);if(!(Ba&&Ia&&U&&z))return 8;if(this.Xb.Zc(z))return 16;if(1===ka)return 32;ka=ef.Box4ColorHelper.sY(Ia);ka=ef.Box4ColorHelper.Rfb(ka,U.Pe);if(!ka)return 8;Ba.EffectData=String.format("{0},{1},{2}",ka.r.toString(16),ka.g.toString(16),ka.b.toString(16));this.a_b(U,z,Ba);return 32}$Ce(){const z=this.CS();var U=this.ra.rn();return U&&z?this.Xb.Zc(z)?16:(U=Cg.U2(U,z))&&this.yk.Nki(z,this.Ea,U)?32:16:8}m$(z,U,ka){U=this.CS();const Ba=this.ra.rn();if(!Ba||!U)return 8;if(this.Xb.Zc(U))return 16;
const Ia=Cg.y1b(Ba,U);let Ab;switch(z){case Qc.a.xgh:Ab=!1;break;case Qc.a.ygh:Ab=!0;break;default:return 8}let Ob=!1;if(U&&(Ob=!!Ia&&!Ia.HasTrigger&&1===Ia.BuildIds.length)){let Yb=!1,uc=!1;({JVb:Yb,LVb:uc}=Cg.Ski(Ba,Ia));Ob=Ab?uc&&Ob:Yb&&Ob}if(1===ka)return Ob?32:8;if(Ob){ka=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{ka.kc(Ba),ka.fd=z,Ba.m$(U,Ab)}finally{ka&&ka.dispose()}}return 32}xgb(z,U,ka,Ba,Ia){z=this.CS();U=this.ra.rn();if(!U||!z)return 8;if(1===ka)return 32;if(this.Xb.Zc(z))return 16;
ka=Cg.y1b(U,z);if(!ka)return 8;Ia=Ia.MenuItemId;ka.Direction=this.yk.H0b(Ia);this.a_b(U,z,ka);e.ULS.sendTraceTag(512500801,800,50,"AnimationActorLegacy.SetAnimationDirection: Effect={0}, EffectDirection={1}, SlideId.Sid={2}, ShapeId={3}",this.yk.fPc(ka.EffectType,ka.EffectId),Ia,U.sid,z.id);return 32}Veb(z,U,ka,Ba,Ia){U=this.CS();Ba=this.ra.rn();if(!Ba||!U)return 8;z=Ia.queryResult;Ia=this.yk.H0b(Ia.MenuItemId);U=Cg.U2(Ba,U);1===ka&&U&&z.Nf(U.Direction===Ia);return 32}SIa(z,U,ka,Ba,Ia){z=Ia.MenuItemId;
U=this.CS();Ba=this.ra.rn();if(!Ba||!U)return 8;if(1===ka)return 32;if(this.Xb.Zc(U))return 16;ka=Cg.y1b(Ba,U);if(!ka)return 8;ka.SequenceId=this.yk.R2d(z);this.a_b(Ba,U,ka);return 32}$eb(z,U,ka,Ba,Ia){z=this.CS();U=this.ra.rn();if(!U||!z)return 8;z=Cg.U2(U,z);U=Ia.queryResult;Ia=this.yk.R2d(Ia.MenuItemId);1===ka&&z&&U.Nf(z.SequenceId===Ia);return 32}ygb(z,U,ka,Ba,Ia){z=this.CS();U=this.ra.rn();if(!U||!z)return 8;if(1===ka)return 32;if(this.Xb.Zc(z))return 16;ka=Cg.y1b(U,z);if(!ka)return 8;if(!Ia)return 2;
ka.EffectData=this.yk.K_d(Ia.MenuItemId);this.a_b(U,z,ka);return 32}Yeb(z,U,ka,Ba,Ia){z=this.CS();U=this.ra.rn();if(!U||!z)return 8;z=Cg.U2(U,z);1===ka&&z&&Ia.queryResult.Nf(this.yk.JRf(z.EffectData,Ia.MenuItemId));return 32}a_b(z,U,ka){const Ba=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{Ba.kc(z),z.llc(U,ka)}finally{Ba&&Ba.dispose()}}Ifi(z,U,ka){const Ba=Object.assign(new jh.a,{Id:"AnimationMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_EffectOptions,MenuSectionList:[]});
Array.add(Ba.MenuSectionList,this.yk.HOc(z.EffectId,z.EffectType,"Direction","2289594085","3782857737"));this.yk.fug(z)&&(Array.add(Ba.MenuSectionList,me.f(U.Pe,"Theme Colors","Color.Menu.Controls","themeColor","AnimationEffectOptionsThemeColorPicker","679168237",2)),Array.add(Ba.MenuSectionList,me.d("Standard Colors","Color.Menu.Controls","standardColor","AnimationEffectOptionsStandardColorPicker","679168237",!1)));Array.add(Ba.MenuSectionList,this.yk.HOc(z.EffectId,z.EffectType,"EffectData","2949363495",
"4132852551"));Array.add(Ba.MenuSectionList,this.yk.lcj(ka,this.Ea,z));return Ba}c_j(z){if(z){var U=z.jl(),ka=String.format("{0}#{1}",z.sid,z.cid);if(U&&0<U.length)for(const Ba of U)if(U=z.TCa(Ba)){const Ia=U.EffectId,Ab=U.EffectType,Ob=U.Direction,Yb=this.yk.fPc(Ab,Ia),uc=this.Ea.xbg(Ba),mc=Cg.Tej(Ba,uc);e.ULS.sendTraceTag(512500800,800,50,"Slide animation info: Effect={0}, EffectID={1}, EffectType={2}, Direction={3}, Len={4}, ShapeType={5}, ShapeSubType={6}, SeqID={7}, SlideID={8}, ShapeID={9}",
Yb,Ia,Ab,Ob,Ba.AD().length,uc,mc,U.SequenceId,ka,Ba.id)}}}CS(){const z=this.ra.rq();return z?z.get_smartArtModelId()?this.Ea.nr(z):z.Og?this.Ea.ds(z):z:null}static QEk(z,U,ka){U?z.C6a=ResourceStrings.L_AnimationMultiple:(z.C6a=ResourceStrings.L_AnimationExisting,ka&&(ka=!1));return ka}static Ski(z,U){let ka,Ba;if(!U)return{JVb:!1,LVb:!1};const Ia=z.QUd,Ab=z.kZb,Ob=U.BuildIds[0];Ba=ka=!0;0===U.StartType?ka=Ob>Ia?!0:!1:Ba=Ob<Ab?!0:!1;if(Ob===Ia||Ob===Ab){if(!Ob)return{JVb:!1,LVb:Ba};for(const Yb of z.KP)if(Yb.Id!==
U.Id)for(const uc of Yb.BuildIds)if(0===U.StartType){if(uc>=Ob)return Ba=!0,{JVb:ka,LVb:Ba}}else if(uc===Ob)return ka=!0,{JVb:ka,LVb:Ba};0===U.StartType?Ba=!1:ka=!1}return{JVb:ka,LVb:Ba}}static U2(z,U){return z&&U?z.U2(U):null}static y1b(z,U){return z&&U?z.TCa(U):null}static Tej(z,U){return 24===U?eh[z.smartArtInfo.SmartArtLayout]:1===U?z.shapeType.toString():14===U?rg[z.Cj]:"Unknown"}}Object(h.a)(Cg,"AnimationActorLegacy",null,[229]);class kh{constructor(z,U,ka,Ba){this.uf=null;this.Ca=z;this.tkb=
U;this.IOh=ka;this.JBd=Ba;this.JBd.init();this.tkb.init()}ub(){this.Ca.pa(qd.a.Q$c,xc.a.application,Object(v.a)(this,this.Q$c,"openGrammarSettings"),1028);this.Ca.ya(qd.a.t2b,Ub.a.frame,Object(v.a)(this,this.Oig,"grammarDialogTabFocusHandler"));this.Ca.ya(qd.a.s2b,Ub.a.frame,Object(v.a)(this,this.Oig,"grammarDialogTabFocusHandler"));this.Ca.ya(qd.a.YPc,Ub.a.frame,Object(v.a)(this,this.Nig,"grammarDialogOptionFocusHandler"));this.Ca.ya(qd.a.XPc,Ub.a.frame,Object(v.a)(this,this.Nig,"grammarDialogOptionFocusHandler"))}Q$c(z,
U,ka,Ba,Ia){z=this.I$f();if(1===ka)return this.JBd.request(z).result&&this.JBd.request(z).result.length?6===this.tkb.u1a.status?32:8:8;this.uf=this.IOh(z,this.tkb.u1a.result);this.uf.showDialog(CommonUIStrings.l_GrammarSettingsDialogTitle,Ab=>{e.ULS.sendTraceTag(36489285,375,50,"User click button of {0}",1===Ab?"OK":0===Ab?"Cancel":"");1===Ab&&(this.uf.QRj()?(e.ULS.sendTraceTag(36489286,375,50,"User update proofing options"),this.tkb.saveSettings(this.uf.settings)):e.ULS.sendTraceTag(36508631,375,
50,"User click OK with but not update setting"))});z=ka="";Ia&&(ka+=Ia.SourceControlId,z+=Ia.Alt);e.ULS.sendTraceTag(36489287,375,50,"Open grammar setting dialog, SourceControlId: "+ka+", Alt: "+z);return 32}I$f(){return L.AFrameworkApplication.lcid}Oig(z){if(!this.uf)return 2;var U=this.uf.Bo.il().uj.vZ;if(U===this.uf.Hv&&z===qd.a.t2b||U===this.uf.RXa&&z===qd.a.s2b)this.uf.N6?this.uf.Bo.il().uj.wE(this.uf.N6):this.uf.f0k();else if(Sys.UI.DomElement.containsCssClass(U,Ee.YXb)||U.parentNode&&Sys.UI.DomElement.containsCssClass(U.parentNode,
Ee.YXb))U=null,z===qd.a.t2b?U=this.uf.RXa:z===qd.a.s2b&&(U=this.uf.Hv),this.uf.Bo.il().uj.wE(U);else if(z===qd.a.t2b)this.uf.Bo.il().CCb();else if(z===qd.a.s2b)this.uf.Bo.il().ACb();else return 2;return 32}Nig(z){if(!this.uf)return 2;let U=this.uf.Bo.il().uj.vZ;if(U===this.uf.Hv||U===this.uf.RXa||U===this.uf.XC)return 2;z===qd.a.XPc&&this.uf.Bo.il().CCb();z===qd.a.YPc&&this.uf.Bo.il().ACb();U=this.uf.Bo.il().uj.vZ;U===this.uf.RXa?this.uf.Bo.il().ACb():U===this.uf.Hv?this.uf.Bo.il().CCb():this.uf.N6=
U;return 32}}Object(h.a)(kh,"GrammarSettingsActor",null,[]);class De extends kh{constructor(z,U,ka,Ba,Ia,Ab,Ob){super(z,U,ka,Ba);this.nb=Ia;this.Qne=Ab;this.Ea=Ob}I$f(){let z=L.AFrameworkApplication.lcid;if(this.nb.$Z(this.nb.Oa)){var U=this.nb.Yd();U&&1===U.length&&(U=this.Ea.QQa(U[0]),0<U&&(z=U))}else this.nb.Oa.kb&&(U=this.Qne.TNc(this.nb.Kj),0<U&&(z=U));return z}}Object(h.a)(De,"EditorSettingsActor",kh,[]);var Nd=d(61),Od=d(317),mj=d(258),qi=d(434),Vf=d(41),Ai=d(38);class $g{constructor(z,U,ka,
Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc){this.lba=null;this.ia=z;this.Fa=U;this.Xb=ka;this.ra=Ba;this.Fb=Ia;this.kX=Ab;this.ua=Ob;this.Yz=Yb;this.DF=uc;this.noe=mc;this.Md=Ec;this.Ha=Yc}ub(){this.Ha.xNj?(this.ia.pa(Qc.a.w6a,xc.a.application,Object(v.a)(this,this.D5d,"handleSlidesSolidFill"),4),this.ia.pa(Qc.a.NYd,xc.a.application,Object(v.a)(this,this.D5d,"handleSlidesSolidFill"),4),this.ia.pa(Qc.a.OYd,xc.a.application,Object(v.a)(this,this.D5d,"handleSlidesSolidFill"),4),this.ia.pa(Qc.a.MYd,xc.a.application,
Object(v.a)(this,this.C5d,"handleSlidesPicture"),4),this.ia.pa(Qc.a.j7f,xc.a.application,Object(v.a)(this,this.C5d,"handleSlidesPicture"),4),this.ia.pa(Qc.a.k7f,xc.a.application,Object(v.a)(this,this.C5d,"handleSlidesPicture"),4),this.ia.pa(Qc.a.zLc,xc.a.application,Object(v.a)(this,this.zrj,"handleSlidesFinalizePicture"),4)):(this.ia.pa(Qc.a.w6a,xc.a.application,Object(v.a)(this,this.E5d,"handleSolidFill"),4),this.ia.pa(Qc.a.NYd,xc.a.application,Object(v.a)(this,this.E5d,"handleSolidFill"),4),this.ia.pa(Qc.a.OYd,
xc.a.application,Object(v.a)(this,this.E5d,"handleSolidFill"),4),this.ia.pa(Qc.a.MYd,xc.a.application,Object(v.a)(this,this.t5d,"handlePicture"),4),this.ia.pa(Qc.a.j7f,xc.a.application,Object(v.a)(this,this.t5d,"handlePicture"),4),this.ia.pa(Qc.a.k7f,xc.a.application,Object(v.a)(this,this.t5d,"handlePicture"),4),this.ia.pa(Qc.a.zLc,xc.a.application,Object(v.a)(this,this.Knj,"handleFinalizePicture"),4));this.ia.pa(Qc.a.LYd,xc.a.application,Object(v.a)(this,this.Y4d,"handleApplyAll"),4);this.ia.pa(Qc.a.FWi,
xc.a.application,Object(v.a)(this,this.Y4d,"handleApplyAll"),4);this.ia.pa(Qc.a.GWi,xc.a.application,Object(v.a)(this,this.Y4d,"handleApplyAll"),4);this.ia.pa(Qc.a.i7g,xc.a.application,Object(v.a)(this,this.Hpj,"handlePopulateFillMenu"),96);this.ia.pa(Qc.a.Byk,xc.a.application,Object(v.a)(this,this.Ipj,"handlePopulateFillMenuForCanvasContextMenu"),96);this.ia.pa(Qc.a.Cyk,xc.a.application,Object(v.a)(this,this.Jpj,"handlePopulateFillMenuForThumbnailPaneContextMenu"),96);this.ia.pa(Qc.a.Aue,xc.a.application,
Object(v.a)(this,this.Qoj,"handleMoreFormatBackgroundColors"),96);this.ia.pa(Qc.a.zbd,xc.a.application,Object(v.a)(this,this.Roj,"handleMoreFormatBackgroundColorsResponse"),4)}xe(){}Hpj(z,U,ka,Ba,Ia){z=this.ua.Ba;if(!z||this.Xb.Zc(z))return 16;if(1===ka)return 32;if(!Ia)return Jc.a.J(512500616,822,10,"HandlePopulateFillMenu requires actionData"),8;ka=z.Pe;if(!ka)return Jc.a.J(512500615,822,10,"HandlePopulateFillMenu failed to get theme information from slide"),8;z=this.kX.yf.j2;U=Object.assign(new jh.a,
{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});Array.add(U.MenuSectionList,me.f(ka,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColors","3049223287",1));Array.add(U.MenuSectionList,me.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColors","3049223287",!1));z&&0<z.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),Array.add(U.MenuSectionList,me.c(z,"Recent Colors","Color.Menu.Controls",
"recentColor","FormatBackgroundRecentColors","1912773268",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));Array.add(U.MenuSectionList,me.a("More Format Background Color","Color.Menu.Controls","3938657252",ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ia.MenuItems=U;return 32}Ipj(z,U,ka,
Ba,Ia){z=this.ua.Ba;if(!z||this.Xb.Zc(z))return 16;if(1===ka)return 32;if(!Ia)return Jc.a.J(512623376,822,10,"HandlePopulateFillMenuForCanvasContextMenu requires actionData"),8;U=z.Pe;if(!U)return Jc.a.J(512623374,822,10,"HandlePopulateFillMenuForCanvasContextMenu failed to get theme information from slide"),8;ka=this.kX.yf.j2;Ba=Qc.a.NYd.toString();z=Object.assign(new jh.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});z.MenuSectionList.push(me.f(U,"Theme Colors","Color.Menu.Controls","themeColor",
"FormatBackgroundThemeColorsFromCanvas",Ba,1));z.MenuSectionList.push(me.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColorsFromCanvas",Ba,!1));U=Qc.a.zbd.toString();ka&&0<ka.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),z.MenuSectionList.push(me.c(ka,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors",U,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",
!0));z.MenuSectionList.push(me.a("More Format Background Color","Color.Menu.Controls",Qc.a.Aue.toString(),ResourceStrings.l_MoreFormatBackgroundColors,"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ia.MenuItems=z;return 32}Jpj(z,U,ka,Ba,Ia){z=this.ua.Ba;if(!z||this.Xb.Zc(z))return 16;if(1===ka)return 32;if(!Ia)return Jc.a.J(512623375,822,10,"HandlePopulateFillMenuForThumbnailPaneContextMenu requires actionData"),
8;U=z.Pe;if(!U)return Jc.a.J(512623373,822,10,"HandlePopulateFillMenuForThumbnailPaneContextMenu failed to get theme information from slide"),8;ka=this.kX.yf.j2;Ba=Qc.a.OYd.toString();z=Object.assign(new jh.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});z.MenuSectionList.push(me.f(U,"Theme Colors","Color.Menu.Controls","themeColor","FormatBackgroundThemeColorsFromThumbnailPane",Ba,1));z.MenuSectionList.push(me.d("Standard Colors","Color.Menu.Controls","standardColor","FormatBackgroundStandardColorsFromThumbnailPane",
Ba,!1));U=Qc.a.zbd.toString();ka&&0<ka.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!1)),z.MenuSectionList.push(me.c(ka,"Recent Colors","Color.Menu.Controls","recentColor","FormatBackgroundRecentColors",U,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FormatBackgroundRecentColors",!0));z.MenuSectionList.push(me.a("More Format Background Color","Color.Menu.Controls",Qc.a.Aue.toString(),ResourceStrings.l_MoreFormatBackgroundColors,
"Color.Menu.MoreFormatBackgroundColors","MoreFormatBackgroundColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFormatBackgroundColorsKeytip));Ia.MenuItems=z;return 32}E5d(z,U,ka,Ba,Ia){U=this.ua.Ba;if(!U||this.Xb.Zc(U)||this.Ha.Ly&&1!==this.ra.nf().length)return 16;if(1===ka)return 32;ka=$g.Zfc(Ia);if(!ka)return 8;Vf.a.Eb&&Vf.a.Eb.Wa("SlideCount","1");Ia=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()});try{Ia.kc(U),Ia.fd=z,U.S3a=ka}finally{Ia&&Ia.dispose()}return 32}D5d(z,U,ka,Ba,
Ia){U=this.ra.nf();if(!U||!U.length)return 16;for(const Ab of U)if(!Ab||this.Xb.Zc(Ab))return 16;if(1===ka)return 32;ka=$g.Zfc(Ia);if(!ka)return 8;Vf.a.Eb&&Vf.a.Eb.Wa("SlideCount",U.length.toString());Ia=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()});try{Ia.kc(this.ua.Ba);Ia.fd=z;for(const Ab of U)Ab.S3a=ka}finally{Ia&&Ia.dispose()}return 32}t5d(z,U,ka){this.lba=this.ua.Ba;if(!this.lba||this.Xb.Zc(this.lba)||Nd.a.Sw(this.lba.Bb)||this.Ha.Ly&&1!==this.ra.nf().length)return 16;if(1===ka)return 32;
this.nmc(!1);return 32}C5d(z,U,ka){this.lba=this.ua.Ba;z=this.ra.nf();if(!z||!z.length)return 16;for(const Ba of z)if(!Ba||this.Xb.Zc(Ba)||Nd.a.Sw(Ba.Bb))return 16;if(1===ka)return 32;this.nmc(!1);return 32}Y4d(z,U,ka){U=this.ua.Ba;if(!U||this.Xb.Zc(U))return 16;if(1===ka)return 32;ka=U.Bb;U=this.kX.yf;if(!U)return 8;const Ba=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()});try{Ba.kc(U),Ba.fd=z,U.Fob=ka}finally{Ba&&Ba.dispose()}return 32}Knj(z,U,ka,Ba,Ia){if(!this.lba||!this.lba.isConnected||
this.Ha.Ly&&1!==this.ra.nf().length)return 16;if(1===ka)return 32;this.DF.kwa=new Date;const Ab=Vf.a.Eb;this.Yz.kkd(Ia,Ob=>{Vf.a.BK(Ab,()=>{this.u5d(Ob,z)})},Ob=>{this.T7a(Ob.error)});this.ua.Ba===this.lba&&(this.Fa.Ad(),this.ra.Uh());return 32}zrj(z,U,ka,Ba,Ia){U=this.ra.nf();if(!U||!U.length)return 16;for(const Ob of U)if(!Ob||!Ob.isConnected)return 16;if(1===ka)return 32;this.DF.kwa=new Date;const Ab=Vf.a.Eb;this.Yz.kkd(Ia,Ob=>{Vf.a.BK(Ab,()=>{this.Brj(Ob,z)})},Ob=>{this.T7a(Ob.error)});this.ua.Ba===
this.lba&&(this.Fa.Ad(),this.ra.Uh());return 32}Qoj(z,U,ka,Ba,Ia){z=this.ua.Ba;if(!z||this.Xb.Zc(z))return Jc.a.J(512500611,822,10,"HandleMoreFormatBackgroundColors: currentSlide is null"),16;if(this.Ha.Ly&&Ai.a("MoreColorBackgroundForMultipleSlidesEnabled")?1>this.ra.nf().length:1!==this.ra.nf().length)return 16;if(1===ka)return this.ia.La(Qc.a.renderColorPicker,1,Ia);ka=mj.a.parse(z.gZ);if(!ka)return 8;Ia=ka.bKa();ka=null;Ia&&(ka=ef.Box4ColorHelper.Mra(Ia));Ia={};Ia.currentColor=ka;Ia.handleCommand=
Qc.a.zbd;return this.ia.La(Qc.a.renderColorPicker,2,Ia)}Roj(z,U,ka,Ba,Ia){if(1===ka)return this.ia.La(Qc.a.w6a,ka,Ia);if(!Ia)return Jc.a.J(512500609,822,10,"HandleMoreFormatBackgroundColorsResponse: actionData is null"),16;z=this.ia.La(Qc.a.w6a,ka,Ia);32===z&&this.ia.La(Qc.a.tAa,ka,Ia);return z}nmc(z){this.noe?qi.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.Yz&&(this.Yz.QKb=1,this.Yz.S9g(z))}u5d(z,U){this.DF.jwa=new Date;(z=z.result)?this.PNd(z,U):(U=Object.assign(new Od.a,
{Code:94}),this.T7a(U))}Brj(z,U){this.DF.jwa=new Date;(z=z.result)?this.zmi(z,U):(U=Object.assign(new Od.a,{Code:94}),this.T7a(U))}PNd(z,U){const ka=this.Fb.ud(15);try{ka.kc(this.lba),ka.fd=U,this.lba.JA=z.ItemId}finally{ka&&ka.dispose()}if(z=Vf.a.Eb)z.actionName="FormatBackgroundPicture",z.Wa("PictureUploadStart",Vf.a.$e(this.DF.kwa)),z.Wa("PictureUploadDurationMS",(+this.DF.jwa-+this.DF.kwa).toString())}zmi(z,U){const ka=this.ra.nf(),Ba=this.Fb.ud(15);try{Ba.kc(this.lba);Ba.fd=U;for(const Ia of ka)Ia.JA=
z.ItemId}finally{Ba&&Ba.dispose()}if(z=Vf.a.Eb)z.actionName="FormatBackgroundPicture",z.Wa("PictureUploadStart",Vf.a.$e(this.DF.kwa)),z.Wa("PictureUploadDurationMS",(+this.DF.jwa-+this.DF.kwa).toString())}T7a(z){this.DF.jwa=new Date;this.Md.FG(z.Code,U=>{U.NB=1;U.XPa=z.ExtraErrorParam;return!1})}static Zfc(z){return mj.a.parse(z.Color)}}Object(h.a)($g,"FormatBackgroundActor",null,[229]);var Ch=d(75),nf=d(31),qf=d(407),Wi=d(30),Tg=d(152);const rd=z=>{let U=z.isBold?"b:1;":"";U+=z.isItalic?"i:1;":"";
U+=z.GD?"u:1;":"";U+=z.rF?"s:1;":"";U+=z.isSuperscript?"sup:1;":"";return U+=z.sF?"sub:1;":""},ze=(z,U,ka)=>{let Ba=null;for(var Ia,Ab=nf.ParagraphReader.text(z),Ob=0;z.Ra&&Ob<z.Ra.length;){var Yb=z.Ra.ga(Ob),uc=Yb.cp;Ia=Ob<z.Ra.length-1?z.Ra.ga(Ob+1).cp:nf.ParagraphReader.textLength(z);if(-1!==U&&Ia<=U)Ob++;else{if(-1!==ka&&uc>ka)break;var mc="";Yb.formatting?mc=rd(Yb.formatting.cache):(Yb=qf.c(z.Ra,Yb.cp).RWc)&&(mc=rd(Yb.cache));Yb=uc;-1!==U&&(Yb=Math.max(U,uc));uc=Ia;-1!==ka&&(uc=Math.min(ka,Ia));
uc=I.a.substring(Ab,Yb,uc);0<uc.length&&(Ia=document.createElement("span"),Ia.setAttribute("style",mc),Ia.innerText=uc,Ba||(Ba=document.createElement("p")),Ba.appendChild(Ia));Ob++}}if(Ba&&nf.ParagraphReader.mW(z)){U=Ba;ka=U.setAttribute;Ob=new Wi.GraphIterator;Ob.set(z);Ob.pc(11);Ob.Rg(11);Ab="";if(z.Tf.Pw(Ob))switch(Ob=z.Tf.Pw(Ob),z=nf.ParagraphReader.oeb(z),mc=Ob.wW,Ob.listType){case 0:switch(Ob.listStyle){case 1:Ab="decimal";break;case 2:Ab="loweralpha";break;case 3:Ab="lowerroman";break;case 4:Ab=
"upperalpha";break;case 5:Ab="upperroman";break;default:Ab="decimal"}Ab=String.format("lt:{0};in:{1};li:{2}",Ab,z,mc);break;case 1:switch(Ob.listStyle){case 1:Ab="disc";break;case 2:Ab="circle";break;case 3:Ab="square";break;default:Ab="disc"}Ab=String.format("lt:{0};in:{1}",Ab,z)}ka.call(U,"style",Ab)}return Ba},xh=z=>{if(z){var U;(U=Z.a.instance.resolve("PowerPointWebEditor.Graph.ITableReader"))?U=U.iN(z):(Jc.a.J(512500561,822,10,"ImmersiveReader: TableReader is null."),U=null);if(U){z=null;U=U.S1b();
for(let ka=0;ka<U.length;ka++){const Ba=Qj(Object(A.a)(Ch.AParagraphNode,U[ka].C_b));z=ae(Ba,z)}return z}z=Array.isArray(z.AD())?z.AD():null;return Qj(z&&0<z.length?z[0]:null)}return null},Qj=z=>{let U=null;for(;z;){const ka=ze(z,-1,-1);U=ae(ka,U);z=nf.ParagraphReader.dsa(z,!1,!0,!1)}return U},ae=(z,U)=>{z&&(U||(U=document.createElement("div")),U.appendChild(z));return U},nj=z=>{const U=Object.assign(new Tg.a,{Source:6});Z.a.instance.resolve("PowerPointWebEditor.IErrorHandler").es(U,z,ka=>{ka.NB=
1;ka.WAa=0;ka.title=ResourceStrings.L_ImmersiveReaderErrorDialogTitle;ka.message=ResourceStrings.L_ImmersiveReaderErrorDialogMessage;return!1})};class Xi{constructor(z,U,ka,Ba){this.hKg=!1;this.t4c="";this.ia=z;this.Fa=U;this.nb=ka;const Ia=new Date;Ba("immersiveReader").then(()=>{this.hKg=!0;Jc.a.J(512500569,822,50,"ImmersiveReader: Loaded SDK successfully. Duration (ms): {0}",+new Date-+Ia)}).catch(Ab=>{const Ob=+new Date-+Ia;Jc.a.J(512500568,822,10,"ImmersiveReader: Failed to load SDK. Duration (ms): {0}, Exception: {1} ",
Ob,Ab.toString());const Yb=new Map;Yb.set("JSLoadDurationInMs",Ob.toString());Yb.set("Exception",Ab.toString());u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","JSLoadFailed",!1,!0,Object.assign(new ya.a,{extendedProperties:Yb}))})}ub(){this.ia.ya(Qc.a.immersiveReader,xc.a.view,Object(v.a)(this,this.Nng,"immersiveReaderHandler"));this.ia.ya(Qc.a.Ong,xc.a.view,Object(v.a)(this,this.Nng,"immersiveReaderHandler"))}xe(){this.Fa.Dc(tf.a.LP).bindAction(cc.KeyInputManager.Na(Bg.a.dqc,cc.KeyInputManager.He|
4),Qc.a.immersiveReader)}VZi(z){let U="";for(z=Object(A.a)(Ch.AParagraphNode,z.node);z;){const ka=nf.ParagraphReader.dsa(z,!0,!0,!1);if(ka)z=ka;else break}for(;z;)U+="\n"+nf.ParagraphReader.text(z),z=nf.ParagraphReader.dsa(z,!1,!0,!1);return U}vgi(){var z=this.nb.nf();let U=null;if(!z)return null;for(const ka of z)if(z=ka.gRa())for(const Ba of z)z=xh(Ba),U=ae(z,U);return U}ugi(){let z=null;var U=this.nb.Oa;if(!U)return null;for(let Ia of U)if(Ia)for(U=0;U<Ia.length;U++){var ka=Ia.ga(U),Ba=null;if(ka.contextId===
xc.a.outline||ka.contextId===xc.a.Of)if(nf.ParagraphReader.Vd(ka.node)){for(ka=Object(A.a)(Ch.AParagraphNode,ka.node);ka;)if(Ba=nf.ParagraphReader.dsa(ka,!0,!0,!1))ka=Ba;else break;Ba=Qj(ka)}else Ba=xh(Object(A.a)(4,ka.node));else ka.contextId!==xc.a.endOfParagraph&&nf.ParagraphReader.Vd(ka.node)&&(Ba=ze(Object(A.a)(Ch.AParagraphNode,ka.node),ka.Qa,ka.Kb));z=ae(Ba,z)}return z}zgi(){let z;return(z=this.nb.wu()?this.vgi():this.ugi())?z.innerHTML:""}Jhj(){let z="";const U=this.nb.Oa.kb;if(U)for(let ka=
0;ka<U.length;ka++){const Ba=U.ga(ka),Ia=Ba.Qa,Ab=Ba.Kb-Ia;let Ob;if(nf.ParagraphReader.Vd(Ba.node))switch(Ob=Ba.node.characterData,Ba.contextId){case xc.a.paragraph:z+=Ob+"\r";break;case xc.a.textRange:0<Ab&&(z+=Ob.substr(Ia,Ab));break;case xc.a.endOfParagraph:z+="\r";break;case xc.a.Of:z+=this.VZi(Ba)}}return z}TBg(){const z=new XMLHttpRequest,U=Z.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;var ka=Z.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;
ka=String.format("{0}PodHandler.ashx?action=ImmersiveReaderAuthToken&PodSID={1}",ka,U);z.open("GET",ka,!0);const Ba=C.a.create().toString();z.setRequestHeader("X-UserSessionId",L.AFrameworkApplication.userSessionId);z.setRequestHeader("X-CorrelationID",Ba);z.setRequestHeader("X-WacCluster",Z.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").fk);let Ia=null;const Ab=new Map;z.onreadystatechange=()=>{if(4===z.readyState)if(200===z.status){var Ob=+new Date-+Ia;Jc.a.J(512500567,822,50,"ImmersiveReader: auth token received. Duration (ms): {0}",
Ob);Ab.set("AuthTokenDurationInMs",Ob.toString());Ob=z.responseText.replace('"',"");const Yb=new Date,uc=Ai.a("EnableSendingHTMLToIR")?[{["content"]:this.t4c,["mimeType"]:"text/html"}]:[{["content"]:this.t4c}];immersiveReader.launchAsync(Ob,null,{["title"]:ResourceStrings.L_ImmersiveReaderDialogTitle,["chunks"]:uc},null).then(mc=>{mc=(mc=Object(A.a)(Object,mc))?mc.sessionId:"";const Ec=+new Date-+Yb,Yc=+new Date-+Ia;Jc.a.J(512500566,822,50,"ImmersiveReader: IR Pane launched successfully. Duration (ms) of LaunchAsync(): {0}, IR response sessionId: {1}",
Ec,mc);Ab.set("LaunchAsyncDurationInMs",Ec.toString());Ab.set("IRResponseSessionId",mc);Ab.set("UserPerceivedDurationInMs",Yc.toString());u.Health.instance.recordKpiSuccess("ImmersiveReaderTriggered",Object.assign(new ya.a,{extendedProperties:Ab}))}).catch(mc=>{nj(U);const Ec=+new Date-+Yb,Yc=+new Date-+Ia;Jc.a.J(512500565,822,10,"ImmersiveReader: LaunchAsync failed. Duration (ms): {0}, ErrorJson: {1}",Ec,mc);Ab.set("LaunchAsyncDurationInMs",Ec.toString());Ab.set("ErrorJson",mc.toString());Ab.set("UserPerceivedDurationInMs",
Yc.toString());u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered","LaunchAsyncFailed",!1,!0,Object.assign(new ya.a,{extendedProperties:Ab}))})}else nj(U),Ob=+new Date-+Ia,Jc.a.J(512500564,822,10,"ImmersiveReader: Request for auth token failed. Duration (ms): {0}, statusCode:{1}, CorrelationId: {2}",Ob,z.status,Ba),Ab.set("CorrelationId",Ba),Ab.set("StatusCode",z.status.toString()),Ab.set("UserPerceivedDurationInMs",Ob.toString()),u.Health.instance.recordKpiFailure("ImmersiveReaderTriggered",
"RequestForAuthTokenFailed",!1,!0,Object.assign(new ya.a,{extendedProperties:Ab}));else Jc.a.J(512500563,822,15,"Immersive Reader auth token request in progress. CorrelationId: {0}, Request Status: {1}",Ba,z.status)};Ia=new Date;Jc.a.J(512500562,822,50,"Begin request for ImmersiveReader auth token. StartTime: {0}, CorrelationId: {1}",Ia.getTime(),Ba);ka=new Map;ka.set("CorrelationId",Ba);ka.set("Info","RequestingAuthToken");u.Health.instance.recordKpiUsage("ImmersiveReaderTriggered",1,null,ka);z.send(null)}Nng(z,
U,ka){if(1===ka||6===this.ia.oq){if(!this.hKg)return 8;this.t4c=Ai.a("EnableSendingHTMLToIR")?this.zgi():this.Jhj();if(""===this.t4c)return 8}2===ka&&this.TBg();return 32}}Object(h.a)(Xi,"ImmersiveReaderActor",null,[229]);var La=d(574),lb=d(770);class Nb{constructor(z){this.customData=null;this.OP=z}}Object(h.a)(Nb,"PropertySetChangedState",null,[]);class lc{static RCk(z,U,ka){if(z&&U){var Ba=new Nb(U),Ia=(Ab,Ob,Yb)=>{ka.QCk(Ab,Ob,Yb,Ba)};z=new lb.a(U,z);z.LBc=Ia;z.uEc=Ia;z.Ted=Ia;z.Hea()}}}Object(h.a)(lc,
"PropertySetChangedManager",null,[]);class Rc{constructor(z){this.bVh=z}QCk(z,U,ka,Ba){const Ia=this.bVh[z.id.toString()];Ia&&Ia(z,U,ka,Ba)}}Object(h.a)(Rc,"PropertyChangedProcessor",null,[]);var Ud=d(1064),Pd=d(430),Sd=d(59),Le=d(573),af=d(390),zf=d(940);class yh{constructor(){this.OCe=this.oXc=this.WRc=null}}Object(h.a)(yh,"ParagraphDialogResults",null,[]);class gg extends pb.a{constructor(z,U,ka){super(void 0,void 0,!0);this.Sta=null;if(null===z)throw Error.argumentNull("properties");this.uda=
z.clone();this.f9=z.clone();this.RA=ka;this.ia=U;this.i9j=new hb.a(Object(v.a)(this,this.WBi,"createPropertyChangedHandlers"))}ujd(){this.ng="ParagraphDialog";const z={};z.bodyControls=this.OZd();this.tj(ResourceStrings.L_ParagraphDialogTitle,Object(v.a)(this,this.FTd,"dialogResultHandler"),z)}FTd(z,U){1===z&&(this.Uxl(U),z=Object.assign(new yh,{WRc:this.uda,oXc:this.f9,OCe:this.i9j}),this.ia.La(Qc.a.GRf,2,z));this.dispose()}OZd(){this.Sta=gg.G_d();const z={};this.Pti(z);this.cti(z);var U=zf.a("Inch",
3,0,56,.1);const ka=zf.a("Character",2,0,56,.1);U=[U,ka];this.rui(z,U);this.hti(z,U);U=[zf.a("Point",5,0,1584,1)];this.iti(z,U);this.bti(z,U);this.Qti(z);return z}Uxl(z){this.evl(z);this.Iyl(z);this.uvl(z);this.vvl(z);this.cvl(z);this.hxl(z)}WBi(){const z={};z[Sd.a.JD.id.toString()]=Object(v.a)(this.RA,this.RA.iTj,"justificationChangedHandler");z[Sd.a.YDb.id.toString()]=Object(v.a)(this.RA,this.RA.W4g,"paraIndentLeftChangedHandler");z[Sd.a.ZDb.id.toString()]=Object(v.a)(this.RA,this.RA.W4g,"paraIndentLeftChangedHandler");
z[Sd.a.lfa.id.toString()]=Object(v.a)(this.RA,this.RA.tPe,"specialIndentChangedHandler");z[Sd.a.IIb.id.toString()]=Object(v.a)(this.RA,this.RA.tPe,"specialIndentChangedHandler");z[Sd.a.JIb.id.toString()]=Object(v.a)(this.RA,this.RA.tPe,"specialIndentChangedHandler");z[Sd.a.Zw.id.toString()]=Object(v.a)(this.RA,this.RA.eVj,"lineSpacingChangedHandler");z[Sd.a.bEb.id.toString()]=Object(v.a)(this.RA,this.RA.Z4g,"paraSpacingAfterChangedHandler");z[Sd.a.aEb.id.toString()]=Object(v.a)(this.RA,this.RA.Z4g,
"paraSpacingAfterChangedHandler");z[Sd.a.eEb.id.toString()]=Object(v.a)(this.RA,this.RA.a5g,"paraSpacingBeforeChangedHandler");z[Sd.a.dEb.id.toString()]=Object(v.a)(this.RA,this.RA.a5g,"paraSpacingBeforeChangedHandler");return z}Qti(z){var U=gg.x8i(this.uda),ka="multiple"===U;z.lineSpacingComboBoxProps={["type"]:"AppComboBoxProps",["id"]:"LineSpacingComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,["showLabel"]:!0,
["options"]:zf.b([Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple],["1.00","1.50","2.00","multiple"]),["selectedKey"]:U,["allowFreeForm"]:!1};U=0;let Ba=!1;this.uda.Sa(Sd.a.Zw)&&ka&&(U=this.uda.getValue(Sd.a.Zw),0<=U&&(Ba=!0));ka=[zf.a("none",0,0,9.99,.5)];ka={["type"]:"AppSpinButtonProps",["id"]:"AtSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,["unitType"]:"none",["validUnits"]:ka,["numberFormatInfo"]:this.Sta,["validReservedValues"]:[""]};ka.value=Ba?U:"";z.atSpinButtonProps=ka}bti(z,U){const ka=gg.b9f(this.uda,Sd.a.bEb,Sd.a.aEb);z.afterSpacingSpinButtonProps=gg.xid(ka,{["type"]:"AppSpinButtonProps",["id"]:"AfterSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,["unitType"]:Le.a.jXb(5),
["validUnits"]:U,["numberFormatInfo"]:this.Sta,["validReservedValues"]:[""]})}iti(z,U){const ka=gg.b9f(this.uda,Sd.a.eEb,Sd.a.dEb);z.beforeSpacingSpinButtonProps=gg.xid(ka,{["type"]:"AppSpinButtonProps",["id"]:"BeforeSpacingSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,["unitType"]:Le.a.jXb(5),["validUnits"]:U,["numberFormatInfo"]:this.Sta,["validReservedValues"]:[""]})}hti(z,U){let ka,Ba;({m4g:Ba,
n4g:ka}=gg.Rbg(this.uda,Sd.a.ZDb,Sd.a.YDb,!1));U={["type"]:"AppSpinButtonProps",["id"]:"BeforeTextSpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeft,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentLeftAlt,["unitType"]:Le.a.jXb(ka),["validUnits"]:U,["numberFormatInfo"]:this.Sta,["validReservedValues"]:[""]};U=gg.xid(Ba,U);z.beforeTextSpinButtonProps=U}rui(z,U){var ka={["type"]:"AppComboBoxProps",["id"]:"SpecialComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentation,
["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationAlt,["showLabel"]:!0,["options"]:zf.b([Box4Intl.Box4Strings.l_ParagraphDialogNoneIndent,Box4Intl.Box4Strings.l_ParagraphDialogFirstLineIndent,Box4Intl.Box4Strings.l_ParagraphDialogHangingIndent],["0","1","2"]),["allowFreeForm"]:!1},Ba=this.uda.Sa(Sd.a.lfa)?this.uda.getValue(Sd.a.lfa):-1;gg.vzg(Ba)?ka.selectedKey=Ba.toString():ka.defaultSelectedKey="";z.specialIndentationComboBoxProps=ka;({m4g:ka,n4g:Ba}=gg.Rbg(this.uda,Sd.a.JIb,
Sd.a.IIb,1!==Ba&&2!==Ba));U={["type"]:"AppSpinButtonProps",["id"]:"BySpinButton",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationBy,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogSpecialIndentationByAlt,["unitType"]:Le.a.jXb(Ba),["validUnits"]:U,["numberFormatInfo"]:this.Sta};U=gg.xid(ka,U);z.bySpinButtonProps=U}cti(z){const U={["type"]:"AppComboBoxProps",["id"]:"AlignmentComboBox",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignment,["customTooltip"]:Box4Intl.Box4Strings.l_ParagraphDialogAlignmentAlt,
["showLabel"]:!0,["options"]:zf.b([Box4Intl.Box4Strings.l_ParagraphDialogAlignLeft,Box4Intl.Box4Strings.l_ParagraphDialogAlignCenter,Box4Intl.Box4Strings.l_ParagraphDialogAlignRight,Box4Intl.Box4Strings.l_ParagraphDialogAlignJustified],["1","2","3","6"]),["allowFreeForm"]:!1},ka=this.uda.Sa(Sd.a.JD)?this.uda.getValue(Sd.a.JD):0;gg.tKj(ka)?U.selectedKey=ka.toString():U.defaultSelectedKey="";z.alignmentComboBoxProps=U}Pti(z){z.generalLabelProps={["type"]:"AppLabelProps",["id"]:"GeneralSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogGeneral,
["forId"]:"GeneralGroup"};z.indentationLabelProps={["type"]:"AppLabelProps",["id"]:"IndentationSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogIndentation,["forId"]:"IndentationGroup"};z.spacingLabelProps={["type"]:"AppLabelProps",["id"]:"SpacingSection",["label"]:Box4Intl.Box4Strings.l_ParagraphDialogSpacing,["forId"]:"SpacingGroup"}}hxl(z){if(z.lineSpacingComboBoxProps){const U=z.lineSpacingComboBoxProps.selectedKey.toString();let ka=zf.c(U);"multiple"===U&&(z=z.atSpinButtonProps)&&(ka=
parseFloat(z.value.toString()));this.f9.setValue(Sd.a.Zw,ka);this.f9.setValue(Sd.a.yW,2)}}cvl(z){if(z.afterSpacingSpinButtonProps){z=z.afterSpacingSpinButtonProps;var U=Le.a.iXb(z.unitType.toString().toLowerCase());""!==z.value.toString()&&(U=4===U?2:4,this.f9.setValue(Sd.a.bEb,parseInt(z.value.toString())),this.f9.setValue(Sd.a.aEb,U))}}vvl(z){if(z.beforeSpacingSpinButtonProps){z=z.beforeSpacingSpinButtonProps;var U=Le.a.iXb(z.unitType.toString().toLowerCase());""!==z.value.toString()&&(U=4===U?
2:4,this.f9.setValue(Sd.a.eEb,parseInt(z.value.toString())),this.f9.setValue(Sd.a.dEb,U))}}uvl(z){if(z.beforeTextSpinButtonProps){var U=z.beforeTextSpinButtonProps;z=Le.a.iXb(U.unitType.toString().toLowerCase());if(""!==U.value.toString()){U=parseFloat(U.value.toString());let ka;2===z?ka=2:(ka=1,U=Le.a.vBh(U,z));this.f9.setValue(Sd.a.ZDb,U);this.f9.setValue(Sd.a.YDb,ka)}}}Iyl(z){var U=z.bySpinButtonProps,ka=z.didChangeSpecialIndentationComboBoxValue;if(U&&""!==U.value.toString()||ka)if(z.specialIndentationComboBoxProps&&
(z=z.specialIndentationComboBoxProps,ka=-1,z.selectedKey&&(z=z.selectedKey.toString(),ka=parseInt(z)),gg.vzg(ka)&&this.f9.setValue(Sd.a.lfa,ka)),U){z=parseFloat(U.value.toString());U=Le.a.iXb(U.unitType.toString().toLowerCase());if(0>z||isNaN(z))z=0;2===U?ka=2:(ka=1,z=Le.a.vBh(z,U));this.f9.setValue(Sd.a.JIb,z);this.f9.setValue(Sd.a.IIb,ka)}}evl(z){z.alignmentComboBoxProps&&(z=z.alignmentComboBoxProps,z.selectedKey&&(z=parseInt(z.selectedKey.toString()),0<=z&&this.f9.setValue(Sd.a.JD,z)))}static b9f(z,
U,ka){if(z.Sa(U)&&z.Sa(ka)){ka=z.getValue(ka);if(2!==ka&&4!==ka)return Number.NaN;z=z.getValue(U);2===ka&&(z*=gg.Vxk);return z}return Number.NaN}static xid(z,U){U.value=isNaN(z)?"":z;return U}static G_d(){return{["negativeSign"]:"-",["numberDecimalDigits"]:2,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}static Rbg(z,U,ka,Ba){let Ia=3;Ai.a("BySpinButtonDefaultvalueFix")&&Ba?U=0:z.Sa(U)&&z.Sa(ka)&&!Ba?(U=z.getValue(U),2===z.getValue(ka)?
Ia=2:U=Le.a.kBl(U,Ia)):U=Number.NaN;return{m4g:U,n4g:Ia}}static tKj(z){return 1===z||2===z||3===z||6===z}static vzg(z){return 1===z||2===z||0===z}static x8i(z){if(gg.gtj(z)){z=z.getValue(Sd.a.Zw);var U="multiple";af.a.Jy(z,1)?U="1.00":af.a.Jy(z,1.5)?U="1.50":af.a.Jy(z,2)&&(U="2.00");return U}}static gtj(z){return z.Sa(Sd.a.Zw)&&z.Sa(Sd.a.yW)&&2===z.getValue(Sd.a.yW)?!0:!1}}gg.Vxk=72;Object(h.a)(gg,"ReactParagraphDialog",pb.a,[]);class Dh{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec){this.Whe=[];this.ia=
z;this.ra=U;this.Ida=ka;this.j9=Ba;this.Fb=Ia;this.Hh=Ab;this.fGa=Ob;this.Ea=Yb;this.RA=uc;this.Fda=mc;this.pSg=Ec}ub(){this.ia.pa(Qc.a.Sde,xc.a.application,Object(v.a)(this,this.suk,"paragraphDialogHandler"),4);this.ia.pa(Qc.a.GRf,xc.a.application,Object(v.a)(this,this.csi,"commitParagraphDialogHandler"),4);this.ia.pa(Qc.a.I$g,xc.a.view,Pd.a.m0,96);this.ia.pa(Qc.a.r$g,xc.a.view,Pd.a.m0,96);this.ia.pa(Qc.a.cah,xc.a.view,Pd.a.m0,96);this.ia.pa(Qc.a.dah,xc.a.view,Pd.a.m0,96);this.ia.pa(Qc.a.bah,xc.a.view,
Pd.a.m0,96);this.ia.pa(Qc.a.aah,xc.a.view,Pd.a.m0,96);this.ia.pa(Qc.a.C$g,xc.a.view,Pd.a.m0,96);this.ia.pa(Qc.a.D$g,xc.a.view,Pd.a.m0,96);this.ia.ya(Qc.a.Z3g,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.wuh,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.aog,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.zuh,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.yuh,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.b4g,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.c4g,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.W3g,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.xuh,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.V3g,
xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.e4g,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.d4g,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.Auh,xc.a.view,Pd.a.GG);this.ia.ya(Qc.a.Gcd,xc.a.paragraph,Object(v.a)(this,this.Qbj,"getPropertiesForParagraphDialog"));this.ia.ya(Qc.a.Gcd,xc.a.view,this.Fda);this.ia.he(Qc.a.Gcd,96)}xe(){}suk(z,U,ka){if(this.ra.wu()||this.ra.h8())return 16;z=this.ra.Yd();if(!this.Ea.KZ(z,!0).length&&!this.ra.Ija())return 16;if(1===ka)return 32;this.pSg&&Jc.a.J(25040911,820,50,"Setting Paragraph properties from: {0}, IsDialogLancherButton: {1}",
this.ia.oq,"PptRibbon.Home"===this.ia.Eqa);Array.clear(this.Whe);this.ia.processAction(Qc.a.Gcd,2);return(ka=La.APropertySet.D7i(this.Whe))?((new gg(ka,this.ia,this.RA)).ujd(),32):16}csi(z,U,ka,Ba,Ia){if(1===ka)return 32;if(!(Ia&&Ia.WRc&&Ia.oXc&&Ia.OCe))return 16;U=this.ra.rn();this.RA.hyj();ka=this.Fb.ke(15);try{ka.kc(U),ka.fd=z,Ia.WRc.equals(Ia.oXc)||this.Bqi(),lc.RCk(Ia.WRc,Ia.oXc,new Rc(Ia.OCe.value))}finally{ka&&ka.dispose()}if(this.pSg){let Ab;({WHh:z,XHh:Ia,ZHh:U,YHh:ka,VHh:Ba,$Hh:Ab}=this.RA.Tml());
Jc.a.J(25040909,820,50,"IsJustificationChanged: {0}, IsLnSpacChanged: {1}, IsSpaceBeforeChanged: {2}, IsSpaceAfterChanged: {3}, IsIndentLeftChanged: {4}, IsSpecialIndentChanged: {5}",z,Ia,U,ka,Ba,Ab)}Vf.a.LO(!0,!0);return 32}Qbj(z,U,ka){if(1===ka)return 32;U=U.node;z=new Ud.DictionaryPropertySet;z.setValue(Sd.a.JD,this.Hh.fN(U));ka=this.Ida.YQa(U);z.setValue(Sd.a.yW,ka.Sf);z.setValue(Sd.a.Zw,ka.value);ka=this.Ida.YV(U);z.setValue(Sd.a.dEb,ka.beforeSpacing.Sf);z.setValue(Sd.a.eEb,ka.beforeSpacing.value);
z.setValue(Sd.a.aEb,ka.afterSpacing.Sf);z.setValue(Sd.a.bEb,ka.afterSpacing.value);ka=this.j9.I7(U);z.setValue(Sd.a.YDb,1);z.setValue(Sd.a.ZDb,ka.oM);U=this.fGa.hRa(U);z.setValue(Sd.a.lfa,U.specialIndentType);z.setValue(Sd.a.IIb,U.Sf);z.setValue(Sd.a.JIb,U.value);this.Whe.push(z);return 32}Bqi(){if(this.ra.JG()){var z=this.ra.Yd();z=this.Ea.KZ(z);for(const U of z)U.Kra()}}}Object(h.a)(Dh,"ParagraphDialogActor",null,[229]);var Ug;(function(z){z[z.unspecified=-1]="unspecified";z[z.none=0]="none";z[z.left=
1]="left";z[z.center=2]="center";z[z.right=3]="right";z[z.inner=4]="inner";z[z.outer=5]="outer";z[z.both=6]="both";z[z.distribute=7]="distribute";z[z.margin=8]="margin";z[z.highKashida=9]="highKashida";z[z.lowKashida=10]="lowKashida";z[z.mediumKashida=11]="mediumKashida";z[z.numTab=12]="numTab";z[z.thaiDistribute=13]="thaiDistribute";z[z.start=14]="start";z[z.end=15]="end"})(Ug||(Ug={}));Object(h.b)("Justification",Ug);var ui=d(570);class Uh{constructor(){this.value=this.Sf=0}}Object(h.a)(Uh,"ParagraphSpacingCommandData",
null,[]);class Yi{constructor(){this.suh=this.X4g=this.$4g=this.b5g=!1}}Object(h.a)(Yi,"PptPropertySetChangedState",null,[]);class lh{constructor(z){this.sce=this.Aae=this.qce=this.rce=this.Oae=this.Hae=!1;this.L$b={};this.ia=z;this.nyj()}iTj(z,U,ka){ka&&(z=this.L$b[Ug[ka]],void 0!==z&&null!==z&&(this.ia.processAction(z,2),this.Hae=!0))}eVj(z,U,ka){void 0!==ka&&null!==ka&&(this.ia.La(Qc.a.uma,2,ka),this.Oae=!0)}a5g(z,U,ka,Ba){void 0!==ka&&null!==ka&&(z=lh.oMc(Ba),!z.b5g&&null!==Ba&&Ba.OP.Sa(Sd.a.dEb)&&
Ba.OP.Sa(Sd.a.eEb)&&(U=Ba.OP.getValue(Sd.a.eEb),Ba=Ba.OP.getValue(Sd.a.dEb),z.b5g=!0,this.ia.La(Qc.a.Xgb,2,Object.assign(new Uh,{value:U,Sf:Ba})),this.rce=!0))}Z4g(z,U,ka,Ba){void 0!==ka&&null!==ka&&(z=lh.oMc(Ba),!z.$4g&&null!==Ba&&Ba.OP.Sa(Sd.a.aEb)&&Ba.OP.Sa(Sd.a.bEb)&&(U=Ba.OP.getValue(Sd.a.bEb),Ba=Ba.OP.getValue(Sd.a.aEb),z.$4g=!0,this.ia.La(Qc.a.Wgb,2,Object.assign(new Uh,{value:U,Sf:Ba})),this.qce=!0))}W4g(z,U,ka,Ba){void 0!==ka&&null!==ka&&(U=lh.oMc(Ba),!U.X4g&&null!==Ba&&Ba.OP.Sa(Sd.a.YDb)&&
Ba.OP.Sa(Sd.a.ZDb)&&(z=Ba.OP.getValue(Sd.a.ZDb),Ba=Ba.OP.getValue(Sd.a.YDb),U.X4g=!0,U=new ui.a,U.Sf=Ba,U.value=z,this.ia.La(Qc.a.mja,2,U),this.Aae=!0))}tPe(z,U,ka,Ba){void 0!==ka&&null!==ka&&(ka=lh.oMc(Ba),!ka.suh&&null!==Ba&&Ba.OP.Sa(Sd.a.IIb)&&Ba.OP.Sa(Sd.a.JIb)&&(U=0,Ba.OP.Sa(Sd.a.lfa)&&(U=Ba.OP.getValue(Sd.a.lfa)),z=Ba.OP.getValue(Sd.a.JIb),Ba=Ba.OP.getValue(Sd.a.IIb),ka.suh=!0,ka=0,1===U?ka=Qc.a.EHb:2===U?ka=Qc.a.GHb:0===U&&(ka=Qc.a.IHb),U=new ui.a,U.Sf=Ba,U.value=z,this.ia.La(ka,2,U),this.sce=
!0))}Tml(){return{WHh:this.Hae,XHh:this.Oae,ZHh:this.rce,YHh:this.qce,VHh:this.Aae,$Hh:this.sce}}hyj(){this.sce=this.Aae=this.qce=this.rce=this.Oae=this.Hae=!1}nyj(){this.L$b.left=qd.a.leftJustify;this.L$b.center=qd.a.centerJustify;this.L$b.right=qd.a.rightJustify;this.L$b.both=qd.a.fullJustify}static oMc(z){z.customData||(z.customData=new Yi);return z.customData}}Object(h.a)(lh,"ParagraphLevelPropertyChangedHandlers",null,[574]);var jg=d(524),cj=d(198),oj=d(268),hk=d(338),Vh=d(36),Ji=d(49),Bi=d(81),
Eh=d(165);class rh{constructor(z,U){this.Urb=z;this.Gh=U}}Object(h.a)(rh,"DoNotCheckCritiqueTypeActionData",null,[]);var sg=d(22);class ci{p4a(z){return(z=Object(A.a)(rh,z))?Object(sg.a)(hk.a,z.Gh):!1}Mye(z,U){if(U=Object(A.a)(rh,U)){const ka=U.Gh;ka&&(ka.dKa(z,U.Urb),e.ULS.sendTraceTag(37855319,375,50,"Don't check this critique for whole doc finished, removed errors count: {0}",U.Urb))}}}Object(h.a)(ci,"DoNotCheckCritiqueTypeCallback",null,[655]);var dj=d(458),Zi=d(48);class Ri extends dj.a{constructor(z,
U,ka,Ba,Ia,Ab,Ob){super();this.Use=null;this.init(z);this.Fl("WholePresentationOperation");this.qDa(L.AFrameworkApplication.Ta,U,ka,Ba,Ia);this.Cbb=0;this.xTg=Ob;this.oJg=Ab;this.Pxb=Ia;this.E7b=U;this.p4a()?1===this.behavior&&(this.rp=32,this.$X()):(this.rp=8,this.$X())}run(){0===this.Cbb&&this.pMe();1===this.Cbb&&this.xCe();2===this.Cbb&&this.uRe();3===this.Cbb&&this.SXd()}p4a(){return this.xTg.p4a(this.Pxb)}Mye(){this.xTg.Mye(this.E7b,this.Pxb)}pMe(){this.Use=new Zi.GraphTransaction(3);this.Use.kc(this.oJg.node);
this.Cbb=1}xCe(){this.Ez||this.Ggb(this.oJg.fE);1!==this.Cma()&&(this.Cbb=2)}uRe(){this.Mye();this.Use.dispose();this.Cbb=3}SXd(){this.$X()}}Object(h.a)(Ri,"WholePresentationOperation",dj.a,[]);var Fh=d(52);class Rj{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc){this.kDa=!1;this.ia=z;this.tEg=U;this.EF=ka;this.Fb=Ba;this.jZc=Ia;this.ua=Ab;this.Ea=Ob;this.r9=Ec;this.Qne=Yb;this.mC=uc;this.nb=Yc;this.n$j=mc.Gph;this.V5j=mc.pptProofingRemoveWholeDocTargetCritiquesEnabled;this.h5j=mc.pptHideProofingErrorIsEnabled;
this.Szj()}get ZXb(){return this.EF.LSa?this.jZc.instance:null}ub(){this.ia.pa(Qc.a.Jhc,Fh.a.application,Object(v.a)(this,this.Jhc,"queryLanguage"),96);this.ia.pa(Qc.a.$3g,Fh.a.application,Object(v.a)(this,this.Ssk,"openPPTLanguageDialogView"),4);this.EF.gwg&&this.ia.pa(qd.a.BRc,xc.a.Of,Object(v.a)(this,this.BRc,"ignoreProofingError"),4);this.EF.I$d&&(this.V5j?(this.ia.ya(qd.a.UYb,xc.a.paragraph,Object(v.a)(this,this.TZf,"doNotCheckThisCritiqueTypeForNode")),this.ia.ya(qd.a.UYb,xc.a.section,Object(v.a)(this,
this.TZf,"doNotCheckThisCritiqueTypeForNode")),this.ia.qV(qd.a.UYb,xc.a.Of,Object(v.a)(this,this.ZJi,"doNotCheckThisCritiqueTypeForWholeDoc"),4),this.ia.pa(Qc.a.VYb,xc.a.Of,Object(v.a)(this,this.VYb,"doNotCheckThisCritiqueTypeForCurrentSlide"),4)):this.ia.pa(qd.a.UYb,xc.a.Of,Object(v.a)(this,this.VYb,"doNotCheckThisCritiqueTypeForCurrentSlide"),4));this.h5j&&(this.ia.pa(Qc.a.hDe,Fh.a.application,Object(v.a)(this,this.hDe,"queryHideProofingErrors"),100),this.ia.pa(Qc.a.Huj,Fh.a.application,Object(v.a)(this,
this.Sol,"toggleHideProofingErrors"),4))}xe(){}Szj(){this.kDa=Rj.E6d;e.ULS.sendTraceTag(37237070,375,50,"Initialized with hide proofing errors: {0}",this.kDa);this.kDa&&this.pmg(this.kDa)}hDe(z,U,ka,Ba,Ia){if(1===ka)return 32;if(!Ia)return 8;Ia[jg.a.On]=this.kDa;return 32}Sol(z,U,ka,Ba,Ia){if(1===ka)return 32;if(!(Ia&&jg.a.On in Ia))return 8;this.kDa=Ia[jg.a.On];Rj.E6d=this.kDa;this.pmg(this.kDa);e.ULS.sendTraceTag(37237071,375,50,"User hide proofing errors: {0}",this.kDa);return 32}TZf(z,U,ka,Ba,
Ia){if(!U)return 8;z=U.node;if(!z)return 8;if(U.contextId===xc.a.section&&!z.sa(Eh.a.nvg,!1))return 32;if(U.contextId===xc.a.paragraph&&z.sa(Eh.a.Lca,!1)){U=Object(A.a)(rh,Ia);if(!U)return 8;Ia=U.Gh;if(!Ia)return 8;U.Urb+=this.Beh(z,Ia.typeId,Ia.lcid)}return 2}ZJi(z,U,ka,Ba,Ia){var Ab=this.b3i();Ab=new rh(0,Ab);this.ia.ki(ka,Qc.a.VYb,Ba,!1,Ia,Ab);ka=Ji.a.create(Object(A.a)(Bi.a,this.ua.presentation));e.ULS.sendTraceTag(37012126,375,50,"User click do not check this critique for whole doc with behavior: {0}",
Ba);return new Ri(z,U,Ba,Ia,Ab,ka,new ci)}VYb(z,U,ka,Ba,Ia){z=Object(A.a)(rh,Ia);if(!z)return 8;Ba=z.Gh;if(!Ba)return 8;if(1===ka)return 32;if(!U.node)return 8;e.ULS.sendTraceTag(36790874,375,50,"Don't check this critique triggerred, language id: {0}, critique type id: {1}",Ba.lcid,Ba.typeId);z.Urb+=this.yQk(Ba.typeId,Ba.lcid);this.ZXb&&this.ZXb.HIi(Ba.lcid.toString(),Ba.typeId);return 32}BRc(z,U,ka){if(1===ka)return 32;e.ULS.sendTraceTag(36790875,375,50,"Ignore proofing error triggerred");ka=this.mC.KQa(U);
if(!ka||!ka.Gh)return 8;U=U.node;var Ba=this.ua.Ba;if(!U||!Ba)return 8;Ba=this.Fb.ke(Rj.Cij(ka));try{Ba.kc(U),this.mC.tIa(U,[ka],!0),U.setValue(Vh.a.nSf,!0)}finally{Ba&&Ba.dispose()}ka.Gh.dKa(z,1);this.nb.USa()||Vf.a.LO(!0,!1);e.ULS.sendTraceTag(36790876,375,50,"Ignore proofing error action succeeded");return 32}pmg(z){this.r9.fNe=z}b3i(){var z=this.nb.Oa.kb;if(!z)return null;z=this.mC.KQa(z.Ua);if(!z||!z.Gh)return null;z=Object(A.a)(hk.a,z.Gh);return!z||0>=z.lcid?null:z}yQk(z,U){const ka=new Date;
if(!this.ua.Ba)return 0;const Ba=this.ua.Ba.jl();if(!Ba)return 0;let Ia=0,Ab=0;const Ob=this.Fb.ke(3);try{Ob.kc(this.ua.Ba);for(const Yb of Ba)this.Ea.kJ(Yb,uc=>{++Ab;uc.Sa(Vh.a.iq)&&uc.sa(Eh.a.Lca,!1)&&(Ia+=this.Beh(uc,z,U))})}finally{Ob&&Ob.dispose()}e.ULS.sendTraceTag(36825112,375,50,"Remove proofing error take time(ms): {0}, scanned paragraph count: {1}, scanned shape count: {2}, removed errors count: {3}",+new Date-+ka,Ab,Ba.length,Ia);return Ia}Beh(z,U,ka){const Ba=this.mC.iF(z,Ia=>{Ia=Object(A.a)(hk.a,
Ia.Gh);return!!Ia&&Ia.typeId===U&&Ia.lcid===ka});if(cj.a.Va(Ba))return 0;this.mC.tIa(z,Ba);return Ba.length}Jhc(z,U,ka,Ba,Ia){Ia.rDc=this.a8i();return 32}a8i(){let z=L.AFrameworkApplication.lcid;if(this.nb.$Z(this.nb.Oa)){var U=this.nb.Yd();if(1<U.length||1!==U.length)return"";U=this.Ea.QQa(U[0]);0<U&&(z=U)}else this.nb.Oa.kb&&(U=this.Qne.TNc(this.nb.Kj),0<U&&(z=U));return oj.a.oe(z)?oj.a.oe(z).displayName:oj.a.oe(L.AFrameworkApplication.lcid).displayName}vPj(){const z=this.nb.Yd();return 1===z.length&&
z[0].hVc}Ssk(z,U,ka){if(2!==ka)return 32;this.n$j&&this.nb.$Z(this.nb.Oa)&&this.vPj()?(e.ULS.sendTraceTag(8955537,806,50,"Set proofing language on shape level."),this.tEg.value.getInstance(!0).gmc()):this.nb.Oa.kb&&(e.ULS.sendTraceTag(8955536,806,50,"Set proofing language in text edit view."),this.tEg.value.getInstance(!1).gmc());return 32}static get E6d(){const z=bb.a.get("PowerPointHideProofingErrors");return z?"true"===z.toLowerCase():!1}static set E6d(z){bb.a.aM("PowerPointHideProofingErrors",
z.toString(),30)||e.ULS.sendTraceTag(37237069,375,10,"Failed to set cookie for hide proofing errors to {0}",z.toString())}static Cij(z){return 1===z.Gh.proofingType?15:3}}Object(h.a)(Rj,"ProofingActor",null,[229]);var mh=d(290),va=d(774);class Qa{constructor(z,U){this.Pe=z.toLowerCase();this.variant=U}}Object(h.a)(Qa,"ThemeVariant",null,[]);var db=d(37);class Gb{constructor(z,U,ka){this.XWd=z;this.eCh=U;this.tWe=ka}}Object(h.a)(Gb,"ThemeData",null,[]);class jc{}jc.DJa=[new Gb("62f939b6-93af-4db8-9c6b-d6c7dfdc589f",
"OfficeTheme",4),new Gb("b8441adb-2e43-4af7-b97a-bd870242c6a8","Ion",4),new Gb("28cdc826-8792-45c0-861b-85eb3adeda33","Organic",4),new Gb("f226e7a2-7162-461c-9490-d27d9dc04e43","Frame",4),new Gb("fc33163d-4339-46b1-8eed-24c834239d99","IonBoardroom",4),new Gb("789ec3fe-34fd-429c-9918-760025e6c145","Mesh",4),new Gb("5f128b03-dcca-4eeb-ab3b-cf2899314a46","Retrospect",8),new Gb("0507925b-6ac9-4358-8e18-c330545d08f8","Slice",4),new Gb("1306e473-ed32-493b-a2d0-240a757edd34","Savon",4),new Gb("98dff888-2449-4d28-977c-6306c017633e",
"Banded",4),new Gb("39ec5628-30ed-4578-acd8-9820edb8e15a","Quotable",4),new Gb("7acabc62-bf99-48cf-a9dc-4db89c7b13dc","WoodType",4),new Gb("5665723a-49ba-4b57-8411-a56f8f207965","Basis",4),new Gb("3577f8c9-a904-41d8-97d2-fd898f53f20e","Integral",8),new Gb("7cb32d59-10c0-40dd-b7bd-2e94284a981c","Wisp",4),new Gb("9697a71b-4ab7-4a1a-bd5b-bb2d22835b57","Dividend",4),new Gb("c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5","Celestial",4),new Gb("3388167b-a2eb-4685-9635-1831d9aef8c4","Parallax",4),new Gb("4c5440d6-04d2-4954-96cf-f251137069b2",
"Metropolitan",8),new Gb("c0c680cd-088a-49fc-a102-d699147f32b2","Facet",4),new Gb("ba0eb5a6-f2d4-4f82-977b-64adee4a2a69","View",4),new Gb("5156b0e4-0eb1-49fe-a26b-15f6f698aec6","Atlas",4),new Gb("025cb5fb-2dd3-45ee-b6f0-cc461540eb19","Madison",4)];Object(h.a)(jc,"DesignManager_data",null,[]);class Ac{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc){this.SZc=null;this.TZc=0;this.cIg=this.RZc=!1;this.IMg=null;this.yVb=new Qa("",0);this.BSg={["ThemesOfficeTheme"]:"62f939b6-93af-4db8-9c6b-d6c7dfdc589f",
["ThemesIon"]:"b8441adb-2e43-4af7-b97a-bd870242c6a8",["ThemesAtlas"]:"5156b0e4-0eb1-49fe-a26b-15f6f698aec6",["ThemesMadison"]:"025cb5fb-2dd3-45ee-b6f0-cc461540eb19",["ThemesOrganic"]:"28cdc826-8792-45c0-861b-85eb3adeda33",["ThemesFrame"]:"f226e7a2-7162-461c-9490-d27d9dc04e43",["ThemesIonBoardroom"]:"fc33163d-4339-46b1-8eed-24c834239d99",["ThemesMesh"]:"789ec3fe-34fd-429c-9918-760025e6c145",["ThemesRetrospect"]:"5f128b03-dcca-4eeb-ab3b-cf2899314a46",["ThemesSlice"]:"0507925b-6ac9-4358-8e18-c330545d08f8",
["ThemesSavon"]:"1306e473-ed32-493b-a2d0-240a757edd34",["ThemesBanded"]:"98dff888-2449-4d28-977c-6306c017633e",["ThemesQuotable"]:"39ec5628-30ed-4578-acd8-9820edb8e15a",["ThemesWoodType"]:"7acabc62-bf99-48cf-a9dc-4db89c7b13dc",["ThemesBasis"]:"5665723a-49ba-4b57-8411-a56f8f207965",["ThemesIntegral"]:"3577f8c9-a904-41d8-97d2-fd898f53f20e",["ThemesWisp"]:"7cb32d59-10c0-40dd-b7bd-2e94284a981c",["ThemesDividend"]:"9697a71b-4ab7-4a1a-bd5b-bb2d22835b57",["ThemesCelestial"]:"c4bb2a3d-0e93-4c5f-b0d2-9d3fce089cc5",
["ThemesParallax"]:"3388167b-a2eb-4685-9635-1831d9aef8c4",["ThemesMetropolitan"]:"4c5440d6-04d2-4954-96cf-f251137069b2",["ThemesFacet"]:"c0c680cd-088a-49fc-a102-d699147f32b2",["ThemesViewTheme"]:"ba0eb5a6-f2d4-4f82-977b-64adee4a2a69"};this.ia=z;this.Fa=U;this.Xb=ka;this.ra=Ia;this.Fb=Ba;this.Zb=Ob;this.ua=Yb;this.uc=uc;this.Uak=mc;this.u5j=Ec;this.zKg=Yc}ub(){this.ia.pa(Qc.a.l4a,Fh.a.application,Object(v.a)(this,this.Mkg,"handleThemeChange"),4);this.ia.pa(Qc.a.vOa,Fh.a.application,Object(v.a)(this,
this.Mkg,"handleThemeChange"),4);this.ia.pa(Qc.a.Bcd,Fh.a.application,Object(v.a)(this,this.Bcd,"queryMoreThemeGallery"),96);this.ia.pa(Qc.a.tDe,Fh.a.application,Object(v.a)(this,this.tDe,"queryMoreVariantGallery"),96);this.ia.pa(Qc.a.tdd,Fh.a.application,Object(v.a)(this,this.tdd,"queryThemes"),97);this.ia.pa(Qc.a.sdd,Fh.a.application,Object(v.a)(this,this.sdd,"queryThemeVariants"),97);this.ia.pa(Qc.a.VAe,Fh.a.application,Object(v.a)(this,this.VAe,"populateVariantGallery"),96)}xe(){}tdd(z,U,ka,Ba,
Ia){Ia&&Ia.tU&&(z=this.BSg[Ia.tU]===this.BCa().Pe,Ia.tXa.Nf(z));return 32}sdd(z,U,ka,Ba,Ia){if(Ia&&Ia.tU){z=this.BCa();U=z.Pe;ka=Ia.tU;try{var Ab=Number.parseInvariant(ka.substring(ka.length-1,ka.length))}catch(Ob){Ab=0}Ia=Ia.tXa;Ia.Nf(z.variant===Ab);Ab=Ac.r8f(ka,Ab,U);Ia.J2=Ab}return 32}Bcd(z,U,ka){if(U.contextId!==xc.a.application)return 2;z=this.ra.rn();var Ba=this.BCa();U=Ac.a2b(Ba.Pe);Ba=Ba.variant-1;return this.Xb.Zc(z)?16:1!==ka||(e.ULS.sendTraceTag(512499972,801,50,"ThemeActor.QueryMoreThemeGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",
U,Ba),this.uc.Hj())?32:8}tDe(z,U,ka){if(U.contextId!==xc.a.application)return 2;var Ba=this.ra.rn();U=this.BCa();z=Ac.a2b(U.Pe);U=U.variant-1;if(this.Xb.Zc(Ba))return 16;if(1===ka)if(ka=Ac.f2b(this.BCa().Pe),Ba=this.Uak.sSj(ka),ka&&Ba)e.ULS.sendTraceTag(512499971,801,50,"ThemeActor.QueryMoreVariantGallery: Dropdown menu opened. CurrentTheme={0} CurrentVariant={1}",z,U);else return 16;return 32}Mkg(z,U,ka,Ba,Ia){U=this.ra.nf();Ba=this.ua.Ba;if(!Ba||z===Qc.a.vOa&&this.BCa()===this.yVb||this.Xb.Zc(Ba))return 16;
if(1===ka)return 32;ka=Object(A.a)(String,Ia);if(null===ka)return 8;Ia=this.BSg[ka];return z===Qc.a.l4a?this.$wk(Ba,Ia,U):z===Qc.a.vOa?this.axk(Ba,ka):8}$wk(z,U,ka){if(!z)return 16;1>=this.zTf()||this.zKg&&ka&&1<ka.length?(this.AKd(z,U,0,!1,ka),e.ULS.sendTraceTag(512499968,801,50,"ThemeActor.PerformChangeTheme: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Ac.a2b(U),0,z.Bb.sid)):(this.SZc=U,this.TZc=0,this.RZc=!1,z=new Zb.StandardDialog,z.yd=1,z.DO(ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_MultipleMainMastersMessage,
Object(v.a)(this,this.BOf,"changeThemeHandler")));return 32}axk(z,U){if(!z)return 16;const ka=this.BCa();let Ba;try{if(Ba=Number.parseInvariant(U.substring(7,U.length))-1,0>Ba||Ba>Ac.f2b(ka.Pe))Ba=-1}catch(Ia){Ba=-1}1>=this.zTf()?(this.AKd(z,ka.Pe,Ba,!0,null),e.ULS.sendTraceTag(512499939,801,50,"ThemeActor.PerformChangeVariant: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Ac.a2b(ka.Pe),Ba,z.Bb.sid)):(this.SZc=ka.Pe,this.TZc=Ba,this.RZc=!0,z=new Zb.StandardDialog,z.yd=1,z.DO(ResourceStrings.l_GenericDialogTitle,
ResourceStrings.l_MultipleMainMastersMessage,Object(v.a)(this,this.BOf,"changeThemeHandler")));return 32}BCa(){let z=null;var U=this.ua.Ba;if(U){U=U.pj;const Ba=this.uc.hI();if(Ba&&U)for(var ka of Ba)if(ka.Id===U){z=ka;break}}if(!z)return this.cIg?this.IMg:this.yVb;if(!z.ThemeFamilyId||z.ThemeFamilyId===Ac.aji)return this.yVb;ka="5156b0e4-0eb1-49fe-a26b-15f6f698aec6"===z.ThemeFamilyId||"025cb5fb-2dd3-45ee-b6f0-cc461540eb19"===z.ThemeFamilyId;return!this.u5j&&ka?this.yVb:new Qa(z.ThemeFamilyId,z.VariantIndex+
1)}zTf(){const z=this.uc.hI();let U=0;if(z)for(const ka of z)ka.InContent&&(U+=1);return U}BOf(z){const U=this.ua.Ba;if(U){var ka=this.SZc,Ba=this.TZc,Ia=this.RZc;this.SZc=null;this.TZc=-1;this.RZc=!1;1===z&&(this.AKd(U,ka,Ba,Ia,null),e.ULS.sendTraceTag(512499936,801,50,"ThemeActor.ChangeThemeHandler: ThemeName={0} SelectedVariant={1} SlideId.Sid={2}",Ac.a2b(ka),Ba,U.Bb.sid))}}AKd(z,U,ka,Ba,Ia){this.IMg=(this.cIg=Ba)?new Qa(U,0):this.yVb;const Ab=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()},
void 0,!0);try{if(Ab.kc(z),Ab.fd=Ba?Qc.a.vOa:Qc.a.l4a,this.zKg&&Ia)for(const Ob of Ia)Ob.setValue(db.a.iSe,U),Ob.setValue(db.a.W$,ka),Ob.setValue(db.a.ebi,1<Ia.length);else z.setValue(db.a.iSe,U),z.setValue(db.a.W$,ka)}finally{Ab&&Ab.dispose()}this.Xb.fVb(this.Zb.yf,z,"ChangeTheme")}VAe(z,U,ka,Ba,Ia){if(1===ka)return 32;z=Math.max(Ac.f2b(this.BCa().Pe),4);U=this.BCa().Pe;Ia.MenuItems=Ac.pcj(z,U);return 32}static f2b(z){for(let U=0;U<jc.DJa.length;++U)if(jc.DJa[U].XWd===z)return jc.DJa[U].tWe;return 0}static a2b(z){for(let U=
0;U<jc.DJa.length;++U)if(jc.DJa[U].XWd===z)return jc.DJa[U].eCh;return Ac.xji}static WRi(z){let U="";for(let ka=0;ka<jc.DJa.length;++ka)jc.DJa[ka].XWd===z&&(U=jc.DJa[ka].eCh.replace(" ",""));return U}static pcj(z,U){const ka=Object.assign(new jh.a,{Id:"PptRibbon.Design.ThemeVariants.Anchor.Menu",MenuSectionList:[]});var Ba=Object.assign(new mh.a,{Id:"PptRibbon.Design.ThemeVariants.MenuSection",DisplayMode:"Size85by48",ControlList:[]});Array.add(ka.MenuSectionList,Ba);const Ia=Object.assign(new va.a,
{Id:"PptRibbon.Design.ThemeVariants.Gallery",ExternalId:"MoreVariantsSection",ExternalGalleryId:"MoreVariantsGallery",Type:4,Width:4,ElementDimensions:"Size85by48",GalleryItems:[]});Array.add(Ba.ControlList,Ia);for(Ba=1;Ba<=z;++Ba)Array.add(Ia.GalleryItems,Ac.r8f("Variant"+Ba,Ba,U));return ka}static r8f(z,U,ka){ka=!Ac.f2b(ka)||U>Ac.f2b(ka)?"EmptyVariantsGallery_85x48x8":String.format("ThemeVariantGallery{0}{1}_85x48x24",Ac.WRi(ka),U);return Object.assign(new yg.a,{Id:z,ExternalId:z,Icon:ka,Alt:String.format(ResourceStrings.L_ThemeVariantAlt,
U),PreviewIconStyle:{root:{width:"49px",height:"28px",margin:"-2px"}},FullIconStyle:{root:{width:"85px",height:"48px"}},Command:"2759977169",QueryCommand:"1425701611"})}}Ac.aji="00000000-0000-0000-0000-000000000000";Ac.xji="Unsupported Theme";Object(h.a)(Ac,"ThemeActor",null,[229]);var W=d(466);class xa{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec){this.ia=z;this.Zb=U;this.ua=ka;this.ra=Ia;this.Fa=Ab;this.Fb=Ba;this.Ym=Ob;this.Xb=Yb;this.ELg=uc.uMj;this.ep=uc.Ly;this.K5j=uc.yNj;this.abc=mc.hk(Dd.a.Kad);
this.Mb=Ec}ub(){this.K5j?(this.ELg?(this.ia.pa(Qc.a.exa,xc.a.application,Object(v.a)(this,this.E7k,"setSlidesTransitionGalleryExceptExisting"),5),this.ia.pa(Qc.a.Jea,xc.a.application,Object(v.a)(this,this.EFk,"querySlidesTransitionGalleryExceptExisting"),97),this.ia.pa(Qc.a.fxa,xc.a.application,Object(v.a)(this,this.F7k,"setSlidesTransitionGalleryExisting"),5),this.ia.pa(Qc.a.iJa,xc.a.application,Object(v.a)(this,this.G7k,"setSlidesTransitionGalleryExistingInMenu"),5),this.ia.pa(Qc.a.uwa,xc.a.application,
Object(v.a)(this,this.FFk,"querySlidesTransitionGalleryExisting"),97),this.ia.pa(Qc.a.gIa,xc.a.application,Object(v.a)(this,this.GFk,"querySlidesTransitionGalleryExistingInMenu"),97)):(this.ia.pa(Qc.a.exa,xc.a.application,Object(v.a)(this,this.FLe,"setSlidesTransitionGallery"),5),this.ia.pa(Qc.a.Jea,xc.a.application,Object(v.a)(this,this.NDe,"querySlidesTransitionGallery"),97),this.ia.pa(Qc.a.fxa,xc.a.application,Object(v.a)(this,this.FLe,"setSlidesTransitionGallery"),5),this.ia.pa(Qc.a.iJa,xc.a.application,
Object(v.a)(this,this.FLe,"setSlidesTransitionGallery"),5),this.ia.pa(Qc.a.uwa,xc.a.application,Object(v.a)(this,this.NDe,"querySlidesTransitionGallery"),97),this.ia.pa(Qc.a.gIa,xc.a.application,Object(v.a)(this,this.NDe,"querySlidesTransitionGallery"),97)),this.ia.pa(Qc.a.qid,xc.a.application,Object(v.a)(this,this.D7k,"setSlidesTransitionEffectOption"),5),this.ia.pa(Qc.a.$De,xc.a.application,Object(v.a)(this,this.CFk,"querySlidesTransitionEffectOption"),97),this.ia.pa(Qc.a.oFb,xc.a.application,Object(v.a)(this,
this.DFk,"querySlidesTransitionEffectOptionsAnchor"),100),this.ia.pa(Qc.a.zgc,xc.a.application,Object(v.a)(this,this.$yk,"populateSlidesTransitionEffectOptions"),96),this.ia.pa(Qc.a.fIa,xc.a.application,Object(v.a)(this,this.BFk,"querySlidesTransitionDuration"),97),this.ia.pa(Qc.a.PHb,xc.a.application,Object(v.a)(this,this.C7k,"setSlidesTransitionDuration"),5)):(this.ELg?(this.ia.pa(Qc.a.exa,xc.a.application,Object(v.a)(this,this.v8k,"setTransitionGalleryExceptExisting"),5),this.ia.pa(Qc.a.Jea,xc.a.application,
Object(v.a)(this,this.XFk,"queryTransitionGalleryExceptExisting"),97),this.ia.pa(Qc.a.fxa,xc.a.application,Object(v.a)(this,this.w8k,"setTransitionGalleryExisting"),5),this.ia.pa(Qc.a.iJa,xc.a.application,Object(v.a)(this,this.x8k,"setTransitionGalleryExistingInMenu"),5),this.ia.pa(Qc.a.uwa,xc.a.application,Object(v.a)(this,this.uwa,"queryTransitionGalleryExisting"),97),this.ia.pa(Qc.a.gIa,xc.a.application,Object(v.a)(this,this.gIa,"queryTransitionGalleryExistingInMenu"),97)):(this.ia.pa(Qc.a.exa,
xc.a.application,Object(v.a)(this,this.SLe,"setTransitionGallery"),5),this.ia.pa(Qc.a.Jea,xc.a.application,Object(v.a)(this,this.Jea,"queryTransitionGallery"),97),this.ia.pa(Qc.a.fxa,xc.a.application,Object(v.a)(this,this.SLe,"setTransitionGallery"),5),this.ia.pa(Qc.a.iJa,xc.a.application,Object(v.a)(this,this.SLe,"setTransitionGallery"),5),this.ia.pa(Qc.a.uwa,xc.a.application,Object(v.a)(this,this.Jea,"queryTransitionGallery"),97),this.ia.pa(Qc.a.gIa,xc.a.application,Object(v.a)(this,this.Jea,"queryTransitionGallery"),
97)),this.ia.pa(Qc.a.qid,xc.a.application,Object(v.a)(this,this.u8k,"setTransitionEffectOption"),5),this.ia.pa(Qc.a.$De,xc.a.application,Object(v.a)(this,this.WFk,"queryTransitionEffectOption"),97),this.ia.pa(Qc.a.oFb,xc.a.application,Object(v.a)(this,this.oFb,"queryTransitionEffectOptionsAnchor"),100),this.ia.pa(Qc.a.zgc,xc.a.application,Object(v.a)(this,this.zgc,"populateTransitionEffectOptions"),96),this.ia.pa(Qc.a.fIa,xc.a.application,Object(v.a)(this,this.fIa,"queryTransitionDuration"),97),this.ia.pa(Qc.a.PHb,
xc.a.application,Object(v.a)(this,this.PHb,"setTransitionDuration"),5));this.ia.pa(Qc.a.OHb,xc.a.application,Object(v.a)(this,this.OHb,"setTransitionApplyAll"),4);this.ia.pa(Qc.a.Jic,xc.a.application,Object(v.a)(this,this.Jic,"queryTransitionApplyAll"),96)}xe(){}zgc(z,U,ka,Ba,Ia){if(this.ep&&1!==this.ra.nf().length)return 16;if(1===ka)return 32;z=(z=this.ua.Ba)?z.Mo:null;if(!z)return 16;if(!Ia)return 8;z=this.Ym.iub(z);z.next&&(Ia.MenuItems=this.sLf(z));return 32}Jea(z,U,ka,Ba,Ia){if(!Ia)return 8;
z=Ia.queryResult;Ia=Ia.SourceControlId;U=this.Ym.WP(Ia);if(!U)return 8;z.qCa=xa.fZd(U.sc,U.nc,this.abc);U=this.ua.Ba;if(!U)return 16;1===ka&&((ka=U.Mo)?(ka=this.Ym.kRa(ka),z.pU(!ka&&"TransitionExisting"===Ia||ka===Ia)):z.pU("TransitionNone"===Ia));return 32}XFk(z,U,ka,Ba,Ia){if(!Ia||z!==Qc.a.Jea)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;U=this.Ym.WP(Ia);if(!U)return 8;Ba=U.sc.split("_")[1]+"_24";U=xa.tQa(Ia,Ia,Ba,"2024601249","149145197",U.nc,U.nc);z.J2=U;U=this.ua.Ba;if(!U)return 16;1===ka&&
((ka=U.Mo)?(ka=this.Ym.kRa(ka),z.pU(ka===Ia)):z.pU("TransitionNone"===Ia));return 32}uwa(z,U,ka,Ba,Ia){if(!Ia||z!==Qc.a.uwa)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;if(!Ia||"TransitionExisting"!==Ia)return 16;U=this.Ym.WP(Ia);if(!U)return 8;Ba=U.sc.split("_")[1]+"_24";U=xa.tQa(Ia,Ia,Ba,"3752636652","3476251476",U.nc,U.nc);z.J2=U;U=this.ua.Ba;if(!U)return 16;if(1===ka&&(ka=U.Mo)){ka=this.Ym.kRa(ka);U=this.Ym.aWc(ka,this.Ym.utb());if(ka&&!U){Ba=this.Ym.WP(ka);if(!Ba)return 8;const Ab=Ba.sc.split("_")[1]+
"_24";Ia=xa.tQa(Ia,Ia,Ab,"3752636652","3476251476",Ba.nc,Ba.nc);z.J2=Ia}z.pU(!ka||!!ka&&!U)}return 32}gIa(z,U,ka,Ba,Ia){if(!Ia||z!==Qc.a.gIa)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;if(!Ia||"TransitionExistingInMenu"!==Ia)return 16;U=this.Ym.WP(Ia);if(!U)return 8;Ba=U.sc.split("_")[1]+"_24";Ia=xa.tQa(Ia,Ia,Ba,"4036532528","2831233208",U.nc,U.nc);z.J2=Ia;Ia=this.ua.Ba;if(!Ia)return 16;1===ka&&(ka=Ia.Mo)&&(ka=this.Ym.kRa(ka),z.pU(!ka));return 32}oFb(z,U,ka){z=this.ua.Ba;if(!z)return 16;z=this.Ym.iub(z.Mo);
return!z||!z.next||this.ep&&1!==this.ra.nf().length?16:1===ka?32:8}SLe(z,U,ka,Ba,Ia){if(!Ia)return 8;U=Ia.SourceControlId;Ia=z===Qc.a.fxa||z===Qc.a.iJa;Ba=this.ua.Ba;if(!Ba||this.Xb.Zc(Ba)||this.ep&&1!==this.ra.nf().length)return 16;var Ab=Ba.Mo;const Ob=!!this.Ym.jRa(Ab);if(Ia&&(!Ab||Ob))return 16;if(1===ka)return 32;Ab=this.Ym.WP(U);if(!Ab)return 8;if(!Ia&&2===ka&&U){Vf.a.qk("SlideCount","1");ka=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{ka.kc(Ba),ka.fd=z,Ba.Mo=Ab.qc}finally{ka&&
ka.dispose()}e.ULS.sendTraceTag(512499935,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",U,Ab.next||"null",Ba.Bb.sid)}return 32}v8k(z,U,ka,Ba,Ia){if(!Ia)return 8;U=Ia.SourceControlId;Ba=this.ua.Ba;if(!Ba)return 16;if(z!==Qc.a.exa)return 8;if(this.Xb.Zc(Ba)||this.ep&&1!==this.ra.nf().length)return 16;if(1===ka)return 32;Ia=this.Ym.WP(U);if(!Ia)return 8;if(2===ka&&U){Vf.a.qk("SlideCount","1");ka=this.Fb.ud(15,void 0,()=>{this.ra.kj();
this.Fa.Ad()});try{ka.kc(Ba),ka.fd=z,Ba.Mo=Ia.qc}finally{ka&&ka.dispose()}e.ULS.sendTraceTag(512499934,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",U,Ia.next||"null",Ba.Bb.sid)}return 32}w8k(z,U,ka,Ba,Ia){if(!Ia)return 8;U=this.ua.Ba;if(!U)return 16;if(z!==Qc.a.fxa)return 8;if(this.ep&&1!==this.ra.nf().length)return 16;if(1!==ka)return 8;z=U.Mo;ka=!!this.Ym.jRa(z);U=this.Ym.iub(z);U=this.Ym.aWc(U?U.parent:null,this.Ym.utb());
return z&&!ka||!U?32:16}x8k(z,U,ka,Ba,Ia){if(!Ia)return 8;U=this.ua.Ba;if(!U)return 16;if(z!==Qc.a.iJa)return 8;if(this.ep&&1!==this.ra.nf().length)return 16;if(1!==ka)return 8;z=U.Mo;ka=!!this.Ym.jRa(z);return!z||ka?16:32}OHb(z,U,ka){U=this.ua.Ba;if(!U||this.Xb.Zc(U)||this.ep&&1!==this.ra.nf().length)return 16;if(1===ka)return 32;Vf.a.qk("SlideCount","1");ka=this.Zb.yf;const Ba=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{Ba.kc(ka),Ba.fd=z,ka.Gob=U.Bb}finally{Ba&&Ba.dispose()}e.ULS.sendTraceTag(512499933,
801,50,"TransitionActor: Command=SetTransitionApplyAll");return 32}Jic(z,U,ka,Ba,Ia){z=this.ua.Ba?!0:!1;if(!Ia)return 8;Ia=Ia.queryResult;Ia.qCa=xa.fZd("pegal_TransitionNewsFlash_32x32x32",ResourceStrings.L_TransitionApplyAll,this.abc);Ia.pU(z);return z?32:16}u8k(z,U,ka,Ba,Ia){if(!Ia)return 8;U=Ia.MenuItemId;if(this.ep&&1!==this.ra.nf().length)return 16;if(1===ka)return 32;ka=this.ua.Ba;if(!ka||this.Xb.Zc(ka))return 16;Ba=ka?ka.Mo:null;Ia=this.Ym.WP(U);if(!Ba||!Ia||!Ia.qc)return 16;Ba.TransitionType=
Ia.qc.TransitionType;Ba.Direction=Ia.qc.Direction;Ba.Duration=Ia.qc.Duration;Vf.a.qk("SlideCount","1");const Ab=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{Ab.kc(ka),Ab.fd=z,ka.Mo=Ba}finally{Ab&&Ab.dispose()}e.ULS.sendTraceTag(512499932,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}, SlideId.Sid={2}",Ia.parent,U,ka.Bb.sid);return 32}WFk(z,U,ka,Ba,Ia){if(!Ia)return 8;z=Ia.queryResult;Ia=Ia.MenuItemId;U=this.ua.Ba;if(!U)return 16;
1===ka&&z.Nf(this.Ym.jRa(U.Mo)===Ia);return 32}fIa(z,U,ka,Ba,Ia){z=this.ua.Ba;if(!z)return 16;if(!Ia)return 8;z=z.Mo;if(Ia=Ia.queryResult)Ia.C$=z?(z.Duration/1E3).toString():"0";return 32}PHb(z,U,ka,Ba,Ia){U=this.ua.Ba;if(!U||this.Xb.Zc(U))return 16;if(!Ia)return 8;if(this.ep&&1!==this.ra.nf().length)return 16;Ba=Math.floor(1E3*Ia.Number);Ia=U.Mo;if(!Ia)return 16;Vf.a.Eb&&(Vf.a.Eb.actionName="SetTransitionDuration");if(1===ka)return"TransitionNone"===this.Ym.kRa(Ia)?16:32;if(2===ka){Ia.Duration=Ba;
const Ab=this.Fa.ze;Vf.a.qk("SlideCount","1");ka=this.Fb.ud(15,void 0,()=>{this.ra.kj();!Ab||Ab.name!==tf.a.Bg&&Ab.name!==tf.a.HC||this.Fa.Ad()});try{ka.kc(U),ka.fd=z,U.Mo=Ia}finally{ka&&ka.dispose()}}return 32}$yk(z,U,ka,Ba,Ia){if(1===ka)return 32;if(!Ia)return 8;U=this.ra.nf();if(!U||!U.length)return 16;z=U[0].Mo;if(!z)return 16;z=this.Ym.iub(z);if(1<U.length)for(const Ab of U){U=Ab.Mo;if(!U)return 16;U=this.Ym.iub(U);if(z.parent!==U.parent)return 16}z.next&&(Ia.MenuItems=this.sLf(z));return 32}NDe(z,
U,ka,Ba,Ia){if(!Ia)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;U=this.Ym.WP(Ia);if(!U)return 8;z.qCa=xa.fZd(U.sc,U.nc,this.abc);U=this.ra.nf();if(!U||!U.length)return 16;1===ka&&(ka="",({Lna:ka}=this.tPa(U)).returnValue&&z.pU(!ka&&"TransitionExisting"===Ia||ka===Ia));return 32}EFk(z,U,ka,Ba,Ia){if(!Ia||z!==Qc.a.Jea)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;U=this.Ym.WP(Ia);if(!U)return 8;Ba=U.sc.split("_")[1]+"_24";U=xa.tQa(Ia,Ia,Ba,"2024601249","149145197",U.nc,U.nc);z.J2=U;U=this.ra.nf();
if(!U||!U.length)return 16;1===ka&&(ka="",({Lna:ka}=this.tPa(U)).returnValue&&z.pU(ka===Ia));return 32}FFk(z,U,ka,Ba,Ia){if(!Ia||z!==Qc.a.uwa)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;if(!Ia||"TransitionExisting"!==Ia)return 16;U=this.Ym.WP(Ia);if(!U)return 8;Ba=U.sc.split("_")[1]+"_24";U=xa.tQa(Ia,Ia,Ba,"3752636652","3476251476",U.nc,U.nc);z.J2=U;U=this.ra.nf();if(!U||!U.length)return 16;if(1===ka&&(ka="",({Lna:ka}=this.tPa(U)).returnValue)){U=this.Ym.aWc(ka,this.Ym.utb());if(ka&&!U){Ba=this.Ym.WP(ka);
if(!Ba)return 8;const Ab=Ba.sc.split("_")[1]+"_24";Ia=xa.tQa(Ia,Ia,Ab,"3752636652","3476251476",Ba.nc,Ba.nc);z.J2=Ia}z.pU(!ka||!!ka&&!U)}return 32}GFk(z,U,ka,Ba,Ia){if(!Ia||z!==Qc.a.gIa)return 8;z=Ia.queryResult;Ia=Ia.SourceControlId;if(!Ia||"TransitionExistingInMenu"!==Ia)return 16;U=this.Ym.WP(Ia);if(!U)return 8;Ba=U.sc.split("_")[1]+"_24";Ia=xa.tQa(Ia,Ia,Ba,"4036532528","2831233208",U.nc,U.nc);z.J2=Ia;Ia=this.ra.nf();if(!Ia||!Ia.length)return 16;1===ka&&(ka="",({Lna:ka}=this.tPa(Ia)).returnValue&&
z.pU(!ka));return 32}DFk(z,U,ka){z=this.ra.nf();if(!z||!z.length)return 16;U=this.Ym.iub(z[0].Mo);return!U||!U.next||1<z.length&&!this.tPa(z).returnValue?16:1===ka?32:8}FLe(z,U,ka,Ba,Ia){if(!Ia)return 8;U=Ia.SourceControlId;Ia=z===Qc.a.fxa||z===Qc.a.iJa;Ba=this.ra.nf();if(!Ba||!Ba.length)return 16;for(var Ab of Ba)if(this.Xb.Zc(Ab))return 16;Ab="";const Ob=({Lna:Ab}=this.tPa(Ba)).returnValue;if(Ia&&(!Ob||Ab))return 16;if(1===ka)return 32;Ab=this.Ym.WP(U);if(!Ab)return 8;if(!Ia&&2===ka&&U){Vf.a.qk("SlideCount",
Ba.length.toString());ka=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{ka.kc(this.Zb.yf);ka.fd=z;for(const Yb of Ba)Yb.Mo=Ab.qc}finally{ka&&ka.dispose()}e.ULS.sendTraceTag(512499931,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",U,Ab.next||"null")}return 32}E7k(z,U,ka,Ba,Ia){if(!Ia)return 8;U=Ia.SourceControlId;if(z!==Qc.a.exa)return 8;Ba=this.ra.nf();if(!Ba||!Ba.length)return 16;for(var Ab of Ba)if(this.Xb.Zc(Ab))return 16;if(1===
ka)return 32;Ab=this.Ym.WP(U);if(!Ab)return 8;if(2===ka&&U){Vf.a.qk("SlideCount",Ba.length.toString());ka=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()},()=>{1===this.Mb.Xo&&this.Fa.Gj(tf.a.rU,!0)});try{ka.kc(this.Zb.yf);ka.fd=z;for(const Ob of Ba)Ob.Mo=Ab.qc}finally{ka&&ka.dispose()}e.ULS.sendTraceTag(512499930,801,50,"TransitionActor: Command=SetTransitionGallery, TransitionType={0}, TransitionEffectOption={1}",U,Ab.next||"null")}return 32}F7k(z,U,ka,Ba,Ia){if(!Ia)return 8;U=this.ra.nf();
if(!U||!U.length)return 16;if(z!==Qc.a.fxa||1!==ka)return 8;Ba="";z=({Lna:Ba}=this.tPa(U)).returnValue;ka=!!Ba;U=Ba&&0<Ba.length?this.Ym.WP(Ba):null;U=this.Ym.aWc(U?U.parent:null,this.Ym.utb());return!z||ka&&U?16:32}G7k(z,U,ka,Ba,Ia){if(!Ia)return 8;U=this.ra.nf();if(!U||!U.length)return 16;if(z!==Qc.a.iJa||1!==ka)return 8;z="";return!({Lna:z}=this.tPa(U)).returnValue||z?16:32}D7k(z,U,ka,Ba,Ia){if(!Ia)return 8;U=Ia.MenuItemId;if(1===ka)return 32;ka=this.ra.nf();if(!ka||!ka.length)return 16;for(var Ab of ka)if(this.Xb.Zc(Ab)||
!Ab.Mo)return 16;Ab=this.Ym.WP(U);if(!Ab||!Ab.qc)return 16;Vf.a.qk("SlideCount",ka.length.toString());Ba=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{Ba.kc(this.Zb.yf);Ba.fd=z;for(const Ob of ka){let Yb=Ob.Mo;Yb.TransitionType=Ab.qc.TransitionType;Yb.Direction=Ab.qc.Direction;Yb.Duration=Ab.qc.Duration;Ob.Mo=Yb}}finally{Ba&&Ba.dispose()}e.ULS.sendTraceTag(512499929,801,50,"TransitionActor: Command=SetTransitionEffectOption, TransitionType={0}, TransitionEffectOption={1}",Ab.parent,U);
return 32}CFk(z,U,ka,Ba,Ia){if(!Ia)return 8;z=Ia.queryResult;Ia=Ia.MenuItemId;U=this.ra.nf();if(!U||!U.length)return 16;1===ka&&(ka="",({Lna:ka}=this.gKi(U)).returnValue&&z.Nf(ka===Ia));return 32}BFk(z,U,ka,Ba,Ia){if(!Ia)return 8;z=this.ra.nf();if(!z||!z.length)return 16;if(Ia=Ia.queryResult)z=xa.Jfj(z),Ia.C$=z;return 32}C7k(z,U,ka,Ba,Ia){if(!Ia)return 8;U=this.ra.nf();if(!U||!U.length)return 16;for(const Ab of U)if(this.Xb.Zc(Ab))return 16;Ia=Math.floor(1E3*Ia.Number);for(const Ab of U)if(!Ab.Mo)return 16;
Vf.a.Eb&&(Vf.a.Eb.actionName="SetTransitionDuration");if(1===ka){for(const Ab of U)if("TransitionNone"===this.Ym.kRa(Ab.Mo))return 16;return 32}if(2===ka){const Ab=this.Fa.ze;Vf.a.qk("SlideCount",U.length.toString());ka=this.Fb.ud(15,void 0,()=>{this.ra.kj();!Ab||Ab.name!==tf.a.Bg&&Ab.name!==tf.a.HC||this.Fa.Ad()});try{ka.kc(this.Zb.yf);ka.fd=z;for(const Ob of U){const Yb=Ob.Mo;Yb.Duration=Ia;Ob.Mo=Yb}}finally{ka&&ka.dispose()}}return 32}tPa(z){let U;U="";if(!z||!z.length)return{returnValue:!1,Lna:U};
U=this.Ym.kRa(z[0].Mo);let ka=!0;if(1<z.length)for(const Ba of z)if(z=this.Ym.kRa(Ba?Ba.Mo:null),U!==z){ka=!1;break}ka||(U="");return{returnValue:ka,Lna:U}}gKi(z){let U;U="";if(!z||!z.length)return{returnValue:!1,Lna:U};U=this.Ym.jRa(z[0].Mo);let ka=!0;if(1<z.length)for(const Ba of z)if(z=this.Ym.jRa(Ba?Ba.Mo:null),U!==z){ka=!1;break}ka||(U="");return{returnValue:ka,Lna:U}}sLf(z){const U=Object.assign(new jh.a,{Id:"TransitionMenuEffectOptions",UpdateDynamically:!0,Title:ResourceStrings.L_TransitionEffectOptions,
MenuSectionList:[]}),ka=Object.assign(new mh.a,{Id:"MenuSectionEffectOptions",ControlsId:"MenuSectionEffectOptions.Controls",DisplayMode:"Menu32",ControlList:[]});Array.add(U.MenuSectionList,ka);let Ba=null;for(z=({key:Ba}=this.Ym.odg(z)).returnValue;z;)Array.add(ka.ControlList,Object.assign(new W.a,{Command:"961566706",Id:Ba,ExternalId:"TransitionEffectOptions"+Ba,QueryCommand:"3535869262"})),{key:Ba,returnValue:z}=this.Ym.odg(z);return U}static Jfj(z){let U;if(!z||!z.length)return"0";const ka=z[0].Mo;
U=ka?(ka.Duration/1E3).toString():"0";let Ba=!0;if(1<z.length)for(const Ia of z)if((z=Ia?Ia.Mo:null)||ka){if(!z&&ka||z&&!ka){Ba=!1;break}if(U!==(z.Duration/1E3).toString()){Ba=!1;break}}Ba||(U="0");return U}static fZd(z,U,ka){z=String.format('<SPAN class="cui-img-32by32 cui-img-cont-float" unselectable="on"><IMG class="{0}" src="{1}" unselectable="on"></SPAN>',z,ka);U=String.format('<P class="cui-ctl-mediumlabel GalleryButtonLabel" unselectable="on">{0}</P>',U);return String.format('<DIV class="GalleryButtonWithLabel">{0}{1}</DIV>',
z,U)}static tQa(z,U,ka,Ba,Ia,Ab,Ob){return Object.assign(new yg.a,{Id:z,ExternalId:U,Icon:ka,Command:Ba,QueryCommand:Ia,LabelText:Ab,FullIconStyle:{root:{width:"32px",height:"32px"}},PreviewIconStyle:{root:{width:"24px",height:"24px"}},Alt:Ob})}}Object(h.a)(xa,"TransitionActor",null,[229]);var da=d(989);class Fa{constructor(){this.effectId=this.effectType=0;this.labelText=this.Me=this.pn=this.In=null}}Object(h.a)(Fa,"AnimInfo",null,[]);class Ua{constructor(){this.Bj=this.labelText=this.Me=this.id=
null}}Object(h.a)(Ua,"EffectOption",null,[]);class cb extends Ua{constructor(){super();this.value=null}}Object(h.a)(cb,"EffectData",Ua,[]);class Jb{constructor(z){this.R7b=z;Jb.rl||(Jb.rl=new da.a,Jb.rl.add("FromBottom",Object.assign(new Ua,{id:"FromBottom",Me:Jb.Ze("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottom,Bj:CommonUIStrings.l_AnimationFromBottomKeytip})),Jb.rl.add("FromBottomLeft",Object.assign(new Ua,{id:"FromBottomLeft",Me:Jb.Ze("AnimEffectPropFromBottomLeft"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomLeft,Bj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),Jb.rl.add("FromLeft",Object.assign(new Ua,{id:"FromLeft",Me:Jb.Ze("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromLeft,Bj:CommonUIStrings.l_AnimationFromLeftKeytip})),Jb.rl.add("FromTopLeft",Object.assign(new Ua,{id:"FromTopLeft",Me:Jb.Ze("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopLeft,Bj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),
Jb.rl.add("FromTop",Object.assign(new Ua,{id:"FromTop",Me:Jb.Ze("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTop,Bj:CommonUIStrings.l_AnimationFromTopKeytip})),Jb.rl.add("FromTopRight",Object.assign(new Ua,{id:"FromTopRight",Me:Jb.Ze("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromTopRight,Bj:CommonUIStrings.l_AnimationFromTopRightKeytip})),Jb.rl.add("FromRight",Object.assign(new Ua,{id:"FromRight",Me:Jb.Ze("AnimEffectPropFromRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionFromRight,Bj:CommonUIStrings.l_AnimationFromRightKeytip})),Jb.rl.add("FromBottomRight",Object.assign(new Ua,{id:"FromBottomRight",Me:Jb.Ze("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionFromBottomRight,Bj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),Jb.rl.add("ToBottom",Object.assign(new Ua,{id:"ToBottom",Me:Jb.Ze("AnimEffectPropFromTop"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottom,Bj:CommonUIStrings.l_AnimationFromBottomKeytip})),
Jb.rl.add("ToBottomLeft",Object.assign(new Ua,{id:"ToBottomLeft",Me:Jb.Ze("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomLeft,Bj:CommonUIStrings.l_AnimationFromBottomLeftKeytip})),Jb.rl.add("ToLeft",Object.assign(new Ua,{id:"ToLeft",Me:Jb.Ze("AnimEffectPropFromRight"),labelText:ResourceStrings.L_EffectOptionsDirectionToLeft,Bj:CommonUIStrings.l_AnimationFromLeftKeytip})),Jb.rl.add("ToTopLeft",Object.assign(new Ua,{id:"ToTopLeft",Me:Jb.Ze("AnimEffectPropFromBottomRight"),
labelText:ResourceStrings.L_EffectOptionsDirectionToTopLeft,Bj:CommonUIStrings.l_AnimationFromTopLeftKeytip})),Jb.rl.add("ToTop",Object.assign(new Ua,{id:"ToTop",Me:Jb.Ze("AnimEffectPropFromBottom"),labelText:ResourceStrings.L_EffectOptionsDirectionToTop,Bj:CommonUIStrings.l_AnimationFromTopKeytip})),Jb.rl.add("ToTopRight",Object.assign(new Ua,{id:"ToTopRight",Me:Jb.Ze("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToTopRight,Bj:CommonUIStrings.l_AnimationFromTopRightKeytip})),
Jb.rl.add("ToRight",Object.assign(new Ua,{id:"ToRight",Me:Jb.Ze("AnimEffectPropFromLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToRight,Bj:CommonUIStrings.l_AnimationFromRightKeytip})),Jb.rl.add("ToBottomRight",Object.assign(new Ua,{id:"ToBottomRight",Me:Jb.Ze("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionToBottomRight,Bj:CommonUIStrings.l_AnimationFromBottomRightKeytip})),Jb.rl.add("Horizontal",Object.assign(new Ua,{id:"Horizontal",Me:Jb.Ze("AnimEffectPropHorizontal"),
labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Bj:CommonUIStrings.l_AnimationHorizontalKeytip})),Jb.rl.add("HorizontalIn",Object.assign(new Ua,{id:"HorizontalIn",Me:Jb.Ze("AnimEffectPropHorizontalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalIn,Bj:CommonUIStrings.l_AnimationHorizontalInKeytip})),Jb.rl.add("HorizontalOut",Object.assign(new Ua,{id:"HorizontalOut",Me:Jb.Ze("AnimEffectPropHorizontalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontalOut,
Bj:CommonUIStrings.l_AnimationHorizontalOutKeytip})),Jb.rl.add("Vertical",Object.assign(new Ua,{id:"Vertical",Me:Jb.Ze("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Bj:CommonUIStrings.l_AnimationVerticalKeytip})),Jb.rl.add("VerticalIn",Object.assign(new Ua,{id:"VerticalIn",Me:Jb.Ze("AnimEffectPropVerticalIn"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalIn,Bj:CommonUIStrings.l_AnimationVerticalInKeytip})),Jb.rl.add("VerticalOut",Object.assign(new Ua,
{id:"VerticalOut",Me:Jb.Ze("AnimEffectPropVerticalOut"),labelText:ResourceStrings.L_EffectOptionsDirectionVerticalOut,Bj:CommonUIStrings.l_AnimationVerticalOutKeytip})),Jb.rl.add("LeftDown",Object.assign(new Ua,{id:"LeftDown",Me:Jb.Ze("AnimEffectPropFromTopRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftDown,Bj:CommonUIStrings.l_AnimationLeftDownKeytip})),Jb.rl.add("LeftUp",Object.assign(new Ua,{id:"LeftUp",Me:Jb.Ze("AnimEffectPropFromBottomRight"),labelText:ResourceStrings.L_EffectOptionsDirectionLeftUp,
Bj:CommonUIStrings.l_AnimationLeftUpKeytip})),Jb.rl.add("RightDown",Object.assign(new Ua,{id:"RightDown",Me:Jb.Ze("AnimEffectPropFromTopLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightDown,Bj:CommonUIStrings.l_AnimationRightDownKeytip})),Jb.rl.add("RightUp",Object.assign(new Ua,{id:"RightUp",Me:Jb.Ze("AnimEffectPropFromBottomLeft"),labelText:ResourceStrings.L_EffectOptionsDirectionRightUp,Bj:CommonUIStrings.l_AnimationRightUpKeytip})),Jb.rl.add("In",Object.assign(new Ua,{id:"In",Me:Jb.Ze("AnimEffectPropIn"),
labelText:ResourceStrings.L_EffectOptionsDirectionIn,Bj:CommonUIStrings.l_AnimationInKeytip})),Jb.rl.add("InBottom",Object.assign(new Ua,{id:"InBottom",Me:Jb.Ze("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInToScreenBottom,Bj:CommonUIStrings.l_AnimationInToScreenBottomKeytip})),Jb.rl.add("InCenter",Object.assign(new Ua,{id:"InCenter",Me:Jb.Ze("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInCenter,Bj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),
Jb.rl.add("InSlightly",Object.assign(new Ua,{id:"InSlightly",Me:Jb.Ze("AnimEffectPropIn"),labelText:ResourceStrings.L_EffectOptionsDirectionInSlightly,Bj:CommonUIStrings.l_AnimationInSlightlyKeytip})),Jb.rl.add("Out",Object.assign(new Ua,{id:"Out",Me:Jb.Ze("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOut,Bj:CommonUIStrings.l_AnimationOutKeytip})),Jb.rl.add("OutBottom",Object.assign(new Ua,{id:"OutBottom",Me:Jb.Ze("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutBottom,
Bj:CommonUIStrings.l_AnimationOutFromScreenBottomKeytip})),Jb.rl.add("OutCenter",Object.assign(new Ua,{id:"OutCenter",Me:Jb.Ze("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutToScreenCenter,Bj:CommonUIStrings.l_AnimationOutToScreenCenterKeytip})),Jb.rl.add("OutSlightly",Object.assign(new Ua,{id:"OutSlightly",Me:Jb.Ze("AnimEffectPropOut"),labelText:ResourceStrings.L_EffectOptionsDirectionOutSlightly,Bj:CommonUIStrings.l_AnimationOutSlightlyKeytip})),Jb.rl.add("FloatUp",Object.assign(new Ua,
{id:"FloatUp",Me:Jb.Ze("AnimEffectPropFloatUp"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatUp,Bj:CommonUIStrings.l_AnimationOutKeytip})),Jb.rl.add("FloatDown",Object.assign(new Ua,{id:"FloatDown",Me:Jb.Ze("AnimEffectPropFloatDown"),labelText:ResourceStrings.L_EffectOptionsDirectionFloatDown,Bj:CommonUIStrings.l_AnimationDownKeytip})),Jb.rl.add("ObjectCenter",Object.assign(new Ua,{id:"ObjectCenter",Me:Jb.Ze("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,
Bj:CommonUIStrings.l_AnimationObjectCenterKeytip})),Jb.rl.add("SlideCenter",Object.assign(new Ua,{id:"SlideCenter",Me:Jb.Ze("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Bj:CommonUIStrings.l_AnimationSlideCenterKeytip})),Jb.rl.add("ObjectCenterOut",Object.assign(new Ua,{id:"ObjectCenterOut",Me:Jb.Ze("AnimEffectPropFadedZoomIn"),labelText:ResourceStrings.L_EffectOptionsDirectionObjectCenter,Bj:CommonUIStrings.l_AnimationObjectCenterKeytip})),Jb.rl.add("SlideCenterOut",
Object.assign(new Ua,{id:"SlideCenterOut",Me:Jb.Ze("AnimEffectPropFadedZoomInFromCenter"),labelText:ResourceStrings.L_EffectOptionsDirectionSlideCenter,Bj:CommonUIStrings.l_AnimationSlideCenterKeytip})),Jb.rl.add("Clockwise",Object.assign(new Ua,{id:"Clockwise",Me:Jb.Ze("AnimEffectPropClockwise"),labelText:ResourceStrings.L_EffectOptionsDirectionClockwise,Bj:CommonUIStrings.l_AnimationClockWiseKeytip})),Jb.rl.add("CounterClockwise",Object.assign(new Ua,{id:"CounterClockwise",Me:Jb.Ze("AnimEffectPropCounterclockwise"),
labelText:ResourceStrings.L_EffectOptionsDirectionCounterClockwise,Bj:CommonUIStrings.l_AnimationCounterClockWiseKeytip})),Jb.rl.add("Across",Object.assign(new Ua,{id:"Across",Me:Jb.Ze("AnimEffectPropHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionAcross,Bj:CommonUIStrings.l_AnimationAcrossKeytip})),Jb.rl.add("Up",Object.assign(new Ua,{id:"Up",Me:Jb.Ze("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionUp,Bj:CommonUIStrings.l_AnimationUpKeytip})),Jb.rl.add("Down",
Object.assign(new Ua,{id:"Down",Me:Jb.Ze("AnimEffectPropVertical"),labelText:ResourceStrings.L_EffectOptionsDirectionDown,Bj:CommonUIStrings.l_AnimationDownKeytip})),Jb.rl.add("GrowShrinkHorizontal",Object.assign(new Ua,{id:"GrowShrinkHorizontal",Me:Jb.Ze("AnimEffectPropGrowShrinkHorizontal"),labelText:ResourceStrings.L_EffectOptionsDirectionHorizontal,Bj:CommonUIStrings.l_AnimationHorizontalKeytip})),Jb.rl.add("GrowShrinkVertical",Object.assign(new Ua,{id:"GrowShrinkVertical",Me:Jb.Ze("AnimEffectPropGrowShrinkVertical"),
labelText:ResourceStrings.L_EffectOptionsDirectionVertical,Bj:CommonUIStrings.l_AnimationVerticalKeytip})),Jb.rl.add("GrowShrinkBoth",Object.assign(new Ua,{id:"GrowShrinkBoth",Me:Jb.Ze("AnimEffectPropBoth"),labelText:ResourceStrings.L_EffectOptionsDirectionBoth,Bj:CommonUIStrings.l_AnimationBothKeytip})));Jb.rS||(Jb.rS=new da.a,Jb.rS.add("Spin_Quarter",Object.assign(new cb,{id:"Spin_Quarter",Me:Jb.Ze("AnimEffectPropQuarterSpin"),labelText:ResourceStrings.L_EffectOptionsSpinQuarter,value:"90",Bj:CommonUIStrings.l_AnimationQuarterSpinKeytip})),
Jb.rS.add("Spin_Half",Object.assign(new cb,{id:"Spin_Half",Me:Jb.Ze("AnimEffectPropHalfSpin"),labelText:ResourceStrings.L_EffectOptionsSpinHalf,value:"180",Bj:CommonUIStrings.l_AnimationHalfSpinKeytip})),Jb.rS.add("Spin_Full",Object.assign(new cb,{id:"Spin_Full",Me:Jb.Ze("AnimEffectPropFullSpin"),labelText:ResourceStrings.L_EffectOptionsSpinFull,value:"360",Bj:CommonUIStrings.l_AnimationFullSpinKeytip})),Jb.rS.add("Spin_Two",Object.assign(new cb,{id:"Spin_Two",Me:Jb.Ze("AnimEffectPropTwoSpins"),labelText:ResourceStrings.L_EffectOptionsSpinTwo,
value:"720",Bj:CommonUIStrings.l_AnimationTwoSpinKeytip})),Jb.rS.add("Transparency_25",Object.assign(new cb,{id:"Transparency_25",Me:Jb.Ze("AnimEffectPropTransparent25"),labelText:ResourceStrings.L_EffectOptionsTransparency25Percent,value:"0.75",Bj:CommonUIStrings.l_Animation25PerKeytip})),Jb.rS.add("Transparency_50",Object.assign(new cb,{id:"Transparency_50",Me:Jb.Ze("AnimEffectPropTransparent50"),labelText:ResourceStrings.L_EffectOptionsTransparency50Percent,value:"0.5",Bj:CommonUIStrings.l_Animation50PerKeytip})),
Jb.rS.add("Transparency_75",Object.assign(new cb,{id:"Transparency_75",Me:Jb.Ze("AnimEffectPropTransparent75"),labelText:ResourceStrings.L_EffectOptionsTransparency75Percent,value:"0.25",Bj:CommonUIStrings.l_Animation75PerKeytip})),Jb.rS.add("Transparency_100",Object.assign(new cb,{id:"Transparency_100",Me:Jb.Ze("AnimEffectPropTransparent100"),labelText:ResourceStrings.L_EffectOptionsTransparency100Percent,value:"0.0",Bj:CommonUIStrings.l_Animation100PerKeytip})),Jb.rS.add("GrowShrink_Tiny",Object.assign(new cb,
{id:"GrowShrink_Tiny",Me:Jb.Ze("AnimEffectPropTiny"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkTiny,value:"25",Bj:CommonUIStrings.l_AnimationTinyKeytip})),Jb.rS.add("GrowShrink_Smaller",Object.assign(new cb,{id:"GrowShrink_Smaller",Me:Jb.Ze("AnimEffectPropSmaller"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkSmaller,value:"50",Bj:CommonUIStrings.l_AnimationSmallerKeytip})),Jb.rS.add("GrowShrink_Larger",Object.assign(new cb,{id:"GrowShrink_Larger",Me:Jb.Ze("AnimEffectPropLarger"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkLarger,
value:"150",Bj:CommonUIStrings.l_AnimationLargerKeytip})),Jb.rS.add("GrowShrink_Huge",Object.assign(new cb,{id:"GrowShrink_Huge",Me:Jb.Ze("AnimEffectPropHuge"),labelText:ResourceStrings.L_EffectOptionsGrowShrinkHuge,value:"400",Bj:CommonUIStrings.l_AnimationHugeKeytip})));if(!Jb.Xl)if(Jb.Xl=new da.a,Jb.Xl.add("Existing",Object.assign(new Fa,{effectType:-1,effectId:-1,Me:Jb.Ze("AnimFxMultiple"),labelText:ResourceStrings.L_AnimationExisting,In:[],pn:[]})),Jb.Xl.add("None",Object.assign(new Fa,{effectType:0,
effectId:0,Me:Jb.Ze("AnimFxNone"),labelText:ResourceStrings.L_AnimationNone,In:[],pn:[]})),Jb.Xl.add("Appear",Object.assign(new Fa,{effectType:0,effectId:1,Me:Jb.Ze("AnimFxEntranceAppear"),labelText:ResourceStrings.L_AnimationAppear,In:[],pn:[]})),Jb.Xl.add("FadeIn",Object.assign(new Fa,{effectType:0,effectId:10,Me:Jb.Ze("AnimFxEntranceFadeIn"),labelText:ResourceStrings.L_AnimationFade,In:[],pn:[]})),this.R7b){Jb.Xl.add("FlyIn",Object.assign(new Fa,{effectType:0,effectId:2,Me:Jb.Ze("AnimFxEntranceFlyIn"),
labelText:ResourceStrings.L_AnimationFlyIn,In:"FromBottom FromBottomLeft FromLeft FromTopLeft FromTop FromTopRight FromRight FromBottomRight".split(" "),pn:[]}));Jb.Xl.add("Wipe",Object.assign(new Fa,{effectType:0,effectId:22,Me:Jb.Ze("AnimFxEntranceWipeIn"),labelText:ResourceStrings.L_AnimationWipe,In:["FromBottom","FromLeft","FromRight","FromTop"],pn:[]}));Jb.Xl.add("Zoom",Object.assign(new Fa,{effectType:0,effectId:53,Me:Jb.Ze("AnimFxEntranceFadedZoom"),labelText:ResourceStrings.L_AnimationZoom,
In:["ObjectCenter","SlideCenter"],pn:[]}));Jb.Xl.add("Checkerboard",Object.assign(new Fa,{effectType:0,effectId:5,Me:Jb.Ze("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationCheckerboard,In:["Across","Down"],pn:[]}));Jb.Xl.add("BasicZoom",Object.assign(new Fa,{effectType:0,effectId:23,Me:Jb.Ze("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBasicZoom,In:"In InCenter InSlightly Out OutBottom OutSlightly".split(" "),pn:[]}));Jb.Xl.add("Blinds",Object.assign(new Fa,{effectType:0,
effectId:3,Me:Jb.Ze("AnimFxEntranceGeneric"),labelText:ResourceStrings.L_AnimationBlinds,In:["Horizontal","Vertical"],pn:[]}));let U;Jb.Xl.add("Box",(U=new Fa,U.effectType=0,U.effectId=4,U.Me=Jb.Ze("AnimFxEntranceShape"),U.labelText=ResourceStrings.L_AnimationBox,U.In=["In","Out"],U.pn=[],U));let ka;Jb.Xl.add("PeekIn",(ka=new Fa,ka.effectType=0,ka.effectId=12,ka.Me=Jb.Ze("AnimFxEntranceGeneric"),ka.labelText=ResourceStrings.L_AnimationPeekIn,ka.In=["FromBottom","FromLeft","FromRight","FromTop"],ka.pn=
[],ka));let Ba;Jb.Xl.add("Expand",(Ba=new Fa,Ba.effectType=0,Ba.effectId=55,Ba.Me=Jb.Ze("AnimFxEntranceGeneric"),Ba.labelText=ResourceStrings.L_AnimationExpand,Ba.In=[],Ba.pn=[],Ba));let Ia;Jb.Xl.add("GrowAndTurn",(Ia=new Fa,Ia.effectType=0,Ia.effectId=31,Ia.Me=Jb.Ze("AnimFxEntranceGrowAndTurn"),Ia.labelText=ResourceStrings.L_AnimationGrowAndTurn,Ia.In=[],Ia.pn=[],Ia));let Ab;Jb.Xl.add("RandomBars",(Ab=new Fa,Ab.effectType=0,Ab.effectId=14,Ab.Me=Jb.Ze("AnimFxEntranceRandomBars"),Ab.labelText=ResourceStrings.L_AnimationRandomBars,
Ab.In=["Horizontal","Vertical"],Ab.pn=[],Ab));let Ob;Jb.Xl.add("RiseUp",(Ob=new Fa,Ob.effectType=0,Ob.effectId=37,Ob.Me=Jb.Ze("AnimFxEntranceGeneric"),Ob.labelText=ResourceStrings.L_AnimationRiseUp,Ob.In=[],Ob.pn=[],Ob));let Yb;Jb.Xl.add("Split",(Yb=new Fa,Yb.effectType=0,Yb.effectId=16,Yb.Me=Jb.Ze("AnimFxEntranceSplit"),Yb.labelText=ResourceStrings.L_AnimationSplit,Yb.In=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],Yb.pn=[],Yb));let uc;Jb.Xl.add("Strips",(uc=new Fa,uc.effectType=0,
uc.effectId=18,uc.Me=Jb.Ze("AnimFxEntranceGeneric"),uc.labelText=ResourceStrings.L_AnimationStrips,uc.In=["LeftDown","LeftUp","RightDown","RightUp"],uc.pn=[],uc));let mc;Jb.Xl.add("Stretch",(mc=new Fa,mc.effectType=0,mc.effectId=17,mc.Me=Jb.Ze("AnimFxEntranceGeneric"),mc.labelText=ResourceStrings.L_AnimationStretch,mc.In=["Across","FromBottom","FromLeft","FromRight","FromTop"],mc.pn=[],mc));let Ec;Jb.Xl.add("Exit_Disappear",(Ec=new Fa,Ec.effectType=1,Ec.effectId=1,Ec.Me=Jb.Ze("AnimFxExitDisappear"),
Ec.labelText=ResourceStrings.L_AnimationDisappear,Ec.In=[],Ec.pn=[],Ec));let Yc;Jb.Xl.add("Exit_Fade",(Yc=new Fa,Yc.effectType=1,Yc.effectId=10,Yc.Me=Jb.Ze("AnimFxExitFadeOut"),Yc.labelText=ResourceStrings.L_AnimationFade,Yc.In=[],Yc.pn=[],Yc));let jd;Jb.Xl.add("Exit_FlyOut",(jd=new Fa,jd.effectType=1,jd.effectId=2,jd.Me=Jb.Ze("AnimFxExitFlyOut"),jd.labelText=ResourceStrings.L_AnimationFlyOut,jd.In="ToBottom ToBottomLeft ToLeft ToTopLeft ToTop ToTopRight ToRight ToBottomRight".split(" "),jd.pn=[],
jd));let vd;Jb.Xl.add("Exit_Wipe",(vd=new Fa,vd.effectType=1,vd.effectId=22,vd.Me=Jb.Ze("AnimFxExitWipe"),vd.labelText=ResourceStrings.L_AnimationWipe,vd.In=["FromBottom","FromLeft","FromRight","FromTop"],vd.pn=[],vd));let he;Jb.Xl.add("Exit_Zoom",(he=new Fa,he.effectType=1,he.effectId=53,he.Me=Jb.Ze("AnimFxExitFadedZoom"),he.labelText=ResourceStrings.L_AnimationZoom,he.In=["ObjectCenterOut","SlideCenterOut"],he.pn=[],he));let nd;Jb.Xl.add("Exit_Checkerboard",(nd=new Fa,nd.effectType=1,nd.effectId=
5,nd.Me=Jb.Ze("AnimFxExitGeneric"),nd.labelText=ResourceStrings.L_AnimationCheckerboard,nd.In=["Across","Up"],nd.pn=[],nd));let ee;Jb.Xl.add("Exit_BasicZoom",(ee=new Fa,ee.effectType=1,ee.effectId=23,ee.Me=Jb.Ze("AnimFxExitGeneric"),ee.labelText=ResourceStrings.L_AnimationBasicZoom,ee.In="Out OutCenter OutSlightly In InBottom InSlightly".split(" "),ee.pn=[],ee));let Ue;Jb.Xl.add("Exit_Blinds",(Ue=new Fa,Ue.effectType=1,Ue.effectId=3,Ue.Me=Jb.Ze("AnimFxExitGeneric"),Ue.labelText=ResourceStrings.L_AnimationBlinds,
Ue.In=["Horizontal","Vertical"],Ue.pn=[],Ue));let n;Jb.Xl.add("Exit_Box",(n=new Fa,n.effectType=1,n.effectId=4,n.Me=Jb.Ze("AnimFxExitShape"),n.labelText=ResourceStrings.L_AnimationBox,n.In=["In","Out"],n.pn=[],n));let Y;Jb.Xl.add("Exit_PeekOut",(Y=new Fa,Y.effectType=1,Y.effectId=12,Y.Me=Jb.Ze("AnimFxExitGeneric"),Y.labelText=ResourceStrings.L_AnimationPeekOut,Y.In=["ToBottom","ToLeft","ToRight","ToTop"],Y.pn=[],Y));let ra;Jb.Xl.add("Exit_RandomBars",(ra=new Fa,ra.effectType=1,ra.effectId=14,ra.Me=
Jb.Ze("AnimFxExitRandomBars"),ra.labelText=ResourceStrings.L_AnimationRandomBars,ra.In=["Horizontal","Vertical"],ra.pn=[],ra));let Pa;Jb.Xl.add("Exit_Split",(Pa=new Fa,Pa.effectType=1,Pa.effectId=16,Pa.Me=Jb.Ze("AnimFxExitSplit"),Pa.labelText=ResourceStrings.L_AnimationSplit,Pa.In=["HorizontalIn","HorizontalOut","VerticalIn","VerticalOut"],Pa.pn=[],Pa));let eb;Jb.Xl.add("Exit_Strips",(eb=new Fa,eb.effectType=1,eb.effectId=18,eb.Me=Jb.Ze("AnimFxExitGeneric"),eb.labelText=ResourceStrings.L_AnimationStrips,
eb.In=["LeftDown","LeftUp","RightDown","RightUp"],eb.pn=[],eb));let Eb;Jb.Xl.add("Exit_Stretchy",(Eb=new Fa,Eb.effectType=1,Eb.effectId=17,Eb.Me=Jb.Ze("AnimFxExitGeneric"),Eb.labelText=ResourceStrings.L_AnimationStretchy,Eb.In=[],Eb.pn=[],Eb));let Sb;Jb.Xl.add("Exit_Zoom",(Sb=new Fa,Sb.effectType=1,Sb.effectId=53,Sb.Me=Jb.Ze("AnimFxExitFadedZoom"),Sb.labelText=ResourceStrings.L_AnimationZoom,Sb.In=["ObjectCenterOut","SlideCenterOut"],Sb.pn=[],Sb));let ub;Jb.Xl.add("Emphasis_Spin",(ub=new Fa,ub.effectType=
2,ub.effectId=8,ub.Me=Jb.Ze("AnimFxEmphasisSpin"),ub.labelText=ResourceStrings.L_AnimationSpin,ub.In=["Clockwise","CounterClockwise"],ub.pn=["Spin_Quarter","Spin_Half","Spin_Full","Spin_Two"],ub));let wb;Jb.Xl.add("Emphasis_Transparency",(wb=new Fa,wb.effectType=2,wb.effectId=9,wb.Me=Jb.Ze("AnimFxEmphasisTransparency"),wb.labelText=ResourceStrings.L_AnimationTransparency,wb.In=[],wb.pn=["Transparency_25","Transparency_50","Transparency_75","Transparency_100"],wb));let ec;Jb.Xl.add("Emphasis_GrowShrink",
(ec=new Fa,ec.effectType=2,ec.effectId=6,ec.Me=Jb.Ze("AnimFxEmphasisGrowShrink"),ec.labelText=ResourceStrings.L_AnimationGrowShrink,ec.In=["GrowShrinkHorizontal","GrowShrinkVertical","GrowShrinkBoth"],ec.pn=["GrowShrink_Tiny","GrowShrink_Smaller","GrowShrink_Larger","GrowShrink_Huge"],ec));let kc;Jb.Xl.add("Emphasis_FillColor",(kc=new Fa,kc.effectType=2,kc.effectId=1,kc.Me=Jb.Ze("AnimFxEmphasisChangeFillColor"),kc.labelText=ResourceStrings.L_AnimationFillColor,kc.In=[],kc.pn=[],kc));let bd;Jb.Xl.add("Emphasis_FontColor",
(bd=new Fa,bd.effectType=2,bd.effectId=3,bd.Me=Jb.Ze("AnimFxEmphasisChangeFontColor"),bd.labelText=ResourceStrings.L_AnimationFontColor,bd.In=[],bd.pn=[],bd));let Ad;Jb.Xl.add("Emphasis_LineColor",(Ad=new Fa,Ad.effectType=2,Ad.effectId=7,Ad.Me=Jb.Ze("AnimFxEmphasisChangeLineColor"),Ad.labelText=ResourceStrings.L_AnimationLineColor,Ad.In=[],Ad.pn=[],Ad))}else Jb.Xl.add("FlyIn",Object.assign(new Fa,{effectType:0,effectId:2,Me:Jb.Ze("AnimFxEntranceFlyIn"),labelText:ResourceStrings.L_AnimationFlyIn,In:["FromBottom",
"FromLeft","FromTop","FromRight"],pn:[]}))}i0b(z,U){let ka=null;Jb.Xl.forEach((Ba,Ia)=>{Ia.effectType===z&&Ia.effectId===U&&(ka=Ia);return!0});return ka}fPc(z,U){let ka=null;Jb.Xl.forEach((Ba,Ia)=>{Ia.effectType===z&&Ia.effectId===U&&(ka=Ba);return!0});return ka}HOc(z,U,ka,Ba,Ia){const Ab=Object.assign(new mh.a,{Id:"MenuSectionEffectOptions"+ka,ControlsId:"MenuSectionEffectOptionsDirection.Controls",DisplayMode:"Menu32",ControlList:[]});z=this.i0b(U,z);if(!z)return Ab;if((z=Jb.F4i(z,ka))&&z.length)for(U=
0;U<z.length;U++){const Ob=Jb.G4i(z[U],ka),Yb="AnimationEffectOptions"+("Direction"===ka?"Direction":"Data")+Ob.id;Array.add(Ab.ControlList,Object.assign(new W.a,{Command:Ba,Id:Ob.id,ExternalId:Yb,QueryCommand:Ia}))}return Ab}gNc(z){var U;return(U=Jb.Xl.ga(z))?(z=U.effectType,U=U.effectId,{returnValue:!0,effectType:z,effectId:U}):{returnValue:!1,effectType:-1,effectId:-1}}hNc(z){let U,ka;U=Jb.Ze("AnimFxMultiple");ka=ResourceStrings.L_AnimationExisting;if(z=Jb.Xl.ga(z))U=z.Me,ka=z.labelText;return{image:U,
label:ka}}JTc(z,U){if(0===z){if(0!==U&&1!==U&&2!==U&&10!==U)return!0}else if(0<z)return!0;return!1}S8a(z,U){return z&&U?this.R7b?(U=U.H8a()?z.IsTrigger:z.HasTrigger,!!this.i0b(z.EffectType,z.EffectId)&&!U):!z.HasExisting:!0}wVc(z){return z?this.Rvb(Array(z)):!0}Rvb(z){if(!z||!z.length)return!0;for(const U of z)if(null==this.i0b(U.EffectType,U.EffectId))return!1;return!0}$ae(z,U){return U&&z&&this.R7b?U.H8a()?!1:z.HasMultiple:!1}O4b(z){if(!z||!z.length)return!1;const U=z[0].EffectId,ka=z[0].EffectType;
for(let Ba=1;Ba<z.length;Ba++){const Ia=z[Ba];if(Ia.EffectId!=U||Ia.EffectType!=ka)return!0}return!1}fug(z){if(z&&this.R7b&&2===z.EffectType)switch(z.EffectId){case 1:case 3:case 7:return!0}return!1}Uce(z){if(!z)return!1;if(2===z.EffectType)switch(z.EffectId){case 1:case 3:case 7:return!0}return!1}w3i(z){z=Jb.Xl.ga(z);return this.H0b(z.In[0])}t3i(z){return(z=Jb.Xl.ga(z))&&z.pn.length?this.K_d(z.pn[0]):""}H0b(z){switch(z){case "FromBottom":case "ToBottom":return 3;case "FromBottomLeft":case "ToBottomLeft":case "LeftDown":return 8;
case "FromLeft":case "ToLeft":return 4;case "FromTopLeft":case "ToTopLeft":case "LeftUp":return 5;case "FromTop":case "ToTop":return 1;case "FromTopRight":case "ToTopRight":case "RightUp":return 6;case "FromRight":case "ToRight":return 2;case "FromBottomRight":case "ToBottomRight":case "RightDown":return 7;case "Horizontal":case "Across":return 9;case "HorizontalIn":return 15;case "HorizontalOut":return 16;case "Vertical":case "Down":case "Up":return 10;case "VerticalIn":return 17;case "VerticalOut":return 18;
case "In":case "ObjectCenter":return 11;case "InCenter":case "SlideCenter":return 22;case "InBottom":return 23;case "InSlightly":return 21;case "Out":case "ObjectCenterOut":return 12;case "OutBottom":return 26;case "OutSlightly":return 24;case "OutCenter":case "SlideCenterOut":return 25;case "FloatUp":return 1;case "FloatDown":return 3;case "Clockwise":return 13;case "CounterClockwise":return 14;case "GrowShrinkHorizontal":return 27;case "GrowShrinkVertical":return 28;case "GrowShrinkBoth":return 29;
default:return 0}}K_d(z){return(z=Jb.rS.ga(z))?z.value:""}JRf(z,U){return(U=Jb.rS.ga(U))&&parseFloat(z)===parseFloat(U.value)?!0:!1}R2d(z){switch(z){case "AsOneObject":return 1;case "AllAtOnce":return 2;case "ByParagraph":return 3;case "OneByOne":return 4;default:return 0}}Lki(z){if(null===z)throw Error.argumentNull("animation");const U=this.i0b(z.EffectType,z.EffectId);return!!U&&(0<U.In.length||0<U.pn.length||this.fug(z))}Mki(z){if(!z)return!1;const U=this.i0b(z.EffectType,z.EffectId);return!!U&&
(0<U.In.length||0<U.pn.length||this.Uce(z))}Nki(z,U,ka){return this.S8a(ka,z)&&!this.$ae(ka,z)&&(this.Lki(ka)||this.mNf(z,U,ka)||this.fNd(z,U,ka)||this.kNf(z,U,ka)||this.gNd(z,ka))}Oki(z,U,ka){if(!(z&&U&&ka&&ka.length&&this.Rvb(ka)))return!1;z=Jb.LTf(z,ka);U=this.nNf(U,z)||this.pNf(U,z)||this.lNf(U,z)||this.rNf(z);let Ba;this.O4b(ka)||(Ba=this.Mki(ka[0]));return Ba||U}lcj(z,U,ka){const Ba=Object.assign(new mh.a,{Id:"MenuSectionEffectOptionsSequence",ControlsId:"MenuSectionEffectOptionsSequence.Controls",
DisplayMode:"Menu32",ControlList:[]});this.mNf(z,U,ka)&&Array.add(Ba.ControlList,Object.assign(new W.a,{Command:"1850236812",Id:"AsOneObject",ExternalId:"AnimationEffectOptionsSequenceAsOneObject",QueryCommand:"1125291975"}));this.kNf(z,U,ka)&&this.R7b&&Array.add(Ba.ControlList,Object.assign(new W.a,{Command:"2048458448",Id:"AllAtOnce",ExternalId:"AnimationEffectOptionsSequenceAllAtOnce",QueryCommand:"1125291975"}));this.fNd(z,U,ka)&&Array.add(Ba.ControlList,Object.assign(new W.a,{Command:"3467781846",
Id:"ByParagraph",ExternalId:"AnimationEffectOptionsSequenceByParagraph",QueryCommand:"1125291975"}));this.gNd(z,ka)&&Array.add(Ba.ControlList,Object.assign(new W.a,{Command:"1486892994",Id:"OneByOne",ExternalId:"AnimationEffectOptionsSequenceOneByOne",QueryCommand:"1125291975"}));return Ba}mcj(z,U,ka){const Ba=new mh.a;Ba.Id="MenuSectionEffectOptionsSequence";Ba.ControlsId="MenuSectionEffectOptionsSequence.Controls";Ba.DisplayMode="Menu32";Ba.ControlList=[];if(!(z&&z.length&&U&&ka&&ka.length))return Ba;
z=Jb.LTf(z,ka);this.nNf(U,z)&&(ka=new W.a,ka.Command="1850236812",ka.Id="AsOneObject",ka.ExternalId="AnimationEffectOptionsSequenceAsOneObject",ka.QueryCommand="1125291975",Ba.ControlList.push(ka));this.lNf(U,z)&&(ka=new W.a,ka.Command="2048458448",ka.Id="AllAtOnce",ka.ExternalId="AnimationEffectOptionsSequenceAllAtOnce",ka.QueryCommand="1125291975",Ba.ControlList.push(ka));this.pNf(U,z)&&(U=new W.a,U.Command="3467781846",U.Id="ByParagraph",U.ExternalId="AnimationEffectOptionsSequenceByParagraph",
U.QueryCommand="1125291975",Ba.ControlList.push(U));this.rNf(z)&&(U=new W.a,U.Command="1486892994",U.Id="OneByOne",U.ExternalId="AnimationEffectOptionsSequenceOneByOne",U.QueryCommand="1125291975",Ba.ControlList.push(U));return Ba}NOj(z){let U=!0,ka=0;if(!z)return!1;for(const Ba of z)if(U)ka=Ba.EffectId,U=!1;else if(Ba.EffectId!==ka)return!1;return!0}Z9i(z,U,ka){const Ba={isEnabled:!1,aed:null};if(!z||!U||!U.length)return Ba;z=Jb.i9i(z);if(!z.length)return Ba;const Ia=z.map(Ab=>Ab.EffectNodeId);U=
U.map(Ab=>Ab.EffectNodeId).sort((Ab,Ob)=>Ab-Ob);if(!Jb.aPj(U,Ia))return Ba;if(ka){ka=Ia.indexOf(U[U.length-1]);if(-1==ka||ka==Ia.length-1)return Ba;Ba.isEnabled=!0;Ba.aed=Jb.Sgg(z[ka+1])}else{ka=Ia.indexOf(U[0]);if(-1==ka||0==ka)return Ba;Ba.isEnabled=!0;Ba.aed=Jb.Sgg(z[ka-1])}return Ba}static LTf(z,U){const ka=new Map;for(const Ba of z)ka.set(Ba.id.toString(),Ba);z=new Map;for(const Ba of U)U=Zf.a.Mf(Ba.ShapeId),U=ka.get(U.toString()),z.set(Ba,U);return z}static Sgg(z){const U=new $d;U.EffectNodeId=
z.EffectNodeId;U.ShapeId=z.ShapeId;return U}static aPj(z,U){if(!(z&&z.length&&U&&U.length)||z.length>U.length)return!1;const ka=z[z.length-1],Ba=U.indexOf(z[0]);return U.indexOf(ka)-Ba+1==z.length}static i9i(z){const U=[];if(!z)return U;z=z.T1;if(!z||!z.Sequences)return U;for(const ka of z.Sequences[0].Effects)U.push(ka);return U.sort((ka,Ba)=>ka.EffectNodeId-Ba.EffectNodeId)}mNf(z,U,ka){return 0!==ka.SequenceId&&0!==ka.EffectId&&this.S8a(ka,z)&&(z.Pf||2!==ka.EffectType||1!==ka.EffectId&&7!==ka.EffectId)&&
(z.q3||this.gNd(z,ka)||this.fNd(z,U,ka))}Qki(z,U,ka){return z&&0!==ka.BuildType&&0!==ka.EffectId&&this.wVc(ka)&&(z.Pf||2!==ka.EffectType||1!==ka.EffectId&&7!==ka.EffectId)&&(z.q3||this.qNf(z,ka)||this.oNf(z,U,ka))}nNf(z,U){for(let [ka,Ba]of U)if(!this.Qki(Ba,z,ka))return!1;return!0}kNf(z,U,ka){return 0!==ka.SequenceId&&!z.q3&&!z.qd&&0!==ka.EffectId&&this.S8a(ka,z)&&(z.Pf||2!==ka.EffectType||1!==ka.EffectId&&7!==ka.EffectId)&&(z.Sk||z.Pf||z.isEditable&&0<U.kca(z).length)}Pki(z,U,ka){return z&&0!==
ka.BuildType&&!z.q3&&!z.qd&&0!==ka.EffectId&&this.wVc(ka)&&(z.Pf||2!==ka.EffectType||1!==ka.EffectId&&7!==ka.EffectId)&&(z.Sk||z.Pf||z.isEditable&&0<U.kca(z).length)}lNf(z,U){for(let [ka,Ba]of U)if(!this.Pki(Ba,z,ka))return!1;return!0}fNd(z,U,ka){return 0!==ka.SequenceId&&!z.Pf&&!z.q3&&!z.qd&&0!==ka.EffectId&&this.S8a(ka,z)&&(2!==ka.EffectType||1!==ka.EffectId&&7!==ka.EffectId)&&(z.Sk||z.isEditable&&0<U.kca(z).length)}oNf(z,U,ka){return z&&0!==ka.BuildType&&!z.Pf&&!z.q3&&!z.qd&&0!==ka.EffectId&&this.wVc(ka)&&
(2!==ka.EffectType||1!==ka.EffectId&&7!==ka.EffectId)&&(z.Sk||z.isEditable&&0<U.kca(z).length)}pNf(z,U){for(let [ka,Ba]of U)if(!this.oNf(Ba,z,ka))return!1;return!0}gNd(z,U){return 0!==U.SequenceId&&z.Pf&&0!==U.EffectId&&this.S8a(U,z)}qNf(z,U){return z&&0!==U.BuildType&&z.Pf&&0!==U.EffectId&&this.wVc(U)}rNf(z){for(let [U,ka]of z)if(!this.qNf(ka,U))return!1;return!0}static Ze(z){return Dd.a.fgc+"_"+z+"_32x32x32"}static F4i(z,U){switch(U){case "Direction":return z.In;case "EffectData":return z.pn;default:return null}}static G4i(z,
U){switch(U){case "Direction":return Jb.rl.ga(z);case "EffectData":return Jb.rS.ga(z);default:return null}}}Jb.rl=null;Jb.rS=null;Jb.Xl=null;Object(h.a)(Jb,"AnimationHelper",null,[639]);class Gc{constructor(z,U,ka,Ba,Ia,Ab,Ob){this.MD=null;this.bRe=!1;this.WFa=ka;this.ra=z;(this.hua=Ba)&&Ia.execute(Yb=>{this.MD=Yb});this.ta=Ob;this.ia=U;this.Kka=Ab}selectShape(){this.ra&&!this.ra.uW(this.ta)&&this.ra.selectShape(this.ta,!0)}onVolumeChanged(z){const U={ActionFromPlayer:!0};.2>=z?(U.SourceControlId=
"SetVolumeLow",this.ia.La(Qc.a.cMe,2,U)):.2<z&&.8>z?(U.SourceControlId="SetVolumeMedium",this.ia.La(Qc.a.dMe,2,U)):.8<=z&&(U.SourceControlId="SetVolumeHigh",this.ia.La(Qc.a.bMe,2,U));this.selectShape()}onPlayToggled(z){const U={ActionFromPlayer:!0};z?this.ia.La(Qc.a.dLd,2,U):this.ia.La(Qc.a.KCc,2,U);this.selectShape()}onMuteToggled(z){if(z)this.ia.La(Qc.a.eMe,2,{ActionFromPlayer:!0,SourceControlId:"SetVolumeMute"});else this.onVolumeChanged(this.ta.media.vlmField);this.selectShape()}onPlayerReadyStateChanged(z){z&&
appChrome.api.dispatch(appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1))}onMouseHoverStateChanged(z){z||this.ra.jce(this.ta)||(z=this.FK())&&z.showHidePlayer(!1)}onPlayerClicked(){this.hua&&this.ia.processAction(Qc.a.pKb,2)}onPlayerError(z){Jc.a.J(512497820,822,10,"AudioLibraryCallback::OnPlayerError Error Message: {0}",z);z&&-1<z.indexOf("PIPELINE_ERROR_READ")&&this.WFa.w1d(this.Kka.podSessionId,this.ta).then(U=>{const ka=this.FK();ka&&ka.setAudioSrc(U)})}onKeyDown(z){z===Bg.a.ajb?
(z=this.FK())&&z.removeFocusFromPlayer():z===Bg.a.Iq&&(this.bRe=!0)}onBlur(){const z=this.FK();z&&(this.bRe?z.setFocusOnPlayer():z.removeFocusFromPlayer());this.bRe=!1}FK(){return this.hua&&this.MD?this.MD.FK(this.ta):null}}Object(h.a)(Gc,"AudioLibraryCallback",null,[654]);class pd{constructor(z,U,ka,Ba,Ia,Ab){this.WFa=z;this.ra=U;this.ia=ka;this.hua=Ba;this.x$a=Ab;this.Kka=Ia}ayi(z){return new Gc(this.ra,this.ia,this.WFa,this.hua,this.x$a,this.Kka,z)}}Object(h.a)(pd,"AudioLibraryCallbackFactory",
null,[576]);class Ld{constructor(z,U,ka,Ba){this.volume=z;this.mute=U;this.repeat=ka;this.rewind=Ba}}Object(h.a)(Ld,"MediaProperties",null,[]);class de{constructor(z,U,ka,Ba){this.N0j=z;this.toe=U;this.WFa=ka;this.Kka=Ba}createAudioManager(z,U,ka){return new Promise((Ba,Ia)=>{this.toe("audioPlayback").then(()=>{window.self.audioPlayback?(Jc.a.J(512497818,801,50,"audio script is loaded successfully"),Ba(this.byi(z,U,ka))):(Jc.a.J(512497819,801,10,"Audio script is loaded successfully but AudioPlayback namespace cannot be found"),
Ia("Audio script is loaded successfully but AudioPlayback namespace cannot be found"))}).catch(Ab=>{Jc.a.J(512497817,801,10,"Failed to load audio script "+Ab.toString());Ia("Failed to load audio script ")})})}byi(z,U,ka){const Ba=U.media;let Ia=null;Ba&&(Ia=new Ld(Ba.vlmField,Ba.mteField,Ba.repeatField,Ba.rewindField));const Ab=audioPlayback.pptAudioFactoryGlobal.createAudioManager(z,ka,this.N0j.ayi(U),Ia);this.WFa.w1d(this.Kka.podSessionId,U).then(Ob=>{Ab&&Ab.setAudioSrc(Ob)});return Ab}}Object(h.a)(de,
"AudioManagerFactory",null,[577]);var Be=d(1219);class Mf{constructor(){this.Xxb=new Be.a}AMk(z,U){U&&this.Xxb.$(U.id,z)}kCh(z){z&&this.Xxb.Jb(z.id)&&(this.Xxb.ga(z.id).dispose(),this.Xxb.remove(z.id))}FK(z){return z&&this.Xxb.Jb(z.id)?this.Xxb.ga(z.id):null}}Object(h.a)(Mf,"AudioManagerStore",null,[575]);class Dg{sSj(z){return!Dg.utb(Dg.lBl)||z>Dg.tWe?!0:!1}static utb(z){return(z=document.getElementById(z))?z:null}}Dg.lBl="PptRibbon.Design.ThemeVariants-MaxSize";Dg.tWe=4;Object(h.a)(Dg,"ThemeHelper",
null,[595]);class yd{constructor(){this.Duration=this.Direction=0;this.IsManualAdvance=!1;this.TransitionType=0}}Object(h.a)(yd,"EditTransitionInfo",null,[]);class td{constructor(){this.next=this.parent=this.qc=this.qx=this.sc=this.nc=null}}Object(h.a)(td,"Transition",null,[]);class id{}id.none=0;id.SVi=5;id.TVi=4;id.Wnl=1;id.dlj=1;id.Ydi=2;id.x7=0;id.oQa=1;id.nCa=2;id.Gsb=3;id.LLc=4;id.KLc=5;id.OLc=6;id.NLc=7;id.UPc=2;id.fSa=1;id.Tkj=1;id.KLf=0;id.Phi=1;id.Ohi=2;id.Vkj=0;id.Ukj=1;id.Hig=2;id.elj=
3;id.I4d=0;id.l2b=1;id.TPc=0;id.K7a=1;id.rei=1;id.iKf=0;id.euh=2;id.lhl=0;id.Ynl=3;id.Xnl=1;id.wheel=1;id.Kih=29;id.G7f=0;id.nXi=1;id.wXi=2;id.GXi=3;id.F7f=8;id.mXi=9;id.vXi=10;id.FXi=11;id.H7f=12;id.qXi=13;id.yXi=14;id.JXi=15;id.I7f=4;id.rXi=5;id.zXi=6;id.KXi=7;id.xXi=0;id.HXi=1;id.BXi=2;id.oXi=3;id.B7f=4;id.IXi=5;id.CXi=6;id.pXi=7;Object(h.a)(id,"TransitionEffectOptions",null,[]);class ed{}ed.none=0;ed.cut=0;ed.random=1;ed.blinds=2;ed.jOd=3;ed.iBa=4;ed.dissolve=5;ed.fade=6;ed.lKa=7;ed.zEe=8;ed.Rod=
9;ed.wipe=10;ed.Dph=11;ed.split=13;ed.G9k=17;ed.L9k=18;ed.wedge=19;ed.push=20;ed.cPd=21;ed.zGf=23;ed.wheel=26;ed.Aph=27;ed.Kpc=28;ed.sGb=29;ed.eDa=30;ed.bkc=39;ed.QQe=42;ed.flip=43;ed.TL=44;ed.ICl=47;ed.TWd=48;ed.EUd=49;ed.XEi=50;ed.MWe=51;ed.dCk=52;ed.WWi=53;ed.mEi=54;ed.cAe=55;ed.G4g=56;ed.yze=57;ed.vJd=58;ed.lze=59;ed.morph=60;ed.pan=36;ed.bZd=38;ed.rQd=37;ed.wUd=33;ed.window=34;ed.M_b=32;ed.zoom=31;ed.XDl=22;Object(h.a)(ed,"TransitionTypes",null,[]);class Oc{constructor(z){let U=0;this.zc=new da.a;
this.zc.$("TransitionExisting",Object.assign(new td,{nc:ResourceStrings.L_TransitionExisting,sc:Oc.Ec("TransitionFlash"),parent:"TransitionExisting"}));this.zc.$("TransitionExistingInMenu",Object.assign(new td,{nc:ResourceStrings.L_TransitionExisting,sc:Oc.Ec("TransitionFlash"),parent:"TransitionExisting"}));this.zc.$("TransitionNone",Object.assign(new td,{nc:ResourceStrings.L_TransitionNone,sc:Oc.Ec("TransitionNone"),qc:Object.assign(new yd,{TransitionType:ed.none,Direction:id.Ydi,Duration:0,IsManualAdvance:!0}),
parent:"TransitionNone"}));this.zc.$("TransitionFade",Object.assign(new td,{nc:ResourceStrings.L_TransitionFade,sc:Oc.Ec("TransitionFadeSmoothly"),qc:Object.assign(new yd,{TransitionType:ed.zGf,Direction:id.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeSmoothly"}));this.zc.$("TransitionFadeSmoothly",Object.assign(new td,{nc:ResourceStrings.L_TransitionSmoothly,qx:CommonUIStrings.l_TransitionFadeSmoothlyKeytip,sc:Oc.Ec("TransitionFadeSmoothly"),qc:Object.assign(new yd,
{TransitionType:ed.zGf,Direction:id.none,Duration:700,IsManualAdvance:!0}),parent:"TransitionFade",next:"TransitionFadeThroughBlack"}));this.zc.$("TransitionFadeThroughBlack",Object.assign(new td,{nc:ResourceStrings.L_TransitionThroughBlack,qx:CommonUIStrings.l_TransitionFadeThroughBlackKeytip,sc:Oc.Ec("TransitionFadeThroughBlack"),qc:Object.assign(new yd,{TransitionType:ed.fade,Direction:id.none,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionFade"}));let ka=[];if(z){ka=z.toLowerCase().split(",");
for(let Ba=0;Ba<ka.length;Ba++)ka[Ba]=ka[Ba].trim()}Array.contains(ka,"push")||(this.zc.$("TransitionPush",Object.assign(new td,{nc:ResourceStrings.L_TransitionPush,sc:Oc.Ec("TransitionPushUp"),qc:Object.assign(new yd,{TransitionType:ed.push,Direction:id.oQa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromBottom"})),this.zc.$("TransitionPushFromBottom",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromBottom,qx:CommonUIStrings.l_TransitionPushFromBottomKeytip,
sc:Oc.Ec("TransitionPushUp"),qc:Object.assign(new yd,{TransitionType:ed.push,Direction:id.oQa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromLeft"})),this.zc.$("TransitionPushFromLeft",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromLeft,qx:CommonUIStrings.l_TransitionPushFromLeftKeytip,sc:Oc.Ec("TransitionPushRight"),qc:Object.assign(new yd,{TransitionType:ed.push,Direction:id.nCa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromRight"})),
this.zc.$("TransitionPushFromRight",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromRight,qx:CommonUIStrings.l_TransitionPushFromRightKeytip,sc:Oc.Ec("TransitionPushLeft"),qc:Object.assign(new yd,{TransitionType:ed.push,Direction:id.x7,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush",next:"TransitionPushFromTop"})),this.zc.$("TransitionPushFromTop",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromTop,qx:CommonUIStrings.l_TransitionPushFromTopKeytip,sc:Oc.Ec("TransitionPushDown"),
qc:Object.assign(new yd,{TransitionType:ed.push,Direction:id.Gsb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionPush"})));Array.contains(ka,"cut")||(this.zc.$("TransitionCut",Object.assign(new td,{nc:ResourceStrings.L_TransitionCut,sc:Oc.Ec("TransitionCut"),qc:Object.assign(new yd,{TransitionType:ed.cut,Direction:id.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutNone"})),this.zc.$("TransitionCutNone",Object.assign(new td,{nc:ResourceStrings.L_TransitionNone,
qx:CommonUIStrings.l_TransitionCutNoneKeytip,sc:Oc.Ec("TransitionCut"),qc:Object.assign(new yd,{TransitionType:ed.cut,Direction:id.none,Duration:100,IsManualAdvance:!0}),parent:"TransitionCut",next:"TransitionCutThroughBlack"})),this.zc.$("TransitionCutThroughBlack",Object.assign(new td,{nc:ResourceStrings.L_TransitionThroughBlack,qx:CommonUIStrings.l_TransitionCutThroughBlackKeytip,sc:Oc.Ec("TransitionCutThroughBlack"),qc:Object.assign(new yd,{TransitionType:ed.cut,Direction:id.Wnl,Duration:500,
IsManualAdvance:!0}),parent:"TransitionCut"})));Array.contains(ka,"wipe")||(this.zc.$("TransitionWipe",Object.assign(new td,{nc:ResourceStrings.L_TransitionWipe,sc:Oc.Ec("TransitionWipeLeft"),qc:Object.assign(new yd,{TransitionType:ed.wipe,Direction:id.x7,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromRight"})),this.zc.$("TransitionWipeFromRight",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromRight,qx:CommonUIStrings.l_TransitionWipeFromRightKeytip,sc:Oc.Ec("TransitionWipeLeft"),
qc:Object.assign(new yd,{TransitionType:ed.wipe,Direction:id.x7,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTop"})),this.zc.$("TransitionWipeFromTop",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromTop,qx:CommonUIStrings.l_TransitionWipeFromTopKeytip,sc:Oc.Ec("TransitionWipeDown"),qc:Object.assign(new yd,{TransitionType:ed.wipe,Direction:id.Gsb,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromLeft"})),this.zc.$("TransitionWipeFromLeft",
Object.assign(new td,{nc:ResourceStrings.L_TransitionFromLeft,qx:CommonUIStrings.l_TransitionWipeFromLeftKeytip,sc:Oc.Ec("TransitionWipeRight"),qc:Object.assign(new yd,{TransitionType:ed.wipe,Direction:id.nCa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottom"})),this.zc.$("TransitionWipeFromBottom",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromBottom,qx:CommonUIStrings.l_TransitionWipeFromBottomKeytip,sc:Oc.Ec("TransitionWipeUp"),qc:Object.assign(new yd,
{TransitionType:ed.wipe,Direction:id.oQa,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopRight"})),this.zc.$("TransitionWipeFromTopRight",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromTopRight,qx:CommonUIStrings.l_TransitionWipeFromTopRightKeytip,sc:Oc.Ec("TransitionStripsLeftDown"),qc:Object.assign(new yd,{TransitionType:ed.Rod,Direction:id.OLc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomRight"})),this.zc.$("TransitionWipeFromBottomRight",
Object.assign(new td,{nc:ResourceStrings.L_TransitionFromBottomRight,qx:CommonUIStrings.l_TransitionWipeFromBottomRightKeytip,sc:Oc.Ec("TransitionStripsLeftUp"),qc:Object.assign(new yd,{TransitionType:ed.Rod,Direction:id.LLc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromTopLeft"})),this.zc.$("TransitionWipeFromTopLeft",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromTopLeft,qx:CommonUIStrings.l_TransitionWipeFromTopLeftKeytip,sc:Oc.Ec("TransitionStripsRightDown"),
qc:Object.assign(new yd,{TransitionType:ed.Rod,Direction:id.NLc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe",next:"TransitionWipeFromBottomLeft"})),this.zc.$("TransitionWipeFromBottomLeft",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromBottomLeft,qx:CommonUIStrings.l_TransitionWipeFromBottomLeftKeytip,sc:Oc.Ec("TransitionStripsRightUp"),qc:Object.assign(new yd,{TransitionType:ed.Rod,Direction:id.KLc,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionWipe"})));Array.contains(ka,
"morph")||(this.zc.$("TransitionMorph",Object.assign(new td,{nc:ResourceStrings.L_TransitionMorph,sc:Oc.Ec("TransitionByObject"),qc:Object.assign(new yd,{TransitionType:ed.morph,Direction:id.KLf,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByObject"})),this.zc.$("TransitionMorphByObject",Object.assign(new td,{nc:ResourceStrings.L_TransitionByObject,qx:CommonUIStrings.l_TransitionMorphObjectsKeytip,sc:Oc.Ec("TransitionByObject"),qc:Object.assign(new yd,{TransitionType:ed.morph,
Direction:id.KLf,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByWord"})),this.zc.$("TransitionMorphByWord",Object.assign(new td,{nc:ResourceStrings.L_TransitionByWord,qx:CommonUIStrings.l_TransitionMorphWordsKeytip,sc:Oc.Ec("TransitionByWord"),qc:Object.assign(new yd,{TransitionType:ed.morph,Direction:id.Phi,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph",next:"TransitionMorphByChar"})),this.zc.$("TransitionMorphByChar",Object.assign(new td,{nc:ResourceStrings.L_TransitionByChar,
qx:CommonUIStrings.l_TransitionMorphCharactersKeytip,sc:Oc.Ec("TransitionByChar"),qc:Object.assign(new yd,{TransitionType:ed.morph,Direction:id.Ohi,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionMorph"})));Array.contains(ka,"split")||(this.zc.$("TransitionSplit",Object.assign(new td,{nc:ResourceStrings.L_TransitionSplit,sc:Oc.Ec("TransitionSplitOutVertical"),qc:Object.assign(new yd,{TransitionType:ed.split,Direction:id.Hig,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitVerticalOut"})),
this.zc.$("TransitionSplitVerticalOut",Object.assign(new td,{nc:ResourceStrings.L_TransitionVerticalOut,qx:CommonUIStrings.l_TransitionSplitVerticalOutKeytip,sc:Oc.Ec("TransitionSplitOutVertical"),qc:Object.assign(new yd,{TransitionType:ed.split,Direction:id.Hig,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalIn"})),this.zc.$("TransitionSplitHorizontalIn",Object.assign(new td,{nc:ResourceStrings.L_TransitionHorizontalIn,qx:CommonUIStrings.l_TransitionSplitHorizontalInKeytip,
sc:Oc.Ec("TransitionSplitInHorizontal"),qc:Object.assign(new yd,{TransitionType:ed.split,Direction:id.Ukj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit",next:"TransitionSplitHorizontalOut"})),this.zc.$("TransitionSplitHorizontalOut",Object.assign(new td,{nc:ResourceStrings.L_TransitionHorizontalOut,qx:CommonUIStrings.l_TransitionSplitHorizontalOutKeytip,sc:Oc.Ec("TransitionSplitOutHorizontal"),qc:Object.assign(new yd,{TransitionType:ed.split,Direction:id.Vkj,Duration:1500,IsManualAdvance:!0}),
parent:"TransitionSplit",next:"TransitionSplitVerticalIn"})),this.zc.$("TransitionSplitVerticalIn",Object.assign(new td,{nc:ResourceStrings.L_TransitionVerticalIn,qx:CommonUIStrings.l_TransitionSplitVerticalInKeytip,sc:Oc.Ec("TransitionSplitInVertical"),qc:Object.assign(new yd,{TransitionType:ed.split,Direction:id.elj,Duration:1500,IsManualAdvance:!0}),parent:"TransitionSplit"})));if(!Array.contains(ka,"randombars")){this.zc.$("TransitionRandomBars",Object.assign(new td,{nc:ResourceStrings.L_TransitionRandomBars,
sc:Oc.Ec("TransitionRandomBarsVertical"),qc:Object.assign(new yd,{TransitionType:ed.zEe,Direction:id.K7a,Duration:1E3,IsManualAdvance:!0}),parent:"TransitionRandomBars",next:"TransitionRandomBarsVertical"}));this.zc.$("TransitionRandomBarsVertical",Object.assign(new td,{nc:ResourceStrings.L_TransitionVertical,qx:CommonUIStrings.l_TransitionRandomBarsVerticalKeytip,sc:Oc.Ec("TransitionRandomBarsVertical"),qc:Object.assign(new yd,{TransitionType:ed.zEe,Direction:id.K7a,Duration:1E3,IsManualAdvance:!0}),
parent:"TransitionRandomBars",next:"TransitionRandomBarsHorizontal"}));let Ba,Ia;this.zc.$("TransitionRandomBarsHorizontal",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionHorizontal,Ia.qx=CommonUIStrings.l_TransitionRandomBarsHorizontalKeytip,Ia.sc=Oc.Ec("TransitionRandomBarsHorizontal"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.zEe,Ba.Direction=id.TPc,Ba.Duration=1E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionRandomBars",Ia))}if(!Array.contains(ka,"shape")){let Ba,Ia;this.zc.$("TransitionShape",(Ia=
new td,Ia.nc=ResourceStrings.L_TransitionShape,Ia.sc=Oc.Ec("TransitionShapeCircle"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.Aph,Ba.Direction=id.none,Ba.Duration=800,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionShape",Ia.next="TransitionShapeCircle",Ia));let Ab,Ob;this.zc.$("TransitionShapeCircle",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionCircle,Ob.qx=CommonUIStrings.l_TransitionShapeCircleKeytip,Ob.sc=Oc.Ec("TransitionShapeCircle"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.Aph,Ab.Direction=id.none,
Ab.Duration=800,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionShape",Ob.next="TransitionShapeDiamond",Ob));let Yb,uc;this.zc.$("TransitionShapeDiamond",(uc=new td,uc.nc=ResourceStrings.L_TransitionDiamond,uc.qx=CommonUIStrings.l_TransitionShapeDiamondKeytip,uc.sc=Oc.Ec("TransitionShapeDiamond"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.G9k,Yb.Direction=id.none,Yb.Duration=800,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionShape",uc.next="TransitionShapePlus",uc));let mc,Ec;this.zc.$("TransitionShapePlus",
(Ec=new td,Ec.nc=ResourceStrings.L_TransitionPlus,Ec.qx=CommonUIStrings.l_TransitionShapePlusKeytip,Ec.sc=Oc.Ec("TransitionShapePlus"),Ec.qc=(mc=new yd,mc.TransitionType=ed.L9k,mc.Direction=id.none,mc.Duration=1E3,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionShape",Ec.next="TransitionShapeIn",Ec));let Yc,jd;this.zc.$("TransitionShapeIn",(jd=new td,jd.nc=ResourceStrings.L_TransitionIn,jd.qx=CommonUIStrings.l_TransitionShapeInKeytip,jd.sc=Oc.Ec("TransitionBoxIn"),jd.qc=(Yc=new yd,Yc.TransitionType=
ed.Dph,Yc.Direction=id.l2b,Yc.Duration=1200,Yc.IsManualAdvance=!0,Yc),jd.parent="TransitionShape",jd.next="TransitionShapeOut",jd));let vd,he;this.zc.$("TransitionShapeOut",(he=new td,he.nc=ResourceStrings.L_TransitionOut,he.qx=CommonUIStrings.l_TransitionShapeOutKeytip,he.sc=Oc.Ec("TransitionBoxOut"),he.qc=(vd=new yd,vd.TransitionType=ed.Dph,vd.Direction=id.I4d,vd.Duration=1200,vd.IsManualAdvance=!0,vd),he.parent="TransitionShape",he))}if(!Array.contains(ka,"reveal")){let Ba,Ia;this.zc.$("TransitionReveal",
(Ia=new td,Ia.nc=ResourceStrings.L_TransitionReveal,Ia.sc=Oc.Ec("TransitionRevealSmoothlyFromRight"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.bkc,Ba.Direction=id.euh,Ba.Duration=3400,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionReveal",Ia.next="TransitionRevealSmoothlyFromRight",Ia));let Ab,Ob;this.zc.$("TransitionRevealSmoothlyFromRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionSmoothlyFromRight,Ob.sc=Oc.Ec("TransitionRevealSmoothlyFromRight"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.bkc,Ab.Direction=
id.euh,Ab.Duration=3400,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionReveal",Ob.next="TransitionRevealSmoothlyFromLeft",Ob));let Yb,uc;this.zc.$("TransitionRevealSmoothlyFromLeft",(uc=new td,uc.nc=ResourceStrings.L_TransitionSmoothlyFromLeft,uc.sc=Oc.Ec("TransitionRevealSmoothlyFromLeft"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.bkc,Yb.Direction=id.lhl,Yb.Duration=3400,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionReveal",uc.next="TransitionRevealFromRight",uc));let mc,Ec;this.zc.$("TransitionRevealFromRight",
(Ec=new td,Ec.nc=ResourceStrings.L_TransitionThroughBlackFromRight,Ec.sc=Oc.Ec("TransitionRevealFromRight"),Ec.qc=(mc=new yd,mc.TransitionType=ed.bkc,mc.Direction=id.Ynl,mc.Duration=3400,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionReveal",Ec.next="TransitionRevealFromLeft",Ec));let Yc,jd;this.zc.$("TransitionRevealFromLeft",(jd=new td,jd.nc=ResourceStrings.L_TransitionThroughBlackFromLeft,jd.sc=Oc.Ec("TransitionRevealFromLeft"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.bkc,Yc.Direction=id.Xnl,Yc.Duration=
3400,Yc.IsManualAdvance=!0,Yc),jd.parent="TransitionReveal",jd))}if(!Array.contains(ka,"cover")){let Ba,Ia;this.zc.$("TransitionCover",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionCover,Ia.sc=Oc.Ec("TransitionCoverLeft"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.iBa,Ba.Direction=id.x7,Ba.Duration=1E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionCover",Ia.next="TransitionCoverFromRight",Ia));let Ab,Ob;this.zc.$("TransitionCoverFromRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionFromRight,Ob.sc=Oc.Ec("TransitionCoverLeft"),
Ob.qc=(Ab=new yd,Ab.TransitionType=ed.iBa,Ab.Direction=id.x7,Ab.Duration=1E3,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionCover",Ob.next="TransitionCoverFromTop",Ob));let Yb,uc;this.zc.$("TransitionCoverFromTop",(uc=new td,uc.nc=ResourceStrings.L_TransitionFromTop,uc.sc=Oc.Ec("TransitionCoverDown"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.iBa,Yb.Direction=id.Gsb,Yb.Duration=1E3,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionCover",uc.next="TransitionCoverFromLeft",uc));let mc,Ec;this.zc.$("TransitionCoverFromLeft",
(Ec=new td,Ec.nc=ResourceStrings.L_TransitionFromLeft,Ec.sc=Oc.Ec("TransitionCoverRight"),Ec.qc=(mc=new yd,mc.TransitionType=ed.iBa,mc.Direction=id.nCa,mc.Duration=1E3,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionCover",Ec.next="TransitionCoverFromBottom",Ec));let Yc,jd;this.zc.$("TransitionCoverFromBottom",(jd=new td,jd.nc=ResourceStrings.L_TransitionFromBottom,jd.sc=Oc.Ec("TransitionCoverUp"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.iBa,Yc.Direction=id.oQa,Yc.Duration=1E3,Yc.IsManualAdvance=!0,Yc),
jd.parent="TransitionCover",jd.next="TransitionCoverFromTopRight",jd));let vd,he;this.zc.$("TransitionCoverFromTopRight",(he=new td,he.nc=ResourceStrings.L_TransitionFromTopRight,he.sc=Oc.Ec("TransitionCoverLeftDown"),he.qc=(vd=new yd,vd.TransitionType=ed.iBa,vd.Direction=id.OLc,vd.Duration=1E3,vd.IsManualAdvance=!0,vd),he.parent="TransitionCover",he.next="TransitionCoverFromBottomRight",he));let nd,ee;this.zc.$("TransitionCoverFromBottomRight",(ee=new td,ee.nc=ResourceStrings.L_TransitionFromBottomRight,
ee.sc=Oc.Ec("TransitionCoverLeftUp"),ee.qc=(nd=new yd,nd.TransitionType=ed.iBa,nd.Direction=id.LLc,nd.Duration=1E3,nd.IsManualAdvance=!0,nd),ee.parent="TransitionCover",ee.next="TransitionCoverFromTopLeft",ee));let Ue,n;this.zc.$("TransitionCoverFromTopLeft",(n=new td,n.nc=ResourceStrings.L_TransitionFromTopLeft,n.sc=Oc.Ec("TransitionCoverRightDown"),n.qc=(Ue=new yd,Ue.TransitionType=ed.iBa,Ue.Direction=id.NLc,Ue.Duration=1E3,Ue.IsManualAdvance=!0,Ue),n.parent="TransitionCover",n.next="TransitionCoverFromBottomLeft",
n));let Y,ra;this.zc.$("TransitionCoverFromBottomLeft",(ra=new td,ra.nc=ResourceStrings.L_TransitionFromBottomLeft,ra.sc=Oc.Ec("TransitionCoverRightUp"),ra.qc=(Y=new yd,Y.TransitionType=ed.iBa,Y.Direction=id.KLc,Y.Duration=1E3,Y.IsManualAdvance=!0,Y),ra.parent="TransitionCover",ra))}if(!Array.contains(ka,"uncover")){let Ba,Ia;this.zc.$("TransitionUncover",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionUncover,Ia.sc=Oc.Ec("TransitionUncoverLeft"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.lKa,Ba.Direction=
id.x7,Ba.Duration=750,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionUncover",Ia.next="TransitionUncoverFromRight",Ia));let Ab,Ob;this.zc.$("TransitionUncoverFromRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionFromRight,Ob.sc=Oc.Ec("TransitionUncoverLeft"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.lKa,Ab.Direction=id.x7,Ab.Duration=750,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionUncover",Ob.next="TransitionUncoverFromTop",Ob));let Yb,uc;this.zc.$("TransitionUncoverFromTop",(uc=new td,uc.nc=ResourceStrings.L_TransitionFromTop,
uc.sc=Oc.Ec("TransitionUncoverDown"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.lKa,Yb.Direction=id.Gsb,Yb.Duration=750,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionUncover",uc.next="TransitionUncoverFromLeft",uc));let mc,Ec;this.zc.$("TransitionUncoverFromLeft",(Ec=new td,Ec.nc=ResourceStrings.L_TransitionFromLeft,Ec.sc=Oc.Ec("TransitionUncoverRight"),Ec.qc=(mc=new yd,mc.TransitionType=ed.lKa,mc.Direction=id.nCa,mc.Duration=750,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionUncover",Ec.next="TransitionUncoverFromBottom",
Ec));let Yc,jd;this.zc.$("TransitionUncoverFromBottom",(jd=new td,jd.nc=ResourceStrings.L_TransitionFromBottom,jd.sc=Oc.Ec("TransitionUncoverUp"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.lKa,Yc.Direction=id.oQa,Yc.Duration=750,Yc.IsManualAdvance=!0,Yc),jd.parent="TransitionUncover",jd.next="TransitionUncoverFromTopRight",jd));this.zc.$("TransitionUncoverFromTopRight",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromTopRight,sc:Oc.Ec("TransitionUncoverLeftDown"),qc:Object.assign(new yd,{TransitionType:ed.lKa,
Direction:id.OLc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomRight"}));this.zc.$("TransitionUncoverFromBottomRight",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromBottomRight,sc:Oc.Ec("TransitionUncoverLeftUp"),qc:Object.assign(new yd,{TransitionType:ed.lKa,Direction:id.LLc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromTopLeft"}));this.zc.$("TransitionUncoverFromTopLeft",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromTopLeft,
sc:Oc.Ec("TransitionUncoverRightDown"),qc:Object.assign(new yd,{TransitionType:ed.lKa,Direction:id.NLc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover",next:"TransitionUncoverFromBottomLeft"}));this.zc.$("TransitionUncoverFromBottomLeft",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromBottomLeft,sc:Oc.Ec("TransitionUncoverRightUp"),qc:Object.assign(new yd,{TransitionType:ed.lKa,Direction:id.KLc,Duration:750,IsManualAdvance:!0}),parent:"TransitionUncover"}))}if(!Array.contains(ka,
"menusectionexciting")){if(!Array.contains(ka,"fallover")){this.zc.$("TransitionFallOver",Object.assign(new td,{nc:ResourceStrings.L_TransitionFallOver,sc:Oc.Ec("TransitionFallOverLeft"),qc:Object.assign(new yd,{TransitionType:ed.TWd,Direction:id.none,Duration:2E3,IsManualAdvance:!0}),parent:"TransitionFallOver",next:"TransitionFallOverLeft"}));let Ba,Ia;this.zc.$("TransitionFallOverLeft",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionGoLeft,Ia.sc=Oc.Ec("TransitionFallOverLeft"),Ia.qc=(Ba=new yd,Ba.TransitionType=
ed.TWd,Ba.Direction=id.none,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionFallOver",Ia.next="TransitionFallOverRight",Ia));let Ab,Ob;this.zc.$("TransitionFallOverRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionGoRight,Ob.sc=Oc.Ec("TransitionFallOverRight"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.TWd,Ab.Direction=id.fSa,Ab.Duration=2E3,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionFallOver",Ob))}if(!Array.contains(ka,"drape")){let Ba,Ia;this.zc.$("TransitionDrape",(Ia=new td,Ia.nc=
ResourceStrings.L_TransitionDrape,Ia.sc=Oc.Ec("TransitionDrapeLeft"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.EUd,Ba.Direction=id.none,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionDrape",Ia.next="TransitionDrapeLeft",Ia));let Ab,Ob;this.zc.$("TransitionDrapeLeft",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionGoLeft,Ob.sc=Oc.Ec("TransitionDrapeLeft"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.EUd,Ab.Direction=id.none,Ab.Duration=2E3,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionDrape",Ob.next=
"TransitionDrapeRight",Ob));let Yb,uc;this.zc.$("TransitionDrapeRight",(uc=new td,uc.nc=ResourceStrings.L_TransitionGoRight,uc.sc=Oc.Ec("TransitionDrapeRight"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.EUd,Yb.Direction=id.fSa,Yb.Duration=2E3,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionDrape",uc))}if(!Array.contains(ka,"curtains")){let Ba,Ia;this.zc.$("TransitionCurtains",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionCurtains,Ia.sc=Oc.Ec("TransitionCurtains"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.XEi,
Ba.Direction=id.none,Ba.Duration=6E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionCurtains",Ia))}if(!Array.contains(ka,"wind")){let Ba,Ia;this.zc.$("TransitionWind",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionWind,Ia.sc=Oc.Ec("TransitionWindRight"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.MWe,Ba.Direction=id.none,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionWind",Ia.next="TransitionWindRight",Ia));let Ab,Ob;this.zc.$("TransitionWindRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionGoRight,
Ob.sc=Oc.Ec("TransitionWindRight"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.MWe,Ab.Direction=id.none,Ab.Duration=2E3,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionWind",Ob.next="TransitionWindLeft",Ob));let Yb,uc;this.zc.$("TransitionWindLeft",(uc=new td,uc.nc=ResourceStrings.L_TransitionGoLeft,uc.sc=Oc.Ec("TransitionWindLeft"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.MWe,Yb.Direction=id.fSa,Yb.Duration=2E3,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionWind",uc))}if(!Array.contains(ka,"prestige")){let Ba,
Ia;this.zc.$("TransitionPrestige",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionPrestige,Ia.sc=Oc.Ec("TransitionPrestige"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.dCk,Ba.Direction=id.none,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionPrestige",Ia))}if(!Array.contains(ka,"fracture")){let Ba,Ia;this.zc.$("TransitionFracture",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionFracture,Ia.sc=Oc.Ec("TransitionFracture"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.WWi,Ba.Direction=id.none,Ba.Duration=
2E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionFracture",Ia))}if(!Array.contains(ka,"crush")){let Ba,Ia;this.zc.$("TransitionCrush",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionCrush,Ia.sc=Oc.Ec("TransitionCrush"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.mEi,Ba.Direction=id.none,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionCrush",Ia))}if(!Array.contains(ka,"peeloff")){let Ba,Ia;this.zc.$("TransitionPeelOff",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionPeelOff,Ia.sc=Oc.Ec("TransitionPeelOffLeft"),
Ia.qc=(Ba=new yd,Ba.TransitionType=ed.cAe,Ba.Direction=id.none,Ba.Duration=1250,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionPeelOff",Ia.next="TransitionPeelOffLeft",Ia));let Ab,Ob;this.zc.$("TransitionPeelOffLeft",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionGoLeft,Ob.sc=Oc.Ec("TransitionPeelOffLeft"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.cAe,Ab.Direction=id.none,Ab.Duration=1250,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionPeelOff",Ob.next="TransitionPeelOffRight",Ob));let Yb,uc;this.zc.$("TransitionPeelOffRight",
(uc=new td,uc.nc=ResourceStrings.L_TransitionGoRight,uc.sc=Oc.Ec("TransitionPeelOffRight"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.cAe,Yb.Direction=id.fSa,Yb.Duration=1250,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionPeelOff",uc))}if(!Array.contains(ka,"pagecurl")){let Ba,Ia;this.zc.$("TransitionPageCurl",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionPageCurl,Ia.sc=Oc.Ec("TransitionTwoPageCurlFromRight"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.yze,Ba.Direction=id.none,Ba.Duration=1250,Ba.IsManualAdvance=
!0,Ba),Ia.parent="TransitionPageCurl",Ia.next="TransitionPageCurlDoubleLeft",Ia));let Ab,Ob;this.zc.$("TransitionPageCurlDoubleLeft",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionEffectOptionDoubleLeft,Ob.sc=Oc.Ec("TransitionTwoPageCurlFromRight"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.yze,Ab.Direction=id.none,Ab.Duration=1250,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionPageCurl",Ob.next="TransitionPageCurlDoubleRight",Ob));let Yb,uc;this.zc.$("TransitionPageCurlDoubleRight",(uc=new td,uc.nc=ResourceStrings.L_TransitionEffectOptionDoubleRight,
uc.sc=Oc.Ec("TransitionTwoPageCurlFromLeft"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.yze,Yb.Direction=id.fSa,Yb.Duration=1250,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionPageCurl",uc.next="TransitionPageCurlSingleLeft",uc));let mc,Ec;this.zc.$("TransitionPageCurlSingleLeft",(Ec=new td,Ec.nc=ResourceStrings.L_TransitionEffectOptionSingleLeft,Ec.sc=Oc.Ec("TransitionPageCurlFromRight"),Ec.qc=(mc=new yd,mc.TransitionType=ed.G4g,mc.Direction=id.none,mc.Duration=1250,mc.IsManualAdvance=!0,mc),Ec.parent=
"TransitionPageCurl",Ec.next="TransitionPageCurlSingleRight",Ec));let Yc,jd;this.zc.$("TransitionPageCurlSingleRight",(jd=new td,jd.nc=ResourceStrings.L_TransitionEffectOptionSingleRight,jd.sc=Oc.Ec("TransitionPageCurlFromLeft"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.G4g,Yc.Direction=id.fSa,Yc.Duration=1250,Yc.IsManualAdvance=!0,Yc),jd.parent="TransitionPageCurl",jd))}if(!Array.contains(ka,"airplane")){let Ba,Ia;this.zc.$("TransitionAirplane",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionAirplane,Ia.sc=
Oc.Ec("TransitionAirplaneRight"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.vJd,Ba.Direction=id.none,Ba.Duration=1250,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionAirplane",Ia.next="TransitionAirplaneRight",Ia));let Ab,Ob;this.zc.$("TransitionAirplaneRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionGoRight,Ob.sc=Oc.Ec("TransitionAirplaneRight"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.vJd,Ab.Direction=id.none,Ab.Duration=1250,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionAirplane",Ob.next="TransitionAirplaneLeft",
Ob));let Yb,uc;this.zc.$("TransitionAirplaneLeft",(uc=new td,uc.nc=ResourceStrings.L_TransitionGoLeft,uc.sc=Oc.Ec("TransitionAirplaneLeft"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.vJd,Yb.Direction=id.fSa,Yb.Duration=1250,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionAirplane",uc))}if(!Array.contains(ka,"origami")){let Ba,Ia;this.zc.$("TransitionOrigami",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionOrigami,Ia.sc=Oc.Ec("TransitionOrigamiRight"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.lze,Ba.Direction=
id.none,Ba.Duration=3250,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionOrigami",Ia.next="TransitionOrigamiRight",Ia));let Ab,Ob;this.zc.$("TransitionOrigamiRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionGoRight,Ob.sc=Oc.Ec("TransitionOrigamiRight"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.lze,Ab.Direction=id.none,Ab.Duration=3250,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionOrigami",Ob.next="TransitionOrigamiLeft",Ob));let Yb,uc;this.zc.$("TransitionOrigamiLeft",(uc=new td,uc.nc=ResourceStrings.L_TransitionGoLeft,
uc.sc=Oc.Ec("TransitionOrigamiLeft"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.lze,Yb.Direction=id.fSa,Yb.Duration=3250,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionOrigami",uc))}Array.contains(ka,"dissolve")||this.zc.$("TransitionDissolve",Object.assign(new td,{nc:ResourceStrings.L_TransitionDissolve,sc:Oc.Ec("TransitionDissolve"),qc:Object.assign(new yd,{TransitionType:ed.dissolve,Direction:id.none,Duration:1200,IsManualAdvance:!0}),parent:"TransitionDissolve"}));Array.contains(ka,"checker")||(this.zc.$("TransitionChecker",
Object.assign(new td,{nc:ResourceStrings.L_TransitionChecker,sc:Oc.Ec("TransitionCheckerboardAcross"),qc:Object.assign(new yd,{TransitionType:ed.jOd,Direction:id.none,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker",next:"TransitionCheckerFromLeft"})),this.zc.$("TransitionCheckerFromLeft",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromLeft,sc:Oc.Ec("TransitionCheckerboardAcross"),qc:Object.assign(new yd,{TransitionType:ed.jOd,Direction:id.none,Duration:2500,IsManualAdvance:!0}),
parent:"TransitionChecker",next:"TransitionCheckerFromTop"})),this.zc.$("TransitionCheckerFromTop",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromTop,sc:Oc.Ec("TransitionCheckerboardDown"),qc:Object.assign(new yd,{TransitionType:ed.jOd,Direction:id.Tkj,Duration:2500,IsManualAdvance:!0}),parent:"TransitionChecker"})));if(!Array.contains(ka,"blinds")){this.zc.$("TransitionBlinds",Object.assign(new td,{nc:ResourceStrings.L_TransitionBlinds,sc:Oc.Ec("TransitionBlindsVertical"),qc:Object.assign(new yd,
{TransitionType:ed.blinds,Direction:id.iKf,Duration:1600,IsManualAdvance:!0}),parent:"TransitionBlinds",next:"TransitionBlindsVertical"}));let Ba,Ia;this.zc.$("TransitionBlindsVertical",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionVertical,Ia.sc=Oc.Ec("TransitionBlindsVertical"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.blinds,Ba.Direction=id.iKf,Ba.Duration=1600,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionBlinds",Ia.next="TransitionBlindsHorizontal",Ia));let Ab,Ob;this.zc.$("TransitionBlindsHorizontal",
(Ob=new td,Ob.nc=ResourceStrings.L_TransitionHorizontal,Ob.sc=Oc.Ec("TransitionBlindsHorizontal"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.blinds,Ab.Direction=id.rei,Ab.Duration=1600,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionBlinds",Ob))}if(!Array.contains(ka,"wheel")){let Ba,Ia;this.zc.$("TransitionWheel",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionWheel,Ia.sc=Oc.Ec("TransitionWheelClockwise1"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.wheel,Ba.Direction=id.wheel,Ba.Duration=1E3,Ba.IsManualAdvance=
!0,Ba),Ia.parent="TransitionWheel",Ia.next="TransitionWheelClockwise",Ia));let Ab,Ob;this.zc.$("TransitionWheelClockwise",(Ob=new td,Ob.nc=ResourceStrings.l_TransitionWheelClockWise,Ob.sc=Oc.Ec("TransitionWheelClockwise1"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.wheel,Ab.Direction=id.wheel,Ab.Duration=1E3,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionWheel",Ob.next="TransitionWheelCounterclockwise",Ob));let Yb,uc;this.zc.$("TransitionWheelCounterclockwise",(uc=new td,uc.nc=ResourceStrings.l_TransitionWheelCounterClockWise,
uc.sc=Oc.Ec("TransitionWheelCounterclockwise1"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.ICl,Yb.Direction=id.wheel,Yb.Duration=1E3,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionWheel",uc.next="TransitionWheelWedge",uc));let mc,Ec;this.zc.$("TransitionWheelWedge",(Ec=new td,Ec.nc=ResourceStrings.l_TransitionWheelWedge,Ec.sc=Oc.Ec("TransitionWedge"),Ec.qc=(mc=new yd,mc.TransitionType=ed.wedge,mc.Direction=id.none,mc.Duration=1E3,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionWheel",Ec))}if(!Array.contains(ka,
"ripple")){let Ba,Ia;this.zc.$("TransitionRipple",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionRipple,Ia.sc=Oc.Ec("TransitionRipple"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.sGb,Ba.Direction=id.Kih,Ba.Duration=1400,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionRipple",Ia.next="TransitionRippleCenter",Ia));let Ab,Ob;this.zc.$("TransitionRippleCenter",(Ob=new td,Ob.nc=ResourceStrings.L_EffectOptionsDirectionCenter,Ob.sc=Oc.Ec("TransitionRipple"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.sGb,Ab.Direction=
id.Kih,Ab.Duration=1400,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionRipple",Ob.next="TransitionRippleBottomLeft",Ob));let Yb,uc;this.zc.$("TransitionRippleBottomLeft",(uc=new td,uc.nc=ResourceStrings.L_TransitionFromBottomLeft,uc.sc=Oc.Ec("TransitionRippleBottomLeft"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.sGb,Yb.Direction=id.KLc,Yb.Duration=1500,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionRipple",uc.next="TransitionRippleBottomRight",uc));let mc,Ec;this.zc.$("TransitionRippleBottomRight",(Ec=
new td,Ec.nc=ResourceStrings.L_TransitionFromBottomRight,Ec.sc=Oc.Ec("TransitionRippleBottomRight"),Ec.qc=(mc=new yd,mc.TransitionType=ed.sGb,mc.Direction=id.LLc,mc.Duration=1500,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionRipple",Ec.next="TransitionRippleTopRight",Ec));let Yc,jd;this.zc.$("TransitionRippleTopRight",(jd=new td,jd.nc=ResourceStrings.L_TransitionFromTopRight,jd.sc=Oc.Ec("TransitionRippleTopRight"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.sGb,Yc.Direction=id.OLc,Yc.Duration=1500,Yc.IsManualAdvance=
!0,Yc),jd.parent="TransitionRipple",jd.next="TransitionRippleTopLeft",jd));let vd,he;this.zc.$("TransitionRippleTopLeft",(he=new td,he.nc=ResourceStrings.L_TransitionFromTopLeft,he.sc=Oc.Ec("TransitionRippleTopLeft"),he.qc=(vd=new yd,vd.TransitionType=ed.sGb,vd.Direction=id.NLc,vd.Duration=1500,vd.IsManualAdvance=!0,vd),he.parent="TransitionRipple",he))}if(!Array.contains(ka,"glitter")){let Ba,Ia;this.zc.$("TransitionGlitter",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionGlitter,Ia.sc=Oc.Ec("TransitionGlitterHexagonLeft"),
Ia.qc=(Ba=new yd,Ba.TransitionType=ed.eDa,Ba.Direction=id.B7f,Ba.Duration=3900,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionGlitter",Ia.next="TransitionGlitterHexagonLeft",Ia));let Ab,Ob;this.zc.$("TransitionGlitterHexagonLeft",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionHexagonsFromLeft,Ob.sc=Oc.Ec("TransitionGlitterHexagonLeft"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.eDa,Ab.Direction=id.B7f,Ab.Duration=3900,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionGlitter",Ob.next="TransitionGlitterHexagonTop",
Ob));let Yb,uc;this.zc.$("TransitionGlitterHexagonTop",(uc=new td,uc.nc=ResourceStrings.L_TransitionHexagonsFromTop,uc.sc=Oc.Ec("TransitionGlitterHexagonTop"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.eDa,Yb.Direction=id.IXi,Yb.Duration=3900,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionGlitter",uc.next="TransitionGlitterHexagonRight",uc));let mc,Ec;this.zc.$("TransitionGlitterHexagonRight",(Ec=new td,Ec.nc=ResourceStrings.L_TransitionHexagonsFromRight,Ec.sc=Oc.Ec("TransitionGlitterHexagonRight"),Ec.qc=
(mc=new yd,mc.TransitionType=ed.eDa,mc.Direction=id.CXi,mc.Duration=3900,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionGlitter",Ec.next="TransitionGlitterHexagonBottom",Ec));let Yc,jd;this.zc.$("TransitionGlitterHexagonBottom",(jd=new td,jd.nc=ResourceStrings.L_TransitionHexagonsFromBottom,jd.sc=Oc.Ec("TransitionGlitterHexagonBottom"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.eDa,Yc.Direction=id.pXi,Yc.Duration=3900,Yc.IsManualAdvance=!0,Yc),jd.parent="TransitionGlitter",jd.next="TransitionGlitterDiamondLeft",
jd));let vd,he;this.zc.$("TransitionGlitterDiamondLeft",(he=new td,he.nc=ResourceStrings.L_TransitionDiamondsFromLeft,he.sc=Oc.Ec("TransitionGlitterDiamondLeft"),he.qc=(vd=new yd,vd.TransitionType=ed.eDa,vd.Direction=id.xXi,vd.Duration=3900,vd.IsManualAdvance=!0,vd),he.parent="TransitionGlitter",he.next="TransitionGlitterDiamondTop",he));let nd,ee;this.zc.$("TransitionGlitterDiamondTop",(ee=new td,ee.nc=ResourceStrings.L_TransitionDiamondsFromTop,ee.sc=Oc.Ec("TransitionGlitterDiamondTop"),ee.qc=(nd=
new yd,nd.TransitionType=ed.eDa,nd.Direction=id.HXi,nd.Duration=3900,nd.IsManualAdvance=!0,nd),ee.parent="TransitionGlitter",ee.next="TransitionGlitterDiamondRight",ee));let Ue,n;this.zc.$("TransitionGlitterDiamondRight",(n=new td,n.nc=ResourceStrings.L_TransitionDiamondsFromRight,n.sc=Oc.Ec("TransitionGlitterDiamondRight"),n.qc=(Ue=new yd,Ue.TransitionType=ed.eDa,Ue.Direction=id.BXi,Ue.Duration=3900,Ue.IsManualAdvance=!0,Ue),n.parent="TransitionGlitter",n.next="TransitionGlitterDiamondBottom",n));
let Y,ra;this.zc.$("TransitionGlitterDiamondBottom",(ra=new td,ra.nc=ResourceStrings.L_TransitionDiamondsFromBottom,ra.sc=Oc.Ec("TransitionGlitterDiamondBottom"),ra.qc=(Y=new yd,Y.TransitionType=ed.eDa,Y.Direction=id.oXi,Y.Duration=3900,Y.IsManualAdvance=!0,Y),ra.parent="TransitionGlitter",ra))}if(!Array.contains(ka,"vortex")){let Ba,Ia;this.zc.$("TransitionVortex",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionVortex,Ia.sc=Oc.Ec("TransitionVortexFromLeft"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.Kpc,
Ba.Direction=id.nCa,Ba.Duration=4E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionVortex",Ia.next="TransitionVortexFromLeft",Ia));let Ab,Ob;this.zc.$("TransitionVortexFromLeft",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionFromLeft,Ob.sc=Oc.Ec("TransitionVortexFromLeft"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.Kpc,Ab.Direction=id.nCa,Ab.Duration=4E3,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionVortex",Ob.next="TransitionVortexFromTop",Ob));let Yb,uc;this.zc.$("TransitionVortexFromTop",(uc=new td,
uc.nc=ResourceStrings.L_TransitionFromTop,uc.sc=Oc.Ec("TransitionVortexFromTop"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.Kpc,Yb.Direction=id.Gsb,Yb.Duration=4E3,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionVortex",uc.next="TransitionVortexFromRight",uc));let mc,Ec;this.zc.$("TransitionVortexFromRight",(Ec=new td,Ec.nc=ResourceStrings.L_TransitionFromRight,Ec.sc=Oc.Ec("TransitionVortexFromRight"),Ec.qc=(mc=new yd,mc.TransitionType=ed.Kpc,mc.Direction=id.x7,mc.Duration=4E3,mc.IsManualAdvance=!0,mc),
Ec.parent="TransitionVortex",Ec.next="TransitionVortexFromBottom",Ec));let Yc,jd;this.zc.$("TransitionVortexFromBottom",(jd=new td,jd.nc=ResourceStrings.L_TransitionFromBottom,jd.sc=Oc.Ec("TransitionVortexFromBottom"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.Kpc,Yc.Direction=id.oQa,Yc.Duration=4E3,Yc.IsManualAdvance=!0,Yc),jd.parent="TransitionVortex",jd))}Array.contains(ka,"switch")||(this.zc.$("TransitionSwitch",Object.assign(new td,{nc:ResourceStrings.L_TransitionSwitch,sc:Oc.Ec("TransitionSwitchRight"),
qc:Object.assign(new yd,{TransitionType:ed.QQe,Direction:id.UPc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchRight"})),this.zc.$("TransitionSwitchRight",Object.assign(new td,{nc:ResourceStrings.L_TransitionGoRight,sc:Oc.Ec("TransitionSwitchRight"),qc:Object.assign(new yd,{TransitionType:ed.QQe,Direction:id.UPc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch",next:"TransitionSwitchLeft"})),this.zc.$("TransitionSwitchLeft",Object.assign(new td,{nc:ResourceStrings.L_TransitionGoLeft,
sc:Oc.Ec("TransitionSwitchLeft"),qc:Object.assign(new yd,{TransitionType:ed.QQe,Direction:id.none,Duration:1250,IsManualAdvance:!0}),parent:"TransitionSwitch"})));if(!Array.contains(ka,"flip")){this.zc.$("TransitionFlip",Object.assign(new td,{nc:ResourceStrings.L_TransitionFlip,sc:Oc.Ec("TransitionFlipRight"),qc:Object.assign(new yd,{TransitionType:ed.flip,Direction:id.UPc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipRight"}));this.zc.$("TransitionFlipRight",Object.assign(new td,
{nc:ResourceStrings.L_TransitionGoRight,sc:Oc.Ec("TransitionFlipRight"),qc:Object.assign(new yd,{TransitionType:ed.flip,Direction:id.UPc,Duration:1250,IsManualAdvance:!0}),parent:"TransitionFlip",next:"TransitionFlipLeft"}));let Ba,Ia;this.zc.$("TransitionFlipLeft",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionGoLeft,Ia.sc=Oc.Ec("TransitionFlipLeft"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.flip,Ba.Direction=id.none,Ba.Duration=1250,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionFlip",Ia))}if(!Array.contains(ka,
"galleryicon")){let Ba,Ia;this.zc.$("TransitionGalleryIcon",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionGallery,Ia.sc=Oc.Ec("TransitionGalleryRight"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.bZd,Ba.Direction=id.x7,Ba.Duration=1600,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionGalleryIcon",Ia.next="TransitionGalleryIconFromRight",Ia));let Ab,Ob;this.zc.$("TransitionGalleryIconFromRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionFromRight,Ob.sc=Oc.Ec("TransitionGalleryRight"),Ob.qc=(Ab=new yd,Ab.TransitionType=
ed.bZd,Ab.Direction=id.x7,Ab.Duration=1600,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionGalleryIcon",Ob.next="TransitionGalleryIconFromLeft",Ob));let Yb,uc;this.zc.$("TransitionGalleryIconFromLeft",(uc=new td,uc.nc=ResourceStrings.L_TransitionFromLeft,uc.sc=Oc.Ec("TransitionGalleryLeft"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.bZd,Yb.Direction=id.nCa,Yb.Duration=1600,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionGalleryIcon",uc))}if(!Array.contains(ka,"cube")){let Ba,Ia;this.zc.$("TransitionCube",
(Ia=new td,Ia.nc=ResourceStrings.L_TransitionCube,Ia.sc=Oc.Ec("TransitionCubeFromRight"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.TL,Ba.Direction=id.G7f,Ba.Duration=1200,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionCube",Ia.next="TransitionCubeFromRight",Ia));let Ab,Ob;this.zc.$("TransitionCubeFromRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionFromRight,Ob.sc=Oc.Ec("TransitionCubeFromRight"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.TL,Ab.Direction=id.G7f,Ab.Duration=1200,Ab.IsManualAdvance=!0,Ab),
Ob.parent="TransitionCube",Ob.next="TransitionCubeFromBottom",Ob));let Yb,uc;this.zc.$("TransitionCubeFromBottom",(uc=new td,uc.nc=ResourceStrings.L_TransitionFromBottom,uc.sc=Oc.Ec("TransitionCubeFromBottom"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.TL,Yb.Direction=id.nXi,Yb.Duration=1200,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionCube",uc.next="TransitionCubeFromLeft",uc));let mc,Ec;this.zc.$("TransitionCubeFromLeft",(Ec=new td,Ec.nc=ResourceStrings.L_TransitionFromLeft,Ec.sc=Oc.Ec("TransitionCubeFromLeft"),
Ec.qc=(mc=new yd,mc.TransitionType=ed.TL,mc.Direction=id.wXi,mc.Duration=1200,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionCube",Ec.next="TransitionCubeFromTop",Ec));let Yc,jd;this.zc.$("TransitionCubeFromTop",(jd=new td,jd.nc=ResourceStrings.L_TransitionFromTop,jd.sc=Oc.Ec("TransitionCubeFromTop"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.TL,Yc.Direction=id.GXi,Yc.Duration=1200,Yc.IsManualAdvance=!0,Yc),jd.parent="TransitionCube",jd))}if(!Array.contains(ka,"doors")){let Ba,Ia;this.zc.$("TransitionDoors",
(Ia=new td,Ia.nc=ResourceStrings.L_TransitionDoors,Ia.sc=Oc.Ec("TransitionDoorsVertical"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.wUd,Ba.Direction=id.K7a,Ba.Duration=1400,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionDoors",Ia.next="TransitionDoorsVertical",Ia));let Ab,Ob;this.zc.$("TransitionDoorsVertical",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionVertical,Ob.sc=Oc.Ec("TransitionDoorsVertical"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.wUd,Ab.Direction=id.K7a,Ab.Duration=1400,Ab.IsManualAdvance=!0,
Ab),Ob.parent="TransitionDoors",Ob.next="TransitionDoorsHorizontal",Ob));let Yb,uc;this.zc.$("TransitionDoorsHorizontal",(uc=new td,uc.nc=ResourceStrings.L_TransitionHorizontal,uc.sc=Oc.Ec("TransitionDoorsHorizontal"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.wUd,Yb.Direction=id.TPc,Yb.Duration=1400,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionDoors",uc))}if(!Array.contains(ka,"box")){let Ba,Ia;this.zc.$("TransitionBox",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionBox,Ia.sc=Oc.Ec("TransitionBoxFromRight"),
Ia.qc=(Ba=new yd,Ba.TransitionType=ed.TL,Ba.Direction=id.F7f,Ba.Duration=1600,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionBox",Ia.next="TransitionBoxFromRight",Ia));let Ab,Ob;this.zc.$("TransitionBoxFromRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionFromRight,Ob.sc=Oc.Ec("TransitionBoxFromRight"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.TL,Ab.Direction=id.F7f,Ab.Duration=1600,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionBox",Ob.next="TransitionBoxFromBottom",Ob));let Yb,uc;this.zc.$("TransitionBoxFromBottom",
(uc=new td,uc.nc=ResourceStrings.L_TransitionFromBottom,uc.sc=Oc.Ec("TransitionBoxFromBottom"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.TL,Yb.Direction=id.mXi,Yb.Duration=1600,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionBox",uc.next="TransitionBoxFromLeft",uc));let mc,Ec;this.zc.$("TransitionBoxFromLeft",(Ec=new td,Ec.nc=ResourceStrings.L_TransitionFromLeft,Ec.sc=Oc.Ec("TransitionBoxFromLeft"),Ec.qc=(mc=new yd,mc.TransitionType=ed.TL,mc.Direction=id.vXi,mc.Duration=1600,mc.IsManualAdvance=!0,mc),
Ec.parent="TransitionBox",Ec.next="TransitionBoxFromTop",Ec));let Yc,jd;this.zc.$("TransitionBoxFromTop",(jd=new td,jd.nc=ResourceStrings.L_TransitionFromTop,jd.sc=Oc.Ec("TransitionBoxFromTop"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.TL,Yc.Direction=id.FXi,Yc.Duration=1600,Yc.IsManualAdvance=!0,Yc),jd.parent="TransitionBox",jd))}if(!Array.contains(ka,"comb")){let Ba,Ia;this.zc.$("TransitionComb",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionComb,Ia.sc=Oc.Ec("TransitionCombHorizontal"),Ia.qc=(Ba=new yd,
Ba.TransitionType=ed.cPd,Ba.Direction=id.none,Ba.Duration=1E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionComb",Ia.next="TransitionCombHorizontal",Ia));let Ab,Ob;this.zc.$("TransitionCombHorizontal",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionHorizontal,Ob.sc=Oc.Ec("TransitionCombHorizontal"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.cPd,Ab.Direction=id.TPc,Ab.Duration=1E3,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionComb",Ob.next="TransitionCombVertical",Ob));let Yb,uc;this.zc.$("TransitionCombVertical",
(uc=new td,uc.nc=ResourceStrings.L_TransitionVertical,uc.sc=Oc.Ec("TransitionCombVertical"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.cPd,Yb.Direction=id.K7a,Yb.Duration=1E3,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionComb",uc))}if(!Array.contains(ka,"zoom")){let Ba,Ia;this.zc.$("TransitionZoom",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionZoom,Ia.sc=Oc.Ec("TransitionZoomIn"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.zoom,Ba.Direction=id.l2b,Ba.Duration=900,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionZoom",
Ia.next="TransitionZoomIn",Ia));let Ab,Ob;this.zc.$("TransitionZoomIn",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionIn,Ob.sc=Oc.Ec("TransitionZoomIn"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.zoom,Ab.Direction=id.l2b,Ab.Duration=900,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionZoom",Ob.next="TransitionZoomOut",Ob));let Yb,uc;this.zc.$("TransitionZoomOut",(uc=new td,uc.nc=ResourceStrings.L_TransitionOut,uc.sc=Oc.Ec("TransitionZoomOut"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.zoom,Yb.Direction=id.I4d,
Yb.Duration=900,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionZoom",uc.next="TransitionZoomAndRotate",uc));let mc,Ec;this.zc.$("TransitionZoomAndRotate",(Ec=new td,Ec.nc=ResourceStrings.L_TransitionZoomAndRotate,Ec.sc=Oc.Ec("TransitionNewsFlash"),Ec.qc=(mc=new yd,mc.TransitionType=ed.XDl,mc.Direction=id.none,mc.Duration=1500,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionZoom",Ec))}if(!Array.contains(ka,"random")){let Ba,Ia;this.zc.$("TransitionRandom",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionRandom,
Ia.sc=Oc.Ec("TransitionRandom"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.random,Ba.Direction=id.dlj,Ba.Duration=1500,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionRandom",Ia))}}if(!Array.contains(ka,"menusectiondynamiccontent")){if(!Array.contains(ka,"pan")){let Ba,Ia;this.zc.$("TransitionPan",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionPan,Ia.sc=Oc.Ec("TransitionPanFromBottom"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.pan,Ba.Direction=id.oQa,Ba.Duration=1300,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionPan",
Ia.next="TransitionPanFromBottom",Ia));this.zc.$("TransitionPanFromBottom",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromBottom,sc:Oc.Ec("TransitionPanFromBottom"),qc:Object.assign(new yd,{TransitionType:ed.pan,Direction:id.oQa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromLeft"}));this.zc.$("TransitionPanFromLeft",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromLeft,sc:Oc.Ec("TransitionPanFromLeft"),qc:Object.assign(new yd,{TransitionType:ed.pan,
Direction:id.nCa,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromRight"}));this.zc.$("TransitionPanFromRight",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromRight,sc:Oc.Ec("TransitionPanFromRight"),qc:Object.assign(new yd,{TransitionType:ed.pan,Direction:id.x7,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan",next:"TransitionPanFromTop"}));this.zc.$("TransitionPanFromTop",Object.assign(new td,{nc:ResourceStrings.L_TransitionFromTop,sc:Oc.Ec("TransitionPanFromTop"),
qc:Object.assign(new yd,{TransitionType:ed.pan,Direction:id.Gsb,Duration:1300,IsManualAdvance:!0}),parent:"TransitionPan"}))}if(!Array.contains(ka,"conveyor")){this.zc.$("TransitionConveyor",Object.assign(new td,{nc:ResourceStrings.L_TransitionConveyor,sc:Oc.Ec("TransitionConveyorRight"),qc:Object.assign(new yd,{TransitionType:ed.rQd,Direction:id.x7,Duration:1600,IsManualAdvance:!0}),parent:"TransitionConveyor",next:"TransitionConveyorFromRight"}));let Ba,Ia;this.zc.$("TransitionConveyorFromRight",
(Ia=new td,Ia.nc=ResourceStrings.L_TransitionFromRight,Ia.sc=Oc.Ec("TransitionConveyorRight"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.rQd,Ba.Direction=id.x7,Ba.Duration=1600,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionConveyor",Ia.next="TransitionConveyorFromLeft",Ia));let Ab,Ob;this.zc.$("TransitionConveyorFromLeft",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionFromLeft,Ob.sc=Oc.Ec("TransitionConveyorLeft"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.rQd,Ab.Direction=id.nCa,Ab.Duration=1600,Ab.IsManualAdvance=
!0,Ab),Ob.parent="TransitionConveyor",Ob))}if(!Array.contains(ka,"rotate")){let Ba,Ia;this.zc.$("TransitionRotate",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionRotate,Ia.sc=Oc.Ec("TransitionRotateLeft"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.TL,Ba.Direction=id.I7f,Ba.Duration=2E3,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionRotate",Ia.next="TransitionRotateFromRight",Ia));let Ab,Ob;this.zc.$("TransitionRotateFromRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionFromRight,Ob.sc=Oc.Ec("TransitionRotateLeft"),
Ob.qc=(Ab=new yd,Ab.TransitionType=ed.TL,Ab.Direction=id.I7f,Ab.Duration=2E3,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionRotate",Ob.next="TransitionRotateFromBottom",Ob));let Yb,uc;this.zc.$("TransitionRotateFromBottom",(uc=new td,uc.nc=ResourceStrings.L_TransitionFromBottom,uc.sc=Oc.Ec("TransitionRotateTop"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.TL,Yb.Direction=id.rXi,Yb.Duration=2E3,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionRotate",uc.next="TransitionRotateFromLeft",uc));let mc,Ec;this.zc.$("TransitionRotateFromLeft",
(Ec=new td,Ec.nc=ResourceStrings.L_TransitionFromLeft,Ec.sc=Oc.Ec("TransitionRotateRight"),Ec.qc=(mc=new yd,mc.TransitionType=ed.TL,mc.Direction=id.zXi,mc.Duration=2E3,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionRotate",Ec.next="TransitionRotateFromTop",Ec));let Yc,jd;this.zc.$("TransitionRotateFromTop",(jd=new td,jd.nc=ResourceStrings.L_TransitionFromTop,jd.sc=Oc.Ec("TransitionRotateBottom"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.TL,Yc.Direction=id.KXi,Yc.Duration=2E3,Yc.IsManualAdvance=!0,Yc),
jd.parent="TransitionRotate",jd))}if(!Array.contains(ka,"window")){let Ba,Ia;this.zc.$("TransitionWindow",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionWindow,Ia.sc=Oc.Ec("TransitionWindowVertical"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.window,Ba.Direction=id.K7a,Ba.Duration=1500,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionWindow",Ia.next="TransitionWindowVertical",Ia));let Ab,Ob;this.zc.$("TransitionWindowVertical",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionVertical,Ob.sc=Oc.Ec("TransitionWindowVertical"),
Ob.qc=(Ab=new yd,Ab.TransitionType=ed.window,Ab.Direction=id.K7a,Ab.Duration=1500,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionWindow",Ob.next="TransitionWindowHorizontal",Ob));let Yb,uc;this.zc.$("TransitionWindowHorizontal",(uc=new td,uc.nc=ResourceStrings.L_TransitionHorizontal,uc.sc=Oc.Ec("TransitionWindowHorizontal"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.window,Yb.Direction=id.TPc,Yb.Duration=1500,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionWindow",uc))}if(!Array.contains(ka,"orbit")){let Ba,
Ia;this.zc.$("TransitionOrbit",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionOrbit,Ia.sc=Oc.Ec("TransitionOrbitFromRight"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.TL,Ba.Direction=id.H7f,Ba.Duration=1600,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionOrbit",Ia.next="TransitionOrbitFromRight",Ia));let Ab,Ob;this.zc.$("TransitionOrbitFromRight",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionFromRight,Ob.sc=Oc.Ec("TransitionOrbitFromRight"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.TL,Ab.Direction=id.H7f,Ab.Duration=
1600,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionOrbit",Ob.next="TransitionOrbitFromBottom",Ob));let Yb,uc;this.zc.$("TransitionOrbitFromBottom",(uc=new td,uc.nc=ResourceStrings.L_TransitionFromBottom,uc.sc=Oc.Ec("TransitionOrbitFromBottom"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.TL,Yb.Direction=id.qXi,Yb.Duration=1600,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionOrbit",uc.next="TransitionOrbitFromLeft",uc));let mc,Ec;this.zc.$("TransitionOrbitFromLeft",(Ec=new td,Ec.nc=ResourceStrings.L_TransitionFromLeft,
Ec.sc=Oc.Ec("TransitionOrbitFromLeft"),Ec.qc=(mc=new yd,mc.TransitionType=ed.TL,mc.Direction=id.yXi,mc.Duration=1600,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionOrbit",Ec.next="TransitionOrbitFromTop",Ec));let Yc,jd;this.zc.$("TransitionOrbitFromTop",(jd=new td,jd.nc=ResourceStrings.L_TransitionFromTop,jd.sc=Oc.Ec("TransitionOrbitFromTop"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.TL,Yc.Direction=id.JXi,Yc.Duration=1600,Yc.IsManualAdvance=!0,Yc),jd.parent="TransitionOrbit",jd))}if(!Array.contains(ka,
"flythrough")){let Ba,Ia;this.zc.$("TransitionFlyThrough",(Ia=new td,Ia.nc=ResourceStrings.L_TransitionFlyThrough,Ia.sc=Oc.Ec("TransitionFlyThroughIn"),Ia.qc=(Ba=new yd,Ba.TransitionType=ed.M_b,Ba.Direction=id.l2b,Ba.Duration=800,Ba.IsManualAdvance=!0,Ba),Ia.parent="TransitionFlyThrough",Ia.next="TransitionFlyThroughIn",Ia));let Ab,Ob;this.zc.$("TransitionFlyThroughIn",(Ob=new td,Ob.nc=ResourceStrings.L_TransitionIn,Ob.sc=Oc.Ec("TransitionFlyThroughIn"),Ob.qc=(Ab=new yd,Ab.TransitionType=ed.M_b,Ab.Direction=
id.l2b,Ab.Duration=800,Ab.IsManualAdvance=!0,Ab),Ob.parent="TransitionFlyThrough",Ob.next="TransitionFlyThroughOut",Ob));let Yb,uc;this.zc.$("TransitionFlyThroughOut",(uc=new td,uc.nc=ResourceStrings.L_TransitionOut,uc.sc=Oc.Ec("TransitionFlyThroughOut"),uc.qc=(Yb=new yd,Yb.TransitionType=ed.M_b,Yb.Direction=id.I4d,Yb.Duration=800,Yb.IsManualAdvance=!0,Yb),uc.parent="TransitionFlyThrough",uc.next="TransitionFlyThroughInWithBounce",uc));let mc,Ec;this.zc.$("TransitionFlyThroughInWithBounce",(Ec=new td,
Ec.nc=ResourceStrings.L_TransitionInWithBounce,Ec.sc=Oc.Ec("TransitionFlyThroughIn"),Ec.qc=(mc=new yd,mc.TransitionType=ed.M_b,mc.Direction=id.SVi,mc.Duration=900,mc.IsManualAdvance=!0,mc),Ec.parent="TransitionFlyThrough",Ec.next="TransitionFlyThroughOutWithBounce",Ec));let Yc,jd;this.zc.$("TransitionFlyThroughOutWithBounce",(jd=new td,jd.nc=ResourceStrings.L_TransitionOutWithBounce,jd.sc=Oc.Ec("TransitionFlyThroughOut"),jd.qc=(Yc=new yd,Yc.TransitionType=ed.M_b,Yc.Direction=id.TVi,Yc.Duration=900,
Yc.IsManualAdvance=!0,Yc),jd.parent="TransitionFlyThrough",jd))}}this.zc.forEach((Ba,Ia)=>{Ba===Ia.parent&&++U;return!0})}jRa(z){let U=null;z?this.zc.forEach((ka,Ba)=>{Ba.qc&&Ba.qc.TransitionType===z.TransitionType&&Ba.qc.Direction===z.Direction&&(U=ka);return!0}):U="TransitionNone";return U}WP(z){return this.zc.ga(z)}iub(z){return(z=this.jRa(z))?this.zc.ga(this.zc.ga(z).parent):null}kRa(z){return(z=this.jRa(z))?this.zc.ga(z).parent:null}odg(z){let U,ka=null;U=null;z&&z.next&&(U=z.next,ka=this.WP(U));
return{returnValue:ka,key:U}}utb(){var z=[Oc.VXi,Oc.sJk,Oc.tJk];for(const U of z)if(z=document.getElementById(U))return z;return null}aWc(z,U){return z&&U&&U.childNodes?z.startsWith(Oc.WXi)?U.contains(document.getElementById(z)):!1:!U&&z?"TransitionExisting"===z||"TransitionNone"===z||"TransitionMorph"===z||"TransitionCut"===z||"TransitionFade"===z||"TransitionPush"===z||"TransitionWipe"===z:!1}static Ec(z){return Dd.a.fgc+"_"+z+"_32x32x32"}}Oc.VXi="PptRibbon.Transition.Gallery-MaxSize-1-0";Oc.sJk=
"Transitions";Oc.tJk="Transitions-previewWrapper";Oc.WXi="Transition";Object(h.a)(Oc,"TransitionHelper",null,[596]);var Wl=d(243);class Wh{constructor(){this.mh=this.K=null}get name(){return"PowerPointWebEditor.Advanced"}Wb(z){this.K=z;this.mh=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder").NCa(0,this.name);this.K.register(574,"PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers").ma().na(()=>new lh(this.K.resolve("Common.IActionManagerExtended")));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").uP){const U=
Wl.a(this.K);this.K.register(575,"PowerPointWebEditor.IAudioManagerStore").ma().na(()=>new Mf);this.K.register(576,"PowerPointWebEditor.IAudioLibraryCallbackFactory").ma().na(()=>new pd(this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").uP,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.Ka("PowerPointWebEditor.IAudioManagerStore")));
this.K.register(577,"PowerPointWebEditor.IAudioManagerFactory").ma().na(()=>new de(this.K.resolve("PowerPointWebEditor.IAudioLibraryCallbackFactory"),U,this.K.resolve("PowerPointWebEditor.IMediaLocalRequestHelper"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.resolve("PowerPointWebEditor.IAudioManagerFactory");this.K.resolve("PowerPointWebEditor.IAudioManagerStore")}}init(){let z=this.mh.ju("resolve");var U=this.K.resolve("Common.AFrameworkApplication");const ka=this.K.resolve("PowerPointWebEditor.IApplicationContext"),
Ba=ka.ld;U=U.kr;const Ia=this.K.resolve("Common.IActionManagerExtended"),Ab=this.K.resolve("PowerPointWebEditor.IFocusManager");U=U.Hd;const Ob=this.K.resolve("Common.Transaction.ITransactionFactory"),Yb=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),uc=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),mc=this.K.resolve("PowerPointWebEditor.PictureContext"),Ec=this.K.resolve("PowerPoint.IPathManager");var Yc=this.K.resolve("PowerPointWebEditor.IPresentationReader");
const jd=this.K.resolve("PowerPointWebEditor.IShapeReader"),vd=this.K.resolve("PowerPointWebEditor.IPictureUploader"),he=this.K.le("PowerPointWebEditor.IPPTLanguageDialogFactory"),nd=this.K.resolve("Box4.IParagraphReader");this.mh.qu(z);z=this.mh.ju("regactors");Yc=[new Dh(Ia,Yb,this.K.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),this.K.resolve("Box4.IParagraphIndentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),nd,this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),
jd,this.K.resolve("PowerPointWebEditor.IParagraphLevelPropertyChangedHandlers"),Cf.App.VJa.yGc(12),Ba.telemetryForPptParagraphSettingEnabled),new Ac(Ia,Ab,uc,Ob,Yb,Ec,U,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Yc,new Dg,Ba.ixg,this.K.resolve("Common.IAppSettingsManager").ka("ChangingThemeSelectedSlidesEnabled")),new xa(Ia,U,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ob,Yb,Ab,new Oc(Ba.fKa),uc,Ba,Ec,this.K.resolve("PowerPointWebEditor.View.IPPTPageView"))];
Ba.zob?Yc.push(new Ie(Ia,Yb,Ab,Ob,new Jb(Ba.EKd),uc,jd,Ec,this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager"))):Yc.push(new Cg(Ia,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Yb,Ab,Ob,new Jb(Ba.EKd),uc,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),jd,Ec));Ba.powerPointFormatBackgroundEnabled&&Yc.push(new $g(Ia,Ab,uc,Yb,Ob,U,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),vd,mc,L.AFrameworkApplication.mQ,this.K.resolve("PowerPointWebEditor.IErrorHandler"),
Ba));for(const ee of Yc)ee.ub(),ee.xe();this.mh.qu(z);L.AFrameworkApplication.fa.ff(()=>{z=this.mh.ju("regfullactors");const ee=[],Ue=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");Ue.LSa=this.K.resolve("Common.IAppSettingsManager").ka("299");ka.ld.$Eb&&ee.push(new Rj(Ia,he,Ue,this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.Ka("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.ILanguageReader"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Box4.IProofingManager"),Yb));this.K.resolve("PowerPointWebEditor.IApplicationSettings").K3b&&ee.push(new Xi(Ia,Ab,Yb,Wl.a(this.K)));for(const n of ee)n.ub(),n.xe();Ue.LSa&&(new De(Ia,this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),(n,Y)=>new Ee(n,this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),Y,this.K.resolve("Common.IFocusManager")),
this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),Yb,this.K.resolve("Box4.ILanguageReader"),jd)).ub();this.mh.qu(z)})}dispose(){}}Object(h.a)(Wh,"AdvancedPackage",null,[2,3]);class ik{get container(){return Z.a.instance.resolve("PowerPointWebEditor.IRibbonPane").xa}}Object(h.a)(ik,"PPTFloatPaneContainer",null,[543]);class Vj{constructor(z,U,ka=null){this.adb=new da.a(0);this.jwa=null;this.kwa=this.jwa=Cf.App.Mm;this.cke=z;this.bTg=1E3*U;this.kJg=ka||(()=>(new Date).getTime())}Wdi(z){this.cke&&
this.adb.add(z,(new Date).getTime())}h1f(z){this.cke&&(this.adb.remove(z),this.tpl(this.kJg()-this.bTg))}tpl(z){if(this.adb.count){var U=[];this.adb.forEach((ka,Ba)=>{Ba<z&&U.push(ka);return!0});for(const ka of U)this.adb.remove(ka)}}get zvg(){return this.kwa<=this.jwa}Dsj(){if(!this.cke||!this.adb.count)return!1;let z=!1;const U=this.kJg();this.adb.forEach((ka,Ba)=>U-Ba<this.bTg?(z=!0,!1):!0);return z}}Object(h.a)(Vj,"PictureContext",null,[578]);var Zm=d(886),Ok=d(425);class rf{constructor(){this.cbb=
this.xoe=this.bNg=this.cNg=!1;this.mh=this.f4=this.zAb=this.tNg=this.K=null;this.J8b=[new Wh];this.hX=[]}get name(){return"PowerPointWebEditor.Chronos"}Wb(z){this.K=z;this.f4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.mh=this.f4.NCa(0,this.name);for(let U=0;U<this.J8b.length;++U)Array.add(this.hX,Bb.a(this.J8b[U],0));for(const U of this.hX)U.Wb(z);rf.yti(z);this.K.register(Vj,"PowerPointWebEditor.PictureContext").as("PowerPointWebEditor.IPictureContext").ma().na(()=>new Vj(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingPromptUnsavedDialogForUploadingImageEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditingUploadLargeImageTimeoutInSeconds))}Zec(z,U){z=pg.a.instance;for(let Ba=0;Ba<U.entries.length;Ba++){var ka=U.entries[Ba];ka.url=D.a.removeParameter(ka.url,L.AFrameworkApplication.pV);const Ia=D.a.Mma(ka.url);let Ab=!1;if("about:blank"===ka.url||Ia.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===Ia&&"2"===D.a.BS(ka.url,"u")||this.cbb&&(Ab=Ia.endsWith("PowerPoint.ashx"))&&ka.url.endsWith("ib=1"))ka.behavior=1;else{if(Ab||Ia.endsWith("PowerPoint.ashx")||
Ia.endsWith("GetUpdates")||Ia.endsWith("images.ashx")||Ia.endsWith("GetThumb"))ka.behavior=2;if(!this.cNg&&Ia.endsWith("PowerPoint.ashx")&&"true"===D.a.BS(ka.url,Oh.a.Puk))ka=ka.qB,z.hc(xf.a.$Pd,parseInt(String(ka.fetchStart))),z.hc(xf.a.Ovi,parseInt(String(ka.responseStart))),z.hc(xf.a.Gvi,parseInt(String(ka.responseEnd-ka.responseStart))),this.cNg=!0;else if(!this.bNg&&Ia.endsWith("PowerPoint.ashx")&&"true"===D.a.BS(ka.url,"dSlide")){this.bNg=!0;ka=ka.qB;z.hc("SlideImageFetchStart",parseInt(String(ka.fetchStart)));
z.hc("SlideImageResponseStart",parseInt(String(ka.responseStart)));z.hc("SlideImageDownloadDuration",parseInt(String(ka.responseEnd-ka.responseStart)));let Ob;({transferSize:Ob}=rf.lBh(ka)).returnValue&&z.hc("SlideImageSize",Ob)}else if(!this.xoe&&Ia.endsWith("images.ashx")&&"true"===D.a.BS(ka.url,"minimalboot")&&D.a.BS(ka.url,"index")===this.tNg){this.xoe=!0;ka=ka.qB;z.hc("MBootFetchStart",parseInt(String(ka.fetchStart)));z.hc("MBootResponseStart",parseInt(String(ka.responseStart)));z.hc("MBootDownload",
parseInt(String(ka.responseEnd-ka.responseStart)));let Ob;({transferSize:Ob}=rf.lBh(ka)).returnValue&&z.hc("MBootSize",Ob)}}}}v5k(){const z=window.self.FirstSlideRequestIndex;void 0===z||null===z?this.xoe=!0:this.tNg=z.toString()}init(){Jc.a.J(512497358,809,50,"ChronosPackage::Init");const z=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),U=this.K.resolve("Common.ITaskManager");for(var ka of this.hX)this.mh.ju(ka.name),ka.init(),this.mh.qu(ka.name);this.K.resolve("Common.IAppSettingsManager").ff(()=>
{if(z.podsAnimationSuggestionEnabled){const Ba=this.mh.ju("animationpreview");this.kzj();this.mh.qu(Ba)}});this.K.resolve("Common.IActionManagerExtended").Jma(this.K.resolve("PowerPointWebEditor.IPasteFloatieHelper"));ka=Z.a.instance.resolve("Box4.IProofingManager");if(null!==ka){let Ba=this.mh.ju("proofingresume");ka.resume();this.mh.qu(Ba)}if(z.$sa||!z.TSa)ka=this.mh.ju("loaddelayedres"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").Uuh(),this.mh.qu(ka);this.v5k();this.cbb=
z.podsUseRealtimeCoauthReplicationTimerForInbound;ka=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");ka.Wb(30,0);ka.JEf(Object(v.a)(this,this.Zec,"onResourceTimingEntriesAvailable"));ka.activate();z.ESa&&(this.zAb=window.self.PerfMeterData,void 0!==this.zAb&&null!==this.zAb&&(U.Cb(new ad.a(3,2,6E4,Object(v.a)(this,this.collectPerfMeterData,"collectPerfMeterData"),90,"67")),Jc.a.J(512497357,809,50,"CollectPerfMeterData task started"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler").IB(()=>
{this.collectPerfMeterData(null)})));this.MVj(z)}MVj(z){Jc.a.J(512497356,809,50,"Start to download chronos1 js file");if(z.Noc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Rba("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1208)));else{z=qe.a.create("pptedit.chronos1",null,()=>d.e(2).then(d.bind(null,1208)));const U=this.K.resolve("PowerPointWebEditor.ISessionState");z.ZR(()=>{U&&U.V4("Chronos1DownloadFinished")});Ea.a.Kx(z)}}collectPerfMeterData(){if(0<this.zAb.length){const z=
[];for(const U of this.zAb)z.push({["Id"]:U.Id,["Value"]:U.Value.toFixed(2),["Start"]:U.Start.toFixed(2),["Duration"]:U.Duration.toFixed(2)});Jc.a.J(512497355,813,50,JSON.stringify(z));this.zAb.length=0}}dispose(){for(var z of this.hX)z.dispose();z=this.K.resolve("Common.NetworkTiming.IResourceTimingLogger");z.deactivate(!0);z.Yeh(Object(v.a)(this,this.Zec,"onResourceTimingEntriesAvailable"))}kzj(){const z=qe.a.create("pptedit.animationpreview",null,()=>d.e(18).then(d.bind(null,1221)));try{Ea.a.Kx(z)}catch(U){Jc.a.J(512497354,
809,10,"ChronosPackage::InitializeAnimationPreview - Failed to download animationpreview script, Exception: {0}",U.toString())}}static yti(z){z.register(543,"Common.IFloatPaneContainer").ma().na(()=>new ik)}static lBh(z){z=parseInt(String(Zm.a(z,"transferSize")));return{returnValue:!z.toString().startsWith("NaN"),transferSize:z}}static main(){L.AFrameworkApplication.Vg&&ia.a.eg?Jc.a.J(512497353,809,15,"Firefox attempts to load chronos package when App is disposing"):(pg.a.instance.hc(Ok.a.lOd,(new Date).getTime()),
ua.a.instance.Bc(Bb.a(new rf,0)))}}Object(h.a)(rf,"ChronosPackage",null,[2,3]);class Af{constructor(z,U,ka,Ba,Ia,Ab,Ob){this.uBb=this.EW=!1;this.ua=z;this.lc=U;this.Ot=ka;this.eq=Ba;this.q$a=Ab;this.Ee=Ia;this.Qz=this.ua.Ba;this.Hc=Ob}initialize(){this.Ot.Yj(Object(v.a)(this,this.fh,"onPropertyChanged"));this.Ee.z3a(Object(v.a)(this,this.e$,"onRibbonTabSwitched"));this.eq.uV(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.eq.iob(Object(v.a)(this,this.pma,"onShapeViewElementAdded"));
this.eq.U7h(Object(v.a)(this,this.r2g,"onShapesAllSelected"))}dispose(){this.Ot.tm(Object(v.a)(this,this.fh,"onPropertyChanged"));this.Ee.TFb(Object(v.a)(this,this.e$,"onRibbonTabSwitched"));this.eq.Tma(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.eq.yjc(Object(v.a)(this,this.pma,"onShapeViewElementAdded"));this.eq.PSk(Object(v.a)(this,this.r2g,"onShapesAllSelected"))}fh(z,U){U.property===db.a.PLc&&this.EW&&this.lc.ig(U.node)===this.Qz&&this.nIa(this.EW)}e$(z,U){if(this.EW=
!!U.V9&&0<=U.V9.indexOf("Animation"))this.uBb=!0;this.nIa(this.EW)}pma(z,U){(z=this.ua.Ba)&&z.yN&&z===this.Qz&&(U=U.xw)&&U.shapeNode&&this.Qz&&this.pEa(this.Qz.Bb,U.shapeNode)&&this.nIa(this.EW)}pEa(z,U){return z&&U?z.equals(U.slideId):!1}onActiveSlideDomReady(z,U){(z=Object(A.a)(120,U.Ba))&&this.Qz&&this.Qz.Bb!==z.Bb&&(this.Qz=z,this.nIa(this.EW))}r2g(){this.u$()}u$(){if(this.EW&&this.Qz&&this.Qz.CRa&&this.uBb){var z=this.Qz.jl();if(z&&0<z.length)for(const U of z)U&&U.H8a()&&(z=this.q$a.AG(U))&&
(z.kWb(),z.u$(!0))}}nIa(z){if(this.uBb&&this.Qz&&this.Qz.yN&&this.Hc.Gc&&this.Hc.Gc.dCc){var U=this.Qz.jl();if(U&&0<U.length)for(const ka of U)ka&&(U=this.q$a.AG(ka))&&(U.visible=z,U.rfb())}}}Object(h.a)(Af,"AnimationMarkerManagerLegacy",null,[106]);var qk=d(77),Dk=d(57);class ej{constructor(z,U){this.height=z;this.top=U}}Object(h.a)(ej,"ParagraphProperties",null,[]);var xj=d(46),Wj=d(66),rk=d(138),ol=d(167),jm=d(193),xd=d(185);class Xl{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc,jd,vd,he){this.sac=
this.Uz=this.ucb=this.zk=this.Db=!1;this.va=new qk.a;this.Lac=this.nd=1;this.Xm=this.Vm=this.Wg=this.wb=this.pb=null;this.ym=nd=>{nd&&this.WN?(this.pb=new rk.a,this.pb.jr("AnimationMarkerView"),this.WN.appendChild(this.pb.xa),this.wb=new xd.a,this.wb.Rj(0),this.pb.appendChild(this.wb.viewport),this.Wg=new ol.a,this.Wg.Rj(1),this.Wg.setVisibility(!1),this.wb.appendChild(this.Wg),this.Vm=new rk.a,this.Vm.jr("ShapeAnimationMarkerContainer"),this.Vm.xa.id=this.ta.id.toString(),this.Vm.gh(20,this.pb.xa.clientHeight),
this.Vm.Rj(1),this.pb.appendChild(this.Vm),this.Xm=new rk.a,this.Xm.jr("TextAnimationMarkerContainer"),this.Xm.xa.id=this.ta.id.toString(),this.Xm.gh(20,this.pb.xa.clientHeight),this.Xm.Rj(1),this.pb.appendChild(this.Xm),this.Yf.ob(bc.a.fq,this.Vm.xa,this.AC),this.Yf.ob(bc.a.ys,this.Vm.xa,this.AC),this.Yf.ob(bc.a.fq,this.Xm.xa,this.AC),this.Yf.ob(bc.a.ys,this.Xm.xa,this.AC),this.Yf.ob(bc.a.dJ,this.Vm.xa,this.oRa),this.Yf.ob(bc.a.dJ,this.Xm.xa,this.oRa),this.Yf.ob(bc.a.mouseDown,this.Vm.xa,this.oRa),
this.Yf.ob(bc.a.mouseDown,this.Xm.xa,this.oRa),this.Wc.ob(bc.a.click,this.Xm.xa,this.iQc),this.Wc.ob(bc.a.click,this.Vm.xa,this.iQc),this.setVisibility()):Jc.a.J(509682581,800,10,"AnimationMarkerView: {0} is null",nd?"m_markerViewParentElement":"parent")};this.kN=()=>!0;this.oRa=nd=>{if(!nd&&!nd.Ac.id.startsWith(Dd.a.yob)&&!nd.Ac.id.startsWith("overlappedMarker"))return Jc.a.J(509682580,800,50,"AnimationMarkerView:handleAnimationMarkerClick source element is not marker"),!1;nd.eventName==bc.a.dJ&&
this.Xxe(nd);nd=nd.mc;nd.preventDefault();nd.stopPropagation();return!0};this.iQc=nd=>{nd=nd.mc;nd.preventDefault();nd.stopPropagation();return!0};this.setSelection=()=>{};this.setVisibility=()=>{let nd=this.Db&&!this.Uz;this.ta&&this.ta.isHiddenShape&&(nd=!1);this.pb&&this.pb.Ld(nd);this.Vm&&this.Vm.Ld(nd);this.Xm&&this.Xm.Ld(nd)};this.u$=nd=>{if(this.Jca()){this.ucb=nd;nd=[this.Vm.xa.childNodes,this.Xm.xa.childNodes];for(const ee of nd)for(nd=0;ee&&nd<ee.length;nd++)this.Bkc(ee[nd],this.ucb)}};
this.i0k=nd=>{if(this.Jca()){var ee=[this.Vm.xa.childNodes,this.Xm.xa.childNodes];for(const Ue of ee)for(ee=0;Ue&&ee<Ue.length;ee++){const n=this.j0b(Ue[ee]);for(const Y of nd)n.includes(Y)&&this.Bkc(Ue[ee],!0)}}};this.j0b=nd=>{if(!nd||!this.ta)return null;nd=nd.getAttribute("AnimProps");if(!nd||!nd.toString()||!nd.toString().trim().length)return null;nd=nd.toString().split(" ");if(!nd||!nd.length)return null;const ee=[];for(const Ue of nd){if(!Ue||!Ue.trim().length)return null;ee.push(Number.parseInvariant(Ue.trim()))}return ee};
this.Jca=()=>{const nd=!!this.ta&&!!this.WN&&!!this.Vm&&!!this.Xm;nd||Jc.a.J(509682579,800,10,"AnimationMarkerView: the containers are not exist.");return nd};this.zOa=()=>{this.Oha(!0);this.Oha(!1)};this.Oha=nd=>{if(this.Yf&&this.Wc&&this.Jca()&&(nd=nd?this.Xm.xa:this.Vm.xa)&&nd.childNodes&&0<nd.childNodes.length){const ee=nd.childNodes;for(const Ue=0;Ue<ee.length;)nd.removeChild(ee[Ue])}};this.oHd=()=>{if(this.Jca()){var nd=this.lc.ig(this.ta);if(nd)if((nd=nd.ttb(this.ta))&&nd.length){var ee=!1,
Ue=!1,n=[];for(const Y of nd)Y.IsTextRangeType?Ue=!0:(ee=!0,n.push(Y));this.sac=ee&&Ue;this.oKa(!0);this.oKa(!1);this.Oha(!1);0<n.length&&(this.hZb(n,this.hj.YL(this.ta.Uo.$b,this.nd),this.hj.YL(this.ta.Uo.Ub-this.ta.Uo.$b,this.nd),!1,-1)||Jc.a.J(509682577,800,10,"AnimationMarkerView: no shape marker is rendered"));Ue?this.PVd():this.Oha(!0)}else this.zOa();else Jc.a.J(509682578,800,10,"AnimationMarkerView::addAnimationMarkers: slideNode is null")}};this.PVd=()=>{const nd=new ad.a(2,1,0,this.ensureTextIsRenderedAndDrawMarkers,
90,"26");this.yb.Cb(nd)};this.ensureTextIsRenderedAndDrawMarkers=()=>{this.zk||(this.tie(),this.iZb())};this.iZb=()=>{this.Oha(!0);if(this.m6d()){var nd=this.d3d();if(nd&&nd.length){var ee;if(({top:ee}=this.l3d()).returnValue){var Ue=0;for(let Y=0;Y<nd.length;Y++){var n=this.lc.ig(this.ta);if(!n){Jc.a.J(509682574,800,10,"AnimationMarkerView:drawTextAnimationMarkers slide node is null.");return}(n=n.U1d(this.ta,Y))&&0<n.length&&nd[Y]&&(Ue+=this.hZb(n,nd[Y].top-ee,nd[Y].height,!0,Y))}Ue||Jc.a.J(509682573,
800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Jc.a.J(509682575,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Jc.a.J(509682576,800,50,"AnimationMarkerView: the paragrph view is not rendered")}};this.d3d=()=>{const nd=[];var ee=Wi.GraphIterator.mb(this.ta);ee=this.Cl.n2(ee,ee.currentNode);for(var Ue;ee.moveNext();)(Ue=ee.currentNode)&&this.Hh.Vd(Ue)&&Ue&&(Ue=Ue.oc(this.az))&&Ue.htmlElement&&(Ue=this.fsa(Ue.htmlElement))&&Ue.height&&nd.push(Ue);return nd};
this.fsa=nd=>{if(!nd)return Jc.a.J(509682570,800,10,"AnimationMarkerView:getParagraphProperties paragraph is null"),null;nd=nd.querySelectorAll(".TextRun");if(!nd||!nd.length)return null;let ee=0,Ue=0;let n,Y=!1;for(let Pa=0;Pa<nd.length&&nd[Pa];Pa++){var ra=nd[Pa].getClientRects();({top:ra,bottom:n}=this.AXd(ra)).returnValue&&(Pa?(ee=ee>ra?ra:ee,Ue=Ue<n?n:Ue):(ee=ra,Ue=n),Y=!0)}if(Y)return new ej(Ue-ee,ee);Jc.a.J(509682569,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null};
this.hZb=(nd,ee,Ue,n)=>{if(!this.Jca()||!nd||!nd.length)return 0;const Y=n?this.Xm.xa:this.Vm.xa;Ue=(Ue=Math.floor(this.hj.Hm(Ue)/21))?Ue:1;let ra=0,Pa=null,eb=null,Eb=!0,Sb=!1;for(let ec=0;ec<nd.length;ec++){const kc=nd[ec];var ub=new rk.a;ub.xa.id=Dd.a.yob+kc.ClickOrder;ub.gh(20,16);ub.Rj(1);if(kc.IsTrigger){var wb=this.SRd();ub.xa.appendChild(wb)}else ub.xa.innerText=kc.ClickOrder.toString();let bd=wb=!1;ec<Ue?(n&&(ub.xa.style.position=Wj.a.absolute,ub.xa.style.top=xj.a.Nc(this.hj.Hm(ee)+21*ra)),
Sb=this.ucb||this.QD.UPd(kc.EffectNodeId),ub.xa.setAttribute(Wj.a.Aqa,Sb?"animMarkerSelected":"animMarkerUnselected"),Y.appendChild(ub.xa),ra++):ec===Ue?(Eb=Eb&&kc.EffectId===Pa.EffectId,wb=!0,bd=Pa.IsTrigger):Eb=Eb&&kc.EffectId===Pa.EffectId;wb&&eb.xa.appendChild(this.kMd(bd,Eb,Sb));Pa=kc;eb||(eb=ub);n?(ub=[],(wb=this.j0b(eb.xa))&&ub.push(...wb),ub.push(kc.EffectNodeId),eb.xa.setAttribute("AnimProps",ub.join(" "))):ub.xa.setAttribute("AnimProps",kc.EffectNodeId)}this.hM();return ra};this.kMd=(nd,
ee,Ue)=>{const n=new rk.a;n.xa.id="overlappedMarker";n.xa.style.marginTop=nd?"3px":"-13px";n.xa.setAttribute(Wj.a.Aqa,"overlappedMarker "+(Ue?"animMarkerSelected":"animMarkerUnselected"));ee&&this.B0(n.xa,"SameEffectOverlapped",1);return n.xa};this.hM=()=>{this.wse(this.pb.xa,!0)};this.m6d=()=>{var nd=this.lc.ig(this.ta);if(!nd)return Jc.a.J(509682567,800,10,"AnimationMarkerView::hasTextAnimations: slideNode is null"),!1;nd=nd.ttb(this.ta);if(!nd||!nd.length)return!1;for(const ee of nd)if(ee.IsTextRangeType)return!0;
return!1};this.oKa=nd=>{if(this.Jca()){var ee=nd?this.Vm.xa:this.Xm.xa,Ue,n;ee&&({x:Ue,y:n}=this.t1d(nd)).returnValue&&(ee.style.position=Wj.a.absolute,ee.style.left=xj.a.Nc(Ue),ee.style.zIndex="20000",nd?ee.style.top=xj.a.Nc(n):this.iZb())}};this.Xxe=nd=>{if(this.va&&nd&&this.Fa&&nd.Ac){var ee=nd.Ac.id.startsWith("overlappedMarker")&&nd.Ac.offsetParent?nd.Ac.offsetParent:nd.Ac;(ee=this.j0b(ee))?(nd.ctrlKey?this.QD.Nlj(ee,this.lc.ig(this.ta)):(this.QD.Wqa(),this.QD.u3h(ee,this.lc.ig(this.ta))),this.va.raiseEvent("OnMarkerClick",
nd),this.Fa.Ad()):Jc.a.J(509682566,800,10,"AnimationMarkerView: failed to parse the animation properties.")}};this.Gl=()=>{this.wb&&(this.JKb(),this.wb.Gl())};this.JKb=()=>{if(this.ta&&this.Wg){var nd=this.ta.Uo.points;nd=Xl.cqa(nd,this.Ztb());this.Wg.ht(nd)}};this.Ztb=()=>{let nd=Dd.a.NGb;this.ta.Pf||!this.ta.gta&&!this.ta.Sk||(nd+=6);return nd};this.Qp=()=>{this.wb&&this.Lac!==this.nd&&this.rfb();return null};this.Gq=()=>{};this.Gu=()=>{};this.Dj=nd=>{this.Lac=this.nd;this.nd=nd};this.setZIndex=
nd=>{this.wb&&this.wb.pB(nd)};this.draw=()=>{this.rfb()};this.rfb=()=>{this.pb&&this.WN&&this.Db&&!this.Uz&&(this.zOa(),this.oHd());this.setVisibility()};this.AC=nd=>{if(!this.va||!nd)return!1;this.va.raiseEvent("OnSelectionAreaHover",nd);nd.eventName===bc.a.fq?this.B0(nd.Ac,"animMarkerHovered",1):nd.eventName===bc.a.ys&&this.B0(nd.Ac,"animMarkerHovered",2);return!0};this.Bkc=(nd,ee)=>{nd?ee?(this.B0(nd,"animMarkerUnselected",2),this.B0(nd,"animMarkerSelected",1)):(this.B0(nd,"animMarkerSelected",
2),this.B0(nd,"animMarkerUnselected",1)):Jc.a.J(509682565,800,10,"AnimationMarkerView:selectMarker domElement is null")};this.B0=(nd,ee,Ue)=>{const n=this.EQc(nd);switch(Ue){case 0:nd.setAttribute(Wj.a.Aqa,ee);n&&nd.lastChild.setAttribute(Wj.a.Aqa,ee);break;case 1:Sys.UI.DomElement.addCssClass(nd,ee);n&&Sys.UI.DomElement.addCssClass(nd.lastChild,ee);break;case 2:Sys.UI.DomElement.removeCssClass(nd,ee),n&&Sys.UI.DomElement.removeCssClass(nd.lastChild,ee)}};this.EQc=nd=>!!nd&&!!nd.lastChild&&!!nd.lastChild.id&&
"overlappedMarker"===nd.lastChild.id;this.setPosition=()=>{};this.nE=nd=>{this.Uz=nd;this.Uz||(this.Nr(),this.u$(!0));this.setVisibility()};this.CD=()=>null;this.xx=()=>{};this.jB=()=>[];this.Ay=()=>{};this.LC=()=>{};this.Nr=()=>{!this.zk&&this.WN&&(this.oKa(!0),this.oKa(!1))};this.SRd=()=>{const nd=new jm.a;nd.gh(10,10);nd.xa.setAttribute(Wj.a.Aqa,"pointer-events-none");nd.gxa("0 0 2048 2048");const ee=new ol.a;ee.y0("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");
ee.oE("#E67E22");ee.Hu("#FFFF00");ee.ar(5);nd.appendChild(ee);return nd.xa};if(!z)throw Error.argumentNull("shapeNode");if(!U)throw Error.argumentNull("slideReader");if(!ka)throw Error.argumentNull("traverserFactory");if(!Ba)throw Error.argumentNull("paragraphReader");if(!Ob)throw Error.argumentNull("activeSlideViewManager");if(!Yb)throw Error.argumentNull("mouseInputManager");if(!uc)throw Error.argumentNull("clickInputManager");if(!mc)throw Error.argumentNull("focusManagers");if(!he)throw Error.argumentNull("effectSelectionManager");
if(!Yc)throw Error.argumentNull("pptUnitConversion");this.ta=z;this.lc=U;this.Cl=ka;this.Hh=Ba;this.az=Ab;this.wse=Ia;this.WN=Ob.Gc?Ob.Gc.dCc:null;this.Hre=Ob.Gc?Ob.Gc.umc:null;this.Yf=Yb;this.Wc=uc;this.Fa=mc;this.yb=Ec;this.I8=jd;this.tie=vd;this.hj=Yc;this.QD=he}dispose(){this.zk||(this.I8(),this.zk=!0,this.Db=!1,this.zOa(),this.Wc&&this.Vm&&this.Wc.xb(bc.a.click,this.Vm.xa,this.iQc),this.Yf&&this.Vm&&(this.Yf.xb(bc.a.fq,this.Vm.xa,this.AC),this.Yf.xb(bc.a.ys,this.Vm.xa,this.AC),this.Yf.xb(bc.a.dJ,
this.Vm.xa,this.oRa),this.Yf.xb(bc.a.mouseDown,this.Vm.xa,this.oRa)),this.Vm=null,this.Wc&&this.Xm&&this.Wc.xb(bc.a.click,this.Xm.xa,this.iQc),this.Yf&&this.Xm&&(this.Yf.xb(bc.a.fq,this.Xm.xa,this.AC),this.Yf.xb(bc.a.ys,this.Xm.xa,this.AC),this.Yf.xb(bc.a.dJ,this.Xm.xa,this.oRa),this.Yf.xb(bc.a.mouseDown,this.Xm.xa,this.oRa)),this.Fa=this.Hh=this.ta=this.Cl=this.lc=this.hj=this.QD=this.wb=this.Wg=this.WN=this.pb=this.Xm=null)}get visible(){return this.Db}set visible(z){this.Db=z}get mB(){return this.wb}get jq(){return this.Wg}get ie(){return this.pb}l3d(){return this.getClientRects(this.Hre)}getClientRects(z){let U,
ka;U=ka=0;if(!z)return Jc.a.J(509682572,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:U,top:ka};z=z.getClientRects();if(!z||!z.length||!z[0])return Jc.a.J(509682571,800,10,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:U,top:ka};ka=Math.round(z[0].top);U=Math.round(z[0].left);return{returnValue:!0,left:U,top:ka}}AXd(z){let U,ka;U=ka=0;if(!z||!z.length||!z[0])return Jc.a.J(509682568,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),
{returnValue:!1,top:U,bottom:ka};U=z[0].top;ka=z[0].bottom;for(let Ba=1;Ba<z.length&&z[Ba];Ba++)U=z[Ba].top>U?U:z[Ba].top,ka=z[Ba].bottom<ka?ka:z[Ba].bottom;return{returnValue:!0,top:U,bottom:ka}}t1d(z){let U,ka;U=ka=0;if(!this.ta)return{returnValue:!1,x:U,y:ka};var Ba=Object(A.a)(121,this.ta.oc(this.az));if(!Ba)return{returnValue:!1,x:U,y:ka};Ba=Ba.Zr();if(!Ba)return{returnValue:!1,x:U,y:ka};U=z?Ba.Yb-(this.sac?61:35):Ba.Yb-20-15;ka=Ba.$b;return{returnValue:!0,x:U,y:ka}}}Xl.cqa=(z,U)=>[new Dk.a(z[0]._x-
U,z[0]._y-U),new Dk.a(z[1]._x+U,z[1]._y-U),new Dk.a(z[2]._x+U,z[2]._y+U),new Dk.a(z[3]._x-U,z[3]._y+U)];Object(h.a)(Xl,"AnimationMarkerView",null,[573,535,536,106]);class dl{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc,jd,vd){this.Y0c=this.ucb=this.zk=this.Db=!1;this.STa=this.k8b=-1;this.sac=this.Uz=!1;this.va=new qk.a;this.Lac=this.nd=1;this.Xm=this.Vm=this.Wg=this.wb=this.pb=null;this.ta=z;this.lc=U;this.Cl=ka;this.Hh=Ba;this.az=Ab;this.wse=Ia;this.WN=Ob.Gc?Ob.Gc.dCc:null;this.Hre=Ob.Gc?Ob.Gc.umc:
null;this.Yf=Yb;this.Wc=uc;this.Fa=mc;this.yb=Ec;this.I8=jd;this.tie=vd;this.hj=Yc}dispose(){this.zk||(this.I8(),this.zk=!0,this.Db=!1,this.kWb(),this.zOa(),this.Yf&&this.Vm&&(this.Yf.xb(bc.a.fq,this.Vm.xa,Object(v.a)(this,this.AC,"onSelectionAreaHover")),this.Yf.xb(bc.a.ys,this.Vm.xa,Object(v.a)(this,this.AC,"onSelectionAreaHover"))),this.Vm=null,this.Yf&&this.Xm&&(this.Yf.xb(bc.a.fq,this.Xm.xa,Object(v.a)(this,this.AC,"onSelectionAreaHover")),this.Yf.xb(bc.a.ys,this.Xm.xa,Object(v.a)(this,this.AC,
"onSelectionAreaHover"))),this.wb=this.Wg=this.WN=this.pb=this.Xm=null)}get visible(){return this.Db}set visible(z){this.Db=z}get mB(){return this.wb}get jq(){return this.Wg}get ie(){return this.pb}ym(z){z&&this.WN?(this.pb=new rk.a,this.pb.jr("AnimationMarkerView"),this.WN.appendChild(this.pb.xa),this.wb=new xd.a,this.wb.Rj(0),this.pb.appendChild(this.wb.viewport),this.Wg=new ol.a,this.Wg.Rj(1),this.Wg.setVisibility(!1),this.wb.appendChild(this.Wg),this.Vm=new rk.a,this.Vm.jr("ShapeAnimationMarkerContainer"),
this.Vm.xa.id=this.ta.id.toString(),this.Vm.gh(20,this.pb.xa.clientHeight),this.Vm.Rj(1),this.pb.appendChild(this.Vm),this.Xm=new rk.a,this.Xm.jr("TextAnimationMarkerContainer"),this.Xm.xa.id=this.ta.id.toString(),this.Xm.gh(20,this.pb.xa.clientHeight),this.Xm.Rj(1),this.pb.appendChild(this.Xm),this.Yf.ob(bc.a.fq,this.Vm.xa,Object(v.a)(this,this.AC,"onSelectionAreaHover")),this.Yf.ob(bc.a.ys,this.Vm.xa,Object(v.a)(this,this.AC,"onSelectionAreaHover")),this.Yf.ob(bc.a.fq,this.Xm.xa,Object(v.a)(this,
this.AC,"onSelectionAreaHover")),this.Yf.ob(bc.a.ys,this.Xm.xa,Object(v.a)(this,this.AC,"onSelectionAreaHover")),this.setVisibility()):Jc.a.J(509682564,800,10,"AnimationMarkerView: {0} is null",z?"m_markerViewParentElement":"parent")}kN(z){let U=!1;z&&z.Ac.id.startsWith(Dd.a.yob)||z.Ac.id.startsWith("overlappedMarker")?(this.Xxe(z),U=!0):(this.kWb(),this.u$(!0));return U}setSelection(z){if(z&&!this.Y0c||!z)this.u$(z),this.kWb()}setVisibility(){let z=this.Db&&!this.Uz;this.ta&&this.ta.isHiddenShape&&
(z=!1);this.pb&&this.pb.Ld(z);this.Vm&&this.Vm.Ld(z);this.Xm&&this.Xm.Ld(z)}u$(z){if(this.Jca()){this.ucb=z;z=[this.Vm.xa.childNodes,this.Xm.xa.childNodes];for(const U of z)for(z=0;U&&z<U.length;z++)this.Bkc(U[z],this.ucb)}}j0b(z){if(!z||!this.ta)return null;z=z.getAttribute("AnimProps");if(!z||!z.toString()||!z.toString().trim().length)return null;z=z.toString().split(" ");if(!z||4!==z.length)return null;const U=[];for(const ka of z){if(!ka||!ka.trim().length)return null;U.push(Number.parseInvariant(ka.trim()))}return U}Jca(){const z=
!!this.ta&&!!this.WN&&!!this.Vm&&!!this.Xm;z||Jc.a.J(509682563,800,10,"AnimationMarkerView: the containers are not exist.");return z}zOa(){this.Oha(!0);this.Oha(!1)}Oha(z){if(this.Yf&&this.Wc&&this.Jca()&&(z=z?this.Xm.xa:this.Vm.xa)&&z.childNodes&&0<z.childNodes.length){const U=z.childNodes;for(const ka=0;ka<U.length;)z.removeChild(U[ka])}}oHd(){if(this.Jca()){var z=this.H8f(this.ta);if(z&&z.length){var U=!1,ka=!1,Ba=[];for(const Ia of z)Ia.IsTextRangeType?ka=!0:(U=!0,Ba.push(Ia));this.sac=U&&ka;
this.oKa(!0);this.oKa(!1);this.Oha(!1);0<Ba.length&&(Jc.a.J(509682562,800,50,"AnimationMarkerView: draw shape animation markers."),this.hZb(Ba,this.hj.YL(this.ta.Uo.$b,this.nd),this.hj.YL(this.ta.Uo.Ub-this.ta.Uo.$b,this.nd),!1,-1)||Jc.a.J(509682561,800,10,"AnimationMarkerView: no shape marker is rendered"));ka?this.PVd():this.Oha(!0);if(!ka&&-1!==this.STa||-1!==this.STa&&-1===this.STa&&!U)this.BOd(),this.u$(!0)}else this.zOa()}}PVd(){const z=new ad.a(2,1,0,Object(v.a)(this,this.ensureTextIsRenderedAndDrawMarkers,
"ensureTextIsRenderedAndDrawMarkers"),90,"26");this.yb.Cb(z)}ensureTextIsRenderedAndDrawMarkers(){this.zk||(this.tie(),this.iZb())}iZb(){this.Oha(!0);if(this.m6d(this.ta)){var z=this.d3d();if(z&&z.length){var U;if(({top:U}=this.l3d()).returnValue){var ka=0;Jc.a.J(509682530,800,50,"AnimationMarkerView: draw paragraph animation markers.");for(let Ia=0;Ia<z.length;Ia++){var Ba=this.lc.ig(this.ta);if(!Ba)return;(Ba=Ba.vOc(this.ta,Ia))&&0<Ba.length&&z[Ia]&&(ka+=this.hZb(Ba,z[Ia].top-U,z[Ia].height,!0,
Ia))}ka||Jc.a.J(509682529,800,10,"AnimationMarkerView: no paragraph marker is rendered.")}else Jc.a.J(509682531,800,50,"AnimationMarkerView: GetSlideContentClientRects failed.")}else Jc.a.J(509682560,800,50,"AnimationMarkerView: the paragrph view is not rendered")}}d3d(){const z=[];var U=Wi.GraphIterator.mb(this.ta);U=this.Cl.n2(U,U.currentNode);for(var ka;U.moveNext();)(ka=U.currentNode)&&this.Hh.Vd(ka)&&ka&&(ka=ka.oc(this.az))&&ka.htmlElement&&(ka=this.fsa(ka.htmlElement))&&ka.height&&z.push(ka);
return z}l3d(){return this.getClientRects(this.Hre)}getClientRects(z){let U,ka;U=ka=0;if(!z)return Jc.a.J(509682528,800,10,"AnimationMarkerView: element is null for GetClientRects."),{returnValue:!1,left:U,top:ka};z=z.getClientRects();if(!z||!z.length||!z[0])return Jc.a.J(509682527,800,50,"AnimationMarkerView: cannot get boundingRects."),{returnValue:!1,left:U,top:ka};ka=Math.round(z[0].top);U=Math.round(z[0].left);return{returnValue:!0,left:U,top:ka}}fsa(z){if(!z)return Jc.a.J(509682526,800,10,"AnimationMarkerView: paragraph is null"),
null;z=z.querySelectorAll(".TextRun");if(!z||!z.length)return null;let U=0,ka=0;let Ba,Ia=!1;for(let Ob=0;Ob<z.length&&z[Ob];Ob++){var Ab=z[Ob].getClientRects();({top:Ab,bottom:Ba}=this.AXd(Ab)).returnValue&&(Ob?(U=U>Ab?Ab:U,ka=ka<Ba?Ba:ka):(U=Ab,ka=Ba),Ia=!0)}if(Ia)return new ej(ka-U,U);Jc.a.J(509682525,800,50,"AnimationMarkerView: search failed in GetParagraphProperties.");return null}AXd(z){let U,ka;U=ka=0;if(!z||!z.length||!z[0])return Jc.a.J(509682524,800,50,"AnimationMarkerView: boundingRects is nulll or empty."),
{returnValue:!1,top:U,bottom:ka};U=z[0].top;ka=z[0].bottom;for(let Ba=1;Ba<z.length&&z[Ba];Ba++)U=z[Ba].top>U?U:z[Ba].top,ka=z[Ba].bottom<ka?ka:z[Ba].bottom;return{returnValue:!0,top:U,bottom:ka}}hZb(z,U,ka,Ba,Ia){if(!this.Jca()||!z||!z.length)return 0;const Ab=Ba?this.Xm.xa:this.Vm.xa;ka=(ka=Math.floor(this.hj.Hm(ka)/21))?ka:1;let Ob=0,Yb=null,uc=new rk.a,mc=!1,Ec=!1;const Yc=Ia===this.STa&&z.length<this.k8b+1;for(let vd=0;vd<z.length;vd++){const he=z[vd],nd=new rk.a;nd.xa.id=Dd.a.yob+he.BuildId;
nd.gh(20,16);nd.Rj(1);if(he.IsTrigger){var jd=this.SRd();nd.xa.appendChild(jd)}else nd.xa.innerText=he.BuildId.toString();let ee=jd=!1;vd<ka?(Ba&&(nd.xa.style.position=Wj.a.absolute,nd.xa.style.top=xj.a.Nc(this.hj.Hm(U)+21*Ob)),nd.xa.setAttribute("AnimProps",String.format("{0} {1} {2} {3}",vd,Ia,he.BuildId,he.EffectId)),Ec=this.ucb||Yc&&z.length-1===vd||this.Y0c&&this.k8b===vd&&this.STa===Ia,nd.xa.setAttribute(Wj.a.Aqa,Ec?"animMarkerSelected":"animMarkerUnselected"),Ab.appendChild(nd.xa),Ob++):vd===
ka&&uc.xa?(mc=mc&&he.EffectId===Yb.EffectId,jd=!0,ee=Yb.IsTrigger):mc=mc&&he.EffectId===Yb.EffectId;jd&&uc.xa.appendChild(this.kMd(ee,mc,Ec));uc=nd;Yb=he}this.hM();return Ob}kMd(z,U,ka){const Ba=new rk.a;Ba.xa.id="overlappedMarker";Ba.xa.style.marginTop=z?"3px":"-13px";Ba.xa.setAttribute(Wj.a.Aqa,"overlappedMarker "+(ka?"animMarkerSelected":"animMarkerUnselected"));U&&this.B0(Ba.xa,"SameEffectOverlapped",1);return Ba.xa}hM(){this.wse(this.pb.xa,!0)}H8f(z){if(!z)return null;const U=this.lc.ig(z);return U?
U.fRa(z):null}m6d(z){z=this.H8f(z);if(!z||!z.length)return!1;for(const U of z)if(U.IsTextRangeType)return!0;return!1}oKa(z){if(this.Jca()){var U=z?this.Vm.xa:this.Xm.xa,ka,Ba;U&&({x:ka,y:Ba}=this.t1d(z)).returnValue&&(U.style.position=Wj.a.absolute,U.style.left=xj.a.Nc(ka),U.style.zIndex="20000",z?U.style.top=xj.a.Nc(Ba):this.iZb())}}t1d(z){let U,ka;U=ka=0;if(!this.ta)return{returnValue:!1,x:U,y:ka};var Ba=Object(A.a)(121,this.ta.oc(this.az));if(!Ba)return{returnValue:!1,x:U,y:ka};Ba=Ba.Zr();if(!Ba)return{returnValue:!1,
x:U,y:ka};U=z?Ba.Yb-(this.sac?61:35):Ba.Yb-20-15;ka=Ba.$b;return{returnValue:!0,x:U,y:ka}}Xxe(z){if(this.va&&z&&this.Fa&&z.Ac){var U=z.Ac.id.startsWith("overlappedMarker")&&z.Ac.offsetParent?z.Ac.offsetParent:z.Ac;this.i3k(U);this.EQc(U)&&!this.OOj(U)&&this.BOd();this.u$(!1);this.Bkc(U,!0);this.va.raiseEvent("OnMarkerClick",z);this.Fa.Ad()}}kWb(){this.Y0c=!1;this.STa=this.k8b=-1;this.BOd()}i3k(z){(z=this.j0b(z))?(this.Y0c=!0,this.k8b=z[0],this.STa=z[1],this.ta.Twa=this.k8b,this.ta.NIa=this.STa):Jc.a.J(509682523,
800,10,"AnimationMarkerView: failed to parse the animation properties.")}BOd(){this.ta&&(this.ta.Twa=-1,this.ta.NIa=-1)}Gl(){this.wb&&(this.JKb(),this.wb.Gl())}JKb(){if(this.ta&&this.Wg){var z=this.ta.Uo.points;z=dl.cqa(z,this.Ztb());this.Wg.ht(z)}}Ztb(){let z=Dd.a.NGb;this.ta.Pf||!this.ta.gta&&!this.ta.Sk||(z+=6);return z}Qp(){this.wb&&this.Lac!==this.nd&&this.rfb();return null}Gq(){}Gu(){}Dj(z){this.Lac=this.nd;this.nd=z}setZIndex(z){this.wb&&this.wb.pB(z)}draw(){this.rfb()}rfb(){this.pb&&this.WN&&
this.Db&&!this.Uz&&this.oHd();this.setVisibility()}AC(z){if(!this.va||!z)return!1;this.va.raiseEvent("OnSelectionAreaHover",z);z.eventName===bc.a.fq?this.B0(z.Ac,"animMarkerHovered",1):z.eventName===bc.a.ys&&this.B0(z.Ac,"animMarkerHovered",2);return!0}Bkc(z,U){z&&(U?(this.B0(z,"animMarkerUnselected",2),this.B0(z,"animMarkerSelected",1)):(this.B0(z,"animMarkerSelected",2),this.B0(z,"animMarkerUnselected",1)))}B0(z,U,ka){const Ba=this.EQc(z);switch(ka){case 0:z.setAttribute(Wj.a.Aqa,U);Ba&&z.lastChild.setAttribute(Wj.a.Aqa,
U);break;case 1:Sys.UI.DomElement.addCssClass(z,U);Ba&&Sys.UI.DomElement.addCssClass(z.lastChild,U);break;case 2:Sys.UI.DomElement.removeCssClass(z,U),Ba&&Sys.UI.DomElement.removeCssClass(z.lastChild,U)}}EQc(z){return!!z&&!!z.lastChild&&!!z.lastChild.id&&"overlappedMarker"===z.lastChild.id}OOj(z){return!!z&&!!z.lastChild&&!!z.lastChild.id&&0<=z.lastChild.className.indexOf("SameEffectOverlapped")}setPosition(){}nE(z){(this.Uz=z)?this.kWb():(this.Nr(),this.u$(!0));this.setVisibility()}CD(){return null}xx(){}jB(){return[]}Ay(){}LC(){}Nr(){!this.zk&&
this.WN&&(this.oKa(!0),this.oKa(!1))}SRd(){const z=new jm.a;z.gh(10,10);z.xa.setAttribute(Wj.a.Aqa,"pointer-events-none");z.gxa("0 0 2048 2048");const U=new ol.a;U.y0("M 421 1984 l 422 -896 h -478 l 569 -1024 h 599 l -499 640 h 621 l -1077 1280 M 1165 640 h 627 l -1184 1408 h -288 l 422 -896 h -486 l 640 -1152 h 768 m -1116 1920 l 969 -1152 h -614 l 499 -640 h -431 l -498 896 h 471 l -422 896");U.oE("#E67E22");U.Hu("#FFFF00");U.ar(5);z.appendChild(U);return z.xa}static cqa(z,U){return[new Dk.a(z[0]._x-
U,z[0]._y-U),new Dk.a(z[1]._x+U,z[1]._y-U),new Dk.a(z[2]._x+U,z[2]._y+U),new Dk.a(z[3]._x-U,z[3]._y+U)]}}Object(h.a)(dl,"AnimationMarkerViewLegacy",null,[561,535,536,106]);var kg=d(277),km=d(186);class Ki{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb){this.uBb=this.EW=!1;this.bE=[];this.s4c=new Set;this.initialize=()=>{this.Ot.Yj(this.fh);this.Ee.z3a(this.e$);this.eq.uV(this.onActiveSlideDomReady);this.eq.iob(this.pma);this.eq.VId(this.PWa);this.ra.VH(this.rea)};this.dispose=()=>{this.Ot.tm(this.fh);this.Ee.TFb(this.e$);
this.eq.Tma(this.onActiveSlideDomReady);this.eq.yjc(this.pma);this.eq.uGe(this.PWa);this.ra.Ewa(this.rea);this.s4c=this.bE=this.Qz=this.lc=this.ra=this.eq=this.Ee=this.Ot=null};this.PWa=()=>{this.H2b()};this.rea=()=>{this.H2b()};this.H2b=()=>{const uc=this.ra.Yd();this.lWb();const mc=this.Qz.jl();if(mc&&mc.length){var Ec=new Set;for(const Yc of uc)Ec.add(Yc.id);for(const Yc of mc)Ec.has(Yc.id)?this.x3h(Yc):this.GQk(Yc)}};this.Nlj=(uc,mc)=>{mc&&uc&&uc.length&&(this.UPd(uc[0])?(mc=this.bE.filter(Ec=>
!uc.includes(Ec.EffectNodeId)),this.lWb(),this.Wqa(),this.$Hd(mc)):(mc=this.lc.I8f(uc,mc),this.DHd(mc),mc=Object.assign([],this.bE),this.lWb(),this.Wqa(),this.$Hd(mc)))};this.Wqa=()=>{const uc=this.ra.Yd();this.ra.Wqa(uc)};this.$Hd=uc=>{if(uc&&uc.length){this.DHd(uc);var mc=this.Qz.jl();if(mc&&mc.length){uc=new Map;for(var Ec of this.bE){var Yc=Zf.a.Mf(Ec.ShapeId).toString();uc.has(Yc)||uc.set(Yc,new Set);Yc=uc.get(Yc);null===Yc||void 0===Yc?void 0:Yc.add(Ec.EffectNodeId)}for(const jd of mc)if(Ec=
this.q$a.AG(jd))Ec.u$(!1),mc=jd.id.toString(),(mc=uc.has(mc)?uc.get(mc):null)&&mc.size&&Ec.i0k(Array.from(mc));this.Ee.mz(new km.a(7))}}};this.u3h=(uc,mc)=>{mc&&uc&&uc.length&&(this.lWb(),uc=this.lc.I8f(uc,mc),this.$Hd(uc))};this.x3h=uc=>{if(uc){var mc=this.lc.ig(uc);mc&&(mc=mc.ttb(uc),this.DHd(mc),this.q$a.AG(uc).u$(!0))}};this.GQk=uc=>{uc&&(uc=this.q$a.AG(uc))&&uc.u$(!1)};this.DHd=uc=>{if(uc&&uc.length)for(const mc of uc)this.UPd(mc.EffectNodeId)||(this.bE.push(mc),this.s4c.add(mc.EffectNodeId))};
this.UPd=uc=>this.s4c.has(uc);this.fh=(uc,mc)=>{mc&&mc.property===db.a.HJd&&this.EW&&this.lc.ig(mc.node)===this.Qz&&(this.nIa(this.EW),this.H2b(),this.Ee.mz(new km.a(7)))};this.e$=(uc,mc)=>{if(mc){if(this.EW=!!mc.V9&&0<=mc.V9.indexOf("Animation"))this.uBb=!0;this.nIa(this.EW)}};this.pma=(uc,mc)=>{uc=this.ua.Ba;mc&&uc&&uc.yN&&uc===this.Qz&&(mc=mc.xw)&&mc.shapeNode&&this.Qz&&this.pEa(this.Qz.Bb,mc.shapeNode)&&this.nIa(this.EW)};this.pEa=(uc,mc)=>uc&&mc?uc.equals(mc.slideId):!1;this.onActiveSlideDomReady=
(uc,mc)=>{mc&&(uc=Object(A.a)(120,mc.Ba))&&this.Qz&&this.Qz.Bb!==uc.Bb&&(this.Qz=uc,this.lWb(),this.nIa(this.EW))};this.nIa=uc=>{if(this.uBb&&this.Qz&&this.Qz.yN&&this.Hc.Gc&&this.Hc.Gc.dCc){var mc=this.Qz.jl();if(mc&&mc.length)for(const Ec of mc)if(mc=this.q$a.AG(Ec))mc.visible=uc,mc.rfb()}};this.lWb=()=>{this.s4c.clear();this.bE.length=0};if(!z)throw Error.argumentNull("graphTopologyManager");if(!U)throw Error.argumentNull("slideReader");if(!ka)throw Error.argumentNull("graphNodeEventHandlers");
if(!Ba)throw Error.argumentNull("viewElementEventHandler");if(!Ia)throw Error.argumentNull("viewEventNotifier");if(!Ab)throw Error.argumentNull("animationMarkerViewManager");if(!Ob)throw Error.argumentNull("activeSlideViewManager");if(!Yb)throw Error.argumentNull("selectionManager");this.ua=z;this.lc=U;this.Ot=ka;this.eq=Ba;this.q$a=Ab;this.Ee=Ia;this.Qz=this.ua.Ba;this.Hc=Ob;this.ra=Yb}}Object(h.a)(Ki,"EffectSelectionManager",null,[559,106]);class vm{constructor(){this.K=null;this.szb=!1}get name(){return"PowerPointWebEditor.Animations"}Wb(z){this.K=
z;(this.szb=this.K.resolve("PowerPointWebEditor.IApplicationContext").ld.zob)?(this.K.register(488,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>").ma().na(()=>new kg.a((U,ka)=>{let Ba=null;const Ia=Object(A.a)(121,U.oc(this.K.resolve("Box4.IPageView").Ma));Ia&&!Ia.ll&&Ia.xa&&(Ba=new Xl(U,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.IParagraphReader"),
Object(v.a)(Ia,Ia.hM,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),L.AFrameworkApplication.pe,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ka,()=>{Ia.VBa()},this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager")),Ba.ym(Ia.xa),Ba.setZIndex(4),Ba.visible=!1,
Ia.hM(Ba.ie.xa,!0),Ia.Ypa(Ba,4));return Ba})),this.K.register(Ki,"PowerPointWebEditor.Animations.IEffectSelectionManager").ma().na(()=>new Ki(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Box4.Graph.IGraphInstance").vd(8),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerView>"),
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))):(this.K.register(488,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>").ma().na(()=>new kg.a((U,ka)=>{let Ba=null;const Ia=Object(A.a)(121,U.oc(this.K.resolve("Box4.IPageView").Ma));Ia&&!Ia.ll&&Ia.xa&&(Ba=new dl(U,this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),
this.K.resolve("Box4.IParagraphReader"),Object(v.a)(Ia,Ia.hM,"takeOwnershipOfSubtree"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("Common.MouseInputManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),L.AFrameworkApplication.pe,this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),ka,()=>{Ia.VBa()}),Ba.ym(Ia.xa),Ba.setZIndex(4),Ba.visible=!1,Ia.hM(Ba.ie.xa,!0),Ia.Ypa(Ba,4));
return Ba})),this.K.register(Af,"PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").ma().na(()=>new Af(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Box4.Graph.IGraphInstance").vd(8),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.Animations.IAnimationMarkerViewLegacy>"),
this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"))))}init(){this.szb?this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").initialize():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").initialize()}dispose(){this.szb?this.K.resolve("PowerPointWebEditor.Animations.IEffectSelectionManager").dispose():this.K.resolve("PowerPointWebEditor.Animations.AnimationMarkerManagerLegacy").dispose()}static main(){ua.a.instance.Bc(Bb.a(new vm,0))}}Object(h.a)(vm,
"PPTWebEditorAnimationsPackage",null,[2,3]);var pj=d(1012),Df=d(122);class Qh{constructor(z,U,ka,Ba){this.ia=z;this.Fa=U;this.Zke=ka;this.uc=Ba}ub(){this.ia.ya(Qc.a.find,xc.a.view,Object(v.a)(this,this.findText,"findText"));this.ia.ya(Qc.a.find,xc.a.notes,Object(v.a)(this,this.findText,"findText"));this.ia.ya(Qc.a.find,xc.a.Of,Object(v.a)(this,this.findText,"findText"));this.ia.ya(qa.a.findInDocument,xc.a.view,Object(v.a)(this,this.findInDocument,"findInDocument"));this.ia.he(Qc.a.find,0);this.ia.ya(Qc.a.Z4,
xc.a.view,Object(v.a)(this,this.Z4,"replaceText"));this.ia.ya(Qc.a.Z4,xc.a.notes,Object(v.a)(this,this.Z4,"replaceText"));this.ia.ya(Qc.a.Z4,xc.a.Of,Object(v.a)(this,this.Z4,"replaceText"));this.ia.he(Qc.a.Z4,4)}xe(){const z=[this.Fa.Dc(Df.a.oD),this.Fa.Dc(Df.a.c2),this.Fa.Dc(tf.a.Bg),this.Fa.Dc(tf.a.LP)];for(const U of z)U.bindAction(cc.KeyInputManager.Na(Bg.a.boa,cc.KeyInputManager.He),Qc.a.find),U.bindAction(cc.KeyInputManager.Na(Bg.a.tjb,cc.KeyInputManager.He),Qc.a.Z4)}findText(z,U,ka){return U.contextId!==
xc.a.view&&U.contextId!==xc.a.notes&&U.contextId!==xc.a.Of?2:1===ka?this.uc.Hj()?32:8:2===ka?(this.Zke.Ruh(U),Jc.a.J(539773087,820,50,"FindTextDialog is initialized."),32):8}Z4(z,U,ka){return U.contextId!==xc.a.view&&U.contextId!==xc.a.notes&&U.contextId!==xc.a.Of?2:1===ka?this.uc.Hj()?32:8:2===ka?(this.Zke.bjl(U),Jc.a.J(539773088,820,50,"ReplaceTextDialog is initialized."),32):8}findInDocument(z,U,ka,Ba,Ia){if(U.contextId!==xc.a.view&&U.contextId!==xc.a.notes&&U.contextId!==xc.a.Of)return 2;if(1===
ka)return 32;if(2===ka){if(!Ia)return 8;z=Ia.CommandValueId||"";Jc.a.J(539773089,820,50,"Find. ActionData QueryLength: {0}",z.length);this.Zke.Kil(U,z);Jc.a.J(539773090,820,50,"FindTextDialog is initialized from Search Box.");return 32}return 8}}Object(h.a)(Qh,"FindReplaceTextActor",null,[229]);var Yl=d(1200);class qj extends Yl.a{constructor(z,U,ka){super(!1,!0);this.Kie=!1;this.o4c=null;this.cAb=!1;this.CHg=this.KIg=null;this.Yke=!0;this.hle=this.ile=this.gle=!1;this.qla=null;this.K3c=!1;this.Hqe=
!0;this.oRg=this.lne=!1;this.GPg=this.IPg=null;this.pNg=0;this.Fa=z;this.G8=U;this.Oak="FindReplaceTextDialog";this.q_=ResourceStrings.l_FindTextTitle;ka&&(this.q_=ResourceStrings.l_ReplaceTextTitle);this.rne=ka;this.cV=!1}n5(){this.tj(this.q_,this.G8,this.C7());this.Kie=!1}dispose(){super.dispose();this.Kie=!0}JIi(){this.gle=this.Yke=!1;this.M5(this.q_,this.G8,this.C7())}D0f(z){z&&(this.Fa.Bf(Td.AFrame.S9),this.gle=!0);this.Yke=!0;this.M5(this.q_,this.G8,this.C7())}i3b(){this.hide()}t3k(z){this.o4c=
z.searchString;this.cAb=z.matchCase;this.qla=z.replaceString}ll(){return this.Kie}CYa(z,U){this.CHg=z;this.pNg=U;this.oRg=0===U;this.M5(this.q_,this.G8,this.C7())}xhd(z){this.KIg=z;this.M5(this.q_,this.G8,this.C7())}Shd(z){this.IPg=z;this.M5(this.q_,this.G8,this.C7())}rLe(z){this.GPg=z;this.M5(this.q_,this.G8,this.C7())}get jYa(){return this.o4c}set jYa(z){this.o4c=z}get matchCase(){return this.cAb}set matchCase(z){this.cAb=z}get RGe(){return this.qla}set RGe(z){this.qla=z}LMi(z){z&&(this.Fa.Bf(Td.AFrame.S9),
this.ile=!0);this.K3c=!0;this.M5(this.q_,this.G8,this.C7())}NTd(){this.ile=this.K3c=!1;this.M5(this.q_,this.G8,this.C7())}KMi(z){z&&(this.Fa.Bf(Td.AFrame.S9),this.hle=!0);this.Hqe=!0;this.M5(this.q_,this.G8,this.C7())}LIi(){this.hle=this.Hqe=!1;this.M5(this.q_,this.G8,this.C7())}Xkl(){this.q_=ResourceStrings.l_ReplaceTextTitle;this.rne=!0;this.K3c=!1;this.M5(this.q_,this.G8,this.C7());this.Fa.Bf(Td.AFrame.S9)}JMi(){this.lne=!0;this.M5(this.q_,this.G8,this.C7())}V_i(){return{["searchString"]:this.o4c,
["findNextButtonAriaLabel"]:this.KIg,["errorMessage"]:this.CHg,["findNextButtonIsEnabled"]:this.Yke,["focusFindNextButton"]:this.gle,["focusDialog"]:Object(v.a)(this,this.VVi,"focusDialog"),["isReplaceActive"]:this.rne,["replaceButtonIsEnabled"]:this.K3c,["replaceAllButtonIsEnabled"]:this.Hqe,["showMessageAsError"]:this.oRg,["messageStatus"]:this.pNg,["focusReplaceButton"]:this.ile,["focusReplaceAllButton"]:this.hle,["replaceButtonAriaLabel"]:this.IPg,["replaceAllButtonAriaLabel"]:this.GPg,["readOnlyModeEnabled"]:this.lne}}C7(){return{["id"]:this.Oak,
["bodyControls"]:this.V_i(),["isModal"]:!1}}VVi(){this.Fa.Bf(Td.AFrame.S9)}}Object(h.a)(qj,"ReactFindReplaceTextDialog",Yl.a,[547]);class pl{constructor(z){this.Fa=z}getInstance(z,U){return new qj(this.Fa.value,z,U)}}Object(h.a)(pl,"FindReplaceTextDialogFactory",null,[496]);class Il{constructor(){this.B5=this.vfa=this.paragraphIndex=this.eR=this.slideIndex=0}reset(){this.slideIndex=this.eR=this.paragraphIndex=0;this.vfa=this.B5=-1}clone(){const z=new Il;z.slideIndex=this.slideIndex;z.eR=this.eR;z.paragraphIndex=
this.paragraphIndex;z.vfa=this.vfa;z.B5=this.B5;return z}}Object(h.a)(Il,"TextPosition",null,[]);class $m{constructor(){this.Vne=this.qZc=null;this.EO=new Il;this.Zl=new Il;this.state=this.sJa=0;this.Ipb=this.eWd=!1;this.pattern=this.gYb=this.iYb=null;this.matchCase=!1;this.reset()}reset(){this.sJa=0;this.EO.reset();this.Zl.reset();this.state=0;this.Ipb=this.eWd=!1;this.Vne=this.bPa=this.gYb=this.iYb=null}get bPa(){return this.qZc}set bPa(z){if(this.qZc=z)this.Vne=this.qZc}get RTj(){return this.Vne}}
Object(h.a)($m,"FindContext",null,[]);var Hj=d(50),el=d(91);class ql{constructor(){this.ShouldMatchCase=!1}}Object(h.a)(ql,"MatchTextInfo",null,[]);class ri{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.OldStr=this.NewStr=this.MatchTxtInfo=null}}Object(h.a)(ri,"ReplaceAllTextInfo",null,[]);var un=d(938),vn=d(157);class Ci{constructor(){this.message=this.title=null;this.Dlg=!1;this.SEb=null;this.Ilg=!1;this.Egd=null;this.L_k=this.vCk=0;this.M_k=this.wCk=null;this.rSe=0}}Object(h.a)(Ci,
"CalloutNotificationMessageAttributes",null,[]);var Jl=d(319);class Aa{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc,jd,vd,he,nd,ee,Ue,n,Y,ra,Pa,eb){this.mGa=this.km=this.PD=null;this.xd=new $m;this.qla=this.BF="";this.iac=!1;this.aBb=this.Dbb=0;this.$Ab=Date.now();this.J3c=-1;this.Xke=0;this.s3c=-1;this.ia=z;this.A9b=U;this.Fa=ka;this.Eq=Ba;this.uc=Ia;this.Ea=Ab;this.Nl=Ob;this.xua=Yb;this.Mb=uc;this.yb=mc;this.Zb=Ec;this.ua=Yc;this.Nb=jd;this.Fb=nd;this.Ee=vd;this.zq=he;this.JW=ee;this.JGa=Ue;this.RMg=
n;this.acb=Y;this.N8j=ra;this.sQ=eb;this.HPg=Pa}Ruh(z){this.PD=z;this.km=this.RMg.value.getInstance(Object(v.a)(this,this.v5f,"findReplaceTextDialogResultHandler"),!1);this.BF&&(this.km.jYa=this.BF,this.s3c=-1);this.km.n5();3!=this.ia.mode&&this.km.JMi();this.NSa()&&this.LTd()}Kil(z,U){this.NSa()||(this.BF=U);this.Ruh(z);this.NSa()||(this.km.jYa=this.BF,this.km.n5(),this.nTe(U,!1))}bjl(z){this.PD=z;this.km=this.RMg.value.getInstance(Object(v.a)(this,this.v5f,"findReplaceTextDialogResultHandler"),
!0);this.BF&&(this.km.jYa=this.BF);this.km.n5();this.NSa()&&this.LTd()}v5f(z,U){if(U)switch(this.km.t3k(U),z){case 1:this.Akk();break;case 2:this.Bkk();break;case 3:this.Ckk(this.km.RGe);break;default:this.Xcl(),this.clearSelection(),this.xd.reset(),this.km.i3b()}else Jc.a.J(512496416,820,10,"Got null control value for findreplace dialog")}Tkg(){return this.xd.iYb&&this.jHd!==this.xd.iYb.we}nTe(z,U){this.bZf();if(0===this.xd.state||3===this.xd.state||z!==this.BF||U!==this.iac||this.Tkg())this.iyj(z,
U),this.s3c=-1;this.xd.Ipb=!1;this.d9c()}get jHd(){return this.ua.Ba?this.ua.Ba.we:0}iyj(z,U){const ka=z===this.BF&&3===this.xd.state&&!this.Tkg(),Ba=this.xd.EO.clone();this.xd.reset();this.BF=z;this.iac=U;ka?this.xd.EO=Ba.clone():(this.xd.EO.slideIndex=this.jHd,this.O5i());this.xd.Zl=this.xd.EO.clone()}d9c(){this.rUi(this.BF,this.iac)?4!==this.xd.state&&this.setSelection():(e.ULS.sendTraceTag(539829126,820,50,"Text not found"),this.FZb())}rUi(z,U){var ka=this.ua.presentation;if(!ka)throw Error.argumentNull("Presentation is null");
if(ka=ka.slides||[],ka.length){this.xd.sJa=ka.length;const Ba=ka.length+this.xd.EO.slideIndex;for(;this.xd.Zl.slideIndex<=Ba;){const Ia=this.xd.Zl.slideIndex%ka.length,Ab=this.tUi(ka[Ia],z,U,this.xd.Zl.slideIndex===Ba?this.xd.EO.eR:Aa.Xte);if(Ab&&(this.xd.iYb=this.uc.kl(Ab.Bb)))return!0;if(7===this.xd.state)return this.xd.Ipb&&(Jc.a.J(512496414,820,50,"call into PerformBackendFind recursively."),this.xd.state=0),this.Zwk(ka[Ia]?ka[Ia].Bb:null,z,U);if(3===this.xd.state)break;let Ob;(Ob=this.xd.Zl).slideIndex=
Ob.slideIndex+1;this.xd.Zl.eR=0}}else this.xd.state=1;return!1}tUi(z,U,ka,Ba){if(!z)return null;var Ia=this.uc.kl(z.Bb),Ab=this.Nb.Kc(Ia);Ia=Ia.gRa()||[];(Ab=Ab.Ab(27))&&Ia.push(Ab);if(!Ia.length)return this.xd.state=7,null;for(;this.xd.Zl.eR<=Math.min(Ia.length-1,Ba);){if(this.xd.gYb=this.sUi(Ia[this.xd.Zl.eR],U,ka,this.xd.Zl.eR===Ba?this.xd.EO.paragraphIndex:Aa.Xte))return z;let Ob;(Ob=this.xd.Zl).eR=Ob.eR+1;this.xd.Zl.paragraphIndex=0}return null}sUi(z,U,ka,Ba){if(!this.Nl.$Da(z)&&z.fC)return null;
const Ia=el.a.createInstance(z);let Ab=0;for(;Ia.moveNext()&&this.xd.Zl.paragraphIndex<=Ba;){const Ob=Ia.currentNode;if(nf.ParagraphReader.Vd(Ob)&&Ab++===this.xd.Zl.paragraphIndex){if(this.xd.bPa=this.pUi(Ob,U,ka,this.xd.Zl.paragraphIndex===Ba?this.xd.EO.vfa:Aa.Xte))return z;let Yb;(Yb=this.xd.Zl).paragraphIndex=Yb.paragraphIndex+1;this.xd.Zl.vfa=this.xd.Zl.B5=-1}}return null}pUi(z,U,ka,Ba){if(!nf.ParagraphReader.Vd(z))return null;let Ia=z.ntb();if(!Ia.length)return null;Ia=Ia.substring(0,Math.min(Ia.length,
Ba));return this.uUi(Ia,Math.max(0,this.xd.Zl.B5),U,ka)?z:null}uUi(z,U,ka,Ba){let Ia=z,Ab=ka;Ba||(Ia=z.toLowerCase(),Ab=ka.toLowerCase());z=Ia.indexOf(Ab,-1===U?0:U);if(-1!==z)return this.xd.Zl.vfa=z,this.xd.Zl.B5=z+Ab.length,this.xd.state=2,this.xd.eWd=!0;this.xd.state=1;return!1}O5i(){var z=vn.b(this.PD);z=z?z.Gb:null;if(!z||!z.Oa)e.ULS.sendTraceTag(512496411,820,50,"There could be no slide at all");else if(z.Oa.kb){var U=z.Oa.kb.Ua;if(nf.ParagraphReader.Vd(U.node)){z=Object(A.a)(5,U.node);this.xd.EO.vfa=
U.Qa;this.xd.EO.B5=U.Qa;const ka=this.Ea.hca(U.node);ka?(this.xd.EO.eR=ka.get_zIndex()-1,this.xd.EO.paragraphIndex=this.Vdg(z)):this.Nl.Ltb(U.node)&&(U=this.ua.Ba?this.ua.Ba.gRa():null,this.xd.EO.eR=U?U.length:0,this.xd.EO.paragraphIndex=this.Vdg(z))}else this.Ea.oEa(U.node)&&(this.xd.EO.eR=U.node.get_zIndex()-1)}}Vdg(z){z=this.Nb.Kc(z);if(!z.I5(ka=>10===ka.type||60===ka.type||16===ka.type))return 0;z.yc();const U=z.pq;z.yc();return Math.max(0,z.BQa(U))}FWg(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");
return this.xd.EO.slideIndex||this.xd.EO.eR?this.xd.Zl.slideIndex<(z.slides||[]).length:!1}Jig(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");this.xd.Zl.slideIndex=z.slides?z.slides.length:0;this.xd.Ipb=!1;this.d9c()}ATc(){return this.km.ll()}Yjk(z){if(!this.ATc()){Jc.a.J(512496409,820,50,"OnBackendFindSucceeded");var U=Nd.a.empty;({slideId:U}=Nd.a.uAh(z));(z=this.uc.Via(U))?(U=z.slideIndex,U>this.xd.EO.slideIndex&&U<this.xd.Zl.slideIndex?this.FZb():this.Zb.Ba!==
z?(this.Eq.uV(Object(v.a)(this,this.kDb,"onActiveSlideDomChanged")),this.Zb.Ba=z):(this.xd.state=5,this.xd.Ipb=!0,this.xd.Zl.slideIndex=this.xd.Zl.slideIndex>U?U+this.xd.sJa:U,this.xd.Zl.eR=0,this.xd.Zl.paragraphIndex=0,this.xd.Zl.vfa=-1,this.xd.Zl.B5=-1,this.d9c())):this.FWg()?this.Jig():this.FZb()}}kDb(){Jc.a.J(512496408,820,50,"OnActiveSlideDomChanged");this.Eq.Tma(Object(v.a)(this,this.kDb,"onActiveSlideDomChanged"));this.ATc()||this.mGa||(this.mGa=new ad.a(3,1,0,Object(v.a)(this,this.pye,"onPostActiveSlideDomChangedTask"),
90,"30"),this.yb.Cb(this.mGa))}pye(){Jc.a.J(512496407,820,50,"OnPostActiveSlideDomChangedTask");this.mGa=null;if(!this.ATc())if(4===this.xd.state){const z=this.jHd;this.xd.Zl.slideIndex=this.xd.Zl.slideIndex>z?z+this.xd.sJa:z;this.xd.state=5;this.xd.Ipb=!0;this.d9c()}else 2===this.xd.state?this.setSelection():this.FZb()}Xjk(){this.ATc()||(Jc.a.J(512496406,820,50,"OnBackendFindFailed"),this.FWg()?this.Jig():this.FZb())}Zwk(z,U,ka){Jc.a.J(512496405,820,50,"PerformBackendFind");this.A9b.findText(U,ka,
z.toString(),Object(v.a)(this,this.Yjk,"onBackendFindSucceeded"),Object(v.a)(this,this.Xjk,"onBackendFindFailed"));this.xd.state=4;return!0}FZb(){this.xd.state=this.xd.eWd?3:1;Jc.a.J(512496404,820,50,"End of Find: {0}",this.xd.state);this.clearSelection();this.CYa(0,"")}getShapeType(z){return z.Ny?ResourceStrings.L_TextBox:z.Wq?ResourceStrings.l_Chart:z.qd?ResourceStrings.L_Table:z.Pf?ResourceStrings.L_SmartArt:z.Tp?ResourceStrings.L_Media:z.wk?ResourceStrings.l_Picture:z.Sk?ResourceStrings.l_Placeholder:
ResourceStrings.l_ShapeObject}setSelection(){var z=this.xd.bPa,U=this.xd.iYb;if(this.Zb.Ba!==U)this.Eq.uV(Object(v.a)(this,this.kDb,"onActiveSlideDomChanged")),this.Zb.Ba=U;else{z=Hj.SelectionFactory.p2(z,this.xd.Zl.vfa,this.xd.Zl.B5);if(this.Nl.$Da(this.xd.gYb))this.ia.La(Qc.a.uhb,2,new un.a(!0)),this.Fa.Bf(Df.a.c2),this.xua.setSelection(z),this.CYa(this.xd.Zl.slideIndex%this.uc.Hj()+1,ResourceStrings.l_NotesPaneType);else{U=this.xd.gYb;const ka=this.xd.gYb.sg(this.Mb.Ma);if(ka)if(ka.Sp){let Ba;
(Ba=this.xd.Zl).eR=Ba.eR+1;this.xd.Zl.paragraphIndex=0;this.xd.Zl.vfa=0;this.xd.Zl.B5=0;ka.Ejd()}else this.N8j&&U.Pf?(this.Ee.Cbh(new Jl.a(U)),this.JGa.setSelection(z)):(this.Fa.Bf(tf.a.Bg),this.Mb.setSelection(z));this.CYa(this.xd.Zl.slideIndex%this.uc.Hj()+1,this.getShapeType(U))}Jc.a.J(512496402,820,50,"Find Text: {0}/{1}/{2}/({3},{4} )",this.xd.Zl.slideIndex,this.xd.Zl.eR,this.xd.Zl.paragraphIndex,this.xd.Zl.vfa,this.xd.Zl.B5);this.fVd()}}clearSelection(){var z=vn.b(this.PD);if(z=z?z.Gb:null){var U=
this.xd.RTj;U&&(U=Hj.SelectionFactory.Mg(U,0),z.setSelection(U))}else Jc.a.J(512496401,820,10,"Find Replace Text: Selection manager received as null when clearing selection")}CYa(z,U){const ka=new Sys.StringBuilder,Ba=new Sys.StringBuilder;let Ia=!1;z!=this.s3c?(this.s3c=z,this.Xke=1):this.Xke++;switch(this.xd.state){case 1:Ia=!0;ka.append(ResourceStrings.l_FindTextNotFound);break;case 3:ka.append(ResourceStrings.l_FindTextFindOver);break;case 6:Ia=!0;ka.append(ResourceStrings.l_FindTextFindAgain);
break;case 2:Ba.append(String.format(ResourceStrings.l_FindTextMessageWithCount,this.Xke,z,U));break;default:Jc.a.J(512496400,820,50,"Find Text: {0}",this.xd.state)}this.u5k(ka.toString(),Ia,Ba.toString());this.fVd()}Qql(z){z=this.eUk(z);32===z&&this.nTe(this.BF,this.iac);16===z&&(this.km.CYa(ResourceStrings.l_ReplaceTextErrorMessage,0),this.km.NTd(),this.km.D0f(!0))}eUk(z){return Vf.a.kWd("SingleReplaceAction",Qc.a.Z4,()=>{z||(z="",Jc.a.J(512496399,820,50,"Replacing with empty string"));var U=this.xd.bPa;
if(!U)return Jc.a.J(512496398,820,10,"ParagraphNode not set in findContext"),16;var ka=this.xd.Zl.vfa;const Ba=this.xd.Zl.B5;if(-1===ka||-1===Ba)return Jc.a.J(512496397,820,10,"Invalid start or end position of current text selection."),16;const Ia=this.zq.ke(15);Ia.gd(U);this.JW.replaceTextRange(Ji.a.createTextRange(U,ka,Ba),z,!0,!1,Qc.a.Z4);U=ka+z.length;ka=U!==this.xd.Zl.B5;this.xd.Zl.B5=U;Ia.dispose();ka&&this.setSelection();return 32})}fVd(){this.km.D0f(1===this.Dbb);this.I0f();this.km.KMi(3===
this.Dbb)}I0f(){this.xd.bPa?this.km.LMi(2===this.Dbb):this.km.NTd()}bZf(){this.km.JIi();this.km.NTd();this.km.LIi()}u5k(z,U,ka){2===this.Dbb?(this.km.Shd(ResourceStrings.l_ReplaceTextReplaced+". "+ka),this.km.xhd("")):(this.km.xhd(ka),this.km.Shd(""));this.km.rLe("");this.km.CYa(z,U?0:1)}CPi(z,U){const ka=Vf.a.Pl("FindNext");ka.Wa("CommandId",z.toString());ka.Wa("IsReadOnlyModeEnabled",this.km.lne.toString());try{U()}finally{ka.finish(!0)}}Akk(){I.a.Va(this.km.jYa)||this.CPi(Qc.a.find,()=>{Jc.a.J(512496396,
820,50,"Find Text Started");this.Dbb=1;this.nTe(this.km.jYa,this.km.matchCase);return 32})}Bkk(){this.km.rne?(Jc.a.J(512496394,820,50,"Replace Text Started"),this.Dbb=2,this.Qql(this.km.RGe)):(this.km.Xkl(),Jc.a.J(512496395,820,50,"Find dialog switched to replace dialog"),this.I0f())}Ckk(z){this.NSa()?Jc.a.J(512496393,820,10,"ReplaceAll Already in progress. ReplaceAllStartTime:{0}, Time diff:{1}",this.aBb,Date.now()-this.aBb):I.a.Va(this.km.jYa)||(Ai.a("FixReplaceAllTimeOutError")&&(this.ua.presentation.Qea=
-16),this.BF=this.km.jYa,this.qla=z?z:"",this.aBb=Date.now(),this.Dbb=3,this.LTd(),this.qTi(this.ua.Ba,this.BF,this.qla,this.iac),0<this.HPg&&(this.J3c=window.setTimeout(()=>{this.K1g()},this.HPg)),16===this.replaceAll()&&(this.$Ab=Date.now(),this.YPf(),this.K1g()))}replaceAll(){return Vf.a.kWd("ReplaceAllAction",Qc.a.Z4,()=>{Jc.a.J(512496392,820,50,"ReplaceAll Text Started");const z=this.ua.presentation;if(z){const U=this.Fb.ud(15);try{U.kc(z),this.acb.Yj(Object(v.a)(this,this.$db,"onPresentationPropertyChange")),
z.WFb=Object.assign(new ri,{NewStr:this.qla,OldStr:this.BF,ActiveSlideCid:this.ua.Ba.cid,ActiveSlideSid:this.ua.Ba.sid,MatchTxtInfo:Object.assign(new ql,{ShouldMatchCase:this.km.matchCase})})}finally{U&&U.dispose()}return 32}return 16})}qTi(z,U,ka,Ba){if(z){z=this.uc.kl(z.Bb);var Ia=this.Nb.Kc(z);z=z.gRa()||[];(Ia=Ia.Ab(27))&&z.push(Ia);if(z.length)for(Ia=0;Ia<=z.length-1;)this.yUi(z[Ia],U,ka,Ba),Ia++}else Jc.a.J(512496391,820,50,"slide must not be null.")}yUi(z,U,ka,Ba){if(this.Nl.$Da(z)||!z.fC)for(z=
el.a.createInstance(z);z.moveNext();){const Ia=z.currentNode;if(!nf.ParagraphReader.Vd(Ia))continue;let Ab=null;(Ab=this.qUi(Ia,U,Ba))&&Ab.characterData.replace(U,ka)}}qUi(z,U,ka){if(!nf.ParagraphReader.Vd(z))return Jc.a.J(512496390,820,50,"node must be ParagraphNode"),null;const Ba=z.ntb();return Ba.length?this.vUi(Ba,U,ka)?z:null:null}vUi(z,U,ka){let Ba=z,Ia=U;ka||(Ba=z.toLowerCase(),Ia=U.toLowerCase());return-1!==Ba.indexOf(Ia,0)?!0:!1}$db(z,U){if(!this.NSa())Jc.a.J(512496389,820,50,"ReplaceAll Not Iniitated");
else if(U.property===db.a.NGe){this.YPf();z=Object(A.a)(526,U.node);if(-1!==z.Qea){var ka=2;if(0===z.Qea){U=ResourceStrings.l_FindTextNotFound;var Ba=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchMessage;ka=0;var Ia=ResourceStrings.l_ReplaceAllCalloutNotificationNoMatchTitle}else 1===z.Qea?(U=String.format(ResourceStrings.l_ReplaceAllSuccessSingular,z.Qea,this.BF,this.qla),Ba=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessageSingular,z.Qea,this.BF,this.qla)):(U=String.format(ResourceStrings.l_ReplaceAllSuccessPlural,
z.Qea,this.BF,this.qla),Ba=String.format(ResourceStrings.l_ReplaceAllCalloutNotificationMessagePlural,z.Qea,this.BF,this.qla)),Ia=ResourceStrings.l_ReplaceAllCalloutNotificationSuccessTitle}else Ia=ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,U=Ba=ResourceStrings.l_ReplaceAllErrorMessage,ka=0,Jc.a.J(512496388,820,10,"Invalid ReplaceAllTextCount");this.$Ab=Date.now();Jc.a.J(512496387,820,50,"Time taken for Replace All operation in ms: {0}",this.$Ab-this.aBb);this.C0f(U,ka);this.acb.tm(Object(v.a)(this,
this.$db,"onPresentationPropertyChange"));this.km.ll()&&this.INe(Ia,Ba,10);z.Qea=-16}}NSa(){return this.aBb>this.$Ab}LTd(){var z=String.format(ResourceStrings.l_ReplaceAllInProgress,this.BF);this.km.CYa(z,3);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceAllTextReplaceAll,this.BF);this.km.rLe(z);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,ResourceStrings.l_ReplaceTextReplace,this.BF);this.km.Shd(z);z=String.format(ResourceStrings.l_ReplaceAllInProgressDialogButtonsAriaLabel,
ResourceStrings.l_FindTextFindNext,this.BF);this.km.xhd(z);this.bZf()}C0f(z,U){this.km.CYa(z,U);this.km.rLe(z);this.km.Shd("");this.km.xhd("");this.fVd()}Xcl(){if(this.NSa()){var z=String.format(ResourceStrings.l_ReplaceAllInProgress,this.BF);this.INe(ResourceStrings.l_ReplaceAllCalloutNotificationProgressTitle,z,1024)}}INe(z,U,ka){this.sQ?(this.sQ.RTd(),Jc.a.J(512496385,820,50,"Callout notification called for Replace All operation"),z=Object.assign(new Ci,{title:z,message:U,rSe:ka}),z=this.sQ.Ycl(z),
z.sSa&&Jc.a.J(512496384,820,10,"Error in callout notification: Error:{0}",z.message)):Jc.a.J(512496386,820,10,"Find Replace Text: m_calloutNotification adapter is null.")}K1g(){let z=!1;this.NSa()&&(z=!0,this.$Ab=Date.now());Jc.a.J(512496355,820,10,"Error returned in replace all operation. ReplaceAll Timeout: {0}, Time taken in ms: {1}",z,this.$Ab-this.aBb);this.C0f(ResourceStrings.l_ReplaceAllErrorMessage,0);this.acb.tm(Object(v.a)(this,this.$db,"onPresentationPropertyChange"));this.km.ll()&&this.INe(ResourceStrings.l_ReplaceAllCalloutNotificationErrorTitle,
ResourceStrings.l_ReplaceAllErrorMessage,10);this.ua.presentation.Qea=-16}YPf(){-1!==this.J3c&&(window.clearTimeout(this.J3c),this.J3c=-1)}}Aa.Xte=1024;Object(h.a)(Aa,"FindReplaceTextHandler",null,[497]);class wn{constructor(z){this.hNg=this.MRg=null;this.cAb=!1;this.g4=z}findText(z,U,ka,Ba,Ia){this.hNg=z;this.cAb=U;this.MRg=ka;this.g4.fF(Ba,Ia,null)}get djl(){return this.MRg}get matchCase(){return this.cAb}get M6c(){return this.hNg}}Object(h.a)(wn,"FindTextManager",null,[495]);var Ij=d(378),Ig=d(107);
class vf extends Ig.a{constructor(){super();this.MatchText=null;this.MatchCase=!1;this.SlideID=null}Ok(){return 54}static NPd(z,U,ka){const Ba=new vf;Ba.SlideID=ka;Ba.MatchText=z;Ba.MatchCase=U;return Ba}}Object(h.a)(vf,"FindTextRequest",Ig.a,[]);class xn extends Ij.a{constructor(z,U,ka,Ba){super();this.mFa=this.QGa=null;this.QN=this.D3=!1;this.D8b=null;this.Md=ka;this.bYc=!1;this.A9b=U;this.Xa=Ba;this.Bm=z;this.enabled=2;this.Bm.register(this)}fF(z,U){this.bYc=!0;this.QGa=z;this.mFa=U;this.Bm.s$()}forceOutbound(){}fja(){return this.bYc&&
!this.D3}$P(){return!1}GRa(){return this.Od&&2===this.Od.status?!0:this.fja()}$Fb(){if(1===this._state)this.D8b=this.Xa.podSessionId,this.Od.oH=vf.NPd(this.A9b.value.M6c,this.A9b.value.matchCase,this.A9b.value.djl),this.Od.status=1,this._state=3;else if(3===this._state&&this.Od&&2===this.Od.status){if(2!==this.Od.statusCode)this.jH();else{if(!this.Od.Gr||1!==this.Od.Gr.length){this.jH();return}const z=this.Od.Gr[0];0===z.StatusCode?(this.e0(),this.QGa&&this.QGa(z.SlideID)):(this.jH(z),124===z.StatusCode&&
this.Md.es(z.ServerError,this.D8b))}this.D8b=null}}jH(z=null){this.bYc=!1;this._state=1;Jc.a.J(21849603,824,15,"FindTextRequest failed. OperationResult:{0}, RequestStatus:{1}, HttpStatusCode:{2}, IsLastReplicationFailed:{3}, PodSessionId:{4}",z?z.StatusCode:-1,this.Od?Mc.a[this.Od.statusCode]:"NULL",this.Od?this.Od.gv:-1,this.QN,this.D8b||"NULL");this.QN=!0;this.mFa&&this.mFa(-1,-1)}e0(){this.bYc=!1;this._state=1;Jc.a.J(25012056,818,this.QN?15:50,"FindTextRequest succeeded. IsLastReplicationFailed:{0}, PodSessionId:{1}",
this.QN,this.D8b||"NULL");this.QN=!1}dispose(){this.D3||(1===this._state&&this.Bm.unregister(this),this.D3=!0)}}Object(h.a)(xn,"FindTextReplicator",Ij.a,[106]);class sc{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FindText"}Wb(z){this.K=z;this.K.register(495,"PowerPointWebEditor.IFindTextManager").ma().na(()=>new wn(new xn(this.K.resolve("PowerPointWebEditor.IPPTReplicationScheduler"),this.K.le("PowerPointWebEditor.IFindTextManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"))));this.K.register(496,"PowerPointWebEditor.IFindReplaceTextDialogFactory").ma().na(()=>new pl(this.K.le("PowerPointWebEditor.IFocusManager")));const U=new pj.a(this.K.resolve("Common.App.CalloutNotification.ICalloutNotification"),this.K.resolve("PowerPointWebEditor.IRibbonPane").xa);this.K.register(497,"PowerPointWebEditor.IFindReplaceTextHandler").ma().na(()=>new Aa(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFindTextManager"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.ICharacterPropertiesEditor"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.le("PowerPointWebEditor.IFindReplaceTextDialogFactory"),this.K.resolve("Box4.Graph.IGraphInstance").vd(7),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,
this.K.resolve("Common.IAppSettingsManager").Cc("ReplaceAllClientTimeoutMS",0),U))}init(){let z=new Qh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IFindReplaceTextHandler"),this.K.resolve("PowerPointWebEditor.IPresentationReader"));z.ub();z.xe()}dispose(){}static main(){ua.a.instance.Bc(Bb.a(new sc,0))}}Object(h.a)(sc,"PPTWebEditorFindTextPackage",null,[2,3]);class Xf{constructor(z){this.Ha=z}get MJd(){return"PowerPoint"}get jNf(){return"c551d75c-10b1-4de2-83cc-cce22d7c06bd"}get version(){return 1}get currentVersion(){return 0}get YGj(){return this.Ha.powerPointEditorFirstRunExperienceDataStoreIsEnabled}get cxb(){return this.Ha.powerPointEditorFirstRunExperienceUIIsEnabled}get aAg(){return this.Ha.powerPointEditorFirstRunExperienceTestIsEnabled}get yVi(){return"Microsoft.Office.Server.Powerpoint.Web.IWacPptEditorFirstRunExperienceUISettings"}get gVg(){return 24}get Lih(){return 4E3}get gkc(){return this.Ha.roamingServiceHandlerWebServiceBase||
""}}Object(h.a)(Xf,"FirstRunExperienceLauncherSettings",null,[525]);class Nc{constructor(z){this.OIg=z}Hdl(z){this.OIg&&this.OIg.QNe(z)}}Object(h.a)(Nc,"FirstRunExperienceManager",null,[494]);class Jf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.FirstRunExperience"}Wb(z){if(!z)throw Error.argumentNull("container");this.K=z;this.K.register(494,"PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager").ma().na(()=>new Nc(this.K.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher")))}init(){this.K.resolve("Common.IAppSettingsManager").ff(()=>
{this.QNe()})}dispose(){}QNe(){var z=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(!z)throw Error.argumentNull("appSettings");const U=this.K.resolve("PowerPointWebEditor.FirstRunExperience.IFirstRunExperienceManager");U&&(z=new Xf(z),U.Hdl(z))}static main(){ua.a.instance.Bc(new Jf)}}Object(h.a)(Jf,"PPTWebEditorFirstRunExperiencePackage",null,[2,3]);var fl=d(177),Xj=d(386);class ff{constructor(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=
this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}}Object(h.a)(ff,"CatchUpConfiguration",null,[]);class rl{constructor(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=
null}}Object(h.a)(rl,"SharedControllerFactoryParameters",null,[]);const Jj=(z,U)=>{if(!z)throw Error.create(String.format("Argument {0} is null.",U));},ba=z=>{if(!z.navigationId)return Jc.a.J(524895832,3012,10,"CreateNavigationData: navigation id is missing."),null;try{const U=window.atob(z.navigationId);return U&&""!==U?{["NavigationId"]:U}:null}catch(U){return Jc.a.J(524145986,3012,10,"CreateNavigationData: decoding navigation id failed.",U),null}};class Zl{constructor(z){Jj(z,"ActivityContentManager.IActionManagerExtended");
this.ia=z}doesContentExist(z){if(!z)return Jc.a.J(524895831,3012,10,"DoesContentExist: activity is null."),!1;switch(z.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:return(z=ba(z))?32===this.ia.La(qa.a.yrb,2,z):!1;default:return!1}}}Object(h.a)(Zl,"ActivityContentManager",null,[490]);class bg{constructor(z){this.kn=z}shouldShowEmptyExperienceButton(){return L.AFrameworkApplication.kWc()}getExplanationText(){return""}getCommandName(){return ResourceStrings.L_FileHistory}onButtonClick(){this.kn.La(qa.a.MOe,
2,null)}onInviteOthersButtonClick(){this.kn.La(qa.a.fCa,2,null)}}Object(h.a)(bg,"EmptyCatchUpBehaviorManager",null,[493]);class vi{constructor(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}}Object(h.a)(vi,"Person",null,[]);var Vg=d(639),Di=d(225),Ei=d(166);class Li extends Ig.a{constructor(z){super();this.StartTime=null;this.StartTime=z}Ok(){return 93}}Object(h.a)(Li,"GetFileRevisionHistoryRequest",Ig.a,[]);class Kl{constructor(z,U,ka){this.ProviderId=
this.UserId=this.UserName=null;this.UserName=z;this.UserId=U;this.ProviderId=ka}}Object(h.a)(Kl,"Author",null,[]);const gl=(z,U)=>z&&U?z.providerIdField===U.ProviderId?z.userIdField===U.UserId:z.userNameField===U.UserName:!1;var lm=d(240);class Gm{constructor(z,U,ka){this.R_c=this.y$a=null;this.pi=z;this.N$a=ka;this.N$a.p6h(Object(v.a)(this,this.H_g,"onFileRevisionHistoryReady"));U.ff(()=>{this.y$a=new Kl(U.Ga("UserName"),U.Ga("387"),U.Ga("388"))})}dispose(){this.N$a.PRk(Object(v.a)(this,this.H_g,
"onFileRevisionHistoryReady"));this.y$a=null}u5i(z,U,ka){z&&ka&&(this.R_c=ka,z=new lm.a(new Li(z),Ba=>{this.IDg(Ba,U);this.i$c(Ba)},Ba=>{this.IDg(Ba,U);return this.beb(Ba)}),this.pi.Cb(z))}H_g(z,U){z=null;const ka=[];I.a.Va(U.DKc)||(({DKc:U}=this.Csl(U.DKc)).returnValue?Ei.b(U.fileRevisionEntriesField,Ba=>this.gMj(Ba.changesDataField),Ba=>{ka.push(Ba.changesDataField)}):z="ErrorGetFileRevisionHistoryParseJsonException");this.uxe(ka,z)}i$c(z){let U=null;z.ServerError&&0!==z.ServerError.Code?U=Di.a[z.ServerError.Code]:
0!==z.StatusCode&&(U=Vg.a[z.StatusCode]);U&&this.uxe(null,U)}beb(z){Jc.a.J(512262998,811,15,"OnGetFileRevisionAuthorNamesFailed() - "+z.toString());this.uxe(null,"ErrorGetFileRevisionHistoryFailed");return!0}uxe(z,U){this.R_c&&(z=this.xZi(z),this.R_c(z,U),this.R_c=null)}Csl(z){let U;U=null;try{U=Sys.Serialization.JavaScriptSerializer.deserialize(z)}catch(ka){Jc.a.J(512262997,811,10,"TryParseFileRevisionList() - Exception: "+ka)}return{returnValue:!!U,DKc:U}}gMj(z){return!gl(z,this.y$a)}IDg(z,U){z.Gwa&&
U.Om("GetAuthorNamesRequestInvokedTime",z.Gwa);U.Wa("GetAuthorNamesRequestCorrelationId",z.Jh)}xZi(z){if(!z)return[];const U=Array(z.length);for(let Ba=0;Ba<z.length;Ba++){var ka=z[Ba];ka=Object.assign(new vi,{displayName:ka.userNameField,id:ka.userIdField,provider:ka.providerIdField});U[Ba]=ka}return U}}Object(h.a)(Gm,"FileRevisionHistoryService",null,[533,106]);class Gh{constructor(z,U){Jj(z,"FlyoutFocus.IF6Manager");Jj(U,"FlyoutFocus.IFocusManagerHelper");this.lh=z;this.RD=U}initialize(){this.RD.T7(tf.a.Vpb,
tf.a.jj,null,Object(v.a)(this,this.XVi,"focusOnFirstFlyoutItem"),()=>{},!0)}enableF6Focus(){this.lh.lK(tf.a.Vpb)}disableF6Focus(){this.lh.zo(tf.a.Vpb)}XVi(){const z=document.getElementById("flyoutItem0");z&&(Jc.a.J(570730465,3012,50,"Focused on the catch-up flyout via ctrl+F6"),z.focus())}}Object(h.a)(Gh,"FlyoutFocus",null,[531]);class bf{constructor(z,U,ka,Ba){this.FYc=null;this.GFg=this.uJg=this.yzb=this.P0c=!1;Jj(U,"FlyoutRibbonButton.IActionManagerExtended");Jj(ka,"FlyoutRibbonButton.IFocusManager");
Jj(Ba,"FlyoutRibbonButton.FloodgateEventLogger");this.Ob=z;this.ia=U;this.Fa=ka;this.j3j=Ba;this.l3j=new Date}initialize(){L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Ai.a("DelayRegisterCatchUpActions")||this.ub()}registerButtonClickedEvent(z){this.FYc&&Jc.a.J(571532947,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.FYc=z.buttonClickedCallback}onFlyoutInitialized(){this.P0c&&Jc.a.J(571532948,
3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");const z=(new Date).getTime()-this.l3j.getTime();Jc.a.J(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",z);this.P0c=!0;ce.c(qa.a.Mli,!0,ce.e,0,0,z);L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Ai.a("DelayRegisterCatchUpActions")&&this.ub();this.Ob&&this.Ob.updateCommandUI()}logFlightTriggers(){}onFlyoutVisibilityChanged(z){this.yzb!==z.flyoutIsVisible&&
(this.yzb=z.flyoutIsVisible,this.Ob&&this.Ob.updateCommandUI(!0),this.yzb&&this.GFg?this.Fa.Bf(tf.a.Vpb):this.yzb||this.Fa.Bf(tf.a.jj),this.yzb||this.j3j.FXj())}ub(){this.ia.ya(qa.a.Qol,Ub.a.frame,Object(v.a)(this,this.Ark,"onToggleCatchUpFlyout"));this.ia.pa(qa.a.UFk,Ub.a.frame,Object(v.a)(this,this.mpk,"onQueryToggleCatchUpFlyout"),96)}Ark(z,U,ka){if(1===ka)return this.P0c?(this.uJg||(this.uJg=!0,Jc.a.J(588129368,3012,50,"Catch Up Button Is Enabled.")),32):8;if(!this.FYc)return 8;this.GFg=!0;this.FYc();
return 32}mpk(z,U,ka,Ba,Ia){Ia[jg.a.Visible]=!0;Ia[jg.a.On]=this.yzb&&this.P0c;return 32}}Object(h.a)(bf,"FlyoutRibbonButton",null,[530]);const Ll=z=>{window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+z)};class Hm{constructor(z,U,ka,Ba,Ia,Ab){Jj(z,"PowerPointActivityNavigationManager.IActionManagerExtended");Jj(U,"PowerPointActivityNavigationManager.IPresentationReader");Jj(ka,"PowerPointActivityNavigationManager.IThumbnailNavigationPaneView");
Jj(Ba,"PowerPointActivityNavigationManager.IRibbonUser");Jj(Ab,"PowerPointActivityNavigationManager.IActivityContentManager");this.ia=z;this.uc=U;this.Je=ka;this.ZD=Ba;this.Q9j=Ia;this.q0j=Ab}navigateToActivity(z){if(z.fromSummaryString)return this.y4k(),this.clj(),this.$kj(),this.adl(),Promise.resolve(1);z=z.activity;if(!z)return Jc.a.J(524145984,3012,10,"NavigateToActivity: activity is null."),Promise.resolve(8);if(!z.navigationId)return Jc.a.J(524145985,3012,10,"NavigateToActivity: navigation id is null."),
Promise.resolve(4);if(!this.q0j.doesContentExist(z))return Promise.resolve(2);switch(z.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:z=ba(z);if(!z)return Promise.resolve(5);z=this.ia.La(qa.a.IWb,2,z);return Promise.resolve(32===z?1:6);default:return Promise.resolve(7)}}y4k(){const z=this.uc.Gn;z?z.bCa=!0:Jc.a.J(570831450,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}clj(){this.ZD.selectRibbonTabById(this.Q9j)}$kj(){var z=this.uc.Gn;if(z&&z.slides){var U=
null;for(const ka of z.slides)if(ka&&(z=this.uc.kl(ka.Bb))&&z.isUnread){U=z;break}U?(this.Je.yhd(),this.Je.U9(U.we)):Jc.a.J(570831452,3012,15,"PowerPointActivityNavigationManager: Could not find any unread slides.")}else Jc.a.J(570831451,3012,10,"PowerPointActivityNavigationManager: IPageManifestNode is null.")}adl(){this.ia.La(Qc.a.pIb,2,{InvokeSource:1,ShowRevisionTrackingStatus:3})}}Object(h.a)(Hm,"PowerPointActivityNavigationManager",null,[491]);class re{constructor(){this.collectionId=this.type=
this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}}Object(h.a)(re,"ActivityFeedItem",null,[]);class M{constructor(){this.activityFeedItems=null}}Object(h.a)(M,"ActivityFeedPayload",null,[]);class ca{constructor(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}}Object(h.a)(ca,"ActivityRequestPayload",null,[]);var Na=d(527);class zb{constructor(){this.activityFeedItemId=this.activityId=
null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}}Object(h.a)(zb,"Activity",null,[]);class $b{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb){this.jg=this.foe=null;Jj(z,"PowerPointActivityRequestManager.IJsonpHelperManager");Jj(U,"PowerPointActivityRequestManager.PowerPointWaterlineUpdater");Jj(ka,"PowerPointActivityRequestManager.IFileRevisionHistoryService");Jj(Ba,"PowerPointActivityRequestManager.IAppSettingsManager");Jj(Ia,
"PowerPointActivityRequestManager.IApplicationSettings");Jj(Ab,"PowerPointActivityRequestManager.IActionManagerExtended");Jj(Ob,"PowerPointActivityRequestManager.ICatchUpRequestHandler");this.JFa=z;this.ack=U;this.d3j=ka;this.fc=Ba;this.ia=Ab;this.MYc=Ob;this.MQg=Yb}requestWYWAActivities(){return new Promise((z,U)=>{this.jg=Vf.a.Pl("ShowWYWACallout",2);this.ack.oXk(ka=>{ka=this.DDk(ka);$b.isExpectedError(ka)?z($b.EHc):ka?(Jc.a.J(572111054,3012,10,"OnReadRoamingSucceeded() - Error: {0}",ka),U(ka)):
this.d3j.u5i(this.foe,this.jg,(Ba,Ia)=>{Ia&&(Jc.a.J(572111055,3012,10,"GetFileRevisionAuthorNamesAsync() - Error: {0}",Ia),U(Ia));z($b.gwi(Ba))})},ka=>{const Ba=!!ka.data&&$b.$Hj(ka.data.Le);ka=this.JFa.Nia(ka);Jc.a.J(572111056,3012,Ba?50:10,"OnReadRoamingFailed() - Error: {0}",ka);Ba?z($b.EHc):U(ka)})})}requestActivities(){return Promise.resolve($b.EHc)}requestRelevantActivities(){return Promise.resolve($b.EHc)}requestActivityFeed(){return this.MYc?Na.b(this.MYc.getActivityFeed(this.MQg)).then(z=>
Object.assign(new M,{activityFeedItems:$b.gql(z)})):Promise.resolve(Object.assign(new M,{activityFeedItems:[]}))}updateActivityState(z){return this.MYc?Na.b(this.MYc.Zul(this.MQg,z.itemIds,z.activityStatesToSet||0,z.activityStatesToReset||0,z.resetUnseenCount)):Promise.resolve(!1)}DDk(z){z=z.data.Sd;if(!z)return"ErrorReadRoamingEmptyResponseBody";let U;try{U=JSON.parse(z)}catch(ka){return ka.toString()}z=null;if(!U.Error){if(!U.Timestamp)throw Error.create("response.Error and response.Timestamp are empty");
z=U.Timestamp}this.foe=this.fzl(z);Jc.a.J(561588038,3012,100,"Timestamp for retrieving activities: "+this.foe);return U.Error}fzl(z){const U={};var ka=this.fc.Cc("AppWaterlineOverrideTimestampValue",0);return ka?(z=new Date(1E3*ka),U.timestamp=z,this.ia.La(Qc.a.vOe,2,U),z.format("yyyy-MM-ddTHH:mm:ssZ")):z?(ka=this.fc.Cc("AppWaterlineOverrideDaysValue",0))?(z=new Date(+new Date(z)-+new Date(864E5*ka)),U.timestamp=z,this.ia.La(Qc.a.vOe,2,U),z.format("yyyy-MM-ddTHH:mm:ssZ")):z:null}static gwi(z){return z?
Object.assign(new ca,{actors:z}):null}static gql(z){const U=[];if(!z)return U;for(const ka of z)U.push(Object.assign(new re,{id:ka.id,type:ka.type,collectionId:ka.collectionId,activityState:ka.activityState,activityFeedItemPayload:ka.activityFeedItemPayload,timestamp:ka.timestamp}));return U}static isExpectedError(z){return"ErrorDocNotInRoamingList"===z||"ErrorLastViewedDocListIsEmpty"===z}static $Hj(z){return 403===z}}$b.EHc=Object.assign(new ca,{activities:[],actors:[],hasMore:!1,highWaterline:"",
lowWaterline:"",wywaWaterline:""});Object.assign(new ca,{activities:[Object.assign(new zb,{activityId:"activityId1",type:3,actors:[Object.assign(new vi,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),Object.assign(new zb,{activityId:"activityId2",type:4,actors:[Object.assign(new vi,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,
relevancy:2,navigationId:"navigationId2"})]});Object.assign(new M,{activityFeedItems:[Object.assign(new re,{id:"FeedItemId1",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"1","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a1","navigationId":"n1","commentThreadId":"1","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"kat.larsson@microsoft.com","userPrincipalName":"klarsson@microsoft.com","name":"Kat Larsson","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()}),Object.assign(new re,{id:"FeedItemId2",type:"UserAtMentioned",collectionId:"CollectionId1",activityState:0,activityFeedItemPayload:'{"isReply":false,"id":"2","timestamp":"2021-10-05T14:15:25.1663372Z","data":{"activityId":"a2","navigationId":"n2","commentThreadId":"2","commentThreadIsTask":false},"fileDetails":{"documentUrl":"url","linkUrl":"url","siteUrl":"url","listItemUniqueId":"u1","sourceRelativeUrl":"url","sourceFileName":"file.pptx","sourceFileExtension":"pptx","hostItemId":"SPO_ID"},"actor":{"id":null,"provider":null,"email":"frankie.smith@microsoft.com","userPrincipalName":"fsmith@microsoft.com","name":"Frankie Smith","roles":"Creator","pictureUrl":null},"userRoles":"Mentioned"}',
timestamp:(new Date).toISOString()})]});Object(h.a)($b,"PowerPointActivityRequestManager",null,[492]);var Tc=d(259);class hd{constructor(z,U,ka,Ba,Ia,Ab){this.Zab=!1;this.LMg=null;this.Mc=z;this.ew=U;this.V9j=ka;this.JFa=Ba;this.yb=Ia;this.rBb=Ab}initialize(){this.Mc&&(this.Mc.LNa(Object(v.a)(this,this.nDb,"onBeforeSessionEnd")),this.Mc.IB(Object(v.a)(this,this.ML,"onSessionClosed")));this.n_k()}oXk(z,U){const ka=this.$eg("getPPTDocLastViewedTimestamp");this.ux(ka,1,z,U)}nDb(){this.IGh()}ML(){this.Zab=
!0}n_k(){if(this.yb){var z=new ad.a(3,2,3E4,Object(v.a)(this,this.oVk,"requestWriteWaterline"),90,"29");this.yb.Cb(z)}}oVk(){!this.Zab&&3E4<+Vf.a.Q6b-+this.LMg&&(this.IGh(),this.LMg=Vf.a.Q6b)}IGh(){const z=this.$eg("savePPTDocLastViewedTimestamp");this.rBb.ka("SendBeaconOnRoamingRequestsIsEnabled")?this.ew.OIa(z,""):this.ux(z,2,Object(v.a)(this,this.jsk,"onWriteWaterlineSucceeded"),Object(v.a)(this,this.isk,"onWriteWaterlineFailed"))}jsk(z){let U=null;try{const ka=z.data.Sd;U=ka?JSON.parse(ka).Error:
"ErrorWriteRoamingEmptyResponseBody"}catch(ka){U="ErrorWriteRoamingParseJsonResponseException",Jc.a.J(572555921,3012,10,"OnWriteRoamingSucceeded() - Exception: "+ka)}finally{U&&this.YDg(U)}Jc.a.J(572555922,3012,50,"OnWriteRoamingSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+z.data.Wu-+z.data.aI,+z.data.Kt-+z.data.aI)}isk(z){this.YDg("ErrorReadRoamingFailed");Jc.a.J(572555923,3012,10,"OnWriteRoamingFailed() - Failure message: {0}",this.JFa.Nia(z))}$eg(z){return this.V9j+String.format("RoamingServiceHandler.ashx?action={0}&{1}",
z,L.AFrameworkApplication.hh)}ux(z,U,ka,Ba){const Ia={};Ia["X-StatelessPopsAffinityRoutingEnabled"]=this.rBb.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.ew.yj(z,U,null,Ia,!1,1,ka,Ba,null,void 0,void 0,void 0,void 0,Tc.a("5"))}YDg(z){Jc.a.J(572555924,811,50,z)}}Object(h.a)(hd,"PowerPointWaterlineUpdater",null,[]);class Hd{get name(){return"PowerPointWebEditor.Activity"}get L9d(){return L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",
!1)}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(v.a)(this,this.wGi,"delayedInit"))}Wb(z){this.K=z}dispose(){this.K=this.LYc=null}Y$k(z){return!z||z.ka("IsAnonymousUser")?!1:z.ka("PPTCatchUpFlyoutIsEnabled")}wGi(){const z=this.K.resolve("Common.IAppSettingsManager");this.Y$k(z)&&(Ll("Begin"),this.LKi(),this.lYj())}LKi(){fl.a.get_instance().gk(7,()=>{Ll("ScriptDownload");Wl.a(this.K)("catchUpActivity").catch(()=>{Jc.a.J(512262995,3012,10,"Failed to download catch-up script")}).then(()=>
this.Yxj()).catch(()=>{Jc.a.J(512262994,3012,10,"Failed to initialize shared catch-up code")})})}lYj(){Jc.a.J(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.L9d&&Jc.a.J(526718752,3012,50,"ActivityFeedData is enabled")}Yxj(){const z=new Gm(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler")),U=this.K.resolve("Common.AFrameworkApplication");this.K.register(hd,
"PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").ma().na(()=>new hd(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),L.AFrameworkApplication.Ge,this.K.resolve("PowerPointWebEditor.IApplicationSettings").roamingServiceHandlerWebServiceBase,this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));this.K.register(490,"Common.App.CatchUpActivity.IActivityContentManager").ma().na(()=>new Zl(this.K.resolve("Common.IActionManagerExtended"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(491,"Common.App.CatchUpActivity.IActivityNavigationManager").ma().na(()=>new Hm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),Dd.a.IJk,this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager")));let ka=null;this.K.resolve("PowerPointWebEditor.IApplicationSettings").tg&&
(ka=this.K.resolve("Common.IAppSettingsManager").Ga("368")+"p");this.K.register(492,"Common.App.CatchUpActivity.IActivityRequestManager").ma().na(()=>new $b(this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater"),z,this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler"),
ka));this.K.register(bf,"PowerPointWebEditor.Activity.FlyoutRibbonButton").as("Common.App.CatchUpActivity.IFlyoutRibbonButton").ma().na(()=>new bf(U.kr,L.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.App.CatchUpActivity.FloodgateEventLogger")));this.K.register(Gh,"PowerPointWebEditor.Activity.FlyoutFocus").as("Common.App.CatchUpActivity.IFlyoutFocus").ma().na(()=>new Gh(this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper")));
this.K.register(493,"Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager").ma().na(()=>new bg(this.K.resolve("Common.IActionManagerExtended")));this.LYc=catchUpActivity.FactoryGlobal.getPowerPointCatchUpAppInstance(Object.assign(new rl,{activityContentManager:this.K.resolve("Common.App.CatchUpActivity.IActivityContentManager"),activityNavigationManager:this.K.resolve("Common.App.CatchUpActivity.IActivityNavigationManager"),activityRequestManager:this.K.resolve("Common.App.CatchUpActivity.IActivityRequestManager"),
dataCulture:L.AFrameworkApplication.dataCulture,emptyCatchUpBehaviorManager:this.L9d?this.K.resolve("Common.App.CatchUpActivity.IEmptyCatchUpBehaviorManager"):null,flyoutFocus:this.K.resolve("Common.App.CatchUpActivity.IFlyoutFocus"),flyoutRibbonButton:this.K.resolve("Common.App.CatchUpActivity.IFlyoutRibbonButton"),uiCulture:L.AFrameworkApplication.uiCulture,ulsLogger:new Xj.a}));if(!this.LYc)return Promise.reject("Failure to create CatchUpApp");this.K.resolve("PowerPointWebEditor.Activity.FlyoutRibbonButton").initialize();
this.K.resolve("PowerPointWebEditor.Activity.FlyoutFocus").initialize();this.LYc.setWebpackPublicPath(L.AFrameworkApplication.nfa);Ll("InitializeCatchUpApp");return this.LYc.initialize(Object.assign(new ff,{activityFeedDataEnabled:this.L9d,featuredActivityGroupsEnabled:!1,summaryStringEnabled:!0})).then(()=>{this.K.resolve("PowerPointWebEditor.Activity.PowerPointWaterlineUpdater").initialize()})}static main(){ua.a.instance.Bc(Bb.a(new Hd,0))}}Object(h.a)(Hd,"PPTWebEditorActivityPackage",null,[2,3]);
var le=d(717);class ge extends Sys.EventArgs{constructor(z,U){super();this.shape=z;this.bCa=U}}Object(h.a)(ge,"ShowHideStateChangedEventArgs",Sys.EventArgs,[]);class Zd{constructor(z,U,ka,Ba,Ia,Ab,Ob){this.jg=null;this.ia=z;this.ua=U;this.IQ=ka;this.b4c=Ba;this.Qb=Ia;this.Lc=Ab;this.mcb=Ob}dispose(){this.jg&&(this.jg=null)}xe(){}ub(){this.ia.ya(Qc.a.TTg,Fh.a.application,Object(v.a)(this,this.Ioj,"handleMarkAsRead"));this.ia.ya(Qc.a.pIb,Fh.a.application,Object(v.a)(this,this.wrj,"handleShowHideChanges"));
this.ia.pa(Qc.a.W$g,xc.a.application,Object(v.a)(this,this.hqj,"handleQueryShowHideChanges"),96);this.ia.pa(Qc.a.vOe,Fh.a.application,Object(v.a)(this,this.xrj,"handleShowRevisionTrackingWithUrlOverrides"),96)}Ioj(z,U,ka,Ba,Ia){if(1===ka)return this.Qb.Hj()?32:8;z=new Date;if(!Ia)throw Error.argumentNull("actionData is null");if(Ia.SlideNode){if(Ia=Object(A.a)(120,Ia.SlideNode))Jc.a.J(509654912,804,50,String.format("HandleMarkAsRead: Mark slide {0} as read",Ia.slideIndex+1)),this.IQ.F6b?this.IQ.H6c(Ia,
!0):(Ia.xW=z,this.IQ.hFe(Ia))}else this.Nte(z);return 32}Nte(z){const U=this.ua.presentation;if(!U)throw Error.argumentNull("Presentation is null");this.jg=Vf.a.Pl("MarkActivitiesAsRead",1);Jc.a.J(509654883,804,50,"MarkAllSlidesAsRead: User marks slides as read via Ribbon button");this.IQ.F6b?this.IQ.Nte():(Ei.b(U.slides||[],null,ka=>{if(ka=Object(A.a)(120,ka))ka.xW=z}),this.IQ.adh())}wrj(z,U,ka,Ba,Ia){if(1===ka)return this.Qb.Hj()?32:8;const Ab=this.Qb.Gn;z=this.ua.Ba;if(!(Ab&&z&&z.isConnected&&
Ia))return 16;ka=U=!1;switch(Ia.ShowRevisionTrackingStatus){case 0:ka=U=!1;break;case 2:U=!0;ka=!1;break;case 3:ka=U=!0;break;case 1:U=Ab.bCa&&!this.IQ.FOd?!0:!Ab.bCa;ka=!0;break;default:return 8}if(this.IQ.FOd&&!ka)return 32;Ia=Ia.InvokeSource;Ab.bCa=U;this.IQ.FOd=U&&ka;ka&&this.mcb.PZj(Ia,U);Ia=z.jl();Ei.b(Ia,null,Ob=>{this.b4c.HIk(new ge(Ob,Ab.bCa))});this.Lc.mz(new km.a(1));return 32}hqj(z,U,ka,Ba,Ia){z=this.Qb.Gn;if(!z)return 16;Ia.Nf(z.bCa);return 32}xrj(z,U,ka,Ba,Ia){z=this.ua.presentation;
if(!Ia||!z||!z.slides)return 8;Ia=Ia.timestamp;if(!Ia)return 8;for(const Ab of z.slides)Object(A.a)(120,Ab).xW=Ia;this.IQ.iFe(z.slides);return 32}}Object(h.a)(Zd,"RevisionTrackingActor",null,[229,106]);class Oe{constructor(z){this.backgroundColor=this.foregroundColor=null;z&&z.isInHighContrastMode&&z.highContrastColors?(this.foregroundColor=z.highContrastColors.foregroundTextColor||"#006BFF",this.backgroundColor=z.highContrastColors.backgroundColor||"#006BFF"):this.backgroundColor=this.foregroundColor=
"#006BFF"}}Object(h.a)(Oe,"RevisionTrackingColorProvider",null,[]);class tc{constructor(){this.va=new qk.a}LIk(z){this.va.raiseEvent("SlideUSC",z)}WId(z){this.va.addHandler("SlideUSC",z)}wGe(z){this.va.removeHandler("SlideUSC",z)}nIk(z){this.va.raiseEvent("ShapeUSC",z)}M7h(z){this.va.addHandler("ShapeUSC",z)}JSk(z){this.va.removeHandler("ShapeUSC",z)}HIk(z){this.va.raiseEvent("ShowHideSC",z)}X7h(z){this.va.addHandler("ShowHideSC",z)}QSk(z){this.va.removeHandler("ShowHideSC",z)}}Object(h.a)(tc,"RevisionTrackingEventSource",
null,[538,539,540]);class Xh extends Sys.EventArgs{constructor(z,U){super();this.shape=z;this.slide=U}}Object(h.a)(Xh,"ShapeUnreadStateChangedEventArgs",Sys.EventArgs,[]);class ii{constructor(){this.cid=this.sid=0}}Object(h.a)(ii,"Slide",null,[]);class Rh{constructor(z,U){this.dt=this.mk=null;this.mk=Object.assign(new ii,{sid:z.sid,cid:z.cid});this.dt=U}}Object(h.a)(Rh,"SlideLastViewedVersion",null,[]);class Wf{constructor(){this.v=0;this.lv=this.defLv=null;this.v=1}}Object(h.a)(Wf,"SlideLastViewedVersions",
null,[]);class Yh extends Sys.EventArgs{constructor(z){super();this.slide=z}}Object(h.a)(Yh,"SlideUnreadStateChangedEventArgs",Sys.EventArgs,[]);class Jg{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc,jd,vd,he,nd){this.V$a=this.y$a=null;this.NIg=!1;this.Yle=null;this.F1c=0;this.Vzb=this.S$b=null;this.Lpe=[];this.v3c=null;this.x4c=!1;this.pwa=null;this.J5d=this.I5d=this.FOd=!1;Jc.a.J(512262749,804,50,"Start RevisionTrackingManager::RevisionTrackingManager()");this.Yqe=z;this.ua=U;this.yb=ka;this.lc=
Ba;this.Qb=Ia;this.od=Ab;this.Pcc=Ob;this.Mc=Yb;this.Hk=uc;this.b4c=Ec;this.WQg=mc;this.fc=jd;this.eck=Yc.pptEditingRevisionTrackingWriteRoamingCacheIntervalMs;this.LLg=Yc.xOj;this.jRg=!0;this.cH=!1;this.vGa=new da.a;this.Mc.HBc(Object(v.a)(this,this.oma,"onSessionAccessTokenExpired"));L.AFrameworkApplication.Kz&&this.Mc.KBc(Object(v.a)(this,this.uea,"onWopiTokenRefreshed"));this.fc.ff(()=>{this.I5d=!0;this.initialize();this.adh();this.I5d=!1});this.mcb=vd;this.Mb=he;this.R$j=nd}get F6b(){return Ai.a("WriteSlideLastViewedVersionsOnRead")}dispose(){this.y$a&&
(this.od.Tma(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady")),this.od.yjc(Object(v.a)(this,this.pma,"onShapeViewElementAdded")),this.Pcc.eGe(Object(v.a)(this,this.Wdb,"onMarkedUndo")),this.Mc.rGe(Object(v.a)(this,this.nDb,"onBeforeSessionEnd")),this.Mc.Oea(Object(v.a)(this,this.ML,"onSessionClosed")),this.Mc.Pea(Object(v.a)(this,this.to,"onSessionRehydrated")),this.Hk.USk(Object(v.a)(this,this.y2g,"onSlideChangesDataChanged")),this.Hk.ASk(Object(v.a)(this,this.y1g,"onPresentationLastModifiedTimeReceived")),
this.LLg&&this.WQg.tm(Object(v.a)(this,this.k2g,"onShapePropertyChanged")),this.Mc.Lfh(Object(v.a)(this,this.oma,"onSessionAccessTokenExpired")))}initialize(){Jc.a.J(512262748,804,50,"Start RevisionTrackingManager::Initialize()");this.Yle=new Date;this.F1c=this.Yle.getTime();this.I2k();this.od.uV(Object(v.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"));this.od.iob(Object(v.a)(this,this.pma,"onShapeViewElementAdded"));this.Pcc.aUb(Object(v.a)(this,this.Wdb,"onMarkedUndo"));this.Mc.LNa(Object(v.a)(this,
this.nDb,"onBeforeSessionEnd"));this.Mc.IB(Object(v.a)(this,this.ML,"onSessionClosed"));this.Mc.JB(Object(v.a)(this,this.to,"onSessionRehydrated"));this.Hk.c8h(Object(v.a)(this,this.y2g,"onSlideChangesDataChanged"));this.Hk.t7h(Object(v.a)(this,this.y1g,"onPresentationLastModifiedTimeReceived"));this.LLg&&this.WQg.Yj(Object(v.a)(this,this.k2g,"onShapePropertyChanged"));this.pwa=this.ua.Ba;this.V$a=this.A3i();this.getSlideLastViewedVersions();const z=new ad.a(3,2,this.eck,()=>{this.getSlideLastViewedVersions()},
90,"12");this.yb.Cb(z)}onActiveSlideDomReady(z,U){z=Object(A.a)(120,U.Ba);this.pwa&&z!==this.pwa&&this.YMe()&&(this.pwa.isConnected&&(this.pwa.isUnread&&this.H6c(this.pwa,!0),!this.F6b&&this.pwa.changesData&&(this.pwa.xW=this.pwa.changesData.dtField)),z&&z.isUnread&&this.kdh(z));this.pwa=z;this.F1c=Date.now()}Wdb(z,U){U.actionId!==qd.a.ZRa&&U.hwb&&(z=this.ua.Ba)&&z.isConnected&&z.isUnread&&this.YMe()&&this.H6c(z,!0)}nDb(){this.YMe()&&this.Yul();this.dpd()}ML(){this.mcb.log();this.cH=!0}to(){this.cH=
!1;this.S$b&&this.FCh(this.S$b)}FCh(z){var U=this.ua.presentation;if(!U)throw Error.argumentNull("Presentation is null");U=U.slides||[];0<U.length&&(this.Byl(U,z),this.iFe(U))}spk(z){this.J5d=!0;Jc.a.J(512262747,804,50,"OnReceiveLastViewedVersionInfo()");z&&(this.vGa=new da.a,this.forEach(z.lv,Ba=>{const Ia=Ba.mk.sid;(!this.vGa.Jb(Ia)||this.vGa.ga(Ia).dt<Ba.dt)&&this.vGa.$(Ia,Ba)}));const U=Vf.a.Q6b;let ka=!1;this.Vzb&&this.Yqe.PSj&&U!==this.Vzb&&(this.S$b&&Q.c(this.l8f())===Q.c(this.S$b)||(ka=!0));
z&&z.defLv&&(this.V$a=z.defLv,this.jRg=!1,z.lv&&0<z.lv.length&&this.FCh(z));ka&&this.dpd();this.Vzb=Vf.a.Q6b;this.J5d=!1}y2g(z,U){this.forEach(U.slides,ka=>{this.g$d(ka.changesData)||(this.ua.Ba&&ka.Bb!==this.ua.Ba.Bb||this.Qtj(Object(A.a)(120,ka)))&&this.hFe(Object(A.a)(120,ka))})}y1g(z,U){this.jRg&&(this.V$a=U.bCk)}k2g(z,U){z=U.property;U=Object(A.a)(4,U.node);z===db.a.rGb&&(z=this.lc.ig(U),z===this.ua.Ba&&z.isUnread&&U.changesData.dtField<=z.changesData.dtField&&(Jc.a.J(512262746,804,50,"Trying to highlight a shape in active slide, time elapsed after last slide navigation: {0}ms",
Date.now()-this.F1c),this.gFe(this.ua.Ba,U)))}pma(z,U){z=U.xw.shapeNode;this.ua.Ba.isUnread&&this.pEa(this.ua.Ba.Bb,z)&&!this.g$d(z.changesData)&&(this.Lpe.push(z),this.v3c||(this.v3c=new ad.a(2,1,0,Object(v.a)(this,this.tryHighlightInsertedShapes,"tryHighlightInsertedShapes"),90,"13"),this.yb.Cb(this.v3c)))}getSlideLastViewedVersions(){this.cH||this.x4c||this.Yqe.getSlideLastViewedVersionInfo(Object(v.a)(this,this.spk,"onReceiveLastViewedVersionInfo"))}dpd(){if(!this.cH&&!this.x4c){var z=this.l8f();
this.Yqe.putSlideLastViewedVersionInfo(z);this.S$b=z}}l8f(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");const U=Object.assign(new Wf,{defLv:this.V$a}),ka=[];this.forEach(z.slides||[],Ba=>{Ba=Ba.Bb;const Ia=this.Qb.kl(Ba);Ia&&Ia.xW&&(!Ba.cid&&this.vGa.Jb(Ba.sid)?Ba=Nd.a.tE(Ba.sid,this.vGa.ga(Ba.sid).mk.cid):Ba.cid&&this.vGa.Jb(Ba.sid)&&Ba.cid!==this.vGa.ga(Ba.sid).mk.cid&&Jc.a.J(512262745,804,50,"The same sid {0} has different cid. Roaming cid:{1}, Slide node cid:{2}",
Ba.sid,this.vGa.ga(Ba.sid),Ba.cid),ka.push(new Rh(Ba,Ia.xW)))});U.lv=ka;return U}Byl(z,U){const ka=U.lv;this.forEach(z,Ba=>{const Ia=Object(A.a)(120,Ba);this.forEach(ka,Ab=>{Ia&&this.Hbi(Ia,Ab.mk)&&(!Ia.xW||Ia.xW<Ab.dt)&&(Ia.xW=Ab.dt)})})}Hbi(z,U){return z.cid&&U.cid?z.sid===U.sid&&z.cid===U.cid:z.sid===U.sid}iFe(z){this.forEach(z,U=>{this.hFe(Object(A.a)(120,U))})}adh(){var z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");z=z.slides||[];0<z.length&&this.iFe(z)}kdh(z){this.aGh(z,
U=>{this.gFe(z,U)})}hFe(z){if(z&&z.isConnected&&z.changesData){const U=this.eTc(z.changesData,this.VNc(z));U!==z.isUnread&&(this.gUg(z,U),this.Osl(),z===this.ua.Ba&&this.kdh(z))}}gFe(z,U){if(U&&U.isConnected&&U.Sa(db.a.rGb)){const ka=this.eTc(U.changesData,this.VNc(z));this.eUg(z,U,ka)}}eUg(z,U,ka){ka!==U.isUnread&&(Jc.a.J(512262744,804,50,"Shape unread state changed: {0} -> {1}",U.isUnread,ka),U.isUnread=ka,this.b4c.nIk(new Xh(U,z)))}gUg(z,U){U!==z.isUnread&&(Jc.a.J(512262743,804,50,"Slide unread state changed: {0} -> {1}, SlideId={2}",
z.isUnread,U,z.Bb.toString()),z.isUnread=U,this.b4c.LIk(new Yh(z)))}H6c(z,U){if(this.F6b){if(!z)throw Error.argumentNull("ISlideNode is null");this.Ayl(z);Jc.a.J(509654915,804,50,"MarkSlideAsRead - SlideId={0}, isUnread={1}, writeToRoaming={2}",z.Bb.toString(),z.isUnread,U);if(!z.isUnread)return!1}this.aGh(z,ka=>{this.eUg(z,ka,!1)});this.gUg(z,!1);this.F6b&&U&&this.dpd();return!0}Nte(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");let U=!1;this.forEach(z.slides,
ka=>{ka=this.H6c(Object(A.a)(120,ka),!1);U||(U=ka)});Jc.a.J(509654914,804,50,"MarkAllSlidesAsRead - requiresWriteToRoaming={0}",U);U&&this.dpd()}aGh(z,U){z&&(z=z.jl(),this.forEach(z,ka=>{U(ka)}))}forEach(z,U){Ei.b(z,null,U)}g$d(z){return gl(z,this.y$a)}eTc(z,U){return!!z&&!!z.dtField&&!this.g$d(z)&&z.dtField>U}A3i(){const z=this.Qb.Gn;if(z&&z.HBe)return z.HBe;Jc.a.J(512262742,808,50,"GetDefaultLastViewedTime - No PresLastModifiedTime");return new Date}gug(z){const U=Object(A.a)(120,this.R$j.Sfg(z));
return U&&U.isUnread&&z&&this.eTc(z.changesData,this.VNc(U))}I2k(){this.y$a=new Kl(this.fc.Ga("UserName"),this.fc.Ga("387"),this.fc.Ga("388"))}Ayl(z){z.xW=z&&z.changesData?z.changesData.dtField:this.V$a}Yul(){const z=this.ua.Ba;z&&(z.xW=z.changesData?z.changesData.dtField:this.V$a)}VNc(z){return z.xW||this.V$a}Osl(){this.NIg||(this.NIg=!0,Jc.a.J(512262741,804,50,"First revision tracking view render completed!"))}Qtj(z){return z.isConnected&&z.changesData&&z.changesData.dtField?z.changesData.dtField<=
this.Yle&&this.eTc(z.changesData,this.VNc(z)):!1}pEa(z,U){return z.equals(U.slideId)}tryHighlightInsertedShapes(){Jc.a.J(512262740,804,50,"Trying to highlight inserted shapes on active slide, time elapsed after last slide navigation: {0}ms",Date.now()-this.F1c);this.v3c=null;const z=this.ua.Ba;if(z&&z.isUnread){const U=z.Bb;for(const ka of this.Lpe)this.pEa(U,ka)&&this.gFe(z,ka)}Array.clear(this.Lpe)}oma(){this.x4c=!0}uea(z,U){try{U.YVc?(Jc.a.J(512262739,804,50,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh succeeded."),
this.x4c=!1):Jc.a.J(512262738,804,15,"RevisionTrackingManager::OnWopiTokenRefreshed Token refresh failed.")}catch(ka){Jc.a.J(512262737,804,10,"RevisionTrackingManager::OnWopiTokenRefreshed Exception: {0}",ka)}}YMe(){return 1!==this.Mb.Xo}}Object(h.a)(Jg,"RevisionTrackingManager",null,[]);class sb{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec){this.ua=z;this.Qb=U;this.Vqe=ka;this.od=Ba;this.m4=Ia;this.Ea=Ab;this.VYc=Ob;this.Wcb=Yb;this.Ne=uc;this.Dzb=mc;this.r5j=Ec;this.yOg=!1;this.od.kob(Object(v.a)(this,
this.B3g,"onVisibleThumbnailRangeChanged"));this.od.YId(Object(v.a)(this,this.KDb,"onThumbnailRefresh"));this.od.Q7h(Object(v.a)(this,this.j2g,"onShapePresenceStateChanged"));this.od.p8h(Object(v.a)(this,this.l3g,"onThumbnailPresenceStateChanged"));this.od.X6h(Object(v.a)(this,this.Iqk,"onShapeViewElementShowRevisionTrackingHint"));this.od.U6h(Object(v.a)(this,this.Bqk,"onShapeViewElementHideRevisionTrackingHint"));this.m4.WId(Object(v.a)(this,this.RWa,"onSlideUnreadStateChanged"));this.m4.M7h(Object(v.a)(this,
this.p2g,"onShapeUnreadStateChanged"));this.m4.X7h(Object(v.a)(this,this.t2g,"onShowHideStateChanged"))}dispose(){this.od.Ufh(Object(v.a)(this,this.B3g,"onVisibleThumbnailRangeChanged"));this.od.cTk(Object(v.a)(this,this.KDb,"onThumbnailRefresh"));this.od.MSk(Object(v.a)(this,this.j2g,"onShapePresenceStateChanged"));this.od.bTk(Object(v.a)(this,this.l3g,"onThumbnailPresenceStateChanged"));this.m4.wGe(Object(v.a)(this,this.RWa,"onSlideUnreadStateChanged"));this.m4.JSk(Object(v.a)(this,this.p2g,"onShapeUnreadStateChanged"));
this.m4.QSk(Object(v.a)(this,this.t2g,"onShowHideStateChanged"))}B3g(){const z=this.ua.presentation;if(!z)throw Error.argumentNull("Presentation is null");Ei.b(z.slides||[],null,U=>{(U=this.Qb.kl(U.Bb))&&U.isUnread&&this.COe(U)})}KDb(z,U){z=this.Qb.kl(U.yyh);z.isUnread&&this.COe(z)}RWa(z,U){z=U.slide;z.isUnread?this.COe(z):this.HQk(z)}p2g(z,U){z=U.shape;U=U.slide;z&&(z.isUnread?U===this.ua.Ba&&this.yOe(z):this.YFe(z))}j2g(z,U){z=U.shape;z.gs?this.YFe(z):z.isUnread&&this.yOe(z,!0)}l3g(z,U){z=U.slide;
z.gs&&!this.tNe?this.MQk(z):z.isUnread&&this.yfl(z)}t2g(z,U){z=U.shape;U.bCa&&z.isUnread?this.yOe(z):this.YFe(z)}get tNe(){return this.r5j}COe(z){z&&z.isConnected&&this.eod(z,U=>{U.Ush();z.gs&&!this.tNe||this.dEf(U)})}HQk(z){z&&z.isConnected&&this.eod(z,U=>{U.Heh();U.UFe()})}yfl(z){z.gs&&!this.tNe||this.eod(z,Object(v.a)(this,this.dEf,"addRevisionTrackingPawnForThumbnail"))}MQk(z){this.eod(z,U=>{U.UFe()})}nrh(){const z=this.Qb.Gn;return!this.Dzb||this.Dzb&&z.bCa}yOe(z,U=!1){this.nrh()&&!z.gs&&z.Sa(db.a.rGb)&&
(Object(A.a)(121,z.oc(this.Ne))?(this.Vqe.AG(z).display(()=>this.Ea.LOc(z)),this.ssl(),Jc.a.J(23606109,804,50,"ShowShapeRevisionTrackingView(), IsTriggeredByPresenceUpdate={0}",U)):Jc.a.J(23606111,804,50,"ShowShapeRevisionTrackingView() failed, no shape view element created"))}YFe(z){const U=this.Vqe.kF(z);U?U.dismiss():this.nrh()&&z.isUnread&&Jc.a.J(23606113,804,50,"RemoveShapeRevisionTrackingView() failed, a revision tracking view is expected but not found")}eod(z,U){z&&((z=Object(A.a)(537,z.sg(this.Wcb)))?
U(z):Jc.a.J(23606115,804,50,"UpdateThumbnailRevisionTrackingView() failed, no thumbnail view element found"))}dEf(z){z.XHd(this.VYc.backgroundColor,ResourceStrings.l_RevisionTracking_Slide_Has_Unread_Changes)}Iqk(z,U){this.vEh(U.xw.shapeNode,!0)}Bqk(z,U){this.vEh(U.xw.shapeNode,!1)}vEh(z,U){(z=this.Vqe.kF(z))&&(U?z.pxa():z.NZ())}ssl(){this.yOg||(this.yOg=!0,ce.c(qa.a.Nli))}}Object(h.a)(sb,"RevisionTrackingPresenter",null,[]);class Xa{PUf(){const z=new jm.a;z.gh(10,10);z.gxa("0 0 10 10");z.xa.setAttribute("class",
"ModernRevisionTrackingIconSVG");const U=new ol.a;U.y0("M1,5 a4,4 0 1,0 8,0 a4,4 0 1,0 -8,0");U.xa.setAttribute("class","ModernRevisionTrackingIconPath");z.appendChild(U);return z.xa}}Object(h.a)(Xa,"RevisionTrackingSVGProvider",null,[489]);class hl{constructor(){this.c4c=this.H5c=this.G5c=this.ape=0}r_j(){this.H5c+=1}PZj(z,U){switch(z){case 2:U&&(this.G5c+=1);break;case 0:U?(this.c4c+=1,Jc.a.J(39068549,804,50,"HandleShowHideChanges: User enables detailed highlight via Ribbon button")):Jc.a.J(39068551,
804,50,"HandleShowHideChanges: User disables detailed highlight via Ribbon button");break;case 1:U&&(this.ape+=1)}}log(){Jc.a.J(39068553,804,15,"WYWA Notification Clicks:{0}; Thumbnail Revision Tracking Pawn Clicks: {1}; Thumbnail Revision Tracking Pawn Hovers: {2}; Show Hide Changes Ribbon Clicks:{3};",this.ape,this.G5c,this.H5c,this.c4c);0<this.G5c+this.H5c+this.c4c&&ce.c(qa.a.DNd)}}Object(h.a)(hl,"RevisionTrackingTelemetry",null,[]);var sl=d(1005),Tn=d(1110),fj=d(73),Ml=d(568);class rj{constructor(z,
U,ka,Ba,Ia){this.v$a=null;this.uGa=z;this.mcb=U;this.ic=Ia;this.Zb=ka;this.ra=Ba;this.uGa.vV(Object(v.a)(this,this.IF,"onInteractivityChanged"))}dispose(){this.uGa&&this.uGa.dispose();this.v$a=this.uGa=null}display(z,U){this.v$a||(this.v$a=new Ml.a);this.v$a.color=z;this.v$a.userName=U;this.uGa.Fx(this.v$a)}dismiss(){this.uGa.qJ(this.v$a.clientId)}pxa(){this.uGa.mxa()}NZ(){this.uGa.jfa()}get ZKd(){const z=this.uGa.Leb;return 0<z.length?z[0]:null}IF(z,U){z={InvokeSource:2,ShowRevisionTrackingStatus:null};
1===U.type?(this.Zb.Ba!==this.ic?(this.ic&&(this.Zb.Ba=this.ic,this.ra.Cy()),z.ShowRevisionTrackingStatus=3):z.ShowRevisionTrackingStatus=1,L.AFrameworkApplication.Ta.La(Qc.a.pIb,2,z)):2===U.type?this.ic&&this.Zb.Ba===this.ic&&(z.ShowRevisionTrackingStatus=2,L.AFrameworkApplication.Ta.La(Qc.a.pIb,2,z),this.mcb.r_j()):3===U.type&&this.ic&&this.Zb.Ba===this.ic&&(z.ShowRevisionTrackingStatus=0,L.AFrameworkApplication.Ta.La(Qc.a.pIb,2,z))}}Object(h.a)(rj,"ThumbnailRevisionTrackingPawn",null,[550,106]);
d(297);class ep{constructor(z,U,ka,Ba,Ia,Ab){this.De=z;z=fj.getImageClassWithCluster("pegal","UnreadNotification_16x16x32");U=U.hk("pegal.png");ka=ka.PUf();this.Z8j=this.MDi(L.AFrameworkApplication.isRtl,z,U,ka);this.mcb=Ba;this.Zb=Ia;this.ra=Ab}CBi(z,U){return new rj(this.Z8j.Lqb(z),this.mcb,this.Zb,this.ra,U)}Nc(z){return this.De.Nc(z)}MDi(z,U,ka,Ba){const Ia=new sl.a;Ia.add(1,U);Ia.add(4,ka);Ia.add(6,16);Ia.add(8,z);Ia.add(12,2);Ia.add(11,!1);Ia.add(14,Ba);return new Tn.a(Ia)}}Object(h.a)(ep,"RevisionTrackingThumbnailGadgetsFactory",
null,[487]);class tl{constructor(z,U,ka){this.R0c=this.K$b=!0;this.ew=z;this.JFa=U;this.la=ka}get PSj(){return this.K$b}getSlideLastViewedVersionInfo(z){if(this.R0c){Jc.a.J(25203102,824,50,"GetSlideLastViewedVersionInfo(), Start sending read request to FE at [{0}]",JSON.stringify(new Date));var U=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPPTSlideLastViewedMetadata",L.AFrameworkApplication.hh),ka={};ka["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.ew.yj(U,1,null,ka,!1,2,Object(v.a)(this,this.Pmk,"onGetVersionInfoSucceeded"),Object(v.a)(this,this.Omk,"onGetVersionInfoFailed"),z,void 0,void 0,void 0,void 0,Tc.a("12"));this.R0c=!1}else Jc.a.J(25203100,824,50,"Response of previous get roaming request is not back yet.")}putSlideLastViewedVersionInfo(z){if(this.K$b){Jc.a.J(25203106,824,50,"PutSlideLastViewedVersionInfo(), Start sending write request to FE");var U=Q.c(z),ka=this.la.pptRevisionTrackingMaxRoamingDataSizeInBytes;
if(U.length>ka)Jc.a.J(25203136,824,50,"Roaming data size is bigger than the limitation, won't write to roaming service, slideNum={0}, dataSize={1}, sizeLimitation={2}",z.lv.length,U.length,ka);else{ka=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePPTSlideLastViewedMetadata",L.AFrameworkApplication.hh);if(L.AFrameworkApplication.fa.ka("SendBeaconOnRoamingRequestsIsEnabled"))this.ew.OIa(ka,U);else{const Ba={};Ba["X-StatelessPopsAffinityRoutingEnabled"]=
this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.ew.yj(ka,2,U,Ba,!1,2,Object(v.a)(this,this.lpk,"onPutVersionInfoSucceeded"),Object(v.a)(this,this.kpk,"onPutVersionInfoFailed"),z.lv.length,void 0,void 0,void 0,void 0,Tc.a("13"))}this.K$b=!1}}else Jc.a.J(25203104,824,50,"Response of previous write roaming request is not back yet.")}dispose(){}Pmk(z){this.R0c=!0;let U=0;try{let ka=null;z.data.Sd&&0<z.data.Sd.trim().length&&(U=z.data.Sd.length,ka=JSON.parse(z.data.Sd,Object(v.a)(this,this.dTj,
"jsonDateReviver")));const Ba=z.data.state;Ba(ka)}catch(ka){Jc.a.J(23132289,824,10,"OnGetVersionInfoSucceeded catched exception: {0}",ka.toString())}z=String.format("OnGetVersionInfoSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",U,JSON.stringify(z.data.aI),JSON.stringify(z.data.Kt),JSON.stringify(z.data.Wu));Jc.a.J(25203139,824,50,z)}Omk(z){this.R0c=!0;z=this.JFa.Nia(z);Jc.a.J(23132291,824,50,"OnGetVersionInfoFailed: Web service failed with {0}",z)}lpk(z){this.K$b=
!0;Jc.a.J(25203142,824,50,"OnPutVersionInfoSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+z.data.Wu-+z.data.aI,+z.data.Kt-+z.data.aI)}kpk(z){this.K$b=!0;const U=this.JFa.Nia(z);Jc.a.J(23132293,824,50,"OnPutVersionInfoFailed: Web service failed with {0}, NumSlides={1}",U,z.data.state)}dTj(z,U){return"dt"===z||"defLv"===z?new Date(U):U}}Object(h.a)(tl,"RoamingCacheProxy",null,[486,106]);var an=d(673),ul=d(113);class sk{constructor(z,U,ka){this.zg=z;this.YI=Object(A.a)(an.a,this.zg.Fph);this.VYc=U;this.oak=
ka;this.zg.dxg=!0}display(z){let U;U=this.oak.PUf();this.YI.cEf(this.VYc.backgroundColor,z,U);this.zg.tKb(this.VYc.foregroundColor);this.zg.setVisibility()}dismiss(){this.YI.clear();this.zg.tKb(ul.a.none);this.zg.setVisibility()}ym(z){this.zg.ym(z)}LC(z){this.zg.LC(z)}Qp(){return this.zg.Qp()}kN(z){return this.zg.Ivb(z)}xx(z){this.zg.xx(z)}dispose(){this.zg.dispose()}Ay(){this.zg.Ay()}CD(z){return this.zg.CD(z)}jB(z){return this.zg.jB(z)}draw(z,U){this.zg.draw(z,U)}get visible(){return this.zg.visible}set visible(z){this.zg.visible=
z}setPosition(z,U){this.zg.setPosition(z,U)}Dj(z){this.zg.Dj(z)}Gq(z){this.zg.Gq(z)}Gu(z){this.zg.Gu(z)}setZIndex(z){this.zg.setZIndex(z)}nE(z,U){this.zg.nE(z,U)}pxa(){this.YI.pxa()}NZ(){this.YI.NZ()}setSelection(){}}Object(h.a)(sk,"ShapeRevisionTrackingView",null,[534,535,536,106]);class wm{constructor(){this.K=null;this.Dzb=this.fne=this.aX=this.S3=!1}get name(){return"PowerPointWebEditor.RevisionTracking"}init(){}Wb(z){this.K=z;z.resolve("Common.IAppSettingsManager").ff(()=>{this.aX=z.resolve("PowerPointWebEditor.IApplicationContext").ld.tg;
this.fne=z.resolve("PowerPointWebEditor.IApplicationContext").ld.hNj;this.S3=z.resolve("PowerPointWebEditor.IApplicationContext").ld.fce;this.Dzb=z.resolve("PowerPointWebEditor.IApplicationContext").ld.hbe;this.register();this.resolve()})}dispose(){this.S3&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").dispose(),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").dispose())}register(){const z=
this.K;this.aX&&this.fne&&z.register(le.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new le.a(L.AFrameworkApplication.Ge,z.resolve("PowerPointWebEditor.ISessionInfoOwner"),z.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),z.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),z.resolve("PowerPointWebEditor.IErrorHandler"),z.resolve("Common.ITaskManager"),z.resolve("Common.IAppSettingsManager")));this.S3&&(z.register(hl,"RevisionTrackingTelemetry").ma().na(()=>new hl),z.register(Jg,
"PowerPointWebEditor.RevisionTracking.RevisionTrackingManager").ma().na(()=>new Jg(z.resolve("PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy"),z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("Common.ITaskManager"),z.resolve("PowerPointWebEditor.ISlideReader"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),z.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),z.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
z.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),z.resolve("Box4.Graph.IGraphInstance").vd(10),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource"),z.resolve("PowerPointWebEditor.IApplicationSettings"),z.resolve("Common.IAppSettingsManager"),z.resolve("RevisionTrackingTelemetry"),z.resolve("PowerPointWebEditor.View.IPPTPageView"),z.resolve("PowerPointWebEditor.Graph.SlideNodeHelper"))),z.register(sb,"PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter").ma().na(()=>
new sb(z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>"),z.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers"),z.resolve("PowerPointWebEditor.IShapeReader"),z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),
z.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,z.resolve("Box4.IPageView").Ma,z.resolve("PowerPointWebEditor.IApplicationSettings").hbe,z.resolve("Common.IAppSettingsManager").ka("PPTCanvasPresenceBubbleUXEnabled"))),z.register(486,"PowerPointWebEditor.RevisionTracking.IRoamingCacheProxy").ma().na(()=>new tl(L.AFrameworkApplication.Ge,z.resolve("PowerPointWebEditor.IJsonpHelperManager"),z.resolve("PowerPointWebEditor.IApplicationSettings"))),z.register(487,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory").ma().na(()=>
new ep(z.resolve("PowerPoint.IBrowserHelperManager"),z.resolve("PowerPoint.IPathManager"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider"),z.resolve("RevisionTrackingTelemetry"),z.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),z.resolve("PowerPointWebEditor.IPptSelectionManager"))),z.register(tc,"PowerPointWebEditor.RevisionTracking.RevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventSource").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier").as("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventHandlers").ma().na(()=>
new tc),z.register(488,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeRevisionTrackingView>").ma().na(()=>new kg.a((U,ka)=>{let Ba=null;const Ia=Object(A.a)(121,U.oc(z.resolve("Box4.IPageView").Ma));Ia&&!Ia.ll&&(U=z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnViewFactory").IRd(z.resolve("PowerPointWebEditor.IPptSelectionManager"),(Ab,Ob,Yb)=>z.resolve("PowerPointWebEditor.ShapePresence.IShapePawnFactory").ICi(Ab,Ob,Yb,z.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),
U,ka,Ia.nU),Ba=new sk(U,z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider")),Ba.ym(Ia.nU),Ia.Ypa(Ba,1),Ba.visible=Ia.aQ||Ia.Kn);return Ba})),z.register(Oe,"PowerPointWebEditor.RevisionTracking.RevisionTrackingColorProvider").ma().na(()=>new Oe(z.resolve("Common.Utils.IHighContrastDetector"))),z.register(489,"PowerPointWebEditor.RevisionTracking.IRevisionTrackingSVGProvider").ma().na(()=>new Xa),
this.aX&&this.Dzb&&z.register(Zd,"PowerPointWebEditor.RevisionTracking.RevisionTrackingActor").ma().na(()=>new Zd(z.resolve("Common.IActionManagerExtended"),z.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),z.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),z.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingEventNotifier"),z.resolve("PowerPointWebEditor.IPresentationReader"),z.resolve("PowerPointWebEditor.View.IViewEventSource"),z.resolve("RevisionTrackingTelemetry"))))}resolve(){this.aX&&
this.fne&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");if(this.S3&&(this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingPresenter"),this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingManager"),this.K.resolve("PowerPointWebEditor.RevisionTracking.IRevisionTrackingThumbnailGadgetsFactory"),this.Dzb)){const z=this.K.resolve("PowerPointWebEditor.RevisionTracking.RevisionTrackingActor");z.ub();z.xe()}}static main(){ua.a.instance.Bc(Bb.a(new wm,0))}}Object(h.a)(wm,
"PPTWebEditorRevisionTrackingPackage",null,[2,3]);var yo=d(536),Nf=d(674);class sh{get name(){return"Common.App.OAuth.OAuthPackage"}Wb(z){z.register(527,"Common.App.OAuth.IOAuthManager").ma().na(()=>new yo.OAuthManager)}init(){const z=Z.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.gtl(z)}gtl(z){const U=L.AFrameworkApplication.fa.Ga("FileSource");if(L.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||L.AFrameworkApplication.fa.ka("IsO365CommercialHost")||"WopiTest"===U){var ka=aa.OAuthManagerSettings.uTf;
if(ka&&ka.IsEnabled){var Ba=ka.Application,Ia=aa.OAuthManagerSettings.authority;if(void 0!==Ba&&null!==Ba&&Ba.length&&void 0!==Ia&&null!==Ia&&Ia.length){var Ab=Nf.a[z.V5],Ob=ia.a.zy,Yb=z.wD();try{var uc=new Map;void 0!==uc&&null!==uc?(uc.set("SupportStatus",Ab),uc.set("Browser",Ob),uc.set("AuthStrategy",Yb)):uc=null}catch(Ec){uc=null}u.Health.instance.recordKpiUsageForAlertableKpi("WacCorePFT","WacOAuthFC",uc);var mc=Pb.a.sj();z.KU("Core",Ba).then(Ec=>{const Yc=Math.floor(Pb.a.sj()-mc);Ab=Nf.a[z.V5];
Ob=ia.a.zy;Yb=z.wD();e.ULS.sendTraceTag(562943369,3E3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {0} ms. Success={1}, SupportStatus={2}, ErrorCode="{3}", Host="{4}", Browser="{5}", AuthStrategy="{6}"',Yc,Ec.IsSuccess,Ab,Ec.ErrorCode,U,Ob,Yb);uc&&(uc.set("SupportStatus",Ab),uc.set("Browser",Ob),uc.set("AuthStrategy",Yb));var jd=Object.assign(new ya.a,{durationMs:Yc,extendedProperties:uc});if(Ec.IsSuccess){if(u.Health.instance.recordKpiSuccess("WacCorePFT",jd),Ec="Bearer "+
Ec.Token,L.AFrameworkApplication.Ge.GWe=Ec,jd=ka.Endpoint){var vd=Pb.a.sj();L.AFrameworkApplication.Ge.Xnb(jd,1,null,{["Authorization"]:Ec},2,"OAuthManagerValidateAccess",void 0,void 0,void 0,2E4).continueWith(he=>{var nd=Math.floor(Pb.a.sj()-vd),ee=null;he.Jn?he="Canceled":he.hm?he="Faulted":(ee=he.result,he=ee.succeeded?"Completed":"Failed");nd={["TaskResult"]:he,["BrowserTokenDurationMS"]:Yc,["BrowserValidationDurationMS"]:nd};ee&&(nd.HttpStatus=ee.Ui.data.Le,ee.succeeded&&(ee=Q.a(ee.Ui.data.Sd),
nd.ServerValidationDurationMS=ee.ElapsedMilliseconds,nd.ServerValidationResult=ee.ValidatedToken,nd.KMSI=ee.KMSI,nd.Scopes=ee.Scopes,nd.TokenExpirationS=Math.floor(parseInt(ee.Expiration)-(new Date).getTime()/1E3)));e.ULS.sendTraceTag(520632322,3E3,"Completed"===he?50:15,ja.a.toJSON(nd))})}}else u.Health.instance.recordKpiFailure("WacCorePFT",Ec.ErrorCode,!1,!1,jd)}).catch(Ec=>{var Yc=Math.floor(Pb.a.sj()-mc);Yc=Object.assign(new ya.a,{durationMs:Yc,extendedProperties:uc});u.Health.instance.recordKpiFailure("WacCorePFT",
"UNEXPECTED CATCH: "+Ec.toString(),!1,!1,Yc)})}}}}dispose(){}static main(){ua.a.instance.Bc(new sh)}}Object(h.a)(sh,"OAuthPackage",null,[2,3]);var ho=d(396),Re=d(221),Ve=d(134);class Kg{constructor(z){this.lNa=[qd.a.mnc,qd.a.nnc,qd.a.onc,qd.a.pnc,qd.a.qnc];this.d2e=z}gag(z){return this.d2e?this.d2e.cNc(z.Ua):null}create(z){return z?(z=this.JXb(z))?Ve.m(z):"":""}azi(z){z=z.suggestions;if(!z||!z.count)return null;z=({NXf:U}=this.vDi(z)).returnValue;var U=Kg.dAi(U);const ka=Object.assign(new ho.a,{ExternalId:"DictationCorrectionMenu",
Command:"798637440",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsFlyoutTitle,Image16by16Class:fj.getImageClassWithCluster(L.AFrameworkApplication.mN,Kg.tIi),Image16by16:L.AFrameworkApplication.gm,Menu:Object.assign(new jh.a,{ExternalId:"DictationCorrectionSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,MenuSectionList:[]})});z&&Array.add(ka.Menu.MenuSectionList,z);Array.add(ka.Menu.MenuSectionList,U);return ka}vDi(z){let U;const ka=Object.assign(new mh.a,{Id:"DictationCorrectionSuggestions",
ControlList:[],ControlsId:"DictationCorrectionSuggestionsControls",Title:Box4Intl.Box4Strings.L_DictationCorrectionsGroupTitle});U=null;for(let Ba=0,Ia=Math.min(this.lNa.length,z.count);Ba<Ia;++Ba){if(!U&&""===z.ga(Ba).suggestion){U=this.lNa[Ba].toString();continue}const Ab=Object.assign(new Re.a,{ExternalId:"btnDictationCorrectionSuggestion"+Ba,Command:this.lNa[Ba].toString(),LabelText:z.ga(Ba).suggestion});Array.add(ka.ControlList,Ab)}return ka.ControlList.length?{returnValue:ka,NXf:U}:{returnValue:null,
NXf:U}}JXb(z){if(z=this.azi(z)){const U=Object.assign(new mh.a,{Id:"DictationCorrectionSection",ControlList:[],ControlsId:"DictationCorrectionSection"});Array.add(U.ControlList,z);return U}return null}static dAi(z){const U=Object.assign(new mh.a,{Id:"DictationCorrectionIgnoreSuggestionSection",ControlList:[],ControlsId:"DictationCorrectionIgnoreSuggestionSectionControls"}),ka=Object.assign(new Re.a,{ExternalId:"btnIgnoreDictationCorrectionSuggestion",Command:"421768503",LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsIgnoreSuggetion});
Array.add(U.ControlList,ka);z&&(z=Object.assign(new Re.a,{ExternalId:"btnDeleteDictationCorrectionSuggestion",Command:z,LabelText:Box4Intl.Box4Strings.L_DictationCorrectionsDeleteSuggetion}),Array.add(U.ControlList,z));return U}}Kg.tIi="Insertaudio_16x16x32";Object(h.a)(Kg,"DictationCorrectionContextMenuManager",null,[523]);var wf=d(431);class Ae{constructor(z,U){this.Zrc=null;this.ir=z;this.MY=U}get key(){return"DICTATIONCORRECTION"}get d7(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle}reset(z){this.ir.Vd(z.node)?
this.Zrc=z.node:this.Zrc=null}yoc(z){let U;U=null;if(!this.Zrc)return{returnValue:!1,oAa:U};z=this.MY.Z3i(this.Zrc,z);if(!z)return{returnValue:!1,oAa:U};U=Object.assign(new wf.a,{j0:this.key,yP:z,description:this.p_d()});return{returnValue:!0,oAa:U}}p_d(){return L.AFrameworkApplication.fa&&L.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}}Object(h.a)(Ae,"DictationCorrectionDetailsProvider",null,[514,513]);var lf=d(604),
wi=d(135);class Se{constructor(z,U,ka=-1){this.TriggerType="click";this.TreatedInUX="true";this.PhraseId=z.nxk;this.CorrectionId=z.id;switch(U){case 0:this.EditType="alternate";this.AlternateId=ka;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:e.ULS.sendTraceTag(51246608,394,10,"Invalid CorrectionEditType value")}}}Object(h.a)(Se,"CorrectionEvent",null,[]);class zo{constructor(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=
null}}Object(h.a)(zo,"CorrectionTelemetry",null,[]);class yj{constructor(){this.Id="Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}}Object(h.a)(yj,"CorrectionsSessionTelemetry",null,[]);class sf{constructor(){this.GR=!1;this.Hpd=this.qyd=0}start(){this.GR||(this.GR=!0,this.qyd=this.getTime())}stop(){this.GR&&(this.Hpd+=this.getTime()-this.qyd,this.GR=!1)}get Kq(){return this.Hpd+(this.GR?this.getTime()-this.qyd:0)}getTime(){return(new Date).getTime()}}Object(h.a)(sf,
"DictationCorrectionsSessionTimer",null,[]);class og{constructor(){this.StartTime="";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}}Object(h.a)(og,"SessionInfo",null,[]);class Ao{constructor(){this.FinalText="";this.PhraseIds=null}}Object(h.a)(Ao,"TextInfo",null,[]);var bn=d(179),hf=d(124);class Nl{constructor(z){this.vhf=this.Zzd=this.$zd=0;this.FIh="Office.Voice.Online.DictationCorrectionsSession";this.t2a=null;this.Vmb=Object.assign(new og,{TextInfo:[new Ao]});
this.T5e=z}startSession(){this.t2a||(this.Vmb.StartTime=(new Date).toISOString(),this.t2a=new sf);this.t2a.start()}pauseSession(){this.t2a.stop()}endSession(){this.t2a.stop();var z=new bn.a;z.name=this.FIh;z.samplingPolicy=2;z.durationMs=this.t2a.Kq;z.dataFields=[];Array.add(z.dataFields,Object.assign(new hf.a,{name:"CorrectionSessionId",string:this.Wwa}));Array.add(z.dataFields,Object.assign(new hf.a,{name:"StartTime",string:this.Vmb.StartTime}));Array.add(z.dataFields,Object.assign(new hf.a,{name:"NumberOfCorrectionsMarked",
int64:this.$zd}));Array.add(z.dataFields,Object.assign(new hf.a,{name:"NumberOfCorrectionsMade",int64:this.Zzd}));Array.add(z.dataFields,Object.assign(new hf.a,{name:"NumberOfCorrectionsDismissed",int64:this.vhf}));wi.a.sendActivityEvent(z);if(Cf.App.yZ&&0<Cf.App.yZ.D6g.length){this.Vmb.AlternateEditCount=this.Zzd;this.Vmb.Duration=Math.floor(this.t2a.Kq/1E3);this.Vmb.TextInfo[0].PhraseIds=Cf.App.yZ.D6g;var U=new yj;U.ClientSessionId=this.Wwa;U.SessionInfo=this.Vmb;if(z=this.T5e())U=Q.c(U),z.hDg(U)}}vlk(z){this.$zd+=
z}ZZg(z,U,ka=-1){0===U?this.Zzd++:1===U&&this.vhf++;var Ba=new zo;Ba.ClientSessionId=this.Wwa;Ba.CorrectionEvents=[new Se(z,U,ka)];if(z=this.T5e())Ba=Q.c(Ba),z.hDg(Ba)}get Wwa(){return Cf.App.yZ?Cf.App.yZ.Wwa:""}}Object(h.a)(Nl,"DictationCorrectionsTelemetry",null,[]);var Im=d(42),cn=d(40);class uf{constructor(z,U,ka){this.TM=z;this.Kb=U;this.tG=ka}}Object(h.a)(uf,"DictationCorrectionRange",null,[]);var Pk=d(353);class xm{constructor(z,U,ka){this.Uyf=this.Jq=null;this.qkb=z;this.Iya=U;this.Twc=new Pk.a(new lf.a);
this.Qrc=ka;this.Hma()}k9d(z){this.Iya.EBa&&nf.ParagraphReader.Vd(z)&&this.Twc.contains(z.id)&&this.qkb.k9d(z)}Hil(){this.Iya.EBa=!0;this.Jq=new Nl(()=>this.Uyf);this.Jq.startSession()}wjl(){this.Iya.EBa=!1;var z=Cf.App.Hb.Hd.nn.vg;if(z){z=z.Fh;for(let U of this.Twc){const ka=z.te(U);ka&&nf.ParagraphReader.Vd(ka)&&this.qkb.bpi(ka)}}this.Qrc.clear();this.Twc.clear();this.Jq.endSession()}SWk(z){if(this.Iya.EBa){var U=z.sa(cn.a.GTd,null);if(!cj.a.Va(U)){var ka=new Da.a,Ba=Math.min(U.length,z.Ra.length);
for(let Ia=0;Ia<Ba;Ia++){const Ab=this.Qrc.x2i(U[Ia]);if(Ab){const Ob=z.Ra.ga(Ia).cp;ka.add(new uf(Ob,Ob+Ab.source.length,Ab))}}this.qkb.Uck(z,ka)}}}TUe(z,U){if(!U)return!1;if(!this.Iya.EBa||!z)return U.add(null),!1;U.add(z.Yu?z.Yu.tG.key:null);return!!z.Yu}BZk(z,U){this.Iya.EBa&&U&&Va.AT(U,ka=>!!ka)?z.me(cn.a.GTd,U.toArray()):z.removeProperty(cn.a.GTd)}Bdh(z){this.Uyf=z}Hma(){this.qkb.e5h(Object(v.a)(this,this.slk,"onDictationCorrectionMarkerAdded"));Gf.a.addHandler(window.self,bc.a.blur,()=>{this.Jq&&
this.Iya.EBa&&this.Jq.pauseSession()});Gf.a.addHandler(window.self,bc.a.focus,()=>{this.Jq&&this.Iya.EBa&&this.Jq.startSession()});this.qkb.f5h(Object(v.a)(this,this.tlk,"onDictationCorrectionMarkerRemoved"))}tlk(z,U){this.Qrc.HPk(U.xTf)}slk(z,U){this.Twc.add(U.wuk);this.Jq&&this.Jq.vlk(U.xdk);this.Qrc.w1h(U.xTf)}rlk(z,U){this.Jq&&this.Jq.ZZg(z,0,U)}ulk(z){this.Jq&&this.Jq.ZZg(z,1)}Z3i(z,U){if(!this.Iya.EBa)return null;z=Ji.a.ak(z,U);return this.qkb.cNc(z)}}Object(h.a)(xm,"DictationCorrectionManager",
null,[522]);class di extends Sys.EventArgs{constructor(z,U){super();this.wuk=z;this.xdk=U?U.count:0;this.xTf=U}}Object(h.a)(di,"DictationCorrectionMarkerEventArgs",Sys.EventArgs,[]);class yn{constructor(z,U,ka,Ba,Ia){this.tUh=z;this._id=U;this.qLh=Ba;this.ASb=Ia;this.zt=ka;this.rPb=String.format("{0}_{1}",z,U)}get nxk(){return this.tUh}get id(){return this._id}get source(){return this.zt}get confidence(){return this.qLh}get suggestions(){return this.ASb}get key(){return this.rPb}Hek(z){this.suggestions.addRange(z.suggestions)}}
Object(h.a)(yn,"DictationCorrectionDetails",null,[]);class dn{constructor(z,U,ka){this.An=z;this.PLh=U;this.ATh=ka}get tG(){return this.PLh}get Z_g(){return this.ATh}get ye(){return this.An}Ud(z){return new dn(z||this.ye,this.tG,this.Z_g)}}Object(h.a)(dn,"DictationCorrectionObject",null,[167]);class Kf{constructor(z,U){this.source=z;this.suggestion=U}}Object(h.a)(Kf,"DictationCorrectionSuggestion",null,[]);class Kj{constructor(z){this.Yg=z;this.Pa=new qk.a}e5h(z){this.Pa.addHandler("ADCM",z)}f5h(z){this.Pa.addHandler("RDCM",
z)}Uck(z,U){this.ddk(z,U)}ddk(z,U){if(z&&U&&U.count&&(U=Kj.YAl(z,U))&&U.count){this.ppi(z,U);var ka=new Da.a;for(var Ba of U)ka.add(Ba.TM),ka.add(Ba.Kb);z.zVd(ka);for(let Ia of U)Ba=z.Ra.yS(Ia.TM),Ba.Yu=new dn(Ba,Ia.tG,Object(v.a)(this,this.npj,"handleParagraphSplit")),Ba.isFromErrorRangeSplit=!0,Ba=z.Ra.yS(Ia.Kb),Ba.isDictationCorrectionEnd=!0,Ba.isFromErrorRangeSplit=!0;0<U.count&&this.Pa.raiseEvent("ADCM",new di(z.id,U))}}fag(z){const U=new Da.a;if(z){let ka=null,Ba=-1;for(let Ia=0;Ia<z.Ra.length;Ia++){const Ab=
z.Ra.ga(Ia);Ab.Yu?(Ba=Ab.cp,ka=Ab.Yu.tG):Ab.isDictationCorrectionEnd&&(ka?U.add(new uf(Ba,Ab.cp,ka)):e.ULS.sendTraceTag(593285261,394,10,"Correction range end with no start."),ka=null)}}return U}ojc(z,U){if(z&&U&&U.count){for(let ka of U){let Ba=z.Ra.yS(ka.TM);Ba&&(Ba.Yu=null);if(Ba=z.Ra.yS(ka.Kb))Ba.isDictationCorrectionEnd=!1}this.Pa.raiseEvent("RDCM",new di(z.id,U))}}bpi(z){if(z)for(let U=0;U<z.Ra.length;U++){const ka=z.Ra.ga(U);ka.Yu&&(ka.Yu=null);ka.isDictationCorrectionEnd&&(ka.isDictationCorrectionEnd=
!1)}}cNc(z){if(!z||!Im.SelectionEditor.Vj(z)&&!Im.SelectionEditor.Pg(z))return null;const U=z.node;let ka=z.Qa;z=z.Kb;let Ba=0,Ia=null;for(let Ab=0;Ab<U.Ra.length;Ab++){const Ob=U.Ra.ga(Ab);if(Ob.Yu&&ka>=Ob.cp)Ia=Ob.Yu,Ba=Ob.cp;else if(Ia&&Ob.isDictationCorrectionEnd){if(z<=Ob.cp)return new uf(Ba,Ob.cp,Ia.tG);Ia=null}}return null}ZAl(z,U,ka){if(!z)return!1;z=nf.ParagraphReader.text(z);return Kj.EFh(z,U.source,ka)}k9d(z){if(z){var U=this.fag(z);if(U&&0<U.count){const ka=new Da.a,Ba=nf.ParagraphReader.text(z);
for(let Ia of U)Kj.DFh(Ba,Ia)||ka.add(Ia);this.ojc(z,ka)}}}ppi(z,U){U.ga(0);U.ga(U.count-1);const ka=this.fag(z);let Ba=0,Ia=0;const Ab=new Da.a;for(;Ia<U.count&&Ba<ka.count;){const Ob=U.ga(Ia),Yb=ka.ga(Ba);Ob.Kb<Yb.TM?Ia++:(Yb.Kb>Ob.TM&&Ab.add(Yb),Ba++)}this.ojc(z,Ab)}npj(z,U){const ka=U.ye;for(var Ba=z.Ra.ytb(ka.cp)+1;Ba<z.Ra.length;Ba++){const Ia=z.Ra.ga(Ba);if(Ia.isDictationCorrectionEnd){let Ab;this.ojc(z,(Ab=new Da.a,Ab.add(new uf(ka.cp,Ia.cp,U.tG)),Ab));break}}}grk(z,U){(z=Cf.App.Hb.Hd.nn.vg)&&
(U=z.Fh.te(Zf.a.Mf(U.nodeId)))&&nf.ParagraphReader.Vd(U)&&this.IPk(U)}IPk(z){if(z){var U=0,ka=!1,Ba=!1,Ia=new Da.a;for(let Ab=0;Ab<z.Ra.length;Ab++){const Ob=z.Ra.ga(Ab);Ob.Yu&&(U=Ab,ka=!0);ka&&(Ob.Jp||Ob.bL)&&(Ba=!0);Ob.isDictationCorrectionEnd&&ka&&(ka=!1,Ba&&(Ba=z.Ra.ga(U),Ba.Yu&&Ba.Yu.tG&&Ia.add(new uf(Ba.cp,Ob.cp,Ba.Yu.tG)),Ba.Yu=null,Ba=Ob.isDictationCorrectionEnd=!1))}this.Pa.raiseEvent("RDCM",new di(z.id,Ia))}}static YAl(z,U){if(!U.count)return U;U.Sc((Ba,Ia)=>Ba.TM!==Ia.TM?Ba.TM-Ia.TM:Ba.Kb-
Ia.Kb);z=nf.ParagraphReader.text(z);const ka=new Da.a;for(let Ba=0;Ba<U.count;Ba++){const Ia=U.ga(Ba);if(Ia.TM>z.length||Ia.Kb>z.length)break;if(!Kj.DFh(z,Ia))continue;if(!ka.count){ka.add(Ia);continue}const Ab=ka.ga(ka.count-1);Ia.TM>Ab.Kb?ka.add(Ia):Ab.TM===Ia.TM&&Ab.Kb===Ia.Kb&&Ab.tG.Hek(Ia.tG)}return ka}static EFh(z,U,ka){if(ka+U.length<=z.length){for(let Ba=0;Ba<U.length;Ba++)if(U.charAt(Ba)!==z.charAt(Ba+ka))return!1;return!0}return!1}static DFh(z,U){return!z||U.TM>z.length||U.Kb>z.length||
!U.tG||!U.tG.source?!1:Kj.EFh(z,U.tG.source,U.TM)}}Object(h.a)(Kj,"DictationCorrectionRangeEditor",null,[521]);class te{constructor(){this.EBa=!1}}Object(h.a)(te,"DictationCorrectionSettings",null,[]);var mf=d(14);class zn{constructor(){this.wSb=new mf.ScriptSharpLegacyMap}w1h(z){if(z&&z.count)for(let U of z)U.tG?(z=U.tG.key,this.wSb.Jb(z)||this.wSb.add(z,U.tG)):e.ULS.sendTraceTag(593285260,394,10,"Correction details is null.")}HPk(z){if(z&&z.count)for(let U of z)U.tG?this.wSb.remove(U.tG.key):e.ULS.sendTraceTag(593285259,
394,10,"Correction details is null.")}x2i(z){if(!z)return null;let U;return({value:U}=this.wSb.Rf(z)).returnValue?U:null}clear(){this.wSb=new mf.ScriptSharpLegacyMap}}Object(h.a)(zn,"DictationCorrectionStorage",null,[546]);class Bo{constructor(z,U,ka,Ba,Ia,Ab,Ob){this.Yg=z;this.YMb=U;this.MY=ka;this.Ca=Ba;this.Qc=Ia;this.ef=Ab;this.rk=Ob}ub(){this.Ca.ya(qd.a.mnc,xc.a.Of,Object(v.a)(this,this.rnc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(qd.a.nnc,xc.a.Of,Object(v.a)(this,this.rnc,"takeSuggestedDictationCorrectionAction"));
this.Ca.ya(qd.a.onc,xc.a.Of,Object(v.a)(this,this.rnc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(qd.a.pnc,xc.a.Of,Object(v.a)(this,this.rnc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(qd.a.qnc,xc.a.Of,Object(v.a)(this,this.rnc,"takeSuggestedDictationCorrectionAction"));this.Ca.ya(qd.a.lnc,xc.a.Of,Object(v.a)(this,this.lnc,"takeIgnoreSuggestedDictationCorrection"));this.Ca.ya(qd.a.mnc,xc.a.view,Object(v.a)(this,this.pqb,"collapseIpThenExecuteAction"));this.Ca.ya(qd.a.nnc,xc.a.view,
Object(v.a)(this,this.pqb,"collapseIpThenExecuteAction"));this.Ca.ya(qd.a.onc,xc.a.view,Object(v.a)(this,this.pqb,"collapseIpThenExecuteAction"));this.Ca.ya(qd.a.pnc,xc.a.view,Object(v.a)(this,this.pqb,"collapseIpThenExecuteAction"));this.Ca.ya(qd.a.qnc,xc.a.view,Object(v.a)(this,this.pqb,"collapseIpThenExecuteAction"));this.Ca.ya(qd.a.lnc,xc.a.view,Object(v.a)(this,this.pqb,"collapseIpThenExecuteAction"));this.Ca.he(qd.a.mnc,96);this.Ca.he(qd.a.nnc,96);this.Ca.he(qd.a.onc,96);this.Ca.he(qd.a.pnc,
96);this.Ca.he(qd.a.qnc,96);this.Ca.he(qd.a.lnc,96)}sai(z,U,ka){const Ba=this.rk.ke(15);try{Ba.gd(z);let Ia;this.YMb.ojc(z,(Ia=new Da.a,Ia.add(U),Ia));const Ab=U.tG.suggestions.ga(ka);if(this.YMb.ZAl(z,Ab,U.TM)){const Ob=Ji.a.createTextRange(z,U.TM,U.TM+Ab.source.length);this.Yg.replaceTextRange(Ob,Ab.suggestion);this.MY.rlk(U.tG,ka)}else e.ULS.sendTraceTag(50946527,394,100,"Failed to apply Suggestion")}finally{Ba&&Ba.dispose()}}rnc(z,U,ka){2===ka&&U.Qk&&(ka=this.YMb.cNc(U))&&this.sai(U.node,ka,this.z2i(z));
return 32}pqb(z,U,ka,Ba,Ia){if(2===ka){U=this.Qc.Oa.kb;if(!U)return 2;U=this.ef.Hl(U,!0,!1);return this.Ca.ki(U.Ua,z,ka,!1,Ba,Ia)}return 32}lnc(z,U,ka){if(2===ka&&U.Qk&&(z=this.YMb.cNc(U))){let Ba;this.YMb.ojc(U.node,(Ba=new Da.a,Ba.add(z),Ba));this.MY.ulk(z.tG)}return 32}z2i(z){switch(z){case qd.a.mnc:return 0;case qd.a.nnc:return 1;case qd.a.onc:return 2;case qd.a.pnc:return 3;case qd.a.qnc:return 4;default:return-1}}}Object(h.a)(Bo,"DictationCorrectionsActor",null,[545]);var Ek=d(313),io=d(62);
class Qk{constructor(){this.e2e=this.Da=null}get name(){return"Box4.DictationCorrections"}Wb(z){this.Da=z;this.Da.register(521,"Box4.DictationCorrections.IDictationCorrectionRangeEditor").ma().na(()=>new Kj(this.Da.resolve("Box4.ICharacterPropertiesEditor")));this.Da.register(522,"Box4.DictationCorrections.IDictationCorrectionManager").ma().na(()=>new xm(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),new te,new zn));this.Da.register(523,"Box4.DictationCorrections.IDictationCorrectionContextMenuManager").ma().na(()=>
new Kg(this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor")))}init(){this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager");this.e2e=new Bo(this.Da.resolve("Box4.ICharacterPropertiesEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionRangeEditor"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"),L.AFrameworkApplication.Ta,io.a.instance,Ek.a.instance,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"));this.e2e.ub();
this.UMk(this.Da.Ka("Box4.Accessibility.IAccessibilityContextManager"),this.Da.resolve("Box4.IParagraphReader"),this.Da.resolve("Box4.DictationCorrections.IDictationCorrectionManager"));const z=this.Da.qb("Box4.Proofing.IErrorRangeEditor"),U=this.Da.qb("Box4.DictationCorrections.IDictationCorrectionRangeEditor");L.AFrameworkApplication.fa.ka("WacBox4DictationFloatieIsEnabled")&&z&&U&&z.m6h(Object(v.a)(U,U.grk,"onSpellingErrorRangesChangedEventHandler"));Cf.App.Hb.updateCommandUI()}dispose(){}UMk(z,
U,ka){z&&z.execute(Ba=>{Ba.CXa(new Ae(U,ka))})}}Object(h.a)(Qk,"DictationCorrectionsPackageManager",null,[2,3]);d(1179);d(703);var vl=d(476);class zj{constructor(z,U,ka,Ba=null,Ia=null){this.An=z;this.lG=U;this.UQh=ka;this._id=Ba;this.awd=Ia}get ye(){return this.An}get type(){return this.lG}get nk(){return this.UQh}get id(){return this._id}get osg(){return this.awd}Ud(z){return new zj(z,this.type,this.nk,this.id,this.osg)}toString(){return String.format("Type = {0}, IsStart = {1}, Id = {2}",this.type,
this.nk,this.id?this.id.toString():"<null>")}}Object(h.a)(zj,"IntentObject",null,[167]);d(592);class Co{constructor(z,U,ka,Ba=null,Ia=null){vl.a(z);this.lG=z;this.Sqd=U;this.Dtd=ka;this._id=Ba;this.awd=Ia}get type(){return this.lG}get begin(){return this.Sqd}get end(){return this.Dtd}get id(){return this._id}get osg(){return this.awd}toString(){return String.format("Type = {0}, Begin = {1}, End = {2}, Id = {3}",this.type,this.begin,this.end,this.id?this.id.toString():"<null>")}}Object(h.a)(Co,"IntentRange",
null,[221]);d(352);d(161);d(218);class zh{constructor(z){this.Yg=z}}Object(h.a)(zh,"IntentRangeEditor",null,[520]);class jk{constructor(){this.Da=null}get name(){return"Box4.Intent"}Wb(z){this.Da=z;this.Da.register(zh,"Box4.Intent.IntentRangeEditor").as("Box4.Intent.IIntentRangeEditor").ma().na(()=>new zh(this.Da.resolve("Box4.ICharacterPropertiesEditor")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){ua.a.instance.Bc(new jk)}}Object(h.a)(jk,"PackageManager",null,[2,3]);
var Bp=d(1124),Jm=d(1088),Rk=d(300),Wg=d(1089),Cp=d(913),gj=d(777);class oh{}oh.productionLanguages="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT hi-IN pt-BR fr-CA ja-JP en-IN en-AU".split(" ");oh.previewLanguages="nb-NO da-DK sv-SE fi-FI nl-NL ko-KR pl-PL pt-PT ru-RU th-TH zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");oh.dCl="en-US en-CA en-GB en-AU en-IN en-NZ".split(" ");
oh.edi=["en-US","en-CA","en-GB","en-AU","en-IN"];oh.fdi="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT en-AU en-IN fr-CA pt-BR ja-JP ko-KR hi-IN pl-PL pt-PT ru-RU zh-TW ar-SA he-IL tr-TR ar-BH cs-CZ hu-HU el-GR sk-SK vi-VN sl-SI hr-HR ro-RO lt-LT bg-BG lv-LV et-EE ar-EG zh-HK en-NZ ga-IE mt-MT gu-IN mr-IN ta-IN te-IN".split(" ");oh.MFi="en-US";oh.jIi="btnStartDictation";oh.uIi="btnDictationFloatieToggle";oh.oIi="Dictation";oh.vIi="DictationFloatieToggle";oh.MYf="Insertaudio_32x32x32";oh.LYf=
"Insertaudio_16x16x32";oh.nIi="JotInsertAudioRecordingShort_32x32x32";oh.mIi="JotInsertAudioRecordingShort_16x16x32";oh.Lhl="speechOn.wav";oh.Khl="speechOff.wav";Object(h.a)(oh,"DictationConstants",null,[]);class tk{constructor(z){this.bef=z;this.pLa=(z=oj.a.oe(z))?z.displayName:this.bef;this.fG=z?z.LCID:tk.JUj}get KWc(){return this.bef}get displayName(){return this.pLa}get LCID(){return this.fG}}tk.JUj=1033;Object(h.a)(tk,"DictationLanguage",null,[]);class hj{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc){this.lvc=
null;this.r6e=!1;this.maa=null;this.Cnb=!1;this.Ca=z;this.MY=Cf.App.AZa;this.usc=Cf.App.yZ;this.r1=ka;this.ayc=U;this.Hf=Ba;this.ZO=Ia;this.qg=Ob;this.Kd=uc;this.qg.UK&&(this.maa=Ab);this.DJh=Yb}ub(){this.Ca.pa(qd.a.jbd,xc.a.view,Object(v.a)(this,this.jbd,"populateDictationLanguages"),96);this.Ca.pa(qd.a.zKe,xc.a.view,Object(v.a)(this,this.zKe,"setDictationLanguage"),1028);this.Ca.pa(qd.a.BDe,xc.a.view,Object(v.a)(this,this.BDe,"querySelectedDictationLanguage"),96);this.Ca.pa(qd.a.foc,xc.a.view,Object(v.a)(this,
this.foc,"toggleDictation"),1028);this.Ca.pa(qd.a.WCe,xc.a.view,Object(v.a)(this,this.WCe,"queryDictation"),96);this.Ca.pa(qd.a.IYf,xc.a.view,Object(v.a)(this,this.qDb,"onDictationError"),64);this.Ca.pa(qd.a.NYf,xc.a.view,Object(v.a)(this,this.qDb,"onDictationError"),64);this.Ca.pa(qd.a.QYf,xc.a.view,Object(v.a)(this,this.zlk,"onDictationRecordingStarted"),64);this.Ca.pa(qd.a.RYf,xc.a.view,Object(v.a)(this,this.Alk,"onDictationRecordingStopped"),64);this.Ca.pa(qd.a.OYf,xc.a.view,Object(v.a)(this,
this.ylk,"onDictationModifyRunLanguage"),64);this.Ca.pa(qd.a.KYf,xc.a.view,Object(v.a)(this,this.xlk,"onDictationFocusLost"),64);this.Ca.pa(qd.a.TYf,xc.a.view,Object(v.a)(this,this.Zlk,"onFailedToInsertText"),64);this.Ca.pa(qd.a.PYf,xc.a.view,Object(v.a)(this,this.Clk,"onDictationTimeout"),64);this.Ca.pa(qd.a.f7g,xc.a.view,Object(v.a)(this,this.jbd,"populateDictationLanguages"),96);this.Ca.pa(qd.a.AKe,xc.a.view,Object(v.a)(this,this.AKe,"setDictationSettingsLanguage"),1028);this.Ca.pa(qd.a.XCe,xc.a.view,
Object(v.a)(this,this.XCe,"queryDictationSettingsLanguage"),96);this.Ca.pa(qd.a.qIi,xc.a.view,Object(v.a)(this,this.showHelpPane,"showHelpPane"),96);this.Ca.pa(qd.a.rIi,xc.a.view,Object(v.a)(this,this.showHelpPane,"showHelpPane"),96);this.Ca.pa(qd.a.pIi,xc.a.view,Object(v.a)(this,this.Pol,"toggleAutoPunctuation"),96);this.Ca.pa(qd.a.JEk,xc.a.view,Object(v.a)(this,this.TFk,"queryToggleAutoPunctuation"),96);this.Ca.pa(qd.a.sIi,xc.a.view,Object(v.a)(this,this.bpl,"toggleVoiceCommands"),96);this.Ca.pa(qd.a.KEk,
xc.a.view,Object(v.a)(this,this.VFk,"queryToggleVoiceCommands"),96);this.Ca.pa(qd.a.hmd,xc.a.view,Object(v.a)(this,this.hmd,"toggleDictationInFloatie"),1028);this.Ca.pa(qd.a.JYf,xc.a.view,Object(v.a)(this,this.wlk,"onDictationFloatieDismissed"),1028);this.Ca.pa(qd.a.lIi,xc.a.view,Object(v.a)(this,this.Uok,"onPauseDictationCommand"),96);this.Ca.pa(qd.a.kIi,xc.a.view,Object(v.a)(this,this.Xlk,"onExitDictationCommand"),96);const z=cc.KeyInputManager.Na(Bg.a.qFh,1);this.Kd.Dc(Td.AFrame.jj).bindAction(z,
qd.a.SYf);this.Ca.pa(qd.a.SYf,xc.a.view,Object(v.a)(this,this.Blk,"onDictationShortcut"),1028)}bNc(){return L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.Up?this.qg.UK?oh.vIi:oh.oIi:this.qg.UK?oh.uIi:oh.jIi}WCe(z,U,ka,Ba,Ia){if(1===ka)return 32;Ia&&(z=!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.Up,this.maa?Ia[z?jg.a.On:Jm.a.On]=this.maa.isVisible():(ka=this.r1.fI(),ka=(U=2===ka)||1===ka,z?(Ia[jg.a.On]=ka,Ia[Rk.a.IconSet]=U?(new Wg.a("JotInsertAudioRecordingShort_20")).iconSet:
L.AFrameworkApplication.Aa.jb.una?(new Wg.a("InsertAudio_32")).iconSet:(new Wg.a("InsertAudio_20",null,null,"InsertAudio_32")).iconSet):(Ia[Jm.a.On]=ka,U?(Ia[Jm.a.Image32by32Class]=fj.getImageClass(oh.nIi),Ia[Jm.a.Image16by16Class]=fj.getImageClass(oh.mIi)):(Ia[Jm.a.Image32by32Class]=fj.getImageClass(oh.MYf),Ia[Jm.a.Image16by16Class]=fj.getImageClass(oh.LYf)))));return 32}foc(z,U,ka){if(2===ka)if(this.maa)this.Qyh();else return this.jWd();return 32}hmd(z,U,ka){return 2!==ka?32:this.jWd()}jbd(z,U,
ka,Ba,Ia){if(1===ka)return 32;this.tyk(Ia,z===qd.a.f7g);return 32}BDe(z,U,ka,Ba,Ia){if(1===ka)return 32;Ia&&((z=Ia.MenuItemId)&&z===this.qg.mS?(Ia[jg.a.On]=!0,this.lvc=Ia.SourceControlId):Ia[jg.a.On]=!1);return 32}XCe(z,U,ka,Ba,Ia){if(1===ka)return 32;Ia&&(Ia[Cp.a.Value]=(new tk(this.qg.mS)).displayName);return 32}zKe(z,U,ka,Ba,Ia){if(1===ka)return 32;Ia&&(z=Ia.SourceControlId,this.lvc!==z&&(this.qg.mS=Ia.MenuItemId,this.BDh(this.lvc),this.BDh(z),this.lvc=z,2===this.r1.fI()&&this.wU()));return 32}AKe(z,
U,ka,Ba,Ia){if(1===ka)return 32;if(Ia){z=Ia.MenuItemId;if(this.qg.mS!==z){this.qg.mS=z;if(this.maa)this.maa.onDictationLanguageChanged(z);2===this.r1.fI()&&this.wU()}this.XUe()}return 32}showHelpPane(z,U,ka,Ba,Ia){if(1===ka)return 32;z=this.DJh.value;if(!z)return 0;Ia&&(Ia={},Ia.query="AssetID="+(this.qg.Hzl?hj.QOh:hj.kvd),Ia=Object.assign(new Bp.a,{nonPersistedSettings:Ia}),z.nJa(hj.jvd,Ia));return 32}Pol(z,U,ka,Ba,Ia){if(1===ka)return this.qg.W9d?32:8;Ia&&this.qg&&(this.qg.useAutoPunctuation=Ia[jg.a.On]);
2===this.r1.fI()&&this.wU();this.XUe();return 32}bpl(z,U,ka,Ba,Ia){if(1===ka)return this.qg.bde?32:8;Ia&&this.qg&&(this.qg.WKb=Ia[jg.a.On]);2===this.r1.fI()&&(this.r1.wU(),this.AKb());this.bDh();return 32}TFk(z,U,ka,Ba,Ia){if(1===ka)return 32;Ia&&this.qg&&(Ia[jg.a.On]=this.qg.useAutoPunctuation);return 32}VFk(z,U,ka,Ba,Ia){if(1===ka)return 32;Ia&&this.qg&&(Ia[jg.a.On]=this.qg.WKb);return 32}wlk(z,U,ka){2===ka&&this.sJc();return 32}Uok(z,U,ka){2===ka&&this.qg.UK&&2===this.r1.fI()&&this.wU();return 32}Xlk(z,
U,ka){2===ka&&this.qg.UK&&this.sJc();return 32}v1h(){const z=Object.assign(new mh.a,{Title:"",ShowMenuSectionSeparator:!0,DisplayMode:"Menu",Id:"dictationButton",ControlsId:"ctrDictationButton",ControlList:[]}),U=Object.assign(new W.a,{Id:"DictationLanguageList_"+this.bNc(),ExternalId:"DictationLanguageList_"+this.bNc(),LabelText:Box4Intl.Box4Strings.L_DictationRibbonLabel,Command:"1394650145",MenuItemId:this.bNc(),QueryCommand:"2417470717",Image16by16Class:fj.getImageClass(oh.LYf),Image32by32Class:fj.getImageClass(oh.MYf),
Visible:!0,AriaLabel:ab.a.Xbi});Array.add(z.ControlList,U);return z}tyk(z,U){z.MenuItems=Object.assign(new jh.a,{Id:U?"DictationSettingsLanguageList":"DictationLanguageList",MenuSectionList:[],UpdateDynamically:!0});if(!U){var ka=this.v1h();Array.add(z.MenuItems.MenuSectionList,ka)}ka=this.qg.P9g;0<ka.length&&(ka=hj.OGc(ka,"dictationProdcutionLanguages","",U),Array.add(z.MenuItems.MenuSectionList,ka));ka=this.qg.L8g;0<ka.length&&(U=hj.OGc(ka,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,
U),Array.add(z.MenuItems.MenuSectionList,U));z.PopulationXML=Ve.l(z.MenuItems);this.r6e=!0}AKb(){const z=this.ayc.value;if(z){const U=this.bNc();if(L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.Up){const ka={};ka[U]=this.qg.UK?"ToggleButtonModel":"SplitButtonModel";this.r6e&&!this.qg.UK&&(ka["DictationLanguageList_"+U]="ToggleButtonModel");z.xKb(ka)}this.XUe();this.bDh()}}XUe(){if(this.qg.UK){const z=this.ayc.value;L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.Up&&z.xKb({DictationSettingsAutoPunctuation:"CheckboxModel"})}}bDh(){if(this.qg.UK){const z=
this.ayc.value;L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.Up&&z.xKb({DictationSettingsVoiceCommands:"CheckboxModel"})}}BDh(z){const U=this.ayc.value;if(U&&L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.Up){const ka={};ka[z]="ToggleButtonModel";U.xKb(ka)}}qDb(z,U,ka){2===ka&&(this.qg.UK?this.sJc():this.wU());return 32}Zlk(z,U,ka){2===ka&&this.wU();return 32}zlk(z,U,ka){2===ka&&this.AKb();return 32}Alk(z,U,ka){2===ka&&(this.r1.wU(),this.AKb());return 32}ylk(z,U,ka,Ba,Ia){2===
ka&&Ia&&(z=oj.a.oe(this.qg.mS),this.Hf.Zkc(this.ZO.Ls(Ia),z.LCID,Ia.Kb));return 32}xlk(z,U,ka){2===ka&&this.wU();return 32}Clk(z,U,ka){2===ka&&this.wU();return 32}Qyh(){this.Cnb||(this.Cnb=!0,this.maa.isVisible()?(this.sJc(),this.Cnb=!1):this.showFloatie(),this.AKb())}showFloatie(){this.maa.showFloatie((new tk(this.qg.mS)).displayName).then(()=>{0===this.r1.fI()&&this.r1.Hhb().then(()=>{this.Cnb=!1}).catch(z=>{this.Cnb=!1;e.ULS.sendTraceTag(577901849,394,10,"Failed to start dictation {0}",z)});this.qg.K4b&&
this.MY&&this.MY.Hil();this.usc&&this.usc.startSession()}).catch(()=>{this.Cnb=!1})}jWd(){const z=this.r1.fI();if(1===z||3===z)return 1;0===z?this.Hhb():this.wU();return 32}sJc(){const z=this.r1.fI();1!==z&&(this.maa&&this.maa.hideFloatie(),this.MY&&this.MY.wjl(),0!==z&&this.wU(),this.usc&&this.usc.endSession(),this.AKb())}wU(){this.r1.wU();this.AKb()}Hhb(){this.r1.Hhb().then(()=>{}).catch(z=>{e.ULS.sendTraceTag(577901848,394,10,"Failed to start dictation {0}",z)})}Blk(z,U,ka){return 2===ka&&this.qg&&
this.qg.gHj?this.qg.UK&&this.maa&&!this.maa.isVisible()?(this.Qyh(),32):this.jWd():32}static createInstance(z,U,ka,Ba,Ia,Ab,Ob,Yb){return hj.Ja||(hj.Ja=new hj(L.AFrameworkApplication.Ta,z,U,ka,Ba,Ia,Ab,Ob,Yb))}static OGc(z,U,ka,Ba){ka=Object.assign(new mh.a,{DisplayMode:"Menu",Title:ka,Id:U,ControlsId:"ctr"+U,ControlList:[]});for(const Ia of z){z=U+"_"+Ia.KWc;const Ab=Ia.displayName,Ob=Ia.KWc;Ba?(z=Object.assign(new gj.a,{Id:z,ExternalId:z,LabelText:Ab,Command:"3662249320",MenuItemId:Ob,Visible:!0}),
Array.add(ka.ControlList,z)):(z=Object.assign(new W.a,{Id:z,ExternalId:z,LabelText:Ab,Command:"2863762275",MenuItemId:Ob,QueryCommand:"2739750502",Visible:!0,AriaLabel:ab.a.Qob}),Array.add(ka.ControlList,z))}return ka}}hj.Ja=null;hj.jvd="FA000000012";hj.kvd="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c";hj.QOh="78766431-0933-4603-abf5-5bcc1dee9dda";Object(h.a)(hj,"DictationActor",null,[555]);var Fi=d(269),An=d(1086),Lj=d(154);class jo{constructor(z,U){this.NY=null;this.waa=!1;this.iLa=null;this.yMh=z;this.qg=
U}isVisible(){return this.waa}USc(){return this.waa&&!!this.NY}INi(){if(this.NY)return!0;this.NY=this.yMh.value;if(!this.NY)return!1;this.NY.IGl(qd.a.hmd);this.NY.BGl(qd.a.JYf);Gf.a.addHandler(window.self,bc.a.resize,()=>{this.rsj()});const z=cd.FocusManager.instance().Dc(Lj.AppFrame.s5a);z.bba(U=>{this.EVi(U)});z.rAa((U,ka)=>{this.DVi(ka)});z.cL=!0;z.IHe=!0;Fi.a.instance.P1(Lj.AppFrame.s5a,!0);Fi.a.instance.zo(Lj.AppFrame.s5a);return!0}EVi(z){this.USc()&&z.name!==Td.AFrame.tO&&this.NY.focus()}DVi(z){this.USc()&&
z.name!==Td.AFrame.tO&&this.NY.blur()}showFloatie(z){return this.waa?Promise.resolve(null):this.INi()?new Promise((U,ka)=>{this.NY.DFl().then(()=>{this.NY.showDictationFloatie(this.wNc(),!1,z,this.qg.useAutoPunctuation);this.iLa=z;this.waa=!0;Fi.a.instance.lK(Lj.AppFrame.s5a);U(null)}).catch(()=>{ka("failed to intialize the floatie")})}):Promise.reject("Unable to find the dictation floatie controller")}hideFloatie(){this.USc()&&(this.NY.dismissDictationFloatie(),Fi.a.instance.zo(Lj.AppFrame.s5a),
this.waa=!1)}showDictationWarning(z){this.USc()&&this.NY.showDictationWarning(z)}onDictationLanguageChanged(z){this.iLa=z}wNc(){var z=Cf.App.Hb.y5a.getBoundingClientRect();const U=z.left+z.width/2-44;z=z.top+z.height-70;return Object.assign(new An.a,{x:U,y:z})}rsj(){this.waa&&this.NY&&(this.NY.dismissDictationFloatie(),this.NY.showDictationFloatie(this.wNc(),!1,this.iLa,this.qg.useAutoPunctuation))}}Object(h.a)(jo,"DictationFloatieManager",null,[]);class ym{constructor(){this.Iga=this.sza=0;this.Ssc=
null;this.zaa=!0;this.hqc="";this.qg=this.Dh=null;this.tza=this.Eaa=this.BLa=this.qt=this.Fj=0;this.Gtd=this.GY="";this.qRb=this.wMb=0;this.$td=this.qud=this.pud=!1;this.rEd="";this.ZQb=this.XNb=this.Vh=this.q1=null;this.psd=this.Nvc=this.Mvc=this.SFd=this.Mzf=this.P2a=this.N2a=0}set Nui(z){this.GY=z}get Wwa(){return Cf.App.yZ?Cf.App.yZ.Wwa:""}get NZa(){return Cf.App.yZ?Cf.App.yZ.NZa:""}set NZa(z){Cf.App.yZ&&(Cf.App.yZ.NZa=z)}onFragment(z){this.BLa||(this.BLa=(new Date).getTime());this.XNb&&(this.XNb.stop(),
this.N2a+=this.XNb.Kq,this.XNb.start());this.sza++;this.tza+=z.split(" ").length}onFinalPhrase(z){this.BLa||(this.BLa=(new Date).getTime());this.ZQb&&(this.ZQb.stop(),this.P2a+=this.ZQb.Kq,this.ZQb.start());this.tza=0;this.Iga++;this.Eaa+=z.split(" ").length}onConnectionStarted(z){this.wMb=(new Date).getTime();this.Nui=z;this.Vh&&(this.XNb=this.Vh.zi("WebServiceCall","FragmentResponse"),this.ZQb=this.Vh.zi("WebServiceCall","PhraseResponse"))}onRecordingStarted(){this.qRb=(new Date).getTime()}onMicrophoneError(z){this.onCustomError("MicrophoneError",
z)}onCustomError(z,U=null){this.zaa=!1;this.Ssc=z;this.setEndReason(U||z)}setEndReason(z){this.Gtd=z}onTextInsertionError(){this.onCustomError("FailedToInsertText")}onTextInserted(z,U){this.psd=U;z?(this.SFd+=U,U>this.Nvc&&(this.Nvc=U)):(this.Mzf=U,U>this.Mvc&&(this.Mvc=U))}onFocusLost(){this.pud=!0}onFocusLostWhileStarting(){this.qud=!0}onFailedToStartTurn(){this.$td=!0}onSpeechSessionStarted(z){this.rEd=z}setDictationLatency(z){this.q1=z}endActivity(){}onCommandCalled(){}onAugloopError(){}onFinalResultAnnotationResponse(){}onPartialResultAnnotationResponse(){}setRecordingStartTime(){}onCommandError(){}setCurFinalResultAnnotationResponseTime(){}calculateMaxAndMinFinalResultUserPerceivedLatency(){}setCurPartialResultAnnotationResponseTime(){}calculateMaxAndMinPartialResultUserPerceivedLatency(){}setFirstAudioChunkStartTime(){}setMicrophoneWarmUpLatency(){}getDictationStartTime(){}}
Object(h.a)(ym,"AbstractDictationSessionTelemetry",null,[585]);class Ol{}Ol.seen="Seen";Ol.tried="Tried";Ol.kept="Kept";Object(h.a)(Ol,"FunnelStatus",null,[]);class wl{constructor(){this.dataFields=this.name=null}}Object(h.a)(wl,"Contract",null,[]);class Bn extends ym{constructor(z,U){super();this.O_e=this.N_e=this.OYe=!1;this.fzd=this.azd=this.jCd=0;this.pzd=this.ozd=2147483647;this.RFd=this.PFd=0;this.qg=z;this.Fj=(new Date).getTime();this.Vh=U;this.NZa=C.a.create().toString();this.Dh=new bn.a;
this.Dh.dataFields=[];this.hqc="Office.Voice.Online.ALDictationSession"}onFinalResultAnnotationResponse(z,U,ka){z=z+this.psd-(this.jCd+(U+ka)/1E4);this.PFd+=z;this.azd<z&&(this.azd=z);this.ozd>z&&(this.ozd=z)}onPartialResultAnnotationResponse(z,U,ka){z=z+this.psd-(this.jCd+(U+ka)/1E4);this.RFd+=z;this.fzd<z&&(this.fzd=z);this.pzd>z&&(this.pzd=z)}setRecordingStartTime(z){this.jCd=z}onCommandCalled(){this.N_e=!0}onAugloopError(z){this.zaa=!1;this.OYe=!0;this.Ssc=z}onCommandError(){this.O_e=!0}endActivity(){this.Eaa+=
this.tza;this.qt=(new Date).getTime();this.Dh.succeeded=this.zaa;this.Dh.durationMs=this.qt-this.Fj;Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"Success",bool:this.zaa}));this.zaa||Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"error",string:this.Ssc}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"SessionID",string:this.Wwa}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"SpeechSessionID",string:this.rEd}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,
{name:"TurnID",string:this.NZa}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"NumberOfWords",int64:0<this.tza?this.tza+this.Eaa:this.Eaa}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"NumberOfFragments",int64:this.sza}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"NumberOfFinalPhrases",int64:this.Iga}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"Language",string:this.qg.mS}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"connectionID",
string:this.GY}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"IsUsingFloatie",bool:this.qg.UK}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"UseAutoPunctuation",bool:this.qg.useAutoPunctuation}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"EndReason",string:this.Gtd}));this.BLa&&Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"TimeToGetFirstResult",int64:this.BLa-
this.wMb}));this.zaa&&(Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"TimeToStartRecording",int64:this.qRb-this.Fj})),Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"TimeToOpenConnection",int64:this.wMb-this.qRb})));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"FocusLost",bool:this.pud}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"FocusLostWhileStarting",bool:this.qud}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"FailedToStartTurn",
bool:this.$td}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"MaxTimeToInsertFragment",int64:this.Mvc}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"MaxTimeToInsertPhrase",int64:this.Nvc}));var z=Ol.seen;this.zaa&&0<this.Eaa&&(z=0<this.Iga?Ol.kept:Ol.tried);Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"DictationFunnel",contract:Object.assign(new wl,{name:"Office.System.Funnel",dataFields:[Object.assign(new hf.a,{name:"Name",string:"Dictation"}),Object.assign(new hf.a,
{name:"State",string:z})]})}));this.Dh.name=this.hqc;this.Dh.samplingPolicy=2;Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"AugloopFailed",bool:this.OYe}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"CommandsUsed",bool:this.N_e}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"CommandsFailed",bool:this.O_e}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"MaxFinalResultUserPerceivedLatency",int64:this.azd}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,
{name:"MinFinalResultUserPerceivedLatency",int64:this.ozd}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"MaxPartialResultUserPerceivedLatency",int64:this.fzd}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"MinPartialResultUserPerceivedLatency",int64:this.pzd}));z=0<this.Iga?this.PFd/this.Iga:0;const U=0<this.sza?this.RFd/this.sza:0;Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"AverageFinalResultUserPerceivedLatency",double:z}));Array.add(this.Dh.dataFields,
Object.assign(new hf.a,{name:"AveragePartialResultUserPerceivedLatency",double:U}));wi.a.sendActivityEvent(this.Dh)}}Object(h.a)(Bn,"AugloopDictationTelemetry",ym,[]);var ko=d(211);class th{constructor(z){this.U5=z}play(){this.U5.play()}pause(){this.U5.pause()}get paused(){return this.U5.paused}get currentTime(){return this.U5.currentTime}set currentTime(z){this.U5.currentTime=z}get duration(){return this.U5.duration}get error(){const z=this.U5.error;return z?z.code:0}get readyState(){return this.U5.readyState}get src(){return this.U5.getAttribute("src")}set src(z){this.U5.setAttribute("src",
z)}get preload(){return this.U5.getAttribute("preload")}set preload(z){this.U5.setAttribute("preload",z)}get Uf(){return this.U5}}Object(h.a)(th,"AudioElement",null,[]);class Sc{constructor(){this.fAd=this.eAd=this.P2a=this.N2a=this.dtd=0}onAudioData(){this.dtd||(this.dtd=(new Date).getTime())}onFragment(z){this.N2a+=this.ohg(z);this.eAd++}Wok(z){this.P2a+=this.ohg(z);this.fAd++}Y8f(){return this.fAd?this.P2a/this.fAd:0}E_i(){return this.eAd?this.N2a/this.eAd:this.Y8f()}ohg(z){if(!z)return 0;const U=
(new Date).getTime();let ka=null;return({ou:ka}=Q.d(z)).returnValue?U-this.dtd-(ka.Offset+ka.Duration)/1E4:0}}Object(h.a)(Sc,"DictationLatency",null,[]);class Of{constructor(z,U){this.g6=0;this.pEd=this.qEd=null;this.nPb=!1;this.Tvc=null;this.wuc=!1;this.q1=this.Jq=null;this.aG=U;this.raa=z}onFinalText(z,U){if(2===this.g6){var ka=z.size;if(1!==ka&&(e.ULS.sendTraceTag(51442337,394,10,"Final text mapping has invalid size of {0}",ka),!ka))return;U=U.get("JsonResult");this.q1&&this.q1.Wok(U);this.aG.onFinalPhrase(z.values().next().value,
U)}}onFragmentText(z,U){if(2===this.g6){var ka=z.size;if(1!==ka&&(e.ULS.sendTraceTag(51442338,394,10,"Fragment text mapping has invalid size of {0}",ka),!ka))return;U=U.get("JsonResult");if(this.q1)this.q1.onFragment(U);this.aG.onFragment(z.values().next().value)}}onError(z){if(0!==this.g6&&3!==this.g6&&"ErrorNone"!==z){this.g6=3;switch(z){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.aG.cjk(z);
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.aG.Vkk(z);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.aG.NL(z);break;case "ErrorInitialSilenceTimeout":this.aG.jnk(z);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":case "ErrorAudioCaptureAsync":this.aG.onMicrophoneError(z);break;
case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":this.aG.Cxe("NotAllowedError");break;case "ErrorAudioNotFoundError":case "ErrorAudioDevicesNotFoundError":this.aG.Cxe("NotFoundError");break;case "ErrorAudioNotReadableError":this.aG.Cxe("NotReadableError");break;default:this.aG.Nrk(z)}this.g6=0}}onSpeechRecognitionStarted(z){window.self.document.hasFocus()?(this.g6=2,this.nPb=!1,this.aG.onRecordingStarted(),this.aG.onConnectionStarted(z),this.qEd||
(this.qEd=Object.assign(new th(document.createElement("audio")),{src:ko.a.box4Image(oh.Lhl)})),this.qEd.play()):(this.FUe(),this.aG.onFocusLost())}onSpeechEnd(){this.FUe();0!==this.fI()&&(this.g6=3,this.aG.wpk(),this.g6=0,this.pEd||(this.pEd=Object.assign(new th(document.createElement("audio")),{src:ko.a.box4Image(oh.Khl)})),this.pEd.play())}onAudioData(z){if(this.q1)this.q1.onAudioData();if(this.raa){var U=0;for(const ka of z)U+=Math.pow(ka,2);z=Math.sqrt(U/z.length)>Of.yhl;!this.nPb&&z?(this.nPb=
!0,this.Tvc=null):this.nPb&&!z&&(this.Tvc?(new Date).getTime()>=this.Tvc+Of.ffk&&(this.nPb=!1):this.Tvc=(new Date).getTime())}}onSpeechSessionStarted(z){this.aG.onSpeechSessionStarted(z)}onEventUpdate(z){if(this.raa&&"QualityStatusUpdate"===z.eventName)switch(z.shortCode){case 13:case 2:this.raa.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningLowSoundLevel);break;case 3:case 4:this.raa.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningTooMuchNoise);break;case 8:case 6:case 7:this.raa.showDictationWarning(Box4Intl.Box4Strings.L_DictationWarningCheckNetworkConnection)}}iZa(z,
U){this.aG.OPa(!1);this.aG.vx=z;this.aG.ytg=U;this.iNk();this.Jq=z;this.g6=1;this.q1=new Sc;this.Jq&&this.Jq.setDictationLatency(this.q1)}fI(){return this.g6}iNk(){this.wuc||(Gf.a.addHandler(window.self,bc.a.blur,Object(v.a)(this,this.Q_g,"onFocusLostEventHandler")),this.wuc=!0)}FUe(){this.wuc&&(Gf.a.removeHandler(window.self,bc.a.blur,Object(v.a)(this,this.Q_g,"onFocusLostEventHandler")),this.wuc=!1)}Q_g(){if(1===this.g6){if(this.Jq)this.Jq.onFocusLostWhileStarting()}else 2===this.g6&&(this.FUe(),
this.aG.onFocusLost())}}Of.yhl=350;Of.ffk=350;Object(h.a)(Of,"FrontdoorSpeechClientObserver",null,[588]);class zc extends Of{constructor(z,U){super(z,U);this.CLa=new Of(z,U)}onFinalText(z,U){this.CLa.onFinalText(z,U)}onFragmentText(z,U){this.CLa.onFragmentText(z,U)}onError(z){this.CLa.onError(z)}onSpeechRecognitionStarted(z){this.CLa.onSpeechRecognitionStarted(z)}onSpeechEnd(){this.CLa.onSpeechEnd()}onAudioData(z){this.CLa.onAudioData(z)}iZa(z,U){this.CLa.iZa(z,U)}fI(){return this.CLa.fI()}}Object(h.a)(zc,
"AugloopFrontdoorSpeechObserverAbstractDecorator",Of,[]);class Ni extends zc{constructor(z,U,ka){super(z,U);this.Qc=ka}onFinalText(z,U){super.onFinalText(z,U)}onFragmentText(z,U){if(this.$be())super.onFragmentText(z,U)}onError(z){super.onError(z)}onSpeechRecognitionStarted(z=null){const U=C.a.create().toString();super.onSpeechRecognitionStarted(z?z:U)}onSpeechEnd(){super.onSpeechEnd()}onAudioData(z){super.onAudioData(z)}iZa(z,U){super.iZa(z,U)}fI(){return super.fI()}$be(){const z=this.Qc.Oa.kb.Ua;
return z.Kb!==z.Qa?!1:!0}}Object(h.a)(Ni,"AugloopFrontdoorSpeechObserverDecorator",zc,[]);class Wd{constructor(z){this.rBf=z}onVoiceCommand(z){this.rBf.onVoiceCommand(z)}setDictationSessionTelemetry(z){this.rBf.setDictationSessionTelemetry(z)}}Object(h.a)(Wd,"AugloopVoiceCommandObserverAbstractDecorator",null,[586]);class Do extends Wd{constructor(z,U,ka){super(z);this.n1=U;this.Qc=ka}onVoiceCommand(z){this.$be()&&this.n1.VGl();super.onVoiceCommand(z)}setDictationSessionTelemetry(z){super.setDictationSessionTelemetry(z)}$be(){const z=
this.Qc.Oa.kb.Ua;return z.Kb!==z.Qa?!1:!0}}Object(h.a)(Do,"AugloopVoiceCommandObserverDecorator",Wd,[]);class xl{constructor(z){this.qg=z}hDg(z){const U=L.AFrameworkApplication.Ge;if(U){var ka=this.qg.L7f;ka&&""!==ka&&U.yj(String.format("https://{0}/SpeechHandler.ashx?action=SendCorrectionTelemetry",ka),2,z,{["Content-Type"]:"application/json; charset=utf-8"},!1,3,()=>{},()=>{},null)}}}Object(h.a)(xl,"FrontdoorCorrectionsTelemetryLogger",null,[587]);class Eg{constructor(){this.properties=this.useCorrections=
this.useAutoPunctuation=this.dictationLanguage=null}}Object(h.a)(Eg,"SpeechDictationSettings",null,[]);class Eo{constructor(z,U,ka,Ba){this.ctd=this.qy=null;this.n1=z;this.raa=U;this.aG=ka;this.lkb=Ba;this.initializeCommandsDictionary()}onVoiceCommand(z){if(this.ctd)this.ctd.onCommandCalled();var U=4;if(({value:U}=this.qy.Rf(z.commandId,0)).returnValue&&4!==U){let ka=null;z.commandValue&&(ka=new m.a(r.a.Tq()),ka.add("commandValue",z.commandValue));this.aG.OPa(!1);U=this.n1.executeCommand(U,ka);if(z.offset&&
z.duration)this.lkb.onCommandFinished(z.commandId,U,z.offset,z.duration)}}setDictationSessionTelemetry(z){this.ctd=z}initializeCommandsDictionary(){this.qy=new m.a(r.a.Tq());this.qy.add("Word.Editing.Undo",2);this.qy.add("Word.Editing.Bold",5);this.qy.add("Word.Editing.Italics",6);this.qy.add("Word.Editing.Underline",10);this.qy.add("Word.Editing.StrikeThrough",20);this.qy.add("Word.Editing.Subscript",19);this.qy.add("Word.Editing.Superscript",18);this.qy.add("Word.Editing.RemoveBold",11);this.qy.add("Word.Editing.RemoveUnderline",
13);this.qy.add("Word.Editing.RemoveItalics",12);this.qy.add("Word.Editing.RemoveStrikeThrough",21);this.qy.add("Word.Editing.RemoveSubscript",22);this.qy.add("Word.Editing.RemoveSuperscript",24);this.qy.add("Word.Editing.Paste",7);this.qy.add("Word.Editing.InsertTable",8);this.qy.add("Word.Editing.InsertComment",9);this.qy.add("Word.Editing.InsertBullet",23);this.qy.add("Word.Editing.FullJustify",14);this.qy.add("Word.Editing.CenterJustify",15);this.qy.add("Word.Editing.LeftJustify",16);this.qy.add("Word.Editing.RightJustify",
17);this.qy.add("Command.Exit",1);this.qy.add("Command.Pause",0);this.qy.add("Command.ShowHelp",26);this.qy.add("Command.ShowCommand",27);this.qy.add("Word.Editing.RemoveFormatting",28)}}Object(h.a)(Eo,"VoiceCommandObserver",null,[586]);var Sh=d(943);class dk{constructor(z,U,ka,Ba,Ia,Ab,Ob){this.Jq=this.lTb=null;this.kwj=0;this.lkb=Ia;this.qg=Ob;Ia=new Eg;Ia.dictationLanguage=Ob.mS;Ia.useAutoPunctuation=Ob.useAutoPunctuation?"Intelligent":"Explicit";Ia.useCorrections=Ob.K4b.toString();alVoiceClient.DictationSettingsManager.dictationSettings=
Ia;this.H6=new Ni(z,Ab,Ba);this.sBf=new Do(new Eo(U,z,Ab,this.lkb),U,Ba);this.Gqc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.qYe=Array(ka);this.Gqc.setAnnotationResultCallback(Object.assign(new Sh.a,{handler:Yb=>{for(const uc of this.qYe)uc.onAnnotationResult(Yb)}}));this.qSb=new alVoiceClient.SpeechToTextClient(this.Gqc,this.H6,Ob.Yib||Ob.kod,!1);this.HCf(this.qSb.getAnnotationObserver());this.kTb=new alVoiceClient.VoiceCommandingClient(this.Gqc,this.sBf,this.H6);this.HCf(this.kTb.getAnnotationObserver());
Ob.K4b&&(z=new xl(Ob),(U=Cf.App.AZa)&&U.Bdh(z))}Dog(z,U){return new Promise(ka=>{const Ba=new Eg;Ba.dictationLanguage=z;Ba.useAutoPunctuation=this.qg.useAutoPunctuation?"Intelligent":"Explicit";alVoiceClient.DictationSettingsManager.dictationSettings=Ba;this.Jq=U;ka(this.vzj())})}Hhb(z){if(!this.qSb)return 3;this.lTb.startVoiceSessionFromMicrophoneInput();this.H6.iZa(this.Jq,z);z=this.qg.WKb;this.qSb.initializeAsync(z?[1]:[1,0],this.Jq);z&&this.kjl();return 0}wU(z){if(z&&this.H6)this.H6.onSpeechEnd();
this.qSb&&this.qSb.uninitializeAsync();this.lTb&&(this.lTb.stopVoiceSession(),this.lTb=null);this.Jq=null;this.qg.WKb&&this.Jjl()}fI(){return this.H6.fI()}vzj(){this.qg.WKb&&this.sBf.setDictationSessionTelemetry(this.Jq);this.lTb=new alVoiceClient.VoiceSession(this.Gqc,this.H6,this.qg.Yib,this.lkb,this.Jq);return 0}kjl(){this.kTb&&this.kTb.initializeAsync(this.Jq)}Jjl(){this.kTb&&this.kTb.uninitializeAsync()}HCf(z){this.qYe[this.kwj++]=z}}Object(h.a)(dk,"AugloopSpeechClientProxy",null,[567]);class Sk extends ym{constructor(z,
U){super();this.qg=z;this.Fj=(new Date).getTime();this.Vh=U;this.NZa=C.a.create().toString();this.Dh=new bn.a;this.Dh.dataFields=[];this.hqc="Office.Voice.Online.DictationSession"}endActivity(){this.Eaa+=this.tza;this.qt=(new Date).getTime();this.Dh.succeeded=this.zaa;this.Dh.durationMs=this.qt-this.Fj;Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"Success",bool:this.zaa}));this.zaa||Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"error",string:this.Ssc}));Array.add(this.Dh.dataFields,
Object.assign(new hf.a,{name:"SessionID",string:this.Wwa}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"SpeechSessionID",string:this.rEd}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"TurnID",string:this.NZa}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"NumberOfWords",int64:0<this.tza?this.tza+this.Eaa:this.Eaa}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"NumberOfFragments",int64:this.sza}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,
{name:"NumberOfFinalPhrases",int64:this.Iga}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"Language",string:this.qg.mS}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"connectionID",string:this.GY}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"IsFrontdoor",bool:!0}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"IsUsingFloatie",bool:this.qg.UK}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"UseAutoPunctuation",bool:this.qg.useAutoPunctuation}));
Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"EndReason",string:this.Gtd}));this.BLa&&Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"TimeToGetFirstResult",int64:this.BLa-this.wMb}));this.zaa&&(Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"TimeToStartRecording",int64:this.qRb-this.Fj})),Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"TimeToOpenConnection",int64:this.wMb-this.qRb})));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"FocusLost",
bool:this.pud}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"FocusLostWhileStarting",bool:this.qud}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"FailedToStartTurn",bool:this.$td}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"AverageFragmentLatency",double:this.q1?this.q1.E_i():0<this.sza?this.N2a/this.sza:0}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"AveragePhraseLatency",double:this.q1?this.q1.Y8f():0<this.Iga?this.P2a/this.Iga:0}));
Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"AveragePhraseInsertionLatency",double:0<this.Iga?this.SFd/this.Iga:0}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"AverageFragmentInsertionLatency",double:0<this.sza?this.Mzf/this.sza:0}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"MaxTimeToInsertFragment",int64:this.Mvc}));Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"MaxTimeToInsertPhrase",int64:this.Nvc}));let z=Ol.seen;this.zaa&&0<this.Eaa&&
(z=0<this.Iga?Ol.kept:Ol.tried);Array.add(this.Dh.dataFields,Object.assign(new hf.a,{name:"DictationFunnel",contract:Object.assign(new wl,{name:"Office.System.Funnel",dataFields:[Object.assign(new hf.a,{name:"Name",string:"Dictation"}),Object.assign(new hf.a,{name:"State",string:z})]})}));this.Dh.name=this.hqc;this.Dh.samplingPolicy=2;wi.a.sendActivityEvent(this.Dh)}}Object(h.a)(Sk,"DictationSessionTelemetry",ym,[]);var $l=d(1119);class en{constructor(z,U){this.nwc=z;this.TPh=U}getAccessToken(z){this.TPh&&
this.nwc?this.nwc.KU("OfficeDictation",L.AFrameworkApplication.fa.Ga("DictationResourceID")).then(U=>{U.IsSuccess?z(U.Token):z(en.GUd)}).catch(()=>{z(en.GUd)}):z(en.GUd)}}en.GUd="dictation access token";Object(h.a)(en,"AuthenticationProvider",null,[]);class Cn{constructor(z){this.$Ph=z;this.Szc=new Xj.a}debugAssertTag(z,U,ka,Ba){this.cpd(Ba);this.Szc.debugAssertTag(z,U,ka,Ba)}debugTraceTag(z,U,ka,Ba){this.cpd(Ba);this.Szc.debugTraceTag(z,U,ka,Ba)}sendTraceTag(z,U,ka,Ba){this.cpd(Ba);this.Szc.sendTraceTag(z,
U,ka,Ba)}shipAssertTag(z,U,ka,Ba){this.cpd(Ba);this.Szc.shipAssertTag(z,U,ka,Ba)}cpd(z){if(this.$Ph){const U=window.console;U&&U.log(String.format("FDSpeechService: {0}",z))}}}Object(h.a)(Cn,"FrontdoorExternalLogger",null,[236]);class zm{constructor(){this.accessToken=null}}Object(h.a)(zm,"IAuthenticationProvider",null,[]);class Am{constructor(){this.customEndpointConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;this.clientApp=
0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.speechProcessorScript=null}}Object(h.a)(Am,"ISpeechConfig",null,[]);class fp{constructor(z,U,ka,Ba,Ia){this.Jq=this.inb=null;this.EEd=!1;this.H6=new Of(ka,Ba);this.VU=z;this.qg=U;this.VJh=new en(Ia,U.fHj);this.qg.K4b&&(z=new xl(U),(U=Cf.App.AZa)&&U.Bdh(z))}Dog(z,U){return new Promise(ka=>{this.VJh.getAccessToken(Ba=>{ka(this.Yyj(z,U,Ba))})})}Yyj(z,U,ka){this.Jq=U;z=this.TQd(z);ka=Object.assign(new zm,
{accessToken:ka});U=new Cn(this.qg.CTc);this.inb=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(z,this.H6,ka,null,U);return this.inb?0:(e.ULS.shipAssertTag(42796123,394,!1,"Speech client was not successfully created"),3)}Hhb(z){if(!this.inb)return 3;this.H6.iZa(this.Jq,z);this.inb.startSpeechRecognition();return 0}wU(z){if(!this.EEd){this.EEd=!0;if(this.inb)try{this.inb.stopSpeechRecognition()}catch(U){e.ULS.shipAssertTag(593277727,394,!1,U.message)}if(z&&this.H6)this.H6.onSpeechEnd();
this.Jq=null;this.EEd=!1}}fI(){return this.H6.fI()}TQd(z){const U=new Am;U.speechMode="Dictation";U.sourceLanguage=z;(z=this.qg.L7f)&&""!==z&&(U.speechFDBase=String.format("wss://{0}/",z));U.properties=new Map;this.VU&&(U.properties.set("DictationInsertionPointLeft",this.VU.Xgg()),U.properties.set("DictationInsertionPointRight",this.VU.Chj()));U.properties.set("Corrections","true");U.properties.set("punctuation",this.qg&&this.qg.useAutoPunctuation?"Intelligent":"Explicit");this.qg.CTc&&U.properties.set("EnableAudioLogging",
this.qg.CTc.toString());switch($l.a.WJd){case "Word":U.clientApp=1;break;case "PowerPoint":U.clientApp=0;break;case "OneNote":U.clientApp=2}return U}}Object(h.a)(fp,"FrontdoorSpeechClientProxy",null,[567]);class uk{static Gcl(){uk.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage)}static edl(){uk.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage)}static wel(z){uk.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,
z)}static Gfl(){uk.showDialog(Box4Intl.Box4Strings.L_DictationErrorDialogTitle,Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}static showDialog(z,U){uk.uf||(uk.uf=new Zb.StandardDialog,uk.uf.qr=L.AFrameworkApplication.Cca,uk.uf.yd=0,uk.uf.Ue(1,CommonUIStrings.l_DialogClose),uk.uf.DO(z,U,()=>{uk.uf=null}))}}uk.uf=null;Object(h.a)(uk,"Dialogs",null,[]);class am{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb){this.cmb=this.Hnb=!1;this.vx=null;this.VU=z;this.ytg=U;this.Ca=ka;this.XKa=Ba;this.qg=Ia;this.n1=Ab;
this.tMb=Ob;this.raa=Yb;this.$sf=new K.a;for(z=0;z<am.Zsf.length;z++)this.$sf.add(am.Zsf.charAt(z).toString())}onFinalPhrase(z,U=null){let ka=!0;if(this.vx)this.vx.onFinalPhrase(z);if(this.tMb&&this.n1){var Ba=this.tMb.ZFl(z);if(Ba){this.OPa(!1);this.n1.executeCommand(Ba.commandId,null);return}}Ba=(new Date).getTime();if(1===z.length&&"\n"===z)this.e5d("",null),this.O2f();else{let Ia=z.indexOf("\n");for(0<Ia&&Ia!==z.length-1&&(ka=!1);0<=Ia;)this.e5d(z.substr(0,Ia),ka?U:null),this.O2f(),z=z.substr(Ia+
1),Ia=z.indexOf("\n"),ka=!1;this.e5d(z,ka?U:null)}z=(new Date).getTime();if(this.vx)this.vx.onTextInserted(!0,z-Ba)}onFragment(z){if(this.Hnb)var U=this.uPc(z);else{if(!this.jkd())return;U=this.cmb?this.uPc(z):z}if(this.vx)this.vx.onFragment(z);z=!0;const ka=(new Date).getTime();this.VU&&!this.VU.eai(U)&&(this.Ajg(),z=!1);U=(new Date).getTime();if(this.vx)this.vx.onTextInserted(!1,U-ka);z&&this.n1&&this.n1.SFl()}onRecordingStarted(){this.Ca.processAction(qd.a.QYf,2);if(this.vx)this.vx.onRecordingStarted()}onMicrophoneError(z=
""){this.Ujg(Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,z)}qDb(z){if(this.vx)this.vx.onCustomError(z);this.Ca.La(qd.a.IYf,2,z)}cjk(z){this.qDb(z);uk.Gcl()}Vkk(z){this.qDb(z);uk.edl()}Nrk(z){this.qDb(z);uk.Gfl()}NL(z){this.vx&&this.vx.setEndReason(z);this.Ca.La(qd.a.PYf,2,z)}jnk(z){this.NL(z);this.lfl()}wpk(){this.OPa(!1);this.Ca.processAction(qd.a.RYf,2)}onConnectionStarted(z){if(this.vx)this.vx.onConnectionStarted(z)}Cxe(z){this.Ujg(this.D9i(z),z)}onFocusLost(){if(this.vx)this.vx.onFocusLost();
this.Ca.processAction(qd.a.KYf,2)}fQj(z){return this.ytg&&!I.a.dde(z)&&!this.$sf.contains(z.toString())}uPc(z){return 0<z.length&&this.fQj(z.charAt(0))?" "+z:z}jkd(){if(this.Hnb)return!0;if(this.VU){const z=this.VU.Xgg();this.cmb=!1;z&&0<z.length&&(this.cmb=!I.a.dde(z.charAt(z.length-1))&&!z.endsWith("\u201c"));return this.Hnb=this.VU.jkd()}if(this.vx)this.vx.onFailedToStartTurn();this.n1&&this.n1.UFl();return!1}OPa(z){this.cmb=this.Hnb=!1;this.VU&&(z&&this.VU.Ffk(),this.VU.OPa())}onSpeechSessionStarted(z){if(this.vx)this.vx.onSpeechSessionStarted(z);
this.qg.CTc&&this.MNe(z)}Ujg(z,U=""){if(this.vx)this.vx.onMicrophoneError(U);this.Ca.processAction(qd.a.NYf,2);uk.wel(z)}D9i(z){z=z.trimStart();return z.startsWith("NotAllowedError")||z.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:z.startsWith("NotFoundError")||z.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:z.startsWith("NotReadableError")||z.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:
Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}lfl(){this.XKa&&this.XKa.execute(z=>{z.tdl()})}MNe(z){this.XKa&&this.XKa.execute(U=>{U.MNe(String.format("ServiceSessionID:{0} ClientSessionId: {1}",z,this.Xpi))})}e5d(z,U){if(this.Hnb||this.jkd()){if(this.VU){const ka=this.cmb?this.uPc(z):z;(this.qg.K4b&&Object(sg.a)(566,this.VU)?this.VU.FFl(ka,U,0<z.length&&z.charAt(0)!==ka.charAt(0)):this.VU.DBj(this.cmb?this.uPc(z):z))||this.Ajg()}this.OPa(!0)}}Ajg(){if(this.vx)this.vx.onTextInsertionError();
this.Ca.processAction(qd.a.TYf,2)}O2f(){this.Ca.processAction(qd.a.cB,2)}get Xpi(){return Cf.App.yZ?Cf.App.yZ.Wwa:""}}am.Zsf='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d';Object(h.a)(am,"SpeechClientObserverController",null,[]);class Fo{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc){this.tMb=this.n1=this.raa=this.Jq=this.jNa=null;this.Jv=z;this.zMh=U;this.Qc=ka;this.XKa=Ba;this.Vh=Ia;this.qg=Ab;this.nwc=Ec;this.Bwf=Yc;this.qg.UK&&(this.raa=Ob);if(this.qg.Pug||this.qg.Yib)this.n1=
Yb;this.qg.Pug&&(this.tMb=uc);this.lkb=mc}Hhb(){this.XKa&&this.XKa.execute(z=>{z.uuj()});return new Promise((z,U)=>{this.jNa?this.Z2f(z,U):this.AWj().then(()=>{var ka=this.zMh.value;ka?(ka=ka.$yi(),this.jNa=this.kDi(ka),this.Z2f(z,U)):U(4)}).catch(()=>{U(2)})})}Z2f(z,U){this.iZa().then(ka=>{0===ka?z(0):U(ka)}).catch(ka=>{U(ka)})}iZa(){return new Promise((z,U)=>{this.Jq=new Sk(this.qg,this.Vh);if(this.qg.kod||this.qg.Yib)this.Jq=new Bn(this.qg,this.Vh);this.jNa.Dog(this.qg.mS,this.Jq).then(ka=>{0!==
ka?z(ka):z(this.jNa.Hhb(this.IAg()))}).catch(ka=>{U(ka)})})}AWj(){return this.qg.kod||this.qg.Yib?this.JCg("alVoiceClient",!0):this.JCg("PPTSpeechClient")}JCg(z,U=!1){return!U&&this.Bwf&&L.AFrameworkApplication.Aa.jb.pvg?(U=L.AFrameworkApplication.Jj(z,2),Na.a(this.Bwf.Cxb(U))):this.Jv?this.Jv.loadScript(z):new Promise((ka,Ba)=>{Ba("Unable to load speech client "+z)})}wU(z=!0){0!==this.fI()&&(this.jNa&&this.jNa.wU(z),this.Jq&&(this.Jq.endActivity(),this.Jq=null))}fI(){return this.jNa?this.jNa.fI():
0}IAg(){return"zh-CN"!==this.qg.mS&&"ja-JP"!==this.qg.mS}kDi(z){const U=new am(z,this.IAg(),L.AFrameworkApplication.Ta,this.XKa,this.qg,this.n1,this.tMb,this.raa);return this.qg.kod||this.qg.Yib?new dk(this.raa,this.n1,2,this.Qc,this.lkb,U,this.qg):new fp(z,this.qg,this.raa,U,this.nwc)}}Object(h.a)(Fo,"DictationManager",null,[]);class Dp{constructor(){this.pjf=[];this.NZa=this.FDd=""}startSession(){this.FDd=C.a.create().toString();this.pjf=[]}endSession(){this.FDd=""}get Wwa(){return this.FDd}get D6g(){return this.pjf}}
Object(h.a)(Dp,"DictationSessionInfo",null,[519]);class lo{constructor(z,U,ka){this.sGd=this.gTb=this.pGd=this.fTb=!1;this.iLa="";this.eb=z?z:L.AFrameworkApplication.fa;this.i1a=U;this.Qc=ka}get useAutoPunctuation(){if(!this.UK||!this.W9d)return!1;if(this.pGd)return this.fTb;const z=ma.a.instance.getItem("WACDictationFUseAutoPunctuation");this.fTb=void 0===z||null===z?this.eb.ka("DictationAutoPunctuationEnglishDefaultOnIsEnabled")?Array.contains(oh.edi,this.mS):!1:Boolean.parse(z);this.pGd=!0;return this.fTb}set useAutoPunctuation(z){this.UK&&
this.W9d&&(this.fTb=z,this.pGd=!0,ma.a.instance.setItem("WACDictationFUseAutoPunctuation",this.fTb.toString()))}get WKb(){if(!this.UK||!this.bde)return!1;if(this.sGd)return this.gTb;const z=ma.a.instance.getItem("WACDictationFloatieUseVoiceCommands");this.gTb=void 0===z||null===z?!0:Boolean.parse(z);this.sGd=!0;return this.gTb}set WKb(z){this.UK&&this.bde&&(this.gTb=z,this.sGd=!0,ma.a.instance.setItem("WACDictationFloatieUseVoiceCommands",this.gTb.toString()))}get W9d(){return Array.contains(oh.fdi,
this.mS)}get bde(){return this.Yib&&Array.contains(oh.dCl,this.mS)}get mS(){""===this.iLa&&(this.iLa=this.v3i());return this.iLa}set mS(z){z&&(this.iLa=z)}get K4b(){return this.UK}get UK(){return this.eb.ka("WacBox4DictationFloatieIsEnabled")}get Hzl(){return this.eb.ka("WacBox4DictationInternalArticle")}get L7f(){return this.eb.Ga("DictationFrontdoorDomain")}get kod(){return this.eb.ka("WacBox4DictationUseAugloopService")}get Pug(){return this.eb.ka("WacBox4DictationCommandsIsEnabled")&&this.UK}get Yib(){return this.eb.ka("WacBox4DictationUseAugloopServiceWithFrontdoor")}get fHj(){return this.eb.ka("WacDictationAuthenticationEnabled")}get CTc(){return this.eb.ka("DictationDebugModeEnabled")}get P9g(){return this.getSupportedLanguages(0)}get L8g(){return this.getSupportedLanguages(1)}get gHj(){return ia.a.jwh&&
this.eb.ka("UserCanUseDictation")}getSupportedLanguages(z){const U=[];z=0===z?oh.productionLanguages:oh.previewLanguages;for(const ka of z)Array.add(U,new tk(ka));U.sort((ka,Ba)=>ka.displayName.localeCompare(Ba.displayName));return U}v3i(){if(this.i1a&&this.Qc){const z=this.i1a.TNc(this.Qc.Kj);for(const U of this.P9g)if(U.LCID===z)return U.KWc;for(const U of this.L8g)if(U.LCID===z)return U.KWc}return oh.MFi}}Object(h.a)(lo,"DictationSettings",null,[]);class Dn{constructor(){this.c2e=this.Da=null}get name(){return"Box4.Dictation"}Wb(z){this.Da=
z;const U=Z.a.instance.qb("Common.IDynamicScriptLoaderProvider");let ka=null;U&&(ka=U.Jv);const Ba=Z.a.instance.le("Box4.Dictation.IDictationHostFactory");this.Da.register(lo,"Box4.Dictation.DictationSettings").ma().na(()=>new lo(this.Da.resolve("Common.IAppSettingsManager"),this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.ISelectionManager")));const Ia=Z.a.instance.le("Common.IDictationFloatieController");this.Da.register(jo,"Box4.Dictation.DictationFloatieManager").ma().na(()=>new jo(Ia,
this.Da.resolve("Box4.Dictation.DictationSettings")));this.Da.register(Fo,"Box4.Dictation.DictationManager").ma().na(()=>new Fo(ka,Ba,this.Da.resolve("Box4.ISelectionManager"),z.Ka("Box4.IBusinessBarController"),z.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.qb("Box4.DictationCommands.IDictationCommandManager"),this.Da.qb("Box4.DictationCommands.IDictationCommandParser"),
this.Da.qb("Box4.DictationCommands.IDictationCommandsTelemetry"),this.Da.resolve("Common.App.OAuth.IOAuthManager"),this.Da.resolve("Common.ISharedDependencyLoader")));this.Da.register(519,"Box4.Dictation.IDictationSessionInfo").ma().na(()=>new Dp)}init(){this.Da.resolve("Box4.Dictation.IDictationSessionInfo");this.c2e=hj.createInstance(this.Da.le("Common.IRibbonButtonUpdater"),this.Da.resolve("Box4.Dictation.DictationManager"),this.Da.resolve("Box4.IFormattingEditor"),this.Da.resolve("Box4.IFormattingReader"),
this.Da.resolve("Box4.Dictation.DictationFloatieManager"),this.Da.resolve("Box4.Dictation.DictationSettings"),this.Da.le("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor"),cd.FocusManager.instance());this.c2e.ub();Cf.App.Hb.updateCommandUI()}dispose(){}}Object(h.a)(Dn,"DictationPackageManager",null,[2,3]);class Km{constructor(z,U,ka){this.iX=null;this.vF=this.OW=-1;this.Vyb=!1;this.JW=z;this.ra=U;this.ia=ka}Xgg(){return this.$gg(!1)}Chj(){return this.$gg(!0)}jkd(){this.iX&&this.OPa();const z=
this.ra.Oa.kb;if(z){const U=z.Ua;if(U&&nf.ParagraphReader.Vd(U.node))return this.iX=U.node,this.vF=z.Ua.n3a,this.OW=z.Ua.GTb,this.Vyb=!0}return!1}OPa(){this.iX=null;this.Vyb=!1;this.OW=this.vF=-1}eai(z){if(this.iX){const U=new Zi.GraphTransaction(15);try{U.gd(this.iX);const ka=this.Vyb&&this.vF!==this.OW?Ji.a.createTextRange(this.iX,this.vF,this.OW):Ji.a.ak(this.iX,this.OW);this.JW.replaceTextRange(ka,z);this.OW=this.Vyb?this.vF+z.length:this.OW+z.length;const Ba=Hj.SelectionFactory.Mg(this.iX,this.OW);
this.ra.setSelection(Ba);this.Vyb=!1;return!0}finally{U&&U.dispose()}}return!1}DBj(z){if(this.iX){const U=new Zi.GraphTransaction(15);try{U.gd(this.iX);const ka=this.vF!==this.OW?Ji.a.createTextRange(this.iX,this.vF,this.OW):Ji.a.ak(this.iX,this.OW);this.JW.replaceTextRange(ka,z);this.OW=this.vF+z.length;const Ba=Hj.SelectionFactory.Mg(this.iX,this.OW);this.ra.setSelection(Ba);this.Vyb=!1;return!0}finally{U&&U.dispose()}}return!1}Ffk(){var z=this.$3i();this.ia&&z&&z.n3a!==z.GTb&&0<=z.n3a&&(z=Ji.a.createTextRange(z.node,
z.n3a,z.GTb),this.ia.La(qd.a.OYf,2,z))}$3i(){return this.iX?this.vF!==this.OW?Ji.a.createTextRange(this.iX,this.vF,this.OW):Ji.a.ak(this.iX,this.OW):null}$gg(z){var U=this.ra.Oa.kb;if(U){var ka=U.Ua;if(ka&&(U=ka.node,nf.ParagraphReader.Vd(U)&&(ka=z?ka.GTb:ka.n3a,U=nf.ParagraphReader.text(U),ka<=U.length)))return z?U.substring(ka,U.length):U.substring(0,ka)}return""}}Object(h.a)(Km,"DictationHost",null,[544]);class gp{constructor(z,U,ka){this.JW=z;this.ra=U;this.ia=ka}$yi(){return new Km(this.JW,this.ra,
this.ia)}}Object(h.a)(gp,"DictationHostFactory",null,[518]);class En{get name(){return"PowerPointWebEditor.Dictation"}Wb(z){z.register(gp,"PowerPointWebEditor.Dictation.DictationHostFactory").as("Box4.Dictation.IDictationHostFactory").ma().na(()=>new gp(z.resolve("Box4.ICharacterPropertiesEditor"),z.resolve("Box4.ISelectionManager"),L.AFrameworkApplication.Ta))}init(){}dispose(){}static main(){ua.a.instance.Bc(new En)}}Object(h.a)(En,"PPTWebEditorDictationPackage",null,[2,3]);var fn=d(448);class kk{constructor(z,
U,ka=null){this.id=z.Id;ka||(ka="");this.mKk=ka;this.sensitivityLabel=z}}Object(h.a)(kk,"AutoPolicyLabelData",null,[]);class bm{constructor(z,U){this.V6=z;this.displayName=U}}Object(h.a)(bm,"PolicyLabelRequestState",null,[]);class Pl{static get mde(){return Pl.kTj}}Pl.kTj="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(h.a)(Pl,"JustificationDialogHtml",null,[]);class Lf extends pb.a{constructor(z,U){super(!1,!1,Lf.W0);this.YLa=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];this.Cxc=null;this.Bxc=!1;this.ryc=z;this.YC=U;this.mg=this.egi();this.yd=1;this.ng=Lf.id;this.Ue(1,CommonUIStrings.l_DialogChange);this.JC(1,!1);this.Zwa(0)}kOe(){if(Lf.W0)this.tj(CommonUIStrings.l_SensitivityJustificationTitle,
Object(v.a)(this,this.ach,"reactJustificationDialogHandler"),this.Keg(this.Bxc));else{const z={};for(let U=0;U<this.YLa.length;U++)z[Lf.dEe+U]=!1;z[Lf.Enc]="";this.tj(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.jTj,"justificationDialogHandler"),z);this.qFe();Gf.a.addHandler($get(Lf.Enc),bc.a.input,Object(v.a)(this,this.mnl,"textAreaHandler"))}}validate(){if(Lf.W0)return this.GFh(this.Cxc);const z=$get(Lf.Enc);return z.disabled?!0:this.GFh(z.value)}GFh(z){const U=2>z.length,
ka=500<z.length,Ba=RegExp("[{|}|;|\\\\]").test(z);z=""===I.a.IFe(z);return!U&&!ka&&!Ba&&!z}jTj(z,U){let ka="";if(1===z)for(let Ba=0;Ba<this.YLa.length;Ba++)if(U[Lf.dEe+Ba]){ka=Ba===this.YLa.length-1?U[Lf.Enc]:this.YLa[Ba];break}this.YC(z,this.ryc,ka)}ach(z){let U="";1===z&&this.Cxc&&(U=this.Cxc);this.YC(z,this.ryc,U)}ynk(z){this.Cxc=z;z=this.validate();this.Bxc!==z&&(this.Bxc=z,this.M5(CommonUIStrings.l_SensitivityJustificationTitle,Object(v.a)(this,this.ach,"reactJustificationDialogHandler"),this.Keg(this.Bxc)))}Keg(z){return{["id"]:this.ng,
["bodyControls"]:{["choiceGroupProps"]:{},["textAreaProps"]:{["placeholder"]:CommonUIStrings.l_SensitivityJustificationPlaceholder}},["actionButtonProps"]:{["label"]:CommonUIStrings.l_DialogChange,["disabled"]:!z},["infoMessage"]:CommonUIStrings.l_SensitivityJustificationMessage,["justificationIrrelevantLabel"]:CommonUIStrings.l_SensitivityJustificationNoLongerApplies,["justificationIncorrectLabel"]:CommonUIStrings.l_SensitivityJustificationIncorrect,["justificationOtherLabel"]:CommonUIStrings.l_SensitivityJustificationOther,
["onJustificationUpdated"]:Object(v.a)(this,this.ynk,"onJustificationUpdated")}}mnl(z){z.target&&this.JC(1,this.validate())}egi(){return pb.a.UB(Lf.mde,L.AFrameworkApplication.gm,fj.getImageClass(Lf.lDa),CommonUIStrings.l_SensitivityJustificationMessage,this.YLa[0],this.YLa[1],this.YLa[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)}qFe(){const z=document.getElementsByName(Lf.zVj);for(let U=0;U<z.length;U++)Gf.a.addHandler(z[U],bc.a.focus,Object(v.a)(this,this.udd,"radioButtonFocusHandler")),
Gf.a.addHandler(z[U],bc.a.click,Object(v.a)(this,this.udd,"radioButtonFocusHandler"))}udd(z){if(z=z.target){z.checked=!0;var U=$get(Lf.Enc);z.id===Lf.dEe+(this.YLa.length-1)?(U.disabled=!1,Sys.UI.DomElement.setVisible(U,!0),U.focus()):(U.disabled=!0,z.focus());this.JC(1,this.validate())}}static get W0(){return L.AFrameworkApplication.Aa.jb.gC&&L.AFrameworkApplication.Aa.jb.Hbe}}Lf.mde=Pl.mde;Lf.zVj="ListRadioBox";Lf.dEe="radiobox";Lf.Enc="txtJustification";Lf.lDa="Info_32x32x32";Lf.id="JustificationDialog";
Object(h.a)(Lf,"JustificationDialog",pb.a,[]);class no extends pb.a{constructor(z,U,ka){super(!1,!1,!0);if(z&&ka){var Ba={["id"]:"MandatoryLabellingDialog"};this.vMh=ka;this.yyd=U;if(!L.AFrameworkApplication.fa.ka("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||this.yyd&&""!==this.yyd)Ba.learnMoreLink={["type"]:"AppLinkProps",["id"]:"mandatoryLabellingLearnMoreLink",["text"]:CommonUIStrings.l_LearnMore,["handler"]:{["href"]:this.yyd,["target"]:"_blank"},["customTooltip"]:CommonUIStrings.L_LearnMoreTooltip};
U={["sections"]:[],["shouldAutoOpen"]:!1};Array.add(U.sections,{["id"]:"mandatoryLabellingFlyoutMenuSection",["controls"]:z});Ba.labelFlyout={["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabellingFyout",["label"]:"Pick a label",["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!0,["menuDefinition"]:U};z={["id"]:"MandatoryLabellingDialog",["bodyControls"]:Ba};Ba.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;Ba.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;
this.tj(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(v.a)(this,this.Lck,"mandatoryLabellingDialogHandler"),z)}else e.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs")}Lck(z,U){1===z&&U.selectedLabel&&(z=U.selectedLabel,""!==z&&this.vMh(z))}}Object(h.a)(no,"MandatoryLabellingDialog",pb.a,[]);class lk{constructor(){this.Moa=!!L.AFrameworkApplication.Aa&&L.AFrameworkApplication.Aa.jb.gC}JAi(z,U,ka){this.Moa&&new no(z,U,ka)}static get instance(){return lk.Ja||
(lk.Ja=new lk)}}lk.Ja=null;Object(h.a)(lk,"MandatoryLabellingDialogFactory",null,[579]);class Je{}Je.pjl="sbProtectForm14";Je.sjl="SBStatusBarMarkAsReadOnly14";Je.LUj="Info_16x16x32";Je.SOf="QuickSearchCompletedToday_16x16x32";Je.AEe="CommonControlCheckboxCheck_16";Je.Oyh="On";Je.visible="Visible";Je.UVi="ImageIsVisible";Je.tU="SourceControlId";Je.menuItemId="MenuItemId";Je.menu="Menu";Je.TGf="AppLockId";Je.value="Value";Je.labelText="LabelText";Je.alt="Alt";Je.tng="Image16by16";Je.Uub="Image16by16Class";
Je.ojl="SBProtectForm_16";Je.rjl="SBStatusBarMarkAsReadOnly_16";Je.icon="Icon";Je.iconColor="IconColor";Je.customTooltip="CustomTooltip";Je.NJk="MipTagDynamicFillWithOutline_20";Je.OJk="MipTagLockDynamicFillWithOutline_20";Je.MJk="MipTagErrorOutline_20";Je.PJk="MipTagQuestionOutline_20";Je.dTe="transparent";Je.Dtl="UILocation";Object(h.a)(Je,"PolicyConstants",null,[]);class yl extends pb.a{constructor(z,U,ka){super(!1,!1,yl.W0);this.ryc=z;this.E1=U;this.YC=ka;this.yd=1;this.ng=yl.id;this.Zwa(1);this.Zwa(0)}LOe(){const z=
{["id"]:"UserDefinedPermissionsDialog"};yl.W0&&this.tj("Defined Permissions",Object(v.a)(this,this.fAl,"userDefinedPermissionsDialogHandler"),z)}fAl(z){1!==z&&this.YC(z,this.ryc,"",this.E1)}static get W0(){return L.AFrameworkApplication.Aa.jb.gC&&L.AFrameworkApplication.Aa.jb.Hbe}}yl.id="UserDefinedPermissionsDialog";Object(h.a)(yl,"UserDefinedPermissionsDialog",pb.a,[]);var oo=d(576),jl=d(233),xi=d(463);class ah{constructor(z,U,ka,Ba){this.Uxd=this.Vxd=null;this.P$e=this.ixd=this.Ixd=this.fPb=this.Xdf=
this.Pff=this.Gsd=!1;this.ukb=this.Nya=this.Gza=this.SKa=this.E1=this.rA=this.bpa=this.ui=null;this.ILh=this.Lqd=0;this.dud=this.gdf=this.fZe=null;this.Ca=z;this.Oh=U;this.eb=ka;this.tk=Ba;this.dQb={};this.ulf={};this.Rff={};this.u4b=ka.ka("WacApplyManualPolicyLabelIsEnabled");this.tk.value.UId(Object(v.a)(this,this.aCe,"processAutoSensitivityLabel"));this.tk.value.FFf(Object(v.a)(this,this.aCe,"processAutoSensitivityLabel"));this.tk.value.wId(Object(v.a)(this,this.Prk,"onUpdateLabelInfo"));L.AFrameworkApplication.Aa&&
L.AFrameworkApplication.Aa.JM(Object(v.a)(this,this.$Lk,"refreshDocumentPolicyLabelsOnModeChange"));ka.ka("SupportsPolicies")&&ka.Ga("AppliedPolicyId")&&(this.Vxd=ka.Ga("IrmPolicyTitle"),this.Uxd=ka.Ga("IrmPolicyDescription"));this.PBd=ka.ka("ProtectedFile");this.YJh=this.eb.Cc("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.ZJh=this.eb.Cc("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}get Zsa(){return L.AFrameworkApplication.Zsa||!!this.gdf&&this.gdf()}ub(){this.Ca.ya(qa.a.L3g,Ub.a.frame,
Object(v.a)(this,this.b_f,"documentLabelPaneHandler"));this.Ca.pa(qa.a.Ohc,Ub.a.frame,Object(v.a)(this,this.Ohc,"queryPolicyLabel"),96);this.Ca.ya(qa.a.yib,Ub.a.frame,Object(v.a)(this,this.yib,"toggleSensitivity"));this.Ca.ya(qa.a.Deb,Ub.a.frame,Object(v.a)(this,this.Deb,"populateSensitivityFlyout"));this.Ca.ya(qa.a.Sgb,Ub.a.frame,Object(v.a)(this,this.Sgb,"setSensitivity"));this.Ca.pa(qa.a.kic,Ub.a.frame,Object(v.a)(this,this.kic,"querySensitivity"),96);this.Ca.ya(qa.a.hfb,Ub.a.frame,Object(v.a)(this,
this.hfb,"querySensitivityToggleButton"));this.Ca.ya(qa.a.gfb,Ub.a.frame,Object(v.a)(this,this.gfb,"querySensitivitySubFlyout"));this.CTb(qa.a.yib)||this.Ca.he(qa.a.yib,4);this.CTb(qa.a.Deb)||this.Ca.he(qa.a.Deb,4);this.CTb(qa.a.Sgb)||this.Ca.he(qa.a.Sgb,4);this.CTb(qa.a.hfb)||this.Ca.he(qa.a.hfb,4);this.CTb(qa.a.gfb)||this.Ca.he(qa.a.gfb,4);this.Oh.updateCommandUI();L.AFrameworkApplication.fa&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",
!1)&&ld.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.tk.value.qRk(Object(v.a)(this,this.pdh,"registerActionsHandler"))}pdh(){this.ub()}jCh(){this.Ca.uO(qa.a.L3g,Ub.a.frame,Object(v.a)(this,this.b_f,"documentLabelPaneHandler"));this.Ca.uO(qa.a.Ohc,Ub.a.frame,Object(v.a)(this,this.Ohc,"queryPolicyLabel"));this.Ca.uO(qa.a.yib,Ub.a.frame,Object(v.a)(this,this.yib,"toggleSensitivity"));this.Ca.uO(qa.a.Deb,Ub.a.frame,Object(v.a)(this,
this.Deb,"populateSensitivityFlyout"));this.Ca.uO(qa.a.Sgb,Ub.a.frame,Object(v.a)(this,this.Sgb,"setSensitivity"));this.Ca.uO(qa.a.kic,Ub.a.frame,Object(v.a)(this,this.kic,"querySensitivity"));this.Ca.uO(qa.a.hfb,Ub.a.frame,Object(v.a)(this,this.hfb,"querySensitivityToggleButton"));this.Ca.uO(qa.a.gfb,Ub.a.frame,Object(v.a)(this,this.gfb,"querySensitivitySubFlyout"))}yib(){return 32}P8f(z){const U="mandatoryLabelling_"+z.Id;this.Rff[U]=z.Id;return{["type"]:"AppToggleButtonProps",["id"]:U,["label"]:z.DisplayName,
["hideLabel"]:!1,["customTooltip"]:z.Tooltip}}J9a(){return this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UDPEnabled",!1)}k9i(){const z=[],U=this.bpa;for(let Ba in U){var ka=U[Ba];const Ia=this.rA[Ba];if(this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideUDPFromMandatoryDialogEnabled",!1)){if(!Ia||!Ia.Enabled||Ia.HasUserDefinedPermissions)continue}else if(!Ia||!Ia.Enabled)continue;if(ka.count){const Ab={["sections"]:[],["shouldAutoOpen"]:!1},Ob={["id"]:"mandatoryLabelling_flyoutMenuSection_"+
Ia.Id,["controls"]:[]};for(let Yb of ka){ka=this.rA[Yb];if(this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideUDPFromMandatoryDialogEnabled",!1)){if(!ka||!ka.Enabled||ka.HasUserDefinedPermissions)continue}else if(!ka||!ka.Enabled)continue;Array.add(Ob.controls,this.P8f(ka))}Array.add(Ab.sections,Ob);Array.add(z,{["type"]:"AppFlyoutAnchorProps",["id"]:"mandatoryLabelling_"+Ia.Id,["label"]:Ia.DisplayName,["hideLabel"]:!1,["hideChevron"]:!1,["hideIcon"]:!1,["menuDefinition"]:Ab})}else Array.add(z,
this.P8f(Ia))}return z}Deb(z,U,ka,Ba,Ia){if(1===ka||!this.tk.value.Oob(!0))return 32;Ia.MenuItems=Object.assign(new jh.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(Ia.MenuItems.MenuSectionList,this.OGc(!this.isReactRibbonEnabled()));this.ui.CustomUrl&&Array.add(Ia.MenuItems.MenuSectionList,this.pAi(this.isReactRibbonEnabled()?this.ui.CustomUrl:I.a.je(this.ui.CustomUrl)));this.isReactRibbonEnabled()||(Ia.PopulationXML=Ve.l(Ia.MenuItems));return 32}kic(z,U,ka,Ba,Ia){if(1===
ka||!Ia||!this.u4b)return 32;this.ui=this.tk.value.Mv;if(this.tk.value.Oob(!0)&&(Ia[Je.visible]=!0,this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelsAvailableActivityControlEnabled",!1)?this.Xdf||(ce.a("MipLabelsAvailable"),this.Xdf=!0):ce.a("MipLabelsAvailable"),this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.ui&&this.ui.AreLabelsAvailable&&(z=Z.a.instance.Ka("Common.ISystemInitiatedFeedback")))){const Ab=ah.Va(this.ui.AppliedPolicyId)?
"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";z.execute(Ob=>{Ob.logActivity(Ab,null)})}return 32}hfb(z,U,ka,Ba,Ia){if(1===ka||!Ia)return 32;let Ab,Ob;Ia[Je.Oyh]=!!(Ab=Ia[Je.menuItemId])&&!!(Ob=this.dQb[Ab])&&Ob===this.ui.AppliedPolicyId;return 32}gfb(z,U,ka,Ba,Ia){if(1===ka||!Ia)return 32;let Ab,Ob,Yb;z=!!(Ab=Ia[Je.tU])&&!!(Ob=this.dQb[Ab])&&!!(Yb=this.bpa[Ob])&&Yb.contains(this.ui.AppliedPolicyId);Ia[Je.UVi]=z;Ia[Je.Oyh]=z;return 32}Sgb(z,U,ka,Ba,Ia){if(1===ka||
!Ia)return 32;z=this.dQb[Ia[Je.tU]];U=this.Etl(Ia[Je.Dtl]);ka=new hf.a;ka.name="SensitivityPickerLocation";ka.int64=U;ce.a("SensitivityPickerUsage",void 0,void 0,[ka]);return this.fJa(z,Ia,2)}FTc(){return!!L.AFrameworkApplication.Aa&&1===L.AFrameworkApplication.Aa.mode}$Lk(){this.ixd&&!this.FTc()&&(this.ixd=!1,this.tk.value.ZLk())}uql(){this.ui.DefaultLabelId&&this.ui.MandatoryLabelingEnforced?this.Gsd||this.FTc()?this.ui.AppliedPolicyId?this.YVd(""):(this.tk.value.tOj(this.tk.value.U6b)||this.FTc())&&
this.i1f():this.Lmh():this.ui.DefaultLabelId?this.Lmh():this.ui.MandatoryLabelingEnforced&&(this.ui.AppliedPolicyId?this.YVd(""):this.i1f())}Zwg(){return this.ui.MandatoryLabelingEnforced?this.ui&&this.ui.AreLabelsAvailable?this.eb.ka("TestOverrideIsReactDialogEnabled")||this.Oh&&this.Oh.jb&&this.Oh.jb.gC?!0:(e.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(e.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),
!1):(e.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)}i1f(){!this.Zwg()||L.AFrameworkApplication.hQ||this.Pff||(this.Pff=L.AFrameworkApplication.hQ=!0,e.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.tk.value.$ah("",1),this.tk.value.RHd(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,
()=>{this.Jck()}))}YVd(z){this.Zwg()&&L.AFrameworkApplication.hQ&&(L.AFrameworkApplication.hQ=!1,e.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.tk.value.PFe(),this.tk.value.$ah(z,2))}Jck(){lk.instance.JAi(this.k9i(),this.ui.CustomUrl,Object(v.a)(this,this.Kck,"mandatoryLabellingDialogCallback"))}Kck(z){this.YVd(this.Rff[z])}NJf(){return this.eb.ka("CoAuthForProtectedFilesEnabled")&&this.eb.ka("SupportsOfficeClientCoauthoring")&&this.eb.ka("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&
!!this.dud&&this.Zsa}fJa(z,U,ka,Ba=null){this.tk.value.lIk(ka);let Ia=32,Ab=!1,Ob=!0;const Yb=2===ka||8===ka||16===ka,uc=z===this.ui.AppliedPolicyId;if(this.fZe&&this.fZe(z,Yb))e.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",ka),this.Oh.updateCommandUI();else if(U&&Je.TGf in U&&this.tk.value.bLe(U[Je.TGf]),z)if(this.tk.value.gzg()||this.NJf()&&this.Ixd)e.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",
ka),this.Oh.updateCommandUI(),Yb&&this.YBc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.eb.ka("HasDocumentEditRights"))if(this.tk.value.ili(z))if(!this.J9a()&&this.rA[z]&&this.rA[z].HasUserDefinedPermissions&&!uc)e.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",ka),1!==ka&&4!==ka&&this.d$h();else if(Yb&&this.ui.MandatoryLabelingEnforced&&uc)e.ULS.sendTraceTag(570972054,
306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",ka),this.YBc(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(Yb&&this.eb.ka("WacLabelingJustificationDialogIsEnabled")&&this.ui.RequiredDowngradeJustification&&(uc||this.rA[z].RequiredDowngradeJustification)&&(this.J9a()?!this.P$e&&!Ba:!this.E1))return e.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",
ka),this.kOe(z),Ia;if(this.J9a()&&this.rA[z].HasUserDefinedPermissions&&!uc)return e.ULS.sendTraceTag(523019968,306,50,"UDP Label is selected. ApplyLabelFlag: {0}",ka),this.LOe(z,Ba),Ia;if(this.NJf()&&!this.dud())this.Lqd<this.YJh?(e.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.Lqd,ka),this.Ixd=!0,this.Lqd++,Pg.Task.delay(this.ZJh).continueWith(()=>{this.Ixd=!1;this.fJa(z,U,ka)})):(e.ULS.sendTraceTag(577356771,306,
15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",ka),Ab=1!==ka,Ob=!1,Ia=8);else{if(this.HMj(z)&&(e.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",ka),1===ka||8===ka||4===ka))return Ia;e.ULS.sendTraceTag(570972056,306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",ka);this.setPolicyLabel(uc?"":z,this.J9a()?Ba:this.E1,"",ka);return Ia}}else e.ULS.sendTraceTag(42796169,
306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",ka),this.Oh.updateCommandUI(),Yb&&this.YBc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else e.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",ka),this.Oh.updateCommandUI(),Yb&&this.YBc(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);
else e.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",ka),this.Oh.updateCommandUI(),Ab=Yb,Ob=!1,Ia=8;this.tk.value.wbh(0,ka,Ab,Ob);return Ia}THf(z,U,ka=null,Ba=!1){u.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",0,"wordclpfc",null);this.eb.ka("SupportsOfficeClientCoauthoring")&&this.eb.ka("CoAuthForProtectedFilesIsEnabled")?(this.fPb=!1,(this.ui=this.tk.value.Mv)&&!this.ui.AppliedPolicyId?this.fPb=!0:this.ui&&
this.ui.PolicyLabelAssignmentMethod&&(this.fPb=jl.e(this.ui.PolicyLabelAssignmentMethod)===jl.e("standard"))):this.fPb=Ba;z=ah.Va(z)?null:this.rA[z];(U=ah.Va(U)?null:this.rA[U])?this.Gza=new kk(U,!0,ka):(this.tk.value.Bwa(29),this.Nya=null);z?this.SKa=new kk(z,!1):this.ukb=null;this.aCe(null,null)}Kai(z){this.fJa(z,null,16)}F4k(){this.rA={};if(this.ui=this.tk.value.Mv)for(const z of this.ui.SensitivityLabels)this.rA[z.Id]=z}HMj(z){if(this.bpa&&z in this.bpa){z=this.bpa[z];for(let U of z)if((z=this.rA[U])&&
z.Enabled)return!0}return!1}a6k(){this.bpa={};if(this.ui=this.tk.value.Mv){for(const z of this.ui.SensitivityLabels)z.ParentId||(this.bpa[z.Id]=new Da.a);for(const z of this.ui.SensitivityLabels)z.ParentId&&z.ParentId in this.bpa&&this.bpa[z.ParentId].add(z.Id)}}uFk(){if(this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)){this.ui=this.tk.value.Mv;const z=this.u4b&&this.isReactRibbonEnabled()&&this.tk.value.Oob();ah.Lfb(z)}else this.u4b&&this.isReactRibbonEnabled()?
(this.ui=this.tk.value.Mv,this.tk.value.Oob()?(ah.Lfb(!0),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!1))):ah.Lfb(!1)):ah.Lfb(!1)}eNk(z){this.dud=z}Lmh(){if(this.eb.ka("WacApplyDefaultPolicyLabelIsEnabled"))if(this.FTc())this.ixd=!0;else if(!this.Gsd)if(this.Gsd=!0,this.ui=this.tk.value.Mv,this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)){if(this.ui&&this.ui.DefaultLabelId)if(!this.ui.AppliedPolicyId)e.ULS.sendTraceTag(509732190,
306,50,"Default labeling triggered. DefaultLabelType: {0}",this.ui.DefaultLabelType),this.fJa(this.ui.DefaultLabelId,null,1);else if(r.a.Tq().equals(this.ui.DefaultLabelType,"documentLibraryDefault")){const z=this.rA[this.ui.AppliedPolicyId],U=this.rA[this.ui.DefaultLabelId];this.ui.AppliedPolicyId!==this.ui.DefaultLabelId&&r.a.Tq().equals(this.ui.PolicyLabelAssignmentMethod,"standard")&&z.Order<U.Order&&(e.ULS.sendTraceTag(509732189,306,50,"Default labeling triggered. DefaultLabelType: {0}",this.ui.DefaultLabelType),
this.fJa(this.ui.DefaultLabelId,null,1))}}else this.ui&&this.ui.DefaultLabelId&&!this.ui.AppliedPolicyId&&(e.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.ui.DefaultLabelId),this.fJa(this.ui.DefaultLabelId,null,1))}aCe(){if(!this.tk.value.gzg()){var z=this.rA[this.ui.AppliedPolicyId];this.fPb&&this.SKa&&this.ukb!==this.SKa.id&&(!z||z.Order<this.SKa.sensitivityLabel.Order)&&(z=this.fJa(this.SKa.id,{},4),32!==z?e.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+
z):(this.ukb=this.SKa.id,this.Nya&&(z=this.rA[this.Nya])&&z.Order<=this.SKa.sensitivityLabel.Order&&(this.tk.value.Bwa(29),this.Nya=null)));z=this.rA[this.tk.value.Mv.AppliedPolicyId];if(this.Gza&&this.Nya!==this.Gza.id&&(!z||z.Order<this.Gza.sensitivityLabel.Order)){const U=this.Gza.id;this.tk.value.Bwa(29);this.tk.value.NAc(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.d2d(this.Gza.sensitivityLabel))+" "+this.Gza.mKk,CommonUIStrings.l_PolicyLabelRecommendationButton,
()=>{this.fJa(U,{},8)});this.Nya=this.Gza.id}this.Gza=this.SKa=null}}setPolicyLabel(z,U,ka,Ba=2){this.J9a()?U&&(this.P$e=!0):this.E1=U;this.tk.value.setPolicyLabel(z);this.Oh.updateCommandUI();ka=new bm(Ba,this.d2d(this.rA[z]));this.tk.value.nLe(z,this.J9a()?U:this.E1,ka)}bwi(z,U,ka,Ba){1===z&&this.setPolicyLabel(U,Ba,ka)}awi(z,U,ka){1===z?this.J9a()?this.fJa(U,null,2,ka):this.setPolicyLabel(U===this.ui.AppliedPolicyId?"":U,ka,""):this.Oh.updateCommandUI()}kOe(z){(new Lf(z,Object(v.a)(this,this.awi,
"continueToSetPolicyLabelFromJustificationDialog"))).kOe()}LOe(z,U){(new yl(z,U,Object(v.a)(this,this.bwi,"continueToSetPolicyLabelFromUDPDialog"))).LOe()}YBc(z="",U=""){const ka=new Zb.StandardDialog;ka.qr=L.AFrameworkApplication.Cca;ka.yd=0;ka.Ue(1,CommonUIStrings.l_DialogClose);ka.DO(z,U,null)}zei(z){1===z&&this.tk.value.VIk()}d$h(){const z=new Zb.StandardDialog;z.qr=L.AFrameworkApplication.Cca;z.yd=1;z.Ue(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);z.Ue(0,CommonUIStrings.l_DialogClose);
z.DO(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,Object(v.a)(this,this.zei,"blockUDPSetLabelHandler"))}isReactRibbonEnabled(){return!!this.Oh&&!!this.Oh.jb&&this.Oh.jb.Do}wwb(){return this.Oh&&this.Oh.jb?this.Oh.jb.wwb:!1}b_f(){return 32}Ohc(z,U,ka,Ba,Ia){if(1===ka)return 32;this.ui=this.tk.value.Mv;if(!this.ui||!Ia)return 32;Ia[Je.value]="";Ia[Je.labelText]="";Ia[Je.alt]=null;Ia[Je.tng]=null;Ia[Je.Uub]=null;Ia[Je.customTooltip]="";
Ia[Je.visible]=!1;Ia[Je.iconColor]="";ka=U=z=Ia[Je.icon]="";if(!this.ui.AreLabelsAvailable){if(!this.Vxd)return 32;z=this.Vxd;ka=Je.dTe;this.Uxd&&(U=this.Uxd)}else if(this.ui.AppliedPolicyId){Ba=null;for(const Ab of this.ui.SensitivityLabels)if(Ab.Id.toLowerCase()===this.ui.AppliedPolicyId.toLowerCase()){Ba=Ab;break}Ba&&(z=this.d2d(Ba),U=Ba.Tooltip,this.PBd=L.AFrameworkApplication.lJ=Ba.IsEndpointProtectionEnabled,ka=this.c$f(Ba))}this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)?(z?(Ia[Je.value]=z,Ia[Je.labelText]=z,Ia[Je.customTooltip]=U,this.pnh(ka,this.PBd,Ia)):this.eb.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ClpUseOutlineImageForNoLabel")?(Ia[Je.iconColor]=Je.dTe,this.ui.MandatoryLabelingEnforced?(Ia[Je.value]=Ia[Je.labelText]=HeaderStrings.SelectASensitivityLabel,Ia[Je.icon]=Je.MJk):(Ia[Je.value]=Ia[Je.labelText]=HeaderStrings.NoSensitivityLabel,Ia[Je.icon]=Je.PJk)):(Ia[Je.iconColor]="#000000",this.ui.MandatoryLabelingEnforced?(Ia[Je.value]=
Ia[Je.labelText]=HeaderStrings.SelectASensitivityLabel,Ia[Je.icon]="MipTagErrorDynamicColor_20"):(Ia[Je.value]=Ia[Je.labelText]=HeaderStrings.NoSensitivityLabel,Ia[Je.icon]="MipTagQuestionDynamicColor_20")),Ia[Je.visible]=!0):z&&(Ia[Je.value]=z,Ia[Je.labelText]=z,this.wwb()?Ia[Je.customTooltip]=U:Ia[Je.alt]=U,this.pnh(ka,this.PBd,Ia),Ia[Je.visible]=!0);return 32}d2d(z){return z?this.rA?z.ParentId&&this.rA[z.ParentId]?this.rA[z.ParentId].DisplayName+"\\"+z.DisplayName:z.DisplayName:(e.ULS.sendTraceTag(4282E4,
306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),z.DisplayName):""}pnh(z,U,ka){this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(ka[Je.icon]=this.Qgg(U),ka[Je.iconColor]=this.Rgg(z)):this.wwb()?ka[Je.icon]=U?Je.ojl:Je.rjl:(ka[Je.tng]=L.AFrameworkApplication.gm,ka[Je.Uub]=U?fj.getImageClass(Je.pjl):fj.getImageClass(Je.sjl))}pAi(z){const U=this.Et("LearnMoreSection",!0);z=Object.assign(new Re.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",
MenuItemId:z,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:L.AFrameworkApplication.gm,Image16by16Class:fj.getImageClass(Je.LUj),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(U.ControlList,z);return U}MVf(z,U,ka=!1){let Ba;Ba="Toggle_"+z.Id;Ba="Sensitivity_"+Ba;const Ia=z.DisplayName,Ab=z.Tooltip;var Ob=z.Id===this.ui.AppliedPolicyId,Yb=ka?I.a.je(Ba):Ba;this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(Ob=this.c$f(z),
U=Object.assign(new W.a,{Id:Yb,ExternalId:Yb,LabelText:ka?I.a.je(Ia):Ia,Command:"2935633379",MenuItemId:Yb,QueryCommand:"991261903",Visible:!0,Alt:ka?I.a.je(Ab):Ab,AriaLabel:ab.a.Qob,IconColor:this.Rgg(Ob),KeyTip:U}),U.ExternalImageId=this.Qgg(z.IsEndpointProtectionEnabled)):(Yb=Object.assign(new oo.a,{Id:Yb,ExternalId:Yb,LabelText:ka?I.a.je(Ia):Ia,Command:"2935633379",MenuItemId:Yb,QueryCommand:"991261903",CheckedImage:L.AFrameworkApplication.gm,Visible:!0,Alt:ka?I.a.je(Ab):Ab,IsChecked:Ob,AriaLabel:ab.a.Qob,
KeyTip:U}),this.isReactRibbonEnabled()?(Yb.CheckedImageClass=fj.getImageClass(Je.AEe),Yb.ExternalImageId=Je.AEe):Yb.CheckedImageClass=fj.getImageClass(Je.SOf),U=Yb);Yb=Ba;this.dQb[Yb]=z.Id;this.ulf[z.Id]=Yb;return U}Et(z,U=!1){return Object.assign(new mh.a,{Title:"",Id:z,DisplayMode:Je.menu,ShowMenuSectionSeparator:U,ControlsId:"Ctrl_"+z,ControlList:[]})}qDi(z,U,ka,Ba){z=ah.Vfh()?this.Et(z+"Sub"):this.Et(U+"Sub");U=1;for(let Ia of ka)(ka=this.rA[Ia])&&ka.Enabled&&(Array.add(z.ControlList,this.MVf(ka,
U.toString(),Ba)),U++);return z}OGc(z=!1){const U=this.Et("SensitivitySection");let ka=1;const Ba=this.bpa;for(let Ab in Ba){const Ob=Ba[Ab],Yb=this.rA[Ab];if(Yb&&Yb.Enabled){if(Ob.count){const uc="Sensitivity_"+Yb.Name;var Ia=z?I.a.je(uc):uc;Ia=ah.Vfh()?"Label"+this.ILh++:Ia;const mc=Object.assign(new ho.a,{Id:Ia,ExternalId:Ia,LabelText:z?I.a.je(Yb.DisplayName):Yb.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new jh.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),
ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:ab.a.Qob,KeyTip:ka.toString(),Alt:z?I.a.je(Yb.Tooltip):Yb.Tooltip});this.isReactRibbonEnabled()?mc.ExternalImageId=Je.AEe:(mc.Image16by16=L.AFrameworkApplication.gm,mc.Image16by16Class=fj.getImageClass(Je.SOf));Array.add(mc.Menu.MenuSectionList,this.qDi(Ia,uc,Ob,z));Array.add(U.ControlList,mc);this.dQb[mc.Id]=Yb.Id;this.ulf[Yb.Id]=mc.Id}else Array.add(U.ControlList,this.MVf(Yb,ka.toString(),z));ka++}}return U}CTb(z){return!!this.Ca.xS(z)&&
!!this.Ca.xS(z).flags&&!!this.Ca.xS(z).flags.length}Prk(z,U){U.onSuccess&&this.rA&&(z=this.rA[this.tk.value.Mv.AppliedPolicyId])&&(this.Nya&&(U=this.rA[this.Nya])&&U.Order<=z.Order&&(this.tk.value.Bwa(29),this.Nya=null),this.ukb&&this.ukb!==z.Id&&(this.tk.value.Bwa(28),this.ukb=null))}Qgg(z){return z?Je.OJk:Je.NJk}Rgg(z){return z?z:Je.dTe}c$f(z){if(z.Color||!z.ParentId)return z.Color;const U=this.rA[z.ParentId];return U?U.Color:z.Color}Etl(z){switch(z){case 2:case 14:case 15:return 1;case 21:return 2;
default:return 0}}static Vfh(){if(null!=ah.Pxc)return ah.Pxc;L.AFrameworkApplication.qta("ce2ai523-t;6f627846-c");ah.Pxc=L.AFrameworkApplication.fa?L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.RenameCLPControlIds",!1):!1;return ah.Pxc}static Lfb(z){L.AFrameworkApplication.fa&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(z?(xi.a.jea("ribbon","sensitivity"),xi.a.iea("ribbon","sensitivity")):xi.a.Y9("ribbon",
"sensitivity"));L.AFrameworkApplication.fa&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&ld.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!z))}static Va(z){return z&&z.length?!1:!0}}ah.Pxc=null;Object(h.a)(ah,"PolicyActor",null,[557]);var aj=d(1169),cm;(function(z){z[z.unknown=0]="unknown";z[z.boot=1]="boot";z[z.refresh=2]="refresh";z[z.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(cm||(cm={}));
Object(h.b)("GetPolicyLabelsReason",cm);class Fn extends Sys.EventArgs{constructor(z,U,ka,Ba,Ia,Ab){super();this.upb=z;this.title=U;this.message=ka;this.buttonText=Ba;this.tVb=Ia;this.lVc=Ab}}Object(h.a)(Fn,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class yi extends Sys.EventArgs{constructor(z,U,ka,Ba,Ia){super();this.upb=z;this.title=U;this.message=ka;this.buttonText=Ba;this.tVb=Ia}}Object(h.a)(yi,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var Bm;(function(z){z[z.none=
0]="none";z[z.reasonDefaultLabel=1]="reasonDefaultLabel";z[z.reasonManual=2]="reasonManual";z[z.reasonAutomatic=4]="reasonAutomatic";z[z.reasonRecommended=8]="reasonRecommended";z[z.reasonMandatory=16]="reasonMandatory"})(Bm||(Bm={}));Object(h.b)("ApplyLabelFlags",Bm);class Un extends Sys.EventArgs{constructor(z,U,ka){super();this.KQf=z;this.JQf=U;this.existingLabelPriority=ka}}Object(h.a)(Un,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);class Gn extends Sys.EventArgs{constructor(){super()}}Object(h.a)(Gn,
"GetPolicyLabelEventArgs",Sys.EventArgs,[]);class mm extends Sys.EventArgs{constructor(){super()}}Object(h.a)(mm,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class Hn{constructor(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelType=this.DefaultLabelId=null;this.AreLabelsAvailable=!1;this.AppliedPolicyId=
"";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelType=this.DefaultLabelId="";this.SensitivityLabels=[];this.MandatoryLabelingEnforced=!1;this.CustomUrl=""}}Object(h.a)(Hn,"GetPolicyLabelsData",null,[]);class vk extends Sys.EventArgs{constructor(z=!1){super();this.onSuccess=z}}Object(h.a)(vk,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);class po extends Sys.EventArgs{constructor(z,U){super();this.RTg=z;this.LJd=U}}Object(h.a)(po,
"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);class dm extends Sys.EventArgs{constructor(z,U,ka,Ba){super();this.title=z;this.ayk=U;this.buttonText=ka;this.nkk=Ba}}Object(h.a)(dm,"PolicyTipEventArgs",Sys.EventArgs,[]);class Go extends Sys.EventArgs{constructor(z,U){super();this.upb=z;this.lVc=U}}Object(h.a)(Go,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);class si extends Sys.EventArgs{constructor(){super()}}Object(h.a)(si,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",
Sys.EventArgs,[]);class qo extends Sys.EventArgs{constructor(z,U){super();this.$6g=z;this.V6=U}}Object(h.a)(qo,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);class nm extends Sys.EventArgs{constructor(z,U,ka,Ba=null,Ia=null,Ab=null,Ob=null){super();this.errorType=z;this.uel=ka;this.title=Ba;this.message=Ia;this.buttonText=Ab;this.tVb=Ob}}Object(h.a)(nm,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);class wc extends Sys.EventArgs{constructor(){super()}}Object(h.a)(wc,"SetPolicyLabelTriggeredEventArgs",
Sys.EventArgs,[]);class Ql extends Sys.EventArgs{constructor(z){super();this.Val=z}}Object(h.a)(Ql,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var Ho=d(675),Yj=d(442);class Tk{static $3k(z,U){if(!z||!U||z.count!==U.count)return!1;for(let ka of z)if(!U.contains(ka))return!1;return!0}static toArray(z){if(!z)return null;const U=Array(z.count);let ka=0;for(let Ba of z)U[ka]=Ba,ka++;return U}}Object(h.a)(Tk,"HashSetUtils",null,[]);var Fe=d(760);class Io{constructor(z,U,ka,Ba=0,Ia=null){this.Csd=
this.c3e=null;this.gNa=this.dOb=this.eOb=0;this.Rfa="";this.s2a=this.Wdf=this.Bqd=this.mwd=this.yya=this.Nyd=null;this.S$e=!1;this.E_a=null;this.rvd=0;this.ixc=this.v2a=this.C0a=this.hxc=null;this.Pa=new qk.a;this.dlc=this.h1b=this.MR=null;this.hwd=!1;this.U6b=null;this.eb=z;this.$h=U;this.Vh=ka;this.Kvc=Ba;this.Mv=new Hn;this.tlf=this.eb.Ga("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.XF=Ia;this.u4b=z.ka("WacApplyManualPolicyLabelIsEnabled");this.D4b=z.ka("CoAuthForProtectedFilesIsEnabled");
this.Thb=z.ka("SupportsOfficeClientCoauthoring");this.uPj=!1;this.i6k=3E4;this.Rd=Yf.a.instance;z.ka("SupportsPolicies")&&ce.a("MipSupportsPolicies");this.D4b&&this.Thb&&ce.a("MipSupportsOfficeClientCoauthoring")}get V9d(){return this.hwd}n7h(z){this.Pa.addHandler("PolicyTipEvent",z)}wId(z){this.Pa.addHandler("LabelInfoUpdateEvent",z)}qRk(z){this.Pa.removeHandler("LabelInfoUpdateEvent",z)}UId(z){this.Pa.addHandler("SetPolicyLabelEventKey",z)}Ofh(z){this.Pa.removeHandler("SetPolicyLabelEventKey",z)}FFf(z){this.Pa.addHandler("SetPolicyLabelFailureEventKey",
z)}r5h(z){this.Pa.addHandler("GetAutoPolicyLabelEventKey",z);this.V9d&&(e.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.lEe(new Gn(0)))}b5h(z){this.Pa.addHandler("CreateAutoCLPSecurityNodesEventKey",z)}y8h(z){this.Pa.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",z)}z8h(z){this.Pa.addHandler("UpdateAutoCLPSITNodesEventKey",z)}G4h(z){this.Pa.addHandler("AddAutoPolicyBusinessBarEntryEventKey",z)}z7h(z){this.Pa.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",
z)}H4h(z){this.Pa.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",z)}A7h(z){this.Pa.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",z)}L5h(z){this.Pa.addHandler("MandatoryLabellingAppHandlerEventKey",z)}v8h(z){this.Pa.addHandler("UDPLabelingAppHandlerEventKey",z)}get YHj(){if(!this.c3e)return!1;for(const z of this.c3e.tZd())if(!z.Capabilities||!z.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}get Myg(){return!!this.MR}Cyj(z){z&&this.D4b&&this.Thb&&z.execute(Object(v.a)(this,
this.vLd,"awaitRtc"))}KNk(z){this.mwd=z}zni(){return this.mwd?this.mwd():!1}zMk(z){this.Bqd=z}gF(){return(new Date).getTime()}vLd(z){if(!this.Myg){var U=z.GL.task;U.continueWith(()=>{this.MR=U.result;this.MR.zAa(Object(v.a)(this,this.Dnk,"onLabelChangeUpdateOverRtc"))})}}Dnk(z,U){12===U.type&&(this.Wdf?this.Wdf():this.FQa(this.Rfa,2,this.yya,!0))}nag(){this.Vh&&(this.hxc=this.Vh.zi("WebServiceCall","Call Get Policy Endpoint On Server"));var z=Fe.a.oBa(1,1);this.eb.ka("SendHostAttributionInfoForPolicyLabelEnabled")?
(z=new Ho.a(this.Ntb("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,z),this.$h.send(z).AFb(Object(v.a)(this,this.QZg,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.PZg,"onDataLossPolicyFailureCallback"))):this.$h.yj(this.Ntb("datalosspolicy"),1,null,null,!0,2,Object(v.a)(this,this.QZg,"onDataLossPolicySuccessCallback"),Object(v.a)(this,this.PZg,"onDataLossPolicyFailureCallback"),null);this.eOb++;e.ULS.sendTraceTag(25565151,
306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.tlf,this.eOb)}ZLk(){this.FQa(this.Rfa,2,this.yya)}FQa(z,U=0,ka=null,Ba=!1){u.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.R_d(void 0,U));this.h1b=this.gF();const Ia=this.cRd(U);this.eNc(z,Ia,ka,Ba,U);this.ZGe(!0)}QZg(z){this.Z6g();let U="";({data:U}=this.NTe(z)).returnValue&&(e.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.eOb=
0,this.Vh&&(this.ixc=this.Vh.zi("Task","Parse and Handle Get Policy Response")),this.gvk(U),this.ixc&&(this.ixc.stop(),this.ixc=null))}PZg(z){this.Z6g();this.eOb<=this.Kvc?this.nag():(e.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",z?z.data?z.data.iGb:null:null),this.eOb=0)}gzg(){return 0<this.gNa}setPolicyLabel(z){this.Mv.AppliedPolicyId=z}nLe(z,U,ka=null){const Ba=this.Yzi(ka);this.h6k(z,U,Ba,ka)}a2g(z){this.v2a&&(this.v2a.stop(),this.v2a=
null);let U,ka;({llh:U,Snh:ka}=this.zfg(z));const Ba=z.data.state,Ia=Ba?Ba.V6:2;let Ab="";({data:Ab}=this.NTe(z)).returnValue?(e.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",Ia),this.gNa=0,this.Mvk(Ab,U,ka,Ba)):this.WHe(Ia)}lIk(z){u.Health.instance.recordKpiUsage("MipSetPolicyLabel",0,"officewebclp",this.R_d(z));this.dlc=this.gF();e.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.Pa.raiseEvent("SetPolicyLabelTriggeredEventKey",
new wc(z))}cik(){this.D4b&&this.Thb&&this.Myg&&this.MR.$ea(12,null,!0)}$1g(z){this.v2a&&(this.v2a.stop(),this.v2a=null);let U;({llh:ka,Snh:U}=this.zfg(z));if(this.gNa<=this.Kvc)this.nLe(ka,U);else{var ka=(ka=z.data.state)?ka.V6:2;e.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",z?z.data?z.data.iGb:null:null,ka);this.U6b="WACServerConnectionFailed";this.gNa=0;this.WHe(ka)}}tOj(z){if(z&&("LabelNotSupported"===z||"LabelErrorRetryLater"===
z||"CoherencyFailure"===z||"LabelIdNotFound"===z||"LabelDisabled"===z))return e.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",z),!0;e.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",z);return!1}ili(z){if(!z)return!1;let U=null,ka=null;for(const Ba of this.Mv.SensitivityLabels)Ba.Id===z&&(U=Ba),Ba.Id===this.Rfa&&(ka=Ba);if(!U)return!1;if(this.D4b&&this.Thb){if(this.Bqd&&this.Bqd()||this.YHj)return!0}else if(L.AFrameworkApplication.yA&&L.AFrameworkApplication.yA.rCa||
this.yya&&this.yya())return!0;return U.IsEndpointProtectionEnabled===(!!ka&&ka.IsEndpointProtectionEnabled)}NAc(z,U,ka,Ba,Ia){28===z?this.Lah(new Fn(z,U,ka,Ba,Ia,!1)):this.Lah(new Fn(z,U,ka,Ba,Ia,!0))}Bwa(z){28===z?this.mbh(new Go(z,!1)):this.mbh(new Go(z,!0))}JGk(z,U,ka){e.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.Pa.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new Un(z,U,ka))}YIk(z){e.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");
this.Pa.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new Un(null,null,z))}ZIk(z,U){e.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.Pa.raiseEvent("UpdateAutoCLPSITNodesEventKey",new Un(z,U,null))}$ah(z,U){e.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===U?"Reading":"Edit")+" switch event.");this.Pa.raiseEvent("MandatoryLabellingAppHandlerEventKey",new po(z,U))}RHd(z,U,ka,Ba,Ia){37===z&&this.nGk(new yi(37,U,ka,Ba,Ia))}PFe(){this.WHk(new si)}VIk(){e.ULS.sendTraceTag(540608322,
306,50,"Raising a UDP labeling event.");this.Pa.raiseEvent("UDPLabelingAppHandlerEventKey",new Ql(!0))}Oob(z=!1){const U=!!this.Mv&&this.Mv.AreLabelsAvailable&&!!this.Mv.SensitivityLabels&&0<this.Mv.SensitivityLabels.length&&cj.a.any(this.Mv.SensitivityLabels,ka=>!!ka&&ka.Enabled);U||z||ah.Lfb(!1);return U}V_g(z){this.C0a&&(this.C0a.stop(),this.C0a=null);var U="";this.ZGe(!1);({data:U}=this.NTe(z)).returnValue?(e.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.dOb=
0,U=this.xvk(U),z=this.keg(z.data),u.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.$Lc(void 0,z,this.h1b)),this.h1b=null,z=new Gn(z),this.bHk(z),this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?U&&this.y$k()?this.V9d?this.rvl():(this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)||this.qGc(),this.lEe(z),this.hwd=!0):U||this.Idd():!this.V9d&&U&&this.eb.ka("WacApplyManualPolicyLabelIsEnabled")&&this.CIf()?
(this.lEe(z),this.hwd=!0):U||this.Idd()):this.Idd()}y$k(){if(!this.eb.ka("WacApplyManualPolicyLabelIsEnabled"))return e.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.CIf())return!1;if(""===this.Rfa)return e.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.E_a===this.rvd)return e.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),
!1;e.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0}qGc(){this.JCh();e.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.s2a.count,this.E_a);const z=Tk.toArray(this.s2a);this.JGk(z,z,this.E_a)}rvl(){var z=this.s2a;this.JCh();Tk.$3k(z,this.s2a)||(e.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.s2a.count),
z=Tk.toArray(this.s2a),this.ZIk(z,z));this.S$e&&(e.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.E_a),this.YIk(this.E_a))}JCh(){const z=new aj.a(r.a.Tq());for(const U of this.Mv.SensitivityLabels)if(U&&U.AutoLabelingSensitiveTypeIds&&0<U.AutoLabelingSensitiveTypeIds.length)for(const ka of U.AutoLabelingSensitiveTypeIds)ka&&z.add(ka);this.s2a=z}U_g(z){const U=this.keg(z.data);u.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",
!1,!1,this.$Lc(void 0,U,this.h1b));this.h1b=null;this.C0a&&(this.C0a.stop(),this.C0a=null);if(this.dOb<=this.Kvc){if(this.eb.ka("SendHostAttributionInfoForPolicyLabelEnabled")){const ka=z.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in ka&&ka[Fe.a.TIe]&&"HostAttributionInfo.ScenarioTypeParamName"in ka&&ka[Fe.a.UIe]){z.data.request.get_headers();z.data.request.get_headers();z=this.cRd(U);this.eNc(this.Rfa,z,this.yya,void 0,U);return}}this.FQa(this.Rfa,U,this.yya)}else e.ULS.sendTraceTag(34996494,
306,15,"Request to get label policy failed with error response: {0}.",z?z.data?z.data.iGb:null:null),this.Idd(),this.dOb=0,this.ZGe(!1)}keg(z){return z.state?z.state:0}Ntb(z,U=!1){let ka=String.format("{0}{1}?action={2}&{3}",this.eb.Ga("PolicyHandlerWebServiceBase")||L.AFrameworkApplication.Aa.jb.Xla,this.tlf,z,L.AFrameworkApplication.hh);"setpolicylabel"===z&&L.AFrameworkApplication.yA&&L.AFrameworkApplication.yA.X$d&&(ka=D.a.Ri(ka,"sl","1"));U&&(ka=D.a.Ri(ka,"cbd","1"));return ka}zfg(z){let U,ka;
U=ka=null;z&&z.data&&z.data.request&&z.data.request.get_headers()&&(U=z.data.request.get_headers()[Yj.a.mlh],ka=z.data.request.get_headers()[Yj.a.Tnh]);return{llh:U,Snh:ka}}NTe(z){z=z?z.data?z.data.Sd:null:null;return z&&z.length&&!this.qPj(z)?{returnValue:!0,data:z}:(e.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:z})}gvk(z){let U;try{U=Q.b(z)}catch(ka){e.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(U)if(U.IsPolicyTipAvailable)switch(U.IsPolicyTipAvailable.toLowerCase()){case "false":e.ULS.sendTraceTag(26007261,
306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":e.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.Csd=U.NavigateUrl;this.Oel(U.GeneralText,Object(v.a)(this,this.ilk,"onDataLossPolicyOverrideButtonClick"));break;default:e.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",U.IsPolicyTipAvailable)}else e.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");
else e.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")}Qwi(z){switch(z){case "CoherencyFailure":return 1;case "DisabledByPolicy":return 2;case "FileCheckedOut":return 3;case "FileEncrypted":return 4;case "FileLocked":return 5;case "FileNotSupported":return 6;case "FileTooLarge":return 7;case "InvalidOperationOnZeroByteFile":return 8;case "LabelDisabled":return 9;case "LabelErrorRetryLater":return 10;case "LabelIdNotFound":return 11;case "LabelIrmDisabledByTenant":return 12;
case "LabelNotSupported":return 13;case "MinorVersionLimitExceeded":return 15;default:return 0}}Mvk(z,U,ka,Ba){var Ia=Ba?Ba.V6:2;let Ab=0,Ob="",Yb;if(({ou:Yb}=Q.d(z)).returnValue)if(Yb){Ob="Success";z=this.cRd(3);if(Yb.IsSuccessful){u.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.$Lc(Ia,void 0,this.dlc));this.U6b=this.dlc=null;e.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",Ia);2===Ia&&this.Bwa(29);
this.c7k(U,Ia);this.cik();this.Bwa(28);Ba&&4===Ia&&this.NAc(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,Ba.displayName),CommonUIStrings.l_DialogOk,()=>{});ce.a("MipAppliedLabels",void 0,void 0,[Object.assign(new hf.a,{name:"SetPolicyLabelApplyFlag",string:Bm[Ia]})]);this.eNc(U,z,this.yya,void 0,3);return}e.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",
Ia,Yb.FailureReason);this.U6b=Yb.FailureReason;this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ImproveSetLabelFailureErrMsg",!1)?Ab=this.Qwi(Yb.FailureReason):"FileTooLarge"===Yb.FailureReason?Ab=7:"LabelNotSupported"===Yb.FailureReason?Ab=13:"LabelDisabled"===Yb.FailureReason?Ab=9:"MinorVersionLimitExceeded"===Yb.FailureReason&&(Ab=15);this.uPj&&0<=Yb.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(Ba=new ad.a(2,1,this.i6k,()=>{e.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",
this.gNa);this.gNa<=this.Kvc&&this.nLe(U,ka)}),this.Rd.Cb(Ba));this.D4b&&this.Thb&&this.eNc(this.Mv.AppliedPolicyId,z,this.yya,!0,3)}else Ob="setPolicyLabelData null.",e.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",Ia);else Ob="TryDeserialize failed.",e.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",Ia);this.WHe(Ia,Ab);Ia=this.$Lc(Ia,void 0,this.dlc);
this.dlc=null;Ia.extendedProperties.set("SetPolicyLabelDataFailureReason",this.U6b);Ia.extendedProperties.set("SetPolicyLabelDataParseStatus",Ob.toString());u.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,Ia)}WHe(z,U=0){const ka=2===z||8===z||16===z;this.setPolicyLabel(this.Rfa);this.Yah(new vk);this.wbh(U,z,ka,!1)}c7k(z,U){this.setPolicyLabel(this.Rfa=z);if(""===z)L.AFrameworkApplication.lJ=!1,L.AFrameworkApplication.CZb=!1;else for(const ka of this.Mv.SensitivityLabels)if(ka.Id===
z){L.AFrameworkApplication.lJ=ka.IsEndpointProtectionEnabled;break}this.kIk(new qo(z,U))}bxl(){for(const z of this.Mv.SensitivityLabels)z&&z.Enabled&&(z.Id===this.Rfa&&(this.S$e=this.E_a!==z.Order,this.E_a=z.Order),z.Order>this.rvd&&(this.rvd=z.Order))}xvk(z){if(!({ou:z}=Q.d(z)).returnValue)return e.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!z)return e.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),
!1;if(!z.AreLabelsAvailable)return!1;this.Mv=z;this.Rfa=z.AppliedPolicyId;this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.bxl();this.Oob()&&e.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");this.Yah(new vk(!0));return!0}CIf(){if(!this.Oob())return e.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(const z of this.Mv.SensitivityLabels)if(z&&
z.AutoLabelingSensitiveTypeIds&&0<z.AutoLabelingSensitiveTypeIds.length)return!0;e.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1}Yah(z){e.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.Pa.raiseEvent("LabelInfoUpdateEvent",z)}bHk(z){e.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.Pa.raiseEvent("GetPolicyLabelEventKey",z)}Idd(){ah.Lfb(!1);this.Pa.raiseEvent("GetPolicyLabelFailureEventKey",
new mm)}lEe(z){this.XF&&this.XF.execute(U=>{U=[U.isFeatureEnabled("MsoClpSpTwo",!0),U.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(U).then(ka=>{cj.a.any(ka,Ba=>Ba)&&(e.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),this.Pa.raiseEvent("GetAutoPolicyLabelEventKey",z),this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSecurityNodesAfterLicenseCheck",!1)&&this.qGc(),ce.a("MipAutoClassificationEnabled"));return null})})}R_d(z=null,U=null){const ka=new Map;
ka.set("ClpCoauth",this.Thb.toString());null!=z&&ka.set("ApplyLabelFlags",Bm[z]);null!=U&&ka.set("GetPolicyLabelsReason",cm[U]);return ka}$Lc(z=null,U=null,ka=null){const Ba=new ya.a;Ba.extendedProperties=this.R_d(z,U);null!=ka&&(Ba.durationMs=this.gF()-ka);return Ba}kIk(z){e.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.Pa.raiseEvent("SetPolicyLabelEventKey",z)}Lah(z){e.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");z&&z.lVc&&ce.a("MipRecommendations");
this.Pa.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",z)}mbh(z){e.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.Pa.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",z)}nGk(z){e.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.Pa.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",z)}WHk(z){e.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");
this.Pa.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",z)}Oel(z,U=null){e.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.Pa.raiseEvent("PolicyTipEvent",new dm(CommonUIStrings.l_PolicyBusinessBarTitle,z,CommonUIStrings.l_PolicyOverrideButton,U))}wbh(z,U,ka,Ba=!0){e.ULS.sendTraceTag(42074656,306,Ba?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",U);Ba=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;let Ia=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,
Ab=null,Ob=null;switch(z){case 2:Ba=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarTitle;Ia=CommonUIStrings.l_SensitivityApplicationErrorDisabledByPolicyBusinessBarMessage;break;case 5:Ia=CommonUIStrings.l_SensitivityApplicationErrorFileLockedBusinessBarMessage;break;case 7:Ba=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;Ia=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;break;case 13:Ba=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;
Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 9:Ba=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 10:Ia=CommonUIStrings.l_SensitivityApplicationErrorLabelErrorRetryLaterBusinessBarMessage;break;case 14:Ba=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;Ia=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;
break;case 15:Ba=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,Ia=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,Ab=CommonUIStrings.l_LearnMore,Ob=()=>{this.j6k()}}z=new nm(z,U,ka,Ba,Ia,Ab,Ob);this.Pa.raiseEvent("SetPolicyLabelFailureEventKey",z)}bLe(z){this.Nyd=z}ilk(){this.Csd?(e.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),Pb.a.mLc(this.Csd)):e.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")}qPj(z){if(!z.startsWith("<")||
-1===z.indexOf("Error")&&-1===z.indexOf("Unavailable"))return!1;e.ULS.sendTraceTag(25565189,306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0}Z6g(){this.hxc&&(this.hxc.stop(),this.hxc=null)}pZi(z){if(!z)return"manual";switch(z.V6){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}}v_i(z){if(!z)return"privileged";
z=z.V6;let U="privileged";if(4===z||1===z)U="standard";return U}eNc(z,U,ka=null,Ba=!1,Ia=0){this.eb.ka("WacLabelingGetPolicyLabelsIsEnabled")&&(this.Rfa=z,this.yya=ka,this.Vh&&(this.C0a=this.Vh.zi("WebServiceCall","Call Get Policy Endpoint On Server")),ka={},ka[Yj.a.jai]=z,this.eb.ka("SendHostAttributionInfoForPolicyLabelEnabled")?(z=new Ho.a(this.Ntb("getpolicylabels",Ba),1,null,ka,!0,2,Ia,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,U),this.$h.send(z).AFb(Object(v.a)(this,
this.V_g,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.U_g,"onGetPolicyLabelsFailureCallback"))):this.$h.yj(this.Ntb("getpolicylabels",Ba),1,null,ka,!0,2,Object(v.a)(this,this.V_g,"onGetPolicyLabelsSuccessCallback"),Object(v.a)(this,this.U_g,"onGetPolicyLabelsFailureCallback"),Ia,void 0,void 0,void 0,void 0,"22"),this.dOb++,e.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",this.dOb))}h6k(z,U,ka,Ba=null){if(this.u4b){this.Vh&&(this.v2a=this.Vh.zi("WebServiceCall",
"Call Set Policy Endpoint On Server"));var Ia={};Ia[Yj.a.mlh]=z;U&&(Ia[Yj.a.Tnh]=encodeURIComponent(U));this.Nyd&&(Ia[Yj.a.I$h]=this.Nyd);Ba?(Ia[Yj.a.Qnh]=this.pZi(Ba),Ia[Yj.a.Rnh]=this.v_i(Ba)):(Ia[Yj.a.Qnh]="manual",Ia[Yj.a.Rnh]="privileged");this.Thb&&this.Mv&&(Ia[Yj.a.$xk]=this.Mv.PolicyLabelVersionToken);this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelForSPODocLibEnabled",!1)&&1===Ba.V6&&this.Mv.DefaultLabelType&&(Ia[Yj.a.g6k]=this.Mv.DefaultLabelType);this.eb.ka("SendHostAttributionInfoForPolicyLabelEnabled")?
(z=new Ho.a(this.Ntb("setpolicylabel",!0),1,null,Ia,!0,2,Ba,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ka),this.$h.send(z).AFb(Object(v.a)(this,this.a2g,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.$1g,"onSetPolicyLabelFailureCallback"))):this.$h.yj(this.Ntb("setpolicylabel",!0),1,null,Ia,!0,2,Object(v.a)(this,this.a2g,"onSetPolicyLabelSuccessCallback"),Object(v.a)(this,this.$1g,"onSetPolicyLabelFailureCallback"),Ba,void 0,void 0,void 0,void 0,
"32");this.gNa++;e.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.gNa)}else e.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")}j6k(){const z=new Zb.StandardDialog,U=this.eb.Ga("BreadcrumbFolderUrl");U?(z.yd=11,z.Ue(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),z.Ue(2,CommonUIStrings.l_DialogOk)):(z.yd=0,z.Ue(1,CommonUIStrings.l_DialogOk));
z.NHd(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");z.MPk();z.DO(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,ka=>{1===ka&&U&&Pb.a.an(U,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})}cRd(z){switch(z){case 1:return Fe.a.oBa(1,1);case 2:return Fe.a.oBa(7,1);case 3:return Fe.a.oBa(8,
1);default:return Fe.a.oBa(7,0)}}Yzi(z=null){if(!z)return Fe.a.oBa(8,0);switch(z.V6){case 1:case 16:return Fe.a.oBa(1,1);case 4:case 2:case 8:return Fe.a.oBa(8,1);default:return Fe.a.oBa(8,0)}}ZGe(z){this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&appChrome.api.setAsyncRequestStatus("sensitivity",z)}}Object(h.a)(Io,"PolicyManager",null,[517]);class Mj{constructor(){this.IDd=this.rBd=this.Qff=this.ptf=this.TYe=this.Wn=this.KMa=this.Da=this.tk=null}get name(){return"Common.App.Policy"}init(){L.AFrameworkApplication.fa.ka("ShouldInitCommonPolicyPackage")&&
(L.AFrameworkApplication.fa.ka("IsDataLossPreventionEnabledForUser")&&L.AFrameworkApplication.Aa&&(this.tk=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.tk.n7h(Object(v.a)(this,this.Nel,"showPolicyBusinessBar")),e.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),fl.a.get_instance().gk(6,()=>{this.tk.nag()})),L.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&L.AFrameworkApplication.fa.ka("SupportsPolicies")?fl.a.get_instance().gk(6,Object(v.a)(this,
this.ujk,"onAfterRibbonBehaviorAttached")):ah.Lfb(!1))}dispose(){}Wb(z){z.register(517,"Common.App.Policy.Contracts.IPolicyManager").ma().na(()=>new Io(L.AFrameworkApplication.fa,L.AFrameworkApplication.Ge,L.AFrameworkApplication.Aa.EU,L.AFrameworkApplication.fa.Cc("MaxGetPolicyRetries",1),z.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),L.AFrameworkApplication.Aa.jb.rm));z.register(ah,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").ma().na(()=>
new ah(L.AFrameworkApplication.Ta,L.AFrameworkApplication.Aa,L.AFrameworkApplication.fa,z.le("Common.App.Policy.Contracts.IPolicyManager")));this.Da=z}ujk(){this.Wn=this.Da.qb("CommonUI.BusinessBar");this.tk||(this.tk=this.Da.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.KMa=this.Da.resolve("Common.App.Policy.PolicyActor");L.AFrameworkApplication.fa&&L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&ld.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.tk.wId(Object(v.a)(this.KMa,this.KMa.pdh,"registerActionsHandler")):this.KMa.ub();this.tk.wId(Object(v.a)(this,this.axl,"updateLabelInfo"));L.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&(this.tk.FFf(Object(v.a)(this,this.prj,"handleSetPolicyLabelFailure")),this.tk.G4h(Object(v.a)(this,this.NAc,"addAutoPolicyBusinessBarEntry")),this.tk.z7h(Object(v.a)(this,this.Bwa,"removeAutoPolicyBusinessBarEntry")),
this.tk.H4h(Object(v.a)(this,this.RHd,"addMandatoryLabellingBusinessBarEntry")),this.tk.A7h(Object(v.a)(this,this.PFe,"removeMandatoryLabellingBusinessBarEntry")))}axl(){this.KMa.a6k();this.KMa.F4k();this.KMa.uFk();const z=this.tk.zni();L.AFrameworkApplication.fa.ka("HasDocumentEditRights")&&!z?this.KMa.uql():e.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",L.AFrameworkApplication.fa.ka("HasDocumentEditRights"),
z);L.AFrameworkApplication.Aa.updateCommandUI()}Nel(z,U){this.rBd&&this.Wn.Dca(38)&&this.Wn.removeEntry(this.rBd);z=this.ieg(U.title,U.ayk,38,U.nkk,U.buttonText);L.AFrameworkApplication.Aa.jb.PAc(z,!0)?(this.rBd=z,e.ULS.sendTraceTag(34174785,306,50,"Add entry to BusinessBar succeeded. Policy message is shown to user.")):e.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")}prj(z,U){U.uel&&(this.IDd&&this.Wn.Dca(21)&&this.Wn.removeEntry(this.IDd),
z=this.ieg(U.title,U.message,21,null,null,U.tVb,U.buttonText),L.AFrameworkApplication.Aa.jb.PAc(z,!0)?(this.IDd=z,e.ULS.sendTraceTag(42074655,306,50,"Add entry to BusinessBar succeeded. CLP policy message is shown to user.")):e.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user."))}Bwa(z,U){(z=U.lVc?this.ptf:this.TYe)&&this.Wn&&this.Wn.Dca(U.upb)&&this.Wn.removeEntry(z)}NAc(z,U){this.Wn&&(this.tk.Bwa(U.upb),z=new fn.a(U.title,U.message,
null),z.id=U.upb,z.closeable=!0,z.image=3,z.addButton(U.buttonText,U.tVb,U.buttonText,!0),this.Wn.Wh(z,!1),U.lVc?this.ptf=z:this.TYe=z)}RHd(z,U){this.Wn&&(z=new fn.a(U.title,U.message,null),z.id=U.upb,z.closeable=!1,z.image=3,z.addButton(U.buttonText,U.tVb,U.buttonText,!1),this.Wn.Wh(z,!1),this.Qff=z)}PFe(){const z=this.Qff;z&&this.Wn&&this.Wn.Dca(z.id)&&this.Wn.removeEntry(z)}ieg(z,U,ka,Ba=null,Ia=null,Ab=null,Ob=null){z=new fn.a(z,U,null);z.id=ka;z.closeable=!0;Ba&&z.HDf(Ia,Ba);Ab&&z.addButton(Ob,
Ab,Ob);return z}static main(){ua.a.instance.Bc(new Mj)}}Object(h.a)(Mj,"PackageManager",null,[2,3]);var sj=d(287),Vn=d(255),ip=d(128);class zl extends Vn.a{constructor(){super();this.fullDocSITs=this.partialDocSITs=null;this.H_=Object.assign(new ip.a,{T_:zl.getTypeName(),B_:zl.ul()})}static getTypeName(){return"AugLoop_SecurityShared_SecurityShared"}static ul(){return[]}}Object(h.a)(zl,"SecurityShared",Vn.a,[]);class Si extends zl{constructor(){super();this.existingLabelPriority=null;this.H_=Object.assign(new ip.a,
{T_:Si.getTypeName(),B_:Si.ul()})}static getTypeName(){return"AugLoop_SecurityShared_CLP"}static ul(){return["AugLoop_SecurityShared_SecurityShared"]}}Object(h.a)(Si,"CLP",zl,[]);var Qg=d(454),om=d(426),gn=d(676);class pe extends Ig.a{constructor(z){super();this.TenantId=null;this.TenantId=z}Ok(){return 103}}Object(h.a)(pe,"GetAppliedPolicyIdRequest",Ig.a,[]);class Jo extends Sys.EventArgs{constructor(z){super();this.xha=z}}Object(h.a)(Jo,"OnAppliedPolicyReceivedEventArgs",Sys.EventArgs,[]);class jp{constructor(z,
U,ka){this.F9=this.qle=this.Q_c=null;this.va=new qk.a;this.m5b=!1;this.pi=z;this.N$a=U;this.fc=ka;this.N$a.R5h(Object(v.a)(this,this.TYg,"onAppliedPolicyIdReady"));this.N$a.z6h(Object(v.a)(this,this.p0g,"onIsManuallyAppliedReady"))}S5h(z){this.va.addHandler("AppliedPolicyEventReceivedKey",z)}dispose(){this.N$a.zRk(Object(v.a)(this,this.TYg,"onAppliedPolicyIdReady"));this.N$a.WRk(Object(v.a)(this,this.p0g,"onIsManuallyAppliedReady"))}Q8f(z,U){z?(this.F9=z,this.Q_c=U,z=new lm.a(new pe(z),ka=>{this.i$c(ka)},
ka=>this.beb(ka)),this.pi.Cb(z)):Jc.a.J(41735234,822,15,"GetAppliedPolicyIdAsync: tenantId is null or empty")}G7i(z,U){!U||I.a.Va(z)?Jc.a.J(51446608,822,15,"GetIsManuallyAppliedAsync: tenantId or callback is null or empty"):(this.F9=z,this.qle=U,z=new lm.a(new pe(z),ka=>{this.i$c(ka)},ka=>this.beb(ka)),this.pi.Cb(z))}TYg(z,U){z="";I.a.Va(U.xha)||(z=U.xha);"00000000-0000-0000-0000-000000000000"===z?(U=I.a.Va(this.F9)?this.fc.Ga("TenantId"):this.F9,this.Q8f(U,this.Q_c)):this.qwe(z,null)}p0g(z,U){this.wnk(U.m5b)}i$c(z){let U=
null;z.ServerError&&0!==z.ServerError.Code?U=Di.a[z.ServerError.Code]:0!==z.StatusCode&&(U=Vg.a[z.StatusCode]);U&&this.qwe("",U)}beb(){Jc.a.J(41735236,822,15,"OnGetAppliedPolicyIdFailed()");this.qwe("","ErrorGetAppliedPolicyIdFailed");return!0}qwe(z,U){U&&Jc.a.J(41735238,822,15,"OnAppliedPolicyIdReceived: error: "+U);this.Q_c?this.Q_c(z,U):Jc.a.J(50628552,822,15,"m_getAppliedPolicyIdCallback is null");Jc.a.J(587239824,822,50,"OnAppliedPolicyIdReceived: Triggering OnAppliedPolicyReceivedEvent");z=
new Jo(z);this.va.raiseEvent("AppliedPolicyEventReceivedKey",z)}wnk(z){this.qle?this.qle(z,null):Jc.a.J(51446615,822,15,"m_getIsManuallyAppliedCallback is null")}}Object(h.a)(jp,"AppliedPolicyIdService",null,[485,106]);class hn{constructor(z,U,ka,Ba){this.EAb=z;this.JEa=U;this.yT=ka;this.la=Ba}pRa(z){var U=z.automatic||{},ka=U.sensitivityLabel||{};U=this.U9d()?U.id:ka.id;ka=z.recommended||{};const Ba=ka.sensitivityLabel||{};z=this.U9d()?ka.id:Ba.id;ka=this.U9d()?ka.policyTip:Ba.policyTip;this.la.pptIsManuallyAppliedForAclpIsEnabled?
this.EAb.THf(U,z,ka,!this.yT.Mv.AppliedPolicyId||!this.JEa.m5b):this.EAb.THf(U,z,ka,!this.yT.Mv.AppliedPolicyId)}U9d(){return this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)}}Object(h.a)(hn,"AutoClpAnnotationEventHandler",null,[]);class Uk{constructor(){this.ApplyLabelType=0;this.LabelJson=this.LabelId=this.DocLocation=null;this.SkipContentMarking=!1;this.UserPrincipalName=this.UserName=this.TenantId=null}}Object(h.a)(Uk,"PolicyInfo",null,[]);var In=d(976);class Wn{constructor(){this.rEb=
this.startTime=null}}Object(h.a)(Wn,"PollingData",null,[]);class Jn{constructor(z,U,ka,Ba,Ia,Ab,Ob,Yb,uc,mc,Ec,Yc){this.eRg=this.Bzb=!1;this.KZc=null;this.oLg=!1;this.ia=z;this.EAb=U;this.yT=ka;this.F9=Ba;this.EGg=new Da.a;this.z3j=Ia;this.JEa=Ab;this.yb=Ob;this.dRg=Yb;this.xq=uc;this.LI=mc;this.uv=Ec;this.jc=Yc;this.SOg=L.AFrameworkApplication.fa.Cc("ClpLabelPollingIntervalMs",3E4);this.Wpe=L.AFrameworkApplication.fa.Cc("ClpLabelPollingTimeoutMs",3E5);this.Jla=L.AFrameworkApplication.fa.Ga("UserName");
this.Dbk=L.AFrameworkApplication.fa.Ga("UserPrincipalName");this.g2j=this.k4i()}k4i(){let z;if(L.AFrameworkApplication.fa.ka("DynamicVariableCLPFixEnabled")){if(z=L.AFrameworkApplication.fa.Ga("EditDocInClientUrl"))return Jc.a.J(512263634,822,50,"PptPolicyManager::GetDocLocation EditDocInClientUrl is not null"),z;Jc.a.J(512263633,822,10,"PptPolicyManager::GetDocLocation EditDocInClientUrl is null")}(z=L.AFrameworkApplication.fa.Ga("WOPISrc"))||Jc.a.J(512263632,822,10,"PptPolicyManager::GetDocLocation WOPISrc is null");
Jc.a.J(512263631,822,50,"PptPolicyManager::GetDocLocation WOPISrc is not null");return z}dispose(){this.EAb=null;if(this.Bzb){this.yT.Ofh(Object(v.a)(this,this.Z1g,"onSetLabelSucceeded"));for(let z of this.EGg)this.yT.Ofh(z)}}init(){this.EAb.ub();this.EAb.xe();if(L.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&L.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")){const z=Object(A.a)(In.a,Cf.App.Ih);z&&this.yT.zMk(Object(v.a)(z,z.nbi,"areAllCoauthorsInSessionClientMipTrusted"));this.yT.Cyj(this.z3j);
0<this.SOg&&0<this.Wpe&&this.JEa.S5h(Object(v.a)(this,this.Ilk,"onDocumentContentPolicyChanged"));L.AFrameworkApplication.Zsa&&this.dRg.eNk(()=>this.xq.UGh);this.xq.r3&&(Jc.a.J(512263630,822,50,"PPTPolicyManager::Init - Setting LockId to {0}",this.xq.r3),this.yT.bLe(this.xq.r3));this.LI.G5h(()=>{Jc.a.J(512263629,822,50,"PPTPolicyManager::LockIdChanged - Setting LockId to {0}",this.xq.r3);this.yT.bLe(this.xq.r3)})}this.yT.v8h(Object(v.a)(this,this.kbi,"applyUdpLabeling"));this.yT.KNk(Object(v.a)(this,
this.cGj,"isClpBlockedByAppSpecificScenario"));this.yT.L5h(Object(v.a)(this,this.Jai,"applyMandatoryLabeling"));this.yT.UId(Object(v.a)(this,this.Z1g,"onSetLabelSucceeded"));this.Bzb=!0}kbi(z,U){U.Val&&L.AFrameworkApplication.Ta.processAction(Qc.a.openInClient,2)}cGj(){const z=!this.jc.getState(2)&&!this.jc.oxg;this.eRg!==z&&(this.jc.PDg(),Jc.a.J(512263628,822,50,"PPTPolicyManager::IsClpBlockedByAppSpecificScenario - {0}",z),this.eRg=z);return z}get xha(){return this.yT.Mv.AppliedPolicyId}XNk(z){this.yT.UId(z);
this.EGg.add(z)}jxk(z,U,ka){const Ba=new Uk;Ba.TenantId=this.F9;Ba.LabelId=z;Ba.ApplyLabelType=U;Ba.LabelJson=Jn.YUi(Q.c(ka));Ba.SkipContentMarking=!1;Ba.UserName=this.Jla;Ba.UserPrincipalName=this.Dbk;Ba.DocLocation=this.g2j;Jc.a.J(512263627,822,50,"PersistLabelToWorker: Updating worker with received policy");this.ia.La(Qc.a.B7g,2,Ba)}Jai(z,U){if(U&&0!==U.LJd){(z=1===U.LJd)?this.uv.zwh():(this.uv.wwh(),""!==U.RTg&&this.dRg.Kai(U.RTg));U=z?1:3;var ka=L.AFrameworkApplication.Ta.mode;U!==ka?Jc.a.J(512263625,
822,10,"ApplyMandatoryLabeling ModeSwitch Failed. Expected: {0}, Current: {1}",U,ka):this.oLg=z}else Jc.a.J(512263626,822,50,"ApplyMandatoryLabelling is called with invalid inputs.")}Z1g(z,U){this.jxk(U.$6g,U.V6,this.yT.Mv);Jc.a.J(512263624,822,50,"OnSetLabelSucceeded: Set policy label to ppt file after set label succeeded on host.")}JWd(z){z&&this.xha?z=this.xha.toLowerCase()===z.toLowerCase():(Jc.a.J(512263623,822,50,"FLabelIdMatchesPolicyManager: null labelId or null AppliedPolicyId, can't compare case insensitively. fNullLabelId:{0} fNullAppliedPolicyId:{1}",
!z,!this.xha),z=z===this.xha);Jc.a.J(512263622,822,50,"FLabelIdMatchesPolicyManager: fLabelIdMatchesPolicyManager:{0}",z);return z}eyk(z){const U=Object(A.a)(Wn,z.customData);if(U){var ka=+new Date-+U.startTime;Jc.a.J(512263620,822,50,"PollingTaskCallback: Callback received, durationMs:{0}",ka);this.JWd(U.rEb)||ka>this.Wpe||U.rEb!==this.KZc?(Jc.a.J(512263619,822,50,"PollingTaskCallback: Stopping loop due to FAreInSync:{0} fDidTimeout:{1} fStaleLabelId:{2}",this.JWd(U.rEb),ka>this.Wpe,U.rEb!==this.KZc),
this.yb.Ng(z)):(Jc.a.J(512263618,822,50,"PollingTaskCallback: Triggering GetPolicy call"),this.yT.FQa(U.rEb,void 0,Jn.ONa,!0))}else Jc.a.J(512263621,822,15,"PollingTaskCallback: Failed to get pollingData from taskItem, removing task"),this.yb.Ng(z)}jkl(z){Jc.a.J(512263617,822,50,"SubmitPollingTask: Submitting new polling task");const U=new ad.a(2,2,this.SOg,Object(v.a)(this,this.eyk,"pollingTaskCallback"),90,"113");U.customData=Object.assign(new Wn,{startTime:new Date,rEb:z});this.yb.Cb(U)}Ilk(z,
U){Jc.a.J(512263616,822,50,"OnDocumentContentPolicyChanged: Notification received");U.xha||Jc.a.J(512263587,822,50,"OnDocumentContentPolicyChanged: Empty labelId - could indicate bug or all labels removed");this.KZc=U.xha;this.JWd(this.KZc)?Jc.a.J(512263586,822,50,"OnDocumentContentPolicyChanged: PODS is in agreement with SPO, no need to poll"):this.jkl(U.xha)}static ONa(){const z=Cf.App.Ih.amIAlone,U=Cf.App.Ih.ONa;let ka=!1;const Ba=Object(A.a)(In.a,Cf.App.Ih);Ba&&(ka=Ba.obi());Jc.a.J(512263585,
822,50,"AmITheOnlyCoauthor: Used block self coauth flow, fAmIAlone:{0} fAmITheOnlyCoauthor:{1} fAreAllCoauthorsWebClients:{2}",z,U,ka);return z||U&&ka}static YUi(z){z=z.replace(RegExp(":null","gi"),':""');return z=z.replace(RegExp('"LabelActions":',"gi"),'"Actions":')}}Object(h.a)(Jn,"PptPolicyManager",null,[106]);class Ko{constructor(z,U,ka,Ba){this.o0j=z;this.uc=U;this.Fb=ka;this.la=Ba}ub(){this.o0j.pa(Qc.a.B7g,Fh.a.application,Object(v.a)(this,this.Xlj,"handleApplySensitivity"),4)}xe(){}Xlj(z,
U,ka,Ba,Ia){if(!(L.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&L.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&this.la.pptApplyManualPolicyLabelIsEnabled&&L.AFrameworkApplication.fa.ka("SupportsPolicies")))return 16;if(U.contextId!==Fh.a.application)return 2;if(!Ia||!Object(sg.a)(Uk,Ia))return 8;z=Object(A.a)(Uk,Ia);if(I.a.Va(z.TenantId))return Jc.a.J(41793040,808,10,"The tenant id of policy info is empty or null"),
8;if(I.a.Va(z.LabelJson))return Jc.a.J(41793042,808,10,"The label json of policy info is empty or null"),8;if(1===ka)return 32;ka=this.uc.Gn;U=this.Fb.ud(7);try{U.kc(ka),ka.sEb=z}finally{U&&U.dispose()}return 32}}Object(h.a)(Ko,"SetPolicyActor",null,[229]);class Rl{constructor(){this.U7b=this.j3c=this.fc=this.JEa=this.K=null;this.zPg=!0}get name(){return"PowerPointWebEditor.Policy"}Wb(z){this.K=z;this.K.register(485,"PowerPointWebEditor.Policy.IAppliedPolicyIdService").ma().na(()=>new jp(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventHandler"),this.K.resolve("Common.IAppSettingsManager")))}init(){this.fc=this.K.resolve("Common.IAppSettingsManager");this.fc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SensitivityTTVRImprovementEnabled",!1)?this.fc.xvb(Object(v.a)(this,this.Gm,"onFullAppSettingsReady")):this.K.resolve("Common.IAppSettingsManager").ff(Object(v.a)(this,this.Gm,"onFullAppSettingsReady"))}dispose(){}Gm(){if(this.fc.ka("WacLabelingPoliciesIsEnabled")&&
this.fc.ka("SupportsPolicies")&&this.fc.ka("890"))this.JEa=this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),fl.a.get_instance().gk(10,Object(v.a)(this,this.vjk,"onAfterRibbonDisplayed")),sj.a.Ju(this.K.Ka("Common.App.Policy.Contracts.IPolicyManager")).continueWith(z=>{const U=new Ko(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"));
z=z.result;this.j3c=new Jn(this.K.resolve("Common.IActionManagerExtended"),U,z,this.fc.Ga("TenantId"),this.K.Ka("Common.Interface.IRtcBasicProvider"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),
this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"));this.j3c.init()});else if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").dgb){const z=this.K.resolve("PowerPointWebEditor.IPPTRumTracker");z.Y9(z.e5,z.Vlh)}}vjk(){sj.a.Ju(this.K.Ka("Common.App.Policy.Contracts.IPolicyManager")).continueWith(z=>{const U=z.result;L.AFrameworkApplication.fa.ka("AutoClpIsEnabled")&&(Jc.a.J(512274584,822,50,"OnAfterRibbonDisplayed: Registering with GetAutoPolicyLabelHandler API"),this.U7b=new hb.a(()=>
new hn(this.K.resolve("Common.App.Policy.Contracts.IPolicyActor"),this.K.resolve("PowerPointWebEditor.Policy.IAppliedPolicyIdService"),U,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.fc.Ga("TenantId"))),U.r5h(Object(v.a)(this,this.BMk,"registerAutoClpAnnotationEventHandler")),L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(U.b5h(Object(v.a)(this,this.qGc,"createAutoCLPSecurityNodes")),U.y8h(Object(v.a)(this,this.pvl,"updateAutoCLPLabelPriorityNode")),
U.z8h(Object(v.a)(this,this.qvl,"updateAutoCLPSITNodes"))));(z=this.fc.Ga("AppliedPolicyId"))||L.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled")&&L.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring")?L.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?U.FQa(z,void 0,Jn.ONa):U.FQa(z):(z=this.fc.Ga("TenantId"),I.a.Va(z)?Jc.a.J(512274583,822,15,"OnAfterRibbonDisplayed: tenantId is null or empty"):(Jc.a.J(512274582,822,50,"OnAfterRibbonDisplayed: Call AppliedPolicyIdService.GetAppliedPolicyIdAsync"),
this.JEa.Q8f(z,(ka,Ba)=>{Ba&&Jc.a.J(512274581,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync failed: "+Ba);I.a.Va(ka)&&(ka="",Jc.a.J(512274580,822,50,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetAppliedPolicyIdAsync: appliedPolicyIdInFile is empty"));L.AFrameworkApplication.fa.ka("PPTOCoauthorPopUpFixManualCLPEnabled")?U.FQa(ka,void 0,Jn.ONa):U.FQa(ka)}),this.JEa.G7i(z,(ka,Ba)=>{Ba?Jc.a.J(512274579,822,15,"OnAfterRibbonDisplayed: AppliedPolicyIdService.GetIsManuallyAppliedAsync failed: "+
Ba):this.JEa.m5b=ka}),this.j3c.XNk(Object(v.a)(this,this.Zwl,"updateIsManuallyApplied"))))})}BMk(){const z=this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState");this.zPg&&(z.un||this.j3c.oLg&&z.K5b)&&(this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(U=>{Jc.a.J(512274578,822,50,"RegisterAutoClpAnnotationEventHandler: Registering with AugLoopRuntimeManager");L.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",
!1)?(U.Pnb("AugLoop_SecurityClp_LabellingAnnotation"),U.cjc("AugLoop_SecurityClp_LabellingAnnotation",Object(v.a)(this.U7b.value,this.U7b.value.pRa,"handleAnnotationEvent"))):(U.Pnb("AugLoop_Automatic_Clp_LabellingAnnotation"),U.cjc("AugLoop_Automatic_Clp_LabellingAnnotation",Object(v.a)(this.U7b.value,this.U7b.value.pRa,"handleAnnotationEvent")))}),this.zPg=!1)}qGc(z,U){z=[Object.assign(new om.a,{id:"clp",body:Object.assign(new Si,{existingLabelPriority:U.existingLabelPriority,partialDocSITs:U.KQf,
fullDocSITs:U.JQf})})];const ka=Object.assign(new Qg.a,{parentPath:["session","doc","security"],items:z});this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ba=>{Jc.a.J(512274577,822,50,"CreateAutoCLPSecurityNodes: Submit AddOperations to AugLoopRuntimeManager");Ba.submitOperation(ka)})}pvl(z,U){z=[Object.assign(new om.a,{id:"clp",body:Object.assign(new Si,{existingLabelPriority:U.existingLabelPriority})})];const ka=Object.assign(new gn.a,{parentPath:["session","doc",
"security"],items:z});this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ba=>{Jc.a.J(512274576,822,50,"UpdateAutoCLPLabelPriorityNode: Submit UpdateOperation to AugLoopRuntimeManager");Ba.submitOperation(ka)})}qvl(z,U){z=[Object.assign(new om.a,{id:"clp",body:Object.assign(new Si,{partialDocSITs:U.KQf,fullDocSITs:U.JQf})})];const ka=Object.assign(new gn.a,{parentPath:["session","doc","security"],items:z});this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(Ba=>
{Jc.a.J(512274575,822,50,"updateAutoCLPSITNodes: Submit UpdateOperation to AugLoopRuntimeManager");Ba.submitOperation(ka)})}Zwl(z,U){U&&(this.JEa.m5b=U.$6g&&0!==U.V6?2===U.V6||8===U.V6||16===U.V6?!0:!1:!1)}static main(){ua.a.instance.Bc(new Rl)}}Object(h.a)(Rl,"PPTWebEditorPolicyPackage",null,[2,3]);Type.registerNamespace("B4Intent");Type.registerNamespace("Box4.Dictation");Type.registerNamespace("Box4.Dictation.Authentication");Type.registerNamespace("Box4.DictationCorrections");Type.registerNamespace("Common.App.CatchUpActivity");
Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointSafeLinks");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Activity");Type.registerNamespace("PowerPointWebEditor.Animations");Type.registerNamespace("PowerPointWebEditor.Dictation");Type.registerNamespace("PowerPointWebEditor.FirstRunExperience");Type.registerNamespace("PowerPointWebEditor.Policy");
Type.registerNamespace("PowerPointWebEditor.RevisionTracking");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Ma.main();Type.registerNamespace("Common.App.CatchUpActivity");Uc.main();Type.registerNamespace("Common.Comments");Type.registerNamespace("Common.App.Rename");ua.a.instance.Bc(new zd,7);Type.registerNamespace("Common.App.Rename.RenameExecutor");ua.a.instance.Bc(new ib);Type.registerNamespace("Common.App.SafeLinks");Ff.main();rf.main();vm.main();
sc.main();Jf.main();Hd.main();wm.main();Type.registerNamespace("Common.App.OAuth");sh.main();ua.a.instance.Bc(new Qk);jk.main();ua.a.instance.Bc(new Dn);En.main();Type.registerNamespace("Common.App.AugmentationLoop");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");Mj.main();Rl.main()},207:function(J,V,d){J=d(0);var h=d(55);class e{constructor(v,A,w,y,u){this.CFa=!1;this.kzb=v;this.syb=A;this.Z7b=w;this.$4j=u;this.sAb=y.NCa(w,A.name)}get BLf(){return this.Z7b}Wb(v){this.sAb.YJf();
this.syb.Wb(v);this.sAb.X0f()}init(){this.sAb.ju(this.syb.name+"_d");this.$4j?this.kzb.Ayj(this,this.Z7b):this.kzb.zyj(this,this.Z7b)}yyj(){this.sAb.qu(this.syb.name+"_d");this.sAb.$Jf();this.syb.init();this.CFa=!0;this.sAb.$0f()}dispose(){this.CFa&&this.syb.dispose()}get name(){return this.syb.name}}Object(J.a)(e,"DelayLoadedPackage",null,[565,2,3]);class m{constructor(v,A){this.kzb=null;v.execute(w=>{this.kzb=w});this.c1j=A}create(v,A,w){return this.kzb?new e(this.kzb,v,A,this.c1j.value,w):v}static get instance(){return m.Ja||
(m.Ja=new m(h.a.instance.Ka("PowerPointWebEditor.DelayLoadedPackageInitializer"),h.a.instance.le("PowerPointWebEditor.Core.IBundleMetricRecorder")))}}m.Ja=null;Object(J.a)(m,"DelayLoadedPackageFactory",null,[]);d.d(V,"a",function(){return r});const r=(v,A)=>m.instance.create(v,A,!1)},229:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(77);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===
this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}yx(){return!0}static Sqb(e,
m){return e+(m?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",d.a,[106,570])},230:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.type=e;this.Vi=m}}h.Zo="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,[])},231:function(J,V,d){d.d(V,"a",function(){return r});J=d(0);var h=d(25),e=d(1097),m=d(45);class r{static $ag(){return r.K8h+"_"+e.a.p3b+"_"+m.a.NM(h.AFrameworkApplication.userName)+"_"}static y8f(v){return v+
"_"+e.a.p3b+"_"+m.a.NM(h.AFrameworkApplication.userName)+"_"}static yeg(){return r.KCk+"_"+e.a.p3b+"_"+m.a.NM(h.AFrameworkApplication.userName)+"_"}}r.S6="ack0";r.bqa="ack1";r.MBc="ack2";r.K8h="ack3";r.fUb="ack4";r.MFf="ack7";r.Mde="ack8";r.Wrh="ack9";r.tLd="ack10";r.HNe="ack13";r.I8h="DdaMethod";r.H8h="ControlId";r.dJd="SecurityOrigin";r.oob="ak0";r.bJd="ak1";r.OFf="ak2";r.gUb="ak4";r.LFf="Office.AutoShowTaskpaneWithDocument";r.aJd="refreshRequired";r.NFf="value";r.N8h="errorCode";r.OUd="SolutionId";
r.MUd="MethodData";r.NUd="DynamicAddinCommandsMethodDispatchId";r.uLi="SourceControlId";r.sLi="OsfControl";r.tLi="RibbonUpdaterData";r.Old="AddinShared";r.KCk="__OSF_PRIVATECATALOG_ADDINIDS";Object(J.a)(r,"AddinConstantsString",null,[])},277:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(989);class e{constructor(m){this.Wk=new h.a;this.ZVa=m}AG(m){const r=m.id;let v=null;this.Wk.Jb(r)?v=this.Wk.ga(r):(this.ZVa&&(v=this.ZVa(m,()=>{this.pjc(r)})),v&&this.Wk.$(r,v));return v}kF(m){m=
m.id;return this.Wk.Jb(m)?this.Wk.ga(m):null}pjc(m){this.Wk.remove(m)}}Object(J.a)(e,"ShapeComponentViewManager",null,[488])},371:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"OAuthResult",null,[])},435:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(65),e=d(13),m=d(322),r=d(113);class v{constructor(A,w,y,u,D,F,I,H,L,E,aa,Q){this.AVb=1;this.qT=w;this.Zh=A;this.Vge=y;this.De=L;this.gp=E;this.Wc=aa;this.BGa=H;this.bGa=D;this.cGa=u;this.YN=F;this.De.addCssClass(this.Zh,
"prControl");this.Zh.style.width=this.De.Nc(w);this.zr=I.tVf();this.pFa=I.sVf();this.zr.Iha(A);this.pFa.Iha(A,w,w);this.qVa=Q;this.Hma()}dispose(){this.Loc();this.clear();this.zr.dispose();this.pFa.dispose();this.De.removeCssClass(this.Zh,"prControl")}get zea(){return r.a.none}clear(){this.Bqa();this.iqb();this.kGb()}setZIndex(A){this.Zh.style.zIndex=String(A)}rdc(){this.qVa.xa.style.zIndex=String(this.AVb+m.a.baa)}kGb(){this.qVa.xa.style.zIndex="0"}Bhd(A,w,y=null){A=this.BGa.aRd(this.qT,this.qT,
this.Vge,A,"",y);this.zr.nna(A,w)}s3a(A,w){this.pFa.add(A,w)}iqb(){this.pFa.clear()}Bqa(){this.zr.clear()}onClick(){return!0}Hma(){this.cGa&&this.gp.ob(h.a.pointerOver,this.Zh,this.cGa);this.bGa&&this.gp.ob(h.a.pointerOut,this.Zh,this.bGa);this.YN?this.Wc.ob(h.a.click,this.Zh,this.YN):this.Wc.ob(h.a.click,this.Zh,Object(e.a)(this,this.onClick,"onClick"));this.Wc.ob(h.a.doubleClick,this.Zh,Object(e.a)(this,this.onClick,"onClick"))}Loc(){this.cGa&&this.gp.xb(h.a.pointerOver,this.Zh,this.cGa);this.bGa&&
this.gp.xb(h.a.pointerOut,this.Zh,this.bGa);this.YN?this.Wc.xb(h.a.click,this.Zh,this.YN):this.Wc.xb(h.a.click,this.Zh,Object(e.a)(this,this.onClick,"onClick"));this.Wc.xb(h.a.doubleClick,this.Zh,Object(e.a)(this,this.onClick,"onClick"))}}Object(J.a)(v,"ShapePawn",null,[551])},536:function(J,V,d){d.r(V);J=d(0);var h=d(376),e=d(1187),m=d(674),r;(function(ta){ta[ta.external=0]="external";ta[ta.msa=1]="msa";ta[ta.aad=2]="aad"})(r||(r={}));Object(J.b)("AuthorityType",r);var v=d(371);class A{constructor(ta){this.MSh=
ta}initialize(){return Promise.resolve(0)}pXc(){return Promise.resolve(0)}KU(){h.ULS.sendTraceTag(574239257,3E3,50,"Automation flag set.  Returning Mock Token.");return Promise.resolve(Object.assign(new v.a,{IsSuccess:!0,Token:this.MSh}))}Tmd(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Ikd(){return!1}L1b(){return"MockAuthTokenStrategy"}}
Object(J.a)(A,"MockAuthTokenStrategy",null,[569]);var w=d(708);class y{static get(ta,Ga,oa){if(!oa)return ta;let sa=0;return Promise.race([ta,new Promise(Ha=>{sa=window.setTimeout(()=>{Ha(Ga)},oa)})]).then(Ha=>{window.clearTimeout(sa);return Promise.resolve(Ha)}).catch(()=>{window.clearTimeout(sa);return Promise.resolve(Ga)})}}Object(J.a)(y,"PromiseWithTimeout",null,[]);var u=d(25),D=d(234);class F{constructor(ta,Ga,oa,sa,Ha){this.scope=this.resource=null;this.silentLogin=!1;this.correlationId=this.options=
null;this.resource=ta;this.scope=Ga;this.silentLogin=oa;this.options=sa;this.correlationId=Ha}}Object(J.a)(F,"TokenRequestParameters",null,[589]);var I=d(54),H=d(55);class L{constructor(){this.HBf=null;let ta=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.FJ),Ga=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.GBh);this.nnb=String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",ta&&""!==ta?ta:"Unspecified",Ga&&""!==Ga?Ga:"Unspecified")}initialize(){return new Promise(ta=>
{H.a.instance.Ka("Common.App.WopiIdentity.IWopiIdentity").execute(Ga=>{this.HBf=Ga;ta(0)})})}Dc(ta){const Ga=["HTTPS:","API:"];let oa=!1;const sa=ta.toLocaleUpperCase();for(const Ha of Ga)if(sa.startsWith(Ha)){oa=!0;break}return oa||this.kJj(ta)?ta+"/.default":ta}kJj(ta){return RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i").test(ta)}pXc(){return Promise.resolve(0)}KU(ta,Ga,oa,sa,Ha,bb,Ya){if(I.a.rEa){Ha=D.OAuthManagerSettings.hCl;if(!Ha)return Ga=Object.assign(new v.a,
{IsSuccess:!1,ErrorCode:"TeamsNoAllowListFound",ErrorMessage:"No app list was found."}),Promise.resolve(Ga);if(!Array.contains(Ha,ta))return Ga=Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"TeamsDisallowedApp",ErrorMessage:"Disallowed appName: "+ta}),Promise.resolve(Ga)}ta=this.Dc(oa);oa=new F(oa,ta,!sa,null,u.AFrameworkApplication.userSessionId);return this.HBf.getAccessToken(oa,Ga,Ya).then(ua=>Object.assign(new v.a,{IsSuccess:!0,Token:ua.accessToken}),ua=>Object.assign(new v.a,{IsSuccess:!1,ErrorCode:ua}))}Tmd(){return Promise.resolve(Object.assign(new v.a,
{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Ikd(){return!1}L1b(){return this.nnb}}Object(J.a)(L,"ParentFrameTokenStrategy",null,[569]);var E=d(13),aa=d(448),Q=d(17);class O{constructor(){this.reject=this.resolve=null;this.startTime=0;this.R9g=this.TJf=null}}Object(J.a)(O,"PromiseWrapper",null,[]);class T{constructor(ta=0){this.wM=0;this.TQb=!1;this.eu=new Q.a;this._timeout=ta}enqueue(ta){return new Promise((Ga,
oa)=>{this.eu.add(Object.assign(new O,{R9g:ta,resolve:Ga,reject:oa}));this.process()})}process(){if(this.TQb||this.wM===this.eu.count)return!1;const ta=this.eu.ga(this.wM++);try{this.TQb=!0,ta.R9g().then(Ga=>{this.TQb=!1;this.APd(ta,Ga,null,!0)}).catch(Ga=>{this.TQb=!1;this.APd(ta,null,Ga,!1)})}catch(Ga){this.TQb=!1,this.APd(ta,null,Ga,!1)}return!0}APd(ta,Ga,oa,sa){if(sa){const Ha=()=>{ta.resolve(Ga);this.process()};0<this._timeout?window.setTimeout(()=>{Ha()},this._timeout):Ha()}else{const Ha=()=>
{ta.reject(oa);this.process()};0<this._timeout?window.setTimeout(()=>{Ha()},this._timeout):Ha()}}}Object(J.a)(T,"PromiseQueue",null,[]);class K{constructor(){this.correlationId=this.resolve=null}}Object(J.a)(K,"ResolveWithCorrelation",null,[]);var X=d(1166),P=d(82),ea=d(521),ia=d(125);class ja extends P.a{constructor(ta,Ga,oa,sa,Ha,bb){super(!1,!1,!0);this.$1e=this.bga=null;this.Naa=ta;this.OUh=oa;this.EE=sa;this.yZh=Ha;this.$0a=bb;this.tA=document.createElement("iframe");this.tA.id="SharedAuthInteractiveFrame";
this.tA.setAttribute("name","SharedAuthInteractiveFrame");this.tA.setAttribute("title","SharedAuthInteractiveFrame");this.tA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");this.tA.style.border="0";this.tA.style.height="48px";this.tA.style.width="190px";$addHandler(this.tA,"error",Object(E.a)(this,this.Kqk,"onSharedAuthFrameError"));ta=String.format("{0}{1}{2}{3}{4}{5}{6}{7}{8}",this.Naa,Ga,"?replyUrl=",window.location.protocol,"//",window.location.host,"&interactive=1",
"&WacUserType=",u.AFrameworkApplication.userType);this.tA.src=ta;this.wMh=new Promise(Ya=>{this.$1e=Ya});this.a2e=!1}n5(){this.bga={["id"]:"SharedAuthConsentDialog",["bodyControls"]:{["promptMessage"]:this.OUh,["errorText"]:CommonUIStrings.l_InternalError,["rtl"]:u.AFrameworkApplication.isRtl,["frameLoaded"]:!1,["createFrame"]:Object(E.a)(this,this.Czi,"createFrame"),["resolveDialogStyles"]:this.$1e}};this.yd=5;this.tj(CommonUIStrings.l_SignIn,Object(E.a)(this,this.f$k,"sharedAuthConsentDialogHandler"),
this.bga)}eEh(ta=!1,Ga=5){this.bga&&this.bga.bodyControls&&(!0!==Object(X.a)(Object,this.bga.bodyControls).frameLoaded&&(Object(X.a)(Object,this.bga.bodyControls).frameLoaded=!0),ta!==Object(X.a)(Object,this.bga.bodyControls).frameLoadSuccess&&(Object(X.a)(Object,this.bga.bodyControls).frameLoadSuccess=ta),Ga!==this.bga.dialogButtonsOption&&(this.bga.dialogButtonsOption=null,this.yd=Ga),this.update(this.bga))}jfl(ta,Ga){const oa=new ea.a(ia.a.j$k);oa.Values={["signInLabel"]:CommonUIStrings.l_SignIn,
["cancelLabel"]:CommonUIStrings.l_DialogCancel,["rtl"]:u.AFrameworkApplication.isRtl,["messageCorrelationId"]:ta,["dialogStyles"]:Ga};this.EE.tgb(oa,this.tA.contentWindow,this.Naa)}e7f(){this.eEh(!1,6)}get Nph(){return this.tA}get fIi(){return this.wMh.then(ta=>{this.a2e=!0;return ta})}get gIi(){return this.a2e}Kqk(){this.e7f()}Czi(){return this.tA}f$k(ta){0===ta&&(this.yZh.reject(Object.assign(new v.a,{ErrorCode:"UserCancelled",ErrorMessage:"The interactive flow was cancelled by the user"})),this.$0a(null))}}
Object(J.a)(ja,"SharedAuthConsentDialog",P.a,[590]);var C=d(655),pa=d(94),Z=d(214),qa=d(63),ya=d(106),Ka=d(87);class Da{constructor(){this.tA=null;this.Utc=0;this.Ylb=this.Gnb=this.Hqd=this.$0a=this.VY=this.dAf=null;this.EE=new C.a(null,null);this.nnb="SharedAuthTokenStrategy Unloaded";this.Naa=D.OAuthManagerSettings.h$k;this.Cwf=D.OAuthManagerSettings.g$k;this.q3e=D.OAuthManagerSettings.enableConsoleLogging;this.gNh=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",
!1);this.OXh=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthSkipUpnCheckEnabled",!1);this.NMa={};this.FPh=new T(1500)}L1b(){return this.nnb}initialize(){var {OAuthManager:ta}=d(536);if("loadFrame"in this.NMa)return this.NMa.loadFrame.TJf;if(!this.Naa)return pa.Health.instance.recordKpiFailure(ta.kpiName,"SharedAuthFrameOriginNotSet",!1,!1,null),h.ULS.sendTraceTag(562381581,3E3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(1);
ta=this.rkd("loadFrame");this.Utc=qa.a.sj();var Ga=this.Naa+this.Cwf+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+u.AFrameworkApplication.userSessionId+"&WacUserType="+u.AFrameworkApplication.userType;this.tA=document.createElement("iframe");this.ZRc(this.tA);this.tA.style.cssText="height:0;width:0;display:none;";this.tA.id="SharedAuthFrame";this.tA.setAttribute("name","SharedAuthFrame");this.tA.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups");
this.tA.setAttribute("title","SharedAuthFrame");this.tA.src=Ga;document.body.appendChild(this.tA);Ga=qa.a.sj()-this.Utc;h.ULS.sendTraceTag(573112899,3E3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",Ga,this.tA.src);return ta}pXc(ta){this.Hqd=ta;const Ga=new ea.a(ia.a.Qph);Ga.Values=this.xJf(ta);ta=this.rkd("initFrame");this.EE.tgb(Ga,this.tA.contentWindow,this.Naa);h.ULS.sendTraceTag(573112900,3E3,50,"SharedAuthTokenStrategy Init: Called package initialize.");
return ta}KU(ta,Ga,oa,sa,Ha,bb){const Ya=new ea.a(ia.a.k$k),ua=this.Teg();Ya.Values=this.vAh(ta,Ga,oa,sa,Ha,bb,ua);ta=this.rkd(ua);sa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedAuthInteractiveConsentUI",!1)?this.FPh.enqueue(()=>new Promise(Ma=>{this.fsl(bb,Ya,Ma,ua)})):(this.EE.tgb(Ya,this.tA.contentWindow,this.Naa),h.ULS.sendTraceTag(573112901,3E3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",Ga));return ta}fsl(ta,Ga,oa,sa){const Ha=
this.NMa[sa];Ha&&(this.Gnb=Ga,this.$0a=Object.assign(new K,{resolve:oa,correlationId:sa}),this.VY=new ja(this.Naa,this.Cwf,ta,this.EE,Ha,oa),this.VY.n5())}Teg(){return ya.a.create().toString()}vAh(ta,Ga,oa,sa,Ha,bb,Ya){const ua={};ua.appName=ta;ua.appId=Ga;ua.target=oa;ua.withPopup=sa;ua.claims=Ha;ua.promptMessage=bb;ua.messageCorrelationId=Ya;return ua}ZRc(ta){$addHandler(ta,"load",Object(E.a)(this,this.bnk,"onIFrameLoaded"));$addHandler(ta,"error",Object(E.a)(this,this.Ixe,"onIFrameError"));this.EE.LAc(this.Naa);
this.EE.fu(ia.a.Tph);this.EE.kB(ia.a.Tph,Object(E.a)(this,this.fqk,"onScriptLoaded"));this.EE.fu(ia.a.Sph);this.EE.kB(ia.a.Sph,Object(E.a)(this,this.eqk,"onScriptInitialized"));this.EE.fu(ia.a.Oph);this.EE.kB(ia.a.Oph,Object(E.a)(this,this.Jmk,"onGetTokenResponse"));this.EE.fu(ia.a.Uph);this.EE.kB(ia.a.Uph,Object(E.a)(this,this.Rnk,"onLoginResponse"));this.EE.fu(ia.a.Rph);this.EE.kB(ia.a.Rph,Object(E.a)(this,this.qnk,"onInteractiveFlowReady"));this.EE.fu(ia.a.Pph);this.EE.kB(ia.a.Pph,Object(E.a)(this,
this.Ymk,"onHideDialog"));this.EE.fu(ia.a.Mph);this.EE.kB(ia.a.Mph,Object(E.a)(this,this.Ekk,"onCloseDialog"))}rkd(ta){const Ga=new O;Ga.startTime=qa.a.sj();const oa=new Promise((sa,Ha)=>{Ga.resolve=sa;Ga.reject=Ha});Ga.TJf=oa;this.NMa[ta]=Ga;return oa}bnk(){const ta=qa.a.sj()-this.Utc;h.ULS.sendTraceTag(572346566,3E3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",ta)}Ixe(ta){const {OAuthManager:Ga}=d(536),oa=qa.a.sj()-this.Utc,sa=Object.assign(new Ka.a,{durationMs:oa});pa.Health.instance.recordKpiFailure(Ga.kpiName,
"SharedAuthWACOAuthAspxFrameError",!1,!0,sa);h.ULS.sendTraceTag(572346567,3E3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",oa,this.q3e?JSON.stringify(ta):"")}fqk(ta){const {OAuthManager:Ga}=d(536),oa=this.NMa.loadFrame;var sa=qa.a.sj()-oa.startTime,Ha=ta.Values.AuthLibrary.toString();ta=ta.Values.Success.toString();h.ULS.sendTraceTag(573112902,3E3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",ta,Ha,sa);Ha&&(this.nnb="SharedAuthTokenStrategy "+Ha);
Ha=Boolean.parse(ta);Ha||(ta=Z.a.Fz(),void 0!==ta&&null!==ta&&(ta.set("AuthLibrary",this.L1b()),sa=Object.assign(new Ka.a,{durationMs:sa,extendedProperties:ta}),pa.Health.instance.recordKpiFailure(Ga.kpiName,"SharedAuthStrategyInitFailed",!1,!0,sa)));oa.resolve(Ha?0:1)}eqk(ta){if(ta.Values.interactive&&this.Gnb&&this.Gnb.Values.messageCorrelationId){const oa=this.Gnb.Values.messageCorrelationId.toString();if(ta.Values.interactive&&this.VY){this.VY.fIi.then(sa=>{this.EE.tgb(this.Gnb,this.VY.Nph.contentWindow,
this.Naa);this.VY.jfl(oa,sa);this.VY.eEh(!0);this.Gnb=null});return}}ta=this.NMa.initFrame;const Ga=qa.a.sj()-ta.startTime;h.ULS.sendTraceTag(573112903,3E3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",Ga);ta.resolve(0)}Jmk(ta){if(ta.Values.messageCorrelationId&&ta.Values.messageCorrelationId.toString()){var Ga=ta.Values.messageCorrelationId.toString(),oa=this.NMa[Ga];if(oa){var sa=qa.a.sj()-oa.startTime;h.ULS.sendTraceTag(573112906,3E3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",
sa);ta.Values.isSuccess&&ta.Values.isSuccess?oa.resolve(ta.Values.response):oa.reject(ta.Values.response);this.$Ah(Ga)}else h.ULS.sendTraceTag(573112905,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(573112904,3E3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId")}qnk(){if(this.VY.gIi)this.VY.e7f();else if(this.Hqd&&this.VY){const ta=new ea.a(ia.a.Qph);ta.Values=this.xJf(this.Hqd,
!0);this.EE.tgb(ta,this.VY.Nph.contentWindow,this.Naa)}}Ymk(){this.VY&&this.VY.D6d()}Ekk(ta){ta.Values.cancelled&&ta.Values.cancelled&&ta.Values.messageCorrelationId&&this.$Ah(ta.Values.messageCorrelationId.toString());this.VY&&this.VY.hide()}xJf(ta,Ga=!1){const oa={};oa.appIds=this.m_i();oa.upn=ta.loginHint;oa.authority=ta.authority;oa.authorityType=Object(e.a)(r,ta.authorityType);oa.tenantId=ta.tenantId;oa.correlationId=u.AFrameworkApplication.userSessionId;oa.enableConsoleLogging=this.q3e;oa.enablePopupFlash=
this.gNh;oa.skipUpnCheck=this.OXh;oa.interactive=Ga;return oa}m_i(){const ta=[],Ga=D.OAuthManagerSettings.KJd;for(let oa in Ga)Array.add(ta,Ga[oa]);return ta}Tmd(ta,Ga,oa,sa,Ha,bb){const Ya=new ea.a(ia.a.i$k),ua=this.Teg();Ya.Values=this.vAh(ta,Ga,oa,sa,Ha,bb,ua);this.dAf=Ya;ta=this.rkd(ua);h.ULS.sendTraceTag(555049437,3E3,50,"SharedAuthTokenStrategy TryLogin: Called TryLogin for app {0}",Ga);this.Tcl();return ta}Ikd(){return!0}Tcl(){this.Ylb||(this.Ylb=new aa.a(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Title,
CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Body,null),this.Ylb.id=16,this.Ylb.Xae=!1,this.Ylb.addButton(CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,()=>{h.ULS.sendTraceTag(527827290,3E3,50,"SharedAuthTokenStrategy TryLogin: User Clicked Login");this.EE.tgb(this.dAf,this.tA.contentWindow,this.Naa)},CommonUIStrings.l_WAC_OAuth_CompleteSignIn_Button,!0),u.AFrameworkApplication.Aa.jb.PAc(this.Ylb,!0)||h.ULS.sendTraceTag(555049438,3E3,10,"Failed to add entry to business bar. Login message could not be shown to user."))}Rnk(ta){if(ta.Values.messageCorrelationId&&
ta.Values.messageCorrelationId.toString()){var Ga=this.NMa[ta.Values.messageCorrelationId.toString()];if(Ga){var oa=qa.a.sj()-Ga.startTime;h.ULS.sendTraceTag(555049441,3E3,50,"SharedAuthTokenStrategy OnLoginResponse. E/T: [{0}]",oa);ta.Values.isSuccess&&ta.Values.isSuccess?Ga.resolve(ta.Values.response):Ga.reject(ta.Values.response)}else h.ULS.sendTraceTag(555049440,3E3,10,"SharedAuthTokenStrategy OnLoginResponse called with an unregistered messageCorrelationId")}else h.ULS.sendTraceTag(555049439,
3E3,10,"SharedAuthTokenStrategy OnLoginResponse called without valid messageCorrelationId")}$Ah(ta){this.$0a&&this.$0a.correlationId===ta&&(this.$0a.resolve(null),this.$0a=null)}}Object(J.a)(Da,"SharedAuthTokenStrategy",null,[569]);class la{constructor(ta){this.gCd=ta;this.nnb="UnsupportedAuthTokenStrategy Reason="+m.a[this.gCd]}initialize(){return Promise.resolve(0)}pXc(){return Promise.resolve(0)}KU(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:m.a[this.gCd],ErrorMessage:"Unable to get a token. Reason: ["+
m.a[this.gCd]+"]"}))}Tmd(){return Promise.resolve(Object.assign(new v.a,{IsSuccess:!1,ErrorCode:"authTokenStrategy_loginNotSupported",ErrorMessage:"This Token Strategy does not support login flow, TryLogin could not be completed"}))}Ikd(){return!1}L1b(){return this.nnb}}Object(J.a)(la,"UnsupportedAuthTokenStrategy",null,[569]);var ma=d(231);d.d(V,"OAuthManager",function(){return Ea});class Ea{constructor(ta=null){this.V5=0;this.h1=null;this.f2a=0;const Ga=qa.a.sj();this.xPh=this.FHi(ta).then(oa=>
oa?this.Uxj():(h.ULS.sendTraceTag(527827277,3E3,15,"DetermineAuthLibrary failed leaving {0} in {1} ms, all future TryGetToken requests will fail.",this.wD(),Math.floor(qa.a.sj()-Ga)),oa=Z.a.Fz(),void 0!==oa&&null!==oa&&(oa.set("AuthLibrary",this.wD()),oa=Object.assign(new Ka.a,{durationMs:Math.floor(qa.a.sj()-Ga),extendedProperties:oa}),pa.Health.instance.recordKpiFailure(Ea.kpiName,"StrategyPickFailed",!1,!0,oa)),Promise.resolve(1))).then(oa=>0!==oa?Promise.resolve(oa):this.IVj())}GHi(){var ta=D.OAuthManagerSettings.wfk;
ta&&0<ta.length?(this.V5=1,this.h1=new A(ta)):u.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||u.AFrameworkApplication.fa.ka("IsO365CommercialHost")?u.AFrameworkApplication.fa.ka("IsAnonymousUser")?(this.V5=2,this.h1=new la(this.V5)):(ta=w.a.getAuthContext().loginHint)&&ta.length?D.OAuthManagerSettings.i8a?(this.V5=1,this.h1=new L):(this.V5=1,this.h1=new Da):(this.V5=3,this.h1=new la(this.V5)):(this.V5=4,this.h1=new la(this.V5))}wD(){return this.h1?this.h1.L1b()||"Unknown":"None"}FHi(ta=null){h.ULS.sendTraceTag(562128578,
3E3,50,"Creating OAuthManager.");const Ga=qa.a.sj();return u.AFrameworkApplication.fa.g6i().then(oa=>{oa?(this.GHi(),ta&&(this.h1=ta),h.ULS.sendTraceTag(42084323,3E3,50,"Creation succeeded OAuthManager successfully in {4} ms with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",D.OAuthManagerSettings.clientVersion,D.OAuthManagerSettings.appVersion,D.OAuthManagerSettings.qKi,this.wD(),Math.floor(qa.a.sj()-Ga))):h.ULS.sendTraceTag(562128579,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",
Math.floor(qa.a.sj()-Ga));return Promise.resolve(oa)},()=>{h.ULS.sendTraceTag(562128580,3E3,15,"Creation failed for OAuthManager, unable to get app settings after {0} ms, all future TryGetToken requests will fail.",Math.floor(qa.a.sj()-Ga));return Promise.resolve(!1)})}Uxj(){h.ULS.sendTraceTag(573390991,3E3,50,"Initializing {0}",this.wD());const ta=qa.a.sj();return y.get(this.h1.initialize(),2,D.OAuthManagerSettings.KCe).then(Ga=>{if(0===Ga)h.ULS.sendTraceTag(42084353,3E3,50,"Initialization succeeded for {0} in {1} ms.",
this.wD(),Math.floor(qa.a.sj()-ta));else if(1===Ga){h.ULS.sendTraceTag(527827291,3E3,15,"Initialization failed for {0} in {1} ms, all future TryGetToken requests will fail.",this.wD(),Math.floor(qa.a.sj()-ta));var oa=Z.a.Fz();void 0!==oa&&null!==oa&&(oa.set("AuthLibrary",this.wD()),oa=Object.assign(new Ka.a,{durationMs:Math.floor(qa.a.sj()-ta),extendedProperties:oa}),pa.Health.instance.recordKpiFailure(Ea.kpiName,"StrategyInitFailed",!1,!0,oa))}else 2===Ga&&(h.ULS.sendTraceTag(42267908,3E3,15,"Initialization timed out for {0} after {1} ms, all future TryGetToken requests will fail.",
this.wD(),Math.floor(qa.a.sj()-ta)),oa=Z.a.Fz(),void 0!==oa&&null!==oa&&(oa.set("AuthLibrary",this.wD()),oa=Object.assign(new Ka.a,{durationMs:Math.floor(qa.a.sj()-ta),extendedProperties:oa}),pa.Health.instance.recordKpiFailure(Ea.kpiName,"StrategyInitTimedOut",!1,!0,oa)));return Promise.resolve(Ga)},()=>{h.ULS.sendTraceTag(574239256,3E3,15,"Initialization failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.wD(),Math.floor(qa.a.sj()-ta));return Promise.resolve(1)})}IVj(){h.ULS.sendTraceTag(562128581,
3E3,50,"Loading {0}",this.wD());const ta=qa.a.sj();return y.get(this.h1.pXc(w.a.getAuthContext()),2,D.OAuthManagerSettings.KCe).then(Ga=>{if(0===Ga)h.ULS.sendTraceTag(562128582,3E3,50,"Load succeeded for {0} in {1} ms.",this.wD(),Math.floor(qa.a.sj()-ta));else if(1===Ga){h.ULS.sendTraceTag(562128583,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.wD(),Math.floor(qa.a.sj()-ta));var oa=Z.a.Fz();void 0!==oa&&null!==oa&&(oa.set("AuthLibrary",this.wD()),oa=Object.assign(new Ka.a,
{durationMs:Math.floor(qa.a.sj()-ta),extendedProperties:oa}),pa.Health.instance.recordKpiFailure(Ea.kpiName,"StrategyLoadFailed",!1,!0,oa))}else 2===Ga&&(h.ULS.sendTraceTag(558469660,3E3,15,"Load timed out for {0} after {1} ms, all future TryGetToken requests will fail.",this.wD(),Math.floor(qa.a.sj()-ta)),oa=Z.a.Fz(),void 0!==oa&&null!==oa&&(oa.set("AuthLibrary",this.wD()),oa=Object.assign(new Ka.a,{durationMs:Math.floor(qa.a.sj()-ta),extendedProperties:oa}),pa.Health.instance.recordKpiFailure(Ea.kpiName,
"StrategyLoadTimedOut",!1,!0,oa)));return Promise.resolve(Ga)},()=>{h.ULS.sendTraceTag(562128584,3E3,15,"Load failed for {0} after {1} ms, all future TryGetToken requests will fail.",this.wD(),Math.floor(qa.a.sj()-ta));return Promise.resolve(1)})}KU(ta,Ga,oa=null){return this.iKb(ta,Ga,!1,null,"",oa)}wAh(ta,Ga,oa,sa,Ha=null){return this.iKb(ta,Ga,!0,oa,sa,Ha)}iKb(ta,Ga,oa,sa,Ha,bb,Ya=0){Ya+=1;h.ULS.sendTraceTag(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",
ta,this.ggb(ta,Ga),this.wD(),Ya);var ua=Z.a.Fz();void 0!==ua&&null!==ua&&(ua.set("AuthLibrary",this.wD()),ua.set("AppName",ta),ua.set("Target",this.ggb(ta,Ga)),pa.Health.instance.recordKpiUsage(Ea.kpiName,0,"WacOAuthFC",ua));if(!D.OAuthManagerSettings.isEnabled){var Ma;return this.Hee((Ma=new v.a,Ma.IsSuccess=!1,Ma.Token=null,Ma.ErrorCode="NotEnabled",Ma.ErrorMessage="OAuthManager is disabled.",Ma),ta)}const Ca=D.OAuthManagerSettings.KJd[ta];if(void 0===Ca||null===Ca){h.ULS.sendTraceTag(41961345,
3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in the OAuthManagerApplications setting.",ta);var Va;return this.Hee((Va=new v.a,Va.IsSuccess=!1,Va.Token=null,Va.ErrorCode="DisallowedApp",Va.ErrorMessage="Disallowed appName: "+ta,Va),ta)}const Za=qa.a.sj(),Db=this;ua=this.xPh.then(tb=>Db.BDj(ta,Ca,Ga,oa,sa,Ha,bb,tb));Ma=oa?0:D.OAuthManagerSettings.KCe;let Lb;Va=(Lb=new v.a,Lb.IsSuccess=!1,Lb.Token=null,Lb.ErrorCode="authTokenStrategy_timeout",Lb.ErrorMessage="Auth Strategy timed out after ["+
Ma+"] ms when fetching token",Lb);let yb=this,Bc=this;return y.get(ua,Va,Ma).then(tb=>Ya<=Ea.iek&&(tb.ErrorCode===Ea.Dyh||tb.ErrorCode===Ea.Pjl)?(h.ULS.sendTraceTag(573175516,3E3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",Ya,Math.floor(qa.a.sj()-Za)),yb.iKb(ta,Ga,oa,sa,Ha,bb,Ya)):tb.ErrorCode===Ea.RAg&&!oa&&(h.ULS.sendTraceTag(561517645,3E3,50,"TryGetToken attempt {0} failed with ITP error.  3P Cookies are [{1}]. Retry: [{2]}]",Ya,Ea.F0f),Ea.EMi&&yb.h1.Ikd()&&yb.h1.Tmd(ta,Ca,Ga,
oa,sa,Ha).then(Mb=>Promise.resolve(yb.DXc(Mb,ta,Ga,Ca,Za))).catch(()=>{let Mb;const Hb=(Mb=new v.a,Mb.IsSuccess=!1,Mb.Token=null,Mb.ErrorCode="authTokenStrategy_failure",Mb.ErrorMessage="LoginPopup failed, GetToken could not be called",Mb);return Promise.resolve(yb.DXc(Hb,ta,Ga,Ca,Za))}),Ea.F0f)?yb.iKb(ta,Ga,!0,sa,Ha,bb,Ya):Promise.resolve(yb.DXc(tb,ta,Ga,Ca,Za))).catch(()=>{let tb;const Mb=(tb=new v.a,tb.IsSuccess=!1,tb.Token=null,tb.ErrorCode="authTokenStrategy_failure",tb.ErrorMessage="Auth Strategy failed with an unknown error",
tb);return Promise.resolve(Bc.DXc(Mb,ta,Ga,Ca,Za))})}BDj(ta,Ga,oa,sa,Ha,bb,Ya,ua){return 1===ua||2===ua?this.Hee(Object.assign(new v.a,{IsSuccess:!1,Token:null,ErrorCode:1===ua?"InitFailed":"InitTimedOut",ErrorMessage:"Auth Strategy Failed to Init or Load"}),ta):this.h1.KU(ta,Ga,oa,sa,Ha,bb,Ya).then(Ma=>Promise.resolve(this.jXg(Ma,!0,ta))).catch(Ma=>Promise.resolve(this.jXg(Ma,!1,ta)))}DXc(ta,Ga,oa,sa,Ha){const bb={};Ha=qa.a.sj()-Ha;bb.IsSuccess=ta.IsSuccess;bb.ErrorCode=ta.IsSuccess?"Success":ta.ErrorCode||
"";bb.ErrorMessage=ta.IsSuccess?"Success":this.ggb(Ga,ta.ErrorMessage||"");bb.Target=this.ggb(Ga,oa||"");bb.TimeInMS=Math.floor(Ha);bb.AuthLibrary=this.wD();bb.AppName=Ga;bb.AuthorityType=Object(e.a)(r,w.a.kMc());bb.UserType=this.njj(w.a.getAuthContext());bb.IsAuthSupportedInSession=m.a[this.V5];bb.RequestCount=++this.f2a;bb.AppId=sa;h.ULS.sendTraceTag(593863640,3E3,50,JSON.stringify(bb));ta.IsSuccess||(oa=Z.a.Fz(),void 0!==oa&&null!==oa&&(oa.set("AppName",Ga),oa.set("AuthLibrary",this.wD()),oa.set("ErrorCode",
ta.ErrorCode),oa.set("ErrorMessage",this.ggb(Ga,ta.ErrorMessage)),Ga=Object.assign(new Ka.a,{durationMs:Ha,extendedProperties:oa}),pa.Health.instance.recordKpiFailure(Ea.kpiName,"TryGetTokenFailure",!1,!0,Ga)));return ta}Hee(ta,Ga){h.ULS.sendTraceTag(578435090,3E3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",Ga,this.ggb(Ga,ta.ErrorMessage));const oa=Z.a.Fz();void 0!==oa&&null!==oa&&(oa.set("AppName",Ga),oa.set("AuthLibrary",this.wD()),oa.set("ErrorCode",ta.ErrorCode),
oa.set("ErrorMessage",this.ggb(Ga,ta.ErrorMessage)),Ga=Object.assign(new Ka.a,{extendedProperties:oa}),pa.Health.instance.recordKpiFailure(Ea.kpiName,"FailureBeforeGetToken",!1,!0,Ga));return Promise.resolve(ta)}Pvg(ta){return ta===ma.a.Old}ggb(ta,Ga){return this.Pvg(ta)&&Ga?"REDACTED":Ga}njj(ta){return u.AFrameworkApplication.fa.ka("IsAnonymousUser")?"anonymous":!ta.loginHint||1>ta.loginHint.length?"empty":-1<ta.loginHint.indexOf("guest#")?"guest":-1<ta.loginHint.indexOf("ext#")?"external":0>ta.upn.indexOf("@")?
"no-at":"supported"}KEj(){return 1===this.V5}jXg(ta,Ga,oa){let sa=null,Ha=null,bb=null,Ya=null;ta?ta.ErrorCode||ta.ErrorMessage?(Ha=ta.ErrorCode?ta.ErrorCode:Ea.B2f,bb=ta.ErrorMessage?ta.ErrorMessage:"No message"):ta.Token?Ga?sa=ta.Token:(Ha=Ea.WOk,bb="A rejected promise returned a token."):(Ha=Ea.B2f,bb=JSON.stringify(ta)):(Ha=Ea.ohk,bb="No result came from Auth Token Strategy");ta&&ta.Telemetry&&!this.Pvg(oa)&&(Ya=ta.Telemetry,h.ULS.sendTraceTag(579166408,3E3,50,JSON.stringify(Ya)));if(Ha===Ea.Kfk||
Ha===Ea.gpl)Ha=Ea.Dyh,bb="Auth Library Timed Out";Ha===Ea.Wci&&-1<bb.indexOf(Ea.O_h)&&(Ha=Ea.RAg);if(Ha||bb)sa=null;return Object.assign(new v.a,{IsSuccess:!!sa,Token:sa,ErrorCode:Ha,ErrorMessage:bb,Telemetry:Ya})}static get F0f(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthInteractiveFallbackEnabled",!1)}static get EMi(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginFlowEnabled",!1)}}Ea.gpl="token_renewal_error";
Ea.B2f="Exception";Ea.ohk="NoResult";Ea.WOk="RejectToken";Ea.Kfk="monitor_window_timeout";Ea.Dyh="Timeout";Ea.Pjl="authTokenStrategy_timeout";Ea.Wci="login_required";Ea.O_h="AADSTS50058";Ea.RAg="Cookies Disabled";Ea.kpiName="OAuthManager";Ea.iek=2;Object(J.a)(Ea,"OAuthManager",null,[527])},673:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(1166),e=d(13),m=d(100),r=d(35),v=d(26),A=d(435),w=d(113);class y{constructor(u,D,F,I,H,L){this.S1a=this.hFa=null;this.Zq=Object(h.a)(A.a,I.HRd(u,
D,F,Object(e.a)(this,this.zC,"onPointerOver"),Object(e.a)(this,this.iz,"onPointerOut"),H));this.iGa=0;this.Mc=L;this.Mc.IB(Object(e.a)(this,this.gB,"onSessionEnd"));this.clear()}dispose(){this.Zq.dispose();this.hFa=null}get zea(){return this.S1a}setZIndex(u){this.Zq.setZIndex(u)}cEf(u,D,F){this.S1a=u;this.hFa=D;this.Zq.Bhd("UnreadNotification_16x16x32",this.zea,F)}clear(){this.Zq.clear();this.S1a=w.a.none}pxa(){this.NZ();this.Zq.s3a(this.zea,this.QYb);this.Zq.rdc()}NZ(){this.Zq.iqb();this.Zq.kGb()}gB(){v.a.J(39068559,
804,15,"Canvas shape highlights pawn hovered count: {0};",this.iGa);0<this.iGa&&m.c(r.a.DNd)}get QYb(){return this.hFa?this.hFa():""}zC(){this.pxa();v.a.J(23606147,804,50,"Shape revision tracking pawn hovered");this.iGa+=1;return!0}iz(){this.NZ();return!0}}Object(J.a)(y,"ShapeRevisionTrackingPawn",null,[551])},674:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.supported=1]="supported";e[e.userUnsupportedAnonymous=2]="userUnsupportedAnonymous";
e[e.userUnsupportedNoLoginHint=3]="userUnsupportedNoLoginHint";e[e.hostUnsupported=4]="hostUnsupported"})(h||(h={}));Object(J.b)("SupportStatus",h)},675:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,r,v,A,w,y,u=null,D=null,F=!1,I=null,H=null,L=null,E=null,aa=!1,Q=null,O=null,T=null,K=null,X=null,P=null){this.url=e;this.nBl=m;this.body=r;this.headers=v;this.sNe=A;this.priority=w;this.state=y;this.iGh=u;this.Ojc=D;this.Xi=F;this.gGk=I;this.I1k=H;this.name=L;this.VDb=
E;this.JYd=aa;this.tze=Q;this.Dy=O;this.yvb=T;this.hGb=K;this.Uuj=X;this.responseType=P}}Object(J.a)(h,"ClientRequest",null,[])},676:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(511);var h=d(128);class e extends V.a{constructor(){super();this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.ul()})}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static ul(){return["AugLoop_Core_Operation"]}}Object(J.a)(e,"UpdateOperation",V.a,[])},708:function(J,V,d){J=d(0);class h{}Object(J.a)(h,
"AuthContext",null,[]);var e=d(25),m=d(234);d.d(V,"a",function(){return r});class r{static getAuthContext(){const v=e.AFrameworkApplication.fa.Ga("UserPrincipalName")||"";let A=v;e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OAuthLoginHintEnabled",!1)&&(A=m.OAuthManagerSettings.Hik||v);return Object.assign(new h,{upn:v,loginHint:A,authority:m.OAuthManagerSettings.authority,authorityType:r.kMc(),tenantId:e.AFrameworkApplication.fa.Ga("TenantId")||""})}static kMc(){let v=
0;const A=r.V8f();"aad"===A.toLowerCase()?v=2:"msa"===A.toLowerCase()&&(v=1);return v}static V8f(){return e.AFrameworkApplication.fa.Ga("HostAuthType")||""}}Object(J.a)(r,"OAuthIdentity",null,[])},717:function(J,V,d){J=d(0);var h=d(25),e=d(106),m=d(78),r=d(13),v=d(33),A=d(85),w=d(26),y=d(259);class u{constructor(){this.TenantId=this.LoggableUserId=this.FileSource=this.ProviderId=this.UserId=this.UserName=null;this.EnableMacrosForProtectedFile=this.BrowserCacheAllowed=!1;this.ComplianceDomainPrefix=
this.ServerDocId=null;this.IsCLPCoauthoringEnabled=this.IsO365CommercialHost=this.IsO365ConsumerHost=!1}}Object(J.a)(u,"PodsInfo",null,[]);d.d(V,"a",function(){return D});class D{constructor(F,I,H,L,E,aa,Q){w.a.J(512262873,804,50,"Start PodsInfoSender::PodsInfoSender()");this.fc=Q;this.ew=F;this.Xa=I;this.Mc=H;this.Wy=L;this.Md=E;this.yb=aa;this.Bzb=!1;this.pVa=0;this.fc.ff(Object(r.a)(this,this.initialize,"initialize"))}initialize(){w.a.J(512262872,804,50,"Start PodsInfoSender::Initialize()");this.sendInfoToPods(null);
this.Mc.JB(Object(r.a)(this,this.to,"onSessionRehydrated"));this.Wy.hob(Object(r.a)(this,this.oea,"onPodSessionRefreshed"));this.Bzb=!0}dispose(){this.Bzb&&(this.Mc.Pea(Object(r.a)(this,this.to,"onSessionRehydrated")),this.Wy.Ffb(Object(r.a)(this,this.oea,"onPodSessionRefreshed")),this.Bzb=!1)}sendInfoToPods(){var F=this.fc.Ga("361"),I=this.Xa.podSessionId;const H=this.Xa.fk,L=h.AFrameworkApplication.userSessionId,E=e.a.create().toString();w.a.J(512262871,804,50,"PodsInfoSender.SendInfoToPods: Send user info to Pods, correlation={0}",
E);F=String.format("{0}PodHandler.ashx?action=SendUserInfo&PodSID={1}",F,I);I={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};I["X-UserSessionId"]=L;I["X-CorrelationID"]=E;I["X-WacCluster"]=H;try{const aa=Object.assign(new u,{UserName:this.fc.Ga(A.a.Wuk),UserId:this.fc.Ga("387"),ProviderId:this.fc.Ga("388"),FileSource:this.fc.Ga("FileSource"),LoggableUserId:this.fc.Ga("LoggableUserId"),TenantId:this.fc.Ga("TenantId"),BrowserCacheAllowed:this.fc.ka("535")&&this.fc.ka("431"),
EnableMacrosForProtectedFile:h.AFrameworkApplication.CZb,ServerDocId:this.fc.Ga("ServerDocId"),ComplianceDomainPrefix:h.AFrameworkApplication.fa.Ga("ComplianceDomainPrefix"),IsO365CommercialHost:this.fc.ka("IsO365CommercialHost"),IsO365ConsumerHost:this.fc.ka("IsO365ConsumerHost"),IsCLPCoauthoringEnabled:this.fc.ka("PPTClpSwitchEnabled")&&this.fc.ka("SupportsOfficeClientCoauthoring")}),Q=v.c(aa);this.ew.yj(F,2,Q,I,!1,1,Object(r.a)(this,this.mqk,"onSendUserInfoSucceeded"),Object(r.a)(this,this.lqk,
"onSendUserInfoFailed"),null,void 0,void 0,void 0,void 0,y.a("6"))}catch(aa){w.a.J(512262870,804,15,"PodsInfoSender.SendInfoToPods: error serializing user info {0}",aa)}}mqk(){w.a.J(512262869,804,50,"PodsInfoSender.OnSendUserInfoSucceeded");this.pVa=0}lqk(){w.a.J(512262868,804,50,"PodsInfoSender.OnSendUserInfoFailed");3>this.pVa?this.sXk():this.Pkj()}sXk(){this.pVa++;w.a.J(512262867,804,50,"PodsInfoSender.RetryRequestOnFailure: Request failed - retrying (failures count: {0})",this.pVa);const F=new m.a(1,
1,5E3,Object(r.a)(this,this.sendInfoToPods,"sendInfoToPods"),90,"22");this.yb.Cb(F)}Pkj(){w.a.J(512262866,804,15,"PodsInfoSender.GiveUp: Request failed - giving up (failures count: {0})",this.pVa);this.Md.FG(307,null);this.pVa=0}to(){this.pVa=0;w.a.J(512262865,804,50,"PodsInfoSender.OnSessionRehydrated");this.sendInfoToPods(null)}oea(){this.pVa=0;w.a.J(512262864,804,50,"PodsInfoSender.OnPodSessionRefreshed");this.sendInfoToPods(null)}}Object(J.a)(D,"PodsInfoSender",null,[])},943:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);class h{constructor(){this.handler=null}}Object(J.a)(h,"SetAnnotationResultCallbackParameters",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.chronosslim.js.map