'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[11],{1211:function(J,V,d){d.r(V);J=d(0);var h=d(13);class e{constructor(ab,Pb){this.OMa=null;this.WQb=ab;this.xUh=Pb}init(){this.WQb.continueWith(()=>{this.OMa=this.WQb.result;this.OMa.lob(Object(h.a)(this,this.h0,"onUsersUpdated"))})}h0(){e.JIf(this.OMa.I6a())&&(this.OMa.yGe(Object(h.a)(this,this.h0,"onUsersUpdated")),this.xUh.IsRealCoauthSession=!0)}static JIf(ab){let Pb=null;for(const rc of ab)if(rc)if(ab=rc.isAnonymous||
!rc.email?rc.clientId:rc.email.toUpperCase(),!Pb)Pb=ab;else if(Pb!==ab)return!0;return!1}}Object(J.a)(e,"CoauthTelemetry",null,[1165]);var m=d(376),r=d(1029),v=d(1166),A=d(25),w;(function(ab){ab[ab.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";ab[ab.notImplemented=1]="notImplemented";ab[ab.renderHandled=2]="renderHandled";ab[ab.renderHandledWithVeto=3]="renderHandledWithVeto"})(w||(w={}));Object(J.b)("CoauthorGalleryTelemetryEndResult",w);var y=d(94),u=d(101),D=d(2);class F{constructor(ab,
Pb,rc,ic,md,Fd,ne,ud,gb){this.hjf=this.J_e=this.cK=null;this.doa=ab;this.Vyc=new r.a;this.eb=rc;this.Vrd=Pb;this.Pfa=ic;this.mi=md;this.nBd=Fd;this.JMa=ne;this.FJh=ud;this.H6e=this.E6e=!1;this.Fzc=0;this.G_e=1;this.L_a=gb;this.iTb=this.eb.ka("PeoplesWellExtraButtonInfoIsEnabled");this.Jjb=Object(v.a)(String,A.AFrameworkApplication.$c.Application)||""}get jvh(){return this.Vyc.task}init(){D.Task.WAA.call(null,this.JMa,this.Vrd,this.nBd).continueWith(()=>{this.cK=this.JMa.result;this.J_e=this.Vrd.result;
this.hjf=this.nBd.result;D.Task.WAA.call(null,this.Vrd.result.aBa,this.nBd.result.Vld).continueWith(()=>{this.G_e=this.J_e.aBa.result;this.Fzc=this.hjf.Vld.result;this.cK.lob(Object(h.a)(this,this.N$c,"onUsersUpdatedEventListener"));this.cK.I6a().length&&this.h0()})})}N$c(){this.h0()}h0(){this.FJh(this.cK.I6a())?(this.cK.yGe(Object(h.a)(this,this.N$c,"onUsersUpdatedEventListener")),this.gmk(this.E6e)):this.Vyc.jM(1);this.E6e=!0}gmk(ab){this.H6e?this.jvh.continueWith(()=>{m.ULS.sendTraceTag(42062996,
325,15,"We already attempted to log a render of coauthor gallery: {0}",w[this.jvh.result])}):(this.H6e=!0,this.PDk(0===this.G_e&&!ab))}PDk(ab){ab?this.Pfa.gk(4,Object(h.a)(this,this.Qxe,"onInteractiveReady")):this.Vyc.jM(1)}Qxe(){const ab=this.mi.$g("AppInitStatus_interactivityReady");m.ULS.shipAssertTag(42259235,325,!!this.Fzc);const Pb=this.Fzc-ab,rc={};rc.InteractiveTime=ab;rc.ReactRenderComplete=this.Fzc;rc.HadTabSwitch=this.L_a();rc.IsModernGallery=this.iTb;m.ULS.sendTraceTag(594883104,325,50,
u.a.toJSON(rc));this.iTb?(m.ULS.sendTraceTag(42062997,325,15,Pb.toString()),this.Vyc.jM(this.wBl(Pb)?3:2)):m.ULS.sendTraceTag(594883103,325,15,Pb.toString())}wBl(ab){const Pb=ab>this.eb.Cc("CoauthorGalleryTimeToRenderDurationMs",1E4),rc="Word"===this.Jjb;if(this.L_a())return m.ULS.sendTraceTag(50455714,325,50,Pb.toString()),!1;rc&&y.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Pb&&(rc&&y.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded",
"CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),m.ULS.sendTraceTag(42062998,325,15,ab.toString()));return Pb}}Object(J.a)(F,"CoauthorGalleryTelemetry",null,[1163]);class I{constructor(ab){this.cK=null;this.qrc={};this.axc={};this.FOb=null;this.JMa=ab}DOc(ab){const Pb=new r.a;this.init().continueWith(()=>{ab in this.qrc?Pb.jM(this.qrc[ab]):this.axc[ab]=Pb});return Pb.task}init(){if(this.FOb)return this.FOb.task;this.FOb=new r.a;this.JMa.continueWith(()=>{this.cK=this.JMa.result;this.cK.lob(Object(h.a)(this,
this.h0,"onUsersUpdated"));this.aEh();this.FOb.Dg(null)});return this.FOb.task}aEh(){const ab=this.cK.I6a();ab.sort(Object(h.a)(this,this.gsi,"comparePresenceUsers"));this.qrc={};for(let Pb=0;Pb<ab.length&&ab[Pb]&&ab[Pb].sEa;Pb++)this.d3h(this.qrc,ab[Pb].clientId,Pb)}d3h(ab,Pb,rc){ab[Pb]=rc;Pb in this.axc&&(this.axc[Pb].jM(rc),delete this.axc[Pb])}h0(){this.aEh()}gsi(ab,Pb){return ab.sEa>Pb.sEa?1:ab.sEa<Pb.sEa?-1:0}}Object(J.a)(I,"CoauthorPositionFinder",null,[1162]);var H=d(1169),L=d(1168),E=d(1167),
aa=d(17),Q=d(106);class O{constructor(){this.eha=null;this.VLb=Array(32)}xor(ab){if(!ab)throw Error.argumentNull("Guid argument cannot be null");const Pb=new O,rc=new Sys.StringBuilder;for(let ic=0;ic<ab.VLb.length;ic++){const md=this.VLb[ic]^ab.VLb[ic];Pb.VLb[ic]=md;rc.append(md.toString(16));7!==ic&&11!==ic&&15!==ic&&19!==ic||rc.append("-")}Pb.eha=Q.a.Mf(rc.toString());return Pb}toString(){return this.eha.toString()}equals(ab){if(!ab)throw Error.argumentNull("Guid argument cannot be null");return this.eha.equals(ab.eha)}static MLc(ab){if(!ab)throw Error.argumentNull("String input cannot be null");
const Pb=new O;Pb.eha=Q.a.Mf(ab);const rc=Pb.eha.toString();let ic=0;for(let Fd=0;Fd<rc.length;Fd++){var md=ab.charAt(Fd);if(O.tJj(md))md=O.nuj(md,ab.charCodeAt(Fd)),Pb.VLb[ic++]=md;else if(!O.PIj(md))throw Error.argument("String contains characters not valid in Guids");}return Pb}static tJj(ab){return"0"<=ab&&"9">=ab||"A"<=ab&&"F">=ab||"a"<=ab&&"f">=ab}static PIj(ab){return"{"===ab||"}"===ab||"-"===ab}static nuj(ab,Pb){if("0"<=ab&&"9">=ab)return Pb-48;if("A"<=ab&&"F">=ab)return Pb-65+10;if("a"<=
ab&&"f">=ab)return Pb-97+10;throw Error.argument("Char is not valid hex digit");}}Object(J.a)(O,"Guid",null,[]);class T{constructor(ab,Pb,rc,ic){this.OMa=null;this.L0e=this.Qgf=!1;this.Mef=0;this.WQb=ab;this.XEd=Pb;this.eb=rc;this.Ezd=ic;this.mJh=A.AFrameworkApplication.$ib||A.AFrameworkApplication.mQ;this.Aff=new H.a(L.a.Tq())}get vSd(){return this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1)}init(){this.WQb.continueWith(()=>{this.OMa=this.WQb.result;
this.OMa.lob(Object(h.a)(this,this.h0,"onUsersUpdated"))})}h0(){this.gri(this.OMa.I6a())}gri(ab){var Pb=0;const rc=new E.a(L.a.Tq());for(const ic of ab)if(ic&&ic.isAnonymous){A.AFrameworkApplication.qta("70eb6120;2gfeb930");if(rc.Jb(ic.userName))rc.ga(ic.userName).add(ic.clientId);else{let md;rc.add(ic.userName,(md=new aa.a,md.add(ic.clientId),md))}ic.clientId!==this.Ezd?(Pb++,2<=Pb&&!this.Qgf&&this.nZj()):!this.L0e&&this.vSd&&"Guest"===ic.userName&&(m.ULS.sendTraceTag(509726851,302,50,"User was assigned 'Guest' name"),
this.L0e=!0)}if(this.vSd&&this.Mef!==Pb){m.ULS.sendTraceTag(512553562,302,50,"Total guests updated to: {0}",Pb+(this.mJh?1:0));this.Mef=Pb;for(let ic of rc.keys)2<=rc.ga(ic).count&&(ab=this.v4i(rc.ga(ic)),this.Aff.contains(ab)||(Pb={},Pb.guestsWithSameName=rc.ga(ic).count,Pb.identifier=ab,m.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected: {0}",Pb),this.Aff.add(ab)))}}nZj(){m.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.Qgf=!0;this.vSd&&
this.XEd&&this.XEd.continueWith(()=>{window.setTimeout(()=>{this.XEd.result.logActivity("MultipleGuestsCoauthoring",null)},15E3)})}v4i(ab){if(!ab||1>=ab.count)return"";let Pb=O.MLc(ab.ga(0));for(let rc=1;rc<ab.count;rc++)Pb=Pb.xor(O.MLc(ab.ga(rc)));return Pb.toString()}}Object(J.a)(T,"GuestCoauthTelemetry",null,[]);var K=d(1165);class X{constructor(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}}Object(J.a)(X,"PL",null,[]);var P=d(33);class ea{constructor(){this.ct=
this.vt=this.d=0}static Xlh(ab,Pb,rc){const ic=new ea;ic.d=ab;ic.vt=Pb;ic.ct=rc;return P.c(ic)}}Object(J.a)(ea,"VD",null,[]);var ia=d(87);class ja{constructor(ab,Pb,rc,ic,md,Fd,ne,ud,gb){this.twf=!1;this._id=ab;this.Fj=Pb;this.qt=rc;this.Fzd=ic;this.yFd=md;this.f3a=Fd;this.e0a=ne;this.VKh=ud;this.L_a=gb;this.Jjb=Object(v.a)(String,A.AFrameworkApplication.$c.Application)||""}Hod(ab){D.Task.WAA(this.Fzd,this.yFd).continueWith(()=>{if(this.Fzd.result<=this.yFd.result)ab.jM(!1);else{var Pb=this.qt-this.Fj,
rc=new X;rc.id=this._id;rc.et=this.qt;rc.st=this.Fj;rc.d=this.qt-this.Fj;rc.mp=this.Fzd.result;rc.tp=this.yFd.result;rc.ct=this.Y0i(this.VKh);rc.vc=this.L_a();var ic=P.c(rc),md="Word"===this.Jjb;m.ULS.sendTraceTag(42078597,302,15,ic);if(md){const Fd=new Map;Fd.set("data",ic);y.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",Fd)}Pb>this.f3a.value&&!this.twf&&!rc.vc&&(this.twf=!0,ab.jM(!0),rc=Object.assign(new ia.a,{inStaging:!0,extendedProperties:new Map}),rc.extendedProperties.set("data",
ic),md&&y.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,rc),Pb<this.e0a.value&&m.ULS.sendTraceTag(42078598,302,15,ea.Xlh(Pb,this.f3a.value,this.e0a.value)));ab.task.isCompleted||ab.jM(!1)}})}Y0i(ab){switch(ab){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}}Object(J.a)(ja,"PresenceLatencyActivityLogger",null,[]);class C{constructor(ab,Pb,rc){this.QZe=this.F_e=this.erc=this.prc=this.Ejb=0;this._id=ab;
this.f3a=Pb;this.e0a=rc;this.Jjb=Object(v.a)(String,A.AFrameworkApplication.$c.Application)||""}get nGf(){return this.Ejb}set nGf(ab){this.Ejb=ab;this.XNd()}get MQf(){return this.prc}set MQf(ab){this.prc=ab;this.XNd()}get eOf(){return this.erc}set eOf(ab){this.erc=ab;this.XNd()}get NQf(){return 0!==this.F_e}get fOf(){return 0!==this.QZe}XNd(){!this.NQf&&this.Ejb&&this.prc&&(this.F_e=this.Hod(this.prc,"CoauthGalleryLightupDurationTooLong"));!this.fOf&&this.Ejb&&this.erc&&(this.QZe=this.Hod(this.erc,
"CanvasPresenceLightupDurationTooLong"))}Hod(ab,Pb){const rc=ab-this.Ejb;var ic=new X;ic.id=this._id;ic.et=ab;ic.st=this.Ejb;ic.d=rc;var md=P.c(ic);ab="Word"===this.Jjb;ic="CanvasPresenceLightupDurationTooLong"===Pb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Pb?m.ULS.sendTraceTag(572289499,302,15,md):m.ULS.sendTraceTag(571524118,302,15,md);if(ab){var Fd=new Map;Fd.set("data",md);y.Health.instance.recordKpiUsage(ic,0,"wordcollabrel",Fd)}return rc>
this.f3a.value?(Fd=Object.assign(new ia.a,{inStaging:!0,extendedProperties:new Map}),Fd.extendedProperties.set("data",md),md=rc<this.e0a.value,Fd.extendedProperties.set("cash",md?"true":"false"),ab&&y.Health.instance.recordKpiFailure(ic,Pb,!1,!0,Fd),m.ULS.sendTraceTag(572289500,302,15,ea.Xlh(rc,this.f3a.value,this.e0a.value)),md?2:1):3}}Object(J.a)(C,"PresenceLightupLatencyLogger",null,[]);var pa=d(284),Z=d(279);class qa{constructor(ab,Pb,rc,ic,md,Fd,ne=null,ud=null,gb=null){this.Lsf={};this.Urd=
{};this.Ldf=new aa.a;this.GOb=this.cK=this.jyc=null;this.Wxf=this.Uxf=0;this.f3a=new K.a(()=>ne.QP("PresenceBootLatencyThreshold",1E4));this.e0a=new K.a(()=>ne.QP("PresenceBootLatencyCutoffThreshold",6E4));this.q_h=new K.a(()=>ne.QP("PresenceLightupLatencyThreshold",2E3));this.cMh=new K.a(()=>ne.QP("PresenceLightupLatencyCutoffThreshold",1E4));this.zUh=ic;this.H_e=ab;this.gvf=Pb;this.JMa=rc;this.mi=md;this.Ezd=ud;this.L_a=Fd;this.wf=gb;this.hZe=!1;this.init()}fNi(ab,Pb=0){var rc=new Date;const ic=
new r.a;this.init().continueWith(()=>{this.dpk(ab);this.gNi(ic,ab,rc,Pb)})}get xWg(){return this.Ezd||"{"+A.AFrameworkApplication.userSessionId+"}"}init(){if(this.GOb)return this.GOb.task;this.GOb=new r.a;this.L_a()&&m.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.H_e.continueWith(()=>{const ab=this.H_e.result,Pb=ab.aBa,rc=ab.r7c;rc.continueWith(()=>{Pb.continueWith(()=>{this.wf&&this.wf.addQosPillar("RealTimeCoauth");this.gjl(Pb.result,rc.result);this.GOb.Dg(null)})})});this.gvf.continueWith(()=>
{this.jyc=this.gvf.result;this.jyc.x3a(Object(h.a)(this,this.Spk,"onRtcConnection"));this.jyc.zAa(Object(h.a)(this,this.Kkk,"onCoauthorBootReceived"))});this.JMa.continueWith(()=>{this.cK=this.JMa.result;this.cK.lob(Object(h.a)(this,this.N$c,"onUsersUpdatedEventListener"));0<this.cK.I6a().length&&this.h0()});return this.GOb.task}T9f(){return this.mi.xo(pa.a.Zib)?this.mi.$g(pa.a.Zib):Z.a.NAa?window.performance.timing.fetchStart:-1}Spk(ab,Pb){this.hZe||2!==Pb.newState||(ab=this.T9f(),ab=Date.now()-
ab,Pb={},Pb.clientId=this.xWg,Pb.bootTime=ab,this.hZe=!0,this.jyc.$ea(15,Pb))}Kkk(ab,Pb){if(15===Pb.type){ab=Date.now();Pb=Pb.iya;var rc=Pb.bootTime;this.W0d(Pb.clientId).nGf=ab-rc}}N$c(){this.h0()}h0(){const ab=Date.now();var Pb=this.cK.I6a();const rc=new aa.a;for(const ic of Pb)this.Ldf.contains(ic.clientId)||(this.Ldf.add(ic.clientId),rc.add(ic.clientId));if(0<rc.count)for(let ic of rc)Pb=this.W0d(ic),Pb.NQf||(Pb.MQf=ab)}dpk(ab){ab=this.W0d(ab);ab.fOf||(ab.eOf=Date.now())}W0d(ab){return ab in this.Urd?
this.Urd[ab]:this.Urd[ab]=new C(ab,this.q_h,this.cMh)}gjl(ab,Pb=0){this.Uxf=ab;this.Wxf=Pb?Pb:(new Date).getTime()}gNi(ab,Pb,rc,ic){rc=rc?rc.getTime():(new Date).getTime();Pb in this.Lsf?ab.R0():(ic=new ja(Pb,this.egj(),rc,this.DOc(this.xWg),this.DOc(Pb),this.f3a,this.e0a,ic,this.L_a),this.Lsf[Pb]=ic,ic.Hod(ab))}egj(){return 1===this.Uxf?this.Wxf:this.T9f()}DOc(ab){return this.zUh.DOc(ab)}}Object(J.a)(qa,"PresenceBootTelemetry",null,[1161]);var ya=d(177),Ka=d(68),Da=d(336),la=d(55),ma=d(287);class Ea{get name(){return"Common.App.CoauthTelemetry"}Wb(ab){ab.register(e,
"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").ma().na(()=>new e(ma.a.Ju(ab.Ka("Common.IPeopleInfoProvider")),A.AFrameworkApplication.Tg));ab.register(F,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").ma().na(()=>new F(A.AFrameworkApplication.Ta,ma.a.Ju(ab.Ka("Common.ICoauthoringTelemeryInfoProvider")),A.AFrameworkApplication.fa,ya.a.get_instance(),Da.a.instance,ma.a.Ju(ab.Ka("Common.IPeoplesWell")),ma.a.Ju(ab.Ka("Common.IPeopleInfoProvider")),
e.JIf,()=>this.QKf()));ab.register(qa,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").ma().na(()=>new qa(ma.a.Ju(ab.Ka("Common.ICoauthoringTelemeryInfoProvider")),ma.a.Ju(ab.Ka("Common.IRealtimeChannelBasic")),ma.a.Ju(ab.Ka("Common.IPeopleInfoProvider")),ab.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),Da.a.instance,()=>this.QKf(),A.AFrameworkApplication.fa,null,y.Health.instance));ab.register(I,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").ma().na(()=>
new I(ma.a.Ju(ab.Ka("Common.IPeopleInfoProvider"))));ab.register(T,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").ma().na(()=>new T(ma.a.Ju(ab.Ka("Common.IPeopleInfoProvider")),ma.a.Ju(ab.Ka("Common.ISystemInitiatedFeedback")),A.AFrameworkApplication.fa,"{"+A.AFrameworkApplication.userSessionId+"}"))}init(){A.AFrameworkApplication.fa.ff(()=>{la.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();la.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();
A.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&la.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();A.AFrameworkApplication.fa.ka("CashTelemetryIsEnabled")&&(la.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),la.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})}dispose(){}QKf(){return Z.a.NAa&&Da.a.instance.xo(pa.a.qpc)?0<Da.a.instance.$g(pa.a.qpc)[pa.a.Lod]:!1}static main(){Ka.a.instance.Bc(new Ea)}}Object(J.a)(Ea,
"CoauthTelemetryPackage",null,[2,3]);var ta=d(263),Ga=d(1171),oa=d(232),sa=d(463);class Ha{constructor(ab,Pb,rc,ic,md){this.Ic=ab;this._clientId=Pb;this.DMh=md;this.COh=rc||(()=>null);this.DOh=ic||(()=>null)}get id(){return this.Ic.id}get xAc(){return this.Ic.xAc}get BAc(){return this.Ic.BAc}get AAc(){return this.Ic.AAc}get zAc(){return this.Ic.zAc}get yAc(){return this.Ic.yAc}get DAc(){return this.Ic.DAc}get eHd(){return this.Ic.eHd}get BIb(){return this.Ic.BIb}get Pjd(){return this.Ic.Pjd}get H7c(){return this.Ic.H7c}get clientId(){return this._clientId}get psa(){return this.COh}get W2(){return this.DOh}get oJi(){return this.DMh}static createInstance(ab,
Pb,rc,ic,md=!1){return new Ha(ab,Pb,rc,ic,md)}}Object(J.a)(Ha,"PeoplesWellSettings",null,[]);var bb=d(26);class Ya{constructor(ab){this.vj=ab}get aBa(){return this.vj.aBa}get r7c(){return this.vj.r7c}}Object(J.a)(Ya,"CoauthoringTelemetryInfoProvider",null,[564]);var ua=d(903),Ma=d(77),Ca=d(115),Va=d(762),Za=d(568);class Db{constructor(ab,Pb,rc,ic,md){this.cCb=new Ma.a;this.$y=null;this.vj=ab;this.Zbb=rc;this.LI=ic;this.LI.tId(Object(h.a)(this,this.X8c,"onEditorTableUpdate"));this.O2j=A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
this.mqe=md;Pb&&Pb.execute(Fd=>{this.$y=Fd})}dispose(){this.cCb&&(Ca.a.rgd([this.cCb]),this.cCb=null);this.LI.Xeh(Object(h.a)(this,this.X8c,"onEditorTableUpdate"))}lob(ab){this.cCb.addHandler("UsersUpdatedEvent",ab)}yGe(ab){this.cCb.removeHandler("UsersUpdatedEvent",ab)}I6a(){return this.E8f(!1)}WZi(){return this.E8f(!0)}E8f(ab){const Pb=[];this.vj.Mib(this.vj.yC).returnValue||bb.a.J(512497499,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",this.vj.yC);var rc=
null;this.$y&&(rc=this.$y.bMc());const ic=this.mqe.zag();let md=!1;for(const Fd of this.vj.zZ)ab&&Db.DCc(ic,Fd.EmailAddress)?md=!0:Array.add(Pb,this.SBi(Fd,rc));rc={};rc.fExcludeCurrent=ab;rc.fCurrentExcluded=md;rc.CurrentID=this.vj.yC;rc.EditorCount=this.vj.zZ.length;rc.IsRtcNull=!this.$y;rc.UserCount=Pb.length;bb.a.J(512497498,814,50,"PeopleInfoProvider::GetAllUsers:{0}",P.c(rc));return Pb}SBi(ab,Pb){const rc=this.Zbb.$Ca(new ua.a(ab.EmailAddress,void 0,ab.Name),ab.ColorIndex,ab.ID,1),ic=new Va.a;
ic.xYa(0);let md=0,Fd=!1,ne=!1;if(Pb&&ab.ID in Pb){ic.xYa(1);if(this.O2j){const ud=Pb[ab.ID];ud&&ud.capabilities&4&&ic.xYa(4);Fd=!0;ud&&(md=ud.capabilities,ne=ud.isAnonymous)}delete Pb[ab.ID]}bb.a.J(512497495,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities: {6}; fIssuserinrtc: {7}; isAnonymous: {8}",ab.ID,rc,ic.qca(1),ic.qca(4),this.vj.yC,
!ab.EmailAddress,md,Fd,ne);return new Za.a(ab.ID,ab.Name,rc,ic,null,ab.EmailAddress,void 0,void 0,ne,void 0,void 0,ab.JoinCoauthTime)}X8c(){bb.a.J(512497494,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.cCb.raiseEvent("UsersUpdatedEvent",this)}static DCc(ab,Pb){return!!ab&&!!Pb&&ab.toLowerCase()===Pb.toLowerCase()}}Object(J.a)(Db,"PeopleInfoProvider",null,[1101]);var Lb=d(78),yb=d(221),Bc=d(134),tb=d(346),Mb=d(290);class Hb extends yb.a{constructor(){super();this.JoinTimeInMS=0;this.IsAnonymous=
!1;this.ImageUrl=null;this.CanJump=this.ActiveStatus=!1;this.Upn=null}get ControlType(){return 5}}Object(J.a)(Hb,"PeopleButtonProps",yb.a,[]);var vb=d(747),Xb=d(45),Uc=d(67);class hb{constructor(ab){this.tpc=new Uc.a;this.tSd=null;this.clientId=ab}I8k(ab){this.oPk();this.x3k(ab);for(const Pb of ab)Pb.clientId!==this.clientId&&this.BEf(Pb)}get qod(){const ab=[];for(let Pb of this.tpc.values){const rc=this.jlh(Pb);Array.add(ab,rc)}return ab}get Hva(){return this.tpc.count}kId(ab,Pb){ab=ab.toUpperCase();
let rc;({value:rc}=this.tpc.Rf(ab)).returnValue||(rc=[],this.tpc.$(ab,rc));Array.add(rc,Pb)}oPk(){this.tpc=new Uc.a}x3k(ab){for(const Pb of ab)if(Pb.clientId===this.clientId){this.tSd=Pb;break}}}Object(J.a)(hb,"UserTracker",null,[1662]);class Zb extends hb{constructor(ab,Pb){super(ab);this.EOh=Pb}BEf(ab){ab.isAnonymous||!ab.email?this.kId(ab.clientId,ab):this.tSd&&L.a.Tq().equals(this.tSd.email,ab.email)||this.kId(ab.email,ab)}jlh(ab){let Pb=new Date(0),rc=0<ab.length?ab[0]:null;for(const ic of ab)(ab=
this.EOh(ic.clientId))&&Pb.getTime()<ab.pxb.getTime()&&(Pb=ab.pxb,rc=ic);return rc}}Object(J.a)(Zb,"UniqueUserTracker",hb,[]);class Fc extends hb{constructor(ab){super(ab)}BEf(ab){this.kId(ab.clientId,ab)}jlh(ab){return ab[0]}}Object(J.a)(Fc,"UserInstanceTracker",hb,[]);const ob=(ab,Pb,rc)=>rc?new Zb(ab,Pb):new Fc(ab);var ac=d(70),pb=d(658),nb=d(35);class Tb{constructor(ab,Pb=null,rc=null){this.cK=null;this.CFd=new r.a;this.Ic=ab;this.Lad=Pb;rc&&rc.continueWith(()=>{this.cK=rc.result;this.cK.lob(Object(h.a)(this,
this.h0,"onUsersUpdated"));this.eed()});new Za.a(this.settings.clientId,"Anonymous user","#cccccc",new Va.a(7));this.ZTc=this.Dxd=!0;this.fvd=this.mBd=!1;this.X0=ob(this.settings.clientId,this.settings.W2,ab.oJi)}get settings(){return this.Ic}get gGj(){return A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.ka("ColorPresenceHashIsEnabled"):!1}get eug(){return A.AFrameworkApplication.fa?A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled"):!1}o2i(){let ab;let Pb,rc,ic,md;var Fd=
this.p2i();this.X0.Hva?1===this.X0.Hva?(Pb=!0,rc=this.settings.BIb.cluster,ic=this.settings.BIb.eHc,md=this.X0.qod[0].color):(Pb=!0,rc=this.settings.H7c.cluster,ic=this.settings.H7c.eHc,md=""):(Pb=!1,md=ic=rc="");ab=Fd[0];Fd=Fd.slice(1);return{stk:ab,ttk:Fd,otk:Pb,VFl:rc,qtk:ic,ptk:md}}p2i(){if(2<=this.X0.Hva)return[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.X0.Hva)];if(1===this.X0.Hva){const ab=this.X0.qod[0],Pb=this.settings.W2(ab.clientId);return Pb&&2===
Pb.status?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,ab.userName]:[ab.isReadOnly?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,ab.userName]}return[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself]}ljj(ab){return this.mjj(ab)}ANf(ab,Pb,rc){return Pb?this.dli(Pb)?(ab=this.settings.W2(ab))&&2===ab.status?!1:!0:(rc&&m.ULS.sendTraceTag(4482394,325,50,"User has presence data but app can't use it"),!1):(rc&&m.ULS.sendTraceTag(4482393,
325,50,"User does not have any presence data"),!1)}jgj(ab){return ab.isReadOnly?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}mjj(ab){if(!ab.capabilities.qca(1))return this.jgj(ab);const Pb=ab.isReadOnly,rc=this.settings.W2(ab.clientId);ab=this.settings.psa(ab.clientId);if(!rc)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(rc.status){case 1:return ab?Pb?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline:this.Twi(ab)||
CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}f7i(ab){if(this.Lad.Tce)return this.Lad.UXb(ab.email,"O365",A.AFrameworkApplication.hh,0)}ajj(ab){ab=this.settings.W2(ab.clientId);return!ab||ab&&1===ab.status?!0:!1}bjj(ab){var Pb=String.format("buttonPeoplesWellUser-{0}",ab.clientId),rc=ab.clientId,ic=this.ljj(ab);
const md=ab.userName,Fd=ab.color;var ne=Object,ud=ne.assign,gb=new Hb,Vb=this.settings.DAc.toString(),Lc=this.settings.Pjd.cluster,Xc=this.settings.Pjd.eHc,Ib=this.jag(),gc=ab.isAnonymous,Fb;if(Fb=[md],Fb.length){var fb=new Sys.StringBuilder("STRARRY@");for(const Pc of Fb)fb.append(Pc?Pc.length:0),fb.append(","),fb.append(Pc),fb.append(",");Fb=fb.toString().slice(0,-1)}else Fb=null;Pb=ud.call(ne,gb,{Id:Pb,Command:Vb,LabelText:"{0}",Image32by32:Lc,Image32by32Class:Xc,MenuItemId:rc,CommandValueId:rc,
Alt:md,DisplayMode:Ib,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",Description:ic,ImageBackColor:Fd,IsAnonymous:gc,LabelTextUserGeneratedPlaceholderReplacements:Fb,Upn:ab.email});A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&this.Lad&&(rc=this.f7i(ab),ic=this.ajj(ab),Pb.ImageUrl=rc,Pb.ActiveStatus=ic,Pb.JoinTimeInMS=ab.sEa,ab=this.ANf(ab.clientId,this.settings.psa(ab.clientId),!1),Pb.CanJump=ab,""===rc&&m.ULS.sendTraceTag(40969413,
302,50,"ImageURL collection failed"));return Pb}s6i(){return Object.assign(new yb.a,{Id:"BasicChat",Command:"2288458806",LabelText:CommonUIStrings.l_StartGroupChat,LabelCss:"display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word"})}jag(){return this.gGj?"Initials":"Menu32"}cjj(ab){const Pb=[];for(const rc of ab)ab=this.bjj(rc),Array.add(Pb,ab);return Pb}u$d(){return 0<this.X0.Hva}YFk(ab){if(!this.Dxd)return!0;this.ZTc||(ab[pb.a.Visible]=!0);let Pb,rc,ic,md,Fd;({stk:Pb,
ttk:rc,otk:ic,qtk:md,ptk:Fd}=this.o2i());ab[pb.a.LabelText]=Pb;rc&&rc.length&&(ab[pb.a.LabelTextUserGeneratedPlaceholderReplacements]=rc);ab[pb.a.ImageIsVisible]=ic;ab[pb.a.Image16by16Class]=md;ab[pb.a.ImageBackColor]=Fd;this.Dxd=!1;return!0}yyk(ab){if(0>=this.X0.Hva)return!1;var Pb=this.whl(this.X0.qod),rc=this.cjj(Pb);Pb=Object.assign(new tb.a,{Id:"menuCoauthors",MaxWidth:"220px",MenuSectionList:[]});rc=Object.assign(new Mb.a,{Id:"msCoauthors",ControlsId:"msCoauthorsControls",DisplayMode:this.jag(),
ControlList:rc});A.AFrameworkApplication.fa.ka("WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.Lad&&(rc.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,rc.TitleId="menuCoauthorsTitle",rc.Theme="Light");Array.add(Pb.MenuSectionList,rc);A.AFrameworkApplication.fa.ka("DocChatIsEnabled")&&A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled")&&A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.jb.Do&&(rc=[],Array.add(rc,this.s6i()),rc=Object.assign(new Mb.a,{Id:"msGroupChat",ControlsId:"msGroupChatControl",
ControlList:rc}),Array.add(Pb.MenuSectionList,rc));A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.jb.Do?ab.MenuItems=Pb:ab.PopulationXML=Bc.l(Pb);return!0}Zzl(ab){m.ULS.sendTraceTag(4482395,325,50,"PeoplesWell: Received user button click");ab=ab.MenuItemId;if(!ab)return!1;const Pb=this.settings.psa(ab);if(!this.ANf(ab,Pb,!0))return!1;this.gTj(ab,Pb);return!0}XLk(){const ab=this.ZZi();this.X0.I8k(ab);this.ZTc&&1<=this.X0.Hva&&(m.ULS.sendTraceTag(6092429,325,50,"PeoplesWell: User is no longer forever alone."),
this.ZTc=!1);this.Dxd=!0}h0(){this.fvd||(window.setTimeout(()=>{this.eed();this.fvd=!1},3E3),this.fvd=!0)}ZZi(){let ab;ab=this.XZi()||[];for(const Pb of ab)this.mZk(Pb);return ab}mZk(ab){ab.clientId||(ab.clientId=Q.a.create().toString());ab.userName||(ab.userName="Anonymous user");ab.capabilities||(ab.capabilities=new Va.a);ab.color||(ab.color="#cccccc");ab.sEa||(ab.sEa=0)}whl(ab){const Pb=[];Array.addRange(Pb,ab);Pb.sort(Tb.dtk);return Pb}dOk(){A.AFrameworkApplication.fa.ka("CoauthorGalleryTelemetryIsEnabled")&&
!this.mBd&&(A.AFrameworkApplication.Ta.xS(nb.a.QQf)&&vb.a.isSharedUxGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DoNotRegisterCoauthorsRenderedMultiplTimes")||A.AFrameworkApplication.Ta.pa(nb.a.QQf,ac.a.frame,Object(h.a)(this,this.Lkk,"onCoauthorGalleryFirstRender"),96));this.eOk();this.mBd=!0;this.eed()}Lkk(ab,Pb,rc,ic,md){this.CFd.jM(md.RenderTime);return 32}get Vld(){return this.CFd.task}eed(){if(!this.mBd&&(this.CFd.jM((new Date).getTime()),m.ULS.sendTraceTag(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"),
this.eug))return;this.XLk();this.eug&&this.ZTc?A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||sa.a.Y9("ribbon","coauthorGallery"):(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(sa.a.jea("ribbon","coauthorGallery"),sa.a.iea("ribbon","coauthorGallery")),this.YLk())}dispose(){this.cK&&(this.cK.yGe(Object(h.a)(this,
this.h0,"onUsersUpdated")),this.cK=null)}static dtk(ab,Pb){return ab.capabilities.qca(1)&&Pb.capabilities.qca(1)||!ab.capabilities.qca(1)&&!Pb.capabilities.qca(1)?Xb.a.localeCompare(ab.userName,Pb.userName):ab.capabilities.qca(1)?-1:1}}Object(J.a)(Tb,"APeoplesWell",null,[1550,106]);var Ub=d(39);class hc extends Tb{constructor(ab,Pb,rc=null,ic=null){super(ab,rc,ic);this.Uya=()=>!0;this.Ca=Pb}$Fk(ab){return this.YFk(ab)}Ayk(ab){return this.yyk(ab)}aAl(ab){return this.Zzl(ab)}YP(ab,Pb,rc,ic,md,Fd){ab=
!1;switch(rc){case 1:ab=md(ic);break;case 2:ab=Fd(ic)}return hc.Fei(ab)}EGj(ab,Pb,rc,ic,md){return this.YP(ab,Pb,rc,md,()=>this.u$d(),this.Uya)}ZFk(ab,Pb,rc,ic,md){return this.YP(ab,Pb,rc,md,Object(h.a)(this,this.$Fk,"queryUsersProxy"),this.Uya)}zyk(ab,Pb,rc,ic,md){return this.YP(ab,Pb,rc,md,this.Uya,Object(h.a)(this,this.Ayk,"populateFlyoutContentsProxy"))}Cri(ab,Pb,rc,ic,md){return this.YP(ab,Pb,rc,md,this.Uya,this.Uya)}Bri(ab,Pb,rc,ic,md){return this.YP(ab,Pb,rc,md,this.Uya,this.Uya)}$zl(ab,Pb,
rc,ic,md){return this.YP(ab,Pb,rc,md,this.Uya,Object(h.a)(this,this.aAl,"userButtonClickProxy"))}Wwk(ab,Pb,rc,ic,md){return this.YP(ab,Pb,rc,md,this.Uya,()=>{this.eed();return!0})}eOk(){this.Ca.ya(this.settings.xAc,Ub.a.application,Object(h.a)(this,this.EGj,"isControlEnabledHandler"));this.Ca.pa(this.settings.BAc,Ub.a.application,Object(h.a)(this,this.ZFk,"queryUsersHandler"),96);this.Ca.pa(this.settings.zAc,Ub.a.application,Object(h.a)(this,this.Cri,"commandMenuOpenHandler"),96);this.Ca.pa(this.settings.yAc,
Ub.a.application,Object(h.a)(this,this.Bri,"commandMenuCloseHandler"),96);this.Ca.pa(this.settings.AAc,Ub.a.application,Object(h.a)(this,this.zyk,"populateFlyoutContentsHandler"),96);this.Ca.ya(this.settings.DAc,Ub.a.application,Object(h.a)(this,this.$zl,"userButtonClickHandler"));this.Ca.pa(this.settings.eHd,Ub.a.application,Object(h.a)(this,this.Wwk,"peoplesWellRefreshControlHandler"),96)}dispose(){super.dispose()}static Fei(ab){return ab?32:8}}Object(J.a)(hc,"ABox4PeoplesWell",Tb,[]);var Wb=d(718);
class fd extends Sys.EventArgs{constructor(ab){super();this.controlId=ab}}Object(J.a)(fd,"RibbonControlStatusChangedEventArgs",Sys.EventArgs,[]);class fc extends hc{constructor(ab,Pb,rc,ic,md,Fd,ne,ud,gb,Vb,Lc,Xc,Ib,gc,Fb,fb,Pc,dd){super(ab,Pb,fb,dd?D.Task.Gt(dd):null);this.$y=null;this.xle=!1;if(!md)throw Error.argumentNull("coauthStateGetter");if(!Fd)throw Error.argumentNull("appFrame");if(!ne)throw Error.argumentNull("taskManager");this.vj=md;this.Ob=Fd;this.yb=ne;ic&&ic.execute(kd=>{this.$y=kd});
rc&&rc.execute(kd=>{kd.s7h(Object(h.a)(this,this.WBk,"presenceChanged"))});this.uc=ud;this.Je=gb;this.Ee=Vb;this.j$b=Ib;this.Z0j=Lc;this.Zbb=Xc;this.Gyb=gc;this.zT=Fb;this.mqe=Pc;this.GOg=dd;this.Vld.continueWith(()=>{this.zT.cOi(this.Vld.result)})}gTj(ab,Pb){let rc=null;({data:rc}=this.MTe(Pb)).returnValue&&rc&&rc.Tj&&(bb.a.J(512497493,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",ab,rc.Tj,this.vj.yC),(ab=this.uc.Via(rc.Tj))?(this.Je.yhd(),this.Je.U9(ab.we)):
bb.a.J(512497492,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",rc.Tj))}MTe(ab){let Pb;Pb=null;if(!ab)throw bb.a.J(512497491,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",this.vj.yC),Error.argumentNull("presence");return ab?(Pb=Wb.a.DGc(ab.data))?{returnValue:!0,data:Pb}:{returnValue:!1,data:Pb}:{returnValue:!1,data:Pb}}dli(ab){let Pb=null;return({data:Pb}=this.MTe(ab)).returnValue&&Pb&&Pb.Tj?!0:!1}XZi(){if(this.GOg)return this.GOg.WZi();
bb.a.J(512497490,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null.");const ab=this.YZi();0<ab.length&&bb.a.J(512497489,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",ab.length);return ab}YZi(){const ab=[],Pb=this.mqe.zag();this.vj.Mib(this.vj.yC).returnValue||bb.a.J(512497488,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",this.vj.yC);let rc=null;this.$y&&(rc=this.$y.bMc());var ic=A.AFrameworkApplication.fa.ka("PeoplesWellExtraButtonInfoIsEnabled");
for(var md of this.vj.zZ){var Fd=this.Zbb.$Ca(new ua.a(md.EmailAddress,void 0,md.Name),md.ColorIndex,md.ID,1),ne=new Va.a;ne.xYa(0);let ud=0,gb=!1;if(fc.RRj(md.ID,rc)){ne.xYa(1);if(ic){let Vb=rc[md.ID];Vb&&(ud=Vb.capabilities);gb=!0;Vb&&Vb.capabilities&4&&ne.xYa(4)}delete rc[md.ID]}fc.DCc(Pb,md.EmailAddress)||(Array.add(ab,new Za.a(md.ID,md.Name,Fd,ne,null,md.EmailAddress)),bb.a.J(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
md.ID,Fd,ne.qca(1),ne.qca(4),this.vj.yC,!md.EmailAddress,ud,gb))}if(!ic&&this.j$b&&rc)for(let ud in rc)ic=rc[ud],!fc.DCc(Pb,ic.email)&&ic&&ic.userName&&(md=new Va.a,md.xYa(1),ic.capabilities&4&&md.xYa(4),Fd=this.Gyb.J_d(ic.email)||ic.email,ne=this.Zbb.$Ca(new ua.a(Fd,void 0,ic.userName),null,ic.clientId,1),Array.add(ab,new Za.a(ic.clientId,ic.userName,ne,md,null,Fd)),bb.a.J(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
ic.clientId,ne,md.qca(1),md.qca(4),this.$y.clientId,!ic.email,ic.capabilities));return ab}Twi(ab){let Pb=null,rc=" ";({data:Pb}=this.MTe(ab)).returnValue&&Pb&&Pb.Tj&&(ab=this.uc.Via(Pb.Tj))&&(rc=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,ab.we+1));return rc}WBk(){this.Ob.Ft.SDa?this.xle||(this.yb.Cb(new Lb.a(2,1,0,Object(h.a)(this,this.handlePendingRefresh,"handlePendingRefresh"),90,"70")),this.xle=!0):this.Ca.processAction(nb.a.C4a,2)}YLk(){this.Ee.aIk(new fd(this.settings.id,
!0));const ab=1<this.X0.Hva||1===this.X0.Hva&&this.X0.qod[0].clientId!==this.settings.clientId;this.Z0j.execute(Pb=>{ab&&this.zT&&this.zT.zZj();Pb.FKb()});ab&&this.zT.Wh(14,Date.now())}handlePendingRefresh(){this.xle=!1;this.Ca.processAction(nb.a.C4a,2)}dispose(){super.dispose()}static RRj(ab,Pb){return Pb&&ab in Pb?!0:!1}static DCc(ab,Pb){return!!ab&&!!Pb&&ab.toLowerCase()===Pb.toLowerCase()}}Object(J.a)(fc,"PowerPointPeoplesWell",hc,[]);class bc{constructor(ab){this.qbc=null;ab.execute(Pb=>{this.qbc=
Pb})}psa(ab){return this.qbc?this.qbc.psa(ab):null}W2(ab){return this.qbc?this.qbc.W2(ab):null}}Object(J.a)(bc,"PresenceUserInfoGetterProxy",null,[1086]);var cc=d(38);class kb{constructor(){this.f4=this.LI=this.mh=this.K=null}get name(){return"PowerPointWebEditor.PeoplesWell"}Wb(ab){kb.s8b=Date.now();this.K=ab;this.f4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.mh=this.f4.NCa(6,this.name);this.K.register(1086,"PowerPointWebEditor.IPresenceUserInfoGetter").ma().na(()=>new bc(this.K.Ka("PowerPointWebEditor.IDelayedPresenceUserInfoGetter")));
this.K.register(564,"Common.ICoauthoringTelemeryInfoProvider").ma().na(()=>new Ya(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(Db,"PowerpointPresence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").ma().na(()=>new Db(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.Ka("Common.IRealtimeChannelBasic"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser")));
if(cc.a("PeoplesBaseUlrConfiguredForPods")&&(ab=this.K.resolve("Common.App.People.IExternalPeopleAPI"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").tg)){const Pb=this.K.resolve("Common.IAppSettingsManager").Ga("368");ab.x4g(Pb+"p")}bb.a.J(509669911,814,50,"PPTWebEditorPeoplesWellPackage:Configure")}init(){if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("UnifiedScriptLoaderForDSEnabled"))this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Rba("pptedit.presence1",
null,()=>d.e(4).then(d.bind(null,1210)));else{const ab=Ga.a.create("pptedit.presence1",null,()=>d.e(4).then(d.bind(null,1210)));oa.a.Kx(ab)}this.K.resolve("Common.ICoauthoringTelemeryInfoProvider");this.K.resolve("Common.IPeopleInfoProvider");A.AFrameworkApplication.yA.rCa?(this.LI=this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),sa.a.Y9("ribbon","coauthorGallery"),this.LI.rId(Object(h.a)(this,this.Hog,"initializePeoplesWellHandler"))):this.Gog()}Hog(){try{A.AFrameworkApplication.yA.rCa||
(this.Gog(),this.LI.cGe(Object(h.a)(this,this.Hog,"initializePeoplesWellHandler")))}catch(ab){bb.a.J(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",ab)}}Gog(){const ab=this.mh.ju("peoplewell");this.mAj(this.K.resolve("PowerPointWebEditor.IPresenceUserInfoGetter"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.AppFrame"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerpointPresence.RtcParams").clientId);
this.mh.qu(ab)}mAj(ab,Pb,rc,ic,md,Fd){var ne=this.K.resolve("PowerpointPresence.IPresencePerfLogger");ne.Wh(10,kb.s8b);ne.Wh(9,kb.Abc);ne.Wh(11,(new Date).getTime());ne=Date.now();const ud=ta.CuiHelper.abj(A.AFrameworkApplication.gm,A.AFrameworkApplication.gm,A.AFrameworkApplication.gm);ab=Ha.createInstance(ud,Fd,Object(h.a)(ab,ab.psa,"getUserPresence"),Object(h.a)(ab,ab.W2,"getUserStatusInfo"),!0);(Fd=this.K.resolve("PowerpointPresence.PeopleInfoProvider"))||bb.a.J(509669910,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider");
bb.a.J(509669909,814,50,"InitializePeoplesWellInternal; creating peopleswell");const gb=new fc(ab,Pb,this.K.Ka("PowerpointPresence.IPresenceManager"),this.K.Ka("Common.IRealtimeChannelBasic"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),rc,ic,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ka("Box4.IBox4BridgeCommandUi"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),
md.podsDefaultToRtcForPresenceEnabled,this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.resolve("Common.App.People.IPeopleManager"),this.K.resolve("PowerpointPresence.IPresencePrepCacheParser"),Fd);gb.dOk();this.K.register(fc,"PowerpointPresence.PowerPointPeoplesWell").as("Common.IPeoplesWell").ma().na(()=>gb);this.K.resolve("Common.IPeoplesWell");this.K.Ka("Box4.IBox4BridgeCommandUi").execute(Vb=>{Vb.FKb()});bb.a.J(8958615,
814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-ne);this.K.resolve("PowerpointPresence.IPresencePerfLogger").hOi()}dispose(){}static main(){kb.Abc=Date.now();if(A.AFrameworkApplication.fa&&A.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")){const ab=new kb;ab.Wb(la.a.instance);ab.init()}else Ka.a.instance.Bc(new kb)}}kb.Abc=0;kb.s8b=0;Object(J.a)(kb,"PPTWebEditorPeoplesWellPackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerPointWebEditor.PeoplesWell");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("RealtimePresenceUI");window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");Ea.main();Type.registerNamespace("RealtimePresenceUI");kb.main()},718:function(J,V,d){J=d(0);var h=d(61);class e{constructor(r,v,A){this.slideId=r;this.shapes=v;this.sn=A}}Object(J.a)(e,"SerializablePresenceData",null,[]);d.d(V,"a",function(){return m});class m{constructor(r,
v,A=0){if(!m.isValid(r))throw Error.create("Invalid Presence Data");this.YA=r;this.J4c=v;this.KQg=A?A:++m.REi}get Tj(){return this.YA}get lU(){return this.J4c}toString(){return this.YA.toString()+" : "+(this.lU&&this.lU.length?this.lU[0].toString():"")+" : "+this.KQg}S2d(){return new e(this.YA.Opc,this.J4c,this.KQg)}static isValid(r){return!!r}static DGc(r){return new m(new h.a(r.slideId),r.shapes,r.sn)}}m.REi=0;Object(J.a)(m,"PresenceData",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.presence.js.map