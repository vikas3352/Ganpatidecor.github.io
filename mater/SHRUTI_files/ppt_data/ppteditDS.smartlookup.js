'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[12],{1209:function(J,V,d){d.r(V);var h=d(0),e=d(1165);class m{constructor(ib,Cb,yc,gd){this.FLh=ib;this.YVh=Cb;this.XVh=yc;this.ZVh=gd}get Xvi(){return this.FLh}get eXk(){return this.YVh}get bXk(){return this.XVh}get resultType(){return this.ZVh}}Object(h.a)(m,"SearchContext",null,[841]);class r{zCi(ib,Cb,yc){var gd=yc-Cb;let od;if(100<=gd)gd=Cb,od=yc;else{gd=Math.max(0,Cb+Math.ceil(gd/2)-50);od=Math.min(ib.length,
gd+100);gd=Math.max(0,od-100);let Rd;if(gd&&" "!==ib.charAt(gd-1)){Rd=Math.min(Cb,gd+10);for(var Mc=gd;Mc<Rd;++Mc)if(" "===ib.charAt(Mc)){gd=Mc+1;break}}if(od!==ib.length&&" "!==ib.charAt(od))for(Rd=Math.max(yc,od-10),Mc=od-1;Mc>=Rd;--Mc)if(" "===ib.charAt(Mc)){od=Mc;break}}return new m(ib.substring(gd,od),Cb-gd,yc-gd,"")}}Object(h.a)(r,"SearchContextFactory",null,[830]);var v=d(25),A=d(68),w=d(17);class y{constructor(ib){ib.Ka("Common.App.SearchCommon.SearchHostRuntime").execute(()=>{})}}Object(h.a)(y,
"DocumentContentExtractionManager",null,[750]);var u=d(376),D=d(13),F=d(1029);class I{}I.khl="mso_smartLookup";I.channelId="SmartLookup";I.jhl="https://uciserviceintcdnwus.blob.core.windows.net/mirrored/smartlookup/";I.cuh="https://uci.edog.cdn.office.net/mirrored/smartlookup/";I.duh="https://uci.cdn.office.net/mirrored/smartlookup/";I.ihl="https://hedwigtestserver.blob.core.windows.net/builds/";I.hhl="http://localhost:8080/";I.zmc="current";I.buh="next";I.huk=2;I.ead=CommonUIStrings.L_SmartLookupPaneTitle;
I.nY="InsightsTaskPane";I.width=400;I.Rml="appCorrelationId";I.Sml="message";Object(h.a)(I,"InsightsConstants",null,[]);var H=d(918),L=d(168);class E{}Object(h.a)(E,"ActivityContractInfo",null,[]);class aa{}Object(h.a)(aa,"BrowserPaneDataField",null,[]);class Q{}Object(h.a)(Q,"BrowserPaneTelemetryEvent",null,[]);var O=d(135),T=d(55),K=d(179),X=d(180);class P{static uw(ib,Cb){const yc=new Q;yc.eventName="Diagnostics";yc.isActivity=!1;yc.activityContract=Object.assign(new E,{success:!0});const gd=[],
od=new aa;od.name="Message";od.dataType=0;od.value=ib;ib=new aa;ib.name="Level";ib.dataType=0;ib.value=P.q8i(Cb);Array.add(gd,od);Array.add(gd,ib);yc.dataFields=gd;P.sendTelemetryEvent(yc)}static Flh(ib,Cb){const yc=new Q;yc.eventName=ib;yc.isActivity=!1;yc.activityContract=Object.assign(new E,{success:!0});ib=[];const gd=new aa;gd.name="AppCorrelationId";gd.dataType=0;gd.value=Cb;Array.add(ib,gd);yc.dataFields=ib;P.sendTelemetryEvent(yc)}static Z0k(ib,Cb,yc,gd,od,Mc){const Rd=new Q;Rd.eventName=
"LaunchPaneWithError";Rd.isActivity=!1;Rd.activityContract=Object.assign(new E,{success:!0});const ye=[],oe=new aa;oe.name="IsNetworkConnected";oe.dataType=0;oe.value=ib?"true":"false";ib=new aa;ib.name="IsHostruntimeAvailable";ib.dataType=0;ib.value=Cb?"true":"false";Cb=new aa;Cb.name="EntryPoint";Cb.dataType=0;Cb.value=yc;yc=new aa;yc.name="RuntimeVersion";yc.dataType=0;yc.value=gd;gd=new aa;gd.name="IsFirstRelease";gd.dataType=1;gd.value=od?"true":"false";od=new aa;od.name="IsZeroTerm";od.dataType=
1;od.value=Mc?"true":"false";Mc=new aa;Mc.name="IsClientSideRendering";Mc.dataType=1;Mc.value="false";Array.add(ye,oe);Array.add(ye,Cb);Array.add(ye,ib);Array.add(ye,yc);Array.add(ye,gd);Array.add(ye,od);Array.add(ye,Mc);Rd.dataFields=ye;P.sendTelemetryEvent(Rd)}static GJe(ib,Cb,yc){const gd=new Q;gd.eventName="CDNDownloadLatency";gd.isActivity=!0;gd.activityContract=Object.assign(new E,{duration:yc,success:!0});yc=[];const od=new aa;od.name="CDNHostname";od.dataType=0;od.value=ib;ib=new aa;ib.name=
"Filename";ib.dataType=0;ib.value=Cb;Array.add(yc,od);Array.add(yc,ib);gd.dataFields=yc;P.sendTelemetryEvent(gd,1)}static MJe(ib,Cb,yc,gd,od,Mc,Rd,ye){const oe=new Q;oe.eventName="LaunchPane";oe.isActivity=!0;oe.activityContract=Object.assign(new E,{duration:Cb,success:!0});Cb=[];const Bb=new aa;Bb.name="AppCorrelationId";Bb.dataType=0;Bb.value=ib;ib=new aa;ib.name="EntryPoint";ib.dataType=0;ib.value=yc;yc=new aa;yc.name="IsServerSideRendering";yc.dataType=1;yc.value="true";const Ff=new aa;Ff.name=
"UxVersion";Ff.dataType=0;Ff.value=gd;gd=new aa;gd.name="FeatureGates";gd.dataType=0;gd.value=od;od=new aa;od.name="IsFirstRelease";od.dataType=1;od.value=Mc?"true":"false";Mc=new aa;Mc.name="IsZeroTerm";Mc.dataType=1;Mc.value=Rd?"true":"false";Rd=new aa;Rd.name="IsClientSideRendering";Rd.dataType=1;Rd.value=ye?"true":"false";Array.add(Cb,Bb);Array.add(Cb,ib);Array.add(Cb,yc);Array.add(Cb,Ff);Array.add(Cb,gd);Array.add(Cb,od);Array.add(Cb,Mc);Array.add(Cb,Rd);oe.dataFields=Cb;P.sendTelemetryEvent(oe)}static sendTelemetryEvent(ib,
Cb=2){if(ib.isFeedbackActivity)P.mYj(ib.eventName);else{var yc=-1<ib.eventName.indexOf(P.Jxh)?ib.eventName:P.Jxh+ib.eventName,gd=P.m3i(ib.dataFields);ib.isActivity?(ib=Object.assign(new K.a,{name:yc,samplingPolicy:Cb,dataFields:gd,succeeded:ib.activityContract.success,durationMs:ib.activityContract.duration}),O.a.sendActivityEvent(ib)):(ib=Object.assign(new X.a,{name:yc,samplingPolicy:Cb,dataFields:gd}),O.a.sendTelemetryEvent(ib))}}static q8i(ib){switch(ib){case 10:return"Error";case 15:return"Warning";
default:return"Info"}}static m3i(ib){const Cb=[];if(ib&&0<ib.length)for(const yc of ib)(ib=L.a.F7(yc.name,yc.value,P.Swi(yc.dataType)))&&Array.add(Cb,ib);return Cb}static Swi(ib){switch(ib){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}static mYj(ib){const Cb=T.a.instance.qb("Common.ISystemInitiatedFeedback");Cb?Cb.logActivity(ib,null):u.ULS.sendTraceTag(540624772,1303,15,"Failed to resolve ISystemInitiatedFeedback.")}}P.Jxh="Office.Insights.SmartLookup.";Object(h.a)(P,
"TelemetryUtils",null,[]);var ea;(function(ib){ib[ib.other=0]="other";ib[ib.searchBoxSearch=1]="searchBoxSearch";ib[ib.searchBoxDictionary=2]="searchBoxDictionary";ib[ib.searchBoxQuickAnswer=3]="searchBoxQuickAnswer";ib[ib.smartLookupRibbon=4]="smartLookupRibbon";ib[ib.smartLookupContextMenu=5]="smartLookupContextMenu";ib[ib.entity=6]="entity";ib[ib.dictionary=7]="dictionary";ib[ib.web=8]="web";ib[ib.pictures=9]="pictures";ib[ib.files=10]="files";ib[ib.bookmarks=11]="bookmarks";ib[ib.help=12]="help";
ib[ib.chartRecommendation=13]="chartRecommendation";ib[ib.linkSkill=14]="linkSkill";ib[ib.searchBoxFindInDocument=15]="searchBoxFindInDocument";ib[ib.searchBoxEntity=16]="searchBoxEntity";ib[ib.searchSkill=17]="searchSkill";ib[ib.controlF=18]="controlF";ib[ib.ribbonFindButton=19]="ribbonFindButton";ib[ib.reuseSlides=20]="reuseSlides";ib[ib.data=21]="data";ib[ib.contextMenuDictionary=22]="contextMenuDictionary";ib[ib.contextMenuSearchSuggestion=23]="contextMenuSearchSuggestion";ib[ib.contextMenuSynonyms=
24]="contextMenuSynonyms";ib[ib.contextMenuSearchBoxSearch=25]="contextMenuSearchBoxSearch";ib[ib.searchBoxSearchZeroTerm=26]="searchBoxSearchZeroTerm";ib[ib.contextMenuSearchZeroTerm=27]="contextMenuSearchZeroTerm";ib[ib.note=28]="note";ib[ib.smartLookupAutoLaunch=29]="smartLookupAutoLaunch";ib[ib.contextMenuSmartLookupInSubMenu=30]="contextMenuSmartLookupInSubMenu";ib[ib.dataDisambiguate=31]="dataDisambiguate";ib[ib.linkFiles=32]="linkFiles";ib[ib.searchBoxNoteL2=33]="searchBoxNoteL2";ib[ib.contextMenuLaunchL2Document=
34]="contextMenuLaunchL2Document";ib[ib.prefetch=99]="prefetch"})(ea||(ea={}));Object(h.b)("EntryPoint",ea);var ia=d(438),ja=d(437),C=d(195),pa=d(33),Z=d(106);class qa{static gW(ib,Cb,yc,gd,od,Mc){if(1===yc)return C.SessionStatusManager.instance.n3?32:8;if(od.value.icl())return P.uw("Skipping Serplet launch",10),32;Cb=Mc;if(!Cb)return 8;ib=qa.L6a();if(yc=Cb.CommandValueId)try{Cb=pa.a(yc)}catch(Rd){return u.ULS.sendTraceTag(594044173,1313,15,"SmartLookup application interface [{0}] is not in proper format",
yc),8}yc=Cb;Cb.selection||(Cb.neighborhood?yc=Object.assign(new ia.a,{selection:Cb}):(Cb=od.value.c7a(),yc.selection=Object.assign(new ja.a,{neighborhood:Cb.neighborhood,mentionStart:Cb.mentionStart,mentionLength:Cb.mentionLength})));yc.selection.clientDetectedLanguage=null;return qa.Yrb(Mc,null,yc,ib,0,od)}static Yrb(ib,Cb,yc,gd,od,Mc){const Rd={};Rd.controlId=ib?ib.SourceControlId:"shortcut";yc&&(Rd.entryPoint=ea[yc.entryPoint]);u.ULS.sendTraceTag(594044172,1303,50,qa.y6a("Show insights",gd,Rd));
Cb?Mc.value.mel(Cb,gd,od):yc&&Mc.value.nel(yc,gd,od);return 32}static y6a(ib,Cb,yc=null){ib={["appCorrelationId"]:Cb,["message"]:ib};if(yc)for(let gd in yc)ib[gd]=yc[gd];return pa.c(ib)}static L6a(){return Z.a.create().toString()}}Object(h.a)(qa,"InvokingPaneUtils",null,[]);class ya{}Object(h.a)(ya,"LaunchDataInDoc",null,[]);var Ka=d(381),Da=d(119),la=d(72),ma=d(441),Ea=d(78),ta=d(63),Ga=d(70),oa=d(524),sa=d(35);class Ha{constructor(ib,Cb,yc,gd,od,Mc,Rd,ye,oe){this.aNb=this.Ptc=this.Xn=null;this.uy=
ib;this.Ca=Cb||v.AFrameworkApplication.Ta;this.yR=yc;this.Kd=gd;this.qcf=ye;this.yMa=od;this.eb=Mc;this.Rd=Rd;this.Hzj();this.mga=new e.a(()=>new Ka.a(oe.value,Object(D.a)(this,this.LCa,"getMoreInfoEventReceived")))}ub(){this.Ca.ya(sa.a.rCj,Ga.a.frame,Object(D.a)(this,this.kel,"showInsights"));this.Ca.ya(sa.a.sCj,Ga.a.frame,Object(D.a)(this,this.lel,"showInsightsForTellMe"));this.Ca.ya(sa.a.definitions,Ga.a.frame,Object(D.a)(this,this.qdl,"showDefinitions"));this.Ca.ya(sa.a.mGi,Ga.a.frame,Object(D.a)(this,
this.rdl,"showDefinitionsForTellMe"));this.Ca.ya(sa.a.jOe,Ga.a.frame,Object(D.a)(this,this.jOe,"showInsightsForSuggestion"));this.qcf&&(this.Ca.ya(sa.a.xDj,Ga.a.frame,Object(D.a)(this,this.gW,"invokeSmartLookupPane")),this.Ca.ya(sa.a.w9d,Ga.a.frame,Object(D.a)(this,this.w9d,"invokeInDocSerplet")),this.Ca.ya(sa.a.B9d,Ga.a.frame,Object(D.a)(this,this.B9d,"invokeSerpletRibbon")),this.Ca.ya(sa.a.A9d,Ga.a.frame,Object(D.a)(this,this.A9d,"invokeSerpletContextMenu")),this.Ca.ya(sa.a.D9d,Ga.a.frame,Object(D.a)(this,
this.D9d,"invokeSerpletTellMeZeroTerm")),this.Ca.ya(sa.a.C9d,Ga.a.frame,Object(D.a)(this,this.C9d,"invokeSerpletTellMeNotes")),this.Ca.ya(sa.a.v9d,Ga.a.frame,Object(D.a)(this,this.v9d,"invokeImageSerpletContextMenu")),this.Ca.ya(sa.a.E9d,Ga.a.frame,Object(D.a)(this,this.E9d,"invokeSynonymsSerpletContextMenu")),this.Ca.ya(sa.a.t9d,Ga.a.frame,Object(D.a)(this,this.t9d,"invokeDictionarySerpletContextMenu")),this.Ca.ya(sa.a.F9d,Ga.a.frame,Object(D.a)(this,this.F9d,"invokeZeroTermSerpletContextMenu")),
this.Ca.ya(sa.a.s9d,Ga.a.frame,Object(D.a)(this,this.s9d,"invokeDefinitionSearchFromFloatie")),this.Ca.ya(sa.a.SSc,Ga.a.frame,Object(D.a)(this,this.SSc,"invokeSerpletBrowseFiles")),this.Ca.ya(sa.a.x9d,Ga.a.frame,Object(D.a)(this,this.x9d,"invokeInDocSerpletWithLaunchData")),this.Ca.ya(sa.a.XDe,Ga.a.frame,Object(D.a)(this,this.XDe,"queryToggleSerplet")),this.Ca.ya(sa.a.TKe,Ga.a.frame,Object(D.a)(this,this.TKe,"setInDocSearchParameter")),v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletAutolaunch",
!1)&&(this.Ca.ya(sa.a.yDj,Ga.a.frame,Object(D.a)(this,this.ADj,"invokeSmartLookupPaneConversations")),this.Ca.ya(sa.a.r9d,Ga.a.frame,Object(D.a)(this,this.r9d,"invokeAutoLaunchSearchRequest"))),this.fNk().continueWith(()=>{v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.updateCommandUI(!0)}))}jDf(){this.Ca.pa(sa.a.o4b,Ga.a.frame,Object(D.a)(this,this.o4b,"invokeFilesSerplet"),4);this.Ca.pa(sa.a.Tsg,Ga.a.frame,Object(D.a)(this,this.o4b,"invokeFilesSerplet"),4);this.Ca.pa(sa.a.Vsg,Ga.a.frame,
Object(D.a)(this,this.oDj,"invokeLinkFilesSerplet"),4);if(this.eb.ka("IsTellMeUpSellEnterpriseEnabled")&&this.eb.ka("SmartLookupTokenPrefetchIsEnabled")){const ib=Ea.a.RGc(0,Object(D.a)(this,this.o8g,"prefetchToken"),0,177);this.Rd.Cb(ib)}}iId(){la.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.AddEmptyFilesActionWhenUnavailable")&&(this.Ca.ya(sa.a.o4b,Ga.a.frame,Object(D.a)(this,this.u9d,"invokeFilesSerpletUnavailable")),this.Ca.ya(sa.a.Tsg,Ga.a.frame,Object(D.a)(this,
this.u9d,"invokeFilesSerpletUnavailable")),this.Ca.ya(sa.a.Vsg,Ga.a.frame,Object(D.a)(this,this.u9d,"invokeFilesSerpletUnavailable")))}o8g(ib){u.ULS.sendTraceTag(579352786,1303,50,"SmartLookupFiles: Token prefetch initiated, interval={0}, IsRetry={1}",ib.interval,!!ib.data);this.iKb().then(Cb=>{let yc=1;if(Cb)u.ULS.sendTraceTag(579352787,1303,50,"SmartLookupFiles: Token prefetch succeeded"),this.TJe("SmartLookupFiles: Token prefetch succeeded",!0),Cb=6E4*this.eb.Cc("SmartLookupTokenRenewalWaitDurationInMinutes",
30);else{u.ULS.sendTraceTag(579352788,1303,50,"SmartLookupFiles: Token prefetch failed");this.TJe("SmartLookupFiles: Token prefetch failed",!1);yc=parseInt(ib.data||"1");if(yc>this.eb.Cc("SmartLookupTokenRenewalRetryThreshold",5)){u.ULS.sendTraceTag(577345097,1303,10,"SmartLookupFiles: Token prefetch max retry count reached");this.TJe("SmartLookupFiles: Token prefetch max retry count reached",!1);return}Cb=6E4*this.eb.Cc("SmartLookupTokenRetryWaitDurationInMinutes",10);yc++}Cb=new Ea.a(3,1,Cb,Object(D.a)(this,
this.o8g,"prefetchToken"),177);Cb.data=yc.toString();this.Rd.Cb(Cb)})}TJe(ib="",Cb=!1){this.yMa.execute(yc=>{yc&&yc.qYa("PrefetchToken",Cb,0,"SmartLookup",ib)})}iKb(){return this.yMa?new Promise(ib=>{this.yMa.execute(Cb=>{if(Cb){var yc=Date.now();Cb.getToken("SmartLookup",this.eb.Ga("SmartLookupShredderServiceEndpoint")).then(gd=>{ib(!!gd&&0<gd.length);Cb.qYa("TryGetTokenInternal",!!gd&&0<gd.length,Date.now()-yc,"SmartLookup")})}else ib(!1)})}):Promise.resolve(!1)}fNk(){const ib=new F.a;if(this.eb.ka("BrowserSupportsInsightsPaneSSO"))this.jDf(),
ib.Dg(!0);else{if(!this.yMa)return u.ULS.sendTraceTag(587534883,1303,10,"_oAuthManagerFuture not initialized"),ib.Dg(!1),this.iId(),ib.task;this.yMa.execute(Cb=>{Cb?Cb.getToken("SmartLookup",this.eb.Ga("SmartLookupShredderServiceEndpoint")).then(yc=>{u.ULS.sendTraceTag(587534913,1303,15,"Token:{0}",!!yc&&0<yc.length);yc&&0<yc.length?(this.jDf(),ib.Dg(!0)):this.iId()}):(u.ULS.sendTraceTag(587534912,1303,10,"Unable to resolve oAuthManager"),ib.Dg(!1),this.iId())})}return ib.task}kel(ib,Cb,yc,gd,od){if(1===
yc)return v.AFrameworkApplication.Aa&&v.AFrameworkApplication.fa.ka("OneNoteDelayLoadContextActivationManager")&&!v.AFrameworkApplication.eXb?8:this.uy.value.xwg()?32:8;ib=qa.L6a();Cb=this.uy.value.c7a();return this.qcf?(Cb=Object.assign(new ja.a,{neighborhood:Cb.neighborhood,mentionStart:Cb.mentionStart,mentionLength:Cb.mentionLength}),Cb=Object.assign(new ia.a,{selection:Cb,userIntent:null,entryPoint:0,launchData:Object.assign(new ma.a,{landingTab:"All"})}),qa.Yrb(od,null,Cb,ib,0,this.uy)):qa.Yrb(od,
Cb,null,ib,0,this.uy)}qdl(ib,Cb,yc,gd,od){if(1===yc)return this.uy.value.xwg()?32:8;ib=qa.L6a();Cb=this.uy.value.c7a();return qa.Yrb(od,Cb,null,ib,1,this.uy)}lel(ib,Cb,yc,gd,od){return 1===yc?32:this.Y2f(od,0)}rdl(ib,Cb,yc,gd,od){return 1===yc?32:this.Y2f(od,1)}Y2f(ib,Cb){const yc=qa.L6a(),gd=ib.CommandValueId;let od;try{od=pa.a(gd)}catch(Mc){return u.ULS.sendTraceTag(6295941,1303,15,qa.y6a(String.format("Insights parameters [{0}] is not in proper format.",gd),yc)),8}return qa.Yrb(ib,od,null,yc,Cb,
this.uy)}jOe(ib,Cb,yc,gd,od){if(1===yc)return 32;if(!od)return 8;ib=od.query?od.query:"";Cb=qa.L6a();yc=new H.a;yc.neighborhood=ib;yc.mentionStart=0;yc.mentionLength=ib.length;return qa.Yrb(od,yc,null,Cb,0,this.uy)}oDj(ib,Cb,yc,gd){if(1===yc)return C.SessionStatusManager.instance.n3?32:8;const od=v.AFrameworkApplication.fa.ka("InsertFileLinkSerpletIsEnabled"),Mc=this.uy.value.PQa();return this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{selection:Object.assign(new ja.a,{neighborhood:Mc.neighborhood,mentionStart:0,
mentionLength:0}),launchData:Object.assign(new ma.a,{landingTab:"File"}),entryPoint:od?32:10}))}o4b(ib,Cb,yc,gd){if(1===yc)return C.SessionStatusManager.instance.n3?32:8;const od=v.AFrameworkApplication.fa.ka("InvokeReuseSlidesSerpletIsEnabled"),Mc=this.uy.value.PQa();return this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{selection:Object.assign(new ja.a,{neighborhood:Mc.neighborhood,mentionStart:0,mentionLength:0}),launchData:Object.assign(new ma.a,{landingTab:od?"Slide":"File"}),entryPoint:od?20:10}))}u9d(){return 2}w9d(ib,
Cb,yc,gd,od){if(1===yc)return C.SessionStatusManager.instance.gja?8:32;const Mc=this.uy.value.PQa();od=void 0===od||null===od?18:19;return this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{selection:Object.assign(new ja.a,{neighborhood:Mc.neighborhood,mentionStart:Mc.mentionStart,mentionLength:Mc.mentionLength}),launchData:Object.assign(new ma.a,{landingTab:"Indoc"}),entryPoint:od}))}x9d(ib,Cb,yc,gd,od){od=od.CommandValueId;if(!od||od&&this.aNb&&od.query===this.aNb.query&&od.matchCase===this.aNb.matchCase&&
od.matchWholeWordOnly===this.aNb.matchWholeWordOnly)return 32;const Mc=this.uy.value.PQa();return this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{selection:Object.assign(new ja.a,{neighborhood:Mc.neighborhood,mentionStart:Mc.mentionStart,mentionLength:Mc.mentionLength}),launchData:Object.assign(new ma.a,{landingTab:"Indoc",data:Object.assign(new ya,{type:4,query:od.query,matchCase:od.matchCase,matchWholeWord:od.matchWholeWordOnly})}),entryPoint:18}))}XDe(ib,Cb,yc,gd,od){od&&(od[oa.a.On]=this.uy.value.A5b);
return 32}TKe(ib,Cb,yc,gd,od){if(ib=od.CommandValueId)this.aNb=ib;return 32}ADj(ib,Cb,yc){if(1===yc)return C.SessionStatusManager.instance.n3?32:8;ib=this.uy.value.PQa();ib=Object.assign(new ia.a,{selection:Object.assign(new ja.a,{neighborhood:ib.neighborhood,mentionStart:ib.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new ma.a,{landingTab:"All"})});this.uy.value.Rde(ib);return 32}r9d(ib,Cb,yc){if(1===yc)return C.SessionStatusManager.instance.n3?32:8;ib=this.uy.value.PQa();
ib=Object.assign(new ia.a,{selection:Object.assign(new ja.a,{neighborhood:ib.neighborhood,mentionStart:ib.mentionStart,mentionLength:0}),entryPoint:29,launchData:Object.assign(new ma.a,{landingTab:"All",data:v.AFrameworkApplication.vPa})});Cb=qa.L6a();this.uy.value.RJe(ib,Cb);return 32}B9d(ib,Cb,yc,gd){if(1===yc)return C.SessionStatusManager.instance.n3?32:8;const od=this.uy.value.y7i();return this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{selection:Object.assign(new ja.a,{neighborhood:od.neighborhood,
mentionStart:od.mentionStart,mentionLength:od.mentionLength}),entryPoint:4,launchData:Object.assign(new ma.a,{landingTab:"All"})}))}A9d(ib,Cb,yc,gd){return this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{entryPoint:5,launchData:Object.assign(new ma.a,{landingTab:"All"})}))}D9d(ib,Cb,yc,gd){if(1===yc)return C.SessionStatusManager.instance.n3?32:8;const od=this.uy.value.PQa();return this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{selection:Object.assign(new ja.a,{neighborhood:od.neighborhood,mentionStart:od.mentionStart,
mentionLength:0}),launchData:Object.assign(new ma.a,{landingTab:"All"}),entryPoint:26}))}t9d(ib,Cb,yc,gd){return 1===yc?(ib=this.uy.value.c7a())&&0<ib.mentionLength?32:8:this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{entryPoint:22,launchData:Object.assign(new ma.a,{landingTab:"All"})}))}s9d(ib,Cb,yc,gd){return 1===yc?(ib=this.uy.value.c7a())&&0<ib.mentionLength?32:8:this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{entryPoint:7,launchData:Object.assign(new ma.a,{landingTab:"All"})}))}v9d(ib,Cb,yc,gd){return this.gW(ib,
Cb,yc,gd,Object.assign(new ia.a,{launchData:Object.assign(new ma.a,{landingTab:"Image"}),entryPoint:9}))}E9d(ib,Cb,yc,gd){return this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{launchData:Object.assign(new ma.a,{landingTab:"All"}),entryPoint:24}))}C9d(ib,Cb,yc,gd){return this.gW(ib,Cb,yc,gd,Object.assign(new ia.a,{launchData:Object.assign(new ma.a,{landingTab:"Notes"}),entryPoint:33}))}F9d(ib,Cb,yc,gd){if(1===yc)return C.SessionStatusManager.instance.n3?32:8;const od=this.uy.value.PQa();return this.gW(ib,
Cb,yc,gd,Object.assign(new ia.a,{selection:Object.assign(new ja.a,{neighborhood:od.neighborhood,mentionStart:od.mentionStart,mentionLength:0}),launchData:Object.assign(new ma.a,{landingTab:"All"}),entryPoint:27}))}gW(ib,Cb,yc,gd,od){return qa.gW(ib,Cb,yc,gd,this.uy,od)}SSc(ib,Cb,yc){if(1===yc)return 32;this.Xn||this.mga.value.ica("Browse File from Search pane",!0);if(!this.Ptc||""===this.Ptc)return u.ULS.sendTraceTag(558409934,1303,10,"InsightsActor: Failed to get host url to browse files."),8;ta.a.an(this.Ptc,
"_blank",void 0,"BrowseFilesFromSearchPane");return 32}LCa(ib){this.Xn||3!==ib.state||(this.Xn=ib,this.Ptc=this.Xn.VQ)}Hzj(){const ib=this.Kd.Dc(I.nY);ib.parent=Da.AFrame.jj;ib.bba(Object(D.a)(this,this.LJe,"sendIFrameTakeFocusMessage"));this.yR.Tpa(I.nY)}LJe(){document.activeElement.blur();v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.jb.tW||(this.uy.value.HKe(),this.uy.value.X0k())}dispose(){this.uy.value&&this.uy.value.dispose()}}Object(h.a)(Ha,"InsightsActor",null,[106]);var bb=d(1166),
Ya=d(675),ua=d(54),Ma=d(268),Ca=d(45);const Va=ib=>{ib=ib.split("-");return ib[ib.length-1]},Za=()=>{var ib=Bc();if(ib)return Promise.resolve(ib);ib=Hb().replace("SearchWeb","searchweb");ib=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?ib+I.buh+"/":ib+I.zmc+"/";ib+="version.json";if(ua.a.Vw)return Db(ib);try{const Cb=new Sys.Net.WebRequest;Cb.set_httpVerb("GET");Cb.set_url(ib);ib={};ib.method=Cb.get_httpVerb();return"function"!==typeof window.fetch?
(P.uw("InsightsUtils - Failed to download version.json because fetch API is unavailable.",10),Promise.resolve("")):window.fetch(Cb.getResolvedUrl(),ib).then(yc=>yc.json()).catch(()=>{P.uw("InsightsUtils - Failed to prefetch version.json of HttpException.",10);return""}).then(yc=>{yc=pa.b(JSON.stringify(yc));return yc.version?yc.version:""},yc=>{P.uw("InsightsUtils - Failed to deserialize version: "+yc.toString(),10);u.ULS.sendTraceTag(591971029,1303,15,"Insights: Failed to deserialize version: "+
yc.toString());return""}).then(yc=>yc)}catch(Cb){return P.uw("InsightsUtils - Failed to download version.json: "+Cb.toString(),10),u.ULS.sendTraceTag(591984149,1303,50,"Insights: Call to Version JSON failed + "+Cb.toString()),Promise.resolve("")}},Db=ib=>{const Cb=v.AFrameworkApplication.Ge;return new Promise(yc=>{const gd=new Ya.a(ib,1,null,null,!0,2,null);Cb.send(gd).AFb(od=>{od&&od.data?od.data.Sd||(P.uw("InsightsUtils - Request for version.json with ClientRequestManager returned empty ResponseData. StatusCode: "+
od.data.Le,10),yc("")):(P.uw("InsightsUtils - Request for version.json with ClientRequestManager returned no Data.",10),yc(""));try{const Mc=pa.b(od.data.Sd);Mc.version&&yc(Mc.version)}catch(Mc){P.uw("InsightsUtils - Failed to deserialize version: "+Mc.toString(),10),yc("")}},od=>{od&&od.data?P.uw("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. StatusCode: "+od.data.Le,10):P.uw("InsightsUtils - Failed to prefetch version.json with ClientRequestManager. Unknown HTTP Failure.",
10);yc("")})})},Lb=()=>v.AFrameworkApplication.fa.ka("SmartLookupEnableLocalOverride")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableLocalOverride",!1),yb=()=>{const ib=Hb();return Lb()||v.AFrameworkApplication.fa.Ga("SmartLookupPRClientVersion")?ib+Bc()+"/":v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1)?ib+I.buh:ib+I.zmc},Bc=()=>Lb()?"dev":v.AFrameworkApplication.fa.Ga("SmartLookupPRClientVersion")?
v.AFrameworkApplication.fa.Ga("SmartLookupPRClientVersion").split("/")[1]:v.AFrameworkApplication.fa.Ga("SmartLookupClientVersion"),tb=ib=>{var Cb=3===v.AFrameworkApplication.Aa.jb.rm?"wordwac":2===v.AFrameworkApplication.Aa.jb.rm?"pptwac":"excelwac";var yc=Ma.a.oe(v.AFrameworkApplication.lcid);const gd=yc?yc.name:"en-us";yc=Hb();const od=Xb();Cb="main_ssr_wac.html?appName="+Cb+"&culture="+gd;return"LOCAL"===od?yc+Cb:yc+((""!==ib?ib:I.zmc)+"/")+Cb},Mb=ib=>Hb()+(""!==ib?ib:I.zmc)+"/scripts/microsoft.office.smartlookup.host.runtime.js",
Hb=()=>{switch(Xb()){case "LOCAL":return I.hhl;case "PR":const ib=v.AFrameworkApplication.fa.Ga("SmartLookupPRClientVersion").split("/");return I.ihl+ib[0]+"/";case "INT":return I.jhl;case "EDOG":return I.cuh;default:return I.duh}},vb=()=>{if(!v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletCDNLatencyActivityEnabled",!1))return"";switch(Xb()){case "EDOG":return I.cuh;case "PROD":return I.duh;default:return""}},Xb=()=>{if(v.AFrameworkApplication.fa.ka("SmartLookupEnableEdogSourceLocationOverride")||
v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableEdogSourceLocationOverride",!1))return"EDOG";if(v.AFrameworkApplication.fa.ka("SmartLookupEnableProdSourceLocationOverride")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableProdSourceLocationOverride",!1))return"PROD";if(v.AFrameworkApplication.fa.ka("SmartLookupEnableIntSourceLocationOverride")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableIntSourceLocationOverride",
!1))return"INT";if(v.AFrameworkApplication.fa.Ga("SmartLookupPRClientVersion")&&v.AFrameworkApplication.fa.Ga("SmartLookupPRIntentSvc"))return"PR";if(Lb())return"LOCAL";switch(Object(bb.a)(String,v.AFrameworkApplication.$c.AudienceGroup)||""){case "Dogfood":if(v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupSKITeamDogfood",!1)){let ib=v.AFrameworkApplication.fa.Ga("UserPrincipalName");ib=Ca.a.wg(ib);const Cb=v.AFrameworkApplication.fa.Kw("SmartLookupINTEnabledForSKITeam")?
v.AFrameworkApplication.fa.XB("SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(Cb,ib))return"INT"}return"EDOG";case "Microsoft":return"EDOG";default:return"PROD"}},Uc=()=>{let ib;ib=v.AFrameworkApplication.fa.ka("IntentSvcEnableEdogSourceLocationOverride")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableEdogSourceLocationOverride",!1)?"EDOG":v.AFrameworkApplication.fa.ka("IntentSvcEnableProdSourceLocationOverride")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableProdSourceLocationOverride",
!1)?"PROD":v.AFrameworkApplication.fa.ka("IntentSvcEnableIntSourceLocationOverride")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcEnableIntSourceLocationOverride",!1)?"INT":Xb();const Cb=v.AFrameworkApplication.fa.Ga("IntentServiceEndpoint"),yc=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IntentSvcNewEndpointEnabled",!1);if("PROD"===ib&&""!==Cb)return Cb+"searchendpointv2/";switch(ib){case "LOCAL":return"wss://127.0.0.1:9000/officeaugmentation/searchendpointv2/";
case "PR":return v.AFrameworkApplication.fa.Ga("SmartLookupPRIntentSvc")+"searchendpointv2/";case "INT":return(yc?"wss://entity.osi.office-int.net/officeaugmentation/":"wss://augmentation.osi.office-int.net/officeaugmentation/")+"searchendpointv2/";case "EDOG":return(yc?"wss://entity.osi.officeppe.net/officeaugmentation/":"wss://augmentation.osi.officeppe.net/officeaugmentation/")+"searchendpointv2/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpointv2/"}};class hb{sendTelemetryEvent(ib){P.sendTelemetryEvent(ib)}}
Object(h.a)(hb,"OtelTelemetrySink",null,[864]);class Zb{}Object(h.a)(Zb,"ApplicationProperties",null,[]);class Fc{constructor(){this.createdDate=this.author=this.filePath=this.docName=null}}Object(h.a)(Fc,"CurrentDocumentProperties",null,[]);class ob{}Object(h.a)(ob,"EnterpriseUserInfo",null,[]);class ac{}Object(h.a)(ac,"FeatureGates",null,[]);var pb=d(80);class nb{constructor(ib,Cb){this.Xp=this.ah=null;this.WKg=!0;this.Knb=Cb;this.XF=ib;this.XF.execute(yc=>{yc.isFeatureEnabled("mso_sendASmile",
!0).then(gd=>{this.WKg=gd}).catch(gd=>{P.uw("SearchHelper - Failed to check if Feedback feature is enabled: "+gd.toString(),15)})});ib=Uc();Cb=v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",!1);if(v.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")){this.Xp={};const yc=this.qej();if(yc&&0<yc.length)for(let gd=0;gd<yc.length;gd++){const od=yc[gd],Mc=this.gfj(od);
switch(Mc.toLowerCase()){case "true":this.Xp[od]=!0;break;case "false":this.Xp[od]=!1;break;default:this.Xp[od]=Mc}}this.Xp.EnableInDocumentSearch=Cb;this.Xp.EnableInDocumentSearchReplace=!0;this.Xp.EnableInDocumentParamLocalSearch=!0;this.Xp.EnableInDocumentQuerySuggest=Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",!1);this.Xp.EnableInDocumentQuestionGeneration=
Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuestionGeneration")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1);this.Xp.EnableInDocumentGlobalEncoder=Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentGlobalEncoder")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",!1);this.Xp.EnableInDocumentExperiment1=Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment1")||
v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1);this.Xp.EnableInDocumentExperiment2=Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1);this.Xp.EnableInDocumentExperiment3=Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",
!1);this.Xp.EnableZeroTermAutoRefresh=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1);this.Xp.EnableTap3SZeroTerm=v.AFrameworkApplication.fa.ka("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",!1);this.Xp.EnableLocalSearch=!0;this.Xp.EnableInDocumentStickyFilters=!0;this.Xp.IntentServiceEndpoint=ib;this.Xp.EnablePDFShredding=v.AFrameworkApplication.fa.ka("SmartLookupEnableSharepointPDFIsEnabled")||
v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1);this.Xp.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.fa.ka("SmartLookupFilterNonPPTFilesForReuseSlides");this.Xp.UXBundleVersion=Bc();this.Xp.SmartLookupServicePath=yb();this.Xp.EnableAcronymSearch=!0;this.Xp.UseAltAnswerEndpoint1=v.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",
!1);this.Xp.UseAltAnswerEndpoint2=v.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1);this.Xp.UseAltAnswerEndpoint3=v.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint3")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1);this.Xp.UseNextUXVersion=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",
!1);this.Xp.IgnoreNeighborhoodContext=v.AFrameworkApplication.fa.ka("SmartLookupIgnoreNeighborhoodContextIsEnabled");this.Xp.ShowDebugInfo="INT"===Xb();this.Xp.DebugCommands=v.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands","");this.Xp.ChangeGates=v.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames","");this.Xp.QnaInMixSection=!0;this.Xp.EnableNoteSearch=v.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||
v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1);this.Xp.EnableWikiL2=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1);this.Xp.EnableFilteringOutRedundantKPE=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1);this.Xp.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",
!1);this.Xp.RankingModels=v.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels","");this.Xp.EnableClientSideRendering=!0}else this.ah=new ac,this.ah.EnableInDocumentSearch=Cb,this.ah.EnableInDocumentSearchReplace=!0,this.ah.EnableInDocumentParamLocalSearch=!0,this.ah.EnableInDocumentQuerySuggest=Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuerySuggest")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuerySuggest",
!1),this.ah.EnableInDocumentQuestionGeneration=Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentQuestionGeneration")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentQuestionGeneration",!1),this.ah.EnableInDocumentGlobalEncoder=Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentGlobalEncoder")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentGlobalEncoder",
!1),this.ah.EnableInDocumentExperiment1=Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment1")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment1",!1),this.ah.EnableInDocumentExperiment2=Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment2")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment2",!1),this.ah.EnableInDocumentExperiment3=
Cb&&v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentExperiment3")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentExperiment3",!1),this.ah.EnableZeroTermAutoRefresh=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermAutoRefresh",!1),this.ah.EnableTap3SZeroTerm=v.AFrameworkApplication.fa.ka("SmartLookupEnableTap3SZeroTerm")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableTap3SZeroTerm",
!1),this.ah.EnableLocalSearch=!0,this.ah.EnableInDocumentStickyFilters=!0,this.ah.IntentServiceEndpoint=ib,this.ah.EnablePDFShredding=v.AFrameworkApplication.fa.ka("SmartLookupEnableSharepointPDFIsEnabled")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupSharepointPDFEnabled",!1),this.ah.FilterNonPPTFilesForReuseSlides=v.AFrameworkApplication.fa.ka("SmartLookupFilterNonPPTFilesForReuseSlides"),this.ah.UXBundleVersion=Bc(),this.ah.SmartLookupServicePath=
yb(),this.ah.EnableAcronymSearch=!0,this.ah.UseAltAnswerEndpoint1=v.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint1")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint1",!1),this.ah.UseAltAnswerEndpoint2=v.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint2")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint2",!1),this.ah.UseAltAnswerEndpoint3=v.AFrameworkApplication.fa.ka("SmartLookupUseAltAnswerEndpoint3")||
v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupUseAltAnswerEndpoint3",!1),this.ah.UseNextUXVersion=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupCDNNextIsEnabled",!1),this.ah.IgnoreNeighborhoodContext=v.AFrameworkApplication.fa.ka("SmartLookupIgnoreNeighborhoodContextIsEnabled"),this.ah.ShowDebugInfo="INT"===Xb(),this.ah.DebugCommands=v.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.EnableSmartLookupDebugCommands",
""),this.ah.ChangeGates=v.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupChangeGateNames",""),this.ah.QnaInMixSection=!0,this.ah.EnableNoteSearch=v.AFrameworkApplication.fa.ka("SmartLookupNoteSearchIsEnabled")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupNoteSearchIsEnabled",!1),this.ah.EnableWikiL2=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupWikipediaL2Enabled",!1),
this.ah.EnableFilteringOutRedundantKPE=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableFilteringOutRedundantKPE",!1),this.ah.EnableZeroTermEntitySuggestion=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableZeroTermEntitySuggestion",!1),this.ah.RankingModels=v.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.SmartLookupRankingModels",""),this.ah.EnableClientSideRendering=!0,this.ah.SharedSerpletFeatureGate1=
v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate1",!1),this.ah.SharedSerpletFeatureGate2=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate2",!1),this.ah.SharedSerpletFeatureGate3=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate3",!1),this.ah.SharedSerpletFeatureGate4=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate4",
!1),this.ah.SharedSerpletFeatureGate5=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate5",!1),this.ah.SharedSerpletFeatureGate6=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate6",!1),this.ah.SharedSerpletFeatureGate7=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate7",!1),this.ah.SharedSerpletFeatureGate8=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate8",
!1),this.ah.SharedSerpletFeatureGate9=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate9",!1),this.ah.SharedSerpletFeatureGate10=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate10",!1),this.ah.SharedSerpletFeatureGate11=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate11",!1),this.ah.SharedSerpletFeatureGate12=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate12",
!1),this.ah.SharedSerpletFeatureGate13=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate13",!1),this.ah.SharedSerpletFeatureGate14=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate14",!1),this.ah.SharedSerpletFeatureGate15=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate15",!1),this.ah.SharedSerpletFeatureGate16=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate16",
!1),this.ah.SharedSerpletFeatureGate17=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate17",!1),this.ah.SharedSerpletFeatureGate18=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate18",!1),this.ah.SharedSerpletFeatureGate19=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate19",!1),this.ah.SharedSerpletFeatureGate20=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate20",
!1),this.ah.SharedSerpletFeatureGate21=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate21",!1),this.ah.SharedSerpletFeatureGate22=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate22",!1),this.ah.SharedSerpletFeatureGate23=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate23",!1),this.ah.SharedSerpletFeatureGate24=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate24",
!1),this.ah.SharedSerpletFeatureGate25=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate25",!1),this.ah.SharedSerpletFeatureGate26=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate26",!1),this.ah.SharedSerpletFeatureGate27=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate27",!1),this.ah.SharedSerpletFeatureGate28=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate28",
!1),this.ah.SharedSerpletFeatureGate29=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate29",!1),this.ah.SharedSerpletFeatureGate30=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate30",!1),this.ah.SharedSerpletFeatureGate31=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate31",!1),this.ah.SharedSerpletFeatureGate32=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate32",
!1),this.ah.SharedSerpletFeatureGate33=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate33",!1),this.ah.SharedSerpletFeatureGate34=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate34",!1),this.ah.SharedSerpletFeatureGate35=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate35",!1),this.ah.SharedSerpletFeatureGate36=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate36",
!1),this.ah.SharedSerpletFeatureGate37=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate37",!1),this.ah.SharedSerpletFeatureGate38=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate38",!1),this.ah.SharedSerpletFeatureGate39=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate39",!1),this.ah.SharedSerpletFeatureGate40=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletFeatureGate40",
!1);this.XPb=T.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager");this.Ccb=!!v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableOAuthManager",!1);this.n$b=nb.isEnterpriseUser();this.Cre=v.AFrameworkApplication.fa.Ga("SmartLookupShredderServiceEndpoint");this.Mak=pb.a.yD(v.AFrameworkApplication.fa.Ga("AppCatalogUrl")||"");this.xbk=v.AFrameworkApplication.fa.Ga("UserPrincipalName");(this.n$b||this.Ccb)&&this.Mfg()}gfj(ib){return v.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline."+
ib,"")}qej(){const ib=v.AFrameworkApplication.fa.dLc,Cb=v.AFrameworkApplication.fa.XB("SmartLookupFlightKeywordList"),yc=[];if(ib&&Cb&&0<Cb.length)for(let od in ib){var gd={key:od,value:ib[od]};gd=gd&&gd.key?gd.key:"";for(let Mc=0;Mc<Cb.length;Mc++)if(-1<gd.toLowerCase().indexOf(Cb[Mc].toLowerCase())){const Rd=gd.split(".");Rd&&4===Rd.length&&Array.add(yc,Rd[Rd.length-1])}}return yc}t3d(ib,Cb,yc,gd){return new Promise(od=>{this.cQj().then(Mc=>{const Rd=new Zb;Rd.anid="";Rd.applicationName=3===v.AFrameworkApplication.Aa.jb.rm?
"WORD":"POWERPNT";Rd.applicationVersion=v.AFrameworkApplication.buildVersion;Rd.appCorrelationId=ib?ib:qa.L6a();Rd.themePlatform="web";Rd.lcid=v.AFrameworkApplication.lcid;Rd.launchUtcTime=(new Date).toUTCString();v.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")?Rd.featureGates=pa.c(this.Xp):Rd.featureGates=pa.c(this.ah);var ye=Ma.a.oe(v.AFrameworkApplication.lcid);ye=ye?ye.name:null;Rd.market=Va(ye);Rd.uiLanguage=ye;Rd.sessionId=v.AFrameworkApplication.userSessionId;Rd.themeId=yc;Rd.parentalControl=
"yes";Rd.processorOnlyMode=Mc;Rd.isEditingAllowed=Cb.isEditingAllowed();Rd.isFeedbackEnabled=this.WKg;Rd.isClientSideRendering=18===gd||19===gd||15===gd;Rd.disableClipboard=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SerpletRestrictCopyWithIRMEnabled",!1)&&v.AFrameworkApplication.lJ&&!v.AFrameworkApplication.KPa;Rd.accessToken=this.n$b||this.Ccb?this.Mfg():"";Mc=new ob;Mc.CountryCode=Va(ye);Mc.ServiceEndpoint=this.Cre;Mc.IsGoLocal=v.AFrameworkApplication.fa.ka("IsGoLocalEnvironment");
Mc.IsEnabled=this.n$b;Mc.IsEnterpriseEnabled=this.n$b;Mc.TenantRoot=this.Mak;Mc.Upn=this.xbk;ye=Xb();Mc.IsEUDB="PROD"===ye&&""!==v.AFrameworkApplication.fa.Ga("IntentServiceEndpoint");Rd.enterpriseUserInfo=Mc;Mc=new Fc;Mc.filePath=v.AFrameworkApplication.fa.Ga("EditDocInClientUrl");Mc.docName=v.AFrameworkApplication.fa.Ga("FileName");Mc.author=99!==gd?Cb.author():null;Mc.createdDate=99!==gd?Cb.createdDate():null;Rd.currentDocument=Mc;od(Rd)})})}cQj(){return new Promise(ib=>{this.XF?this.XF.execute(Cb=>
{Cb.isFeatureEnabled(I.khl,!0).then(yc=>{ib(!yc)}).catch(yc=>{P.uw("SearchHelper - Failed to load the SmartLookup state from application feature helper: "+yc.toString(),10);ib(!0)})}):ib(!0)})}Xwk(ib){this.XPb&&(this.n$b||this.Ccb)&&this.rhg(this.Cre).then(Cb=>{ib(Cb)})}Mfg(){if("Dev Box"===v.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return window.SearchPaneShredderTokenOverride;const ib=
this.Ccb?"Search":"SmartLookup";return this.XPb?this.XPb.kij(ib,this.Cre,this.Ccb):""}rhg(ib){if("Dev Box"===v.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse")&&void 0!==window.SearchPaneShredderTokenOverride&&null!==window.SearchPaneShredderTokenOverride)return new Promise(yc=>{yc(window.SearchPaneShredderTokenOverride)});const Cb=this.Ccb?"Search":"SmartLookup";return this.XPb?this.XPb.getToken(Cb,ib,this.Ccb):Promise.resolve("")}J1b(){return this.Knb?this.Knb.getVersion():""}q5i(){return v.AFrameworkApplication.fa.ka("SmartLookupFeatureGateV2")?
pa.c(this.Xp):pa.c(this.ah)}static isEnterpriseUser(){const ib=v.AFrameworkApplication.fa.Ga("SovereignEnvironmentName"),Cb=v.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");return(!ib||!ib.length)&&Cb}}Object(h.a)(nb,"SearchHelper",null,[751]);class Tb{constructor(){Tb.Ja=""}getVersion(){return Tb.Ja}K8k(ib){Tb.Ja=ib}}Tb.Ja=null;Object(h.a)(Tb,"SmartLookupVersion",null,[]);var Ub=d(269),hc=d(93);class Wb{}Object(h.a)(Wb,"ConfigurationProvider",null,[]);class fd{constructor(ib){fd.Ja=
ib}Hbg(){return fd.Ja}}fd.Ja=null;Object(h.a)(fd,"SearchHostRuntime",null,[]);var fc=d(132),bc=d(232),cc=d(280),kb=d(287);class ab{constructor(){this.w1=this.Cjb=this.Da=null}get name(){return"Common.App.Insights"}Wb(ib){this.Da=ib;const Cb=kb.a.Ju(T.a.instance.Ka("Common.IEventEmitter<Common.IGetMoreInfoResult>")),yc=v.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||v.AFrameworkApplication.fa.ka("SmartLookupIsEnabled");ib.register(Ha,"Common.App.Insights.InsightsActor").ma().na(()=>new Ha(ib.le("Common.App.Insights.IInsightsManager"),
v.AFrameworkApplication.Ta,Ub.a.instance,hc.FocusManager.instance(),ib.Ka("Common.App.SearchCommon.ISearchOAuthManager"),v.AFrameworkApplication.fa,fc.a.instance,yc,new e.a(()=>Cb.result)));ib.register(750,"Common.App.Insights.IDocumentContentExtractionManager").ma().na(()=>new y(ib));yc&&(ib.register(Tb,"Common.App.Insights.SmartLookupVersion").ma().na(()=>new Tb),ib.register(751,"Common.App.SearchCommon.ISearchHelper").ma().na(()=>new nb(T.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
ib.qb("Common.App.Insights.SmartLookupVersion"))))}init(){v.AFrameworkApplication.DDa&&(this.Cjb=this.Da.qb("Common.App.Insights.InsightsActor"),this.Cjb.ub())}SKi(){this.CCj()}CCj(){Za().then(ib=>{if(""!==ib){const Cb=this.Da.qb("Common.App.Insights.SmartLookupVersion");Cb&&Cb.K8k(ib)}this.SIc();this.Cjb=this.Da.resolve("Common.App.Insights.InsightsActor");ib=Mb(ib);ib=cc.a.create(ib);ib.ZR((Cb,yc)=>{yc.succeeded?this.v9k()&&this.prefetchZeroTerm():P.uw("InsightsPackage - Failed to load SmartLookupHostRuntime script. ResourceURL: "+
yc.ft,10);this.Cjb.ub()});bc.a.Kx(ib)})}v9k(){const ib=Object.assign(new Wb,{channelId:I.channelId,approvedOriginPattern:Lb()?"^(http)?://(localhost:8080)$":v.AFrameworkApplication.fa.Ga("SmartLookupApprovedOriginPattern")});var Cb=this.Da.resolve("Common.App.SearchCommon.IDocumentContentExecutor");const yc=this.Da.resolve("Common.App.SearchCommon.ISerpletExecutor"),gd=this.Da.resolve("Common.App.SearchCommon.IInsertContentExecutor"),od=new w.a;Cb&&od.add(Cb);yc&&od.add(yc);gd&&od.add(gd);Cb=Uc();
try{const Mc=new hb,Rd=SmartLookupHostRuntime.setup(ib,od.toArray(),!0,Cb,Mc);this.Da.register(fd,"Common.App.SearchCommon.SearchHostRuntime").ma().na(()=>new fd(Rd));return!0}catch(Mc){return P.uw("InsightsPackage - Failed to setup SmartLookupHostRuntime during package initialization. Error: "+Mc,10),!1}}prefetchZeroTerm(){if(v.AFrameworkApplication.fa.ka("SmartLookupEnableInDocumentSearch")||v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SmartLookupEnableInDocumentSearch",
!1)){var ib=T.a.instance.qb("Common.App.SearchCommon.SearchHostRuntime");if(ib){const Cb=this.Da.resolve("Common.App.SearchCommon.ISearchHelper"),yc=this.Da.resolve("Common.App.SearchCommon.IDocumentHelper");Cb.t3d(null,yc,0,99).then(gd=>{ib.Hbg().prefetchZeroTerm(gd,v.AFrameworkApplication.userSessionId,yb(),!0,"Indoc",null)})}else P.uw("InsightsPackage - Failed to prefetch zero term because we failed to resolve the HostRuntime.",15)}}SIc(){var ib=this.Da.resolve("Common.App.SearchCommon.ISearchHelper");
const Cb=tb(ib.J1b());ib=ib.J1b();ib=Hb()+(""!==ib?ib:I.zmc)+"/scripts/microsoft.office.smartlookup.ssr.js";const yc=vb();ua.a.Vw?this.RKi(Cb,ib):(this.PKi(Cb,yc),this.QKi(ib,yc))}PKi(ib,Cb){const yc=new Sys.Net.WebRequest;yc.set_httpVerb("GET");const gd={};gd.method=yc.get_httpVerb();yc.set_url(ib);const od=(new Date).getTime();try{window.fetch(yc.getResolvedUrl(),gd).then(()=>{""!==Cb&&P.GJe(Cb,ib,(new Date).getTime()-od);this.Da.qb("Common.App.Insights.SmartLookupVersion")})}catch(Mc){P.uw("InsightsPackage - Failed to prefetch Html file because of HttpException. Error: "+
Mc.toString(),10)}}QKi(ib,Cb){var yc=new Sys.Net.WebRequest;yc.set_httpVerb("GET");const gd={};gd.method=yc.get_httpVerb();yc.set_url(ib);let od=-1;if(v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletPrefetchJSOnIdle",!1))yc=v.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletPrefetchDelayInMs",3E5),fc.a.instance.Cb(new Ea.a(5,1,yc,()=>{const Mc=cc.a.create(ib);Mc.OEf(()=>{od=Date.now()});Mc.ZR((Rd,ye)=>{ye.succeeded?""!==
Cb&&P.GJe(Cb,ib,Date.now()-od):P.uw("InsightsPackage - Failed to prefetch JS file.",10)});bc.a.Kx(Mc)}));else{od=Date.now();try{window.fetch(yc.getResolvedUrl(),gd).then(()=>{""!==Cb&&P.GJe(Cb,ib,Date.now()-od)})}catch(Mc){P.uw("InsightsPackage - Failed to prefetch JS file because of HttpException. Error: "+Mc.toString(),10)}}}RKi(ib,Cb){if(ua.a.Vw){var yc=v.AFrameworkApplication.Ge;ib=new Ya.a(ib,1,null,null,!0,2,null);yc.send(ib).AFb(gd=>{gd&&gd.data?gd.data.Sd?this.Da.qb("Common.App.Insights.SmartLookupVersion"):
P.uw("InsightsPackage - Request for Html with ClientRequestManager returned empty ResponseData. StatusCode: "+gd.data.Le,10):P.uw("InsightsPackage - Request for Html with ClientRequestManager returned no Data.",10)},gd=>{gd&&gd.data?P.uw("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. StatusCode: "+gd.data.Le,10):P.uw("InsightsPackage - Failed to prefetch Html file with ClientRequestManager. Unknown HTTP Failure.",10)});v.AFrameworkApplication.fa.ka("SmartLookupPrefetchJSIsEnabled")&&
(Cb=new Ya.a(Cb,1,null,null,!0,2,null),yc.send(Cb).AFb(gd=>{gd&&gd.data?gd.data.Sd||P.uw("InsightsPackage - Request for SSR JS with ClientRequestManager returned empty ResponseData. StatusCode: "+gd.data.Le,10):P.uw("InsightsPackage - Request for SSR JS with ClientRequestManager returned no Data.",10)},gd=>{gd&&gd.data?P.uw("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. StatusCode: "+gd.data.Le,10):P.uw("InsightsPackage - Failed to prefetch JS SSR file with ClientRequestManager. Unknown HTTP Failure.",
10)}))}}dispose(){this.Cjb&&this.Cjb.dispose()}}Object(h.a)(ab,"InsightsPackage",null,[2,3]);var Pb=d(27),rc=d(99),ic=d(661),md=d(1064),Fd=d(530),ne=d(59),ud=d(32);class gb{constructor(ib,Cb,yc){this.streamUrl=ib;this.objectType=Cb;this.formatType=yc}}Object(h.a)(gb,"InsertContentFromStreamData",null,[]);var Vb=d(528),Lc=d(28);class Xc{constructor(ib,Cb,yc){this.ia=ib;this.ra=Cb;this.ua=yc}insertOnlinePicture(ib){const Cb=Object(bb.a)(119,this.ua.Ba);ib&&Cb&&(ib=Object.assign(new Fd.a,{Action:"Insert",
Caption:ib.caption,OriginalUrl:ib.sourceUrl,Height:ib.height,Width:ib.width,LicenseDisplayName:ib.licenseDisplayName,LicenseUrl:ib.licenseUrl,ThumbnailUrl:ib.thumbnailUrl,PageUrl:ib.pageUrl}),this.ia.La(Lc.a.B8a,2,ib))}insertHtmlText(ib){if(ib)if(1===this.ra.Yd().length){const Cb=new md.DictionaryPropertySet;Cb.setValue(ne.a.bU,ib.htmlText);Cb.setValue(ne.a.Had,!1);8===this.ia.La(ud.a.xad,2,Cb)&&this.ipg(ib)}else this.ipg(ib)}ipg(ib){ib=Object.assign(new Vb.a,{Wlc:!1,oY:ib.htmlText});this.ia.La(Lc.a.LHa,
2,ib)}insertContentFromStreamUrl(ib){ib&&(ib=new gb(ib.streamUrl,ib.objectType,ib.formatType),this.ia.La(Lc.a.kSc,2,ib))}getId(){return"InsertContentExecutor"}}Object(h.a)(Xc,"InsertContentExecutor",null,[729,749]);class Ib{constructor(){this.results=null;this.totalResultCount=0;this.hasTooManyResults=!1}}Object(h.a)(Ib,"DocumentContentSearchResults",null,[]);class gc{getAllParagraphsInDocument(){return null}selectRange(){}selectRangeV2(ib,Cb,yc,gd,od){this.selectRange(Cb,yc,gd,od)}selectRangeV3(){}search(){}searchV2(ib,
Cb){this.search(ib,yc=>{Cb(Object.assign(new Ib,{results:yc,totalResultCount:yc.length,hasTooManyResults:100<yc.length}))})}searchWithParam(ib,Cb){this.search(ib.query,Cb)}searchWithParamV2(ib,Cb){this.searchWithParam(ib,yc=>{Cb(Object.assign(new Ib,{results:yc,totalResultCount:yc.length,hasTooManyResults:yc.length>ib.totalResultLimit}))})}highlight(){}highlightWithParam(ib){this.highlight(ib.query)}getRevision(){return null}getDocumentSelection(){return null}clearDocumentSelection(){}selectNextPrevHighlight(){return-1}getSelectedText(){return null}submitDocumentContentExtractionSignal(){}generateDocumentSummary(){return Promise.resolve(null)}generateDocumentSummaryDetails(){return Promise.resolve(null)}highlightDocumentKeySentences(){return Promise.resolve(null)}getDocumentKeySentences(){return Promise.resolve(null)}clearDocumentKeySentencesHighlights(){}extractDocumentObjects(){}getAuthorImageUrlFromClient(){return Promise.resolve(null)}getId(){return"DocumentContentExecutor"}}
Object(h.a)(gc,"BaseDocumentContentExecutor",null,[727,749]);class Fb{constructor(){this.subdocumentId=this.snippet=null;this.endOffsetInParagraph=this.startOffsetInParagraph=this.paragraphIndex=this.endOffsetInSnippet=this.startOffsetInSnippet=this.subdocumentType=0;this.authorName=this.authorEmail=null}}Object(h.a)(Fb,"DocumentContentSearchResult",null,[]);var fb=d(75),Pc=d(31),dd=d(49);class kd extends gc{constructor(ib,Cb,yc,gd,od,Mc,Rd){super();this.d8j=ib;this.pC=Cb;this.v4c=yc;this.lc=gd;this.Zb=
od;this.ua=Mc;this.f$j=Rd}getAllParagraphsInDocument(){const ib=this.a2d(),Cb=new w.a;for(let yc of ib)Cb.add(kd.Y1d(yc));return Cb.toArray()}selectRange(ib,Cb,yc,gd){if(!(0>ib||0>Cb||0>yc||0>gd||ib>yc||ib===yc&&Cb>gd)){var od=this.a2d();od.count<=yc||(ib=od.ga(ib),yc=od.ga(yc),kd.AAg(ib,Cb)&&kd.AAg(yc,gd)&&(od=this.lc.ig(ib),this.ua.Ba!==od&&this.Zb.lmh(od),Cb=this.v4c.Mg(ib,Cb),gd=this.v4c.bN(Cb,dd.a.ak(yc,gd+1)),this.pC.YLe(this.Zb.nK,gd)))}}search(ib,Cb){const yc=new w.a,gd=ib.toLowerCase();var od=
this.a2d();let Mc=0;for(let ye of od){od=kd.Y1d(ye);const oe=od.toLowerCase();let Bb=0;for(;-1<(Bb=oe.indexOf(gd,Bb));){var Rd=this.f$j.zCi(od,Bb,Bb+ib.length);Rd=Object.assign(new Fb,{snippet:Rd.Xvi,startOffsetInSnippet:Rd.eXk,endOffsetInSnippet:Rd.bXk-1,paragraphIndex:Mc,startOffsetInParagraph:Bb,endOffsetInParagraph:Bb+ib.length-1});yc.add(Rd);Bb+=ib.length}Mc++}yc.Sc((ye,oe)=>ye.paragraphIndex===oe.paragraphIndex?ye.startOffsetInParagraph-oe.startOffsetInParagraph:ye.paragraphIndex-oe.paragraphIndex);
Cb(yc.toArray())}a2d(){var ib=Pc.ParagraphReader.xOc(this.d8j.value,!0,!1);const Cb=new w.a;for(let yc of ib)ib=this.lc.ig(yc),ib.qN||ib.Qwb||Cb.add(yc);return Cb}static Y1d(ib){ib=Pc.ParagraphReader.text(ib);return fb.AParagraphNode.Fed(ib," ")}static AAg(ib,Cb){ib=kd.Y1d(ib);return Cb<ib.length}}Object(h.a)(kd,"PPTDocumentContentExecutor",gc,[]);var Td=d(188);class ce{}Object(h.a)(ce,"CommandMetadataResponse",null,[]);class ld{constructor(){this.e7d=this.getAllIcons()}executeCommand(){}openFeedbackPane(){}openSerpletTaskPane(){}sendAutoLaunchSearchRequest(){}openFindReplaceTaskPane(){}openFindReplaceTaskPaneV2(){}openFindTaskPane(){}openNavigationPane(){}closeNavigationPane(){}openPrivacySettings(){Td.PrivacyDialogManager.rjd()}browseFiles(){}getId(){return"SerpletExecutor"}getCommandMetadata(ib){const Cb=
new ce;ib.iconNames&&(Cb.svgData=this.getCommandIconSvg(ib.iconNames));if(!ib.commandId||""===ib.commandId)return Cb.isVisible=!1,Cb;try{Cb.isVisible=Array.contains(appChrome.selectors.getVisibleControlIds(),ib.commandId);Cb.isDisabled=appChrome.selectors.isControlDisabled(ib.commandId);Cb.label=appChrome.selectors.getControlLabel(ib.commandId);if(Cb.svgData&&""!==Cb.svgData)return Cb;const yc=appChrome.selectors.getControlIconSet(ib.commandId),gd=Array(2);gd[0]=yc["default"];gd[1]=yc.icon32;Cb.svgData=
this.getCommandIconSvg(gd)}catch(yc){return null}return Cb}getCommandIconSvg(ib){if(!this.e7d)return"";for(let Cb=0;Cb<ib.length;Cb++){const yc=ib[Cb];if(yc in this.e7d)return this.e7d[yc]}return""}getAllIcons(){return{}}createFeedbackPropertiesFromData(ib){const Cb={SourceControlId:"GiveFeedback"};Cb.feedbackType="true"===ib.IsPosFeedback?0:1;const yc={};yc.featureArea=ld.gSi;Cb.telemetryGroup=yc;Cb.appData=ib;return Cb}}ld.kuj="FA000000012";ld.qFk="AssetID=";ld.gSi="SearchPane";Object(h.a)(ld,"BaseSerpletExecutor",
null,[728,749]);class ad extends ld{constructor(ib){super();this.ia=ib}openFeedbackPane(ib){this.ia.La(sa.a.Dgd,2,this.createFeedbackPropertiesFromData(ib))}openHelpTaskPane(ib){const Cb={};Cb.query=ld.qFk+ib;ib={};ib.assetId=ld.kuj;ib.nonPersistedSettings=Cb;this.ia.La(Lc.a.nJa,2,ib)}browseFiles(){this.ia.La(sa.a.SSc,2,null)}executeCommand(ib){if(ib)switch(ib.CommandId){case 3:appChrome.api.executeCommand(ib.Data.CommandId,ib.Data.Payload)}}}Object(h.a)(ad,"PPTSerpletExecutor",ld,[]);class Yf{isEditingAllowed(){return!0}author(){return null}createdDate(){return null}}
Object(h.a)(Yf,"BaseDocumentHelper",null,[730]);class Xd extends Yf{constructor(){super()}isEditingAllowed(){return Pb.App.Hb.Hd.isEditingAllowed}}Object(h.a)(Xd,"PptDocumentHelper",Yf,[]);class fg{constructor(){this.IH=null}PQa(){return this.c7a()}y7i(){return this.c7a()}mel(ib,Cb,yc){this.IH||(this.IH=this.JGc());this.IH.Tl(ib,Cb,yc)}nel(ib,Cb,yc){this.IH||(this.IH=this.JGc());this.IH.Kel(ib,Cb,yc)}RJe(ib,Cb){this.IH||(this.IH=this.JGc());this.IH.RJe(ib,Cb)}Rde(ib){this.IH||(this.IH=this.JGc());
this.IH.Rde(ib)}X0k(){this.IH&&this.IH.LJe()}HKe(){this.IH&&this.IH.k4k()}icl(){var ib=v.AFrameworkApplication.fa.Cc("SmartLookupLaunchThrottleThresholdInMilliseconds",1500);ib=window.performance.now()-fg.IBg<=ib;ib||(fg.IBg=window.performance.now());return ib}dispose(){this.IH&&(this.IH.dispose(),this.IH=null)}get A5b(){return this.IH?this.IH.isVisible:!1}}fg.IBg=0;Object(h.a)(fg,"InsightsManager",null,[455,106]);class ue{constructor(ib,Cb,yc,gd,od,Mc=!0,Rd=null,ye=null){this.goa=this.TE=this.RLa=
null;this.$uc=!1;this.w1=null;this.Kd=Cb;this.sxd=Mc;this.G2e=ye?ye:new Yf;this.XF=Rd;this.yR=ib;this.sxd&&(T.a.instance.qb("Common.App.SearchCommon.SearchHostRuntime")&&(this.w1=T.a.instance.resolve("Common.App.SearchCommon.SearchHostRuntime").Hbg()),this.cNa=T.a.instance.resolve("Common.App.SearchCommon.ISearchHelper"),this.Knb=this.cNa.J1b())}r9c(ib){if(this.sxd){ib=ib.rawEvent;try{var Cb=pa.a(ib.data)}catch(yc){u.ULS.sendTraceTag(595161728,1303,15,this.y6a("Message data from Serplet [{0}] failed to deserialize.",
ib.data));return}switch(Cb.actionType){case 101:ib=0;this.TE&&(ib=this.TE.entryPoint);this.cNa.t3d(this.goa,this.G2e,this.$1b(),ib).then(yc=>{Cb.data=yc;this.pbd(Cb)});break;case 118:Cb.data=this.TE?this.TE:Object.assign(new ia.a,{selection:Object.assign(new ja.a,{neighborhood:this.RLa.neighborhood,mentionStart:this.RLa.mentionStart,mentionLength:this.RLa.mentionLength})});this.pbd(Cb);break;case 103:ib=pa.a(Object(bb.a)(String,Cb.data));P.sendTelemetryEvent(ib);break;case 206:this.cNa.rhg(Cb.data).then(yc=>
{Cb.data=yc;this.pbd(Cb)});break;case 112:Cb.data.shiftPressed?(ua.a.eg&&document.activeElement.blur(),this.yR.c5d(0,null,2,null,null),u.ULS.sendTraceTag(592545156,1303,50,this.y6a("Serplet UX lost focus through Ctrl + Shift + F6"))):(this.yR.R7a(0,null,2,null,null),u.ULS.sendTraceTag(592545155,1303,50,this.y6a("Serplet UX lost focus through Ctrl + F6")));break;case 40:this.Ns()}}}Cgd(ib){if(this.w1){var Cb=0;this.TE&&(Cb=this.TE.entryPoint);this.cNa.t3d(this.goa,this.G2e,this.$1b(),Cb).then(yc=>
{P.Flh("SearchFromHost",this.goa);this.TE.launchData||(this.TE.launchData=new ma.a);const gd=yb();try{this.w1.search(this.TE,yc,v.AFrameworkApplication.userSessionId,gd,ib),this.cNa.Xwk(od=>{P.Flh("SearchFromHostWithToken",this.goa);this.w1.searchAuthenticatedProviders(this.TE,yc,v.AFrameworkApplication.userSessionId,gd,null,od)})}catch(od){P.uw("BaseSmartLookupPane - Fail to search from host. Error: "+od,10)}}).catch(yc=>{P.uw("BaseSmartLookupPane - Failed to resolve application properties and invoke Search: "+
yc.toString(),10)})}}MJe(ib){if(this.sxd){var Cb=P,yc=Cb.MJe,gd=this.goa;ib=Math.round(window.performance.now()-ib);var od=this.TE?ea[this.TE.entryPoint]:"",Mc=this.cNa.J1b(),Rd=this.cNa.q5i(),ye=this.TE?this.TE.entryPoint:0;yc.call(Cb,gd,ib,od,Mc,Rd,v.AFrameworkApplication.yJd,this.$uc,18===ye||19===ye||15===ye)}}}Object(h.a)(ue,"BaseSmartLookupPane",null,[817,106]);class Sa{constructor(){this.type="SmartLookupTaskPaneProps"}}Object(h.a)(Sa,"SmartLookupTaskPaneProps",null,[]);var rb=d(637);class pc{}
Object(h.a)(pc,"ActionDescriptor",null,[]);var cd=d(95);class zd extends ue{constructor(ib,Cb,yc,gd=null,od=null,Mc=null,Rd=!0,ye=null,oe=null){super(Cb,yc,gd,od,Mc,Rd,ye,oe);this.hFd=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.jb&&v.AFrameworkApplication.Aa.jb.Jce;this.Ilb=this.mCd=!1;this.ySh=v.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxViewportWidthThreshold",1680);this.xSh=v.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMaxPaneWidth",
844);this.CSh=v.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumViewportWidthThreshold",1366);this.BSh=v.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.SerpletMediumPaneWidth",700);Rd||P.uw("ReactSmartLookupPane - React SmartLookup pane constructed for legacy SmartLookup.",10);this.$oa=ib;this.r7e=tb(this.Knb)}get isVisible(){return this.Ilb}RJe(ib,Cb){this.TE=ib;this.RLa=ib=Object.assign(new H.a,{neighborhood:ib.selection.neighborhood,
mentionStart:ib.selection.mentionStart,mentionLength:ib.selection.mentionLength});this.$uc=!ib.mentionLength;this.goa=Cb;this.Cgd(!1)}Rde(ib){this.TE=ib;this.rxa(Object.assign(new H.a,{neighborhood:ib.selection.neighborhood,mentionStart:ib.selection.mentionStart,mentionLength:ib.selection.mentionLength}),!1)}Tl(ib,Cb){this.goa=Cb;this.rxa(ib,!0)}Kel(ib,Cb,yc){this.TE=ib;this.Tl(Object.assign(new H.a,{neighborhood:ib.selection.neighborhood,mentionStart:ib.selection.mentionStart,mentionLength:ib.selection.mentionLength}),
Cb,yc)}Ns(){this.zhd();this.$oa.hideTaskPane()}rxa(ib,Cb){C.SessionStatusManager.instance.n3&&this.w1?(this.RLa=ib,this.$uc=!ib.mentionLength,ib=window.performance.now(),this.initialize(),this.isVisible?v.AFrameworkApplication.fa.ka("SmartLookupDisableRefreshPaneIsEnabled")?(this.$oa.updateTaskPane(null),Cb&&this.s1k()):(Cb&&this.Cgd(!1),this.mCd=!this.mCd,this.$oa.updateTaskPane(this.Aba())):(Cb&&this.Cgd(this.isVisible),this.$oa.showTaskPane(this.Aba())),this.MJe(ib)):(this.$oa.showTaskPane(this.Aba()),
P.Z0k(C.SessionStatusManager.instance.n3,!!this.w1,this.TE?ea[this.TE.entryPoint]:"",this.cNa.J1b(),v.AFrameworkApplication.yJd,this.$uc))}s1k(){if(!this.TE){const ib=Object.assign(new ja.a,{neighborhood:this.RLa.neighborhood,mentionStart:this.RLa.mentionStart,mentionLength:this.RLa.mentionLength});this.TE=Object.assign(new ia.a,{selection:ib,userIntent:null,entryPoint:0,launchData:null})}this.Cgd(this.isVisible)}f1k(){const ib=new pc;ib.transactionId=this.goa;ib.actionType=15;ib.channelId=I.channelId;
this.pbd(ib)}r9c(ib){const Cb=ib.rawEvent;document.getElementById(I.nY)&&Cb.source!==document.getElementById(I.nY).contentWindow||this.AJk(ib)}AJk(ib){const Cb=ib.rawEvent;let yc;try{yc=pa.b(Cb.data)}catch(gd){u.ULS.sendTraceTag(545604257,1303,15,this.y6a("Message data from Serplet [{0}] failed to deserialize.",Cb.data));return}switch(yc.actionType){case 32:v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&(cd.a.LPc()>=this.ySh?this.$oa.updateTaskPane(this.ORd(this.xSh)):
cd.a.LPc()>=this.CSh&&this.$oa.updateTaskPane(this.ORd(this.BSh)));break;case 33:v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableSerpletL2Resizing",!1)&&this.$oa.updateTaskPane(this.ORd(yc.data));break;case 42:v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableUpdatePaneTitle",!1)&&this.$oa.updateTaskPane(this.HDi(yc.data));break;case 43:v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSerpletEnableUpdatePaneTitle",
!1)&&this.$oa.updateTaskPane(this.Aba());break;default:super.r9c(ib)}}dispose(){}initialize(){this.chb()}chb(){const ib=this.Kd.Dc(I.nY);ib.parent=Da.AFrame.jj;ib.cL=!0}lHb(){this.Kd.Bf(I.nY)}zhd(){this.Ice()&&this.Kd.Bf(this.Kd.m7)}HNk(){$addHandler(window,"message",Object(D.a)(this,this.r9c,"onIFrameMessage"))}yul(){$removeHandler(window,"message",Object(D.a)(this,this.r9c,"onIFrameMessage"))}Ice(){return!!this.Kd.ze&&this.Kd.ze.name===I.nY}pbd(ib){ib=pa.c(ib);document.getElementById(I.nY)&&document.getElementById(I.nY).contentWindow.postMessage(ib,
pb.a.AS(this.r7e))}y6a(ib,...Cb){const yc={};this.goa&&(yc[I.Rml]=this.goa);yc[I.Sml]=String.format.apply(null,[ib].concat(Cb));return pa.c(yc)}$1b(){return la.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()?3:0}k3g(){if(this.w1)this.w1.onPaneThemeChanged(this.$1b());return la.a("getTheme")?appChrome.api.getTheme():null}LJe(){}k4k(){document.getElementById(I.nY)&&hc.FocusManager.Mr(document.getElementById(I.nY).contentWindow)}Ixe(){P.uw("ReactSmartLookupPane - Iframe component failed to load.",
10)}ank(){v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DisableSerpletIFrameLoadHandler",!1)||window.navigator.onLine||P.uw("ReactSmartLookupPane - Onload detected no network.",50)}Aba(){var ib=CommonUIStrings.L_SmartLookupPaneTitle;v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableCoPilotPaneTitle",!1)&&(ib=10===this.TE.entryPoint?2===v.AFrameworkApplication.Aa.jb.rm?CommonUIStrings.l_ReuseSlidesPaneTitle:CommonUIStrings.l_ReuseFilesPaneTitle:
18===this.TE.entryPoint?CommonUIStrings.l_FindInDocumentPaneTitle:CommonUIStrings.L_CoPilotPaneTitle);const Cb=new Sa;Cb.src=this.r7e;Cb.id=I.nY;Cb.refreshPane=this.mCd;Cb.onError=Object(D.a)(this,this.Ixe,"onIFrameError");Cb.onLoad=Object(D.a)(this,this.ank,"onIFrameLoad");Cb.title=ib;C.SessionStatusManager.instance.n3?this.w1||(Cb.errorMessage=CommonUIStrings.l_SmartLookupPaneInitializationError,Cb.errorType=1):(Cb.errorMessage=CommonUIStrings.l_SmartLookupPaneNetworkDisconnected,Cb.errorType=0);
ib=Object.assign(new rb.a,{title:ib,hideHeader:!1,width:I.width,location:I.huk,contentProps:Cb,isModernPane:!0,onOpen:()=>{this.lHb();this.Ilb=!0;this.HNk();la.a("registerOnThemeChangeCallback")&&appChrome.api.registerOnThemeChangeCallback(Object(D.a)(this,this.k3g,"onThemeIdChanged"));v.AFrameworkApplication.Aa.updateCommandUI();if(this.w1)this.w1.onPaneStateChanged(!0)},onClose:()=>{this.f1k();this.zhd();this.Ilb=!1;this.yul();la.a("removeOnThemeChangeCallback")&&appChrome.api.removeOnThemeChangeCallback(Object(D.a)(this,
this.k3g,"onThemeIdChanged"));v.AFrameworkApplication.Aa.updateCommandUI();if(this.w1)this.w1.onPaneStateChanged(!1)}});this.hFd&&(ib.enableResize=!0,ib.minResizeWidth=320,ib.maxResizeWidth=920);return ib}HDi(ib){const Cb=this.Aba();Cb.title=ib;Cb.contentProps.title=ib;return Cb}ORd(ib){const Cb=this.Aba();Cb.resizeWidth=ib;return Cb}}Object(h.a)(zd,"ReactSmartLookupPane",ue,[]);var wd=d(141);class Oa{constructor(){this.Gcf=v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SmartLookupPaneResizingEnabled",
!1)}showTaskPane(ib){wd.UISurfaces.Ms().then(Cb=>{this.Gcf||(ib.enableResize=!1);Cb.showTaskPane(I.nY,ib);return null})}updateTaskPane(ib=null){wd.UISurfaces.Ms().then(Cb=>{Cb.setSelectedTaskPane(I.nY);ib&&(this.Gcf||(ib.enableResize=!1),Cb.updateTaskPane(I.nY,ib));return null})}hideTaskPane(){wd.UISurfaces.Ms().then(ib=>{ib.hideTaskPane(I.nY,2);return null})}}Object(h.a)(Oa,"PptReactSmartLookupPaneHandler",null,[797]);class jb extends fg{constructor(ib){super();this.n2a=ib}JGc(){const ib=v.AFrameworkApplication.fa.ka("822");
return new zd(new Oa,Ub.a.instance,hc.FocusManager.instance(),T.a.instance.resolve("Common.App.SearchCommon.IDocumentContentExecutor"),T.a.instance.resolve("Common.App.SearchCommon.ISerpletExecutor"),T.a.instance.resolve("Common.App.SearchCommon.IInsertContentExecutor"),ib,T.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}c7a(){return this.n2a.getSelectedText()}xwg(){return this.n2a.QGj()}}Object(h.a)(jb,"SmartLookupManager",fg,[]);class qc extends ab{constructor(){super()}get name(){return"Ppt.SmartLookup"}init(){v.AFrameworkApplication.wxa&&
this.SKi()}Wb(ib){super.Wb(ib);ib.register(ic.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().na(()=>new ic.a);ib.register(jb,"PowerPointWebEditor.SmartLookup.SmartLookupManager").as("Common.App.Insights.IInsightsManager").ma().na(()=>new jb(ib.resolve("Common.App.Insights.IInsightsSelection"),ib));ib.register(727,"Common.App.SearchCommon.IDocumentContentExecutor").as("Common.App.SearchCommon.IDocumentContentExecutor").ma().na(()=>
new kd(new e.a(()=>Pb.App.Hb?Pb.App.Hb.Hd.Ci:null),rc.InteractiveViewManager.instance,ib.resolve("Box4.ISelectionFactory"),ib.resolve("PowerPointWebEditor.ISlideReader"),ib.resolve("PowerPointWebEditor.IPPTWorkspace"),ib.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),new r));ib.register(728,"Common.App.SearchCommon.ISerpletExecutor").as("Common.App.SearchCommon.ISerpletExecutor").ma().na(()=>new ad(ib.resolve("Common.IActionManagerExtended")));ib.register(729,"Common.App.SearchCommon.IInsertContentExecutor").as("Common.App.SearchCommon.IInsertContentExecutor").ma().na(()=>
new Xc(v.AFrameworkApplication.Ta,ib.resolve("PowerPointWebEditor.IPptSelectionManager"),ib.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));ib.register(730,"Common.App.SearchCommon.IDocumentHelper").ma().na(()=>new Xd)}static main(){A.a.instance.Bc(new qc)}}Object(h.a)(qc,"PptSmartLookupPackage",ab,[]);Type.registerNamespace("PowerPointWebEditor.SmartLookup");qc.main()}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.smartlookup.js.map