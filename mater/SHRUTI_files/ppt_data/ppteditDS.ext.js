/*
 @license DOMPurify 2.4.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.1/LICENSE */
'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[3],{1004:function(J,V,d){J=d(0);var h=d(13),e=d(1165),m=d(25),r=d(65),v=d(78);class A{constructor(y,u,D,F=null){this.origin=y;this.data=u;this.source=D;this.mc=F}}Object(J.a)(A,"MessageEventArgs",null,[]);d.d(V,"a",function(){return w});class w{constructor(y,u){this.JGd=null;this.D_h=y;this.Rd=u;this.Svc=null}get pib(){return this.D_h.value}get taskManager(){return this.Rd.value}vci(y){this.Svc=y;this.JGd=Object(h.a)(this,
this.rzk,"postMessageEventHandler");this.pib.addHandler(r.a.message,this.JGd,null)}CHi(){this.Svc=null;this.pib.removeHandler(r.a.message,this.JGd)}NSc(y,u){const D=new v.a(0,1,1,()=>{y(u)},7);this.taskManager.Cb(D)}lDj(y,u){const D=new v.a(0,1,1,()=>{y(u)},7);this.taskManager.Cb(D)}rzk(y){return this.Svc?this.Svc(new A(y.origin,y.data,y.source,y.mc)):!1}static get instance(){return w.J6a()}static J6a(){return new w(new e.a(()=>m.AFrameworkApplication.pib),new e.a(()=>m.AFrameworkApplication.pe))}}
Object(J.a)(w,"MessageEventHandler",null,[627])},1007:function(J,V,d){J=d(0);var h=d(376),e=d(101),m=d(268),r=d(13),v=d(1166),A=d(33);class w{constructor(){this.Value=this.Id=this.LanguageId=null}}Object(J.a)(w,"CritiqueTypeOption",null,[]);var y=d(2);d.d(V,"a",function(){return u});class u{constructor(D,F,I){this.HDd={};this.Zk=null;this.Ruf=D;this.jWh=F;this.kWh=I;this.u1a=y.Task.Gt({})}init(){this.u1a=this.Ruf.m4d(this.jWh,["ProofingSettingLanguageList","ProofingSettings"]).CWRCo(Object(r.a)(this,
this.Qnk,"onLoadSettingsTaskFinished"),8)}dql(D){const F={};if(!(D&&"ProofingSettingLanguageList"in D))return F;const I=Array.isArray(A.a(D.ProofingSettingLanguageList))?A.a(D.ProofingSettingLanguageList):null;for(const H of I)"ProofingSettings"+H in D&&(F[H]=Object(v.a)(Object,A.a(D["ProofingSettings"+H])));return F}eql(D){const F={},I=[];for(let E in D){var H=E,L=D[E];L&&(I.push(H),F["ProofingSettings"+H]=A.c(L))}F.ProofingSettingLanguageList=A.c(I);return F}saveSettings(D){this.u1a=y.Task.Gt(D);
this.Zk=null;try{const F=this.eql(D);this.Ruf.Xoh(this.kWh,F).continueWith(Object(r.a)(this,this.Wpk,"onSaveSettingsTaskFinished"),8)}catch(F){h.ULS.sendTraceTag(35401881,375,10,"Save settings failed with exception {0}",F.toString())}}s_d(){if(!this.Zk){if(6!==this.u1a.status)return[];try{var D=this.u1a.result;let L;if(e.a.isEmpty(this.HDd))L=D;else if(e.a.isEmpty(D))L=this.HDd;else{L={};var F=this.HDd;for(let E in F)L[E]=e.a.Alc(F[E]);L=u.merge(L,D)}this.Zk=[];for(let E in L){var I=L[E];const aa=
m.a.oe(parseInt(E));if(!aa)continue;const Q=aa.name;F=I;for(let O in F){D=O;var H=F[O];const T=Object.assign(new w,{LanguageId:Q,Id:D,Value:H.toString()});this.Zk.push(T)}}}catch(L){h.ULS.sendTraceTag(36542301,375,10,"GetCritiqueTypeOptions failed with exception: {0}",L.toString())}}return this.Zk}HIi(D,F){const I=this.u1a.result;if(I)try{let H=I[D];H||(H={});H[F]=!1;I[D]=H;this.saveSettings(I)}catch(H){h.ULS.sendTraceTag(36750082,375,10,"DisableCritique failed with exception: {0}",H.toString())}}Qnk(D){if(D.hm)return h.ULS.sendTraceTag(34964619,
375,10,"Load setting failed with exception {0}",D.Wi),null;if(6===D.status)try{return this.dql(D.result)}catch(F){h.ULS.sendTraceTag(34964620,375,10,"Parse settings with exception {0}",F.toString())}return null}Wpk(D){D.hm&&h.ULS.sendTraceTag(34964621,375,10,"Save setting failed with exception {0}",D.Wi)}static merge(D,F){D=D||{};if(F)for(let L in F){var I=L,H=F[L];D[I]=D[I]||{};for(let E in H)D[I][E]=H[E]}return D}}Object(J.a)(u,"CritiqueTypeSettings",null,[711])},1011:function(J,V,d){J=d(0);var h=
d(133),e=d(80),m=d(1174),r=d(25),v=d(198),A=d(45),w=d(162),y=d(26),u=d(432),D=d(528);class F{constructor(){this.alt=null;this.height=0;this.src=this.alt="";this.width=this.height=0}}Object(J.a)(F,"ImagePasteArgs",null,[]);var I=d(320),H=d(41),L=d(46),E=d(28);d.d(V,"a",function(){return aa});class aa{constructor(Q,O,T,K,X,P,ea,ia,ja,C,pa,Z){this.ia=Q;this.Fa=O;this.gGa=T;this.ra=K;this.$bk=X;this.Eo=P;this.ika=ea;this.De=C;this.Yz=pa;this.wc=Z;this.wLg=ia;this.W5j=ja;this.N4c=!1;this.jac=-1}NP(Q){if(!this.gGa.v4b(this.Fa)||
!Q)return!1;if(Q.nKc&&Q.m7d)return this.N4c=!1,Q.NP=this.wLg;if(!Q.$m||0<Q.$m.getElementsByTagName(L.a.lng).length)return!1;this.N4c=!this.htj(Q)&&this.NPj(this.ra.Yd());Q.NP=this.N4c?this.W5j:this.wLg;return Q.NP}NPj(Q){return 1===Q.length?Q[0].bRj:!1}hDk(Q,O){this.t9g(Q,O,0);if(!Q.firstChild||!Q.firstChild.className||!u.a.ctg(Q.firstChild.className))if(!this.Eo.eg||"<br>"!==Q.innerHTML){const T=w.b(Q);T&&0<T.length&&(O.oY=Q.innerHTML)}}t9g(Q,O,T){if(Q){if(T>=aa.tDc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",
aa.tDc));if(1===Q.nodeType){var K=Q.tagName.toLowerCase();if(this.ika.RNj(K))Q.parentNode.removeChild(Q);else{for(let P=Q.firstChild;P;P=X){var X=P.nextSibling;this.t9g(P,O,T+1)}K===L.a.R7?(Q.parentNode.removeChild(Q),this.iDk(Q,O)):K===L.a.uJb?(Q.parentNode.removeChild(Q),this.ODk(Q,O)):K===L.a.listTag&&this.oDk(Q);this.wc.KLe(Q,O.Sb)}}}}oDk(Q){if(Q){var O=Q.getAttribute("data-"+h.a.MUb);if(O&&0<O.length&&Q.style){var T=parseInt(O);if(1!==O.length||isNaN(T)||1>T||T>I.a.Z6)O="1",T=1;T>this.jac&&(this.jac=
T);O=String.format(L.a.sVj,O);(T=Q.style.cssText)?Q.setAttribute("style",O+T):Q.setAttribute("style",O)}if((O=Q.parentNode)&&!this.De.NKj(O.tagName)){T=Q.nextSibling;const K=this.De.TXb();K.appendChild(Q);O.insertBefore(K,T)}}}iDk(Q,O){if(Q&&Q.src&&Q.src.length){var T=window.location.href.toLowerCase();T=e.a.AS(T);if(Q.src.startsWith(T))y.a.J(20501650,826,50,"Pasted image src is an empty string.");else{T=Math.ceil(m.a.Ie(this.ika.g7i(Q),0,!1));var K=Math.ceil(m.a.Ie(this.ika.Z6i(Q),1,!1));O.tca.push(Object.assign(new F,
{src:Q.src,alt:Q.alt,width:T?T:Q.width,height:K?K:Q.height}))}}}ODk(Q,O){Q&&Q.innerHTML&&Q.rows&&Q.rows.length&&(Q.getElementsByTagName(L.a.eld).length||Q.getElementsByTagName(L.a.Ull).length)&&(Q=w.c(Q),!Q||0>=Q.length||O.fib.push(Q))}htj(Q){if(Q.nKc)return!0;const O=Q.$m.getElementsByTagName(L.a.uJb).length;return 0<Q.$m.getElementsByTagName(L.a.R7).length||0<O}paste(Q){if(r.AFrameworkApplication.mQ)this.$bk.pmc(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null);else{const O=
Object.assign(new D.a,{Sb:Q.Sb});let T=!0;O.Wlc=this.N4c;if(Q.nKc)O.tca.push(Object.assign(new F,{src:Q.m7d,width:0,height:0}));else try{this.hDk(Q.$m,O),0<this.jac&&(y.a.J(21050954,826,50,String.format("max list level pasted into new shape = {0}.",this.jac-1)),this.jac=-1)}catch(K){T=!1,y.a.J(23634591,826,15,K.message)}T&&(this.$$k(O)?this.twk(O):this.ia.La(E.a.LHa,2,O))}}$$k(Q){return v.a.Va(Q.fib)&&A.a.Va(Q.oY)&&!!Q.tca&&1===Q.tca.length&&this.WRj(Q.tca[0].src)}WRj(Q){if(A.a.Va(Q)||!Q.startsWith("data:image"))return!1;
Q=Q.split(";");if(!Q||2!==Q.length)return!1;Q=Q[0].replace("/",".");return 0===this.Yz.Aod(Q,!0)}twk(Q){let O=new Image;const T=Q.tca[0],K=H.a.Eb;if(T.width&&T.height)Q.XUc=!0,this.ia.La(E.a.LHa,2,Q);else{const X=new Date;O.onload=()=>{Q.Wze=+new Date-+X;T.width=O.width;T.height=O.height;Q.XUc=!0;O=null;H.a.cF(K,()=>{this.ia.La(E.a.LHa,2,Q)})};O.onerror=()=>{O=null;H.a.cF(K,()=>{this.ia.La(E.a.LHa,2,Q)})};O.src=T.src}}}aa.tDc=100;Object(J.a)(aa,"HtmlPasteHandler",null,[1166])},1012:function(J,V,d){J=
d(0);var h=d(45);class e{constructor(r,v){this.Z4j=r;this.p2c=v}get sSa(){return this.Z4j}get message(){return this.p2c}}Object(J.a)(e,"CalloutNotificationError",null,[]);d.d(V,"a",function(){return m});class m{constructor(r,v){this.UFg=r;this.U9j=v}nxa(r,v,A,w,y,u,D,F,I,H,L,E){this.UFg.show(this.U9j,null,!1,I,H,r,v,A,y,w,u,D,F,L,E)}RTd(){this.UFg.dismiss()}Ycl(r){if(!r)throw Error.argumentNull("CalloutNotificationMessageAttributes");const v=this.TAl(r);if(v&&v.sSa)return v;this.nxa(r.title,r.message,
r.Dlg,r.SEb,r.Ilg,r.Egd,r.vCk,r.L_k,r.wCk,r.M_k,!!r.rSe,r.rSe);return new e(!1,null)}TAl(r){return h.a.Va(r.title)?new e(!0,"Invalid Title"):h.a.Va(r.message)?new e(!0,"Invalid Message"):r.Dlg&&h.a.Va(r.SEb)?new e(!0,"Missing PrimaryButtonLabel"):r.Ilg&&h.a.Va(r.Egd)?new e(!0,"Missing SecondaryButtonLabel"):new e(!1,null)}}Object(J.a)(m,"CalloutNotificationAdapter",null,[529])},1013:function(J,V,d){J=d(0);var h=d(25),e=d(715),m=d(224);class r extends e.a{constructor(A,w){super(A);this.V0j=w}Kyh(A){return m.i(m.g(A))}xSe(A){return m.i(A)}boc(A){return this.V0j?
A.cei:A.boc().toString()}Chi(A,w,y){const u=new Sys.StringBuilder;u.append(String.format('<Menu Id="{0}">',"menuFontColor"));u.append(this.z4d(A,w,y));u.append('<MenuSection Id="More Font Colors"><Controls Id="Color.Menu.Controls">');u.append(String.format('<Button Id="Color.Menu.MoreFontColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />',"862825906",h.AFrameworkApplication.gm,ResourceStrings.l_MoreFontColors,ResourceStrings.l_MoreFontColorsKeytip));
u.append("</Controls> </MenuSection>");u.append("</Menu>");return u.toString()}}Object(J.a)(r,"ColorMenuBuilder",e.a,[]);d.d(V,"a",function(){return v});class v{w1i(A){return new e.a(A)}d$f(A,w){return new r(A,w)}}Object(J.a)(v,"ColorPickerBuilderFactory",null,[679])},1015:function(J,V,d){J=d(0);var h=d(899),e=d(128);class m extends h.a{constructor(){super();this.languageId=null;this.startOfSentence=!1;this.userInitQuery=this.text=null;this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.ul()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignalBase"}static ul(){return["AugLoop_Signals_Signal"]}}
Object(J.a)(m,"TextPredictorSignalBase",h.a,[]);d.d(V,"a",function(){return r});class r extends m{constructor(){super();this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.ul()})}static getTypeName(){return"AugLoop_Signals_TextPredictorSignal"}static ul(){return["AugLoop_Signals_TextPredictorSignalBase","AugLoop_Signals_Signal"]}}Object(J.a)(r,"TextPredictorSignal",m,[])},1016:function(J,V,d){J=d(0);var h=d(376),e=d(95),m=d(1095),r=d.n(m),v=d(45),A=d(25);d.d(V,"a",function(){return w});class w{static Fhd(y,
u,D){if(y&&D&&(e.a.TAa(y),u&&""!==u))try{if(v.a.Va("HtmlStringSanitizeByDomPurify"))var F=!1;else{var I=A.AFrameworkApplication.fa.Ga("PPTDisabledChangeGates");if(I){var H=I.split(";");F=H&&0<H.length?0>Array.indexOf(H,"HtmlStringSanitizeByDomPurify"):!0}else F=!1}F&&(u=r.a.sanitize(u));const L=w.NMh.parseFromString(u,"text/html");if(L&&L.body){const E=L.body.childNodes;for(u=0;u<E.length;u+=1)y.appendChild(E[u].cloneNode(!0))}}catch(L){h.ULS.sendTraceTag(523106530,324,10,"In class: {0}, unable to parse HTML, {1}",
D,L.message)}}}w.NMh=new DOMParser;Object(J.a)(w,"DOMParserHelper",null,[])},1079:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(95);class e{constructor(m){this.Srd=m.cloneNode(!0);this.tif=m}restore(){for(h.a.ku(this.tif);this.Srd.firstChild;){const m=this.Srd.firstChild;h.a.vO(m);this.tif.appendChild(m)}this.Srd=null}}Object(J.a)(e,"DomElementContentState",null,[])},108:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(1194);class e{constructor(){this.C6a=this.HLf=this.J2=
this.C$=this.rDc=this.ULc=this.Jsb=this.qCa=this.qZ=this.sFc=this.fmd=null}Nf(m){this.fmd=new h.a;this.fmd.value=m}Qkc(){this.sFc=new h.a;this.sFc.value=!0}pU(m){this.ULc=new h.a;this.ULc.value=m}}Object(J.a)(e,"QueryResult",null,[])},1080:function(J,V,d){d.r(V);d.d(V,"SpellingRequestObjectUpdatedV2",function(){return m});J=d(0);var h=d(653),e=d(652);class m extends h.a{constructor(){super();this.ProofingEngine=0;this.UseContextualResults=!1;this.TextUnit=0;this.Descriptors=this.OverriddenCritiqueTypeOptions=
null;this.UxLcid=0}static ZYd(r,v){const A=new m;h.a.PAe(A,r,v);A.UserActionType=e.a[r.userAction];A.ProofingEngine=r.Iea;A.Descriptors=r.descriptors;A.OverriddenCritiqueTypeOptions=r.overriddenCritiqueTypeOptions;A.UxLcid=r.oFh;2===r.Iea?A.TextUnit=r.range.textUnit:1===r.Iea&&(A.UseContextualResults=!0);return A}}Object(J.a)(m,"SpellingRequestObjectUpdatedV2",h.a,[])},1081:function(J,V,d){d.r(V);d.d(V,"SpellingRequestObjectUpdated",function(){return m});J=d(0);var h=d(653),e=d(652);class m extends h.a{constructor(){super();
this.UseContextualResults=this.TrackMetrics=this.UseOneSpeller=!1;this.ExperimentId=null}static ZYd(r,v,A,w,y,u){const D=new m;h.a.PAe(D,r,v);D.UserActionType=e.a[r.userAction];D.UseOneSpeller=A;D.TrackMetrics=w;D.UseContextualResults=y;u&&(D.ExperimentId=u);return D}}Object(J.a)(m,"SpellingRequestObjectUpdated",h.a,[])},1082:function(J,V,d){d.r(V);d.d(V,"ReactOICErrorDialogWithTrial",function(){return r});J=d(0);var h=d(13);V=d(905);var e=d(194),m=d(82);class r extends V.a{constructor(v,A,w,y,u,
D){super(v,A,w,y,u,D);A={["errorMessage"]:this.m2f,["offerString"]:this.cYg};v=new m.a(!1,!1,!0);this.psh?(v.yd=1,A.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.QRa,["onExecute"]:()=>{e.Redirect.showHelp(this.Ylg)}}):(v.yd=4,v.Ue(2,this.Ymg));v.Ue(1,this.nCf);v.ng=this.id;A={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:A};v.tj(this.qPa,Object(h.a)(this,this.zJk,"reactOICErrorDialogWithTrialHandler"),A)}}Object(J.a)(r,"ReactOICErrorDialogWithTrial",V.a,[])},1083:function(J,
V,d){d.r(V);d.d(V,"OICErrorDialogWithTrial",function(){return m});J=d(0);var h=d(13);V=d(905);var e=d(104);class m extends V.a{constructor(r,v,A,w,y,u){super(r,v,A,w,y,u);r=document.createElement("span");r.innerText=this.m2f;r.appendChild(document.createElement("br"));r.appendChild(document.createElement("br"));v=document.createElement("span");v.innerText=this.cYg;r.appendChild(v);v=new e.StandardDialog;this.psh?(v.yd=1,v.NHd(this.QRa,this.Ylg)):(v.yd=4,v.Ue(2,this.Ymg));v.Ue(1,this.nCf);v.ng=this.id;
v.nx(this.qPa,null,this.icon,Object(h.a)(this,this.UUj,"legacyOICErrorDialogWithTrialHandler"),r)}}Object(J.a)(m,"OICErrorDialogWithTrial",V.a,[])},1084:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.keytip=this.id=this.image=this.label=this.command=null}}Object(J.a)(h,"HeaderButtonInfo",null,[])},1085:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ariaDescription=this.onExecute=this.label=null}}Object(J.a)(h,"CalloutButtonProps",
null,[])},1086:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.y=this.x=0}}Object(J.a)(h,"IPoint",null,[])},1087:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(25);d=d(77);class e{static c6h(m){e.DXe.addHandler(e.bRf,m)}static CGk(m){h.AFrameworkApplication.fa.ka("SqmCommandEventSourceEnabled")&&e.DXe.raiseEvent(e.bRf,m)}}e.bRf="CommandClickEvent";e.DXe=new d.a;Object(J.a)(e,"CommandClickEvents",null,[])},1088:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{}h.Image16by16Class="Image16by16Class";h.Image32by32Class="Image32by32Class";h.On="On";h.LabelText="LabelText";h.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly";h.EnsureControlRoleIsButton="EnsureControlRoleIsButton";h.Visible="Visible";Object(J.a)(h,"SplitButtonCommandProperties",null,[])},1089:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m=null,r=null,v=null){this.iconSet={};this.iconSet["default"]=e;this.iconSet.icon16=m;this.iconSet.icon24=
r;this.iconSet.icon32=v}}Object(J.a)(h,"IconSetContainer",null,[])},1090:function(J,V,d){d.r(V);d.d(V,"NewCustomEventFactory",function(){return h});J=d(0);d=d(526);class h extends d.a{constructor(){super()}create(e,m){const r={};r.detail=m;return new CustomEvent(e,r)}}Object(J.a)(h,"NewCustomEventFactory",d.a,[])},1091:function(J,V,d){d.r(V);d.d(V,"IECustomEventFactory",function(){return h});J=d(0);d=d(526);class h extends d.a{constructor(){super()}create(e,m){const r=window.document.createEvent("CustomEvent");
r.initCustomEvent(e,!1,!1,m);return r}}Object(J.a)(h,"IECustomEventFactory",d.a,[])},1092:function(J,V,d){d.r(V);d.d(V,"CheckRoamingRightsRequest",function(){return h});J=d(0);d=d(934);class h extends d.a{constructor(){super()}Ptb(){return 2}Ok(){return 1}}Object(J.a)(h,"CheckRoamingRightsRequest",d.a,[])},1093:function(J,V,d){d.r(V);d.d(V,"GetRoamingLauncherRequest",function(){return h});J=d(0);d=d(934);class h extends d.a{constructor(){super()}Ptb(){return 0}Ok(){return 2}}Object(J.a)(h,"GetRoamingLauncherRequest",
d.a,[])},1094:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(197),e=d(93);class m{constructor(r){this.Pv=r;this.wM=Array.indexOf(this.Pv,this.Aia)}dispose(){this.Pv=null}get vZ(){return this.Pv[this.wM]}wE(r){this.Rkc(r,!1);return!0}v6a(r){this.Rkc(r,!0)}Rkc(r,v){r&&(this.vZ!==r||v)&&(r.tabIndex=0,e.FocusManager.Mr(r));Array.contains(this.Pv,r)&&(this.wM=Array.indexOf(this.Pv,r))}get P8g(){let r=this.wM;do if(r)if(0<r&&r<this.Pv.length)r--;else break;else r=this.Pv.length-1;while(!h.DOMFocusListing.OBa(this.Pv[r])&&
r!==this.wM);return this.Pv[r]}get UWg(){let r=this.wM;do if(r===this.Pv.length-1)r=0;else if(0<=r&&r<this.Pv.length-1)r++;else break;while(!h.DOMFocusListing.OBa(this.Pv[r])&&r!==this.wM);return this.Pv[r]}get Aia(){let r=0;for(;!h.DOMFocusListing.OBa(this.Pv[r])&&r<this.Pv.length;)r++;return h.DOMFocusListing.OBa(this.Pv[r])?this.Pv[r]:null}get lxb(){let r=this.Pv.length-1;for(;!h.DOMFocusListing.OBa(this.Pv[r])&&0<r;)r--;return h.DOMFocusListing.OBa(this.Pv[r])?this.Pv[r]:null}}Object(J.a)(m,"DialogFocusListing",
null,[199])},1095:function(J){(function(V,d){J.exports=d()})(this,function(){function V(Mb,Hb){if("object"!==d(Mb)||"function"!==typeof Mb.createPolicy)return null;var vb=null;Hb.currentScript&&Hb.currentScript.hasAttribute("data-tt-policy-suffix")&&(vb=Hb.currentScript.getAttribute("data-tt-policy-suffix"));Hb="dompurify"+(vb?"#"+vb:"");try{return Mb.createPolicy(Hb,{createHTML:function(Xb){return Xb},createScriptURL:function(Xb){return Xb}})}catch(Xb){return console.warn("TrustedTypes policy "+
Hb+" could not be created."),null}}function d(Mb){"@babel/helpers - typeof";return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Hb){return typeof Hb}:function(Hb){return Hb&&"function"==typeof Symbol&&Hb.constructor===Symbol&&Hb!==Symbol.prototype?"symbol":typeof Hb},d(Mb)}function h(Mb,Hb){h=Object.setPrototypeOf||function(vb,Xb){vb.__proto__=Xb;return vb};return h(Mb,Hb)}function e(){if("undefined"===typeof Reflect||!Reflect.construct||Reflect.construct.LGl)return!1;if("function"===
typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(Mb){return!1}}function m(Mb,Hb,vb){m=e()?Reflect.construct:function(Xb,Uc,hb){var Zb=[null];Zb.push.apply(Zb,Uc);Xb=new (Function.bind.apply(Xb,Zb));hb&&h(Xb,hb.prototype);return Xb};return m.apply(null,arguments)}function r(Mb){var Hb=Array.isArray(Mb)?v(Mb):void 0;Hb||(Hb="undefined"!==typeof Symbol&&null!=Mb[Symbol.iterator]||null!=Mb["@@iterator"]?Array.from(Mb):void 0);if(!Hb)a:{if(Mb){if("string"===
typeof Mb){Hb=v(Mb,void 0);break a}Hb=Object.prototype.toString.call(Mb).slice(8,-1);"Object"===Hb&&Mb.constructor&&(Hb=Mb.constructor.name);if("Map"===Hb||"Set"===Hb){Hb=Array.from(Mb);break a}if("Arguments"===Hb||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Hb)){Hb=v(Mb,void 0);break a}}Hb=void 0}if(!(Mb=Hb))throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");return Mb}function v(Mb,Hb){if(null==
Hb||Hb>Mb.length)Hb=Mb.length;for(var vb=0,Xb=Array(Hb);vb<Hb;vb++)Xb[vb]=Mb[vb];return Xb}function A(Mb){return function(Hb){for(var vb=arguments.length,Xb=Array(1<vb?vb-1:0),Uc=1;Uc<vb;Uc++)Xb[Uc-1]=arguments[Uc];return K(Mb,Hb,Xb)}}function w(Mb,Hb,vb){vb=vb?vb:ja;I&&I(Mb,null);for(var Xb=Hb.length;Xb--;){var Uc=Hb[Xb];if("string"===typeof Uc){var hb=vb(Uc);hb!==Uc&&(H(Hb)||(Hb[Xb]=hb),Uc=hb)}Mb[Uc]=!0}return Mb}function y(Mb){var Hb=O(null),vb;for(vb in Mb)K(F,Mb,[vb])&&(Hb[vb]=Mb[vb]);return Hb}
function u(Mb,Hb){for(;null!==Mb;){var vb=E(Mb,Hb);if(vb){if(vb.get)return A(vb.get);if("function"===typeof vb.value)return A(vb.value)}Mb=L(Mb)}return function(Xb){console.warn("fallback value for",Xb);return null}}function D(){function Mb(xc){var me,Dd;vb("beforeSanitizeAttributes",xc,null);var Qe=xc.attributes;if(Qe){var tf={attrName:"",qJf:"",kBg:!0,LEl:Xd};for(Dd=Qe.length;Dd--;){var Rb=me=Qe[Dd],Jc=Rb.name;Rb=Rb.namespaceURI;me="value"===Jc?me.value:ya(me.value);var Qc=qg(Jc);tf.attrName=Qc;
tf.qJf=me;tf.kBg=!0;tf.zWi=void 0;vb("uponSanitizeAttribute",xc,tf);me=tf.qJf;if(!tf.zWi&&(Zb(Jc,xc),tf.kBg))if(Ka(/\/>/i,me))Zb(Jc,xc);else{wd&&(me=Z(me,Fb," "),me=Z(me,fb," "),me=Z(me,Pc," "));var Ph=qg(xc.nodeName);a:{var ng=Ph;var se=Qc,pf=me;if(yc&&("id"===se||"name"===se)&&(pf in Tb||pf in qd))ng=!1;else{if(!cd||rb[se]||!Ka(dd,se))if(!pc||!Ka(kd,se))if(!Xd[se]||rb[se]){if(!(0<ng.indexOf("-")&&(ue.N0 instanceof RegExp&&Ka(ue.N0,ng)||ue.N0 instanceof Function&&ue.N0(ng))&&(ue.O3a instanceof RegExp&&
Ka(ue.O3a,se)||ue.O3a instanceof Function&&ue.O3a(se))||"is"===se&&ue.$Bc&&(ue.N0 instanceof RegExp&&Ka(ue.N0,pf)||ue.N0 instanceof Function&&ue.N0(pf)))){ng=!1;break a}}else if(!(pg[se]||Ka(ld,Z(pf,ce,""))||("src"===se||"xlink:href"===se||"href"===se)&&"script"!==ng&&0===qa(pf,"data:")&&Bb[ng]||zd&&!Ka(Td,Z(pf,ce,"")))&&pf){ng=!1;break a}ng=!0}}if(ng){!gd||"id"!==Qc&&"name"!==Qc||(Zb(Jc,xc),me="user-content-"+me);if(ne&&"object"===d(Pb)&&"function"===typeof Pb.getAttributeType&&!Rb)switch(Pb.getAttributeType(Ph,
Qc)){case "TrustedHTML":me=ne.createHTML(me);break;case "TrustedScriptURL":me=ne.createScriptURL(me)}try{Rb?xc.setAttributeNS(Rb,Jc,me):xc.setAttribute(Jc,me),ea(ac.removed)}catch($d){}}}}vb("afterSanitizeAttributes",xc,null)}}function Hb(xc){vb("beforeSanitizeElements",xc,null);if(xc instanceof kb&&("string"!==typeof xc.nodeName||"string"!==typeof xc.textContent||"function"!==typeof xc.removeChild||!(xc.attributes instanceof cc)||"function"!==typeof xc.removeAttribute||"function"!==typeof xc.setAttribute||
"string"!==typeof xc.namespaceURI||"function"!==typeof xc.insertBefore||"function"!==typeof xc.hasChildNodes)||Ka(/[\u0080-\uFFFF]/,xc.nodeName))return Fc(xc),!0;var me=qg(xc.nodeName);vb("uponSanitizeElement",xc,{tagName:me,MEl:ad});if(!(!xc.hasChildNodes()||Xb(xc.firstElementChild)||Xb(xc.content)&&Xb(xc.content.firstElementChild))&&Ka(/<[/\w]/g,xc.innerHTML)&&Ka(/<[/\w]/g,xc.textContent)||"select"===me&&Ka(/<template/i,xc.innerHTML))return Fc(xc),!0;if(!ad[me]||Sa[me]){if(!Sa[me]&&0<me.indexOf("-")&&
(ue.N0 instanceof RegExp&&Ka(ue.N0,me)||ue.N0 instanceof Function&&ue.N0(me)))return!1;if(od&&!ye[me]){me=Fd(xc)||xc.parentNode;var Dd=md(xc)||xc.childNodes;if(Dd&&me)for(var Qe=Dd.length-1;0<=Qe;--Qe)me.insertBefore(rc(Dd[Qe],!0),ic(xc))}Fc(xc);return!0}if(Dd=xc instanceof fd){(Dd=Fd(xc))&&Dd.tagName||(Dd={namespaceURI:qe,tagName:"template"});Qe=ja(xc.tagName);var tf=ja(Dd.tagName);Dd=!(Cf[xc.namespaceURI]&&("http://www.w3.org/2000/svg"===xc.namespaceURI?"http://www.w3.org/1999/xhtml"===Dd.namespaceURI?
"svg"===Qe:"http://www.w3.org/1998/Math/MathML"===Dd.namespaceURI?"svg"===Qe&&("annotation-xml"===tf||Tf[tf]):xe[Qe]:"http://www.w3.org/1998/Math/MathML"===xc.namespaceURI?"http://www.w3.org/1999/xhtml"===Dd.namespaceURI?"math"===Qe:"http://www.w3.org/2000/svg"===Dd.namespaceURI?"math"===Qe&&Pg[tf]:jh[Qe]:"http://www.w3.org/1999/xhtml"===xc.namespaceURI?"http://www.w3.org/2000/svg"===Dd.namespaceURI&&!Pg[tf]||"http://www.w3.org/1998/Math/MathML"===Dd.namespaceURI&&!Tf[tf]?0:!jh[Qe]&&(Ee[Qe]||!xe[Qe]):
"application/xhtml+xml"===Gf&&Cf[xc.namespaceURI]))}if(Dd||("noscript"===me||"noembed"===me)&&Ka(/<\/no(script|embed)/i,xc.innerHTML))return Fc(xc),!0;wd&&3===xc.nodeType&&(me=xc.textContent,me=Z(me,Fb," "),me=Z(me,fb," "),me=Z(me,Pc," "),xc.textContent!==me&&(ia(ac.removed,{element:xc.cloneNode()}),xc.textContent=me));vb("afterSanitizeElements",xc,null);return!1}function vb(xc,me,Dd){gc[xc]&&P(gc[xc],function(Qe){Qe.call(ac,me,Dd,Pf)})}function Xb(xc){return"object"===d(Wb)?xc instanceof Wb:xc&&
"object"===d(xc)&&"number"===typeof xc.nodeType&&"string"===typeof xc.nodeName}function Uc(xc){return Vb.call(xc.ownerDocument||xc,xc,fc.SHOW_ELEMENT|fc.SHOW_COMMENT|fc.SHOW_TEXT,null,!1)}function hb(xc){if(jb)xc="<remove></remove>"+xc;else var me=(me=pa(xc,/^[\r\n\t ]+/))&&me[0];"application/xhtml+xml"===Gf&&"http://www.w3.org/1999/xhtml"===qe&&(xc='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+xc+"</body></html>");var Dd=ne?ne.createHTML(xc):xc;if("http://www.w3.org/1999/xhtml"===
qe)try{var Qe=(new ab).parseFromString(Dd,Gf)}catch(tf){}if(!Qe||!Qe.documentElement){Qe=gb.createDocument(qe,"template",null);try{Qe.documentElement.innerHTML=Oh?"":Dd}catch(tf){}}Dd=Qe.body||Qe.documentElement;xc&&me&&Dd.insertBefore(Tb.createTextNode(me),Dd.childNodes[0]||null);return"http://www.w3.org/1999/xhtml"===qe?Xc.call(Qe,Oa?"html":"body")[0]:Oa?Qe.documentElement:Dd}function Zb(xc,me){try{ia(ac.removed,{attribute:me.getAttributeNode(xc),from:me})}catch(Dd){ia(ac.removed,{attribute:null,
from:me})}me.removeAttribute(xc);if("is"===xc&&!Xd[xc])if(qc||ib)try{Fc(me)}catch(Dd){}else try{me.setAttribute(xc,"")}catch(Dd){}}function Fc(xc){ia(ac.removed,{element:xc});try{xc.parentNode.removeChild(xc)}catch(me){try{xc.outerHTML=ud}catch(Dd){xc.remove()}}}function ob(xc){return xc instanceof RegExp||xc instanceof Function}function ac(xc){return D(xc)}var pb=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"===typeof window?null:window;ac.version="2.4.1";ac.removed=[];if(!pb||
!pb.document||9!==pb.document.nodeType)return ac.LVc=!1,ac;var nb=pb.document,Tb=pb.document,Ub=pb.DocumentFragment,hc=pb.HTMLTemplateElement,Wb=pb.Node,fd=pb.Element,fc=pb.NodeFilter,bc=pb.NamedNodeMap,cc=void 0===bc?pb.NamedNodeMap||pb.wEl:bc,kb=pb.HTMLFormElement,ab=pb.DOMParser,Pb=pb.trustedTypes;bc=fd.prototype;var rc=u(bc,"cloneNode"),ic=u(bc,"nextSibling"),md=u(bc,"childNodes"),Fd=u(bc,"parentNode");"function"===typeof hc&&(hc=Tb.createElement("template"),hc.content&&hc.content.ownerDocument&&
(Tb=hc.content.ownerDocument));var ne=V(Pb,nb),ud=ne?ne.createHTML(""):"";hc=Tb;var gb=hc.implementation,Vb=hc.createNodeIterator,Lc=hc.createDocumentFragment,Xc=hc.getElementsByTagName,Ib=nb.importNode;hc={};try{hc=y(Tb).documentMode?Tb.documentMode:{}}catch(xc){}var gc={};ac.LVc="function"===typeof Fd&&gb&&"undefined"!==typeof gb.createHTMLDocument&&9!==hc;var Fb=Ma,fb=Ca,Pc=Va,dd=Za,kd=Db,Td=yb,ce=Bc,ld=Lb,ad=null,Yf=w({},[].concat(r(la),r(ma),r(Ea),r(Ga),r(sa))),Xd=null,fg=w({},[].concat(r(Ha),
r(bb),r(Ya),r(ua))),ue=Object.seal(Object.create(null,{N0:{writable:!0,configurable:!1,enumerable:!0,value:null},O3a:{writable:!0,configurable:!1,enumerable:!0,value:null},$Bc:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Sa=null,rb=null,pc=!0,cd=!0,zd=!1,wd=!1,Oa=!1,jb=!1,qc=!1,ib=!1,Cb=!1,yc=!0,gd=!1,od=!0,Mc=!1,Rd={},ye=null,oe=w({},"annotation-xml audio colgroup desc foreignobject head iframe math mi mn mo ms mtext noembed noframes noscript plaintext script style svg template thead title video xmp".split(" ")),
Bb=null,Ff=w({},"audio video img source image track".split(" ")),pg=null,xf=w({},"alt class for id label name pattern placeholder role summary title value style xmlns".split(" ")),qe="http://www.w3.org/1999/xhtml",Oh=!1,Cf=null,Bg=w({},["http://www.w3.org/1998/Math/MathML","http://www.w3.org/2000/svg","http://www.w3.org/1999/xhtml"],C),Gf,dh=["application/xhtml+xml","text/html"],qg,Pf=null,qd=Tb.createElement("form"),Tf=w({},["mi","mo","mn","ms","mtext"]),Pg=w({},["foreignobject","desc","title","annotation-xml"]),
Ee=w({},["title","style","font","a","script"]),xe=w({},ma);w(xe,Ea);w(xe,ta);var jh=w({},Ga);w(jh,oa);var yg=function Dd(me){var Qe,tf=Uc(me);for(vb("beforeSanitizeShadowDOM",me,null);Qe=tf.nextNode();)vb("uponSanitizeShadowNode",Qe,null),Hb(Qe)||(Qe.content instanceof Ub&&Dd(Qe.content),Mb(Qe));vb("afterSanitizeShadowDOM",me,null)};ac.sanitize=function(me){var Dd=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};(Oh=!me)&&(me="\x3c!--\x3e");if("string"!==typeof me&&!Xb(me)){if("function"!==
typeof me.toString)throw Da("toString is not a function");me=me.toString();if("string"!==typeof me)throw Da("dirty is not a string, aborting");}if(!ac.LVc){if("object"===d(pb.ASe)||"function"===typeof pb.ASe){if("string"===typeof me)return pb.ASe(me);if(Xb(me))return pb.ASe(me.outerHTML)}return me}Pf&&Pf===Dd||(Dd&&"object"===d(Dd)||(Dd={}),Dd=y(Dd),Gf=-1===dh.indexOf(Dd.fIh)?Gf="text/html":Gf=Dd.fIh,qg="application/xhtml+xml"===Gf?C:ja,ad="ALLOWED_TAGS"in Dd?w({},Dd.kEl,qg):Yf,Xd="ALLOWED_ATTR"in
Dd?w({},Dd.iEl,qg):fg,Cf="ALLOWED_NAMESPACES"in Dd?w({},Dd.jEl,C):Bg,pg="ADD_URI_SAFE_ATTR"in Dd?w(y(xf),Dd.cXe,qg):xf,Bb="ADD_DATA_URI_TAGS"in Dd?w(y(Ff),Dd.hEl,qg):Ff,ye="FORBID_CONTENTS"in Dd?w({},Dd.kXe,qg):oe,Sa="FORBID_TAGS"in Dd?w({},Dd.rEl,qg):{},rb="FORBID_ATTR"in Dd?w({},Dd.qEl,qg):{},Rd="USE_PROFILES"in Dd?Dd.EEl:!1,pc=!1!==Dd.mEl,cd=!1!==Dd.nEl,zd=Dd.oEl||!1,wd=Dd.BEl||!1,Oa=Dd.FEl||!1,qc=Dd.yEl||!1,ib=Dd.zEl||!1,Cb=Dd.AEl||!1,jb=Dd.sEl||!1,yc=!1!==Dd.CEl,gd=Dd.DEl||!1,od=!1!==Dd.uEl,
Mc=Dd.tEl||!1,ld=Dd.lEl||ld,qe=Dd.xEl||"http://www.w3.org/1999/xhtml",Dd.FKa&&ob(Dd.FKa.N0)&&(ue.N0=Dd.FKa.N0),Dd.FKa&&ob(Dd.FKa.O3a)&&(ue.O3a=Dd.FKa.O3a),Dd.FKa&&"boolean"===typeof Dd.FKa.$Bc&&(ue.$Bc=Dd.FKa.$Bc),wd&&(cd=!1),ib&&(qc=!0),Rd&&(ad=w({},r(sa)),Xd=[],!0===Rd.html&&(w(ad,la),w(Xd,Ha)),!0===Rd.Pkl&&(w(ad,ma),w(Xd,bb),w(Xd,ua)),!0===Rd.RGl&&(w(ad,Ea),w(Xd,bb),w(Xd,ua)),!0===Rd.OFl&&(w(ad,Ga),w(Xd,Ya),w(Xd,ua))),Dd.gHh&&(ad===Yf&&(ad=y(ad)),w(ad,Dd.gHh,qg)),Dd.fHh&&(Xd===fg&&(Xd=y(Xd)),w(Xd,
Dd.fHh,qg)),Dd.cXe&&w(pg,Dd.cXe,qg),Dd.kXe&&(ye===oe&&(ye=y(ye)),w(ye,Dd.kXe,qg)),od&&(ad["#text"]=!0),Oa&&w(ad,["html","head","body"]),ad.table&&(w(ad,["tbody"]),delete Sa.Exh),aa&&aa(Dd),Pf=Dd);ac.removed=[];"string"===typeof me&&(Mc=!1);if(Mc){if(me.nodeName&&(Dd=qg(me.nodeName),!ad[Dd]||Sa[Dd]))throw Da("root node is forbidden and cannot be sanitized in-place");}else if(me instanceof Wb){var Qe=hb("\x3c!----\x3e");Dd=Qe.ownerDocument.importNode(me,!0);1===Dd.nodeType&&"BODY"===Dd.nodeName?Qe=
Dd:"HTML"===Dd.nodeName?Qe=Dd:Qe.appendChild(Dd)}else{if(!qc&&!wd&&!Oa&&-1===me.indexOf("<"))return ne&&Cb?ne.createHTML(me):me;Qe=hb(me);if(!Qe)return qc?null:Cb?ud:""}Qe&&jb&&Fc(Qe.firstChild);for(var tf=Uc(Mc?me:Qe);Dd=tf.nextNode();)if((3!==Dd.nodeType||Dd!==Rb)&&!Hb(Dd)){Dd.content instanceof Ub&&yg(Dd.content);Mb(Dd);var Rb=Dd}if(Mc)return me;if(qc){if(ib)for(Rb=Lc.call(Qe.ownerDocument);Qe.firstChild;)Rb.appendChild(Qe.firstChild);else Rb=Qe;Xd.KGl&&(Rb=Ib.call(nb,Rb,!0));return Rb}Rb=Oa?Qe.outerHTML:
Qe.innerHTML;Oa&&ad["!doctype"]&&Qe.ownerDocument&&Qe.ownerDocument.doctype&&Qe.ownerDocument.doctype.name&&Ka(tb,Qe.ownerDocument.doctype.name)&&(Rb="<!DOCTYPE "+Qe.ownerDocument.doctype.name+">\n"+Rb);wd&&(Rb=Z(Rb,Fb," "),Rb=Z(Rb,fb," "),Rb=Z(Rb,Pc," "));return ne&&Cb?ne.createHTML(Rb):Rb};return ac}var F=Object.hasOwnProperty,I=Object.setPrototypeOf,H=Object.isFrozen,L=Object.getPrototypeOf,E=Object.getOwnPropertyDescriptor,aa=Object.freeze,Q=Object.seal,O=Object.create,T="undefined"!==typeof Reflect&&
Reflect,K=T.apply,X=T.construct;K||(K=function(Mb,Hb,vb){return Mb.apply(Hb,vb)});aa||(aa=function(Mb){return Mb});Q||(Q=function(Mb){return Mb});X||(X=function(Mb,Hb){return m(Mb,r(Hb))});var P=A(Array.prototype.forEach),ea=A(Array.prototype.pop),ia=A(Array.prototype.push),ja=A(String.prototype.toLowerCase),C=A(String.prototype.toString),pa=A(String.prototype.match),Z=A(String.prototype.replace),qa=A(String.prototype.indexOf),ya=A(String.prototype.trim),Ka=A(RegExp.prototype.test),Da=function(Mb){return function(){for(var Hb=
arguments.length,vb=Array(Hb),Xb=0;Xb<Hb;Xb++)vb[Xb]=arguments[Xb];return X(Mb,vb)}}(TypeError),la=aa("a abbr acronym address area article aside audio b bdi bdo big blink blockquote body br button canvas caption center cite code col colgroup content data datalist dd decorator del details dfn dialog dir div dl dt element em fieldset figcaption figure font footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i img input ins kbd label legend li main map mark marquee menu menuitem meter nav nobr ol optgroup option output p picture pre progress q rp rt ruby s samp section select shadow small source spacer span strike strong style sub summary sup table tbody td template textarea tfoot th thead time tr track tt u ul var video wbr".split(" ")),
ma=aa("svg a altglyph altglyphdef altglyphitem animatecolor animatemotion animatetransform circle clippath defs desc ellipse filter font g glyph glyphref hkern image line lineargradient marker mask metadata mpath path pattern polygon polyline radialgradient rect stop style switch symbol text textpath title tref tspan view vkern".split(" ")),Ea=aa("feBlend feColorMatrix feComponentTransfer feComposite feConvolveMatrix feDiffuseLighting feDisplacementMap feDistantLight feFlood feFuncA feFuncB feFuncG feFuncR feGaussianBlur feImage feMerge feMergeNode feMorphology feOffset fePointLight feSpecularLighting feSpotLight feTile feTurbulence".split(" ")),
ta=aa("animate color-profile cursor discard fedropshadow font-face font-face-format font-face-name font-face-src font-face-uri foreignobject hatch hatchpath mesh meshgradient meshpatch meshrow missing-glyph script set solidcolor unknown use".split(" ")),Ga=aa("math menclose merror mfenced mfrac mglyph mi mlabeledtr mmultiscripts mn mo mover mpadded mphantom mroot mrow ms mspace msqrt mstyle msub msup msubsup mtable mtd mtext mtr munder munderover".split(" ")),oa=aa("maction maligngroup malignmark mlongdiv mscarries mscarry msgroup mstack msline msrow semantics annotation annotation-xml mprescripts none".split(" ")),
sa=aa(["#text"]),Ha=aa("accept action align alt autocapitalize autocomplete autopictureinpicture autoplay background bgcolor border capture cellpadding cellspacing checked cite class clear color cols colspan controls controlslist coords crossorigin datetime decoding default dir disabled disablepictureinpicture disableremoteplayback download draggable enctype enterkeyhint face for headers height hidden high href hreflang id inputmode integrity ismap kind label lang list loading loop low max maxlength media method min minlength multiple muted name nonce noshade novalidate nowrap open optimum pattern placeholder playsinline poster preload pubdate radiogroup readonly rel required rev reversed role rows rowspan spellcheck scope selected shape size sizes span srclang start src srcset step style summary tabindex title translate type usemap valign value width xmlns slot".split(" ")),
bb=aa("accent-height accumulate additive alignment-baseline ascent attributename attributetype azimuth basefrequency baseline-shift begin bias by class clip clippathunits clip-path clip-rule color color-interpolation color-interpolation-filters color-profile color-rendering cx cy d dx dy diffuseconstant direction display divisor dur edgemode elevation end fill fill-opacity fill-rule filter filterunits flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight fx fy g1 g2 glyph-name glyphref gradientunits gradienttransform height href id image-rendering in in2 k k1 k2 k3 k4 kerning keypoints keysplines keytimes lang lengthadjust letter-spacing kernelmatrix kernelunitlength lighting-color local marker-end marker-mid marker-start markerheight markerunits markerwidth maskcontentunits maskunits max mask media method mode min name numoctaves offset operator opacity order orient orientation origin overflow paint-order path pathlength patterncontentunits patterntransform patternunits points preservealpha preserveaspectratio primitiveunits r rx ry radius refx refy repeatcount repeatdur restart result rotate scale seed shape-rendering specularconstant specularexponent spreadmethod startoffset stddeviation stitchtiles stop-color stop-opacity stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke stroke-width style surfacescale systemlanguage tabindex targetx targety transform transform-origin text-anchor text-decoration text-rendering textlength type u1 u2 unicode values viewbox visibility version vert-adv-y vert-origin-x vert-origin-y width word-spacing wrap writing-mode xchannelselector ychannelselector x x1 x2 xmlns y y1 y2 z zoomandpan".split(" ")),
Ya=aa("accent accentunder align bevelled close columnsalign columnlines columnspan denomalign depth dir display displaystyle encoding fence frame height href id largeop length linethickness lspace lquote mathbackground mathcolor mathsize mathvariant maxsize minsize movablelimits notation numalign open rowalign rowlines rowspacing rowspan rspace rquote scriptlevel scriptminsize scriptsizemultiplier selection separator separators stretchy subscriptshift supscriptshift symmetric voffset width xmlns".split(" ")),
ua=aa(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ma=Q(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Ca=Q(/<%[\w\W]*|[\w\W]*%>/gm),Va=Q(/\${[\w\W]*}/gm),Za=Q(/^data-[\-\w.\u00B7-\uFFFF]/),Db=Q(/^aria-[\-\w]+$/),Lb=Q(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),yb=Q(/^(?:\w+script|data):/i),Bc=Q(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),tb=Q(/^html$/i);return D()})},1096:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(300);
class h{}h.Value="Value";h.Image16by16Class="Image16by16Class";h.Alt="Alt";h.Visible=d.a.visible;Object(J.a)(h,"LabelCommandProperties",null,[])},1105:function(J,V,d){d.r(V);J=d(0);var h=d(376),e=d(13),m=d(1166),r=d(25),v=d(141),A=d(450),w=d(267),y=d(195),u=d(55),D=d(70),F=d(35);class I{constructor(ob,ac,pb,nb,Tb){this.xzd=null;this.bP=!0;this.VO=null;this.Ca=ob;this.Oh=ac;this.Asd=pb;this.LWh=nb;this.Tg=Tb;r.AFrameworkApplication.sBc(Object(e.a)(this,this.dxl,"updateLastError"));this.LWh.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)?(this.bP=r.AFrameworkApplication.sE,u.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ub=>{Ub.isFeatureEnabled("mso_sendASmile",!0).then(hc=>{this.bP=r.AFrameworkApplication.sE&&hc;this.Oh&&this.Oh.updateCommandUI();return null},()=>null)})):u.a.instance.Ka("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Ub=>{Ub.M2("Enabled").then(hc=>{this.bP=hc;return null},()=>null)})}get Tg(){this.VO||(r.AFrameworkApplication.Tg||(r.AFrameworkApplication.Tg=
new A.a),this.VO=r.AFrameworkApplication.Tg);return this.VO}set Tg(ob){this.VO=ob}dxl(ob,ac){void 0!==ac&&null!==ac&&ac&&(this.xzd=ac.errorCode)}ub(){this.Ca.ya(F.a.giveFeedback,D.a.frame,Object(e.a)(this,this.Okj,"giveFeedbackHandler"));this.Ca.ya(F.a.oTe,D.a.frame,Object(e.a)(this,this.oTe,"triggerFloodgateSurvey"));this.Oh.updateCommandUI()}oTe(ob,ac,pb,nb,Tb){if(1===pb)return 32;if(2===pb&&!Tb)return 8;u.a.instance.Ka("Common.ISystemInitiatedFeedback").execute(Ub=>{Ub.logActivity(Object(m.a)(String,
Tb.ActivityName),Object(m.a)(String,Tb.BRSName))});return 32}Okj(ob,ac,pb,nb,Tb){if(1===pb)return r.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.bP=!1),this.bP&&y.SessionStatusManager.instance.n3?32:8;if(2===pb){h.ULS.sendTraceTag(8405838,356,50,"");this.Tg.Feedback|=w.a.jSi;const Ub=Tb||{};void 0!==Ub.ErrorCode&&null!==Ub.ErrorCode||null==this.xzd||(Ub.ErrorCode=this.xzd);r.AFrameworkApplication.fa.wDf(Ub);this.Asd&&(this.Asd.instance||3===r.AFrameworkApplication.Aa.jb.rm&&
1===r.AFrameworkApplication.Aa.jb.rHa||u.a.instance.qb("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),this.Asd.execute(hc=>{r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OcvFeedbackvNextModalWacEnabled",!1)?v.UISurfaces.aaj().then(Wb=>{void 0!==Wb&&null!==Wb?(hc.mUj(Ub,Wb),h.ULS.sendTraceTag(8405838,356,100,"Opened OCV vNext Modal")):(h.ULS.sendTraceTag(520626707,356,15,"feedbackAPI not retrived"),hc.Pde(Ub));return Wb},()=>{h.ULS.sendTraceTag(520626706,
356,15,"error while retieving feedbackAPI");hc.Pde(Ub);return null}):hc.Pde(Ub)}))}return 32}}Object(J.a)(I,"CustomerFeedbackActor",null,[1228]);class H{constructor(ob,ac,pb){this.pPb=this.Kyd=!1;this.VO=this.i0e=null;this.X2a=ob;this.Txc=ac;this.Tg=pb}get Tg(){this.VO||(r.AFrameworkApplication.Tg||(r.AFrameworkApplication.Tg=new A.a),this.VO=r.AFrameworkApplication.Tg);return this.VO}set Tg(ob){this.VO=ob}Pde(ob){this.i0e=ob;this.qog()||this.h7b()}mUj(ob,ac){this.X2a.Edl(ob,ac)}h7b(){this.Kyd||(this.Kyd=
!0,this.Txc.zUd(Object(e.a)(this,this.Iik,"oFeedbackJsDownloadFinished")))}Iik(ob){ob?(this.pPb=!0,this.Tg.Feedback|=w.a.nSi,this.qog(),h.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.Tg.Feedback|=w.a.mSi,h.ULS.sendTraceTag(7611925,356,100,"CF - JS download failed"));this.Kyd=!1}qog(){return this.pPb?(this.X2a.Ffl(this.i0e),!0):!1}$Ag(ob){this.pPb=ob}}Object(J.a)(H,"CustomerFeedbackC3FormManager",null,[1283]);var L=d(17),E=d(656),aa=d(170),Q=d(232),O=d(280);class T{constructor(ob=
null){this.bif=null;this.Bwc=new L.a;this.TO=ob}zUd(ob){T.E6b()?this.Bwc.add(ob):this.bif=ob;var ac="Feedback/officebrowserfeedback_floodgate.js";E.a.eae()&&(ac="Feedback/latest/officebrowserfeedback_floodgate.js");ob="OFeedbackIntl";r.AFrameworkApplication.fa.Kw("IsServerFlavorDebug")&&r.AFrameworkApplication.fa.ka("IsServerFlavorDebug")&&(ob+=".debug");ob+=".js";ac=aa.a.OWb(ac);aa.a.esi(ob);ob=O.a.create(ac);ob.ZR(Object(e.a)(this,this.xnk,"onJsDownloadFinished"));Q.a.Kx(ob);h.ULS.sendTraceTag(7611929,
356,100,"CF - Downloading JS from: {0}",ac)}X2k(ob){this.TO?ob&&this.TO.add(ob):this.TO=ob}xnk(ob,ac){if(T.E6b()){for(ob=0;ob<this.Bwc.count;ob++)this.Bwc.ga(ob)(ac.succeeded,this.TO);this.Bwc.clear()}else this.bif(ac.succeeded,this.TO)}static E6b(){return!!r.AFrameworkApplication.Aa&&!!r.AFrameworkApplication.Aa.jb&&3===r.AFrameworkApplication.Aa.jb.rm&&1===r.AFrameworkApplication.Aa.jb.rHa}}Object(J.a)(T,"CustomerFeedbackResourceDownloadManager",null,[1282]);class K{constructor(){this.audienceGroup=
null;this.cwe=this.agb=0}tyg(){return!this.cwe}}Object(J.a)(K,"OCVData",null,[]);var X=d(119),P=d(197),ea=d(100);class ia extends Sys.EventArgs{constructor(ob){super();this.kkl=ob}}Object(J.a)(ia,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var ja=d(168),C=d(72),pa=d(194),Z=d(33),qa=d(233),ya=d(268),Ka=d(45),Da=d(990),la=d(77);class ma{constructor(ob,ac){this.mck="obf-MainContentHolder";this.aVj="obf-OverallSmileAnchor";this.WBl="obf-visible";this.hMb=this.gMb=ma.pfd;this.Cwd=this.Bwd=this.bP=!0;
this.E8e=this.zlb=this.lud=this.kud=this.Uuc=this.quc=this.bPb=!1;this.vuc=!0;this.Xyd=this.Byd=this.VO=this.S8c=this.bwd=this.MEd=null;this.FNh=r.AFrameworkApplication.fa.ka("FeedbackTabHandlerEnabled");this.Kd=ob;this.Tg=ac;this.Pa=new la.a;if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)){const Ub=this;u.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Wb=>{Wb.isFeatureEnabled("mso_sendASmile",
Ub.bP).then(fd=>{Ub.bP=fd;return null},()=>null);Wb.isFeatureEnabled("FloodgateSurvey",Ub.Uuc).then(fd=>{Ub.Uuc=fd;Ub.lud=!0;return null},()=>null)});const hc=this;u.a.instance.Ka("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(Wb=>{Wb.M2("IncludeScreenshot").then(fd=>{hc.bPb=fd;return null},()=>null);Wb.M2("IncludeEmail").then(fd=>{hc.quc=fd;hc.kud=!0;return null},()=>null)})}else{const Ub=this;u.a.instance.Ka("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(hc=>
{hc.M2("Enabled").then(Wb=>{Ub.bP=Wb;return null},()=>null);hc.M2("IncludeScreenshot").then(Wb=>{Ub.bPb=Wb;return null},()=>null);hc.M2("IncludeEmail").then(Wb=>{Ub.quc=Wb;Ub.kud=!0;return null},()=>null);hc.M2("SurveyEnabled").then(Wb=>{Ub.Uuc=Wb;Ub.lud=!0;return null},()=>null)})}if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForUpsell",!0)){this.zlb=r.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled");const Ub=this;u.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(hc=>
{Ub.zlb=hc.isFreemiumUpsellEnabled();hc.isFeatureEnabled("mso_sendASmile",!1).then(Wb=>{Ub.E8e=Wb;return null},()=>null)})}const pb=this;u.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ub=>{Ub.isFeatureEnabled("FeedbackForum",pb.vuc).then(hc=>{pb.vuc=hc;return null},()=>null)});const nb=this;u.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ub=>{Ub.isFeatureEnabled("FeedbackComplianceCannotConsent",nb.Bwd).then(hc=>{nb.Bwd=
hc;return null},()=>null)});const Tb=this;u.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(Ub=>{Ub.isFeatureEnabled("FeedbackComplianceCannotPartialConsent",Tb.Cwd).then(hc=>{Tb.Cwd=hc;return null},()=>null)});E.a.eae()?(this.MEd=aa.a.OWb("Feedback/latest/officebrowserfeedback.css"),this.bwd=aa.a.wPd("Feedback/latest/Intl/")):(this.MEd=aa.a.OWb("Feedback/officebrowserfeedback.css"),this.bwd=aa.a.wPd("Feedback/Intl/"))}get Tg(){this.VO||(r.AFrameworkApplication.Tg||
(r.AFrameworkApplication.Tg=new A.a),this.VO=r.AFrameworkApplication.Tg);return this.VO}set Tg(ob){this.VO=ob}get $de(){return this.Byd||(this.Byd=document.getElementById(this.aVj))}get x6c(){return this.Xyd||(this.Xyd=document.getElementById(this.mck))}o6h(ob){this.Pa.addHandler(ma.A_g,ob)}Uoi(){this.Xyd=this.Byd=null}FHj(ob){return!!ob&&0<=ob.className.toLowerCase().indexOf(this.WBl.toLowerCase())}Edl(ob,ac){r.AFrameworkApplication.sE?this.bP&&(h.ULS.sendTraceTag(520626705,356,15,"Feedback api retrieved"),
ob=ob||{},this.getContext(ob),ac.initializeFeedbackModal(ob,Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError")),h.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus."),this.Tg.Feedback|=w.a.z4f):h.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible")}Ffl(ob){if(!r.AFrameworkApplication.sE)h.ULS.sendTraceTag(520626704,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible");
else if(this.bP){ob=ob||{};this.getContext(ob);var ac=ma.LHi(ob.AppMode||"Unknown");Da.a.init(Object(e.a)(this,this.onDismiss,"onDismiss"),Object(e.a)(this,this.onError,"onError"),356,ac,ob);this.Ezj();ma.allowKeytips(!1);h.ULS.sendTraceTag(520488648,356,50,"Successfully opened feedback form and set focus.");this.Tg.Feedback|=w.a.z4f}}XSi(ob,ac){ac&&2>=ac.agb?((ac=r.AFrameworkApplication.fa.Ga("UserPrincipalName"))&&0<ac.length&&(ob.userEmail=ac),ob.userEmailConsentDefault=!0):ob.userEmail=""}L8f(ob){const ac=
{};if(void 0!==ob.appData&&null!==ob.appData){var pb=ob.appData;for(var nb in pb)ac[nb]=pb[nb]}ac.App=ob.Application||"";ac.AppMode=ob.AppMode||"";ac.AppModeExt=ob.ApplicationMode||"";ac.Host=ob.Host||"";ac.Language=ob.locale;ac.IsError=ob.Error||!1;ac.IsCrash=ob.Crash||!1;ac.ServerDocId=ob.ServerDocId||"";ob.ErrorCode&&""!==ob.ErrorCode.toString()&&(ac.IsError=!0);"Origin"in ob&&(ac.Origin=ob.Origin);ac.ClientThrottlingProtection=this.Tg.ClientThrottlingProtection||"";ac.HostServiceLevel=this.Tg.HostServiceLevel||
"";ac.RequestedCallThrottling=this.Tg.RequestedCallThrottling||"";ac.WacServiceLevel=this.Tg.WacServiceLevel||"";this.Tg.HostResponseStats&&(pb=this.Tg.HostResponseStats.Label)&&(ac.HostFarmHint=pb);pb=r.AFrameworkApplication.fa;(nb=pb.Ga(r.AFrameworkApplication.FJ))&&""!==nb&&(ac.UiHost=nb);(nb=pb.Ga(r.AFrameworkApplication.GBh))&&""!==nb&&(ac.UiHostIntegrationType=nb);pb.ka("OcvFeedbackIncludesSessionOriginIsEnabled")&&(pb=ob.SessionOrigin,pb&&""!==pb||(ob=ob.SourceControlId)&&""!==ob&&qa.a(qa.d(ob),
"feedback")&&(pb=this.x$f().SessionOrigin),pb&&""!==pb&&(ac.SessionOrigin=pb));ob=null;try{ob=Z.c(ac),ob=Ka.a.Oba(ob,Ka.a.gxb)}catch(Tb){ob="",h.ULS.sendTraceTag(520644571,356,10,"Exception trying to serialize appData:"+Tb.message)}return{["appData"]:ob||""}}f3i(ob){const ac={};for(let pb in ob)ac[pb]=ob[pb];ac.IsFreemiumUpsellEnabled=this.zlb;ac.IsAadcEnabled=this.E8e;ac.IsFeedbackEnabled=this.bP;return ac}i3i(){let ob=null;try{const ac=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.WebSurfacesSettings",
null);ac&&(ob=Z.b(ac))}catch(ac){h.ULS.sendTraceTag(543520794,356,10,"Could not deserialize WebSurfacesSettingsJson")}return ob||{}}O1i(ob,ac){if(ob&&ac){ob.LanguageID?ob.locale=ya.a.oe(ob.LanguageID).name||"":ob.ApplicationLCID&&(ob.locale=ob.ApplicationLCID);ob.applicationGroup=this.L8f(ob);ob.applicationSettings=this.f3i(r.AFrameworkApplication.fa.appSettings);ob.webSurfacesSettings=this.i3i();ma.vYf(ac,ob);ob.appId=ma.QHi();ob.environment=ac.cwe;ob.stylesUrl=this.MEd;ob.intlUrl=this.bwd;ob.rtl=
r.AFrameworkApplication.fa.ka("Rtl")?"rtl":"ltr";var pb=ma.PHi();ob.primaryColour=pb.primaryColour;ob.secondaryColour=pb.secondaryColour;ob.sessionId=ob.SessionID||ob.WACSessionID||"";ob.build=ob.ApplicationVersion||ob.WFEVersion||"";pb=ob.FlightIDs?ob.FlightIDs.toString():ob.Flights?ob.Flights.toString():"";var nb="";ob.ErrorCode&&(nb=ob.ErrorCode.toString());var Tb=this.gbj(ob),Ub=ac.tyg()?r.AFrameworkApplication.fa.Ga("TenantId"):"";Ub&&"0"!==Ub||(Ub="");var hc=r.AFrameworkApplication.fa.Ga("LoggableUserIdSpace"),
Wb=r.AFrameworkApplication.fa.Ga("LoggableUserId")||"";switch(hc){case "MsaPuid":Wb="p:"+Wb;break;case "MsaCid":Wb="m:"+Wb;break;case "OrgIdPuid":Wb="a:"+(r.AFrameworkApplication.fa.Ga("AADUserObjectId")||Wb);break;default:h.ULS.sendTraceTag(575415951,356,50,"Unknown LoggableUserIdSpace. LoggableUserId: "+Wb+", LoggableUserIdSpace: "+hc),Wb=""}hc={};if(void 0!==ob.telemetryGroup&&null!==ob.telemetryGroup){const fd=ob.telemetryGroup;for(let fc in fd)hc[fc]=fd[fc]}hc.audienceGroup=ac.audienceGroup;
hc.audience=ac.audienceGroup;hc.flights=pb;hc.platform=Tb;hc.ringId=ac.agb;hc.officeUILang=r.AFrameworkApplication.lcid;hc.errorCode=nb;hc.loggableUserId=Wb;hc.processSessionId=ob.SessionID||ob.WACSessionID||"";hc.officeBuild=ob.ApplicationVersion||ob.WFEVersion||"";0<Ub.length&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==Ub&&(hc.tenantId=Ub);ob.telemetryGroup=hc;ob.webGroup={["browser"]:ob.Browser||"",["browserVersion"]:(ob.BrowserMajorVersion||"")+"."+(ob.BrowserMinorVersion||""),["dataCenter"]:ob.Datacenter||
ob.WACDatacenter||""};ob.isCommercialHost=r.AFrameworkApplication.fa.ka("IsO365CommercialHost");this.JHi(ob);ob.disableIncludeScreenshot=!this.bPb;ob.screenshot=this.bPb;ob.showEmailAddress=this.quc;ob.emailPolicyValue=this.quc?1:0;ob.screenshotPolicyValue=this.bPb?1:0;r.AFrameworkApplication.fa.ka("IsO365CommercialHost")||(ob.disableIncludeScreenshot=!1,ob.showEmailAddress=!0,ob.screenshot=!0);r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",
!1)&&(ob.surveyEnabled=this.Uuc,r.AFrameworkApplication.fa.ka("IsO365ConsumerHost")&&(ob.showEmailAddress=!0,ob.surveyEnabled=!0));this.XSi(ob,ac);this.S8c=ob.DismissHandler?ob.DismissHandler:null;this.HHi(ob)}}Abi(){return this.kud&&this.lud}getContext(ob){ob=ob||this.x$f();const ac=new K;this.O1i(ob,ac);return ob}gbj(ob){let ac="";ob.Platform&&(ac=ob.Platform.toString());ob.PlatformMajorVersion&&(0<ac.length&&(ac+=" "),ac+=ob.PlatformMajorVersion.toString()+".");ob.PlatformMinorVersion&&(ac+=ob.PlatformMinorVersion.toString());
return ac}zil(ob){ob.ApplicationMode&&(ob.AppMode=ob.ApplicationMode);ob.ApplicationModeExtended&&(ob.ApplicationMode=ob.ApplicationModeExtended)}x$f(){let ob;try{ob=Z.b(r.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),this.zil(ob)}catch(ac){h.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),ob={}}return ob}onError(ob){h.ULS.sendTraceTag(37259477,356,10,"FB submit error: "+ob);this.Tg.Feedback|=w.a.lSi;ma.allowKeytips(!0)}YJi(){if(ma.gxg()){h.ULS.sendTraceTag(40112215,
356,50,ma.IXg);var ob=u.a.instance.resolve("Common.ISystemInitiatedFeedback");ob&&ob.logActivity("AppUsageNPSLocalizationTest",null)}}onDismiss(ob){this.Nma();this.Uoi();ja.a.gDb()&&h.ULS.sendTraceTag(34936718,356,50,"FB dismiss");ja.a.cTa()&&ea.c(ob?F.a.iSi:F.a.dSi,!0,null,2,8);ob?(ja.a.gDb()&&h.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.Tg.Feedback|=w.a.oSi):(this.Tg.Feedback|=w.a.kSi,this.YJi());this.Pa.raiseEvent(ma.A_g,new ia(ob));ma.allowKeytips(!0);this.S8c&&(this.S8c(),this.S8c=null)}Ezj(){if(this.Kd){let ob=
!1,ac=5,pb=!1;this.hMb=this.clearInterval(this.hMb);this.gMb=this.clearInterval(this.gMb);this.gMb=window.setInterval(()=>{if(this.$de){pb=!0;var nb=this.Kd.Dc(ma.f5a);nb.cL=!0;nb.parent=X.AFrame.jj;nb.r3a(ma.$Ei);nb.bba(()=>{let Tb=this.Kd.SP(ma.f5a),Ub=null,hc=5,Wb=!1;this.hMb=window.setInterval(()=>{this.FHj(this.x6c)&&(Wb=!0,this.$de.focus(),Tb||(Tb=this.Kd.SP(ma.f5a)),Tb&&!Ub&&(Ub=Tb.uj),Ub&&Ub.wE(this.$de));hc--;if(Wb||!hc)this.hMb=this.clearInterval(this.hMb)},1E3)});ob||(this.Kd.NX(ma.f5a,
!0),ob=!0);this.FNh&&this.x6c&&(nb=new P.DOMFocusListing(()=>this.x6c),nb.vo(1),nb.vo(2),nb.vo(3),nb.vo(5),nb=this.Kd.Jha(()=>this.x6c,this.Kd.Dc(ma.f5a),nb),nb.xfb(),nb.DW=!0,nb.IOa=!0,nb.PVg())}ac--;if(pb||!ac)this.gMb=this.clearInterval(this.gMb)},1E3)}}clearInterval(ob){ob!==ma.pfd&&(window.clearInterval(ob),ob=ma.pfd);return ob}Nma(){this.Kd&&(this.Kd.R4(ma.f5a),this.Kd.MFb(ma.f5a))}HHi(ob){this.Bwd?this.Cwd||(ob.ageGroup=4):ob.ageGroup=3;r.AFrameworkApplication.fa.ka("IsAnonymousUser")?ob.authenticationType=
2:ob.authenticationType="aad"===r.AFrameworkApplication.fa.Ga("HostAuthType")?1:0}JHi(ob){this.vuc&&(ob.myFeedbackForumUrl="https://go.microsoft.com/fwlink/?linkid=2171883",ob.MyFeedbackPortalUrl="https://go.microsoft.com/fwlink/?linkid=2171883");if(this.vuc){const ac=ma.KHi();void 0!==ac&&null!==ac&&(ob.feedbackPortalUrl=ac,ob.feedbackForumUrl=ac)}}static allowKeytips(ob){r.AFrameworkApplication.Aa.jb.Do&&C.a("allowKeytips")&&appChrome.api.allowKeytips(ob)}static vYf(ob,ac){if(ac){ob.agb=parseInt(ac.Ring);
if(isNaN(ob.agb))ob.audienceGroup="Unknown",ob.agb=-2;else switch(ob.agb){case 0:case 1:ob.audienceGroup="Dogfood";break;case 2:ob.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:ob.audienceGroup="Production";break;default:ob.audienceGroup="Unknown"}var pb=!0;ac.Host&&(pb="MsInternal"!==ac.Host&&"Blue Chicken"!==ac.Host);ob.cwe=pb?0:1}}static QHi(){let ob=0;switch(pa.Redirect.application){case 2:ob=2155;break;case 4:ob=2158;break;case 3:ob=2157;break;case 1:ob=2156;break;case 5:ob=2159;
break;default:h.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",pa.Redirect.application.toString())}return ob}static PHi(){const ob={};let ac="#2B579A",pb="#3C65A4";switch(pa.Redirect.application){case 2:r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.ka("AppColorUpdateIsEnabled")?(ac="#185ABD",pb="#2E6AC5"):(ac="#2B579A",pb="#3C65A4");break;case 4:ac="#7719AA";pb="#9953C0";break;case 3:ac="#B7472A";pb="#C75033";break;case 1:ac="#217346";pb="#3F8159";break;case 5:ac="#3955A3";
pb="#4D6AB8";break;default:h.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",pa.Redirect.application.toString())}ob.primaryColour=ac;ob.secondaryColour=pb;return ob}static KHi(){let ob=null;switch(pa.Redirect.application){case 2:ob="https://go.microsoft.com/fwlink/?linkid=2170869&clcid=0x409";break;case 4:ob="https://go.microsoft.com/fwlink/?linkid=2172997&clcid=0x409";break;case 3:ob="https://go.microsoft.com/fwlink/?linkid=2171000&clcid=0x409";break;case 1:ob="https://go.microsoft.com/fwlink/?linkid=2170798&clcid=0x409";
break;case 5:ob="https://go.microsoft.com/fwlink/?linkid=2173231&clcid=0x409";break;default:h.ULS.sendTraceTag(540577997,356,10,"Unexpected Application: {0}",pa.Redirect.application.toString())}return ob}static LHi(ob){let ac=356;switch(pa.Redirect.application){case 2:switch(ob){case "Edit":ac=364;break;case "View":case "Attendee":case "Presenter":ac=363;break;default:h.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",r.AFrameworkApplication.Aa.nWa),
ac=363}break;case 4:ac=362;break;case 3:switch(ob){case "Edit":ac=361;break;case "View":case "Attendee":case "Presenter":case "Outline":case "":ac=360;break;default:h.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",r.AFrameworkApplication.Aa.nWa),ac=360}break;case 1:switch(ob){case "Edit":ac=358;break;case "View":ac=357;break;case "Survey":ac=359;break;default:h.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",
r.AFrameworkApplication.Aa.nWa),ac=357}break;case 5:switch(ob){case "View":ac=373;break;case "Edit":ac=374;break;default:h.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",r.AFrameworkApplication.Aa.nWa),ac=373}break;default:h.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",pa.Redirect.application.toString())}return ac}static $Ei(){h.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")}static gxg(){if(!ma.Sve){const ob=
!!r.AFrameworkApplication.fa&&r.AFrameworkApplication.fa.ka(ma.IXg);ma.Sve=ob?2:1}return 2===ma.Sve}}ma.f5a="CustomerFeedbackFocusId";ma.A_g="FUID";ma.pfd=-1;ma.Sve=0;ma.IXg="NPSLocalizationTestingIsEnabled";Object(J.a)(ma,"CustomerFeedbackUiWrapper",null,[1281]);var Ea=d(14),ta=d(1167),Ga=d(1168);class oa{constructor(ob,ac,pb,nb){this.FZe=ob;this.Ofa=ac;this.EZe=pb;this.nTh=nb}activityName(){return this.Ofa}object(){return this.nTh}}Object(J.a)(oa,"OneCallBackData",null,[]);class sa{constructor(ob,
ac,pb,nb){this.$Ka=[];Array.add(this.$Ka,new oa(ob,ac,pb,nb))}add(ob){ob&&Array.addRange(this.$Ka,ob.$Ka)}Woi(){Array.clear(this.$Ka)}}Object(J.a)(sa,"CallBackData",null,[]);var Ha=d(657);class bb extends Ha.a{constructor(ob,ac,pb=null,nb=!1,Tb=!1,Ub=null,hc=null,Wb=null){super("FloodgateTeachingCallout");this.image=this.footer=this.message=this.smallHeadline=this.title=null;this.positionImageAtLeft=!1;this.secondaryButtonProps=this.primaryButtonProps=null;this.footer=ob;this.message=ac;this.image=
pb;this.positionImageAtLeft=nb;this.smallHeadline=Tb;this.title=Ub;this.primaryButtonProps=hc;this.secondaryButtonProps=Wb}}Object(J.a)(bb,"FloodgateCalloutContent",Ha.a,[]);class Ya{constructor(){this.a$g=this.options=null}}Object(J.a)(Ya,"Notification",null,[]);var ua=d(1085),Ma=d(911),Ca=d(340);class Va extends Ha.a{constructor(ob,ac,pb=null,nb=null){super("PremiumUpsellCallout");this.imageHeight=this.imageProps=this.content=this.title=null;this.title=ob;this.content=ac;this.imageProps=pb;this.imageHeight=
nb}}Object(J.a)(Va,"PremiumUpsellCalloutContentProps",Ha.a,[]);var Za=d(912);class Db{constructor(ob){this.alt=this.ariaLabel=this.src=null;this.src=ob}}Object(J.a)(Db,"ImageProps",null,[]);class Lb{static mQd(ob){return Lb.jcj().then(ac=>{try{const pb=[];for(let nb=0;nb<ob.length;nb++){const Tb=ob[nb],Ub=Lb.xQj(Tb.surfaceType),hc=new Ya;hc.options=Lb.Q$i(Tb,!Ub);hc.a$g=Ub?ac.callout(Lb.Ack(ob[nb])):ac.externalNotification();pb.push(hc)}return Lb.Ndl(ac,pb)}catch(pb){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+
pb.message);}})}static xQj(ob){switch(ob.toLowerCase()){case "teaching":case "coachmark":case "sequence":case "premiumupsell":return!0;default:return!1}}static Q$i(ob,ac){const pb=new Ca.a;ac&&(pb.onShow=ob.onUnsupportedSurfaceType);pb.telemetryId="FloodgateTeachingUx-Surface"+(ac?"NotSupported":"Supported");return pb}static Ack(ob){var ac="premiumupsell"!==ob.surfaceType.toLowerCase()?new bb(ob.footer,ob.description,ob.illustrationImage?Object.assign(new Db(ob.illustrationImage),{ariaLabel:ob.imageAriaLabel}):
null,"left"===ob.position,ob.smallHeadline,ob.title,Lb.qMc(ob.primaryButtonText,ob.primaryButtonAction),Lb.qMc(ob.secondaryButtonText,ob.secondaryButtonAction)):new Va(ob.title,ob.description,ob.illustrationImage?Object.assign(new Db(ob.illustrationImage),{ariaLabel:ob.imageAriaLabel}):null);ac=Object.assign(new Ma.a,{target:ob.selector,content:ac,showCloseIcon:null!=ob.hasCloseButton?ob.hasCloseButton:!0,preventLightDismiss:null!=ob.preventAutoDismiss?ob.preventAutoDismiss:!1,useTeachingStyles:!0,
calloutProps:Object.assign(new Za.a,{onDismiss:()=>{if(ob.onClosed)ob.onClosed("close")},directionalHint:ob.anchorHint,setInitialFocus:!0})});"coachmark"===ob.surfaceType.toLowerCase()?(ac.hasDynamicSizing=!1,ac.useCoachmark=!0,ac.calloutProps.setInitialFocus=!1):"premiumupsell"===ob.surfaceType.toLowerCase()&&(ac.primaryButtonProps=Lb.qMc(ob.primaryButtonText,ob.primaryButtonAction),ac.secondaryButtonProps=Lb.qMc(ob.secondaryButtonText,ob.secondaryButtonAction),ac.showCloseIcon=!1,ac.useTeachingStyles=
!1,ac.calloutProps.preventDismissOnLostFocus=!1);return ac}static qMc(ob,ac){return ob&&""!==ob&&ac?Object.assign(new ua.a,{label:ob,onExecute:ac}):(h.ULS.shipAssertTag(594569111,356,(!ob||""===ob)&&!ac,"A callout button needs both a caption and an action."),null)}static jcj(){Lb.fLc||(r.AFrameworkApplication.Aa.jb.MSa&&r.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled")?Lb.fLc=v.UISurfaces.gN().then(ob=>{const ac=new bb(null,null);if(ob.isCustomContentSupported&&ob.isCustomContentSupported(ac))return ob;
throw Error.create("Custom Content not supported: "+ac.type);},ob=>{h.ULS.sendTraceTag(593352343,383,15,"Failed to GetNotificationsAPIAsync: {0}",ob);return null}):Lb.fLc=Promise.reject("React Notifications not enabled"));return Lb.fLc}static Ndl(ob,ac){if(!ac||!ac.length)return[];const pb=[];for(let nb=0;nb<ac.length;nb++){const Tb=Lb.Fel(ob,ac[nb]);pb.push(Tb)}return pb}static Fel(ob,ac){const pb=ob.addNotification(ac.a$g,ac.options);return()=>{ob.removeNotification(pb)}}}Lb.fLc=null;Object(J.a)(Lb,
"FloodgateNotifications",null,[]);const yb=(ob,ac)=>{ob=r.AFrameworkApplication.fa.Ga("UserPrincipalName");if(ac=!!ac.YXg&&2===ac.YXg.agb)ac=(ac=ob.toLowerCase())?0<ac.indexOf("linkedin.com")||0<ac.indexOf("linkedin.biz"):!1;return ac};class Bc{constructor(ob,ac){this.YXg=ob;this.context=ac}}Object(J.a)(Bc,"SurveyMetadata",null,[]);var tb=d(65),Mb=d(269),Hb=d(90),vb=d(78);class Xb{constructor(ob){this.sSa=this.isInitialized=!1;this.fia=this.Ljb=null;this.e_a=!1;this.MQe=null;this.lvg=!1;this.GHc=
0;this.oXf=-1;this.YAe=this.FHc=null;this.e3b=!0;this.HP=ob;this.Xnc={};this.pJf=!1;this.lGb=this.oa=null;this.eLc=0}aBj(ob){this.isInitialized&&this.Ljb||this.sSa?h.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."):null===ob?h.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"):(this.e_a=ob.e_a,h.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"))}RAj(){const ob=
this.HP.getContext(null),ac=new K;ma.vYf(ac,ob);this.MQe=new Bc(ac,ob);this.lGb=new Ea.ScriptSharpLegacyMap;this.lGb.$("LinkedInWACUsage",yb)}get Dob(){this.Ljb||(this.Ljb=u.a.instance.qb("Common.App.IAppSpecificFeedbackData"));return this.Ljb}logActivity(ob,ac,pb=null){ob&&this.n6a(ob,Xb.kdb,ac)&&(this.isInitialized?(h.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+ob),Da.a.logActivity(ob,pb)):(h.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+ob),this.m8d(new sa(Da.a.logActivity,
ob,null,pb))))}Aee(ob){try{r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogTriggerActivityName",!1)&&h.ULS.sendTraceTag(520140175,356,50,"Trigger Activity Name: "+ob),-1===this.oXf&&(this.oXf=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.DeferredActivityDelayInMilliSeconds",Xb.SWf)),this.FHc||(this.FHc=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDeferredActivityAllowedList"," ").toString().toLowerCase()),
!r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowAllTriggerActivities",!0)&&this.FHc&&ob&&ob.startsWith("Ribbon_")&&-1===this.FHc.indexOf(ob.toLowerCase())?h.ULS.sendTraceTag(527247310,356,100,"SIFB: LogActivityDeferred activity ignored"):this.isInitialized?(0<this.GHc&&r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClearNearActivityTimeouts",!1)&&(window.clearTimeout(this.GHc),h.ULS.sendTraceTag(592217693,356,50,"SIFB: LogActivityDeferred cancelled "+
ob)),this.GHc=window.setTimeout(()=>{this.GHc=0;this.logActivity(ob,null)},Xb.SWf)):h.ULS.sendTraceTag(592217692,356,50,"SIFB: LogActivityDeferred called before initialization "+ob)}catch(ac){h.ULS.sendTraceTag(527247311,356,10,"SIFB: LogActivityDeferred activity failed: "+(ac?ac.toString():""))}}l7b(ob,ac){ob&&this.n6a(ob,Xb.kdb,ac)&&(this.XCg(ob,ac),this.Xnc[ob]=ac)}XCg(ob,ac){this.n6a(ob,Xb.kdb,ac)&&(this.isInitialized?(h.ULS.sendTraceTag(37754501,356,50,"SIFB: LogActivityStartInternal "+ob),Da.a.l7b(ob,
null)):(h.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+ob),this.m8d(new sa(Da.a.l7b,ob,null,null))))}VCg(ob){ob&&this.isInitialized&&this.n6a(ob,Xb.kdb,void 0)&&(ob in this.Xnc&&delete this.Xnc[ob],this.WCg(ob,void 0))}WCg(ob,ac){this.isInitialized&&this.n6a(ob,Xb.kdb,ac)&&(h.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+ob),Da.a.VCg(ob))}yIb(ob,ac){if(this.n6a(ob,Xb.kdb,ac))if(this.Dob){if(ac=this.Dob.l4d(ob))this.isInitialized?(h.ULS.sendTraceTag(38605911,
356,50,"SIFB:ShowUserInitiatedSurvey "+ob),Da.a.yIb(ac)):(h.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+ob),this.m8d(new sa(null,null,Da.a.yIb,ac)))}else h.ULS.sendTraceTag(556896919,356,10,"AppSpecificFeedbackData is null")}n6a(ob,ac,pb){if(this.sSa)return!1;if(!r.AFrameworkApplication.sE)return h.ULS.sendTraceTag(37601796,356,50,"SIFB: All feedback/floodgate is disabled"),!1;if(!this.zIj())return!1;this.Yxi();return(this.rHj(ob)||this.MEi(ob)||this.$Dj(ob))&&
this.$ei(ac,pb)&&this.Nkl(ob)}Yxi(){if(!this.Ljb){const ob=u.a.instance.qb("Common.App.IAppSpecificFeedbackData");ob?this.Ljb=ob:h.ULS.sendTraceTag(589641477,356,10,"SIFB.Error:IAppSpecificFeedbackData not found in the container")}}AIj(ob){return 6!==ob}zIj(){if(0===this.eLc){const ob=this.HP.getContext(null);this.eLc=this.AIj(parseInt(ob.Ring))?1:2;2===this.eLc&&h.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.eLc}Nkl(ob){null===this.lGb&&this.RAj();
return ob&&this.lGb&&this.lGb.Jb(ob)?this.lGb.ga(ob)(ob,this.MQe):!0}$2i(){if(!this.fia&&!this.pJf){this.pJf=!0;const ob=this.HP.getContext(null);this.fia="locale"in ob?ob.locale:"";this.fia=this.fia.toLowerCase()}return this.fia}MEi(ob){this.fia||(this.fia=this.$2i());if(!(this.fia&&this.fia.length&&ob&&ob.length))return!1;let ac="en-us"===this.fia||this.BLj(ob)||ma.gxg();!ac&&this.qLj(ob)&&(ac=this.rLj(this.fia));return ac}qLj(ob){return this.Dob?"AppUsageNPS"===ob||"AppUsageTimeSatisfiedNPS"===
ob||"SuiteUsageNPS"===ob||"SuiteUsageTimeSatisfiedNPS"===ob:(h.ULS.sendTraceTag(593769179,356,10,"SIFB:IsNPSActivity AppSpecificFeedbackData was null. activityName: "+ob),!1)}rHj(ob){return!!ob&&-1!==ob.toLowerCase().indexOf("floodgateflight")}BLj(ob){return!!ob&&-1!==ob.toLowerCase().indexOf("nlqs")}rLj(ob){if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAllNpsLanguages",!1))return!0;if(!ob||!ob.length)return!1;if(!r.AFrameworkApplication.fa.ka("WacNPSLocalizedLanguagesEnabled"))return"en-us"===
ob;let ac=!1;switch(ob){case "en-us":case "es-es":case "ja-jp":case "en-gb":case "pt-br":case "nl-nl":case "de-de":case "fr-fr":case "sv-se":case "fi-fi":case "nb-no":case "da-dk":case "ru-ru":case "es-mx":case "pl-pl":case "zh-cn":case "zh-tw":case "it-it":case "ko-kr":ac=!0}return ac}$ei(ob,ac){return r.AFrameworkApplication.fa.ka(ob)?ac&&!r.AFrameworkApplication.fa.ka(ac)?(h.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+ac+") is off"),!1):!0:(h.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+
ob+") is off"),!1)}$Dj(ob){const ac=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.AllowedCampaignActivities","ShowFirstRunExperienceUIV2");return!!ob&&!!ac&&-1!==ac.toLowerCase().indexOf(ob.toLowerCase())}m8d(ob){if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1))r.AFrameworkApplication.fa.ff(()=>{try{this.SIc(ob)}catch(ac){h.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+
ac)}});else try{this.SIc(ob)}catch(ac){h.ULS.sendTraceTag(574997505,356,10,"SIFB.Error:Download and initialize failed "+ac)}}rfc(){this.e_a||this.start()}esk(){this.e_a||this.stop()}GPe(){this.e_a&&this.start()}xjl(){this.e_a&&this.stop()}start(){h.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized);if(this.isInitialized)if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStart",!1)){const ob=vb.a.RGc(r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateAfterIdleCallbackDelayMs",
10),Object(e.a)(this,this.evh,"startSurvey"),r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateDelayStartIdleOverrideMs",1E3));r.AFrameworkApplication.pe.Cb(ob)}else this.evh(null)}evh(){Da.a.GVi();this.kol()}stop(){h.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized);this.isInitialized&&(this.jol(),Da.a.HVi())}kol(){const ob=this.Xnc;for(let ac in ob)this.XCg(ac,ob[ac])}jol(){const ob=this.Xnc;for(let ac in ob)this.WCg(ac,ob[ac])}SIc(ob){h.ULS.sendTraceTag(36546388,
356,100,"SIFB: Entered DownloadResources");var ac=u.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");ac&&(ac.pPb?this.w6f(!0,ob):(ac=u.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),ac.X2k(ob),ac.zUd(Object(e.a)(this,this.w6f,"floodgateJsDownloadFinished"))))}w6f(ob,ac){h.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+ob);let pb="";ac&&ac.$Ka&&0<ac.$Ka.length&&(pb=ac.$Ka[0].activityName());
if(ob)if(E.a.eae())if(this.isInitialized)this.kUd(ac);else{if(this.sSa||!this.YAe)this.YAe=this.r7g();this.YAe.then(()=>{this.kUd(ac)}).catch(nb=>this.s7g(pb,nb))}else this.r7g().then(()=>{this.kUd(ac)}).catch(nb=>this.s7g(pb,nb));else this.sSa=!0,h.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+pb)}s7g(ob,ac){this.sSa=!0;h.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+ob+". "+ac.toString())}IVi(ob){this.oa||this.XAj();let ac=
ob;ob&&0<ob.length&&(ac=this.oa&&this.oa.Jb(ob)?this.oa.ga(ob):ob);return ac?ac:""}r7g(){var ob=u.a.instance.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager");ob&&ob.$Ag(!0);this.q9k();this.R8k();this.initOptions();if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&r.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return this.OZi().then(ac=>{this.Iee(ac);return ac}).then(ac=>Da.a.a8d(Object(e.a)(this,
this.zye,"onSIFeedbackDismiss"),Object(e.a)(this.HP,this.HP.onError,"onError"),ac,Object(e.a)(this.HP,this.HP.onDismiss,"onDismiss")));if(r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&r.AFrameworkApplication.fa.ka("IsO365CommercialHost")&&r.AFrameworkApplication.fa.ka("OcpsIsEnabled"))return Xb.pGi(this.acg()).then(()=>{const ac=this.uZd();this.Iee(ac);return ac}).then(ac=>Da.a.a8d(Object(e.a)(this,this.zye,"onSIFeedbackDismiss"),
Object(e.a)(this.HP,this.HP.onError,"onError"),ac,Object(e.a)(this.HP,this.HP.onDismiss,"onDismiss")));ob=this.uZd();this.Iee(ob);return Da.a.a8d(Object(e.a)(this,this.zye,"onSIFeedbackDismiss"),Object(e.a)(this.HP,this.HP.onError,"onError"),ob,Object(e.a)(this.HP,this.HP.onDismiss,"onDismiss"))}OZi(){return new Promise(ob=>{u.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(ac=>{const pb=this.uZd();ac.isFeatureEnabled("FloodgateSurvey",!0).then(nb=>{pb.surveyEnabled=
"surveyEnabled"in pb?nb&&pb.surveyEnabled:nb;ob(pb);return null},nb=>{h.ULS.sendTraceTag(555857947,356,15,"GetAllContextForFloodgatePromise Error {0}",nb.toString());ob(pb);return null})})})}h3i(){let ob=null;try{const ac=r.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.MessagingServiceSettings",null);ac&&(ob=Z.b(ac))}catch(ac){h.ULS.sendTraceTag(540285072,356,10,"Could not deserialize MessagingServiceSettingsJson")}return ob||{}}uZd(){const ob=this.HP.getContext(null);
ob.FloodgateUIAutoDismissTimeEnum=this.B_i();ob.uIStringGetter=Object(e.a)(this,this.IVi,"floodgateUIStringGetter");ob.authTokenCallback=Xb.eyi(Object(m.a)(String,ob.AudienceGroup));ob.augLoopCallback=Xb.cyi();ob.onTeachingCampaignRender=Xb.mQd;ob.governanceServiceEnabled=Xb.ubg();ob.governanceServiceConfig=Xb.l6i();ob.personalizerEnabled=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",!1);ob.messagingServiceSettings=this.h3i();ob.isPriorityEnabled=
Xb.Jbj();return ob}Iee(ob){const ac=this.HP.Abi(),pb=this.acg(),nb=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1),Tb=r.AFrameworkApplication.fa.ka("IsO365CommercialHost"),Ub=r.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),hc=r.AFrameworkApplication.fa.ka("OcpsIsEnabled"),Wb="surveyEnabled"in ob?ob.surveyEnabled:"null or undefined",fd="showEmailAddress"in ob?ob.showEmailAddress:"null or undefined",fc=Xb.ubg(),bc=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePersonalizerEnabled",
!1);h.ULS.sendTraceTag(575947136,356,50,'"Info": "SIFB Info: Floodgate SDK will init.", "OcpsPoliciesSet": "{0}", "FGAdminControlsEnabled": "{1}", "IsO365CommercialHost": "{2}", "IsO365ConsumerHost": "{3}", "OcpsIsEnabled": "{4}", "FGInitDelayTime": "{5}", "ShowEmailAddress": "{6}", "surveyEnabled": "{7}", "governanceServiceEnabled": "{8}", "governanceServiceConfig": "{9}", "personalizerEnabled": "{10}"',ac,nb,Tb,Ub,hc,pb,fd,Wb,fc,Z.c(ob.governanceServiceConfig),bc)}B_i(){return yb(null,this.MQe)?
(h.ULS.sendTraceTag(593278928,356,50,"SIFB Info:LinkedIn - Floodgate AutoDismissTimeEnum:0"),0):r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgatePromptAutoDismissEnum",r.AFrameworkApplication.fa.Cc("FloodgateUIAutoDismissTimeEnum",2))}acg(){return r.AFrameworkApplication.fa.Cc("FloodgateContextAndInitDelayInMilliSeconds",Xb.VFi)}kUd(ob){this.isInitialized=!0;this.E4h();Da.a.B3k(Object(e.a)(this,this.x_j,"logTriggerEvent"));if(ob){for(const ac of ob.$Ka)ac.FZe?(0,ac.FZe)(ac.activityName(),
ac.object()):ac.EZe?(0,ac.EZe)(ac.object()):h.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null");ob.Woi()}else h.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{const ac=this.HP.getContext(null),pb=Da.a.abg(Array.isArray(ac.Flights)?ac.Flights:null),nb=pb?Object(m.a)(String,pb.SelfTriggerActivity):null;if(nb)for(const Tb of nb.split(";"))Tb&&""!==Tb&&this.logActivity(Tb,null)}catch(ac){h.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+
(ac?ac.toString():""))}}E4h(){if(!this.lvg&&window.addEventListener){const ob=Object(e.a)(this,this.bsk,"onWebCampaignEvent");window.addEventListener("FGWebSurfaceEvent",ob,!0);this.lvg=!0}}dDg(ob,ac){ob&&(r.AFrameworkApplication.Wj(ob),r.AFrameworkApplication.s7b(ob));h.ULS.sendTraceTag(50704975,306,50,"Web Campaign UI launched. "+ac)}GGj(ob){if(!ob)return!1;try{const ac=(r.AFrameworkApplication.fa.Ga("FlightId")||"").toLocaleLowerCase(),pb=ob.toString().toLocaleLowerCase().split(";");for(const nb of pb)if(2<
nb.length&&(nb.lastIndexOf("-control")===nb.length-8||nb.lastIndexOf("cf")===nb.length-2&&-1!==ac.indexOf(nb)))return!0}catch(ac){h.ULS.sendTraceTag(512505555,306,50,"Error serializing campaign event -"+(ac?ac.toString():""))}return!1}x_j(ob,ac){ac=ac||{};if(ob&&!("isControl"in ac)){const pb=this.GGj(ob);pb&&(ac.isControl=pb)}this.dDg(ob,JSON.stringify(ac))}bsk(ob){if(ob=ob?ob.detail:null){var ac=!r.AFrameworkApplication.fa.ka("WacFloodgateNotificationsIntegrationIsEnabled"),pb=(ob.action||"").toLowerCase();
switch(pb){case "dismissed":ac&&Mb.a.instance.zo("obf-DynamicWebSurfaces");break;case "updated":ac&&Da.a.Upa("obf-DynamicWebSurfaces");break;case "opened":case "":pb=ob.telemetryEventName;let nb;try{nb=JSON.stringify(ob)}catch(Tb){nb="id : "+ob.id+" telemetryEventName: "+pb,h.ULS.sendTraceTag(51131789,306,50,"Error serializing campaign event. "+nb+" Error: "+(Tb?Tb.toString():""))}ob.success?this.dDg(pb,nb):h.ULS.sendTraceTag(50422098,306,10,"Error launching Web Campaign UI."+nb);ob.isHidden||ob.isAA||
!ac||Da.a.Upa("obf-DynamicWebSurfaces");break;default:h.ULS.sendTraceTag(594626399,306,50,"Unrecognized action "+pb)}}}frl(ob){var ac=["Live"];if(!ob)return null;try{const pb=Z.b(ob),nb=new L.a;for(const Tb of pb){const Ub=Tb.Tags;if(Ub)for(const hc of ac)Array.contains(Ub,hc)&&nb.add(Tb)}return Z.c(nb.toArray())}catch(pb){return h.ULS.sendTraceTag(523904348,356,10,"Could not deserialize CampaignDefinitionsJson"),null}}q9k(){let ob=!1,ac=null;const pb=this.ZNc();if(pb&&this.Dob)try{let nb=this.Dob.v0i();
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.Excel.FilterOfficeLiveSurvey",!1)&&r.AFrameworkApplication.Ysa&&(nb=this.frl(nb));nb?(pb.setItem(Xb.Jki,nb),ob=!0):(ac="SIFB.campaign str was null",h.ULS.sendTraceTag(594143442,356,10,ac))}catch(nb){ac="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+nb,h.ULS.sendTraceTag(594143441,356,50,ac)}else this.Dob?(ac="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",h.ULS.sendTraceTag(594143440,
356,50,ac)):(ac="SIFB.Floodgate surveys not available. App Specific Feedback data was null",h.ULS.sendTraceTag(556896920,356,50,ac));h.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+ob+" errorString: "+(ac?ac:"null"))}zye(ob,ac){ja.a.gDb()&&h.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",ac,ob);ja.a.cTa()&&ea.c(ac?F.a.jAl:F.a.iAl,!0,null,2,8);Mb.a.instance.zo(Da.a.v6f)}initOptions(){}R8k(){this.e_a||(Hb.a.addHandler(window.self,tb.a.focus,
Object(e.a)(this,this.rfc,"onWindowFocus")),Hb.a.addHandler(window.self,tb.a.blur,Object(e.a)(this,this.esk,"onWindowBlur")))}ZNc(){if(!this.e3b)return null;let ob=null;try{ob=localStorage}catch(ac){this.e3b=!1,ob=null,h.ULS.sendTraceTag(594052320,356,50,"SIFB.GetLocalStorage error "+(ac?ac.toString():""))}return ob}XAj(){h.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter");try{this.oa=new ta.a(Ga.a.Tq()),this.oa.$("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.oa.$("nps_PromptQuestion",
CommonUIStrings.l_WAC_NPS_PromptQuestion),this.oa.$("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),this.oa.$("nps_RatingQuestion_Word",Xb.dig()),this.oa.$("nps_RatingQuestion_OneNote",Xb.ekj()),this.oa.$("nps_OneClickPromptQuestion_PPT",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.oa.$("nps_OneClickPromptQuestion_Excel",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Excel),this.oa.$("nps_OneClickRatingQuestion_Excel",Xb.aig()),this.oa.$("nps_OneClickRatingQuestion_PowerPoint",
Xb.cig()),this.oa.$("nps_RatingQuestion_PowerPoint",Xb.cig()),this.oa.$("nps_RatingQuestion_Excel",Xb.aig()),this.oa.$("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.oa.$("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),this.oa.$("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),this.oa.$("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.oa.$("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.oa.$("nps_Rating_Values_5",
CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.oa.$("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.oa.$("nps_OneClickPromptQuestion",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion),this.oa.$("nps_OneClickRatingQuestion_Word",Xb.dig()),this.oa.$("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),this.oa.$("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.oa.$("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),
this.oa.$("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),this.oa.$("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.oa.$("nps_Suite_RatingQuestion","How likely are you to recommend Microsoft 365 to others, if asked?"),this.oa.$("nps_Suite_QuestionQuestion","Please tell us more. Why did you choose that answer?"),this.oa.$("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.oa.$("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),
this.oa.$("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.oa.$("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.oa.$("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.oa.$("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.oa.$("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.oa.$("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.oa.$("NSV_Prompt_Title_Feedback",
CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),this.oa.$("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.oa.$("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),this.oa.$("NSVDidntCreateNSVOption_2",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.oa.$("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.oa.$("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.oa.$("NSVFreeformDidntCreateSheetView",
CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),this.oa.$("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.oa.$("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),this.oa.$("CatchUpFPS_Title",CommonUIStrings.l_WAC_CatchUpFPS_Title),this.oa.$("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.oa.$("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.oa.$("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),
this.oa.$("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),this.oa.$("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.oa.$("CatchUpFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.oa.$("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.oa.$("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.oa.$("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),
this.oa.$("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),this.oa.$("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.oa.$("ReviewMode_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),this.oa.$("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.oa.$("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.oa.$("ReviewMode_FloodgateRatingQuestion",
CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),this.oa.$("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.oa.$("ReviewMode_FloodgateRating_2",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),this.oa.$("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.oa.$("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.oa.$("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),
this.oa.$("ReviewMode_FloodgateQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.oa.$("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),this.oa.$("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),this.oa.$("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.oa.$("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.oa.$("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),
this.oa.$("collab_Rating_Values_3",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.oa.$("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),this.oa.$("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),this.oa.$("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.oa.$("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.oa.$("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),
this.oa.$("connector_campaign_Prompt_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.oa.$("connector_campaign_Rating_Values_1",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.oa.$("connector_campaign_Rating_Values_2",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.oa.$("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.oa.$("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),
this.oa.$("connector_campaign_Rating_Values_5",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.oa.$("connector_campaign_Verbatim_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question),this.oa.$("WordFollowUpFeelingsFPS_PromptTitle",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptTitle),this.oa.$("WordFollowUpFeelingsFPS_PromptQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_PromptQuestion),this.oa.$("WordFollowUpFeelingsFPS_Prompt_YesLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_YesLabel),
this.oa.$("WordFollowUpFeelingsFPS_Prompt_NoLabel",CommonUIStrings.l_WordFollowUpFeelingsFPS_Prompt_NoLabel),this.oa.$("WordFollowUpFeelingsFPS_RatingQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingQuestion),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_1",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_1),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_2",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_2),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_3",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_3),
this.oa.$("WordFollowUpFeelingsFPS_RatingValue_4",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_4),this.oa.$("WordFollowUpFeelingsFPS_RatingValue_5",CommonUIStrings.l_WordFollowUpFeelingsFPS_RatingValue_5),this.oa.$("WordFollowUpFeelingsFPS_WhyQuestion",CommonUIStrings.l_WordFollowUpFeelingsFPS_WhyQuestion),this.oa.$("DictationV2_Title",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_Title),this.oa.$("DictationV2_GreetingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingQuestion),
this.oa.$("DictationV2_GreetingAnswer_Sure",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Sure),this.oa.$("DictationV2_GreetingAnswer_Notnow",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_GreetingAnswer_Notnow),this.oa.$("DictationV2_RatingQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingQuestion),this.oa.$("DictationV2_RatingAnswer_1",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_1),this.oa.$("DictationV2_RatingAnswer_2",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_2),
this.oa.$("DictationV2_RatingAnswer_3",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_3),this.oa.$("DictationV2_RatingAnswer_4",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_4),this.oa.$("DictationV2_RatingAnswer_5",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_RatingAnswer_5),this.oa.$("DictationV2_PromptQuestion",CommonUIStrings.l_WAC_DictationV2_FloodgateSurvey_PromptQuestion),this.oa.$("OfficeScriptsFPS_Title",CommonUIStrings.l_WAC_OfficeScriptsFPS_Title),
this.oa.$("OfficeScriptsFPS_Question",CommonUIStrings.l_WAC_OfficeScriptsFPS_Question),this.oa.$("OfficeScriptsFPS_YesLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_YesLabel),this.oa.$("OfficeScriptsFPS_NoLabel",CommonUIStrings.l_WAC_OfficeScriptsFPS_NoLabel),this.oa.$("OfficeScriptsFPS_RatingQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingQuestion),this.oa.$("OfficeScriptsFPS_RatingValue_1",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_1),this.oa.$("OfficeScriptsFPS_RatingValue_2",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_2),
this.oa.$("OfficeScriptsFPS_RatingValue_3",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_3),this.oa.$("OfficeScriptsFPS_RatingValue_4",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_4),this.oa.$("OfficeScriptsFPS_RatingValue_5",CommonUIStrings.l_WAC_OfficeScriptsFPS_RatingValue_5),this.oa.$("OfficeScriptsFPS_WhyQuestion",CommonUIStrings.l_WAC_OfficeScriptsFPS_WhyQuestion),this.oa.$("ExcelAddins_Prompt",CommonUIStrings.l_Excel_Addins_Prompt),this.oa.$("ExcelAddins_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.oa.$("ExcelAddins_Rating_Question",CommonUIStrings.l_Excel_Addins_Rating_Question),this.oa.$("ExcelAddins_QuestionQuestion",CommonUIStrings.l_Excel_Addins_QuestionQuestion),this.oa.$("ExcelAddins_Rating_1_Expectations",CommonUIStrings.l_Excel_Addins_Choice_1),this.oa.$("ExcelAddins_Rating_2_Expectations",CommonUIStrings.l_Excel_Addins_Choice_2),this.oa.$("ExcelAddins_Rating_3_Expectations",CommonUIStrings.l_Excel_Addins_Choice_3),this.oa.$("ExcelAddins_Rating_4_Expectations",CommonUIStrings.l_Excel_Addins_Choice_4),
this.oa.$("ExcelAddins_Rating_5_Expectations",CommonUIStrings.l_Excel_Addins_Choice_5),this.oa.$("ExcelIdeas_Prompt",CommonUIStrings.l_Excel_Ideas_Prompt),this.oa.$("ExcelIdeas_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("ExcelIdeas_Rating_Question",CommonUIStrings.l_Excel_Ideas_Rating_Question),this.oa.$("ExcelIdeas_ExpectationsQuestion",CommonUIStrings.l_Excel_Ideas_ExpectationsQuestion),this.oa.$("ExcelIdeas_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),
this.oa.$("ExcelIdeas_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.oa.$("ExcelIdeas_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),this.oa.$("ExcelIdeas_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.oa.$("ExcelIdeas_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.oa.$("ExcelRecommendedCharts_Prompt",CommonUIStrings.l_Excel_RecommendedCharts_Prompt),this.oa.$("ExcelRecommendedCharts_PromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("ExcelRecommendedCharts_Rating_Question",CommonUIStrings.l_Excel_RecommendedCharts_Rating_Question),this.oa.$("ExcelRecommendedCharts_WhyQuestion",CommonUIStrings.l_Excel_RecommendedCharts_WhyQuestion),this.oa.$("ExcelRecommendedCharts_Rating_1_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_1_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_2_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_2_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_3_Satisfied",
CommonUIStrings.l_ExcelRecommendedCharts_Rating_3_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_4_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_4_Satisfied),this.oa.$("ExcelRecommendedCharts_Rating_5_Satisfied",CommonUIStrings.l_ExcelRecommendedCharts_Rating_5_Satisfied),this.oa.$("ExcelRecommendedPivotTable_Prompt",CommonUIStrings.l_Excel_RecommendedPivotTable_Prompt),this.oa.$("ExcelRecommendedPivotTable_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("ExcelRecommendedPivotTable_Rating_Question",
CommonUIStrings.l_Excel_RecommendedPivotTable_Rating_Question),this.oa.$("ExcelRecommendedPivotTable_ExpectationsQuestion",CommonUIStrings.l_Excel_RecommendedPivotTable_ExpectationsQuestion),this.oa.$("ExcelRecommendedPivotTable_Rating_1_Expectations",CommonUIStrings.l_Excel_Rating_1_Expectations),this.oa.$("ExcelRecommendedPivotTable_Rating_2_Expectations",CommonUIStrings.l_Excel_Rating_2_Expectations),this.oa.$("ExcelRecommendedPivotTable_Rating_3_Expectations",CommonUIStrings.l_Excel_Rating_3_Expectations),
this.oa.$("ExcelRecommendedPivotTable_Rating_4_Expectations",CommonUIStrings.l_Excel_Rating_4_Expectations),this.oa.$("ExcelRecommendedPivotTable_Rating_5_Expectations",CommonUIStrings.l_Excel_Rating_5_Expectations),this.oa.$("Download_as_Image_Rating_Question",CommonUIStrings.l_Visio_Download_As_Image_Rating_Question),this.oa.$("Download_as_Image_Title",CommonUIStrings.l_Visio_Download_As_Image_Title),this.oa.$("Download_as_Image_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question),this.oa.$("Download_as_Image_Rating_Values_1",
CommonUIStrings.l_Visio_FPS_Rating_Values_1),this.oa.$("Download_as_Image_Rating_Values_2",CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.oa.$("Download_as_Image_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.oa.$("Download_as_Image_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.oa.$("Download_as_Image_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.oa.$("Download_as_Image_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.oa.$("TextPredictions_FloodgatePromptTitle",
CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptTitle),this.oa.$("TextPredictions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgatePromptQuestion),this.oa.$("TextPredictions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_YesLabel),this.oa.$("TextPredictions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_TextPredictions_FloodgatePrompt_NoLabel),this.oa.$("TextPredictions_FloodgateRatingQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateRatingQuestion),
this.oa.$("TextPredictions_FloodgateRating_1",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_1),this.oa.$("TextPredictions_FloodgateRating_2",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_2),this.oa.$("TextPredictions_FloodgateRating_3",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_3),this.oa.$("TextPredictions_FloodgateRating_4",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_4),this.oa.$("TextPredictions_FloodgateRating_5",CommonUIStrings.l_WAC_TextPredictions_FloodgateRating_5),
this.oa.$("TextPredictions_FloodgateQuestion",CommonUIStrings.l_WAC_TextPredictions_FloodgateQuestion),this.oa.$("SoftwareITDiagrams_Title",CommonUIStrings.l_Visio_SoftwareITDiagrams_Title),this.oa.$("SoftwareITDiagrams_Survey_Question",CommonUIStrings.l_VisioWeb_SoftwareITDiagrams_Survey_Question),this.oa.$("SoftwareITDiagrams_Prompt_Question",CommonUIStrings.l_Visio_FPS_Prompt_Question1),this.oa.$("SoftwareITDiagrams_Rating_Values_1",CommonUIStrings.l_Visio_FPS_Rating_Values_1a),this.oa.$("SoftwareITDiagrams_Rating_Values_2",
CommonUIStrings.l_Visio_FPS_Rating_Values_2),this.oa.$("SoftwareITDiagrams_Rating_Values_3",CommonUIStrings.l_Visio_FPS_Rating_Values_3),this.oa.$("SoftwareITDiagrams_Rating_Values_4",CommonUIStrings.l_Visio_FPS_Rating_Values_4),this.oa.$("SoftwareITDiagrams_Rating_Values_5",CommonUIStrings.l_Visio_FPS_Rating_Values_5),this.oa.$("SofwareITDiagrams_Question",CommonUIStrings.l_Visio_FPS_General_Question),this.oa.$("ExternalContent_FloodgatePromptTitle",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptTitle),
this.oa.$("ExternalContent_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgatePromptQuestion),this.oa.$("ExternalContent_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_YesLabel),this.oa.$("ExternalContent_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ExternalContent_FloodgatePrompt_NoLabel),this.oa.$("ExternalContent_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ExternalContent_FloodgateRatingQuestion),this.oa.$("ExternalContent_FloodgateRating_1",
CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_1),this.oa.$("ExternalContent_FloodgateRating_2",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_2),this.oa.$("ExternalContent_FloodgateRating_3",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_3),this.oa.$("ExternalContent_FloodgateRating_4",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_4),this.oa.$("ExternalContent_FloodgateRating_5",CommonUIStrings.l_WAC_ExternalContent_FloodgateRating_5),this.oa.$("ExternalContent_FloodgateQuestion",
CommonUIStrings.l_WAC_ExternalContent_FloodgateQuestion),this.oa.$("Translator_GreetingQuestion",CommonUIStrings.l_Word_Translator_Floodgate_GreetingQuestion),this.oa.$("Translator_PromptTitle",CommonUIStrings.l_Word_Translator_Floodgate_PromptTitle),this.oa.$("Translator_GreetingAnswer_NotNow",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_NotNow),this.oa.$("Translator_GreetingAnswer_Sure",CommonUIStrings.l_Word_Translator_Floodgate_GreetingAnswer_Sure),this.oa.$("Translator_RatingQuestion",
CommonUIStrings.l_Word_Translator_Floodgate_RatingQuestion),this.oa.$("Translator_RatingValue_1",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_1),this.oa.$("Translator_RatingValue_2",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_2),this.oa.$("Translator_RatingValue_3",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_3),this.oa.$("Translator_RatingValue_4",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_4),this.oa.$("Translator_RatingValue_5",CommonUIStrings.l_Word_Translator_Floodgate_RatingValue_5),
this.oa.$("Translator_PromptQuestion",CommonUIStrings.l_Word_Translator_Floodgate_PromptQuestion),this.oa.$("TeamsOpen_GreetingQuestion",CommonUIStrings.l_WAC_NPS_Title),this.oa.$("TeamsOpen_PromptTitle",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("TeamsOpen_GreetingAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("TeamsOpen_GreetingAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("TeamsOpen_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Word),
this.oa.$("TeamsOpen_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Excel),this.oa.$("TeamsOpen_RatingQuestion_PowerPoint",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_PowerPoint),this.oa.$("TeamsOpen_Rating_Browser",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Browser),this.oa.$("TeamsOpen_Rating_Teams",CommonUIStrings.l_WAC_NPS_TeamsFileOpenFloodgate_Rating_Teams),this.oa.$("TeamsOpen_PromptQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.oa.$("LinkedIn_Title",
CommonUIStrings.l_LinkedIn_Title),this.oa.$("LinkedIn_PromptQuestion",CommonUIStrings.l_LinkedIn_PromptQuestion),this.oa.$("LinkedIn_QuestionQuestion",CommonUIStrings.l_LinkedIn_QuestionQuestion),this.oa.$("LinkedIn_Rating_Values_1",CommonUIStrings.l_LinkedIn_Rating_Values_1),this.oa.$("LinkedIn_Rating_Values_2",CommonUIStrings.l_LinkedIn_Rating_Values_2),this.oa.$("LinkedIn_Rating_Values_3",CommonUIStrings.l_LinkedIn_Rating_Values_3),this.oa.$("LinkedIn_Rating_Values_4",CommonUIStrings.l_LinkedIn_Rating_Values_4),
this.oa.$("LinkedIn_Rating_Values_5",CommonUIStrings.l_LinkedIn_Rating_Values_5),this.oa.$("Excel_LinkedIn_RatingQuestion",CommonUIStrings.l_Excel_LinkedIn_RatingQuestion),this.oa.$("VHRestore_Title",CommonUIStrings.l_WAC_VHRestore_PromptTitle),this.oa.$("VHRestore_PromptQuestion",CommonUIStrings.l_WAC_VHRestore_PromptQuestion),this.oa.$("VHRestore_Sure",CommonUIStrings.l_WAC_VHRestore_Sure),this.oa.$("VHRestore_NotNow",CommonUIStrings.l_WAC_VHRestore_NotNow),this.oa.$("VHRestore_SurveyQuestion",
CommonUIStrings.l_WAC_VHRestore_SurveyQuestion),this.oa.$("VHRestore_Answer_Options_1",CommonUIStrings.l_WAC_VHRestore_AnswerOption_1),this.oa.$("VHRestore_Answer_Options_2",CommonUIStrings.l_WAC_VHRestore_AnswerOption_2),this.oa.$("VHRestore_Answer_Options_3",CommonUIStrings.l_WAC_VHRestore_AnswerOption_3),this.oa.$("VHRestore_Answer_Options_4",CommonUIStrings.l_WAC_VHRestore_AnswerOption_4),this.oa.$("VHRestore_WhyQuestion",CommonUIStrings.l_WAC_VHRestore_WhyQuestion),this.oa.$("ShowChanges_Prompt",
CommonUIStrings.l_Excel_ShowChanges_Prompt),this.oa.$("ShowChanges_PromptQuestion",CommonUIStrings.l_Excel_ShowChanges_PromptQuestion),this.oa.$("ShowChanges_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ShowChanges_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ShowChanges_RatingQuestion",CommonUIStrings.l_Excel_ShowChanges_RatingQuestion),this.oa.$("ShowChanges_RatingValue_1",CommonUIStrings.l_Excel_ShowChanges_RatingValue_1),this.oa.$("ShowChanges_RatingValue_2",
CommonUIStrings.l_Excel_ShowChanges_RatingValue_2),this.oa.$("ShowChanges_RatingValue_3",CommonUIStrings.l_Excel_ShowChanges_RatingValue_3),this.oa.$("ShowChanges_RatingValue_4",CommonUIStrings.l_Excel_ShowChanges_RatingValue_4),this.oa.$("ShowChanges_RatingValue_5",CommonUIStrings.l_Excel_ShowChanges_RatingValue_5),this.oa.$("ShowChanges_WhyQuestion",CommonUIStrings.l_Excel_ShowChanges_WhyQuestion),this.oa.$("ModernUxExperiment_FloodgatePromptTitle",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptTitle),
this.oa.$("ModernUxExperiment_FloodgatePromptQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptQuestion),this.oa.$("ModernUxExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_NotNow),this.oa.$("ModernUxExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_ModernUxExperiment_Floodgate_PromptAnswer_Sure),this.oa.$("ModernUxExperiment_FloodgateRatingQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingQuestion),this.oa.$("ModernUxExperiment_FloodgateRatingValue_1",
CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_1),this.oa.$("ModernUxExperiment_FloodgateRatingValue_2",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_2),this.oa.$("ModernUxExperiment_FloodgateRatingValue_3",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_3),this.oa.$("ModernUxExperiment_FloodgateRatingValue_4",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_4),this.oa.$("ModernUxExperiment_FloodgateRatingValue_5",CommonUIStrings.l_ModernUxExperiment_Floodgate_RatingValue_5),
this.oa.$("ModernUxExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_ModernUxExperiment_Floodgate_HearMoreQuestion),this.oa.$("FileBackedLoopComponents_FloodgatePromptTitle",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_PromptTitle),this.oa.$("FileBackedLoopComponents_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("FileBackedLoopComponents_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FileBackedLoopComponents_FloodgatePromptAnswer_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FileBackedLoopComponents_FloodgateRatingQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingQuestion),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_1",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_1),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_2",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_2),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_3",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_3),
this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_4",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_4),this.oa.$("FileBackedLoopComponents_FloodgateRatingValue_5",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_RatingValue_5),this.oa.$("FileBackedLoopComponents_FloodgateWhyQuestion",CommonUIStrings.l_FileBackedLoopComponents_Floodgate_FloodgateWhyQuestion),this.oa.$("PollLoopComponent_FloodgatePromptTitle",CommonUIStrings.l_PollLoopComponent_Floodgate_PromptTitle),this.oa.$("PollLoopComponent_FloodgatePromptQuestion",
CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("PollLoopComponent_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("PollLoopComponent_FloodgatePromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("PollLoopComponent_FloodgateRatingQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingQuestion),this.oa.$("PollLoopComponent_FloodgateRatingValue_1",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_1),this.oa.$("PollLoopComponent_FloodgateRatingValue_2",
CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_2),this.oa.$("PollLoopComponent_FloodgateRatingValue_3",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_3),this.oa.$("PollLoopComponent_FloodgateRatingValue_4",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_4),this.oa.$("PollLoopComponent_FloodgateRatingValue_5",CommonUIStrings.l_PollLoopComponent_Floodgate_RatingValue_5),this.oa.$("PollLoopComponent_FloodgateWhyQuestion",CommonUIStrings.l_PollLoopComponent_Floodgate_FloodgateWhyQuestion),
this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptTitle),this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptQuestion),this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_NotNow),this.oa.$("TabSwitchTreatmentExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_PromptAnswer_Sure),
this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingQuestion),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_1),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_2),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_3),
this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_4),this.oa.$("TabSwitchTreatmentExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_RatingValue_5),this.oa.$("TabSwitchTreatmentExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchTreatmentExperiment_Floodgate_HearMoreQuestion),this.oa.$("TabSwitchControlExperiment_FloodgatePromptTitle",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptTitle),
this.oa.$("TabSwitchControlExperiment_FloodgatePromptQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptQuestion),this.oa.$("TabSwitchControlExperiment_FloodgatePromptAnswer_NotNow",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_NotNow),this.oa.$("TabSwitchControlExperiment_FloodgatePromptAnswer_Sure",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_PromptAnswer_Sure),this.oa.$("TabSwitchControlExperiment_FloodgateRatingQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingQuestion),
this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_1",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_1),this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_2",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_2),this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_3",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_3),this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_4",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_4),
this.oa.$("TabSwitchControlExperiment_FloodgateRatingValue_5",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_RatingValue_5),this.oa.$("TabSwitchControlExperiment_FloodgateHearMoreQuestion",CommonUIStrings.l_TabSwitchControlExperiment_Floodgate_HearMoreQuestion),this.oa.$("ShortcutDiscovery_PromptTitle",CommonUIStrings.l_ShortcutDiscovery_PromptTitle),this.oa.$("ShortcutDiscovery_PromptQuestion",CommonUIStrings.l_ShortcutDiscovery_PromptQuestion),this.oa.$("ShortcutDiscovery_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ShortcutDiscovery_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ShortcutDiscovery_RatingQuestion",CommonUIStrings.l_ShortcutDiscovery_RatingQuestion),this.oa.$("ShortcutDiscovery_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.oa.$("ShortcutDiscovery_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.oa.$("ShortcutDiscovery_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.oa.$("ShortcutDiscovery_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.oa.$("ShortcutDiscovery_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.oa.$("ShortcutDiscovery_WhyQuestion",CommonUIStrings.l_ShortcutDiscovery_WhyQuestion),this.oa.$("Ruler_PromptTitle",CommonUIStrings.l_WordRuler_PromptTitle),this.oa.$("Ruler_PromptQuestion",CommonUIStrings.l_WordRuler_PromptQuestion),this.oa.$("Ruler_PromptAnswer_NotNow",CommonUIStrings.l_WordRuler_PromptAnswer_NotNow),
this.oa.$("Ruler_PromptAnswer_Sure",CommonUIStrings.l_WordRuler_PromptAnswer_Sure),this.oa.$("Ruler_RatingQuestion",CommonUIStrings.l_WordRuler_RatingQuestion),this.oa.$("Ruler_RatingValue_1",CommonUIStrings.l_WordRuler_RatingValue_1),this.oa.$("Ruler_RatingValue_2",CommonUIStrings.l_WordRuler_RatingValue_2),this.oa.$("Ruler_RatingValue_3",CommonUIStrings.l_WordRuler_RatingValue_3),this.oa.$("Ruler_RatingValue_4",CommonUIStrings.l_WordRuler_RatingValue_4),this.oa.$("Ruler_RatingValue_5",CommonUIStrings.l_WordRuler_RatingValue_5),
this.oa.$("Ruler_WhyQuestion",CommonUIStrings.l_WordRuler_WhyQuestion),this.oa.$("CustomTabDialog_PromptTitle",CommonUIStrings.l_CustomTabDialog_PromptTitle),this.oa.$("CustomTabDialog_PromptQuestion",CommonUIStrings.l_CustomTabDialog_PromptQuestion),this.oa.$("CustomTabDialog_PromptAnswer_NotNow",CommonUIStrings.l_CustomTabDialog_PromptAnswer_NotNow),this.oa.$("CustomTabDialog_PromptAnswer_Sure",CommonUIStrings.l_CustomTabDialog_PromptAnswer_Sure),this.oa.$("CustomTabDialog_RatingQuestion",CommonUIStrings.l_CustomTabDialog_RatingQuestion),
this.oa.$("CustomTabDialog_RatingValue_1",CommonUIStrings.l_CustomTabDialog_RatingValue_1),this.oa.$("CustomTabDialog_RatingValue_2",CommonUIStrings.l_CustomTabDialog_RatingValue_2),this.oa.$("CustomTabDialog_RatingValue_3",CommonUIStrings.l_CustomTabDialog_RatingValue_3),this.oa.$("CustomTabDialog_RatingValue_4",CommonUIStrings.l_CustomTabDialog_RatingValue_4),this.oa.$("CustomTabDialog_RatingValue_5",CommonUIStrings.l_CustomTabDialog_RatingValue_5),this.oa.$("CustomTabDialog_WhyQuestion",CommonUIStrings.l_CustomTabDialog_WhyQuestion),
this.oa.$("WordStyles_FloodgatePromptTitle",CommonUIStrings.l_WordStyles_FloodgatePromptTitle),this.oa.$("WordStyles_FloodgatePromptQuestion",CommonUIStrings.l_WordStyles_FloodgatePromptQuestion),this.oa.$("WordStyles_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_YesLabel),this.oa.$("WordStyles_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordStyles_FloodgatePrompt_NoLabel),this.oa.$("WordStyles_FloodgateRatingQuestion",CommonUIStrings.l_WordStyles_FloodgateRatingQuestion),
this.oa.$("WordStyles_FloodgateRating_1",CommonUIStrings.l_WordStyles_FloodgateRating_1),this.oa.$("WordStyles_FloodgateRating_2",CommonUIStrings.l_WordStyles_FloodgateRating_2),this.oa.$("WordStyles_FloodgateRating_3",CommonUIStrings.l_WordStyles_FloodgateRating_3),this.oa.$("WordStyles_FloodgateRating_4",CommonUIStrings.l_WordStyles_FloodgateRating_4),this.oa.$("WordStyles_FloodgateRating_5",CommonUIStrings.l_WordStyles_FloodgateRating_5),this.oa.$("WordStyles_FloodgateWhyQuestion",CommonUIStrings.l_WordStyles_FloodgateWhyQuestion),
this.oa.$("UnsavedChangesHighlight_PromptTitle",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptTitle),this.oa.$("UnsavedChangesHighlight_PromptQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_PromptQuestion),this.oa.$("UnsavedChangesHighlight_Prompt_YesLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_YesLabel),this.oa.$("UnsavedChangesHighlight_Prompt_NoLabel",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Prompt_NoLabel),this.oa.$("UnsavedChangesHighlight_RatingQuestion",
CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_RatingQuestion),this.oa.$("UnsavedChangesHighlight_Rating_Yes",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_Yes),this.oa.$("UnsavedChangesHighlight_Rating_No",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_Rating_No),this.oa.$("UnsavedChangesHighlight_CommentQuestion",CommonUIStrings.l_WAC_WordUnsavedChangesHighlight_CommentQuestion),this.oa.$("WordUnifiedRead_FloodgatePromptTitle",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptTitle),
this.oa.$("WordUnifiedRead_FloodgatePromptQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgatePromptQuestion),this.oa.$("WordUnifiedRead_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_YesLabel),this.oa.$("WordUnifiedRead_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordUnifiedRead_FloodgatePrompt_NoLabel),this.oa.$("WordUnifiedRead_FloodgateRatingQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateRatingQuestion),this.oa.$("WordUnifiedRead_FloodgateRating_1",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_1),
this.oa.$("WordUnifiedRead_FloodgateRating_2",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_2),this.oa.$("WordUnifiedRead_FloodgateRating_3",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_3),this.oa.$("WordUnifiedRead_FloodgateRating_4",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_4),this.oa.$("WordUnifiedRead_FloodgateRating_5",CommonUIStrings.l_WordUnifiedRead_FloodgateRating_5),this.oa.$("WordUnifiedRead_FloodgateWhyQuestion",CommonUIStrings.l_WordUnifiedRead_FloodgateWhyQuestion),
this.oa.$("GrammarSuggestions_FloodgatePromptTitle",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptTitle),this.oa.$("GrammarSuggestions_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePromptQuestion),this.oa.$("GrammarSuggestions_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_YesLabel),this.oa.$("GrammarSuggestions_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgatePrompt_NoLabel),this.oa.$("GrammarSuggestions_FloodgateRatingQuestion",
CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRatingQuestion),this.oa.$("GrammarSuggestions_FloodgateRating_1",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_1),this.oa.$("GrammarSuggestions_FloodgateRating_2",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_2),this.oa.$("GrammarSuggestions_FloodgateRating_3",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_3),this.oa.$("GrammarSuggestions_FloodgateRating_4",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_4),
this.oa.$("GrammarSuggestions_FloodgateRating_5",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateRating_5),this.oa.$("GrammarSuggestions_FloodgateQuestion",CommonUIStrings.l_WAC_GrammarSuggestions_FloodgateQuestion),this.oa.$("WordRemoveSsr_FloodgatePromptTitle",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptTitle),this.oa.$("WordRemoveSsr_FloodgatePromptQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgatePromptQuestion),this.oa.$("WordRemoveSsr_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_YesLabel),
this.oa.$("WordRemoveSsr_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordRemoveSsr_FloodgatePrompt_NoLabel),this.oa.$("WordRemoveSsr_FloodgateRatingQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateRatingQuestion),this.oa.$("WordRemoveSsr_FloodgateRating_1",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_1),this.oa.$("WordRemoveSsr_FloodgateRating_2",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_2),this.oa.$("WordRemoveSsr_FloodgateRating_3",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_3),this.oa.$("WordRemoveSsr_FloodgateRating_4",
CommonUIStrings.l_WordRemoveSsr_FloodgateRating_4),this.oa.$("WordRemoveSsr_FloodgateRating_5",CommonUIStrings.l_WordRemoveSsr_FloodgateRating_5),this.oa.$("WordRemoveSsr_FloodgateWhyQuestion",CommonUIStrings.l_WordRemoveSsr_FloodgateWhyQuestion),this.oa.$("WordDrawing_FloodgatePromptTitle",CommonUIStrings.l_WordDrawing_FloodgatePromptTitle),this.oa.$("WordDrawing_FloodgatePromptQuestion",CommonUIStrings.l_WordDrawing_FloodgatePromptQuestion),this.oa.$("WordDrawing_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_YesLabel),
this.oa.$("WordDrawing_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDrawing_FloodgatePrompt_NoLabel),this.oa.$("WordDrawing_FloodgateRatingQuestion",CommonUIStrings.l_WordDrawing_FloodgateRatingQuestion),this.oa.$("WordDrawing_FloodgateRating_1",CommonUIStrings.l_WordDrawing_FloodgateRating_1),this.oa.$("WordDrawing_FloodgateRating_2",CommonUIStrings.l_WordDrawing_FloodgateRating_2),this.oa.$("WordDrawing_FloodgateRating_3",CommonUIStrings.l_WordDrawing_FloodgateRating_3),this.oa.$("WordDrawing_FloodgateRating_4",
CommonUIStrings.l_WordDrawing_FloodgateRating_4),this.oa.$("WordDrawing_FloodgateRating_5",CommonUIStrings.l_WordDrawing_FloodgateRating_5),this.oa.$("WordDrawing_FloodgateWhyQuestion",CommonUIStrings.l_WordDrawing_FloodgateWhyQuestion),this.oa.$("WordPenNSAT_FloodgatePromptTitle",CommonUIStrings.l_WordPenNSAT_FloodgatePromptTitle),this.oa.$("WordPenNSAT_FloodgatePromptQuestion",CommonUIStrings.l_WordPenNSAT_FloodgatePromptQuestion),this.oa.$("WordPenNSAT_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("WordPenNSAT_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordPenNSAT_FloodgateRatingQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateRatingQuestion),this.oa.$("WordPenNSAT_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("WordPenNSAT_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("WordPenNSAT_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),
this.oa.$("WordPenNSAT_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.oa.$("WordPenNSAT_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("WordPenNSAT_FloodgateWhyQuestion",CommonUIStrings.l_WordPenNSAT_FloodgateWhyQuestion),this.oa.$("ShyRibbon_FloodgatePromptTitle",CommonUIStrings.l_ShyRibbon_FloodgatePromptTitle),this.oa.$("ShyRibbon_FloodgatePromptQuestion",CommonUIStrings.l_ShyRibbon_FloodgatePromptQuestion),
this.oa.$("ShyRibbon_FloodgatePrompt_YesLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_YesLabel),this.oa.$("ShyRibbon_FloodgatePrompt_NoLabel",CommonUIStrings.l_ShyRibbon_FloodgatePrompt_NoLabel),this.oa.$("ShyRibbon_Floodgate_Question",CommonUIStrings.l_ShyRibbon_Floodgate_Question),this.oa.$("ShyRibbon_Floodgate_Option_1",CommonUIStrings.l_ShyRibbon_Floodgate_Option_1),this.oa.$("ShyRibbon_Floodgate_Option_2",CommonUIStrings.l_ShyRibbon_Floodgate_Option_2),this.oa.$("ShyRibbon_Floodgate_Option_3",
CommonUIStrings.l_ShyRibbon_Floodgate_Option_3),this.oa.$("ShyRibbon_Floodgate_Option_4",CommonUIStrings.l_ShyRibbon_Floodgate_Option_4),this.oa.$("ShyRibbon_Floodgate_Option_5",CommonUIStrings.l_ShyRibbon_Floodgate_Option_5),this.oa.$("ShyRibbon_FloodgateTellusMore",CommonUIStrings.l_ShyRibbon_Floodgate_TellMore),this.oa.$("WordAutoCorrect_FloodgatePromptTitle",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptTitle),this.oa.$("WordAutoCorrect_FloodgatePromptQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgatePromptQuestion),
this.oa.$("WordAutoCorrect_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_YesLabel),this.oa.$("WordAutoCorrect_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordAutoCorrect_FloodgatePrompt_NoLabel),this.oa.$("WordAutoCorrect_FloodgateRatingQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateRatingQuestion),this.oa.$("WordAutoCorrect_FloodgateRating_1",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_1),this.oa.$("WordAutoCorrect_FloodgateRating_2",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_2),
this.oa.$("WordAutoCorrect_FloodgateRating_3",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_3),this.oa.$("WordAutoCorrect_FloodgateRating_4",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_4),this.oa.$("WordAutoCorrect_FloodgateRating_5",CommonUIStrings.l_WordAutoCorrect_FloodgateRating_5),this.oa.$("WordAutoCorrect_FloodgateWhyQuestion",CommonUIStrings.l_WordAutoCorrect_FloodgateWhyQuestion),this.oa.$("PasswordProtectedDocumentSupport_FloodgatePromptTitle",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptTitle),
this.oa.$("PasswordProtectedDocumentSupport_FloodgatePromptQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePromptQuestion),this.oa.$("PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_YesLabel),this.oa.$("PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgatePrompt_NoLabel),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRatingQuestion",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRatingQuestion),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_1",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_1),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_2",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_2),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_3",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_3),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_4",
CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_4),this.oa.$("PasswordProtectedDocumentSupport_FloodgateRating_5",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateRating_5),this.oa.$("PasswordProtectedDocumentSupport_FloodgateWhyQuestion",CommonUIStrings.l_PasswordProtectedDocumentSupport_FloodgateWhyQuestion),this.oa.$("WordSimilarity_FloodgatePromptTitle",CommonUIStrings.l_WordSimilarity_FloodgatePromptTitle),this.oa.$("WordSimilarity_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.oa.$("WordSimilarity_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("WordSimilarity_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordSimilarity_FloodgateRatingQuestion",CommonUIStrings.l_WordSimilarity_FloodgateRatingQuestion),this.oa.$("WordSimilarity_FloodgateRating_1",CommonUIStrings.l_WordSimilarity_FloodgateRating_1),this.oa.$("WordSimilarity_FloodgateRating_2",CommonUIStrings.l_WordSimilarity_FloodgateRating_2),this.oa.$("WordSimilarity_FloodgateRating_3",
CommonUIStrings.l_WordSimilarity_FloodgateRating_3),this.oa.$("WordSimilarity_FloodgateRating_4",CommonUIStrings.l_WordSimilarity_FloodgateRating_4),this.oa.$("WordSimilarity_FloodgateRating_5",CommonUIStrings.l_WordSimilarity_FloodgateRating_5),this.oa.$("WordSimilarity_FloodgateWhyQuestion",CommonUIStrings.l_WordSimilarity_FloodgateWhyQuestion),this.oa.$("PremiumPreviewFloodgateTitle",CommonUIStrings.l_PremiumPreview_FeedbackTitle),this.oa.$("PremiumPreviewFloodgatePrompt",CommonUIStrings.l_PremiumPreview_FeedbackPrompt),
this.oa.$("PremiumPreviewFloodgateRatingQuestion",CommonUIStrings.l_PremiumPreview_FeedbackRatingQuestion),this.oa.$("PremiumPreviewFloodgateQuestion",CommonUIStrings.l_PremiumPreview_FeedbackQuestion1),this.oa.$("PremiumPreviewFloodgateMinRating",CommonUIStrings.l_PremiumPreview_FeedbackMinRating),this.oa.$("PremiumPreviewFloodgateMaxRating",CommonUIStrings.l_PremiumPreview_FeedbackMaxRating),this.oa.$("FloodgateNLQSPromptTitle",CommonUIStrings.l_FloodgateNLQSPromptTitle),this.oa.$("FloodgateNLQSPromptSubtitle",
CommonUIStrings.l_FloodgateNLQSPromptSubtitle),this.oa.$("FloodgateNLQSPromptYes",CommonUIStrings.l_FloodgateNLQSPromptYes),this.oa.$("FloodgateNLQSPromptNo",CommonUIStrings.l_FloodgateNLQSPromptNo),this.oa.$("FloodgateNLQSRatingQuestion",CommonUIStrings.l_FloodgateNLQSRatingQuestion),this.oa.$("FloodgateNLQSRating1",CommonUIStrings.l_FloodgateNLQSRating1),this.oa.$("FloodgateNLQSRating2",CommonUIStrings.l_FloodgateNLQSRating2),this.oa.$("FloodgateNLQSRating3",CommonUIStrings.l_FloodgateNLQSRating3),
this.oa.$("FloodgateNLQSRating4",CommonUIStrings.l_FloodgateNLQSRating4),this.oa.$("FloodgateNLQSRating5",CommonUIStrings.l_FloodgateNLQSRating5),this.oa.$("FloodgateNLQSDetailsQuestion",CommonUIStrings.l_FloodgateNLQSDetailsQuestion),this.oa.$("ExcelWebEaseOfUse_Prompt",CommonUIStrings.l_ExcelWeb_EaseOfUse_Prompt),this.oa.$("ExcelWebEaseOfUse_PromptQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_PromptQuestion),this.oa.$("ExcelWebEaseOfUse_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ExcelWebEaseOfUse_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ExcelWebEaseOfUse_RatingQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingQuestion),this.oa.$("ExcelWebEaseOfUse_RatingValue_1",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_1),this.oa.$("ExcelWebEaseOfUse_RatingValue_2",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_2),this.oa.$("ExcelWebEaseOfUse_RatingValue_3",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_3),this.oa.$("ExcelWebEaseOfUse_RatingValue_4",
CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_4),this.oa.$("ExcelWebEaseOfUse_RatingValue_5",CommonUIStrings.l_ExcelWeb_EaseOfUse_RatingValue_5),this.oa.$("ExcelWebEaseOfUse_WhyQuestion",CommonUIStrings.l_ExcelWeb_EaseOfUse_WhyQuestion),this.oa.$("ExcelWebPrintSurvey_Prompt",CommonUIStrings.l_ExcelWeb_PrintSurvey_Prompt),this.oa.$("ExcelWebPrintSurvey_PromptQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_PromptQuestion),this.oa.$("ExcelWebPrintSurvey_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ExcelWebPrintSurvey_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ExcelWebPrintSurvey_RatingQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingQuestion),this.oa.$("ExcelWebPrintSurvey_RatingValue_1",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_1),this.oa.$("ExcelWebPrintSurvey_RatingValue_2",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_2),this.oa.$("ExcelWebPrintSurvey_RatingValue_3",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_3),this.oa.$("ExcelWebPrintSurvey_RatingValue_4",
CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_4),this.oa.$("ExcelWebPrintSurvey_RatingValue_5",CommonUIStrings.l_ExcelWeb_PrintSurvey_RatingValue_5),this.oa.$("ExcelWebPrintSurvey_WhyQuestion",CommonUIStrings.l_ExcelWeb_PrintSurvey_WhyQuestion),this.oa.$("ReactAutoFilter_PromptLine_1",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_1),this.oa.$("ReactAutoFilter_PromptLine_2",CommonUIStrings.l_Excel_ReactAutoFilter_PromptLine_2),this.oa.$("ReactAutoFilter_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ReactAutoFilter_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ReactAutoFilter_RatingQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_RatingQuestion),this.oa.$("ReactAutoFilter_RatingValue_1",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_1),this.oa.$("ReactAutoFilter_RatingValue_2",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_2),this.oa.$("ReactAutoFilter_RatingValue_3",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_3),this.oa.$("ReactAutoFilter_RatingValue_4",
CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_4),this.oa.$("ReactAutoFilter_RatingValue_5",CommonUIStrings.l_Excel_ReactAutoFilter_RatingValue_5),this.oa.$("ReactAutoFilter_CommentQuestion",CommonUIStrings.l_Excel_ReactAutoFilter_CommentQuestion),this.oa.$("WordLinksExperience_FloodgatePromptTitle",CommonUIStrings.l_WordLinksExperience_FloodgatePromptTitle),this.oa.$("WordLinksExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordLinksExperience_FloodgatePromptQuestion),this.oa.$("WordLinksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_YesLabel),this.oa.$("WordLinksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordLinksExperience_FloodgatePrompt_NoLabel),this.oa.$("WordLinksExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateRatingQuestion),this.oa.$("WordLinksExperience_FloodgateRating_1",CommonUIStrings.l_WordLinksExperience_FloodgateRating_1),this.oa.$("WordLinksExperience_FloodgateRating_2",CommonUIStrings.l_WordLinksExperience_FloodgateRating_2),
this.oa.$("WordLinksExperience_FloodgateRating_3",CommonUIStrings.l_WordLinksExperience_FloodgateRating_3),this.oa.$("WordLinksExperience_FloodgateRating_4",CommonUIStrings.l_WordLinksExperience_FloodgateRating_4),this.oa.$("WordLinksExperience_FloodgateRating_5",CommonUIStrings.l_WordLinksExperience_FloodgateRating_5),this.oa.$("WordLinksExperience_FloodgateWhyQuestion",CommonUIStrings.l_WordLinksExperience_FloodgateWhyQuestion),this.oa.$("OnlineVideoSupport_FloodgatePromptTitle",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptTitle),
this.oa.$("OnlineVideoSupport_FloodgatePromptQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgatePromptQuestion),this.oa.$("OnlineVideoSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_YesLabel),this.oa.$("OnlineVideoSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnlineVideoSupport_FloodgatePrompt_NoLabel),this.oa.$("OnlineVideoSupport_FloodgateRatingQuestion",CommonUIStrings.l_OnlineVideoSupport_FloodgateRatingQuestion),this.oa.$("OnlineVideoSupport_FloodgateRating_1",
CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_1),this.oa.$("OnlineVideoSupport_FloodgateRating_2",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_2),this.oa.$("OnlineVideoSupport_FloodgateRating_3",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_3),this.oa.$("OnlineVideoSupport_FloodgateRating_4",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_4),this.oa.$("OnlineVideoSupport_FloodgateRating_5",CommonUIStrings.l_OnlineVideoSupport_FloodgateRating_5),this.oa.$("OnlineVideoSupport_FloodgateWhyQuestion",
CommonUIStrings.l_OnlineVideoSupport_FloodgateWhyQuestion),this.oa.$("NavPaneExperience_FloodgatePromptTitle",CommonUIStrings.l_NavPaneExperience_FloodgatePromptTitle),this.oa.$("NavPaneExperience_FloodgatePromptQuestion",CommonUIStrings.l_NavPaneExperience_FloodgatePromptQuestion),this.oa.$("NavPaneExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_YesLabel),this.oa.$("NavPaneExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_NavPaneExperience_FloodgatePrompt_NoLabel),
this.oa.$("NavPaneExperience_FloodgateRatingQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateRatingQuestion),this.oa.$("NavPaneExperience_FloodgateRating_1",CommonUIStrings.l_NavPaneExperience_FloodgateRating_1),this.oa.$("NavPaneExperience_FloodgateRating_2",CommonUIStrings.l_NavPaneExperience_FloodgateRating_2),this.oa.$("NavPaneExperience_FloodgateRating_3",CommonUIStrings.l_NavPaneExperience_FloodgateRating_3),this.oa.$("NavPaneExperience_FloodgateRating_4",CommonUIStrings.l_NavPaneExperience_FloodgateRating_4),
this.oa.$("NavPaneExperience_FloodgateRating_5",CommonUIStrings.l_NavPaneExperience_FloodgateRating_5),this.oa.$("NavPaneExperience_FloodgateWhyQuestion",CommonUIStrings.l_NavPaneExperience_FloodgateWhyQuestion),this.oa.$("BookmarksExperience_FloodgatePromptTitle",CommonUIStrings.l_BookmarksExperience_FloodgatePromptTitle),this.oa.$("BookmarksExperience_FloodgatePromptQuestion",CommonUIStrings.l_BookmarksExperience_FloodgatePromptQuestion),this.oa.$("BookmarksExperience_FloodgatePrompt_YesLabel",
CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_YesLabel),this.oa.$("BookmarksExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_BookmarksExperience_FloodgatePrompt_NoLabel),this.oa.$("BookmarksExperience_FloodgateRatingQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateRatingQuestion),this.oa.$("BookmarksExperience_FloodgateRating_1",CommonUIStrings.l_BookmarksExperience_FloodgateRating_1),this.oa.$("BookmarksExperience_FloodgateRating_2",CommonUIStrings.l_BookmarksExperience_FloodgateRating_2),
this.oa.$("BookmarksExperience_FloodgateRating_3",CommonUIStrings.l_BookmarksExperience_FloodgateRating_3),this.oa.$("BookmarksExperience_FloodgateRating_4",CommonUIStrings.l_BookmarksExperience_FloodgateRating_4),this.oa.$("BookmarksExperience_FloodgateRating_5",CommonUIStrings.l_BookmarksExperience_FloodgateRating_5),this.oa.$("BookmarksExperience_FloodgateWhyQuestion",CommonUIStrings.l_BookmarksExperience_FloodgateWhyQuestion),this.oa.$("WordPictureBorder_FloodgatePromptTitle",CommonUIStrings.l_WordPictureBorder_FloodgatePromptTitle),
this.oa.$("WordPictureBorder_FloodgatePromptQuestion",CommonUIStrings.l_WordPictureBorder_FloodgatePromptQuestion),this.oa.$("WordPictureBorder_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_YesLabel),this.oa.$("WordPictureBorder_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordPictureBorder_FloodgatePrompt_NoLabel),this.oa.$("WordPictureBorder_FloodgateRatingQuestion",CommonUIStrings.l_WordPictureBorder_FloodgateRatingQuestion),this.oa.$("WordPictureBorder_FloodgateRating_1",
CommonUIStrings.l_WordPictureBorder_FloodgateRating_1),this.oa.$("WordPictureBorder_FloodgateRating_2",CommonUIStrings.l_WordPictureBorder_FloodgateRating_2),this.oa.$("WordPictureBorder_FloodgateRating_3",CommonUIStrings.l_WordPictureBorder_FloodgateRating_3),this.oa.$("WordPictureBorder_FloodgateRating_4",CommonUIStrings.l_WordPictureBorder_FloodgateRating_4),this.oa.$("WordPictureBorder_FloodgateRating_5",CommonUIStrings.l_WordPictureBorder_FloodgateRating_5),this.oa.$("WordPictureBorder_FloodgateWhyQuestion",
CommonUIStrings.l_WordPictureBorder_FloodgateWhyQuestion),this.oa.$("WordComment_FloodgatePromptTitle",CommonUIStrings.l_WordComment_FloodgatePromptTitle),this.oa.$("WordComment_FloodgatePromptQuestion",CommonUIStrings.l_WordComment_FloodgatePromptQuestion),this.oa.$("WordComment_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_YesLabel),this.oa.$("WordComment_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordComment_FloodgatePrompt_NoLabel),this.oa.$("WordComment_FloodgateRatingQuestion",
CommonUIStrings.l_WordComment_FloodgateRatingQuestion),this.oa.$("WordComment_FloodgateRating_1",CommonUIStrings.l_WordComment_FloodgateRating_1),this.oa.$("WordComment_FloodgateRating_2",CommonUIStrings.l_WordComment_FloodgateRating_2),this.oa.$("WordComment_FloodgateRating_3",CommonUIStrings.l_WordComment_FloodgateRating_3),this.oa.$("WordComment_FloodgateRating_4",CommonUIStrings.l_WordComment_FloodgateRating_4),this.oa.$("WordComment_FloodgateRating_5",CommonUIStrings.l_WordComment_FloodgateRating_5),
this.oa.$("WordComment_FloodgateWhyQuestion",CommonUIStrings.l_WordComment_FloodgateWhyQuestion),this.oa.$("WordTrackChanges_FloodgatePromptTitle",CommonUIStrings.l_WordTrackChanges_FloodgatePromptTitle),this.oa.$("WordTrackChanges_FloodgatePromptQuestion",CommonUIStrings.l_WordTrackChanges_FloodgatePromptQuestion),this.oa.$("WordTrackChanges_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_YesLabel),this.oa.$("WordTrackChanges_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTrackChanges_FloodgatePrompt_NoLabel),
this.oa.$("WordTrackChanges_FloodgateRatingQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateRatingQuestion),this.oa.$("WordTrackChanges_FloodgateRating_1",CommonUIStrings.l_WordTrackChanges_FloodgateRating_1),this.oa.$("WordTrackChanges_FloodgateRating_2",CommonUIStrings.l_WordTrackChanges_FloodgateRating_2),this.oa.$("WordTrackChanges_FloodgateRating_3",CommonUIStrings.l_WordTrackChanges_FloodgateRating_3),this.oa.$("WordTrackChanges_FloodgateRating_4",CommonUIStrings.l_WordTrackChanges_FloodgateRating_4),
this.oa.$("WordTrackChanges_FloodgateRating_5",CommonUIStrings.l_WordTrackChanges_FloodgateRating_5),this.oa.$("WordTrackChanges_FloodgateWhyQuestion",CommonUIStrings.l_WordTrackChanges_FloodgateWhyQuestion),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_1),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_Line_2",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_Line_2),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_YesLabel),this.oa.$("CollabCorner_Survey_DownloadCopies_Prompt_NoLabel",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Prompt_NoLabel),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Question",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Question),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_1",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_1),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_2",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_2),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_3",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_3),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_4",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_4),this.oa.$("CollabCorner_Survey_DownloadCopies_Rating_Scale_5",CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Rating_Scale_5),this.oa.$("CollabCorner_Survey_DownloadCopies_Comment_Question",
CommonUIStrings.l_CollabCorner_Survey_DownloadCopies_Comment_Question),this.oa.$("WordListsExperience_FloodgatePromptTitle",CommonUIStrings.l_WordListsExperience_FloodgatePromptTitle),this.oa.$("WordListsExperience_FloodgatePromptQuestion",CommonUIStrings.l_WordListsExperience_FloodgatePromptQuestion),this.oa.$("WordListsExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_YesLabel),this.oa.$("WordListsExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordListsExperience_FloodgatePrompt_NoLabel),
this.oa.$("WordListsExperience_FloodgateRatingQuestion",CommonUIStrings.l_WordListsExperience_FloodgateRatingQuestion),this.oa.$("WordListsExperience_FloodgateRating_1",CommonUIStrings.l_WordListsExperience_FloodgateRating_1),this.oa.$("WordListsExperience_FloodgateRating_5",CommonUIStrings.l_WordListsExperience_FloodgateRating_5),this.oa.$("WordListsExperience_FloodgateAdditionalThoughts",CommonUIStrings.l_WordListsExperience_FloodgateAdditionalThoughts),this.oa.$("WordChartsSupport_FloodgatePromptTitle",
CommonUIStrings.l_WordChartsSupport_FloodgatePromptTitle),this.oa.$("WordChartsSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordChartsSupport_FloodgatePromptQuestion),this.oa.$("WordChartsSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_YesLabel),this.oa.$("WordChartsSupport_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordChartsSupport_FloodgatePrompt_NoLabel),this.oa.$("WordChartsSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateRatingQuestion),
this.oa.$("WordChartsSupport_FloodgateRating_1",CommonUIStrings.l_WordChartsSupport_FloodgateRating_1),this.oa.$("WordChartsSupport_FloodgateRating_2",CommonUIStrings.l_WordChartsSupport_FloodgateRating_2),this.oa.$("WordChartsSupport_FloodgateRating_3",CommonUIStrings.l_WordChartsSupport_FloodgateRating_3),this.oa.$("WordChartsSupport_FloodgateRating_4",CommonUIStrings.l_WordChartsSupport_FloodgateRating_4),this.oa.$("WordChartsSupport_FloodgateRating_5",CommonUIStrings.l_WordChartsSupport_FloodgateRating_5),
this.oa.$("WordChartsSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordChartsSupport_FloodgateWhyQuestion),this.oa.$("WordTablesSupport_FloodgatePromptTitle",CommonUIStrings.l_WordTablesSupport_FloodgatePromptTitle),this.oa.$("WordTablesSupport_FloodgatePromptQuestion",CommonUIStrings.l_WordTablesSupport_FloodgatePromptQuestion),this.oa.$("WordTablesSupport_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_YesLabel),this.oa.$("WordTablesSupport_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WordTablesSupport_FloodgatePrompt_NoLabel),this.oa.$("WordTablesSupport_FloodgateRatingQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateRatingQuestion),this.oa.$("WordTablesSupport_FloodgateRating_1",CommonUIStrings.l_WordTablesSupport_FloodgateRating_1),this.oa.$("WordTablesSupport_FloodgateRating_2",CommonUIStrings.l_WordTablesSupport_FloodgateRating_2),this.oa.$("WordTablesSupport_FloodgateRating_3",CommonUIStrings.l_WordTablesSupport_FloodgateRating_3),this.oa.$("WordTablesSupport_FloodgateRating_4",
CommonUIStrings.l_WordTablesSupport_FloodgateRating_4),this.oa.$("WordTablesSupport_FloodgateRating_5",CommonUIStrings.l_WordTablesSupport_FloodgateRating_5),this.oa.$("WordTablesSupport_FloodgateWhyQuestion",CommonUIStrings.l_WordTablesSupport_FloodgateWhyQuestion),this.oa.$("ModernPresence_PromptLine_1",CommonUIStrings.l_Excel_ModernPresence_PromptLine_1),this.oa.$("ModernPresence_PromptLine_2",CommonUIStrings.l_Excel_ModernPresence_PromptLine_2),this.oa.$("ModernPresence_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ModernPresence_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ModernPresence_RatingQuestion",CommonUIStrings.l_Excel_ModernPresence_RatingQuestion),this.oa.$("ModernPresence_RatingValue_1",CommonUIStrings.l_Excel_ModernPresence_RatingValue_1),this.oa.$("ModernPresence_RatingValue_2",CommonUIStrings.l_Excel_ModernPresence_RatingValue_2),this.oa.$("ModernPresence_RatingValue_3",CommonUIStrings.l_Excel_ModernPresence_RatingValue_3),this.oa.$("ModernPresence_RatingValue_4",
CommonUIStrings.l_Excel_ModernPresence_RatingValue_4),this.oa.$("ModernPresence_RatingValue_5",CommonUIStrings.l_Excel_ModernPresence_RatingValue_5),this.oa.$("ModernPresence_CommentQuestion",CommonUIStrings.l_Excel_ModernPresence_CommentQuestion),this.oa.$("WordInsertImages_FloodgatePromptTitle",CommonUIStrings.l_WordInsertImages_FloodgatePromptTitle),this.oa.$("WordInsertImages_FloodgatePromptQuestion",CommonUIStrings.l_WordInsertImages_FloodgatePromptQuestion),this.oa.$("WordInsertImages_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WordInsertImages_FloodgatePrompt_YesLabel),this.oa.$("WordInsertImages_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordInsertImages_FloodgatePrompt_NoLabel),this.oa.$("WordInsertImages_FloodgateRatingQuestion",CommonUIStrings.l_WordInsertImages_FloodgateRatingQuestion),this.oa.$("WordInsertImages_FloodgateRating_1",CommonUIStrings.l_WordInsertImages_FloodgateRating_1),this.oa.$("WordInsertImages_FloodgateRating_2",CommonUIStrings.l_WordInsertImages_FloodgateRating_2),this.oa.$("WordInsertImages_FloodgateRating_3",
CommonUIStrings.l_WordInsertImages_FloodgateRating_3),this.oa.$("WordInsertImages_FloodgateRating_4",CommonUIStrings.l_WordInsertImages_FloodgateRating_4),this.oa.$("WordInsertImages_FloodgateRating_5",CommonUIStrings.l_WordInsertImages_FloodgateRating_5),this.oa.$("WordInsertImages_FloodgateWhyQuestion",CommonUIStrings.l_WordInsertImages_FloodgateWhyQuestion),this.oa.$("FontPicker_FloodgatePromptTitle",CommonUIStrings.l_FontPicker_FloodgatePromptTitle),this.oa.$("FontPicker_FloodgatePromptQuestion",
CommonUIStrings.l_FontPicker_FloodgatePromptQuestion),this.oa.$("FontPicker_FloodgatePromptYesLabel",CommonUIStrings.l_FontPicker_FloodgatePromptYesLabel),this.oa.$("FontPicker_FloodgatePromptNoLabel",CommonUIStrings.l_FontPicker_FloodgatePromptNoLabel),this.oa.$("FontPicker_FloodgateRatingQuestion",CommonUIStrings.l_FontPicker_FloodgateRatingQuestion),this.oa.$("FontPicker_FloodgateRating1",CommonUIStrings.l_FontPicker_FloodgateRating1),this.oa.$("FontPicker_FloodgateRating2",CommonUIStrings.l_FontPicker_FloodgateRating2),
this.oa.$("FontPicker_FloodgateRating3",CommonUIStrings.l_FontPicker_FloodgateRating3),this.oa.$("FontPicker_FloodgateRating4",CommonUIStrings.l_FontPicker_FloodgateRating4),this.oa.$("FontPicker_FloodgateRating5",CommonUIStrings.l_FontPicker_FloodgateRating5),this.oa.$("FontPicker_FloodgateCommentQuestion",CommonUIStrings.l_FontPicker_FloodgateCommentQuestion),this.oa.$("FormulasMenu_PromptLine_1",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_1),this.oa.$("FormulasMenu_PromptLine_2",CommonUIStrings.l_Excel_FormulasMenu_PromptLine_2),
this.oa.$("FormulasMenu_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FormulasMenu_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FormulasMenu_RatingQuestion",CommonUIStrings.l_Excel_FormulasMenu_RatingQuestion),this.oa.$("FormulasMenu_RatingValue_1",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_1),this.oa.$("FormulasMenu_RatingValue_2",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_2),this.oa.$("FormulasMenu_RatingValue_3",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_3),
this.oa.$("FormulasMenu_RatingValue_4",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_4),this.oa.$("FormulasMenu_RatingValue_5",CommonUIStrings.l_Excel_FormulasMenu_RatingValue_5),this.oa.$("FormulasMenu_CommentQuestion",CommonUIStrings.l_Excel_FormulasMenu_CommentQuestion),this.oa.$("WordWebEditorSeen_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.oa.$("WordWebEditorSeen_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("WordWebEditorSeen_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("WordWebEditorSeen_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordWebEditorSeen_FloodgateRatingQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateRatingQuestion),this.oa.$("WordWebEditorSeen_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.oa.$("WordWebEditorSeen_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.oa.$("WordWebEditorSeen_FloodgateRating_3",
CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),this.oa.$("WordWebEditorSeen_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.oa.$("WordWebEditorSeen_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.oa.$("WordWebEditorSeen_FloodgateWhyQuestion",CommonUIStrings.l_WordWebEditorSeen_FloodgateWhyQuestion),this.oa.$("OnenotePerf_FloodgatePromptTitle",Xb.fkj()),this.oa.$("OnenotePerf_FloodgatePromptQuestion",
CommonUIStrings.l_OnenotePerf_FloodgatePromptQuestion),this.oa.$("OnenotePerf_FloodgatePrompt_YesLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_YesLabel),this.oa.$("OnenotePerf_FloodgatePrompt_NoLabel",CommonUIStrings.l_OnenotePerf_FloodgatePrompt_NoLabel),this.oa.$("OnenotePerf_FloodgateRatingQuestion",Xb.gkj()),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_1",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_1),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_2",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_2),
this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_3",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_3),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_4",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_4),this.oa.$("OnenotePerf_FloodgateRatingQuestionChoice_5",CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionChoice_5),this.oa.$("OnenotePerf_FloodgateWhyQuestion",CommonUIStrings.l_OnenotePerf_FloodgateWhyQuestion),this.oa.$("OnenoteInkSurvey_Prompt",CommonUIStrings.l_OnenoteInkSurvey_Prompt),
this.oa.$("OnenoteInkSurvey_PromptQuestion",CommonUIStrings.l_InkSurvey_PromptQuestion),this.oa.$("OnenoteInkSurvey_Prompt_Sure",CommonUIStrings.l_InkSurvey_Prompt_Sure),this.oa.$("OnenoteInkSurvey_Prompt_NoNow",CommonUIStrings.l_InkSurvey_Prompt_NoNow),this.oa.$("OnenoteInkSurvey_RatingQuestion",CommonUIStrings.l_OnenoteInkSurvey_RatingQuestion),this.oa.$("OnenoteInkSurvey_QuestionChoice_1",CommonUIStrings.l_InkSurvey_QuestionChoice_1),this.oa.$("OnenoteInkSurvey_QuestionChoice_2",CommonUIStrings.l_InkSurvey_QuestionChoice_2),
this.oa.$("OnenoteInkSurvey_QuestionChoice_3",CommonUIStrings.l_InkSurvey_QuestionChoice_3),this.oa.$("OnenoteInkSurvey_QuestionChoice_4",CommonUIStrings.l_InkSurvey_QuestionChoice_4),this.oa.$("OnenoteInkSurvey_QuestionChoice_5",CommonUIStrings.l_InkSurvey_QuestionChoice_5),this.oa.$("OnenoteInkSurvey_WhyQuestion",CommonUIStrings.l_InkSurvey_WhyQuestion),this.oa.$("OnenotePenInkSurvey_Prompt",CommonUIStrings.l_OnenotePenInkSurvey_Prompt),this.oa.$("OnenotePenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),
this.oa.$("OnenotePenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("OnenotePenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("OnenotePenInkSurvey_RatingQuestion",CommonUIStrings.l_OnenotePenInkSurvey_RatingQuestion),this.oa.$("OnenotePenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("OnenotePenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.oa.$("OnenotePenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.oa.$("OnenotePenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("OnenotePenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("OnenotePenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.oa.$("PenInkSurvey_Prompt",CommonUIStrings.l_PenInkSurvey_Prompt),
this.oa.$("PenInkSurvey_RatingQuestion",CommonUIStrings.l_PenInkSurvey_RatingQuestion),this.oa.$("PenInkSurvey_PromptQuestion",CommonUIStrings.l_PenInkSurvey_PromptQuestion),this.oa.$("PenInkSurvey_Prompt_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("PenInkSurvey_Prompt_NoNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("PenInkSurvey_QuestionChoice_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("PenInkSurvey_QuestionChoice_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),
this.oa.$("PenInkSurvey_QuestionChoice_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.oa.$("PenInkSurvey_QuestionChoice_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("PenInkSurvey_QuestionChoice_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("PenInkSurvey_WhyQuestion",CommonUIStrings.l_PenInkSurvey_WhyQuestion),this.oa.$("SkittleFloodgateTitle",CommonUIStrings.l_Skittle_FeedbackTitle),this.oa.$("SkittleFloodgatePrompt",
CommonUIStrings.l_Skittle_FeedbackPrompt),this.oa.$("SkittleFloodgateRatingQuestion",CommonUIStrings.l_Skittle_FeedbackRatingQuestion),this.oa.$("SkittleFloodgateQuestion",CommonUIStrings.l_Skittle_FeedbackQuestion),this.oa.$("SkittleFloodgateMinRating",CommonUIStrings.l_Skittle_FeedbackMinRating),this.oa.$("SkittleFloodgateMaxRating",CommonUIStrings.l_Skittle_FeedbackMaxRating),this.oa.$("WordDocumentModes_FloodgatePromptTitle",CommonUIStrings.l_WordDocumentModes_FloodgatePromptTitle),this.oa.$("WordDocumentModes_FloodgatePromptQuestion",
CommonUIStrings.l_WordDocumentModes_FloodgatePromptQuestion),this.oa.$("WordDocumentModes_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_YesLabel),this.oa.$("WordDocumentModes_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordDocumentModes_FloodgatePrompt_NoLabel),this.oa.$("WordDocumentModes_FloodgateRatingQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateRatingQuestion),this.oa.$("WordDocumentModes_FloodgateRating_1",CommonUIStrings.l_WordDocumentModes_FloodgateRating_1),
this.oa.$("WordDocumentModes_FloodgateRating_5",CommonUIStrings.l_WordDocumentModes_FloodgateRating_5),this.oa.$("WordDocumentModes_FloodgateWhyQuestion",CommonUIStrings.l_WordDocumentModes_FloodgateWhyQuestion),this.oa.$("WordDesignerFloodgateTitle",CommonUIStrings.l_WordDesigner_FeedbackTitle),this.oa.$("WordDesignerFloodgatePrompt",CommonUIStrings.l_WordDesigner_FeedbackPrompt),this.oa.$("WordDesignerFloodgatePromptYesLabel",CommonUIStrings.l_WordDesigner_FloodgatePrompt_YesLabel),this.oa.$("WordDesignerFloodgatePromptNoLabel",
CommonUIStrings.l_WordDesigner_FloodgatePrompt_NoLabel),this.oa.$("WordDesignerFloodgateRatingQuestion",CommonUIStrings.l_WordDesigner_FeedbackRatingQuestion),this.oa.$("WordDesignerFloodgateMinRating",CommonUIStrings.l_WordDesigner_FeedbackMinRating),this.oa.$("WordDesignerFloodgateMaxRating",CommonUIStrings.l_WordDesigner_FeedbackMaxRating),this.oa.$("WordDesignerFloodgateQuestion",CommonUIStrings.l_WordDesigner_FeedbackQuestion1),this.oa.$("WordDesignerBlankDocumentExperienceTitle",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedTitle),
this.oa.$("WordDesignerBlankDocumentExperienceRatingQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedRatingQuestion),this.oa.$("WordDesignerBlankDocumentExperienceCommentQuestion",CommonUIStrings.l_WordDesigner_BlankDocumentExperience_UserInitiatedCommentQuestion),this.oa.$("WordDesignerT2ISurveyQuestion",CommonUIStrings.l_WordDesigner_T2ISurveyQuestion),this.oa.$("WordDesignerPQSurveyQuestion",CommonUIStrings.l_WordDesigner_PQSurveyQuestion),this.oa.$("WordDesignerFormattingSuggestionsSurveyQuestion",
CommonUIStrings.l_WordDesigner_FormattingSuggestionsSurveyQuestion),this.oa.$("WordDesignerAllContextualSuggestionsFeedbackRatingQuestion",CommonUIStrings.l_WordDesigner_AllContextualSuggestionsFeedbackRatingQuestion),this.oa.$("WordDesignerDesignerPasteFeedbackRatingQuestion",Xb.hkj()),this.oa.$("WordDesignerHideSuggestionsQuestion",CommonUIStrings.l_WordDesigner_HideSuggestionsQuestion),this.oa.$("WordDesignerHideSuggestionsAnswer1",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_1),this.oa.$("WordDesignerHideSuggestionsAnswer2",
CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_2),this.oa.$("WordDesignerHideSuggestionsAnswer3",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_3),this.oa.$("WordDesignerHideSuggestionsAnswer4",CommonUIStrings.l_WordDesigner_HideSuggestionsAnswer_4),this.oa.$("FpsInDocSearch_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptTitle),this.oa.$("FpsInDocSearch_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgatePromptQuestion),this.oa.$("FpsInDocSearch_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FpsInDocSearch_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FpsInDocSearch_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateRatingQuestion),this.oa.$("FpsInDocSearch_FloodgateRating_1",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_1),this.oa.$("FpsInDocSearch_FloodgateRating_2",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_2),this.oa.$("FpsInDocSearch_FloodgateRating_3",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_3),
this.oa.$("FpsInDocSearch_FloodgateRating_4",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_4),this.oa.$("FpsInDocSearch_FloodgateRating_5",CommonUIStrings.l_FpsInDocSearch_FloodgateRating_5),this.oa.$("FpsInDocSearch_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocSearch_FloodgateWhyQuestion),this.oa.$("FpsInDocQna_FloodgatePromptTitle",CommonUIStrings.l_FpsInDocQna_FloodgatePromptTitle),this.oa.$("FpsInDocQna_FloodgatePromptQuestion",CommonUIStrings.l_FpsInDocQna_FloodgatePromptQuestion),this.oa.$("FpsInDocQna_FloodgatePrompt_YesLabel",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("FpsInDocQna_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("FpsInDocQna_FloodgateRatingQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateRatingQuestion),this.oa.$("FpsInDocQna_FloodgateRating_1",CommonUIStrings.l_FpsInDocQna_FloodgateRating_1),this.oa.$("FpsInDocQna_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.oa.$("FpsInDocQna_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),
this.oa.$("FpsInDocQna_FloodgateRating_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.oa.$("FpsInDocQna_FloodgateRating_5",CommonUIStrings.l_FpsInDocQna_FloodgateRating_5),this.oa.$("FpsInDocQna_FloodgateWhyQuestion",CommonUIStrings.l_FpsInDocQna_FloodgateWhyQuestion),this.oa.$("AtMentionFPS_Title",CommonUIStrings.l_WAC_AtMentionFPS_Title),this.oa.$("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.oa.$("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),
this.oa.$("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.oa.$("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.oa.$("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.oa.$("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),this.oa.$("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.oa.$("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),
this.oa.$("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.oa.$("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.oa.$("ClientPaginationSurvey_Title",CommonUIStrings.l_WAC_ClientPaginationSurvey_Title),this.oa.$("ClientPaginationSurvey_Question",CommonUIStrings.l_WAC_ClientPaginationSurvey_Question),this.oa.$("ClientPaginationSurvey_YesLabel",CommonUIStrings.l_WAC_ClientPaginationSurvey_YesLabel),this.oa.$("ClientPaginationSurvey_NoLabel",
CommonUIStrings.l_WAC_ClientPaginationSurvey_NoLabel),this.oa.$("ClientPaginationSurvey_RatingQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingQuestion),this.oa.$("ClientPaginationSurvey_RatingValue_1",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_1),this.oa.$("ClientPaginationSurvey_RatingValue_2",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_2),this.oa.$("ClientPaginationSurvey_RatingValue_3",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_3),this.oa.$("ClientPaginationSurvey_RatingValue_4",
CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_4),this.oa.$("ClientPaginationSurvey_RatingValue_5",CommonUIStrings.l_WAC_ClientPaginationSurvey_RatingValue_5),this.oa.$("ClientPaginationSurvey_WhyQuestion",CommonUIStrings.l_WAC_ClientPaginationSurvey_WhyQuestion),this.oa.$("CIQAtInvokeFPS_Title",CommonUIStrings.l_WAC_CIQAtInvokeFPS_Title),this.oa.$("CIQAtInvokeFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("CIQAtInvokeFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("CIQAtInvokeFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("CIQAtInvokeFPS_RatingQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_RatingQuestion),this.oa.$("CIQAtInvokeFPS_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1),this.oa.$("CIQAtInvokeFPS_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2),this.oa.$("CIQAtInvokeFPS_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3),this.oa.$("CIQAtInvokeFPS_RatingValue_4",
CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4),this.oa.$("CIQAtInvokeFPS_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5),this.oa.$("CIQAtInvokeFPS_WhyQuestion",CommonUIStrings.l_WAC_CIQAtInvokeFPS_WhyQuestion),this.oa.$("ConditionalFormatting_PromptLine_1",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_1),this.oa.$("ConditionalFormatting_PromptLine_2",CommonUIStrings.l_Excel_ConditionalFormatting_PromptLine_2),this.oa.$("ConditionalFormatting_PromptLabel_Sure",
CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ConditionalFormatting_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ConditionalFormatting_RatingQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_RatingQuestion),this.oa.$("ConditionalFormatting_RatingValue_1",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_1),this.oa.$("ConditionalFormatting_RatingValue_2",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_2),this.oa.$("ConditionalFormatting_RatingValue_3",
CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_3),this.oa.$("ConditionalFormatting_RatingValue_4",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_4),this.oa.$("ConditionalFormatting_RatingValue_5",CommonUIStrings.l_Excel_ConditionalFormatting_RatingValue_5),this.oa.$("ConditionalFormatting_CommentQuestion",CommonUIStrings.l_Excel_ConditionalFormatting_CommentQuestion),this.oa.$("InAppNotification_Title",CommonUIStrings.l_WAC_InAppNotification_Title),this.oa.$("InAppNotification_Description",
CommonUIStrings.l_WAC_InAppNotification_Description),this.oa.$("InAppNotification_Button1_AddinTab",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinTab),this.oa.$("InAppNotification_Button1_AddinButton",CommonUIStrings.l_WAC_InAppNotification_Button1_AddinButton),this.oa.$("InAppNotification_Button2",CommonUIStrings.l_WAC_InAppNotification_Button2),this.oa.$("BlueDotsFPS_Title",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.oa.$("BlueDotsFPS_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.oa.$("BlueDotsFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("BlueDotsFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("BlueDotsFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_RatingQuestion),this.oa.$("BlueDotsFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.oa.$("BlueDotsFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.oa.$("BlueDotsFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),
this.oa.$("BlueDotsFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.oa.$("BlueDotsFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.oa.$("BlueDotsFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpBlueDotsFPS_WhyQuestion),this.oa.$("WordWebOpeningDocuments_FloodgatePromptTitle",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptTitle),this.oa.$("WordWebOpeningDocuments_FloodgatePromptQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePromptQuestion),
this.oa.$("WordWebOpeningDocuments_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_YesLabel),this.oa.$("WordWebOpeningDocuments_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordWebOpeningDocuments_FloodgatePrompt_NoLabel),this.oa.$("WordWebOpeningDocuments_FloodgateRatingQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRatingQuestion),this.oa.$("WordWebOpeningDocuments_FloodgateRating_1",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_1),this.oa.$("WordWebOpeningDocuments_FloodgateRating_2",
CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_2),this.oa.$("WordWebOpeningDocuments_FloodgateRating_3",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_3),this.oa.$("WordWebOpeningDocuments_FloodgateRating_4",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_4),this.oa.$("WordWebOpeningDocuments_FloodgateRating_5",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateRating_5),this.oa.$("WordWebOpeningDocuments_FloodgateTellUsMoreQuestion",CommonUIStrings.l_WordWebOpeningDocuments_FloodgateTellUsMore),
this.oa.$("WordCommentReaction_FloodgatePromptTitle",CommonUIStrings.l_WordCommentReaction_FloodgatePromptTitle),this.oa.$("WordCommentReaction_FloodgatePromptQuestion",CommonUIStrings.l_WordCommentReaction_FloodgatePromptQuestion),this.oa.$("WordCommentReaction_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_YesLabel),this.oa.$("WordCommentReaction_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordCommentReaction_FloodgatePrompt_NoLabel),this.oa.$("WordCommentReaction_FloodgateRatingQuestion",
CommonUIStrings.l_WordCommentReaction_FloodgateRatingQuestion),this.oa.$("WordCommentReaction_FloodgateRating_1",CommonUIStrings.l_WordCommentReaction_FloodgateRating_1),this.oa.$("WordCommentReaction_FloodgateRating_2",CommonUIStrings.l_WordCommentReaction_FloodgateRating_2),this.oa.$("WordCommentReaction_FloodgateRating_3",CommonUIStrings.l_WordCommentReaction_FloodgateRating_3),this.oa.$("WordCommentReaction_FloodgateRating_4",CommonUIStrings.l_WordCommentReaction_FloodgateRating_4),this.oa.$("WordCommentReaction_FloodgateRating_5",
CommonUIStrings.l_WordCommentReaction_FloodgateRating_5),this.oa.$("WordCommentReaction_FloodgateWhyQuestion",CommonUIStrings.l_WordCommentReaction_FloodgateWhyQuestion),this.oa.$("GuestCoauthoring_FloodgatePromptTitle",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptTitle),this.oa.$("GuestCoauthoring_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_PromptQuestion),this.oa.$("GuestCoauthoring_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GuestCoauthSurvey_YesLabel),this.oa.$("GuestCoauthoring_FloodgatePrompt_NoLabel",
CommonUIStrings.l_WAC_GuestCoauthSurvey_NoLabel),this.oa.$("GuestCoauthoring_FloodgateQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_FloodgateQuestion),this.oa.$("GuestCoauthoring_FloodgateRatingValue_1",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_1),this.oa.$("GuestCoauthoring_FloodgateRatingValue_2",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_2),this.oa.$("GuestCoauthoring_FloodgateRatingValue_3",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_3),this.oa.$("GuestCoauthoring_FloodgateRatingValue_4",
CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_4),this.oa.$("GuestCoauthoring_FloodgateRatingValue_5",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingValue_5),this.oa.$("GuestCoauthoring_FloodgateRatingQuestion",CommonUIStrings.l_WAC_GuestCoauthSurvey_RatingQuestion),this.oa.$("CtrlClickExperience_FloodgatePromptTitle",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptTitle),this.oa.$("CtrlClickExperience_FloodgatePromptQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgatePromptQuestion),
this.oa.$("CtrlClickExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_YesLabel),this.oa.$("CtrlClickExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CtrlClickExperience_FloodgatePrompt_NoLabel),this.oa.$("CtrlClickExperience_FloodgateRatingQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateRatingQuestion),this.oa.$("CtrlClickExperience_FloodgateRating_1",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_1),this.oa.$("CtrlClickExperience_FloodgateRating_2",
CommonUIStrings.l_CtrlClickExperience_FloodgateRating_2),this.oa.$("CtrlClickExperience_FloodgateRating_3",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_3),this.oa.$("CtrlClickExperience_FloodgateRating_4",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_4),this.oa.$("CtrlClickExperience_FloodgateRating_5",CommonUIStrings.l_CtrlClickExperience_FloodgateRating_5),this.oa.$("CtrlClickExperience_FloodgateWhyQuestion",CommonUIStrings.l_CtrlClickExperience_FloodgateWhyQuestion),this.oa.$("WordTypingResponsiveness_FloodgatePromptTitle",
CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptTitle),this.oa.$("WordTypingResponsiveness_FloodgatePromptQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePromptQuestion),this.oa.$("WordTypingResponsiveness_FloodgatePrompt_YesLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_YesLabel),this.oa.$("WordTypingResponsiveness_FloodgatePrompt_NoLabel",CommonUIStrings.l_WordTypingResponsiveness_FloodgatePrompt_NoLabel),this.oa.$("WordTypingResponsiveness_FloodgateRatingQuestion",
CommonUIStrings.l_WordTypingResponsiveness_FloodgateRatingQuestion),this.oa.$("WordTypingResponsiveness_FloodgateRating_1",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_1),this.oa.$("WordTypingResponsiveness_FloodgateRating_2",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_2),this.oa.$("WordTypingResponsiveness_FloodgateRating_3",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_3),this.oa.$("WordTypingResponsiveness_FloodgateRating_4",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_4),
this.oa.$("WordTypingResponsiveness_FloodgateRating_5",CommonUIStrings.l_WordTypingResponsiveness_FloodgateRating_5),this.oa.$("WordTypingResponsiveness_FloodgateWhyQuestion",CommonUIStrings.l_WordTypingResponsiveness_FloodgateWhyQuestion),this.oa.$("ShareSection_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_PromptLine_1),this.oa.$("ShareSection_PromptLine_2",CommonUIStrings.l_Excel_ShareSection_PromptLine_2),this.oa.$("ShareSection_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("ShareSection_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ShareSection_RatingQuestion",CommonUIStrings.l_Excel_ShareSection_RatingQuestion),this.oa.$("ShareSection_RatingValue_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.oa.$("ShareSection_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.oa.$("ShareSection_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.oa.$("ShareSection_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),
this.oa.$("ShareSection_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.oa.$("ShareSection_CommentQuestion",CommonUIStrings.l_Excel_ShareSection_CommentQuestion),this.oa.$("ShareSection_LinkCreation_PromptLine_1",CommonUIStrings.l_Excel_ShareSection_LinkGeneration_PromptLine_1),this.oa.$("WordUnsavedPrompt_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.oa.$("WordUnsavedPrompt_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),
this.oa.$("WordUnsavedPrompt_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("WordUnsavedPrompt_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("WordUnsavedPrompt_FloodgateRatingQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRatingQuestion),this.oa.$("WordUnsavedPrompt_FloodgateRating_1",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_1),this.oa.$("WordUnsavedPrompt_FloodgateRating_2",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_2),
this.oa.$("WordUnsavedPrompt_FloodgateRating_3",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_3),this.oa.$("WordUnsavedPrompt_FloodgateRating_4",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_4),this.oa.$("WordUnsavedPrompt_FloodgateRating_5",CommonUIStrings.l_WordUnsavedPrompt_FloodgateRating_5),this.oa.$("WordUnsavedPrompt_FloodgateWhyQuestion",CommonUIStrings.l_WordUnsavedPrompt_FloodgateWhyQuestion),this.oa.$("ExcelLive_PromptLine_1",CommonUIStrings.l_Excel_ExcelLive_PromptLine_1),
this.oa.$("ExcelLive_PromptLine_2",CommonUIStrings.l_Excel_ExcelLive_PromptLine_2),this.oa.$("ExcelLive_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("ExcelLive_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ExcelLive_RatingQuestion",CommonUIStrings.l_Excel_ExcelLive_RatingQuestion),this.oa.$("ExcelLive_RatingValue_1",CommonUIStrings.l_Excel_ExcelLive_RatingValue_1),this.oa.$("ExcelLive_RatingValue_2",CommonUIStrings.l_Excel_ExcelLive_RatingValue_2),
this.oa.$("ExcelLive_RatingValue_3",CommonUIStrings.l_Excel_ExcelLive_RatingValue_3),this.oa.$("ExcelLive_RatingValue_4",CommonUIStrings.l_Excel_ExcelLive_RatingValue_4),this.oa.$("ExcelLive_RatingValue_5",CommonUIStrings.l_Excel_ExcelLive_RatingValue_5),this.oa.$("ExcelLive_CommentQuestion",CommonUIStrings.l_Excel_ExcelLive_CommentQuestion),this.oa.$("SmartViewFormatAsTable_Prompt",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Prompt),this.oa.$("SmartViewFormatAsTable_PromptQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_PromptQuestion),
this.oa.$("SmartViewFormatAsTable_Rating_Question",CommonUIStrings.l_Excel_SmartViewFormatAsTable_Rating_Question),this.oa.$("SmartViewFormatAsTable_RatingValue_1",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_1),this.oa.$("SmartViewFormatAsTable_RatingValue_2",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_2),this.oa.$("SmartViewFormatAsTable_RatingValue_3",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_3),this.oa.$("SmartViewFormatAsTable_RatingValue_4",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_4),
this.oa.$("SmartViewFormatAsTable_RatingValue_5",CommonUIStrings.l_Excel_SmartViewFormatAsTable_RatingValue_5),this.oa.$("SmartViewFormatAsTable_WhyQuestion",CommonUIStrings.l_Excel_SmartViewFormatAsTable_WhyQuestion),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_PromptTitle),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_NotNow",
CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("EaseOfDiscoveringCommand_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingQuestion),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_1),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_2),
this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_3),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_4",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_4),this.oa.$("EaseOfDiscoveringCommand_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_RatingValue_5),this.oa.$("EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfDiscoveringCommand_Floodgate_HearMoreQuestion),
this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptTitle",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_PromptTitle),this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("EaseOfEditingAndFormatting_Floodgate_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingQuestion",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingQuestion),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_1",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_1),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_2",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_2),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_3",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_3),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_4",
CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_4),this.oa.$("EaseOfEditingAndFormatting_Floodgate_RatingValue_5",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_RatingValue_5),this.oa.$("EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion",CommonUIStrings.l_EaseOfEditingAndFormatting_Floodgate_HearMoreQuestion),this.oa.$("EaseOfUse_Floodgate_Prompt_Line1",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line1),this.oa.$("EaseOfUse_Floodgate_Prompt_Line2",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Line2),
this.oa.$("EaseOfUse_Floodgate_Prompt_Affirmative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Affirmative_Answer),this.oa.$("EaseOfUse_Floodgate_Prompt_Negative_Answer",CommonUIStrings.l_EaseOfUse_Floodgate_Prompt_Negative_Answer),this.oa.$("EaseOfUse_Floodgate_Rating_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Question),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_1",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_1),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_2",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_2),
this.oa.$("EaseOfUse_Floodgate_Rating_Scale_3",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_3),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_4",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_4),this.oa.$("EaseOfUse_Floodgate_Rating_Scale_5",CommonUIStrings.l_EaseOfUse_Floodgate_Rating_Scale_5),this.oa.$("EaseOfUse_Floodgate_Comment_Question",CommonUIStrings.l_EaseOfUse_Floodgate_Comment_Question),this.oa.$("PerformanceExperience_PromptLine_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),
this.oa.$("PerformanceExperience_PromptLine_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("PerformanceExperience_RatingQuestion",Xb.k2b(0)),this.oa.$("PerformanceExperience_RatingQuestion_OpenFile",Xb.k2b(1)),this.oa.$("PerformanceExperience_RatingQuestion_Responsivness",Xb.k2b(2)),this.oa.$("PerformanceExperience_RatingQuestion_OpenFile_CurrentSession",Xb.k2b(3)),this.oa.$("PerformanceExperience_RatingQuestion_Responsivness_CurrentSession",Xb.k2b(4)),this.oa.$("PerformanceExperience_RatingValue_1",
CommonUIStrings.l_Excel_Rating_1_Satisfied),this.oa.$("PerformanceExperience_RatingValue_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.oa.$("PerformanceExperience_RatingValue_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.oa.$("PerformanceExperience_RatingValue_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.oa.$("PerformanceExperience_RatingValue_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.oa.$("PerformanceExperience_CommentQuestion",CommonUIStrings.l_Excel_PerformanceExperience_CommentQuestion),
this.oa.$("CleanData_PromptTitle",CommonUIStrings.l_Excel_CleanData_Survey_PromptTitle),this.oa.$("CleanData_PromptQuestion",CommonUIStrings.l_Excel_CleanData_Survey_PromptQuestion),this.oa.$("CleanData_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("CleanData_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("CleanData_RatingQuestion",CommonUIStrings.l_Excel_CleanData_Survey_RatingQuestion),this.oa.$("CleanData_RatingValue_1",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_1),
this.oa.$("CleanData_RatingValue_2",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_2),this.oa.$("CleanData_RatingValue_3",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_3),this.oa.$("CleanData_RatingValue_4",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_4),this.oa.$("CleanData_RatingValue_5",CommonUIStrings.l_Excel_CleanData_Survey_RatingValue_5),this.oa.$("CleanData_CommentQuestion",CommonUIStrings.l_Excel_CleanData_Survey_CommentQuestion),this.oa.$("DarkModeSurvey_Title",CommonUIStrings.l_WAC_DarkModeSurvey_Title),
this.oa.$("DarkModeSurvey_Question",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("DarkModeSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("DarkModeSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("DarkModeSurvey_RatingQuestion",CommonUIStrings.l_WAC_DarkModeSurvey_RatingQuestion),this.oa.$("DarkModeSurvey_RatingValue_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("DarkModeSurvey_RatingValue_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),
this.oa.$("DarkModeSurvey_RatingValue_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.oa.$("DarkModeSurvey_RatingValue_4",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_4_SomewhatSatisfied),this.oa.$("DarkModeSurvey_RatingValue_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("DarkModeSurvey_WhyQuestion",CommonUIStrings.l_WAC_GenericSurvey_WhyThatRatingQuestion),this.oa.$("Fluent2Survey_Title",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_1),
this.oa.$("Fluent2Survey_Question",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Prompt_Line_2),this.oa.$("Fluent2Survey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("Fluent2Survey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("Fluent2Survey_RatingQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question),this.oa.$("Fluent2Survey_RatingValue_1",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_1),this.oa.$("Fluent2Survey_RatingValue_2",
CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_2),this.oa.$("Fluent2Survey_RatingValue_3",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_3),this.oa.$("Fluent2Survey_RatingValue_4",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_4),this.oa.$("Fluent2Survey_RatingValue_5",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_Rating_Question_Option_5),this.oa.$("Fluent2Survey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),
this.oa.$("Fluent2OptOutSurvey_Title",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_1),this.oa.$("Fluent2OptOutSurvey_Question",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Prompt_Line_2),this.oa.$("Fluent2OptOutSurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("Fluent2OptOutSurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("Fluent2OptOutSurvey_RatingQuestion",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question),
this.oa.$("Fluent2OptOutSurvey_RatingValue_1",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_1),this.oa.$("Fluent2OptOutSurvey_RatingValue_2",CommonUIStrings.l_Fluent2StyleOptOutFloodgateSurvey_Rating_Question_Option_2),this.oa.$("Fluent2OptOutSurvey_WhyQuestion",CommonUIStrings.l_Fluent2StyleFloodgateSurvey_CommentQuestion),this.oa.$("ConsumerExperiment_PromptTitle",CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptTitle),this.oa.$("ConsumerExperiment_PromptQuestion",
CommonUIStrings.l_ConsumerExperiment_Floodgate_PromptQuestion),this.oa.$("ConsumerExperiment_RatingQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingQuestion),this.oa.$("ConsumerExperiment_RatingValue1",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_1),this.oa.$("ConsumerExperiment_RatingValue2",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_2),this.oa.$("ConsumerExperiment_RatingValue3",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_3),this.oa.$("ConsumerExperiment_RatingValue4",
CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_4),this.oa.$("ConsumerExperiment_RatingValue5",CommonUIStrings.l_ConsumerExperiment_Floodgate_RatingValue_5),this.oa.$("ConsumerExperiment_VerbatimQuestion",CommonUIStrings.l_ConsumerExperiment_Floodgate_Verbatim_Question),this.oa.$("ConsumerExperiment_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("ConsumerExperiment_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("AIMakerSurvey_Title",CommonUIStrings.l_AIMakerSurvey_Title),
this.oa.$("AIMakerSurvey_Question",CommonUIStrings.l_AIMakerSurvey_Question),this.oa.$("AIMakerSurvey_YesLabel",CommonUIStrings.l_AIMakerSurvey_YesLabel),this.oa.$("AIMakerSurvey_NoLabel",CommonUIStrings.l_AIMakerSurvey_NoLabel),this.oa.$("AIMakerSurvey_RatingQuestion",CommonUIStrings.l_AIMakerSurvey_RatingQuestion),this.oa.$("AIMakerSurvey_MinRating",CommonUIStrings.l_AIMakerSurvey_MinRating),this.oa.$("AIMakerSurvey_MaxRating",CommonUIStrings.l_AIMakerSurvey_MaxRating),this.oa.$("AIMakerSurvey_CommentQuestion",
CommonUIStrings.l_AIMakerSurvey_CommentQuestion),this.oa.$("CheckPerformance_Prompt",CommonUIStrings.l_Excel_CheckPerformance_Prompt),this.oa.$("CheckPerformance_PromptQuestion",CommonUIStrings.l_Excel_CheckPerformance_PromptQuestion),this.oa.$("CheckPerformance_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("CheckPerformance_PromptLabel_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("CheckPerformance_RatingQuestion",CommonUIStrings.l_Excel_CheckPerformance_RatingQuestion),
this.oa.$("CheckPerformance_RatingValue_1",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_1),this.oa.$("CheckPerformance_RatingValue_2",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_2),this.oa.$("CheckPerformance_RatingValue_3",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_3),this.oa.$("CheckPerformance_RatingValue_4",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_4),this.oa.$("CheckPerformance_RatingValue_5",CommonUIStrings.l_Excel_CheckPerformance_RatingValue_5),this.oa.$("CheckPerformance_CommentQuestion",
CommonUIStrings.l_Excel_CheckPerformance_CommentQuestion),this.oa.$("SmartSuggestion_PromptTitle",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptTitle),this.oa.$("SmartSuggestion_PromptQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_PromptQuestion),this.oa.$("SmartSuggestion_PromptAnswer_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("SmartSuggestion_PromptAnswer_NotNow",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.oa.$("SmartSuggestion_RatingQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingQuestion),
this.oa.$("SmartSuggestion_RatingValue_1",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_1),this.oa.$("SmartSuggestion_RatingValue_2",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_2),this.oa.$("SmartSuggestion_RatingValue_3",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_3),this.oa.$("SmartSuggestion_RatingValue_4",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_4),this.oa.$("SmartSuggestion_RatingValue_5",CommonUIStrings.l_Excel_SmartSuggestion_Survey_RatingValue_5),
this.oa.$("SmartSuggestion_CommentQuestion",CommonUIStrings.l_Excel_SmartSuggestion_Survey_CommentQuestion),this.oa.$("PPTO_Picture_FloodgatePromptTitle",CommonUIStrings.l_WAC_GenericSurvey_FloodgatePromptTitle),this.oa.$("PPTO_Picture_FloodgatePromptQuestion",CommonUIStrings.l_WAC_GenericSurvey_PromptQuestion),this.oa.$("PPTO_Picture_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.oa.$("PPTO_Picture_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),
this.oa.$("PPTO_Picture_FloodgateRatingQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateRatingQuestion),this.oa.$("PPTO_Picture_FloodgateRating_1",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_1_VeryDissatisfied),this.oa.$("PPTO_Picture_FloodgateRating_2",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_2_SomewhatDissatisfied),this.oa.$("PPTO_Picture_FloodgateRating_3",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_3_Neutral),this.oa.$("PPTO_Picture_FloodgateRating_4",CommonUIStrings.l_PPTO_Picture_FloodgateRating_4_SomewhatSatisfied),
this.oa.$("PPTO_Picture_FloodgateRating_5",CommonUIStrings.l_WAC_GenericSurvey_FloodgateRating_5_VerySatisfied),this.oa.$("PPTO_Picture_FloodgateWhyQuestion",CommonUIStrings.l_PPTO_Picture_FloodgateWhyQuestion),this.oa.$("CCPExperience_FloodgatePromptTitle",CommonUIStrings.l_CCPExperience_FloodgatePromptTitle),this.oa.$("CCPExperience_FloodgatePromptQuestion",CommonUIStrings.l_CCPExperience_FloodgatePromptQuestion),this.oa.$("CCPExperience_FloodgatePrompt_YesLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_YesLabel),
this.oa.$("CCPExperience_FloodgatePrompt_NoLabel",CommonUIStrings.l_CCPExperience_FloodgatePrompt_NoLabel),this.oa.$("CCPExperience_FloodgateRatingQuestion",CommonUIStrings.l_CCPExperience_FloodgateRatingQuestion),this.oa.$("CCPExperience_FloodgateRating_1",CommonUIStrings.l_CCPExperience_FloodgateRating_1),this.oa.$("CCPExperience_FloodgateRating_2",CommonUIStrings.l_CCPExperience_FloodgateRating_2),this.oa.$("CCPExperience_FloodgateRating_3",CommonUIStrings.l_CCPExperience_FloodgateRating_3),this.oa.$("CCPExperience_FloodgateRating_4",
CommonUIStrings.l_CCPExperience_FloodgateRating_4),this.oa.$("CCPExperience_FloodgateRating_5",CommonUIStrings.l_CCPExperience_FloodgateRating_5),this.oa.$("CCPExperience_FloodgateWhyQuestion",CommonUIStrings.l_CCPExperience_FloodgateWhyQuestion)}catch(ob){h.ULS.sendTraceTag(594052319,356,15,"SIFB.InitializeUIStringGetter error "+(ob?ob.toString():""))}}static pGi(ob){try{return new Promise(ac=>{window.setTimeout(()=>{ac(null)},ob)})}catch(ac){return h.ULS.sendTraceTag(578348238,356,50,"SIFB Info: Floodgate init delay not possible in DelayCustomMs"),
Promise.resolve(null)}}static ubg(){return!r.AFrameworkApplication.fa.ka("FloodgateGovernanceServiceIsDisabled")}static Jbj(){return r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgatePrioritySurveyEnabled",!1)}static mQd(ob){const ac=ob?ob[0]:null;h.ULS.sendTraceTag(512505556,356,50,"SIFB Info:ConvertAndShowTeachingUx - "+(ac?ac.surfaceId:""));if(ac&&"customsurface"===(ac&&ac.surfaceType?ac.surfaceType.toLocaleLowerCase():null)){const pb=Da.a.Wrj(ac);if(pb)return h.ULS.sendTraceTag(555071522,
356,50,"SIFB Info:Floodgate activation result - "+pb+", "+ac.surfaceId),null}return Lb.mQd(ob)}static l6i(){const ob={};ob.retry=r.AFrameworkApplication.fa.Cc("FloodgateGovernanceServiceRetryCount",0);ob.timeout=r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceTimeoutInMs",1E4);ob.simpleRequestEnabled=r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceSimpleRequestEnabled",!1);ob.forceServicelessSurveyDisplay=
r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateGovernanceServiceForceServicelessSurveyDisplayEnabled",!1);return ob}static eyi(ob){if(!("Unknown"!==ob&&"Automation"!==ob&&r.AFrameworkApplication.fa.ka("FloodgateAuthCallbackIsEnabled")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLocalMessagingEnabled",!1)))return h.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+ob),null;ob={};ob.getUserPuid=
Xb.jjj;return ob}static cyi(){const ob={},ac=!r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsDisabled",!1)&&(r.AFrameworkApplication.fa.ka("IsO365ConsumerHost")||r.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAugLoopRuntimeIsEnabled",!1));ob.isEnabled=ac;return ob}static jjj(){return r.AFrameworkApplication.fa.Ga("Puid")}static dig(){return Da.a.jta()?CommonUIStrings.l_WAC_NPS_RatingQuestion_WordForTeams:
CommonUIStrings.l_WAC_NPS_RatingQuestion_Word}static cig(){return Da.a.jta()?CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPointForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint}static aig(){return Da.a.jta()&&r.AFrameworkApplication.fa.ka("ExcelNpsForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_ExcelForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel}static k2b(ob){if(Da.a.jta())switch(ob){case 1:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile;
case 2:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness;case 3:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_ExcelForTeams_PerformanceExperience_RatingQuestion}switch(ob){case 1:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile;case 2:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness;
case 3:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_OpenFile_CurrentSession;case 4:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion_Responsivness_CurrentSession;default:return CommonUIStrings.l_Excel_PerformanceExperience_RatingQuestion}}static ekj(){return Da.a.jta()&&r.AFrameworkApplication.fa.ka("NpsOneNoteForTeamsQuestionIsEnabled")?CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNoteForTeams:CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote}static gkj(){return Da.a.jta()?
CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestionForTeams:CommonUIStrings.l_OnenotePerf_FloodgateRatingQuestion}static fkj(){return Da.a.jta()?CommonUIStrings.l_OnenotePerf_FloodgatePromptTitleForTeams:CommonUIStrings.l_OnenotePerf_FloodgatePromptTitle}static hkj(){switch(r.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.WordOnline.Designer.SmartPasteInCCPFloatieExperience",0)){case 1:return CommonUIStrings.l_WordDesigner_FormatWithDesignerFeedbackRatingQuestion;case 2:return CommonUIStrings.l_WordDesigner_MatchDocumentFormattingFeedbackRatingQuestion;
case 3:return CommonUIStrings.l_WordDesigner_UseSmartPasteFeedbackRatingQuestion;default:return""}}}Xb.kdb="SystemInitiatedFeedbackIsEnabled";Xb.Jki="obf-CampaignDefinitions";Xb.SWf=100;Xb.VFi=8002;Object(J.a)(Xb,"SystemInitiatedFeedback",null,[1277]);class Uc{constructor(ob){if(!ob)throw Error.argumentNull("SystemInitiatedFeedback is null");this.hxf=ob;this.Xpd={};this.rqc={};this.Upd={}}logActivity(ob,ac,pb){const nb=new Date;if(!ob||!this.hxf.n6a(ob,Xb.kdb,ac))return!1;let Tb=null;ob in this.Xpd&&
(Tb=this.Xpd[ob]);const Ub=this.wZi(ob),hc=this.vZi(ob);if(this.jNi(Tb,nb,pb))return h.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",Ub,ob),this.hxf.logActivity(ob,ac),this.Xpd[ob]=nb,this.rqc[ob]=0,this.Upd[ob]=hc+1,!0;this.rqc[ob]=Ub+1;return!1}jNi(ob,ac,pb){return ob?ac.getTime()-ob.getTime()>=1E3*pb:!0}wZi(ob){let ac=0;ob in this.rqc&&(ac=this.rqc[ob]);return ac}vZi(ob){let ac=0;ob in this.Upd&&(ac=this.Upd[ob]);return ac}}Object(J.a)(Uc,"SystemInitiatedFeedbackWithTimeLapse",
null,[1280]);var hb=d(93),Zb=d(68);d.d(V,"CustomerFeedbackPackage",function(){return Fc});class Fc{constructor(){this.A0e=this.Da=null}get name(){return"Common.App.CustomerFeedback"}Wb(ob){r.AFrameworkApplication.Tg||(h.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),r.AFrameworkApplication.Tg=new A.a);ob.register(T,"Common.App.CustomerFeedback.CustomerFeedbackResourceDownloadManager").as("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager").ma();ob.register(ma,
"Common.App.CustomerFeedback.CustomerFeedbackUiWrapper").as("Common.App.ICustomerFeedbackUiWrapper").ma().na(()=>new ma(hb.FocusManager.instance(),r.AFrameworkApplication.Tg));ob.register(H,"Common.App.CustomerFeedback.CustomerFeedbackC3FormManager").as("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").ma().na(()=>new H(ob.resolve("Common.App.ICustomerFeedbackUiWrapper"),ob.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),r.AFrameworkApplication.Tg));ob.register(1228,
"Common.ICustomerFeedbackActor").ma().na(()=>new I(r.AFrameworkApplication.Ta,r.AFrameworkApplication.Aa,ob.Ka("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),r.AFrameworkApplication.fa,r.AFrameworkApplication.Tg));ob.register(Xb,"Common.App.CustomerFeedback.SystemInitiatedFeedback").as("Common.ISystemInitiatedFeedback").ma().na(()=>new Xb(ob.resolve("Common.App.ICustomerFeedbackUiWrapper")));ob.register(Uc,"Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse").as("Common.ISystemInitiatedFeedbackWithTimeLapse").ma().na(()=>
new Uc(ob.resolve("Common.ISystemInitiatedFeedback")));this.Da=ob}init(){Fc._initialized||(Fc.E6b()||(this.A0e=this.Da.resolve("Common.ICustomerFeedbackActor"),this.A0e.ub(),r.AFrameworkApplication.Aa.updateCommandUI()),this.Da.Ka("Common.App.IAppSpecificFeedbackData").execute(()=>{this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedback");this.Da.resolve("Common.App.CustomerFeedback.SystemInitiatedFeedbackWithTimeLapse")}),Fc._initialized=!0)}dispose(){}static E6b(){return!!r.AFrameworkApplication.Aa&&
!!r.AFrameworkApplication.Aa.jb&&3===r.AFrameworkApplication.Aa.jb.rm&&1===r.AFrameworkApplication.Aa.jb.rHa}static main(){let ob=!1;Fc.E6b()&&(ob=!0);Zb.a.instance.Bc(new Fc,0,ob)}}Fc._initialized=!1;Object(J.a)(Fc,"CustomerFeedbackPackage",null,[2,3])},1115:function(J,V,d){J=d(0);var h=d(13),e=d(33);class m{constructor(){this.classId=0}static o5a(y){try{return e.a(y)}catch(u){}return null}}Object(J.a)(m,"ARoamingAppsResponse",null,[]);class r{constructor(){this.state=this.callback=null;this.bae=
!1}}Object(J.a)(r,"GetRoamingAppsLauncherContext",null,[]);var v=d(25),A=d(78);d.d(V,"a",function(){return w});class w{constructor(y){this.Ird=!1;this.F6=w.w8a;this.OCd=this.gAd=0;this.platform=null;this.iWh=y;this.WAf=this.PCd=!1}get aIe(){return this.iWh}get hAl(){return this.aIe&&this.PCd?this.WAf:!1}eoi(){v.AFrameworkApplication.u5b&&this.aIe&&!this.PCd&&!this.Ird&&(this.OCd=3,this.Ird=!0,this.UVk(),this.G2f())}UVk(){this.F6=w.w8a;this.gAd=0}getRoamingAppsLauncher(y,u,D){this.hAl?(y=new r,y.callback=
u,y.state=D,y.bae=!0,this.L2f(y)):u(!1,"",D)}G2f(){const y=new (d(1092).CheckRoamingRightsRequest);y.RoamingApp=this.OCd;y.BaseDocQuerySignature=v.AFrameworkApplication.hh;y.execute(Object(h.a)(this,this.goi,"checkUserRoamingRightsSucceeded"),Object(h.a)(this,this.foi,"checkUserRoamingRightsFailed"),null)}goi(y){v.AFrameworkApplication.Vg||((y=m.o5a(y.data.Sd))?this.WLe(y.HasRights):this.WLe(!1))}foi(){if(!v.AFrameworkApplication.Vg)if(this.gAd>=w.Zdk)this.WLe(!1);else{var y=new A.a(2,1,this.F6,Object(h.a)(this,
this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);v.AFrameworkApplication.pe.Cb(y);this.gAd++;this.F6*=w.RHe;this.F6>w.pdc&&(this.F6=w.pdc)}}WLe(y){this.WAf=y;this.PCd=!0;this.Ird=!1}retryCheckUserRoamingRights(){this.G2f()}L2f(y){const u=new (d(1093).GetRoamingLauncherRequest);u.RoamingApp=this.OCd;u.BaseDocQuerySignature=v.AFrameworkApplication.hh;u.execute(Object(h.a)(this,this.$cj,"getRoamingAppsLauncherSucceeded"),Object(h.a)(this,this.Zcj,"getRoamingAppsLauncherFailed"),y)}$cj(y){if(!v.AFrameworkApplication.Vg){var u=
m.o5a(y.data.Sd);y=y.data.state;u?(this.platform=u.Platform,y.callback(!0,u.Launcher,y.state)):y.callback(!1,"",y.state)}}Zcj(y){if(!v.AFrameworkApplication.Vg){var u=y.data.state;5===y.data.status&&u.bae?(u.bae=!1,this.L2f(u)):u.callback(!1,"",u.state)}}static get instance(){return w.yt||(w.yt=new w(v.AFrameworkApplication.Dbi))}}w.w8a=1E3;w.RHe=5;w.pdc=12E5;w.Zdk=5;w.yt=null;Object(J.a)(w,"RoamingAppsManager",null,[])},1116:function(J,V,d){J=d(0);var h=d(13),e=d(937),m=d(65);class r extends e.a{constructor(F,
I,H,L,E,aa=null){super(F,H,E.jR,aa);this.Bgf=0;this.Y$=this.L9i(L);this.Dnb=I;this.Oh=E;this.qSe=7;this.Ur=this.Dnb.ownerDocument.createElement("div");this.Ur.className="ModalCalloutControlOverlay";this.Ur.tabIndex=0;this.Dnb.insertBefore(this.Ur,this.Dnb.firstChild)}show(){this.VK||(this.Oh.Jeb(),this.Oh.dOa(!1),this.Ur.style.zIndex=String(this.Oh.Qpa),super.show(),this.ow(),this.Bgf=window.setTimeout(Object(h.a)(this,this.dismiss,"dismiss"),1E3*this.qSe))}dismiss(){this.VK&&(this.Oh.NPa(!1),this.Ona(),
this.Dnb&&this.Dnb.contains(this.Ur)&&this.Dnb.removeChild(this.Ur),super.dismiss(),window.clearTimeout(this.Bgf))}ow(){this.Oh.uha(Object(h.a)(this,this.dismiss,"dismiss"));this.Oh.my.ob(m.a.click,this.Ur,Object(h.a)(this,this.onClick,"onClick"))}Ona(){this.Oh.IXa(Object(h.a)(this,this.dismiss,"dismiss"));this.Oh.my.xb(m.a.click,this.Ur,Object(h.a)(this,this.onClick,"onClick"))}onClick(){this.dismiss();return!0}L9i(F){let I=0;switch(F){case 0:I=190;break;case 1:I=250;break;case 2:I=300;break;case 3:I=
360}return I}}Object(J.a)(r,"ModalCallout",e.a,[]);var v=d(376),A=d(340),w=d(141);class y extends r{constructor(F,I,H,L,E,aa=null){super(F,I,H,L,E,aa);this.iwc=null}show(){if(!this.VK){const F=Object.assign(new A.a,{onShow:()=>{r.prototype.show.call(this)}});w.UISurfaces.gN().then(I=>{const H=I.externalNotification();this.iwc=I.addNotification(H,F);return null},I=>{v.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",I);return null})}}dismiss(){this.VK&&this.iwc&&(w.UISurfaces.gN().then(F=>
{F.removeNotification(this.iwc);return this.iwc=null},F=>{v.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",F);return null}),super.dismiss())}}Object(J.a)(y,"ReactManagedModalCallout",r,[]);var u=d(25);d.d(V,"a",function(){return D});class D{static mRd(F,I,H,L,E=null){return u.AFrameworkApplication.Aa.jb.MSa?new y(F,I,H,L,u.AFrameworkApplication.Aa,E):new r(F,I,H,L,u.AFrameworkApplication.Aa,E)}}Object(J.a)(D,"ModalCalloutControlFactory",null,[])},1117:function(J,V,d){d.r(V);
J=d(0);var h=d(509),e=d(510);class m{constructor(w){this.gP=this.h_e=h.a.unused;this.Oyc=w}get fqb(){return this.h_e}wwe(w,y,u,D){u===this.Oyc.element&&(this.h_e=w,this.gP=D+this.Oyc.offset)}tye(){}oMd(w){return this.fqb!==h.a.unused?Object.assign(new e.a,{element:w,offset:this.gP}):null}}Object(J.a)(m,"ChildSelectionHelper",null,[1453]);class r{constructor(w,y){this.Azd=!1;this.Oyc=y;this._parent=w;this.gP=y.offset}get fqb(){return h.a.unused}wwe(w,y,u,D){y||this.Oyc.offset!==w||(this.gP=D,this.Azd=
!0)}tye(w,y){!this.Azd&&this.gP>y&&(this.gP-=y-w+1)}oMd(w){return Object.assign(new e.a,{element:this.Azd?w:this._parent,offset:this.gP})}}Object(J.a)(r,"ParentSelectionHelper",null,[1453]);var v=d(892);d.d(V,"CombineHelper",function(){return A});class A{constructor(w,y,u){this.G3e=h.a.unused;this.rMb="";this._element=w;this.uSb=y;this.XRb=this.e$f(w,u.start);this.URb=this.e$f(w,u.end)}e$f(w,y){return y.element===w?new r(w,y):new m(y)}e4h(w){const y=w===this.uSb,u=this._element.childNodes[w],D=this.rMb.length;
this.XRb.wwe(w,y,u,D);this.URb.wwe(w,y,u,D);this.rMb+=u.nodeValue}end(w,y){this.uSb!==y&&(this.G3e=y,Array.add(w,this))}rri(){var w=this.Dbj();this.Zdh(this.uSb,w-1);this.Zdh(w+1,this.G3e);w=this._element.childNodes[this.uSb];this.rMb!==w.nodeValue&&(w.nodeValue=this.rMb);return this.zhi(w)}Zdh(w,y){if(!(y<w)){this.XRb.tye(w,y);this.URb.tye(w,y);for(let u=w;u<=y;u++)this._element.removeChild(this._element.childNodes[w])}}zhi(w){return Object.assign(new v.a,{start:this.XRb.oMd(w),end:this.URb.oMd(w)})}Dbj(){return this.XRb.fqb!==
h.a.unused?this.XRb.fqb:this.URb.fqb!==h.a.unused?this.URb.fqb:this.uSb}}Object(J.a)(A,"CombineHelper",null,[])},1122:function(J,V,d){J=d(0);var h=d(1165),e=d(376),m=d(25),r=d(78),v=d(67);class A{static jkj(){if(!A.zqc&&(A.zqc=new v.a,m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.Kw("AggregatorIdDisabledList"))){const u=m.AFrameworkApplication.fa.XB("AggregatorIdDisabledList");for(let D=0;D<u.length;D++)A.zqc.$(u[D],!0)}return A.zqc}}A.zqc=null;Object(J.a)(A,"DisabledAggregatorListStore",
null,[]);var w=d(283);d.d(V,"a",function(){return y});class y{constructor(u,D,F,I,H,L=!0,E=null){this.u2e=this.nyf=this.idf=!1;this.Rd=null;if(!u)throw w.a.argument("taskManagerLazy");if(!H)throw w.a.argument("dataAggregator");this.KYh=u;this.uAd=D;this._id=F;this.w8e=6E4*I;this.isc=H;this.ouf=L;this.KRb=E;A.jkj().Jb(this._id.toString())&&(this.u2e=!0)}get taskManager(){return this.Rd||(this.Rd=this.KYh.value)}track(u,D=null){this.u2e||(this.COi(),this.j_k(),this.isc.jUb(u,D))}j_k(){!this.idf&&0<
this.w8e&&(this.idf=!0,this.Ckh())}Ckh(){const u=new r.a(5,1,this.w8e,()=>{this.Q0k()},19,this._id.toString());this.taskManager.Cb(u)}Q0k(){!this.KRb||this.KRb.TMe()?this.Vgd():this.ouf&&this.isc.reset();this.Ckh()}Vgd(){const u=this.isc.getData();if(u){const D=parseInt(String(u.length));if(isNaN(D)||0<D)this.Tlh(u),this.ouf&&this.isc.reset()}}Tlh(u){e.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",{["ID"]:this._id.toString(),["Data"]:u})}COi(){this.nyf||(this.uAd(()=>{this.Vgd()}),this.nyf=!0)}static mr(u,
D,F,I,H){return new y(new h.a(()=>m.AFrameworkApplication.pe),m.AFrameworkApplication.ofa,u,D,F,I,H)}static TV(u,D,F,I=!0){return y.mr(u,D,F,I,null)}}Object(J.a)(y,"Aggregator",null,[1187])},1193:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.chrome=0]="chrome";e[e.edge=1]="edge";e[e.firefox=2]="firefox";e[e.IE=3]="IE";e[e.safari=4]="safari";e[e.others=5]="others";e[e.unknown=6]="unknown";e[e.electron=7]="electron";e[e.chromiumEdge=8]="chromiumEdge";e[e.teamsElectron=
9]="teamsElectron"})(h||(h={}));Object(J.b)("BrowserCode",h)},1194:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.value=!1}}Object(J.a)(h,"OutBool",null,[])},1195:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.Alt=this.DisplayColor=this.Color=null}}Object(J.a)(h,"ColorCellProps",null,[])},1196:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(347);class h extends d.a{constructor(){super();this.Style=this.Character=null}get Type(){return 1}}
Object(J.a)(h,"CharacterCodeGalleryButtonProps",d.a,[])},1197:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(505);class e{constructor(m){this.oba=m}QJe(m){return h.a.then(this.oba.Xnb(m,1,"",{"Content-Type":"application/json; charset=utf-8"},0,void 0,void 0,void 0,void 0,void 0,"2"),r=>this.Scj(r))}Scj(m){return m&&m.Ui&&m.Ui.data?m.Ui.data.Sd:null}}Object(J.a)(e,"SimpleRequestManager",null,[1490])},1198:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(347);class h extends d.a{constructor(){super();
this.LargePreviewIconStyle=this.PreviewIconStyle=this.FullIconStyle=this.Icon=null}get Type(){return 4}}Object(J.a)(h,"IconGalleryButtonProps",d.a,[])},1199:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(300);class h{}h.LabelText=d.a.labelText;h.Alt=d.a.alt;h.Image16by16Class=d.a.Uub;h.Image32by32Class=d.a.nDa;h.Image48by48Class=d.a.l7d;h.Visible=d.a.visible;h.HasPopup="HasPopup";Object(J.a)(h,"ButtonCommandProperties",null,[])},1201:function(J,V,d){function h(a,b){if(!a||!b)return[];
const c=new Set;a.forEach(f=>{var l;return null===(l=null===f||void 0===f?void 0:f.awe)||void 0===l?void 0:l.forEach(x=>{x&&c.add(x)})});return Array.from(c).map(f=>b.te(Ga.a.Mf(f))).filter(f=>null!==f&&void 0!==f)}d.r(V);var e=d(0),m=d(68),r=d(54),v=d(93),A=d(178),w=d(169),y=d(119),u=d(25),D=d(1064),F=d(35),I=d(154),H=d(34);class L{constructor(a){this.value=a}}Object(e.a)(L,"RefTriState",null,[]);var E=d(32);class aa{mFe(){this.SOi();this.zvj();this.lTj();this.S_j();H.a.instance.ga(70)&&this.hEk();
this.F0k();H.a.instance.ga(71)&&this.ZIb();this.jll();this.mml();this.aFi();this.WSj();this.IXk();this.Hhl();this.rnl();H.a.instance.ga(79)&&(r.a.lk||this.Fxj(),this.AVj(),this.Qhk(),this.Vtl())}SOi(){const a=v.FocusManager.instance().Dc(I.AppFrame.QV);a.bindAction(A.KeyInputManager.Na(w.a.lq,0),E.a.enter);a.bindAction(A.KeyInputManager.Na(w.a.lq,4),E.a.Rid)}zvj(){const a=v.FocusManager.instance().Dc(I.AppFrame.QV);y.AFrame.Zj(a,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_Hyperlink),E.a.insertHyperlink)}Fxj(){const a=
v.FocusManager.instance().Dc(y.AFrame.jj);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.Ifa,5),E.a.rD);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.V$,5),E.a.lz)}WSj(){if(!r.a.Vw){const a=v.FocusManager.instance().Dc(y.AFrame.jj);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.fqc,A.KeyInputManager.He),E.a.VAg,aa.Yfb("faOpen"))}}lTj(){const a=v.FocusManager.instance().Dc(I.AppFrame.QV);H.a.instance.ga(54)&&y.AFrame.Zj(a,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_CenterJustify),E.a.centerJustify,aa.mJ);r.a.lk?(y.AFrame.Zj(a,
A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_LeftJustify_Mac),E.a.leftJustify,aa.mJ),y.AFrame.Zj(a,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_RightJustify_Mac),E.a.rightJustify,aa.mJ)):(y.AFrame.Zj(a,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_LeftJustify),E.a.leftJustify,aa.mJ),y.AFrame.Zj(a,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_RightJustify),E.a.rightJustify,aa.mJ));H.a.instance.ga(54)&&y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.rpd,A.KeyInputManager.He),E.a.fullJustify,aa.mJ)}AVj(){var a=
v.FocusManager.instance();const b=a.Dc(y.AFrame.jj);a=a.Dc(I.AppFrame.QV);y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.yKa,A.KeyInputManager.He),E.a.KO,aa.UYf);y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.lWe,A.KeyInputManager.He),E.a.lR,aa.UYf);r.a.fxb&&a.bindAction(A.KeyInputManager.Na(w.a.eqc,4|A.KeyInputManager.He),E.a.KO)}S_j(){const a=v.FocusManager.instance().Dc(y.AFrame.jj);y.AFrame.Zj(a,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_TellMe),F.a.wld,aa.mJ)}Qhk(){if(H.a.instance.ga(27)||H.a.instance.ga(58)){const a=
v.FocusManager.instance().Dc(y.AFrame.jj),b=H.a.instance.ga(58)?E.a.TZk:E.a.save;y.AFrame.Zj(a,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_Save),b);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.yXe,0),E.a.sync)}}hEk(){const a=v.FocusManager.instance().Dc(I.AppFrame.QV);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.cqc,1),E.a.V7c);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.cqc,0),E.a.V7c)}F0k(){this.vlh(I.AppFrame.QV);
this.vlh(I.AppFrame.EEe)}vlh(a){var b=v.FocusManager.instance(),c=w.a.V$,f=w.a.Ifa;a=b.Dc(a);const l=b.Dc(u.AFrameworkApplication.Eeb);a.bindAction(A.KeyInputManager.Na(c,0),E.a.leftArrow);a.bindAction(A.KeyInputManager.Na(f,0),E.a.rightArrow);a.bindAction(A.KeyInputManager.Na(w.a.vY,0),E.a.upArrow);a.bindAction(A.KeyInputManager.Na(w.a.P5,0),E.a.downArrow);a.bindAction(A.KeyInputManager.Na(f,4),E.a.QYa);a.bindAction(A.KeyInputManager.Na(c,4),E.a.PYa);r.a.lk?(a.bindAction(A.KeyInputManager.Na(f,1),
E.a.sBa),a.bindAction(A.KeyInputManager.Na(c,1),E.a.rBa),a.bindAction(A.KeyInputManager.Na(f,5),E.a.ZOa),a.bindAction(A.KeyInputManager.Na(c,5),E.a.YOa),a.bindAction(A.KeyInputManager.Na(f,8),E.a.qWa),a.bindAction(A.KeyInputManager.Na(c,8),E.a.rWa),a.bindAction(A.KeyInputManager.Na(f,12),E.a.VPa),a.bindAction(A.KeyInputManager.Na(c,12),E.a.WPa)):(a.bindAction(A.KeyInputManager.Na(f,A.KeyInputManager.He),E.a.sBa),a.bindAction(A.KeyInputManager.Na(c,A.KeyInputManager.He),E.a.rBa),a.bindAction(A.KeyInputManager.Na(f,
A.KeyInputManager.He|4),E.a.ZOa),a.bindAction(A.KeyInputManager.Na(c,A.KeyInputManager.He|4),E.a.YOa));a.bindAction(A.KeyInputManager.Na(w.a.vY,4),E.a.ZHb);a.bindAction(A.KeyInputManager.Na(w.a.P5,4),E.a.jhb);a.bindAction(A.KeyInputManager.Na(w.a.vY,A.KeyInputManager.He),E.a.dYb);a.bindAction(A.KeyInputManager.Na(w.a.P5,A.KeyInputManager.He),E.a.Xqb);a.bindAction(A.KeyInputManager.Na(w.a.vY,A.KeyInputManager.He|4),E.a.Z4a);a.bindAction(A.KeyInputManager.Na(w.a.P5,A.KeyInputManager.He|4),E.a.XOa);
a.bindAction(A.KeyInputManager.Na(w.a.zE,0),E.a.rWa);a.bindAction(A.KeyInputManager.Na(w.a.zE,4),E.a.WPa);if(H.a.instance.ga(41))a.bindAction(A.KeyInputManager.Na(w.a.zE,A.KeyInputManager.He),E.a.v7c),a.bindAction(A.KeyInputManager.Na(w.a.Ew,A.KeyInputManager.He),E.a.Pue);else if(H.a.instance.ga(17)||H.a.instance.ga(77))a.bindAction(A.KeyInputManager.Na(w.a.zE,A.KeyInputManager.He),E.a.udb),a.bindAction(A.KeyInputManager.Na(w.a.Ew,A.KeyInputManager.He),E.a.tdb);a.bindAction(A.KeyInputManager.Na(w.a.zE,
A.KeyInputManager.He|4),E.a.V5a);a.bindAction(A.KeyInputManager.Na(w.a.Ew,0),E.a.qWa);a.bindAction(A.KeyInputManager.Na(w.a.Ew,4),E.a.VPa);a.bindAction(A.KeyInputManager.Na(w.a.Ew,A.KeyInputManager.He|4),E.a.U5a);r.a.lk&&(a.bindAction(A.KeyInputManager.Na(w.a.vY,2),E.a.rWa),a.bindAction(A.KeyInputManager.Na(w.a.vY,6),E.a.WPa),a.bindAction(A.KeyInputManager.Na(w.a.P5,2),E.a.qWa),a.bindAction(A.KeyInputManager.Na(w.a.P5,6),E.a.VPa),a.bindAction(A.KeyInputManager.Na(w.a.zE,1),E.a.udb),a.bindAction(A.KeyInputManager.Na(w.a.Ew,
1),E.a.tdb),H.a.instance.ga(6)&&(a.bindAction(A.KeyInputManager.Na(w.a.vY,5),E.a.Z4a),a.bindAction(A.KeyInputManager.Na(w.a.P5,5),E.a.XOa)));c=A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_SelectAll);a.bindAction(c,E.a.ura);l.bindAction(c,F.a.AIc);H.a.instance.ga(79)&&(f=b.Dc(y.AFrame.mD),b=b.Dc(y.AFrame.jj),f.bindAction(c,F.a.MAa),b.bindAction(A.KeyInputManager.Na(w.a.n_a,A.KeyInputManager.He|4),E.a.Ggd),H.a.instance.ga(41)&&r.a.lk&&(a.bindAction(A.KeyInputManager.Na(w.a.vB,1),E.a.udb),a.bindAction(A.KeyInputManager.Na(w.a.uB,
1),E.a.tdb)),b.bindAction(A.KeyInputManager.Na(w.a.uB,0),E.a.pageDown),b.bindAction(A.KeyInputManager.Na(w.a.vB,0),E.a.pageUp),b.bindAction(A.KeyInputManager.Na(w.a.uB,4),E.a.Klc),b.bindAction(A.KeyInputManager.Na(w.a.vB,4),E.a.Uid));H.a.instance.ga(6)&&(a.bindAction(A.KeyInputManager.Na(w.a.uB,A.KeyInputManager.He|4),F.a.AIc),a.bindAction(A.KeyInputManager.Na(w.a.vB,A.KeyInputManager.He|4),F.a.AIc));r.a.Nj||a.bindAction(A.KeyInputManager.Na(w.a.xKa,0),E.a.B$);a.bindAction(A.KeyInputManager.Na(w.a.coa,
4),E.a.Tid);a.bindAction(A.KeyInputManager.Na(w.a.coa,4|A.KeyInputManager.He),E.a.Tid)}ZIb(){const a=v.FocusManager.instance().Dc(I.AppFrame.QV);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.opd,A.KeyInputManager.He|1),E.a.sKd);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.ppd,A.KeyInputManager.He|1),E.a.tKd);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.sXe,A.KeyInputManager.He|1),E.a.uKd);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.tXe,A.KeyInputManager.He|1),E.a.vKd);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.uXe,A.KeyInputManager.He|
1),E.a.wKd);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.vXe,A.KeyInputManager.He|1),E.a.xKd);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.uya,A.KeyInputManager.He|4),E.a.rKd);H.a.instance.ga(61)&&v.FocusManager.instance().Dc(y.AFrame.jj).bindAction(A.KeyInputManager.Na(w.a.vpd,A.KeyInputManager.He|4),E.a.$ai)}jll(){const a=v.FocusManager.instance().Dc(I.AppFrame.QV);a.bindAction(A.KeyInputManager.Na(w.a.Iq,0),E.a.tab);a.bindAction(A.KeyInputManager.Na(w.a.Iq,4),E.a.Llc)}mml(){if(H.a.instance.ga(30)){const a=
v.FocusManager.instance().Dc(I.AppFrame.QV);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.lq,A.KeyInputManager.He),E.a.BDa)}}rnl(){const a=v.FocusManager.instance(),b=a.Dc(I.AppFrame.QV);a.Dc(y.AFrame.mD);y.AFrame.Zj(b,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_Bold),E.a.bold,aa.mJ);y.AFrame.Zj(b,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_Italic),E.a.setItalic,aa.mJ);y.AFrame.Zj(b,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_Underline),E.a.underline,aa.mJ);r.a.lk&&(y.AFrame.Zj(b,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_Bold_Mac),
E.a.bold,aa.mJ),y.AFrame.Zj(b,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_Italic_Mac),E.a.setItalic,aa.mJ),y.AFrame.Zj(b,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_Underline_Mac),E.a.underline,aa.mJ));y.AFrame.Zj(b,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_ClearFormatting),E.a.clearFormatting);H.a.instance.ga(54)&&y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.sLb,A.KeyInputManager.He|4),E.a.clearFormatting);y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.tjb,A.KeyInputManager.He|1),E.a.w$,aa.Yfb("00FFFF"));
if(H.a.instance.ga(94)||H.a.instance.ga(96))y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.yKa,A.KeyInputManager.He|4),E.a.nI,aa.mJ),y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.wpc,A.KeyInputManager.He),E.a.nI,aa.mJ),y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.sod,A.KeyInputManager.He|4),E.a.BJ,aa.mJ),y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.upc,A.KeyInputManager.He),E.a.BJ,aa.mJ);u.AFrameworkApplication.fa.ka("PPTOToggleCaseByShiftF3Enabled")&&y.AFrame.Zj(b,A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_ToggleCase),
E.a.gmd);u.AFrameworkApplication.fa.ka("SubSuperscriptShortcutEnabled")&&(y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.uod,A.KeyInputManager.He|4),E.a.superscript,aa.mJ),y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.xod,A.KeyInputManager.He|4),E.a.superscript,aa.mJ),y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.vod,A.KeyInputManager.He|4),E.a.subscript,aa.mJ),y.AFrame.Zj(b,A.KeyInputManager.Na(w.a.vpc,A.KeyInputManager.He|4),E.a.subscript,aa.mJ))}Vtl(){const a=v.FocusManager.instance().Dc(y.AFrame.mD),b=v.FocusManager.instance().Dc(I.AppFrame.QV);
var c=A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_Undo);a.bindAction(c,F.a.MAa);b.bindAction(c,E.a.undo);c=A.KeyInputManager.Na(w.a.wH,1);a.bindAction(c,F.a.MAa);r.a.lk||b.bindAction(c,E.a.undo);c=A.KeyInputManager.Vv(Box4Intl.Box4Strings.l_HK_Redo);a.bindAction(c,F.a.MAa);b.bindAction(c,E.a.redo);c=A.KeyInputManager.Na(w.a.wH,5);a.bindAction(c,F.a.MAa);r.a.lk||b.bindAction(c,E.a.redo)}Hhl(){const a=v.FocusManager.instance().Dc(I.AppFrame.QV);H.a.instance.ga(54)?(r.a.lk?this.rqa(a,A.KeyInputManager.Na(w.a.ppd,
5),"\u20ac"):this.rqa(a,A.KeyInputManager.Na(w.a.rjb,A.KeyInputManager.He|1),"\u20ac"),this.rqa(a,A.KeyInputManager.Na(w.a.sya,A.KeyInputManager.He|1),"\u00a9"),this.rqa(a,A.KeyInputManager.Na(w.a.pLb,A.KeyInputManager.He|1),"\u00ae"),this.rqa(a,A.KeyInputManager.Na(w.a.qLb,A.KeyInputManager.He|1),"\u2122"),this.rqa(a,A.KeyInputManager.Na(w.a.vpc,A.KeyInputManager.He|1),"\u2014"),this.rqa(a,A.KeyInputManager.Na(w.a.yKa,A.KeyInputManager.He|1),"\u2026"),this.rqa(a,A.KeyInputManager.Na(w.a.lWe,A.KeyInputManager.He|
5),"\u00bf"),this.rqa(a,A.KeyInputManager.Na(w.a.opd,A.KeyInputManager.He|5),"\u00a1")):H.a.instance.ga(25)&&this.rqa(a,A.KeyInputManager.Na(w.a.rjb,A.KeyInputManager.He|1),"\u20ac")}rqa(a,b,c){y.AFrame.Zj(a,b,E.a.dSa,aa.hCj("symbol_"+c))}aFi(){if(u.AFrameworkApplication.sE){var a=v.FocusManager.instance().Dc(y.AFrame.jj);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.wXe,A.KeyInputManager.He|1),F.a.giveFeedback);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.xXe,A.KeyInputManager.He|1),F.a.giveFeedback)}}IXk(){const a=
v.FocusManager.instance().Dc(y.AFrame.jj);r.a.Vw||y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.tjb,1),E.a.activateRibbonTab,aa.Yfb("tabHome"));y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.uya,1),E.a.activateRibbonTab,aa.Yfb("tabInsert"));y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.ujb,1),E.a.activateRibbonTab,aa.Yfb("tabPageLayout"));y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.pLb,1),E.a.activateRibbonTab,aa.Yfb("tabReview"));y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.AXe,1),E.a.activateRibbonTab,aa.Yfb("tabView"))}static get instance(){return aa.Ja||
(aa.Ja=new aa)}static UYf(){return new D.DictionaryPropertySet}static mJ(){return new L(2)}static hCj(a){return()=>{const b={};b.SourceControlId=a;return b}}static Yfb(a){return()=>a}}aa.Ja=null;Object(e.a)(aa,"ShortcutRegistration",null,[]);class Q{get name(){return"Box4.Shortcuts"}Wb(){}init(){aa.instance.mFe()}dispose(){}static main(){m.a.instance.Bc(new Q)}}Object(e.a)(Q,"Box4ShortcutsPackage",null,[2,3]);var O=d(302);class T{Bt(a,b,c=!1,f=!1,l=!1,x=null){return O.a.Bt(a,b,c,f,l,x)}jpc(a,b,c){return O.a.jpc(a,
b,c)}kpb(a,b){return O.a.kpb(a,b)}kZ(a,b,c,f,l=!1,x=!1){return O.a.kZ(a,b,c,f,l,x)}hOa(a,b=null){return O.a.hOa(a,b)}zca(){O.a.zca()}T4a(a,b,c,f=null){return O.a.T4a(a,b,c,f)}WCa(a,b,c=!1,f=!0){return O.a.WCa(a,b,c,f)}X5b(a,b){return O.a.X5b(a,b)}}Object(e.a)(T,"TextMetricsAdapterProxy",null,[1388]);var K=d(308),X=d(148);class P{Khj(a){var b=a;for(a=null;!a&&b&&"P"!==b.tagName;)a=K.a.te(b,X.a.AJb),b=b.parentNode;b=-1;a&&(b=parseInt(a.toString(),10));return b}}Object(e.a)(P,"TextMetricsHelper",null,
[307]);class ea{constructor(){this.Da=null}get name(){return"Box4.TextMetrics"}init(){this.Da.resolve("Box4.ITextMetricsAdapter")}dispose(){}Wb(a){this.Da=a;this.Da.register(1388,"Box4.ITextMetricsAdapter").ma().na(()=>new T);this.Da.register(307,"Box4.TextMetricsApi.ITextMetricsHelper").ma().na(()=>new P)}static main(){m.a.instance.Bc(new ea)}}Object(e.a)(ea,"Box4TextMetricsPackage",null,[2,3]);var ia=d(330),ja=d(248),C=d(13),pa=d(99),Z=d(376),qa=d(703),ya=d(95),Ka=d(45),Da=d(1185),la=d(1181),ma=
d(65),Ea=d(556),ta=d(101),Ga=d(342),oa=d(778),sa=d(268),Ha=d(17),bb=d(6);class Ya{static v4k(a){const b=new qa.a;for(let c of a)b.add(c);return b}static heh(a,b){const c=new Ha.a;b=Ya.v4k(b);for(let f of a)b.contains(f)||c.add(f);return c}static JPk(a,b){return Ya.heh(bb.asEnumerable(a),b).toArray()}static KPk(a,b){return Ya.heh(a,b)}}Object(e.a)(Ya,"ExtendedGuidUtils",null,[]);var ua=d(1166),Ma=d(22),Ca=d(162);class Va{}Va.Lli="ChangeInfo";Object(e.a)(Va,"CatchUpActivityConstants",null,[]);class Za{}
Za.WDb="\u00a0";Za.AKf="\ue200";Za.Lng="\ue201";Za.MLi=32767;Za.tIc=3;Za.$Td=1;Object(e.a)(Za,"ContentEditableViewConstants",null,[]);var Db=d(539),Lb=d(121),yb=d(31),Bc=d(358),tb=d(36),Mb=d(40),Hb=d(88),vb=d(92),Xb=d(51),Uc=d(86);class hb{constructor(a,b,c){this.Qa=b;this.Kb=c}}Object(e.a)(hb,"ChangeInfo",null,[]);d(600);var Zb=d(797);class Fc{}Object(e.a)(Fc,"InternalLinkConstants",null,[]);class ob extends Sys.EventArgs{constructor(){super();this.E5a=null}}Object(e.a)(ob,"EditEventArgs",Sys.EventArgs,
[]);class ac extends ob{constructor(){super();this.KUj=0;this.Bpl=this.lJc=this.YRe=this.lVj=this.lxj=this.$sg=this.n7f=this.ESi=this.VOi=!1}}Object(e.a)(ac,"ParagraphContentUpdatedEventArgs",ob,[]);class pb{constructor(a){this.SWc=a}}Object(e.a)(pb,"BlobPresenterArgs",null,[]);var nb=d(30);class Tb{}Tb.c3="TrackedChange";Tb.qxh="TrackChangeTableRowInsertion";Tb.nxh="TrackChangeTableRowDeletion";Tb.Yxh="TrackChangeTextInsertion";Tb.Wxh="TrackChangeTextDeletion";Tb.Mwj="TrackChangeImageModified";Tb.Kwj=
"TrackChangeImageInsertion";Tb.Gwj="TrackChangeImageDeletion";Tb.fee="TrackChangeIndirectEffect";Object(e.a)(Tb,"TrackChangeConstants",null,[]);var Ub=d(891),hc=d(96);const Wb=a=>!!a.cPa&&bb.AT(a.cPa,b=>3===b.type||2===b.type||4===b.type),fd=(a,b)=>{let c=!1,f=!1,l=null;if(b.cPa)for(let x of b.cPa)1===x.type&&(c=!0),3===x.type&&(f=!0),4===x.type&&x.ye&&x.ye.paragraph&&(l=x);l&&Sys.UI.DomElement.addCssClass(a,hc.a.uEi);f&&Sys.UI.DomElement.addCssClass(a,hc.a.zmg);c&&Sys.UI.DomElement.addCssClass(a,
hc.a.oEi)},fc=a=>{const b=[hc.a.UKi,hc.a.VKi,hc.a.TKi];for(const c of b)Sys.UI.DomElement.removeCssClass(a,c)};var bc=d(352);class cc{constructor(a){this.tNb=this.vSb=this.t0e=null;this.Gi=a}get paragraphNode(){return this.Gi}get cPa(){return this.t0e}get Lhb(){return this.vSb}get K5a(){return this.tNb}get isEmpty(){return(!this.cPa||!this.cPa.count)&&(!this.Lhb||!this.Lhb.count)&&(!this.K5a||!this.K5a.count)}pok(){this.Lhb&&(this.vSb=new Ha.a);this.K5a&&(this.tNb=new Ha.a)}god(a){this.cPa||(this.t0e=
new bc.a);this.Lhb||(this.vSb=new Ha.a);this.K5a||(this.tNb=new Ha.a);this.cPa.god(a,b=>{this.Lhb.add(b)},b=>{this.K5a.add(b)})}}Object(e.a)(cc,"IntentRenderingState",null,[]);class kb{constructor(a,b){this.element=a;this.next=b}}Object(e.a)(kb,"ElementStackNode",null,[]);class ab{constructor(a=!1){this._history=new Sys.StringBuilder;this.$ya=this.Uu=null;this.VSb=a}oYj(a){if(this.VSb&&a){this._history.append("[Cp "+a.cp+":");if(a.Sh)for(var b=0;b<a.Sh.length;b++)this._history.append(a.Sh.ga(b).ey+
","+a.Sh.ga(b).cea),b!==a.Sh.length-1&&this._history.append("|");if(a.$j)for(a.Sh&&this._history.append("|"),b=0;b<a.$j.length;b++)this._history.append(a.$j.ga(b).Msa?"B":"I"),this._history.append(a.$j.ga(b).nk?"S":"E"),this._history.append(a.$j.ga(b).zwb?"R":"F"),b!==a.$j.length-1&&this._history.append("|");this._history.append("]\n")}}clear(){if(this.Uu){for(var a=this.Uu;a.next;)a=a.next;a.next=this.$ya;this.$ya=this.Uu;this.Uu=null;this.VSb&&this._history.append("Clear\n")}}peek(a=""){this.isEmpty()&&
Z.ULS.sendTraceTag(50604245,324,15,"_top is null when calling Peek with Label: {0}. History: {1}",a,this._history.toString());this.VSb&&this._history.append(String.format("Peek Label: {0}\n",a));return this.Uu.element}pop(a=""){this.isEmpty()&&Z.ULS.sendTraceTag(50604246,324,15,"_top is null when calling Pop with label {0}. History: {1}",a,this._history.toString());const b=this.Uu.element;this.Uu.element=null;const c=this.Uu.next;this.Uu.next=this.$ya;this.$ya=this.Uu;this.Uu=c;this.VSb&&this._history.append(String.format("Pop {0} Label:{1}\n",
b?b.className:"Null Element",a));return b}push(a,b=""){if(this.$ya){const c=this.$ya.next;this.$ya.next=this.Uu;this.Uu=this.$ya;this.$ya=c;this.Uu.element=a}else this.Uu=new kb(a,this.Uu);this.VSb&&this._history.append(String.format("Push {0} Label:{1}\n",a?a.className:"Null Element",b))}isEmpty(){return!this.Uu}}Object(e.a)(ab,"ElementStack",null,[]);class Pb{constructor(){this.O5b=!1;this.span=null}}Object(e.a)(Pb,"IntelligentPlaceholderRenderingState",null,[]);class rc{constructor(a,b,c){this.eventName=
a;this.Ac=b;this.handler=c}}Object(e.a)(rc,"ParagraphContentRendererMouseEventRegistration",null,[]);var ic=d(77);class md extends Sys.EventArgs{constructor(a,b,c){super();this.element=a;this.paragraphNode=b;this.EFb=c}}Object(e.a)(md,"ParagraphContentRendererEventArgs",Sys.EventArgs,[]);class Fd extends md{constructor(a,b,c,f,l){super(a,b,c);this.vSb=f.Lhb;this.tNb=f.K5a;this.bNh=l}get Lhb(){return this.vSb}get K5a(){return this.tNb}get elementType(){return this.bNh}}Object(e.a)(Fd,"IntentRangeRenderedEventArgs",
md,[]);class ne extends md{constructor(a,b,c,f){super(a,b,c);this.Jp=f}}Object(e.a)(ne,"SpellingErrorRenderedEventArgs",md,[]);class ud{constructor(){this.Pa=new ic.a}dispose(){this.Pa&&(this.Pa.dispose(),this.Pa=null)}NIk(a,b,c,f){this.Pa&&this.Pa.raiseEvent(ud.frk,new ne(a,b,c,f))}Xah(a,b,c,f,l){this.Pa&&this.Pa.raiseEvent(ud.pnk,new Fd(a,b,c,f,l))}}ud.frk="OnSpellingErrorRangeRendered";ud.pnk="OnIntentRangeRendered";Object(e.a)(ud,"ParagraphRenderEvents",null,[106]);class gb{constructor(){this.fPf=
null;this.Plg=!1;this.IVg=this.kCf=null}}Object(e.a)(gb,"RenderParagraphContentResults",null,[]);var Vb=d(161),Lc=d(67);class Xc{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic){this.hza=this.Lxd=this.Owd=this.Cmb=null;this.If=a;this.eP=b;this.Xc=c;this.Goa=f;this.CM=l;this.Ov=G;this.e2a=R;this.dMa=fa;this.NLh=Wa;this.bV=mb;this.nVh=Kb;this.pOh=nc;this.sKh=Ic;this.tAf=new qa.a;this.nzc=oc;this.Jlb=!!wa&&wa.NDa(65);this.yzc=this.stc=null;this.NLa=x;this.AQh=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("MinimizeIntelligentPlaceholderWorkIsEnabled");
this.Yc=wa}get IMf(){return!0}get ywg(){null==this.Owd&&(this.Owd=!!this.Yc&&this.Yc.isFeatureEnabled(85));return this.Owd}get JAg(){null==this.Lxd&&(this.Lxd=!!this.Yc&&this.Yc.isFeatureEnabled(77));return this.Lxd}get sN(){null==this.hza&&(this.hza=!!this.Yc&&this.Yc.isFeatureEnabled(79));return this.hza}ITk(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie){this.stc={};this.yzc=new Vb.a;const He=yb.ParagraphReader.text(a),fe=new Ha.a;var Te=!1;u.AFrameworkApplication.fa&&(Te=u.AFrameworkApplication.fa.ka("ElementStackTrackHistoryIsEnabled"));
const We=new ab(Te);We.push(c,"RenderParagraphContentStart");let Qf=null,mg=null,Xg=null,Mg=null,Sf=Te=null;const uh=new ac;var Sg=!1;let li=!1,Ui=!1,Cj=!1,jj=0,kj=null,Gi=null;const yk=new Ha.a;this.nzc&&this.nzc.AFl(a,c);const Dj=this.dMa.YV(a);this.dMa.Gai(c,a,b,Dj,b.Fd);if(this.e2a.Ww&&b.Kl){var ok=this.If.Nd;ok&&1===ok.editingView.mode&&(c.style.fontFamily="",c.style.fontSize="")}ok=!a.iW;let Fl=!1,Xk=!1,Gl=!1,ak=!1,Sj=0,bk=!1,Gk=!1,Nj=null,vh=0;const Yk=new Pb,Ul=Array(a.Ra.length+1);let sm=
this.ywg?new Ha.a:null,zk=null,pk=null;for(;jj<a.Ra.length;){const je=a.Ra.ga(jj);var mi=void 0,wg=void 0,ni=!1;We.oYj(je);({yFc:mi,uFc:wg}=Xc.i$f(je));this.ywg&&(!this.AQh||mi.length||wg.length)&&({yFc:mi,uFc:wg,LEi:sm,fKj:ni}=Xc.Pvl(je.paragraph.Fh,mi,wg,sm),Yk.O5b=0<sm.count);ak=0<mi.length||ak;Ul[jj]=c.childNodes.length;if(0<je.cp&&je.Ij)break;let Fg=je.cp;const $h=jj<a.Ra.length-1?a.Ra.ga(jj+1).cp:yb.ParagraphReader.textLength(a);jj++;var cg=!1;0<Fg&&We.pop("CurrentCpLargerThanZero");je.bL&&
(Qf=null);je.Yu&&(pk=je.Yu);je.isDictationCorrectionEnd&&(pk=null);je.YX&&(mg=null);je.k3&&(Xg=null);je.Hja&&(Mg=null);var Gd=void 0,Ce=void 0;this.sN?(Gd=je.Nca,Ce=je.UZ):(Gd=!!je.Ao,Ce=!!je.fieldRangeEnd);if(!Sg||je.blob||je.formatting||je.hyperlink||je.Sm||je.m3||Ce||Gd||this.Jlb&&(je.isTrackChangeInfoEnd||je.CN)||je.Xv&&!je.Xv.isEmpty)cg=!0,0<Fg&&Sg&&We.pop("InFormattingSpan");Ce&&(We.pop("HasFieldEnd"),Sg=!1);je.Sm&&(Fl||(Ui=!0),Xk=Fl=!1);je.hyperlink&&(Fl&&(Ui=!0),Fl=!0,Xk=je.hyperlink.Ksa);
je.Sm&&!Ui&&(We.pop("IsHyperlinkEnd"),Sg=!1);this.Yc&&this.Yc.isFeatureEnabled(17)&&(je.isChangeEnd&&(bk||Z.ULS.sendTraceTag(36282713,324,15,"Found catch up change end with out change start!"),bk=!1,Gi=null),je.changeStart&&(bk&&Z.ULS.sendTraceTag(36282714,324,15,"Found catch up change start with out change end!"),Gi=je,bk=!je.Ij));if(this.Jlb&&(je.isTrackChangeInfoEnd&&(Gl||(Cj=!0),Gl=!1,kj=null),je.CN&&(Gl&&(Cj=!0),kj=je,Gl=!je.Ij),je.isTrackChangeInfoEnd&&!Cj)){for(Sg=0;Sg<Sj;Sg++)We.pop("IsTrackChangeInfoEnd");
Sj=0;Sg=!1}zk&&zk.pok();je.Xv&&(zk||(zk=new cc(a)),zk.god(je.Xv));if(je.m3&&!je.Ij){Te=Te||je.formatting;Ce=this.zUf(We.peek("CreateIpFormattingSpan"),Te,Dj,b,a,Wa,fa,kj);Ce=ya.a.j7a(Ce);for(let Hi of Ce)mb=Xc.pha(l,mb,Hi);uh.$sg=!0}je.hyperlink&&!Ui&&({yEa:mb,qMi:Gk,returnValue:Sf}=this.BTk(Sf,je,We,Dj,uh,b,a,f,l,x,G,fa,kj,mb,Wa,ok,Sg,Gk));!this.Jlb||Cj||je.Ij||(je.lp&&(this.LGe(je.lp,We,uh,b,fa),Sj++),je.uo&&(this.LGe(je.uo,We,uh,b,fa),Sj++),je.Bs&&(this.LGe(je.Bs,We,uh,b,fa),Sj++));Gd&&({aPa:Te,
yEa:mb,returnValue:Sf}=this.xTk(Sf,l,a,je,Te,We,Dj,uh,b,fa,Wa,mb,Sg,ok,kj));this.JAg&&this.yOf(a,b,Kc&&Ic);je.blob?({yEa:mb,kVj:Nj,jVj:vh,returnValue:li}=this.pTk(mb,Sg,Te,je,x,G,ok,Sf,We,Dj,uh,Fg,li,Ic,b,yk,Kc,a,Wa,l,Kb,nc,R,fa,fe,kj,Gi,mi,wg,Nj,vh,zk),Sg=!1,Te=Sf=null):(Gd=je.m3&&!Ka.a.substring(He,Fg,$h).length,cg&&(cg=Sf,{aPa:Te,returnValue:Sf}=this.zTk(Te,je,Dj,We,uh,b,a,fa,kj,Wa,Gd),Sg=!0,Sf&&Sf.style&&(Gk&&cg&&cg.style&&(cg.style.fontSize=Sf.style.fontSize,cg.style.lineHeight=Sf.style.lineHeight),
Nj&&Nj.style&&0<vh&&je.formatting&&je.formatting.cache.ssa&&vh>je.formatting.cache.fontSize&&(Nj.style.fontSize=Sf.style.fontSize,Nj.style.lineHeight=Sf.style.lineHeight))),Gk=!1,Nj=null,vh=0,Gd||(je.Jp&&(Qf=je.Jp),je.dF&&(Xg=je.dF),je.dL&&(Mg=je.dL),je.tw&&(mg=je.tw),cg=Ka.a.substring(He,Fg,$h),ni=this.QRd(We.peek("CreateTextOverlaySpan1"),Te,a,Qf,Xg,Mg,mg,b,yk,fa,cg,Kc&&(Kb<=Fg&&Fg<nc||a.iW),ie,Yk,ni,zk,!!pk,Xk),We.push(ni,"TextOverlaySpan1"),uh.YRe=!0,this.wHd(We.peek("AddCommentHintCssAndDataToElement"),
mi,wg),this.CM&&this.CM.Cvb&&Qf&&Qf.Gh&&(mi=Object(ua.a)(658,Qf.Gh))&&mi.UM&&mi.UM.TraceId&&5===mi.proofingType&&!mi.mDa&&(this.APk(We.peek("RemoveConsistencyCheckCustomData")),wg=this.U1i(je.Jp,a,jj),K.a.Cv(We.peek("errorDetails"),wg,mi.UM.TraceId)),this.rKe(Gi,We.peek("SetChangeId"),je.cp,$h),Kc&&Kb!==nc&&({yEa:mb,returnValue:Fg}=this.GDk(ni,We,Te,a,Qf,Xg,Mg,mg,uh,b,l,yk,fa,He,Kb,nc,mb,Fg,$h,ie,Yk,zk,!!pk,Xk)),ya.a.wx(We.peek("SetElementText"),Ka.a.substring(He,Fg,$h)),mb=Xc.pha(l,mb,We.peek("AddLeafNodeElement"))))}if(a.FQc!==
ak||this.Jlb||this.e2a.Ppc)a.FQc=ak,(f=Xb.OutlineElementNavigator.EA(a))&&f.Aca(b.Ma,32,!0);({SWc:Sf,yEa:mb,returnValue:Sg}=this.DTk(a,c,Te,Dj,uh,Sf,b,a,l,fa,kj,Wa,mb,Sg,ok));!Yk.O5b&&Yk.span&&this.aKd(null,Yk.span);ok&&this.wTk(c,Sf,uh,b,a,l,fa,wa,mb,oc,Gi);Ul[Ul.length-1]=c.children.length;this.Kwl(li,Hc,b);this.Fxl(uh,Sg,l);this.Jnh(b,a,c);let Hf;return Hf=new gb,Hf.fPf=fe,Hf.Plg=li,Hf.kCf=Ul,Hf.IVg=yk,Hf}EFb(a,b,c,f){this.eP.ob(a,b,c,f);return new rc(a,b,c)}U1i(a,b,c){let f=0;a&&a.Gh&&(f|=16);
if(c<b.Ra.length&&b.Ra.ga(c).bL||c===b.Ra.length)f|=1;switch(f){case 0:return Ub.a.xve;case 16:return Ub.a.fXc;case 1:return Ub.a.Sfd;case 17:return Ub.a.cDc}return""}APk(a){K.a.Qma(a,Ub.a.xve);K.a.Qma(a,Ub.a.fXc);K.a.Qma(a,Ub.a.Sfd);K.a.Qma(a,Ub.a.cDc)}rKe(a,b,c,f){this.Yc&&this.Yc.isFeatureEnabled(17)&&a&&a.changeStart&&K.a.Cv(b,Va.Lli,new hb(a.changeStart.id,c,f))}BTk(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc){!Ic||Kc||b.m3||(a=this.BXb(c.peek("CreateFormattingSpan1"),null,f,x,G,mb,oc,Kb),
a.className+=" EmptyTextRun",nc=Xc.pha(fa,nc,a),Hc=l.lJc=!0);b=this.sAi(c.peek("CreateLinkAnchor"),b.hyperlink,x,R,wa,Wa,mb);c.push(b,"RenderHyperlink");l.lVj=!0;return{returnValue:a,yEa:nc,qMi:Hc}}LGe(a,b,c,f,l){a=this.NDi(b.peek("CreateTrackChangeRange"),a,f,l);b.push(a,"RenderTrackChange");c.Bpl=!0}xTk(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc){Kb||f.m3||(l=f.formatting||l,nc?(a=this.BXb(x.peek("CreateFormattingSpan2"),l,G,fa,c,wa,Wa,oc),a.appendChild(fa.ownerDocument.createTextNode("")),a.className+=
" EmptyTextRun",mb=Xc.pha(b,mb,a),R.lJc=!0):(a=this.aHc(l,G,fa,c,Wa,oc),R.n7f=!0));b=this.rzi(x.peek("CreateFieldRangeSpan1"),fa,wa,c);x.push(b,"RenderFieldRange");R.ESi=!0;return{returnValue:a,aPa:l,yEa:mb}}pTk(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg,Sf,uh,Sg,li,Ui){b||(c=f.formatting||c,G&&!f.m3?(R=this.BXb(fa.peek("CreateFormattingSpan4"),c,wa,oc,Hc,Qf,ie,Xg),R.appendChild(oc.ownerDocument.createTextNode("")),R.className+=" EmptyTextRun",a=Xc.pha(He,a,R),Wa.lJc=
!0):R=this.aHc(c,wa,oc,Hc,ie,Xg));1===f.blob.Lq&&(Kb=!0);b=f.blob.Cbj(oc);b.c8f(new pb(R));R=b.element;Sys.UI.DomElement.containsCssClass(R,hc.a.Z6b)&&(Sg=R,c&&c.cache.ssa&&(li=c.cache.fontSize));Sys.UI.DomElement.addCssClass(R,hc.a.MM);this.e2a.aLi&&5!==f.blob.Lq&&Sys.UI.DomElement.addCssClass(R,hc.a.XKi);this.Jlb&&this.CTk(f,oc,R,Xg);this.wHd(R,Sf,uh);Ui&&!Ui.isEmpty?(fd(R,Ui),this.Cmb&&this.Cmb.Xah(R,Hc,(Cj,jj,kj,Gi)=>{Ic.add(this.EFb(Cj,jj,kj,Gi))},Ui,1)):fc(R);this.rKe(Mg,R,f.cp,f.cp+1);fa.peek("blobElt").appendChild(R);
We(R,!0);mg.add(f.blob);Kc&&(fe<=mb&&mb+1<=Te||Hc.iW)?(nc&&(Sys.UI.DomElement.containsCssClass(R,hc.a.eSd)||Sys.UI.DomElement.addCssClass(R,hc.a.eSd),u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordTouchImageGrippiesResizedSettings"),u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TouchImageGrippiesResizedIsEnabled")&&this.If&&this.If.Nd&&Object(Ma.a)(Db.PageView,this.If.Nd)&&(c=this.If.Nd,mb=u.AFrameworkApplication.Ta,c&&3===c.FBg?mb.La(E.a.ezh,2,R):mb.La(E.a.fzh,
2,R))),Sys.UI.DomElement.addCssClass(R,hc.a.h7)):(Sys.UI.DomElement.removeCssClass(R,hc.a.eSd),Sys.UI.DomElement.removeCssClass(R,hc.a.h7));this.JAg||this.yOf(Hc,oc,Kc&&nc);Sys.UI.DomElement.removeCssClass(R,hc.a.qEi);this.Yc&&this.Yc.isFeatureEnabled(162)&&5===f.blob.Lq&&(f=f.blob,f.properties&&f.properties.Sa(tb.a.A3b)&&(f=f.properties.getValue(tb.a.A3b))&&""!==f&&(Ic.add(this.EFb(ma.a.Sla,R,l,f)),Ic.add(this.EFb(ma.a.Sla,R,x,f))));a=Xc.pha(He,a,R);fa.push(R,"RenderBlob");return{returnValue:Kb,
yEa:a,kVj:Sg,jVj:li}}wHd(a,b,c){b.length?(Sys.UI.DomElement.addCssClass(a,hc.a.xFc),K.a.Cv(a,hc.a.oPd,b)):Sys.UI.DomElement.removeCssClass(a,hc.a.xFc);c.length&&K.a.Cv(a,hc.a.kPd,c)}yOf(a,b,c){a=nb.GraphIterator.mb(a);a.af();a.Rg(11);if(b=a.currentNode.oc(b.Ma))b.htmlElement.style.zIndex=c?"1":""}CTk(a,b,c,f){let l=ya.a.N0i(c,Xc.gzh);5===a.blob.Lq&&f?(l||(l=b.Wo(la.a.span),l.id=Xc.gzh,Sys.UI.DomElement.addCssClass(l,Tb.Mwj),Sys.UI.DomElement.addCssClass(l,Tb.c3),c.appendChild(l)),this.o8f(b,l,f.lp,
Tb.Gwj),this.o8f(b,l,f.uo,Tb.Kwj)):l&&c.removeChild(l)}o8f(a,b,c,f){c&&!ya.a.x0b(b,f)&&(a=a.Wo(la.a.span),a.className=f,a.style.borderBottom="2px solid #000",b.appendChild(a))}zTk(a,b,c,f,l,x,G,R,fa,wa,Wa){a=b.formatting||a;b=Wa?this.aHc(a,c,x,G,wa,fa):this.BXb(f.peek("CreateFormattingSpan5"),a,c,x,G,R,wa,fa);f.push(b,"RenderFormattingSpan");l.n7f=!0;return{returnValue:b,aPa:a}}GDk(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf){Hc<oc&&oc<ie&&(Hc=Ka.a.substring(nc,Hc,oc),ya.a.wx(a,
Hc),Kc=Xc.pha(Wa,Kc,a),b.pop("ProcessSelectionBegins"),a=this.QRd(b.peek("CreateTextOverlaySpan2"),c,f,l,x,G,R,wa,mb,Kb,Hc,!0,He,fe,!1,Te,We,Qf),b.push(a,"TextOverlaySpan2"),Hc=oc,fa.YRe=!0);Hc<Ic&&Ic<ie&&(nc=Ka.a.substring(nc,Hc,Ic),ya.a.wx(a,nc),Kc=Xc.pha(Wa,Kc,a),b.pop("ProcessSelectionEnds"),a=this.QRd(b.peek("CreateTextOverlaySpan3"),c,f,l,x,G,R,wa,mb,Kb,nc,!1,He,fe,!1,Te,We,Qf),b.push(a,"TextOverlaySpan3"),Hc=Ic,fa.YRe=!0);return{returnValue:Hc,yEa:Kc}}DTk(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,
oc){if(0<a.Ra.length){const Ic=a.Ra.last;let Kc;Kc=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TextRunForHyperlinkInTableCellEnabled");a=nb.GraphIterator.mb(a);!Ic.Sm||Kc&&a.pc(16)||(nc=!1,c=null);if(this.sN?Ic.UZ:Ic.fieldRangeEnd)nc=!1,c=null;if(Ic.m3){c||(c=Ic.formatting);x=this.zUf(b,c,f,G,R,mb,wa,Wa);b=ya.a.j7a(x);for(let Hc of b)Kb=Xc.pha(fa,Kb,Hc);l.$sg=!0}else!nc&&oc&&(c||(c=Ic.formatting),x=this.BXb(b,c,f,G,R,wa,mb,Wa),x.appendChild(G.ownerDocument.createTextNode("")),x.className+=
" EmptyTextRun",Kb=Xc.pha(fa,Kb,x),l.lJc=!0)}else Z.ULS.sendTraceTag(18482315,324,15,"CharacterProperties has no elements");return{returnValue:nc,SWc:x,yEa:Kb}}wTk(a,b,c,f,l,x,G,R,fa,wa,Wa){var mb=Xc.f0i(a,wa);b=this.hUf(b,f,R,mb);Ea.a.instance.shipAssertTag(25519712,8,0<l.Ra.length,"Chps should never be empty");R=null;l.Ra&&0<l.Ra.length&&(R=l.Ra.last);this.Jlb&&R&&(R.lp||R.uo||R.Bs)&&(b.className+=" "+Tb.c3);let Kb;({yFc:mb,uFc:Kb}=Xc.i$f(R));this.wHd(b,mb,Kb);this.rKe(Wa,b,R?R.cp:0,-1);wa&&(b.className+=
" "+Bc.a.VSd);this.Jnh(f,l,b);a.appendChild(b);G(b);Xc.pha(x,fa,b);c.VOi=!0}Jnh(a,b,c){if(a.Kl&&this.Goa.Aad&&this.Goa.zbl(c)){if((a=this.Goa.fsa(b))&&0<ta.a.count(a))try{c.setAttribute("data-ccp-props",JSON.stringify(a))}catch(f){Z.ULS.sendTraceTag(23639749,307,15,"SetParagraphPropertiesOnHtmlElement for CCP - Cannot serialize object contains circular reference.")}(b=this.Goa.Ohj(b))&&0<b.length&&c.setAttribute("data-indent",b)}}NDi(a,b,c,f){c=c.Wo(la.a.span);switch(b.changeType){case 2:c.className=
Tb.Wxh+" "+Tb.c3;c.style.color="#000";break;case 1:c.className=Tb.Yxh+" "+Tb.c3;c.style.color="#000";break;case 3:c.className=Tb.c3}a.appendChild(c);f(c);return c}Kwl(a,b,c){a&&!b?c.notify(1):!a&&b&&c.notify(2)}Fxl(a,b,c){a.KUj=c.count;a.lxj=b;this.nVh(a)}sAi(a,b,c,f,l,x,G){c=c.Wo(la.a.a);c.className=hc.a.Vmg;b.Ksa&&b.Slc&&!H.a.instance.ga(61)&&(b.url.endsWith(u.AFrameworkApplication.fa.Ga("UserPrincipalName"))?c.className+=" "+hc.a.wEi:c.className+=" "+hc.a.xEi);this.Ov.Jrh()&&(c.style["pointer-events"]=
"all");this.Ov.grh(this.e2a.Vzl,!0)&&this.hQk(c);this.eP.ob(ma.a.Sla,c,l,b.url);this.eP.ob(ma.a.Tla,c,x);f.add(c);b.url&&Ka.a.g8(b.url)&&!r.a.Ki&&(Ca.d(c,Da.a.href,b.url),Ca.d(c,Da.a.target,"_blank"),Ca.d(c,Da.a.rel,"noreferrer"));a.appendChild(c);G(c);return c}hQk(a){a.style.textDecoration="none";a.style.color="inherit"}BXb(a,b,c,f,l,x,G,R){b=this.aHc(b,c,f,l,G,R);a.appendChild(b);x(b);return b}aHc(a,b,c,f,l,x){if(this.IMf){var G=a?a.em.toString():Ga.a.nil.toString();if(G in this.stc)a=this.stc[G];
else{let R=a?a.cache:Zb.FormattingCacheManager.r0b(f,Ga.a.nil);a=this.MQd(a,R,b,c,f,l);this.stc[G]=a}b=a.cloneNode();K.a.gGc(a,b)}else G=a?a.cache:Zb.FormattingCacheManager.r0b(f,Ga.a.nil),b=this.MQd(a,G,b,c,f,l);this.vIf(b,x);return b}MQd(a,b,c,f,l,x){const G=f.Wo(la.a.span);b=this.Ov.P$f(f,b,l)||b;this.rai(f,G,b,l);this.vai(G,b,l,f,x);this.Eai(G,a);this.dMa.Hai(G,l,c,f.Fd,b.fontSize,b.eN);return G}rai(a,b,c,f){a=this.Ov.O$f(a,f,c);for(let l of a.keys)b.setAttribute(l,a.ga(l))}zUf(a,b,c,f,l,x,G,
R){var fa=b?b.cache:Zb.FormattingCacheManager.r0b(l,Ga.a.nil);fa=this.sKh(fa,l);b=this.MQd(b,fa,c,f,l,x);this.vIf(b,R);fa.isSuperscript||fa.sF?(f=f.Wo(la.a.span),this.rIf(f,fa,!0),b.appendChild(f),ya.a.wx(f,""),G(f)):ya.a.wx(b,"");a.appendChild(b);G(b);return b}vai(a,b,c,f,l){var x=b.Qs;const G=[];Array.add(G,hc.a.UJa);var R=this.Ov.m0d(c,b,this.e2a.Wzl,x);var fa=null;b.e8a&&(fa=b.dR,fa=fa===Hb.a.auto?"transparent":Hb.a.ZH(fa));b.KRa&&(fa=b.highlight,fa=fa===Hb.a.auto?"transparent":Hb.a.ZH(fa));c.nXg!==
Hb.a.nil&&(R=Hb.a.ZH(c.nXg));l!==Hb.a.nil&&(fa=Hb.a.ZH(l));ya.a.TAa(a);b.ulg&&(a.style.opacity=b.Q6f.toString());b.M8a&&(a.title=Box4Intl.Box4Strings.l_DeadWordLink);R?(a.style.color=R,Ca.d(a,Da.a.EWf,"WindowText"===R?"auto":"none")):Ca.d(a,Da.a.EWf,"auto");fa?(a.style.backgroundColor=fa,"transparent"!==fa&&Array.add(G,"Highlight")):Sys.UI.DomElement.removeCssClass(a,"Highlight");l=b.fontSize;if(b.isSuperscript||b.sF)l=Math.floor(l*this.Ov.D3d());R=this.Ov.hbg(l,c,f.Fd);fa=this.Ov.O0b(b);l=this.bV&&
this.bV.iWi?this.bV.r1h(b.eN):this.NLh(fa);this.e2a.gae&&l&&ia.FontUtils.Gwb(fa)&&(l=this.Ov.xIf(fa,l));let wa=b.ERa&&b.isBold;void 0===wa&&(wa=!1);let Wa=b.b8a&&b.isItalic;void 0===Wa&&(Wa=!1);l=this.Ov.M9g(new oa.a(fa,wa,Wa),l,c);!this.ftl(fa,b,a.style)&&b.ERa&&(b.isBold?(a.style.fontWeight="bold",r.a.lk&&r.a.Nj&&Array.add(G,"MacChromeBold")):a.style.fontWeight="normal");b.b8a&&(a.style.fontStyle=b.isItalic?"italic":"normal");(b.Dub||x&&this.Ov.irh()||b.Cub||b.T2b)&&this.MGe(a,b,c,G);R&&(a.style.fontSize=
R);if(l&&(a.style.fontFamily=l,H.a.instance.ga(118))){Ea.a.instance.J(51676058,8,4,"UseQuotesWithFontFamily is Enabled.");c=new Sys.StringBuilder("");x=l.split(",");for(l=0;l<x.length-1;l++)c.append('"'+x[l].trim()+'",');0<x.length&&c.append('"'+x[x.length-1].trim()+'"');a.style.fontFamily=c.toString()}b.FRa&&(1===b.capitalization?a.style.fontVariant="small-caps":2===b.capitalization?a.style.textTransform="uppercase":a.style.fontVariant="normal");if(f=this.Ov.M9f(b,f.Fd))a.style.letterSpacing=f;if(b=
this.Ov.jcg(b))a.style.fontKerning=b,r.a.US&&(a.style.fontFeatureSettings="normal"===b?'"kern" 1':'"kern" 0');a.className=G.join(" ")}ftl(a,b,c){return H.a.instance.ga(116)&&r.a.lk&&r.a.Nj?"Community Light"===a?(c.fontWeight=b.isBold?"400":"300",!0):"Community Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):"Community Slab Medium"===a?(c.fontWeight=b.isBold?"bold":"500",!0):"Community Slab Semibold"===a?(c.fontWeight=b.isBold?"bold":"600",!0):!1:!1}vIf(a,b){this.Xc.ag&&b&&!b.Ij&&(b.lp||b.uo)&&
(a.style.color="#000")}Eai(a,b){if(b=b?this.pOh(b):0){const c=sa.a.oe(b);c?(a.setAttribute("xml:lang",c.name),a.setAttribute("lang",c.name)):this.tAf.contains(b)||(Z.ULS.sendTraceTag(18482318,324,15,"Unknown LCID encountered in file: {0}",b),this.tAf.add(b))}}MGe(a,b,c,f){c="";const l=b.GD,x=b.rF;b=b.TZ;l&&(c="underline",f[f.length]="Underlined");if(x||b)c=l?c+" line-through":"line-through",f[f.length]="Strikethrough";l||x||b||(c="none");0<c.length&&(a.style.textDecoration=c)}rIf(a,b,c){b.isSuperscript&&
(a.style.verticalAlign="super",a.className+=" Superscript");b.sF&&(a.style.verticalAlign="sub",a.className+=" Subscript");c&&(a.style.backgroundColor="inherit");(b.isSuperscript||b.sF)&&Ca.d(a,Da.a.GWf,(b.fontSize/2).toString())}QRd(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc){const ie=b?b.cache:Zb.FormattingCacheManager.r0b(c,Ga.a.nil);Wa=!f||Kb||this.SPa(f,Wa)?0:f.Gh.proofingType;Kb=!!l;const He=!!x,fe=!!G;x=this.Ov.Brh(ie,mb,l,x,G);if(nc.O5b||Ic&&Wb(Ic))x=!1;this.IMf?(l=this.Rhj(ie,Wa,Kb,He,
fe,mb,x,Kc),this.yzc.Jb(l)?mb=this.yzc.ga(l):(mb=this.HVf(R,ie,Wa,Kb,He,fe,mb,x,Kc),this.yzc.$(l,mb)),R=mb.cloneNode(),K.a.gGc(mb,R)):R=this.HVf(R,ie,Wa,Kb,He,fe,mb,x,Kc);this.B9h(a,R,ie);this.qJd(a,R);this.kGf(R);this.jGf(a,R);this.Goa.dxi&&this.C9h(R,b,c);this.Cmb&&0!==Wa&&this.Cmb.NIk(R,c,(Te,We,Qf,mg)=>{fa.add(this.EFb(Te,We,Qf,mg))},f);nc.O5b&&oc&&nc.span&&(this.aKd(null,nc.span),nc.span=null);if((b=nc.O5b?R:null)||nc.span)this.aKd(b,nc.span),nc.span=b,nc.span&&(b=(b=K.a.te(a,X.a.lXc))?b:-1,
0<b&&(nc.span.style.lineHeight=String.format("{0}px",b+3)));Ic&&!Ic.isEmpty&&(fd(R,Ic),this.Cmb&&this.Cmb.Xah(R,c,(Te,We,Qf,mg)=>{fa.add(this.EFb(Te,We,Qf,mg))},Ic,0));Hc&&Sys.UI.DomElement.addCssClass(R,hc.a.vEi);a.appendChild(R);wa(R);return R}SPa(a,b){b=a&&a.Gh&&a.Gh.token?a.Gh.token:b;return 0!==a.Gh.errorType&&!!this.NLa&&this.NLa.contains(b,a.Gh.lcid)}Rhj(a,b,c,f,l,x,G,R){b|=0;x&&(b|=16);G&&(b|=32);c&&(b|=64);f&&(b|=128);l&&(b|=256);R&&(b|=2048);a.isSuperscript&&(b|=512);a.sF&&(b|=1024);return b}HVf(a,
b,c,f,l,x,G,R,fa){a=a.Wo(la.a.span);const wa=[];if(0!==c){if(!this.e2a.ZCl)switch(c){case 1:wa[wa.length]=hc.a.iHc;break;case 2:wa[wa.length]=hc.a.gHc;break;case 3:wa[wa.length]=hc.a.fHc}b.isSuperscript&&(wa[wa.length]=hc.a.gSd)}else fa&&(wa[wa.length]=hc.a.nEi);G&&(wa[wa.length]=hc.a.h7);f&&(wa[wa.length]=hc.a.bSd);l&&(wa[wa.length]=hc.a.dSd);x&&(wa[wa.length]=hc.a.hHc);a.className=0<wa.length?wa.join(" "):hc.a.aYb;this.rIf(a,b,R);return a}C9h(a,b,c){if(b&&a){if(b=vb.a.Wsb(b))if(b=Uc.StyleReader.UP(b)){a.setAttribute("data-ccp-charstyle",
b);return}(c=yb.ParagraphReader.Vd(c)?Uc.StyleReader.BD(c):null)&&(c=Uc.StyleReader.UP(c))&&c!==Uc.StyleReader.DKa&&c!==Uc.StyleReader.AGh&&a.setAttribute("data-ccp-parastyle",c)}}B9h(a,b,c){(c=this.Ov.Dgg(c))&&a.style&&a.style.fontSize&&""!==a.style.fontSize&&(a=a.style.fontSize,a=parseFloat(Ka.a.substring(a,0,a.indexOf("px"))),isNaN(a)||(b.style.verticalAlign=a/this.Ov.D3d()*c/100+"px"))}qJd(){}kGf(){}jGf(){}rzi(a,b,c,f){b=b.Wo(la.a.span);b.className=hc.a.eXd;this.nzc&&this.nzc.AGl(f,b);a.appendChild(b);
c(b);return b}hUf(a,b,c,f){b=b.Wo(la.a.span);b.className=hc.a.aN;a&&(b.style.fontSize=a.style.fontSize,b.style.lineHeight=this.O_d(a),b.style.fontFamily=a.style.fontFamily);a="";for(let l=0;l<f;l++)a+=c;b.innerText=a;return b}O_d(a){return a.style.lineHeight}aKd(a,b){a?(Sys.UI.DomElement.addCssClass(a,"Highlight"),Sys.UI.DomElement.addCssClass(a,hc.a.rEi),b||Sys.UI.DomElement.addCssClass(a,hc.a.cSd)):b&&((a=Sys.UI.DomElement.containsCssClass(b,hc.a.cSd))&&Sys.UI.DomElement.removeCssClass(b,hc.a.cSd),
Sys.UI.DomElement.addCssClass(b,a?hc.a.tEi:hc.a.sEi))}static pha(a,b,c){K.a.Cv(c,X.a.xEa,b);b<a.count?a.$(b,c):a.add(c);return b+1}static i$f(a){let b,c;b=[];c=[];if(a&&a.xg)for(let f=0;f<a.xg.length;f++){const l=a.xg.ga(f);Array.add(l.nk?b:c,l.YH)}return{yFc:b,uFc:c}}static Vfi(a,b){const c=new Lc.a;for(const l of b){var f=a.te(l);b=f.getValue(Mb.a.KWb);if(f=f.sa(Mb.a.vFc,null)){let x;({value:x}=c.Rf(f)).returnValue||(x=new Ha.a,c.$(f,x));x.add(b)}}return c}static k$f(a,b,c){const f=new Ha.a,l=Xc.Vfi(a,
b);for(const x of b){const G=a.te(x),R=G.getValue(Mb.a.KWb),fa=G.sa(Mb.a.mvi,!1),wa=G.sa(Mb.a.qRf,!1);G.sa(Mb.a.Bae,!1)&&!wa&&(c.add(x),fa||l.Jb(R)||f.add(G.id))}return Ya.JPk(b,f)}static Pvl(a,b,c,f){const l=new Ha.a,x=new Ha.a;b=Xc.k$f(a,b,l);a=Xc.k$f(a,c,x);c=new Ha.a;c.addRange(f);c.addRange(l);c=Ya.KPk(c,x);return{yFc:b,uFc:a,LEi:c,fKj:0<x.count}}static f0i(a,b){var c=1;if(r.a.qF&&!b){a=ya.a.aMc(a,!1);for(let f of a)"IMG"===f.tagName?c+=3:Sys.UI.DomElement.containsCssClass(f,"PageBreakBlob")&&
(c+=Za.tIc+Za.$Td)}return c}}Xc.gWi=.8;Xc.gzh="TrackChangeImageOverlay";Object(e.a)(Xc,"ParagraphContentRenderer",null,[1267]);var Ib=d(74),gc=d(596),Fb=d(1180),fb=d(55);class Pc{constructor(a){this._element=null;this.ai=a;this.Qtc=[]}get ownerDocument(){return this.ai}get element(){return this._element}ahb(a){this._element=a}zXg(){var a=Sys.EventArgs.Empty;if(this.Qtc)for(let b=0;b<this.Qtc.length;b++)(0,this.Qtc[b])(this,a)}dispose(){this.Qtc=this._element=this.ai=null}}Object(e.a)(Pc,"APresenter",
null,[1451,106]);class dd extends Pc{constructor(a,b){super(b.htmlElement.ownerDocument);this.Nlb=null;this.LQb=a;this.t_h=b}c8f(a){this.element&&a.SWc===this.Nlb||(this.Nlb=a.SWc,this.ahb(this.LQb.hUf(this.Nlb,this.t_h.Gd,X.a.uJc,1)),this.element.className=hc.a.Z6b,this.element.style.lineHeight=this.Nlb.style.lineHeight,a=""+K.a.te(this.Nlb,X.a.AJb),K.a.Cv(this.element,X.a.AJb,a),a=Fb.a.createElement(this.ownerDocument,la.a.span),a.innerText=X.a.Hli,ya.a.ku(this.element),this.element.appendChild(a),
a=Fb.a.createElement(this.ownerDocument,la.a.br),this.element.appendChild(a))}Jsg(){}dispose(){super.dispose();this.Nlb=null}}Object(e.a)(dd,"LineBreakPresenter",Pc,[]);class kd{constructor(a){this.LQb=a}create(a){return new dd(this.LQb,a)}}Object(e.a)(kd,"LineBreakPresenterFactory",null,[1413]);class Td extends Pc{constructor(a,b){super(a.ownerDocument);this.lGd=b;this.Vaa=a}c8f(){this.element||(this.ahb(this.Vaa.Wo(la.a.span)),19===this.lGd.kind||18===this.lGd.kind?Sys.UI.DomElement.addCssClass(this.element,
hc.a.aSd):(Sys.UI.DomElement.addCssClass(this.element,hc.a.bYb),this.element.title=Box4Intl.Box4Strings.l_UnsupportedTooltip),this.element.innerText=this.lGd.v5a,this.zXg())}Jsg(){this.ahb(null);this.zXg()}}Object(e.a)(Td,"UnsupportedObjectPresenter",Pc,[]);class ce{create(a,b){return new Td(a,b)}}Object(e.a)(ce,"UnsupportedObjectPresenterFactory",null,[1412]);class ld{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,x=!1,G=!1){this.Ww=a;this.aLi=b;this.Vzl=c;this.Wzl=f;this.Ppc=l;this.gae=x;this.ZCl=G}}Object(e.a)(ld,
"ParagraphContentRendererSettings",null,[]);var ad=d(110);class Yf{constructor(a,b,c){this.aV=a;this.LY=b;this.oNb=c}Z6a(a){return a}hbg(a,b,c){return c.Yha(a)}M9f(){return null}jcg(){return r.a.Nj&&window.chrome?"none":null}VOf(){return!1}Zzh(){return!1}xIf(){return""}IEh(){}NRf(){}Grh(a){return a===E.a.underline||a===E.a.qna||a===E.a.strikethrough||a===E.a.Js||a===E.a.w$}HCe(a,b){this.aV&&this.aV.isEnabled&&this.aV.createFontUrl(a);this.LY&&this.LY.isEnabled&&(b=ia.FontUtils.gob(b,a,!1,!1,!0),this.LY.createFontUrl(a));
return b}M9g(a,b,c=null){if(!a)return b;b=this.HCe(a.fontName,b);this.oNb&&this.oNb.isEnabled&&(b=ia.FontUtils.gob(b,a.fontName,!1,!0),this.oNb.JFl(a)||this.oNb.TEl(c),this.oNb.cFl(a));return b}MTc(){return!1}m0d(a,b,c,f){a=null;!c&&f||!b.Y2||(b=b.fontColor,a=b===Hb.a.auto?"WindowText":Hb.a.ZH(b));return a}Brh(a,b,c,f,l){return!b&&!c&&!f&&!l}Dgg(){return 0}D3d(){return.8}grh(a,b){return a||!b}Jrh(){return!1}irh(){return!1}O$f(){return new Lc.a}P$f(){return null}O0b(a){return ad.Font.ECa(a.eN)}}Object(e.a)(Yf,
"TextRenderingStrategy",null,[1211]);class Xd{get name(){return"Box4.ParagraphRenderElements"}Wb(a){a.register(kd,"Box4.LineBreakPresenterFactory").as("Box4.ILineBreakPresenterFactory").ma().na(()=>new kd(a.resolve("Box4.IParagraphContentRenderer")));a.register(ce,"Box4.UnsupportedObjectPresenterFactory").as("Box4.IUnsupportedObjectPresenterFactory").ma();a.register(Yf,"Box4.TextRenderingStrategy").as("Box4.ITextRenderingStrategy").ma().na(()=>new Yf(a.qb("Box4.IFontService"),a.qb("Box4.CustomFontService"),
a.qb("Box4.IEmbeddedFontService")));a.register(ld,"Box4.ParagraphContentRendererSettings").ma().na(()=>new ld(Ib.ListReader.Ww,u.AFrameworkApplication.fa.ka("DragDropSelectionIsEnabled"),H.a.instance.ga(49),H.a.instance.ga(53),u.AFrameworkApplication.fa.ka("WordEditorCommentImprovementIsEnabled"),u.AFrameworkApplication.fa.ka(ia.FontUtils.IQf),u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")));a.register(Xc,"Box4.ParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().na(()=>
new Xc(pa.InteractiveViewManager.instance,ja.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.qb("Box4.Proofing.IProofingFeatureConfiguration"),a.resolve("Box4.Proofing.IIgnoreAllKeywords"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.ParagraphContentRendererSettings"),a.resolve("Box4.ILineSpacingHelper"),a.qb("Box4.IFeatureHelper"),ia.FontUtils.Xha,a.qb("Box4.IFontSlotProvider"),Object(C.a)(a.resolve("Box4.IEditStateEventManager"),
a.resolve("Box4.IEditStateEventManager").fbh,"raiseParagraphContentUpdatedEvent"),vb.a.language,a.qb("Box4.ITableOfContentRenderHelper"),gc.a.ZKf))}init(){}dispose(){}static main(){m.a.instance.Bc(new Xd)}}Object(e.a)(Xd,"Box4ParagraphRenderElementsPackage",null,[2,3]);class fg{constructor(a,b,c,f,l,x,G){this.jbe=a;this.OSj=b;this.HUc=c;this.nNj=f;this.kQj=l;this.Ww=x;this.HQj=b&&G||f}}Object(e.a)(fg,"TableCellViewElementSettings",null,[]);class ue{get name(){return"Box4.TableViewElements"}Wb(a){a.register(fg,
"Box4.TableCellViewElementSettings").ma().na(()=>new fg(u.AFrameworkApplication.fa.ka("OneNoteSpannedTableCellRenderIsEnabled"),H.a.instance.ga(63),H.a.instance.ga(30),H.a.instance.ga(77),H.a.instance.ga(71),Ib.ListReader.Ww,u.AFrameworkApplication.fa.ka("WordEditorTableCellWidthIsEnabled")))}init(){}dispose(){}static main(){m.a.instance.Bc(new ue)}}Object(e.a)(ue,"Box4TableViewElementsPackage",null,[2,3]);var Sa=d(1165),rb=d(377),pc=d(1189),cd=d(219),zd=d(159),wd=d(177),Oa=d(1121);class jb{te(a,
b){return K.a.te(a,b)}Cv(a,b,c){K.a.Cv(a,b,c)}Qma(a,b){K.a.Qma(a,b)}qIa(a){K.a.qIa(a)}gGc(a,b){K.a.gGc(a,b)}}Object(e.a)(jb,"CustomDataProxy",null,[1539]);var qc=d(343),ib=d(63),Cb=d(27);class yc{constructor(){this.Pa=new ic.a}wGk(a){this.Pa.raiseEvent("OnBackspaceDelete",a)}}Object(e.a)(yc,"BackspaceDeleteEventSource",null,[1444,1445]);class gd extends Sys.EventArgs{constructor(a,b){super();this.lM=a;this.mU=b}}gd.eventId="AEV.AVLD";Object(e.a)(gd,"EditingViewOnAfterValidateEventArgs",Sys.EventArgs,
[]);class od extends ic.a{constructor(){super()}REf(a){this.addHandler(gd.eventId,a)}yRk(a){this.removeHandler(gd.eventId,a)}}od.Fvi="AEV.CR";Object(e.a)(od,"ContentEditableViewEventSource",ic.a,[]);var Mc=d(49);class Rd{constructor(){this.Axc=null;this.Ph=0}saj(a){if(!this.Axc){var b=a.Kb?Mc.a.createTextRange(a.node,0,a.Kb):Mc.a.ak(a.node,a.Kb);this.Axc=Lb.HyperlinkReader.VB(b,!1);this.Ph=this.Axc.length-1}for(;0<=this.Ph;)if(b=this.Axc[this.Ph],a.Kb<=b.Qa)--this.Ph;else return b.Kb<=a.Qa?null:b;
return null}}Object(e.a)(Rd,"OverlappingHyperlinkHelper",null,[]);class ye{constructor(a,b,c,f,l){this.zZa=a;this.jD=b;this.uqa=c;this.p7c=f;this.q7c=l}}Object(e.a)(ye,"PersistActiveSpanEditState",null,[]);class oe{constructor(a,b){this.rg=a;this.Yg=b;this.dxc=[];this.EH=this.DH=-1}SGe(){if(-1!==this.DH&&-1!==this.EH&&this.Yg){this.dxc.reverse();const a=this.dxc.join("");let b,c;this.DH===this.EH?(b=Mc.a.ak(this.rg,this.DH),c=!!a.length):(b=Mc.a.createTextRange(this.rg,this.DH,this.EH),c=this.EH-
this.DH!==a.length||this.W3d(b)!==a);c&&this.Yg.replaceTextRange(b,a,!0,void 0,E.a.typing)}this.EH=this.DH=-1;Array.clear(this.dxc)}gai(a,b){this.DH=a.Qa;-1===this.EH&&(this.EH=a.Kb);0<b.length&&Array.add(this.dxc,b)}W3d(a){return yb.ParagraphReader.text(a.node).substring(a.Qa,a.Kb)}}Object(e.a)(oe,"ReplacementTextRangeBuilder",null,[]);var Bb=d(39);class Ff{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){this.Ch=a;this.ZC=b;this.Yoa=c;this.$f=f;this.hd=l;this.jn=x;this.rd=G;this.Jm=fa;this.jd=wa;this.kf=
Wa;this.eb=mb;this.Yuc=this.eb.ka("TextLayoutServiceUseResponse");this.fdf=this.eb.ka("TextLayoutServiceEnableActiveContentSpanFix")}Xrl(){let a,b;a=b=null;if(this.rd&&this.rd.AU){var c=this.Jm.getSelection(this.jd.contentWindow);if(c){a=b=c.focusNode;for(c=null;b&&"span"!==(c=b.nodeName.toLowerCase())&&!Sys.UI.DomElement.containsCssClass(b,hc.a.xea);)b=b.parentNode;"span"!==c&&(b=null);return{returnValue:!!b,L6f:a,M6f:b}}}return{returnValue:!1,L6f:a,M6f:b}}R$i(a){let b=0;for(let c of ya.a.j7a(a))"span"===
c.nodeName.toLowerCase()&&b++;return b}l0k(a){if(!a.parentNode||!a.parentNode.parentNode)return null;for(var b=a.parentNode;!Sys.UI.DomElement.containsCssClass(b,hc.a.xea)&&!Sys.UI.DomElement.containsCssClass(b,hc.a.s8);){if("font"===b.nodeName.toLowerCase()){a=b.previousSibling;if(!a)break;if("a"===a.nodeName.toLowerCase()){b=null;for(let c of ya.a.j7a(a))"span"===c.nodeName.toLowerCase()&&(b=c);return b}}b=b.parentNode}return null}v2i(a,b,c,f,l){let x=ya.a.fv(c);const G=ya.a.wZd(c,hc.a.xea);l=this.R$i(G)+
this.Ch.Bi.length-l.Ts.length;2>l?f.nextSibling&&"span"!==f.nextSibling.nodeName.toLowerCase()&&"br"!==f.nextSibling.nodeName.toLowerCase()?x=ya.a.fv(f)+ya.a.fv(f.nextSibling):"span"!==c.nodeName.toLowerCase()&&c.nextSibling?x=ya.a.fv(f):"#text"===c.nodeName.toLowerCase()&&c.parentNode!==f&&(x=ya.a.fv(f)):2===l?f.nextSibling&&"span"===f.nextSibling.nodeName.toLowerCase()&&(x=ya.a.fv(f)+ya.a.fv(f.nextSibling)):2<l&&(x=b.innerText,Z.ULS.sendTraceTag(541172697,323,50,"GetCorrectLastActiveSpanTextForCompleteOvertype: SpanCountDiff > 2"));
a.QWb||!b.innerText.endsWith(" ")||x.endsWith(" ")||(x+=b.innerText.substr(b.innerText.trimEnd().length));return x}gxk(a,b,c,f,l){const x=new ye(null,null,!0,null,null);let G=null,R=null;if(1===this.kf.mode||2===this.kf.mode)({L6f:G,M6f:R}=this.Xrl());let fa=!1,wa=!1;const Wa=new Rd,mb=new oe(a,f),Kb=0<this.Ch.Bi.length&&this.Ch.Bi[0].QWb;let nc=null;G&&this.eb.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&(nc=this.l0k(G));for(let Ic=this.Ch.Bi.length-1;0<=Ic;Ic--){const Kc=this.Ch.Bi[Ic],Hc=
Kc.aF;let ie=!1;if(this.fdf&&this.Yuc&&R&&!ya.a.wZb(Hc)){var oc=!1;Kb&&Ic===this.Ch.Bi.length-1&&!ya.a.wZd(G,hc.a.aN)?ie=oc=!0:1===this.Ch.Bi.length&&(oc=!0);oc&&(Hc.innerText=this.v2i(Kc,Hc,G,R,c),x.uqa=!1)}x.jD=ya.a.fv(Hc);this.ZC.y6&&this.hNi(x.jD)&&(x.jD=Ka.a.substr(x.jD,0,x.jD.length-1));oc=this.g2i(a,Ic);this.dgk(a,b,Ic,x);wa=!!x.zZa||wa;nc===Hc&&(x.q7c=Hc.innerText+ya.a.fv(G),G.nodeValue="",x.uqa=!1,Z.ULS.sendTraceTag(541172698,323,50,"PersistActiveSpanEdits: Moved text from bare node to sibling span"));
x.p7c||(x.p7c=this.ITi(a,oc,Wa));const He=!!l&&l.Rvi(oc);this.Vul(a,b,Hc,Ic,x,ie);He&&0<x.jD.length?(mb.SGe(),this.replaceTextRange(f,x,"",oc),this.Bai(l,He,x,oc)):this.Wsi(Kc,x.jD,oc,mb);fa=Hc===R||fa}mb.SGe();this.Nwl(a,x);G&&ya.a.fv(G)&&!fa&&!wa&&(this.hd.Tb("ValidTextDropped",{["Reason"]:"TextLostDuringOvertype"}),Ff.Cff||(Z.ULS.sendTraceTag(23909632,323,50,"PersistActiveSpanEdits: browser created new span with text that are is lost during OverType"),Ff.Cff=!0));return x.uqa}Wsi(a,b,c,f){if(c.contextId!==
Bb.a.Of&&!a.QWb&&0<=a.Y$c){let l=a.Y$c,x=a.rze;a=l!==x?Mc.a.createTextRange(c.node,l,x):Mc.a.ak(c.node,l);b=b.substring(l-c.Qa,b.length-(c.Kb-x))}else a=c;a.Kb-a.Qa!==b.length||b!==this.W3d(a)?f.gai(a,b):f.SGe()}hNi(a){return a.charAt(a.length-1)===Za.WDb||r.a.io&&a.charCodeAt(a.length-1)===w.a.YKb}W3d(a){return yb.ParagraphReader.text(a.node).substring(a.Qa,a.Kb)}replaceTextRange(a,b,c,f){b.jD!==c&&a&&a.replaceTextRange(f,b.jD,!0,!0)}Bai(a,b,c,f){b&&0<c.jD.length&&(b=Mc.a.createTextRange(f.node,
f.Qa,f.Kb+c.jD.length),a.Dai(b))}Nwl(a,b){b.p7c&&(b=Lb.HyperlinkReader.VB(b.p7c,!0),1===b.length&&this.jn&&this.jn.G8k(a,b[0]))}Vul(a,b,c,f,l,x){const G=ya.a.bfg(c);this.Ch.Bi[f].QWb&&G?x||this.Pmj(b,f,l,G):l.zZa&&!Sys.UI.DomElement.containsCssClass(c,hc.a.MM)?(this.hd.Tb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan"}),this.$f.bc++,l.jD+=l.zZa,l.zZa=null,ya.a.wx(this.Ch.Bi[f].aF,l.jD)):l.q7c?(l.jD=l.q7c,l.q7c=null):this.Yuc&&this.fdf&&(a=yb.ParagraphReader.text(a),b=this.Ch.Bi[f],
c=b.Y$c,x=b.rze,f+1<this.Ch.Bi.length&&!ya.a.wZb(this.Ch.Bi[f+1].aF)&&c===x&&0<c&&" "===a.charAt(c-1)&&(l.jD=l.jD.substr(0,c-1)+" "+l.jD.substr(c-1),l.uqa=!1),b.aF.innerText.endsWith(" ")||" "!==a.charAt(x)||b.YWa+b.nRa!==x+1||(l.jD+=" ",l.uqa=!1))}Pmj(a,b,c,f){!b&&c.zZa?(this.hd.Tb("MomentaryIncorrectFormatting",{["Reason"]:"MoveEopTextIntoSpan0"}),this.$f.bb++,c.jD=c.zZa,ya.a.wx(this.Ch.Bi[b].aF,c.jD),this.rd.tF&&(a=a.lastChild,this.Yuc&&Sys.UI.DomElement.containsCssClass(a,hc.a.s8)&&(a=a.lastChild),
a&&a.parentNode&&a.parentNode.insertBefore(f,a)),c.zZa=null):(this.hd.Tb("ValidTextDropped",{["Reason"]:"EopTextLostDuringOvertype"}),this.$f.bd++,c.jD="",ya.a.wx(this.Ch.Bi[b].aF,c.jD))}g2i(a,b){b=this.Ch.Bi[b];return b.YWa?Mc.a.createTextRange(a,b.nRa,b.nRa+b.YWa):Mc.a.ak(a,b.nRa)}dgk(a,b,c,f){if(this.Ch.Bi[c].nRa+this.Ch.Bi[c].YWa===yb.ParagraphReader.textLength(a)&&(a=b.lastChild,this.Yuc&&Sys.UI.DomElement.containsCssClass(a,hc.a.s8)&&(a=a.lastChild),c=ya.a.fv(a),c.length>this.Yoa.UVd)){this.$f.ba++;
this.ZC.Pgb(!1,b,this.Ch);f.zZa=Ka.a.substr(c,0,c.length-this.Yoa.UVd);b="";for(c=0;c<this.Yoa.UVd;c++)b+=X.a.uJc;a.innerText=b;f.uqa=!1}}ITi(a,b,c){return(b=c.saj(b))&&Ff.YEj(b)?Mc.a.ak(a,b.Qa):null}static YEj(a){return!!a.hyperlink&&a.hyperlink.url===yb.ParagraphReader.text(a.paragraph).substring(a.Qa,a.Kb)}}Ff.Cff=!1;Object(e.a)(Ff,"ActiveContentSpansPersistanceManager",null,[1443]);class pg{constructor(a){this.Ds=a}Mjk(a){a&&this.Ds.lY()}}Object(e.a)(pg,"AppFrameResizeEventProcessor",null,[]);
class xf{constructor(){this.DTb=new Ha.a}ya(a){this.DTb.add(a)}Pra(a){return this.DTb.count>a?this.DTb.ga(a):null}get AEa(){return this.DTb.count}isEmpty(){return!this.DTb.count}}Object(e.a)(xf,"AggregatedAutoCorrectActions",null,[1252]);var qe=d(228);class Oh{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic){this.UQ=this.jn=this.Ttc=this.Se=null;this.Ou=a;this.NJ=b;this.xh=c;this.Lb=f;this.Ch=l;this.JY=x;this.pp=G;this.Pi=R;this.Cga=fa;this.Ds=wa;this.kf=Wa;this.sR=mb;this.rk=Kb;this.Qc=nc;this.Xc=
oc;this.Ro=Ic}fS(a){this.Se=a}get XUb(){return this.NJ}get hyperlinkEditor(){return this.jn||(this.jn=fb.a.instance.qb("Box4.IHyperlinkEditor"))}get xvj(){return this.Ttc||(this.Ttc=fb.a.instance.qb("Box4.IHyperlinkActionFactory"))}vDj(a){if(this.Ou.instance&&a&&2===this.xh.mode)if(this.Se.Cs(!0),this.Cga.value.Yv(),a.Tw)this.Ou.instance.tDj(a),this.Cga.value.Yv();else{var b=this.Pi.z7(this.xh.mode,this.Lb.Fi);a.Tmg.innerText=a.Tmg.innerText;this.sR.Qjc();this.pp.raiseEvent(qe.a.autoCorrect);1===
this.Ou.instance.uDj(a)&&(this.kf.x$(!0),b>=a.RQ&&(b+=a.iXc),this.Pi.uS(b,this.Lb.Rh),this.Se.Cs(!0),this.Cga.value.Yv(),this.Ds.lY())}}Hte(a,b){if(!this.Ou.instance||!this.xvj||!this.hyperlinkEditor)return null;this.Se.Cs(!0);a=this.JY.Yra(b).Ua;b=a.Qa;if(0>=b||!this.Ch.Bi.length)return null;if(a=this.Ou.instance.Hte(a.node,b))this.UQ||(this.UQ=new xf),this.UQ.ya(a);return a}PJi(a,b){if(2===this.xh.mode&&this.Ch.Bi.length){var c=this.Pi.z7(this.xh.mode,this.Lb.Fi);!this.UQ&&this.Ou.instance&&(b=
this.JY.Yra(b).Ua,0>c||!this.Ch.Bi.length||(this.UQ=new xf,this.UQ=this.Ou.instance.QTf(b.node,c,c-this.Ch.Bi[0].fDc,this.Ch.Bi[0].aF,!this.Ch.Bi[0].fDc,a),this.UQ.AEa||(this.UQ=null)))}}Ywk(){if(2===this.xh.mode){if(0<this.UQ.AEa){this.Se.Cs(!0);for(var a=0;a<this.UQ.AEa;a++)this.UQ.Pra(a).wFh();for(a=0;a<this.UQ.AEa;a++)this.vDj(this.UQ.Pra(a))}this.UQ=null}}}Object(e.a)(Oh,"AutocorrectActionExecutor",null,[]);var Cf=d(310);class Bg{constructor(a,b,c,f,l,x,G,R,fa,wa){this.UZh=x;this.JY=a;this.fj=
b;this.dD=c;this.ef=f;this.VJ=l;this.EXe=G;this.Xc=R;this.bD=fa;this.xya=!!wa;this.Ou=wa}isl(a,b,c,f,l,x,G){if(!f)return!1;f=this.JY.Yra(l);if(!f||!this.ef.Uw(f)||!f.Ua.Qk)return!1;l=f.Ua;if(this.FMj(l)||this.lKj(a,l)||this.l9a(l))return!1;if(Cb.App.sdi){if(this.EMj(x))return!1}else if(this.DMj(x))return!1;return this.VJ&&this.VJ.Uvb(f)||!this.Tki(a,this.fj,G,ya.a.fv(c),b)||this.xya&&!a&&this.Ou.instance&&this.Ou.instance.Ptj()?!1:!0}EMj(a){if(this.EXe&&a&&Sys.UI.DomElement.containsCssClass(a,hc.a.xea)){const b=
ya.a.$ba(a,hc.a.s8);b&&(a=b)}return ya.a.$ba(a,Bg.mXg)?!0:!1}DMj(a){if(this.EXe&&a&&Sys.UI.DomElement.containsCssClass(a,hc.a.xea)){const b=ya.a.$ba(a,hc.a.s8);b&&(a=b)}return ya.a.$ba(a,Cf.a.a$a)||ya.a.$ba(a,Bg.mXg)?!0:!1}l9a(a){return this.bD.l9a(a).returnValue}FMj(a){return this.fj&&(!this.UZh.IVb(a.node)||H.a.instance.ga(14)&&this.dD.c5g(a.node))?!0:!1}lKj(a,b){return H.a.instance.ga(14)&&this.dD.TKj(b,!a)}Tki(a,b,c,f,l){if(!f||""===f)return!1;var x=this.Xc.ag&&this.Xc.By;x=a&&!x?0:1;!a&&1<c&&
Ka.a.Xw(f,c-1)?x=2:c<f.length&&Ka.a.Xw(f,c)&&(x=1);if(a){if(a=c+x,a>=f.length-2||!this.Uki(c,f,x))return!1}else{a=c-x;if(b){if(0>a)return!1}else if(0>=a)return!1;if(1===a&&Ka.a.Oy(f.charCodeAt(0))&&(f.length===c||Ka.a.Oy(f.charCodeAt(c))))return!1}b=O.a.WCa(l,a,!0,!0);return Sys.UI.DomElement.containsCssClass(b,X.a.pEi)||Sys.UI.DomElement.containsCssClass(b,hc.a.aN)||Sys.UI.DomElement.containsCssClass(b,hc.a.MM)||Sys.UI.DomElement.containsCssClass(b,X.a.yV)?!1:!0}Uki(a,b,c){return Ka.a.Oy(b.charCodeAt(a+
c))&&(!a&&b.length===1+c||1===a&&Ka.a.Oy(b.charCodeAt(0)))?!1:!0}}Bg.mXg="NoteTagContainer";Object(e.a)(Bg,"BackspaceInBrowserHandler",null,[]);var Gf=d(1176),dh=d(196);class qg{constructor(a,b,c){this.point=a;this.width=b;this.height=c}}Object(e.a)(qg,"UnroundedRectangle",null,[]);var Pf=d(1033),qd=d(62),Tf=d(143);class Pg{constructor(a,b,c,f,l,x,G,R,fa){this.yh=null;this.gfa=!1;this.Baa=a;this.jd=b;this.PY=c;this.s1=f;this.rd=l;this.If=x;this.kf=G;this.Lb=R;this.iP=fa}dVb(a){this.yh=a}lY(){if(2===
this.kf.mode&&this.Lb.Ag){var a=this.Lb.NV,b=this.Lb.Rh;if(a&&b){if(!this.jd.yg&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordBoundsSynchronizerHeaderFooterEarlyReturnSettings"),u.AFrameworkApplication.fa.ka("BoundsSynchronizerHeaderFooterEarlyReturnIsEnabled"))){Z.ULS.sendTraceTag(51667991,317,50,"Null EditingDom in SynchronizeBounds. ViewId: {0}",this.yh.Ma);return}this.jd.yg.Mve(a);b=this.jd.yg.du;var c=this.yag(a.htmlElement,b.parentNode);if(c&&c.point){var f=c.point;
a=c.width;c=c.height;0>a&&(a=0);var l=Gf.a.create();try{b.style.top=f.y.toString()+"px",b.style.left=f.x.toString()+"px",b.style.width=a.toString()+"px",b.style.height=c.toString()+"px",b.style.paddingRight=""}finally{l&&l.dispose()}this.Prh()&&(f=this.jd.fm(),this.ySj()?f.style.clip="":(b.style.height=c+100+"px",f.style.clip="rect(0px,"+a+"px,"+c+"px,0px)"));this.Baa.instance.jxl(b.parentNode,this.Lb.Dba,!!this.yh&&this.yh.Kl&&this.yh.rsb)}}}}Prh(){return this.rd.tF&&!this.rd.Ki&&H.a.instance.ga(30)}BHj(a){return ya.a.vSa(a)}ySj(){return Tf.c(this.yh.vg)}ei(a){return ib.a.ei(a)}Iwh(a){var b=
qd.a.instance.Oa.kb;if(1===this.kf.mode){var c=(b.rf?b.Ve:b.Ua).node;b=c.oc(this.If.Nd.Ma);a=c.oc(a);if(b&&a){this.jd.yg.Mve(b);a=this.jd.yg.du;var f=this.yag(b.htmlElement,a.parentNode);if(f&&f.point){b=f.point;c=f.width;f=f.height;0>f&&(f=1);0>c&&(c=1);a=a.style;if(this.rd.rgb)this.s1.smg();else{const l=b.x+"px";c+="px";f+="px";if(a.left!==l||a.width!==c||a.height!==f)a.left=l,a.width=c,a.height=f}b=b.y+"px";a.top!==b&&(a.top=b)}}}}yag(a,b){if(!this.BHj(a))return null;var c=this.ei(a),f=this.ei(b);
let l=c.x-f.x;f=c.y-f.y;var x=Gf.a.create();try{l+=b.scrollLeft,f+=b.scrollTop}finally{x&&x.dispose()}b=c.width;c=c.height;this.PY&&this.PY.instance&&this.PY.instance.rwg(a)&&(x=this.PY.instance.s2,b/=x,c/=x);if(this.iP.Dwb(a)){var G=dh.a.It(a);G&&(x=parseFloat(G.width),G=parseFloat(G.height),isNaN(x)||isNaN(G)||(b=x,c=G))}0>=b&&(b=a.scrollWidth);0>=c&&(c=a.scrollHeight);if(this.rd.xSa||this.rd.io)b+=.001,l+=.001,f+=.001;c+=1.001;return new qg(new Pf.a(l,f),b,c)}}Object(e.a)(Pg,"BoundsSynchronizer",
null,[1442]);var Ee=d(555),xe=d(78);class jh{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.$Sh=new Ee.a(RegExp("\r\n","g"),"\n");this.qwd=null;this.gyd=0;this.XBd=!1;this.fuc=!0;this.hd=b;this.$f=c;this.pvc=a;this.jd=f;this.Oo=l;this.rd=x;this.If=G;this.Rd=R;this.fj=fa;this.Jm=wa;this.lDd=Wa;this.Ipa=Kb}get Cug(){null==this.qwd&&(this.qwd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CursorPositionFixForIMEInMacIsEnabled"):!1);return this.qwd}get iTa(){return this.gyd}get gJk(){return this.XBd}get ACj(){return this.fuc}rMc(a,
b){var c=this.jd.CCa();if(1===a||0===a)return 0;if(this.rd.AU){var f=this.ACa();if(f){this.XBd=!this.jVc(f);c=this.Jm.hPc(f);var l=this.Jm.lgg(f),x=l;u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordCursorPositionFixForIMEInMacSettings");this.Cug&&this.rd.lk&&(f=this.Jm.Cag(f),l!==f&&(x=f));return this.Oo.V1d(c,b,x,this.$f,this.hd,this.fj)}Z.ULS.sendTraceTag(51463631,324,50,"GetCaretPosition could not find IP, rangeObject is null")}else if(this.rd.qF)try{return l=c.selection.createRange(),
x=this.jd.fm().innerText,b=0,""!==x&&(b=Math.abs(this.Jm.moveStart(l.range,-1E5)),l=c.selection.createRange(),f=Math.abs(this.Jm.moveEnd(l.range,-1E5)),this.XBd=b!==f),x=this.$Sh.QHa(x),b>=x.length&&(b=x.length-1),b}catch(G){this.hd.Tb("IncorrectIpPosition",{["Reason"]:"OldIeGetCaretPositionException"}),this.$f.bg++,Z.ULS.sendTraceTag(51463190,324,15,"Incorrect IP position, message: {0}, Exception: {1}",G.message,G.toString())}else Z.ULS.sendTraceTag(51463191,324,15,"GetCaretPosition could not find IP, returned 0");
this.$f.bh++;return 0}jVc(a){return ib.a.jVc(a)}ACa(){return ib.a.ACa(this.jd.contentWindow)}acl(a,b,c,f,l){if(!u.AFrameworkApplication.fa||!u.AFrameworkApplication.fa.ka("TextLayoutServiceEnableSelectionCursorFix")||c!==l+f||a===b.Ts.length-1||Sys.UI.DomElement.containsCssClass(b.Ts[a+1],hc.a.aN))return!1;a=b.Ts[a];b=ya.a.wZd(a,hc.a.s8);if(!b)return!1;b=ya.a.j7a(b).toArray();return b[b.length-1]!==a?!1:!0}uS(a,b){var c=this.jd.contentWindow;this.fuc=!0;this.gyd=a;try{if(this.rd.AU){const x=b.Ts;
let G;var f=0;const R=this.Jm.getSelection(c);if(R)for(G=0;G<b.Ts.length;G++){const fa=b.Ts;Z.ULS.shipAssertTag(18437200,315,x===fa);let wa=fa[G],Wa=this.Oo.lI(wa,this.$f,this.hd,this.fj);var l=a<=Wa+f;const mb=Sys.UI.DomElement.containsCssClass(wa,hc.a.MM),Kb=Sys.UI.DomElement.containsCssClass(wa,X.a.yV),nc=this.acl(G,b,a,f,Wa);if(l&&!mb&&!Kb&&!nc){b=G+1;if(a===Wa+f&&b<fa.length){const oc=fa[b];!this.Oo.lI(oc,this.$f,this.hd,this.fj)&&ya.a.wZb(oc)&&(wa=oc,f=a)}a-=f;this.pvc.value.GWb(wa,c);for(c=
wa;c.firstChild;)c=c.firstChild;this.pFj(R,c,a)||(c=this.FOi(c,this.jd.CCa()),this.Cug&&this.rd.lk?2!==this.If.editingView.Zqb&&this.u1f(c,a,R):this.u1f(c,a,R));break}f+=Wa}}else this.rd.qF&&(f=this.lDd.create(this.If.Nd),l=this.Jm.createRange(this.jd.fm()),this.Jm.collapse(l,!0),this.Jm.moveStart(l,a),l.select(),f.dispose())}catch(x){Z.ULS.shipAssertTag(4203852,315,!1)}}FOi(a,b){"SPAN"===a.nodeName&&(b=b.Il.createTextNode(""),a.appendChild(b),a=b);return a}u1f(a,b,c){if(this.Oo.bvg(a)){this.Jm.removeAllRanges(c);
var f=this.Jm.createRange(a.ownerDocument);this.Jm.xHb(f,!0,a,b);this.Jm.xHb(f,!1,a,b);try{this.Jm.addRange(c,f)}catch(l){this.$f.bl++,this.hd.Tb("PossibleNoIp",{["Reason"]:"AddRangeException"}),Z.ULS.shipAssertTag(1708946,315,!1)}this.Jm.collapse(f,!0)}else Z.ULS.sendTraceTag(541172696,324,50,"EnsureCaretPositionToTextObject: Detached element")}updateCaretPosition(a,b){this.gyd=this.rMc(a,b)}mouseDown(){return this.fuc=!1}dJ(){this.fuc=!0;return!1}z7(a,b){this.Ipa&&this.Ipa.UAl(this.iTa,this.rMc(a,
b));return this.iTa}pFj(a,b,c){const f=a.focusNode,l=!!f&&3===f.nodeType,x=a.focusOffset;return a.isCollapsed&&l&&f===b&&x===c}wXf(a,b){const c=new xe.a(0,1,0,()=>{b.eTa(a.mode)&&this.updateCaretPosition(a.mode,b.Fi)},28);this.Rd.Cb(c)}}Object(e.a)(jh,"CaretPositionManager",null,[1441]);var yg=d(264);class xc{constructor(){this.XH=yg.a.instance.UZd()}}Object(e.a)(xc,"CevUsageDataTracker",null,[]);class me{constructor(a,b){this.Urc=null;this.fha=0;this.Ag=this.NV=null;this.Dba=!1;this.eAa=a;this.If=
b}init(a){this.fha=a}get Utj(){return!!this.Ag&&!!this.Ag.sg(this.fha)}get $Oa(){Z.ULS.shipAssertTag(18437208,315,!!this.Ag);return this.Rh?this.Rh.htmlElement:null}get Fi(){return this.Rh?this.Rh.Fi:null}get Rh(){return this.Urc}set Rh(a){this.Urc=a;a=null;this.eAa.instance&&(a=this.eAa.instance.xAh());this.Urc&&a&&a.YGl(this.Urc.e5g)}eTa(a){return 1!==a||qd.a.instance.Oa.Oca?this.Ag&&this.Rh&&this.NV?(a=this.If.Nd)&&yb.ParagraphReader.Vd(this.Ag)&&this.Rh===this.Ag.oc(this.fha)&&this.NV===this.Ag.oc(a.Ma)?
!0:!1:!1:!0}}Object(e.a)(me,"CevViewContentManager",null,[1440]);var Dd=d(1183),Qe=d(369);class tf{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc){this.Se=null;this.SJ=a;this.sFd=b;this.hd=c;this.Mvd=f;this.Ipa=l;this.Vga=x;this.Dk=G;this.xh=R;this.Rr=fa;this.kf=wa;this.QLa=Wa;this.iaa=mb;this.CB=Kb;this.hV=nc;this.enb=oc}fS(a){this.Se=a}EPd(a,b,c){if(this.QLa.kxj||this.SJ.L3b||!b)return!1;if(this.sFd.sqh)return!0;b=this.hd.Kp(E.a.typing);b.properties.$(Dd.a.source,"Composition");a=this.Bsi(a,c);
b.end();return a}Bsi(a,b){this.Mvd.correctBadImeState()&&this.Ipa.Mjc(E.a.ttl);this.Vga.fixupAfterMagnifierDrag();if(this.hV.Z$c(a))return!1;this.Dk.Bde=(new Date).getTime();if(1===this.xh.mode){let c;({X2:b,PIb:c}=this.hV.AAh(a,b));if(b)return c}this.Rr.isComposing=!0;this.enb||this.kf.x$(!0);a.eventName===ma.a.FPd&&this.iaa.raiseEvent(Qe.a.TRf,a);this.CB.FNa(a);return!1}TWb(a,b,c){this.enb&&this.Se&&this.Se.Cs(!0,!0);return this.EPd(a,b,c)}SWb(a,b,c){this.EPd(a,b,c);return this.Rr.isComposing=!1}}
Object(e.a)(tf,"CompositionEventProcessor",null,[]);class Rb{constructor(a,b,c){this.nwd=!1;this.iaa=a;this.pp=b;this.k6=c}get isComposing(){return this.nwd}set isComposing(a){(this.nwd=a)?(this.iaa.raiseEvent(Qe.a.Csi),this.pp.raiseEvent(qe.a.exj)):(this.iaa.raiseEvent(Qe.a.zsi),this.pp.raiseEvent(qe.a.cxj))}get kEa(){return!this.isComposing&&!this.k6.Qng}}Object(e.a)(Rb,"CompositionStateManager",null,[]);var Jc=d(133),Qc=d(89);class Ph{constructor(a,b,c){this.cQh=u.AFrameworkApplication.fa.ka("AccessibilityNotificationEnabledViaAriaLiveRegion");
this.mAa=this.wtd=this.RGd=this.Vya=this.Nsd=null;this.Lnb=a;this.yH=b;this.qoa=c;this.render();this.qoa.C7c&&this.yH.JM(Object(C.a)(this,this.o7c,"modeSwitched"))}o7c(){this.qoa.prh&&this.phd(!0);this.B1f()}get du(){return this.RGd}get contentWindow(){return ib.a.Raj(this.Lnb.ownerDocument)}get contentDocument(){return this.Lnb.ownerDocument}get rya(){return this.Lnb}get Hn(){return this.wtd}get FGh(){return this.mAa}get isValid(){return!0}initialize(a,b){this.Vya=a;this.Vya.OLd=Object(C.a)(this,
this.onBlur,"onBlur");b()}Qhh(){this.du.style.left="0px";this.du.style.top="0px"}DNi(){this.Vya&&this.Vya.vOi(this,this.yH)}Nma(){}Lmd(){v.FocusManager.Mr(this.contentWindow)}mAh(){v.FocusManager.Zsl(this.Hn)}get lhb(){return!ib.a.KDj(this.Hn)}set lhb(a){}fKe(a,b,c){this.Hn.setAttribute(Jc.a.Wr,a);this.Nsd&&(this.Nsd.innerText=b);this.Ukc(c)}Ukc(a){a&&this.Hn.setAttribute(Jc.a.Ye,a)}phd(a){if(r.a.Aj||a)a=!this.qoa.Q9d&&a,this.Hn.setAttribute("contenteditable",a?"true":"false"),this.qoa.prh?(Sys.UI.DomElement.addCssClass(this.Hn,
"WACEditing"),Sys.UI.DomElement.addCssClass(this.Hn,I.AppFrame.R_f),Sys.UI.DomElement.addCssClass(this.Hn,"EditingSurfaceBody")):(Sys.UI.DomElement.removeCssClass(this.Hn,"WACEditing"),Sys.UI.DomElement.removeCssClass(this.Hn,I.AppFrame.R_f),Sys.UI.DomElement.removeCssClass(this.Hn,"EditingSurfaceBody"))}dispose(){this.xul();this.du&&(this.du.parentNode&&this.du.parentNode.removeChild(this.du),this.wtd=this.RGd=null)}render(){const a=String.format("{0}_EditingElement",this.Lnb.id),b=String.format("{0}_WrappingDiv",
a);this.RGd=document.createElement("div");this.du.id=b;this.du.style.height="0px";this.du.style.width="0px";this.du.style.display="none";Cb.App.instance.HTc&&Sys.UI.DomElement.addCssClass(this.du,"NoPointer");this.wtd=document.createElement("div");this.Hn.id=a;this.Hn.setAttribute("contenteditable",!this.qoa.Q9d);this.Hn.setAttribute("spellcheck","false");r.a.Fja&&this.contentDocument.execCommand("AutoUrlDetect",!1,!1);this.U2k();this.B1f();Qc.c(this.Hn,!0);Qc.c(this.du,!0);this.mAa=document.createElement("div");
this.du.appendChild(this.Hn);this.Lnb.appendChild(this.du)}B1f(){if(this.Hn){const a=String.format("{0}_WACEditing_DescribedByElement",this.Lnb.id),b=this.qoa.V_h;this.qoa.Q9d?this.Hn.setAttribute("tabindex","0"):this.Hn.removeAttribute("tabindex");if(!this.cQh){const c=H.a.instance.ga(81)?Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage:Jc.a.w0i();this.Nsd=Jc.a.eHf(this.du,this.Hn,a,c);this.fKe(b,c,null)}}}U2k(){r.a.Aj?Sys.UI.DomElement.addCssClass(this.Hn,"InternetExplorer"):
r.a.eg?Sys.UI.DomElement.addCssClass(this.Hn,"FireFox"):r.a.mta&&Sys.UI.DomElement.addCssClass(this.Hn,"Safari");r.a.Ki?Sys.UI.DomElement.addCssClass(this.Hn,"iPad"):Sys.UI.DomElement.addCssClass(this.Hn,"usehover")}xul(){this.Vya&&(this.Vya.wul(this,this.yH),this.Vya=null)}onBlur(a){this.Vya.hEg(a);this.Vya.pKf(a)}nfk(){this.du.style.width="0px";this.du.style.height="0px"}Mve(a){a=a.htmlElement;this.du.parentNode!==a.parentNode&&a.parentNode&&a.parentNode.insertBefore(this.du,a)}Rrl(a){if(a&&"DIV"===
a.tagName){var b=a.childNodes;for(let c=0;c<b.length;c++)if("TBODY"===b[c].tagName||"TR"===b[c].tagName){for(b=a.ownerDocument.createElement("TABLE");a.hasChildNodes();)b.appendChild(a.firstChild);ya.a.TAa(a);a.appendChild(b);break}}}}Object(e.a)(Ph,"ContentEditableDiv",null,[1452,106]);class ng{create(a,b,c){return new Ph(a,b,c)}}Object(e.a)(ng,"ContentEditableDomFactory",null,[1439]);var se=d(75);class pf{constructor(a,b){this.rd=a;pf.eb=b}ETc(a){return Sys.UI.DomElement.containsCssClass(a,"PageBreakBlob")}iMi(a,
b){a=ya.a.fv(a);const c=Ka.a.wEa(a,b-1);return(b=a.substr(c+1,b-c-1))&&(Ka.a.g8(b)||Ka.a.P4b(b))?!0:!1}L_d(a,b,c){try{if(3===a.nodeType)return a.nodeValue}catch(l){return b.Tb("FailedToRetrieveText",{["Reason"]:"GetTextCrashed"}),c.o++,""}if("IMG"===a.tagName)return Za.Lng;if("BR"===a.tagName)return Za.AKf;if(this.iwg(a)&&(u.AFrameworkApplication.DN("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),pf.eb.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return"";
let f="";for(let l=0;l<a.childNodes.length;l++)f+=this.L_d(a.childNodes[l],b,c);return f}ahg(a,b,c,f){try{if(3===a.nodeType){var l=a.nodeValue;l=a.nodeValue;return l.length}}catch(x){return Z.ULS.sendTraceTag(51463192,324,15,x.message),c.Tb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionRecursiveBadNode"}),b.bs++,-1}if(pf.yUc(a))return this.o8i(a);if(Sys.UI.DomElement.containsCssClass(a,"LineBreakBlob"))return 1;l=0;"IMG"===a.tagName&&(l=f?l+1:l+3);if(this.iwg(a)&&(u.AFrameworkApplication.DN("Microsoft.Office.Web.SessionSettings.IWacWoncaSkipPictureDescriptionWhenGettingElementTextSettings"),
pf.eb.ka("SkipPictureDescriptionWhenGettingElementTextIsEnabled")))return 0;this.ETc(a)&&(l+=Za.tIc+Za.$Td);for(let x=0;x<a.childNodes.length;x++){const G=this.ahg(a.childNodes[x],b,c,f);if(0<=G)l+=G;else return a.innerText.length}return l}iwg(a){return void 0===a.parentNode||null===a.parentNode?!1:Sys.UI.DomElement.containsCssClass(a.parentNode,"WACImageContainer")&&"SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,"WACAltTextDescribedBy")}EQj(a){return Sys.UI.DomElement.containsCssClass(a,
hc.a.hll)}o8i(a){return(a=a.querySelector(".RawEquation"))?parseInt(a.getAttribute("data-length")):se.AParagraphNode.AZ.length}lI(a,b,c,f){try{if(3===a.nodeType){let l=a.nodeValue;l=a.nodeValue;return l.length}}catch(l){return c.Tb("PossibleIncorrectIpPosition",{["Reason"]:"TextLengthForSelectionBadNode"}),b.br++,0}return this.ahg(a,b,c,f)}K9f(a,b,c,f,l){let x=0;const G=a.Ts;for(let R=0;R<G.length;R++){a=G[R];const fa=this.lI(a,f,c,l);if(b<x+fa)return b-=x,c=a.innerText,b>=c.length?0:Ka.a.charCodeAt(c,
b);x+=fa}f.bt++;return 0}V1d(a,b,c,f,l,x){if(void 0===a||null===a)return l.Tb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullElement"}),f.bi++,Z.ULS.sendTraceTag(51463193,324,15,"NoOffsetFromNullElement when trying to get position"),0;if(!b)return Z.ULS.sendTraceTag(18437279,324,15,"GetParagraphCpFromElementOffset found null ParagraphElement when trying to get position"),0;let G=0;if(3===a.nodeType)G=c;else for(var R=0;R<c;R++)G+=this.lI(a.childNodes[R],f,l,x);for(;a!==b;){R=a;a=a.parentNode;
if(!a){Z.ULS.sendTraceTag(51463195,324,15,"GetParagraphCpFromElementOffset found null parent when trying to get position");l.Tb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromNullParent"});f.bj++;if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordInvalidCaretPositionFixSettings"),u.AFrameworkApplication.fa.ka("InvalidCaretPositionFixIsEnabled")))return 0;break}this.ETc(R)&&(G+=Za.tIc);let fa=0;for(;fa<a.childNodes.length&&a.childNodes[fa]!==R;)G+=
this.lI(a.childNodes[fa],f,l,x),fa++;if(fa===a.childNodes.length)if(3===R.nodeType)G=c;else return l.Tb("IncorrectIpPosition",{["Reason"]:"NoOffsetFromSelectionNotInDom"}),f.bk++,Z.ULS.sendTraceTag(51463196,324,15,"The current selection is in a non-text node that is not in the editing view's DOM."),0}return G}bvg(a){return ya.a.wZb(a)}static get instance(){pf.Ja||(pf.Ja=new pf(pc.a.instance,u.AFrameworkApplication.fa));return pf.Ja}static yUc(a){return Sys.UI.DomElement.containsCssClass(a,hc.a.Cdk)||
Sys.UI.DomElement.containsCssClass(a,hc.a.XOi)||Sys.UI.DomElement.containsCssClass(a,hc.a.JLi)}}pf.Ja=null;pf.eb=null;Object(e.a)(pf,"ContentEditableViewDomUtils",null,[1435]);class $d{constructor(a,b){this.xvd=null;this.jd=a;this.Dk=b}qnd(){return 1<this.A4i()||this.llg(this.xvd,this.wag())}Qjc(){const a=this.wag();this.xvd=a?a.cloneNode(!0):null}A4i(){if(this.jd){const a=this.jd.fm();if(a&&a.childNodes)return a.childNodes.length}return 0}wag(){if(this.jd){const a=this.jd.fm();if(a)return a.firstChild}return null}llg(a,
b){if(!a&&!b)return!1;if(!a||!b)return!0;try{return this.Tsj(a,b)}catch(c){return Z.ULS.sendTraceTag(17134560,324,15,"HasDifferentHtmlStructure ex: {0}",c),!0}}Tsj(a,b){if(Ka.a.wg(a.nodeName)!==Ka.a.wg(b.nodeName))return!0;if(a.childNodes.length!==b.childNodes.length&&(!r.a.eg||a.childNodes.length!==b.childNodes.length-1||"BR"!==Ka.a.rB(b.childNodes[b.childNodes.length-1].nodeName))){var c=!a.childNodes.length||3===a.childNodes[0].nodeType;for(var f=0;c&&f<b.childNodes.length;f++)c=3===b.childNodes[f].nodeType&&
c;if(c)return!1;c=b.childNodes.length;for(f=0;f<b.childNodes.length;f++)3!==b.childNodes[f].nodeType||b.childNodes[f].nodeValue.length||c--;return c!==a.childNodes.length}for(c=0;c<a.childNodes.length;c++)if((!pf.yUc(a.childNodes[c])||!pf.yUc(b.childNodes[c]))&&this.llg(a.childNodes[c],b.childNodes[c]))return!0;return!1}VUi(a,b){if(r.a.rI&&H.a.instance.ga(98)){b.Tb("PossiblyIncorrectTypedText",{["Reason"]:"FixEOPSpanforAndroidChrome"});b=ya.a.$ba(this.xvd,"EOP");const c=ya.a.$ba(a.firstChild,"EOP");
b&&!c&&a.firstChild&&a.firstChild.appendChild(b.cloneNode(!0))}}}Object(e.a)($d,"ContentEditableHtmlStructureUtils",null,[]);class Ye{constructor(){this.PSh=u.AFrameworkApplication.fa.ka("MoveToIpModeInReadOnlyView")}get mode(){return u.AFrameworkApplication.Ta.mode}get C7c(){return this.PSh}get prh(){return this.C7c?!0:1!==u.AFrameworkApplication.Ta.mode||Cb.App.xwb&&u.AFrameworkApplication.WS}get V_h(){switch(this.mode){case 3:return Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage;
case 2:return Box4Intl.Box4Strings.l_ReviewingSurfaceScreenReaderTitleMessage}return Box4Intl.Box4Strings.l_ReadingSurfaceScreenReaderTitleMessage}get Q9d(){return this.C7c?1===u.AFrameworkApplication.Ta.mode||Cb.App.xwb&&u.AFrameworkApplication.WS:Cb.App.xwb&&u.AFrameworkApplication.WS?!(Cb.App.KVb||Cb.App.Q5b):1===u.AFrameworkApplication.Ta.mode}get hjd(){return this.C7c?1===u.AFrameworkApplication.Ta.mode||Cb.App.xwb&&u.AFrameworkApplication.WS:Cb.App.xwb&&u.AFrameworkApplication.WS}}Object(e.a)(Ye,
"ContentEditableModeHelper",null,[1387]);var Kd=d(189),Yd=d(33);class Zf{static Bxi(a){const b={};for(let c of a)a=0,c in b&&(a=b[c]),b[c]=a+1;return Yd.c(b)}}Object(e.a)(Zf,"CommonActivityAggregationMethods",null,[]);var ef=d(989),Ke=d(1001),gi=d(566),Rf=d(285),Uf=d(265),Ed=d(90);class vg{constructor(){this.OLd=this.hEg=this.pKf=this.TIc=this.Sea=this.Eue=this.sdb=this.PGb=this.gYa=this.sJd=this.USe=this.VSe=this.PB=this.B5a=this.MB=this.cZb=this.lXb=this.zSd=this.agc=this.fZb=this.MBa=this.NBa=
this.iib=this.SWb=this.GPd=this.TWb=this.R9a=this.tEa=this.Lz=null;this.j6=this.iqd=this.ktd=this.dDd=this.Wvd=this.tFd=this.csd=!1}vOi(a,b){if(!this.j6){this.j6=!0;var c=gi.a.instance,f=b.TF,l=b.jR,x=b.oib,G=b.my,R=Rf.a.instance,fa=b.wfa,wa=Uf.a.instance,Wa=b.Lld,mb=b.Ild;r.a.Ki&&(zd.EventHandlerManager.instance.UNk(this.sJd),this.iqd=!0);b.uha(this.Sea);this.aNk(a.Hn,f,l,G,x,wa,fa,R,c,Wa,mb)}}wul(a,b){if(this.j6){var c=gi.a.instance,f=b.TF,l=b.jR,x=b.oib,G=b.my,R=Rf.a.instance,fa=b.wfa,wa=Uf.a.instance,
Wa=b.Lld,mb=b.Ild;this.iqd&&(zd.EventHandlerManager.instance.Aul(this.sJd),this.iqd=!1);b.IXa(this.Sea);this.tul(a.Hn,f,l,G,x,wa,fa,R,c,Wa,mb);this.j6=!1}}aNk(a,b,c,f,l,x,G,R,fa,wa,Wa){b.zp(a);c.zp(a);f.zp(a);l.zp(a);x.zp(a);Ed.a.addHandler(a,ma.a.paste,this.agc);Ed.a.addHandler(a,ma.a.cut,this.zSd);Ed.a.addHandler(a,ma.a.copy,this.lXb);!vg.lOj&&r.a.eg&&(Ed.a.addHandler(a,ma.a.vUd,this.cZb),this.ktd=!0);Ed.a.addHandler(a,ma.a.blur,this.OLd);f.ob(ma.a.click,a,this.MB);2===Cb.App.mode?G.nJ(a,this.TIc,
!0):G.nJ(a,this.TIc);R.ob(a,this.PB);l.ob(ma.a.G5,a,this.VSe);l.ob(ma.a.Q0,a,this.USe);c.ob(ma.a.mouseDown,a,this.sdb,null);c.ob(ma.a.dJ,a,this.Eue,null);b.ob(ma.a.wl,a,this.tEa);b.ob(ma.a.Qx,a,this.R9a);b.ob(ma.a.Xf,a,this.Lz);b.ob(ma.a.bOa,a,this.Lz);f.ob(ma.a.doubleClick,a,this.B5a);Ed.a.addHandler(a,ma.a.scroll,this.gYa);if(r.a.BQe||r.a.eg)Wa.ob(ma.a.SRf,a,this.TWb,this),Wa.ob(ma.a.FPd,a,this.GPd,this),Wa.ob(ma.a.DPd,a,this.SWb,this),this.csd=!0;Cb.App.XLd&&r.a.hwh||r.a.io?(wa.ob(ma.a.input,a,
this.iib,this),this.Wvd=!0):r.a.FQe&&(wa.ob(ma.a.TRe,a,this.iib,this),this.tFd=!0);fa.ob(ma.a.drop,a,this.NBa);r.a.dta&&(fa.ob(ma.a.C5a,a,this.MBa),fa.ob(ma.a.x_f,a,this.fZb),this.dDd=!0);fa.ob(ma.a.OGb,a,this.PGb)}tul(a,b,c,f,l,x,G,R,fa,wa,Wa){Ed.a.removeHandler(a,ma.a.paste,this.agc);Ed.a.removeHandler(a,ma.a.cut,this.zSd);Ed.a.removeHandler(a,ma.a.copy,this.lXb);this.ktd&&(Ed.a.removeHandler(a,ma.a.vUd,this.cZb),this.ktd=!1);Ed.a.removeHandler(a,ma.a.blur,this.OLd);f.xb(ma.a.click,a,this.MB);G.yE(a,
this.TIc);R.xb(a,this.PB);l.xb(ma.a.G5,a,this.VSe);l.xb(ma.a.Q0,a,this.USe);c.xb(ma.a.mouseDown,a,this.sdb);c.xb(ma.a.dJ,a,this.Eue);b.Oq(a);c.Oq(a);f.Oq(a);l.Oq(a);x.Oq(a);b.xb(ma.a.wl,a,this.tEa);b.xb(ma.a.Qx,a,this.R9a);b.xb(ma.a.Xf,a,this.Lz);b.xb(ma.a.bOa,a,this.Lz);f.xb(ma.a.doubleClick,a,this.B5a);Ed.a.removeHandler(a,ma.a.scroll,this.gYa);this.csd&&(Wa.xb(ma.a.SRf,a,this.TWb),Wa.xb(ma.a.FPd,a,this.GPd),Wa.xb(ma.a.DPd,a,this.SWb),this.csd=!1);this.tFd&&(wa.xb(ma.a.TRe,a,this.iib),this.tFd=
!1);this.Wvd&&(wa.xb(ma.a.input,a,this.iib),this.Wvd=!1);fa.xb(ma.a.drop,a,this.NBa);this.dDd&&(fa.xb(ma.a.C5a,a,this.MBa),fa.xb(ma.a.x_f,a,this.fZb),this.dDd=!1);fa.xb(ma.a.OGb,a,this.PGb)}static get lOj(){null==vg.kxd&&(vg.kxd=u.AFrameworkApplication.fa.ka("RemoveDomSubtreeModifiedEventHandlerIsEnabled"));return vg.kxd}}vg.kxd=null;Object(e.a)(vg,"ContentEditableSurfaceEventHandlers",null,[]);var Jd=d(60),Ie=d(117),gf=d(817),eh=d(137),rg=d(256);class Cg extends Ke.a{constructor(a,b,c,f,l,x,G,R,
fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg,Sf,uh,Sg,li,Ui,Cj,jj,kj){super(jj);this.yxc=null;this.fJc=this.rsb=this.yYb=this.mU=!1;this.If=a;this.Qc=b;this.Ek=c;this.xt=G.create(this);this.pkb=Mg;this.jd=R;this.qoa=kj;x.ya(E.a.GYf,Bb.a.application,Kd.ActionManager.Hg);x.ya(E.a.HYf,Bb.a.application,Kd.ActionManager.Hg);f.execute(Gi=>{Gi.qFi(E.a.typing,Dd.a.u6g);Gi.hKe(E.a.typing,Dd.a.source,Zf.Bxi)});l&&l.execute(Gi=>{Gi.fGl(Object(C.a)(this,this.Wva,"onZoomChanged"))});this.pp=wa;this.yoa=
Hc;this.DDd=Kb;this.SJ=Wa;this.gK=nc;this.gK.init(this.Ma);this.s1=oc;this.kf=Ic;this.Dk=mb;this.Lb=fa;this.Lb.init(this.Ma);this.xh=ie;this.P1a=He;this.Ds=Kc;this.HMa=fe;this.AH=Qf;this.Rr=Te;this.CB=mg;this.QLa=We;this.hV=Xg;this.ALh=Sf;this.BLh=uh;this.VMh=Sg;this.zLh=li;this.wga=Ui;this.yLh=Cj;this.wga.O5h(Object(C.a)(this,this.nZg,"onBindEditingDom"));this.wga.f6h(Object(C.a)(this,this.t3g,"onUnbindEditingDom"));this.wga.w5h(Object(C.a)(this,this.i$g,"pushViewElementValidationStates"));this.wga.v5h(Object(C.a)(this,
this.n0g,"onInteractiveViewOnAfterLoadContent"));this.k_e=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ChromiumEdgeUIPasteForPPTIsEnabled")&&r.a.hTc;this.d3e=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")&&r.a.QS}get Fd(){return this.Ef.Fd}dispose(){this.wga.wRk(Object(C.a)(this,this.nZg,"onBindEditingDom"));this.wga.IRk(Object(C.a)(this,this.t3g,"onUnbindEditingDom"));this.wga.pRk(Object(C.a)(this,this.i$g,"pushViewElementValidationStates"));
this.wga.oRk(Object(C.a)(this,this.n0g,"onInteractiveViewOnAfterLoadContent"));this.zLh.dispose();super.dispose()}Wva(){this.gfa=!0}get ownerDocument(){const a=this.jd.CCa();return a?a.Il:null}get container(){return this.CPa}get ZPd(){return this.Hn}createElement(a){a=this.ownerDocument.createElement(a);this.jd.yg.FGh.appendChild(a);return a}Wo(a){a=Fb.a.createElement(this.ownerDocument,a);this.jd.yg.FGh.appendChild(a);return a}LAa(){throw Error.notImplemented("BindToContainer doesnt mean anything for ContentEditableView yet--we shouldn't be calling it!");
}xwe(){this.pp.raiseEvent(qe.a.NLi);this.fJc=!0}get CPa(){return this.jd.yg?this.jd.yg.du:null}get Hn(){return this.jd.fm()}get Yvb(){return!0}Bpi(){this.s1.REc()}get qVc(){return this.Rr.kEa}get isComposing(){return this.Rr.isComposing}JBk(){this.k_e||this.d3e?this.HMa.t8g(!0,""):(this.disable(!1,24),this.phd(!0),r.a.Vw&&(this.CPa.style.overflow="hidden"),this.CPa.style.width="0px",this.CPa.style.height="0px",this.CPa.style.display="block",this.pp.raiseEvent(qe.a.bwk),this.s1.REc(),this.gK.MIa(this.xh.mode,
this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My))}Mml(){this.k_e||this.d3e?this.HMa.iih("none"):r.a.Vw&&this.CPa&&(this.CPa.style.overflow="none")}Cs(a,b=!1){this.AH.Cs(a,b)}lY(){this.Ds.lY()}get Kl(){return!0}Afa(a,b){if(1===this.mode&&17!==a.oi){const c=a.currentNode;if(!qd.a.instance.Oa.MG&&!c.swb(qd.a.instance.Oa.Ir)&&6!==a.role)return!1}return super.Afa(a,b)}get oF(){let a=super.oF;switch(this.mode){case 2:a|=450;break;case 1:a|=448;break;case 0:a|=511}return a}get Zqb(){const a=
u.AFrameworkApplication.fa.ka("EditingViewDelayUpdateFixIsEnabled");return a&&!this.qVc?2:this.root&&this.ownerDocument&&this.isActive&&!this.yoa.n8?a||this.qVc?1:2:3}yX(a){return this.BLh.yX(a)}d0(a){return this.ALh.d0(a)}XRd(){return new gf.a(this.Ma)}Cwe(a){!u.AFrameworkApplication.Vg&&0!==this.mode&&this.Ef&&this.Ef.ho&&(this.DYj(a),this.Qc.m9d())}DYj(a){if(a){var b=a.xA;a=this.F8f(a.Eu,!0);b=this.F8f(b,!1);Z.ULS.sendTraceTag(38396191,324,50,"Parent : [{0}] Child : [{1}]",a,b)}}F8f(a,b){let c=
"";a&&(a=a.node)&&(c+="nodeId : "+a.id+"; type : "+a.type+"; ",yb.ParagraphReader.Vd(a)&&(c+="paraId : "+yb.ParagraphReader.f1b(a)+"; ",c+="hasImage : "+Ie.a(a,5)+";"),b&&(b=nb.GraphIterator.mb(a),b.af(),c+="inTable : "+Jd.TableReader.hs(b)+";"));return c}Rxe(a){!u.AFrameworkApplication.Vg&&1===this.mode&&a&1&&this.Ef&&this.Ef.ho&&this.Qc.Dye()}phd(a){this.jd.wYa(a)}W9a(a,b,c){this.pkb.W9a(a,b,c)}DJc(){this.QLa.DJc()}k7k(){this.DDd.z3f(qd.a.instance.Oa)}ngb(){this.gK.ngb(this.mode,this.Lb.Fi,this.Lb.Ag,
this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My)}MIa(){this.gK.MIa(this.mode,this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My)}get Ag(){return this.isActive?this.Lb.Ag:null}get mode(){return this.xh.mode}get isActive(){return this.kf.isActive}get oSa(){return this.kf.W0b(this.Lb.Ag)}get Zbe(){return this.kf.icg(this.Lb.Ag)}get Ef(){return this.If.Nd}get oze(){return this.P1a.NSf}get jxa(){return this.QLa.jxa}set jxa(a){this.QLa.jxa=a}get gfa(){return this.Ds.gfa}set gfa(a){this.Ds.gfa=
a}get K$d(){return!0}get HGe(){return 2}get hjd(){const a=this.Ek.value.isEditingAllowed||this.Ek.value.My;return this.qoa.hjd?a:!0}get NHa(){return this.HMa.NHa}get Bqb(){return this.Dk}get xtl(){return this.CB}get Hvi(){return this.pkb}get bxj(){return this.QLa}get Utk(){return this.hV}d7b(a){return rg.a.ACg(a,this)}VFb(a){return rg.a.igh(a,this)}Fjc(a){return rg.a.wgh(a,this)}sdc(a){return rg.a.PUg(a,this)}Fpb(a){return rg.a.dNf(a,this)}Fkc(a){return rg.a.rlh(a,this)}K_b(a){return rg.a.u6f(a,this)}UUb(a){return rg.a.BJf(a,
this)}xHj(){switch(this.mode){case 2:if(this.Lb.Ag)return this.yHj(this.Lb.Ag)}return!1}yHj(a){a=eh.a.mb(this.Ma,a.node);return a.Mq&&a.af()?a.ePa.vX(510&~this.oF):!0}nZg(a,b){this.fKf(b.yg)}t3g(){this.jd.Ktl()}Azj(a,b,c,f){a=this.yLh.create(a,b,this.qoa);b=new vg;b.TIc=c;this.VMh.qyk(b);a.initialize(b,f);return a}fKf(a){this.jd.gei(a,this)}disable(a,b){this.xh.v$(0,a,b)}uZa(){this.xh.uZa()}suspend(){this.yoa.suspend()}resume(){this.yoa.resume()}i$g(a,b){this.If.Nd===b.Ef&&(this.yxc=this.AKa,this.AKa=
new ef.a(0))}hyk(){const a=this.yxc,b=this.AKa;for(let c=0;c<b.keys.length;++c){const f=b.keys.ga(c);let l;a.$(l=f,a.ga(l)|b.ga(f))}this.AKa=a;this.yxc=null}fQf(){this.yxc=null}ENe(a){return 1!==this.mode||a.hy||this.Ef.Gb.Oa.MG?!1:!0}Yce(a,b){return this.Ef.Gb&&!this.Ef.Gb.Oa.MG&&b?a.hy!==b.vce:!0}n0g(a,b){this.If.Nd===b.Ef?this.hyk():this.If.Nd||this.fQf()}}Object(e.a)(Cg,"ContentEditableView",Ke.a,[352,201,106,1438]);class kh{constructor(a,b,c,f,l,x){this.hd=a;this.$f=b;this.fj=c;this.Oo=f;this.If=
l;this.ir=x}nug(a){return Sys.UI.DomElement.containsCssClass(a,hc.a.zSf)}}Object(e.a)(kh,"ContentEditableViewContentControlHelper",null,[1386]);var De=d(390),Nd=d(127),Od=d(116),mj=d(818);class qi{constructor(a,b,c,f,l){this.QWb=!1;this.rze=this.Y$c=-1;this.aF=a;this.e9d=b;this.fDc=c;this.nRa=f;this.YWa=l}}Object(e.a)(qi,"ActiveContentSpan",null,[]);class Vf{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We){this.jga=this.kNb=null;this.r8=!1;this.Txf=0;this.zsd=fe;this.If=a;
this.hd=b;this.$f=c;this.fj=f;this.Qc=l;this.ef=x;this.VJ=G;this.xh=R;this.Lb=fa;this.Ek=wa;this.doa=Wa;this.kf=mb;this.Rd=Kb;this.rd=nc;this.Pi=oc;this.Oo=Ic;this.Ch=Kc;this.SJ=Hc;this.jd=ie;this.ZC=He;this.pA=We}get Xba(){return this.jga||(this.jga=fb.a.instance.qb("Box4.IFormatPainter"))}hei(a){this.kNb=a}get Wuh(){return this.Txf}WEi(a,b,c){const f=this.If.Nd;if(!f)return!1;f.xxe();if(2!==this.xh.mode)return this.hd.Tb("PossibleFocusWeirdness",{["Reason"]:"ClickOnHiddenEditingFrame"}),this.$f.be++,
!1;if(this.fj&&b)return this.hd.Tb("DisallowedClickDuringDictation",{["Reason"]:"CursorPositioningClick"}),this.$f.bf++,!0;if(3!==a.Wf&&a.dA===Sys.UI.MouseButton.rightButton&&this.rd.eg)return Cb.App.Hb.I$.FUi(a.mc.rawEvent),!0;if(!f)return!1;b=f.Hia(a);if(3===a.Wf){var l=this.Qc.Oa.kb;if(this.ef.Uw(l)){var x=l.Ua.node.sg(f.Ma);l=this.pA?this.pA.KOa(l.Ua,!0):l.Ua.Qa;x=O.a.kZ(l,x,!!l,!1,!1);x=new Sys.UI.Bounds(x.x-7,x.y,14,x.height);if(De.a.Zad(b,x))return Cb.App.Hb.p5(b,3),!0}}if(!c)return!0;this.Pi.wXf(this.xh,
this.Lb);v.FocusManager.mM()&&(v.FocusManager.instance().Bf(f.eI),this.SJ.setFocus(this.xh.mode,this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My));(c=Qc.a(a.Ac))?(this.kNb.Cs(!0),f.J5(a.clientPoint,c,c.$a,f,a.mc.rawEvent.shiftKey,a.rZ,a.Wf)):f.J5(b,null,null,f,a.shiftKey,a.rZ,a.Wf);this.Xba&&this.Xba.TK&&this.doa.processAction(E.a.Cia,2);this.kNb.W9a(a.shiftKey,b,a.Wf);f.Uwe(new mj.a(a));this.rd.rI&&(a=new xe.a(0,1,0,()=>{this.kf.ZIa(!0);this.fixupAfterCursor(5)},
27),this.Rd.Cb(a));return!0}XQe(a,b=!1){if(2===this.xh.mode&&this.Lb.Rh){var c=this.jd.yg.du;if("0px"!==c.style.height&&"0px"!==c.style.width||!this.rd.Sbe){c=this.Qc.Oa.kb;var f=!!this.VJ&&this.VJ.q8a();this.fj&&a?(this.hd.Tb("MomentaryIncorrectIpPosition",{["Reason"]:"NoSynchronizeCursorDuringDictation"}),this.$f.bm++):(this.y3k(b||f,this.Lb.Rh.Ts,this.Qc.Oa.kb.Ua),f&&this.VJ.oRe(c))}}}y3k(a,b,c){let f=0,l=0;c=c.Qa;let x=!1;for(let G=0;G<b.length;G++){const R=b[G],fa=this.Oo.lI(R,this.$f,this.hd,
this.fj);if(Sys.UI.DomElement.containsCssClass(R,X.a.yV))f+=fa;else if(x||(this.Txf=f,x=!0),Sys.UI.DomElement.containsCssClass(R,hc.a.MM))c--,f+=fa,l++;else{if(c<=fa){a||this.Pi.uS(f+c,this.Lb.Rh);this.hhd(b,G,f,l,c);break}c-=fa;f+=fa;l+=fa}}}fixupAfterCursor(){if(2===this.xh.mode){var a=this.Pi.z7(this.xh.mode,this.Lb.Fi),b=0,c=0,f=this.Lb.Rh.Ts,l;for(l=0;l<f.length;l++){const x=this.Oo.lI(f[l],this.$f,this.hd,this.fj);let G,R,fa;({f3:G,Bja:fa,Hvb:R}=this.Umi(f,l));if(a<=x&&this.hVi(f,l,a,G,fa,b,
c,R))return;a-=x;b+=x;G?c++:R||(c+=x)}this.hd.Tb("ActiveContentSpansOutOfSync",{["Reason"]:"FixupAfterCursorFailed"});this.$f.bq++}}hVi(a,b,c,f,l,x,G,R){const fa=a[b],wa=this.Oo.lI(fa,this.$f,this.hd,this.fj);if(f||this.fj&&l)if(l||!this.r8&&c!==wa){if(this.$f.bo++,this.Pi.uS(x,this.Lb.Rh),c=this.Oo.lI(a[b-1],this.$f,this.hd,this.fj),this.hhd(a,b-1,x-c,G-c,c),l)return!0}else this.$f.bn++,this.Pi.uS(x+wa,this.Lb.Rh),this.hhd(a,b+1,x+wa,G+1,0);else if(!R)return Ka.a.Xw(ya.a.fv(fa),c)&&(this.$f.bp++,
this.Pi.uS(x+c+(this.r8?1:-1),this.Lb.Rh)),this.hhd(a,b,x,G,c),!0;return!1}Umi(a,b){let c,f;c=Sys.UI.DomElement.containsCssClass(a[b],hc.a.MM);f=Sys.UI.DomElement.containsCssClass(a[b],X.a.yV);a=Sys.UI.DomElement.containsCssClass(a[b],hc.a.aN);return{f3:c,Bja:a,Hvb:f}}hhd(a,b,c,f,l){const x=this.Lb.NV,G=a[b];Sys.UI.DomElement.containsCssClass(G,hc.a.aN)&&(Z.ULS.shipAssertTag(4318915,315,!1),this.hd.Tb(Nd.a.T0,{["Reason"]:Od.a.i2f}));Sys.UI.DomElement.containsCssClass(G,hc.a.MM)&&(Z.ULS.shipAssertTag(4318916,
315,!1),this.hd.Tb(Nd.a.T0,{["Reason"]:Od.a.jKf}));a=this.XAi(a,b,c,f,l,x);b=a.length!==this.Ch.Bi.length;for(c=0;!b&&c<this.Ch.Bi.length;)this.Ch.Bi[c].aF!==a[c].aF&&(b=!0),this.Ch.Bi[c].YWa!==a[c].YWa&&(b=!0),c++;b&&(this.kNb.oSa&&this.kNb.Cs(!0),this.Ch.Bi=a)}XAi(a,b,c,f,l,x){const G=a[b];var R=this.Oo.lI(G,this.$f,this.hd,this.fj);const fa=[];let wa=null;b<a.length-1&&l===R&&(wa=a[b+1]);var Wa=null;0<b&&!l&&(Wa=a[b-1]);a=this.zsd.te(G,X.a.xEa);a=x.Ts[a];Array.add(fa,new qi(G,a,c,f,R-(this.ZC.y6?
1:0)));!wa||Sys.UI.DomElement.containsCssClass(wa,hc.a.aN)||Sys.UI.DomElement.containsCssClass(wa,hc.a.MM)?!Wa||Sys.UI.DomElement.containsCssClass(Wa,hc.a.aN)||Sys.UI.DomElement.containsCssClass(Wa,hc.a.MM)||Sys.UI.DomElement.containsCssClass(Wa,X.a.yV)||(a=this.zsd.te(Wa,X.a.xEa),a=x.Ts[a],R=this.Oo.lI(Wa,this.$f,this.hd,this.fj),Array.insert(fa,0,new qi(Wa,a,c-R,f-R,R))):(a=this.zsd.te(wa,X.a.xEa),a=x.Ts[a],Wa=this.Oo.lI(wa,this.$f,this.hd,this.fj),Array.add(fa,new qi(wa,a,c+R,f+R,Wa)));return fa}}
Object(e.a)(Vf,"ContentEditableViewCursorManager",null,[1436]);class Ai{}Object(e.a)(Ai,"ContentEditableViewDebugLogger",null,[]);class $g{constructor(a,b,c,f,l,x,G){this.Yoa=a;this.CB=b;this.Ch=c;this.Tsc=f;this.$f=l;this.iaa=x;this.xh=G}dispose(){this.Yoa.SPf();this.CB.dispose();this.Ch.EPf();this.Tsc.Vgd();yg.a.instance.CXj(this.$f);this.iaa.raiseEvent(Qe.a.XYj);this.xh.dispose()}}Object(e.a)($g,"ContentEditableViewDisposer",null,[]);class Ch{constructor(){this.pIc=!0}W9a(a,b,c){a&&(this.pIc=!1,
Cb.App.Hb.p5(b,c))}}Object(e.a)(Ch,"ContentEditableViewFloatieHandler",null,[1434]);var nf=d(1078),qf=d(142);class Wi{constructor(a,b,c,f,l,x,G){this.pef=0;this.sUc=this.L3b=this.y7d=this.C7d=!1;this.jd=a;this.If=b;this.VJ=c;this.fj=f;this.zn=l;this.brd=x;this.Kd=G}Bei(){this.fj&&!this.L3b&&100<(new Date).getTime()-this.pef&&(qf.GrippersManager.instance.j3b=!0,this.sUc=!1)}setFocus(a,b,c,f,l){const x=this.If.Nd;this.pef=(new Date).getTime();this.VJ&&this.VJ.q8a()||(1===a?this.n4k(l):this.fj&&!this.zn.E7d&&
zd.EventHandlerManager.instance.t2f!==ma.a.click||!this.jd.yg.lhb||(l=new nf.a(x),this.jd.yg.Lmd(),this.fj&&(this.L3b=!0,this.jd.fm().blur(),this.L3b=!1),this.jd.yg.mAh(),c&&f&&""!==b.innerText&&b.focus(),this.brd.j8&&(this.sUc=!0),l&&l.dispose(),this.brd.Aj&&0!==a&&(this.jd.yg.lhb=!1)))}n4k(a){if(!this.fj||a){a=null;r.a.Aj&&(a=new nf.a(this.If.Nd));this.jd.yg.lhb&&(this.jd.yg.Lmd(),this.jd.yg.mAh(),r.a.Aj&&(this.jd.yg.lhb=!1),this.brd.j8&&this.zn.E7d&&(this.sUc=!0));var b=this.jd.fm();this.jd.yg.lhb&&
b.firstChild&&3!==b.firstChild.nodeType&&b.firstChild.focus();a&&a.dispose()}}JNi(a){2!==a&&1!==a||this.jd.yg.Lmd()}fae(){const a=this.Kd.ze;return!!a&&this.If.Nd.eI===a.name}}Object(e.a)(Wi,"ContentEditableViewFocusHelper",null,[1433]);class Tg{constructor(a,b,c){this.v3b=a;this.Peb=b;this.uqa=c}}Object(e.a)(Tg,"GraphUpdateState",null,[]);var rd=d(50),ze=d(114);class xh{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg,Sf,uh,Sg,li){this.Se=this.SMb=null;this.rk=
Sg;this.ir=uh;this.cga=a;this.xh=b;this.hd=c;this.Qc=f;this.VJ=l;this.ef=x;this.kf=G;this.YJ=R;this.Lb=fa;this.Dk=wa;this.ZC=Wa;this.Ch=mb;this.jd=Kb;this.QU=nc;this.sR=oc;this.yoa=Ic;this.JY=Kc;this.Vga=ie;this.Pi=He;this.P1a=fe;this.Ds=Te;this.$f=We;this.k6=Qf;this.Rd=mg;this.rd=Xg;this.uga=Mg;this.TIh=Sf;this.Yg=Hc;this.yz=li}fS(a){this.Se=a}get ZPc(){const a=this.JY.Yra(this.QU.r8);return a?a.Ua.Qa:0}get hfi(){return this.ZPc}Cs(a,b=!1){Z.ULS.shipAssertTag(18437283,315,!!this.Yg);if(this.Se.oSa||
this.Se.Zbe)if(this.Se.xtl.typingProcess(),this.Se.isActive&&2===this.xh.mode&&(this.Se.oSa||this.Se.Zbe)){var c=this.hd.Kp(E.a.Cs);this.cga.LF(()=>{this.Hwl(a,b)},"ContentEditableView:UpdateGraphInternal");c.end()}}z4k(a,b=!1){const c=this.ef.pz;this.Qc.setSelection(a,void 0,void 0,b);this.ef.pz=c}Hwl(a,b=!1){ze.c(36226527,306,100,"UpdateGraphInternalCalled");this.kf.DVk();if(this.Lb.Rh){a=new Tg(!1,a,!1);a.Peb&&this.yoa.suspend();this.Vga.fixupAfterMagnifierDrag();var c=this.YJ.OQa();c.set(this.Lb.Ag.node);
var f=this.rk.ke(b?12:15,E.a.Cs);f.fd=this.Dk.b2?E.a.KAa:E.a.typing;f.iy(c);this.ZC.kbl(a.Peb,this.Se.qVc,this.Ch)&&(this.$f.v++,this.ZC.Pgb(!1,this.Lb.Fi,this.Ch));var l=!!this.VJ&&this.VJ.q8a(),x=l?qd.a.instance.Oa.kb:this.Goi();this.hxk(a);this.Dxl();this.rerenderWhenNeeded(b,a,c);l||this.sVi(b,x);this.Ch.EPf();f.dispose();this.gll(a);this.Ds.gfa&&(this.Ds.lY(),this.Ds.gfa=!1);a.Peb&&this.yoa.resume();this.Dk.b5();ze.c(18437313,306,100,"UpdateGraphInternalExited")}else Z.ULS.shipAssertTag(17884510,
315,!1,"CurrentEditingViewElement is NULL. Bail out updateGraph early!")}gll(a){a.v3b||this.QU.XQe(this.Dk.Fca,a.uqa)}rerenderWhenNeeded(a,b,c){!b.v3b||this.Dk.mAg()||a||(this.xh.v$(0,!0,5),b.Peb&&(this.yoa.resume(),b.Peb=!1),this.l4b(c.currentNode))}Goi(){this.Pi.updateCaretPosition(this.xh.mode,this.Lb.Fi);this.P1a.wVe();this.sR.VUi(this.jd.fm(),this.hd);return this.JY.Yra(this.QU.r8)}sVi(a,b){const c=this.ir.textLength(b.Ua.node);b.Ua.Qa>c&&(b=rd.SelectionFactory.Mg(b.Ua.node,c));this.z4k(b,a);
a=!!this.VJ&&this.VJ.Uvb(b);this.Dk.mAg()&&!a&&this.Pi.uS(this.Pi.iTa,this.Lb.Rh)}l4b(a){H.a.instance.ga(70)&&Cb.App.kR.l4b(a)}Dxl(){if(H.a.instance.ga(2)){const a=Xb.OutlineElementNavigator.EA(this.Se.Ag);a&&Ib.ListReader.zSa(a)}}bTd(){if(this.Se.oSa||this.Se.Zbe)this.SMb?this.Rd.a5(this.SMb,xh.xXf):(this.SMb=new xe.a(0,1,xh.xXf,Object(C.a)(this,this.delayUpdateGraphCallback,"delayUpdateGraphCallback"),26),this.Rd.Cb(this.SMb))}delayUpdateGraphCallback(){this.SMb=null;this.Lb.eTa(this.xh.mode)&&
this.Cs(!0)}LQk(){let a;if(this.Dk.b2){var b=this.ZPc;a=this.Dk.mGc}else if(this.Dk.Vqa)b=this.ZPc,a=b+(this.Dk.Fld-ya.a.fv(this.Lb.$Oa).length);else return;if(b===a)this.hd.Tb("PossibleDropACharDeletion",{["Reason"]:"LostBrowserSelection"});else{Z.ULS.shipAssertTag(18437315,315,b<=a);var c=this.ir.text(this.Se.Ag),f="";this.ir.EQa(this.Se.Ag,a);if(!b&&a<c.length&&" "===c.charAt(a)||0<b&&a<c.length&&" "===c.charAt(b-1)&&" "===c.charAt(a))a+=1,f+=Za.WDb;this.xpi(this.Se.Ag);b=Mc.a.createTextRange(this.Se.Ag,
b,a);this.Yg.replaceTextRange(b,f,void 0,void 0,E.a.yLd)}}xpi(a){H.a.instance.ga(70)&&this.yz.OEc(a)}hxk(a){let b=!0;if(this.k6.Qng)this.k6.XMi();else{const c=1<this.jd.fm().childNodes.length;a.v3b=this.sR.qnd();if(a.v3b||this.Dk.Vqa||this.Dk.b2){a.v3b&&this.$f.w++;c&&(this.hd.Tb("PossibleValidTextDropped",{["Reason"]:"ExtraParagraphsFound"}),this.$f.x++,b=!1);if(this.Dk.b2||this.Dk.Vqa)this.LQk(),this.sR.Qjc(),b=!1;a.Peb&&(this.hd.Tb("PossibleImeAutoDetermine",{["Reason"]:"StopPreseveringBrowserState"}),
this.$f.z++,this.yoa.resume(),a.Peb=!1);this.Ch.Foi(this.Lb.Rh)}}a.uqa=!0;b&&(a.uqa=this.TIh.gxk(this.Lb.Ag,this.Lb.Fi,this.Lb.Rh,this.Yg,this.uga.instance))}}xh.xXf=250;Object(e.a)(xh,"ContentEditableViewGraphUpdater",null,[]);class Qj{constructor(){this.tcl=this.Ovg=!1;this.G5g=null}}Object(e.a)(Qj,"OnPastedFloatieStatusChangeEventArgs",null,[]);var ae=d(56);class nj{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg,Sf){this.Se=null;this.EBg=0;this.Bff=!1;this.Pa=
a;this.xh=b;this.Lb=c;this.If=f;this.jd=l;this.Zfa=x;this.Ds=G;this.ZC=fa;this.rd=wa;this.$f=Wa;this.ir=mb;this.Ch=Kb;this.sR=nc;this.uFd=oc;this.Yoa=Ic;this.SJ=Kc;this.P1a=Hc;this.Qc=ie;this.fj=He;this.gK=fe;this.Ek=Te;this.Dk=We;this.pp=Qf;this.YJ=mg;this.nNa=Xg;this.cpa=Mg;this.Yc=Sf}fS(a){this.Se=a}yjk(a){this.Pa.raiseEvent(gd.eventId,new gd(a.lM,this.Se.mU),this.Se);if(1===this.xh.mode)return this.zjk(a);if(0===this.xh.mode||!this.nwl(a))return!1;this.ZC.TPf();if(this.mwl())return!0;this.oVi();
this.Yoa.hvh(this.Lb.Rh);this.mVi();!this.Bff&&this.Lb.Rh&&0<this.Lb.Rh.Ukd&&(this.Bff=!0,u.AFrameworkApplication.DN("Microsoft.Office.Web.SessionSettings.IWacWordEditorInlineTabsSettings"));this.Yc&&this.Yc.isFeatureEnabled(84)&&this.pgh(this.Lb.Rh);this.P1a.wVe();this.cpa.nEe(Object.assign(new Qj,{tcl:!0}));this.Yc&&this.Yc.isFeatureEnabled(84)||this.pgh(this.Lb.Rh);return!0}pgh(a){a&&a.Ukd&&(this.nNa?this.nNa.nGl(a,!0):Z.ULS.sendTraceTag(23708818,323,10,"TabRenderer is null."))}nwl(a){if(!this.Lb.Ag)return!1;
this.Lb.Rh=this.Lb.Ag.oc(this.Se.Ma);this.Lb.Rh||Z.ULS.sendTraceTag(18437322,324,15,"current editing view element is set to null!");this.Lb.NV=this.Lb.Ag.oc(this.If.Nd.Ma);if(!this.Lb.NV)return!1;this.jd.yg.Mve(this.Lb.NV);const b=this.jd.fm(),c=this.Lb.$Oa;(b?b.firstChild:null)!==c&&c&&(ya.a.ku(b),b.appendChild(c));if(!a.lM&&!this.Se.fJc){this.Se.mU&&this.Zfa.XQe(this.Dk.Fca);this.Se.mU=!1;if(this.Ds.gfa||!a.GHa)this.Ds.lY(),this.Ds.gfa=!1;return!1}this.Se.fJc&&(this.Se.fJc=!1,this.Se.rsb=!0);return!0}mVi(){this.Ds.lY();
if(this.Se.rsb){this.SJ.setFocus(this.xh.mode,this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My);if(this.rd.eg){const a=this.jd.fm(),b=a?a.firstChild:null;b&&3===b.nodeType&&(this.$f.bv++,a.removeChild(b))}this.Se.rsb=!1}this.Zfa.XQe(this.Dk.Fca)}oVi(){if(this.rd.eg){var a=this.jd.fm();const b=a?a.firstChild:null;b&&"BR"===b.tagName&&(this.$f.bu++,a.removeChild(b))}this.rd.gJb||(a=this.YJ.Kc(this.Lb.Ag),this.ir.isEmpty(a)&&!this.ir.Q$d(a)&&this.ZC.Pgb(!0,this.Lb.Fi,
this.Ch));this.uFd.value.GWb(this.jd.fm(),this.jd.contentWindow);this.sR.Qjc()}mwl(){var a=this.Lb.NV;const b=this.jd.fm().style;if(this.Se.rsb){if(!a)return!0;a=this.Lb.Rh.htmlElement;this.Ds.Prh()&&(b.position="absolute",b.width="100%");a.style.width="auto";a.style.height="auto"}this.Lb.Dba=this.iMj();return!1}iMj(){return ae.OutlineElementReader.jm(Xb.OutlineElementNavigator.EA(this.Lb.Ag.node))}It(a){return dh.a.It(a)}zjk(a){if(!this.Qc.Oa||!this.Qc.Oa.kb)return Z.ULS.sendTraceTag(19711041,324,
15,"Attempt to validate selection with empty selection."),!1;if(!this.Se.mU&&(!a.lM||Cb.App.M9d&&a.GHa))return this.Ds.gfa&&(this.Ds.Iwh(this.Se.Ma),this.Ds.gfa=!1),!1;this.Se.mU=!1;a=(new Date).getTime();const b=this.Qc.Gna;!this.fj&&!b.fbe&&!b.Rce&&250<a-this.EBg?this.tXf(null):(this.pp.raiseEvent(qe.a.Hhk),b.K5k(Object(C.a)(this,this.tXf,"delayOnAfterValidateSelection")));return!0}tXf(){1===this.xh.mode&&(this.Qc.Oa.Oca&&this.Lb.Ag&&(this.Lb.Rh=this.Lb.Ag.oc(this.Se.Ma),this.Lb.Rh||Z.ULS.sendTraceTag(18437327,
324,15,"current editing view element is set to null!"),this.Lb.NV=this.Lb.Ag.oc(this.If.Nd.Ma)),this.Qc.Oa.Oca&&this.jd.fm().firstChild!==this.Lb.$Oa&&this.Lb.$Oa&&(ya.a.ku(this.jd.fm()),this.jd.fm().appendChild(this.Lb.$Oa)),this.jd.fm().firstChild&&(this.Qc.Oa.Oca?this.jd.fm().style.direction=this.It(this.jd.fm().firstChild).direction:Sys.UI.DomElement.containsCssClass(this.jd.fm().firstChild,"Rtl")?this.jd.fm().style.direction="rtl":this.jd.fm().style.direction="ltr",this.Qc.Oa.Oca&&this.Yoa.hvh(this.Lb.Rh),
this.Ds.Iwh(this.Se.Ma),this.gK.ngb(this.xh.mode,this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My)),this.EBg=(new Date).getTime(),this.pp.raiseEvent(qe.a.DUi))}d0(a){const b=this.yjk(a);this.pp.raiseEvent(!a.lM||Cb.App.M9d&&a.GHa?qe.a.WBc:qe.a.d5g);return b}}Object(e.a)(nj,"ContentEditableViewOnAfterValidateHandler",null,[]);class Xi{constructor(a,b,c,f,l){this.Se=null;this.Ds=a;this.Rr=c;this.jd=f;this.pp=l}fS(a){this.Se=a}yX(a){const b=this.Se.Zqb;let c=3===b;c||
2!==b||(this.Se.root.k7d(510),c=!0,this.Ds.lY());if(c)return a.cancel=!0,!1;this.pp.xGk(a);return!1}}Object(e.a)(Xi,"ContentEditableViewOnBeforeValidateHandler",null,[]);class La{constructor(a,b,c,f,l){this.y6=!1;this.vza=null;this.pp=a;this.hd=b;this.$f=c;this.jd=f;this.Jtf=l}TPf(){this.y6=!1}Pgb(a,b,c){const f=this.jd.CCa();a&&(this.y6=ya.a.fv(b)!==X.a.uJc);if(a&&!this.y6){for(b=this.jd.fm();b.firstChild;)b=b.firstChild,this.Jtf&&Sys.UI.DomElement.containsCssClass(b,hc.a.UJa)&&Sys.UI.DomElement.addCssClass(b,
hc.a.vze);3!==b.nodeType?(this.vza=f.Il.createTextNode(Za.WDb),b.appendChild(this.vza)):(this.vza=b,this.vza.nodeValue=Za.WDb);this.y6=!0;this.pp.ebh(!0)}if(!a&&this.y6){a=this.vza;b=null;try{b=this.vza.parentNode,b||""!==a.nodeValue||(this.vza=null)}catch(l){this.$f.i++,this.vza=null}this.vza&&b!==f||(this.hd.Tb("PossibleExtraSpace",{["Reason"]:"LostPadding"}),this.$f.j++,c.Bi.length&&(a=this.o5f(c.Bi[c.Bi.length-1].aF)));if(a&&(a.nodeValue.endsWith(" ")||a.nodeValue.endsWith(Za.WDb))){if(this.Jtf)for(c=
a;(c=c.parentNode)&&c.tagName&&"P"!==c.tagName.toUpperCase();)if(Sys.UI.DomElement.containsCssClass(c,hc.a.vze)){Sys.UI.DomElement.removeCssClass(c,hc.a.vze);break}c=a.nodeValue;a.nodeValue=c.substring(0,c.length-1)}this.y6=!1;this.pp.ebh(!1)}}kbl(a,b,c){return!this.y6||a||(r.a.tF&&!r.a.Nj||r.a.qF)&&!b?!1:c.vCf()}o5f(a){if(a.className===hc.a.aN)return null;var b=a.childNodes?a.childNodes.length:0;if(b)for(--b;0<=b;--b){const c=this.o5f(a.childNodes[b]);if(c)return c}else if("#text"===a.nodeName&&
(b=a.nodeValue,b.endsWith(" ")||b.endsWith(Za.WDb)))return a;return null}}Object(e.a)(La,"ContentEditableViewPaddingManager",null,[1432]);class lb{constructor(a){this.gTd=this.URe=this.Vqa=this.b2=!1;this.YWc=this.Fld=this.mGc=-1;this.swd=!1;this.Bde=0;this.doa=a}get Fca(){return this.swd}set Fca(a){a!==this.swd&&this.doa.processAction(a?E.a.GYf:E.a.HYf,2);this.swd=a}mAg(){return this.URe||this.Vqa||this.b2}b5(){this.gTd=this.URe=this.Vqa=this.b2=!1;this.YWc=this.Fld=this.mGc=-1}}Object(e.a)(lb,"ContentEditableViewTypingState",
null,[]);class Nb{constructor(a,b,c,f,l,x,G){this.Pi=a;this.$f=b;this.hd=c;this.Oo=f;this.kf=l;this.Lb=x;this.fj=G}Yra(a){if(!this.Lb.Rh||1===this.kf.mode&&!this.Oca())return null;const b=this.Pi.z7(this.kf.mode,this.Lb.Fi);let c=b,f=0;const l=this.Lb.Rh.Ts;let x,G=!1;for(x=0;x<l.length;x++){var R=l[x];if(!this.Oo.bvg(R)){G=!0;continue}const fa=this.Oo.lI(R,this.$f,this.hd,this.fj),wa=Sys.UI.DomElement.containsCssClass(R,hc.a.MM);R=Sys.UI.DomElement.containsCssClass(R,X.a.yV);if(c<=fa)return wa?c=
a||c===fa?1:0:R&&(c=0),this.Mg(this.Lb.Ag,f,c);c-=fa;wa?f++:R||(f+=fa)}return G?this.Mg(this.Lb.Ag,0,b):this.Mg(this.Lb.Ag,0,0)}Mg(a,b,c){return rd.SelectionFactory.Mg(a,b+c)}Oca(){return qd.a.instance.Oa.Oca}}Object(e.a)(Nb,"CurrentEditSelectionProvider",null,[1431]);class lc{constructor(a,b,c){this.xLb=[];this.IAc=null;this.hd=a;this.UR=b;this.uFd=c}get Bi(){return this.xLb}set Bi(a){this.xLb=a}vCf(){return this.xLb.length?1<this.xLb.length||1<this.xLb[0].aF.innerText.length:!1}p6f(a,b,c){const f=
K.a.te(a,X.a.xEa),l=b?a.firstChild:a.lastChild;let x=null;b&&0<f?x=c.Ts[f-1]:!b&&f<c.Ts.length&&(x=c.Ts[f+1]);if(x)for(this.hd.Tb("MomentaryNonLinkFormatting",{["Reason"]:"MoveSafariStrayTextNode"}),this.UR.u++,a.removeChild(l),b?x.appendChild(l):x.insertBefore(l,x.firstChild),a=0;a<this.Bi.length;a++);}Foi(a){for(let b=0;b<this.Bi.length;b++){const c=this.Bi[b].aF;r.a.tF&&0<c.getElementsByTagName("A").length&&(3===c.firstChild.nodeType?this.p6f(c,!0,a):3===c.lastChild.nodeType&&this.p6f(c,!1,a));
ya.a.wx(c,c.innerText)}}whk(a){for(let b=0;b<this.Bi.length;b++)this.uFd.GWb(this.Bi[b].aF,a)}xPk(){for(let a=0;a<this.Bi.length;++a){const b=this.Bi[a].aF;if(Sys.UI.DomElement.containsCssClass(b,hc.a.iHc)||Sys.UI.DomElement.containsCssClass(b,hc.a.gHc)||Sys.UI.DomElement.containsCssClass(b,hc.a.fHc)||Sys.UI.DomElement.containsCssClass(b,hc.a.hHc)){const c=this.Bi[a].YWa;c&&c!==b.innerText.length&&(b.className=hc.a.aYb)}}}Zck(a,b){for(let c=0;c<this.Bi.length;c++){const f=this.Bi[c],l=a<=f.nRa,x=
f.nRa+f.YWa,G=x<=b;f.Y$c=l?f.nRa:a;f.rze=G?x:b;l&&G&&(f.QWb=!0)}}EPf(){Array.clear(this.Bi)}}Object(e.a)(lc,"CurrentlyActiveContentSpans",null,[1430]);class Rc{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie){this.Bsd=!1;this.ef=a;this.Qc=b;this.hd=c;this.kf=f;this.pp=l;this.If=x;this.Ch=G;this.Lb=R;this.rd=fa;this.gK=wa;this.Ek=Wa;this.Eya=mb;this.aMb=Kb;this.oMh=nc;this.Xj=oc;this.jd=Ic;this.Ca=Hc;this.Xc=ie;this.ZPh=Kc.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.YOb=Kc.ka("PasteKeepSourceFontSizeFixIsEnabled");
this.Cuc=(this.Wsf=Kc.ka("ProtectInClient"))||Kc.ka("ProtectedFile");this.iQh=Kc.ka("EnableExtractForProtectedFile");this.OQh=Kc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1);this.COb=Kc?Kc.ka("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.kPb=Kc?Kc.ka("TextLayoutServiceUseResponse"):!1;this.Kuf=this.Juf=!1}get nZ(){return this.Eya.instance}get I9a(){return this.Xc.ag&&this.Xc.By}pjg(a,b,c,f){this.ABk(a,b,c,f)}ABk(a,b,c,f){if(this.OQh){if(this.Cuc&&!this.iQh){a.preventDefault();
return}}else if(this.Wsf){a.preventDefault();return}!b||this.Ek.value.isEditingAllowed||this.Ek.value.My&&this.I9a?1!==this.kf.mode||this.Bsd||!c||f||(this.nZ?b&&!this.ef.xTc(this.Qc.Kj)?(Z.ULS.sendTraceTag(3994324,307,50,"Cut not allowed"),this.hd.Tb(Nd.a.vh,{["Reason"]:Od.a.ASd}),this.aMb.show(),a.preventDefault()):(this.Qc.Gna.GYd(),this.Bsd=!0,b&&this.pp.raiseEvent(qe.a.bFi),r.a.cta&&a.rawEvent&&a.rawEvent.currentTarget&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings"),
this.COb&&this.Xj.cfd(a.rawEvent.currentTarget,"data-src","data-srcurl")),this.rd.Nj&&this.ZPh&&this.cVi(a),this.YOb&&(this.Juf=this.ZUi(a)),this.kPb&&(this.Kuf=this.gQk(a)),a=this.oMh.create(null,Object(C.a)(this,this.dJi,"dispatchCutCopy"),b),a.Fl("Browser "+(b?"Cut":"Copied")),a.run()):(Z.ULS.sendTraceTag(3994323,307,50,"Clipboard command not available"),this.Ca.cfe(b?E.a.cut:E.a.copy),a.preventDefault())):a.preventDefault()}cVi(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){var c=
null;c=this.e0i();({rHc:c}=this.Xj.yrl(c));c&&(a.preventDefault(),b.setData("text/html",Ca.c(c)),b.setData("text/plain",c.innerText))}}ZUi(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=b.getData("text/html").toString();if(c&&0<c.length)return a=this.Xj.$Wa(c),this.Xj.UVb(a,this.If.Nd.Fd,!0)?(b.setData("text/html",a.innerHTML),!0):!1}return this.Xj.UVb(a.rawEvent.currentTarget,this.If.Nd.Fd,!0)}gQk(a){const b=a&&a.rawEvent?a.rawEvent.clipboardData:null;if(b&&b.setData){const c=
b.getData("text/html").toString();a=c&&0<c.length?this.Xj.$Wa(c):a.rawEvent.currentTarget;if(this.Xj.Ond(a,!1))return b.setData("text/html",Ca.c(a)),b.setData("text/plain",a.innerText),!0}return!1}e0i(){if(this.rd.AU){const a=this.jd.CCa();if(a&&a.Il)return a.Il.getSelection()}return null}dJi(a,b){this.Bsd=!1;if(this.If.Nd.ho&&1!==u.AFrameworkApplication.Aa.state){if(b){if(this.rd.eg){for(b=0;b<this.Ch.Bi.length;b++){const c=this.Ch.Bi[b].aF,f=c.getElementsByTagName("BR");for(let l=0;l<f.length;l++)c.removeChild(f[l])}this.gK.MIa(this.kf.mode,
this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My)}this.nZ.ifi(a)}else this.nZ.gfi(a);r.a.cta&&this.COb&&this.If&&this.Xj.cfd(this.If.Nd.yg.Hn,"data-srcurl","data-src");this.YOb&&this.Juf&&this.If&&this.If.Nd&&this.Xj.UVb(this.If.Nd.yg.Hn,this.If.Nd.Fd,!1);this.kPb&&this.Kuf&&this.If&&this.If.Nd&&this.Xj.Ond(this.If.Nd.yg.Hn,!0)}}}Object(e.a)(Rc,"CutCopyHandler",null,[1429]);class Ud{constructor(a,b,c,f,l,x,G,R){this.rd=a;this.xh=b;this.Rr=c;this.hd=f;this.kf=l;this.xga=
x;this.Ds=G;this.enb=R}cZb(a,b){this.rd.eg&&2===this.xh.mode&&b&&this.Rr.isComposing&&(a=this.hd.Kp(E.a.typing),a.properties.$(Dd.a.source,"DomChange"),this.DKi(),a.end())}DKi(){this.enb||this.kf.x$(!0);this.xga.rCb();this.Ds.lY()}}Object(e.a)(Ud,"DomChangeEventProcessor",null,[]);class Pd{constructor(a,b,c,f){this.Pi=a;this.xh=b;this.Lb=c;this.If=f}Tdb(a,b){if(!b)return!1;this.Pi.wXf(this.xh,this.Lb);return this.If.Nd?this.If.Nd.Tdb(a):!1}}Object(e.a)(Pd,"DoubleClickProcessor",null,[]);class Sd{constructor(a,
b,c){this.rd=a;this.Qkb=b;this.ytd=c}MBa(){this.Qkb.c5a=!0;return!1}fZb(){return this.Qkb.c5a=!1}NBa(a){this.Qkb.c5a=!1;this.ytd.cancelEventAndRestoreEditingSurface(a.mc);return!0}}Object(e.a)(Sd,"DragEventsProcessor",null,[]);class Le{constructor(a){this.R2e=0;this.wsd=!1;this.rd=a}get c5a(){return this.wsd}set c5a(a){this.wsd=a;window.clearTimeout(this.R2e);this.wsd&&(this.R2e=window.setTimeout(Object(C.a)(this,this.njk,"onAfterDragInactivity"),1E3))}njk(){this.c5a=!1}}Object(e.a)(Le,"DragStateManager",
null,[]);class af extends ob{constructor(){super();this.PWg=this.Xik=0}}Object(e.a)(af,"SetModeEditEventArgs",ob,[]);class zf extends ob{constructor(){super();this.updates=null;this.aya=new Ha.a}}Object(e.a)(zf,"BeforeValidateEditEventArgs",ob,[]);class yh{constructor(){this.A0k=this.EKi=null}}Object(e.a)(yh,"EditStateFactoryManager",null,[]);class gg extends ob{constructor(){super();this.charCode=0;this.sLj=this.isComposing=!1}}Object(e.a)(gg,"KeyDownEditEventArgs",ob,[]);class Dh extends ob{constructor(){super();
this.charCode=0;this.isComposing=!1}}Object(e.a)(Dh,"KeyPressEditEventArgs",ob,[]);class Ug extends ob{constructor(){super();this.utj=!1}}Object(e.a)(Ug,"PaddingChangedEventArgs",ob,[]);class ui{constructor(a){this.Pa=new ic.a;this.o0a=Object.assign(new yh,{EKi:()=>a.fm(),A0k:()=>ib.a.ACa(a.contentWindow)})}addHandler(a,b){this.Pa.addHandler(a,b)}removeHandler(a,b){this.Pa.removeHandler(a,b)}raiseEvent(a){this.Pa.raiseEvent(a,Object.assign(new ob,{E5a:this.o0a}))}jIk(a,b){0===a&&0===b||this.Pa.raiseEvent(qe.a.y5k,
Object.assign(new af,{Xik:a,PWg:b,E5a:this.o0a}))}xGk(a){this.Pa.raiseEvent(qe.a.Jdi,Object.assign(new zf,{E5a:this.o0a,updates:a.updates,aya:a.aya}))}fbh(a){a.E5a=this.o0a;this.Pa.raiseEvent(qe.a.d5g,a)}mEe(a,b){this.Pa.raiseEvent(qe.a.Qx,Object.assign(new Dh,{charCode:a.mc.charCode,isComposing:b,E5a:this.o0a}))}oHk(a,b,c){this.Pa.raiseEvent(qe.a.Xf,Object.assign(new gg,{charCode:a.mc.charCode,isComposing:b,sLj:c,E5a:this.o0a}))}ebh(a){this.Pa.raiseEvent(qe.a.Wtk,Object.assign(new Ug,{E5a:this.o0a,
utj:a}))}}Object(e.a)(ui,"EditStateEventManager",null,[1428]);class Uh{constructor(a){this.rxd=this.luc=!1;this.Nef=null;this.h0e=0;this.yRc=!1;this.Pa=a;this.$2e=0;this.tyd=2}get mode(){return this.$2e}Igb(a,b){0===a?(0===b&&(b=1),this.Nef=(new Date).toISOString(),this.tyd=b):this.tyd=0;this.$2e=a}get XWc(){return this.tyd}get XTj(){return this.Nef}get isActive(){return 0!==this.mode}get Ivi(){return this.h0e}ZIa(a){this.rxd=a}W0b(a){return this.isActive&&!!a&&this.luc}x$(a){!this.luc&&a&&this.Pa.raiseEvent(od.Fvi);
this.luc=a;this.hik(a);a&&(this.h0e=(new Date).getTime())}icg(a){return this.isActive&&!!a&&this.rxd}hik(a){a&&qf.GrippersManager.instance.setVisibility(!1)}DVk(){this.rxd=this.luc=!1}}Object(e.a)(Uh,"EditViewStateManager",null,[1427]);var Yi=d(893);class lh{constructor(a,b,c,f,l,x){this.jd=a;this.ZC=b;this.pp=c;this.gK=f;this.eb=l;this.If=x;this.eb&&(this.eb.ka("WordEditorImageOverflowIsEnabled")||this.eb.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&(lh.$Ic=-1*Math.pow(2,31))}REc(){this.ZC.TPf();
ya.a.ku(this.jd.fm())}CVd(a){const b=this.jd.fm();if(2===a){var c=Za.MLi;a=lh.LLi;b.style.overflow="visible"}else if(1===a)c=r.a.rgb?0:lh.$Ic,a="0",b.style.overflow="hidden";else return;const f=this.jd.yg.du;f.style.position="absolute";this.eb&&(this.eb.ka("WordEditorImageOverflowIsEnabled")||this.eb.ka("WordEditorImageUseRelativeHeightAsZIndexDirectlyIsEnabled"))&&0<c?(c=document.createElement("div"),f.style.zIndex=String(c.style.zIndex)):f.style.zIndex=String(c);f.style.display="block";f.style.visibility=
"visible";f.style.maxHeight="none";f.style.maxWidth="";b.style.visibility="visible";f.style.opacity=a}C1f(a){if(this.jd&&this.jd.yg&&this.jd.yg.du){var b=this.jd.yg.du;b.style.zIndex=String(r.a.rgb?0:lh.$Ic);r.a.rgb&&!a&&(b.style.visibility="hidden",this.jd.fm().style.visibility="hidden")}}GBk(a){this.pp.raiseEvent(qe.a.CDj);this.REc();this.jd.wYa(!0);this.jd.fm().style.direction="";this.CVd(a);this.jd.yg.nfk()}CBk(a){this.jd.wYa(!0);this.CVd(a);r.a.rgb&&this.smg();r.a.qF&&Sys.UI.DomElement.addCssClass(this.jd.fm(),
"NonStandardIEClipboard")}FBk(a){this.CVd(a);r.a.qF&&Sys.UI.DomElement.removeCssClass(this.jd.fm(),"NonStandardIEClipboard")}EBk(a,b,c,f,l,x,G){this.pp.raiseEvent(qe.a.endEditing);const R=this.jd.fm();R&&(ya.a.ku(R),r.a.oW&&b&&a&&(this.jd.wYa(!0),R.innerText=" ",this.gK.MIa(c,f,l,x,G)),a||ib.a.aQf(R),this.jd.wYa(!1),this.C1f(b))}DBk(a){this.jd.wYa(!1);r.a.qF&&Sys.UI.DomElement.removeCssClass(this.jd.fm(),"NonStandardIEClipboard");this.C1f(a);this.pp.raiseEvent(qe.a.cqi)}HBk(){const a=Sys.UI.DomElement.getBounds(this.If.Nd.uJ),
b=this.jd.yg.du;Sys.UI.DomElement.getBounds(b).y<a.y&&(b.style.top=Math.max(this.If.Nd.scrollTop,Yi.a)+"px");b.style.opacity="0";b.style.zIndex=String(lh.$Ic);r.a.Aj&&(b.style.visibility="Hidden",this.jd.fm().style.visibility="Hidden")}smg(){const a=1E3-this.If.Nd.container.getBoundingClientRect().left+this.If.Nd.scrollLeft+1,b=this.jd.yg.du;b.style.left="-11000px";b.style.paddingRight=a+"px";b.style.width=1E4+a+"px"}}lh.$Ic=-1E3;lh.LLi="1";Object(e.a)(lh,"EditingDomDisplayManipulator",null,[]);class jg{constructor(a){this.oVh=
a}get range(){return this.oVh}select(){this.range.select()}execCommand(a,b,c){return this.range.execCommand(a,b,c)}queryCommandEnabled(a){return this.range.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.range.queryCommandIndeterm(a)}queryCommandState(a){return this.range.queryCommandState(a)}queryCommandSupported(a){return this.range.queryCommandSupported(a)}queryCommandValue(a){return this.range.queryCommandValue(a)}scrollIntoView(a){this.range.scrollIntoView(a)}}Object(e.a)(jg,"RangeProxy",
null,[1506]);class cj{constructor(a){this.n2a=a}get selection(){return this.n2a}get type(){return this.selection.type}createRange(){return new jg(this.selection.createRange())}clear(){this.selection.clear()}empty(){this.selection.empty()}}Object(e.a)(cj,"SelectionProxy",null,[1493]);class oj{constructor(a){this.KMh=a}get Il(){return this.KMh}get body(){return this.Il.body}get activeElement(){return this.Il.activeElement}get documentElement(){return this.Il.documentElement}get document(){return this.Il.cookie}get selection(){return new cj(this.Il.selection)}get designMode(){return this.Il.designMode}get doctype(){return this.Il.doctype}get domain(){return this.Il.domain}get hidden(){return this.Il.hidden}get implementation(){return this.Il.implementation}get parentWindow(){return this.Il.parentWindow}get referrer(){return this.Il.referrer}get title(){return this.Il.title}get URL(){return this.Il.URL}get visibilityState(){return this.Il.visibilityState}createAttribute(a){return this.Il.createAttribute(a)}open(){this.Il.open()}close(){this.Il.close()}attachEvent(a,
b){return this.Il.attachEvent(a,b)}detachEvent(a,b){this.Il.detachEvent(a,b)}createAttributeNS(a,b){return this.Il.createAttributeNS(a,b)}createDocumentFragment(){return this.Il.createDocumentFragment()}createElement(a){return this.Il.createElement(a)}createElementNS(a,b){return this.Il.createElementNS(a,b)}createEvent(a){return this.Il.createEvent(a)}createTextNode(a){return this.Il.createTextNode(a)}dispatchEvent(a){return this.Il.dispatchEvent(a)}execCommand(a,b,c){return this.Il.execCommand(a,
b,c)}hasFocus(){return this.Il.hasFocus()}focus(){this.Il.focus()}getElementById(a){return this.Il.getElementById(a)}getElementsByTagName(a){return this.Il.getElementsByTagName(a)}getElementsByTagNameNS(a,b){return this.Il.getElementsByTagNameNS(a,b)}getElementsByName(a){return this.Il.getElementsByName(a)}write(a){this.Il.write(a)}querySelector(a){return this.Il.querySelector(a)}querySelectorAll(a){return this.Il.querySelectorAll(a)}queryCommandEnabled(a){return this.Il.queryCommandEnabled(a)}queryCommandIndeterm(a){return this.Il.queryCommandIndeterm(a)}queryCommandState(a){return this.Il.queryCommandState(a)}queryCommandSupported(a){return this.Il.queryCommandSupported(a)}queryCommandValue(a){return this.Il.queryCommandValue(a)}}
Object(e.a)(oj,"DOMDocumentProxy",null,[1538]);class hk{constructor(){this.q0a=null}get isValid(){return this.yg.isValid}get contentWindow(){return this.yg?this.yg.contentWindow:null}get yg(){return this.q0a}Qlk(a){rg.a.XTg(a,this.yg.du)}Plk(){rg.a.DUe(this.yg.du)}I1f(){this.yg.DNi()}Xaj(a){if(!r.a.eg)return a.innerHTML;this.yg.Rrl(a);return a.innerHTML}Ktl(){this.yg?(this.Plk(),this.q0a=null):Z.ULS.sendTraceTag(18437346,323,15,"UnbindFromEditingDom: View not currently bound to Dom.")}gei(a,b){this.q0a=
a;this.Qlk(b)}fm(){return this.yg?this.yg.Hn:null}wYa(a){this.yg&&this.yg.phd(a)}CCa(){return this.yg?new oj(this.yg.contentDocument):null}}Object(e.a)(hk,"EditingDomManager",null,[1426]);var Vh=d(144);class Ji{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie){this.Xga=0;this.Se=null;this.Lb=a;this.rk=b;this.s1=c;this.pp=f;this.yoa=l;this.Rd=x;this.jd=G;this.kf=R;this.SJ=fa;this.Ek=wa;this.rd=Wa;this.ZC=mb;this.Qc=Kb;this.VJ=nc;this.Ch=oc;this.If=Ic;this.ef=Kc;this.Xc=ie;this.wga=Hc;this.wga.m8h(Object(C.a)(this,
this.Y2g,"onSynchronizeMode"))}dispose(){this.wga.aTk(Object(C.a)(this,this.Y2g,"onSynchronizeMode"))}dVb(a){(this.Se=a)||Z.ULS.sendTraceTag(22122889,323,50,"Bind ContentEditableView resolve failed as null.")}get mode(){return this.kf.mode}endClipboard(){if(1===this.mode){var a=this.rk.ke(2);a.gd(this.Se.root);this.Se.detach();this.Lb.Ag&&!this.R9d&&this.Lb.Ag.Aca(this.If.Nd.Ma,4,!0);this.kf.Igb(0,3);this.Lb.Ag=null;this.Lb.Rh=null;this.Lb.NV=null;this.s1.DBk(this.Se.NHa);a.dispose()}}v$(a,b,c){this.Se.oSa&&
this.Lb.Rh?this.Se.Cs(!1):this.Se.oSa&&!this.Lb.Rh&&Z.ULS.shipAssertTag(17884511,315,!1,"Content is dirty when CurrentEditingViewElement is still NULL");this.pp.jIk(this.mode,a);let f=!0;switch(a){case 2:this.endClipboard();this.kf.Igb(a,c);f=this.startEditing(this.VEi);break;case 1:if(this.mode!==a||this.Qc.Oa.Ir!==this.Xga)this.endEditing(!0),this.kf.Igb(a,c),f=this.Fil(),this.Xga=this.Qc.Oa.Ir;break;case 0:this.mode!==a&&(2===this.mode&&qf.GrippersManager.instance.setVisibility(!1),this.endEditing(b),
this.endClipboard(),this.kf.Igb(a,c))}f||this.kf.Igb(0,7)}K3k(){this.kf.Igb(2,0)}get VEi(){return this.Qc.Oa.kb.Ua.node}startEditing(a){if(1===this.wCf)return!1;this.jd.I1f();this.Se.jxa?this.Se.Cs(!0):(this.Se.bxj.K1f(!1),this.kf.W0b(this.Lb.Ag)&&this.Se.Cs(!1));this.Se.jxa=!1;if(this.Lb.Ag===a)return a=nb.GraphIterator.mb(a.node),this.JVd(a),this.Lb.Utj&&(this.rd.Ki&&this.Se.Bqb.Fca||this.SJ.setFocus(this.mode,this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My)),!0;
const b=this.rk.ke(2,E.a.startEditing);b.gd(a.node);this.Se.detach();this.Lb.Ag&&this.Lb.Ag.Aca(this.If.Nd.Ma,4,!0);this.Lb.Ag=a;this.Lb.Ag.Aca(this.If.Nd.Ma,4,!0);if(this.Xc.ag){const c=Ie.j(this.Lb.Ag,5);for(let f=0;f<c.length;f++)c[f].IZf(this.Se)}this.Se.rsb=!0;this.s1.GBk(this.mode);this.Se.Hx(a.node);this.ZC.Pgb(!1,this.Lb.Fi,this.Ch);this.kf.x$(!1);this.kf.ZIa(!1);a=nb.GraphIterator.mb(this.Lb.Ag.node);this.JVd(a);b.dispose();return!0}endEditing(a){if(2===this.mode&&(this.Se.DJc(),this.Se.Cs(!0),
!this.R9d)){var b=this.rk.ke(2);b.gd(this.Se.root);this.Se.detach();this.Lb.Ag&&this.If.Nd&&this.Lb.Ag.Aca(this.If.Nd.Ma,20,!0);this.kf.Igb(0,4);this.Lb.Ag=null;this.Lb.Rh=null;this.Lb.NV=null;this.s1.EBk(a,this.Se.NHa,this.mode,this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My);b.dispose()}}Fil(){if(this.R9d||H.a.instance.ga(11)&&1===this.wCf)return!1;this.pp.raiseEvent(qe.a.bqi);this.jd.I1f();const a=this.rk.ke(2);a.gd(this.Qc.nib);this.kf.W0b(this.Lb.Ag)&&this.Se.Cs(!1);
this.Se.detach();this.Lb.Ag=null;this.Lb.Rh=null;this.Lb.NV=null;if(this.Qc.Oa.Oca){const b=this.Qc.Oa.kb.Ua.node;this.Se.Hx(b);const c=nb.GraphIterator.mb(b);this.Lb.Ag=b;this.Lb.Dba=this.nGj(b);this.JVd(c);this.Lb.Ag.Aca(this.If.Nd.Ma,4,!0)}else this.Se.Hx(this.Qc.nib);this.s1.CBk(this.mode);this.ZC.Pgb(!1,this.Lb.Fi,this.Ch);a.dispose();return!0}Y2g(){this.uZa()}uZa(){if(!this.yoa.n8&&!u.AFrameworkApplication.pe.$v&&this.If.Nd&&this.If.Nd.isActive){var a=this.Qc.Oa.kb;a&&this.SJ.fae()?this.VJ&&
this.VJ.q8a()?this.v$(2,!0,10):this.ef.Uw(a)?Cb.App.Hb.Hd.isEditingAllowed||Cb.App.Hb.Hd.My?this.v$(2,!0,0):this.Se.hjd?(this.v$(1,!0,0),this.v$(0,!0,15)):this.v$(2,!0,0):this.v$(1,!0,0):this.v$(0,!1,a?9:8)}}get R9d(){return u.AFrameworkApplication.Vg}get wCf(){return u.AFrameworkApplication.Aa.state}JVd(a){a.af();Vh.OutlineNavigator.UHe(a)}nGj(a){return ae.OutlineElementReader.jm(Xb.OutlineElementNavigator.EA(a))}}Object(e.a)(Ji,"EditingModeTransitionManager",null,[1425]);class Bi{constructor(a,
b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te){this.Se=null;this.Rd=a;this.kf=b;this.Lb=c;this.tRh=f;this.Dk=l;this.sRh=x;this.qRh=G;this.bsd=R;this.aZh=fa;this.Pkb=wa;this.HMa=Wa;this.D0e=mb;this.JMh=Kb;this.SJ=nc;this.Zfa=oc;this.USb=Ic;this.OMh=Kc;this.DTh=Hc;this.yJh=ie;this.cSh=He;this.Vga=fe;this.Pi=Te}fS(a){this.Se=a}get hY(){return!this.Rd.$v&&this.kf.isActive&&this.Lb.eTa(this.kf.mode)?!0:!1}qyk(a){a.tEa=b=>this.tRh.tEa(b,this.hY);a.R9a=b=>this.sRh.R9a(b,this.hY);a.Lz=b=>this.qRh.Lz(b,
this.hY,this.Se.yYb);a.TWb=b=>this.bsd.TWb(b,this.hY,this.Se.yYb);a.GPd=b=>this.bsd.EPd(b,this.hY,this.Se.yYb);a.SWb=b=>this.bsd.SWb(b,this.hY,this.Se.yYb);a.iib=b=>this.aZh.iib(b,this.hY&&this.Se.hjd);a.NBa=Object(C.a)(this.Pkb,this.Pkb.NBa,"dropHandler");a.MBa=Object(C.a)(this.Pkb,this.Pkb.MBa,"dragOverHandler");a.fZb=Object(C.a)(this.Pkb,this.Pkb.fZb,"dragLeaveHandler");a.agc=b=>{this.HMa.handlePaste(b,this.Se.root,this.kf.yRc)};a.zSd=b=>{this.D0e.pjg(b,!0,this.hY,this.kf.yRc)};a.lXb=b=>{this.D0e.pjg(b,
!1,this.hY,this.kf.yRc)};a.cZb=b=>{this.JMh.cZb(b,this.hY)};a.pKf=()=>{this.SJ.Bei()};a.MB=b=>this.Zfa.WEi(b,this.Dk.Fca,this.hY);a.PB=b=>this.USb.onContextMenu(b,this.Se.Ag);a.VSe=Object(C.a)(this.USb,this.USb.ofc,"onTouchMove");a.USe=Object(C.a)(this.USb,this.USb.LDb,"onTouchEnd");a.sJd=()=>{this.SJ.JNi(this.kf.mode)};a.B5a=b=>this.OMh.Tdb(b,this.hY);a.gYa=b=>{this.DTh.onScroll(b,this.hY,this.Se.ownerDocument.documentElement)};a.Sea=()=>{this.yJh.Mjk(this.hY)};a.hEg=b=>{this.cSh.lostFocus(b,this.hY)};
a.PGb=()=>this.Vga.mrj(this.hY,this.Se.Ag);a.sdb=b=>this.Pi.mouseDown(b);a.Eue=b=>this.Pi.dJ(b)}}Object(e.a)(Bi,"EditingSurfaceEventHandlerManager",null,[]);class Eh{constructor(a,b,c){this.hd=a;this.$f=b;this.xh=c}cancelEventAndRestoreEditingSurface(a){this.hd.Tb("DisallowedDragAndDrop",{["Reason"]:"CancelEventAndRestoreEditingSurface"});this.$f.bx++;Ed.a.ln(a);this.xh.v$(0,!0,6);this.xh.uZa()}}Object(e.a)(Eh,"EditingSurfaceEventHandlerUtils",null,[]);class rh{constructor(){this.Yza=0}get n8(){return 0<
this.Yza}suspend(){this.Yza++}resume(){0<this.Yza&&this.Yza--}}Object(e.a)(rh,"EditingSurfaceStateManager",null,[]);class sg{constructor(a=30){this.N6c=this.qdc=-1;this.vib=Array(a);this.e7c=Array(a-1)}hzh(){this.dLk();this.sxl()}Vgd(){const a=this.L1k();Z.ULS.sendTraceTag(18437392,324,50,"Duration Values: "+a)}dLk(){var a=(new Date).getTime();if(this.qdc<this.vib.length-1)this.qdc++;else for(let b=0;b<this.vib.length-1;b++)this.vib[b]=this.vib[b+1];this.vib[this.qdc]=a}sxl(){const a=this.qdc+1;for(let b=
2;b<=a;b++)this.mtl(b,this.w4i(b))}w4i(a){const b=this.qdc;return this.vib[b]-this.vib[b-(a-1)]}mtl(a,b){a-=2;this.N6c<a?(this.N6c++,this.e7c[this.N6c]=b):b<this.e7c[a]&&(this.e7c[a]=b)}L1k(){const a=this.oTi();return Sys.Serialization.JavaScriptSerializer.serialize(a)}oTi(){const a=Array(this.N6c+1);for(let b=0;b<a.length;b++)a[b]=Math.round(this.e7c[b]/(b+1));return a}}Object(e.a)(sg,"EventFrequencyTracker",null,[]);var ci=d(1050),dj=d(1052);class Zi{constructor(a){this.qt=null;this.rp=0;this.LJ=
a;this.Fj=new Date;this.Lqc=u.AFrameworkApplication.Aa.mode}end(a){this.rp=a;this.qt=new Date}get startTime(){return this.Fj}get endTime(){return this.qt}get actionId(){return this.LJ}get behavior(){return 2}get XCc(){return this.Lqc}get rJ(){return null}get kd(){return null}get telemetryData(){return null}get response(){return this.rp}get LS(){return 1}get oq(){return 30}get Eqa(){return null}get Xi(){return!0}}Object(e.a)(Zi,"TypingActionOperation",null,[1437,346,347]);class Ri{constructor(a,b,
c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc){this.Se=this.Stc=this.qlb=null;this.VTh=a;this.xh=b;this.pp=c;this.Cga=f;this.s1=l;this.rk=x;this.Lb=G;this.If=R;this.Rd=fa;this.Ek=wa;this.kf=Wa;this.Pi=mb;this.Ch=Kb;this.Ds=nc;this.xga=oc;this.sR=Ic;this.Qc=Kc;this.dD=Hc}fS(a){this.Se=a}get Qng(){return!!this.qlb}startHybridTransition(){if(this.Ek.value.isEditingAllowed||this.Ek.value.My){this.xh.K3k();this.pp.raiseEvent(qe.a.Ttk);this.E4k(E.a.overtype);this.Cga.value.Yv();this.s1.FBk(this.xh.mode);var a=
this.rk.ke(2);a.gd(this.Se.root);this.Lb.Ag&&!u.AFrameworkApplication.Vg&&this.Lb.Ag.Aca(this.If.Nd.Ma,4,!0);a.dispose();this.sR.Qjc();this.kf.ZIa(!0);this.Pi.updateCaretPosition(this.xh.mode,this.Lb.Fi);this.VTh.iVi(this.Lb.Rh,this.Lb.Ag,this.Lb.NV);this.Ch.Zck(this.Qc.Oa.kb.Ua.Qa,this.Qc.Oa.kb.Ua.Kb);this.Ds.lY();this.xga.rCb();this.e2h();this.pp.raiseEvent(qe.a.Rtk)}else this.xh.v$(0,!0,12)}XMi(){this.sR.Qjc();this.qlb.end(32);ci.a.getInstance().Zic(this.qlb);dj.a.getInstance().Yic(this.qlb);this.qlb=
null}e2h(){this.Stc||(this.Stc=new xe.a(2,1,20,Object(C.a)(this,this.hybridCleanup,"hybridCleanup"),24),this.Rd.Cb(this.Stc))}E4k(a){this.qlb=new Zi(a)}hybridCleanup(){this.Stc=null;this.Lb.eTa(this.xh.mode)&&this.Se.Cs(!0)}CNe(){if(!this.Qc.Oa.Oca)return!1;const a=this.Qc.Oa.kb.Ua,b=Lb.HyperlinkReader.VB(a,!1);for(const c of b)if(c.Qa===a.Qa&&c.Kb<=a.Kb)return!1;return this.dD.gPj(a)?!1:!Ie.d(a.node,a.Qa)&&!Ie.d(a.node,a.Kb-1)&&!a.node.pvi}}Object(e.a)(Ri,"HybridTransitionManager",null,[1424]);class Fh{constructor(a,
b,c,f,l){this.Ovd=this.jxa=!1;this.Rr=a;this.xh=b;this.jd=c;this.Ch=f;this.If=l}get kxj(){return this.Ovd}DJc(){this.K1f(!0)}K1f(a){this.Rr.isComposing&&2===this.xh.mode&&(Z.ULS.sendTraceTag(18437401,323,50,"EnsureImeDetermined"),this.Ovd=!0,this.jd.yg.Nma(),this.Ch.whk(this.jd.contentWindow),this.Ovd=!1,this.Rr.isComposing=!1,a&&this.If.Nd.ho&&(this.If.Nd.cqb()&&Z.ULS.sendTraceTag(38602073,323,50,"Selection is reset to view top by EnsureImeDetermined."),this.xh.uZa()))}}Object(e.a)(Fh,"ImeManager",
null,[]);class Rj{constructor(a,b,c,f,l,x,G,R){this.yh=null;this.rd=a;this.jd=b;this.xh=c;this.rk=f;this.hd=l;this.$f=x;this.Jm=R}dVb(a){this.yh=a}get ixj(){if(this.rd.eg){const a=ib.a.ACa(this.jd.contentWindow);if(a&&this.Jm.hPc(a)===this.jd.fm())return!0}return!1}correctBadImeState(){if(!this.ixj)return!1;this.hd.Tb("PossibleIncorrectImeBehavior",{["Reason"]:"CorrectBadImeState"});this.$f.bz++;const a=this.rk.ke(3);a.gd(this.yh.root);this.xh.v$(0,!0,11);this.xh.uZa();a.dispose();return!0}}Object(e.a)(Rj,
"ImeRecoveryUtils",null,[]);class mh{constructor(a,b,c,f,l,x,G,R,fa){this.Ch=a;this.$f=b;this.hd=c;this.fj=f;this.YJ=l;this.Oo=x;this.If=G;this.Lb=fa}rCb(){for(let a=0;a<this.Ch.Bi.length;a++)this.Oo.lI(this.Ch.Bi[a].aF,this.$f,this.hd,this.fj)?Sys.UI.DomElement.removeCssClass(this.Ch.Bi[a].e9d,"EmptyTextRun"):Sys.UI.DomElement.addCssClass(this.Ch.Bi[a].e9d,"EmptyTextRun"),ya.a.kXb(this.Ch.Bi[a].aF,this.Ch.Bi[a].e9d)}}Object(e.a)(mh,"InteractiveViewSynchronizer",null,[]);var va=d(14),Qa=d(198),db=
d(237);class Gb{constructor(){}}Object(e.a)(Gb,"OnBackspaceDeleteEventArgs",null,[]);class jc{constructor(a){this.S4f=a}}Object(e.a)(jc,"OnDisMissFloatieEventArgs",null,[]);var Ac=d(541),W=d(98);class xa{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg,Sf,uh,Sg,li,Ui,Cj,jj,kj,Gi,yk,Dj,ok,Fl,Xk,Gl,ak,Sj,bk,Gk){this.Wga=null;this.Q$e=this.nYe=!1;this.sPb=new va.ScriptSharpLegacyMap;this.eAa=a;this.fj=b;this.Rd=c;this.jd=f;this.hd=l;this.$f=x;this.Ipa=G;this.Vga=R;
this.Zfa=fa;this.Lb=wa;this.Pi=Wa;this.rd=mb;this.Jm=Kb;this.JY=nc;this.ef=oc;this.sR=Ic;this.AH=Kc;this.Poa=Hc;this.Qc=ie;this.kf=He;this.Rr=fe;this.Cga=Te;this.CB=We;this.Yg=Qf;this.Ek=mg;this.gK=Xg;this.pkb=Mg;this.Dk=Sf;this.QLa=uh;this.hV=Sg;this.aKh=li;this.enb=Ui;this.rk=Cj;this.Ca=jj;this.Xc=kj;this.Ro=Gi;this.hD=yk;this.xNb=Dj;this.iP=ok;this.r2a=Fl;this.cpa=Xk;this.pp=Gl;this.$Jh=ak;this.xya=!!Sj;this.Ou=Sj;this.eb=bk;this.jn=Gk}get Ioc(){return this.eAa.instance?this.eAa.instance.xAh():
null}get aTd(){return this.xNb||(this.xNb=fb.a.instance.qb("Common.IEventTimingMeter"))}get oYa(){return this.Wga||(this.Wga=fb.a.instance.qb("Box4.ISelectionCommands"))}sTj(a,b){let c=this.l5d(a);c||(c=this.Aoj(a,b));return c}Aoj(a,b){const c=a.mc,f=c.keyCode,l=a.eventName===ma.a.bOa;if(this.xya&&l&&this.Ou.instance&&this.Ou.instance.ckk(f===w.a.wH))return Ed.a.ln(c),!0;if(f===w.a.p_a&&c.shiftKey&&c.ctrlKey)return l&&(u.AFrameworkApplication.Ta.processAction(E.a.YVf,2),Z.ULS.sendTraceTag(41738320,
323,50,"CtrlShiftV triggered.")),!1;if(l&&c.ctrlKey){if(f===w.a.uod||f===w.a.xod)return this.efe(E.a.XVf),!1;if(f===w.a.vod||f===w.a.vpc)return this.efe(E.a.WVf),!1;if(f===w.a.rXe)return this.efe(E.a.BEi),!1}this.fj&&(this.Rd.vXf(xa.Bml),this.jd.yg.Lmd());if(1===this.kf.mode)return this.znk(a,b);if(this.fj&&this.Dk.Fca)return this.hd.Tb("DisallowedKeyDownDuringDictation",{["Reason"]:"KeyDownHandler"}),this.$f.bw++,Ed.a.ln(c),this.Ipa.Mjc(E.a.typing),!0;this.Vga.fixupAfterMagnifierDrag();this.jd.fm().scrollTop=
0;this.Zfa.r8=!this.Lb.Dba&&f===w.a.MO||this.Lb.Dba&&f===w.a.mR||f===w.a.Ew;this.Pi.updateCaretPosition(this.kf.mode,this.Lb.Fi);this.rd.Aj&&(c.ctrlKey||c.altKey)&&f!==w.a.tod&&f!==w.a.wKa&&f!==w.a.bjb&&f!==w.a.qpd&&this.QLa.DJc();return this.zoj(a)}zoj(a){var b=a.mc.keyCode;const c=b===w.a.Una,f=b===w.a.wH;let l=!1,x=!1,G=!1;switch(b){case w.a.Ew:case w.a.zE:G=!0;u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordBrowserHandledNavigationSettings");b=this.eb.ka("BrowserHandledNavigationIsEnabled");
a.mc.altKey||a.mc.ctrlKey||a.mc.shiftKey||this.rd.lk||!b&&this.rd.Nj||(x=!0);break;case w.a.mR:case w.a.MO:G=!0;this.rd.lk&&this.Jm.Wcg(a.mc.rawEvent)&&!a.mc.altKey&&!a.mc.shiftKey?x=!0:this.rd.Aj&&this.oYa?a.mc.altKey||a.mc.ctrlKey||a.mc.shiftKey||(x=!0):l=!0;this.eb&&this.eb.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&this.kf.ZIa(!0);break;case w.a.$0:case w.a.Y0:G=!0;this.rd.Aj&&this.oYa?x=this.mnj(a):l=!0;this.eb&&this.eb.ka("EditSurfaceKeyboardNavImprovementsIsEnabled")&&(this.ef.yVc(this.r2a.kb)||
this.ef.EIa(),this.kf.ZIa(!0));break;case w.a.Una:case w.a.wH:if(!this.Ek.value.isEditingAllowed&&this.Ek.value.My)l=!0;else if(this.bnj(a,c,f))return!0;break;case w.a.sFh:this.hd.Tb("InsertKeyPressed");l=!0;break;default:if(a.mc.keyCode===w.a.qpd||a.mc.keyCode===w.a.yod||this.rd.EJd)this.Rr.isComposing=!0,this.enb||this.kf.x$(!0)}(this.Dk.b2&&!f||this.Dk.Vqa&&!c)&&this.AH.Cs(!0);2!==this.kf.mode&&(G=x=!1);a.eventName===ma.a.bOa&&this.pp.oHk(a,this.Rr.isComposing,G);x&&(this.Cga.value.Yv(),this.CB.FNa(a));
l&&Ed.a.ln(a.mc);return x}l5d(a){return u.AFrameworkApplication.fa.ka("PPTOTextPredictionIsEnabled")?Ac.a.l5d(a,this.r2a.A_b):!1}cnj(a){const b=this.r2a.A_b;var c=b.node;const f=b.Qa,l=yb.ParagraphReader.text(c);let x=!1;if(a){if(f<yb.ParagraphReader.textLength(c)){a=this.rk.ke(15);try{a.gd(c),c=f+1,Ka.a.Xw(l,c)&&c++,this.jn.$Cb(b,null),this.Ca.processAction(E.a.rightArrow,2)}finally{a&&a.dispose()}x=!0}}else if(0<f){a=this.rk.ke(15);try{a.gd(c),c=f-1,Ka.a.Xw(l,c)&&c--,this.jn.$Cb(b,null),this.Ca.processAction(E.a.leftArrow,
2)}finally{a&&a.dispose()}x=!0}return x}kej(a){return vb.a.Ls(a.Ua).cache.fontSize}mnj(a){var b=!1;if(!(a.mc.altKey||a.mc.ctrlKey||a.mc.shiftKey||(a=Ie.f(this.Lb.Ag),Qa.a.any(a,c=>5===c.Lq||8===c.Lq)))){if(this.jd.yg&&this.iP.Dwb(this.jd.yg.Hn))return!1;this.CB.Oib&&this.CB.typingProcess();b=this.JY.Yra(this.Zfa.r8);a=this.ef.Hha(b);a=this.Lb.Dba?a.x+a.width:a.x;-1===this.ef.pz?(this.ef.pz=a,b=!0):b=Math.abs(this.ef.pz-a)<=this.kej(b)}return b}bnj(a,b,c){if(!a.mc.altKey&&!a.mc.ctrlKey&&!a.mc.shiftKey&&
(this.fj&&this.Dk.b2&&this.sR.qnd()&&this.AH.Cs(!1),this.aKh.isl(b,this.Lb.Rh,this.Lb.$Oa,this.Lb.Ag,this.Zfa.r8,this.Lb.NV.Fi,this.AH.hfi))){if(this.Xc.ag&&this.Xc.By)return(b=this.cnj(b))&&Ed.a.ln(a.mc),b;const f=this.hd.Kp(E.a.yLd);this.Ioc&&this.Ioc.yTj();const l=new Gb(a,c,b);this.$Jh.wGk(l);(c&&!this.Dk.b2||b&&!this.Dk.Vqa)&&this.AH.Cs(!1);H.a.instance.ga(50)&&this.Poa.value&&this.Poa.value.Zv&&this.Qc.ATb();ya.a.kXb(this.Lb.Rh.Fi,this.Lb.NV.Fi);this.CB.FNa(a);this.ef.EIa();this.kf.x$(!0);this.Dk.Vqa=
b;this.Dk.b2=c;this.Dk.b2&&-1===this.Dk.mGc?this.Dk.mGc=this.AH.ZPc:this.Dk.Vqa&&-1===this.Dk.Fld&&(this.Dk.Fld=ya.a.fv(this.Lb.$Oa).length);f.end();return!0}return!1}Lz(a,b,c){const f=this.aTd;try{f&&f.keyDownEventHandlerStart(a.mc.rawEvent);0===this.kf.mode&&a.mc.keyCode!==w.a.lq&&1!==this.Ca.mode&&this.YYj(this.kf,a.eventName);if(!b||!this.Yg)return!1;(a.mc.keyCode!==w.a.bjb||this.pkb.pIc)&&this.Ek.value.kr.YM();if(!this.Bal(a)){const G=new jc(!0);this.cpa.NGk(G)}if(!this.kf.isActive)return!1;
this.Dk.Bde=(new Date).getTime();const l=this.hd.Kp(E.a.typing);l.properties.$(Dd.a.source,"KeyDown");l.properties.$(Dd.a.u6g,"KeyDown");const x=this.sTj(a,c);x&&Ed.a.sli(a.mc);l.end();return x}finally{f&&f.keyDownEventHandlerEnd(a.mc.rawEvent)}}Bal(a){switch(a.mc.keyCode){case w.a.Hfa:case w.a.rFh:case w.a.P5:case w.a.vY:case w.a.V$:case w.a.Ifa:case w.a.yod:case w.a.zod:return!0}return!1}YYj(a,b){b={["EventName"]:b};u.AFrameworkApplication.Aa&&(b.Mode=u.AFrameworkApplication.Aa.mode);if(a)if(b.Trigger=
a.XWc,b.TriggeredTime=a.XTj,this.sPb.Jb(a.XWc)){let c,f;(c=this.sPb).$(f=a.XWc,c.ga(f)+1)}else this.sPb.$(a.XWc,1);b.Msg="BadEditSurfaceState";this.nYe?Z.ULS.sendTraceTag(18437408,323,50,"{0}",b):(Z.ULS.shipAssertTag(18437408,323,!1,"{0}",b),u.AFrameworkApplication.ofa(()=>{this.ZYj()}));this.nYe=!0}ZYj(){if(!this.Q$e){var a="";for(let b of this.sPb.keys)a+=" Trigger "+b+" - "+this.sPb.ga(b)+",";Z.ULS.sendTraceTag(50421966,323,10,"Total keyinput lost in UnknownMode:"+a);this.Q$e=!0}}znk(a,b){this.fj&&
this.gK.ngb(this.kf.mode,this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My);if(this.Xc.ag&&(A.KeyInputManager.RQc(a.mc)===A.KeyInputManager.Na(w.a.sya,A.KeyInputManager.He)||A.KeyInputManager.RQc(a.mc)===A.KeyInputManager.Na(w.a.gqc,A.KeyInputManager.He))&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&(u.AFrameworkApplication.rO||u.AFrameworkApplication.lJ)&&!u.AFrameworkApplication.KPa)return Ed.a.ln(a.mc),
!0;const c=this.r2a.A_b,f=c.node;if(a.mc.keyCode===w.a.lq){if(db.EmbeddedFileReader.eNj(f))return Ed.a.ln(a.mc),!0;if(W.ImageReader.LG(f)||!db.EmbeddedFileReader.T8a(f))if(W.ImageReader.LG(f)||W.ImageReader.VDa(c))return u.AFrameworkApplication.Ta.ki(c,E.a.cB,2,!1,null,null),Ed.a.ln(a.mc),!0}switch(a.mc.keyCode){case w.a.qpd:case w.a.yod:if({X2:a,PIb:b}=this.hV.AAh(a,b),a)return b}return!1}efe(a){u.AFrameworkApplication.Ta.processAction(a,2)}}xa.Bml=2E3;Object(e.a)(xa,"KeyDownProcessor",null,[]);
class da{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc){this.Oo=a;this.Lb=b;this.$f=c;this.hd=f;this.fj=l;this.ZC=x;this.AH=G;this.sR=R;this.xh=fa;this.Pi=wa;this.JY=Wa;this.QU=mb;this.ef=Kb;this.Dk=nc;this.kf=oc}get Kze(){return this.Oo.lI(this.Lb.Fi,this.$f,this.hd,this.fj)-(this.ZC.y6?1:0)-this.Oo.lI(this.Lb.Fi.lastChild,this.$f,this.hd,this.fj)}mDk(a,b){switch(b.keyCode){case w.a.zE:case w.a.mR:if(this.Ouj(a,b))return!0;break;case w.a.Ew:case w.a.MO:if(this.TMi(a,b))return!0;break;case w.a.$0:case w.a.Y0:if(this.Tul(a,
b))return!0;break;case w.a.wH:if(this.tdi())return!0}return!1}tdi(){return this.Dk.b2&&this.sR.qnd()?(this.AH.Cs(!1,!0),!0):!1}Tul(a,b){a.vTc=!0;var c=this.Kze;const f=this.Pi.z7(this.xh.mode,this.Lb.Fi);f>=c&&(this.Pi.uS(c,this.Lb.Rh),a.kb=this.JY.Yra(this.QU.r8));if(f===b.mYb)a.e5a=b.keyCode===w.a.vY?1:3;else{if(f<c&&Ka.a.Oy(this.Oo.K9f(this.Lb.Rh,f-1,this.hd,this.$f,this.fj))){c=this.ef.Gra(a.kb,!1,!1,!1,!0);c=this.ef.Hha(c);var l=a.kb.Ua;a=this.ef.Hha(a.kb);l=vb.a.Ls(l);a.y>c.y&&Math.abs(a.x-
this.ef.pz)>2*l.cache.fontSize&&this.Pi.uS(f-1,this.Lb.Rh)}this.kf.ZIa(!0);this.QU.fixupAfterCursor(b.keyCode===w.a.vY?1:3);this.AH.bTd();return!0}return!1}TMi(a,b){a.vTc=!0;const c=this.Kze;this.ef.EIa();const f=this.Pi.z7(this.xh.mode,this.Lb.Fi);f>=c&&(this.Pi.uS(c,this.Lb.Rh),a.kb=this.JY.Yra(this.QU.r8));if(b.keyCode===w.a.MO&&(b.mYb>=c&&!this.Lb.Dba||b.mYb===this.QU.Wuh&&this.Lb.Dba))a.e5a=2;else return this.kf.ZIa(!0),b.keyCode===w.a.Ew&&f<c&&Ka.a.Oy(this.Oo.K9f(this.Lb.Rh,f-1,this.hd,this.$f,
this.fj))&&this.Pi.uS(f-1,this.Lb.Rh),this.QU.fixupAfterCursor(this.Lb.Dba?4:2),this.AH.bTd(),!0;return!1}Ouj(a,b){a.vTc=!0;const c=this.Kze;this.ef.EIa();if(b.keyCode===w.a.mR&&(b.mYb===this.QU.Wuh&&!this.Lb.Dba||b.mYb>=c&&this.Lb.Dba))a.e5a=4;else return this.kf.ZIa(!0),this.QU.fixupAfterCursor(this.Lb.Dba?2:4),this.AH.bTd(),!0;return!1}}Object(e.a)(da,"KeyEntryProcessor",null,[]);var Fa=d(1172),Ua=d(129),cb=d(42);class Jb{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,
Qf,mg,Xg,Mg,Sf){this.Eya=this.Bsf=null;this.rd=a;this.Jm=b;this.hd=c;this.Vga=f;this.Ek=l;this.hV=x;this.k6=G;this.Rr=R;this.kf=fa;this.Qc=wa;this.jd=Wa;this.Tsc=mb;this.Pi=Kb;this.Sfa=nc;this.Oo=oc;this.Lb=Ic;this.Zfa=Kc;this.Ch=Hc;this.Poa=ie;this.pp=He;this.CB=fe;this.iaa=Te;this.eAa=We;this.yYh=Qf;this.aga=mg;this.Xc=Xg;this.Ro=Mg;this.xNb=Sf}get Ioc(){return this.eAa&&this.eAa.instance?this.eAa.instance.xAh():null}get I9a(){return this.Xc.ag&&this.Xc.By}get nZ(){return this.Eya||(this.Eya=fb.a.instance.qb("Box4.IClipboardCommands"))}get aTd(){return this.xNb||
(this.xNb=fb.a.instance.qb("Common.IEventTimingMeter"))}R9a(a,b){if(!b)return!1;b=this.aTd;try{b&&b.keyPressedEventHandlerStart(a.mc.rawEvent);if(this.rd.tF&&this.rd.lk&&this.Jm.Wcg(a.mc.rawEvent))return!1;this.Ioc&&!A.KeyInputManager.lwg(a)&&this.Ioc.yTj();const c=this.hd.Kp(E.a.typing);c.properties.$(Dd.a.source,"KeyPress");const f=this.xTj(a);c.end();return f}finally{b&&b.keyPressedEventHandlerEnd(a.mc.rawEvent)}}Urj(){if((this.yYh||this.I9a)&&this.aga.Y1(this.Qc.Kj,14)){var a=Object(ua.a)(Fa.a,
this.aga.a0b(this.Qc.Kj,16,!1));if(a&&1<a.length){const b=[],c=this.Qc.Oa.ga(0);a=a.getContext(0).node;for(let f=0;f<c.length;++f){const l=c.ga(f).node;if(!nb.GraphIterator.mb(l).N$(a))break;Array.add(b,c.ga(f))}0<b.length&&this.Qc.setSelection(new Ua.Selection(b,!0))}}}qHk(a,b){if(1===this.kf.mode)return!1;this.pp.mEe(a,this.Rr.isComposing);let c;(c=this.CB).DWc=c.DWc+1;r.a.io||Cb.App.XLd&&r.a.hwh||(this.CB.lrh(this.Rr.kEa)||this.CB.FNa(a),this.kf.x$(!0));this.Rr.isComposing&&H.a.instance.ga(50)&&
this.Poa.value&&this.Poa.value.Zv&&this.Qc.ATb();this.Ch.IAc="";0<this.Ch.Bi.length&&(this.rd.eg||" "===b)&&(this.Ch.IAc=ya.a.fv(this.Ch.Bi[0].aF));this.iaa.raiseEvent(Qe.a.qde,a);this.Tsc.hzh();return!1}QJi(a){let b=!1;this.Rr.kEa&&this.Sfa.XUb.instance&&(" "===a&&this.Oo.iMi(this.Lb.Fi,this.Pi.z7(this.kf.mode,this.Lb.Fi))&&(b=!!this.Sfa.Hte(this.Rr.kEa,this.Zfa.r8)),!b&&this.Sfa.XUb.instance.BRj(a)&&this.Sfa.PJi(a,this.Zfa.r8))}Boj(a){if(1!==this.kf.mode||(this.rd.Aj||this.rd.io)&&a.mc.ctrlKey&&
!a.mc.altKey||this.rd.Fja&&a.mc.charCode===w.a.Z0)return!1;if(this.hV.X$c(a))return!0;var b=this.hV.gNe();const c=this.hV.Eal();if(b||c||!this.k6.CNe())return b&&!c&&this.Qc.setSelection(rd.SelectionFactory.Mg(this.Qc.Oa.kb.Ua.node,this.Qc.Oa.kb.Ua.Qa)),b=this.U8a(),this.Urj(),this.nZ&&(this.nZ.N5g(String.fromCharCode(a.mc.charCode),b),this.iaa.raiseEvent(Qe.a.qde,a)),Ed.a.ln(a.mc),!0;if(this.hV.sze(a))return!0;if(this.I9a){b=this.Xc.cpb();try{this.pp.mEe(a,this.Rr.isComposing),this.rd.io&&this.nZ?
(this.nZ.N5g(String.fromCharCode(a.mc.charCode)),Ed.a.ln(a.mc)):(this.CB.FNa(a),this.kf.x$(!0))}finally{b&&b.dispose()}}else this.k6.startHybridTransition(),this.pp.mEe(a,this.Rr.isComposing),this.CB.FNa(a),this.kf.x$(!0);this.iaa.raiseEvent(Qe.a.qde,a);this.Tsc.hzh();return!1}U8a(){if(this.Qc&&this.Qc.Oa&&this.Qc.Oa.kb){const a=this.Qc.Oa.kb;return cb.SelectionEditor.Ll(a.ga(a.length-1))||a.ga(a.length-1).contextId===Bb.a.paragraph}return!1}xTj(a){this.Vga.fixupAfterMagnifierDrag();if(!(this.Ek.value.isEditingAllowed||
this.Ek.value.My&&this.I9a))return Ed.a.ln(a.mc),!0;if(this.hV.Z$c(a))return!1;if(1===this.kf.mode)return this.Boj(a);this.jd.fm().scrollTop=0;this.rd.eg&&this.kf.W0b(this.Lb.Ag)&&" "===this.Bsf&&this.CB.typingProcess();const b=Ka.a.charAt(Ka.a.fromCharCode(a.mc.charCode),0);this.Bsf=b;this.Rr.isComposing||(A.KeyInputManager.lwg(a)&&(this.Rr.isComposing=!0),this.Pi.gJk&&(this.Rr.isComposing=!0));this.QJi(b);if(this.rd.eg&&!this.rd.lk){const c=a.mc;if(c.ctrlKey&&122===this.Jm.J9f(c)||c.ctrlKey&&121===
this.Jm.J9f(c))return!0}return this.qHk(a,b)}}Object(e.a)(Jb,"KeyPressProcessor",null,[]);class Gc{constructor(a,b){this.Ui=a;this.keyCode=this.Ui.mc.keyCode;this.mYb=b}get etj(){return!(void 0===this.keyCode||null===this.keyCode)}}Object(e.a)(Gc,"KeyQueueEntry",null,[]);class pd{constructor(a,b,c,f,l,x,G){this.tPb=[];this.Wga=null;this.rRh=a;this.kf=b;this.Lb=c;this.ef=f;this.Qc=l;this.AH=x;this.Pi=G}get oYa(){return this.Wga||(this.Wga=fb.a.instance.qb("Box4.ISelectionCommands"))}p8g(a){let b=-1;
if(A.KeyInputManager.Gwg(a.eventName)&&2===this.kf.mode)switch(a.mc.keyCode){case w.a.zE:case w.a.Ew:case w.a.mR:case w.a.MO:case w.a.$0:case w.a.Y0:H.a.instance.ga(45)&&this.kf.W0b(this.Lb.Ag)&&this.AH.Cs(!1,!1);qf.GrippersManager.instance.SRa();b=this.Pi.z7(this.kf.mode,this.Lb.Fi);break;default:qf.GrippersManager.instance.restoreAfterCursoring()}Array.add(this.tPb,new Gc(a,b))}nDk(a){for(;0<this.tPb.length;){const b=this.tPb[0];Array.removeAt(this.tPb,0);const c=A.KeyInputManager.Gwg(b.Ui.eventName);
if(!(c&&(b.Ui.mc.altKey||b.Ui.mc.ctrlKey||b.Ui.mc.shiftKey)||this.tPb.length)){if(c)if(b.etj){if(this.rRh.mDk(a,b))return!0}else this.ef.EIa();if(this.Lsl(a))return!0}}return!1}Lsl(a){if(5!==a.e5a){if(this.kf.icg(this.Lb.Ag))if(1===a.e5a||3===a.e5a){const b=this.ef.pz;this.Qc.setSelection(a.kb);this.ef.pz=b}else this.Qc.setSelection(a.kb);this.oYa.Sfk(a.e5a);if(2!==this.kf.mode)return!0}return!1}}Object(e.a)(pd,"KeyQueueProcessor",null,[]);class Ld{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){this.Wga=
null;this.hd=a;this.gK=b;this.xh=c;this.Rr=f;this.Lb=l;this.Ek=x;this.xga=G;this.Ds=R;this.cvc=fa;this.jd=wa;this.pkb=Wa;this.CB=mb}get oYa(){return this.Wga||(this.Wga=fb.a.instance.qb("Box4.ISelectionCommands"))}tEa(a,b){if(!b)return!1;b=this.hd.Kp(E.a.typing);b.properties.$(Dd.a.source,"KeyUp");a=this.ATj(a);b.end();return a}ATj(a){a.mc.keyCode===w.a.bjb&&(this.pkb.pIc=!0);a.mc.ctrlKey&&this.gK.pYf(this.xh.mode,qd.a.instance.Oa,this.oYa,this.Lb.Rh,this.Lb.Fi,this.Lb.Ag,this.Ek.value.isEditingAllowed||
this.Ek.value.My);this.Rr.isComposing&&(this.xga.rCb(),this.Ds.lY());this.CB.lrh(this.Rr.kEa)&&(this.cvc.p8g(a),this.CB.Oib=!0,this.CB.typingProcess());this.jd.fm().scrollTop=0;return!1}}Object(e.a)(Ld,"KeyUpProcessor",null,[]);class de{constructor(a){this.Trd=this.Cqd=this.YF=null;this.Rd=a}get W6(){return this.YF||(this.YF=fb.a.instance.resolve("Common.Utils.IAriaNotifier"))}qik(a){a&&(this.Trd=a,this.Cqd=new xe.a(2,1,500,Object(C.a)(this,this.tryAriaNotifyParagraphLockedTask,"tryAriaNotifyParagraphLockedTask"),
29),this.Rd.Cb(this.Cqd))}tryAriaNotifyParagraphLockedTask(a){this.Trd&&a&&this.Cqd===a&&this.W6.sendNotification(String.format(Box4Intl.Box4Strings.l_ScreenReaderBlockEditing,this.Trd),!0)}}Object(e.a)(de,"LockedParagraphAriaNotifier",null,[]);class Be{constructor(a){this.AH=a}lostFocus(a,b){u.AFrameworkApplication.Vg||b&&this.AH.Cs(!0,!1)}}Object(e.a)(Be,"LostFocusEventProcessor",null,[]);class Mf{constructor(a,b,c,f){this.$f=a;this.xh=b;this.xga=c;this.Ds=f}onScroll(a,b,c){b&&(c.scrollLeft||c.scrollTop)&&
(this.$f.h++,c.scrollLeft=0,c.scrollTop=0,2===this.xh.mode&&(this.xga.rCb(),this.Ds.lY()))}}Object(e.a)(Mf,"OnScrollProcessor",null,[]);var Dg=d(1079);class yd{constructor(a,b,c,f){this.html=a;this.text=b;this.Lnl=c;this.cQd=f}dispose(){this.cQd=null}}Object(e.a)(yd,"OriginalElementContent",null,[106]);class td{constructor(a,b,c){this.AQb=[];this.P3e=0;this.hd=a;this.UR=b;this.Oo=c}get UVd(){return this.P3e}get k4g(){return this.AQb}SPf(){for(let a=0;a<this.AQb.length;a++)this.AQb[a]&&(this.AQb[a].dispose(),
this.AQb[a]=null)}hvh(a){this.SPf();a=a.Ts;for(let c=0;c<a.length;c++){const f=a[c];var b=!1;f.parentNode&&f.parentNode.parentNode&&(b=Sys.UI.DomElement.containsCssClass(f.parentNode.parentNode,hc.a.eXd));if(b||Sys.UI.DomElement.containsCssClass(f,hc.a.MM)||Sys.UI.DomElement.containsCssClass(f,X.a.yV)||Sys.UI.DomElement.containsCssClass(f,hc.a.aN)){let l=b=null,x=null;1===f.childNodes.length&&3===f.firstChild.nodeType?b=ya.a.fv(f):(l=this.Oo.L_d(f,this.hd,this.UR),x=new Dg.a(f));this.k4g[c]=new yd(f.innerHTML,
b,l,x)}Sys.UI.DomElement.containsCssClass(f,hc.a.aN)&&(this.P3e=ya.a.W6a(f))}}}Object(e.a)(td,"OriginalElementContentArray",null,[1418]);class id{constructor(a,b,c,f,l,x,G){this.Ch=a;this.$f=l;this.hd=f;this.fj=G;this.ZC=b;this.Qc=c;this.Oo=x}iVi(a,b,c){var f=this.Qc.Oa.kb.Ua;const l=f.Qa;f=f.Kb;let x=0,G=0;a=a.Ts;Array.clear(this.Ch.Bi);for(let Wa=0;Wa<a.length;Wa++){var R=a[Wa],fa=this.Oo.lI(R,this.$f,this.hd,this.fj);if(Sys.UI.DomElement.containsCssClass(R,hc.a.MM))G<l?x+=fa:G<f&&(fa=Ie.d(b,G))&&
!fa.QAa&&(fa=K.a.te(R,X.a.xEa),Array.add(this.Ch.Bi,new qi(R,c.Ts[fa],x,G,1))),G++;else if(Sys.UI.DomElement.containsCssClass(R,X.a.yV))x+=fa;else if(!Sys.UI.DomElement.containsCssClass(R,hc.a.aN)){if(G+fa>=l&&G<=f){let mb=K.a.te(R,X.a.xEa);var wa=c.Ts[mb];Sys.UI.DomElement.removeCssClass(wa,hc.a.h7);Array.add(this.Ch.Bi,new qi(R,wa,x,G,fa-(this.ZC.y6?1:0)));for(R=this.Oo.lI(wa,this.$f,this.hd,this.fj);R<fa&&!(mb+1>=c.Ts.length);)wa=c.Ts[mb+1],R+=this.Oo.lI(wa,this.$f,this.hd,this.fj),wa.parentNode.removeChild(wa),
Array.removeAt(c.Ts,mb+1)}else if(G>f)break;x+=fa;G+=fa}}}}Object(e.a)(id,"OvertypeDomPreparer",null,[]);var ed=d(120),Oc=d(59);class Wl{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic){this.aBd=!1;this.Eya=null;this.XRh=a;this.xh=b;this.rd=c;this.Qc=f;this.Ipa=l;this.ef=x;this.Ek=G;this.If=R;this.Rr=fa;this.k6=wa;this.fj=Wa;this.Lb=mb;this.gK=Kb;this.CB=nc;this.Xc=oc;this.Ro=Ic}get nZ(){return this.Eya||(this.Eya=fb.a.instance.qb("Box4.IClipboardCommands"))}Esl(){return 1===this.xh.mode?(this.aBd&&
this.rd.eg&&this.FLd(),this.aBd=!1,!0):!1}FLd(){if(this.nZ){const a=new D.DictionaryPropertySet;a.setValue(Oc.a.bU,"<span></span>");this.nZ.tqa(null,a,!1)}}sze(a){const b=this.Qc.Gna;return b.Rce||b.fbe?(Ed.a.ln(a.mc),this.Ipa.Mjc(E.a.Stk),!0):!1}X$c(a){if(!this.ef.Isa(qd.a.instance.Oa.kb))return!1;Ed.a.ln(a.mc);this.Ipa.Mjc(E.a.X$c);return!0}Z$c(a){if(!H.a.instance.ga(14))return!1;var b=qd.a.instance.Oa.ga(0);if(!ed.a.instance.x0k(b))return!1;b=this.ef.spc(qd.a.instance.Oa);this.XRh.qik(b);Ed.a.ln(a.mc);
this.Ipa.Mjc(2===this.xh.mode?E.a.utl:E.a.Z$c);return!0}AAh(a,b){let c,f;f=c=!1;if(!this.Ek.value.isEditingAllowed)return Ed.a.ln(a.mc),{X2:!0,PIb:!0};if(!b)return{X2:!0,PIb:!0};if(this.X$c(a)||this.If.Nd.Gb.Oa.MG&&a.mc.type===ma.a.DPd)return{X2:!0,PIb:f};this.Rr.isComposing=!0;b=this.gNe();if(!b&&this.k6.CNe()){if(this.sze(a))return{X2:!0,PIb:f};this.fj&&this.gK.ngb(this.xh.mode,this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My);this.Xc.ag&&this.Xc.By?(Ed.a.ln(a.mc),
f=c=!0):this.k6.startHybridTransition()}else b&&this.Qc.setSelection(rd.SelectionFactory.Mg(qd.a.instance.Oa.kb.Ua.node,qd.a.instance.Oa.kb.Ua.Qa)),this.Qc.Gna.Opb(),this.Xc.ag&&this.Xc.By?(Ed.a.ln(a.mc),f=c=!0):this.rd.eg?(this.aBd=!0,this.CB.FNa(a),c=!0):(this.FLd(),Ed.a.ln(a.mc));return{X2:c,PIb:f}}gNe(){if(!this.Qc.Oa.Oca)return!1;var a=qd.a.instance.Oa.kb.Ua;return a.Qa!==a.Kb-1?!1:(a=Ie.d(a.node,a.Qa))&&5===a.Lq?!0:!1}Eal(){if(!this.Qc.Oa.Oca)return!1;const a=this.Qc.Oa.kb.Ua;return!Ie.d(a.node,
a.Kb)||0<a.Qa&&!Ie.d(a.node,a.Qa-1)||a.Qa===a.Kb?!1:!0}}Object(e.a)(Wl,"OvertypeUtils",null,[]);class Wh{constructor(a,b,c,f,l,x){this.c0a=null;this.jd=a;this.JLh=b;this.If=c;this.xh=f;this.Lb=l;this.MAd=x}get NSf(){return this.JLh}wVe(){if(2===this.xh.mode&&this.If.Nd.$o&&this.Lb.eTa(this.xh.mode)){var a=this.Lb.Rh,b=this.NSf.S1d(a.$a);this.MAd.egh(b,this.c0a,a,this.jd.yg.du,!1,!0);this.c0a=b}}}Object(e.a)(Wh,"ParagraphOverlayPositioner",null,[]);class ik{constructor(a,b){this.kwk=this.location=
null;this.jv=a;this.isRtl=b}}Object(e.a)(ik,"OnShowFloatieEventArgs",null,[]);class Vj{constructor(){this.type=0;this.payload=this.nze=null;this.jXc=!1;this.BOa=this.style=this.ICe=null}}Object(e.a)(Vj,"PasteDataContext",null,[]);class Zm{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg){this.dBd=this.Zif=this.Bn=null;this.QDd=Xg;this.upa=Mg;this.Xif=a.ka("PasteClipboardImageInChromeIsEnabled");this.iUh=a.ka("PasteFromPlainTextKeepEmptyLinesIsEnabled");this.bCd=
a.ka("ReadImageBlobForIE11UpIsEnabled");this.YKh=a.Cc("ClipboardDataImageBlobLimitaton",10);this.dSb=a.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.dxf=a.ka("PasteInBootLoadingUIIsEnabled");this.VDd=a.ka("ParseStyleFromRawHtmlHeadIsEnabled");this.Rd=b;this.hd=c;this.rk=f;this.Qc=l;this.xh=x;this.jd=G;this.s1=R;this.If=fa;this.rd=wa;this.gK=Wa;this.Lb=mb;this.Sfa=Kb;this.Ek=nc;this.Eya=oc;this.Xj=Ic;this.nMh=Hc;this.iNa=ie;this.KR=He;this.Ca=fe;this.Pfa=Te;this.epa=We;this.cpa=
Qf;this.bAa=mg;this.u_e=[Object(C.a)(this,this.ywj,"imageClipboardDataHandler"),Object(C.a)(this,this.Hxk,"plainTextClipboardDataHandler"),Object(C.a)(this,this.nvj,"htmlClipboardDataHandler")]}get nZ(){return this.Eya.instance}get NHa(){return this.dBd}Waj(a){switch(a){case "image/png":a=1;break;case "text/plain":a=2;break;case "text/html":a=3;break;default:a=0}return a}get pXh(){return this.VDd||this.dSb}Foj(a){const b=new Vj;b.type=this.Waj(a.type);b.payload=a.data;b.jXc=!0;this.sjh(b)}t8g(a,b){this.Qc.Gna.Opb();
this.xh.v$(0,!0,13);this.jd.wYa(!0);const c=this.jd.yg.du.style;c.display="block";a&&(b=c.overflow,c.overflow="hidden");this.s1.HBk();this.If.Nd.oya();this.rd.dta?this.gK.MIa(this.xh.mode,this.Lb.Fi,this.Lb.Ag,this.Lb.Rh,this.Ek.value.isEditingAllowed||this.Ek.value.My):this.s1.REc();return b}iih(a){this.jd.yg.du.style.overflow=a}handlePaste(a,b,c){if(!c&&!this.NHa&&!this.Rd.$v)if(this.nZ||this.dxf){this.Sfa.UQ&&(this.Sfa.UQ=null);this.dBd=this.rk.ke(3);this.NHa.gd(b);b=new Vj;b.BOa=this.bAa.KPe();
b.BOa.rCc("pasteHandler");b.jXc=!1;b.nze=this.t8g(this.KR.bjd,b.nze);if(c=this.Xj.bca(a)){this.pXh&&this.zvk(c,b);for(let f=0;f<this.u_e.length&&this.u_e[f](a,c,b);++f);}this.upa&&a.preventDefault();u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacLoadingPasteBootUISettings");!this.nZ&&this.dxf?this.sjh(b):this.rjh(b)}else Z.ULS.sendTraceTag(3994320,307,50,"Clipboard command not available"),this.hd.Tb(Nd.a.vh,{["Reason"]:Od.a.yXf}),this.Ca.cfe(E.a.tqa),a.preventDefault()}sjh(a){Z.ULS.sendTraceTag(24492118,
307,50,"Clipboard commands unavailable. Loading Paste dialog is showing.");this.wna();this.Pfa.gk(6,()=>{this.ZIi(a)})}wna(){this.Bn=this.epa();this.Bn.qr=!1;this.Bn.yd=5;this.Bn.wna(null,null,null)}ZIi(a){this.Bn&&(this.Bn.close(),this.Bn=null);Z.ULS.sendTraceTag(24492119,307,50,"Clipboard commands available. Dismissing progress dialog.");this.rjh(a)}rjh(a){a=this.nMh.create(null,Object(C.a)(this,this.dKi,"doPasteOperation"),a);a.Fl("Browser Pasted (Editing Surface)");a.run()}ywj(a,b,c){if((this.Xif||
this.bCd)&&(b=this.Xj.d_d(a.rawEvent))&&this.Xj.mod(this.jd.fm())){let f=null;if(({H3b:f}=this.Xj.Pmd(b,this.YKh,this.KR.ndc)).returnValue)return c.type=1,c.payload=f,this.bCd&&this.rd.oW&&a.preventDefault(),!1}return!0}Hxk(a,b,c){return this.iUh&&this.Xj.QMj(b)&&(a=this.Xj.f2d(b))?(c.type=2,c.payload=a,!1):!0}nvj(a,b,c){return this.QDd&&(a=this.Xj.Q0b(b))?(c.type=3,c.payload=a,this.VDd&&c.style&&(c.payload+=c.style),!1):!0}dKi(a,b){var c=this.jd.yg.du.style;b&&this.KR.bjd&&"hidden"===c.overflow&&
this.iih(b.nze);if(c=this.jd.fm()){if(this.rd.mta)for(var f=c.firstChild;f&&1===c.childNodes.length&&Qc.a(f);)c=f,f=f.firstChild;if(b&&(this.Xif||this.bCd)&&1===b.type&&this.Xj.mod(c)&&(f=b.payload)){this.Zif=a;this.KR.hXb(f,l=>{this.VZf(this.Zif,l,b)});return}this.VZf(a,this.jd.Xaj(c),b)}}bCf(a){a=this.iNa.create(a,Object(C.a)(this,this.Hxh,"teardownPaste"),null);a.Fl("Aborting Paste in ContentEditableView");a.run()}VZf(a,b,c){this.rd.Aj&&(ya.a.ku(this.jd.fm()),this.rd.Fja||this.jd.yg.Nma());if(this.upa&&
!c)Z.ULS.sendTraceTag(541172694,307,10,"No pasteDataContext"),this.bCf(a);else{c.jXc&&(b="",1!==c.type&&(b=c.payload));var f=!b&&!c.jXc;this.upa&&(f=!c.payload&&f);f?(Z.ULS.sendTraceTag(18437454,307,15,""),this.bCf(a)):(c.style&&(b+=c.style),this.jd.wYa(!0),f=new D.DictionaryPropertySet,f.setValue(Oc.a.bU,b),f.setValue(Mb.a.wae,!0),f.setValue(tb.a.vN,!0),1===c.type&&this.KR.Vlc?f.setValue(Oc.a.ERc,b):2===c.type&&c.payload?f.setValue(Oc.a.veb,c.payload):3===c.type&&c.payload&&(this.upa?f.setValue(Oc.a.bU,
c.payload):f.setValue(Oc.a.$ze,c.payload)),this.dSb&&c.ICe&&f.setValue(Oc.a.b6g,c.ICe),c.BOa&&f.setValue(Oc.a.BOa,c.BOa),a=this.iNa.create(a,Object(C.a)(this,this.Cki,"callPasteAction"),f),a.Fl("Paste in ContentEditableView"),a.run())}}Cki(a,b){this.nZ.tqa(a,b,!0);a.Zg(Object(C.a)(this,this.Hxh,"teardownPaste"));return!0}Hxh(a){this.xh.uZa();this.NHa&&(this.NHa.oU(a),this.NHa.dispose(),this.dBd=null);a.Zg(Object(C.a)(this,this.Dki,"callPasteFloatie"));return!0}Dki(a,b){a=Object(ua.a)(D.DictionaryPropertySet,
b);if(!a||a.sa(Oc.a.veb,null)||a.sa(Oc.a.ERc,null))return!1;b=new ik(1,u.AFrameworkApplication.isRtl);b.kwk=a.sa(Oc.a.bU,null);this.cpa.FIk(b);return!1}zvk(a,b){if(a=this.Xj.v3f(a)){u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordGatherMetadataAboutPastedHTMLContentSettings");if(this.dSb){let c=this.Xj.w3f(a);null===c?c="inaccessible":""===c&&(c="unknown");b.ICe=c}this.VDd&&(b.style=this.Xj.JQi(a))}}}Object(e.a)(Zm,"PasteHandler",null,[1417]);class Ok{constructor(a,b,c,f,
l){this.Wgf=new Ee.a(RegExp("\u00a0","g")," ");this.szf=new Ee.a(new RegExp("["+Za.AKf+Za.Lng+"]","g"),"");this.hd=a;this.$f=b;this.Pi=c;this.Oo=f;this.rd=l}zoi(a,b,c,f,l){if(l){l=!1;for(let fa=0;fa<a.length;++fa){const wa=b.k4g[fa];if(!wa)continue;const Wa=a[fa];var x=Wa.innerHTML,G=wa.html;if(x.length===G.length||x===G)continue;if(pf.yUc(Wa))continue;l=!0;x=Sys.UI.DomElement.containsCssClass(Wa,X.a.yV);G=Sys.UI.DomElement.containsCssClass(Wa,hc.a.MM);const mb=Sys.UI.DomElement.containsCssClass(Wa,
hc.a.aN);let Kb=!1,nc=!1;Wa.parentNode&&Wa.parentNode.parentNode&&Sys.UI.DomElement.containsCssClass(Wa.parentNode.parentNode,hc.a.eXd)&&(Kb=Wa.parentNode.parentNode.firstChild===Wa.parentNode,nc=Wa.parentNode.parentNode.lastChild===Wa.parentNode);var R=void 0;let oc;wa.text?(R=ya.a.fv(Wa),oc=wa.text):(R=this.Oo.L_d(Wa,this.hd,this.$f),oc=wa.Lnl);const Ic=this.Wgf.QHa(R).indexOf(this.Wgf.QHa(oc));if(0<=Ic){const Kc=this.szf.QHa(Ka.a.substring(R,0,Ic));R=this.szf.QHa(Ka.a.right(R,Ic+oc.length));0<
Kc.length&&((mb||G||Kb)&&0<fa?(this.A7c(a[fa-1],Kc,!0,this.$f),this.Oo.ETc(Wa)&&(f-=Za.tIc)):x&&fa!==a.length-1&&this.A7c(a[fa+1],Kc,!1,this.$f));0<R.length&&((G||nc||x)&&fa!==a.length-1?(this.A7c(a[fa+1],R,!1,this.$f),this.Oo.ETc(Wa)&&(f+=Za.$Td)):mb&&0<fa&&this.A7c(a[fa-1],R,!0,this.$f))}else mb&&(this.rd.Aj||this.rd.io)&&1===oc.length&&!R.length?Z.ULS.sendTraceTag(18437455,315,50,"Possible Ins/Overtype"):mb&&this.rd.eg||Z.ULS.shipAssertTag(18437456,315,!1,"CleanReadOnlyObjects failed."),x=oc?oc.length:
0,G=R.length,G>x&&(f-=G-x);wa.text?ya.a.wx(Wa,wa.text):(this.Oo.EQj(Wa)||wa.cQd.restore(),wa.cQd=new Dg.a(Wa))}l&&this.Pi.uS(f,c)}}A7c(a,b,c,f){f.n++;c?ya.a.wx(a,ya.a.fv(a)+b):ya.a.wx(a,b+ya.a.fv(a))}}Object(e.a)(Ok,"ReadOnlyObjectsCleaner",null,[]);class rf{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He){this.fha=0;this.jd=a;this.DDd=b;this.SJ=c;this.$f=f;this.hd=l;this.pvc=x;this.Qc=G;this.Pi=R;this.Oo=fa;this.rd=wa;this.Xe=Wa;this.ef=mb;this.If=Kb;this.fj=nc;this.lDd=oc;this.Jm=
Ic;this.ir=Kc;this.vQh=Hc;this.UNh=He}init(a){this.fha=a}ngb(a,b,c,f,l){if(this.jd.isValid){var x=this.jd.fm();x&&x.firstChild&&1!==u.AFrameworkApplication.Aa.state&&(this.DDd.z3f(this.Qc.Oa),this.fJe(a,b,c,f,l))}}MIa(a,b,c,f,l){if(this.SJ.fae()&&(!this.fj||this.Xe.O9g))if(this.SJ.setFocus(a,b,c,f,l),this.rd.AU){a="Window.getSelection";b=this.jd.fm();if(this.rd.US){if("none"===b.style.display){Z.ULS.sendTraceTag(19702473,324,15,"Editing element is not displayed");return}if(!ya.a.Qsa(this.jd.yg.rya,
b)){Z.ULS.sendTraceTag(19702474,324,15,"Editing element is not attached to view panel");return}}try{var x=this.Jm.getSelection(this.jd.contentWindow);x&&(a="Selection.removeAllRanges",this.Jm.removeAllRanges(x),a="Selection.selectAllChildren",this.Jm.Z_k(x,b))}catch(G){x=ya.a.bfg(b),Z.ULS.sendTraceTag(18437461,324,10,"{{'BrowserAPI':'{0}','HTML':'{1}','Stack':'{2}','Display':{3},'RootElement':{4}}}",a,b?ib.a.HUd(b):"",G.stack,b?b.style.display:"",x?x.tagName+","+x.id+","+x.className:"")}}else this.Jm.fJe(this.jd.CCa().Il)}fJe(a,
b,c,f,l){const x=this.Qc.Oa.kb;try{if(this.SJ.fae()&&(!this.fj||this.Xe.O9g)){var G=x.Ua,R=x.Ve,fa=this.lDd.create(this.If.Nd);this.MIa(a,b,c,f,l);a=null;var wa=this.jd.CCa();if(this.rd.AU){a=this.Jm.getSelection(this.jd.contentWindow);if(!a)return;if(this.Jm.fcj(a)){var Wa=this.Jm.getRangeAt(a,0);this.Jm.removeAllRanges(a)}else Wa=this.Jm.createRange(wa.Il)}else if(this.rd.qF)Wa=wa.selection.createRange();else return;this.vQh&&this.s5k(Wa);(this.ef.Vj(G)||this.ef.Ll(G))&&this.eVi(G,Wa);this.ef.Vj(R)&&
this.fVi(R,Wa);this.rd.AU?this.Jm.addRange(a,Wa):this.rd.qF&&Wa.select();fa.dispose()}}catch(mb){G=this.jd.fm(),Z.ULS.sendTraceTag(18437463,324,10,"{{'Message':'{0}','Stack':'{1}','HTML':'{2}'}}",mb.message,mb.stack,G?ib.a.HUd(G):"")}}fVi(a,b){var c=a.node.oc(this.fha).Ts;let f=0,l=0,x=0;a=a.Kb;for(var G=!1;f<c.length;){const R=this.Oo.lI(c[f],this.$f,this.hd,this.fj);if(G)x+=R;else if(Sys.UI.DomElement.containsCssClass(c[f],hc.a.MM))l++;else if(!Sys.UI.DomElement.containsCssClass(c[f],X.a.yV)){if(a<=
l+R)if(G=a-l,this.rd.AU){c=c[f];this.pvc.value.GWb(c,this.jd.contentWindow);this.coh(b,c,G,!1);break}else x=R-G,G=!0;l+=R}f++}this.rd.qF&&this.Jm.moveEnd(b,-x)}eVi(a,b){var c=a.node.oc(this.fha).Ts;let f=0;var l=0;let x=0,G=a.Qa;for(this.ef.Ll(a)&&(G=this.ir.textLength(a.node));f<c.length;)if(a=this.Oo.lI(c[f],this.$f,this.hd,this.fj),Sys.UI.DomElement.containsCssClass(c[f],hc.a.MM))l++,f++,x+=a;else if(Sys.UI.DomElement.containsCssClass(c[f],X.a.yV))f++,x+=a;else if(this.UNh&&Sys.UI.DomElement.containsCssClass(c[f],
hc.a.dVd))f++,x+=a;else{if(G<=l+a){l=G-l;this.rd.AU?(c=c[f],this.pvc.value.GWb(c,this.jd.contentWindow),this.coh(b,c,l,!0)):this.Jm.moveStart(b,x+l);break}l+=a;x+=a;f++}}coh(a,b,c,f){b.childNodes.length?(1<b.childNodes.length||b.firstChild&&3!==b.firstChild.nodeType)&&Z.ULS.sendTraceTag(18437465,324,50,"Span is not normalized"):Z.ULS.sendTraceTag(18437464,324,10,"Trying to set selection in an empty span");let l=0,x=null;b=ya.a.aMc(b,!0);for(let G of b)if(3===G.nodeType){b=G.nodeValue.length;if(c<=
l+b){this.Jm.xHb(a,f,G,c-l);return}x=G;l+=b}x?(Z.ULS.sendTraceTag(18437467,324,15,"CP ({0}) was greater than length of all text nodes ({1}), setting at end",c,l),this.Jm.xHb(a,f,x,c-l)):Z.ULS.sendTraceTag(18437466,324,15,"Span contained no text nodes")}pYf(a,b,c,f,l,x,G){var R=this.Qc.Gna;if(R.Rce||R.fbe)return!1;var fa=this.jd.fm();if(!fa.innerHTML.length)return!1;R=!1;if(this.rd.AU)(b=ib.a.ACa(this.jd.contentWindow))&&(this.Jm.hPc(b)===fa?R=!0:this.fj&&ib.a.VNj(b)&&ib.a.UNj(b)&&(R=!0));else if(this.rd.qF){var wa=
this.jd.CCa().selection.createRange();wa=this.Jm.P6i(wa.range);wa=wa.replace(Ka.a.tvc,"");fa=fa.innerHTML;fa=fa.replace(Ka.a.tvc,"");if(wa===fa)switch(a){case 2:R=!0;break;case 1:1<b.length||!(this.ef.xu(b.kb.Ua)||this.ef.Ll(b.kb.Ua)||this.ef.xu(b.kb.Ve)||this.ef.Ll(b.kb.Ve))||(R=!0)}}if(!R)return!1;this.$f.by++;this.fj&&c?c.ura():2===a?this.Pi.uS(this.Pi.iTa,f):1===a&&this.ngb(a,l,x,f,G);return!0}s5k(a){a=ya.a.aMc(a.commonAncestorContainer,!0);for(let b of a)b&&(a=ya.a.Iia(b),a.startsWith("OutlineElement")&&
(-1!==a.toLowerCase().indexOf("rtl")?b.style.direction="rtl":b.style.direction="ltr"),a.toLowerCase().startsWith("paragraph")&&b.parentNode&&b.parentNode.tagName.toLowerCase().startsWith("li")&&(b.style.margin=""))}}Object(e.a)(rf,"SelectContentHelper",null,[]);class Af{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic){this.Wga=this.Coa=this.Se=null;this.xh=a;this.Pi=b;this.$f=Kb;this.Lb=c;this.kf=f;this.jd=l;this.Rd=x;this.Jm=G;this.Oo=R;this.hd=mb;this.Qc=fa;this.fj=oc;this.gK=wa;this.QU=Wa;
this.Ek=nc;this.sR=Ic}get oYa(){return this.Wga||(this.Wga=fb.a.instance.qb("Box4.ISelectionCommands"))}fS(a){this.Se=a}mrj(a,b){if(!a)return!1;var c=this.xh.mode;if(2===c)if(!this.Pi.ACj)this.$f.b++,this.Pi.uS(this.Pi.iTa,this.Lb.Rh);else if(this.fj){if(500>(new Date).getTime()-this.kf.Ivi)return this.Se.Bqb.Fca=!1;a=ib.a.ACa(this.jd.contentWindow);if(!a)return!1;if(ib.a.jVc(a)){b=this.Pi.rMc(c,this.Lb.Fi);if(this.Pi.iTa===b&&!this.Se.Bqb.Fca)return this.Coa&&(this.Rd.Ng(this.Coa),this.Rd.Cb(this.Coa)),
!1;if(this.sR.qnd())return this.$f.c++,this.Se.Bqb.Fca=!0,!1;if(this.Se.Bqb.Fca)return this.$f.d++,this.kf.x$(!0),this.Se.Cs(!0),this.Se.Bqb.Fca=!1;this.Coa||this.Se.Cs(!0);qf.GrippersManager.instance.setVisibility(!1);this.e4k();return!1}if(this.gK.pYf(c,qd.a.instance.Oa,this.oYa,this.Lb.Rh,this.Lb.Fi,this.Lb.Ag,this.Ek.value.isEditingAllowed||this.Ek.value.My))return this.$f.e++,!1;c=this.Oo.V1d(this.Jm.hPc(a),this.Lb.Fi,this.Jm.lgg(a),this.$f,this.hd,this.fj);a=this.Oo.V1d(this.Jm.W4i(a),this.Lb.Fi,
this.Jm.Cag(a),this.$f,this.hd,this.fj);if(0>c||a<c||yb.ParagraphReader.textLength(b.node)<a)return!1;this.$f.f++;this.Qc.setSelection(rd.SelectionFactory.p2(b.node,c,a))}return!1}e4k(){this.Coa?this.Rd.Ng(this.Coa):this.Coa=new xe.a(2,1,1E3,()=>{this.fixupAfterMagnifierDrag()},23);this.Rd.Cb(this.Coa)}fixupAfterMagnifierDrag(){if(this.Coa){this.Coa=null;var a=this.xh.mode;2===a&&this.Lb.eTa(a)&&(this.$f.g++,this.Pi.updateCaretPosition(a,this.Lb.Fi),this.kf.ZIa(!0),this.QU.fixupAfterCursor(5),this.Se.Cs(!0),
qf.GrippersManager.instance.osh())}}}Object(e.a)(Af,"SelectionChangeHandler",null,[1416]);class qk{constructor(a,b){this.jd=a;this.ZRb=b}z3f(a){this.qIf(this.jd.fm(),this.ZRb+a.Ir,r.a.nfi)}qIf(a,b,c){for(a=a.firstChild;a;a=a.nextSibling)3!==a.nodeType&&(this.pQk(a),Sys.UI.DomElement.addCssClass(a,b),Sys.UI.DomElement.addCssClass(a,c),this.qIf(a,b,c))}pQk(a){var b=a.className;if(b){b=b.split(" ");for(let c=0;c<b.length;c++)b[c].startsWith(this.ZRb)&&Sys.UI.DomElement.removeCssClass(a,b[c])}else Z.ULS.sendTraceTag(18437474,
324,50,"Class string for DOMElement is null")}}Object(e.a)(qk,"SequenceCodeHelper",null,[1415]);class Dk{constructor(a,b,c,f){this.$f=f;this.Pi=b;this.hd=c;this.eb=a}AEk(a,b,c,f){if(a.Bi.length){var l=a.Bi[0].aF,x=ya.a.fv(l);if((a=a.IAc)&&x&&x.length===a.length+1&&x.endsWith(" ")){var G=ib.a.Y0d(l);G&&((a=K.a.te(l,X.a.xEa),a=b.Ts[a+1],a)?ib.a.Y0d(a)!==G&&(c=this.Pi.z7(c,f),f=ya.a.fv(a),this.hd.Tb("MomentaryIncorrectLinkLength",{["Reason"]:"MovedSpaceOutOfLink"}),this.$f.q++,ya.a.wx(l,x.substring(0,
x.length-1)),ya.a.wx(a," "+f),this.Pi.uS(c,b)):this.$f.p++)}}}Gli(a,b,c){for(let f=0;f<a.childNodes.length;f++){const l=a.childNodes[f];if(l.parentNode===a)if(this.eb.ka("TextLayoutServiceEnableHyperLinkDataLossFix")&&Sys.UI.DomElement.containsCssClass(l,hc.a.s8))for(let x=0;x<l.childNodes.length;x++)this.jOf(l.childNodes[x],x,b,a,c)&&x--;else this.jOf(l,f,b,a,c)&&f--}}jOf(a,b,c,f,l){const x=a.parentNode;f=x===f;if(3===a.nodeType){let G=-1;const R=a.nodeValue;let fa=null,wa="";if(b){const Wa=x.childNodes[b-
1];if(Qc.a(Wa)&&(!f||yb.ParagraphReader.Vd(Qc.a(Wa).$a))){for(fa=Wa;fa.lastChild&&1===fa.lastChild.nodeType;)fa=fa.lastChild;wa=fa.innerText+R}}if(!fa&&b!==x.childNodes.length-1&&(b=x.childNodes[b+1],Qc.a(b)&&(!f||yb.ParagraphReader.Vd(Qc.a(b).$a)))){for(fa=b;fa.firstChild&&1===fa.firstChild.nodeType;)fa=fa.firstChild;wa=R+fa.innerText}fa?(G=this.Pi.z7(c,x),this.hd.Tb("MomentaryIncorrectFormatting",{["Reason"]:"MovedSpanlessText"}),this.$f.r++,ya.a.wx(fa,wa)):(this.hd.Tb("ValidTextDropped",{["Reason"]:"DroppedSpanlessText"}),
this.$f.s++);x.removeChild(a);-1!==G&&this.Pi.uS(G,l);return!0}return!1}sPk(a,b,c,f){if(r.a.eg&&a.Bi.length){var l=ya.a.fv(a.Bi[0].aF),x=a.IAc;l&&x&&l.length===x.length+2?this.xeh(0,a,b,c,f):2===a.Bi.length&&this.xeh(1,a,b,c,f)}}xeh(a,b,c,f,l){c=this.Pi.z7(c,f);(f=ya.a.fv(b.Bi[a].aF))&&f.endsWith("\u00a0 ")&&(this.$f.t++,f=f.substr(0,f.lastIndexOf("\u00a0 "))+" ",b.Bi[a].aF.innerText=f,(0<a?c-(b.Bi[0].fDc+ya.a.fv(b.Bi[0].aF).length):c-b.Bi[0].fDc)>f.length&&c--,this.Pi.uS(c,l))}}Object(e.a)(Dk,"StrayTextCleanupUtils",
null,[]);class ej{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie){this.jga=null;this.sFd=a;this.Qkb=b;this.ytd=c;this.hd=f;this.Vga=l;this.xh=x;this.Qc=G;this.k6=R;this.rd=fa;this.kf=wa;this.Dk=Wa;this.CB=mb;this.xga=Kb;this.Ds=nc;this.hV=oc;this.iaa=Ic;this.Lb=Kc;this.nNa=Hc;this.Xc=ie}get Xba(){return this.jga||(this.jga=fb.a.instance.qb("Box4.IFormatPainter"))}iib(a,b){if(!b)return!1;if(this.sFd.sqh)return a.mc.preventDefault(),!0;if(this.Qkb.c5a&&this.rd.dta)return this.Qkb.c5a=
!1,this.ytd.cancelEventAndRestoreEditingSurface(a.mc),!0;this.Xba&&this.Xba.TK&&(this.Xba.TK=!1);this.anj(a.mc);b=this.hd.Kp(E.a.typing);b.properties.$(Dd.a.source,"TextInput");a=this.snl(a);b.end();return a}snl(a){this.Vga.fixupAfterMagnifierDrag();if(1===this.xh.mode){if(this.hV.gNe())this.Qc.setSelection(rd.SelectionFactory.Mg(qd.a.instance.Oa.kb.Ua.node,qd.a.instance.Oa.kb.Ua.Qa));else if(this.k6.CNe()){if(this.hV.sze(a))return!1;this.k6.startHybridTransition()}this.rd.rI&&this.hV.FLd()}this.iaa.raiseEvent(Qe.a.tnl,
a);this.kf.x$(!0);this.Dk.URe=!0;this.CB.FNa(a);this.nNa&&this.nNa.yGl(this.Lb.Rh);this.xga.rCb();this.Ds.lY();return!1}anj(a){this.rd.eg||"deleteContentBackward"!==a.rawEvent.inputType||(this.Dk.gTd=!this.Dk.b2,this.Dk.gTd&&u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("DeleteFromInputEventIsEnabled")&&(a=ej.CNd.rMc(2,this.Lb.Fi),a<ej.CNd.iTa&&(a=rd.SelectionFactory.p2(this.Lb.Ag,a,ej.CNd.iTa),u.AFrameworkApplication.Ta.La(E.a.mPa,2,a))))}static get CNd(){return ej.Pi||(ej.Pi=fb.a.instance.resolve("Box4.ICaretPositionManager"))}}
ej.Pi=null;ej.sR=null;ej.AH=null;Object(e.a)(ej,"TextInputEventProcessor",null,[]);class xj{constructor(a,b,c,f,l,x){this.SJ=a;this.rd=b;this.Xe=c;this.Dk=f;this.Ek=l;this.Xc=x}get I9a(){return this.Xc.ag&&this.Xc.By}get sqh(){if(this.SJ.L3b||!this.Ek.value.isEditingAllowed&&this.Ek.value.My&&!this.I9a)return!0;if(this.rd.j8){var a=this.Xe.NTj;if(0<a){var b=(new Date).getTime();a=b-a;b-=this.Dk.Bde;if(500>a&&a<b)return!0}}return!1}}Object(e.a)(xj,"TextInputHandlerUtils",null,[]);var Wj=d(509),rk=
d(305);class ol{constructor(a,b,c,f){this.Koa=null;this.rd=a;this.SJ=b;this.If=c;this.ef=f}onContextMenu(a,b){let c=!1;this.rd.j8&&this.SJ.sUc&&(b=this.ef.Oqb(this.If.Nd,b,this.If.Nd.Hia(a),!1),this.ef.Uw(b)&&(c=!0));c?(this.Koa=a.clientPoint,a=!0):(this.Koa=null,a=this.If.Nd.onContextMenu(a));return a}ofc(a){if(this.rd.j8&&this.Koa){const b=rk.a.SSe;if(a.clientPoint.x>this.Koa.x+b||a.clientPoint.x<this.Koa.x-b||a.clientPoint.y>this.Koa.y+b||a.clientPoint.y<this.Koa.y-b)this.Koa=null}return!1}LDb(a){let b=
!1;this.rd.j8&&this.Koa&&(b=this.If.Nd.onContextMenu(a),this.Koa=null);return b}}Object(e.a)(ol,"TouchEventProcessor",null,[]);class jm{create(a){return new Zi(a)}}Object(e.a)(jm,"TypingActionOperationFactory",null,[1410]);var xd=d(70),Xl=d(246);class dl{constructor(a,b,c,f,l,x){this.hAf=0;this.jef=Ga.a.nil;this.hPb=this.muc=!1;this.Vaf=4===Cb.App.mode;this.Rwc=!1;this.DZh=new Vb.a;this.DZh.add(0,E.a.bHe);this.Rzc=new Vb.a;this.Rzc.add(0,0);this.Ref=a;this.okb=b;this.If=c;this.pp=f;this.EZh=l;this.Drd=
x;this.Sdf=Object(C.a)(this,this.XUk,"reportTypingCharCount");u.AFrameworkApplication.ofa(()=>{this.z_j()});this.Drd&&this.yNk();this.xNk();u.AFrameworkApplication.Ta&&u.AFrameworkApplication.Ta.pa(E.a.bHe,xd.a.frame,Kd.ActionManager.Hg,96)}yNk(){this.pp&&this.pp.addHandler(qe.a.Qx,this.Sdf)}xNk(){this.okb&&this.okb.REf(Object(C.a)(this,this.UBc,"afterEditingViewValidateEventHandler"))}Mjc(a){this.Ref.value&&0===this.Ref.value.mode||(a=new Zi(a),a.end(8),ci.a.getInstance().Zic(a),dj.a.getInstance().Yic(a))}KZg(a,
b){if(!this.Vaf&&Cb.App.Hb&&2===Cb.App.Hb.mode&&b&&b.graphNode&&yb.ParagraphReader.Vd(b.graphNode)&&!Ie.a(b.graphNode,5)){if(a=b.graphNode.id,a!==this.jef){if(this.Rwc){var c;(c=this.Rzc).$(0,c.ga(0)+1);u.AFrameworkApplication.Ta.processAction(E.a.bHe,2);c="Paragraph rendering is blocked";this.EZh&&(c+=", so graph transaction manager is reset",Xl.GraphTransactionManager.instance.$Le());Z.ULS.sendTraceTag(38547550,323,15,c)}this.jef=a;this.Rwc=!0}}else this.Rwc=!1}UBc(a,b){this.Vaf||!b.lM&&!b.mU||
(!this.muc&&this.If.Nd&&(this.If.Nd.X5h(Object(C.a)(this,this.KZg,"onContentEditableViewClick")),this.muc=!0),this.Rwc=!1)}XUk(){this.hAf++}UAl(a,b){a!==b&&(a=String.format("CP changed unexpectedly in browser, expected {0} but was {1}",a,b),Z.ULS.sendTraceTag(18437207,323,15,a))}z_j(){this.hPb||(this.Drd&&(Z.ULS.sendTraceTag(38114780,323,50,""+this.hAf),this.CJi(),this.Drd=!1),0<this.Rzc.ga(0)&&Z.ULS.sendTraceTag(38536792,323,15,"ParagraphDisappear:{0}",this.Rzc.ga(0)),this.BJi(),this.hPb=!0)}CJi(){this.pp&&
this.pp.removeHandler(qe.a.Qx,this.Sdf)}BJi(){this.okb&&this.okb.yRk(Object(C.a)(this,this.UBc,"afterEditingViewValidateEventHandler"));this.muc&&this.If.Nd&&(this.If.Nd.CRk(Object(C.a)(this,this.KZg,"onContentEditableViewClick")),this.muc=!1)}}Object(e.a)(dl,"TypingLogger",null,[1385]);const kg=a=>{u.AFrameworkApplication.fa.ka("TypingSurveyIsEnabled")&&(a.execute(b=>{b.l7b("WordTypingSurveyTrigger",null)}),a.execute(b=>{window.setTimeout(()=>{b.logActivity("WordTypingSurveyTrigger",null)},300)}))};
class km{constructor(a){this.vTc=!1;this.e5a=5;this.HWg=!1;this.jve=!0;this.kb=a}}Object(e.a)(km,"TypingProcessState",null,[]);class Ki{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg,Sf,uh,Sg,li){this.bha=this.Se=null;this.Oib=!1;this.ind=null;this.DWc=0;this.bOb=a;this.Lb=b;this.Mvd=c;this.Pi=f;this.P1a=l;this.pp=x;this.cvc=G;this.JY=R;this.QU=fa;this.kf=wa;this.Poa=Wa;this.Qc=mb;this.VJ=Kb;this.xga=nc;this.hd=oc;this.$f=Ic;this.AH=Kc;this.Rd=Hc;this.Dk=ie;this.Ch=
He;this.ZC=fe;this.Yoa=Te;this.Sfa=We;this.rd=Qf;this.uga=mg;this.rk=Xg;this.Ds=Mg;this.vVh=Sf;this.GEd=uh;this.Rr=Sg;this.Xc=li;this.Tdf=0;this.U4e=!1;this.WAj()}fS(a){this.Se=a}get yZa(){return this.bha||(this.bha=fb.a.instance.qb("Box4.ITextFormattingCommands"))}wtl(){ze.c(18437507,306,100,"TypingProcessInternalCalled");const a=this.Xc.cpb();try{this.DWc=0;if(this.Se.Utk.Esl()||2!==this.kf.mode||!this.kf.isActive||u.AFrameworkApplication.Vg||!this.Lb.Ag||this.Mvd.correctBadImeState())return;this.Pi.updateCaretPosition(this.kf.mode,
this.Lb.Fi);this.P1a.wVe();this.Loi();this.pp.raiseEvent(qe.a.typingProcess);if(!this.Lb.$Oa||2===Cb.App.mode&&this.Rr.isComposing)return;const b=new km(this.JY.Yra(this.QU.r8));if(this.cvc.nDk(b))return;b.vTc||(this.kf.x$(!0),b.HWg=!0);this.vDk(b);if(!this.Lb.eTa(this.kf.mode))return;const c=this.Lb.NV.$a;this.Xc.ag&&(c.wCb=this.Qc.Oa.kb.Ua.Qa);b.HWg&&H.a.instance.ga(50)&&this.Poa.value&&this.Poa.value.Zv&&this.Qc.ATb();if(b.jve){try{this.xga.rCb()}catch(f){this.hd.Tb("PossibleEditSurfaceIncorrectSize",
{["Reason"]:"MirrorToPageViewCrash"}),this.$f.l++,this.AH.Cs(!1,!1)}this.Ds.lY();this.Rr.kEa&&(this.AH.Cs(!0,!0),this.dni())}}finally{a&&a.dispose()}ze.c(18437510,306,100,"TypingProcessInternalExited")}dni(){Cb.App.Hb.Rtj&&Cb.App.Hb.uYk()}FNa(a){this.cvc.p8g(a);this.Oib||(this.Oib=!0,this.Rd.Cb(this.ind))}tGi(){if(!this.Dk.b2&&!this.Dk.Vqa)return!1;const a=!this.Poa.value||this.Poa.value.amIAlone?Ki.rlj:Ki.qlj,b=this.bOb();-1===this.Dk.YWc&&(this.Dk.YWc=b);return b-this.Dk.YWc<a?(this.Rd.Cb(this.ind),
this.Oib=!0):!1}typingProcess(){if(this.Oib&&(this.Oib=!1,this.Tdf++,!this.Rd.$v&&this.Lb.eTa(this.kf.mode)&&!(this.VJ&&this.VJ.q8a()||this.tGi()))){var a=this.hd.Kp(E.a.typingProcess);this.wtl();a.end();this.U4e||this.Tdf!==Ki.Fmi||((a=fb.a.instance.Ka("Common.ISystemInitiatedFeedback"))&&kg(a),this.U4e=!0)}}Loi(){if(this.Rr.kEa){if(this.Ch.vCf())if((this.rd.tF||this.rd.io)&&this.ZC.y6){const a=this.Pi.z7(this.kf.mode,this.Lb.Fi);this.ZC.Pgb(!1,this.Lb.Fi,this.Ch);this.Pi.uS(a,this.Lb.Rh)}else this.ZC.Pgb(!1,
this.Lb.Fi,this.Ch);this.vVh.zoi(this.Lb.Rh.Ts,this.Yoa,this.Lb.Rh,this.Pi.z7(this.kf.mode,this.Lb.Fi),this.Rr.kEa);this.GEd.Gli(this.Lb.Fi,this.kf.mode,this.Lb.Rh);this.GEd.AEk(this.Ch,this.Lb.Rh,this.kf.mode,this.Lb.Fi);this.Ch.xPk();this.GEd.sPk(this.Ch,this.kf.mode,this.Lb.Fi,this.Lb.Rh)}}vDk(a){this.Sfa.UQ?(this.Sfa.Ywk(),a.jve=!1):this.uga.instance&&this.uga.instance.f6d()&&!this.rd.gJb&&(this.Rr.kEa&&this.yZa?(this.Cai(a.kb),a.jve=!1):this.uga.instance.SXa())}Cai(a){if(this.yZa&&this.uga.instance){this.uga.instance.freeze();
var b=qd.a.instance.Oa.kb,c=this.rk.ke(15);c.gd(this.Lb.Ag.node);a=rd.SelectionFactory.bN(a,b.Ua);this.yZa.mHb(a.Ua,!0);this.uga.instance.eSe();this.uga.instance.SXa();this.Lb.Rh&&this.Qc.setSelection(this.JY.Yra(this.QU.r8));c.dispose();this.kf.x$(!0);this.AH.Cs(!0,!1)}}WAj(){let a=1;r.a.io&&(a=u.AFrameworkApplication.fa.Cc("Box4TypingTaskTimeEdge",1));this.ind=new xe.a(0,1,a,()=>{this.typingProcess()},25)}dispose(){this.ind=null}lrh(a){return this.rd.j8&&a?this.Sfa.UQ||this.DWc>Ki.Wdk||this.uga.instance&&
this.uga.instance.f6d()||this.ZC.y6?!0:!1:!1}}Ki.Wdk=7;Ki.qlj=250;Ki.rlj=2E3;Ki.Fmi=500;Object(e.a)(Ki,"TypingProcessManager",null,[1409,106]);class vm{constructor(){this.Pa=new ic.a}NGk(a){this.Pa.raiseEvent("OnDismissPasteFloatie",a)}TGk(){this.Pa.raiseEvent("OnExpandMenuPasteFloatie")}nEe(a){this.Pa.raiseEvent("OnPastedContentUpdated",a)}FIk(a){this.Pa.raiseEvent("OnShowPasteFloatie",a)}}Object(e.a)(vm,"PasteFloatieEventSource",null,[1406,1407,1408]);var pj=d(858),Df=d(130),Qh=d(313),Yl=d(392),
qj=d(222),pl=d(813);class Il{constructor(){this.Da=null}get name(){return"Box4.ContentEditableView"}Wb(a){this.Da=a;a.register(Wj.a,"Box4.TextNodeCombiner").as("Box4.ITextNodeCombiner").ma().na(()=>new Wj.a);a.register(ng,"Box4.ContentEditableDomFactory").as("Box4.IContentEditableDomFactory").ma().na(()=>new ng);a.register(sg,"Box4.EventFrequencyTracker").ma().na(()=>new sg);a.register(xc,"Box4.CevUsageDataTracker").ma().na(()=>new xc);a.register(od,"Box4.ContentEditableViewEventSource").ma().na(()=>
new od);a.register(lc,"Box4.CurrentlyActiveContentSpans").as("Box4.ICurrentlyActiveContentSpans").ma().na(()=>new lc(rb.a.instance,yg.a.instance.UZd(),a.resolve("Box4.TextNodeCombiner")));a.register(td,"Box4.OriginalElementContentArray").as("Box4.IOriginalElementContentArray").ma().na(()=>new td(rb.a.instance,yg.a.instance.UZd(),pf.instance,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(hk,"Box4.EditingDomManager").as("Box4.IEditingDomManager").ma().na(()=>new hk);a.register(ui,
"Box4.EditStateEventManager").as("Box4.IEditStateEventManager").ma().na(()=>new ui(a.resolve("Box4.IEditingDomManager")));a.register(La,"Box4.ContentEditableViewPaddingManager").as("Box4.IContentEditableViewPaddingManager").ma().na(()=>new La(a.resolve("Box4.EditStateEventManager"),rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,a.resolve("Box4.EditingDomManager"),a.resolve("Common.IAppSettingsManager").ka("RemovePaddingHighlightEnabled")));a.register(1385,"Box4.ITypingLogger").ma().na(()=>
new dl(a.le("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ContentEditableViewEventSource"),pa.InteractiveViewManager.instance,a.resolve("Box4.EditStateEventManager"),a.resolve("Common.IAppSettingsManager").ka("QoETypingImprovementIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("QoECharCountIsEnabled")));a.register(jh,"Box4.CaretPositionManager").as("Box4.ICaretPositionManager").ma().na(()=>new jh(a.le("Box4.ITextNodeCombiner"),rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,
a.resolve("Box4.EditingDomManager"),pf.instance,pc.a.instance,pa.InteractiveViewManager.instance,u.AFrameworkApplication.pe,pc.a.instance.Ki,pj.a.instance,a.resolve("Common.IScrollLockFactory"),a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Box4.ITypingLogger")));a.register(Wi,"Box4.ContentEditableViewFocusHelper").as("Box4.IContentEditableViewFocusHelper").ma().na(()=>new Wi(a.resolve("Box4.EditingDomManager"),pa.InteractiveViewManager.instance,a.resolve("Box4.IExternalSelectionManager"),
pc.a.instance.Ki,cd.a.instance,pc.a.instance,v.FocusManager.instance()));a.register(Ok,"Box4.ReadOnlyObjectsCleaner").ma().na(()=>new Ok(rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,a.resolve("Box4.CaretPositionManager"),pf.instance,pc.a.instance));a.register(Dk,"Box4.StrayTextCleanupUtils").ma().na(()=>new Dk(u.AFrameworkApplication.fa,a.resolve("Box4.CaretPositionManager"),rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH));a.register(1386,"Box4.IContentEditableViewContentControlHelper").ma().na(()=>
new kh(rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,pc.a.instance.Ki,pf.instance,pa.InteractiveViewManager.instance,a.resolve("Box4.IParagraphReader")));a.register(Ff,"Box4.ActiveContentSpansPersistanceManager").as("Box4.IActiveContentSpansPersistanceManager").ma().na(()=>new Ff(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.CevUsageDataTracker").XH,rb.a.instance,a.qb("Box4.IHyperlinkEditor"),
pc.a.instance,a.resolve("Box4.IContentEditableViewContentControlHelper"),pj.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Common.IAppSettingsManager")));a.register(me,"Box4.CevViewContentManager").as("Box4.ICevViewContentManager").ma().na(()=>new me(a.Ka("Common.ITypingSpeedMeterProvider"),pa.InteractiveViewManager.instance));a.register(lb,"Box4.ContentEditableViewTypingState").ma().na(()=>new lb(u.AFrameworkApplication.Ta));a.register($d,"Box4.ContentEditableHtmlStructureUtils").ma().na(()=>
new $d(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ContentEditableViewTypingState")));a.register(qk,"Box4.SequenceCodeHelper").ma().na(()=>new qk(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IConstantsProvider").Wlh));a.register(rf,"Box4.SelectContentHelper").ma().na(()=>new rf(a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.CevUsageDataTracker").XH,rb.a.instance,a.le("Box4.ITextNodeCombiner"),
qd.a.instance,a.resolve("Box4.ICaretPositionManager"),pf.instance,pc.a.instance,zd.EventHandlerManager.instance,Qh.a.instance,pa.InteractiveViewManager.instance,pc.a.instance.Ki,a.resolve("Common.ScrollLockFactory"),pj.a.instance,a.resolve("Box4.IParagraphReader"),Ib.ListReader.Ww,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.resolve("Common.IAppSettingsManager").ka("FixUpEmptySpanInSelectionBeginIsEnabled")));a.register(lh,"Box4.EditingDomDisplayManipulator").ma().na(()=>new lh(a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.SelectContentHelper"),u.AFrameworkApplication.fa,pa.InteractiveViewManager.instance));a.register(Uh,"Box4.EditViewStateManager").as("Box4.IEditViewStateManager").ma().na(()=>new Uh(a.resolve("Box4.ContentEditableViewEventSource")));a.register(mh,"Box4.InteractiveViewSynchronizer").ma().na(()=>new mh(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CevUsageDataTracker").XH,rb.a.instance,
pc.a.instance.Ki,a.resolve("Box4.Graph.IGraphIteratorFactory"),pf.instance,pa.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager")));a.register(Nb,"Box4.CurrentEditSelectionProvider").ma().na(()=>new Nb(a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CevUsageDataTracker").XH,rb.a.instance,pf.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),pc.a.instance.Ki,a.resolve("Box4.IContentEditableViewContentControlHelper")));
a.register(Bg,"Box4.BackspaceInBrowserHandler").ma().na(()=>new Bg(a.resolve("Box4.CurrentEditSelectionProvider"),pc.a.instance.Ki,ed.a.instance,Qh.a.instance,a.resolve("Box4.IExternalSelectionManager"),qj.a.instance,u.AFrameworkApplication.fa.ka("PPTLineBoxEnabled"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IHyperlinkStrategy"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.Ka("Box4.IAutoCorrectScheduler"):null));a.register(id,"Box4.OvertypeDomPreparer").ma().na(()=>
new id(a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableViewPaddingManager"),qd.a.instance,rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,pf.instance,pc.a.instance.Ki,a.resolve("Box4.IContentEditableViewContentControlHelper")));a.register(Rc,"Box4.CutCopyHandler").as("Box4.ICutCopyHandler").ma().na(()=>new Rc(Qh.a.instance,qd.a.instance,rb.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.EditStateEventManager"),pa.InteractiveViewManager.instance,
a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ICevViewContentManager"),pc.a.instance,a.resolve("Box4.SelectContentHelper"),new Sa.a(()=>Cb.App.Hb.Hd),a.Ka("Box4.IClipboardCommands"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.IDelayOperationFactory"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.fa,u.AFrameworkApplication.Ta,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(vm,"Box4.PasteFloatieEventSource").as("Box4.IPasteFloatieEventSource").as("Box4.IPasteFloatieEventHandler").as("Box4.IPasteFloatieEventNotifier").ma().na(()=>
new vm);a.register(yc,"Box4.BackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventSource").as("Box4.IBackspaceDeleteEventNotifier").ma().na(()=>new yc);a.register(Pg,"Box4.BoundsSynchronizer").as("Box4.IBoundsSynchronizer").ma().na(()=>new Pg(a.Ka("Box4.IListMarkerUtility"),a.resolve("Box4.IEditingDomManager"),a.Ka("Common.IZoomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),pc.a.instance,pa.InteractiveViewManager.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),
a.resolve("Box4.IRotatingCoordinateConverter")));a.register(rh,"Box4.EditingSurfaceStateManager").ma().na(()=>new rh);a.register(Ji,"Box4.EditingModeTransitionManager").as("Box4.IEditingModeTransitionManager").ma().na(()=>new Ji(a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.EditingSurfaceStateManager"),u.AFrameworkApplication.pe,a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),new Sa.a(()=>Cb.App.Hb.Hd),pc.a.instance,a.resolve("Box4.IContentEditableViewPaddingManager"),qd.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),pa.InteractiveViewManager.instance,Qh.a.instance,a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Wh,"Box4.ParagraphOverlayPositioner").ma().na(()=>
new Wh(a.resolve("Box4.IEditingDomManager"),new pl.a,pa.InteractiveViewManager.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.IParagraphOverlayControlRenderer")));a.register(Ai,"Box4.ContentEditableViewDebugLogger").ma().na(()=>new Ai);a.register(Rj,"Box4.ImeRecoveryUtils").ma().na(()=>new Rj(pc.a.instance,a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),
rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,a.resolve("Box4.ContentEditableViewDebugLogger"),pj.a.instance));a.register(Oh,"Box4.AutocorrectActionExecutor").ma().na(()=>new Oh(a.Ka("Box4.IAutoCorrectScheduler"),a.Ka("Box4.IAutoCorrectRules"),a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.CaretPositionManager"),
a.le("Box4.IUndoManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.Graph.IGraphTransactionFactory"),qd.a.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(Zm,"Box4.PasteHandler").as("Box4.IPasteHandler").ma().na(()=>new Zm(a.resolve("Common.IAppSettingsManager"),u.AFrameworkApplication.pe,rb.a.instance,
a.resolve("Box4.Graph.IGraphTransactionFactory"),qd.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditingDomDisplayManipulator"),pa.InteractiveViewManager.instance,pc.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.AutocorrectActionExecutor"),new Sa.a(()=>Cb.App.Hb.Hd),a.Ka("Box4.IClipboardCommands"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("Box4.IFileReaderHelperFactory"),
a.resolve("Common.IDelayOperationFactory"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.IProcessImageStrategy"),u.AFrameworkApplication.Ta,wd.a.get_instance(),()=>new Oa.a,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Common.Utils.Telemetry.ITelemetry"),Cb.App.instance.b5b,Cb.App.instance.bIb));a.register(Vf,"Box4.ContentEditableViewCursorManager").ma().na(()=>new Vf(pa.InteractiveViewManager.instance,rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,pc.a.instance.Ki,qd.a.instance,
Qh.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ICevViewContentManager"),new Sa.a(()=>Cb.App.Hb.Hd),u.AFrameworkApplication.Ta,a.resolve("Box4.IEditViewStateManager"),u.AFrameworkApplication.pe,pc.a.instance,a.resolve("Box4.ICaretPositionManager"),pf.instance,a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.IContentEditableViewPaddingManager"),
new jb,a.resolve("Box4.IContentEditableViewContentControlHelper"),a.qb("Box4.CharacterPointConverter")));a.register(Af,"Box4.SelectionChangeHandler").as("Box4.ISelectionChangeHandler").ma().na(()=>new Af(a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.IEditingDomManager"),u.AFrameworkApplication.pe,pj.a.instance,pf.instance,qd.a.instance,a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.ContentEditableViewCursorManager"),rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,new Sa.a(()=>Cb.App.Hb.Hd),pc.a.instance.Ki,a.resolve("Box4.ContentEditableHtmlStructureUtils")));a.register(Ri,"Box4.HybridTransitionManager").as("Box4.IHybridTransitionManager").ma().na(()=>new Ri(a.resolve("Box4.OvertypeDomPreparer"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.EditStateEventManager"),a.le("Box4.IUndoManager"),a.resolve("Box4.EditingDomDisplayManipulator"),
a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.CevViewContentManager"),pa.InteractiveViewManager.instance,u.AFrameworkApplication.pe,new Sa.a(()=>Cb.App.Hb.Hd),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),qd.a.instance,ed.a.instance));a.register(Rb,"Box4.CompositionStateManager").ma().na(()=>
new Rb(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.HybridTransitionManager")));a.register(Fh,"Box4.ImeManager").ma().na(()=>new Fh(a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),pa.InteractiveViewManager.instance));a.register(Le,"Box4.DragStateManager").ma().na(()=>new Le(pc.a.instance));a.register(ol,"Box4.TouchEventProcessor").ma().na(()=>
new ol(pc.a.instance,a.resolve("Box4.ContentEditableViewFocusHelper"),pa.InteractiveViewManager.instance,Qh.a.instance));a.register(pg,"Box4.AppFrameResizeEventProcessor").ma().na(()=>new pg(a.resolve("Box4.BoundsSynchronizer")));a.register(Mf,"Box4.OnScrollProcessor").ma().na(()=>new Mf(a.resolve("Box4.CevUsageDataTracker").XH,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer")));a.register(Eh,"Box4.EditingSurfaceEventHandlerUtils").ma().na(()=>
new Eh(rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,a.resolve("Box4.IEditingModeTransitionManager")));a.register(Sd,"Box4.DragEventsProcessor").ma().na(()=>new Sd(pc.a.instance,a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils")));a.register(Pd,"Box4.DoubleClickProcessor").ma().na(()=>new Pd(a.resolve("Box4.CaretPositionManager"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),pa.InteractiveViewManager.instance));a.register(Ud,
"Box4.DomChangeEventProcessor").ma().na(()=>new Ud(pc.a.instance,a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),rb.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.BoundsSynchronizer"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(xj,"Box4.TextInputHandlerUtils").ma().na(()=>new xj(a.resolve("Box4.IContentEditableViewFocusHelper"),pc.a.instance,zd.EventHandlerManager.instance,
a.resolve("Box4.ContentEditableViewTypingState"),new Sa.a(()=>Cb.App.Hb.Hd),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(xh,"Box4.ContentEditableViewGraphUpdater").ma().na(()=>new xh(qc.a.instance,a.resolve("Box4.EditingModeTransitionManager"),rb.a.instance,qd.a.instance,a.resolve("Box4.IExternalSelectionManager"),Qh.a.instance,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.Graph.GraphIteratorFactory"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.CharacterPropertiesEditor"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),
a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.CevUsageDataTracker").XH,a.resolve("Box4.HybridTransitionManager"),u.AFrameworkApplication.pe,pc.a.instance,a.Ka("Box4.IInsertionPointFormatting"),a.resolve("Box4.IActiveContentSpansPersistanceManager"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.Proofing.IModifiedRangeEditor"),a.qb("Box4.CharacterPointConverter"),a.resolve("Box4.ITypingLogger")));a.register(da,"Box4.KeyEntryProcessor").ma().na(()=>
new da(pf.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.CevUsageDataTracker").XH,rb.a.instance,pc.a.instance.Ki,a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),Qh.a.instance,a.resolve("Box4.ContentEditableViewTypingState"),
a.resolve("Box4.EditViewStateManager")));a.register(pd,"Box4.KeyQueueProcessor").ma().na(()=>new pd(a.resolve("Box4.KeyEntryProcessor"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),Qh.a.instance,qd.a.instance,a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.ICaretPositionManager")));a.register(Ki,"Box4.TypingProcessManager").as("Box4.ITypingProcessManager").ma().na(()=>new Ki(ib.a.sj,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ImeRecoveryUtils"),
a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.CurrentEditSelectionProvider"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.EditViewStateManager"),new Sa.a(()=>Cb.App.Ih),qd.a.instance,a.resolve("Box4.IExternalSelectionManager"),a.resolve("Box4.InteractiveViewSynchronizer"),rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,a.resolve("Box4.ContentEditableViewGraphUpdater"),
u.AFrameworkApplication.pe,a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.IContentEditableViewPaddingManager"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.AutocorrectActionExecutor"),pc.a.instance,a.Ka("Box4.IInsertionPointFormatting"),a.resolve("Box4.Graph.GraphTransactionFactory"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.ReadOnlyObjectsCleaner"),a.resolve("Box4.StrayTextCleanupUtils"),a.resolve("Box4.CompositionStateManager"),
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Wl,"Box4.OvertypeUtils").ma().na(()=>new Wl(new de(u.AFrameworkApplication.pe),a.resolve("Box4.EditingModeTransitionManager"),pc.a.instance,qd.a.instance,a.resolve("Box4.ITypingLogger"),Qh.a.instance,new Sa.a(()=>Cb.App.Hb.Hd),pa.InteractiveViewManager.instance,a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.HybridTransitionManager"),pc.a.instance.Ki,a.resolve("Box4.CevViewContentManager"),a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance));a.register(Ch,"Box4.ContentEditableViewFloatieHandler").ma().na(()=>new Ch);a.register(Ld,"Box4.KeyUpProcessor").ma().na(()=>new Ld(rb.a.instance,a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ICevViewContentManager"),new Sa.a(()=>Cb.App.Hb.Hd),
a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.KeyQueueProcessor"),a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.TypingProcessManager")));const b=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("TableEditingSelectIsEnabled");a.register(Jb,"Box4.KeyPressProcessor").ma().na(()=>new Jb(pc.a.instance,pj.a.instance,rb.a.instance,a.resolve("Box4.ISelectionChangeHandler"),new Sa.a(()=>
Cb.App.Hb.Hd),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.IHybridTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),qd.a.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.ICaretPositionManager"),a.resolve("Box4.AutocorrectActionExecutor"),pf.instance,a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICurrentlyActiveContentSpans"),new Sa.a(()=>
Cb.App.Ih),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.ContentEditableViewEventSource"),a.Ka("Common.ITypingSpeedMeterProvider"),b,Df.ContextSetEditor.instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.qb("Common.IEventTimingMeter")));a.register(xa,"Box4.KeyDownProcessor").ma().na(()=>new xa(a.Ka("Common.ITypingSpeedMeterProvider"),pc.a.instance.Ki,u.AFrameworkApplication.pe,
a.resolve("Box4.IEditingDomManager"),rb.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,a.resolve("Box4.ITypingLogger"),a.resolve("Box4.ISelectionChangeHandler"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.ICaretPositionManager"),pc.a.instance,pj.a.instance,a.resolve("Box4.CurrentEditSelectionProvider"),Qh.a.instance,a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.resolve("Box4.ContentEditableViewGraphUpdater"),new Sa.a(()=>
Cb.App.Ih),qd.a.instance,a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.CompositionStateManager"),a.le("Box4.IUndoManager"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CharacterPropertiesEditor"),new Sa.a(()=>Cb.App.Hb.Hd),a.resolve("Box4.SelectContentHelper"),a.resolve("Box4.ContentEditableViewFloatieHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.ImeManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.BackspaceInBrowserHandler"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing"),
a.resolve("Box4.Graph.IGraphTransactionFactory"),u.AFrameworkApplication.Ta,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.qb("Common.IEventTimingMeter"),a.resolve("Box4.IRotatingCoordinateConverter"),Yl.a.instance,a.resolve("Box4.IPasteFloatieEventSource"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.IBackspaceDeleteEventSource"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?
a.Ka("Box4.IAutoCorrectScheduler"):null,u.AFrameworkApplication.fa,a.qb("Box4.IHyperlinkEditor")));a.register(nj,"Box4.ContentEditableViewOnAfterValidateHandler").ma().na(()=>new nj(a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.CevViewContentManager"),pa.InteractiveViewManager.instance,a.resolve("Box4.EditingDomManager"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),
a.resolve("Box4.IContentEditableViewPaddingManager"),pc.a.instance,a.resolve("Box4.CevUsageDataTracker").XH,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ICurrentlyActiveContentSpans"),a.resolve("Box4.ContentEditableHtmlStructureUtils"),a.le("Box4.ITextNodeCombiner"),a.resolve("Box4.IOriginalElementContentArray"),a.resolve("Box4.IContentEditableViewFocusHelper"),a.resolve("Box4.ParagraphOverlayPositioner"),qd.a.instance,pc.a.instance.Ki,a.resolve("Box4.SelectContentHelper"),new Sa.a(()=>Cb.App.Hb.Hd),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.qb("Box4.ITabRenderer"),a.resolve("Box4.IPasteFloatieEventSource"),a.qb("Box4.IFeatureHelper")));a.register(Xi,"Box4.ContentEditableViewOnBeforeValidateHandler").ma().na(()=>new Xi(a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.ContentEditableViewDebugLogger"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.EditStateEventManager")));
a.register(tf,"Box4.CompositionEventProcessor").ma().na(()=>new tf(a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.TextInputHandlerUtils"),rb.a.instance,a.resolve("Box4.ImeRecoveryUtils"),a.resolve("Box4.ITypingLogger"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.IEditingModeTransitionManager"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewEventSource"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),u.AFrameworkApplication.fa.ka("SkipUpdateGraphWhenComposing")));a.register(ej,"Box4.TextInputEventProcessor").ma().na(()=>new ej(a.resolve("Box4.TextInputHandlerUtils"),a.resolve("Box4.DragStateManager"),a.resolve("Box4.EditingSurfaceEventHandlerUtils"),rb.a.instance,a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.EditingModeTransitionManager"),qd.a.instance,a.resolve("Box4.HybridTransitionManager"),pc.a.instance,a.resolve("Box4.EditViewStateManager"),
a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.InteractiveViewSynchronizer"),a.resolve("Box4.IBoundsSynchronizer"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.ICevViewContentManager"),a.qb("Box4.ITabRenderer"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(Be,"Box4.LostFocusEventProcessor").ma().na(()=>new Be(a.resolve("Box4.ContentEditableViewGraphUpdater")));
a.register(Bi,"Box4.EditingSurfaceEventHandlerManager").ma().na(()=>new Bi(u.AFrameworkApplication.pe,a.resolve("Box4.IEditViewStateManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.KeyUpProcessor"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.KeyPressProcessor"),a.resolve("Box4.KeyDownProcessor"),a.resolve("Box4.CompositionEventProcessor"),a.resolve("Box4.TextInputEventProcessor"),a.resolve("Box4.DragEventsProcessor"),a.resolve("Box4.PasteHandler"),a.resolve("Box4.CutCopyHandler"),
a.resolve("Box4.DomChangeEventProcessor"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewCursorManager"),a.resolve("Box4.TouchEventProcessor"),a.resolve("Box4.DoubleClickProcessor"),a.resolve("Box4.OnScrollProcessor"),a.resolve("Box4.AppFrameResizeEventProcessor"),a.resolve("Box4.LostFocusEventProcessor"),a.resolve("Box4.SelectionChangeHandler"),a.resolve("Box4.CaretPositionManager")));a.register($g,"Box4.ContentEditableViewDisposer").ma().na(()=>new $g(a.resolve("Box4.IOriginalElementContentArray"),
a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.CurrentlyActiveContentSpans"),a.resolve("Box4.EventFrequencyTracker"),a.resolve("Box4.CevUsageDataTracker").XH,a.resolve("Box4.ContentEditableViewEventSource"),a.resolve("Box4.EditingModeTransitionManager")));a.register(jm,"Box4.TypingActionOperationFactory").as("Box4.ITypingActionOperationFactory").ma().na(()=>new jm);a.register(1387,"Box4.IContentEditableModeHelper").ma().na(()=>new Ye);a.register(Cg,"Box4.ContentEditableView").as("Box4.IEditingView").ma().na(()=>
new Cg(pa.InteractiveViewManager.instance,qd.a.instance,new Sa.a(()=>Cb.App.Hb.Hd),a.Ka("Common.IActivityAggregationInfo"),a.Ka("Common.IZoomManager"),u.AFrameworkApplication.Ta,a.resolve("Box4.IHtmlViewRootFactory"),a.resolve("Box4.IEditingDomManager"),a.resolve("Box4.ICevViewContentManager"),a.resolve("Box4.EditStateEventManager"),a.resolve("Box4.ContentEditableViewFocusHelper"),a.resolve("Box4.ContentEditableViewTypingState"),a.resolve("Box4.SequenceCodeHelper"),a.resolve("Box4.SelectContentHelper"),
a.resolve("Box4.EditingDomDisplayManipulator"),a.resolve("Box4.EditViewStateManager"),a.resolve("Box4.BoundsSynchronizer"),a.resolve("Box4.EditingSurfaceStateManager"),a.resolve("Box4.EditingModeTransitionManager"),a.resolve("Box4.ParagraphOverlayPositioner"),a.resolve("Box4.IPasteHandler"),a.resolve("Box4.CompositionStateManager"),a.resolve("Box4.ImeManager"),a.resolve("Box4.ContentEditableViewGraphUpdater"),a.resolve("Box4.TypingProcessManager"),a.resolve("Box4.OvertypeUtils"),a.resolve("Box4.ContentEditableViewFloatieHandler"),
a.resolve("Box4.ContentEditableViewOnAfterValidateHandler"),a.resolve("Box4.ContentEditableViewOnBeforeValidateHandler"),a.resolve("Box4.EditingSurfaceEventHandlerManager"),a.resolve("Box4.ContentEditableViewDisposer"),a.resolve("Box4.IInteractiveEventHandler"),a.resolve("Box4.IContentEditableDomFactory"),Cb.App.XJa,a.resolve("Box4.IContentEditableModeHelper")))}init(){this.Da.resolve("Box4.EditingModeTransitionManager").dVb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.BoundsSynchronizer").dVb(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.ImeRecoveryUtils").dVb(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.AutocorrectActionExecutor").fS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewCursorManager").hei(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.SelectionChangeHandler").fS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.HybridTransitionManager").fS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewGraphUpdater").fS(this.Da.resolve("Box4.ContentEditableView"));
this.Da.resolve("Box4.TypingProcessManager").fS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnAfterValidateHandler").fS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.ContentEditableViewOnBeforeValidateHandler").fS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.EditingSurfaceEventHandlerManager").fS(this.Da.resolve("Box4.ContentEditableView"));this.Da.resolve("Box4.CompositionEventProcessor").fS(this.Da.resolve("Box4.ContentEditableView"))}dispose(){}static main(){m.a.instance.Bc(new Il)}}
Object(e.a)(Il,"ContentEditableViewPackage",null,[2,3]);class $m{get name(){return"PowerPointWebEditor.AutoFit"}Wb(){}init(){}dispose(){}static main(){m.a.instance.Bc(new $m)}}Object(e.a)($m,"PPTWebEditorAutoFitPackage",null,[2,3]);class Hj{constructor(a){this.Jv=a}}Object(e.a)(Hj,"DynamicScriptLoaderProvider",null,[1534]);var el=d(344),ql=d(232),ri=d(341);const un=(a,b)=>{var c=vn(b);c=a.identifier+c+".js";let f="";f=a.isLocalized?f+(u.AFrameworkApplication.lcid+"/"):f+Ci(b);return f+c},vn=()=>u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?
"":u.AFrameworkApplication.fa.Kw("IsServerFlavorDebug")?u.AFrameworkApplication.fa.ka("IsServerFlavorDebug")?"":".min":".min",Ci=a=>a&&u.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")&&!u.AFrameworkApplication.fa.ka("AppChromeOverrideIsCombinedBundle")&&!u.AFrameworkApplication.fa.ka("IsCombinedBundleEnabled")?"exp/":"",Jl=(a="anonymous",b="dynamicScriptLoaderDependencies")=>{const c={resolveScript:f=>{var l=el.AppChromeOverrideUtilities.Hwg(c.knownScripts,f.identifier);if(el.AppChromeOverrideUtilities.isEnabled&&
l)l=f.isLocalized?el.AppChromeOverrideUtilities.Lcg(u.AFrameworkApplication.lcid):el.AppChromeOverrideUtilities.CGb,f.isLocalized||(l+=Ci(!0)),f=l+f.identifier+el.AppChromeOverrideUtilities.EKc+".js";else if(ri.a.instance.isEnabled){var x=u.AFrameworkApplication.nfa;f=un(f,l);ri.a.instance.isEnabled&&(l=ri.a.instance.x0d(u.AFrameworkApplication.v0+f))&&(x=l+u.AFrameworkApplication.v0);Z.ULS.sendTraceTag(592228695,306,50,"Dynamic loading hashed resource for "+f);f=x+f}else if(x=vn(l),u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ScriptUrlFromNameNewIsEnabled",!1))f.isLocalized?f=u.AFrameworkApplication.Jj(f.identifier+x,3):(f=Ci(l)+f.identifier,f=u.AFrameworkApplication.Jj(f+x+".js",5));else{var G=u.AFrameworkApplication.nfa;G=f.isLocalized?G+(u.AFrameworkApplication.lcid+"/"):G+Ci(l);f=G+f.identifier+x+".js"}return f},resolveSriHash:f=>{const l=el.AppChromeOverrideUtilities.Hwg(c.knownScripts,f.identifier);ri.a.instance.isEnabled?(f=un(f,l),
f=ri.a.instance.$fj(u.AFrameworkApplication.v0+f)):f=null;return f}};c.crossOriginAttributeValue=a;c.knownScripts=window[b];return c};var Aa=d(26),wn=d(642);class Ij{constructor(){this.aoe=this.Pda=this.K=null;this.HLg=this.PKg=!1}get name(){return"PowerPointWebEditor.DynamicScriptLoader"}Wb(a){if(!a)throw Error.argumentNull("container");this.K=a;this.Pda=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");this.K.register(Hj,"Common.DynamicScriptLoaderProvider").as("Common.IDynamicScriptLoaderProvider").ma().na(()=>
{var b=window.self.EarlyDynamicScriptLoader;if(void 0===b||null===b){b=Jl();if(wn.a.mJj){const c=b.resolveScript;b.resolveScript=f=>{let l=wn.a.VTe(f.identifier+(el.AppChromeOverrideUtilities.isEnabled?el.AppChromeOverrideUtilities.EKc:".min")+".js");l||(l=c(f));return l}}this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseManagedScriptResourceLoading&&(b.loadScriptHandler=Object(C.a)(this,this.loadScript,"loadScript"));return new Hj(new dynamicScriptLoader.DynamicScriptLoader(b))}u.AFrameworkApplication.fa.ka("EnableDefaultDSLImpl")||
b.BXe&&b.BXe(Object(C.a)(this,this.loadScript,"loadScript"));return new Hj(b)});this.PKg=u.AFrameworkApplication.fa.ka("EarlyLazySprite");this.HLg=u.AFrameworkApplication.fa.ka("RibbonShimmerExperimentEnabled");u.AFrameworkApplication.fa.ka("LoadSLideGridJSEarly")&&Ij.rkc.push("slidegrid");Ij.rkc.push("comment-pane-strings");Ij.rkc.push("sharedcomments");Ij.rkc.push("floatingcontainermanager")}loadScript(a,b){let c=this.aoe;c&&c.isCompleted&&(this.aoe=c=null);const f=this.PKg&&Array.contains(Ij.rkc,
a),l=u.AFrameworkApplication.fa.ka("BootFilesInDelayScriptFactory")&&Array.contains(Ij.JYk,a)?this.Pda.hyi(b,Array.contains(Ij.Hjh,a),!(this.HLg&&Array.contains(Ij.dZk,a))):this.Pda.CRd(b,null,Array.contains(Ij.Hjh,a));f||(this.aoe=l.BEa);return new Promise((x,G)=>{const R=Date.now(),fa=()=>{l.BEa.continueWith(wa=>{if(6===wa.status)x(a);else{let Wa=String.format("Failed to download the script with identifier: {0} at url: {1}.",a,b);wa.Wi&&(Wa+=" "+wa.Wi.message);G(Error.create(Wa))}});Aa.a.J(540113033,
813,50,"LoadScript:: Identifier:{0}, DelayInMs:{1}",a,Date.now()-R);ql.a.Kx(l)};!c||f?fa():c.continueWith(()=>{fa()})})}init(){}dispose(){}}Ij.Hjh=["common","powerpoint-ribbon-intl","appChrome"];Ij.rkc="ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");Ij.JYk="common common50 ppt-ribbon-sprite-lazy ppt-ribbon-mlr-sprite-lazy powerpoint-ribbon-intl-lazy powerpoint-ribbon-mlr-intl-lazy powerpoint-ribbon-intl powerpoint-ribbon-mlr-intl appchrome".split(" ");
Ij.dZk=["common","appchrome"];Object(e.a)(Ij,"DynamicScriptLoaderPackage",null,[2,3]);var Ig=d(163),vf=d(94),xn=d(629),sc=d(52),Xf;(function(a){a[a.unknown=0]="unknown";a[a.orderlyShutdown=1]="orderlyShutdown";a[a.bootIncomplete=2]="bootIncomplete";a[a.podSessionRefreshed=3]="podSessionRefreshed";a[a.seamlessFailoverManager=4]="seamlessFailoverManager";a[a.inlineDocumentRepair=5]="inlineDocumentRepair"})(Xf||(Xf={}));Object(e.b)("RefreshDocTrigger",Xf);var Nc=d(41),Jf=d(84);class fl extends Sys.EventArgs{constructor(a,
b){super();this.XOj=b}}Object(e.a)(fl,"FailoverEventArgs",Sys.EventArgs,[]);var Xj=d(240),ff=d(107);class rl extends ff.a{constructor(a){super();this.FailedMachineId=null;this.FailedMachineId=a}Ok(){return 61}}Object(e.a)(rl,"CheckUnblockUIRequest",ff.a,[]);var Jj=d(857),ba=d(28);class Zl{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te){this.Rka=!1;this.cva=this.yqe=this.$Ea=this.gFa=this.mT=this.ls=null;this.la=a;this.yb=b;this.s9j=c;this.Af=f;this.ra=l;this.Fa=x;this.pC=G;
this.sZc=oc;this.$ab=Kc;this.Bm=R;this.U0j=fa;this.ua=wa;this.Zb=Wa;this.r9=mb;this.ue=Kb;this.Md=nc;this.cFa=Ic;this.ia=Hc;this.kC=ie;this.Tm=He;this.YVa=fe;this.aj=Te;this.X2j=this.la.podsFailoverRefreshDocSlideDrawTimeoutInMS;this.C6j=this.la.podsLegacyFailoverRefreshDocSlideDrawTimeoutInMS}ub(){this.ia.pa(ba.a.xFb,sc.a.application,Object(C.a)(this,this.PLk,"refeshDoc"),64)}PLk(a,b,c,f,l){this.aUe(l.failedMachineId,l.isPlanedShutdown,"podSessionId"in l?l.podSessionId:"","isPodSessionRefreshed"in
l&&l.isPodSessionRefreshed?3:"fromSeamlessFailoverManager"in l?4:"fromInlineDocumentRepair"in l?5:0);return 32}get Ci(){return this.Zb.Ci}qra(a){a.Y2b()&&a.qra()}aUe(a,b,c,f){if(!this.ue.ld.hermesFailOverImprovementIsEnabled||this.$ab())return!1;if(this.Rka||this.cFa.Kug)return!0;const l=this.Ci;if(!(l&&l.vi&&l.vi.Nw&&l.vi.Nw.id!==Ga.a.nil&&l.contentReplicator&&this.ua.presentation&&this.ua.presentation.id.equals(xn.a.Aze)))return!1;5===f&&this.rCf();this.Bm.pause();this.r9.suspend();this.pC.Nd&&
this.pC.Nd.endEditing(!1,14);this.pC.forEach(Object(C.a)(this,this.qra,"ensureGraphUpdated"));l.FS(!0)&&l.Yea();this.ra.setSelection(null);this.Fa.Ad();this.ls=Nc.a.Pl("RefreshDoc");this.ls.Wa("IsPlanedShutdown",b.toString());this.ls.Wa("PodSessionId",c);this.ls.Wa("RefreshDocTrigger",Xf[f]);Aa.a.J(512360801,809,50,"DocRefreshHandler::TryRefreshDoc:ActionID:{0}; ActionDetails:{1}",this.ls.actionId,this.ls.JJb());this.mT=a;b?(this.gFa=new Date,this.cFa.csh(),this.sZc.Cb(this.PQd())):this.bdh();this.kC.Tah(new fl(b,
!1));this.ua.presentation.AHe();this.Af.blockContent(this.ua.presentation,"RefreshDoc",!0);Aa.a.J(512360798,822,15,"DocRefreshHandler::TryRefeshDoc, Block Presentation");this.Md.disabled=!0;return this.Rka=this.ue.o7a().$8c=!0}rCf(){this.Bm.isPaused&&(Aa.a.J(512360797,801,50,"DocRefreshHandler::ActivateReplicationScheduler:  ReplicationScheduler was paused - UnPaused it"),this.Bm.Qib());try{this.Bm.QNf()}catch(a){Aa.a.J(512360796,801,15,"DocRefreshHandler::ActivateReplicationScheduler CancelBlockedOperation failed. {0}",
a)}}PQd(){return this.$Ea=new Xj.a(new rl(this.mT),Object(C.a)(this,this.Rwe,"onCheckUnBlockUISuccess"),Object(C.a)(this,this.Qwe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}bdh(){this.ls.Wa("FailedMachineId",this.mT);this.yqe=new Date;this.s9j.xFb(this.mT,this.ls,!this.ue.ld.refreshDocSynchronouslyIsEnabled,!1,Object(C.a)(this,this.pKi,"docRefreshSuccessCallback"),Object(C.a)(this,this.oKi,"docRefreshFailedCallback"));this.U0j.Qva()}Rwe(){this.cFa.aRc();this.ls.Wa("DeploymengUIBlockingTime",
(+new Date-+this.gFa).toString());this.ls.Wa("CheckUnblockUISucceeded","True");this.bdh()}Qwe(a){if(142===a.ServerError.Code)return Aa.a.J(512360795,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.mT,+new Date-+this.gFa),this.sZc.Cb(this.$Ea),!0;this.ls.Wa("DeploymengUIBlockingTime",(+new Date-+this.gFa).toString());this.ls.Wa("CheckUnblockUISucceeded","False");this.cFa.aRc();return this.C1g(a)}pKi(){this.Tm.uId(Object(C.a)(this,this.Fye,
"onSlideDrawComplete"));this.cva&&this.yb.Ng(this.cva);const a=this.ls.DJ("RefreshDocTrigger");this.cva=new xe.a(2,1,a&&1===a.length&&"podSessionRefreshed"===a[0]?this.X2j:this.C6j,Object(C.a)(this,this.onSlideDrawTimeout,"onSlideDrawTimeout"),90,"62");this.yb.Cb(this.cva);a&&1===a.length&&"inlineDocumentRepair"===a[0]&&this.rCf()}oKi(a){return this.C1g(a)}Fye(){Z.ULS.sendTraceTag(512360794,821,50,"DocRefreshHandler::OnSlideDrawComplete");this.cva&&(this.yb.Ng(this.cva),this.cva=null);this.Tm.Ked(Object(C.a)(this,
this.Fye,"onSlideDrawComplete"));this.ls&&(this.ls.Wa("ReStoreStatusAfterRefreshStartTime",Nc.a.$e(new Date)),this.r9.resume(),this.ls.Wa("SlideDrawResult","True"),this.ls.Om("SlideDrawCompleteET",new Date),this.Bm.isPaused&&this.Bm.Qib(),this.ls.Wa("LoadAndRenderTime",(+new Date-+this.yqe).toString()),this.ue.ld.aFe||this.ue.o7a().Sva(),this.ls.Wa("ReStoreStatusAfterRefreshEndTime",Nc.a.$e(new Date)),this.sye(!0),this.YVa.jbh(new Jj.a("DocRefresh")),this.aj.jjb=2,u.AFrameworkApplication.Mfb(Jf.a.Qh(180),
Ig.a.unknown,Ig.a.Ooc),vf.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null))}onSlideDrawTimeout(){this.Tm.Ked(Object(C.a)(this,this.Fye,"onSlideDrawComplete"));this.cva&&(this.yb.Ng(this.cva),this.cva=null);Z.ULS.sendTraceTag(512360793,821,10,"DocRefreshHandler::OnSlideDrawTimeout");this.ls.Wa("SlideDrawResult","False");this.sye(!1);this.DUk()}DUk(){this.Md.disabled=!1;u.AFrameworkApplication.jp(Jf.a.Qh(379));vf.Health.instance.recordQosError("RefreshDocTimeout",
["UnexpectedAppRefresh"],!1,!1,!0,!0,null);u.AFrameworkApplication.Ku&&u.AFrameworkApplication.Ku.v7();this.ia.La(ba.a.refresh,2,{refreshtrigger:"DocRefreshHandler::ReportErrorAndRefreshPage"})}C1g(a){Z.ULS.sendTraceTag(512360792,821,50,"DocRefreshHandler:OnRefreshFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Jh);this.sye(!1);return!1}sye(a){this.Rka=
!1;this.$Ea=this.mT=null;this.yqe=new Date(0);Nc.a.T6b=new Date;this.ls&&(this.ls.Wa("Result",a?"Success":"Failed"),this.ls.finish(!0),this.ls=null);this.Md.disabled=!1;this.ue.o7a().$8c=!1;this.Af.GJ(this.ua.presentation)}}Object(e.a)(Zl,"DocRefreshHandler",null,[1383]);var bg=d(152);class vi{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.Rka=!1;this.$Ea=this.gFa=this.mT=this.ls=null;this.ia=a;this.pi=b;this.Ei=c;this.Af=f;this.ra=l;this.Fa=x;this.Bm=G;this.ua=R;this.r9=fa;this.cFa=wa;this.Xa=
Wa;this.la=mb;this.$ab=Kb;this.la.tvg&&this.Ei.IB(Object(C.a)(this,this.gB,"onSessionEnd"))}ub(){this.ia.pa(ba.a.failover,sc.a.application,Object(C.a)(this,this.Gnj,"handleFailover"),64)}gB(){this.Bm.isPaused||this.Bm.pause()}Gnj(a,b,c,f,l){if(1===c||this.$ab()||this.Rka||this.cFa.Kug)return 32;this.mT=l;if(!this.mT)return 8;this.ls=Nc.a.Pl("SeamlessFailover");this.Bm.pause();this.r9.suspend();this.ra.setSelection(null);this.Fa.Ad();this.Af.blockContent(this.ua.presentation,"SeamlessFailover",!0);
Aa.a.J(37106114,822,15,"SeamlessFailoverHandler::HandleFailover, Block Presentation");this.gFa=new Date;this.cFa.csh();this.Ei.Tah(new fl(!0,!0));u.AFrameworkApplication.Prb();this.pi.QAc(this.PQd());this.Rka=!0;return 32}PQd(){return this.$Ea=new Xj.a(new rl(this.mT),Object(C.a)(this,this.Rwe,"onCheckUnBlockUISuccess"),Object(C.a)(this,this.Qwe,"onCheckUnBlockUIFailed"),a=>0===a.StatusCode&&!a.ServerError,3)}Rwe(){this.cFa.aRc();this.ls.Wa("DeploymengUIBlockingTime",(+new Date-+this.gFa).toString());
this.ls.Wa("CheckUnblockUISucceeded","True");this.ls.Wa("FailedMachineId",this.mT);this.Xa.jsb=this.mT;this.nJk()}Qwe(a){if(142===a.ServerError.Code)return Aa.a.J(22315610,822,50,"UnBlockUI failed with ErrorBlockUIUnderDeployment, failed machine: {0}, UI blocking time in ms: {1}",this.mT,+new Date-+this.gFa),this.pi.QAc(this.$Ea),!0;this.ls.Wa("DeploymengUIBlockingTime",(+new Date-+this.gFa).toString());this.ls.Wa("CheckUnblockUISucceeded","False");this.cFa.aRc();return this.$lk(a)}nJk(){this.ls.Wa("ReStoreStatusAfterRefresh",
Nc.a.$e(new Date));this.Bm.Qib();this.r9.resume();this.u_g(!0);u.AFrameworkApplication.Mfb(Jf.a.Qh(180),Ig.a.unknown,Ig.a.Ooc);vf.Health.instance.recordQosError("AppRebooted",["UnexpectedAppRefresh"],!1,!1,!0,!1,null)}$lk(a){Z.ULS.sendTraceTag(22315611,821,50,"SeamlessFailoverHandler:OnFailoverFailed Original error Code:{0}, Source:{1}, ExtraParam:{2}, Correlation:{3}",a.ServerError.Code,a.ServerError.Source,a.ServerError.ExtraErrorParam?a.ServerError.ExtraErrorParam.join(","):"empty",a.Jh);this.u_g(!1);
a.ServerError=Object.assign(new bg.a,{Code:157,Source:0});return!1}u_g(a){this.Rka=!1;this.$Ea=this.mT=null;this.ls&&(this.ls.Wa("Result",a?"Success":"Failed"),this.ls.finish(),this.ls=null);this.Af.GJ(this.ua.presentation)}dispose(){this.la.tvg&&this.Ei.Oea(Object(C.a)(this,this.gB,"onSessionEnd"))}}Object(e.a)(vi,"SeamlessFailoverHandler",null,[106]);var Vg=d(245),Di=d(104),Ei=d(1119),Li=d(286),Kl=d(811),gl=d(225),lm=d(614);class Gm{constructor(a,b,c,f,l){if(!a)throw Error.argumentNull("actionManager");
this.ia=a;this.la=b;this.M8=c;this.WA=f;this.fc=l;this.Uab=!1}Zu(a,b=!1,...c){this.PYb.apply(this,[Jf.a.Qh(a),this.M8.IOc(a),this.M8.d4d(a),this.M8.z1d(a),b].concat(c))}PYb(a,b,c,f,l=!1,...x){if(!Vg.a.Mw){var G=2,R=!1;if(a===Jf.a.Qh(83))this.la.HPj&&(c=ResourceStrings.l_CannotPasteImageTitle,f=ResourceStrings.l_SuggestionToInsertPicture,G=3);else if(a===Jf.a.Qh(8)||a===Jf.a.Qh(256)||a===Jf.a.Qh(257)||a===Jf.a.Qh(291))G=0,R=!0;x&&0<x.length&&(f=String.format.apply(null,[f].concat(x)));this.it(new lm.a(a,
c,f,b,G),l,R)}}it(a,b=!1,c=!1){let f=a.Wdd;var l=Jf.a.RS(a.Pm)?gl.a[Jf.a.SM(a.Pm)]:"";Aa.a.J(512497111,801,15,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}; ErrorName: {1}, SuppressErrorReporting: {2}, ShowFeedbackButtonEnabled: {3}, ClientActions - None: {4}, Dismiss: {5}, Close: {6}, OpenInClient: {7}, Refresh: {8}, HideFeedback: {9}, Repair: {10}",a.Pm,l,b,u.AFrameworkApplication.sE,0===f,!!(f&1),!!(f&2),!!(f&4),!!(f&8),!!(f&16),!!(f&64));if(this.bcl(a))Aa.a.J(512497110,801,50,"ErrorDialog::ShowErrorDialog Skip showing error {0} to users.",
a.Pm);else{l=new Di.StandardDialog;var x=null,G=!1,R=this.fc.ka("UserCanWriteRelative");f&64&&Aa.a.J(512497109,801,50,"ErrorDialog::ShowErrorDialog. User's Access level:{0}",this.fc.Ga("DocumentPermissions")||"");var fa=!1;f&64&&this.la.pptFileRecoveryEnabled&&(fa=!0);f&64&&!R&&Aa.a.J(512497108,801,50,"ErrorDialog::ShowErrorDialog. We found a repairable error but user has no permission to write relative, but inline repair is enabled. Will try to repair.");!fa&&f&64&&(c=!1,f=this.vwl(a));R=!!(f&4)&&
!(u.AFrameworkApplication.Uzh||u.AFrameworkApplication.mQ);var wa=!!(f&2)&&u.AFrameworkApplication.Cca;c=c?ResourceStrings.l_OpenInApp:ResourceStrings.L_OpenInPowerPoint;l.qr=wa||!!(f&1);f&8?(l.yd=0,x=Object(C.a)(this,this.ced,"refreshActionHandler"),Array.contains(this.la.hermesRefreshErrorSuppressionList,a.Pm.toString())?l.DO(Ei.a.I2(a.title),Ei.a.I2(a.message),x):(Aa.a.J(512497107,801,50,"ErrorDialog::ShowErrorDialog BSQMErrorCode: {0}.",a.Pm),l.Ue(1,ResourceStrings.L_Refresh),l.jy(a.Pm,Ei.a.I2(a.title),
Ei.a.I2(a.message),x,b)),G=this.Uab=!0):fa?(Aa.a.J(512497106,801,50,"ErrorDialog::ShowErrorDialog. We met an error need to repair. ErrorCode: {0}",a.Pm),this.ia.processAction(ba.a.repair,2)):wa&&R?(l.yd=4,l.Ue(1,c),l.Ue(2,ResourceStrings.L_Close),x=Object(C.a)(this,this.Rsk,"openOrCloseActionHandler"),this.Uab=!0):R?(l.yd=0,l.Ue(1,c),x=Object(C.a)(this,this.R$c,"openInClientActionHandler"),this.Uab=!0):wa?(l.yd=0,l.Ue(1,ResourceStrings.L_Close),x=Object(C.a)(this,this.oqi,"closeActionHandler"),this.Uab=
!0):(c=!!(f&1)||0===f,l.qr=c,l.yd=c?0:5);G||fa||(f&16&&f&32?(b||u.AFrameworkApplication.jp(a.Pm),l.XYa=!1,l.nx(Ei.a.I2(a.title),Ei.a.I2(a.message),a.icon,x)):l.jy(a.Pm,Ei.a.I2(a.title),Ei.a.I2(a.message),x,b));this.Uab&&this.WA&&this.WA.closeSession(4);this.Uab?vf.Health.instance.recordQosError(Jf.a.tba(a.Pm),["NonDismissibleDialog"],!1,!1,!0,!0,null):vf.Health.instance.recordQosError(Jf.a.tba(a.Pm),["DismissibleDialog"],!1,!1,!0,!1,null)}}get EUc(){return this.Uab}vwl(a){Aa.a.J(512497105,801,15,
"ErrorDialog::UpdateErrorWhenRepairDisabled. We found a repairable error but user has no permission to repair. Falling back to generic error dialog.");a.message=a.Pm===Jf.a.Qh(8)||a.Pm===Jf.a.Qh(43)?ResourceStrings.errorMessage_EditSlideCorruption:ResourceStrings.errorMessage_CannotOpenDocument;a.title=ResourceStrings.errorTitle_PowerpointStandard;a.icon=2;return 6}R$c(a,b){Aa.a.J(512497104,801,50,"Button={0};DontShowAgain={1}",a,b);1===a&&this.E9g()}Rsk(a,b){Aa.a.J(512497103,801,50,"Button={0};DontShowAgain={1}",
a,b);1===a?this.E9g():this.ia.La(ba.a.wsb,2,Li.c)}oqi(a,b){Aa.a.J(512497102,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.La(ba.a.wsb,2,Li.c)}ced(a,b){Aa.a.J(512497101,801,50,"Button={0};DontShowAgain={1}",a,b);this.ia.La(ba.a.refresh,2,{refreshtrigger:"ErrorDialog::RefreshActionHandler"})}E9g(){(new Kl.a(E.a.openInClient)).y9d()}bcl(a){return a.Pm===Jf.a.Qh(83)&&(u.AFrameworkApplication.DN("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorCannotPastePictureNotFoundSettings"),this.la.dgl)||
a.Pm===Jf.a.Qh(56)&&(u.AFrameworkApplication.DN("Microsoft.Office.Server.Powerpoint.Web.IPptSkipErrorLocalChangeLostCoauthSettings"),this.la.egl)?!0:!1}}Object(e.a)(Gm,"ErrorDialog",null,[1381]);var Gh=d(279),bf=d(125),Ll=d(508),Hm=d(974),re=d(38);class M extends Sys.EventArgs{constructor(){super();this.WAa=this.NB=0;this.message=this.title=null}}Object(e.a)(M,"BeforeHandleErrorEventArgs",Sys.EventArgs,[]);class ca extends M{constructor(a){super();this.XPa=null;this.errorCode=a;this.NB=0}}Object(e.a)(ca,
"OnBeforeHandleClientErrorEventArgs",M,[]);class Na extends M{constructor(){super();this.NB=0}}Object(e.a)(Na,"OnBeforeHandleServerErrorEventArgs",M,[]);class zb extends Sys.EventArgs{constructor(a,b,c){super();this.bO=a;this.Q2j=b;this.uh=c}get podSessionId(){return this.bO}get kKc(){return this.Q2j}get errorCode(){return this.uh}}Object(e.a)(zb,"PodSessionUnavailableEventArgs",Sys.EventArgs,[]);class $b{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){this.Ole=!1;this.U3j=[8];this.hme={["Generic"]:CommonUIStrings.l_DecryptSkipReasonGeneric,
["DecryptionDefered"]:CommonUIStrings.l_DecryptSkipReasonDecryptionDefered,["EncryptedOutsideSharepoint"]:CommonUIStrings.l_DecryptSkipReasonEncryptedOutsideSharepoint,["UnsupportedMsoDataStore"]:CommonUIStrings.l_DecryptSkipReasonUnsupportedMsoDataStore,["PasswordProtected"]:CommonUIStrings.l_DecryptSkipReasonPasswordProtected,["ContentExpiryLabel"]:CommonUIStrings.l_DecryptSkipReasonContentExpiryLabel,["InvalidLabelOwner"]:CommonUIStrings.l_DecryptSkipReasonInvalidLabelOwner,["DeletedLabel"]:CommonUIStrings.l_DecryptSkipReasonDeletedLabel,
["LabelProtectionChanged"]:CommonUIStrings.l_DecryptSkipReasonLabelProtectionChanged,["UnsupportedLabel"]:CommonUIStrings.l_DecryptSkipReasonLabelUnsupportedLabel,["DoubleKeyDisabled"]:CommonUIStrings.l_DecryptSkipReasonLabelDoubleKeyDisabled};this.disabled=!1;this.M8=a;this.L8=b;this.yl=c;this.fHg=f;this.ia=l;this.Xa=x;this.fc=G;this.Ob=R;this.DAb=fa;this.D3e=!1;this.Bm=wa;this.WA=Wa;this.Ho=Kb;this.vj=nc;this.ue=mb}es(a,b,c=null,f=!1){if(this.disabled)return Z.ULS.sendTraceTag(512263053,804,50,
"Ignore server error {0}",a?a.Code:315),!0;this.WA.Ick();if(this.WA.l8)return Z.ULS.sendTraceTag(512263052,804,15,"GlobalErrorHandler:HandleServerError - Ignore server error since session is already closed. ErrorCode:{0}",a?a.Code:315),!0;let l=!1,x=0,G=0,R=null;var fa=null;c&&(fa=new Na,l=c(fa),x=fa.NB,G=fa.WAa,R=fa.title,fa=fa.message);l||(l=this.orj(a,b));l||(b=a?a.Code:315,a=a?a.ExtraErrorParam:null,this.aRi(b)&&(this.D3e=!0,this.Bm.pause()),a?this.jy.apply(this,[x,b,G,R,fa,f].concat(a)):this.jy(x,
b,G,R,fa,f));return l}orj(a,b){if(!a)return!1;Z.ULS.sendTraceTag(512263051,821,15,"{0} - Error Code:{1} Source:{2} ExtraParam:{3}","GlobalErrorHandler:HandleServerErrorInternal",a.Code,a.Source,a.ExtraErrorParam?a.ExtraErrorParam.join(","):"empty");if(153===a.Code)return Gh.a.instance.JEe(Date.now()),Gh.a.xXc(u.AFrameworkApplication.userSessionId),u.AFrameworkApplication.Mfb(Jf.a.Qh(153),Ig.a.unknown,Ig.a.Ooc),({uSe:c}=Gh.a.instance.pAh()).returnValue&&Z.ULS.sendTraceTag(512263050,804,50,"{0} - Data Center Redirect - Time duration from user launch browser to redirection starting {1}",
"GlobalErrorHandler:HandleServerErrorInternal",(new Date).getTime()-c),a.ExtraErrorParam?this.ILk(a.ExtraErrorParam[0]):Z.ULS.sendTraceTag(512263049,804,10,"{0} - Data Center Redirect missing RedirectUrl","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(142===a.Code&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length)return(2===a.ExtraErrorParam.length?32===this.ia.La(ba.a.failover,2,a.ExtraErrorParam[0]):this.fHg.aUe(a.ExtraErrorParam[0],!0,this.Xa.podSessionId||"",1))||this.jy(0,157,0,null,null),
!0;if(274===a.Code)return Z.ULS.sendTraceTag(512263048,804,10,"{0} - Pods session is locked for edit/merge. Local change could be lost","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(4===a.Code&&this.Ho.instance&&!Ka.a.Va(this.Xa.CKc))return Z.ULS.sendTraceTag(512263047,801,15,"Triggering rehydration for password files from GlobalErrorHandler"),this.Ho.instance.mTe(!1,0,a.Code),!0;if(157===a.Code&&2===a.Source&&a.ExtraErrorParam&&0<a.ExtraErrorParam.length){var c=1<a.ExtraErrorParam.length?
a.ExtraErrorParam[1]:"";return this.fc.ka("685")&&c.toLowerCase()!==this.Xa.podSessionId.toLowerCase()?(Aa.a.J(512263046,801,15,"{0} - Replication cache request boot incomplete failures were ignored, ServerReturnPodSessionSeed: {1}; SessionInfoSeed: {2}.","GlobalErrorHandler:HandleServerErrorInternal",c,b),!0):this.fc.ka("884")&&this.Ole?(Aa.a.J(512263045,801,15,"{0} - Ignore bootIncomplete error after SaveAndClose( ReleaseLock=true ).","GlobalErrorHandler:HandleServerErrorInternal"),!0):this.fHg.aUe(a.ExtraErrorParam[0],
!1,this.Xa.podSessionId||"",2)}if(223===a.Code||285===a.Code||362===a.Code||this.fc.ka("560")&&229===a.Code||this.fc.ka("914")&&this.Ho.instance&&this.Ho.instance.IRi(a.Code)){if(b!==this.Xa.podSessionId)return Aa.a.J(512263044,801,15,"{0} - PodSessionId mismatch, skip failover signal. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;if(this.fc.ka("914")&&this.Ho.instance&&this.Ho.instance.CZ)return Aa.a.J(512263043,801,15,
"{0} - SeamlessFailover is ongoing. FailedPodSessionId:{1}; CurrentPodSessionId:{2}","GlobalErrorHandler:HandleServerErrorInternal",b,this.Xa.podSessionId),!0;Aa.a.J(512263042,801,15,"{0} - RaisePodSessionUnavailableEvent, serverErrorCode:{1};","GlobalErrorHandler:HandleServerErrorInternal",a.Code);this.DAb.OHk(new zb(this.Xa.podSessionId,!!a.ExtraErrorParam&&!!a.ExtraErrorParam.length&&"PodsOrderlyShutdown"===a.ExtraErrorParam[0],a.Code));return!0}if(389===a.Code||292===a.Code&&3===a.Source)return a=
this.Ob.notificationBar.nBa(ResourceStrings.L_DeepLinking_BootSlideNotFound,!1),this.fc.ka("IsAutomation")?a.displayTimeoutSeconds=this.fc.Cc("PodDeepLinkingToastMessageDisplayTimeMsForAutomation",a.displayTimeoutSeconds)/1E3:Aa.a.J(512263041,804,15,"{0} - Deep link - Slide not found","GlobalErrorHandler:HandleServerErrorInternal"),this.Ob.notificationBar.Wh(a),!0;if(238===a.Code&&this.fc.ka("561")&&this.Ho.instance&&this.Ho.instance.CZ)return Aa.a.J(512263040,801,50,"{0} - SessionBootInProgress during seamless failover, skipped",
"GlobalErrorHandler:HandleServerErrorInternal"),!0;if(329===a.Code)return Aa.a.J(512263011,801,15,"{0} - PreconditionFailed error due to host integration ID mismatch, silent fail","GlobalErrorHandler:HandleServerErrorInternal"),this.rth(a.Code,null),!0;if(104===a.Code)return b=2===this.vj.Cba,a.Code=b?56:105,Aa.a.J(512263010,801,15,"{0} - LocalChangeLost seen when user is {1}. Returning {2}.","GlobalErrorHandler:HandleServerErrorInternal",b?"co-authoring":"alone",gl.a[a.Code]),this.jy(0,a.Code,0,
null,null),!0;if(this.HFj(a.Code)&&2!==this.fc.state)return Aa.a.J(512263009,801,15,"{0} - Skip check file error if it under retry","GlobalErrorHandler:HandleServerErrorInternal"),!0;if(117===a.Code){if((b=a.ExtraErrorParam)&&2===b.length&&"GB"===b[1])return this.jy.apply(this,[0,a.Code,0,null,ResourceStrings.errorMessage_CannotOpenDocumentTooLargeGB,!1].concat(b)),!0}else if(432===a.Code)return this.jy.apply(this,[1,a.Code,8,null,ResourceStrings.errorMessage_UserNetworkLocationUnauthorized,!1].concat(a.ExtraErrorParam)),
!0;return!1}FG(a,b){if(this.disabled)return Z.ULS.sendTraceTag(512263008,804,50,"Ignore client error {0}",a),!0;let c=!1,f=0,l=0,x=null,G=null;var R=null;b&&(R=new ca(a),c=b(R),f=R.NB,l=R.WAa,x=R.title,G=R.message,R=R.XPa);c||(c=!1);c||(R?this.jy.apply(this,[f,a,l,x,G,!1].concat(R)):this.jy(f,a,l,x,G));return c}jy(a,b,c,f,l,x=!1,...G){0===a&&(a=this.M8.rcj(b));0===c&&(c=this.M8.IOc(b));f||(f=this.M8.d4d(b));l||(3===b&&this.fc.ka("DecryptSkipReasonIRMErrorEnabled")?l=this.U3i():(Aa.a.J(512263007,801,
50,"GlobalErrorHandler::ShowError errorCode != ErrorCannotOpenDocumentIRM"),l=this.M8.z1d(b)));const R=()=>{this.ydl.apply(this,[a,b,c,f,l,x].concat(G))};2===this.fc.state?R():this.fc.ff(R)}U3i(){Aa.a.J(512263006,801,50,"GlobalErrorHandler::GetDetailedIRMError DecryptSkipReason = "+u.AFrameworkApplication.sYb);return u.AFrameworkApplication.sYb&&this.hme[u.AFrameworkApplication.sYb]?this.hme[u.AFrameworkApplication.sYb]:this.hme.Generic}ydl(a,b,c,f,l,x,...G){if(2===a){let R;(R=this.yl).PYb.apply(R,
[b,c,f,l].concat(G))}else 3===a?this.rth.apply(this,[b].concat(G)):this.gra.apply(this,[Jf.a.Qh(b),c,f,l,x].concat(G))}gra(a,b,c,f,l,...x){0===b&&(b=this.M8.IOc(Jf.a.SM(a)));if(Hm.GraphSpaceRootReplicator.Eyg(Jf.a.SM(a))&&x&&0<x.length){this.Xa.Zed=x[0];var G=new Ha.a;for(var R=1;R<x.length;R++)G.add(x[R]);x=G.toArray()}G=Object.assign(new Ll.a,{Type:6,Token:this.ue.ld.Cgc,Data:{["Reason"]:"FatalError",["ErrorName"]:Jf.a.tba(a)}});re.a("PPT.BootstrapperMessageNewValues")&&(G.MessageId=bf.a.MCh,R=
{Reason:"FatalError"},R.ErrorName=G.Data.ErrorName,G.Values=R);window.parent.postMessage(Yd.c(G),"*");Z.ULS.sendTraceTag(512263005,804,15,"GlobalErrorHandler:DisplayErrorDialog: {0}",a);let fa;(fa=this.L8).PYb.apply(fa,[a,b,c,f,l].concat(x))}ILk(a){ib.a.openWindow(1,a)}get jja(){return this.Ole}set jja(a){this.Ole=a;Aa.a.J(512263004,801,50,"GlobalErrorHandler::IgnoreBootIncompleteFailure is set to {0}",a)}get mVd(){return this.D3e}qId(){}QId(){}rth(a,...b){const c=Jf.a.Qh(a);Aa.a.J(512263003,801,
50,"GlobalErrorHandler::SilentFail BSQMErrorCode: {0}; ErrorCode:{1}, ErrorParams:{2}",c,a,b?b.join(","):"");u.AFrameworkApplication.jp(c);vf.Health.instance.recordQosError(Jf.a.tba(c),["SilentFailure"],!1,!0,!0,!1,null)}HFj(a){return 288===a||300===a||301===a||302===a||303===a?!0:!1}aRi(a){return Array.contains(this.U3j,a)?!0:!1}}Object(e.a)($b,"GlobalErrorHandler",null,[1384,1446]);class Tc{constructor(a){this.i9b=!1;this.lX=null;this.Ws=a}get Kug(){return this.i9b}csh(){var a=ResourceStrings.errorTitle_PowerpointEditingStandard,
b=ResourceStrings.errorMessage_BlockUIUnderDeployment;this.i9b||(this.lX=new Oa.a,this.lX.yd=5,this.lX.message=Ei.a.I2(b),this.lX.qr=!1,Aa.a.J(22315662,822,50,"Showing UI blocking dialog to prompt user we are deploying"),this.lX.wna(Ei.a.I2(a),null,null),this.i9b=!0,this.Ws.kKf(!0))}aRc(){this.i9b&&(this.lX.hide(),this.i9b=!1,this.lX=null,this.Ws.kKf(!1))}}Object(e.a)(Tc,"DeployingDialog",null,[1379]);var hd=d(984),Hd=d(423),le=d(635),ge=d(410),Zd=d(155),Oe=d(61),tc=d(887);class Xh{constructor(a,
b,c,f,l,x,G){this.hda=this.jg=this.izb=this.czb=null;this.h_c=!1;this.y_c=this.m5c=this.gYc=null;this.Rka=!1;this.ua=a;this.Zb=b;this.zq=c;this.Qb=f;this.sZc=l;this.xHg=x;this.Ho=G}get Ci(){return this.Zb.Ci}xFb(a,b,c,f,l,x){this.Rka||(this.Rka=!0,this.h_c=c,this.jg=b,this.m5c=l,this.y_c=x,this.Ho.instance&&this.Ho.instance.YGd("abortedOnRefreshDoc"),this.xHg&&this.xHg(),this.sZc.Cb(this.$Bi(a,f)))}$Bi(a,b){let c=this.ua.Ba&&!Oe.a.Sw(this.ua.Ba.Bb)?this.ua.Ba.Bb:Oe.a.empty;c=b?Oe.a.empty:c;this.jg.Wa("CurrentActiveSlideId",
c.toString());this.gYc=Oe.a.Sw(c)?Oe.a.empty:c;return new Xj.a(new tc.a(c,a),Object(C.a)(this,this.umk,"onGetCellSuccess"),Object(C.a)(this,this.tmk,"onGetCellFailed"),Object(C.a)(this,this.fBl,"validateResponse"))}fBl(a){return!a.ServerError&&0===a.StatusCode&&a&&a.Cells&&a.Cells.length?(a=a.Cells[a.Cells.length-1])&&a.RevisionList?0<a.RevisionList.length:!1:!1}umk(a){this.jg.Wa("GetCells",a.Jh);a=new hd.a(null,Object(C.a)(this,this.sxj,"inboundSetup"),a);a.Xi=!this.h_c;a.Fl("RefreshUIOperation");
a.run()}tmk(a){this.jg.Wa("GetCells",a.Jh);200!==a.HttpStatusCode&&this.jg.Wa("GetCellsHttpStatusCode",a.HttpStatusCode.toString());if(this.y_c&&this.y_c(a))return!0;a.ServerError=Object.assign(new bg.a,{Code:294,Source:0});vf.Health.instance.recordQosError("RefreshDocFailed",["UnexpectedAppRefresh"],!1,!0,!0,!0,null);return!1}sxj(a,b){(this.hda=this.Zb.nn)&&this.hda.pM&&this.hda.pM.IXc();this.hda&&this.hda.$o&&(this.hda.pM=new le.a(yg.a.instance,"FailoverView"));this.jg.Wa("InboundSetupStartTime",
Nc.a.$e(new Date));if(re.a("UseBuildIncrementalInboundOperation"))this.Zb.Ba=null,this.czb=this.Ci.contentReplicator.aLf(b);else{const c=b.Cells[b.Cells.length-1],f=this.Ci.vi.Nw.id;c.RevisionList[0].BaseId=Zd.a(f);this.Zb.Ba=null;this.czb=new Hd.a(c,f,!1,new Date,b.Jh,!1,!1,!1)}this.izb=this.zq.ke(3);this.izb.gd(this.ua.presentation);this.h_c&&this.izb.oU(a);a.Zg(Object(C.a)(this,this.lja,"inboundIncrementally"));this.jg.Wa("InboundSetupEndTime",Nc.a.$e(new Date));return!0}lja(a){this.jg.Wa("InboundIncrementallyStartTime",
Nc.a.$e(new Date));this.Ci.contentReplicator.lja(this.czb,new Date);this.czb.eQ&&(this.izb.dispose(),a.Zg(Object(C.a)(this,this.l2k,"setActiveSlideAndRender")),this.izb=this.czb=null,this.jg.Wa("InboundIncrementallyEndTime",Nc.a.$e(new Date)));return!0}l2k(a){this.jg.Wa("SetActiveSlideAndRenderStartTime",Nc.a.$e(new Date));a.Zg(Object(C.a)(this,this.CUi,"finishRefreshDoc"));if(Oe.a.empty.equals(this.gYc))return this.jg.Wa("SetActiveSlideAndRenderEndTime",Nc.a.$e(new Date)),!0;const b=this.Qb.kl(this.gYc);
if(!b)return this.jg.Wa("SetActiveSlideAndRenderEndTime",Nc.a.$e(new Date)),!0;const c=this.zq.ke(3);try{c.gd(b),this.h_c&&c.oU(a),this.Zb.Ba=b}finally{c&&c.dispose()}this.jg.Wa("SetActiveSlideAndRenderEndTime",Nc.a.$e(new Date));return!0}CUi(){this.m5c&&this.m5c();this.hda&&this.hda.pM&&(this.hda.pM.IXc(),this.hda.pM=new ge.a);this.b5();return!1}b5(){this.Rka=!1;this.y_c=this.m5c=this.gYc=this.hda=this.jg=this.izb=this.czb=null}}Object(e.a)(Xh,"RefreshDocExecutor",null,[1382]);class ii{z1d(a){switch(a){case 1:a=
ResourceStrings.errorMessage_Unknown;break;case 14:a=ResourceStrings.errorMessage_Unknown;break;case 2:a=ResourceStrings.errorMessage_CannotOpenDocumentFileType;break;case 3:a=ResourceStrings.errorMessage_CannotOpenDocumentIRM;break;case 4:a=ResourceStrings.errorMessage_CannotOpenDocumentPassword;break;case 41:a=ResourceStrings.errorMessage_CannotOpenDocumentGatekeeperFailure;break;case 33:a=ResourceStrings.errorMessage_CannotOpenDocumentMacro;break;case 34:a=ResourceStrings.errorMessage_CannotOpenDocumentFinal;
break;case 35:a=ResourceStrings.errorMessage_CannotOpenDocumentSigned;break;case 36:a=ResourceStrings.errorMessage_CannotOpenEmbeddedFonts;break;case 5:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 6:a=ResourceStrings.errorMessage_CannotInstallFonts;break;case 7:a=ResourceStrings.errorMessage_CannotConvertModifyPassword;break;case 8:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 306:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 9:a=ResourceStrings.errorMessage_CannotComposeSlideUnexpected;
break;case 10:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 12:a=ResourceStrings.errorMessage_GenericSlideCorruption;break;case 15:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 16:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 17:a=ResourceStrings.errorMessage_FailedToRenderDocument;break;case 18:a=ResourceStrings.errorMessage_FailedToRenderSlide;break;case 20:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 21:a=ResourceStrings.errorMessage_InvalidCommand;
break;case 22:a=ResourceStrings.errorMessage_DocVersionMismatch;break;case 23:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 58:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 24:a=ResourceStrings.errorMessage_RequiresCheckout;break;case 25:a=ResourceStrings.errorMessage_LockedForOfflineCheckout;break;case 26:a=ResourceStrings.errorMessage_LockedByAnotherUser;break;case 27:a=ResourceStrings.errorMessage_AccessDenied;break;case 28:a=ResourceStrings.errorMessage_NoLicense;
break;case 29:a=ResourceStrings.errorMessage_Unknown;break;case 30:a=ResourceStrings.errorMessage_TextTooBig;break;case 31:a=ResourceStrings.errorMessage_TryAgain;break;case 37:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 32:a=ResourceStrings.errorMessage_Unexpected;break;case 11:a=ResourceStrings.errorMessage_FailedToRetrieveResource;break;case 13:a=ResourceStrings.errorMessage_FileNotFoundOrPermissionDenied;break;case 38:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 39:a=
ResourceStrings.errorMessage_PptEditExistingExclusiveLock;break;case 40:a=ResourceStrings.errorMessage_PptEditCheckedOutByAnother;break;case 42:a=ResourceStrings.errorMessage_EditWorkerTimeout;break;case 43:a=ResourceStrings.errorMessage_EditSlideCorruption;break;case 44:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 45:a=ResourceStrings.errorMessage_ClipartCannotConnect;break;case 46:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 47:a=ResourceStrings.errorMessage_Unknown;
break;case 48:a=ResourceStrings.errorMessage_Unknown;break;case 49:a=ResourceStrings.errorMessage_Unknown;break;case 50:a=ResourceStrings.errorMessage_Unknown;break;case 51:a=ResourceStrings.errorMessage_Unknown;break;case 52:a=ResourceStrings.errorMessage_Unknown;break;case 53:a=ResourceStrings.errorMessage_Unknown;break;case 54:a=ResourceStrings.errorMessage_Unknown;break;case 55:a=ResourceStrings.errorMessage_CannotOpenODPDocumentPassword;break;case 56:a=ResourceStrings.errorMessage_LocalChangeLost;
break;case 57:a=ResourceStrings.errorMessage_NumberOfCoauthorsReachedMax;break;case 59:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 60:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 61:a=ResourceStrings.errorMessage_ImageWrongFormat;break;case 62:a=ResourceStrings.errorMessage_ImageNoAccess;break;case 63:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 64:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 65:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 66:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 67:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 68:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 69:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 70:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 71:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 72:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 73:a=ResourceStrings.errorMessage_WacConversionFailure;
break;case 74:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 75:a=ResourceStrings.errorMessage_WacConversionFailure;break;case 76:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 77:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 78:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 79:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 80:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 254:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 255:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 256:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 257:a=ResourceStrings.errorMessage_CannotOpenFileCorrupted;break;case 258:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 81:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 82:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 83:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 84:a=ResourceStrings.errorMessage_ClipartCannotDownload;
break;case 85:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 86:a=ResourceStrings.errorMessage_ClipartCannotDownload;break;case 87:a=ResourceStrings.errorMessage_InsertLocalPictureTooLarge;break;case 88:a=ResourceStrings.invalidCanary;break;case 89:a=ResourceStrings.imageUploadRequestError;break;case 90:a=ResourceStrings.invalidImageFileError;break;case 91:a=ResourceStrings.imageUploadRequestError;break;case 92:a=ResourceStrings.imageUploadRequestError;break;case 93:a=ResourceStrings.imageUploadRequestError;
break;case 94:a=ResourceStrings.imageUploadRequestError;break;case 95:a=ResourceStrings.errorMessage_Unknown;break;case 96:a=ResourceStrings.errorMessage_Unknown;break;case 97:a=ResourceStrings.errorMessage_Unknown;break;case 98:a=ResourceStrings.errorMessage_Unknown;break;case 99:a=ResourceStrings.errorMessage_Unknown;break;case 137:a=ResourceStrings.errorMessage_TryAgain;break;case 100:a=ResourceStrings.errorMessage_Unknown;break;case 101:a=ResourceStrings.errorMessage_Unknown;break;case 102:a=
ResourceStrings.errorMessage_Unknown;break;case 103:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 104:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 105:a=ResourceStrings.errorMessage_Unknown;break;case 238:a=ResourceStrings.errorMessage_Unknown;break;case 269:a=ResourceStrings.errorMessage_Unknown;break;case 262:a=ResourceStrings.errorMessage_Unknown;break;case 288:a=ResourceStrings.errorMessage_Unknown;break;case 268:a=ResourceStrings.errorMessage_Unknown;break;case 315:a=
ResourceStrings.errorMessage_Unknown;break;case 237:a=ResourceStrings.errorMessage_Unknown;break;case 228:a=ResourceStrings.errorMessage_Unknown;break;case 233:a=ResourceStrings.errorMessage_Unknown;break;case 231:a=ResourceStrings.errorMessage_Unknown;break;case 230:a=ResourceStrings.errorMessage_Unknown;break;case 426:a=ResourceStrings.errorMessage_Unknown;break;case 19:a=ResourceStrings.errorMessage_CannotSaveDocument;break;case 106:a=ResourceStrings.errorMessage_FailedToLocalSaveDocument;break;
case 107:a=ResourceStrings.errorMessage_NumberOfSessionsPerUserReachedMax;break;case 108:a=ResourceStrings.errorMessage_Unknown;break;case 109:a=ResourceStrings.errorMessage_NullPresentationId;break;case 111:a=ResourceStrings.errorMessage_CannotInsertOnlineVideo;break;case 112:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 143:a=ResourceStrings.errorMessage_InsertOnlinePictureTooLarge;break;case 113:a=ResourceStrings.errorMessage_ImageTooLarge;break;case 114:a=ResourceStrings.errorMessage_CannotPastePicture;
break;case 115:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 116:a=ResourceStrings.errorMessage_CannotPastePicture;break;case 117:a=ResourceStrings.errorMessage_CannotOpenDocumentTooLarge;break;case 118:a=ResourceStrings.errorMessage_StorageOutOfMemory;break;case 141:a=ResourceStrings.errorMessage_CannotAcquirePptEditLock;break;case 142:a=ResourceStrings.errorMessage_BlockUIUnderDeployment;break;case 135:a=ResourceStrings.errorMessage_Unknown;break;case 144:a=ResourceStrings.errorMessage_FailedToRetrieveResource;
break;case 147:a=ResourceStrings.errorMessage_CannotInsertOnlinePictureNotFound;break;case 148:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 149:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 150:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 151:a=ResourceStrings.errorMessage_CannotInsertOnlinePicture;break;case 155:a=ResourceStrings.errorMessage_Unknown;break;case 156:a=ResourceStrings.errorMessage_Unknown;break;case 159:a=ResourceStrings.errorMessage_Unknown;
break;case 154:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 157:a=ResourceStrings.errorMessage_TryAgain;break;case 158:a=ResourceStrings.errorMessage_Unknown;break;case 160:a=ResourceStrings.errorMessage_Unknown;break;case 168:a=ResourceStrings.errorMessage_Unknown;break;case 169:a=ResourceStrings.errorMessage_TryAgain;break;case 173:a=ResourceStrings.errorMessage_TryAgain;break;case 199:a=ResourceStrings.errorMessage_Unknown;break;case 200:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 201:a=ResourceStrings.errorMessage_Unknown;break;case 202:a=ResourceStrings.errorMessage_ClipServicePasteCopyFailed;break;case 203:a=ResourceStrings.errorMessage_Unknown;break;case 204:a=ResourceStrings.errorMessage_Unknown;break;case 205:a=ResourceStrings.errorMessage_Unknown;break;case 206:a=ResourceStrings.errorMessage_Unknown;break;case 209:a=ResourceStrings.errorMessage_Unexpected;break;case 210:a=ResourceStrings.errorMessage_Unknown;break;case 211:a=ResourceStrings.imageUploadRequestError;
break;case 212:a=ResourceStrings.imageUploadTimeoutError;break;case 213:a=ResourceStrings.errorMessage_TryAgain;break;case 214:a=ResourceStrings.errorMessage_LocalChangeLost;break;case 215:a=ResourceStrings.errorMessage_Unknown;break;case 363:a=ResourceStrings.errorMessage_Unknown;break;case 287:a=ResourceStrings.errorMessage_CannotOpenZeroByteDocument;break;case 321:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 222:a=ResourceStrings.errorMessage_SlideTooManyShapes;break;case 247:a=
ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 275:a=ResourceStrings.errorMessage_DownloadAppSettingsFailed;break;case 244:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 295:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 245:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 246:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 249:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 250:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 322:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 329:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 243:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 251:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 252:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 242:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 241:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;
case 293:a=ResourceStrings.errorMessage_TryAgain;break;case 294:a=ResourceStrings.errorMessage_TryAgain;break;case 379:a=ResourceStrings.errorMessage_TryAgain;break;case 296:a=ResourceStrings.errorMessage_CannotOpenDocument;break;case 297:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 298:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 332:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 354:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 355:a=
ResourceStrings.errorMessage_FailedToOpenDocument;break;case 356:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 357:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 365:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 364:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 358:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 369:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 333:a=ResourceStrings.errorMessage_ServiceUnavailable;
break;case 299:a=ResourceStrings.imageUploadTimeoutError;break;case 304:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 305:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorMessage_FailedToOpenDocument;break;case 308:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 377:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 309:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;
break;case 325:a=ResourceStrings.errorMessage_CannotAcquirePptEditSharedLock;break;case 352:a=ResourceStrings.errorMessage_Unknown;break;case 328:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 330:a=ResourceStrings.errorMessage_FailedToEnsurePopSession;break;case 331:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 334:a=ResourceStrings.errorMessage_ServiceUnavailable;break;case 373:a=ResourceStrings.errorMessage_Unknown;break;case 374:a=ResourceStrings.errorMessage_CannotOpenDocument;
break;case 384:a=ResourceStrings.errorMessage_ZeroByteFileNotFound;break;case 391:a=ResourceStrings.errorMessage_CannotOpenDocumentWrongPassword;break;case 399:a=ResourceStrings.errorMessage_Unknown;break;case 400:a=ResourceStrings.errorMessage_Unknown;break;case 401:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 402:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 403:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 404:a=ResourceStrings.errorMessage_CannotInsertStream;
break;case 405:a=ResourceStrings.errorMessage_CannotInsertStream;break;case 416:a=ResourceStrings.errorMessage_InsertLocalAudioTooLarge;break;case 418:a=ResourceStrings.errorMessage_InvalidNumberOfAudioFilesError;break;case 417:a=ResourceStrings.errorMessage_InvalidAudioFileError;break;case 422:a=ResourceStrings.errorMessage_EmptyAudioFileError;break;case 419:a=ResourceStrings.errorMessage_AudioUploadRequestError;break;case 424:a=ResourceStrings.errorMessage_AudioInvalidFileError;break;case 427:a=
ResourceStrings.errorMessage_InvalidAudioFileExtension;break;case 433:a=ResourceStrings.errorMessage_Unknown;break;case 434:a=ResourceStrings.errorMessage_Unknown;break;case 435:a=ResourceStrings.errorMessage_Unknown;break;case 440:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 441:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;break;case 442:a=ResourceStrings.errorMessage_UploadedMediaTooLarge;break;case 443:a=ResourceStrings.errorMessage_UploadedInvalidMediaFileType;
break;case 444:a=ResourceStrings.errorMessage_UploadedMediaNonStandardResponse;break;case 445:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 446:a=ResourceStrings.errorMessage_UploadedMediaInternalError;break;case 447:a=ResourceStrings.errorMessage_UploadedMediaFilesNotReceived;break;case 449:a=ResourceStrings.errorMessage_MediaUploadTimeout;break;default:a=ResourceStrings.errorMessage_Unknown}return a}d4d(a){switch(a){case 1:a=ResourceStrings.errorTitle_Unknown;break;case 14:a=
ResourceStrings.errorTitle_Unknown;break;case 2:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 3:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 4:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 41:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 33:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 34:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 35:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 36:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 5:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 6:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 7:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 8:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 306:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 9:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 10:a=ResourceStrings.errorTitle_WacStandard;break;case 12:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 15:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 16:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 17:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 18:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 20:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 21:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 22:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 23:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 58:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 24:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 25:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 26:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 27:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 28:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 29:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 30:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 31:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 37:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 32:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 11:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 13:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 38:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 39:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 40:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 42:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 43:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 44:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 45:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 46:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 47:a=ResourceStrings.errorTitle_Unknown;break;case 48:a=ResourceStrings.errorTitle_Unknown;break;case 49:a=ResourceStrings.errorTitle_Unknown;break;case 50:a=ResourceStrings.errorTitle_Unknown;break;case 51:a=ResourceStrings.errorTitle_Unknown;
break;case 52:a=ResourceStrings.errorTitle_Unknown;break;case 53:a=ResourceStrings.errorTitle_Unknown;break;case 54:a=ResourceStrings.errorTitle_Unknown;break;case 55:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 56:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 57:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 59:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 60:a=ResourceStrings.errorTitle_PasteImageFailed;break;case 61:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 62:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 63:a=ResourceStrings.errorTitle_WacStandard;break;case 64:a=ResourceStrings.errorTitle_WacStandard;break;case 65:a=ResourceStrings.errorTitle_WacStandard;break;case 66:a=ResourceStrings.errorTitle_WacStandard;break;case 67:a=ResourceStrings.errorTitle_WacStandard;break;case 68:a=ResourceStrings.errorTitle_WacStandard;break;case 69:a=ResourceStrings.errorTitle_WacStandard;break;case 70:a=ResourceStrings.errorTitle_WacStandard;
break;case 71:a=ResourceStrings.errorTitle_WacStandard;break;case 72:a=ResourceStrings.errorTitle_WacStandard;break;case 73:a=ResourceStrings.errorTitle_WacStandard;break;case 74:a=ResourceStrings.errorTitle_WacStandard;break;case 75:a=ResourceStrings.errorTitle_WacStandard;break;case 76:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 77:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 78:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 79:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 80:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 254:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 255:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 256:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 257:a=ResourceStrings.errorTitle_CannotOpenFile;break;case 258:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 81:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 82:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 83:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 84:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 85:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 86:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 87:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 88:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 89:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 90:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 91:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 92:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 93:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 94:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 95:a=ResourceStrings.errorTitle_Unknown;break;case 96:a=ResourceStrings.errorTitle_Unknown;break;case 97:a=ResourceStrings.errorTitle_Unknown;break;case 98:a=ResourceStrings.errorTitle_Unknown;break;case 99:a=ResourceStrings.errorTitle_Unknown;break;case 137:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 100:a=ResourceStrings.errorTitle_Unknown;break;case 101:a=ResourceStrings.errorTitle_Unknown;break;case 102:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 103:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 104:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 105:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 238:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 269:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 262:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 288:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 268:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 315:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 237:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 228:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 233:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 231:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 230:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 426:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 19:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 106:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 107:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 108:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 109:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 111:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 112:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 143:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 113:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 114:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 115:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 116:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 117:a=ResourceStrings.errorTitle_PowerpointStandard;
break;case 118:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 141:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 142:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 135:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 144:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 147:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 148:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 149:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 150:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 151:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 155:a=ResourceStrings.errorTitle_Unknown;break;case 156:a=ResourceStrings.errorTitle_Unknown;break;case 159:a=ResourceStrings.errorTitle_Unknown;break;case 154:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 157:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 158:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 160:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 168:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 169:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 173:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 199:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 200:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 201:a=ResourceStrings.errorTitle_Unknown;break;case 202:a=ResourceStrings.errorTitle_PasteSlideFailed;
break;case 203:a=ResourceStrings.errorTitle_Unknown;break;case 204:a=ResourceStrings.errorTitle_Unknown;break;case 205:a=ResourceStrings.errorTitle_Unknown;break;case 206:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 209:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 210:a=ResourceStrings.errorTitle_Unknown;break;case 211:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 212:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 213:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 214:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 215:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 363:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 287:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 321:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 222:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 247:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 275:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 244:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 295:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 245:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 246:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 249:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 250:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 322:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 329:a=
ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 243:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 251:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 252:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 242:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 241:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 293:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 294:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 379:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 296:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 297:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 298:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 332:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 354:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 355:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 356:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 357:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 365:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 364:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 358:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 369:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 333:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 299:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 304:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 305:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 307:a=ResourceStrings.errorMessage_Unknown;break;case 353:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 308:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 377:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 309:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 325:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 352:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 328:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 330:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 331:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 334:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 373:a=ResourceStrings.errorTitle_Unknown;break;case 374:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 384:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 391:a=ResourceStrings.errorTitle_PowerpointEditingStandard;
break;case 399:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 400:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 401:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 402:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 403:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 404:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 405:a=ResourceStrings.errorTitle_PowerpointEditingStandard;break;case 416:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 418:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 417:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 422:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 419:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 424:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 427:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 433:a=ResourceStrings.errorTitle_Unknown;break;case 434:a=ResourceStrings.errorTitle_Unknown;
break;case 435:a=ResourceStrings.errorTitle_Unknown;break;case 440:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 441:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 442:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 443:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 444:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 445:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 446:a=ResourceStrings.errorTitle_PowerpointStandard;break;case 447:a=
ResourceStrings.errorTitle_PowerpointStandard;break;case 449:a=ResourceStrings.errorTitle_PowerpointStandard;break;default:a=ResourceStrings.errorTitle_Unknown}return a}IOc(a){switch(a){case 2:a=6;break;case 3:a=6;break;case 4:a=6;break;case 41:a=6;break;case 33:a=6;break;case 34:a=6;break;case 35:a=6;break;case 36:a=6;break;case 5:a=6;break;case 6:a=6;break;case 7:a=6;break;case 8:a=116;break;case 306:a=116;break;case 9:a=6;break;case 10:a=6;break;case 15:a=6;break;case 16:a=8;break;case 17:a=6;
break;case 20:a=12;break;case 22:a=8;break;case 23:a=2;break;case 58:a=2;break;case 24:a=2;break;case 25:a=2;break;case 26:a=2;break;case 27:a=2;break;case 28:a=2;break;case 31:a=8;break;case 37:a=2;break;case 32:a=8;break;case 13:a=2;break;case 38:a=2;break;case 39:a=2;break;case 40:a=2;break;case 42:a=6;break;case 43:a=6;break;case 44:a=2;break;case 46:a=49;break;case 55:a=2;break;case 57:a=2;break;case 59:a=2;break;case 60:a=49;break;case 63:a=6;break;case 64:a=6;break;case 65:a=6;break;case 66:a=
6;break;case 67:a=6;break;case 68:a=6;break;case 69:a=6;break;case 70:a=6;break;case 71:a=6;break;case 72:a=6;break;case 73:a=6;break;case 74:a=6;break;case 75:a=6;break;case 76:a=6;break;case 77:a=6;break;case 78:a=6;break;case 79:a=6;break;case 80:a=6;break;case 254:a=6;break;case 255:a=6;break;case 256:a=116;break;case 257:a=116;break;case 258:a=6;break;case 81:a=49;break;case 82:a=49;break;case 83:a=49;break;case 84:a=49;break;case 85:a=49;break;case 86:a=49;break;case 105:a=8;break;case 238:a=
8;break;case 269:a=8;break;case 262:a=8;break;case 288:a=8;break;case 268:a=8;break;case 315:a=8;break;case 237:a=8;break;case 228:a=8;break;case 233:a=8;break;case 231:a=8;break;case 230:a=8;break;case 426:a=8;break;case 19:a=12;break;case 106:a=6;break;case 107:a=2;break;case 117:a=6;break;case 118:a=2;break;case 141:a=6;break;case 142:a=8;break;case 156:a=8;break;case 154:a=6;break;case 157:a=8;break;case 158:a=8;break;case 199:a=8;break;case 200:a=2;break;case 202:a=49;break;case 212:a=49;break;
case 287:a=4;break;case 321:a=4;break;case 222:a=5;break;case 247:a=4;break;case 275:a=8;break;case 244:a=4;break;case 295:a=4;break;case 245:a=4;break;case 246:a=4;break;case 249:a=4;break;case 250:a=4;break;case 322:a=1;break;case 243:a=4;break;case 251:a=4;break;case 252:a=4;break;case 242:a=4;break;case 241:a=8;break;case 293:a=12;break;case 294:a=12;break;case 296:a=6;break;case 333:a=12;break;case 299:a=49;break;case 304:a=6;break;case 353:a=6;break;case 308:a=12;break;case 377:a=12;break;case 309:a=
4;break;case 325:a=6;break;case 352:a=10;break;case 328:a=12;break;case 330:a=4;break;case 331:a=4;break;case 334:a=6;break;case 374:a=6;break;case 384:a=2;break;case 391:a=6;break;case 399:a=8;break;case 400:a=8;break;case 449:a=49;break;default:a=0}return a}rcj(a){switch(a){case 5:a=1;break;case 137:a=3;break;case 201:a=3;break;case 203:a=3;break;case 204:a=3;break;case 205:a=3;break;case 209:a=3;break;case 210:a=3;break;case 213:a=3;break;case 215:a=3;break;case 363:a=3;break;case 329:a=3;break;
case 379:a=3;break;case 296:a=1;break;case 297:a=3;break;case 298:a=3;break;case 332:a=3;break;case 354:a=3;break;case 355:a=3;break;case 356:a=3;break;case 357:a=3;break;case 365:a=3;break;case 364:a=3;break;case 358:a=3;break;case 369:a=3;break;case 305:a=3;break;case 307:a=3;break;case 373:a=3;break;case 391:a=1;break;case 433:a=3;break;case 434:a=3;break;case 435:a=3;break;default:a=1}return a}}Object(e.a)(ii,"DefaultErrorMapping",null,[1380]);var Rh=d(693);class Wf{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ErrorHandling"}Wb(a){this.K=
a;a.register(1379,"PowerPointWebEditor.ErrorHandling.IDeployingDialog").ma().na(()=>new Tc(a.resolve("PowerPointWebEditor.Core.IPPTAppFrame")));a.register(1380,"PowerPointWebEditor.IErrorMapping").ma().na(()=>new ii);a.register(1381,"PowerPointWebEditor.IErrorDialog").ma().na(()=>new Gm(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IErrorMapping"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("Common.IAppSettingsManager")));
const b=new Sa.a(()=>new Rh.a(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").PXb(a.resolve("Box4.IReplicationParameters")),fb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Vg));a.register(1382,"PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor").ma().na(()=>
new Xh(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("PowerPointWebEditor.IPresentationReader"),b.value,u.AFrameworkApplication.q1f,this.K.Ka("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(1383,"PowerPointWebEditor.IDocRefreshHandler").ma().na(()=>new Zl(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IRefreshDocExecutor"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IInteractiveViewManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),
a.resolve("PowerPointWebEditor.IErrorHandler"),b.value,a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),()=>u.AFrameworkApplication.Vg,a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventNotifier"),a.resolve("PowerPointWebEditor.IZoomContext")));a.register(vi,"PowerPointWebEditor.SeamlessFailoverHandler").ma().na(()=>new vi(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.IProofingManager"),a.resolve("PowerPointWebEditor.ErrorHandling.IDeployingDialog"),
a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.Vg));a.register(1384,"PowerPointWebEditor.IDelayedErrorHandler").ma().na(()=>new $b(this.K.resolve("PowerPointWebEditor.IErrorMapping"),this.K.resolve("PowerPointWebEditor.IErrorDialog"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.IDocRefreshHandler"),this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),
this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager"),this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.Ka("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")))}init(){this.K.resolve("PowerPointWebEditor.IDelayedErrorHandler");
this.K.resolve("PowerPointWebEditor.IDocRefreshHandler").ub();this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").ub()}dispose(){this.K.resolve("PowerPointWebEditor.SeamlessFailoverHandler").dispose()}static main(){m.a.instance.Bc(new Wf)}}Object(e.a)(Wf,"PPTWebEditorErrorHandlingPackage",null,[2,3]);var Yh=d(1188),Jg=d(85),sb=d(37);class Xa{constructor(){this.font=null;this.XTc=this.isValid=!1}}Object(e.a)(Xa,"EmbeddedFontClientStatus",null,[]);class hl{constructor(a,b,c,f,l,x){this.b6c=
this.gab=null;this.Ha=a;this.Sx=b;this.mPg=c.vd(7);this.uc=f;this.dBb=l;this.Sy=x;this.mPg.Yj(Object(C.a)(this,this.aeb,"onPresentationPropertyChanged"));this.Sx.FDa(()=>{this.cVe(0)})}dispose(){this.mPg.tm(Object(C.a)(this,this.aeb,"onPresentationPropertyChanged"))}get isInitialized(){return!!this.gab}get vFh(){return this.b6c}c_d(a){return this.isInitialized?this.gab.Jb(a)?this.gab.ga(a):null:null}createFontUrl(a){if(this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled)if(Aa.a.J(41521309,820,50,"CreateFontUrl"),
this.isInitialized||this.cVe(2),this.isInitialized){var b=this.Sy.HF(a);if((b=this.c_d(b))&&!b.XTc&&b.isValid){b.font.Name!==a&&Aa.a.J(41296397,820,15,"Name is not identical");a=ia.FontUtils.J0b(a);const c=this.dBb.resolve(Jg.a.cWi,hl.lWi(b.font));Ka.a.Va(a)||Ka.a.Va(c)?Aa.a.J(41296399,820,15,"FontFace name or url is invalid"):(this.Sy.kOa(a,String.format("url('{0}')",c)),b.XTc=!0)}}else Aa.a.J(41296401,820,10,"Dictionary is not initialized")}aeb(a,b){b&&b.node&&b.property&&b.property===sb.a.embeddedFonts&&
this.cVe(1)}cVe(a){if(this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled)if(Aa.a.J(41521314,820,50,"UpdateEmbeddedFontDictionary, reason: {0}",a),a=this.uc.O4i()){this.gab?Aa.a.J(41521346,820,50,"Dictionary is updated, count: {0}",a.length):(this.gab=new Lc.a,Aa.a.J(41296405,820,15,"Dictionary is initialized, count: {0}",a.length));for(const b of a){if(Ka.a.Va(b.Name)){Aa.a.J(41296407,820,15,"Name is invalid");continue}if(0!==b.Style)continue;a=hl.JIj(b);const c=this.Sy.HF(b.Name),f=this.c_d(c);f&&(f.isValid===
a||f.XTc)||this.gab.$(c,Object.assign(new Xa,{font:b,isValid:a,XTc:!1}))}this.b6c=hl.VDi(this.gab);this.Sy.swl(this.b6c);ia.FontUtils.E1h(this.b6c,Object(C.a)(this,this.createFontUrl,"createFontUrl"))}else Aa.a.J(41296403,820,10,"EmbeddedFonts is null")}static lWi(a){return JSON.stringify(a)}static JIj(a){return!Ka.a.Va(a.Name)&&4>a.Style&&!a.IsRestricted&&(0===a.LoadResult||270===a.LoadResult)}static VDi(a){const b={};for(let c of a)c.value.isValid&&(a=[],a.push(new Yh.a("",0,0,"",[0])),b[c.key]=
a);return b}}Object(e.a)(hl,"EmbeddedFontsManager",null,[1377,106]);class sl{}sl.loading="loading";sl.loaded="loaded";sl.error="error";Object(e.a)(sl,"FontFaceStatus",null,[]);class Tn{constructor(){this.n1c=this.PEg=!1;this.kle=null;this.init()}get Dzg(){return this.n1c}load(a){return new Promise((b,c)=>{this.n1c&&!Ka.a.Va(a)||c([]);let f;f=this.PEg&&-1<a.indexOf("'")?String.format('48px "{0}"',a):String.format("48px '{0}'",a);this.kle.load(f).then(l=>{for(const x of l)Ka.a.Va(x.family)||x.status===
sl.loaded||Aa.a.J(40429085,801,15,"Font load status {0}",x.status);l.length||Aa.a.J(41494563,801,15,"No font resolved");b(l)},l=>{Aa.a.J(41739607,801,10,"Rejected: {0}",l.toString());c(l)})})}init(){const a=window.document;this.kle=a&&a.fonts?a.fonts:null;this.n1c=!!this.kle;this.PEg=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("AllowSpecialCharacterFontsToRender");Aa.a.J(41494593,801,50,"FontFaceSetAPIIsSupported: {0}",this.n1c)}}Object(e.a)(Tn,"FontFaceSetObserver",null,[1375]);class fj{constructor(a){if(!a)throw Error.argumentNull("fontFaceSetObserver");
this.uab=a}l8d(a){return a?a:{}}e8d(a){return a?a:()=>{}}kGh(a,b,c,f,l,x,G){if(!a)return[];b=this.l8d(b);c=this.e8d(c);f=this.l8d(f);l=this.e8d(l);x=this.l8d(x);G=this.e8d(G);const R=[];for(const fa of a)fa in f?(l(fa),R.push(this.uab.load(String.format("{0}_MSCustomFont",fa)))):fa in b?(c(fa),R.push(this.uab.load(String.format("{0}_MSFontService",fa)))):fa in x&&(G(fa),R.push(this.uab.load(String.format("{0}_EmbeddedFont",fa))));return R}}Object(e.a)(fj,"FontsObserver",null,[1376]);class Ml{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.Fonts"}Wb(a){this.K=a;this.K.register(1375,"PowerPointWebEditor.Fonts.IFontFaceSetObserver").ma().na(()=>new Tn);this.K.register(1376,"PowerPointWebEditor.Fonts.IFontsObserver").ma().na(()=>new fj(this.K.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver")));this.K.register(1377,"PowerPointWebEditor.Fonts.IEmbeddedFontsManager").ma().na(()=>new hl(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener"),
this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PPTe.IResourceViewElementResolver"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager")))}init(){this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager")}dispose(){}static main(){m.a.instance.Bc(new Ml)}}Object(e.a)(Ml,"PPTWebEditorFontsPackage",null,[2,3]);var rj=d(419);class ep{yrh(){return!1}}Object(e.a)(ep,"DefaultParagraphViewElementSetUpdateStrategy",null,[1243]);
var tl=d(215),an=d(1044),ul=d(238);class sk extends tl.a{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){super(a,b,l);this.kvc=null;this.zPb=Hb.a.nil;this.c5e=this.Vud=!1;this.EY=this.DY=this.skb=this.rkb=-1;this.svd=this.TOb=!1;this.Yvc=this.kXc=this.SAd=this.Ntf=this.mmb=null;this.Ukd=0;this.yZe=this.c0a=this.D7e=null;a.pM.zXa(b);this.tTa=c;this.TAd=x;this.uOh=G;this.tOh=R;this.eUh=fa;this.Xc=wa;this.VOh=Wa;this.Ov=mb;this.UZa(!0);this.hMe(!0);this.yxd=new Sa.a(Object(C.a)(this,this.NHi,"determineIsShapesAndTextboxesEnabled"));
this.Ts=[];this.ILa=new Ha.a;this.g_e=new Ha.a;this.Fdb();this.Oc.Lh&&(b=this.Oc.Eaj(this.$a))&&(b.isSelected&&(this.$Q.FCb=!0),b.d8&&(this.TOb=!0),this.$Q.FCb&&(this.rkb=b.Zha,this.skb=b.$ha,this.DY=b.hS,this.EY=b.vqa));a.$o&&(a=Object(ua.a)(629,a))&&a.eJk(this.$a);this.LQb=f;this.MAd=Kb}get ruk(){return this.LQb}get Lze(){return this.TAd}get qgh(){return this.Ntf||(this.Ntf=this.uOh())}get gad(){if(!this.SAd){const a=this.tOh();a&&(this.SAd=a.UGl())}return this.SAd}get Qf(){return this.Xc}get OZ(){return this.VOh}get DBg(){return this.zPb}set DBg(a){this.zPb=
a}get yvj(){return this.ILa}get e5g(){return this.Fi?ya.a.C8f(this.Fi,!1):0}get Fi(){return this.mmb}get n8a(){return this.D7e}UZa(a){let b=!1;this.L$k(a)&&(a=this.X4a(),this.kc(a),this.kvc=null,this.zPb=Hb.a.nil,b=!0);this.Qf.ag&&this.$a.Dib?Sys.UI.DomElement.addCssClass(this.htmlElement,Tb.c3):Sys.UI.DomElement.containsCssClass(this.htmlElement,Tb.c3)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,Tb.c3),this.htmlElement.removeAttribute("title"));return b}L$k(a){let b=!!this.htmlElement;b=
b&&0<this.htmlElement.getElementsByTagName("p").length;return a||!b||!this.Fi||"p"!==Ka.a.wg(this.Fi.tagName)}X4a(){this.mmb=this.Gd.Wo(la.a.p);this.mmb.className="Paragraph";this.D7e=this.Gd.Wo(la.a.span);this.n8a.className="WACImageGroupContainer";return this.Gd.Kl?this.mmb:this.EDl()}EDl(){const a=this.Gd.Wo(la.a.div);a.className="ParaWrappingDiv";a.appendChild(this.mmb);this.No(this.mmb);return a}eU(a){super.eU(a);if(this.$a.oZ)return a=this.$a.oZ.oc(a.b1).Xqc,this.$a.oZ=null,new ul.a(a.Qla,a.minWidth,
a.Rla);let b;b=this.yZe;a.Ab(88)&&(b=ul.a.max(b,a.Mq.rJa),a.yc());return b}oy(a){if(u.AFrameworkApplication.fa.ka("TextLayoutServiceUpdateLayoutLogicEnabled")&&(this.kXc=null,this.Fi)){const b=this.Fi.getElementsByClassName("LineBox");if(b&&0<b.length){this.kXc=Array(b.length);for(let c=0;c<b.length;c++)this.kXc[c]=ya.a.fv(b[c]).length}}this.UZa(!1)&&(a.currentNode.anchor.Uj(this.Ma,8),a.parentNode.anchor.Uj(this.Ma,8),this.kvc=null);super.oy(a);this.yBi(a,this.Fi)}yBi(a,b){var c=this.$a;if(this.Oc.Lh){var f=
pa.InteractiveViewManager.instance.Nd;f&&f.Ma===this.Oc.Ma&&f.editingView.Kl&&f.editingView.Ag===this.$a&&2===f.editingView.mode?Sys.UI.DomElement.addCssClass(this.htmlElement,sk.$lg):Sys.UI.DomElement.removeCssClass(this.htmlElement,sk.$lg)}if(c.oZ)c=c.oZ.oc(a.b1).htmlElement,ya.a.kXb(c,b),b=this.Oc,b.Lh&&b.oF&128&&(this.$a.oZ=null);else{a=this.Faj();f=Uc.StyleReader.Cbg(a);Uc.StyleReader.hWc(a)&&f?(Ca.d(b,Da.a.role,Jc.a.OIf),Ca.d(b,Da.a.QIf,f)):(b.removeAttribute(Jc.a.Ye),b.removeAttribute(Jc.a.MUb));
var l="";if(H.a.instance.ga(71)||H.a.instance.ga(77))l=this.W2i(c);f=a=null;var x=yb.ParagraphReader.kgg(c,H.a.instance.ga(53),H.a.instance.ga(71),H.a.instance.ga(77),H.a.instance.ga(54));if(this.c5e||l!==this.kvc||this.zPb!==c.Eve){a="WindowText";f="transparent";this.kvc=l;this.c5e=!1;l="";let R=null;"P"!==b.tagName&&x.a8a&&(R=ia.FontUtils.Xha(x.fontName));if(x.Y2){var G=x.fontColor;G!==Hb.a.auto&&(a=Hb.a.ZH(G))}H.a.instance.ga(49)||(x.e8a&&(G=x.dR,G!==Hb.a.auto&&(f=Hb.a.ZH(G))),x.KRa&&(G=x.highlight,
G!==Hb.a.auto&&(f=Hb.a.ZH(G))));if(G=yb.ParagraphReader.language(this.$a))if(G=sa.a.oe(G))b.setAttribute("xml:lang",G.name),b.setAttribute("lang",G.name);b.style.fontWeight=x.isBold?"bold":"normal";b.style.fontStyle=x.isItalic?"italic":"normal";b.style.verticalAlign="baseline";x.isSuperscript&&(b.style.verticalAlign="super");x.sF&&(b.style.verticalAlign="sub");x.GD&&(l="underline");if(x.rF||x.TZ)l=0<l.length?l+" line-through":"line-through";b.style.textDecoration=l;b.style.fontFamily=R?R:"'Segoe UI',Tahoma,Verdana,'Sans-Serif'";
x.FRa?1===x.capitalization?b.style.fontVariant="small-caps":2===x.capitalization?b.style.textTransform="uppercase":b.style.fontVariant="normal":b.style.textTransform=""}this.zPb=c.Eve;H.a.instance.ga(49)&&(x.e8a&&(l=x.dR,l!==Hb.a.auto&&(f=Hb.a.ZH(l))),x.KRa&&(x=x.highlight,x!==Hb.a.auto&&(f=Hb.a.ZH(x))));this.$a.properties.sa(tb.a.iug,!1)?(Sys.UI.DomElement.addCssClass(b,"Conflict"),b.setAttribute(Jc.a.kqa,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(b,"Conflict"),b.removeAttribute(Jc.a.kqa),
f?(b.style.backgroundColor=f,sk.qEf(f,b)):H.a.instance.ga(49)&&(b.style.backgroundColor="transparent",Sys.UI.DomElement.removeCssClass(b,"Highlight")));c.Eve!==Hb.a.nil?(Sys.UI.DomElement.addCssClass(b,"NoteTagHighlight"),f&&(b.style.borderColor=f,sk.qEf(f,b))):(Sys.UI.DomElement.removeCssClass(b,"NoteTagHighlight"),Sys.UI.DomElement.removeCssClass(b,"Highlight"));a&&(b.style.color=a);c=ae.OutlineElementReader.jm(Xb.OutlineElementNavigator.EA(this.$a));this.Oc.Kl&&(c?Sys.UI.DomElement.addCssClass(b,
"Rtl"):Sys.UI.DomElement.removeCssClass(b,"Rtl"));switch(yb.ParagraphReader.fN(this.$a)){case 1:b.style.textAlign="left";b.style.jib="";break;case 2:b.style.textAlign="center";b.style.jib="";break;case 3:b.style.textAlign="right";b.style.jib="";break;case 6:b.style.textAlign="justify";b.style.jib="auto";break;case 7:b.style.textAlign="justify";b.style.jib="distribute";break;case 9:case 11:case 10:b.style.textAlign="justify";b.style.jib="kashida";break;case 13:b.style.textAlign="justify";b.style.jib=
"inter-cluster";break;default:b.style.textAlign="",b.style.jib=""}4===Cb.App.mode&&H.a.instance.ga(86)&&r.a.Aj&&"right"===b.style.textAlign.toLowerCase()&&(a=b.style.paddingRight.toLowerCase(),""===a||"0px"===a)&&(b.style.paddingRight="1px");H.a.instance.ga(54)&&(Ca.d(b,Da.a.ox,this.$a.sa(Mb.a.Vn,0)),Ca.d(b,Da.a.luk,this.$a.id.toString()));this.Lze.Inh(this.$a,b,c,this.Ma)}}Faj(){var a=H.a.instance.ga(71)?(a=Uc.StyleReader.BD(this.$a))?Uc.StyleReader.UP(a):H.a.instance.ga(61)?Uc.StyleReader.DKa:Uc.StyleReader.Cna:
Uc.StyleReader.Cna;return a}W2i(a){let b="";var c=Uc.StyleReader.BD(a);c&&(b+=c.id);Uc.StyleReader.dr&&({tableStyle:a,I4a:c}=Uc.StyleReader.dr.A7a(a),a&&(b+=a.id),c&&(b+=c.id));return b}Q$(){this.$a.Aca(this.Ma,16,!0)}Fdb(){this.yxd.value&&this.$a.o8a.Fdb()}HJ(a){if(!this.bgl()){this.Fdb();var b=this.$a;this.sPf();ya.a.ku(this.Fi);ya.a.ku(this.n8a);var c=this.Fi;c.style.minHeight="";this.Ts=[];this.Ukd=0;var f=new Ha.a,l=0;a&&(l=this.qci(a,b,f,c,l));if(!this.agl()){a=!1;var x=this.htmlElement.parentNode,
G=this.htmlElement.nextSibling;x&&(this.mjc(x,this.htmlElement),a=!0);this.gad&&this.gad.oGl();var R=l;l=this.ruk.ITk(b,this.Gd,c,this.yvj,f,Object(C.a)(this,this.$0g,"onOverHyperlink"),Object(C.a)(this,this.W0g,"onOutHyperlink"),Object(C.a)(this,this.hM,"takeOwnershipOfSubtree"),Object(C.a)(this,this.No,"takeOwnership"),X.a.uJc,this.DBg,l,this.rkb,this.skb,this.TOb,sk.iWc,!!this.$Q&&this.$Q.FCb,this.Vud,Cb.App.kR.fNe,ae.OutlineElementReader.jm(Xb.OutlineElementNavigator.EA(this.$a)));if(!u.AFrameworkApplication.fa.ka("TextLayoutServiceDataDeletionFixEnabled")||
this.Ov.VOf(b,f))this.Ov.Zzh(c,this.Gd,l.kCf,b,R,f,qd.a.instance.Oa?qd.a.instance.Oa.kb:null,this.kXc)||this.Gd.$o||this.Ov.IEh(b);this.Ts=f.toArray();this.Yvc=l.IVg;this.g_e=l.fPf;this.Vud=l.Plg;this.gad&&this.gad.jGl(this.e5g);this.qgh&&this.qgh.mGl(c);this.sDh();this.svd=!0;a&&x.insertBefore(this.htmlElement,G);!this.Oc.Kl&&x&&"li"===Ka.a.wg(x.tagName)&&this.wci(b,x);this.Oc.Kl||this.Ov.NRf(c)}}}wci(a,b){if(Ib.ListReader.bma){if(b=this.YNc(a)){const c=b.oc(this.Oc.Ma);if(c){const f=ya.a.$ba(this.htmlElement,
"Paragraph");this.Ztk(a)?(a=(a=this.taj(f))?a.nextSibling:null)?f.insertBefore(c.htmlElement,a):f.appendChild(c.htmlElement):ya.a.rHd(f,c.htmlElement);b.anchor.Uj(this.Ma,64)}}}else this.tTa.KTf(b,a,this.Ma)}taj(a){for(let b=0;b<a.children.length;b++){const c=a.children[b];if(Sys.UI.DomElement.containsCssClass(c,"PageBreakBlob"))return c}return null}Ztk(a){if(!a)return!1;a=a.Ra;if(!a)return!1;a=a.first;return a?(a=a.blob)?8===a.Lq:!1:!1}YNc(a){const b=new nb.GraphIterator;b.set(a);return b.af()?(Xb.OutlineElementNavigator.Ke(b),
this.Qf.ag&&!b.pI(4)?b.Ab(31):b.Ab(4)):null}qci(a,b,c,f,l){a=eh.a.mb(a.b1,a.currentNode);if(!a.Ji())return l;let x=0,G=!1,R=0,fa=0,wa=0,Wa=!1;const mb=yb.ParagraphReader.mW(b),Kb=this.yxd.value;do{const nc=a.Mq.htmlElement;Sys.UI.DomElement.containsCssClass(nc,X.a.yV)?(Kb&&b.o8a.NGl?(Wa||(Ib.ListReader.Ww&&mb||b.o8a.FGl(this.n8a),f.appendChild(this.n8a)),this.n8a.appendChild(nc)):f.appendChild(nc),K.a.Cv(nc,X.a.xEa,l++),c.add(nc),this.Oc.Lh&&({ifk:R,Kdk:fa,Jdk:wa}=sk.x5k(b,nc,Kb,a,Wa,R,fa,wa)),G=
Wa=!0):f.appendChild(nc)}while(a.fDa());Kb?this.Oc.Kl?this.Qwl():(this.vDh(wa+6,fa+6),x=fa+6):x=fa-R+6;G&&!Cb.App.instance.Owj&&this.Oc.Lh&&f.clientHeight<x&&(f.style.minHeight=x+"px");return l}vDh(a=0,b=0){this.yxd.value&&this.$a.o8a.EGl(this.n8a,a,b)}Pnd(){const a=new eh.a(this.Ma);a.set(this.$a);a.af();Xb.OutlineElementNavigator.Ke(a);Ib.ListReader.Ww&&(this.Lze.Inh(this.$a,this.Fi,ae.OutlineElementReader.jm(a.currentNode),this.Ma),this.tTa.mxl(a))}sDh(){this.OZ.Vec(this.$a,this.Fi)}NHi(){const a=
fb.a.instance.qb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(130)}get isSelected(){return super.isSelected}set isSelected(a){super.isSelected=a;a||(this.EY=this.DY=this.skb=this.rkb=-1)}get Zha(){return this.Oc.Kl?this.$a.oc(this.Oc.Ef.Ma).Zha:this.rkb}set Zha(a){this.rkb!==a&&(this.rkb=a,this.rna(16),this.$a.anchor.Uj(this.Oc.Ma,16))}get $ha(){return this.Oc.Kl?this.$a.oc(this.Oc.Ef.Ma).$ha:this.skb}set $ha(a){this.skb!==a&&(this.skb=a,this.rna(48),this.$a.anchor.Uj(this.Oc.Ma,48))}get hS(){return this.Oc.Kl?
this.$a.oc(this.Oc.Ef.Ma).hS:this.DY}set hS(a){this.DY!==a&&(this.DY=a,this.rna(16),this.$a.anchor.Uj(this.Oc.Ma,16))}get vqa(){return this.Oc.Kl?this.$a.oc(this.Oc.Ef.Ma).vqa:this.EY}set vqa(a){this.EY!==a&&(this.EY=a,this.rna(48),this.$a.anchor.Uj(this.Oc.Ma,48))}get d8(){return this.Oc.Kl?this.$a.oc(this.Oc.Ef.Ma).d8:this.TOb}set d8(a){this.TOb!==a&&(this.TOb=a,this.rna(16),this.$a.anchor.Uj(this.Oc.Ma,16))}get h2f(){return this.Ts[this.Ts.length-1]}dispose(){this.EPk();super.dispose();this.sPf();
for(let a of this.g_e)a.IZf(this.Gd)}EPk(){if(this.c0a&&this.htmlElement)for(let a of this.c0a)a.DPk(this.htmlElement)}ema(){super.ema();this.Vud&&this.Oc.notify(2)}Lnd(a){const b=u.AFrameworkApplication.fa.ka("Box4DoNotRenderPresenceOutOfView"),c=this.Oc.oze.S1d(this.$a);this.MAd.egh(c,this.c0a,this,this.htmlElement,b,this.lbl());this.c0a=c;this.svd||this.sDh();this.svd=!1;super.Lnd(a)}rna(a){this.eUh.yrh(this.$a)||super.rna(a)}bgl(){if(this.Awg()){const a=this.Oc;if(1!==a.editingView.Zqb)return a.jSd=
!0}return!1}agl(){return this.Oc.Kl&&cb.SelectionEditor.Isa(qd.a.instance.Oa.kb)?!0:!1}Qwl(){var a=this.$a.oc(this.Oc.Ef.Ma);a&&(a=Sys.UI.DomElement.getBounds(a.n8a),this.vDh(a.width,a.height))}lbl(){return!this.Awg()&&!this.Oc.Kl}Awg(){if(pa.InteractiveViewManager.instance.Nd!==this.Oc)return!1;const a=this.Oc.editingView;return a.Ag===this.$a&&2===a.mode}GMj(){const a=this.getBounds(),b=ib.a.ei(this.Oc.container);return a.y+a.height>=b.y&&a.y<=b.y+b.height}eue(a){a.qhh(this);0<this.Ukd&&a.lVk(this)}get kWa(){return this.Fi}LDh(a){this.yZe=
new ul.a(0,a,0)}getBounds(){const a=O.a.kpb(this.htmlElement.querySelector("p.Paragraph")||this.htmlElement,this.Oc.Lh?this.$a.id.toString():"");this.Lze.Y8h(this.$a,a,ae.OutlineElementReader.jm(Xb.OutlineElementNavigator.EA(this.$a)),this.Oc.Ma);return a}$0g(a){tl.a.o8k(a.Ac,a.TC);if(Cb.App.KVb){const b=a.Ac,c=b.querySelector(".NormalTextRun")||b;H.a.instance.ga(8)||a.rZ?c.style.cursor="pointer":c.style.cursor="text";Sys.UI.DomElement.addCssClass(b,sk.Due);an.a.instance().d6h(Object(C.a)(this,this.cxe,
"onCtrlKeyDown"));an.a.instance().e6h(Object(C.a)(this,this.exe,"onCtrlKeyUp"))}return!0}W0g(a){Sys.UI.DomElement.removeCssClass(a.Ac,sk.Due);an.a.instance().gfh(Object(C.a)(this,this.cxe,"onCtrlKeyDown"));an.a.instance().hfh(Object(C.a)(this,this.exe,"onCtrlKeyUp"));return!0}sPf(){for(let a=0;a<this.ILa.count;a++)Cb.App.Hb.jR.xb(ma.a.Sla,this.ILa.ga(a),Object(C.a)(this,this.$0g,"onOverHyperlink")),Cb.App.Hb.jR.xb(ma.a.Tla,this.ILa.ga(a),Object(C.a)(this,this.W0g,"onOutHyperlink")),an.a.instance().gfh(Object(C.a)(this,
this.cxe,"onCtrlKeyDown")),an.a.instance().hfh(Object(C.a)(this,this.exe,"onCtrlKeyUp"));this.ILa.clear();if(this.Yvc){for(let a of this.Yvc)Cb.App.Hb.jR.xb(a.eventName,a.Ac,a.handler);this.Yvc=null}}cxe(){this.Ywa("pointer")}exe(){this.Ywa("text")}Ywa(a){for(let b=0;b<this.ILa.count;b++)if(Sys.UI.DomElement.containsCssClass(this.ILa.ga(b),sk.Due)){const c=this.ILa.ga(b).querySelector(".NormalTextRun");if(c){c.style.cursor=a;break}}}static get iWc(){return!!qd.a.instance.Oa&&!!qd.a.instance.Oa.kb&&
qd.a.instance.Oa.kb.iWc}static qEf(a,b){"transparent"!==a?Sys.UI.DomElement.addCssClass(b,"Highlight"):Sys.UI.DomElement.removeCssClass(b,"Highlight")}static x5k(a,b,c,f,l,x,G,R){b=Sys.UI.DomElement.getBounds(b);c&&(a=a.o8a.tFl(f.currentNode),b.x=a.x,b.y=a.y,b.height&&b.width||(b.height=a.height,b.width=a.width));a=b.y+b.height;if(!l||b.y<x)x=b.y;if(!l||a>G)G=a;b=b.x+b.width;if(!l||b>R)R=b;return{ifk:x,Kdk:G,Jdk:R}}}sk.$lg="HiddenParagraph";sk.Due="MouseIsOn";Object(e.a)(sk,"ParagraphViewElement",
tl.a,[419,1289,418,345,106]);class wm extends tl.a{constructor(a,b,c,f,l,x){super(a,b);this.Sg=this.Xc=this.Baa=this.TAd=null;Ib.ListReader.bma?(this.jZf(),this.hMe(!0),this.Baa=c,this.TAd=l,this.Xc=x,this.Sg=f,this.UZa(!0)):(this.hMe(!1),a=this.Gd.Wo(la.a.span),a.className="ListGhost",this.kc(a))}UZa(a){if(Ib.ListReader.bma){var b=this.Wdg(this.$a);a&&(a=this.kRd(),this.kc(a),(b=Object(ua.a)(sk,b.oc(this.Oc.Ma)))&&b.htmlElement&&(b=b.Fi))&&((a=ya.a.x0b(b,wm.a$a))?b.replaceChild(this.htmlElement,
a):ya.a.rHd(b,this.htmlElement))}}get hee(){return ya.a.x0b(this.htmlElement,wm.c7b)}oy(){this.UZa(!1);if(!this.Oc.Kl&&Ib.ListReader.bma)if(this.Xc.ag)this.k5k(this.htmlElement,this.hee,this.$a);else{const a=this.Baa.yxb(this.$a);this.hee.innerText=a}}HJ(a){this.Oc.Kl||Ib.ListReader.bma&&a.currentNode.anchor.Uj(this.Ma,64)}eue(a){Ib.ListReader.bma&&a.qhh(this)}get kWa(){return this.htmlElement}LDh(){}Pnd(){this.l5k()}Fcg(){return-1}k5k(a,b,c){var f=this.Sg.f1d(c);if(f)if(12!==f.type)Ea.a.instance.shipAssertTag(34930713,
8,!1,"the node associated with the list is type [{0}]",f.type);else{var l=f.Ra,x=l?l.last.uo:null;l=l?l.last.lp:null;var G=f.Dib,R=f.REb,fa=f.E7();f=!!G&&R.hag(fa).Sa(Mb.a.listID);G=null;f&&(G=R.Sa(Mb.a.listID)&&fa.Sa(Mb.a.listID)?3:R.Sa(Mb.a.listID)?2:1);R=this.Baa.yxb(c);c=this.Baa.yxb(c);x=!!x||f&&(1===G||3===G);l=!!l||f&&(2===G||3===G);G=!x&&!l&&""!==R&&R!==c;for(fa=!x&&!l&&!G;b.hasChildNodes();)b.removeChild(b.firstChild);b.innerText="";b.style.color="";b.title="";Sys.UI.DomElement.removeCssClass(b,
Tb.fee);Sys.UI.DomElement.removeCssClass(a,Tb.c3);if(fa)b.innerText=c;else{if(l||G)fa=Fb.a.createElement(b.ownerDocument,la.a.span),Sys.UI.DomElement.addCssClass(fa,Tb.Wxh),fa.innerText=R,b.appendChild(fa);if(x||G)R=Fb.a.createElement(b.ownerDocument,la.a.span),Sys.UI.DomElement.addCssClass(R,Tb.Yxh),R.innerText=c,b.appendChild(R);x||l?b.style.color="#000":Sys.UI.DomElement.addCssClass(b,Tb.fee);f&&Sys.UI.DomElement.addCssClass(a,Tb.c3)}}else Ea.a.instance.shipAssertTag(34930712,8,!1,"No paragraph is found with a list node")}Wdg(a){if(!a)return null;
const b=new nb.GraphIterator;b.set(a);b.af();return Xb.OutlineElementNavigator.Ke(b)?b.Ab(2):null}kRd(){const a=this.Gd.Wo(la.a.span);Sys.UI.DomElement.addCssClass(a,wm.a$a);this.MGc(a);return a}MGc(a){const b=Fb.a.createElement(a.ownerDocument,la.a.span);Sys.UI.DomElement.addCssClass(b,wm.c7b);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}l5k(){if(!this.Oc.Kl){var a=this.Wdg(this.$a),b=a.oc(this.Oc.Ma).htmlElement.parentNode;!this.Oc.Kl&&b&&"li"===Ka.a.wg(b.tagName)&&
this.Baa.JDh(b,a,this.Ma,this.hee,!1)}}}wm.a$a="ListMarkerWrappingSpan";wm.c7b="ListMarker";Object(e.a)(wm,"NumberListViewElement",tl.a,[1289,418,345,106]);var yo=d(380),Nf=d(1063);class sh{constructor(a,b){this.offsetWidth=a;this.offsetHeight=b}}Object(e.a)(sh,"ListMarkerOffset",null,[]);class ho{constructor(){this.K6j="ListMarkerMeasuringPad";this.bac=new ef.a}I8i(a){let b=a.innerHTML;if(!b.length)return new sh(0,0);var c=null;window.getComputedStyle&&(c=window.getComputedStyle(a,null))&&(b+=["",
c.fontFamily,c.fontSize,c.fontStyle,c.fontWeight,c.fontVariant,c.textDecoration].join("_"));this.bac.Jb(b)||(a=a.cloneNode(!0),c&&(a.style.fontFamily=c.fontFamily,a.style.fontSize=c.fontSize,a.style.fontStyle=c.fontStyle,a.style.fontWeight=c.fontWeight,a.style.fontVariant=c.fontVariant,a.style.textDecoration=c.textDecoration),Nf.a.aVb(),Nf.a.v7a(this.K6j).appendChild(a),{width:c,height:a}=ib.a.jNc(a),this.bac.$(b,new sh(c,a)),Nf.a.IZb());return this.bac.ga(b)}}Object(e.a)(ho,"ListMarkerOffsetCache",
null,[1209]);var Re=d(1174),Ve=d(1191),Kg=d(79),wf=d(253),Ae=d(191),lf=d(484);class wi{constructor(a,b){this.Xc=this.PY=this.ZJ=null;this.Sg=a;this.gG=b;this.bG=Ib.ListReader.Ww;this.Vw=r.a.Vw||r.a.io}get Tf(){return this.Sg}get PL(){return this.gG}get eL(){return this.ZJ||(this.ZJ=fb.a.instance.qb("Box4.List.ListSettings"))}get Eia(){return this.PY||(this.PY=fb.a.instance.Ka("Common.IZoomManager"))}set Eia(a){this.PY=a}get Qf(){return this.Xc||(this.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get enabled(){return this.bG}yxb(a){const b=
this.Tf.k7a(a);return b&&b.propertySet.sa(tb.a.Ni,null)?1===b.listType?this.xLf(b):0===b.listType?this.SXg(b,a):"":""}lxl(a,b){if(this.enabled&&b&&(this.Tf.Ica(b)||this.Qf.ag&&63===b.type)&&this.fwb(a)){a.style.display="block";var c=this.Atb(a);this.Ghd(a,b);c&&(a=this.yxb(b),c.innerText=a)}}KTf(a,b,c){if(this.enabled&&this.fwb(a)){var f=this.Atb(a);f&&this.JDh(a,b,c,f)}}JDh(a,b,c,f,l=!1){var x=nb.GraphIterator.mb(b);x.af();Xb.OutlineElementNavigator.Ke(x);if(Ib.ListReader.kk(x)||this.Qf.ag&&Ib.ListReader.Y5b(x)){const R=
x.currentNode;var G=ae.OutlineElementReader.jm(R);this.Qf.ag?this.Tf.bWg(x):this.Tf.Ula(x);x=x.currentNode;if(!Ib.ListReader.bma){const fa=this.yxb(x);f.innerText=fa}f.setAttribute(Jc.a.pK,Jc.a.KB);12!==b.type?lf.a.uUc(b)&&(a=f.parentNode,f.style.height="auto",b=c=0,{width:c,height:b}=this.ltb(f),f.style.height="",c=-1*(Math.ceil(c)+13),f.style.marginLeft=G?"13px":c+"px",f.style.marginRight=G?c+"px":"13px",ya.a.R3k(f,G?"right":"left"),G=0,{height:G}=this.ltb(a.parentNode),f.style.marginTop=Math.max((G-
b)/2,0)+"px"):(this.L7k(a,f,b,R,x,c),this.mVe(b,f,c,x,G,l))}}mxl(a){this.enabled&&a&&a.Mq&&ae.OutlineElementReader.jm(a.currentNode)}lVe(a,b,c,f,l=-1){this.enabled&&(yb.ParagraphReader.mW(a)||this.Qf.ag&&yb.ParagraphReader.dJj(a))&&this.HDh(a,b,c,l,null)}jxl(a,b,c){if(this.enabled&&this.fwb(a)){var f=ya.a.P9f(a,wi.PLi);if(f&&(f=ya.a.P9f(f,wi.OLi))&&(f=ya.a.A7(f,wi.xea))&&f.style&&(r.a.eg||(f.style.marginTop="0px"),(a=ya.a.A7(a,wi.puk))&&(a=ya.a.A7(a,wi.xea))&&f.className.startsWith(wi.xea))){if(this.Qf.ag){var l=
ya.a.Xsb(a,wi.UJa);var x=ya.a.Xsb(f,wi.UJa)}else l=this.WXd(a,wi.UJa),x=ya.a.A7(f,wi.UJa);l&&x&&(f.style.marginLeft!==a.style.marginLeft&&(f.style.marginLeft=""===a.style.marginLeft?"0px":a.style.marginLeft),f.style.marginRight!==a.style.marginRight&&(f.style.marginRight=""===a.style.marginRight?"0px":a.style.marginRight),{f6f:b,U5f:c}=this.FDh(a,f,l,x,b,c),this.o9h(b,c,f))}}}WXd(a,b){return ya.a.A7(a,b)}FDh(a,b,c,f,l,x){var G;""!==a.style.textIndent&&(x&&this.Tf.b$a||""===b.style.textIndent)&&(x=
a.style.textIndent,this.Tf.b$a&&(G=this.XNc(a))&&(x=this.Wji(G,x)),b.style.textIndent=x);x=this.itb(c);G=this.itb(f);Math.floor(G.x)!==Math.floor(x.x)?(a=this.hki(l,x,G),a=isNaN(a)?0:a,""!==b.style.textIndent&&(l=b.style.textIndent,x=l.lastIndexOf("px"),0<x&&(l=l.substring(0,x),a+=parseInt(l))),b.style.textIndent=a+"px",x=this.itb(c),G=this.itb(f)):""===b.style.textIndent&&(b.style.textIndent=a.style.textIndent);return{f6f:x,U5f:G}}hki(a,b,c){let f=0;10>Math.abs(c.x-b.x)?this.eL.OKj||(f=this.Xdg(a,
b,c)):f=this.Xdg(a,b,c);return f}Xdg(a,b,c){return a?c.x-b.x:b.x-c.x}Wji(a,b){let c=b,f;({width:f}=this.ltb(a));if(f){var l=a.style.marginLeft,x=a.style.marginRight;const G=l.lastIndexOf("px"),R=x.lastIndexOf("px");a=c.lastIndexOf("px");0<a&&0<G&&0<R&&(l=this.Pze(l,G),x=this.Pze(x,R),(b=this.Pze(b,a))||l||x)&&(c=b+f+l+x+"px")}return c}Pze(a,b){a=a.substring(0,b);a=parseFloat(a);return a=isNaN(a)?0:a}o9h(a,b,c){if(r.a.eg){if(.1<Math.abs(a.y-b.y)){let f=parseFloat(c.style.marginTop);f=isNaN(f)?0:f;
c.style.marginTop=a.y-b.y+f+"px"}}else c.style.marginTop=a.y-b.y+"px"}Fcg(a,b=!1){return(a=this.Atb(a))?({width:a}=this.ltb(a),b?a+0:a):0}Atb(a){return this.enabled&&this.fwb(a)?(a=lf.a.R8i(a))?this.Dcg(a):null:null}Ghd(a,b,c=!1){if(this.enabled&&this.fwb(a)){if(this.Qf.ag){var f="1";var l=this.Tf.b1d(b)}else f=this.H8i(b),l=this.Tf.k7a(b);b=this.X0b(b,l);c?(Ca.d(a,Da.a.iFi,b),Ca.d(a,Da.a.role,Jc.a.UNa),Ca.d(a,Da.a.hFi,f)):(Ca.d(a,Da.a.Vbi,b),Ca.d(a,Da.a.role,Jc.a.UNa),Ca.d(a,Da.a.QIf,f))}}Dcg(a){if(!this.enabled||
!a)return null;let b=null;(a=this.XNc(a))&&(b=ya.a.A7(a,wi.c7b)||this.MGc(a));return b}fwb(a){return!!a&&"li"===Ka.a.wg(a.tagName)}HDh(){}Y$f(){return 720}ltb(a){let b,c;({width:b,height:c}=ib.a.jNc(a));this.Eia&&this.Eia.instance&&this.Eia.instance.rwg(a)&&(b/=this.Eia.instance.s2,c/=this.Eia.instance.s2);return{width:b,height:c}}itb(a){const b=ib.a.jNc(a).returnValue;this.Eia&&this.Eia.instance&&this.Eia.instance.rwg(a)&&(b.x/=this.Eia.instance.s2,b.y/=this.Eia.instance.s2);return b}Oia(a,b){switch(a.Oia()){case 0:return b+
"";case 4:return Ka.a.cTf(b-1,!0);case 2:return Ka.a.eTf(b,!0);case 3:return Ka.a.cTf(b-1,!1);case 1:return Ka.a.eTf(b,!1);case 22:return 10>b?"0"+b:b+"";default:return b+""}}xLf(a){if(1!==a.listType)return"";a=this.T$i(a.listType,a.listStyle);return wf.a.SKf(a[0])}SXg(a,b){b=this.X0b(b,a);return this.Oia(a,b)+"."}T$i(a,b){return Ae.a.AP(a,b).propertySet.sa(tb.a.Ni,null)}X0b(a,b){const c=b.pia;return c!==wf.a.yw?c:this.nki(a,b)}nki(a,b){if(b.wW!==wf.a.yw)return b.wW;if(b.iA!==wf.a.yw)return b.iA;
let c=1;const f=new nb.GraphIterator;f.set(a);f.af();for(Xb.OutlineElementNavigator.Ke(f);f.gDa();)if(Ib.ListReader.kk(f)){const l=this.Tf.Pw(f);if(l&&b&&l.listType===b.listType&&l.listStyle===b.listStyle){if(l.wW!==wf.a.yw)return c+l.wW;if(l.iA!==wf.a.yw)return c+l.iA;if(a.Sa(Mb.a.listID)&&f.currentNode.Sa(Mb.a.listID)&&f.currentNode.getValue(Mb.a.listID)!==a.getValue(Mb.a.listID))break;c++}}return c}Lyl(a,b){Cb.App.$9a&&(a.Sa(tb.a.fontColor)&&(b.fontColor=a.getValue(tb.a.fontColor)),a.Sa(tb.a.fontSize)&&
(b.fontSize=a.getValue(tb.a.fontSize)),a.Sa(tb.a.font)&&(b.fontName=a.getValue(tb.a.font)),a.Sa(tb.a.bold)&&(b.isBold=a.getValue(tb.a.bold)),a.Sa(tb.a.italic)&&(b.isItalic=a.getValue(tb.a.italic)),a.Sa(tb.a.superscript)&&(b.isSuperscript=a.getValue(tb.a.superscript)),a.Sa(tb.a.subscript)&&(b.sF=a.getValue(tb.a.subscript)),a.Sa(tb.a.strikethrough)&&(b.rF=a.getValue(tb.a.strikethrough)),a.Sa(Kg.a.Js)&&(b.TZ=a.getValue(Kg.a.Js)))}W1d(a,b){a=yb.ParagraphReader.kgg(a,H.a.instance.ga(53),H.a.instance.ga(71),
H.a.instance.ga(77),H.a.instance.ga(54));this.Lyl(b,a);return a}Q$f(){return null}IDh(a,b,c,f){const l=c.parentNode;let x=f.sa(tb.a.fontSize,ad.Font.$H);if(a.sF||a.isSuperscript)Ca.d(c,Da.a.GWf,(x/2).toString()),x=Math.floor(x*Xc.gWi),l&&(l.style.fontSize=x/2+"pt"),c.style.fontSize=x/2+"pt";else if(Ib.ListReader.bma){if(c.style.fontSize=x/2+"pt",!f.Sa(tb.a.fontSize)&&(a=ya.a.Xsb(b,"EOP")))c.style.fontSize=a.style.fontSize}else c.style.fontSize=b.style.fontSize}L7k(a,b,c,f,l,x){b&&this.fwb(a)&&(b.style.verticalAlign=
a.style.verticalAlign,f&&l&&Cb.App.$9a&&(x=f.sg(x)))&&(f=this.W1d(c,l,H.a.instance.ga(53),H.a.instance.ga(71),H.a.instance.ga(77),H.a.instance.ga(54)),f=this.Q$f(x.Gd,c)||f,this.O0b(a,b,l),!this.Qf.ag||""===b.style.color&&!Sys.UI.DomElement.containsCssClass(b,Tb.fee)?(c="",f.Y2&&(x=f.fontColor,x!==Hb.a.auto&&(c=Hb.a.ZH(x))),b.style.color=c,c=this.Tf.k7a(l)):c=this.Tf.b1d(l),b.style.fontWeight=f.isBold&&1!==c.listType?"bold":"normal",b.style.fontStyle=f.isItalic&&1!==c.listType?"italic":"normal",f.isSuperscript?
b.style.verticalAlign="super":f.sF&&(b.style.verticalAlign="sub"),this.IDh(f,a,b,l),f.rF||f.TZ)&&(b.style.textDecoration=0<b.style.textDecoration.length?b.style.textDecoration+" line-through":"line-through")}O0b(a,b){b.style.fontFamily=a.style.fontFamily}XNc(a){return a?ya.a.x0b(a,Cf.a.a$a)||this.kRd(a):null}MGc(a){const b=Fb.a.createElement(a.ownerDocument,la.a.span);Sys.UI.DomElement.addCssClass(b,wi.c7b);b.style.textIndent="0px";b.style.textAlign="left";a.appendChild(b);return b}kRd(a){if(!a)return null;
const b=Fb.a.createElement(a.ownerDocument,la.a.span);Sys.UI.DomElement.addCssClass(b,Cf.a.a$a);ya.a.rHd(a,b);this.MGc(b);return b}mVe(a,b,c){this.lVe(a,b.parentNode.parentNode,this.PL.otb(a).ZKb,this.PL.a7a(a).ZKb,c)}}wi.xea="Paragraph";wi.puk="ParaWrappingDiv";wi.OLi="_EditingElement";wi.PLi="_EditingElement_WrappingDiv";wi.UJa="TextRun";wi.c7b="ListMarker";Object(e.a)(wi,"AListMarkerUtility",null,[1210]);var Se=d(64),zo=d(792);class yj{}yj.pMd=8226;yj.vLf="Arial";yj.wSd=65532;yj.qHa=65533;Object(e.a)(yj,
"PptListConstants",null,[]);var sf=d(58),og=d(226);class Ao extends wi{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc){super(a,b);this.Y_j=[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061];this.Bfe=c;this.bac=f;this.Ea=l;this.Nl=x;this.Z$j=G;this.Nb=R;this.wC=fa;this.Hh=wa;this.VN=Wa;this.ZG=mb;this.pC=Kb;this.uEg=nc;this.C$b=oc;this.Vz=Hc;this.kua=Ic;this.B$b=Kc}H8i(a){const b=new nb.GraphIterator;b.set(a);b.af();Xb.OutlineElementNavigator.Ke(b);return b.currentNode.sa(Mb.a.listLevel,
0)+1+""}HDh(a,b,c,f,l=null){const x=this.Bfe.Kp(ba.a.kxl);l=new eh.a(f);l.set(a);l.af();Xb.OutlineElementNavigator.Ke(l);if(Ib.ListReader.kk(l)){if(!b){this.Bfe.Tb(Nd.a.vh,{["Reason"]:"ParagraphElementNull"});x.end();return}f=this.Dcg(b);if(!f){this.Bfe.Tb(Nd.a.vh,{["Reason"]:"ListMarkerNotFound"});x.end();return}let G=this.ltb(f).width;const R=l.Mq.Gd.Fd;a=R.EJ(this.PL.I7(a).oM,0);c=R.EJ(Re.a.Cea(c,0),0);this.Vz&&Object(Ma.a)(294,this.pC.Nd)&&(c=0);l=ae.OutlineElementReader.jm(l.currentNode);this.h5k(b,
f,a,c,G,l)}x.end()}ltb(a){a=this.bac.I8i(a);return{width:a.offsetWidth,height:a.offsetHeight}}XNc(a){let b=a;this.C$b&&a&&0<=a.className.indexOf(hc.a.xea)&&(a=ya.a.$ba(a,hc.a.s8))&&(b=a);return super.XNc(b)}WXd(a,b){return this.C$b?ya.a.A7(a,hc.a.s8)?ya.a.Xsb(a,b):ya.a.A7(a,b):super.WXd(a,b)}FDh(a,b,c,f){b.style.textIndent=a.style.textIndent;a=this.itb(c);f=this.itb(f);return{f6f:a,U5f:f}}Oia(a,b){switch(a.Oia()){case 18:return 21>b?Ka.a.fromCharCode(b-1+9312):b.toString();case 19:return this.LYi(b)}return super.Oia(a,
b)}xLf(a){let b="";if(1===a.listType){const c=a.propertySet.sa(tb.a.Ni,null);c&&c.length&&c[0]&&(b=Ka.a.Sv(c[0],4))}b=this.F9h(b?b:"2022",a);if(re.a("FixEvalSecurityBugForListMarkerUtility")&&String.fromCodePoint)return String.fromCodePoint(String.format("0x{0}",b));Aa.a.J(512496919,809,15,"Use of Eval in ListMarkerUtility");return Object(Ve.a)(String.format("'\\u{0}'",b))}SXg(a,b){b=this.X0b(b,a);return this.Oia(a,b)+this.S$i(a)}h5k(a,b,c,f,l,x){f?this.j5k(a,b,f,c,l,x):this.i5k(a,b,l,x)}j5k(a,b,
c,f,l,x){const G=Math.max(Math.abs(c),l);a.style.textIndent=0<c?G+"px":Math.max(G-f,0)+"px";this.xnh(G-l,-1*G,b,x)}i5k(a,b,c,f){a.style.textIndent=c+"px";this.xnh(0,-1*c,b,f)}xnh(a,b,c,f){c.style.marginLeft=f?a+"px":b+"px";c.style.marginRight=f?b+"px":a+"px"}S$i(a){a=a.t8;for(let b=0;b<a.length;b++)if(a[b]===yj.qHa){if(b+2>=a.length)break;return a[b+2]?Ka.a.fromCharCode(a[b+2]):""}return"."}LYi(a){let b="";for(;0<a;)b=Ka.a.fromCharCode(this.Y_j[a%10])+b,a=parseInt(String(a/10));return b}F9h(a,b){let c=
a;1===b.listType&&b.$7a&&0<=Array.indexOf(Ao.FYk,b.font)&&!a.indexOf("0")&&(c="f"+a.substr(1));return c}W1d(a,b,c,f,l,x){if(!this.uEg)return super.W1d(a,b,c,f,l,x);f=this.Nb.Kc(b);f.pc(11);f.Rg(11);l=this.VN.PP(f,this.ZG.gca(f));c=new zo.ParagraphStandardProperties;(x=this.Nl.xja(b))||this.Z$j.JFj(b)?(c.fontColor=Hb.a.iPa,c.fontSize=x?sf.a.rXg:yb.ParagraphReader.xia(a,tb.a.fontSize,ad.Font.$H)):(b.Sa(tb.a.fontColor)?c.fontColor=b.getValue(tb.a.fontColor):l&&l.Sa(tb.a.fontColor)&&!Se.isTableCellOrInside(f)?
c.fontColor=l.getValue(tb.a.fontColor):c.fontColor=this.Hh.xia(a,tb.a.fontColor,Hb.a.nil),f=this.Hh.xia(a,tb.a.fontSize,ad.Font.$H),a=this.Ea.xCa(this.Ea.tn(a)),a*=f,b.Sa(sb.a.vsb)&&(a*=b.getValue(sb.a.vsb)),c.fontSize=a);return c}IDh(a,b,c){this.uEg&&(b=this.wC.jI(b))&&a.ssa&&(c.style.fontSize=b.Gd.Fd.Yha(a.fontSize),c.style.lineHeight="0.1")}fbg(a,b){let c="";const f=this.Tf.k7a(b);1===f.listType&&f.$7a?c=f.font&&-1===f.font.indexOf(",")?ia.FontUtils.Xha(f.font):f.font:19===f.Oia()||18===f.Oia()&&
21>this.X0b(b,f)?c=ia.FontUtils.Xha("Dengxian"):(b=null,a&&a.parentNode&&a.parentNode.parentNode&&(b=a.parentNode.parentNode.children[1]),b&&(c=b.style.fontFamily));return c}O0b(a,b,c){a=this.fbg(b,c);b.style.fontFamily=a;b.style.fontFamily||!r.a.Nj&&!r.a.io||("Wingdings 3,Sans-Serif"===a?b.style.fontFamily="'Wingdings 3','Sans-Serif'":"Wingdings 2,Sans-Serif"===a&&(b.style.fontFamily="'Wingdings 2','Sans-Serif'"))}mVe(a,b,c,f,l,x=!1){if(this.C$b){if(b=b.parentNode.parentNode)b=0<=b.className.indexOf(hc.a.s8)?
b.parentNode:b,this.lVe(a,b,this.PL.otb(a).ZKb,this.PL.a7a(a).ZKb,c)}else super.mVe(a,b,c,f,l,x)}Atb(a){return super.Atb(a)}z8i(a,b){return this.X0b(b,a)}Ghd(a,b,c=!1){if(this.kua){const l=this.Nb.Kc(b);l.pc(11);l.Rg(11);l.Ab(2);if(c){if(b&&b.Sa(sb.a.Gug)&&!b.getValue(sb.a.Gug)){var f=b.sa(tb.a.Ni,null);f&&0<f.length&&a.setAttribute("data-charcodes",f.toString());f=this.Atb(a);f=this.fbg(f,b);Ka.a.Va(f)||a.setAttribute("data-font",f);a.setAttribute("data-buAutoNum",b.sa(sb.a.autonumberBulletType,
8))}this.B$b&&l.currentNode.Sa(sb.a.D$d)&&!l.currentNode.getValue(sb.a.D$d)&&a.setAttribute("data-margin",l.currentNode.sa(Mb.a.Rl,og.a.leftMargin).toString())}}super.Ghd(a,b,c)}Q$f(a,b){return this.Vz&&a&&b&&(Object(Ma.a)(294,a)||Object(Ma.a)(294,this.pC.Nd)&&a.Kl)?(a=new zo.ParagraphStandardProperties,a.fontName=ad.Font.nS,a.fontColor=Hb.a.iPa,a.fontSize=sf.a.dhl,a):null}}Ao.FYk="Symbol;Wingdings;Wingdings 2;Wingdings 3;Webdings;Wingdings,Sans-Serif".split(";");Object(e.a)(Ao,"ListMarkerUtility",
wi,[810]);class bn{static uZj(){"GetSpecialIndentWithTabs"in bn.Ljh||(bn.Ljh.GetSpecialIndentWithTabs=!0,Aa.a.J(40649491,817,15,"{0}:{1}","GetSpecialIndentWithTabs","Invalid tab size"))}}bn.Ljh={};Object(e.a)(bn,"SessionLogger",null,[]);class hf{constructor(a,b,c,f,l,x){this.$1c=a;this.j9=b;this.Hh=c;this.Nb=f;this.VN=l;this.OGg=x}Inh(a,b,c,f=-1){let l=this.OGg;0<=f&&(l=this.kag(a,f)||l);this.Z5k(a,b,c,l);this.$5k(a,b,l,f)}kag(a,b){let c=null;(a=a.oc(b))&&a.Gd&&(c=a.Gd.Fd);return c}Z5k(a,b,c,f){let l=
0;this.Hh.mW(a)||(l=f.EJ(this.j9.I7(a).oM,0));c?(b.style.marginLeft="",b.style.marginRight=l+"px"):(b.style.marginLeft=l+"px",b.style.marginRight="")}$5k(a,b,c,f=-1){var l=this.j9.sNc(a).oM;a.anchor&&this.Hh.mW(a)&&0<=f?this.$1c.lVe(a,b,Re.a.EJ(l,0),0,f):(f=c.EJ(l,0),l=c.EJ(this.j9.I7(a).oM,0),b.style.textIndent=this.Wfj(f,l,this.Dxi(a),this.H3i(a),c)+"px")}Dxi(a){let b=0;if(void 0!==a&&null!==a&&(a=a.characterData))for(;b<a.length;)if("\t"===a.charAt(b))b++;else break;return b}H3i(a){let b=a.sa(Mb.a.hrb,
hf.IDc);if(!a.Sa(Mb.a.hrb)){const c=this.Nb.Kc(a);c.set(a);c.pc(11);c.Rg(11);(a=this.VN.PP(c,a.sa(Mb.a.listLevel,og.a.pDa)))&&(b=a.sa(Mb.a.hrb,hf.IDc))}return b}Wfj(a,b,c,f,l){a=-1*a<b?a:-1*b;if(!c)return a;0>a&&(c--,a=0);0>=f&&(c=0,bn.uZj());0<c&&(f=l.EJ(f,0),a=(Math.floor((a+b)/f)+c)*f-b);return a}Y8h(a,b,c,f=-1){var l=this.OGg;0<=f&&(l=this.kag(a,f)||l);a=this.j9.sNc(a).oM;l=l.EJ(a,0);0>l&&(c||(b.x+=l),b.width-=l)}}hf.IDc=1440;Object(e.a)(hf,"ParagraphViewIndentationStrategy",null,[1284]);var Nl=
d(415),Im=d(630),cn=d(359),uf=d(149),Pk=d(224),xm=d(262);class di{constructor(a,b,c){this.success=a;this.Ktk=b;this.sCk=c}}Object(e.a)(di,"AddSpansForThisLinePerTextLayoutPropertyResult",null,[]);var yn=d(798);class dn{constructor(){this.Am=new D.DictionaryPropertySet}getValue(a){return this.Am.getValue(a)}sa(a,b){return this.Am.sa(a,b)}Sa(a){return this.Am.Sa(a)}get propertySet(){return this.Am.clone()}get eN(){return this.Am.sa(tb.a.font,ad.Font.nS)}get FU(){return this.Am.sa(Mb.a.FU,-1)}get fieldInstruction(){return this.Am.sa(Mb.a.fieldInstruction,
"")}get ssa(){return this.Am.Sa(tb.a.fontSize)}get fontSize(){return this.Am.sa(tb.a.fontSize,ad.Font.$H)}get Y2(){return this.Am.Sa(tb.a.fontColor)}get fontColor(){return this.Am.sa(tb.a.fontColor,Hb.a.nil)}get ulg(){return this.Am.Sa(yn.a.DWb)}get Q6f(){return this.Am.sa(yn.a.DWb,1)}get KRa(){return this.Am.Sa(tb.a.highlight)}get highlight(){return this.Am.sa(tb.a.highlight,Hb.a.nil)}get e8a(){return this.Am.Sa(Kg.a.dR)}get dR(){return this.Am.sa(Kg.a.dR,Hb.a.nil)}get wlg(){return this.Am.Sa(tb.a.Rs)}get language(){return this.Am.sa(tb.a.Rs,
0)}get ERa(){return this.Am.Sa(tb.a.bold)}get isBold(){return this.Am.sa(tb.a.bold,!1)}get b8a(){return this.Am.Sa(tb.a.italic)}get isItalic(){return this.Am.sa(tb.a.italic,!1)}get Dub(){return this.Am.Sa(tb.a.underline)}get GD(){return this.Am.sa(tb.a.underline,!1)}get PQc(){return this.Am.Sa(tb.a.Cw)}get Cw(){return this.Am.sa(tb.a.Cw,ad.Font.LU)}get Cub(){return this.Am.Sa(tb.a.strikethrough)}get rF(){return this.Am.sa(tb.a.strikethrough,!1)}get T2b(){return this.Am.Sa(Kg.a.Js)}get TZ(){return this.Am.sa(Kg.a.Js,
!1)}get isSuperscript(){return this.Am.sa(tb.a.superscript,!1)}get sF(){return this.Am.sa(tb.a.subscript,!1)}get qG(){return this.Am.sa(Mb.a.qG,null)}get Qs(){return this.Am.sa(tb.a.Qs,!1)}get WZ(){return this.Am.sa(tb.a.WZ,!1)}get Rm(){return this.Am.sa(tb.a.Rm,!1)}get M8a(){return this.Am.sa(Mb.a.M8a,!1)}get HSa(){return this.Am.sa(Oc.a.Dva,!1)}get FRa(){return this.Am.Sa(Kg.a.capitalization)}get capitalization(){return this.Am.sa(Kg.a.capitalization,0)}get HDa(){return this.Am.sa(Mb.a.HDa,!1)}Pp(a,
b){b.Sa(a)&&this.Am.setValue(a,b.Xh(a))}static lDc(a){const b=new dn;b.Am.setValue(tb.a.fontSize,sf.a.ahl);b.Pp(tb.a.superscript,a.propertySet);b.Pp(tb.a.subscript,a.propertySet);a.Qs&&b.Am.setValue(tb.a.underline,!0);return b}}Object(e.a)(dn,"PptSmartArtFormattingCache",null,[532]);class Kf{constructor(a,b,c,f){this.Zdi=a;this.bei=b;this.$di=c;this.aei=f}}Object(e.a)(Kf,"SelectionImageProperty",null,[]);var Kj=d(147),te=d(69);class mf{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,
He,fe,Te,We,Qf,mg,Xg){this.xJg=this.wJg=!1;if(!mg)throw Error.argumentNull("graphTopologyManager");this.pC=a;this.Ea=b;this.lc=c;this.s1j=f;this.Eo=l;this.wC=x;this.mbc=G;this.iC=R;this.Qy=fa;this.SW=wa;this.ua=mg;this.E0c=Wa;this.G5j=mb;this.gne=Kb&&!ie;this.C$b=nc;this.QUa=oc;this.Izb=Ic;this.h$b=Kc;this.a6c=Hc&&!ie;this.Vz=He;this.Pka=fe;this.a1c=Te;this.VOb=We;this.j6j=Qf;this.ua=mg;this.Z5j=Xg}Z6a(a,b){if(b.sa(sb.a.ZDa,!1))return sf.a.rXg;b=this.Ea.xCa(this.Ea.tn(b));return De.a.Jy(b,1)?a:2*
Math.round(a*b/2)}xIf(a,b){if(!this.VOb||!a)return b;mf.gbg(a);return b}tej(a){if(!this.Z5j||Ka.a.Va(a))return null;const b=this.ua.presentation.zYd;if(!b)return null;for(const c of b)if(c.Font===a)return c.SubstitutedByFont;return null}hbg(a,b,c){return c.Yha(this.Z6a(a,b))}M9f(a,b){return a.Sa(sb.a.$pb)?(a=a.getValue(sb.a.$pb)/Nl.a.Jgc,b.Eea(a,0)+"px"):null}jcg(a){if(a.Sa(sb.a.hxb)){const b=a.getValue(sb.a.hxb)/Nl.a.Jgc;a=a.fontSize;return 0<b&&a*Nl.a.k8a>=b?"normal":"none"}return null}m0d(a,b,
c,f){let l=null;this.E0c?l=Hb.a.ZH(0):!c&&f||!b.Y2?this.gne&&f&&(l=H.a.instance.ga(119)?b.sa(sb.a.x3b,!1)?this.Kbg(a):Hb.a.ZH(b.fontColor):this.Kbg(a)):(a=b.fontColor,l=a===Hb.a.auto?"WindowText":Hb.a.ZH(a));return l}Brh(a,b,c,f,l){return!b&&!c&&!f&&!l&&(!this.G5j||a.isSuperscript||a.sF)}Dgg(a){return a.Sa(sb.a.LM)?a.getValue(sb.a.LM)/1E3:0}D3d(){return 2/3}Kbg(a){let b=null;var c=Object.assign(new Im.a,{schemeClrField:Object.assign(new cn.a,{valField:10})});a=Object(ua.a)(119,this.lc.ig(a));(c=this.s1j.UL(c,
a?a.Pe:null))&&(b=uf.Box4ColorHelper.Jna(c).GU());return b}grh(a,b){return this.gne||a||!b}Jrh(){return!0}irh(){return this.gne}Zyl(a,b,c,f){if(!c||!c.Ua||!f||1>f.length)return b;let l=0,x=0;for(let G=0;G<f.length;G++){if(c.Ua.Qa>=x&&c.Ua.Qa<x+f[G]||c.Ua.Qa===x+f[G]&&f[G]>b.Lines[G]){l=G;break}x+=f[G]}c=0;for(const G of b.Lines)c+=G;a=a.Ra.ga(a.Ra.length-1).cp;a+1!==c&&(b.Lines[l]+=a+1-c);return b}VOf(a,b){a=Object(ua.a)(se.AParagraphNode,a);if(!a||!a.Ra)return!1;let c=0;for(let f of b)if(0>f.className.indexOf("EOP")){if(f.innerText!==
a.characterData.substr(c,f.innerText.length))return!1;c+=f.innerText.length}return!0}Zzh(a,b,c,f,l,x,G,R){if(!(this.C$b&&a&&c&&c.length&&b))return!1;var fa=this.Ea.tn(f);if(!fa)return!1;fa=this.QUa&&fa.Tyb;if(!b.$o&&!fa)return!1;f=Object(ua.a)(se.AParagraphNode,f);if(!f||!f.Ra||!fa&&this.mbc.q5a(f))return!1;c=this.B2i(c,f,!b.$o);if(this.DHi(a,c))return!1;if(0<=a.style.textAlign.indexOf("justify")){if(!this.Eo||this.Eo.dta)return!1;Sys.UI.DomElement.addCssClass(a,"JustifyAlign")}else Sys.UI.DomElement.removeCssClass(a,
"JustifyAlign");return this.Izb?this.orl(f,a,b,l,x,G,R):this.mrl(a,b,c)}IEh(a){this.QUa&&a&&(a=this.Ea.tn(a))&&a.Tyb&&(Aa.a.J(512496915,820,50,"UpdateUseTextLayoutService - Fallback to HTML Text Layout for this shape."),a.Wib(!1))}v8i(a,b){const c=Kj.a.xi(a,sb.a.BJb,null);if(!c||!c.Lines)return null;if(!b){if(!a.Ra.length)return Aa.a.J(512496914,820,50,"GetLineInfoIfValid - CharacterProperties length 0, TextLayout {0}",c.Lines.length),null;b=0;for(const f of c.Lines)b+=f;if(a.Ra.ga(a.Ra.length-1).cp+
1!==b)return null}return c}mrl(a,b,c){if(!c)return!1;const f=new Ha.a;for(const l of c){c=b.Wo(la.a.span);Sys.UI.DomElement.addCssClass(c,hc.a.s8);f.add(c);let x=!1;for(let G=0;G<l;G++)if(a.firstChild)c.appendChild(a.firstChild);else{Aa.a.J(512496913,820,10,"Span count not match between paragraph and countOfSpanInLine");x=!0;break}if(x)break}b=Object(ua.a)(419,this.wC.jI(a));if(!b)return Aa.a.J(512496912,820,10,"Line Box is not added because the ownership of paragraph dom is null"),!1;for(let l of f)b.No(l),
a.appendChild(l);return!0}orl(a,b,c,f,l,x,G){if(!b||!c)return!1;let R=Kj.a.xi(a,sb.a.BJb,null);if(!R||!R.Lines||!R.Lines.length)return!1;for(this.j6j&&(R=this.Zyl(a,R,x,G));l.count>f;)l.removeAt(f);a=new Ha.a;G=x=f=null;for(let fa=0;fa<R.Lines.length;fa++){f=c.Wo(la.a.span);Sys.UI.DomElement.addCssClass(f,hc.a.s8);a.add(f);const wa=this.O3h(R.Lines[fa],b,f,x,G,l);x=wa.Ktk;G=wa.sCk;this.o_j(fa,R.Lines.length,f.lastChild);if(!wa.success){Aa.a.J(512496911,820,50,"TryAddLineBoxWithSpanUpdatePerTextLayoutProperty - Number of chars specified by text layout not available in paragraph");
break}}for(this.kBc(x,f,l);b.firstChild;)this.kBc(b.firstChild,f,l);return this.nrl(b,a)}o_j(a,b,c){mf.zJg||(vf.Health.instance.recordKpiUsage("TextLineBreakWordBreakTelemetry",0,"pptotext",null),mf.zJg=!0);!c||!c.innerText||1>c.innerText.length||(a=a+1===b,b=-1<c.innerText.indexOf(" "),c=" "!==c.innerText.charAt(c.innerText.length-1),!mf.yJg&&!a&&b&&c&&(vf.Health.instance.recordKpiFailure("TextLineBreakWordBreakTelemetry","TLSWordBreakError",!1,!0,null),mf.yJg=!0))}O3h(a,b,c,f,l,x){let G=!0;for(;0<
a;){if(!(f&&f.innerText.length||b.firstChild)){Aa.a.J(512496910,820,10,"TryAddLineBoxSpanPerTextLayoutProperty - Number of chars specified not available");G=!1;break}let R;f?(l=R=f,f=null):(R=b.firstChild,l&&!Sys.UI.DomElement.containsCssClass(R,hc.a.aN)&&(l.style.lineHeight=R.style.lineHeight),l=null);const fa=R.innerText.length;a>=fa?(this.kBc(R,c,x),a-=fa):(f=R.cloneNode(!1),this.jil(R,f,a),this.kBc(R,c,x),a-=R.innerText.length)}return new di(G,f,l)}jil(a,b,c){a=a.childNodes;let f=-1;for(let l=
0;l<a.length;l++){const x=a[l];if(c)if(c>=x.innerText.length)c-=x.innerText.length;else{const G=x.cloneNode(!0);G.innerText=x.innerText.substring(c,x.innerText.length+1);b.appendChild(G);x.innerText=x.innerText.substring(0,c);c=0}else{f=l;break}}for(;-1!==f&&f<a.length;)b.appendChild(a[f])}kBc(a,b,c){if(a&&b&&c){b.appendChild(a);a=ya.a.j7a(a);for(let f of a)c.add(f),K.a.Cv(f,"leafEltIdx",c.count-1)}}nrl(a,b){const c=Object(ua.a)(419,this.wC.jI(a));if(!c)return Aa.a.J(512496909,820,10,"Line Box is not added because the ownership of paragraph dom is null"),
!1;for(let f of b)c.No(f),a.appendChild(f);return!0}B2i(a,b,c){const f=this.Mwi(this.v8i(b,c));if(!f||!f.length)return null;c=f.length;const l=Array(c);let x=0,G=1;for(let R=0;R<b.Ra.length;R++)G<c&&b.Ra.ga(R).cp===f[G]&&(l[x]=a[R],x++,G++);l[c-1]=a[a.length-1];if(G!==c)return Aa.a.J(512496908,820,50,"indexOfLineStartCp and countOfLine( TextLayout property) do not match"),null;a=Array(c);a[0]=l[0];for(b=1;b<c;b++)a[b]=l[b]-l[b-1];return a}Mwi(a){a=a?a.Lines:null;if(!a||!a.length)return a;const b=
Array(a.length);b[0]=0;for(let c=1;c<a.length;c++)b[c]=b[c-1]+a[c-1];return b}DHi(a,b){if(!b)return!1;a=a.childNodes;let c=0;for(const f of b){b=!0;for(let l=c;l<f+c&&l<a.length;l++)Sys.UI.DomElement.containsCssClass(a[l],hc.a.MM)||Sys.UI.DomElement.containsCssClass(a[l],hc.a.dVd)||(b=!1);if(b)return!0;c+=f}return!1}O$f(a,b,c){const f=new Lc.a;if(!a||!b||!c)return Aa.a.J(512496907,826,15,"GetCustomAttributes: htmlViewInstance={0}, paragraphNode={1}, formattingCache={2}.",a?"not null":"null",b?"not null":
"null",c?"not null":"null"),f;this.u$k(a,b)&&(a=null,c.Sa(sb.a.schemeColor)&&(a=c.getValue(sb.a.schemeColor),a=this.J$i(b,a)),Ka.a.Va(a)||f.$("data-scheme-color",a),this.a1c&&c.Sa(sb.a.yTc)&&(c.getValue(sb.a.yTc)?f.$("data-usefontface","false"):f.$("data-usefontface","true")));return f}J$i(a,b){if(Ka.a.Va(b))return"";const c=xm.SchemeColor.parse(b);if(c&&c.color&&!c.rsa){a=Object(ua.a)(119,this.lc.ig(a));a=c.resolve(a?a.Pe:null);if(!a)return"";c.vP=Pk.g(a.ZXa);return c.toString()}return b}u$k(a,b){return this.h$b&&
a.Kl&&mf.sQj(b)}NRf(a){if(this.a6c){a=a.querySelectorAll("."+mf.fSd);const c=a.length,f=Array(c);for(var b=0;b<c;++b)f[b]=this.PTk(a[b]);for(b=0;b<c;++b)te.a.tBj(a[b],f[b].Zdi,f[b].bei,f[b].$di,f[b].aei)}}NTk(a){return new Kf("linear-gradient(to right, "+te.a.nFc+", "+te.a.nFc+")",te.a.eQe,"0px "+a.style.verticalAlign,te.a.wkd)}ZDj(a){for(a=a.firstChild;a;){if(!Sys.UI.DomElement.containsCssClass(a,hc.a.h7))return!1;a=a.nextSibling}return!0}OTk(a){let b=Number.MAX_VALUE,c=0,f=0;const l=a.querySelectorAll("span."+
hc.a.h7);for(let x=0;x<l.length;x++){const G=l[x];f+=this.L4i(G);b=Math.min(b,G.offsetLeft);c=Math.max(c,G.offsetLeft+G.offsetWidth)}return new Kf("linear-gradient(to right, "+te.a.nFc+", "+te.a.nFc+")",0<c-a.offsetLeft?f+"px 100%":te.a.eQe,b-a.offsetLeft+"px "+a.style.verticalAlign,te.a.wkd)}PTk(a){return this.ZDj(a)?this.NTk(a):this.OTk(a)}L4i(a){let b=0;if((a=a.getClientRects())&&0<a.length)for(const c of a)b+=c.width;return b}P$f(a,b,c){return this.Vz&&a&&b&&c&&(Object(Ma.a)(294,a)||Object(Ma.a)(294,
this.pC.Nd)&&a.Kl)?dn.lDc(b):null}Grh(){return!1}O0b(a){let b=a.sa(sb.a.latinFont,ad.Font.nS);b.startsWith("+")&&(b=a.sa(tb.a.font,ad.Font.nS));let c=new Ha.a;c.add(b);var f=[sb.a.eastAsianFont,sb.a.complexScriptFont,sb.a.mJb];for(var l of f)a.Sa(l)&&(f=a.getValue(l),!f||f.startsWith("+")||c.contains(f)||c.add(f));if(a=this.tej(b))l=new Ha.a,l.add(b),re.a("UseServerFallbackFontFirst")?l.insert(0,a):l.add(a),this.YZj(a,c),c=l;return c.toArray().join(",")}YZj(a,b){this.wJg||ia.FontUtils.isMissingFont(b.ga(0))?
this.xJg||b.contains(a)||(Aa.a.J(512496905,820,15,"Server fallback font mismatches browser fallback(s)."),this.xJg=!0):(Aa.a.J(512496906,820,15,"Browser-used font available, but server-provided fallback mismatches."),this.wJg=!0)}HCe(a,b){if(a){var c=a.indexOf(",");0<c&&(a=a.substring(0,c))}c=!!this.iC&&this.iC.isEnabled;const f=!!this.Qy&&this.Qy.isEnabled;if(f||c||this.Pka)b=ia.FontUtils.gob(b,a,c,this.Pka,f);f&&this.Qy.createFontUrl(a);c&&(this.VOb&&a?(c=mf.gbg(a),this.iC.createFontUrl(a),c&&this.iC.createFontUrl(c)):
this.iC.createFontUrl(a));this.Pka&&this.SW.createFontUrl(a);return b}M9g(a,b){return a?this.HCe(a.fontName,b):b}MTc(){return this.Pka}static g0d(a){if(Ka.a.Va(a))return null;const b=a.indexOf(",");-1<b&&(a=a.substring(0,b).trim());return a}static gbg(a){if(Ka.a.Va(a))return null;a=mf.g0d(a);let b=a.toLowerCase();for(;b;){let c=!1;b=b.trim();for(const f of mf.jWi){let l=f;b.endsWith("\u200b")&&(l+="\u200b");b.endsWith(l)&&(c=!0,b=b.substring(0,b.lastIndexOf(l)+1))}if(!c)break}return a.substring(0,
b.length)}static sQj(a){return a.sa(sb.a.ZDa,!1)?!1:!0}}mf.fSd="Selection";mf.VVf="SelectionShadow";mf.jWi=" bold; italic; demibold; extrablack; extrabold; extralight; heavy; light; medium; regular; semibold; thin".split(";");mf.zJg=!1;mf.yJg=!1;Object(e.a)(mf,"TextRenderingStrategy",null,[1211]);class zn{constructor(){this.Jub=[]}rFe(a){a&&!Array.contains(this.Jub,a)&&(a.OZ=this,Array.add(this.Jub,a))}Vec(a,b){for(let c=0;c<this.Jub.length;c++){const f=this.Jub[c];f.Kub&&f.Vec(a,b)}}}Object(e.a)(zn,
"AHighlightManager",null,[1208]);class Bo extends zn{constructor(){super();this.BMg=this.B8b=null}get cia(){return this.B8b}get V9a(){return this.BMg}shd(a){if(a&&((this.B8b=a)&&0===this.B8b.action&&(this.BMg=this.B8b),a.sca||a.Qeb)){var b=[];for(let c=0;c<this.Jub.length;c++){const f=this.Jub[c];f.Kub&&Array.addRange(b,f.Gzh(a.sca,a.Qeb))}}}}Object(e.a)(Bo,"HighlightManager",zn,[]);class Ek{constructor(a,b){this.Aua=a;this.$8b=b;this.Aua.Yj(Object(C.a)(this,this.fh,"onPropertyChanged"))}dispose(){this.Aua.tm(Object(C.a)(this,
this.fh,"onPropertyChanged"))}fh(a,b){a=b.node;b.property.id===sb.a.BJb.id&&a.isConnected&&!this.$8b.isComposing&&a.anchor.rr(208)}}Object(e.a)(Ek,"ParagraphNodeViewBehavior",null,[106]);class io{constructor(a){this.$8b=a}yrh(a){if(a=Object(ua.a)(5,a)){if(this.$8b.isComposing){if(!a.TVc)return Aa.a.J(22586562,822,50,"Skip paragraph view validation because CEV is in IME composing"),!0;Aa.a.J(22586564,822,50,"invalidate paragraph view element because text changed in new revision")}a.TVc=!1}return!1}}
Object(e.a)(io,"ParagraphViewElementCEVSetUpdateStrategy",null,[1243]);class Qk{constructor(a){this.U2c=[sb.a.yW,sb.a.Zw,sb.a.Tca,sb.a.Zja,sb.a.Sca,sb.a.Yja,Mb.a.Rl,Mb.a.IX,Mb.a.Tn,Mb.a.XDb,Mb.a.listLevel,tb.a.xl,tb.a.EI];this.mUh=a.mbe;this.nUc=a.nUc;this.lUh=a.pptCopyPasteMarginAndIndentationEnabled}get Aad(){return this.mUh}get dxi(){return!1}get P5g(){return this.lUh}get xuk(){return this.U2c}zbl(a){return!!a.tagName&&"p"===Ka.a.wg(a.tagName)&&Sys.UI.DomElement.containsCssClass(a,hc.a.xea)}fsa(a){const b=
{};for(const c of this.U2c)b[c.id.toString()]=a.Xh(c);return b}ona(a,b){if(b){const c=yb.ParagraphReader.mW(a);this.t6k(a,b,this.U2c,this.Pxg(a),c);a.setValue(Oc.a.C5b,!0)}}Pxg(a){let b=!1;(a=nb.GraphIterator.mb(a).parentNode)&&ae.OutlineElementReader.k8(a)&&(b=Ib.ListReader.zSa(a));return b}Oek(a,b,c,f){this.P5g||(f=!0);if(this.Aad){const l=a.sa(Oc.a.C5b,!1),x=b.sa(Oc.a.C5b,!1),G=l||!f&&!x&&!l?b:a;this.hxi(G,l||!f&&!x&&!l?a:b,this.U2c,this.Pxg(G),c)}}Ohj(a){return this.P5g&&a?yb.ParagraphReader.mW(a)&&
a.Sa(sb.a.C$d)&&!a.getValue(sb.a.C$d)&&a.Sa(Mb.a.Tn)?a.getValue(Mb.a.Tn).toString():"":""}t6k(a,b,c,f,l){for(const x of c)this.wrh(x,f,l)||(c=b[x.id.toString()],void 0!==c?a.setValue(x,c):a.removeProperty(x))}hxi(a,b,c,f,l){for(const x of c)this.wrh(x,f,l)||(c=b.Xh(x),void 0!==c?a.me(x,c):a.removeProperty(x))}wrh(a,b,c){return this.nUc&&!b&&c&&(a===Mb.a.Rl||a===Mb.a.Tn)}}Object(e.a)(Qk,"PptFormattingPropertyTransitStrategy",null,[1242]);class vl{}vl.SBh="UnderlineColor";vl.nnd="UnderlinePositionInEm";
vl.ond="UnderlineThicknessInEm";vl.pLc="FontSizePx";Object(e.a)(vl,"ParagraphViewElementProperties",null,[]);class zj extends Xc{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We){super(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic);this.y7b=Kc;this.YLg=Hc;this.dLg=ie&&!fe;this.a6c=He&&!fe;this.ZLg=Te;this.w$j=We}qJd(a,b){this.y7b?a.style&&!Ka.a.Va(a.style.verticalAlign)&&(Ka.a.Va(b.style.verticalAlign)?(b.style.verticalAlign=a.style.verticalAlign.startsWith("-")?a.style.verticalAlign.substring(1,
a.style.verticalAlign.length):"-"+a.style.verticalAlign,this.h9h(a)):a.style.verticalAlign="",b.style.lineHeight="0px"):super.qJd(a,b)}h9h(a){if(null!==a.style&&!Ka.a.Va(a.style.verticalAlign)){if(this.YLg&&this.xJj(a)){const b=a.style.backgroundColor;a.style.backgroundColor=null;te.a.dHf(a,String.format("linear-gradient(to right, {0}, {0})",b),te.a.eQe,String.format("0px {0}",a.style.verticalAlign),te.a.wkd)}if(this.a6c||this.YLg)a.style.verticalAlign.startsWith("-")?a.style.paddingTop=a.style.verticalAlign.substring(1,
a.style.verticalAlign.length):a.style.paddingBottom=a.style.verticalAlign}}O_d(a){return this.y7b?"0px":super.O_d(a)}kGf(a){a.style.position=te.a.Umc}xJj(a){return Sys.UI.DomElement.containsCssClass(a,"Highlight")&&null!==a.style&&a.style.backgroundColor!==te.a.nri}MGe(a,b,c,f){if(this.dLg&&b.Qs){if(b.rF||b.TZ)a.style.textDecoration=te.a.ekl,f[f.length]="Strikethrough";b.GD&&(f[f.length]="Underlined");let l,x;this.w$j&&({nnd:l,ond:x}=this.Pij(b.eN)).returnValue?(K.a.Cv(a,vl.SBh,this.Oij(c,b)),K.a.Cv(a,
vl.nnd,l),K.a.Cv(a,vl.ond,x)):Ka.a.Va(a.style.textDecoration)?a.style.textDecoration=te.a.Vvh:a.style.textDecoration+=" "+te.a.Vvh}else super.MGe(a,b,c,f)}Oij(a,b){a=this.Ov.m0d(a,b,!1,!0);return String.format("linear-gradient(to right, {0}, {0})",a)}Pij(a){return{returnValue:"Calibri"===a,nnd:1.1133,ond:.0654}}IFj(a,b){if(!a||!b)return!1;for(a=a.firstChild;a;){if(Sys.UI.DomElement.containsCssClass(a,hc.a.h7))return!0;a=a.nextSibling}return!1}jGf(a,b){this.a6c&&(Sys.UI.DomElement.containsCssClass(b,
hc.a.h7)||this.IFj(a,hc.a.h7)?(Sys.UI.DomElement.addCssClass(a,mf.fSd),this.ZLg&&r.a.Nj&&Sys.UI.DomElement.addCssClass(a,mf.VVf)):(Sys.UI.DomElement.removeCssClass(a,mf.fSd),this.ZLg&&r.a.Nj&&Sys.UI.DomElement.removeCssClass(a,mf.VVf)));if(this.dLg&&Sys.UI.DomElement.containsCssClass(a.parentNode,hc.a.Vmg)){const c=K.a.te(a,vl.SBh),f=K.a.te(a,vl.ond);let l=K.a.te(a,vl.nnd);if(c&&f&&l){if(!Ka.a.Va(a.style.fontSize)&&a.style.fontSize.endsWith("px")&&!Ka.a.Va(b.style.verticalAlign)&&b.style.verticalAlign.endsWith("px")){a=
parseFloat(a.style.fontSize);const x=parseFloat(b.style.verticalAlign);isNaN(a)||!a||isNaN(x)||(l-=x/a)}te.a.dHf(b,c,String.format("100% {0}em",f),String.format("0% {0}em",l),te.a.wkd);b.style.textDecoration=te.a.fkl}}}}Object(e.a)(zj,"PptParagraphContentRenderer",Xc,[]);class Co{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Paragraph"}Wb(a){this.K=a;this.sFe();this.zFe();this.bOk();this.vFe();this.iOk();this.jOk();this.aOk()}init(){this.K.register(1208,"Box4.Highlight.IHighlightManager").ma().na(()=>
new Bo);this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393230,new rj.a((a,b)=>new sk(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.PptParagraphContentRenderer"),new Bc.a(a,b),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),()=>null,()=>null,a.Kl&&u.AFrameworkApplication.fa.ka("SkipUpdateContentEditableViewWhenComposing")?this.K.resolve("PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy"):this.K.resolve("Box4.DefaultParagraphViewElementSetUpdateStrategy"),
this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.Highlight.IHighlightManagerFactory").instance,this.K.resolve("Box4.ITextRenderingStrategy"),this.K.resolve("Box4.IParagraphOverlayControlRenderer"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393234,new rj.a((a,b)=>new wm(a,b,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphViewIndentationStrategy"),
this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)));this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior")}dispose(){this.K.resolve("PowerPointWebEditor.ParagraphNodeViewBehavior").dispose()}sFe(){this.K.register(1209,"PowerPointWebEditor.IListMarkerOffsetCache").ma().na(()=>new ho);this.K.register(1210,"Box4.IListMarkerUtility").ma().na(()=>new Ao(this.K.resolve("Box4.List.IListReader"),this.K.resolve("Box4.IParagraphIndentationReader"),rb.a.instance,this.K.resolve("PowerPointWebEditor.IListMarkerOffsetCache"),
this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Graph.ISmartArtReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("Box4.IInteractiveViewManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderListBulletStyleInBox4Enabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").q9a,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteListMarkerEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteMarginAndIndentationEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled))}zFe(){this.K.register(1211,"Box4.ITextRenderingStrategy").ma().na(()=>
new mf(this.K.resolve("Box4.IInteractiveViewManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IBox4ColorHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IPPTParagraphReader"),this.K.qb("Box4.CloudFontService"),this.K.qb("Box4.CustomFontService"),this.K.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ntg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").iyg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").fyg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").q9a,this.K.resolve("PowerPointWebEditor.IApplicationSettings").CJb,this.K.resolve("PowerPointWebEditor.IApplicationSettings").$xh,this.K.resolve("PowerPointWebEditor.IApplicationSettings").dVc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").hyg,
this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").KIj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").Fnl,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").R1k))}bOk(){this.K.register(ep,"Box4.DefaultParagraphViewElementSetUpdateStrategy").ma();this.K.register(io,"PowerPointWebEditor.Paragraph.ParagraphViewElementCEVSetUpdateStrategy").ma().na(()=>new io(this.K.resolve("Box4.IEditingView")))}vFe(){this.K.register(hf,"PowerPointWebEditor.ParagraphViewIndentationStrategy").as("Box4.IParagraphViewIndentationStrategy").ma().na(()=>new hf(this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.IParagraphIndentationReader"),
this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),new yo.a))}iOk(){this.K.register(Qk,"PowerPointWebEditor.Paragraph.PptFormattingPropertyTransitStrategy").as("Box4.IFormattingPropertyTransitStrategy").ma().na(()=>new Qk(this.K.resolve("PowerPointWebEditor.IApplicationSettings")))}jOk(){this.K.register(zj,"PowerPointWebEditor.PptParagraphContentRenderer").as("Box4.IParagraphContentRenderer").ma().na(()=>
new zj(pa.InteractiveViewManager.instance,ja.a.instance,this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,this.K.resolve("Box4.IFormattingPropertyTransitStrategy"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.qb("Box4.Proofing.IIgnoreAllKeywords"),this.K.resolve("Box4.ITextRenderingStrategy"),this.K.resolve("Box4.ParagraphContentRendererSettings"),this.K.resolve("Box4.ILineSpacingHelper"),this.K.qb("Box4.IFeatureHelper"),ia.FontUtils.pwi,this.K.qb("Box4.IFontSlotProvider"),
Object(C.a)(this.K.resolve("Box4.IEditStateEventManager"),this.K.resolve("Box4.IEditStateEventManager").fbh,"raiseParagraphContentUpdatedEvent"),vb.a.language,this.K.qb("Box4.ITableOfContentRenderHelper"),gc.a.ZKf,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorDifferentLineHeightEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").iyg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").fyg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").hyg,this.K.resolve("Common.Utils.IHighContrastDetector").isInHighContrastMode,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextSelectionShadowFixIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").ial))}aOk(){this.K.register(Ek,"PowerPointWebEditor.ParagraphNodeViewBehavior").ma().na(()=>new Ek(this.K.resolve("Box4.Graph.IGraphInstance").vd(12),this.K.resolve("Box4.IEditingView")))}static main(){m.a.instance.Bc(new Co)}}Object(e.a)(Co,"PPTWebEditorParagraphPackage",null,[2,3]);var zh=d(106),jk=d(489),Bp=d(613);class Jm extends Sys.EventArgs{constructor(a){super();
this.Bk=a}}Object(e.a)(Jm,"PopSessionClosedEventArgs",Sys.EventArgs,[]);class Rk{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie){this.cpe=this.Fua=null;this.Fe=a;this.ew=b;this.Md=c;this.jc=f;this.la=l;this.Ucc=x;this.f3c=G;this.Sx=R;this.We=fa;this.Hda=wa;this.ra=Wa;this.Af=mb;this.ua=Kb;this.ia=nc;this.yb=oc;this.L8=Ic;this.Ho=Hc;this.kC=ie;G.NId(Object(C.a)(this,this.BDb,"onPodSessionUnavailable"));G.hob(Object(C.a)(this,this.oea,"onPodSessionRefreshed"));Kc.JB(Object(C.a)(this,this.to,
"onSessionRehydrated"));this.Spe=new xe.a(4,2,2E3,Object(C.a)(this,this.detectFailoverTimeout,"detectFailoverTimeout"),90,"18")}get isEnabled(){return this.la.tg}get H5b(){return!!this.Fua}jbj(a,b){const c=Nc.a.Pl("GetPodSessionInfo");try{const f=this.Fe.podSessionId,l=zh.a.create().toString(),x=String.format("{0}PodHandler.ashx?action=GetPodSessionInfo",this.la.podsWebServiceBase),G={};G.PodSID=f;G["X-UserSessionId"]=this.Ucc();G["X-CorrelationID"]=l;c.Wa("PodSessionId",f);c.Wa("Cid",l);this.ew.sV(x,
2,null,G,[Jg.a.P4],0,R=>{try{if(f!==this.Fe.podSessionId)c.Wa("ExpectedPodSessionId",f),c.Wa("ActualPodSessionId",this.Fe.podSessionId),c.Wa("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{var fa=!0;if(R.data){if(c.Wa("HttpStatus",R.data.Le.toString()),c.Wa("RequestStatus",jk.a[R.data.status]),R.data.qj){const wa=R.data.qj[Jg.a.P4];wa&&"errorCannotFindSession"===wa&&(c.Wa("ErrorCode",wa),fa=!1)}}else c.Wa("HttpStatus","UNKNOWN"),c.Wa("RequestStatus","UNKNOWN");fa?(c.Wa("Result","Succeeded"),
c.finish(),a&&a()):(c.Wa("Result","Failed"),c.finish(!0),b&&b())}}catch(wa){Aa.a.J(512496143,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",wa),b&&b()}},R=>{try{if(f!==this.Fe.podSessionId)c.Wa("ExpectedPodSessionId",f),c.Wa("ActualPodSessionId",this.Fe.podSessionId),c.Wa("Result","PodSessionIdUnexpected"),c.finish(!0),a&&a();else{if(R.data){if(c.Wa("HttpStatus",R.data.Le.toString()),c.Wa("RequestStatus",jk.a[R.data.status]),R.data.qj){const fa=R.data.qj[Jg.a.P4];fa&&c.Wa("ErrorCode",
fa)}}else c.Wa("HttpStatus","UNKNOWN"),c.Wa("RequestStatus","UNKNOWN");c.Wa("Result","Failed");c.finish(!0);b&&b()}}catch(fa){Aa.a.J(512496142,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",fa),b&&b()}},null,void 0,void 0,this.la.lbj,this.la.mbj,"GetPodSessionInfo",void 0,!0)}catch(f){Aa.a.J(512496141,801,10,"PodSessionManager::GetPodSessionInfo - Exception: {0}",f),c.Wa("Result","Failed"),c.finish(!0),b&&b()}}BDb(a,b){a=!1;this.Fua?Aa.a.J(512496140,801,15,"PodSessionManager::OnPodSessionUnavailable - Already unavailable. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",
this.Fe.presentationId.string,this.Sx.vja,this.We.hA,this.Fe.Bk,this.Fe.podSessionId,!this.jc.un,Nc.a.$e(this.Fua),!!this.Ho.instance,b.kKc):(this.Fua=new Date,a=!0,Aa.a.J(512496139,801,15,"PodSessionManager::OnPodSessionUnavailable - Unavailable is detected. PresentationId:{0}; IsBootCompleted:{1}; PopSessionInitialized:{2}; PopSessionId:{3}; PodSessionId:{4}; ReadOnly mode:{5}; PodsUnavailableStartTime:{6}; PodSeamlessRehydrationManager:{7}; FPodsOrderlyShutdown:{8}",this.Fe.presentationId.string,
this.Sx.vja,this.We.hA,this.Fe.Bk,this.Fe.podSessionId,!this.jc.un,Nc.a.$e(this.Fua),!!this.Ho.instance,b.kKc));this.L8.instance&&this.L8.instance.EUc?Aa.a.J(512496138,801,15,"PodSessionManager::OnPodSessionUnavailable - IsNonDismissibleDialogShown is TRUE, ignore Pods unavailable signal. PopSessionId:{0}; PodSessionId:{1}",this.Fe.Bk,this.Fe.podSessionId):this.Sx.vja&&this.la.podsSeamlessFailoverEnabled&&this.Ho.instance?this.Ho.instance.mTe(b.kKc,4,b.errorCode):(this.Md.jja=!1,this.Sx.vja?this.We.hA?
(a&&this.yb.Cb(this.Spe),this.Hda.pOc(this.Fe.presentationId.string,this.Fe.Bk,this.Fe.podSessionId,b.kKc,c=>{this.nXk(c,this.Fe.Bk)},c=>{this.mXk(c,this.Fe.Bk)}),this.ra.setSelection(null),this.Af.blockContent(this.ua.presentation,"OnPodSessionUnavailable",!0),Aa.a.J(512496136,817,15,"PodSessionManager::OnPodSessionUnavailable, Block Presentation")):this.epj():Aa.a.J(512496137,801,15,"PodSessionManager::OnPodSessionUnavailable - Skip since session is not ready. PodSessionId:{0}",this.Fe.podSessionId))}epj(){this.cpe||
(this.cpe=new Date);const a=+new Date-+this.cpe;a>this.la.podsNullSrmWaitTimeInMs?(Aa.a.J(512496135,801,15,"PodSessionManager::OnPodSessionUnavailable - Already wait {0}ms, won't wait anymore. PodSessionId:{1}",a,this.Fe.podSessionId),u.AFrameworkApplication.jp(Jf.a.Qh(305)),vf.Health.instance.recordQosError("ErrorCannotFailoverRehydration",["UnexpectedAppRefresh"],!1,!1,!0,!0,null),this.ia.La(ba.a.refresh,2,{refreshtrigger:"PodSessionManager::HandleNullPodFailoverManager"})):Aa.a.J(512496134,801,
15,"PodSessionManager::OnPodSessionUnavailable - Skip since PodFailoverManager is not ready. MaxWaitTime:{0}ms; ElapsedTime:{1}ms. PodSessionId:{2}",this.la.podsNullSrmWaitTimeInMs,a,this.Fe.podSessionId)}detectFailoverTimeout(){if(this.Fua){var a=+new Date-+this.Fua;a>this.la.podsFailoverBrowserWaitTimeoutInMs&&(this.yb.Ng(this.Spe),Aa.a.J(512496133,801,15,"PodSessionManager::DetectFailoverTimeout - Won't wait for failover any longer. ElapsedTimeInMs:{0}, PodSessionId:{1}, PopSessionId:{2}",a,this.Fe.podSessionId,
this.Fe.Bk),a=Object.assign(new bg.a,{Code:293,Source:6}),this.Md.es(a,this.Fe.podSessionId,b=>{b.NB=1;b.WAa=8;return!1}))}}nXk(a,b){a&&(this.Fe.Bk!==b?Aa.a.J(512496132,801,15,"PodSessionManager::RetrievePODSInfoSucceeded - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",this.Fe.Bk,b,this.Fe.podSessionId):(b=a.result)?(Aa.a.J(512496131,817,50,"PodSessionManager::RetrievePODSInfoSucceeded - OldPodSessionId:{0}; NewPodSessionId:{1};",this.Fe.podSessionId,
b.DocumentSessionID),this.Fe.podSessionId!==b.DocumentSessionID&&(a=this.Fe.podSessionId,this.Fe.podSessionId=b.DocumentSessionID,this.f3c.hbh(new Bp.a(a,b.DocumentSessionID)))):Aa.a.J(512496130,801,10,"Return type: {0}. PodSessionId:{1}, PopSessionId:{2}",a.result?Object.getType(a.result):null,this.Fe.podSessionId,this.Fe.Bk))}mXk(a,b){if(this.Fe.Bk!==b)Aa.a.J(512496129,801,15,"PodSessionManager::RetrievePODSInfoFailed - Ignore failure since PopSessionId is changed. CurrentPopSession:{0}; RequestPopSession:{1}; PodSessionId:{2}",
this.Fe.Bk,b,this.Fe.podSessionId);else{b=316;var c=-1;a&&a.error&&(b=Jf.a.SM(a.error.Pm),c=a.error.Pm);Aa.a.J(512496128,801,15,"PodSessionManager::RetrievePODSInfoFailed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; ResponseRecievedTime:{4}; BSQMErrorCode:{5}; ServerErrorCode:{6}",this.Fe.presentationId.string,this.Fe.Bk,this.Fe.podSessionId,"",Nc.a.$e(new Date),c,b);c===Jf.a.Qh(241)&&(this.We.hA=!1,this.We.Gfa&&this.kC.oEe(new Jm(this.We.Qca)))}}oea(a,
b){Nc.a.rxb=new Date;Nc.a.Sld=[];this.Fe.podSessionId!==b.xX?Aa.a.J(512496099,801,15,"PodSessionManager::OnPodSessionRefreshed - PodSessionId should not change when we get the event! ExpectedPodSessionId:{0}; NewPodSessionId:{1}; PopSessionId:{2}",this.Fe.podSessionId,b.xX,this.Fe.Bk):(this.yb.Ng(this.Spe),Aa.a.J(512496098,801,15,"PodSessionManager::OnPodSessionRefreshed - PresentationId:{0}; PopSessionId:{1}; OldDocumentSessionID:{2}; NewDocumentSessionID:{3}; PodsUnavailableStartTime:{4}; PodsRefreshedTime:{5}",
this.Fe.presentationId.string,this.Fe.Bk,b.jDb,b.xX,Nc.a.$e(this.Fua||new Date),Nc.a.$e(new Date)),this.Md.jja=!1,this.la.podsSeamlessFailoverEnabled&&this.Ho.instance?Aa.a.J(512496097,801,15,"PodSessionManager::OnPodSessionRefreshed - Skip refresh Doc since seamless failover is on."):(a={failedMachineId:null,isPlanedShutdown:!1,isPodSessionRefreshed:!0},a.podSessionId=b.xX,this.ia.La(ba.a.xFb,2,a)),this.Fua=null)}to(){this.Fua=null}}Object(e.a)(Rk,"PodSessionManager",null,[1206]);var Wg;(function(a){a[a.active=
0]="active";a[a.passive=1]="passive";a[a.hidden=2]="hidden";a[a.frozen=3]="frozen"})(Wg||(Wg={}));Object(e.b)("AppVisibilityState",Wg);class Cp{constructor(){this.IsTabHidden=!1;this.PresentationID=this.PopSessionID=null}}Object(e.a)(Cp,"GetHostSessionInfoParams",null,[]);class gj{constructor(a,b,c,f,l,x,G,R,fa,wa){this.Y3c=0;this.PFa=this.Uka=this.Oqe=null;this.BQg=0;this.rte=!1;this.Xa=b;this.FAb=a;this.We=c;this.la=f;this.L8=l;this.cO=x;this.Gda=G;this.jc=R;this.XN=fa;this.uva=wa;this.nyb=0;this.AAb=
this.la.getHostSessionInfoRequestTimeoutInMs;this.o8j=this.la.getHostSessionInfoRequestMaxTimeoutInMs;this.u8j=this.la.getHostSessionInfoPingIntervalForFailedResponseInMs;this.A1j=f.maxPopsRehydrationCount;this.Ype=this.la.b7g;this.GAb=this.la.podsPopSessionDisconnectedTimeLimitInMS;this.mka=!1;this.Uzb=this.Xa.Bk;this.jMg="";this.nfd();this.JIa(0,!0)}nfd(){this.Y3c=0;this.PFa=new Date}Aki(a){if(this.yja&&!u.AFrameworkApplication.Vg&&this.jc.WK){var b=!1;this.uva&&this.uva.instance&&(b=2===this.uva.instance.G3a,
this.rte||(this.rte=!0,this.uva.instance.EBc(Object(C.a)(this,this.YFh,"visiblityChanged"))));var c=Object.assign(new Cp,{PopSessionID:this.Xa.Bk,PresentationID:this.Xa.presentationId.string,IsTabHidden:b});this.Oqe=new Date;b=Math.min(this.AAb+2E3*this.Y3c,this.o8j);var f=ta.a.tH("RequestTimeout",b.toString());this.FAb.ENc(c,()=>{this.Cmk(c.PopSessionID,a)},l=>{this.Bmk(l,c.PopSessionID,a)},null,f,this.la.getHostSessionInfoRequestTimeoutInMs,b+2E3)}else this.jc.WK&&(Aa.a.J(24655577,801,50,"HostSessionInfoCaller::CallGetHostSessionInfo - Skipped. IsClientActive:{0}; IsShuttingDown:{1}; IsNonDismissibleDialogShown:{2}; AppInReadMode:{3};",
this.yja,u.AFrameworkApplication.Vg,!!this.L8.instance&&this.L8.instance.EUc,!this.jc.un),this.close(this.yja?this.jc.WK?"AppShuttingDown":"TransitionedToReadingMode":"ClientDisabled"))}JIa(a,b){this.Uka=new Date;this.BQg=window.setTimeout(()=>{this.Aki(b)},a)}Ryl(a){Aa.a.J(24655581,801,50,"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded - popSessionId:{0}, TimeTakenInMs:{1}",a,+new Date-+this.Oqe);this.nfd();this.nyb=0;this.We.Jde=this.PFa;this.We.Ide=a}Cmk(a,b){this.XN.Ljc();this.cO.W3f(a,
"HostSessionInfoCaller::OnGetHostSessionInfoSucceeded")?this.JIa(0,b):(this.Ryl(a),b&&this.JIa(this.la.getHostSessionInfoPingIntervalInMs,!0))}YFh(a,b){Aa.a.J(592852376,801,50,"HostSessionInfoCaller.VisiblityChanged - Old:{0},  New:{1} ",Wg[b.oldState],Wg[b.newState]);this.JIa(0,!1)}gli(){return this.Gda.H5b||!this.yja?(Aa.a.J(36320459,801,15,"HostSessionInfoCaller.CanRehydrateHostSession - Skip POPS Rehydration. IsPodSessionUnavailable:{0}; IsClientActive:{1}; Now:{2}",this.Gda.H5b,this.yja,Nc.a.$e(new Date)),
!1):this.nyb>this.A1j?(Aa.a.J(36996355,801,10,"HostSessionInfoCaller::CanRehydrateHostSession: Skip POPS rehydration, abort the ping client and raise an ACE error because we exceeded max rehydration threshold. Total number of POPS created so far:{0}; Max Allowed:{1};",this.nyb,this.la.maxPopsRehydrationCount),this.close("POPSRehydrationThresholdReached"),this.cO.o5d(Jf.a.Qh(328),"HostSessionInfoCaller::CanRehydrateHostSession"),!1):!0}Mea(a){this.gli()&&(++this.nyb,this.cO.Mea(a),this.nfd())}ibl(a){if(Jf.a.RS(a))switch(Jf.a.SM(a)){case 326:case 240:case 103:return!0;
case 329:return this.la.SOk}return!1}X4i(a){if(Jf.a.RS(a))switch(Jf.a.SM(a)){case 326:return 10;case 240:return 1;case 103:return 12;case 329:return 13;default:return 14}else return 14}Bmk(a,b,c){a.TX&&200===a.TX.Le&&this.XN.Ljc();if(this.cO.W3f(b,"HostSessionInfoCaller::OnGetHostSessionInfoFailed"))this.JIa(0,c);else{++this.Y3c;var f=+new Date-+this.PFa,l=44,x=-1;a&&a.error&&(l=Jf.a.RS(a.error.Pm)?Jf.a.SM(a.error.Pm):44,x=a.error.Pm);a=ta.a.tH("PopSessionId",b,"ServerErrorCode",l,"BSQMErrorCode",
x,"TimeTakenInMs",+new Date-+this.Oqe,"RetryCount",this.Y3c,"PopSessionDisconnectedTimeLimitInMS",this.GAb,"PopsIdleTimeLimitInMS",this.Ype,"Now",Nc.a.$e(new Date),"CurrentDisconnectedTimeInMs",f,"PopSessionCreatedCount",this.nyb,"LastPingScheduledTime",Nc.a.$e(this.Uka),"LastSuccessfulEnsureHostSessionId",this.We.Hde);b="";try{b=Sys.Serialization.JavaScriptSerializer.serialize(a)}catch(G){Aa.a.J(36320455,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Exception thrown while serializing the log string:{0};",
G)}Aa.a.J(24655583,801,15,"HostSessionInfoCaller::OnGetHostSessionInfoFailed - Ping request failed: "+b);+new Date-+this.Uka>this.GAb?this.JIa(0,c):this.ibl(x)?this.Mea(this.X4i(x),x):x===Jf.a.Qh(370)?f<this.Ype?this.JIa(this.la.getHostSessionInfoPingIntervalInMs,c):this.Mea(11,x):f>=this.GAb?this.Mea(3,x):this.JIa(this.u8j,c)}}Vee(a){const b=ta.a.tH("LastUsedPopSessionId",this.Uzb,"LastClientClosedReason",this.jMg,"IsClientActive",this.yja,"AppInEditingMode",this.jc.un,"PopSessionDisconnectedTimeLimitInMS",
this.GAb,"PopsIdleTimeLimitInMS",this.Ype,"Now",Nc.a.$e(new Date),"ConsecutivelyTriggeredPopsRehydrationCount",this.nyb,"LastPingScheduledTime",Nc.a.$e(this.Uka),"LastSuccessfulEnsureHostSessionId",this.We.Hde);let c;try{c=Sys.Serialization.JavaScriptSerializer.serialize(b)}catch(f){Aa.a.J(51421313,801,15,"HostSessionInfoCaller::LogPopsState - Exception thrown while serializing the log string:{0};",f),c=""}Aa.a.J(51421315,801,15,"HostSessionInfoCaller::LogPopsState:{0} - {1}",a,c)}lIa(a){Aa.a.J(36282957,
801,15,"HostSessionInfoCaller.Reboot - Reason:{0}. Restarted on PopSession {1}. LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.Bk,this.Uzb,this.yja);this.yja&&this.Uzb===this.Xa.Bk||(this.Uzb=this.Xa.Bk,this.nfd(),this.mka?(this.mka=!1,this.JIa(0,!0)):Aa.a.J(51421318,801,15,"HostSessionInfoCaller.Reboot did not schedule a ping request as the client was not closed previously - Reason:{0}; PopSession:{1}; LastUsedPopSession:{2}; IsClientActive:{3};",a,this.Xa.Bk,this.Uzb,this.yja))}close(a){this.mka||
(Aa.a.J(36536660,801,15,"HostSessionInfoCaller.Close - PopSession:{0}; Now:{1}; Reason:{2};",this.Xa.Bk,Nc.a.$e(new Date),a),this.rte&&this.uva&&this.uva.instance&&this.uva.instance.tSk(Object(C.a)(this,this.YFh,"visiblityChanged")),this.mka=!0,this.Uzb="",this.jMg=a,window.clearTimeout(this.BQg))}get yja(){return!this.mka}}Object(e.a)(gj,"HostSessionInfoCaller",null,[]);class oh{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){this.gla=null;this.FAb=a;this.Xa=b;this.Mc=c;this.We=f;this.la=l;this.L8=x;this.cO=
G;this.Gda=R;this.jc=fa;this.XN=Wa;this.uva=mb;this.Mc.OId(Object(C.a)(this,this.Zdb,"onPopSessionClosed"));this.Mc.IB(Object(C.a)(this,this.ceb,"onSessionEnded"));this.We.Gfa&&this.Mc.PId(Object(C.a)(this,this.KWa,"onPopSessionInitialized"))}Ozj(){Aa.a.J(24655587,801,50,"PopSessionInfoClient::InitializeGetHostSessionInfoClient");this.We.hA?this.mye():this.We.Gfa||this.We.tgc.task.continueWith(()=>{this.mye()})}KWa(){this.mye()}mye(){this.We.Gfa?!this.gla&&this.We.hA?this.gla=new gj(this.FAb,this.Xa,
this.We,this.la,this.L8,this.cO,this.Gda,this.jc,this.XN,this.uva):this.lIa("PopSessionInitialized"):this.We.hA&&(this.Wmc(),this.gla=new gj(this.FAb,this.Xa,this.We,this.la,this.L8,this.cO,this.Gda,this.jc,this.XN,this.uva))}Zdb(){this.close("PopSessionClosed")}ceb(){this.Vee("SessionClosed")}Vee(a){this.gla&&this.gla.Vee(a)}Wmc(){this.We.tgc.task.continueWith(()=>{this.nye()})}nye(){this.We.hA&&this.lIa("PopSessionInitialized");this.Wmc()}lIa(a){this.gla&&this.gla.lIa(a)}close(a){this.gla&&this.gla.close(a)}get yja(){return!!this.gla&&
this.gla.yja}dispose(){this.Mc.Bfh(Object(C.a)(this,this.Zdb,"onPopSessionClosed"));this.We.Gfa&&this.Mc.qGe(Object(C.a)(this,this.KWa,"onPopSessionInitialized"))}}Object(e.a)(oh,"PopSessionInfoClient",null,[1207,106]);var tk=d(281),hj=d(217),Fi=d(111),An=d(643),Lj=d(318),jo=d(844),ym=d(831);const Ol=a=>{if(Jf.a.RS(a)){a=Jf.a.SM(a);if(ym.a(a))return 1;switch(a){case 103:case 44:case 370:return 0;case 309:case 311:case 27:case 320:case 244:case 245:case 372:return 1;case 326:return 2;default:return 3}}else switch(a){case Jf.a.dCa:case Jf.a.qWc:return 0;
default:return 3}};class wl{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){this.Xa=a;this.We=b;this.Md=c;this.la=f;this.uv=l;this.kC=x;this.n9=G;this.Hda=Wa;this.jc=mb;this.Gda=fa;this.BNg=this.la.hermesNotRefreshErrorList;this.Goe=this.la.podsMaxRetryTimesForEnsureHostSession;this.kNg=this.la.podsMaxRetryDurationForEnsureHostSessionInMs;this.la.tg&&(R.l8h(Object(C.a)(this,this.prk,"onSyncLoopStatusNotified")),wa.c7h(Object(C.a)(this,this.nrk,"onSuccessfulOutbound")),wa.cba(Object(C.a)(this,this.jz,"onUnifiedAppStateChanged")));
u.AFrameworkApplication.Kz&&wa.KBc(Object(C.a)(this,this.uea,"onWopiTokenRefreshed"))}Mea(a,b=null,c=null){var f=this.n9.G6a(this.Xa.presentationId.string);f=Object.assign(new An.a,{ForceCreatePods:!1,DoRehydrate:!0,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.la.podsWebServiceBase,PopSessionID:f,UrlOverrides:this.la.Dea,IsCoauthSession:u.AFrameworkApplication.Tg.IsCoauthSession,IsCreateNewSession:this.la.NS,UseSharedHostFile:this.la.VKb});
this.n9.QDc(f,b,c,a)}qxe(a,b){if(this.X3f(b,"PopSessionManager::OnEnsureHostSessionSucceeded"))this.Odh();else{var c=new Date;this.Xa.Bk=b.iB.PopSessionID;this.We.hA=!0;this.We.sgc=!0;this.We.Hde=b.iB.PopSessionID;this.We.Sja=c;this.We.Gfa&&this.kC.PHk();Aa.a.J(22934494,801,15,"PopSessionManager::OnEnsureHostSessionSucceeded - OldPopSessionID: {0}, ExpectedPopSessionId: {1}, ExpectedPodSessionId: {2}, CurrentPodSessionId:{3}, Trigger: {4}, Retries: {5}, StartTime: {6}, EndTime: {7}, Duration: {8}ms, ActionId: {9},",
b.BWa,b.iB.PopSessionID,b.iB.PodSessionID,this.Xa.podSessionId,jo.a[b.trigger],b.retryCount,Nc.a.$e(b.startTime),Nc.a.$e(c),+c-+b.startTime,b.actionId);b.pH&&b.pH(a)}}sDb(a,b){let c=a.error.Pm;const f=new Date;if(this.X3f(b,"PopSessionManager::OnEnsureHostSessionFailed -"))this.Odh();else{if(b.retryCount<this.Goe&&+f-+b.startTime<=this.kNg){if(0===Ol(c)||c===Jf.a.Qh(252)){b.retryCount++;a=this.n9.G6a(this.Xa.presentationId.string);Aa.a.J(23349401,801,50,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, Now: {8}, Duration: {9}ms, bSqmErrorCode: {10}, ActionId: {11},",
"PopSessionManager::OnEnsureHostSessionFailed -",b.BWa,b.iB.PopSessionID,b.iB.PodSessionID,this.Xa.podSessionId,jo.a[b.trigger],b.retryCount,Nc.a.$e(b.startTime),Nc.a.$e(f),+f-+b.startTime,c,b.actionId);b.iB.PopSessionID=a;b.iB.IsRetrySession=!0;this.n9.hNf(b);return}this.We.Sja=f;var l="FatalError"}else this.We.Sja=f,l=b.retryCount>=this.Goe?String.format("Exceeded the limit of {0} times of retrying",this.Goe):String.format("EnsureHostSession duration exceeded the limit of {0}ms. ElapsedTime: {1}ms",
this.kNg,+f-+b.startTime);c===Jf.a.dCa&&(c=0===b.trigger?Jf.a.Qh(375):Jf.a.Qh(309));Aa.a.J(23667161,801,10,"{0} OldPopSessionID: {1}, ExpectedPopSessionId: {2}, ExpectedPodSessionId: {3}, CurrentPodSessionId:{4}, Trigger: {5}, Retries: {6}, StartTime: {7}, EndTime: {8}, Duration: {9}, bSqmErrorCode: {10}, AbortReason: {11}, ActionId:{12},","PopSessionManager::OnEnsureHostSessionFailed -",b.BWa,b.iB.PopSessionID,b.iB.PodSessionID,this.Xa.podSessionId,jo.a[b.trigger],b.retryCount,Nc.a.$e(b.startTime),
Nc.a.$e(f),+f-+b.startTime,c,l,b.actionId);b.ru&&b.ru(a)||this.o5d(c,"PopSessionManager::OnEnsureHostSessionFailed -")}}X3f(a,b){return a.iB.PodSessionID!==this.Xa.podSessionId?(Aa.a.J(512262810,801,15,"EnsureHostSession - Ignore response since PodSessionId is changed. CurrentPodsSession:{0}; RequestPodsSession:{1}; functionName:{2} Need to trigger another request immediately.",this.Xa.podSessionId,a.iB.PodSessionID,b),!0):!1}Odh(){this.We.Sja=new Date;this.Mea(8)}prk(a,b){a=Jf.a.Qh(b.Fwh);Aa.a.J(512262809,
801,10," {0} - ServerErrorCode:{1}, bSqmErrorCode:{2}, PopSessionId:{3}, PodSessionId:{4}","PopSessionManager::OnSyncLoopStatusNotified",b.Fwh,a,this.Xa.Bk,this.Xa.podSessionId);this.We.hA=!1;this.We.Gfa&&this.kC.oEe(new Jm(this.We.Qca));this.o5d(a,"PopSessionManager::OnSyncLoopStatusNotified",b.uQi)}uea(a,b){try{b.YVc?(Aa.a.J(512262808,814,50,"PopSessionManager::OnWopiTokenRefreshed Token refresh succeeded."),b.fNj||(this.Gpb(()=>{},()=>{}),this.Mea(9))):Aa.a.J(512262807,814,15,"PopSessionManager::OnWopiTokenRefreshed Token refresh failed.")}catch(c){Aa.a.J(512262806,
814,10,"PopSessionManager::OnWopiTokenRefreshed Exception: {0}",c)}}W3f(a,b){return a&&this.Xa.Bk&&this.Xa.Bk!==a?(Aa.a.J(512262805,801,15,"PopSessionManager::FStaleResponse - RequestingFunctionName:{0} - Ignore response since PopSessionId is changed. CurrentPopSessionId:{1}; RequestPopSessionId:{2}; LastAttemptedEnsureHostSessionId:{3};",b,this.Xa.Bk,a,this.We.Qca),!0):!1}o5d(a,b,c=null){Aa.a.J(512262804,801,10,"PopSessionManager::HandlePOPSErrors:{0}; SourceFunction:{1};",a,b);if(!this.Fnj(a)){if(u.AFrameworkApplication.Kz&&
a===Jf.a.Qh(320)){const f=tk.a.instance.o4a();if(f){Aa.a.J(512262803,801,15,"PopSessionManager::HandlePOPSErrors:{0}; SessionExpired fTriggered:{1};",a,f);return}}this.uv.y5d(a,b)||this.cUd(a,b,c)}}Gpb(a,b,c=!1){Aa.a.J(512262802,801,15,"PopSessionManager::CallClosePopSession - PopSessionID: {0}, PodSessionId: {1}, PopSessionInitialized: {2}, LastAttemptedEnsureHostSessionId:{3}, PopSessionForceClosed:{4}",this.Xa.Bk,this.Xa.podSessionId,this.We.hA,this.We.Qca,this.We.hbd);if(this.We.hA||!this.We.hbd){if(this.gUe(c,
""))a(new Lj.a(null)),Aa.a.J(512262801,801,50,"sendBeacon request sent Time:{0}",Date.now());else{const f={};f["X-UsePopsRole"]=u.AFrameworkApplication.fa.ka("UsePopsRole").toString();this.Hda.aFc(this.We.Qca,this.Xa.podSessionId,this.Xa.presentationId.string,u.AFrameworkApplication.fa.appSettings["361"],this.Xa.h$,c,a,b,null,f)}this.We.hA=!1;this.We.hbd=!0;this.kC.oEe(new Jm(this.We.Qca))}}gUe(a,b){if(!r.a.npb())return!1;try{const c=this.L_i(a,b),f=this.MZd();u.AFrameworkApplication.Ge.OIa(f,c);
return!0}catch(c){return Aa.a.J(512262800,801,10,"Failed to send beacon request for ClosePopWacSession"),!1}}L_i(a,b){const c={};c.popSessionID=this.We.Qca;c.podSessionID=b.length?b:this.Xa.podSessionId;c.presentationID=this.Xa.presentationId.string;c.podUrl=u.AFrameworkApplication.fa.appSettings["361"];c.podInstance=this.Xa.h$;c.fTimeoutOrUserClose=a;return Fi.c(c)}MZd(){var a=u.AFrameworkApplication.fa.Ga("368")+u.AFrameworkApplication.fa.Ga("367")+"/ClosePopWacSession";a=new hj.QueryStringBuilder(a);
a.Cz(u.AFrameworkApplication.i_a,u.AFrameworkApplication.userSessionId);a.Cz(u.AFrameworkApplication.bMd,u.AFrameworkApplication.buildVersion);a.Cz("waccluster",this.Xa.fk);a.Cz("WacUserType",u.AFrameworkApplication.userType);a.Cz(u.AFrameworkApplication.Exb,u.AFrameworkApplication.AXc);a.Cz(u.AFrameworkApplication.pV,u.AFrameworkApplication.accessToken);a.Cz(u.AFrameworkApplication.Xaa,u.AFrameworkApplication.Wl.toString());a.Cz("X-UsePopsRole",this.Xa.mya.toString());a.Cz("X-PopsAffinityRoutingEnabled",
this.Xa.eEa.toString());return a=a.toString()}Fnj(a){if(a!==Jf.a.Qh(245))return!1;if(this.We.xBg>this.We.Sja&&this.We.hA)return Aa.a.J(512262799,801,15,"PopSessionManager::HandleFailedToGetPodsLatestBase - Got FailedToGetPodsLatestBase again."),!1;this.We.xBg=new Date;this.WOf(0);return!0}WOf(a){const b=this.Xa.podSessionId;this.Gda.jbj(()=>{if(b!==this.Xa.podSessionId)Aa.a.J(512262798,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",
b,this.Xa.podSessionId);else{var c=Jf.a.Qh(245);this.uv.y5d(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")||this.cUd(c,"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase")}},()=>{b!==this.Xa.podSessionId?Aa.a.J(512262797,801,15,"{0} - Skip. PodSession is changed. Requested:{1}, Current:{2}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",b,this.Xa.podSessionId):this.Gda.H5b?Aa.a.J(512262796,801,15,"{0} - Skip. PODS unhealthy already",
"PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"):a<this.la.kbj?(Aa.a.J(512262795,801,15,"{0} - Retry getting PODS health state. CurrentRetryCount:{1}","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase",a),this.WOf(a+1)):(Aa.a.J(512262794,801,10,"{0} - PODS is unhealthy. Trigger rehydration.","PopSessionManager::CheckPodSessionStateForFailedToGetPodsLatestBase"),this.Md.es(Object.assign(new bg.a,{Code:223,Source:6}),b))})}cUd(a,b,c=null){Aa.a.J(512262793,801,
10,"PopSessionManager::DisplayPOPSErrors:{0}; RequestingFunction:{1};",a,b);const f=Jf.a.SM(a);Jf.a.RS(a)?(a=Object.assign(new bg.a,{Code:Jf.a.SM(a),Source:5,ExtraErrorParam:c}),this.Md.es(a,this.Xa.podSessionId,l=>{l.NB=1;Array.contains(this.BNg,gl.a[f].toUpperCase())||(l.WAa=8);399===f?(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_Unknown):384!==f&&(l.title=ResourceStrings.errorTitle_PowerpointEditingStandard,l.message=ResourceStrings.errorMessage_FailedToEnsurePopSession);
return!1})):(b=0,Array.contains(this.BNg,gl.a[f].toUpperCase())||(b=8),this.Md.gra(a,b,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FailedToEnsurePopSession))}nrk(){this.We.hA||(Aa.a.J(512262792,801,15,"PopSessionManager::OnSuccessfulOutbound - PopSession not initialized. OldPopSessionID:{0}, PresentationID Null?:{1}",this.Xa.Bk,!this.Xa.presentationId.string),this.Mea(5))}jz(a,b){re.a("Pops.CloseSessionDueToReadonly")&&b.zae&&!this.jc.WK&&this.We.hA&&(Aa.a.J(512262791,
801,50,"PopSessionManager::OnUnifiedAppStateChanged - Close Pop session due to readonly"),this.Gpb(()=>{},()=>{}))}}Object(e.a)(wl,"PopSessionManager",null,[1205]);class Bn{get name(){return"PowerPointWebEditor.PodsPops"}Wb(a){a.register(1205,"PowerPointWebEditor.PodsPopsCore.IPopSessionManager").ma().na(()=>new wl(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));a.register(1206,"PowerPointWebEditor.PodsPopsCore.IPodSessionManager").ma().na(()=>
new Rk(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),u.AFrameworkApplication.Ge,a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),()=>u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.ITaskManager"),a.Ka("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.Core.ICoreEventSource"),a.Ka("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier")));a.register(1207,"PowerPointWebEditor.PodsPops.IPopSessionInfoClient").ma().na(()=>
new oh(a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.Ka("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.NotificationManager"),
a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.Ka("Common.App.VisibilityManagement.IVisibilityManager")))}init(){}dispose(){}static main(){m.a.instance.Bc(new Bn)}}Object(e.a)(Bn,"PPTWebEditorPodsPopsPackage",null,[2,3]);class ko{constructor(a,b,c,f,l){this.e9=new Ha.a;this.p8b=this.q8b=null;this.mHg=this.Y8b=0;this.kme=this.jme=!1;this.azb=Re.a.Eea(2,0,!1);this.XVa=Re.a.Eea(2,1,!1);this.b5c=a;this.L9b=c;this.Vk=f;this.Dq=b;this.fNg=l}get Gc(){return this.L9b.Gc}b2g(a,b,c,f){if(!b)return!1;
this.jme||(this.Y8b=Date.now(),this.jme=!0);b=!1;try{if(this.Vk.IIf(c.shapeNode)){this.e9.clear();this.fki();const l=this.R1i(c);if(a){const G=this.Vk.Ofj(this.Vk.iI(c,a),this.CQa(l),this.Gc,this.azb,this.XVa);if(G.top||G.bottom||G.left||G.right)b=!0,this.Vk.Amc(c,G);if(this.fNg){const R=this.Vk.$4i(this.Vk.iI(c,a),l,this.azb,this.XVa,f);if(R.top||R.bottom||R.left||R.right)b=!0,this.Vk.Amc(c,R);const fa=this.Vk.a5i(this.Vk.iI(c,a),l,this.Gc,this.XVa,f,a);if(fa.top||fa.bottom||fa.left||fa.right)b=
!0,this.Vk.Amc(c,fa);const wa=this.Vk.m9i(this.Vk.iI(c,a),l,this.Gc,this.XVa,f,a);if(wa.top||wa.bottom||wa.left||wa.right)b=!0,this.Vk.Amc(c,wa)}}else b=this.Vk.ohl(c,this.Vk.iI(c,a),this.CQa(l),this.Gc,this.azb,this.XVa);this.e9.addRange(this.Vk.Oji(this.Vk.iI(c,a),this.CQa(l),this.Gc));const x=this.Vk.Bpb(this.Vk.iI(c,a),this.CQa(l));if(x.count)this.e9.addRange(x);else if(!b){let G;G=a?this.Vk.nhl(this.Vk.iI(c,!0),this.CQa(l),c):this.Vk.mhl(this.Vk.iI(c,!1),this.CQa(l),c,this.XVa,this.azb);this.e9.addRange(G);
b=!!G&&0<G.count}if(this.fNg)if(a)this.e9.addRange(this.Vk.TMd(this.Vk.iI(c,a),this.Vk.yQa(l),this.Gc,f,a)),this.e9.addRange(this.Vk.h4a(this.Vk.iI(c,a),this.Vk.yQa(l),this.Gc,f,a)),this.e9.addRange(this.Vk.Xji(this.Vk.iI(c,a),this.Vk.yQa(l),f));else{const G=this.Vk.h4a(this.Vk.iI(c,a),this.Vk.yQa(l),this.Gc,f,a);if(G.count)this.e9.addRange(G);else if(!b){const fa=this.Vk.fuh(this.Vk.iI(c,!1),this.CQa(l),c,this.Gc,this.XVa,this.azb);this.e9.addRange(this.Vk.h4a(this.Vk.iI(c,a),this.Vk.yQa(l),this.Gc,
f,a));b=fa}const R=this.Vk.TMd(this.Vk.iI(c,a),this.Vk.yQa(l),this.Gc,f,a);if(R.count)this.e9.addRange(R);else if(!b){const fa=this.Vk.fuh(this.Vk.iI(c,!1),this.CQa(l),c,this.Gc,this.XVa,this.azb);this.e9.addRange(this.Vk.TMd(this.Vk.iI(c,a),this.Vk.yQa(l),this.Gc,f,a));b=fa}}this.b5c.F_f(this.e9.toArray());this.b5c.visible=!0}}catch(l){this.kme||(Aa.a.J(8959958,815,10,"SmartGuide - moving error {0}",l.toString()),this.kme=!0)}return b}f2g(a){a&&(this.b5c.visible=!1,this.p8b=this.q8b=null,this.e9.clear(),
this.b5c.F_f([]),this.mHg=Date.now(),this.kme=this.jme=!1,Aa.a.J(8959960,815,50,"SmartGuide - moving timespan {0}",(this.mHg-this.Y8b).toString()))}fki(){this.Vk.$Xg=this.Dq.Hm(this.Gc.$T.offsetLeft-this.Gc.Oc.scrollLeft);this.Vk.aYg=this.Dq.Hm(this.Gc.$T.offsetTop-this.Gc.Oc.scrollTop)}R1i(a){return this.q8b?this.q8b:this.q8b=this.Vk.Q1i(this.Vk.afj(this.Gc,this.Gc.Ma),a)}CQa(a){return this.p8b?this.p8b:this.p8b=this.Vk.yQa(a)}}Object(e.a)(ko,"SmartGuideManager",null,[1202]);var th=d(131),Sc=d(164),
Of=d(192),zc=d(57),Ni=d(157);class Wd{constructor(){this.vZc=this.TEa=null;this.X_c=0;this.hab=this.Hcb=null;this.y$e=!1}get color(){return this.TEa}set color(a){this.TEa=a}get dashStyle(){return this.vZc}set dashStyle(a){this.vZc=a}get x2b(){return this.X_c}set x2b(a){this.X_c=a}get Kf(){return this.Hcb}set Kf(a){this.Hcb=a}get Cg(){return this.hab}set Cg(a){this.hab=a}get KG(){return this.y$e}set KG(a){this.y$e=a}length(){let a=-1;this.Hcb&&this.hab&&(a=Math.sqrt(Math.pow(this.hab._x-this.Hcb._x,
2)+Math.pow(this.hab._y-this.Hcb._y,2)));return a}reset(){const a=new Wd;this.TEa=a.TEa;this.vZc=a.vZc;this.X_c=a.X_c;this.Hcb=a.Hcb;this.hab=a.hab}}Object(e.a)(Wd,"SmartGuideLine",null,[1327]);class Do{constructor(a,b,c,f){this.distance=a;this.CLd=b;this.rVd=c;this.direction=f}}Object(e.a)(Do,"DistancePair",null,[]);class xl{constructor(a,b){this.shape=a;this.xk=b}}Object(e.a)(xl,"LightSet",null,[]);class Eg{constructor(a,b,c,f){this.begin=a;this.end=b;this.shape=c;this.distance=f}}Object(e.a)(Eg,
"LightSetItem",null,[]);class Eo{constructor(){this.aab={};this.eMg=[]}ga(a){return this.aab[a]}$(a,b){a in this.aab||this.eMg.push(a);return this.aab[a]=b}get keys(){return this.eMg}}Object(e.a)(Eo,"NumberDictionary",null,[]);class Sh{constructor(a,b){this.first=a;this.second=b}}Object(e.a)(Sh,"NumberPair",null,[]);var dk=d(649);class Sk{constructor(a,b){this.rre=[];this.ug=5;this.s3=this.kw=2;this.UN=4;this.UA=3;this.J2c=this.I2c=0;this.Dq=a;this.yBb=b}afj(a,b){a=nb.GraphIterator.mb(a.$a);const c=
[];for(var f=a.Ab(1);f;f=a.vf(1))f=Ni.a(f,b),c.push(f);return c}iI(a,b){for(const c of this.rre)if(c.PF(a))return c.iI(a,b);return null}addHandler(a){this.rre.push(a)}mhl(a,b,c,f,l){f=this.akd(f,Sk.yDc);l=this.akd(l,Sk.yDc);for(var x of f){f=a.copy();f.move(0,0-x);f=this.Bpb(f,b);if(f.count)return this.uJa(c,0,-x),f;f=a.copy();f.move(0,x);f=this.Bpb(f,b);if(f.count)return this.uJa(c,0,x),f}for(let G of l){x=a.copy();x.move(0-G,0);x=this.Bpb(x,b);if(x.count)return this.uJa(c,-1*G,0),x;x=a.copy();x.move(G,
0);x=this.Bpb(x,b);if(x.count)return this.uJa(c,G,0),x}return new Ha.a}akd(a,b){const c=new Ha.a;a/=b;let f=0;for(let l=0;l<b;++l)f+=a,c.add(f);return c}nhl(a,b,c){var f=[];for(const l of f)if(f=a.copy(),f.setOffsets(l),f=this.Bpb(f,b),f.count)return this.Amc(c,l),f;return new Ha.a}yQa(a){const b=[];for(const c of a)b.push(new dk.a(c.Zr()));return b}ohl(a,b,c,f,l,x){const G=new zc.a(Number.MAX_VALUE,Number.MAX_VALUE);let R=Number.MAX_VALUE;var fa=Number.MAX_VALUE;let wa=[];for(const Wa of c)wa.push(Wa);
this.yBb&&(wa=this.J3h(wa,f));for(const Wa of wa)c=this.H9i(b,Wa,R),Math.abs(G.y)>Math.abs(c)&&(G.y=c),R=Math.abs(c),c=this.F9i(b,Wa,fa),Math.abs(G.x)>Math.abs(c)&&(G.x=c),fa=Math.abs(c);fa=this.y4i(b,R,f);Math.abs(G.y)>Math.abs(fa)&&(G.y=fa);fa=this.x4i(b,R,f);Math.abs(G.x)>Math.abs(fa)&&(G.x=fa);Math.abs(G.x)>l&&(G.x=0);Math.abs(G.y)>x&&(G.y=0);return G.x||G.y?(this.uJa(a,G.x,G.y),!0):!1}J3h(a,b){var c=this.Dq.Hm(b.ie.width);b=this.Dq.Hm(b.ie.height);var f=new dk.a(new th.a(new zc.a(0,0),new zc.a(c,
0),new zc.a(c,b),new zc.a(0,b)));a.push(f);f=new dk.a(new th.a(new zc.a(0,0),new zc.a(c,0),new zc.a(c,b/2),new zc.a(0,b/2)));a.push(f);c=new dk.a(new th.a(new zc.a(0,0),new zc.a(c/2,0),new zc.a(c/2,b),new zc.a(0,b)));a.push(c);return a}Amc(a,b){this.CQc(a,c=>{c.setOffsets(a,b)})}uJa(a,b,c){this.CQc(a,f=>{f.setPosition(a,b,c)})}CQc(a,b){for(const c of this.rre)if(c.PF(a)){b(c);break}}Ofj(a,b,c,f,l){let x=Number.MAX_VALUE,G=Number.MAX_VALUE,R=Number.MAX_VALUE,fa=Number.MAX_VALUE;var wa=[];for(var Wa of b)wa.push(Wa.copy());
b=this.Dq.Hm(c.ie.width);c=this.Dq.Hm(c.ie.height);Wa=new dk.a(new th.a(new zc.a(0,0),new zc.a(b,0),new zc.a(b,c),new zc.a(0,c)));wa.push(Wa);this.yBb&&(Wa=new dk.a(new th.a(new zc.a(0,0),new zc.a(b,0),new zc.a(b,c/2),new zc.a(0,c/2))),wa.push(Wa),b=new dk.a(new th.a(new zc.a(0,0),new zc.a(b/2,0),new zc.a(b/2,c),new zc.a(0,c))),wa.push(b));for(const mb of wa)wa=this.Hgd([mb.Ub-a.$b,mb.$b-a.$b,mb.Vf().y-a.$b],l),this.YS(wa,l)&&Math.abs(wa)<Math.abs(x)&&(x=wa),wa=this.Hgd([mb.Ub-a.Ub,mb.$b-a.Ub,mb.Vf().y-
a.Ub],l),this.YS(wa,l)&&Math.abs(wa)<Math.abs(G)&&(G=wa),wa=this.Hgd([mb.Yb-a.Yb,mb.Vb-a.Yb,mb.Vf().x-a.Yb],f),this.YS(wa,f)&&Math.abs(wa)<Math.abs(R)&&(R=wa),wa=this.Hgd([mb.Yb-a.Vb,mb.Vb-a.Vb,mb.Vf().x-a.Vb],f),this.YS(wa,f)&&Math.abs(wa)<Math.abs(fa)&&(fa=wa);a=new Of.a;a.top=x===Number.MAX_VALUE?a.top:x;a.bottom=G===Number.MAX_VALUE?a.bottom:G;a.left=R===Number.MAX_VALUE?a.left:R;a.right=fa===Number.MAX_VALUE?a.right:fa;return a}IIf(a){return a.bta||a.wk||a.Sk||a.Wq||a.Pf}i4i(a,b){return Math.abs(a-
b)}H9i(a,b,c){a=[new Sh(a.$b,b.$b),new Sh(a.$b,b.Ub),new Sh(a.$b,b.Vf().y),new Sh(a.Ub,b.$b),new Sh(a.Ub,b.Ub),new Sh(a.Ub,b.Vf().y),new Sh(a.Vf().y,b.$b),new Sh(a.Vf().y,b.Ub),new Sh(a.Vf().y,b.Vf().y)];return this.cOc(a,c)}F9i(a,b,c){a=[new Sh(a.Yb,b.Yb),new Sh(a.Yb,b.Vb),new Sh(a.Yb,b.Vf().x),new Sh(a.Vb,b.Yb),new Sh(a.Vb,b.Vb),new Sh(a.Vb,b.Vf().x),new Sh(a.Vf().x,b.Yb),new Sh(a.Vf().x,b.Vb),new Sh(a.Vf().x,b.Vf().x)];return this.cOc(a,c)}y4i(a,b,c){c=this.Dq.Hm(c.ie.height);a=[new Sh(a.$b,0),
new Sh(a.$b,c),new Sh(a.Ub,0),new Sh(a.Ub,c),new Sh(a.Vf().y,0),new Sh(a.Vf().y,c)];return this.cOc(a,b)}x4i(a,b,c){c=this.Dq.Hm(c.ie.width);a=[new Sh(a.Yb,0),new Sh(a.Yb,c),new Sh(a.Vb,0),new Sh(a.Vb,c),new Sh(a.Vf().x,0),new Sh(a.Vf().x,c)];return this.cOc(a,b)}cOc(a,b){let c=Number.MAX_VALUE;for(const f of a)a=this.i4i(f.first,f.second),a<b&&(b=a,c=f.second-f.first);return c}YS(a,b){a=Math.abs(a);return.2<a&&a<b}Hgd(a,b){let c=Number.MAX_VALUE;for(const f of a)this.YS(f,b)&&Math.abs(c)>Math.abs(f)&&
(c=f);return c}Q1i(a,b){const c=new Ha.a;for(const f of a)this.IIf(f.shapeNode)&&f.$a!==b.$a&&c.add(f);return c.toArray()}Bpb(a,b){var c=new Ha.a;c.add(a);var f=new Ha.a;f.add(a);var l=new Ha.a;l.add(a);var x=new Ha.a;x.add(a);for(const G of b)G.Ub<a.$b||G.$b>a.Ub||(G.Yb<a.Yb&&this.MAc(c,G,2),G.Vb>a.Vb&&this.MAc(f,G,3)),G.Vb<a.Yb||G.Yb>a.Vb||(G.$b<a.$b&&this.MAc(l,G,0),G.Ub>a.Ub&&this.MAc(x,G,1));a=this.hOc(c,2);f=this.hOc(f,3);b=this.hOc(l,0);c=this.hOc(x,1);x=new Eo;this.NGc(x,a[0]);this.NGc(x,
f[0]);l=new Eo;this.NGc(l,b[0]);this.NGc(l,c[0]);this.FKc(x,a,2);this.FKc(x,f,3);this.FKc(l,b,0);this.FKc(l,c,1);a=new Ha.a;f=new Ha.a;this.EUf(x,a,f);this.EUf(l,a,f);this.nZa(a,1);this.nZa(f,2);a.addRange(f);for(let G of a)this.Bv(G);return a}hOc(a,b){const c=new Ha.a;for(let l=0;l<a.count;++l){var f=new Eg(this.q3i(a,l,b),this.K3i(a,l,b),null,-1);f=new xl(a.ga(l),[f]);for(let x=l+1;x<a.count;++x){const G=f.xk.length;let R=G;for(let fa=0;fa<G;++fa)if(!f.xk[fa].shape&&-1===f.xk[fa].distance&&f.xk[fa].end>
f.xk[fa].begin){const wa=this.j4i(a,l,x,b);R+=this.dDk(a,x,fa,R,l,wa,f,b);R+=this.fDk(a,x,fa,R,l,wa,f,b);R+=this.UDk(a,x,fa,R,l,wa,f,b);R+=this.eDk(a,x,fa,l,wa,f,b)}}c.add(f)}return c.toArray()}EUf(a,b,c){for(const l of a.keys){var f=a.ga(l);if(1<f.count){const x=new Ha.a;for(let G of f){f=!1;for(let R of x)if(this.zbi(G,R)){f=!0;x.remove(R);break}f||x.add(G)}for(let G of x)this.rAi(G,b,c)}}}zbi(a,b){return this.DIf(a.CLd,b.CLd)&&this.DIf(a.rVd,b.rVd)}DIf(a,b){return a.Yb===b.Yb&&a.Vb===b.Vb&&a.$b===
b.$b&&a.Ub===b.Ub}MAc(a,b,c){const f=a.count;for(let l=0;l<f;l++){const x=a.ga(l);if(3===c&&(b.Yb<a.ga(0).Vb?b.Vb:b.Yb)<(x.Yb<a.ga(0).Vb?x.Vb:x.Yb)||2===c&&(b.Vb>a.ga(0).Yb?b.Yb:b.Vb)>(x.Vb>a.ga(0).Yb?x.Yb:x.Vb)||0===c&&(b.Ub>a.ga(0).$b?b.$b:b.Ub)>(x.Ub>a.ga(0).$b?x.$b:x.Ub)||1===c&&(b.$b<a.ga(0).Ub?b.Ub:b.$b)<(x.$b<a.ga(0).Ub?x.Ub:x.$b)){a.insert(l,b);return}}a.add(b)}NGc(a,b){for(const c of b.xk)0<c.distance&&a.$(Math.round(100*c.distance)/100,new Ha.a)}FKc(a,b,c){const f=new Eo;for(const l of b){for(const x of a.keys)f.$(x,
0);for(const x of l.xk)if(0<x.distance&&x.shape)for(const G of a.keys)if(b=G,this.uu(x.distance,b)){const R=f.ga(G);1>R&&(a.ga(G).add(new Do(b,l.shape,x.shape,c)),f.$(G,R+1));break}}}q3i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.max(b.$b,a.$b);case 0:case 1:return Math.max(b.Yb,a.Yb);default:return-1}}K3i(a,b,c){b=a.ga(b);a=a.ga(0);switch(c){case 2:case 3:return Math.min(b.Ub,a.Ub);case 0:case 1:return Math.min(b.Vb,a.Vb);default:return-1}}dDk(a,b,c,f,l,x,G,R){const fa=a.ga(b);
l=a.ga(l);switch(R){case 3:case 2:if(fa.Ub>=G.xk[c].begin&&fa.Ub<=G.xk[c].end&&fa.$b<=G.xk[c].begin)return a=new Eg(G.xk[c].begin,fa.Ub,a.ga(b),3===R?x-l.Vb:l.Yb-x),G.xk[f]=a,G.xk[c].begin=fa.Ub,1;break;case 0:case 1:if(fa.Vb>=G.xk[c].begin&&fa.Vb<=G.xk[c].end&&fa.Yb<=G.xk[c].begin)return a=new Eg(G.xk[c].begin,fa.Vb,a.ga(b),0===R?l.$b-x:x-l.Ub),G.xk[f]=a,G.xk[c].begin=fa.Vb,1}return 0}fDk(a,b,c,f,l,x,G,R){const fa=a.ga(b);l=a.ga(l);switch(R){case 3:case 2:if(fa.$b>=G.xk[c].begin&&fa.$b<=G.xk[c].end&&
fa.Ub>=G.xk[c].end)return a=new Eg(fa.$b,G.xk[c].end,a.ga(b),3===R?x-l.Vb:l.Yb-x),G.xk[f]=a,G.xk[c].end=fa.$b,1;break;case 0:case 1:if(fa.Yb>=G.xk[c].begin&&fa.Yb<=G.xk[c].end&&fa.Vb>=G.xk[c].end)return a=new Eg(fa.Yb,G.xk[c].end,a.ga(b),0===R?l.$b-x:x-l.Ub),G.xk[f]=a,G.xk[c].end=fa.Yb,1}return 0}UDk(a,b,c,f,l,x,G,R){const fa=a.ga(b);l=a.ga(l);switch(R){case 3:case 2:if(fa.$b>G.xk[c].begin&&fa.$b<G.xk[c].end&&fa.Ub>G.xk[c].begin&&fa.Ub<G.xk[c].end)return a=new Eg(fa.$b,fa.Ub,a.ga(b),3===R?x-l.Vb:
l.Yb-x),G.xk[f]=a,a=new Eg(fa.Ub,G.xk[c].end,null,-1),G.xk[++f]=a,G.xk[c].end=fa.$b,2;break;case 0:case 1:if(fa.Yb>G.xk[c].begin&&fa.Yb<G.xk[c].end&&fa.Vb>G.xk[c].begin&&fa.Vb<G.xk[c].end)return a=new Eg(fa.Yb,fa.Vb,a.ga(b),0===R?l.$b-x:x-l.Ub),G.xk[f]=a,a=new Eg(fa.Vb,G.xk[c].end,null,-1),G.xk[++f]=a,G.xk[c].end=fa.Yb,2}return 0}eDk(a,b,c,f,l,x,G){const R=a.ga(b);f=a.ga(f);switch(G){case 3:case 2:R.$b<x.xk[c].begin&&R.Ub>x.xk[c].end&&(x.xk[c].shape=a.ga(b),x.xk[c].distance=3===G?l-f.Vb:f.Yb-l);break;
case 0:case 1:R.Yb<x.xk[c].begin&&R.Vb>x.xk[c].end&&(x.xk[c].shape=a.ga(b),x.xk[c].distance=0===G?f.$b-l:l-f.Ub)}return 0}j4i(a,b,c,f){let l=-1;c=a.ga(c);a=a.ga(b);switch(f){case 3:c.Yb<a.Vb&&c.Vb>=a.Vb&&(l=c.Vb);c.Yb>=a.Vb&&(l=c.Yb);break;case 2:c.Vb>a.Yb&&c.Yb<=a.Yb&&(l=c.Yb);c.Vb<=a.Yb&&(l=c.Vb);break;case 0:c.Ub>a.$b&&c.$b<=a.$b&&(l=c.$b);c.Ub<=a.$b&&(l=c.Ub);break;case 1:c.$b<a.Ub&&c.Ub>=a.Ub&&(l=c.Ub),c.$b>=a.Ub&&(l=c.$b)}return l}rAi(a,b,c){const f=a.CLd;var l=a.rVd;switch(a.direction){case 3:var x=
Math.max(f.Ub,l.Ub),G=new Wd;G.Kf=new zc.a(f.Vb-this.UA,f.$b);G.Cg=new zc.a(f.Vb-this.UA,x+this.ug);b.add(G);G=new Wd;G.Kf=new zc.a(f.Vb+a.distance-this.UA,l.$b);G.Cg=new zc.a(f.Vb+a.distance-this.UA,x+this.ug);b.add(G);b=new Wd;b.Kf=new zc.a(f.Vb-this.UA,x+this.ug);b.Cg=new zc.a(f.Vb+a.distance-this.UA,x+this.ug);c.add(b);break;case 2:x=Math.max(f.Ub,l.Ub);G=new Wd;G.Kf=new zc.a(f.Yb-a.distance-this.UA,l.$b);G.Cg=new zc.a(f.Yb-a.distance-this.UA,x+this.ug);b.add(G);l=new Wd;l.Kf=new zc.a(f.Yb-this.UA,
f.$b);l.Cg=new zc.a(f.Yb-this.UA,x+this.ug);b.add(l);b=new Wd;b.Kf=new zc.a(f.Yb-a.distance-this.UA,x+this.ug);b.Cg=new zc.a(f.Yb-this.UA,x+this.ug);c.add(b);break;case 0:x=Math.max(f.Vb,l.Vb);G=new Wd;G.Kf=new zc.a(f.Yb,f.$b-this.kw);G.Cg=new zc.a(x+this.ug,f.$b-this.kw);b.add(G);G=new Wd;G.Kf=new zc.a(l.Yb,f.$b-a.distance-this.kw);G.Cg=new zc.a(x+this.ug,f.$b-a.distance-this.kw);b.add(G);b=new Wd;b.Kf=new zc.a(x+this.ug,f.$b-this.kw);b.Cg=new zc.a(x+this.ug,f.$b-a.distance-this.kw);c.add(b);break;
case 1:x=Math.max(f.Vb,l.Vb),G=new Wd,G.Kf=new zc.a(f.Yb,f.Ub-this.kw),G.Cg=new zc.a(x+this.ug,f.Ub-this.kw),b.add(G),G=new Wd,G.Kf=new zc.a(l.Yb,f.Ub+a.distance-this.kw),G.Cg=new zc.a(x+this.ug,f.Ub+a.distance-this.kw),b.add(G),b=new Wd,b.Kf=new zc.a(x+this.ug,f.Ub-this.kw),b.Cg=new zc.a(x+this.ug,f.Ub+a.distance-this.kw),c.add(b)}}Xji(a,b,c){const f=new Ha.a;if(!c)return f;let l=!1;var x=!1;const G=c.equals(Sc.a.west)||c.equals(Sc.a.Bu)||c.equals(Sc.a.sH),R=c.equals(Sc.a.east)||c.equals(Sc.a.gE)||
c.equals(Sc.a.uE),fa=c.equals(Sc.a.north)||c.equals(Sc.a.Bu)||c.equals(Sc.a.gE);c=c.equals(Sc.a.south)||c.equals(Sc.a.sH)||c.equals(Sc.a.uE);for(const Wa of b){if(this.nzg(a,Wa,!0,b)&&(G||R)){l=!0;var wa=new Wd;wa.Kf=new zc.a(Wa.Yb,Wa.Vf()._y);wa.Cg=new zc.a(Wa.Vb-this.UA,Wa.Vf()._y);wa.KG=!0;f.add(this.Bv(wa))}this.nzg(a,Wa,!1,b)&&(fa||c)&&(x=!0,wa=new Wd,wa.Kf=new zc.a(Wa.Vf()._x,Wa.$b),wa.Cg=new zc.a(Wa.Vf()._x,Wa.Ub-this.s3),wa.KG=!1,f.add(this.Bv(wa)))}l&&(b=new Wd,b.Kf=new zc.a(a.Yb,a.Vf()._y),
b.Cg=new zc.a(a.Vb-this.UA,a.Vf()._y),b.KG=!0,f.add(this.Bv(b)));x&&(x=new Wd,x.Kf=new zc.a(a.Vf()._x,a.$b),x.Cg=new zc.a(a.Vf()._x,a.Ub-this.s3),x.KG=!1,f.add(this.Bv(x)));this.nZa(f,2);return f}F4(a,b,c){var f=this.vca(a,b,!1),l=this.vca(a,b,!0);if(!f&&!l)return!1;let x=[];if(f){if(a.Vb<=b.Yb||a.Vb<=b.Vb){var G;var R=b.$b>a.$b?b.$b:a.$b;var fa=b.Ub<a.Ub?b.Ub:a.Ub;f=G=b.Yb;a.Vb>b.Yb&&(f=G=b.Vb);f=new dk.a(new th.a(new zc.a(f,R),new zc.a(G,R),new zc.a(G,fa),new zc.a(f,fa)));Array.add(x,f)}if(a.Yb>=
b.Vb||a.Yb>=b.Yb)R=b.$b>a.$b?b.$b:a.$b,fa=b.Ub<a.Ub?b.Ub:a.Ub,f=G=b.Vb,a.Yb<b.Vb&&(f=G=b.Yb),f=new dk.a(new th.a(new zc.a(f,R),new zc.a(G,R),new zc.a(G,fa),new zc.a(f,fa))),Array.add(x,f)}if(l){if(a.Ub<=b.$b||a.Ub<=b.Ub)l=b.Yb>a.Yb?b.Yb:a.Yb,R=b.Vb<a.Vb?b.Vb:a.Vb,f=G=b.$b,a.Ub>b.$b&&(f=G=b.Ub),l=new dk.a(new th.a(new zc.a(l,f),new zc.a(R,f),new zc.a(R,G),new zc.a(l,G))),Array.add(x,l);if(a.$b>=b.Ub||a.$b>=b.$b)l=b.Yb>a.Yb?b.Yb:a.Yb,R=b.Vb<a.Vb?b.Vb:a.Vb,f=G=b.Ub,a.$b<b.Ub&&(f=G=b.$b),l=new dk.a(new th.a(new zc.a(l,
f),new zc.a(R,f),new zc.a(R,G),new zc.a(l,G))),Array.add(x,l)}for(const wa of c)this.Hlg(wa,a)||this.Hlg(wa,b)||(x=this.gxl(a,wa,x));return 0<x.length?!0:!1}gxl(a,b,c){let f=[];for(const l of c)c=!0,l.Yb===l.Vb?(this.vca(l,b,!1)||(c=!1),a.Vb<=l.Yb&&b.Vb<=a.Vb&&(c=!1),a.Vb<=l.Yb&&b.Yb>=l.Vb&&(c=!1),a.Yb>=l.Vb&&b.Yb>=a.Yb&&(c=!1),a.Yb>=l.Vb&&b.Vb<=l.Yb&&(c=!1),c?b.$b<=l.$b&&b.Ub<l.Ub?f=this.IKb(f,!0,!0,!1,l,b):b.Ub>=l.Ub&&b.$b>l.$b?f=this.IKb(f,!0,!1,!1,l,b):b.$b>l.$b&&b.Ub<l.Ub&&(f=this.IKb(f,!0,!1,
!0,l,b)):Array.add(f,l)):l.$b===l.Ub&&(this.vca(l,b,!0)||(c=!1),a.Ub<=l.$b&&b.Ub<=a.Ub&&(c=!1),a.Ub<=l.$b&&b.$b>=l.Ub&&(c=!1),a.$b>=l.Ub&&b.$b>=a.$b&&(c=!1),a.$b>=l.Ub&&b.Ub<=l.$b&&(c=!1),c?b.Yb<=l.Yb&&b.Vb<l.Vb?f=this.IKb(f,!1,!0,!1,l,b):b.Vb>=l.Vb&&b.Yb>l.Yb?f=this.IKb(f,!1,!1,!1,l,b):b.Yb>l.Yb&&b.Vb<l.Vb&&(f=this.IKb(f,!1,!1,!0,l,b)):Array.add(f,l));return f}IKb(a,b,c,f,l,x){let G,R,fa,wa,Wa,mb,Kb;if(c)b?(c=R=l.Yb,G=x.Ub,fa=l.Ub):(G=fa=l.$b,c=x.Vb,R=l.Vb);else if(c||f){if(b?(c=R=wa=mb=l.Yb,G=l.$b,
fa=x.$b,Wa=x.Ub,Kb=l.Ub):(G=fa=Wa=Kb=l.$b,c=l.Yb,R=x.Yb,wa=x.Vb,mb=l.Vb),f&&b&&!this.uu(Wa,Kb)||f&&!b&&!this.uu(wa,mb))f=new dk.a(new th.a(new zc.a(wa,Wa),new zc.a(mb,Wa),new zc.a(mb,Kb),new zc.a(wa,Kb))),Array.add(a,f)}else b?(c=R=l.Yb,G=l.$b,fa=x.$b):(G=fa=l.$b,c=l.Yb,R=x.Yb);if(b&&!this.uu(G,fa)||!b&&!this.uu(c,R))b=new dk.a(new th.a(new zc.a(c,G),new zc.a(R,G),new zc.a(R,fa),new zc.a(c,fa))),Array.add(a,b);return a}Hlg(a,b){return a.Vb!==b.Vb||a.Yb!==b.Yb||a.$b!==b.$b||a.Ub!==b.Ub?!1:!0}nzg(a,
b,c,f){if(c)return c=this.uu(a.Yb,b.Yb)&&this.uu(a.Vb,b.Vb),this.uu(a.Vb-a.Yb,b.Vb-b.Yb)&&!c&&this.F4(a,b,f);c=this.uu(a.$b,b.$b)&&this.uu(a.Ub,b.Ub);return this.uu(a.Ub-a.$b,b.Ub-b.$b)&&!c&&this.F4(a,b,f)}$4i(a,b,c,f,l){const x=new Of.a;if(!l)return x;let G=Number.MAX_VALUE,R=Number.MAX_VALUE,fa=Number.MAX_VALUE,wa=Number.MAX_VALUE;const Wa=l.equals(Sc.a.west)||l.equals(Sc.a.Bu)||l.equals(Sc.a.sH),mb=l.equals(Sc.a.east)||l.equals(Sc.a.gE)||l.equals(Sc.a.uE),Kb=l.equals(Sc.a.north)||l.equals(Sc.a.Bu)||
l.equals(Sc.a.gE);l=l.equals(Sc.a.south)||l.equals(Sc.a.sH)||l.equals(Sc.a.uE);const nc=[];for(const oc of b)nc.push(new dk.a(oc.Zr()));for(const oc of nc)b=oc.Ub-oc.$b-(a.Ub-a.$b),this.YS(b,f)&&Math.abs(b)<Math.abs(G)&&this.F4(a,oc,nc)&&Kb&&(G=-1*b),this.YS(b,f)&&Math.abs(b)<Math.abs(R)&&this.F4(a,oc,nc)&&l&&(R=b),b=oc.Vb-oc.Yb-(a.Vb-a.Yb),this.YS(b,c)&&Math.abs(b)<Math.abs(fa)&&this.F4(a,oc,nc)&&Wa&&(fa=-1*b),this.YS(b,c)&&Math.abs(b)<Math.abs(wa)&&this.F4(a,oc,nc)&&mb&&(wa=b);x.top=G===Number.MAX_VALUE?
x.top:G;x.bottom=R===Number.MAX_VALUE?x.bottom:R;x.left=fa===Number.MAX_VALUE?x.left:fa;x.right=wa===Number.MAX_VALUE?x.right:wa;return x}a5i(a,b,c,f,l,x){let G=Number.MAX_VALUE,R=Number.MAX_VALUE,fa=Number.MAX_VALUE,wa=Number.MAX_VALUE,Wa=!0,mb=!0,Kb=!0,nc=!0;x&&l&&(Wa=l.equals(Sc.a.west)||l.equals(Sc.a.Bu)||l.equals(Sc.a.sH),mb=l.equals(Sc.a.east)||l.equals(Sc.a.gE)||l.equals(Sc.a.uE),Kb=l.equals(Sc.a.north)||l.equals(Sc.a.Bu)||l.equals(Sc.a.gE),nc=l.equals(Sc.a.south)||l.equals(Sc.a.sH)||l.equals(Sc.a.uE));
l=[];for(var oc of b)l.push(new dk.a(oc.Zr()));b=this.Dq.Hm(c.ie.width);c=this.Dq.Hm(c.ie.height);for(const Ic of l)Ic.Yb>b/2&&Ic.Yb<3*b/4&&a.Vb<b/2&&mb&&(oc=b/2-a.Vb-(Ic.Yb-b/2),this.YS(oc,f)&&Math.abs(oc)<Math.abs(wa)&&this.F4(a,Ic,l)&&(wa=oc)),Ic.Vb<b/2&&Ic.Vb>b/4&&a.Yb>b/2&&Wa&&(oc=b/2-Ic.Vb-(a.Yb-b/2),this.YS(oc,f)&&Math.abs(oc)<Math.abs(fa)&&this.F4(a,Ic,l)&&(fa=oc)),Ic.$b>c/2&&Ic.$b<3*c/4&&a.Ub<c/2&&nc&&(oc=c/2-a.Ub-(Ic.$b-c/2),this.YS(oc,f)&&Math.abs(oc)<Math.abs(R)&&this.F4(a,Ic,l)&&(R=oc)),
Ic.Ub<c/2&&Ic.Ub>c/4&&a.$b>c/2&&Kb&&(oc=c/2-Ic.Ub-(a.$b-c/2),this.YS(oc,f)&&Math.abs(oc)<Math.abs(G)&&this.F4(a,Ic,l)&&(G=oc));a=new Of.a;a.top=G===Number.MAX_VALUE?a.top:G;a.bottom=R===Number.MAX_VALUE?a.bottom:R;a.left=fa===Number.MAX_VALUE?a.left:fa;a.right=wa===Number.MAX_VALUE?a.right:wa;return a}fuh(a,b,c,f,l,x){l=this.akd(l,Sk.yDc);x=this.akd(x,Sk.yDc);for(var G of l){l=a.copy();l.move(0,0-G);if(this.h4a(l,b,f,null,!1).count)return this.uJa(c,0,-G),!0;l=a.copy();l.move(0,G);if(this.h4a(l,b,
f,null,!1).count)return this.uJa(c,0,G),!0}for(let R of x){G=a.copy();G.move(0-R,0);if(this.h4a(G,b,f,null,!1).count)return this.uJa(c,-1*R,0),!0;G=a.copy();G.move(R,0);if(this.h4a(G,b,f,null,!1).count)return this.uJa(c,R,0),!0}return!1}vca(a,b,c){return c?a.Yb>=b.Yb&&a.Yb<=b.Vb||a.Vb>=b.Yb&&a.Vb<=b.Vb||b.Yb>=a.Yb&&b.Yb<=a.Vb||b.Vb>=a.Yb&&b.Vb<=a.Vb:a.$b>=b.$b&&a.$b<=b.Ub||a.Ub>=b.$b&&a.Ub<=b.Ub||b.$b>=a.$b&&b.$b<=a.Ub||b.Ub>=a.$b&&b.Ub<=a.Ub}TMd(a,b,c,f,l){const x=new Ha.a,G=new Ha.a,R=new Ha.a;
let fa=!1,wa=!1,Wa=!1,mb=!1,Kb=!0,nc=!0,oc=!0,Ic=!0;l&&f&&(Kb=f.equals(Sc.a.west)||f.equals(Sc.a.Bu)||f.equals(Sc.a.sH),nc=f.equals(Sc.a.east)||f.equals(Sc.a.gE)||f.equals(Sc.a.uE),oc=f.equals(Sc.a.north)||f.equals(Sc.a.Bu)||f.equals(Sc.a.gE),Ic=f.equals(Sc.a.south)||f.equals(Sc.a.sH)||f.equals(Sc.a.uE));f=this.Dq.Hm(c.ie.width);c=this.Dq.Hm(c.ie.height);l=new Wd;l.Kf=new zc.a(f/2-this.UN,0-this.kw);l.Cg=new zc.a(f/2-this.UN,c-this.kw);const Kc=new Wd;Kc.Kf=new zc.a(0-this.UN,c/2-this.kw);Kc.Cg=new zc.a(f-
this.UN,c/2-this.kw);Kc.KG=!0;for(const Hc of b)Hc.Yb>f/2&&Hc.Yb<3*f/4&&a.Vb<f/2&&this.F4(a,Hc,b)&&nc&&this.uu(f/2-a.Vb,Hc.Yb-f/2)&&(fa=!0,0>Hc.$b&&(l.Kf=new zc.a(f/2,Hc.$b)),Hc.Ub>c&&(l.Cg=new zc.a(f/2,Hc.Ub+this.ug)),x.add(this.CNa(Hc,!1,!1)),G.add(this.zNa(Hc,!1,!1,f,c))),Hc.Vb<f/2&&Hc.Vb>f/4&&a.Yb>f/2&&this.F4(a,Hc,b)&&Kb&&this.uu(a.Yb-f/2,f/2-Hc.Vb)&&(wa=!0,0>Hc.$b&&(l.Kf=new zc.a(f/2,Hc.$b)),Hc.Ub>c&&(l.Cg=new zc.a(f/2,Hc.Ub+this.ug)),x.add(this.CNa(Hc,!1,!0)),G.add(this.zNa(Hc,!1,!0,f,c))),
Hc.$b>c/2&&Hc.$b<3*c/4&&a.Ub<c/2&&this.F4(a,Hc,b)&&Ic&&this.uu(c/2-a.Ub,Hc.$b-c/2)&&(Wa=!0,0>Hc.Yb&&(Kc.Kf=new zc.a(Hc.Yb,c/2)),Hc.Vb>f&&(Kc.Cg=new zc.a(Hc.Vb+this.ug,c/2)),x.add(this.CNa(Hc,!0,!1)),G.add(this.zNa(Hc,!0,!1,f,c))),Hc.Ub<c/2&&Hc.Ub>c/4&&a.$b>c/2&&this.F4(a,Hc,b)&&oc&&this.uu(a.$b-c/2,c/2-Hc.Ub)&&(mb=!0,0>Hc.Yb&&(Kc.Kf=new zc.a(Hc.Yb,c/2)),Hc.Vb>f&&(Kc.Cg=new zc.a(Hc.Vb+this.ug,c/2)),x.add(this.CNa(Hc,!0,!0)),G.add(this.zNa(Hc,!0,!0,f,c)));(fa||wa)&&x.add(this.Bv(l));(Wa||mb)&&x.add(this.Bv(Kc));
Wa&&(a.Yb<Kc.Kf._x&&(Kc.Kf=new zc.a(a.Yb,c/2)),a.Vb>Kc.Cg._x&&(Kc.Cg=new zc.a(a.Vb,c/2+this.ug)),x.add(this.CNa(a,!0,!0)),G.add(this.zNa(a,!0,!0,f,c)));mb&&(a.Yb<Kc.Kf._x&&(Kc.Kf=new zc.a(a.Yb,c/2)),a.Vb>Kc.Cg._x&&(Kc.Cg=new zc.a(a.Vb,c/2+this.ug)),x.add(this.CNa(a,!0,!1)),G.add(this.zNa(a,!0,!1,f,c)));fa&&(a.$b<l.Kf._y&&(l.Kf=new zc.a(f/2,a.$b)),a.Ub>l.Cg._y&&(l.Cg=new zc.a(f/2,a.Ub+this.ug)),x.add(this.CNa(a,!1,!0)),G.add(this.zNa(a,!1,!0,f,c)));wa&&(a.$b<l.Kf._y&&(l.Kf=new zc.a(f/2,a.$b)),a.Ub>
l.Cg._y&&(l.Cg=new zc.a(f/2,a.Ub+this.ug)),x.add(this.CNa(a,!1,!1)),G.add(this.zNa(a,!1,!1,f,c)));this.nZa(x,1);this.nZa(G,2);for(let Hc of x)R.add(Hc);for(let Hc of G)R.add(Hc);return R}CNa(a,b,c){const f=b&&c,l=b&&!c,x=!b&&!c;return!b&&c?(b=new Wd,b.Kf=new zc.a(a.Vb-this.UA,a.Ub),b.Cg=new zc.a(a.Vb-this.UA,a.Ub+this.ug),this.Bv(b)):x?(b=new Wd,b.Kf=new zc.a(a.Yb-this.UN,a.Ub),b.Cg=new zc.a(a.Yb-this.UN,a.Ub+this.ug),this.Bv(b)):f?(b=new Wd,b.Kf=new zc.a(a.Vb,a.Ub-this.s3),b.Cg=new zc.a(a.Vb+this.ug,
a.Ub-this.s3),this.Bv(b)):l?(b=new Wd,b.Kf=new zc.a(a.Vb,a.$b-this.kw),b.Cg=new zc.a(a.Vb+this.ug,a.$b-this.kw),this.Bv(b)):null}zNa(a,b,c,f,l){const x=b&&c,G=b&&!c,R=!b&&!c;return!b&&c?(l=new Wd,l.KG=!0,l.Kf=new zc.a(f/2-this.UN,a.Ub+this.ug),l.Cg=new zc.a(a.Vb-this.UA,a.Ub+this.ug),this.Bv(l)):R?(l=new Wd,l.KG=!0,l.Kf=new zc.a(f/2-this.UN,a.Ub+this.ug),l.Cg=new zc.a(a.Yb-this.UN,a.Ub+this.ug),this.Bv(l)):x?(f=new Wd,f.KG=!0,f.Kf=new zc.a(a.Vb+this.ug,l/2-this.kw),f.Cg=new zc.a(a.Vb+this.ug,a.Ub-
this.s3),this.Bv(f)):G?(f=new Wd,f.KG=!0,f.Kf=new zc.a(a.Vb+this.ug,l/2-this.kw),f.Cg=new zc.a(a.Vb+this.ug,a.$b-this.kw),this.Bv(f)):null}m9i(a,b,c,f,l,x){let G=Number.MAX_VALUE,R=Number.MAX_VALUE,fa=Number.MAX_VALUE,wa=Number.MAX_VALUE,Wa=!0,mb=!0,Kb=!0,nc=!0;x&&l&&(Wa=l.equals(Sc.a.west)||l.equals(Sc.a.Bu)||l.equals(Sc.a.sH),mb=l.equals(Sc.a.east)||l.equals(Sc.a.gE)||l.equals(Sc.a.uE),Kb=l.equals(Sc.a.north)||l.equals(Sc.a.Bu)||l.equals(Sc.a.gE),nc=l.equals(Sc.a.south)||l.equals(Sc.a.sH)||l.equals(Sc.a.uE));
l=[];for(const oc of b)l.push(new dk.a(oc.Zr()));b=this.Dq.Hm(c.ie.width);c=this.Dq.Hm(c.ie.height);for(const oc of l)oc.Vb>3*b/4&&oc.Vb<b&&a.Yb<b/4&&0<a.Yb&&this.vca(a,oc,!1)&&Wa&&(l=b-oc.Vb-a.Yb,this.YS(l,f)&&Math.abs(l)<Math.abs(fa)&&(fa=l)),oc.Yb<b/4&&0<oc.Yb&&a.Vb>3*b/4&&a.Vb<b&&this.vca(a,oc,!1)&&mb&&(l=b-a.Vb-oc.Yb,this.YS(l,f)&&Math.abs(l)<Math.abs(wa)&&(wa=l)),oc.Ub>3*c/4&&oc.Ub<c&&a.$b<c/4&&0<a.$b&&this.vca(a,oc,!0)&&Kb&&(l=c-oc.Ub-a.$b,this.YS(l,f)&&Math.abs(l)<Math.abs(G)&&(G=l)),oc.$b<
c/4&&0<oc.$b&&a.Ub>3*c/4&&a.Ub<c&&this.vca(a,oc,!0)&&nc&&(l=c-a.Ub-oc.$b,this.YS(l,f)&&Math.abs(l)<Math.abs(R)&&(R=l));a=new Of.a;a.top=G===Number.MAX_VALUE?a.top:G;a.bottom=R===Number.MAX_VALUE?a.bottom:R;a.left=fa===Number.MAX_VALUE?a.left:fa;a.right=wa===Number.MAX_VALUE?a.right:wa;return a}h4a(a,b,c,f,l){const x=new Ha.a,G=new Ha.a,R=new Ha.a;var fa=!1,wa=!1,Wa=!1,mb=!1,Kb=!0;let nc=!0,oc=!0,Ic=!0;l&&f&&(Kb=f.equals(Sc.a.west)||f.equals(Sc.a.Bu)||f.equals(Sc.a.sH),nc=f.equals(Sc.a.east)||f.equals(Sc.a.gE)||
f.equals(Sc.a.uE),oc=f.equals(Sc.a.north)||f.equals(Sc.a.Bu)||f.equals(Sc.a.gE),Ic=f.equals(Sc.a.south)||f.equals(Sc.a.sH)||f.equals(Sc.a.uE));f=this.Dq.Hm(c.ie.width);c=this.Dq.Hm(c.ie.height);for(const Kc of b)Kc.Vb>3*f/4&&Kc.Vb<f&&a.Yb<f/4&&0<a.Yb&&this.vca(a,Kc,!1)&&Kb&&this.uu(a.Yb,f-Kc.Vb)&&(fa=!0,b=new Wd,b.Kf=new zc.a(Kc.Vb-this.UA,Kc.Ub),b.Cg=new zc.a(Kc.Vb-this.UA,Kc.Ub+this.ug),x.add(this.Bv(b)),b=new Wd,b.KG=!0,b.Kf=new zc.a(f-this.UA,Kc.Ub+this.ug),b.Cg=new zc.a(Kc.Vb-this.UA,Kc.Ub+this.ug),
G.add(this.Bv(b))),Kc.Yb<f/4&&0<Kc.Yb&&a.Vb>3*f/4&&a.Yb<f&&this.vca(a,Kc,!1)&&nc&&this.uu(f-a.Vb,Kc.Yb)&&(wa=!0,b=new Wd,b.Kf=new zc.a(Kc.Yb-this.UN,Kc.Ub),b.Cg=new zc.a(Kc.Yb-this.UN,Kc.Ub+this.ug),x.add(this.Bv(b)),b=new Wd,b.KG=!0,b.Kf=new zc.a(0-this.UN,Kc.Ub+this.ug),b.Cg=new zc.a(Kc.Yb-this.UN,Kc.Ub+this.ug),G.add(this.Bv(b))),Kc.Ub>3*c/4&&Kc.Ub<c&&a.$b<c/4&&0<a.$b&&this.vca(a,Kc,!0)&&oc&&this.uu(a.$b,c-Kc.Ub)&&(Wa=!0,b=new Wd,b.Kf=new zc.a(Kc.Vb,Kc.Ub-this.s3),b.Cg=new zc.a(Kc.Vb+this.ug,Kc.Ub-
this.s3),x.add(this.Bv(b)),l=new Wd,b.KG=!0,l.Kf=new zc.a(Kc.Vb+this.ug,Kc.Ub-this.s3),l.Cg=new zc.a(Kc.Vb+this.ug,c-this.s3),G.add(this.Bv(l))),Kc.$b<c/4&&0<Kc.$b&&a.Ub>3*c/4&&a.Ub<c&&this.vca(a,Kc,!0)&&Ic&&this.uu(c-a.Ub,Kc.$b)&&(mb=!0,b=new Wd,b.Kf=new zc.a(Kc.Vb,Kc.$b-this.kw),b.Cg=new zc.a(Kc.Vb+this.ug,Kc.$b-this.kw),x.add(this.Bv(b)),l=new Wd,b.KG=!0,l.Kf=new zc.a(Kc.Vb+this.ug,0-this.kw),l.Cg=new zc.a(Kc.Vb+this.ug,Kc.$b-this.kw),G.add(this.Bv(l)));Wa&&(Wa=new Wd,Wa.Kf=new zc.a(a.Vb,a.$b-
this.kw),Wa.Cg=new zc.a(a.Vb+this.ug,a.$b-this.kw),x.add(this.Bv(Wa)),Kb=new Wd,Wa.KG=!0,Kb.Kf=new zc.a(a.Vb+this.ug,0-this.kw),Kb.Cg=new zc.a(a.Vb+this.ug,a.$b-this.kw),G.add(this.Bv(Kb)));mb&&(mb=new Wd,mb.Kf=new zc.a(a.Vb,a.Ub-this.s3),mb.Cg=new zc.a(a.Vb+this.ug,a.Ub-this.s3),x.add(this.Bv(mb)),Wa=new Wd,mb.KG=!0,Wa.Kf=new zc.a(a.Vb+this.ug,c-this.s3),Wa.Cg=new zc.a(a.Vb+this.ug,a.Ub-this.s3),G.add(this.Bv(Wa)));fa&&(fa=new Wd,fa.Kf=new zc.a(a.Yb-this.UN,a.Ub),fa.Cg=new zc.a(a.Yb-this.UN,a.Ub+
this.ug),x.add(this.Bv(fa)),fa=new Wd,fa.KG=!0,fa.Kf=new zc.a(0-this.UN,a.Ub+this.ug),fa.Cg=new zc.a(a.Yb-this.UN,a.Ub+this.ug),G.add(this.Bv(fa)));wa&&(wa=new Wd,wa.Kf=new zc.a(a.Vb-this.UA,a.Ub),wa.Cg=new zc.a(a.Vb-this.UA,a.Ub+this.ug),x.add(this.Bv(wa)),wa=new Wd,wa.KG=!0,wa.Kf=new zc.a(f-this.UA,a.Ub+this.ug),wa.Cg=new zc.a(a.Vb-this.UA,a.Ub+this.ug),G.add(this.Bv(wa)));this.nZa(x,1);this.nZa(G,2);for(let Kc of x)R.add(Kc);for(let Kc of G)R.add(Kc);return R}Oji(a,b,c){var f=new Wd;const l=new Wd,
x=new Wd,G=new Wd,R=new Wd,fa=new Wd,wa=new Ha.a;wa.add(f);wa.add(l);wa.add(x);wa.add(G);wa.add(R);wa.add(fa);this.nZa(wa,0);this.dBj(f,l,x,G,R,fa,a);for(const Wa of b)this.w2(a.$b,Wa.$b,Wa.Ub,f,Wa),this.w2(a.Ub,Wa.$b,Wa.Ub,l,Wa),this.w2(a.Yb,Wa.Yb,Wa.Vb,x,Wa),this.w2(a.Vb,Wa.Yb,Wa.Vb,G,Wa),this.yBb&&(this.w2(a.$b,Wa.Vf()._y,null,f,Wa),this.w2(a.Ub,Wa.Vf()._y,null,l,Wa),this.w2(a.Yb,Wa.Vf()._x,null,x,Wa),this.w2(a.Vb,Wa.Vf()._x,null,G,Wa),this.w2(a.Vf()._y,Wa.$b,null,R,Wa),this.w2(a.Vf()._y,Wa.Ub,
null,R,Wa),this.w2(a.Vf()._x,Wa.Yb,null,fa,Wa),this.w2(a.Vf()._x,Wa.Vb,null,fa,Wa)),this.w2(a.Vf()._y,Wa.Vf()._y,null,R,Wa),this.w2(a.Vf()._x,Wa.Vf()._x,null,fa,Wa);0<f.length()&&0<l.length()&&(this.yBb?(R.Kf=new zc.a(a.Yb-this.ug,a.Vf()._y),R.Cg=R.Kf.copy()):R.reset());0<x.length()&&0<G.length()&&(this.yBb?(fa.Kf=new zc.a(a.Vf()._x,a.Yb-this.UN),fa.Cg=fa.Kf.copy()):fa.reset());if(this.yBb&&c){b=this.Dq.Hm(c.ie.width);c=this.Dq.Hm(c.ie.height);if(this.uu(a.$b,c/2)||Math.abs(a.$b)<=Sk.c4a||this.uu(a.$b,
c))f.Kf._x=Math.min(f.Kf._x,-1*this.ug),f.Cg._x=Math.max(f.Cg._x,b+this.ug);if(this.uu(a.Ub,c/2)||Math.abs(a.Ub)<=Sk.c4a||this.uu(a.Ub,c))l.Kf._x=Math.min(l.Kf._x,-1*this.ug),l.Cg._x=Math.max(l.Cg._x,b+this.ug);if(this.uu(a.Vf()._y,c/2)||Math.abs(a.Vf()._y)<=Sk.c4a||this.uu(a.Vf()._y,c))R.Kf._x=Math.min(R.Kf._x,-1*this.ug),R.Cg._x=Math.max(R.Cg._x,b+this.ug);if(this.uu(a.Vb,b/2)||Math.abs(a.Vb)<=Sk.c4a||this.uu(a.Vb,b))G.Kf._y=Math.min(G.Kf._y,-1*this.ug),G.Cg._y=Math.max(G.Cg._y,c+this.ug);if(this.uu(a.Yb,
b/2)||Math.abs(a.Yb)<=Sk.c4a||this.uu(a.Yb,b))x.Kf._y=Math.min(x.Kf._y,-1*this.ug),x.Cg._y=Math.max(x.Cg._y,c+this.ug);if(this.uu(a.Vf()._x,b/2)||Math.abs(a.Vf()._x)<=Sk.c4a||this.uu(a.Vf()._x,b))fa.Kf._y=Math.min(fa.Kf._y,-1*this.ug),fa.Cg._y=Math.max(fa.Cg._y,c+this.ug)}f=new Ha.a;for(let Wa of wa)Wa.Kf&&0<Wa.length()&&(this.k3f(Wa,a),f.add(this.Bv(Wa)));return f}w2(a,b,c,f,l){(this.uu(a,b)||this.uu(a,c))&&this.k3f(f,l)}k3f(a,b){a.KG?(a.Kf._x=Math.min(a.Kf._x,b.Yb-this.ug),a.Cg._x=Math.max(a.Cg._x,
b.Vb+this.ug)):(a.Kf._y=Math.min(a.Kf._y,b.$b-this.ug),a.Cg._y=Math.max(a.Cg._y,b.Ub+this.ug))}Bv(a){let b;(b=a.Kf).x=b.x+this.I2c;let c;(c=a.Kf).y=c.y+this.J2c;let f;(f=a.Cg).x=f.x+this.I2c;let l;(l=a.Cg).y=l.y+this.J2c;return a}uu(a,b){var c=Sk.c4a;return!!a&&!!b&&Math.abs(a-b)<=c}dBj(a,b,c,f,l,x,G){a.Kf=new zc.a(G.Yb-this.ug,G.$b-this.kw);a.Cg=a.Kf.copy();a.KG=!0;b.Kf=new zc.a(G.Yb-this.ug,G.Ub-this.s3);b.Cg=b.Kf.copy();b.KG=!0;c.Kf=new zc.a(G.Yb-this.UN,G.$b-this.ug);c.Cg=c.Kf.copy();f.Kf=new zc.a(G.Vb-
this.UA,G.$b-this.ug);f.Cg=f.Kf.copy();b=G.Vf();l.Kf=new zc.a(a.Kf._x-this.ug,b._y-this.kw);l.Cg=l.Kf.copy();l.KG=!0;x.Kf=new zc.a(b._x-this.ug,c.Kf._y-this.ug);x.Cg=x.Kf.copy()}nZa(a,b){for(let c of a)0===b?(c.color=te.a.mri,c.dashStyle="4,4",c.x2b=0):1===b?(c.color=te.a.lri,c.dashStyle="4,4",c.x2b=1):2===b&&(c.color=te.a.$Qf,c.dashStyle="4,4",c.x2b=2)}get $Xg(){return this.I2c}set $Xg(a){this.I2c=a}get aYg(){return this.J2c}set aYg(a){this.J2c=a}}Sk.c4a=.4;Sk.yDc=5;Object(e.a)(Sk,"SmartGuideUtility",
null,[1204]);var $l=d(138),en=d(205),Cn=d(167),zm=d(193);class Am{constructor(a,b,c,f,l){this.ABb=this.BBb=this.wb=null;this.Vka=new Sys.UI.Bounds(0,0,0,0);this.cHa=1;this.Db=!1;this.Jg=a;this.yi=b;this.od=f;this.Hc=c;this.od.eUb(Object(C.a)(this,this.onResize,"onResize"));l&&this.od.GNa(Object(C.a)(this,this.c0,"onActiveSlideDomDisplayed"));this.ym()}get visible(){return!!this.wb&&this.Db}set visible(a){this.wb||this.ym();this.Db!==a&&(this.wb.Ld(a),this.Db=a)}F_f(a){this.ABb&&this.BBb.xa.removeChild(this.ABb.xa);
this.ABb=new en.a;let b=0;for(;b<a.length;b++){const c=a[b],f=new Cn.a,l=Am.WUj(Am.Zbh(zc.a.scale(c.Kf,this.cHa,this.cHa)),Am.Zbh(zc.a.scale(c.Cg,this.cHa,this.cHa)));f.ht(l);f.Hu(this.A8f(c.color));f.pna(c.dashStyle);f.ar(1);this.ABb.appendChild(f);2===c.x2b&&this.cLi(l[0],l[1])}this.BBb.appendChild(this.ABb)}cLi(a,b){a._y===b._y?a._x<b._x?this.OTf(a,b):this.OTf(b,a):a._y>b._y?this.PTf(a,b):this.PTf(b,a)}OTf(a,b){const c=this.YMf(b._x-a._x);this.pGc([new zc.a(a._x,a._y),new zc.a(a._x+c,a._y-c/2),
new zc.a(a._x+c,a._y+c/2)]);this.pGc([new zc.a(b._x,b._y),new zc.a(b._x-c,b._y-c/2),new zc.a(b._x-c,b._y+c/2)])}PTf(a,b){const c=this.YMf(a._y-b._y);this.pGc([new zc.a(a._x,a._y),new zc.a(a._x-c/2,a._y-c),new zc.a(a._x+c/2,a._y-c)]);this.pGc([new zc.a(b._x,b._y),new zc.a(b._x-c/2,b._y+c),new zc.a(b._x+c/2,b._y+c)])}YMf(a){return Math.min(a,10)/2}pGc(a){const b=new Cn.a,c=this.A8f(te.a.$Qf);b.ht(a);b.Hu(c);b.ar(1);b.oE(c);b.Ld(!0);this.ABb.appendChild(b)}A8f(a){return this.yi&&this.yi.highContrastColors?
this.yi.highContrastColors.foregroundTextColor:a}ym(){this.wb=new $l.a;this.wb.jr("SmartGuideView");this.wb.Rj(0);this.wb.Ld(!1);this.Jg.xa.appendChild(this.wb.xa);this.BBb=new zm.a;this.BBb.xa.style.overflow="visible";this.wb.appendChild(this.BBb);this.Nr(this.Hc.Gc)}onResize(a,b){b&&this.Nr(b.RF)}c0(a,b){b&&this.Nr(b.RF)}Nr(a){this.wb&&a&&a.ie&&a===this.Hc.Gc&&(this.Vka.x!==a.ie.x||this.Vka.y!==a.ie.y||this.Vka.width!==a.ie.width||this.Vka.height!==a.ie.height)&&(this.Vka=new Sys.UI.Bounds(a.ie.x,
a.ie.y,a.ie.width,a.ie.height),this.wb.setPosition(a.ie.x,a.ie.y),this.BBb.gh(a.ie.width,a.ie.height),this.wb.gh(a.ie.width,a.ie.height))}static WUj(a,b){b._y===a._y||Math.abs(b._y-a._y)%2||(b._y+=1);b._x===a._x||Math.abs(b._x-a._x)%2||(b._x+=1);return[a,b]}static Zbh(a){return new zc.a(Math.floor(a.x)+.5,Math.floor(a.y)+.5)}}Object(e.a)(Am,"SmartGuideView",null,[1203]);class fp{setPosition(a,b,c){a.setPosition(a.x+b,a.y+c,!0)}setOffsets(a,b){a.setOffsets(Of.a.add(a.AWa,b),!0)}iI(a){return new dk.a(a.Zr())}PF(a){return!a.shapeNode.Mx}}
Object(e.a)(fp,"DefaultShapeMoveResizeHandler",null,[610]);class uk{constructor(){this.K=null}get name(){return"PowerPointWebEditor.SmartGuide"}Wb(a){this.K=a;this.K.register(1202,"PowerPointWebEditor.ISmartGuideManager").ma().na(()=>new ko(this.K.resolve("PowerPointWebEditor.ISmartGuideView"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ISmartGuideUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesMarginCenterEquisizing));
this.K.register(1203,"PowerPointWebEditor.ISmartGuideView").ma().na(()=>new Am(this.K.resolve("PowerPointWebEditor.ISlidePane"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").eta));this.K.register(1204,"PowerPointWebEditor.ISmartGuideUtility").ma().na(()=>new Sk(this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptoSmartGuidesAlignToSlideAndCenterEdge))}init(){this.K.resolve("PowerPointWebEditor.ISmartGuideUtility").addHandler(new fp)}dispose(){}static main(){m.a.instance.Bc(new uk)}}Object(e.a)(uk,"PPTWebEditorSmartGuidePackage",null,[2,3]);class am{}am.YCg=[E.a.backspace,E.a.Wqb,E.a.wK,E.a.cYb,E.a.ABa,E.a.enter,E.a.Rid,E.a.cB,E.a.tab,E.a.Llc,E.a.pageDown,E.a.pageUp,E.a.rWa,E.a.Sue,E.a.qWa,E.a.Rue];am.aXj=[E.a.backspace,E.a.Wqb,E.a.wK,E.a.cYb,E.a.ABa,
E.a.enter,E.a.Rid,E.a.cB,E.a.tab,E.a.Llc,E.a.font,E.a.T4,E.a.HIa,E.a.Jr,E.a.$Ha,E.a.YXa,E.a.nI,E.a.BJ,E.a.bold,E.a.setItalic,E.a.underline,E.a.strikethrough,E.a.gt,E.a.w$,E.a.UAa,E.a.KO,E.a.lR,E.a.rD,E.a.lz,E.a.Nha,E.a.Wja,E.a.cna,E.a.pCa,ba.a.uma,ba.a.Ama,ba.a.zma,ba.a.yma,E.a.nPa,E.a.Asa,E.a.Mxa,E.a.Nxa,E.a.Oxa,E.a.MJa,E.a.NJa,E.a.iSc,E.a.jSc,E.a.z8a,E.a.aSa,E.a.C8a,E.a.BDa,E.a.Fba,ba.a.zEb,E.a.deleteRow,ba.a.vbd,E.a.zBa,ba.a.eBe,E.a.insertTable,ba.a.kBe,E.a.FAa,E.a.V1,ba.a.mwa,ba.a.gXa,ba.a.Ygb,
ba.a.IYa,ba.a.dxa,ba.a.JYa,ba.a.Zjd,ba.a.Yjd,E.a.xO,E.a.dSa,E.a.centerJustify,E.a.leftJustify,E.a.rightJustify,E.a.fullJustify,E.a.SYb,E.a.G6b,E.a.ulc,ba.a.zhb,ba.a.Ahb,ba.a.Bhb,ba.a.Chb,E.a.jVb];am.v0k=[E.a.leftArrow,E.a.rightArrow,E.a.upArrow,E.a.downArrow,E.a.QYa,E.a.PYa,E.a.sBa,E.a.rBa,E.a.ZOa,E.a.YOa,E.a.ZHb,E.a.jhb,E.a.dYb,E.a.Xqb,E.a.Z4a,E.a.XOa,E.a.rWa,E.a.WPa,E.a.udb,E.a.tdb,E.a.V5a,E.a.qWa,E.a.VPa,E.a.U5a,E.a.ura,E.a.Tid,ba.a.Akc,ba.a.pKb,ba.a.ZYa,ba.a.DIb];Object(e.a)(am,"ActionIdList",
null,[]);class Fo{constructor(){this.ActionTime=this.ActionName=this.ActionId=null}}Object(e.a)(Fo,"ActionInformation",null,[]);class Dp{constructor(a,b,c,f,l,x){this.m$a=[];this.F7b=[];this.FI=a;this.yfe=b||[];this.ia=c;this.ia.Jma(this);this.Xa=f;this.VW=l;this.TG=x}a$(a){this.Drh(a)&&this.tna(a.actionId)&&(this.m$a.push(a.actionId),this.F7b.push(Date.now()))}Z9(a){this.Drh(a)&&this.tna(a.actionId)&&(this.m$a.pop(),this.F7b.pop())}tna(a){if(Array.contains(this.yfe,a))return!0;a=this.ia.xS(a);return!!a&&
!(a.flags[32]||a.flags[64])}Drh(a){return 2===a.behavior&&a.Xi?!0:!1}getCommandName(a,b=""){return(a=this.FI?this.FI.c5(a):null)?a:b}vX(a){a&&a.Uqa&&Aa.a.J(23594504,822,50,"ClientRevisionId:{0}, ActionName:{1}, PodSID:{2}, UndoAction:{3}",a.Uqa.toString(),this.actionName||(this.VW.fd===E.a.typing||this.VW.fd===E.a.KAa||this.VW.fd===E.a.lPa?"Typing":null)||(this.TG.jTc?"ClosingTextUndoStack":""),this.Xa.podSessionId||"",this.FI.c5(this.VW.fd));return!!this.m$a.length}update(a,b){a=new Fo;a.ActionId=
this.rcg();a.ActionName=this.scg();a.ActionTime=this.j8i().toString();Kj.a.Lo(b,sb.a.f0h,a);b.setValue(sb.a.P3b,!0);b.setValue(sb.a.Mfd,1)}get actionName(){return this.scg()}get actionId(){return this.rcg()}T0d(){return this.m$a[this.m$a.length-1]}rcg(){return this.m$a.length?this.T0d().toString():null}scg(){return this.m$a.length?this.getCommandName(this.T0d(),this.T0d().toString()):null}j8i(){return this.F7b.length?this.F7b[this.F7b.length-1]:Number.MAX_VALUE}}Object(e.a)(Dp,"ActionInfoRevisionMetaDataUpdater",
null,[1237,147]);class lo{constructor(){this.va=new ic.a}Qbh(a){this.va.raiseEvent("UCI",a)}A8h(a){this.va.addHandler("UCI",a)}kTk(a){this.va.removeHandler("UCI",a)}}Object(e.a)(lo,"CcpEventSource",null,[1292,1293,1294]);class Dn{constructor(a,b){this.g8b=this.Ige=this.Hge=null;this.Jge=a;this.HT=b;this.Jge.A8h(Object(C.a)(this,this.uZg,"onCcpPropertyChanged"))}uZg(a,b){this.Hge=b.Np;this.Ige=b.Oli;this.g8b=b.Pli}vX(a){a=this.HT.QCa(a.Kwa);!this.g8b&&a.Sa(sb.a.x4a)&&(a.removeProperty(sb.a.QM),a.removeProperty(sb.a.xP),
a.removeProperty(sb.a.x4a));return!!this.g8b}update(a,b){b.setValue(sb.a.QM,this.Hge);b.setValue(sb.a.xP,this.Ige);b.setValue(sb.a.x4a,this.g8b);this.g8b=this.Ige=this.Hge=null}dispose(){this.Jge&&this.Jge.kTk(Object(C.a)(this,this.uZg,"onCcpPropertyChanged"))}}Object(e.a)(Dn,"CcpInfoRevisionMetaDataUpdater",null,[1198,1237,106]);var Km=d(316);class gp extends ff.a{constructor(a,b,c,f,l,x,G){super();this.ShapeId=this.Sid=this.Cid=0;this.FetchImageData=!1;this.AuthToken=this.Origin=this.SessionUrl=
null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.FetchImageData=f;this.SessionUrl=l;this.Origin=x;this.AuthToken=G}Ok(){return 108}}Object(e.a)(gp,"AugmentImageRequest",ff.a,[]);class En extends ff.a{constructor(){super()}Ok(){return 81}}Object(e.a)(En,"FlushRequest",ff.a,[]);class fn extends ff.a{constructor(a,b,c,f,l,x){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.DeckSuggestionId=this.SessionId=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.SessionId=
f;this.DeckSuggestionId=l;this.Hints=x}Ok(){return 111}}Object(e.a)(fn,"GenerateAgendaDeckSuggestionRequest",ff.a,[]);class kk extends ff.a{constructor(a,b,c,f,l){super();this.AgendaSid=this.AgendaCid=0;this.Hints=this.OutlineJson=this.CorrelationId=null;this.AgendaCid=a;this.AgendaSid=b;this.CorrelationId=c;this.OutlineJson=f;this.Hints=l}Ok(){return 110}}Object(e.a)(kk,"GenerateAgendaSuggestionRequest",ff.a,[]);class bm extends ff.a{constructor(a,b,c,f,l,x,G,R,fa,wa){super();this.ShapeViewHeight=
this.ShapeViewWidth=this.ShapeId=this.Sid=this.Cid=0;this.SubNodeId=null;this.SubNodeHeight=this.SubNodeWidth=0;this.Trigger=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.ShapeId=c;this.ShapeViewWidth=f;this.ShapeViewHeight=l;this.SubNodeId=x;this.SubNodeWidth=G;this.SubNodeHeight=R;this.CorrelationId=fa;this.Trigger=wa}Ok(){return 99}}Object(e.a)(bm,"GenerateIconSuggestionRequest",ff.a,[]);class Pl extends ff.a{constructor(a,b,c,f){super();this.ImageKey=this.GraphNodeId=null;this.IsGenerateSuggestion=
this.IsSVGBlipFill=!1;this.GraphNodeId=Zd.a(a);this.ImageKey=b;this.IsSVGBlipFill=c;this.IsGenerateSuggestion=f}Ok(){return 91}}Object(e.a)(Pl,"GenerateImageDescriptionRequest",ff.a,[]);class Lf extends ff.a{constructor(a,b,c,f,l,x,G){super();this.Sid=this.Cid=0;this.Hints=this.LastShownCorrelationId=this.Trigger=this.TermCorrelationId=this.CorrelationId=null;this.Cid=a;this.Sid=b;this.CorrelationId=c;this.TermCorrelationId=f;this.Trigger=l;this.LastShownCorrelationId=x;this.Hints=G}Ok(){return 66}}
Object(e.a)(Lf,"GenerateSuggestionRequest",ff.a,[]);class no extends Lf{constructor(a,b,c,f,l,x,G,R){super(a,b,f,null,l,x,"");this.ShapeViewHeight=this.ShapeViewWidth=this.ShapeId=0;this.ShapeId=c;this.ShapeViewWidth=G;this.ShapeViewHeight=R}Ok(){return 83}}Object(e.a)(no,"GenerateReplaceObjectRequest",Lf,[]);class lk extends ff.a{constructor(a,b,c){super();this.m_shapeid=this.m_cid=this.m_slideid=0;this.m_slideid=a;this.m_cid=b;this.m_shapeid=c}Ok(){return 57}}Object(e.a)(lk,"GetPictureCropInfoRequest",
ff.a,[]);class Je extends ff.a{constructor(){super();this.SlideCid=this.SlideSid=this.Scenario=0;this.ShapeIds=null}Ok(){return 109}}Object(e.a)(Je,"ImageTransformRequest",ff.a,[]);class yl extends ff.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=b}Ok(){return 84}}Object(e.a)(yl,"ReportReplaceObjectInfoRequest",ff.a,[]);class oo extends ff.a{constructor(a,b){super();this.JsonString=this.CorrelationId=null;this.CorrelationId=a;this.JsonString=
b}Ok(){return 67}}Object(e.a)(oo,"ReportSuggestionSessionInfoRequest",ff.a,[]);class jl extends ff.a{constructor(a,b,c){super();this.SlideId=null;this.ShapeId=0;this.Base64OfSnapshot=null;this.SlideId=a;this.ShapeId=b;this.Base64OfSnapshot=c}Ok(){return 59}}Object(e.a)(jl,"UpdateContentAddinSnapshotInfoRequest",ff.a,[]);class xi{constructor(a,b,c){this.TG=a;this.Zb=b;this.uGg=c}get jTc(){return this.TG.jTc}B4a(a,b=!1){this.TG.B4a(a,b)}forceOutbound(){this.TG.forceOutbound()}afa(a,b,c=!1){this.TG.afa(a,
b,c)}QAc(a){this.TG.QAc(a)}vtb(a){return this.TG.vtb(a)}Cb(a){this.TG.Cb(a)}deg(a,b,c,f=null,l=null,x=!1){a=new Xj.a(new lk(a,b,c),f,l,G=>0===G.StatusCode);this.TG.afa(a,this.Zb,x)}Fia(a,b,c,f,l,x,G,R=null,fa=null){a=new Xj.a(new Lf(a,b,c,f,l,x,G),R,fa,wa=>0===wa.StatusCode);this.TG.afa(a,this.Zb)}generateImageDescription(a,b,c,f){a=new Xj.a(new Pl(a,b,c,f),null,null,l=>0===l.StatusCode);this.TG.afa(a,this.Zb)}Xma(a,b,c){a=new Xj.a(new oo(a,b),null,()=>!0,f=>0===f.StatusCode);this.TG.afa(a,this.Zb,
c)}i8f(a,b,c,f,l,x,G,R=null,fa=null){a=new Xj.a(new no(a,b,c,f,l,null,x,G),R,fa,wa=>0===wa.StatusCode);this.TG.afa(a,this.Zb)}RUk(a,b,c=null,f=null){a=new Xj.a(new yl(a,b),c,f,l=>0===l.StatusCode);this.TG.afa(a,this.Zb)}DYi(a,b,c,f,l,x,G,R,fa=null,wa=null){a=new Xj.a(new bm(a,b,c,f,l,x,74,74,G,R),fa,wa,Wa=>0===Wa.StatusCode);this.TG.afa(a,this.Zb)}augmentImage(a,b,c,f,l,x,G,R=null,fa=null){a=new Xj.a(new gp(a,b,c,f,l,x,G),R,fa,wa=>0===wa.StatusCode);this.TG.afa(a,this.Zb)}generateAgendaSuggestion(a,
b,c,f,l,x=null,G=null){a=new Xj.a(new kk(a,b,c,f,l),x,G,R=>0===R.StatusCode);this.TG.afa(a,this.Zb)}generateAgendaDeckSuggestion(a,b,c,f,l,x,G=null,R=null){a=new Xj.a(new fn(a,b,c,f,l,x),G,R,fa=>0===fa.StatusCode);this.TG.afa(a,this.Zb)}WCh(a,b,c,f=null,l=null){const x=new Xj.a(new jl(a,b,c),f,l,fa=>0===fa.StatusCode),G=()=>{this.xPi(x)};a=this.TG.vtb(this.Zb.yf);const R=new Km.a;a?a.forceOutbound(()=>{G()},l?()=>{l(R)}:null,null):(Aa.a.J(20460503,823,10,"Can't find graph space replicator when trying to do outbound"),
l&&l(R))}flush(a=null,b=null){a=new Xj.a(new En,a,b,c=>0===c.StatusCode,3);this.TG.tra(a)}tra(a){this.TG.tra(a)}VMc(){return this.vtb(this.Zb.yf)}xPi(a){this.uGg.Cb(a);this.uGg.forceOutbound(null,null,null)}}Object(e.a)(xi,"OutboundHelper",null,[1195,14,1291]);var ah=d(257),aj=d(166);class cm{constructor(a,b,c,f,l){this.uL=[];this.pbb=new ah.a;this.A5c=null;this.CEg=[];this.g4=null;this.va=new ic.a;this.LIg=this.iAb=this.d5c=!1;this.Qb=a;this.la=b;this.ua=c;this.H9j=l;this.yua=f;this.e7j=this.la.$sa?
1:4;f.Yj(Object(C.a)(this,this.D9c,"onMainMastersLoaded"));this.la.$sa&&f.Yj(Object(C.a)(this,this.I0g,"onMasterIdListChanged"))}get Adk(){if(this.la.$sa&&this.ua.Ba){const a=this.ua.Ba.pj;a&&Array.contains(this.uL,a)&&this.Nue(a)}return this.uL.slice(0,Math.min(this.e7j,this.uL.length))}mQk(a){Array.remove(this.uL,a)}get pml(){return this.A5c}get kO(){return this.pbb}get yTb(){return this.CEg}get uxj(){return!this.A5c}get Uwk(){return 0<this.uL.length&&(!this.la.TSa||this.d5c)}get hve(){return this.iAb}set hve(a){this.iAb=
a}Qil(a){a&&this.DAh(a.pj)}Uuh(){this.d5c=!0;this.fed(!0);this.vGb()}DAh(a){this.d5c=!0;a&&(Array.remove(this.uL,a),Array.insert(this.uL,0,a));this.vGb()}JPe(a){this.la.$sa?this.DAh(a):this.Uuh()}Qcg(a){if(!a||!this.pbb)return null;a=a.pj;if(!a)return null;let b=null;return({value:b}=this.pbb.Rf(a)).returnValue?b:null}I0g(a,b){b.property.id===sb.a.K6c.id&&(Aa.a.J(38847373,824,50,"MasterIdList update, need load master id list: {0}",this.iAb),this.iAb&&(this.iAb=!1,this.d5c&&(this.fed(!1),this.vGb())),
this.OOf())}D9c(a,b){a=b.property;if(this.la.$sa)if(a.id===sb.a.kCb.id){a=this.Qb.f8i();const f=this.Qb.hI();if(f&&f.length)if(a&&a.length){for(var c=b=0;b<a.length&&c<f.length;){const l=a[b],x=f[c];l.Id<x.Id?(this.$Ch(l.Id),b++):x.Id<l.Id?(this.tVe(x.Id),c++):(Yd.c(l)!==Yd.c(x)&&this.lwl(x.Id),c++,b++)}if(c<f.length)for(;c<f.length;c++)this.tVe(f[c].Id);if(b<a.length)for(;b<a.length;b++)this.$Ch(a[b].Id);this.vGb()}else aj.b(f,null,l=>{this.tVe(l.Id)})}else a.id===sb.a.RX.id&&(Aa.a.J(38847375,824,
50,"Slide size changed, need to reload the resources."),this.fed(!0),this.vGb());else if(a.id===sb.a.kCb.id||a.id===sb.a.RX.id)Aa.a.J(19240846,824,50,"MainMasters are reloaded, need to reload the resources"),this.fed(!0),this.vGb()}tVe(a){this.Nue(a)}lwl(a){this.Nue(a)}Nue(a){Array.contains(this.uL,a)&&Array.remove(this.uL,a);Array.insert(this.uL,0,a)}$Ch(a){this.pbb.remove(a);-1!==Array.indexOf(this.uL,a)&&Array.remove(this.uL,a)}vGb(){this.g4=this.g4||this.H9j(this);this.g4.fF(null,null,null)}fed(a){if(this.la.$sa){Aa.a.J(38847378,
824,50,"RefreshMastersToLoad, need clean cache: {0} ",a);var b=this.Qb.Nsb();a&&(Array.clear(this.uL),this.clearCache());if(b&&0<b.length)for(const c of b)-1===Array.indexOf(this.uL,c.idField)&&Array.add(this.uL,c.idField);else this.iAb=!0,(a=this.Qb.CG(0))&&(a=a.pj)&&Array.add(this.uL,a)}else if(a=this.Qb.hI(),Array.clear(this.uL),this.clearCache(),a)for(b of a)this.pbb.remove(b.Id),-1===Array.indexOf(this.uL,b.Id)&&Array.add(this.uL,b.Id)}Tnk(a){if(a){for(const b of a)b&&(Aa.a.J(38847381,824,50,
"PresentationResourcesManager::OnMainMasterResoucesLoaded master {0} resources loaded.",b.MasterId),this.pbb.$(b.MasterId,b),this.A5c=this.A5c||b.TableStyleGallery,this.la.$sa||Array.remove(this.uL,b.MasterId));this.OOf();this.va.raiseEvent("MainMasterResourcesLoaded")}else Aa.a.J(19240848,824,10,"PresentationResourcesManager::OnMainMasterResoucesLoaded mainMasterResouces returned is null")}OOf(){!this.LIg&&this.gJf()&&(this.LIg=!0,Aa.a.J(38892514,824,50,"PresentationResourcesManager::CheckFirstMasterRetrieved first master retrieved."),
re.a("RaiseFirstMasterRetrievedEvent")&&this.va.raiseEvent("FirstMasterRetrieved"))}bjk(a){this.la.powerPointEnableAccCheck&&(a&&a.length?(this.CEg=a,this.va.raiseEvent("AccCheckRuleInfoListLoaded")):Aa.a.J(19240850,824,10,"PresentationResourcesManager::OnAccRuleInfoListLoaded accRuleInfoList returned is null as acc-checker is enabled"))}gJf(){if(!this.la.$sa)return!0;const a=this.Qb.Nsb();if(a&&0<a.length)for(const b of this.Qb.Nsb())if(0<b.layoutCountField&&this.kO.Jb(b.idField)&&this.kO.ga(b.idField).LayoutIcons.length===
b.layoutCountField)return Aa.a.J(38892545,813,50,"LayoutDialogReady: master ID: {0}, layout count: {1}",b.idField,b.layoutCountField),!0;return!1}yBc(a){this.va.addHandler("MainMasterResourcesLoaded",a)}YRk(a){this.va.removeHandler("MainMasterResourcesLoaded",a)}q6h(a){this.va.addHandler("FirstMasterRetrieved",a)}N5h(a){this.va.addHandler("AccCheckRuleInfoListLoaded",a)}vRk(a){this.va.removeHandler("AccCheckRuleInfoListLoaded",a)}clearCache(){this.pbb=new ah.a}dispose(){this.yua.tm(Object(C.a)(this,
this.D9c,"onMainMastersLoaded"));this.la.$sa&&this.yua.tm(Object(C.a)(this,this.I0g,"onMasterIdListChanged"));this.va.dispose();this.g4&&this.g4.dispose()}}Object(e.a)(cm,"PresentationResourcesManager",null,[1197,106]);var Fn=d(378);class yi extends ff.a{constructor(){super();this.MasterIds=null;this.NeedLoadingMasterIdList=this.IncludeTableStyle=!1}Ok(){return 52}static NPd(a,b,c){const f=new yi;f.MasterIds=a;f.IncludeTableStyle=b;f.NeedLoadingMasterIdList=c;return f}}Object(e.a)(yi,"GetEditPresResourcesRequest",
ff.a,[]);class Bm extends Fn.a{constructor(a,b,c,f){super();this.oyb=0;this.Mbb=this.D3=!1;this.Bm=a;this.nVa=b;this.XN=f;this.enabled=2;this.rw=c.nzi();this.Bm.register(this)}fF(){this.rw.BWi();this.rw.r8a();this.Bm.s$()}forceOutbound(){}fja(){return this.nVa.Uwk||this.nVa.hve}$P(){return!1}GRa(){return this.Od&&2===this.Od.status?!0:this.D3||this.Mbb?!1:this.fja()&&this.rw.Z2b()}$Fb(){if(1===this._state){var a=this.nVa.Adk;this.Od.oH=yi.NPd(a,this.nVa.uxj,this.nVa.hve);for(const b of a)this.nVa.mQk(b);
this.Od.status=1;this._state=3}else 3===this._state&&this.Od&&2===this.Od.status&&(this.Mbb?(this._state=4,this.dispose()):(200===this.Od.gv&&this.XN.Ljc(),this.rw.pKa(),2!==this.Od.statusCode?this.jH():this.Od.Gr&&1===this.Od.Gr.length?(a=this.Od.Gr[0],0===a.StatusCode?(this.nVa.Tnk(Yd.a(a.MainMasterResources)),this.nVa.bjk(Yd.a(a.AccRuleInfoList)),this.e0()):this.jH()):this.jH()))}get Gba(){return this.fja()?this.rw.Nfb():super.Gba}dispose(){1===this._state||4===this._state?(this.D3||this.Bm.unregister(this),
this.D3=!0):this.Mbb=!0}e0(){this.oyb=0;this._state=1;this.fja()||this.rw.$Ya()}jH(){4<++this.oyb?(this._state=4,Aa.a.J(19240853,824,10,"PresentationResourcesReplicator quit after {0} failures",this.oyb)):(Aa.a.J(19240855,824,15,"PresentationResourcesReplicator will retry on failure"),this._state=1)}}Object(e.a)(Bm,"PresentationResourcesReplicator",Fn.a,[106]);class Un{constructor(a,b){this.T9j=a;this.HT=b}Lpk(a){if(!a)throw Error.argumentNull("dataStorePusher is null!");const b=a.Kwa;let c=null,
f=!1;for(const l of this.T9j)if(l.vX(a)){if(!c&&(c=this.HT.QCa(b),!c)){Aa.a.J(23594507,817,50,"revisionMetadata is null");return}l.update(a,c);f=!0}f&&this.HT.WHd(b,a,c)}}Object(e.a)(Un,"RevisionMetaDataUpdateListener",null,[1199]);var Gn=d(399);class mm{QCa(a){if(!a)return null;const b=a.KK(4);return b&&!b.equals(Ga.a.nil)?a.te(b):new Gn.a}HVe(a,b,c,f,l,x,G,R,fa){if(a&&f){a.Un.apply(a,mm.RYk);a.setValue(sb.a.Xxg,b);a.setValue(sb.a.P3b,!0);a.setValue(sb.a.Mfd,1);a.setValue(sb.a.sid,f.sid);a.setValue(sb.a.cid,
f.cid);c&&a.setValue(sb.a.ZDa,!0);l&&a.setValue(sb.a.shapeId,l.get_shapeId());x&&(a.setValue(sb.a.Vp,!0),a.setValue(sb.a.dxh,x.cellId),a.setValue(sb.a.rowId,x.rowId));if(G&&0<G.length){b=G.length;c=Array(b);f=Array(b);for(l=0;l<b;l++)c[l]=G[l].rowId,f[l]=G[l].cellId;a.setValue(sb.a.Vp,!0);a.setValue(sb.a.dib,f);a.setValue(sb.a.pxh,c)}a.setValue(sb.a.bSe,R);a.setValue(sb.a.aSe,fa)}}WHd(a,b,c){if(a&&b&&c){var f=!1;a.te(mm.Uea)||(a.jE(c,mm.Uea),f=!0);b.Wpa(c);f&&b.bxa(c.id,4)}}iEh(a,b){if(a){var c=a.Kwa,
f=this.QCa(c);f.setValue(sb.a.Mfd,b);this.WHd(c,a,f)}}fyl(a){if(a){var b=a.Kwa,c=this.QCa(b);c.setValue(sb.a.BXk,0);this.WHd(b,a,c)}}}mm.Uea=Ga.a.Mf("{B3AB583C-77CD-428D-9371-02C2EA7C058B}{1}");mm.RYk=[sb.a.Xxg,sb.a.shapeId,sb.a.Vp,sb.a.ZDa,sb.a.dxh,sb.a.rowId,sb.a.dib,sb.a.pxh,sb.a.bSe,sb.a.aSe];Object(e.a)(mm,"RevisionMetadataHelper",null,[1290]);var Hn=d(650),vk=d(833);class po extends ff.a{constructor(a,b,c,f){super();this.ShouldWaitForSave=this.ShouldReleaseLock=!1;this.SessionCloseReason=0;
this.SessionKey=null;this.ShouldReleaseLock=a;this.ShouldWaitForSave=b;this.SessionCloseReason=c;this.SessionKey=f}Ok(){return 32}}Object(e.a)(po,"SaveAndCloseRequest",ff.a,[]);class dm{constructor(a,b,c,f,l,x,G,R,fa){this.pi=a;this.ire=b;this.kC=c;this.Xa=f;this.la=l;this.WA=x;this.Md=G;this.jc=R;this.Bm=fa}DWi(a){this.Xa.Lwb=!0;a=new po(!0,!1,a,this.Xa.podSessionId);this.Md.jja=!0;const b=this.pi.VMc();b&&b.$P()&&this.jc.un?b.u6a(null,null,null,a):this.ire.$2f(a,null,null)}G2(a=!1,b=!0,c=null,f=
null,l=1){Aa.a.J(36987935,823,50,"SaveAndCloseHandler::ForceSave Start, fReleaseLock: {0}, fWaitForSave: {1}, fSaveToHost: {2}",a,!0,b);const x=new po(a,!0,l,this.Xa.podSessionId);if(a&&this.la.markSessionClosingAtForceSave)this.WA.markSessionClosingAtForceSave(l),this.Bm.pause(),this.ire.u6a(x,G=>{Aa.a.J(41263715,823,50,"SaveAndCloseHandler::ForceSave Succeeded. Closing session");this.la.h3f?this.WA.closeSession(l):this.kC.Mdd(new Hn.a(l));c(G)},()=>{Aa.a.J(41263745,823,15,"SaveAndCloseHandler::ForceSave Failed.");
this.Bm.Qib();f&&f(null);return!0});else{a=this.pi.VMc();const G=R=>{this.pmk(x,c,f,fa=>0===fa.StatusCode,R,b,l)};a?a.forceOutbound(()=>{G(!0)},()=>{G(!1)},null):(Aa.a.J(22410186,823,10,"Can't find graph space replicator when trying to do outbound"),G(!1))}}pmk(a,b,c,f,l,x,G){Aa.a.J(36987938,823,50,"SaveAndCloseHandler::OnForceSaveOutboundComplete Start, fReleaseLock: {0}, fOutboundSuccess: {1}, fSaveToHost: {2}",a.ShouldReleaseLock,l,x);l&&x||a.ShouldReleaseLock?(a.ShouldReleaseLock&&(this.Md.jja=
!0),this.ire.tra(a,R=>{a.ShouldReleaseLock&&(this.la.h3f?this.WA.closeSession(G):this.kC.Mdd(new Hn.a(G)));b(R)},c,f)):l&&b?b(new vk.a):!l&&c&&c(new Km.a)}}Object(e.a)(dm,"SaveAndCloseHandler",null,[1196]);var Go=d(997),si=d(103);class qo{constructor(a,b,c,f){this.pi=a;this.Wse=b;this.ycc=c;this.ova=f}vX(a){let b=null,c=!0;if(this.pi.jTc)b=a.Uqa,c=!1;else if(this.Wse.fd===E.a.typing||this.Wse.fd===E.a.KAa||this.Wse.fd===E.a.lPa)b=a.Uqa;b&&(this.ova&&this.QDi(b.toString()),Nc.a.O9a(),this.ycc.lzh(b,
c),Aa.a.J(23594510,822,50,"ClientRevisionId:{0}, GenerateTime:{1}",a.Uqa.toString(),Nc.a.$e(new Date)));return!1}update(){}QDi(a){const b=new Go.ActionContext(si.a.BBh,1,null);b.Oj=!0;b.WE=new Date;b.Wa(si.a.UX,Nc.a.t7a(a).toString());b.Kr=!0;Nc.a.Lea(b)}}Object(e.a)(qo,"TextEditingRevisionInfoMetaDataUpdater",null,[1237]);class nm{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Storage"}Wb(a){this.K=a;const b=()=>new Rh.a(a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.IErrorHandler"),
a.resolve("PowerPointWebEditor.Core.IPPTServerResponseHelper"),a.resolve("PowerPointWebEditor.IReplicationTimerFactory").PXb(a.resolve("Box4.IReplicationParameters")),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>u.AFrameworkApplication.Vg);a.register(1195,"PowerPointWebEditor.Storage.IOutboundHelper").ma().na(()=>new xi(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),b()));a.register(1196,"PowerPointWebEditor.Storage.ISaveAndCloseHandler").ma().na(()=>
new dm(a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),a.resolve("PowerPointWebEditor.BootStorage.ISaveAndCloseTaskExecutor"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IReplicationScheduler")));a.register(1197,
"PowerPointWebEditor.IPresentationResourcesManager").ma().na(()=>new cm(a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").vd(7),c=>new Bm(a.resolve("PowerPointWebEditor.BootStorage.IBackgroundReplicationScheduler"),c,a.resolve("PowerPointWebEditor.IReplicationTimerFactory"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"))));this.kui()}kui(){this.K.register(mm,
"PowerPointWebEditor.RevisionMetadataHelper").as("PowerPointWebEditor.IRevisionMetadataHelper").ma();this.K.register(lo,"PowerPointWebEditor.CcpEventSource").as("PowerPointWebEditor.ICcpEventSource").as("PowerPointWebEditor.ICcpEventNotifier").as("PowerPointWebEditor.ICcpEventHandlers").ma();this.K.register(1198,"PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").ma().na(()=>new Dn(this.K.resolve("PowerPointWebEditor.ICcpEventHandlers"),this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")));
this.K.register(1199,"PowerPointWebEditor.IRevisionMetaDataUpdateListener").ma().na(()=>new Un([new Dp(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),am.YCg,this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper")),new qo(this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.Graph.IGraphTransactionManager"),
this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").podThumbnailUpdateTelemetryEnabled),this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater")],this.K.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))}init(){this.K.resolve("PowerPointWebEditor.IRevisionMetaDataUpdateListener")}dispose(){this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager").dispose();this.K.resolve("PowerPointWebEditor.ICcpInfoRevisionMetaDataUpdater").dispose()}static main(){m.a.instance.Bc(new nm)}}
Object(e.a)(nm,"PPTWebEditorStoragePackage",null,[2,3]);class wc{constructor(a,b,c){this.CIh=a;this.$Lh=b;this.tWh=c}get LCID(){return this.CIh}get v_k(){return this.tWh}get ZVf(){return this.$Lh}get p$d(){return!!(this.ZVf&wc.SHh)}get L4b(){return!!(this.ZVf&wc.THh)}static URc(){wc.CIe={["20490"]:new wc(20490,4215112,"Latn"),["8251"]:new wc(8251,4215112,"Latn"),["17418"]:new wc(17418,4215112,"Latn"),["17417"]:new wc(17417,4215112,"Latn"),["8218"]:new wc(8218,4215304,"Cyrl"),["8204"]:new wc(8204,
4215112,"Latn"),["8202"]:new wc(8202,4215112,"Latn"),["8201"]:new wc(8201,4215112,"Latn"),["8193"]:new wc(8193,4493640,"Arab"),["6154"]:new wc(6154,4215112,"Latn"),["7227"]:new wc(7227,4215112,"Latn"),["19466"]:new wc(19466,4215112,"Latn"),["16394"]:new wc(16394,4215112,"Latn"),["16393"]:new wc(16393,4215112,"Latn"),["16385"]:new wc(16385,4493640,"Arab"),["7194"]:new wc(7194,4215048,"Cyrl"),["7180"]:new wc(7180,20808,"Latn"),["7178"]:new wc(7178,4215112,"Latn"),["7177"]:new wc(7177,4215112,"Latn"),
["7169"]:new wc(7169,4493640,"Arab"),["12289"]:new wc(12289,4493640,"Arab"),["6203"]:new wc(6203,4215080,"Latn"),["15372"]:new wc(15372,4215112,"Latn"),["15370"]:new wc(15370,4215112,"Latn"),["15369"]:new wc(15369,4215112,"Latn"),["15361"]:new wc(15361,4493640,"Arab"),["6170"]:new wc(6170,4215304,"Latn"),["6156"]:new wc(6156,4215112,"Latn"),["18442"]:new wc(18442,4215112,"Latn"),["6153"]:new wc(6153,4215112,"Latn"),["6145"]:new wc(6145,4493640,"Arab"),["4155"]:new wc(4155,4215080,"Latn"),["11274"]:new wc(11274,
4215112,"Latn"),["5179"]:new wc(5179,4215112,"Latn"),["14348"]:new wc(14348,4215112,"Latn"),["14346"]:new wc(14346,4215112,"Latn"),["14345"]:new wc(14345,20808,"Latn"),["14337"]:new wc(14337,4493640,"Arab"),["5146"]:new wc(5146,4215048,"Latn"),["5132"]:new wc(5132,4215112,"Latn"),["5130"]:new wc(5130,4215112,"Latn"),["5129"]:new wc(5129,4215112,"Latn"),["5127"]:new wc(5127,4215112,"Latn"),["5124"]:new wc(5124,4281672,"Hant"),["5121"]:new wc(5121,4493640,"Arab"),["31770"]:new wc(31770,4210820,""),
["31748"]:new wc(31748,4277380,""),["10266"]:new wc(10266,4215048,"Cyrl"),["10252"]:new wc(10252,4215112,"Latn"),["10250"]:new wc(10250,4215112,"Latn"),["10249"]:new wc(10249,4215112,"Latn"),["13324"]:new wc(13324,4215112,"Latn"),["13322"]:new wc(13322,4215112,"Latn"),["13321"]:new wc(13321,4215112,"Latn"),["10241"]:new wc(10241,4493640,"Arab"),["13313"]:new wc(13313,4493640,"Arab"),["4122"]:new wc(4122,4215048,"Latn"),["4108"]:new wc(4108,4215112,"Latn"),["4106"]:new wc(4106,4215112,"Latn"),["4105"]:new wc(4105,
4215112,"Latn"),["4103"]:new wc(4103,4215112,"Latn"),["4100"]:new wc(4100,4282696,"Hans"),["3179"]:new wc(3179,4215048,"Latn"),["4097"]:new wc(4097,4493640,"Arab"),["1085"]:new wc(1085,299432,"Hebr"),["1144"]:new wc(1144,4280616,"Yiii"),["21514"]:new wc(21514,4215112,"Latn"),["2145"]:new wc(2145,5132616,"Deva"),["3131"]:new wc(3131,4215112,"Latn"),["2143"]:new wc(2143,4215432,"Latn"),["12314"]:new wc(12314,4215048,"Cyrl"),["1070"]:new wc(1070,4215080,"Latn"),["1130"]:new wc(1130,4215080,"Latn"),["12300"]:new wc(12300,
4215112,"Latn"),["1091"]:new wc(1091,4215080,"Latn"),["12298"]:new wc(12298,4215112,"Latn"),["12297"]:new wc(12297,4215112,"Latn"),["2055"]:new wc(2055,4215112,"Latn"),["2052"]:new wc(2052,4282664,"Hans"),["2115"]:new wc(2115,4215368,"Cyrl"),["9242"]:new wc(9242,4215304,"Latn"),["3098"]:new wc(3098,4215048,"Cyrl"),["2107"]:new wc(2107,4215112,"Latn"),["9228"]:new wc(9228,4215112,"Latn"),["3084"]:new wc(3084,4215112,"Latn"),["9226"]:new wc(9226,4215112,"Latn"),["3082"]:new wc(3082,4215080,"Latn"),
["3081"]:new wc(3081,4215112,"Latn"),["2094"]:new wc(2094,4215080,"Latn"),["3079"]:new wc(3079,4215112,"Latn"),["2092"]:new wc(2092,4215368,"Cyrl"),["1064"]:new wc(1064,4215080,"Cyrl"),["3076"]:new wc(3076,4281640,"Hant"),["2155"]:new wc(2155,4215048,"Latn"),["3073"]:new wc(3073,4493640,"Arab"),["1153"]:new wc(1153,4215080,"Latn"),["1119"]:new wc(1119,299400,"Arab"),["1086"]:new wc(1086,4215080,"Latn"),["2144"]:new wc(2144,938632,"Deva"),["2077"]:new wc(2077,4215112,"Latn"),["1053"]:new wc(1053,4215080,
"Latn"),["2141"]:new wc(2141,4215336,"Latn"),["2074"]:new wc(2074,4215304,"Latn"),["2073"]:new wc(2073,20808,"Cyrl"),["2072"]:new wc(2072,4215112,"Latn"),["2137"]:new wc(2137,4493896,"Arab"),["2070"]:new wc(2070,4215048,"Latn"),["2068"]:new wc(2068,4215048,"Latn"),["2067"]:new wc(2067,4215112,"Latn"),["1073"]:new wc(1073,4215080,"Latn"),["2064"]:new wc(2064,4215112,"Latn"),["2129"]:new wc(2129,414016,"Tibt"),["2128"]:new wc(2128,4608584,"Mong"),["2060"]:new wc(2060,4215112,"Latn"),["1132"]:new wc(1132,
4215080,"Latn"),["1097"]:new wc(1097,5132584,"Taml"),["2057"]:new wc(2057,4215080,"Latn"),["1164"]:new wc(1164,4493608,"Arab"),["106"]:new wc(106,4210820,""),["2118"]:new wc(2118,4493640,"Arab"),["2117"]:new wc(2117,5132584,"Beng"),["2049"]:new wc(2049,4493640,"Arab"),["1156"]:new wc(1156,4215080,"Latn"),["2110"]:new wc(2110,4215112,"Latn"),["1054"]:new wc(1054,4608296,"Thai"),["2108"]:new wc(2108,4215048,"Latn"),["1083"]:new wc(1083,4215080,"Latn"),["136"]:new wc(136,4210820,""),["1114"]:new wc(1114,
4493608,"Syrc"),["1148"]:new wc(1148,4215080,"Latn"),["1145"]:new wc(1145,20776,"Latn"),["11290"]:new wc(11290,4215304,"Latn"),["1075"]:new wc(1075,20776,"Latn"),["1106"]:new wc(1106,4215080,"Latn"),["1140"]:new wc(1140,4215080,"Latn"),["120"]:new wc(120,4276356,""),["1136"]:new wc(1136,4215080,"Latn"),["1066"]:new wc(1066,4215080,"Latn"),["1098"]:new wc(1098,5132584,"Telu"),["1169"]:new wc(1169,4215048,"Latn"),["11276"]:new wc(11276,4215112,"Latn"),["61"]:new wc(61,295044,"Hebr"),["1060"]:new wc(1060,
4215080,"Latn"),["11273"]:new wc(11273,4215112,"Latn"),["1058"]:new wc(1058,4215080,"Cyrl"),["128"]:new wc(128,4489348,""),["1160"]:new wc(1160,4215080,"Latn"),["1159"]:new wc(1159,4215080,"Latn"),["1158"]:new wc(1158,20776,"Latn"),["1157"]:new wc(1157,4215080,"Cyrl"),["11265"]:new wc(11265,4493640,"Arab"),["1155"]:new wc(1155,4215080,"Latn"),["1154"]:new wc(1154,4215080,"Latn"),["1117"]:new wc(1117,4215080,"Cans"),["1152"]:new wc(1152,4493608,"Arab"),["1115"]:new wc(1115,5132584,"Sinh"),["1150"]:new wc(1150,
4215080,"Latn"),["1113"]:new wc(1113,938280,"Deva"),["1112"]:new wc(1112,938280,"Beng"),["51"]:new wc(51,16516,""),["1146"]:new wc(1146,4215080,"Latn"),["1109"]:new wc(1109,5132584,"Mymr"),["115"]:new wc(115,4210820,""),["1143"]:new wc(1143,4215080,"Latn"),["1142"]:new wc(1142,20872,"Latn"),["1141"]:new wc(1141,4215080,"Latn"),["1104"]:new wc(1104,4215080,"Cyrl"),["2058"]:new wc(2058,4215112,"Latn"),["1102"]:new wc(1102,5132584,"Deva"),["1137"]:new wc(1137,20776,"Latn"),["1100"]:new wc(1100,5132584,
"Mlym"),["1135"]:new wc(1135,4215080,"Latn"),["1134"]:new wc(1134,4215080,"Latn"),["1133"]:new wc(1133,4215080,"Cyrl"),["1096"]:new wc(1096,5132584,"Orya"),["1131"]:new wc(1131,4215048,"Latn"),["1094"]:new wc(1094,5132584,"Guru"),["1129"]:new wc(1129,20872,"Latn"),["1128"]:new wc(1128,4215080,"Latn"),["1127"]:new wc(1127,20776,"Latn"),["1126"]:new wc(1126,20776,"Latn"),["1125"]:new wc(1125,4493608,"Thaa"),["1124"]:new wc(1124,4215080,"Latn"),["1123"]:new wc(1123,4493608,"Arab"),["1122"]:new wc(1122,
4215080,"Latn"),["1121"]:new wc(1121,5132584,"Deva"),["1120"]:new wc(1120,299400,"Arab"),["1118"]:new wc(1118,4215080,"Ethi"),["1082"]:new wc(1082,4215080,"Latn"),["1116"]:new wc(1116,4215080,"Cher"),["1080"]:new wc(1080,4215080,"Latn"),["1079"]:new wc(1079,4215080,"Geor"),["1078"]:new wc(1078,4215080,"Latn"),["1077"]:new wc(1077,4215080,"Latn"),["1111"]:new wc(1111,5132584,"Deva"),["1110"]:new wc(1110,4215080,"Latn"),["1074"]:new wc(1074,4215080,"Latn"),["1108"]:new wc(1108,4608296,"Laoo"),["1107"]:new wc(1107,
4608296,"Khmr"),["1071"]:new wc(1071,4215080,"Cyrl"),["1105"]:new wc(1105,4608296,"Tibt"),["1069"]:new wc(1069,4215080,"Latn"),["1103"]:new wc(1103,5132584,"Deva"),["1067"]:new wc(1067,4215080,"Armn"),["1101"]:new wc(1101,5132584,"Beng"),["1065"]:new wc(1065,4493608,"Arab"),["1099"]:new wc(1099,5132584,"Knda"),["1063"]:new wc(1063,4215080,"Latn"),["1062"]:new wc(1062,4215080,"Latn"),["1061"]:new wc(1061,4215080,"Latn"),["1095"]:new wc(1095,5132584,"Gujr"),["1059"]:new wc(1059,4215080,"Cyrl"),["1093"]:new wc(1093,
5132584,"Beng"),["1092"]:new wc(1092,4215080,"Cyrl"),["1056"]:new wc(1056,4493608,"Arab"),["1090"]:new wc(1090,4215080,"Latn"),["1089"]:new wc(1089,4215080,"Latn"),["1088"]:new wc(1088,4215080,"Cyrl"),["1087"]:new wc(1087,4215080,"Cyrl"),["1052"]:new wc(1052,4215080,"Latn"),["1051"]:new wc(1051,4215080,"Latn"),["1050"]:new wc(1050,4215048,"Latn"),["1049"]:new wc(1049,4215080,"Cyrl"),["1048"]:new wc(1048,4215080,"Latn"),["1081"]:new wc(1081,5132584,"Deva"),["1046"]:new wc(1046,4215048,"Latn"),["1045"]:new wc(1045,
4215080,"Latn"),["1044"]:new wc(1044,4215048,"Latn"),["1043"]:new wc(1043,4215080,"Latn"),["1076"]:new wc(1076,4215080,"Latn"),["1041"]:new wc(1041,4280616,"Jpan"),["1040"]:new wc(1040,4215080,"Latn"),["119"]:new wc(119,4210820,""),["1072"]:new wc(1072,4215176,"Latn"),["1037"]:new wc(1037,4493608,"Hebr"),["1036"]:new wc(1036,4215080,"Latn"),["1035"]:new wc(1035,4215080,"Latn"),["1068"]:new wc(1068,4215080,"Latn"),["1033"]:new wc(1033,4215048,"Latn"),["1032"]:new wc(1032,4215080,"Grek"),["1031"]:new wc(1031,
4215080,"Latn"),["1030"]:new wc(1030,4215080,"Latn"),["1029"]:new wc(1029,4215080,"Latn"),["1028"]:new wc(1028,4281672,"Hant"),["1027"]:new wc(1027,4215080,"Latn"),["1026"]:new wc(1026,4215080,"Cyrl"),["140"]:new wc(140,4489348,""),["1057"]:new wc(1057,4215080,"Latn"),["50"]:new wc(50,4210820,""),["1055"]:new wc(1055,4215080,"Latn"),["135"]:new wc(135,4210820,""),["134"]:new wc(134,16516,""),["133"]:new wc(133,4210820,""),["132"]:new wc(132,4210820,""),["131"]:new wc(131,4210820,""),["130"]:new wc(130,
4210820,""),["129"]:new wc(129,4210820,""),["1047"]:new wc(1047,4215080,"Latn"),["126"]:new wc(126,4210820,""),["89"]:new wc(89,5128324,""),["124"]:new wc(124,4210820,""),["1042"]:new wc(1042,4280616,"Hang"),["122"]:new wc(122,4210820,""),["121"]:new wc(121,16516,""),["1039"]:new wc(1039,4215080,"Latn"),["1038"]:new wc(1038,4215080,"Latn"),["118"]:new wc(118,16516,""),["117"]:new wc(117,4210820,""),["116"]:new wc(116,4210820,""),["1034"]:new wc(1034,4219176,"Latn"),["114"]:new wc(114,4210820,""),
["113"]:new wc(113,16516,""),["112"]:new wc(112,4210820,""),["111"]:new wc(111,4210820,""),["110"]:new wc(110,4210820,""),["109"]:new wc(109,4210820,""),["108"]:new wc(108,4210820,""),["107"]:new wc(107,4210820,""),["1025"]:new wc(1025,4493608,"Arab"),["105"]:new wc(105,16516,""),["104"]:new wc(104,4210820,""),["103"]:new wc(103,4210820,""),["102"]:new wc(102,16516,""),["101"]:new wc(101,4489348,""),["100"]:new wc(100,4210820,""),["99"]:new wc(99,4489348,""),["98"]:new wc(98,4210820,""),["97"]:new wc(97,
5128324,""),["96"]:new wc(96,966788,""),["95"]:new wc(95,4505732,""),["94"]:new wc(94,4210820,""),["93"]:new wc(93,4210820,""),["92"]:new wc(92,4210820,""),["91"]:new wc(91,5128324,""),["90"]:new wc(90,4489348,""),["85"]:new wc(85,5128324,""),["88"]:new wc(88,934020,""),["87"]:new wc(87,5128324,""),["86"]:new wc(86,4210820,""),["9275"]:new wc(9275,4215112,"Latn"),["84"]:new wc(84,4604036,""),["83"]:new wc(83,4604036,""),["82"]:new wc(82,4210820,""),["81"]:new wc(81,4604036,""),["80"]:new wc(80,4604036,
""),["79"]:new wc(79,5128324,""),["78"]:new wc(78,5128324,""),["77"]:new wc(77,5128324,""),["76"]:new wc(76,5128324,""),["75"]:new wc(75,5128324,""),["74"]:new wc(74,5128324,""),["73"]:new wc(73,5128324,""),["72"]:new wc(72,4210820,""),["71"]:new wc(71,4210820,""),["70"]:new wc(70,5128324,""),["69"]:new wc(69,5128324,""),["68"]:new wc(68,4210820,""),["67"]:new wc(67,4210820,""),["66"]:new wc(66,4210820,""),["65"]:new wc(65,4210820,""),["64"]:new wc(64,4210820,""),["63"]:new wc(63,4210820,""),["62"]:new wc(62,
4210820,""),["18441"]:new wc(18441,4215112,"Latn"),["59"]:new wc(59,4210820,""),["58"]:new wc(58,4210820,""),["57"]:new wc(57,5128324,""),["56"]:new wc(56,4210820,""),["55"]:new wc(55,4210820,""),["54"]:new wc(54,4210820,""),["53"]:new wc(53,4210820,""),["52"]:new wc(52,4210820,""),["31"]:new wc(31,4210820,""),["47"]:new wc(47,4210820,""),["49"]:new wc(49,4210820,""),["48"]:new wc(48,4210820,""),["44"]:new wc(44,4210820,""),["46"]:new wc(46,4210820,""),["45"]:new wc(45,4210820,""),["41"]:new wc(41,
4489348,""),["43"]:new wc(43,4210820,""),["42"]:new wc(42,4210820,""),["38"]:new wc(38,4210820,""),["40"]:new wc(40,4210820,""),["39"]:new wc(39,4210820,""),["35"]:new wc(35,4210820,""),["37"]:new wc(37,4210820,""),["36"]:new wc(36,4210820,""),["9225"]:new wc(9225,4215112,"Latn"),["34"]:new wc(34,4210820,""),["33"]:new wc(33,4210820,""),["32"]:new wc(32,4489348,""),["29"]:new wc(29,4210820,""),["30"]:new wc(30,4604036,""),["27"]:new wc(27,4210820,""),["28"]:new wc(28,4210820,""),["9217"]:new wc(9217,
4493640,"Arab"),["26"]:new wc(26,4210820,""),["25"]:new wc(25,4210820,""),["24"]:new wc(24,4210820,""),["23"]:new wc(23,4210820,""),["22"]:new wc(22,4210820,""),["21"]:new wc(21,4210820,""),["20"]:new wc(20,4210820,""),["19"]:new wc(19,4210820,"Latn"),["18"]:new wc(18,4276356,""),["17"]:new wc(17,4276356,""),["16"]:new wc(16,4210820,""),["15"]:new wc(15,4210820,""),["14"]:new wc(14,4210820,""),["13"]:new wc(13,4489348,""),["12"]:new wc(12,4210820,""),["11"]:new wc(11,4210820,""),["10"]:new wc(10,
4210820,""),["9"]:new wc(9,4210820,""),["8"]:new wc(8,4210820,""),["7"]:new wc(7,4210820,""),["6"]:new wc(6,4210820,""),["5"]:new wc(5,4210820,""),["4"]:new wc(4,4278404,""),["3"]:new wc(3,4210820,""),["2"]:new wc(2,4210820,""),["1"]:new wc(1,4489348,""),["0"]:new wc(0,1,"")}}static oe(a){wc.CIe||wc.URc();return wc.CIe[a.toString()]}}wc.CIe=null;wc.SHh=262144;wc.THh=65536;Object(e.a)(wc,"ExtendedCultureInfo",null,[]);class Ql{ZX(a,b){var c=a.sa(tb.a.Rs,1033);sa.a.oe(c)&&(c=wc.oe(c))&&(c.L4b?a.setValue(sb.a.eastAsianFont,
b):c.p$d&&a.setValue(sb.a.complexScriptFont,b));a.setValue(sb.a.latinFont,b)}static rsi(a,b,c){b.baselineFieldSpecified&&(0>b.baselineField?a.me(tb.a.subscript,!0):0<b.baselineField?a.me(tb.a.superscript,!0):(a.me(tb.a.subscript,!1),a.me(tb.a.superscript,!1)));b.bFieldSpecified&&a.me(tb.a.bold,b.bField);b.noProofFieldSpecified&&a.me(Mb.a.noProof,b.noProofField);b.iFieldSpecified&&a.me(tb.a.italic,b.iField);b.strikeFieldSpecified&&a.me(tb.a.strikethrough,b.strikeField);b.uFieldSpecified&&a.me(tb.a.underline,
b.uField);if(b.langField){var f=sa.a.oe(b.langField);f?a.me(tb.a.Rs,f.LCID):Aa.a.J(8958996,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.langField)}b.altLangField&&((f=sa.a.oe(b.altLangField))?a.me(sb.a.bCc,f.LCID):Aa.a.J(8958998,820,50," FormattingHelper::ComposeCharacterProperties - Unable to get culture info for "+b.altLangField));b.hlinkClickField&&(a.me(tb.a.Qs,!0),a.me(tb.a.WZ,!0));Ql.usi(a,b,c)}static USf(a){a>Nl.a.O6c?a=Nl.a.O6c:a<Nl.a.f7c&&(a=
Nl.a.f7c);return Ql.rMi(a)}static usi(a,b,c){b.szFieldSpecified&&a.me(tb.a.fontSize,Ql.USf(b.szField));(c=uf.Box4ColorHelper.fGb(b,c))&&a.setValue(tb.a.fontColor,c.UC);b.latinField&&a.me(sb.a.latinFont,b.latinField.typefaceField);b.eaField&&a.me(sb.a.eastAsianFont,b.eaField.typefaceField);b.csField&&a.me(sb.a.complexScriptFont,b.csField.typefaceField);b.capFieldSpecified&&a.me(Kg.a.capitalization,b.capField);b.symField&&a.me(sb.a.mJb,b.symField.typefaceField)}static rMi(a){return a/(Nl.a.Jgc*Nl.a.k8a)}static wKf(a){return a*
Nl.a.k8a}}Object(e.a)(Ql,"FormattingHelper",null,[1095]);class Ho{u1i(a,b,c){let f="";const l=a.sa(Mb.a.e_,[]);l&&0<=b&&b<l.length&&(a=a.Fh)&&(b=a.te(l[b]))&&b.Sa(sb.a.schemeColor)&&(b=b.getValue(sb.a.schemeColor),(b=xm.SchemeColor.parse(b))?b.rsa?f=Pk.i(b.vP):b.cFe(c)&&(f=Pk.i(b.vP)):Aa.a.J(38606471,826,50,"schemeClr is null."));return f}v1i(a,b){let c="";(a=a.Lid)||Aa.a.J(38088800,826,50,"This shapeNode don't have shapeFont");a&&!a.schemeClrField&&Aa.a.J(38088802,826,50,"The shapeFont don't have schemeClrField.");
a&&a.schemeClrField&&(14===a.schemeClrField.valField?Aa.a.J(38549282,826,50,"The color of shapeFont is W"):13===a.schemeClrField.valField?Aa.a.J(38549312,826,50,"The color of shapeFont is B"):Aa.a.J(38549314,826,50,"The color of shapeFont is unexpected color"),b=uf.Box4ColorHelper.Rfb(a,b),b=Pk.g(b.ZXa),c=Pk.i(b),"000000"===c?Aa.a.J(38549316,826,50,"The resolved color of shapeFont is B"):"FFFFFF"===c?Aa.a.J(38549318,826,50,"The resolved color of shapeFont is W"):Aa.a.J(38549320,826,50,"The resolved color of shapeFont is unexpected color"));
return c}}Object(e.a)(Ho,"NonTableThemeColorHelper",null,[1201]);class Yj{constructor(){this.charsetField=0;this.panoseField=null;this.pitchFamilyField=0;this.typefaceField=null}}Object(e.a)(Yj,"CT_TextFont",null,[]);class Tk{constructor(){this.mQa=this.UXa=null}}Object(e.a)(Tk,"ThemeFont",null,[]);class Fe{static isThemeFont(a){return Fe.gZk.hasOwnProperty(a)}static d6i(a){let b="",c,f;({g6a:c,Ehb:f}=Fe.W5i(a)).returnValue&&(0===c?0===f?b="+Heading":1===f?b="+Heading Asian":2===f&&(b="+Heading CS"):
1===c&&(0===f?b="+Body":1===f?b="+Body Asian":2===f&&(b="+Body CS")));return b}static xhi(a,b,c){const f=[];if(!c||!c.FontScheme)return f;var l=Fe.d_,x=Fe.d_,G=Fe.d_;({MBg:l,M_f:x,UVf:G}=Fe.$Eh(l,x,G,a));({MBg:l,M_f:x,UVf:G}=Fe.$Eh(l,x,G,b));a=c.FontScheme;l!==Fe.d_?(Fe.cFb(a,0,l,Fe.A6c,f),Fe.cFb(a,1,l,Fe.l7c,f)):(l=Fe.D7a(a,0,0),b=Fe.D7a(a,1,0),Fe.Va(l)||Fe.Va(b)||(f.push(Object.assign(new Tk,{UXa:l,mQa:Fe.A6c})),f.push(Object.assign(new Tk,{UXa:b,mQa:Fe.l7c}))));x!==Fe.d_?(Fe.cFb(a,0,x,Fe.z6c,f),
Fe.cFb(a,1,x,Fe.k7c,f)):(x=Fe.D7a(a,0,1),l=Fe.D7a(a,1,1),Fe.Va(x)||Fe.Va(l)||(f.push(Object.assign(new Tk,{UXa:x,mQa:Fe.z6c})),f.push(Object.assign(new Tk,{UXa:l,mQa:Fe.k7c}))));G!==Fe.d_?(Fe.cFb(a,0,G,Fe.y6c,f),Fe.cFb(a,1,G,Fe.j7c,f)):(G=Fe.D7a(a,0,2),x=Fe.D7a(a,1,2),Fe.Va(G)||Fe.Va(x)||(f.push(Object.assign(new Tk,{UXa:G,mQa:Fe.y6c})),f.push(Object.assign(new Tk,{UXa:x,mQa:Fe.j7c}))));return f}static Va(a){return!a||!a.length}static cFb(a,b,c,f,l){a&&c!==Fe.d_&&(c=Fe.Lij(a,b,c),Fe.Va(c)&&(c=Fe.D7a(a,
b,0),Fe.Va(c)&&(c="Arial")),l.push(Object.assign(new Tk,{UXa:c,mQa:f})))}static D7a(a,b,c){let f="";switch(b){case 0:a.majorFontField&&(f=Fe.Fhg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=Fe.Fhg(a.minorFontField,c))}return f}static Fhg(a,b){let c="";if(a)switch(b){case 0:a.latinField&&(c=a.latinField.typefaceField);break;case 1:a.eaField&&(c=a.eaField.typefaceField);break;case 2:a.csField&&(c=a.csField.typefaceField)}return c}static Lij(a,b,c){if(!a||c===Fe.d_)return"";let f="";if(1066===
c)f="Viet";else if(1152===c)f="Uigh";else if(c=wc.oe(c))f=c.v_k;return Fe.Mij(a,b,f)}static Mij(a,b,c){let f="";if(a&&c)switch(b){case 0:a.majorFontField&&(f=Fe.Ehg(a.majorFontField,c));break;case 1:a.minorFontField&&(f=Fe.Ehg(a.minorFontField,c))}return f}static Ehg(a,b){let c="";if(a&&a.fontField&&b){a=a.fontField;for(let f=0;f<a.length;f++){const l=a[f];if(l.scriptField&&l.scriptField.toLowerCase()===b.toLowerCase()){l.typefaceField&&(c=l.typefaceField);break}}}return c}static $Eh(a,b,c,f){if(f!==
Fe.d_){const l=wc.oe(f);l&&(l.L4b?b===Fe.d_&&(b=f):l.p$d?c===Fe.d_&&(c=f):a===Fe.d_&&(a=f))}return{MBg:a,M_f:b,UVf:c}}static W5i(a){switch(a){case Fe.y6c:return{returnValue:!0,g6a:0,Ehb:2};case Fe.z6c:return{returnValue:!0,g6a:0,Ehb:1};case Fe.A6c:return{returnValue:!0,g6a:0,Ehb:0};case Fe.j7c:return{returnValue:!0,g6a:1,Ehb:2};case Fe.k7c:return{returnValue:!0,g6a:1,Ehb:1};case Fe.l7c:return{returnValue:!0,g6a:1,Ehb:0}}return{returnValue:!1,g6a:2,Ehb:0}}static Vqb(a,b){let c=null;if(0===a)switch(b){case 2:c=
Fe.y6c;break;case 1:c=Fe.z6c;break;case 0:c=Fe.A6c}else if(1===a)switch(b){case 2:c=Fe.j7c;break;case 1:c=Fe.k7c;break;case 0:c=Fe.l7c}null===c&&(Aa.a.J(8959518,820,10,"TextFontHelper::CreateTextFont - Invalid text font encountered"),c="");return Object.assign(new Yj,{typefaceField:c,charsetField:1})}}Fe.y6c="+mj-cs";Fe.z6c="+mj-ea";Fe.A6c="+mj-lt";Fe.j7c="+mn-cs";Fe.k7c="+mn-ea";Fe.l7c="+mn-lt";Fe.d_=0;Fe.gZk={["+mj-cs"]:"",["+mj-ea"]:"",["+mj-lt"]:"",["+mn-cs"]:"",["+mn-ea"]:"",["+mn-lt"]:""};Object(e.a)(Fe,
"TextFontHelper",null,[]);class Io{constructor(a,b,c){this.ua=a;this.lc=b;this.O8j=c}kWk(a,b){let c="";var f=a.sa(tb.a.Rs,Fe.d_),l=a.sa(sb.a.bCc,Fe.d_),x=wc.oe(f===Fe.d_?1033:f);if(x){let G="";a.Sa(sb.a.mJb)?G=a.getValue(sb.a.mJb):x.p$d&&a.Sa(sb.a.complexScriptFont)?G=a.getValue(sb.a.complexScriptFont):x.L4b&&a.Sa(sb.a.eastAsianFont)?G=a.getValue(sb.a.eastAsianFont):a.Sa(sb.a.latinFont)&&(G=a.getValue(sb.a.latinFont));if(Fe.isThemeFont(G)){x=!1;let R=null;if(this.O8j){if(b=Object(ua.a)(119,this.lc.ig(b)))R=
b.Pe}else{if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");R=this.ua.Ba.Pe}if(R&&(f=Fe.xhi(f,l,R)))for(l=0;l<f.length;l++)if(G===f[l].mQa){c=f[l].UXa;x=!0;break}x||(c=Fe.d6i(G))}else c=G}c&&a.me(tb.a.font,c)}}Object(e.a)(Io,"FontResolver",null,[1200]);class Mj{constructor(a){this.n3j=a}Wwi(a,b,c){a(tb.a.Rs);a(sb.a.latinFont);a(sb.a.eastAsianFont);a(sb.a.complexScriptFont);a(sb.a.mJb);a(sb.a.bCc);a(sb.a.Pe);a(sb.a.$pb);a(sb.a.hxb);a(sb.a.LM);a(sb.a.schemeColor);a(sb.a.yTc);a(sb.a.TSd);
a(sb.a.QSd);a(sb.a.NSd);a(sb.a.XSd);a(sb.a.x3b);this.n3j.kWk(b(),c)}}Object(e.a)(Mj,"PptFormattingCacheCopyPropertyStrategy",null,[1238]);class sj{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextFormatting"}Wb(a){this.K=a;a.register(1200,"Box4.IFontResolver").ma().na(()=>new Io(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTableFontWithinMultipleThemesFix));a.register(1095,
"PowerPointWebEditor.IFormattingHelper").ma().na(()=>new Ql);a.register(Mj,"PowerPointWebEditor.PptFormattingCacheCopyPropertyStrategy").as("Box4.IFormattingCacheCopyPropertyStrategy").ma().na(()=>new Mj(a.resolve("Box4.IFontResolver")));a.register(1201,"PowerPointWebEditor.INonTableThemeColorHelper").ma().na(()=>new Ho)}init(){this.K.resolve("PowerPointWebEditor.IFormattingHelper");this.K.resolve("PowerPointWebEditor.INonTableThemeColorHelper")}dispose(){}static main(){m.a.instance.Bc(new sj)}}Object(e.a)(sj,
"PPTWebEditorTextFormattingPackage",null,[2,3]);class Vn{constructor(a){this.Xc=a;this.MKh=H.a.instance.ga(115)}txg(a){return this.Yvg(a)?!0:this.MKh?1074135161===a.Oe||1074135162===a.Oe:!1}Xvg(a){return this.Yvg(a)||131162===a.Oe||4325465===a.Oe||1179729===a.Oe}Yvg(a){return 131140===a.Oe||this.Xc.ag&&131120===a.Oe}d_f(a){return ta.a.any(a.sJ,(b,c)=>!this.Xvg(c)&&!this.txg(c))}}Object(e.a)(Vn,"UndoRevisionValidator",null,[1311]);class ip{constructor(){this.Yc=fb.a.instance.qb("Box4.IFeatureHelper")}$Hb(){return u.AFrameworkApplication.fa.ka("AllowMultiUserUndo")}RYa(){return this.$Hb()&&
u.AFrameworkApplication.fa.ka("AllowSmartUndoMerge")}}Object(e.a)(ip,"UndoSettingsManager",null,[1310]);var zl=d(335),Si=d(996),Qg=d(199);class om{Sa(a){return a.Sa(void 0)}Deg(a,b){return a.sa(b,null)}FOc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new Si.a(a)}Geg(a,b){return a.sa(b,"")}Znh(a,b,c){a.setValue(b,c)}}Object(e.a)(om,"MergeableObjectUtilities",null,[390]);class gn{constructor(a,b,c,f,l){this.Mb=a;this.ua=b;this.Ea=c;this.ra=f;this.x_=l}z8c(a,b,c){if(a)if("PowerPointGroupShapes"===
b&&c)for(a=a.sJ,b=[],c=0;c<a.length;++c){var f=a[c];if(f&&393227===f.Oe&&f.Sa(sb.a.N7)){f=(new om).FOc(f,sb.a.N7);for(var l=0;l<f.length;l++){var x=this.ua.Ba;if(!x)throw Error.argumentNull("ActiveSlide is null");const G=this.x_.jca(f.ga(l));x=x.ZB(G.get_shapeId());b.push(x)}this.quj(b)}}else if("PowerPointUngroupShapes"===b&&!c)for(a=a.sJ,b=0;b<a.length;++b)if((c=a[b])&&393227===c.Oe&&c.Sa(sb.a.Nna))for(c=(new om).FOc(c,sb.a.Nna),f=0;f<c.length;f++){l=this.ua.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");
x=this.x_.jca(c.ga(f));l=l.ZB(x.get_shapeId());this.puj(l)}}ZQc(a){if(a){const b=a.sg(this.Mb.Ma);b.ija();b.HGb=!0;this.ra.n7(a)}else Aa.a.J(595359873,815,10,"GroupUngroupUndoRedoActionController::HideAndDeselectShape Trying to Hide and Deselect Null shape.")}quj(a){if(a.length){var b=this.Ea.ds(a[0]);this.ZQc(b);for(const c of a)this.ZQc(c)}}puj(a){this.ZQc(a);if(a.Jf){a=this.Ea.Ow(a);for(const b of a)this.ZQc(b)}}}Object(e.a)(gn,"GroupUngroupUndoRedoActionController",null,[1191]);class pe{DZg(){}z8c(){}eZg(){}FYg(){}bWc(){return!1}}
Object(e.a)(pe,"NoOpTablePartialEditController",null,[1192]);class Jo{constructor(a,b,c,f,l,x){this.Ibb=null;this.pi=a;this.Ea=b;this.ycc=c;this.Zb=f;this.ra=l;this.lLg=x}DZg(){this.Oce()&&this.VPe()}z8c(a){a&&this.Oce()&&(a=this.Ibb,this.VPe(),this.gvh(a))}eZg(a,b,c,f){this.Oce()&&!this.JMj(a,b,c,f)&&this.VPe()}FYg(a,b,c){if(a&&b&&c){this.Ibb=null;a=this.ra.Yd();c=new ef.a;b=b.sJ;for(let l=0;l<b.length;++l){var f=b[l];393230===f.Oe&&f.Sa(sb.a.cellId)&&(f=this.Ea.tn(f),Array.contains(a,f)&&c.$(f.get_shapeId(),
f))}0<c.count&&this.gvh(c.values.ga(0))}}JMj(a,b,c,f){let l=!1;b&&this.bWc(a)&&(f=b.MS&&f,l=(c||f)&&b.actionId===a,this.lLg||(l=(b.actionId===a||this.bWc(b.actionId))&&1===this.ycc.gub(b.t5)||l));return l}bWc(a){let b=a===E.a.KAa||a===E.a.lPa||a===E.a.typing;this.lLg||(b=a===E.a.cB||a===E.a.enter||b);return b}gvh(a){this.Ibb=a}VPe(){if(this.Ibb){const a=this.Zb.Ci.vi.Nw.id;0!==this.ycc.gub(a)&&this.ycc.lzh(a,!1);this.pi.B4a(this.Ibb,!0)}this.Ibb=null}Oce(){return!!this.Ibb}}Object(e.a)(Jo,"TablePartialEditController",
null,[1192]);var jp=d(900);class hn{constructor(a,b,c,f){this.yv=a;this.nbk=c;this.ia=f;this.ub()}ub(){this.ia.pa(ba.a.cfb,sc.a.application,Object(C.a)(this,this.cfb,"queryIsShapeTextEditHappened"),96)}cfb(a,b,c,f,l){l.Rsa=this.Rsa(l.snc,l.PTj);return 32}Blj(a,b,c){this.nbk.Iol(new jp.a(a,b,c))}Rsa(a,b){let c=!1;a&&(c=!this.yv.wUc()&&a.vEa!==b,this.yv.wUc()||a.vEa!==b||Aa.a.J(512493777,820,15,"{0}ViewElement::EndEditing - IsEditingHappened: false. Find localUndoStack is not empty but lastContentSavedTimeBeforeEnterTextEditing not changed",
Object(Ma.a)(4,a)?"Shape":"Notes"));return c}}Object(e.a)(hn,"PPTUndoActionBehavior",null,[1305]);class Uk extends Sys.EventArgs{constructor(a){super();this.actionId=a}}Object(e.a)(Uk,"OnUndoEventArgs",Sys.EventArgs,[]);var In=d(710),Wn=d(136);class Jn extends In.a{constructor(a=null,b=null,c=null){super(a,b);this.jzd=c||new om}UEb(){super.UEb();const a=new Si.a,b=new qa.a;b.add(Ga.a.nil);this.bgb.forEach((l,x)=>{b.add(x);a.add(x);return!0});for(this.objects.forEach(l=>{b.add(l);a.add(l);return!0});0<
a.length;){var c=a.ga(0);a.cTd(0);var f=this.objects.ga(c)||this.wZ.Ctb(c);if(f){c=f;f=c.Mz();for(let l=0;l<f.length;l++){const x=f[l],G=Wn.a.K1b(Wn.a.E7f(x));8===G?this.LDf(this.jzd.Deg(c,x),a,b):9===G&&this.jzd.FOc(c,x).forEach(R=>{this.LDf(R,a,b);return!0})}}else Ea.a.instance.shipAssertTag(17409040,2,!1,"Failed to find [revisedObjectId: {0}]",c)}}LDf(a,b,c){c.contains(a)||(c.add(a),this.zxg(a)&&(c=this.wZ.Ctb(a),this.$ve(c),b.add(a)))}}Object(e.a)(Jn,"ReferenceFollowingRevisionDiffer",In.a,[]);
class Ko{nCi(a,b){return new Jn(a,b)}}Object(e.a)(Ko,"UndoDifferFactory",null,[1297]);var Rl=d(283),z=d(579);class U{constructor(a,b,c,f,l,x,G){a||Rl.a.argument("revisionStore cannot be null","revisionStore");b||Rl.a.argument("undoRevisionValidator cannot be null","undoRevisionValidator");c||Rl.a.argument("undoSettingsManager cannot be null","undoSettingsManager");f||Rl.a.argument("undoDifferFactory cannot be null","undoDifferFactory");l||Rl.a.argument("revisedObjectSpace cannot be null","revisedObjectSpace");
x||Rl.a.argument("undoRevisionMergeStrategy cannot be null","undoRevisionMergeStrategy");this.dWh=a;this.Uzc=b;this.Taa=c;this.JZh=f;this.DRb=l;this.NZh=x;this.y8e=G}LGc(a,b){const c=this.JZh.nCi(a,b);c.UEb();const f=new z.a;f.PPe(this.DRb,a);c.bgb.forEach((G,R)=>{f.bxa(R,G);return!0});const l=new Si.a,x=a.ZS<b.ZS;c.objects.forEach((G,R)=>{if(this.Uzc.txg(R))return!0;if(x&&!this.Uzc.Xvg(R)&&!b.YZ(G)&&!a.YZ(G))return l.add(G),!0;f.Wpa(R);return!0});0<l.length&&Z.ULS.sendTraceTag(22607311,365,100,"Skipping Objects because they're not referenced in base {0} or revised {1}: {2}",
a.id,b.id,l.sr());this.y8e&&this.y8e.Xwl(f);return f.TKc()}oCi(a,b,c,f){b=this.LGc(a,b);if(!b)return null;if(a.id===c.id)return Z.ULS.sendTraceTag(22607312,365,this.Taa.RYa()?15:50,"Undo merge attempted with base and current were the same revision. [AllowSmartUndoMerge: {0}]",this.Taa.RYa()),b;a=this.LGc(a,c);if(!a)return null;var l=b;this.Uzc.d_f(a)?(Z.ULS.sendTraceTag(22607313,365,100,"Merge determined to be necessary for undo."),l=new Si.a,l.add(a),a=new Si.a,a.add(b),l=this.NZh.Qek(f,a,l,c.Kfd).lO.last()):
Z.ULS.sendTraceTag(22607314,365,this.Taa.RYa()?15:50,"Undo merge determined to be not needed because base and current are equivalent. [AllowSmartUndoMerge: {0}]",this.Taa.RYa());return this.LGc(c,l)}pCi(a,b,c,f,l){let x=null;f||(this.Taa.RYa()||!this.Taa.$Hb()?x=this.LGc(c,b):(Z.ULS.sendTraceTag(22607315,365,10,"Trying to skip merge when multi user undo is enabled and smart merge is disabled."),f=!0));f&&(x=this.oCi(a,b,c,l));return x&&this.Ojl(x)?x:null}Ojl(a){return this.Uzc.d_f(a)?(this.dWh.Phb(a),
!0):!1}}Object(e.a)(U,"UndoRevisionManager",null,[1298]);var ka=d(156);class Ba{constructor(a){this.Tff=null;this.Pa=new ic.a;this.Bjb=null;this.Inb=[];this.OZh=a}dispose(){for(;0<this.Inb.length;)this.Seh(this.Inb[0])}get mK(){return this.Bjb}set mK(a){this.Bjb&&(this.Bjb.isActive=!1);if(this.Bjb=a)this.Bjb.isActive=!0}register(a){if(!this.Mja(a)){const b=this.OZh.RDi(a);b.bph(c=>{this.Pa.raiseEvent(Ba.Lrk,new Uk(c))});a.addListener(this);Array.add(this.Inb,b)}}unregister(a){if(a=this.jub(a))a===
this.mK&&(this.mK=null),this.Seh(a)}setActive(a){this.mK=this.jub(a)}SEc(){const a=this.jub(void 0);a&&(a.bna(void 0),this.Rve())}get aW(){return this.oI?this.mK.aW:!1}get rSd(){return this.oI?this.mK.rSd:null}get hja(){return this.oI?this.mK.hja:!1}get XDa(){return this.oI?this.mK.XDa():!1}HPe(a,b){this.oI&&this.mK.HPe(a,b)}Yv(){this.oI&&this.mK.Yv()}VV(){return this.oI?this.mK.VV():null}undo(){return this.oI?this.mK.undo():!1}redo(){return this.oI?this.mK.redo():!1}hWa(a,b,c=!1){this.oI&&this.mK.hWa(a,
b,c)&&(this.Rve(),this.Tff&&this.Tff())}Vye(){this.oI&&this.mK.Vye()}Seh(a){a.graphSpace.removeListener(this);a.bph(null);a.dispose();Array.remove(this.Inb,a)}Mja(a){return!!this.jub(a)}get oI(){return!!this.mK}jub(a){for(let b=0;b<this.Inb.length;b++){const c=this.Inb[b];if(c.HEj(a))return c}return null}Rve(){Cb.App.Hb.updateCommandUI()}j9c(a){this.unregister(a)}onBeforeLoadContent(a){const b=this.jub(a);if(b)b.onBeforeLoadContent(a)}onAfterLoadContent(a){const b=this.jub(a);if(b)b.onAfterLoadContent(a);
this.mK===b&&(this.mK.aW||this.mK.hja)&&this.Rve()}onAfterFirstSaveContent(){}}Ba.Lrk="OnUndo";Object(e.a)(Ba,"UndoManager",null,[1308,354,106,1309]);class Ia extends Ba{constructor(a,b,c){super(a);this.G1j=b;this.l6c=c;this.G1j.n5h(Object(C.a)(this,this.amk,"onFailoverSucceeded"));this.l6c.vId(Object(C.a)(this,this.hnk,"onInitialSelectionSet"))}get nwa(){return this.mK}PGj(a){return this.oI?this.nwa.Aug(a):!1}nOd(){this.oI&&this.nwa.Moi()}z_d(a){return this.oI?this.nwa.z_d(a):null}XMc(a){return this.oI?
this.nwa.XMc(a):0}VQe(){this.oI&&this.nwa.VQe()}get aW(){return this.oI?this.nwa.itj:!1}bna(){this.oI&&this.nwa.bna(!0)}amk(a,b){b.XOj&&this.bna()}hnk(){this.hWa(E.a.ZRa,null)}VUe(a){this.oI&&this.nwa.VUe(a)}wUc(){return this.oI?this.nwa.wUc():!1}f9a(){return this.oI?this.nwa.f9a():!1}}Object(e.a)(Ia,"PPTUndoManager",Ba,[1307,1308,354,106,1309]);class Ab{Qek(a,b,c,f){return a?a.Z6c(b,c,null,f,1,!1,5):null}}Object(e.a)(Ab,"PPTUndoRevisionMergeStrategy",null,[1304]);var Ob=d(140),Yb=d(47);class uc{constructor(a,
b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc){this.yne=!1;this.tge=a;this.YA=b;this.vRg=c;this.BVa=f;this.FGa=l;this.zcb=x;this.Acc=G;R===Yb.a.HC&&(R=Yb.a.Op);this.VIg=R;this.ra=fa;this.Qb=wa;this.Q3j=Wa;this.Zb=mb;this.Fa=Kb;this.ia=nc;this.A$b=oc;this.gcc=Ic;this.Mb=Kc}ZWk(){this.qBh();if(this.YA){var a=this.Qb.kl(this.YA);a&&this.Q3j.Ba!==a&&(this.Zb.Ba=a)}if(this.A$b){if(this.BVa&&0<this.BVa.length){a=[];for(const b of this.BVa){let c=this.Qb.kl(b);c&&a.push(c)}if(0<a.length){let b;(b=this.ra).bY.apply(b,
a)}}this.ia.processAction(ba.a.hYa,2)}}hU(a=!1,b=null){this.ZWk();if(this.yne||this.ttg())return this.yne=!1,null;b||(b=this.Epb());this.setSelection(a,b);return b}Epb(){let a=null;if(0<this.zcb.length){const b=this.Qb.kl(this.YA);if(b){const c=[];for(const f of this.zcb){if(!f)continue;const l=b.DS(f);if(l){const x=l.sg(this.Mb.Ma);x&&!x.HGb&&c.push(rd.SelectionFactory.gl(l))}}0<c.length&&(a=new Ob.SelectionCollection(c,c.length-1))}}a||(a=this.tge.Epb(!0));!a&&this.Acc&&(a=this.Acc.k8f());return a}setSelection(a=
!1,b=null){this.tge.setSelection(a,b);b&&this.Acc&&Aa.a.J(22546640,816,50,"Selection restore to IP level");b||this.VIg!==Yb.a.Bg?this.Fa.Bf(this.VIg):(this.ra.Uh(),this.Fa.Ad())}oDc(){return this.tge.oDc()}qBh(){this.YA=this.mUe(this.YA,this.vRg);const a=[];let b=0;for(const c of this.BVa)a.push(this.mUe(c,this.FGa[b++]));this.BVa=a}mUe(a,b){let c=a;a&&Oe.a.Sw(a)&&(a=this.Qb.G1b(b),a||(b=this.gcc.kfj(b),null!=b&&(a=this.Qb.VCa(b))),a&&(c=a.Bb));return c}ltl(){this.YA=this.mUe(this.YA,this.vRg);this.A$b&&
this.qBh();if(this.zcb.length&&Array.contains(this.zcb,0)){Array.clear(this.zcb);var a=this.Epb();if(this.ra.$Z(a))for(let b of a)(a=Object(ua.a)(4,b.Ua.node))&&this.zcb.push(a.get_shapeId())}}syl(){this.yne=this.ttg()}ttg(){const a=this.Qb.kl(this.YA);if(!a)return!1;var b=this.Acc?[this.Acc.PPd]:this.zcb;for(const c of b)if((b=a.DS(c))&&b.Sp)return!0;return!1}}Object(e.a)(uc,"PPTUndoSelectionReference",null,[450,1306]);class mc{constructor(a,b,c,f,l){this.uc=a;this.she=b;this.dZc=c;this.wcc=f;this.vcc=
l}k8f(){var a=this.uc.kl(this.she);if(!a)return null;a=a.DS(this.dZc);if(!a)return null;a=a.J3d();if(!a)return null;var b=a.sa(tb.a.Lxa,0);const c=a.sa(tb.a.ufa,0);if(!this.wcc||!this.vcc||this.wcc.KJa>=b||this.wcc.IJa>=c||this.vcc.KJa>=b||this.vcc.IJa>=c)return null;b=nb.GraphIterator.mb(a.jf(this.wcc.KJa,this.wcc.IJa));b.pc(14);a=nb.GraphIterator.mb(a.jf(this.vcc.KJa,this.vcc.IJa));a.pc(14);return rd.SelectionFactory.QXb(b,a)}get PPd(){return this.dZc}}Object(e.a)(mc,"PPTUndoTableCellSelectionPos",
null,[1328]);class Ec{constructor(a,b,c,f,l,x,G,R){this.Nb=a;this.uc=b;this.qX=c;this.B1j=f;this.she=l;this.dZc=x;this.v5c=G;this.Nak=R}k8f(){var a=this.uc.kl(this.kvi);if(!a)return null;let b=null;if(10===this.containerType||16===this.containerType)if(b=a.DS(this.PPd),!b)return null;var c=[];switch(this.containerType){case 10:c=this.hZd(b);break;case 16:a=this.Nb.Kc(b);if(!a.Ji()||!a.Ji())return null;if(0>this.KJa||0>this.IJa||this.KJa>=a.currentNode.sa(tb.a.Lxa,0)||this.IJa>=a.currentNode.sa(tb.a.ufa,
0)){this.qX.dWg(a,0,0);c.push(rd.SelectionFactory.rj(a.currentNode,!0));break}this.qX.dWg(a,this.KJa,this.IJa);c=this.hZd(a.currentNode);break;case 60:c=a.VQa();if(!c)return null;c=this.hZd(c);break;default:return null}return 0<c.length?new Ob.SelectionCollection(c,0):null}get PPd(){return this.dZc}hZd(a){const b=[];for(const c of this.pnl){const f=c.SYi(a);f&&b.push(f)}b.length||b.push(rd.SelectionFactory.rj(a,!0));return b}get containerType(){return this.B1j}get kvi(){return this.she}get IJa(){return this.v5c?
this.v5c.IJa:-1}get KJa(){return this.v5c?this.v5c.KJa:-1}get pnl(){return this.Nak}}Object(e.a)(Ec,"PPTUndoTextSelectionPos",null,[1328]);class Yc{constructor(a,b){this.xak=a;this.Fak=b}get IJa(){return this.xak}get KJa(){return this.Fak}}Object(e.a)(Yc,"TableCellIndex",null,[]);class jd{constructor(a,b,c,f,l,x){this.Nb=a;this.Hh=b;this.g8j=c;this.E1j=f;this.B4j=l;this.A4j=x}get contextId(){return this.E1j}get paragraphIndex(){return this.g8j}get r4b(){return this.B4j}get q4b(){return this.A4j}SYi(a){a=
this.Nb.Kc(a);if(!a.J4d(this.paragraphIndex)||11!==a.pq.type||!a.Ab(2)||12!==a.pq.type&&21!==a.pq.type||this.r4b>this.q4b||-1>this.r4b||this.q4b>this.Hh.textLength(a.currentNode))return null;switch(this.contextId){case Bb.a.Of:return rd.SelectionFactory.p2(a.currentNode,this.r4b,this.q4b);case Bb.a.textRange:return rd.SelectionFactory.p2(a.currentNode,this.r4b,this.q4b);case Bb.a.endOfParagraph:return rd.SelectionFactory.xba(a.currentNode);case Bb.a.paragraph:return rd.SelectionFactory.nu(Mc.a.OOa(this.r4b,
this.q4b,!1,a.currentNode))}return null}}Object(e.a)(jd,"TextContextRecord",null,[]);class vd{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){this.a1j=a;this.ra=b;this.rJg=c;this.Zb=f;this.Nb=l;this.Fa=x;this.uc=G;this.Ea=R;this.Hh=fa;this.qX=wa;this.ia=Wa;this.A$b=mb;this.gcc=Kb;this.Mb=nc}Oqa(){const a=this.a1j.Oqa();let b=null,c=Ga.a.nil;const f=this.rJg.Ba;f&&(b=f.Bb,c=f.id);const l=[],x=[];if(this.A$b){var G=this.ra.nf();for(var R of G)l.push(R.Bb),x.push(R.id)}G=[];R=null;f&&(this.ra.JG()&&this.pLk(G),
this.ra.cC()&&(R=this.uLk(b)));return new uc(a,b,c,l,x,G,R,this.Fa.Bba,this.ra,this.uc,this.rJg,this.Zb,this.Fa,this.ia,this.A$b,this.gcc,this.Mb)}GUc(a){return 10===a.type||60===a.type||16===a.type}pLk(a){const b=this.ra.Yd();for(const c of b)a.push(c.get_shapeId())}uLk(a){return this.ra.Oa.kb.hg?this.sLk(a):this.tLk(this.ra.Oa,a)}tLk(a,b){var c=Object(ua.a)(5,a.kb.Ua.node),f=this.Nb.Kc(c);if(f.I5(Object(C.a)(this,this.GUc,"isOEContainerNode")))if(f.yc()&&11===f.currentNode.type){if(f.yc()){c=(c=
this.Ea.hca(c))?c.get_shapeId():0;const l=f.pq.type;f=16===l?this.N3d(Object(ua.a)(127,f.pq)):null;const x=a.kb,G=[];this.lHf(x,G);for(let R of a)R!==x&&this.Cbi(R,x)&&this.lHf(R,G);return new Ec(this.Nb,this.uc,this.qX,l,b,c,f,G)}}else Aa.a.J(22345955,816,15,"Find text selection but its container is not OutlineElement");return null}sLk(a){var b=this.ra.Oa.ga(0),c=this.ra.Oa.last,f=b.hg;b=16===f.Ua.node.type?this.N3d(Object(ua.a)(127,f.Ua.node)):null;f=c.hg;c=16===f.Ve.node.type?this.N3d(Object(ua.a)(127,
f.Ve.node)):null;f=(f=this.Ea.hca(f.Ua.node))?f.get_shapeId():0;return new mc(this.uc,a,f,b,c)}N3d(a){return a?new Yc(a.ni,a.rowIndex):null}lHf(a,b){for(let c of a){if(!Object(Ma.a)(101,c.node))continue;a=this.Nb.Kc(c.node);if(!a.I5(Object(C.a)(this,this.GUc,"isOEContainerNode")))continue;a.yc();const f=a.currentNode;a.yc();a=a.BQa(f);b.push(new jd(this.Nb,this.Hh,a,c.contextId,c.Qa,c.Kb))}}Cbi(a,b){a=this.Nb.Kc(a.Ua.node);b=this.Nb.Kc(b.Ua.node);return a.I5(Object(C.a)(this,this.GUc,"isOEContainerNode"))&&
b.I5(Object(C.a)(this,this.GUc,"isOEContainerNode"))&&a.yc()&&11===a.currentNode.type&&b.yc()&&11===b.currentNode.type&&a.yc()&&b.yc()?a.currentNode===b.currentNode:!1}}Object(e.a)(vd,"PPTUndoSelectionReferenceFactory",null,[429]);class he{constructor(){this.qUa=this.IQg=this.nre=this.TSg=null;this.b1c=!1;this.bte=null}jUe(){if(!this.qUa.Ovb&&this.qUa.S6b)for(const a of this.qUa.S6b)if(a.equals(this.TSg)){this.nre.hU(!1,this.IQg);Aa.a.J(22684815,813,50,"Undo/Redo Success, and E2E time is: {0}ms",
+new Date-+this.bte);this.qUa.vjc(Object(C.a)(this,this.jUe,"trySetSelectionWhenServerUndoRedoFinish"));this.b1c=!0;break}}sOk(a,b,c,f){a&&(this.TSg=b,this.IQg=f,(this.nre=Object(ua.a)(1306,c))?(this.HUe(),this.bte=new Date,this.qUa=a,this.qUa.vBc(Object(C.a)(this,this.jUe,"trySetSelectionWhenServerUndoRedoFinish")),this.b1c=!1):Aa.a.J(21051018,816,15,"The selectionreference is not the type of PPTUndoSelectionReference"))}HUe(){this.qUa&&!this.b1c&&(Aa.a.J(22684818,813,50,"Undo/Redo Fail, and E2E time is: {0}ms",
+new Date-+this.bte),this.qUa.vjc(Object(C.a)(this,this.jUe,"trySetSelectionWhenServerUndoRedoFinish")),this.b1c=!0)}}Object(e.a)(he,"PPTUndoSelectionRestoreExecutor",null,[1190]);class nd{constructor(){this.mak=new ef.a(!1);this.pbk=new ef.a(!1);this.gNg=new ef.a(!1);this.init()}init(){this.qyj()}qyj(){this.gNg.add(ba.a.WM,!0)}yxi(a){return a&&this.mak.Jb(a)?!0:!1}xxi(a){return a&&this.pbk.Jb(a)?!1:!0}Pal(a){return a&&this.gNg.Jb(a)?!0:!1}}Object(e.a)(nd,"PPTUndoSettings",null,[1303]);class ee{constructor(a){this.Fj=
null;this.UZe=a}start(a){this.Fj=a}Usj(){var a=new Date;return this.UZe?+a-+this.Fj>this.UZe:!1}}Object(e.a)(ee,"UndoTimer",null,[1326]);var Ue=d(471),n=d(512);class Y{constructor(a){this.oaa=this.N1=null;this.Orb=this.Mmc=a}get Mmc(){return this.N1}set Mmc(a){this.N1&&(this.N1.qO&=-2);this.N1=a;this.N1.qO|=1}get Orb(){return this.oaa}set Orb(a){this.oaa&&(this.oaa.qO&=-3);this.oaa=a;this.oaa.qO|=2}get t5(){return this.N1?this.N1.id:Ga.a.nil}get pVd(){return this.oaa?this.oaa.id:Ga.a.nil}get sJ(){return this.N1?
this.N1.mCg():[]}combineWithPrevious(){}dispose(){this.N1&&(this.N1.qO&=-2);this.oaa&&(this.oaa.qO&=-3)}}Object(e.a)(Y,"Box4UndoRecordData",null,[1339,106]);class ra{constructor(a,b,c,f,l,x){this.Uwa=a;this.pgb=b;this.KZh=c;this.actionId=f;this.MS=l;this.CIa=x}get S0(){return this.KZh}get t5(){return this.S0.t5}dispose(){this.S0&&this.S0.dispose()}}Object(e.a)(ra,"UndoRecord",null,[106]);class Pa{constructor(){this.Jpa=[]}ga(a){return this.Jpa[a]}get length(){return this.Jpa.length}add(a){this.Jpa.push(a)}clear(){for(let a=
0;a<this.Jpa.length;a++)this.Jpa[a].dispose();Array.clear(this.Jpa)}remove(a){const b=Array.remove(this.Jpa,a);b&&a.dispose();return b}removeAt(a){0<=a&&a<this.Jpa.length&&(this.Jpa[a].dispose(),Array.removeAt(this.Jpa,a))}}Object(e.a)(Pa,"UndoRecordsArray",null,[]);class eb{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We){this.x2a=!0;this.R0a=this.v6e=this.Fuc=this.Zmb=!1;this.Wkb=null;this.bAd=this.whf=0;this.HGd=null;this.mxf=!0;this.isActive=!1;this.wz=a;this.yrd=b;this.FRh=
c;this.Aud=f;this.K_h=l;this.RTh=x;this.rk=G;this.yH=R;this.iuf=fa;this.BWh=wa;this.Rd=Wa;this.CZh=mb;this.KWh=Kb;this.Qsf=nc;this.LZh=Ic;this.oAf=Kc;this.PZh=Hc;this.qAf=ie;this.Taa=He;this.vy=Te;this.Kg=new Pa;this.Yr=this.qh=-1;this.S7e=Object(C.a)(this,this.wUf,"createInitialUndoRecord");this.$xc=oc;this.$xc.F7h(Object(C.a)(this,this.Reh,"removeUndoRecordForRevision"));this.mxf=We}dispose(){this.S7e=null;this.SEc();this.wz=null;this.$xc.FSk(Object(C.a)(this,this.Reh,"removeUndoRecordForRevision"))}get graphSpace(){return this.wz}get whc(){return this.FRh.value}HEj(a){return this.wz===
a?!0:!1}SEc(){this.Kg.clear();this.Yr=this.qh=-1;this.x2a=!0}lpi(){if(this.qh===this.Kg.length-1)this.SEc();else{let a=0;for(;a<this.qh;)this.Kg.removeAt(0),a++;this.qh=0;this.Yr=1}}get aW(){return 0<this.qh}get rSd(){return this.aW?this.Kg.ga(this.qh).actionId:null}get sSd(){return 0<=this.qh&&this.qh<this.Kg.length?this.Kg.ga(this.qh).S0:null}HPe(a,b){this.R0a?(this.ync(),this.bna()):(this.Qsf&&this.whc.suspend(),this.R0a=!0,this.Wkb=a,this.whf=b,this.bAd=0)}ync(){this.R0a=!1;this.Qsf&&this.whc.resume()}Stl(){this.KWh(new Ga.a(this.Wkb,
1));this.ync()}hWa(a,b,c=!1){if(!this.yrd()||a===E.a.ZRa&&this.Kg.length)return!1;var f=this.wz.FS();if(!f&&a!==E.a.ZRa&&!c||!this.wz||!this.wz.vi)return!1;f&&(this.v6e||(Z.ULS.sendTraceTag(39102051,305,50,"Real Edit occurred"),this.v6e=!0),this.Aud.execute(x=>{x.SUd()}));if(this.R0a){Z.ULS.sendTraceTag(23171273,365,50,"Incremental action {0} interrupted by user edits. Cancelling action.",this.Wkb);this.ync();for(c=this.Kg.length-2;0<=c;c--)this.Kg.removeAt(c);this.qh=0;this.Yr=-1}c=this.VV();f=this.bHc(f,
a);this.qrb();b=this.wri(a,f,b);const l=this.Taa.$Hb()&&!this.Taa.RYa();a=new ra(b,c,f,a,this.Zmb,l);this.Kg.add(a);this.qh=this.Kg.length-1;return!0}bHc(a,b){return this.LZh(a,b)}wri(a,b,c){if(0<=this.qh){switch(a){case E.a.KAa:case E.a.lPa:case E.a.typing:this.x2a&&this.Kg.ga(this.qh).actionId===a?(a=this.Kg.ga(this.qh),c=a.Uwa,b.combineWithPrevious(a.S0),this.Kg.removeAt(this.qh)):u.AFrameworkApplication.fa.ka("OtelSendTypingUserActionDisabled")||(b=this.CZh.create(a),b.end(32),this.K_h.Zic(b),
this.RTh.Yic(b))}this.x2a=!0}return c}Vye(){this.PZh(this)}FIi(){this.mxf&&!this.x2a||!this.Taa.$Hb()||(this.x2a=!1,this.Zmb=!0)}hdk(){if(this.Taa.RYa())for(let a=0;a<this.Kg.length;a++)this.Kg.ga(a).CIa=!0}qrb(){if(this.qh<this.Kg.length-1){for(let a=this.Kg.length-1;a>this.qh;a--)this.Kg.removeAt(a);this.Yr=-1}}Yxl(){var a=ka.ObjectSpace.D7(this.wz.vi);a=new Y(a);const b=this.VV(),c=this.Kg.ga(this.qh).Uwa;a=new ra(c,b,a,E.a.wnd,this.Kg.ga(this.qh).MS,this.Kg.ga(this.qh).CIa);this.Kg.removeAt(this.Kg.length-
1);this.Kg.add(a)}Seb(a,b,c,f){return a.Seb(b,c,f)}oAe(a,b,c){this.Fuc=!0;a.lee();this.Fuc=!1;b.hU(void 0,c)}undo(){if(!this.aW)return!1;this.Aud.execute(wa=>{wa.SUd()});var a=!0;let b=!1;var c=!1;const f=this.rk.ke(7);f.gd(this.wz);let l=0,x=!1,G=this.VV(),R=null;const fa=this.oAf(!0);for(this.qAf.start(new Date);this.aW&&a;){const wa=this.Kg.ga(this.qh),Wa=this.Kg.ga(this.qh-1);a=wa.MS&&Wa.MS;Z.ULS.sendTraceTag(22607296,365,50,"Performing Undo [IsContinuation: {0}], [AppMode: {1}]",a,n.a[this.vy]);
this.Yr=this.qh;try{if(b=this.Seb(fa,wa.S0,Wa.S0,wa.CIa||Wa.CIa))G=this.Kg.ga(this.qh).Uwa,R=this.Kg.ga(this.Yr).pgb,this.HGd&&this.HGd(this.Kg.ga(this.qh).actionId)}catch(mb){Z.ULS.sendTraceTag(22607297,365,10,"Undo hit an exception: {0}. Callstack: {1}",mb.message,mb.stack),b=!1,c=!0}l++;b?this.qh--:(Z.ULS.sendTraceTag(22607298,365,15,"Undo failed. [HitException: {0}] [AppMode: {1}]",c,n.a[this.vy]),this.lpi(),a=!1);if(this.qAf.Usj()){x=!0;break}}b&&this.oAe(fa,G,null,R,!0);f.dispose();this.Yv();
this.R0a&&(this.Stl(),this.qrb());this.yH.updateCommandUI();this.iuf.s$();if(0<this.qh&&x&&this.Kg.ga(this.qh).MS){a=this.qh;for(c=0;0<a&&this.Kg.ga(a).MS;)c++,a--;this.Kg.ga(this.qh).MS=!1;Z.ULS.sendTraceTag(22607299,365,50,"Cascading undos exceed the time limit, [MergesDone: {0}], [MergesToBeDone: {1}].",l,c)}else 1<l&&Z.ULS.sendTraceTag(22607300,365,50,"Cascading undos within the time limit, [MergesDone: {0}]",l);return b}Yv(){this.Zmb=this.x2a=!1}get hja(){return 0<this.Yr}redo(){if(!this.hja)return!1;
this.Aud.execute(G=>{G.SUd()});var a=!0;let b=!1,c=!1;const f=this.rk.ke(7);f.gd(this.wz);let l=this.VV();const x=this.oAf(!1);for(;this.hja&&a;){a=this.Kg.ga(this.Yr);const G=this.Kg.ga(this.qh);Z.ULS.sendTraceTag(22607301,365,50,"Performing Redo [IsContinuation: {0}] [AppMode: {1}]",this.Kg.ga(this.Yr).MS&&this.Kg.ga(this.qh).MS,n.a[this.vy]);try{if(b=this.Seb(x,a.S0,G.S0,a.CIa||G.CIa))l=this.Kg.ga(this.Yr).pgb}catch(R){Z.ULS.sendTraceTag(22607302,365,10,"Redo hit an exception: {0}. Callstack: {1}",
R.message,R.stack),b=!1,c=!0}b?(this.qh=this.Yr,this.Yr<this.Kg.length-1?(this.Yr++,a=this.Kg.ga(this.Yr).MS&&this.Kg.ga(this.qh).MS):(this.Yr=-1,a=!1)):(Z.ULS.sendTraceTag(22607303,365,15,"Redo failed. [HitException: {0}] [AppMode: {1}]",c,n.a[this.vy]),this.bna(),a=!1)}b&&this.oAe(x,l,null,null,!1);f.dispose();this.Yv();this.yH.updateCommandUI();this.iuf.s$();return b}VV(){return this.yrd()?this.BWh.Oqa():null}EDk(a){return this.R0a&&zh.a.compare(a.tq,this.Wkb)?(Z.ULS.sendTraceTag(512362002,365,
50,"Incremental Action in progress"),this.Yxl(),this.bAd=a.n,this.bAd===this.whf&&(Z.ULS.sendTraceTag(23171274,365,100,"Incremental Action {0} was completed successfully",this.Wkb),this.ync()),!0):!1}onBeforeLoadContent(){}onAfterLoadContent(a){if(!this.Fuc&&!this.EDk(a.vi.Nw.id))if(this.R0a&&(Z.ULS.sendTraceTag(23171276,365,50,"Incremental action {0} terminated due to inbound revision with ID {1}",this.Wkb,this.wz.vi.Nw.id),this.ync()),!this.Taa.$Hb())this.bna();else if(this.hja||this.aW)this.FIi(),
this.hdk()}bna(a=!1){this.SEc();a?this.wUf(null):(a=new xe.a(2,1,0,this.S7e,50),this.Rd.Cb(a))}Reh(a,b){if(b&&(1===(b.qO&1)||2===(b.qO&2))){a=this.hja;const f=this.aW;for(var c=this.Kg.length-1;0<=c;c--){const l=Object(ua.a)(Y,this.Kg.ga(c).S0);!l||l.Mmc!==b&&l.Orb!==b||(this.Kg.removeAt(c),-1!==this.qh&&this.qh--,-1!==this.Yr&&this.Yr--)}b=this.hja;c=this.aW;!this.isActive||a===b&&f===c||(Z.ULS.sendTraceTag(36218332,365,15,"UndoRedo status is changed by revision removal:{0},{1},{2},{3}.",a,b,f,c),
this.yH.updateCommandUI())}}wUf(){this.yrd()&&this.hWa(E.a.ZRa,this.VV())}XDa(){return this.Fuc}bph(a){this.HGd=a}}Object(e.a)(eb,"UndoStack",null,[1342,106]);var Eb=d(779);class Sb extends Sys.EventArgs{constructor(a){super();this.state=a}}Object(e.a)(Sb,"RevisionStateArgs",Sys.EventArgs,[]);class ub{constructor(a,b,c,f,l,x){this.Uwa=a;this.pgb=b;this.t5=c;this.actionId=f;this.MS=l;this.CIa=x}}Object(e.a)(ub,"PPTLocalUndoRecord",null,[]);class wb extends eb{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,
Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg,Sf,uh,Sg,li,Ui,Cj,jj,kj){super(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,Mg,jj,4,kj);this.q1c=!1;this.jbc=-1;this.tL=[];this.HT=He;this.dqe=fe;this.bqe=Te;this.Nb=We;this.la=Qf;this.Ela=mg;this.Fa=Xg;this.pUa=Sf;this.pUa.yFf(Object(C.a)(this,this.FDb,"onRevisionProcessed"));this.Scb=uh;this.ra=Sg;this.ate=li;this.aMg=Ui;this.USg=Cj;this.zNg=Mg.$Hb()&&!Mg.RYa()}hWa(a,b,c=!1){let f=!1;b=this.USg.pyl(b);var l=this.qh;this.dqe.Pal(a)?f=this.vdk(a,b):
this.dqe.xxi(a)?(f=this.Bki(a,b,c))&&this.xrl(a):this.bna();b=null;f?(l=this.qh-l,b=this.d2b(this.qh),this.$Kk(b,!l),this.f9a()||this.QVd()):this.USg.ECj();l=null;this.la.designerSendActionDuration&&b&&b.S0&&b.S0.pVd!==Ga.a.nil&&(l=b.S0.pVd);this.bqe.Blj(a,f,l);return f}bHc(a,b){const c=0<=this.qh?this.Kg.ga(this.qh):null;this.Scb.eZg(b,c,this.x2a,this.Zmb);b=super.bHc(a,b);this.Scb.FYg(c,b,a);return b}Aug(a){let b=!1,c=null;a&&this.aW?c=this.Kg.ga(this.qh):!a&&this.hja&&(c=this.Kg.ga(this.Yr));c&&
(b=this.mUc(c.t5));return b&&this.f9a()}Seb(a,b,c,f){let l=!1;if(this.Aug(a.L9a))(l=super.Seb(a,b,c,f))&&this.odk(a.Vja);else{const x=a.L9a?2:3;l=a.e$g(G=>{this.HT.iEh(G,x)});this.cdk(a.Vja);this.pUa.Pdd(new Sb(0))}return l}onBeforeLoadContent(a){super.onBeforeLoadContent(a);this.q1c&&this.pUa.Pdd(new Sb(2))}onAfterLoadContent(a){super.onAfterLoadContent(a);this.q1c&&(this.pUa.Pdd(new Sb(3)),this.q1c=!1)}dispose(){this.pUa.Hfh(Object(C.a)(this,this.FDb,"onRevisionProcessed"));super.dispose()}oAe(a,
b,c,f,l){a&&a.Vja!=Ga.a.nil&&(this.aMg&&(f&&this.sEh(f),b&&this.sEh(b)),0<this.tL.length&&(f=new ub(this.VV(),b,a.Vja,l?ba.a.Oeb:ba.a.Neb,!1,this.zNg),Array.add(this.tL,f)),a.lee(),b&&0<this.tL.length?b.hU(void 0,c):(Nc.a.Eb&&(Nc.a.Lea(Nc.a.Eb),Nc.a.Eb.sB(si.a.UX,Nc.a.t7a(a.Vja.toString()).toString())),this.aMg&&(f=Object(ua.a)(140,this.wz.contentReplicator))&&b&&this.ate.sOk(f,a.Vja,b,c)))}FDb(a,b){b&&(!(a=b.o$)||2!==a.RevisionSource&&3!==a.RevisionSource||(this.q1c=!0,this.la.Fug||(b=2===a.RevisionSource?
Object(ua.a)(1306,this.Kg.ga(0<this.Yr?this.Yr:this.Kg.length-1).Uwa):Object(ua.a)(1306,this.Kg.ga(this.qh).pgb))&&b.syl(),this.$Ni(a.ServerUndoStackLength,a.ServerRedoStackLength,a.LastServerUndoFail,a.LastServerRedoFail),this.pUa.Pdd(new Sb(1))))}$Ni(a,b,c,f){a!==this.qh&&Aa.a.J(512362001,823,50,"Undo stack length not synced. Server length: {0}, client: {1}",a,this.qh);if(a<this.qh||f){do this.Kg.removeAt(this.qh--);while(this.qh>a);this.Yr=0<this.Yr?this.qh+1:-1;this.ate.HUe()}if(!(0>this.Yr)&&
(b!==this.Kg.length-this.Yr&&Aa.a.J(512362E3,823,50,"Redo stack length not synced. Server length: {0}, client: {1}",b,this.Kg.length-this.Yr),b<this.Kg.length-this.Yr||c)){do this.Kg.removeAt(this.Yr);while(this.Kg.length-this.Yr>b);if(!b||this.Yr>=this.Kg.length)this.Yr=-1;this.ate.HUe()}}sEh(a){(a=Object(ua.a)(1306,a))&&a.ltl()}Moi(){if(this.la.gwb&&this.tL.length){var a=this.d2b(this.qh);if(a){var b=a.Uwa;if(this.mUc(a.t5)){for(let c=this.qh-1;0<c;c--){const f=this.d2b(c);if(!f)break;if(this.mUc(f.t5))b=
f.Uwa,this.Kg.removeAt(c),this.qh--;else break}this.qrb()}else this.Kg.add(a),this.qh++,this.Yr=-1;a.Uwa=b;a.MS=!1;this.qfd();this.QVd()}else this.qrb(),this.qfd()}}VQe(){if(this.la.gwb){var a=this.d2b(this.qh);if(a){if(0<(-1===this.jbc?0:this.Kg.length-this.jbc)){for(var b=this.Kg.length-1;b>=this.jbc;b--)this.Kg.removeAt(b);for(b=0;0<=b&&b<this.tL.length;){var c=b;let f=!0;for(;f&&b<this.tL.length;)b<this.tL.length-1?(f=this.tL[b].MS&&this.tL[b+1].MS,b++):(f=!1,b=-1);c=this.tL[c];this.Kg.add(new ra(c.Uwa,
this.tL[0>b?this.tL.length-1:b-1].pgb,a.S0,c.actionId,!1,c.CIa))}this.qh=this.Kg.length-1}this.Yr=-1;this.qfd();this.QVd()}else this.qrb(),this.qfd()}}get itj(){if(this.la.gwb&&this.f9a()){const a=this.d2b(this.qh);if(!a||0<this.tL.length&&!this.mUc(a.t5))return!1}return this.aW}QVd(){var a=this.la.oek;if(this.qh>a){var b=0;for(a=this.qh-a-1;0<=a;a--)this.Kg.removeAt(a),b++;this.qh-=b;b=this.Yr-b;this.Yr=0<b?b:-1}}Bki(a,b,c){const f=0<=this.qh?this.Kg.ga(this.qh):null;this.Zmb=!!f&&this.Scb.bWc(a)&&
f.actionId===a&&this.Zmb;return super.hWa(a,b,c)}$Kk(a,b){this.la.gwb&&a&&(this.f9a()||this.dqe.yxi(a.actionId))&&(this.tL.length||(this.jbc=this.qh),b&&Array.removeAt(this.tL,this.tL.length-1),Array.add(this.tL,new ub(a.Uwa,a.pgb,a.t5,a.actionId,a.MS,a.CIa)))}d2b(a){return 0<a&&a<=this.qh?this.Kg.ga(a):null}z_d(a){a=a?this.qh:this.Yr;return 0<=a&&a<this.Kg.length?this.Kg.ga(a).S0:null}XMc(a){a=a?this.qh:this.Yr;return 0<=a&&a<this.Kg.length?this.Kg.ga(a).actionId:0}qfd(){Array.clear(this.tL);this.jbc=
-1}f9a(){const a=this.Fa.ze;return a?a.name!==Yb.a.Bg&&a.name!==Yb.a.Gva&&a.name!==Yb.a.sU&&a.name!==Yb.a.JJa&&a.name!==Yb.a.tO||!this.ra.cC()||this.SFj()?!1:!0:!1}Phb(a){ka.ObjectSpace.N2(this.graphSpace.vi,!1).Phb(a)}xrl(a){this.la.gwb||this.wrl(a);this.vrl(a)}wrl(a){if(1<=this.qh&&this.nAg(a)){const b=this.qh-1,c=this.Kg.ga(b),f=c.actionId;f!==a&&!this.nAg(f)||1!==this.Ela.gub(c.t5)||(this.Kg.removeAt(b),this.qh=this.Kg.length-1)}}vrl(a){if(1<=this.qh&&this.wEj(a)){const b=this.qh-1,c=this.Kg.ga(b).actionId;
if(c===a||this.$Gj(c))this.Kg.removeAt(b),this.qh=this.Kg.length-1}}nAg(a){return a===E.a.cB||a===E.a.KAa||a===E.a.lPa||a===E.a.typing||a===E.a.enter}$Gj(a){return a===ba.a.DAa||a===ba.a.Ead}wEj(a){return a===ba.a.Iob||a===ba.a.Fad||a===ba.a.cgc}vdk(a,b){const c=this.bHc(this.wz.FS(),a);this.qrb();a=new ra(b,null,c,a,!1,this.zNg);this.Kg.add(a);this.qh=this.Kg.length-1;return!0}odk(a){let b=null;this.ra.Ija()?b=this.ra.qfg():this.ra.cC()&&(b=this.ra.rq());b&&this.pUa.Pbh(new Eb.a(b,a))}cdk(a){const b=
this.Nb.Kc(this.graphSpace);b.Ab(80);Object(ua.a)(526,b.pq).isDirty=!0;this.pUa.Pbh(new Eb.a(b.currentNode,a))}VUe(a){0>this.qh||(this.Kg.ga(this.qh).pgb=a)}wUc(){return!this.tL.length}mUc(a){for(const b of this.tL)if(b.t5===a)return!0;return!1}SFj(){for(const a of this.ra.Yd())if(a.getValue(sb.a.clearFormatting))return!0;return!1}}Object(e.a)(wb,"PPTUndoStack",eb,[]);class ec{constructor(a){this.obk=a}RDi(a){const b=this.obk.NVf(a);return new wb(a,()=>!!pa.InteractiveViewManager.instance.Nd,new Sa.a(()=>
Cb.App.kR),fb.a.instance.Ka("Common.Interface.IEditNotificationManager"),ci.a.getInstance(),dj.a.getInstance(),fb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),fb.a.instance.resolve("Box4.IAppFrame"),fb.a.instance.resolve("Box4.IReplicationScheduler"),fb.a.instance.resolve("Box4.ISelectionReferenceFactory"),fb.a.instance.resolve("Common.ITaskManager"),fb.a.instance.resolve("Box4.ITypingActionOperationFactory"),()=>{},H.a.instance.ga(70),Ue.a.instance,b.TBh,b.UBh,b.YBh,new ee(Cb.App.kOf),
fb.a.instance.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),fb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSettings"),fb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),fb.a.instance.resolve("Box4.Graph.IGraphIteratorFactory"),fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings"),fb.a.instance.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader"),fb.a.instance.resolve("Common.IFocusManager"),fb.a.instance.resolve("Box4.UndoRedo.IUndoSettingsManager"),
fb.a.instance.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),fb.a.instance.resolve("PowerPointWebEditor.ITablePartialEditController"),fb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),fb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor"),fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled,fb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater"),
fb.a.instance.le("Box4.ICoauthCashTelemetry"),Object(re.a)("SkipEnablingCascadeUndoIfNotCombiningUndoRecords"))}}Object(e.a)(ec,"PPTUndoStackFactory",null,[1302]);class kc{constructor(){this.CZc=new ic.a}Iol(a){this.CZc.raiseEvent("MU",a)}aUb(a){this.CZc.addHandler("MU",a)}eGe(a){this.CZc.removeHandler("MU",a)}dispose(){this.CZc.dispose()}}Object(e.a)(kc,"UndoEventSource",null,[1299,1300,1301,106]);class bd{constructor(a,b){this.$cb=0;this.u4c=null;this.xne=!1;this.yv=a;this.Hk=b;this.Hk.LEf(Object(C.a)(this,
this.dZg,"onBeforeForceOutboundGraphTransactionInitialize"));this.Hk.KEf(Object(C.a)(this,this.g9c,"onForceOutboundGraphTransactionDisposed"))}dispose(){this.Hk.Zeh(Object(C.a)(this,this.dZg,"onBeforeForceOutboundGraphTransactionInitialize"));this.Hk.lRk(Object(C.a)(this,this.g9c,"onForceOutboundGraphTransactionDisposed"))}pyl(a){return 1===this.$cb&&this.u4c?this.u4c:a}ECj(){1===this.$cb&&(this.xne=!0)}dZg(a,b){this.pAg(b.transaction.aya)&&(this.$cb+=1,1===this.$cb&&(this.u4c=this.yv.VV()))}g9c(a,
b){this.pAg(b.transaction.aya)&&(1===this.$cb&&(this.u4c=null,this.xne||(a=this.yv.VV(),this.yv.VUe(a)),this.xne=!1),--this.$cb)}pAg(a){return 8===(a&8)}}Object(e.a)(bd,"UndoSelectionUpdater",null,[1193,106]);var Ad=d(584);class Vd{constructor(a,b,c){this.wz=a;this.Hxd=b;this.cGd=c;this.KY=ka.ObjectSpace.D7(this.wz.vi)}Seb(a,b,c){a=this.cGd.pCi(this.Hxd?a.Mmc:b.Orb,this.Hxd?b.Orb:a.Mmc,this.KY,c,Cb.App.WJa);if(b=!!a)this.KY=a;return b}e$g(a){const b=new z.a;b.PPe(this.wz.vi,this.KY);a(b);a=b.TKc();
ka.ObjectSpace.N2(this.wz.vi,!1).Phb(a);this.KY=a;return!!a}lee(){const a=new Ad.a(ka.ObjectSpace.D7(this.wz.vi),this.KY);this.wz.Axb(a)}get L9a(){return this.Hxd}get Vja(){return this.KY.id}}Object(e.a)(Vd,"Box4UndoRedoPerformer",null,[1338]);class df{constructor(a,b){this.TBh=c=>{c&&this.wz.Yea();c=ka.ObjectSpace.D7(this.wz.vi);return new Y(c)};this.UBh=c=>new Vd(this.wz,c,this.cGd);this.YBh=c=>{if(c.sSd&&(this.wz.FS()&&this.wz.Yea(),c.sSd&&(c=c.sSd))){var f=ka.ObjectSpace.D7(this.wz.vi);c.Orb=
f}};this.wz=a;this.cGd=b}}Object(e.a)(df,"Box4UndoStackDataSyncHelper",null,[1324]);class zg{constructor(a){this.MZh=a}NVf(a){return new df(a,this.MZh(a.vi))}}Object(e.a)(zg,"Box4UndoStackDataSyncHelperFactory",null,[1295]);class Rg{constructor(a,b,c){this.kcb=[];this.XBb=a;this.$3c=b;this.Bac=c}get t5(){return this.$3c}get pVd(){return this.$3c}get sJ(){return this.kcb}perform(){try{if(this.XBb){const a=this.XBb.perform();this.XBb=a.undoOperation;this.kcb=h(a.dQc,this.Bac);return a}}catch(a){Z.ULS.sendTraceTag(0,
844,10,"FluidUndoRecordData.tryPerform exception: {0}.",a)}return null}combineWithPrevious(a){a&&a.XBb&&this.XBb.combineWithPrevious(a.XBb)}dispose(){}}Object(e.a)(Rg,"FluidUndoRecordData",null,[1339,106]);class hh{constructor(a,b){this.M9b=[];this.yab=a;this.o6j=b}Seb(a){return a?(a=a.perform(),this.s9g(a)):!1}e$g(a){const b=this.yab.vi.mKi.zGc();b.start(this.yab.vi);a(b);a=b.finish();return this.s9g(a)}lee(){this.M9b.forEach(a=>{this.yab.Axb(a)})}get L9a(){return this.o6j}get Vja(){return 0<this.M9b.length?
this.M9b[this.M9b.length-1].Uja:Ga.a.nil}s9g(a){return a?(a.dQc&&this.M9b.push(...a.dQc),!0):!1}}Object(e.a)(hh,"FluidUndoRedoPerformer",null,[1338]);class ph{constructor(a){this.TBh=b=>{var c,f;let l=null;b&&(l=this.yab.Yea());return new Rg(null!==(c=null===l||void 0===l?void 0:l.undoOperation)&&void 0!==c?c:null,null!==(f=null===l||void 0===l?void 0:l.revisionId)&&void 0!==f?f:Ga.a.nil,this.yab.vi)};this.UBh=b=>new hh(this.yab,b);this.YBh=()=>{};this.yab=a}}Object(e.a)(ph,"FluidUndoStackDataSyncHelper",
null,[1324]);class dg{NVf(a){return new ph(a)}}Object(e.a)(dg,"FluidUndoStackDataSyncHelperFactory",null,[1295]);class Zj{constructor(a){this.HT=a}Xwl(a){this.HT.iEh(a,1);this.HT.fyl(a)}}Object(e.a)(Zj,"PPTInverseRevisionUpdater",null,[1235]);class ek{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UndoRedo"}Wb(a){this.K=a;a.register(ip,"Box4.UndoRedo.UndoSettingsManager").as("Box4.UndoRedo.IUndoSettingsManager").ma();a.register(Vn,"Box4.UndoRedo.UndoRevisionValidator").as("Box4.UndoRedo.IUndoRevisionValidator").ma().na(()=>
new Vn(a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(429,"Box4.ISelectionReferenceFactory").ma().na(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.hermesUndoRedoNavigateSlideToRestoreSelectionIsEnabled?new vd(zl.SelectionReferenceFactory.instance,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.ITableNavigator"),a.resolve("Common.IActionManager"),b.Ly,a.resolve("PowerPointWebEditor.ISidUpdater"),a.resolve("PowerPointWebEditor.View.IPPTPageView")):zl.SelectionReferenceFactory.instance});a.register(Ab,"PowerPointWebEditor.UndoRedo.PPTUndoRevisionMergeStrategy").as("Box4.UndoRedo.IUndoRevisionMergeStrategy").ma();
a.register(nd,"PowerPointWebEditor.UndoRedo.PPTUndoSettings").as("PowerPointWebEditor.UndoRedo.IPPTUndoSettings").ma();a.resolve("PowerPointWebEditor.IApplicationSettings").g5a?a.register(dg,"PowerPointWebEditor.UndoRedo.FluidUndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma():a.register(zg,"Box4.UndoRedo.Box4UndoStackDataSyncHelperFactory").as("Box4.UndoRedo.IUndoStackDataSyncHelperFactory").ma().na(()=>new zg(b=>new U(ka.ObjectSpace.N2(b,a.resolve("PowerPointWebEditor.IApplicationSettings").g5a),
a.resolve("Box4.UndoRedo.IUndoRevisionValidator"),a.resolve("Box4.UndoRedo.IUndoSettingsManager"),new Ko,b,a.resolve("Box4.UndoRedo.IUndoRevisionMergeStrategy"),new Zj(a.resolve("PowerPointWebEditor.IRevisionMetadataHelper")))));a.register(ec,"PowerPointWebEditor.UndoRedo.PPTUndoStackFactory").as("Box4.UndoRedo.IUndoStackFactory").ma().na(()=>new ec(a.resolve("Box4.UndoRedo.IUndoStackDataSyncHelperFactory")));a.register(hn,"PowerPointWebEditor.UndoRedo.PPTUndoActionBehavior").as("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior").ma().na(()=>
new hn(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.UndoEventSource"),a.resolve("Common.IActionManagerExtended")));a.register(Ia,"PowerPointWebEditor.UndoRedo.PPTUndoManager").as("Box4.UndoRedo.UndoManager").as("Box4.IUndoManager").as("PowerPointWebEditor.UndoRedo.IPPTUndoManager").as("Box4.StorageObjectSpace.IUndoRevisionLoadingState").ma().na(()=>new Ia(a.resolve("Box4.UndoRedo.IUndoStackFactory"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers")));a.register(1190,"PowerPointWebEditor.UndoRedo.IPPTUndoSelectionRestoreExecutor").ma().na(()=>new he);a.register(kc,"PowerPointWebEditor.UndoRedo.UndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventSource").as("PowerPointWebEditor.UndoRedo.IUndoEventNotifier").as("PowerPointWebEditor.UndoRedo.IUndoEventHandlers").ma();this.tui(a);this.xui(a);a.register(1191,"PowerPointWebEditor.IGroupUngroupUndoRedoActionController").ma().na(()=>
new gn(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper")))}tui(a){a.register(1192,"PowerPointWebEditor.ITablePartialEditController").ma().na(()=>{const b=a.resolve("PowerPointWebEditor.IApplicationSettings");return b.QQj?new Jo(a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker"),a.resolve("Box4.IWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),b.gwb):new pe})}xui(a){a.register(1193,"PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").ma().na(()=>new bd(a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")))}init(){const a=this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager");
var b=this.K.resolve("Box4.IPageView");b.vg&&(b=b.vg.Co(),a.register(b),a.setActive(b),a.hWa(E.a.ZRa,null))}dispose(){this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager").dispose();this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoSelectionUpdater").dispose()}static main(){m.a.instance.Bc(new ek)}}Object(e.a)(ek,"PPTWebEditorUndoRedoPackage",null,[2,3]);class Zh{constructor(a=!1,b,c=!1,f=!1,l=!1,x=!1,G=!1){this.CSa=a;this.Rae=c;this.Z7a=f;this.N4b=l;this.S4b=x;this.STc=G}}Object(e.a)(Zh,
"DocModeSwitcherData",null,[]);var Vk=d(832);class Om{constructor(a,b,c,f,l){this.vzb=!1;this.uqe=null;this.xwd=this.Kxd=this.Xwd=this.fxd=this.$wd=this.txd=this.Qwd=this.wxd=this.gza=this.Gwd=this.Mwd=this.cxd=this.Dwd=this.Wwd=this.K9e=!1;this.jc=a;this.yl=b;this.Mc=c;this.uv=l;this.XKg=f.pJj;this.Wta=f.pptOnlineFallbackToReadOnlyAfterBootEnabled;this.d1c=f.zyg;this.t9j=u.AFrameworkApplication.Kz;this.reset()}initialize(){this.Mc.cba(Object(C.a)(this,this.jz,"onUnifiedAppStateChanged"));this.Mc.HNa(Object(C.a)(this,
this.Uec,"onOutboundReplication"));this.uqe=[Object(C.a)(this,this.Bni,"checkIsInlineRepairedDocument"),Object(C.a)(this,this.yni,"checkIrmProtection"),Object(C.a)(this,this.doi,"checkUserPermission"),Object(C.a)(this,this.$mi,"checkFileFormats"),Object(C.a)(this,this.ani,"checkFileLock"),Object(C.a)(this,this.Kni,"checkPasswordProtection"),Object(C.a)(this,this.cni,"checkFontRestriction"),Object(C.a)(this,this.Cni,"checkIsMarkedFinal"),Object(C.a)(this,this.Dni,"checkIsMarkedReadOnlyRecommended"),
Object(C.a)(this,this.Pni,"checkSessionRestriction"),Object(C.a)(this,this.Oni,"checkSessionAccessTokenExpired"),Object(C.a)(this,this.Hni,"checkNetworkIssueHappened"),Object(C.a)(this,this.Lni,"checkPopsHostIssueHappened"),Object(C.a)(this,this.koi,"checkWopiAccessTokenOutOfRefreshRange"),Object(C.a)(this,this.Ani,"checkIsEmergencyViewMode")];this.kjh(this.uqe)}dispose(){this.Mc.UFb(Object(C.a)(this,this.jz,"onUnifiedAppStateChanged"))}reset(){this.xwd=this.Mwd=this.Kxd=this.Xwd=this.fxd=this.$wd=
this.txd=this.Qwd=this.wxd=this.Gwd=this.cxd=this.gza=this.Dwd=this.Wwd=this.K9e=!1}jz(a,b){Aa.a.J(22930964,809,50,"ReadOnlyUIManager::OnUnifiedAppStateChanged");this.reset();b.R8a&&this.jc.un||(this.yl.uZf(),this.kjh(this.uqe))}Uec(){this.Wta&&!this.vzb&&(this.vzb=!0);this.jc.WK||Aa.a.J(38633602,801,15,"Outbound on RO mode")}kjh(a){if(a)for(const b of a)if(b())break}$mi(){if(this.hIj||!this.jc.fg(64)||this.XKg&&!(this.jc.fg(4)&&this.jc.fg(16)&&this.jc.fg(8)))return!0;if(!this.jc.getState(64))return!1;
if(this.XKg&&this.jc.getState(4)&&!this.jc.getState(16)&&!this.jc.getState(8)){var a=u.AFrameworkApplication.Ta.La(ba.a.HBa,2,Object.assign(new Zh,{STc:!0,Z7a:this.jc.getState(1)}));Aa.a.J(577524062,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatConvertible)"+a.toString());this.yl.ZM(10);Aa.a.J(24142428,809,50,"ReadOnlyUIManager::CheckFileFormats - business bar displayed (FormatConvertible)")}else a=u.AFrameworkApplication.Ta.La(ba.a.HBa,2,Object.assign(new Zh,{S4b:!0,Z7a:this.jc.getState(1)})),
Aa.a.J(578351494,809,50,"ReadOnlyUIManager::CheckFileFormats - callout display (FormatNotEditable)"+a.toString());return this.Dwd=!0}yni(){return this.pKj||!this.jc.fg(32768)?!0:this.jc.getState(32768)?(this.yl.ZM(14),this.Qwd=!0,Aa.a.J(24761164,809,50,"ReadOnlyUIManager::CheckIrmProtection - business bar displayed for FileIrmProtected"),!0):!1}ani(){return this.jIj?!0:this.jc.fg(128)&&this.jc.getState(128)?(this.yl.ZM(3),this.gza=!0,Aa.a.J(24761166,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditCheckedOutByAnother"),
!0):this.jc.fg(256)&&this.jc.getState(256)?(this.yl.ZM(4),this.gza=!0,Aa.a.J(24761168,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for RequiresCheckout"),!0):this.jc.fg(512)&&this.jc.getState(512)?(this.yl.ZM(5),this.gza=!0,Aa.a.J(24761170,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for LockedForOfflineCheckout"),!0):this.jc.fg(1024)&&this.jc.getState(1024)?(this.yl.ZM(6),this.gza=!0,Aa.a.J(24761172,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditLock"),
!0):this.jc.fg(2048)&&this.jc.getState(2048)?(this.yl.ZM(7),this.gza=!0,Aa.a.J(24761174,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for CannotAcquirePptEditSharedLock"),!0):this.jc.fg(4096)&&this.jc.getState(4096)?(this.yl.ZM(8),this.gza=!0,Aa.a.J(24761176,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for NumberOfCoauthorsReachedMax"),!0):this.jc.fg(8192)&&this.jc.getState(8192)?(this.yl.ZM(9),this.gza=!0,Aa.a.J(24761178,809,50,"ReadOnlyUIManager::CheckFileLock - business bar displayed for PptEditExistingExclusiveLock"),
!0):!1}Cni(){if(this.ZKj||!this.jc.fg(2)||!this.jc.fg(16))return!0;if(!this.jc.getState(2)&&this.jc.getState(16)){const a=u.AFrameworkApplication.Ta.La(ba.a.HBa,2,Object.assign(new Zh,{CSa:!0,Z7a:this.jc.getState(1)}));Aa.a.J(578351455,809,50,"ReadOnlyUIManager::CheckIsMarkedFinal - Callout display "+a.toString());return this.Wwd=!0}return!1}Dni(){if(!this.d1c)return!1;if(this.$Kj||!this.jc.fg(2)||!this.jc.fg(524288))return!0;if(!this.jc.getState(2)&&this.jc.getState(524288)){const a=u.AFrameworkApplication.Ta.La(ba.a.HBa,
2,Object.assign(new Zh,{Rae:!0,Z7a:this.jc.getState(1)}));Aa.a.J(578351452,809,50,"ReadOnlyUIManager::CheckIsMarkedReadOnlyRecommended - Callout displayed "+a.toString());return this.Xwd=!0}return!1}Kni(){if(this.KMj||!this.jc.fg(2)||!this.jc.fg(32))return!0;if(!this.jc.getState(2)&&this.jc.getState(32)){const a=u.AFrameworkApplication.Ta.La(ba.a.HBa,2,Object.assign(new Zh,{N4b:!0,Z7a:this.jc.getState(1)}));Aa.a.J(578351449,809,50,"ReadOnlyUIManager::CheckPasswordProtection - Callout display "+a.toString());
return this.cxd=!0}return!1}Bni(){return this.VJj||!this.jc.fg(2097152)?!0:this.jc.getState(2097152)?(this.yl.ZM(22),this.Mwd=!0,Aa.a.J(42824021,809,50,"ReadOnlyUIManager:: - Inline repaired document business bar displayed"),!0):!1}Ani(){var a=!1;if(this.KHj||!this.jc.fg(4194304))return!0;this.jc.getState(4194304)&&(a="NotAvailable",this.uv&&(a=this.uv.jtb(),a=Vk.a[a]),vf.Health.instance.recordQosError("EmergencyViewModeEnabledReason"+a,["ViewByDefault"],!0,!0,!1,!1,null),32===u.AFrameworkApplication.Ta.processAction(ba.a.cnc,
1)?(a=u.AFrameworkApplication.Ta.processAction(ba.a.cnc,2),Aa.a.J(578351445,809,15,"ReadOnlyUIManager:: EmergencyViewMode Emergency View Mode displayed in Doc Mode Switcher "+a.toString())):(this.yl.ZM(23),Aa.a.J(593295554,809,15,"ReadOnlyUIManager:: EmergencyViewMode business bar displayed")),this.xwd=a=!0);return a}cni(){return!this.FIj&&this.jc.fg(2)&&this.jc.fg(8)?!this.jc.getState(2)&&this.jc.getState(8)?(this.yl.ZM(12),this.Gwd=!0,Aa.a.J(24142434,809,50,"ReadOnlyUIManager::CheckFontRestriction - business bar displayed"),
!0):!1:!0}doi(){if(this.uHj||!this.jc.fg(1))return!0;if(!this.jc.getState(1)){const a=u.AFrameworkApplication.Ta.La(ba.a.HBa,2,new Zh);Aa.a.J(578351441,809,50,"ReadOnlyUIManager::CheckUserPermission - Callout display "+a.toString());return!0}return!1}Pni(){return this.tPj?!0:this.jc.fg(16384)&&this.jc.getState(16384)?(this.yl.ZM(13),this.wxd=!0,Aa.a.J(24761184,809,50,"ReadOnlyUIManager::CheckSessionRestriction - business bar displayed"),!0):!1}Oni(){return this.rPj?!0:this.jc.fg(65536)&&this.jc.getState(65536)?
(vf.Health.instance.recordQosError("SessionAccessTokenExpired",["SessionExpired"],!1,!1,!0,!0,null),this.Wta?this.yl.uIc(15,this.vzb):this.yl.ZM(15),this.txd=!0,Aa.a.J(37066185,809,50,"ReadOnlyUIManager::CheckSessionAccessTokenExpired - business bar displayed"),!0):!1}Lni(){return this.kNj?!0:this.jc.fg(262144)&&this.jc.getState(262144)&&this.Wta?(this.yl.uIc(17,this.vzb),this.fxd=!0,Aa.a.J(37310543,809,50,"ReadOnlyUIManager::CheckPopsHostIssueHappened - business bar displayed"),!0):!1}koi(){return this.GSj?
!0:this.jc.fg(1048576)&&this.jc.getState(1048576)&&this.Wta&&this.t9j?(this.yl.uIc(21,this.vzb),this.Kxd=!0,Aa.a.J(39327011,809,50,"ReadOnlyUIManager::CheckWopiAccessTokenOutOfRefreshRange - business bar displayed"),!0):!1}Hni(){return this.uLj?!0:this.jc.fg(131072)&&this.jc.getState(131072)&&this.Wta?(this.yl.uIc(16,this.vzb),this.$wd=!0,Aa.a.J(37310545,809,50,"ReadOnlyUIManager::CheckNetworkIssueHappened - business bar displayed"),!0):!1}get uHj(){return this.K9e}get ZKj(){return this.Wwd}get hIj(){return this.Dwd}get KMj(){return this.cxd}get VJj(){return this.Mwd}get FIj(){return this.Gwd}get jIj(){return this.gza}get tPj(){return this.wxd}get pKj(){return this.Qwd}get rPj(){return this.txd}get uLj(){return this.$wd}get kNj(){return this.fxd}get $Kj(){return this.Xwd}get GSj(){return this.Kxd}get KHj(){return this.xwd}}
Object(e.a)(Om,"ReadOnlyUIManager",null,[1194,106]);class Xn{constructor(){this.A3c=this.K=null}get name(){return"PowerPointWebEditor.UnifiedApp"}Wb(a){this.K=a;this.K.register(1194,"PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager").ma().na(()=>new Om(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Application.IReadOnlyManager")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").QDa&&
(this.A3c=this.K.resolve("PowerPointWebEditor.UnifiedApp.IReadOnlyUIManager"),this.A3c.initialize())}dispose(){this.A3c&&this.A3c.dispose()}static main(){m.a.instance.Bc(new Xn)}}Object(e.a)(Xn,"PPTWebEditorUnifiedAppPackage",null,[2,3]);var Hh=d(272);class Lo{constructor(a,b,c,f){this.Mb=a;this.$q=b;this.dE=c;this.Zta=f}Lia(){const a=new ef.a;a.$(0,Object(C.a)(this,this.tableBorderAndResizeHandlesClickHandler,"tableBorderAndResizeHandlesClickHandler"));a.$(1,Object(C.a)(this,this.pptTableColumnHandleClickHandler,
"pptTableColumnHandleClickHandler"));a.$(2,Object(C.a)(this,this.pptTableRowHandleClickHandler,"pptTableRowHandleClickHandler"));a.$(3,Object(C.a)(this,this.backgroundClickHandler,"backgroundClickHandler"));a.$(4,Object(C.a)(this,this.shapeClickHandler,"shapeClickHandler"));return a}tableBorderAndResizeHandlesClickHandler(a){return this.$q.p3(a.Ac)||this.$q.WSa(a.Ac)||this.$q.QVc(a.Ac)?(this.Mb.Srb(),Hh.a.Jl(!0)):Hh.a.notHandled}pptTableColumnHandleClickHandler(a){if(this.$q.ita(a.Ac)){const b=this.$q.P3d(a.Ac);
if(!b||!b.vk)return Aa.a.J(22577752,822,15,"Clicked on a table column handle but failed to get a ShapeViewElement."),Hh.a.Jl(!1);b.vk.Sp||this.$q.qFc(a.Ac,a.BU,a.Vi.Wf);return Hh.a.Jl(!0)}return Hh.a.notHandled}pptTableRowHandleClickHandler(a){if(this.$q.o6b(a.Ac)){const b=this.$q.P3d(a.Ac);if(!b||!b.vk)return Aa.a.J(41209868,822,15,"Clicked on a table row handle but failed to get a ShapeViewElement."),Hh.a.Jl(!1);b.vk.Sp||this.$q.aYk(a.Ac,a.BU,a.Vi.Wf);return Hh.a.Jl(!0)}return Hh.a.notHandled}backgroundClickHandler(a){return this.Mb.f6b(a)?
(this.Zta.setVisibility(!1),Hh.a.Jl(!0)):Hh.a.notHandled}shapeClickHandler(a){let b=Hh.a.notHandled;this.dE.Z5b||(b=this.dE.sMe(a));this.dE.Z5b=!1;if((a=this.dE.Ysb(a))&&!a.BN||a&&a.shapeNode&&a.shapeNode.qd&&a.BN)return Hh.a.Jl(!0);this.Zta.setVisibility(!1);return b}}Object(e.a)(Lo,"ClickHandlers",null,[]);var Pm=d(413),jn=d(418);class Mo{constructor(a,b,c,f,l,x){this.Mb=a;this.ra=b;this.Fa=c;this.ia=f;this.dE=l;this.Zpe=x}Lia(){const a=new ef.a;a.$(0,Object(C.a)(this,this.noContextMenuHandler,
"noContextMenuHandler"));a.$(1,Object(C.a)(this,this.slideBackgroundContextMenuHandler,"slideBackgroundContextMenuHandler"));a.$(2,Object(C.a)(this,this.shapeContextMenuHandler,"shapeContextMenuHandler"));return a}noContextMenuHandler(a){return this.Mb.orh(a)?Pm.a.notHandled:Pm.a.Jl(null)}slideBackgroundContextMenuHandler(a){return this.Mb.f6b(a)?(this.ra.Cy(),this.ra.Uh(),this.Fa.Ad(),this.ia.La(ba.a.hQd,2,a.Vi),Pm.a.Jl(null)):Pm.a.notHandled}shapeContextMenuHandler(a){var b=this.dE.Ysb(a);if(this.Ubl(b,
a))b.VBa(),this.Zpe?b.Ox||this.ia.La(ba.a.cOa,2,new jn.a(b.shapeNode,!0,a.Vi)):this.ia.La(ba.a.cOa,2,new jn.a(b.shapeNode,!0,a.Vi));else if(this.Rbl(b))return this.ra.Cy(),(b=this.dE.Yej(b,a))&&this.ra.selectShape(b,!0),this.Fa.Ad(),this.ia.La(ba.a.gQd,2,a.Vi),Pm.a.Jl(null);return Pm.a.notHandled}Ubl(a,b){return!!a&&!!a.shapeNode&&a.shapeNode.isConnected&&a.shapeNode.dAg&&!a.Ivb(b.Vi)}Rbl(a){return!!a||this.ra.JG()||!this.ra.Oa.length}}Object(e.a)(Mo,"ContextMenuClickHandlers",null,[]);class Ep{constructor(a,
b,c,f,l){this.Mb=a;this.$q=b;this.dE=c;this.ia=f;this.v$b=l}Lia(){const a=new ef.a;a.$(0,Object(C.a)(this,this.tableBorderAndHandlesDoubleClickHandler,"tableBorderAndHandlesDoubleClickHandler"));a.$(1,Object(C.a)(this,this.shapeDoubleClickHandler,"shapeDoubleClickHandler"));a.$(2,Object(C.a)(this,this.backgroundDoubleClickHandler,"backgroundDoubleClickHandler"));return a}tableBorderAndHandlesDoubleClickHandler(a){return this.$q.p3(a.Ac)||this.$q.WSa(a.Ac)||this.$q.QVc(a.Ac)?(this.Mb.Srb(),Hh.a.Jl(!0)):
this.$q.ita(a.Ac)||this.$q.o6b(a.Ac)?(this.Mb.Srb(),Hh.a.Jl(!1)):Hh.a.notHandled}shapeDoubleClickHandler(a){return this.dE.Ysb(a)?(this.Mb.Srb(),Hh.a.Jl(!1)):Hh.a.notHandled}backgroundDoubleClickHandler(a){return this.Mb.f6b(a)?(this.Mb.Srb(),this.v$b||this.ia.processAction(ba.a.mvb,2,{DoubleClickInsert:"true"}),Hh.a.Jl(!0)):Hh.a.notHandled}}Object(e.a)(Ep,"DoubleClickHandlers",null,[]);class kp{constructor(a,b,c,f,l){this.dE=a;this.wC=b;this.ia=c;this.Ea=f;this.NN=l}edg(){return Object(C.a)(this,
this.t7c,"mouseUpHandlerFilter")}t7c(a){return a?(a=this.wC.E2d(a.Ac))&&a.$a&&this.Ea.tn(a.$a)&&this.NN.$Sa&&this.dE.eNe?(this.ia.processAction(E.a.Cia,2),!0):this.dE.eNe=!1:!1}}Object(e.a)(kp,"MouseInputHandlers",null,[]);var Al=d(274);class Fp{constructor(a,b,c,f){this.dE=a;this.Ob=b;this.I_=c;this.Je=f}Lia(){const a=new ef.a;a.$(0,Object(C.a)(this,this.backgroundPointerDownHandler,"backgroundPointerDownHandler"));a.$(1,Object(C.a)(this,this.shapePointerDownHandler,"shapePointerDownHandler"));a.$(2,
Object(C.a)(this,this.defaultPointerDownHandler,"defaultPointerDownHandler"));return a}backgroundPointerDownHandler(a){this.Tsl();return this.dE.PJf(a)}Tsl(){this.Je.K9d()||Nc.a.kWd("ScrollActiveThumbnailIntoView",ba.a.jgb,()=>{this.Je.Agd();return 32})}shapePointerDownHandler(a){this.Ob.pW&&this.I_.show(3,-1);const b=this.dE.Ysb(a);if(b&&b.shapeNode&&b.shapeNode.Pf&&!b.shapeNode.Og)return Hh.a.Jl(!1);if((Sys.UI.DomElement.containsCssClass(a.Ac,Al.a.hxa)||Sys.UI.DomElement.containsCssClass(a.Ac,Al.a.WHb)||
Sys.UI.DomElement.containsCssClass(a.Ac,Al.a.yMe)||Sys.UI.DomElement.containsCssClass(a.Ac,Al.a.jld)||Sys.UI.DomElement.containsCssClass(a.Ac,Al.a.exh)||Sys.UI.DomElement.containsCssClass(a.Ac,Al.a.rxh))&&b.isSelected&&!b.BN||void 0!==b&&null!==b&&b.shapeNode.Tp)return this.dE.Z5b=!1,Hh.a.Jl(!0);this.dE.Z5b=!0;a=this.dE.sMe(a);a.X2&&(this.dE.eNe=!0);return a}defaultPointerDownHandler(){return Hh.a.Jl(!0)}}Object(e.a)(Fp,"PointerDownHandlers",null,[]);class Kn{constructor(a){this.dE=a}Lia(){const a=
new ef.a;a.$(0,Object(C.a)(this,this.backgroundPointerUpHandler,"backgroundPointerUpHandler"));a.$(1,Object(C.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(1,Object(C.a)(this,this.shapePointerUpHandler,"shapePointerUpHandler"));a.$(2,Object(C.a)(this,this.defaultPointerUpHandler,"defaultPointerUpHandler"));return a}backgroundPointerUpHandler(a){return this.dE.PJf(a)}shapePointerUpHandler(a){const b=this.dE.Ysb(a);return b&&b.shapeNode&&b.shapeNode.Pf&&!b.shapeNode.Og?Hh.a.Jl(!1):
this.dE.sMe(a)}defaultPointerUpHandler(){return Hh.a.Jl(!0)}}Object(e.a)(Kn,"PointerUpHandlers",null,[]);class ji extends Sys.EventArgs{constructor(){super()}}Object(e.a)(ji,"SlideBackgroundClickedEventArgs",Sys.EventArgs,[]);class em{constructor(a,b,c,f,l,x,G,R){this.Mb=a;this.$q=b;this.ra=c;this.Zta=f;this.Fa=l;this.A4=x;this.xla=G;this.Ea=R;this.eNe=this.Z5b=!1}PJf(a){return this.Mb.f6b(a)?(this.ra.Cy(),a=a.Vi,this.A4.Ebh(new ji(!1)),(a.ctrlKey||a.shiftKey)&&a.dA===Sys.UI.MouseButton.leftButton?
this.ra.kj():this.ra.Uh(),this.Zta.setVisibility(!1),this.Fa.Ad(),Hh.a.Jl(!0)):Hh.a.notHandled}sMe(a){const b=this.Ysb(a);b&&this.ra.Cy();const c=Sys.UI.DomElement.containsCssClass(a.Ac,Al.a.hxa)||Sys.UI.DomElement.containsCssClass(a.Ac,Al.a.WHb)||Sys.UI.DomElement.containsCssClass(a.Ac,Al.a.yMe),f=this.$q.QVc(a.Ac)||this.$q.p3(a.Ac)||this.$q.WSa(a.Ac);Nc.a.qk("isEventFromHandlers",c.toString());Nc.a.qk("isEventFromTableHandlers",f.toString());return c&&!f&&b&&b.BN?(this.ra.kj(),this.Zta.setVisibility(!1),
this.Fa.Ad(),Hh.a.Jl(!0)):f&&b&&!b.BN?(b.$Yg(a.Vi),Hh.a.Jl(!0)):!b||b.BN&&!this.O9d(a)?Hh.a.notHandled:(b.sqk(a.Vi),Hh.a.Jl(!0))}Ysb(a){let b=this.$q.jI(a.Ac);if(!b){var c=a.Ac,f=Ca.a(c,Da.a.role);f=f?f.toString()===Jc.a.NUb:!1;if(Sys.UI.DomElement.containsCssClass(c,"ListMarker")||f)for(;!b&&c;){b=this.$q.jI(c);if(Sys.UI.DomElement.containsCssClass(c,"Outline")&&Sys.UI.DomElement.containsCssClass(c,"OutlineSized"))break;c=c.parentNode}}if(b){c=Object(ua.a)(121,b);if(!c&&(this.$q.QVc(a.Ac)||this.$q.p3(a.Ac)||
this.$q.WSa(a.Ac))&&(c=this.xla.B0b(this.Ea.tn(b.$a)),!c))return Aa.a.J(39322434,822,15,"Clicked on a table resize handle but failed to get its ContainerShapeViewElement."),null;if(c||(c=this.xla.B0b(this.Ea.tn(b.$a)))&&c.LA&&!(c.Ox||c.Sp||c.Mce))return c}return null}O9d(a){return a&&a.Ac?a.Ac.id.startsWith(sf.a.yob):!1}Yej(a,b){return a?this.Xej(a):this.Wej(b.graphNode)}Xej(a){let b=null;a.isSelected&&this.ra.JG()||(b=Object(ua.a)(4,a.$a));return b}Wej(a){let b=null;if(a){const c=nb.GraphIterator.mb(a);
c.pc(10)?(a=Object(ua.a)(4,c.Rg(10)),this.ra.uW(a)||(b=a)):Aa.a.J(22577757,808,15,"Unexpected type of graph node gets clicked, type: {0}, Id {1}",a.type,a.id)}return b}}Object(e.a)(em,"ViewEventHandlerHelper",null,[1236]);class Bl{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ViewEventHandler"}Wb(a){this.K=a;a.register(Lo,"PowerPointWebEditor.ViewEventHandler.ClickHandlers").ma().na(()=>new Lo(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),
a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IGrippersManager")));a.register(Ep,"PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").ma().na(()=>new Ep(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Common.IActionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").ovb));a.register(Mo,"PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").ma().na(()=>
new Mo(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptContextMenuCrashFix));a.register(Fp,"PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").ma().na(()=>new Fp(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),
a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView")));a.register(Kn,"PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").ma().na(()=>new Kn(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IOfflineModalCallout")));a.register(kp,"PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").ma().na(()=>new kp(a.resolve("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper"),
a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext")));a.register(em,"PowerPointWebEditor.ViewEventHandler.ViewEventHandlerHelper").as("PowerPointWebEditor.ViewEventHandler.IViewEventHandlerHelper").ma().na(()=>new em(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IViewElementHelper"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("Box4.IGrippersManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.View.IShapeViewHelper"),a.resolve("PowerPointWebEditor.IShapeReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");a.N0h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ClickHandlers").Lia());a.A1h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.DoubleClickHandlers").Lia());a.o1h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.ContextMenuClickHandlers").Lia());
a.$2h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerDownHandlers").Lia());a.c3h(this.K.resolve("PowerPointWebEditor.ViewEventHandler.PointerUpHandlers").Lia());this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&this.K.resolve("Common.MouseInputManager").ob(ma.a.dJ,a.container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").edg())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled&&
this.K.resolve("Common.MouseInputManager").xb(ma.a.dJ,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").container,this.K.resolve("PowerPointWebEditor.ViewEventHandler.MouseInputHandlers").edg())}static main(){m.a.instance.Bc(new Bl)}}Object(e.a)(Bl,"PPTWebEditorViewEventHandlerPackage",null,[2,3]);var Ze=d(80),Zp;(function(a){a[a.notLoaded=1]="notLoaded";a[a.loaded=2]="loaded";a[a.failed=3]="failed"})(Zp||(Zp={}));Object(e.b)("WebSocketCompressionHelperLoadState",Zp);var mk=d(87),Ys=d(337),
lp;(function(a){a[a.connecting=0]="connecting";a[a.open=1]="open";a[a.closing=2]="closing";a[a.closed=3]="closed"})(lp||(lp={}));Object(e.b)("WebSocketState",lp);class Gp{constructor(a,b,c,f,l){this.Sac=this.El=this.aCb=null;this.kGa=-1;this.jbb=this.pka=0;this.l8b=-1;this.Ozb=0;this.Pzb=null;this.UTa=0;if(!a)throw Error.argumentNull("webSocketClient");this.zv=a;this.Xa=b;this.dH=c;this.Mc=f;a=document.createElement("a");a.href=this.zv.GCl;a.protocol="http:"===a.protocol?"ws":"wss";re.a("PodsWebSocketFrontDoor.UseQueryString")?
(a=new hj.QueryStringBuilder(a.href),re.a("PodsWebSocketFrontDoor.UseWacClusterQueryString")&&a.Ti(Jg.a.s5g,b.fk),re.a("PodsWebSocketFrontDoor.UseUsidQueryString")&&a.Ti(Jg.a.Xuk,u.AFrameworkApplication.userSessionId),a.Ti(Jg.a.Yfc,l.toString()),this.aCb=a.toString()):this.aCb=a.href;this.nbb=Ze.a.yD(this.aCb);this.VWb(2);this.sla=this.zv.pih;this.Qge=this.zv.yqi;this.oMe();this.Mc.LNa(Object(C.a)(this,this.deb,"onSessionEnding"));this.Mc.JB(Object(C.a)(this,this.to,"onSessionRehydrated"))}dispose(){this.Mc.rGe(Object(C.a)(this,
this.deb,"onSessionEnding"));this.Mc.Pea(Object(C.a)(this,this.to,"onSessionRehydrated"))}VWb(a){this.El&&this.El.close();this.El=new WebSocket(this.aCb,[]);this.El.onopen=Object(C.a)(this,this.onOpen,"onOpen");this.El.onerror=Object(C.a)(this,this.onError,"onError");this.El.onclose=Object(C.a)(this,this.onClose,"onClose");this.El.onmessage=Object(C.a)(this,this.onMessage,"onMessage");this.UTa=a;Aa.a.J(556541794,this.zv.nQ,50,"WebSocketFetcher::ConnectWebSocket - WebSocket connected WebSocketDomain:{0}, WacCluster:{1}, ConnectionReason:{2}",
this.nbb,this.Xa.fk,this.UTa)}ping(){if(this.El)if(1===this.El.readyState){const a=this.zv.JBi();this.El.send(a)}else Aa.a.J(559284698,this.zv.nQ,10,"WebSocketFetcher::Ping. Wrong WebSocket state {0}",this.El.readyState),this.Jwa(4);else Aa.a.J(559284697,this.zv.nQ,50,"WebSocketFetcher::Ping Websocket is unavailable.")}Fqi(){this.El.close()}onOpen(){Aa.a.J(591208995,this.zv.nQ,50,"WebSocketFetcher::OnOpen WebSocketDomain:{0}, WacCluster:{1}",this.nbb,this.Xa.fk);this.Rjc();this.Ozb=0;this.Pzb=null;
this.zv.Wkk()}onError(a){Aa.a.J(591208993,this.zv.nQ,10,"WebSocketFetcher::OnError {0}, WebSocketDomain:{1}, WacCluster:{2}",JSON.stringify(a),this.nbb,this.Xa.fk)}onClose(a){Aa.a.J(591208991,this.zv.nQ,50,"WebSocketFetcher::OnClose WebSocketDomain:{0}, WacCluster:{1}, EventInfo:{2}, CloseEventCode:{3}, CloseEventReason:{4}",this.nbb,this.Xa.fk,JSON.stringify(a),a.code,a.reason);this.Ozb=a.code;this.Pzb=a.reason}onMessage(a){try{a&&a.data&&this.zv.Ynk(a)}catch(b){Aa.a.J(559284699,this.zv.nQ,10,"WebSocketFetcher::OnMessage",
b.toString())}}oMe(){this.Sac=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.l8b),this.El||(Aa.a.J(559284700,this.zv.nQ,50,"WebSocketFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Jwa(1))):this.l8b=window.setTimeout(()=>{this.El&&(Aa.a.J(559284701,this.zv.nQ,50,"WebSocketFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.Ozb=1E3,this.Pzb="Lost visibility",this.El.close(this.Ozb,this.Pzb),this.El=null,window.clearTimeout(this.kGa))},
this.Qge)};window.self.addEventListener("visibilitychange",this.Sac)}Rjc(){this.pka=0}zJd(){0<this.zv.g7c&&(new Date).getTime()-this.jbb>this.zv.g7c&&(this.Rjc(),Aa.a.J(559284702,this.zv.nQ,50,"WebSocketFetcher::Retry connect to server after long pause."))}sNd(){const a=!!this.dH&&!!this.dH.instance&&!this.dH.instance.l8,b=(new Date).getTime()-this.jbb>this.sla,c=this.pka<this.zv.uUg,f=!this.El||3===this.El.readyState||2===this.El.readyState,l=a&&b&&c&&f;Aa.a.J(557181E3,this.zv.nQ,50,"WebSocketFetcher::CanRetry: canRetry:{0}, isPodsSessionAlive:{1}, retryTimeReached:{2}, retryAttemptsAvailable:{3}, noWebSocket:{4}",
l,a,b,c,f);return l}sLe(){this.jbb=(new Date).getTime();this.sla=Math.pow(2,this.pka)*this.zv.pih;0<this.zv.g7c&&(this.sla=Math.min(this.sla,this.zv.g7c));window.setTimeout(()=>{this.Jwa(3)},this.sla)}Jwa(a){this.zJd();this.sNd()&&(this.VWb(a),this.sLe(),this.pka++,a!==this.UTa&&Aa.a.J(541671620,this.zv.nQ,10,"WebSocketFetcher::ReconnectionReasonMismatch ReconnectionReason:{0}, m_reconnectionReason{1}",a,this.UTa),Aa.a.J(559284703,this.zv.nQ,50,"WebSocketFetcher::Retry connect to server. ReconnectionReason:{0}",
this.UTa),this.pka===this.zv.uUg&&Aa.a.J(559284704,this.zv.nQ,50,"WebSocketFetcher::Max retries reached. ReconnectionReason:{0}",this.UTa))}sendMessage(a,b){if(!this.El)return Aa.a.J(559284705,this.zv.nQ,50,"WebSocketFetcher::SendMessage Websocket is unavailable. RequestType:{0}, LastCloseCode:{1}, LastCloseReason:{2}",b,this.Ozb,this.Pzb),1;Aa.a.J(559284706,this.zv.nQ,50,"WebSocketFetcher::SendMessage. WebSocket state {0}, RequestType:{1}, LastCloseCode:{2}, LastCloseReason:{3}",lp[this.El.readyState],
b,this.Ozb,this.Pzb);if(1===this.El.readyState)return this.El.send(a),0;this.Jwa(5);return 2}P8k(){this.El.binaryType="arraybuffer"}ADb(){-1!==this.kGa&&window.clearTimeout(this.kGa);this.kGa=window.setTimeout(()=>{this.ping()},this.zv.Dxk)}Yoi(){this.UTa=0}deb(){this.El&&(Aa.a.J(557352418,this.zv.nQ,50,"WebSocketFetcher::OnSessionEnding: closing due to session ending."),this.El.close(),this.El=null)}to(){this.El||(Aa.a.J(557352419,this.zv.nQ,50,"WebSocketFetcher::OnSessionRehydrated: reconnecting after session rehydrated."),
this.Jwa(6))}}Object(e.a)(Gp,"WebSocketFetcher",null,[1266,106]);var $p;(function(a){a[a.none=0]="none";a[a.visibilityRegainedReconnection=1]="visibilityRegainedReconnection";a[a.initialConnection=2]="initialConnection";a[a.timeoutReconnection=3]="timeoutReconnection";a[a.webSocketNotOpenOnPingReconnection=4]="webSocketNotOpenOnPingReconnection";a[a.webSocketNotOpenedReconnection=5]="webSocketNotOpenedReconnection";a[a.sessionRehydrationReconnection=6]="sessionRehydrationReconnection"})($p||($p={}));
Object(e.b)("ConnectionReason",$p);var Hp;(function(a){a[a.success=0]="success";a[a.nullWebSocket=1]="nullWebSocket";a[a.webSocketNotOpened=2]="webSocketNotOpened"})(Hp||(Hp={}));Object(e.b)("SendMessageStatusCode",Hp);class mp extends Sys.EventArgs{constructor(a,b,c){super();this.response=a;this.JWk=b;this.kGj=c}}Object(e.a)(mp,"WebSocketFrontDoorEventArgs",Sys.EventArgs,[]);var Cl=d(641);class Vr{constructor(a,b,c,f,l){this.Fm=window.performance.now();this.Sqe=new ic.a;this.wje=this.p9b=!0;this.Dyb=
null;this.gCb=1;this.Xa=b;this.g2c=a.ECl;this.Qpe=a.FCl;this.t7j=a.CCl;this.P9j=a.DCl;this.o1j=a.ACl;this.RAb=a.Qod;this.Bbk=a.Uzl;this.wte=a.BCl;this.nbb=Ze.a.yD(this.wte);this.wva=new Gp(this,b,c,f,new Ys.a(a.Dea));this.UHg=a.GFc;if(l)this.Dyb=l;else throw Error.argumentNull("dynamicScriptLoader");}dispose(){this.wva.dispose()}ping(){this.wva.ping()}ux(a){const b=new Map,c=this.Sjj(a);a.smartArtEditOpRequest&&(b.set("requestType",c),b.set("correlationId",a.smartArtEditOpRequest.commonData?a.smartArtEditOpRequest.commonData.correlationId:
null),vf.Health.instance.recordKpiUsage("DeltaEdit",1,"gc2smartart",b));this.RAb?(a=this.wva.sendMessage(JSON.stringify(a),c),0!==a&&(b.set("SendMessageStatusCode",Hp[a]),vf.Health.instance.recordKpiFailure("DeltaEdit","SendRequestFailure",!1,!0,Object.assign(new mk.a,{extendedProperties:b})))):vf.Health.instance.recordKpiFailure("DeltaEdit","WebSocketProtobufBRSDisabled",!0,!0,Object.assign(new mk.a,{extendedProperties:b}))}E7h(a){this.Sqe.addHandler("ResponseReceivedEventId",a)}ESk(a){this.Sqe.removeHandler("ResponseReceivedEventId",
a)}Wkk(){if(this.RAb){var a=Nc.a.Eb?Nc.a.Eb.actionId:zh.a.create().toString(),b=u.AFrameworkApplication.userSessionId,c=this.Xa.fk;this.wje=!0;b=Cl.p(a,b,this.Xa.podSessionId,c);b=this.wva.sendMessage(JSON.stringify(b),"validateSession");Aa.a.J(557175649,839,0===b?50:10,"PodsFrontDoorWebSocket::OnConnectionOpened ValidateSessionRequest correlationId:{0}, SendMessageStatusCode:{1}, WebSocketDomain:{2}, WacCluster:{3}",a,Hp[b],this.nbb,c)}}Ynk(a){if(this.RAb)try{const b=this.EQi(a);if(b.pong)this.ADb(b.pong.pingTimestamp);
else if(b.validateSessionResponse)this.Zrk(b.validateSessionResponse);else if(b.compressionHandshakeResponse)this.Skk(b.compressionHandshakeResponse);else{const c=Object.getType(a.data)!==String;this.Sqe.raiseEvent("ResponseReceivedEventId",new mp(b,this.Qcj(a,c),c))}}catch(b){Aa.a.J(541618382,839,10,"PodsFrontDoorWebSocket Failed to parse WebSocketFrontDoorServiceResponse")}else this.ADb(a.data)}EQi(a){let b=Object.getType(a.data)===String?a.data:null;if(b)return JSON.parse(b);if(2===this.gCb)return a=
new Uint8Array(a.data),b=WebSocketCompressionHelper.WebSocketCompressionHelper.decompressTextWithDeflateRaw(a),JSON.parse(b);Aa.a.J(541349337,839,10,"PodsFrontDoorWebSocket: ExtractMessageReceive could not decompress data because WebSocketCompressionHelper is not loaded");return JSON.parse("")}Qcj(a,b){return b?(new Uint8Array(a.data)).byteLength:a.data.length}Zrk(a){if(a.isValid){if(this.UHg){a=Nc.a.Eb?Nc.a.Eb.actionId:zh.a.create().toString();const b=u.AFrameworkApplication.userSessionId,c=this.Xa.podSessionId,
f=this.Xa.fk;Aa.a.J(541161497,839,50,"PodsWebSocketFrontDoor::OnValidateSessionResponse - WebSocketCompressionHelperLoadState:{0}",Zp[this.gCb]);1===this.gCb?this.MWj(a,b,c,f):2===this.gCb&&this.Blh(a,b,c,f)}this.ping()}else Aa.a.J(556541795,839,10,"PodsWebSocketFrontDoor::OnMessageReceived - Closing WebSocket because session not valid. WebSocketDomain:{0}, WacCluster:{1}",this.nbb,this.Xa.fk),this.wva.Fqi()}MWj(a,b,c,f){this.UHg&&this.Dyb.loadScript("WebSocketCompressionHelper").then(()=>{this.gCb=
2;this.Blh(a,b,c,f)}).catch(()=>{Aa.a.J(541710233,839,10,"PodsFrontDoorWebSocket WebSocketCompressionHelper failed to load");this.gCb=3})}Blh(a,b,c,f){a=Cl.a(a,b,c,!0,f);a=this.wva.sendMessage(JSON.stringify(a),"compressionHandshake");Aa.a.J(541710232,839,50,"PodsFrontDoorWebSocket WebSocketCompressionHelper loaded and sent compression handshake with status code {0}",a)}Skk(a){a=a.clientReadyForCompression;Aa.a.J(541710234,839,50,"PodsFrontDoorWebSocket WebSocket compression handshake received with value {0}",
a);a&&this.wva.P8k()}Sjj(a){return a.ping?"ping":a.validateSessionRequest?"validateSession":a.compressionHandshakeRequest?"compressionHandshake":a.smartArtEditOpRequest&&a.smartArtEditOpRequest.editOps&&a.smartArtEditOpRequest.editOps[0].resizeEditOp?"resizeEditOp":"unknown"}ADb(a){this.wva.ADb(a);Ka.a.Va(a)?Aa.a.J(561639837,839,10,"PodsFrontDoorWebSocket::OnPingReply Invalid pingTimestampStr"):(a=parseFloat(a),isNaN(a)?Aa.a.J(591208987,839,10,"PodsFrontDoorPing::OnMessage Ping response not a number. m_protobufEnabled:{0}",
this.RAb):(a={["PingTime"]:window.performance.now()-this.Fm-a,MeasurementType:"Performance.Now"},a.First=this.p9b?1:0,a.WebSocketFrontDoorProtobufEnabled=this.RAb,a.PostConnectionPing=this.wje,a.ConnectionReason=$p[this.wva.UTa],this.wva.Yoi(),this.wje=this.p9b=!1,Aa.a.J(591208985,839,50,ta.a.toJSON(a))))}JBi(){var a=(window.performance.now()-this.Fm).toString();if(!this.RAb)return a;a=Cl.q(Cl.l(a),null,null,null,this.Xa.fk);return JSON.stringify(a)}get GCl(){return this.Bbk&&!Ka.a.Va(this.wte)?this.wte:
u.AFrameworkApplication.fa.appSettings.WebServiceBase+"WebSocketFrontDoorServiceHandler.ashx"}get nQ(){return 839}get Dxk(){return this.Qpe}get uUg(){return this.g2c}get pih(){return this.P9j}get g7c(){return this.t7j}get yqi(){return this.o1j}}Object(e.a)(Vr,"PodsWebSocketFrontDoor",null,[1189,106,1234]);class No{constructor(){this.K=null}get name(){return"PowerPointWebEditor.WebSocketFrontDoor"}Wb(a){if(!a)throw Error.create("PPTWebEditorWebSocketFrontDoorPackage : container is null");this.K=a;
a.register(1189,"PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").ma().na(()=>{try{return new Vr(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.Ka("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("Common.IDynamicScriptLoaderProvider").Jv)}catch(b){return Aa.a.J(591208983,839,10,"exception creating PodsWebSocketFrontDoor: "+b),null}})}init(){}dispose(){this.K.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor").dispose()}static main(){m.a.instance.Bc(new No)}}
Object(e.a)(No,"PPTWebEditorWebSocketFrontDoorPackage",null,[2,3]);var Wr=d(1113),ro=d(1122);class Xr{constructor(a=null){this.Yn=null;this.reset();this.KRb=a}jUb(a,b){if(!this.KRb||this.KRb.TMe())b in this.Yn||(this.Yn[b]=[]),this.Yn[b].push(a)}getData(){return ta.a.count(this.Yn)?this.Yn:null}reset(){this.Yn={}}}Object(e.a)(Xr,"NamedValuesAggregator",null,[1496]);class Oo{constructor(){this.Yn=new Ha.a}get KKk(){return this.Yn.count}jUb(a){this.Yn.add(a)}getData(){return this.KKk?bb.toArray(this.Yn):
null}reset(){this.Yn=new Ha.a}}Object(e.a)(Oo,"BatchDataAggregator",null,[1496]);var Ip;(function(a){a[a.LanguageInfo=0]="LanguageInfo";a[a.FeedbackLoop=1]="FeedbackLoop";a[a.Config=2]="Config"})(Ip||(Ip={}));Object(e.b)("ApiType",Ip);class Qm{constructor(a,b){this.$h=a;this.KBd=b}ux(a,b,c){if(c){a=Ip[a];var f={"Content-Type":"application/json; charset=utf-8"};f["X-StatelessPopsAffinityRoutingEnabled"]=u.AFrameworkApplication.fa.ka("PPTStatelessPOPSRequestAffinityEnabled").toString();this.$h.yj(this.KBd()+
"&apitype="+a,2,b,f,!1,3,Object(C.a)(this,this.BIa,"requestSucceeded"),Object(C.a)(this,this.zIa,"requestFailed"),c,void 0,void 0,void 0,void 0,"28")}}BIa(a){if(!u.AFrameworkApplication.Vg&&a&&a.data){var b=a.data.state;b&&b.zQc(b,a.data.Sd)}}zIa(a){!u.AFrameworkApplication.Vg&&a&&a.data&&(a=a.data.state)&&a.kQc(a)}}Object(e.a)(Qm,"EditorServiceRequestManager",null,[1323]);class Zs extends Sys.EventArgs{constructor(a){super();this.nodeId=a}}Object(e.a)(Zs,"ErrorRangesChangedEventArgs",Sys.EventArgs,
[]);var nk=d(271);class so{constructor(a,b,c){this.begin=a;this.end=b;this.Gh=c}}Object(e.a)(so,"ErrorRange",null,[221]);class np{constructor(a,b){this.An=a;this.nNh=b}get ye(){return this.An}get Gh(){return this.nNh}Ud(a){return new np(a||this.An,this.Gh)}}Object(e.a)(np,"SpellingErrorObject",null,[167]);class aq{constructor(a,b,c){this.Pa=new ic.a;this.ir=a;this.RWh=b;this.JQh=c}cDf(a,b){b=this.iuh(a,b);if(!Qa.a.Va(b)){for(var c=this.iF(a),f=[],l=0,x=0;l<b.length&&x<c.length;){const G=c[x],R=b[l];
R.end<=G.begin?++l:(G.end>R.begin&&Array.add(f,G),++x)}c=a.sZa();try{const G=a.iia();try{this.eeh(a,f),this.dDf(a,b)}finally{G&&G.dispose()}}finally{c&&c.dispose()}this.g8c(a)}}tIa(a,b,c=!1){if(!Qa.a.Va(b)){c=c?null:a.sZa();try{const f=a.iia();try{this.eeh(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}this.g8c(a)}}bUk(a,b){const c=a.sZa();try{const f=a.iia();try{this.qOd(a),b=this.iuh(a,b),Qa.a.Va(b)||this.dDf(a,b)}finally{f&&f.dispose()}}finally{c&&c.dispose()}}qOd(a){const b=a.sZa();try{const c=
a.iia();try{const f=a.Ra;for(a=0;a<f.length;a++){const l=f.ga(a);l.Jp&&(l.Jp=null);l.bL=!1}}finally{c&&c.dispose()}}finally{b&&b.dispose()}}iF(a,b=null){const c=[];let f=0,l=null;var x=!1;a=a.Ra;for(let G=0;G<a.length;G++){const R=a.ga(G);if(R.bL){const fa=R.cp;l?(x=new so(f,fa,l),b&&!b(x)||Array.add(c,x)):x?Z.ULS.sendTraceTag(41300895,324,10,"Encountered CHP SpellingError without ErrorDetails set"):Z.ULS.sendTraceTag(41300896,324,10,"Encountered SpellingErrorEnd without the begin: Begin CP {0}, End CP {1}",
f,fa);x=!1}R.Jp&&(x=!0,f=R.cp,l=R.Jp.Gh)}return c}KQa(a){if(!a||!cb.SelectionEditor.Vj(a)&&!cb.SelectionEditor.Pg(a))return null;const b=a.node;let c=a.Qa,f=a.Kb;a=cb.SelectionEditor.Pg(a);const l=this.ir.text(b);for(const x of this.iF(b))if(a){if(x.begin<=c&&x.end>=f)return x}else if(x.begin<=c&&x.end>=c&&Ka.a.wvi(l,x.end,f))return x;return null}Ekc(a){if(!this.JQh||!a||!(a.sba||2===a.length&&cb.SelectionEditor.Ll(a.Ve)))return!1;a=this.KQa(a.Ua);if(!a)return!1;if(a=Object(ua.a)(658,a.Gh))if(a.gGh=
!0,a.vae())return!1;return!a||5!==a.proofingType}iuh(a,b){if(Qa.a.Va(b))return b;b=Array.clone(b);for(var c=b.length-1;0<=c;c--){var f=b[c];f&&f.Gh||(Z.ULS.sendTraceTag(41300897,324,15,"Received malformed ErrorRange: {0}. Filtering it out.",f?"Null error details":"Null range"),Array.removeAt(b,c))}if(!b.length)return b;nk.d(b);c=[];this.RWh&&Array.addRange(c,this.ir.MQa(a));c=nk.a(c);for(f=a=0;f<b.length&&a<c.length;){let l=b[f];const x=c[a];l.begin<x.end&&x.begin<l.end?Array.removeAt(b,f):l.end<
x.end?f++:a++}return b}dDf(a,b){let c=!1;for(const f of b){b=f.Gh;c=1===b.proofingType||c;let l=a.Qrb(f.begin);l.Jp=new np(l,b);l.isFromErrorRangeSplit=!0;l=a.Qrb(f.end);l.bL=!0;l.isFromErrorRangeSplit=!0}c&&(a.Mvb=!1)}eeh(a,b){if(!Qa.a.Va(b)){a=a.Ra;for(const c of b){b=a.yS(c.begin);const f=a.yS(c.end);b&&b.Jp&&f&&f.bL?(b.Jp=null,f.bL=!1):(b=String.format("Could not find and remove ErrorRange from CHPs. Cp Begin: {0}, Cp End: {1}",c.begin,c.end),Z.ULS.sendTraceTag(37532355,324,10,b))}}}m6h(a){this.Pa.addHandler("OnErrorRangesChanged",
a)}g8c(a){if(this.Pa.b3b){const b=this.iF(a);this.Pa.raiseEvent("OnErrorRangesChanged",new Zs(a.id.toString(),b))}}}Object(e.a)(aq,"ErrorRangeEditor",null,[1322]);var Ln=d(208);class $s{constructor(){this.B7e=new Ln.a}contains(a,b){return a?this.B7e.contains(Ka.a.Iyh(a,b)):!1}add(a,b){a&&this.B7e.add(Ka.a.Iyh(a,b))}}Object(e.a)($s,"IgnoreAllKeywords",null,[1184]);var Wk=d(209);class Pe extends Wk.a{constructor(a,b,c){super(b,c);this.fG=a;this.XHa=this.k$=-1;this.TNd=0;this.textUnit=2}get lcid(){return this.fG}}
Object(e.a)(Pe,"ModifiedRange",Wk.a,[]);class pm{constructor(a,b,c,f){this.F_h=a;this.dK=b;this.CM=c;this.Tsf=f}get fcd(){return this.Tsf?this.Tsf.instance:null}CKf(a,b){const c=[];if(Qa.a.Va(a)||Qa.a.Va(b))return c;if(1===b.length){b=b[0].lcid;for(var f of a)Array.add(c,new Pe(b,f.begin,f.end))}else{a=Array.clone(a);a.reverse();f=0;do{var l=b[f];let x=l.lcid;for(l=l.end;0<a.length&&l>a[a.length-1].begin;){const G=a.pop(),R=G.end,fa=Math.min(R,l);R>l&&a.push(new Wk.a(l,R));Array.add(c,new Pe(x,G.begin,
fa))}f++}while(0<a.length&&f<b.length);Z.ULS.shipAssertTag(37836432,324,!a.length,"Did not process all modified ranges in the stack")}return c}XPi(a,b,c,f){let l,x;({pue:l,Vte:x}=pm.E5f(a,c,b));c=0;let G=a.begin,R=a.end;const fa=this.fcd;let wa=!1;fa?(c=fa.findEndBoundary(b,R-1,x),f||-1!==c||this.Rlg(b,a)?c=-1===c?x:c:wa=!0):wa=!0;if(wa)return this.Fag(a,b,this.CM.UXg,l,x);if(!l)for(;" "===b.charAt(l)&&l<b.length;)l++;a=Math.max(fa.findBeginBoundary(b,G,l),l);return Wk.a.createTextRange(a,c)}WPi(a,
b,c){return this.d3f(a,b,c,this.CM.UXg)}VPi(a,b){if(!a||Qa.a.Va(b))return a;let c=a.begin,f=a.end,l=!1;for(const x of b){if(a.end<=x.begin)break;a.begin>x.begin&&a.begin<x.end&&(c=x.begin,l=!0);a.end>x.begin&&a.end<x.end&&(f=x.end,l=!0)}return l?Wk.a.createTextRange(c,f):a}ebl(a,b){if(!a||!b)return!1;const c=a.begin;a=a.end;return!Ka.a.pwb(b.substring(c,a))&&!Ka.a.vvi(b,c,a)}H0i(a,b,c){if(!a||!c||Qa.a.Va(b))return 0;a=nk.c([a],b);b=0;for(const f of a)b+=this.F_h.Xhg(c,f.begin,f.end);return b}H1h(a,
b,c,f){if(a&&b){var l=a.begin,x=a.end,G=this.CM.Eik;if(0>=G)a.k$=l,a.XHa=x;else if(G=this.d3f(a,b,f,G)){b=a.lcid;f=G.begin;G=G.end;if(0>f||this.Nqh(f,l,b,c))f=l;this.Nqh(x,G,b,c)&&(G=x);a.k$=f;a.XHa=G}else a.k$=l,a.XHa=x}}Rlg(a,b){return this.fcd?-1!==this.fcd.findEndBoundary(a,b.begin,b.end):!1}Nqh(a,b,c,f){if(a>=b)return!0;if(1>=f.length)return!1;a=this.CKf([new Wk.a(a,b)],f);return 1!==a.length||a[0].lcid!==c}d3f(a,b,c,f){if(!a||!b||0>f)return null;let l;({pue:c,Vte:l}=pm.E5f(a,c,b));return this.Fag(a,
b,f,c,l)}Fag(a,b,c,f,l){return Wk.a.createTextRange(this.dK.VTi(b,c,a.begin,f),this.dK.BTi(b,c,a.end,l))}static E5f(a,b,c){let f;f=0;c=c.length;if(Qa.a.Va(b))return{pue:f,Vte:c};let l=a.begin;a=a.end;let x=!1,G=!1;for(const R of b)if(!x&&R.end<=l?f=R.end:x=!0,!G&&R.begin>=a&&(c=R.begin,G=!0),x&&G)break;return{pue:f,Vte:c}}}Object(e.a)(pm,"ModifiedExpandRangeHelper",null,[1321]);var Po=d(338);class lr{constructor(a,b){this.cwd=null;this.rg=a;this.dK=b;this.jG=yb.ParagraphReader.text(this.rg);this.Msf=
[]}ujj(a,b){return this.HPc(this.dK.y_b(this.jG,a,b))}HPc(a){return a?this.o4d(a.begin,a.end):null}o4d(a,b){this.cwd=this.cwd||this.dK.dNc(this.rg);return this.dK.HPc(a,b,this.jG,this.cwd)}aDa(a,b){(a=this.o4d(a,b))&&Array.add(this.Msf,a)}l1b(){return Array.clone(this.Msf)}}Object(e.a)(lr,"ValidatedRangeContainer",null,[]);class op{constructor(a,b,c,f,l,x){this.wm=a;this.dK=b;this.Qc=c;this.CM=f;this.oXh=l;this.ZUh=x}btb(a){return new lr(a,this.dK)}K9h(a){const b=a.yTd.currentNode;var c=a.nuh.currentNode;
const f=a.l4g;a=this.csa(b);const l=this.btb(b);c=this.csa(c);for(var x of c)l.aDa(f+x.begin,f+x.end);Array.addRange(a,l.l1b());if(x=l.ujj(f,f))Array.add(a,x),this.QFe(b,x,0);b.a0=a}L9h(a,b,c){var f=a.a0;if(Qa.a.Va(f)||f[f.length-1].end<=c)this.OEc(b);else{var l=[],x=this.btb(a),G=this.btb(b);for(const R of f)if(f=R.end,f>c){const fa=R.begin;fa<c?(x.aDa(fa,c),G.aDa(0,f-c)):G.aDa(fa-c,f-c)}else Array.add(l,R);c=x.l1b();Array.addRange(c,l);a.a0=c;b.a0=G.l1b();a.Xkc();b.Xkc()}}Y5k(a){yb.ParagraphReader.Vd(a)&&
!this.dK.lSa(a)&&(this.wm.qOd(a),this.PGe(a,[new Wk.a(0,yb.ParagraphReader.textLength(a))]))}boh(a,b){b&&a&&yb.ParagraphReader.Vd(a)&&!this.dK.lSa(a)&&!a.OB&&this.YUg(a,this.btb(a).HPc(b),E.a.typing)}dph(a,b,c){a&&this.boh(a,this.dK.y_b(yb.ParagraphReader.text(a),b,c))}PGe(a,b){if(yb.ParagraphReader.Vd(a))if(Qa.a.Va(b))this.OEc(a);else{const c=this.btb(a);for(const f of b)c.aDa(f.begin,f.end);a.a0=c.l1b()}}OEc(a){yb.ParagraphReader.Vd(a)&&(a.a0=null)}Rhd(a,b,c=null){if(yb.ParagraphReader.Vd(a)&&!a.OB&&
!Qa.a.Va(b)){nk.d(b);var f=null;if(this.CM.Cvb||this.CM.hSa)f=R=>1===R.Gh.proofingType;f=this.wm.iF(a,f);for(var l=[],x=0,G=0;G<f.length&&x<b.length;){const R=b[x],fa=f[G];R.end<=fa.begin?x++:(fa.end<=R.begin||fa.begin>=R.begin&&fa.end<=R.end&&(0!==fa.Gh.errorType||fa.begin!==R.begin)&&Array.add(l,fa),G++)}this.wm.tIa(a,l);f=this.csa(a);b=nk.b(f,b);c&&(c=nk.c(f,[c]),0<c.length&&(b=nk.e(b,c)));this.PGe(a,b)}}csa(a){return yb.ParagraphReader.Vd(a)?a.a0||[]:[]}Pai(a,b,c,f,l=0){const x=a.node;if(yb.ParagraphReader.Vd(x)&&
!this.dK.lSa(x)&&!x.OB){var G=yb.ParagraphReader.text(x),R=a.Qa,fa=a.Kb+f;this.oXh?(R=a.Qa+b,fa=a.Kb-c+f):this.ZUh&&(b=this.Qc.Kj,0<=f&&b&&cb.SelectionEditor.Pg(b)&&(b=b.Qa,0<=b&&b<=G.length&&(b=this.dK.y_b(G,b,b))&&b.begin>=R&&b.end<=fa&&(R=b.begin,fa=b.end)));b=this.btb(x);c=null;0<=f&&(c=b.o4d(R,fa));c||(c=this.dK.y_b(G,R,fa));0<=f?this.YUg(x,c,l):this.txl(x,a.Qa,a.Kb,c,b,f,l)}}YUg(a,b,c){if(b){var f=this.csa(a);Array.add(f,b);a.a0=f;a.Xkc();this.QFe(a,b,c)}}txl(a,b,c,f,l,x,G){const R=this.csa(a),
fa=[];if(R.length)if(R[R.length-1].end<b)if(f)Array.addRange(fa,R);else return;else{for(const wa of R)wa.end<b?Array.add(fa,wa):wa.begin>=c?l.aDa(wa.begin+x,wa.end+x):wa.begin<b?wa.end>c?l.aDa(wa.begin,wa.end+x):l.aDa(wa.begin,b):wa.end>c&&l.aDa(b,wa.end+x);Array.addRange(fa,l.l1b())}f&&(Array.add(fa,f),this.QFe(a,f,G));a.a0=fa;a.Xkc();this.wm.g8c(a)}QFe(a,b,c){const f=this.wm.iF(a,x=>x.begin<=b.end&&x.end>=b.begin);if((c===E.a.yLd||c===E.a.typing||c===E.a.cut||c===E.a.paste)&&1===f.length&&f[0].Gh){c=
f[0].Gh;var l=sa.a.oe(c.lcid);l=l?l.name:op.RHh;const x=Object(Ma.a)(Po.a,c)?c.typeId:op.dIh;Z.ULS.sendTraceTag(40486211,375,50,"ManualEdits CritiqueId:{0}, CultureTag:{1}",x,l);c.gGh&&Z.ULS.sendTraceTag(40486212,375,50,"ClickNoAction CritiqueId:{0}, CultureTag:{1}",x,l)}this.wm.tIa(a,f)}}op.dIh="";op.RHh="UNKNOWN";Object(e.a)(op,"ModifiedRangeEditor",null,[1320]);class Qo{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa=null){this.wm=a;this.yz=b;this.cTb=c;this.YJ=f;this.i1a=l;this.rMa=x;this.dK=G;this.r2a=
R;this.c0e=fa;this.C6e=Wa||Qo.KFi;this.gwf=!1;wa.execute(mb=>{this.gwf=!!mb})}UCh(a){if(a&&yb.ParagraphReader.Vd(a)&&a.LQc){let b=null;this.c0e.Vsa&&(b=c=>!!c.Gh&&1===c.Gh.proofingType);a.Mvb=Qa.a.Va(this.yz.csa(a))&&Qa.a.Va(this.wm.iF(a,b))}}R9i(a,b){var c=this.T9i(a,b);if(Qa.a.Va(c))return[];const f=yb.ParagraphReader.text(a).replace("\u00a0"," "),l=this.wm.iF(a),x=this.K1k(a,l),G=x&&this.wxi(a),R=this.dK.X4f(a),fa=nk.e(this.dK.W4f(a),R);c=this.i5i(c,b,f,fa,l,x,G);if(Qa.a.Va(c))return[];b=this.i1a.b8i(a);
c=this.rMa.CKf(c,b);if(Qa.a.Va(c))return[];this.wEk(a,f,c);a=this.yz.csa(a);for(const wa of c)this.rMa.H1h(wa,f,b,R),wa.TNd=this.rMa.H0i(wa,a,f),x&&(G||this.rMa.Rlg(f,wa))&&(wa.textUnit=4);return c}tTi(a){if(this.C6e()||!a||""===a.sa(tb.a.iq,""))return null;var b=this.r2a.A_b;if(!b||!cb.SelectionEditor.Pg(b)||b.node!==a||!this.jtj(a))return null;b=b.Qa;return this.dK.y_b(yb.ParagraphReader.text(a),b,b)}Oai(a,b,c,f,l,x,G=0){this.YJ.Kc(a.node).af()&&(this.yz.Pai(a,b,c,x,G),this.cTb.nzl(a,f,l))}jtj(a){const b=
nk.a(this.yz.csa(a));if(!b.length)return!1;a=nk.a(this.wm.iF(a));let c=0,f=0;for(;c<a.length&&f<b.length;){const l=b[f],x=a[c];l.begin>=x.begin&&l.end<=x.end?f++:c++}return f!==b.length}T9i(a,b){if(!a||a.o$d)return null;a=this.yz.csa(a);return a.length&&b?nk.b(a,[b]):a}K1k(a,b){return this.gwf&&this.c0e.Vsa?a.XOb||!b.length||Qa.a.any(b,c=>!!c.Gh&&2===c.Gh.PCg):!1}wxi(a){if(!a.XOb||this.C6e())return!0;var b;(b=this.r2a.A_b)&&b.node===a?(a=this.yz.csa(a),b=b.Qa<a[a.length-1].begin):b=!0;return b}i5i(a,
b,c,f,l,x,G){let R=[];for(const fa of a)a=x?this.rMa.XPi(fa,c,f,G):this.rMa.WPi(fa,c,f),(a=this.rMa.VPi(a,l))&&Array.add(R,a);R=nk.a(R);b=nk.f(f,b);return nk.b(R,b)}wEk(a,b,c){const f=[];for(let l=c.length-1;0<=l;l--){const x=c[l];this.rMa.ebl(x,b)||(Array.removeAt(c,l),Array.add(f,x))}this.yz.Rhd(a,f)}static KFi(){return De.a.Ntj(Cb.App.Hb.TF.ABg)}}Object(e.a)(Qo,"ParagraphProofingFacade",null,[1319]);var ti=d(1029);class Ro{constructor(){this.kQc=this.zQc=this.activity=null}endActivity(a){this.activity&&
(this.activity.properties.$("EndReason",a),this.activity.end())}}Object(e.a)(Ro,"EditorServiceAPIRequest",null,[]);class at extends Ro{constructor(){super();this.Pxa=this.request=null}}Object(e.a)(at,"ProofingConfigV2Request",Ro,[]);class Iq{constructor(a,b,c,f,l){this.Lcid=a;this.AppId=b;this.LanguageId=c;this.LanguageUXId=f;this.Descriptors=l}}Object(e.a)(Iq,"ProofingConfigV2RequestObject",null,[]);var bq;(function(a){a[a.success=0]="success";a[a.partialSuccess=1]="partialSuccess";a[a.error=2]=
"error";a[a.disabled=3]="disabled"})(bq||(bq={}));Object(e.b)("ResponseStatus",bq);var kn=d(2);class Yr{constructor(a,b,c,f,l){this.lNb=a;this.hd=b;this.gRb=c;this.XUh=f;this.aBf=u.AFrameworkApplication.lcid;this.Qfa=Cb.App.mode;this.Trc={};this.yQb=new Lc.a;this.RUh=l}init(){this.ibd(this.aBf)}ibd(a){if(!(a.toString()in this.Trc||u.AFrameworkApplication.Vg))try{this.XUh.Eni(a).continueWith(b=>{!b.result||this.yQb.Jb(a.toString())&&this.yQb.ga(a.toString())||this.O0k(a)},3)}catch(b){Z.ULS.sendTraceTag(36782929,
375,10,"PopulateConfigByLanguageId failed with exception: {0}",b)}}O0k(a){var b=new ti.a;const c=sa.a.oe(a).name,f=sa.a.oe(this.aBf).name;c&&c.length&&f&&f.length&&(b=Object.assign(new at,{request:new Iq(a,this.DZd(),c,f,this.gRb.descriptors),activity:this.hd.Kp(E.a.fVk),Pxa:b,zQc:Object(C.a)(this,this.vhc,"processSuccessResponse"),kQc:Object(C.a)(this,this.thc,"processFailResponse")}),this.yQb.$(a.toString(),!0),this.lNb.ux(2,Yd.c(b.request),b))}vhc(a,b){if(!a||!a.request)return!1;this.yQb.$(a.request.Lcid.toString(),
!1);if(a.request.Lcid.toString()in this.Trc)return a.endActivity("RequestSucceeded"),!0;let c=null;if(b&&b.length)try{c=Yd.a(b)}catch(f){Z.ULS.sendTraceTag(36811152,375,10,"Parse failed with exception: {0}",f)}if(!c||1===c.ResponseStatus)return b=c?bq[c.ResponseStatus]:"EmptyResponse",Z.ULS.sendTraceTag(37343687,375,50,"Failed to get proofing config, language {0}, Reason {1}",a.request.LanguageId,b),a.endActivity(b),!1;a.endActivity("RequestSucceeded");b=c.CritiqueCategoryInfoList;this.RUh.filter(b);
Z.ULS.sendTraceTag(35240099,375,50,"Get proofing config. CritiqueCategoryInfoList is null: {0}, Length of CritiqueCategoryInfoList: {1}, languageId: {2}",!b,b?b.length:0,a.request.LanguageId);this.Trc[a.request.Lcid.toString()]=b;return!0}thc(a){a&&(a.request&&this.yQb.$(a.request.Lcid.toString(),!1),a.Pxa.Dg(!1),Z.ULS.sendTraceTag(35240128,375,10,"Failed to get proofing config, language {0}",a.request.LanguageId),a.endActivity("RequestFailed"))}request(a){return kn.Task.Gt(this.Trc[a.toString()])}DZd(){const a=
n.a[this.Qfa];return a.charAt(0).toUpperCase()+a.substr(1)+"_Online"}}Object(e.a)(Yr,"ProofingConfigV2Manager",null,[1188]);class ln{constructor(){this.Value=this.Name=null}static create(a,b){return Object.assign(new ln,{Name:a,Value:b})}static k8d(){Object.assign(new ln,{Name:"IsCompliant",Value:void 0});Object.assign(new ln,{Name:"LicenseType",Value:"NoLicense"});Object.assign(new ln,{Name:"IsGoLocal",Value:void 0})}}Object(e.a)(ln,"Descriptor",null,[]);class bt{constructor(a,b){this.Sya=[];this.eb=
a;this.o4e=b}get descriptors(){if(!this.Sya.length)try{this.k8d()}catch(a){const b=String.format("Message: {0}. Stack: {1}",a.message,a.stack);Z.ULS.sendTraceTag(33952285,375,10,b)}return this.Sya}k8d(){Array.clear(this.Sya);var a=this.eb.ka("ProofingWithEditorServiceInboundaryCloudSuggestionsIsEnabled").toString();Array.add(this.Sya,Object.assign(new ln,{Name:"IsGoLocal",Value:this.eb.ka("IsGoLocalEnvironment").toString()}));Array.add(this.Sya,Object.assign(new ln,{Name:"IsCompliant",Value:a}));
if(this.o4e.hde||this.o4e.hSa)a=this.eb.ka("IsSubscriptionForProofingUser")?"Subscription":"NoLicense",Array.add(this.Sya,Object.assign(new ln,{Name:"LicenseType",Value:a}));this.W$h();this.cai()}cai(){var a=Yd.b(this.eb.appSettings.SessionStartInfoJson.toString());var b=a.Host||"";const c=a.Ring||"";a=a.WACDatacenter||"";""!==c&&""!==b&&(b=c+"-"+b,Array.add(this.Sya,Object.assign(new ln,{Name:"CustomAudience",Value:b})));""!==a&&Array.add(this.Sya,Object.assign(new ln,{Name:"Origin",Value:a}))}W$h(){const a=
this.$Si(this.eb.Ga("FlightId"));let b;0<a.length&&(b=Qa.a.join(a,";"),Array.add(this.Sya,Object.assign(new ln,{Name:"FlightIds",Value:b})),Z.ULS.sendTraceTag(33952287,375,50,"FlightCount: [{0}], flightIds: [{1}]",a.length,b))}$Si(a){const b=[];if(a&&""!==a){a=a.split(";");for(let c=0;c<a.length;c++)-1<a[c].toLowerCase().indexOf("editorservice")&&Array.add(b,a[c])}return b}}Object(e.a)(bt,"ProofingDescriptors",null,[1183]);class mr{constructor(a,b){this.hSa=this.Cvb=this.CDd=!1;this.iAd=this.hAd=
0;this.txc=a.ka("ProofingWithEditorServiceIsEnabled");this.HOh=a.ka("GrammarCheckIsEnabled");this.LSa=a.ka("ProofingSettingIsEnabled");this.Cbe=a.ka("ProofingSecondaryContextualMenuIsEnabled");this.ouc=a.ka("EditorServiceSuggestionDescriptionsIsEnabled");a.ka("NewProofingExperienceEnabled");this.J_h=a.ka("WritingStyleIsEnabled");this.GMh=a.ka("DoNotCheckThisIssueEnabled");this.oQh=a.ka("IgnoreProofingCommandIsEnabled");this.Vsa&&(this.CDd=!1,b.execute(()=>{this.CDd=!0}));2===this.Iea?(this.iAd=2,
this.hAd=3):(this.iAd=a.Cc("NumberOfWordsToProofAroundModifiedRanges",1),this.hAd=a.Cc("NumberOfWordsAsContextAroundProofedRanges",0))}get gwg(){return this.oQh}get Vsa(){return 2===this.Iea&&this.HOh}get hde(){return this.Vsa&&this.J_h}get I$d(){return this.GMh&&this.Cbe&&this.LSa}get iHj(){return this.ouc}get Iea(){return this.txc?2:0}get Eik(){return this.hAd}get UXg(){return this.iAd}get isLoaded(){return!this.txc||!this.Vsa||this.CDd}}Object(e.a)(mr,"ProofingFeatureConfiguration",null,[1317]);
class cq extends Ro{constructor(){super();this.request=null}}Object(e.a)(cq,"ProofingFeedbackLoopRequest",Ro,[]);class nr{constructor(a,b,c){this.lNb=a;this.hd=b;this.gRb=c}S0k(a){a.Descriptors=this.gRb.descriptors;a=Object.assign(new cq,{request:a,activity:this.hd.Kp(E.a.m1k),zQc:Object(C.a)(this,this.vhc,"processSuccessResponse"),kQc:Object(C.a)(this,this.thc,"processFailResponse")});this.lNb.ux(1,Yd.c(a.request),a)}vhc(a){if(!a)return!1;a.endActivity("RequestSucceeded");return!0}thc(a){a&&(Z.ULS.sendTraceTag(38847138,
375,15,"Proofing feedback failed"),a.endActivity("RequestFailed"))}}Object(e.a)(nr,"ProofingFeedbackLoopManager",null,[1316]);class Jq extends Ro{constructor(){super();this.Pxa=this.request=null}}Object(e.a)(Jq,"ProofingLanguageInfoRequest",Ro,[]);class Kq{constructor(a){this.AppId=a}}Object(e.a)(Kq,"ProofingLanguageInfoRequestObject",null,[]);class Jp{constructor(a,b){this.lNb=a;this.hd=b;this.Qfa=Cb.App.mode;this.Noa=new va.ScriptSharpLegacyMap;this.Wfa=null;this.f2a=0}Eni(a){if(this.Noa.Jb(a))return kn.Task.Gt(!0);
this.VIe();return this.Wfa.CWRCo(()=>!!this.Wfa.result&&this.Wfa.result.Jb(a),3)}Fni(a,b){if(this.Noa.Jb(a))return kn.Task.Gt(this.Egg(a,b));this.VIe();return this.Wfa.CWRCo(()=>this.Egg(a,b),3)}K2i(a){if(0<this.Noa.count)return kn.Task.Gt(this.D$f(a));this.VIe();return this.Wfa.CWRCo(()=>this.D$f(a),3)}$Uk(){const a=new ti.a;u.AFrameworkApplication.Vg&&a.Dg(null);const b=Object.assign(new Jq,{request:new Kq(n.a[this.Qfa]+"_Online"),activity:this.hd.Kp(E.a.gVk),Pxa:a,zQc:Object(C.a)(this,this.vhc,
"processSuccessResponse"),kQc:Object(C.a)(this,this.thc,"processFailResponse")});this.lNb.ux(0,Yd.c(b.request),b);this.f2a+=1;return a.task}vhc(a,b){let c=null;if(!a)return!1;try{c=Yd.a(b)}catch(l){Z.ULS.sendTraceTag(37025730,375,10,"Failed to parse language info response with exception {0}",l)}if(c&&0===c.ResponseStatus&&c.SupportedLanguages&&0<c.SupportedLanguages.length){for(var f of c.SupportedLanguages)(b=sa.a.oe(f.LanguageId))&&0!==f.SupportedTextUnit&&this.Noa.$(b.LCID,f);a.Pxa.Dg(this.Noa);
a.endActivity("RequestSucceeded");return!0}a.Pxa.Dg(null);f=c?bq[c.ResponseStatus]:"EmptyResponse";Z.ULS.sendTraceTag(38847139,375,15,f);a.endActivity(f);return!1}thc(a){a&&(a.Pxa.Dg(null),Z.ULS.sendTraceTag(38847168,375,15,"RequestFailed"),a.endActivity("RequestFailed"))}Egg(a,b){if(!this.Noa||!this.Noa.Jb(a))return 0;a=this.Noa.ga(a).SupportedTextUnit;return 0!==(b&a)?b:this.n5i(b,a)}n5i(a,b){for(a=b&(a|a-1);a;){b=a&a-1;if(!b)break;a=b}return a}D$f(a){const b=new Ha.a;if(!this.Noa)return b;for(let c of this.Noa)c.value.SupportedCritiqueTag&
a&&b.add(c.key);return b}VIe(){if(!this.Wfa||5===this.Wfa.status||4===this.Wfa.status||6===this.Wfa.status&&!this.Wfa.result)this.Wfa=this.$Uk(),Z.ULS.sendTraceTag(38319180,375,1===this.f2a?50:15,"Schedule a new task for LanguageInfo request. IsRetried: {0}, Count: {1}",1!==this.f2a,this.f2a)}}Object(e.a)(Jp,"ProofingLanguageInfoManager",null,[1315]);class or{constructor(a,b){this.fRh=a;this.wmb=b}track(a,b=null){this.fRh&&this.wmb.track(a(),b)}}Object(e.a)(or,"ProofingMetricsAggregator",null,[1187]);
class Lq{AEf(a,b){a&&yb.ParagraphReader.Vd(a)&&!Qa.a.Va(b)&&(nk.d(b),a.rKb=nk.e(a.rKb,b))}nzl(a,b,c){if(b){var f=a.Kb;a=a.node.rKb;for(let x=0;x<a.length;x++){var l=a[x];const G=l.begin;l=l.end;0>b?l>c&&(G>=f?a[x]=new Wk.a(G+b,l+b):G>=c&&l<=f?(Array.removeAt(a,x),x--):a[x]=new Wk.a(G<c?G:c,l<=f?c:l+b)):a[x]=new Wk.a(G>f?G+b:G,l>f?l+b:l)}}}}Object(e.a)(Lq,"UnsupportedLanguageRangeEditor",null,[1313]);var pr=d(1220),Me=d(459),qr=d(244),Rm=d(442),vu=d(1056),fm=d(653);class Zr{constructor(){this.ly=this.QXa=
null}}Object(e.a)(Zr,"ClientRequestManagerStateObject",null,[]);class t{constructor(a,b){this.request=a;this.response=b}}Object(e.a)(t,"SpellCheckRequestResponseTuple",null,[]);class N{constructor(){this.oFh=0;this.rWf=this.sma=this.paragraphNode=this.range=null;this.userAction=0;this.aI=null;this.Iea=0;this.overriddenCritiqueTypeOptions=this.descriptors=null}swg(){const a=yb.ParagraphReader.text(this.paragraphNode);if(!a||!this.sma)return a===this.sma;let b=this.range.begin,c=this.range.end;return Ka.a.LKd(a.substring(b,
c),this.sma.substring(b,c))}isValid(){return this.paragraphNode.isConnected&&this.swg()}}Object(e.a)(N,"SpellCheckRequest",null,[]);var ha=d(652),za=d(824),Ra=d(825);class qb{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe){this.kGd=new qa.a;this.UQb=[];this.Esc=0;this.Rxc={};this.daa=null;this.c_e=Number.POSITIVE_INFINITY;this.Brc=0;this.F6=qb.w8a;this.Y1a=null;this.hzc=0;this.qnb=[];this.$rc=null;this.KVh=!1;this.wQb=[];this.kCd=[];this.SUh=0;this.WUh=c.ka(qb.dEk);this.aVh=c.ka(qb.kEk);
this.TUh=c.appSettings[qb.bEk];this.QUh=c.ka(qb.aEk);this.$Uh=c.ka(qb.iEk);this.yH=f;this.Qfa=Cb.App.mode;this.wm=a;this.yz=b;this.cTb=wa;this.$h=l;this.wSh=c.Cc(qb.gEk,qb.fEk);this.YUh=Kb;this.rk=x;this.ef=G;this.YJ=R;this.dK=fa;this.KBd=Wa;this.rxc=mb;this.Vh=new pr.a;this.VUh=c.ka(qb.cEk);this.qxc=oc;this.eEk=Ic;this.uKc=nc;this.txc=c.ka(qb.jEk);this.gRb=Kc;this.PUh=Hc;this.tkb=ie;this.Pfa=He;this.Rd=fe}get G3g(){return this.wQb}set G3g(a){this.wQb=a}get WLc(){return u.AFrameworkApplication.Vg}get ZXb(){return this.tkb.instance}suspend(){this.hzc++}resume(){if(0>=
--this.hzc&&(this.hzc=0,0<this.qnb.length&&!this.$rc)){const a=this.Pfa.isCompleted(4)?0:1;this.$rc=new xe.a(a,1,1,Object(C.a)(this,this.Phl,"spellCheckSuspendedNodes"),74);this.Rd.Cb(this.$rc)}}Phl(){this.$rc=null;const a=Qa.a.clone(this.qnb);Array.clear(this.qnb);Date.now();let b=null;for(const c of a)b=this.iBh(c,!0,b);b&&b.dispose();this.KVh||Date.now()}fR(a,b=!1){(a=this.iBh(a,b,null))&&a.dispose()}iBh(a,b,c){switch(this.Pra(a,b)){case 1:Qa.a.contains(this.qnb,a)||Array.add(this.qnb,a);break;
case 2:c=this.doSpellCheck(a,c);this.executeNextRequest();break;case 3:this.executeNextRequest()}return c}Pra(a,b){return!a||this.WLc||!this.yH.Hd.isEditingAllowed&&!this.yH.Hd.My?0:!b&&0<this.hzc||!this.uKc.isLoaded?1:!yb.ParagraphReader.Vd(a)||!a.isConnected||a.anchor.wI||a.o$d||a.iW||a.OB?3:this.daa&&Qa.a.any(this.daa,c=>c.paragraphNode===a)?0:Qa.a.any(this.UQb,c=>c.paragraphNode===a)||!this.ef.kt(this.YJ.Kc(a))?3:2}doSpellCheck(a,b){const c=(wa,Wa)=>{this.yz.Rhd(wa,Wa)};var f=this.dK.dNc(a);let l=
0<f.length;b=this.tCe(b,a,f,c);(f=this.qxc.tTi(a))&&this.xBi(a);const x=this.qxc.R9i(a,f),G=yb.ParagraphReader.text(a),R=a.XOb,fa=[];for(let wa=x.length-1;0<=wa;wa--){const Wa=x[wa];Wa.begin!==Wa.end&&(this.kGd.contains(Wa.lcid)?Array.add(fa,Wa):(this.Jxi(a,G,f,Wa,R),Array.removeAt(x,wa)))}l=0<fa.length||0<x.length||l;b=this.tCe(b,a,fa,Object(C.a)(this.cTb,this.cTb.AEf,"addUnsupportedRanges"));b=this.tCe(b,a,x,c);l&&this.qxc.UCh(a);return b}ke(a){const b=this.rk.ke(7,E.a.EVe);b.gd(a);return b}tCe(a,
b,c,f){Qa.a.Va(c)||(a=a||this.ke(b),f(b,c));return a}xBi(a){const b=new xe.a(4,1,500,Object(C.a)(this,this.recheckParagraphTask,"recheckParagraphTask"),48);b.customData=a;this.Rd.Cb(b)}Jhk(a,b){b="b"+b.range.begin+"e"+b.range.end+"i"+b.range.lcid+"l"+b.sma.length+b.paragraphNode.id;this.Rxc[b]=(this.Rxc[b]||0)+1;this.Esc=Math.max(this.Rxc[b],this.Esc);return this.Esc>qb.Odk?(Z.ULS.sendTraceTag(22390425,324,15,"Infinite proofing loop detected, cleaning paragraph proof state"),this.Esc=0,this.Rxc={},
this.yz.OEc(a),!1):!0}Jxi(a,b,c,f,l){const x=new N;x.oFh=u.AFrameworkApplication.lcid;x.sma=b;x.range=f;x.paragraphNode=a;x.rWf=c;x.userAction=l?1:0;const G=this.uKc.LSa;G&&this.ZXb&&(x.overriddenCritiqueTypeOptions=this.ZXb.s_d());this.Jhk(a,x)&&this.Wgj(x.range.lcid,x.range.textUnit).continueWith(R=>{R=R.result;x.Iea=2===this.uKc.Iea?0!==R?2:0:this.SUh;x.range.textUnit=R;x.descriptors=this.gRb.descriptors;this.lNi(x);G&&2===x.Iea&&this.PUh.ibd(x.range.lcid)},8).continueWith(()=>{this.executeNextRequest()})}Wgj(a,
b){return 2===this.uKc.Iea?this.eEk.Fni(a,b):kn.Task.Gt(b)}lNi(a){a.aI=new Date;Array.enqueue(this.UQb,a)}recheckParagraphTask(a){this.fR(a.customData)}executeNextRequest(){if(!this.WLc&&!this.daa){var a=[];do{if(!this.UQb.length)break;const b=Array.dequeue(this.UQb);b.isValid()&&Array.add(a,b)}while(a.length<this.wSh);0>=a.length?(this.daa=null,this.Qhl()):(this.daa=a,this.daa.sort((b,c)=>+b.aI-+c.aI),a=this.daa[0],this.rxc.track(+new Date-+a.aI,"ProofingRequestInQueue."+ha.a[a.userAction]),this.executeRequest(this.daa))}}Qhl(){for(var a=
0;a<this.wQb.length;a++)(0,this.wQb[a])();Array.clear(this.wQb);for(a=0;a<this.kCd.length;a++)(0,this.kCd[a])();Array.clear(this.kCd)}executeRequest(a){if(a&&a.length){var b=[];for(let c=0;c<a.length;++c){const f=fm.a.rej(this.WUh,a[c],this.Qfa,this.aVh,this.$Uh,this.QUh,this.TUh,this.txc);Array.add(b,f)}b=za.a.Xui(b,Cb.App.mode);this.$h.yj(this.KBd(),2,b,{"Content-Type":"application/json; charset=utf-8"},!1,3,Object(C.a)(this,this.Nhl,"spellCheckSucceeded"),Object(C.a)(this,this.Mhl,"spellCheckFailed"),
Object.assign(new Zr,{QXa:a,ly:this.Vh.zi("WebServiceCall","Proofing")}),void 0,void 0,void 0,void 0,"29")}}Nhl(a){if(!this.WLc){a=a.data;this.rxc.track(a.state.ly.Kq,"ProofingRequestRoundtrip");var b=this.Vh.zi("DOMUpdate","Proofing");this.Ohl(a);this.rxc.track(b.Kq,"UpdateProofingResults")}}Ohl(a){Me.a.mark(7798);this.daa=null;var b=a.state.QXa;if(({group:c}=Ra.a.fAh(a.Sd)).returnValue){var c=c.Responses;var f=({uXk:b,S1k:c}=this.Ngj(b,c)).returnValue;if(0<f.length){const l=this.ke(f[0].request.paragraphNode);
try{for(const x of f){const G=x.request;this.yH.nNi(G.paragraphNode,()=>{this.qdk(x.response,G)})}}finally{l&&l.dispose()}}b.length?(this.BLd(a),this.dCe(b),this.nVd()):this.TVk();this.BLd(a);for(const l of c)qr.PageStats.VTb(l);this.nVd();this.executeNextRequest()}else this.dCe(b);Me.a.mark(7799)}Ngj(a,b){let c,f;const l=[];c=[];f=[];for(let x=0;x<a.length;x++){const G=a[x];if(!G.paragraphNode.isConnected)continue;const R=b[x];if(5===R.classId){const fa=R.Fault;if(fa)switch(fa.Type){case 1:Z.ULS.sendTraceTag(22390429,
324,15,"Previous proofing char limit: {0}; char limit returned by server: {1}; proofing word length we tried {2}",this.c_e,fa.Limit,fa.AttemptedValue);this.c_e=fa.Limit;break;default:Z.ULS.sendTraceTag(22390431,324,10,"Unknown limit type violated")}else c.push(G)}else l.push(new t(G,R));R.ServerPageStatsTrace&&f.push(R.ServerPageStatsTrace)}return{returnValue:l,uXk:c,S1k:f}}qdk(a,b){const c=b.paragraphNode;if(c.isConnected)if(c.OB)this.executeNextRequest();else{var f=this.ke(c),l=this.YUh.oWk(a);
if(b.swg()){var x=b.range;const G=[x];l.zfd(a)?(x=nk.a(this.wm.iF(c)),1!==b.userAction&&c.qbi()&&this.VUh&&(a=l.Q4f(a,b,x)),this.yz.Rhd(c,G,b.rWf),a=l.IQi(a,b,x),this.wm.cDf(c,a)):this.esj(c,x);this.qxc.UCh(c)}c.Xkc();f.dispose();this.fR(c)}else this.executeNextRequest()}esj(a,b){const c=[b];b=b.lcid;this.kGd.contains(b)||(Z.ULS.sendTraceTag(42004739,324,50,"LCID {0} unsupported for proofing",b),this.kGd.add(b));this.yz.Rhd(a,c);this.cTb.AEf(a,c)}Mhl(a){a=a.data;if(!this.WLc){var b=a.state;this.rxc.track(b.ly.Kq,
"ProofingRequestRoundtrip");this.dCe(b.QXa);this.BLd(a);this.nVd()}}dCe(a){this.daa=a;a=new xe.a(3,1,this.F6,Object(C.a)(this,this.retryCurrentRequest,"retryCurrentRequest"),49);this.Rd.Cb(a);++this.Brc;this.F6*=qb.RHe;this.F6>qb.pdc&&(this.F6=qb.pdc);4!==this.Brc||this.$h.YDa||(this.Y1a=Cb.App.Hb.notificationBar.nBa(Box4Intl.Box4Strings.l_NotificationBarProofingUnavailave,!0),Cb.App.Hb.notificationBar.Wh(this.Y1a),u.AFrameworkApplication.ej.t8a(qb.QHh,1),Z.ULS.sendTraceTag(7390529,324,15,"Proofing unavailable"),
this.$h.aBc(this))}TVk(){this.Brc&&(this.Brc=0,this.F6=qb.w8a);this.Y1a&&(Cb.App.Hb.notificationBar.removeEntry(this.Y1a),this.Y1a=null,this.$h.Eed(this))}retryCurrentRequest(){this.executeRequest(this.daa)}OCb(){Cb.App.Hb.notificationBar.removeEntry(this.Y1a);this.Y1a=null;this.$h.Eed(this)}Zdc(){}get tce(){return!this.qnb.length&&!this.daa&&!this.UQb.length}BLd(a){qr.PageStats.U3a("SpellCheck",a.Kt);(a=a.qj?a.qj[Rm.a.hBa]:null)&&qr.PageStats.p3a(vu.a.Jh,a)}nVd(){qr.PageStats.TBa("SpellCheck")}}
qb.gEk="ProofingRequestsBatched";qb.fEk=1;qb.aEk="ProofingContextualResultsIsEnabled";qb.iEk="ProofingTrackMetricsIsEnabled";qb.dEk="ProofingInstrumentedAndContextualIsEnabled";qb.kEk="ProofingWithOneSpellerIsEnabled";qb.bEk="ProofingExperimentId";qb.jEk="ProofingWithEditorServiceIsEnabled";qb.cEk="ProofingFilterSpellCheckResultIsEnabled";qb.QHh=11093;qb.Odk=30;qb.w8a=1E3;qb.RHe=5;qb.pdc=72E6;Object(e.a)(qb,"ProofingCheckOperator",null,[241,1314]);var Qb=d(514);class vc{constructor(a){this.wmb=a}IQi(a,
b,c){if(this.LHe(a)){const f={};a=this.A3f(b,a,c,f);this.X9h(b,f);return a}b&&this.Y9h(b);return[]}X9h(a,b){this.wmb.track(()=>Object.assign(new Qb.a,{E:a.Iea,C:a.range.TNd,F:b}))}Y9h(a){this.wmb.track(()=>Object.assign(new Qb.a,{E:a.Iea,C:a.range.TNd}))}hxg(a,b,c){return!a||Qa.a.all(a,f=>f.begin!==b||f.end!==c)}KAg(a,b,c){return!!a&&Qa.a.any(a,f=>b>=f.begin&&c<=f.end)}}Object(e.a)(vc,"AProofingResultsManager",null,[1330]);var Zc=d(513),Wc;(function(a){a[a.none=0]="none";a[a.spelling=1]="spelling";
a[a.grammatical=2]="grammatical";a[a.advanced=3]="advanced";a[a.informational=4]="informational";a[a.consistency=5]="consistency"})(Wc||(Wc={}));Object(e.b)("ProofingType",Wc);class Md extends vc{constructor(a,b,c,f=null){super(a);this.eb=f;this.oNh=b;this.CM=c}zfd(a){return a&&63===a.classId?!0:(Z.ULS.sendTraceTag(20993182,375,10,"null response or unexpected response"),!1)}LHe(a){return this.zfd(a)&&!!a.Critiques&&0<a.Critiques.length}A3f(a,b,c,f){const l=[];b=b.Critiques;for(const R of b)if(this.otj(b,
R)&&this.w$k(R)){var x=0<=a.range.k$?a.range.k$+R.Start:a.range.begin+R.Start;const fa=x+R.Length;var G=a.sma.substring(x,fa);const wa=this.oNh.create(R,this.wmb,this.eb);wa.lcid=a.range.lcid;wa.token=G;wa.originalText=a.sma;wa.k$=a.range.k$;wa.XHa=a.range.XHa;a.range.end>=fa&&(G=new so(x,fa,wa),Array.add(l,G));this.hxg(c,x,fa)&&(x=1===wa.proofingType?Wc[wa.proofingType]:wa.typeId,f[x]=x in f?f[x]+1:1)}return l}Q4f(a,b,c){if(!this.LHe(a))return a;const f=[];for(const l of a.Critiques){const x=0<=
b.range.k$?b.range.k$+l.Start:b.range.begin+l.Start;this.KAg(c,x,x+l.Length)&&Array.add(f,l)}a.Critiques=f;return a}w$k(a){return 2!==Zc.b(a)||!this.CM.hSa}otj(a,b){if(a)for(let c=0;c<a.length;c++)if(b.Start<=a[c].Start+a[c].Length&&b.Start+b.Length>=a[c].Start&&a[c].Priority<b.Priority)return!1;return!0}}Object(e.a)(Md,"ProofingCheckResultsManager",vc,[]);var Id=d(48),Xe=d(91);class of{constructor(a,b,c,f,l,x,G){this.pvd=!1;G&&c.JM(Object(C.a)(this,this.lKk,"recheckAllParagraphs"));b.M4h(Object(C.a)(this,
this.tjk,"onAfterParagraphMerge"));l&&l.vd(12).R6(Object(C.a)(this,this.Rok,"onParagraphDisconnected"));this.yz=a;this.fRb=f;this.wm=x}Rok(a,b){yb.ParagraphReader.Vd(b.node)&&this.wm&&this.wm.g8c(b.node)}tjk(a,b){this.yz.K9h(b);this.fR(b.yTd.currentNode)}l4b(a){this.yz.Y5k(a);this.fR(a)}lKk(a){if(2===a.mode&&(a=this.Tgg(a)))for(a=Xe.a.Gz(a);a.moveNext();)yb.ParagraphReader.Rk(a.iterator)&&this.fR(a.currentNode)}suspend(){this.fRb.suspend()}resume(){this.fRb.resume()}get tce(){return this.fRb.tce}get fNe(){return this.pvd}set fNe(a){if(this.pvd!==
a&&(this.pvd=a,a=this.Tgg(Cb.App.Hb))){var b=new Id.GraphTransaction(2);try{b.set(a.Mj);const c=Xe.a.Gz(a);for(;c.moveNext();)yb.ParagraphReader.Rk(c.iterator)&&c.currentNode.kv(16,!0)}finally{b&&b.dispose()}}}Tgg(a){return(a.Hd.isEditingAllowed||a.Hd.My)&&a.Hd.nn.ho?a.Hd.nn.vg:null}h3h(a){Array.add(this.fRb.G3g,a)}fR(a){this.fRb.fR(a,!1)}}Object(e.a)(of,"ProofingManager",null,[1186]);var ih=d(1175),Aj=d(651);class $f extends Aj.a{constructor(a){super(a);this.ASb=null}get proofingType(){return 1}get suggestions(){return this.ASb?
Array.clone(this.ASb):null}R7k(a){this.ASb=a}dKa(a,b=0){this.Ssf.track(()=>Object.assign(new Qb.a,{E:0,T:1,A:a,I:b}))}}Object(e.a)($f,"OfficeSpellerErrorDetails",Aj.a,[]);class Oi extends vc{constructor(a){super(a)}zfd(a){return!!a.Errors}LHe(a){return this.zfd(a)&&0<a.Errors.length}A3f(a,b,c,f){let l=0;const x=[],G=b.Errors;for(let wa=0;wa<G.length;wa++){var R=G[wa],fa=Object.assign(new $f(this.wmb),{token:R.Word,errorType:R.Type,lcid:a.range.lcid});fa.R7k(ih.a.JFh(b.Suggestions,wa*ih.a.oBg));const Wa=
R.Offset+a.range.begin;R=Wa+R.Word.length;fa=new so(Wa,R,fa);Array.add(x,fa);this.hxg(c,Wa,R)&&l++}f.spelling=l;return x}Q4f(a,b,c){if(Qa.a.Va(c)||!a)return a;const f=[],l=[];for(let G=0;G<a.Errors.length;++G){const R=a.Errors[G];var x=R.Offset+b.range.begin;this.KAg(c,x,x+R.Word.length)&&(x=G*ih.a.oBg,Array.add(f,ih.a.tTj(a.Suggestions,x)),Array.add(f,ih.a.JFh(a.Suggestions,x)),Array.add(l,R))}a.Suggestions=f;a.Errors=l;return a}}Object(e.a)(Oi,"ProofingResultsManager",vc,[]);class wk{constructor(a,
b,c){this.sxc=new ef.a;this.O0e=b;a.ka("ProofingWithEditorServiceIsEnabled")&&this.sxc.add(63,c.value);this.sxc.add(4,this.O0e)}oWk(a){if(this.sxc.Jb(a.classId))return this.sxc.ga(a.classId);Z.ULS.sendTraceTag(20747157,375,50,"Fallback ProofingResultsManager is resolved for response: {0}",a.classId);return this.O0e}}Object(e.a)(wk,"ProofingResultsManagerResolver",null,[1185]);class Ti{constructor(a=null,b=null){this.hD=this.Xc=null;this.YFd=a;this.ZFd=b}get Qf(){!this.Xc&&this.YFd&&this.YFd.instance&&
(this.Xc=this.YFd.instance.instance);return this.Xc}get poc(){!this.hD&&this.ZFd&&this.ZFd.instance&&(this.hD=this.ZFd.instance.instance);return this.hD}VTi(a,b,c,f){if(!b)return c;" "!==a.charAt(c)&&(c=a.lastIndexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.lastIndexOf(" ",c-1);if(c<=f)break;" "===a.charAt(c+1)&&l--}c=Math.max(c,f);return" "===a.charAt(c)?c+1:c}BTi(a,b,c,f){if(!b)return c;0<c&&" "!==a.charAt(c-1)&&(c=a.indexOf(" ",c));if(0<=c)for(let l=0;l<b;l++){c=a.indexOf(" ",c+1);if(-1===c)break;
" "===a.charAt(c-1)&&l--}return c=-1===c?f:Math.min(c,f)}lSa(a){return a.properties.sa(tb.a.lSa,!1)}W4f(a){a=yb.ParagraphReader.text(a);let b;const c=[];for(;b=Ti.rwj.exec(a);)Array.add(c,new Wk.a(b.index+b[1].length,b.index+b[0].length));return c}X4f(a,b=!0,c=!1){let f=[],l=!1,x=!1,G=!1,R=!1,fa=-1;a=a.Ra;for(let Wa=0;Wa<a.length;Wa++){var wa=a.ga(Wa);wa.hyperlink?x=!0:wa.Sm&&(x=!1);b&&wa.formatting&&(G=wa.formatting.cache.HSa);if(c&&(wa.bL&&(R=!1),wa.Jp)){const mb=Object(ua.a)(658,wa.Jp.Gh);mb&&
(R=mb.mDa)}l!==(x||G||R||!!wa.blob)&&(wa=wa.cp,l?Array.add(f,new Wk.a(fa,wa)):fa=wa,l=!l)}l&&(b=Wk.a.createTextRange(fa,a.last.cp))&&Array.add(f,b);return f}dNc(a,b=!0,c=!1){return nk.e(this.W4f(a),this.X4f(a,b,c))}y_b(a,b,c){if(b===a.length)for(;0<b&&" "===a.charAt(b-1);)b--;b=a.lastIndexOf(" ",b-1)+1;c=a.indexOf(" ",c);0>c&&(c=a.length);return Wk.a.createTextRange(b,c)}HPc(a,b,c,f){if(!c||""===c||0>a||a>=b||b>c.length)return null;f=f||[];a=Ti.c9f(a,b,c);for(var l=0;l<f.length;l++){var x=f[l];if(a<
x.begin)break;a<x.end&&(a=Ti.c9f(x.end,b,c))}b=Ti.Bag(b,c);for(l=f.length-1;0<=l;l--){x=f[l];if(b>x.end)break;b>x.begin&&(b=Ti.Bag(x.begin,c))}return(a=Wk.a.createTextRange(a,b))&&a.nSj()?a:null}static c9f(a,b,c){for(;a<b&&Ka.a.Oy(c.charCodeAt(a));)a++;return a}static Bag(a,b){for(;0<a&&Ti.aFj(a,b);)a--;return a}static aFj(a,b){a=b.charAt(a-1).toString();return a===se.AParagraphNode.iJc||a===se.AParagraphNode.AZ}}Ti.rwj=RegExp("(^| )(?:[a-z+.-]+://\\S+|[a-z]:[/\\\\]\\S+|\\\\\\\\\\S+|mailto:\\S+)",
"ig");Object(e.a)(Ti,"ProofingTextUtility",null,[1312]);class mn{constructor(){this.Da=null}get name(){return"Box4.Proofing"}Wb(a){this.Da=a;this.Da.register(aq,"Box4.Proofing.ErrorRangeEditor").as("Box4.Proofing.IErrorRangeEditor").ma().na(()=>new aq(this.Da.resolve("Box4.IParagraphReader"),H.a.instance.ga(14),H.a.instance.ga(70)));this.Da.register(op,"Box4.Proofing.ModifiedRangeEditor").as("Box4.Proofing.IModifiedRangeEditor").ma().na(()=>new op(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),
this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.ISelectionManager"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa.ka("MinimizeProofedRangesIsEnabled"),u.AFrameworkApplication.fa.ka("ProofingSetCentralWordRangeIsEnabled")));this.Da.register(Lq,"Box4.Proofing.UnsupportedLanguageRangeEditor").as("Box4.Proofing.IUnsupportedLanguageRangeEditor").ma().na(()=>new Lq);this.Da.register(pm,"Box4.Proofing.ModifiedExpandRangeHelper").as("Box4.Proofing.IModifiedExpandRangeHelper").ma().na(()=>
new pm(Wr.a.instance,this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ka("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(Qo,"Box4.Proofing.ParagraphProofingFacade").as("Box4.Proofing.IParagraphProofingFacade").ma().na(()=>new Qo(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),
this.Da.resolve("Box4.ILanguageReader"),this.Da.resolve("Box4.Proofing.IModifiedExpandRangeHelper"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),Yl.a.instance,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.Ka("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(Ti,"Box4.Proofing.ProofingTextUtility").as("Box4.Proofing.IProofingTextUtility").ma().na(()=>new Ti(this.Da.Ka("Box4.TrackChange.ITrackChangeManagerFactory"),this.Da.Ka("Box4.TrackChange.ITrackChangeReaderFactory")));
const b=()=>{const c=u.AFrameworkApplication.fa.Ga("ProofingWebServiceBase");return(void 0===c?Cb.App.webServiceBase:c)+"proofing.ashx?"+u.AFrameworkApplication.hh};this.Da.register(Qm,"Box4.Proofing.EditorServiceRequestManager").as("Box4.Proofing.IEditorServiceRequestManager").ma().na(()=>new Qm(u.AFrameworkApplication.Ge,b));this.Da.register(Jp,"Box4.Proofing.ProofingLanguageInfoManager").as("Box4.Proofing.IProofingLanguageInfoManager").ma().na(()=>new Jp(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),
rb.a.instance));this.Da.register(nr,"Box4.Proofing.ProofingFeedbackLoopManager").as("Box4.Proofing.IProofingFeedbackLoopManager").ma().na(()=>new nr(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),rb.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors")));this.Da.register(mr,"Box4.Proofing.ProofingFeatureConfiguration").as("Box4.Proofing.IProofingFeatureConfiguration").ma().na(()=>new mr(u.AFrameworkApplication.fa,this.Da.Ka("Box4.Proofing.IProofingSentenceSeparator")));this.Da.register(1183,
"Box4.Proofing.IProofingDescriptors").ma().na(()=>new bt(u.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.Da.register(qb,"Box4.Proofing.ProofingCheckOperator").as("Box4.Proofing.IProofingCheckOperator").ma().na(()=>new qb(this.Da.resolve("Box4.Proofing.IErrorRangeEditor"),this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),u.AFrameworkApplication.fa,Cb.App.Hb,u.AFrameworkApplication.Ge,this.Da.resolve("Box4.Graph.IGraphTransactionFactory"),Qh.a.instance,
this.Da.resolve("Box4.Graph.IGraphIteratorFactory"),this.Da.resolve("Box4.Proofing.IProofingTextUtility"),this.Da.resolve("Box4.Proofing.IUnsupportedLanguageRangeEditor"),b,ro.a.TV(4,1,new Xr),this.Da.resolve("Box4.Proofing.IProofingResultsManagerResolver"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.Da.resolve("Box4.Proofing.IParagraphProofingFacade"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingConfigV2Manager"),
this.Da.Ka("Box4.Proofing.ICritiqueTypeSettings"),wd.a.get_instance(),u.AFrameworkApplication.pe));this.Da.register(Oi,"Box4.Proofing.ProofingResultsManager").ma().na(()=>new Oi(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>")));this.Da.register(1184,"Box4.Proofing.IIgnoreAllKeywords").ma().na(()=>new $s);this.Da.register(Md,"Box4.Proofing.ProofingCheckResultsManager").ma().na(()=>new Md(this.Da.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),
this.Da.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.Da.resolve("Box4.Proofing.IProofingFeatureConfiguration"),u.AFrameworkApplication.fa));this.Da.register(1185,"Box4.Proofing.IProofingResultsManagerResolver").ma().na(()=>new wk(u.AFrameworkApplication.fa,this.Da.resolve("Box4.Proofing.ProofingResultsManager"),this.Da.le("Box4.Proofing.ProofingCheckResultsManager")));this.Da.register(1186,"Box4.IProofingManager").ma().na(()=>new of(this.Da.resolve("Box4.Proofing.IModifiedRangeEditor"),
this.Da.resolve("Box4.IParagraphEditor"),this.Da.resolve("Box4.IAppFrame"),this.Da.resolve("Box4.Proofing.IProofingCheckOperator"),this.Da.qb("Box4.INotebookManager").DU,this.Da.qb("Box4.Proofing.IErrorRangeEditor"),4!==Cb.App.mode));this.Da.register(1187,"Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>").ma().na(()=>new or(u.AFrameworkApplication.fa.ka("ProofingTrackMetricsIsEnabled"),ro.a.TV(15,1,new Oo)));this.Da.register(1188,"Box4.Proofing.IProofingConfigV2Manager").ma().na(()=>
new Yr(this.Da.resolve("Box4.Proofing.IEditorServiceRequestManager"),rb.a.instance,this.Da.resolve("Box4.Proofing.IProofingDescriptors"),this.Da.resolve("Box4.Proofing.IProofingLanguageInfoManager"),this.Da.resolve("Box4.Proofing.IProofingCritiqueCategoryInfoFilter")))}init(){this.Da.resolve("Box4.IProofingManager")}dispose(){}static main(){m.a.instance.Bc(new mn)}}Object(e.a)(mn,"Box4ProofingPackage",null,[2,3]);var ki=d(171);class nn{constructor(a){this.sSe=0;this.j8a=this.ZEb=this.Mhb=null;this.E$=
u.AFrameworkApplication.Aa.EU;this.dQ=a;this.dQ.fu(bf.a.Kmh);this.dQ.kB(bf.a.Kmh,Object(C.a)(this,this.upk,"onReceivedCustomAuthConfig"))}getCustomAuthConfig(){if(this.j8a)return Z.ULS.sendTraceTag(589050652,344,100,"Returning existing promise"),this.j8a;this.Mhb=this.E$.zi("ComponentAttach","getCustomAuthConfig");return this.j8a=new Promise((a,b)=>{const c={};let f=!1,l=!1,x=0;this.sSe=window.setInterval(()=>{4>x?(x++,this.dQ.sendMessage(bf.a.getCustomAuthConfig,c)):(window.clearInterval(this.sSe),
f=!0,Z.ULS.sendTraceTag(588087303,344,10,Yd.c({["error"]:"Request timeout after 4 retries."})),b("Request timeout."))},1E3);this.ZEb=(G,R)=>{window.clearInterval(this.sSe);f||l||(l=!0,G?(Z.ULS.sendTraceTag(589050653,344,50,"Resolving Promise with authConfig"),a(G)):(Z.ULS.sendTraceTag(589050654,369,10,Yd.c({["error"]:R.toString()})),b(R)))};this.dQ.sendMessage(bf.a.getCustomAuthConfig,c)})}upk(a){try{const b=Yd.a(a.Values[ki.a.Dji]);let c=u.AFrameworkApplication.fa.Ga("Application")||"";c=Ka.a.wg(c);
b.appSignInUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSignInToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";b.appSwitchUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1&prompt=select_account";b.appSwitchToUrl="https://www.office.com/login?ru=%2Flaunch%2F"+c+"%3Facctsw%3D1";this.Mhb&&(this.Mhb.stop(),this.Mhb=null);this.ZEb(b,"")}catch(b){Z.ULS.sendTraceTag(589050655,344,10,Yd.c({["error"]:b.message,["stack"]:b.stack})),
this.ZEb(null,b.message)}}}Object(e.a)(nn,"AccountSwitchingManager",null,[1265]);class to{get name(){return"Common.App.AccountSwitching"}Wb(a){a.register(nn,"Common.App.AccountSwitching.AccountSwitchingManager").as("Common.App.AccountSwitching.IAccountSwitching").ma().na(()=>new nn(a.resolve("Postmessage.IHostPostmessenger")))}init(){}dispose(){}static main(){m.a.instance.Bc(new to)}}Object(e.a)(to,"AccountSwitchingPackage",null,[2,3]);class So{constructor(){this.Pa=new ic.a}wBc(a){this.Pa.addHandler("OnEditHappenedEvent",
a)}OGk(){this.Pa.raiseEvent("OnEditHappenedEvent")}}Object(e.a)(So,"EditNotificationEventSource",null,[]);var on=d(100);class Dl{constructor(a,b,c,f,l,x,G=0){this.vtd=!1;this.utd=this.I1a=null;this.VAf=!1;this.Rd=b;this.jwc=a;this.HLa=c;this.gga=f;this.TAf=l;this.UMh=x;this.Gsc=0;this.Ftc=!1;try{0<G&&(this.Gsc=G,3E5>this.Gsc&&(this.Gsc=3E5),this.Rd&&!this.utd&&(this.utd=new xe.a(3,2,this.Gsc,Object(C.a)(this,this.CUk,"reportEditDocumentUserActionTelemetryIfNecessary")),this.Rd.Cb(this.utd)))}catch(R){Z.ULS.sendTraceTag(51246176,
383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+R)}}get gAl(){return this.VAf}SUd(){this.gAl?this.Ftc=!0:(this.VAf=!0,vf.Health.instance.addQosPillar("Save"),vf.Health.instance.addQosPillar("ContentCreation"),on.c(F.a.editDocument));this.vtd=!0;this.TAf&&this.TAf.BCf();this.gga&&this.gga.OGk();u.AFrameworkApplication.Tg&&u.AFrameworkApplication.Tg.Xck();this.UMh&&!this.I1a&&(this.Nkc(null),this.I1a=new xe.a(3,2,this.jwc,Object(C.a)(this,this.Nkc,
"sendPostMessageIfNecessary"),113),this.Rd.Cb(this.I1a))}Nkc(){this.vtd&&(this.HLa.CWR(()=>this.HLa.result.sendMessage(bf.a.editNotification,null)),Z.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this.vtd=!1)}CUk(){try{this.Ftc&&(on.c(F.a.editDocument),this.Ftc=!1)}catch(a){this.Ftc=!1,Z.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+a)}}}Object(e.a)(Dl,"EditNotificationManager",null,[1270]);
class Fk{constructor(a,b,c,f,l){this.Wud=this.I1a=null;this.hlb=this.Tpd=!1;this.Rd=b;this.jwc=a;this.HLa=c;this.eP=f;this.uAd=l;this.wdh(null)}wdh(){const a=document.getElementById(u.AFrameworkApplication.BUb);!this.hlb&&this.eP&&a&&(this.eP.ob(ma.a.fq,a,Object(C.a)(this,this.Cue,"mouseActivityHandler"),null),this.hlb=!0);this.uAd(()=>{this.dispose()})}Cue(){this.hlb&&(this.eP.xb(ma.a.fq,document.getElementById(u.AFrameworkApplication.BUb),Object(C.a)(this,this.Cue,"mouseActivityHandler")),this.hlb=
!1);this.BCf();return!1}BCf(){this.Tpd=!0;this.Wud||(this.Wud=new xe.a(3,2,this.jwc,Object(C.a)(this,this.wdh,"registerHandlerTask"),112),this.Rd.Cb(this.Wud));this.I1a||(this.Nkc(null),this.I1a=new xe.a(3,2,this.jwc,Object(C.a)(this,this.Nkc,"sendPostMessageIfNecessary"),111),this.Rd.Cb(this.I1a))}Nkc(){this.Tpd&&(this.HLa.CWR(()=>this.HLa.result.sendMessage(bf.a.Xzl,null)),Z.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this.Tpd=!1)}dispose(){this.hlb&&
(this.eP.xb(ma.a.fq,document.getElementById(u.AFrameworkApplication.BUb),Object(C.a)(this,this.Cue,"mouseActivityHandler")),this.hlb=!1)}}Object(e.a)(Fk,"UserActivityHostNotificationManager",null,[1269,106]);var El=d(132),Mn=d(287);class qm{constructor(){this.Da=null}get name(){return"Common.App.EditNotification"}init(){u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ff(Object(C.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){qm.CLi&&0<qm.TUd&&(this.Da.register(So,"Common.App.HostNotification.EditNotificationEventSource").ma(),
this.Da.register(Fk,"Common.App.HostNotification.UserActivityHostNotificationManager").as("Common.Interface.IUserActivityHostNotificationManager").ma().na(()=>new Fk(6E4,El.a.instance,Mn.a.Ju(this.Da.Ka("Postmessage.IHostPostmessenger")),ja.a.instance,u.AFrameworkApplication.ofa)),this.Da.register(Dl,"Common.App.HostNotification.EditNotificationManager").as("Common.Interface.IEditNotificationManager").ma().na(()=>new Dl(qm.TUd,El.a.instance,Mn.a.Ju(this.Da.Ka("Postmessage.IHostPostmessenger")),this.Da.resolve("Common.App.HostNotification.EditNotificationEventSource"),
this.Da.qb("Common.Interface.IUserActivityHostNotificationManager"),qm.DLi,qm.ALi)),this.Da.resolve("Common.Interface.IEditNotificationManager"),Z.ULS.shipAssertTag(38086291,209,0<qm.TUd,"EditNotification Interval is less than or equal to 0."))}Wb(a){this.Da=a}dispose(){}static get TUd(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditNotificationTimeIntervalMs||"300000"):3E5}static get ALi(){return u.AFrameworkApplication.fa?parseInt(u.AFrameworkApplication.fa.appSettings.EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||
"0"):0}static get CLi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationIsEnabled")}static get DLi(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("EditNotificationPostMessageIsEnabled")}static main(){m.a.instance.Bc(new qm)}}Object(e.a)(qm,"CommonHostNotificationPackage",null,[2,3]);class pn{}pn.W6c="ReactSharedHeaderMeControlFlexPane";pn.PRa="headerui";pn.bWb="chat_wrapper_pane";Object(e.a)(pn,"ReactSharedHeaderConstants",null,[]);class ag{constructor(a){this.Asf=
0;this.Grd=null;this.sVh=a}get chat(){return window.swc}get isInitialized(){return!!this.chat}get IMe(){return this.sVh.value}ub(){this.isInitialized?this.hed():this.VNk(Object(C.a)(this,this.hed,"registerActionsInternal"))}hed(){Z.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.isInitialized&&(this.chat.getContainerProvider().then(a=>{a.getChatsContainer(Object(C.a)(this,this.rkk,"onChatContainerReady"))}).catch(a=>{Z.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",
a)}),this.chat.getChatsCounter().then(a=>{a.onChatsCountChange(Object(C.a)(this,this.Hmi,"chatCountChanged"))}).catch(a=>{Z.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",a)}),this.chat.getKeyboard().then(a=>{a.onKeyDown(Object(C.a)(this,this.ukk,"onChatKeyPress"))}).catch(a=>{Z.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",a)}))}catch(a){Z.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",a)}}Hmi(a){Z.ULS.sendTraceTag(50595970,
333,50,"Chat count:{0}",a);if(!a)this.IMe.qkk();else if(1===a&&!this.Asf){const b=document.getElementById(this.Grd?this.Grd:pn.bWb);b?this.IMe.vkk(b,Object(C.a)(this,this.Zpl,"transferFocusToChat")):Z.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}this.Asf=a}rkk(a){this.Grd=a}ukk(a){a.ctrlKey&&"f6"===a.key.toLowerCase()&&this.Ypl(a.shiftKey)}VNk(a){gi.a.instance.ob(ma.a.Tkl,window.self,()=>{a();return!0})}Zpl(){Z.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.isInitialized&&
this.chat.getFocuser().then(a=>{a.focusConversationInput()}).catch(a=>{Z.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",a)})}catch(a){Z.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",a)}}Ypl(a){Z.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat");this.IMe.skk(a)}}Object(e.a)(ag,"ChatManager",null,[1258]);class wu{constructor(){this.Pa=new ic.a;this.Kzf=!1}d7h(a){this.Pa.addHandler("OnTopRowControlsCreatedEvent",a)}L6h(a){this.Pa.addHandler("OnRenameTextboxStatusChangedEventKey",
a)}get rpl(){return this.Kzf}DHk(){this.Kzf=!1;this.Pa.raiseEvent("OnTopRowControlsDisposingEvent")}nbh(a){this.Pa.raiseEvent("OnRenameTextboxStatusChangedEventKey",a?"true":"false")}}Object(e.a)(wu,"HeaderEventSource",null,[]);var ct=d(197);class $r{constructor(a,b,c,f,l){this.Nzc=null;this.Kd=a;this.yR=b;this.eP=c;this.pZh=f;this.Ca=l}vdh(a,b,c,f=null){const l=this.Kd.Dc(b);l.parent=c;l.cL=!0;f&&l.$aa(f);this.eP.O6(b,a,!1);this.pZh.O6(b,a,!1);b=new ct.DOMFocusListing(()=>a);b.vo(2);b.vo(1);b.vo(8);
b.vo(5);b.vo(3);b.vo(6);this.Kd.Jha(()=>a,l,b).DW=!0;b=A.KeyInputManager.Na(w.a.Iq,0);c=A.KeyInputManager.Na(w.a.Iq,4);l.np(b);l.np(c)}onFlexPaneOpen(a){this.vdh(a,pn.W6c,pn.PRa);this.Kd.Bf(pn.W6c);this.yR.P1(pn.W6c)}onFlexPaneClose(){this.yR.zo(pn.W6c);this.Kd.Bf(pn.PRa)}vkk(a,b){this.Nzc||(this.Nzc=b,this.vdh(a,pn.bWb,y.AFrame.mD,Object(C.a)(this,this.tkk,"onChatFocus")));this.Kd.Bf(pn.bWb);this.yR.P1(pn.bWb)}tkk(){this.Nzc&&this.Nzc()}qkk(){this.yR.zo(pn.bWb);this.Kd.wLc(y.AFrame.PV)}skk(a){this.Ca.processAction(a?
F.a.zWd:F.a.kpd,2)}}Object(e.a)($r,"ReactSharedHeaderFocusManager",null,[1160]);var ay=d(515);class xu{constructor(a){this.Ca=a}ub(){this.Ca.ya(F.a.ILc,xd.a.frame,Object(C.a)(this,this.CWg,"navigateToUpsellPage"));this.Ca.ya(F.a.hXi,xd.a.frame,Object(C.a)(this,this.launchUpsellExperience,"launchUpsellExperience"));this.Ca.ya(F.a.IUk,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(F.a.Jgh,xd.a.frame,Kd.ActionManager.Hg)}CWg(a,b,c,f,l){if(1===c)return 32;a=8;2===c&&(c=this.l_d(l,"experience","gopremiumribbon"),
l=Ze.a.XV("2116536"),l=Ze.a.u3a(l,"ocid",ay.b(u.AFrameworkApplication.Aa.jb.rm,u.AFrameworkApplication.Aa.jb.rHa,c)),ib.a.an(l,"_blank",void 0,"NavigateToUpsellPage"),a=32,this.Ca.processAction(F.a.Jgh,2),Z.ULS.sendTraceTag(38929747,340,50,"User directed to POC"));return a}launchUpsellExperience(a,b,c,f,l){if(1===c)return 32;var x=8;2===c&&(Z.ULS.sendTraceTag(592721857,340,50,"LaunchUpsellExperience from Ribbon"),(x=fb.a.instance.qb("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))?
(a=this.l_d(l,"experience","gopremium"),l=this.l_d(l,"dimeCampaignId",null),x.launchUpsellExperience(a,l),x=32):(Z.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),x=this.CWg(a,b,c,f,l)));return x}l_d(a,b,c){a&&a[b]&&(c=Object(ua.a)(String,a[b]));return c}}Object(e.a)(xu,"UpsellActor",null,[1257]);class dt{constructor(){this.Da=null}get name(){return"Common.App.Header"}init(){fb.a.instance.resolve("Common.App.Header.IUpsellActor").ub();fb.a.instance.resolve("Common.App.Header.IChatManager").ub()}dispose(){}Wb(a){this.Da=
a;this.Da.register(wu,"Common.App.Header.HeaderEventSource").ma();this.Da.register(xu,"Common.App.Header.UpsellActor").as("Common.App.Header.IUpsellActor").ma().na(()=>new xu(u.AFrameworkApplication.Ta));this.Da.register($r,"Common.App.Header.ReactSharedHeaderFocusManager").as("Common.App.Header.IReactSharedHeaderFocusManager").ma().na(()=>new $r(u.AFrameworkApplication.Aa.Lr,u.AFrameworkApplication.Aa.Aw,u.AFrameworkApplication.Aa.jR,u.AFrameworkApplication.Aa.oib,u.AFrameworkApplication.Ta));this.Da.register(ag,
"Common.App.Header.ChatManager").as("Common.App.Header.IChatManager").ma().na(()=>new ag(this.Da.le("Common.App.Header.IReactSharedHeaderFocusManager")))}static main(){m.a.instance.Bc(new dt)}}Object(e.a)(dt,"CommonAppHeaderPackage",null,[2,3]);class yu{constructor(a,b,c,f=null,l=null){this.OE=a;this.fOb=b;this.cOb=c;this.Dlf=f;this.bRb=l}YJc(a){const b=new Sys.StringBuilder(this.OE.gkc);b.append("RoamingServiceHandler.ashx?action=");b.append("getFirstRunExperienceSettings");b.append("&");b.append(this.p2d(a));
b.append("&");b.append(u.AFrameworkApplication.hh);u.AFrameworkApplication.Ge.yj(b.toString(),1,null,null,!0,2,Object(C.a)(this,this.PCa,"getRequestSuccessCallback"),Object(C.a)(this,this.Tia,"getRequestFailureCallback"),null)}Xrb(a){var b=new Sys.StringBuilder(this.OE.gkc);b.append("RoamingServiceHandler.ashx?action=");b.append("saveFirstRunExperienceSettings");b.append("&");b.append(u.AFrameworkApplication.hh);b=b.toString();a=Yd.c(a);u.AFrameworkApplication.Ge.yj(b,2,a,null,!0,4,Object(C.a)(this,
this.vzk,"postRequestSuccessCallback"),Object(C.a)(this,this.i$,"postRequestFailureCallback"),null)}PCa(a){let b=!1,c=null;try{if(0<a.data.Sd.length){const f=Object(ua.a)(Object,Yd.a(a.data.Sd)),l=f?f[this.OE.MJd]:null;l&&(c=Object(ua.a)(Object,Yd.a(l.toString())))}b=!0}catch(f){this.Tia(null)}b&&this.fOb&&this.fOb(a.data,c)}Tia(a){this.cOb&&this.cOb(a?a.data:null)}vzk(a){this.Dlf&&this.Dlf(a?a.data:null)}i$(a){this.bRb&&this.bRb(a?a.data:null)}p2d(a){const b=new Sys.StringBuilder("requestedsettings=");
for(let c=0;c<a.count;c++)b.append(a.ga(c)),c<a.count-1&&b.append(";");return b.toString()}}Object(e.a)(yu,"FirstRunExperienceRequestHandler",null,[]);var zu=d(391);class Au{constructor(){this.NNb=this.jtc=this.OE=null}QNe(a){a?(this.OE=a,this.dLj()&&(Z.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),a=new Ha.a,a.add(this.OE.MJd),this.jtc=new yu(this.OE,Object(C.a)(this,this.PCa,"getRequestSuccessCallback"),Object(C.a)(this,this.Tia,
"getRequestFailureCallback"),null,Object(C.a)(this,this.i$,"postRequestFailureCallback")),this.jtc.YJc(a)),(this.OE.aAg||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.RNe()):Z.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")}dLj(){try{if(this.OE.aAg)return!0;if(!u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||u.AFrameworkApplication.fa.ka("IsAnonymousUser"))return!1;
if(this.OE.YGj||this.OE.cxb||u.AFrameworkApplication.fa.ka("IsO365ConsumerHost"))return!0;const a=u.AFrameworkApplication.fa.Ga("FlightId");return-1!==(a?a.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(a){Z.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",a?a.toString():null)}return!1}ikh(a){const b={},c={};c.FREDisplayedDate=(new Date).toUTCString();c.VersionDisplayed=a;c.RemindMeLater=!1;b[this.OE.MJd]=Yd.c(c);Z.ULS.sendTraceTag(51675533,306,50,"Initiating call to save FRE data for current user from Roaming Settings Service");
this.jtc&&this.jtc.Xrb(b)}PCa(a,b){a=a?+a.Wu-+a.Kt:-1;a>this.OE.Lih?Z.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",a,this.OE.Lih):b?this.Fcl(b)?(Z.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",this.OE.gVg),this.RNe()):(this.YTd(!1),
Z.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required.")):(Z.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.RNe())}Tia(a){this.YTd(!1);Z.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",a?a.Le:-1)}i$(a){Z.ULS.sendTraceTag(51675542,306,10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",
a?a.Le:-1)}RNe(){this.YTd(!0);var a=fb.a.instance.qb("Common.ISystemInitiatedFeedback");a?this.jsh(a):(Z.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((a=fb.a.instance.Ka("Common.ISystemInitiatedFeedback"))?a.execute(b=>{this.jsh(b)}):Z.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))}jsh(a){if(a){var b=this.OE.yVi;
b&&(u.AFrameworkApplication.Wj(b),u.AFrameworkApplication.s7b(b));Z.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",b);a.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.NNb=Object(C.a)(this,this.emk,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",this.NNb,!0),window.addEventListener("FRELaunchedEvent",this.NNb,!0)):(Z.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),
this.ikh(this.OE.currentVersion))}else Z.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")}emk(a){if(a){var b=a.detail;a=a.type;var c=this.OE&&this.OE.jNf?this.OE.jNf.split("-")[0]:null;if("FRELaunchedEvent"===a||c&&b&&b.id&&-1!==b.id.indexOf(c))b.success&&(Z.ULS.sendTraceTag(51675546,306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.ikh(this.OE.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.NNb,!0),window.removeEventListener("FRELaunchedEvent",
this.NNb,!0))}}Fcl(a){if("RemindMeLater"in a&&"FREDisplayedDate"in a){if("true"===a.RemindMeLater.toString()&&(+new Date-+new Date(a.FREDisplayedDate.toString()))/36E5>this.OE.gVg)return!0}else if(u.AFrameworkApplication.fa.ka("WacShowVersionBasedFREToAllUsers")&&"VersionDisplayed"in a&&a.VersionDisplayed<this.OE.currentVersion)return Z.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1}YTd(a){u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.DispatchFREDecisionEvent")&&
zu.a.dispatch("FREDecisionEvent",{["show"]:a})}}Object(e.a)(Au,"FirstRunExperienceLauncher",null,[1232]);class Bu{constructor(){this.Da=null}get name(){return"Common.App.FirstRunExperienceLauncher"}Wb(a){this.Da=a;this.Da.register(1232,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").ma().na(()=>new Au)}init(){}dispose(){}static main(){m.a.instance.Bc(new Bu)}}Object(e.a)(Bu,"FirstRunExperienceLauncherPackage",null,[2,3]);class as{constructor(){this.Qpd={}}p0h(a){this.Qpd[a.id.toString()]=
a}aik(a){const b=this.Qpd;for(let c in b)b[c].notify(a,!1);this.Qpd={}}VEk(a,b){b&&this.p0h(b);return this.P1g(a,b)}$Ud(a){this.aik(a)}y0f(a,b){a.notify(b,!0)}}Object(e.a)(as,"AEventEmitter",null,[1256]);var To;(function(a){a[a.notStarted=0]="notStarted";a[a.waiting=1]="waiting";a[a.shouldRetry=2]="shouldRetry";a[a.complete=3]="complete"})(To||(To={}));Object(e.b)("EventResultState",To);class bs{constructor(){this._state=0}get state(){return this._state}set state(a){Z.ULS.sendTraceTag(5849616,202,
50,"Changing event result state. {0}",{["OldState"]:To[this._state],["NewState"]:To[a]},"ResultType",this.Yeg());this._state=a}}Object(e.a)(bs,"AEventResult",null,[1286]);class aw extends bs{constructor(){super();this.FEd=this.YQb=null;this.state=0;this.dwd=this.s8e=!1}get VQ(){return this.YQb}get CJa(){return this.FEd}get zCj(){return this.s8e}Yeg(){return"GetMoreInfo Result"}}Object(e.a)(aw,"GetMoreInfoResult",bs,[1288,1286]);var bw=d(427),cw=d(516);class pp{constructor(a,b,c,f,l,x,G,R){this.Ca=
a;this.$h=b;this.yH=c;this.T5=f;this.Rd=l;this.bOb=x;this.OOh=G;this.ezc=R}JMk(){this.PCb.ya(F.a.QDb,xd.a.frame,Object(C.a)(this,this.QDb,"openUrlInNewTab"));this.PCb.ya(F.a.dze,xd.a.frame,Object(C.a)(this,this.dze,"openDocumentUrl"));u.AFrameworkApplication.Iba?this.zDg():this.PCb.pa(F.a.KIc,xd.a.frame,Object(C.a)(this,this.KIc,"documentLoaded"),96)}QDb(a,b,c,f,l){l&&l.MenuItemId&&(Z.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:cw.a[this.Bva]}),ib.a.an(l.MenuItemId.toString(),
"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32}dze(a,b,c,f,l){if(l&&l.MenuItemId){const x=u.AFrameworkApplication.fa.ka("WacInTabOpenMRUIsEnabledForUiHost"),G=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");Z.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",x,G);if(x&&G){Z.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",{["Id"]:l.SourceControlId,["AppType"]:cw.a[this.Bva]});a=l.MenuItemId.toString();
const R={};R[ki.a.sFb]="1";R[ki.a.documentUrl]=a;R[ki.a.reason]=bw.a.open;Z.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");u.AFrameworkApplication.ES().execute(fa=>{fa.sendMessage(bf.a.KBa,R)})}else this.QDb(a,b,c,f,l)}return 32}KIc(){this.zDg();return 32}g$a(a,b,c=""){if(b&&b.Kt){const f=jk.a[b.status];b=b.Kt.getTime();const l=this.gF()-b;Z.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{["Caller"]:a,["RequestStatus"]:f,["ElapsedMs"]:l,
["StartTime"]:b,["Notes"]:c})}else Z.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{["Caller"]:a})}zDg(){var a=u.AFrameworkApplication.fa.ka("QPGVCI"),b=Ze.a.BS(document.URL,"wdNewAndOpenCt",a);if(b){b=parseInt(b);var c=Ze.a.BS(document.URL,"wdPreviousSession",a);a=Ze.a.BS(document.URL,"wdPreviousCorrelation",a);var f=u.AFrameworkApplication.fa.ka("NAOPLP");if(u.AFrameworkApplication.Iba){var l=u.AFrameworkApplication.Iba.getTime();!b||
b>l?Z.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{["ClickTimestamp"]:b,["DocumentLoadedTime"]:l,["SessionId"]:c,["Correlation"]:a}):Z.ULS.sendTraceTag(5849683,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{["ClickToLoadTime"]:l-b,["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}else Z.ULS.sendTraceTag(5849681,202,f?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",
{["ClickTimestamp"]:b,["SessionId"]:c,["Correlation"]:a})}}get PCb(){return this.Ca.value}get $dc(){return this.$h.value}get JWg(){return this.yH.value}get Bva(){return this.T5.value}get L7c(){return this.Rd.value}get gF(){return this.bOb}get Xla(){return this.OOh.value}get EJa(){return this.ezc.value}static get instance(){return pp.Ja||(pp.Ja=pp.mr())}static mr(){return new pp(new Sa.a(()=>u.AFrameworkApplication.Ta),new Sa.a(()=>u.AFrameworkApplication.Ge),new Sa.a(()=>u.AFrameworkApplication.Aa),
new Sa.a(()=>u.AFrameworkApplication.Aa.jb.rm),new Sa.a(()=>u.AFrameworkApplication.pe),()=>(new Date).getTime(),new Sa.a(()=>u.AFrameworkApplication.Aa.jb.Xla),new Sa.a(()=>u.AFrameworkApplication.EJa))}}pp.Ja=null;Object(e.a)(pp,"NewAndOpenCommonHelpers",null,[1255]);class dw{constructor(a,b,c){this.xyc=this.Lm=null;this.KCd=0;this.HWh=a;this.Rd=b;this.$0e=c}I9h(){this.KCd=this.oGb+1}zHe(a){this.Lm&&(this.Rd.Ng(this.Lm),this.Lm=null);a&&(this.KCd=0)}Uil(a){const b=this.tol;0<=b?(this.I9h(),this.zHe(!1),
this.Lm=new xe.a(4,1,b,a,107),this.Rd.Cb(this.Lm)):(this.zHe(!0),Z.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{["Action"]:this.$0e}))}get oGb(){return this.KCd}get tol(){return this.oGb>=this.amh.length?-1:this.amh[this.oGb]}get amh(){if(!this.xyc){const a=(this.HWh.value||"0").split(",");this.xyc=[];for(let b=0;b<a.length;b++){const c=parseInt(a[b]);isNaN(c)?Z.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{["Action"]:this.$0e,["Entry"]:a[b]}):
Array.add(this.xyc,c)}}return this.xyc}}Object(e.a)(dw,"RetryHelper",null,[]);class Sm extends as{constructor(a,b){super();this.Fga=a;this.CRb=new dw(b,this.Fdc.L7c,"GetMoreInfo");this.Ex=new aw}xck(){this.Gte("Document opened")}IAi(a){return()=>{this.Gte(a,!0)}}P1g(a,b=null){Z.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{["Trigger"]:a});3===this.Ex.state?(b&&this.y0f(b,this.Ex),Z.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{["Trigger"]:a})):
this.Gte(a);return this.Ex}Gte(a,b=!1){this.CRb.zHe(!b);1===this.Ex.state?Z.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{["Trigger"]:a,["RetryIndex"]:this.CRb.oGb}):(Z.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{["Trigger"]:a,["RetryIndex"]:this.CRb.oGb}),this.Ex.state=1,b=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.Fdc.Xla,u.AFrameworkApplication.hh),this.Fdc.$dc.sV(b,1,null,null,[Sm.njf,Sm.eyf],5,this.Lzi(),this.Kzi(a),
null))}Lzi(){return a=>{var b=!1;let c=!1;var f=!1,l;u.AFrameworkApplication.fa.ka("GetMoreInfoDataFromResponseBody")&&(a.data.Sd?({ou:l}=Yd.d(a.data.Sd)).returnValue?l?(f=!0,this.Ex.FEd=l.StorageServiceDisplayName,this.Ex.YQb=Sm.DAg(l.PersonalFileStorageUrl)?l.PersonalFileStorageUrl:"",""===this.Ex.VQ&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ga("FileSource")&&(this.Ex.YQb=Ze.a.Mma(u.AFrameworkApplication.breadcrumbFolderUrl)),b=""===this.Ex.VQ&&""!==this.Ex.CJa):Z.ULS.sendTraceTag(25298113,
202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):Z.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers"):Z.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers"));f||((l=a.data.qj)?(this.Ex.FEd=(l[Sm.eyf]||"").toString(),b=(l[Sm.njf]||"").toString(),
this.Ex.YQb=Sm.DAg(b)?b:"",""===this.Ex.VQ&&"SharePointOnlineConsumer"===u.AFrameworkApplication.fa.Ga("FileSource")?(this.Ex.YQb=Ze.a.Mma(u.AFrameworkApplication.breadcrumbFolderUrl),b=""===this.Ex.VQ&&""!==this.Ex.CJa):b=""===b&&""!==this.Ex.CJa):(Z.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),c=!0));f=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",this.CRb.oGb,c,b,f);this.Fdc.g$a("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",
a.data,f);this.nmh(3,b,c)}}Kzi(a){return b=>{this.Fdc.g$a("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",b.data,"Failure");this.nmh(2);this.CRb.Uil(this.IAi(a))}}nmh(a,b=!1,c=!1){this.Ex.state=a;this.Ex.s8e=b;this.Ex.dwd=c;this.$Ud(this.Ex)}get Fdc(){return this.Fga.value}static get instance(){return Sm.Ja||(Sm.Ja=Sm.mr())}static mr(){return new Sm(new Sa.a(()=>pp.instance),new Sa.a(()=>u.AFrameworkApplication.X9i))}static DAg(a){if(!a)return Z.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),
!1;if(Ka.a.wg(a).startsWith("https://"))return!0;Z.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme.");return!1}}Sm.njf="PersonalFileStorageUrl";Sm.eyf="StorageServiceDisplayName";Sm.Ja=null;Object(e.a)(Sm,"GetMoreInfoActor",as,[]);class Kp{constructor(a,b,c,f,l){this.qPh=6E4;this.Rng="inactive";this.tCf="active";this.yga=!0;this.Rd=a;this.qOh=b;this.bOb=c;this.Gzc=f;this.Pa=new ic.a;l&&this.Mil();this.eef=this.tcg()}JCf(a){this.Pa.addHandler(this.tCf,a)}J2h(a){this.Pa.addHandler(this.Rng,
a)}Mil(){const a=new xe.a(5,2,this.qPh,Object(C.a)(this,this.pxj,"inactiveLoop"),108);this.qxj.Cb(a)}pxj(){const a=this.tcg(),b=this.gF()-a;b>this.Xld&&this.yga&&(Z.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{["TimeSinceLastActive"]:b}),this.yga=!1,this.Pa.raiseEvent(this.Rng));a-this.eef>this.Xld&&(this.yga=!0,this.Pa.raiseEvent(this.tCf));this.eef=a}get qxj(){return this.Rd.value}get tcg(){return this.qOh}get gF(){return this.bOb}get Xld(){return this.Gzc.value}static get instance(){return Kp.Ja||
(Kp.Ja=Kp.mr())}static mr(){return new Kp(new Sa.a(()=>El.a.instance),()=>u.AFrameworkApplication.Lde.getTime(),()=>(new Date).getTime(),new Sa.a(()=>u.AFrameworkApplication.Xld),!0)}}Kp.Ja=null;Object(e.a)(Kp,"InactivityManager",null,[]);var Cu=d(901);class ew extends bs{constructor(){super();this.QSh=this.Ngf=this.Mgf=null;this.state=this.Gzf=0;this.dwd=!1}get cve(){return this.Mgf}get iWg(){return this.Ngf}get wol(){return this.Gzf}Yeg(){return"MruActor Result"}}Object(e.a)(ew,"MruResult",bs,[1285,
1286]);var dq=d(172);class Du{constructor(a,b,c){this.task=null;this.w8a=a;this.hek=b;this.taskManager=c;this.retryCount=this.g4b=0;this.FBd=this.N6b=null}TMj(a,b){return a===dq.a.CYd||20===b||18===b||3===b}uOj(a){return 3===a||5===a||6===a||7===a||9===a||10===a||11===a||12===a||13===a||14===a||15===a||16===a||23===a||26===a||27===a||28===a}get Ybd(){return this.FBd}reset(){this.g4b=this.retryCount=0;this.FBd=this.N6b=null;this.task&&(this.taskManager.Ng(this.task),this.task=null)}fBj(a,b,c,f){this.FBd=
String.format("{0}_{1}",c,f);if(this.retryCount>=this.hek)return Z.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.TMj(c,f))return Z.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.uOj(f)&&1<=this.g4b)return this.N6b=c,!1;b=Math.max(b,this.w8a*Math.pow(2,this.g4b));if(26===f)b=Math.max(b,3E4);else if(27===f||28===f)b=Math.max(b,6E4);9===f||412===c&&(null==this.N6b||412!==this.N6b)?b=500:this.g4b+=1;this.N6b=c;this.retryCount+=1;this.task&&
this.taskManager.Ng(this.task);Z.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",b);this.task=new xe.a(2,1,b,a,107);this.taskManager.Cb(this.task);return!0}}Object(e.a)(Du,"RetryManager",null,[]);var eq=d(214),Lg=d(72);class fw{constructor(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}}Object(e.a)(fw,"WriteOptions",null,[]);class qn extends as{constructor(a,b,c,f,l,x,G){super();this.Fga=a;this.WRh=b;this.RMa=new Du(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.pO.L7c);this.xNa=new Du(u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.pO.L7c);this.wVh=c;this.UBf=f;this.I_h={};this.t6=new ew;this.mOh=l;this.awc="";this.HE=x;this.C3e=G}get bpd(){return this.I_h}OOk(){this.pO.PCb.ya(F.a.Xfh,xd.a.frame,
Object(C.a)(this,this.mTk,"renameMruEntry"))}mTk(){return this.XWe("Rename")}Fck(){this.PTg("File Opened")}Gck(){this.PTg("IntervalUpdate")}PTg(a){Z.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{["Trigger"]:a});this.XWe(a)}WV(a){(a=Ka.a.WV(a))&&a.startsWith(".")&&(a=a.substring(1,a.length));return a}O8f(){switch(this.pO.Bva){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}}qjj(a){var b=this.mOh();
if(!b)return null;const c=new fw;c.documentUrl=this.C3e.value?encodeURI(b):b;c.mruItemId=this.awc;c.app=this.O8f();if(b=this.HE())c.folderName=b.breadcrumbFolderName,b=b.Ix,c.documentName=Ka.a.yG(b),c.documentExt=this.WV(b);a&&(c.documentName?c.documentName.length?255<=c.documentName.length?a.set("DocumentNameLength","Long"):2084<=c.documentName.length&&a.set("DocumentNameLength","VeryLong"):a.set("DocumentNameLength","0"):a.set("DocumentNameLength","Null"));return JSON.stringify(c)}XWe(a,b=!1){if(4===
this.pO.Bva&&!u.AFrameworkApplication.JIc)return 2;var c=eq.a.Fz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"),c.set("MruIdSent",this.awc?"true":"false"),c.set("URLEncoded",this.C3e.value?"true":"false"));vf.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",c);a=this.qjj(c);if(!a)return b=!u.AFrameworkApplication.hjb,c&&(c.set("WebEditingIsEnabled",u.AFrameworkApplication.hjb?"true":"false"),c.set("ProtectedFile",u.AFrameworkApplication.rO?"true":"false")),vf.Health.instance.recordKpiFailure("WriteMru",
"MissingDocumentUrl",b,!1,Object.assign(new mk.a,{extendedProperties:c})),2;this.xNa&&!b&&this.xNa.reset();c=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.pO.Xla,this.SCg);this.UBf?this.bpd["X-FileId"]=u.AFrameworkApplication.hh:c+=String.format("&{0}",u.AFrameworkApplication.hh);u.AFrameworkApplication.$c&&(this.bpd["X-Office-AudienceGroup"]=Object(ua.a)(String,u.AFrameworkApplication.$c.AudienceGroup)||"");this.bpd["X-Timeout"]=15E3;return this.pO.$dc.yj(c,2,a,this.bpd,!0,5,Object(C.a)(this,
this.IDl,"writeMruV2EntryOnServerSuccessCallback"),Object(C.a)(this,this.fEi,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")}IDl(a){this.Xjg(a.data)}Xjg(a){const b=eq.a.Fz();this.xNa&&(b&&this.xNa.Ybd&&(b.set("LastError",this.xNa.Ybd),b.set("NumRetries",this.xNa.retryCount.toString())),this.xNa.reset());const c=Cu.c(a.Sd);c&&c.diagnostics_data&&(this.awc=c.diagnostics_data.mru_id);a=+a.Wu-+a.Kt;b&&b.set("RequestDuration",a.toString());vf.Health.instance.recordKpiSuccess("WriteMru",
Object.assign(new mk.a,{extendedProperties:b}))}fEi(a){if(a.data.Le===dq.a.WXb)this.Xjg(a.data);else{var b=a.data.Le===dq.a.ihc,c=eq.a.Fz();this.tkg(this.xNa,a,this.UDi(),c);c&&(c.set("StatusCode",a.data.Le.toString()),b||this.BHd(a.data,c));vf.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",a.data.Le),b,!1,Object.assign(new mk.a,{extendedProperties:c}))}}UDi(){return()=>{this.XWe("Retry",!0)}}c$i(){this.C6c("Polling")}b$i(){this.C6c("Retry",!0)}zck(){this.C6c("Open")}yck(){this.C6c("Activity")}C6c(a,
b=!1){Z.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{["Trigger"]:a});const c=eq.a.Fz();c&&(c.set("Trigger",a),c.set("IsRetry",b?"true":"false"));vf.Health.instance.recordKpiUsage("GetMru",0,"smartfio",c);this.RMa&&!b&&this.RMa.reset();this.Mzi(Object(C.a)(this,this.e$i,"getMruV2FromServerSuccessCallback"),Object(C.a)(this,this.a$i,"getMruFromServerFailureCallback"))}BHd(a,b){a&&a.qj&&(a=a.qj["X-CorrelationId"])&&b.set("ServerCorrelationId",a)}CYj(a,b){a&&(b&&b.set("RequestDuration",
(+a.Wu-+a.Kt).toString()),vf.Health.instance.recordKpiSuccess("GetMru",Object.assign(new mk.a,{extendedProperties:b})))}e$i(a){this.f$i(a)}f$i(a){var b="";let c=null,f=null,l=null;const x=Cu.c(a.data.Sd);x&&(c=x.places?x.places.items:[],f=x.documents?x.documents.items:[],(l=Cu.a(x,!1))&&(b=Yd.c(l)));u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.hEa&&Lg.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(b,!0));b=eq.a.Fz();this.RMa&&(b&&this.RMa.Ybd&&(b.set("LastError",this.RMa.Ybd),
b.set("NumRetries",this.RMa.retryCount.toString())),this.RMa.reset());l||c||f?(this.pO.g$a("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Success"),this.Tnd(3,l,c,f),this.CYj(a.data,b)):(this.pO.g$a("MruActor.GetMruV2FromServerSuccessCallback",a.data,"Failure: Invalid JSON"),b&&this.BHd(a.data,b),vf.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new mk.a,{extendedProperties:b})),this.Tnd(3,null,null,null,!0));this.$Ud(this.t6)}tkg(a,b,c,f){let l=0,x=0;const G=
Cu.c(b.data.Sd);G&&(null!=G.response_code&&(l=G.response_code,f&&f.set("MruResponseCode",l.toString()),9===l&&(this.awc="")),G.error_data&&null!=G.error_data.retry_after_ms&&(x=G.error_data.retry_after_ms,f&&f.set("ExpectedRetryAfter",x.toString())));a&&(b=a.fBj(c,x,b.data.Le,l),f&&(f.set("CurrentRetryCount",a.retryCount.toString()),f.set("RetryScheduled",b?"true":"false")))}a$i(a){this.d$i(a)}d$i(a){const b=a.data.Le===dq.a.ihc,c=eq.a.Fz();c&&(c.set("StatusCode",a.data.Le.toString()),b||this.BHd(a.data,
c));this.pO.g$a("MruActor.GetMruFromServerFailureCallback",a.data,"Failure");this.Tnd(2);this.tkg(this.RMa,a,Object(C.a)(this,this.b$i,"getMruFromServerRetryTask"),c);vf.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",a.data.Le),b,!1,Object.assign(new mk.a,{extendedProperties:c}));this.$Ud(this.t6);u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.hEa&&Lg.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",
!1)))}Tnd(a,b=null,c=null,f=null,l=!1){if(3!==this.t6.state||3===a)this.t6.Mgf=b,this.t6.Ngf=c,this.t6.QSh=f,this.t6.state=a,this.t6.dwd=l,this.t6.Gzf=this.pO.gF()}P1g(a,b){Z.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{["Trigger"]:a,["ResultState"]:this.t6.state});b&&3===this.t6.state&&this.y0f(b,this.t6);return this.t6}Mzi(a,b){this.Tnd(1);let c;const f={};c=String.format(this.pO.Xla+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.O8f(),this.SCg);this.wVh.value||
(c+="&entity=docs");u.AFrameworkApplication.$c&&(f["X-Office-AudienceGroup"]=Object(ua.a)(String,u.AFrameworkApplication.$c.AudienceGroup)||"");this.UBf?f["X-FileId"]=u.AFrameworkApplication.hh:c+=String.format("&{0}",u.AFrameworkApplication.hh);this.pO.$dc.yj(c,1,null,f,!0,5,a,b,null)}get pO(){return this.Fga.value}get SCg(){return this.WRh.value}static get instance(){return qn.Ja||(qn.Ja=qn.mr())}static mr(){return new qn(new Sa.a(()=>pp.instance),new Sa.a(()=>sa.a.oe(u.AFrameworkApplication.lcid).name),
new Sa.a(()=>u.AFrameworkApplication.Aa.jb.gC),u.AFrameworkApplication.fa.ka("MruWriteFileIdInHeader"),()=>u.AFrameworkApplication.Aa.jb.pba,()=>u.AFrameworkApplication.pu,new Sa.a(()=>u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled")))}}qn.Ja=null;Object(e.a)(qn,"MruActor",as,[]);class et{constructor(){this.dTb=this.jtf=this.Da=null;this.$n=!1}get name(){return"Common.App.NewAndOpen.Core"}Wb(a){this.Da=a;a.register(1255,"Common.INewAndOpenCommonHelpers").ma().na(()=>pp.instance);a.register(1256,
"Common.IEventEmitter<Common.IGetMoreInfoResult>").ma().na(()=>Sm.instance);a.register(1256,"Common.IEventEmitter<Common.IMruResult>").ma().na(()=>qn.instance)}init(){u.AFrameworkApplication.fa.ff(()=>{this.rDa()})}rDa(){this.Da.resolve("Common.INewAndOpenCommonHelpers");this.Da.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.Da.resolve("Common.IEventEmitter<Common.IMruResult>");var a=!1;pp.instance.JMk();u.AFrameworkApplication.Cva&&(a=!0);u.AFrameworkApplication.DEe&&(qn.instance.zck(),
0<u.AFrameworkApplication.jWg&&this.sDf(),this.x9k(),a=!0);u.AFrameworkApplication.EJa&&a&&Sm.instance.xck();u.AFrameworkApplication.uxl&&(a=qn.instance,a.OOk(),a.Fck(),El.a.instance.Cb(this.vxl))}x9k(){Kp.instance.JCf(Object(C.a)(qn.instance,qn.instance.yck,"makeGetMruRequestActivityTrigger"));Kp.instance.JCf(Object(C.a)(this,this.sDf,"addGetMruFromServerTask"));Kp.instance.J2h(Object(C.a)(this,this.HGi,"deleteGetMruFromServerTask"))}HGi(){El.a.instance.Ng(this.kWg)}sDf(){El.a.instance.Cb(this.kWg)}get kWg(){return this.jtf||
(this.jtf=new xe.a(5,2,u.AFrameworkApplication.jWg,Object(C.a)(qn.instance,qn.instance.c$i,"getMruFromServerTask"),109))}get vxl(){return this.dTb||(this.dTb=new xe.a(2,2,6E4*u.AFrameworkApplication.fa.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(C.a)(qn.instance,qn.instance.Gck,"makeUpdateMruTask"),197))}dispose(){this.$n||(this.$n=!0,this.dTb&&(El.a.instance.Ng(this.dTb),this.dTb=null))}}Object(e.a)(et,"CorePackageManager",null,[2,3,106]);var zi=d(122);
class Eu{constructor(a,b,c,f,l,x,G,R,fa,wa){this.oNg=new Ha.a;this.VQg=null;this.Zb=f;this.ua=l;this.Fa=c;this.Ata=G;this.eka=R;this.pC=x;this.ra=b;this.la=fa;this.Eq=a;this.od=wa;this.la.UOj&&(this.ra&&this.ra.VH(Object(C.a)(this,this.kH,"onSelectionChanged")),R&&R.QNk(this),this.Eq.tBc(Object(C.a)(this,this.YT,"onFocusChanged")),this.od.JFf(Object(C.a)(this,this.ffc,"onShapeViewElementUnlocked")),this.od.q8h(Object(C.a)(this,this.m3g,"onThumbnailsSetFakeImage")),this.od.r8h(Object(C.a)(this,this.n3g,
"onThumbnailsSetFocus")),this.od.s8h(Object(C.a)(this,this.o3g,"onThumbnailsSetSelected")),this.la.eUc&&this.Eq.a7h(Object(C.a)(this,this.J2g,"onSlideshowNavigationToolbarClickedHandler")),this.la.tg&&this.Eq.$6h(Object(C.a)(this,this.H2g,"onSlideshowContextMenuFocusedHandler")))}dispose(){this.Eq.Jed(Object(C.a)(this,this.YT,"onFocusChanged"));this.Eq.cRk(Object(C.a)(this,this.nlk,"onDesignerClickSuggestion"));this.od.Qfh(Object(C.a)(this,this.ffc,"onShapeViewElementUnlocked"));this.od.dTk(Object(C.a)(this,
this.m3g,"onThumbnailsSetFakeImage"));this.od.eTk(Object(C.a)(this,this.n3g,"onThumbnailsSetFocus"));this.od.fTk(Object(C.a)(this,this.o3g,"onThumbnailsSetSelected"));this.la.eUc&&this.Eq.qSk(Object(C.a)(this,this.J2g,"onSlideshowNavigationToolbarClickedHandler"));this.la.tg&&this.Eq.pSk(Object(C.a)(this,this.H2g,"onSlideshowContextMenuFocusedHandler"))}kH(a,b){if(b&&b.Xk&&this.ra.$Z(b.Xk))try{this.frj(b.Xk)}catch(c){a=String.format("AriaManager failed to handle the select changed event. Message: {0}. Stack: {1}",
c.message,c.stack),Aa.a.J(17367906,822,10,a)}}frj(a){var b=this.ra.og();if(1===a.length||1===b.length&&b[0].Og){if(a=this.ra.rq()){b=new Ha.a;let c=this.Heg(a,b,Object(C.a)(this,this.Jej,"getShapeName"));c||b.count||(c=this.eka.Cfg(a,b));!c&&a.get_smartArtModelId()?c=ResourceStrings.l_AccMessageSmartArtSubIcon:Ka.a.Va(c)||(c+=ResourceStrings.L_ShapeSelected);const f=this.eka.Rej(a);({TIf:c,hXe:b}=this.hHf(f,c,b));!a.gs&&a.isUnread&&({TIf:c,hXe:b}=this.hHf(this.eka.Sej(a,this.VQg),c,b));0<b.count?
this.ich(b):this.Kea(c||"")}}else 1<a.length&&(a=this.eka.h$i(this.ra.Yd()),this.Kea(a||""))}hHf(a,b,c){a&&(c.count?c.add(document.createTextNode(a)):b=String.format(ResourceStrings.l_ShapeAndPresenceInfo,b,a));return{TIf:b,hXe:c}}YT(a,b){b=b.UCb;if(b===zi.a.oD||b===Yb.a.Bg){a=this.ua.Ba;let c=null;b===zi.a.oD?c=(a=this.Zb.Pnc.Rca)?String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.m7a()+this.eka.Y3d(a)):String.format(ResourceStrings.l_ThumbnailPanelWithSlideInfo,this.m7a()):b!==Yb.a.Bg||
!this.ra.wu()&&this.ra.e3()||(this.pC&&this.pC.value&&(b=this.pC.value.Nd)&&a&&b.$o&&Ni.e(a,b.Ma),c=this.eka.rfj());this.Kea(c||"")}}setAttribute(a,b,c){a&&Jc.a.BO(a,b,c)}W4(a){this.oNg.add(a)}Heg(a,b,c=null){try{if(a&&this.Fa)for(let f of this.oNg)if(f){const l=f(a,this.Fa.ze?this.Fa.ze.name:null,b,c);if(l||b&&0<b.count)return l}}catch(f){a=String.format("AriaManager failed to get provider message. Message: {0}. Stack: {1}",f.message,f.stack),Aa.a.J(17662480,822,10,a)}return null}ich(a){if(this.Ata&&
this.Ata.value){const b=this.Ata.value.S8i();if(b&&a&&0<a.count){b.firstChild&&b.removeChild(b.firstChild);const c=document.createElement("p");for(let f of a)c.appendChild(f);b.appendChild(c)}}}lch(a,b){if(a){const c=new Ha.a;let f=this.Heg(a,c);f||c.count||(f=this.eka.Cfg(a,c));0<c.count?(b&&c.add(document.createTextNode(b)),this.ich(c)):(b&&(f+=" "+b),this.Kea(f||""))}}Kea(a){this.Ata&&this.Ata.value&&this.Ata.value.sendNotification(a,!0)}ffc(a,b){b.presenceUser&&b.bPj&&this.Kea(String.format(ResourceStrings.L_EditorLeavingHint,
b.presenceUser.userName))}nlk(a,b){this.Kea(this.eka.R3i(b.t0k,b.vkl))}m3g(a,b){this.setAttribute(b.F5.image,Jc.a.Ye,Jc.a.UNa)}n3g(a,b){b.hasFocus&&b.F5.isSelected&&this.Kea(this.m7a()+this.eka.Y3d(b.F5));this.setAttribute(b.F5.qib,Jc.a.L3a,b.hasFocus&&b.F5.isSelected?"true":"false")}o3g(a,b){b.F5.isSelected&&b.hasFocus?this.Kea(this.m7a()+this.eka.Y3d(b.F5)):b.F5.isSelected||this.Kea(this.m7a());this.setAttribute(b.F5.qib,Jc.a.L3a,b.F5.isSelected?"true":"false")}J2g(a,b){this.Kea(b.text)}Jej(a){this.VQg=
a||ResourceStrings.l_Object}H2g(a,b){this.Kea(b.text)}m7a(){let a="";const b=this.ra.nf();b&&1<b.length&&(b.sort((c,f)=>c.we-f.we),this.Nob(b)&&(a=this.eka.m7a(b[0].we+1,b[b.length-1].we+1)));return a}Nob(a){if(!a||1>=a.length)return!1;const b=a.length;return a[b-1].we-a[0].we+1===b?!0:!1}}Object(e.a)(Eu,"AriaManager",null,[1182,106]);var by=d(902);class Fu{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Aria"}Wb(a){this.K=a;this.K.register(956,"PowerPointWebEditor.IAriaMessageHelper").ma().na(()=>
new by.a(this.K.Ka("PowerpointPresence.IPresenceUserManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.Ka("PowerPointWebEditor.Graph.ICommentReader"),this.K.Ka("PowerPointWebEditor.IAppForOfficeManager"),this.K.le("PowerPointWebEditor.IAppforOfficeClassFactory"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(1182,
"PowerPointWebEditor.IAriaManager").ma().na(()=>new Eu(this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.le("Box4.IInteractiveViewManager"),this.K.le("Common.Utils.IAriaNotifier"),this.K.resolve("PowerPointWebEditor.IAriaMessageHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IAriaManager").dispose()}static main(){m.a.instance.Bc(new Fu)}}Object(e.a)(Fu,"PptAriaPackage",null,[2,3]);var fq=d(1007);class ft{constructor(){this.Priority=0;this.Context=null;this.Length=this.StartInContext=this.Start=0;this.Metadata=ft.nMi;this.Suggestions=this.TypeId=this.TraceId=null;this.CritiqueActions=this.SupportedActions=0;this.RevisionId=this.TileId=this.Explanation=
this.ExplanationLabel=this.ExplanationTitle=this.CategoryTitle=null;this.Tag=this.Status=this.BucketId=0}}ft.nMi=[];Object(e.a)(ft,"Critique",null,[]);class gw{constructor(){this.Text=null;this.Level=0;this.Source=null;this.BucketId=this.Action=0;this.Description=null;this.NumberOfInstances=0}}Object(e.a)(gw,"Suggestion",null,[]);class Gu{SSf(a){if(!a)return null;const b=[];for(const c of a)a=Object.assign(new ft,{TraceId:c.traceId,CategoryTitle:c.categoryTitle,ExplanationTitle:c.explanationTitle||
"",ExplanationLabel:c.explanationLabel||"",Explanation:c.explanation||"",TileId:c.tileId,RevisionId:c.revisionId,BucketId:c.bucketId,Status:c.status,Tag:c.tags?this.Gwi(c.tags):0,Start:c.start,Length:c.length,Priority:c.priority,TypeId:c.critiqueTypeId}),c.supportedActions&&(a.SupportedActions=this.mwi(c.supportedActions)),c.suggestions&&(a.Suggestions=this.Fwi(c.suggestions)),b.push(a);return b}Fwi(a){if(!a)return null;const b=[];for(const c of a)(a=this.Dwi(c))&&b.push(a);return b}Dwi(a){if(!a)return null;
const b=Object.assign(new gw,{BucketId:a.bucketId,Description:a.description,NumberOfInstances:a.numberOfInstances,Source:a.source,Text:a.text,Level:this.lwi(a.confidenceLevel)});a.actions&&(b.Action=this.Ewi(a.actions));return b}lwi(a){return 1===a?0:2===a?1:2}Ewi(a){let b=0;a.autoCorrect&&(b|=4);a.changeOnce&&(b|=1);a.changeAll&&(b|=2);a.readAloud&&(b|=8);return b}Gwi(a){return a.consistency?1:0}mwi(a){let b=0;a.addToDictionary&&(b|=16);a.deleteText&&(b|=1);a.ignore&&(b|=2);a.ignoreAll&&(b|=4);a.ignoreCritiqueType&&
(b|=8);a.showDetails&&(b|=32);return b}}Object(e.a)(Gu,"CloudALResponseTransformer",null,[1329]);var lg=d(81),tA=d(518);class cy{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){this.Aua=a;this.ubb=b;this.XQg=c;this.ua=f;this.Fb=l;this.ia=x;this.lc=R;this.Nl=fa;this.Hh=wa;this.Mc=G;this.Wz=Wa;this.Aua.wAa(Object(C.a)(this,this.wHa,"onBeforeParagraphDisconnect"));this.Aua.Yj(Object(C.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Mc.D5h(Object(C.a)(this,this.v0g,"onLanguageOnRangeChanged"));
this.ubb.wAa(Object(C.a)(this,this.gZg,"onBeforeNumberListDisconnect"));this.ubb.Yj(Object(C.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.XQg.nG(Object(C.a)(this,this.onShapeChildTopologyChanged,"onShapeChildTopologyChanged"))}isEnabled(a){const b=this.ua.Ba;if(!b||!b.isConnected)return!1;const c=Object.assign(new tA.a,{slideId:b.Bb});this.ia.La(ba.a.uXa,2,c);return 0<c.vmc?(Aa.a.J(37025884,375,50,"{0}, current slide {1} is locked due to one more people are here. Skipping",
a,b.id),!1):!0}initialize(){this.h9d(this.ua.Ba)}dispose(){this.Aua.uIa(Object(C.a)(this,this.wHa,"onBeforeParagraphDisconnect"));this.Aua.tm(Object(C.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.Mc.rRk(Object(C.a)(this,this.v0g,"onLanguageOnRangeChanged"));this.ubb.uIa(Object(C.a)(this,this.gZg,"onBeforeNumberListDisconnect"));this.ubb.tm(Object(C.a)(this,this.onNumberListPropertyChanged,"onNumberListPropertyChanged"));this.XQg.yO(Object(C.a)(this,this.onShapeChildTopologyChanged,
"onShapeChildTopologyChanged"))}wHa(a,b){this.zoc(Object(ua.a)(se.AParagraphNode,b.node),!1)}onParagraphPropertyChanged(a,b){b.property!==tb.a.iq&&b.property!==Mb.a.listLevel||this.zoc(Object(ua.a)(se.AParagraphNode,b.node),!1)}v0g(a,b){this.zoc(b.paragraphNode,!0)}gZg(a,b){b.node&&Object(Ma.a)(lg.a,b.node)&&this.zoc(this.Wz.f1d(Object(ua.a)(lg.a,b.node)),!0)}onNumberListPropertyChanged(a,b){b.node&&Object(Ma.a)(lg.a,b.node)&&b.node.isConnected&&b.property===tb.a.Ni&&this.zoc(this.Wz.f1d(Object(ua.a)(lg.a,
b.node)),!0)}onShapeChildTopologyChanged(a,b){if(a=Object(ua.a)(4,b.node))a=this.lc.ig(a),this.h9d(a)}zoc(a,b){!this.Fal(a)||b&&this.Vsj(a)||(a=Object(ua.a)(120,this.lc.ig(a)),this.h9d(a))}h9d(a){if(a&&a.isConnected&&a.isSlideCritiqueReady){var b=this.Fb.ke(7,E.a.EVe);b.kc(a);a.isSlideCritiqueReady=!1;b.dispose()}}Fal(a){return!!a&&a.isConnected&&this.Hh.Vd(a)&&!this.Nl.xja(a)&&!a.sa(sb.a.VS,!1)}Vsj(a){a=a.sa(tb.a.iq,"");return!a||!a.length}}Object(e.a)(cy,"ConsistencyCheckManager",null,[1175,106]);
var Sl=d(165),Lp=d(517);class gq{constructor(){this.d=this.p=this.w=null}}Object(e.a)(gq,"ProofingDashboardTraceMetrics",null,[]);class xk{}xk.ude="bs";xk.IWc="bd";xk.dGh="was";xk.eGh="wad";xk.sOj="rm";xk.BDl="wd";xk.oCl="ad";xk.MWk="rs";Object(e.a)(xk,"TelemetryFieldNames",null,[]);class rm{}rm.iol="tcw";rm.Uld="tcc";rm.rBg="bs";rm.LTj="bd";rm.qBg="bpc";rm.ZTg="md";Object(e.a)(rm,"TelemetryValues",null,[]);class rr{constructor(){this.wn=this.i=null}}Object(e.a)(rr,"Workflow",null,[]);class Hu{constructor(a,
b,c,f,l,x,G,R,fa,wa,Wa,mb){this.ua=a;this.mC=b;this.sqe=c;this.Fb=f;this.B2j=l;this.sPg=x;this.o9=G;this.Ea=R;this.Nl=fa;this.Ha=wa;this.Sge=Wa;this.q9=mb}initialize(){this.o9.execute(a=>{a.addEventHandler(Lp.a.vJf,Object(C.a)(this,this.hmj,"handleAugResults"));this.Ha.pptAugmentationLoopCloudALEnabled&&a.addEventHandler(Lp.a.WOd,Object(C.a)(this,this.Jmj,"handleCloudALResults"))})}hmj(a,b,c,f){Aa.a.J(36962498,375,50,"Handle WAC AL results");if(b&&f&&b&&f){a=String.format("{0}, MarkStart:{1}",f.Telemetry,
(new Date).getTime().toString());var l=this.U8f(b.Content);c=this.B4i(f.Payload);if(l&&c){var x=!1;if(this.Ha.pptRegisterSingleProofingWorkflowEnabled||!this.Ha.pptAugmentationLoopCloudALEnabled||this.Ha.pptAugmentationLoopShadowCloudALEnabled)this.$Tg(c.Critiques,l),x=!0;l=(new Date).getTime();if(f=this.q9.oTd(f.DashboardTelemetry))try{const G={};G[xk.MWk]=c.ResponseStatus;G[xk.sOj]=x;G[xk.BDl]=l-f.d[xk.ude];G[xk.oCl]=f.d[xk.eGh]-f.d[xk.dGh];f.d=G;f.p=rm.ZTg;this.q9.track(f)}catch(G){Aa.a.J(37487777,
375,15,"trace metrics exception {0}",G.message)}a=String.format("{0}, MarkDone:{1}",a,l.toString());Aa.a.J(36702229,375,50,"Marked: {0}, TileID: {1}, critique count: {2}, {3}",x,b.Id,c.Critiques?c.Critiques.length:0,a)}else Aa.a.J(36577357,375,10,c?"Aug slide is null":"Result is null")}}Jmj(a,b,c,f){Aa.a.J(36962502,375,50,"Handle Cloud AL results");c=(new Date).getTime();if(b&&f&&b&&f){f.partialSuccess&&Aa.a.J(37057568,375,15,"Get partial success response");a=String.format("MarkStart:{0}",c.toString());
var l=this.U8f(b.Content);if(l){var x=!1;if(this.Ha.pptRegisterSingleProofingWorkflowEnabled||!this.Ha.pptAugmentationLoopShadowCloudALEnabled)x=this.Sge.SSf(f.critiques),this.$Tg(x,l),x=!0;l=(new Date).getTime();c=Object.assign(new gq,{w:Object.assign(new rr,{wn:rm.Uld,i:b.Id}),p:rm.ZTg,d:{["ms"]:c,["md"]:l,["rm"]:x,["rs"]:f.partialSuccess?1:0}});this.q9.track(c);a=String.format("{0}, MarkDone:{1}",a,l.toString());Aa.a.J(36783304,375,50,"Marked: {0}, Cloud AL tileID: {1}, critique count: {2}, {3}",
x,b.Id,f.critiques?f.critiques.length:0,a)}else Aa.a.J(36783302,375,10,"Aug slide is null")}}U8f(a){let b=null;try{b=Yd.a(a)}catch(c){return Aa.a.J(36577355,375,10,"Try parse aug slide failed"),null}return b}B4i(a){let b=null;try{b=Yd.a(a)}catch(c){return Aa.a.J(36525519,375,10,"ApplyEditorServiceResults - Try parse aug response failed {0}",c.message),null}if(!b)return Aa.a.J(38545173,375,15,"ApplyEditorServiceResults - Parsed response is null"),null;if(1!==b.ResponseStatus&&0!==b.ResponseStatus)return Aa.a.J(36525521,
375,15,"ApplyEditorServiceResults - Failed editor service call {0}",b.ResponseStatus),null;1===b.ResponseStatus&&Aa.a.J(37057603,375,15,"Get partial success response");return b}$Tg(a,b){try{const G=this.ua.Ba;if(!this.$bl(b,G)){var c=this.Udg(a,!1);if(c){var f=this.ua.Ba.Mha,l=new Ha.a,x=this.Fb.ke(7,E.a.EVe);x.kc(G);for(const R of b.drawingElems)if(R.text&&R.text.paragraphs)for(const fa of R.text.paragraphs){const wa=fa.id;l.add(wa);const Wa=Object(ua.a)(se.AParagraphNode,f.te(Ga.a.Mf(wa)));if(Wa&&
!Wa.sa(Sl.a.Lca,!1)){if(this.Ha.pptEditorGrammarAndWritingStyleIsEnabled)if(wa in c){const mb=Array.isArray(c[wa])?c[wa]:null;if(!mb||!mb.length||mb[0].RevisionId!==Wa.sa(Sl.a.WWc,0).toString())continue;this.jdk(Wa,mb,this.xdj(fa.cfRuns))}else this.nQk(Wa);Wa.setValue(Sl.a.Lca,!0)}}if(this.Ha.pptEditorConsistencyCheckIsEnabled){const R=String.format("Start:{0}",(new Date).getTime().toString());b=0;const fa=G.isSlideCritiqueReady;c=!1;if(!fa){const wa=new Ha.a,Wa=this.Udg(a,!0);(c=this.hTi(Wa,l,G,
wa))&&(b=this.Vai(Wa,l,G,wa))}Aa.a.J(37298713,375,50,"{0}, End:{1}, IsReady:{2}, ShouldApply:{3}, Count:{4}",R,(new Date).getTime().toString(),fa,c,b)}G.setValue(Sl.a.nvg,!0);x.dispose()}}}catch(G){Aa.a.J(36525523,375,10,"MarkEditorServiceResults failed {0}",G.message)}}xdj(a){const b=new va.ScriptSharpLegacyMap;if(!a)return b;let c=0;for(const f of a)f.cf&&b.add(c,f.cf.lang),c+=f.len;return b}jdk(a,b,c){var f=this.mC.iF(a,x=>!!x.Gh);const l=[];for(const x of f)1===x.Gh.proofingType&&Array.add(l,
x);b=this.gTi(a,b,l);f=this.fTi(b,f);this.mC.tIa(a,f);this.YTg(b,a,c);a.setValue(Sl.a.Lca,!0)}nQk(a){const b=this.mC.iF(a,c=>!!c.Gh&&1!==c.Gh.proofingType);this.mC.tIa(a,b);a.setValue(Sl.a.Lca,!0)}Vai(a,b,c,f){const l=c.Mha,x=new ef.a;let G=0;this.YVk(c);for(let fa in a){var R=a[fa];const wa=Object(ua.a)(se.AParagraphNode,l.te(Ga.a.Mf(fa)));R=Array.isArray(R)?R:null;if(!(wa&&wa.isConnected&&R&&R.length))continue;const Wa=[];for(const mb of R)this.jug(mb)&&!f.contains(mb.BucketId)&&Wa.push(mb);0<Wa.length&&
(this.YTg(Wa,wa),x.Jb(wa.id.toString())||x.$(wa.id.toString(),wa),G+=Wa.length)}if(0<x.count)for(let fa of b)x.Jb(fa)&&(a=x.ga(fa))&&c.tJa.add(a);c.isSlideCritiqueReady=!0;return G}hTi(a,b,c,f){var l=this.Baj(c);if(b.count!==l.count)return this.FXc(String.format("Topology changed from {0} to {1}",b.count,l.count)),!1;c=c.Mha;for(var x of b){if(!l.contains(x))return this.FXc("ParaId changed"),!1;b=Object(ua.a)(se.AParagraphNode,c.te(Ga.a.Mf(x)));if(!b||!b.isConnected)return this.FXc("Invalid ParaId"),
!1;if(!b.sa(Sl.a.Lca,!1))return this.FXc("Para pending proofing"),!1}for(let G in a){x=a[G];l=Object(ua.a)(se.AParagraphNode,c.te(Ga.a.Mf(G)));x=Array.isArray(x)?x:null;if(!x||!x.length)continue;b=this.mC.iF(l,fa=>!!fa.Gh&&(1===fa.Gh.proofingType||2===fa.Gh.proofingType||3===fa.Gh.proofingType));const R=this.mC.iF(l,fa=>{fa=Object(ua.a)(658,fa.Gh);return!!fa&&5===fa.proofingType&&fa.mDa});l=this.sqe.dNc(l,!1,!0);for(const fa of x)if(this.jug(fa)){if(this.tTc(fa,b)||this.LGj(fa,x))f.add(fa.BucketId),
Aa.a.J(37298716,375,50,"Overlap critique: {0}",fa.BucketId);(this.tTc(fa,l)||this.tTc(fa,R))&&f.add(fa.BucketId)}}return!0}FXc(a){Aa.a.J(37298718,375,50,"Skip apply: {0}",a)}gTi(a,b,c){const f=[];for(const l of b){if(this.Osj(b,l)||a.characterData.length<l.Start+l.Length||this.tTc(l,c))continue;const x=Zc.b(l);2!==x&&3!==x||f.push(l)}return f}fTi(a,b){const c=[];for(const f of b)this.Gal(a,f)||Array.add(c,f);return c}Gal(a,b){const c=b.Gh.proofingType;if(1===c)return!0;if(2===c||3===c)return!1;if(5===
c){for(const f of a)if(this.kVc(f.Start,f.Start+f.Length,b.begin,b.end))return!1;return!0}return!1}tTc(a,b){const c=a.Start;a=a.Start+a.Length;for(const f of b)if(this.kVc(c,a,f.begin,f.end))return!0;return!1}Udg(a,b){const c={};if(a)for(const f of a)if(0!==f.Priority||b)f.TileId in c?Array.add(c[f.TileId],f):c[f.TileId]=[f];return c}QQa(a,b){let c=0;for(let f of a)if(b>=f.key)c=f.value;else break;return c}YTg(a,b,c=null){if(a&&a.length&&b){var f={},l=[];for(const G of a){var x=G.Start;const R=x+
G.Length,fa=b.characterData.substring(x,R);a=this.B2j.create(G,this.sPg);a.token=fa;c&&(a.lcid=this.QQa(c,x));x=new so(x,R,a);Array.add(l,x);a=1===a.proofingType?Wc[a.proofingType]:a.typeId;f[a]=a in f?f[a]+1:1}this.mC.cDf(b,l);this.sPg.track(()=>Object.assign(new Qb.a,{E:2,C:this.Exi(b.characterData),F:f}))}}Osj(a,b){const c=b.Start,f=b.Start+b.Length;for(const l of a)if(this.kVc(c,f,l.Start,l.Start+l.Length)&&Zc.a(l)>Zc.a(b))return!0;return!1}LGj(a,b){const c=a.Start,f=a.Start+a.Length;for(const l of b)if(l!==
a&&this.kVc(c,f,l.Start,l.Start+l.Length))return!0;return!1}kVc(a,b,c,f){return a>=c&&a<f||c>=a&&c<b}Exi(a){return Wr.a.instance.Xhg(a,0,a.length-1)}$bl(a,b){return!a||!b||!b.isConnected||a.id!==b.id.toString()}jug(a){return!!a&&5===Zc.b(a)}Baj(a){const b=new Ha.a;a=a?a.jl():[];for(const c of a)this.Nl.$Da(c)||this.Ea.kJ(c,f=>{b.add(f.id.toString())});return b}YVk(a){for(let b of a.tJa){const c=b;if(c){const f=this.mC.iF(c,l=>{l=Object(ua.a)(658,l.Gh);return!!l&&5===l.proofingType&&!l.mDa});this.mC.tIa(c,
f)}}a.tJa.clear()}}Object(e.a)(Hu,"EditorServiceResultsManager",null,[]);class gt extends Po.a{constructor(a,b,c,f,l,x=null){super(a,b,c,f,x);this.EF=l}get proofingType(){const a=super.proofingType;return this.EF.hSa||2!==a?a:1}}Object(e.a)(gt,"PPTEditorServiceErrorDetails",Po.a,[]);class hw{constructor(a,b,c){this.O5j=a;this.f9j=b;this.EF=c}create(a,b,c=null){return new gt(a,b,this.O5j,this.f9j,this.EF,c)}}Object(e.a)(hw,"PPTEditorServiceErrorDetailsFactory",null,[1172]);class sr{constructor(a){this.Ha=
a}filter(a){if(a&&(!this.Ha.pptEditorConsistencyCheckIsEnabled||!this.Ha.pptEditorGrammarAndWritingStyleIsEnabled))for(let c=a.length-1;0<=c;--c){const f=a[c].CritiqueTypeInfoList;for(let l=f.length-1;0<=l;--l){var b=f[l];b=Zc.c(b.CritiquePriority,b.CritiqueTag);this.Ha.pptEditorConsistencyCheckIsEnabled||5!==b||Array.removeAt(f,l);this.Ha.pptEditorGrammarAndWritingStyleIsEnabled||2!==b&&3!==b||Array.removeAt(f,l)}f.length||Array.removeAt(a,c)}}}Object(e.a)(sr,"PPTProofingCritiqueCategoryInfoFilter",
null,[1173]);class Iu extends Aj.a{constructor(a,b){super(null);this.MBd=a;this.errorType=2;this.PCg=b}get proofingType(){return this.MBd}get suggestions(){return[]}dKa(){}}Object(e.a)(Iu,"UnknownErrorDetails",Aj.a,[]);class ht{constructor(a,b,c,f,l){this.zZe=this.wZe=null;this.jGd=this.vzd=0;this.ssd=!1;this.Gi=a;this.hRb=b;this.yz=c;this.wm=f;this.CM=l;this.asc=0}Ich(a,b,c){return{V9g:a,sYg:b,rYg:c}}aBh(){}ree(a,b,c,f,l,x,G,R){!x&&(c=!!c&&c[a],f=!!f&&f[a],b&&b[a]||c||f)&&(b=this.Gi.Ra.last.cp,x=
this.Gi.characterData.length,Array.add(G,new Wk.a(b,x)),(c||f)&&Array.add(R,new so(b,x,new Iu(this.CM.hde?l?l[a]:0:f?2:1,c?1:2))))}Exl(a,b){this.yz.PGe(this.Gi,a);b&&this.wm.bUk(this.Gi,b);this.U9g()}U9g(){this.hRb.fR(this.Gi)}GZk(a,b,c,f){this.gkh(this.asc,b,c,f);this.KIe(a,this.ssd)}gkh(a,b,c,f){b.add(1===a);c.add(2===a||3===a);f.add(this.CM.hde?a:0)}KIe(a,b){a.add(b)}uWj(a){let b,c,f,l;b=this.Gi.sa(tb.a.Eva,null);c=this.Gi.sa(tb.a.zJa,null);f=this.Gi.sa(Mb.a.L7a,null);l=this.Gi.sa(Mb.a.kXa,null);
this.Gi.Mvb=this.Gi.sa(Kg.a.fec,!1);({Eva:b,zJa:c,L7a:f,kXa:l}=this.IFh(b,c,f,l,a,"loading"));return{Eva:b,zJa:c,L7a:f,kXa:l}}MIe(a,b,c,f,l){({Eva:a,zJa:b,L7a:c,kXa:f}=this.IFh(a,b,c,f,l,"saving"));this.jLe(tb.a.Eva,a);this.jLe(tb.a.zJa,b);this.qNe()&&this.jLe(Mb.a.L7a,c);this.N5k(Mb.a.kXa,f);this.Gi.Mvb?this.Gi.me(Kg.a.fec,!0):this.Gi.removeProperty(Kg.a.fec)}qNe(){return!0}jLe(a,b){b&&Array.contains(b,!0)?this.Gi.me(a,b):this.Gi.removeProperty(a)}N5k(a,b){!b||Qa.a.all(b,c=>0===c)?this.Gi.removeProperty(a):
this.Gi.me(a,b)}hqi(a,b){(b=this.Gi.Ra.ga(b).formatting)?(a.formatting=b.Ud(a),H.a.instance.ga(57)&&(this.Gi.Nu(),-1!==a.formatting.kg&&this.Gi.wordRunProperties.ivb(b.kg,64))):(Z.ULS.shipAssertTag(18109325,324,!1,"There is a Chp that has spelling error, but its formatting object is null"),rb.a.instance.Tb("CloneFormattingObjectError",{["Reason"]:"There is a Chp that has spelling error, but its formatting object is null"}))}IFh(a,b,c,f,l,x){const G=rb.a.instance.Kp(E.a.eBl);G.properties.$(Dd.a.source,
x);let R=!1;a&&a.length!==l&&(Z.ULS.sendTraceTag(18109326,324,10,"NotProofedRuns has inconstant length with expected. Length: [{0}], expected: [{1}], context:[{2}]",a.length,l,x),R=!0);b&&b.length!==l&&(Z.ULS.sendTraceTag(18109327,324,10,"SpellErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",b.length,l,x),R=!0);this.qNe()&&c&&c.length!==l&&(Z.ULS.sendTraceTag(20784798,324,10,"GrammarErrorRuns has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",
c.length,l,x),R=!0);f&&f.length!==l&&(Z.ULS.sendTraceTag(25274201,324,10,"ProofingErrorHints has inconstant length with expected: Length: [{0}], expected: [{1}], context:[{2}]",f.length,l,x),R=!0);if(R)for(f=c=b=null,a=[],x=0;x<l;x++)Array.add(a,!0);G.end();return{returnValue:!R,Eva:a,zJa:b,L7a:c,kXa:f}}T2g(){}Awe(){this.asc=0;this.wZe=this.Gi.a0||[];this.zZe=this.Gi.rKb||[];this.jGd=this.vzd=0;this.ssd=!1}Dwe(a,b){a.Jp&&a.Jp.Gh?this.asc=a.Jp.Gh.proofingType:a.bL&&(this.asc=0);a=a.cp;b=b?b.cp:a;this.ssd=
({QPe:this.vzd}=this.wug(a,b,this.wZe,this.vzd)).returnValue||({QPe:this.jGd}=this.wug(a,b,this.zZe,this.jGd)).returnValue}wug(a,b,c,f){for(;f<c.length;){const l=c[f];if(l.end<=a)++f;else return{returnValue:b>l.begin,QPe:f}}return{returnValue:!1,QPe:f}}}Object(e.a)(ht,"ProofingDataHandler",null,[1360]);var Ju=d(502);class dy extends ht{constructor(a,b,c,f,l,x,G,R,fa){super(a,b,c,f,R);this.VKg=!1;this.a8b=null;this.WI=l;this.ia=x;this.Ea=G;this.lc=fa;this.cZc=null}T2g(){this.WI.Ssl(this.Gi)}Ich(a,
b,c){this.Gi.o$d||(a=!1,c=this.wm.iF(this.Gi));this.cZc=this.wm.iF(this.Gi,f=>{f=Object(ua.a)(658,f.Gh);return!!f&&5===f.proofingType&&!f.mDa});return{V9g:a,sYg:b,rYg:c}}aBh(a,b,c,f,l){const x=Object(ua.a)(120,this.lc.ig(this.Gi));this.Gi&&x&&x.isConnected&&x.isSlideCritiqueReady&&Ka.a.LKd(this.Gi.characterData,b)&&this.cZc&&0<this.cZc.length&&(Array.addRange(l,this.cZc),l.sort((G,R)=>G.end-R.end));if(!a&&c&&0<c.length&&Ka.a.LKd(this.Gi.characterData,b)&&f&&0<f.length){for(const G of c)this.wyg(G,
f)&&!this.wyg(G,l)&&Array.add(l,G);l.sort((G,R)=>G.end-R.end)}}wyg(a,b){a=nk.c([a],b);return!Qa.a.Va(a)&&Qa.a.any(a,c=>c.begin<c.end)}U9g(){this.WI.LNj(this.Gi)&&this.hRb.fR(this.Gi)}qNe(){return!1}KIe(a,b){this.VKg=!0;super.KIe(a,b);b&&(this.Gi.me(Sl.a.Lca,!1),this.Gi.me(Sl.a.WWc,(new Date).getTime()))}gkh(a,b){this.a8b||(this.a8b=this.wm.iF(this.Gi));b.add(1===a)}Awe(){super.Awe();this.a8b=null}ree(a,b,c,f,l,x,G,R){x||(b=!!b&&b[a],a=!!c&&c[a],c=this.Gi.Ra.ga(this.Gi.Ra.length-1),b?(Array.add(G,
new Wk.a(c.cp,this.Gi.characterData.length)),this.FZk()):(b=this.q0i(c.cp,this.Gi.characterData.length,this.Gi.characterData,fa=>{fa=fa.Gh.proofingType;return 2===fa||3===fa}))&&0<b.length&&Array.addRange(R,b),a&&(Array.add(G,new Wk.a(c.cp,this.Gi.characterData.length)),Array.add(R,new so(c.cp,this.Gi.characterData.length,new Iu(1,1)))))}MIe(a,b,c,f,l){this.VKg||this.Htj()||Aa.a.J.apply(null,[37368030,375,50,"notProofedRuns:{0}, spellErrorRuns:{1}, grammarErrorRuns:{2}",a,b].concat(c));super.MIe(a,
b,c,null,l)}Htj(){if(!this.Gi)return Aa.a.J(37368032,375,10,"ParagraphNode is null"),!1;var a=this.Ea.tn(this.Gi);if(!a)return Aa.a.J(37368034,375,10,"ShapeNode is null"),!1;a=new Ju.a(a,Cb.App.Mm);this.ia.La(ba.a.cfb,2,a);return a.Rsa}FZk(){const a=new Id.GraphTransaction(4);a.gd(this.Gi);this.Gi.me(Sl.a.Lca,!1);this.Gi.me(Sl.a.WWc,(new Date).getTime());a.dispose()}q0i(a,b,c,f){const l=[];if(this.a8b)for(const x of this.a8b){const G=Object(ua.a)(so,x);G&&G.Gh&&G.Gh.token===c.substring(G.begin,G.end)&&
G.end>a&&G.end<=b&&f(G)&&Array.add(l,G)}return l}}Object(e.a)(dy,"PPTProofingDataHandler",ht,[]);class iw{constructor(a,b,c,f,l,x,G,R){this.r9=a;this.x7j=b;this.mC=c;this.WI=f;this.EF=G;this.ia=l;this.lc=R;this.Ea=x}uBi(a){return new dy(a,this.r9,this.x7j,this.mC,this.WI,this.ia,this.Ea,this.EF,this.lc)}}Object(e.a)(iw,"PPTProofingDataHandlerFactory",null,[1176]);class jw{constructor(a,b){this.o9=a;this.oFg=b}initialize(){this.o9.execute(a=>{if(this.oFg)for(const b of this.oFg)this.NOk(a,b)})}NOk(a,
b){a.registerSimpleRemoteWorkflow(b.WF,b.bpb,b.FFb,b.rob)}}Object(e.a)(jw,"ProofingAugLoopRuntimeManager",null,[]);class ey{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc){this.Ea=a;this.Nl=b;this.lc=c;this.Cl=f;this.Fb=l;this.Nb=x;this.Hk=G;this.ua=R;this.r9=fa;this.mC=wa;this.pi=mb;this.Hh=Kb;this.xla=nc;this.yb=oc;this.od=Kc;this.ZOg=Hc;this.SVa=new Ha.a;this.Hk.x8h(Object(C.a)(this,this.u3g,"onUndoRevisionStateChanged"));this.wT=Wa.vd(12);this.wT.Yj(Object(C.a)(this,this.onParagraphPropertyChanged,
"onParagraphPropertyChanged"));this.CL=Wa.vd(10);this.CL.nG(Object(C.a)(this,this.o2g,"onShapeTopologyChanged"));this.O9j=new xe.a(3,1,0,Object(C.a)(this,this.resumeProofingAfterUndo,"resumeProofingAfterUndo"),90,"14");this.fcc=this.IFa=!1;this.od.uV(Object(C.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}dispose(){this.Hk.jTk(Object(C.a)(this,this.u3g,"onUndoRevisionStateChanged"));this.wT.tm(Object(C.a)(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"));this.CL.yO(Object(C.a)(this,
this.o2g,"onShapeTopologyChanged"));this.od.Tma(Object(C.a)(this,this.onActiveSlideDomReady,"onActiveSlideDomReady"))}clc(a,b){this.Ea.kJ(a,c=>{this.Lnh(c,b)})}Mnh(a,b){this.Nl.hhc(a,c=>{this.Lnh(c,b)})}Txl(a,b){b?this.Ea.kJ(a,c=>{c&&this.mC.qOd(c)}):this.Ea.kJ(a,c=>{c&&(c.mUb=!0)})}bBh(a){if(a&&a.isConnected&&!a.Sp){var b=this.Fb.ke(4);try{let c=!1;const f=this.Nb.Kc(a);b.kc(f);const l=this.Cl.Nqa(a);for(;l.moveNext();){const x=l.currentNode;this.rbl(x)&&(c=!0,x.e$c(),x.xhc=!0)}c&&this.fUg(a)}finally{b&&
b.dispose()}this.pi.forceOutbound()}}Ssl(a){if(this.Wsa(a)&&a.mUb)if(this.fcc&&!this.SVa.contains(a))this.SVa.add(a);else{var b=this.Fb.ke(4);try{b.kc(a),a.e$c(),a.xhc=!0,this.kdk(a)}finally{b&&b.dispose()}a.mUb=!1}}dcd(a){this.Wsa(a)&&this.Ea.kJ(a,b=>{this.r9.fR(b)})}$Dk(a){this.Wsa(a)&&this.Nl.hhc(a,b=>{this.r9.fR(b)})}LNj(a){return this.Wsa(a)&&(this.NNj(a)||this.MNj(a))}fUg(a){a&&a.isConnected&&this.Ea.oEa(a)&&this.Wnh(a)}kdk(a){const b=this.Ea.tn(a);this.fUg(b);this.Nl.xja(a)&&(a=this.Nl.Ltb(a))&&
a.isConnected&&this.Nl.$Da(a)&&this.Wnh(a)}u3g(a,b){if(b)switch(b.state){case 0:this.fcc=!0;break;case 3:this.fcc=!1,this.IFa||(this.yb.Cb(this.O9j),this.IFa=!0)}}rbl(a){return this.Wsa(a)?a.sa(tb.a.Eva,null)?!0:a.sa(tb.a.zJa,null)?!0:!1:!1}onParagraphPropertyChanged(a,b){this.fcc&&b&&b.node&&(12!==b.node.type||this.SVa.contains(b.node)||this.SVa.add(b.node))}o2g(a,b){this.fcc&&b&&b.node&&(10!==b.node.type||this.SVa.contains(b.node)||this.SVa.add(b.node))}resumeProofingAfterUndo(){this.IFa=!1;for(let b of this.SVa)if(this.Wsa(b))if(this.Ea.oEa(b)){var a=
b;a&&(this.clc(a,!0),this.dcd(a))}else this.Hh.Vd(b)&&(a=b)&&(a.mUb=!0,this.r9.fR(a));this.SVa.clear()}Lnh(a,b){a&&(a.mUb=b&&a.a0&&0<a.a0.length?!0:!1)}NNj(a){if(this.ZOg){const b=this.ua.Ba;if(!this.Wsa(b))return!1;a=this.Ea.hca(a);return this.lc.ig(a)===b}return this.xla.oGj(a)}MNj(a){var b=this.ua.Ba;if(!this.Wsa(b))return!1;a=this.Nl.Ltb(a);b=b.VQa();return this.Wsa(a)&&this.Wsa(b)&&Ga.a.sP(a.id,b.id)}Wnh(a){a.setValue(sb.a.ecd,a.sa(sb.a.ecd,0)+1)}Wsa(a){return!!a&&a.isConnected}onActiveSlideDomReady(){if(this.ZOg){var a=
this.ua.Ba;if(a&&(a=a.jl())&&0<a.length)for(const b of a)this.Ea.LA(b)&&this.dcd(b)}}}Object(e.a)(ey,"ProofingBehaviorController",null,[1177,106]);class fy extends ro.a{constructor(a,b,c,f,l,x=!0,G=!1,R=50){super(a,b,c,f,l,x);this.k6j=G;this.jNg=R}Tlh(a){a=Array.isArray(a)?a:null;if(!Qa.a.Va(a))if(a.length<=this.jNg)this.logTrace(a);else{const b=[];for(const c of a)Array.add(b,c),b.length===this.jNg&&(this.logTrace(b),Array.clear(b));0<b.length&&this.logTrace(b)}}logTrace(a){a&&Aa.a.J(37325012,375,
this.k6j?15:50,"{0}",Fi.c(a))}}Object(e.a)(fy,"DashboardAggregator",ro.a,[]);class kw{constructor(a){this.q9=new fy(new Sa.a(()=>u.AFrameworkApplication.pe),u.AFrameworkApplication.ofa,15,a.pptProofingDashboardTraceIntervalInMinutes,new Oo,!0,a.pptProofingDashboardTraceAsMonitorableEnabled,a.pptProofingDashboardMaxCountInEachLog)}track(a){this.q9.track(a,"")}oTd(a){let b=null;try{b=Yd.a(a)}catch(c){Aa.a.J(37325010,375,15,"Try parse dashboardTelemetry failed")}return b}}Object(e.a)(kw,"ProofingDashboardAggregator",
null,[1174]);class Ku{track(){}oTd(){return null}}Object(e.a)(Ku,"ProofingDashboardNonOperationAggregator",null,[1174]);var cs=d(429),it=d(428);class Lu{constructor(a){this.I9j=a}ux(a,b,c){this.I9j(b,c);return!0}}Object(e.a)(Lu,"NonOpProofingALRequestManager",null,[1268]);class Mu{constructor(a,b,c){this.O_=this.j_=null;this.Xse=a;this.t8b=b.pptEditorConsistencyCheckIsEnabled;this.woe=b.pptProofingLogWorkflowExceptionEnabled;this.q9=c;this.rqe=new Lu(Object(C.a)(this,this.eHe,"requestAL"))}get WF(){return"ProofingTileCheckCloudALWorkflow"}get proto(){return""}get bpb(){this.j_||
(this.j_=Object.assign(new it.a,{name:"LambdaBefore_ProofingTileCheckCloudAL",inputSchema:cs.a.wmc,outputSchema:Lp.a.HQf,func:Object(C.a)(this,this.T9a,"lambdaBeforeFunc")}));return this.j_}get rob(){return null}get FFb(){this.O_||(this.O_=Object.assign(new it.a,{name:"LambdaRemote_ProofingTileCheckCloudAL",inputSchema:Lp.a.HQf,outputSchema:Lp.a.WOd,func:null}));return this.O_}eHe(a,b){b(a)}T9a(a,b,c){try{Aa.a.J(36962511,375,50,"{0}:LambdaBeforeStart",this.WF);const G=Object.assign(new gq,{d:{["bs"]:(new Date).getTime()},
w:Object.assign(new rr,{wn:rm.Uld})});this.q9.track(Object.assign(new gq,{w:Object.assign(new rr,{wn:rm.Uld}),p:rm.rBg}));let R=String.format("LambdaBeforeStart:{0}",G.d[xk.ude].toString());if(a){G.w.i=a.Id;try{var f=Yd.a(a.Content)}catch(fa){Aa.a.J(36763234,375,10,"Try parse tile response failed");c(null);return}if(f){var l=f.isSlideCritiqueReady;b=!1;var x=({gEa:b}=this.Xse.Ngl(f)).returnValue;x?b&&(!this.t8b||this.t8b&&l)?(c(null),this.q9.track(Object.assign(new gq,{w:Object.assign(new rr,{wn:rm.Uld}),
p:rm.qBg})),Aa.a.J(36962520,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.WF,a.Id,b,l)):(G.d[xk.IWc]=(new Date).getTime(),G.p=rm.LTj,R=String.format("TileId:{0}, {1}, LambdaBeforeDone:{2}",a.Id,R,G.d[xk.IWc].toString()),this.q9.track(G),Aa.a.J(36783312,375,50,R),this.rqe.ux(f.id,x,c)):(c(null),Aa.a.J(36962518,375,50,"{0}:LambdaBeforeDone,RequestNull,{1}",this.WF,a.Id))}else c(null)}else c(null),Aa.a.J(36962513,375,50,"{0}:LambdaBeforeDone,InputNull",this.WF)}catch(G){a=
"CloudAL LambdaBefore Exception",this.woe&&(a=String.format("CloudAL LambdaBefore Exception Message: {0}, Stack: {1}",G.message,G.stack)),Aa.a.J(37835201,375,10,a),c(null)}}}Object(e.a)(Mu,"ProofingTileCheckCloudALWorkflow",null,[708,1229]);class lw{}Object(e.a)(lw,"AugEditorServiceTileCheckRequest",null,[]);class Mq{constructor(){this.contextId=this.JWc=null}}Object(e.a)(Mq,"RequestStateObject",null,[]);class Nu{constructor(a,b,c,f){this.J9j=0;this.O_=this.j_=null;this.Xse=a;this.eT=b;this.t8b=c.pptEditorConsistencyCheckIsEnabled;
this.woe=c.pptProofingLogWorkflowExceptionEnabled;this.q9=f;this.rqe=new Lu(Object(C.a)(this,this.eHe,"requestAL"))}get WF(){return"ProofingTileCheckWacALWorkflow"}get proto(){return'syntax="proto3";message AugEditorServiceTileCheckRequest { string Topic = 1; string Data = 2; string ContextId = 3; string Telemetry = 4; string DashboardTelemetry = 5; };message AugEditorServiceTileCheckResponse { string  Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; string Telemetry = 6; string DashboardTelemetry = 7; }; '}get bpb(){this.j_||
(this.j_=Object.assign(new it.a,{name:"LambdaBefore_ProofingTileCheckWacAL",inputSchema:cs.a.wmc,outputSchema:Lp.a.uJf,func:Object(C.a)(this,this.T9a,"lambdaBeforeFunc")}));return this.j_}get rob(){return null}get FFb(){this.O_||(this.O_=Object.assign(new it.a,{name:"LambdaRemote_ProofingTileCheckWacAL",inputSchema:Lp.a.uJf,outputSchema:Lp.a.vJf,func:Object(C.a)(this,this.vde,"lambdaRemoteFunc")}));return this.O_}eHe(a,b){if(b){var c=this.q9.oTd(a.DashboardTelemetry);c&&(c.d[xk.dGh]=(new Date).getTime());
var f=String.format("{0}, LambdaRemoteStart:{1}",a.Telemetry,(new Date).getTime());this.eT.execute(l=>{f=String.format("{0}, RequestWacALStart:{1}",f,(new Date).getTime().toString());l.Njc(a.Topic,a.Data,a.ContextId,x=>{this.BIa(x,f,c)},x=>{this.zIa(x,f)},Object.assign(new Mq,{contextId:a.ContextId,JWc:b}))})}}T9a(a,b,c){try{Aa.a.J(36962523,375,50,"{0}:LambdaBeforeStart",this.WF);const G=Object.assign(new gq,{d:{["bs"]:(new Date).getTime()},w:Object.assign(new rr,{wn:rm.iol})});let R=String.format("LambdaBeforeStart:{0}",
G.d[xk.ude].toString());this.q9.track(Object.assign(new gq,{w:G.w,p:rm.rBg}));if(a){try{var f=Yd.a(a.Content)}catch(fa){c(null);Aa.a.J(36525525,375,10,"Try parse tile response failed");return}if(f){var l=f.isSlideCritiqueReady;b=!1;var x=({gEa:b}=this.Xse.Ogl(f,++this.J9j)).returnValue;x?b&&(!this.t8b||this.t8b&&l)?(c(null),this.q9.track(Object.assign(new gq,{w:G.w,p:rm.qBg})),Aa.a.J(36962560,375,50,"{0}:LambdaBeforeDone,{1},isProofingClean:{2},isSlideCritiqueReady:{3}",this.WF,a.Id,b,l)):(G.d[xk.IWc]=
(new Date).getTime(),R=String.format("{0}, LambdaBeforeDone:{1}",R,G.d[xk.IWc].toString()),c(Object.assign(new lw,{Topic:Lp.a.aMi,Data:Yd.c(x),ContextId:f.id,Telemetry:R,DashboardTelemetry:Fi.c(G)})),Aa.a.J(36962562,375,50,"{0}:LambdaBeforeDone,{1}",this.WF,a.Id)):(c(null),Aa.a.J(36962530,375,50,"{0}:LambdaBeforeDone,RequestNull{1},",this.WF,a.Id))}else c(null)}else c(null),Aa.a.J(36962525,375,50,"{0}:LambdaBeforeDone,InputNull",this.WF)}catch(G){a="WACAL LambdaBefore Exception",this.woe&&(a=String.format("WACAL LambdaBefore Exception Message: {0}, Stack: {1}",
G.message,G.stack)),Aa.a.J(37835210,375,10,a),c(null)}}vde(a,b,c){Aa.a.J(36962564,375,50,"{0}:LambdaRemoteStart",this.WF);a?this.rqe.ux(a.ContextId,a,c):(c(null),Aa.a.J(36962566,375,50,"{0}:LambdaRemoteDone,InputNull",this.WF))}BIa(a,b,c){if(!u.AFrameworkApplication.Vg&&a&&a.data){var f=(new Date).getTime(),l=a.data.state;if(l){try{var x=Yd.a(a.data.Sd)}catch(G){l.JWc(null);Aa.a.J(36525527,375,10,"Try parse aug response failed:{0}",G.message);return}x&&(x.Telemetry=String.format("{0}, LambdaRemoteDoneAndSucceed:{1}",
b,f.toString()),c&&(c.d[xk.eGh]=f,x.DashboardTelemetry=Fi.c(c)));l.JWc(x);Aa.a.J(36962571,375,50,"{0}:LambdaRemoteDone,Succeeded",this.WF)}}}zIa(a,b){!u.AFrameworkApplication.Vg&&a&&a.data&&(b=String.format("{0}, LambdaRemoteDoneAndFailed: {1}",b,(new Date).getTime().toString()),Aa.a.J(36525529,375,10,"Tile check request failed with: {0}, time: {1}",a.data.Sd,b),(a=a.data.state)&&a.JWc(null))}}Object(e.a)(Nu,"ProofingTileCheckWacALWorkflow",null,[708,1229]);class Ou{constructor(){this.groupType=0}}
Object(e.a)(Ou,"AnalyzerData",null,[]);class jt{constructor(){this.nodes=this.metadata=null}}Object(e.a)(jt,"TopologyNode",null,[]);class mw{constructor(){this.TileElements=this.AnalyzerData=this.RevisionId=this.TileId=null}}Object(e.a)(mw,"Content",null,[]);class nw{constructor(){this.value=this.typeName=this.name=this.languageId=this.id=null}}Object(e.a)(nw,"CritiqueTypeOption",null,[]);class ow{constructor(){this.isCompliant=!1;this.licenseType=0}}Object(e.a)(ow,"Descriptors",null,[]);class pw{constructor(){this.AppId=
this.SessionId=null;this.RequestOrderInSession=0;this.OverriddenCritiqueTypeOptions=this.Descriptors=this.Topology=this.Content=this.LanguageUxId=null}}Object(e.a)(pw,"EditorServiceTileCheckRequest",null,[]);class qw{constructor(){this.indentationLevel=this.listLevel=this.listType=0;this.listTag=null;this.listElementIndex=this.listNumeration=0}}Object(e.a)(qw,"ListMetadata",null,[]);var kt;(function(a){a[a.Undefined=0]="Undefined";a[a.AlphaLcParenBoth=1]="AlphaLcParenBoth";a[a.AlphaUcParenBoth=2]=
"AlphaUcParenBoth";a[a.AlphaLcParenR=3]="AlphaLcParenR";a[a.AlphaUcParenR=4]="AlphaUcParenR";a[a.AlphaLcPeriod=5]="AlphaLcPeriod";a[a.AlphaUcPeriod=6]="AlphaUcPeriod";a[a.ArabicParenBoth=7]="ArabicParenBoth";a[a.ArabicParenR=8]="ArabicParenR";a[a.ArabicPeriod=9]="ArabicPeriod";a[a.ArabicPlain=10]="ArabicPlain";a[a.RomanLcParenBoth=11]="RomanLcParenBoth";a[a.RomanUcParenBoth=12]="RomanUcParenBoth";a[a.RomanLcParenR=13]="RomanLcParenR";a[a.RomanUcParenR=14]="RomanUcParenR";a[a.RomanLcPeriod=15]="RomanLcPeriod";
a[a.RomanUcPeriod=16]="RomanUcPeriod";a[a.CircleNumDbPlain=17]="CircleNumDbPlain";a[a.CircleNumWdBlackPlain=18]="CircleNumWdBlackPlain";a[a.CircleNumWdWhitePlain=19]="CircleNumWdWhitePlain";a[a.ArabicDbPeriod=20]="ArabicDbPeriod";a[a.ArabicDbPlain=21]="ArabicDbPlain";a[a.Ea1ChsPeriod=22]="Ea1ChsPeriod";a[a.Ea1ChsPlain=23]="Ea1ChsPlain";a[a.Ea1ChtPeriod=24]="Ea1ChtPeriod";a[a.Ea1ChtPlain=25]="Ea1ChtPlain";a[a.Ea1JpnChsDbPeriod=26]="Ea1JpnChsDbPeriod";a[a.Ea1JpnKorPlain=27]="Ea1JpnKorPlain";a[a.Ea1JpnKorPeriod=
28]="Ea1JpnKorPeriod";a[a.Arabic1Minus=29]="Arabic1Minus";a[a.Arabic2Minus=30]="Arabic2Minus";a[a.Hebrew2Minus=31]="Hebrew2Minus";a[a.ThaiAlphaPeriod=32]="ThaiAlphaPeriod";a[a.ThaiAlphaParenR=33]="ThaiAlphaParenR";a[a.ThaiAlphaParenBoth=34]="ThaiAlphaParenBoth";a[a.ThaiNumPeriod=35]="ThaiNumPeriod";a[a.ThaiNumParenR=36]="ThaiNumParenR";a[a.ThaiNumParenBoth=37]="ThaiNumParenBoth";a[a.HindiAlphaPeriod=38]="HindiAlphaPeriod";a[a.HindiNumPeriod=39]="HindiNumPeriod";a[a.HindiNumParenR=40]="HindiNumParenR"})(kt||
(kt={}));Object(e.b)("ListNumeration",kt);var ij;(function(a){a[a.Undefined=0]="Undefined";a[a.Bullet=1]="Bullet";a[a.Numbered=2]="Numbered"})(ij||(ij={}));Object(e.b)("ListType",ij);class Uo{constructor(){this.tileContextDictionary=this.readingOrderTopology=this.tiles=this.overriddenCritiqueTypeOptions=this.languageUxId=this.documentSessionId=this.documentId=this.descriptors=null}}Object(e.a)(Uo,"ProofingRequest",null,[]);class ds{constructor(){this.Id=null;this.Type=0;this.NumberOfChildren=this.Children=
this.AnalyzerData=null;this.AreChildrenOrdered=!1}}Object(e.a)(ds,"TopologyNode",null,[]);class Pu{constructor(){this.nodes=null}}Object(e.a)(Pu,"ReadingOrderTopology",null,[]);class Qu{constructor(){this.Length=this.Start=0;this.LanguageId=null;this.DoNotCheck=!1}}Object(e.a)(Qu,"Span",null,[]);class gy{constructor(){this.elements=this.metadata=null;this.subType=0}}Object(e.a)(gy,"TextTile",null,[]);class qp{constructor(){this.text=null;this.textUnit=0;this.spans=this.listMetadata=this.languageId=
null;this.isClean=!1}}Object(e.a)(qp,"TextTileElement",null,[]);class rw{constructor(){this.doNotProcess=!1;this.languageId=null;this.start=this.length=0}}Object(e.a)(rw,"TextTileElementSpan",null,[]);class lt{constructor(){this.analyzerData=null;this.numberOfChildrenOnClient=0}}Object(e.a)(lt,"TileContext",null,[]);class sw{constructor(){this.AnalyzerData=this.Text=null;this.TextUnit=0;this.LanguageId=null;this.IsClean=!1;this.Spans=null}}Object(e.a)(sw,"TileElement",null,[]);class es{constructor(){this.tileId=
this.revisionId=null;this.tileType=0}}Object(e.a)(es,"TileMetadata",null,[]);class Ru{constructor(a,b,c,f,l,x){this.rPg=a;this.jZc=b;this.qPg=c;this.EF=f;this.Ha=l;this.uc=x;this.BZc=null}get Czg(){return u.AFrameworkApplication.fa.ka("IsSubscriptionForProofingUser")&&this.EF.hSa}get descriptors(){this.BZc||(this.BZc=this.Q3i(),Aa.a.J(37090579,375,50,"Descriptors: {0}",Yd.c(this.BZc)));return this.BZc}Ogl(a,b){let c;c=!0;var f=sa.a.oe(u.AFrameworkApplication.lcid);if(!f)return{returnValue:null,gEa:c};
var l=new ds,x=new ds;b=Object.assign(new pw,{Descriptors:this.descriptors,AppId:"powerPoint_Online",LanguageUxId:f.name,RequestOrderInSession:b,SessionId:u.AFrameworkApplication.userSessionId,Content:[],Topology:l,OverriddenCritiqueTypeOptions:this.jZc.s_d()});this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled&&(l.Id=zh.a.VXb(u.AFrameworkApplication.fa.Ga("ServerDocId")).toString(),l.Type=4,l.AnalyzerData=null,l.Children=[],l.NumberOfChildren=this.uc.Hj(),l.AreChildrenOrdered=!1,x.Id=a.id,
x.Type=3,x.AnalyzerData=null,x.Children=[],x.NumberOfChildren=null,x.AreChildrenOrdered=!0,Array.add(l.Children,x));for(var G of a.drawingElems)if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled&&Array.add(x.Children,this.bql(G)),G.text&&G.text.paragraphs)for(const fa of G.text.paragraphs){if(null===fa.chars||!fa.cfRuns||!fa.cfRuns.length)continue;a=new mw;a.TileId=fa.id;a.TileElements=[];l=new sw;l.Text=fa.chars;l.TextUnit=8;if(fa.pfRuns&&fa.pfRuns.length&&fa.pfRuns[0].pf){f=fa.pfRuns[0].pf;
l.AnalyzerData={};if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==f.listType){l.AnalyzerData.ListLevel=f.lvl;var R=ij[this.e_d(f.listType)];1===f.listType?(l.AnalyzerData.ListType=R,l.AnalyzerData.ListTag=f.listTag):0===f.listType&&(l.AnalyzerData.ListType=R,l.AnalyzerData.ListNumeration=kt[this.X9f(f.listNumeration)],l.AnalyzerData.ListElementIndex=f.listElementIndex)}else l.AnalyzerData.IndentLevel=f.lvl;else l.AnalyzerData.ListLevel=f.lvl;l.IsClean=!f.proofingDirty;a.RevisionId=
f.revisionId}c=c&&l.IsClean;R=0;const wa=[];let Wa=null;for(const mb of fa.cfRuns)if(mb)if(f=sa.a.oe(mb.cf.lang)){this.qPg.ibd(mb.cf.lang);f=Object.assign(new Qu,{Start:R,Length:mb.len,LanguageId:f.name,DoNotCheck:mb.cf.noProof});Wa||(Wa=f.LanguageId);if(Wa!==f.LanguageId||mb.cf.noProof)0<=f.Start&&0<f.Length&&f.Start+f.Length<=l.Text.length?wa.push(f):(f.Length||f.Start!==l.Text.length)&&Aa.a.J(36823815,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",f.Start,f.Length,l.Text.length);
R+=mb.len}else R+=mb.len;!l.IsClean&&0<wa.length&&(l.Spans=Array.clone(wa));l.LanguageId=Wa;Ka.a.Va(l.LanguageId)?Aa.a.J(38385410,375,15,"Empty LanguageId, span length {0}",wa.length):(a.TileElements.push(l),b.Content.push(a))}for(x=b.Content.length-1;0<=x;x--)G=b.Content[x],G.TileElements.length&&null!==G.TileElements[0].Text||(Aa.a.J(37091085,375,50,"Empty TileElements or empty text in tile {0}",G.TileId),Array.removeAt(b.Content,x));b.Content.length||Aa.a.J(37091087,375,50,"Empty tiles");return{returnValue:b,
gEa:c}}bql(a){const b=Object.assign(new ds,{Id:a.id,Type:2,AnalyzerData:{},Children:[],NumberOfChildren:a.text.paragraphs.length,AreChildrenOrdered:!0});b.AnalyzerData.GroupType=a.mk.type;for(const c of a.text.paragraphs)a=Object.assign(new ds,{Id:c.id,Type:1,NumberOfChildren:null,AreChildrenOrdered:!1}),Array.add(b.Children,a);return b}Ngl(a){let b;b=!0;var c=sa.a.oe(u.AFrameworkApplication.lcid);if(!c)return{returnValue:null,gEa:b};var f={};c=Object.assign(new Uo,{descriptors:this.i1i(this.descriptors),
languageUxId:c.name,documentSessionId:u.AFrameworkApplication.userSessionId,tiles:[],overriddenCritiqueTypeOptions:this.h1i(this.jZc.s_d()),tileContextDictionary:f,documentId:zh.a.VXb(u.AFrameworkApplication.fa.Ga("ServerDocId")).toString(),readingOrderTopology:Object.assign(new Pu,{nodes:[]})});const l=this.K3h(a,c.readingOrderTopology,f);for(var x of a.drawingElems)if(x.text&&x.text.paragraphs){a=this.a2h(x,l,f);for(const G of x.text.paragraphs)({gEa:b}=this.f4h(c.tiles,G,b)),this.T2h(G,a,f)}for(f=
c.tiles.length-1;0<=f;f--)x=c.tiles[f],x.elements.length&&null!==x.elements[0].text||(Aa.a.J(37091090,375,50,"Empty TileElements or empty text in tile {0}",x.metadata?x.metadata.tileId:""),Array.removeAt(c.tiles,f));c.tiles.length||Aa.a.J(37091092,375,50,"Empty tiles");return{returnValue:c,gEa:b}}Q3i(){if(!this.rPg.descriptors)return null;const a=Array.clone(this.rPg.descriptors);for(const b of a)if(this.Czg&&"licensetype"===b.Name.toLowerCase())return b.Value="Subscription",a;this.Czg&&Array.add(a,
Object.assign(new ln,{Name:"LicenseType",Value:"Subscription"}));return a}i1i(a){const b=new ow;for(const c of a)"iscompliant"===c.Name.toLowerCase()&&(b.isCompliant="true"===c.Value.toLowerCase()),"licensetype"===c.Name.toLowerCase()&&(b.licenseType="subscription"===c.Value.toLowerCase()?2:0);return b}e_d(a){switch(a){case 0:return 2;case 1:return 1;default:return 0}}h1i(a){const b=[];for(const c of a)a=Object.assign(new nw,{id:c.Id,languageId:c.LanguageId,value:c.Value}),b.push(a);return b}X9f(a){return a+
1}j1i(a){switch(a){case 0:return 0;case 1:return 1;case 2:return 2;case 3:return 3;case 4:return 4;case 5:return 5;default:return 0}}f4h(a,b,c){if(null===b.chars||!b.cfRuns||!b.cfRuns.length)return{returnValue:null,gEa:c};const f=new gy;f.metadata=new es;f.metadata.tileId=b.id;f.metadata.tileType=1;f.elements=[];const l=new qp;l.text=b.chars;l.textUnit=4;l.listMetadata=new qw;var x=l.isClean=!1;if(b.pfRuns&&b.pfRuns.length&&b.pfRuns[0].pf){x=b.pfRuns[0].pf;if(this.Ha.powerPointTopologyAndListInfoInSlideTileIsEnabled)if(16!==
x.listType){l.listMetadata.listLevel=x.lvl;var G=this.e_d(x.listType);1===x.listType?(l.listMetadata.listType=G,l.listMetadata.listTag=x.listTag):0===x.listType&&(l.listMetadata.listType=G,l.listMetadata.listNumeration=this.X9f(x.listNumeration),l.listMetadata.listElementIndex=x.listElementIndex)}else l.listMetadata.indentationLevel=x.lvl;else l.listMetadata.listLevel=b.pfRuns[0].pf.lvl,l.listMetadata.listType=this.e_d(b.pfRuns[0].pf.listType);f.metadata.revisionId=b.pfRuns[0].pf.revisionId;l.isClean=
x=!b.pfRuns[0].pf.proofingDirty;c=c&&x}G=0;const R=[];let fa=null;for(const wa of b.cfRuns)if(wa)if(b=sa.a.oe(wa.cf.lang)){this.qPg.ibd(wa.cf.lang);b=Object.assign(new rw,{start:G,length:wa.len,languageId:b.name,doNotProcess:wa.cf.noProof});fa||(fa=b.languageId);if(fa!==b.languageId||wa.cf.noProof)0<=b.start&&0<b.length&&b.start+b.length<=l.text.length?R.push(b):(b.length||b.start!==l.text.length)&&Aa.a.J(36823817,375,10,"Invalid span, start: {0}, length: {1}, paragraph length: {2}",b.start,b.length,
l.text.length);G+=wa.len}else G+=wa.len;!x&&0<R.length&&(l.spans=Array.clone(R));l.languageId=fa;if(Ka.a.Va(l.languageId))return Aa.a.J(38385415,375,15,"Empty LanguageId, span length {0}",R.length),{returnValue:null,gEa:c};f.elements.push(l);a.push(f);return{returnValue:f,gEa:c}}K3h(a,b,c){const f=Object.assign(new jt,{metadata:Object.assign(new es,{tileId:a.id,tileType:2}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new lt,{analyzerData:new Ou,numberOfChildrenOnClient:a.drawingElems.length});
c[a.id]=b;return f}a2h(a,b,c){const f=Object.assign(new jt,{metadata:Object.assign(new es,{tileId:a.id}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new lt,{analyzerData:Object.assign(new Ou,{groupType:this.j1i(a.mk.type)}),numberOfChildrenOnClient:a.text.paragraphs.length});c[a.id]=b;return f}T2h(a,b,c){const f=Object.assign(new jt,{metadata:Object.assign(new es,{tileId:a.id,tileType:1}),nodes:[]});Array.add(b.nodes,f);b=Object.assign(new lt,{numberOfChildrenOnClient:0});c[a.id]=b}}Object(e.a)(Ru,
"TileToTileCheckRequestTransformer",null,[1227]);class Su{constructor(){this.EF=this.K=null}get name(){return"PowerPointWebEditor.Proofing"}Wb(a){this.K=a;this.gui();this.hui();this.K.register(1172,"Box4.Proofing.IEditorServiceErrorDetailsFactory").ma().na(()=>new hw(u.AFrameworkApplication.fa.ka("ProofingFeedbackLoopIsEnabled"),this.K.resolve("Box4.Proofing.IProofingFeedbackLoopManager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(1173,"Box4.Proofing.IProofingCritiqueCategoryInfoFilter").ma().na(()=>
new sr(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1174,"PowerPointWebEditor.Proofing.IProofingDashboardAggregator").ma().na(()=>this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptProofingDashboardTraceEnabled?new kw(this.K.resolve("PowerPointWebEditor.IApplicationSettings")):new Ku);this.K.register(Hu,"PowerPointWebEditor.Proofing.EditorServiceResultsManager").ma().na(()=>new Hu(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),
this.K.resolve("Box4.Proofing.IProofingTextUtility"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Box4.Proofing.IEditorServiceErrorDetailsFactory"),this.K.resolve("Common.Utils.Aggregators.IAggregator<System.Func<Box4.Proofing.ProofingTraceMetrics>>"),this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Proofing.ICloudALResponseTransformer"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator"),this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));this.K.register(1175,"PowerPointWebEditor.Proofing.IConsistencyCheckManager").ma().na(()=>new cy(this.K.resolve("Box4.Graph.IGraphInstance").vd(12),this.K.resolve("Box4.Graph.IGraphInstance").vd(22),this.K.resolve("Box4.Graph.IGraphInstance").vd(10),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("Box4.List.IListReader")));this.K.register(Ru,"PowerPointWebEditor.Proofing.TileToTileCheckRequestTransformer").as("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer").ma().na(()=>
new Ru(this.K.resolve("Box4.Proofing.IProofingDescriptors"),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings"),this.K.resolve("Box4.Proofing.IProofingConfigV2Manager"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));this.K.register(Gu,"PowerPointWebEditor.Proofing.CloudALResponseTransformer").as("PowerPointWebEditor.Proofing.ICloudALResponseTransformer").ma().na(()=>
new Gu);this.K.register(Nu,"PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>new Nu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(Mu,"PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>
new Mu(this.K.resolve("PowerPointWebEditor.Proofing.ITileToTileCheckRequestTransformer"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingDashboardAggregator")));this.K.register(jw,"PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").ma().na(()=>{const b=[],c=this.K.resolve("Common.IAppSettingsManager").ka("576");this.K.resolve("Common.IAppSettingsManager").ka("772")?b.push(c?this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow"):
this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")):(b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckWacALWorkflow")),c&&b.push(this.K.resolve("PowerPointWebEditor.Proofing.ProofingTileCheckCloudALWorkflow")));return new jw(this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),b)});this.K.register(fq.a,"Box4.Proofing.CritiqueTypeSettings").as("Box4.Proofing.ICritiqueTypeSettings").ma().na(()=>new fq.a(this.K.resolve("Box4.IRoamingServiceRequestManager"),
u.AFrameworkApplication.fa.Ga("PptRoamingServiceGetActionName"),u.AFrameworkApplication.fa.Ga("PptRoamingServiceSaveActionName")))}init(){this.K.resolve("PowerPointWebEditor.IPPTProofingDataHandlerFactory");const a=this.K.resolve("Common.IAppSettingsManager");a.ff(()=>{this.EF=this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration");this.EF.hSa=a.ka("810");this.EF.Cvb=a.ka("809");this.EF.LSa=a.ka("299");if(this.EF.hSa||this.EF.Cvb)this.K.resolve("Box4.Proofing.IProofingDescriptors").k8d(),this.K.resolve("PowerPointWebEditor.Proofing.ProofingAugLoopRuntimeManager").initialize(),
this.K.resolve("PowerPointWebEditor.Proofing.EditorServiceResultsManager").initialize();this.EF.LSa&&(this.K.resolve("Box4.Proofing.IProofingConfigV2Manager").init(),this.K.resolve("Box4.Proofing.ICritiqueTypeSettings").init());this.EF.Cvb&&(this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager"),this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").initialize())});this.K.resolve("Box4.IProofingManager").suspend()}dispose(){this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController").dispose();
this.EF.Cvb&&this.K.resolve("PowerPointWebEditor.Proofing.IConsistencyCheckManager").dispose()}gui(){this.K.register(1176,"PowerPointWebEditor.IPPTProofingDataHandlerFactory").ma().na(()=>new iw(this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IModifiedRangeEditor"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("PowerPointWebEditor.ISlideReader")))}hui(){this.K.register(1177,"PowerPointWebEditor.Proofing.IProofingBehaviorController").ma().na(()=>new ey(this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Box4.IProofingManager"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.Graph.IGraphInstance"),this.K.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.View.IShapeViewHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").qNj))}static main(){m.a.instance.Bc(new Su)}}Object(e.a)(Su,"PPTWebEditorProofingPackage",null,[2,3]);class mt{constructor(a,b,c,f,l,x,G,R,fa,wa){this.od=a;this.od.IBc(Object(C.a)(this,this.h3g,"onTextEditViewClose"));this.od.dUb(Object(C.a)(this,this.i3g,"onTextEditViewOpen"));this.od.P7h(Object(C.a)(this,this.lZg,"onBeforeTextEditViewClose"));this.od.T7h(Object(C.a)(this,
this.j3g,"onTextEditViewUpdate"));this.ahe=b;this.pi=l;this.yv=x;this.WI=c;this.Scb=f;this.N9b=G;this.$8b=R;this.I$j=fa;this.dH=wa}get fFc(){return this.ahe.instance}dispose(){this.od.tGe(Object(C.a)(this,this.h3g,"onTextEditViewClose"));this.od.Red(Object(C.a)(this,this.i3g,"onTextEditViewOpen"));this.od.LSk(Object(C.a)(this,this.lZg,"onBeforeTextEditViewClose"));this.od.OSk(Object(C.a)(this,this.j3g,"onTextEditViewUpdate"))}j3g(){this.$8b.lY()}i3g(a,b){a=b.xw.shapeNode;this.WI.clc(a,!1);this.WI.dcd(a);
this.fFc&&this.fFc.vqk(a)}lZg(a,b){this.N9b.EVd(b.xw.Gd)}h3g(a,b){a=b.xw;const c=b.xw.shapeNode,f=!!c&&c.isConnected;b.Rsa?this.dH.instance&&((this.dH.instance.Lwb||this.dH.instance.l8)&&2===this.dH.instance.vJ||this.dH.instance.DVc)?Aa.a.J(38836432,822,15,"ShapeViewElementTextEditHandler::onTextEditViewClose skipped when session is closing reason:{0}, ForceSave:{1}",this.dH.instance.vJ,this.dH.instance.DVc):(f&&c.bid(),c.qd?(this.WI.bBh(c),this.Scb.DZg(),this.yv.VQe()):(this.pi.B4a(c),this.yv.nOd())):
this.I$j||this.WI.bBh(c);this.WI.clc(b.xw.shapeNode,f&&c.QTc);this.fFc&&!a.Sp&&this.fFc.uqk(c)}}Object(e.a)(mt,"ShapeViewElementTextEditHandler",null,[106]);class nt{constructor(a){this.Kcc=null;this.i6j=a;this.reset()}lzh(a,b){a&&this.Kcc.$(a,b)}gub(a){let b=0;this.Kcc.Jb(a)&&(b=this.Kcc.ga(a)?1:2);return b}ive(a){return this.i6j?1===this.gub(a):!1}reset(){const a=this.Kcc;this.Kcc=new ef.a(!1);return a}}Object(e.a)(nt,"TextEditingRevisionInfoTracker",null,[1230,1231]);var ot=d(1035),we=d(573),hy=
d(407),Tu=d(830),Nq=d(315);class tw{constructor(){this.typeField=this.startAtField=0}}Object(e.a)(tw,"CT_TextAutonumberBullet",null,[]);class uw{constructor(){this.charField=null}}Object(e.a)(uw,"CT_TextCharBullet",null,[]);class iy{}Object(e.a)(iy,"CT_TextNoAutofit",null,[]);class jy{}Object(e.a)(jy,"CT_TextNoBullet",null,[]);class fs{constructor(){this.lnSpcReductionField=this.fontScaleField=0}}Object(e.a)(fs,"CT_TextNormalAutofit",null,[]);class gs{constructor(){this.itemField=null}}Object(e.a)(gs,
"CT_TextSpacing",null,[]);class ei{constructor(){this.valField=0}}Object(e.a)(ei,"CT_TextSpacingPercent",null,[]);class ky{constructor(){this.tField=this.rPrField=null}}Object(e.a)(ky,"CT_WebRegularTextRun",null,[]);class ly{constructor(){this.pField=this.lstStyleField=this.bodyPrField=null}}Object(e.a)(ly,"CT_WebTextBody",null,[]);class hq{constructor(){this.lInsField=this.horzOverflowField=this.bInsField=this.anchorField=0;this.normAutofitField=this.noAutofitField=null;this.rotField=this.rInsField=
0;this.spAutoFitField=null;this.spcFirstLastParaField=!1;this.wrapField=this.vertOverflowField=this.vertField=this.tInsField=0}}Object(e.a)(hq,"CT_WebTextBodyProperties",null,[]);class iq{constructor(){this.altLangField=null;this.baselineField=0;this.bFieldSpecified=this.bField=this.baselineFieldSpecified=!1;this.blipFillField=null;this.capField=0;this.capFieldSpecified=!1;this.defsymField=this.deflatinField=this.defeaField=this.defcsField=this.csField=null;this.dirtyField=!1;this.embedImgLocField=
this.effectLstField=this.effectDagField=this.eaField=null;this.errField=!1;this.hlinkMouseOverField=this.hlinkClickField=this.highlightField=this.grpFillField=this.gradFillField=null;this.isDefFontFieldSpecified=this.isDefFontField=this.iFieldSpecified=this.iField=!1;this.kernField=0;this.kernFieldSpecified=!1;this.noFillField=this.lnField=this.latinField=this.langField=null;this.normalizeHFieldSpecified=this.normalizeHField=this.noProofFieldSpecified=this.noProofField=!1;this.pattFillField=null;
this.proofErrField=0;this.rawSolidFillField=null;this.rtlFieldSpecified=this.rtlField=!1;this.solidFillField=null;this.spcField=0;this.spcFieldSpecified=!1;this.stField=0;this.strikeFieldSpecified=this.strikeField=this.stFieldSpecified=!1;this.symField=null;this.szField=0;this.uFieldSpecified=this.uField=this.szFieldSpecified=!1;this.uLnTxField=this.uLnField=this.uFillTxField=this.uFillField=null;this.utField=0;this.utFieldSpecified=!1}}Object(e.a)(iq,"CT_WebTextCharacterProperties",null,[]);class vw{constructor(){this.pPrField=
this.itemsField=this.endParaRPrField=null}}Object(e.a)(vw,"CT_WebTextParagraph",null,[]);class Oq{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.buSzTxField=this.buSzPtsField=this.buSzPctField=this.buNoneField=this.buFontTxField=this.buFontField=this.buClrTxField=this.buClrField=this.buCharField=this.buAutoNumField=null;this.defIndentFieldSpecified=this.defIndentField=!1;this.defIndentValueField=0;this.defListFieldSpecified=this.defListField=this.defIndentValueFieldSpecified=!1;this.defLnSpcField=
null;this.defMarginFieldSpecified=this.defMarginField=!1;this.defMarLValueField=0;this.defMarLValueFieldSpecified=!1;this.defSpcBefField=this.defSpcAftField=this.defRPrField=null;this.defTabSzField=0;this.eaLnBrkFieldSpecified=this.eaLnBrkField=this.defTabSzFieldSpecified=!1;this.fontAlgnField=0;this.hangingPunctFieldSpecified=this.hangingPunctField=this.fontAlgnFieldSpecified=!1;this.indentField=0;this.latinLnBrkFieldSpecified=this.latinLnBrkField=this.indentFieldSpecified=!1;this.lnSpcField=null;
this.lvlField=0;this.lvlFieldSpecified=!1;this.marLField=0;this.marLFieldSpecified=!1;this.marRField=0;this.rtlFieldSpecified=this.rtlField=this.marRFieldSpecified=!1;this.spcBefField=this.spcAftField=null}}Object(e.a)(Oq,"CT_WebTextParagraphProperties",null,[]);class hs{constructor(a,b){this.shapeText=a;this.iLb=b}}Object(e.a)(hs,"ShapeTextState",null,[]);class ww{constructor(){this.chngTyp=0;this.repChar=this.delChar=this.insChar=this.bodyPrChng=this.paraFrmtChng=this.charFrmtChng=null}}Object(e.a)(ww,
"IncrementalRequestTextOperation",null,[]);class Bj{constructor(a,b){this.len=this.cp=0;this.cp=a;this.len=b}sG(){return this.cp+this.len}contains(a){return this.cp<=a&&a<this.sG()}awa(a){return this.contains(a.cp)||a.contains(this.cp)}EDa(a){const b=Math.max(a.cp,this.cp);return new Bj(b,Math.max(0,Math.min(a.sG(),this.sG())-1-b+1))}static copy(a){return new Bj(a.cp,a.len)}}Object(e.a)(Bj,"TextRange",null,[]);class Mp{constructor(a){this.Gp=a}}Object(e.a)(Mp,"ChangeState",null,[]);const my=(a,b)=>
{if(!(a&&b&&a.rPrField&&b.rPrField))return null;let c=!1;const f=new iq;a.rPrField.bField!==b.rPrField.bField&&(c=!0,f.bField=b.rPrField.bField,f.bFieldSpecified=b.rPrField.bFieldSpecified);a.rPrField.iField!==b.rPrField.iField&&(c=!0,f.iField=b.rPrField.iField,f.iFieldSpecified=b.rPrField.iFieldSpecified);a.rPrField.uField!==b.rPrField.uField&&(c=!0,f.uField=b.rPrField.uField,f.uFieldSpecified=b.rPrField.uFieldSpecified);a.rPrField.strikeField!==b.rPrField.strikeField&&(c=!0,f.strikeField=b.rPrField.strikeField,
f.strikeFieldSpecified=b.rPrField.strikeFieldSpecified);a.rPrField.szField!==b.rPrField.szField&&(c=!0,f.szField=b.rPrField.szField,f.szFieldSpecified=b.rPrField.szFieldSpecified);a.rPrField.spcField!==b.rPrField.spcField&&(c=!0,f.spcField=b.rPrField.spcField,f.spcFieldSpecified=b.rPrField.spcFieldSpecified);a.rPrField.kernField!==b.rPrField.kernField&&(c=!0,f.kernField=b.rPrField.kernField,f.kernFieldSpecified=b.rPrField.kernFieldSpecified);a.rPrField.capField!==b.rPrField.capField&&(c=!0,f.capField=
b.rPrField.capField,f.capFieldSpecified=b.rPrField.capFieldSpecified);a.rPrField.baselineField!==b.rPrField.baselineField&&(c=!0,f.baselineField=b.rPrField.baselineField,f.baselineFieldSpecified=b.rPrField.baselineFieldSpecified);!b.rPrField.latinField||a.rPrField.latinField&&a.rPrField.latinField.typefaceField===b.rPrField.latinField.typefaceField||(c=!0,f.latinField=b.rPrField.latinField);!b.rPrField.eaField||a.rPrField.eaField&&a.rPrField.eaField.typefaceField===b.rPrField.eaField.typefaceField||
(c=!0,f.eaField=b.rPrField.eaField);return c?f:null},is=(a,b)=>{if(!(a&&b&&a.pPrField&&b.pPrField))return null;a=a.pPrField;b=b.pPrField;const c=new Oq;let f=!1;Cm(a.lnSpcField,b.lnSpcField)&&(c.lnSpcField=b.lnSpcField,f=!0);Cm(a.defLnSpcField,b.defLnSpcField)&&(c.defLnSpcField=b.defLnSpcField,f=!0);Cm(a.spcBefField,b.spcBefField)&&(c.spcBefField=b.spcBefField,f=!0);Cm(a.defSpcBefField,b.defSpcBefField)&&(c.defSpcBefField=b.defSpcBefField,f=!0);Cm(a.spcAftField,b.spcAftField)&&(c.spcAftField=b.spcAftField,
f=!0);Cm(a.defSpcAftField,b.defSpcAftField)&&(c.defSpcAftField=b.defSpcAftField,f=!0);Yd.c(a.defRPrField)!==Yd.c(b.defRPrField)&&(c.defRPrField=b.defRPrField,f=!0);!a.buNoneField!==!b.buNoneField&&(c.buNoneField=b.buNoneField,f=!0);Yd.c(a.buCharField)!==Yd.c(b.buCharField)&&(c.buCharField=b.buCharField,f=!0);Yd.c(a.buAutoNumField)!==Yd.c(b.buAutoNumField)&&(c.buAutoNumField=b.buAutoNumField,f=!0);Yd.c(a.buFontField)!==Yd.c(b.buFontField)&&(c.buFontField=b.buFontField,f=!0);if(a.marLFieldSpecified!==
b.marLFieldSpecified||a.marLField!==b.marLField)c.marLFieldSpecified=b.marLFieldSpecified,c.marLField=b.marLField,f=!0;if(a.defMarLValueFieldSpecified!==b.defMarLValueFieldSpecified||a.defMarLValueField!==b.defMarLValueField)c.defMarLValueFieldSpecified=b.defMarLValueFieldSpecified,c.defMarLValueField=b.defMarLValueField,f=!0;if(a.marRFieldSpecified!==b.marRFieldSpecified||a.marRField!==b.marRField)c.marRFieldSpecified=b.marRFieldSpecified,c.marRField=b.marRField,f=!0;if(a.lvlFieldSpecified!==b.lvlFieldSpecified||
a.lvlField!==b.lvlField)c.lvlFieldSpecified=b.lvlFieldSpecified,c.lvlField=b.lvlField,f=!0;if(a.indentFieldSpecified!==b.indentFieldSpecified||a.indentField!==b.indentField)c.indentFieldSpecified=b.indentFieldSpecified,c.indentField=b.indentField,f=!0;if(a.defIndentFieldSpecified!==b.defIndentFieldSpecified||a.defIndentField!==b.defIndentField)c.defIndentFieldSpecified=b.defIndentFieldSpecified,c.defIndentField=b.defIndentField,f=!0;if(a.algnFieldSpecified!==b.algnFieldSpecified||a.algnField!==b.algnField)c.algnFieldSpecified=
b.algnFieldSpecified,c.algnField=b.algnField,f=!0;if(a.defTabSzFieldSpecified!==b.defTabSzFieldSpecified||a.defTabSzField!==b.defTabSzField)c.defTabSzFieldSpecified=b.defTabSzFieldSpecified,c.defTabSzField=b.defTabSzField,f=!0;if(a.rtlFieldSpecified!==b.rtlFieldSpecified||a.rtlField!==b.rtlField)c.rtlFieldSpecified=b.rtlFieldSpecified,c.rtlField=b.rtlField,f=!0;if(a.defListFieldSpecified!==b.defListFieldSpecified||a.defListField!==b.defListField)c.defListFieldSpecified=b.defListFieldSpecified,c.defListField=
b.defListField,f=!0;if(a.defMarginFieldSpecified!==b.defMarginFieldSpecified||a.defMarginField!==b.defMarginField)c.defMarginFieldSpecified=b.defMarginFieldSpecified,c.defMarginField=b.defMarginField,f=!0;if(a.eaLnBrkFieldSpecified!==b.eaLnBrkFieldSpecified||a.eaLnBrkField!==b.eaLnBrkField)c.eaLnBrkFieldSpecified=b.eaLnBrkFieldSpecified,c.eaLnBrkField=b.eaLnBrkField,f=!0;if(a.fontAlgnFieldSpecified!==b.fontAlgnFieldSpecified||a.fontAlgnField!==b.fontAlgnField)c.fontAlgnFieldSpecified=b.fontAlgnFieldSpecified,
c.fontAlgnField=b.fontAlgnField,f=!0;if(a.latinLnBrkFieldSpecified!==b.latinLnBrkFieldSpecified||a.latinLnBrkField!==b.latinLnBrkField)c.latinLnBrkFieldSpecified=b.latinLnBrkFieldSpecified,c.latinLnBrkField=b.latinLnBrkField,f=!0;return f?c:null},Cm=(a,b)=>a||b?a&&b?a.itemField.valField!==b.itemField.valField:!0:!1;class Uu{constructor(){this.Rn=this.eGa=null}}Object(e.a)(Uu,"TextParaRange",null,[]);class pt{constructor(){this.Rn=this.UGa=null}}Object(e.a)(pt,"TextRunRange",null,[]);class ny{constructor(a,
b,c,f,l,x){this.Lda=this.nla=null;this.l4=this.fka=0;this.gL=this.A3=null;this.Sua=this.OEa=0;this.QEa=c;this.tGa=f;this.gka=l;this.t9=x;this.Qhd(new Bj(0,a.shapeText.length),new Bj(0,b.shapeText.length))}Qhd(a,b){this.nla=a;this.Lda=b;for(a=Math.max(0,this.OEa-1);a<this.QEa.length;a++)if(this.QEa[a].Rn.awa(this.nla)||this.nla.sG()<=this.QEa[a].Rn.cp){this.OEa=a;break}for(a=Math.max(0,this.Sua-1);a<this.tGa.length;a++)if(this.tGa[a].Rn.awa(this.Lda)||this.Lda.sG()<=this.tGa[a].Rn.cp){this.Sua=a;break}this.gL=
this.A3=null;for(a=Math.max(0,this.fka-1);a<this.gka.length;a++)if(this.gka[a].Rn.awa(this.nla)||this.nla.sG()<=this.gka[a].Rn.cp){this.fka=a;break}for(a=Math.max(0,this.l4-1);a<this.t9.length;a++)if(this.t9[a].Rn.awa(this.Lda)||this.Lda.sG()<=this.t9[a].Rn.cp){this.l4=a;break}}fWf(){return this.OEa>=this.QEa.length?null:Object.assign(new Uu,{eGa:this.QEa[this.OEa].eGa,Rn:this.QEa[this.OEa].Rn.EDa(this.nla)})}gWf(){return this.Sua>=this.tGa.length?null:Object.assign(new Uu,{eGa:this.tGa[this.Sua].eGa,
Rn:this.tGa[this.Sua].Rn.EDa(this.Lda)})}hWf(){return this.B$d()&&this.A3?Object.assign(new pt,{UGa:this.gka[this.fka].UGa,Rn:this.A3}):null}iWf(){return this.I4b()&&this.gL?Object.assign(new pt,{UGa:this.t9[this.l4].UGa,Rn:this.gL}):null}A$d(){return this.yug()&&this.H4b()}yug(){return this.OEa>=this.QEa.length?!1:this.QEa[this.OEa].Rn.awa(this.nla)}H4b(){return this.Sua>=this.tGa.length?!1:this.tGa[this.Sua].Rn.awa(this.Lda)}B$d(){return!this.yug()||this.fka>=this.gka.length?!1:this.gka[this.fka].Rn.awa(this.QEa[this.OEa].Rn)&&
this.gka[this.fka].Rn.awa(this.nla)}I4b(){return!this.H4b()||this.l4>=this.t9.length?!1:this.t9[this.l4].Rn.awa(this.tGa[this.Sua].Rn)&&this.t9[this.l4].Rn.awa(this.Lda)}KAh(){this.A$d()&&(this.OEa++,this.Sua++);return this.A$d()}LAh(){this.H4b()&&this.Sua++;return this.H4b()}xsl(){if(!this.B$d()||!this.I4b())return!1;if(this.A3&&this.gL){this.A3.sG()===this.gka[this.fka].Rn.sG()&&this.fka++;this.gL.sG()===this.t9[this.l4].Rn.sG()&&this.l4++;if(!this.B$d()||!this.I4b())return!1;var a=this.gka[this.fka].Rn.EDa(this.nla);
this.A3.cp=Math.max(a.cp,this.A3.sG());this.A3.len=a.sG()-this.A3.cp;a=this.t9[this.l4].Rn.EDa(this.Lda);this.gL.cp=Math.max(a.cp,this.gL.sG());this.gL.len=a.sG()-this.gL.cp}else this.A3=this.gka[this.fka].Rn.EDa(this.nla),this.gL=this.t9[this.l4].Rn.EDa(this.Lda);a=Math.min(this.A3.len,this.gL.len);this.A3.len=a;this.gL.len=a;return 0<a}ysl(){if(!this.I4b())return!1;this.A3||(this.A3=this.gka[this.fka].Rn.EDa(this.nla));if(this.gL){if(this.gL.sG()===this.t9[this.l4].Rn.sG()&&(this.l4++,!this.I4b()))return!1;
const a=this.t9[this.l4].Rn.EDa(this.Lda);this.gL.cp=Math.max(a.cp,this.gL.sG());this.gL.len=a.sG()-this.gL.cp}else this.gL=this.t9[this.l4].Rn.EDa(this.Lda);return 0<this.gL.len}}Object(e.a)(ny,"TextFormatIterator",null,[]);class jq{constructor(){this.txt=this.txtrng=null}}Object(e.a)(jq,"TextModificationData",null,[]);class qt{constructor(a,b){this.textRange=new Bj(a.cp,a.len);this.text=b}}Object(e.a)(qt,"TextModificationInfo",null,[]);class xw{constructor(){this.len=this.cp=0}}Object(e.a)(xw,"TextRangeData",
null,[]);class yw{constructor(){this.charPrp=this.txtrng=null}}Object(e.a)(yw,"WebTextCharFormatChange",null,[]);class rt{constructor(){this.paraPrp=this.txtrng=null}}Object(e.a)(rt,"WebTextParaFormatChange",null,[]);class Pq{constructor(a,b){this.sFg=this.YUa=this.Xzb=this.Xka=this.vT=-1;this.zpe=this.Lge=null;this.YTa=new Bj(0,0);this.rka=new Bj(0,0);this.E_=null;if(!a)throw Error.create("InputBaseTextStateNull");if(!b)throw Error.create("InputRevisedTextStateNull");this.Zxb=a;this.jcb=b;let c,
f;({qIe:a,Gze:c}=this.chg(a.iLb));1<a.length&&(this.sFg=a[a.length-1].Rn.sG());({qIe:b,Gze:f}=this.chg(b.iLb));this.LN=new ny(this.Zxb,this.jcb,c,f,a,b)}Nsi(){this.Esi();this.Fsi();this.Psi();const a=[],b=this.Vsi();b&&a.push(b);a.push.apply(a,this.Lsi());a.push.apply(a,this.Ksi());a.push.apply(a,this.Msi());return a}chg(a){const b=[],c=[];var f=[];var l=[];let x=0;if(!a.pField)return{qIe:f,Gze:l};for(const G of a.pField)if(a=new Uu,a.eGa=G,a.Rn=new Bj(x,0),f=0,G.itemsField&&G.itemsField.length){for(const R of G.itemsField)R.tField&&
R.tField.length&&(l=new pt,l.Rn=new Bj(x,R.tField.length),l.UGa=R,x+=R.tField.length,f+=R.tField.length,b.push(l));x+=1;a.Rn.len=f;c.push(a)}return{qIe:b,Gze:c}}Esi(){this.vT=this.M6c(!0)}Fsi(){this.vT===this.Zxb.shapeText.length?this.Xka=0:(this.Xka=this.M6c(!1),this.vT+this.Xka>this.Zxb.shapeText.length?this.Xka=this.Zxb.shapeText.length-this.vT:this.vT+this.Xka>this.jcb.shapeText.length&&(this.Xka=this.jcb.shapeText.length-this.vT))}Psi(){this.Xzb=this.Zxb.shapeText.length-this.vT-this.Xka;this.YUa=
this.jcb.shapeText.length-this.vT-this.Xka}Lsi(){const a=[];if(!this.vT)return a;this.LN.Qhd(new Bj(0,this.vT),new Bj(0,this.vT));do this.E_=this.hAh(),0!==this.E_.Gp&&a.push(this.vMc(this.E_));while(0!==this.E_.Gp);return a}Vsi(){if(!this.Xzb&&!this.YUa)return null;this.YTa=new Bj(this.vT,this.Xzb);this.rka=new Bj(this.vT,this.YUa);this.E_=!this.Xzb&&0<this.YUa?new Mp(4):0<this.Xzb&&!this.YUa?new Mp(5):new Mp(6);return this.vMc(this.E_)}Ksi(){const a=[];if(!this.YUa)return a;const b=new Bj(this.vT-
1,1);b.cp=Math.max(0,b.cp);b.cp=Math.min(b.cp,this.sFg-1);this.LN.Qhd(b,new Bj(this.vT,this.YUa));do this.E_=this.Prl(),0!==this.E_.Gp&&a.push(this.vMc(this.E_));while(0!==this.E_.Gp);return a}Msi(){const a=[];if(!this.Xka)return a;this.E_=null;this.LN.Qhd(new Bj(this.vT+this.Xzb,this.Xka),new Bj(this.vT+this.YUa,this.Xka));do this.E_=this.hAh(),0!==this.E_.Gp&&a.push(this.vMc(this.E_));while(0!==this.E_.Gp);return a}vMc(a){if(!a)return null;const b=new ww;b.chngTyp=a.Gp;switch(a.Gp){case 3:b.charFrmtChng=
Object.assign(new yw,{txtrng:this.rka,charPrp:this.Lge});break;case 2:b.paraFrmtChng=Object.assign(new rt,{txtrng:this.rka,paraPrp:this.zpe});break;case 4:b.insChar=Pq.XRe(new qt(this.YTa,this.jcb.shapeText.substring(this.rka.cp,this.rka.sG())));break;case 5:b.delChar=Pq.XRe(new qt(this.YTa,""));break;case 6:b.repChar=Pq.XRe(new qt(this.YTa,this.jcb.shapeText.substring(this.rka.cp,this.rka.sG())))}return b}M6c(a){const b=this.Zxb.shapeText,c=this.jcb.shapeText,f=new Bj(0,b.length),l=new Bj(0,c.length);
let x=a?0:b.length-1,G=a?0:c.length-1;for(;f.contains(x)&&l.contains(G)&&b.charAt(x)===c.charAt(G);)x=a?x+1:x-1,G=a?G+1:G-1;return a?x:b.length-x-1}Prl(){do{for(;this.LN.ysl();){var a=this.LN.hWf(),b=this.LN.iWf();if(a&&b){var c=my(a.UGa,b.UGa);this.YTa=Bj.copy(a.Rn);this.rka=Bj.copy(b.Rn);if(c)return this.Lge=c,new Mp(3)}}if(this.LN.H4b()&&(a=this.LN.fWf(),b=this.LN.gWf(),a&&b&&(c=is(a.eGa,b.eGa),this.YTa=Bj.copy(a.Rn),this.rka=Bj.copy(b.Rn),c)))return this.zpe=c,this.LN.LAh(),new Mp(2)}while(this.LN.LAh());
return new Mp(0)}hAh(){do{for(;this.LN.xsl();){var a=this.LN.hWf(),b=this.LN.iWf();if(a&&b){var c=my(a.UGa,b.UGa);this.YTa=Bj.copy(a.Rn);this.rka=Bj.copy(b.Rn);if(c)return this.Lge=c,new Mp(3)}}if(this.LN.A$d()&&(a=this.LN.fWf(),b=this.LN.gWf(),a&&b&&(c=is(a.eGa,b.eGa),this.YTa=Bj.copy(a.Rn),this.rka=Bj.copy(b.Rn),c)))return this.zpe=c,this.LN.KAh(),new Mp(2)}while(this.LN.KAh());return new Mp(0)}static XRe(a){return Object.assign(new jq,{txt:a.text,txtrng:Pq.Gnl(a.textRange)})}static Gnl(a){return Object.assign(new xw,
{cp:a.cp,len:a.len})}}Object(e.a)(Pq,"IncrementalChangeIterator",null,[]);class zw{constructor(){this.rh=this.bh=this.increq=null}}Object(e.a)(zw,"TextLayoutDeltaClientRequestData",null,[]);class js{constructor(){this.tb=null;this.h=this.w=0}}Object(e.a)(js,"TextLayoutFullClientRequest",null,[]);class Aw{constructor(){this.corr=this.id=null;this.h={};this.delta=this.full=null}}Object(e.a)(Aw,"TextLayoutRequest",null,[]);class Vu{constructor(a,b,c,f,l,x){this.Sac=this.El=null;this.p9b=!0;this.kGa=
-1;this.v8j=(new Date).getTime();this.jbb=this.pka=0;this.l8b=-1;this.Qge=5E3;const G=document.createElement("a");G.href=a;G.protocol="http:"===G.protocol?"ws":"wss";this.aCb=G.href;this.R3=b;this.VWb();this.$Mg=c;this.NNg=f;this.U7j=l;this.Qpe=x.Bnl;this.g2c=x.Anl;this.bQg=x.xnl;this.X3c=x.wnl;this.sla=this.bQg;this.oMe()}onMessage(a){if(a&&a.data)if(a.data.startsWith("pong"))this.ADb(a.data);else if(a=JSON.parse(a.data)){a.h||(a.h={});a.h.bEnd=(new Date).getTime().toString();try{this.NNg&&this.NNg(a)}catch(b){Aa.a.J(578828128,
824,50,(this.R3?"Dark Traffic ":"")+"Exception in OnTextLayoutReceived: {0}",b.toString())}if(this.$Mg){const b={Caller:"WebSocketTextLayoutFetcher.OnMessage"};b.Telemetry=a.h;b.Response=a.resp;b.First=this.p9b;this.$Mg(b)}this.p9b=!1}else Aa.a.J(592304271,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnMessage Empty Response")}onClose(a){Aa.a.J(592840414,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnClose {0}",JSON.stringify(a))}onError(a){Aa.a.J(592840412,
820,10,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnError {0}",JSON.stringify(a))}onOpen(){Aa.a.J(592840410,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::OnOpen");this.Rjc();this.ping();this.U7j()}oMe(){this.Sac=()=>{"visible"===window.document.visibilityState?(window.clearTimeout(this.l8b),this.El||(Aa.a.J(587522389,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Reconnecting after visibility regained."),this.Jwa())):this.l8b=
window.setTimeout(()=>{this.El&&(Aa.a.J(587522387,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::PageVisibilityEventHandler Closing due to visibility lost."),this.El.close(),this.El=null,window.clearTimeout(this.kGa))},this.Qge)};window.self.addEventListener("visibilitychange",this.Sac)}VWb(){this.El&&this.El.close();this.El=new WebSocket(this.aCb,[]);this.El.onopen=Object(C.a)(this,this.onOpen,"onOpen");this.El.onerror=Object(C.a)(this,this.onError,"onError");this.El.onclose=Object(C.a)(this,
this.onClose,"onClose");this.El.onmessage=Object(C.a)(this,this.onMessage,"onMessage")}Rjc(){this.pka=0}zJd(){0<this.X3c&&(new Date).getTime()-this.jbb>this.X3c&&(this.Rjc(),Aa.a.J(587337758,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server after long pause."))}sNd(){return(new Date).getTime()-this.jbb>this.sla&&this.pka<this.g2c&&(!this.El||3===this.El.readyState||2===this.El.readyState)}sLe(){this.jbb=(new Date).getTime();this.sla=Math.pow(2,this.pka)*this.bQg;
0<this.X3c&&(this.sla=Math.min(this.sla,this.X3c));window.setTimeout(()=>{this.Jwa()},this.sla)}Jwa(){this.zJd();this.sNd()&&(this.VWb(),this.sLe(),this.pka++,Aa.a.J(588071072,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Retry connect to server."),this.pka===this.g2c&&Aa.a.J(588071070,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Max retries reached."))}fetch(a){this.El?(Aa.a.J(587804674,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch. WebSocket state {0}",
lp[this.El.readyState]),1===this.El.readyState?this.El.send(Yd.c(a)):this.Jwa()):Aa.a.J(587522383,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Fetch Websocket is unavailable.")}ping(){this.El?1===this.El.readyState?this.El.send("ping"+((new Date).getTime()-this.v8j).toString()):(Aa.a.J(588294232,820,10,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping. Wrong WebSocket state {0}",this.El.readyState),this.Jwa()):Aa.a.J(587522380,820,50,(this.R3?"Dark Traffic ":"")+"WebSocketTextLayoutFetcher::Ping Websocket is unavailable.")}ADb(){-1!==
this.kGa&&window.clearTimeout(this.kGa);this.kGa=window.setTimeout(()=>{this.ping()},this.Qpe)}}Object(e.a)(Vu,"WebSocketTextLayoutFetcher",null,[1264]);class tr{constructor(a,b,c,f,l,x,G){this.tBb=this.Acb=this.IIg=this.HIg=null;this.nextId=1;this.Xge=-1;this.Wge=0;this.ske=!0;if(!a)throw Error.argumentNull("shapeReader");if(!b)throw Error.argumentNull("topologyManager");if(!c)throw Error.argumentNull("clientRequestManager");if(!f)throw Error.argumentNull("walls");if(!l)throw Error.argumentNull("appSettings");
if(!x)throw Error.argumentNull("shapeViewLineBreakTelemetry");this.Ea=a;this.$p=b;this.Zda=f;this.la=l;this.TT=-1;x.execute(R=>{this.Acb=R});this.la.Dnl&&(this.HIg=new Vu(this.la.znl,!1,Object(C.a)(this,this.tZj,"logOnResponseReceived"),Object(C.a)(this,this.vrk,"onTextLayoutReceived"),Object(C.a)(this,this.IZg,"onConnectionOpen"),this.la),this.la.g8g&&(this.IIg=new Vu(this.la.ynl,!0,Object(C.a)(this,this.sZj,"logOnDarkTrafficResponseReceived"),null,Object(C.a)(this,this.IZg,"onConnectionOpen"),this.la)));
this.Ida=G}NL(a,b,c){Aa.a.J(512495621,820,50,"TextLayoutManager::OnTimeout - Fallback to HTML Text Layout for this shape ");if(-1!==this.TT){window.clearTimeout(this.TT);this.TT=-1;var f=this.$p.presentation;f?(a=Object(ua.a)(120,f.$B(Oe.a.tE(a,b))))?(c=a.DS(c))?c.Wib(!1):Aa.a.J(512495618,820,50,"TextLayoutManager::OnTimeout, IShapeNode is null"):Aa.a.J(512495619,820,50,"TextLayoutManager::OnTimeout, ISlide is null"):Aa.a.J(512495620,820,50,"TextLayoutManager::OnTimeout, IPageManifestNode is null")}}rZj(){this.Wge++;
-1===this.Xge&&(this.Xge=window.setTimeout(Object(C.a)(this,this.Jkk,"onCoauthLogTimer"),3E5))}Jkk(){this.Xge=-1;Aa.a.J(512495617,820,50,"TextLayoutManager::LogOnCoAuth, CoAuthRequestCount {0}",this.Wge);this.Wge=0}Ifg(a){let b="";a.kJ(c=>{(c=Object(ua.a)(se.AParagraphNode,c))&&(b+=yb.ParagraphReader.text(c)+"\n")});return b.substr(0,b.length-1)}Osi(a){try{var b=Object,c=b.assign,f=new zw,l=this.tBb;const wa=[];var x,G=l.iLb.bodyPrField,R=a.iLb.bodyPrField;let Wa=!1;G.anchorField!==R.anchorField&&
(Wa=!0);G.bInsField!==R.bInsField&&(Wa=!0);G.tInsField!==R.tInsField&&(Wa=!0);G.lInsField!==R.lInsField&&(Wa=!0);G.rInsField!==R.rInsField&&(Wa=!0);G.horzOverflowField!==R.horzOverflowField&&(Wa=!0);G.vertOverflowField!==R.vertOverflowField&&(Wa=!0);Yd.c(G.normAutofitField)!==Yd.c(R.normAutofitField)&&(Wa=!0);Yd.c(G.spAutoFitField)!==Yd.c(R.spAutoFitField)&&(Wa=!0);G.rotField!==R.rotField&&(Wa=!0);G.spcFirstLastParaField!==R.spcFirstLastParaField&&(Wa=!0);G.wrapField!==R.wrapField&&(Wa=!0);(x=Wa?
R:null)&&wa.push(Object.assign(new ww,{chngTyp:1,bodyPrChng:x}));const mb=new Pq(l,a);var fa=wa.concat.apply(wa,mb.Nsi());const Kb=c.call(b,f,{increq:fa});Aa.a.J(512495616,820,50,"TextLayoutManager::FetchLineBreakInfo Incremental request size {0}",Yd.c(Kb).length);return Kb}catch(wa){Aa.a.J(512493795,820,10,"TextLayoutManager::Generate Incremental Requests Exception {0}",wa.message)}return null}$Wd(a,b){if(this.la.Zxh&&a)if(b&&Aa.a.J(512493794,820,50,"TextLayoutManager::FetchLineBreakInfo, TextLayout- First request for this shape sent on Begin Edit."),
this.Zda.Kki())if(0!==this.Zda.Wni(a,this.Ea))a.Wib(!1);else{if(!a.Tyb)if(b)a.Wib(this.la.CJb);else return;if(!a.fC&&a.kca().length&&(a.SJa||4===a.cS))try{const c=this.u4d(a),f=Object.assign(new Aw,{id:this.nextId.toString(),corr:zh.a.create().toString()});if(this.la.Cnl)if(!this.tBb||b||this.ske)this.tBb=new hs(this.Ifg(a),c),this.ske=!1;else{const x=this.Ifg(a),G=new hs(x,c),R=ot.a.Msb(Yd.c(this.tBb.iLb));f.delta=this.Osi(G);f.delta&&(f.delta.bh=R,f.delta.rh=ot.a.Msb(Yd.c(G.iLb)));if(f.delta&&!f.delta.increq.length)if(this.la.WRe)f.delta=
null;else return;if(f.delta&&f.delta.increq.length)for(const fa of f.delta.increq)if(fa.repChar){fa.repChar.txtrng.len===this.tBb.shapeText.length&&(f.delta=null);break}this.tBb=G}f.delta&&f.delta.increq.length&&!this.la.WRe||(f.full=Object.assign(new js,{tb:c,w:a.SJa?a.SJa.Right:a.get_widthPersisted(),h:a.SJa?a.SJa.Bottom:a.get_heightPersisted()}));this.nextId+=1;-1!==this.TT&&window.clearTimeout(this.TT);this.TT=window.setTimeout(()=>{this.NL(a.slideId.sid,a.slideId.cid,a.get_shapeId())},this.la.Enl);
f.h={["bStart"]:(new Date).getTime().toString()};f.h.shapeId=a.get_shapeId();f.h.sid=a.slideId.sid;f.h.cid=a.slideId.cid;f.h.timeoutId=this.TT;f.h.reqHash=ot.a.Msb(Yd.c(c));f.h.reqSz=Yd.c(f).length;f.h.firstRequest=b;f.h.deltaCompare=this.la.WRe;const l=a.Phj();b&&l&&(f.h.initialTextLayout=l.toString());this.HIg.fetch(f);this.la.g8g&&this.IIg.fetch(f)}catch(c){Aa.a.J(512493793,820,10,"WebSocketTextLayoutFetcher::FetchLineBreakInfo Exception {0}",c.message)}}else this.rZj(),a.Wib(!1)}YSf(a,b){switch(a.listType){case 16:b.buNoneField=
new jy;b.buCharField=null;b.buAutoNumField=null;break;case 0:b.buNoneField=null;b.buCharField=null;b.buAutoNumField=Object.assign(new tw,{startAtField:a.iA});b.buAutoNumField.typeField=8;break;default:b.buNoneField=null,b.buCharField=new uw,b.buCharField.charField="\u2022",b.buAutoNumField=null,b.buFontField=new Yj,b.buFontField.typefaceField=a.font}}YQa(a){const b=new ei;b.__type=tr.gVj;b.valField=Math.floor(1E5*a);return b}vwi(a){const b=new Oq;var c=new nb.GraphIterator;c.set(a);c.pc(11);c.Rg(11);
a.Tf.Pw(c)?this.YSf(a.Tf.Pw(c),b):this.YSf(Ae.a.AP(16,0),b);c=a.sa(Mb.a.Rl,og.a.leftMargin);const f=a.sa(Mb.a.IX,og.a.rightMargin);b.indentField=we.a.gnd(a.sa(Mb.a.Tn,og.a.indent));b.indentFieldSpecified=!0;b.marLField=we.a.gnd(c);b.marLFieldSpecified=!0;b.marRField=we.a.gnd(f);b.marRFieldSpecified=!0;b.defTabSzField=we.a.gnd(a.sa(Mb.a.hrb,tr.IDc));b.defTabSzFieldSpecified=!0;b.lvlField=a.sa(Mb.a.listLevel,og.a.pDa);b.lvlFieldSpecified=!0;b.algnField=this.unl(a.sa(tb.a.xl,1));b.algnFieldSpecified=
!0;2===this.Ida.YV(a).lineSpacing.Sf&&(b.lnSpcField=new gs,b.lnSpcField.itemField=this.YQa(this.Ida.YV(a).lineSpacing.value));2===this.Ida.YV(a).beforeSpacing.Sf&&(b.spcBefField=new gs,b.spcBefField.itemField=this.YQa(this.Ida.YV(a).beforeSpacing.value));2===this.Ida.YV(a).afterSpacing.Sf&&(b.spcAftField=new gs,b.spcAftField.itemField=this.YQa(this.Ida.YV(a).afterSpacing.value));a=Xb.OutlineElementNavigator.EA(a);a.properties.Sa(tb.a.HX)&&(b.rtlField=a.Xh(tb.a.HX));return b}unl(a){switch(a){case 2:return 1;
case 1:return 0;case 3:return 2;case 4:return 3;default:return 0}}u4d(a){try{const b=Object.assign(new ly,{bodyPrField:new hq,pField:[]});b.bodyPrField.noAutofitField=a.W9?new iy:null;a.Sa(sb.a.Z1)&&(b.bodyPrField.normAutofitField=new fs,b.bodyPrField.normAutofitField.fontScaleField=Math.floor(1E5*a.Z1));a.Sa(sb.a.pqa)&&(b.bodyPrField.normAutofitField||(b.bodyPrField.normAutofitField=new fs),b.bodyPrField.normAutofitField.lnSpcReductionField=Math.floor(1E5*a.pqa));b.bodyPrField.rotField=Math.floor(a.ZRe);
b.bodyPrField.vertField=a.D5;b.bodyPrField.lInsField=Math.floor(Re.a.ECb(a.Eha));b.bodyPrField.tInsField=Math.floor(Re.a.ECb(a.Gha));b.bodyPrField.rInsField=Math.floor(Re.a.ECb(a.Fha));b.bodyPrField.bInsField=Math.floor(Re.a.ECb(a.Dha));b.bodyPrField.anchorField=a.Fna;b.bodyPrField.wrapField=a.VVc?0:1;this.Ea.kJ(a,c=>{if(c=Object(ua.a)(se.AParagraphNode,c)){var f=Object.assign(new vw,{itemsField:[]});f.pPrField=this.vwi(c);for(var l=yb.ParagraphReader.text(c),x=0;x<c.Ra.length;){const R=new ky;R.__type=
"CT_WebRegularTextRun:#Microsoft.Office.Server.Powerpoint.Interface.Edit";var G=c.Ra.ga(x);const fa=G.cp,wa=x<c.Ra.length-1?c.Ra.ga(x+1).cp:yb.ParagraphReader.textLength(c);x++;G.formatting?R.rPrField=this.dhg(G.formatting.cache):(G=hy.c(c.Ra,G.cp).RWc,R.rPrField=G?this.dhg(G.cache):this.Shj(a));R.tField=Ka.a.substring(l,fa,wa);f.itemsField.push(R)}b.pField.push(f)}});return b}catch(b){throw Aa.a.J(512493792,820,50,"WebSocketTextLayoutFetcher::GetWebTextBody Exception {0}",b.message),Error.create("GetWebTextBodyException");
}}dhg(a){const b=new iq;b.bField=a.isBold;b.bFieldSpecified=a.ERa;b.iField=a.isItalic;b.iFieldSpecified=a.b8a;b.uField=a.GD;b.uFieldSpecified=a.Dub;b.strikeFieldSpecified=a.Cub;b.strikeField=a.rF;b.szField=a.fontSize*Nl.a.Jgc*Nl.a.k8a;b.szFieldSpecified=a.ssa;b.baselineFieldSpecified=a.Sa(sb.a.LM);b.baselineField=a.getValue(sb.a.LM);b.capFieldSpecified=a.FRa;b.capField=a.capitalization;if(a.wlg){const c=sa.a.oe(a.language);b.langField=c?c.Bsb:"en-US"}a.Sa(sb.a.latinFont)&&(b.latinField=Object.assign(new Yj,
{typefaceField:a.getValue(sb.a.latinFont)}));a.Sa(sb.a.eastAsianFont)&&(b.eaField=Object.assign(new Yj,{typefaceField:a.getValue(sb.a.eastAsianFont)}));a.Y2&&(b.rawSolidFillField=Object.assign(new Nq.a,{srgbClrField:Object.assign(new Tu.a,{valField:Hb.a.dpb(a.fontColor)})}));a.KRa&&(b.highlightField=Object.assign(new Im.a,{srgbClrField:Object.assign(new Tu.a,{valField:Hb.a.dpb(a.highlight)})}));a.Sa(sb.a.$pb)&&(b.spcField=a.getValue(sb.a.$pb),b.spcFieldSpecified=!0);a.Sa(sb.a.hxb)&&(b.kernField=a.getValue(sb.a.hxb),
b.kernFieldSpecified=!0);return b}Shj(a){const b=new iq;b.bField=a.isBold;b.bFieldSpecified=!0;b.iField=a.isItalic;b.iFieldSpecified=!0;b.uField=a.GD;b.uFieldSpecified=!0;b.strikeFieldSpecified=!0;b.strikeField=a.rF;b.szField=a.H$*Nl.a.Jgc;b.szFieldSpecified=!!b.szField;const c=sa.a.oe(a.QQa());b.langField=c?c.Bsb:"en-US";a.Sa(sb.a.latinFont)&&(b.latinField=Object.assign(new Yj,{typefaceField:a.getValue(sb.a.latinFont)}));a.Sa(sb.a.eastAsianFont)&&(b.eaField=Object.assign(new Yj,{typefaceField:a.getValue(sb.a.eastAsianFont)}));
b.baselineField=a.LM;b.baselineFieldSpecified=!0;return b}tZj(a){if(a){Aa.a.J(512493790,820,50,Fi.c(a));var b=new Map;for(let l in a){var c=l,f=a[l];"First"===c&&b.set(c,f.toString());"Telemetry"===c&&b.set(c,JSON.stringify(f))}vf.Health.instance.recordKpiUsage("TextLayoutServiceResponse",0,"pptotext",b)}else Aa.a.J(512493791,820,50,"response data null")}sZj(a){a?Aa.a.J(512493788,820,50,"Dark Traffic"+Fi.c(a)):Aa.a.J(512493789,820,50,"Dark Traffic response data null")}IZg(){this.ske=!0}M$f(a){var b=
this.$p.presentation;if(!b)throw Error.argumentNull("Presentation is null");const c=this.Lib(a,"cid"),f=this.Lib(a,"sid");a=this.Lib(a,"shapeId");if(!c||!f||!a)return Aa.a.J(512493787,820,50,"GetCurrentShapeNode - slideId or shapeId is not present in Hints"),null;b=Object(ua.a)(120,b.$B(Oe.a.tE(Number.parseInvariant(f),Number.parseInvariant(c))));return b?b.DS(Number.parseInvariant(a)):(Aa.a.J(512493786,820,50,"GetCurrentShapeNode - ISlide is null"),null)}vrk(a){if(!a||!a.l||!a.h)if(a&&7===a.resp&&
a.h)Aa.a.J(512493785,820,50,"OnTextLayoutReceived - State out of sync"),(a=this.M$f(a.h))?this.$Wd(a,!0):Aa.a.J(512493784,820,10,"OnTextLayoutReceived - shapenode null");else{if(Aa.a.J(512493783,820,50,"OnTextLayoutReceived - Response data layout is null"),a&&!a.l){var b=new Map;b.set("CorrelationId",a.corr);4===a.resp?vf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceWorkerFailure",!1,!0,Object.assign(new mk.a,{extendedProperties:b})):(b.set("ResponseCode",a.resp.toString()),
vf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","TextLayoutServiceFailureResponse",!1,!0,Object.assign(new mk.a,{extendedProperties:b})))}}else if(this.la.CJb){b=this.Lib(a.h,"timeoutId");var c=this.Lib(a.h,"firstRequest");if(b&&-1!==this.TT&&this.TT===Number.parseInvariant(b))window.clearTimeout(this.TT),this.TT=-1;else if(!c||!Boolean.parse(c))return;if(b=this.M$f(a.h)){var f=this.Lib(a.h,"initialTextLayout");c&&Boolean.parse(c)?f&&f!==a.l.toString()?(c=new Map,c.set("CorrelationId",
a.corr),c.set("ResponseCode",a.resp.toString()),c.set("InitialTextLayoutValue",f),c.set("ResponseLayout",a.l.toString()),vf.Health.instance.recordKpiFailure("TextLayoutServiceResponse","ResponseMismatchForFirstShapeRequest",!1,!0,Object.assign(new mk.a,{extendedProperties:c})),Aa.a.J(512493781,820,50,"Fallback to HTML Text Layout for this shape - different service response on begin edit."),b.Wib(!1)):b.Wib(!0):(f=this.Lib(a.h,"reqHash"))?(c=this.u4d(b),ot.a.Msb(Yd.c(c))!==f?Aa.a.J(512493779,820,50,
"OnTextLayoutReceived - Response hash doesn't match the current shapetextbody"):(this.Acb&&this.Acb.P5k(f,a.l,b),b.cod(a.l))):Aa.a.J(512493780,820,50,"OnTextLayoutReceived - missing request hash")}else Aa.a.J(512493782,820,50,"OnTextLayoutReceived - IShapeNode is null")}}Lib(a,b){return b in a?a[b].toString():null}}tr.gVj="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";tr.IDc=1440;Object(e.a)(tr,"TextLayoutManager",null,[1180]);var Tl;(function(a){a[a.noWall=0]="noWall";
a[a.coauth=1]="coauth";a[a.lineBreakBlobs=2]="lineBreakBlobs";a[a.table=3]="table";a[a.smartArt=4]="smartArt";a[a.nonRectShape=5]="nonRectShape"})(Tl||(Tl={}));Object(e.b)("TextLayoutWall",Tl);var Vo=d(850);class Bw{constructor(a,b){this.yoe=new ef.a(0);if(!a)throw Error.argumentNull("coauthManager");if(!b)throw Error.argumentNull("applicationSettings");this.TTa=a;this.Zda=b.byh}C6b(a){switch(a){case 1:return!!this.Zda.COAUTH;case 2:return!!this.Zda.LINEBREAKBLOBS;case 3:return!!this.Zda.TABLE;case 4:return!!this.Zda.SMARTART;
case 5:return!!this.Zda.NONRECTSHAPE}return!1}Kki(){return!this.C6b(1)||this.TTa.rCa}joi(a,b){return a?this.C6b(2)&&Vo.a.S3f(a,b)?2:this.C6b(3)&&a.qd?3:this.C6b(4)&&a.Pf?4:this.C6b(5)&&4!==a.cS?5:0:0}Wni(a,b){b=this.joi(a,b);if(!this.yoe.Jb(a.mKa)||this.yoe.ga(a.mKa)!==b){const c=new Map;c.set("ShapeType",a.get_shapeTypeString());c.set("ShapeId",a.mKa.toString());c.set("IsShapeWalled",Tl[b]);vf.Health.instance.recordKpiUsage("TextLayoutServiceBlockedShapes",0,"pptotext",c);0!==b&&(c.set("TextLayoutWall",
Tl[b]),vf.Health.instance.recordKpiFailure("TextLayoutServiceBlockedShapes","TextLayoutClientWall",!1,!0,Object.assign(new mk.a,{extendedProperties:c})))}this.yoe.$(a.mKa,b);return b}}Object(e.a)(Bw,"TextLayoutServiceWalls",null,[1179]);class Wu{constructor(a,b,c,f){this.eq=a;this.Ne=b.Ma;this.RN=c;this.V4j=f}initialize(){this.eq.GNa(Object(C.a)(this,this.fGf,"adjustShapeViews"))}dispose(){this.eq.QFb(Object(C.a)(this,this.fGf,"adjustShapeViews"))}fGf(a,b){if((a=b.RF)&&a.Ed&&(a=a.Ed.Q2(c=>c.isEditable&&
c.jQ))&&a.length)for(const c of a)if(a=Object(ua.a)(121,c.sg(this.Ne)))a.CEh(),c.qd&&a.Kn&&a.uyl(),!this.V4j||this.RN&&!b.HVc||a.BN||!a.LA||a.xwh()}}Object(e.a)(Wu,"TextLocalRenderAdjustManager",null,[106]);class Xu{constructor(){this.Occ=this.CAb=null;this.tGg=-1;this.x8b=Date.now()}Ykg(){return 0<=this.tGg}}Object(e.a)(Xu,"LineBreakComparison",null,[]);class Cw{constructor(a){this.UG=new ef.a;this.nMg=0;this.YLf="TextLayoutServiceAccuracy";this.ySg=a}O5k(a,b){try{if(a&&b){var c=a.AD(),f=ot.a.Msb(Yd.c(b.u4d(a)));
if(!(0>c.length)){b=[];for(let l=0;l<c.length;l++){const x=Kj.a.xi(c[l],sb.a.BJb,null);x&&(b.push.apply(b,x.Lines),b.push(-1))}if(b.length){if(!this.UG.Jb(f))this.UG.add(f,new Xu);else if(this.UG.ga(f).Ykg())return;this.UG.ga(f).CAb=b;this.LRf(f,a)}}}}catch(l){Aa.a.J(512493704,820,10,l.message)}}P5k(a,b,c){try{if(!this.UG.Jb(a))this.UG.add(a,new Xu);else if(this.UG.ga(a).Ykg())return;this.UG.ga(a).Occ=b;this.LRf(a,c)}catch(f){Aa.a.J(512493703,820,10,f.message)}}LRf(a,b){if(this.UG.ga(a)&&this.UG.ga(a).CAb&&
this.UG.ga(a).Occ){var c=!0;if(this.UG.ga(a).CAb.length!==this.UG.ga(a).Occ.length)c=!1;else for(var f=0;f<this.UG.ga(a).CAb.length;f++)if(this.UG.ga(a).CAb[f]!==this.UG.ga(a).Occ[f]){c=!1;break}Aa.a.J(512493702,820,50,JSON.stringify({["UniFiedResponseMatchWithLayoutServiceResponse"]:c}));f=new Map;f.set("UniFiedResponseMatchWithLayoutServiceResponse",String.format("{0}",c));b=0<=b.kca().indexOf("\u00a0");f.set("HasNoBreakSpace",b.toString());vf.Health.instance.recordKpiUsage(this.YLf,0,"pptotext",
f);c||(f.set("UnifiedResponseLineCount",this.UG.ga(a).CAb.length.toString()),f.set("TextLayoutResponseLineCount",this.UG.ga(a).Occ.length.toString()),vf.Health.instance.recordKpiFailure(this.YLf,"TextLayoutServiceResponseMismatchWithUnifiedResponse",!1,!0,Object.assign(new mk.a,{extendedProperties:f})));this.UG.ga(a).tGg=Date.now()}this.woi()}woi(){const a=Date.now();a-this.nMg<this.ySg||(this.UG.keys.forEach(b=>{a-this.UG.get(b).x8b>this.ySg&&this.UG.remove(b);return!0}),this.nMg=a)}}Object(e.a)(Cw,
"ServiceComparisonLineBreakTelemetry",null,[1181]);class Yu{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TextEditing"}Wb(a){this.K=a;this.K.register(nt,"PowerPointWebEditor.TextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoTracker").as("PowerPointWebEditor.ITextEditingRevisionInfoReader").ma().na(()=>new nt(!a.resolve("Common.IAppSettingsManager").ka("DataSyncUseFluid")));this.K.register(mt,"PowerPointWebEditor.ShapeViewElementTextEditHandler").ma().na(()=>
new mt(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.Ka("PowerpointPresence.ICoauthStateChangesHandler"),a.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),a.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),a.resolve("Box4.IEditingView"),a.resolve("PowerPointWebEditor.IApplicationSettings").skipProofingSaveWithNoEditHappened,
a.Ka("PowerPointWebEditor.ISessionLifetimeManager")));this.K.register(Wu,"PowerPointWebEditor.TextLocalRenderAdjustManager").ma().na(()=>new Wu(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptLayoutThrashingFixEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").Mug));const b=a.resolve("PowerPointWebEditor.IApplicationSettings").Zxh;Aa.a.J(590444175,820,50,"PPTWebEditorTextEditingPackage::Configure TextLayoutEnabled:{0}",
b);b&&(this.K.register(1179,"PowerPointWebEditor.ITextLayoutServiceWallManager").ma().na(()=>new Bw(a.resolve("PowerPointWebEditor.CoauthManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"))),this.K.register(1180,"PowerPointWebEditor.ITextLayoutManager").ma().na(()=>{try{return new tr(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),u.AFrameworkApplication.Ge,a.resolve("PowerPointWebEditor.ITextLayoutServiceWallManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.Ka("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"))}catch(c){return Aa.a.J(593892503,820,10,"PPTWebEditorTextEditingPackage::Configure Exception creating TextLayoutManager: "+c),null}}),this.K.resolve("PowerPointWebEditor.ITextLayoutManager"),this.K.register(1181,"PowerPointWebEditor.ITextLayoutLineBreakTelemetry").ma().na(()=>new Cw(this.K.resolve("PowerPointWebEditor.IApplicationSettings").vnl)),this.K.resolve("PowerPointWebEditor.ITextLayoutLineBreakTelemetry"))}init(){this.K.resolve("PowerPointWebEditor.ITextEditingRevisionInfoTracker");
this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler");this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").initialize()}dispose(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.resolve("PowerPointWebEditor.ShapeViewElementTextEditHandler").dispose();a.Mug&&this.K.resolve("PowerPointWebEditor.TextLocalRenderAdjustManager").dispose()}static main(){m.a.instance.Bc(new Yu)}}Object(e.a)(Yu,"PPTWebEditorTextEditingPackage",null,[2,3]);class Zu{constructor(){this.capabilities=
2}}Object(e.a)(Zu,"IExternalPeopleAPI",null,[]);class Dw{constructor(a,b){this.OperationResult=a;this.Details=b}}Object(e.a)(Dw,"ExternalGrantAccessResponse",null,[]);class st{constructor(a,b,c,f){this.authorImageURL=this.authorColor=this.authorID=this.authorName=null;this.authorName=a;this.authorID=b;this.authorColor=c;this.authorImageURL=f}}Object(e.a)(st,"PersonaIconProperties",null,[]);var $u=d(903),Qq=d(654),Ew=d(520);class Fw extends Zu{constructor(a,b,c,f,l){super();this.iV=a;this.qUh=b;this.U5e=
c;this.lJh=l}x4g(a){this.iV.Vwa=a}atMentionsEnabledAsync(){return new Promise((a,b)=>{this.iV.Htg.continueWith(c=>{c.Jn||c.hm?(Z.ULS.sendTraceTag(39068098,380,10,"AtMentionsEnabledAsync failed"),b(Qq.a.mu(-2130915318))):a(this.iV.Htg.result)})})}checkUserAccess(a){return new Promise((b,c)=>{const f=this.iV.checkUserAccess([a]);f.continueWith(l=>{l.Jn||l.hm?(Z.ULS.sendTraceTag(36287067,380,10,"PeopleManager CheckUserAccess Failed"),c(Qq.a.mu(-2130915318))):b(f.result.Result[0])})})}grantUsersAccess(a){Z.ULS.sendTraceTag(37582727,
380,15,"PeopleManager CheckUserAccessAndGrantPermissions usage");return new Promise((b,c)=>{const f=this.iV.RAa(a);f.continueWith(l=>{if(l.Jn||l.hm)Z.ULS.sendTraceTag(36287068,380,10,"PeopleManager CheckUserAccessAndGrantPermissions Failed"),c(Qq.a.mu(-2130915318));else{l=f.result;var x=!l.Canceled;for(var G of l.Result)if(!G.UserCanWrite&&!G.UserCanReview){x=!1;break}G=new Dw(x,l);b(G)}})})}getContactsForMentions(a,b,c){return new Promise((f,l)=>{const x=this.iV.getUserContacts(a,b,0,c,"AtMentions");
x.continueWith(G=>{G.Jn||G.hm?(Z.ULS.sendTraceTag(36287069,380,10,"PeopleManager GetUserContacts Failed"),l(Qq.a.mu(-2130915318))):f(x.result)})})}getAuthToken(){Z.ULS.sendTraceTag(539100293,380,15,"PeopleManager GetAuthToken usage");return new Promise((a,b)=>{this.U5e.continueWith(c=>{c.Jn||c.hm?(Z.ULS.sendTraceTag(51658781,380,10,"getLokiTokenManagerTask Failed"),b(Qq.a.mu(-2130915318))):this.U5e.result.Z8i().then(f=>{f.isSuccess&&f.token&&0<f.token.length?(Z.ULS.sendTraceTag(539100294,380,15,"PeopleManager GetAuthToken use AAD token"),
a(f.token)):u.AFrameworkApplication.fa.Ga("LokiUserDataSignature")?(Z.ULS.sendTraceTag(539100295,380,15,"PeopleManager GetAuthToken trying alternateauth token"),this.lJh.execute(l=>{l.b_i().then(x=>{void 0!==x&&null!==x&&0<x.length?(Z.ULS.sendTraceTag(544556298,380,15,"Using LokiUserDataSignature from AlternateAuthHelper"),a(x)):0<u.AFrameworkApplication.fa.Ga("LokiUserDataSignature").length&&(Z.ULS.sendTraceTag(544556299,380,15,"Using boot LokiUserDataSignature since fail to get one from AlternateAuthHelper"),
a(u.AFrameworkApplication.fa.Ga("LokiUserDataSignature")))})})):f.isSuccess?f.token&&f.token.length||(Z.ULS.sendTraceTag(51658783,380,10,"Token is null: {0}",JSON.stringify(f)),b(Qq.a.mu(-2130915318))):(Z.ULS.sendTraceTag(51658782,380,10,"GetLokiToken Failed : {0}",JSON.stringify(f)),b(Qq.a.mu(-2130915318)))}).catch(f=>{Z.ULS.sendTraceTag(51658784,380,10,"Unexpected exception received from lokiTokenManager: {0}",JSON.stringify(f));b(Qq.a.mu(-2130915318))})})})}getPersonaIconPropertiesArray(a){return new Promise(b=>
{const c=[];for(const l of a){let x=null;var f=l;let G=l.Email;G&&""!==G||!l.UserId||""===l.UserId||"AD"!==l.Provider||(G=Ew.a.Z5a(l.UserId));G&&""!==G&&(x=this.iV.UXb(G,l.Provider,u.AFrameworkApplication.hh,0),f=new $u.a(G,void 0,l.DisplayName));f=this.qUh.$Ca(f,2);Array.add(c,new st(l.DisplayName,l.UserId,f,x))}b(c)})}}Object(e.a)(Fw,"ExternalPeopleAPI",Zu,[]);class av{constructor(){this.d3a={};this.Ikb={};this.Gzd={}}get(a){let b=null;const c=this.normalize(a.DisplayName);a.UserId&&a.UserId in
this.d3a?(b=this.d3a[a.UserId],!c||c in this.Ikb||(this.Ikb[c]=b)):c&&c in this.Ikb&&(b=this.Ikb[c],a.UserId&&(c in this.Gzd?(delete this.Gzd[c],this.d3a[a.UserId]=b):a.UserId in this.d3a||(b=null)));return b}add(a,b){a.UserId&&(this.d3a[a.UserId]=b);const c=this.normalize(a.DisplayName);!c||c in this.Ikb||(this.Ikb[c]=b,a.UserId||(this.Gzd[c]=!0))}m1i(a){a=Array(a.pFc.length);for(var b=0;b<a.length;b++)a[b]=0;for(const c of ta.a.JK(this.d3a))b=this.d3a[c],b.sources.contains(1)&&a[b.XQf]++;return a}normalize(a){return a?
a.toLowerCase():null}}Object(e.a)(av,"ColorLookupDict",null,[]);class Gw{constructor(a,b){this.XQf=a;this.sources=new Ha.a;this.sources.add(b)}N3h(a){this.sources.contains(a)||this.sources.add(a)}}Object(e.a)(Gw,"ColorSource",null,[]);class bv{constructor(a){this.pMb=a;this.uGd=new av;this.gef=-1;this.uJh=0}$Ca(a,b,c=!0){if(!this.pMb||!this.pMb.pFc.length)return Z.ULS.sendTraceTag(37053532,380,10,"Color table is null or empty"),null;if(a.IsAnonymous)a.UserId=a.ClientId||a.UserId||this.bYi();else if(!a.UserId&&
!a.DisplayName)return Z.ULS.sendTraceTag(37009498,380,100,"GetUserColor: Both userId and displayName are null"),null;const f=this.uGd.get(a);if(f)c=f.XQf,f.N3h(b);else{if(!c)return null;c=this.t$i();this.uGd.add(a,new Gw(c,b));this.gef=c}return this.s1i(this.pMb.pFc[c])}t$i(){const a=this.pMb.pFc.length,b=this.uGd.m1i(this.pMb),c=this.Wng(this.gef,a);let f=c,l=!1;for(;f!==c||!l;)if(b[f])(f=this.Wng(f,a))||(l=!0);else break;l&&Z.ULS.sendTraceTag(37009497,380,50,"GetNextColorIndex: relooped the color table.");
return f}Wng(a,b){return(a+1)%b}bYi(){return"anonymous"+ ++this.uJh}s1i(a){return 16777215>=a?"#"+Ka.a.Sv((a&255)<<16|a&65280|(a&16711680)>>>16,6):null}}Object(e.a)(bv,"PeopleColorUtils",null,[1279]);class tt{constructor(a,b,c,f,l,x){this.Itg=new ti.a;this.lpa=a;this.c3a=b;this.UAf=f;this.eb=c;this.Pfa=l;this.YAf=x;this.eb.ff(()=>{this.fullAppSettingsReady()})}fullAppSettingsReady(){const a=u.AFrameworkApplication.$ib||u.AFrameworkApplication.mQ,b=this.eb.ka("PeopleEndPointIsEnabled");let c=b&&!a&&
(this.hgc||this.dJb&&this.eJb);const f=this.eb.ka("DisableAtmentionsForTeams"),l=this.eb.ka("ConsumerMentionsHostIsEnabled")||this.UAf.ewh;c=c&&l&&this.cwh&&this.bwh&&!f;this.eb.ka("ConsumerMentionsHostIsEnabled")&&(c=c&&this.eb.ka("OneDriveConsumerMentionsIsEnabled"));Z.ULS.sendTraceTag(37083014,380,50,"isAtMentionsEnabled:{0}, PeopleEndPointIsEnabled:{1}, PermissionsPostMessage:{2}, SupportsCheckUserAccess:{3}, SupportsGrantUserAccess:{4}, SupportsAddActivities:{5}, IsAnonymousUser:{6}, SupportsActivitiesNotification:{7}",
c,b,this.hgc,this.dJb,this.eJb,this.cwh,a,this.bwh);this.Itg.Dg(c);c&&this.Pfa&&this.Pfa.gk(4,Object(C.a)(this,this.Qxe,"onInteractiveReady"))}Qxe(){const a=this.eb.Cc("NumberOfContactsToFetchOnBoot",100);0>=a||this.getUserContacts("",a,0,!1,"AtMentions").continueWith(b=>{(b.hm||b.Jn)&&Z.ULS.sendTraceTag(50402056,380,50,"Failed to prefetch contacts on boot")})}get dJb(){return this.c3a.dJb}get Tce(){return this.YAf.Tce}get eJb(){return this.c3a.eJb}get hgc(){return this.c3a.hgc}get cwh(){return this.eb.ka("SupportsAddActivities")}get bwh(){return this.eb.ka("SupportsActivitiesNotification")}RAa(a){return this.c3a.RAa(a)}HXb(a,
b){return this.c3a.HXb(a,b)}get Htg(){return this.Itg.task}get Vwa(){return this.lpa.Vwa}set Vwa(a){this.lpa.Vwa=a}checkUserAccess(a){Z.ULS.sendTraceTag(37083015,380,50,"CheckUserAccess");return this.c3a.checkUserAccess(a)}grantUserAccess(a,b,c,f,l){return this.c3a.grantUserAccess(a,b,c,f,l)}getUserContacts(a,b,c,f,l){return this.UAf.getUserContacts(a,b,c,f,l)}UXb(a,b,c,f){return this.YAf.UXb(a,b,c,f)}supportsExchangeRestApis(){const a=new ti.a,b=this.lpa.supportsExchangeRestApis();b.continueWith(()=>
{b.hm||b.Jn?a.Dg(!1):a.Dg(!0)});return a.task}}Object(e.a)(tt,"PeopleManager",null,[1278,1263]);var Np=d(370);class ks{}Object(e.a)(ks,"CheckUserAccessRequestItem",null,[]);class cv extends Np.a{constructor(a,b,c){super(a,b);this.Users=null;this.Users=this.QQd(c)}QQd(a){const b=[];for(const c of a)Array.add(b,Object.assign(new ks,{Id:c.UserId,Provider:c.Provider}));return b}Ok(){return 1}}Object(e.a)(cv,"CheckUserAccessRequest",Np.a,[]);class Hw extends Np.a{constructor(a,b,c,f,l,x,G){super(a,b);
this.Filter=null;this.Skip=this.Limit=0;this.SearchGal=!1;this.Scenario=null;this.Filter=c;this.Limit=f;this.SearchGal=x;this.Skip=l;this.Scenario=G}Ok(){return 2}}Object(e.a)(Hw,"GetUserContactsRequest",Np.a,[]);class Rq extends Np.a{constructor(a,b,c,f,l,x,G){super(a,b);this.Scenario=this.Users=null;this.GrantReviewAccess=this.GrantWriteAccess=this.GrantReadAccess=!1;this.Users=this.QQd(c);this.Scenario=f;this.GrantReadAccess=l;this.GrantWriteAccess=x;this.GrantReviewAccess=G}QQd(a){const b=[];
for(const c of a)Array.add(b,Object.assign(new ks,{Id:c.UserId,Provider:c.Provider}));return b}Ok(){return 4}}Object(e.a)(Rq,"GrantUserAccessRequest",Np.a,[]);class oy extends Np.a{constructor(a,b){super(a,b)}Ok(){return 5}}Object(e.a)(oy,"SupportsExchangeRestApisRequest",Np.a,[]);var Op=d(519);class ut{constructor(a,b,c,f){this.Vwa=null;this.NVh=a;this.I_a=b;this.eb=c;this.T_a=f}get hVk(){return this.eb.Cc("GetUserContactsRequestSentTimeoutMs",6E4)}checkUserAccess(a){if(!a||!a.length)return Z.ULS.sendTraceTag(37757202,
380,15,"no user in the request"),a=new ti.a,a.setException(Error.argumentNull("Can't pass empty list to checkUserAccess calls")),a.task;Z.ULS.sendTraceTag(37757203,380,50,"CheckUserAccess: num people:{0}",a.length);const b=new ti.a,c=this.T_a.execute(new cv(this.I_a(),null,a),(f,l,x)=>this.BIc(f,l,x,"CheckUserAccess"),this.Vwa);c.continueWith(()=>{if(c.Jn||c.hm)b.UF(c.Wi);else{var f=this.Vvk(c.result.Ui);b.Dg(f)}});return b.task}grantUserAccess(a,b,c,f,l){if(!a||!a.length)return Z.ULS.sendTraceTag(37757204,
380,15,"no user in the request"),a=new ti.a,a.Dg(null),a.task;Z.ULS.sendTraceTag(37757205,380,15,"GrantUserAccess: num people:{0}, scenario:{1}, read:{2}, write:{3}, review:{4}",a.length,b,c,f,l);const x=new ti.a,G=this.T_a.execute(new Rq(this.I_a(),null,a,b,c,f,l),(R,fa,wa)=>this.BIc(R,fa,wa,"GrantUserAccess"),this.Vwa);G.continueWith(()=>{if(G.Jn||G.hm)Z.ULS.sendTraceTag(37028121,380,15,"GetUserAccess: request failed: {0}",G.Wi),x.UF(G.Wi);else{var R=this.yvk(G.result.Ui);x.Dg(R)}});return x.task}Vvk(a){if(!a.data)return Z.ULS.sendTraceTag(24749450,
380,10,"CheckUserAccessResponse: Data is null"),null;if(!a.data.Sd)return Z.ULS.sendTraceTag(24749451,380,10,"CheckUserAccessResponse: ResponseData is null"),null;a=Op.a.o5a(a.data.Sd);return a?a.Result?a.Result:(Z.ULS.sendTraceTag(24749453,380,10,"CheckUserAccessResponse: Result field is null."),null):(Z.ULS.sendTraceTag(24749452,380,10,"CheckUserAccessResponse: Failed parsing the response"),null)}yvk(a){if(!a.data)return Z.ULS.sendTraceTag(33645598,380,10,"GrantUserAccessResponse: Data is null"),
null;if(!a.data.Sd)return Z.ULS.sendTraceTag(33645599,380,10,"GrantUserAccessResponse: ResponseData is null"),null;a=Op.a.o5a(a.data.Sd);return a?a.Result?a.Result:(Z.ULS.sendTraceTag(33645601,380,10,"GrantUserAccessResponse: Result field is null."),null):(Z.ULS.sendTraceTag(33645600,380,10,"GrantUserAccessResponse: Failed parsing the response"),null)}getUserContacts(a,b,c,f,l){const x=new ti.a,G=this.T_a.execute(new Hw(this.I_a(),null,a,b,c,f,l),(R,fa,wa)=>this.BIc(R,fa,wa,"GetUserContacts"),this.Vwa);
G.continueWith(()=>{if(G.Jn||G.hm)x.UF(G.Wi);else{var R=G.result;try{const fa=this.Uvk(R.Ui);x.Dg(fa.Result)}catch(fa){x.UF(fa)}}});return x.task}Uvk(a){if(!a.data)throw Error.create("ParseUserContactsFromResponse: Data is null");if(!a.data.Sd)throw Error.create("ParseUserContactsFromResponse: ResponseData is null");a=Op.a.o5a(a.data.Sd);if(!a)throw Error.create("ParseUserContactsFromResponse: Failed parsing the response");if(!a.Result)throw Error.create("ParseUserContactsFromResponse: Result field is null.");
return a}supportsExchangeRestApis(){const a=new ti.a,b=this.T_a.execute(new oy(this.I_a(),null),(c,f,l)=>this.BIc(c,f,l,"SupportsExchangeRestApisRequest"),this.Vwa);b.continueWith(()=>{b.Jn||b.hm?(a.UF(b.Wi),Z.ULS.sendTraceTag(50657307,380,50,"SupportsExchangeRestApis: false")):(Z.ULS.sendTraceTag(50657308,380,50,"SupportsExchangeRestApis: true"),a.jM(!0))});return a.task}BIc(a,b,c,f){return this.NVh.Xnb(a,2,c,b,2,f,null,!1,null,this.hVk)}}Object(e.a)(ut,"PeopleRequestHandler",null,[1272]);class ur{constructor(a,
b){this.iV=a;this.Ca=b;this.Ca.ya(F.a.coi,xd.a.frame,Object(C.a)(this,this.Yni,"checkUserAccessAction"));this.Ca.ya(F.a.ejj,xd.a.frame,Object(C.a)(this,this.djj,"getUserContactsAction"));this.Ca.ya(F.a.boi,xd.a.frame,Object(C.a)(this,this.$ni,"checkUserAccessAndGrantPermissionsAction"));this.Ca.ya(F.a.ijj,xd.a.frame,Object(C.a)(this,this.hjj,"getUserProfilePictureAction"));this.Ca.ya(F.a.Bkl,xd.a.frame,Object(C.a)(this,this.Ckl,"supportsExchangeRestApisTestAction"))}Ckl(){this.supportsExchangeRestApis();
return 32}Yni(){const a=prompt("Check User Access:Enter user names separated by ;");this.checkUserAccess(a);return 32}djj(){const a=prompt("Get user contacts:filter;limit;skip;searchGal");this.getUserContacts(a);return 32}$ni(){const a=prompt("CheckUserAccessAndGrantPermissions PostMessage: u1;u2;u3");this.RAa(a);return 32}hjj(){const a=prompt("Get user profile picture: userid;provider;dimension (e.g 48, 64, 96)");this.Mhg(a);return 32}qjh(){const a=prompt("What's the operation you want to do:\r\n1) Check User Access \r\n2) Grant user access \r\n3) Check User Access And Grant Permissions \r\n4) GetUserContacts \r\n5) Get User Profile Picture \r\n6) SupportsExchangeRestApis \r\n7) Exit");
try{switch(a){case "1":this.checkUserAccess(prompt("Check User Access: u1;u2;u3"));break;case "2":this.grantUserAccess();break;case "3":this.RAa(prompt("CUAGP: u1;u2;u3"));break;case "4":this.getUserContacts(prompt("Get User Contacts:filter;limit;skip;searchGal"));break;case "5":this.Mhg(prompt("Get User profile picture:userid;provider;dimension;"));break;case "6":this.supportsExchangeRestApis();break;case "7":return}}catch(b){alert(b.message)}kn.Task.delay(5E3).continueWith(()=>{this.qjh()})}tYk(){window.setTimeout(Object(C.a)(this,
this.qjh,"runOperations"),1E4)}supportsExchangeRestApis(){const a=this.iV.supportsExchangeRestApis();a.continueWith(b=>{if(b.hm)alert("Exception: "+b.Wi.message);else{b=a.result;var c=new Di.StandardDialog;c.yd=0;c.Ue(1,"Close");document.createElement("pre").innerText=b.toString();c.nx("SupportsExchangeRestApis check returned",b.toString(),3,null)}})}Mhg(a){a=a.split(";");const b=a[0],c=a[1];a=a[2];let f;try{f=this.b4i(a)}catch(l){alert("Invalid dimension value");return}fb.a.instance.Ka("Common.App.People.IPeopleManager").execute(l=>
{var x=l.UXb(b,c,u.AFrameworkApplication.hh,f);l=document.createElement("img");l.src=x;x=new Di.StandardDialog;x.yd=0;x.Ue(1,"Close");x.nx("Profile photo",null,3,null,l)})}b4i(a){if(!a)return 0;switch(a){case "48":return 1;case "64":return 2;case "96":return 3;case "120":return 4;case "240":return 5;case "360":return 6;case "432":return 7;case "504":return 8;case "default":return 0;default:throw Error.argumentOutOfRange("unknown dimension");}}checkUserAccess(a){a=a.split(";");a=this.iV.HXb(a,"O365");
const b=this.iV.checkUserAccess(a);b.continueWith(c=>{if(c.hm)alert("Exception: "+c.Wi.message);else{var f=b.result;c="";for(var l of f.Result)c+=l.Id+"=>"+(l.UserCanWrite?"Write":"No Write")+"\r\n";l=new Di.StandardDialog;l.yd=0;l.Ue(1,"Close");f=document.createElement("pre");f.innerText=c;l.nx("Check User Access Results",null,3,null,f)}})}grantUserAccess(){var a=prompt("GRANT_USER_ACCESS\n\nEnter semicolon-separated user names.\n\nInclude CantGrant or NotExist in names to return CannnotGrantPermission and UserDoesNotExist on Blue Chicken.\n");
const b=prompt("Enter scenario (mention or share):"),c=prompt("Enter the list of permissions to grant (e.g. Read Write Review).");a=a.split(";");a=this.iV.HXb(a,"O365");const f=0<=c.toUpperCase().indexOf("READ"),l=0<=c.toUpperCase().indexOf("WRITE"),x=0<=c.toUpperCase().indexOf("REVIEW"),G=this.iV.grantUserAccess(a,b,f,l,x);G.continueWith(R=>{if(R.hm)alert("Exception: "+R.Wi.message);else{R=G.result;var fa="RESULTS OF GRANT_USER_ACCESS CALL\n==========================\nScenario: "+b+"\nRequested Permissions: "+
(f?"READ":"")+(l?f?" WRITE":"WRITE":"")+(x?f||l?" REVIEW":"REVIEW":"")+"\n==========================\n\n";for(const wa of R.Result)fa+="User: "+wa.Id+"\nMessage: "+wa.Message+"\nStatus Code: "+wa.Status+"\nProvider: "+wa.Provider+"\n\n";alert(fa)}})}getUserContacts(a){var b=a.split(";");a=0<b.length?b[0]:"";var c=2<b.length?b[2]:"0",f=3<b.length?b[3]:"false";b=Number.parseInvariant(1<b.length?b[1]:"10");c=Number.parseInvariant(c);f=Boolean.parse(f);const l=this.iV.getUserContacts(a,b,c,f,"AtMentions");
l.continueWith(x=>{if(x.hm)alert("Something went wrong"+x.Wi.message);else if(x.Jn)alert("Task was canceled");else{var G=l.result;x="";for(var R of G)G="ID => "+R.Id+" \n",G+="Provider => "+R.Provider+" \n",G+="DisplayName => "+R.DisplayName+" \n",G+="GivenName => "+R.GivenName+" \n",G+="Surname => "+R.Surname+" \n",G+="Email => "+R.Email+" \n",G+="Title => "+R.Title+" \n",x+=G+"----------------------\n";R=new Di.StandardDialog;R.yd=0;R.Ue(1,"Close");G=document.createElement("pre");G.innerText=x;
R.nx("Contacts",null,3,null,G)}})}RAa(a){a=a.split(";");a=this.iV.HXb(a,"O365");const b=this.iV.RAa(a);b.continueWith(c=>{if(c.hm)alert("Exception: "+c.Wi.message);else{c=b.result;var f="";for(var l of c.Result){var x=[];Array.add(x,l.UserCanRead?"Read YES":"Read NO");Array.add(x,l.UserCanReview?"Review YES":"Review NO");Array.add(x,l.UserCanWrite?"Write YES":"Write NO");x=l.Id+"=>"+x.join(" | ");f+=x+"\r\n"}l=new Di.StandardDialog;l.yd=0;l.Ue(1,"Close");c=f+"\r\nDialog Canceled="+c.Canceled;f=document.createElement("pre");
f.innerText=c;l.nx("Check User Access And Grant Permissions Post GrantUserAccessPrompt Results",null,3,null,f)}})}}Object(e.a)(ur,"PeopleTestHook",null,[]);var vt=d(218);class dv{constructor(a,b,c){this.Id=a;this.Persons=b;this.UserPermissionsVerified=c}}Object(e.a)(dv,"ShowSharingUiRequestBody",null,[]);class wt{constructor(a,b){this.A2a=null;this.Vxc=new ti.a;this.jSb=new dv(this.$Ai(),a,b);Z.ULS.sendTraceTag(25036160,380,50,"Creating request with {0} persons and UserPermissionsVerified {1}",this.jSb.Persons?
this.jSb.Persons.length:0,this.jSb.UserPermissionsVerified)}get IWk(){return this.Vxc.task}get id(){return this.jSb.Id}get payload(){return this.jSb}J6k(a){this.A2a=a;this.qBl()?this.Vxc.jM(this.A2a):this.Vxc.UF(Error.format("Format of the "+bf.a.hOd+" body is not valid"))}setException(a){Z.ULS.sendTraceTag(37515586,380,10,"message:{0}",a.message);this.Vxc.UF(a)}$Ai(){return wt.hPh++}rBl(a){if(void 0===a.Id)return Z.ULS.sendTraceTag(25036161,380,10,"Persons.Id field is missing from the postmessage showSharingUiResponse of the host"),
!1;if(void 0===a.Provider)return Z.ULS.sendTraceTag(25036162,380,10,"Persons.Provider field is missing from the postmessage showSharingUiResponse of the host"),!1;void 0===a.Reason&&(Z.ULS.sendTraceTag(25036163,380,50,"Persons.Reason field is missing from the postmessage showSharingUiResponse of the host"),a.Reason=null);return void 0===a.Status?(Z.ULS.sendTraceTag(25036164,380,10,"Person.Status field is undefined"),!1):Ka.a.pwb(a.Status)?!0:(Z.ULS.sendTraceTag(25036165,380,10,"Person.Status field is not a number"),
!1)}qBl(){if(void 0===this.A2a.Persons)return Z.ULS.sendTraceTag(25036166,380,10,"Persons field is missing from the postmessage showSharingUiResponse of the host"),!1;if(!Qa.a.isArray(this.A2a.Persons))return Z.ULS.sendTraceTag(25036167,380,10,"Persons field is not an array"),!1;for(let a=0;a<this.A2a.Persons.length;a++)if(!this.rBl(this.A2a.Persons[a]))return!1;return void 0===this.A2a.DialogCanceled?(Z.ULS.sendTraceTag(25036168,380,10,"DialogCanceled field is missing from the postmessage showSharingUiResponse of the host"),
!1):void 0===this.id?(Z.ULS.sendTraceTag(25036169,380,10,"Id field is undefined"),!1):Ka.a.pwb(this.id)?!0:(Z.ULS.sendTraceTag(25036170,380,10,"ID field is not a number"),!1)}}wt.hPh=0;Object(e.a)(wt,"PostmessageRequestState",null,[]);class ev{constructor(a){this.vCd=new vt.a;this.HOb=this.K0a=null;this.P7e=!1;this.HLa=a}Txj(){Z.ULS.sendTraceTag(25036171,380,50,"ShowSharingUiPostMessageHandler.InitAsync");if(this.HOb)return this.HOb.task;this.HOb=new ti.a;this.HLa.continueWith(()=>{Z.ULS.sendTraceTag(25036172,
380,50,"hostPostMessenger Resolved successfully");this.K0a=this.HLa.result;this.X7d();this.HOb.Dg(!0)});return this.HOb.task}X7d(){this.P7e||(Z.ULS.sendTraceTag(25190624,380,50,"InitHostPostmessenger"),this.P7e=!0,this.K0a.fu(bf.a.hOd),this.K0a.kB(bf.a.hOd,Object(C.a)(this,this.aoi,"checkUserAccessAndGrantPermissionsPostmessageReceived")))}aoi(a){if(a=a.Values)if(void 0===a.Id||null===a.Id)Z.ULS.sendTraceTag(25036176,380,15,"ResponseBodyTask ID is null or undefined",a.Id);else{var b=null;({value:b}=
this.vCd.Rf(a.Id)).returnValue?(Z.ULS.sendTraceTag(25036178,380,50,"Detected ResponseBodyTask for message id {0}",a.Id),b.J6k(a),this.vCd.remove(a.Id)):Z.ULS.sendTraceTag(25036177,380,15,"Response does not match any postmessageRequestState in the queue. ID:{0}",a.Id)}else Z.ULS.sendTraceTag(25036175,380,15,"Postmessage ResponseBodyTask is null")}Zni(a,b){const c=new wt(a,b);this.Txj().continueWith(()=>{const f=zh.a.create().toString(),l=String.format("PostMessageId:{0}, CorrelationId:{1}",c.id,f);
Z.ULS.sendTraceTag(25036179,380,50,l);this.K0a.sendMessage(bf.a.RAa,c.payload,f)||c.setException(Error.create("Failed to send the postmessage"));this.vCd.add(c.id,c)});return c.IWk}}Object(e.a)(ev,"ShowSharingUiPostMessageHandler",null,[]);class fv{}Object(e.a)(fv,"GrantUserAccessResponse",null,[]);var Lh=d(82);class xt extends Sys.EventArgs{constructor(a,b,c,f){super();this.result=b;this.kxk=a;this.QJa=c;this.scenario=f}}Object(e.a)(xt,"ShareAndNotifyEventArgs",Sys.EventArgs,[]);class gv{static Zyi(a){return Lh.a.UB(gv.fo,
CommonUIStrings.l_ShareAndNotifyDialogText,a)}}gv.fo="<span id='ShareAndNotifyDialogText' class='WACDialogSpan'>{0}</span> <br/> <br/> <span id='ShareAndNotifyDialogListOfUsers' class='WACDialogSpan'>{1}</span>";Object(e.a)(gv,"ShareAndNotifyDialogHtml",null,[]);class ls extends Lh.a{constructor(a,b,c){super();this.qLa=!1;this.Pa=new ic.a;this.sUh=a;this.i_h=ls.OWi(a);this.Nv=b;this.UY=c}V7h(a){this.Pa.addHandler("SNEK",a)}zOe(){this.mg=gv.Zyi(this.i_h);this.yd=8;this.ng="ShareAndNotifyDialog";this.showDialog(CommonUIStrings.l_ShareAndNotifyDialogTitle,
Object(C.a)(this,this.Y9k,"shareAndNotifyDialogResultHandler"));this.i5("ShareAndNotifyDialogTextId")}Mva(){}dispose(){this.qLa||(super.dispose(),this.qLa=!0)}Y9k(a){this.Pa.raiseEvent("SNEK",new xt(this.sUh,a,this.Nv,this.UY))}static OWi(a){const b=new Sys.StringBuilder;for(const c of a)b.append(0<c.DisplayName.length?c.DisplayName:c.Id),b.append(", ");return b.toString().substring(0,b.toString().length-2)}}Object(e.a)(ls,"ShareAndNotifyDialog",Lh.a,[]);class rp{constructor(a,b,c){this.Id=a;this.Provider=
b;this.DisplayName=c}}Object(e.a)(rp,"ShowSharingUiRequestPerson",null,[]);class ms{constructor(a,b,c,f,l,x){this.lpa=a;this.eb=b;this.CXh=c;this.oV=f;this.qKh=l;this.Rd=x}get dJb(){return this.eb.ka("SupportsCheckUserAccess")}get eJb(){return this.eb.ka("SupportsGrantUserAccess")}get hgc(){return this.eb.ka("PermissionsPostMessage")&&!this.eb.ka("CrossDocumentMessengerDisabled")&&this.qKh()}RAa(a){const b=new ti.a;if(Qa.a.Va(a))return b.Dg(this.oV.NOa([])),b.task;let c;const f=({GVb:c}=this.oV.kWe(a)).returnValue,
l=ms.wwi(f);0<f.length?this.hgc?this.$dl(f,b,c,l):this.dJb&&this.eJb&&this.zOe(l,b,"mention"):b.Dg(this.oV.NOa(a));return b.task}$dl(a,b,c,f){const l=Date.now();Z.ULS.sendTraceTag(37822867,380,15,"ShowHostSharingUi-Usage");const x=this.CXh.Zni(f,c);c=new xe.a(4,1,this.eb.Cc("GrantPermissionSharingDialogWatchdogInternal",12E4),Object(C.a)(this,this.checkToMakeSureDialogWasOpened,"checkToMakeSureDialogWasOpened"),100);this.Rd.Cb(c);c.customData=x;x.continueWith(G=>{if(G.hm)Z.ULS.sendTraceTag(36300673,
380,15,"CheckUserAccessAndGrantPermissions via PostMessage failed with exception. {0}",G.Wi?G.Wi.message:"No inner exception"),b.UF(G.Wi);else{G=x.result;this.oV.Cvl(G);var R=this.oV.NOa(a);R.Canceled=G.DialogCanceled;b.Dg(R);Z.ULS.sendTraceTag(37791043,380,15,"CheckUserAccessAndGrantPermissions finished in {0}ms",Date.now()-l)}})}checkToMakeSureDialogWasOpened(a){Z.ULS.sendTraceTag(37822868,380,15,"ShowHostSharingUi-WatchDog-Usage");(a=a.customData)?a.Jn?Z.ULS.sendTraceTag(37791045,380,10,"Show Sharing UI task is canceled"):
a.hm?Z.ULS.sendTraceTag(37791046,380,10,"Show Sharing UI task has faulted"):a.isCompleted||Z.ULS.sendTraceTag(37791047,380,10,"We have not got a response from host in long time"):Z.ULS.sendTraceTag(37791044,380,10,"Response of Sharing UI is null")}zOe(a,b,c){a=new ls(a,b,c);a.V7h(Object(C.a)(this,this.Jqk,"onShareAndNotify"));a.zOe()}Jqk(a,b){let c;const f=ms.Awi(b.kxk);switch(b.result){case 1:this.grantUserAccess(f,b.scenario,!0,!0,!0).continueWith(l=>{l.hm?(Z.ULS.sendTraceTag(36300674,380,15,"GrantUserAccess from OnShareAndNotify failed with exception. {0}",
l.Wi?l.Wi.message:"No inner exception"),b.QJa.UF(l.Wi)):(Z.ULS.sendTraceTag(36300675,380,50,"GrantUserAccess from OnShareAndNotify succeeded."),c=this.oV.NOa(f),c.Canceled=!1,b.QJa.Dg(c))});break;default:Z.ULS.sendTraceTag(36300676,380,50,"User cancelled Share and Notify dialog"),c=this.oV.NOa(f),c.Canceled=!0,b.QJa.Dg(c)}}checkUserAccess(a){const b=new ti.a;if(!this.dJb)return Z.ULS.sendTraceTag(36300677,380,15,"Performing a CheckUserAccess call on a host that doesn't support the operation."),b.setException(Error.invalidOperation("CheckUserAccess is not supported on this host")),
b.task;if(!a||!a.length)return b.Dg(this.oV.NOa([])),b.task;let c;const f=({GVb:c}=this.oV.kWe(a)).returnValue;if(c)Z.ULS.sendTraceTag(36300680,380,50,"CheckUserAccess response populated from cache."),b.Dg(this.oV.NOa(a));else{const l=this.lpa.checkUserAccess(f);l.continueWith(()=>{if(l.Jn||l.hm)Z.ULS.sendTraceTag(36300678,380,10,"CheckUserAccess call failed."),b.setException(Error.create("CheckUserAccess Call failed."));else{Z.ULS.sendTraceTag(36300679,380,50,"CheckUserAccess call succeeded.");var x=
l.result;x&&this.oV.Avl(x);x=this.oV.NOa(a);b.Dg(x)}})}return b.task}grantUserAccess(a,b,c,f,l){const x=new ti.a;if(!this.eJb)return Z.ULS.sendTraceTag(36300681,380,15,"Performing a GrantUserAccess call on a host that doesn't support the operation."),x.setException(Error.invalidOperation("GrantUserAccess is not supported on this host")),x.task;if(!a||!a.length)return x.Dg(this.oV.qUf([])),x.task;let G;const R=({GVb:G}=this.oV.kWe(a)).returnValue;if(G)Z.ULS.sendTraceTag(36300684,380,50,"GrantUserAccess response populated from cache."),
x.Dg(this.oV.qUf(a));else{const fa=this.lpa.grantUserAccess(R,b,c,f,l);fa.continueWith(()=>{if(fa.Jn||fa.hm)Z.ULS.sendTraceTag(36300682,380,10,"GrantUserAccess call failed."),x.setException(Error.create("GrantUserAccess Call failed."));else{Z.ULS.sendTraceTag(36300683,380,50,"GrantUserAccess call succeeded.");var wa=fa.result;this.oV.Bvl(wa,c,f,l);wa=Object.assign(new fv,{Result:wa});x.Dg(wa)}})}return x.task}HXb(a,b){const c=[];for(const f of a)c.push(new $u.a(f,b));return c}static wwi(a){const b=
[];for(const c of a)a=new rp(c.UserId,c.Provider,""),b.push(a);return b}static Awi(a){const b=[];for(const c of a)a=new $u.a(c.Id,c.Provider),b.push(a);return b}}Object(e.a)(ms,"UserAccessUtils",null,[1263]);class yt{constructor(a=null){a&&(this.Id=a.Id,this.Provider=a.Provider,this.Email=a.Email,this.DisplayName=a.DisplayName,this.GivenName=a.GivenName,this.Surname=a.Surname,this.Title=a.Title)}}Object(e.a)(yt,"PersonaProperties",null,[]);class zt{constructor(a,b){this.Kvf=[];this.ord=[];this.Wef=
-1;this.eb=a;this.lpa=b}get ewh(){return this.eb.ka("IsContactsResolutionEnabled")}getUserContacts(a,b,c,f,l){Z.ULS.sendTraceTag(37611683,380,15,"GetUserContacts: limit:{0}, searchGal:{1}, scenario:{2}",b,f,l);const x=new Map;x.set("Limit",b.toString());x.set("SearchGal",f.toString());x.set("Scenario",l);vf.Health.instance.recordKpiUsageForAlertableKpi("PeopleEndPointGetUserContactsBrowser","wackpitesting",x);if(!this.ewh)return Z.ULS.sendTraceTag(39145936,380,10,"Trying to get user contacts when hosts doesn't support it"),
vf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","TriedToGetUserContactsWhenHostDoesNotSupportIt",!0,!1,null),a=new ti.a,a.UF(Error.invalidOperation("People operations not supported by this host")),a.task;if(0>=b)return Z.ULS.sendTraceTag(39145937,380,10,"Limit should be > 0"),vf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","LimitShouldBeGreaterThanZero",!1,!0,null),a=new ti.a,a.UF(Error.invalidOperation("Limit should be > 0")),a.task;"Unknown"===
l&&Z.ULS.sendTraceTag(37611712,380,15,"Scenario Name was not specified");if(b<=this.Wef&&!a&&!f)return a=new ti.a,c=this.ord.slice(0,Math.max(b-1,this.ord.length-1)),c=this.UUg(this.Kvf,c),a.Dg(c),a.task;const G=new ti.a;let R;try{R=this.lpa.getUserContacts(a,b,c,f,l)}catch(fa){return G.UF(fa),G.task}if(f||"AtMentions"!==l)return R;R.continueWith(fa=>{if(fa.Jn||fa.hm){fa=fa.Jn?"Canceled":fa.Wi.message;Z.ULS.sendTraceTag(39145938,380,10,"Failed to get contacts from host {0}",fa);var wa=new Map;x.set("ErrorMessage",
fa);wa=Object.assign(new mk.a,{extendedProperties:wa});vf.Health.instance.recordKpiFailure("PeopleEndPointGetUserContactsBrowser","FailedToGetContactsFromHost",!1,!0,wa);G.UF(Error.create(fa))}else this.ord=fa=R.result,this.Wef=b,fa=this.UUg(this.Kvf,fa),G.Dg(fa)});return G.task}UUg(a,b){if(!a&&!b)return[];if(!b)return a;if(!a)return b;const c={};a.forEach(f=>{this.vEf(f,c)});b.forEach(f=>{this.vEf(f,c)});a=[];for(let f in c)Array.add(a,c[f]);return a}vEf(a,b){if(a&&(a=new yt(a),a.Email&&a.DisplayName&&
a.Id&&a.Provider)){const c=b[this.aVf(a)];c&&(a.Surname||(a.Surname=c.Surname),a.GivenName||(a.Surname=c.GivenName),a.Title||(a.Surname=c.Title));b[this.aVf(a)]=a}}aVf(a){return(a.Email+a.Provider).toLocaleLowerCase()}}Object(e.a)(zt,"UserContactsUtils",null,[1262]);class Iw{}Object(e.a)(Iw,"CheckUserAccessResponse",null,[]);class hv{}Object(e.a)(hv,"GrantUserAccessResponseItem",null,[]);class At{}Object(e.a)(At,"UserPermissions",null,[]);class uo{constructor(){this.tM=new Lc.a;this.xQe=0}kWe(a){let b;
const c=[];if(!a)return Z.ULS.sendTraceTag(36299549,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with null people argument."),{returnValue:c,GVb:!1};if(!a.length)return Z.ULS.sendTraceTag(36299550,380,15,"UsersNotInCacheOrInCacheWithNoWriteOrReviewPermissions called with empty IPerson array."),{returnValue:c,GVb:!1};b=!0;const f={};for(const l of a){a=uo.NQd(l);if(a in f)continue;f[a]=!0;const x=({value:a}=this.tM.Rf(uo.NQd(l))).returnValue;x&&(!a||a.UserCanWrite||a.UserCanReview)||
Array.add(c,l);b=b&&x}return{returnValue:c,GVb:b}}Avl(a){if(!a)throw Error.argumentNull("result");for(const b of a){if(void 0===b.Id||null===b.Id||!b.Id.length)throw Error.argument("item.Id");if(void 0===b.Provider||null===b.Provider||!b.Provider.length)throw Error.argument("item.Provider");this.tM.remove(uo.tGc(b));this.tM.add(uo.tGc(b),b)}}Bvl(a,b,c,f){if(!a)throw Error.argumentNull("result");for(const l of a){if(void 0===l.Id||null===l.Id||!l.Id.length)throw Error.argument("item.Id");if(void 0===
l.Provider||null===l.Provider||!l.Provider.length)throw Error.argument("item.Provider");if(0===l.Status){const x=uo.OQd(l.Id,l.Provider);({value:a}=this.tM.Rf(x)).returnValue?(a.UserCanRead=b,a.UserCanWrite=c,a.UserCanReview=f):(a=Object.assign(new At,{Id:l.Id,Provider:l.Provider,UserCanRead:b,UserCanWrite:c,UserCanReview:f}),this.tM.remove(x),this.tM.add(x,a))}}}Cvl(a){if(!a)throw Error.argumentNull("showSharingUiResponse");a=a.Persons;if(!a)throw Error.argumentNull("showSharingUiResponse.Persons");
for(let b=0;b<a.length;b++){const c=new At,f=a[b];if(void 0===f.Id||null===f.Id)throw Error.argument("showSharingUiRepsonePerson.Id");void 0===f.Status||null===f.Status?Z.ULS.sendTraceTag(25036183,380,15,"ShowSharingUiResponsePerson.Status is null or undefined"):(c.UserCanRead=f.Status===this.xQe,c.UserCanWrite=f.Status===this.xQe,c.UserCanReview=f.Status===this.xQe,c.Id=f.Id,c.Provider=f.Provider,this.tM.remove(uo.tGc(c)),this.tM.add(uo.tGc(c),c))}}Lhg(a){const b=[];for(const c of a)a=uo.NQd(c),
this.tM.Jb(a)&&Array.add(b,this.tM.ga(a));return b}NOa(a){a=this.Lhg(a);return Object.assign(new Iw,{Result:a,Canceled:!1})}qUf(a){a=this.Lhg(a);const b=[];for(const c of a)b.push(Object.assign(new hv,{Id:c.Id,Provider:c.Provider,Message:"Success. User already exists in cache with requested permissions.",Status:0}));return Object.assign(new fv,{Result:b,Canceled:!1})}static tGc(a){return uo.OQd(a.Id,a.Provider)}static NQd(a){return uo.OQd(a.UserId,a.Provider)}static OQd(a,b){return b+a}}Object(e.a)(uo,
"UserPermissionsCache",null,[1261]);class Bt{constructor(a,b,c,f){this.lpa=a;this.eb=b;this.l_h=c;this.j_h=f}UXb(a,b,c,f){var l=this.lpa.Vwa;l=l?String.format("{0}/{1}",l,"people.ashx"):"people.ashx";l=new hj.QueryStringBuilder(l);l.Ti("oid","3");l.Ti("bdqs",c);(c=this.owi(f))&&2<=c.length&&(f=c[1],l.Ti("w",c[0]),l.Ti("h",f));l.Ti("uid",a);l.Ti("p",b);l.Ti("usid",this.l_h);l.Ti("WacUserType",this.j_h);return l.toString()}owi(a){switch(a){case 1:return["48","48"];case 2:return["64","64"];case 3:return["96",
"96"];case 4:return["120","120"];case 5:return["240","240"];case 6:return["360","360"];case 7:return["432","432"];case 8:return["504","504"];case 0:return[];default:throw Error.argumentOutOfRange("unknown dimension");}}get Tce(){return this.eb.ka("IsUserProfilePictureResolutionEnabled")}}Object(e.a)(Bt,"UserProfilePictureUtils",null,[1259,1260]);var py=d(564);class vr{get name(){return"Common.App.People"}Wb(a){a.register(ut,"Common.App.People.PeopleRequestHandler").as("Common.App.People.IPeopleRequestHandler").ma().na(()=>
new ut(u.AFrameworkApplication.Ge,()=>u.AFrameworkApplication.hh,u.AFrameworkApplication.fa,new Op.a));a.register(uo,"Common.App.People.UserPermissionsCache").as("Common.App.People.IUserPermissionsCache").ma();a.register(ev,"Common.App.People.ShowSharingUiPostMessageHandler").ma().na(()=>new ev(Mn.a.Ju(a.Ka("Postmessage.IHostPostmessenger"))));a.register(ms,"Common.App.People.UserAccessUtils").as("Common.App.People.IUserAccessUtils").ma().na(()=>new ms(a.resolve("Common.App.People.PeopleRequestHandler"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.ShowSharingUiPostMessageHandler"),a.resolve("Common.App.People.IUserPermissionsCache"),py.a,El.a.instance));a.register(zt,"Common.App.People.UserContactsUtils").as("Common.App.People.IUserContactsUtils").ma().na(()=>new zt(u.AFrameworkApplication.fa,a.resolve("Common.App.People.PeopleRequestHandler")));a.register(Bt,"Common.App.People.UserProfilePictureUtils").as("Common.App.People.IUserProfilePictureUtilsV2").as("Common.App.People.IUserProfilePictureUtils").ma().na(()=>
new Bt(a.resolve("Common.App.People.PeopleRequestHandler"),u.AFrameworkApplication.fa,u.AFrameworkApplication.userSessionId,u.AFrameworkApplication.userType));a.register(bv,"Common.App.People.PeopleColorUtils").as("Common.App.People.IPeopleColorUtils").ma().na(()=>new bv(a.qb("Common.IColorTable")));a.register(tt,"Common.App.People.PeopleManager").as("Common.App.People.IPeopleManager").ma().na(()=>new tt(a.resolve("Common.App.People.PeopleRequestHandler"),a.resolve("Common.App.People.IUserAccessUtils"),
u.AFrameworkApplication.fa,a.resolve("Common.App.People.IUserContactsUtils"),wd.a.get_instance(),a.resolve("Common.App.People.IUserProfilePictureUtilsV2")));a.register(Fw,"Common.App.People.ExternalPeopleAPI").as("Common.App.People.IExternalPeopleAPI").ma().na(()=>new Fw(a.resolve("Common.App.People.IPeopleManager"),a.resolve("Common.App.People.IPeopleColorUtils"),Mn.a.Ju(a.Ka("Common.ILokiTokenManager")),u.AFrameworkApplication.fa,a.Ka("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper")))}init(){u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.ff(Object(C.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){const a=fb.a.instance.resolve("Common.App.People.IPeopleManager");fb.a.instance.resolve("Common.App.People.IExternalPeopleAPI");u.AFrameworkApplication.fa.ka("GetUserContactsTestHookIsEnabled")&&(new ur(a,u.AFrameworkApplication.Ta)).tYk()}dispose(){}static main(){m.a.instance.Bc(new vr)}}Object(e.a)(vr,"PeoplePackage",null,[2,3]);var kq={};kq.nLb=function(){function a(){return G()&&(oc()||3<=(mb()?Ic("version/"):
0))}function b(){return 0<=window.navigator.userAgent.indexOf("Windows")}function c(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function f(Gd){Gd=(new RegExp(Gd+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var Ce=-1;null!=Gd&&2<=Gd.length&&(Ce=parseFloat(Gd[1]),isNaN(Ce)&&(Ce=-1));return Ce}function l(){sm||(sm=!0,zk=f("Windows Phone"));return 8<=zk}function x(){return"function"==typeof navigator.msLaunchUri&&!c()&&!nc()&&!R()}function G(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}
function R(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function fa(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function wa(){return fa()?8==window.document.documentMode:!1}function Wa(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function mb(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Kb(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function nc(){var Gd=window.navigator.userAgent.toLowerCase();
return 0<=Gd.indexOf("android")&&0<=Gd.indexOf("chrome")}function oc(){return 3<=(Wa()?Ic("firefox/"):0)}function Ic(Gd){var Ce=window.navigator.userAgent.toLowerCase(),Hf=Ce.indexOf(Gd);return 0<=Hf?parseInt(Ce.substring(Hf+Gd.length,Ce.length)):0}function Kc(Gd,Ce,Hf,je,Fg){if(je&&null!=Ce)Ce();else if(x())navigator.msLaunchUri(Gd,Ce,Hf);else if(!(Kb()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&G())||R())ie(Gd,Ce,
Hf);else if(Kb()&&Fg)a:{try{window.open(Gd,"_self")}catch($h){null!=Hf&&Hf();break a}null!=Ce&&Ce()}else Hc(Gd,Ce,Hf)}function Hc(Gd,Ce,Hf){var je=document.getElementById("OICLinkTag");null==je&&(je=document.createElement("a"),je.id="OICLinkTag",je.style.visibility="hidden",je.href="",0==(vh.Options&mi.SupportsTopTargetNavigation)||vh.NoBrowserModalDialogs?je.target="_blank":je.target="_top",document.body.appendChild(je),null!=je.addEventListener&&je.addEventListener("click",function(Fg){null!=Fg.stopPropagation&&
Fg.stopPropagation()},!1));try{je.href=Gd,je.click()}catch(Fg){null!=Hf&&Hf();return}null!=Ce&&Ce()}function ie(Gd,Ce,Hf){var je=document.getElementById("OICFrame");null==je&&(je=document.createElement("iframe"),je.className="ObjectInDialog",je.style.visibility="hidden",je.src="about:blank",document.body.appendChild(je),je.id="OICFrame");try{je.contentWindow.location.href=Gd}catch(Fg){null!=Hf&&Hf();return}null!=Ce&&Ce()}function He(Gd){return 0!=(Gd.Options&mi.SkipProtocolHandler)||wa()}function fe(Gd){return Gd===
pk.ReadOnly||Gd===pk.ReadWrite}function Te(Gd,Ce,Hf,je){var Fg;try{var $h=new ActiveXObject("SharePoint.OpenDocuments.4");return(Fg=$h.ViewDocument3(window.self,Gd,Ce,je))?(yk(ni.O14ActiveX),wg.None):wg.Failed}catch(Hi){}if(mi.O14Only===(Hf&mi.O14Only))return vh.DescriptiveUnattemptedEnums?wg.O14AttemptFailure:wg.Unattempted;try{return $h=new ActiveXObject("SharePoint.OpenDocuments.3"),(Fg=$h.ViewDocument3(window.self,Gd,Ce,je))?(yk(ni.O12ActiveX),wg.None):wg.Failed}catch(Hi){}if(mi.O12UpOnly===(Hf&
mi.O12UpOnly))return vh.DescriptiveUnattemptedEnums?wg.O12UpOnlyFail:wg.Unattempted;try{return $h=new ActiveXObject("SharePoint.OpenDocuments.2"),(Fg=fe(Ce)?$h.ViewDocument2(window.self,Gd,je):$h.EditDocument2(window.self,Gd,je))?(yk(ni.O11ActiveX),wg.None):wg.Failed}catch(Hi){}return vh.DescriptiveUnattemptedEnums?wg.ActiveXUnattempted:wg.Unattempted}function We(Gd,Ce,Hf,je,Fg){Gd==cg.Visio&&Hf==pk.ReadWrite&&(Hf=pk.WriteOnly);Gd=Fg;je=je||c()&&!l();je||(je="",je=fe(Hf)?je+"ofv|ofc|":je+"ofe|",Gd+=
mg(je+"u|"));Gd+=mg(Ce);vh.NewTelemetryDataIsEnabled&&(Ce=-1!==Gd.indexOf("?")?"&":"?",Ce+=vh.SessionOrigin?"OR="+vh.SessionOrigin+"&":"",Ce+=vh.ClickTime?"CT="+vh.ClickTime+"&":"",Ce+=vh.CorrelationId?"CID="+vh.CorrelationId:"",Ce="?"!=Ce?Ce:"",Ce="&"!=Ce.slice(-1)?Ce:Ce.slice(0,-1),Gd+=mg(Ce));Ce=window.location.href;Hf=Ce.toLowerCase().indexOf("&wdlor=");-1!=Hf?(Hf+=7,je=Ce.indexOf("&",Hf),Ce=-1==je?Ce.substr(Hf):Ce.substring(Hf,je)):Ce=void 0;if(null!=Ce&&"undefined"!=typeof Ce){Hf="";try{Hf=
decodeURIComponent(Ce)}catch($h){}0<Hf.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Hf)&&(Gd=Gd+"|f|"+Hf)}return Gd}function Qf(Gd,Ce,Hf,je,Fg,$h){var Hi=jj(Gd);if(null==Hi)return Dj(vh.DescriptiveUnattemptedEnums?wg.ProtocolHandlerIsNull:wg.Unattempted,vh.Application),!1;Gd=We(Gd,Ce,Hf,je,Hi);Kc(Gd,Xg,Mg,Fg,$h);return!0}function mg(Gd){if(G()&&Kb()){var Ce="";try{Ce=decodeURI(Gd)}catch(Hf){}if(Ce==Gd)return encodeURI(Gd)}return Gd}function Xg(){yk(ni.ProtocolHandler)}
function Mg(){vh.Options|=mi.SkipProtocolHandler;Gi(vh,Sj,bk)}function Sf(){null!=Gk&&Gk(ni.RoamingProtocolHandler)}function uh(){null!=Nj&&Nj(wg.ControlNeeded)}function Sg(){var Gd=document.getElementById("npSharePointPlugin");if(null==Gd){Gd="application/x-sharepoint";G()&&3<=(mb()?Ic("version/"):0)&&li("application/x-sharepoint-webkit",!0)&&(Gd="application/x-sharepoint-webkit");if(!li(Gd,!0))if(G()&&li("application/officelive",!0))Gd="application/officelive";else return null;var Ce=document.createElement("object");
Ce.id="npSharePointPlugin";Ce.type=Gd;Ce.style.width="0px";Ce.style.height="0px";Ce.style.setProperty("visibility","hidden","");document.body.appendChild(Ce);Gd=document.getElementById("npSharePointPlugin")}return Gd}function li(Gd,Ce){var Hf=window.navigator.mimeTypes;if(null==Hf)return!1;Gd=Hf[Gd];return!Gd||Ce&&!Gd.enabledPlugin?!1:!0}function Ui(Gd){try{if(null!=new ActiveXObject(Gd))return!0}catch(Ce){}return!1}function Cj(Gd){switch(Gd){case cg.OneNote:return"OneNote.Notebook";default:return""}}
function jj(Gd){if(Gd!=cg.OneNote&&c()&&!l())return"office:";switch(Gd){case cg.Excel:return"ms-excel:";case cg.OneNote:return"onenote:";case cg.PowerPoint:return"ms-powerpoint:";case cg.Visio:return"ms-visio:";case cg.Word:return"ms-word:";case cg.Project:return"ms-project:";case cg.Publisher:return"ms-publisher:";case cg.Infopath:return"ms-infopath:";case cg.Access:return"ms-access:";default:return""}}function kj(Gd){switch(Gd){case cg.Excel:return"root\\office15\\excel.exe";case cg.PowerPoint:return"root\\office15\\powerpnt.exe";
case cg.Visio:return"root\\office15\\visio.exe";case cg.Word:return"root\\office15\\winword.exe";case cg.Project:return"root\\office15\\winproj.exe";case cg.Publisher:return"root\\office15\\mspub.exe";case cg.Infopath:return"root\\office15\\infopath.exe";case cg.Access:return"root\\office15\\msaccess.exe";default:return null}}function Gi(Gd,Ce,Hf){vh=Gd;Sj=Ce;bk=Hf;if(Gd.DocumentUrl){var je=Hf=Ce=Gd.DocumentUrl;try{je=decodeURIComponent(Gd.DocumentUrl)}catch(Wo){}try{Hf=encodeURI(Gd.DocumentUrl)}catch(Wo){}Ce=
Ce+""+Gd.CorrelationIdForWinClient;je+=Gd.CorrelationIdForWinClient;Hf+=Gd.CorrelationIdForWinClient;Gd.Mode===pk.ReadWrite&&mi.CheckoutRequired===(Gd.Options&mi.CheckoutRequired)&&(Gd.Mode=pk.ForceCheckout);mi.HostIsEditOnly===(Gd.Options&mi.HostIsEditOnly)&&(Gd.Mode=pk.WriteOnly);if(He(Gd)?0:G()&&(Gd.Application==cg.OneNote||li("application/x-sharepoint-protocolhandler",!1)||li("application/x-sharepoint-webkit-protocolhandler",!1))||x()||nc()||!(a()||oc()||"ActiveXObject"in window&&!c()||Kb())||
15<=ok())Qf(Gd.Application,Gd.EncodeUrl?Hf:Ce,Gd.Mode,Gd.Application==cg.OneNote,Gd.SilentExternalHandler,Gd.NavigateUsingWindowOpen);else{var Fg;if(Fg=wa())a:{var $h=Gd.EncodeUrl?Ce:je,Hi=Gd.Mode,Xo=Cj(Gd.Application);try{Fg=(new ActiveXObject("SharePoint.OpenDocuments.5")).ViewDocument3(window.self,$h,Hi,Xo);break a}catch(Wo){}Fg=!1}if(Fg)yk(ni.O15ActiveX);else{if(a()||oc()){var fk=Gd.EncodeUrl?Ce:je;je=Gd.Mode;Fg=Cj(Gd.Application);$h=Sg();if(null==$h)fk=vh.DescriptiveUnattemptedEnums?wg.PluginIsNull:
wg.Unattempted;else{Hi=!1;try{Hi=$h.ViewDocument3(window.self,fk,je,Fg)}catch(Wo){}if(!Hi)try{Hi=fe(je)?$h.ViewDocument2(window.self,fk,Fg):$h.EditDocument2(window.self,fk,Fg)}catch(Wo){}Hi?(yk(ni.NpapiPlugin),fk=wg.None):fk=wg.Failed}}else{try{fk=new ActiveXObject("IDBHO.IDBHOCtrl"),null!=fk&&fk.SaveSSOCreds()}catch(Wo){}fk=Te(Gd.EncodeUrl?Ce:je,Gd.Mode,Gd.Options,Cj(Gd.Application))}if(fk!=wg.None){if(je=Gd.CouldUseRoamingApps)Yk||(Yk=!0,Ul=f("Windows NT")),je=6.1<=Ul&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&
(fa()||oc()||Kb());if(je&&Gd.Application!=cg.OneNote){if(!kq.nLb.pEl()){Dj(wg.ControlNeeded,vh.Application);return}if(Gd.RoamingAppsLauncher){"undefined"==typeof Gd.RoamingAppsLauncher||null==Gd.RoamingAppsLauncher?Dj(vh.DescriptiveUnattemptedEnums?wg.RoamingLauncherIsNull:wg.Unattempted,vh.Application):"undefined"==typeof Gd.RoamingBitsUrl||null==Gd.RoamingBitsUrl?kq.nLb.vEl(Gd.DocumentUrl,Gd.RoamingAppsLauncher,Gd.Application,Gd.ApplicationParameters,Sj,bk):kq.nLb.aIh(Gd.DocumentUrl,Gd.RoamingAppsLauncher,
Gd.RoamingApplicationExe,Gd.ApplicationParameters,Gd.RoamingPlatform,Gd.RoamingBitsUrl,Sj,bk);return}if(!Gd.ContinueIfLauncherIsNull){Dj(wg.LauncherNeeded,vh.Application);return}}mi.NoProtocolHandlerFallback==(Gd.Options&mi.NoProtocolHandlerFallback)||He(Gd)||fa()||G()&&!(vh.DescriptiveUnattemptedEnums?fk>=wg.O14Unattempted&&fk<=wg.DocumentUrlIsNull:fk==wg.Unattempted)?Dj(fk,vh.Application):Qf(Gd.Application,Gd.EncodeUrl?Hf:Ce,Gd.Mode,Gd.Application==cg.OneNote,Gd.SilentExternalHandler,Gd.NavigateUsingWindowOpen)}}}}else Dj(vh.DescriptiveUnattemptedEnums?
wg.DocumentUrlIsNull:wg.Unattempted,vh.Application)}function yk(Gd){null!=Sj&&Sj(Gd)}function Dj(Gd,Ce){"undefined"==typeof Ce&&(Ce=null);null!=bk&&bk(Gd,Ce)}function ok(){var Gd=0;if(a()||oc()||Kb()){var Ce=Sg();try{null!=Ce&&(Gd=Ce.GetOfficeVersion())}catch(Hf){}}else Ui("SharePoint.OpenDocuments.5")?Gd=15:Ui("SharePoint.OpenDocuments.4")?Gd=14:Ui("SharePoint.OpenDocuments.3")?Gd=12:Ui("SharePoint.OpenDocuments.2")&&(Gd=11);return Gd}function Fl(){return G()&&(li("application/x-sharepoint",!0)||
li("application/x-sharepoint-webkit",!0))}var Xk="",Gl="",ak="",Sj,bk,Gk,Nj,vh,Yk,Ul,sm,zk,pk={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},mi={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},wg={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,
ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},ni={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},cg={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:pk,OpenDocumentOptions:mi,OpenDocumentFailureType:wg,OpenDocumentControl:ni,OfficeApplication:cg,EditDocumentInClient:Gi,
EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=0;this.Application=cg.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=
this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:ok,IsO14MacPluginInstalled:Fl,OfferOfficeInDialog:function(){return b()&&11>=ok()},OfferOfficeNoIntrusive:function(){return b()&&15>ok()},OfferMacOffice:function(){return G()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Fl()},InstallRoamingControl:function(){Wa()?window.InstallTrigger.install({Office:{URL:Gl}}):ie(ak,null,null)},CanUseRoamingControl:function(){if(x())return!0;if(Kb())return"undefined"!=typeof navigator.plugins.refresh&&
navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Wa()){var Gd=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(Gd);var Ce=document.createEvent("Events");Ce.initEvent("RoamingOfficeInstalled",!0,!1);Gd.dispatchEvent(Ce);return!!Gd.getAttribute("installed")}if(fa())try{return(new ActiveXObject("RoamingOfficeActiveX.RoamingOffice")).HrExists()}catch(Hf){}return!1},InitUrls:function(Gd,Ce,Hf){Xk=Gd;Gl=Hf;ak=Ce},LaunchRoamingApps:function(Gd,
Ce,Hf,je,Fg,$h){kq.nLb.aIh(Gd,Ce,kj(Hf),je,"x86",Xk,Fg,$h)},LaunchRoamingApps2:function(Gd,Ce,Hf,je,Fg,$h,Hi,Xo){var fk="";null!=je&&(fk+=" "+je);null!=Gd&&(fk+=' "'+Gd+'"');if(x()||Kb())Gk=Hi,Nj=Xo,Hi='office: "'+($h+'" "')+(Hf+'" "ROAMING"'),Hi+=' "'+Ce+'"',Hi+=' "'+Fg+'"',Hi+=" "+fk,Kc(Hi,Sf,uh,!1,!1);else if(Wa())Gd=document.createElement("RoamingExtensionElement"),Gd.setAttribute("cabUrl",$h),Gd.setAttribute("app",Hf),Gd.setAttribute("licensingEntitlements",Ce),Gd.setAttribute("platform",Fg),
Gd.setAttribute("args",fk),document.documentElement.appendChild(Gd),Ce=document.createEvent("Events"),Ce.initEvent("RoamingOfficeLaunch",!0,!1),Gd.dispatchEvent(Ce),null!=Hi&&Hi(ni.RoamingFFExtension);else if(fa()){if(Gd=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Gd)try{Gd.HrConfigureSingle($h,Hf,Ce,Fg,fk),null!=Hi&&Hi(ni.RoamingActiveX)}catch(Wo){}}else null!=Xo&&Xo(wg.Failed)},ShouldShowDialog:function(){return!c()},NavigateToUrlUsingClickingOnATag:Hc,OpenDocumentWithProtocolHandler:Qf,
OpenDocumentWithProtocolHandlerNoCallBack:function(Gd,Ce,Hf,je){var Fg=jj(Gd);if(null==Fg)return Dj(vh.DescriptiveUnattemptedEnums?wg.ProtocolHandlerNoCallbackIsNull:wg.Unattempted,vh.Application),!1;Gd=We(Gd,Ce,Hf,je,Fg);Kc(Gd,null,null,!1,!1);return!0}}}();kq.ClientUtils=kq.nLb;class Ct{constructor(a,b,c){this.Ca=a;this.zQh=b;this.fG=c}ub(){this.Ca.ya(F.a.tryMacOffice,xd.a.frame,Object(C.a)(this,this.Jrk,"onTryMacOffice"));this.Ca.ya(F.a.GAh,xd.a.frame,Object(C.a)(this,this.r3g,"onTryMacOfficeFromViewer"));
this.Ca.ya(F.a.FAh,xd.a.frame,Object(C.a)(this,this.r3g,"onTryMacOfficeFromViewer"))}Jrk(a,b,c,f,l){if(1===c)return 32;l?(a=l.SourceControlId,"btnjTryMacOfficeForWordEditor"===a?ib.a.an(Ze.a.FCa(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===a&&ib.a.an(Ze.a.FCa(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.UBg();return 32}r3g(a,b,c){if(1===c)return 32;switch(a){case F.a.GAh:ib.a.an(Ze.a.FCa(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");
break;case F.a.FAh:ib.a.an(Ze.a.FCa(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32}UBg(){ib.a.an(Ct.jck,"_blank",void 0,"LaunchMacTrialWindow")}get Tlc(){return this.zQh&&r.a.lk&&!r.a.xbe&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}get Yqh(){const a=this.Tlc;a||u.AFrameworkApplication.ej.P2k();return a}get Ual(){return this.Tlc}static get jck(){return Ze.a.XV("522401")}}Object(e.a)(Ct,"MacOfficeOffer",null,[1276]);class Dt{constructor(a,b,c){this.Ca=a;this.CQh=b;this.zqd=null;
(this.cAc=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&fb.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(f=>{this.zqd=f});this.fG=c}ub(){this.Ca.ya(F.a.tryOffice,xd.a.frame,Object(C.a)(this,this.Krk,"onTryOffice"));this.Ca.ya(F.a.XTe,xd.a.frame,Object(C.a)(this,this.XTe,"tryOfficeThroughTellMe"));this.Ca.ya(F.a.OAh,xd.a.frame,Object(C.a)(this,this.PAh,"tryOfficeThroughViewer"));
this.Ca.ya(F.a.NAh,xd.a.frame,Object(C.a)(this,this.PAh,"tryOfficeThroughViewer"))}Krk(a,b,c,f,l){if(this.cAc&&1===c)return this.isFreemiumUpsellEnabled&&this.Ulc?32:8;2===c&&(l?(a=l.SourceControlId,"btnjTryOfficeForWordEditor"===a?ib.a.an(Ze.a.FCa(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===a?ib.a.an(Ze.a.FCa(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Qde()):this.Qde());return 32}XTe(a,b,c,f,l){if(this.cAc&&1===c)return this.isFreemiumUpsellEnabled&&
this.Ulc?32:8;2===c&&(l?(a=l.SourceControlId,ib.a.an(Ze.a.XV("862405")+this.Iaj(a),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):ib.a.an(Ze.a.XV("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32}PAh(a,b,c){if(this.cAc&&1===c)return this.isFreemiumUpsellEnabled&&this.Ulc?32:8;if(2===c)switch(a){case F.a.OAh:ib.a.an(Ze.a.FCa(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case F.a.NAh:ib.a.an(Ze.a.FCa(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32}get bYg(){return this.Ulc}get Oik(){return this.Ulc&&
MSOJS.ClientUtils.OfferOfficeInDialog()}get Ulc(){return this.CQh&&!r.a.lk}get isFreemiumUpsellEnabled(){let a=!1;this.zqd&&(a=this.zqd.isFreemiumUpsellEnabled());return a}Qde(a=null){let b=0;a&&(b=a);ib.a.an(Dt.y8i(b),"_blank",void 0,"LaunchOfficeOffer")}Iaj(a){let b=0;switch(a){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":b=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":b=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":b=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":b=
4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":b=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":b=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":b=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":b=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":b=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":b=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":b=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":b=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":b=
18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":b=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":b=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":b=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":b=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":b=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":b=29}return 0===b?"":String.format("&pc={0:D}",b)}static y8i(a){if(r.a.Ki)switch(a){case 1:return Ze.a.XV("393806");case 2:return Ze.a.XV("393810");
case 3:return Ze.a.XV("393809");case 5:return Ze.a.XV("393805")}else if(r.a.rI)switch(a){case 1:return Ze.a.XV("521979");case 3:return Ze.a.XV("521980");case 5:return Ze.a.XV("521978");case 2:return Ze.a.XV("522490")}else{if(2===a)return Ze.a.XV("517778");if(1===a)return Ze.a.FCa(30)}return Ze.a.XV("522402")}}Object(e.a)(Dt,"OfficeTrialExperience",null,[1274]);class Jw{Wb(a){a.register(Dt,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").ma().na(()=>new Dt(u.AFrameworkApplication.Ta,
u.AFrameworkApplication.ebe,u.AFrameworkApplication.lcid));a.register(Ct,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").ma().na(()=>new Ct(u.AFrameworkApplication.Ta,u.AFrameworkApplication.Ywg,u.AFrameworkApplication.lcid))}}Object(e.a)(Jw,"OpenInClientConfiguration",null,[3]);var sp=d(170),$e=d(46);class Et{constructor(a,b,c){this.dX=this.Pt=this.K=null;this.gf=a;this.zF=b;this.zre=c}vUf(a,b,c){if(!this.gf)return null;if(!this.K){this.K=$e.a.Ce();this.K.id=this.zF;this.K.className=
"HTMLSpinnerIndicator";const f=$e.a.Ce();f.className="HtmlspinnerOverlay";this.Pt=$e.a.Ce();this.Pt.className="HtmlspinnerInner";const l=$e.a.Fn();l.className="BootSpinner";this.Pt.appendChild(l);this.zre&&(this.dX=$e.a.Fn(),this.dX.id="htmlspinner_label",this.Pt.appendChild(this.dX));this.K.appendChild(f);this.K.appendChild(this.Pt);this.gf.appendChild(this.K)}this.zre&&(this.dX.innerText=a||ResourceStrings.l_Loading);this.mJd(b,c);return this.K}CKb(a){this.dX&&(this.dX.innerText=a)}mJd(a,b){this.K.style.left=
$e.a.Nc(a);this.K.style.top=$e.a.Nc(b);this.Pt.style.bottom=this.zre?$e.a.Nc(this.gf.clientHeight/2+16):$e.a.Nc(this.gf.clientHeight/2+24)}}Object(e.a)(Et,"HtmlSpinnerIndicator",null,[]);class ns extends Et{constructor(a,b,c){super(a,b,!1);this.Bre=c}vUf(a,b,c){if(!this.gf)return null;if(!this.K){this.K=$e.a.Ce();this.K.id=this.zF;this.K.className="HTMLProgressIndicator";const f=$e.a.Ce();f.className="HtmlprogressOverlay";this.Pt=$e.a.Ce();this.Pt.className="HtmlprogressInner";if(this.Bre){const l=
$e.a.SB();l.src=sp.a.uK(sf.a.Dma);l.width=sf.a.YEb;l.height=sf.a.ccd;this.Pt.appendChild(l)}this.dX=$e.a.Fn();this.Pt.appendChild(this.dX);this.K.appendChild(f);this.K.appendChild(this.Pt);this.gf.appendChild(this.K)}this.dX.innerText=a||ResourceStrings.l_Loading;this.mJd(b,c);return this.K}mJd(a,b){this.K.style.left=$e.a.Nc(a);this.K.style.top=$e.a.Nc(b);this.K.style.display=te.a.Lk;this.Pt.style.position=te.a.Dna;a=this.Pt.clientWidth;this.Pt.style.top=$e.a.Nc(this.gf.clientHeight/2-this.Pt.clientHeight/
2);u.AFrameworkApplication.isRtl?(this.Pt.style.right=$e.a.Nc(this.gf.clientWidth/2-a/2),this.Pt.style.direction=te.a.mZa):(this.Pt.style.left=$e.a.Nc(this.gf.clientWidth/2-a/2),this.Pt.style.direction=te.a.Rvh);this.K.style.display=te.a.Cf}}Object(e.a)(ns,"HtmlProgressIndicator",Et,[]);class Kw{constructor(a,b){this.ZI=this.hO=this.K=null;this.Db=!0;this.NJg=a;this.FI=b}uIb(a,b,c,f,l){u.AFrameworkApplication.Uwb()||(this.K=this.NJg.vUf(a,c,f),b?(this.hO&&(window.clearTimeout(this.hO),this.hO=null),
this.ZI&&(window.clearTimeout(this.ZI),this.ZI=null),this.gOe(l)):this.hO||this.ZI||(this.hO=window.setTimeout(()=>{this.FOe(l)},200)))}dRc(){this.hO&&(window.clearTimeout(this.hO),this.hO=null);this.ZI&&(window.clearTimeout(this.ZI),this.ZI=null);this.K&&(this.K.style.display=te.a.Cf,this.K.style.opacity="0")}CKb(a){this.NJg.CKb(a)}gOe(a){this.K&&(this.K.style.opacity="1.0",this.K.style.visibility=te.a.oz,this.Db&&(this.K.style.display=te.a.Lk),Aa.a.J(512496862,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",
this.Aoc(a)))}FOe(a){this.hO=null;this.K&&(this.K.style.visibility=te.a.oz,this.Db&&(this.K.style.display=te.a.Lk),this.K.style.opacity="0.0",this.ZI||(this.ZI=window.setTimeout(()=>{this.EOe(a)},1800)))}EOe(a){this.ZI=null;this.K&&(this.K.style.opacity="1.0",this.Db&&(this.K.style.display=te.a.Lk),Aa.a.J(512496861,811,15,"HtmlProgressIndicatorView::spinner shows up. actionName={0}",this.Aoc(a)))}Aoc(a){return a?Object.getType(a)===String?a:Object.getType(a)===Number?this.FI.c5(a):null:null}get visible(){return this.Db}set visible(a){this.Db=
a;this.K&&(this.K.style.display=a?te.a.Lk:te.a.Cf)}}Object(e.a)(Kw,"HtmlProgressIndicatorView",null,[1233]);class Lw{constructor(){this.PresentationID=this.PodSessionID=this.PodEndpointUrl=null}}Object(e.a)(Lw,"UploadConvertedFileToHostParams",null,[]);var Mw=d(980),vo=d(73);const wr=a=>{for(let b=0;b<a.children.length;b++){const c=a.children[b];c.style.position="relative";c.style.top=(c.parentNode.offsetHeight-c.offsetHeight)/2+"px"}},Pp=a=>a.mc.keyCode===w.a.lq||a.mc.keyCode===w.a.NO?(a.Ac.click(),
!0):!1,os=(a,b,c,f,l,x,G)=>{const R=document.createElement("a");R.className="ProtocolLaunchingDialogButtonAnchor";R.className+=" OICDialog";R.id=a;R.setAttribute(Jc.a.Ye,Jc.a.hu);R.style.padding="0";R.style.margin="0";f&&Ft(l,b,c,f,R);a=document.createElement("span");a.className="ProtocolLaunchingDialogButtonLabel";a.innerText=l;R.appendChild(a);R.tabIndex=0;x&&cd.a.instance.ob(ma.a.click,R,x);G&&A.KeyInputManager.instance.ob(ma.a.wl,R,G);return R},Ft=(a,b,c,f,l)=>{var x=document.createElement("img");
x.alt=a;x.className=vo.getImageClassWithCluster(c,f);x.src=b;x.setAttribute(Jc.a.Ye,Jc.a.KM);a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container";a.appendChild(x);x=document.createElement("span");x.className="ProtocolLaunchingDialogIconContainer";x.appendChild(a);l.appendChild(x)};class iv{static get mg(){return Lh.a.UB(iv.fo,CommonUIStrings.l_OICLaunchDialogTitle)}}iv.fo="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(e.a)(iv,"OICLaunchDialogHtml",null,[]);class qy extends Lh.a{constructor(a){super();this.Zjb=this.M_a=null;this.qLa=!1;this.Gw=a;this.mg=iv.mg;this.yd=5;this.ng="OICLaunchDialog";this.showDialog("",Object(C.a)(this,this.Uik,"oicLaunchDialogResultHandler"));this.qnh();this.i5("ProtocolLaunchingDialogTitle");4!==u.AFrameworkApplication.Aa.jb.mra&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);this.bR(this.M_a);Z.ULS.sendTraceTag(22140865,
211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Mva(){this.M_a=os("BtnRichClient",this.Gw.trb,this.Gw.p8a,this.Gw.u7d,CommonUIStrings.l_OICLaunchRichClient,Object(C.a)(this,this.T1g,"onRichClientButtonClick"),Pp);document.getElementById("OICLaunchRichClient").appendChild(this.M_a);wr(this.M_a);this.Zjb=os("BtnReturn",this.Gw.trb,this.Gw.p8a,this.Gw.Jng,CommonUIStrings.l_OICReturnToOnlineClient,Object(C.a)(this,this.R1g,"onReturnButtonClick"),
Pp);document.getElementById("OICReturnToApp").appendChild(this.Zjb);wr(this.Zjb)}R1g(){this.hide();this.Gw.WXa();return!0}T1g(){Z.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();u.AFrameworkApplication.Ta.processAction(F.a.Xfb,2);return!0}Uik(){this.Gw.WXa()}dispose(){this.qLa||(this.M_a&&(cd.a.instance.xb(ma.a.click,this.M_a,Object(C.a)(this,this.T1g,"onRichClientButtonClick")),A.KeyInputManager.instance.xb(ma.a.wl,this.M_a,Pp)),this.Zjb&&(cd.a.instance.xb(ma.a.click,
this.Zjb,Object(C.a)(this,this.R1g,"onReturnButtonClick")),A.KeyInputManager.instance.xb(ma.a.wl,this.Zjb,Pp)),super.dispose(),this.qLa=!0)}}Object(e.a)(qy,"OICLaunchDialog",Lh.a,[]);class jv{static get mg(){return Lh.a.UB(jv.fo,CommonUIStrings.l_OICDialogTitle)}}jv.fo="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(e.a)(jv,"ProtocolLaunchingDialogV2Html",null,[]);var kv=d(194);class Gt extends Lh.a{constructor(a){super();this.Yjb=this.Bya=null;this.qLa=!1;this.WKa=null;this.Gw=a;this.mg=jv.mg;this.yd=5;this.ng="ProtocolLaunchingDialog";this.hsc="OICRetryDialog";u.AFrameworkApplication.pe.tsa&&u.AFrameworkApplication.pe.VXa();u.AFrameworkApplication.pe.Cb(new xe.a(2,1,5E3,()=>{this.switchToBackupMode()},101));this.showDialog("",Object(C.a)(this,this.yhc,"protocolLaunchingDialogResultHandler"));this.qnh();
this.i5("Issues");this.I6f();Z.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog"}Mva(){const a=document.getElementById("Issues");if(a){Ft("",this.Gw.trb,this.Gw.p8a,this.Gw.u7d,a);const b=document.createElement("span");b.className="WACDialogSectionTitle";b.innerText=5===this.Gw.M3g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;a.appendChild(b);wr(a);a.style.display="none"}u.AFrameworkApplication.Aa.jb.rig?
(this.Yjb=os("GiveFeedback",this.Gw.trb,this.Gw.p8a,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(C.a)(this,this.h9c,"onGiveFeedbackClick"),Object(C.a)(this,this.W_g,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.Yjb),wr(this.Yjb)):document.getElementById("ButtonGiveFeedback").style.display="none";0===u.AFrameworkApplication.Aa.jb.mra||u.AFrameworkApplication.IIi?document.getElementById("ButtonEdit").style.display="none":(this.Bya=
os("Edit",this.Gw.trb,this.Gw.p8a,"",2===u.AFrameworkApplication.Aa.jb.rm?4===u.AFrameworkApplication.Aa.jb.mra?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===u.AFrameworkApplication.Aa.jb.mra?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(C.a)(this,this.i_g,"onEditClick"),Object(C.a)(this,this.m_g,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Bya),wr(this.Bya));0===u.AFrameworkApplication.Aa.jb.mra&&
!u.AFrameworkApplication.ebe&&a&&(a.style.display="none")}J6f(){return this.WKa?(this.bR(this.WKa),!0):!1}I6f(){return this.Bya?(this.bR(this.Bya),!0):!1}m_g(a){return this.Lwe(a,0)}W_g(a){return this.Lwe(a,2)}Q1g(a){return this.Lwe(a,1)}Lwe(a,b){let c=!1;if(a.mc.keyCode===w.a.lq||a.mc.keyCode===w.a.NO)a.Ac.click(),c=!0;else if(a.mc.keyCode===Sys.UI.Key.down||a.mc.keyCode===Sys.UI.Key.up)switch(b){case 1:c=this.I6f();break;case 0:c=this.J6f()}return c}i_g(){this.hide();4===u.AFrameworkApplication.Aa.jb.mra?
(Z.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Gw.WXa()):(Z.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Gw.A2b());return!0}h9c(){Z.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");return!0}j$c(){Z.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";u.AFrameworkApplication.Ta.processAction(F.a.Xfb,2);return!0}yhc(){this.Gw.WXa()}switchToBackupMode(){var a=document.getElementById("ProtocolLaunchingDialogTitle");
if(a){a.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(a=document.getElementById("Issues"))a.style.display="block";(a=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!a.children.length&&(this.WKa=os("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(C.a)(this,this.j$c,"onRetryOICClick"),Object(C.a)(this,this.Q1g,"onRetryOICKeyUp")),a.appendChild(this.WKa),wr(this.WKa),this.Bya||this.J6f())}}dispose(){this.qLa||(this.Bya&&(cd.a.instance.xb(ma.a.click,this.Bya,Object(C.a)(this,
this.i_g,"onEditClick")),A.KeyInputManager.instance.xb(ma.a.wl,this.Bya,Object(C.a)(this,this.m_g,"onEditKeyUp"))),this.Yjb&&(cd.a.instance.xb(ma.a.click,this.Yjb,Object(C.a)(this,this.h9c,"onGiveFeedbackClick")),A.KeyInputManager.instance.xb(ma.a.wl,this.Yjb,Object(C.a)(this,this.W_g,"onGiveFeedbackKeyUp"))),this.WKa&&(cd.a.instance.xb(ma.a.click,this.WKa,Object(C.a)(this,this.j$c,"onRetryOICClick")),A.KeyInputManager.instance.xb(ma.a.wl,this.WKa,Object(C.a)(this,this.Q1g,"onRetryOICKeyUp"))),super.dispose(),
this.qLa=!0)}}Object(e.a)(Gt,"ProtocolLaunchingDialog",Lh.a,[]);class lv extends Di.StandardDialog{constructor(a){super();this.Gw=a;this.ng="ProtocolLaunchingDialog";u.AFrameworkApplication.pe.tsa&&u.AFrameworkApplication.pe.VXa();u.AFrameworkApplication.Aa.jb.rig&&this.IHd(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(C.a)(this,this.h9c,"onGiveFeedbackClick"));lv.clg?(this.yd=12,this.Ue(1,CommonUIStrings.l_CloseFile),this.Ue(2,CommonUIStrings.l_OICDialogContinueHere),this.Ue(3,CommonUIStrings.l_OICDialogLaunchAgain)):
(this.yd=4,this.Ue(1,CommonUIStrings.l_OICDialogContinueHere),this.Ue(2,CommonUIStrings.l_OICDialogLaunchAgain));this.pCb(CommonUIStrings.l_OICDialog2ndTitle,5===this.Gw.M3g?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(C.a)(this,this.yhc,"protocolLaunchingDialogResultHandler"),null)}h9c(a){Z.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.z_g(a)}j$c(){Z.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");u.AFrameworkApplication.Ta.processAction(F.a.Xfb,
2)}yhc(a){lv.clg?3===a?this.rih():2===a||0===a?this.continueEditing():1===a&&this.closeDocument():2===a?this.rih():(1===a||0===a)&&this.continueEditing()}closeDocument(){Z.ULS.sendTraceTag(577783557,211,50,"Closing the document");u.AFrameworkApplication.Ta.La(F.a.close,2,Li.a)}rih(){Z.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(C.a)(this,this.j$c,"onRetryOICClick"),0)}continueEditing(){4===u.AFrameworkApplication.Aa.jb.mra||u.AFrameworkApplication.fa.ka("WordConsumptionViewToEditRedirectIsEnabled")&&
1===u.AFrameworkApplication.Aa.mode?(Z.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Gw.WXa()):(Z.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Gw.A2b())}static get clg(){return u.AFrameworkApplication.fa.ka("OICDialogThreeActions")&&32===u.AFrameworkApplication.Ta.processAction(F.a.close,1)}}Object(e.a)(lv,"StandardProtocolLaunchingDialog",Di.StandardDialog,[]);var Ht=d(655);class Nw{}Object(e.a)(Nw,"EditDocumentInClientParams",null,[]);
class Sq{static O_f(a,b,c,f,l,x,G=!1,R=!1,fa="",wa=!1,Wa=!1,mb=!1,Kb="",nc="",oc="",Ic=!1){const Kc=new Nw;Kc.DocumentUrl=a;Kc.Mode=b;Kc.Options=c;Kc.Application=f;Kc.SilentExternalHandler=G;Kc.EncodeUrl=R;Kc.CorrelationIdForWinClient=fa;Kc.NavigateUsingWindowOpen=wa;Kc.DescriptiveUnattemptedEnums=Wa;Kc.NoBrowserModalDialogs=mb;Kc.SessionOrigin=Kb;Kc.CorrelationId=nc;Kc.ClickTime=oc;Kc.NewTelemetryDataIsEnabled=Ic;MSOJS.ClientUtils.EditDocumentInClient(Kc,l,x)}}Object(e.a)(Sq,"ClientUtils",null,[]);
var Ih=d(558),k=d(521),B=d(124);class S{constructor(a){this.Aza=this.dNb=this.kMb=null;this.SNb=!1;this.Wyd=this.Ohf=null;this.lrc=this.roa=this.Byc="";this.application=this.vy=0;this.Kkl=this.HQe=!1;this.Izl=a&&u.AFrameworkApplication.fa.ka("OICLaunchDialogIsEnabled");u.AFrameworkApplication.Ta.xS(F.a.Xfb)||u.AFrameworkApplication.Ta.ya(F.a.Xfb,xd.a.frame,Object(C.a)(this,this.rXk,"retryOpenInClientAction"));this.qth=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("SilentExternalHandler")}get M3g(){return this.vy}$7k(a,
b="",c=""){this.roa=c||zh.a.create().toString();this.Byc=b||Ih.a.sdg();this.lrc=a}rXk(a,b,c){return b.contextId!==xd.a.frame?2:1===c?32:this.Xfb()}get options(){let a=0;u.AFrameworkApplication.requiresCheckout&&(a|=1);u.AFrameworkApplication.R3g&&(a|=4);this.Ikl()&&(a|=64);return a}Ikl(){return!(2===this.application&&u.AFrameworkApplication.fa.ka("IsEmbeddedScenario"))}get trb(){return u.AFrameworkApplication.gm}get p8a(){return u.AFrameworkApplication.mN}get Jng(){return""}get u7d(){return""}get Jkl(){return u.AFrameworkApplication.fa.ka("OneNoteMobileViewerIsEnabled")}get Nnl(){return this.Ohf||
(this.Ohf=fb.a.instance.resolve("Common.IOfficeTrialExperience"))}closeApplication(){this.HQe||this.tPi()}WXa(){this.Kkl||this.W2f()}bKk(a){return this.Izl&&r.a.Ki?(new qy(this),32):this.vqb(a)}vqb(a){const b=({EZa:a}=this.cUj(a)).returnValue;Z.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===b,a);return b}begin(a,b,c,f,l,x){this.kMb=a;this.dNb=b;this.Aza=x;this.application=c;this.vy=f;return u.AFrameworkApplication.n_f?(this.QBg(),32):u.AFrameworkApplication.mQ&&!u.AFrameworkApplication.Cmg?
(u.AFrameworkApplication.Tsh(),8):this.VJf(l)}get Tik(){return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",!1)}Xfb(){this.Tik&&this.xXj();return this.vqb(this.SNb)}Mlh(){const a=new k.a(bf.a.openInClient);a.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();a.Values[Ht.a.lWf]=u.AFrameworkApplication.userSessionId;return this.Aza.value.send(a)?32:8}xXj(){vf.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",
["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new mk.a,{inStaging:!0}))}v1k(a){const b=new k.a(bf.a.fCl);b.Values["ui-language"]=u.AFrameworkApplication.lcid.toString();b.Values[Ht.a.lWf]=u.AFrameworkApplication.userSessionId;b.Values[ki.a.eCl]=a;this.Aza.value.send(b)}cUj(a){this.SNb=a;this.v1k(5===this.vy?S.Csk:S.Isk);return 5===this.vy?this.bUj():this.dUj()}bUj(){this.VBg();return{returnValue:32,EZa:"HostEditUrl,"}}dUj(){let a;var b=a="";u.AFrameworkApplication.jEf&&(b="|f|"+u.AFrameworkApplication.userSessionId);
const c=u.AFrameworkApplication.fa.ka("IsAssignmentMode")&&u.AFrameworkApplication.fa.ka("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||u.AFrameworkApplication.v6b||r.a.rEa,f=u.AFrameworkApplication.fa.ka("UnattemptedEnumIsEnabled"),l=u.AFrameworkApplication.fa.ka("NoBrowserModalDialogs");if(u.AFrameworkApplication.Ta.Q7c){var x=u.AFrameworkApplication.Ta.rPc(3588168074);x&&this.$7k(x.epochClickTime,x.sessionOrigin,x.correlationId);this.DDg()}if(u.AFrameworkApplication.n8g){a+="NewOrder,";
x=8;this.Aza&&this.Aza.value&&this.Aza.value.isEnabled()&&u.AFrameworkApplication.lpc&&(a+="Post,",x=this.Mlh());if(32===x)return{returnValue:x,EZa:a};Z.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return u.AFrameworkApplication.pu.Xva?(Z.ULS.shipAssertTag(5566816,211,!!u.AFrameworkApplication.pu.Xva),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Aa.mO(!0,u.AFrameworkApplication.pu.Xva),EZa:a}):this.kMb?(Z.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
u.AFrameworkApplication.userSessionId),a+="DocUrl,",Sq.O_f(this.kMb,this.vy,this.options,this.application,Object(C.a)(this,this.l_g,"onEditInClientSuccess"),Object(C.a)(this,this.k_g,"onEditInClientFailure"),this.qth,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.Byc,this.roa,this.lrc,u.AFrameworkApplication.Ta.Q7c),{returnValue:32,EZa:a}):{returnValue:8,EZa:a}}a+="OldOrder,";if(!this.kMb&&u.AFrameworkApplication.pu.Xva)return this.Aza&&this.Aza.value&&this.Aza.value.isEnabled()&&
u.AFrameworkApplication.lpc?(a+="Post,",b=this.Mlh()):(Z.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),b=8),32!==b?(Z.ULS.shipAssertTag(22595484,211,!!u.AFrameworkApplication.pu.Xva),a+="HostUrl,",{returnValue:u.AFrameworkApplication.Aa.mO(!0,u.AFrameworkApplication.pu.Xva),EZa:a}):{returnValue:b,EZa:a};Z.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",u.AFrameworkApplication.userSessionId);a+="DocUrl,";Sq.O_f(this.kMb,
this.vy,this.options,this.application,Object(C.a)(this,this.l_g,"onEditInClientSuccess"),Object(C.a)(this,this.k_g,"onEditInClientFailure"),this.qth,u.AFrameworkApplication.fa.ka("OICEncodeUrlIsEnabled"),b,c,f,l,this.Byc,this.roa,this.lrc,u.AFrameworkApplication.Ta.Q7c);return{returnValue:32,EZa:a}}AUk(a){u.AFrameworkApplication.ej.setDw(8981,a)}l_g(a){this.AUk(a);Z.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");6===a&&MSOJS.ClientUtils.ShouldShowDialog()?(this.Jkl||this.VBg(),this.DDg()):
this.HQe||this.closeApplication()}k_g(a,b=0){Z.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",a,b);if(5===a)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{const c=!!this.dNb&&!this.SNb;let f=0;1===a&&(f=2);6<=a&&13>=a&&(f=1,1===b&&(this.HQe=!0));this.Nnl.Oik?(Z.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",f),Mw.a.instance.kBi(this.SNb?Object(C.a)(this,this.lYg,"oicErrorDialogHandlerCloseForced"):
Object(C.a)(this,this.mYg,"oicErrorDialogHandlerNoCloseForced"),c?Object(C.a)(this,this.w0g,"onLaunchDownload"):null,this.WYf(!1)?Object(C.a)(this,this.Cvj,"iHaveOfficeButtonHandler"):null,f,b)):(Z.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",f),Mw.a.instance.iBi(this.SNb?Object(C.a)(this,this.lYg,"oicErrorDialogHandlerCloseForced"):Object(C.a)(this,this.mYg,"oicErrorDialogHandlerNoCloseForced"),c?Object(C.a)(this,this.w0g,"onLaunchDownload"):null,f))}}DDg(){try{const a=
[Object.assign(new B.a,{name:"CorrelationId",string:this.roa}),Object.assign(new B.a,{name:"SessionOrigin",string:this.Byc}),Object.assign(new B.a,{name:"ClickTime",string:this.lrc}),Object.assign(new B.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];on.a("OpenInClientCompleted",!0,0,a)}catch(a){Z.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+a.toString())}}VBg(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.gC&&u.AFrameworkApplication.fa.ka("StandardProtocolDialogIsEnabled")?
new lv(this):new Gt(this)}lYg(){this.closeApplication()}mYg(){this.WXa()}w0g(){this.QBg()}Cvj(){return this.WYf(!0)}WYf(a){const b=(r.a.xSa||r.a.io)&&!!u.AFrameworkApplication.hIc;b&&a&&(ib.a.an(u.AFrameworkApplication.hIc,"_blank",void 0,"OpenInClient"),this.closeApplication());return b}}S.Isk="OpenInDesktop";S.Csk="OpenInBrowser";Object(e.a)(S,"AOpenInClientOperation",null,[]);class na extends S{constructor(a,b,c=!1){super(c);this.pPh=a;this.oPh=b}get Jng(){return this.oPh}get u7d(){return this.pPh}tPi(){u.AFrameworkApplication.Ta.La(F.a.close,
2,Li.a)}W2f(){}VJf(a){return this.bKk(a)}QBg(){Z.ULS.shipAssertTag(5566817,211,!!this.dNb);u.AFrameworkApplication.Cca?u.AFrameworkApplication.Aa.mO(!0,this.dNb):ib.a.an(this.dNb,void 0,void 0,"LaunchDownload")}A2b(){u.AFrameworkApplication.Aa.jb.A2b()}}Object(e.a)(na,"OpenInClientOperation",S,[]);class Ja extends na{constructor(a,b,c,f){super("PowerPoint_32x32x32","EditInPowerPointWebApp_32x32x32");if(!a)throw Error.argumentNull("pathManager");this.JNg=b;this.fe=a;this.wq=c;this.ia=f}get trb(){return this.fe.hk(this.p8a+
".png")}get p8a(){return"prt2"}VJf(a){return this.JNg?this.JNg(a):this.vqb(a)}W2f(){Aa.a.J(512496860,801,50,"OpenInPowerPointOperation - restarting edit session");this.ia.La(ba.a.refresh,2,{refreshtrigger:"OpenInPowerPointOperation::ExecuteRestartApplication"})}vqb(a){this.wq.v5b=!0;return super.vqb(a)}}Object(e.a)(Ja,"OpenInPowerPointOperation",na,[]);class $a{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te){this.LJg=null;this.$D=x;this.ia=a;this.Fa=b;this.ra=c;this.fe=f;this.INg=
new Ja(this.fe,Object(C.a)(this,this.Rdi,"beginSaveBeforeOpenInClient"),mb,a);G.execute(We=>{this.LJg=new Sa.a(()=>We)});this.k2j=l;this.zu=R;this.dck=fa;this.ua=wa;this.Xb=Wa;this.Ha=Kb;this.Xa=nc;this.Hda=oc;this.Ob=Ic;this.Md=Kc;this.Bm=Hc;this.uv=ie;this.Vbb=He;this.n9=fe;this.cO=Te}ub(){this.ia.ya(ba.a.openInClient,sc.a.application,Object(C.a)(this,this.N3g,"openExternal"));this.ia.ya(F.a.fze,sc.a.application,Object(C.a)(this,this.N3g,"openExternal"));this.ia.ya(ba.a.convertAndEdit,sc.a.application,
Object(C.a)(this,this.iwi,"convertBinaryFormat"));this.ia.ya(ba.a.repair,sc.a.application,Object(C.a)(this,this.XTk,"repairCorruptedFile"));this.ia.ya(ba.a.Hjc,sc.a.application,Object(C.a)(this,this.Hjc,"replaceOriginalFile"));this.ia.ya(ba.a.zGb,sc.a.application,Object(C.a)(this,this.zGb,"saveRepairedFile"));this.ia.ya(ba.a.lZb,sc.a.application,Object(C.a)(this,this.lZb,"editAnyway"));this.ia.ya(ba.a.m2b,sc.a.application,Object(C.a)(this,this.m2b,"goToEditMode"));this.ia.he(ba.a.openInClient,12288)}Rdi(a){if(this.Bm.isPaused)return this.Fa.Ad(),
this.JIe(a),32;this.ra.Uh();this.Fa.Ad();if(1===this.Ob.mode&&this.Ha.isReadOnlyFilesForceEditingViaOICDisabled)return this.K5f(a),32;this.$D.G2(a,!0,()=>{this.JIe(a)},()=>{this.JIe(a);return!0},3);this.zu.show(!1,"OpenInClient");return 32}JIe(a){this.zu.hide();this.K5f(a)}K5f(a){Nc.a.Kmd();this.INg.vqb(a)}N3g(a,b,c){if(b.contextId!==sc.a.application)return 2;b=!(!this.fe.documentUrl&&!this.k2j.Xva&&!u.AFrameworkApplication.lpc);if(1===c)return b?32:8;if(!b)return 8;this.qZj();if(this.Xb.Zc(this.dck.yf))return 16;
a=a===F.a.fze?5:2;1===this.Ob.mode&&this.Ha.isReadOnlyFilesForceEditingViaOICDisabled&&(a=1);return this.INg.begin(this.fe.documentUrl,u.AFrameworkApplication.vPa,3,a,this.Ha.QLj,this.LJg)}qZj(){try{let a="";const b=this.ua.Tj;b&&(a=b.toString());Aa.a.J(18956688,801,50,"User clicked OpenInClient. Slide index: {0}. Slide stats:{1}",this.ua.currentSlideIndex,a)}catch(a){Aa.a.J(18956690,801,10,"Exception caught while logging slide stats for OpenInClient: {0}",a)}}iwi(a,b,c){Aa.a.J(24130758,801,50,"PowerPointAppFrameCommandUIActor - ConvertBinaryFormat");
if(b.contextId!==sc.a.application)return 2;if(1===c)return 32;const f=Object.assign(new Lw,{PodEndpointUrl:this.Ha.podsWebServiceBase,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string});this.Hda.hod(f,Object(C.a)(this,this.Trk,"onUploadConvertedFileToHostSucceeded"),l=>{this.Srk(l,f.PodSessionID)});this.zu.NOe(!0,ResourceStrings.L_FileConverting,a);return 32}Trk(a){Aa.a.J(24130760,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded");this.zu.hide();
if(this.Ob)if(a=a.result,a.EditUrl){var b=!1,c=!1,f=!1;u.AFrameworkApplication.fa&&(b=u.AFrameworkApplication.fa.ka("IsUIEmbedMode"),c=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"),f=u.AFrameworkApplication.fa.ka("UiHostSupportsPPTConvertScenarios"));if(b&&c&&f){Aa.a.J(589312029,801,50,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded Sending DocumentRefresh post message.");const l={};l[ki.a.sFb]="1";l[ki.a.documentUrl]=a.EditUrl;l[ki.a.mode]="edit";l[ki.a.reason]=
bw.a.convert;u.AFrameworkApplication.ES().execute(x=>{x.sendMessage(bf.a.KBa,l)})}else this.Ob.mO(!0,a.EditUrl)}else Aa.a.J(24130764,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no EditUrl");else Aa.a.J(24130762,801,15,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostSucceeded no available app frame")}Srk(a,b){a=Jf.a.SM(a.error.Pm);Aa.a.J(24130766,801,10,"PowerPointAppFrameCommandUIActor - OnUploadConvertedFileToHostFailed error: {0}",a);this.zu.hide();
a=Object.assign(new bg.a,{Code:a,Source:5});this.Md.es(a,b,c=>{c.NB=1;c.WAa=6;c.title=ResourceStrings.L_FileConversionTitle;c.message=ResourceStrings.L_FileConversionError;return!1})}XTk(a,b,c){if(b.contextId!==sc.a.application)return 2;if(1===c)return 32;Aa.a.J(25011969,801,50,"PowerPointAppFrameCommandUIActor - Start to repairCorruptedFile");this.ZTk();return 32}ZTk(){const a=new Date;Aa.a.J(42858700,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Starting Document repair. Start-time {0}",
a);const b=Nc.a.Pl("PowerPointAppFrameCommandUIActor.InlineDocumentRepair");this.cO.Gpb(()=>{Aa.a.J(50677722,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closed the pop session early that was triggered due to late detection (after open early success) of corruption. To avoid lock mismatch while writing to host for overwrite case is the reason we do proactively.")},()=>{Aa.a.J(50677724,801,15,"PowerPointAppFrameCommandUIActor::RepairFileInline: Closing the pop session early failed. This might lead to overwrite the file  issues with a lock mismatch error.")});
this.Vbb.zgh(b,()=>{Aa.a.J(42858702,801,50,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Successfull,Time-Taken {0}",+new Date-+a);b.finish();this.yql()},c=>{Aa.a.J(42858704,801,10,"PowerPointAppFrameCommandUIActor::RepairFileInline: Operation Failed,Time-Taken {0}, Error: {1}",+new Date-+a,c);b.finish();this.CDk(c,this.Xa.podSessionId);return!0})}yql(){var a={failedMachineId:null,isPlanedShutdown:!1};a.podSessionId=this.Xa.podSessionId;a.fromInlineDocumentRepair=!0;this.uv.BKe();
a=this.ia.La(ba.a.xFb,2,a);Aa.a.J(42858706,801,50,"PowerPointAppFrameCommandUIActor::TriggerDocRefresh: Response-{0}",a)}CDk(a,b){a=Object.assign(new bg.a,{Code:a,Source:5});this.Md.es(a,b,c=>{c.NB=1;c.WAa=52;c.title=ResourceStrings.l_RepairFailDialogTitle;c.message=ResourceStrings.l_RepairFailedMessage;return!1})}lZb(a,b,c,f,l){if(b.contextId!==sc.a.application)return 2;if(1===c)return 32;Aa.a.J(38290632,801,50,"PowerPointAppFrameCommandUIActor - EditAnyway");a=this.uv.jtb();0!==a&&(Aa.a.J(593268952,
801,15,"PowerPointAppFrameCommandUIActor::EditAnyway - Creating Pop session as emergencyViewModeEnabledReason: {0}",a),this.dVf());if(20===l)this.uv.kwl();else return Aa.a.J(38290634,801,10,"PowerPointAppFrameCommandUIActor - Unexpected EditAnyway operation"),8;return 32}zGb(a,b,c,f,l){if(b.contextId!==sc.a.application)return Aa.a.J(42823955,801,15,"PowerPointAppFrameCommandUIActor - SaveRepairedFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return this.ia.processAction(l,
1);Aa.a.J(42823957,801,50,"PowerPointAppFrameCommandUIActor - SaveRepairedFile - saveAsActionId : {0}",l);this.dgg(1,l);return 32}dgg(a,b){Aa.a.J(42823959,801,50,"GetSnappedDownloadUrl for saving the repaired file");const c=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.Ha.podsWebServiceBase,this.Xa.podSessionId),f={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;const l=new Date;
u.AFrameworkApplication.Ge.yj(c,1,"",f,!1,0,x=>{this.Exe(x,l,b)},x=>{this.Dxe(x,a,b)},null,null)}Exe(a,b,c){Aa.a.J(42823961,801,50,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+b);a=JSON.parse(a.data.Sd).downloadUrl;Ka.a.Va(a)?(Aa.a.J(42823963,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty"),this.huh()):(b={SkipSaveToHost:"true"},b.FileDownloadUrl=a,this.ia.La(c,2,b))}Dxe(a,b,c){a=a.data?a.data.Le:
-1;a===dq.a.vdi&&0<b--?(Aa.a.J(42823965,801,15,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",a),this.dgg(b,c)):(Aa.a.J(42823967,801,10,"PowerPointAppFrameCommandUIActor - OnGettingSnappedUrlFailed : HttpStatus: {0} , SaveAsActionId : {1}",a,c),this.huh())}huh(){const a=Object.assign(new bg.a,{Code:20,Source:6});this.Md.es(a,this.Xa.podSessionId,b=>{b.NB=1;b.WAa=1;b.title=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogTitle;
b.message=ResourceStrings.L_BizBarInlineRepairSaveAsFailedDialogMessage;return!1})}Hjc(a,b,c){if(b.contextId!==sc.a.application)return Aa.a.J(50677769,801,15,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile. Context id don't match with Application. ContextId: {0}",b.contextId),2;if(1===c)return a=u.AFrameworkApplication.fa.Ga("DocumentPermissions")||"",b=this.Xa.A4g&&-1<a.indexOf("W"),Aa.a.J(51127232,801,b?50:15,"PowerPointAppFrameCommandUIActor::ReplaceOriginalFile- InlineRepairedFile case: IsReplaceRepairedEnabled : {0}, Document Permission : {1} ",
this.Xa.A4g,a),b?32:8;Aa.a.J(50677771,801,50,"PowerPointAppFrameCommandUIActor - ReplaceOriginalFile");this.Xa.Bk=this.n9.G6a(this.Xa.presentationId.string);a=Object.assign(new An.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ha.podsWebServiceBase,PopSessionID:this.Xa.Bk,UrlOverrides:this.Ha.Dea,IsCreateNewSession:this.Ha.NS,UseSharedHostFile:this.Ha.VKb});this.n9.QDc(a,()=>{this.Vlk()},Object(C.a)(this,
this.sDb,"onEnsureHostSessionFailed"),0,!0);return 32}Vlk(){Aa.a.J(50677773,801,50,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccess");this.uv.CVk();this.Xa.SVk();0!==this.uv.jtb()&&this.uv.CKe(!1)}sDb(){Aa.a.J(50677775,801,10,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionFailed");this.uv.BKe();0!==this.uv.jtb()&&this.uv.CKe(!0);return!1}m2b(a,b,c){if(b.contextId!==sc.a.application)return Aa.a.J(593297441,801,15,"PowerPointAppFrameCommandUIActor - GoToEditMode. Context id don't match with Application. ContextId: {0}",
b.contextId),2;if(1===c)return 32;a=new Date;this.dVf();Aa.a.J(593268936,801,15,"PowerPointAppFrameCommandUIActor::GoToEditMode. Time-Taken to create pop session : {0}",+new Date-+a);return 32}dVf(){this.Xa.Bk=this.n9.G6a(this.Xa.presentationId.string);const a=Object.assign(new An.a,{ForceCreatePods:!1,DoRehydrate:!1,IsRetrySession:!1,PodSessionID:this.Xa.podSessionId,PresentationID:this.Xa.presentationId.string,PodEndpointUrl:this.Ha.podsWebServiceBase,PopSessionID:this.Xa.Bk,UrlOverrides:this.Ha.Dea,
IsCreateNewSession:this.Ha.NS,UseSharedHostFile:this.Ha.VKb});this.n9.QDc(a,()=>{this.Wlk()},null,15,!0);this.uv.CKe(!1)}Wlk(){Aa.a.J(593297435,801,15,"PowerPointAppFrameCommandUIActor - OnEnsureHostSessionSuccessForEmergencyViewMode")}}Object(e.a)($a,"PowerPointAppFrameCommandUIActor",null,[]);var xb=d(497);class dc{constructor(a,b,c){this.wFg=a;this.w_=b;this.Xme=c}show(a,b){this.Xme?(b=new xb.a(b),b.message=ResourceStrings.l_Saving,b.Rvg=!0,b.rIb=a,this.w_.hIa(b)):this.NOe(a,ResourceStrings.l_Saving,
b)}NOe(a,b,c){this.Xme?(c=new xb.a(c),c.message=b,c.rIb=a,this.w_.hIa(c)):this.wFg.uIb(b,a,0,0,c)}hide(){this.Xme?this.w_.hIa(Object.assign(new xb.a(null),{Qvg:!0})):this.wFg.dRc()}}Object(e.a)(dc,"SaveBlockingUI",null,[1178]);var Cc=d(235);class Vc{constructor(a,b,c,f,l,x,G,R,fa){this.Z$b=Cb.App.Mm;this.NMg=Ga.a.nil;this.yb=a;this.ua=b;this.Mc=c;this.Hk=f;this.nL=l;this.m4c=x;this.WA=R;this.Ws=G;this.T6j=fa.QZk;this.I7j=fa.pptNotShowSavingStatusOfProofingOnlyRevision;this.Mc.IB(Object(C.a)(this,
this.gB,"onSessionEnd"));this.Hk.CId(Object(C.a)(this,this.pEh,"updateSavingStatus"));this.Hk.yFf(Object(C.a)(this,this.oEh,"updateSavedStatus"));this.Ws.JM(Object(C.a)(this,this.Qna,"updateSaveStatusDisplay"));this.tbk=new xe.a(3,1,fa.PZk,Object(C.a)(this,this.updateSaveStatusText,"updateSaveStatusText"),90,"28");this.XSa=!1;this.E8j=fa.powerPointTextEditOnlyMode}initialize(){this.Qna(this.Ws)}oEh(){this.XSa||this.WA.l8||this.WA.ezg||(this.yb.Cb(this.tbk),this.XSa=!0)}pEh(a,b){this.WA.l8||this.WA.ezg||
(this.I7j&&Vc.ONj(b.node)||this.m4c.updateSaveStatusText(!1),this.Z$b=new Date,this.NMg=b?b.revisionId:Ga.a.nil)}updateSaveStatusText(){this.XSa=!1;const a=!this.nL.kW(this.ua.presentation);this.m4c.updateSaveStatusText(a);a&&(this.Kgh(0,0),this.Z$b=Cb.App.Mm);this.E8j&&Vc.zwl(a)}Qna(a){this.m4c.Qna(!1,1===a.mode?1:3)}gB(a,b){this.m4c.updateSaveStatusText(!0);this.Kgh(1,b.vJ);this.Z$b=Cb.App.Mm}Kgh(a,b){if(this.Z$b!==Cb.App.Mm){var c=+new Date-+this.Z$b;c>=this.T6j&&(c=String.format("SavingTime {0};Type {1};Revision {2};",
c,a,this.NMg),1===a&&(c+=String.format("CloseReason {0};",b)),Aa.a.J(21604228,811,50,c))}}dispose(){this.Mc.Oea(Object(C.a)(this,this.gB,"onSessionEnd"));this.Hk.hGe(Object(C.a)(this,this.pEh,"updateSavingStatus"));this.Hk.Hfh(Object(C.a)(this,this.oEh,"updateSavedStatus"));this.Ws.QX(Object(C.a)(this,this.Qna,"updateSaveStatusDisplay"))}static zwl(a){const b=document.getElementById("TipStatus"),c=document.getElementById("TipStatusIcon"),f=document.getElementById("TipStatusText");b.style.display=
"block";a?(c.setAttribute("class","TipStatusSaved"),f.innerText=ResourceStrings.l_SavedShort):(c.setAttribute("class","TipStatusLoading"),f.innerText=ResourceStrings.l_SavingShort)}static ONj(a){return a.Sa(sb.a.ecd)&&!a.Sa(Cc.a.sgd)}}Object(e.a)(Vc,"SaveStatusManager",null,[106]);class sd{constructor(){this.K=null;this.wne=!1}get name(){return"PowerPointWebEditor.Actors"}Wb(a){(new Jw).Wb(a);this.K=a;a.register($a,"PowerPointWebEditor.PowerPointAppFrameCommandUIActor").ma().na(()=>new $a(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPoint.IPathManager"),a.resolve("Common.IDocPropertiesProvider"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.Ka("Postmessage.IHostPostmessenger"),a.resolve("PowerPointWebEditor.ISaveBlockingUI"),a.resolve("PowerPointWebEditor.IPPTWorkspaceGraph"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopWebService"),a.resolve("Box4.IAppFrame"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPodSessionCoreManager"),a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionCoreManager"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager")));a.register(1178,"PowerPointWebEditor.ISaveBlockingUI").ma().na(()=>new dc(new Kw(new ns(a.resolve("PowerPointWebEditor.IPaneManager").xa,"SaveBlockingUI",!0),a.resolve("PowerPointWebEditor.IActionNameResolver")),a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").wxg));a.register(Vc,"PowerPointWebEditor.SaveStatusManager").ma().na(()=>new Vc(a.resolve("Common.ITaskManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Common.App.SaveStatus.ISaveStatusUIHandler"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")))}init(){(this.wne=this.K.resolve("PowerPointWebEditor.IApplicationSettings").sNj)&&
this.K.resolve("PowerPointWebEditor.SaveStatusManager").initialize();this.K.resolve("PowerPointWebEditor.PowerPointAppFrameCommandUIActor").ub();this.K.resolve("Common.IOfficeTrialExperience").ub();this.K.resolve("Common.IMacOfficeOffer").ub()}dispose(){this.wne&&this.K.resolve("PowerPointWebEditor.SaveStatusManager").dispose()}static main(){m.a.instance.Bc(new sd)}}Object(e.a)(sd,"PowerPointActorsPackage",null,[2,3]);var ve=d(1004),Ne=d(1069);class If{constructor(){this.wNa=this.WR=this.qza=null;
this.Swf=!1;this.PXe=null;this.QXe=this.$Pb=0}get messageId(){return this.qza}get values(){return this.WR}get userSessionId(){return this.wNa}get shouldRetry(){return this.Swf}get vAc(){return this.PXe}get xva(){return this.$Pb}get $_h(){return this.QXe}static kCi(a,b){var c=bf.a.AFi;const f=new If;f.qza=a;f.WR={};f.wNa=b;f.Swf=!0;f.PXe=c;f.$Pb=3;f.QXe=1E3;return f}}Object(e.a)(If,"PostMessageData",null,[]);class nh{constructor(a,b,c){this.OEd={};this.eb=a;this.vvd=c;this.DWj();this.nMk(b)}DWj(){if(this.eb.ka("DocRebootIsSupported")||
this.eb.ka("UiHostSupportsDocRebootFeatures"))this.OEd[Ne.a.refresh]=()=>this.j1k(bf.a.KBa)}nMk(a){a.ya(F.a.Jah,xd.a.frame,Object(C.a)(this,this.L0k,"sendActionToHostIfSupported"))}L0k(a,b,c,f,l){if(2!==c)return 32;if(!l)return Z.ULS.sendTraceTag(41972610,204,15,"HostActionExecutionManager - No actionData provided"),16;a=l.toLowerCase();return this.OEd[a]?(Z.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",a),this.OEd[a]()):2}j1k(a){const b=If.kCi(a,
u.AFrameworkApplication.userSessionId);this.vvd.execute(c=>{c.postMessage(b)});return 32}}Object(e.a)(nh,"HostActionExecutionManager",null,[]);var fh=d(115),$i=d(712);class hi extends Ht.a{constructor(a,b,c,f){super(a,b,c);this.pOb=this.h6=0;this.Z6e=!1;this.rOb=0;this.uvd=this.Otc=null;this.$6e=this.a7e=!1;this.Ca=f;this._name="HostIntegrationMessenger";this.create()}avj(a){const b=a.message,c=a.Vi.origin;u.AFrameworkApplication.wopiHostOriginFromPostMessage||(u.AFrameworkApplication.wopiHostOriginFromPostMessage=
c);switch(b.MessageId){case bf.a.NLd:case bf.a.PLd:this.Vuj(b);break;case bf.a.L4d:case bf.a.M4d:this.Rmd();break;case bf.a.U6d:this.cvj(b);break;case bf.a.N9a:this.aTj(b);break;case bf.a.BWe:this.Idi(a);break;case bf.a.FWe:this.dul()}}Btl(a){switch(a.MessageId){case bf.a.Q6d:u.AFrameworkApplication.Ta.La(F.a.Bfd,2,a.Values[ki.a.direction]);break;case bf.a.Nub:Z.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received");u.AFrameworkApplication.Ta.La(F.a.Nub,2,(new Date).getTime());break;case bf.a.R6d:Z.ULS.sendTraceTag(544221062,
204,50,"We received HostBackButtonPressed message in WAC");break;case bf.a.S6d:Z.ULS.sendTraceTag(543459140,204,50,"Host_GetClientUrl Recieved");u.AFrameworkApplication.Ta.processAction(F.a.Z0i,2);break;case bf.a.q3b:Z.ULS.sendTraceTag(541894173,204,50,"Host_CopyLink Recieved");u.AFrameworkApplication.Ta.processAction(F.a.q3b,2);break;case bf.a.T6d:Z.ULS.sendTraceTag(539760468,204,50,"Host_GetWebUrl Received");u.AFrameworkApplication.Ta.processAction(F.a.Tjj,2);break;case bf.a.X6d:Z.ULS.sendTraceTag(537424842,
204,50,"Host_SendChannelId Received")}}Rmd(){v.FocusManager.instance()&&v.FocusManager.instance().ze&&v.FocusManager.instance().ze.name===u.AFrameworkApplication.Eeb&&v.FocusManager.instance().R4(v.FocusManager.instance().ze.name)}Vuj(a){v.FocusManager.instance().NX(u.AFrameworkApplication.Eeb,!1);if(ki.a.Jlc in a.Values){const b={};b[ki.a.Jlc]=a.Values[ki.a.Jlc];Z.ULS.sendTraceTag(38278996,204,50,Yd.c(b))}}cvj(a){if(!Ze.a.BS(document.URL,u.AFrameworkApplication.n7c)&&a.Values){var b=0,c=0;try{b=
a.Values[ki.a.dvj],c=a.Values[ki.a.evj],ki.a.Hmg in a.Values?this.Otc=a.Values[ki.a.Hmg]:ki.a.Jmg in a.Values&&(this.Otc=a.Values[ki.a.Jmg]),ki.a.Kmg in a.Values&&(this.uvd=a.Values[ki.a.Kmg])}catch(f){return}this.pOb=b;this.rOb=c;this.h6&&this.pDg()}}aTj(a){Z.ULS.sendTraceTag(37536415,204,50,"JsApiDiagnostics");var b=a.Values[ki.a.$uj];b&&Gh.a.instance.TKk(b);(b=a.Values[ki.a.HOd])&&Gh.a.instance.GKk(b);(a=a.Values[ki.a.N9a])&&Gh.a.instance.YKk(a)}Idi(a){Z.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",
Date.now());u.AFrameworkApplication.$5b=!0;u.AFrameworkApplication.Aa.O0.ywe(a.Vi.mc)}dul(){Z.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now());u.AFrameworkApplication.Aa.O0.aye(null,Sys.EventArgs.Empty)}pDg(){this.EYj();this.FYj();null!=this.Otc&&Gh.a.instance.UKk(this.Otc);null!=this.uvd&&Gh.a.instance.VKk(this.uvd)}EYj(){this.h6&&this.pOb&&!this.Z6e&&(this.Z6e=!0,this.pOb>this.h6||(u.AFrameworkApplication.ej.setDw(10324,this.h6-this.pOb),Gh.a.instance.Mch(this.pOb)))}FYj(){this.h6&&
this.rOb&&!this.a7e&&(this.a7e=!0,this.rOb>this.h6||(u.AFrameworkApplication.ej.setDw(10325,this.h6-this.rOb),Gh.a.instance.zLk(this.rOb)))}yUk(){var a=ib.a.Whg();if(a){var b=0;a=a.fetchStart;void 0!==a&&null!==a&&(b=a);0>=b||b>this.h6||u.AFrameworkApplication.ej.setDw(11045,this.h6-b)}}create(){u.AFrameworkApplication.xug&&this.disable();this.OJa!==$i.a.sUb&&this.LAc(this.OJa);this.Ca.pa(F.a.yJi,xd.a.frame,Object(C.a)(this,this.DJi,"disposeInstance"),96);this.fu(bf.a.NLd);this.fu(bf.a.PLd);this.fu(bf.a.L4d);
this.fu(bf.a.M4d);this.fu(bf.a.U6d);this.fu(bf.a.W6d);this.fu(bf.a.OJd);const a=Object(C.a)(this,this.avj,"hostMessageHandler");this.DXa(bf.a.NLd,a);this.DXa(bf.a.PLd,a);this.DXa(bf.a.L4d,a);this.DXa(bf.a.M4d,a);this.DXa(bf.a.U6d,a);u.AFrameworkApplication.fa.ka("OneNoteEmbedUnloadIsEnabled")&&(this.FCf(bf.a.BWe),this.FCf(bf.a.FWe),this.DXa(bf.a.BWe,a),this.DXa(bf.a.FWe,a));if(u.AFrameworkApplication.fa.ka("PostMessageEmbedded")||u.AFrameworkApplication.fa.ka("IsJsApi")){this.fu(bf.a.Nub);const b=
Object(C.a)(this,this.Btl,"uiHostMessageHandler");u.AFrameworkApplication.fa.ka("SupportsAccessibilityLoop")&&(this.fu(bf.a.Q6d),this.kB(bf.a.Q6d,b));this.kB(bf.a.Nub,b);u.AFrameworkApplication.fa.ka("MobileEmbedViewerIsEnabled")&&(this.fu(bf.a.S6d),this.kB(bf.a.S6d,b),this.fu(bf.a.R6d),this.kB(bf.a.R6d,b),this.fu(bf.a.q3b),this.kB(bf.a.q3b,b),this.fu(bf.a.T6d),this.kB(bf.a.T6d,b));u.AFrameworkApplication.fa.ka("OneNotePageLevelConversationInTeamsIsEnabled")&&(this.fu(bf.a.X6d),this.kB(bf.a.X6d,b))}u.AFrameworkApplication.fa.ka("IsJsApi")&&
(this.fu(bf.a.N9a),this.DXa(bf.a.N9a,a))}DJi(a,b,c){if(2!==c)return 32;fh.a.rx(this);return 32}reportDocumentLoadedTime(a){this.$6e||(this.h6=a,this.yUk(),this.OJa!==$i.a.sUb&&this.sendMessage(bf.a.H$h,{["DocumentLoadedTime"]:a}),this.pDg(),this.$6e=!0)}}Object(e.a)(hi,"HostIntegrationMessenger",Ht.a,[865,626,106]);class Ck{constructor(){this.Da=null}get name(){return"Common.App.Postmessengers"}init(){u.AFrameworkApplication.fa.ff(()=>{this.X7d(this.Da)})}X7d(a){u.AFrameworkApplication.dQ=a.resolve("Common.App.Postmessengers.HostIntegrationMessenger");
u.AFrameworkApplication.fa.ka("HostActionExecutionIsEnabled")&&a.resolve("Common.App.HostActionExecutionManager")}dispose(){}Wb(a){this.Da=a;a.register(hi,"Common.App.Postmessengers.HostIntegrationMessenger").as("Postmessage.IHostPostmessenger").ma().na(()=>{u.AFrameworkApplication.fa.Eca||Z.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");const b=u.AFrameworkApplication.xma?u.AFrameworkApplication.xma:$i.a.sUb;Z.ULS.sendTraceTag(536987587,204,
50,"HostIntegrationMessenger instantiating");return new hi(window.parent,b,ve.a.instance,u.AFrameworkApplication.Ta)});a.register(nh,"Common.App.HostActionExecutionManager").ma().na(()=>{u.AFrameworkApplication.fa.Eca||Z.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready");return new nh(u.AFrameworkApplication.fa,u.AFrameworkApplication.Ta,a.Ka("Postmessage.IHostPostmessenger"))})}}Object(e.a)(Ck,"PostmessengersPackage",null,[2,3]);var gh=d(396),
wj=d(346),Mi=d(290),Ef=d(221);class hp extends Ef.a{constructor(){super();this.PersonaId=this.DisplayName=null;this.IsAnonymous=!1}get ControlType(){return 4}}Object(e.a)(hp,"PersonaButtonProps",Ef.a,[]);class Lm{JXb(a,b){if(a&&!(1>a.length)&&b){var c=Object.assign(new Mi.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.wzi(a,c.ControlList);b.push(c)}}wzi(a,b){const c=Object.assign(new gh.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new wj.a,
{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(b,c);b=Object.assign(new Mi.a,{Title:"",ControlList:[]});Array.add(c.Menu.MenuSectionList,b);this.FBi(a,b.ControlList)}FBi(a,b){for(let c=0;c<a.length;c++){const f=Object.assign(new hp,{ExternalId:String.format("CoauthorPersona_{0}",c),Command:"336231556",DisplayName:a[c].userName,LabelText:a[c].userName,ImageBackColor:a[c].color,PersonaId:a[c].email,IsAnonymous:a[c].isAnonymous});Array.add(b,f)}}}
Object(e.a)(Lm,"PresenceContextMenuSectionBuilder",null,[541]);var Mm=d(345);class mo{constructor(a,b,c,f){this.CY=this.Wn=this.Lm=this.uf=this.ioa=null;this.Pyc=a;this.AXh=f;this.Pyc.T9d&&(this.Lm=new xe.a(3,2,5E3,Object(C.a)(this,this.Xci,"authenticationCheckTask"),2),u.AFrameworkApplication.pe.Cb(this.Lm),this.ub(b,c));this.Pyc.V4h(()=>{this.rec()});this.Pyc.GEf(()=>{this.sec()})}get businessBar(){return this.Wn||(this.Wn=fb.a.instance.qb("CommonUI.IBusinessBar"))}get ELf(){return this.CY||(this.CY=
fb.a.instance.qb("CommonUI.IBusinessBarEntryFactory"))}ub(a,b){const c=u.AFrameworkApplication.Ta;c.pa(F.a.yJf,xd.a.frame,a,96);c.pa(F.a.zJf,xd.a.frame,b,96);c.ya(F.a.ZNf,xd.a.frame,Kd.ActionManager.$u);c.ya(F.a.$Nf,xd.a.frame,Kd.ActionManager.$u);c.ya(F.a.Tde,xd.a.frame,Kd.ActionManager.$u)}rec(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);u.AFrameworkApplication.Ta.processAction(F.a.yJf,2)}sec(){this.Oml();u.AFrameworkApplication.Ta.processAction(F.a.zJf,2)}Xci(){this.Pyc.authenticationCheck()}Oml(){this.uf&&
(this.uf.hide(),this.uf.dispose(),this.uf=null);this.ioa&&this.businessBar&&(u.AFrameworkApplication.Vg||this.businessBar.removeEntry(this.ioa),this.ioa.dispose(),this.ioa=null)}showDialog(a){fh.a.rx(this.uf);this.uf=new Di.StandardDialog;this.AXh||(this.uf.qr=!1,this.uf.yd=0);this.uf.Ue(1,CommonUIStrings.l_SignIn);this.uf.DO(CommonUIStrings.l_DefaultDialogTitle,a,Object(C.a)(this,this.t2,"dialogHandler"))}t2(a){1===a?(Mm.a.Pad(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),
u.AFrameworkApplication.Ta.processAction(F.a.Tde,2)):(this.Scl(),u.AFrameworkApplication.Ta.processAction(F.a.$Nf,2))}Scl(){this.businessBar&&this.ELf&&(this.ioa=this.ELf.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.ioa.closeable=!0,this.ioa.addButton(CommonUIStrings.l_SignIn,mo.Jhi,""),this.ioa.i2=Object(C.a)(this,this.Khi,"businessBarEntryCloseHandler"),this.businessBar.Wh(this.ioa,!1))}Khi(){this.PIi();u.AFrameworkApplication.Ta.processAction(F.a.ZNf,
2)}PIi(){this.Lm&&(u.AFrameworkApplication.pe.Ng(this.Lm),this.Lm=null)}dispose(){this.Lm=this.uf=this.ioa=null}static Jhi(){Mm.a.Pad();u.AFrameworkApplication.Ta.processAction(F.a.Tde,2)}}Object(e.a)(mo,"SignOutResponseUI",null,[106]);class Nm{get name(){return"Common.App.UI"}Wb(a){a.register(Lm,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").ma()}init(){}dispose(){fh.a.rx(Nm.Oaa);Nm.Oaa=null}static main(){m.a.instance.Bc(new Nm)}static Myj(a,
b,c){Nm.Ecl()&&(Nm.Oaa=new mo(Mm.a.instance,a,b,c))}static Ecl(){return u.AFrameworkApplication.IWg&&!u.AFrameworkApplication.isEmbedded}}Nm.Oaa=null;Object(e.a)(Nm,"CommonAppUIPackage",null,[2,3]);class kr{constructor(a){this.Lza=this.Fza=this.Qza=this.Pza=null;this.y6e=this.sef=this.cP=this.xaa=!1;this.uCd=this.Kef=null;this.Def=0;this.eb=this.Jef=null;this.gga=a;this.MJ=3;this.POb=!0}initialize(a,b,c){this.Pza=this.M2d(a,b);this.Qza=CommonUIStrings.l_SavingStatus;this.Fza=CommonUIStrings.l_ReadOnlyStatus;
this.Lza=CommonUIStrings.l_ReviewModeStatus;this.gga&&this.gga.execute(f=>{f.wBc(Object(C.a)(this,this.dpc,"updateToSavingStatus"))});this.cP=!0;this.eb=c;return!0}Qna(a,b){this.xaa=a;this.MJ=b;this.updateSaveStatusText(this.POb)}updateSaveStatusText(a){!this.POb&&a&&(this.Jef=new Date);this.POb=a;a=null;3===this.MJ&&(a=this.POb?this.Pza:this.Qza);this.fJi(a)}M2d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,
b):CommonUIStrings.l_SavedStatus}dpc(){this.updateSaveStatusText(!1)}M9i(){switch(this.MJ){case 1:return this.Fza;case 2:return this.Lza;default:return null}}hHj(a){return this.sef===this.xaa&&this.Def===this.MJ&&this.Kef===a}VTd(a){appChrome.getHeaderApi().then(b=>{b.updateDocumentTitleStatus(this.xaa,a,this.M9i(),this.Jef,this.POb);this.y6e=!0;return null});this.uCd=null}fJi(a){this.cP&&Lg.c()&&!this.hHj(a)&&(!this.y6e&&this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExpediteFirstSaveStatusAction",
!1)?this.VTd(a):ib.a.iHe()?(this.uCd&&Z.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.uCd=window.requestIdleCallback(()=>{this.VTd(a)})):window.requestAnimationFrame(()=>{this.VTd(a)}),this.sef=this.xaa,this.Kef=a,this.Def=this.MJ)}}Object(e.a)(kr,"ReactSaveStatusUIHandler",null,[1275]);class Ws{constructor(a,b){this.dQ=null;this.Pza=CommonUIStrings.l_SavedStatus;this.Qza=CommonUIStrings.l_SavingStatus;this.Fza=CommonUIStrings.l_ReadOnlyStatus;
this.Lza=CommonUIStrings.l_ReviewModeStatus;this.eza=b;this.gga=a;this.MJ=3;this.$Ma=!0}oJ(){this.gga&&this.gga.execute(a=>{a.wBc(Object(C.a)(this,this.dpc,"updateToSavingStatus"))});this.eza.execute(a=>{this.dQ=a})}Qna(a,b){this.MJ=b;3===b?this.updateSaveStatusText(this.$Ma):2===b?this.hUe(this.Lza):this.hUe(this.Fza)}dpc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.$Ma=a;this.hUe(this.$Ma?this.Pza:this.Qza)}hUe(a){this.dQ&&this.dQ.sendMessage(bf.a.ztl,this.cvi(a))}cvi(a){const b=
{};b.StatusText=a;return b}}Object(e.a)(Ws,"SaveStatusPostMessageHandler",null,[1275]);var il=d(263);class Xs{constructor(a,b,c,f){this.Lza=this.Fza=this.Qza=this.Pza=null;this.x1a=0;this.jP=this.hDd=this.C_a=this.uqd=this.HFd=null;this.Xe=a;this.Ioa=b;this.gga=c;this.Qi=f;this.Y9e=!0;this.xaa=!1;this.MJ=3;this.$Ma=!0}initialize(a,b){if(!this.Xe)return!1;this.Pza=this.M2d(a,b);this.Qza=CommonUIStrings.l_SavingStatus;this.Fza=CommonUIStrings.l_ReadOnlyStatus;this.Lza=CommonUIStrings.l_ReviewModeStatus;
this.oJ();return!0}M2d(a,b){return a?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):b&&b.length?String.format(CommonUIStrings.l_SavedToStatus,b):CommonUIStrings.l_SavedStatus}oJ(){this.Ioa&&this.Ioa.execute(a=>{a.d7h(Object(C.a)(this,this.BVf,"createStatusAndModeElements"));a.L6h(Object(C.a)(this,this.Ydl,"showHideSaveStatusElement"));a.rpl&&this.BVf(null,null)});this.gga&&this.gga.execute(a=>{a.wBc(Object(C.a)(this,this.dpc,"updateToSavingStatus"))})}hya(){this.jP&&
this.Xe&&this.Xe.und(this.jP)}Ydl(a,b){this.Qna("true"===b,this.MJ)}Qna(a,b){this.xaa=a;this.MJ=b;this.uqd&&(this.uqd.style.display=this.xaa||3===this.MJ||!this.HFd?"none":"");this.C_a&&(this.C_a.style.display=this.xaa||3===this.MJ?"none":"",this.C_a.innerText=1===this.MJ?this.Fza:this.Lza,this.C_a.title=1===this.MJ?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.hDd&&(this.hDd.style.display=this.xaa||1===this.MJ||!this.HFd&&!this.C_a?"none":"");this.jP&&(this.jP.style.display=
this.xaa||1===this.MJ?"none":"",this.updateSaveStatusText(this.$Ma),this.jP.title=CommonUIStrings.l_SaveStatusTooltip)}BVf(a,b){a=document.getElementById(il.CuiHelper.buj);b&&b.LCl||!a||""===this.Pza||""===this.Qza||""===this.Fza||""===this.Lza||(this.HFd=document.getElementById(il.CuiHelper.aMd),this.uqd=il.CuiHelper.sGc(a,"BreadcrumbAppModeDash","-"),this.C_a=il.CuiHelper.sGc(a,"BreadcrumbAppModeStatus",1===this.MJ?this.Fza:this.Lza),this.gDh(this.C_a),this.hDd=il.CuiHelper.sGc(a,"BreadcrumbSaveStatusDash",
"-"),this.jP=il.CuiHelper.sGc(a,"BreadcrumbSaveStatus",this.Pza),this.gDh(this.jP),this.Qna(this.xaa,this.MJ))}dpc(){this.updateSaveStatusText(!1)}updateSaveStatusText(a){this.$Ma=a;this.nyl(this.$Ma?this.Pza:this.Qza)}nyl(a){!this.jP||3!==this.MJ&&2!==this.MJ||(this.Y9e&&!this.$Ma?(this.x1a=this.jP.offsetWidth<this.x1a?this.x1a:this.jP.offsetWidth,this.jvl(this.Qza),this.Y9e=!1):this.jP.innerText=a)}gDh(a){a.style.direction=this.Qi?"rtl":"ltr";a.style.width="auto";a.style.textAlign=this.Qi?"right":
"left";a.style.display=this.xaa?"none":"";a.setAttribute("Unselectable","on")}jvl(a){this.jP&&(this.jP.style.width="",this.jP.innerText=a,this.x1a=this.jP.offsetWidth<this.x1a?this.x1a:this.jP.offsetWidth,a=dh.a.It(this.jP),this.jP.style.width=this.x1a-ya.a.QL(a.paddingLeft)-ya.a.QL(a.paddingRight)+1+"px")}}Object(e.a)(Xs,"SaveStatusUIHandler",null,[1275]);class $x{constructor(){this.iDd=this.$Bd=this.MRb=this.Da=null}get name(){return"Common.App.SaveStatus"}Wb(a){this.Da=a;u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&
u.AFrameworkApplication.bQ?this.Da.register(Ws,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new Ws(this.Da.Ka("Common.App.HostNotification.EditNotificationEventSource"),this.Da.Ka("Postmessage.IHostPostmessenger"))):u.AFrameworkApplication.Aa.jb.Kzg||(u.AFrameworkApplication.Aa.jb.xN?this.Da.register(kr,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new kr(this.Da.Ka("Common.App.HostNotification.EditNotificationEventSource"))):
this.Da.register(Xs,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").ma().na(()=>new Xs(zd.EventHandlerManager.instance,this.Da.Ka("Common.App.Header.HeaderEventSource"),this.Da.Ka("Common.App.HostNotification.EditNotificationEventSource"),u.AFrameworkApplication.isRtl)))}init(){u.AFrameworkApplication.fa.ff(Object(C.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){const a=u.AFrameworkApplication.fa,b=!!u.AFrameworkApplication.Aa.jb&&4===u.AFrameworkApplication.Aa.jb.rm;
if(a.ka("WordEditorAutoSaveImprovementIsEnabled")||a.ka("PptEditorSaveStatusInHeaderEnabled")||b&&a.ka("SimplifiedReactRibbonUxIsEnabled")||a.ka("ExcelSaveStatusInHeaderEnabled")||a.ka("VisioSaveStatusInHeaderEnabled"))u.AFrameworkApplication.fa.ka("PostMessageEmbedded")&&u.AFrameworkApplication.bQ?(this.iDd=this.Da.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.iDd.oJ():u.AFrameworkApplication.Aa.jb.Kzg||(u.AFrameworkApplication.Aa.jb.xN?(this.$Bd=this.Da.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&
this.$Bd.initialize(a.ka("IsSkyDrive"),a.Ga("HostNameToIncludeInSavedStatus"),u.AFrameworkApplication.fa):(this.MRb=this.Da.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.MRb.initialize(a.ka("IsSkyDrive"),a.Ga("HostNameToIncludeInSavedStatus")))}dispose(){this.MRb&&this.MRb.hya()}}Object(e.a)($x,"PackageManager",null,[2,3]);window.PPTCampaignsObj_FromAppPackage=[{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customervoice",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2022-09-30T00:00:00Z",
GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",
Question:"nps_OneClickPromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_OneClickRating_Values_1","nps_OneClickRating_Values_2","nps_OneClickRating_Values_3","nps_OneClickRating_Values_4","nps_OneClickRating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURFhIWVJFRVVSTDRCSExHUEdXMzQ3OFoyMy4u"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",
LauncherType:"customervoice",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:22,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,
Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCpFge6Cl3sRFoOMTPf8V7pNUMFpIMk1RSVo3WDhFQ0tPM0JPQ0VZOFc0Ty4u"}}}},
{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",
IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",
LauncherType:"customervoice",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,
Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_Suite_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_Suite_QuestionQuestion"},CVSurveyParams:{CustomerVoiceFormId:"OQWcQhU2qEGdoz_3ZmewCrD2WXeriEdEnzV6LlcPT5JURDNVQ1BHVkxLUUpKTk80UDZDMk1TMFlPOC4u"}}}},
{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",
IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},
{CampaignId:"75fcdcee-a30b-4545-969e-1e24599c8ceb",StartTimeUtc:"2020-09-23T00:00:00Z",EndTimeUtc:"2021-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryRestoreCoauthFailed",
IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"VHRestore_Title",Question:"VHRestore_PromptQuestion",YesLabel:"VHRestore_Sure",NoLabel:"VHRestore_NotNow"},Rating:{Question:"VHRestore_SurveyQuestion",RatingValuesAscending:["VHRestore_Answer_Options_1","VHRestore_Answer_Options_2","VHRestore_Answer_Options_3","VHRestore_Answer_Options_4"]},Question:{Question:"VHRestore_WhyQuestion"}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2022-08-26T00:00:00Z",
GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",
Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with PowerPoint Online?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us why you gave this rating"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,
AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",Question:"It will only take a few seconds.",
YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",RatingValuesAscending:["1 - Not satisfied","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,
AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},
Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"ceef766d-7ae7-4f83-bf61-a2254bb05e45",StartTimeUtc:"2022-02-21T00:00:00Z",EndTimeUtc:"2022-08-21T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Please tell us about your experience using the Comments feature in PowerPoint",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the Comments feature in PowerPoint for the web?",
RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"fbff816d-e00a-4269-89eb-21ed37f0b20d",StartTimeUtc:"2020-06-08T00:00:00Z",EndTimeUtc:"2021-08-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},
CooldownPeriod:{Type:0,IntervalSeconds:31536E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:0,Activity:"UsageForWebAsDefaultFileOpenTeams",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"TeamsOpen_GreetingQuestion",Question:"TeamsOpen_PromptTitle",YesLabel:"TeamsOpen_GreetingAnswer_Sure",NoLabel:"TeamsOpen_GreetingAnswer_NotNow"},Rating:{Question:"TeamsOpen_RatingQuestion_PowerPoint",RatingValuesAscending:["TeamsOpen_Rating_Browser","TeamsOpen_Rating_Teams"]},Question:{Question:"TeamsOpen_PromptQuestion"}}}},
{CampaignId:"e7155ff8-0e35-49c8-ab37-4e230d9548e6",StartTimeUtc:"2020-10-05T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:30,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ConvertWordToPresentationActivity",IsAggregate:!0,Count:1}]},
Content:{Prompt:{Title:"We'd love to get some quick feedback from you",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of converting your document to a presentation?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"826063c4-f637-4317-9dd4-ec099224b8cd",
StartTimeUtc:"2021-04-01T00:00:00Z",EndTimeUtc:"2021-10-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AgendaToPresentationActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love to get some quick feedback from you",
Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the experience of adding slides automatically?",RatingValuesAscending:["1 - Not satisfied enough","2","3","4","5 - Very satisfied"]},Question:{Question:"What else would you like to share? We'll use your feedback to help improve the experience."}}}},{CampaignId:"f4aa2c06-b017-4702-a6db-83036ab55495",StartTimeUtc:"2021-04-23T00:00:00Z",EndTimeUtc:"2021-10-23T00:00:00Z",GovernedChannelType:0,
AdditionalDataRequested:["EmailAddress"],PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitTaskActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Please tell us about your experience using Tasks in PowerPoint",Question:"We have just two questions for you.",
YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with Tasks in PowerPoint for Web?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us why you chose that rating."}}}},{CampaignId:"0fd1d222-ab1e-49a2-9c18-3cba5d97c7e6",StartTimeUtc:"2021-08-18T18:30:00Z",EndTimeUtc:"2025-06-30T18:30:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"ModernFontPickerExperience",IsAggregate:!0,Count:4},Content:{Prompt:{Title:"FontPicker_FloodgatePromptTitle",Question:"FontPicker_FloodgatePromptQuestion",YesLabel:"FontPicker_FloodgatePromptYesLabel",NoLabel:"FontPicker_FloodgatePromptNoLabel"},Rating:{Question:"FontPicker_FloodgateRatingQuestion",
RatingValuesAscending:["FontPicker_FloodgateRating1","FontPicker_FloodgateRating2","FontPicker_FloodgateRating3","FontPicker_FloodgateRating4","FontPicker_FloodgateRating5"]},Question:{Question:"FontPicker_FloodgateCommentQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"cs-CZ"},{Type:0,Value:"de-DE"},{Type:0,Value:"en-GB"},{Type:0,Value:"es-ES"},
{Type:0,Value:"fr-FR"},{Type:0,Value:"ja-JP"},{Type:0,Value:"nl-NL"},{Type:0,Value:"pl-PL"},{Type:0,Value:"ru-RU"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,
Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"ar-SA"},{Type:0,Value:"da-DK"},{Type:0,Value:"es-MX"},{Type:0,Value:"fi-FL"},{Type:0,Value:"he-IL"},{Type:0,Value:"hr-HR"},{Type:0,Value:"it-IT"},{Type:0,Value:"ko-KR"},{Type:0,Value:"nb-NO"},{Type:0,Value:"pt-BR"},{Type:0,Value:"pt-PT"},{Type:0,Value:"sv-SE"},{Type:0,Value:"tr-TR"},{Type:0,Value:"zh-CN"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592E3},
CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1",
"FloodgateNLQSRating2","FloodgateNLQSRating3","FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"8e91c8ee-c5c1-4db3-85d2-bad66e6ddb05",StartTimeUtc:"2021-06-03T00:00:00Z",EndTimeUtc:"2028-06-03T00:00:00Z",GovernedChannelType:0,PrimaryPriority:2,Scope:{Languages:[{Type:0,Value:"af-ZA"},{Type:0,Value:"am-ET"},{Type:0,Value:"as-IN"},{Type:0,Value:"az-Latn-AZ"},{Type:0,Value:"be-BY"},{Type:0,Value:"bg-BG"},{Type:0,Value:"bn-BD"},{Type:0,
Value:"bn-IN"},{Type:0,Value:"bs-Latn-BA"},{Type:0,Value:"ca-ES"},{Type:0,Value:"chr-Cher-US"},{Type:0,Value:"cy-GB"},{Type:0,Value:"el-GR"},{Type:0,Value:"et-EE"},{Type:0,Value:"eu-ES"},{Type:0,Value:"fa-IR"},{Type:0,Value:"fil-PH"},{Type:0,Value:"fr-CA"},{Type:0,Value:"ga-IE"},{Type:0,Value:"gd-GB"},{Type:0,Value:"gl-ES"},{Type:0,Value:"gu-IN"},{Type:0,Value:"ha-Latn-NG"},{Type:0,Value:"he-IN"},{Type:0,Value:"hu-HU"},{Type:0,Value:"hy-AM"},{Type:0,Value:"id-ID"},{Type:0,Value:"ig-NG"},{Type:0,Value:"is-IS"},
{Type:0,Value:"ka-GE"},{Type:0,Value:"kk-KZ"},{Type:0,Value:"km-KH"},{Type:0,Value:"kn-IN"},{Type:0,Value:"kok-IN"},{Type:0,Value:"ku-Arab-IQ"},{Type:0,Value:"ky-KG"},{Type:0,Value:"lb-LU"},{Type:0,Value:"lo-LA"},{Type:0,Value:"lt-LT"},{Type:0,Value:"lv-LV"},{Type:0,Value:"mi-NZ"},{Type:0,Value:"mk-MK"},{Type:0,Value:"ml-IN"},{Type:0,Value:"mn-MN"},{Type:0,Value:"mr-IN"},{Type:0,Value:"ms-MY"},{Type:0,Value:"mt-MT"},{Type:0,Value:"ne-NP"},{Type:0,Value:"nn-NO"},{Type:0,Value:"nso-ZA"},{Type:0,Value:"mso-ZA"},
{Type:0,Value:"or-IN"},{Type:0,Value:"pa-IN"},{Type:0,Value:"prs-AF"},{Type:0,Value:"ps-AF"},{Type:0,Value:"quc-Latn-GT"},{Type:0,Value:"quz-PE"},{Type:0,Value:"ro-RO"},{Type:0,Value:"rw-RW"},{Type:0,Value:"sd-Arab-PK"},{Type:0,Value:"si-LK"},{Type:0,Value:"sk-SK"},{Type:0,Value:"sl-SL"},{Type:0,Value:"sq-AL"},{Type:0,Value:"sr-Cyrl-BA"},{Type:0,Value:"sr-Cyrl-RS"},{Type:0,Value:"sr-Latn-RS"},{Type:0,Value:"sw-KE"},{Type:0,Value:"ta-IN"},{Type:0,Value:"te-IN"},{Type:0,Value:"tg-Cyrl-TJ"},{Type:0,
Value:"th-TH"},{Type:0,Value:"ti-ET"},{Type:0,Value:"tk-TM"},{Type:0,Value:"tn-ZA"},{Type:0,Value:"tt-RU"},{Type:0,Value:"ug-CN"},{Type:0,Value:"uk-UA"},{Type:0,Value:"ur-PK"},{Type:0,Value:"uz-Latn-UZ"},{Type:0,Value:"vi-VN"},{Type:0,Value:"wo-SN"},{Type:0,Value:"xh-ZA"},{Type:0,Value:"yo-NG"},{Type:0,Value:"zh-TW"},{Type:0,Value:"zu-ZA"}],Type:1},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:5184E3},CooldownPeriod:{Type:0,IntervalSeconds:15552E3},
FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:3,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNLQS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNLQS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"FloodgateNLQSPromptTitle",Question:"FloodgateNLQSPromptSubtitle",YesLabel:"FloodgateNLQSPromptYes",NoLabel:"FloodgateNLQSPromptNo"},Rating:{Question:"FloodgateNLQSRatingQuestion",RatingValuesAscending:["FloodgateNLQSRating1","FloodgateNLQSRating2","FloodgateNLQSRating3",
"FloodgateNLQSRating4","FloodgateNLQSRating5"]},Question:{Question:"FloodgateNLQSDetailsQuestion"}}}},{CampaignId:"c551d75c-10b1-4de2-83cc-cce22d7c06bd",LauncherType:"coachingux",StartTimeUtc:"2021-08-15T00:00:00Z",EndTimeUtc:null,GovernedChannelType:3,Tags:["FirstRunExperienceV2"],PrimaryPriority:5,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,
NominationPeriod:{Type:0,IntervalSeconds:2592E3},CooldownPeriod:{Type:0,IntervalSeconds:7776E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:22,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowFirstRunExperienceUIV2",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{itemCount:3,surfaceType:"sequence",preFetchDelay:500,preventAutoDismiss:!0,backgroundColor:"#b7472a",buttonHoverColor:"#a92b1a",closeButtonAriaLabel:"Close",position:"left",anchorHint:5,surfaceType1:"teaching",anchorElementSelectors1:"#BreadcrumbSaveStatus #documentTitle #documentTitleContainer #WACRibbon-QATRowCenter #BreadcrumbSaveStatusDash #ResponsiveCenterRegion #AppHeaderPanel div[role='toolbar'] div[class*='cui-topBar1-transistionalHeaderUI'] #o365header #O365_NavHeader".split(" "),
title1:"Never lose your work",description1:"Your file is automatically saved online. Just click the title to rename or change the save location.",illustrationImage1:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yjj0",primaryButtonText1:"Next",delayLoad1:1E3,retryTimes1:3,retryInterval1:500,surfaceType2:"teaching",anchorElementSelectors2:["button[data-unique-id='Share']","button[aria-label='Share']"],title2:"Share and collaborate",description2:"Share your presentation so others can leave comments and feedback, even if they don't have Office themselves.",
illustrationImage2:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4yrdA",primaryButtonText2:"Next",surfaceType3:"teaching",anchorElementSelectors3:["button[data-unique-id='Present']","button[aria-label='Present']"],title3:"Start presenting",description3:"When you're ready, click Present to start your slideshow.",illustrationImage3:"https://query.prod.cms.rt.microsoft.com/cms/api/am/binary/RE4ytEj",primaryButtonText3:"Got it"}}}},{CampaignId:"7f5167e4-54e6-4353-a9d7-686741f379b7",LauncherType:"coachingux",
StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinTab"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,
ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinTab",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin\u200b",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Show add-in",
primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"d7f1cbbb-3631-4cae-bc2d-177774aa1190",LauncherType:"coachingux",StartTimeUtc:"2022-01-20T00:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForAddinButton"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,
Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForAddinButton",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",
userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[lpp-id='latestAddin']\"]",title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchAddinTaskpane",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"cbb7eaa0-6e95-422d-9647-2be7d2737d4a",
LauncherType:"coachingux",StartTimeUtc:"2022-01-20T08:00:00Z",EndTimeUtc:null,Tags:["ShowTeachingUIForContentAddin"],PrimaryPriority:5,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"},{Type:0,Value:"en-AU"},{Type:0,Value:"en-CA"},{Type:0,Value:"en-IN"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,FallbackSurveyDurationSeconds:120,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:3600}},
SurveyTemplate:{Type:22,MaxLaunches:25,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowTeachingUIForContentAddin",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{isAA:!1,isControl:"False",telemetryEventName:"8bf7d424",position:"Left",hasCoachMark:"False",userNativeRender:!1,delayLoad:"1500",retryTimes:"5",retryInterval:500,anchorElementSelectors:"[\"button[data-unique-id='Ribbon-InsertAppsForOffice']\", \"button[data-unique-id='Ribbon-InsertAddIns']\", \"button[data-unique-id='Overflow-RibbonOverflowMenu-overflow']\"]",
title:"New add-in from your admin",description:"An add-in was installed to add new capabilities and improve your experience with Office.",primaryButtonText:"Try it",primaryButtonAction:"event:LaunchContentAddin",secondaryButtonText:"Not now",secondaryButtonAction:"event:DismissCallout",closeButtonAction:"event:CloseCallout",closeButtonAriaLabel:"Close"}}}},{CampaignId:"974882c6-f67e-47be-9ba4-4db5c2374610",StartTimeUtc:"2022-04-01T00:00:00Z",EndTimeUtc:"2023-02-01T00:00:00Z",GovernedChannelType:0,
PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592E3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultipleGuestsCoauthoring",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"GuestCoauthoring_FloodgatePromptTitle",Question:"GuestCoauthoring_FloodgatePromptQuestion",YesLabel:"GuestCoauthoring_FloodgateYesLabel",
NoLabel:"GuestCoauthoring_FloodgateNoLabel"},Rating:{Question:"GuestCoauthoring_FloodgateQuestion",RatingValuesAscending:["GuestCoauthoring_FloodgateRatingValue_1","GuestCoauthoring_FloodgateRatingValue_2","GuestCoauthoring_FloodgateRatingValue_3","GuestCoauthoring_FloodgateRatingValue_4","GuestCoauthoring_FloodgateRatingValue_5"]},Question:{Question:"GuestCoauthoring_FloodgateRatingQuestion"}}}},{CampaignId:"21c77b4d-1446-4cfe-8881-fa67502a0f14",StartTimeUtc:"2022-05-04T00:00:00Z",EndTimeUtc:"2023-1-31T00:00:00Z",
GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"CollabCornerSurveyLogDownloadACopyCommandActivity",IsAggregate:!0,Count:1},Content:{Prompt:{Title:"CollabCorner_Survey_DownloadCopies_Prompt_Line_1",Question:"CollabCorner_Survey_DownloadCopies_Prompt_Line_2",YesLabel:"CollabCorner_Survey_DownloadCopies_Prompt_YesLabel",
NoLabel:"CollabCorner_Survey_DownloadCopies_Prompt_NoLabel"},Rating:{Question:"CollabCorner_Survey_DownloadCopies_Rating_Question",RatingValuesAscending:["CollabCorner_Survey_DownloadCopies_Rating_Scale_1","CollabCorner_Survey_DownloadCopies_Rating_Scale_2","CollabCorner_Survey_DownloadCopies_Rating_Scale_3","CollabCorner_Survey_DownloadCopies_Rating_Scale_4","CollabCorner_Survey_DownloadCopies_Rating_Scale_5"]},Question:{Question:"CollabCorner_Survey_DownloadCopies_Comment_Question"}}}},{CampaignId:"bf20f28c-af0a-4d43-a87b-239b0419c65f",
StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2023-06-30T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SimplicityEaseOfUseSurvey",IsAggregate:!0,Count:360},{Type:0,Activity:"SimplicityEaseOfUseSurveyTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"EaseOfUse_Floodgate_Prompt_Line1",
Question:"EaseOfUse_Floodgate_Prompt_Line2",YesLabel:"EaseOfUse_Floodgate_Prompt_Affirmative_Answer",NoLabel:"EaseOfUse_Floodgate_Prompt_Negative_Answer"},Rating:{Question:"EaseOfUse_Floodgate_Rating_Question",RatingValuesAscending:["EaseOfUse_Floodgate_Rating_Scale_1","EaseOfUse_Floodgate_Rating_Scale_2","EaseOfUse_Floodgate_Rating_Scale_3","EaseOfUse_Floodgate_Rating_Scale_4","EaseOfUse_Floodgate_Rating_Scale_5"]},Question:{Question:"EaseOfUse_Floodgate_Comment_Question"}}}},{CampaignId:"6e859e5f-99be-48cd-9a9a-da52d6ff7203",
StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleEnabledFPS",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"Fluent2Survey_Title",Question:"Fluent2Survey_Question",YesLabel:"Fluent2Survey_YesLabel",
NoLabel:"Fluent2Survey_NoLabel"},Rating:{Question:"Fluent2Survey_RatingQuestion",RatingValuesAscending:["Fluent2Survey_RatingValue_1","Fluent2Survey_RatingValue_2","Fluent2Survey_RatingValue_3","Fluent2Survey_RatingValue_4","Fluent2Survey_RatingValue_5"]},Question:{Question:"Fluent2Survey_WhyQuestion"}}}},{CampaignId:"e9434f43-d475-4b79-8213-88636e007433",StartTimeUtc:"2022-09-19T00:00:00Z",EndTimeUtc:"2023-05-01T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:75,
PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:1209600}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Fluent2StyleOptOutFPS",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"Fluent2OptOutSurvey_Title",Question:"Fluent2OptOutSurvey_Question",YesLabel:"Fluent2OptOutSurvey_YesLabel",NoLabel:"Fluent2OptOutSurvey_NoLabel"},Rating:{Question:"Fluent2OptOutSurvey_RatingQuestion",RatingValuesAscending:["Fluent2OptOutSurvey_RatingValue_1",
"Fluent2OptOutSurvey_RatingValue_2"]},Question:{Question:"Fluent2OptOutSurvey_WhyQuestion"}}}},{CampaignId:"26b1466b-2ac8-4d6f-8ee0-cd06c7594ce5",StartTimeUtc:"2022-09-01T00:00:00Z",EndTimeUtc:"2024-12-31T00:00:00Z",GovernedChannelType:0,PrimaryPriority:3,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296E3},CooldownPeriod:{Type:0,IntervalSeconds:2592E3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"AddPenStrokePPTO",
IsAggregate:!0,Count:4},Content:{Prompt:{Title:"PenInkSurvey_Prompt",Question:"PenInkSurvey_PromptQuestion",YesLabel:"PenInkSurvey_Prompt_Sure",NoLabel:"PenInkSurvey_Prompt_NoNow"},Rating:{Question:"PenInkSurvey_RatingQuestion",RatingValuesAscending:["PenInkSurvey_QuestionChoice_5","PenInkSurvey_QuestionChoice_4","PenInkSurvey_QuestionChoice_3","PenInkSurvey_QuestionChoice_2","PenInkSurvey_QuestionChoice_1"]},Question:{Question:"PenInkSurvey_WhyQuestion"}}}}];var SO=d(656);class kF{L8f(){return null}v0i(){return Yd.c(window.PPTCampaignsObj_FromAppPackage)}l4d(a){return SO.a.l4d(a,
"PPTUserInitiatedSurveysDictionary_FromAppPackage")}}Object(e.a)(kF,"PowerPointFeedbackAppData",null,[1171]);class uA{constructor(){this.Da=null}Wb(a){this.Da=a;a.register(1171,"Common.App.IAppSpecificFeedbackData").ma().na(()=>new kF)}init(){this.Da.qb("Common.App.IAppSpecificFeedbackData")}dispose(){}get name(){return"PPTWebEditor.Feedback"}static main(){m.a.instance.Bc(new uA)}}Object(e.a)(uA,"PPTWebEditorFeedbackPackage",null,[2,3]);class vA{get name(){return"Box4.ListEditors"}Wb(){}init(){}dispose(){}static main(){m.a.instance.Bc(new vA)}}
Object(e.a)(vA,"Box4ListEditorsPackage",null,[2,3]);var Ej=d(141),Zk=d(123);const wA=a=>{a=document.createElement(a);a.setAttribute("unselectable","on");return a};class lF{constructor(a){this.BGd=this.dvd=!1;this.fLa=null;this.KZe=!1;this.R5=null;this.waa=!1;this.rVh=a;ja.a.instance.ob(ma.a.mouseDown,this.D0b(),Object(C.a)(this,this.Ykk,"onContextualUIMouseDown"));(a=fb.a.instance.Ka("Common.IActionContextProvider"))&&a.execute(b=>{this.R5=b});u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&
u.AFrameworkApplication.Aa.jb.xN?wd.a.get_instance().gk(16,()=>{this.fg?this.initializeContextualUI(this.D0b()):wd.a.get_instance().gk(7,()=>{this.initializeContextualUI(this.D0b())})}):wd.a.get_instance().gk(7,()=>{this.initializeContextualUI(this.D0b())})}get Wvb(){return this.waa}get fg(){return u.AFrameworkApplication.fa.ka("InitializeContextualUIAftereHeaderInteractiveIsEnabled")&&u.AFrameworkApplication.Aa.jb.xN?wd.a.get_instance().isCompleted(16)&&wd.a.get_instance().isCompleted(7):wd.a.get_instance().isCompleted(7)}Zki(){if(this.KZe)return!0;
try{return Promise.resolve(null),this.KZe=!0}catch(a){return!1}}yUe(a){if(!this.fg||this.BGd)return this.bfe("Unable to launch contextual ui because ribbon hasn't loaded yet"),!0;if(!this.Zki())return this.bfe("Unable to launch contextual ui because promise.resolve is not defined"),!0;if(u.AFrameworkApplication.IIc)return this.bfe("Unable to launch contextual ui because the feature to show contextual ui is disabled"),!0;this.BGd=!0;let b=F.a.Ae;switch(a){case 1:b=F.a.showContextMenu;break;case 0:b=
F.a.showFloatie;break;case 2:b=F.a.tjd}window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.BGd=!1;on.c(b)},0)});return!1}Vhg(a){return Ej.UISurfaces.yCa().then(b=>{if(appChrome.api.isSmallDevice()&&b.getBlockedSmallScreenFloatieGroupList){b=b.getBlockedSmallScreenFloatieGroupList();const c=[];for(const f of a)Array.contains(b,f)||c.push(f);return c}return a})}showFloatie(a,b,c,f=null){this.yUe(0)||this.Vhg(b).then(l=>{if(0>=l.length)return null;this.kMe(l).then(()=>{const x={};x.target=
a;Ej.UISurfaces.yCa().then(G=>{appChrome.api.dispatch(G.showFloatie(x,c,void 0,this.y1d(),f));this.waa=!0;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LogFloatieMenuContextIsEnabled",!1)&&u.AFrameworkApplication.Ta&&u.AFrameworkApplication.Ta.processAction(F.a.EXj,2);return null})});return null})}showContextMenu(a,b,c=null,f=null){this.yUe(1)||this.Yrh(a,b,c,f)}Yrh(a,b,c=null,f=null){this.kMe(null).then(()=>{const l={};l.target=a;f&&(l.directionalHint=f);Ej.UISurfaces.yCa().then(x=>
{appChrome.api.dispatch(x.showContextMenu(l,b,c,void 0,this.y1d()));return null})})}oxa(a,b,c){this.yUe(2)||this.Vhg(b).then(f=>{0>=f.length?this.Yrh(a,c,null):this.kMe(f).then(()=>{const l={};l.target=a;const x={};x.target=a;Ej.UISurfaces.yCa().then(G=>{appChrome.api.dispatch(G.showContextualUI(l,x,c,void 0,null,this.y1d()));this.waa=!0;return null})});return null})}bfe(a){Z.ULS.sendTraceTag(561394519,340,15,a)}STd(){this.fg&&Ej.UISurfaces.isLoaded()&&Ej.UISurfaces.yCa().then(a=>{appChrome.api.dispatch(a.hideContextMenu());
return null})}YM(){this.fg&&Ej.UISurfaces.isLoaded()&&Ej.UISurfaces.yCa().then(a=>{this.waa=!1;appChrome.api.dispatch(a.hideFloatie());return null})}OYb(){this.fg&&Ej.UISurfaces.isLoaded()&&Ej.UISurfaces.yCa().then(a=>{appChrome.api.dispatch(a.hideContextualUI());this.waa=!1;return null})}initializeContextualUI(a){return Ej.UISurfaces.yCa().then(b=>{this.dvd||(b.initializeContextualUI(a),this.dvd=!0);return null})}kMe(a){if(!this.dvd)return this.initializeContextualUI(this.D0b()).then(()=>{this.setActiveFloatieGroups(a);
return null});this.setActiveFloatieGroups(a);return Promise.resolve(null)}setActiveFloatieGroups(a){if(a&&a.length){var b=[];b.push(appChrome.actions.setActiveFloatieGroups(a));appChrome.api.dispatch(b);var c=[];Ej.UISurfaces.yCa().then(f=>{c.push.apply(c,this.rVh.pFb.DPc(f.selectors.getFloatieOnlyControlsMap(),9));0<c.length&&appChrome.api.dispatch(c);return null})}}D0b(){if(this.fLa)return this.fLa;this.fLa=wA("div");this.fLa.id="ReactContextualUIDiv";this.fLa.style.position="absolute";this.fLa.style.zIndex=
"1001";document.body.insertBefore(this.fLa,document.body.firstChild);return this.fLa}Ykk(a){a.mc&&a.mc.target&&"input"===a.mc.target.tagName.toLowerCase()&&v.FocusManager.instance().IC("ribbon");return!1}y1d(){return this.R5?this.R5.contentType:"Unknown"}}Object(e.a)(lF,"ReactContextualUILauncher",null,[1167]);var lj=d(134);class xA{constructor(a){this.wRb=a}create(a,b){const c=new Sys.StringBuilder;this.OXb(c,a,b);this.fRd(c,a);return c.toString()}Et(a,b){const c=[];this.LRd(c,a,b);this.gRd(c,a);
return c}OXb(a,b,c){switch(b.errorType){case 0:a.append(this.wRb.build());break;case 1:case 2:a.append(this.hMd(b,c))}}LRd(a,b,c){switch(b.errorType){case 0:a.push(this.wRb.lLf());break;case 1:case 2:a.push(this.agi(b,c))}}fRd(a,b){H.a.instance.ga(92)||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),a.append(lj.a("btnIgrnoreSpellingError",(2===b.errorType?E.a.wnd:E.a.Asa).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),a.append("</Controls></MenuSection>"))}gRd(a,
b){if(!H.a.instance.ga(92)){var c=Object.assign(new Mi.a,{ControlList:[]});b=2===b.errorType?"UnknownSpellingError":"IgnoreSpellingError";Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:b}));a.push(c)}}hMd(a,b){a=this.VYi(a.suggestions,b);return 0<a.length?lj.e("msUnknownWord",lj.c(null,a),"Menu16"):lj.e("msUnknownWord",lj.c(null,[lj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")}VYi(a,b){const c=[];if(a){const f=Math.min(b.length,a.length);for(let l=
0;l<f;++l)a[l]&&c.push(lj.a("btnCorrectWord"+l,b[l].toString(),a[l]))}return c}agi(a,b){const c=Object.assign(new Mi.a,{Id:"Suggestions",ControlList:[]});this.UYi(a.suggestions,b,c.ControlList);0>=c.ControlList.length&&(a=Object.assign(new Ef.a,{ExternalId:"NoSuggestions"}),Array.add(c.ControlList,a));return c}UYi(a,b,c){if(a){const f=Math.min(b.length,a.length);for(let l=0;l<f;++l){if(!a[l])continue;const x=Object.assign(new Ef.a,{ExternalId:"btnCorrectWord"+l,Command:b[l].toString(),LabelText:a[l]});
Array.add(c,x)}}}}Object(e.a)(xA,"DefaultProofingContextMenuCreator",null,[]);class yA{constructor(a,b){this.K0e=a;this.b3e=b;this.lNa=[E.a.Mxa,E.a.Nxa,E.a.Oxa,E.a.MJa,E.a.NJa]}create(a,b){return b?Object(Ma.a)(Po.a,b)?this.b3e.create(a,b,this.lNa):this.K0e.create(b,this.lNa):""}JXb(a,b){return b?Object(Ma.a)(Po.a,b)?this.b3e.Et(a,b,this.lNa):this.K0e.Et(b,this.lNa):null}}Object(e.a)(yA,"ProofingContextMenuSectionFactory",null,[1332]);class mF{build(){const a=[lj.a("btnDeleteRepeatedWord","2023591105",
Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return lj.e("msRepeatedWord",lj.c(null,a),"Menu16")}lLf(){const a=Object.assign(new Mi.a,{ControlList:[]}),b=Object.assign(new Ef.a,{ExternalId:"DeleteRepeatedWord"});Array.add(a.ControlList,b);return a}}Object(e.a)(mF,"ProofingRepeatedWordSectionBuilder",null,[1333]);var zA=d(1086);class mv{constructor(a,b){this.$_a=a;this.hn=b}get isVisible(){return this.$_a.Wvb}get controls(){return null}YM(){this.$_a.YM();return!0}ksh(a,b){this.$_a.showFloatie(Object.assign(new zA.a,
{x:a.x,y:a.y}),this.XLc(b),b,null)}fra(){return this.YM()}XLc(){return[]}}Object(e.a)(mv,"ReactFloatie",null,[432,433]);class nF{constructor(a){this.Xrc=null;this.$_a=a}dispose(){}fra(){this.$_a.OYb();return!0}showContextMenu(a,b){this.o5(a,b.clientPoint,b.Wf)}o5(a,b,c){this.sjd(a,new Sys.UI.Bounds(b.x,b.y,0,0),c);Z.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",a)}sjd(a,b,c,f=null){this.Xrc?this.$_a.oxa(Object.assign(new zA.a,{x:b.x,y:b.y}),this.Xrc.XLc(c),c):this.$_a.showContextMenu(Object.assign(new zA.a,
{x:b.x,y:b.y}),c,void 0,f);this.Xrc=null}tjd(a,b,c,f){this.Xrc=Object(ua.a)(mv,c);f.B$(a,b);return!0}}Object(e.a)(nF,"ReactContextMenuController",null,[1168,106]);var xr=d(430);class ry{static get mg(){return Lh.a.UB(ry.fo,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,
Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)}}ry.fo="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>";
Object(e.a)(ry,"AutoCorrectOptionsDialogHTML",null,[]);class sy{static get mg(){return Lh.a.UB(sy.fo,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,
Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)}}sy.fo="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>";
Object(e.a)(sy,"AutoCorrectOptionsDialogHTML2",null,[]);class oF extends Lh.a{constructor(a,b){super();this.nR=a;this.K1=b;this.ng="AutoCorrectOptionsDialog"}gmc(){Z.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens.");this.mg=this.K1?sy.mg:ry.mg;const a={};a.ReplaceTextAsYouType=this.nR.Ifb;a.CapitalizeFirstLetterOfSentences=this.nR.dEc;a.ReplaceOrdianalsWithSuperscript=this.nR.dfd;a.ReplaceHyphensWithDash=this.nR.Gjc;a.ReplaceFractionsWithFractionCharacter=this.nR.bfd;this.K1&&
(a.ReplaceQuoteWithSmartQuote=this.nR.QGe);this.tj(Box4Intl.Box4Strings.l_AutoCorrectOptions,Object(C.a)(this,this.J2k,"setAutoCorrectOptionsHandler"),a)}J2k(a,b){H.a.instance.ga(70)&&(1!==a?Z.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes."):b.ReplaceTextAsYouType!==this.nR.Ifb||b.CapitalizeFirstLetterOfSentences!==this.nR.dEc||b.ReplaceOrdianalsWithSuperscript!==this.nR.dfd||b.ReplaceHyphensWithDash!==this.nR.Gjc||b.ReplaceFractionsWithFractionCharacter!==
this.nR.bfd||this.K1&&b.ReplaceQuoteWithSmartQuote!==this.nR.QGe?(a={},a.ReplaceTextAsYouType=b.ReplaceTextAsYouType,a.CapitalizeFirstLetterOfSentences=b.CapitalizeFirstLetterOfSentences,a.ReplaceOrdianalsWithSuperscript=b.ReplaceOrdianalsWithSuperscript,a.ReplaceHyphensWithDash=b.ReplaceHyphensWithDash,a.ReplaceFractionsWithFractionCharacter=b.ReplaceFractionsWithFractionCharacter,this.K1&&(a.ReplaceQuoteWithSmartQuote=b.ReplaceQuoteWithSmartQuote),this.nR.xZk(a),Z.ULS.sendTraceTag(24523524,324,
50,"User close the option dialog and trigger to save the setting: {0}"+{["ReplaceTextAsYouType"]:b.ReplaceTextAsYouType,["CapitalizeFirstLetterOfSentences"]:b.CapitalizeFirstLetterOfSentences,["ReplaceOrdianalsWithSuperscript"]:b.ReplaceOrdianalsWithSuperscript,["ReplaceHyphensWithDash"]:b.ReplaceHyphensWithDash,["ReplaceFractionsWithFractionCharacter"]:b.ReplaceFractionsWithFractionCharacter,["ReplaceQuoteWIthSmartQuoteIsEnabled"]:this.K1,["ReplaceQuoteWithSmartQuote"]:this.K1&&b.ReplaceQuoteWithSmartQuote}),
Cb.App.Hb.updateCommandUI(!0)):Z.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes."))}}Object(e.a)(oF,"AutoCorrectOptionsDialog",Lh.a,[1170]);class ty{static get mg(){return Lh.a.UB(ty.fo,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)}}ty.fo="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>";
Object(e.a)(ty,"AltTextDialogWithDescriptionHtml",null,[]);class lq extends Lh.a{constructor(a=!1){super(!1,!1,a);this.mg=ty.mg;this.ng=a?"AltTextDialog":"BaseAltTextDialogWithDescription"}Oxi(a){this.tj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(C.a)(this,this.BJd,"altTextDialogHandler"),this.$Mc(a));a=document.getElementById(lq.DJd);a.focus();a.select()}Pxi(a){a={["id"]:"AltTextDialog",["bodyControls"]:this.$Mc(a)};this.tj(CommonUIStrings.l_AlternativeTextDialogTitle,Object(C.a)(this,this.BJd,
"altTextDialogHandler"),a)}$Mc(a){const b={};b[lq.DJd]=this.getAltText(a);b[lq.AJd]=this.$$f(a)||"";return b}XM(a){return a.Ac.id===lq.AJd?!1:super.XM(a)}}lq.DJd="titleText";lq.AJd="descriptionText";Object(e.a)(lq,"BaseAltTextDialogWithDescription",Lh.a,[]);class It extends lq{constructor(a,b=!1){super(b);this.ng=It.Lvj;b&&u.AFrameworkApplication.fa.ka("ReactAltTextDialogIsEnabled")?this.Pxi(a):this.Oxi(a)}}It.Lvj="AAltTextDialogWithDescription";Object(e.a)(It,"AAltTextDialogWithDescription",lq,[]);
class pF extends It{constructor(a,b,c,f,l){super(a);this.tnb=this.zMb=null;this.gD=b;this.Yfa=c;this.rk=f;this.Xc=l}$$f(a){this.zMb=a.node;this.tnb=Jd.TableReader.Mgg(a);return Jd.TableReader.K3d(this.tnb)}getAltText(a){this.zMb=a.node;this.tnb=Jd.TableReader.Mgg(a);return Jd.TableReader.L3d(this.tnb)}BJd(a){if(1===a){Jd.TableReader.L3d(this.tnb);Jd.TableReader.K3d(this.tnb);this.hide();a=this.rk.ke(15);try{a.gd(this.zMb)}finally{a&&a.dispose()}}H.a.instance.ga(50)&&this.Yfa.Zv&&this.Yfa.pY.Opa(this.zMb)}}
Object(e.a)(pF,"TableAltTextDialog",It,[]);class AA{constructor(a,b,c){this.gD=a;this.rk=b;this.Xc=c}create(a){return new pF(a,this.gD,Cb.App.Ih,this.rk,this.Xc)}}Object(e.a)(AA,"TableAltTextDialogFactory",null,[]);const TO=()=>{Cb.App.m$h=!0;return 32},UO=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,jv:b}=qF(l)).returnValue)return 16;Cb.App.Hb.oxa(a,b);return 32},VO=(a,b,c,f,l)=>{if(1===c)return 32;if(!({point:a,jv:b}=qF(l)).returnValue)return 16;Cb.App.Hb.p5(a,b);return 32},qF=a=>{let b,c;b=null;
c=0;if(!a)return{returnValue:!1,point:b,jv:c};a=a.split(",");if(3>a.length)return{returnValue:!1,point:b,jv:c};b=new Sys.UI.Point(parseInt(a[0]),parseInt(a[1]));c=parseInt(a[2]);return{returnValue:!0,point:b,jv:c}};var WO=d(1087);class rF extends Sys.EventArgs{constructor(a,b,c,f,l,x=0,G=0,R=null){super();this.controlId=a;this.commandId=f;this.time=l;this.commandSurface=x;this.jv=G;this.contentType=R}}Object(e.a)(rF,"CommandClickEventArgs",Sys.EventArgs,[]);class sF{constructor(a,b){this.uaa=a.R2i();
this.FMb=a;this.LKa=b}X2f(a,b,c,f=null,l=null){c&&(this.LKa.oq=c.CommandLocation,this.LKa.LS=c.InvocationMethod,this.LKa.Eqa=c.CommandTabName);let x=this.FMb.Eag(parseInt(a),b,c);x.GF&&(x=this.FMb.Eag(x.Nm,b,c));if(void 0!==x.zK&&null!==x.zK)return x.zK;if(x.q6d)l=32;else{var G=null;this.uaa&&this.uaa.xBe&&(G=this.uaa.xBe(x,l));x.sW||x.Ebe?x.Pq?l=16:(l=this.LKa.La(x.Nm,x.Dbe?2:1,x.kd,l),2===l&&(l=32)):x.Pq?l=this.LKa.$bd(null,x.Nm,x.kd,R=>{f&&f(R.response)},l):(l=this.LKa.La(x.Nm,2,x.kd,l),f&&f(l));
this.uaa&&this.uaa.ZAe&&this.uaa.ZAe(x,l,G);if(b&&c&&-1!==c.InvocationMethod&&0!==c.InvocationMethod){c=b.LegacyId;if(void 0===c||null===c)c="";G=b.ParentMenuId;void 0!==G&&null!==G||!b.MenuId||(G=b.MenuId);let R=b.SqmControlId;void 0!==R&&null!==R||!b.SourceControlId||(R=b.SourceControlId);(void 0!==R&&null!==R||void 0!==G&&null!==G)&&WO.a.CGk(new rF(R,c,G,a,Date.now()))}}x.sW&&32===l&&this.uaa&&this.uaa.FUb&&this.uaa.FUb(x,b);x.Ebe&&32===l&&this.uaa&&this.uaa.qKd&&this.uaa.qKd(x,b);return 32===
l||1===l}T5b(a,b=null){if(u.AFrameworkApplication.Vg||El.a.instance.$v)return!1;const c=parseInt(a);b&&b.UILocation&&(this.LKa.oq=b.UILocation);if(!a||c===Kd.ActionManager.AZb)return!0;a=this.FMb.nNc(c,b);a.GF&&(a=this.FMb.nNc(a.Nm,b));if(void 0!==a.zK&&null!==a.zK)return a.zK;c===F.a.t3a&&b&&(a.kd=b);return 32===this.LKa.La(a.Nm,1,a.kd)}clearCache(){this.FMb.clearCache()}}Object(e.a)(sF,"GeneralCuiUser",null,[1169,1226]);class tF{constructor(a,b,c,f){this.rzf=a;this.bha=b;this.Iqc=c;this.i1a=f}pfg(){let a;
a=this.i1a.Mbj(this.rzf);return{returnValue:this.i1a.TNc(this.rzf),W9g:a}}soh(a,b){if(this.bha){var c=new D.DictionaryPropertySet;this.Iqc.execute(f=>{f.KZb(a)});c.setValue(tb.a.Rs,a);c.setValue(H.a.instance.ga(20)?Mb.a.noProof:Oc.a.Dva,b);b=new Id.GraphTransaction(15);b.set(Cb.App.JO.DU);this.bha.qU(c);b.dispose()}}}Object(e.a)(tF,"LanguageEditor",null,[363]);var Pi=d(213);class Tq{constructor(a=!1,b=0){this.mqd=null;this.Yxd=Tq.egg(sa.a.T2i());this.qvc=new vt.a;this.ipa=[];this.Bmb=new qa.a;this.ntf=
a;this.otf=0>=b?7:b;this.mtf=this.hCd=0;this.t6e=!1;a&&(this.wAj(),u.AFrameworkApplication.ofa(()=>{this.JZj()}))}get languages(){return this.Yxd}wAj(){for(var a of this.Yxd)this.qvc.$(a.LCID,a);a=[];try{var b=Pi.a.get("RecentlyUsedLcids");if(b&&""!==b){const f=decodeURIComponent(b).split(",").slice(0,this.otf);for(const l of f){let x;({value:x}=this.qvc.Rf(parseInt(l))).returnValue&&a.push(x)}}}catch(f){Z.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",
f.message),Array.clear(a)}if(a.length)for(var c of a)b=c.LCID,this.Bmb.contains(b)||(this.ipa.push(c),this.Bmb.add(b));else c=u.AFrameworkApplication.lcid,({value:b}=this.qvc.Rf(c)).returnValue&&(this.ipa.push(b),this.Bmb.add(c));this.lkh()}lkh(){const a=bb.toArray(bb.select(bb.asEnumerable(this.ipa),b=>b.LCID)).join(",");Pi.a.aM("RecentlyUsedLcids",a,180)}Kyk(a,b){if(a&&!(0<a.options.length)){var c=-1,f=Tq.egg(this.ipa);this.ntf&&0<f.length&&(c=Tq.gLf(f),c=Tq.MDf(a,c,b),a.add(Tq.fgi(),null));this.mqd||
(this.mqd=Tq.gLf(this.Yxd));b=Tq.MDf(a,this.mqd,b);-1===c&&(c=b);a.selectedIndex=c}}a5k(a,b){if(this.ntf&&({value:c}=this.qvc.Rf(a)).returnValue){b=a!==b;if(this.Bmb.contains(a))a=Array.indexOf(this.ipa,c),0<=a&&(Array.removeAt(this.ipa,a),this.ipa.push(c)),b&&this.hCd++;else{this.Bmb.add(a);this.ipa.push(c);if(this.ipa.length>this.otf){var c=this.ipa.shift();this.Bmb.remove(c.LCID)}b&&this.mtf++}this.lkh()}}JZj(){const a=this.hCd+this.mtf;!this.t6e&&0<a&&(Z.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",
100*this.hCd/a),this.t6e=!0)}static gLf(a){return bb.toArray(bb.select(bb.asEnumerable(a),b=>{const c=document.createElement("OPTION");let f=b.displayName;c.value=b.LCID.toString();c.text=f;return c}))}static fgi(){const a=document.createElement("OPTION");a.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500";
a.value="-1";a.disabled=!0;return a}static MDf(a,b,c){c=c.toString();let f=-1;for(const l of b)a.add(l,null),l.value===c&&(f=a.options.length-1);return f}static egg(a){a=Array.clone(a);a.sort((b,c)=>b.displayName.localeCompare(c.displayName));return a}}Object(e.a)(Tq,"LanguageListHelper",null,[1225]);var Ow=d(250);class Jt extends Ow.a{constructor(){super();this.Type=this.Number=0}get ControlType(){return 10}}Object(e.a)(Jt,"NumberButtonProps",Ow.a,[]);class yr{static get Ehl(){return yr.Lxf||(yr.Lxf=
fb.a.instance.qb("Box4.ISpacingCommands"))}static get brh(){return!!yr.Ehl}static ub(){const a=u.AFrameworkApplication.Ta;a.ya(E.a.VHa,Bb.a.view,yr.VHa);a.he(E.a.VHa,1126)}static VHa(a,b,c,f,l){if(1===c||!yr.brh)return yr.brh?32:8;if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up)a=[],a.push(Object.assign(new Jt,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),a.push(Object.assign(new Jt,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),a.push(Object.assign(new Jt,{ExternalId:"LineSpacing1_50",
Number:1.5,Type:0})),a.push(Object.assign(new Jt,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),a.push(Object.assign(new Jt,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),a.push(Object.assign(new Jt,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),l.MenuItems=lj.d(a);else{a=lj.g("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0);b=lj.g("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0);c=lj.g("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0);f=lj.g("buttonLineSpacing2_00",
"2.00","2759860553","4080183461",2,0);const x=lj.g("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),G=lj.g("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),R=lj.a("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions);a=lj.c("LineSpacing.Menu.Controls",[a,b,c,f,x,G,R]);a=lj.e("msLineSpacing",a,"Menu");a=lj.f([a]);l.PopulationXML=a}return 32}}yr.Lxf=null;Object(e.a)(yr,"LineSpacingRibbonMenu",null,[]);var XO=d(1085),YO=d(911);const ZO=(a,b,c)=>{if(1===
c)return 32;a=Cb.App.Hb.notificationBar.nBa("Automation test",!1);a.image=3;Cb.App.Hb.notificationBar.Wh(a);return 32},aP=(a,b,c,f,l)=>{let x;if(!({hFh:x}=$O(l)).returnValue)return 16;Ej.UISurfaces.gN().then(G=>{let R=null;var fa=Object.assign(new XO.a,{label:"OK",onExecute:()=>{R&&G.removeNotification(R)}});fa=Object.assign(new YO.a,{target:"#"+I.AppFrame.Fih,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:fa,useTeachingStyles:x});fa=G.callout(fa);R=G.addNotification(fa);
return null},G=>{Z.ULS.sendTraceTag(541172639,383,15,"Failed to GetNotificationsAPIAsync: {0}",G);return null});return 32},$O=a=>{let b;b=!1;if(!a)return{returnValue:!1,hFh:b};b=Boolean.parse(a);return{returnValue:!0,hFh:b}};class BA{constructor(a){this.yH=a}xKb(a){this.yH&&this.yH.VF(a)}}Object(e.a)(BA,"RibbonButtonUpdater",null,[1224]);var uF=d(292);class CA{constructor(){this.d6=this.Da=null}get name(){return"Box4.UI"}Wb(a){this.Da=a;a.register(1167,"Common.IReactContextualUILauncher").ma().na(()=>
new lF(a.resolve("CommandUI.ReactRibbonRoot"),a.resolve("Common.IExternalUICommandDefinitionMapping")));a.register(1168,"Box4.IContextMenuController").ma().na(()=>new nF(a.resolve("Common.IReactContextualUILauncher")));a.register(1169,"Box4.IGeneralCuiUser").na(()=>new sF(a.resolve("Box4.UI.CuiActionBridge"),u.AFrameworkApplication.Ta)).ma();a.register(AA,"Box4.UI.TableAltTextDialogFactory").ma().na(()=>new AA(a.resolve("Box4.ITableEditor"),new uF.a,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));
a.register(363,"Box4.UI.ILanguageEditor").na(()=>new tF(qd.a.instance.Kj,a.qb("Box4.ITextFormattingCommands"),a.Ka("Box4.IAutoCorrectRules"),a.resolve("Box4.ILanguageReader")));a.register(1170,"Box4.UI.IAutoCorrectOptionsDialog").na(()=>new oF(a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(Tq,"Box4.UI.LanguageListHelper").as("Box4.UI.ILanguageListHelper").ma().na(()=>new Tq(u.AFrameworkApplication.fa.ka("RecentlyUsedLanguagesListIsEnabled")));
a.register(mF,"Box4.UI.ProofingRepeatedWordSectionBuilder").as("Box4.UI.IProofingRepeatedWordSectionBuilder").ma();a.register(xA,"Box4.UI.DefaultProofingContextMenuCreator").ma().na(()=>new xA(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder")));a.register(yA,"Box4.UI.ProofingContextMenuSectionFactory").as("Box4.UI.IProofingContextMenuSectionFactory").ma().na(()=>new yA(a.resolve("Box4.UI.DefaultProofingContextMenuCreator"),a.resolve("Box4.UI.EditorServiceProofingContextMenuCreator")));a.register(BA,
"Box4.RibbonButtonUpdater").as("Common.IRibbonButtonUpdater").ma().na(()=>new BA(this.Da.resolve("Box4.IAppFrame")))}init(){var a=Cb.App.Hb;const b=a.jb;Nm.Myj(Object(C.a)(b,b.rec,"onAuthenticationLost"),Object(C.a)(b,b.sec,"onAuthenticationRestored"),a.kli);xr.a.ub();a=u.AFrameworkApplication.Ta;a.ya(E.a.iCk,Bb.a.application,TO);a.pa(E.a.jdl,Bb.a.application,UO,96);a.pa(E.a.Kdl,Bb.a.application,VO,96);a=u.AFrameworkApplication.Ta;a.pa(E.a.Cfl,Bb.a.application,ZO,96);a.pa(E.a.Zcl,Bb.a.application,
aP,96);yr.ub();this.d6=this.Da.qb("Box4.IContextMenuController")}dispose(){this.d6&&(this.d6.dispose(),this.d6=null)}static main(){m.a.instance.Bc(new CA,6)}}Object(e.a)(CA,"Box4UIPackage",null,[2,3]);var vF=d(451),bP=d(862),ps=d(200),cP=d(535),nv=d(367),Tm=d(309),bj=d(71);class wF{constructor(a){this.ama=a}}Object(e.a)(wF,"ValidParentData",null,[]);var uy=d(361),dP=d(795),ov=d(289),xF=d(794),pv=d(595),tm=d(241),yF=d(348),mq=d(220);class zF{constructor(){this.jrb=0}}Object(e.a)(zF,"BelowOutlineElementData",
null,[]);var qs=d(408),eP=d(583),fP=d(470);class AF extends qs.a{constructor(a,b,c,f){super(4,f);this.sMh=a;this.Bpd=b;this.Uqd=c}get PHc(){return this.sMh}get wTb(){return this.Bpd}get DLd(){return this.Uqd}kub(){var a=this.PHc;if(!a)return Z.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;const b=[],c=new eP.a(this.PHc.id,this.PHc.Vn,this.wTb?this.wTb.id:null);""!==a.characterData&&a.characterData&&(a=new fP.DeleteTextUpdateHint(this.PHc.id,
0,a.characterData),Array.add(b,a));Array.add(b,c);return b}}Object(e.a)(AF,"DeleteParagraphOperation",qs.a,[]);var gP=d(582),hP=d(469);class DA extends qs.a{constructor(a,b,c,f,l){super(3,l);this.mAd=a;this.nAd=b;this.pQb=f}get sHa(){return this.mAd}get hDb(){return this.nAd}get jHa(){return this.pQb}kub(){const a=[];var b=new gP.AddParagraphUpdateHint(this.jHa.id,this.jHa.Vn,this.sHa?this.sHa.id:null);Array.add(a,b);""!==this.jHa.characterData&&this.jHa.characterData&&(b=new hP.a(this.jHa.id,0,this.jHa.characterData),
Array.add(a,b));return a}}Object(e.a)(DA,"InsertNewParagraphOperation",qs.a,[]);var iP=d(581);class BF extends qs.a{constructor(a,b,c,f){super(2,f);this.mAd=a;this.nAd=b;this.JSh=c}get sHa(){return this.mAd}get hDb(){return this.nAd}get cVg(){return this.JSh}kub(){const a=[],b=new iP.MergeParagraphUpdateHint(this.sHa.id,this.sHa.Vn,this.sHa.characterData.length,this.hDb.id,this.hDb.Vn,this.cVg.id,this.cVg.Vn);Array.add(a,b);return a}}Object(e.a)(BF,"MergeParagraphOperation",qs.a,[]);var jP=d(580);
class CF extends qs.a{constructor(a,b,c,f,l){super(1,l);this.pAd=a;this.XXh=b;this.Bpd=c;this.Uqd=f}get tHa(){return this.pAd}get wTb(){return this.Bpd}get DLd(){return this.Uqd}get cil(){return this.XXh}kub(){const a=[],b=new jP.a(this.tHa.id,this.tHa.Vn,this.cil,this.wTb.id,this.wTb.Vn,this.DLd.id,this.DLd.Vn);Array.add(a,b);return a}}Object(e.a)(CF,"SplitParagraphOperation",qs.a,[]);var DF=d(312);class Tj{constructor(a,b,c,f,l,x=null){this.Ro=this.Xc=null;this.Cx=a;this.Po=b;this.Sg=c;this.SLh=
f;this.GSh=l;this.Goa=x}a0h(a){H.a.instance.ga(50)&&Cb.App.Ih&&Cb.App.Ih.Zv&&Cb.App.Ih.pY.Opa(a)}Kgb(a,b,c){Xb.OutlineElementNavigator.ri(a);yb.ParagraphReader.Rk(a)?Tj.paragraphEditor.hv.Kgb(a,b,c):Jd.TableReader.Vp(a)&&14===a.oi&&(b=(new ov.a(1,c)).oM,this.X7k(Object(ua.a)(uy.a,a.currentNode),b));Xb.OutlineElementNavigator.Ke(a)}X7k(a,b){a&&Object(Ma.a)(uy.a,a)&&(a.Rl=b)}get hv(){return nv.a.Htb}get Qf(){return this.Xc||(this.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get H5(){return this.Ro||
(this.Ro=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get jo(){return this.Po.value}get Tf(){return this.Sg.value}get hB(){return this.Cx.value}get Yi(){return ed.a.instance}sRd(){const a=cP.a.instance.createInstance(393229);a.setValue(tb.a.iE,Tm.a.first);a.setValue(tb.a.iEi,new Date);a.Nnd();return a}sBi(){const a=new bP.a;a.setValue(tb.a.iE,Tm.a.first);return a}khd(a,b,c){const f=a.Fh;if(f){f.id.equals(Tj.vZe)||(Tj.vZe=f.id,Tj.Uqc={});var l=Tj.Uqc[b];b in Tj.Uqc&&
f.d8a(l.id)&&f.Nw&&f.Nw.YZ(l.id)||(l=new mq.a,l.setValue(tb.a.author,b),l=f.pIa(l));a.properties.setValue(c,l.id);Tj.Uqc[b]=l}}qHb(a,b){a.properties.setValue(tb.a.lastModifiedTime,b)}PUe(a,b=null){const c=new Id.GraphTransaction(7);c.gd(a);b||(b=new Date);this.qHb(a,b);this.khd(a,this.GPc(),tb.a.VUb);""===ae.OutlineElementReader.jMc(a,tb.a.MCc)&&this.khd(a,this.GPc(),tb.a.MCc);c.dispose()}GPc(){return Cb.App.hSe.name}LUd(a,b,c=!1){if(H.a.instance.ga(56))ae.OutlineElementReader.Qbe(a)?(a=ae.OutlineElementReader.isRtl(a),
c?this.Thd(b,a):this.eJa(b,a)):this.EQk(b);else if(H.a.instance.ga(26)||H.a.instance.ga(89))a=ae.OutlineElementReader.isRtl(a),c?this.Thd(b,a):this.eJa(b,a)}MHb(a,b){var c=new nb.GraphIterator;c.set(a);c.pc(11);c=c.Rg(11);ae.OutlineElementReader.jm(c)!==b&&(this.eJa(c,b),H.a.instance.ga(54)?a.anchor.rr(4):(c=1,b&&(c=3),a.setValue(tb.a.xl,c),a.setValue(tb.a.EI,c)))}eJa(a,b){const c=new Id.GraphTransaction(7);c.gd(a);this.Thd(a,b);if(H.a.instance.ga(26)){var f=new nb.GraphIterator;f.set(a);f.Ab(2)&&
yb.ParagraphReader.Rk(f)&&(f=f.currentNode,b?(f.me(Kg.a.Udd,!0),Tj.paragraphEditor.$L(f,3)):(f.removeProperty(Kg.a.Udd),Tj.paragraphEditor.$L(f,1)))}f=new nb.GraphIterator;f.set(a);DF.a.instance.SCj(f);if(f.pc(10)){const l=f.Rg(10);f.Ab(1)===a&&this.hB.eJa(l,b)}c.dispose()}Thd(a,b){let c=null,f=null;if(this.Qf.ag&&a.isConnected){c=yb.ParagraphReader.xOc(a,!0,!0);f=new Ha.a;for(let l=0;l<c.count;l++)12===c.ga(l).type&&f.add(c.ga(l).E7())}b?a.properties.setValue(tb.a.HX,!0):H.a.instance.ga(56)?a.properties.setValue(tb.a.HX,
!1):(H.a.instance.ga(26)||H.a.instance.ga(89))&&a.properties.removeProperty(tb.a.HX);if(this.Qf.ag&&c&&f)if(c.count!==f.count)Z.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",c.count,f.count);else for(a=0;a<c.count;a++)c.ga(a),f.ga(a)}EQk(a){a.properties.removeProperty(tb.a.HX)}yba(a,b=null,c=!1){let f=null,l=null;if(!ae.OutlineElementReader.Ug(a))return Z.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),
null;var x=null;let G=null,R=0;b&&(x=b.formatting,G=b.style,R=b.languageId);c||({sHa:f,hDb:l}=this.t8f(a));b=ps.a.instance.createInstance(393230);b.setValue(tb.a.iq,"");a.pl(b,2);a.Gk(b);Tj.paragraphEditor.njc(b);Tj.paragraphEditor.tck(b);Tj.paragraphEditor.KKb(b);this.a0h(b);x&&(b.Ra.first.formatting.em=x);R||(R=u.AFrameworkApplication.lcid);a.currentNode.me(tb.a.Zfb,a.currentNode.sa(tb.a.Zfb,R));H.a.instance.ga(54)&&a.currentNode.setValue(Mb.a.Nfc,0);!H.a.instance.ga(71)||H.a.instance.ga(61)||G||
(x=Uc.StyleReader.MK(b))&&(G=x.DG(Uc.StyleReader.Cna));this.SLh.jQi(a);G&&Tj.HO.y$(G,b,!0);!c&&f&&(c=new DA(f,l,f,new pv.a(b),b.uPa),a.currentNode.zG().graphTransactionOperations.aZ(c));return b}t8f(a){let b;const c=new nb.GraphIterator;c.Pc(a);b=null;c.Ivg?c.currentNode.zG().graphTransactionOperations.Cha(6):(Xb.OutlineElementNavigator.Ava(c,!0,!1),b=this.zNc(c));c.Pc(a);a=this.d9f(c);return{sHa:b,hDb:a}}d9f(a){const b=new nb.GraphIterator;b.Pc(a);a=null;b.cwb||(Xb.OutlineElementNavigator.eJ(b,!0,
!1),a=this.zNc(b));return a}zNc(a,b=!1){a=Xb.OutlineElementNavigator.ri(a,!0);return a?this.wbg(a,b):(Z.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)}wbg(a,b=!1){if(12===a.type)return b?new pv.a(a):new xF.a(a);a.zG().graphTransactionOperations.Cha(5);return new dP.a(a)}gqi(a,b){var c=b.currentNode.clone();a.SK(c,null,1);a.Gk(c);c.oZ=b.currentNode;Xb.OutlineElementNavigator.ri(b);b.fW&1&&b.currentNode.j_a(null);c=b.currentNode.clone();c.xU=b.currentNode.xU;a.SK(c,
null,2);a.Gk(c);a.KS(1);c.oZ=b.currentNode;H.a.instance.ga(55)&&c.setValue(Mb.a.Vn,De.a.xXa());b.lB(11)}njc(a){a.Ab(2)&&a.Ii()}Bgh(a,b){const c=a.currentNode;Xb.OutlineElementNavigator.ri(a);const f=a.currentNode;Xb.OutlineElementNavigator.Ke(a);b.HA(1);Xb.OutlineElementNavigator.ri(b);a.pl(b.currentNode,2);b.Ii();var l=new nb.GraphIterator;l.Pc(b);if(l.Ab(1)){const x=new nb.GraphIterator;x.Pc(a);const G=new wF(null);if(!this.sjj(x,l.currentNode,G))return;tm.h(x,null,1,1,l,-1)}b.Ii();l=null;a.lF(1)&&
(l=a.currentNode);for(a.yc();Vh.OutlineNavigator.T9(b);)a.SK(b.currentNode,l,1),l=b.currentNode,b.Ii();a.Gk(c);a.Gk(f);a.Ii()}LIb(a,b,c,f,l,x=!1){this.njc(b);const G=b.oi;var R=a.currentNode;let fa=null;var wa=null;let Wa=null,mb=!1;Xb.OutlineElementNavigator.ri(a);const Kb=a.oi;if(yb.ParagraphReader.Rk(a)){var nc=a.currentNode;(wa=Object(ua.a)(se.AParagraphNode,nc))?wa.Ra&&wa.Ra.length||Z.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",wa):Z.ULS.sendTraceTag(38925731,
307,15,"srcParaNode is null");wa=new pv.a(wa);(mb=c.Qa===yb.ParagraphReader.textLength(nc))&&(Wa=this.d9f(b));var oc=b.currentNode;fa=this.yba(b,void 0,!0);Tj.paragraphEditor.yPe(a,b,c,l,!0,x);H.a.instance.ga(71)&&(f?(l=Uc.StyleReader.BD(nc))&&Tj.HO.y$(l,fa,!0):mb&&(l=Uc.StyleReader.BD(nc))&&((nc=l.sa(Kg.a.ZWg,null))?(l=Uc.StyleReader.MK(fa).DG(nc),Tj.HO.y$(l,fa,!1)):Tj.HO.y$(l,fa,!0)));this.LUd(R,oc);this.jo.KUd(R,oc)}Xb.OutlineElementNavigator.Ke(a);Xb.OutlineElementNavigator.Ke(b);R=ae.OutlineElementReader.isEmpty(a,
!0);oc=ae.OutlineElementReader.isEmpty(b,!0);H.a.instance.ga(27)&&R&&!oc&&(b.fW&1&&(R=new yF.a,R.Pc(b),b.currentNode.j_a(R)),this.khd(b.currentNode,ae.OutlineElementReader.jMc(a.currentNode,tb.a.VUb),tb.a.VUb),this.khd(b.currentNode,ae.OutlineElementReader.jMc(a.currentNode,tb.a.MCc),tb.a.MCc),this.qHb(b.currentNode,ae.OutlineElementReader.g8i(a.currentNode)));Xb.OutlineElementNavigator.ri(a);(R=Object(ua.a)(se.AParagraphNode,a.currentNode))?R.Ra&&R.Ra.length||Z.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",
R):Z.ULS.sendTraceTag(38925761,307,15,"srcPara is null");R=new pv.a(R);Xb.OutlineElementNavigator.Ke(a);(a=fa)?a.Ra&&a.Ra.length||Z.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",a):(Z.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),Z.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{["splittingAtEnd"]:mb,["moveText"]:!0,["overrideParagraphStyle"]:f,["sourceOutlineElementContentNodeType"]:Kb,["destinationOutlineElementNodeType"]:G,
["alwaysMoveEopToDestinationPara"]:x}));mb?(c=new DA(wa,Wa,R,new pv.a(a),a.uPa),b.currentNode.zG().graphTransactionOperations.aZ(c)):(c=new CF(wa,c.Qa,R,new pv.a(a),a.uPa),b.currentNode.zG().graphTransactionOperations.aZ(c))}sNf(a,b){Xb.OutlineElementNavigator.ri(a);let c=yb.ParagraphReader.Xr(a.currentNode);const f=a.currentNode;H.a.instance.ga(14)&&(c=b?c&&!this.Yi.zuk(f):c&&!this.Yi.tuk(f));Xb.OutlineElementNavigator.Ke(a);return c}merge(a,b,c,f,l=null,x=!1,G=!1,R=!1){if(a.currentNode.id===b.currentNode.id)return!1;
let fa,wa;var Wa=new nb.GraphIterator;Wa.Pc(b);fa=this.zNc(Wa);Wa.Pc(a);wa=this.zNc(Wa,!0);if(!this.sNf(b,!0)||!this.sNf(a,!1))return!1;if(this.Tf.Ahc){var mb=Object(ua.a)(se.AParagraphNode,a.currentNode);mb=(c||!mb||!mb.characterData.length)&&!Ib.ListReader.kk(a)}else mb=this.GSh.Rzl(c,a);R||this.jo.merge(a,b,mb,l);Xb.OutlineElementNavigator.ri(a);l=a.currentNode.uPa;Xb.OutlineElementNavigator.ri(b);if(yb.ParagraphReader.Rk(b)){if(H.a.instance.ga(50)&&Cb.App.Ih.Zv){R=b.currentNode;mb=a.currentNode;
const Kb=vF.CoauthLockEditor.getInstance();if(Kb.iIb(this.Yi.z0b(R))||Kb.iIb(this.Yi.z0b(mb)))return b.yc(),a.yc(),!1}R=!1;Ib.ListReader.Ww&&(mb=a.parentNode)&&ae.OutlineElementReader.k8(mb)&&(R=Ib.ListReader.zSa(mb));H.a.instance.ga(71)&&(mb=(mb=yb.ParagraphReader.isEmpty(a)||c)&&!R)&&(mb=Uc.StyleReader.vgg(b))&&Tj.HO.y$(mb,a.currentNode,!0);c&&this.Goa.Oek(b.currentNode,a.currentNode,R,G);c=Tj.paragraphEditor.merge(a,b,c,f,x);f=Wa.currentNode;Wa=a.currentNode;a.yc();c&&ae.OutlineElementReader.isEmpty(b,
!0)&&this.FBa(b);a=new BF(wa,fa,new xF.a(f),l);Wa.zG().graphTransactionOperations.aZ(a);return!0}b.yc();a.yc();return!1}SBj(a){const b=new nb.GraphIterator;b.set(a.node);b.af();Xb.OutlineElementNavigator.Ke(b);const c=this.d4b(b),f=this.d4b(b);this.LIb(b,c,a,!1,!0);ae.OutlineElementReader.isEmpty(b,!1)&&(this.jo.Pma(b),b.Ii());ae.OutlineElementReader.isEmpty(c,!1)&&!ae.OutlineElementReader.n9a(c)&&(this.jo.Pma(c),c.Ii());return f}xca(a,b,c,f=null,l=!1){if(!this.bli(a))return null;const x=a.currentNode,
G=Ib.ListReader.kk(a);b||l||ae.OutlineElementReader.isEmpty(a,!1);l=this.jo.kcl(G);b=b?a.lF(1):a.currentNode;a.yc();c=this.hB.c4b(a,b,c,f);if(!c)return null;this.LUd(x,c);this.jo.KUd(x,c);l&&this.jo.$pl(a,x);return c}bli(a){return ae.OutlineElementReader.Ug(a)&&(a=a.parentNode,bj.OutlineReader.z5b(a)||ae.OutlineElementReader.k8(a)||ae.OutlineElementReader.ata(a))?!0:!1}BPk(a){const b=new nb.GraphIterator;b.set(a);b.af();b.lB(11);let c,f;({sHa:c,hDb:f}=this.t8f(b));let l=-1;12===a.type&&(l=a.uPa);
b.currentNode.zG().graphTransactionOperations.aZ(new AF(this.wbg(a,!0),c,f,l));this.FBa(b)}FBa(a){if(a.pI(1)){const b=new zF,c=new nb.GraphIterator;c.Pc(a);this.O_i(c,b)&&this.hv.UHc(a,-b.jrb)}a.Ii();Jd.TableReader.hs(a)&&this.szk(a)}O8d(a,b,c){if(!bj.OutlineReader.Lt(a)&&!ae.OutlineElementReader.Ug(a))return null;const f=this.sBi();0<c&&c<Tm.a.last&&f.setValue(tb.a.iE,Math.min(Tm.a.nil,c));a.SK(f,b,1);return f}UBj(a,b){if(!ae.OutlineElementReader.Ug(a)&&!ae.OutlineElementReader.vI(a)||!bj.OutlineReader.qW(a.parentNode)&&
!ae.OutlineElementReader.k8(a.parentNode))return null;const c=a.currentNode;let f;f=a.currentNode;a.yc();b=this.O8d(a,f,b);a.Gk(c);return b}szk(a){ae.OutlineElementReader.vI(a)&&(a.pI(1)||a.Ii());this.l6f(a,!1);this.cGf(a)}l6f(a,b){var c,f=null;for(c=a.Ab(1);c;){var l=!1;ae.OutlineElementReader.ata(c)&&!a.pI(1)&&(l=!0);var x=c;c=a.zj(1);if(l)l=new nb.GraphIterator,l.set(x),l.af(),l.Ii();else if(ae.OutlineElementReader.ata(x)){if(f){l=new nb.GraphIterator;l.set(f);var G=new nb.GraphIterator;G.set(x);
G.af();l.pl(G.currentNode,1);G.Ii();G=ae.OutlineElementReader.O2(x);G===Tm.a.nil&&(G=1);(G=Math.max(0,ae.OutlineElementReader.O2(x)-G))?x.setValue(tb.a.iE,Math.min(Tm.a.nil,G)):(l.Gk(x),a.Ab(1),tm.e(l),l.yc());b&&this.l6f(l,!0)}}else f=x}b=null;f=Tm.a.last+1;for(c=a.Ab(1);c;c=a.zj(1))if(ae.OutlineElementReader.vI(a))x=ae.OutlineElementReader.O2(c),f>x&&(f=x,b=c);else{a.yc();return}if(b){for(c=a.Ab(1);c;c=a.zj(1))c!==b&&a.currentNode.setValue(tb.a.iE,Math.min(Tm.a.nil,ae.OutlineElementReader.O2(c)-
f));f+=ae.OutlineElementReader.O2(a.currentNode);a.currentNode.setValue(tb.a.iE,Math.min(Tm.a.nil,f));c=new nb.GraphIterator;c.Pc(a);c.Gk(b);c.Ab(1);tm.e(c)}}sjj(a,b,c){var f=ae.OutlineElementReader.O2(a.currentNode);if(1===f)return!0;if(ae.OutlineElementReader.vI(a))return!1;if(!a.B7(1)||this.cMj(a,b))return a.currentNode.setValue(tb.a.iE,Math.min(Tm.a.nil,1)),!0;if(c.ama&&a.Gk(c.ama)){if(ae.OutlineElementReader.vI(a)&&1===f+ae.OutlineElementReader.O2(a.currentNode))return c.ama=a.HA(1),a.yc(),!0;
a.yc()}if(c.ama&&a.Gk(c.ama)||!c.ama&&a.Ab(1)){if(a.currentNode!==b&&a.vf(1)&&ae.OutlineElementReader.vI(a)&&1===f+ae.OutlineElementReader.O2(a.currentNode))return c.ama=null,!0;a.yc()}if(a.HRa(b)&&this.bMj(a,b)){for(c=a.Ab(1);c;c=a.zj(1))c!==b&&c.setValue(tb.a.iE,Math.min(Tm.a.nil,ae.OutlineElementReader.O2(c)+(f-1)));a.currentNode.setValue(tb.a.iE,Math.min(Tm.a.nil,1));return!0}if(1>f)return f=this.O8d(a,c.ama,1-f),a.Gk(f),c.ama=null,!0;if(1<f){a.currentNode.setValue(tb.a.iE,Math.min(Tm.a.nil,1));
b=null;let l=a.Ab(1);for(;l;){if(ae.OutlineElementReader.vI(a)){l.setValue(tb.a.iE,Math.min(Tm.a.nil,f-1+ae.OutlineElementReader.O2(l)));l=a.zj(1);continue}b||(b=this.UBj(a,f-1));const x=l;l=tm.j(a,b,1);l===b&&(l=a.zj(1));c.ama===x&&(c.ama=b,b=null)}return!0}return!1}cMj(a,b){return nb.GraphIterator.Sba(()=>{if(1===a.B7(1)){const c=a.Ab(1);a.yc();if(c===b)return!0}return!1})}bMj(a,b){return nb.GraphIterator.Sba(()=>{let c;for(c=a.Ab(1);c;c=a.zj(1))if(c!==b&&!ae.OutlineElementReader.vI(a))return a.yc(),
!1;return!0})}O_i(a,b){b.jrb=0;do{const c=a.currentNode;if(a.Ab(1))b.jrb-=ae.OutlineElementReader.O2(c);else{if(bj.OutlineReader.Lt(a)||null===a.currentNode)return!1;if(3!==a.role||!a.aja(1))for(;!a.zj(1);)if(b.jrb+=ae.OutlineElementReader.O2(a.currentNode),bj.OutlineReader.Lt(a)||null===a.currentNode)return!1}}while(ae.OutlineElementReader.vI(a));return!0}d4b(a,b=!1){return this.N8d(a,!1,b)}N8d(a,b,c=!1){const f=new nb.GraphIterator;f.Pc(a);a=new nb.GraphIterator;a.Pc(f);this.xca(a,b,!1,null,c);
a.currentNode.setValue(tb.a.iE,Math.min(Tm.a.nil,ae.OutlineElementReader.O2(f.currentNode)));f.Ab(1)&&tm.h(a,null,1,1,f,-1);return a}cGf(a){if(ae.OutlineElementReader.pVk(a)){1!==ae.OutlineElementReader.O2(a.currentNode)&&a.currentNode.setValue(tb.a.iE,Tm.a.first);for(var b=a.Ab(1);b;)if(ae.OutlineElementReader.vI(a)){b=new nb.GraphIterator;b.Pc(a);b.yc();const c=new nb.GraphIterator;c.Pc(a);c.Ab(1);tm.h(b,a.currentNode,1,1,c,-1);b=a.rPa(1)}else this.cGf(a),b=a.zj(1)}}static get HO(){return Tj.iK||
(Tj.iK=fb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static set HO(a){Tj.iK=a}static get paragraphEditor(){return Tj.Hw||(Tj.Hw=fb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){Tj.Hw=a}}Tj.iK=null;Tj.Hw=null;Tj.vZe=null;Tj.Uqc=null;Object(e.a)(Tj,"OutlineElementEditor",null,[1253]);var Pw=d(109),Qw=d(400),EF=d(586),nq=d(254);class Yn{constructor(a){this.Gif=a}tBi(){const a=ps.a.instance.createInstance(393228);a.setValue(tb.a.iE,Tm.a.first);a.setValue(tb.a.Dei,0);
a.setValue(tb.a.Rx,bj.OutlineReader.dXf);(new EF.OutlineIndentInfo(!0)).pkh(a);return a}eZ(a,b,c=null){const f=a.currentNode;if(!a.HA(1))return this.c4b(a,null,b,c);ae.OutlineElementReader.vI(a)&&Xb.OutlineElementNavigator.Zue(a,!0);return ae.OutlineElementReader.Ug(a)?Yn.Nh.xca(a,!1,b,c):(a.akc(f),null)}ali(a){return bj.OutlineReader.kbe(a.currentNode)||ae.OutlineElementReader.Ug(a)||ae.OutlineElementReader.vI(a)||Se.isTableCell(a)}c4b(a,b=null,c=!1,f=null){if(!this.ali(a))return null;const l=Yn.Nh.sRd();
this.S6k(l,a);a.gSc(l,b,1,this.Gif.f8f());a.Gk(l);c&&(Yn.Nh.yba(a,f),Xb.OutlineElementNavigator.Ke(a));H.a.instance.ga(25)&&Yn.Nh.PUe(a.currentNode);return l}S6k(a,b){if(b=this.udj(b))switch(b.type){case 11:Yn.Nh.LUd(b,a,!0);break;case 8:b=Yn.Ak.isRtl(b),Yn.Nh.Thd(a,b)}}udj(a){return this.Gif.K2d(a)}D3i(a,b){a=Yn.Ak.bOc(a);return new Qw.a(a.x+bj.OutlineReader.CHc*(b?-1:1),a.y+bj.OutlineReader.lXf)}Lhd(a){if(H.a.instance.ga(17)){var b=new nb.GraphIterator;b.set(a);b.Mu();b=this.D3i(b.origin,bj.OutlineReader.jm(a));
nq.c(a,b.x,b.y)}}eJa(a,b){H.a.instance.ga(43)&&Tf.c(a)||a.setValue(tb.a.EI,b?11:9)}static get Ak(){return Pw.PageReader.instance}static get Nh(){return Yn.Ai||(Yn.Ai=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static set Nh(a){Yn.Ai=a}}Yn.Ai=null;Yn.Hf=null;Object(e.a)(Yn,"OutlineEditor",null,[1254]);const kP=a=>{a.register(Yn,"Box4.OutlineLevelEditors.OutlineEditor").as("Box4.IOutlineEditor").ma().na(()=>new Yn(a.resolve("Box4.IOutlineElementNodeIdFactory")));a.register(Tj,"Box4.OutlineLevelEditors.OutlineElementEditor").as("Box4.IOutlineElementEditor").ma().na(()=>
new Tj(a.le("Box4.IOutlineEditor"),a.le("Box4.List.IListEditor"),a.le("Box4.List.IListReader"),a.resolve("Box4.ICreateParagraphStrategy"),a.resolve("Box4.IMergeListEditorInOutlineElementStrategy"),a.resolve("Box4.IFormattingPropertyTransitStrategy")))};class EA{get name(){return"Box4.OutlineLevelEditors"}Wb(a){kP(a)}init(){}dispose(){}static main(){m.a.instance.Bc(new EA)}}Object(e.a)(EA,"Box4OutlineLevelEditorsPackage",null,[2,3]);class FA{get name(){return"Box4.TableEditors"}Wb(){}init(){}dispose(){}static main(){m.a.instance.Bc(new FA)}}
Object(e.a)(FA,"Box4TableEditorsPackage",null,[2,3]);class GA{get name(){return"Box4.TextLevelEditors"}Wb(){}init(){}dispose(){}static main(){m.a.instance.Bc(new GA)}}Object(e.a)(GA,"Box4TextLevelEditorsPackage",null,[2,3]);class zr{constructor(a,b,c){this.rAd=this.c2a=this.oAd=this.b2a=this.oyd=null;this.YF=a;this.XMh=b;this.Qc=c;this.init()}init(){this.XMh.ob(Object(C.a)(this,this.vnj,"handleEditingViewUpdatesSafe"));this.b2a=new ef.a;this.oAd=new ef.a;this.c2a=new ef.a;this.rAd=new Si.a}CXa(a){this.b2a.add(a.key,
a)}yFe(a){this.c2a.add(a.key,a)}vnj(a){try{this.unj(a)}catch(b){a=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",b.message,b.stack),Z.ULS.sendTraceTag(5285580,334,10,a)}}unj(a){let b;({qSd:b}=zr.gsl(this.Qc.Oa.kb)).returnValue&&(a=zr.i2i(a,this.oyd,b),this.VCk(a,b),this.oyd=b)}VCk(a,b){a=this.NZi(a,b);let c;({notification:c}=zr.$rl(a)).returnValue&&this.YF.sendNotification(c,!1)}NZi(a,b){const c=new ef.a;c.$(1,new Si.a);c.$(0,new Si.a);a.forEach(f=>
{3===f?(W.ImageReader.LG(b.node)||this.uVk(b),this.Daj(c,b)):0===f&&this.G2i(c,b);return!0});return c}uVk(a){this.b2a.forEach((b,c)=>{c.reset(a);return!0})}G2i(a,b){let c=new ef.a;W.ImageReader.LG(b.node)||(c=this.D2i(b.Qa));this.E2i(a,this.oAd,c,zr.plh(this.oyd,b));this.oAd=c}D2i(a){const b=new ef.a;this.b2a.forEach((c,f)=>{c=null;({oAa:c}=f.yoc(a)).returnValue&&b.$(f.key,c);return!0});return b}E2i(a,b,c,f){const l=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;b.forEach((x,G)=>{const R=this.b2a.ga(x).d7||
G.title;let fa;({value:fa}=c.Rf(x)).returnValue?f&&fa.yP!==G.yP&&(R&&a.ga(1).add(R),x=this.b2a.ga(x).d7,x=String.format(l,fa.title,x),fa.description&&(x+=", "+fa.description),a.ga(0).add(x)):R&&a.ga(1).add(R);return!0});c.forEach((x,G)=>{b.Jb(x)||(x=this.b2a.ga(x).d7,x=String.format(l,G.title,x),G.description&&(x+=", "+G.description),a.ga(0).add(x));return!0})}Daj(a,b){b=this.qgj(b.node);b=this.cri(b);this.rgj(a,this.rAd,b);this.rAd=b}qgj(a){const b=new nb.GraphIterator;b.set(a);if(!b.pc(1))return null;
const c=new Si.a;for(;1!==b.oi;)this.c2a.forEach((f,l)=>{let x;({Aqb:x}=l.ITe(b)).returnValue&&c.add(x);return!0}),b.yc();c.reverse();return c}cri(a){a=a.toArray();let b=0;for(;b<a.length-1;){var c=a[b];if(c.j0===a[b+1].j0&&(this.c2a.ga(c.j0),({fri:c}={returnValue:!1,fri:null}).returnValue)){a.splice(b,2,c);continue}b++}return new Si.a(a)}rgj(a,b,c){var f;for(f=0;f<Math.min(c.length,b.length)&&c.ga(f).contentId.equals(b.ga(f).contentId);f++){var l=this.c2a.ga(c.ga(f).j0).TMc(c.ga(f),b.ga(f));l&&(c.ga(f).description&&
(l+=", "+c.ga(f).description),a.ga(0).add(l))}for(l=f;l<c.length;l++){let x=this.c2a.ga(c.ga(l).j0).TMc(c.ga(l),null);x&&(c.ga(l).description&&(x+=", "+c.ga(l).description),a.ga(0).add(x))}for(c=f;c<b.length;c++)(f=this.c2a.ga(b.ga(c).j0).d7)&&a.ga(1).add(f)}static i2i(a,b,c){const f=new Si.a;(a=a||zr.B0k(b,c))?(f.add(3),f.add(0)):zr.plh(b,c)&&f.add(0);return f}static B0k(a,b){return!a||!a.node.id.equals(b.node.id)}static plh(a,b){return!a||!a.equals(b)}static gsl(a){let b;b=null;if(!a||!(cb.SelectionEditor.Uw(a)||
(a=cb.SelectionEditor.Hl(a,!0,!1),cb.SelectionEditor.Uw(a)||a.Ua&&W.ImageReader.LG(a.Ua.node))))return{returnValue:!1,qSd:b};b=a.Ua;return{returnValue:!!b,qSd:b}}static $rl(a){const b=new Si.a;a.ga(1).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,c);b.add(c);return!0});a.ga(0).forEach(c=>{c=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,c);b.add(c);return!0});a=b.toArray().join(" ");return{returnValue:0<b.length,notification:a}}}
Object(e.a)(zr,"AccessibilityContextManager",null,[1220]);class Rw{constructor(a,b){this.acf=!1;this.ORb=null;this.syc=this.aAc=!1;this.a3e=null;this.Rd=a;this.okb=b}get Etj(){return!!this.ORb}ob(a){this.acf||(this.okb.REf(Object(C.a)(this,this.UBc,"afterEditingViewValidateEventHandler")),this.acf=!0);this.a3e=a}UBc(a,b){(b.lM||b.mU)&&this.iik(b.lM,b.mU)}iik(a,b){this.Etj&&this.Rd.Ng(this.ORb);this.aAc=this.aAc||a;this.syc=this.syc||b;this.ORb=new xe.a(4,1,Rw.mPi,()=>{this.a3e(this.aAc,this.syc);
this.reset()},126);this.Rd.Cb(this.ORb)}reset(){this.ORb=null;this.syc=this.aAc=!1}}Rw.mPi=100;Object(e.a)(Rw,"EditingViewOnAfterValidateEventsConsolidator",null,[1219]);class HA{constructor(){this.Da=null}get name(){return"Box4.Accessibility"}init(){Cb.App.RIf&&this.Da.resolve("Box4.Accessibility.IAccessibilityContextManager")}dispose(){}Wb(a){this.Da=a;a.register(Rw,"Box4.Accessibility.EditingViewOnAfterValidateEventsConsolidator").as("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator").ma().na(()=>
new Rw(u.AFrameworkApplication.pe,a.resolve("Box4.ContentEditableViewEventSource")));a.register(zr,"Box4.Accessibility.AccessibilityContextManager").as("Box4.Accessibility.IAccessibilityContextManager").ma().na(()=>new zr(a.resolve("Common.Utils.IAriaNotifier"),a.resolve("Box4.Accessibility.IEditingViewOnAfterValidateEventsConsolidator"),qd.a.instance))}static main(){m.a.instance.Bc(new HA)}}Object(e.a)(HA,"Box4AccessibilityPackage",null,[2,3]);class IA{constructor(a,b){this.Quf=a;this.K1=b;this.euf=
this.Ptf=this.Qtf=this.duf=this.RZe=this.fuf=!0}get Ifb(){return this.fuf}get dEc(){return this.RZe}get dfd(){return this.duf}get Gjc(){return this.Qtf}get bfd(){return this.Ptf}get QGe(){return this.euf}GMf(a){if(a)for(let c in a){var b=c;const f=Boolean.parse(a[c].toString()||"false");switch(b){case "ReplaceTextAsYouType":this.fuf=f;break;case "CapitalizeFirstLetterOfSentences":this.RZe=f;break;case "ReplaceOrdianalsWithSuperscript":this.duf=f;break;case "ReplaceHyphensWithDash":this.Qtf=f;break;
case "ReplaceFractionsWithFractionCharacter":this.Ptf=f;break;case "ReplaceQuoteWithSmartQuote":this.euf=this.K1&&f}}}A_i(){this.Quf.m4d("getAutoCorrectOptionsSettings","ReplaceTextAsYouType CapitalizeFirstLetterOfSentences ReplaceOrdianalsWithSuperscript ReplaceHyphensWithDash ReplaceFractionsWithFractionCharacter ReplaceQuoteWithSmartQuote".split(" ")).continueWith(Object(C.a)(this,this.Fmk,"onGetRequestFinished"),8);Z.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")}xZk(a){this.Quf.Xoh("saveAutoCorrectOptionsSettings",
a);Z.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service.");this.GMf(a)}Fmk(a){a.hm?Z.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service."):((a=a.result)&&this.GMf(a),Z.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",!a||!ta.a.count(a)))}}Object(e.a)(IA,"AutoCorrectOptionsInfo",null,[1331]);var vy=d(211);class tj{static get CJf(){tj.MLb||(tj.MLb=[],tj.oCb(sa.a.oe("ar-sa")),
tj.oCb(sa.a.oe("de-de")),tj.oCb(sa.a.oe("es-es")),tj.QQ(sa.a.oe("en-029"),sa.a.oe("en-us")),tj.QQ(sa.a.oe("en-au"),sa.a.oe("en-us")),tj.QQ(sa.a.oe("en-bz"),sa.a.oe("en-us")),tj.QQ(sa.a.oe("en-ca"),sa.a.oe("en-us")),tj.QQ(sa.a.oe("en-gb"),sa.a.oe("en-us")),tj.QQ(sa.a.oe("en-id"),sa.a.oe("en-us")),tj.QQ(sa.a.oe("en-my"),sa.a.oe("en-us")),tj.QQ(sa.a.oe("en-ph"),sa.a.oe("en-us")),tj.QQ(sa.a.oe("zh-tw"),sa.a.oe("en-us")),tj.oCb(sa.a.oe("fr-fr")),tj.QQ(sa.a.oe("hr-ba"),sa.a.oe("hr-hr")),tj.QQ(sa.a.oe("it-ch"),
sa.a.oe("it-it")),tj.QQ(sa.a.oe("nb-no"),sa.a.oe("nn-no")),tj.oCb(sa.a.oe("nl-nl")),tj.QQ(sa.a.oe("ro-md"),sa.a.oe("ro-ro")),tj.QQ(sa.a.oe("ru-md"),sa.a.oe("ru-ru")),tj.QQ(sa.a.oe("sr-latn-ba"),sa.a.oe("sr-latn-cs")),tj.QQ(sa.a.oe("sr-latn-me"),sa.a.oe("sr-latn-cs")),tj.QQ(sa.a.oe("sr-latn-rs"),sa.a.oe("sr-latn-cs")),tj.oCb(sa.a.oe("sr-cyrl-cs")),tj.QQ(sa.a.oe("sv-fi"),sa.a.oe("sv-se")));return tj.MLb}static oCb(a){tj.MLb[a.languageId]=a.LCID}static QQ(a,b){tj.MLb[a.LCID]=b.LCID}static Kag(a){var b=
sa.a.oe(a);if(!b)return 0;b=tj.CJf[b.LCID]||tj.CJf[b.languageId]||0;return b===a?0:b}}tj.MLb=null;Object(e.a)(tj,"AutoCorrectListFallback",null,[]);class Zn{constructor(a,b,c,f,l){this.V9e=!1;this.Uef=0;this.DLa=null;this.CWh=!1;this.Oef=this.Xgf=!0;this.x8e=null;this.ovc=!0;this.plb=a;this.ELa=b;this.w1a=c;this.r6=f;this.Yg=l;this.DQb=a?a.innerText:yb.ParagraphReader.text(b)}get Tw(){throw Error.notImplemented("The inherit class should have the default value.");}set Tw(a){}get iXc(){return this.Uef}oph(a){this.Uef=
a}get kb(){return this.DLa}set kb(a){this.DLa=a}get Tmg(){return this.plb}get Yig(){return this.ELa}get cA(){return this.w1a}get RQ(){return this.r6}get NCb(){return this.Xgf}set NCb(a){this.Xgf=a}get Bvg(){return this.V9e}get qAg(){return!1}get sma(){return this.DQb}invoke(){this.V9e=!0;if(this.plb&&this.plb.parentNode&&!this.Tw){var a=this.plb.innerText;if(this.NCb&&Ka.a.substring(this.DQb,this.w1a,this.r6)!==Ka.a.substring(a,this.w1a,this.r6))return 0;this.w5a(this.plb);this.oph(this.plb.innerText.length-
a.length);return 1}this.ovc||rb.a.instance.Tb("MatchTextIsNotTheSame",{["Reason"]:"MatchTextIsNotTheSame"});if(!this.Oef)return rb.a.instance.Tb("AbortedAction",{["Reason"]:this.x8e}),0;var b=yb.ParagraphReader.text(this.ELa);a=b.length;var c=this.DQb.length,f=Ka.a.substring(this.DQb,this.w1a,this.r6).trimEnd();b=Ka.a.substring(b,this.w1a,this.r6).trimEnd();f===b&&this.r6>c&&(this.r6=c);if(this.NCb&&f!==b)if(c=f.replace(RegExp('"',"g"),""),c===Ka.a.substr(b,0,c.length))this.r6-=2;else return 0;if(H.a.instance.ga(50)&&
Cb.App.Ih.Zv&&vF.CoauthLockEditor.getInstance().iIb(Zn.Yi.z0b(this.ELa)))return 0;c=new Id.GraphTransaction(15);c.gd(this.ELa);c.fd=this.commandId;this.p7(this.ELa);this.oph(yb.ParagraphReader.textLength(this.ELa)-a);this.DLa&&!this.CWh&&cb.SelectionEditor.Uw(this.DLa)&&(b=this.DLa.Ua,a=b.Qa,f=b.Kb,b=b.node,b===this.ELa&&this.iXc&&(a>=this.r6&&(a+=this.iXc),f>=this.r6&&(f+=this.iXc),this.DLa=rd.SelectionFactory.p2(b,a,f)));c.dispose();return 2}wFh(){this.ovc=this.TOf()}w5a(){}TOf(){var a=yb.ParagraphReader.text(this.ELa);
const b=Ka.a.substring(this.DQb,this.w1a,this.r6).trimEnd();a=Ka.a.substring(a,this.w1a,this.r6).trimEnd();return b===a}static get Yi(){return ed.a.instance}}Object(e.a)(Zn,"AutoCorrectAction",null,[1271]);class $n extends Zn{constructor(a,b,c,f,l,x){super(a,b,c,f,x);this.dff=null;this.Ola=l;this.RU=x}get rTa(){return this.dff||(this.dff=fb.a.instance.qb("Box4.List.IListCommands"))}get jo(){return $n.Po||($n.Po=fb.a.instance.resolve("Box4.List.IListEditor"))}get Tw(){return!0}get commandId(){return E.a.nLd}set Tw(a){super.Tw=
a}}$n.Po=null;Object(e.a)($n,"RegexCorrectAction",Zn,[]);const qv={[0]:{"a)":{autonumberBulletType:2,Ni:[65533,4,41]},"a.":{autonumberBulletType:4,Ni:[65533,4,46]},"A.":{autonumberBulletType:5,Ni:[65533,3,46]},"1)":{autonumberBulletType:7,Ni:[65533,0,41]},"1.":{autonumberBulletType:8,Ni:[65533,0,46]},"i.":{autonumberBulletType:14,Ni:[65533,2,46]},"I.":{autonumberBulletType:15,Ni:[65533,1,46]}},[1]:{"*":{Ni:[8226],font:"Arial"},"-":{Ni:[45],font:"Calibri"},"--":{Ni:[167],font:"Wingdings"},">":{Ni:[216],
font:"Wingdings"},"<>":{Ni:[118],font:"Wingdings"}}};class Yo extends $n{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x);Yo.bLa=x}get commandId(){return E.a.fLd}p7(a){if(this.rTa){var b=nb.GraphIterator.mb(a);b.af();Xb.OutlineElementNavigator.Ke(b);if(this.jo.Wid()){var c=Yo.Tf.Pw(b),f=this.Ola[0];switch(Ka.a.charAt(f,0)){case "*":var l=Ae.a.AP(1,1);l.qqa="*";break;default:l=Ae.a.AP(1,0)}c&&l.Y5d(c)||(c=new Id.GraphTransaction(15),c.iy(b),b=this.i0i(l.listType,l.listStyle,f),null!=b&&this.rTa.Ihi(b)&&
(Z.ULS.sendTraceTag(509747285,393,50,"Found list insert matching string "+f),Yo.bLa.replaceTextRange(Mc.a.createTextRange(a,this.cA,this.RQ+1),"",!0,!1)),c.dispose())}}}i0i(a,b,c){var f;let l=null===(f=null===qv||void 0===qv?void 0:qv[a])||void 0===f?void 0:f[c];if(null==l)return null;c=new D.DictionaryPropertySet;c.setValue(Oc.a.LD,a);c.setValue(Oc.a.Vca,b);c.setValue(tb.a.Ni,l.Ni);c.setValue(tb.a.font,l.font);return c}static get characterPropertiesEditor(){return Yo.bLa||(Yo.bLa=fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Tf(){return Yo.Sg||
(Yo.Sg=fb.a.instance.resolve("Box4.List.IListReader"))}static RB(a,b,c,f,l){return new Yo(null,a,b,c,f,l)}static BP(a,b,c,f,l){return new Yo(a,Qc.a(a).$a,b,c,f,l)}}Yo.bLa=null;Yo.Sg=null;Object(e.a)(Yo,"BulletListAction",$n,[]);class Yg extends $n{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x);this.WOb=!1;this.Tw=!a;this.bLa=x;Yg.$k=new Lc.a}get Tw(){return this.WOb}set Tw(a){this.WOb=a}w5a(a){this.cOd(a.innerText,(b,c,f)=>{a.innerText=Ka.a.substring(a.innerText,0,b)+f+Ka.a.right(a.innerText,c)})}p7(a){this.cOd(yb.ParagraphReader.text(a).substring(this.cA,
this.RQ),(b,c,f)=>{this.bLa.replaceTextRange(Mc.a.createTextRange(a,this.cA+b,this.cA+c),f,!0,!1)})}cOd(a,b){if(!(2>this.Ola.length)&&this.Ola[1]){var c=this.Ola[1];Yg.$k.count||this.n7g();Yg.$k.Jb(c)&&(a=a.lastIndexOf(c),-1!==a&&b(a,a+c.length,Yg.$k.ga(c)))}}}Yg.$k=null;Object(e.a)(Yg,"DictionarySequenceReplacerAction",$n,[]);class Sw extends Yg{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return E.a.WUb}n7g(){Yg.$k.$("--","\u2014");Yg.$k.$(" -- "," \u2013 ");Yg.$k.$(" - "," \u2013 ");
Yg.$k.$("-- ","\u2014");Yg.$k.$(" --"," \u2013");Yg.$k.$(" -"," \u2013")}static RB(a,b,c,f,l){return new Sw(null,a,b,c,f,l)}static BP(a,b,c,f,l){return new Sw(a,Qc.a(a).$a,b,c,f,l)}}Object(e.a)(Sw,"DashAction",Yg,[]);class Kt extends Yg{constructor(a,b,c,f,l,x,G){super(a,b,c,f,l,x);this.Ca=G}get commandId(){return E.a.hLd}n7g(){Yg.$k.$(":)","\ud83d\ude0a");Yg.$k.$(":-)","\ud83d\ude0a");Yg.$k.$(":|","\ud83d\ude10");Yg.$k.$(":-|","\ud83d\ude10");Yg.$k.$(":(","\ud83d\ude41");Yg.$k.$(":-(","\ud83d\ude41");
Yg.$k.$(";)","\ud83d\ude09");Yg.$k.$(";-)","\ud83d\ude09");Yg.$k.$(":D","\ud83d\ude00");Yg.$k.$(":-D","\ud83d\ude00");Yg.$k.$(":')","\ud83d\ude02");Yg.$k.$("=D","\ud83d\ude03");Yg.$k.$(":>","\ud83d\ude06");Yg.$k.$(":->","\ud83d\ude06");Yg.$k.$(":3","\ud83d\ude0a");Yg.$k.$(":-3","\ud83d\ude0a");Yg.$k.$("B-)","\ud83d\ude0e");Yg.$k.$("*-*","\ud83d\ude0d");Yg.$k.$(":*","\ud83d\ude19");Yg.$k.$(":-*","\ud83d\ude19");Yg.$k.$(":X","\ud83d\ude36");Yg.$k.$(":-X","\ud83d\ude36");Yg.$k.$(":O","\ud83d\ude2e");
Yg.$k.$(":-O","\ud83d\ude2e");Yg.$k.$(":#","\ud83e\udd10");Yg.$k.$(":-#","\ud83e\udd10");Yg.$k.$(":P","\ud83d\ude1b");Yg.$k.$(":-P","\ud83d\ude1b");Yg.$k.$(";P","\ud83d\ude1c");Yg.$k.$(";-P","\ud83d\ude1c");Yg.$k.$(":-/","\ud83d\ude15");Yg.$k.$("$-$","\ud83e\udd11");Yg.$k.$(":S","\ud83d\ude16");Yg.$k.$(":-S","\ud83d\ude16");Yg.$k.$(":[","\ud83d\ude1f");Yg.$k.$(":-[","\ud83d\ude1f");Yg.$k.$(":\u2019(","\ud83d\ude22");Yg.$k.$(":'(","\ud83d\ude22");Yg.$k.$("@-@","\ud83d\ude31")}p7(a){this.cOd(yb.ParagraphReader.text(a).substring(this.cA,
this.RQ),(b,c,f)=>{b=Mc.a.createTextRange(a,this.cA+b,this.cA+c);c={};c.MenuItemId=f;this.Ca.ki(b,E.a.BBj,2,!1,null,c,null)})}static RB(a,b,c,f,l,x){return new Kt(null,a,b,c,f,l,x)}static BP(a,b,c,f,l,x){return new Kt(a,Qc.a(a).$a,b,c,f,l,x)}}Object(e.a)(Kt,"EmojiAction",Yg,[]);class Qp{constructor(a,b,c,f){this.TJ=a;this.Qzc=b;this.Ydf=f;this.zz=c}Nxg(){if(!this.zz)return!1;this.TJ=this.TJ.trimStart();return this.TJ===this.zz?!0:!1}LSj(){if(!this.TJ)return!1;const a=this.TJ.lastIndexOf(" ");return-1!==
a&&"."===this.TJ.charAt(a-1)&&"."===this.TJ.charAt(a-3)?!0:!1}KSj(){if(!this.TJ)return!1;const a=this.TJ.lastIndexOf(" ");return-1!==a&&"."===this.TJ.charAt(this.TJ.substring(0,a-1).lastIndexOf(" ")+2)?!0:!1}VLj(){return this.Nxg()&&(1===this.zz.length&&"."===this.Qzc||"."===this.TJ.charAt(1))?!0:!1}WLj(){return this.zz?0<="\\/".indexOf(this.Qzc)||3===this.zz.length&&0<="\\/".indexOf(this.zz.charAt(1))?!0:!1:!1}XKj(){return this.zz?0<=this.zz.indexOf("@")?!0:!1:!1}Qs(){if(!this.zz)return!1;for(const a of Qp.C4d())if(Ka.a.startsWith(this.zz+
this.Qzc,a))return!0;return!1}GKj(){return this.zz?"i"===this.zz&&0<=Qp.quotes.indexOf(this.Qzc)?!0:!1:!1}hGj(){if(!this.TJ)return!1;const a=Ka.a.wEa(this.TJ,this.TJ.length-1);if(-1!==a&&this.TJ.substring(a+1,this.TJ.length)===this.zz){const b=this.TJ.charAt(a-1);if(0<=Qp.UJe.indexOf(b)||0<=Qp.quotes.indexOf(b)&&0<=Qp.UJe.indexOf(this.TJ.charAt(a-2)))return!0}return!1}Vmi(){return!this.TJ||this.LSj()||this.VLj()||this.WLj()||this.KSj()||this.XKj()||this.Qs()?!1:this.Nxg()||this.GKj()||this.hGj()?
!0:!1}static C4d(){return Qp.bff||(Qp.bff="http: https: ftp:// mailto: \\\\ www.".split(" "))}}Qp.UJe=".!?";Qp.quotes="'\"";Qp.bff=null;Object(e.a)(Qp,"FirstLetterUpperCaseRules",null,[]);class oq{constructor(a){this.zz=a}VWi(){if(!this.zz)return null;for(let a=0;a<oq.hig().length;a++)if(this.zz===oq.hig()[a])return oq.pkj()[a];return null}static hig(){return oq.r5e||(oq.r5e=["1/2","1/4","3/4"])}static pkj(){return oq.q5e||(oq.q5e=["\u00bd","\u00bc","\u00be"])}}oq.r5e=null;oq.q5e=null;Object(e.a)(oq,
"FractionsCollection",null,[]);class JA extends Zn{constructor(a,b,c,f,l,x){super(a,b,c,f,x);this.DMb=l;this.RU=x}get Tw(){return!0}get commandId(){return E.a.iLd}w5a(a){a.innerText=Ka.a.substring(a.innerText,0,this.cA)+this.DMb+Ka.a.right(a.innerText,this.RQ)}p7(a){this.RU.replaceTextRange(Mc.a.createTextRange(a,this.cA,this.RQ),this.DMb,!0,!1)}set Tw(a){super.Tw=a}static RB(a,b,c,f,l){return new JA(null,a,b,c,f,l)}}Object(e.a)(JA,"FractionsReplaceCorrectAction",Zn,[]);class rs extends $n{constructor(a,
b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return E.a.kLd}p7(a){if(this.rTa){var b=nb.GraphIterator.mb(a);b.af();Xb.OutlineElementNavigator.Ke(b);if(this.jo.Wid()){var c=this.Ola[0],f=rs.yik(c),l=Ka.a.x6b(c.charAt(0))?4:2,x=Mc.a.createTextRange(a,this.cA,this.RQ+1);this.jo.YNa(a,b,l,f,x,c,this.rTa)}}}static RB(a,b,c,f,l){return new rs(null,a,b,c,f,l)}static BP(a,b,c,f,l){return new rs(a,Qc.a(a).$a,b,c,f,l)}static yik(a){if(!a)return 0;a=Ka.a.wg(a);if(!Ka.a.WSc(a.charAt(0)))return 0;const b=a.charCodeAt(0)-
97+1;let c;for(c=1;c<a.length&&a.charAt(c)===a.charAt(0);c++);return 26*(c-1)+b}}Object(e.a)(rs,"LetterListAction",$n,[]);class Tw extends $n{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return E.a.YNa}p7(a){if(this.rTa){var b=nb.GraphIterator.mb(a);b.af();Xb.OutlineElementNavigator.Ke(b);if(this.jo.Wid()){var c=this.Ola[0],f=parseInt(c);if(!(99999999<=f)){var l=Mc.a.createTextRange(a,this.cA,this.RQ+1);this.jo.YNa(a,b,1,f,l,c,this.rTa)}}}}static RB(a,b,c,f,l){return new Tw(null,a,
b,c,f,l)}static BP(a,b,c,f,l){return new Tw(a,Qc.a(a).$a,b,c,f,l)}}Object(e.a)(Tw,"NumberListAction",$n,[]);class Rp extends Zn{constructor(a,b,c,f,l){super(a,b,c,f,l);Rp.RU=l}get Tw(){return!0}get commandId(){return E.a.lLd}w5a(){}p7(a){const b=Mc.a.createTextRange(a,this.RQ-2,this.RQ),c=new Id.GraphTransaction(15);c.gd(a);let f=!1,l=null,x=0;for(;x<a.Ra.length;){var G=a.Ra.ga(x),R=!!G.Ao||G.Nca;let fa=!!G.fieldRangeEnd||G.UZ;if(G.cp>=b.Qa){G.cp>b.Qa||!G.formatting?l=f?G.formatting:Rp.RU.mfa(a,x,
b.Qa,l):(l=G.formatting,fa&&(f=!1),R&&(f=!0));x++;break}G.formatting&&(l=G.formatting);fa&&(f=!1);R&&(f=!0);x++}for(;x<a.Ra.length;){R=a.Ra.ga(x);if(R.cp>=b.Kb){if(R.cp>b.Kb||!R.formatting&&!R.Ij)f||Rp.RU.mfa(a,x,b.Kb,l);f||Rp.ih.eY(l,!0);break}R.formatting&&(f||Rp.ih.eY(l,!0),l=R.formatting);G=!!R.Ao||R.Nca;R=!!R.fieldRangeEnd||R.UZ;G&&(f=!0);!G&&R&&(f=!1);x++}c.dispose()}set Tw(a){super.Tw=a}static get ih(){return Rp.Hf||(Rp.Hf=fb.a.instance.resolve("Box4.IFormattingEditor"))}static RB(a,b,c,f){return new Rp(null,
a,b,c,f)}}Rp.RU=null;Rp.Hf=null;Object(e.a)(Rp,"OrdinalsReplaceCorrectAction",Zn,[]);class kl extends $n{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x);kl.Amb||kl.mjl();this.bLa=x}get commandId(){return E.a.mLd}p7(a){if(!a.Msj){var b=this.DLa.Ua.node===a,c=-1,f=3;this.Ola[2]&&(c=parseInt(this.Ola[2]));this.Ola[1]&&(f=parseInt(this.Ola[1]));if(!(20<c||100<f)){a.zG().graphTransactionOperations.Cha(7);var l=nb.GraphIterator.mb(a);l.af();Xb.OutlineElementNavigator.Ke(l);kl.Nh.xca(l,!1,!1);kl.Nh.yba(l);for(let R=
0;R<f;++R){const fa=[];var x=R%kl.Amb.length,G=0<c?c:kl.Amb[x].length;for(let wa=0;wa<G;++wa)Array.add(fa,kl.Amb[x][wa%kl.Amb[x].length]);x=Mc.a.ak(l.currentNode,0);G=vb.a.Ls(x);2!==Cb.App.mode?kl.ih.zYa(G,1142):kl.ih.um(G,Mb.a.noProof,!0);this.bLa.replaceTextRange(x,fa.join(" "),!0,!1);R<f-1&&(Xb.OutlineElementNavigator.Ke(l),kl.Nh.xca(l,!1,!1),kl.Nh.yba(l))}c=l.currentNode;l=nb.GraphIterator.mb(a);l.af();Xb.OutlineElementNavigator.Ke(l);l.Ii();b&&(this.DLa=rd.SelectionFactory.Mg(c,yb.ParagraphReader.textLength(c)))}}}static get Nh(){return kl.Ai||
(kl.Ai=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get ih(){return kl.Hf||(kl.Hf=fb.a.instance.resolve("Box4.IFormattingEditor"))}static mjl(){kl.Amb=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.",
"Proin pharetra nonummy pede.","Mauris et orci."]]}static RB(a,b,c,f,l){return new kl(null,a,b,c,f,l)}static BP(a,b,c,f,l){return new kl(a,Qc.a(a).$a,b,c,f,l)}}kl.Amb=null;kl.Ai=null;kl.Hf=null;Object(e.a)(kl,"RandAction",$n,[]);class FF{constructor(a,b,c,f){this.pattern=f&8?new RegExp(a,"i"):new RegExp(a);this.pvj=b;this.klj=c;this.flags=f}}Object(e.a)(FF,"RegexAutoCorrectEntry",null,[]);class rn extends $n{constructor(a,b,c,f,l,x){super(a,b,c,f,l,x)}get commandId(){return E.a.oLd}p7(a){if(this.rTa){var b=
nb.GraphIterator.mb(a);b.af();Xb.OutlineElementNavigator.Ke(b);if(this.jo.Wid()){var c=this.Ola[0],f=Ka.a.substring(c,0,c.indexOf("."));f=rn.zik(f);if(!(0>=f)){var l=Ka.a.x6b(c.charAt(0))?5:3,x=Mc.a.createTextRange(a,this.cA,this.RQ+1);this.jo.YNa(a,b,l,f,x,c,this.rTa)}}}}static RB(a,b,c,f,l){return new rn(null,a,b,c,f,l)}static BP(a,b,c,f,l){return new rn(a,Qc.a(a).$a,b,c,f,l)}static yOi(){rn.opa||(rn.opa={},rn.opa.M=1E3,rn.opa.D=500,rn.opa.C=100,rn.opa.L=50,rn.opa.X=10,rn.opa.V=5,rn.opa.I=1)}static zik(a){if(!a)return 0;
rn.yOi();a=Ka.a.rB(a);let b=0,c=0;for(let f=a.length-1;0<=f;f--){const l=rn.opa[Ka.a.charAt(a,f).toString()];c=l<b?c-l:c+l;b=l}return c}}rn.opa=null;Object(e.a)(rn,"RomanListAction",$n,[]);class Uw extends Zn{constructor(a,b,c,f,l,x){super(a,b,c,c+1,x);this.RU=x;this.BZh=f;this.o0e=l;this.NCb=!1}get Tw(){return!1}get commandId(){return E.a.Zci}w5a(a){a.innerText=Ka.a.substring(a.innerText,0,this.cA)+this.o0e+Ka.a.right(a.innerText,this.RQ)}p7(a){this.RU.replaceTextRange(Mc.a.createTextRange(a,this.cA,
this.RQ),this.BZh,!0,!1);this.RU.replaceTextRange(Mc.a.createTextRange(a,this.cA,this.cA+1),this.o0e,!0,!1)}set Tw(a){super.Tw=a}static RB(a,b,c,f,l,x){if("'"!==c&&'"'!==c)return null;var G=nb.GraphIterator.mb(a);G.af();Xb.OutlineElementNavigator.Ke(G);if(ae.OutlineElementReader.jm(G.currentNode))return null;f=!b||Ka.a.dde(f)||-1!==Array.indexOf(Uw.tsk,f);G="'"===c;return new Uw(x,a,b,c+"",f?G?"\u2018":"\u201c":G?"\u2019":"\u201d",l)}}Uw.tsk=["[","{","("];Object(e.a)(Uw,"SmartQuoteCorrectAction",
Zn,[]);class ss extends Zn{constructor(a,b,c,f,l,x){super(a,b,c,f,x);this.DMb=l;this.RU=x}get Tw(){return ss.WOb}set Tw(a){ss.WOb=a}get commandId(){return E.a.qLd}wFh(){this.ovc=this.TOf();this.ovc||(this.Oef=!1,this.x8e="MatchTextIsNotTheSame")}w5a(a){a.innerText=Ka.a.substring(a.innerText,0,this.cA)+this.DMb+Ka.a.right(a.innerText,this.RQ)}p7(a){this.RU.replaceTextRange(Mc.a.createTextRange(a,this.cA,this.RQ),this.DMb,!0,!1)}static BP(a,b,c,f,l){const x=Qc.a(a);return new ss(a,x?x.$a:null,b,c,f,
l)}static RB(a,b,c,f,l){return new ss(null,a,b,c,f,l)}}ss.WOb=!1;Object(e.a)(ss,"StringReplaceCorrectAction",Zn,[]);class wy extends Zn{constructor(a,b,c,f,l,x,G,R){super(a,b,c,f,l);this.RU=l;this.dD=x;this.yQh=G;this.hD=R}get Tw(){return!0}get commandId(){return E.a.sLd}w5a(a){let b=Ka.a.substring(a.innerText,this.cA,this.RQ);b.charAt(0)!==b.charAt(0).toUpperCase()&&(b=b.charAt(0).toUpperCase()+b.substring(1,b.length));a.innerText=Ka.a.substring(a.innerText,0,this.cA)+b+Ka.a.right(a.innerText,this.RQ)}p7(a){const b=
this.cA,c=this.cA+1,f=a.characterData.substring(b,c).charAt(0);Ka.a.x6b(f)||(a=Mc.a.createTextRange(a,b,c),this.yGj(a)||this.RU.replaceTextRange(a,f.toUpperCase().toString(),!0,!1))}yGj(a){return this.yQh?!!this.dD&&this.dD.Xsa(a):!1}set Tw(a){super.Tw=a}static BP(a,b,c,f){const l=Qc.a(a);return new wy(a,l?l.$a:null,b,c,f,null,!1,null)}static RB(a,b,c,f,l,x,G){return new wy(null,a,b,c,f,l,x,G)}}Object(e.a)(wy,"UpperFirstLetterAutoCorrect",Zn,[]);class Ar{constructor(a,b){this.Ydf=b;this.zz=a}XAl(){const a=
Number.parseInvariant(this.zz.substring(0,this.zz.length-2));switch(Number.parseInvariant(this.zz.charAt(this.zz.length-3).toString())){case 1:return 11===a?"th":"st";case 2:return 12===a?"th":"nd";case 3:return 13===a?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}}fMj(){var a=sa.a.oe(this.Ydf);if(!a||!a.name.toLowerCase().startsWith("en")||!this.zz||2>=this.zz.length)return!1;for(a=0;a<Ar.QPc().length;a++)if(this.zz.toLowerCase().endsWith(Ar.QPc()[a])){if(RegExp("^\\d+$").test(this.zz.substr(0,
this.zz.length-2))){const b=this.XAl();if(this.zz.toLowerCase().endsWith(Ar.QPc()[a])&&b===Ar.QPc()[a])return!0}break}return!1}static QPc(){return Ar.rif||(Ar.rif=["st","nd","rd","th"])}}Ar.rif=null;Object(e.a)(Ar,"ValidateOrdinalsRule",null,[]);class Um{constructor(a,b,c,f,l,x,G){this.a2a=[];this.Sjb=[];this.LLb=[];this.Jqd=[];this.Loa=-1;this.Nwd=this.q7e=this.K1=this.Lsc=!1;this.Ttc=a;this.Yg=b;this.dD=c;this.Ca=f;this.nR=x;this.hD=G;l?(this.Lsc=l.ka("WordEditorEmoticonAutoCorrectIsEnabled")||
l.ka("OneNoteInsertEmojiIsEnabled"),this.K1=l.ka("ReplaceQuoteWithSmartQuoteIsEnabled"),this.q7e=l.ka("HyperlinkUrlValidationIsEnabled"),this.Nwd=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertBulletViaKeyboardEnabled",!1),Z.ULS.sendTraceTag(23418953,324,50,"{0}",{["WordEditorEmoticonAutoCorrectIsEnabled"]:this.Lsc,["ReplaceQuoteWithSmartQuoteIsEnabled"]:this.K1})):(Z.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),
this.K1=this.Lsc=!1)}E$d(a){return 0<=Um.gLd.indexOf(a)}BRj(a){return 0<=Um.rLd.indexOf(a)}Wwg(a){return a.toLowerCase()===a}x6b(a){return a.toUpperCase()===a}WSc(a){return a.toLowerCase()!==a.toUpperCase()}oIj(a,b,c,f){return(new Qp(a,b,c,f)).Vmi()}S2i(a){do{if(a.getAttribute("xml:lang"))return sa.a.oe(a.getAttribute("xml:lang"))||sa.a.n4b;if(a.getAttribute("lang"))return sa.a.oe(a.getAttribute("lang"))||sa.a.n4b;a=a.parentNode}while(a&&1===a.nodeType);return sa.a.n4b}x_d(a){return sa.a.oe(vb.a.language(vb.a.Ls(a)))||
sa.a.n4b}OKc(a,b){0>b&&(b=0);let c=-1;const f=Um.gLd.length;for(let l=0;l<f;++l){const x=a.lastIndexOf(Ka.a.charAt(Um.gLd,l),b);x>c&&(c=x)}a=Ka.a.wEa(a,b);a>c&&(c=a);return c}zTi(a){for(let b=0;b<a.length;++b)if(this.WSc(Ka.a.charAt(a,b)))return b;return-1}G5f(a,b){if(!a||0>b)return-1;let c=b;c=c?this.OKc(a,c-1):-1;c=c>Ka.a.wEa(a,b-1)?c:Ka.a.wEa(a,b-1);c++;return c}z5f(a,b,c){if(!H.a.instance.ga(70))return null;this.KZb(b);if(!this.Sjb[b])if(b=tj.Kag(b),0<b){if(this.KZb(b),!this.Sjb[b])return null}else return null;
if(c&&this.LLb[b]&&Array.contains(this.LLb[b],a+c))return null;c=this.Sjb[b][Ka.a.wg(a)];if("string"!==typeof c||c===a)return null;if(c){var f=this.zTi(a);if(0>f||this.Wwg(Ka.a.charAt(a,f)))return c;b=!0;for(f+=1;f<a.length;++f){const l=Ka.a.charAt(a,f);b&&!this.x6b(l)&&(b=!1)}return b?Ka.a.rB(c):Ka.a.rB(Ka.a.substring(c,0,1))+Ka.a.right(c,1)}return null}HTi(a,b,c,f){Me.a.mark(4666);const l=this.S2i(b).LCID;let x=0,G=a;const R=b.innerText;if(this.V$d(R.substring(R.lastIndexOf(" ",a)+1,a)))return Me.a.mark(4667),
null;let fa=null;var wa=!1;do{G=G?this.OKc(R,G-1):-1;if(-1===G&&!c){wa=b;var Wa=null;if(!this.E$d(R.charAt(0))){do{for(;wa&&!wa.previousSibling;)wa=wa.parentNode;wa&&(wa=wa.previousSibling,Wa=wa.innerText)}while(wa&&!Wa);if(wa&&Wa&&!this.E$d(Ka.a.charAt(Wa,Wa.length-1)))return Me.a.mark(4667),null}wa=!0}Wa=Ka.a.substring(R,G+1,a);++x;var mb=this.z5f(Wa,l,f.toString());if(mb)fa=ss.BP(b,G+1,a,mb,this.Yg);else for(mb=0;mb<this.a2a.length;++mb){const Kb=this.a2a[mb];if(!(Kb.flags&1&&!(c&&1>G)||Kb.flags&
4||Kb.flags&2&&" "!==f)){const nc=Kb.pattern.exec(Wa);if(nc){fa=Kb.pvj(b,G+1,a,nc,this.Yg,this.Ca);break}}}}while(!wa&&!fa&&x<Um.sUg&&0<=G);Me.a.mark(4667);return fa}DTi(a,b,c){const f=a.node;let l=yb.ParagraphReader.text(f);0>b&&(b=a.Qa);a=this.x_d(a).LCID;if(this.V$d(l.substring(Ka.a.wEa(l,b)+1,b)))return null;var x=-1,G=Lb.HyperlinkReader.S0b(f);for(var R=0;R<G.length;R++)if(b>G[R].Kb)x=G[R].Kb;else{if(b>G[R].Qa)return null;break}G=null;R=(R=b)?this.OKc(l,R-1):-1;R<x&&(R=x-1);x=Ka.a.substring(l,
R+1,b);x=x.trimStart();if(1>R)for(let fa=0;fa<this.a2a.length;++fa){const wa=this.a2a[fa];let Wa=l;" "!==c&&(Wa=l+c);if(wa.pattern.exec(Wa))return null}l=l.substring(0,b);if(!this.oIj(l,c.toString(),x,a))return null;x.charAt(0).toUpperCase()!==x.charAt(0)&&(G=wy.RB(f,R+1,b,this.Yg,this.dD,H.a.instance.ga(14),this.hD));return G}d5f(a,b,c){a=rd.SelectionFactory.rj(a,!1);if(!a)return null;a=a.Ve;return cb.SelectionEditor.Pg(a)?this.DTi(a,b,c):null}V$d(a){return Ka.a.g8(a)}EXd(a,b,c,f){Me.a.mark(4666);
const l=a.node,x=this.x_d(a).LCID,G=yb.ParagraphReader.text(l);0>b&&(b=a.Qa);if(c&&!this.E$d(Ka.a.charAt(G,b))||this.V$d(G.substring(Ka.a.wEa(G,b)+1,b)))return Me.a.mark(4667),null;a=-1;c=Lb.HyperlinkReader.S0b(l);for(var R=0;R<c.length;R++)if(b>c[R].Kb)a=c[R].Kb;else{if(b>c[R].Qa)return null;break}c=0;R=b;let fa=null;do{R=R?this.OKc(G,R-1):-1;R<a&&(R=a-1);const Wa=Ka.a.substring(G,R+1,b);++c;var wa=this.z5f(Wa,x,this.Nwd&&f==w.a.yKa?".":null);if(wa)this.nR.Ifb&&(fa=ss.RB(l,R+1,b,wa,this.Yg));else for(wa=
0;wa<this.a2a.length;++wa){const mb=this.a2a[wa];if(!(!(!(mb.flags&1)||(this.Nwd?0>R:1>R))||mb.flags&4&&f!==w.a.lq||mb.flags&2&&f!==w.a.NO)){const Kb=mb.pattern.exec(Wa);if(Kb){fa=mb.klj(l,R+1,b,Kb,this.Yg,this.Ca);if(fa.commandId!==E.a.WUb&&!this.nR.Ifb||fa.commandId===E.a.WUb&&!this.nR.Gjc)fa=null;break}}}}while(0<=R&&R>=a&&!fa&&c<Um.sUg);Me.a.mark(4667);return fa}c5f(a,b,c){a=rd.SelectionFactory.rj(a,!1);if(!a)return null;a=a.Ve;return cb.SelectionEditor.Pg(a)?this.EXd(a,b,!1,c):null}j5f(a,b){a=
rd.SelectionFactory.rj(a,!1);if(!a)return null;a=a.Ve;if(!cb.SelectionEditor.Pg(a)||Lb.HyperlinkReader.Gja(a,!1))return null;var c=yb.ParagraphReader.text(a.node);const f=0<b?Ka.a.wEa(c,b-1)+1:Ka.a.wEa(c,c.length-1)+1;b=0<b?b:c.length;c=Ka.a.substring(c,f,b);return!c||this.q7e&&!Lb.HyperlinkReader.$ce(c)||!Ka.a.g8(c)&&!Ka.a.P4b(c)||!Um.hyperlinkEditor.tQk(a,f,b)?null:this.Ttc.$zi(a.node,f,b)}n5f(a,b){var c=rd.SelectionFactory.rj(a,!1);if(!c)return null;var f=c.Ve;if(!cb.SelectionEditor.Pg(f))return null;
0>b&&(b=f.Qa);var l=yb.ParagraphReader.text(f.node);c=this.G5f(l,b);const x=Um.rLd.length;for(let G=0;G<x;++G){const R=l.lastIndexOf(Ka.a.charAt(Um.rLd,G),b-1);R>c&&(c=R+1)}l=Ka.a.substring(l,c,b);if(!l)return null;f=this.x_d(f).LCID;return(new Ar(l,f)).fMj()?Rp.RB(a,c,b,this.Yg):null}b5f(a,b){var c=rd.SelectionFactory.rj(a,!1);if(!c)return null;c=c.Ve;if(!cb.SelectionEditor.Pg(c))return null;0>b&&(b=c.Qa);var f=yb.ParagraphReader.text(c.node);c=this.G5f(f,b);f=Ka.a.substring(f,c,b);return f?(f=(new oq(f)).VWi())?
JA.RB(a,c,b,f,this.Yg):null:null}lUi(a,b,c,f,l){var x=rd.SelectionFactory.rj(a,!1);if(!x)return null;x=x.Ve;if(c>b||!cb.SelectionEditor.Pg(x))return null;0>b&&(b=x.Qa);if(0>b)return null;x=yb.ParagraphReader.text(x.node);return Uw.RB(a,c,l,b?x.charAt(b-1):"\x00",this.Yg,f)}uAa(a,b,c,f){Array.add(this.a2a,new FF("^"+a+"$",b,c,f))}kue(a){if(this.Sjb[this.Loa]){const b=this.Sjb[this.Loa];for(let c in a)b[c]=a[c]}else this.Sjb[this.Loa]=a}lue(a){this.LLb[this.Loa]?Array.addRange(this.LLb[this.Loa],a):
this.LLb[this.Loa]=a}uHe(){this.Loa=-1}pLd(){this.FNi(this.Loa);this.Loa=-1}JVj(a,b){this.Jqd[b]||(this.Jqd[b]=!0,this.Loa=b,b=document.createElement("script"),b.type="text/javascript",b.src=a,b.setAttribute("onload","ResetListLcid();"),b.setAttribute("onerror","AutoCorrectRulesFallbackLogic();"),document.body.appendChild(b))}FNi(a){a=tj.Kag(a);0<a&&this.KZb(a)}TVj(){H.a.instance.ga(70)&&(this.KZb(1033),this.uAa("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",kl.BP,kl.RB,5),this.uAa("(\\d+)[\\.|\\)]",Tw.BP,
Tw.RB,3),this.uAa("(L|l|C|c|D|d|M|m){1}\\.",rs.BP,rs.RB,3),this.uAa("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",rn.BP,rn.RB,11),this.uAa("([A-Za-z]){1}[\\.|\\)]",rs.BP,rs.RB,3),this.uAa("\\*{1}$|^\\-{1,2}$|^>{1}$|^<>",Yo.BP,Yo.RB,3),this.uAa("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",Sw.BP,Sw.RB,0),this.Lsc&&(this.uAa("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Kt.BP,Kt.RB,0),this.uAa("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Kt.BP,Kt.RB,0)))}KZb(a){this.Jqd[a]||this.JVj(vy.a.Zei(String.format("Acl/Acl{0}.js",
a)),a)}static get hyperlinkEditor(){return Um.jn||(Um.jn=fb.a.instance.resolve("Box4.IHyperlinkEditor"))}}Um.gLd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014";Um.rLd=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\u00a9\u00ae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'";Um.UJe=".!?";Um.sUg=5;Um.jn=null;Object(e.a)(Um,"AutoCorrectRules",null,[1223]);class KA{constructor(a,b,c,f,l,x){this.Ooa=this.RE=null;this.NJ=a;this.Qc=b;this.hd=c;this.PYe=f.ka("AutoCorrectFirstLetterUpperCaseEnabled");this.SYe=
f.ka("AutoFormatOrdinalNumberAndFractionsEnabled");this.K1=f.ka("ReplaceQuoteWithSmartQuoteIsEnabled");this.Jaa=l;this.xya=!!x;this.Hs=x;this.AVh=new vt.a;this.xya&&this.Qc.VH(Object(C.a)(this,this.HDb,"onSetSelectionFinished"))}Boc(a,b,c=-1){if(this.Jaa.Ifb||this.Jaa.Gjc)if(b=this.NJ.j5f(a,c)||this.NJ.c5f(a,c,b))this.RE||(this.RE=new xf),this.RE.ya(b);this.PYe&&this.Jaa.dEc&&(b=this.NJ.d5f(a,c," "))&&(this.RE||(this.RE=new xf),0<this.RE.AEa&&(this.RE.Pra(0).Tw=!0,b.NCb=!1),this.RE.ya(b));this.SYe&&
(this.Jaa.dfd&&4!==Cb.App.mode&&(b=this.NJ.n5f(a,c))&&(this.RE||(this.RE=new xf),this.RE.ya(b),Z.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created.")),this.Jaa.bfd&&(a=this.NJ.b5f(a,c))&&(this.RE||(this.RE=new xf),this.RE.ya(a),Z.ULS.sendTraceTag(8271384,324,50,"Fractions autoformat action is created.")))}QTf(a,b,c,f,l,x){const G=new xf;if(0<b){if(!this.PYe&&this.Jaa.Ifb){var R=this.NJ.HTi(c,f,l,x);R&&G.ya(R)}else{if(this.Jaa.Ifb||this.Jaa.Gjc)if(R=0," "===x?R=w.a.NO:u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertBulletViaKeyboardEnabled",
!1)&&"."===x&&(R=w.a.yKa),R=this.NJ.c5f(a,b,R))R.Tw=!0,G.ya(R);this.Jaa.dEc&&(R=this.NJ.d5f(a,b,x))&&(0<G.AEa&&(R.NCb=!1),G.ya(R))}this.SYe&&(this.Jaa.dfd&&4!==Cb.App.mode&&(R=this.NJ.n5f(a,b))&&(G.ya(R),Z.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created.")),this.Jaa.bfd&&(R=this.NJ.b5f(a,b))&&(G.ya(R),Z.ULS.sendTraceTag(8271385,324,50,"Fractions autoformat action is created.")))}0<=b&&("'"===x||'"'===x)&&this.K1&&this.Jaa.QGe&&(R=this.NJ.lUi(a,b,c,f,x))&&(G.ya(R),Z.ULS.sendTraceTag(37363807,
324,50,"Smart quote action is created."));for(let fa of this.AVh.values)if((R=fa.QTf(a,b,c,f,l,x))&&!R.isEmpty())for(let wa=0;wa<R.AEa;wa++)G.ya(R.Pra(wa));return G}Hte(a,b){return this.NJ.j5f(a,b)}Akh(a){this.RE||(this.RE=new xf);this.RE.ya(a)}sDj(a){if(this.RE){var b=!1;for(var c=0;c<this.RE.AEa;c++){var f=this.RE.Pra(c);if(!f)return;if(!f.Bvg){b=!0;break}}if(b){b=this.Ooa=null;c=new Id.GraphTransaction(15);c.fd=a;a=!1;for(f=0;f<this.RE.AEa;f++){let l=this.RE.Pra(f);if(!l)return;if(l.Bvg)continue;
this.xya&&l.Tw&&l.qAg&&(b=l);a||(a=!0,c.gd(l.Yig));l.kb=this.Qc.Oa.kb;const x=this.hd.Kp(l.commandId);l.invoke();x.end();this.Qc.setSelection(l.kb)}this.RE=null;this.Ooa=b?b.commandId:null;a&&c.dispose()}}}tDj(a){this.Ooa=null;const b=new Id.GraphTransaction(15);b.gd(a.Yig);b.fd=a.commandId;a.kb=this.Qc.Oa.kb;const c=this.hd.Kp(a.commandId);a.invoke();c.end();this.Qc.setSelection(a.kb);this.xya&&a.Tw&&a.qAg&&(this.Ooa=a.commandId);b.dispose()}uDj(a){this.Ooa=null;return a.invoke()}Ptj(){return this.xya&&
!!this.Ooa}ckk(a){if(!this.xya||!this.Ooa)return!1;const b=this.Ooa;this.Ooa=null;if(!a||!this.Hs.aW||this.Hs.rSd!==b)return!1;this.Hs.undo();return!0}HDb(){this.Ooa=null}}Object(e.a)(KA,"AutoCorrectScheduler",null,[1222]);class Br extends Zn{constructor(a,b,c,f,l,x){super(a,b,c,f,l);this.Blf=this.A1=null;this.RU=l;this.Xc=x}get X7(){return this.A1||(this.A1=fb.a.instance.qb("Box4.IInternalLinkManager"))}get u7g(){return this.Blf||(this.Blf=fb.a.instance.qb("Box4.AutoCorrect.IPostHyperlinkAutoCorrectStrategy"))}get Tw(){return!0}get commandId(){return E.a.jLd}p7(a){Me.a.mark(7012);
const b=new Id.GraphTransaction(15);b.gd(a);var c=this.cA,f=this.RQ,l=yb.ParagraphReader.text(a),x=l.substring(c,f);const G=({bec:R}=Ka.a.aQe(x)).returnValue;x!==G&&(c+=R,f=c+G.length);x=Mc.a.createTextRange(a,c,f);var R=l.substring(c,f);Br.cKj(l,c,f)&&(this.RU.replaceTextRange(Mc.a.createTextRange(a,c-1,f+1),R,!0,!1),--c,--f,x=Mc.a.createTextRange(a,c,f),c=rd.SelectionFactory.Mg(a,f),qd.a.instance.setSelection(c));c=Lb.HyperlinkReader.RCa(R);Br.hyperlinkEditor.aia(x,c,!1);l=R="";f=!1;this.X7&&({Rdh:R,
kXi:l}=this.X7.bAh(c,!0)).returnValue&&(c=R,f=!0,R=Lb.HyperlinkReader.VB(x,!1),Br.hyperlinkEditor.xO(R[0].paragraph,R[0].hyperlink),""!==l&&(this.RU.replaceTextRange(x,l,!0,!1),x=Mc.a.createTextRange(a,this.cA,this.cA+l.length),a=rd.SelectionFactory.Mg(a,this.cA+this.cA+l.length),qd.a.instance.setSelection(a)),Br.hyperlinkEditor.aia(x,c,!1));b.dispose();!f&&this.u7g&&this.u7g.aGl(x,c);Me.a.mark(7013)}set Tw(a){super.Tw=a}static get hyperlinkEditor(){return Br.jn||(Br.jn=fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static cKj(a,
b,c){c=c!==a.length&&('"'===a.charAt(c)||"\u201d"===a.charAt(c));return!!b&&('"'===a.charAt(b-1)||"\u201c"===a.charAt(b-1))&&c}}Br.jn=null;Object(e.a)(Br,"HyperlinkAction",Zn,[]);class LA{constructor(a,b){this.Yg=a;this.Xc=b}$zi(a,b,c){return new Br(null,a,b,c,this.Yg,this.Xc)}}Object(e.a)(LA,"Factory",null,[1221]);class MA{constructor(){this.Da=null}get name(){return"Box4.AutoCorrect"}Wb(a){this.Da=a;a.register(Um,"Box4.AutoCorrect.AutoCorrectRules").as("Box4.IAutoCorrectRules").ma().na(()=>new Um(a.resolve("Box4.IHyperlinkActionFactory"),
a.resolve("Box4.ICharacterPropertiesEditor"),ed.a.instance,u.AFrameworkApplication.Ta,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance));a.register(IA,"Box4.AutoCorrect.AutoCorrectOptionsInfo").as("Box4.IAutoCorrectOptionsInfo").ma().na(()=>new IA(a.resolve("Box4.IRoamingServiceRequestManager"),u.AFrameworkApplication.fa.ka("ReplaceQuoteWithSmartQuoteIsEnabled")));a.register(KA,"Box4.AutoCorrect.AutoCorrectScheduler").as("Box4.IAutoCorrectScheduler").ma().na(()=>
new KA(a.resolve("Box4.IAutoCorrectRules"),qd.a.instance,rb.a.instance,u.AFrameworkApplication.fa,a.resolve("Box4.IAutoCorrectOptionsInfo"),u.AFrameworkApplication.fa.ka("AutoCorrectUndoByBackspaceIsEnabled")?a.resolve("Box4.IUndoManager"):null));a.register(LA,"Box4.AutoCorrect.HyperlinkAction.Factory").as("Box4.IHyperlinkActionFactory").ma().na(()=>new LA(a.resolve("Box4.ICharacterPropertiesEditor"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance))}init(){this.Da.resolve("Box4.IAutoCorrectRules").TVj();
const a=u.AFrameworkApplication.fa;a.ka("AutoCorrectOptionSettingIsEnabledForWordOnline")&&a.ka("IsRoamingServiceEnabled")&&this.Da.resolve("Box4.IAutoCorrectOptionsInfo").A_i()}dispose(){}static main(){m.a.instance.Bc(new MA)}}Object(e.a)(MA,"Box4AutoCorrectPackage",null,[2,3]);class NA{get name(){return"Box4.Clipboard"}init(){}dispose(){}Wb(){}static main(){m.a.instance.Bc(new NA)}}Object(e.a)(NA,"Box4ClipboardPackage",null,[2,3]);var OA=d(574),Vw=d(487),Zo=d(320);class Cr{}Cr.fontSize=0;Cr.bold=
!1;Cr.italic=!1;Cr.spacing=0;Object(e.a)(Cr,"DefaultTextCharPropertyBag",null,[]);class PA{constructor(a,b,c,f,l,x,G,R){this.DYc=[tb.a.fontColor,sb.a.vsb];this.a2c=[tb.a.Ni,tb.a.font,sb.a.autonumberBulletType,tb.a.uTa,Oc.a.sTa];this.G6j=[new Vw.a(sb.a.yW,sb.a.Zw),new Vw.a(sb.a.Zja,sb.a.Tca),new Vw.a(sb.a.Yja,sb.a.Sca)];this.fVa=a;this.VN=b;this.aac=c;this.nj=f;this.BUa=l;this.F$b=x;this.Nb=G;this.Ea=R}Mpb(a){return this.rNd(a,-1)}UDc(a){return this.rNd(a,1)}rNd(a,b){return nb.GraphIterator.Sba(()=>
this.F$b?ae.OutlineElementReader.Ug(a)&&!a.R2b(14)&&a.R2b(12)&&!this.RJj(a)&&this.FNf(a,b):Ib.ListReader.kk(a)&&this.FNf(a,b))}RJj(a){return(a=this.Ea.tn(a.currentNode))?a.q3:!1}FNf(a,b){return nb.GraphIterator.Sba(()=>{const c=a.currentNode.sa(Mb.a.listLevel,og.a.pDa)+b;if(0>c||c>=Zo.a.Z6||!this.VN.PP(a,c))return!1;this.F$b||(Xb.OutlineElementNavigator.ri(a),Xb.OutlineElementNavigator.Ke(a));return!0})}Teb(a,b){this.r4g(a,b)}UHc(a,b){this.r4g(a,b)}r4g(a,b){if(this.rNd(a,b)&&(this.F$b||Ib.ListReader.kk(a))){var c=
a.Ab(2);a.yc();(new nb.GraphIterator).Pc(a);const f=a.currentNode.sa(Mb.a.listLevel,og.a.pDa);(0>f||f>=Zo.a.Z6)&&Aa.a.J(8959444,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} is out of bounds",f);(0>f+b||f+b>=Zo.a.Z6)&&Aa.a.J(8959447,820,10,"OutlineElementIndentationEditor::OutlineElementPromoteDemote - level-{0} + depth-{1} is out of bounds",f,b);const l=this.VN.PP(a,f),x=this.VN.PP(a,f+b);if(l&&x){a.currentNode.setValue(Mb.a.listLevel,f+b);c.setValue(Mb.a.listLevel,
f+b);for(b=0;b<c.Ra.length;b++)c.Ra.ga(b).formatting&&c.Ra.ga(b).formatting.i9d();this.n9h(c,l,x);this.f9h(c,l,x);this.k9h(c,l,x);c=a.Ab(4);a.yc();c&&this.$8h(c,l,x)}}}f9h(a,b,c){b=c.sa(tb.a.fontSize,Cr.fontSize)-b.sa(tb.a.fontSize,Cr.fontSize);a.Sa(tb.a.fontSize)&&a.setValue(tb.a.fontSize,a.getValue(tb.a.fontSize)+b);for(c=0;c<a.Ra.length;++c){const f=a.Ra.ga(c);f||Aa.a.J(8959450,820,10,"OutlineElementIndentationEditor::AdjustFontSizeBasedOnIndentLevel - paraNode.CharacterProperties[{0}] is null",
c);if(f&&f.formatting&&f.formatting.Iz&&f.formatting.Iz.Sa(tb.a.fontSize)){const l=f.formatting.Iz.getValue(tb.a.fontSize);this.nj.Jr(f.formatting,l+b)}}this.BUa&&this.BUa.Sa(tb.a.fontSize)&&(a=this.BUa.fontSize(),this.BUa.Jr(a+b))}n9h(a,b,c){if(a.Sa(Mb.a.Rl)){var f=a.getValue(Mb.a.Rl);let l=b.sa(Mb.a.Rl,og.a.leftMargin),x=c.sa(Mb.a.Rl,og.a.leftMargin);const G=this.Ea.tn(a);G&&!G.qd&&(l=b.sa(sb.a.vYb,og.a.leftMargin),x=c.sa(sb.a.vYb,og.a.leftMargin));f=f+x-l;0>f&&a.setValue(Mb.a.Tn,a.sa(Mb.a.Tn,og.a.indent)+
f);this.fVa.hv.Ehd(a,1,f)}this.iKc(a,b,Mb.a.Tn)&&this.SRc(a,c,Mb.a.Tn)}k9h(a,b,c){for(const f of this.G6j)this.iKc(a,b,f.first,f.second)&&this.SRc(a,c,f.first,f.second)}$8h(a,b,c){if(this.iKc(a,b,tb.a.Ni,tb.a.font)){if(0===this.aac.Btb(a)&&a.sa(sb.a.autonumberBulletType,8)!==b.sa(sb.a.autonumberBulletType,8))return;if(c.sa(tb.a.Ni,null))this.aac.nWb(a),a.Un.apply(a,this.a2c),this.SRc.apply(this,[a,c].concat(this.a2c));else{const f=this.Nb.Kc(a);f.pc(11);f.Ii()}}for(const f of this.DYc)this.iKc(a,
b,f)&&(a.removeProperty(f),this.SRc(a,c,f))}iKc(a,b,...c){for(const f of c)if(a.Sa(f)||b.Sa(f))if(!a.Sa(f)||!b.Sa(f)||!OA.APropertySet.nXa(f.type,a.Xh(f),b.Xh(f)))return!1;return!0}SRc(a,b,...c){for(const f of c)b.Sa(f)&&a.me(f,b.Xh(f))}}Object(e.a)(PA,"OutlineElementIndentationEditor",null,[1337]);var xy=d(151);class tp{constructor(a,b){this.Ro=this.Xc=this.rt=null;this.Po=b;tp.Sg=a}get jo(){return this.Po.value}get insertionPointFormatting(){return this.rt||(this.rt=fb.a.instance.qb("Box4.IInsertionPointFormatting"))}get Qf(){return this.Xc||
(this.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get H5(){return this.Ro||(this.Ro=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}w3d(a){const b=a.node;var c=this.insertionPointFormatting?this.insertionPointFormatting.N9f():null;if(c&&!c.equals(Ga.a.nil)){a=b.Fh;if(!a)return null;c=a.te(c);if(!c||c&&1!==Uc.StyleReader.lsa(c))return null}else c=vb.a.Ls(a),c=vb.a.Wsb(c);return c}y$(a,b,c){if(yb.ParagraphReader.Vd(b))if(a)if(Uc.StyleReader.jWc(a))if(2!==
Uc.StyleReader.lsa(a))Z.ULS.shipAssertTag(7467991,324,!1);else{var f=Uc.StyleReader.MK(b);if(f){var l=Uc.StyleReader.UP(a);if(!l)Z.ULS.shipAssertTag(7467993,324,!1);else if(f.DG(l)){l=null;this.Qf.ag&&b.E7();c||(l=this.jo.dKk(l),tp.paragraphEditor.oWb(b,!0));this.apc(b,f);H.a.instance.ga(61)||(a=f.DG(Uc.StyleReader.UP(a)));b.properties.setValue(Kg.a.paragraphStyle,a.id);b.xU=a;for(c=0;c<b.Ra.length;c++)b.Ra.ga(c).formatting&&b.Ra.ga(c).formatting.i9d();tp.LXc.bZb(a)&&(l||(l=new nb.GraphIterator,l.set(b),
l.af(),Xb.OutlineElementNavigator.Ke(l)),Ib.ListReader.kk(l)||(b.Un(Mb.a.Rl,Mb.a.cwa,Mb.a.Tn,Mb.a.IHa,Mb.a.Nfc,Mb.a.V4g),this.bKd(l,a)))}}else Z.ULS.shipAssertTag(7467992,324,!1)}else Z.ULS.shipAssertTag(7467990,324,!1);else Z.ULS.shipAssertTag(7467989,324,!1);else Z.ULS.shipAssertTag(7467988,324,!1)}bKd(){}PEc(a,b=!1){let c;c=Tf.c(a)?Tf.d(a)?Uc.StyleReader.MK(a).DG(Uc.StyleReader.ykd):Uc.StyleReader.MK(a).DG(Uc.StyleReader.Akd):Uc.StyleReader.MK(a).DG(H.a.instance.ga(61)?Uc.StyleReader.DKa:Uc.StyleReader.Cna);
this.y$(c,a,b)}ILe(a,b){const c=Uc.StyleReader.MK(b);c&&c.DG(Uc.StyleReader.UP(a))&&(this.apc(b,c),this.insertionPointFormatting&&(this.insertionPointFormatting.SXa(),this.insertionPointFormatting.dfa(a,b)))}apc(a,b){return(a=tp.Ql.MCb(a))?b.N7k(a):!1}static get paragraphEditor(){return tp.Hw||(tp.Hw=fb.a.instance.resolve("Box4.IParagraphEditor"))}static set paragraphEditor(a){tp.Hw=a}static get LXc(){return tp.Sg||(tp.Sg=fb.a.instance.resolve("Box4.List.IListReader"))}static get Ql(){return xy.PageNavigator.instance}}
tp.Hw=null;tp.Sg=null;Object(e.a)(tp,"StyleEditor",null,[1336]);class Uq{static D4d(){return Uq.e0j}static n3f(a){return new Ga.a(a,1)}static fTf(a){a=a.toString();a=a.split("-")[0]+"-0000-0000-0000-000000000000";return zh.a.Mf(a)}}Uq.e0j=[sb.a.dwa,sb.a.cellId,sb.a.rowId,sb.a.shapeId];Object(e.a)(Uq,"TransformHelper",null,[]);class QA{constructor(a,b){this.BYc=new tp(a,b);this.Wz=a;this.VN=b.value}w3d(a){return this.BYc.w3d(a)}ILe(a,b){this.BYc.ILe(a,b)}y$(a,b){const c=new nb.GraphIterator;c.set(b);
c.Mu();c.yc();tm.d(a,c.currentNode,[Mb.a.listLevel]);tm.d(a,b,[tb.a.xl,tb.a.EI,Mb.a.Tn,Mb.a.Rl,sb.a.Zw,sb.a.yW,sb.a.Zja,sb.a.Tca,sb.a.Yja,sb.a.Sca]);if(this.Wz.bZb(a)&&!Ib.ListReader.kk(c)){a=Ae.a.pBa(a,a);const f=Ae.a.AP(a.listType,a.listStyle);f.iA=a.iA;a.propertySet.Sa(tb.a.Ni)&&f.propertySet.setValue(tb.a.Ni,a.propertySet.getValue(tb.a.Ni));a.propertySet.Sa(tb.a.font)&&f.propertySet.setValue(tb.a.font,a.propertySet.getValue(tb.a.font));a.propertySet.Sa(sb.a.autonumberBulletType)&&f.propertySet.setValue(sb.a.autonumberBulletType,
a.propertySet.getValue(sb.a.autonumberBulletType));this.VN.H3a(c,f,!1,!1,0);a=c.Ab(4);tm.b(b,a,Uq.D4d());c.yc()}}PEc(a,b=!1){this.BYc.PEc(a,b)}apc(a,b){return this.BYc.apc(a,b)}}Object(e.a)(QA,"StyleEditor",null,[1336]);class RA{constructor(a){this.nJg=a;this.nJg.$pa(Object(C.a)(this,this.EWa,"onBeforeValidatePersistence"))}dispose(){this.nJg.wjc(Object(C.a)(this,this.EWa,"onBeforeValidatePersistence"))}EWa(a,b){10!==b.node.type&&60!==b.node.type||b.node.CDh()}}Object(e.a)(RA,"LockableGraphNodeEditBehavior",
null,[106]);class SA{constructor(){}jQi(a){const b=a.parentNode.getValue(sb.a.shapeId),c=a.parentNode.getValue(sb.a.dwa);let f=null,l=null;const x=Object(ua.a)(5,a.currentNode);x&&x.hs()&&(f=a.parentNode.getValue(sb.a.rowId),l=a.parentNode.getValue(sb.a.cellId));this.oLe(a.currentNode,b,c,f,l)}oLe(a,b,c,f,l){a.me(sb.a.shapeId,b);a.me(sb.a.dwa,c);l&&(a.me(sb.a.rowId,f),a.me(sb.a.cellId,l))}}Object(e.a)(SA,"PptCreateParagraphStrategy",null,[1335]);var lP=d(29);class TA{constructor(a){this.Ot=a;this.Ot.$pa(Object(C.a)(this,
this.EWa,"onBeforeValidatePersistence"))}dispose(){this.Ot.wjc(Object(C.a)(this,this.EWa,"onBeforeValidatePersistence"))}EWa(a,b){Nc.a.Eb&&(a=Nc.a.Eb,a.Kr&&Nc.a.Lea(Nc.a.Eb),b.revisionId&&(b=Nc.a.t7a(b.revisionId.toString()),"ReplicateOutbound"===a.actionName?Z.ULS.sendTraceTag(41714057,305,50,"Refuse to override RevisionId for ReplicateOutbound. RevisionId={0}; StackTrace={1}",b.toString(),lP.Debug.Ht()):a.sB(si.a.UX,b.toString())))}}Object(e.a)(TA,"PresentationNodeEditBehavior",null,[106]);class UA{Tkc(a,
b,c){let f;({value:f}=a.Rf(b)).returnValue||(f=new Ha.a,a.$(b,f));f.add(c)}fnd(a,b,c,f){if(a.count)for(let l of a)l&&l!==Ga.a.nil&&(a=b.oOc(l,Ga.a.nil),a=f.ga(a))&&(b.$(l,a),this.Tkc(c,a,l))}bnd(a,b,c){a.Jb(b)&&Ga.a.sP(a.ga(b),c)&&a.remove(b)}}Object(e.a)(UA,"GraphHotColdHelper",null,[1334]);var Vq=d(203),yy;(function(a){a[a.presentation=0]="presentation";a[a.slide=1]="slide";a[a.slideChildren=2]="slideChildren";a[a.shapeLevel=3]="shapeLevel"})(yy||(yy={}));Object(e.b)("GraphNodeModificationType",
yy);class GF{constructor(a,b,c,f,l,x){this.iVa=a;this.zla=b;this.wla=c;this.IT=f;this.BQ=l;this.Ela=x;this.bbc=Ga.a.nil}PF(a){return!!a&&(7===a.type||68===a.type)}Gec(a,b){this.iVa.$(a.id,b);this.Ela.ive(b)?this.bbc=a.id:this.BQ.Tkc(this.IT,b,a.id)}GVe(a){if(this.bbc&&this.bbc!==Ga.a.nil){let b;this.BQ.fnd((b=new Ha.a,b.add(this.bbc),b),this.iVa,this.IT,a);this.bbc=Ga.a.nil}}FDb(a,b){this.BQ.bnd(this.iVa,a,b)}Osa(a){return this.iVa.Jb(a.id)}kW(a){return this.Osa(a)||0<this.zla.count||0<this.wla.count}}
Object(e.a)(GF,"PresentationHotColdHandler",null,[1244,1217]);class HF extends Sys.EventArgs{constructor(a,b){super();this.revisionId=a;this.node=b}}Object(e.a)(HF,"RevisionPersistArgs",Sys.EventArgs,[]);var IF=d(885);class JF{constructor(a,b,c,f,l,x,G){this.ava=a;this.wla=b;this.IT=c;this.BQ=f;this.Ela=l;this.lc=x;this.Ea=G;this.Z2c=new Ha.a;this.jGa=new Ha.a}PF(a){return!!a&&(10===a.type||60===a.type||39===a.type)}Gec(a,b){let c=a;const f=this.lc.ig(a);60!==a.type&&39!==a.type&&(c=this.Ea.tn(a));
f&&c&&(this.wla.$(c.id,b),this.ava.$(f.id,b),this.Ela.ive(b)?(this.Z2c.contains(c.id)||this.Z2c.add(c.id),this.jGa.contains(f.id)||this.jGa.add(f.id)):(this.BQ.Tkc(this.IT,b,c.id),this.BQ.Tkc(this.IT,b,f.id)))}GVe(a){this.BQ.fnd(this.Z2c,this.wla,this.IT,a);this.BQ.fnd(this.jGa,this.ava,this.IT,a);this.Z2c.clear();this.jGa.clear()}FDb(a,b){this.BQ.bnd(this.wla,a,b);this.BQ.bnd(this.ava,a,b)}Osa(a){return this.PF(a)&&this.wla.Jb(a.id)}kW(a){return this.Osa(a)}}Object(e.a)(JF,"ShapeLevelHotColdHandler",
null,[1244,1217]);class KF{constructor(a,b,c,f,l){this.zla=a;this.ava=b;this.IT=c;this.BQ=f;this.Ela=l;this.jGa=new Ha.a}PF(a){return!!a&&8===a.type}Gec(a,b){this.zla.$(a.id,b);this.Ela.ive(b)&&!this.jGa.contains(a.id)?this.jGa.add(a.id):this.BQ.Tkc(this.IT,b,a.id)}GVe(a){this.BQ.fnd(this.jGa,this.zla,this.IT,a);this.jGa.clear()}FDb(a,b){this.BQ.bnd(this.zla,a,b)}Osa(a){return this.zla.Jb(a.id)}kW(a){return this.Osa(a)||this.LFj(a)}LFj(a){return this.ava.Jb(a.id)}}Object(e.a)(KF,"SlideHotColdHandler",
null,[1244,1217]);class zy{constructor(a,b,c,f,l,x,G,R,fa,wa=null,Wa=null,mb=null){this.nl=this.IT=this.wla=this.ava=this.zla=this.iVa=null;this.lc=a;this.Ea=b;this.Mc=c;this.ks=f;this.BQ=l;this.Ot=x;this.Fpe=!1;this.w_=G;this.ua=R;this.Ela=fa;this.ks.GBc(Object(C.a)(this,this.k$c,"onRevisionProcessedOnServerHandler"));this.ks.w8h(Object(C.a)(this,this.i9c,"onGraphNodePersistHandler"));this.Ot.$pa(Object(C.a)(this,this.i9c,"onGraphNodePersistHandler"));this.Mc.IB(Object(C.a)(this,this.gB,"onSessionEnd"));
this.Mc.m5h(Object(C.a)(this,this.v_g,"onFailoverHandler"));this.Mc.JB(Object(C.a)(this,this.to,"onSessionRehydrated"));this.initialize(wa,Wa,mb);this.uUa=new ef.a}reset(){this.initialize();this.ks.qbh(new IF.a(null));this.rBh()}initialize(a=null,b=null,c=null){a||this.l9i();this.IT=b||new ef.a;this.nl=c||this.Lia()}v_g(){this.reset()}k$c(a,b){b&&(a=b.o$)&&this.yye(a)}i9c(a,b){this.Gec(b.node,b.revisionId)}Gec(a,b){if(!this.Fpe&&(a.isDirty||10===a.type||60===a.type||39===a.type))for(const c of this.nl)if(c.PF(a)){c.Gec(a,
b);this.ks.HGk(new HF(b,a));break}}yye(a){const b=Ga.a.Mf(a.Id),c=this.IT.ga(b);if(c&&c.count){for(let f of c)for(const l of this.nl)l.FDb(f,b);this.IT.remove(b);this.ks.qbh(new IF.a(a));this.rBh()}}pLi(){const a={},b=zy.YAj(a);b(0,this.iVa);b(1,this.zla);b(2,this.ava);b(3,this.wla);ta.a.isEmpty(a)||Aa.a.J(21112097,811,50,ta.a.toJSON(a))}kW(a){for(const b of this.nl)if(b.PF(a))return b.kW(a);return!1}Osa(a){for(const b of this.nl)if(b.PF(a))return b.Osa(a);return!1}BEh(a){if(0<a.count)for(const b of this.nl)b.GVe(a)}dispose(){this.Mc.Oea(Object(C.a)(this,
this.gB,"onSessionEnd"));this.Mc.hRk(Object(C.a)(this,this.v_g,"onFailoverHandler"));this.Ot.wjc(Object(C.a)(this,this.i9c,"onGraphNodePersistHandler"));this.ks.Ifh(Object(C.a)(this,this.k$c,"onRevisionProcessedOnServerHandler"));this.ks.iTk(Object(C.a)(this,this.i9c,"onGraphNodePersistHandler"));this.Mc.Pea(Object(C.a)(this,this.to,"onSessionRehydrated"));this.uUa&&0<this.uUa.count&&Aa.a.J(22153251,822,15,String.format("Disposed with {0} listening node",this.uUa.count))}gB(){this.Fpe=!0;this.pLi();
this.reset()}to(){this.ua.presentation.AHe();this.reset();this.Fpe=!1;this.w_.hIa(new xb.a("SessionRehydrated"))}Lia(){return[new JF(this.ava,this.wla,this.IT,this.BQ,this.Ela,this.lc,this.Ea),new KF(this.zla,this.ava,this.IT,this.BQ,this.Ela),new GF(this.iVa,this.zla,this.wla,this.IT,this.BQ,this.Ela)]}l9i(){this.iVa=new ef.a;this.zla=new ef.a;this.ava=new ef.a;this.wla=new ef.a}TYb(a,b){var c=Object(ua.a)(1098,a);c.vsa+=1;({value:c}=this.uUa.Rf(b.id)).returnValue||(c=new Ha.a,this.uUa.add(b.id,
c));c.add(a)}rBh(){if(this.uUa.count&&this.ua.presentation&&this.ua.presentation.Fh){var a=this.ua.presentation.Fh;this.uUa.forEach((b,c)=>{if(!this.Osa(Object(ua.a)(9,a.te(b)))){for(let f of c)if(c=Object(ua.a)(1098,f))--c.vsa,this.lwb(c)&&(this.w_.hIa(new xb.a("SessionRehydrated")),this.hfd(f));this.uUa.remove(b)}return!0})}}lwb(a){return a?!a.vsa&&!a.Bia:!1}hfd(a){var b=Object(ua.a)(1098,a);a&&b&&(b=+new Date-+b.Uha,12E4<b&&Aa.a.J(22153281,822,15,String.format("{0} been blocked {1}",a.type,b)))}static YAj(a){return(b,
c)=>{c=Vq.b(c.values.toArray(),f=>f.toString());c.length&&(a[yy[b]]=c)}}}Object(e.a)(zy,"GraphHotColdManager",null,[1216,1217,106,1218]);class VA{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphEditor"}Wb(a){this.K=a;this.K.register(RA,"PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").ma().na(()=>new RA(this.K.resolve("Box4.Graph.IGraphInstance").uQa));this.K.register(TA,"PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").ma().na(()=>new TA(this.K.resolve("Box4.Graph.IGraphInstance").vd(7)));
this.K.register(PA,"PowerPointWebEditor.OutlineElementIndentationEditor").as("Box4.IOutlineElementIndentationEditor").na(()=>new PA(this.K.resolve("Box4.IParagraphEditor"),this.K.resolve("PowerPointWebEditor.IPptListEditor"),this.K.resolve("PowerPointWebEditor.IListInfoHelper"),this.K.resolve("Box4.IFormattingEditor"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").isPromoteDemoteOnParagraphEnabled,this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(QA,"PowerPointWebEditor.StyleEditor").as("Box4.Styles.IStyleEditor").ma().na(()=>new QA(this.K.resolve("Box4.List.IListReader"),this.K.le("Box4.List.IListEditor")));this.K.register(UA,"PowerPointWebEditor.GraphHotColdHelper").as("PowerPointWebEditor.IGraphHotColdHelper").na(()=>new UA);this.K.register(zy,"PowerPointWebEditor.GraphHotColdManager").as("PowerPointWebEditor.IGraphHotColdManager").as("PowerPointWebEditor.IGraphBlockContentHandler").ma().na(()=>
new zy(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdHelper"),a.resolve("Box4.Graph.IGraphInstance").uQa,a.resolve("PowerPointWebEditor.IGraphActionBlockingEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.ITextEditingRevisionInfoReader")));
this.K.register(SA,"PowerPointWebEditor.PptCreateParagraphStrategy").as("Box4.ICreateParagraphStrategy").ma().na(()=>new SA(this.K.resolve("Box4.ITableCellReader")))}init(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior");this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior");this.K.resolve("PowerPointWebEditor.IGraphHotColdManager");this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager").addHandler(this.K.resolve("PowerPointWebEditor.IGraphBlockContentHandler"))}dispose(){this.K.resolve("PowerPointWebEditor.GraphEditor.LockableGraphNodeEditBehavior").dispose();
this.K.resolve("PowerPointWebEditor.GraphEditor.PresentationNodeEditBehavior").dispose()}static main(){m.a.instance.Bc(new VA)}}Object(e.a)(VA,"PPTWebEditorGraphEditorPackage",null,[2,3]);var mP=d(756),Ay=d(758),nP=d(757),ao=d(443);const LF=a=>{a.element.style.top=""};var rv=d(767);class MF{constructor(a,b,c){this.L6=!1;this.kLa=0;this.$fa=this.xif=null;this.QR=a;this.FYh=b;this.Wn=c;this.$O=a.ownerDocument.createElement("div");this.htmlElement.className="WACBusinessBar";(this.C1=!!u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.jb.iEa)&&!this.Wn.wIc&&Sys.UI.DomElement.addCssClass(this.htmlElement,"regionComposer");this.htmlElement.id="WACBusinessBar";r.a.eg&&Sys.UI.DomElement.addCssClass(this.htmlElement,"FireFox")}get htmlElement(){return this.$O}get visible(){return this.L6}set_visible(a){if(this.L6!==a)return(this.L6=a)?this.bLd():this.HYb(),a}dispose(){this.visible&&this.HYb();ya.a.TAa(this.htmlElement);this.QR=this.$O=null}hsh(a,b){const c=a.htmlElement||a.createElement();b===this.htmlElement.childNodes.length?
this.htmlElement.appendChild(c):this.htmlElement.insertBefore(c,this.htmlElement.childNodes[b]);a.Xhh();this.kLa+=a.htmlElement.clientHeight;var f=this.htmlElement.childNodes,l=a.FGf,x=Object(C.a)(this,this.xjk,"onAfterShowEntry");ao.WacAirSpace.tYa(c,"Shared_BasicClass");var G=new nP.a(c);G.qUb(0,1);const R=new Ay.a(c);R.rUb(c.clientTop-30,c.clientTop);l?(ao.WacAirSpace.pWa(G,null,null),ao.WacAirSpace.pWa(R,null,x)):(ao.WacAirSpace.animate(G,null,null),ao.WacAirSpace.animate(R,null,x));for(b+=1;b<
f.length;b++)x=f[b],ao.WacAirSpace.tYa(x,"Shared_BasicClass"),G=new Ay.a(x),G.rUb(x.clientTop-c.clientHeight,x.clientTop),l?ao.WacAirSpace.pWa(G,null,null):ao.WacAirSpace.animate(G,null,null);a.xdl();this.set_visible(!0)}gmg(a){const b=a.htmlElement;if(ya.a.vSa(b)){this.kLa-=a.htmlElement.clientHeight;var c=b.parentNode.children;a=a.FGf;var f=Object(C.a)(this,this.sjk,"onAfterHideEntry");ao.WacAirSpace.tYa(b,"Shared_BasicClass");var l=new mP.a(b);l.qUb(1,0);a?ao.WacAirSpace.pWa(l,null,f):ao.WacAirSpace.animate(l,
null,f);f=!1;for(l=0;l<c.length;l++){if(f){const x=c[l];ao.WacAirSpace.tYa(x,"Shared_BasicClass");const G=new Ay.a(x);G.rUb(x.clientTop,-b.clientHeight);a?ao.WacAirSpace.pWa(G,null,LF):ao.WacAirSpace.animate(G,null,LF)}f||c[l]!==b||(f=!0)}}}xjk(a){a.element.style.top="";u.AFrameworkApplication.Aa.Fq()}sjk(a){a.element.parentNode.removeChild(a.element);this.htmlElement.hasChildNodes()||this.set_visible(!1);u.AFrameworkApplication.Aa.Fq()}bLd(){""===this.QR.style.top.trim()&&(this.QR.style.top=this.QR.offsetTop+
"px");this.htmlElement.style.left=this.QR.style.left;this.htmlElement.style.top=this.QR.style.top;this.htmlElement.style.height="auto";this.htmlElement.style.visibility="visible";var a=Sys.UI.DomElement.getBounds(this.htmlElement);this.xif=this.QR.style.top;this.kLa=a.height;this.aod();u.AFrameworkApplication.Aa.uha(Object(C.a)(this,this.onResize,"onResize"));Ed.a.addHandler(this.htmlElement,ma.a.Lgd,Ed.a.Npb);this.$fa=Object(C.a)(this,this.PB,"contextMenuHandler");u.AFrameworkApplication.Aa.I$.ob(this.htmlElement,
this.$fa,null);if(v.FocusManager.mM()){var b=v.FocusManager.instance();a=b.Dc(rv.a.a4a);a.parent=y.AFrame.jj;const c=new ct.DOMFocusListing(()=>this.htmlElement);c.vo(1);c.vo(2);c.vo(8);b.Jha(()=>this.htmlElement,a,c);b=b.SP(rv.a.a4a);b.xfb();b.DW=!0;b.IOa=!0;const f=u.AFrameworkApplication.Aa.Aw;a.r3a(()=>{f.zo(rv.a.a4a)});f.Tpa(rv.a.a4a);(c.Aia||u.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled"))&&f.lK(rv.a.a4a)}}HYb(){this.Lrh()&&(this.QR.style.top=this.xif);this.htmlElement.style.visibility=
"hidden";u.AFrameworkApplication.Aa&&(v.FocusManager.mM()&&v.FocusManager.instance().MFb(rv.a.a4a),this.$fa&&(u.AFrameworkApplication.Aa.I$.xb(this.htmlElement,this.$fa),this.$fa=null));Ed.a.removeHandler(this.htmlElement,ma.a.Lgd,Ed.a.Npb)}aod(){if(this.Lrh()&&this.visible){var a=this.QR,b=this.kLa+this.FYh;const c=ya.a.QL(a.style.top);ao.WacAirSpace.tYa(a,"Shared_BasicClass");a=new Ay.a(a);a.rUb(c,b);ao.WacAirSpace.animate(a,null,null)}}Lrh(){return!this.C1&&!this.Wn.wIc}onResize(){const a=this.Wn.entries.length,
b=Sys.UI.DomElement.getBounds(this.htmlElement).height;let c;for(let f=0;f<a;++f)c=this.Wn.entries[f],c.htmlElement&&c.Xhh();this.kLa=Sys.UI.DomElement.getBounds(this.htmlElement).height;b!==this.kLa&&this.aod()}PB(){return!0}}Object(e.a)(MF,"BusinessBarDom",null,[839,106]);var Lt;(function(a){a[a.none=0]="none";a[a.corruptPage=1]="corruptPage";a[a.currentPageStatus=2]="currentPageStatus";a[a.documentMarkedAsFinal=3]="documentMarkedAsFinal";a[a.documentSigned=4]="documentSigned";a[a.fileAccess=5]=
"fileAccess";a[a.kickoutWithDataLoss=6]="kickoutWithDataLoss";a[a.lostSession=7]="lostSession";a[a.malformedHyperlinkUris=8]="malformedHyperlinkUris";a[a.odt=9]="odt";a[a.readonlyRecommended=10]="readonlyRecommended";a[a.saveReplaySuccess=11]="saveReplaySuccess";a[a.saveReplayFailed=12]="saveReplayFailed";a[a.unsupportedObjects=13]="unsupportedObjects";a[a.word11Compat=14]="word11Compat";a[a.unsupportedBrowser=15]="unsupportedBrowser";a[a.applicationNotification=16]="applicationNotification";a[a.skypeDocChatFailed=
17]="skypeDocChatFailed";a[a.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo";a[a.sessionExpired=19]="sessionExpired";a[a.irmPolicyDescription=20]="irmPolicyDescription";a[a.policyWarningMessage=21]="policyWarningMessage";a[a.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled";a[a.gdprPrivacyNotice=23]="gdprPrivacyNotice";a[a.datacenterDecommissionWarning=24]="datacenterDecommissionWarning";a[a.graphMergePrompt=25]="graphMergePrompt";a[a.readOnlyDocument=26]="readOnlyDocument";a[a.dictationSilence=
27]="dictationSilence";a[a.autoSensitivityLabel=28]="autoSensitivityLabel";a[a.recommendedSensitivityLabel=29]="recommendedSensitivityLabel";a[a.dictationDebugInfo=30]="dictationDebugInfo";a[a.oneNoteCovid19Message=31]="oneNoteCovid19Message";a[a.citationStylePrompt=32]="citationStylePrompt";a[a.oneNoteViewModeMessage=33]="oneNoteViewModeMessage";a[a.oneNotePrintImagesDownloading=34]="oneNotePrintImagesDownloading";a[a.oneNotePagePrintReady=35]="oneNotePagePrintReady";a[a.irmPolicyCausedFeatureDisabled=
36]="irmPolicyCausedFeatureDisabled";a[a.mandatoryLabel=37]="mandatoryLabel";a[a.policyTip=38]="policyTip";a[a.minorVersionLimit=39]="minorVersionLimit";a[a.testEntry1=40]="testEntry1";a[a.testEntry2=41]="testEntry2";a[a.testEntry3=42]="testEntry3";a[a.testEntry4=43]="testEntry4";a[a.testEntry5=44]="testEntry5";a[a.testEntry6=45]="testEntry6";a[a.testEntry7=46]="testEntry7"})(Lt||(Lt={}));Object(e.b)("BusinessBarId",Lt);class pq{constructor(a,b=0,c=null,f=null){this.Tbf=this.z2e=!1;this.smb=null;
this.XO=[];this.Cya=f||new MF(a,b,this);this.sAj(c)}sAj(a){if(a){this.smb={};a=a.ranking;for(let b=0;b<a.length;b++)this.smb[Lt[a[b]]]=b}}dispose(){this.Cya.dispose();fh.a.rgd(this.XO);this.XO=null}get htmlElement(){return this.Cya.htmlElement}get visible(){return this.Cya.visible}get wIc(){return this.z2e}set wIc(a){this.z2e=a}get Gbe(){return this.Tbf}set Gbe(a){this.Tbf=a}get entries(){return this.XO}set entries(a){this.XO=a}Dca(a){for(let b=0;b<this.XO.length;b++)if(this.XO[b].id===a)return!0;
return!1}Wh(a,b=!1,c=null){a.businessBar=this;let f=this.k7i(a.id);b&&!this.smb&&(f=0);f<pq.mdb&&(this.Cya.hsh(a,f),this.XO.length>=pq.mdb&&this.Cya.gmg(this.XO[pq.mdb-1]),this.Cya.aod());Array.insert(this.XO,f,a);Z.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Lt[a.id],void 0===a.dBa||null===a.dBa?"":a.dBa);a.errorCode&&u.AFrameworkApplication.jp(a.errorCode,c,null,null)}removeEntry(a){const b=Array.indexOf(this.XO,a);-1!==b&&b<pq.mdb&&(this.XO.length>pq.mdb&&
this.Cya.hsh(this.XO[pq.mdb],pq.mdb),this.Cya.gmg(a),this.Cya.aod());Array.remove(this.XO,a);a.businessBar=null;a.dispose()}k7i(a){if(!this.smb||0===a)return this.XO.length;a=this.smb[Lt[a]];if(void 0===a||null===a)return this.XO.length;for(let b=0;b<this.XO.length;b++)if(a<this.smb[Lt[this.XO[b].id]])return b;return this.XO.length}}pq.mdb=2;Object(e.a)(pq,"BusinessBar",null,[827,106,828]);class WA{constructor(a){this.pHc=null;this.hYg=a.Ga("OfficeOnlineChromeExtensionId");this.qYg=a.Ga("ChromeClipboardAccessExtensionId");
this.vFj=a.ka("OfficeOnlineChromeExtensionIsEnabled");this.Gwf=!this.ULj();this.pHc=this.ixa?this.qYg:this.hYg}oNc(){return this.pHc}rHe(){this.pHc===this.hYg&&this.Qwg&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported"));this.pHc=this.qYg;this.Gwf=!0}get ixa(){return this.Gwf}ULj(){if(this.vFj&&this.Qwg){var a=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(a&&"true"===a)return a=localStorage.getItem("IsCopyPasteSupported"),!!a&&
"true"===a}return!1}get Qwg(){let a=!1;try{localStorage.setItem("LocalStorageAccessiblityTest","LocalStorageAccessiblityTest"),a="LocalStorageAccessiblityTest"===localStorage.getItem("LocalStorageAccessiblityTest"),localStorage.removeItem("LocalStorageAccessiblityTest")}catch(b){Z.ULS.sendTraceTag(19452045,307,50,b.toString())}return a}}Object(e.a)(WA,"ChromeExtensionHelper",null,[368]);class NF{constructor(a=null,b=null,c=null){this.M$=a||{};this.Vzh=b||[];this.irl=c||{}}}Object(e.a)(NF,"RibbonTrimmingProperties",
null,[]);var oP=d(448);class OF{create(a,b,c){return new oP.a(a,b,c)}}Object(e.a)(OF,"Factory",null,[838]);class PF{constructor(){u.AFrameworkApplication.Ta.ya(F.a.RBg,xd.a.frame,Object(C.a)(this,this.rJk,"reactFileMenuOpenFromTellMe"))}rJk(a,b,c,f,l){if(1===c||!l)return 32;a=l.SourceControlId;17!==l.UILocation||"New"!==a&&"Open"!==a||(l=[],Lg.d("setFileMenuSelectedPage")&&("New"===a&&u.AFrameworkApplication.Aa?2===u.AFrameworkApplication.Aa.jb.rm?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileNewPage")):
l.push(appChrome.actions.setFileMenuSelectedPage("FileNewPage")):"Open"===a&&u.AFrameworkApplication.Aa&&(2===u.AFrameworkApplication.Aa.jb.rm?l.push(appChrome.actions.setFileMenuSelectedPage("PptFileOpenPage")):l.push(appChrome.actions.setFileMenuSelectedPage("FileOpenPage")))),l.push(appChrome.actions.updateFileMenuExpandedValue(!0)),appChrome.api.dispatch(l));return 32}fUj(){appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0))}}Object(e.a)(PF,"ReactFileMenu",null,[1363]);class QF{createFileMenu(){const a=
new PF,b=[];b.push(appChrome.actions.updateFileMenuExpandedValue(!1));b.push(appChrome.actions.updateFileMenuDisabledValue(!1));appChrome.api.dispatch(b);return a}}Object(e.a)(QF,"ReactFileMenuFactory",null,[1344]);var ai=d(524);class RF{constructor(a,b,c,f,l,x,G){this.zFa=!1;this.Rz=null;this.Lka=this.q5c=this.LUa=!1;this.jzb="Edit";this.uQg=!1;this.jc=f;this.ia=a;this.uv=b;this.Ob=l;this.Uk=G;this.Ob.JM(Object(C.a)(this,this.o7c,"modeSwitched"));this.Ha=c;this.ub()}ub(){this.ia.ya(ba.a.zfk,xd.a.frame,
Object(C.a)(this,this.Afk,"modeSwitcherHandler"));this.ia.ya(ba.a.Nkd,xd.a.frame,Object(C.a)(this,this.Nkd,"switchToDocumentEditMode"));this.ia.ya(ba.a.cnc,xd.a.frame,Object(C.a)(this,this.cnc,"switchToEmergencyViewMode"));this.ia.ya(ba.a.Okd,xd.a.frame,Object(C.a)(this,this.Okd,"switchToDocumentViewMode"));this.ia.pa(ba.a.fah,xd.a.frame,Object(C.a)(this,this.m$g,"queryDocumentModeSwitchMenuItem"),96);this.ia.pa(ba.a.gah,xd.a.frame,Object(C.a)(this,this.m$g,"queryDocumentModeSwitchMenuItem"),96);
this.ia.ya(ba.a.HBa,sc.a.application,Object(C.a)(this,this.HBa,"displayCallout"));this.ia.ya(F.a.twh,xd.a.frame,Object(C.a)(this,this.Ukl,"switchFromViewModeToEditMode"))}dispose(){this.Ob.QX(Object(C.a)(this,this.o7c,"modeSwitched"))}xe(){}Afk(){return 32}Okd(a,b,c){if(1===c||"View"===this.T6a())return 32;this.uv.zwh();this.$gd("View");this.q5c=!0;return 32}Nkd(a,b,c){if(u.AFrameworkApplication.hQ)return 8;a=this.T6a();if(1===c){if("Edit"===a||this.zFa||this.q5c||this.LUa&&this.jc.getState(1))return 32;
Z.ULS.sendTraceTag(512500510,306,10,"ModeSwitcherControlActor:SwitchToDocumentEditMode:: DocModeSwitcher Editing Option Disabled");return 8}if("Edit"===a)return 32;this.uv.A8k();c=this.LUa?this.ia.La(ba.a.lZb,2,20):this.ia.processAction(ba.a.m2b,2);this.zFa=this.LUa=this.q5c=!1;this.$gd("Edit");return c}Ukl(a,b,c){if(u.AFrameworkApplication.hQ)return 8;a=this.T6a();if(1===c){if("Edit"===a||this.zFa||this.q5c||this.LUa&&this.jc.getState(1))return 32;Z.ULS.sendTraceTag(512500509,306,10,"ModeSwitcherControlActor:SwitchFromViewModeToEditMode:: DocModeSwitcher Editing Option Disabled");
return 8}if("Edit"===a)return 32;if(2!==c)return Z.ULS.sendTraceTag(512500508,306,15,String.format("Unexpected ActionBehavior {0} for switching to edit mode",c)),2;this.ia.La(ba.a.refresh,2,{refreshtrigger:"SwitchFromViewModeToEditMode"});return 32}cnc(a,b,c){if(1===c)return 32;this.zFa=!0;return this.initialize()}m$g(a,b,c,f,l){b=this.T6a();l[ai.a.On]=a===ba.a.fah&&"Edit"===b||a===ba.a.gah&&"View"===b?!0:!1;return 32}HBa(a,b,c,f,l){if(!l||!Object(Ma.a)(Zh,l))return 8;this.Rz=l;this.initialize();
this.Uk&&!this.uQg&&"View"===this.jzb&&(this.Uk.sTe(),this.uQg=!0);return this.initialize()}initialize(){if(!Lg.c())return Z.ULS.sendTraceTag(512500507,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - AppChrome Actions being Null"),8;this.jzb=this.bcg();!this.Lka&&this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.T6a()!==this.jzb&&Z.ULS.sendTraceTag(512500506,306,50,"ModeSwitcher was initially rendered in the incorrect mode. Expected: {0}, Actual: {1}",
this.jzb,this.T6a());var a=this.Rz?this.Rz.N4b||this.Rz.S4b:!1,b=this.Rz?this.Rz.CSa:this.jc.getState(16);this.LUa=this.Rz?this.Rz.Rae:this.jc.getState(524288);var c=this.Rz?this.Rz.Z7a:this.jc.getState(1);const f=this.zFa||a||this.LUa||b||!c,l={hidden:!1};l.hasEditPermission=c;l.activeMode=this.jzb;l.isMarkedAsFinal=b;l.isMarkedAsOpenReadOnly=this.LUa;l.isReviewer=!1;l.isServiceDefaultedToView=this.zFa||a;l.forceShowNotificationByExternalTrigger=this.Rz&&this.Rz.STc?!this.Rz.STc:f;a&&(a={},c={},
c.title=ResourceStrings.L_BizBarTitle_Readonly,this.Rz.N4b?c.text=ResourceStrings.L_BizBarMessage_PasswordProtected:this.Rz.S4b&&(c.text=ResourceStrings.L_BizBarMessage_FileFormatNotEditable),c.confirmationButtonText=ResourceStrings.L_InsertTableDialogButtonText,c.icon="pptEditorSprite.CancelGlyph_16",c.label=ResourceStrings.L_Close,a.serviceDefaultedToViewCallout=c,l.notificationCalloutProps=a);a=appChrome.actions.updateModeSwitcher(l);if(!a)return Z.ULS.sendTraceTag(512500505,306,10,"ModeSwitcherControlActor:Initialize:: Failed to Initialize DocModeSwitcher - Redux Action being Null"),
8;Z.ULS.sendTraceTag(512500504,306,50,"ModeSwitcherControlActor:Initialize:: Dispatching Mode switcher action. ActionDataAvailable:{0}, HasEditPerm: {1}, Mode:{2}, MarkedFinal: {3}, MarkedOpenRO: {4}, EditProtected: {5}, FormatUnsupported: {6}, EmergencyMode: {7}, InReadingMode: {8}",!!this.Rz,l.hasEditPermission,this.jzb,b,this.LUa,!!this.Rz&&this.Rz.N4b,!!this.Rz&&this.Rz.S4b,this.zFa,this.vtg());b=this.UTd(a);this.Lka=!0;return b}UTd(a){if(appChrome.api)return appChrome.api.dispatch(a),32;Z.ULS.sendTraceTag(512500503,
306,10,"ModeSwitcherControlActor:DispatchAction:: Failed to Initialize DocModeSwitcher - PPT App Chrome API being Null");return 8}vtg(){return!!u.AFrameworkApplication.Aa&&1===u.AFrameworkApplication.Aa.mode}bcg(){return this.Rz?this.zFa||this.Rz.CSa||this.Rz.Rae||this.Rz.N4b||this.Rz.S4b||this.Rz.STc?"View":this.Rz.Z7a?"Edit":"View":this.zFa||this.vtg()?"View":"Edit"}T6a(){if(Lg.c())switch(appChrome.selectors.getModeSwitcherMode()){case null:case "Edit":break;case "View":return"View";default:Z.ULS.sendTraceTag(512500502,
306,15,"ModeSwitcherControlActor:GetCurrentDocumentMode:: ModeSwitcher Actor received an invalid active mode from the control.")}return"Edit"}$gd(a){if(Lg.c()&&this.T6a()!==a){var b={};b.activeMode=a;Z.ULS.sendTraceTag(512500501,306,50,"ModeSwitcherControlActor:SendUpdateModeReduxAction:: ModeSwitcher control switching to mode {0}",a);a=appChrome.actions.updateModeSwitcher(b);this.UTd(a)}}o7c(a){this.Lka&&(1===a.mode?this.$gd("View"):2===a.mode&&this.$gd("Edit"))}uTk(){const a={hidden:!1};a.activeMode=
this.bcg();this.UTd(appChrome.actions.updateModeSwitcher(a))}}Object(e.a)(RF,"ModeSwitcherControlActor",null,[1150]);var SF=d(249);class XA{constructor(a,b,c,f){this.fAa=this.r4e=this.hmb=this.f2e=this.oLa=this.p0e=null;this.uAf=!1;this.Wn=a;this.CY=b;this.Ca=c;this.eb=f}bxk(){this.cWb();this.dWb();this.Xni()}cWb(){const a=Cb.App.Hb.Hd.Ci;a&&(this.p0e=this.bod(this.p0e,1,2===Cb.App.Hb.mode&&a.sTc,Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent))}get JRj(){if(!Cb.App.xCh)return!1;r.a.oW&&
u.AFrameworkApplication.Wj("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled");return r.a.Aj}Xni(){this.JRj&&!this.hmb&&(this.hmb=this.CY.create("",CommonUIStrings.l_UnsupportedBrowserDeadline,null),this.hmb.id=15,this.hmb.closeable=!0,this.hmb.addButton(Box4Intl.Box4Strings.L_DownloadNow,I.AppFrame.Qul,""),on.a("NewBrowserSuggestionShown"),this.Wn.Wh(this.hmb,!1))}dWb(){let a=null;const b=Cb.App.Hb.Hd.Yaa;if(b){const c=b.Bfc;SF.a.x4b(c)?22===c?a=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:
19===c||20===c?a=r.a.Ki?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===c?a=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===c?a=r.a.Ki?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===c&&(a=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):2!==Cb.App.Hb.mode||SF.a.QQc(b.zTb)||Cb.App.Q5b||(a=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.r4e=this.bod(this.r4e,5,!!a,a)}B8k(a){!!this.fAa===
a||this.uAf||(a?(this.fAa=this.CY.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,null),this.fAa.id=13,this.fAa.closeable=!0,this.fAa.i2=()=>{this.uAf=!0;this.fAa=null},this.Wn.Wh(this.fAa)):(this.Wn.removeEntry(this.fAa),this.fAa=null))}nsh(a,b,c,f){a=this.CY.create(null,a,null);a.closeable=!0;a.id=23;a.image=3;a.HDf(b,()=>{ib.a.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+c)});f&&(a.i2=f);this.Wn.Wh(a,!0)}Qdl(a,b,c){this.nsh(a,b,c,null)}odl(a){a=this.CY.create(null,
a,null);a.closeable=!0;a.id=24;a.image=1;this.Wn.Wh(a,!0)}bel(a){a=this.CY.create(null,a,null);a.closeable=!0;a.id=20;this.Wn.Wh(a)}tdl(){var a=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,b=Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage;this.oLa||(this.oLa=this.CY.create(a,b,null),this.oLa.closeable=!0,this.oLa.id=27,this.Wn.Wh(this.oLa))}uuj(){this.oLa&&(this.oLa=this.bod(this.oLa,27,!1,""))}MNe(a){this.f2e=this.bod(this.f2e,30,!0,a)}bod(a,b,c,f){c?a?a.message=f:(a=this.CY.create("",
f,null),a.id=b,a.closeable=!1,this.Wn.Wh(a,!1)):a&&(this.Wn.removeEntry(a),a=null);return a}}Object(e.a)(XA,"BusinessBarController",null,[1341]);class YA extends XA{constructor(a,b,c,f,l,x,G,R){super(a,b,f,x);this.nfe=this.CJg=!1;this.xbc=[];this.Pxb=0;this.Mqe=null;this.ife=c;this.ia=f;this.M8=l;this.Fa=G;this.WD=R.QDa;this.XOg=R.powerPointDragInsertMultipleImageQuantityLimit}initialize(){this.ife.JM(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"))}dispose(){this.ife.QX(Object(C.a)(this,this.lw,
"onAppFrameModeSwitched"))}Zu(a,...b){this.PYb.apply(this,[a,this.M8.IOc(a),this.M8.d4d(a),this.M8.z1d(a)].concat(b))}PYb(a,b,c,f){0===a||this.Mqe||(c=this.CY.create(c,f||"",null),c.closeable=!0,c.errorCode=Jf.a.Qh(a),c.i2=Object(C.a)(this,this.$Oi,"errorEntryClosedHandler"),a=!!(b&8),b=!!(b&4),a&&c.addButton(ResourceStrings.L_Refresh,Object(C.a)(this,this.ced,"refreshActionHandler"),""),b&&(a?c.ZHd(ResourceStrings.L_OpenInPowerPoint,Object(C.a)(this,this.R$c,"openInClientActionHandler")):c.addButton(ResourceStrings.L_OpenInPowerPoint,
Object(C.a)(this,this.R$c,"openInClientActionHandler"),"")),this.Mqe=c,this.JTb(c))}ZM(a){var b="";let c="",f=null,l="",x=null;var G=!1;switch(a){case 0:b=ResourceStrings.L_BizBarTitle_MarkedAsFinal;a=ResourceStrings.L_BizBarMessage_MarkedAsFinal;G=!0;break;case 20:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;G=!0;break;case 1:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_EditPermissionDenied;G=!0;break;case 2:b=
ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatNotEditable;G=!0;break;case 3:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditCheckedOutByAnother;G=!0;break;case 4:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_RequiresCheckout;G=!0;break;case 5:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_LockedForOfflineCheckout;G=!0;break;case 6:b=ResourceStrings.L_BizBarTitle_Readonly;
a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditLock;G=!0;break;case 7:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_CannotAcquirePptEditSharedLock;G=!0;break;case 8:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_NumberOfCoauthorsReachedMax;G=!0;break;case 9:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PptEditExistingExclusiveLock;G=!0;break;case 10:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FileFormatConvertible;
c=ResourceStrings.L_BizBarButton_Convert;f=Object(C.a)(this,this.fwi,"convertActionHandler");G=!0;break;case 11:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_PasswordProtected;G=!0;break;case 12:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_FontRestricted;G=!0;break;case 13:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_SessionRestricted;G=!0;break;case 14:b=u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle?
u.AFrameworkApplication.fa.appSettings.IrmPolicyTitle:"";a=u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription?u.AFrameworkApplication.fa.appSettings.IrmPolicyDescription:"";G=!0;break;case 15:b=ResourceStrings.L_BizBarTitle_SessionExpired;a=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;G=!0;break;case 18:b=ResourceStrings.L_BizBarTitle_DragDropNotSupportFormat;a=ResourceStrings.L_BizBarMessage_DragDropNotSupportFormat;G=!1;break;case 19:b=String.format(ResourceStrings.L_BizBarTitle_DragDropMoreFilesThanLimite,
this.XOg);a=String.format(ResourceStrings.L_BizBarMessage_DragDropMoreFilesThanLimite,this.XOg);G=!1;break;case 22:b=ResourceStrings.L_BizBarTitle_Readonly;a=this.Hdj();G=!1;a&&(this.Pxb=a,a=this.ia.La(ba.a.zGb,1,this.Pxb),8!==a&&16!==a&&(G=!0,c=ResourceStrings.L_BizBarInlineRepairSaveAsText,f=Object(C.a)(this,this.$Tk,"repairSaveCopyHandler")));32===this.ia.processAction(ba.a.Hjc,1)&&(G?(l=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,x=Object(C.a)(this,this.Egh,"replaceOriginalFileHandler")):
(G=!0,c=ResourceStrings.L_BizBarInlineRepairOverwriteFileText,f=Object(C.a)(this,this.Egh,"replaceOriginalFileHandler")));a=G?ResourceStrings.L_BizBarInlineRepairWithSaveMessage:ResourceStrings.L_BizBarInlineRepairWithoutSaveMessage;G=!0;break;case 23:b=ResourceStrings.L_BizBarTitle_ViewOnly;a=ResourceStrings.L_BizBarEmergencyViewingModeMessage2;c=ResourceStrings.L_BizBarEmergencyViewingModeEditButton;f=Object(C.a)(this,this.Zkj,"goToEditModeHandler");G=!0;break;case 24:b=ResourceStrings.L_BizBarTitle_MinorVersionLimitReached;
a=ResourceStrings.L_BizBarInlineMinorVersionLimitReached;c=ResourceStrings.L_LearnMore;f=Object(C.a)(this,this.$sk,"openVersioningPageHandler");break;case 25:b=ResourceStrings.L_BizBarTitle_Readonly;a=ResourceStrings.L_BizBarMessage_UserNetworkLocationUnauthorized;break;case 26:a=ResourceStrings.L_BizBarMessage_CannotCropCurrentSelection;G=!1;break;default:return}b=this.CY.create(b,a,null);b.image=3;b.closeable=!0;b.i2=G?Object(C.a)(this,this.gch,"readOnlyInfoEntryClosedHandler"):Object(C.a)(this,
this.fog,"infoEntryClosedHandler");f&&b.addButton(c,f,"");x&&b.ZHd(l,x);this.JTb(b);G&&Array.add(this.xbc,b)}IBa(a){let b;switch(a){case 22:var c=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;b=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;case 36:c=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledTitle;b=CommonUIStrings.l_IrmProtectedDocumentAddinsDisabledMessage;break;default:return}c=this.CY.create(c,b,null);c.id=a;c.image=1;c.closeable=!0;this.JTb(c)}uIc(a,b){let c,f=!1,l=!1,x=!1,
G=!1;switch(a){case 1:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.L_BizBarMessage_EditPermissionDenied;b=1;break;case 0:a=ResourceStrings.L_BizBarTitle_MarkedAsFinal;c=b?ResourceStrings.L_BizBarMessage_MarkedAsFinal_DocIsEdited:ResourceStrings.L_BizBarMessage_MarkedAsFinal;l=b;b=1;break;case 20:a=ResourceStrings.L_BizBarTitle_Readonly;c=ResourceStrings.l_BizBarMessage_MarkedAsReadOnlyRecommended;x=!0;b=3;break;case 16:a=ResourceStrings.L_BizBarTitle_CannotConnectToInternet;c=ResourceStrings.L_BizBarMessage_CannotConnectToInternet;
f=!0;b=1;break;case 17:a=b?ResourceStrings.L_BizBarTitle_ChangesCannotBeSavedInThisFile:ResourceStrings.L_BizBarTitle_Readonly;c=b?ResourceStrings.L_BizBarMessage_ServerError_UserHasEditedDoc_Download:ResourceStrings.L_BizBarMessage_ServerError_UserNotEditedDoc;G=b;b=1;break;case 15:a=ResourceStrings.L_BizBarTitle_SessionExpired;c=ResourceStrings.L_BizBarMessage_SessionAccessTokenExpired;f=!0;b=1;break;case 21:a=ResourceStrings.L_BizBarTitle_WopiTokenOutOfRefreshRange;c=ResourceStrings.L_BizBarMessage_WopiTokenOutOfRefreshRange;
f=!0;b=1;break;default:return}a=this.CY.create(a,c||"",null);a.closeable=!0;a.i2=Object(C.a)(this,this.gch,"readOnlyInfoEntryClosedHandler");a.image=b;f?(Aa.a.J(37520129,801,15,"Refresh button is show"),a.addButton(ResourceStrings.L_Refresh,Object(C.a)(this,this.ced,"refreshActionHandler"),"")):l?(Aa.a.J(37520131,801,15,"SaveACopy button is show"),a.addButton(ResourceStrings.L_BizBarButton_SaveACopy,Object(C.a)(this,this.pZk,"saveAsActionHandler"),"")):G?(Aa.a.J(39978897,801,15,"DownloadACopy button is show"),
a.addButton(ResourceStrings.L_DownloadCopy,Object(C.a)(this,this.IKi,"downloadACopyActionHandler"),"")):x&&(Aa.a.J(38290691,801,15,"EditAnyway button is show"),a.addButton(ResourceStrings.l_BizBarButton_EditAnyway,Object(C.a)(this,this.wLi,"editAnywayActionHandler"),""));this.JTb(a);Array.add(this.xbc,a)}Dca(a){return this.Wn.Dca(a)}Hdj(){let a=0;if(this.eb.ka("IsUIEmbedMode")||this.eb.ka("DisablePrint")||!this.eb.Ga("DownloadACopyUrl")||"true"===this.eb.Ga("ProtectInClient")||r.a.Ki)return a;let b=
!0;this.eb.ka("SaveToAnotherFolderBrsIsEnabled")&&this.eb.ka("SupportsGetMoreInfoForPersonalStorage")||(b=!1);let c=!0;this.eb.ka("SaveACopyBrsIsEnabled")||(c=!1);let f=!0;this.eb.ka("SaveAsToHostBrsIsEnabled")&&this.eb.ka("UserCanWriteRelative")&&this.eb.ka("SupportsEditing")||(f=!1);a=b?F.a.hgb:c?F.a.ukc:a;Aa.a.J(50370196,801,(b||c)&&(b||f)&&(c||f)?15:50,"BusinessBarController::GetSaveAsCommand saveToSharePoint:{0}, saveACopy:{1}, saveAsToHost:{2}, CommandName: {3} ",b,c,f,a);return a}JTb(a){const b=
this.Wn.visible;this.Wn.Wh(a);b||this.Fa.Gj(zi.a.yMd,!0)}ced(a){Aa.a.J(37310492,801,15,"Refresh button is clicked, ErrorCode:{0}",a.errorCode);this.ia.processAction(ba.a.refresh,2)}fog(){this.Wn.entries.length||this.Fa.Gj(zi.a.yMd,!1)}$Oi(){this.Mqe=null;this.Wn.entries.length||this.Fa.Gj(zi.a.yMd,!1)}gch(a){Array.remove(this.xbc,a);this.fog(a);Aa.a.J(38290694,801,50,"Read-only info entry is closed")}R$c(){this.ia.La(ba.a.openInClient,2,!0)}fwi(){this.ia.La(ba.a.convertAndEdit,2,!1)}$Tk(){u.AFrameworkApplication.lJ?
this.wOe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.La(ba.a.zGb,2,this.Pxb)}Egh(){this.ia.processAction(ba.a.Hjc,2)}Zkj(){this.ia.processAction(ba.a.m2b,2)}pZk(){Aa.a.J(37310494,801,15,"SaveACopy button is clicked");u.AFrameworkApplication.lJ?this.wOe(CommonUIStrings.l_SensitivitySaveDocumentError):this.ia.La(F.a.hgb,2,!0)}IKi(){Aa.a.J(39978903,801,15,"DownloadACopy button is clicked");u.AFrameworkApplication.lJ?this.wOe(CommonUIStrings.l_SensitivityDownloadDocumentError):this.ia.La(F.a.downloadACopy,
2,!0)}wOe(a){Aa.a.J(50922395,801,50,"Unable to save/download ppt from business bar as document is protected");const b=new Di.StandardDialog;b.yd=0;b.jy(Jf.a.tKi,Ei.a.I2(ResourceStrings.l_GenericDialogTitle),Ei.a.I2(a),null)}wLi(){Aa.a.J(38290697,801,50,"EditAnyway button is clicked");this.ia.La(ba.a.lZb,2,20)}$sk(){Aa.a.J(558470216,801,50,"Learn More button is clicked");kv.Redirect.showHelp("0f6cd105-974f-44a4-aadb-43ac5bdfd247")}ZNd(){if(this.ife.X7a&&!this.nfe&&!this.CJg){this.nfe=!0;var a=this.CY.create("",
CommonUIStrings.l_OdfFileCompatWarningBusinessBar,null);a.closeable=!0;a.i2=()=>{this.CJg=!0;this.nfe=!1};a.addButton(CommonUIStrings.l_OdfFileCompatWarningBusinessBarButton,Object(C.a)(this,this.Qkk,"onCompatWarningButtonClick"),"");this.JTb(a)}}Qkk(){kv.Redirect.showHelp("PPTODF")}uZf(){for(const a of this.xbc)this.Wn.removeEntry(a);Array.clear(this.xbc)}lw(a){this.WD&&2===a.mode&&this.uZf()}}Object(e.a)(YA,"BusinessBarController",XA,[1340,1341,106]);class TF{constructor(a,b){this.A$a=null;this.o9j=
b;this.pb=document.createElement("div");this.pb.className="BusinessBarPanel";this.pb.id="BusinessBarPanel";this.ddc=document.createElement("div");this.ddc.id="BusinessBarPanelWorking";this.pb.insertBefore(this.ddc,this.pb.firstChild);a.execute(c=>{this.A$a=c;this.o9j&&this.A$a&&(this.A$a.wIc=!0);this.ddc.insertBefore(this.A$a.htmlElement,this.ddc.firstChild)});this.pb.style.position=te.a.Umc}dispose(){}layout(a,b){if(!this.A$a||!this.A$a.visible)return this.Ns(),a;this.pJi(b);this.pb.style.height=
$e.a.Nc(this.A$a.htmlElement.offsetHeight);return a}Ns(){"none"!==this.pb.style.display&&(this.pb.style.display="none")}pJi(a){this.pb.style.display.length&&(this.pb.style.display="");a&&(this.pb.style.direction=te.a.mZa)}get xa(){return this.pb}get CDl(){return this.ddc}get order(){return 2}}Object(e.a)(TF,"BusinessBarPane",null,[1154,716,106]);var Ww=d(562);class $o{}$o.Value="value";$o.MinValue="MinValue";$o.MaxValue="MaxValue";$o.Text="Text";Object(e.a)($o,"SliderCommandProperties",null,[]);var Sp=
d(1089);class qq{constructor(){this.iconSet=null;this.hidden=this.disabled=!1;this.customTooltip=this.keytip=this.fullDescriptionLabel=this.iconColor=null;this.shouldTakeFocus=!1}}Object(e.a)(qq,"CommonOptionalButtonProperties",null,[]);class sv extends qq{constructor(){super();this.role=this.commandValueId=null;this.supportsPreview=this.hideLabel=!1;this.lang=null}}Object(e.a)(sv,"OptionalButtonProperties",qq,[]);class UF extends sv{constructor(){super();this.animateTransition=!1}}Object(e.a)(UF,
"AdditionalInkButtonProperties",sv,[]);class By extends qq{constructor(){super();this.menuModel=null;this.hideLabel=!1;this.downChevronIcon=null;this.hideIcon=this.hideChevron=!1;this.labelInMenu=this.lang=null;this.toggled=!1;this.roleInMenu=null}}Object(e.a)(By,"OptionalFlyoutAnchorProperties",qq,[]);class VF extends By{constructor(){super();this.animateTransition=!1}}Object(e.a)(VF,"AdditionalInkFlyoutAnchorProperties",By,[]);class WF{constructor(){this.selected=!1;this.iconColor=null}}Object(e.a)(WF,
"InkControlState",null,[]);class XF{constructor(){this.keytip=this.lDa=this.label=null}}Object(e.a)(XF,"InkFlyoutAnchorResources",null,[]);class ts{constructor(){this.Qxb=[]}ya(a){this.Qxb.push(a)}commit(){appChrome.api.dispatch(this.Qxb);Array.clear(this.Qxb)}}Object(e.a)(ts,"AppChromeTransaction",null,[]);class ke{}ke.bC="InkPen1";ke.nF="InkPen2";ke.mF="InkHighlighter";ke.Esa="InkRuler";ke.y8a="InkColorPicker1";ke.oja="InkColorPicker2";ke.tDa="InkColorPicker3";ke.pja="InkColorPickerMRU1";ke.qja=
"InkColorPickerMRU2";ke.uDa="InkColorPickerMRU3";ke.xDa="InkThicknessSlider1";ke.yDa="InkThicknessSlider2";ke.zDa="InkThicknessSlider3";ke.vDa="InkDrawWithTouch";ke.U7="InkEraser";ke.V7="InkLasso";ke.wDa="InkSelect";ke.E6f="label";ke.C6f="iconName";ke.D6f="keytip";ke.B8d=4;Object(e.a)(ke,"InkRibbonManagerConstants",null,[]);class rq{constructor(a,b,c,f){this.aVa=this.cVa=this.bVa=rq.wDc;this.P7=(l,x,G,R,fa)=>{if(1===G)return this.dab?8:32;x=this.eua.ga(ke.Esa).selected;l!==ba.a.yJe&&this.uOd(l===
ba.a.lYa);G=new ts;if(this.SMe(this.rbe(fa)))switch(l){case ba.a.wJe:case ba.a.xJe:case ba.a.uJe:case ba.a.tJe:case ba.a.vJe:case ba.a.nJe:case ba.a.oJe:case ba.a.pJe:case ba.a.qJe:case ba.a.rJe:case ba.a.sJe:this.yJ(ke.vDa,!0,!1,G,!1)}switch(l){case ba.a.wJe:this.yJ(ke.bC,!0,!0,G,!0);this.ia.La(ba.a.bC,2,fa);this.$G=ke.bC;break;case ba.a.qJe:this.yJ(ke.bC,!0,!0,G,!0);this.FGb(ke.bC,this.xUa,ke.oja,[ke.pja,ke.qja],"#000000",fa,G);this.ia.La(ba.a.pja,2,fa);this.$G=ke.bC;break;case ba.a.nJe:this.yJ(ke.bC,
!0,!0,G,!0);this.FGb(ke.bC,this.xUa,ke.oja,[ke.pja,ke.qja],"#000000",fa,G);this.ia.La(ba.a.y8a,2,fa);this.$G=ke.bC;break;case ba.a.xJe:this.yJ(ke.nF,!0,!0,G,!0);this.ia.La(ba.a.nF,2,fa);this.$G=ke.nF;break;case ba.a.rJe:this.yJ(ke.nF,!0,!0,G,!0);this.FGb(ke.nF,this.xUa,ke.oja,[ke.pja,ke.qja],"#e71224",fa,G);this.ia.La(ba.a.qja,2,fa);this.$G=ke.nF;break;case ba.a.oJe:this.FGb(ke.nF,this.xUa,ke.oja,[ke.pja,ke.qja],"#e71224",fa,G);this.yJ(ke.nF,!0,!0,G,!0);this.ia.La(ba.a.oja,2,fa);this.$G=ke.nF;break;
case ba.a.uJe:this.yJ(ke.mF,!0,!0,G,!0);this.ia.La(ba.a.mF,2,fa);this.$G=ke.mF;break;case ba.a.sJe:this.yJ(ke.mF,!0,!0,G,!0);this.FGb(ke.mF,this.mzb,ke.tDa,[ke.uDa],"#fffc00",fa,G);this.ia.La(ba.a.uDa,2,fa);this.$G=ke.mF;break;case ba.a.pJe:this.yJ(ke.mF,!0,!0,G,!0);this.FGb(ke.mF,this.mzb,ke.tDa,[ke.uDa],"#fffc00",fa,G);this.ia.La(ba.a.tDa,2,fa);this.$G=ke.mF;break;case ba.a.tJe:this.yJ(ke.U7,!0,!1,G,!1);this.ia.La(ba.a.U7,2,fa);break;case ba.a.yJe:this.yJ(ke.Esa,!x,!1,G,!1);this.ia.La(ba.a.Esa,
2,fa);break;case ba.a.vJe:this.yJ(ke.V7,!0,!1,G,!1);this.ia.La(ba.a.V7,2,fa);break;case ba.a.lYa:this.yJ(ke.wDa,!0,!1,G,!1),this.yJ(ke.vDa,!1,!1,G,!1),this.ia.processAction(ba.a.wDa,2)}G.commit();this.b6j&&Ww.ShyRibbon.uOa(1,2);return 32};this.ia=a;this.b6j=f;this.eua=new Lc.a;this.Mka=new Lc.a;for(const l of rq.x8d){a="";switch(l){case ke.bC:a="#000000";break;case ke.nF:a="#E71224";break;case ke.mF:a="#FFFC00"}this.eua.$(l,Object.assign(new WF,{selected:!1,iconColor:a}))}u.AFrameworkApplication.Aa&&
u.AFrameworkApplication.Aa.jb&&u.AFrameworkApplication.Aa.jb.Up&&this.ub();this.xUa=new Ha.a;this.xUa.add("#FFC114");this.xUa.add("#F6630D");this.xUa.add("#FF0066");this.xUa.add("#5B2D90");this.mzb=new Ha.a;this.mzb.add("#00F900");this.mzb.add("#00FDFF");this.mzb.add("#FF40FF");this.mzb.add("#FF8517");this.$G=ke.bC;b.KId(Object(C.a)(this,this.YT,"onFocusChanged"));this.dab=!c||!c.Gc}ub(){this.ia.pa(ba.a.y8d,Bb.a.application,Object(C.a)(this,this.FMi,"enableMRUPenAndDisableDrawWithTouch"),4);this.ia.pa(ba.a.Sog,
Bb.a.application,Object(C.a)(this,this.Hqj,"handleRefreshInkUIValues"),4);this.ia.pa(ba.a.bSc,Bb.a.application,Object(C.a)(this,this.koj,"handleInkSetInkRibbonManagerDisabledState"),4);this.ia.pa(ba.a.wJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.xJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.uJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.yJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.nJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.oJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.pJe,Bb.a.application,
this.P7,4);this.ia.pa(ba.a.qJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.rJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.sJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.clh,Bb.a.application,Object(C.a)(this,this.G5d,"handleThicknessSliderChanged"),4);this.ia.pa(ba.a.dlh,Bb.a.application,Object(C.a)(this,this.G5d,"handleThicknessSliderChanged"),4);this.ia.pa(ba.a.elh,Bb.a.application,Object(C.a)(this,this.G5d,"handleThicknessSliderChanged"),4);this.ia.pa(ba.a.blh,Bb.a.application,Object(C.a)(this,
this.ioj,"handleInkDrawWithTouchSelected"),4);this.ia.pa(ba.a.tJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.vJe,Bb.a.application,this.P7,4);this.ia.pa(ba.a.lYa,Bb.a.application,this.P7,4)}koj(a,b,c,f,l){if(1===c)return 32;this.dab=l;return 32}Hqj(a,b,c){if(1===c)return 32;a=new ts;this.oHb(ke.xDa,this.bVa,a);this.oHb(ke.yDa,this.cVa,a);this.oHb(ke.zDa,this.aVa,a);a.commit();this.Mka.count||this.hWj();return 32}ioj(a,b,c,f,l){if(1===c)return this.dab?8:32;a=l&&l.forceDisable?l.forceDisable:!1;this.eua.ga(ke.vDa).selected||
a?this.cZf():(this.uOd(!1),a=new ts,this.yJ(ke.vDa,!0,!1,a,!1),this.yJ(this.$G,!0,!0,a,!0),a.commit(),this.ia.La(ba.a.w8d,2,{enable:!0}));return 32}G5d(a,b,c,f,l){if(1===c)return 32;b=new ts;this.yJ(ke.vDa,!0,!1,b,!1);l&&l&&(l[rq.Sgl]=$o.Value);switch(a){case ba.a.clh:this.ia.La(ba.a.xDa,2,l);this.bVa=this.C7a(l);this.oHb(ke.xDa,this.bVa,b);this.$G=ke.bC;break;case ba.a.dlh:this.ia.La(ba.a.yDa,2,l);this.cVa=this.C7a(l);this.oHb(ke.yDa,this.cVa,b);this.$G=ke.nF;break;case ba.a.elh:this.ia.La(ba.a.zDa,
2,l),this.aVa=this.C7a(l),this.oHb(ke.zDa,this.aVa,b),this.$G=ke.mF}b.commit();return 32}isEnabled(a){return this.eua.ga(a).selected}FMi(a,b,c){if(1===c)return 32;if(!Lg.c())return Aa.a.J(512493019,801,15,"Ribbon should be initialized when calling EnableMRUPenAndDisableDrawWithTouch."),8;if(!this.Mka.count)return 32;this.uOd(!1);this.cZf();this.eua.ga(this.$G).selected=!1;a=new ts;this.yJ(this.$G,!0,!0,a,!0);this.ia.processAction(ba.a.Rog,2);a.commit();return 32}hWj(){for(const a of rq.x8d)switch(a){case ke.bC:this.f7b(ke.bC);
break;case ke.nF:this.f7b(ke.nF);break;case ke.mF:this.f7b(ke.mF);break;case ke.U7:this.f7b(ke.U7);break;case ke.V7:this.f7b(ke.V7)}}f7b(a){const b=appChrome.selectors.getInkButtonState(a);this.Mka.$(a,Object.assign(new XF,{label:ke.E6f in b?Object(ua.a)(String,b[ke.E6f]):"",lDa:ke.C6f in b?Object(ua.a)(String,b[ke.C6f]):"",keytip:ke.D6f in b?Object(ua.a)(String,b[ke.D6f]):""}))}uOd(a){const b=new ts;for(const c of rq.x8d)if(c!==ke.Esa)switch(this.yJ(c,!1,!1,b,!0),c){case ke.bC:this.uqb(ke.bC,b,!0,
a);break;case ke.nF:this.uqb(ke.nF,b,!0,a);break;case ke.mF:this.uqb(ke.mF,b,!0,a);break;case ke.U7:this.uqb(ke.U7,b,!0,a);break;case ke.V7:this.uqb(ke.V7,b,!0,a)}b.commit()}FEh(a,b,c){c.ya(appChrome.actions.toggleButton(a,b));this.eua.ga(a).selected=b}yJ(a,b,c,f,l){c?b?(b&&!this.eua.ga(a).selected&&this.bsi(a,f,l),this.FEh(a,b,f)):this.uqb(a,f,l,a!==ke.wDa):this.FEh(a,b,f)}uqb(a,b,c,f){if(this.Mka.Jb(a)){var l=this.Mka.ga(a).lDa,x=this.Mka.ga(a).keytip,G=this.Mka.ga(a).label;a=appChrome.api.createInkButtonModel(a,
G,Object.assign(new UF,{iconSet:(new Sp.a(l)).iconSet,iconColor:this.eua.ga(a).iconColor,keytip:x,animateTransition:c&&!f}));b.ya(appChrome.actions.addControls([a]))}}bsi(a,b,c){if(this.Mka.Jb(a)){var f=this.Mka.ga(a).lDa,l=this.Mka.ga(a).keytip,x=this.Mka.ga(a).label;a=appChrome.api.createInkFlyoutAnchorModel(a,x,Object.assign(new VF,{iconSet:(new Sp.a(f)).iconSet,iconColor:this.eua.ga(a).iconColor,keytip:l,menuModel:appChrome.getInkFlyoutAnchorMenuModel(a),animateTransition:c}));b.ya(appChrome.actions.addControls([a]))}}S4k(a,
b,c){c.ya(appChrome.actions.updateIconColor(a,b))}T4k(a,b,c){c.ya(appChrome.actions.populateColorPickerCells(a,b))}oHb(a,b,c){c.ya(appChrome.actions.updateSliderSelectedValue(a,b))}Lyk(a,b,c,f){if(a=appChrome.selectors.getColorPickerState(a)){a=this.vyi(Array.isArray(a.colorCells)?a.colorCells:null);for(const l of b)this.T4k(l,this.f9i(a,c),f)}}g9i(a,b){const c=a.indexOf(b);-1===c?a.removeAt(a.count-1):a.removeAt(c);a.insert(0,b)}vyi(a){const b={};for(const c of a)b[c.id]=c;return b}f9i(a,b){const c=
[];for(let f of b)f in a&&Array.add(c,a[f]);return c}rbe(a){return a&&a.InputMethod?a.InputMethod===ke.B8d:!1}SMe(a){return!a||r.a.Ki||r.a.B4b}Tdj(a,b){a&&a.Color&&(b=6===Object(ua.a)(String,a.Color).length?"#"+a.Color:Object(ua.a)(String,a.Color));return b}FGb(a,b,c,f,l,x,G){l=this.Tdj(x,l);this.eua.ga(a).iconColor=l;this.S4k(a,l,G);this.g9i(b,l);this.Lyk(c,f,b,G)}cZf(){const a=new ts;this.yJ(ke.vDa,!1,!1,a,!1);this.ia.La(ba.a.w8d,2,{enable:!1});a.commit()}YT(a,b){b.ohc===Yb.a.tO&&b.UCb!==Yb.a.tO&&
this.ia.processAction(ba.a.Qog,2);b.ohc!==Yb.a.Bg&&b.UCb===Yb.a.Bg&&this.ia.processAction(ba.a.Uog,2)}C7a(a){return a&&a[$o.Value]?a[$o.Value]:rq.wDc}}rq.Sgl="SliderCommandPropertiesValueKey";rq.wDc=3;rq.x8d=[ke.bC,ke.nF,ke.vDa,ke.U7,ke.mF,ke.Esa,ke.V7,ke.wDa];Object(e.a)(rq,"InkRibbonManager",null,[1156]);class YF{constructor(a){this.Nge=a}get ixa(){return this.Nge.ixa}oNc(){return this.Nge.oNc()}rHe(){this.Nge.rHe()}}Object(e.a)(YF,"PPTChromeExtensionHelper",null,[1149,368]);var Ta=d(523);class Ng{constructor(a,
b){this.populateQueryCommandId=null;this.populateOnlyOnce=!1;this.populateQueryCommandId=a;this.populateOnlyOnce=b}}Object(e.a)(Ng,"MenuPopulationProperties",null,[]);class Xw{constructor(){this.Mrc={};this.Jrc={};this.Byf={};this.Krc={};this.Sud={};this.Tud={};this.Cvd={};this.P0h()}wCa(a){return this.Jrc[a]}S_d(a){return this.Krc[a]}v6i(a){return this.Sud[a]}getCommandByExternalUxId(a){return this.Mrc[a]}I3d(a){return this.Byf[a]}Hag(a){if(a in this.Cvd)return this.Cvd[a];Z.ULS.sendTraceTag(39946131,
306,15,"ReactCommandDefinitionMapping.GetExternalIconIdByLegacyIconId: can't find mapping for legacy icon {0}",a);return"MissingIcon_20"}u6i(a){return this.Tud[a]}ECf(a){this.addCommandToMaps(a)}addCommandToMaps(a){var b=this.Mrc[a.externalUxCommand];if(b){delete this.Mrc[b.externalUxCommand];const c=this.Jrc[b.commandId];for(let f=0;f<c.length;f++)if(c[f].externalUxCommand===b.externalUxCommand){Array.remove(c,c[f]);break}}this.Mrc[a.externalUxCommand]=a;b=this.Jrc[a.commandId];if(void 0===b||null===
b)b=[],this.Jrc[a.commandId]=b;b.push(a);a.legacyControlId&&(this.Krc[a.legacyControlId]||(this.Krc[a.legacyControlId]=new Ha.a),this.Krc[a.legacyControlId].add(a.externalUxCommand))}addTabToMap(a,b){this.Byf[a]=b}addIconToMap(a,b){this.Cvd[b]=a}Di(a){if(a.legacyGroupId){var b=this.Sud[a.legacyGroupId];b||(b=[],this.Sud[a.legacyGroupId]=b);b.push(a)}a.externalUxGroupId&&(b=this.Tud[a.externalUxGroupId],b||(b=[],this.Tud[a.externalUxGroupId]=b),b.push(a))}P0h(){this.addCommandToMaps(Object.assign(new Ta.a("AccessibilityHelp",
"3276527670"),{legacyControlId:"jbtnAccessibilityHelp"}));this.addCommandToMaps(new Ta.a("AlwaysShowRibbon","336231556"));this.addCommandToMaps(new Ta.a("CoauthorsRendered","691867605"));this.addCommandToMaps(Object.assign(new Ta.a("CopyLink","981334692"),{legacyControlId:"CopyLink"}));this.addCommandToMaps(Object.assign(new Ta.a("ShareMenu","336231556"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Ta.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",
queryCommandId:"1059068017"}));this.addCommandToMaps(Object.assign(new Ta.a("CheckAccessibility","2529583086"),{legacyControlId:"btnOpenAccCheckerPane",queryCommandId:"1949220702"}));this.addCommandToMaps(Object.assign(new Ta.a("ContactSupport","2918242107"),{legacyControlId:"btnContactSupport"}));this.addCommandToMaps(Object.assign(new Ta.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"}));this.addCommandToMaps(Object.assign(new Ta.a("DownloadACopy","3555692408"),
{legacyControlId:"jbtnDownloadACopy"}));this.addCommandToMaps(new Ta.a("FileMenuLauncher","1784018444"));this.addCommandToMaps(Object.assign(new Ta.a("GiveFeedback","802602464"),{legacyControlId:"jbtnGiveFeedback"}));this.addCommandToMaps(Object.assign(new Ta.a("Help","1454393937"),{legacyControlId:"jbtnHelp"}));this.addCommandToMaps(new Ta.a("HideRibbon","336231556"));this.addCommandToMaps(new Ta.a("InsertAddIns","1945259303"));this.addCommandToMaps(new Ta.a("InsertMoreAddInsFromFooter","1945259303"));
this.addCommandToMaps(new Ta.a("InsertAddInsFromBackstage","1945259303"));this.addCommandToMaps(new Ta.a("InsertComment","2423504651"));this.addCommandToMaps(Object.assign(new Ta.a("InsertComment","2423504651"),{legacyControlId:"btnInsertComment"}));this.addCommandToMaps(new Ta.a("ManageAccess","981334692"));this.addCommandToMaps(new Ta.a("MenuClose","336231556"));this.addCommandToMaps(new Ta.a("MenuOpen","336231556"));this.addCommandToMaps(new Ta.a("MenuPopulate","336231556"));this.addCommandToMaps(new Ta.a("MoveToFolder",
"1182470434"));this.addCommandToMaps(new Ta.a("NavigateToCoauthor","4033456482"));this.addCommandToMaps(new Ta.a("New","1056925771"));this.addCommandToMaps(new Ta.a("NewBrowserSuggestionClicked","3734060499"));this.addCommandToMaps(Object.assign(new Ta.a("NewComment","2423504651"),{legacyControlId:"btnNewComment"}));this.addCommandToMaps(Object.assign(new Ta.a("PeopleWell","929022654"),{queryCommandId:"3798167515",populationProps:new Ng("1285265560",!1)}));this.addCommandToMaps(Object.assign(new Ta.a("Privacy",
"1208554566"),{legacyControlId:"jbtnPrivacy"}));this.addCommandToMaps(Object.assign(new Ta.a("Rename","2382951455"),{legacyControlId:"jbtnRenameDialog"}));this.addCommandToMaps(Object.assign(new Ta.a("SaveAs","4246497969"),{legacyControlId:"jbtnSaveACopy"}));this.addCommandToMaps(Object.assign(new Ta.a("SaveAsToHost","2316717900"),{legacyControlId:"jbtnSaveAsToHost"}));this.addCommandToMaps(Object.assign(new Ta.a("SaveToSharePoint","3050207199"),{legacyControlId:"jbtnSaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Ta.a("SearchHelp",
"2918242107"),{legacyControlId:"btnHelp"}));this.addCommandToMaps(Object.assign(new Ta.a("Share","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Ta.a("ShareTopBar","981334692"),{legacyControlId:"jbtnFileSharing"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartLookUp","1435347209"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Ta.a("TabSwitch","336231556"));this.addCommandToMaps(Object.assign(new Ta.a("TermsOfUse","2349775795"),{legacyControlId:"jbtnTermsOfUse"}));
this.addCommandToMaps(Object.assign(new Ta.a("Training","2918242107"),{legacyControlId:"btnShowTraining"}));this.addCommandToMaps(Object.assign(new Ta.a("VersionHistory","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Ta.a("WhatsNew","2918242107"),{legacyControlId:"btnWhatsNew"}));this.addCommandToMaps(Object.assign(new Ta.a("Zoom","1738002952"),{legacyControlId:"btnViewZoomDialog"}));this.addCommandToMaps(Object.assign(new Ta.a("ToggleRibbonUXDialog","1342108365"),
{legacyControlId:"toggleBtnSimpleRibbon",queryCommandId:"1536028887"}));this.addCommandToMaps(new Ta.a("CommitNewDocumentTitle","1808554760"));this.addCommandToMaps(new Ta.a("RibbonModeToggledToMLR","536345575"));this.addCommandToMaps(new Ta.a("RibbonModeToggledToSLR","4031133701"));this.addCommandToMaps(new Ta.a("Workflow","2988588587"));this.addCommandToMaps(new Ta.a("ToggleVNextLook","1650341290"));this.addCommandToMaps(Object.assign(new Ta.a("DefinitionsParameterized","2114287254"),{legacyControlId:"btnInsights"}));
this.addCommandToMaps(Object.assign(new Ta.a("GetHelpFromTellMe","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Ta.a("GetHelpFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Ta.a("GetHelpFromTellMe2","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Ta.a("GetHelpWithDescriptionFromTellMe1","2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(Object.assign(new Ta.a("GetHelpWithDescriptionFromTellMe2",
"2918242107"),{legacyControlId:"bSearchHelp"}));this.addCommandToMaps(new Ta.a("AnswerForSearch","1914896509"));this.addCommandToMaps(new Ta.a("AnswerForSearchSingleLine","1914896509"));this.addCommandToMaps(new Ta.a("ReuseFileQuickActionForSearch","1914896509"));this.addCommandToMaps(new Ta.a("PeopleSuggestion1","2133437452"));this.addCommandToMaps(new Ta.a("PeopleSuggestion2","2133437453"));this.addCommandToMaps(new Ta.a("PeopleSuggestion3","2133437454"));this.addCommandToMaps(new Ta.a("FileSuggestion1",
"2260671807"));this.addCommandToMaps(new Ta.a("FileSuggestion2","2260671810"));this.addCommandToMaps(new Ta.a("FileSuggestion3","2260671809"));this.addCommandToMaps(new Ta.a("FileSuggestion4","2260671804"));this.addCommandToMaps(new Ta.a("FileSuggestion5","2260671803"));this.addCommandToMaps(new Ta.a("NotesSuggestion1","1914896509"));this.addCommandToMaps(new Ta.a("NotesSuggestion2","1914896509"));this.addCommandToMaps(new Ta.a("NotesSuggestion3","1914896509"));this.addCommandToMaps(new Ta.a("OnenoteNotesSuggestion1",
"4083547050"));this.addCommandToMaps(new Ta.a("OnenoteNotesSuggestion2","4083547053"));this.addCommandToMaps(new Ta.a("OnenoteNotesSuggestion3","4083547052"));this.addCommandToMaps(new Ta.a("TellMeFeedback","2230755196"));this.addCommandToMaps(new Ta.a("TemplateForSearch","57037313"));this.addCommandToMaps(new Ta.a("AddinSuggestion1","1385019911"));this.addCommandToMaps(new Ta.a("AddinSuggestion2","981735384"));this.addCommandToMaps(new Ta.a("AddinSuggestion3","2547819325"));this.addCommandToMaps(new Ta.a("LaunchAddinDialogFromTellMe",
"1421877154"));u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.fIb?(this.addCommandToMaps(new Ta.a("FindWithMatchesParameterized","1914896509")),this.addCommandToMaps(new Ta.a("FindParameterized","1914896509")),this.addCommandToMaps(new Ta.a("FindInDocumentSuggestion1","1914896509")),this.addCommandToMaps(new Ta.a("FindInDocumentSuggestion2","1914896509")),this.addCommandToMaps(new Ta.a("FindInDocumentSuggestion3","1914896509"))):(this.addCommandToMaps(new Ta.a("FindWithMatchesParameterized",
"1540292897")),this.addCommandToMaps(new Ta.a("FindParameterized","1540292897")),this.addCommandToMaps(new Ta.a("FindInDocumentSuggestion1","1540292897")),this.addCommandToMaps(new Ta.a("FindInDocumentSuggestion2","1540292897")),this.addCommandToMaps(new Ta.a("FindInDocumentSuggestion3","1540292897")));this.addCommandToMaps(new Ta.a("ImageForSearch","1914896509"));this.addCommandToMaps(new Ta.a("LearningForSearch","1006342541"));this.addCommandToMaps(new Ta.a("SmartLookupFromTellMe","1914896509"));
this.addCommandToMaps(new Ta.a("SmartLookupFromTellMeQueryTermAtTop","1914896509"));this.addCommandToMaps(new Ta.a("SmartLookupFromTellMeZeroTerm","3359903192"));!u.AFrameworkApplication.DDa||u.AFrameworkApplication.wxa||u.AFrameworkApplication.fa.ka("SmartLookupEnableNativePane")||(this.addCommandToMaps(Object.assign(new Ta.a("SmartLookupFromTellMe","3317204163"),{legacyControlId:"btnInsights"})),this.addCommandToMaps(Object.assign(new Ta.a("SmartLookupFromTellMeQueryTermAtTop","3317204163"),{legacyControlId:"btnInsights"})),
this.addCommandToMaps(new Ta.a("AnswerForSearch","3317204163")),this.addCommandToMaps(new Ta.a("AnswerForSearchSingleLine","3317204163")));this.addCommandToMaps(Object.assign(new Ta.a("SynonymsParameterized","2114287254"),{legacyControlId:"btnInsights"}));this.addCommandToMaps(new Ta.a("TellMeLogMenuClose","4266170064"));this.addCommandToMaps(new Ta.a("TellMeLogMenuOpen","2480888384"));this.addCommandToMaps(new Ta.a("TellMeMenuItemExecuted","878547493"));this.addCommandToMaps(new Ta.a("TellMeSearchResultChange",
"2652476189"));this.addCommandToMaps(new Ta.a("TellMeSuggestion_1","1404166600"));this.addCommandToMaps(new Ta.a("TellMeSuggestion_2","1404166600"));this.addCommandToMaps(new Ta.a("TellMeSuggestion_3","1404166600"));this.addCommandToMaps(new Ta.a("TellMeSuggestion_4","1404166600"));this.addCommandToMaps(new Ta.a("TellMeSuggestion_5","1404166600"));this.addCommandToMaps(new Ta.a("TryOfficeUpsell","215809929"));this.addCommandToMaps(Object.assign(new Ta.a("TellMeControl","336231556"),{legacyControlId:"TellMeControl"}));
this.addCommandToMaps(Object.assign(new Ta.a("DiagnosticsSection","336231556"),{legacyControlId:"AboutInformationMenuSectionDiagnostics"}));this.addCommandToMaps(Object.assign(new Ta.a("FileAboutPage","336231556"),{legacyControlId:"faAbout"}));this.addCommandToMaps(Object.assign(new Ta.a("FileHelpPage","336231556"),{legacyControlId:"faHelp"}));this.addCommandToMaps(Object.assign(new Ta.a("FileHomePage","2074131365"),{legacyControlId:"faHome"}));this.addCommandToMaps(Object.assign(new Ta.a("FileGetAddinsPage",
"336231556"),{legacyControlId:"faGetAddinsFromBackstage"}));this.addCommandToMaps(Object.assign(new Ta.a("FileInfoPage","336231556"),{legacyControlId:"faInfo"}));this.addCommandToMaps(Object.assign(new Ta.a("FileNewPage","2074131365"),{legacyControlId:"faNew"}));this.addCommandToMaps(Object.assign(new Ta.a("FileOpenPage","2799130311"),{legacyControlId:"faOpen"}));this.addCommandToMaps(Object.assign(new Ta.a("FilePrintPage","336231556"),{legacyControlId:"faPrint"}));this.addCommandToMaps(Object.assign(new Ta.a("FileSaveAsPage",
"336231556"),{legacyControlId:"faSaveAs"}));this.addCommandToMaps(Object.assign(new Ta.a("FileSharePage","336231556"),{legacyControlId:"faShare"}));this.addCommandToMaps(Object.assign(new Ta.a("FileTransformPage","336231556"),{legacyControlId:"faTransform"}));this.addCommandToMaps(new Ta.a("NewDocument","1056925771"));this.addCommandToMaps(new Ta.a("OpenUrlInNewTab","1959943459"));this.addCommandToMaps(new Ta.a("OpenDocumentUrl","2155708348"));this.addCommandToMaps(Object.assign(new Ta.a("ReplyWithChanges",
"1197060601"),{legacyControlId:"jbtnShareRWC"}));this.addCommandToMaps(Object.assign(new Ta.a("ReportAbuse","3237171630"),{legacyControlId:"jbtnReportAbuse"}));this.addCommandToMaps(Object.assign(new Ta.a("ThirdPartyNotices","2220417879"),{legacyControlId:"jbtnThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Ta.a("TrustCenter","2583751502"),{legacyControlId:"jbtnTrustCenter"}));this.addCommandToMaps(Object.assign(new Ta.a("TryOfficeForWordEditor","1773624819"),{legacyControlId:"btnjTryMacOfficeForWordEditor"}));
this.addCommandToMaps(Object.assign(new Ta.a("TryMacOfficeForWordEditor","3901198658"),{legacyControlId:"btnjTryOfficeForWordEditor"}));this.addCommandToMaps(Object.assign(new Ta.a("PreviousVersions","466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Ta.a("FileVersionHistory","466976539"),{legacyControlId:"btnjVersionHistory"}));this.addCommandToMaps(Object.assign(new Ta.a("FilePreviousVersions","3681556347"),{legacyControlId:"jbtnVersion"}));this.addCommandToMaps(Object.assign(new Ta.a("HostConversation",
"710925581"),{legacyControlId:"HostConversation"}));this.addCommandToMaps(Object.assign(new Ta.a("HostClose","3033402446"),{legacyControlId:"HostClose"}));this.addCommandToMaps(Object.assign(new Ta.a("HostDownload","3555692408"),{legacyControlId:"HostDownload"}));this.addCommandToMaps(Object.assign(new Ta.a("HostOpenInBrowser","2596942163"),{legacyControlId:"HostOpenInBrowser"}));this.addCommandToMaps(Object.assign(new Ta.a("HostMoreOptions","336231556"),{legacyControlId:"HostMoreOptions"}));this.addCommandToMaps(Object.assign(new Ta.a("Sensitivity",
"941487903"),{legacyControlId:"flySensitivity",queryCommandId:"3134802707",populationProps:new Ng("1145315516",!0)}));this.addCommandToMaps(Object.assign(new Ta.a("InsertAddInFlyout","2749373765"),{populationProps:new Ng("1230970894",!1)}));this.addCommandToMaps(Object.assign(new Ta.a("ReloadAddInPicker","2502873265"),{populationProps:new Ng("1230970894",!1)}));this.addCommandToMaps(Object.assign(new Ta.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"}));this.addCommandToMaps(new Ta.a("FreemiumUpsellEligible",
"1274543852"));this.addCommandToMaps(new Ta.a("FreemiumUpsellDialogShowUI","4180531998"));this.addCommandToMaps(new Ta.a("ReportFreemiumUpsellEligibleDisplayed","2539564555"));this.addCommandToMaps(new Ta.a("HandleDiscoverPremiumButtonClick","2280081216"));this.addCommandToMaps(new Ta.a("RequestFontInfo","3169500754"));this.addCommandToMaps(new Ta.a("PinOrUnpinFont","1500655301"));this.addCommandToMaps(new Ta.a("FontPickerMenuClose","146595126"));this.addCommandToMaps(new Ta.a("ShowAccessibilitySettingsDialog",
"2236763780"));this.addCommandToMaps(Object.assign(new Ta.a("ShowZoomDialog","1738002952"),{queryCommandId:"433063458",legacyControlId:"buttonShowZoomDialog"}));this.addCommandToMaps(Object.assign(new Ta.a("ZoomToPercentage","3745693956"),{queryCommandId:"2901130581",legacyControlId:"ZoomSlider"}));this.addCommandToMaps(new Ta.a("ZoomToPercentageCompleted","3139946409"));this.addCommandToMaps(Object.assign(new Ta.a("RecentLinks","2535492938"),{queryCommandId:"2535492938",populationProps:new Ng("860679239",
!1)}));this.addCommandToMaps(Object.assign(new Ta.a("InsertLinkFlyout","1052791248"),{queryCommandId:"1052791248",populationProps:new Ng("276140882",!1)}))}}Object(e.a)(Xw,"ReactCommandDefinitionMapping",null,[1510]);class hg{constructor(a){this.externalUxCommandIds=this.commandId=this.externalUxGroupId=this.legacyGroupId=null;this.legacyGroupId=a}}Object(e.a)(hg,"GroupMetadata",null,[]);class ZA extends Xw{constructor(a){super();this.D0j="AnimationNone AnimationAppear AnimationFadeIn AnimationFlyIn AnimationSplit AnimationWipe AnimationRandomBars AnimationGrowAndTurn AnimationZoom AnimationBasicZoom AnimationBlinds AnimationBox AnimationCheckerboard AnimationExpand AnimationPeekIn AnimationRiseUp AnimationStretch AnimationStrips AnimationEmphasis_Spin AnimationEmphasis_GrowShrink AnimationEmphasis_Transparency AnimationEmphasis_LineColor AnimationEmphasis_FillColor AnimationEmphasis_FontColor AnimationExit_Disappear AnimationExit_Fade AnimationExit_FlyOut AnimationExit_Split AnimationExit_Wipe AnimationExit_RandomBars AnimationExit_Zoom AnimationExit_BasicZoom AnimationExit_Blinds AnimationExit_Box AnimationExit_Checkerboard AnimationExit_PeekOut AnimationExit_Stretchy AnimationExit_Strips AnimationGalleryNone AnimationGalleryEntrance AnimationGalleryEmphasis AnimationGalleryExit".split(" ");
this.A0j=26;this.z0j="AnimationEffectOptionsDataSpin_Quarter AnimationEffectOptionsDataSpin_Half AnimationEffectOptionsDataSpin_Full AnimationEffectOptionsDataSpin_Two AnimationEffectOptionsDataTransparency_25 AnimationEffectOptionsDataTransparency_50 AnimationEffectOptionsDataTransparency_75 AnimationEffectOptionsDataTransparency_100 AnimationEffectOptionsDataGrowShrink_Tiny AnimationEffectOptionsDataGrowShrink_Smaller AnimationEffectOptionsDataGrowShrink_Larger AnimationEffectOptionsDataGrowShrink_Huge".split(" ");
this.C0j=31;this.B0j="AnimationEffectOptionsDirectionFromBottom AnimationEffectOptionsDirectionFromBottomLeft AnimationEffectOptionsDirectionFromLeft AnimationEffectOptionsDirectionFromTopLeft AnimationEffectOptionsDirectionFromTop AnimationEffectOptionsDirectionFromTopRight AnimationEffectOptionsDirectionFromRight AnimationEffectOptionsDirectionFromBottomRight AnimationEffectOptionsDirectionToBottom AnimationEffectOptionsDirectionToBottomLeft AnimationEffectOptionsDirectionToLeft AnimationEffectOptionsDirectionToTopLeft AnimationEffectOptionsDirectionToTop AnimationEffectOptionsDirectionToTopRight AnimationEffectOptionsDirectionToRight AnimationEffectOptionsDirectionToBottomRight AnimationEffectOptionsDirectionHorizontal AnimationEffectOptionsDirectionHorizontalIn AnimationEffectOptionsDirectionHorizontalOut AnimationEffectOptionsDirectionVertical AnimationEffectOptionsDirectionVerticalIn AnimationEffectOptionsDirectionVerticalOut AnimationEffectOptionsDirectionLeftDown AnimationEffectOptionsDirectionLeftUp AnimationEffectOptionsDirectionRightDown AnimationEffectOptionsDirectionRightUp AnimationEffectOptionsDirectionIn AnimationEffectOptionsDirectionInBottom AnimationEffectOptionsDirectionInCenter AnimationEffectOptionsDirectionInSlightly AnimationEffectOptionsDirectionOut AnimationEffectOptionsDirectionOutBottom AnimationEffectOptionsDirectionOutCenter AnimationEffectOptionsDirectionOutSlightly AnimationEffectOptionsDirectionFloatUp AnimationEffectOptionsDirectionFloatDown AnimationEffectOptionsDirectionObjectCenter AnimationEffectOptionsDirectionSlideCenter AnimationEffectOptionsDirectionObjectCenterOut AnimationEffectOptionsDirectionSlideCenterOut AnimationEffectOptionsDirectionClockwise AnimationEffectOptionsDirectionCounterClockwise AnimationEffectOptionsDirectionAcross AnimationEffectOptionsDirectionUp AnimationEffectOptionsDirectionDown AnimationEffectOptionsDirectionGrowShrinkHorizontal AnimationEffectOptionsDirectionGrowShrinkVertical AnimationEffectOptionsDirectionGrowShrinkBoth".split(" ");
this.kbk=23;this.jbk="TransitionEffectOptionsTransitionExisting TransitionEffectOptionsTransitionExistingInMenu TransitionEffectOptionsTransitionNone TransitionEffectOptionsTransitionFade TransitionEffectOptionsTransitionFadeSmoothly TransitionEffectOptionsTransitionFadeThroughBlack TransitionEffectOptionsTransitionPush TransitionEffectOptionsTransitionPushFromBottom TransitionEffectOptionsTransitionPushFromLeft TransitionEffectOptionsTransitionPushFromRight TransitionEffectOptionsTransitionPushFromTop TransitionEffectOptionsTransitionCut TransitionEffectOptionsTransitionCutNone TransitionEffectOptionsTransitionCutThroughBlack TransitionEffectOptionsTransitionWipe TransitionEffectOptionsTransitionWipeFromRight TransitionEffectOptionsTransitionWipeFromTop TransitionEffectOptionsTransitionWipeFromLeft TransitionEffectOptionsTransitionWipeFromBottom TransitionEffectOptionsTransitionWipeFromTopRight TransitionEffectOptionsTransitionWipeFromBottomRight TransitionEffectOptionsTransitionWipeFromTopLeft TransitionEffectOptionsTransitionWipeFromBottomLeft TransitionEffectOptionsTransitionMorph TransitionEffectOptionsTransitionMorphByObject TransitionEffectOptionsTransitionMorphByWord TransitionEffectOptionsTransitionMorphByChar TransitionEffectOptionsTransitionSplit TransitionEffectOptionsTransitionSplitVerticalOut TransitionEffectOptionsTransitionSplitHorizontalIn TransitionEffectOptionsTransitionSplitHorizontalOut TransitionEffectOptionsTransitionSplitVerticalIn TransitionEffectOptionsTransitionRandom TransitionEffectOptionsTransitionRandomBars TransitionEffectOptionsTransitionRandomBarsVertical TransitionEffectOptionsTransitionRandomBarsHorizontal TransitionEffectOptionsTransitionShape TransitionEffectOptionsTransitionShapeCircle TransitionEffectOptionsTransitionShapeDiamond TransitionEffectOptionsTransitionShapePlus TransitionEffectOptionsTransitionShapeIn TransitionEffectOptionsTransitionShapeOut TransitionEffectOptionsTransitionCombHorizontal TransitionEffectOptionsTransitionCombVertical TransitionEffectOptionsTransitionWheelClockwise TransitionEffectOptionsTransitionWheelCounterclockwise TransitionEffectOptionsTransitionWheelWedge TransitionEffectOptionsTransitionRevealFromLeft TransitionEffectOptionsTransitionRevealFromRight TransitionEffectOptionsTransitionRevealSmoothlyFromLeft TransitionEffectOptionsTransitionRevealSmoothlyFromRight TransitionEffectOptionsTransitionDissolve TransitionEffectOptionsTransitionBlindsHorizontal TransitionEffectOptionsTransitionBlindsVertical TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionCoverFromBottom TransitionEffectOptionsTransitionCoverFromBottomLeft TransitionEffectOptionsTransitionCoverFromBottomRight TransitionEffectOptionsTransitionCoverFromLeft TransitionEffectOptionsTransitionCoverFromRight TransitionEffectOptionsTransitionCoverFromTop TransitionEffectOptionsTransitionCoverFromTopLeft TransitionEffectOptionsTransitionCoverFromTopRight TransitionEffectOptionsTransitionUncoverFromBottom TransitionEffectOptionsTransitionUncoverFromBottomLeft TransitionEffectOptionsTransitionUncoverFromBottomRight TransitionEffectOptionsTransitionUncoverFromLeft TransitionEffectOptionsTransitionUncoverFromRight TransitionEffectOptionsTransitionUncoverFromTop TransitionEffectOptionsTransitionUncoverFromTopLeft TransitionEffectOptionsTransitionUncoverFromTopRight TransitionEffectOptionsTransitionRippleCenter TransitionEffectOptionsTransitionRippleBottomLeft TransitionEffectOptionsTransitionRippleBottomRight TransitionEffectOptionsTransitionRippleTopRight TransitionEffectOptionsTransitionRippleTopLeft TransitionEffectOptionsTransitionCubeFromBottom TransitionEffectOptionsTransitionCubeFromLeft TransitionEffectOptionsTransitionCubeFromRight TransitionEffectOptionsTransitionCubeFromTop TransitionEffectOptionsTransitionBoxFromBottom TransitionEffectOptionsTransitionBoxFromLeft TransitionEffectOptionsTransitionBoxFromRight TransitionEffectOptionsTransitionBoxFromTop TransitionEffectOptionsTransitionSwitchLeft TransitionEffectOptionsTransitionSwitchRight TransitionEffectOptionsTransitionFallOverLeft TransitionEffectOptionsTransitionFallOverRight TransitionEffectOptionsTransitionDrapeLeft TransitionEffectOptionsTransitionDrapeRight TransitionEffectOptionsTransitionFlipLeft TransitionEffectOptionsTransitionFlipRight TransitionEffectOptionsTransitionWindLeft TransitionEffectOptionsTransitionWindRight TransitionEffectOptionsTransitionPrestige TransitionEffectOptionsTransitionFracture TransitionEffectOptionsTransitionCrush TransitionEffectOptionsTransitionPeelOffLeft TransitionEffectOptionsTransitionPeelOffRight TransitionEffectOptionsTransitionPageCurlSingleLeft TransitionEffectOptionsTransitionPageCurlSingleRight TransitionEffectOptionsTransitionPageCurlDoubleLeft TransitionEffectOptionsTransitionPageCurlDoubleRight TransitionEffectOptionsTransitionAirplaneLeft TransitionEffectOptionsTransitionAirplaneRight TransitionEffectOptionsTransitionOrigamiLeft TransitionEffectOptionsTransitionOrigamiRight TransitionEffectOptionsTransitionCheckerFromLeft TransitionEffectOptionsTransitionCheckerFromTop TransitionEffectOptionsTransitionVortexFromLeft TransitionEffectOptionsTransitionVortexFromTop TransitionEffectOptionsTransitionVortexFromRight TransitionEffectOptionsTransitionVortexFromBottom TransitionEffectOptionsTransitionCurtains TransitionEffectOptionsTransitionGlitterHexagonLeft TransitionEffectOptionsTransitionGlitterHexagonTop TransitionEffectOptionsTransitionGlitterHexagonRight TransitionEffectOptionsTransitionGlitterHexagonBottom TransitionEffectOptionsTransitionGlitterDiamondLeft TransitionEffectOptionsTransitionGlitterDiamondTop TransitionEffectOptionsTransitionGlitterDiamondRight TransitionEffectOptionsTransitionGlitterDiamondBottom TransitionEffectOptionsTransitionOrbitFromTop TransitionEffectOptionsTransitionOrbitFromBottom TransitionEffectOptionsTransitionOrbitFromLeft TransitionEffectOptionsTransitionOrbitFromRight TransitionEffectOptionsTransitionRotateFromTop TransitionEffectOptionsTransitionRotateFromBottom TransitionEffectOptionsTransitionRotateFromLeft TransitionEffectOptionsTransitionRotateFromRight TransitionEffectOptionsTransitionConveyorFromRight TransitionEffectOptionsTransitionConveyorFromLeft TransitionEffectOptionsTransitionGalleryIconFromRight TransitionEffectOptionsTransitionGalleryIconFromLeft TransitionEffectOptionsTransitionPanFromBottom TransitionEffectOptionsTransitionPanFromLeft TransitionEffectOptionsTransitionPanFromRight TransitionEffectOptionsTransitionPanFromTop TransitionEffectOptionsTransitionDoorsVertical TransitionEffectOptionsTransitionDoorsHorizontal TransitionEffectOptionsTransitionWindowVertical TransitionEffectOptionsTransitionWindowHorizontal TransitionEffectOptionsTransitionZoomIn TransitionEffectOptionsTransitionZoomOut TransitionEffectOptionsTransitionZoomAndRotate TransitionEffectOptionsTransitionFlyThroughIn TransitionEffectOptionsTransitionFlyThroughOut TransitionEffectOptionsTransitionFlyThroughInWithBounce TransitionEffectOptionsTransitionFlyThroughOutWithBounce".split(" ");
this.r8j="PictureStyles_SimpleFrameWhite_15505 PictureStyles_BeveledMatteWhite_15506 PictureStyles_MetalFrame_15507 PictureStyles_DropShadowRectangle_15508 PictureStyles_ReflectedRoundedRectangle_15509 PictureStyles_SoftEdgeRectangle_15510 PictureStyles_DoubleFrameBlack_15511 PictureStyles_ThickMatteBlack_15512 PictureStyles_SimpleFrameBlack_15513 PictureStyles_BeveledOvalBlack_15514 PictureStyles_CompoundFrameBlack_15515 PictureStyles_ModerateFrameBlack_15516 PictureStyles_CenterShadowRectangle_15517 PictureStyles_RoundedDiagonalCornerWhite_15518 PictureStyles_SnipDiagonalCornerWhite_15519 PictureStyles_ModerateFrameWhite_15520 PictureStyles_RotatedWhite_15521 PictureStyles_PerspectiveShadowWhite_15522 PictureStyles_RelaxedPerspectiveWhite_15523 PictureStyles_SoftEdgeOval_15524 PictureStyles_BevelEdgeRectangle_15525 PictureStyles_BevelPerspective_15526 PictureStyles_ReflectedPerspectiveRight_15527 PictureStyles_BevelPerspectiveLeftWhite_15528 PictureStyles_ReflectedBevelBlack_15529 PictureStyles_ReflectedBevelWhite_15530 PictureStyles_MetalRoundedRectangle_15531 PictureStyles_MetalOval_15532".split(" ");
this.p8j="PictureCrop_ShapeAlternateProcess_126 PictureCrop_ShapeArc_84 PictureCrop_ShapeBentArrow_28 PictureCrop_ShapeBentUpArrow_31 PictureCrop_ShapeBevel_74 PictureCrop_ShapeBlockArc_77 PictureCrop_ShapeCan_7 PictureCrop_ShapeCard_139 PictureCrop_ShapeChevron_38 PictureCrop_ShapeChord_66 PictureCrop_ShapeCircularArrow_45 PictureCrop_ShapeCloud_83 PictureCrop_ShapeCloudCallout_93 PictureCrop_ShapeCollate_143 PictureCrop_ShapeConnector_137 PictureCrop_ShapeCross_72 PictureCrop_ShapeCube_8 PictureCrop_ShapeCurvedArrowConnector_153 PictureCrop_ShapeCurvedConnector_25 PictureCrop_ShapeCurvedDoubleArrowConnector_154 PictureCrop_ShapeCurvedDownArrow_46 PictureCrop_ShapeCurvedDownRibbon_120 PictureCrop_ShapeCurvedLeftArrow_33 PictureCrop_ShapeCurvedRightArrow_32 PictureCrop_ShapeCurvedUpArrow_34 PictureCrop_ShapeCurvedUpRibbon_119 PictureCrop_ShapeData_128 PictureCrop_ShapeDecagon_63 PictureCrop_ShapeDecision_127 PictureCrop_ShapeDelay_148 PictureCrop_ShapeDiagonalStripe_71 PictureCrop_ShapeDiamond_58 PictureCrop_ShapeDirectAccessStorage_151 PictureCrop_ShapeDisplay_152 PictureCrop_ShapeDocument_131 PictureCrop_ShapeDodecagon_64 PictureCrop_ShapeDonut_75 PictureCrop_ShapeDoubleBrace_86 PictureCrop_ShapeDoubleBracket_85 PictureCrop_ShapeDoubleWave_124 PictureCrop_ShapeDownArrow_0 PictureCrop_ShapeDownArrowCallout_40 PictureCrop_ShapeDownRibbon_118 PictureCrop_ShapeElbowArrowConnector_155 PictureCrop_ShapeElbowConnector_26 PictureCrop_ShapeElbowDoubleArrowConnector_156 PictureCrop_ShapeEllipse_9 PictureCrop_ShapeExplosion1_106 PictureCrop_ShapeExplosion2_107 PictureCrop_ShapeExtract_145 PictureCrop_ShapeFoldedCorner_78 PictureCrop_ShapeFrame_68 PictureCrop_ShapeGallery PictureCrop_ShapeHalfFrame_69 PictureCrop_ShapeHeart_18 PictureCrop_ShapeHeptagon_61 PictureCrop_ShapeHexagon_60 PictureCrop_ShapeHorizontalScroll_122 PictureCrop_ShapeInternalStorage_130 PictureCrop_ShapeLeftArrow_1 PictureCrop_ShapeLeftArrowCallout_41 PictureCrop_ShapeLeftBrace_89 PictureCrop_ShapeLeftBracket_87 PictureCrop_ShapeLeftRightArrow_2 PictureCrop_ShapeLeftRightArrowCallout_43 PictureCrop_ShapeLeftRightUpArrow_27 PictureCrop_ShapeLeftUpArrow_30 PictureCrop_ShapeLightningBolt_80 PictureCrop_ShapeLineCallout1_94 PictureCrop_ShapeLShape_70 PictureCrop_ShapeMagneticDisk_150 PictureCrop_ShapeManualInput_135 PictureCrop_ShapeManualOperation_136 PictureCrop_ShapeMathDivide_22 PictureCrop_ShapeMathEqual_23 PictureCrop_ShapeMathMinus_20 PictureCrop_ShapeMathMultiply_21 PictureCrop_ShapeMathNotEqual_24 PictureCrop_ShapeMathPlus_19 PictureCrop_ShapeMerge_146 PictureCrop_ShapeMoon_82 PictureCrop_ShapeMultidocument_132 PictureCrop_ShapeNoSymbol_76 PictureCrop_ShapeNotchedRightArrow_36 PictureCrop_ShapeOctagon_62 PictureCrop_ShapeOffpageConnector_138 PictureCrop_ShapeOr_142 PictureCrop_ShapeOvalCallout_92 PictureCrop_ShapeParallelogram_56 PictureCrop_ShapePentagon_37 PictureCrop_ShapePie_65 PictureCrop_ShapePlaque_73 PictureCrop_ShapePredefinedProcess_129 PictureCrop_ShapePreparation_134 PictureCrop_ShapeProcess_125 PictureCrop_ShapePunchedTape_140 PictureCrop_ShapeQuadArrow_47 PictureCrop_ShapeQuadArrowCallout_44 PictureCrop_ShapeRectangle_10 PictureCrop_ShapeRectangularCallout_91 PictureCrop_ShapeRightArrow_3 PictureCrop_ShapeRightArrowCallout_39 PictureCrop_ShapeRightBrace_90 PictureCrop_ShapeRightBracket_88 PictureCrop_ShapeRightTriangle_55 PictureCrop_ShapeRoundDiagonalCornerRectangle_48 PictureCrop_ShapeRoundedRectangle_11 PictureCrop_ShapeRoundedRectangleCallout_6 PictureCrop_ShapeRoundSameSideCornerRectangle_49 PictureCrop_ShapeRoundSingleCornerRectangle_50 PictureCrop_ShapeSequentialActionStorage PictureCrop_ShapeSequentialActionStorage_149 PictureCrop_ShapeSmileyFace_79 PictureCrop_ShapeSnipDiagonalCornerRectangle_52 PictureCrop_ShapeSnipRoundSingleCornerRectangle_51 PictureCrop_ShapeSnipSameSideCornerRectangle_53 PictureCrop_ShapeSnipSingleCornerRectangle_54 PictureCrop_ShapeSort_144 PictureCrop_ShapeSPentagon_59 PictureCrop_ShapeStar10_112 PictureCrop_ShapeStar12_113 PictureCrop_ShapeStar16_114 PictureCrop_ShapeStar24_115 PictureCrop_ShapeStar32_116 PictureCrop_ShapeStar4_108 PictureCrop_ShapeStar5_15 PictureCrop_ShapeStar6_109 PictureCrop_ShapeStar7_110 PictureCrop_ShapeStar8_111 PictureCrop_ShapeStoredData_147 PictureCrop_ShapeStraightConnector_12 PictureCrop_ShapeStraightConnectorArrow_13 PictureCrop_ShapeStraightConnectorTwoArrow_14 PictureCrop_ShapeStripedRightArrow_35 PictureCrop_ShapeSummingJunction_141 PictureCrop_ShapeSun_81 PictureCrop_ShapeTeardrop_67 PictureCrop_ShapeTerminator_133 PictureCrop_ShapeTrapezoid_57 PictureCrop_ShapeTriangle_17 PictureCrop_ShapeUpArrow_4 PictureCrop_ShapeUpArrowCallout_42 PictureCrop_ShapeUpDownArrow_5 PictureCrop_ShapeUpRibbon_117 PictureCrop_ShapeUTurnArrow_29 PictureCrop_ShapeVerticalScroll_121 PictureCrop_ShapeWave_123".split(" ");
this.p3j=["FormatBackgroundStandardColorsFromCanvas","FormatBackgroundThemeColorsFromCanvas","FormatBackgroundThemeColorsMCUFromCanvas"];this.q3j=["FormatBackgroundStandardColorsFromThumbnailPane","FormatBackgroundThemeColorsFromThumbnailPane","FormatBackgroundThemeColorsMCUFromThumbnailPane"];this.DRg="SmartArtLayouts__orgChart1__hierarchy SmartArtLayouts__hList1__list SmartArtLayouts__vList2__list SmartArtLayouts__hierarchy1__hierarchy SmartArtLayouts__chevron2__process SmartArtLayouts__process3__process SmartArtLayouts__hProcess4__process SmartArtLayouts__process5__process SmartArtLayouts__default__list SmartArtLayouts__chevron1__process SmartArtLayouts__cycle2__cycle SmartArtLayouts__process1__process SmartArtLayouts__pyramid1__pyramid SmartArtLayouts__hProcess11__process SmartArtLayouts__cycle5__cycle SmartArtLayouts__lProcess3__process SmartArtLayouts__bProcess2__process SmartArtLayouts__hChevron3__process SmartArtLayouts__hProcess3__process SmartArtLayouts__hProcess9__process SmartArtLayouts__cycle3__cycle SmartArtLayouts__arrow5__relationship SmartArtLayouts__hProcess7__process SmartArtLayouts__arrow1__relationship SmartArtLayouts__equation1__relationship SmartArtLayouts__lProcess2__list SmartArtLayouts__hierarchy3__hierarchy SmartArtLayouts__hierarchy2__hierarchy SmartArtLayouts__hierarchy5__hierarchy SmartArtLayouts__pyramid3__pyramid SmartArtLayouts__hierarchy6__hierarchy SmartArtLayouts__venn3__relationship SmartArtLayouts__cycle7__cycle SmartArtLayouts__cycle6__cycle SmartArtLayouts__hProcess6__process SmartArtLayouts__lProcess1__process SmartArtLayouts__pyramid2__pyramid SmartArtLayouts__radial2__relationship SmartArtLayouts__bProcess3__process SmartArtLayouts__process4__process SmartArtLayouts__hList9__list SmartArtLayouts__hierarchy4__hierarchy SmartArtLayouts__hList3__list SmartArtLayouts__cycle1__cycle SmartArtLayouts__hList6__list SmartArtLayouts__arrow2__process SmartArtLayouts__vList6__process SmartArtLayouts__bProcess4__process SmartArtLayouts__list1__list SmartArtLayouts__equation2__relationship SmartArtLayouts__process2__process SmartArtLayouts__BasicTimeline__timeline SmartArtLayouts__HexagonTimeline__timeline SmartArtLayouts__RoundedRectangleTimeline__timeline SmartArtLayouts__DropPinTimeline__timeline SmartArtLayouts__HorizontalLabelsTimeline__timeline SmartArtLayouts__HorizontalPathTimeline__timeline SmartArtLayouts__AccentHomeChevronProcess__timeline".split(" ");
this.la=a;this.vHd();this.j1h();this.T0h();this.S0h();this.W0h();this.Z0h();this.a1h();this.i1h();this.b1h();this.Y0h();this.V0h();this.f1h();this.c1h();this.d1h();this.h1h();this.fId();this.Y1h();this.g1h();this.g2h();this.Q0h();this.X0h();this.U0h();this.R0h();this.$0h();this.e1h()}g2h(){this.addIconToMap("CheckMark_20","per_QuickSearchCompletedToday_16x16x32");this.addIconToMap("Info_20","per_Info_16x16x32")}vHd(){this.addCommandToMaps(new Ta.a("AddSection","2203490252"));this.addCommandToMaps(new Ta.a("AlternativeText",
"3296909722"));this.addCommandToMaps(new Ta.a("AlignAnchor","3320425830"));this.addCommandToMaps(Object.assign(new Ta.a("AlwaysUseSubtitles","1906012838"),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:"3244674241"}));this.addCommandToMaps(new Ta.a("ArrangeAnchor","200712034"));this.addCommandToMaps(Object.assign(new Ta.a("AudioSettings","2346722376"),{queryCommandId:"1234363616"}));this.addCommandToMaps(new Ta.a("LivePollTaskPane","3902591294"));this.addCommandToMaps(new Ta.a("ArrangeShapeAnchor",
"200712034"));this.addCommandToMaps(new Ta.a("BeginEditShapeText","3618312345"));this.addCommandToMaps(Object.assign(new Ta.a("Bold","2913964"),{queryCommandId:"2523547740"}));this.addCommandToMaps(Object.assign(new Ta.a("BottomOverlaid","348484772"),{legacyControlId:"PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",queryCommandId:"1824785548"}));this.addCommandToMaps(new Ta.a("BringToFrontFlyout","4230958419"));this.addCommandToMaps(new Ta.a("BringForward","3270113035"));this.addCommandToMaps(new Ta.a("BringToFront",
"2814941514"));this.addCommandToMaps(Object.assign(new Ta.a("BulletLibrary","3627016479"),{legacyControlId:"PptRibbon.Home.Paragraph.BulletGallery",queryCommandId:"2324278473",populationProps:new Ng("1142350707",!1)}));this.addCommandToMaps(Object.assign(new Ta.a("CatchUpWithChanges","3418267371"),{legacyControlId:"CatchUpWithChanges",queryCommandId:"1059068017"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangeCaseCapitalizeEachWord","1880533947"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Capitalization"}));
this.addCommandToMaps(Object.assign(new Ta.a("ChangeCaseLower","768894625"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Lower"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangeCaseMenuEnabled","3679012070"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangeCaseSentence","2981608035"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.SentenceCase"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangeCaseToggle","3502060538"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.ToggleCase"}));
this.addCommandToMaps(Object.assign(new Ta.a("ChangeCaseUpper","4291024442"),{legacyControlId:"PptRibbon.Home.Font.ChangeCase.Upper"}));this.addCommandToMaps(new Ta.a("ChangeLayout","4017322732"));this.addCommandToMaps(Object.assign(new Ta.a("ChangeGraphicContextMenu","1373490814"),{legacyControlId:"PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangeGraphicFlyout","1373490814"),{legacyControlId:"PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"}));
this.addCommandToMaps(Object.assign(new Ta.a("ChangePicture","2958402736"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.ChangePicture"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureContextMenu","3244031780"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureContextMenuBing","3565639685"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureContextMenuM365",
"148018230"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureContextMenuIcons","1332899609"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureContextMenuDevice","2958402736"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureContextMenuOneDrive",
"2057552935"),{legacyControlId:"PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost",queryCommandId:"3612507612"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureContextMenuMobileDevice","1101801264"),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureFlyout","3244031780"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureFlyoutBing","3565639685"),
{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureFlyoutM365","148018230"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureFlyoutIcons","1332899609"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureFlyoutDevice","2958402736"),
{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureFlyoutOneDrive","2057552935"),{legacyControlId:"PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost",queryCommandId:"3612507612"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangePictureFlyoutMobileDevice","1101801264"),{legacyControlId:"ChangePictureFromMobileDevice"}));this.addCommandToMaps(Object.assign(new Ta.a("ChangeSmartArtColorAnchor","396312034"),
{populationProps:new Ng("3273638293",!1)}));this.addCommandToMaps(new Ta.a("CheckAccessibility","2295549531"));this.addCommandToMaps(Object.assign(new Ta.a("ClearFormatting","2319895756"),{legacyControlId:"PptRibbon.Home.Font.ClearFormatting"}));this.addCommandToMaps(new Ta.a("ClearTableFormatting","3835123874"));this.addCommandToMaps(Object.assign(new Ta.a("CommentsPane","1991203991"),{queryCommandId:"3845423030"}));this.addCommandToMaps(new Ta.a("CopyHyperlink","3037606367"));this.addCommandToMaps(Object.assign(new Ta.a("ContextMenu",
"1451516907"),{populationProps:new Ng("2071563036",!1)}));this.addCommandToMaps(Object.assign(new Ta.a("SelectionPane","654924585"),{queryCommandId:"2763753566"}));this.addCommandToMaps(Object.assign(new Ta.a("RenderFooterPane","1278690195"),{queryCommandId:"2945242850"}));this.addCommandToMaps(new Ta.a("InsertSlideNumber","150011355"));this.addCommandToMaps(Object.assign(new Ta.a("RenderSelectionPane","654924585"),{queryCommandId:"2763753566"}));this.addCommandToMaps(Object.assign(new Ta.a("CommentsShowMarkUp",
"410757179"),{queryCommandId:"992822777"}));this.addCommandToMaps(Object.assign(new Ta.a("CommentsShowAdvancedMarkUp","1016800201"),{queryCommandId:"775043447"}));this.addCommandToMaps(new Ta.a("Copy","49968134"));this.addCommandToMaps(new Ta.a("CopyInVersionHistory","2758158609"));this.addCommandToMaps(new Ta.a("ClickVersionHistoryRestore","2138207060"));this.addCommandToMaps(new Ta.a("ClickVersionHistorySaveACopy","2623258827"));this.addCommandToMaps(new Ta.a("ClickVersionHistoryDownloadVersion",
"1316171850"));this.addCommandToMaps(new Ta.a("Cut","158451065"));this.addCommandToMaps(new Ta.a("Delete","1680865470"));this.addCommandToMaps(new Ta.a("DeleteAllCommentsInPresentation","1737510757"));this.addCommandToMaps(new Ta.a("DeleteAllCommentsInSlide","469473574"));this.addCommandToMaps(new Ta.a("DeleteAllResolvedComments","2766426586"));this.addCommandToMaps(Object.assign(new Ta.a("DeleteComment","869210402"),{queryCommandId:"2614767758"}));this.addCommandToMaps(new Ta.a("DeleteRepeatedWord",
"2023591105"));this.addCommandToMaps(new Ta.a("DeleteSlide","1235090158"));this.addCommandToMaps(Object.assign(new Ta.a("DesignerHome","3070664289"),{legacyControlId:"PptRibbon.Home.ShowHide.Designer",queryCommandId:"562763405"}));this.addCommandToMaps(Object.assign(new Ta.a("DesignerNew","4250022162"),{legacyControlId:"PptRibbon.Design.ShowHide.Designer.New",queryCommandId:"562763405"}));this.addCommandToMaps(Object.assign(new Ta.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",
populationProps:new Ng("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Ta.a("DocChat","2288458806"),{legacyControlId:"DocChat",queryCommandId:"1478537812"}));this.addCommandToMaps(new Ta.a("DoNotCheckThisCritiqueType","2157977488"));this.addCommandToMaps(new Ta.a("Duplicate","486800848"));this.addCommandToMaps(new Ta.a("DuplicateSlide","3006547192"));this.addCommandToMaps(new Ta.a("EditHyperlink","2711544537"));this.addCommandToMaps(Object.assign(new Ta.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));
this.addCommandToMaps(Object.assign(new Ta.a("EditInAppWithIcon","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Ta.a("EditorPane","97211136"),{legacyControlId:"PptRibbon.Review.Proofing.EditorPane",queryCommandId:"974334176"}));this.addCommandToMaps(Object.assign(new Ta.a("EditorPaneSplitButton","97211136"),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButton",queryCommandId:"2161272628"}));this.la.zYf&&this.addCommandToMaps(Object.assign(new Ta.a("DexLitePane",
ba.a.xjd.toString()),{queryCommandId:ba.a.rcd.toString()}));this.addCommandToMaps(new Ta.a("Find","1891435765"));this.addCommandToMaps(new Ta.a("FitToWindow","2470172091"));this.addCommandToMaps(Object.assign(new Ta.a("FixIt","3100655080"),{legacyControlId:"FixIt",queryCommandId:"1559931984"}));this.addCommandToMaps(Object.assign(new Ta.a("FontColor","3314514081"),{populationProps:new Ng("3238769791",!1)}));this.addCommandToMaps(Object.assign(new Ta.a("FontPicker","3430668515"),{legacyControlId:"fontPicker",
queryCommandId:"3287122076",populationProps:new Ng("1965039802",!0)}));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Ta.a("FontName","3145621451"),{queryCommandId:"1052225825",populationProps:new Ng("2923358157",!1),commandPreviewId:"539266573",commandRevertId:"1026923615"})),this.addCommandToMaps(Object.assign(new Ta.a("FontSize","2016320825"),{queryCommandId:"3075296939",commandPreviewId:"4169085911",commandRevertId:"200151849"}))):(this.addCommandToMaps(Object.assign(new Ta.a("FontName",
"3145621451"),{queryCommandId:"1052225825",populationProps:new Ng("2923358157",!1)})),this.addCommandToMaps(Object.assign(new Ta.a("FontSize","2016320825"),{queryCommandId:"3075296939"})));this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundApplyToAll","2080761994"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundPicture","2640793597"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundSolidFill","3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new Ng("3004618427",!1)}));this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundStandardColors","3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundThemeColors","3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));
this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundThemeColorsMCU","3049223287"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(new Ta.a("FormatBackgroundRecentColors","1912773268"));this.addCommandToMaps(Object.assign(new Ta.a("FormatPainter","3794362040"),{queryCommandId:"3309569663"}));this.addCommandToMaps(Object.assign(new Ta.a("HideProofingErrors","3041519999"),{legacyControlId:"PptRibbon.Review.Proofing.HideProofingErrors",queryCommandId:"3699667717"}));
this.addCommandToMaps(Object.assign(new Ta.a("GiveFeedback","2918242107"),{legacyControlId:"btnFeedback"}));this.addCommandToMaps(Object.assign(new Ta.a("GrammarOptions","3380187414"),{legacyControlId:"PptRibbon.Review.Proofing.GrammarOptions"}));this.addCommandToMaps(Object.assign(new Ta.a("ProofingOptions","3380187414"),{legacyControlId:"PptRibbon.Review.Proofing.ProofingSplitButtonFallback"}));this.addCommandToMaps(Object.assign(new Ta.a("Grow","3444541960"),{legacyControlId:"PptRibbon.Home.Font.Grow"}));
this.addCommandToMaps(Object.assign(new Ta.a("HideSlide","3945504187"),{queryCommandId:"3032837727"}));this.la.F6d&&this.addCommandToMaps(new Ta.a("UnhideSlide","1774836750"));this.addCommandToMaps(Object.assign(new Ta.a("Highlight","2904102419"),{legacyControlId:"PptRibbon.Home.Font.FontBackgroundColor"}));this.addCommandToMaps(new Ta.a("HighlighterColor","1784019754"));this.addCommandToMaps(new Ta.a("IgnoreSpellingError","3549510372"));this.addCommandToMaps(new Ta.a("Indent","1288324077"));this.addCommandToMaps(new Ta.a("InsertAddIns",
"2300394269"));this.addCommandToMaps(new Ta.a("InsertAddInsFromBackstage","2300394269"));this.addCommandToMaps(new Ta.a("InsertComment","1221260928"));this.addCommandToMaps(Object.assign(new Ta.a("InsertIcons","3143141002"),{legacyControlId:"InsertIconDialog"}));this.addCommandToMaps(new Ta.a("InsertLink","2711544537"));this.addCommandToMaps(new Ta.a("InsertSocialMediaVideo","1182875165"));this.addCommandToMaps(new Ta.a("InsertPicturesFlyoutDalle","4268462963"));this.addCommandToMaps(new Ta.a("InsertPicturesDalle",
"2421869509"));this.addCommandToMaps(new Ta.a("InsertLiveFeed","791426823"));this.addCommandToMaps(Object.assign(new Ta.a("InsertOnlineVideo","2948423841"),{legacyControlId:"PptRibbon.InsertTab.Media.OnlineVideo"}));this.la.mSc&&this.addCommandToMaps(new Ta.a("InsertVideoFromDevice",ba.a.tIb.toString()));this.addCommandToMaps(Object.assign(new Ta.a("InsertPicturesFlyout","4210426229"),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertPicturesFlyoutBing",
"1685987254"),{legacyControlId:"PptRibbon.InsertTab.Images.FlyPicture.FromSearch"}));var a;this.addCommandToMaps((a=new Ta.a("InsertPicturesFlyoutM365","2691408781"),a.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",a));let b;this.addCommandToMaps((b=new Ta.a("InsertPicturesM365","2582565347"),b.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture",b));let c;this.addCommandToMaps((c=new Ta.a("InsertPicturesFlyoutDevice","1403967063"),c.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromDevice",
c));let f;this.addCommandToMaps((f=new Ta.a("InsertPicturesFlyoutOneDrive","720118144"),f.legacyControlId="PptRibbon.InsertTab.Images.FlyPicture.FromHost",f.queryCommandId="3612507612",f));let l;this.addCommandToMaps((l=new Ta.a("InsertPicturesFlyoutMobileDevice","509870209"),l.legacyControlId="InsertPictureFromMobileDevice",l));this.addCommandToMaps(new Ta.a("InsertSlides","2325171983"));let x;this.addCommandToMaps((x=new Ta.a("NewSlideSplit","82992945"),x.populationProps=new Ng("82992945",!1),x));
let G;this.addCommandToMaps((G=new Ta.a("InsertSlideSplit","82992945"),G.populationProps=new Ng("82992945",!1),G));this.addCommandToMaps(new Ta.a("NewDefaultSlide","3455582195"));let R;this.addCommandToMaps((R=new Ta.a("ChangeLayoutFlyout","3827850816"),R.populationProps=new Ng("3827850816",!1),R));this.addCommandToMaps(new Ta.a("InsertTextBox","621502440"));this.addCommandToMaps(new Ta.a("InsertAudio","1970478872"));let fa;this.addCommandToMaps((fa=new Ta.a("InsertFooterFlyout","3104125356"),fa.legacyControlId=
"PptRibbon.InsertTab.FooterFlyout",fa));let wa;this.addCommandToMaps((wa=new Ta.a("InsertSymbol","3471878106"),wa.populationProps=new Ng("1256496096",!0),wa));this.addCommandToMaps(new Ta.a("InsertTable","975293073"));this.addCommandToMaps(new Ta.a("InvokeFilesSerplet","2670256092"));let Wa;this.addCommandToMaps((Wa=new Ta.a("Italic","2465268493"),Wa.queryCommandId="1611154215",Wa));this.addCommandToMaps(new Ta.a("LeftToRight","3104595117"));let mb;this.addCommandToMaps((mb=new Ta.a("LineSpacing",
"2060090051"),mb.legacyControlId="PptRibbon.Home.Paragraph.LineSpacing",mb.populationProps=new Ng("1834449059",!1),mb));let Kb;this.addCommandToMaps((Kb=new Ta.a("LineSpacingButton1_00","2116781230"),Kb.queryCommandId="35350118",Kb.menuItemId="1.00",Kb));let nc;this.addCommandToMaps((nc=new Ta.a("LineSpacingButton1_50","2116781230"),nc.queryCommandId="35350118",nc.menuItemId="1.50",nc));let oc;this.addCommandToMaps((oc=new Ta.a("LineSpacingButton2_00","2116781230"),oc.queryCommandId="35350118",oc.menuItemId=
"2.00",oc));let Ic;this.addCommandToMaps((Ic=new Ta.a("LineSpacingButton2_50","2116781230"),Ic.queryCommandId="35350118",Ic.menuItemId="2.50",Ic));let Kc;this.addCommandToMaps((Kc=new Ta.a("LineSpacingButton3_00","2116781230"),Kc.queryCommandId="35350118",Kc.menuItemId="3.00",Kc));this.addCommandToMaps(new Ta.a("LineSpacingOptionsForParagraphDialog","2465215107"));this.addCommandToMaps(new Ta.a("MarkActivitiesAsRead","4050369966"));let Hc;this.addCommandToMaps((Hc=new Ta.a("ModeSwitcherEditing","3913721881"),
Hc.queryCommandId="1628548419",Hc.legacyControlId="ModeSwitcherModeEditing",Hc));let ie;this.addCommandToMaps((ie=new Ta.a("ModeSwitcherViewing","1819007276"),ie.queryCommandId="805191912",ie.legacyControlId="ModeSwitcherModeViewing",ie));this.addCommandToMaps(new Ta.a("ModeSwitcher","951953502"));this.addCommandToMaps(new Ta.a("MoreSymbols","3574218963"));let He;this.addCommandToMaps((He=new Ta.a("MoreVariantsAnchor","2759977169"),He.queryCommandId="1425701611",He.populationProps=new Ng("1296027845",
!1),He.previewControlIds=["Variant1","Variant2","Variant3","Variant4"],He));this.addCommandToMaps(new Ta.a("MoveSectionDown","28073490"));this.addCommandToMaps(new Ta.a("MoveSectionUp","1653897933"));let fe;this.addCommandToMaps((fe=new Ta.a("NewComment","1221260928"),fe.queryCommandId="3603834084",fe));this.addCommandToMaps(new Ta.a("NewSlide","2325171983"));this.addCommandToMaps(new Ta.a("NewSlideWithoutDialog","3455582195"));let Te;this.addCommandToMaps((Te=new Ta.a("NextComment","1216077466"),
Te.queryCommandId="960339554",Te));this.addCommandToMaps(new Ta.a("NoHighlight","562361573"));let We;this.addCommandToMaps((We=new Ta.a("Notes","3113372712"),We.queryCommandId="850829913",We));let Qf;this.addCommandToMaps((Qf=new Ta.a("NumberingLibrary","1839018819"),Qf.legacyControlId="PptRibbon.Home.Paragraph.NumberedGallery",Qf.queryCommandId="3839110149",Qf.populationProps=new Ng("579378886",!1),Qf));this.addCommandToMaps(new Ta.a("OpenHyperlink","2898648224"));this.addCommandToMaps(new Ta.a("OpenPowerPointLanguageDialog",
"3274206189"));let mg;this.addCommandToMaps((mg=new Ta.a("OpenSetSlideSizeDialog","2541495854"),mg.queryCommandId="3939319117",mg));this.addCommandToMaps(new Ta.a("OpenVersionHistory","3828599598"));this.addCommandToMaps(new Ta.a("Outdent","3770030225"));this.addCommandToMaps(new Ta.a("ParagraphOptions","2465215107"));this.addCommandToMaps(new Ta.a("Paste","3642315978"));this.addCommandToMaps(new Ta.a("PasteGalleryIcon","3642315978"));this.addCommandToMaps(new Ta.a("PasteKeepingDestinationTheme",
"4207422373"));this.addCommandToMaps(new Ta.a("PasteKeepingSourceFormatting","2529825506"));let Xg;this.addCommandToMaps((Xg=new Ta.a("PasteTextOnlyGalleryIcon","2061487721"),Xg.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",Xg));this.addCommandToMaps(new Ta.a("PasteAsImage","1302928870"));let Mg;this.addCommandToMaps((Mg=new Ta.a("PasteSlideKeepDestinationFromClipService","771058974"),Mg.queryCommandId="565176158",Mg));let Sf;this.addCommandToMaps((Sf=new Ta.a("PasteSlideKeepSourceFromClipService",
"756680259"),Sf.queryCommandId="565176158",Sf));let uh;this.addCommandToMaps((uh=new Ta.a("PasteTextOnly","2061487721"),uh.legacyControlId="PptRibbon.Home.Clipboard.NewPaste",uh));this.addCommandToMaps(new Ta.a("PlayFromBeginning","3477644587"));this.addCommandToMaps(new Ta.a("PlayFromBeginningTopBar","4039328901"));this.addCommandToMaps(new Ta.a("PlayFromCurrentSlide","1989200744"));let Sg;this.addCommandToMaps((Sg=new Ta.a("PresentLive","1637880125"),Sg.legacyControlId="PresentLive",Sg));let li;
this.addCommandToMaps((li=new Ta.a("PresentLiveTopBar","1865567899"),li.legacyControlId="PresentLiveTopBar",li));let Ui;this.addCommandToMaps((Ui=new Ta.a("PresentLiveSetAccessControlAnyone","946150894"),Ui.legacyControlId="PresentLiveSetAccessControlAnyone",Ui.queryCommandId="677830988",Ui));let Cj;this.addCommandToMaps((Cj=new Ta.a("PresentLiveSetAccessControlOrganization","2341101003"),Cj.legacyControlId="PresentLiveSetAccessControlOrganization",Cj.queryCommandId="289063903",Cj));let jj;this.addCommandToMaps((jj=
new Ta.a("PresentLiveConsumer","1637880125"),jj.legacyControlId="PresentLiveConsumer",jj));let kj;this.addCommandToMaps((kj=new Ta.a("PresentLiveEnterprise","1637880125"),kj.legacyControlId="PresentLiveEnterprise",kj));let Gi;this.addCommandToMaps((Gi=new Ta.a("PresentToTeams","455397214"),Gi.legacyControlId="PresentToTeams",Gi));let yk;this.addCommandToMaps((yk=new Ta.a("PresentToTeamsTopBar","3640090982"),yk.legacyControlId="PresentToTeamsTopBar",yk));let Dj;this.addCommandToMaps((Dj=new Ta.a("PreviousComment",
"3774691014"),Dj.queryCommandId="1093530254",Dj));this.addCommandToMaps(new Ta.a("ReadingView","3849298593"));let ok;this.addCommandToMaps((ok=new Ta.a("PictureCrop","1517579890"),ok.queryCommandId="3115882543",ok));this.addCommandToMaps(new Ta.a("PictureCropAnchor","3997897477"));let Fl;this.addCommandToMaps((Fl=new Ta.a("PictureCropMoreOptions","1751580504"),Fl.queryCommandId="2750148704",Fl));this.addCommandToMaps(new Ta.a("Redo","4096109295"));let Xk;this.addCommandToMaps((Xk=new Ta.a("RehearsalFeedbackSettings",
"4006743010"),Xk.legacyControlId="PptRibbon.View.Coach.Menu.FeedbackSettings",Xk.queryCommandId="4191121318",Xk));let Gl;this.addCommandToMaps((Gl=new Ta.a("RehearsePresentation","1256345977"),Gl.legacyControlId="PptRibbon.View.Coach.RehearseWithCoach",Gl));let ak;this.addCommandToMaps((ak=new Ta.a("RehearsePresentationTopBar","4242063947"),ak.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachTopBar",ak));let Sj;this.addCommandToMaps((Sj=new Ta.a("RehearsePresentationDropDown","2954393506"),
Sj.legacyControlId="PptRibbon.View.Coach.RehearseWithCoachSplit",Sj));this.addCommandToMaps(new Ta.a("RemoveHyperlink","3041840712"));this.addCommandToMaps(new Ta.a("RemoveSection","3170937055"));this.addCommandToMaps(new Ta.a("RenameSection","2116436229"));this.addCommandToMaps(new Ta.a("Replace","3610473921"));this.addCommandToMaps(new Ta.a("ResetPicture","2916220093"));this.addCommandToMaps(new Ta.a("ResetPictureAndSize","196543355"));this.addCommandToMaps(new Ta.a("ResetPictureSplitButton","539331929"));
this.addCommandToMaps(new Ta.a("RightToLeft","3544607309"));this.addCommandToMaps(new Ta.a("RotateAnchor","508548220"));this.addCommandToMaps(new Ta.a("RotateShapeAnchor","1974731707"));let bk;this.addCommandToMaps((bk=new Ta.a("RotateLeft","3198368600"),bk.commandPreviewId="3069929632",bk.commandRevertId="2958393181",bk));let Gk;this.addCommandToMaps((Gk=new Ta.a("RotateRight","4074498273"),Gk.commandPreviewId="1789937815",Gk.commandRevertId="2958393181",Gk));this.addCommandToMaps(new Ta.a("RotateFlipVertical",
"2497743792"));this.addCommandToMaps(new Ta.a("RotateFlipHorizontal","2421665126"));this.addCommandToMaps(new Ta.a("SelectHyperlink","942179484"));this.addCommandToMaps(new Ta.a("SendBackward","565697619"));this.addCommandToMaps(new Ta.a("SendToBack","3409991090"));this.addCommandToMaps(new Ta.a("SendToBackFlyout","380857685"));this.la.zob?(this.addCommandToMaps(Object.assign(new Ta.a("SetAnimationDelay","3045176093"),{queryCommandId:"2849750569"})),this.addCommandToMaps(Object.assign(new Ta.a("SetAnimationDuration",
"2191769768"),{queryCommandId:"4125447704"})),this.addCommandToMaps(Object.assign(new Ta.a("AnimationStart","3585107924"),{queryCommandId:"3233073992"})),a=new Ta.a("AnimationPane","2041032783"),a.queryCommandId="3793934102",this.addCommandToMaps(a),this.addCommandToMaps(new Ta.a("MoveEarlier","3615610783")),this.addCommandToMaps(new Ta.a("MoveLater","1197800677"))):(this.addCommandToMaps(new Ta.a("MoveEarlier","3807076847")),this.addCommandToMaps(new Ta.a("MoveLater","1987590765")));let Nj;this.addCommandToMaps((Nj=
new Ta.a("SetHeight","2298348760"),Nj.queryCommandId="1846108968",Nj));let vh;this.addCommandToMaps((vh=new Ta.a("SetWidth","3074609079"),vh.queryCommandId="2155304935",vh));let Yk;this.addCommandToMaps((Yk=new Ta.a("SetSlideSize","410316994"),Yk.legacyControlId="PptRibbon.Design.Customize.SetSlideSizeAnchor",Yk));let Ul;this.addCommandToMaps((Ul=new Ta.a("SetSlideSize4x3","991302939"),Ul.queryCommandId="117694331",Ul));let sm;this.addCommandToMaps((sm=new Ta.a("SetSlideSize16x9","1045213174"),sm.queryCommandId=
"3694235222",sm));let zk;this.addCommandToMaps((zk=new Ta.a("SetTransitionApplyAll","36898206"),zk.queryCommandId="1981682194",zk));this.addCommandToMaps(Object.assign(new Ta.a("SetTransitionDuration","2632939091"),{queryCommandId:"1116601283"}));this.addCommandToMaps(new Ta.a("ShapeAlignAnchor","3459695103"));this.addCommandToMaps(new Ta.a("ShapeAlignLeft","3305017221"));this.addCommandToMaps(new Ta.a("ShapeAlignRight","1461684922"));this.addCommandToMaps(new Ta.a("ShapeAlignTop","4227848161"));
this.addCommandToMaps(new Ta.a("ShapeAlignBottom","3217780865"));this.addCommandToMaps(new Ta.a("ShapeAlignCenter","716806441"));this.addCommandToMaps(new Ta.a("ShapeAlignMiddle","3185305339"));this.addCommandToMaps(Object.assign(new Ta.a("ShapeAlignToSlide","3006728226"),{queryCommandId:"3837288634"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeAlignToSelectedObjects","96121440"),{queryCommandId:"4251588920"}));this.addCommandToMaps(new Ta.a("ShareSlide","4016340186"));this.addCommandToMaps(new Ta.a("DistributeShapesVertically",
"56689666"));this.addCommandToMaps(Object.assign(new Ta.a("ImmersiveReader","1676602274"),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(Object.assign(new Ta.a("ImmersiveReaderRibbon","4161584078"),{legacyControlId:"fseaImmersiveReader"}));this.addCommandToMaps(new Ta.a("DistributeShapesHorizontally","1208810892"));this.addCommandToMaps(new Ta.a("ShareSlide","4016340186"));this.addCommandToMaps(Object.assign(new Ta.a("Shrink","3739304922"),{legacyControlId:"PptRibbon.Home.Font.Shrink"}));
this.addCommandToMaps(Object.assign(new Ta.a("ShowCommentsTopBar","2281051331"),{legacyControlId:"ShowCommentsTopBar",queryCommandId:"847427893"}));this.addCommandToMaps(Object.assign(new Ta.a("ShowComments","1991203991"),{queryCommandId:"3845423030"}));this.addCommandToMaps(Object.assign(new Ta.a("ShowEditTriPaneView","12696731"),{queryCommandId:"363623614"}));this.addCommandToMaps(Object.assign(new Ta.a("ShowHideChanges","3927853644"),{queryCommandId:"3387413100"}));let pk;this.addCommandToMaps((pk=
new Ta.a("ShowHideComments","1991203991"),pk.legacyControlId="PptRibbon.View.ShowHide.CommentsSplitButton",pk.queryCommandId="3845423030",pk));let mi;this.addCommandToMaps((mi=new Ta.a("ShowHideCommentsInReview","1991203991"),mi.queryCommandId="3845423030",mi));let wg;this.addCommandToMaps((wg=new Ta.a("ShowHideRuler","2898025271"),wg.legacyControlId="btnShowHideRuler",wg.queryCommandId="2852668822",wg));this.addCommandToMaps(new Ta.a("ShowRevisionTrackingWithUrlOverrides","3206663165"));let ni;this.addCommandToMaps((ni=
new Ta.a("ShowMarkup","410757179"),ni.queryCommandId="992822777",ni));let cg;this.addCommandToMaps((cg=new Ta.a("ShowTranslatePane","119484543"),cg.legacyControlId="PptRibbon.Review.Show.Translate",cg));let Gd;this.addCommandToMaps((Gd=new Ta.a("ShowSmartLookupPane","4195071443"),Gd.legacyControlId="PptRibbon.Review.Show.SmartLookup",Gd));this.addCommandToMaps(new Ta.a("SmartLookupContextMenu","2861781337"));this.addCommandToMaps(new Ta.a("SmartLookupSynonyms","720345883"));let Ce;this.addCommandToMaps((Ce=
new Ta.a("ShowSorterView","1659792175"),Ce.queryCommandId="2246678568",Ce));let Hf;this.addCommandToMaps((Hf=new Ta.a("ShowVersionHistoryDialog","466976539"),Hf.legacyControlId="PptJewel.Info.VersionHistory",Hf));let je;this.addCommandToMaps((je=new Ta.a("SpokenLanguage","1014932740"),je.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage",je.queryCommandId="1014932740",je.populationProps=new Ng("1014932740",!0),je));this.addCommandToMaps(new Ta.a("StandardFontColorPicker",
"3314514081"));let Fg;this.addCommandToMaps((Fg=new Ta.a("Strikethrough","1470251202"),Fg.legacyControlId="PptRibbon.Home.Font.Strikethrough",Fg.queryCommandId="1885033626",Fg));let $h;this.addCommandToMaps(($h=new Ta.a("SubtitleLanguage","3756604230"),$h.legacyControlId="PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage",$h.queryCommandId="3756604230",$h.populationProps=new Ng("3756604230",!0),$h));let Hi;this.addCommandToMaps((Hi=new Ta.a("SubtitleSettingsAnchor","2442582554"),Hi.legacyControlId=
"PptRibbon.View.Subtitles.SubtitleSettings",Hi));let Xo;this.addCommandToMaps((Xo=new Ta.a("Subscript","2764952028"),Xo.legacyControlId="PptRibbon.Home.Font.Subscript",Xo.queryCommandId="1002244424",Xo));let fk;this.addCommandToMaps((fk=new Ta.a("Superscript","3148114157"),fk.legacyControlId="PptRibbon.Home.Font.Superscript",fk.queryCommandId="2241670795",fk));this.addCommandToMaps(new Ta.a("TabSwitch","3190032724"));this.addCommandToMaps(new Ta.a("TextAlignmentAnchor","2988805339"));let Wo;this.addCommandToMaps((Wo=
new Ta.a("TextAlignmentCenterJustify","33632174"),Wo.queryCommandId="2252885982",Wo));let us;this.addCommandToMaps((us=new Ta.a("TextAlignmentFullJustify","1344066782"),us.legacyControlId="PptRibbon.Home.Paragraph.FullJustify",us.queryCommandId="2466914778",us));let Mt;this.addCommandToMaps((Mt=new Ta.a("TextAlignmentLeftJustify","1845468918"),Mt.queryCommandId="712471458",Mt));let Nt;this.addCommandToMaps((Nt=new Ta.a("TextAlignmentRightJustify","3813372745"),Nt.queryCommandId="3610192823",Nt));
let Ot;this.addCommandToMaps((Ot=new Ta.a("TextAnchoringBottom","4124180856"),Ot.queryCommandId="4231771752",Ot));let Pt;this.addCommandToMaps((Pt=new Ta.a("TextAnchoringMiddle","1377620466"),Pt.queryCommandId="967867926",Pt));let Qt;this.addCommandToMaps((Qt=new Ta.a("TextAnchoringTop","3318339922"),Qt.queryCommandId="1945464878",Qt));this.addCommandToMaps(new Ta.a("ThemeFontColorPicker","3314514081"));this.addCommandToMaps(new Ta.a("ThemeFontColorPickerMCU","3314514081"));let vs;this.addCommandToMaps((vs=
new Ta.a("TopOverlaid","3728831786"),vs.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",vs.queryCommandId="87234146",vs));let Rt;this.addCommandToMaps((Rt=new Ta.a("Underline","704785013"),Rt.queryCommandId="451272227",Rt));this.addCommandToMaps(new Ta.a("Undo","2066390191"));let $A;this.addCommandToMaps(($A=new Ta.a("UsePresenterView","1082097282"),$A.queryCommandId="2289226602",$A));this.addCommandToMaps(new Ta.a("Zoom","3864281841"));let Cy;this.addCommandToMaps((Cy=new Ta.a("ToggleUseSubtitles",
"1906012838"),Cy.legacyControlId="PptRibbon.View.Subtitles.UseSubtitles",Cy.queryCommandId="3244674241",Cy));let aB;this.addCommandToMaps((aB=new Ta.a("ToggleShapeAlignToSlide","3006728226"),aB.queryCommandId="3837288634",aB));let bB;this.addCommandToMaps((bB=new Ta.a("ToggleShapeAlignToSelectedObjects","96121440"),bB.queryCommandId="4251588920",bB));let Dy;this.addCommandToMaps((Dy=new Ta.a("ToggleSubtitlesBottomOverlay","348484772"),Dy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay",
Dy.queryCommandId="1824785548",Dy));let Ey;this.addCommandToMaps((Ey=new Ta.a("ToggleSubtitlesTopOverlay","3728831786"),Ey.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay",Ey.queryCommandId="87234146",Ey));let Fy;this.addCommandToMaps((Fy=new Ta.a("ToggleRehearsalVisionEnabled","2400267914"),Fy.legacyControlId="PptRibbon.View.Coach.Menu.Vision",Fy.queryCommandId="2360689666",Fy));let cB;this.addCommandToMaps((cB=new Ta.a("HostOpenInClient","3588168074"),cB.legacyControlId="HostOpenInClient",
cB));let Gy;this.addCommandToMaps((Gy=new Ta.a("ToggleSubtitlesBelowSlide","3783536693"),Gy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",Gy.queryCommandId="793233593",Gy));let Hy;this.addCommandToMaps((Hy=new Ta.a("ToggleSubtitlesAboveSlide","3886090397"),Hy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",Hy.queryCommandId="3771385025",Hy));let Iy;this.addCommandToMaps((Iy=new Ta.a("BelowSlide","3783536693"),Iy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide",
Iy.queryCommandId="793233593",Iy));let Jy;this.addCommandToMaps((Jy=new Ta.a("AboveSlide","3886090397"),Jy.legacyControlId="PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide",Jy.queryCommandId="3771385025",Jy));let dB;this.addCommandToMaps((dB=new Ta.a("PreviousVersions","3681556347"),dB.legacyControlId="PptJewel.Info.FileVersion",dB));this.addCommandToMaps(new Ta.a("Present","149770451"));this.addCommandToMaps(new Ta.a("PresentDropDown","2832668252"))}$0h(){this.addCommandToMaps(Object.assign(new Ta.a("CenterJustify",
"33632174"),{queryCommandId:"2252885982"}));this.addCommandToMaps(Object.assign(new Ta.a("FullJustify","1344066782"),{queryCommandId:"2466914778"}));this.addCommandToMaps(Object.assign(new Ta.a("LeftJustify","1845468918"),{queryCommandId:"712471458"}));this.addCommandToMaps(Object.assign(new Ta.a("RightJustify","3813372745"),{queryCommandId:"3610192823"}));this.addCommandToMaps(Object.assign(new Ta.a("TextAnchoringAnchor","4088099806"),{queryCommandId:"4088099806"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignBottom",
"4124180856"),{queryCommandId:"4231771752"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignMiddle","1377620466"),{queryCommandId:"967867926"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTop","3318339922"),{queryCommandId:"1945464878"}));this.addCommandToMaps(Object.assign(new Ta.a("UseSubtitles","1906012838"),{legacyControlId:"AlwaysUseSubtitles",queryCommandId:"3244674241"}));this.addCommandToMaps(Object.assign(new Ta.a("SubtitleSettings","2442582554"),{legacyControlId:"PptRibbon.View.Subtitles.SubtitleSettings"}));
this.addCommandToMaps(new Ta.a("NewBringForwardAnchorMLR","200712034"));this.addCommandToMaps(new Ta.a("NewSendBackwardAnchorMLR","200712034"));this.addCommandToMaps(new Ta.a("PowerPointGroupFlyoutAnchorMLR","3206512596"));this.addCommandToMaps(Object.assign(new Ta.a("SetLockAspectRatio","3110635152"),{queryCommandId:"393974196"}));this.addCommandToMaps(Object.assign(new Ta.a("SetTableHeight","2276581567"),{queryCommandId:"2124999663"}));this.addCommandToMaps(Object.assign(new Ta.a("SetTableWidth",
"1330950330"),{queryCommandId:"1194765274"}));this.addCommandToMaps(Object.assign(new Ta.a("SetTableColumnWidth","673579960"),{queryCommandId:"480435988"}));this.addCommandToMaps(Object.assign(new Ta.a("SetTableRowHeight","1676474821"),{queryCommandId:"2851222057"}));this.addCommandToMaps(Object.assign(new Ta.a("UpdatePictureCropWidth","3859579721"),{queryCommandId:"2405860646"}));this.addCommandToMaps(Object.assign(new Ta.a("UpdatePictureCropHeight","2435251774"),{queryCommandId:"520230123"}));this.addCommandToMaps(Object.assign(new Ta.a("UpdatePictureCropLeft",
"436396424"),{queryCommandId:"1395081307"}));this.addCommandToMaps(Object.assign(new Ta.a("UpdatePictureCropTop","1511741212"),{queryCommandId:"4078650667"}));this.addCommandToMaps(Object.assign(new Ta.a("Paste_MLR","3642315978"),{queryCommandId:"616071690"}));this.addCommandToMaps(new Ta.a("PasteKeepingDestinationThemeMLR","4207422373"));this.addCommandToMaps(new Ta.a("PasteKeepingSourceFormattingMLR","2529825506"));this.addCommandToMaps(new Ta.a("PasteAsImageMLR","1302928870"));this.addCommandToMaps(Object.assign(new Ta.a("TableCellBottomAnchoringMLR",
"4124180856"),{queryCommandId:"4231771752"}));this.addCommandToMaps(Object.assign(new Ta.a("TableCellCenterJustifyMLR","33632174"),{queryCommandId:"2252885982"}));this.addCommandToMaps(Object.assign(new Ta.a("TableCellLeftJustifyMLR","1845468918"),{queryCommandId:"712471458"}));this.addCommandToMaps(Object.assign(new Ta.a("TableCellMiddleAnchoringMLR","1377620466"),{queryCommandId:"967867926"}));this.addCommandToMaps(Object.assign(new Ta.a("TableCellRightJustifyMLR","3813372745"),{queryCommandId:"3610192823"}));
this.addCommandToMaps(Object.assign(new Ta.a("TableCellTopAnchoringMLR","3318339922"),{queryCommandId:"1945464878"}));this.addCommandToMaps(new Ta.a("ParagraphOptionsMLR","2465215107"));this.addCommandToMaps(new Ta.a("Delete_MLR","1680865470"));this.addCommandToMaps(new Ta.a("SmartArtStylesMLR","3002291327"));this.addCommandToMaps(new Ta.a("PictureCropMLR","1775519606"))}fId(){this.addTabToMap("FormatShape","107954394");this.addTabToMap("FormatPicture","4025007766");this.addTabToMap("SmartArtDesign",
"405308450");this.addTabToMap("Table","4018640415");this.addTabToMap("Graphics","1515418926");this.addTabToMap("Playback","2572738953");this.addTabToMap("AudioFormat","1107276369");this.addTabToMap("Audio","3778566220");this.addTabToMap("AccessibleAuthoring","906344264")}g1h(){this.addCommandToMaps(Object.assign(new Ta.a("PptJewelDownloadACopyAsOdp","1249692773"),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsOdp"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelDownloadACopyAsPdf",
"2439343378"),{legacyControlId:"PptJewel.DownloadAs.DownloadACopyAsPdf"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelDownloadACopy","3555692408"),{legacyControlId:"PptJewel.DownloadAs.DownloadACopy"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelDownloadAsImages","1191538800"),{legacyControlId:"PptJewel.DownloadAs.DownloadAsImages"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelNew","1784018444"),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelOpen",
"1784018444"),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Ta.a("New","1784018444"),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Ta.a("Open","1784018444"),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelPrintFullSlide","1588554917"),{legacyControlId:"PptJewel.Print.PrintFullSlide"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelPrintHandouts","2255327903"),{legacyControlId:"PptJewel.Print.PrintHandouts"}));
this.addCommandToMaps(Object.assign(new Ta.a("PptJewelPrintNotes","277798930"),{legacyControlId:"PptJewel.Print.PrintNotes"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelPrintToPdf","1588554917"),{legacyControlId:"PptJewel.Print.PrintToPdf"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelRename","2382951455"),{legacyControlId:"PptJewel.Rename.RenameDialog"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelSaveACopy","1924572812"),{legacyControlId:"PptJewel.SaveACopy.SaveACopy"}));
this.addCommandToMaps(Object.assign(new Ta.a("PptJewelSaveAsToHost","3098027807"),{legacyControlId:"PptJewel.SaveACopy.SaveAsToHost"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelSaveToSharePoint","3131236268"),{legacyControlId:"PptJewel.SaveACopy.SaveToSharePoint"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelTrustCenter","2583751502"),{legacyControlId:"PptJewel.About.TrustCenter"}));this.addCommandToMaps(Object.assign(new Ta.a("PptJewelVersionHistory","466976539"),{legacyControlId:"PptJewel.Info.VersionHistory"}));
this.addCommandToMaps(Object.assign(new Ta.a("PptJewelPreviousVersions","3681556347"),{legacyControlId:"PptJewel.Info.FileVersion"}))}c1h(){this.addCommandToMaps(Object.assign(new Ta.a("ApplyShapeStyleAnchor","3720025301"),{populationProps:new Ng("3882730173",!1)}));this.addCommandToMaps(Object.assign(new Ta.a("ApplyShapeStylePreviewGallery","1963674920"),{queryCommandId:"2375118752",populationProps:new Ng("3882730173",!1),previewControlIds:"ApplyShapeStyle0 ApplyShapeStyle1 ApplyShapeStyle2 ApplyShapeStyle3 ApplyShapeStyle4 ApplyShapeStyle5 ApplyShapeStyle6".split(" ")}));
this.addCommandToMaps(Object.assign(new Ta.a("ApplyGraphicsStyleAnchor","1151870219"),{populationProps:new Ng("4014445414",!1)}));this.addCommandToMaps(new Ta.a("FontRecentColors","1298905754"));this.addCommandToMaps(Object.assign(new Ta.a("GraphicsStylePreviewGallery","2748140308"),{queryCommandId:"1903137544",populationProps:new Ng("4014445414",!1),previewControlIds:"ApplyGraphicsStyle0 ApplyGraphicsStyle1 ApplyGraphicsStyle2 ApplyGraphicsStyle3 ApplyGraphicsStyle4 ApplyGraphicsStyle5 ApplyGraphicsStyle6".split(" ")}));
this.addCommandToMaps(Object.assign(new Ta.a("GraphicsFill","3761243910"),{populationProps:new Ng("2646172177",!1)}));this.addCommandToMaps(new Ta.a("GraphicNoFill","3260600091"));this.addCommandToMaps(new Ta.a("GraphicNoOutline","730443428"));this.addCommandToMaps(Object.assign(new Ta.a("GraphicsOutline","546881287"),{populationProps:new Ng("3094707506",!1)}));this.addCommandToMaps(new Ta.a("MoreFillColors","1532790410"));this.addCommandToMaps(new Ta.a("MoreFontColors","862825906"));this.addCommandToMaps(new Ta.a("MoreFormatBackgroundColors",
"3938657252"));this.addCommandToMaps(new Ta.a("MoreOutlineColors","3472910327"));this.addCommandToMaps(Object.assign(new Ta.a("ShowHideFormatShapePane","3440753649"),{queryCommandId:"1038885196"}));this.addCommandToMaps(Object.assign(new Ta.a("MoreRotationOptions","3440753649"),{queryCommandId:"1038885196"}));this.addCommandToMaps(Object.assign(new Ta.a("PictureBorders","2359362870"),{populationProps:new Ng("3094707506",!1)}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeFill","2501194553"),
{populationProps:new Ng("2646172177",!1),commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeFillRecentColors","3745557472"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(new Ta.a("ShapeNoFill","2667121814"));this.addCommandToMaps(new Ta.a("ShapeNoOutline","1732643493"));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutline","2359362870"),{populationProps:new Ng("3094707506",!1)}));this.addCommandToMaps(new Ta.a("ShapeOutlineRecentColors",
"1244537109"));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineDashStyle_1","4208988856"),{menuItemId:"ShapeOutlineDashStyle,1"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineDashStyle_2","4208988856"),{menuItemId:"ShapeOutlineDashStyle,2"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineDashStyle_4","4208988856"),{menuItemId:"ShapeOutlineDashStyle,4"}));this.addCommandToMaps(new Ta.a("ShapeOutlineDashStyleAnchor","1735838055"));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineSketchStyle_1",
"106876572"),{menuItemId:"ShapeOutlineSketchStyle,1"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineSketchStyle_2","106876572"),{menuItemId:"ShapeOutlineSketchStyle,2"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineSketchStyle_3","106876572"),{menuItemId:"ShapeOutlineSketchStyle,3"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineSketchStyle_4","106876572"),{menuItemId:"ShapeOutlineSketchStyle,4"}));this.addCommandToMaps(new Ta.a("ShapeOutlineSketchStyleAnchor",
"1427890675"));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineEndStyle_1","2315200227"),{menuItemId:"ShapeOutlineEndStyle,1"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineEndStyle_2","2315200227"),{menuItemId:"ShapeOutlineEndStyle,2"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineEndStyle_3","2315200227"),{menuItemId:"ShapeOutlineEndStyle,3"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineEndStyle_4","2315200227"),{menuItemId:"ShapeOutlineEndStyle,4"}));
this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineEndStyle_5","2315200227"),{menuItemId:"ShapeOutlineEndStyle,5"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineEndStyle_6","2315200227"),{menuItemId:"ShapeOutlineEndStyle,6"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineEndStyle_7","2315200227"),{menuItemId:"ShapeOutlineEndStyle,7"}));this.addCommandToMaps(new Ta.a("ShapeOutlineEndStyleAnchor","819989304"));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineWidth_1",
"774557385"),{menuItemId:"ShapeOutlineWidth,1"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineWidth_2","774557385"),{menuItemId:"ShapeOutlineWidth,2"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineWidth_3","774557385"),{menuItemId:"ShapeOutlineWidth,3"}));this.addCommandToMaps(Object.assign(new Ta.a("ShapeOutlineWidth_4","774557385"),{menuItemId:"ShapeOutlineWidth,4"}));this.addCommandToMaps(new Ta.a("ShapeOutlineWidthAnchor","94872576"));this.addCommandToMaps(new Ta.a("StandardGraphicFillColorPicker",
"3761243910"));this.addCommandToMaps(new Ta.a("StandardGraphicOutlineColorPicker","546881287"));this.addCommandToMaps(Object.assign(new Ta.a("StandardShapeFillColorPicker","2501194553"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(new Ta.a("StandardShapeOutlineColorPicker","2359362870"));this.addCommandToMaps(new Ta.a("ThemeGraphicFillColorPicker","3761243910"));this.addCommandToMaps(new Ta.a("ThemeGraphicFillColorPickerMCU","3761243910"));this.addCommandToMaps(new Ta.a("ThemeGraphicOutlineColorPicker",
"546881287"));this.addCommandToMaps(new Ta.a("ThemeGraphicOutlineColorPickerMCU","546881287"));this.addCommandToMaps(Object.assign(new Ta.a("ThemeShapeFillColorPickerMCU","2501194553"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemeShapeFillColorPicker","2501194553"),{commandPreviewId:"3187150127",commandRevertId:"4061576225"}));this.addCommandToMaps(new Ta.a("ThemeShapeOutlineColorPicker","2359362870"));this.addCommandToMaps(new Ta.a("ThemeShapeOutlineColorPickerMCU",
"2359362870"))}h1h(){this.addCommandToMaps(Object.assign(new Ta.a("Themes","2963456035"),{queryCommandId:"2203652940",previewControlIds:"ThemesOfficeTheme ThemesAtlas ThemesMadison ThemesIon ThemesOrganic ThemesFrame".split(" ")}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesOfficeTheme","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesAtlas","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesMadison",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesIon","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesOrganic","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesFrame","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesIonBoardroom","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesMesh",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesRetrospect","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesSlice","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesSavon","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesBanded","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesQuotable",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesWoodType","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesBasis","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesIntegral","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesWisp","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesDividend",
"2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesCelestial","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesParallax","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesMetropolitan","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesFacet","2963456035"),{queryCommandId:"2203652940"}));this.addCommandToMaps(Object.assign(new Ta.a("ThemesViewTheme",
"2963456035"),{queryCommandId:"2203652940"}))}j1h(){this.addCommandToMaps(Object.assign(new Ta.a("Transitions","2024601249"),{queryCommandId:"149145197",previewControlIds:"TransitionExisting TransitionNone TransitionMorph TransitionCut TransitionFade TransitionPush TransitionWipe".split(" ")}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionExisting","3752636652"),{legacyControlId:"TransitionExisting",queryCommandId:"3476251476"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionExistingInMenu",
"4036532528"),{legacyControlId:"TransitionExistingInMenu",queryCommandId:"2831233208"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionNone","2024601249"),{legacyControlId:"TransitionNone",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionMorph","2024601249"),{legacyControlId:"TransitionMorph",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionCut","2024601249"),{legacyControlId:"TransitionCut",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Ta.a("TransitionFade","2024601249"),{legacyControlId:"TransitionFade",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionPush","2024601249"),{legacyControlId:"TransitionPush",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionWipe","2024601249"),{legacyControlId:"TransitionWipe",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionSplit","2024601249"),{legacyControlId:"TransitionSplit",
queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionRandomBars","2024601249"),{legacyControlId:"TransitionRandomBars",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionShape","2024601249"),{legacyControlId:"TransitionShape",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionComb","2024601249"),{legacyControlId:"TransitionComb",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionBlinds",
"2024601249"),{legacyControlId:"TransitionBlinds",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionBox","2024601249"),{legacyControlId:"TransitionBox",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionCover","2024601249"),{legacyControlId:"TransitionCover",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionCube","2024601249"),{legacyControlId:"TransitionCube",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionCurtains",
"2024601249"),{legacyControlId:"TransitionCurtains",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionDissolve","2024601249"),{legacyControlId:"TransitionDissolve",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionOrbit","2024601249"),{legacyControlId:"TransitionOrbit",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionPageCurl","2024601249"),{legacyControlId:"TransitionPageCurl",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Ta.a("TransitionPeelOff","2024601249"),{legacyControlId:"TransitionPeelOff",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionRandom","2024601249"),{legacyControlId:"TransitionRandom",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionReveal","2024601249"),{legacyControlId:"TransitionReveal",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionRotate","2024601249"),
{legacyControlId:"TransitionRotate",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionUncover","2024601249"),{legacyControlId:"TransitionUncover",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionWheel","2024601249"),{legacyControlId:"TransitionWheel",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionRipple","2024601249"),{legacyControlId:"TransitionRipple",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionBox",
"2024601249"),{legacyControlId:"TransitionBox",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionCube","2024601249"),{legacyControlId:"TransitionCube",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionSwitch","2024601249"),{legacyControlId:"TransitionSwitch",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionFallOver","2024601249"),{legacyControlId:"TransitionFallOver",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Ta.a("TransitionDrape","2024601249"),{legacyControlId:"TransitionDrape",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionFlip","2024601249"),{legacyControlId:"TransitionFlip",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionWind","2024601249"),{legacyControlId:"TransitionWind",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionPrestige","2024601249"),
{legacyControlId:"TransitionPrestige",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionFracture","2024601249"),{legacyControlId:"TransitionFracture",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionCrush","2024601249"),{legacyControlId:"TransitionCrush",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionAirplane","2024601249"),{legacyControlId:"TransitionAirplane",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Ta.a("TransitionOrigami","2024601249"),{legacyControlId:"TransitionOrigami",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionChecker","2024601249"),{legacyControlId:"TransitionChecker",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionVortex","2024601249"),{legacyControlId:"TransitionVortex",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionGlitter",
"2024601249"),{legacyControlId:"TransitionGlitter",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionPan","2024601249"),{legacyControlId:"TransitionPan",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionGalleryIcon","2024601249"),{legacyControlId:"TransitionGalleryIcon",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionConveyor","2024601249"),{legacyControlId:"TransitionConveyor",queryCommandId:"149145197"}));
this.addCommandToMaps(Object.assign(new Ta.a("TransitionZoom","2024601249"),{legacyControlId:"TransitionZoom",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionFlyThrough","2024601249"),{legacyControlId:"TransitionFlyThrough",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionWindow","2024601249"),{legacyControlId:"TransitionWindow",queryCommandId:"149145197"}));this.addCommandToMaps(Object.assign(new Ta.a("TransitionDoors","2024601249"),
{legacyControlId:"TransitionDoors",queryCommandId:"149145197"}))}T0h(){this.addCommandToMaps(Object.assign(new Ta.a("Animations","2676673376"),{queryCommandId:"1852964326",previewControlIds:["AnimationExisting","AnimationNone","AnimationAppear","AnimationFadeIn","AnimationFlyIn"]}));this.addCommandToMaps(Object.assign(new Ta.a("AnimationExisting","298832323"),{queryCommandId:"1852964326"}));this.addCommandToMaps(Object.assign(new Ta.a("AnimationExistingInMenu","1264919631"),{queryCommandId:"1852964326"}));
for(const a of this.D0j)this.addCommandToMaps(Object.assign(new Ta.a(a,"2676673376"),{queryCommandId:"1852964326"}))}S0h(){this.addCommandToMaps(Object.assign(new Ta.a("AnimationEffectOptions","1880806010"),{populationProps:new Ng("4148576519",!1)}));for(const a of this.z0j)this.addCommandToMaps(Object.assign(new Ta.a(a,"2949363495"),{queryCommandId:"4132852551",menuItemId:a.slice(this.A0j)}));for(const a of this.B0j)this.addCommandToMaps(Object.assign(new Ta.a(a,"2289594085"),{queryCommandId:"3782857737",
menuItemId:a.slice(this.C0j)}));this.addCommandToMaps(new Ta.a("AnimationEffectOptionsThemeColorPickerMCU","679168237"));this.addCommandToMaps(new Ta.a("AnimationEffectOptionsThemeColorPicker","679168237"));this.addCommandToMaps(new Ta.a("AnimationEffectOptionsStandardColorPicker","679168237"));this.addCommandToMaps(Object.assign(new Ta.a("AnimationEffectOptionsSequenceAsOneObject","1850236812"),{queryCommandId:"1125291975",menuItemId:"AsOneObject"}));this.addCommandToMaps(Object.assign(new Ta.a("AnimationEffectOptionsSequenceAllAtOnce",
"2048458448"),{queryCommandId:"1125291975",menuItemId:"AllAtOnce"}));this.addCommandToMaps(Object.assign(new Ta.a("AnimationEffectOptionsSequenceByParagraph","3467781846"),{queryCommandId:"1125291975",menuItemId:"ByParagraph"}));this.addCommandToMaps(Object.assign(new Ta.a("AnimationEffectOptionsSequenceOneByOne","1486892994"),{queryCommandId:"1125291975",menuItemId:"OneByOne"}))}W0h(){this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundSolidFillFromCanvas","2710524593"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",
populationProps:new Ng("1073160204",!1)}));for(const a of this.p3j)this.addCommandToMaps(Object.assign(new Ta.a(a,"2710524593"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundSolidFillFromThumbnailPane","2624409683"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor",populationProps:new Ng("4086319974",!1)}));for(const a of this.q3j)this.addCommandToMaps(Object.assign(new Ta.a(a,"2624409683"),
{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundApplyToAllFromCanvas","797658758"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundApplyToAllFromThumbnailPane","317738424"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundPictureFromCanvas","1067172319"),
{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}));this.addCommandToMaps(Object.assign(new Ta.a("FormatBackgroundPictureFromThumbnailPane","713045573"),{legacyControlId:"PptRibbon.Design.Customize.FormatBackgroundAnchor"}))}i1h(){this.addCommandToMaps(Object.assign(new Ta.a("TransitionEffectOptions","317477235"),{populationProps:new Ng("1348655508",!1)}));for(const a of this.jbk)this.addCommandToMaps(Object.assign(new Ta.a(a,"961566706"),{queryCommandId:"3535869262",menuItemId:a.slice(this.kbk)}))}b1h(){this.addCommandToMaps(new Ta.a("PictureStyles",
"1158868185"));for(const a of this.r8j){const b=a.split("_")[2];this.addCommandToMaps(Object.assign(new Ta.a(a,"1158868185"),{queryCommandId:"1384172858",menuItemId:b}))}}d1h(){this.addCommandToMaps(new Ta.a("ChangeSmartArtLayoutAnchor","1203133001"));for(const a of this.DRg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Ta.a("Change"+a,"3290078594"),{queryCommandId:"1384172858",menuItemId:b[1]+","+b[2]}))}this.addCommandToMaps(Object.assign(new Ta.a("SmartArtEditText","2301457975"),
{queryCommandId:"2686363697"}));this.addCommandToMaps(new Ta.a("SmartArtDemote","4035125371"));this.addCommandToMaps(new Ta.a("SmartArtPromote","1313422623"));this.addCommandToMaps(new Ta.a("SmartArtResetGraphic","2099122511"));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtReverse","2753397958"),{queryCommandId:"2648853014"}));this.addCommandToMaps(new Ta.a("SmartArtStyles","3002291327"));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__simple1__simple","3002291327"),{queryCommandId:"1384172858",
menuItemId:"simple1,simple"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__simple2__simple","3002291327"),{queryCommandId:"1384172858",menuItemId:"simple2,simple"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__simple3__simple","3002291327"),{queryCommandId:"1384172858",menuItemId:"simple3,simple"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__simple4__simple","3002291327"),{queryCommandId:"1384172858",menuItemId:"simple4,simple"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__simple5__simple",
"3002291327"),{queryCommandId:"1384172858",menuItemId:"simple5,simple"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__3d1__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d1,3D"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__3d2__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d2,3D"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__3d3__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d3,3D"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__3d4__3D",
"3002291327"),{queryCommandId:"1384172858",menuItemId:"3d4,3D"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__3d5__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d5,3D"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__3d6__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d6,3D"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__3d7__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d7,3D"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__3d8__3D",
"3002291327"),{queryCommandId:"1384172858",menuItemId:"3d8,3D"}));this.addCommandToMaps(Object.assign(new Ta.a("SmartArtStyle__3d9__3D","3002291327"),{queryCommandId:"1384172858",menuItemId:"3d9,3D"}))}Z0h(){this.addCommandToMaps(new Ta.a("InsertSmartArtAnchor","3732507656"));for(const a of this.DRg){const b=a.split("__");this.addCommandToMaps(Object.assign(new Ta.a(a,"2734600169"),{queryCommandId:"1384172858",menuItemId:b[1]+","+b[2]}))}}a1h(){this.addCommandToMaps(new Ta.a("PictureCropToShapeAnchor",
"1658415763"));for(const a of this.p8j)this.addCommandToMaps(Object.assign(new Ta.a(a,"682334988"),{queryCommandId:"1384172858"}))}Y0h(){this.addCommandToMaps(new Ta.a("InsertShapesAll","650246100"));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStraightConnector","2523939501"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStraightConnectorArrow","1750723594"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStraightConnectorTwoArrow",
"3559452754"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeElbowConnector","1025603538"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeElbowArrowConnector","254882197"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeElbowDoubleArrowConnector","3675479226"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeCurvedConnector","3570382728"),
{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeCurvedArrowConnector","2475247497"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeCurvedDoubleArrowConnector","3609233104"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeRectangle","645832025"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeRoundedRectangle","2299510778"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeSnipSingleCornerRectangle","3474758074"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeSnipSameSideCornerRectangle","3850613247"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeSnipDiagonalCornerRectangle","2293630353"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeSnipRoundSingleCornerRectangle","3574790146"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeRoundSingleCornerRectangle","2164607454"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeRoundSameSideCornerRectangle","2967902753"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeRoundDiagonalCornerRectangle","93314647"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeTextBox","621502440"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeEllipse","2935469250"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeTriangle","1504176348"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeRightTriangle","2485319550"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeParallelogram","770491129"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeTrapezoid",
"3412378376"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeDiamond","3524776812"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeSPentagon","2830940407"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeHexagon","656392472"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeHeptagon","1899461382"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeOctagon",
"3089112743"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeDecagon","2150987117"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeDodecagon","21081030"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapePie","2034251078"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeChord","3297467250"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeTeardrop",
"2496477627"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeFrame","4089189445"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeHalfFrame","529510678"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeLShape","2250730235"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeDiagonalStripe","3980577126"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeCross",
"2988290636"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapePlaque","1062940640"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeCan","2289466566"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeCube","1564078521"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeBevel","1069783708"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeDonut",
"603375116"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeNoSymbol","2566066899"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeBlockArc","2964829157"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeFoldedCorner","3416217987"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeSmileyFace","3384731998"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeHeart","3360918184"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeLightningBolt","1658476285"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeSun","253099274"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeMoon","4091449115"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeCloud",
"3297467381"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeArc","3122886792"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeDoubleBracket","1269508949"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeDoubleBrace","3209338176"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeLeftBracket","961803587"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeRightBracket","2545917082"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeLeftBrace","2654567264"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeRightBrace","2181960791"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeRightArrow","3795105589"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeLeftArrow",
"1270568434"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeUpArrow","2638665078"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeDownArrow","671609167"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeLeftRightArrow","954768594"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeUpDownArrow","3735909846"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeQuadArrow","2763384452"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeLeftRightUpArrow","781992111"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeBentArrow","4266113576"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeUTurnArrow","3732223469"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeLeftUpArrow",
"3750115875"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeBentUpArrow","4033796289"),{queryCommandId:"1384172858"}));let a;this.addCommandToMaps((a=new Ta.a("InsertShapeCurvedRightArrow","3819554122"),a.queryCommandId="1384172858",a));let b;this.addCommandToMaps((b=new Ta.a("InsertShapeCurvedLeftArrow","4069343241"),b.queryCommandId="1384172858",b));let c;this.addCommandToMaps((c=new Ta.a("InsertShapeCurvedUpArrow","2185082291"),c.queryCommandId="1384172858",
c));let f;this.addCommandToMaps((f=new Ta.a("InsertShapeCurvedDownArrow","976313414"),f.queryCommandId="1384172858",f));let l;this.addCommandToMaps((l=new Ta.a("InsertShapeStripedRightArrow","1658124824"),l.queryCommandId="1384172858",l));let x;this.addCommandToMaps((x=new Ta.a("InsertShapeNotchedRightArrow","457802308"),x.queryCommandId="1384172858",x));let G;this.addCommandToMaps((G=new Ta.a("InsertShapePentagon","2602819900"),G.queryCommandId="1384172858",G));let R;this.addCommandToMaps((R=new Ta.a("InsertShapeChevron",
"287050691"),R.queryCommandId="1384172858",R));let fa;this.addCommandToMaps((fa=new Ta.a("InsertShapeRightArrowCallout","1246382169"),fa.queryCommandId="1384172858",fa));let wa;this.addCommandToMaps((wa=new Ta.a("InsertShapeDownArrowCallout","3010992915"),wa.queryCommandId="1384172858",wa));let Wa;this.addCommandToMaps((Wa=new Ta.a("InsertShapeLeftArrowCallout","1220509638"),Wa.queryCommandId="1384172858",Wa));let mb;this.addCommandToMaps((mb=new Ta.a("InsertShapeUpArrowCallout","287463130"),mb.queryCommandId=
"1384172858",mb));let Kb;this.addCommandToMaps((Kb=new Ta.a("InsertShapeLeftRightArrowCallout","2303744502"),Kb.queryCommandId="1384172858",Kb));let nc;this.addCommandToMaps((nc=new Ta.a("InsertShapeQuadArrowCallout","1929705096"),nc.queryCommandId="1384172858",nc));let oc;this.addCommandToMaps((oc=new Ta.a("InsertShapeCircularArrow","3229643138"),oc.queryCommandId="1384172858",oc));let Ic;this.addCommandToMaps((Ic=new Ta.a("InsertShapeMathPlus","3675536706"),Ic.queryCommandId="1384172858",Ic));let Kc;
this.addCommandToMaps((Kc=new Ta.a("InsertShapeMathMinus","4100001190"),Kc.queryCommandId="1384172858",Kc));let Hc;this.addCommandToMaps((Hc=new Ta.a("InsertShapeMathMultiply","2861422166"),Hc.queryCommandId="1384172858",Hc));let ie;this.addCommandToMaps((ie=new Ta.a("InsertShapeMathDivide","168064503"),ie.queryCommandId="1384172858",ie));let He;this.addCommandToMaps((He=new Ta.a("InsertShapeMathEqual","2402760486"),He.queryCommandId="1384172858",He));let fe;this.addCommandToMaps((fe=new Ta.a("InsertShapeMathNotEqual",
"4184383381"),fe.queryCommandId="1384172858",fe));let Te;this.addCommandToMaps((Te=new Ta.a("InsertShapeProcess","1040093007"),Te.queryCommandId="1384172858",Te));let We;this.addCommandToMaps((We=new Ta.a("InsertShapeAlternateProcess","2060186255"),We.queryCommandId="1384172858",We));let Qf;this.addCommandToMaps((Qf=new Ta.a("InsertShapeDecision","2994325646"),Qf.queryCommandId="1384172858",Qf));let mg;this.addCommandToMaps((mg=new Ta.a("InsertShapeData","3600704532"),mg.queryCommandId="1384172858",
mg));let Xg;this.addCommandToMaps((Xg=new Ta.a("InsertShapePredefinedProcess","1912938133"),Xg.queryCommandId="1384172858",Xg));let Mg;this.addCommandToMaps((Mg=new Ta.a("InsertShapeInternalStorage","3699646902"),Mg.queryCommandId="1384172858",Mg));let Sf;this.addCommandToMaps((Sf=new Ta.a("InsertShapeDocument","372614031"),Sf.queryCommandId="1384172858",Sf));let uh;this.addCommandToMaps((uh=new Ta.a("InsertShapeMultidocument","3076056292"),uh.queryCommandId="1384172858",uh));let Sg;this.addCommandToMaps((Sg=
new Ta.a("InsertShapeTerminator","3309718409"),Sg.queryCommandId="1384172858",Sg));let li;this.addCommandToMaps((li=new Ta.a("InsertShapePreparation","2972619841"),li.queryCommandId="1384172858",li));let Ui;this.addCommandToMaps((Ui=new Ta.a("InsertShapeManualInput","3307458778"),Ui.queryCommandId="1384172858",Ui));let Cj;this.addCommandToMaps((Cj=new Ta.a("InsertShapeManualOperation","3480100343"),Cj.queryCommandId="1384172858",Cj));let jj;this.addCommandToMaps((jj=new Ta.a("InsertShapeConnector",
"2767398707"),jj.queryCommandId="1384172858",jj));let kj;this.addCommandToMaps((kj=new Ta.a("InsertShapeOffpageConnector","245535631"),kj.queryCommandId="1384172858",kj));let Gi;this.addCommandToMaps((Gi=new Ta.a("InsertShapeCard","851618206"),Gi.queryCommandId="1384172858",Gi));let yk;this.addCommandToMaps((yk=new Ta.a("InsertShapePunchedTape","2805408817"),yk.queryCommandId="1384172858",yk));let Dj;this.addCommandToMaps((Dj=new Ta.a("InsertShapeSummingJunction","1742457506"),Dj.queryCommandId="1384172858",
Dj));let ok;this.addCommandToMaps((ok=new Ta.a("InsertShapeOr","3387115369"),ok.queryCommandId="1384172858",ok));let Fl;this.addCommandToMaps((Fl=new Ta.a("InsertShapeCollate","1523313274"),Fl.queryCommandId="1384172858",Fl));let Xk;this.addCommandToMaps((Xk=new Ta.a("InsertShapeSort","240172272"),Xk.queryCommandId="1384172858",Xk));let Gl;this.addCommandToMaps((Gl=new Ta.a("InsertShapeExtract","2871548753"),Gl.queryCommandId="1384172858",Gl));let ak;this.addCommandToMaps((ak=new Ta.a("InsertShapeMerge",
"331056848"),ak.queryCommandId="1384172858",ak));let Sj;this.addCommandToMaps((Sj=new Ta.a("InsertShapeStoredData","2965521551"),Sj.queryCommandId="1384172858",Sj));let bk;this.addCommandToMaps((bk=new Ta.a("InsertShapeDelay","3728895005"),bk.queryCommandId="1384172858",bk));let Gk;this.addCommandToMaps((Gk=new Ta.a("InsertShapeSequentialActionStorage","1187616446"),Gk.queryCommandId="1384172858",Gk));let Nj;this.addCommandToMaps((Nj=new Ta.a("InsertShapeMagneticDisk","2595473951"),Nj.queryCommandId=
"1384172858",Nj));let vh;this.addCommandToMaps((vh=new Ta.a("InsertShapeDirectAccessStorage","3522000044"),vh.queryCommandId="1384172858",vh));let Yk;this.addCommandToMaps((Yk=new Ta.a("InsertShapeDisplay","2830261794"),Yk.queryCommandId="1384172858",Yk));let Ul;this.addCommandToMaps((Ul=new Ta.a("InsertShapeExplosion1","609854846"),Ul.queryCommandId="1384172858",Ul));let sm;this.addCommandToMaps((sm=new Ta.a("InsertShapeExplosion2","609854843"),sm.queryCommandId="1384172858",sm));let zk;this.addCommandToMaps((zk=
new Ta.a("InsertShapeStar4","1751654576"),zk.queryCommandId="1384172858",zk));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStar5","3317738517"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStar6","588855162"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStar7","2154939103"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStar8","3721023044"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStar10","579353105"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStar12","579353107"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStar16","579353103"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStar24","2145437042"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeStar32",
"3711520989"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertShapeUpRibbon","3965372919"),{queryCommandId:"1384172858"}));let pk;this.addCommandToMaps((pk=new Ta.a("InsertShapeDownRibbon","1643393380"),pk.queryCommandId="1384172858",pk));let mi;this.addCommandToMaps((mi=new Ta.a("InsertShapeCurvedUpRibbon","1364669940"),mi.queryCommandId="1384172858",mi));let wg;this.addCommandToMaps((wg=new Ta.a("InsertShapeCurvedDownRibbon","1056258459"),wg.queryCommandId="1384172858",
wg));let ni;this.addCommandToMaps((ni=new Ta.a("InsertShapeVerticalScroll","1834894867"),ni.queryCommandId="1384172858",ni));let cg;this.addCommandToMaps((cg=new Ta.a("InsertShapeHorizontalScroll","2820192427"),cg.queryCommandId="1384172858",cg));let Gd;this.addCommandToMaps((Gd=new Ta.a("InsertShapeWave","3130421197"),Gd.queryCommandId="1384172858",Gd));let Ce;this.addCommandToMaps((Ce=new Ta.a("InsertShapeDoubleWave","3519851372"),Ce.queryCommandId="1384172858",Ce));let Hf;this.addCommandToMaps((Hf=
new Ta.a("InsertShapeRectangularCallout","1809100996"),Hf.queryCommandId="1384172858",Hf));let je;this.addCommandToMaps((je=new Ta.a("InsertShapeRoundedRectangleCallout","238089374"),je.queryCommandId="1384172858",je));let Fg;this.addCommandToMaps((Fg=new Ta.a("InsertShapeOvalCallout","4206313904"),Fg.queryCommandId="1384172858",Fg));let $h;this.addCommandToMaps(($h=new Ta.a("InsertShapeCloudCallout","1032389169"),$h.queryCommandId="1384172858",$h));let Hi;this.addCommandToMaps((Hi=new Ta.a("InsertShapeLineCallout1BorderAccent",
"3475705525"),Hi.queryCommandId="1384172858",Hi));let Xo;this.addCommandToMaps((Xo=new Ta.a("InsertShapeLineCallout2BorderAccent","1472318264"),Xo.queryCommandId="1384172858",Xo));let fk;this.addCommandToMaps((fk=new Ta.a("InsertShapeLineCallout3BorderAccent","1768130487"),fk.queryCommandId="1384172858",fk));let Wo;this.addCommandToMaps((Wo=new Ta.a("InsertShapeLineCallout1Accent","733785093"),Wo.queryCommandId="1384172858",Wo));let us;this.addCommandToMaps((us=new Ta.a("InsertShapeLineCallout2Accent",
"733609894"),us.queryCommandId="1384172858",us));let Mt;this.addCommandToMaps((Mt=new Ta.a("InsertShapeLineCallout3Accent","733857095"),Mt.queryCommandId="1384172858",Mt));let Nt;this.addCommandToMaps((Nt=new Ta.a("InsertShapeLineCallout1","1956296899"),Nt.queryCommandId="1384172858",Nt));let Ot;this.addCommandToMaps((Ot=new Ta.a("InsertShapeLineCallout2","1956296896"),Ot.queryCommandId="1384172858",Ot));let Pt;this.addCommandToMaps((Pt=new Ta.a("InsertShapeLineCallout3","1956296897"),Pt.queryCommandId=
"1384172858",Pt));let Qt;this.addCommandToMaps((Qt=new Ta.a("InsertShapeLineCallout1NoBorder","627424020"),Qt.queryCommandId="1384172858",Qt));let vs;this.addCommandToMaps((vs=new Ta.a("InsertShapeLineCallout2NoBorder","621637973"),vs.queryCommandId="1384172858",vs));let Rt;this.addCommandToMaps((Rt=new Ta.a("InsertShapeLineCallout3NoBorder","629787286"),Rt.queryCommandId="1384172858",Rt));this.addCommandToMaps(new Ta.a("InsertShapeTextBoxBig","621502440"))}V0h(){this.addCommandToMaps(Object.assign(new Ta.a(ke.V7,
"2131010772"),{queryCommandId:"2524310320"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.bC,"2959280052"),{queryCommandId:"2162608508"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.nF,"2959280049"),{queryCommandId:"2565893035"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.mF,"2032762671"),{queryCommandId:"103713021"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.Esa,"1898254474"),{queryCommandId:"958499386"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.y8a,"3738895990"),{queryCommandId:"1384172858"}));
this.addCommandToMaps(Object.assign(new Ta.a(ke.oja,"3738895993"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.tDa,"3738895992"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.pja,"657096778"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.qja,"2223180719"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.uDa,"3789264660"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.vDa,
"3496085635"),{queryCommandId:"1964687729"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.U7,"2964465598"),{queryCommandId:"2403188966"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.wDa,"893000638"),{queryCommandId:"2949649726"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.xDa,"186315452"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.yDa,"186315449"),{queryCommandId:"1384172858"}));this.addCommandToMaps(Object.assign(new Ta.a(ke.zDa,"186315450"),{queryCommandId:"1384172858"}))}f1h(){this.addCommandToMaps(Object.assign(new Ta.a("Select",
"1203133001"),{legacyControlId:"idTableSelect"}));this.addCommandToMaps(Object.assign(new Ta.a("SelectTable","2306914518"),{legacyControlId:"btnSelectTable"}));this.addCommandToMaps(Object.assign(new Ta.a("SelectColumn","2341852628"),{legacyControlId:"btnSelectColumn"}));this.addCommandToMaps(Object.assign(new Ta.a("SelectRow","3508003794"),{legacyControlId:"btnSelectRow"}));this.addCommandToMaps(Object.assign(new Ta.a("TableDelete","1203133001"),{legacyControlId:"idTableDelete"}));this.addCommandToMaps(Object.assign(new Ta.a("PowerPointDeleteTableColumn",
"2998998226"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Ta.a("PowerPointDeleteTableRow","3269723356"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Ta.a("DeleteTable","1819681963"),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertRowAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertRowBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));
this.addCommandToMaps(Object.assign(new Ta.a("InsertColumnLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertColumnRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));this.addCommandToMaps(new Ta.a("ApplyTableStyleOptionAnchor","1203133001"));this.addCommandToMaps(Object.assign(new Ta.a("ApplyTableStyleOptionHeaderRow","1583455318"),{legacyControlId:"buttonFirstRow",queryCommandId:"1762426222",menuItemId:"buttonFirstRow"}));
this.addCommandToMaps(Object.assign(new Ta.a("ApplyTableStyleOptionFirstColumn","1583455318"),{legacyControlId:"buttonFirstColumn",queryCommandId:"1762426222",menuItemId:"buttonFirstColumn"}));this.addCommandToMaps(Object.assign(new Ta.a("ApplyTableStyleOptionTotalRow","1583455318"),{legacyControlId:"buttonLastRow",queryCommandId:"1762426222",menuItemId:"buttonLastRow"}));this.addCommandToMaps(Object.assign(new Ta.a("ApplyTableStyleOptionLastColumn","1583455318"),{legacyControlId:"buttonLastColumn",
queryCommandId:"1762426222",menuItemId:"buttonLastColumn"}));this.addCommandToMaps(Object.assign(new Ta.a("ApplyTableStyleOptionBandedRows","1583455318"),{legacyControlId:"buttonBandedRow",queryCommandId:"1762426222",menuItemId:"buttonBandedRow"}));this.addCommandToMaps(Object.assign(new Ta.a("ApplyTableStyleOptionBandedColumns","1583455318"),{legacyControlId:"buttonBandedColumn",queryCommandId:"1762426222",menuItemId:"buttonBandedColumn"}));this.addCommandToMaps(Object.assign(new Ta.a("PowerPointCellShadingMenuOpen",
"3704601382"),{legacyControlId:"cellShadingColor",populationProps:new Ng("2450035180",!1),menuItemId:"cellShadingColor"}));this.addCommandToMaps(new Ta.a("StandardCellShadingColorPicker","3704601382"));this.addCommandToMaps(new Ta.a("ThemeCellShadingColorPicker","3704601382"));this.addCommandToMaps(new Ta.a("ThemeCellShadingColorPickerMCU","3704601382"));this.addCommandToMaps(new Ta.a("NoCellShading","2292419401"));this.addCommandToMaps(new Ta.a("CellShadingMoreColors","1736670660"));this.addCommandToMaps(new Ta.a("CellShadingRecentColors",
"4078162917"));this.addCommandToMaps(Object.assign(new Ta.a("SetSizeAnchor","3089059537"),{queryCommandId:"149527692"}));this.addCommandToMaps(Object.assign(new Ta.a("MergeTableCells","93109791"),{legacyControlId:"btnMergeTableCells"}));this.addCommandToMaps(Object.assign(new Ta.a("SplitTableCells","1112879997"),{legacyControlId:"btnSplitTableCells"}));this.addCommandToMaps(new Ta.a("TableAnchor","2806772911"));this.addCommandToMaps(Object.assign(new Ta.a("TableStyles","4171428777"),{legacyControlId:"fsfaMoreTableStyles",
queryCommandId:"2135594455",populationProps:new Ng("3359297384",!1),previewControlIds:"buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" ")}));this.addCommandToMaps(new Ta.a("TableAlignmentAnchor","3250360533"));this.addCommandToMaps(Object.assign(new Ta.a("TableCellBottomAnchoring","4124180856"),{legacyControlId:"btnTableCellBottomAnchoring",queryCommandId:"4231771752"}));
this.addCommandToMaps(Object.assign(new Ta.a("TableCellCenterJustify","33632174"),{legacyControlId:"btnTableCellCenterJustify",queryCommandId:"2252885982"}));this.addCommandToMaps(Object.assign(new Ta.a("TableCellLeftJustify","1845468918"),{legacyControlId:"btnTableCellLeftJustify",queryCommandId:"712471458"}));this.addCommandToMaps(Object.assign(new Ta.a("TableCellMiddleAnchoring","1377620466"),{legacyControlId:"btnTableCellMiddleAnchoring",queryCommandId:"967867926"}));this.addCommandToMaps(Object.assign(new Ta.a("TableCellRightJustify",
"3813372745"),{legacyControlId:"btnTableCellRightJustify",queryCommandId:"3610192823"}));this.addCommandToMaps(Object.assign(new Ta.a("TableCellTopAnchoring","3318339922"),{legacyControlId:"btnTableCellTopAnchoring",queryCommandId:"1945464878"}));this.addCommandToMaps(new Ta.a("TableAlternativeText","3296909722"));this.addCommandToMaps(new Ta.a("DistributeRows","791526052"));this.addCommandToMaps(new Ta.a("DistributeColumns","4255324272"));this.addCommandToMaps(new Ta.a("TableDistribute","1576337241"));
this.addCommandToMaps(Object.assign(new Ta.a("SetCellBorderColor","1742993766"),{populationProps:new Ng("3585221234",!1)}));this.addCommandToMaps(new Ta.a("CellBorderColorPickerMCU","71763897"));this.addCommandToMaps(new Ta.a("CellBorderColorPicker","71763897"));this.addCommandToMaps(new Ta.a("StandardCellBorderColorPicker","71763897"));this.addCommandToMaps(new Ta.a("CellBorderRecentColors","1124206375"));this.addCommandToMaps(new Ta.a("CellBorderMoreColors","1138519801"));this.addCommandToMaps(new Ta.a("TableBorderWidthAnchor",
"1025523929"));this.addCommandToMaps(Object.assign(new Ta.a("TableBorderWidth_1","1181009968"),{queryCommandId:"1928723436"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBorderWidth_2","1181009968"),{queryCommandId:"1928723435"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBorderWidth_3","1181009968"),{queryCommandId:"1928723434"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBorderWidth_4","1181009968"),{queryCommandId:"1928723441"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBorderWidth_5",
"1181009968"),{queryCommandId:"1928723440"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBorderWidth_6","1181009968"),{queryCommandId:"1928723439"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBorderWidth_7","1181009968"),{queryCommandId:"1928723438"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBorderWidth_8","1181009968"),{queryCommandId:"1928723429"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBorderWidth_9","1181009968"),{queryCommandId:"1928723428"}));this.addCommandToMaps(new Ta.a("TableBorderTypeAnchor",
"316937739"));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersNoBorder","920953916"),{queryCommandId:"2666589896"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersAllBorders","920953916"),{queryCommandId:"3505971410"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersOutsideBorders","920953916"),{queryCommandId:"259981150"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersInsideBorders","2426125916"),{queryCommandId:"1088761899"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersTopBorder",
"920953916"),{queryCommandId:"2150808318"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersBottomBorder","920953916"),{queryCommandId:"3072152572"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersLeftBorder","920953916"),{queryCommandId:"10301274"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersRightBorder","920953916"),{queryCommandId:"3005649147"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersInsideHorizontalBorder","2595242660"),{queryCommandId:"2049270673"}));
this.addCommandToMaps(Object.assign(new Ta.a("TableBordersInsideVerticalBorder","3890138642"),{queryCommandId:"4266964333"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersDiagonalUpBorder","920953916"),{queryCommandId:"4243465577"}));this.addCommandToMaps(Object.assign(new Ta.a("TableBordersDiagonalDownBorder","920953916"),{queryCommandId:"1969875420"}));this.addCommandToMaps(new Ta.a("TableCellMarginAnchor","3624082799"));this.addCommandToMaps(Object.assign(new Ta.a("ApplyTableCellMarginNormal",
"929276597"),{queryCommandId:"3122906487"}));this.addCommandToMaps(Object.assign(new Ta.a("ApplyTableCellMarginNone","570150258"),{queryCommandId:"2335710142"}));this.addCommandToMaps(Object.assign(new Ta.a("ApplyTableCellMarginNarrow","2448307869"),{queryCommandId:"1985856563"}));this.addCommandToMaps(Object.assign(new Ta.a("ApplyTableCellMarginWide","1262149989"),{queryCommandId:"2537223195"}));this.addCommandToMaps(Object.assign(new Ta.a("TableCellMarginCustom","3089059537"),{queryCommandId:"149527692"}))}Y1h(){this.Di(Object.assign(new hg("ContextualTabs.Tables.Design.Shading"),
{externalUxCommandIds:["PowerPointCellShadingMenuOpen"]}));this.Di(Object.assign(new hg("ContextualTabs.Tables.Design.TableStyleOptions"),{externalUxGroupId:"TableTableStyleOptions"}));this.Di(Object.assign(new hg("ContextualTabs.Tables.Design.TableStyles"),{externalUxGroupId:"TableStyles"}));this.Di(Object.assign(new hg("ContextualTabs.Tables.Layout.Alignment"),{externalUxGroupId:"Alignment"}));this.Di(Object.assign(new hg("ContextualTabs.Tables.Layout.CellSize"),{externalUxCommandIds:["SetSizeAnchor"]}));
this.Di(Object.assign(new hg("ContextualTabs.Tables.Layout.Properties"),{externalUxCommandIds:["AlternativeText"]}));this.Di(Object.assign(new hg("ContextualTabs.Tables.Layout.RowColumn"),{externalUxCommandIds:["TableDelete","InsertRowAbove","InsertRowBelow","InsertColumnLeft","InsertColumnRight"]}));this.Di(Object.assign(new hg("ContextualTabs.Tables.Layout.Table"),{externalUxCommandIds:["Select"]}));this.Di(Object.assign(new hg("ContextualTabs.Tables.Layout.TableSize"),{externalUxGroupId:"TableSize"}));
this.Di(Object.assign(new hg("PptRibbon.Animation.Gallery"),{externalUxGroupId:"AnimationGallery"}));this.Di(Object.assign(new hg("PptRibbon.Animation.Timing"),{externalUxGroupId:"Timing"}));this.Di(Object.assign(new hg("PptRibbon.Design.Customize"),{externalUxGroupId:"Customize"}));this.Di(Object.assign(new hg("PptRibbon.Design.Designer"),{externalUxGroupId:"Designer"}));this.Di(Object.assign(new hg("PptRibbon.Design.Designer.New"),{externalUxGroupId:"DesignerNew"}));this.Di(Object.assign(new hg("PptRibbon.Home.Designer"),
{externalUxGroupId:"DesignerHome"}));this.Di(Object.assign(new hg("PptRibbon.Home.Ideas"),{externalUxGroupId:"Ideas"}));this.Di(Object.assign(new hg("PptRibbon.Design.ThemeVariants"),{externalUxGroupId:"MoreVariants"}));this.Di(Object.assign(new hg("PptRibbon.DrawingFormat.InsertShapes"),{externalUxGroupId:"InsertShapes"}));this.Di(Object.assign(new hg("PptRibbon.DrawingFormat.ShapeStyles"),{externalUxGroupId:"ShapeStyles"}));this.Di(Object.assign(new hg("PptRibbon.Home.ClipboardCutEnabled"),{externalUxCommandIds:["Cut"]}));
this.Di(Object.assign(new hg("PptRibbon.Home.Delete"),{externalUxGroupId:"Delete"}));this.Di(Object.assign(new hg("PptRibbon.Home.Dictation"),{externalUxGroupId:"Dictation"}));this.Di(Object.assign(new hg("PptRibbon.Home.Drawing"),{externalUxGroupId:"Drawing"}));this.Di(Object.assign(new hg("PptRibbon.Home.Editing"),{externalUxGroupId:"Editing"}));this.Di(Object.assign(new hg("PptRibbon.Home.Font"),{externalUxGroupId:"Font"}));this.Di(Object.assign(new hg("PptRibbon.Home.Slides"),{externalUxGroupId:"Slides"}));
this.Di(Object.assign(new hg("PptRibbon.Home.UndoRedo"),{externalUxGroupId:"Undo"}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.AppForOffice"),{externalUxCommandIds:["InsertAddIns"]}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.Comments"),{externalUxCommandIds:["InsertComment"]}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.Illustrations"),{externalUxCommandIds:["InsertShapesAll","InsertIconDialog","InsertSmartArtAnchor"]}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.Images"),
{externalUxCommandIds:["Picture","OnlinePictures"]}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.InsertHyperlink"),{externalUxCommandIds:["InsertLink"]}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.InsertSlides"),{externalUxCommandIds:["InsertSlides"]}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.InsertTables"),{externalUxCommandIds:["TableAnchor"]}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.InvokeFilesSerplet"),{externalUxCommandIds:["InvokeFilesSerplet"]}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.Media"),
{externalUxCommandIds:["InsertOnlineVideo"]}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.Symbols"),{externalUxCommandIds:["InsertSymbol"]}));this.Di(Object.assign(new hg("PptRibbon.InsertTab.Text"),{externalUxCommandIds:["InsertTextBox"]}));this.Di(Object.assign(new hg("PptRibbon.PictureFormat.Adjust"),{externalUxGroupId:"Adjust"}));this.Di(Object.assign(new hg("PptRibbon.PictureFormat.Size"),{externalUxCommandIds:["PictureCropAnchor"]}));this.Di(Object.assign(new hg("PptRibbon.PictureFormat.Style"),
{externalUxGroupId:"PictureStyles"}));this.Di(Object.assign(new hg("PptRibbon.Review.Comments"),{externalUxGroupId:"Comments"}));this.Di(Object.assign(new hg("PptRibbon.Review.Inspect"),{externalUxGroupId:"Accessibility"}));this.Di(Object.assign(new hg("PptRibbon.Review.Translate "),{externalUxGroupId:"Translate"}));this.Di(Object.assign(new hg("PptRibbon.Review.Activity"),{externalUxGroupId:"Activity"}));this.Di(Object.assign(new hg("PptRibbon.SmartArt.CreateGraphic"),{externalUxGroupId:"SmartArtCreateGraphic"}));
this.Di(Object.assign(new hg("PptRibbon.SmartArt.Layouts"),{externalUxGroupId:"SmartArtLayouts"}));this.Di(Object.assign(new hg("PptRibbon.SmartArt.Reset"),{externalUxGroupId:"SmartArtReset"}));this.Di(Object.assign(new hg("PptRibbon.SmartArt.Styles"),{externalUxGroupId:"SmartArtStyles"}));this.Di(Object.assign(new hg("PptRibbon.Transition.AllSlides"),{externalUxGroupId:"TransitionAllSlides"}));this.Di(Object.assign(new hg("PptRibbon.Transition.Gallery"),{externalUxGroupId:"Transitions"}));this.Di(Object.assign(new hg("PptRibbon.Transition.Timing"),
{externalUxGroupId:"TransitionTiming"}));this.Di(Object.assign(new hg("PptRibbon.Review.Proofing"),{externalUxGroupId:"Proofing"}));this.Di(Object.assign(new hg("PptRibbon.View.PresentationViews"),{externalUxCommandIds:["ReadingView"]}));this.Di(Object.assign(new hg("PptRibbon.View.ShowHide"),{externalUxCommandIds:["Notes","ShowHideComments"]}));this.Di(Object.assign(new hg("PptRibbon.View.StartSlideShow"),{externalUxGroupId:"StartSlideShow"}));this.Di(Object.assign(new hg("PptRibbon.View.Zoom"),
{externalUxGroupId:"Zoom"}));this.Di(Object.assign(new hg("PptRibbon.View.Subtitles"),{externalUxGroupId:"Subtitles"}));this.Di(Object.assign(new hg("PptRibbon.Help.GroupHelp"),{externalUxGroupId:"Help"}));this.Di(Object.assign(new hg("PptRibbon.PictureFormat.PictureBorders"),{externalUxGroupId:"PictureBorders"}));this.Di(Object.assign(new hg("PptRibbon.DrawingFormat.NewArrange"),{externalUxGroupId:"Arrange"}));this.Di(Object.assign(new hg("PptRibbon.PictureFormat.NewArrange"),{externalUxGroupId:"Arrange"}));
this.Di(Object.assign(new hg("PptRibbon.Graphics.NewArrange"),{externalUxGroupId:"GraphicsArrange"}));this.Di(Object.assign(new hg("PptRibbon.DrawingFormat.FormatOptions"),{externalUxGroupId:"Properties"}));this.Di(Object.assign(new hg("PptRibbon.PictureFormat.FormatOptions"),{externalUxGroupId:"Size"}));this.Di(Object.assign(new hg("PptRibbon.Graphics.FormatOptions"),{externalUxGroupId:"Properties"}))}Q0h(){this.addCommandToMaps(Object.assign(new Ta.a("PptFileMenuEmbed","981175184"),{legacyControlId:"PptJewel.Share.Embed"}));
this.addCommandToMaps(Object.assign(new Ta.a("PptFileMenuShare","981334692"),{legacyControlId:"PptJewel.Share.ShareWithPeople"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFileMenuTermsOfUse","2349775795"),{legacyControlId:"PptJewel.About.TermsOfUse"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFileMenuThirdPartyNotices","2220417879"),{legacyControlId:"PptJewel.About.ThirdPartyNotices"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFileMenuPrivacy","1208554566"),{legacyControlId:"PptJewel.About.Privacy"}));
this.addCommandToMaps(Object.assign(new Ta.a("PptFileAboutPage","336231556"),{legacyControlId:"PptJewel.About"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFileHomePage","2074131365"),{legacyControlId:"PptJewel.Home"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFileAddinPage","336231556"),{legacyControlId:"PptJewel.Addin"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFileInfoPage","336231556"),{legacyControlId:"PptJewel.Info"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFileNewPage",
"2074131365"),{legacyControlId:"PptJewel.New"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFileOpenPage","2799130311"),{legacyControlId:"PptJewel.Open"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFilePrintPage","336231556"),{legacyControlId:"PptJewel.Print"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFileSaveAsPage","336231556"),{legacyControlId:"PptJewel.SaveACopy"}));this.addCommandToMaps(Object.assign(new Ta.a("PptFileSharePage","336231556"),{legacyControlId:"PptJewel.Share"}))}X0h(){this.addCommandToMaps(new Ta.a("GroupAnchor",
"3206512596"));this.addCommandToMaps(new Ta.a("GroupShapes","1084571292"));this.addCommandToMaps(new Ta.a("UngroupShapes","2681035587"))}U0h(){this.addCommandToMaps(new Ta.a("AudioPlay","354524898"));this.addCommandToMaps(new Ta.a("AudioPause","381759002"));this.addCommandToMaps(Object.assign(new Ta.a("SetAudioOptions","3754409354"),{queryCommandId:"934802286"}));this.addCommandToMaps(Object.assign(new Ta.a("PlayAcrossSlides","2830952303"),{queryCommandId:"4262270261"}));this.addCommandToMaps(Object.assign(new Ta.a("LoopUntilStopped",
"3632291603"),{queryCommandId:"3552942809"}));this.addCommandToMaps(Object.assign(new Ta.a("HideDuringShow","3215231982"),{queryCommandId:"532089170"}));this.addCommandToMaps(Object.assign(new Ta.a("RewindAfterPlaying","3190911303"),{queryCommandId:"1283553413"}));this.addCommandToMaps(Object.assign(new Ta.a("PlayInBackground","1867854189"),{queryCommandId:"2980229931"}));this.addCommandToMaps(Object.assign(new Ta.a("NoAudioStyle","215519670"),{queryCommandId:"2550125834"}));this.addCommandToMaps(new Ta.a("SetVolume",
"489231152"));this.addCommandToMaps(Object.assign(new Ta.a("SetVolumeLow","3743080814"),{queryCommandId:"1369975562"}));this.addCommandToMaps(Object.assign(new Ta.a("SetVolumeMedium","3138571443"),{queryCommandId:"2162671853"}));this.addCommandToMaps(Object.assign(new Ta.a("SetVolumeHigh","2824132372"),{queryCommandId:"2284865724"}));this.addCommandToMaps(Object.assign(new Ta.a("SetVolumeMute","2837428403"),{queryCommandId:"2835961045"}));this.addCommandToMaps(Object.assign(new Ta.a("StartAudio",
"333691564"),{queryCommandId:"646903900"}))}e1h(){this.addCommandToMaps(Object.assign(new Ta.a("GetSlideInformation","798637440"),{queryCommandId:"1740197325"}));this.addCommandToMaps(Object.assign(new Ta.a("OpenLanguageDialog","3274206189"),{legacyControlId:"PptEditingStatusBar.LanguageButton",queryCommandId:"2048144900"}));this.addCommandToMaps(Object.assign(new Ta.a("OpenDocumentLabelPane","3427834559"),{queryCommandId:"497870830"}));this.addCommandToMaps(Object.assign(new Ta.a("TextForOfficeOnlineInGallatin",
"798637440"),{legacyControlId:"PptEditingStatusBar.MiddleStatus"}));this.addCommandToMaps(Object.assign(new Ta.a("GetEnvironmentName","798637440"),{legacyControlId:"EnvironmentLabel",queryCommandId:"3887408216"}));this.addCommandToMaps(Object.assign(new Ta.a("GetSlideScore","798637440"),{legacyControlId:"SlideScoreLabel",queryCommandId:"1312683093"}));this.addCommandToMaps(Object.assign(new Ta.a("GetCoAuthStatus","798637440"),{legacyControlId:"CoauthStatusLabel",queryCommandId:"587300872"}));this.addCommandToMaps(Object.assign(new Ta.a("GetDataSyncMode",
"798637440"),{legacyControlId:"DataSyncModeLabel",queryCommandId:"119594198"}));this.addCommandToMaps(Object.assign(new Ta.a("GetOfflineStatus","798637440"),{legacyControlId:"PptEditingStatusBar.OfflineModeStatusLabel",queryCommandId:"225752111"}));this.addCommandToMaps(Object.assign(new Ta.a("ShowAddInCommandsLoadStatusCallout","516359383"),{legacyControlId:"PptEditingStatusBar.AddInCommandsLoadStatus",queryCommandId:"1309495434"}));this.addCommandToMaps(Object.assign(new Ta.a("OpenFeedbackDialog",
"802602464"),{legacyControlId:"PptEditingStatusBar.GiveFeedback"}));this.addCommandToMaps(Object.assign(new Ta.a("GiveFeedbackPane","2918242107"),{legacyControlId:"PptEditingStatusBar.GiveFeedbackPane"}));this.addCommandToMaps(Object.assign(new Ta.a("ShowHidePerfStats","2319158239"),{legacyControlId:"PptEditingStatusBar.PerfStats",queryCommandId:"298865648"}));this.addCommandToMaps(Object.assign(new Ta.a("ShowHideNotes","3113372712"),{legacyControlId:"PptEditingStatusBar.Notes",queryCommandId:"850829913"}));
this.addCommandToMaps(Object.assign(new Ta.a("ShowEditTriPaneViewInStatusBar","12696731"),{legacyControlId:"PptEditingStatusBar.Edit",queryCommandId:"363623614"}));this.addCommandToMaps(Object.assign(new Ta.a("ShowSorterViewInStatusBar","1659792175"),{legacyControlId:"PptEditingStatusBar-SlideSorterView",queryCommandId:"2246678568"}));this.addCommandToMaps(Object.assign(new Ta.a("SwitchToReadingMode","3849298593"),{legacyControlId:"PptEditingStatusBar.Reading"}));this.addCommandToMaps(Object.assign(new Ta.a("StartSlideShowFromCurrentSlide",
"1989200744"),{legacyControlId:"PptEditingStatusBar.SlideShow"}));this.addCommandToMaps(new Ta.a("ZoomOut","195579685"));this.addCommandToMaps(Object.assign(new Ta.a("OpenZoomConfig","3864281841"),{legacyControlId:"PptEditingStatusBar.ZoomScale",queryCommandId:"1923067973"}));this.addCommandToMaps(new Ta.a("ZoomIn","3018530951"));this.addCommandToMaps(Object.assign(new Ta.a("ZoomToFit","2470172091"),{legacyControlId:"PptEditingStatusBar.FitToWindow"}))}R0h(){this.addCommandToMaps(new Ta.a("AccessibleAuthoringHelp",
"378041226"));this.addCommandToMaps(new Ta.a("AddHiddenSlideTitle","4032980552"));this.addCommandToMaps(new Ta.a("AddSlideTitle","2061524948"));this.addCommandToMaps(new Ta.a("EditSlideTitle","1049013003"));this.addCommandToMaps(new Ta.a("InsertCaptions","960930904"));this.addCommandToMaps(new Ta.a("InsertCaptionsSplitButton","327712988"));this.addCommandToMaps(new Ta.a("LinkText","2488223096"));this.addCommandToMaps(new Ta.a("RemoveAllCaptions","2891615490"));this.addCommandToMaps(new Ta.a("SetAsSlideTitle",
"2069673123"));this.addCommandToMaps(new Ta.a("SlideTitle","3898323075"))}}Object(e.a)(ZA,"PPTWebEditReactCommandDefinitionMapping",Xw,[]);class Ky{}Ky.Jwh="TabId";Object(e.a)(Ky,"RibbonSQMProperties",null,[]);class eB{constructor(a){this.Ca=a;this.Ca.ya(F.a.ifd,xd.a.frame,Object(C.a)(this,this.ifd,"reportTabSwitch"));this.Ca.ya(F.a.ehh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(F.a.ghh,xd.a.frame,Kd.ActionManager.Hg)}ifd(a,b,c,f,l){this.Ca.processAction(this.Wcj(l[Ky.Jwh]),2);return 32}}Object(e.a)(eB,
"RibbonSQMInformation",null,[1155]);class wh{}wh.UAc="PptRibbon.AddIns";wh.T1="PptRibbon.Animation";wh.design="PptRibbon.Design";wh.bIc="PptRibbon.Developer";wh.fQc="PptRibbon.Graphics";wh.help="PptRibbon.Help";wh.home="PptRibbon.Home";wh.insert="PptRibbon.InsertTab";wh.picture="PptRibbon.PictureFormat";wh.review="PptRibbon.Review";wh.shape="PptRibbon.DrawingFormat";wh.slideShow="PptRibbon.SlideShow";wh.smartArt="PptRibbon.SmartArt";wh.ixh="ContextualTabs.Tables.Design";wh.tableLayout="ContextualTabs.Tables.Layout";
wh.FZa="PptRibbon.Transition";wh.view="PptRibbon.View";Object(e.a)(wh,"MLRTabIds",null,[]);class uj{}uj.UAc="AddIns";uj.T1="Animations";uj.design="Design";uj.bIc="Developer";uj.draw="Draw";uj.fQc="Graphics";uj.help="Help";uj.home="Home";uj.insert="Insert";uj.picture="FormatPicture";uj.review="Review";uj.shape="FormatShape";uj.slideShow="SlideShow";uj.smartArt="SmartArtDesign";uj.table="Table";uj.FZa="Transitions";uj.view="View";Object(e.a)(uj,"SLRTabIds",null,[]);class ZF extends eB{constructor(a){super(a)}uOk(){this.Ca.ya(F.a.Rgh,
xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(ba.a.Sgh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(ba.a.Tgh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(F.a.Ugh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(ba.a.Wgh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(F.a.Xgh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(F.a.Ygh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(F.a.Zgh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(ba.a.$gh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(F.a.ahh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(ba.a.bhh,
xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(ba.a.chh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(ba.a.dhh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(ba.a.aHe,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(ba.a.fhh,xd.a.frame,Kd.ActionManager.Hg);this.Ca.ya(F.a.hhh,xd.a.frame,Kd.ActionManager.Hg)}Wcj(a){let b=F.a.ghh,c="PptRibbon.Unknown";switch(a){case wh.UAc:case uj.UAc:c=wh.UAc;b=F.a.Rgh;break;case wh.T1:case uj.T1:c=wh.T1;b=ba.a.Sgh;break;case wh.design:case uj.design:c=wh.design;b=ba.a.Tgh;break;case wh.bIc:case uj.bIc:c=
wh.bIc;b=F.a.Ugh;break;case uj.draw:c=a;b=ba.a.Vgh;break;case wh.fQc:case uj.fQc:c=wh.fQc;b=ba.a.Wgh;break;case wh.help:case uj.help:c=wh.help;b=F.a.Xgh;break;case wh.home:case uj.home:c=wh.home;b=F.a.Ygh;break;case wh.insert:case uj.insert:c=wh.insert;b=F.a.Zgh;break;case wh.picture:case uj.picture:c=wh.picture;b=ba.a.$gh;break;case wh.review:case uj.review:c=wh.review;b=F.a.ahh;break;case wh.shape:case uj.shape:c=wh.shape;b=ba.a.bhh;break;case wh.slideShow:case uj.slideShow:c=wh.slideShow;b=ba.a.chh;
break;case wh.smartArt:case uj.smartArt:c=wh.smartArt;b=ba.a.dhh;break;case wh.ixh:case wh.tableLayout:c=a;b=ba.a.aHe;break;case uj.table:c=wh.ixh;b=ba.a.aHe;break;case wh.FZa:case uj.FZa:c=wh.FZa;b=ba.a.fhh;break;case wh.view:case uj.view:c=wh.view,b=F.a.hhh}if(a=Nc.a.Eb)a.actionName=c,a.Oj=!0,a.Kr=!1;return b}}Object(e.a)(ZF,"PPTWebEditorRibbonSQMInformation",eB,[]);var tv=d(906);class fB{constructor(){this.uLb=null}Qsl(){this.uLb||(this.uLb=fb.a.instance.qb("Common.App.AccountSwitching.IAccountSwitching"))||
Z.ULS.sendTraceTag(589050651,1300,10,"Unable to resolve IAccountSwitching")}nZi(){this.Qsl();return this.uLb?this.uLb.getCustomAuthConfig():null}static SGj(){return u.AFrameworkApplication.fa.ka("UiHostSupportsCustomAuthConfig")}}Object(e.a)(fB,"ReactSharedHeaderAccountSwitchingUtils",null,[]);class gB{constructor(){this.M6b=this.cultureName=null}}Object(e.a)(gB,"HeaderCultureInfo",null,[]);var Ly=d(660);class $F{constructor(){this.getTokenRequestDictionary=this.userRing=this.loadTellMeResources=
null}}Object(e.a)($F,"SearchInitializationSettings",null,[]);class aG{constructor(){this.saveStatus=this.documentTitle=null;this.isVersionHistoryEnabled=!1;this.breadcrumbFolderUrl=this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.hideDocumentTitleInput=!1;this.getCalloutAppProps=this.onFirstRender=this.onGetSuggestedTitle=this.documentExtension=null;this.isShared=!1}}Object(e.a)(aG,"DocumentTitleAppProps",null,[]);class bG{constructor(){this.documentExtension=this.breadcrumbFolderUrl=
this.breadcrumbFolderName=this.breadcrumbBrandUrl=this.breadcrumbBrandName=null;this.isMoveEnabled=this.isVersionHistoryEnabled=this.hideDocumentTitleInput=!1;this.renameDisableReason=this.message=this.onMove=null;this.openBreadcrumbsInNewTab=!1}}Object(e.a)(bG,"DocumentTitleCalloutAppProps",null,[]);class cG{constructor(){this.language=this.culture=this.userID=this.emailAddress=this.userDisplayName=this.appName=null;this.defaultDocumentTitleToLeft=this.hideUserName=this.showDiscoverPremiumButton=
this.showMeControl=this.showAppLauncher=this.isConsumer=!1;this.documentTitleAppProps=this.controls=this.assetsContainerOverride=null;this.showGoPremiumControl=this.enableSearchControl=this.showSearchControl=this.showChatControl=!1;this.onFlexPaneClose=this.onFlexPaneOpen=this.getTokenRequestDictionary=this.signOutLink=this.signInLink=null;this.enableTheming=!1;this.userRing=null;this.testTraffic=!1;this.onLoadFailed=this.onFullyLoaded=this.onFirstRender=this.loadTellMeResources=null;this.showDocumentTitleControl=
this.showRibbonToggle=this.showWorkflowButton=this.enableVanillaSearchBox=!1;this.shellAuthProviderConfigPromise=null;this.enableUpdatedRUMReporting=!1}}Object(e.a)(cG,"HeaderAppProps",null,[]);class dG{constructor(){this.workflowButton=this.ribbonToggleId=null}}Object(e.a)(dG,"HeaderControls",null,[]);class eG{constructor(){this.command=this.label=null}}Object(e.a)(eG,"WorkflowButtonAppProps",null,[]);var My;(function(a){a[a.none=0]="none";a[a.readOnly=1]="readOnly";a[a.insufficientPermission=2]=
"insufficientPermission";a[a.incompatibleEditorsPresent=3]="incompatibleEditorsPresent";a[a.editorsPresent=4]="editorsPresent";a[a.notSupported=5]="notSupported"})(My||(My={}));Object(e.b)("RenameDisableReason",My);class fG{constructor(a=""){this.$Ie=this.documentTitleAppProps=this.UWe=null;this.dYh=""!==a?a:sp.a.GO}icj(a){const b=fb.a.instance.qb("Common.IExternalUICommandDefinitionMapping").wCa(a);if(b&&0<b.length)return b[0].externalUxCommand;Z.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",
a));return null}y4d(){if(!this.UWe){const a=tv.a();if(a){const b=this.icj(a.command);b&&(this.UWe=Object.assign(new eG,{command:b,label:a.label}))}}return this.UWe}r2i(){return Object.assign(new dG,{workflowButton:this.y4d()})}Llk(){wd.a.get_instance().wJ(17)}onMove(){const a={};a.MoveButtonClickedTime=new Date;u.AFrameworkApplication.Ta.La(F.a.zdb,2,a)}Icj(a){switch(a){case 1:return CommonUIStrings.l_CalloutRenameReadOnlyError;case 2:return CommonUIStrings.l_CalloutRenamePermissionError;case 3:case 4:return CommonUIStrings.l_CalloutRenameCoauthError;
case 5:return null;default:return CommonUIStrings.l_CalloutRenameGenericError}}n4i(){let a=null,b=null;var c=fb.a.instance.qb("Common.IRenameProps");c?(c=c.Qeg(),0!==c&&(a=this.Icj(c),b=My[c])):Z.ULS.sendTraceTag(572375621,340,15,"IRenameProps not yet initialized");return Object.assign(new bG,{breadcrumbBrandName:u.AFrameworkApplication.pu.breadcrumbBrandName,breadcrumbBrandUrl:u.AFrameworkApplication.pu.breadcrumbBrandUrl,breadcrumbFolderName:u.AFrameworkApplication.pu.breadcrumbFolderName,breadcrumbFolderUrl:u.AFrameworkApplication.pu.breadcrumbFolderUrl,
hideDocumentTitleInput:u.AFrameworkApplication.Aa.jb.vuj,isVersionHistoryEnabled:this.Vbl(),documentExtension:Ka.a.WV(u.AFrameworkApplication.fileName),isMoveEnabled:32===u.AFrameworkApplication.Ta.processAction(F.a.zdb,1),onMove:Object(C.a)(this,this.onMove,"onMove"),message:a,renameDisableReason:b,openBreadcrumbsInNewTab:u.AFrameworkApplication.fa.ka("OpenLinksInNewWindow")})}oag(){if(!this.documentTitleAppProps){const a=u.AFrameworkApplication.pu.Ix;this.documentTitleAppProps=Object.assign(new aG,
{documentTitle:u.AFrameworkApplication.JIc?a:Ka.a.yG(a),onFirstRender:Object(C.a)(this,this.Llk,"onDocumentTitleFirstRender"),getCalloutAppProps:Object(C.a)(this,this.n4i,"getDocumentFlyoutProperties"),isShared:!1})}return this.documentTitleAppProps}Vbl(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.kzg}bal(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.BPj}Gbl(){const a=!tv.b()&&!u.AFrameworkApplication.hideHeader&&!u.AFrameworkApplication.dmg&&(u.AFrameworkApplication.fa.ka("SkypeWebControlIsEnabled")||
u.AFrameworkApplication.fa.ka("TeamsChatIsEnabled"));Z.ULS.sendTraceTag(592315859,215,50,"ShowChat is {0}",a);return a}Zvi(a){appChrome.getHeaderApi().then(b=>{b.setNavBarData(a.result);return null});Z.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")}IMk(){appChrome.getHeaderApi().then(a=>{const b=fb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");a.setHeaderCommandHandler("OnFirstRender",()=>{this.onFirstRender()});a.setHeaderCommandHandler("OnFullyLoaded",
()=>{this.onFullyLoaded()});a.setHeaderCommandHandler("OnFlexPaneOpen",c=>{b.onFlexPaneOpen(c)});a.setHeaderCommandHandler("OnFlexPaneClose",c=>{b.onFlexPaneClose(c)});a.setHeaderCommandHandler("SetCookie",c=>Pi.a.set(c.cookieName,c.value));a.setHeaderCommandHandler("GetCookie",c=>this.s2i(c));a.setHeaderCommandHandler("QueryWorkflowButtonSettings",Object(C.a)(this,this.y4d,"getWorkflowButtonAppProps"));a.setHeaderCommandHandler("QueryDocumentTitleAppProps",Object(C.a)(this,this.oag,"getDocumentTitleAppProps"));
a.setHeaderCommandHandler("OnDocumentTitleReducerReady",()=>{this.Mlk();return null});Ly.a.sVc()&&a.setHeaderCommandHandler("QuerySearchInitializationSettings",Object(C.a)(this,this.mfg,"getSearchInitializationSettings"))})}Mlk(){fb.a.instance.Ka("Common.App.SaveStatus.ISaveStatusUIHandler").execute(a=>{a.Qna(!1,u.AFrameworkApplication.Ta.mode)})}s2i(a){a=Pi.a.get(a);void 0!==a&&null!==a&&0<a.length&&(a=decodeURIComponent(a));return a}Vgj(){return el.AppChromeOverrideUtilities.isEnabled?el.AppChromeOverrideUtilities.getPath("suiteux-shell",
!1):this.dYh+u.AFrameworkApplication.v0+"suiteux-shell"}onFirstRender(){fb.a.instance.Ka("Common.App.O365Shell.IO365ShellActor").execute(a=>{a.p$k.continueWith(Object(C.a)(this,this.Zvi,"continueShellServiceDataAsync"),3)});wd.a.get_instance().wJ(15)}onFullyLoaded(){wd.a.get_instance().wJ(16)}Tbj(){a:{try{var a=sa.a.oe(u.AFrameworkApplication.lcid);if(a){var b=Object.assign(new gB,{cultureName:a.name,M6b:a.M6b});break a}}catch(c){Z.ULS.sendTraceTag(592318981,340,15,"Header language cannot be determined, LCID:"+
u.AFrameworkApplication.lcid.toString())}b=Object.assign(new gB,{cultureName:"en-us",M6b:"en"})}a=fb.a.instance.resolve("Common.App.Header.IReactSharedHeaderFocusManager");b=Object.assign(new cG,{appName:CommonUIStrings.l_AppNameShort,culture:b.cultureName,language:b.M6b,isConsumer:!u.AFrameworkApplication.ood,showAppLauncher:tv.f(),showMeControl:tv.e(),hideUserName:u.AFrameworkApplication.z6d,defaultDocumentTitleToLeft:u.AFrameworkApplication.VWf,assetsContainerOverride:this.Vgj(),controls:this.r2i(),
documentTitleAppProps:this.oag(),showDocumentTitleControl:!0,showWorkflowButton:!!this.y4d(),showChatControl:this.Gbl(),showGoPremiumControl:tv.g(),showDiscoverPremiumButton:tv.d(),enableSearchControl:Ly.a.ZOj(),onFlexPaneOpen:Object(C.a)(a,a.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:Object(C.a)(a,a.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.bal(),testTraffic:u.AFrameworkApplication.fa.ka("SharedHeaderTestTrafficIsEnabled"),onFirstRender:Object(C.a)(this,this.onFirstRender,"onFirstRender"),
onFullyLoaded:Object(C.a)(this,this.onFullyLoaded,"onFullyLoaded"),enableUpdatedRUMReporting:u.AFrameworkApplication.cal()});!u.AFrameworkApplication.$ib||u.AFrameworkApplication.ROe?(b.userDisplayName=u.AFrameworkApplication.userName,b.emailAddress=u.AFrameworkApplication.fa.Ga("UserPrincipalName"),b.userID=u.AFrameworkApplication.fa.Ga("Puid")||"",b.signOutLink=u.AFrameworkApplication.ROe):u.AFrameworkApplication.signInUrl&&(b.signInLink=u.AFrameworkApplication.signInUrl);Ly.a.sVc()&&(a=this.mfg(),
b.loadTellMeResources=a.loadTellMeResources,b.getTokenRequestDictionary=a.getTokenRequestDictionary,b.enableVanillaSearchBox=u.AFrameworkApplication.fa.ka("VanillaSearchUxInHeaderIsEnabled"),b.userRing=a.userRing);fB.SGj()&&(a=new fB,b.shellAuthProviderConfigPromise=Object(C.a)(a,a.nZi,"getAccountSwitchingConfig"));this.IMk();return b}mfg(){if(!this.$Ie){const a=new Ly.a;let b=u.AFrameworkApplication.fa.Ga("Microsoft365Ring");b&&b.length||(b="generalAudience");this.$Ie=Object.assign(new $F,{loadTellMeResources:a.EWj(),
getTokenRequestDictionary:Object(C.a)(a,a.lij,"getTokenRequestDict"),userRing:b})}return this.$Ie}}Object(e.a)(fG,"ReactSharedHeaderPropsHelper",null,[1159]);var tg=d(336),pP=d(1192),qP=d(1042);d(907);var gG=d(659);const St=(a,b)=>{let c=0;for(;b()&&c<a.length;)a[c](),c++},hG=(a,b,c,f)=>{if(a&&a.parentNode&&a.parentNode.parentNode){var l=(l=dh.a.It(a))?ya.a.QL(l.paddingLeft)+ya.a.QL(l.paddingRight):0;var x=dh.a.It(a.parentNode);x=x?ya.a.QL(x.paddingLeft)+ya.a.QL(x.paddingRight):0;let G=0,R=a;for(;R.nextSibling;)R=
R.nextSibling,G+=R.offsetWidth;l=l+x+G;"auto"!==a.parentNode.style.width&&(a.style.width=a.parentNode.offsetWidth-l+"px");x=f?c:b;c=f?b:c;f=ib.a.ei(a.parentNode.parentNode);b=x?ib.a.ei(x):new Sys.UI.Bounds(f.x,0,0,0);c=c?ib.a.V6a(c):new Sys.UI.Point(f.x+f.width,0);"absolute"===a.parentNode.style.position?b=c.x-(b.x+b.width)-l-1:(f=ib.a.ei(a.nextSibling?a.parentNode:a),f=f.x+f.width/2,b=2*Math.min(f-(b.x+b.width),c.x-f)-l-1);a.style.maxWidth=b+"px"}},Ny=a=>{a&&Wq(a)&&(a.style.display="",a._isHidden=
"0")},$k=a=>{a&&!Wq(a)&&(a.style.display="none",a._isHidden="1")},Wq=a=>{if(!a)return!0;a=a._isHidden;return!(void 0===a||null===a||"0"===a)},ws=(a,b,c)=>{if(a&&!Wq(a)){var f=dh.a.It(a);f=ya.a.QL(f.paddingLeft)+ya.a.QL(f.paddingRight);c=a.offsetWidth-c-f;let l=0;for(;b&&b!==a;)(f=dh.a.It(b))&&(l+=ya.a.QL(f.paddingLeft)+ya.a.QL(f.paddingRight)),b=b.parentNode;c=Math.max(c,75+l);a.style.width=c+"px"}},Dr=a=>{a&&(a.style.width="auto",a.style.maxWidth="none")},rP=(a,b,c)=>{if(a&&b){let f=0,l=0;({left:f,
top:l}=ib.a.xag(b,f,l));b=c?f-a.offsetWidth:f+b.offsetWidth;a&&(a.style.position="absolute",a.style.left=b+"px")}},sq=(a,b,c)=>!a||!b||Wq(a)||Wq(b)?!1:ib.a.aCg(ib.a.ei(a),ib.a.ei(b),c),xs=(a,b,c)=>{let f=0;a&&b&&(f=ib.a.Xde(ib.a.ei(a),ib.a.ei(b),c));return f};var Er=d(355);class Oy{constructor(a,b,c){this.Jrb=this.zZb=this.Irb=this.I5a=this.gJc=this.yZb=this.vG=this.xZb=this.HPa=this.MP=this.hJc=this.GPa=this.Nba=this.av=this.AK=this.tS=this.FPa=this.H5a=this.G5a=this.QBa=null;this.xR=a;this.mNb=
b;this.Qi=c}ZZk(a){this.xR=a;this.mNb=null;this.QXd(this.xR);this.WBh();this.vkh()}fYa(){this.xR&&this.mNb&&this.mNb.clientHeight&&(this.QXd(this.xR),this.WBh(),this.vkh(),-1!==this.mNb.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.C5f(this.mNb),this.Utl(),this.c_k()))}QXd(a){if(a)for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c],l=ya.a.Iia(f),x=!!f.id;if(-1!==l.indexOf("cui-QATRowLeft"))this.QBa=f;else if(-1!==l.indexOf("OfficeOnlineBrandBreadcrumbSeparator"))this.G5a=
f;else if(f.id===il.CuiHelper.ZLd)this.H5a=f;else if(f.id===il.CuiHelper.O6f)this.FPa=f;else if(f.id===il.CuiHelper.$Ld)this.tS=f;else if(-1!==l.indexOf("cui-QATRowCenter"))this.AK=f;else if(f.id===il.CuiHelper.aMd)this.av=f;else if(-1!==l.indexOf("cui-QATRowRight"))this.Nba=f;else{var b;if(b=x)b=f,b=!!b.id&&(b.id.startsWith(il.CuiHelper.CMe)||b.id.startsWith(il.CuiHelper.gfd));b?this.GPa=f:x&&f.id.startsWith(il.CuiHelper.igl)?this.hJc=f:-1!==l.indexOf("UsernameNameContainer")?this.MP=f:-1!==l.indexOf("UsernameNameItem")&&
(this.HPa=f)}this.QXd(f)}}WBh(){var a=[this.AK,this.av,this.MP],b=[this.G5a,this.H5a,this.FPa,this.tS,this.AK,this.av,this.Nba,this.GPa,this.hJc,this.MP];for(const c of b)Ny(c);for(const c of a)Dr(c);if(a=this.AK)a.style.position="static",a.style.left="auto"}vkh(){this.kQd()?this.a_k():this.b_k();var a=this.FPa,b=this.tS;a&&b&&(a.style.marginTop=(b.offsetHeight-a.offsetHeight)/2+"px")}a_k(){let a;const b=this.f0d();a=[()=>{ws(this.tS,this.tS,xs(this.QBa,b,this.Qi))},()=>{$k(this.G5a);$k(this.H5a);
$k(this.FPa);$k(this.tS)}];St(a,()=>sq(this.tS,b,this.Qi));sq(this.vG,this.AK,this.Qi)&&rP(this.AK,this.vG,this.Qi);this.bih();a=[()=>{ws(this.MP,this.HPa,xs(this.vG,this.Nba,this.Qi))},()=>{$k(this.GPa)}];this.cih();Wq(this.AK)||Wq(this.av)||hG(this.av,this.vG,this.Nba,this.Qi)}b_k(){const a=!!this.tS,b=!!this.av;let c=0;if((a||b)&&0<(c=xs(this.QBa,this.AK,this.Qi))){let f=a;b&&(!a||this.av.offsetWidth>this.tS.offsetWidth)&&(f=!1);ws(f?this.tS:this.av,f?this.tS:this.av,f?c:2*c);a&&b&&0<(c=xs(this.QBa,
this.AK,this.Qi))&&(f=!f,ws(f?this.tS:this.av,f?this.tS:this.av,f?c:2*c))}St([()=>{$k(this.G5a);$k(this.H5a);$k(this.FPa);$k(this.tS);Dr(this.av)},()=>{ws(this.av,this.av,2*xs(this.QBa,this.AK,this.Qi))},()=>{$k(this.av)}],()=>sq(this.QBa,this.AK,this.Qi));this.bih();this.cih();Wq(this.AK)||Wq(this.av)||hG(this.av,this.QBa,this.Nba,this.Qi)}bih(){const a=Wq(this.av);St([()=>{this.GHe()},()=>{$k(this.GPa);Dr(this.av);Dr(this.MP);a||Ny(this.av)},()=>{this.GHe()},()=>{$k(this.hJc);Dr(this.av);Dr(this.MP);
a||Ny(this.av)},()=>{this.GHe()}],()=>sq(this.AK,this.Nba,this.Qi))}GHe(){const a=!!this.av,b=!!this.MP;let c=0;if((a||b)&&0<(c=xs(this.AK,this.Nba,this.Qi))){const f=!!this.AK&&"absolute"!==this.AK.style.position;let l=a;b&&(!a||this.MP.offsetWidth>this.av.offsetWidth)&&(l=!1);ws(l?this.av:this.MP,l?this.av:this.HPa,l&&f?2*c:c);a&&b?(0<(c=xs(this.AK,this.Nba,this.Qi))&&(l=!l,ws(l?this.av:this.MP,l?this.av:this.HPa,l&&f?2*c:c)),sq(this.AK,this.Nba,this.Qi)&&($k(this.AK),Dr(this.MP))):a&&sq(this.AK,
this.Nba,this.Qi)&&$k(this.av)}}cih(){const a=()=>{ws(this.MP,this.HPa,xs(this.QBa,this.Nba,this.Qi))};St([a,()=>{$k(this.GPa);Dr(this.MP)},a,()=>{$k(this.hJc);Dr(this.MP)},a,()=>{$k(this.MP)}],()=>sq(this.QBa,this.Nba,this.Qi))}kQd(){if(!this.vG)return!1;for(let a=0;a<this.vG.childNodes.length;a++)if(-1!==ya.a.Iia(this.vG.childNodes[a]).indexOf("cui-cg"))return!0;return!1}f0d(){if(!this.vG)return null;let a=null;for(let b=this.vG.childNodes.length-1;0<=b;b--){const c=this.vG.childNodes[b];if(-1===
ya.a.Iia(c).indexOf("cui-cg"))break;a=c}return a}C5f(a){if(a)for(let b=0;b<a.childNodes.length;b++){const c=a.childNodes[b],f=ya.a.Iia(c),l=!!c.id;-1!==f.indexOf("cui-jewel-container")?this.xZb=c:-1!==f.indexOf("cui-tts")?this.vG=c:-1!==f.indexOf("cui-TabRowInline")?this.yZb=c:-1!==f.indexOf("cui-separator")?this.gJc=c:l&&c.id.startsWith(il.CuiHelper.Q3g)?this.I5a=c:l&&c.id.startsWith(il.CuiHelper.x4f)?this.Irb=c:-1!==f.indexOf("cui-TabRowRight")?this.zZb=c:l&&c.id.startsWith(il.CuiHelper.hAe)&&(this.Jrb=
c);this.C5f(c)}}Utl(){var a=[this.vG,this.yZb,this.gJc,this.I5a,this.Irb,this.zZb,this.Jrb];for(const b of a)Ny(b);this.KHb(0)}c_k(){let a;a=[()=>{$k(this.gJc);$k(this.I5a)},()=>{this.KHb(1)},()=>{this.KHb(2)},()=>{$k(this.yZb);this.KHb(0)}];St(a,()=>sq(this.vG,this.yZb,this.Qi));a=[()=>{$k(this.gJc);$k(this.I5a)},()=>{$k(this.Irb)},()=>{$k(this.Jrb)},()=>{$k(this.zZb)}];St(a,()=>sq(this.yZb,this.zZb,this.Qi)||sq(this.vG,this.zZb,this.Qi));a=[()=>{this.KHb(1)},()=>{this.KHb(2)},()=>{$k(this.vG)}];
St(a,()=>sq(this.xZb,this.vG,this.Qi))}KHb(a){this.vG&&(this.vG.className=Oy.ill[a],this.vG._scaleStep=a)}}Oy.ill=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(e.a)(Oy,"TopBarScalingManager",null,[]);class iG{constructor(a,b){this.xR=this.cza=null;this._clientId=a;this.quf=b}JOi(){if(!Zk.b(this.xR))return this.xR;this.NNi();this.xR.style.display="block";this.quf&&this.quf.uha(Object(C.a)(this,this.onResize,"onResize"));return this.xR}onResize(){this.fYa()}fYa(){this.iNi()?(document.getElementById("application").style.minWidth=
"0px",(new Oy(this.xR,null,u.AFrameworkApplication.isRtl)).ZZk(this.xR)):u.AFrameworkApplication.Aa.jb.xN||gG.a.$Zk(this.xR,u.AFrameworkApplication.isRtl)}iNi(){return u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("EnhancedMobileViewIsEnabled"):!1}NNi(){if(Zk.b(this.cza)){var a;({f3b:a}=Er.a.fKb(!u.AFrameworkApplication.bQ)).returnValue&&(this.cza=wA("div"),this.cza.className=Er.a.oQi,this.cza.id=il.CuiHelper.xWd,a.appendChild(this.cza),this.ENi(),u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.OSa&&
!u.AFrameworkApplication.bQ&&this.HNi(),this.IOi())}}IOi(){Zk.b(this.xR)&&(this.xR=wA("div"),this.xR.className=Er.a.qpl,this.xR.style.display="none",this.cza.appendChild(this.xR))}ENi(){Sys.UI.DomElement.addCssClass(this.cza,Er.a.pQi);if(u.AFrameworkApplication.isRtl){var a=this.cza;if(!Zk.b(a)){var b=a.className;if(Zk.b(b)||-1===b.indexOf("cui-rtl"))b=b.trim()+" cui-rtl",b=b.trim(),a.className=b}}}HNi(){Sys.UI.DomElement.addCssClass(this.cza,"FlexBoxLayout")}}Object(e.a)(iG,"HeaderSkeleton",null,
[]);var sP=d(1218),hB=d(1168);class iB{constructor(){this.commandId=0;this.externalUxCommand=null}}Object(e.a)(iB,"CommandDefinition",null,[]);class jG{constructor(){this.addTabToMap=this.addIconToMap=this.addCommandToMaps=this.getDoNothingCommand=this.getCommandByExternalUxId=null}}Object(e.a)(jG,"CommandDefinitionMapping",null,[]);const tP=a=>Object.assign(new jG,{getCommandByExternalUxId:b=>{const c=a.getCommandByExternalUxId(b);return c?Object.assign(new iB,{commandId:parseInt(c.commandId),externalUxCommand:c.externalUxCommand}):
Object.assign(new iB,{externalUxCommand:b})},getDoNothingCommand:()=>parseInt(F.a.Ae),addCommandToMaps:Object(C.a)(a,a.addCommandToMaps,"addCommandToMaps"),addIconToMap:Object(C.a)(a,a.addIconToMap,"addIconToMap"),addTabToMap:Object(C.a)(a,a.addTabToMap,"addTabToMap")});var kG=d(917);class lG{}Object(e.a)(lG,"RibbonInitState",null,[]);var uP=d(386),mG=d(505);let ys;class up{static hrl(a){u.AFrameworkApplication.Aa.jb.hug||(a.ShowCommentsTopBar=!0);u.AFrameworkApplication.Aa.jb.Wtg||(a.CatchUpWithChanges=
!0)}static Rzh(a){for(let b of up.WOh)a[b]=!0}static kzl(a,b){var c=u.AFrameworkApplication.s3b;if(u.AFrameworkApplication.fa.Kw(c)&&u.AFrameworkApplication.fa.Ga(c)){up.Rzh(b);c=u.AFrameworkApplication.fa.XB("HostDefinedUIControls");for(let f=0;f<c.length;f++)up.lzl(a,b,c[f]);up.crl(b);up.brl(b)}}static lzl(a,b,c){if(c.id in a){a=a[c.id];for(let f of a)1===c.visibility?b[f]=!1:c.visibility||(b[f]=!0)}}static crl(a){a.HostMoreOptions=a.HostOpenInBrowser&&a.HostOpenInClient&&a.HostDownload?!0:!1}static jta(){const a=
u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.FJ);return!!a&&"teams"===a.toLowerCase()}static Lbl(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)}static ncl(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeamsCollabDeclutterIsEnabled",!1)||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsPeripheralOverflowScalingEnabled",!1)}static brl(a){up.jta()&&
(up.Lbl()&&(a.HostOpenInClient=!1),up.ncl()&&(a.HostMoreOptions=!0))}}up.WOh=(ys=new Ha.a,ys.add("HostOpenInClient"),ys.add("HostConversation"),ys.add("HostClose"),ys.add("HostDownload"),ys.add("HostOpenInBrowser"),ys.add("HostMoreOptions"),ys);Object(e.a)(up,"CommandTrimmer",null,[]);class nG{constructor(){}flatten(a){const b=[];for(const c of a)b.push.apply(b,c);return b}}Object(e.a)(nG,"ReactAsyncDispatcher",null,[]);class jB{}jB.Gfc="PageId";Object(e.a)(jB,"FileMenuSQMProperties",null,[]);class oG{constructor(a,
b){this.nq=null;this.Kxc=!1;this.oMa=0;this.hef="";this.trd={};this.rzd=a;this.Kd=b;this.dif=Object(C.a)(this,this.$xe,"onModalMouseWheel");this.xcf=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.m8;this.C1=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.iEa}vDb(){0<this.oMa?this.oMa++:(this.oMa++,u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DelayMenuFocusActionsUntilNextFrame",!1)?window.requestAnimationFrame(()=>{window.setTimeout(Object(C.a)(this,
this.g$g,"pushTransientFocusScope"),0)}):this.g$g(),this.showModal())}g$g(){this.Kd&&this.Kd.NX(y.AFrame.tO,!0)}r0i(){const a=Lg.f(),b=appChrome.selectors.getShyState();return String.format("{0}{1}",a,this.xcf&&b.isActive&&1===b.state?"_ShyRibbon":"")}rij(a){var b=0;if(this.C1){if(this.trd[a])return this.trd[a];(b=document.getElementById("BusinessBar"))||Z.ULS.sendTraceTag(524142489,340,10,"Failed to propertly get region composer Business Bar Region for setting up Modal Div");b=b?b.offsetTop:0;this.trd[a]=
b}return b}showModal(){if(!this.nq)if(this.nq=this.createElement("div"),this.nq.setAttribute("id","ReactModalDiv"),this.nq.style.position="absolute",this.nq.style.bottom="0px",this.nq.style.left="0px",this.nq.style.right="0px",this.nq.style.backgroundColor="white",this.nq.style.opacity="0.0",this.C1){var a=document.getElementById("regionComposerRoot");a&&a.appendChild(this.nq)}else this.rzd.appendChild(this.nq);a=this.r0i();if(a!==this.hef){const b=this.rij(a),c=appChrome.selectors.getShyState();
this.xcf&&c.isActive&&1===c.state&&Lg.a("getRibbonHeight")?this.nq.style.top=String.format("{0}px",b+appChrome.api.getRibbonHeight(Lg.f())):this.nq.style.top=String.format("{0}px",b);this.hef=a}this.nq.style.display="block";this.nq.style.visibility="visible";this.nq.style.zIndex="1000";this.Kxc||(window.addEventListener("wheel",this.dif,!0),this.zUc()?Uf.a.instance.ob(ma.a.XQ,this.nq,Object(C.a)(this,this.I9c,"onModalPointerUp")):Uf.a.instance.ob(ma.a.pointerDown,this.nq,Object(C.a)(this,this.H9c,
"onModalPointerDown")),this.Kxc=!0)}Vnk(){this.oMa--;0<this.oMa||(0>this.oMa?this.oMa=0:this.omg())}Wwe(){this.oMa=0;this.STd();this.omg()}createElement(a){a=document.createElement(a);a.setAttribute("unselectable","on");return a}nmg(){this.Kd&&this.Kd.ze&&this.Kd.ze.name===y.AFrame.tO&&!u.AFrameworkApplication.pe.$v&&this.Kd.R4(y.AFrame.tO,!1);this.nq&&(this.nq.style.zIndex="-1",this.nq.style.visibility="hidden",this.nq.style.display="none");this.Kxc&&(window.removeEventListener("wheel",this.dif,
!0),this.zUc()?Uf.a.instance.xb(ma.a.XQ,this.nq,Object(C.a)(this,this.I9c,"onModalPointerUp")):Uf.a.instance.xb(ma.a.pointerDown,this.nq,Object(C.a)(this,this.H9c,"onModalPointerDown")),this.Kxc=!1)}omg(){this.zUc()?window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.nmg()},0)}):this.nmg()}H9c(){this.OYb();this.wZf();this.Wwe();this.WIa();return!0}I9c(){this.OYb();this.wZf();this.Wwe();window.requestAnimationFrame(()=>{window.setTimeout(()=>{this.WIa()},0)});return!0}WIa(){4===u.AFrameworkApplication.Aa.jb.rm&&
u.AFrameworkApplication.fa.ka("OneNoteAutoSwitchToTypeWhileInkingIsEnabled")?u.AFrameworkApplication.Aa.WIa():this.Kd.Bf(y.AFrame.PV)}$xe(a){a.stopPropagation()}OYb(){const a=fb.a.instance.qb("Common.IReactContextualUILauncher");a&&a.OYb()}STd(){const a=fb.a.instance.qb("Common.IReactContextualUILauncher");a&&a.STd()}wZf(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.hEa&&(this.zUc()?appChrome.selectors.getFileMenuExpanded():1)&&appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1))}zUc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactModalDivPerfImprovements",
!1)}}Object(e.a)(oG,"ReactModalDiv",null,[]);var sn=d(525);class pG{constructor(a,b){this.JXh=a;this.jLh=b}}Object(e.a)(pG,"ReactExecuteCommandContext",null,[]);class uv{}uv.Color="Color";uv.IndexColorSelected="ColorSelected";Object(e.a)(uv,"ColorPickerCommandProperties",null,[]);var bo=d(913);class co{}co.SelectedFont="SelectedFont";co.Formatting="Format";co.RequestUpdateMru="RequestUpdateMru";co.FontPickerId="fontPickerId";co.IsPinned="IsPinned";co.Trigger="Trigger";Object(e.a)(co,"FontPickerCommandProperties",
null,[]);class ap{}ap.Trigger="FontTrigger";ap.Name="FontName";ap.Action="FontAction";ap.Level="FontLevel";ap.IsPinned="FontIsPinned";Object(e.a)(ap,"FontPickerLogProperties",null,[]);class Yw{}Yw.Rows="Rows";Yw.Columns="Columns";Object(e.a)(Yw,"InsertTableCommandProperties",null,[]);class Vm{}Vm.Alt="Alt";Vm.Number="Number";Vm.UnitType="UnitType";Vm.Text="Text";Vm.MaxValue="MaxValue";Object(e.a)(Vm,"SpinnerCommandProperties",null,[]);class qG{constructor(a,b,c,f,l,x,G,R,fa,wa=null,Wa=null){this.z1a=
null;this.Hwf=!1;this.Itd=[];this.Wrc=-1;this.uzc=!1;this.sYh=0;this.sMb=null;this.Csf=!1;this.hP=a;this.QMa=b;this.Vuf=Object(ua.a)(1502,a);this.hn=c;this.Kd=f;l&&(this.z1a=new oG(l,f));this.fWh=x;this.HNh=G;this.PR=wa;this.Ca=R;this.l1a={};this.eb=fa;this.FXe=Wa;fa&&(fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnqueueTasksWhenTaskMgrIsYielding",!1)||fa.ka("EnqueueTasksWhenTaskMgrIsYielding"))&&Gh.a.instance.RGf.CWR(()=>this.Hwf=!0);fa&&(a=this.eb.Ga("CommandControlIdPairsForLoggingOverride")||
"")&&0<=a.trim().length&&({ou:this.sMb}=Yd.d(a));this.sMb||(this.sMb={})}get ylh(){return!!window.appChrome&&!!appChrome.selectors}Dkh(){-1!==this.Wrc&&window.clearTimeout(this.Wrc);this.Wrc=window.setTimeout(()=>{for(this.Wrc=-1;0<this.Itd.length;){if(El.a.instance.$v){this.Dkh();break}const a=this.Itd.shift();a&&this.executeCommand(a.JXh,a.jLh)}},0)}executeCommand(a,b){if(El.a.instance.$v){if(this.Hwf){this.Itd.push(new pG(a,b));this.Dkh();return}Z.ULS.sendTraceTag(561394496,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",
a,b.modelType,ta.a.toJSON(b.payload));if(this.eb.ka("WordEditorReactExecuteYieldReturnIsEnabled"))return}if(b){const c=this.hn.getCommandByExternalUxId(a),f=b.modelType;this.FXe&&this.FXe.JXj(a,b);c?this.vPi(a,c,f,b):this.wPi(a,f,b);this.eni(b);this.Hck(a,b)}}wPi(a,b,c){switch(b){case "GalleryModel":case "PreviewGalleryModel":this.K2f(c,a)}}Hxl(a,b,c,f,l){if(c.payload)switch(c.payload.type){case "CoauthorMenuPayload":a.MenuItemId=c.payload.coauthorId;break;case "ButtonPayload":a.MenuItemId=b.menuItemId;
a.CommandValueId=c.payload.commandValueId;this.A4a();break;case "ButtonPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandPreviewId;break;case "ButtonRevertPreviewPayload":a.MenuItemId=b.menuItemId;a.CommandValueId=c.payload.commandValueId;l=b.commandRevertId;break;default:a.MenuItemId=b.menuItemId}else a.MenuItemId=b.menuItemId;a.SourceControlId=f;return l}Ixl(a,b,c){if(b.payload)switch(b.payload.type){case "MenuOpenPayload":a=this.hn.getCommandByExternalUxId("TellMeLogMenuOpen").commandId;
break;case "MenuClosePayload":a=this.hn.getCommandByExternalUxId("TellMeLogMenuClose").commandId;break;case "TellMeMenuItemExecuted":c.CommandId=b.payload.executedControl;c.ControlId=b.payload.executedControl;c.ParentControlId=b.payload.parentControl;c.CloseAllMenus=!0;this.A4a();break;case "TellMeSearchResultChangePayload":c.Value=b.payload.searchText;break;case "SmartLookupPayload":c.CommandValueId=b.payload.selectionContextJson}return a}vPi(a,b,c,f){var l=this.syk(f,c),x=b.commandId;const G={},
R={};switch(c){case "SplitButtonModel":if(this.D2b(f.payload,Object(C.a)(this,this.Jyl,"updateSplitButtonMenuState"),l))return;G.MenuItemId=b.menuItemId;this.PLe(f,G);break;case "StatefulSplitButtonModel":if(this.D2b(f.payload,Object(C.a)(this,this.Nyl,"updateStatefulSplitButtonMenuState"),l))return;c=f.payload.statefulData;l=f.payload.statefulMode;"color"===l?G.Color=c:"icon"===l&&(c=this.hn.getCommandByExternalUxId(c))&&(G.MenuItemId=c.menuItemId);break;case "FileMenu":G.MenuItemId=b.menuItemId;
G.SourceControlId=a;f.payload&&"FileMenuPageSwitchPayload"===f.payload.type&&this.Jnj(x,f.payload,a);break;case "TellMe":x=this.Ixl(x,f,G);G.SourceControlId=a;G.Location=f.payload.location;break;case "ButtonModel":f.payload&&"TabSwitchPayload"===f.payload.type?this.Qrj(G,f):x=this.Hxl(G,b,f,a,x);break;case "CompoundButtonModel":G.MenuItemId=b.menuItemId;G.CommandValueId=f.payload.commandValueId;G.SourceControlId=a;this.PLe(f,G);this.A4a();break;case "ToggleButtonModel":case "InkButtonModel":G.MenuItemId=
b.menuItemId;G.SourceControlId=a;this.PLe(f,G);this.A4a();break;case "FontPickerModel":switch(f.payload.type){case "MenuOpenPayload":return;case "MenuClosePayload":x=this.hn.getCommandByExternalUxId("FontPickerMenuClose").commandId;G[co.FontPickerId]=f.payload.launcherId;break;case "FontPickerFontSelectedPayload":c=f.payload.font;l=null;"string"===typeof c?(l=ia.FontUtils.HF(c),G.CommandValueId=l,l=ia.FontUtils.PGc(l)):(c.data?(G.CommandValueId=c.data.fontToApply,G.MenuItemId=c.data.themeIndex,G[co.Formatting]=
c.data):G.CommandValueId=c.name,l=c);G.SourceControlId=a;G[co.RequestUpdateMru]=l;R[ap.Name]=f.payload.nameToLog?f.payload.nameToLog:"string"===typeof c?ia.FontUtils.mTc(c)?"*"+c:ia.FontUtils.P$d(c)?"[EF]":"[MF]":"";R[ap.IsPinned]=f.payload.isPinned;R[ap.Level]=f.payload.level;this.Jee();break;case "FontPickerFontInfoRequestedPayload":G.CommandValueId=f.payload.font.name;G[co.Trigger]=f.payload.trigger;R[ap.Trigger]=f.payload.trigger;R[ap.Name]=f.payload.nameToLog;this.Jee();break;case "FontPickerFontPinningPayload":c=
f.payload.isPinned;G.CommandValueId=f.payload.fontKey;G[co.IsPinned]=c;R[ap.Name]=f.payload.nameToLog;R[ap.Action]=c?"pin":"unpin";R[ap.Level]=f.payload.level;this.Jee();break;default:return}break;case "ComboBoxModel":var fa=f.payload.type;switch(fa){case "MenuOpenPayload":case "MenuPopulatePayload":this.jIb(f.payload.launcherId,l)&&(x={},x[f.payload.launcherId]=c,this.QMa.qgc(x,Lg.g(f.payload)),this.l1a[a]=new Date);return;case "MenuClosePayload":return;case "ComboBoxPayload":case "ComboBoxPreviewPayload":c=
f.payload.newValue;if(!c)return;c.value?(G[bo.a.Value]=c.value,G[bo.a.IsFreeForm]=!0):(G[bo.a.Value]=c.text,G.MenuItemId=c.key,G.CommandValueId=c.commandValueId);"ComboBoxPreviewPayload"===fa&&(x=b.commandPreviewId);break;case "ComboBoxRevertPreviewPayload":x=b.commandRevertId;break;default:return}break;case "FlyoutAnchorModel":switch(f.payload.type){case "ZeroTermContextMenuClosePayload":c=ta.a.JK(f.payload);for(fa of c)G[fa]=f.payload[fa];break;default:this.D2b(f.payload,Object(C.a)(this,this.Awl,
"updateFlyoutAnchorMenuState"),l),G.launcherId=f.payload.launcherId}break;case "InkFlyoutAnchorModel":this.D2b(f.payload,Object(C.a)(this,this.Uwl,"updateInkFlyoutAnchorMenuState"),l);G.launcherId=f.payload.launcherId;break;case "ColorPickerModel":switch(f.payload.type){case "ColorPickerPayload":G[uv.Color]=f.payload.selectedColorId;break;case "ColorPickerPreviewPayload":x=b.commandPreviewId;G[uv.Color]=f.payload.selectedColorId;break;case "ColorPickerRevertPreviewPayload":x=b.commandRevertId;break;
default:return}break;case "SpinButtonModel":G[Vm.Number]=f.payload.value;G[Vm.UnitType]=we.a.iXb(f.payload.unitType.toLowerCase());G[Vm.Text]=f.payload.reservedValue;break;case "SliderModel":G[$o.Value]=f.payload.value;break;case "InsertTableModel":G[Yw.Rows]=f.payload.rows;G[Yw.Columns]=f.payload.columns;break;case "CheckboxModel":G[ai.a.On]=f.payload.checked;G.MenuItemId=b.menuItemId;break;case "PreviewGalleryModel":if(this.D2b(f.payload,Object(C.a)(this,this.Sxl,"updatePreviewGalleryMenuState"),
l)){G.launcherId=f.payload.launcherId;break}this.K2f(f,a);return;case "DocumentTitleModel":switch(f.payload.type){case "DocumentTitleRenamePayload":G.getNewDocumentTitle=f.payload.getNewDocumentTitle;break;case "MenuOpenPayload":x={};x[f.payload.launcherId]=c;this.QMa.qgc(x,Lg.g(f.payload));this.l1a[a]=new Date;return;case "MenuClosePayload":return;default:return}break;case "MRUCompoundButtonModel":G.MenuItemId=f.payload.url;this.pYj(f.payload.pageId);break;case "NewBlankDocumentModel":case "CustomTemplateModel":G.MenuItemId=
f.payload.assetId;G.SourceControlId=a;u.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&(G.IsPremium=f.payload.isPremium||!1);this.qYj(f.payload.pageId);break;case "CoauthorGallery":G.RenderTime=f.triggerTime;break;case "PeopleWell":G.RenderTime=f.triggerTime;break;case "SyncStatus":G.SourceControlId=a;break;case "InputBoxModel":G.Text=f.payload.newValue;break;case "PersonaButtonModel":G.CommandValueId=f.payload.commandValueId;this.Epj(f.payload);break;default:return}x&&
!this.isShadowMenuOpen(f.payload)&&(G.CommandValueId||(G.CommandValueId=G.MenuItemId),b.legacyControlId&&(G.LegacyId=b.legacyControlId),G.SourceControlId||(G.SqmControlId=a),this.eb&&this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&G.launcherId&&(b=this.hn.getCommandByExternalUxId(G.launcherId))&&(G.launcherCommandId=parseInt(b.commandId)),f.payload&&!Zk.b(f.payload.PRIReadinessCheck)&&(G.PRIReadinessCheck=f.payload.PRIReadinessCheck,this.Csf=!0),f.payload&&
!Zk.b(f.payload.shouldTakeFocus)&&(G[sn.a.ffa]=f.payload.shouldTakeFocus),b=this.yDf(f,G),Zk.b(f.triggerTime)||(R.TriggerTime=f.triggerTime),f.payload&&!Zk.b(f.payload.userActionKey)&&(R.userActionKey=f.payload.userActionKey),this.Imh(R,f,a,x),this.Vuf.executeCommand(x,G,this.getSelectedTabId(),b,!0,()=>{this.OVg(G,a)},R,Lg.g(f.payload)))}Imh(a,b,c,f){this.eb&&this.eb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableControlIdLoggingInUserActions",!1)&&c&&f&&(c=b.payload&&!Zk.b(b.payload.launcherId)?
b.payload.launcherId:c,a.ControlId=this.Xjh(this.K$i(c,f),f,!1));this.eb&&this.eb.ka("TerminalParentControlIdLoggingInUserActionsIsEnabled")&&b.payload&&"terminalParentControlId"in b.payload&&(a.TerminalParentControlId=this.Xjh(b.payload.terminalParentControlId,f,!0))}Xjh(a,b,c){if(RegExp("^[a-zA-Z0-9_]*$").test(a))return a;Z.ULS.sendTraceTag(510247689,207,15,c?"CommandId: "+b+" has a parentControlId that is non-alphanumeric and may need to be changed":"CommandId: "+b+" has a controlId that is non-alphanumeric and may need to be changed");
return"MalformedId"}K$i(a,b){b=parseInt(b);b=Kd.ActionManager.dPd(b)||Kd.ActionManager.k3a(b)||"";return!Zk.b(b)&&b in this.sMb?this.sMb[b]:100<a.length?"":a}Jee(){this.PR&&this.PR.execute(a=>{a.Aee("ModernFontPickerExperience")})}yDf(a,b){let c=2;a.payload&&"inputMethod"in a.payload&&a.payload.inputMethod&&(c=a.payload.inputMethod,b[sn.a.jv]=c);return c}OVg(a,b){const c=Object(ua.a)(y.AFrame,u.AFrameworkApplication.Aa);if(this.Kd&&this.Wqh(a)){if(!this.Kd.ze&&c){let f="null";if(a){const l=a.Value;
delete a.Value;f=ta.a.toJSON(a);Zk.b(l)||(a.Value=l)}Z.ULS.sendTraceTag(561394506,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",b,f,c.IIa)}this.Kd.WVi()}(this.Kd&&this.Kd.ze&&this.Kd.ze.name!==y.AFrame.tO&&c&&this.Kd.ze.name!==c.IIa||this.Wqh(a))&&this.eri(a)}Wqh(a){return!!a&&!Zk.b(a[sn.a.ffa])&&a[sn.a.ffa]}eri(a){sn.a.jv in a&&1===a[sn.a.jv]&&Ww.ShyRibbon.uOa(1,0)}Qrj(a,b){Lg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.CloseMenuOnUnmount")&&this.A4a();this.hP.pgc();if(this.fWh&&this.Ca){const c={};c[Ky.Jwh]=b.payload.tabId;this.Ca.La(F.a.ifd,2,c,this.rPc(b));Zk.b(b.payload.inputMethod)||(this.Ca.processAction(F.a.ehh,2),this.uzc||this.xfl(b.payload.tabId))}b=b.payload.tabId;a.NewContextId=b;a.NewContextCommand=this.hn.I3d(b);Z.ULS.sendTraceTag(561394507,340,50,"HandleTabSwitch tabId: "+b);if(this.PR&&b){const c=b+"TabSwitchActivity";this.PR.execute(f=>
{f.Aee(c)})}}D2b(a,b,c){const f=a.type;return"MenuClosePayload"===f?!0:"MenuOpenPayload"===f?(b(a,c),!0):!1}Epj(a){a=a.type;"MenuOpenPayload"===a?u.AFrameworkApplication.kwh=!0:"MenuClosePayload"===a&&(u.AFrameworkApplication.kwh=!1)}syk(a,b){if(!a.payload||!a.payload.launcherId||"MenuOpenPayload"!==a.payload.type&&"MenuPopulatePayload"!==a.payload.type)return!1;const c=a.payload.launcherId,f=this.hn.getCommandByExternalUxId(c);return f&&f.populationProps?((a=this.QMa.QAe(f,b,a.payload))&&c in this.l1a&&
delete this.l1a[c],a):!1}Awl(a,b){const c=a.launcherId;this.jIb(c,b)&&(b=appChrome.selectors.getFlyoutAnchorMenuItems(c),this.EKb(b,c,Lg.g(a)))}Uwl(a,b){const c=a.launcherId;this.jIb(c,b)&&(b=Lg.j("getInkFlyoutAnchorMenuItems")?appChrome.selectors.getInkFlyoutAnchorMenuItems(c):appChrome.selectors.getFlyoutAnchorMenuItems(c),this.EKb(b,c,Lg.g(a)))}Sxl(a,b){const c=a.launcherId;this.jIb(c,b)&&(b=appChrome.selectors.getPreviewGalleryMenuItems(c),this.EKb(b,c,Lg.g(a)))}Jyl(a,b){const c=a.launcherId;
this.jIb(c,b)&&(b=appChrome.selectors.getSplitButtonMenuItems(c),this.EKb(b,c,Lg.g(a)))}Nyl(a,b){const c=a.launcherId;this.jIb(c,b)&&(b=appChrome.selectors.getStatefulSplitButtonMenuItems(c),this.EKb(b,c,Lg.g(a)))}getSelectedTabId(){return this.ylh?appChrome.selectors.getSelectedTabId():null}EKb(a,b,c){this.QMa.qgc(a,c);this.l1a[b]=new Date}jIb(a,b){let c=!0;a in this.l1a&&(c=this.l1a[a].getTime()<this.hP.TWc.getTime());return c&&!b&&this.ylh}K2f(a,b){const c={};var f=a.payload.selectedGalleryId;
const l=this.hn.getCommandByExternalUxId(f);if(l){c.SourceControlId=f;c.MenuItemId=l.menuItemId;c.SqmControlId=b;l.legacyControlId&&(c.LegacyId=l.legacyControlId);a.payload&&!Zk.b(a.payload.shouldTakeFocus)&&(c[sn.a.ffa]=a.payload.shouldTakeFocus);this.Kaj(a.payload,c);(f=this.rPc(a))||(f={});this.Imh(f,a,b,l.commandId);const x=this.yDf(a,c);this.Vuf.executeCommand(l.commandId,c,this.getSelectedTabId(),x,!0,()=>{this.OVg(c,b)},f,Lg.g(a.payload))}}Kaj(a,b){"CharacterGalleryPayload"===a.type&&(b.MenuItemId=
a.character)}PLe(a,b){a.payload&&"toggled"in a.payload&&(b[ai.a.On]=a.payload.toggled)}Hck(a,b){"MenuOpen"===a?!this.z1a||"isShadowRendering"in b.payload&&b.payload.isShadowRendering||this.z1a.vDb():"MenuClose"===a&&this.z1a&&this.z1a.Vnk()}A4a(){this.z1a&&this.z1a.Wwe()}rPc(a){let b=null;Zk.b(a.triggerTime)||(b={},b.TriggerTime=a.triggerTime);return b}Jnj(a,b,c){if(this.HNh&&this.Ca){const f={};f[jB.Gfc]=c;this.Ca.La(F.a.FUk,2,f)}this.EKb(b.pageControlIdMap,a,Lg.g(b))}qYj(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(F.a.UUk,
2);break;case "FileNewPage":this.Ca.processAction(F.a.VUk,2)}}pYj(a){if(this.Ca)switch(a){case "FileHomePage":this.Ca.processAction(F.a.NUk,2);break;case "FileOpenPage":this.Ca.processAction(F.a.OUk,2)}}isShadowMenuOpen(a){return!!a&&"MenuOpenPayload"===a.type&&a.isShadowRendering}xfl(a){if(u.AFrameworkApplication.fa.ka("TellMeHelpCoachMarkActivityEnabled")&&"Help"===a)this.PR.execute(b=>{b.logActivity("TellMeHelpCoachMarkActivity",null)}),this.uzc=!0;else{if(u.AFrameworkApplication.fa.ka("TellMe3TabSwitchCoachMarkActivityEnabled")&&
(this.PR.execute(b=>{b.logActivity("TellMe3TabSwitchCoachMarkActivity",null)}),3===++this.sYh)){this.uzc=!0;return}u.AFrameworkApplication.fa.ka("TellMe1TabSwitchCoachMarkActivityEnabled")&&32===this.Ca.processAction(F.a.xhb,2)&&(this.uzc=!0)}}eni(a){a&&a.payload&&a.payload.PRIReadinessCheck&&!this.Csf&&appChrome.PRIToastManager.dismissToast()}}Object(e.a)(qG,"ReactExecuteCommandHandler",null,[]);class rG{constructor(){this.fileMenu=null}get TVe(){return 0}fYa(){}fra(){return!1}V0(){return!1}get nlh(){return null}h5(){}u$d(){return!1}dOa(){}NPa(){}refresh(){}get controls(){return null}AFc(){}pgc(){}get r$(){return null}set r$(a){}get inKeytipMode(){return!1}enterKeytipMode(){}exitKeytipMode(){}}
Object(e.a)(rG,"ReactRibbonExternal",null,[1152,1487,1488]);var vP=d(269);class sG{constructor(a,b,c,f){this.Kd=a;this.Ca=b;this.wBf=c;this.Nmb=f}initialize(){this.Ca.ya(F.a.ekc,xd.a.frame,Object(C.a)(this,this.Eih,"ribbonMoveForwardAction"));this.Ca.ya(F.a.dkc,xd.a.frame,Object(C.a)(this,this.Dih,"ribbonMoveBackwardAction"));this.Ca.ya(F.a.Nfd,xd.a.frame,Object(C.a)(this,this.Cih,"ribbonEscAction"));var a=Er.a.j8d(this.Nmb,null,this.wBf,!1);a.cL=!0;this.rFb(a,F.a.ekc,F.a.dkc);a.bindAction(A.KeyInputManager.Na(w.a.Z0,
0),F.a.Nfd);a=this.Kd.Dc(y.AFrame.tO);a.cL=!0;this.rFb(a,F.a.ira,F.a.ira);ja.a.instance.ob(ma.a.mouseDown,this.wBf,Object(C.a)(this,this.Npk,"onRibbonMouseDown"));a=vP.a.instance;Lg.a("enterKeytipMode")&&a.uHb(this.Nmb,()=>{appChrome.api.enterKeytipMode(!1)});Lg.a("exitKeytipMode")&&a.blc(this.Nmb,()=>{appChrome.api.exitKeytipMode();Ww.ShyRibbon.uOa(1,0)});u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.m8&&(a=Object(ua.a)(v.FocusManager,this.Kd))&&a.s6h(Object(C.a)(this,this.mmk,"onFocusScopeChanged"))}mmk(a,
b){if((a=Object(ua.a)(y.AFrame,u.AFrameworkApplication.Aa))&&b.XWg&&u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.m8){const c=appChrome.selectors.getShyState();c.isActive&&b.XWg.name===a.IIa&&Ww.ShyRibbon.uOa(c.state,1)}}Eih(){return 4}Dih(){return 4}Cih(){Lg.a("inKeytipMode")&&!appChrome.api.inKeytipMode()&&(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.m8&&appChrome.selectors.getShyState().isActive&&Ww.ShyRibbon.uOa(1,0),this.Kd.Bf(y.AFrame.PV));return 4}rFb(a,b,c){const f=
A.KeyInputManager.Na(w.a.Iq,0),l=A.KeyInputManager.Na(w.a.Iq,4);a.np(f);a.np(l);a.bindAction(f,b);a.bindAction(l,c)}Npk(a){a.mc&&a.mc.target&&"input"!==a.mc.target.tagName.toLowerCase()&&a.mc.preventDefault();return!1}dispose(){this.Ca.uO(F.a.ekc,xd.a.frame,Object(C.a)(this,this.Eih,"ribbonMoveForwardAction"));this.Ca.uO(F.a.dkc,xd.a.frame,Object(C.a)(this,this.Dih,"ribbonMoveBackwardAction"));this.Ca.uO(F.a.Nfd,xd.a.frame,Object(C.a)(this,this.Cih,"ribbonEscAction"))}}Object(e.a)(sG,"ReactRibbonFocusManager",
null,[106]);class kB{constructor(){this.CommandLocation=0;this.CommandTabName=null;this.InvocationMethod=0}}Object(e.a)(kB,"CommandSqmInfo",null,[]);var Zw=d(347),$w;(function(a){a[a.UnspecifiedGallery=0]="UnspecifiedGallery";a[a.CharacterCodeGallery=1]="CharacterCodeGallery";a[a.FontStyleGallery=2]="FontStyleGallery";a[a.InkThicknessGallery=3]="InkThicknessGallery";a[a.IconGallery=4]="IconGallery";a[a.ListGallery=5]="ListGallery";a[a.TableStyleGallery=6]="TableStyleGallery";a[a.PageNumberGallery=
7]="PageNumberGallery";a[a.ChangeColorsGallery=8]="ChangeColorsGallery"})($w||($w={}));Object(e.b)("GalleryType",$w);class wo{constructor(){this.title=this.style=this.hidden=this.disabled=null}}Object(e.a)(wo,"CommonGalleryButtonProps",null,[]);class Py extends wo{constructor(){super();this.tableStyles=this.tableCellStyles=null;this.columns=0}}Object(e.a)(Py,"AdditionalTableStyleGalleryButtonProps",wo,[]);class tG extends Py{constructor(){super()}}Object(e.a)(tG,"AdditionalChangeColorsGalleryButtonProps",
Py,[]);class uG extends wo{constructor(){super();this.character=null}}Object(e.a)(uG,"AdditionalCharacterCodeGalleryButtonProps",wo,[]);class vG extends wo{constructor(){super();this.previewStyleLabel=this.styleDisplayName=null}}Object(e.a)(vG,"AdditionalFontStyleGalleryButtonProps",wo,[]);class wG{constructor(){this.selectedId=this.sections=this.hidden=this.disabled=null;this.level=this.columns=0;this.styles=null;this.galleryType="TableStyleGallery"}}Object(e.a)(wG,"AdditionalGalleryProperties",
null,[]);class xG extends wo{constructor(){super();this.largePreviewIconStyle=this.largeFullIconStyle=this.keytip=this.previewIconStyle=this.fullIconStyle=this.label=this.icon=null}}Object(e.a)(xG,"AdditionalIconButtonProperties",wo,[]);class yG extends wo{constructor(){super();this.styleDisplayName=null}}Object(e.a)(yG,"AdditionalInkThicknessGalleryButtonProps",wo,[]);class zG extends wo{constructor(){super();this.ariaLabel=this.infoAtLevel=null}}Object(e.a)(zG,"AdditionalListGallerButtonProps",
wo,[]);class AG extends wo{constructor(){super();this.text=null}}Object(e.a)(AG,"AdditionalPageNumberGalleryButtonProps",wo,[]);var Qy=d(658),gm=d(914),BG=d(1088);class lB{}lB.Text="Text";Object(e.a)(lB,"TextBoxCommandProperties",null,[]);var um=d(300);const wP=(a,b)=>{var c=appChrome.selectors.getActiveControlStates();if(c=Object(ua.a)(Object,c[a])){if((a=Object(ua.a)(String,c.value))&&a===b)return!1;a=Object(ua.a)(String,c.selectedKey);if(!b&&!a)return!1;if(a){c=Array.isArray(c.options)?c.options:
null;let f=null;for(let l=0;l<c.length;l++){const x=Object(ua.a)(Object,c[l]);if(Object(ua.a)(String,x.key)===a){f=x;break}}if(f&&Object(ua.a)(String,f.text)===b)return!1}}return!0},DG=(a,b,c,f)=>{if(0<(f&2)){f=[];switch(b){case "ToggleButtonModel":case "InkButtonModel":f.push(Ry(a,c[ai.a.On]));break;case "CheckboxModel":f.push(appChrome.actions.toggleCheckbox(a,c[ai.a.On]));break;case "ComboBoxModel":if(u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||
u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1))&&!wP(a,c[bo.a.Value]))break;(b=c[bo.a.Key])?f.push(appChrome.actions.updateComboBoxKey(a,b,c[bo.a.Value])):f.push(appChrome.actions.updateComboBoxValue(a,c[bo.a.Value]));break;case "FontPickerModel":f.push(appChrome.actions.updateFontPickerSelectedFont(a,c[co.SelectedFont]));break;case "SplitButtonModel":f.push(Ry(a,c[BG.a.On]));break;case "SpinButtonModel":f.push(appChrome.actions.updateSpinButton(a,
c[Vm.Number],we.a.jXb(c[Vm.UnitType]),c[Vm.Text],c[Vm.MaxValue],c[Vm.Alt]));break;case "ColorPickerModel":f.push(appChrome.actions.updateColorPickerSelectedColor(a,c[uv.IndexColorSelected]));break;case "PageNumberGalleryButtonModel":f.push(appChrome.actions.updatePageNumberGalleryButtonText(a,c[gm.a.Text]));break;case "CompoundButtonModel":c[ai.a.Description]&&f.push(appChrome.actions.updateCompoundButtonDescription(a,c[ai.a.Description]));ai.a.On in c&&f.push(Ry(a,c[ai.a.On]));break;case "SliderModel":c.snapToStep?
f.push(appChrome.actions.updateSliderSelectedValue(a,c[$o.Value])):f.push(appChrome.actions.updateSliderValue(a,c[$o.Value],c[$o.MinValue]||0,c[$o.MaxValue],c[$o.Text]));break;case "FlyoutAnchorModel":Qy.a.ImageIsVisible in c&&f.push(appChrome.actions.hideFlyoutAnchorIcon(a,!c[Qy.a.ImageIsVisible]));ai.a.On in c&&f.push(Ry(a,c[ai.a.On]));break;case "InputBoxModel":f.push(appChrome.actions.updateInputBoxValue(a,c[lB.Text]))}b=f;var l=Object(ua.a)(String,c[um.a.iconColor]);void 0!==l&&null!==l&&b.push(appChrome.actions.updateIconColor(a,
l));CG(a,c,f);b=f;(l=Object(ua.a)(Object,c[um.a.IconSet]))&&b.push(appChrome.actions.setControlIconSet(a,l));b=f;l=Object(ua.a)(String,c[um.a.customTooltip]);void 0!==l&&null!==l&&b.push(appChrome.actions.setControlCustomTooltip(a,l));a=f;(c=Array.isArray(c[um.a.Ych])?c[um.a.Ych]:null)&&a.push.apply(a,c);return f}return null},Tt=(a,b)=>appChrome.actions.updateControlEnabledDisabledState(a,b),Ry=(a,b)=>appChrome.actions.toggleButton(a,b),CG=(a,b,c)=>{b=Object(ua.a)(String,b[um.a.Icon]);void 0!==b&&
null!==b&&c.push(appChrome.actions.setControlIcon(a,b))};class EG{constructor(a,b,c,f){this.hn=f;this.ppa=a;this.fK=b;this.Omb=c;this.qPb={}}Eyk(a,b,c,f,l=null){const x=a.ExternalGalleryId||a.ExternalId;var G=a.ExternalId;f.push(x);if(appChrome.selectors.isControlDefined(x))a.GalleryStyle&&Lg.d("setGalleryStyles")&&b.push(appChrome.actions.setGalleryStyles(x,a.GalleryStyle));else{if(4!==a.Type)return;c.push(appChrome.api.createGalleryModel(x,Object.assign(new wG,{columns:a.Width,sections:[appChrome.api.gallerySection([],
G)],styles:a.GalleryStyle,galleryType:"IconGallery"})))}c=0;f=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1));if(Lg.d("setGallerySections")&&a.GallerySections&&0<a.GallerySections.length){G=[];const fa=[],wa=[],Wa={};for(var R of a.GallerySections){G.push(appChrome.api.gallerySection([],R.SectionId,R.Title));0===c&&R.GalleryButtons&&
0<R.GalleryButtons.length&&(c=R.GalleryButtons[0].Type);f&&this.neg(R.GalleryButtons,l,Wa);const mb=this.LHd(fa,R.GalleryButtons,Wa);fa.push.apply(fa,this.m2d(mb,x,R.SectionId,!1,c,l,!0,Wa));wa.push.apply(wa,mb)}b.push(appChrome.actions.setGallerySections(x,G));b.push.apply(b,fa);b.push.apply(b,this.u0d(x,$w[c],wa,null,5===a.Type,!0,null,Wa))}else a.GalleryItems&&0<a.GalleryItems.length&&(c=a.GalleryItems[0].Type),R=f?this.neg(a.GalleryItems,l,null):null,b.push.apply(b,this.m2d(this.LHd(b,a.GalleryItems,
R),x,G,!1,c,l,!1,R))}Fbj(a,b){const c=[];let f=null,l=!1;if(!a)return null;const x=this.ppa.ogc(this.fK,a.commandId,b);c.push(Tt(a.externalUxCommand,!x));if(a.previewControlIds){const fa=[];for(let wa=0;wa<a.previewControlIds.length;wa++){var G={},R=a.previewControlIds[wa];G.SourceControlId=R;const Wa=this.hn.getCommandByExternalUxId(R);this.BOc(Wa||a,G);G[gm.a.On]&&(f=G.SourceControlId,G[gm.a.HighlightOn]&&(l=!0));CG(R,G,c);if(G=Object(ua.a)(Zw.a,G[gm.a.GalleryButtonProps]))fa.push(G),x&&(R=this.ppa.ogc(this.fK,
G.Command,b),G.IsDisabled=!R)}0<fa.length&&c.push.apply(c,this.m2d(this.LHd(c,fa),a.externalUxCommand,a.externalUxCommand,!0,fa[0].Type));c.push(appChrome.actions.updateGallerySelectedId(a.externalUxCommand,f));l&&(Z.ULS.sendTraceTag(561394453,340,50,"HighlightSelectedFontStyle fired for {0} button",f),c.push(appChrome.actions.highlightSelectedFontStyle(f)))}return c}LHd(a,b,c=null){const f=[],l=[];for(let G=0;G<b.length;G++){const R=b[G],fa=Zk.a(R.ExternalId)?R.Id:R.ExternalId;f.push(fa);const wa=
c&&c[fa]?c[fa].result:-1;switch(R.Type){case 1:var x=R;l.push(appChrome.api.createCharacterCodeGalleryButtonModel(fa,Object.assign(new uG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,character:x.Character,style:x.Style,title:x.Alt})));break;case 2:x=R;l.push(appChrome.api.createFontStylesGalleryButtonModel(fa,Object.assign(new vG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,styleDisplayName:x.LabelText,style:x.Style,title:x.Alt,previewStyleLabel:x.PreviewStyleLabel})));break;case 3:x=R;l.push(appChrome.api.createInkThicknessGalleryButtonModel(fa,
Object.assign(new yG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,styleDisplayName:x.LabelText,style:x.Style,title:x.Alt})));break;case 4:x=R;l.push(appChrome.api.createIconGalleryButtonModel(fa,Object.assign(new xG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,icon:[x.Icon],fullIconStyle:x.FullIconStyle,previewIconStyle:x.PreviewIconStyle,largePreviewIconStyle:x.LargePreviewIconStyle,label:x.LabelText,title:x.Alt})));break;case 5:x=R;l.push(appChrome.api.createListGalleryButtonModel(fa,Object.assign(new zG,
{disabled:-1!==wa?1>(wa&1):x.IsDisabled,infoAtLevel:x.LevelInfo,ariaLabel:x.Alt})));break;case 6:x=R;l.push(appChrome.api.createTableStyleGalleryButtonModel(fa,Object.assign(new Py,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,tableCellStyles:x.TableCellStyles,tableStyles:x.TableStyles,title:x.Alt,columns:x.columns})));break;case 8:x=R;l.push(appChrome.api.createChangeColorsGalleryButtonModel(fa,Object.assign(new tG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,tableCellStyles:x.TableCellStyles,tableStyles:x.TableStyles,
title:x.Alt})));break;case 7:x=R,l.push(appChrome.api.createPageNumberGalleryButtonModel(fa,Object.assign(new AG,{disabled:-1!==wa?1>(wa&1):x.IsDisabled,text:x.Text,title:x.Alt})))}this.hn.addCommandToMaps(Object.assign(new Ta.a(fa,R.Command),{queryCommandId:R.QueryCommand,menuItemId:R.MenuItemId}))}a.push(appChrome.actions.addControls(l));return f}m2d(a,b,c,f,l,x=null,G=!1,R=null){const fa=[];f?fa.push(appChrome.actions.populateGalleryItems(b,a)):(this.qPb[b]=!1,G||(f=!0,appChrome.selectors.isControlDefined(b)&&
(f=appChrome.selectors.getGalleryState(b),f=f.disableIndividualButtons?f.disableIndividualButtons:!0),fa.push.apply(fa,this.u0d(b,$w[l],a,null,5===l,f,x,R))),fa.push(appChrome.actions.updateGallerySectionItems(b,c,a)));return fa}j6i(a){return this.u0d(a.ExternalUxId,a.galleryType,a.items,a.sections,a.isListGallery,a.disableIndividualButtons?a.disableIndividualButtons:!0)}u0d(a,b,c,f,l,x=!0,G=null,R=null){const fa=[];if(a in this.qPb){if(this.qPb[a])return delete this.qPb[a],fa;this.qPb[a]=!0}let wa=
null,Wa=-1;if(c)({W7f:Wa,returnValue:wa}=this.qDf(b,c,fa,x,G,R));else if(f)for(const mb of f)(c=({W7f:Wa}=this.qDf(b,mb.galleryButtons,fa,x,null,R)).returnValue)&&(wa=c);fa.push(appChrome.actions.updateGallerySelectedId(a,wa));x&&fa.push(Tt(a,!1));l&&0<Wa&&fa.push(appChrome.actions.updateListGalleryTextDirection(a,2===Wa));return fa}meg(a,b=null){const c={},f={};f.SourceControlId=a;f.Location=b;a=this.hn.getCommandByExternalUxId(a);if(!a)return c.result=-1,c.props=f,c;a=this.BOc(a,f);c.result=a;c.props=
f;return c}neg(a,b=null,c=null){c||(c={});for(const f of a)a=Zk.a(f.ExternalId)?f.Id:f.ExternalId,c[a]=this.meg(a,b);return c}qDf(a,b,c,f,l=null,x=null){let G,R=null;G=-1;let fa=!1;for(const Wa of b){var wa=this.h6i(a);b=x&&x[Wa]&&-1!==x[Wa].result?x[Wa]:this.meg(Wa,l);const mb=b.result;b=b.props;f&&c.push(Tt(Wa,1>(mb&1)));(wa=DG(Wa,wa,b,mb))&&c.push.apply(c,wa);b[gm.a.On]&&(R=Wa,b[gm.a.HighlightOn]&&b[gm.a.HighlightOn]&&(fa=!0));void 0!==b[um.a.labelText]&&null!==b[um.a.labelText]&&(wa=this.hn.getCommandByExternalUxId(Wa),
c.push(appChrome.actions.setControlLabel(wa.externalUxCommand,b[um.a.labelText])));b[gm.a.IsRtl]&&0>G&&(G=b[gm.a.IsRtl])}fa&&(Z.ULS.sendTraceTag(561394456,340,50,"HighlightSelectedFontStyle fired for {0} button",R),c.push(appChrome.actions.highlightSelectedFontStyle(R)));return{returnValue:R,W7f:G}}h6i(a){switch(a){case "CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case "FontStyleGallery":return"FontStyleGalleryButtonModel";case "InkThicknessGallery":return"InkThicknessGalleryButtonModel";
case "IconGallery":return"IconGalleryButtonModel";case "ListGallery":return"ListGalleryButtonModel";case "TableStyleGallery":return"TableStyleGalleryButtonModel";case "ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case "PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"}BOc(a,b){b.MenuItemId=a.menuItemId;return this.ppa.gbd(this.fK,this.Omb,a.commandId,a.queryCommandId,b)}}Object(e.a)(EG,"ReactGalleryPoller",null,[]);var xP=d(576),Sy=d(775),yP=d(777);class mB extends Ef.a{constructor(){super()}get ControlType(){return 3}}
Object(e.a)(mB,"CompoundButtonProps",Ef.a,[]);class FG extends Ow.a{constructor(){super();this.OnRetryCommandId=this.RetryButtonTitle=this.IconName=this.Label=null}get ControlType(){return 12}}Object(e.a)(FG,"ErrorViewProps",Ow.a,[]);var tq=d(774);class GG{constructor(){this.initialPinnedFontKeys=this.mruList=this.fonts=this.commandId=null;this.isSubscriber=!1;this.previewFontFamily=null}}Object(e.a)(GG,"PopulateFontPickerDataProps",null,[]);var Fr=d(397);class HG extends qq{constructor(){super();
this.ariaDescription=this.lang=this.roleInMenu=this.styles=this.commandValueId=null}}Object(e.a)(HG,"OptionalCompoundButtonProperties",qq,[]);class IG extends qq{constructor(){super();this.onRetryCommandId=this.retryButtonTitle=null}}Object(e.a)(IG,"OptionalErrorViewProperties",qq,[]);class JG extends sv{constructor(){super();this.styles=this.secondaryText=null;this.flipIconInRtl=!1}}Object(e.a)(JG,"OptionalPersonaButtonProperties",sv,[]);class Ty extends qq{constructor(){super();this.toggled=!1;
this.roleInMenu=null;this.toggleUsingIcon=!1}}Object(e.a)(Ty,"OptionalToggleButtonProperties",qq,[]);var zP=d(916),AP=d(915),Uy=d(466);class KG{constructor(){this.nRf=this.actions=null;this.hGh=!1}}Object(e.a)(KG,"PopulateActions",null,[]);class nB{pgg(a,b){switch(b){case "ColorPickerModel":return appChrome.selectors.getColorPickerState(a);case "ToggleButtonModel":return this.Xbj(a);case "InkButtonModel":return this.Wbj(a);case "GalleryModel":return appChrome.selectors.getGalleryState(a);case "SplitButtonModel":return appChrome.selectors.getSplitButtonState(a);
case "SliderModel":return appChrome.selectors.getSliderState(a)}return{}}Xbj(a){const b={};b[ai.a.On]=appChrome.selectors.getButtonToggleState(a);return b}Wbj(a){const b={};b[ai.a.On]=Lg.j("getInkButtonToggleState")?appChrome.selectors.getInkButtonToggleState(a):appChrome.selectors.getButtonToggleState(a);return b}}Object(e.a)(nB,"ReactStatePropsSelector",null,[]);class Vy{constructor(a,b,c,f,l){this.ppa=a;this.fK=b;this.Omb=c;this.hn=f;this.NEd={};this.tVh=new nB;this.$1a=l}xth(a){const b=a.populationProps.populateQueryCommandId;
return a.populationProps.populateOnlyOnce&&b in this.NEd}tcj(a,b,c=null){const f=[],l={};if(!this.xth(a)){const x=a.populationProps.populateQueryCommandId,G={};G.MenuId=a.externalUxCommand;G.IsShadowMenuOpen=this.isShadowMenuOpen(c);if(0<(this.ppa.gbd(this.fK,this.Omb,x,x,G,this.t7i(c))&1))if("FontPickerModel"===b)this.NEd[x]=!0,f.push(Vy.qbj(a,G)),l[a.externalUxCommand]="FontPickerModel";else if(G.MenuItems)switch(this.NEd[x]=!0,b){case "ComboBoxModel":f.push(Vy.obj(a,G));l[a.externalUxCommand]=
"ComboBoxModel";break;case "FlyoutAnchorModel":case "InkFlyoutAnchorModel":case "PreviewGalleryModel":case "SplitButtonModel":case "StatefulSplitButtonModel":f.push.apply(f,this.Hhg(a.externalUxCommand,b,G.MenuItems,l,c&&"location"in c?c.location:null))}}return Object.assign(new KG,{actions:f,nRf:l,hGh:this.isShadowMenuOpen(c)})}Tcg(a,b,c,f,l,x,G,R,fa=null){let wa=null;const Wa=[];Zk.b(a.Title)||(wa=a.Title);for(let mb=0;mb<a.ControlList.length;mb++){const Kb=Object(ua.a)(Ow.a,a.ControlList[mb]);
if(!Kb||Kb.ExternalId)x&&this.H1i(Kb,x),b.push.apply(b,this.pbj(Kb,G,Wa,l,c,f,fa))}return R?appChrome.api.menuSection(Wa,wa,a.Lang):null}Hhg(a,b,c,f,l=null){const x=[],G=[],R=[],fa=[];for(var wa=0;wa<c.MenuSectionList.length;wa++){var Wa=Object(ua.a)(Mi.a,c.MenuSectionList[wa]);Wa&&(Wa=this.Tcg(Wa,x,a,b,fa,f,G,c.UpdateDynamically,l),c.UpdateDynamically&&R.push(Wa))}wa=null;c.MenuFooterSection&&(wa=this.Tcg(c.MenuFooterSection,x,a,b,fa,f,G,c.UpdateDynamically,l));c.UpdateDynamically&&x.push(appChrome.actions.updateMenu(a,
R,c.Title,c.AriaLabel,c.ShouldAutoOpen,c.AriaRoleDescription,c.MenuTargetDescriptor,wa));0<G.length&&x.splice(0,0,appChrome.actions.addControls(G));0<fa.length&&Lg.d("setStatefulSplitButtonMruBypassControls")&&x.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(a,fa));return x}H1i(a,b){switch(a.ControlType){case 1:case 3:b[a.ExternalId]=1===a.ControlType?"ButtonModel":"CompoundButtonModel";break;case 2:b[a.ExternalId]="ToggleButtonModel";break;case 6:b[a.ExternalId]="CheckboxModel";break;
case 7:b[a.ExternalId]="ColorPickerModel";a=Object(ua.a)(Sy.a,a);a.McuLayout&&(b[a.McuExternalId]="ColorPickerModel");break;case 9:b[a.ExternalId]="FlyoutAnchorModel"}}pbj(a,b,c,f,l,x,G=null){const R=[];switch(a.ControlType){case 1:case 3:f=Object(ua.a)(Ef.a,a);this.iyk(f,R,b,c);f.MenuItemsStatefulData&&Lg.d("setStatefulSplitButtonMenuItemsStatefulData")&&R.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(l,f.MenuItemsStatefulData));break;case 2:this.fzk(Object(ua.a)(Uy.a,a),R,b,
c);break;case 6:this.nyk(Object(ua.a)(xP.a,a),R,b,c);break;case 4:this.Uyk(Object(ua.a)(hp,a),R,b,c);break;case 7:this.oyk(Object(ua.a)(Sy.a,a),R,b,c);break;case 12:this.uyk(Object(ua.a)(FG,a),R,c);break;case 9:l=Object(ua.a)(gh.a,a);this.xyk(l,R,b,c);"StatefulSplitButtonModel"===x&&f.push(l.ExternalId);break;case 8:this.$1a.Eyk(Object(ua.a)(tq.a,a),R,b,c,G)}return R}iyk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,
a.LabelText)),a.Description&&b.push(appChrome.actions.updateCompoundButtonDescription(a.ExternalId,a.Description)),a.CommandValueId&&b.push(appChrome.actions.setButtonCommandValueId(a.ExternalId,a.CommandValueId)),this.aCc()&&((c=this.$ra(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Sp.a(c)).iconSet)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(a.Description||Object(Ma.a)(mB,a)?c.push(appChrome.api.createCompoundButtonModel(a.ExternalId,
a.LabelText,a.Description,Object.assign(new HG,{iconSet:(new Sp.a(this.$ra(a))).iconSet,keytip:a.KeyTip,roleInMenu:a.RoleInMenu,ariaDescription:a.AriaDescription,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createButtonModel(a.ExternalId,a.LabelText,Object.assign(new sv,{iconSet:(new Sp.a(this.$ra(a))).iconSet,keytip:a.KeyTip,supportsPreview:!!a.CommandPreviewId&&!!a.CommandRevertId,customTooltip:a.LabelText!==a.Alt?a.Alt:null,commandValueId:a.CommandValueId,shouldTakeFocus:a.ShouldTakeFocus}))),
this.hn.addCommandToMaps(Object.assign(new Ta.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand,commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));a.Lang&&Lg.d("setControlLanguage")&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}nyk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.aCc()&&((c=this.$ra(a))&&0<
c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Sp.a(c)).iconSet)),a.IsChecked&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.IsChecked)),a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Ty,{iconSet:(new Sp.a(this.$ra(a))).iconSet,keytip:a.KeyTip,toggled:a.IsChecked,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==
a.Alt?a.Alt:null,toggleUsingIcon:!!a.CheckedImageClass}))),this.hn.addCommandToMaps(Object.assign(new Ta.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}uyk(a,b,c){c.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.Label&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.Label)),a.IconName&&0<a.IconName.length&&b.push(appChrome.actions.setControlIcon(a.ExternalId,a.IconName))):appChrome.api.createErrorViewModel(a.ExternalId,a.Label,
a.IconName,Object.assign(new IG,{retryButtonTitle:a.RetryButtonTitle,onRetryCommandId:a.OnRetryCommandId}))}fzk(a,b,c,f){f.push(a.ExternalId);appChrome.selectors.isControlDefined(a.ExternalId)?(a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.aCc()&&((c=this.$ra(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Sp.a(c)).iconSet)),u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")&&
a.LabelText!==a.Alt&&b.push(appChrome.actions.setControlCustomTooltip(a.ExternalId,a.Alt)))):(u.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ToggleButtonTooltip")?c.push(appChrome.api.createToggleButtonModel(a.ExternalId,a.LabelText,Object.assign(new Ty,{iconSet:(new Sp.a(this.$ra(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null}))):c.push(appChrome.api.createToggleButtonModel(a.ExternalId,
a.LabelText,Object.assign(new Ty,{iconSet:(new Sp.a(this.$ra(a))).iconSet,iconColor:a.IconColor,keytip:a.KeyTip,fullDescriptionLabel:a.Description,roleInMenu:a.AriaLabel}))),this.hn.addCommandToMaps(Object.assign(new Ta.a(a.ExternalId,a.Command),{menuItemId:a.MenuItemId,queryCommandId:a.QueryCommand})))}Uyk(a,b,c,f){f.push(a.ExternalId);f=this.bbj(a);appChrome.selectors.isControlDefined(a.ExternalId)?a.LabelText&&b.push(appChrome.actions.setPersonaButtonCoauthor(a.ExternalId,f,a.LabelText)):Lg.a("createPersonaButtonModel")&&
c.push(appChrome.api.createPersonaButtonModel(a.ExternalId,f,a.LabelText,Object.assign(new JG,{role:a.RoleInMenu,fullDescriptionLabel:a.AriaDescription,iconSet:{["default"]:"doughboywhiteglyph_20"}})))}xyk(a,b,c,f){f.push(a.ExternalId);if(appChrome.selectors.isControlDefined(a.ExternalId))a.LabelText&&b.push(appChrome.actions.setControlLabel(a.ExternalId,a.LabelText)),this.aCc()&&((c=this.$ra(a))&&0<c.length&&b.push(appChrome.actions.setControlIconSet(a.ExternalId,(new Sp.a(c)).iconSet)),void 0!==
a.ImageIsVisible&&null!==a.ImageIsVisible&&b.push(appChrome.actions.hideFlyoutAnchorIcon(a.ExternalId,!a.ImageIsVisible)),void 0!==a.Toggled&&null!==a.Toggled&&b.push(appChrome.actions.toggleButton(a.ExternalId,a.Toggled)));else{f=!(void 0===a.ImageIsVisible||null===a.ImageIsVisible)&&!a.ImageIsVisible;const l=!(void 0===a.Toggled||null===a.Toggled)&&a.Toggled;c.push(appChrome.api.createFlyoutAnchorModel(a.ExternalId,a.LabelText,Object.assign(new By,{iconSet:(new Sp.a(this.$ra(a))).iconSet,keytip:a.KeyTip,
hideIcon:f,toggled:l,roleInMenu:a.AriaLabel,customTooltip:a.LabelText!==a.Alt?a.Alt:null})));this.hn.addCommandToMaps(Object.assign(new Ta.a(a.ExternalId,a.Command),{queryCommandId:a.QueryCommand,populationProps:new Ng(a.PopulateQueryCommand,a.PopulateOnlyOnce)}))}a.Menu&&b.push.apply(b,this.Hhg(a.ExternalId,"FlyoutAnchorModel",a.Menu,null));a.Lang&&b.push(appChrome.actions.setControlLanguage(a.ExternalId,a.Lang))}oyk(a,b,c,f){a.McuLayout&&f.push(a.McuExternalId);f.push(a.ExternalId);f=0;appChrome.selectors.isControlDefined(a.ExternalId)?
a.McuLayout&&(f=this.tVh.pgg(a.ExternalId,"ColorPickerModel").columnCount):(a.McuLayout&&(c.push(appChrome.api.createColorPickerModel(a.McuExternalId,a.Width)),this.hn.addCommandToMaps(Object.assign(new Ta.a(a.McuExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})),f=a.Width),c.push(appChrome.api.createColorPickerModel(a.ExternalId,a.Width)),this.hn.addCommandToMaps(Object.assign(new Ta.a(a.ExternalId,a.Command),{commandPreviewId:a.CommandPreviewId,commandRevertId:a.CommandRevertId})));
c=[];const l=[];for(let x=0;x<a.Colors.length;x++){const G=a.Colors[x];x<f?c.push(appChrome.api.colorPickerCell(G.Color,G.DisplayColor,G.Alt)):l.push(appChrome.api.colorPickerCell(G.Color,G.DisplayColor,G.Alt))}0<c.length&&b.push(appChrome.actions.populateColorPickerCells(a.McuExternalId,c));b.push(appChrome.actions.populateColorPickerCells(a.ExternalId,l));a.SelectedColorId&&(0<c.length&&b.push(appChrome.actions.updateColorPickerSelectedColor(a.McuExternalId,a.SelectedColorId)),b.push(appChrome.actions.updateColorPickerSelectedColor(a.ExternalId,
a.SelectedColorId)))}$ra(a){return a.Image32by32Class?this.hn.Hag(a.Image32by32Class):a.Image16by16Class?this.hn.Hag(a.Image16by16Class):a.ExternalImageId}bbj(a){return a?Object.assign(new AP.a,{displayName:a.DisplayName,personaCoinColor:a.ImageBackColor,isUnauthenticatedSender:a.IsAnonymous,identifiers:Object.assign(new zP.a,{PersonaType:"User",Smtp:a.PersonaId})}):null}t7i(a){let b=2;a&&"inputMethod"in a&&a.inputMethod&&(b=a.inputMethod);return b}isShadowMenuOpen(a){return!!a&&a.isShadowRendering}aCc(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AllowFullPropPopulation",
!1)}static qbj(a,b){return appChrome.actions.populateFontPickerDataAsync(new Promise((c,f)=>{fb.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(l=>{l.isFeatureEnabled(Fr.a.lTa,!1).then(x=>{let G=b.fonts;x||l.isFreemiumUpsellEnabled()||(G=Qa.a.Zna(G,R=>R.fontType!==Fr.a.CBe));x=Object.assign(new GG,{commandId:a.externalUxCommand,fonts:G,isSubscriber:x,mruList:b.mruList,initialPinnedFontKeys:b.initialPinnedFontKeys,previewFontFamily:"msofp_hier_MSFontService"});
c(x)}).catch(f)})}))}static obj(a,b){const c=[];for(let f=0;f<b.MenuItems.MenuSectionList.length;f++){const l=b.MenuItems.MenuSectionList[f];l.Title&&c.push(appChrome.api.comboBoxHeader("Header-"+f.toString(),l.Title));for(let x=0;x<l.ControlList.length;x++){const G=Object(ua.a)(yP.a,l.ControlList[x]);G&&c.push(appChrome.api.comboBoxItem(G.MenuItemId,G.LabelText,G.Styles,G.CommandValueId,G.AriaLabel,G.Data,G.Disabled))}f<b.MenuItems.MenuSectionList.length-1&&c.push(appChrome.api.comboBoxDivider("Divider-"+
f.toString()))}return appChrome.actions.populateComboBoxOptions(a.externalUxCommand,c)}}Object(e.a)(Vy,"ReactPopulateQueryCommandPoller",null,[]);class LG{constructor(a,b,c,f,l){this.hn=c;this.ppa=a;this.fK=b;this.Omb=f;this.$1a=l}scj(a,b,c){const f=[];if(this.mGj(b))a=this.ggj(a,b,c),void 0!==a&&null!==a&&f.push.apply(f,a);else if(a){var l=this.BOc(a,c);um.a.visible in c&&f.push(appChrome.actions.updateControlHiddenState(a.externalUxCommand,!c[um.a.visible]));f.push(Tt(a.externalUxCommand,1>(l&1)));
void 0!==c[um.a.labelText]&&null!==c[um.a.labelText]&&f.push(appChrome.actions.setControlLabel(a.externalUxCommand,c[um.a.labelText]));void 0!==b&&null!==b&&(l=DG(a.externalUxCommand,b,c,l),void 0!==l&&null!==l&&f.push.apply(f,l),"PeopleWell"===b&&this.Y2h(a.externalUxCommand,c,f))}return f}R4i(a,b,c){const f=[];switch(b){case "FlyoutAnchorModel":var l=appChrome.selectors.getFlyoutAnchorMenuItems(a);break;case "SplitButtonModel":var x=appChrome.selectors.getSplitButtonState(a);if(x=this.hn.getCommandByExternalUxId(x.command))c=
this.ppa.ogc(this.fK,x.commandId,c),f.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(a,!c)),f.push(Tt(a,!1));return f;default:return null}b=!1;for(x in l)if(l=this.hn.getCommandByExternalUxId(x),Zk.b(l))b=!0;else if(c.SourceControlId=l.externalUxCommand,this.ppa.ogc(this.fK,l.commandId,c))return f.push(Tt(a,!1)),f;f.push(Tt(a,!b));return f}ggj(a,b,c){switch(b){case "PreviewGalleryModel":return this.$1a.Fbj(a,c);case "GalleryModel":return this.$1a.j6i(c)}return null}mGj(a){return"GalleryModel"===
a||"PreviewGalleryModel"===a}BOc(a,b){b.MenuItemId=a.menuItemId;return this.ppa.gbd(this.fK,this.Omb,a.commandId,a.queryCommandId,b)}Y2h(a,b,c){const f=b[Qy.a.LabelTextUserGeneratedPlaceholderReplacements];b=b[Qy.a.LabelText];f&&0<f.length&&(b=String.format.apply(null,[b].concat(f)));c.push(this.Vij(a,b))}Vij(a,b){return appChrome.actions.updatePeopleWell(this.q1i(a),b)}q1i(a){const b=[];var c={};a=this.hn.getCommandByExternalUxId(a).populationProps.populateQueryCommandId;this.ppa.gbd(this.fK,this.Omb,
"1285265560",a,c);c=c.MenuItems;if(!c)return b;c=c.MenuSectionList[0];for(a=0;a<c.ControlList.length;a++){const f=c.ControlList[a],l={};l.name=f.Alt;l.id=f.MenuItemId;l.description=f.Description;l.color=f.ImageBackColor;l.joinTime=f.JoinTimeInMS;l.imageUrl=f.ImageUrl;l.activeStatus=f.ActiveStatus;l.isAnonymous=f.IsAnonymous;l.canJump=f.CanJump;l.upn=f.Upn;b.push(l)}return b}}Object(e.a)(LG,"ReactQueryCommandPoller",null,[]);class MG{gbd(a,b,c,f,l,x){let G=0;a&&(this.ogc(a,c,l)&&(G|=1),c=new kB,c.CommandLocation=
b,void 0!==x&&null!==x&&(c.InvocationMethod=x),!Zk.b(f)&&a.X2f(f,l,c)&&(G|=2));return G}ogc(a,b,c=null){return a?a.T5b(b,c):!1}}Object(e.a)(MG,"RootPoller",null,[]);class NG{constructor(a,b,c){this.hn=a;this.fK=b;a=new MG;this.bYh=new nB;this.$1a=new EG(a,this.fK,c,this.hn);this.gtf=new Vy(a,this.fK,c,this.hn,this.$1a);this.atf=new LG(a,this.fK,this.hn,c,this.$1a)}ZQa(){const a=[];if(!Lg.c())return a;a.push.apply(a,this.Tij());var b=this.f4i();if(0<b.length)a.push.apply(a,b);else if(b=appChrome.selectors.getActiveControlIds(),
Object.keys(b).length){const c=this.g4i();for(const f of c)a.push(appChrome.actions.updateControlEnabledDisabledState(f,!0)),delete b[f];a.push.apply(a,this.DPc(b))}return a}qgc(a,b){Lg.c()&&(a=this.DPc(a,b),appChrome.api.dispatch(a))}QAe(a,b,c=null){if(!Zk.b(a)&&a.populationProps&&!this.gtf.xth(a)){a=this.gtf.tcj(a,b,c);if(!a.hGh){let f;(f=a.actions).push.apply(f,this.DPc(a.nRf,Lg.g(c)))}if(0<a.actions.length)return appChrome.api.dispatch(a.actions),!0}return!1}DPc(a,b=0){const c=[],f={};if(Lg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DefaultRibbinUILocationPolling")&&""!==appChrome.selectors.getSelectedTabId())for(var l of appChrome.selectors.getActiveGroupIds())for(var x of appChrome.selectors.getVisibleControlsInGroup(l))f[x]=!0;for(let G in a)l=G,x=a[G],0===b&&f[l]&&(b=2),c.push.apply(c,this.Sij(l,x,b));return c}Sij(a,b,c=0){const f=[],l=this.hn.getCommandByExternalUxId(a);let x={};appChrome.selectors.isControlDefined(a)&&(x=this.bYh.pgg(a,b));x[sn.a.HBh]=c;Zk.b(l)?
(x.ExternalUxId=a,(a=this.atf.R4i(a,b,x))&&0<a.length&&f.push.apply(f,a)):(x.MenuItemId=l.menuItemId,x.SourceControlId=a);f.push.apply(f,this.atf.scj(l,b,x));return f}Tij(){const a=[],b=!!u.AFrameworkApplication.fa&&(u.AFrameworkApplication.fa.ka("ReactRibbonDispatchActionFilter")||u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ReactRibbonDispatchActionFilter",!1)),c=appChrome.selectors.getContextualTabIds();let f=[];b&&(f=appChrome.selectors.getActiveContextualTabIds());
for(let x=0;x<c.length;x++){var l=this.hn.I3d(c[x]);if(l){l=this.fK.T5b(l);let G=!0;b&&(G=0<=Array.indexOf(f,c[x]));b&&G===l||a.push(appChrome.actions.activateDeactivateContextualTab(c[x],l))}}return a}f4i(){var a=appChrome.selectors.getSelectedTabId();const b=[],c=this.hn.I3d(a);c&&(this.fK.T5b(c)||b.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(a,!0)));return b}g4i(){var a=appChrome.selectors.getActiveGroupIds();const b=[];for(const c of a)if(a=this.hn.u6i(c))for(const f of a)this.fK.T5b(f.commandId)||
((a=f.externalUxCommandIds)||(a=appChrome.selectors.getVisibleControlsInGroup(f.externalUxGroupId)),b.push.apply(b,a));return b}}Object(e.a)(NG,"ReactRibbonRootPoller",null,[1501]);class ax{constructor(a,b,c=null){this.fK=this.BPb=this.QMa=null;this.qVh=b;a.Znb(this);this.r$=c}get TWc(){this.BPb||(this.BPb=new Date,this.BPb.setTime(0));return this.BPb}set TWc(a){this.BPb=a}get TXk(){return 2}get r$(){return this.fK}set r$(a){this.fK=a}get pFb(){this.QMa||(this.QMa=new NG(this.qVh,this.r$,this.TXk));
return this.QMa}AFc(){const a=document.activeElement;ya.a.isEditable(a)&&a.blur()}executeCommand(a,b,c,f,l,x,G,R=2){Zk.b(this.r$)||(l=new kB,l.CommandLocation=R,l.InvocationMethod=f,l.CommandTabName=c,b[sn.a.HBh]=R,this.r$.X2f(a,b,l,x,G),this.HXj(a,b))}ZQa(){return Zk.b(this.r$)?[]:this.pFb.ZQa()}pgc(){const a=this.ZQa();0<a.length&&(this.TWc=new Date,appChrome.api.dispatch(a))}FKb(){Lg.c()&&this.pFb.qgc({PeopleWell:"PeopleWell"},18)}HXj(a,b){try{const c=fb.a.instance.qb("Common.ISystemInitiatedFeedback");
if(c&&b){const f=b.SourceControlId||b.launcherId||b.LegacyId||b.NewContextId;let l=(f?"_"+f:"")+(b.SqmControlId?"_"+b.SqmControlId:"");l=l.length?l:"_"+a;c.Aee("Ribbon"+l)}}catch(c){Z.ULS.sendTraceTag(527247309,356,10,"LogCommandActivity failed: "+(c?c.toString():""))}}}Object(e.a)(ax,"ReactRibbonRoot",null,[1488,1502]);class oB{constructor(){this.qpa=[]}Znb(a){a&&!Array.contains(this.qpa,a)&&Array.add(this.qpa,a)}Ieh(a){Array.remove(this.qpa,a)}AFc(){for(const a of this.qpa)a.AFc()}dispose(){this.qpa=
null}}Object(e.a)(oB,"RootManagerBase",null,[1067,106]);class Gr extends oB{constructor(){super()}static get instance(){return Gr.Ja||Gr.CAj()}static CAj(){Gr.Ja=new Gr;return Gr.Ja}}Gr.Ja=null;Object(e.a)(Gr,"ReactRootManager",oB,[1066,1067]);class vp{constructor(a,b,c,f,l,x,G,R=null,fa=!0,wa=null,Wa=null){this.HNb=this.Wzc=this.Zrd=this.hP=null;this.uwf=[];this.byc=null;this.i2a=a;this.rzd=b;this.Nmb=c;this.Kd=f;this.Ca=l;this.hn=x;this.hP=wa?wa:new ax(Gr.instance,this.hn);this.f1a=G;this.Nuf=new rG;
this.YMa=R;this.WDd=fa;new nG;this.u4e=Wa;wd.a.get_instance().gk(7,Object(C.a)(this,this.O6k,"setRibbonPostInteractiveReady"));wd.a.get_instance().gk(7,Object(C.a)(this,this.QZj,"logRibbonLoadedActivity"));wd.a.get_instance().gk(19,Object(C.a)(this,this.vXj,"logAppLoadedActivity"));u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&wd.a.get_instance().gk(7,Object(C.a)(this,this.AOk,"registerSubComponentReporting"));wd.a.get_instance().gk(7,
Object(C.a)(this,this.dGk,"queueSettingsDependentActions"))}initialize(a,b,c=null){this.WDd||this.wJ(5);c?c.then(()=>{this.jgh()}).catch(()=>Z.ULS.sendTraceTag(561394319,340,10,"Failed to load the resources for the Ribbon")):mG.a.qyh(mG.a.qyh(kn.Task.WAA(this.ICg(a),this.HCg(vp.nLh)),()=>this.HCg(vp.vJh)),()=>this.ICg(b)).continueWith(()=>{this.jgh()},11)}dispose(){this.Mtl();this.byc&&this.byc.dispose();for(const a of this.uwf)wd.a.get_instance().Roi(a);u.AFrameworkApplication.Ta.uO(F.a.PUk,xd.a.frame,
Kd.ActionManager.Hg)}HCg(a){return fb.a.instance.resolve("Common.ISharedDependencyLoader").Cxb(u.AFrameworkApplication.Jj(a,2))}ICg(a){return""===a?kn.Task.Gt(!0):fb.a.instance.resolve("Common.ISharedDependencyLoader").Cxb(u.AFrameworkApplication.Jj(a,3))}Jog(){(this.YMa||this.f1a)&&appChrome.api.dispatch(this.Dhg());this.ULe();Lg.a("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(u.AFrameworkApplication.nfa);this.hP.pgc()}jgh(){this.Jog();this.WDd&&(appChrome.renderAppChrome(this.i2a,
Lg.e()),this.wJ(10));this.LCf();this.kDc();this.WDd&&this.wJ(5);this.$Rc()}$Rc(){this.Kd&&this.Ca&&this.Nmb&&(this.byc=new sG(this.Kd,this.Ca,this.i2a,this.Nmb),this.byc.initialize())}get EXk(){return this.Nuf}setCommandDefinitionMapping(){if(Lg.a("setCommandDefinitionMapping")){const a=tP(this.hn);appChrome.api.setCommandDefinitionMapping(a)}}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.m8&&Lg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,
b)=>{0===b&&this.tEb()})}LCf(){this.setCommandDefinitionMapping();this.registerOnShyRibbonStateChange();const a=Object(ua.a)(ax,this.hP);this.Zrd=new qG(this.hP,a.pFb,this.hn,this.Kd,this.rzd,fb.a.instance.qb("Common.IRibbonSQMInformation"),fb.a.instance.qb("Common.IFileMenuSQMInformation"),u.AFrameworkApplication.Ta,u.AFrameworkApplication.fa,fb.a.instance.Ka("Common.ISystemInitiatedFeedback"),null);this.lei();this.nmj()}lei(){this.Wzc=appChrome.api.bindCommandHandler((a,b)=>{this.Zrd.executeCommand(a,
b)})}Mtl(){this.Wzc&&(this.Wzc(),this.Wzc=null)}ULe(){appChrome.api.initializeLogger(new uP.a)}ZQa(){return this.hP?this.hP.ZQa():[]}tEb(){qc.a.instance.LF(()=>{let a=null;qc.a.instance.LF(()=>{a=this.ZQa()},"RB:GA");a&&0<a.length&&(this.hP.TWc=new Date,qc.a.instance.LF(()=>{appChrome.api.dispatch(a)},"RB:DA"));this.HNb&&qc.a.instance.LF(()=>{},"RB:J")},"RB:PFSU")}FKb(){this.hP.FKb()}k0h(a){a=[appChrome.actions.activateDeactivateContextualTab(a,!0),appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}setCurrentTab(a){a=
[appChrome.actions.setCurrentTab(a)];appChrome.api.dispatch(a)}Dhg(){var a=u.AFrameworkApplication.fa;const b=[];a.ka("EnableTellMeForOneLineRibbonIsEnabled")?a.ka("OcpsIsEnabled")&&fb.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(c=>{c.isFeatureEnabled("ConnectedServices",!0).then(f=>{f&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1));return null})}):b.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0));
b.push.apply(b,this.Lag());a=new kG.a(this.hn);this.YMa.M$&&(up.hrl(this.YMa.M$),b.push.apply(b,a.oZd(this.YMa.M$)));if(this.YMa.Vzh)for(const c of this.YMa.Vzh)b.push(appChrome.actions.updateGallerySectionHiddenState(c.UXi,c.mE,c.jrl));b.push.apply(b,a.rZi(this.YMa.irl));return b}Lag(){const a=[];if(this.f1a&&this.f1a.M$){const c=this.f1a.M$;for(let f in c){var b=c[f];const l=this.hn.S_d(f);if(l)for(let x of l)a.push(appChrome.actions.updateControlHiddenState(x,b))}}return a}xKb(a){a&&this.hP.pFb.qgc(a,
0)}QAe(a){this.hP.pFb.QAe(this.hn.getCommandByExternalUxId(a),appChrome.selectors.getModelType(a),{inputMethod:0})}Jcl(a){wd.a.get_instance().gk(5,null).continueWith(()=>{appChrome.api.dispatch(this.ifj(a))})}gJi(){const a=u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled")?"ShareMenu":"Share",b=u.AFrameworkApplication.fa.appSettings;b&&appChrome.api.dispatch(this.wyl(a,"Shared"===(b.SharingStatus||"")))}dGk(){u.AFrameworkApplication.fa.ff(()=>{this.gJi()})}wyl(a,b){return appChrome.actions.updateSharingStatusIndicator(a,
b)}ifj(a){return appChrome.actions.updateControlHiddenState(a,!1)}jfj(){return appChrome.actions.updateControlHiddenState("CopyLink",!1)}wJ(a){wd.a.get_instance().wJ(a);this.uwf.push(a)}O6k(){Lg.d("updateRibbonInitializationState")&&appChrome.api.dispatch(appChrome.actions.updateRibbonInitializationState(Object.assign(new lG,{postRibbonInteractiveReady:!0})))}kDc(){this.f1a&&this.u4e&&(this.HNb=this.u4e.createFileMenu(this.f1a,this.hP.r$),this.Nuf.fileMenu=this.HNb)}jUj(){this.HNb&&this.HNb.fUj()}Pfd(a,
b,c){if(1===c)return 32;this.hlc(!0);this.tEb();u.AFrameworkApplication.Aa.updateCommandUI();return 32}Qfd(a,b,c){if(1===c)return 32;this.hlc(!1);this.T6k();this.tEb();u.AFrameworkApplication.Aa.updateCommandUI();return 32}T6k(){Pi.a.aM(u.AFrameworkApplication.fa.Ga("IsSimplifiedRibbonOnCookieName"),"true",Pi.a.JL)}hlc(a){Pi.a.aM(u.AFrameworkApplication.fa.Ga("ReactRibbonMLRPreferenceCookieName"),a.toString(),Pi.a.JL)}QZj(){if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Do){const a=
fb.a.instance.Ka("Common.ISystemInitiatedFeedback");"SingleLine"===appChrome.selectors.getRibbonMode()?(a.execute(b=>{b.logActivity("SingleRibbonModeActivity",null)}),u.AFrameworkApplication.DN("d79fg304;61jba833")):"Multiline"===appChrome.selectors.getRibbonMode()&&(a.execute(b=>{b.logActivity("MultiRibbonModeActivity",null)}),u.AFrameworkApplication.DN("69a7h198;dfd7j584"))}}vXj(){const a=Pi.a.sCa(u.AFrameworkApplication.fa.Ga("VNextStyleOptOutCookieName"),!1);window.setTimeout(()=>{const b=fb.a.instance.Ka("Common.ISystemInitiatedFeedback");
b&&(u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?(b.execute(c=>{c.logActivity("VNextStylesOn",null)}),b.execute(c=>{c.logActivity("Fluent2StyleEnabledFPS","Fluent2StyleFloodgateSurveyIsEnabled")})):u.AFrameworkApplication.fa.ka("Fluent2StyleFGOnlyIsEnabled")&&a&&b.execute(c=>{c.logActivity("Fluent2StyleOptOutFPS","Fluent2StyleFloodgateSurveyIsEnabled")}))},5E3)}AOk(){wd.a.get_instance().gk(19,()=>{appChrome.api.setAsyncRequestStatus("appBoot",!1)});const a=appChrome.api.getRibbonSubComponentMappings();
for(let c in a){var b=c;const f=a[c];if(f)for(const l of f)u.AFrameworkApplication.Ta.xS(l)?appChrome.api.reportRibbonSubComponentBehaviorMapped(b):u.AFrameworkApplication.Ta.J5k(l,this.mBi(b));else appChrome.api.reportRibbonSubComponentBehaviorMapped(b)}}mBi(a){return()=>{appChrome.api.reportRibbonSubComponentBehaviorMapped(a)}}nmj(){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&Lg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&u.AFrameworkApplication.oEb.gHd){const a=u.AFrameworkApplication.oEb.gHd,b=u.AFrameworkApplication.oEb.uCf;b.payload||(b.payload={});const c=b.payload.launcherId?b.payload.launcherId:a;vp.Rfd.Jb(c)?vp.Rfd.ga(c)():"StatefulSplitButtonModel"===b.modelType?appChrome.PRIToastManager.dismissToast():(b.payload.PRIReadinessCheck=!0,this.Zrd.executeCommand(a,b))}}}vp.nLh="common";vp.vJh="appChrome";vp.Rfd=new sP.a(hB.a.jig());
Object(e.a)(vp,"ReactRibbonUser",null,[348,350,106]);class pB{constructor(){this.label=this.value=null}}Object(e.a)(pB,"TextInfoSectionField",null,[]);class OG{constructor(a,b){this.M$=b}}Object(e.a)(OG,"ReactRibbonJewelProperties",null,[]);class qB extends vp{constructor(a,b,c,f,l,x,G,R,fa=null,wa=!0,Wa=null,mb=null){super(a,b,f,l,x,G,R,fa,wa,Wa,mb);this.wtc=null;this.xtc=c;this.xtc.execute(Kb=>{this.wtc=Kb});this.xtc.execute(Kb=>{this.hP.r$=Kb})}ZQa(){return this.wtc?(this.wtc.clearCache(),super.ZQa()):
[]}}Object(e.a)(qB,"ReactRibbonUser",vp,[]);var rB=d(877),Wy=d(243),sB=d(366),PG=d(700),tB=d(1084);class bx{static get Szg(){return"teams"===(u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.FJ)||"").toLowerCase()}static get zqh(){return bx.Szg?(Aa.a.J(576030427,811,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.hQa,u.AFrameworkApplication.Iqb),u.AFrameworkApplication.hQa&&u.AFrameworkApplication.Iqb):u.AFrameworkApplication.hQa}}Object(e.a)(bx,"CopyLinkHelper",
null,[]);class QG{constructor(a,b){this.Qse=null;this.la=a;this.p$j=b}dispose(){this.Qse&&(il.CuiHelper.JJi(this.Qse),this.Qse=null)}sij(){if(u.AFrameworkApplication.workflowEnabled){let a="";switch(u.AFrameworkApplication.Qpc){case "Assign":a=CommonUIStrings.l_Assign;break;case "Submit":a=CommonUIStrings.l_Submit}if(a.length)return Object.assign(new tB.a,{command:"2988588587",label:a,id:"btnWorkflow"})}return u.AFrameworkApplication.Mbe&&u.AFrameworkApplication.KXa||u.AFrameworkApplication.mpc?Object.assign(new tB.a,
{command:"1197060601",label:ResourceStrings.L_ReplyWithChanges,id:il.CuiHelper.gfd}):u.AFrameworkApplication.hQa?Object.assign(new tB.a,{command:"981334692",label:ResourceStrings.L_Share,image:il.CuiHelper.Z9k,id:il.CuiHelper.CMe}):null}Dbl(){if(bx.Szg&&!this.p$j)return!1;const a=this.sij();return a&&"981334692"===a.command?this.la.nyg||this.la.uNj:!1}Hbl(){Aa.a.J(512496021,820,50,"FileShareEnabled: {0}, CopyLinkForTeamsIsEnabled: {1}",u.AFrameworkApplication.hQa,u.AFrameworkApplication.Iqb);return u.AFrameworkApplication.hQa&&
(u.AFrameworkApplication.Iqb||u.AFrameworkApplication.fa.ka("ShareMenuIsEnabled"))}}Object(e.a)(QG,"CuiControlUser",null,[106]);class RG extends qB{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie){super(b,a.oia,f,Yb.a.Wea,l,x,G,null,wa,!0,null,Kb);this.eGg=this.I7b=this.tFg=this.Myb=this.Uk=this.YFa=this.la=this.mh=this.QTa=this.d4c=this.xhe=this.Hle=null;this.GLg=!1;this.i7=0;this.Ame=this.V0c=this.a9=!1;this.yu=this.b3c=this.Xbb=null;b=new sB.a("ReactRibbonUser::InitPptReactRibbon",
!1);try{this.YFa=mb,this.la=Wa,this.xhe=new QG(this.la,Ic.ka("ShareMenuIsEnabled")),this.Hle=a,this.d4c=fa,this.Myb=G,this.QTa=R||new PG.a,this.mh=this.QTa.tRd(2,"ReactRibbonUser"),this.i7=0,this.tFg=wa.M$,this.a9=!!window.performance&&!!window.performance.now,this.Uk=nc,this.V0c=oc,this.Xbb=Ic,this.Ame=Kc,this.b3c=Hc,this.yu=ie,this.oTk(),wd.a.get_instance().gk(10,Object(C.a)(this,this.Lzj,"initializeFullPptRibbon"),11),wd.a.get_instance().gk(10,Object(C.a)(this,this.createHeader,"createHeader"),
3)}finally{b&&b.dispose()}}Iog(){tg.a.instance.hc("InitRibbon",(new Date).getTime());Aa.a.J(512496020,801,50,"Initialize SLR Iteration: {0}; IsReactMLRRendered: {1}",this.la.RAk?"2":"1",this.la.una);this.la.podsRibbonEarlyRendererExposureControl&&!this.la.uXf?PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(Object(C.a)(this,this.zzj,"initializeEarlyRenderedPptRibbon")):(tg.a.instance.hc("RenderRibbonStart",Date.now()),this.T8i(Wy.a(fb.a.instance)).catch(()=>
{Aa.a.J(512496019,801,10,"Failed to load the resources for the Ribbon.")}).then(()=>{tg.a.instance.hc("AppChromeReadyTime",Date.now());appChrome.setScriptLoader(Wy.a(fb.a.instance));Lg.a("setCookieWithExpirationCallback")&&Lg.a("setGetCookieValueCallback")&&(appChrome.api.setCookieWithExpirationCallback((a,b)=>Pi.a.aM(a,b,Pi.a.JL)),appChrome.api.setGetCookieValueCallback(a=>Pi.a.get(a)));appChrome.setAppSettings(u.AFrameworkApplication.fa.appSettings);if(this.la.ka("DynamicBundlesIsEnabled")){const a=
u.AFrameworkApplication.nfa+"exp/";appResourceLoader.init(pP.a.resolveScript,a);appChrome.api.setWebpackPublicPath(a)}PowerPointWebEditor.AppChromeSettingsLoadedHandler.OnAppChromeSettingsLoaded();this.ULe();re.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?appChrome.initializeRibbonStore(this.la.una):appChrome.initializeRibbonStore();this.Jog();this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PerceivedRibbonInteractiveIsEnabled",!1)&&1!==u.AFrameworkApplication.Aa.mode&&(this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",
!1)?this.zdh():this.v8d());this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ModeSwitcherInitialRenderIsEnabled",!1)&&this.YFa&&this.YFa.uTk();appChrome.renderAppChrome(this.i2a,Lg.e());this.la.vCb&&re.a("ModernRibbonShimmerCGEnabled")&&PowerPointWebEditor.MinimalBoot.SetRealRibbon("ContentEditable");wd.a.get_instance().wJ(5);wd.a.get_instance().wJ(10);re.a("React.SetRibbonBehaviorAttached")&&wd.a.get_instance().wJ(6);this.KDg();tg.a.instance.hc("Stage1Ribbon",rB.a.SWd&&void 0!==PowerPointWebEditor.FakeRibbon.ShowTime&&
null!==PowerPointWebEditor.FakeRibbon.ShowTime?PowerPointWebEditor.FakeRibbon.ShowTime:(new Date).getTime())}))}zdh(){wd.a.get_instance().gk(4,()=>{wd.a.get_instance().isCompleted(7)||this.v8d()})}T8i(a){return re.a("ReactMLRPerfOptimisationRemoveAppChromeDependency")?this.la.xJk?a(this.la.una?"powerpoint-ribbon-mlr-intl":"powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome")):this.la.una?a("powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("powerpoint-ribbon-mlr-intl")).catch(()=>{}).then(()=>
a("appChrome")):a("powerpoint-ribbon-intl").catch(()=>{}).then(()=>a("appChrome")):a("appChrome")}zzj(){void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime&&tg.a.instance.hc("RenderRibbonStart",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RenderStartTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime&&tg.a.instance.hc("AppChromeReadyTime",
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.AppChromeReadyTime);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime&&tg.a.instance.hc("Stage1Ribbon",PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ShowTime);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive?(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.UnbindPerceivedRibbonInteractive(),this.v8d()):this.la.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PRIOnlyAfterInteractivityIsEnabled",
!1)&&this.zdh();PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData&&this.b3c.jmh(PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveBlockedCommand,PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.ActiveCommandHandlerData);void 0!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime&&null!==PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime?tg.a.instance.hc("AppInitStatus_ribbonSkeletonDismissed",
PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.SkeletonDismissedTime):this.KDg();for(const a of PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache)4===a.length&&Z.ULS.sendTraceTag(a[0],a[1],a[2],a[3]);PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.LogMessageCache.length=0;this.ULe();wd.a.get_instance().wJ(5);wd.a.get_instance().wJ(10);re.a("React.SetRibbonBehaviorAttached")&&wd.a.get_instance().wJ(6);zu.a.dispatch("RibbonVisible")}Lzj(){tg.a.instance.hc("InitFullRibbon",(new Date).getTime());
appChrome.getLazyRibbonInitializationActions().then(a=>{tg.a.instance.hc("RibbonLazyPromiseFulfilled",(new Date).getTime());u.AFrameworkApplication.fa.ff(()=>{this.xhe.Hbl()?wd.a.get_instance().gk(7,()=>{Aa.a.J(512496018,801,50,"Render CopyLink button on Teams session after the full app settings and Chrome ready!");appChrome.api.dispatch(this.jfj())}):wd.a.get_instance().gk(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl("CopyLink"))})});this.YMa&&a.push.apply(a,this.Dhg());
if(u.AFrameworkApplication.Aa.jb.m8){const b=[];b.push(document.getElementById("WACDocumentPanel"));a.push(appChrome.actions.setShyState(Object.assign(new qP.a,{shyDismissalRegions:b})))}appChrome.api.dispatch(a);this.FOk();this.xtc.execute(b=>{if(void 0===this.hP.r$||null===this.hP.r$)this.hP.r$=b;this.LCf()});this.lMk();this.kDc();this.createFileMenu();this.YFa&&(a=this.YFa.initialize(),Aa.a.J(512496017,801,50,"Doc Mode Switcher Initialize response: "+a.toString()));this.$Rc();wd.a.get_instance().wJ(7);
tg.a.instance.hc("Stage3Ribbon",(new Date).getTime());this.a9&&tg.a.instance.hc("RibbonInteractivePerfMark",window.performance.now());this.RZj();this.LPk();this.Mzj();ya.a.bI(this.Hle.hF(),"ScrollableRibbon");return null})}RZj(){if(tg.a.instance.c8a)Aa.a.J(512496016,813,15,"Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};tg.a.instance.xo("Stage1Ribbon")&&(a.RibbonDisplayed=tg.a.instance.$g("Stage1Ribbon"));tg.a.instance.xo("Stage3Ribbon")&&
(a.RibbonInteractive=tg.a.instance.$g("Stage3Ribbon"));tg.a.instance.xo("InitRibbon")&&(a.InitRibbon=tg.a.instance.$g("InitRibbon"));tg.a.instance.xo("InitFullRibbon")&&(a.InitFullRibbon=tg.a.instance.$g("InitFullRibbon"));tg.a.instance.xo("RibbonLazyPromiseFulfilled")&&(a.RibbonLazyPromiseFulfilled=tg.a.instance.$g("RibbonLazyPromiseFulfilled"));tg.a.instance.xo("RenderRibbonStart")&&(a.RenderRibbonStart=tg.a.instance.$g("RenderRibbonStart"));tg.a.instance.xo("AppChromeReadyTime")&&(a.AppChromeReadyTime=
tg.a.instance.$g("AppChromeReadyTime"));tg.a.instance.xo("AppInitStatus_ribbonSkeletonDismissed")&&(a.RibbonSkeletonDismissed=tg.a.instance.$g("AppInitStatus_ribbonSkeletonDismissed"));Aa.a.J(512496015,809,50,"Ribbon Perf metrics: "+ta.a.toJSON(a))}}bZj(){if(tg.a.instance.c8a)Aa.a.J(512496014,813,15,"Lazy Ribbon Perf metrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};tg.a.instance.xo("Stage2Ribbon")&&(a.RibbonEnabled=tg.a.instance.$g("Stage2Ribbon"));
tg.a.instance.xo("Stage4Ribbon")&&(a.RibbonFull=tg.a.instance.$g("Stage4Ribbon"));Aa.a.J(512496013,809,50,"Lazy Ribbon Perf metrics: "+ta.a.toJSON(a))}}Mzj(){appChrome.getExtRibbonInitializationActions().then(a=>{appChrome.api.dispatch(a);tg.a.instance.hc("Stage4Ribbon",(new Date).getTime());this.bZj();return null})}tEb(){this.wtc&&wd.a.get_instance().isCompleted(7)&&(Me.a.mark(4893),super.tEb(),Me.a.mark(4894),this.GLg||(tg.a.instance.hc("Stage2RibbonStart",Date.now()),appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0)),
tg.a.instance.hc("Stage2Ribbon",Date.now()),this.GLg=!0))}JF(){this.tEb()}selectRibbonTabById(a){this.k0h(a)}get nlh(){return appChrome.selectors.getSelectedTabId()}bJi(){appChrome.getHeaderApi().then(a=>a.dismissPlaceholder())}createHeader(){const a=(new Date).getTime();u.AFrameworkApplication.fa.ff(()=>{if(!re.a("PPTOHideLegacySharedHeaderBugFix")||!u.AFrameworkApplication.bQ){var b=(new Date).getTime(),c=this.mh.ju("createHeader"),f=u.AFrameworkApplication.Aa.jb.xN,l=document.getElementById("HeaderPlaceholder"),
x=(new iG(sf.a.ELi,this.Hle)).JOi();if(f)try{Aa.a.J(512496012,801,50,"Shared Header - Calling RenderSharedHeader");const G=new fG;appChrome.renderSharedHeader(x,G.Tbj()).then(()=>{this.pXj(b,a);l&&this.bJi()})}catch(G){Aa.a.J(512496011,801,10,"Exception while trying to render shared header {0}",G)}else throw Aa.a.J(512496010,801,10,"Invalid request to render legacy Shared Header."),Error.invalidOperation("Invalid request to render legacy Shared Header");u.AFrameworkApplication.bQ||(x=Er.a.j8d(I.AppFrame.PRa,
null,x,!0),f&&(x.cL=!0,this.rFb(x,F.a.ekc,F.a.dkc),x.bindAction(A.KeyInputManager.Na(w.a.Z0,0),F.a.Nfd)));!l&&rB.a.p4f&&PowerPointWebEditor.FakeHeader.RemoveFakeHeader();this.mh.qu(c);this.i7|=1;this.Goc()}})}pXj(a,b){var c=(new Date).getTime();const f={};f.headerCallbackRegistrationTime=b;f.headerCallbackInvokedTime=a;f.headerRenderCompleteTime=c;Aa.a.J(512496009,809,50,"Create Header Perf metrics: "+ta.a.toJSON(f))}rFb(a,b,c){const f=A.KeyInputManager.Na(w.a.Iq,0),l=A.KeyInputManager.Na(w.a.Iq,
4);a.np(f);a.np(l);a.bindAction(f,b);a.bindAction(l,c)}kDc(){const a=()=>{const b=this.mh.ju("createJewel");this.f1a=this.vAj();vp.prototype.kDc.call(this);this.mh.qu(b);this.i7|=2;this.Goc()};this.V0c&&this.Xbb?this.Xbb.xvb(a):u.AFrameworkApplication.fa.ff(a)}createFileMenu(){const a=(new Date).getTime(),b=()=>{const c=(new Date).getTime(),f=this.mh.ju("createFileMenu"),l=[];if(this.la.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var x=[Object.assign(new pB,{label:CommonUIStrings.L_DiagnosticsSessionId,
value:u.AFrameworkApplication.userSessionId}),Object.assign(new pB,{label:CommonUIStrings.L_DiagnosticsBuild,value:u.AFrameworkApplication.buildVersion})];l.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",x))}l.push.apply(l,this.Lag());x=document.createElement("div");document.body.appendChild(x);appChrome.renderFileMenu(x,l);this.oXj(c,a);this.mh.qu(f);this.i7|=22;this.Goc()};this.V0c&&this.Xbb?this.Xbb.xvb(b):u.AFrameworkApplication.fa.ff(b)}oXj(a,b){var c=(new Date).getTime();
const f={};f.fileMenuCallbackRegistrationTime=b;f.fileMenuCallbackInvokedTime=a;f.fileMenuRenderCompleteTime=c;Aa.a.J(512496008,809,50,"File Menu Perf metrics: "+ta.a.toJSON(f))}lMk(){const a=()=>{const b=this.mh.ju("refreshRibbon");this.I7b||(this.I7b={},up.Rzh(this.I7b),this.d4c.GEh(this.I7b),this.eGg=this.G0i(this.tFg,this.I7b));const c=new kG.a(this.Myb);appChrome.api.dispatch(c.oZd(this.eGg));this.mh.qu(b);this.i7|=4;this.Goc()};this.V0c&&this.Xbb?this.Xbb.xvb(a):u.AFrameworkApplication.fa.ff(a)}G0i(a,
b){const c={};for(let l in b){var f=b[l];const x=l;f!==a[x]&&(c[x]=f,Aa.a.J(512496007,801,50,"TrimedId changed after full settings ready, TrimId:{0} PreviousValue:{1} CurrentValue:{2}",x,a[x],f))}return c}vAj(){const a={};this.d4c.Z4k(a);this.d4c.GEh(a);return new OG(null,a,"jewelPPTEditor")}LPk(){rB.a.SWd&&PowerPointWebEditor.FakeRibbon.RemoveFakeRibbon()}Oeh(a){wd.a.get_instance().gk(7,()=>{appChrome.api.dispatch(appChrome.actions.removePeripheralControl(a))})}oTk(){const a=this.la.ka("ShareMenuIsEnabled"),
b=a?"ShareTopBar":"Share";u.AFrameworkApplication.Iqb?this.Oeh(b):u.AFrameworkApplication.fa.ff(()=>{const c=this.mh.ju("createShareAction"),f=this.xhe.Dbl();f?this.Jcl(b):(this.Oeh(b),this.la.dgb&&this.Uk.Y9(this.Uk.e5,this.Uk.Oid));a&&(f?this.la.dgb&&wd.a.get_instance().gk(7,()=>{this.Uk.jea(this.Uk.e5,this.Uk.Oid);this.Uk.iea(this.Uk.e5,this.Uk.Oid)}):wd.a.get_instance().gk(7,()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShareMenu",!f))}));this.mh.qu(c);this.i7|=8;this.Goc()})}Goc(){31===
this.i7&&(this.QTa.HXc(2),this.i7=0)}v8d(){this.b3c.kei();appChrome.api.dispatch(appChrome.actions.setControlBehaviorAttached(!0));wd.a.get_instance().gk(7,()=>{this.b3c.Ltl();Lg.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.UnifyPRIToastDismissal")&&this.Ame||appChrome.PRIToastManager.dismissToast()},11)}KDg(){wd.a.get_instance().wJ(18);zu.a.dispatch("RibbonVisible")}MTg(){return()=>{this.yu.yBc(()=>{appChrome.PRIToastManager.dismissToast()})}}FOk(){this.Ame&&
(vp.Rfd.$("NewDefaultSlide",this.MTg()),vp.Rfd.$("ChangeLayoutFlyout",this.MTg()))}}Object(e.a)(RG,"ReactRibbonUser",qB,[1151,350,106]);class SG{constructor(a,b,c,f,l,x,G){this.Qzb=null;this.yb=a;this.jOg=b;this.ra=c;this.ZD=f;this.NN=l;this.ia=x;this.Fp=G;this.jOg.Yj(Object(C.a)(this,this.Bih,"ribbonChangeTabHandler"))}dispose(){this.jOg.tm(Object(C.a)(this,this.Bih,"ribbonChangeTabHandler"))}get CI(){return this.Qzb}set CI(a){this.Qzb!==a&&a&&(this.Qzb=a,this.NN.ZZ?this.NN.ZZ=!1:this.Fp&&this.NN.$Sa&&
this.ia.processAction(E.a.Dia,2))}Bih(a,b){b.node.Sa(sb.a.shapeId)&&(a=b.node.getValue(sb.a.shapeId),this.Qzb&&this.Qzb.id===b.node.id&&a&&(this.yb.Cb(new xe.a(2,1,0,()=>{const c=this.ra.Rdj(this.ZD.nlh,b.node);0<c.length&&this.ZD.selectRibbonTabById(c)},90,"10")),this.Qzb=null))}}Object(e.a)(SG,"RibbonChangeManager",null,[1153]);class TG{constructor(a,b,c){this.UXi=a;this.mE=b;this.jrl=c}}Object(e.a)(TG,"GallerySectionData",null,[]);let uB,vB,Xy,wB,cx,xB,yB,zB,AB;class vv{constructor(a,b,c,f,l,x){this.la=
a;this.L2c=b;this.e2c=c;this.aPg=f;this.Oyb=l;this.Uk=x}vid(a){this.la.exg&&(a["PptRibbon.Home.Drawing.TextBox"]=!0,a["PptRibbon.Home.Drawing.Rectangle"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangle"]=!0,a["PptRibbon.Home.Drawing.Ellipse"]=!0,a["PptRibbon.Home.Drawing.RoundedRectangleCallout"]=!0,a["PptRibbon.Home.Drawing.Star5"]=!0,a["PptRibbon.Home.Drawing.Triangle"]=!0,a["PptRibbon.Home.Drawing.Can"]=!0,a["PptRibbon.Home.Drawing.Cube"]=!0,a["PptRibbon.Home.Drawing.StraightConnector"]=!0,a["PptRibbon.Home.Drawing.StraightConnectorArrow"]=
!0,a["PptRibbon.Home.Drawing.StraightConnectorTwoArrow"]=!0,a["PptRibbon.Home.Drawing.RightArrow"]=!0,a["PptRibbon.Home.Drawing.DownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftArrow"]=!0,a["PptRibbon.Home.Drawing.UpArrow"]=!0,a["PptRibbon.Home.Drawing.UpDownArrow"]=!0,a["PptRibbon.Home.Drawing.LeftRightArrow"]=!0,a["PptRibbon.Home.Drawing.MoreShapes"]=!0,a["PptRibbon.Home.Font.ChangeCase"]=!this.la.fmi,a["PptRibbon.InsertTab.Illustrations.TextBox"]=!0,a["PptRibbon.InsertTab.Illustrations.Rectangle"]=
!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Ellipse"]=!0,a["PptRibbon.InsertTab.Illustrations.RoundedRectangleCallout"]=!0,a["PptRibbon.InsertTab.Illustrations.Star5"]=!0,a["PptRibbon.InsertTab.Illustrations.Triangle"]=!0,a["PptRibbon.InsertTab.Illustrations.Can"]=!0,a["PptRibbon.InsertTab.Illustrations.Cube"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnector"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.StraightConnectorTwoArrow"]=
!0,a["PptRibbon.InsertTab.Illustrations.RightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.DownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.UpDownArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.LeftRightArrow"]=!0,a["PptRibbon.InsertTab.Illustrations.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBox"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Rectangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangle"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.Ellipse"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.RoundedRectangleCallout"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Star5"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Triangle"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Can"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Cube"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnector"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.StraightConnectorTwoArrow"]=
!0,a["PptRibbon.DrawingFormat.InsertShapes.RightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.DownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.UpDownArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.LeftRightArrow"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.MoreShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.Duplicate"]=!0);this.la.exg||(a["PptRibbon.Home.Drawing.AllShapes"]=
!0,a["PptRibbon.InsertTab.Illustrations.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.AllShapes"]=!0,a["PptRibbon.DrawingFormat.InsertShapes.TextBoxBig"]=!0);this.la.Fce||(a["PptRibbon.InsertTab.InsertTables"]=!0);a["ContextualTabs.Tables.Design"]=!0;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!0;a.buttonFirstRow=!0;a.buttonFirstColumn=!0;a.buttonLastRow=!0;a.buttonLastColumn=!0;a.buttonBandedRow=!0;a.buttonBandedColumn=!0;a["ContextualTabs.Tables.Design.TableStyles"]=!0;a.buttonTableStyleRibbon0=
!0;a.buttonTableStyleRibbon1=!0;a.buttonTableStyleRibbon2=!0;a.buttonTableStyleRibbon3=!0;a.buttonTableStyleRibbon4=!0;a.buttonTableStyleRibbon5=!0;a.buttonTableStyleRibbon6=!0;a.fsfaMoreTableStyles=!0;a.fsfaTableStyleTheme=!0;a["ContextualTabs.Tables.Design.Shading"]=!0;a.cellShadingColor=!0;a["ContextualTabs.Tables.Design.TableBorderStyle"]=!0;a["ContextualTabs.Tables.Design.DrawBorders"]=!0;a.TableBorders=!0;a.TableBordersPenColor=!0;a.TableBorderPenWeight=!0;a["ContextualTabs.Tables.Layout"]=
!0;a["ContextualTabs.Tables.Layout.Table"]=!0;a.idTableSelect=!0;a.btnSelectTable=!0;a.btnSelectColumn=!0;a.btnSelectRow=!0;a["ContextualTabs.Tables.Layout.RowColumn"]=!0;a.idTableDelete=!0;a.btnTableDelete=!0;a.btnColumnDelete=!0;a.btnRowDelete=!0;a["ContextualTabs.Tables.Layout.MergeSplit"]=!0;a.btnMergeTableCells=!0;a.btnSplitTableCells=!0;a.btnInsertRowAbove=!0;a.btnInsertRowBelow=!0;a.btnInsertColumnLeft=!0;a.btnInsertColumnRight=!0;a.btnDistributeRows=!0;a.btnDistributeColumns=!0;a["ContextualTabs.Tables.Layout.Alignment"]=
!0;a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!0;a.btnTableCellLeftJustify=!0;a.btnTableCellCenterJustify=!0;a.btnTableCellRightJustify=!0;a.btnTableCellTopAnchoring=!0;a.btnTableCellMiddleAnchoring=!0;a.btnTableCellBottomAnchoring=!0;if(this.la.Dce){if(this.la.Ece||this.la.Zwb||this.la.Cce)a["ContextualTabs.Tables.Layout"]=!1;this.la.Cce&&(a["ContextualTabs.Tables.Layout.Alignment"]=!1,a["ContextualTabs.Tables.Layout.Alignment.Controls"]=!1,a.btnTableCellLeftJustify=!1,a.btnTableCellCenterJustify=
!1,a.btnTableCellRightJustify=!1,a.btnTableCellTopAnchoring=!1,a.btnTableCellMiddleAnchoring=!1,a.btnTableCellBottomAnchoring=!1);a["ContextualTabs.Tables.Design"]=!1;this.la.Ece&&(a["ContextualTabs.Tables.Layout.Table"]=!1,a.idTableSelect=!1,a.btnSelectTable=!1,a.btnSelectColumn=!1,a.btnSelectRow=!1);this.la.Zwb&&(a["ContextualTabs.Tables.Layout.RowColumn"]=!1,a.idTableDelete=!1,a.btnTableDelete=!1,a.btnColumnDelete=!1,a.btnRowDelete=!1,a.btnInsertRowAbove=!1,a.btnInsertRowBelow=!1,a.btnInsertColumnLeft=
!1,a.btnInsertColumnRight=!1);a["ContextualTabs.Tables.Design.Shading"]=!1;a.cellShadingColor=!1;a["ContextualTabs.Tables.Design.TableStyleOptions"]=!1;a.buttonFirstRow=!1;a.buttonFirstColumn=!1;a.buttonLastRow=!1;a.buttonLastColumn=!1;a.buttonBandedRow=!1;a.buttonBandedColumn=!1;a["ContextualTabs.Tables.Design.TableStyles"]=!1;a.buttonTableStyleRibbon0=!1;a.buttonTableStyleRibbon1=!1;a.buttonTableStyleRibbon2=!1;a.buttonTableStyleRibbon3=!1;a.buttonTableStyleRibbon4=!1;a.buttonTableStyleRibbon5=
!1;a.buttonTableStyleRibbon6=!1;a.fsfaMoreTableStyles=!1;this.la.j$&&(a["ContextualTabs.Tables.Design.TableBorderStyle"]=!1,a.TableBorders=!1,this.la.MEb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBorderPenWeight=!1),this.la.Geb&&(a["ContextualTabs.Tables.Design.DrawBorders"]=!1,a.TableBordersPenColor=!1));this.la.PVc&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnMergeTableCells=!1);this.la.Hce&&(a["ContextualTabs.Tables.Layout.MergeSplit"]=!1,a.btnSplitTableCells=!1);this.la.ehc&&
(a.btnDistributeRows=!1,a.btnDistributeColumns=!1)}this.la.powerPointFullTextJustifyIsEnabled||(a["PptRibbon.Home.Paragraph.FullJustify"]=!0);this.la.powerPointSmartLookupIsEnabled||(a["PptRibbon.Review.SmartLookup"]=!0,a["PptRibbon.Review.Show.SmartLookup"]=!0,a["PptRibbon.Review.ShowHide.SmartLookup"]=!0);this.la.powerPointFormatBackgroundEnabled||(a["PptRibbon.Design.Customize.FormatBackgroundAnchor"]=!0);a["PptRibbon.InsertTab.Symbols"]=!u.AFrameworkApplication.fa.ka("InsertSymbolIsEnabled");
this.la.eyg||(a["PptRibbon.Home.Font.Shrink"]=!0,a["PptRibbon.Home.Font.Grow"]=!0);this.la.mNj||(a["PptRibbon.Home.Font.Strikethrough"]=!0);this.la.j$d||(a["PptRibbon.InsertTab.Images.Clipart"]=!0);this.Tzh(a,!0,!0,!0);this.Szh(a,!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media.OnlineVideo"]=!0);this.la.pptInsertOnlineVideoEnabled||(a["PptRibbon.InsertTab.Media"]=!0);this.la.d8g||(a["PptRibbon.AudioPlayback"]=!0);this.la.KEb||(a["PptRibbon.AudioFormat"]=!0);if(u.AFrameworkApplication.dra||
!this.la.pptEditInsertAppsForOfficeEnabled||this.la.LUc)a["PptRibbon.InsertTab.AppForOffice"]=!0;this.la.Qvb||(a["PptRibbon.View.Zoom"]=!0);this.la.IKj||(a["PptRibbon.Home.Paragraph.LineSpacing"]=!0);this.la.qtg||(a["ContextualTabs.Tables.Layout.Properties"]=!0,a["PptRibbon.PictureFormat.Properties"]=!0,a["PptRibbon.DrawingFormat.Properties"]=!0,a["PptRibbon.SmartArt.Properties"]=!0,a["PptRibbon.AudioFormat.Properties"]=!0);var b=[];this.la.fKa&&(b=this.la.fKa.split(","));for(const c of b){const f=
c.trim().substring(0,1).toUpperCase()+c.trim().substring(1,c.length);a["Transition"+f]=!0}Array.contains(b,"Wipe")&&Array.contains(b,"Shape")&&Array.contains(b,"Split")&&Array.contains(b,"RandomBars")&&(a.TransitionMore=!0);this.la.EKd||(a.AnimationMore=!0);this.la.ARj?a["PptRibbon.Transition.AllSlides"]=!0:a["PptRibbon.Transition.Timing"]=!0;this.la.powerPointEnableAccCheck||(a["PptRibbon.Review"]=!0);this.la.tg&&(a["PptRibbon.View.PresentationViews"]=!0);this.aPg?a["PptRibbon.Home.Clipboard.Paste"]=
!0:a["PptRibbon.Home.Clipboard.NewPaste"]=!0;this.la.ixg?a["PptRibbon.Design.OldThemes"]=!0:a["PptRibbon.Design.Themes"]=!0;a["PptRibbon.View.ShowHide.CommentsSplitButton"]=!0;this.la.pptEditorConsistencyCheckIsEnabled||(a["PptRibbon.Review.Proofing.EditorPane"]=!0);this.la.proofingSettingIsEnabled||(a["PptRibbon.Review.Proofing.GrammarOptions"]=!0);this.la.pptHideProofingErrorIsEnabled||(a["PptRibbon.Review.Proofing.HideProofingErrors"]=!0);this.la.hbe||(a["PptRibbon.Review.Activity"]=!0);a["PptRibbon.Review.Proofing.EditorPane"]?
a["PptRibbon.Review.Proofing.GrammarOptions"]?a["PptRibbon.Review.Proofing"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0:a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0;(b=u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.iJb&&!u.AFrameworkApplication.dra)||(a["PptRibbon.Help"]=!0);a.btnContactSupport=!(b&&u.AFrameworkApplication.fa.ka("HelpTabContactSupportIsEnabled"));a.btnShowTraining=!(b&&u.AFrameworkApplication.fa.ka("HelpTabShowTrainingIsEnabled"));
a.btnWhatsNew=!(b&&u.AFrameworkApplication.fa.ka("HelpTabWhatsNewIsEnabled"));a.btnFeedbackPane=!0;this.la.A8a&&this.la.oSc&&this.la.oSc.length||(a.InsertIconDialog=!0);a["PptRibbon.View.Subtitles.UseSubtitles"]=!0;a["PptRibbon.View.Subtitles.SubtitleSettings"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=!0;a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=
!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!0;a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!0;a.AlwaysUseSubtitles=!0;a.UseSubtitles=!0;a["PptRibbon.View.Coach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoach"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!0;a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!0;a["PptRibbon.View.Coach.Menu.Vision"]=!0;a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!0;a["PptRibbon.View.Coach.Menu"]=!0;a["PptRibbon.View.StartSlideShow.PresentLive"]=
!0;a.PresentLive=!0;a.PresentLiveConsumer=!0;a.PresentLiveEnterprise=!0;a.PresentLiveTopBar=!0;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.CacheDictateVisibility",!1)||(a["PptRibbon.Home.Dictation"]=!0,a.btnStartDictation=!0);this.Oyb&&(a["PptRibbon.Review.Comments.Markers"]=!0);u.AFrameworkApplication.fa.ka("OcpsIsEnabled")&&(a.TellMeControl=!0);a["PptRibbon.Review.Translate"]=!this.la.R6g;a["PptRibbon.Review.Activity.ShowVersionHistory"]=!this.la.iBk;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic"]=
!this.la.YHa;a["PptRibbon.Graphics.ContextMenu.FlyChangeGraphic"]=!this.la.YHa;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture"]=!this.la.YHa;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture"]=!this.la.YHa;a["PptRibbon.PictureFormat.Adjust.ChangePicture"]=this.la.YHa;a.FixIt=!this.la.bLc}y8k(a){if(!u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")||u.AFrameworkApplication.iJb||u.AFrameworkApplication.dra)a.Help=!0;a.Draw=!this.la.tg}Iij(){const a=new Ha.a;if(this.la.fKa){var b=this.la.fKa.split(",");
for(const c of b)b=c.trim(),"MenuSection"===b.substring(0,11)&&a.add(new TG("TransitionMore","Transition"+b,!0))}return a.toArray()}Z4k(a){a["PptJewel.Menu"]=!0;u.AFrameworkApplication.fa.ka("WheresSaveButtonBrsIsEnabled")||(a["PptJewel.SaveACopy.WheresTheSaveButton"]=!0);this.la.printingEnabled||(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=
!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);a["PptJewel.Print.PrintToPdf"]=!0;this.L2c&&this.L2c.bYg||(a["PptJewel.About.TryOffice"]=!0);this.e2c&&this.e2c.Yqh||(a["PptJewel.About.TryMacOffice"]=!0);u.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&u.AFrameworkApplication.pu.Ix||(a.lblBreadcrumbDocName=!0);u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")&&!u.AFrameworkApplication.iJb&&
(a["PptJewel.Help"]=!0)}GEh(a){delete a["PptJewel.Menu"];const b=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.FJ);if(b&&"teams"===b.toLowerCase()){a["PptJewel.Share"]=!0;a["PptJewel.Share.Embed"]=!0;var c=u.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost");const f=u.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures");c&&f||(a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0)}u.AFrameworkApplication.Cva||
(a["PptJewel.New"]=!0);u.AFrameworkApplication.DEe||(a["PptJewel.Open"]=!0);u.AFrameworkApplication.sE||(a["PptJewel.Help.GiveFeedback"]=!0,a.btnFeedback=!0,a.btnFeedbackPane=!0);u.AFrameworkApplication.Uzh&&(a["PptJewel.Info.OpenInClient"]=!0,a.btnOpenInClient=!0);u.AFrameworkApplication.KXa||(a["PptJewel.Share.ReplyWithChanges"]=!0);u.AFrameworkApplication.rXd||u.AFrameworkApplication.$Ve||(a["PptJewel.Info.FileVersion"]=!0);u.AFrameworkApplication.Pwb?(a["PptJewel.Info.FileVersion"]=!0,u.AFrameworkApplication.Wj("Microsoft.Office.PPT.Server.Flighting.PPTOneDriveConsumerSharedVersionHistoryIsEnabled"),
Z.ULS.sendTraceTag(512262734,832,15,"PPT external version history menu item for OneDriveConsummer trimmed.")):u.AFrameworkApplication.kWc()?this.la.Lxk?(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(512262732,832,15,"PPT shared version history menu item trimmed for internet explorer.")):u.AFrameworkApplication.fa.ka("DisableAnonymousUserCheckForBlueChickenForVH")?u.AFrameworkApplication.fa.ka("IsAnonymousUserCheckSupportedForVH")&&u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=
!0,Z.ULS.sendTraceTag(512262731,832,15,"PPT shared version history menu item due to anonymous user.")):u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(512262730,832,15,"PPT shared version history menu item due to anonymous user.")):(a["PptJewel.Info.VersionHistory"]=!0,Z.ULS.sendTraceTag(512262733,832,15,"PPT shared version history menu item trimmed."));a["PptJewel.Info.OpenInClient"]&&a["PptJewel.Info.FileVersion"]&&a["PptJewel.Info.VersionHistory"]&&
(a["PptJewel.Info"]=!0);u.AFrameworkApplication.hQa||(a["PptJewel.Share.ShareWithPeople"]=!0);if(u.AFrameworkApplication.rO||!u.AFrameworkApplication.YVe&&!u.AFrameworkApplication.Mub&&!u.AFrameworkApplication.hXd)a["PptJewel.Share.Embed"]=!0;a["PptJewel.Share.ShareWithPeople"]&&a["PptJewel.Share.Embed"]&&a["PptJewel.Share.ReplyWithChanges"]&&(a["PptJewel.Share"]=!0);u.AFrameworkApplication.erl&&(a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=
!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);u.AFrameworkApplication.fa.ka("DisablePrint")&&(a["PptJewel.Print"]=!0,a["PptJewel.SaveACopy"]=!0,a["PptJewel.DownloadAs"]=!0,a["PptJewel.SaveACopy.SaveACopy"]=!0,a["PptJewel.SaveACopy.SaveAsToHost"]=!0,a["PptJewel.SaveACopy.SaveToSharePoint"]=!0,a["PptJewel.DownloadAs.DownloadACopy"]=
!0,a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0,a["PptJewel.DownloadAs.DownloadAsImages"]=!0,a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0);u.AFrameworkApplication.rO&&(a["PptJewel.Print"]=!0,a["PptJewel.Share"]=!0);u.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")||(a["PptJewel.SaveACopy.SaveACopy"]=!0);u.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&u.AFrameworkApplication.fa.ka("UserCanWriteRelative")&&u.AFrameworkApplication.fa.ka("SupportsEditing")||(a["PptJewel.SaveACopy.SaveAsToHost"]=
!0);u.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&u.AFrameworkApplication.fa.ka("SupportsGetMoreInfoForPersonalStorage")||(a["PptJewel.SaveACopy.SaveToSharePoint"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&a["PptJewel.SaveACopy.SaveToSharePoint"]&&(a["PptJewel.SaveACopy"]=!0);this.la.rNj||(a["PptJewel.DownloadAs.DownloadACopyAsPdf"]=!0);this.la.myg&&this.la.tg||(a["PptJewel.DownloadAs.DownloadAsImages"]=!0);if(!u.AFrameworkApplication.fa.ka("153")||
".odp"===u.AFrameworkApplication.fa.appSettings["152"].toLowerCase()||u.AFrameworkApplication.rO)a["PptJewel.DownloadAs.DownloadACopyAsOdp"]=!0;u.AFrameworkApplication.fa.ka("RenameDialogIsEnabled")&&u.AFrameworkApplication.N5b()&&!u.AFrameworkApplication.rO||(a["PptJewel.Rename"]=!0);u.AFrameworkApplication.Kjc||(a["PptJewel.Help.ReportAbuse"]=!0);c=!u.AFrameworkApplication.d7c||!u.AFrameworkApplication.fa.ka("1072");u.AFrameworkApplication.TEb||!c||u.AFrameworkApplication.znc||this.L2c&&this.L2c.bYg||
this.e2c&&this.e2c.Yqh||u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About"]=!0);u.AFrameworkApplication.TEb||(a["PptJewel.About.Privacy"]=!0);a["PptJewel.About.TrustCenter"]=c;u.AFrameworkApplication.znc||(a["PptJewel.About.TermsOfUse"]=!0);u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")||(a["PptJewel.About.DiagnosticsSection"]=!0);u.AFrameworkApplication.Cca||(a["PptJewel.SecondaryMenu"]=!0);c=!u.AFrameworkApplication.fa.ka("248");
a["PptRibbon.Design.Designer.New"]=c;a["PptRibbon.Design.ShowHide.Designer.New"]=c;a["PptRibbon.Home.Designer"]=c;(a["PptRibbon.Home.ShowHide.Designer"]=c)&&this.Uk&&this.Uk.Y9(this.Uk.e5,this.Uk.wTd);c=!u.AFrameworkApplication.fa.ka("822");a["PptRibbon.Review.SmartLookup"]=c;a["PptRibbon.Review.Show.SmartLookup"]=c;(c=(a["PptRibbon.Review.ShowHide.SmartLookup"]=c)||!vv.vOj())||Z.ULS.sendTraceTag(512262729,1303,15,"ReuseSlides is not trimmed");a["PptRibbon.Home.Slides.InvokeFilesSerplet"]=c;a["PptRibbon.InsertTab.InvokeFilesSerplet"]=
c;Z.ULS.sendTraceTag(512262728,352,50,"IsInsertOnlinePictureFromHostSupported: {0}; InsertOnlinePictureFromHostEnabled: {1}; HostSupportsInsertOnlinePictureFromHost: {2}; IsSkyDrive: {3}; AppSupportsInsertOnlinePictureFromHost: {4}; AppSupportsInsertOnlinePictureFromSharePoint: {5}",u.AFrameworkApplication.h5b(),u.AFrameworkApplication.insertOnlinePictureFromHostEnabled,u.AFrameworkApplication.pRc,u.AFrameworkApplication.Pwb,u.AFrameworkApplication.qCc,u.AFrameworkApplication.wUb);u.AFrameworkApplication.fa.ka("671")&&
this.Tzh(a,this.la.pptInsertOnlinePictureEnabled,u.AFrameworkApplication.h5b(),this.la.A8a);this.Szh(a,this.la.uSc);u.AFrameworkApplication.fa.ka("670")&&(c=!u.AFrameworkApplication.fa.ka("124"),a["PptRibbon.InsertTab.Media.OnlineVideo"]=c,a["PptRibbon.InsertTab.Media"]=!!c);a["PptRibbon.Review.Proofing.EditorPane"]=!u.AFrameworkApplication.fa.ka("809");a["PptRibbon.Review.Proofing.GrammarOptions"]=!u.AFrameworkApplication.fa.ka("299");a["PptRibbon.Review.Proofing.HideProofingErrors"]=!u.AFrameworkApplication.fa.ka("619");
a["PptRibbon.Review.Proofing.EditorPane"]?a["PptRibbon.Review.Proofing.GrammarOptions"]?(a["PptRibbon.Review.Proofing"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!1):(a["PptRibbon.Review.Proofing"]=!1,a["PptRibbon.Review.Proofing.ProofingSplitButtonFallback"]=!0,a["PptRibbon.Review.Proofing.ProofingSplitButton"]=
!1);c=u.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");this.la.Rja&&c&&(a["PptRibbon.View.Subtitles.UseSubtitles"]=!1,re.a("ReactMLRSubtitleSettingsTeamsFix")||(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1),a["PptRibbon.View.Subtitles.SubtitlesPositionTopOverlay"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBottomOverlay"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSpokenLanguage"]=!1,a["PptRibbon.View.Subtitles.PopulateTranscriptionSubtitleLanguage"]=!1,a["PptRibbon.View.Subtitles.SubtitlesPositionBelowSlide"]=
!1,a["PptRibbon.View.Subtitles.SubtitlesPositionAboveSlide"]=!1);this.la.t6b&&this.la.Byg&&(a["PptRibbon.View.Coach"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachTopBar"]=!1,this.la.pptRehearsalVisionEnabled||this.la.LEb?(a["PptRibbon.View.Coach.Menu"]=!1,a["PptRibbon.View.Coach.RehearseWithCoachSplit"]=!1,this.la.pptRehearsalVisionEnabled&&(a["PptRibbon.View.Coach.Menu.Vision"]=!1),this.la.LEb&&(a["PptRibbon.View.Coach.Menu.FeedbackSettings"]=!1)):a["PptRibbon.View.Coach.RehearseWithCoach"]=!1);
this.la.yRj&&this.la.Rja&&c&&(!b||"teams"!==b.toLowerCase())&&(a.AlwaysUseSubtitles=!1,a.UseSubtitles=!1,re.a("ReactMLRSubtitleSettingsTeamsFix")&&(a["PptRibbon.View.Subtitles.SubtitleSettings"]=!1));this.la.powerPointLiveBroadcastEnabled&&(a["PptRibbon.View.StartSlideShow.PresentLive"]=!1,a.PresentLive=!1,a.PresentLiveTopBar=!1);u.AFrameworkApplication.fa.ka("WacLabelingPoliciesIsEnabled")&&u.AFrameworkApplication.fa.ka("WacApplyManualPolicyLabelIsEnabled")&&this.la.pptLabelingGetPolicyLabelsIsEnabled&&
this.la.pptApplyManualPolicyLabelIsEnabled&&u.AFrameworkApplication.fa.ka("SupportsPolicies")||(a["PptRibbon.Home.Sensitivity"]=!0,a.flySensitivity=!0,this.Uk&&this.Uk.Y9(this.Uk.e5,this.Uk.Vlh));this.la.dictationIsEnabled&&r.a.jwh&&u.AFrameworkApplication.fa.ka("UserCanUseDictation")?(a["PptRibbon.Home.Dictation"]=!1,a.btnStartDictation=!1):this.Uk&&this.Uk.Y9(this.Uk.e5,this.Uk.FYf);a["PptJewel.Open"]&&a["PptJewel.New"]&&(a["PptJewel.Home"]=!0);a["PptJewel.SaveACopy.SaveAsToHost"]&&a["PptJewel.SaveACopy.SaveACopy"]&&
a["PptJewel.SaveACopy.SaveToSharePoint"]&&a["PptJewel.Rename"]&&a["PptJewel.DownloadAs.DownloadACopy"]&&a["PptJewel.DownloadAs.DownloadACopyAsPdf"]&&a["PptJewel.DownloadAs.DownloadACopyAsOdp"]&&a["PptJewel.DownloadAs.DownloadAsImages"]?a["PptJewel.SaveACopy"]=!0:a["PptJewel.SaveACopy"]&&delete a["PptJewel.SaveACopy"];a["PptRibbon.Review.Translate"]=!this.la.R6g;a.FixIt=!this.la.bLc;u.AFrameworkApplication.fa.Kw("IsPresentToTeamsSupportedHost")&&!u.AFrameworkApplication.fa.ka("IsPresentToTeamsSupportedHost")?
(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0):b&&"sharepointcom"!==b&&(a.PresentToTeams=!0,a.PresentToTeamsTopBar=!0);u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&(a.CatchUpWithChanges=!0);up.kzl(vv.Yuj,a);if(u.AFrameworkApplication.dra||!this.la.pptEditInsertAppsForOfficeEnabled||this.la.LUc)a["PptJewel.Addin"]=!0}Tzh(a,b,c,f){a["PptRibbon.InsertTab.Images.FlyPicture"]=!1;a["PptRibbon.InsertTab.Images.FlyPicture.FromHost"]=!c;a["PptRibbon.InsertTab.Images.FlyPicture.FromSearch"]=!b;a["PptRibbon.InsertTab.Images.FlyPicture.FromM365Picture"]=
!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromDevice"]=!1;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromHost"]=!c;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromSearch"]=!b;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Picture"]=!f;a["PptRibbon.Graphics.ShapeStyles.FlyChangeGraphic.FromM365Icon"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromHost"]=!c;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromSearch"]=
!b;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.PictureFormat.Adjust.FlyChangePicture.FromM365Icon"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromDevice"]=!1;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromHost"]=!c;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromSearch"]=!b;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Picture"]=!f;a["PptRibbon.Pictures.ContextMenu.FlyChangePicture.FromM365Icon"]=!f}Szh(a,b){a.InsertPictureFromMobileDevice=
!b;a.ChangePictureFromMobileDevice=!b}static vOj(){const a=u.AFrameworkApplication.fa.Ga("SovereignEnvironmentName"),b=u.AFrameworkApplication.fa.ka("IsTellMeUpSellEnterpriseEnabled");var c=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.FJ);c=!!c&&"teams"===c.toLowerCase();return(!a||!a.length)&&b&&!c}}vv.Yuj={["ellipsisOpenInApp"]:(AB=new Ha.a,AB.add("HostOpenInClient"),AB),["ellipsisOpenInBrowser"]:(zB=new Ha.a,zB.add("HostOpenInBrowser"),zB),["ellipsisDownload"]:(yB=new Ha.a,yB.add("HostDownload"),
yB),["conversation"]:(xB=new Ha.a,xB.add("HostConversation"),xB),["close"]:(cx=new Ha.a,cx.add("HostClose"),cx.add("btnjClose"),cx.add("msJewelSecondary"),cx),["copyLink"]:(wB=new Ha.a,wB.add("CopyLink"),wB),["share"]:(Xy=new Ha.a,Xy.add("jbtnFileSharing"),Xy.add("btnFileSharing"),Xy),["docChat"]:(vB=new Ha.a,vB.add("DocChat"),vB),["openInApp"]:(uB=new Ha.a,uB.add("btnOpenInClient"),uB)};Object(e.a)(vv,"RibbonCommandTrimmer",null,[1215]);class BB{constructor(){this.YFa=this.yl=this.K=null}get name(){return"PowerPointWebEditor.Ribbon"}Wb(a){this.K=
a;a.register(ZA,"PowerPointWebEditor.Ribbon.PPTWebEditReactCommandDefinitionMapping").as("Common.IExternalUICommandDefinitionMapping").ma().na(()=>new ZA(a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1149,"PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").ma().na(()=>new YF(new WA(u.AFrameworkApplication.fa)));let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").rwb;r.a.Nj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").ixa);var c=
this.K.resolve("PowerPointWebEditor.IFileInfo").Sha;let f=2===c||3===c||0===c;c=1===c;const l=a.resolve("PowerPointWebEditor.IApplicationSettings").dgb?a.resolve("PowerPointWebEditor.IPPTRumTracker"):null;f=f&&!c;a.register(vv,"PowerPointWebEditor.Ribbon.RibbonCommandTrimmer").ma().na(()=>new vv(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.IOfficeTrialExperience"),a.resolve("Common.IMacOfficeOffer"),b,f,l));a.register(1150,"PowerPointWebEditor.IModeSwitcherControlActor").ma().na(()=>
new RF(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("Box4.IAppFrame"),wd.a.get_instance(),l));a.register(1151,"PowerPointWebEditor.IRibbonUser").ma().na(()=>{const x=a.resolve("PowerPointWebEditor.IApplicationSettings"),G=a.resolve("PowerPointWebEditor.Ribbon.RibbonCommandTrimmer");var R={};G.vid(R);var fa={};G.y8k(fa);R=
new NF(R,G.Iij(),fa);fa=new QF;const wa=a.resolve("Common.IAppSettingsManager"),Wa=new RG(a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("PowerPointWebEditor.IRibbonPane").xa,a.resolve("PowerPoint.IPathManager"),a.Ka("Box4.IGeneralCuiUser"),a.resolve("Common.IFocusManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.qb("PowerPointWebEditor.Core.IBundleMetricRecorder"),G,R,x,a.resolve("PowerPointWebEditor.IModeSwitcherControlActor"),fa,
l,wa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InvokeFullAppSettingsCallbackImmediately",!1),Object(Ma.a)(109,wa)?wa:null,wa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1),u.AFrameworkApplication.oEb,a.resolve("PowerPointWebEditor.IPresentationResourcesManager"));x.uXf?this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").wvb(()=>{Wa.Iog()}):Wa.Iog();return Wa});a.register(1152,"Common.IRibbonExternal").ma().na(()=>a.resolve("PowerPointWebEditor.IRibbonUser").EXk);
a.register(1153,"PowerPointWebEditor.IRibbonChangeManager").ma().na(()=>new SG(a.resolve("Common.ITaskManager"),a.resolve("Box4.Graph.IGraphInstance").vd(10),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(YA,"PowerPointWebEditor.BusinessBarController").as("PowerPointWebEditor.IBusinessBarController").as("Box4.IBusinessBarController").ma().na(()=>
new YA(a.resolve("CommonUI.IBusinessBar"),new OF,a.resolve("PowerPointWebEditor.AppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IErrorMapping"),u.AFrameworkApplication.fa,a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1154,"PowerPointWebEditor.IBusinessBarPane").ma().na(()=>new TF(a.Ka("CommonUI.IBusinessBar"),a.resolve("PowerPointWebEditor.IApplicationSettings").Qic));a.register(pq,"CommonUI.BusinessBar").as("CommonUI.IBusinessBar").ma().na(()=>
new pq(a.resolve("PowerPointWebEditor.IBusinessBarPane").CDl));a.register(1155,"Common.IRibbonSQMInformation").ma().na(()=>{const x=new ZF(u.AFrameworkApplication.Ta);x.uOk();return x});a.register(1156,"PowerPointWebEditor.IInkRibbonManager").ma().na(()=>new rq(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.View.IViewEventHandlers"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),u.AFrameworkApplication.Aa.jb.m8))}init(){this.YFa=this.K.resolve("PowerPointWebEditor.IModeSwitcherControlActor");
this.K.resolve("PowerPointWebEditor.BusinessBarController").bxk();this.yl=this.K.resolve("PowerPointWebEditor.IBusinessBarController");this.yl.initialize();u.AFrameworkApplication.fa.ka("EarlyInitRibbonUser")?(this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("Common.IRibbonExternal")):this.K.Ka("PowerPointWebEditor.IRibbonUser").execute(()=>{this.K.resolve("Common.IRibbonExternal")});const a=this.K.resolve("PowerPointWebEditor.IBusinessBarPane"),b=this.K.resolve("PowerPointWebEditor.IPaneManager");
var c=document.getElementById("WACDocumentAndTaskPanel");this.K.resolve("PowerPointWebEditor.IApplicationSettings").bjc?(c=document.getElementById("BusinessBarRegion"),b.DNa(a,c,null)):c?b.DNa(a,this.K.resolve("PowerPointWebEditor.AppFrame").c1,c):b.pP(a);this.K.resolve("CommonUI.IBusinessBar");this.K.resolve("PowerPointWebEditor.IInkRibbonManager")}dispose(){this.yl&&this.yl.dispose();this.YFa&&this.YFa.dispose()}static main(){m.a.instance.Bc(new BB)}}Object(e.a)(BB,"PPTWebEditorRibbonPackage",null,
[2,3]);var dx=d(661);class UG{get name(){return"Box4.Insights"}init(){}dispose(){}Wb(a){a.register(dx.a,"Box4.Insights.Box4InsightsSelection").as("Common.App.Insights.IInsightsSelection").as("Box4.Insights.IBox4InsightsSelection").ma().na(()=>new dx.a)}}Object(e.a)(UG,"Box4InsightsPackage",null,[2,3]);class CB{constructor(a,b){this.Rzd=0;this.Kga=new Ha.a;this.Ca=a;this.hd=b}get Tc(){return this.hd}get B7d(){return 0<this.Rzd}a$(a){this.kxg(a)&&this.Rzd++;this.B7d?this.Tc.enabled=!1:this.Kga.add(this.Tc.Kp(a.actionId))}Z9(a){!this.B7d&&
0<this.Kga.count&&(this.Kga.ga(this.Kga.count-1),this.S0f(this.Kga.count-1));this.kxg(a)&&this.Rzd--;this.B7d||(this.Tc.enabled=!0)}S0f(a){if(0<this.Kga.count&&0<=a&&a<this.Kga.count){const b=this.Kga.ga(a);this.Kga.removeAt(a);b.end()}}nqi(){let a=this.Kga.count-1;for(;0<=a;){var b=this.Kga.ga(a);(b=this.Ca.xS(b.activityName))&&b.flags[128]&&this.S0f(a);a--}}kxg(a){if(2!==a.behavior)return!0;a=this.Ca.xS(a.actionId);return!!a&&a.flags[32]}}Object(e.a)(CB,"ActivityActionListener",null,[147]);var Yy;
(function(a){a[a.timeOut=0]="timeOut";a[a.appClose=1]="appClose";a[a.appError=2]="appError"})(Yy||(Yy={}));Object(e.b)("ActivityAutoEndReason",Yy);class DB{constructor(a){this.dha=new ah.a;this.CLb=a}$ci(){for(let a of this.dha.keys)this.adi(a)}a7f(a){if(this.CLb.OCc)for(let b of this.dha.keys){const c=Array.clone(this.dha.ga(b));for(let f=0;f<c.length;f++){const l=c[f];l.DYd();this.Bch(b,a,l.uniqueID)}}}adi(a){var b=this.dha.ga(a);b=this.d9i(b);for(let c=0;c<b.length;c++){const f=b[c];f.DYd();this.Bch(a,
0,f.uniqueID)}}d9i(a){const b=[];for(let c=0;c<a.length;c++){const f=a[c];(new Date).getTime()-f.startTime>f.rUg&&Array.add(b,f)}return b}Bch(a,b,c){const f={};f.AID=c;f.A=a;f.AE=Yy[b];rb.a.instance.Tb("AutoEnded",f)}o9k(){if(this.CLb.OCc){var a=new xe.a(2,2,this.CLb.bdi,Object(C.a)(this,this.$ci,"autoEndLongRunningActivities"),67);u.AFrameworkApplication.pe.Cb(a)}}register(a){if(this.CLb.OCc){var b=a.activityName;this.dha.Jb(b)&&this.dha.ga(b)||this.dha.$(b,[]);Array.add(this.dha.ga(b),a)}}unregister(a){if(this.CLb.OCc){var b=
a.activityName;this.dha.Jb(b)&&this.dha.ga(b)&&Array.remove(this.dha.ga(b),a)}}}Object(e.a)(DB,"ActivityAutoEndHelper",null,[1249]);class Ut{constructor(a){this.XXe=null;this.Gvc=0;this.Htd=this.bG=!1;this.eGd=0;this.Dx=new Lc.a;this.Csb=new Lc.a;this.UIh=a}get kHd(){return this.XXe||(this.XXe=this.UIh())}get properties(){return this.Dx}get rUg(){return this.Gvc}get enabled(){return this.bG}get ended(){return this.Htd}get uniqueID(){return this.eGd}OTg(){const a={};a.ID=this.uniqueID;a.A=this.activityName;
a.ST=this.startTime;a.ET=this.endTime;bb.Ct(this.properties.keys)&&(a.P=Ut.Eeg(this.properties));bb.Ct(this.Csb.keys)&&(a.FP=Ut.Eeg(this.Csb));return a}static Eeg(a){const b={};for(let c of a)b[c.key]=c.value;return b}}Object(e.a)(Ut,"AActivity",null,[447,448]);class EB extends Ut{constructor(a,b,c,f,l,x,G,R){super(G);this.qt=0;this.WIh=a;this.rNh=b;this.Ofa=c;this.Fj=(new Date).getTime();this.VSh=f;this.Rpd=x;this.Gvc=l;this.Rpd.register(this);this.eGd=R()}get activityName(){return this.Ofa}get startTime(){return this.Fj}get endTime(){return this.qt}a1f(a){this.qt=
(new Date).getTime();this.ended?this.bLk():(this.Htd=!0,this.qt=(new Date).getTime(),this.qt<this.Fj&&(Z.ULS.sendTraceTag(8184544,213,50,String.format("EndTime ({0}) is less than StartTime ({1}) for Activity ({2}).",this.qt,this.Fj,this.Ofa)),this.qt=this.Fj),this.Rpd.unregister(this),this.VSh&&(!a&&this.kHd&&this.kHd.enabled?this.eob():this.PWb()))}end(){this.a1f(!1)}DYd(){this.a1f(!0)}bLk(){const a={};a.AN=this.activityName;a.AT=(new Date).getTime();a.AID=this.uniqueID;this.rNh("AlreadyEnded",this.endTime,
a)}eob(){this.kHd.eob()}PWb(){this.WIh(this.OTg())}cancel(){this.ended||(this.Htd=!0,this.Rpd.unregister(this))}}Object(e.a)(EB,"ActivityImpl",Ut,[]);class VG extends Sys.EventArgs{constructor(){super();this.name=this.properties=null}}Object(e.a)(VG,"ActivityRecordedEventArgs",Sys.EventArgs,[]);class Vt{constructor(a,b,c){this.Pa=new ic.a;this.bG=!0;this.settings=a;this.Spd=b;this.Wpd=c}get enabled(){return this.bG&&this.settings.enabled}set enabled(a){this.bG=a}Kp(a,b=-1){-1===b&&(b=this.settings.QFi);
return this.Spd(Object(C.a)(this,this.PWb,"completeActivity"),Object(C.a)(this,this.Cch,"recordEventInternal"),a,this.ODj(a.toString()),b)}Tb(a,b=null){this.Cch(a,(new Date).getTime(),b);this.Pa.raiseEvent("HHR",Object.assign(new VG,{name:a,properties:b}))}Cch(a,b,c){this.ivg(a)&&(a=this.yfg(a,c,b),Z.ULS.sendTraceTag(6068304,213,100,a))}recordError(a,b=null){this.ivg(a.toString())&&(a=this.yfg(a.toString(),b,(new Date).getTime()),Z.ULS.sendTraceTag(6415520,213,100,a))}ODj(a){return this.enabled&&
!this.PDj(a)}ivg(a){return this.enabled&&!this.XHj(a)}PDj(a){return this.settings.SIi.contains(a)}XHj(a){return this.settings.TIi.contains(a)}PWb(a){if(this.Wpd.BNf(a.A.toString())){var b=[];Array.add(b,a);a=Yd.c(b);Z.ULS.sendTraceTag(5894867,213,100,a)}}yfg(a,b,c){const f={};f.ID=Vt.jZd();f.V=a;f.VT=c;b&&(f.P=b);a=[];Array.add(a,f);return Yd.c(a)}static jZd(){return Vt.RZh++}}Vt.RZh=0;Object(e.a)(Vt,"ActivityManagerImpl",null,[446]);class bp{constructor(){this.bG=!1;this.N0e=this.RYe=0;this.QYe=
!1;this.v2e=new Ln.a;this.w2e=new Ln.a}c_b(a){this.bG=Boolean.parse(a[bp.RHj]||"false");this.v2e=this.v5g(a[bp.RIi]);this.w2e=this.v5g(a[bp.UIi]);this.xQi(a)}get enabled(){return this.bG}get SIi(){return this.v2e}get TIi(){return this.w2e}xQi(a){this.QYe=Boolean.parse(a[bp.NEj]||"false");this.RYe=parseInt(a[bp.cdi]||"60000");this.N0e=parseInt(a[bp.RFi]||"5000")}get bdi(){return this.RYe}get QFi(){return this.N0e}get OCc(){return this.QYe}v5g(a){const b=new Ln.a;for(const c of(a||"").split(","))""!==
c&&b.add(c);return b}}bp.RHj="ActivityLoggingIsEnabled";bp.RIi="DisabledClientActivityNames";bp.UIi="DisabledClientActivityEventNames";bp.NEj="ActivityAutoEndEnabled";bp.cdi="ActivityAutoEndTaskInterval";bp.RFi="ActivityDefaultMaxDuration";Object(e.a)(bp,"ActivitySettings",null,[1248]);class wv{constructor(a){this.etd=new Ln.a;this.JRb=new Lc.a;this.Ezc=a;this.p9k()}p9k(){this.Ezc.enabled&&(wv.vzf=new xe.a(2,2,this.Ezc.interval,Object(C.a)(this,this.hKi,"doThrottle"),65),u.AFrameworkApplication.pe.Cb(wv.vzf))}hKi(){this.XVk()}XVk(){this.JRb=
new Lc.a;this.etd=new Ln.a}QDj(a){return this.etd.contains(a)}trl(a){if(this.JRb.Jb(a)){if(this.JRb.ga(a)>=this.Ezc.Hdk)return this.etd.add(a),Z.ULS.sendTraceTag(7696902,213,50,"Activity {0} will be throttled due to too much logging.",a),!1;let b;(b=this.JRb).$(a,b.ga(a)+1)}else this.JRb.add(a,1);return!0}BNf(a){return this.Ezc.enabled?!this.QDj(a)&&this.trl(a):!0}}wv.vzf=null;Object(e.a)(wv,"ActivityThrottler",null,[1247]);class Hr{constructor(){this.bG=!1;this.v8e=this.Xff=0}c_b(a){this.bG=Boolean.parse(a[Hr.jVd]||
"false");this.Xff=parseInt(a[Hr.Idk]||"600");this.v8e=parseInt(a[Hr.FCj]||"600000")}get enabled(){return this.bG}get Hdk(){return this.Xff}get interval(){return this.v8e}}Hr.jVd="ActivityThrottlerEnabled";Hr.Idk="ActivityThrottlerMaxActivities";Hr.FCj="ActivityThrottlerInterval";Object(e.a)(Hr,"ActivityThrottlerSettings",null,[1246]);class FB{constructor(){this.Da=null}get name(){return"Common.App.Activities"}init(){this.ezj()}ezj(){const a=this.Da.resolve("Common.App.Activities.IActivitySettings"),
b=u.AFrameworkApplication.fa.appSettings;a.c_b(b);this.Da.resolve("Common.App.Activities.IActivityThrottlerSettings").c_b(b);if(a.enabled){rb.a.instance=new Vt(this.Da.resolve("Common.App.Activities.IActivitySettings"),(l,x,G,R,fa)=>new EB(l,x,G,R,fa,this.Da.resolve("Common.App.Activities.IActivityAutoEndHelper"),()=>this.Da.qb("Common.App.Activities.IActivityAggregationManager"),Vt.jZd),this.Da.resolve("Common.App.Activities.IActivityThrottler"));var c=this.Da.resolve("Common.App.Activities.ActivityAutoEndHelper"),
f=this.Da.resolve("Common.App.Activities.ActivityActionListener");c.o9k();u.AFrameworkApplication.ofa(()=>{f.nqi();c.a7f(1)});u.AFrameworkApplication.Ta.Jma(f);u.AFrameworkApplication.sBc((l,x)=>{rb.a.instance.recordError(x.errorCode,{["ErrorCause"]:x.VVd,["ErrorResolution"]:x.WVd});c.a7f(2)})}}dispose(){}Wb(a){this.Da=a;a.register(bp,"Common.App.Activities.ActivitySettings").as("Common.App.Activities.IActivitySettings").ma();a.register(DB,"Common.App.Activities.ActivityAutoEndHelper").as("Common.App.Activities.IActivityAutoEndHelper").ma().na(()=>
new DB(a.resolve("Common.App.Activities.IActivitySettings")));a.register(CB,"Common.App.Activities.ActivityActionListener").na(()=>new CB(u.AFrameworkApplication.Ta,a.resolve("Common.IActivityManager")));a.register(Hr,"Common.App.Activities.ActivityThrottlerSettings").as("Common.App.Activities.IActivityThrottlerSettings").ma().na(()=>new Hr);a.register(wv,"Common.App.Activities.ActivityThrottler").as("Common.App.Activities.IActivityThrottler").ma().na(()=>new wv(a.resolve("Common.App.Activities.IActivityThrottlerSettings")))}static main(){m.a.instance.Bc(new FB)}}
Object(e.a)(FB,"ActivitiesPackage",null,[2,3]);class WG{constructor(){this.foa=new Lc.a}hKe(a,b){this.foa.$(a,b)}sZd(a){({value:a}=this.foa.Rf(a));return a}}Object(e.a)(WG,"AggregationMethodsForActivityName",null,[]);class GB{constructor(){this.mxc=new ah.a;this.foa=new ah.a}hKe(a,b,c){this.foa.Jb(a)&&this.foa.ga(a)||this.foa.$(a,new WG);this.foa.ga(a).hKe(b,c)}sZd(a,b){return this.foa.Jb(a)&&this.foa.ga(a)?this.foa.ga(a).sZd(b):null}k1b(a){this.mxc.Jb(a)&&this.mxc.ga(a)||this.mxc.$(a,new Ln.a);return this.mxc.ga(a)}qFi(a,
b){this.k1b(a).add(b)}}Object(e.a)(GB,"ActivityAggregationInfo",null,[431]);class ex extends Ut{constructor(a,b){super(a);this.eGd=(this.VIh=b)?b.R5i():Vt.jZd()}get jha(){return this.VIh}get activityName(){return this.jha.name}get startTime(){return this.jha.startTime}get endTime(){return this.jha.endTime}end(){}cancel(){}DYd(){}Ewl(){this.Csb.$("AM",this.jha.mode.toString());this.Csb.$("C",this.jha.count.toString());this.Csb.$("DA",this.jha.I_f.toFixed(2));this.Csb.$("DV",this.jha.qLi.toFixed(2))}o2d(a){return this.jha.o2d(a)}P2d(){return this.jha.P2d()}eob(){for(let a of this.jha.kha)a.eob()}}
Object(e.a)(ex,"AggregatedActivity",Ut,[]);class XG{constructor(a,b){this.kqd=0;this.Ofa=a;this.wya=b}Z9h(a,b){this.kqd=b;for(b=0;b<a.count;b++){const c=a.ga(b);this.$9h(c)}}$9h(a){const b=Object(ua.a)(ex,a);if(b)if(1===this.kqd)this.W9h(b);else if(2===this.kqd){this.a$h(b);for(let c of this.wya.k1b(this.Ofa)){const f=b.jha.kha.ga(0);f.properties.Jb(c)&&a.properties.$(c,f.properties.ga(c))}}}W9h(a){for(let b of this.wya.k1b(this.Ofa))this.ijh(a,b)}a$h(a){for(let b of a.P2d())this.ijh(a,b)}ijh(a,b){const c=
this.wya.sZd(this.Ofa,b);if(c){const f=a.o2d(b);a.properties.$(b,c(f))}}}Object(e.a)(XG,"PropertyAggregationHelper",null,[]);class HB{constructor(a,b,c,f,l){this.Gjb=a;this.wya=b;this.$_e=l;this.Wpd=f;this.yRh=c}get ACf(){return this.yRh.value}PWb(a){if(Object(Ma.a)(EB,a))a.PWb();else if(Object(Ma.a)(ex,a)&&this.Wpd.BNf(a.activityName.toString())){a=Object(ua.a)(ex,a);a.Ewl();a=a.OTg();var b=[];Array.add(b,a);a=Yd.c(b);Z.ULS.sendTraceTag(6907266,213,50,a)}}jUb(a,b){const c=(new Date).getTime();var f=
this.$_e.list.ga(a);const l=({b$h:f}=this.MZi(f)).returnValue;this.$_e.list.$(a,new Ha.a);b&&(f=this.txi(f,c,this.Gjb.Kig));0<f.count&&(new XG(a,this.wya)).Z9h(f,l)}txi(a,b,c){const f=new Ha.a;for(let l=0;l<a.count;l++){const x=a.ga(l);x.startTime>b-c?x.eob():f.add(x)}return f}MZi(a){const b=this.ACf.zyh(a);a=this.ACf.ool(a);const c=this.c$h(b,a);return{returnValue:c,b$h:1===c?b:a}}c$h(a,b){return a.count*this.Gjb.zVg<b.count?1:2}get enabled(){return this.Gjb.enabled}eob(){}}Object(e.a)(HB,"ActivityAggregationManager",
null,[430]);class xo{constructor(a){this.enabled=!1;this.yUg=500;this.eVg=2;this.rld=6E4;this.zVg=5;this.Kig=3E4;this.c_b(a.appSettings)}c_b(a){this.enabled=Boolean.parse(a[xo.jVd]||"false");this.yUg=parseInt(a[xo.Xdk]||"500");this.eVg=parseInt(a[xo.kfk]||"2");this.rld=parseInt(a[xo.Dml]||"60000");this.zVg=parseInt(a[xo.yfk]||"5");this.Kig=parseInt(a[xo.hlj]||"30000")}}xo.jVd="ActivityAggregationEnabled";xo.Xdk="ActivityAggregationMaxInterval";xo.kfk="ActivityAggregationMinChain";xo.Dml="ActivityAggregationTaskInterval";
xo.yfk="ActivityAggregationModeFactor";xo.hlj="ActivityAggregationGraceWindow";Object(e.a)(xo,"ActivityAggregationParams",null,[]);class IB{constructor(a,b){this.wya=a;this.YXe=b}zyh(a,b=1){if(!a||!a.count)return a;const c=new Ha.a;var f=null;for(let l=0;l<a.count;l++){const x=a.ga(l);if(!x)continue;const G=x.activityName;f?f.FSj(x)?f.add(x):(f=f.process(),c.addRange(f),f=this.YXe(G,b),f.add(x)):(f=this.YXe(G,b),f.add(x))}f&&(a=f.process(),c.addRange(a));return c}ool(a){if(!a||!a.count)return a;const b=
{};var c=null;for(let l=0;l<a.count;l++){const x=a.ga(l);if(x){if(!c){c=new Ha.a;var f=this.wya.k1b(x.activityName);for(let G of f)c.add(G)}f=this.Sbj(x,c);null!==f&&(f in b&&b[f]||(b[f]=new Ha.a),b[f].add(x))}}a=new Ha.a;for(const l of ta.a.JK(b))c=this.zyh(b[l],2),a.addRange(c);return a}Sbj(a,b){let c="";for(let f of b)c+=f,c=a.properties.Jb(f)&&void 0!==a.properties.ga(f)&&null!==a.properties.ga(f)?c+a.properties.ga(f):c+"null";return c}}Object(e.a)(IB,"ActivityAggregationSchemes",null,[427]);
class YG{constructor(a,b,c,f,l){this.qt=this.Fj=0;this.Gjb=c;this.Spd=f;this.wya=l;this.name=a;this.vy=b;this.kha=new Ha.a}get mode(){return this.vy}get count(){return this.kha.count}get startTime(){return this.Fj}get endTime(){return this.qt}get I_f(){if(!this.count)return 0;let a=0;for(let b of this.kha)a+=b.endTime-b.startTime;return a/this.count}get qLi(){if(!this.count)return 0;let a=0;const b=this.I_f;for(let c of this.kha){const f=c.endTime-c.startTime;a+=(f-b)*(f-b)}return a/this.count}add(a){this.count?
this.qt=a.endTime>this.endTime?a.endTime:this.endTime:(this.Fj=a.startTime,this.qt=a.endTime);this.kha.add(a)}FSj(a){return 0>=this.count?!1:a.startTime-this.endTime<=this.Gjb.yUg}process(){if(this.count>=this.Gjb.eVg){const a=new Ha.a,b=this.Spd(this);a.add(b);return a}return this.kha}o2d(a){const b=new Ha.a;for(let c of this.kha)if(c.properties.Jb(a)){const f=c.properties.ga(a);b.add(f)}else b.add(null);return b}P2d(){const a=this.wya.k1b(this.name),b=new Ln.a;for(let c of this.TZi())a.contains(c)||
b.add(c);return b}TZi(){const a=new Ln.a;if(!this.kha)return a;for(let b of this.kha)for(let c of b.properties.keys)a.add(c);return a}R5i(){return this.kha.ga(0).uniqueID}}Object(e.a)(YG,"ActivityCollection",null,[424]);class JB{constructor(){this.U_a=new ah.a}get list(){return this.U_a}add(a){const b=a.activityName;if(this.U_a.Jb(b)&&this.U_a.ga(b)){const c=this.j7i(this.U_a.ga(b),a);this.U_a.ga(b).insert(c,a)}else this.U_a.$(b,new Ha.a),this.U_a.ga(b).add(a)}j7i(a,b){for(let c=a.count-1;0<=c;c--)if(b.startTime>
a.ga(c).startTime)return c+1;return 0}}Object(e.a)(JB,"CompletedActivitiesHelper",null,[423]);class KB{constructor(){this.Da=null}get name(){return"Common.App.ActivityAggregator"}init(){u.AFrameworkApplication.ofa(()=>{this.Da.resolve("Common.App.ActivityAggregator.ActivityAggregationManager")})}dispose(){}Wb(a){this.Da=a;const b=f=>new ex(()=>a.qb("Common.App.Activities.IActivityAggregationManager"),f),c=(f,l)=>new YG(f,l,a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),b,a.resolve("Common.IActivityAggregationInfo"));
a.register(HB,"Common.App.ActivityAggregator.ActivityAggregationManager").as("Common.App.Activities.IActivityAggregationManager").ma().na(()=>new HB(a.resolve("Common.App.ActivityAggregator.ActivityAggregationParams"),a.resolve("Common.IActivityAggregationInfo"),a.le("Common.App.ActivityAggregator.IActivityAggregationSchemes"),a.resolve("Common.App.Activities.IActivityThrottler"),a.resolve("Common.App.ActivityAggregator.CompletedActivitiesHelper")));a.register(xo,"Common.App.ActivityAggregator.ActivityAggregationParams").ma().na(()=>
new xo(u.AFrameworkApplication.fa));a.register(GB,"Common.App.ActivityAggregator.ActivityAggregationInfo").as("Common.IActivityAggregationInfo").ma().na(()=>new GB);a.register(IB,"Common.App.ActivityAggregator.ActivityAggregationSchemes").as("Common.App.ActivityAggregator.IActivityAggregationSchemes").ma().na(()=>new IB(a.resolve("Common.IActivityAggregationInfo"),c));a.register(JB,"Common.App.ActivityAggregator.CompletedActivitiesHelper").ma().na(()=>new JB)}static main(){m.a.instance.Bc(new KB)}}
Object(e.a)(KB,"ActivityAggregatorPackage",null,[2,3]);var ZG=d(15);class Xq{constructor(){this.PXk="getAddinShortcutsPreference";this.QXk="saveAddinShortcutsPreference";this.RXk="{0}RoamingServiceHandler.ashx?action={1}&{2}";this.FZi=6E4;this.R7c=this.k7=this.gY=null}afg(a){let b=u.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"";u.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7445267_RoamingServiceBaseURLFix")&&!b.endsWith("/")&&(b+="/");return String.format(this.RXk,
b,a,u.AFrameworkApplication.hh)}executeRequest(a,b,c,f,l=null){return Xq.oba.Xnb(a,b,l,null,2,c,f,!1,null,this.FZi)}saveSetting(a,b,c,f,l){return this.mkh(a,b,c,null,f,l)}startBatchUpdateScope(){this.R7c=[]}saveShortcutInfoArrayBatch(a,b,c){this.IZk(c,a,b)}IZk(a,b,c){const f={action:"",addinId:"",ownerType:0};f.timestamp=(new Date).toUTCString();const l=this.getShortcutInfoArray(b.toString(),c.toString());a?(f.shortcutInfoArray=a,this.yHd(b,c,a)):l&&(f.shortcutInfoArray=l);a={};a[b.toString()]=f;
b=new ZG.a(c.toString(),a);this.R7c.push(b)}commitBatchUpdateScope(){return this.cmc()?this.KZk().then(()=>{this.qpb();return Promise.resolve(!0)}):this.MZk().then(()=>{this.qpb();return Promise.resolve(!0)})}KZk(){return this.getSetting().then(a=>{let b=null;if(a&&!({ou:b}=Yd.d(a)).returnValue)return Z.ULS.sendTraceTag(522739852,0,10,"SaveSettingToLocalStorageBatch failed due to failed to deserialize the settings"),Promise.resolve(!1);b||(b={});for(const c of this.R7c){(a=b[c.key])||(a={});const f=
c.value;for(const l of ta.a.JK(f))a[l]=f[l];b[c.key]=a}this.gY=b;try{return localStorage.setItem("AddinShortcutPreferenceData",Yd.c(b)),Promise.resolve(!0)}catch(c){return Z.ULS.sendTraceTag(522739853,0,10,"SaveSettingToLocalStorageBatch failed",c),Promise.resolve(!1)}})}MZk(){return this.N1k().then(a=>this.vgd(a))}N1k(){return this.V2d().then(a=>{let b=null;a&&(({ou:b}=Yd.d(a)).returnValue||Z.ULS.sendTraceTag(522739854,0,10,"SerializeNewSettingWithSavedRoamingSettingsBatch failed due to failed to deserialize the settings"));
b||(b={});for(const c of this.R7c){(a=b[c.key])||(a={});const f=c.value;for(const l of ta.a.JK(f))a[l]=f[l];b[c.key]=a}this.gY=b;return Yd.c(b)})}saveShortcutInfoArray(a,b,c){return this.mkh(0,"","",c,a,b)}mkh(a,b,c,f,l,x){const G=this.cmc(),R={};R.action=c;R.addinId=b;R.ownerType=a;R.timestamp=(new Date).toUTCString();b=this.getShortcutInfoArray(l.toString(),x.toString());0===a&&f?(R.shortcutInfoArray=f,this.yHd(l,x,f)):b&&(R.shortcutInfoArray=b);a={};a[l.toString()]=R;l=new ZG.a(x.toString(),a);
return G?this.JZk(l):this.LZk(l)}JZk(a){return this.getSetting().then(b=>{let c=null;if(b&&!({ou:c}=Yd.d(b)).returnValue)return Z.ULS.sendTraceTag(522739855,0,10,"SaveSettingToLocalStorage failed due to failed to deserialize the settings"),Promise.resolve(!1);c||(c={});c[a.key]=a.value;this.gY=c;try{return localStorage.setItem("AddinShortcutPreferenceData",Yd.c(c)),Promise.resolve(!0)}catch(f){return Z.ULS.sendTraceTag(522739856,0,10,"SaveSettingToLocalStorage failed",f),Promise.resolve(!1)}})}LZk(a){return this.M1k(a).then(b=>
this.vgd(b))}M1k(a){return this.V2d().then(b=>{let c=null;b&&(({ou:c}=Yd.d(b)).returnValue||Z.ULS.sendTraceTag(522739857,0,10,"SerializeNewSettingWithSavedRoamingSettings failed due to failed to deserialize the settings"));c||(c={});c[a.key]=a.value;this.gY=c;return Yd.c(c)})}saveSettings(a){this.gY=Yd.a(a);this.qpb();return this.cmc()?this.nkh(a):this.vgd(a)}nkh(a){try{return localStorage.setItem("AddinShortcutPreferenceData",a),Promise.resolve(!0)}catch(b){return Z.ULS.sendTraceTag(522739858,0,
10,"SaveSettingToLocalStorage failed",b),Promise.resolve(!1)}}vgd(a){const b={};b.Wac=a;const c=Yd.c(b);return new Promise(f=>{try{if(void 0===c||null===c||!c.length||1E6<=c.length)f(!1);else{var l=this.executeRequest(this.afg(this.QXk),2,"SaveAddinShortcutsPreferenceRequest","38",c);l.continueWith(()=>{if(l.Jn||l.hm)Z.ULS.sendTraceTag(522739859,0,10,"SaveAddinShortcutsPreference: Request failure"),f(!1);else{var x=l.result;void 0!==x.Ui&&null!==x.Ui&&void 0!==x.Ui.data&&null!==x.Ui.data&&x.Ui.data.Le===
dq.a.py?f(!0):f(!1)}})}}catch(x){Z.ULS.sendTraceTag(522739860,0,10,"SaveAddinShortcutPerferrenceSettings: Exception = {0}",x.toString()),f(!1)}})}getSetting(){const a=this.cmc();return this.gY?Promise.resolve(Yd.c(this.gY)):a?this.Bej():this.V2d()}cmc(){const a=u.AFrameworkApplication.fa.ka("IsAnonymousUser"),b=u.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled");return a||!b}Bej(){try{const a=localStorage.getItem("AddinShortcutPreferenceData");return Promise.resolve(a)}catch(a){return Z.ULS.sendTraceTag(522739861,
0,10,"GetSettingFromLocalStorage failed",a),Promise.resolve("")}}V2d(){return new Promise((a,b)=>{try{const c=this.executeRequest(this.afg(this.PXk),1,"GetSettingRequest","37");c.continueWith(()=>{if(c.Jn||c.hm)Z.ULS.sendTraceTag(522739862,0,10,"GetSettingFromRoaming : Request failure");else{let l="";var f=c.result;f&&f.Ui&&f.Ui.data?f.Ui.data.Le!==dq.a.py?Z.ULS.sendTraceTag(522739864,0,10,"GetSettingFromRoaming : Received error response {0}",f.Ui.data.Le):f.Ui.data.Sd?(f=Yd.a(f.Ui.data.Sd),f.Wac&&
(l=f.Wac)):Z.ULS.sendTraceTag(522739865,0,10,"GetSettingFromRoaming : ResponseData is null"):Z.ULS.sendTraceTag(522739863,0,10,"GetSettingFromRoaming : Data is null");a(l)}})}catch(c){Z.ULS.sendTraceTag(522739866,0,10,"GetSettingFromRoaming Exception handling request {0}",c.toString()),b("GetSettingFromRoaming Request Exception")}})}clearSettingByAddinId(a){const b=this.cmc(),c=this;return this.getSetting().then(f=>{let l=null;f&&(l=Yd.a(f));if(!l)return Z.ULS.sendTraceTag(522739867,0,50,"savedRoamingSetting is empty and nothing to clear "),
Promise.resolve(!0);for(const x of ta.a.JK(l)){f=l[x.toString()];for(const G of ta.a.JK(f)){const R=f[G];if(R.addinId===a)delete f[G.toString()];else if(0===R.ownerType&&R.shortcutInfoArray){const fa=R.shortcutInfoArray,wa=new Ha.a;for(let Wa=0;Wa<fa.length;++Wa)fa[Wa].addinId!==a&&wa.add(fa[Wa]);R.shortcutInfoArray=wa.toArray()}}ta.a.count(f)||delete f[x]}c.gY=l;c.FPk(a);return b?c.nkh(Yd.c(l)):c.vgd(Yd.c(l))})}qpb(){if(this.gY){this.k7=null;const c=this.gY;for(let f in c){var a=f;const l=c[f];for(let x in l){var b=
x;const G=l[x];G.shortcutInfoArray&&this.yHd(parseInt(b),parseInt(a),G.shortcutInfoArray)}}}}loadShortcutsPreferenceMappingTable(){return this.getSetting().then(a=>{let b=null;if(a&&!({ou:b}=Yd.d(a)).returnValue)return Z.ULS.sendTraceTag(522739868,0,10,"LoadShortcutsPreferenceMappingTable is failed since savedRoamingSetting cannot be deserialized"),Promise.resolve(!1);this.gY=b;this.qpb();return Promise.resolve(!0)})}getShortcutsPreferenceInfoByAddinId(a,b,c){return this.gY&&(c=this.gY[c])&&(b=c[b])&&
b.addinId===a?b:null}getShortcutInfoArray(a,b){return this.gY&&(b=this.gY[b])&&(a=b[a])&&a.shortcutInfoArray?a.shortcutInfoArray:null}setShortcutInfoWithinBatchUpdateScope(a,b,c){this.saveShortcutInfoArrayBatch(parseInt(a),parseInt(b),c)}setShortcutInfoArray(a,b,c){return this.saveShortcutInfoArray(parseInt(a),parseInt(b),c).then(()=>{this.qpb();return Promise.resolve(!0)})}removeActionFromShortcutInfoArray(a,b){if(!this.k7)return Promise.resolve(!0);var c=this.k7[a];if(!c)return Promise.resolve(!0);
var f=c[b];c=f.modifiers;f=f.keyCode;const l=this.getShortcutInfoArray(c.toString(),f.toString());if(!l||!l.length)return Promise.resolve(!0);let x=0;for(const G of l){if(G.addinId===a&&G.action===b)break;++x}if(x>=l.length)return Promise.resolve(!0);l.splice(x,1);return this.saveShortcutInfoArray(c,f,l).then(()=>{this.qpb();return Promise.resolve(!0)})}yHd(a,b,c){this.k7||(this.k7={});for(const f of c){c=f.addinId;const l=f.action;let x=this.k7[c];x||(x={});const G={};G.modifiers=a;G.keyCode=b;x[l]=
G;this.k7[c]=x}}FPk(a){a in this.k7&&delete this.k7[a]}isActionCustomized(a,b){return this.k7&&(a=this.k7[a])&&a[b]?!!a[b]:!1}getShortcutByCustomizedAction(a,b){return this.k7&&(a=this.k7[a])?a[b]:null}getShortcutsPreferenceMappingTable(){return this.gY}static instance(){Xq.eJd||(Z.ULS.sendTraceTag(522739851,0,50,"AddinShortcutsPreferenceSettingHelper"),Xq.eJd=new Xq,Xq.oba=u.AFrameworkApplication.Ge);return Xq.eJd}}Xq.eJd=null;Xq.oba=null;Object(e.a)(Xq,"AddinShortcutsPreferenceSettingHelper",null,
[]);class $G{constructor(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=
this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}}Object(e.a)($G,"BrowserInfo",null,[]);class aH{constructor(){this.Version=this.Name=null}}Object(e.a)(aH,"PluginInfo",null,[]);class ck{static TYj(){if(u.AFrameworkApplication.fa.ka("LogBrowserInfoIsEnabled")){var a=ck.XXi();try{const b=JSON.stringify(a);Z.ULS.sendTraceTag(6903563,102,50,b)}catch(b){Z.ULS.sendTraceTag(6903564,102,15,b.message)}}else Z.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}static ibj(){const a=
window.navigator.plugins;if(!a||!a.length)return null;const b=[];for(let c=0;c<a.length;c++){const f=a[c].name,l=a[c].version;Array.add(b,Object.assign(new aH,{Name:f,Version:l}))}return b}static XXi(){const a=new $G,b=new Sys.StringBuilder;ck.FA(c=>{a.DocElemClientHeight=c},()=>document.documentElement.clientHeight,b);ck.FA(c=>{a.DocElemClientWidth=c},()=>document.documentElement.clientWidth,b);ck.FA(c=>{a.DocElemOffsetHeight=c},()=>document.documentElement.offsetHeight,b);ck.FA(c=>{a.DocElemOffsetWidth=
c},()=>document.documentElement.offsetWidth,b);ck.FA(c=>{a.ScreenAvailHeight=c},()=>window.screen.availHeight,b);ck.FA(c=>{a.ScreenAvailWidth=c},()=>window.screen.availWidth,b);ck.FA(c=>{a.ScreenWidth=c},()=>window.screen.width,b);ck.FA(c=>{a.ScreenHeight=c},()=>window.screen.height,b);ck.FA(c=>{a.ScreenLogicalXdpi=c},()=>window.screen.logicalXDPI,b);ck.FA(c=>{a.ScreenLogicalYdpi=c},()=>window.screen.logicalYDPI,b);ck.FA(c=>{a.ScreenDeviceXdpi=c},()=>window.screen.deviceXDPI,b);ck.FA(c=>{a.ScreenDeviceYdpi=
c},()=>window.screen.deviceYDPI,b);ck.FA(c=>{a.WinInnerHeight=c},()=>window.self.innerHeight,b);ck.FA(c=>{a.WinInnerWidth=c},()=>window.self.innerWidth,b);ck.FA(c=>{a.WinOuterHeight=c},()=>window.self.outerHeight,b);ck.FA(c=>{a.WinOuterWidth=c},()=>window.self.outerWidth,b);ck.FA(c=>{a.WinOrientation=c},()=>window.self.orientation,b);ck.FA(c=>{a.WinDevicePixelRatio=c},()=>window.self.devicePixelRatio,b);ck.FA(c=>{a.SupportsTouch=c},()=>r.a.FJa,b);ck.FA(c=>{a.NavAppName=c},()=>window.navigator.appName,
b);ck.FA(c=>{a.NavAppVersion=c},()=>window.navigator.appVersion,b);ck.FA(c=>{a.NavLanguage=c},()=>window.navigator.browserLanguage||window.navigator.language,b);ck.FA(c=>{a.NavUserAgent=c},()=>window.navigator.userAgent,b);ck.FA(c=>{a.NavPlatform=c},()=>window.navigator.platform,b);ck.FA(c=>{a.NavPlugins=c},ck.ibj,b);ck.FA(c=>{a.CalculatedDevicePixelRatio=c},()=>ck.devicePixelRatio,b);a.Error=b.toString();return a}static get devicePixelRatio(){const a=window.devicePixelRatio;return isNaN(a)?window.screen.deviceXDPI/
window.screen.logicalXDPI:a}static FA(a,b,c){try{const f=b();a(f)}catch(f){c.isEmpty()||c.append(" | "),c.append(f.message||"null")}}}Object(e.a)(ck,"BrowserInfoLogger",null,[]);class LB{get name(){return"Common.App.BrowserInfoLogger"}Wb(){}init(){ck.TYj()}dispose(){}static main(){m.a.instance.Bc(new LB)}}Object(e.a)(LB,"BrowserInfoLoggerPackage",null,[2,3]);class MB{get name(){return"Common.App.DialogWithLinkToResource"}Wb(){}init(){}dispose(){}static main(){m.a.instance.Bc(new MB)}}Object(e.a)(MB,
"CommonAppDialogWithLinkToResourcePackage",null,[2,3]);var BP=d(695);class NB{get name(){return"Common.App.EventsCachePackage"}Wb(){}init(){BP.a.instance.init()}dispose(){}static main(){m.a.instance.Bc(new NB)}}Object(e.a)(NB,"EventsCachePackage",null,[2,3]);class OB{constructor(a,b,c){this.z2a=null;this.Rd=a;this.Ca=b;this.T4e=c.create()}gjc(){this.z2a?Z.ULS.sendTraceTag(23674911,207,50,"The current task is not null, re-use it."):(Z.ULS.sendTraceTag(23674910,207,50,"The current sho pane task is null, create new one."),
this.z2a=new xe.a(2,1,3E4,Object(C.a)(this,this.vjd,"showFloatPane"),67),this.Rd.Cb(this.z2a))}vjd(){this.z2a=null;Z.ULS.sendTraceTag(23674912,207,50,"The float pane is shown after the task is executed.");this.T4e.display()}xwa(){this.Ca.ya(F.a.vjd,xd.a.frame,Object(C.a)(this,this.Idl,"showFloatPaneHandler"))}Idl(a,b,c,f,l){return a!==F.a.vjd?2:1===c?32:2===c&&l?(Z.ULS.sendTraceTag(23674913,207,50,"The application wants to show or hide float pane with argument {0}.",l),l?this.gjc():(this.z2a?(Z.ULS.sendTraceTag(23674914,
207,50,"Hide float pane via removing show task!"),this.Rd.Ng(this.z2a)):(Z.ULS.sendTraceTag(23674915,207,50,"Hide float pane immediately!"),this.T4e.remove(null)),this.z2a=null),32):8}}Object(e.a)(OB,"FloatPaneActor",null,[481]);class bH{constructor(a,b,c,f,l){this.Dyd=this.nOb=this.Oxc=this.Hza=this.G1=this.Fya=this.drd=this.SY=this.KQb=this.NPb=this.OPb=this.nud=null;this.Rd=b;this.eb=a;this.zn=c;this.Da=l;this.T5=f}YTf(){this.SY=document.createElement("div");this.SY.className=String.format("{0} {1}",
"WACFloatPane","WACFloatPaneFadeIn");this.SY.style.width=this.G1.width+"px";(this.Dyd=this.V$i(this.T5))?(this.Hza=document.createElement("a"),this.Hza.setAttribute(Jc.a.Ye,Jc.a.KM),this.zn.ob(ma.a.click,this.Hza,Object(C.a)(this,this.B1g,"onRedirectClick")),this.Hza.href=this.Dyd,this.Hza.target="_blank",this.Hza.appendChild(this.G1),this.SY.appendChild(this.Hza)):this.SY.appendChild(this.G1);this.Fya=document.createElement("a");this.Fya.setAttribute(Jc.a.Ye,Jc.a.hu);this.Fya.className="StandardButton WACFloatPaneCloseButton";
this.Fya.title=CommonUIStrings.l_Close;this.Fya.tabIndex=-1;this.drd=vo.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","StandardButtonImage clip16x16 StandardButtonImageNoText",!0,null);this.drd.setAttribute(Jc.a.Ye,Jc.a.KM);this.Fya.appendChild(this.drd);this.zn.ob(ma.a.click,this.Fya,Object(C.a)(this,this.onClose,"onClose"));this.SY.appendChild(this.Fya);this.KQb.appendChild(this.SY)}hk(a){const b=this.eb.ka("O365PromotionHasStarted");switch(a){case 2:return sp.a.uK(String.format("adppt{0}.png",
b?"sale":""));case 1:return sp.a.uK(String.format("adxls{0}.png",b?"sale":""));case 3:return sp.a.uK(String.format("addoc{0}.png",b?"sale":""))}return null}V$i(a){const b=this.eb.Ga("O365AdPaneRedirectedURL");switch(a){case 1:return String.format(b,"Excel");case 2:return String.format(b,"PowerPoint");case 3:return String.format(b,"Word")}return null}hide(a=null){this.nOb=null;this.SY&&!this.Oxc&&(a?Z.ULS.sendTraceTag(23674904,207,50,"The float pane is closed automatically."):Z.ULS.sendTraceTag(23674903,
207,50,"User clicks button to close the float pane."),this.SY.className=String.format("{0} {1}","WACFloatPane","WACFloatPaneFadeOut"),this.SY.style.height="0px",this.Oxc=new xe.a(2,1,1E3,Object(C.a)(this,this.remove,"remove"),67),this.Rd.Cb(this.Oxc))}remove(){this.SY&&this.KQb&&(this.Hza&&this.zn.xb(ma.a.click,this.Hza,Object(C.a)(this,this.B1g,"onRedirectClick")),this.zn.xb(ma.a.click,this.Fya,Object(C.a)(this,this.onClose,"onClose")),this.KQb.removeChild(this.SY),this.SY=null);this.Oxc=null}display(){if(this.nud=
this.Da.qb("Common.IFloatPaneContainer"))if(this.KQb=this.nud.container){var a=this.hk(this.T5);a?(Z.ULS.sendTraceTag(23674908,207,50,"Begin downloading image from server: {0}.",a),this.G1=document.createElement("img"),this.G1.className="WACFloatPaneImage",this.OPb=Object(C.a)(this,this.Pnk,"onLoadImageFinish"),Ed.a.addHandler(this.G1,ma.a.load,this.OPb),this.NPb=Object(C.a)(this,this.Onk,"onLoadImageError"),Ed.a.addHandler(this.G1,ma.a.error,this.NPb),this.G1.src=a):Z.ULS.sendTraceTag(23674907,207,
15,"The target image is empty, can't show the float pane.")}else Z.ULS.sendTraceTag(23674906,207,15,"The container is empty, so the float pane can't be shown.");else Z.ULS.sendTraceTag(23674905,207,50,"The IFloatPaneContainer is not registered and the float pane can't be shown.")}Pnk(){const a=this.eb.Cc("O365AdPaneShowingDuration",60);this.YTf();this.SY.style.display="block";this.SY.style.height=this.G1.height+"px";this.nOb=new xe.a(2,1,1E3*a,Object(C.a)(this,this.hide,"hide"),67);this.Rd.Cb(this.nOb);
this.reh()}Onk(){Z.ULS.sendTraceTag(23674909,207,15,"The image can't be downloaded, the float pane can't be shown.");this.reh();this.G1=null}reh(){this.OPb&&this.G1&&Ed.a.removeHandler(this.G1,ma.a.load,this.OPb);this.OPb=null;this.NPb&&this.G1&&Ed.a.removeHandler(this.G1,ma.a.error,this.NPb);this.NPb=null}B1g(){Z.ULS.sendTraceTag(35698659,207,50,"User click the float pane and a new web page will be opened.");return!1}onClose(){this.nOb&&this.Rd.Ng(this.nOb);this.hide();return!0}dispose(){this.hide()}}
Object(e.a)(bH,"FloatPane",null,[442]);class PB{constructor(a,b,c,f,l){this.Rd=b;this.eb=a;this.zn=c;this.Da=l;this.T5=f}create(){return new bH(this.eb,this.Rd,this.zn,this.T5,this.Da)}}Object(e.a)(PB,"FloatPaneFactory",null,[409]);class QB{constructor(){this.Da=null}get name(){return"Common.App.FloatPane"}get Mvg(){return u.AFrameworkApplication.fa.ka("O365AdvertisementIsEnabled")&&u.AFrameworkApplication.fa.ka("IsShowAdvertisementPaneEnabled")}init(){this.Mvg&&(Z.ULS.sendTraceTag(23674944,207,50,
"Setup task to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").gjc(),Z.ULS.sendTraceTag(23674945,207,50,"Setup action for excel to show the float pane."),this.Da.resolve("Common.App.FloatPane.IFloatPaneActor").xwa())}Wb(a){this.Da=a;this.Mvg&&(this.Da.register(PB,"Common.App.FloatPane.FloatPaneFactory").as("Common.App.FloatPane.IFloatPaneFactory").na(()=>new PB(u.AFrameworkApplication.fa,u.AFrameworkApplication.pe,cd.a.instance,u.AFrameworkApplication.Aa.jb.rm,this.Da)).ma(),
this.Da.register(OB,"Common.App.FloatPane.FloatPaneActor").as("Common.App.FloatPane.IFloatPaneActor").na(()=>new OB(u.AFrameworkApplication.pe,u.AFrameworkApplication.Ta,this.Da.resolve("Common.App.FloatPane.IFloatPaneFactory"))).ma())}dispose(){}static main(){m.a.instance.Bc(new QB)}}Object(e.a)(QB,"FloatPanePackage",null,[2,3]);const cH=(a,b)=>{a=Math.atan2(b.y-a.y,b.x-a.x);0>a&&(a+=2*Math.PI);return a};class CP{constructor(a,b,c){this.gP=this.Tkb=this.lnb=null;this.zya=this.ysd=this.moa=0;this.eG=
this.Buc=this.ltc=this.ktc=!1;this.Kvd=this.E7e=this.G7e=0;this.PLa=a;this.Ca=b;this.ZY=c}mv(a){return Cb.App.Hb.Hd.isEditingAllowed?""!==this.CNc(a.Ac):!1}Du(a){if(!this.mv(a))return!1;this.zya=this.PLa.nFl();this.G6k(a);this.H6k();({sae:this.Buc,ade:this.eG}=this.goh(this.ysd));this.I6k();this.lnb=a.lE;this.gP=new Sys.UI.Point(0,0);({width:this.G7e,height:this.E7e}=this.PLa.getDimensions());Z.ULS.sendTraceTag(16802335,322,50,"Image resize drag started");return!0}mw(a){this.Tkb=a.lE;this.Nji();var b=
this.gP.x,c=this.gP.y;a=this.G7e;var f=this.E7e,l=this.Buc,x=this.eG,G=1;(b||c)&&a&&f&&(l&&x?(G=a+b,l=f+c,b=1/a,c=1/f,x=b>c?b:c,1>G?G=1:1920<G&&(G=1920),1>l?l=1:1280<l&&(l=1280),b=G-a,c=l-f,G=Math.abs(b/a)>Math.abs(c/f)?G/a:l/f,G<x&&(G=x)):l?(b=a+b,1>b?b=1:1920<b&&(b=1920),G=b/a):x&&(b=f+c,1>b?b=1:1280<b&&(b=1280),G=b/f));a=G;this.Kvd=a;this.PLa.ZGl(this.Kvd,this.Buc,this.eG);return!0}Sn(){this.gh();Z.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")}Yt(){this.PLa.pGl();Z.ULS.sendTraceTag(16802337,
322,50,"Image resize drag canceled")}H6k(){this.ysd=(Math.floor((this.zya+22)/45)%8+this.moa)%8}goh(a){let b,c;if(this.zya&&90!==this.zya&&180!==this.zya&&270!==this.zya&&360!==this.zya||this.gKj(a))return{sae:!0,ade:!0};c=b=!1;switch(a){case 1:case 5:c=!0;break;case 3:case 7:b=!0}return{sae:b,ade:c}}I6k(){this.ltc=this.ktc=!1;switch(this.ysd){case 0:this.ltc=this.ktc=!0;break;case 1:case 2:this.ltc=!0;break;case 7:case 6:this.ktc=!0}}gKj(a){return!(a%2)}CNc(a){var b=a.className;-1===b.indexOf("WACImageResizeHandle")&&
a.parentNode&&(b=a.parentNode.className);a=b.split(" ");for(b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==c)return c}return""}G6k(a){switch(this.CNc(a.Ac)){case "WACImageResizeHandleNW":this.moa=0;break;case "WACImageResizeHandleN":this.moa=1;break;case "WACImageResizeHandleNE":this.moa=2;break;case "WACImageResizeHandleE":this.moa=3;break;case "WACImageResizeHandleSE":this.moa=4;break;case "WACImageResizeHandleS":this.moa=5;break;case "WACImageResizeHandleSW":this.moa=
6;break;case "WACImageResizeHandleW":this.moa=7}}Nji(){var a=1;this.ZY.instance&&(a=this.ZY.instance.s2);const b=(this.Tkb.x-this.lnb.x)/a;a=(this.Tkb.y-this.lnb.y)/a;this.gP.x=this.ktc?-b:b;this.gP.y=this.ltc?-a:a}gh(){const a=new D.DictionaryPropertySet;a.setValue(Oc.a.Twj,100*this.Kvd);a.setValue(Oc.a.Uwj,!0);if(90===this.zya||270===this.zya){let b,c;({sae:b,ade:c}=this.goh(this.moa));a.setValue(Oc.a.Dng,b);a.setValue(Oc.a.Eng,c)}else a.setValue(Oc.a.Dng,this.Buc),a.setValue(Oc.a.Eng,this.eG);
this.Ca.La(E.a.Rwj,2,a)}}Object(e.a)(CP,"ImageResizeDragAdapter",null,[232]);class RB{constructor(a,b){this.Ca=a;this.ZY=b}}Object(e.a)(RB,"ImageResizeDragAdapterFactory",null,[366]);class dH{constructor(a,b,c,f,l,x){this.Pmb=this.fyc=this.Nvd=this.Tkb=this.lnb=this.gyc=null;this.Hwc=this.rAc=0;this.Dx=null;this.$n=!1;this.Ca=a;this.Qc=b;this.Gg=c;this.PLa=f;this.ZY=l;this.kff=this.Uga=0;this.Umb=x}mv(a){return Cb.App.Hb.Hd.isEditingAllowed&&a?(this.gyc=this.Qc.Kj)?!0:!1:!1}Du(a){if(!this.mv(a))return!1;
this.gyc=this.Qc.Kj;if(this.Dx=W.ImageReader.HCa(this.gyc))return this.lnb=this.Vra(a),this.Nvd=Sys.UI.DomElement.getBounds(this.Umb),this.rAc=0<W.ImageReader.Pbg(this.Dx)?W.ImageReader.Pbg(this.Dx):0,this.Hwc=W.ImageReader.b7i(this.Dx),Z.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0;Z.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties.");return!1}mw(a){this.Tkb=this.Vra(a);this.Pji();if(this.PLa)return this.PLa.hyl(this.Uga,
this.kff),Z.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0;Z.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null.");return!1}Sn(){var a=this.Uga;a%=360;0>a&&(a+=360);this.rAc=this.Uga=a;this.setRotation();Z.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")}Yt(){this.PLa.hyl(this.Hwc,0);Z.ULS.sendTraceTag(22052888,322,50,"Image rotate drag event canceled.")}Vra(a){return this.Gg.Hia(a)}Pji(){var a=1;this.ZY&&this.ZY.instance&&
(a=this.ZY.instance.s2);var b=new Sys.UI.Point(this.Nvd.x+this.Umb.clientWidth/2*a,this.Nvd.y+this.Umb.clientHeight/2*a);a=cH(this.lnb,b);b=cH(this.Tkb,b);this.Uga=Math.round(we.a.sO(b-a));0<this.rAc&&(this.Uga+=this.rAc-this.Hwc);this.kff=this.Uga;this.Uga+=this.Hwc}setRotation(){const a=new D.DictionaryPropertySet;a.setValue(Oc.a.Swj,0);a.setValue(Oc.a.I3b,this.Uga);this.Ca.La(E.a.imageRotate,2,a)}dispose(){Z.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed.");this.$n||(this.Pmb&&
(this.fyc&&this.Pmb.contains(this.fyc)&&(this.Pmb.removeChild(this.fyc),this.fyc=null),this.Umb&&this.Umb.contains(this.Pmb)&&(this.Umb.removeChild(this.Pmb),this.Pmb=null)),this.$n=!0)}}Object(e.a)(dH,"ImageRotateDragAdapter",null,[406,232,106]);class SB{constructor(a,b,c){this.Ca=a;this.Qc=b;this.ZY=c}create(a,b,c){return new dH(this.Ca,this.Qc,a,b,this.ZY,c)}}Object(e.a)(SB,"ImageRotateDragAdapterFactory",null,[367]);class TB{constructor(){this.Da=null}get name(){return"Box4.Images"}Wb(a){this.Da=
a;this.Da.register(RB,"Box4.Images.ImageResizeDragAdapterFactory").as("Box4.Images.IImageResizeDragAdapterFactory").ma().na(()=>new RB(u.AFrameworkApplication.Ta,fb.a.instance.Ka("Common.IZoomManager")));this.Da.register(SB,"Box4.Images.ImageRotateDragAdapterFactory").as("Box4.Images.IImageRotateDragAdapterFactory").ma().na(()=>new SB(u.AFrameworkApplication.Ta,qd.a.instance,fb.a.instance.Ka("Common.IZoomManager")))}init(){this.Da.resolve("Box4.Images.IImageRotateDragAdapterFactory")}dispose(){}static main(){m.a.instance.Bc(new TB)}}
Object(e.a)(TB,"Box4ImagesPackage",null,[2,3]);class eH{create(a){return new Dg.a(a)}}Object(e.a)(eH,"Factory",null,[376]);var Zy=d(431);class fH{constructor(){this.Gi=null}get key(){return"COMMENTTEXTANCHOR"}get d7(){return Box4Intl.Box4Strings.l_CommentContentTitle}reset(a){this.Gi=Object(ua.a)(se.AParagraphNode,a.node)}yoc(a){a=(a=this.J1i(a))?Object.assign(new Zy.a,{j0:this.key,yP:a}):null;return{returnValue:!!a,oAa:a}}J1i(a){if(!this.Gi.Ra)return null;const b=new Ha.a;for(let c=0;c<this.Gi.Ra.length;c++){const f=
this.Gi.Ra.ga(c);if(f.cp>a)break;if(f.xg)for(let l=0;l<f.xg.length;l++){const x=f.xg.ga(l);x.nk?b.add(x.YH.tq.toString()):b.remove(x.YH.tq.toString())}}return 0<b.count?b.ga(0):null}}Object(e.a)(fH,"CommentTextAnchorDetailsProvider",null,[514,513]);class fx{constructor(){this.Gi=null}get d7(){return null}getTitle(){return null}Z$f(){return null}reset(a){this.Gi=a.node}yoc(a){const b=Ie.d(this.Gi,a);a=null;if(!b||b.Lq!==this.Lq)return{returnValue:!1,oAa:a};a=Object.assign(new Zy.a,{j0:this.key,yP:b,
title:this.getTitle(b),description:this.Z$f(b)});return{returnValue:!0,oAa:a}}}Object(e.a)(fx,"BlobDetailsProvider",null,[514,513]);class gH extends fx{constructor(){super()}get key(){return"EQUATION"}get Lq(){return 11}get d7(){return Box4Intl.Box4Strings.l_EquationContentTitle}}Object(e.a)(gH,"EquationDetailsProvider",fx,[]);class hH{constructor(){this.p7e=null}get key(){return"LINK"}get d7(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle}reset(a){this.p7e=Lb.HyperlinkReader.S0b(a.node)}yoc(a){let b;
b=null;for(const c of this.p7e)if(c.Qa<=a&&a<c.Kb)return b=Object.assign(new Zy.a,{j0:this.key,yP:c.hyperlink}),{returnValue:!0,oAa:b};return{returnValue:!1,oAa:b}}}Object(e.a)(hH,"HyperlinkDetailsProvider",null,[514,513]);class iH extends fx{constructor(){super()}get key(){return"IMAGE"}get Lq(){return 5}get d7(){return Box4Intl.Box4Strings.l_ImageContentTitle}getTitle(a){return W.ImageReader.GNc(a.properties)}Z$f(a){return W.ImageReader.F0d(a.properties)}}Object(e.a)(iH,"ImageDetailsProvider",fx,
[]);class $y{constructor(){this.description=this.contentId=this.yP=this.j0=null}}Object(e.a)($y,"StructuralContentDetails",null,[542]);class jH{get key(){return"IMAGENODE"}get d7(){return Box4Intl.Box4Strings.l_ImageContentTitle}ITe(a){let b;b=null;if(!a||!W.ImageReader.LG(a.currentNode))return{returnValue:!1,Aqb:b};b=Object.assign(new $y,{j0:this.key,contentId:a.currentNode.id,yP:a.currentNode});return{returnValue:!0,Aqb:b}}TMc(a,b){a=a.yP;const c=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;
let f="";b&&a.id===b.yP.id||(f=String.format(c,W.ImageReader.GNc(a.properties),Box4Intl.Box4Strings.l_ImageContentTitle));return f}}Object(e.a)(jH,"ImageNodeDetailsProvider",null,[512,513]);let gx,hx;class Ir{constructor(a,b){this.S3e=null;this.wm=b;this.MBd=a;this.rPb=Ir.keys.ga(a);this.DLh=Ir.Pvi.ga(a)}get key(){return this.rPb}get d7(){return this.DLh}reset(a){this.S3e=this.wm.iF(a.node)}yoc(a){var b=Ir.LUi(this.S3e||[],c=>this.KGj(a,c));b=this.Kyi(b);return{returnValue:!!b,oAa:b}}KGj(a,b){return b.begin<=
a&&a<b.end&&(!b.Gh||this.MBd===b.Gh.proofingType)}Kyi(a){return a?Object.assign(new Zy.a,{j0:this.key,yP:a.Gh,description:this.p_d()}):null}p_d(){return u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null}static LUi(a,b){for(const c of a)if(b(c))return c;return null}}Ir.keys=(hx=new Vb.a,hx.add(1,"SPELLINGERROR"),hx.add(2,"GRAMMATICALERROR"),hx.add(3,"ADVANCEDERROR"),hx);Ir.Pvi=(gx=new Vb.a,
gx.add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),gx.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),gx.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),gx);Object(e.a)(Ir,"ProofingDetailsProvider",null,[514,513]);class kH{constructor(){this.tableNode=null;this.gFc=this.agd=this.columns=this.rows=0}}Object(e.a)(kH,"TableInfo",null,[]);var Nn=d(145),Qd=d(83),gk=d(126);class lH{get key(){return"TABLE"}get d7(){return Box4Intl.Box4Strings.l_TableContentTitle}ITe(a){var b=
null;if(!Se.isTableCell(a))return{returnValue:!1,Aqb:b};b=new nb.GraphIterator;b.Pc(a);a=new kH;a.agd=gk.c(b)+1;a.gFc=Nn.a(b)+1;Qd.returnToContainingTable(b);a.tableNode=b.currentNode;a.columns=Jd.TableReader.wi(a.tableNode);a.rows=Jd.TableReader.jk(a.tableNode);b=Object.assign(new $y,{j0:this.key,contentId:a.tableNode.id,yP:a});return{returnValue:!0,Aqb:b}}TMc(a,b){a=a.yP;const c=new Si.a;b||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,a.columns,a.rows));b&&b.yP.gFc===a.gFc||
c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,a.gFc));b&&b.yP.agd===a.agd||c.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,a.agd));return c.toArray().join(" ")}}Object(e.a)(lH,"TableDetailsProvider",null,[512,513]);class UB{constructor(a,b){this.jOh=a;this.wm=b}oFe(){this.jOh.execute(a=>{a.CXa(new hH);a.CXa(new Ir(1,this.wm));a.CXa(new Ir(2,this.wm));a.CXa(new Ir(3,this.wm));a.CXa(new gH);a.CXa(new iH);a.CXa(new fH);a.yFe(new lH);a.yFe(new jH)})}}
Object(e.a)(UB,"AccessibilityActor",null,[]);class VB{constructor(a,b,c){this.ISb=a;this.hd=b;this.WJh=c}ub(){this.ISb.pa(E.a.rsk,Bb.a.view,Object(C.a)(this,this.ssk,"openAutoCorrectOptionsView"),1028)}ssk(a,b,c){if(1===c)return 32;this.WJh().gmc();return 32}}Object(e.a)(VB,"AutoCorrectActor",null,[]);class WB{constructor(a){this.EQh=a}vMj(a){if(!a||!a.Wv||1>a.Wv.count)return!1;const b=[hc.a.zEi,hc.a.yEi];return!!this.BMc(a.Wv,1,c=>this.NFc(c,b))}Wug(a){return!a||!a.Wv||1>a.Wv.count?!1:!!this.BMc(a.Wv,
1,b=>this.NFc(b,[hc.a.aN]))}PJj(a){return!a||!a.Wv||1>a.Wv.count?!1:!!this.BMc(a.Wv,2,b=>this.NFc(b,[hc.a.Z6b]))}Rk(a){return!a||!a.Wv||1>a.Wv.count?!1:!!this.BMc(a.Wv,1,b=>this.NFc(b,[hc.a.xea]))}$Tc(a){if(!a||!a.Wv)return!1;a=a.Wv;for(let b=0;b<a.count;++b)if(!a.ga(b)||0<a.ga(b).Kci)return!1;return!0}dPi(a,b){return this.Wug(b)||this.PJj(b)?"":a}get VUc(){return this.EQh}BMc(a,b,c){if(a&&0<a.count)for(let f=a.count-1;0<=f;--f){if(c(a.ga(f)))return a.ga(f);if(a.count-f>=b)break}return null}NFc(a,
b){a=a&&a.Pmg?a.Pmg.split(" "):null;if(!a)return!1;for(const c of b)if(0<=Array.indexOf(a,c))return!0;return!1}}Object(e.a)(WB,"Box4PasteStewardUtils",null,[480]);class mH{constructor(){this.uY=0;this.wxb=Array(9)}}Object(e.a)(mH,"FullListMetadata",null,[]);class az{constructor(){this.level=0;this.CKa=null;this.uY=0;this.TRi=this.yfc=null;this.lEb=!1}}Object(e.a)(az,"ListItemMetadata",null,[]);class Wt{constructor(){this.zY=[]}y$f(){const a=new Wt;for(let b=0;b<this.zY.length;b++)a.add(this.ga(b));
return a}get count(){return this.zY.length}ga(a){return this.zY[a]}$(a,b){return this.zY[a]=b}add(a){Array.add(this.zY,a)}clear(){Array.clear(this.zY)}contains(a){return Array.contains(this.zY,a)}indexOf(a){return Array.indexOf(this.zY,a)}insert(a,b){Array.insert(this.zY,a,b)}remove(a){return Array.remove(this.zY,a)}removeAt(a){Array.removeAt(this.zY,a)}removeRange(a,b){for(let c=0;c<b;c++)Array.removeAt(this.zY,a)}reverse(){this.zY.reverse()}sort(){this.zY.sort()}toArray(){return Array.clone(this.zY)}}
Object(e.a)(Wt,"List",null,[]);class nH{constructor(){this.level=0;this.tagName="UL";this.oWa=null;this.ignore=!1;this.jec=0;this.listStyle="BulletListStyle1";this.u8=new Wt;this.font=this.levelText=""}}Object(e.a)(nH,"ListLevelMetadata",null,[]);class XB{constructor(){this.BCg={};this.oHc=-1}}Object(e.a)(XB,"LevelLists",null,[]);class YB{constructor(a){this.nodes=a;this.q2=0;this.lists={};this.u8=[];this.nxb=null;this.eia=[];this.eia[0]=new XB}}Object(e.a)(YB,"WordConverterArguments",null,[]);class oH{constructor(){this.y=
this.x=0;this.top=this.left=null}}Object(e.a)(oH,"AbsolutePosition",null,[]);class Wm{constructor(a,b,c,f,l){this.cultureName=this.N4=this.Wv=this.ZT=null;a&&(this.ZT=a);b&&(this.Wv=b);this.N4=c?c:new Ha.a;f&&""!==f&&(this.cultureName=f);this.hha=l}}Object(e.a)(Wm,"GlobalAttributesArgs",null,[]);class Xt{constructor(a,b,c="",f=0){this.Lv=!1;this.f7e=this.g7e=null;let l=!1;Xt.lJj(a)&&(l=!0,this.g7e=a);Xt.AJj(b)&&(this.f7e=b);this.aPh=c;this.RJh=f;this.Lv=l&&this.u3b?!0:!1}get isValid(){return this.Lv}get Rmg(){return this.g7e}get u3b(){return this.f7e}get Pmg(){return this.aPh}get Kci(){return this.RJh}static lJj(a){return a?
-1===a.indexOf(" ")&&0<a.length:!0}static AJj(a){return a?-1===a.indexOf(" ")&&0<a.length:!1}}Object(e.a)(Xt,"HtmlElementInfo",null,[]);class pH{constructor(a){this.next=null;this.data=a}}Object(e.a)(pH,"StackNode",null,[]);class ix{constructor(){this.Uu=null;this.Mk=0}get count(){return this.Mk}get isEmpty(){return!this.Mk||!this.Uu}push(a){a=new pH(a);a.next=this.Uu;this.Uu=a;this.Mk++}peek(){return this.isEmpty?null:this.Uu.data}pop(){if(this.isEmpty)return null;const a=this.Uu;this.Uu=a.next;
this.Mk--;return a.data}clear(){this.Uu=null;this.Mk=0}toArray(){const a=Array(this.count);let b=this.Uu;for(let c=this.count-1;0<=c&&b;c--)a[c]=b.data,b=b.next;return a}}Object(e.a)(ix,"Stack",null,[]);class bh{constructor(a){this.WNb=this.ywc=null;this.Hsc=!1;this.Fg=a}get aPa(){return this.WNb.peek()}reset(){this.Fg.reset();this.ywc=new ix;this.WNb=new ix;this.WNb.push(this.Fg.uYb);this.Hsc=!1}w8c(){this.Hsc=!1}GC(a){this.Hsc||(this.ywc.push(null),this.Hsc=!0);this.ywc.push(a)}onClose(){for(;;){const a=
this.ywc.pop();if(!a)break;a()}}Xmh(){return!1}lik(){this.uq(()=>!0)}uq(a){const b=this.aPa.clone();return a(b)?(this.WNb.push(b),this.Fg.ima(b),this.GC(Object(C.a)(this,this.qmk,"onFormattingEnd")),!0):!1}Z4d(a){return a.style?this.uq(b=>this.Xmh(b,a))?1:2:2}qmk(){this.WNb.pop();this.Fg.ima(this.aPa)}g0(){}p8c(){return 2}gwe(){return 2}hwe(){return 2}iwe(){return 2}pwe(){return 3}swe(){}u8c(){return 2}twe(){}uwe(){}vwe(){return 2}A8c(){return 2}B8c(){return 2}Hwe(){return 2}C8c(){}Mwe(){return 2}D8c(){return 2}F8c(){return 2}I8c(){return 2}K8c(){return 2}Ywe(){}Zwe(){return 2}N8c(){return 2}O8c(){return 2}Q8c(){return 2}R8c(){return 2}T8c(){return 2}U8c(){return 2}V8c(){return 2}Y8c(){return 2}txe(){return 2}f9c(){return 2}zxe(){return 2}Axe(){}Bxe(){return 2}k9c(){return 2}l9c(){return 2}m9c(){return 2}n9c(){return 2}o9c(){return 2}p9c(){return 2}Fxe(){return 3}q9c(){}Hxe(){return 2}s9c(){return 2}Jxe(){return 3}t9c(){}Lxe(){}u9c(){return 2}Sxe(){return 3}v9c(){return 2}x9c(){return 2}z9c(){return 2}A9c(){return 2}Vxe(){}Wxe(){return 3}E9c(){return 2}vDb(){return 2}Zxe(){}bye(){return 2}cye(){return 2}dye(){return 3}L9c(){return 2}eye(){return 2}P9c(){return 2}S9c(){return 2}gye(){}d$c(){return 2}qye(){return 2}l$c(){return 2}m$c(){return 2}Bye(){return 3}Cye(){return 2}w$c(){return 2}x$c(){return 2}y$c(){return 2}z$c(){return 2}Iye(){return 3}A$c(){return 2}B$c(){return 2}F$c(){return 2}Lye(){return 2}lfc(){return 2}Nye(){return 2}Oye(){return 2}G$c(){return 2}Pye(){return 2}Rye(){return 3}H$c(){return 2}K$c(){return 2}L$c(){return 2}M$c(){return 2}O$c(){return 2}static gsa(a){return a&&
-1!==a.indexOf("px")&&(a=parseInt(Ka.a.substring(a,0,a.indexOf("px"))),!isNaN(a))?a:0}static pfj(a){if(!a||""===a)return-1;const b=Ka.a.wg(a);if(-1!==b.indexOf("pt")){if(a=parseFloat(Ka.a.substring(a,0,b.indexOf("pt"))),!isNaN(a))return a}else if(-1!==b.indexOf("px")&&(a=parseFloat(Ka.a.substring(a,0,b.indexOf("px"))),!isNaN(a)))return 3*a/4;return-1}static peg(a){return a&&""!==a?bh.gsa(a):null}static fy(a){let b=null,c=null,f=null,l=null;a&&a.Uf&&(b=bh.Zra(a.Uf,"id"),c=bh.Zra(a.Uf,"lang"),f=a.Uf.tagName,
a.kai&&(l=Object.assign(new oH,{x:bh.gsa(a.Uf.style.left),y:bh.gsa(a.Uf.style.top),left:bh.peg(a.Uf.style.left),top:bh.peg(a.Uf.style.top)})),void 0===b&&(b=""),void 0===c&&(c=""));return new Wm(new Xt(b,f),a.Wv,null,c,l)}static Zra(a,b){return a[b]}}Object(e.a)(bh,"AHtmlTranslator",null,[475]);class qH extends Wm{constructor(a,b,c,f=0,l=0,x=null){super(x?x.ZT:null,x?x.Wv:null,x?x.N4:null,x?x.cultureName:null,x?x.hha:null);this.width=f;this.height=l}}Object(e.a)(qH,"AugmentationSemanticArgs",Wm,[]);
class rH{constructor(){this.stop=this.color=null}}Object(e.a)(rH,"ColorStopPair",null,[]);class bz{constructor(a,b){this.value=a;this.lXi=b}get aUc(){return this.lXi}}Object(e.a)(bz,"ElementValueWrapper",null,[]);class sH extends bz{constructor(a,b,c){super(a,b);this.Dyg=c}}Object(e.a)(sH,"DimensionWrapper",bz,[]);class ZB{constructor(a=0,b=0,c=0,f=0,l="",x="",G="",R="",fa="0pt",wa="0pt",Wa="0pt",mb="0pt"){this.borderTopStyle=a;this.borderRightStyle=b;this.borderBottomStyle=c;this.borderLeftStyle=
f;this.borderTopColor=l;this.borderRightColor=x;this.borderBottomColor=G;this.borderLeftColor=R;this.borderTopWidth=fa;this.borderRightWidth=wa;this.borderBottomWidth=Wa;this.borderLeftWidth=mb}}Object(e.a)(ZB,"TableCellBorderProperties",null,[]);class $B{constructor(a="",b="",c="",f=""){this.Zli=a;this.Yli=b;this.Wli=c;this.Xli=f}}Object(e.a)($B,"TableCellMarginProperties",null,[]);class Og{static get Qmg(){return Og.cPh}static get fld(){return Og.wYh}static get Xkd(){return Og.uYh}static p4d(a,
b,...c){b=Og.Phg(b);let f=!1;b||(b=Og.yjj.apply(null,[a].concat(c)),f=!!b);return new bz(b,f)}static Phg(a){for(const b of a)if(void 0!==b&&null!==b&&""!==b)return b.trim();return null}static yjj(a,...b){for(const c of b)if(b=a.getAttribute(c),void 0!==b&&null!==b&&(b+="",void 0!==b&&null!==b&&""!==b))return b.trim();return null}static dbj(a,b){b=parseFloat(b);if(isNaN(b))return 0;switch(a){case "px":return Math.round(b);case "pt":return Math.round(Re.a.Eea(b,0,!1));case "in":return Math.round(Re.a.QZ(b,
0,!1));case "cm":return Math.round(Re.a.QZ(we.a.vOf(b),0,!1));case "mm":return Math.round(Re.a.QZ(we.a.vOf(.1*b),0,!1));default:return b}}static Efd(a,b,...c){a=Og.p4d.apply(null,[a,b].concat(c));c=0;b=!1;if(a.value){b=a.value.endsWith("%");let f;b?(c="%",f=Ka.a.substring(a.value,0,a.value.length-1)):a.aUc?(c="px",f=a.value):(c=a.value.substr(a.value.length-2),isNaN(parseFloat(c))?f=Ka.a.substring(a.value,0,a.value.length-2):(c="px",f=a.value));c=Og.dbj(c,f)}return new sH(c,a.aUc,b)}static lub(a){return Og.Efd(a,
[a.style.width],"width","WIDTH","Width")}static b7a(a){return Og.Efd(a,[a.style.height],"height","HEIGHT","Height")}static r1d(a){return Og.Efd(a,[a.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")}static s1d(a){return Og.Efd(a,[a.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")}static Ejj(a){a=Og.p4d(a,[a.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return a.value&&a.value in Og.fld&&void 0!==Og.fld[a.value]&&null!==Og.fld[a.value]?Og.fld[a.value]:0}static GQj(a){a=
Og.Phg([a.style.borderCollapse]);return!!a&&!(void 0===a||null===a)&&("collapse"===a||"COLLAPSE"===a||"Collapse"===a)}static F_i(a){return Og.p4d(a,[a.style.backgroundColor,a.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value}static zwi(a){const b=Ka.a.substring(a,0,1),c=Ka.a.substring(a,1,2);a=Ka.a.substring(a,2,3);return b+b+c+c+a+a}static Wha(a){let b="";if(!a||""===a)return b;b=a.trim();if(b.startsWith("rgb")){b=Ka.a.substring(b,b.indexOf("(")+1,b.length-1);a=b.split(",");if(3!==
a.length)return"";b="";for(let f=0;f<a.length;f++){var c=parseInt(a[f]);if(isNaN(c)||0>c||255<c)return"";c=c.toString(16);1===c.length&&(c="0"+c);b+=c}return Ka.a.rB(b)}if(Og.Qmg[Ka.a.wg(b)])return Og.Qmg[Ka.a.wg(b)];b.startsWith("#")&&(b=Ka.a.substring(b,1,b.length));if(isNaN(parseInt(b,16)))return"";3===b.length&&(b=Og.zwi(b));return 6!==b.length?"":b}static Fvk(a){var b=a.indexOf("mso-tab-count");if(-1===b)return 0;const c=RegExp("([\\d])");let f="";for(b=b+13+1;b<a.length;b++){const l=a.charAt(b).toString();
if(c.test(l))f+=l;else break}a=0;""!==f&&(a=parseInt(f));return a}static jQc(a,b){const c=Og.F_i(a);c&&""!==c&&b.uq(f=>f.nhd(Og.Wha(c)))}static B9f(a){a=a.style;if(!a)return null;const b=Og.Xkd[a.borderTopStyle],c=Og.Wha(a.borderTopColor),f=a.borderTopWidth,l=Og.Xkd[a.borderRightStyle],x=Og.Wha(a.borderRightColor),G=a.borderRightWidth,R=Og.Xkd[a.borderBottomStyle],fa=Og.Wha(a.borderBottomColor),wa=a.borderBottomWidth,Wa=Og.Xkd[a.borderLeftStyle],mb=Og.Wha(a.borderLeftColor);return new ZB(b,l,R,Wa,
c,x,fa,mb,f,G,wa,a.borderLeftWidth)}static A0i(a){const b=a.firstChild;return(a=b&&b.className&&-1!==b.className.indexOf("TableCellContent")?a.firstChild.style:a.style)?new $B(a.paddingTop,a.paddingRight,a.paddingBottom,a.paddingLeft):null}}Og.cPh=ta.a.tH("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood",
"DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B",
"darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo",
"4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00",
"limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500",
"orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD",
"slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32");Og.wYh=ta.a.tH("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3);Og.uYh=ta.a.tH("",0,"initial",3,"inherit",
11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2);Object(e.a)(Og,"DefaultHtmlTranslatorHelper",null,[]);class tH{constructor(){this.direction=null;this.FWb=new Wt}mlg(){return!!this.direction&&0<this.direction.length}}Object(e.a)(tH,"LinearGradient",null,[]);class aC{constructor(){this.rTc=!1}}Object(e.a)(aC,"HtmlTranslatorContext",null,[]);class bC{constructor(a=!1,b=!1,c=!1,f=!1,l=!1,x=!1,G=!0,R=!1,fa=!0,wa=!0,Wa=!0,mb=!1,Kb=!1,
nc=!1,oc=!1,Ic=!1,Kc=!1,Hc=!1,ie=null,He=null,fe=null,Te=null,We=null,Qf=null,mg=null){this.rTc=!1;this.kUh=a;this.pUh=b;this.hUh=c;this.oUh=f;this.$Wh=l;this.YWh=x;this.TWh=G;this.UWh=R;this.WWh=fa;this.XWh=wa;this.VWh=Wa;this.iXh=mb;this.xXh=Kb;this.hXh=nc;this.lYh=oc;this.cXh=Ic;this.zPh=Kc;this.tuc=Hc;this.bXh=ie;this.gXh=He;this.ZWh=We;this.eXh=fe;this.aXh=Te;this.dXh=Qf;this.fXh=mg}get aXa(){return this.kUh}get vwk(){return this.pUh}get H5g(){return this.hUh}get uwk(){return this.oUh}get Gqh(){return this.$Wh}get Fqh(){return this.YWh}get jal(){return this.TWh}get kal(){return this.UWh}get mal(){return this.WWh}get oal(){return this.XWh}get lal(){return this.VWh}get TYa(){return this.cXh}get mBj(){return this.zPh}get Kqh(){return this.iXh}get Xbl(){return this.xXh}get xal(){return this.hXh}get zkl(){return this.lYh}get V8a(){return this.tuc}get Hqh(){return this.bXh||
Object(C.a)(this,this.Ifd,"returnFalse")}get wal(){return this.gXh||Object(C.a)(this,this.Ifd,"returnFalse")}get ual(){return this.eXh||Object(C.a)(this,this.VHe,"returnTrue")}get qal(){return this.aXh||Object(C.a)(this,this.VHe,"returnTrue")}get pal(){return this.ZWh||Object(C.a)(this,this.Ifd,"returnFalse")}get tal(){return this.dXh||Object(C.a)(this,this.VHe,"returnTrue")}get Jqh(){return this.fXh||Object(C.a)(this,this.Ifd,"returnFalse")}VHe(){return!0}Ifd(){return!1}}Object(e.a)(bC,"HtmlTranslatorSettings",
null,[510]);class uH extends Wm{constructor(a,b,c,f,l=null,x=0,G=0,R=null,fa=null){super(l?l.ZT:null,l?l.Wv:null,l?l.N4:null,l?l.cultureName:null,l?l.hha:null);this.src=a;this.alt=b;this.width=c;this.height=f;this.maxWidth=x;this.maxHeight=G;this.href=R;this.desc=fa}}Object(e.a)(uH,"ImageSemanticArgs",Wm,[]);class vH{constructor(a,b){this.Chl=a;this.Bhl=b}}Object(e.a)(vH,"IndentationProperties",null,[]);class jx extends Wm{constructor(a,b,c,f=0,l=-1,x=!1,G=!1,R="",fa="",wa=null,Wa=-1){super(c?c.ZT:
null,c?c.Wv:null,c?c.N4:null,c?c.cultureName:null,c?c.hha:null);this.uif=a;this.KPb=0;this.wEd=b;this.MOb=1===b&&-1===l&&!this.u0a;this.Eyd=f;this.Fyd=l;this.$Ad=x;this.u0a=G;this.n1a=R;this.alb=fa;this.hrc=wa;this.Rqc=Wa;this.zkb=-1;this.eAc=!0}get listStyleType(){return this.MKj?this.KPb:this.uif}get MKj(){return 0!==this.KPb}get Vil(){return this.wEd}get listLevel(){return this.Fyd}set listLevel(a){this.Fyd=a}get listId(){return this.Eyd}set listId(a){this.Eyd=a}get lEb(){return this.$Ad}set lEb(a){this.$Ad=
a}get Y5a(){return this.u0a}set Y5a(a){this.u0a=a}get levelText(){return this.n1a}set levelText(a){this.n1a=a}get font(){return this.alb}set font(a){this.alb=a}get wOa(){return this.hrc}set wOa(a){this.hrc=a}get opb(){return this.Rqc}set opb(a){this.Rqc=a}get Mwg(){return 6<=this.listStyleType}get OEj(){return this.MOb}get NEi(){return this.eAc?this.wEd+this.zkb:this.zkb}clone(){const a=new jx(this.uif,this.wEd,new Wm(this.ZT,this.Wv,this.N4,this.cultureName,this.hha),this.Eyd,this.Fyd,this.$Ad,this.u0a);
a.KPb=this.KPb;a.MOb=this.MOb;a.zkb=this.zkb;a.eAc=this.eAc;a.n1a=this.n1a;a.alb=this.alb;a.hrc=this.hrc;a.Rqc=this.Rqc;return a}Iai(a,b,c){this.KPb=a;0<b?(this.MOb=!1,this.zkb=b,this.eAc=!1):(this.zkb++,this.MOb=!c)}}Object(e.a)(jx,"ListSemanticArgs",Wm,[]);class cz extends Wm{constructor(a,b,c,f,l=null,x=0,G=null,R=null,fa=!1,wa=!1,Wa=69905,mb=null){super(mb?mb.ZT:null,mb?mb.Wv:null,mb?mb.N4:null,mb?mb.cultureName:null,mb?mb.hha:null);this.colSpan=a;this.rowSpan=b;this.width=c;this.Owb=wa;this.height=
f;this.jEa=fa;this.zlc=l;this.verticalAlignment=x;this.x5=G;this.ald=R;this.gEc=Wa}}Object(e.a)(cz,"TableCellSemanticArgs",Wm,[]);class cC extends Wm{constructor(a,b=null){super(b?b.ZT:null,b?b.Wv:null,b?b.N4:null,b?b.cultureName:null,b?b.hha:null);this.height=a}}Object(e.a)(cC,"TableRowSemanticArgs",Wm,[]);class dC extends Wm{constructor(a,b,c,f,l,x,G,R,fa,wa=null,Wa=-1,mb=null){super(mb?mb.ZT:null,mb?mb.Wv:null,mb?mb.N4:null,mb?mb.cultureName:null,mb?mb.hha:null);this.DOa=null;this.WX=a;this.Dqa=
b;this.width=c;if(l)for(this.DOa=Array(l.length),a=0;a<l.length;++a)this.DOa[a]=l[a];this.Otg=x;this.cRe=R;this.gFj=G;this.jEa=f;this.Q7d=fa;this.Svh=wa;this.tableLook=Wa}}Object(e.a)(dC,"TableSemanticArgs",Wm,[]);let Jr;class Ak extends bh{constructor(a,b=null,c=null,f=null){super(a);this.s1a=null;this.SRh=ta.a.tH("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",
9,"upper-alpha",10,"upper-latin",10,"upper-roman",11);this.Ic=b||new bC;this.Qu=c||new aC;this.Hyd=f}get xCg(){return this.SRh}Icg(a,b){var c;if((c=a.style?a.style.listStyleType:"")&&""!==c&&(c=this.xCg[Ka.a.wg(c)])||(c=bh.Zra(a,"type"))&&""!==c&&(c=this.xCg[c]))return c;if(this.Ic.aXa&&(c=a.tagName.toLowerCase())&&("ol"===c||"ul"===c)&&(a=a.className)&&""!==a)if("ul"===c)switch(a=Ak.zPc(a,"BulletListStyle"),a){case "BulletListStyle1":return 3;case "BulletListStyle2":return 4;case "BulletListStyle3":return 5}else if("ol"===
c)switch(a=Ak.zPc(a,"NumberListStyle"),a){case "NumberListStyle1":return 7;case "NumberListStyle2":return 8;case "NumberListStyle3":return 9;case "NumberListStyle4":return 10;case "NumberListStyle5":return 11}return b}Bcg(a){let b=-1,c=a.tagName.toLowerCase();if("ol"===c||"ul"===c){a=ya.a.Rag(a,"li");if(!a)return b;c="li"}if("li"===c){b=(b=this.iMc(a,"data-aria-level",0))?b:-1;if(0<b)return b-1;if(a=ya.a.Rag(a,"p"))return Ak.E8i(a)-1}return b}iMc(a,b,c){a=this.Ic.aXa?a.getAttribute(b):bh.Zra(a,b);
a=parseInt(a);return isNaN(a)||0>a?c:a}Knk(){this.s1a.pop();this.Fg.lma()}C2b(a,b){this.uq(l=>l.cJa(0,0));const c=this.Icg(a.Uf,b?6:2);let f=1;b&&(f=this.iMc(a.Uf,"start",1));b=!1;this.Ic.aXa&&(b=a.Uf.getAttribute("data-pasteFromRc"),(b=!!b&&"true"===b)&&a.Uf.removeAttribute("data-pasteFromRc"),(r.a.US||r.a.eg)&&Ak.NEc(a.Uf));a=new jx(c,f,bh.fy(a),0,-1,b,this.Ic.aXa);this.s1a.push(a);this.Fg.nma(a);this.GC(Object(C.a)(this,this.Knk,"onListElementClose"));return 1}reset(){super.reset();this.s1a=new ix}Xmh(a,
b){let c=!1;try{var f=b.getAttribute("xml:lang")||bh.Zra(b,"lang")}catch(R){f=null}f&&""!==f&&(c=a.UKe(f)||c);(f=bh.Zra(b,"dir"))&&(c=a.MHb(f)||c);if(f=b.style){if(f.fontWeight){var l=Ka.a.rB(f.fontWeight),x=parseInt(l);isNaN(x)?"BOLD"===l?c=a.xJ(!0)||c:"NORMAL"===l&&(c=a.xJ(!1)||c):c=600<=x?a.xJ(!0)||c:a.xJ(!1)||c}this.Ic.Fqh&&f.fontSize&&(l=bh.pfj(f.fontSize),0<l&&(c=a.aHb(Math.floor(2*l))||c));this.Ic.ual(this.Qu)&&(this.Ic.Kqh&&b.getAttribute?(l=b.getAttribute("data-indent"))&&0<l.length&&(l=
Re.a.EJ(parseInt(l),0)+"px",c=a.jid(l)||c):f.textIndent&&(c=a.jid(f.textIndent)||c));this.Ic.qal(this.Qu)&&f.marginLeft&&(this.Ic.Kqh&&b.getAttribute?(l=b.getAttribute("data-margin"))&&0<l.length&&(c=a.alc(f.marginLeft)||c):"TABLE"!==b.tagName&&(c=a.alc(f.marginLeft)||c));this.Ic.pal(this.Qu)&&f.lineHeight&&(c=a.C0(f.lineHeight)||c);if(this.Ic.lal)if(l=f.fontVariantCaps?Ka.a.wg(f.fontVariantCaps):null,x=f.fontVariant?Ka.a.wg(f.fontVariant):null,"uppercase"===(f.textTransform?Ka.a.wg(f.textTransform):
null))c=a.iid("uppercase")||c;else if("small-caps"===l||x&&0<=x.indexOf("small-caps"))c=a.iid("small-caps")||c;this.Ic.tal(this.Qu)&&f.textAlign&&(c=a.Zgb(Ka.a.wg(f.textAlign))||c);f.fontStyle&&(l=Ka.a.rB(f.fontStyle),"ITALIC"===l||"OBLIQUE"===l?c=a.yYa(!0)||c:"NORMAL"===l&&(c=a.yYa(!1)||c));l=Ak.Ghj(b);if(f.textDecoration||l){x=Ka.a.wg(f.textDecoration||"");l=Ka.a.wg(l||"");if(b.parentNode&&b.parentNode.tagName&&"a"===Ka.a.wg(b.parentNode.tagName)){var G=(b.querySelector(".TextRun")||b).className;
G&&-1<G.indexOf("Underlined")&&(c=a.E0(!0)||c)}else if(f.TGl||Ak.GD(x)||Ak.GD(l))c=a.E0(!0)||c;if(f.SGl||Ak.Lwg(x)||Ak.Lwg(l))c=a.cY(!0)||c}if(f.verticalAlign){l=Ka.a.rB(f.verticalAlign);if("SUB"===l||this.Ic.Jqh(this.Qu)&&b.className&&-1<b.className.indexOf("Subscript"))c=a.k5(!0)||c;else if("SUPER"===l||this.Ic.Jqh(this.Qu)&&b.className&&-1<b.className.indexOf("Superscript"))c=a.eY(!0)||c;this.Ic.Fqh&&("SUB"===l||"SUPER"===l)&&b.getAttribute&&(l=parseFloat(b.getAttribute("data-fontsize")),isNaN(l)||
(c=a.KKe(Math.floor(2*l))||c))}this.Ic.oal&&f.fontFamily&&(this.Ic.V8a?c=this.JKe(a,f.fontFamily,c):this.Ic.xal&&b.getAttribute?(l=b.getAttribute("data-usefontface"))&&"true"===l&&(c=this.JKe(a,f.fontFamily,c)):c=this.JKe(a,f.fontFamily,c));l=null;this.Ic.mal&&f.color&&(l=Og.Wha(f.color));x=!!l;this.Ic.wal(this.Qu)&&b.getAttribute&&(x=b.getAttribute("data-scheme-color"),l=null!==x?x:l,x=""!==l||!this.Qu.rTc||Ak.cRj(b));x&&(c=a.gt(l)||c);this.Ic.jal&&f.backgroundColor&&(this.Ic.vwk&&b.tagName&&Ak.vml.contains(Ka.a.rB(b.tagName))||
(c=a.lna(Og.Wha(f.backgroundColor))||c));if(this.Ic.kal&&f.backgroundImage&&b.className&&-1<b.className.indexOf("Highlight")&&(f=Ak.zjj(f.backgroundImage))&&0<f.FWb.count){l=f.FWb.ga(0).color;x=!0;for(G=0;G<f.FWb.count&&(x=x&&l===f.FWb.ga(G).color,x);G++);x&&(Z.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),c=a.lna(Og.Wha(l))||c)}}this.Ic.Hqh(this.Qu)&&b.getAttribute&&(f=b.getAttribute("data-ccp-props"))&&(c=a.ona(f)||c);if(b.getAttribute){if(f=b.getAttribute("data-ccp-charstyle"))u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),
this.Ic.TYa&&(c=a.dfa(f)||c);if(b=b.getAttribute("data-ccp-parastyle"))u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordCopyPasteParagraphCharacterStyleIdSettings"),this.Ic.TYa&&(c=a.Nhd(b)||c)}return c}Wbl(a){if(this.Ic.Xbl)for(a=a.parentNode;a&&a.tagName;){if(a.className&&Object.getType(a.className)===String&&-1<Ka.a.rB(a.className).indexOf("MSOCOM"))return!0;if("DIV"===Ka.a.rB(a.tagName))break;a=a.parentNode}return!1}JKe(a,b,c){b=Ak.dbg(b);return a.XIa(b,this.Ic.zkl)||c}g0(a,
b){"\u200b"===a&&(a="\u00a0");b&&b.Uf&&this.Wbl(b.Uf)&&(a="");this.Fg.g0(a,bh.fy(b))}p8c(a){const b=bh.Zra(a.Uf,"href");return b&&""!==b?(this.Fg.Jva(b,bh.fy(a)),this.GC(Object(C.a)(this.Fg,this.Fg.Iva,"onAnchorEnd")),1):2}u8c(){return this.uq(a=>a.xJ(!0))?1:2}A8c(){return this.uq(a=>a.W4d())?1:2}B8c(a){this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}C8c(a){this.Fg.kma(bh.fy(a))}D8c(a){this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));
return 1}I8c(){return this.uq(a=>a.yYa(!0))?1:2}F8c(a){this.uq(b=>b.Zgb("center"));this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}K8c(){return this.uq(a=>a.XIa("consolas"))?1:2}O8c(){return this.uq(a=>a.cY(!0))?1:2}N8c(a){return this.C2b(a,!1)}Q8c(){return this.uq(a=>a.yYa(!0))?1:2}R8c(a){return this.C2b(a,!1)}T8c(a){var b=a.Uf.getAttribute("data-render-src");const c=a.Uf.getAttribute("data-render-method");if(b&&""!==b&&c&&""!==c){const G=a.Uf.getAttribute("data-render-fallback");
let R=0,fa=0;if(a.Uf.currentStyle){var f=a.Uf.currentStyle.width,l=a.Uf.currentStyle.height;f&&-1!==f.indexOf("px")&&(f=parseInt(Ka.a.substring(f,0,f.indexOf("px"))),isNaN(f)||(R=f));l&&-1!==l.indexOf("px")&&(l=parseInt(Ka.a.substring(l,0,l.indexOf("px"))),isNaN(l)||(fa=l))}a=new qH(b,c,G,R,fa,bh.fy(a));this.Fg.NWa(a);return 2}this.Ic.aXa&&(r.a.US||r.a.eg)&&(b=a.Uf.className.match(RegExp("^SCX[0-9a-zA-Z]+$")),this.Ic.aXa&&b&&b.length&&Ak.NEc(a.Uf));const x=a.Uf.getAttribute("align");this.uq(G=>G.Zgb(x));
this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}U8c(a){this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}V8c(a){this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}Y8c(){return this.uq(a=>a.yYa(!0))?1:2}f9c(a){return this.uq(b=>{var c=Ak.dbg(a.Uf.getAttribute("face"));c=b.XIa(c);b=b.gt(Og.Wha(a.Uf.getAttribute("color")));return c||b})?1:2}k9c(a){this.uq(b=>this.Ic.TYa?b.DYa(1):b.EYa(1));
this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}l9c(a){this.uq(b=>this.Ic.TYa?b.DYa(2):b.EYa(2));this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}m9c(a){this.uq(b=>this.Ic.TYa?b.DYa(3):b.EYa(3));this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}n9c(a){this.uq(b=>this.Ic.TYa?b.DYa(4):b.EYa(4));this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}o9c(a){this.uq(b=>
this.Ic.TYa?b.DYa(5):b.EYa(5));this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}p9c(a){this.uq(b=>this.Ic.TYa?b.DYa(6):b.EYa(6));this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}q9c(a){this.Fg.kma(bh.fy(a))}t9c(a){var b=a.Uf;const c=b.src,f=b.alt,l=b.NFl;let x=0,G=0;b.style&&(x=bh.gsa(b.style.width),G=bh.gsa(b.style.height));x&&G||(x=b.width,G=b.height);let R=b=0;a.Uf.currentStyle&&(x||G||(x=bh.gsa(a.Uf.currentStyle.width),
G=bh.gsa(a.Uf.currentStyle.height)),b=bh.gsa(a.Uf.currentStyle.maxWidth),R=bh.gsa(a.Uf.currentStyle.maxHeight));a=new uH(c,f,x,G,bh.fy(a),b,R,l);this.Fg.jma(a)}s9c(){return this.uq(a=>a.yYa(!0))?1:2}u9c(){return this.uq(a=>a.E0(!0))?1:2}v9c(){return this.uq(a=>a.XIa("consolas"))?1:2}x9c(a){this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}z9c(a){this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}A9c(a){let b;const c=this.Icg(a.Uf,
0);let f=this.iMc(a.Uf,"value",0);var l=!1;0<this.s1a.count?b=this.s1a.peek():(b=new jx(2,1,bh.fy(a)),f||(f=1));if(this.Ic.aXa){l=b.listLevel;let fa=b.listId;this.Ic.Gqh?(l=this.Bcg(a.Uf),l=0>l&&0>b.listLevel&&0<this.s1a.count?b.listLevel=this.s1a.count-1:b.listLevel=0<=l?l:b.listLevel,this.Hyd&&this.Hyd.b<l&&(this.Hyd.b=l)):0>l&&(l=b.listLevel=this.Bcg(a.Uf));1>fa&&(fa=b.listId=this.iMc(a.Uf,"data-listid",0));a.Uf.getAttribute("data-leveltext")&&(b.levelText=a.Uf.getAttribute("data-leveltext"));
var x=a.Uf.getAttribute("data-font");x&&(b.font=x);x=!1;u.AFrameworkApplication.fa&&(x=u.AFrameworkApplication.fa.ka("FollowDestinationThemePasteIsEnabled"));if(x){var G=a.Uf.getAttribute("data-charcodes");x=[];if(G&&""!==G)if(-1<G.indexOf(",")){G=G.split(",");for(var R=0;R<G.length;R++)Array.add(x,parseInt(G[R]))}else Array.add(x,parseInt(G));if(x&&0<x.length){G=Array(x.length);for(R=0;R<x.length;R++)G[R]=x[R];b.wOa=G}(x=a.Uf.getAttribute("data-buAutoNum"))&&0<x.length&&(b.opb=parseInt(x))}(l=0<=
l&&0<fa)&&Ak.NEc(a.Uf)}b.Iai(c,f,l);this.Fg.Nva(b.clone());this.GC(Object(C.a)(this.Fg,this.Fg.mma,"onListItemEnd"));return 1}vDb(a){return this.C2b(a,!1)}E9c(a){if(this.uq(b=>b.tHb(!0))){const b=a.Uf.getAttribute("OuterHtml");this.Fg.Ova(b,bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.DHa,"onMathEnd"))}return 1}L9c(a){return this.C2b(a,!0)}P9c(a){this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}S9c(a){const b=a.Uf.getAttribute("align");this.uq(c=>c.Zgb(b));
if(this.Ic.aXa){const c=a.Uf.parentNode;c&&c.tagName.toLowerCase().startsWith("li")&&Ak.NEc(a.Uf,r.a.US||r.a.eg)}this.Fg.fA(bh.fy(a));this.GC(Object(C.a)(this.Fg,this.Fg.eA,"onParagraphEnd"));return 1}d$c(){this.uq(a=>a.XIa("consolas"));this.Fg.MWa();this.GC(Object(C.a)(this.Fg,this.Fg.LWa,"onPreFormattedTextEnd"));return 1}l$c(){return this.uq(a=>a.cY(!0))?1:2}m$c(){return this.uq(a=>a.XIa("consolas"))?1:2}w$c(){return this.uq(a=>a.POe())?1:2}x$c(a){var b=a.Uf.attributes.getNamedItem("style"),c=
"";b&&b.value&&(c=b.value);b=Og.Fvk(c);if(0<b&&this.Ic.mBj){for(c=0;c<b;c++)this.Fg.SWa(bh.fy(a));return 3}return 2}y$c(){return this.uq(a=>a.cY(!0))?1:2}z$c(){return this.uq(a=>a.xJ(!0))?1:2}A$c(){return this.uq(a=>a.k5(!0))?1:2}B$c(){return this.uq(a=>a.eY(!0))?1:2}F$c(a){this.uq(Wa=>Wa.clearFormatting()&&Wa.tHe());Og.jQc(a.Uf,this);const b=Og.lub(a.Uf),c=Og.B9f(a.Uf),f=Og.r1d(a.Uf),l=Og.s1d(a.Uf),x=!parseInt(bh.Zra(a.Uf,"border")),G=Og.GQj(a.Uf);let R=-1,fa="";var wa=-1;a.Uf.attributes.hasOwnProperty("style")&&
-1!==(wa=a.Uf.attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?R=parseInt(a.Uf.attributes.getNamedItem("style").value.substr(wa+17)):a.Uf.attributes.hasOwnProperty(Da.a.FSd.toString())&&(R=parseInt(a.Uf.attributes.getNamedItem(Da.a.FSd.toString()).value));wa=-1;a.Uf.attributes.hasOwnProperty("class")&&-1!==(wa=a.Uf.attributes.getNamedItem("class").value.indexOf("Mso"))?fa=a.Uf.attributes.getNamedItem("class").value.substr(wa).split(" ")[0]:a.Uf.attributes.hasOwnProperty(Da.a.GSd.toString())&&
(fa=a.Uf.attributes.getNamedItem(Da.a.GSd.toString()).value);this.Fg.FX(new dC(0,0,b.value,b.Dyg,null,x,G,c,new vH(f.value,l.value),fa,R,bh.fy(a)));this.GC(Object(C.a)(this.Fg,this.Fg.CX,"onTableEnd"));u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings");return 1}lfc(a){const b=Og.b7a(a.Uf),c=Og.lub(a.Uf);if(!c.value&&c.aUc&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Ic.H5g))return 3;
let f=parseInt(bh.Zra(a.Uf,"colSpan"));if(void 0===f||null===f||""===f+"")f=c.value?1:0;let l=parseInt(bh.Zra(a.Uf,"rowSpan"));if(void 0===l||null===l||""===l+"")l=b.value?1:0;let x=!1;a.Uf.attributes.hasOwnProperty("style")&&(x=-1!==a.Uf.attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==a.Uf.attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder"));!x&&a.Uf.attributes.hasOwnProperty("class")&&(x=-1!==a.Uf.attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));
let G=69905;if(a.Uf.attributes.hasOwnProperty(Da.a.ESd.toString())){var R=parseInt(a.Uf.attributes.getNamedItem(Da.a.ESd.toString()).value);isNaN(R)||(G=R)}R=Og.Wha(a.Uf.style.backgroundColor);const fa=Og.Ejj(a.Uf);this.uq(mb=>mb.cJa(0,0));Og.jQc(a.Uf,this);const wa=Og.B9f(a.Uf),Wa=this.Ic.uwk?Og.A0i(a.Uf):null;a=new cz(f,l,c.value,b.value,R,fa,wa,Wa,c.Dyg,x,G,bh.fy(a));this.Fg.BX(a);this.GC(Object(C.a)(this.Fg,this.Fg.AX,"onTableCellEnd"));this.lik();return 1}G$c(a){const b=this.lfc(a);if(3===b)return b;
this.uq(c=>{const f=c.xJ(!0);c=c.Zgb("center");return f||c});Og.jQc(a.Uf,this);return 1}H$c(a){Og.jQc(a.Uf,this);const b=Og.b7a(a.Uf);if(b.aUc&&!b.value&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this.Ic.H5g))return 3;this.Fg.EX(new cC(b.value,bh.fy(a)));this.GC(Object(C.a)(this.Fg,this.Fg.DX,"onTableRowEnd"));return 1}K$c(){return this.uq(a=>a.XIa("consolas"))?1:2}L$c(){return this.uq(a=>a.E0(!0))?1:2}M$c(a){return this.C2b(a,!1)}O$c(){return this.uq(a=>
a.E0(!0))?1:2}static K4i(a){return a?a.split(",")[0]:null}static drl(a){if(!a)return null;a=Ka.a.ZFe(a,'"');return a=Ka.a.ZFe(a,"'")}static dbg(a){if(!a)return null;a=Ak.K4i(a);return a=Ak.drl(a)}static oEf(a,b){b=b.trim();var c=b.match(RegExp("^-?[0-9]+deg$"));if(c&&0<c.length){if(a.mlg())return!1;a.direction=b;return!0}if((c=b.match(RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$")))&&0<c.length){if(a.mlg())return!1;a.direction=b;return!0}var f=(c=b.match(RegExp("^rgb\\(.*\\)")))&&
0<c.length?b.indexOf(")")+1:b.indexOf(" ");c=-1===f?b:Og.Wha(b.substr(0,f).trim());if(!c||""===c)return!1;b=-1===f?"":b.substr(f).trim();f=new rH;f.color=c;f.stop=b;a.FWb.add(f);return!0}static zjj(a){try{if(!a)return null;a=a.trim();if(!a.startsWith("linear-gradient(")||!a.endsWith(")"))return null;let b=a.substr(16);b=b.substr(0,b.lastIndexOf(")"));const c=new tH;for(;0<b.trim().length;){let f=b.indexOf(",");const l=b.indexOf("(");if(0<l&&l<f){const x=b.indexOf(")");if(x<l)return null;f=b.indexOf(",",
x)}if(-1===f){if(!Ak.oEf(c,b))return null;b=""}else{const x=b.substr(0,f);b=b.substr(f+1);if(!Ak.oEf(c,x))return null}}return c}catch(b){return null}}static zPc(a,b){a=a.split(" ");if(0<a.length)for(let c=0;c<a.length;c++)if(0<=a[c].indexOf(b))return a[c];return""}static NEc(a,b=!1){a&&3!==a.nodeType&&(a.style.margin="",b&&Ak.HPf(a,b))}static HPf(a,b){if(a)for(a=a.firstChild;a;)3!==a.nodeType&&(a.style&&(a.style.margin=""),b&&Ak.HPf(a,b)),a=a.nextSibling}static E8i(a){if("p"!==a.tagName.toLowerCase())return-1;
if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf("mso-list")){a=a.split(";");for(let c=0;c<a.length;c++){var b=a[c].split(":");if(2===b.length&&"mso-list"===b[0].trim()&&(b=b[1].trim().split(" "),3===b.length))return Number.parseInvariant(b[1].substr(5))}}return-1}static cRj(a){return!(void 0===a.className||null===a.className)&&a.className.startsWith("TextRun")}static Ghj(a){a=a.style.textDecorationLine;return void 0===a||null===a?null:a}static Lwg(a){return 0<=a.indexOf("line-through")}static GD(a){return 0<=
a.indexOf("underline")}}Ak.vml=(Jr=new Ha.a,Jr.add("TABLE"),Jr.add("THEAD"),Jr.add("TBODY"),Jr.add("TFOOT"),Jr.add("TR"),Jr.add("TH"),Jr.add("TD"),Jr);Object(e.a)(Ak,"DefaultHtmlTranslator",bh,[]);var Dm=d(307);class Uj{constructor(a=null){this.UR=a||Dm.a.x4d("");this.ewc=Number.parseInvariant((new Date).format("HHmmss"))}get Ib(){return this.UR}process(a,b){if(a&&a.querySelectorAll){const x=a.querySelectorAll("p");if(x&&0<x.length){for(var c=0,f=!1,l=x[0].parentNode;5>c&&l&&l!==a;){c++;const G=l.id.toLowerCase();
if(G&&G.length&&-1!==G.indexOf("_editingelement")&&Sys.UI.DomElement.containsCssClass(l,"WACEditing")&&Sys.UI.DomElement.containsCssClass(l,"EditingSurfaceBody")){f=!0;break}l=l.parentNode}if(f&&l!==a){c=a.firstChild;for(f=!1;0<l.children.length&&l.children[0]!==c;)a.insertBefore(l.children[0],c),f=!0;if(f)for(;c;)l=c.nextSibling,a.removeChild(c),c=l}a=new hd.a(b,Object(C.a)(this,this.mCe,"processNodesDiscovery"),new YB(x));a.Fl("Word Converter Operation");a.Xi=!b||b.Xi;a.run()}}}mCe(a,b){const c=
b.nodes[b.q2];var f=Uj.c1d(c);if(f){let x=f.CKa.replace(RegExp("level[0-9]"),"").trim();x=x&&x.length?x:f.CKa;let G=b.lists[x];G||(G=new mH,G.uY=this.ewc++);let R=G.wxb[f.level-1];R||(R=new nH,R.level=f.level);var l=c.parentNode;if(l&&"li"===l.tagName.toLowerCase()){if(l=l.parentNode)!(l=l.tagName.toUpperCase())||"OL"!==l&&"UL"!==l||(R.tagName=l)}else R.oWa=Uj.Jag(c,5),R.oWa&&R.oWa.length||(R.oWa=Uj.E3d(c,5)),R.ignore=!R.oWa||!R.oWa.length,R.tagName=Uj.pNc(R.oWa);f.uY=G.uY;R.jec++;R.ignore||"li"===
c.parentNode.tagName.toLowerCase()||(l=(l=Uj.E3d(c,5))?l:R.oWa)&&l.length&&(f.TRi=l,(l=Uj.o5k(c,l,R.listStyle,f.level-1))&&l.length&&(R.listStyle=l));b.u8[b.u8.length]=f;R.u8.contains(f)||R.u8.add(f);if(void 0===G.wxb[f.level-1]||null===G.wxb[f.level-1]||G.wxb[f.level-1]!==R)G.wxb[f.level-1]=R;b.lists[x]&&b.lists[x]===G||(b.lists[x]=G);b.nxb=c}else if((f=b.nxb)&&Uj.o1b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);
c.parentNode.removeChild(c)}b.q2++;if(b.nodes.length<=b.q2){if(!b.u8.length)return!1;b.q2=0;a.Zg(Object(C.a)(this,this.lCe,"processNodeConvert"))}return!0}lCe(a,b){a=b.u8[b.q2];var c=a.yfc,f=a.CKa.replace(RegExp("level[0-9]"),"").trim();f=f&&f.length?f:a.CKa;f=b.lists[f];var l=f.wxb[a.level-1],x=c.parentNode.tagName.toLowerCase();if(!l.ignore&&c.parentNode&&"li"!==x){if(x=Uj.wAi(c,l)){Uj.jWb(c,5);const G=c.ownerDocument.createElement("LI");G.setAttribute("data-aria-level",String.format("{0}",a.level));
for(G.setAttribute("data-listid",String.format("{0}",f.uY));c.firstChild;)G.appendChild(c.firstChild);x.appendChild(G);c.parentNode.removeChild(c);"UL"===l.tagName?this.Ib.b++:this.Ib.c++}}else"li"===x&&(l=l.tagName,c=c.parentNode,a.lEb&&(a=c.parentNode)&&a.tagName.toUpperCase()===l&&a.setAttribute("data-pasteFromRc","true"),c.setAttribute("data-listid",String.format("{0}",f.uY)),"UL"===l?this.Ib.b++:this.Ib.c++);b.q2++;return b.q2<b.u8.length}static wAi(a,b){a=Uj.tAi(a,b.tagName);return Uj.oQd(a,
b)}static oQd(a,b){if(b.tagName!==a.tagName){for(b=a.ownerDocument.createElement(b.tagName);a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static tAi(a,b){b=a.ownerDocument.createElement(b?b:"UL");var c=a.getAttribute("start");c&&0<c.length&&(b.setAttribute("start",c),a.removeAttribute("start"));(c=a.className)&&0<c.length&&(c="OL"===b.tagName?Ak.zPc(c,"NumberListStyle"):Ak.zPc(c,"BulletListStyle"),0<c.length&&(Sys.UI.DomElement.addCssClass(b,
c),Sys.UI.DomElement.removeCssClass(a,c)));a.parentNode.insertBefore(b,a);return b}static jWb(a,b){for(let c=0;c<a.childNodes.length;c++){const f=a.childNodes[c];1===f.nodeType&&1<b&&Uj.jWb(f,b-1);if(Uj.R$d(f)||Uj.c5b(f))a.removeChild(f),c--}}static c1d(a){if(1===a.nodeType){var b=Uj.N1b(a,"mso-list");if(b&&0<b.length)try{var c=b.split(" ");if(3===c.length){var f=new az;f.level=Number.parseInvariant(c[1].substr(5));f.CKa=b;f.yfc=a;f.lEb=!0;return f}}catch(l){}else if((c=a.parentNode)&&"li"===c.tagName.toLocaleLowerCase()&&
(b=c.getAttribute("data-"+Jc.a.MUb),c=c.getAttribute("data-listid"),b&&c&&0<b.length&&0<c.length))return f=new az,f.level=Number.parseInvariant(b),f.CKa=c+" level"+b,f.yfc=a,f.lEb=!1,f}return null}static o5k(a,b,c,f){if("p"===a.tagName.toLowerCase()&&b&&b.length){if("UL"===Uj.pNc(b))return c=Uj.j0i(b),Sys.UI.DomElement.addCssClass(a,c),c;var l;return(l=b.match(RegExp("^[0-9]+")))&&l.length?(c="NumberListStyle1",Sys.UI.DomElement.addCssClass(a,c),a.setAttribute("start",l[0]),c):(l=b.match(RegExp("^[a-zA-Z]+")))&&
l.length&&(l=l[0],f=(b=l.match(RegExp("^[ivxlcdmIVXLCDM]+")))&&b.length?Uj.adj(c,f):1,1!==f&&((c=Uj.YFc(a,l,RegExp("^[ivxlcdm]+"),Ka.a.WSf,"NumberListStyle3"))||(c=Uj.YFc(a,l,RegExp("^[IVXLCDM]+"),Ka.a.WSf,"NumberListStyle5")))||f&&((c=Uj.YFc(a,l,RegExp("^[a-z]+"),Ka.a.VSf,"NumberListStyle2"))||(c=Uj.YFc(a,l,RegExp("^[A-Z]+"),Ka.a.VSf,"NumberListStyle4"))))?c:"NumberListStyle1"}return null}static j0i(a){switch(a){case "o":return"BulletListStyle2";case "\u00a7":return"BulletListStyle3";default:return"BulletListStyle1"}}static adj(a,
b){a&&a.length||(a="");switch(a){case "NumberListStyle2":case "NumberListStyle4":a=1;break;case "NumberListStyle3":case "NumberListStyle5":a=0;break;default:a=-1}if(0>a)switch(b%3){case 0:a=0;break;case 1:a=1;break;case 2:a=0;break;default:a=0}return a}static YFc(a,b,c,f,l){return(b=b.match(c))&&b.length?(f=f(b[0]),f=1>f?1:f,Sys.UI.DomElement.addCssClass(a,l),a.setAttribute("start",f+""),l):null}static pNc(a){return a&&"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static E3d(a,b){let c=null;
var f;let l,x;for(let G=-1;!c&&G<a.childNodes.length;G++){const R=-1===G?a:a.childNodes[G];if(R)if((f=R.innerHTML)&&0<f.length){if(l=f.indexOf("\x3c!--[if !supportLists]--\x3e"),0<=l&&(x=f.indexOf("\x3c!--[endif]--\x3e"),0<=x)){f=f.substring(l,x+14);R.innerHTML=R.innerHTML.replace(f,"");if(f.length){a=a.ownerDocument.createElement("span");a.innerHTML=f;c=a.innerText.trim();break}c&&c.length||(c="o")}}else 0<=G&&1===R.nodeType&&1<b&&(c=Uj.E3d(R,b-1))}return c}static Jag(a,b){let c=null;for(let f=0;!c&&
f<a.childNodes.length;f++){const l=a.childNodes[f];Uj.c5b(l)?(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o"),l.parentNode.removeChild(l)):1===l.nodeType&&1<b&&(c=Uj.Jag(l,b-1))}return c}static c5b(a){return 1===a.nodeType&&(a=Uj.N1b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static R$d(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static N1b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=
a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&f[0].trim()===b)return f[1].trim()}}return null}static o1b(a){do a=a.previousSibling;while(a&&Uj.Q4b(a));return a}static Q4b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(Uj.Cyd,""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:Uj.Q4b(a.firstChild):!0}}Uj.Cyd=RegExp("[\n|\r]","gi");Object(e.a)(Uj,"WacAndRichClientWordConverter",null,[511]);class wH{constructor(){this.uY=
0;this.tagName="UL";this.B_b=null;this.ignore=!1;this.jec=0}}Object(e.a)(wH,"ListMetadata",null,[]);class al{constructor(a=null){this.ewc=1;this.UR=a||Dm.a.x4d("")}get Ib(){return this.UR}process(a,b){a&&a.querySelectorAll&&(a=a.querySelectorAll("p"))&&0<a.length&&(a=new hd.a(b,Object(C.a)(this,this.mCe,"processNodesDiscovery"),new YB(a)),a.Fl("Word Converter Operation"),a.Xi=!b||b.Xi,a.run())}mCe(a,b){const c=b.nodes[b.q2];var f=al.c1d(c);if(f){let l=b.eia[f.level-1];l||(l=new XB,b.eia[f.level-1]=
l);b.nxb&&al.o1b(c)!==b.nxb&&al.AVk(b);let x=l.BCg[f.CKa];if(!x)x=new wH,x.uY=this.ewc++,x.B_b=al.U_d(c,5),x.ignore=!x.B_b||!x.B_b.length,x.tagName=al.pNc(x.B_b),l.BCg[f.CKa]=x,b.lists[x.uY.toString()]=x;else if(!x.ignore&&1===x.jec){const G=al.U_d(c,5);x.tagName=x.B_b===G?"UL":"OL"}f.uY=x.uY;x.ignore||"OL"===x.tagName&&0<x.jec&&l.oHc!==f.uY?(x.ignore=!0,b.eia[0].oHc=-1,b.eia=b.eia.slice(0,1)):(b.eia.length>f.level&&(b.eia=b.eia.slice(0,f.level)),l.oHc=f.uY,b.u8[b.u8.length]=f,x.jec++);b.nxb=c}else if((f=
b.nxb)&&al.o1b(c)===f&&c.tagName===f.tagName&&c.className===f.className){f.appendChild(f.ownerDocument.createElement("BR"));for(f.appendChild(f.ownerDocument.createElement("BR"));c.firstChild;)f.appendChild(c.firstChild);c.parentNode.removeChild(c)}b.q2++;if(b.nodes.length<=b.q2){if(!b.u8.length)return!1;b.q2=0;a.Zg(Object(C.a)(this,this.lCe,"processNodeConvert"))}return!0}lCe(a,b){var c=b.u8[b.q2];a=c.yfc;const f=b.lists[c.uY.toString()];if(!f.ignore&&(c=al.iaj(a,c,f))){al.jWb(a,5);const l=a.ownerDocument.createElement("LI");
for(;a.firstChild;)l.appendChild(a.firstChild);c.appendChild(l);a.parentNode.removeChild(a);"UL"===f.tagName?this.Ib.b++:this.Ib.c++}b.q2++;return b.q2<b.u8.length}static iaj(a,b,c){let f=al.Tch(a,b.level,c);const l=K.a.te(f,"UniqueListId");if(l&&l!==b.uY||!l&&f.firstChild)a=a.ownerDocument.createElement(c.tagName),f.parentNode.insertBefore(a,f.nextSibling),f=a;K.a.Cv(f,"UniqueListId",b.uY);return al.oQd(f,c)}static oQd(a,b){if(b.tagName!==a.tagName){b=a.ownerDocument.createElement(b.tagName);for(K.a.Cv(b,
"UniqueListId",K.a.te(a,"UniqueListId"));a.firstChild;)b.appendChild(a.firstChild);a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);a=b}return a}static Tch(a,b,c){let f=null,l;1===b?l=al.o1b(a):(f=al.Tch(a,b-1,null),l=f.lastChild);if(l&&1===l.nodeType){const x=l.tagName.toUpperCase();if("UL"===x||"OL"===x)return l}c=a.ownerDocument.createElement(c?c.tagName:"UL");1===b?a.parentNode.insertBefore(c,a):f.appendChild(c);return c}static jWb(a,b){for(let c=0;c<a.childNodes.length;c++){const f=
a.childNodes[c];1===f.nodeType&&1<b&&al.jWb(f,b-1);if(al.R$d(f)||al.c5b(f))a.removeChild(f),c--}}static c1d(a){if(1===a.nodeType){const b=al.N1b(a,"mso-list");if(b&&0<b.length)try{const c=b.split(" ");if(3===c.length){const f=new az;f.level=Number.parseInvariant(c[1].substr(5));f.CKa=b;f.yfc=a;return f}}catch(c){}}return null}static pNc(a){return"o"!==a&&"\u00b7"!==a&&"\u00a7"!==a&&"-"!==a?"OL":"UL"}static U_d(a,b){let c=null;for(let f=0;!c&&f<a.childNodes.length;f++){const l=a.childNodes[f];al.c5b(l)?
(c="string"===typeof l.innerText?l.innerText.trim():l.textContent.trim(),c.length||(c="o")):1===l.nodeType&&1<b&&(c=al.U_d(l,b-1))}return c}static c5b(a){return 1===a.nodeType&&(a=al.N1b(a,"mso-list"))&&0<a.length&&"ignore"===a.trim().toLowerCase()?!0:!1}static R$d(a){return 1===a.nodeType&&!a.firstChild&&"SPAN"===a.tagName.toUpperCase()}static N1b(a,b){if((a=a.getAttribute("style"))&&0<a.length&&-1!==a.indexOf(b)){a=a.split(";");for(let c=0;c<a.length;c++){const f=a[c].split(":");if(2===f.length&&
f[0].trim()===b)return f[1].trim()}}return null}static o1b(a){do a=a.previousSibling;while(a&&al.Q4b(a));return a}static Q4b(a){return a?3===a.nodeType?(a=a.nodeValue,a=a.replace(al.Cyd,""),!a.trim().length):1!==a.nodeType||a.firstChild!==a.lastChild||"SPAN"!==a.tagName&&"FONT"!==a.tagName?!1:al.Q4b(a.firstChild):!0}static AVk(a){for(let b=0;b<a.eia.length;b++){const c=a.eia[b];c&&(c.oHc=-1)}}}al.Cyd=RegExp("[\n|\r]","gi");Object(e.a)(al,"WordConverter",null,[511]);class eC{constructor(a){this.u0a=
a.ka("ExternalPasteImprovementsEnabled")&&a.ka("ListMarkerIsEnabled")}get Y5a(){return this.u0a}create(a=null){return this.u0a?new Uj(a):new al(a)}}Object(e.a)(eC,"Box4WordConverterFactory",null,[479]);var xH=d(687);class yH{constructor(a,b,c,f,l){this.M3e=0;this.hd=a;this.rd=b;this.hkb=l;this.WY=c;this.iNa=f}Vni(a,b,c){Z.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",b,c,this.rd.zy);a.Xi&&this.rd.Nj&&window.chrome&&Z.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",
b);this.WY.Qba(!!(b&16));this.iNa.create(a,Object(C.a)(this,this.HWe,"waitingForEnsureAccessOperationResult"),null).Fl("ClipboardPreProcess");this.M3e=Date.now()}bWk(){this.WY.reset()}HWe(a){let b=!0;const c=this.WY.rOi,f=null==this.WY.YNi;null!=c?(a.L4=c,b=!1):Date.now()-this.M3e>this.hkb&&!f&&(Z.ULS.sendTraceTag(18354843,307,50,null),this.hd.Tb(Nd.a.wia,{["Reason"]:Od.a.g4g}),b=a.L4=!1);return b}}Object(e.a)(yH,"ClipboardOperationClipboardAccessHelper",null,[380]);class dz{constructor(a,b,c,f,l,
x,G,R,fa,wa,Wa,mb,Kb,nc,oc){this.Ca=a;this.hd=b;this.Sr=c;this.Ai=f;this.Qc=l;this.WY=x;this.ir=G;this.ef=R;this.Lga=fa;this.YJ=wa;this.Mga=Wa;this.Dmb=mb;this.p2a=Kb;this.Xj=oc;this.COb=nc?nc.ka("ImageDataURLSkippedForSafari12IsEnabled"):!1;this.YOb=nc?nc.ka("PasteKeepSourceFontSizeFixIsEnabled"):!1;this.kPb=nc?nc.ka("TextLayoutServiceUseResponse"):!1}get Nh(){return this.Ai}get Tc(){return this.hd}pCl(a){a.$na();return!0}jTf(a,b){a=b.Iw;Z.ULS.shipAssertTag(18130960,307,!!(a&16));if(a&256){r.a.cta&&
u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings");let c=null;b.Ef&&b.Ef.yg&&(c=b.Ef.yg.Hn);let f=!1;this.COb&&r.a.cta&&this.Xj.cfd(c,"data-src","data-srcurl");this.YOb&&(f=this.Xj.UVb(b.Ef.yg.Hn,b.Ef.Fd,!0));this.kPb&&this.Xj.Ond(c,!1);a=this.WY.copy();this.COb&&r.a.cta&&this.Xj.cfd(c,"data-srcurl","data-src");this.YOb&&f&&this.Xj.UVb(b.Ef.yg.Hn,b.Ef.Fd,!1);this.kPb&&this.Xj.Ond(c,!0);if(!a)return Z.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),
this.Tc.Tb(Nd.a.c6a,{["Reason"]:Od.a.aRe}),b.i0&&b.i0.fail("SystemClipboard did not copy",!1),b.failed=!0,!1}return!0}mXb(a,b){const c=b.Ef;Z.ULS.shipAssertTag(18130961,307,!!(b.Iw&16));b.Zfl?this.Sr.NPf():this.Sr.wQd(c,a);return!0}KHc(a,b){var c=b.context,f=b.kd;const l=b.rJ;var x=!1;a=this.Qc.Oa.kb.Ve;if(this.ir.im(a)||this.ef.Ll(a)){const G=this.YJ.Kc(a.node);let R=G.af();Z.ULS.shipAssertTag(18130962,307,R);this.Lga.Ke(G);this.Mga.n9a(G)&&(x=!0)}f=b.Iw&64?new D.DictionaryPropertySet:f||new D.DictionaryPropertySet;
f.setValue(Oc.a.urb,!1);c=this.Ca.ki(c,E.a.wK,2,!0,l,f);8===c&&(Z.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.Tc.Tb(Nd.a.wia,{["Reason"]:Od.a.HXf}),b.i0&&b.i0.fail("DeleteKey failed",!1),b.failed=!0);32===c&&x&&(b=this.Qc.Oa.kb,this.ef.Uw(b)&&b.Ua.node===a.node&&!this.ir.textLength(b.Ua.node)&&(b=this.YJ.Kc(b.Ua.node),a=this.ef.kt(b),Z.ULS.shipAssertTag(18130964,307,a),this.Lga.Ke(b),this.Mga.Vvb(b)||(a=this.Dmb.create(),a.Pc(b),this.Lga.Ava(a,!1,!1),x=this.Lga.ri(a),this.ir.Vd(x)&&
(this.Lga.Ke(a),this.Nh.merge(a,b,!1,!1),this.Qc.setSelection(this.p2a.Mg(x,this.ir.textLength(x)))))));return!0}}Object(e.a)(dz,"ClipboardOperationCutCopy",null,[508]);class zH{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc){this.Ca=a;this.hd=b;this.Sr=c;this.WY=x;this.Qc=l;this.Ai=f;this.ir=G;this.ef=R;this.Lga=fa;this.YJ=wa;this.Mga=Wa;this.Dmb=mb;this.p2a=Kb;this.eb=nc;this.Xj=oc}create(){return new dz(this.Ca,this.hd,this.Sr,this.Ai,this.Qc,this.WY,this.ir,this.ef,this.Lga,this.YJ,this.Mga,
this.Dmb,this.p2a,this.eb,this.Xj)}}Object(e.a)(zH,"Factory",null,[379]);class AH{wqh(){return!0}}Object(e.a)(AH,"ClipboardOperationCutStrategy",null,[372]);var zs=d(458),fC=d(1187),gC=d(223);class cp{constructor(a,b,c,f,l,x=null,G="",R=!0){this.Era=this.ikd=this.mXa=this.ffd=null;this.g5b=!1;this.I7d=null;this.Xve=0;this.context=a;this.Ef=a.view;this.Iw=b;this.kd=l;this.i0=c;this.rJ=f;this.IGb=this.failed=!1;this.U$c=null;this.U8a=this.qwb=!1;this.Zfl=cp.dQd(a);this.browserName=G;this.gFh=R;this.uKa=
!1;this.MOa=0;this.MOd=Ga.a.create().toString();if(a=Object(Ma.a)(10,l)?l:null){this.mXa=new D.DictionaryPropertySet;this.mXa.Jx(a);if(a.sa(Oc.a.Had,!1)){this.qwb=!0;this.U8a=a.sa(Oc.a.U8a,!1);this.U$c=x;for(x=this.Ef.Gb.Kj;x.Rw;)x=x.getContext(0);if(l=Object(ua.a)(se.AParagraphNode,x.node)){c=0;f=yb.ParagraphReader.textLength(l);switch(x.contextId){case Bb.a.textRange:c=x.Qa;f=x.Kb;break;case Bb.a.endOfParagraph:c=f}this.ffd=vb.a.F5i(x.node,c);Z.ULS.shipAssertTag(6305503,307,!!this.ffd);l=Lb.HyperlinkReader.S0b(l);
for(const fa of l)fa.Kb<=c||fa.Qa>=f||cp.hyperlinkEditor.xO(x.node,fa.hyperlink)}}this.IGb=a.sa(Oc.a.IGb,!1);this.uKa=a.sa(Oc.a.uKa,!1)}b&64&&(this.IGb=!0)}static get Tc(){return rb.a.instance}static get hyperlinkEditor(){return cp.jn||(cp.jn=fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static dQd(a){if(a){if(a.Rw){for(let b=0;b<a.length;b++)if(cp.dQd(a.getContext(b)))return!0;return!1}if(Object(Ma.a)(gC.a,a))return cp.dQd(a.fE);if(yb.ParagraphReader.Vd(a.node)&&a.node.OB)return!0}return!1}}cp.jn=
null;Object(e.a)(cp,"ClipboardActionArguments",null,[]);var xv;(function(a){a[a.paste=1]="paste";a[a.textOnly=2]="textOnly";a[a.overtype=4]="overtype";a[a.copy=16]="copy";a[a.deleteSelection=32]="deleteSelection";a[a.move=64]="move";a[a.useSystemClipboard=256]="useSystemClipboard";a[a.forceInternalClipboard=512]="forceInternalClipboard";a[a.reformatPastedContent=4096]="reformatPastedContent";a[a.pasteAsPlainText=8192]="pasteAsPlainText";a[a.showPlaceholderGlossary=65536]="showPlaceholderGlossary"})(xv||
(xv={}));Object(e.b)("ClipboardActionFlags",xv);const BH=a=>{a=a.Oa.clone();const b=[];for(let c=0;c<a.length;c++)Array.addRange(b,a.ga(c).toArray());return b},CH=a=>{const b={};let c;for(let f=0;f<a.length;f++)c=Object.getType(a[f].node).getName(),b[c]=b[c]?b[c]+1:1;a="";for(let f in b)a+=b[f]+" "+f+" elements,";return a=a.substring(0,a.length-1)};class DH extends zs.a{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg=!0){super();this.uDd=this.Iaa=this.a6=this.BB=
null;this.init(a);this.Fl("ClipboardOperation");this.qDa(fa,b,l,x,G);this.hd=wa;this.ef=Wa;this.rd=mb;this.rk=Kb;this.w_e=nc;this.z_e=oc;this.x_e=Ic;this.A_e=Kc;this.nrc=Hc;this.Rrd=ie;this.jMb=R;this.aMb=He;this.iNa=fe;this.d_h=Mg;this.hD=Te;this.Xc=We;this.Hs=Qf;this.cpa=mg;this.Qu=f;this.bAa=Xg;G&&Object(Ma.a)(10,G)&&(this.Iaa=Object(ua.a)(503,G.sa(Oc.a.BOa,null)));this.Iaa||(this.Iaa=this.bAa.KPe());this.w_a=void 0===c||null===c?"NotAvailable":Object(fC.a)(xv,c);this.Iaa.Z$h(this.w_a.split(", "));
a=this.Qu;a.view.Lh?(this.Gg=a.view,this.Gg.Gb?(this.MH=0,this.OU=c,this.vnb=Kc.mEb,!Mg||this.vnb&&this.vnb.kb&&this.vnb.length?(Kc=cb.SelectionEditor.Uw(this.vnb.kb),Kc=!(this.OU&16&&Kc),Kc=ie.XFj(c,this.Kj)&&Kc,1!==this.behavior&&Kc||(Kc||this.Iaa.fail("Clipboard operation disabled for selection",!0),this.rp=Kc?32:8,this.$X())):(this.hd.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),this.Iaa.fail("No selection when one required",!0),this.rp=8,this.finish())):(this.hd.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),
this.Iaa.fail("No selection manager",!1),this.rp=8,this.finish())):(this.hd.Tb(Nd.a.vh,{["Reason"]:Od.a.$7c}),this.Iaa.fail("Not in interactive view",!0),this.rp=8,this.finish())}get Kj(){this.uDd||(this.uDd=qd.a.rpb(this.vnb));return this.uDd}o0(){super.o0();this.vnb=null}run(){0===this.MH&&this.setup();1===this.MH&&this.process();2===this.MH&&this.teardownSync();3===this.MH&&this.teardownAsync();4===this.MH&&this.finish()}setup(){if(this.OU&256&&this.jMb){this.Ez||this.nrc.Vni(this,this.OU,this.w_a);
this.Ez.run();if(this.Ez.inProgress)return;const a=this.Ez.L4;this.IEc();if(!a){this.Iaa.fail("No access to system clipboard",!0);this.rp=8;this.MH=4;this.PXj();return}}else Z.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this.OU,this.w_a,this.rd.zy);this.OU&32&&!this.ef.xTc(this.Gg.Gb.Kj)?(Z.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this.hd.Tb(Nd.a.vh,{["Reason"]:Od.a.ASd}),this.Iaa.fail("Cut not allowed",!0),this.aMb.show(),this.rp=8,this.MH=4):(this.OU&
4096&&(this.cpa.nEe(Object.assign(new Qj,{Ovg:!0,G5g:this.w_a})),this.Hs.undo()),this.Rrd.KBk(this.OU),this.BB=this.rk.ke(15),this.BB.gd(this.Gg.vg),this.MH=1)}process(){if(!this.Ez){Z.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this.OU,this.w_a,this.rd.zy);Z.ULS.shipAssertTag(6305507,307,!this.a6);this.a6=new cp(this.Qu,this.OU,this.Iaa,this.rJ,this.NU,void 0,this.rd.zy,this.d_h);let a;a=this.OU&65536?Object(C.a)(this.w_e,this.w_e.process,"process"):this.OU&
64?Object(C.a)(this.z_e,this.z_e.process,"process"):this.OU&1?Object(C.a)(this.A_e,this.A_e.process,"process"):Object(C.a)(this.x_e,this.x_e.process,"process");this.OU&16&&this.Gg.Gb.Gna.GYd();this.iNa.create(this,a,this.a6).Fl("ClipboardAction")}Z.ULS.shipAssertTag(6305536,307,!!this.Ez);this.Ez.run();this.Ez.inProgress||(this.IEc(),this.MH=this.Xi?2:3)}teardownSync(){this.a6.qwb&&(this.BB.fd=E.a.typing);this.a6.g5b&&this.BB.D6c(this.a6.I7d,this.a6.Xve);this.BB.dispose();this.rp=this.a6.failed?8:
32;this.MH=4}teardownAsync(){if(this.Ez){if(this.Ez.run(),this.Ez.inProgress)return}else if(this.a6.qwb&&(this.BB.fd=E.a.typing),this.BB.oU(this),this.a6.g5b&&this.BB.D6c(this.a6.I7d,this.a6.Xve),this.BB.dispose(),this.HAc)return;this.rp=this.a6.failed?8:32;this.MH=4}finish(){this.cpa.nEe(Object.assign(new Qj,{Ovg:!1}));this.$X();32===this.response?Z.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.endTime-+this.startTime,this.OU,this.w_a,
this.rd.zy):Z.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.endTime-+this.startTime,this.OU,this.w_a,this.rd.zy);this.bAa.TBa(this.Iaa)}PXj(){var a=!!(this.OU&1),b=this.Qu.view;if(b){var c=b.Gb;b=this.rd.zy;u.AFrameworkApplication.Ta.processAction(E.a.xWf,2);a?Z.ULS.sendTraceTag(18617483,307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",b):(Z.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",
b),a=BH(c),1===a.length?Z.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(a[0].node).getName(),b):(c=CH(a),Z.ULS.sendTraceTag(18425101,307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",a.length,c,b)))}}}Object(e.a)(DH,"ClipboardOperation",zs.a,[]);class EH{constructor(a,b){this.Drc=null;this.Sr=a;this.TU=b;this.xB=0}process(a,b){this.xB||(this.Drc=[Object(C.a)(this,this.Zwi,"copyGlossarySelection"),Object(C.a)(this.TU,
this.TU.jwk,"pasteGlossaryPlaceholder")]);let c=!0;this.xB<this.Drc.length&&(c=this.Drc[this.xB++](a,b));return c?this.xB<this.Drc.length:!1}Zwi(a,b){if(!Object(Ma.a)(10,b.kd))return!1;const c=Object(ua.a)(10,b.kd);if(!c.Sa(Oc.a.sig))return!1;const f=c.getValue(Oc.a.sig),l=b.Ef,x=l.Gb;this.Sr.Tzl();x.ggd(()=>{x.setSelection(f,void 0,!0);this.Sr.wQd(l,a)},!0);return!0}}Object(e.a)(EH,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[502]);class FH{constructor(a){this.d0a=null;this.pR=
a;this.xB=-1}process(a,b){-1===this.xB&&(this.cFi(a,b),this.xB=0);let c=!1;this.xB<this.d0a.length&&(c=this.d0a[this.xB++](a,b));return c?this.xB<this.d0a.length:!1}cFi(a,b){r.a.j8||b.Iw&512?(this.d0a=[Object(C.a)(this.pR,this.pR.mXb,"copyInternal")],Z.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!a.Xi&&b.Iw&256?(this.d0a=[Object(C.a)(this.pR,this.pR.pCl,"waitBeforeCopy"),Object(C.a)(this.pR,this.pR.jTf,"copyExternal"),Object(C.a)(this.pR,
this.pR.mXb,"copyInternal")],Z.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this.d0a=[Object(C.a)(this.pR,this.pR.jTf,"copyExternal"),Object(C.a)(this.pR,this.pR.mXb,"copyInternal")],Z.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal."));b.Iw&32&&(a=Object(C.a)(this.pR,this.pR.KHc,"deleteForCut"),this.d0a.push(a),Z.ULS.sendTraceTag(18158337,307,
50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut."));a=b.browserName;Z.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",a);if(b.Ef)if(b=BH(b.Ef.Gb),1===b.length)Z.ULS.sendTraceTag(18425102,307,50,"Copy 1 {0} element in {1}.",Object.getType(b[0].node).getName(),a);else{const c=CH(b);Z.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",b.length,c,a)}}}Object(e.a)(FH,"ClipboardOperationCutCopyProcessor",null,[501]);class GH{constructor(a,b,c,f){this.$vc=
null;this.Sr=a;this.Qc=b;this.pR=c;this.TU=f;this.xB=0}process(a,b){this.xB||(this.$vc=[Object(C.a)(this,this.cxi,"copyMovedSelection"),Object(C.a)(this.pR,this.pR.KHc,"deleteForCut"),Object(C.a)(this,this.QVg,"moveIp"),Object(C.a)(this.TU,this.TU.O5g,"pasteInternal"),Object(C.a)(this.TU,this.TU.uoh,"setSelectionAfterPaste")]);let c=!0;this.xB<this.$vc.length&&(c=this.$vc[this.xB++](a,b));return c?this.xB<this.$vc.length:!1}cxi(a,b){b=b.Ef;this.Sr.Gzl();this.Sr.wQd(b,a);return!0}QVg(a,b){b=new Ua.Selection([b.kd],
!0);this.Qc.setSelection(b,a);return!0}}Object(e.a)(GH,"ClipboardOperationMoveProcessor",null,[499]);class HH{constructor(a,b,c,f,l,x){this.ZAd=null;this.qsf=0;this.hd=f;this.rd=b;this.TU=l;this.yvd=c;this.jMb=u.AFrameworkApplication.pjd()&&!(r.a.QS&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix"));this.hkb=a.appSettings.ChromeClipboardAccessOperationTimeout;this.xB=0;this.XKh=x}get mEb(){return this.TU.mEb}process(a,b){if(0===this.xB)return this.rwk(b);if(1===this.xB)return this.prepareForPaste(a,
b);if(2===this.xB)return this.xB=3,this.ZAd(a,b);3===this.xB&&this.TU.uoh(a,b);return!1}rwk(a){this.rd.j8||a.Iw&512?(this.ZAd=a.Iw&2?Object(C.a)(this.TU,this.TU.paste,"paste"):Object(C.a)(this.TU,this.TU.O5g,"pasteInternal"),this.xB=2):(this.jMb?(this.xB=1,this.qsf=Date.now()):this.xB=2,this.ZAd=Object(C.a)(this.TU,this.TU.paste,"paste"));Z.ULS.sendTraceTag(18617486,307,50,"Paste operation in {0}.",a.browserName);return!0}prepareForPaste(a,b){a=!0;if(this.yvd.value.q8g())this.xB=2;else{const c=Date.now()-
this.qsf;c>this.hkb&&(Z.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",c),this.hd.Tb(Nd.a.wia,{["Reason"]:Od.a.g4g}),b.i0&&b.i0.fail("Prepare for paste timed out",!1),b.failed=!0,a=!1,this.XKh.bWk())}return a}}Object(e.a)(HH,"ClipboardOperationPasteProcessor",null,[500]);class IH{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc){this.Sr=a;this.Ca=b;this.jMb=c;this.hd=f;this.ef=l;this.rd=x;this.rk=G;this.aLh=R;this.ZKh=fa;this.nrc=wa;this.Rrd=Wa;this.aMb=mb;this.iNa=Kb;this.hD=nc;this.Xc=
oc;this.Hs=Ic;this.cpa=Kc;this.bAa=Hc}create(a,b,c,f,l,x,G,R,fa=!0){const wa=this.aLh.create(f,Object(ua.a)(10,R));var Wa=this.ZKh.create();const mb=new EH(this.Sr,wa),Kb=new GH(this.Sr,qd.a.instance,Wa,wa);Wa=new FH(Wa);f=new HH(u.AFrameworkApplication.fa,pc.a.instance,f,rb.a.instance,wa,this.nrc);return new DH(a,b,c,l,x,G,R,this.jMb,this.Ca,this.hd,this.ef,this.rd,this.rk,mb,Kb,Wa,f,this.nrc,this.Rrd,this.aMb,this.iNa,this.hD,this.Xc,this.Hs,this.cpa,this.bAa,fa)}}Object(e.a)(IH,"Factory",null,
[382]);class ez{constructor(a,b){this.M7a=a.ANc(b);this.DQd=a.H2i(b);this.s4a=a.yMc(b);this.eOa=a.lMc(b)}static TV(a){return ez.mr(a)}static mr(a){return new ez(yg.a.instance,a)}}Object(e.a)(ez,"CpUsageHelper",null,[]);var As=d(173);class JH{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){this.hd=a;this.Sr=b;this.RQb=c;this.Uaa=f;this.Qc=l;this.Ca=x;this.yvd=G;this.aTb=fa;this.bBd=R;this.itd=wa;this.Qrd=Wa;this.Xc=mb}get yn(){return this.aTb.value}get T$(){return this.Uaa}get Tc(){return this.hd}get mEb(){return this.bBd.mEb}paste(a,
b){const c=this.Xc.cpb();try{const f=b.Ef;Z.ULS.shipAssertTag(18131010,307,!!(b.Iw&1));Object(Ma.a)(10,b.kd)&&b.kd.setValue(As.a.oZb,f.yg.Hn.clientWidth);this.Qrd.dtl(a,b);let l;if(!({UFc:l}=this.yvd.value.qAh()).returnValue)return b.i0&&b.i0.fail("HTML import strategy failed",!1),b.failed=!0,!1;this.yn.Yv();let x=!0,G=null;const R=this.itd.create(l),fa=b.gFh;f.Gb.ggd(()=>{fa&&2===this.Ca.processAction(E.a.ABa,2)?x=!1:(G=fa?this.Qc.Oa.kb.Ua:b.kd,Z.ULS.shipAssertTag(18158338,307,cb.SelectionEditor.Pg(G)),
this.xDg(G,"paste"))},this.bBd.Wxg);if(!x)return!1;f.editingView.disable(!0,25);R.restore();this.RQb.ewk(l,G,a);return!0}finally{c&&c.dispose()}}jwk(a,b){this.yn.Yv();const c=(new uF.a).ke(15);c.gd(this.Sr.fSe);b=Object(ua.a)(10,b.kd).getValue(Oc.a.Skj);Z.ULS.shipAssertTag(20492440,307,cb.SelectionEditor.Pg(b));this.RQb.ysg(b,a);this.Sr.NPf();c.dispose();return!0}O5g(a){this.yn.Yv();this.Ca.processAction(E.a.ABa,2);const b=this.Qc.Oa.kb.Ua;Z.ULS.shipAssertTag(18158339,307,cb.SelectionEditor.Pg(b));
this.xDg(b,"intPaste");this.RQb.ysg(b,a);return!0}xDg(a,b){b=ez.TV(b);this.T$.MKk(b,a.node,a.Qa);this.T$.QXj(b.DQd);this.T$.Kee(b.M7a);this.T$.Eee(b.s4a);this.T$.Dee(b.eOa)}uoh(a,b){if(!b.gFh)return!1;b.Iw&64&&this.Sr.Szl();if(!b.Era)return Z.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.Tc.Tb(Nd.a.T0,{["Reason"]:Od.a.Esg}),b.i0&&b.i0.fail("No selection after paste",!1),b.failed=!0,!1;this.bBd.yzl(b);this.yn.Yv();return!1}}Object(e.a)(JH,"ClipboardOperationPaste",null,[498]);class KH{constructor(a,
b,c,f,l,x,G,R,fa,wa,Wa){this.hd=a;this.Sr=b;this.RQb=c;this.Uaa=f;this.Qc=l;this.Ca=x;this.aTb=R;this.nUh=G;this.itd=fa;this.Qrd=wa;this.Xc=Wa}create(a,b){b=this.nUh.create(this.Qc,b);return new JH(this.hd,this.Sr,this.RQb,this.Uaa,this.Qc,this.Ca,a,b,this.aTb,this.itd,this.Qrd,this.Xc)}}Object(e.a)(KH,"Factory",null,[378]);class LH{constructor(a,b){this.iYh=a;this.cUh=b}get stylePropertySet(){return this.iYh}get cvk(){return this.cUh}}Object(e.a)(LH,"ParagraphFormatStore",null,[]);class MH{constructor(a,
b,c,f){this.Qc=a;this.ir=b;this.jK=c;this.VQh=f}dtl(a,b){if(b.qwb&&this.VQh){b=a.L4;var c=this.Qc.Oa.kb.Ua.node,f=null;this.ir.Vd(c)&&(f=this.jK.BD(c),c=this.ir.fsa(c),f=new LH(f,c));b=new cp(b.context,b.Iw,b.i0,b.rJ,b.kd,f);a.L4=b}}}Object(e.a)(MH,"ClipboardOperationPasteOvertypeStrategy",null,[377]);class kx{constructor(a){this.Iyd=null;this.Qc=a;a.ggd(b=>{this.Iyd=b},!1)}get Wxg(){return!1}yzl(a){a=this.iUb(a);this.setSelection(this.Qc,a)}iUb(a){let b=a.Era;(a.uKa||a.IGb)&&a.ikd&&(b=rd.SelectionFactory.bN(a.ikd,
b.Ua));return b}setSelection(a,b){a.setSelection(b)}}Object(e.a)(kx,"AClipboardOperationPasteStrategy",null,[524]);class NH extends kx{constructor(a){super(a)}get mEb(){return this.Iyd}}Object(e.a)(NH,"ClipboardOperationPasteToLiveSelectionStrategy",kx,[]);class OH extends kx{constructor(a,b){super(a);this.AGd=null;this.hQb=b;a.ggd(c=>{this.AGd=c},!0)}get Wxg(){return!0}get mEb(){return this.AGd}iUb(a){let b=super.iUb(a);a.kd.setValue(Oc.a.xwk,b);return b=this.hQb.rFl(this.Iyd.kb,this.AGd.kb,b)}}
Object(e.a)(OH,"ClipboardOperationPasteToVirtualSelectionStrategy",kx,[]);class PH{constructor(a){this.hQb=null;this.zGd=a.ka("EnableVirtualSelectionInSelectionManager")}create(a,b){return b&&b.sa(Oc.a.uKa,!1)&&this.zGd?new OH(a,this.VBl):new NH(a)}get VBl(){this.hQb||(this.hQb=fb.a.instance.qb("Box4.Actors.IVirtualSelectionMerger"));return this.hQb}}Object(e.a)(PH,"ClipboardOperationPasteStrategyFactory",null,[381]);class hC{constructor(a,b,c,f,l,x){this.hd=a;this.Qc=b;this.Yfa=c;this.dD=f;this.xQh=
l;this.iRh=x}KBk(a){this.iRh&&(a&1||a&32)&&this.Yfa.Zv&&this.Qc.ATb()}XFj(a,b){return this.xQh?a&1&&this.dD.N4a(b)?(this.hd.Tb(Nd.a.vh,{["Reason"]:Od.a.qD}),!1):!0:!0}}Object(e.a)(hC,"ClipboardOperationWordStrategy",null,[]);class QH{constructor(a){this.XLh=a.ka("CssConverterFidelityImprovementIsEnabledIsEnabled")}Cwi(a,b){if(b)if(b=b.sheet)if(b=b.cssRules){var c=Array.clone(b);u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordCssConverterFidelityImprovementIsEnabledSettings");
this.XLh&&c.reverse();var f=b=0,l=0,x=0;for(const R of c){c=R.style;var G=R.selectorText;c=c?c.cssText:null;G=G?G.split(","):null;if(c&&G&&R.type===R.STYLE_RULE){x+=G.length;for(const fa of G){0<=fa.indexOf("#")&&b++;0<=fa.indexOf(".")&&f++;0>fa.indexOf("#")&&0>fa.indexOf(".")&&l++;G=null;try{G=a.querySelectorAll(fa)}catch(wa){Z.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",fa,wa.message)}if(G)for(let wa=0;wa<G.length;wa++)G[wa].setAttribute("style",
c+(G[wa].getAttribute("style")||""))}}}Z.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",x,b,f,l)}else this.QDg();else this.QDg()}QDg(){Z.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",r.a.zy)}}Object(e.a)(QH,"ExternalPasteCssConverter",null,[386]);var fz=d(1194);class lx{constructor(a){this.YU=this.oPb=null;this.FSb=a.currentNode;
const b=new nb.GraphIterator;b.Pc(a);this.HAd=new nb.GraphIterator;this.HAd.Pc(a);this.EAd=b.origin;this.Jrd=Array(b.depth);this.gkb=Array(b.depth);this.Krd=Array(b.depth);for(a=b.depth-1;0<=a;--a){const c=b.currentNode;this.gkb[a]=b.role;this.Krd[a]=c;b.yc();this.Jrd[a]=b.R0i(c,this.gkb[a])}}Sl(a,b){this.oPb=a;this.YU=b}restore(a){const b=new fz.a,c=new fz.a;this.hih(a,b,c);return c.value}hih(a,b,c){b.value=!0;if(this.HAd.isValid)a.Pc(this.HAd),c.value=!1;else{for(let f=this.Krd.length-1;0<=f;--f){const l=
this.Krd[f];if(l.anchor&&!l.anchor.wI&&(a.set(l),a.N$(this.EAd)||this.EAd.pae&&a.nBh())){c.value=this.l3f(a,f+1);return}b.value=!1}a.set(this.EAd);c.value=this.l3f(a,0)}}l3f(a,b){let c=!1,f,l;f=this.Jrd[b];l=this.gkb[b];const x=a.B7(l);if(f<x)a.Rp(f,l);else if(c=!0,!a.HA(l))return!0;if(!this.XVg(a,l))return c;for(b+=1;b<this.Jrd.length;++b){if(c){if(!a.HA(this.gkb[b]))return!0}else if(!a.Ab(this.gkb[b]))return!1;if(!this.XVg(a,this.gkb[b]))break}return c}XVg(a,b){if(this.oPb&&!this.oPb(a,this.YU)){const c=
new nb.GraphIterator;c.Pc(a);let f=!0;do if(!a.vf(b)){f=!1;break}while(!this.oPb(a,this.YU));if(!f){a.Pc(c);do if(!a.lF(b))return a.yc(),!1;while(!this.oPb(a,this.YU))}}return!0}}Object(e.a)(lx,"NodeReference",null,[]);var tn=d(182);class Fj{constructor(a,b,c,f){this.Dmb=this.eBd=this.aLa=this.Xc=this.hD=this.Ro=this.Wyh=this.nSb=this.Po=this.Sg=this.Hw=this.iK=this.NH=null;this.Avb=a;this.tYd=this.Heb=null;this.oh=b;this.transaction=c;this.gha=f}get fa(){return u.AFrameworkApplication.fa}get HO(){return this.iK||
(this.iK=fb.a.instance.resolve("Box4.Styles.IStyleEditor"))}get paragraphEditor(){return this.Hw||(this.Hw=fb.a.instance.resolve("Box4.IParagraphEditor"))}get iJ(){return this.NH||(this.NH=fb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}get hB(){return Fj.Cx||(Fj.Cx=fb.a.instance.resolve("Box4.IOutlineEditor"))}get Tf(){return this.Sg||(this.Sg=fb.a.instance.resolve("Box4.List.IListReader"))}get jo(){return this.Po||(this.Po=fb.a.instance.resolve("Box4.List.IListEditor"))}get tmc(){return this.nSb||
(this.nSb=fb.a.instance.qb("Box4.List.ISingleLevelListEditor"))}get H5(){return this.Ro||(this.Ro=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get poc(){return this.hD||(this.hD=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}get Qf(){return this.Xc||(this.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}get KNd(){return this.aLa||(this.aLa=fb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}get Gad(){return this.eBd||
(this.eBd=fb.a.instance.qb("Box4.IPastedParagraphSpaceHandler"))}set Gad(a){this.eBd=a}get h6g(){return!1}get Iqh(){return this.fa.ka("WordEditorAutoResizeImageIsEnabled")}Q2f(){}T5g(a){var b=void 0===this.oh.Iw||null===this.oh.Iw?"not available":Object(fC.a)(xv,this.oh.Iw);Z.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.oh.Iw,b);Z.ULS.shipAssertTag(6305487,307,cb.SelectionEditor.Pg(this.Avb));if(this.d8c)return Z.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.oh.Era=rd.SelectionFactory.nu(this.Avb),
a.Zg(Object(C.a)(this,this.bXa,"pasteTeardown")),!0;b=new nb.GraphIterator;b.set(this.Avb.node);cb.SelectionEditor.kt(b);Xb.OutlineElementNavigator.Ke(b);this.Wyh=b.origin;if(this.h6g)return b.lB(10),this.Q2f(b,a),a.Zg(Object(C.a)(this,this.g7k,"setSelectionAfterPastingOutlines")),!0;if(Tf.b(b)){if(this.pug)return this.oh.Era=this.qwk(this.Avb,this.xSf),a.Zg(Object(C.a)(this,this.bXa,"pasteTeardown")),!0;this.Avb=this.Wfk(b).ga(0)}this.hil(this.Avb);const c=new tn.a;c.Pc(b);Xb.OutlineElementNavigator.eJ(c,
!1,!1);this.Heb=new lx(b);this.tYd=new lx(c);a.Zg(Object(C.a)(this,this.hwk,"pasteExecution"));return!0}hwk(a){Me.a.mark(5568);this.P2f(a);let b=Object(C.a)(this,this.vek,"mergeAfterPaste");if(this.bxg){const c=this.vrh();c&&(b=Object(C.a)(this,this.bXa,"pasteTeardown"));Z.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",c)}a.Zg(b);return!0}vrh(){return!1}get bxg(){return this.fa.ka("PptCcpFix2IsEnabled")}get sal(){return this.fa.ka("CopyAndPasteOneParagraphIndentationFixIsEnabled")}vek(a){Me.a.mark(5569);
var b=new nb.GraphIterator;this.Heb.restore(b);this.Heb=null;var c=new nb.GraphIterator;this.tYd.restore(c);this.tYd=null;Z.ULS.shipAssertTag(6305489,307,ae.OutlineElementReader.Ug(b));Z.ULS.shipAssertTag(6305490,307,ae.OutlineElementReader.Ug(c));Xb.OutlineElementNavigator.ri(b);yb.ParagraphReader.Rk(b)&&yb.ParagraphReader.textLength(b.currentNode);Xb.OutlineElementNavigator.Ke(b);Xb.OutlineElementNavigator.ri(c);Z.ULS.shipAssertTag(6305491,307,yb.ParagraphReader.Rk(c));var f=yb.ParagraphReader.textLength(c.currentNode);
Xb.OutlineElementNavigator.Ke(c);const l=this.Uqh;var x=new tn.a;x.Pc(b);Xb.OutlineElementNavigator.eJ(x,!1,!1);var G=x.currentNode===c.currentNode;var R=!!this.oh&&!!(this.oh.Iw&8192);let fa=!1;!R&&this.oh.kd&&Object(Ma.a)(D.DictionaryPropertySet,this.oh.kd)&&2===Cb.App.mode&&(R=(R=this.oh.kd.Xh(Oc.a.veb))&&""!==R?!0:!1);if(G)x=nb.GraphIterator.mb(b.currentNode),yb.ParagraphReader.Xr(Xb.OutlineElementNavigator.ri(x))||(b=c),b.currentNode.id!==c.currentNode.id&&(Z.ULS.sendTraceTag(40691869,307,50,
"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",Ib.ListReader.kk(b),Ib.ListReader.kk(c)),x=Fj.Nh.merge(b,c,!0,R),Z.ULS.shipAssertTag(6305492,307,x)),c=b,R=!0;else{var wa=!!(this.oh.Iw&4);G=this.Qf.ag&&this.Qf.By&&wa&&this.oh.U8a;this.Gad&&this.oh&&2===Cb.App.mode&&!wa&&(this.Gad.Grj(b,!1),this.Gad.Grj(c,!0));Xb.OutlineElementNavigator.ri(x);yb.ParagraphReader.Rk(x)&&yb.ParagraphReader.textLength(x.currentNode);Xb.OutlineElementNavigator.Ke(x);this.ibi(x,
b,c);if(this.KNd.PVb||this.sal)if(wa=new tn.a,wa.Pc(x),Xb.OutlineElementNavigator.eJ(wa,!1,!1),wa.pq.id!==c.pq.id){for(;x.currentNode.id!==c.currentNode.id;)Xb.OutlineElementNavigator.ri(x,!1),Mc.a.create(x.currentNode),x.yc(),Xb.OutlineElementNavigator.eJ(x,!1,!1);x.Pc(b);Xb.OutlineElementNavigator.eJ(x,!1,!1)}else fa=!0;if(this.oh.ffd&&(Z.ULS.shipAssertTag(6305493,307,this.oh.qwb),wa=new nb.GraphIterator,wa.Pc(x),wa=Xb.OutlineElementNavigator.ri(wa))){var Wa=this.oh.ffd.Ud(wa.Ra.ga(0));wa.Ra.ga(0).formatting=
Wa}Ib.ListReader.kk(b)?(Fj.eL.a6b&&this.tmc&&this.tmc.CFl(b),wa=Ib.ListReader.kk(x)?this.Vqh:!0):ae.OutlineElementReader.isEmpty(b,!0)?(Fj.Nh.FBa(b),wa=!1):wa=Ib.ListReader.Ww||!Ib.ListReader.kk(x);this.oh.ikd=null;if(this.oh.IGb||this.oh.uKa)this.oh.ikd=this.cgj(wa?b.currentNode:x.currentNode,wa);if(wa&&(Wa=Ib.ListReader.kk(b),Z.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",Wa,Ib.ListReader.kk(c)),Fj.Nh.merge(b,x,!0,R,c,void 0,
fa,G),Ib.ListReader.kk(b)&&this.Tf.Ahc)){var mb=new tn.a;mb.Pc(b);Xb.OutlineElementNavigator.eJ(mb,!1,!1);if(mb.pq.id!==c.pq.id){var Kb=this.Tf.Pw(b);this.Tf.Ula(b);const Ic=b.currentNode.sa(Mb.a.listID,0);b.yc();for(Kb.iA=wf.a.yw;mb.currentNode.id!==c.currentNode.id;){if(!Ib.ListReader.kk(mb))({u8a:Kb}=this.jo.Hob(Kb.propertySet,mb,Kb));else if(Wa){var nc=this.Tf.F8i(mb),oc=this.Tf.g1d(b.currentNode,Ic,nc);oc=oc?Ae.a.pBa(oc,null):Kb;nc=Ae.a.AP(oc.listType,Kb.listStyle,null,0,nc,"","");nc.Mik=b.currentNode;
this.jo.e6k(nc);this.jo.XKe(mb,!0)}Xb.OutlineElementNavigator.eJ(mb,!1,!1)}}}l?(Wa=new tn.a,Wa.Pc(c),Xb.OutlineElementNavigator.Ava(Wa,!1,!1),mb=Ib.ListReader.kk(Wa),Kb=Ib.ListReader.kk(c),R=Fj.Nh.merge(Wa,c,!0,R,void 0,!0,void 0,G),Z.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",mb,Kb,R?"True":"False, will cause IP to reset to zero."),c=R?Wa:c):(R=!1,Z.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero."));
this.KNd.PVb&&fa&&(wa?(x=new nb.GraphIterator,x.Pc(b),Xb.OutlineElementNavigator.ri(x)):l?(b=new nb.GraphIterator,b.Pc(x),Xb.OutlineElementNavigator.ri(b)):(b=new nb.GraphIterator,b.Pc(x),b=Xb.OutlineElementNavigator.ri(b),Mc.a.create(b)))}Z.ULS.shipAssertTag(6305494,307,c.isValid);b=Xb.OutlineElementNavigator.ri(c);f=R?yb.ParagraphReader.textLength(b)-f:0;x=!1;Object(Ma.a)(10,this.oh.kd)&&(x=this.oh.kd.sa(Oc.a.kUc,!1));x&&H.a.instance.ga(11)?this.oh.Era=rd.SelectionFactory.p2(b,f-1,f):this.oh.Era=
rd.SelectionFactory.Mg(b,f);H.a.instance.ga(71)&&this.oh&&this.oh.qwb&&yb.ParagraphReader.Vd(b)&&this.oh.U$c&&((f=this.oh.U$c.stylePropertySet)&&this.HO.y$(f,b,!0),(f=this.oh.U$c.cvk)&&this.paragraphEditor.eIf(b,f));a.Zg(Object(C.a)(this,this.bXa,"pasteTeardown"));return!0}ibi(a,b,c){var f=!1;this.Qf.ag&&this.Qf.By&&(f=!0);if(f){for(;a.currentNode!==c.currentNode;){Xb.OutlineElementNavigator.ri(a,!1);f=this.poc.$hl(Mc.a.create(a.currentNode));f.Ghg();for(let l=0;l<f.length;l++){let x;const G=({kAg:x}=
f.getContext(l)).returnValue;x&&Fj.hyperlinkEditor.$Cb(G,1)}a.yc();Xb.OutlineElementNavigator.eJ(a,!1,!1)}a.Pc(b);Xb.OutlineElementNavigator.eJ(a,!1,!1)}}cgj(a,b){a=nb.GraphIterator.mb(a);Xb.OutlineElementNavigator.ri(a);return yb.ParagraphReader.Vd(a.currentNode)?(b=b?yb.ParagraphReader.textLength(a.currentNode):0,rd.SelectionFactory.Mg(a.currentNode,b)):Jd.TableReader.G9a(a.currentNode)?rd.SelectionFactory.gl(a.currentNode):null}g7k(a){const b=nb.GraphIterator.mb(this.Wyh);b.HA(1);this.oh.Era=rd.SelectionFactory.rj(b.currentNode,
!1);a.Zg(Object(C.a)(this,this.bXa,"pasteTeardown"));return!0}bXa(){var a=void 0===this.oh.Iw||null===this.oh.Iw?"not available":Object(fC.a)(xv,this.oh.Iw);Z.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.oh.Iw,a);Z.ULS.shipAssertTag(6305497,307,!!this.oh.Era);this.transaction.dispose();a=this.gha.nK;if(!a.Lh||!a.editingView.Kl)return!1;a.editingView.Mml();return!1}H$k(a,b){const c=new nb.GraphIterator;c.Pc(a);a=Xb.OutlineElementNavigator.ri(c);b=yb.ParagraphReader.Vd(a)&&b===yb.ParagraphReader.textLength(a);
Z.ULS.sendTraceTag(50384992,307,50,"IsPasteAtEndofParagraph: {0}",b);return b}hil(a){Z.ULS.shipAssertTag(6305498,307,cb.SelectionEditor.Pg(a));const b=nb.GraphIterator.mb(a.node);var c=b.af();Xb.OutlineElementNavigator.Ke(b);Z.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{["tryToRootAtOutlineAncestorSuccess"]:c,["ipContextNodeType"]:a.node.type});c=Fj.Nh.d4b(b,!0);const f=this.H$k(b,a.Qa);Fj.Nh.LIb(b,c,a,!1,!1,f)}qwk(a,b){Z.ULS.shipAssertTag(6305500,307,a.contextId===Bb.a.Of);
const c=a.node;b=b.replace(Ka.a.tvc," ");Fj.characterPropertiesEditor.replaceTextRange(a,b);return rd.SelectionFactory.Mg(c,a.Qa+b.length)}Wfk(a){a.Mu();Fj.Ql.GIa(a);const b=Fj.Ak.Ldg(a),c=this.iJ.GXb(a);b?nq.c(a.currentNode,b+1,b+2):this.hB.Lhd(c,Cb.App.Hb.Hd.nn.i2b());this.hB.c4b(a,null,!0);return rd.SelectionFactory.rj(a.currentNode,!0)}static get Ql(){return xy.PageNavigator.instance}static get characterPropertiesEditor(){return Fj.Yg||(Fj.Yg=fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get hyperlinkEditor(){return Fj.jn||
(Fj.jn=fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Ak(){return Pw.PageReader.instance}static get Nh(){return Fj.Ai||(Fj.Ai=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get eL(){return Fj.ZJ||(Fj.ZJ=fb.a.instance.qb("Box4.List.ListSettings"))}static get qe(){return Fj.Yc||(Fj.Yc=fb.a.instance.qb("Box4.IFeatureHelper"))}}Fj.Cx=null;Fj.Yc=null;Fj.Ai=null;Fj.Yg=null;Fj.jn=null;Fj.ZJ=null;Object(e.a)(Fj,"APasteExecutionManager",null,[]);var DP=d(1193);class RH{constructor(){this.Iw=
0;this.nXb=6;this.XYd=this.WYd=this.s7f=this.VYd=this.UYd=this.TYd=this.SYd=!1;this.JCe=null;this.r7f=this.A6a=this.X_b=this.q7f=this.u7f=!1;this.a6g=this.kEb=0;this.ize=this.platform=null;this.M0a={}}get oPe(){if(this.XYd)return"Word Online";if(this.VYd)return"Google Docs";if(this.WYd||this.TYd||this.UYd)return"PowerPoint Online";if(this.SYd)return"Excel Online";switch(this.JCe){case "Word.Document":return"Word";case "OneNote.File":return"OneNote";case "Excel.Sheet":return"Excel";case "PowerPoint.Slide":return"PowerPoint"}return"Other"}IYj(){Z.ULS.sendTraceTag(51406241,
307,50,JSON.stringify(this.xgi()))}JYj(){const a=this.M0a;for(let c in a){var b=c;const f=a[c];f&&(f.SourceApp=this.oPe,f.Browser=DP.a[this.kEb],f.TagName=b,f.OperationId=this.ize,Z.ULS.sendTraceTag(51406242,307,50,JSON.stringify(f)))}}Axj(a,b){a&&a.length&&b&&b.length&&(a=a.toLowerCase(),b=b.toLowerCase(),a in this.M0a||(this.M0a[a]={}),this.M0a[a][b]=this.xgj(a,b)+1)}xgj(a,b){if(!(a&&a.length&&b&&b.length&&this.M0a&&a in this.M0a))return 0;a=a.toLowerCase();b=b.toLowerCase();return(a=this.M0a[a])&&
b in a?a[b]:0}xgi(){const a={};a.ActionIdFlags=this.Iw;a.FoundDataCcpTimestampAttribute=this.SYd;a.FoundDataClipserviceCcpidAttribute=this.TYd;a.FoundDataShapeIdsAttribute=this.UYd;a.FoundGoogleDocsInternalGuidId=this.VYd;a.FoundOneNoteOnlineSequenceClass=this.s7f;a.FoundPowerPointOnlineSequenceClass=this.WYd;a.FoundWordOnlineSequenceClass=this.XYd;a.ProgId=this.JCe;a.SourceApp=this.oPe;a.FoundText=this.u7f;a.FoundEquation=this.q7f;a.FoundList=this.X_b;a.FoundTable=this.A6a;a.FoundImage=this.r7f;
a.CopySourceBrowser=this.nXb;a.PasteBrowser=this.kEb;a.IsSameBrowserPaste=this.LOj(this.nXb,this.kEb);a.IsCrossBrowserPaste=this.NGj(this.nXb,this.kEb);a.IsUncategorizedBrowserPaste=this.FRj(this.nXb,this.kEb);a.Platform=this.platform;a.PastedHtmlLength=this.a6g;a.OperationId=this.ize;return a}LOj(a,b){return 5===a||6===a?!1:a===b}NGj(a,b){return 6===a?!1:a!==b}FRj(a,b){return 5===a&&5===b}}Object(e.a)(RH,"HtmlContentMetadata",null,[]);class gz{constructor(a,b,c=!1){this.Uf=a;this.Wv=b;this.kai=c}}
Object(e.a)(gz,"TagEventParam",null,[]);class iC{constructor(a,b=null){this.ysc=this.Ysf=this.aGd=this.tBf=null;this.Jc=a;this.UR=b||Dm.a.Jbg("");this.D8k()}get Ib(){return this.UR}wik(a,b,c){this.aGd[b]?this.GXg():(this.Ib.e++,(b=this.ysc[b])&&b(new gz(a,c,!1)),this.Ib.b++)}GXg(){this.Ib.d++}pik(){this.Ib.c++}jik(a,b,c){if(this.aGd[b])this.GXg();else{if(b=this.ysc[b])return this.Ib.b++,b(new gz(a,c,!1));this.Ib.f++}return 2}D8k(){this.tBf=ta.a.tH("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,
"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0);this.aGd=ta.a.tH("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0);this.Ysf=ta.a.tH("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0);let a=this.Jc,b=
this.Jc,c=this.Jc,f=this.Jc,l=this.Jc,x=this.Jc,G=this.Jc,R=this.Jc,fa=this.Jc,wa=this.Jc,Wa=this.Jc,mb=this.Jc,Kb=this.Jc,nc=this.Jc,oc=this.Jc,Ic=this.Jc,Kc=this.Jc,Hc=this.Jc,ie=this.Jc,He=this.Jc;this.ysc=ta.a.tH("A",Object(C.a)(this.Jc,this.Jc.p8c,"onAOpen"),"ABBR",Object(C.a)(this.Jc,this.Jc.gwe,"onAbbrOpen"),"ACRONYM",Object(C.a)(this.Jc,this.Jc.hwe,"onAcronymOpen"),"ADDRESS",Object(C.a)(this.Jc,this.Jc.iwe,"onAddressOpen"),"APPLET",Object(C.a)(this.Jc,this.Jc.pwe,"onAppletOpen"),"AREA",Object(C.a)(this.Jc,
this.Jc.swe,"onAreaTag"),"B",Object(C.a)(this.Jc,this.Jc.u8c,"onBOpen"),"BASE",Object(C.a)(this.Jc,this.Jc.twe,"onBaseTag"),"BASEFONT",Object(C.a)(this.Jc,this.Jc.uwe,"onBasefontTag"),"BDO",Object(C.a)(this.Jc,this.Jc.vwe,"onBdoOpen"),"BIG",Object(C.a)(this.Jc,this.Jc.A8c,"onBigOpen"),"BLOCKQUOTE",Object(C.a)(this.Jc,this.Jc.B8c,"onBlockquoteOpen"),"BODY",Object(C.a)(this.Jc,this.Jc.Hwe,"onBodyOpen"),"BR",Object(C.a)(this.Jc,this.Jc.C8c,"onBrTag"),"BUTTON",Object(C.a)(this.Jc,this.Jc.Mwe,"onButtonOpen"),
"CAPTION",Object(C.a)(this.Jc,this.Jc.D8c,"onCaptionOpen"),"CENTER",Object(C.a)(this.Jc,this.Jc.F8c,"onCenterOpen"),"CITE",Object(C.a)(this.Jc,this.Jc.I8c,"onCiteOpen"),"CODE",Object(C.a)(this.Jc,this.Jc.K8c,"onCodeOpen"),"COL",Object(C.a)(this.Jc,this.Jc.Ywe,"onColTag"),"COLGROUP",Object(C.a)(this.Jc,this.Jc.Zwe,"onColgroupOpen"),"DD",Object(C.a)(this.Jc,this.Jc.N8c,"onDdOpen"),"DEL",Object(C.a)(this.Jc,this.Jc.O8c,"onDelOpen"),"DFN",Object(C.a)(this.Jc,this.Jc.Q8c,"onDfnOpen"),"DIR",Object(C.a)(this.Jc,
this.Jc.R8c,"onDirOpen"),"DIV",Object(C.a)(this.Jc,this.Jc.T8c,"onDivOpen"),"DL",Object(C.a)(this.Jc,this.Jc.U8c,"onDlOpen"),"DT",Object(C.a)(this.Jc,this.Jc.V8c,"onDtOpen"),"EM",Object(C.a)(this.Jc,this.Jc.Y8c,"onEmOpen"),"FIELDSET",Object(C.a)(this.Jc,this.Jc.txe,"onFieldsetOpen"),"FONT",Object(C.a)(this.Jc,this.Jc.f9c,"onFontOpen"),"FORM",Object(C.a)(this.Jc,this.Jc.zxe,"onFormOpen"),"FRAME",Object(C.a)(this.Jc,this.Jc.Axe,"onFrameTag"),"FRAMESET",Object(C.a)(this.Jc,this.Jc.Bxe,"onFramesetOpen"),
"H1",Object(C.a)(this.Jc,this.Jc.k9c,"onH1Open"),"H2",Object(C.a)(this.Jc,this.Jc.l9c,"onH2Open"),"H3",Object(C.a)(this.Jc,this.Jc.m9c,"onH3Open"),"H4",Object(C.a)(this.Jc,this.Jc.n9c,"onH4Open"),"H5",Object(C.a)(this.Jc,this.Jc.o9c,"onH5Open"),"H6",Object(C.a)(this.Jc,this.Jc.p9c,"onH6Open"),"HEAD",Object(C.a)(this.Jc,this.Jc.Fxe,"onHeadOpen"),"HR",Object(C.a)(this.Jc,this.Jc.q9c,"onHrTag"),"HTML",Object(C.a)(this.Jc,this.Jc.Hxe,"onHtmlOpen"),"I",Object(C.a)(this.Jc,this.Jc.s9c,"onIOpen"),"IFRAME",
Object(C.a)(this.Jc,this.Jc.Jxe,"onIframeOpen"),"IMG",Object(C.a)(this.Jc,this.Jc.t9c,"onImgTag"),"INPUT",Object(C.a)(this.Jc,this.Jc.Lxe,"onInputTag"),"INS",Object(C.a)(this.Jc,this.Jc.u9c,"onInsOpen"),"ISINDEX",Object(C.a)(this.Jc,this.Jc.Sxe,"onIsindexOpen"),"KBD",Object(C.a)(this.Jc,this.Jc.v9c,"onKbdOpen"),"LABEL",Object(C.a)(this.Jc,this.Jc.x9c,"onLabelOpen"),"LEGEND",Object(C.a)(this.Jc,this.Jc.z9c,"onLegendOpen"),"LI",Object(C.a)(this.Jc,this.Jc.A9c,"onLiOpen"),"LINK",Object(C.a)(this.Jc,
this.Jc.Vxe,"onLinkTag"),"MAP",Object(C.a)(this.Jc,this.Jc.Wxe,"onMapOpen"),"MATH",Object(C.a)(this.Jc,this.Jc.E9c,"onMathOpen"),"MENU",Object(C.a)(this.Jc,this.Jc.vDb,"onMenuOpen"),"META",Object(C.a)(this.Jc,this.Jc.Zxe,"onMetaTag"),"NOFRAMES",Object(C.a)(this.Jc,this.Jc.bye,"onNoframesOpen"),"NOSCRIPT",Object(C.a)(this.Jc,this.Jc.cye,"onNoscriptOpen"),"OBJECT",Object(C.a)(this.Jc,this.Jc.dye,"onObjectOpen"),"OL",Object(C.a)(this.Jc,this.Jc.L9c,"onOlOpen"),"OPTGROUP",Object(C.a)(this.Jc,this.Jc.eye,
"onOptgroupOpen"),"OPTION",Object(C.a)(this.Jc,this.Jc.P9c,"onOptionOpen"),"P",Object(C.a)(this.Jc,this.Jc.S9c,"onPOpen"),"PARAM",Object(C.a)(this.Jc,this.Jc.gye,"onParamTag"),"PRE",Object(C.a)(this.Jc,this.Jc.d$c,"onPreOpen"),"Q",Object(C.a)(this.Jc,this.Jc.qye,"onQOpen"),"S",Object(C.a)(this.Jc,this.Jc.l$c,"onSOpen"),"SAMP",Object(C.a)(this.Jc,this.Jc.m$c,"onSampOpen"),"SCRIPT",Object(C.a)(this.Jc,this.Jc.Bye,"onScriptOpen"),"SELECT",Object(C.a)(this.Jc,this.Jc.Cye,"onSelectOpen"),"SMALL",Object(C.a)(a,
a.w$c,"onSmallOpen"),"SPAN",Object(C.a)(b,b.x$c,"onSpanOpen"),"STRIKE",Object(C.a)(c,c.y$c,"onStrikeOpen"),"STRONG",Object(C.a)(f,f.z$c,"onStrongOpen"),"STYLE",Object(C.a)(l,l.Iye,"onStyleOpen"),"SUB",Object(C.a)(x,x.A$c,"onSubOpen"),"SUP",Object(C.a)(G,G.B$c,"onSupOpen"),"TABLE",Object(C.a)(R,R.F$c,"onTableOpen"),"TBODY",Object(C.a)(fa,fa.Lye,"onTbodyOpen"),"TD",Object(C.a)(wa,wa.lfc,"onTdOpen"),"TEXTAREA",Object(C.a)(Wa,Wa.Nye,"onTextareaOpen"),"TFOOT",Object(C.a)(mb,mb.Oye,"onTfootOpen"),"TH",
Object(C.a)(Kb,Kb.G$c,"onThOpen"),"THEAD",Object(C.a)(nc,nc.Pye,"onTheadOpen"),"TITLE",Object(C.a)(oc,oc.Rye,"onTitleOpen"),"TR",Object(C.a)(Ic,Ic.H$c,"onTrOpen"),"TT",Object(C.a)(Kc,Kc.K$c,"onTtOpen"),"U",Object(C.a)(Hc,Hc.L$c,"onUOpen"),"UL",Object(C.a)(ie,ie.M$c,"onUlOpen"),"VAR",Object(C.a)(He,He.O$c,"onVarOpen"))}}Object(e.a)(iC,"AHtmlProcessor",null,[]);class jC{constructor(a,b){this.childNodes=a.childNodes;this.Wv=b;this.hSd=0;this.uTc=!1}}Object(e.a)(jC,"HtmlProcessorArguments",null,[]);class Yq extends iC{constructor(a,
b=null){super(a,b);this.dxd=null}get OMj(){null==this.dxd&&(this.dxd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("CopyAndPasteTextFromWordWin32FixIsEnabled"):!1);return this.dxd}process(a,b=null){a&&(this.Jc.reset(),this.o9g(new jC(a,new Wt),b))}o9g(a,b){a.childNodes.length&&(a=new hd.a(b,Object(C.a)(this,this.SCk,"processChild"),a),a.Fl("HTML Processing Operation"),b||(a.Xi=!0),a.run())}SCk(a,b){const c=b.childNodes[b.hSd];if(3===c.nodeType)return this.Jc.w8c(),this.Jc.g0(c.nodeValue,
new gz(c,b.Wv.y$f())),Yq.lKb(b);if(1!==c.nodeType)return Yq.lKb(b);if(!b.uTc){const l=Ka.a.rB(c.tagName);if(!Yq.Hsj(c))if(this.Ysf[l])this.pik();else{Yq.Vck(c);this.Jc.w8c();var f=c.id;const x=c.tagName,G=b.Wv.y$f(),R=c.getAttribute?c.getAttribute("class"):null;f=new Xt(f,x,R?R:"",c.attributes?c.attributes.length:0);f.isValid&&G.add(f);if(this.tBf[l])return this.wik(c,l,G),Yq.lKb(b);f=!1;switch(this.jik(c,l,G)){case 1:f=!0;break;case 3:return Yq.lKb(b)}switch(this.Jc.Z4d(c)){case 1:f=!0}b.uTc=f;this.o9g(new jC(c,
G),a);if(!a.Xi)return!0}}if(b.uTc){if(this.OMj&&!this.ysc[Ka.a.rB(c.tagName)])return Yq.lKb(b);this.Jc.onClose()}return Yq.lKb(b)}static Vck(a){3!==a.nodeType&&K.a.Cv(a,"alreadyPasted",!0)}static Hsj(a){return 3!==a.nodeType&&K.a.te(a,"alreadyPasted")}static lKb(a){a.hSd++;a.uTc=!1;return a.hSd<a.childNodes.length}}Object(e.a)(Yq,"HtmlProcessor",iC,[]);var Kr=d(919);class SH{constructor(a,b=null,c=null,f=null){this.Xd=a;this.UR=b||Dm.a.Ibg(r.a.Z3a,"");this.mq=c;this.vpa=f?f.ka("ParseStyleForHtmlTagEventIsEnabled"):
!1}get Ib(){return this.UR}get Dn(){return this.mq}zf(a){return a?a+1:1}reset(){this.Xd.reset()}w8c(){this.Xd.w8c()}Z4d(a){if(a&&this.Dn&&(a.getAttribute&&(a.getAttribute(Kr.a.CWf)&&(this.Dn.SYd=!0),a.getAttribute(Kr.a.DWf)&&(this.Dn.TYd=!0),a.getAttribute(Kr.a.HWf)&&(this.Dn.UYd=!0)),a.id&&a.id.startsWith&&a.id.startsWith(Kr.a.Iig)&&(this.Dn.VYd=!0),a.className&&a.className.split))for(const b of a.className.split(" ")){b.startsWith(Kr.a.E3g)&&(this.Dn.s7f=!0);b.startsWith(Kr.a.J7g)&&(this.Dn.WYd=
!0);b.startsWith(Kr.a.xGh)&&(this.Dn.XYd=!0);if(b.startsWith(r.a.iVb)&&b.length===r.a.iVb.length+1){const c=parseInt(Ka.a.substring(b,b.length-1,b.length));isNaN(c)||(this.Dn.nXb=c)}if(b===Kr.a.tWg||b===Kr.a.uWg)this.Dn.X_b=!0}return this.Xd.Z4d(a)}onClose(){this.Xd.onClose()}g0(a,b){this.Dn&&(this.Dn.u7f=!0);this.Ib.d=this.zf(this.Ib.d);this.vpa&&this.fwa(b);this.Xd.g0(a,b)}p8c(a){this.Ib.e=this.zf(this.Ib.e);this.vpa&&this.fwa(a);return this.Xd.p8c(a)}gwe(a){this.Ib.f=this.zf(this.Ib.f);return this.Xd.gwe(a)}hwe(a){this.Ib.g=
this.zf(this.Ib.g);return this.Xd.hwe(a)}iwe(a){this.Ib.h=this.zf(this.Ib.h);return this.Xd.iwe(a)}pwe(a){this.Ib.i=this.zf(this.Ib.i);return this.Xd.pwe(a)}swe(a){this.Ib.j=this.zf(this.Ib.j);this.Xd.swe(a)}u8c(a){this.Ib.k=this.zf(this.Ib.k);return this.Xd.u8c(a)}twe(a){this.Ib.l=this.zf(this.Ib.l);this.Xd.twe(a)}uwe(a){this.Ib.m=this.zf(this.Ib.m);this.Xd.uwe(a)}vwe(a){this.Ib.n=this.zf(this.Ib.n);return this.Xd.vwe(a)}A8c(a){this.Ib.o=this.zf(this.Ib.o);return this.Xd.A8c(a)}B8c(a){this.Ib.p=
this.zf(this.Ib.p);return this.Xd.B8c(a)}Hwe(a){this.Ib.q=this.zf(this.Ib.q);return this.Xd.Hwe(a)}C8c(a){this.Ib.r=this.zf(this.Ib.r);this.Xd.C8c(a)}Mwe(a){this.Ib.s=this.zf(this.Ib.s);return this.Xd.Mwe(a)}D8c(a){this.Ib.t=this.zf(this.Ib.t);return this.Xd.D8c(a)}F8c(a){this.Ib.u=this.zf(this.Ib.u);return this.Xd.F8c(a)}I8c(a){this.Ib.v=this.zf(this.Ib.v);return this.Xd.I8c(a)}K8c(a){this.Ib.w=this.zf(this.Ib.w);return this.Xd.K8c(a)}Ywe(a){this.Ib.x=this.zf(this.Ib.x);this.Xd.Ywe(a)}Zwe(a){this.Ib.y=
this.zf(this.Ib.y);return this.Xd.Zwe(a)}N8c(a){this.Ib.z=this.zf(this.Ib.z);return this.Xd.N8c(a)}O8c(a){this.Ib.ba=this.zf(this.Ib.ba);return this.Xd.O8c(a)}Q8c(a){this.Ib.bb=this.zf(this.Ib.bb);return this.Xd.Q8c(a)}R8c(a){this.Ib.bc=this.zf(this.Ib.bc);return this.Xd.R8c(a)}T8c(a){this.Ib.bd=this.zf(this.Ib.bd);return this.Xd.T8c(a)}U8c(a){this.Ib.be=this.zf(this.Ib.be);return this.Xd.U8c(a)}V8c(a){this.Ib.bf=this.zf(this.Ib.bf);return this.Xd.V8c(a)}Y8c(a){this.Ib.bg=this.zf(this.Ib.bg);return this.Xd.Y8c(a)}txe(a){this.Ib.bh=
this.zf(this.Ib.bh);return this.Xd.txe(a)}f9c(a){this.Ib.bi=this.zf(this.Ib.bi);return this.Xd.f9c(a)}zxe(a){this.Ib.bj=this.zf(this.Ib.bj);return this.Xd.zxe(a)}Axe(a){this.Ib.bk=this.zf(this.Ib.bk);this.Xd.Axe(a)}Bxe(a){this.Ib.bl=this.zf(this.Ib.bl);return this.Xd.Bxe(a)}k9c(a){this.Ib.bm=this.zf(this.Ib.bm);return this.Xd.k9c(a)}l9c(a){this.Ib.bm=this.zf(this.Ib.bm);return this.Xd.l9c(a)}m9c(a){this.Ib.bm=this.zf(this.Ib.bm);return this.Xd.m9c(a)}n9c(a){this.Ib.bm=this.zf(this.Ib.bm);return this.Xd.n9c(a)}o9c(a){this.Ib.bm=
this.zf(this.Ib.bm);return this.Xd.o9c(a)}p9c(a){this.Ib.bm=this.zf(this.Ib.bm);return this.Xd.p9c(a)}Fxe(a){this.Ib.bn=this.zf(this.Ib.bn);return this.Xd.Fxe(a)}q9c(a){this.Ib.bo=this.zf(this.Ib.bo);this.Xd.q9c(a)}Hxe(a){this.Ib.bp=this.zf(this.Ib.bp);return this.Xd.Hxe(a)}s9c(a){this.Ib.bq=this.zf(this.Ib.bq);return this.Xd.s9c(a)}Jxe(a){this.Ib.br=this.zf(this.Ib.br);return this.Xd.Jxe(a)}t9c(a){this.Dn&&(this.Dn.r7f=!0);this.vpa&&this.fwa(a);this.Ib.bs=this.zf(this.Ib.bs);this.Xd.t9c(a)}Lxe(a){this.Ib.bt=
this.zf(this.Ib.bt);this.Xd.Lxe(a)}u9c(a){this.Ib.bu=this.zf(this.Ib.bu);return this.Xd.u9c(a)}Sxe(a){this.Ib.bv=this.zf(this.Ib.bv);return this.Xd.Sxe(a)}v9c(a){this.Ib.bw=this.zf(this.Ib.bw);return this.Xd.v9c(a)}x9c(a){this.Ib.bx=this.zf(this.Ib.bx);return this.Xd.x9c(a)}z9c(a){this.Ib.by=this.zf(this.Ib.by);return this.Xd.z9c(a)}A9c(a){this.Dn&&(this.Dn.X_b=!0);this.Ib.bz=this.zf(this.Ib.bz);this.vpa&&this.fwa(a);return this.Xd.A9c(a)}Vxe(a){this.Ib.ca=this.zf(this.Ib.ca);this.Xd.Vxe(a)}Wxe(a){this.Ib.cb=
this.zf(this.Ib.cb);return this.Xd.Wxe(a)}E9c(a){this.Dn&&(this.Dn.q7f=!0);this.Ib.cc=this.zf(this.Ib.cc);return this.Xd.E9c(a)}vDb(a){this.Ib.cd=this.zf(this.Ib.cd);return this.Xd.vDb(a)}Zxe(a){this.Ib.ce=this.zf(this.Ib.ce);this.Xd.Zxe(a)}bye(a){this.Ib.cf=this.zf(this.Ib.cf);return this.Xd.bye(a)}cye(a){this.Ib.cg=this.zf(this.Ib.cg);return this.Xd.cye(a)}dye(a){this.Ib.ch=this.zf(this.Ib.ch);return this.Xd.dye(a)}L9c(a){this.Dn&&(this.Dn.X_b=!0);this.Ib.ci=this.zf(this.Ib.ci);this.vpa&&this.fwa(a);
return this.Xd.L9c(a)}eye(a){this.Ib.cj=this.zf(this.Ib.cj);return this.Xd.eye(a)}P9c(a){this.Ib.ck=this.zf(this.Ib.ck);return this.Xd.P9c(a)}S9c(a){this.Ib.cl=this.zf(this.Ib.cl);this.vpa&&this.fwa(a);return this.Xd.S9c(a)}gye(a){this.Ib.cm=this.zf(this.Ib.cm);this.Xd.gye(a)}d$c(a){this.Ib.cn=this.zf(this.Ib.cn);return this.Xd.d$c(a)}qye(a){this.Ib.co=this.zf(this.Ib.co);return this.Xd.qye(a)}l$c(a){this.Ib.cp=this.zf(this.Ib.cp);return this.Xd.l$c(a)}m$c(a){this.Ib.cq=this.zf(this.Ib.cq);return this.Xd.m$c(a)}Bye(a){this.Ib.cr=
this.zf(this.Ib.cr);return this.Xd.Bye(a)}Cye(a){this.Ib.cs=this.zf(this.Ib.cs);return this.Xd.Cye(a)}w$c(a){this.Ib.ct=this.zf(this.Ib.ct);return this.Xd.w$c(a)}x$c(a){this.Ib.cu=this.zf(this.Ib.cu);this.vpa&&this.fwa(a);return this.Xd.x$c(a)}y$c(a){this.Ib.cv=this.zf(this.Ib.cv);return this.Xd.y$c(a)}z$c(a){this.Ib.cw=this.zf(this.Ib.cw);return this.Xd.z$c(a)}Iye(a){this.Ib.cx=this.zf(this.Ib.cx);return this.Xd.Iye(a)}A$c(a){this.Ib.cy=this.zf(this.Ib.cy);return this.Xd.A$c(a)}B$c(a){this.Ib.cz=
this.zf(this.Ib.cz);return this.Xd.B$c(a)}F$c(a){this.Dn&&(this.Dn.A6a=!0);this.Ib.da=this.zf(this.Ib.da);this.vpa&&this.fwa(a);return this.Xd.F$c(a)}Lye(a){this.Dn&&(this.Dn.A6a=!0);this.Ib.db=this.zf(this.Ib.db);this.vpa&&this.fwa(a);return this.Xd.Lye(a)}lfc(a){this.Dn&&(this.Dn.A6a=!0);this.Ib.dc=this.zf(this.Ib.dc);this.vpa&&this.fwa(a);return this.Xd.lfc(a)}Nye(a){this.Ib.dd=this.zf(this.Ib.dd);return this.Xd.Nye(a)}Oye(a){this.Ib.de=this.zf(this.Ib.de);return this.Xd.Oye(a)}G$c(a){this.Dn&&
(this.Dn.A6a=!0);this.Ib.df=this.zf(this.Ib.df);return this.Xd.G$c(a)}Pye(a){this.Dn&&(this.Dn.A6a=!0);this.Ib.dg=this.zf(this.Ib.dg);return this.Xd.Pye(a)}Rye(a){this.Ib.dh=this.zf(this.Ib.dh);return this.Xd.Rye(a)}H$c(a){this.Dn&&(this.Dn.A6a=!0);this.Ib.di=this.zf(this.Ib.di);return this.Xd.H$c(a)}K$c(a){this.Ib.dj=this.zf(this.Ib.dj);return this.Xd.K$c(a)}L$c(a){this.Ib.dk=this.zf(this.Ib.dk);return this.Xd.L$c(a)}M$c(a){this.Dn&&(this.Dn.X_b=!0);this.Ib.dl=this.zf(this.Ib.dl);return this.Xd.M$c(a)}O$c(a){this.Ib.dm=
this.zf(this.Ib.dm);return this.Xd.O$c(a)}fwa(a){if((a=a.Uf)&&a.style&&this.Dn){var b=a.style;if(b)for(const c of b)c&&0<c.length&&this.Dn.Axj(a.tagName,c)}}}Object(e.a)(SH,"HtmlEventUsageCollector",null,[475]);class TH{constructor(a,b=null,c=null){this.Xd=a;this.UR=b||Dm.a.wfg("");this.BYh=c||Dm.a.xfg("")}get Ib(){return this.UR}get lRe(){return this.BYh}FX(a){this.lRe.b++;this.Xd.FX(a)}CX(){this.Xd.CX()}EX(a){this.lRe.c++;this.Xd.EX(a)}DX(){this.Xd.DX()}BX(a){this.lRe.d++;this.Xd.BX(a)}AX(){this.Xd.AX()}reset(){this.Xd.reset()}get uYb(){return this.Xd.uYb}g0(a,
b){this.Ib.b++;this.Xd.g0(a,b)}kma(a){this.Ib.c++;this.Xd.kma(a)}SWa(a){this.Ib.b++;this.Xd.SWa(a)}jma(a){this.Ib.d++;this.Xd.jma(a)}ima(a){this.Ib.f++;this.Xd.ima(a)}Jva(a,b){this.Ib.g++;this.Xd.Jva(a,b)}Iva(){this.Xd.Iva()}fA(a){this.Ib.h++;this.Xd.fA(a)}eA(){this.Xd.eA()}MWa(){this.Xd.MWa()}LWa(){this.Xd.LWa()}Ova(a,b){this.Ib.i++;this.Xd.Ova(a,b)}DHa(){this.Xd.DHa()}nma(a){this.Ib.j++;this.Xd.nma(a)}lma(){this.Xd.lma()}Nva(a){this.Ib.k++;this.Xd.Nva(a)}mma(){this.Xd.mma()}NWa(a){this.Ib.l++;this.Xd.NWa(a)}}
Object(e.a)(TH,"SemanticEventUsageCollector",null,[458,445]);class kC{constructor(a){this.wh=a}reset(){this.wh.reset()}get uYb(){return this.wh.uYb}g0(a,b){this.wh.g0(a,b)}kma(a){this.wh.kma(a)}SWa(a){this.wh.SWa(a)}jma(a){this.wh.jma(a)}ima(a){this.wh.ima(a)}Jva(a,b){this.wh.Jva(a,b)}Iva(){this.wh.Iva()}fA(a){this.wh.fA(a)}eA(){this.wh.eA()}MWa(){this.wh.MWa()}LWa(){this.wh.LWa()}nma(a){this.wh.nma(a)}lma(){this.wh.lma()}Nva(a){this.wh.Nva(a)}mma(){this.wh.mma()}NWa(a){this.wh.NWa(a)}FX(a){this.wh.FX(a)}CX(){this.wh.CX()}EX(a){this.wh.EX(a)}DX(){this.wh.DX()}BX(a){this.wh.BX(a)}AX(){this.wh.AX()}Ova(a,
b){this.wh.Ova(a,b)}DHa(){this.wh.DHa()}}Object(e.a)(kC,"AHtmlNormalizer",null,[458,445]);class lC extends kC{constructor(a){super(a);this.FC=!1}g0(a,b){this.FC?this.MF.bF(()=>{this.FCe(a,b)}):this.FCe(a,b)}FCe(a,b){this.wh.g0(a,b)}kma(a){this.FC?this.MF.bF(()=>{this.fCe(a)}):this.fCe(a)}fCe(a){this.wh.kma(a)}jma(a){this.FC?this.MF.bF(()=>{this.uhc(a)}):this.uhc(a)}uhc(a){this.wh.jma(a)}ima(a){this.FC?this.MF.bF(()=>{this.eCe(a)}):this.eCe(a)}eCe(a){this.wh.ima(a)}Jva(a,b){this.FC?this.MF.bF(()=>
{this.$Be(a,b)}):this.$Be(a,b)}$Be(a,b){this.wh.Jva(a,b)}Iva(){this.FC?this.MF.bF(Object(C.a)(this,this.ZBe,"processAnchorEnd")):this.ZBe()}ZBe(){this.wh.Iva()}fA(a){this.FC?this.MF.bF(()=>{this.pCe(a)}):this.pCe(a)}pCe(a){this.wh.fA(a)}eA(){this.FC?this.MF.bF(Object(C.a)(this,this.oCe,"processParagraphEnd")):this.oCe()}oCe(){this.wh.eA()}MWa(){this.FC?this.MF.bF(Object(C.a)(this,this.rCe,"processPreFormattedTextStart")):this.rCe()}rCe(){this.wh.MWa()}LWa(){this.FC?this.MF.bF(Object(C.a)(this,this.qCe,
"processPreFormattedTextEnd")):this.qCe()}qCe(){this.wh.LWa()}nma(a){this.FC?this.MF.bF(()=>{this.jCe(a)}):this.jCe(a)}jCe(a){this.wh.nma(a)}lma(){this.FC?this.MF.bF(Object(C.a)(this,this.gCe,"processListEnd")):this.gCe()}gCe(){this.wh.lma()}Nva(a){this.FC?this.MF.bF(()=>{this.iCe(a)}):this.iCe(a)}iCe(a){this.wh.Nva(a)}mma(){this.FC?this.MF.bF(Object(C.a)(this,this.hCe,"processListItemEnd")):this.hCe()}hCe(){this.wh.mma()}FX(a){this.FC?this.MF.bF(()=>{this.ECe(a)}):this.ECe(a)}ECe(a){this.wh.FX(a)}CX(){this.FC?
this.MF.bF(Object(C.a)(this,this.BCe,"processTableEnd")):this.BCe()}BCe(){this.wh.CX()}EX(a){this.FC?this.MF.bF(()=>{this.DCe(a)}):this.DCe(a)}DCe(a){this.wh.EX(a)}DX(){this.FC?this.MF.bF(Object(C.a)(this,this.CCe,"processTableRowEnd")):this.CCe()}CCe(){this.wh.DX()}BX(a){this.FC?this.MF.bF(()=>{this.ACe(a)}):this.ACe(a)}ACe(a){this.wh.BX(a)}AX(){this.FC?this.MF.bF(Object(C.a)(this,this.zCe,"processTableCellEnd")):this.zCe()}zCe(){this.wh.AX()}Ova(a,b){this.FC?this.MF.bF(()=>{this.kCe(a,b)}):this.kCe(a,
b)}kCe(a,b){this.wh.Ova(a,b)}DHa(){this.FC?this.MF.bF(Object(C.a)(this,this.B9g,"processMathEnd")):this.B9g()}B9g(){this.wh.DHa()}}Object(e.a)(lC,"AQueuingHtmlNormalizer",kC,[]);class UH{constructor(a){this.next=null;this.data=a}}Object(e.a)(UH,"QueueNode",null,[]);class mC{constructor(){this.A0a=this.H_a=null;this.Mk=0}get count(){return this.Mk}get isEmpty(){return!this.Mk||!this.H_a||!this.A0a}enqueue(a){a=new UH(a);this.isEmpty?this.A0a=this.H_a=a:this.H_a=this.H_a.next=a;this.Mk++}back(){return this.isEmpty?
null:this.H_a.data}dequeue(){if(this.isEmpty)return null;const a=this.A0a;this.A0a=a.next;this.Mk--;this.A0a||(this.H_a=null);return a.data}clear(){this.A0a=this.H_a=null;this.Mk=0}toArray(){const a=Array(this.count);let b=this.A0a;for(let c=0;c<this.count&&b;c++)a[c]=b.data,b=b.next;return a}}Object(e.a)(mC,"Queue",null,[]);class mx{constructor(){this.WBd=new mC}bF(a){this.WBd.enqueue(a)}flush(a=!1){for(a&&this.qhd();!this.WBd.isEmpty;)this.WBd.dequeue()();a&&this.ofd()}qhd(){}ofd(){}}Object(e.a)(mx,
"QueuedEventManager",null,[]);class hz extends mx{constructor(a){super();this.id=void 0;this.mSd=null;this.qUc=!1;this.Rfc="";this.pUc=this.fVc=!1;this.kSd=this.$qb=null;this.Ydc=0;this.j5b=this.u6b=this.Qce=!1;this.table=null;this.lve=0;this.fP=a}get oUb(){return!!this.table}qhd(){this.fP.RDb.push(this.fP.currentState);this.fP.currentState=this}ofd(){this.fP.currentState=this.fP.RDb.pop()}}hz.nextId=void 0;Object(e.a)(hz,"ContentState",mx,[]);class VH{constructor(a,b,c){this.colSpan=a.colSpan;this.rowSpan=
a.rowSpan;this.width=a.width;this.height=a.height;this.jEa=a.jEa;this.zlc=a.zlc;this.verticalAlignment=a.verticalAlignment;this.x5=a.x5;this.ald=a.ald;this.Owb=a.Owb;this.gEc=a.gEc;this.contents=c;this.Qkj=b}}Object(e.a)(VH,"TableCell",null,[]);class WH extends mx{constructor(a,b){super();this.fP=a;this.Iyf=new Wt;this.$F=new Wt;this.kzd=[];this.hyc=[];this.uoa=-1;this.Kya=0;this.WPh=b.Otg;this.VPh=b.gFj;this.tYh=b.cRe;this.h3a=b.width;this.ccf=b.jEa;this.FOh=new Wm(new Xt(b.ZT.Rmg,b.ZT.u3b),b.Wv,
b.N4,b.cultureName,b.hha);this.vPh=b.Q7d;this.pzc=b.Svh;this.zYh=b.tableLook}get wh(){return this.fP.wh}TBk(a){this.uoa++;this.Iyf.add(a);this.hyc[this.uoa]=a.height;this.Kya=0}get JEi(){for(;this.Kya>=this.$F.count;)this.$F.add(Array(this.uoa+1));return this.$F.ga(this.Kya)}tHd(a,b,c,f,l,x,G){if(0>this.uoa)return!1;for(;this.kzd[this.Kya]>=this.uoa;)this.Kya++;a=new VH(a,new Wm(b,c,f,l,x),G);this.JEi[this.uoa]=a;if(1<a.rowSpan)for(b=this.uoa+a.rowSpan-1,f=this.Kya,c=this.Kya+a.colSpan-1;f<=c;f++)this.kzd[f]>=
b||(this.kzd[f]=b);this.Kya+=a.colSpan;this.hyc[this.uoa]<a.height&&(this.hyc[this.uoa]=a.height);return!0}qhd(){this.fP.currentState.table=this}ofd(){this.fP.currentState.table=null}B6f(){this.flush(!0);const a=this.uoa+1;var b=Array(a);for(var c=0;c<a;c++)b[c]=Array(this.$F.count);c=!0;var f=0;for(var l=0;l<this.$F.count;l++){var x=this.$F.ga(l),G=!0;for(var R=0;R<a;R++){var fa=x[R];fa&&(G=!1,b[R][l+f]=new cz(fa.colSpan,fa.rowSpan,fa.width,fa.height,void 0,void 0,void 0,void 0,fa.jEa,fa.Owb))}G?
(this.$F.removeAt(l),l--,++f):c=!1}if(!c){(b=this.ccf?this.fP.eNf(b,this.h3a/100):this.fP.eNf(b))&&b.length!==this.$F.count&&(b=null);this.fP.UBa(!0);this.fP.$Ec();this.wh.FX(new dC(a,this.$F.count,this.h3a,this.ccf,b,this.WPh,this.VPh,this.tYh,this.vPh,this.pzc,this.zYh,this.FOh));for(b=0;b<a;b++){c=this.Iyf.ga(b);this.wh.EX(new cC(this.hyc[b],new Wm(c.ZT,c.Wv,c.N4,c.cultureName,c.hha)));for(c=0;c<this.$F.count;c++){f=this.$F.ga(c)[b];var wa=!!this.pzc&&""!==this.pzc&&"Custom"!==this.pzc;l=f?f.colSpan:
0;x=f?f.rowSpan:0;G=f?f.width:0;R=f?f.height:0;fa=f?f.gEc:0;const Wa=f?f.jEa:!1,mb=f&&(65536&fa||!wa)?f.zlc:"",Kb=f?f.verticalAlignment:0,nc=f?f.Owb:!1;wa=f?this.fP.N$i(f.x5,c,b,this.$F,wa,f.gEc):new ZB;const oc=f?f.ald:new $B,Ic=f?f.Qkj:null;this.wh.BX(new cz(l,x,G,R,mb,Kb,wa,oc,Wa,nc,fa,new Wm(Ic?Ic.ZT:null,Ic?Ic.Wv:null,Ic?Ic.N4:null,Ic?Ic.cultureName:null,Ic?Ic.hha:null)));f&&!f.Owb&&(f.contents.qhd(),f.contents.flush(),this.fP.UBa(!1),this.fP.$Ec(),f.contents.ofd());this.wh.AX()}this.wh.DX()}this.wh.CX();
this.fP.currentState.j5b=!1;this.fP.O1f(!1)}}}Object(e.a)(WH,"NormalizedTable",mx,[]);class nC{constructor(a=!1,b=!1){this.sQh=a;this.QH=b}get WJj(){return this.sQh}get uU(){return this.QH}}Object(e.a)(nC,"HtmlNormalizerSettings",null,[528]);class Lr extends lC{constructor(a,b=null){super(a);this.currentState=null;this.RDb=new ix;this.olb=b||new nC}reset(){super.reset();this.currentState=new hz(this);this.RDb.clear();this.FC=!1}get MF(){return this.currentState&&this.currentState.oUb?this.currentState.table:
this.currentState}IJc(a=!1){this.currentState.qUc||(this.$Ec(),this.wh.fA(this.currentState.mSd),this.currentState.qUc=!0,this.currentState.j5b=!1);a||!this.currentState.$qb||this.currentState.pUc||(this.wh.Jva(this.currentState.$qb,this.currentState.kSd),this.currentState.pUc=!0)}PZb(){this.currentState.pUc&&(this.wh.Iva(),this.currentState.pUc=!1)}sOi(){this.currentState.qUc&&(this.wh.eA(),this.currentState.qUc=!1,this.currentState.Rfc="")}O1f(a){this.currentState.u6b&&(this.currentState.j5b?a||
(this.wh.fA(null),this.wh.eA(),this.wh.mma(),this.currentState.u6b=!1):(this.wh.mma(),this.currentState.u6b=!1,this.currentState.j5b=!0))}UBa(a){this.PZb();this.sOi();this.O1f(a)}Qsk(a){this.wh.nma(new jx(2,1,a));this.currentState.Ydc++;this.currentState.Qce=!0}$Ec(){!this.currentState.u6b&&this.currentState.Qce&&(this.wh.lma(),this.currentState.Ydc--,this.currentState.Qce=!1)}FCe(a,b){a=this.Dhk(a);if(""!==a)if(this.IJc(),this.currentState.fVc)this.GCe(a,b);else{a=a.split(Lr.qji);for(let c=0;c<a.length-
1;c++)this.GCe(a[c],b),this.wh.SWa(b);this.GCe(a[a.length-1],b)}}kCe(a,b){""!==a&&(this.IJc(),this.wh.Ova(a,b))}fCe(a){this.olb.uU||this.PZb();this.IJc(!0);this.wh.kma(a)}eCe(a){this.currentState.oUb||this.wh.ima(a)}uhc(a){this.currentState.$qb&&(a.href=this.currentState.$qb);super.uhc(a)}$Be(a,b){this.PZb();this.currentState.$qb=a;this.currentState.kSd=b}ZBe(){this.PZb();this.currentState.$qb=null;this.currentState.kSd=null}pCe(a){this.currentState.mSd=a;this.UBa(!0)}oCe(){this.currentState.mSd=
null;this.UBa(!0)}rCe(){this.currentState.fVc=!0}qCe(){this.currentState.fVc=!1}jCe(a){this.UBa(!1);this.$Ec();this.wh.nma(a);this.currentState.Ydc++}gCe(){this.UBa(!1);this.wh.lma();this.currentState.Ydc--}iCe(a){this.UBa(!1);this.currentState.Ydc||this.Qsk(a);this.wh.Nva(a);this.currentState.u6b=!0;this.currentState.j5b=!0}hCe(){this.UBa(!1)}FX(a){this.currentState.oUb||(this.FC=!0,this.currentState.table=new WH(this,a))}ECe(){}CX(){if(this.currentState.table){var a=this.currentState.table;this.currentState.table=
null;this.RDb.isEmpty?(this.FC=!1,a.B6f()):this.MF.bF(Object(C.a)(a,a.B6f,"flushTable"))}}BCe(){}EX(a){this.currentState.oUb&&this.currentState.table.TBk(a)}DCe(){}DX(){}CCe(){}BX(a){let b=!1;if(this.currentState.oUb){const c=new hz(this);this.currentState.table.tHd(a,new Xt(a.ZT.Rmg,a.ZT.u3b),a.Wv,a.N4,a.cultureName,a.hha,c)?(this.RDb.push(this.currentState),this.currentState=c):b=!0}else b=!0;b&&this.currentState.lve++}ACe(){}AX(){0<this.currentState.lve?this.currentState.lve--:this.currentState=
this.RDb.pop()}zCe(){}eNf(a,b=1){if(!a)return null;const c=a.length;if(!c)return null;const f=a[0].length;for(var l=1;l<c;l++)if(a[l].length!==f)return null;l=Array(f+1);l[0]=0;const x=Array(f+1);for(var G=0;G<x.length;G++)x[G]=!1;G=new Ha.a;for(let fa=0;fa<f;fa++){for(var R=0;R<c;R++)if(a[R][fa]&&0<a[R][fa].width){const wa=Math.min(fa+a[R][fa].colSpan,f);l[wa]=l[fa]+a[R][fa].width*(a[R][fa].jEa?b:1);x[wa]=!0}if(x[fa+1]){R=l[fa+1]-l[fa];if(0>=R)return null;G.add(R)}else l[fa+1]=l[fa]}return G.toArray()}tdk(a,
b){1&b||(a.borderTopStyle=12);16&b||(a.borderRightStyle=12);256&b||(a.borderBottomStyle=12);4096&b||(a.borderLeftStyle=12);return a}N$i(a,b,c,f,l,x){if(!a)return null;l&&(a=this.tdk(a,x));if(0>c||0>b||b>f.count-1)return a;0<=b-1&&c<=f.ga(b-1).length-1&&1===a.borderLeftStyle&&(l=f.ga(b-1)[c])&&1!==l.x5.borderRightStyle&&(a.borderLeftStyle=l.x5.borderRightStyle,a.borderLeftColor=l.x5.borderRightColor,a.borderLeftWidth=l.x5.borderRightWidth);0<=c-1&&c<=f.ga(b).length-1&&1===a.borderTopStyle&&(b=f.ga(b)[c-
1])&&1!==b.x5.borderBottomStyle&&(a.borderTopStyle=b.x5.borderBottomStyle,a.borderTopColor=b.x5.borderBottomColor,a.borderTopWidth=b.x5.borderBottomWidth);return a}Dhk(a){this.currentState.fVc||(a=this.olb.WJj?a.replace(Lr.vvj," "):a.replace(Lr.uvj," "));a.startsWith(" ")&&(this.currentState.Rfc.endsWith(" ")||""===this.currentState.Rfc)&&(a=Ka.a.substring(a,1,a.length));return a}GCe(a,b){""!==a&&(this.wh.g0(a,b),this.currentState.Rfc+=a)}}Lr.uvj=RegExp("[ \t\f\u200b\r\n]+","g");Lr.vvj=RegExp("[ \f\u200b\r\n]+",
"g");Lr.qji="\t";Object(e.a)(Lr,"DefaultHtmlNormalizer",lC,[]);class XH extends Lr{constructor(a,b,c){super(a,c);this.I6e=!1;this.P0a=b}uhc(a){this.P0a.Sad&&(u.AFrameworkApplication.mQ?this.I6e||(a=new Di.StandardDialog,a.yd=0,a.Ue(1,CommonUIStrings.l_DialogClose),a.nx(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this.I6e=!0):this.P0a.cek?this.P0a.BUg=!0:a.src&&""!==a.src?Ze.a.AS(a.src)===Ze.a.AS(window.location.href)?u.AFrameworkApplication.Ta.processAction(E.a.f6g,
2):a.src.startsWith("data:")&&19922944<a.src.length?u.AFrameworkApplication.Ta.processAction(E.a.d6g,2):a.src.startsWith("webkit-fake-url")?u.AFrameworkApplication.Ta.processAction(E.a.c6g,2):(H.a.instance.ga(1)?this.UBa(!1):H.a.instance.ga(11)&&(this.PZb(),this.IJc(!0)),this.wh.jma(a)):u.AFrameworkApplication.Ta.processAction(E.a.e6g,2))}}Object(e.a)(XH,"Box4HtmlNormalizer",Lr,[]);class YH{constructor(a,b,c,f,l,x,G,R,fa,wa){this.htmlProcessor=a;this.t7d=b;this.wGh=c;this.TWi=f;this.I0k=l;this.J0k=
x;this.rRc=G;this.ovj=R;this.qvj=fa;this.DVj=wa}}Object(e.a)(YH,"ExecutePasteArguments",null,[]);class ZH extends Fj{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){super(b,c,f,Wa);this.l6=null;this.Qga=a;this.Yqd=l;this.Lvd=x;this.bFd=G;this.LGd=R;this.tOb=fa;this.olb=Kb;this.eb=wa;this.i7e=Object.assign(new aC,{rTc:2===this.oh.MOa||3===this.oh.MOa});this.Wtd=mb;this.dSb=wa.ka("GatherMetadataAboutExternalPastedHTMLContentIsEnabled");this.QWh=wa.ka("ParseStyleFromRawHtmlHeadIsEnabled")}get d8c(){return!1}get pug(){return!Ka.a.inl(Ka.a.tvc,
this.Qga.innerText)}get xSf(){return this.Qga.innerText}P2f(a){this.l6=new nb.GraphIterator;this.Heb.restore(this.l6);Z.ULS.shipAssertTag(6305550,307,ae.OutlineElementReader.Ug(this.l6));this.oh.i0&&this.oh.i0.rCc("external");var b=this.oh.Iw&8192?1:0,c=this.Lvd.value.create(b,this.l6);const f=this.bFd.value.create(b,this.l6),l=Dm.a.x4d(u.AFrameworkApplication.userSessionId),x=Dm.a.r0d(r.a.Z3a,this.oh.MOd),G=Dm.a.wfg(u.AFrameworkApplication.userSessionId),R=Dm.a.xfg(u.AFrameworkApplication.userSessionId),
fa=this.dSb?this.Tzj():null,wa=Dm.a.Ibg(r.a.Z3a,this.oh.MOd),Wa=Dm.a.Jbg(u.AFrameworkApplication.userSessionId),mb=this.tOb.Gqh?Dm.a.Q8i(u.AFrameworkApplication.userSessionId):null;b=this.Yqd.value.create(b,this.l6,c,f,null,x);b=new TH(b,G,R);b=new XH(b,c,this.olb);b=new Ak(b,this.tOb,this.i7e,mb);b=new SH(b,wa,fa,this.eb);b=new Yq(b,Wa);c=new YH(b,c,l,x,G,R,fa,wa,Wa,mb);c=new hd.a(a,Object(C.a)(this,this.VBk,"preprocessStyle"),c);c.Fl("paste and request pictures");c.Xi=!a||a.Xi;c.run()}VBk(a){if(this.QWh){const b=
this.Qga.getElementsByTagName("style");if(b&&0<b.length){Z.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(let c=0;c<b.length;c++)this.Wtd.Cwi(this.Qga,b[c]),b[c]&&(b[c].parentNode.removeChild(b[c]),c--)}}a.Zg(Object(C.a)(this,this.Uwi,"convertWordListHtml"));return!0}Uwi(a,b){this.LGd.value.create(b.wGh).process(this.Qga,a);a.Zg(Object(C.a)(this,this.gDk,"processHtml"));return!0}gDk(a,b){b.htmlProcessor.process(this.Qga,a);b=b.t7d&&
b.t7d.Sad?Object(C.a)(this,this.mfd,"requestImages"):Object(C.a)(this,this.c1f,"endPasteOperation");a.Zg(b);return!0}mfd(a,b){if(b=b.t7d){let c=!1,f=!1,l=!1,x=!1,G=-1;const R=new D.DictionaryPropertySet,fa=RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(Object(Ma.a)(10,this.oh.kd)){c=this.oh.kd.sa(Mb.a.wae,!1);const wa=this.oh.kd.sa(Oc.a.bU,"");l=this.oh.kd.sa(Oc.a.kUc,!1);x=this.oh.kd.sa(tb.a.vN,!1);fa.test(wa)&&(f=!0);this.Iqh&&(G=this.oh.kd.sa(As.a.oZb,-1))}else this.oh.Iw&256&&this.Qga&&
(c=!0,fa.test(this.Qga.innerHTML)&&(f=!0));R.setValue(Mb.a.wae,c);R.setValue(Oc.a.NRj,f);R.setValue(Oc.a.kUc,l);R.setValue(As.a.oZb,G);R.setValue(tb.a.vN,x);b.OXg&&(this.oh.g5b=!0,this.oh.I7d=b.ZHc,this.oh.Xve=b.OXg,u.AFrameworkApplication.Ta.processAction(E.a.mfd,2))}a.Zg(Object(C.a)(this,this.c1f,"endPasteOperation"));return!0}c1f(a,b){Dm.a.I_j(b.wGh);Dm.a.LYj(b.qvj);Dm.a.WZj(b.I0k);Dm.a.XZj(b.J0k);Dm.a.dZj(b.DVj);a="Others";b.rRc&&(b.rRc.IYj(),b.rRc.JYj(),a=b.rRc.oPe);Dm.a.KYj(b.ovj,a);Dm.a.zYj(b.TWi,
a);return!1}Tzj(){const a=new RH;a.kEb=r.a.Z3a;this.oh&&(a.Iw=this.oh.Iw,a.ize=this.oh.MOd,this.oh.kd&&(a.JCe=this.oh.kd.sa(Oc.a.b6g,"")));this.Qga&&this.Qga.innerHTML&&(a.a6g=this.Qga.innerHTML.length);u.AFrameworkApplication.$c&&(a.platform=u.AFrameworkApplication.$c.Platform);return a}get Vqh(){return!0}get Uqh(){Z.ULS.shipAssertTag(6305551,307,!!this.l6);if(this.tOb.Hqh(this.i7e)){let a=!1;ae.OutlineElementReader.Ug(this.l6)&&(this.l6.o2b(),a=!0);const b=yb.ParagraphReader.Rk(this.l6)&&!this.l6.currentNode.sa(Oc.a.gvg,
!1);a&&this.l6.yc();return b}return yb.ParagraphReader.Rk(this.l6)}}Object(e.a)(ZH,"ExternalPasteExecutionManager",Fj,[]);class $H{constructor(a,b,c,f,l,x,G,R){this.Yqd=a;this.Lvd=b;this.bFd=c;this.LGd=f;this.tOb=l;this.eb=x;this.Wtd=G;this.olb=R}create(a,b,c,f){return new ZH(a,b,c,f,this.Yqd,this.Lvd,this.bFd,this.LGd,this.tOb,this.eb,Cb.App.Hb.Hd,this.Wtd,this.olb)}}Object(e.a)($H,"Factory",null,[383]);class iz{constructor(a){this.tja=a.C7i();this.M7a=a.ANc("intCopy");this.jad=a.Z1d("intCopy");
this.s4a=a.yMc("intCopy");this.eOa=a.lMc("intCopy")}static TV(){return iz.mr()}static mr(){return new iz(yg.a.instance)}}Object(e.a)(iz,"InternalCopyUsageHelper",null,[]);class nx{constructor(a,b,c){this.HM=iz.TV();this.BEc=null;this.Zid=this.lod=!1;this.n4e=null;this.source=a;this.target=b;this.Ize=c}get O5(){return this.HM}get CK(){return this.n4e}set CK(a){this.n4e=a}}Object(e.a)(nx,"InternalCopyArguments",null,[]);class aI extends nx{constructor(a,b,c,f){super(a,b,{});this.KGb=[];for(a=0;a<c.length;a++)Array.addRange(this.KGb,
c.ga(a).toArray());this.Jqa=0;this.plj=f}}Object(e.a)(aI,"BasicInternalCopyArguments",nx,[]);class bI extends Sys.EventArgs{constructor(a){super();this.CK=a}}Object(e.a)(bI,"BeforePasteArguments",Sys.EventArgs,[]);class jz extends nx{constructor(a,b){super(a.source,a.target,a.Ize);this.oh=a;this.insertAfter=b}get O5(){return this.oh.O5}get CK(){return this.oh.CK}set CK(a){this.oh.CK=a}}Object(e.a)(jz,"CoreInternalCopyArguments",nx,[]);class kz{constructor(a,b,c,f,l=null){this.source=a;this.target=
b;this.insertAfter=c;this.W$c=f;this.CK=l||{}}}Object(e.a)(kz,"CoreInternalPasteArguments",null,[]);class cI{constructor(a,b,c,f,l,x,G,R,fa){this.pJb=a;this.source=b;this.target=c;this.W$c=f;this.rowIndex=l;this.Rha=x;this.Q5g=R;this.Ef=fa}}Object(e.a)(cI,"CoreInternalTablePasteArguments",null,[]);class lz extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.operation=a;this.clone=f;this.CK=l}}Object(e.a)(lz,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var Zq=d(202);class oi{static fr(){oi.tGb=
new Vb.a;oi.tGb.$(88,!0);oi.tGb.$(4,!0)}static Nra(a,b,c){const f=[];if(H.a.instance.ga(104)&&a.vl&&rd.SelectionFactory.MQj(a))a=nb.GraphIterator.mb(a.kb.hg.Ua.node),a.pc(14),c=Mc.a.create(a.origin),c=oi.GCc(c,!0,!0,null),a.set(c),cb.SelectionEditor.kt(a),oi.sQa(a,f);else for(let wa=0;wa<a.length&&!(c&&0<f.length);++wa){var l=a.ga(wa),x=oi.uNc(l,!0),G=oi.uNc(l,!1);if(!x||!G)continue;if(x===G&&x.contextId===Bb.a.Of){l=nb.GraphIterator.mb(x.node);l.pc(11)&&oi.sQa(l,f);continue}var R=void 0;R=l=null;
var fa=-1;let Wa;if(x.node===G.node)Wa=x.node,G=G.node;else{R=oi.B8f(x.node);l=oi.B8f(G.node);for(fa=0;fa<R.length&&fa<l.length&&R[fa]===l[fa];++fa);R=R[fa-1];--fa;Wa=oi.GCc(x,!0,!1,R);G=oi.GCc(G,!1,!0,R)}if(Wa===G)l=Wa===x.node?x:Mc.a.create(Wa),l=oi.GCc(l,!0,!0,null),x=new tn.a,x.set(l),cb.SelectionEditor.kt(x),oi.sQa(x,f);else{x=new tn.a;x.set(Wa);cb.SelectionEditor.kt(x);Wa===R&&x.Ji();for(oi.sQa(x,f);x.parentNode!==R;){for(;x.yp();)oi.sQa(x,f);x.yc()}if(G===R)for(;x.yp();)oi.sQa(x,f);else{x.yp();
for(R=fa+1;R<l.length;++R){for(;x.currentNode!==l[R];)oi.sQa(x,f),x.yp();if(G===l[R])break;x.Ji()}oi.sQa(x,f)}}}if(0>=f.length)return null;if(b)for(b=new nb.GraphIterator,a=0;a<f.length;++a)b.set(f[a].node),Xb.OutlineElementNavigator.ri(b),f[a]=Mc.a.create(b.currentNode);return Fa.a.WOa(f)}static uNc(a,b){if(b)for(b=0;b<a.length;++b){if(a.ga(b).Qk)return a.ga(b);if(a.ga(b).Rw){var c=a.ga(b);for(var f=0;f<c.length;++f)if(c.getContext(f).Qk)return c.getContext(f)}}else for(b=a.length-1;0<=b;--b){if(a.ga(b).Qk)return a.ga(b);
if(a.ga(b).Rw)for(c=a.ga(b),f=c.length-1;0<=f;--f)if(c.getContext(f).Qk)return c.getContext(f)}return null}static sQa(a,b){oi.Sxg(a)?oi.pTi(a,b):oi.tGb.Jb(a.role)||(a=a.Dw(11),!a||b.length&&b[b.length-1].node===a||Array.add(b,Mc.a.create(a)))}static B8f(a){const b=[],c=new nb.GraphIterator;c.set(a);cb.SelectionEditor.kt(c);for(Array.add(b,a);c.yc();)Array.add(b,c.currentNode);b.reverse();return b}static GCc(a,b,c,f){let l=a.node;if(cb.SelectionEditor.Vj(a)&&(b&&0<a.Qa||c&&a.Kb<yb.ParagraphReader.textLength(l))||
cb.SelectionEditor.Ll(a)&&b&&0<yb.ParagraphReader.textLength(l))return l;a=new tn.a;a.set(l);for(cb.SelectionEditor.kt(a);!a.Vq;){l=a.currentNode;if(f===l||b&&!oi.rIj(a)||c&&!oi.zKj(a))return l;a.yc()}return a.currentNode}static zKj(a){let b=!0;if(a.yp())for(b=!1;oi.tGb.Jb(a.role)||H.a.instance.ga(77)&&16===a.oi&&Se.isGhostCell(a);)if(!a.yp()){b=!0;break}return b}static rIj(a){const b=a.currentNode;let c=!0;if(a.gDa())for(c=!1;oi.tGb.Jb(a.role);)if(!a.gDa()){c=!0;break}a.yc();a.Gk(b);return c}static pTi(a,
b){a=Xe.a.Xu(a);for(a.Sl(oi.eTi,null);a.moveNext();)ae.OutlineElementReader.k8(a.currentNode)&&Array.add(b,Mc.a.create(a.currentNode))}static eTi(a){return oi.Sxg(a)}static Sxg(a){return a.Vq||1===a.role||27===a.role}}oi.tGb=null;Object(e.a)(oi,"OutlineElementGeneralizer",null,[]);oi.fr();class dI{constructor(){this.controlCell=this.Vo=null;this.colSpan=this.rowSpan=0;this.response=2}}Object(e.a)(dI,"ComplexCellData",null,[]);var ox=d(174);class oC{constructor(a){this.Km=a;a.fXj()}dispose(){this.Km.jul()}static mb(a){return new oC(a.Mj)}}
Object(e.a)(oC,"TempGraphAlgorithmLock",null,[106]);class Jh{constructor(a,b,c){this.C2e=this.NH=null;this.Swc=[];this.nsc=[];this.jzc=[];this.qMb={};this.qAd={};this.tqd={};this.gD=null;this.M2a=Jh.qij(a);this.M2a.ydk();this.VYh=oC.mb(this.M2a);Jh.ykb=this;this.C6=1;this.Ksd=b;this.g0a=c}get Hq(){return this.gD||(this.gD=fb.a.instance.resolve("Box4.ITableEditor"))}get iJ(){return this.NH||(this.NH=fb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}normalize(){if(!(0<--this.C6)){var a=new Id.GraphTransaction(7);
a.gd(this.M2a);this.vEk();this.xek();this.UUi();H.a.instance.ga(63)&&this.Hoi();this.WUi();a.dispose();this.f2()}}T7k(a){this.C2e=a}WUi(){var a=nb.GraphIterator.mb(this.M2a);if(!a.iDa()){const b=this.iJ.GXb(a);Jh.hB.eZ(a,!0);a=Cb.App.Hb.Hd.nn;a.$o&&Jh.hB.Lhd(b,a.i2b())}}cancel(){if(!(0<--this.C6)){var a=ox.a.Gz(this.M2a);for(a.Sl(Jh.JZe,null);a.moveNext();)a.iterator.Vq||a.iterator.wY(16,!1);this.f2()}}f2(){this.M2a.kul();this.VYh.dispose();Jh.ykb=null}Kna(a){a.Qk?(Jh.IRj(a)&&Array.add(this.Swc,a.node),
this.kzh(a.node)):a.Rw&&this.Fpl(a)}Fpl(a){for(let b=0;b<a.length;++b)this.Kna(a.getContext(b))}kzh(a){a.anchor.KS(16)}xek(){for(let b=0;b<this.Swc.length;++b){var a=this.Swc[b];if(!a.anchor||a.anchor.wI)continue;const c=new nb.GraphIterator;c.set(a);if(!cb.SelectionEditor.kt(c))continue;Xb.OutlineElementNavigator.Ke(c);if(this.g0a.Wki(c)){Jh.Nh.FBa(c);continue}a=new tn.a;a.Pc(c);if(!Xb.OutlineElementNavigator.eJ(a,!1,!1))continue;if(36===a.role)continue;Xb.OutlineElementNavigator.ri(a);if(a.currentNode.iW)continue;
if(Jd.TableReader.Vp(a))continue;Xb.OutlineElementNavigator.Ke(a);const f=new nb.GraphIterator;f.Pc(a);f.yc();Jh.Nh.merge(c,a,!1,!1);ae.OutlineElementReader.vI(f)&&!f.iDa()&&a.Ii()}Array.clear(this.Swc)}Hoi(){for(let a=0;a<this.jzc.length;++a){const b=this.jzc[a];if(!b.anchor||b.anchor.wI)continue;if(Se.isGhostCellNode(b))continue;const c=new nb.GraphIterator;c.set(b);c.HA(1);c.Ab(2);Jd.TableReader.Vp(c)&&(c.yc(),Jh.Nh.xca(c,!1,!0,null))}Array.clear(this.jzc)}x1i(a){const b=a.id.toString();if(this.qMb[b])return this.qMb[b];
const c=Array(Jd.TableReader.wi(a));for(let f=0;f<Jd.TableReader.wi(a);++f)c[f]=0;this.qMb[b]=c;this.qAd[b]=Jd.TableReader.jk(a);return c}vEk(){const a=ox.a.Gz(this.M2a);a.Sl(Jh.JZe,null);var b=a.moveNext();const c=new nb.GraphIterator;let f=0;for(;b;)if(a.iterator.Vq)this.uoi(a.iterator),b=a.moveNext();else if(this.g0a.IMj(a.iterator)&&Array.add(this.nsc,a.iterator.currentNode),H.a.instance.ga(63)&&Se.isTableCell(a.iterator)&&Array.add(this.jzc,a.iterator.currentNode),Jh.cli(a.iterator))switch(a.iterator.oi){case 16:b=
Qd.getContainingTable(a.iterator);if(this.Ksd&&!Jd.TableReader.vu(b)&&!Se.isGhostCell(a.iterator)){b=this.x1i(b);var l=Nn.a(a.iterator);++b[l]}b=a.moveNext();break;case 15:b=Qd.getContainingTable(a.iterator);this.Ksd&&!Jd.TableReader.vu(b)?(this.tqd[b.id.toString()]=!0,c.Pc(a.iterator),b=a.moveNext(),this.Hq.LHc(c)):b=a.moveNext();break;case 14:a.iterator.currentNode!==this.C2e?(a.moveNext(),c.Pc(a.iterator),b=a.moveNext(),Jh.Nh.FBa(c)):(a.iterator.wY(16,!1),b=a.moveNext());break;case 23:c.Pc(a.iterator);
b=a.moveNext();c.Ii();break;case 11:f++;Tf.b(a.iterator)?(a.iterator.wY(16,!1),b=a.moveNext()):(c.Pc(a.iterator),Ib.ListReader.kk(c)&&!this.g0a.dNe(c,f)&&Jh.jo.Pma(c),c.pI(2)?this.g0a.Hal(c,f)?b=a.moveNext():(c.Pc(a.iterator),b=a.moveNext(),Jh.Nh.FBa(c)):(b=a.moveNext(),Jh.Nh.FBa(c)));break;case 12:b=a.moveNext();break;default:b=a.moveNext()}else{l=!0;if(Jd.TableReader.Vp(a.iterator)&&this.Ksd){var x=a.currentNode;let G=x.id.toString();const R=this.qMb[G];let fa=!1;if(R){const wa=this.qAd[G];for(x=
Jd.TableReader.wi(x)-1;0<=x;--x)R[x]===wa&&(this.Hq.JHc(a.iterator,x),fa=!0)}Jd.TableReader.wi(a.iterator.currentNode)?H.a.instance.ga(30)&&(fa||this.tqd[G])&&Jd.TableReader.kce(a.iterator.currentNode)&&(c.Pc(a.iterator),Qd.moveToFirstRow(c),Qd.moveToFirstColumn(c),b=a.moveNext(),Jh.Nh.Bgh(a.iterator,c)):(a.moveNext(),c.Pc(a.iterator),b=a.moveNext(),c.Ii(),l=!1)}l&&(a.iterator.wY(16,!1),b=a.moveNext())}this.qMb={};this.qAd={};this.tqd={}}uoi(a){if(a.Ji()){do a.wY(16,!1);while(a.fDa())}}UUi(){for(let b=
0;b<this.nsc.length;++b){var a=this.nsc[b];if(a.anchor&&!a.anchor.wI){const c=new nb.GraphIterator;c.set(a);Vh.OutlineNavigator.T9(c)||(c.currentNode.setValue(tb.a.iE,Tm.a.first),H.a.instance.ga(41)&&10===c.oi&&(a=Jh.Nh.O8d(c,null,1),c.Gk(a)),Jh.hB.eZ(c,!0))}}Array.clear(this.nsc)}static get jo(){return Jh.Po||(Jh.Po=fb.a.instance.resolve("Box4.List.IListEditor"))}static get hB(){return Jh.Cx||(Jh.Cx=fb.a.instance.resolve("Box4.IOutlineEditor"))}static get Nh(){return Jh.Ai||(Jh.Ai=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get vH(){return qj.a.instance}static get Yi(){return ed.a.instance}static kOc(a,
b){Jh.ykb?Jh.ykb.C6++:Jh.ykb=new Jh(a,b,fb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"));return Jh.ykb}static qij(a){a=nb.GraphIterator.mb(a);cb.SelectionEditor.kt(a);a.qGb(b=>b.r6b);return a.currentNode}static IRj(a){let b=!1;cb.SelectionEditor.Ll(a)&&(b=!H.a.instance.ga(14)||!Jh.Yi.NTc(a));!b&&yb.ParagraphReader.im(a)&&(b=!H.a.instance.ga(14)||!Jh.Yi.QUc(a)&&!a.node.sa(Mb.a.z9a,!1));return b}static cli(a){switch(a.oi){case 12:return a.currentNode.TDc}if(!a.Ji())return Jh.vH.tAg(a)?
Jh.vH.hNd(a.currentNode):!0;let b=!0;do{switch(a.role){case 2:case 1:case 3:case 86:case 87:a.fW&16||16===a.oi&&Se.isGhostCell(a)||(b=!1)}a.wY(16,!0)}while(a.fDa());b&&Jh.vH.tAg(a)&&(b=Jh.vH.hNd(a.currentNode));return b}static Vki(a){return a.Vq||!!(a.fW&16)}}Jh.JZe=Jh.Vki;Jh.ykb=null;Jh.Pa=new ic.a;Jh.Cx=null;Jh.Po=null;Jh.Ai=null;Object(e.a)(Jh,"GraphStructureNormalizer",null,[]);class Yt{constructor(){this.AIb=this.Vo=this.DC=null;this.Jdb=0;this.response=2}}Object(e.a)(Yt,"TableGeneralizeData",
null,[]);class bi{static get Yl(){return Df.ContextSetEditor.instance}static Q4(a,b,c,f,l,x,G){let R=!1;x&&x[bi.aLb]&&x[bi.aLb]&&(R=!0);if(!b.view.Lh)return 2;const fa=b.view;var wa=fa.Gb;if(1===c){if(!wa||!wa.Oa.kb)return 8;b=0===G?b.fE:bi.Yl.a0b(b.fE,G,!0);return u.AFrameworkApplication.Ta.ki(b,a,c,!0,f,l)}x&&x[bi.Xna]&&Me.a.mark(x[bi.Xna]);const Wa=zl.SelectionReferenceFactory.instance.Oqa(),mb=wa.Oa.kb.Ua;wa=new Id.GraphTransaction(15);wa.gd(mb.node);wa.Xwa();b=0===G?b.fE:bi.Yl.a0b(b.fE,G);a=
u.AFrameworkApplication.Ta.ki(b,a,c,!0,f,l);32===a&&Wa.hU(R);v.FocusManager.instance().Bf(fa.eI);wa.dispose();Cb.App.Hb.updateCommandUI();x&&x[bi.Wna]&&Me.a.mark(x[bi.Wna]);return a}static yeb(a,b,c,f,l,x){var G=qd.a.instance;let R,fa=!1;x&&x[bi.aLb]&&x[bi.aLb]&&(fa=!0);if(1===c)return G&&G.Oa.kb?(R=oi.Nra(G.Oa,!1,!0))?u.AFrameworkApplication.Ta.ki(R,a,c,!0,f,l):8:8;x&&x[bi.Xna]&&Me.a.mark(x[bi.Xna]);const wa=zl.SelectionReferenceFactory.instance.Oqa(),Wa=G.Oa.kb.Ua;R=oi.Nra(G.Oa,!1);if(!R)return 8;
G=new Id.GraphTransaction(15);G.gd(Wa.node);G.Xwa();a=u.AFrameworkApplication.Ta.ki(R,a,c,!0,f,l);32===a&&wa.hU(fa);(b=b.view)&&v.FocusManager.instance().Bf(b.eI);G.dispose();Cb.App.Hb.updateCommandUI();x&&x[bi.Wna]&&Me.a.mark(x[bi.Wna]);return a}}bi.Xna="PerfMarkStart";bi.Wna="PerfMarkEnd";bi.aLb="CollapseIp";Object(e.a)(bi,"ViewActionHandler",null,[]);var eI=d(551);class fI{constructor(){this.controlCell=null;this.TQf=this.Xih=0;this.V5f=this.W5f=null}}Object(e.a)(fI,"MergedCellInfo",null,[]);var px=
d(311),gI=d(662),EP=d(707),On=d(357);class yv extends ul.a{constructor(a){super(0,0,0);this.c7=a;this.cLa=Array(a)}A1i(a){return this.cLa[a]}Dmh(a,b){this.cLa[a]=b}copy(){const a=new yv(this.c7);for(let b=0;b<this.c7;++b)a.cLa[b]=this.cLa[b];return a}Fek(){let a=On.a.cib;for(let b=0;b<this.c7;++b)a+=this.cLa[b]+1;return a}static pri(a,b){const c=new yv(a.c7);for(let f=0;f<c.c7;f++)c.cLa[f]=Math.max(a.cLa[f],b.cLa[f]);return c}}Object(e.a)(yv,"TableRowViewSizeConstraints",ul.a,[]);class Zt extends tl.a{constructor(a,
b,c,f,l,x=null){super(a,b,c);this.G_a=null;this.jsd=0;this.grc=-1;this.Yc=f;this.Xc=l;this.kc(this.Gd.Wo(la.a.tr));this.htmlElement.className="TableRow";Ca.d(this.htmlElement,Da.a.role,"row");this.ogh();this.Q2e=x}oy(){this.$a.h5g=[];this.htmlElement.style.height=this.Vih;this.ogh()}ogh(){this.Yc&&this.Yc.NDa(65)&&(this.$a.cXb?Sys.UI.DomElement.addCssClass(this.htmlElement,Tb.c3):Sys.UI.DomElement.removeCssClass(this.htmlElement,Tb.c3))}d3k(a){const b=this.grc!==a;this.grc=a;return b}jyl(){this.htmlElement.style.height=
this.Wih+"px"}get Wih(){let a=0>=this.grc?Zt.sVg:this.grc;this.$a.Sa(Mb.a.au)&&(a=Math.max(a,this.Gd.Fd.Ie(this.$a.getValue(Mb.a.au),1)));return a}get Vih(){return this.$a.Sa(Mb.a.au)?this.Gd.Fd.Ie(this.$a.getValue(Mb.a.au),1)+"px":"auto"}eU(a){super.eU(a);var b=Jd.TableReader.wi(Qd.getContainingTable(a));let c=0;b=new yv(b);if(a.Ab(1)){do b.Dmh(c,a.Mq.rJa.total),c++;while(a.zj(1))}return b}HJ(a){super.HJ(a);this.$Q.UT(this.htmlElement)}get author(){return this.G_a}QUe(a){let b=!0;if(this.Oc.$o&&
this.Oc.LEj){a=Xe.a.Xu(a);for(var c={};a.moveNext();){if(!ae.OutlineElementReader.Ug(a.iterator)||ae.OutlineElementReader.l6d(a.iterator))continue;const f=ae.OutlineElementReader.jMc(a.currentNode,tb.a.VUb);f&&(c[f]="")}a=ta.a.join(c,Box4Intl.Box4Strings.l_UserInitialsDelimeter,"");c=Sys.UI.DomElement.getBounds(this.htmlElement);0<c.height&&(this.G_a=a,this.jsd=c.height,b=!1)}b&&(this.G_a="",this.jsd=-1)}get aQd(){return this.jsd}tTk(){this.Q2e&&this.Q2e.WGl(this)}}Zt.sVg=20;Object(e.a)(Zt,"TableRowViewElement",
tl.a,[516]);class Kh{constructor(a,b){Kh.Cx=a;Kh.Ai=b}VVk(a){const b=a.ild.currentNode;this.Fwl(b);let c=this.zxi(b);var f=this.qhj(b,c);let l=f.length;a.QHc=this.bUi(f);a.OHc=this.sTi(f);f=a.QHc.toArray().length;const x=a.OHc.toArray().length;if(0<f||0<x)l-=f,c-=x,this.Syl(a);this.wHb(Object(ua.a)(lg.a,b),l);this.gHb(Object(ua.a)(lg.a,b),c);this.yVk(a)}sTi(a){const b=new Ha.a;for(let c=0;c<a[0].length;c++){let f=!0;for(let l=0;l<a.length;l++)if(1===a[l][c]){f=!1;break}f&&b.add(c)}return b}bUi(a){const b=
new Ha.a;for(let c=0;c<a.length;c++){let f=!0;for(let l=0;l<a[c].length;l++)if(1===a[c][l]){f=!1;break}f&&b.add(c)}return b}zxi(a){let b=0;a=nb.GraphIterator.mb(a);Qd.moveToFirstRow(Object(ua.a)(nb.GraphIterator,a));Qd.moveToFirstColumn(Object(ua.a)(nb.GraphIterator,a));let c=Object(ua.a)(128,a.pq),f=!1;for(;c;)!c.isGhostCell||Se.isSkippedCell(Object(ua.a)(lg.a,c))?(b+=c.W7a?c.colSpan:1,f=!0):f||b++,c=Object(ua.a)(128,Qd.moveToNextColumn(Object(ua.a)(nb.GraphIterator,a)));return b}Syl(a){const b=
nb.GraphIterator.mb(a.ild.pq);let c=0;Qd.moveToFirstRow(Object(ua.a)(nb.GraphIterator,b));var f=b.pq;const l=Re.a.Ff(Zt.sVg,1);for(;f;){for(;a.QHc.contains(c);)c++;var x=1,G=a.Cmc?a.Cmc.rowIndex:0,R=a.ouh[G+c];for(R<l&&(R=l);a.QHc.contains(c+x);){var fa=a.ouh[G+c+x];fa<l&&(fa=l);R+=fa;x++}f.setValue(Mb.a.au,R);f=x-1;x=0;Qd.moveToFirstColumn(Object(ua.a)(nb.GraphIterator,b));for(G=Object(ua.a)(128,b.pq);G;){R=G.W7a?G.colSpan:1;if(!G.isGhostCell||1<R){0<f&&(G.rowSpan-=f,1>G.rowSpan&&(G.rowSpan=1));
fa=0;for(let wa=1;wa<R;wa++)a.OHc.contains(x+wa)&&fa++;0<fa&&(G.colSpan-=fa,1>G.colSpan&&(G.colSpan=1))}x+=R;G=Object(ua.a)(128,Qd.moveToNextColumn(Object(ua.a)(nb.GraphIterator,b)))}c++;Qd.moveToFirstColumn(Object(ua.a)(nb.GraphIterator,b));b.yc();f=Qd.moveToNextRow(Object(ua.a)(nb.GraphIterator,b))}}Fwl(a){const b=new Ha.a;a=nb.GraphIterator.mb(a);Qd.moveToFirstRow(Object(ua.a)(nb.GraphIterator,a));for(var c=a.pq;c;){c=!1;let l=0;Qd.moveToFirstColumn(Object(ua.a)(nb.GraphIterator,a));for(var f=
Object(ua.a)(px.TableCellNode,a.currentNode);f;){if(f.isGhostCell)f.W7a?(c=!0,b.contains(l)||(f.isGhostCell=!1,f.pOd())):Se.isSkippedCell(Object(ua.a)(lg.a,f))||b.contains(l)&&(c||H.a.instance.ga(77))||(f.isGhostCell=!1,f.pOd());else{c=!0;f=f.W7a?f.colSpan:1;for(let x=0;x<f;x++)b.contains(l+x)||b.add(l+x)}l++;f=Object(ua.a)(px.TableCellNode,Qd.moveToNextColumn(Object(ua.a)(nb.GraphIterator,a)))}Qd.moveToFirstColumn(Object(ua.a)(nb.GraphIterator,a));a.yc();c=Qd.moveToNextRow(Object(ua.a)(nb.GraphIterator,
a))}}qhj(a,b){const c=[];let f=0;a=nb.GraphIterator.mb(a);Qd.moveToFirstRow(Object(ua.a)(nb.GraphIterator,a));for(var l=a.pq;l;){l=0;Qd.moveToFirstColumn(Object(ua.a)(nb.GraphIterator,a));for(var x=Object(ua.a)(128,a.pq);x;){if(!x.isGhostCell||Se.isSkippedCell(Object(ua.a)(lg.a,x))){const G=x.W7a?x.colSpan:1;for(x=x.g6d?x.rowSpan:1;f<c.length&&2===c[f][l];)l++,(l%=b)||f++;for(let R=0;R<x;R++){const fa=f+R;fa===c.length&&Array.add(c,Array(b));for(let wa=0;wa<G;wa++)c[fa][l+wa]=0<R||0<wa?2:1}l+=G}x=
Object(ua.a)(128,Qd.moveToNextColumn(Object(ua.a)(nb.GraphIterator,a)))}Qd.moveToFirstColumn(Object(ua.a)(nb.GraphIterator,a));a.yc();l=Qd.moveToNextRow(Object(ua.a)(nb.GraphIterator,a));f++}return c}yVk(a){if(Jd.TableReader.Vp(a.ild)&&a.Cmc&&a.muh){var b=Object(ua.a)(134,a.ild.pq),c=a.muh,f=Array(b.c7),l=a.Cmc.Rha;for(let x=0;x<f.length;x++)for(f[x]=c[l],l++;a.OHc.contains(l-a.Cmc.Rha);)f[x]+=c[l],l++;b.FOa=f}}jya(a){if(H.a.instance.ga(77)||H.a.instance.ga(63))Qd.forEachCellInTable(a,b=>{b.currentNode.gHa=
null;return!0}),Qd.forEachCellInTable(a,b=>{const c=b.currentNode;if(!c.isGhostCell){const f=c.rowSpan,l=c.colSpan;1<f||1<l?this.OAi(b,f,l):c.pHe()}return!0})}OAi(a,b,c){const f=a.currentNode,l=new nb.GraphIterator;l.Pc(a);Qd.forEachCell(l,b,c,(x,G,R)=>{const fa=x.currentNode;if(fa!==f){fa.isGhostCell=!0;let Wa=!1;var wa=!0;const mb=Kh.qe;mb&&(Wa=mb.isFeatureEnabled(136),mb.h$a(136));do{x.Ab(1);if(Object(Ma.a)(eI.a,x.currentNode)){if((wa=wa&&ae.OutlineElementReader.isEmpty(x,!1))||!Wa)wa=nb.GraphIterator.mb(x.pq),
wa.pc(16),wa=!wa.vf(1);wa||a.pl(x.currentNode,1);x.Ii()}wa=!1}while(Wa&&x.pI(1))}fa.gHa=Object.assign(new fI,{controlCell:f,Xih:G,TQf:R});1!==G||R||(f.gHa.V5f=fa);G||1!==R||(f.gHa.W5f=fa);fa.pHe();R||(fa.colSpan=c)});f.rowSpan=b;f.colSpan=c}F8d(a){const b=new nb.GraphIterator;b.Pc(a);Qd.returnToContainingRow(b);var c=b.currentNode;b.Ab(1);const f=new nb.GraphIterator;f.Pc(a);Qd.returnToContainingTable(f);a=f.currentNode;this.jya(f);const l=ps.a.instance.createInstance(393251);this.e4b(f,l,c,c,!1);
f.Gk(l);c=Jd.TableReader.wi(a);for(let x=0;x<c;++x){const G=b.currentNode,R=this.Rqa();this.LTb(f,R,G,!1,!0);if(!R.isGhostCell)if(G.isGhostCell){let fa;(fa=G.gHa.controlCell).rowSpan=fa.rowSpan+1}else G.rowSpan=2;b.vf(1)}this.wHb(a,Jd.TableReader.jk(a)+1);Qd.returnToContainingTable(f);this.jya(f);return l}E8d(a){const b=nb.GraphIterator.mb(a.ZEh());let c=Jd.TableReader.wi(b.currentNode);a=Nn.a(a);const f=a+1;this.jya(b);b.Ab(1);do{const x=b.Rp(a,1);b.yc();const G=this.Rqa();this.W3b(b,G,x,!1,!1);
if(!G.isGhostCell)if(x.isGhostCell){var l=void 0;(l=x.gHa.controlCell).colSpan=l.colSpan+1}else x.colSpan=2}while(b.zj(1));this.jya(b);(l=b.currentNode.sa(tb.a.Iu,null))&&(l=Qa.a.clone(l));this.gHb(b.currentNode,++c);l&&(Array.insert(l,f,l[a]),b.currentNode.setValue(tb.a.Iu,l));this.Iec(b.currentNode,f,!1,1,null)}Ced(a,b){Jd.TableReader.vu(a.currentNode)&&H.a.instance.ga(63)&&this.beh(a,c=>this.C6i(c,b),(c,f)=>{c.me(Mb.a.au,f)},Mb.a.complexTable)}ooj(a,b,c,f){let l=b;const x=b.gHa;H.a.instance.ga(77)&&
(a.isGhostCell=!1);if(x)if(Kh.mOc(x,!f))a.isGhostCell=!0;else{const G=Kh.Vsb(x.controlCell,f);!b.isGhostCell&&c||!c&&Kh.mOc(x,f)===G-1?(l=x.controlCell,!f&&l.g6d&&(a.rowSpan=l.rowSpan)):(a.isGhostCell=!0,Kh.Dgb(x.controlCell,f,G+1));f&&l.W7a&&(a.colSpan=l.colSpan)}return l}Zmj(a,b,c){var f=a.gHa;if(f)if(a.isGhostCell)this.Vnj(f,b);else if(f=Kh.Vsb(a,b),1<f){const l=Kh.Vsb(a,!b),x=new nb.GraphIterator;x.set(a);x.pc(14);a=new nb.GraphIterator;a.Pc(x);const G=b?Qd.moveToNextRow(a):a.vf(1);Kh.Dgb(G,b,
f-1);Kh.Dgb(G,!b,l);c(a,x)}}Vnj(a,b){Kh.mOc(a,!b)||Kh.Dgb(a.controlCell,b,Kh.Vsb(a.controlCell,b)-1)}DKb(a,b){let c=!1;Qd.forEachCellInTable(a,f=>Se.isGhostCell(f)?(c=!0,!1):!0);a.currentNode.me(b,c)}beh(a,b,c,f){var l=Jd.TableReader.jk(a.currentNode);const x=Jd.TableReader.wi(a.currentNode);if(l&&x){var G=!1,R=!1,fa=Array(l);Qd.forEachCellInTable(a,(nc,oc,Ic)=>{Ic||(fa[oc]=Array(x));nc=nc.currentNode;nc.isGhostCell?Se.isSkippedCell(nc)?fa[oc][Ic]=2:fa[oc][Ic]=1:fa[oc][Ic]=0;return!0});var wa=Array(l),
Wa=Array(l);for(var mb=0;mb<l;mb++){var Kb=!!mb;let nc=!0;for(let oc=0;oc<x;oc++)if(fa[mb][oc])1===fa[mb][oc]?nc=!1:mb&&2===fa[mb-1][oc]||(Kb=!1);else{nc=Kb=!1;break}wa[mb]=Kb;Wa[mb]=nc}for(--l;0<=l;l--)Wa[l]?(a.Rp(l,1),this.LHc(a),Array.removeAt(fa,l),G=!0):wa[l]&&b&&(a.Rp(l,1),G=a.j1b(1),mb=b(a.currentNode),Kb=b(G),c(G,mb+Kb),this.LHc(a),Array.removeAt(fa,l),G=!0);l=fa.length;if(0<l){wa=Array(x);Wa=Array(x);for(b=0;b<x;b++){c=!!b;mb=!0;for(Kb=0;Kb<l;Kb++)if(fa[Kb][b])1===fa[Kb][b]?mb=!1:b&&2===
fa[Kb][b-1]||(c=!1);else{mb=c=!1;break}wa[b]=c;Wa[b]=mb}b=a.currentNode.sa(tb.a.Iu,null);c=!1;if(b)for(c=!0,b=Array.clone(b),l=0;l<b.length;l++)if(!b[l]){c=!1;break}for(l=x-1;0<=l;l--)Wa[l]?(b&&Array.removeAt(b,l),this.JHc(a,l),R=!0):wa[l]&&c&&(b[l-1]+=b[l],Array.removeAt(b,l),this.JHc(a,l),R=!0);R&&b&&a.currentNode.setValue(tb.a.Iu,b)}(G||R)&&this.DKb(a,f)}}C6i(a,b){let c=gk.b(a);c||(a=a.oc(b))&&(c=we.a.mH(a.htmlElement.offsetHeight));return c}wHb(a,b){Jd.TableReader.jk(a)!==b&&a.properties.setValue(tb.a.Lxa,
b)}gHb(a,b){const c=Jd.TableReader.wi(a);c!==b&&(b&&c&&a.properties.Un(tb.a.Iu,tb.a.vZa),a.properties.setValue(tb.a.ufa,b))}g7(a,b,c,f=null,l=!1,x=!1){a=this.EVf(a);H.a.instance.ga(71);this.I5f(a,b,c,f,l,x);H.a.instance.ga(71);return a}EVf(a){H.a.instance.ga(63)&&Jd.TableReader.hs(a)&&Qd.getContainingTable(a);const b=ps.a.instance.createInstance(393250);a.pl(b,2);a.Gk(b);return b}CLk(a,b,c,f,l){a=this.EVf(a);H.a.instance.ga(71);this.I5f(a,b,c,f,!1,l);Z.ULS.sendTraceTag(50373653,324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",
a.id.toString(),b,c));return a}I5f(a,b,c,f=null,l=!1,x=!1){const G=nb.GraphIterator.mb(a);this.lVf(G,b,c,f,l);this.wHb(a,b);this.gHb(a,c);H.a.instance.ga(63);a.setValue(tb.a.bib,!x)}lVf(a,b,c,f=null,l=!1){for(var x=0;x<b;++x){var G=new EP.a;a.pl(G,1);H.a.instance.ga(55)&&G.setValue(Mb.a.Vn,De.a.xXa())}b=null;x=!0;a.Ab(1);do for(G=0;G<c;++G){const R=this.Rqa();a.pl(R,1);({Qkh:b,isFirst:x}=this.H5f(a,R,l,f,b,x));Qd.returnToContainingRow(a)}while(a.zj(1))}H5f(a,b,c,f,l,x){a.Gk(b);l&&c?Kh.Ai.gqi(a,l):
(Kh.Cx.eZ(a,!0,f),!x&&c&&(l=new nb.GraphIterator,l.Pc(a)),x=!1);return{Qkh:l,isFirst:x}}T8d(a,b,c,f){const l=new nb.GraphIterator;l.Pc(a);var x=l.currentNode;l.Ab(1);let G=gk.c(a);if(b)var R=a.lF(1);else R=a.currentNode,G++;const fa=a.yc();H.a.instance.ga(63);this.jya(a);let wa=null,Wa=null;for(var mb=0;mb<c;++mb){var Kb=ps.a.instance.createInstance(393251);Wa||(Wa=Kb);wa=Kb;this.e4b(a,Kb,R,x,b)}x=Jd.TableReader.wi(a.currentNode);R=!0;do{R?(a.Gk(wa),R=!1):a.vf(1);for(mb=0;mb<x;++mb){Kb=this.Rqa();
const nc=this.LTb(a,Kb,l.currentNode,b,!0);this.iHf(a,Kb,f(nc));l.vf(1)}l.aja(1)}while(a.currentNode!==Wa);this.wHb(fa,Jd.TableReader.jk(fa)+c);this.Nxe(fa,b,G,c)}LHc(a){const b=gk.c(a);var c=b+1;a.yc();H.a.instance.ga(63);this.jya(a);for(--c;c>=b;--c){a.Rp(c,1);let f=a.Ab(1);for(;f;)this.Owe(f,!0),f=a.zj(1);a.Ii()}this.wHb(a.currentNode,Jd.TableReader.jk(a.currentNode)-1);this.hxe(a,b,1)}fpg(a,b,c,f,l){H.a.instance.ga(63);this.jya(a);let x=Jd.TableReader.wi(a.currentNode);-1===b&&(b=x);const G=c?
b:b-1;a.Ab(1);do{const R=a.Rp(G,1);a.yc();for(let fa=0;fa<f;++fa){const wa=this.Rqa(),Wa=this.W3b(a,wa,R,c,!1);this.iHf(a,wa,l(Wa))}}while(a.zj(1));this.oKk(a,x+f,f,b,c);this.Iec(a.currentNode,b,c,f,l)}oKk(a,b,c,f,l){let x=a.currentNode.sa(tb.a.vZa,null),G=a.currentNode.sa(tb.a.Iu,null);x&&(x=Qa.a.clone(x));G&&(G=Qa.a.clone(G));this.gHb(a.currentNode,b);if(H.a.instance.ga(30)&&x){const R=Array(b);let fa=0;for(;fa<f;++fa)R[fa]=x[fa];for(;fa<f+c;++fa)R[fa]=!1;for(;fa<b;++fa)R[fa]=x[fa-c];a.currentNode.setValue(tb.a.vZa,
R)}G&&(b=this.vGf(a,G,b,f,l,c),a.currentNode.setValue(tb.a.Iu,b))}vGf(a,b,c,f,l,x){a=Array(c);let G=l=0;for(;l<f;++l)a[l]=b[l],G+=a[l];for(;l<c;++l)a[l]=0>l-x?b[0]:b[l-x],G+=a[l];if(H.a.instance.ga(63)&&0<G)for(b=0/G,l=0;l<c;++l)a[l]=Math.max(Re.a.Ff(On.a.dld,0),a[l]*b);return a}Iec(){}Nxe(){}e4b(a,b,c){a.gSc(b,c,1,Kh.B0a?Kh.B0a():null)}W3b(a,b,c,f){a.Gk(c);f=f?a.j1b(1):c;a.yc();a.gSc(b,f,1,Kh.B0a?Kh.B0a():null);return c}LTb(a,b,c){a.QCf(b,1,Kh.B0a?Kh.B0a():null);return c}iHf(a,b,c){Se.isGhostCellNode(b)||
(a.Gk(b),Kh.Cx.eZ(a,!0,c),Qd.returnToContainingRow(a))}JHc(a,b){H.a.instance.ga(63);this.jya(a);let c=Jd.TableReader.wi(a.currentNode);-1===b&&(b=c-1);a.Ab(1);do for(let f=b+1-1;f>=b;--f)a.Rp(f,1),this.Owe(a.currentNode,!1),a.Ii();while(a.zj(1));this.nKk(a,c-1,b);this.gxe(a,b,1)}nKk(a,b,c){var f=a.currentNode.sa(tb.a.vZa,null);let l=a.currentNode.sa(tb.a.Iu,null);f&&(f=Qa.a.clone(f));l&&(l=Qa.a.clone(l));this.gHb(a.currentNode,b);if(f){var x=Array(b);let G=0;for(;G<c;++G)x[G]=f[G];for(;G<b;++G)x[G]=
f[G+1];a.currentNode.setValue(tb.a.vZa,x)}if(l){f=Array(b);for(x=0;x<c;++x)f[x]=l[x];for(;x<b;++x)f[x]=l[x+1];a.currentNode.setValue(tb.a.Iu,f)}}lWa(){}Owe(){}hxe(){}gxe(){}DGi(a){const b=Nn.a(a);a.yc();a.yc();this.JHc(a,b)}Rqa(){const a=ps.a.instance.createInstance(393252);a.setValue(tb.a.iE,Tm.a.first);(new EF.OutlineIndentInfo(!0)).pkh(a);return a}$L(a,b){a.setValue(tb.a.xl,b);a.setValue(tb.a.EI,b)}JPf(){}vYa(a,b,c){const f=Jd.TableReader.wi(a);let l=a.sa(tb.a.vZa,null);l=l?Qa.a.clone(l):Array(f);
let x=a.sa(tb.a.Iu,null);x=x?Qa.a.clone(x):Array(f);l[b]=!0;x[b]=c;a.setValue(tb.a.Iu,x);a.setValue(tb.a.vZa,l)}static get ih(){return Kh.Hf||(Kh.Hf=fb.a.instance.resolve("Box4.IFormattingEditor"))}static get qe(){return Kh.Yc||(Kh.Yc=fb.a.instance.qb("Box4.IFeatureHelper"))}static Ndg(a,b=!0){const c=new gI.a;if(a){let f=null;a=rd.SelectionFactory.rj(a,b);if(!a)Z.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");else for(b=0;b<a.length;b++)if(vb.a.kSf(a.ga(b))){f=a.ga(b);break}f&&(a=
vb.a.Ls(f),a.cache.Qs&&(a=a.Ud(null),Kh.ih.pJ(a)),c.formatting=a.em,c.languageId=vb.a.language(a),H.a.instance.ga(71)&&(c.style=Uc.StyleReader.BD(f.node)))}return c}static Dgb(a,b,c){b?a.rowSpan=c:a.colSpan=c}static Vsb(a,b){return b?a.rowSpan:a.colSpan}static mOc(a,b){return b?a.Xih:a.TQf}static G5i(a,b){return b?a.W5f:a.V5f}static Xoi(a,b,c){let f=a.sa(tb.a.Iu,null);f=f?Qa.a.clone(f):Array(c);f[b]=0;a.setValue(tb.a.Iu,f)}}Kh.Hf=null;Kh.Yc=null;Kh.Cx=null;Kh.Ai=null;Kh.B0a=null;Object(e.a)(Kh,"TableEditor",
null,[483]);class $q{constructor(a){this.dkb=this.gP=0;cb.SelectionEditor.Uw(a)||(a=cb.SelectionEditor.Hl(a,!0,!1));a=a.Ua;const b=new nb.GraphIterator;b.set(a.node);cb.SelectionEditor.kt(b);cb.SelectionEditor.Pg(a)&&(this.gP=a.Qa,this.dkb=a.hS);cb.SelectionEditor.Z7(a)&&b.Rg(12);this.ohf=new lx(b)}restore(){var a=new nb.GraphIterator;this.ohf.Sl(Object(C.a)(this,this.o0k,"selectableFilter"),null);var b=new fz.a;const c=new fz.a;this.ohf.hih(a,c,b);if(yb.ParagraphReader.Xr(a.currentNode)){if(!c.value&&
b.value)return rd.SelectionFactory.rj(a.currentNode,!1);b=Mc.a.ak(a.currentNode,this.gP);-1!==this.dkb&&(a=yb.ParagraphReader.EQa(a.currentNode,this.gP),0<this.dkb&&this.dkb<=a&&(b.hS=this.dkb,b.vqa=this.dkb));return rd.SelectionFactory.nu(b)}return a.currentNode.MA?cb.SelectionEditor.Hl(rd.SelectionFactory.gl(a.currentNode),!b.value,!1):(a=cb.SelectionEditor.yia(a,!b.value))?yb.ParagraphReader.Xr(a)?rd.SelectionFactory.Mg(a,b.value?yb.ParagraphReader.textLength(a):0):rd.SelectionFactory.gl(a):null}o0k(a){return a.currentNode.lEa||
a.currentNode.xI}}Object(e.a)($q,"IpReference",null,[]);class hI{constructor(){this.tableNode=null;this.columns=this.rows=0;this.yOj=!1}}Object(e.a)(hI,"TableActionData",null,[]);var FP=d(181);class Bs{constructor(){this.W_b=!1}}Object(e.a)(Bs,"TrackChangeDeletionActionData",null,[]);class Dc{static get fba(){return Dc.Ou||(Dc.Ou=fb.a.instance.qb("Box4.IAutoCorrectScheduler"))}static get PL(){return Dc.gG||(Dc.gG=fb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get lll(){return Dc.Dyf||
(Dc.Dyf=fb.a.instance.qb("Box4.UI.TableAltTextDialogFactory"))}static get NGi(){return Dc.W0e||(Dc.W0e=fb.a.instance.resolve("Box4.Actors.IDeleteTableSegmentStrategy"))}static Sq(){return Dc.xm||(Dc.xm=fb.a.instance.Ka("Box4.IExternalSelectionManager"))}static get Etb(){return Dc.D0a||(Dc.D0a=a=>Kh.Ndg(a))}static set Etb(a){Dc.D0a=a}static get w2d(){return Dc.Kud||(Dc.Kud=Dc.Bcj)}static set w2d(a){Dc.Kud=a}static get t2d(){return Dc.Hud||(Dc.Hud=Dc.vcj)}static set t2d(a){Dc.Hud=a}static get u2d(){return Dc.Iud||
(Dc.Iud=Dc.xcj)}static set u2d(a){Dc.Iud=a}static get v2d(){return Dc.Jud||(Dc.Jud=Dc.zcj)}static set v2d(a){Dc.Jud=a}static get x2d(){return Dc.Lud||(Dc.Lud=Dc.Dcj)}static set x2d(a){Dc.Lud=a}static get K4d(){return Dc.Nud||(Dc.Nud=Dc.glj)}static set K4d(a){Dc.Nud=a}static get I2d(){return Dc.Mud||(Dc.Mud=Dc.odj)}static set I2d(a){Dc.Mud=a}static get Ewb(){return Dc.nxd||(Dc.nxd=Dc.EOj)}static set Ewb(a){Dc.nxd=a}static get qe(){return Dc.Yc||(Dc.Yc=fb.a.instance.qb("Box4.IFeatureHelper"))}static get ih(){return Dc.Hf||
(Dc.Hf=fb.a.instance.resolve("Box4.IFormattingEditor"))}static get Qf(){return Dc.Xc||(Dc.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get H5(){return Dc.Ro||(Dc.Ro=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get KNd(){return Dc.aLa||(Dc.aLa=fb.a.instance.resolve("Box4.CatchUpActivity.IChangeIdEditor"))}static get vH(){return qj.a.instance}static get Yi(){return ed.a.instance}static get Tf(){return Dc.Sg||(Dc.Sg=
fb.a.instance.resolve("Box4.List.IListReader"))}static get jo(){return Dc.Po||(Dc.Po=fb.a.instance.resolve("Box4.List.IListEditor"))}static get Nh(){return Dc.Ai||(Dc.Ai=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Yl(){return Dc.aga||(Dc.aga=Df.ContextSetEditor.instance)}static set Yl(a){Dc.aga=a}static get Tc(){return rb.a.instance}static get Hq(){return Dc.gD||(Dc.gD=fb.a.instance.resolve("Box4.ITableEditor"))}static get nv(){null==Dc.sA&&(Dc.sA=u.AFrameworkApplication.fa.ka("UnblockComplexTableIsEnabled")&&
!H.a.instance.ga(30));return Dc.sA}static ub(a){const b=x=>oi.Nra(x.Oa,!1),c=(x,G,R,fa,wa)=>{const Wa=Cb.App.VJa.aUf(b);wa[Dc.bWf]={};return Wa(x,G,R,fa,wa)};Dc.dzj();const f=u.AFrameworkApplication.Ta;a=a.bUf();f.ya(E.a.g7,Bb.a.view,Dc.EDi);f.ya(E.a.g7,Bb.a.Of,Dc.g7);f.he(E.a.g7,1028);f.ya(E.a.BDa,Bb.a.view,Dc.S8d);f.ya(E.a.BDa,Bb.a.tableRow,Dc.insertRow);f.he(E.a.BDa,1028);f.ya(E.a.C8a,Bb.a.view,Dc.S8d);f.ya(E.a.C8a,Bb.a.tableRow,Dc.insertRow);f.he(E.a.C8a,1028);f.ya(E.a.aSa,Bb.a.view,Dc.X3b);f.ya(E.a.aSa,
Bb.a.tableCell,Dc.C8d);f.he(E.a.aSa,4);f.ya(E.a.jSc,Bb.a.view,Dc.X3b);f.he(E.a.jSc,4);f.ya(E.a.z8a,Bb.a.view,Dc.X3b);f.ya(E.a.z8a,Bb.a.tableCell,Dc.C8d);f.he(E.a.z8a,4);f.ya(E.a.iSc,Bb.a.view,Dc.X3b);f.he(E.a.iSc,4);f.ya(E.a.zBa,Bb.a.view,Dc.QXf);f.ya(E.a.zBa,Bb.a.tableCell,Dc.zBa);f.he(E.a.zBa,4);f.ya(E.a.deleteRow,Bb.a.view,Dc.QXf);f.ya(E.a.deleteRow,Bb.a.tableRow,Dc.deleteRow);f.he(E.a.deleteRow,1028);f.ya(E.a.Fba,Bb.a.view,Dc.OGi);f.ya(E.a.Fba,Bb.a.table,Dc.Fba);f.he(E.a.Fba,1028);f.ya(E.a.E4a,
Bb.a.table,Dc.E4a);f.ya(E.a.E4a,Bb.a.view,a);f.he(E.a.E4a,4);f.ya(E.a.insertTable,Bb.a.view,Dc.lCj);f.ya(E.a.insertTable,Bb.a.Of,Dc.insertTable);f.he(E.a.insertTable,1036);f.ya(E.a.lWa,Bb.a.view,Dc.Aek);f.ya(E.a.lWa,Bb.a.tableCell,Dc.lWa);f.he(E.a.lWa,4);f.ya(E.a.MIb,Bb.a.view,Dc.dil);f.ya(E.a.MIb,Bb.a.tableCell,Dc.MIb);f.he(E.a.MIb,4);f.pa(E.a.PFk,Bb.a.view,xr.a.m0,96);f.pa(E.a.RFk,Bb.a.view,xr.a.m0,96);f.ya(E.a.Wll,Bb.a.view,xr.a.GG);f.ya(E.a.jml,Bb.a.view,xr.a.GG);f.ya(E.a.zSc,Bb.a.view,Dc.zSc);
f.he(E.a.zSc,1124);f.ya(E.a.ZIc,Bb.a.view,Dc.ZIc);f.he(E.a.ZIc,100);f.ya(E.a.Ckc,Bb.a.view,Dc.Ckc);f.ya(E.a.Jgd,Bb.a.view,Dc.j0k);f.ya(E.a.iJe,Bb.a.view,Dc.iJe);f.ya(E.a.hJe,Bb.a.view,Dc.hJe);f.ya(E.a.coc,Bb.a.view,a);f.ya(E.a.coc,Bb.a.table,Dc.coc);f.he(E.a.coc,4);f.ya(E.a.Dhc,Bb.a.view,a);f.ya(E.a.Dhc,Bb.a.table,Dc.Dhc);f.he(E.a.Dhc,96);H.a.instance.ga(30)&&(f.ya(E.a.bZa,Bb.a.view,Dc.X3b),f.ya(E.a.bZa,Bb.a.Of,Dc.C8d),f.he(E.a.bZa,4),f.ya(E.a.Emc,Bb.a.Of,Dc.insertRow),f.ya(E.a.Emc,Bb.a.view,Dc.S8d),
f.he(E.a.Emc,4));f.ya(E.a.kFb,Bb.a.view,Dc.kFb);H.a.instance.ga(63)?f.he(E.a.kFb,96):f.he(E.a.kFb,1124);a=[E.a.gBg,E.a.eBg,E.a.iBg,E.a.fBg,E.a.jBg,E.a.hBg,E.a.dBg,E.a.AWc,E.a.zWc,E.a.BWc,E.a.xWc,E.a.wWc,E.a.yWc,E.a.tWc,E.a.sWc,E.a.uWc];for(var l of a)f.ya(l,Bb.a.view,Dc.Gia),f.ya(l,Bb.a.tableCell,Dc.abi),f.he(l,4);l=[E.a.pDe,E.a.oDe,E.a.qDe,E.a.mDe,E.a.lDe,E.a.nDe,E.a.jDe,E.a.iDe,E.a.kDe];for(const x of l)f.ya(x,Bb.a.view,c),f.ya(x,Bb.a.paragraph,Dc.LEk),f.he(x,68)}static dzj(){Dc.VC.$(E.a.jBg,Dc.VC.$(E.a.AWc,
Dc.VC.$(E.a.zWc,Dc.VC.$(E.a.BWc,Dc.VC.$(E.a.pDe,Dc.VC.$(E.a.oDe,Dc.VC.$(E.a.qDe,Dc.Vyh)))))));Dc.VC.$(E.a.hBg,Dc.VC.$(E.a.xWc,Dc.VC.$(E.a.wWc,Dc.VC.$(E.a.yWc,Dc.VC.$(E.a.mDe,Dc.VC.$(E.a.lDe,Dc.VC.$(E.a.nDe,Dc.hfk)))))));Dc.VC.$(E.a.dBg,Dc.VC.$(E.a.tWc,Dc.VC.$(E.a.sWc,Dc.VC.$(E.a.uWc,Dc.VC.$(E.a.jDe,Dc.VC.$(E.a.iDe,Dc.VC.$(E.a.kDe,Dc.Sei)))))));Dc.wB.$(E.a.gBg,Dc.wB.$(E.a.AWc,Dc.wB.$(E.a.xWc,Dc.wB.$(E.a.tWc,Dc.wB.$(E.a.pDe,Dc.wB.$(E.a.mDe,Dc.wB.$(E.a.jDe,1)))))));Dc.wB.$(E.a.eBg,Dc.wB.$(E.a.zWc,Dc.wB.$(E.a.wWc,
Dc.wB.$(E.a.sWc,Dc.wB.$(E.a.oDe,Dc.wB.$(E.a.lDe,Dc.wB.$(E.a.iDe,2)))))));Dc.wB.$(E.a.iBg,Dc.wB.$(E.a.BWc,Dc.wB.$(E.a.yWc,Dc.wB.$(E.a.uWc,Dc.wB.$(E.a.qDe,Dc.wB.$(E.a.nDe,Dc.wB.$(E.a.kDe,3)))))));Dc.wB.$(E.a.fBg,6)}static ZIc(a,b,c){if(1===c)return 32;if(!b.view.Lh)return 2;a=b.view;if(!a.Gb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$la}),8;a=a.Gb.Kj;a=Dc.Yl.Y1(a,14);if(!a)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.zra}),8;Dc.lll.create(a);return 32}static Ckc(a,b,c){Me.a.mark(5756);if(!b.view.Lh)return 2;
const f=b.view;if(!f.Gb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$la}),8;a=f.Gb.Kj;a=Dc.Yl.Y1(a,14);if(!a)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.zra}),8;if(2===c){let l=null;b=a.node;c=Jd.TableReader.vu(b);const x=Dc.nv;if(!H.a.instance.ga(104)||c&&!x)l=rd.SelectionFactory.gl(a.node);else if(H.a.instance.ga(77))c=rd.SelectionFactory.YGc(b,x),f.Gb.yHb(c,null);else{a=nb.GraphIterator.mb(b);a.Ab(1);for(b=[Zq.TableNodeContext.create(a.currentNode)];a.vf(1);)c&&gk.h(a)||Array.add(b,Zq.TableNodeContext.create(a.currentNode));
l=new Ua.Selection(b,!0)}l&&(c=new hd.a(null,G=>{f.Gb.setSelection(l,G);return!1},null),c.Fl("SelectTable"),c.run())}Me.a.mark(5757);return 32}static j0k(a,b,c){Me.a.mark(5752);if(!b.view.Lh)return 2;a=b.view;if(!a.Gb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$la}),8;b=a.Gb.Oa;if(!b)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),2;b=Dc.x2d(b);if(32!==b.response)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.zra}),b.response;if(2===c){var f=b.DC;b=c=f[0].node;var l=nb.GraphIterator.mb(c);l.pc(14);
let R=null;var x=Qd.getContainingTable(l);x=Jd.TableReader.vu(x);var G=Dc.nv;G=H.a.instance.ga(104)&&(!x||G);const fa=[];for(let wa=0;wa<f.length;++wa){const Wa=l.currentNode===f[wa].node;if(Wa||x&&gk.d(l))b=l.currentNode,!G||x&&gk.h(l)||Array.add(fa,Zq.TableNodeContext.create(l.currentNode)),Qd.moveToNextRow(l),Wa||--wa}f=a.Gb.Oa.kb;l=null;G?H.a.instance.ga(77)?(l=new nb.GraphIterator,G=new nb.GraphIterator,f.rf?(l.set(c),G.set(b)):(l.set(b),G.set(c)),l.pc(14),Qd.moveToFirstColumn(l),G.pc(14),Qd.moveToLastColumn(G),
l=x?rd.SelectionFactory.QXb(l,G):rd.SelectionFactory.CVf(l,G)):R=new Ua.Selection(fa,H.a.instance.ga(63)||f.rf):R=rd.SelectionFactory.oVf(c,b);R&&(l=new Ob.SelectionCollection([R],0));a.Gb.yHb(l,null)}Me.a.mark(5753);return 32}static iJe(a,b,c){Me.a.mark(5754);if(!b.view.Lh)return 2;a=b.view;if(!a.Gb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$la}),8;b=a.Gb.Oa;if(!b)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),2;b=Dc.v2d(b);if(32!==b.response)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.zra}),
b.response;if(2===c){c=[];var f=b.DC,l=new nb.GraphIterator;l.set(f[0].node);l.pc(14);b=Qd.getContainingTable(l);var x=Number.MAX_VALUE,G=0;if(f.length===Jd.TableReader.wi(Qd.getContainingTable(l)))G=null,H.a.instance.ga(104)&&(G=rd.SelectionFactory.YGc(b,Dc.nv))?c=G.toArray():(G=rd.SelectionFactory.gl(b),Array.add(c,G)),x=0,G=Jd.TableReader.wi(b)-1;else{for(l=0;l<f.length;++l){var R=nb.GraphIterator.mb(f[l].node);R.pc(14);R=Nn.a(R);x=Math.min(x,R);G=Math.max(G,R)}f=nb.GraphIterator.mb(b);Qd.moveToFirstRow(f);
Qd.moveToColumnByIndex(f,x);l=new nb.GraphIterator;l.Pc(f);Qd.moveToColumnByIndex(l,G);var fa;R=b.Ap();R=H.a.instance.ga(104)&&(!R||Dc.nv);do(fa=R?rd.SelectionFactory.WGc(f,l,!0,!0):rd.SelectionFactory.oVf(f.currentNode,l.currentNode))&&Array.add(c,fa),fa=!Qd.moveToNextRow(f),Qd.moveToNextRow(l);while(!fa)}f=nb.GraphIterator.mb(b);Qd.moveToCell(f,0,x);x=Jd.TableReader.jk(b);b=nb.GraphIterator.mb(b);Qd.moveToCell(b,x-1,G);c=new Ob.SelectionCollection(c,c.length-1,0,f,b);a.Gb.yHb(c,null)}Me.a.mark(5751);
return 32}static hJe(a,b,c){Me.a.mark(5750);if(!b.view.Lh)return 2;a=b.view;if(!a.Gb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$la}),8;b=a.Gb.Kj;if(!b)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),2;var f=Dc.Yl.uA(b);b={};for(var l=0;l<f.length;++l)if(f[l].Qk){var x=nb.GraphIterator.mb(f[l].node);x.af();if(!Se.isTableCellOrInside(x))return 8;Qd.returnToCell(x);b[x.currentNode.id.toString()]=x}if(2===c){if(H.a.instance.ga(104)){c=a.Gb.Oa;if(c.kb.hg)return Me.a.mark(5751),32;f=c.kb;x=f.rf?f.Ua:
f.Ve;l=f.rf?f.Ve:f.Ua;c=new nb.GraphIterator;c.set(x.node);c.af();x=new nb.GraphIterator;x.set(l.node);x.af();l=null;if((l=Qd.returnToLowestCommonTable(c,x))&&!l.Ap()){var G=cb.SelectionEditor.Hl(f,!0,!1);G=Zq.TableNodeContext.create(c.currentNode,G.Ua);G=rd.SelectionFactory.MXb(rd.SelectionFactory.nu(G));a.Gb.qE(G);Me.a.mark(5751);return 32}}c=[];for(G in b)f=rd.SelectionFactory.gl(b[G].currentNode),Array.add(c,f);0<c.length&&(G=new Ob.SelectionCollection(c,c.length-1),a.Gb.yHb(G,null))}Me.a.mark(5751);
return 32}static ehj(){return u.AFrameworkApplication.fa.ka("WacTableCellAlignmentIsEnabled")}static abi(a,b,c,f,l){f=Dc.f$h();if(1===c)return f?32:8;if(!(l&&f&&b&&b.node))return 2;b=b.node;if(Se.isGhostCellNode(b))return 32;Dc.VC.Jb(a)&&(c=Dc.VC.ga(a),b.me(Mb.a.eRe,c));Dc.wB.Jb(a)&&(a=Dc.wB.ga(a),Dc.WHf(b,a));return 32}static WHf(a,b){if(!Se.isGhostCellNode(a)&&(a=nb.GraphIterator.mb(a),Vh.OutlineNavigator.T9(a))){do if(a.Ab(2)){const c=a.currentNode;12===c.type?c.me(tb.a.xl,b):14===c.type?Jd.TableReader.h7f(c,
f=>{Dc.WHf(f,b)}):Z.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",FP.a[c.type]);a.yc()}while(a.yp())}}static LEk(a,b,c,f,l){if(!l)return 2;if(1===c)return 32;c=l[Dc.bWf];if(Dc.MPd in c&&!c[Dc.MPd])return 32;f=Dc.wB.ga(a);a=Dc.VC.ga(a);if(!b||!b.node)return 2;var x=b.node;b=yb.ParagraphReader.fN(x);x=nb.GraphIterator.mb(x);x.pc(16);x.Rg(16);x=x.currentNode.sa(Mb.a.eRe,Dc.Vyh);c[Dc.MPd]=l[ai.a.On]=f===b&&a===x;return 32}static OGi(a,b,c,f,l){if(!b.view.Lh)return 2;
a=b.view;if(!a.Gb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$la}),8;let x=a.Gb.Kj;x=Dc.Yl.Y1(x,14);if(!x)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.zra}),8;if(1===c)return u.AFrameworkApplication.Ta.ki(x,E.a.Fba,c,!0,f,l);Me.a.mark(7117);const G=new $q(cb.SelectionEditor.Hl(rd.SelectionFactory.nu(x),!0,!1)),R=new Id.GraphTransaction(15);try{R.gd(b.view.vg);const fa=Jh.kOc(x.node,!0);fa.Kna(x);const wa=Object(ua.a)(Bs,l)||new Bs;let Wa=u.AFrameworkApplication.Ta.ki(x,E.a.Fba,c,!0,f,Dc.Qf.ag?wa:l);const mb=
!Dc.Qf.ag||!Dc.Qf.By||wa.W_b;32===Wa&&2===c&&mb?(fa.normalize(),a.Gb.setSelection(G.restore()),v.FocusManager.instance().Bf(a.eI)):fa.cancel()}finally{R&&R.dispose()}Me.a.mark(7118);return 32}static EDi(a,b,c,f,l){Me.a.mark(4943);let x=null;2===c&&(x=new Id.GraphTransaction(15),x.gd(b.view.vg));a=u.AFrameworkApplication.Ta.ki(b.fE,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Lh)return 2;b=b.view;c=b.Gb.Kj;c=Dc.Yl.Y1(c,16);f=new nb.GraphIterator;f.set(c.node);f.pc(14);Qd.moveToNextOrPreviousCell(f,!1);
b.Gb.setSelection(rd.SelectionFactory.rj(f.currentNode,!0))}x&&x.dispose();Me.a.mark(4944);return a}static X3b(a,b,c,f){if(!b.view.Lh)return 2;var l=b.view;if(!l.Gb||!l.Gb.Oa.kb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),8;Me.a.mark(4945);var x=l.Gb.Kj;if(!x)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),8;l=a===E.a.aSa||a===E.a.bZa;var G=Dc.Yl.uA(x);if(!G||0>=G.length)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),8;G=G[0].node;if(!G)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),
8;l=Jd.TableReader.jm(G)?a===E.a.iSc||l:a===E.a.jSc||l;const R=Dc.t2d(x,l);if(32!==R.response)return R.response;x=R.Vo;G=Jd.TableReader.vu(x);const fa=a;let wa;wa=l?Object(ua.a)(168,R.DC[R.DC.length-1]):Object(ua.a)(168,R.DC[0]);a!==E.a.bZa&&(a=l?E.a.aSa:E.a.z8a);l=null;2===c&&(l=new Id.GraphTransaction(15),l.gd(b.view.vg));a=u.AFrameworkApplication.Ta.ki(wa,a,c,!0,f,R.Jdb);l&&l.dispose();2===c&&Z.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",
fa,E.a.Jz(fa)||"Unknown",H.a.instance.ga(77),G,a,x.id.toString(),Jd.TableReader.wi(x)));Me.a.mark(4946);return a}static S8d(a,b,c,f){if(!b.view.Lh)return 2;const l=a===E.a.Emc,x=a===E.a.C8a;Me.a.mark(4947);var G=b.view;if(!G.Gb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$la}),8;const R=G.Gb.Kj;if(!R)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),8;G=Dc.w2d(R,x);if(32!==G.response)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.zra}),G.response;const fa=Jd.TableReader.vu(G.Vo);let wa=null;2===c&&(wa=
new Id.GraphTransaction(15),wa.gd(b.view.vg));b=x?Object(ua.a)(168,G.DC[0]):Object(ua.a)(168,G.DC[G.DC.length-1]);f=u.AFrameworkApplication.Ta.ki(l?R:b,a,c,!1,f,G.Jdb);wa&&wa.dispose();2===c&&Z.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",a,E.a.Jz(a)||"Unknown",H.a.instance.ga(77),fa,f,G.Vo.id.toString(),Jd.TableReader.jk(G.Vo)));Me.a.mark(4948);return f}static YVg(a){for(Qd.moveToFirstColumn(a);Se.isGhostCell(a)&&
Qd.moveToPreviousRow(a););}static fgk(a){for(Qd.moveToFirstRow(a);Se.isGhostCell(a)&&Qd.moveToPreviousColumn(a););}static Aek(a,b,c,f){if(H.a.instance.ga(30)||!b.view.Lh)return 2;const l=b.view;if(!l.Gb||!l.Gb.Oa.kb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),8;const x=Dc.t9i(l.Gb.Kj);if(32!==x.response)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.zra}),x.response;let G=null,R=null;2===c&&(G=new $q(l.Gb.Oa.kb),G.restore(),R=new Id.GraphTransaction(15),R.gd(b.view.vg));a=u.AFrameworkApplication.Ta.ki(Mc.a.create(x.controlCell),
a,c,!1,f,x);2===c&&32===a&&(b=nb.GraphIterator.mb(x.Vo),b.af()&&Dc.Hq.Ced(b,l.Ma),G&&(l.Gb.setSelection(rd.SelectionFactory.rj(x.controlCell,!0)),v.FocusManager.instance().Bf(l.eI)));R&&R.dispose();2===c&&Z.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",a));return a}static t9i(a){const b=new dI;b.Vo=null;b.controlCell=null;if(!a)return b.response=8,b;var c=Dc.Yl.uA(a);if(1>=c.length)return b.response=2,b;const f=new Ha.a;a={};for(let R=0;R<c.length;++R)if(c[R].Qk){const fa=
nb.GraphIterator.mb(c[R].node);fa.af();if(!Se.isTableCellOrInside(fa))return b.response=8,b;var l=Object(ua.a)(se.AParagraphNode,fa.currentNode);if(l&&!l.sa(Mb.a.mae,!0))return b.response=8,b;Qd.returnToCell(fa);l=fa.currentNode;if(!f.contains(l.id.toString())){f.add(l.id.toString());var x=Qd.getContainingTable(fa),G=Qd.getContainingTableRow(fa).id.toString();if(b.Vo)if(b.Vo!==x)if(fa.BRa(b.Vo))continue;else if(nb.GraphIterator.mb(b.Vo).N$(x))a={},b.Vo=x,b.controlCell=l,a[G]=l.colSpan;else return b.response=
8,b;else a[G]=G in a?a[G]+l.colSpan:l.colSpan;else a={},b.Vo=x,b.controlCell=l,a[G]=l.colSpan;for(x=1;x<l.rowSpan;x++)Qd.moveToNextRow(fa),G=Qd.getContainingTableRow(fa).id.toString(),a[G]=G in a?a[G]+l.colSpan:l.colSpan}}if(!b.controlCell)return b.response=2,b;c=Object.keys(a);b.rowSpan=c.length;b.colSpan=a[c[0]];for(const R of c)if(b.colSpan!==a[R])return b.response=2,b;b.response=32;return b}static dil(a,b,c,f,l){if(H.a.instance.ga(30)||!b.view.Lh)return 2;const x=b.view;if(!x.Gb||!x.Gb.Oa.kb)return Dc.Tc.Tb(Nd.a.vh,
{["Reason"]:Od.a.noSelection}),8;if(cb.SelectionEditor.Uw(x.Gb.Oa.kb))var G=x.Gb.Oa.kb.Ua.node;else{G=x.Gb.Kj;if(!G)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.zra}),8;G=Dc.Yl.uA(G);if(1!==G.length||!Object(Ma.a)(Mc.a,G[0]))return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.pSf}),8;G=G[0].node}G=nb.GraphIterator.mb(G);G.af();if(!Se.isInTableCell(G))return 2;Qd.returnToContainingCell(G);G=G.currentNode;let R=null,fa=null;2===c&&(R=new $q(x.Gb.Oa.kb),R.restore(),fa=new Id.GraphTransaction(15),fa.gd(b.view.vg));
b=Mc.a.create(G);a=u.AFrameworkApplication.Ta.ki(b,a,c,!1,f,l);2===c&&32===a&&R&&(x.Gb.setSelection(rd.SelectionFactory.rj(G,!0)),v.FocusManager.instance().Bf(x.eI));fa&&fa.dispose();2===c&&Z.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",a));return a}static QXf(a,b,c,f,l){if(!b.view.Lh)return 2;const x=a===E.a.deleteRow;x?Me.a.mark(4951):Me.a.mark(4949);const G=b.view;if(!G.Gb||!G.Gb.Oa.kb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),8;var R=G.Gb.Kj;
const fa=Dc.I2d(R,x,G.Gb);if(32!==fa.response)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.zra}),fa.response;const wa=Jd.TableReader.vu(fa.Vo);var Wa=null,mb=null,Kb=null;let nc=!1;var oc=!1;2===c&&(Wa=new $q(G.Gb.Oa.kb),oc=Wa.restore(),Kb=nb.GraphIterator.mb(oc.Ua.node),Kb.pc(14),Qd.returnToContainingCell(Kb),oc=Se.isLastCellInRow(Kb),Qd.returnToContainingRow(Kb),nc=gk.j(Kb),mb=Jh.kOc(b.view.vg,!0),wa&&(R=Dc.NGi.C2f(R)),mb.Kna(R),Kb=new Id.GraphTransaction(15),Kb.gd(b.view.vg));b=Object(ua.a)(Bs,l)||
new Bs;f=u.AFrameworkApplication.Ta.ki(Fa.a.WOa(fa.DC),a,c,!1,f,Dc.Qf.ag&&x?b:l);R=!Dc.Qf.ag||!Dc.Qf.By||!x||b.W_b;b=l=!1;if(2===c&&32===f&&R){let Ic=nb.GraphIterator.mb(fa.Vo);Ic.af()&&Dc.Hq.Ced(Ic,G.Ma)}2===c&&32===f&&H.a.instance.ga(30)&&Jd.TableReader.kce(fa.Vo)&&R&&nb.GraphIterator.mb(fa.Vo).af()&&(Wa=x?new $q(rd.SelectionFactory.rj(fa.Vo,!nc)):new $q(rd.SelectionFactory.rj(fa.Vo,!oc)),G.Gb.setSelection(cb.SelectionEditor.Hl(rd.SelectionFactory.gl(fa.Vo),!1,!1)),u.AFrameworkApplication.Ta.processAction(E.a.E4a,
2),b=l=!0);if(32===f&&2===c&&R){if(!l&&0>=Jd.TableReader.wi(fa.Vo)||0>=Jd.TableReader.jk(fa.Vo))l=!0;mb.normalize();if(Wa){Wa=Wa.restore();if(l)Wa=b&&!x?rd.SelectionFactory.rj(Wa.Ua.node,!oc):rd.SelectionFactory.rj(Wa.Ua.node,!0);else if(mb=nb.GraphIterator.mb(Wa.Ua.node),mb.pc(14),x)Qd.returnToContainingRow(mb),nc&&!H.a.instance.ga(77)?(mb.af(),Xb.OutlineElementNavigator.Ke(mb),Dc.Nh.xca(mb,!1,!0)):Dc.YVg(mb),Wa=rd.SelectionFactory.rj(mb.currentNode,!0);else if(Qd.returnToCell(mb),oc&&H.a.instance.ga(30))Qd.moveToLastRow(mb),
Wa=rd.SelectionFactory.rj(mb.currentNode,!1);else if(H.a.instance.ga(63)||H.a.instance.ga(77))Dc.fgk(mb),Wa=rd.SelectionFactory.rj(mb.currentNode,!0);G.Gb.setSelection(Wa);v.FocusManager.instance().Bf(G.eI)}}else mb&&mb.cancel();Kb&&Kb.dispose();2===c&&Z.ULS.sendTraceTag(9011549,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",a,E.a.Jz(a)||"Unknown",H.a.instance.ga(77),wa,f,fa.Vo.id.toString()));x?Me.a.mark(4952):Me.a.mark(4950);return f}static glj(a,
b){Qd.moveToFirstRow(a);const c=Object(ua.a)(px.TableCellNode,a.currentNode).colSpan;if(b)for(b=0;b<c;b++)Qd.moveToNextColumn(a);else Qd.moveToPreviousColumn(a)}static Bcj(a){return Dc.b0b(a,!1,!0)}static vcj(a){return Dc.b0b(a,!0,!0)}static xcj(a,b){let c=Nn.a(a);b&&(c+=a.currentNode.colSpan-1);return c}static zcj(a){a=qd.a.rpb(a);return Dc.b0b(a,!0,H.a.instance.ga(104)&&Dc.nv)}static Dcj(a){a=qd.a.rpb(a);return Dc.b0b(a,!1,H.a.instance.ga(104)&&Dc.nv)}static odj(a,b){return Dc.b0b(a,!b,!0)}static b0b(a,
b,c){const f=new Yt;f.Vo=null;if(!a)return f.response=8,f;var l={};let x=[],G=!1;a=Dc.Yl.uA(a);1===a.length&&(G=!0);for(let Wa=0;Wa<a.length;++Wa)if(a[Wa].Qk){const mb=[];let Kb=nb.GraphIterator.mb(a[Wa].node);Kb.af();if(!Se.isTableCellOrInside(Kb))return f.response=8,f;if(b)Qd.returnToCell(Kb),c&&1<Se.getColSpan(Kb.currentNode)?Se.foreachMergedCells(Kb.currentNode,nc=>{nc=nb.GraphIterator.mb(nc);nc.af();Qd.moveToFirstRow(nc);Array.add(mb,nc)},2):Array.add(mb,Kb),Qd.moveToFirstRow(Kb);else{Se.isTableCell(Kb)||
Qd.returnToCell(Kb);var R=Kb.currentNode.rowSpan;Qd.returnToContainingRow(Kb);if(1<R)for(var fa=1;fa<R;fa++){var wa=nb.GraphIterator.mb(Kb.currentNode);wa.af();Array.add(mb,wa);Qd.moveToNextRow(Kb)}Array.add(mb,Kb)}for(R=0;R<mb.length;++R)if(Kb=mb[R],fa=Qd.getContainingTable(Kb),wa=Kb.currentNode.id.toString(),!l[wa])if(l[wa]=!0,f.Vo)if(f.Vo!==fa)if(Kb.BRa(f.Vo))Dc.X7f(Kb,f.Vo,b),wa=Kb.currentNode.id.toString(),l[wa]||(l[wa]=!0,Array.add(x,Kb));else if(l[wa]=!1,nb.GraphIterator.mb(f.Vo).N$(fa)){const nc=
[];for(let oc=0;oc<x.length;oc++){const Ic=x[oc];Dc.X7f(Ic,fa,b);wa=Ic.currentNode.id.toString();l[wa]||(l[wa]=!0,Array.add(nc,Ic))}wa=Kb.currentNode.id.toString();l[wa]||(l[wa]=!0,Array.add(nc,Kb));f.Vo=fa;Array.clear(x);x=nc}else return f.response=8,f;else Array.add(x,Kb);else f.Vo=fa,Array.add(x,Kb);Array.clear(mb)}if(!x.length)return f.response=8,f;f.AIb=x[0].currentNode;b=[];for(l=0;l<x.length;l++){a=x[l];if(!c&&Jd.TableReader.Zvb(a))return f.response=8,f;Array.add(b,Mc.a.create(a.currentNode))}f.Jdb=
G?1:b.length;f.DC=b;f.response=32;return f}static X7f(a,b,c){do c?Qd.returnToContainingCell(a):Qd.returnToContainingRow(a);while(Qd.getContainingTable(a)!==b);c&&Qd.moveToFirstRow(a)}static zSc(a,b,c,f,l){return 1===c?(a=b.fE)&&cb.SelectionEditor.Pg(a)?u.AFrameworkApplication.Ta.ki(a,E.a.insertTable,c,!0,f,l):2:32}static lCj(a,b,c,f,l){f.IP=0;f.l7=0;let x=-1,G=null,R=null,fa=null;if(!b.view.Lh)return 2;const wa=b.view;if(!wa.Gb)return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$la}),8;Me.a.mark(4941);if(2===
c){const Wa=wa.Gb.Kj;Wa.Qk&&(fa=new Id.GraphTransaction(15),R=DF.a.instance.Fij(Wa.node),fa.iy(R),G=new nb.GraphIterator,G.Pc(R),G.yc(),x=G.BQa(R.currentNode))}a=u.AFrameworkApplication.Ta.ki(b.fE,a,c,!0,f,l);32===a&&2===c&&(R.isValid?(Xb.OutlineElementNavigator.eJ(R,!1,!1),Xb.OutlineElementNavigator.ri(R),c=rd.SelectionFactory.rj(R.currentNode,!0)):(G.J4d(x),Xb.OutlineElementNavigator.ri(G),c=rd.SelectionFactory.rj(G.currentNode,!0)),wa.Gb.setSelection(c),v.FocusManager.instance().Bf(wa.eI));fa&&
fa.dispose();Me.a.mark(4942);return a}static kFb(a,b){if(!b.view.Lh)return 8;a=b.view;if(!a.Gb)return 8;a=Dc.Yl.uA(a.Gb.Kj);if(0>=a.length)return 8;b=new nb.GraphIterator;for(let c=0;c<a.length;++c)if(b.set(a[c].node),b.af(),!Jd.TableReader.hs(b))return 8;return 32}static g7(a,b,c){var f=b.contextId===Bb.a.Of;let l=null,x=null;if(f){l=b;if(Lb.HyperlinkReader.Gja(l,!0))return Dc.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.lSf}),8;x=new nb.GraphIterator;x.set(l.node);cb.SelectionEditor.kt(x);Tf.b(x)&&(Dc.Tc.Tb(Nd.a.Ko,
{["Reason"]:Od.a.VPd}),f=!1);!l.Qa&&x.Ivg&&(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.Gsg}),f=!1)}if(1===c||!f)return f?32:8;Me.a.mark(4929);b=new Id.GraphTransaction(7);b.iy(x);Xb.OutlineElementNavigator.Ke(x);c=x.currentNode;Dc.Nh.xca(x,!1,!1);f=Dc.Hq.g7(x,1,2);const G=new nb.GraphIterator;G.set(c);G.af();Qd.moveToCellContent(x,0,1);Dc.Nh.LIb(G,x,l,!0,!0);Qd.returnToContainingTable(x);Qd.moveToCellContent(x,0,0);x.Ii();tm.i(G,x,null,G.role);Dc.jo.H3a(G,null);Qd.returnToContainingTable(x);Xb.OutlineElementNavigator.Ke(x);
G.Ab(1)&&tm.h(x,null,1,1,G,-1);Dc.fba&&Dc.fba.Boc(c,w.a.Iq);b.dispose();Z.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,E.a.Jz(a)||"Unknown",H.a.instance.ga(77),f.id.toString()));Me.a.mark(4930);return 32}static C8d(a,b,c,f,l){u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?Z.ULS.sendTraceTag(541172701,324,50,"PPTO TestEcsFeature Client Flight Enabled. Box4."):Z.ULS.sendTraceTag(541172702,
324,50,"PPTO TestEcsFeature Client Flight Disabled. Box4.");var x=cb.SelectionEditor.Pg(b)&&a===E.a.bZa||b.contextId===Bb.a.tableCell;f=null;if(x&&(f=new nb.GraphIterator,f.set(b.node),f.pc(14),Se.isTableCellOrInside(f)||(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.bXb}),x=!1),x&&!Dc.Ewb(f,a)&&(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.aXb}),x=!1),x)){Qd.returnToContainingCell(f);var G=H.a.instance.ga(63)?63:255;if(Jd.TableReader.wi(Qd.getContainingTable(f))>=G)return Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.tUg}),8}if(1===
c||!x)return x?32:8;Me.a.mark(4931);c=a!==E.a.z8a;x=new Id.GraphTransaction(15);x.iy(f);b.node.zG().graphTransactionOperations.Cha(2);G=new nb.GraphIterator;G.set(f.currentNode);G.pc(15);Qd.returnToContainingTable(f);let R=Dc.u2d(G,c);c&&R++;Dc.Hq.fpg(f,R,!c,l?l:1,Dc.Etb);f.set(b.node);f.pc(16);a===E.a.bZa?(Qd.moveToNextColumn(G),Vh.OutlineNavigator.T9(G),Xb.OutlineElementNavigator.Ke(f),Dc.Nh.njc(G),Dc.Nh.LIb(f,G,b,!0,!0),Dc.fba&&Dc.fba.Boc(f.currentNode,w.a.Iq)):(a=Cb.App.Hb.Hd,b=nb.GraphIterator.mb(b.node),
b.af(),Dc.K4d(b,c),a.nn.Gb.setSelection(rd.SelectionFactory.rj(b.currentNode,!0)));x.dispose();Me.a.mark(4932);return 32}static EOj(a){return!(H.a.instance.ga(14)&&Jd.TableReader.QJj(a))&&!(H.a.instance.ga(30)&&Jd.TableReader.Zvb(a))}static insertRow(a,b,c,f,l){const x=a===E.a.Emc;f=a===E.a.C8a;var G=b.node;const R=new nb.GraphIterator;R.set(G);R.af();let fa=!0;gk.m(G)||Jd.TableReader.hs(R)||(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.tUd}),fa=!1);fa&&!Dc.Ewb(R,a)&&(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.aXb}),
fa=!1);if(1===c||!fa)return fa?32:8;Me.a.mark(4933);a=new Id.GraphTransaction(15);a.iy(R);b.node.zG().graphTransactionOperations.Cha(2);x?(l=new nb.GraphIterator,l.Pc(R),Xb.OutlineElementNavigator.Ke(l),Qd.returnToContainingRow(R),Dc.Hq.T8d(R,f,1,Dc.Etb),Qd.moveToFirstColumn(R),Vh.OutlineNavigator.T9(R),Dc.Nh.LIb(l,R,b,!1,!0),Qd.returnToContainingRow(R),Dc.fba&&Dc.fba.Boc(l.currentNode,w.a.Iq)):Dc.Hq.T8d(R,f,l?l:1,Dc.Etb);b=Cb.App.Hb.Hd;G=nb.GraphIterator.mb(G);G.pc(14);gk.l(G)||Qd.returnToContainingRow(G);
f?Qd.moveToPreviousRow(G):Qd.moveToNextRow(G);Dc.YVg(G);b.nn.Gb.setSelection(rd.SelectionFactory.rj(G.currentNode,!0));a.dispose();Me.a.mark(4934);return 32}static Gia(a,b,c,f,l){b=bi.Q4(a,b,c,f,l,{},16);2===c&&Dc.tna(a)&&Z.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",a,E.a.Jz(a)||"Unknown",b));return b}static tna(a){return a===E.a.AWc||a===E.a.zWc||a===E.a.BWc||a===E.a.xWc||a===E.a.wWc||a===E.a.yWc||a===E.a.tWc||a===E.a.sWc||a===E.a.uWc}static zBa(a,
b,c){const f=new nb.GraphIterator;let l=b.isValid;l&&(f.set(b.node),f.af()||(Dc.Tc.Tb(Nd.a.T0,{["Reason"]:Od.a.qKc}),l=!1),Se.isTableCellNode(b.node)||(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.bXb}),l=!1));l&&!Dc.Ewb(f,a)&&(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.aXb}),l=!1);if(l&&!Dc.vH.FKd()){a=new nb.GraphIterator;a.Pc(f);do if(!Dc.vH.IVb(a.currentNode)){Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.TFc});l=!1;break}while(Qd.moveToNextRow(a))}if(l&&(a=new nb.GraphIterator,a.Pc(f),1!==c&&H.a.instance.ga(50)&&Cb.App.Ih.Zv)){do for(b=
Xe.a.Gz(a.currentNode);b.moveNext();){const x=b.currentNode;yb.ParagraphReader.Vd(x)&&Cb.App.Ih.pY.Opa(x)}while(Qd.moveToNextRow(a))}if(1===c)return l?32:8;if(l){Me.a.mark(4935);c=new Id.GraphTransaction(7);try{c.iy(f),Dc.Hq.DGi(f)}finally{c&&c.dispose()}Me.a.mark(4936);return 32}return 2}static lWa(a,b,c,f,l){a=new nb.GraphIterator;if(f=b.isValid){a.set(b.node);a.af()||(Dc.Tc.Tb(Nd.a.T0,{["Reason"]:Od.a.qKc}),f=!1);Se.isTableCellNode(b.node)||(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.bXb}),f=!1);if(f&&
!Dc.vH.FKd()){b=new nb.GraphIterator;b.Pc(a);var x=new nb.GraphIterator;x.Pc(a);for(var G=0;G<l.rowSpan;G++){for(var R=0;R<l.colSpan;R++){if(!Dc.vH.IVb(b.currentNode)){Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.TFc});f=!1;break}b.vf(1)}if(!f)break;Qd.moveToNextRow(x);b.Pc(x)}}if(f&&1!==c&&H.a.instance.ga(50)&&Cb.App.Ih.Zv)for(b=new nb.GraphIterator,b.Pc(a),x=new nb.GraphIterator,x.Pc(a),G=0;G<l.rowSpan;G++){for(R=0;R<l.colSpan;R++)Cb.App.Ih.pY.Opa(b.currentNode),b.vf(1);if(!f)break;Qd.moveToNextRow(x);b.Pc(x)}}if(1===
c)return f?32:8;if(f){c=new Id.GraphTransaction(7);try{c.iy(a),Dc.Hq.lWa(a,l.rowSpan,l.colSpan)}finally{c&&c.dispose()}return 32}return 2}static MIb(a,b,c){a=new nb.GraphIterator;let f=b.isValid;f&&(a.set(b.node),a.af()||(Dc.Tc.Tb(Nd.a.T0,{["Reason"]:Od.a.qKc}),f=!1),Se.isTableCellNode(b.node)||(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.bXb}),f=!1),f&&1!==c&&H.a.instance.ga(50)&&Cb.App.Ih.Zv&&(b=new nb.GraphIterator,b.Pc(a),Cb.App.Ih.pY.Opa(b.currentNode)));if(1===c)return f?32:8;if(f){c=new Id.GraphTransaction(7);
try{c.iy(a)}finally{c&&c.dispose()}return 32}return 2}static Fba(a,b,c,f,l){b=b.node;f=!0;Jd.TableReader.G9a(b)||(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.RFc}),f=!1);Dc.vH.IVb(b)||(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.TFc}),f=!1);f&&(H.a.instance.ga(14)||H.a.instance.ga(63))&&Dc.Yi.Gce(b)&&(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),f=!1);if(1===c)return f?32:8;if(f){if(H.a.instance.ga(50)&&Cb.App.Ih.Zv)for(c=Xe.a.Gz(b);c.moveNext();)f=c.currentNode,12===f.type&&Cb.App.Ih.pY.Opa(f);l=Object(ua.a)(Bs,l);c=new Id.GraphTransaction(7);
c.gd(b);f=new nb.GraphIterator;f.set(b);f.af();f.yc();Dc.Nh.FBa(f);c.dispose();l&&(l.W_b=!0);Z.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",a,E.a.Jz(a)||"Unknown",H.a.instance.ga(77),b.id.toString()));return 32}return 2}static deleteRow(a,b,c,f,l){b=b.node;if(!Dc.vH.IVb(b))return 8;f=new nb.GraphIterator;f.set(b);f.af();let x=gk.m(b);x||Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.sSf});x&&!Dc.Ewb(f,a)&&(Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.aXb}),x=
!1);if(1===c)return x?32:8;if(x){if(H.a.instance.ga(50)&&!Cb.App.Ih.amIAlone)for(a=Xe.a.Gz(b);a.moveNext();)c=a.currentNode,12===c.type&&Cb.App.Ih.pY.Opa(c);Me.a.mark(4937);l=Object(ua.a)(Bs,l);a=new Id.GraphTransaction(7);a.gd(b);Dc.Hq.LHc(f);a.dispose();l&&(l.W_b=!0);Me.a.mark(4938);return 32}return 2}static E4a(a,b,c){let f=!1;a=null;b.Qk&&(a=new nb.GraphIterator,a.set(b.node),(f=Jd.TableReader.Vp(a)&&Jd.TableReader.kce(a.currentNode))?a.af():Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.rSf}));return 1===
c?f?32:8:f?(Me.a.mark(4939),b=new nb.GraphIterator,b.Pc(a),Qd.moveToCell(b,0,0),Xb.OutlineElementNavigator.Ke(a),c=new Id.GraphTransaction(7),c.iy(b),Dc.Nh.Bgh(a,b),c.dispose(),Me.a.mark(4940),32):2}static insertTable(a,b,c,f,l){if(!b.Qk||!cb.SelectionEditor.Pg(b))return 2;if(H.a.instance.ga(14)&&Dc.Yi.Xsa(b))return Dc.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),2;if(Dc.Sq()&&Dc.Sq().instance&&Dc.Sq().instance.lW(b))return 2;var x=new nb.GraphIterator;x.set(b.node);cb.SelectionEditor.kt(x);if(Tf.b(x))return Dc.Tc.Tb(Nd.a.Ko,
{["Reason"]:Od.a.VPd}),2;if(1===c)return 32;c=1;x=2;l&&(c=l.rows,x=l.columns);f.IP=x;f.l7=c;if(cb.SelectionEditor.Pg(b)){f=new Id.GraphTransaction(7);Me.a.mark(4927);f.gd(b.node);b.node.zG().graphTransactionOperations.Cha(2);const R=new gI.a;H.a.instance.ga(50)&&Cb.App.Ih.Zv&&Cb.App.Ih.pY.Opa(b.node);var G=vb.a.Ls(b);H.a.instance.ga(49)&&(G.cache.Qs&&(G=G.Ud(null),Dc.ih.pJ(G)),R.formatting=G.em);R.languageId=vb.a.language(G);H.a.instance.ga(71)&&(R.style=Uc.StyleReader.BD(b.node),Dc.Tf.bZb(R.style)&&
(G=Uc.StyleReader.MK(b.node)))&&(R.style=G.DG(Uc.StyleReader.DKa));H.a.instance.ga(54)?(G=nb.GraphIterator.mb(b.node),G.pc(11),Dc.PL.I7(G.currentNode)):new ov.a(1,-1);b=Dc.Nh.SBj(b);G=l&&l.yOj?Dc.Hq.g7(b,c,x,R):Dc.Hq.g7(b,c,x,R,!0);l&&(l.tableNode=G);Xb.OutlineElementNavigator.Ke(b);H.a.instance.ga(56)&&R.style&&!ae.OutlineElementReader.Qbe(b.currentNode)&&R.style.sa(tb.a.HX,!1)&&Dc.Nh.eJa(b.currentNode,!0);Dc.jo.H3a(b,null,!0,!1,-1);ae.OutlineElementReader.n9a(b)&&Dc.Nh.xca(b,!1,!0,R);f.dispose();
Z.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",a,E.a.Jz(a)||"Unknown",H.a.instance.ga(77),G.id.toString(),c,x));Me.a.mark(4928);u.AFrameworkApplication.DN("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorGridTableDefaultStyleSettings");return 32}return 2}static coc(a,b,c){if(1===c)return 32;Me.a.mark(5748);a=b.node;b=new Id.GraphTransaction(15);b.gd(a);a.setValue(tb.a.bib,!a.sa(tb.a.bib,!0));b.dispose();
Me.a.mark(5749);return 32}static Dhc(a,b,c,f,l){l.setValue(tb.a.bib,!b.node.sa(tb.a.bib,!0));return 32}}Dc.Vyh="top";Dc.hfk="center";Dc.Sei="bottom";Dc.bWf="__cumulative__";Dc.MPd="__consistent__";Dc.wB=new ah.a;Dc.VC=new ah.a;Dc.Ai=null;Dc.Ou=null;Dc.gG=null;Dc.Dyf=null;Dc.W0e=null;Dc.sA=null;Dc.xm=null;Dc.D0a=null;Dc.f$h=Dc.ehj;Dc.Kud=null;Dc.Hud=null;Dc.Iud=null;Dc.Jud=null;Dc.Lud=null;Dc.Nud=null;Dc.Mud=null;Dc.nxd=null;Dc.Yc=null;Dc.Hf=null;Dc.Xc=null;Dc.Ro=null;Dc.aLa=null;Dc.Sg=null;Dc.Po=
null;Dc.aga=null;Dc.gD=null;Object(e.a)(Dc,"TableActor",null,[]);var iI=d(306),GP=d(806),jI=d(865),HP=d(394),IP=d(791);class kI{constructor(a,b,c,f){this.QHc=this.OHc=null;this.Cmc=a;this.ild=b;this.muh=c;this.ouh=f}}Object(e.a)(kI,"TableSimplificationInformation",null,[]);var zv=d(409),JP=d(444),$t=d(252),uq=d(210);class Mh{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc){this.Sg=this.D0a=this.HM=this.vp=null;this.Pzd=!1;this.mTh=x;this.gG=G;this.rlb=a;this.gD=b;this.Cx=c;this.Ai=f;this.Po=l;this.eb=
R;this.rk=wa;this.tGd=fa.create(2097162);this.nFe(this.tGd);this.S2e=fa.create(2097162);this.nFe(this.S2e);this.pBf=fa.create(2097162);this.nFe(this.pBf);this.m1=this.tGd;this.$Ed=Wa;this.hD=mb;this.Xc=Kb;this.ZRb=nc;this.FWh=nc.substr(0,3);this.Goa=oc}get Tf(){return this.Sg||(this.Sg=fb.a.instance.resolve("Box4.List.IListReader"))}get Ir(){return this.vp?this.vp.Ir:0}get K4a(){return this.vp.kb.K4a}get sia(){return this.vp.kb.sia}get fSe(){return this.m1}get TPd(){return this.vp.MG&&!this.Pzd}hph(){this.Pzd=
!0}get H3g(){return!this.vp.MG}get T$(){return yg.a.instance}get NMj(){return this.eb.ka("InternalPasteTableWithReplacingCellIsEnabled")&&H.a.instance.ga(63)||H.a.instance.ga(77)}nFe(a){var b=new JP.a(-1);this.mTh.DU.Znb(b);const c=new nb.GraphIterator;c.set(b);b=this.rk.ke(3);b.iy(c);c.pl(a,80);b.dispose()}wQd(a,b=null){a=a.Gb;this.vp=a.Oa.clone();this.Pzd=!1;a=nb.GraphIterator.mb(a.nib);const c=nb.GraphIterator.mb(this.m1),f=this.rk.ke(3);f.iy(c);a.Ab(82);do a.currentNode.j_a(null);while(a.zj(82));
a=new hd.a(b,Object(C.a)(this,this.opi,"clearInternalClipboard"),new aI(a,c,this.vp,f));a.Fl("InternalCopy");a.Xi=!b||b.Xi;a.run()}opi(a,b){Me.a.mark(5566);b=b.target;if(b.Ji())return b.Ii(),!0;a.Zg(Object(C.a)(this,this.VJc,"executeCopy"));return!0}VJc(a,b){b=new jz(b,null);b=new hd.a(a,Object(C.a)(this,this.pXb,"coreCopySetup"),b);b.Fl("ExecuteCoreCopyToInternalClipboard");b.run();a.Zg(Object(C.a)(this,this.grl,"trimNewText"));return!0}pXb(a,b){if(!b.source.Ji())return b.oh&&(b.oh.BEc=null),Z.ULS.shipAssertTag(6305560,
307,!1),!1;a.Zg(Object(C.a)(this,this.tTf,"coreCopyIteration"));return!0}tTf(a,b){const c=b.insertAfter,f=b.source,l=b.target,x=f.currentNode;var G=this.H3g;if(!x.sbe)return a.Zg(Object(C.a)(this,this.iGc,"coreCopyIncrement")),!0;b.oh.Zid&&(b.Zid=!0);if(!b.Zid&&(x.YZb()&&b.O5.tja.c++,x.YZb()||G&&!x.swb(this.Ir)))return a.Zg(Object(C.a)(this,this.iGc,"coreCopyIncrement")),!0;if(!b.Zid&&G&&!x.hy)return f.iDa()&&(b.lod=!0,b=new hd.a(a,Object(C.a)(this,this.pXb,"coreCopySetup"),new jz(b,c)),b.Fl("RecursiveCoreCopyToInternalClipboard"),
b.run()),a.Zg(Object(C.a)(this,this.iGc,"coreCopyIncrement")),!0;G=l.currentNode.Co().vi;G=tm.a(x,G,!0);this.T$.Wic(b.O5.M7a,G);l.SK(G,c,18===f.parentNode.type?1:f.role);l.Gk(G);b.insertAfter=G;yb.ParagraphReader.Vd(G)&&(this.YCk(a,Object(C.a)(this,this.pXb,"coreCopySetup"),x,G,b),this.XCk(x,G));this.$1f(x,G);f.iDa()&&(Z.ULS.shipAssertTag(6305562,307,!b.lod),b=new hd.a(a,Object(C.a)(this,this.pXb,"coreCopySetup"),new jz(b,null)),b.Fl("RecursiveCoreCopyToInternalClipboard"),b.run());a.Zg(Object(C.a)(this,
this.mxi,"coreCopyIterationPostProcessing"));return!0}mxi(a,b){var c=b.source;const f=b.target;var l=f.currentNode,x=c.currentNode;yb.ParagraphReader.Rk(f)&&(b.Ize[x.id.toString()]=l);if(H.a.instance.ga(54)&&yb.ParagraphReader.Vd(l)){if(0<yb.ParagraphReader.Ggg(x))if(0<this.gG.a7a(x).oM)x.setValue(Mb.a.Nfc,0);else{var G=this.gG.otb(x).oM;Mh.paragraphEditor.hv.Jgb(l,G)}if(!this.J8a&&this.Goa.Aad){c.yc();if(!Jd.TableReader.hs(f)&&c.cwb&&!this.sia)for(var R of this.Goa.xuk)l.removeProperty(R);c.Gk(x)}}if(H.a.instance.ga(57)&&
yb.ParagraphReader.Vd(l)){G=[];R=[];for(let fa=0;fa<l.wordRunProperties.length;fa++)l.wordRunProperties.XX.$(fa,iI.CharacterPropertiesEditor.fea),l.wordRunProperties.wea.$(fa,iI.CharacterPropertiesEditor.eea),G[fa]=!0,R[fa]=!1;l.me(Mb.a.T7c,G);Z.ULS.shipAssertTag(6305563,307,G.length===l.wordRunProperties.length);Z.ULS.shipAssertTag(6305564,307,H.a.instance.ga(50));Z.ULS.shipAssertTag(6305565,307,!!Cb.App.Ih);H.a.instance.ga(50)&&Cb.App.Ih.Zv&&(l.me(As.a.tw,R),Z.ULS.shipAssertTag(6305566,307,R.length===
l.wordRunProperties.length));(this.Xc.ag&&this.Xc.By||H.a.instance.ga(45)&&Cb.App.nD.UJb)&&l.setValue(Mb.a.q5b,!0);H.a.instance.ga(14)&&l.Un(Mb.a.dXd,Mb.a.muk,Mb.a.ouk);H.a.instance.ga(45)&&yb.ParagraphReader.Vd(l)&&l.Un(Mb.a.z9a)}this.F3g(f)&&(G=f.currentNode.zG(),l=W.ImageReader.zOc(f.currentNode.properties,G.vi,!1),G=W.ImageReader.zOc(f.currentNode.properties,G.vi,!0),R=null,db.EmbeddedFileReader.KTc(f)&&(R=db.EmbeddedFileReader.kNc(f.currentNode)),this.fXd(l,x),this.fXd(G,x),this.fXd(R,x));this.H3g&&
(this.Z1f(f),Jd.TableReader.Vp(f)&&(x=this.vp.LV(),x.moveNext(),(x=Se.getCellLocation(c,x.current.node))||(x=new IP.a(0,0)),c=new kI(x,f,Jd.TableReader.B1i(c),Jd.TableReader.ldj(c)),this.gD.VVk(c)));ae.OutlineElementReader.Ug(f)&&!f.pI(2)&&(this.Ai.yba(f),f.yc());f.yc();b.oh&&(b.oh.BEc=b.insertAfter);a.Zg(Object(C.a)(this,this.iGc,"coreCopyIncrement"));return!0}iGc(a,b){b.lod&&(b.insertAfter=b.BEc,b.lod=!1);if(!b.source.fDa()){b.oh&&(b.oh.BEc=b.insertAfter);const c=b.source;11!==c.oi||c.jOc(-1)||
this.sDk(a,c.currentNode,b.target.currentNode,b);return!1}a.Zg(Object(C.a)(this,this.tTf,"coreCopyIteration"));return!0}XCk(a,b){a=Ie.f(a);Ie.f(b);for(b=0;b<a.length;b++)Object(C.a)(this,this.pXb,"coreCopySetup")}grl(a,b){if(b.Jqa>=b.KGb.length)return a.Zg(Object(C.a)(this,this.lxi,"copyTeardown")),!0;a=b.KGb[b.Jqa];var c=a.node,f=a.Qa,l=a.Kb;if(!cb.SelectionEditor.xu(a))if(!b.Jqa&&cb.SelectionEditor.Ll(a))l=f=yb.ParagraphReader.textLength(c);else if(yb.ParagraphReader.im(a))f=0,l=yb.ParagraphReader.textLength(c);
else if(cb.SelectionEditor.Z7(a)){Z.ULS.shipAssertTag(6305568,307,!b.Jqa);var x=nb.GraphIterator.mb(c);f=x.pc(12);Z.ULS.shipAssertTag(6305569,307,f);c=x.origin;l=f=yb.ParagraphReader.textLength(c)}else{if(bj.OutlineReader.x5b(a))for(a=ox.a.Gz(a.node);a.moveNext();)x=a.currentNode,yb.ParagraphReader.Vd(x)&&Array.add(b.KGb,Mc.a.createTextRange(x,0,yb.ParagraphReader.textLength(x)));b.Jqa++;return!0}x=b.Ize[c.id.toString()];Z.ULS.shipAssertTag(6305570,307,!!x);if(!x)return Z.ULS.sendTraceTag(21041548,
307,15,"TrimNewTextParagraphCloneNull: {0}",{["ContextIndex"]:b.Jqa,["SelectedContextsLength"]:b.KGb.length,["SelectedNodeType"]:c.type,["ContextId"]:a.contextId}),b.Jqa++,!0;c=Ie.f(x);let G,R=!1;for(G=c.length-1;0<=G;G--)if(!c[G].SDc)if(4===c[G].Lq)c[G].ye.blob=null,c[G].ye.blob=new zv.a(c[G].ye,zv.a.DHc),b.O5.tja.e++;else{c[G].ye.blob=null;if(H.a.instance.ga(57)&&-1!==c[G].kg){var fa=c[G].ye.formatting,wa=void 0,Wa=void 0;fa&&-1===fa.kg?(Wa=c[G].kg+1,wa=c[G].X9-1,fa.kg=c[G].kg):(wa=c[G].X9,Wa=c[G].kg);
for(fa=0;fa<wa;fa++)x.wordRunProperties.removeAt(Wa,16);0<wa&&(R=!0)}wa="";$t.f(c[G])?(wa=" ",b.O5.tja.f++):$t.g(c[G])&&(Wa=$t.b(c[G]))&&(wa=$t.a(Wa),b.O5.tja.g++);Wa=c[G].ye.cp;Wa>=f&&Wa<l&&(Mh.characterPropertiesEditor.replaceTextRange(Mc.a.createTextRange(x,Wa,Wa+1),wa),l=l-1+wa.length,b.O5.tja.i++)}R&&x.Nu();this.uQk(x);c=yb.ParagraphReader.textLength(x);l<c&&Mh.characterPropertiesEditor.replaceTextRange(Mc.a.createTextRange(x,l,c),"");0<f&&Mh.characterPropertiesEditor.replaceTextRange(Mc.a.createTextRange(x,
0,f),"");f=0;l=nb.GraphIterator.mb(x);for(l.Ab(6);!l.Vq;)c=l.currentNode,l.zj(6),W.ImageReader.LG(c)?W.ImageReader.Nbe(c)?(Mh.paragraphEditor.PSf(c,Mc.a.ak(x,f)),f++,b.O5.tja.d++):(c=nb.GraphIterator.mb(c),c.pc(12),c.Ii(),b.O5.tja.h++):Z.ULS.shipAssertTag(6305571,307,!1);!yb.ParagraphReader.textLength(x)&&b.Jqa===b.KGb.length-1&&cb.SelectionEditor.xu(a)&&(a=nb.GraphIterator.mb(x),a.pc(25)&&(Xb.OutlineElementNavigator.Ke(a),this.Ai.FBa(a),b.Jqa&&(this.vp.kb.sia=!0)));this.T$.zXa(b.O5.jad,b.O5.s4a,
b.O5.eOa,x);b.Jqa++;return!0}uQk(a){const b=H.a.instance.ga(14),c=!this.Xc.ag&&H.a.instance.ga(45),f=Mh.sN,l=a.Ra;if(H.a.instance.ga(57)&&l&&(b||c)){var x=new Ha.a,G=new Ha.a;for(let fa=0;fa<l.length;fa++){const wa=l.ga(fa);if(b){wa.hl&&x.add(wa);if(f){if(wa.Sh){for(var R=0;R<wa.Sh.length;R++)G.add(wa.Sh.ga(R).kg);wa.Sh=null}}else wa.fieldRangeEnd&&(G.add(wa.fieldRangeEnd.kg),wa.fieldRangeEnd=null),wa.Ao&&(G.add(wa.Ao.kg),wa.Ao=null);if(wa.$j){for(R=0;R<wa.$j.length;R++)G.add(wa.$j.ga(R).kg);wa.$j=
null}}if(c){if(Cb.App.nD.UJb){wa.formatting&&Mh.ih.pJ(wa.formatting);if(wa.hyperlink){for(R=0;R<wa.hyperlink.X9;R++)G.add(wa.hyperlink.kg+R);wa.hyperlink=null}wa.Sm=!1}wa.trackedChange=null;wa.zI=!1}}a.rIa(!0,G);for(let fa of x)fa.hl=null;c&&1<l.length&&(a=l.first,a.trackedChange=new GP.a(a),l.last.zI=!0)}}lxi(a,b){this.m1.j_a(null);b.plj.dispose();Me.a.mark(5567);this.xhk();this.HM=b.O5;this.eDg("Copy");this.YFj&&Z.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot");return!1}get YFj(){return!nb.GraphIterator.mb(this.m1).Ji()}Tzl(){this.m1=
this.pBf}Szl(){this.m1=this.tGd}Gzl(){this.m1=this.S2e}NPf(){const a=nb.GraphIterator.mb(this.m1);for(;a.Ji();)a.Ii()}eDg(a){const b=this.HM.tja.b;a+="-"+b;this.HM.tja.b=a;this.HM.M7a.b=a;this.HM.jad.b=a;this.HM.s4a.b=a;this.HM.eOa.b=a;this.T$.VYj(this.HM.tja);this.T$.Kee(this.HM.M7a);this.T$.EDg(this.HM.jad);this.T$.Eee(this.HM.s4a);this.T$.Dee(this.HM.eOa);this.HM.tja.b=b;this.HM.M7a.b=b;this.HM.jad.b=b;this.HM.s4a.b=b;this.HM.eOa.b=b}L5g(a,b,c,f,l=null,x=null){this.eDg("Paste");b=nb.GraphIterator.mb(b);
const G=nb.GraphIterator.mb(this.m1);var R=null;l&&(R=new Qw.a(bj.OutlineReader.CHc,bj.OutlineReader.lXf),R=l.equals(new Qw.a(-1,-1))?new Qw.a(0,0):l.yU(R));if(this.FSc())if(G.Ji(),W.ImageReader.LG(G.currentNode))l=G.currentNode,G.yc(),G.SK(this.Ai.sRd(),null,1),G.Ji(),G.SK(l,null,2),G.yc(),G.Gk(l),G.Ii(),this.rlb.imk(),this.hph();else if(db.EmbeddedFileReader.$8a(G.currentNode)){l=G.currentNode;G.yc();G.SK(this.Ai.sRd(),null,1);G.Ji();var fa=this.Ai.yba(G);fa=Mc.a.ak(fa,0);Mh.characterPropertiesEditor.replaceTextRange(fa,
"<<"+db.EmbeddedFileReader.lNc(l)+">>");G.yc();G.yc();G.Gk(l);G.Ii();this.hph()}this.NMj&&this.jAg(G,b)?(G.currentNode.j_a(null),Z.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.fUk(x,G,b,R,a),Z.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.")):(Me.a.mark(5564),G.currentNode.j_a(null),a={},a[Mh.Pwj]=f,Ib.ListReader.zSa(c)&&this.Tf.Ahc&&(a[jI.a.wsg]=!0),c=new kz(G,b,c,R,a),f=new hd.a(x,Object(C.a)(this,this.qXb,"corePasteSetup"),
c),f.Fl("ExecuteCorePasteFromInternalClipboard"),f.Xi=!x||x.Xi,this.OCk(c),f.run())}Nzg(a){if(a&&a.isValid){const b=nb.GraphIterator.mb(this.m1);return this.jAg(b,a)}return!1}jAg(a,b){if(Se.isTableCellOrInside(b)&&1===a.O6a()){a.Ab(1);if(ae.OutlineElementReader.Ug(a)){Xb.OutlineElementNavigator.ri(a);if(Jd.TableReader.Vp(a)){Jd.TableReader.vu(a.currentNode)&&Z.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table.");if(b.pc(14)&&!Jd.TableReader.vu(Qd.getContainingTable(b)))return Z.ULS.sendTraceTag(19269659,
307,50,"Target table is not a complex table."),!0;Z.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table.");if(this.J8a)return!0}Xb.OutlineElementNavigator.Ke(a)}a.yc()}return!1}fUk(a,b,c,f,l){c.pc(14);const x=gk.c(c),G=Nn.a(c);c.Rg(14);var R=Jd.TableReader.jk(c.currentNode);const fa=Jd.TableReader.wi(c.currentNode),wa=Jd.TableReader.jk(b.currentNode),Wa=Jd.TableReader.wi(b.currentNode);Z.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",
R,fa,wa,Wa);this.D0a=Dc.Etb;if(this.JQj(x+wa,G+Wa)){var mb=x+wa-R;0<mb&&(Qd.moveToLastRow(c),Z.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+mb),this.gD.T8d(c,!1,mb,this.D0a),Z.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),c.Rg(14));mb=G+Wa-fa;if(0<mb){Z.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+mb);try{this.gD.fpg(c,fa,!1,mb,this.D0a)}catch(Kb){throw Z.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",Kb.toString()),Kb;}Z.ULS.sendTraceTag(8716377,
307,50,"Completed inserting columns.")}R=this.F0i(R,fa,wa,Wa,x,G);Z.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");a=new hd.a(this.J8a?a:null,Object(C.a)(this,this.wwk,"pasteTableOperationRun"),new cI(null,b,c,f,x,G,R,null,l));a.Fl("ExecuteCorePasteTableInTable");a.Xi=!1;a.run()}}JQj(a,b){if(!this.mxg)return!0;const c={};a>Mh.BDc&&(c.rowCount=a,c.c_maxTableRowColCount=Mh.BDc);b>Mh.BDc&&(c.columnCount=b,c.c_maxTableRowColCount=Mh.BDc);const f=a*b;f>Mh.oMf&&(c.rowCount=a,c.columnCount=
b,c.cellsCount=f,c.c_maxTableCellCount=Mh.oMf);0<uq.a(c).length&&Z.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",c);return!uq.a(c).length}wwk(a,b){if(b.pJb){if(b.pJb.inProgress)return!0;Se.isTableCell(b.source)||b.source.Rg(16);this.mxg&&Se.isFirstCellInTable(b.source)&&this.iUb(b.Ef,b.target.currentNode);if(Se.isLastCellInTable(b.source))return this.zhk(Qd.getContainingTable(b.target)),Z.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;Se.isTableCell(b.target)||
b.target.Rg(16);const c=!this.J8a;Se.isLastCellInRow(b.source)?(Qd.moveToNextRow(b.target),Qd.moveToColumnByIndex(b.target,b.Rha),Z.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")):Qd.moveToNextOrPreviousCell(b.target,!1,c);Qd.moveToNextOrPreviousCell(b.source,!1,c)}else Jd.TableReader.Vp(b.target)||b.target.Rg(14),Jd.TableReader.Vp(b.source)||b.source.Rg(14),Qd.moveToCell(b.target,b.rowIndex,b.Rha),Qd.moveToCell(b.source,0,0);for(;b.target.Ji();)b.target.Ii();b.pJb=new hd.a(a,
b.Q5g?b.Q5g:Object(C.a)(this,this.qXb,"corePasteSetup"),new kz(b.source,b.target,null,b.W$c));b.pJb.Fl("ExecuteCorePasteCellContentInCell");b.pJb.Xi=!1;b.pJb.run();return!0}xhk(){if(this.J8a){for(var a=nb.GraphIterator.mb(this.fSe),b=a.currentNode;14!==a.oi;)if(b=a.Ji(),!b){Z.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");return}this.kXg(b)}}zhk(a){this.J8a&&this.kXg(a)}Aol(a){const b=nb.GraphIterator.mb(a);this.Cx.c4b(b,null,
!0);a.isGhostCell=!1;a.rowSpan=1;a.colSpan=1}kXg(a){if(a&&14===a.type){Z.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var b={},c=Jd.TableReader.jk(a),f=Jd.TableReader.wi(a),l=nb.GraphIterator.mb(a);Qd.forEachCellInTable(l,(x,G,R)=>{const fa={};x=x.currentNode;if(16===x.type)if(x.isGhostCell)Mh.RRf(G,R)in b||(this.Aol(x),fa.IsGhostCell="->false");else{H.a.instance.ga(77);Mh.ULk(a,x,G,R,c,(Wa,mb,Kb)=>{fa.rowSpan=String.format("{0}:{1}->{2}",Wa,mb,Kb)});Mh.TLk(a,x,R,G,f,(Wa,
mb,Kb)=>{fa.colSpan=String.format("{0}:{1}->{2}",Wa,mb,Kb)});const wa=String.format("{0},{1}-{2},{3}",G,R,G+x.rowSpan,R+x.colSpan);for(let Wa=0;Wa<x.rowSpan;Wa++)for(let mb=0;mb<x.colSpan;mb++)if(Wa||mb)b[Mh.RRf(G+Wa,R+mb)]=wa}if(0<uq.a(fa).length){if(void 0===fa.IsGhostCell||null===fa.IsGhostCell){if(void 0===fa.rowSpan||null===fa.rowSpan)fa.rowSpan=x.rowSpan;if(void 0===fa.colSpan||null===fa.colSpan)fa.colSpan=x.colSpan}Z.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",G,R,fa)}return!0});
Mh.lLi(b)}}get mxg(){return H.a.instance.ga(77)}get J8a(){return!!this.eb&&this.eb.ka("ComplexTableCellPasteWithFormattingIsEnabled")}iUb(a,b){a?(b=nb.GraphIterator.mb(b),b.HA(1)?(b=b.Ab(2))?(b=rd.SelectionFactory.Mg(b,0),a.Gb.setSelection(b)):Z.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found."):Z.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")):Z.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")}F0i(a,
b,c,f,l,x){const G=[];for(let R=0;R<Math.max(l+c,a);R++){let fa=0,wa=x+f;for(R<l?fa=b:R>=l&&R<Math.min(l+c,a)?fa=x:R>=l+c&&R<a?fa=b:wa=Math.max(x+f,b);fa<wa;fa++)Array.add(G,Array(2)),G[G.length-1][0]=R,G[G.length-1][1]=fa}return G}qXb(a,b){if(!b.source.Ji())return a.Zg(Object(C.a)(this,this.bXa,"pasteTeardown")),!0;a.Zg(Object(C.a)(this,this.vTf,"corePasteIteration"));return!0}oUk(a,b){if(this.J8a)if(!b||!a)Z.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{["source"]:a,["table"]:b});
else if(16===b.currentNode.type&&16===a.parentNode.type){b=b.currentNode;a=a.parentNode;var c={};b.isGhostCell!==a.isGhostCell&&(b.isGhostCell=a.isGhostCell,c.IsGhostCell=b.isGhostCell);b.isSkippedCell!==a.isSkippedCell&&(b.isSkippedCell=a.isSkippedCell,c.IsSkippedCell=b.isSkippedCell);b.mhb!==a.mhb&&(b.mhb=a.mhb,c.ShouldRenderCell=b.mhb);b.colSpan!==a.colSpan&&(c.ColSpan=String.format("{0}<={1}.",b.colSpan,a.colSpan),b.colSpan=a.colSpan);b.rowSpan!==a.rowSpan&&(c.RowSpan=String.format("{0}<={1}.",
b.rowSpan,a.rowSpan),b.rowSpan=a.rowSpan);uq.a(c)}}vTf(a,b){const c=b.source,f=b.target,l=c.currentNode;if(!l.sbe||!l.Kpb)return a.Zg(Object(C.a)(this,this.jGc,"corePasteIncrement")),!0;if(this.Xc.ag&&ae.OutlineElementReader.Ug(c)){if(!Xb.OutlineElementNavigator.ri(c).Kpb)return Xb.OutlineElementNavigator.Ke(c),a.Zg(Object(C.a)(this,this.jGc,"corePasteIncrement")),!0;Xb.OutlineElementNavigator.Ke(c)}Z.ULS.shipAssertTag(6305608,307,!l.YZb());var x=f.currentNode.Co().vi;x=tm.a(l,x,!0);x.Odb();this.oUk(c,
f);f.SK(x,b.insertAfter,c.role);f.Gk(x);b.insertAfter=x;H.a.instance.ga(50)&&Cb.App.Ih.Zv&&Cb.App.Ih.pY.Opa(x);this.$1f(l,x);b=new hd.a(a,Object(C.a)(this,this.qXb,"corePasteSetup"),new kz(c,f,null,b.W$c,b.CK));b.Fl("RecursiveCorePasteOperation");b.run();a.Zg(Object(C.a)(this,this.qxi,"corePasteIterationPostProcessing"));return!0}yDk(a,b,c){b=Ie.f(b);c=Ie.f(c);for(let f=b.length-1;0<=f;f--)b[f].Fwe(c[f],a,Object(C.a)(this,this.qXb,"corePasteSetup"))}fXd(a,b){a&&(Z.ULS.shipAssertTag(6305610,307,a.Sa(Cc.a.zfc)),
a.Sa(Cc.a.zfc)||a.setValue(Cc.a.zfc,a.sa(Cc.a.WXg,"")),b=(b=HP.SectionNavigator.nfg(b))?b.fileId:Cb.App.Hb.Hd.Yaa?Cb.App.Hb.Hd.Yaa.fileId:null,!a.Sa(Cc.a.fileId)&&b&&a.setValue(Cc.a.fileId,b))}gXd(a){a&&this.rlb.D5k()}qxi(a,b){const c=b.target,f=c.currentNode,l=b.source.currentNode;yb.ParagraphReader.Vd(f)&&(this.zDk(a,Object(C.a)(this,this.qXb,"corePasteSetup"),l,f,b),this.yDk(a,l,f));f.HYg();b.CK[jI.a.wsg]&&22===f.type&&f.setValue(Mb.a.listID,Number.MAX_VALUE);if(H.a.instance.ga(11)&&yb.ParagraphReader.Vd(f)){var x=
Ie.j(f,5);if(0<x.length){for(var G of x)!G.properties.Sa(Mb.a.L6g)&&G.properties.Sa(Mb.a.K6g)&&(x=G.properties.getValue(Mb.a.K6g),G.properties.setValue(Mb.a.L6g,x)),W.ImageReader.Lbe(G.properties)||this.rlb.YZk();f.Co().contentReplicator.forceOutbound(null,null,null)}}H.a.instance.ga(25)&&ae.OutlineElementReader.Ug(c)&&this.Ai.PUe(c.currentNode);H.a.instance.ga(10)&&bj.OutlineReader.KUc(f)&&(G=nq.b(f),b=b.W$c,nq.c(f,G.x+b.x,G.y+b.y));if(this.F3g(c)){b=c.currentNode.zG();G=W.ImageReader.zOc(c.currentNode.properties,
b.vi,!1);x=W.ImageReader.zOc(c.currentNode.properties,b.vi,!0);let R=null;db.EmbeddedFileReader.KTc(c)&&(R=db.EmbeddedFileReader.kNc(c.currentNode));this.gXd(G);this.gXd(x);this.gXd(R);if(G||x||R)b.ZLj=!0,b.$Lj=!0}H.a.instance.ga(24)&&db.EmbeddedFileReader.KTc(c)&&(b=c.currentNode,db.EmbeddedFileReader.wIj(c)?(c.yc(),G=this.Cx.tBi(),G.setValue(tb.a.EI,Mh.Ak.isRtl(b)?11:9),x=nq.b(f),nq.c(G,x.x,x.y),c.SK(G,b,1),c.Gk(b),c.qZf(),this.Cx.eZ(c,!1)):c.Ii(),G=this.Ai.yba(c),G=Mc.a.ak(G,0),Mh.characterPropertiesEditor.replaceTextRange(G,
"<<"+db.EmbeddedFileReader.lNc(b)+">>"));this.Z1f(c);this.Tyl(l,f);c.yc();a.Zg(Object(C.a)(this,this.jGc,"corePasteIncrement"));return!0}F3g(a){return H.a.instance.ga(1)&&W.ImageReader.d5b(a)||H.a.instance.ga(24)&&db.EmbeddedFileReader.KTc(a)}Tyl(a,b){if(this.Xc.ag&&Jd.TableReader.G9a(a)){let c=0;const f=Jd.TableReader.jk(a);for(let l of Jd.TableReader.MOc(a,0,f-1))l.qoc&&c++;a=this.rk.ke(4);a.gd(b);b.properties.setValue(tb.a.Lxa,f-c);a.dispose()}}jGc(a,b){if(!b.source.fDa())return a.Zg(Object(C.a)(this,
this.bXa,"pasteTeardown")),!0;a.Zg(Object(C.a)(this,this.vTf,"corePasteIteration"));return!0}bXa(){Me.a.mark(5565);return!1}d8c(){return!nb.GraphIterator.mb(this.m1).Ji()}FSc(){return this.TPd?1===nb.GraphIterator.mb(this.m1).O6a():!1}BCj(){const a=nb.GraphIterator.mb(this.m1);this.FSc()&&a.Ji();return 1===a.O6a()&&(a.Ji(),ae.OutlineElementReader.Ug(a)&&1===a.O6a()&&a.Ab(2))?yb.ParagraphReader.Rk(a)&&!Mh.vH.tSf(a):!1}c1i(){const a=nb.GraphIterator.mb(this.m1);this.FSc()&&a.Ji();a.Ji();a.Ji();Z.ULS.shipAssertTag(6305614,
307,yb.ParagraphReader.Rk(a));return yb.ParagraphReader.text(a.currentNode)}A$f(a){try{return this.u2i(a)}catch(b){return Z.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",b.message),0}}u2i(a){let b=0;if(a&&(b=this.t2i(a),0===b&&a.childNodes))for(let c=0;c<a.childNodes.length&&(b=this.A$f(a.childNodes[c]),0===b);c++);return b}t2i(a){if(1===a.nodeType&&a.getAttribute){a=(a.getAttribute("class")||"").split(" ");for(const b of a)if(b.startsWith(this.FWh))return b.startsWith(this.ZRb)?
this.Ir&&b===this.ZRb+this.Ir?3:2:1}return 0}YCk(a,b,c,f,l){l.CK||(l.CK={});Mh.Pa.raiseEvent("OnParagraphCopy",new lz(a,b,c,f,l.CK))}sDk(a,b,c,f){f.CK||(f.CK={});Mh.Pa.raiseEvent("OnCopyComplete",new lz(a,null,b,c,f.CK))}OCk(a){a.CK||(a.CK={});Mh.Pa.raiseEvent("BeforePaste",new bI(a.CK))}zDk(a,b,c,f,l){Mh.Pa.raiseEvent("OnParagraphPaste",new lz(a,b,c,f,l.CK))}Z1f(a){Se.isTableCell(a)&&(a.Ab(1)||this.Cx.eZ(a,!0),a.yc())}$1f(a,b){this.$Ed.isTableCellNode(b)&&(b.width=a.width)}static get ih(){return Mh.Hf||
(Mh.Hf=fb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Mh.Yg||(Mh.Yg=fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Mh.Hw||(Mh.Hw=fb.a.instance.resolve("Box4.IParagraphEditor"))}static get sN(){const a=fb.a.instance.qb("Box4.IFeatureHelper");return!!a&&a.isFeatureEnabled(79)}static get vH(){return qj.a.instance}static get Ak(){return Pw.PageReader.instance}static lLi(a){const b={};for(const c of uq.a(a)){const f=
a[c];b[f]=f in b?String.format("{0}|{1}",b[f],c):c}1<=uq.a(b).length&&Z.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",b)}static TLk(a,b,c,f,l,x){b.colSpan>l-c&&(x&&x("A",b.colSpan,l-c),b.colSpan=l-c);a=Mh.Nfl(a,b,f,c);b.colSpan!==a&&(x&&x("B",b.colSpan,a),b.colSpan=a)}static ULk(a,b,c,f,l,x){b.rowSpan>l-c&&(x&&x("A",b.rowSpan,l-c),b.rowSpan=l-c);a=Mh.Ofl(a,b,c,f);b.rowSpan!==a&&(x&&x("B",b.rowSpan,a),b.rowSpan=a)}static Nfl(a,b,c,f){return Mh.hth(a,b.colSpan,(l,x)=>{Qd.moveToCell(l,
c,f+x)})}static Ofl(a,b,c,f){return Mh.hth(a,b.rowSpan,(l,x)=>{Qd.moveToCell(l,c+x,f)})}static hth(a,b,c){if(14!==a.type)throw Error.argument("tableNode is not a Table.");if(!c)throw Error.argumentNull("MoveToCellAction");for(let l=1;l<b;l++){var f=nb.GraphIterator.mb(a);c(f,l);f=f.currentNode;if(!f||16!==f.type||!f.isGhostCell)return l}return b}static RRf(a,b){return a+","+b}}Mh.Pa=new ic.a;Mh.Hf=null;Mh.Yg=null;Mh.Hw=null;Mh.BDc=50;Mh.oMf=1225;Mh.Pwj="PasteConstrainingWidth";Object(e.a)(Mh,"InternalClipboard",
null,[]);class lI extends Fj{constructor(a,b,c,f,l,x){super(a,b,c,l);this.Sr=f;this.xyd=x}get nal(){return u.AFrameworkApplication.fa.ka("AutoResizeDragDropImageIsEnabled")}get ph(){return this.xyd.value}get d8c(){return this.Sr.d8c()}get h6g(){const a=this.Sr;return a.TPd&&!a.FSc()}Q2f(a,b){Z.ULS.shipAssertTag(6305616,307,bj.OutlineReader.Lt(a));const c=nq.b(a.currentNode);if(bj.OutlineReader.isEmpty(a)){var f=Mc.a.create(a.currentNode);a.lB(8);u.AFrameworkApplication.Ta.ki(f,E.a.wK,2,!0,null,null)}else a.lB(8);
(f=a.HA(1))&&a.yc();this.Sr.L5g(this.oh.Ef,a.currentNode,f,-1,c,b)}get pug(){return this.Sr.BCj()}get xSf(){return this.Sr.c1i()}P2f(a){const b=new nb.GraphIterator;this.Heb.restore(b);Z.ULS.shipAssertTag(6305618,307,ae.OutlineElementReader.Ug(b));this.oh.i0&&this.oh.i0.rCc("internal");let c=-1;if(this.Iqh&&Object(Ma.a)(10,this.oh.kd))c=this.oh.kd.sa(As.a.oZb,-1);else if(this.nal){const f=this.k3i(b.currentNode);c=f?f.clientWidth:c}this.Sr.L5g(this.oh.Ef,b.parentNode,b.currentNode,c,null,a);this.bxg&&
(this.Heb.restore(b),ae.OutlineElementReader.Ug(b)&&this.Sr.Nzg(b)&&(a=Xb.OutlineElementNavigator.ri(b)))&&(this.oh.Era=rd.SelectionFactory.Mg(a,0))}k3i(a){return a?(a=a?a.oc(this.ph.Ma):null)?a.htmlElement:null:null}vrh(){const a=new nb.GraphIterator;this.Heb.restore(a);return this.Sr.Nzg(a)}get Vqh(){return Ib.ListReader.Ww}get Uqh(){return!this.Sr.sia&&!this.Sr.TPd}}Object(e.a)(lI,"InternalPasteExecutionManager",Fj,[]);class mI{constructor(a,b){this.Sr=a;this.xyd=b}create(a,b,c){return new lI(a,
b,c,this.Sr,Cb.App.Hb.Hd,this.xyd)}}Object(e.a)(mI,"Factory",null,[384]);var mz;(function(a){a[a.unknown=0]="unknown";a[a.differentBox4App=1]="differentBox4App";a[a.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession";a[a.sameBox4AppSameSession=3]="sameBox4AppSameSession"})(mz||(mz={}));Object(e.b)("CopySource",mz);class Mr{constructor(a,b,c){this.Sr=a;this.t8e=b;this.tNh=c}ewk(a,b,c){Z.ULS.shipAssertTag(6305620,307,!!a);Z.ULS.shipAssertTag(6305621,307,cb.SelectionEditor.Pg(b));Z.ULS.shipAssertTag(6305622,
307,!!c);Z.ULS.shipAssertTag(6305623,307,Object(Ma.a)(cp,c.L4));const f=c.L4;f.MOa=this.Sr.A$f(a);this.UYj(a,f);const l=this.Dae(a,b,f);if(l||this.VMe(a,b,f)){var x=new Id.GraphTransaction(7);x.gd(b.node);b.node.zG().graphTransactionOperations.Cha(8);l?(Z.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",f.Iw,f.browserName),a=this.t8e.create(b,f,x)):(Z.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",f.Iw,f.MOa,f.browserName),Mr.NYj(a),a=
this.tNh.create(a,b,f,x));c=new hd.a(c,Object(C.a)(a,a.T5g,"pasteSetup"),null);c.Fl("Paste");c.run()}else f.Era=rd.SelectionFactory.nu(b)}Dae(a,b,c){return!this.Vxg(c)&&3===c.MOa}VMe(){return!0}Vxg(a){return 1===(a.Iw&8192?1:0)}ysg(a,b){Z.ULS.shipAssertTag(6305624,307,cb.SelectionEditor.Pg(a));Z.ULS.shipAssertTag(6305625,307,!!b);Z.ULS.shipAssertTag(6305626,307,Object(Ma.a)(cp,b.L4));const c=new Id.GraphTransaction(7);c.gd(a.node);a=this.t8e.create(a,b.L4,c);b=new hd.a(b,Object(C.a)(a,a.T5g,"pasteSetup"),
null);b.Fl("InternalPasteAtIp");b.run()}UYj(a,b){if(a){let c=!1,f=!1;a.innerHTML&&0<=a.innerHTML.indexOf("mso-tab-count")?f=!0:a.innerText&&0<=a.innerText.indexOf("\t")&&(c=!0);if(c||f)u.AFrameworkApplication.DN("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),Z.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",mz[b.MOa],c,f)}}static NYj(a){a&&Mr.A_h.test(a.innerText)&&Z.ULS.sendTraceTag(6350173,
307,50,"External paste operation starts on WebUrl")}}Mr.A_h=RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$");Object(e.a)(Mr,"PasteCoordinator",null,[]);class pC{constructor(a,b){this.Xj=a;this.c6=b}}Object(e.a)(pC,"PasteFloatieFeatureSetBuilder",null,[]);class eo{constructor(a,b){this.WMb=a;this.WKh=b}get titleText(){return CommonUIStrings.l_ClipboardUseShortcutTitle}get o7f(){return CommonUIStrings.l_ClipboardUseShortcutMessage}get uHc(){return CommonUIStrings.l_ClipboardCut}get Cte(){return CommonUIStrings.l_ClipboardCut_Mac}get hGc(){return CommonUIStrings.l_ClipboardCopy}get Bte(){return CommonUIStrings.l_ClipboardCopy_Mac}get MHa(){return CommonUIStrings.l_ClipboardPaste}get Dte(){return CommonUIStrings.l_ClipboardPaste_Mac}get iwa(){return CommonUIStrings.l_ClipboardPasteText}get Ete(){return CommonUIStrings.l_ClipboardPasteText_Mac}get LOd(){return this.WKh}get qQf(){return CommonUIStrings.l_ClipboardExtensionLink}get AOa(){return CommonUIStrings.l_ClipboardExtensionSuggestion}r3f(){Z.ULS.sendTraceTag(8716421,
307,50,null);ib.a.an(this.LOd,"_blank",void 0,"ClipboardAccessExtensionLink")}t0(a,b){let c=r.a.lk;u.AFrameworkApplication.fa.ka("CcpFixIPadShortcutStringsIsEnabled")&&(c=r.a.Ki||c);return c?String.format(b,"\u2318"):a}dispose(){this.WMb=null}BEe(a){this.mTf(a)}PUj(a){this.mTf(a)}mTf(a){this.WMb&&this.WMb(a)}}eo.id="CopyPasteShortcutDialog";eo.Xxh="CopyPasteText";Object(e.a)(eo,"ACopyPasteShortcutDialog",null,[106]);class nI extends eo{constructor(a,b,c){super(a,b);a=document.createElement("span");
a.className="WACCopyPasteShortcutDialogTextPanel";b=document.createElement("span");b.id=eo.Xxh;var f=document.createElement("span");f.innerText=this.o7f;var l=document.createElement("span");l.className="UIFontBold";l.innerText=this.t0(this.uHc,this.Cte);const x=document.createElement("span");x.className="UIFontBold";x.innerText=this.t0(this.hGc,this.Bte);const G=document.createElement("span");G.className="UIFontBold";G.innerText=this.t0(this.MHa,this.Dte);b.appendChild(f);b.appendChild(document.createElement("br"));
b.appendChild(l);b.appendChild(x);b.appendChild(G);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(r.a.Nj||r.a.eg)&&(c=document.createElement("span"),c.className="UIFontBold",c.innerText=this.t0(this.iwa,this.Ete),b.appendChild(c));a.appendChild(b);this.LOd?(Z.ULS.sendTraceTag(8716420,307,50,null),c=document.createElement("span"),b=document.createElement("a"),b.href="#",b.innerText=this.qQf,Ed.a.addHandler(b,"click",Object(C.a)(this,this.r3f,"extensionLinkHandler")),c.appendChild(b),l=this.AOa.indexOf("{0}"),
-1!==l&&(f=this.AOa.substring(l+3,this.AOa.length),l=document.createTextNode(this.AOa.substring(0,l)),f=document.createTextNode(f),c.insertBefore(l,b),c.appendChild(f)),a.appendChild(document.createElement("br")),a.appendChild(c)):Z.ULS.sendTraceTag(8716422,307,50,null);c=new Di.StandardDialog;c.yd=0;c.ng=eo.id;c.nx(this.titleText,null,0,Object(C.a)(this,this.PUj,"legacyCopyPasteShortcutDialogHandler"),a);c.i5(eo.Xxh)}}Object(e.a)(nI,"CopyPasteShortcutDialog",eo,[]);class oI extends eo{constructor(a,
b){super(a,b);b={};a=this.xCj;b.extensionStartText=this.nQi;b.extensionLink=null;b.extensionEndText=null;b.shortcutsMessageText=this.t$k;b.cutText=this.t0(this.uHc,this.Cte);b.copyText=this.t0(this.hGc,this.Bte);b.pasteText=this.t0(this.MHa,this.Dte);4!==u.AFrameworkApplication.Aa.jb.rm&&(b.pasteTextOnly=this.t0(this.iwa,this.Ete));b={["id"]:"CopyPasteInstallDialog",["bodyControls"]:b};const c=new Lh.a(!1,!1,!0);c.ng="CopyPasteInstallDialog";c.yd=0;c.Ue(1,this.wCj);c.Zwa(1);c.tj(a,Object(C.a)(this,
this.BEe,"reactCopyPasteShortcutDialogHandler"),b)}get t$k(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage}get wCj(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton}get xCj(){return CommonUIStrings.l_ClipboardInstallDialogTitle}get nQi(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessage}}Object(e.a)(oI,"ReactCopyPasteInstallDialog",eo,[]);class pI extends eo{constructor(a){super(a,null);this.ZBg="https://prod.support.services.microsoft.com/en-us/office/troubleshoot-copy-and-paste-errors-in-powerpoint-for-the-web-0dc01da6-6988-40e5-96ea-0567c151ae2f?preview=true";
var b={};a=this.lhk;var c="";let f="";this.messageText&&(c=this.messageText.split(" {")[0],f=this.messageText.split("} ")[1]);b.startText=c;b.endText=f;b.cutText=this.fFi;b.copyText=this.bxi;b.pasteText=this.mwk;b.cutShortcutText=this.t0(this.gFi,this.ick);b.copyShortcutText=this.t0(this.jxi,this.hck);b.pasteShortcutText=this.t0(this.swk,this.kck);b.imageSrc=sp.a.uK("NoClipboardAccessDialogImage.svg");b.imageAltText=this.oDa;b.primaryButtonLabel=this.SEb;this.ZBg&&(Z.ULS.sendTraceTag(527986756,307,
50,"Learn more link is available"),b.learnMoreLink={["type"]:"AppLinkProps",["id"]:"learnMoreLink",["text"]:this.kTa,["onExecute"]:()=>{this.MUj()}});b={["id"]:"CopyPasteNoClipboardAccessDialog",["bodyControls"]:b};c=new Lh.a(!1,!1,!0);c.yd=0;c.ng="CopyPasteNoClipboardAccessDialog";c.tj(a,Object(C.a)(this,this.BEe,"reactCopyPasteShortcutDialogHandler"),b)}get lhk(){return CommonUIStrings.l_NoClipboardAccessDialogTitle}get messageText(){return CommonUIStrings.l_NoClipboardAccessDialogMessage}get kTa(){return CommonUIStrings.l_NoClipboardAccessDialogLearnMoreMessage}get oDa(){return CommonUIStrings.l_NoClipboardAccessDialogImageAltText}get SEb(){return CommonUIStrings.l_DialogOk}get fFi(){return CommonUIStrings.l_CutString}get gFi(){return CommonUIStrings.l_CutShortcut}get ick(){return CommonUIStrings.l_CutShortcut_Mac}get bxi(){return CommonUIStrings.l_CopyString}get jxi(){return CommonUIStrings.l_CopyShortcut}get hck(){return CommonUIStrings.l_CopyShortcut_Mac}get mwk(){return CommonUIStrings.l_PasteString}get swk(){return CommonUIStrings.l_PasteShortcut}get kck(){return CommonUIStrings.l_PasteShortcut_Mac}MUj(){Z.ULS.sendTraceTag(527986757,
307,50,"Learn more link is clicked");ib.a.an(this.ZBg,"_blank",void 0,"learnMoreLink")}}Object(e.a)(pI,"ReactCopyPasteNoClipboardAccessDialog",eo,[]);class qI extends eo{constructor(a,b,c){super(a,b);a={};a.forwardElementText=this.o7f;a.cutText=this.t0(this.uHc,this.Cte);a.copyText=this.t0(this.hGc,this.Bte);a.pasteText=this.t0(this.MHa,this.Dte);c.ka("PasteTextOnlyShortcutDialogIsEnabled")&&(r.a.Nj||r.a.eg)&&(a.pasteTextOnly=this.t0(this.iwa,this.Ete));this.LOd?(Z.ULS.sendTraceTag(40726914,307,50,
null),a.extensionLink={["type"]:"AppLinkProps",["id"]:"extensionLink",["text"]:this.qQf,["onExecute"]:f=>{this.r3f(f)}},c=this.AOa.indexOf("{0}"),-1!==c&&(a.suggestionPrefixElement=this.AOa.substring(0,c),a.suggestionSuffixElement=this.AOa.substring(c+3,this.AOa.length))):Z.ULS.sendTraceTag(40726915,307,50,null);c={["id"]:eo.id,["bodyControls"]:a};a=new Lh.a(!1,!1,!0);a.yd=0;a.ng=eo.id;a.tj(this.titleText,Object(C.a)(this,this.BEe,"reactCopyPasteShortcutDialogHandler"),c)}}Object(e.a)(qI,"ReactCopyPasteShortcutDialog",
eo,[]);class vq{constructor(){this.Moa=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.gC}Mqb(a,b,c=!1,f=!1){Z.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, useInstallDialog={1}",this.Moa,c));f?new pI(a):this.Moa?c?new oI(a,b):new qI(a,b,u.AFrameworkApplication.fa):new nI(a,b,u.AFrameworkApplication.fa)}static get instance(){return vq.Ja||(vq.Ja=new vq)}}vq.Ja=null;Object(e.a)(vq,"CopyPasteShortcutDialogFactory",null,[466]);class rI{constructor(a,b,c,f,l,
x,G){this.G$e=this.AEd=!1;this.CSb=a;this.If=b;this.gha=c;this.Kd=f;this.jd=l;this.kf=x;this.rd=G}get gM(){return this.CSb}get TDa(){return this.G$e}set TDa(a){this.G$e=a;this.kf.yRc=a}Qba(a){this.gM.Qba(a);a||this.RJa(!0)}r4a(a){this.gM.r4a(a)}get rOi(){return this.gM.d5}get YNi(){return this.gM.Px}prepareForPaste(a){this.TDa=!0;this.gM.prepareForPaste(a,!1,this.pRe)}bca(a,b){this.gM.bca(a,!1,b)}reset(){this.TDa=!1}paste(){var a=this.If.Nd;a&&this.Kd.Bf(a.eI);var b=this.gha.nK;if(!b.Lh||!b.editingView.Kl)return null;
a=b.editingView;let c=this.jd.fm();this.TDa=!0;b.oya();b=null;try{a.JBk(),b=c=this.gM.Q5a(this.pRe,c)}catch(f){Z.ULS.shipAssertTag(6305672,307,!1),this.z2b(!0)}this.TDa=!1;return b}copy(){var a=this.If.Nd;a&&this.Kd.Bf(a.eI);a=this.gha.nK;if(!a.Lh||1!==a.editingView.mode)return!1;this.TDa=!0;let b;try{this.gM.WJc(this.pRe),b=!0}catch(c){Z.ULS.shipAssertTag(6305673,307,r.a.eg),Z.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",r.a.zy),b=!1}this.TDa=
!1;return b?!0:!1}RJa(a){if(this.AEd)return!0;var b=this.gha.nK;if(!b.Lh||!b.editingView.Kl)return!1;const c=b.editingView;b=this.jd.fm();this.TDa=!0;const f=new Dg.a(b);let l=!1;try{l=this.gM.RJa(b,()=>{c.Bpi()},()=>{c.MIa()})}catch(x){Z.ULS.shipAssertTag(6305674,307,!r.a.Aj)}f.restore();this.TDa=!1;l?this.AEd=!0:(Z.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",r.a.zy),r.a.Aj||this.z2b(a));return l}z2b(){this.AEd=!1;if(u.AFrameworkApplication.wacCopyPasteShortcutDialogIsEnabled)vq.instance.Mqb(null,
null);else{const a=new Di.StandardDialog;a.yd=0;a.DO(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}}get pRe(){const a=this.jd.CCa();return a?a.Il:null}}Object(e.a)(rI,"SystemClipboard",null,[371]);class qC{constructor(a){this.pjb=2147483647;this.lMb=null;this.Fm=0;this.vLg=!0;this.Tgf=window.navigator.clipboard;this.Ugf=window.navigator.permissions;this.KR=a}getData(a,b){Z.ULS.sendTraceTag(538240020,307,50,"GetData: Started");try{if(this.lMb){var c=this.d1i(this.lMb,
a);c?this.lMb[0].getType(c).then(f=>{"image/png"===c?this.KR.hXb([f],l=>{this.Kxe(l,b,c)}):f.text().then(l=>{l="text/html"===c?this.XUi(l):l;Z.ULS.sendTraceTag(528859362,307,50,"GetData: Retrieved data with type: {0} and size: {1}",c,l.length);b(a,l)}).catch(()=>{this.BW(!1,"getDataFailed");b(a,null)})}).catch(()=>{this.BW(!1,"getDataFailed");b(a,null)}):(this.BW(!1,"unSupportedType"),b(a,null))}else this.BW(!1,"invalidClipboardItems"),b(a,null)}catch(f){this.BW(!1,"getDataFailed"),b(a,null)}}d1i(a,
b){let c=null;a&&0<a.length&&(a=a[0].types,b?c=Array.contains(a,b)?b:null:Array.contains(a,"text/html")?c="text/html":Array.contains(a,"image/png")?c="image/png":Array.contains(a,"text/plain")&&(c="text/plain"));return c}Kxe(a,b,c){a&&this.KR.Vlc&&(a=String.format('<img src="{0}">',a));Z.ULS.sendTraceTag(528818690,307,50,"OnImageConverted: Retrieved data with type: {0} and size: {1}",c,a.length);b("image/png",a)}XUi(a){return this.trim(a,"\n")}trim(a,b){if(!a)return null;let c=0;for(;c<a.length&&
a.charAt(c)===b;)c++;let f=a.length-1;for(;f>c&&a.charAt(f)===b;)f--;return a.substr(c,f-c+1)}WTe(a,b,c){this.lMb=b;a(c)}Wmd(a){try{this.lMb=null,this.Tgf.read().then(b=>{let c;this.Fm&&(c=Date.now()-this.Fm,Z.ULS.sendTraceTag(526952409,307,50,"Time taken to read data: {0}",c));this.BW(!0,"none");this.WTe(a,b,!0)},()=>{this.BW(!1,"clipboardReadFailed");this.WTe(a,null,!1)}).catch(()=>{this.BW(!1,"clipboardReadFailed");this.WTe(a,null,!1)})}catch(b){this.BW(!1,"clipboardReadNotSupported"),a(!1)}}YOf(a,
b){this.vLg=a?!0:!1;if(this.Tgf)if(this.Ugf)try{this.Ugf.query({name:"clipboard-read"}).then(c=>{c?(c=c.state,"granted"===c?(this.Fm=Date.now(),this.Wmd(b)):"prompt"===c&&a?this.Wmd(b):(this.BW(!1,"permissionDenied"),b(!1))):(this.BW(!1,"invalidPermissionStatus"),b(!1))},()=>{this.BW(!1,"permissionQueryFailed");a?this.Wmd(b):b(!1)}).catch(()=>{this.BW(!1,"permissionQueryFailed");b(!1)})}catch(c){this.BW(!1,"permissionQueryNotSupported"),b(!1)}else this.BW(!1,"navigatorPermissionNotSupported"),a&&
this.Wmd(b);else this.BW(!1,"navigatorClipboardNotSupported"),b(!1)}BW(a,b){const c={};c.AsyncAPISuccess=a.toString();c.IsPasteEvent=this.vLg;"none"!==b&&(c.AsyncAPIFailureReason=b);Z.ULS.sendTraceTag(522814493,307,50,JSON.stringify(c))}}Object(e.a)(qC,"AsyncClipboardAPI",null,[]);class nz{constructor(){this.pptObjectData=this.pptObjectMetaData=this.pptSlide=this.text=this.html=this.img=null;this.isImageAvailable=!1}}Object(e.a)(nz,"ExtensionClipboardData",null,[]);class sI{constructor(a,b,c,f){this.D1=
this.Bz=this.Cef=this.ooa=null;this.jrc=a.ka("ChromeClipboardAccessExtensionSuggestionIsEnabled");a.ka("ChromeClipboardAccessRichFormatContentIsEnabled");a.ka("ChromeSingleTextRunCopyImprovementIsEnabled");this.GOh=a.Ga("ChromeClipboardAccessExtensionLink");this.vLa=b;this.Xj=c;this.rTh=a.Ga("ChromeClipboardAccessExtensionId");this.KR=f;this.g1=new qC(this.KR);this.zNb=null;this.J3e=a.ka("EnhancedTextCCPEnabled");this.M8e=l=>!!l.tagName&&"a"===l.tagName.toLowerCase()}Qba(a){a?this.Bz=!0:(this.D1=
this.Bz=null,chrome.runtime&&chrome.runtime.sendMessage?(this.zNb=this.vLa.oNc(),this.vLa.ixa?this.NOf(!0,null):(this.Bz=!0,Z.ULS.sendTraceTag(19256732,307,50,Ga.a.create().toString()))):this.g1?this.bqb(!0,null):(this.WAe(),this.Bz=!1))}r4a(a){this.D1=this.Bz=null;chrome.runtime&&chrome.runtime.sendMessage?(this.zNb=this.vLa.oNc(),this.vLa.ixa?this.NOf(!1,a):(this.Bz=!0,Z.ULS.sendTraceTag(19256732,307,50,Ga.a.create().toString()),a(this.d5))):this.g1?this.bqb(!1,a):(this.Bz=!1,a(this.d5))}get d5(){return this.Bz}get Px(){return this.D1}RJa(){return!0}WJc(a){Z.ULS.sendTraceTag(24402115,
307,50,"Execute chrome copy");ib.a.P5a(a,"copy")||Z.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))}Q5a(a,b){this.ooa&&(a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.ooa,b=a.body,this.ooa=null);return b}n3i(a){var b=this.Xj.gfg(a.html);if(null!=b&&""!=b)return b;b=a.img;if(null!=b&&""!=b)return b;a=a.text;if(null!=a&&""!=a)return a}R$f(a,b){const c=Ga.a.create();this.Cef=c;this.vLa.ixa?
Z.ULS.sendTraceTag(7377737,307,50,c.toString()):Z.ULS.sendTraceTag(19256735,307,50,c.toString());const f={};f.command=b;chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(this.zNb,f,l=>{c.equals(this.Cef)?this.ooa=this.J3e?this.n3i(l):l:Z.ULS.sendTraceTag(7385868,307,50,null);Z.ULS.sendTraceTag(7377738,307,50,c.toString());chrome.runtime.lastError&&(this.hLi(),this.vLa.ixa?Z.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):Z.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message));
a(l)}):(Z.ULS.sendTraceTag(509666774,307,10,"ChromeApi.RuntimeSendMessage not supported"),a(null))}prepareForPaste(a,b){const c=()=>{a(!1)},f=(l,x)=>{this.ooa=x;a(!0)};null!=this.Px&&this.Px?this.g1.getData(b?"image/png":null,f):this.R$f(c,this.J3e?"getClipboardData":"paste")}bca(a,b,c){a=(f,l)=>{const x=new nz;"image/png"==f?x.img=l:x.html=l;c(x)};null!=this.Px&&this.Px?this.g1.getData(b?"image/png":null,a):this.R$f(c,"getClipboardData")}WAe(){Z.ULS.sendTraceTag(8716423,307,50,null);vq.instance.Mqb(Object(C.a)(this,
this.kzk,"popupInstallDialogHandler"),this.jrc?this.GOh+this.zNb:null)}kzk(a){1===a?Z.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this.jrc)):0===a&&Z.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this.jrc))}hzk(){Z.ULS.sendTraceTag(509666773,307,50,null);vq.instance.Mqb(Object(C.a)(this,this.izk,"popupClipboardAccessDialogHandler"),null,!1,!0)}izk(){Z.ULS.sendTraceTag(509666772,307,50,String.format("ClipboardAccessDialog OK Clicked",this.jrc))}hLi(){this.vLa.rHe();
this.WAe()}Rlh(a,b){const c={command:"test",object:"ping"};chrome.runtime&&chrome.runtime.sendMessage?chrome.runtime.sendMessage(a,c,b):(Z.ULS.sendTraceTag(509666771,307,10,"ChromeApi.RuntimeSendMessage not supported"),b(null))}bqb(a,b){Z.ULS.sendTraceTag(509666770,307,50,"CheckAsyncClipboardApiSupport");this.g1.YOf(a,c=>{this.D1=c;this.Bz=this.Px;a&&this.sdl();b&&b(this.d5)})}sdl(){null==this.Px||this.Px||this.hzk()}NOf(a,b){const c=Ga.a.create();Z.ULS.sendTraceTag(7726105,307,50,c.toString());this.Rlh(this.zNb,
f=>{Z.ULS.sendTraceTag(7726106,307,50,c.toString());f&&"ping"===f?this.Bz=!0:(f?"ping"!==f&&Z.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",f,chrome.runtime.lastError?chrome.runtime.lastError.message:null):Z.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null),this.g1?this.bqb(a,b):(a&&this.WAe(),this.Bz=!1));b&&b(this.d5)})}tDg(a,b){const c={};c.OfficeOnlineExtensionInstallationStatus=
a;c.OfficeClipboardExtensionInstallationStatus=b;Z.ULS.sendTraceTag(51144839,307,50,JSON.stringify(c))}iYj(){if(chrome.runtime&&chrome.runtime.sendMessage){var a=!this.vLa.ixa;this.Rlh(this.rTh,b=>{this.tDg(a,!!b)})}else this.tDg(!1,!1)}}Object(e.a)(sI,"ChromeSystemClipboardAccessManager",null,[370]);class tI{constructor(a,b,c,f){this.D1=this.Bz=this.Azc=this.ooa=this.g1=null;this.rd=a;this.eb=b;this.eZe=!this.eb.ka("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this.eb.ka("BlockCopyCutOnFirefoxIsEnabled");
this.KR=c;this.Xj=f;this.czd=b.Cc("ClipboardDataImageBlobLimitaton",10);r.a.CQe||(this.g1=new qC(this.KR))}Qba(a){this.eZe&&a&&this.rd.eg?(vq.instance.Mqb(null,null),this.Bz=!1):(this.Bz=!0,this.D1=!1,this.g1&&(this.D1=this.Bz=null,this.bqb(!0,null)))}r4a(a){this.eZe&&this.rd.eg&&(this.Bz=!1,a(this.d5));this.Bz=!0;this.D1=!1;this.g1?(this.D1=this.Bz=null,this.bqb(!1,a)):a(this.d5)}bqb(a,b){Z.ULS.sendTraceTag(512356674,307,50,"CheckAsyncClipboardApiSupport");this.g1.YOf(a,c=>{this.D1=c;this.Bz=this.Px;
a&&this.Ncl();b&&b(this.d5)})}Ncl(){null==this.Px||this.Px||this.gzk()}gzk(){vq.instance.Mqb(null,null)}get d5(){return this.Bz}get Px(){return this.D1}WJc(a){ib.a.P5a(a,"copy")}Q5a(a,b){if(this.ooa&&null!=this.Px&&this.Px)return a=document.implementation.createHTMLDocument("doc"),a.body.innerHTML=this.ooa,b=a.body,this.ooa=null,b;const c=Date.now(),f=ib.a.P5a(a,"paste");b&&""===b.innerHTML&&(this.$0i(a),b.innerHTML=this.Azc?this.Azc:"",this.Azc="");Z.ULS.sendTraceTag(512356673,307,50,"ExecutePasteCommand: time taken: {0}, result: {1}",
Date.now()-c,f);return b}$0i(a){const b=c=>{if(c){c=c.clipboardData;const f=this.Xj.Q0b(c);this.Azc=f&&""!==f?f:this.Xj.f2d(c)}};window.addEventListener("paste",b,!1);ib.a.P5a(a,"paste");window.removeEventListener("paste",b,!1)}prepareForPaste(a,b){const c=(f,l)=>{this.ooa=l;a(!0)};null!=this.Px&&this.Px?this.g1.getData(b?"image/png":null,c):a(!1)}bca(a,b,c){if(c){var f=(l,x)=>{const G=new nz;"image/png"==l?G.img=x:G.html=x;c(G)};null!=this.Px&&this.Px?this.g1.getData(null,f):r.a.CQe&&this.a1i(a,
b,c)}else Z.ULS.sendTraceTag(512356672,307,10,"GetClipboardData: null callback")}a1i(a,b,c){Z.ULS.sendTraceTag(512356643,307,50,"GetClipboardDataViaExecCommand: called");a=a.contentWindow.document;ya.a.ku(a.body);try{const f=l=>{const x=new nz;l=l.clipboardData;if(b){var G=null;({H3b:G}=this.Xj.Pmd(l,this.czd,this.KR.ndc));G&&0<G.length&&(x.isImageAvailable=!0)}else G=this.Xj.getData(l,"ppt/slides"),x.pptSlide=G,G&&""!==G||(l=(G=this.Xj.Q0b(l))&&""!==G?G:this.Xj.f2d(l),x.html=l);c(x)};a.addEventListener("paste",
f,!1);ib.a.P5a(a,"paste");a.removeEventListener("paste",f,!1)}catch(f){Z.ULS.sendTraceTag(512356642,307,10,"GetClipboardDataViaExecCommand: failed to extract the data using exec command with exception : {0}",f)}}RJa(a,b,c){if(this.rd.QS&&!this.eb.ka("ElectronClipboardAccessFix"))return this.Bz=!1;b();c();a=this.Q5a(a.ownerDocument,a);b=a.innerHTML;a.innerHTML=zh.a.create().toString();c();a=this.Q5a(a.ownerDocument,a);a=b===a.innerHTML;this.g1?a&&(this.Bz=!0):this.Bz=a;return a}}Object(e.a)(tI,"DefaultSystemClipboardAccessManager",
null,[370]);class uI{constructor(a,b,c,f){this.D1=this.Bz=this.dV=this.qmb=this.A6=this.yza=this.mrc=null;this.Xj=b;this.KR=c;this.czd=a.Cc("ClipboardDataImageBlobLimitaton",10);this.bQh=a.ka("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled");this.SMh=f;this.jXh=a.ka("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}Qba(a){this.jXh&&a&&(this.Bz=!0);this.D1=!1}r4a(a){a(!0)}get d5(){return this.Bz}get Px(){return this.D1}WJc(a){a&&ib.a.P5a(a,ma.a.copy)}Q5a(a,b){this.yza&&(b=this.yza,this.yza=null);
return b}bca(a,b,c){c?c(null):Z.ULS.sendTraceTag(540553600,307,10,"GetClipboardData null callback")}prepareForPaste(a,b,c=null){if(a&&c){this.mrc=a;this.qmb=c;$addHandler(this.qmb,ma.a.paste,Object(C.a)(this,this.m1g,"onPasteEvent"));this.dV=this.A6=null;this.bQh&&this.SMh.RZb();if(this.Xmd(this.qmb)){if(this.dV&&0<this.dV.length&&(!this.A6||this.Xj.mod(this.A6))){this.KR.hXb(this.dV,Object(C.a)(this,this.Kxe,"onImageConverted"));this.yza&&!this.yza.hasChildNodes()&&Z.ULS.sendTraceTag(42592151,307,
50,"pastedContentDom has no child nodes.");return}this.A6&&this.A6.innerHTML&&((this.yza=this.Smg(this.A6.innerHTML))&&!this.yza.hasChildNodes()&&Z.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),ya.a.ku(this.A6))}this.L5f()}else a&&a(!1)}RJa(a){return this.Bz=a=this.Xmd(a.ownerDocument)}m1g(a){try{a&&a.rawEvent&&((this.A6=a.rawEvent.target)&&this.A6.id&&-1<this.A6.id.indexOf("Paste")?(Z.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this.A6.id),
this.A6=null):this.dV=this.X6i(a.rawEvent))}catch(b){Z.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+b.toString())}}Kxe(a){a&&(this.KR.Vlc&&(a=String.format('<img src="{0}">',a)),this.yza=this.Smg(a));this.L5f()}L5f(){this.qmb&&($removeHandler(this.qmb,ma.a.paste,Object(C.a)(this,this.m1g,"onPasteEvent")),this.qmb=null);this.mrc&&(this.mrc(!1),this.mrc=null)}X6i(a){let b=null;(a=this.Xj.d_d(a))&&({H3b:b}=this.Xj.Pmd(a,this.czd,this.KR.ndc));return b}Xmd(a){return ib.a.P5a(a,
ma.a.paste)}Smg(a){const b=document.implementation.createHTMLDocument("doc");b.body.innerHTML=a;return b.body}}Object(e.a)(uI,"EdgeSystemClipboardAccessManager",null,[370]);class vI{constructor(a,b,c,f){this.eb=a;this.TKh=b;this.Xj=c;this.rd=f}create(){var a=null;a=this.rd.QS&&this.eb.ka("ElectronClipboardAccessFix"),u.AFrameworkApplication.pjd()&&this.rd.Nj&&window.chrome&&!a?(Z.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),a=new sI(this.eb,this.TKh,this.Xj,fb.a.instance.resolve("Box4.IProcessImageStrategy")),
this.eb.ka("LogChromeExtensionInstallationStatusIsEnabled")&&a.iYj()):this.eb.ka("EdgeContextMenuPasteFixIsEnabled")&&this.rd.io?(Z.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),a=new uI(this.eb,fb.a.instance.resolve("Box4.IClipboardDataHelper"),fb.a.instance.resolve("Box4.IProcessImageStrategy"),fb.a.instance.resolve("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy"))):(Z.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),a=new tI(this.rd,this.eb,
fb.a.instance.resolve("Box4.IProcessImageStrategy"),this.Xj));return a}}Object(e.a)(vI,"SystemClipboardAccessManagerFactory",null,[369]);class wI{C2f(a){return a}}Object(e.a)(wI,"DeleteTableSegmentStrategy",null,[373]);var KP=d(1177),LP=d(627);class wq{constructor(a,b){this.Nk=new D.DictionaryPropertySet;this.Iwd=!1;this.bha=this.Pga=this.X_a=null;this.bV=a;this.ZNh=b}get yZa(){return this.bha||(this.bha=fb.a.instance.qb("Box4.ITextFormattingCommands"))}get ih(){return wq.Hf||(wq.Hf=fb.a.instance.resolve("Box4.IFormattingEditor"))}SXa(){this.Iwd||
(this.Nk.HFe(),this.X_a=null,this.dQk())}ixi(a){a=vb.a.Ls(a);if(!a.cache.Qs){var b=a.Iz;if(b){var c=new D.DictionaryPropertySet;c.Jx(b);c.Jx(this.Nk);c.Sa(Kg.a.e2)&&(this.X_a=a.paragraph.Fh);this.Nk=c}}}Sa(a){return this.Nk.Sa(a)}f6d(){return 0<this.Nk.k1}get G8a(){return this.Nk}freeze(){this.Iwd=!0}eSe(){this.Iwd=!1}kI(a,b){return this.G8a.sa(a,b)}Jr(a){this.Nk.setValue(tb.a.fontSize,this.ih.XWb(a));this.cR()}fontSize(){return this.Nk.sa(tb.a.fontSize,ad.Font.$H)}Ahd(a){this.Nk.setValue(tb.a.font,
a);this.ZNh.Ahd(this.Nk,a);this.bV&&this.bV.enabled&&(ze.c(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this.bV.CGl(this.Nk,a));this.cR()}hJa(a){this.Nk.setValue(Mb.a.FU,a);this.bV&&this.bV.enabled&&(ze.c(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this.bV.HGl(this.Nk,a));this.cR()}gt(a){a=LP.a.instance.bPd(qd.a.instance.Oa.kb.Ua.node,a);this.Nk.setValue(tb.a.fontColor,a);this.cR()}GV(){this.Nk.setValue(tb.a.fontColor,Hb.a.auto);this.cR()}fontColor(){return this.Nk.sa(tb.a.fontColor,
Hb.a.nil)}lna(a){this.Nk.setValue(tb.a.highlight,parseInt(a,16));this.cR()}mWb(){this.Nk.setValue(tb.a.highlight,Hb.a.auto);this.cR()}isBold(){return this.Nk.sa(tb.a.bold,!1)}xJ(a){this.Nk.setValue(tb.a.bold,a);this.cR()}isItalic(){return this.Nk.sa(tb.a.italic,!1)}setItalic(a){this.Nk.setValue(tb.a.italic,a);this.cR()}GD(){return this.Nk.sa(tb.a.underline,!1)}E0(a){this.Nk.setValue(tb.a.underline,a);this.Nk.setValue(tb.a.Cw,a?ad.Font.pnd:ad.Font.LU);this.cR()}Cw(){return this.Nk.sa(tb.a.Cw,ad.Font.LU)}qna(a){a<
ad.Font.pnd||a>ad.Font.LU||(this.Nk.setValue(tb.a.underline,a!==ad.Font.LU),this.Nk.setValue(tb.a.Cw,a),this.cR())}isSuperscript(){return this.Nk.sa(tb.a.superscript,!1)}eY(a){this.Nk.setValue(tb.a.superscript,a);a&&this.isSuperscript()&&this.Nk.setValue(tb.a.subscript,!1);this.cR()}sF(){return this.Nk.sa(tb.a.subscript,!1)}k5(a){this.Nk.setValue(tb.a.subscript,a);a&&this.sF()&&this.Nk.setValue(tb.a.superscript,!1);this.cR()}rF(){return this.Nk.sa(tb.a.strikethrough,!1)}cY(a){this.Nk.setValue(tb.a.strikethrough,
a);this.cR()}TZ(){return this.Nk.sa(Kg.a.Js,!1)}Hgb(a){this.Nk.setValue(Kg.a.Js,a);this.cR()}N9f(){return this.Nk.sa(Kg.a.e2,null)}dfa(a,b){this.Nk.HFe();this.Nk.setValue(Kg.a.e2,a.id);this.X_a=b.Fh;this.cR()}qU(a){let b=tb.a.Rs;if(H.a.instance.ga(13)){const c=KP.a.W6b(a);switch(c){case 1:b=Mb.a.jxb;break;case 2:b=Mb.a.kxb}this.Nk.setValue(Mb.a.languageHint,c)}this.Nk.setValue(b,a);this.cR()}language(){let a=tb.a.Rs;if(H.a.instance.ga(13))switch(this.Nk.sa(Mb.a.languageHint,0)){case 1:a=Mb.a.jxb;
break;case 2:a=Mb.a.kxb}return this.Nk.sa(a,0)}F5k(a){this.Nk.setValue(wq.yve,a);this.cR()}HSa(){return this.Nk.sa(wq.yve,!1)}ILj(){return this.Nk.Sa(wq.yve)}xKj(){return H.a.instance.ga(13)?this.Nk.Sa(tb.a.Rs)||this.Nk.Sa(Mb.a.jxb)||this.Nk.Sa(Mb.a.kxb):this.Nk.Sa(tb.a.Rs)}cR(){if(r.a.gJb){var a=qd.a.instance.Oa.kb.Ua,b=a.node;if(b===this.Pga)this.Pga.kv(16,!0);else{this.Pga=b;b=this.Pga.sZa();try{this.Pga.Qrb(a.Qa).m3=!0}finally{b&&b.dispose()}}}}dQk(){if(r.a.gJb&&this.Pga){var a=0,b=this.Pga.sZa();
try{for(let c=this.Pga.Ra.length-1;0<=c;c--){const f=this.Pga.Ra.ga(c);f.m3&&(f.m3=!1,a++,f.isEmpty&&this.Pga.Ra.removeAt(c))}}finally{b&&b.dispose()}this.Pga=null}}Rvi(a){if(a.Qa!==a.Kb)return!1;a=a.node.Ra.yS(a.Qa);return!!a&&a.m3}Dai(a){if(this.yZa){this.freeze();var b=new Id.GraphTransaction(7);b.gd(a.node);this.yZa.mHb(a);this.eSe();this.SXa();b.dispose()}}w1b(a){const b=yb.ParagraphReader.text(a.node);return a.Qa&&a.Qa!==b.length&&!Ka.a.Oy(b.charCodeAt(a.Qa))&&Wr.a.instance.yNc(b,a.Qa-1)!==
a.Qa&&cb.SelectionEditor.Kwb(a)?(a=cb.SelectionEditor.UPa(a,!1))?1<a.length||cb.SelectionEditor.Vj(a.Ua)?a:null:null:null}static get yve(){return H.a.instance.ga(20)?Mb.a.noProof:Oc.a.Dva}}wq.Hf=null;Object(e.a)(wq,"InsertionPointFormatting",null,[436]);class xI{constructor(a){this.Ca=a}get kn(){return this.Ca}Ihi(a){return 32===this.kn.La(E.a.KO,2,a)}numbering(a){return 32===this.kn.La(E.a.lR,2,a)}}Object(e.a)(xI,"ListCommands",null,[385]);class rC{constructor(a){this.ef=a}p4a(a){a=Object(ua.a)(gC.a,
a);return!!a&&!!a.view&&a.view.Lh}q9g(){return!0}nCe(){return!0}r9g(){}tuh(a){if(a.Vq)return!0;a=a.role;return 1===a||2===a||3===a||4===a||5===a}Pbj(a){if(!a||!this.ef)return a;const b=new tn.a;b.set(a);if(this.ef.kt(b)){for(;!b.Vq;)b.yc();return b.currentNode}return a}}Object(e.a)(rC,"SimpleProofingWholeDocumentCallBacks",null,[461]);class yI{constructor(a){this.value=a}}Object(e.a)(yI,"RefBool",null,[]);class oz{constructor(){this.QJc=this.TCb=null;this.RBh=new yI(!1)}}Object(e.a)(oz,"FindNextErrorOperationParam",
null,[]);class zI extends rC{constructor(a,b){super(b);this.wm=a}q9g(a,b){return!this.xee(a.node,a.Qa,b)}nCe(a,b){return!this.xee(a,0,b)}r9g(a,b){this.xee(a.node,0,b);Object(ua.a)(oz,b)}xee(a,b,c){c=Object(ua.a)(oz,c);if(yb.ParagraphReader.Vd(a)&&!a.iW)if(vb.a.Ls(Mc.a.ak(a,b)).cache.HSa)c.RBh.value=!0;else{const f=u.AFrameworkApplication.fa.ka("SkipIgnoredProofingErrorsFromRibbon"),l=this.wm.iF(a);for(let x=0;x<l.length;x++){const G=l[x],R=f&&G.Gh.vae();if(G.begin>=b&&!R)return c.TCb=G,c.QJc=a,!0}}return!1}}
Object(e.a)(zI,"FindNextErrorCallbackSteps",rC,[]);class AI extends zs.a{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){super();this.xmb=this.Hi=this.Mya=null;this.init(a);this.Fl(Wa);this.qDa(R,b,f,l,x);this.NU=x;this.Qu=c;this.Qc=fa;this.ef=wa;this.fpa=G;this.MH=0}run(){this.p4a();0===this.MH&&this.pMe();1===this.MH&&this.xCe();2===this.MH&&this.uRe();3===this.MH&&this.SXd()}p4a(){this.Qc.Oa&&this.Qc.Oa.kb?1===this.behavior&&(this.fpa.p4a(this.Qu)?this.rp=32:this.rp=2,this.MH=3):(Z.ULS.sendTraceTag(20321351,
324,15,"No selection for ignore all"),this.rp=2,this.MH=3)}pMe(){this.Ygi();this.wgi();this.MH=1}xCe(){this.Ez||new hd.a(this,Object(C.a)(this,this.ZCk,"processCurrentNodeAtBegin"),this.NU);do if(this.Ez.run(),this.Ez.inProgress&&!this.Xi)return;while(this.Ez.inProgress);this.IEc();this.MH=2}uRe(){this.rp=32;this.MH=3}SXd(){this.$X()}ZCk(a,b){b=this.fpa.q9g(this.Mya,b);a.Zg(Object(C.a)(this,this.uXi,"fromHereToEnd"));return b}uXi(a,b){if(this.Hi.moveNext())return a=this.Hi.currentNode,12!==a.type||
a===this.Mya.node?!0:this.fpa.nCe(a,b);this.nhi();a.Zg(Object(C.a)(this,this.EXi,"fromStartToHere"));return!0}EXi(a,b){if(this.Hi.moveNext()){const c=this.Hi.currentNode;return 12!==c.type?!0:c===this.Mya.node?(a.Zg(Object(C.a)(this,this.$Ck,"processCurrentNodeAtEnd")),!0):this.fpa.nCe(c,b)}return!1}$Ck(a,b){this.fpa.r9g(this.Mya,b);return!1}Ygi(){let a=this.Qc.Oa.kb;if(a=this.ef.Hl(a,!0,!1))this.Mya=a.Ua;this.Mya&&this.Mya.node&&(this.xmb=this.fpa.Pbj(this.Mya.node))}wgi(){if(!this.xmb)throw Error.argumentNull("_proofingWholeDocumentRootNode");
const a=new tn.a;a.set(this.Mya.node);a.pc(this.xmb.type);this.Hi=ox.a.o2(a,this.xmb);this.Hi.Sl(Object(C.a)(this.fpa,this.fpa.tuh,"spellErrorFilter"),null)}nhi(){if(!this.xmb)throw Error.argumentNull("_proofingWholeDocumentRootNode");const a=new tn.a;a.set(this.xmb);this.Hi=ox.a.Xu(a);this.Hi.Sl(Object(C.a)(this.fpa,this.fpa.tuh,"spellErrorFilter"),null)}}Object(e.a)(AI,"ProofingWholeDocumentOperation",zs.a,[]);class sC{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc){this.Ca=b;this.wm=a;this.vRh=
c;this.Yg=f;this.rk=l;this.Qc=x;this.xm=G;this.ef=R;this.o2a=fa;this.dD=wa;this.hd=Wa;this.Luc=Kb.Cbe;this.Psf=nc;this.QO=oc;this.jqc=new Vb.a;this.jqc.$(1,E.a.uuh);this.jqc.$(2,E.a.Lig);this.jqc.$(3,E.a.Gvh);this.Mxc=new Vb.a;this.Mxc.$(1,E.a.vuh);this.Mxc.$(2,E.a.Mig);this.Mxc.$(3,E.a.Hvh)}ub(){const a=this.Ca,b=Object(C.a)(this,this.sxi,"correctError"),c=Object(C.a)(this,this.bri,"collapseIp");a.pa(E.a.Lsk,Bb.a.view,Object(C.a)(this,this.Msk,"openLanguageDialogView"),1028);a.ya(E.a.nPa,Bb.a.Of,
Object(C.a)(this,this.nPa,"deleteRepeatedWord"));a.ya(E.a.Asa,Bb.a.Of,Object(C.a)(this,this.Asa,"ignoreSpellingError"));a.ya(E.a.Mxa,Bb.a.Of,b);a.ya(E.a.Nxa,Bb.a.Of,b);a.ya(E.a.Oxa,Bb.a.Of,b);a.ya(E.a.MJa,Bb.a.Of,b);a.ya(E.a.NJa,Bb.a.Of,b);a.ya(E.a.nPa,Bb.a.view,c);a.ya(E.a.Asa,Bb.a.view,c);a.ya(E.a.Mxa,Bb.a.view,c);a.ya(E.a.Nxa,Bb.a.view,c);a.ya(E.a.Oxa,Bb.a.view,c);a.ya(E.a.MJa,Bb.a.view,c);a.ya(E.a.NJa,Bb.a.view,c);a.he(E.a.nPa,1028);a.he(E.a.Asa,1028);a.he(E.a.Mxa,1028);a.he(E.a.Nxa,1028);a.he(E.a.Oxa,
1028);a.he(E.a.MJa,1028);a.he(E.a.NJa,1028);a.ya(E.a.nld,xd.a.frame,Kd.ActionManager.Hg);this.Luc&&a.pa(E.a.UAe,Bb.a.view,Object(C.a)(this,this.UAe,"populateProofingSecondaryMenu"),1124);u.AFrameworkApplication.fa.ka("WordEditorIdeasIsEnabled")&&u.AFrameworkApplication.fa.ka("WordEditorIdeasCardsIsEnabled")||a.pa(E.a.V7c,Bb.a.view,Object(C.a)(this,this.RTi,"findNextProofingError"),1028);this.PNk([E.a.Rhl,E.a.uuh,E.a.vuh,E.a.ilj,E.a.Lig,E.a.Mig,E.a.Zjl,E.a.Gvh,E.a.Hvh])}PNk(a){for(let b=0;b<a.length;b++)this.Ca.pa(a[b],
Bb.a.view,Kd.ActionManager.$u,1028)}bri(a,b,c,f,l){b=this.Qc.Oa.kb;if(!b)return this.hd.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),2;b=this.ef.Hl(b,!0,!1);return this.Ca.ki(b.Ua,a,c,!1,f,l)}Msk(a,b,c){if(1===c)return this.Ca.processAction(E.a.qU,1);this.vRh().gmc();return 32}QTe(a){return a?a.Gh?!1:(Z.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this.hd.Tb(Nd.a.c6a,{["Reason"]:"ErrorRangeMissingErrorDetails"}),Me.a.mark(4671),!0):(Z.ULS.sendTraceTag(7660828,
324,10,"Ignore Spelling Error: No flagged word"),this.hd.Tb(Nd.a.c6a,{["Reason"]:"RequestedErrorRangeNotFound"}),Me.a.mark(4671),!0)}nPa(a,b,c){if(1===c)return 32;Me.a.mark(4670);c=this.wm.KQa(b);if(this.QTe(c))return 8;b=b.node;const f=this.rk.ke(15);let l=c.begin;" "===yb.ParagraphReader.text(b).charAt(l-1)&&l--;f.gd(b);const x=this.Yg.replaceTextRange(Mc.a.createTextRange(b,0<c.begin?c.begin-1:0,c.end),"",!0,!1);this.Qc.setSelection(rd.SelectionFactory.Mg(b,x+l));f.dispose();c.Gh.dKa(a);Me.a.mark(4671);
return 32}KZj(a){let b;({value:b}=this.Mxc.Rf(a.Gh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}Asa(a,b,c){if(1===c)return 32;Z.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred");Me.a.mark(4670);c=this.wm.KQa(b);if(this.QTe(c))return 8;b=b.node;const f=this.rk.ke(15);f.gd(b);this.wm.tIa(b,[c],!0);b.setValue(tb.a.nSf,!0);f.dispose();c.Gh.dKa(a,1);Me.a.mark(4671);Z.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded");this.KZj(c);return 32}y2i(a){switch(a){case E.a.Mxa:return 0;
case E.a.Nxa:return 1;case E.a.Oxa:return 2;case E.a.MJa:return 3;case E.a.NJa:return 4;default:return-1}}gXj(a){let b;({value:b}=this.jqc.Rf(a.Gh.proofingType,0)).returnValue&&this.Ca.processAction(b,2)}sxi(a,b,c){var f=!0;this.QO.ga(14)&&(f=!this.dD.Xsa(b));this.xm&&this.xm.instance&&this.xm.instance.lW(b)&&(f=!1);if(1===c||!f)return f?32:8;this.Ca.processAction(E.a.nld,2);Me.a.mark(4670);f=this.y2i(a);if(0>f)return 8;c=this.wm.KQa(b);if(this.QTe(c))return 8;b=b.node;var l=c.Gh.suggestions;if(!l)return this.hd.Tb(Nd.a.c6a,
{["Reason"]:"NoSuggestionsFound"}),Me.a.mark(4671),8;f=f<l.length?l[f]:null;if(!f)return this.hd.Tb(Nd.a.c6a,{["Reason"]:"RequestedSuggestionIsNull"}),Me.a.mark(4671),8;this.QO.ga(50)&&Cb.App.Ih.Zv&&Cb.App.Ih.pY.Opa(b);f=f.replace("  "," \u00a0");l=this.rk.ke(15);l.gd(b);const x=this.Yg.replaceTextRange(Mc.a.createTextRange(b,c.begin,c.end),f,!0,!1,E.a.nld);this.Qc.setSelection(rd.SelectionFactory.Mg(b,c.begin+f.length+x));l.dispose();c.Gh.dKa(a);Me.a.mark(4671);this.gXj(c);return 32}D_k(a,b,c,f){a.Rwa();
(a=c.oc(a.Ma))?(f=O.a.Bt(a,u.AFrameworkApplication.isRtl?f.begin:f.end),this.o2a.B$(new Sys.UI.Point(f.x,f.y+f.height),b)):Z.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")}RTi(a,b,c,f,l){if(!b.view.Lh)return 2;const x=b.view;if(!this.Qc.Oa.kb)return this.hd.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),2;if(1===c)return 32;const G=new oz,R=new zI(this.wm,this.ef);b=new AI(null,a,b,c,f,G,R,this.Ca,this.Qc,this.ef,null);b.Xi=!0;b.run();if(b.isCompleted&&G.TCb){if(b=rd.SelectionFactory.Mg(G.QJc,
G.TCb.begin),b=rd.SelectionFactory.bN(b,Mc.a.ak(G.QJc,G.TCb.end)),!this.Psf.instance||!this.Psf.instance.bGl(G.TCb,b,x)){this.Qc.setSelection(b);let fa=0;l&&(fa=l.jv);x.fjd=!1;El.a.instance.Cb(new xe.a(1,1,1,()=>{this.D_k(x,fa,G.QJc,G.TCb)}))}}else{const fa=new Di.StandardDialog;fa.yd=0;Cb.App.kR.tce?fa.whb(CommonUIStrings.l_DefaultDialogTitle,G.RBh.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(fa.whb(CommonUIStrings.l_DefaultDialogTitle,
Box4Intl.Box4Strings.l_ProofingInProgress,null),Cb.App.kR.h3h(()=>{fa.iQ&&(fa.hide(),this.Ca.processAction(a,2))}))}return 32}UAe(){return 32}}Object(e.a)(sC,"ProofingActor",null,[]);var BI=d(704),MP=d(1065);class ch{static Akj(){ch.fM||(ch.fM=Array(ch.ckl),ch.fM[0]=tb.a.fontColor,ch.fM[1]=Kg.a.dR,ch.fM[2]=tb.a.Rs,ch.fM[3]=tb.a.underline,ch.fM[4]=tb.a.Cw,ch.fM[5]=Kg.a.Js,ch.fM[6]=tb.a.font,ch.fM[7]=tb.a.fontSize,ch.fM[8]=tb.a.superscript,ch.fM[9]=tb.a.subscript,ch.fM[10]=tb.a.Rm,ch.fM[11]=Mb.a.noProof,
ch.fM[12]=Oc.a.Dva,ch.fM[13]=Kg.a.capitalization,ch.fM[14]=tb.a.bold,ch.fM[15]=tb.a.italic,ch.fM[16]=tb.a.underline);return ch.fM}static ykj(){ch.BC||(ch.BC=Array(ch.uuk),ch.BC[0]=Mb.a.Tn,ch.BC[1]=Mb.a.IHa,ch.BC[2]=Mb.a.Rl,ch.BC[3]=Mb.a.cwa,ch.BC[4]=Mb.a.IX,ch.BC[5]=Mb.a.neb,ch.BC[6]=Mb.a.XDb,ch.BC[7]=Mb.a.meb,ch.BC[8]=Kg.a.gEb,ch.BC[9]=Kg.a.fEb,ch.BC[10]=Mb.a.cEb,ch.BC[11]=Mb.a.$Db,ch.BC[12]=Mb.a.nTa,ch.BC[13]=Mb.a.Zw,ch.BC[14]=Mb.a.qeb,ch.BC[15]=Mb.a.peb,ch.BC[16]=Mb.a.Mfc,ch.BC[17]=Mb.a.Lfc,ch.BC[18]=
tb.a.xl,ch.BC[19]=tb.a.EI,ch.BC[20]=Kg.a.Udd,ch.BC[21]=tb.a.HX);return ch.BC}}ch.ckl=17;ch.uuk=22;ch.fM=null;ch.BC=null;Object(e.a)(ch,"StyleConstants",null,[]);class ar{static get pEk(){return ar.UO||(ar.UO=new MP.a)}static Xbe(a,b){if(!a||!a.node||!b)return!1;const c=vb.a.Ls(a);if(ar.Tvg(c?c.Iz:null,b,ch.Akj()))return Z.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;a=a.node.E7();return ar.Tvg(a,b,ch.ykj())?(Z.ULS.sendTraceTag(51218399,324,
50,"Difference in paragraph attributes b/w text selection and style"),!0):!1}static Tvg(a,b,c){let f=!1;if(a)for(const l of c)f=(a.Sa(l)?b.Sa(l)?!ar.pEk.compare(a,b,l):!0:!1)||f;return f}}ar.UO=null;Object(e.a)(ar,"StyleUtils",null,[]);class tC{constructor(a,b,c,f,l,x,G,R,fa,wa){this.b1a=this.ZIb=null;this.Yg=a;this.iK=b;this.jK=c;this.Hf=f;this.aga=l;this.rt=x;this.dD=G;this.hd=R;this.oNa=fa;this.r_h=wa}get characterPropertiesEditor(){return this.Yg}get HO(){return this.iK}get u5(){return this.jK}get Yl(){return this.aga}get insertionPointFormatting(){return this.rt}get ih(){return this.Hf}get Yi(){return this.dD}get Tc(){return this.hd}get RRe(){return this.oNa}get Gpc(){return this.r_h}get tSa(){null==
this.b1a&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),this.b1a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HighlightStyleWhenDifferentFromSelectionIsEnabled"):!1);return this.b1a}ub(){const a=u.AFrameworkApplication.Ta,b=Cb.App.VJa.yGc(12);H.a.instance.ga(61)&&(a.ya(E.a.J3a,Bb.a.textRange,Object(C.a)(this,this.Yai,"applyStyleToTextRange")),a.ya(E.a.tic,Bb.a.textRange,Object(C.a)(this,this.JFk,"queryStyleTextRange")),
a.ya(E.a.J3a,Bb.a.Of,Object(C.a)(this,this.Wai,"applyStyleToIp")),a.ya(E.a.tic,Bb.a.Of,Object(C.a)(this,this.HFk,"queryStyleIp")));a.ya(E.a.J3a,Bb.a.paragraph,Object(C.a)(this,this.Xai,"applyStyleToParagraph"));a.ya(E.a.J3a,Bb.a.view,Object(C.a)(this,this.Zai,"applyStyleView"));a.he(E.a.J3a,1036);a.ya(E.a.tic,Bb.a.view,Object(C.a)(this,this.KFk,"queryStyleView"));a.ya(E.a.tic,Bb.a.paragraph,Object(C.a)(this,this.IFk,"queryStyleParagraph"));a.he(E.a.tic,99|(H.a.instance.ga(7)?0:4));a.ya(E.a.xgc,Bb.a.view,
b);a.ya(E.a.xgc,Bb.a.paragraph,Object(C.a)(this,this.xgc,"populateMenuMoreStyles"));a.he(E.a.xgc,1127);a.pa(E.a.rKd,Bb.a.view,Object(C.a)(this,this.hqa,"applyStyleShortcut"),4);a.pa(E.a.sKd,Bb.a.view,Object(C.a)(this,this.hqa,"applyStyleShortcut"),4);a.pa(E.a.tKd,Bb.a.view,Object(C.a)(this,this.hqa,"applyStyleShortcut"),4);a.pa(E.a.uKd,Bb.a.view,Object(C.a)(this,this.hqa,"applyStyleShortcut"),4);a.pa(E.a.vKd,Bb.a.view,Object(C.a)(this,this.hqa,"applyStyleShortcut"),4);a.pa(E.a.wKd,Bb.a.view,Object(C.a)(this,
this.hqa,"applyStyleShortcut"),4);a.pa(E.a.xKd,Bb.a.view,Object(C.a)(this,this.hqa,"applyStyleShortcut"),4);a.pa(E.a.nIf,Bb.a.view,Object(C.a)(this,this.hqa,"applyStyleShortcut"),4);a.pa(E.a.oIf,Bb.a.view,Object(C.a)(this,this.hqa,"applyStyleShortcut"),4);a.pa(E.a.pIf,Bb.a.view,Object(C.a)(this,this.hqa,"applyStyleShortcut"),4);this.ZIb=Array(10);this.u5.HLe(this.ZIb)}wgj(a){switch(a){case E.a.rKd:return 0;case E.a.sKd:return 1;case E.a.tKd:return 2;case E.a.uKd:return 3;case E.a.vKd:return 4;case E.a.wKd:return 5;
case E.a.xKd:return 6;case E.a.nIf:return 7;case E.a.oIf:return 8;case E.a.pIf:return 9;default:return-1}}hqa(a,b,c,f){a=this.wgj(a);return 0>a||a>this.ZIb.length?2:(a=this.ZIb[a])?u.AFrameworkApplication.Ta.ki(b,E.a.J3a,c,!0,f,a):2}xgc(a,b,c,f,l){a=!0;b.contextId!==Bb.a.paragraph&&b.contextId!==Bb.a.textRange&&b.contextId!==Bb.a.Of&&(a=!1);if(1===c||!a)return a?32:8;if(2===c&&!l)return 8;b=this.u5.MK(b.node);c=H.a.instance.ga(61);u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up&&(l.MenuItems=
BI.StylePreviewGenerator.cdg(b,c));l.PopulationXML=BI.StylePreviewGenerator.JYi(b,c);return 32}IFk(a,b,c,f,l){a=!0;b.contextId!==Bb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;a=this.u5.BD(c);if(!a||!l)return Z.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",l,c,a),8;l.oQe.Jx(a);this.tSa&&(l.rae=ar.Xbe(b,a));return 32}Xai(a,b,c,f,l){if(b.contextId!==Bb.a.paragraph)return 8;if(H.a.instance.ga(14)&&this.Yi.dEa(b))return this.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),
8;if(1===c)return 32;a=b.node;if(!l)return 8;b=this.z3d(l,a);if(!b)return this.Tc.Tb(Nd.a.T0,{["Reason"]:Od.a.j_b}),8;if(2!==this.u5.lsa(b))return 2;c=new Id.GraphTransaction(15);c.gd(a);this.insertionPointFormatting.SXa();this.HO.y$(b,a,!1);c.dispose();l=Ka.a.NM(l);f.IP=l>>>16^l&65535;return 32}JFk(a,b,c,f,l){a=!0;b.contextId!==Bb.a.textRange&&(a=!1);if(1===c&&!a)return 2;c=b.node;a=vb.a.Ls(b);a=vb.a.Wsb(a);if(this.tSa){if(!l||!c)return Z.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",
l,c),8;a=a||this.u5.BD(c);if(!a)return Z.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;l.rae=ar.Xbe(b,a)}else{if(!a)return 2;if(!l)return 8}l.oQe.Jx(a);return 32}Yai(a,b,c,f,l){if(b.contextId!==Bb.a.textRange||!H.a.instance.ga(61))return 8;if(this.Yi.dEa(b))return this.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),8;if(1===c)return 32;a=b.node;if(!l)return 8;const x=this.z3d(l,b.node);if(!x)return this.Tc.Tb(Nd.a.T0,{["Reason"]:Od.a.j_b}),8;if(1!==this.u5.lsa(x))return 2;
c=this.u5.MK(a);if(!c)return this.Tc.Tb(Nd.a.T0,{["Reason"]:Od.a.i4f}),8;if(!c.DG(this.u5.UP(x)))return this.Tc.Tb(Nd.a.T0,{["Reason"]:Od.a.j_b}),8;const G=new Id.GraphTransaction(7);try{G.gd(a),this.HO.apc(a,c),this.RRe.uCc(b,R=>{this.ih.SAa(R);this.ih.dfa(R,x)})}finally{G&&G.dispose()}b=Ka.a.NM(l);f.IP=b>>>16^b&65535;return 32}HFk(a,b,c,f,l){a=!0;b.contextId!==Bb.a.Of&&(a=!1);if(1===c&&!a)return 2;c=this.HO.w3d(b);a=b.node;if(this.tSa){if(!l||!a)return Z.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",
l,a),8;c=c||this.u5.BD(a);if(!c)return Z.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;l.rae=ar.Xbe(b,c)}else{if(!c)return 2;if(!l)return 8}l.oQe.Jx(c);return 32}Wai(a,b,c,f,l){if(b.contextId!==Bb.a.Of||!H.a.instance.ga(61))return 8;if(this.Yi.dEa(b))return this.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),8;if(1===c)return 32;c=b.node;if(!l)return 8;const x=this.z3d(l,b.node);if(!x)return this.Tc.Tb(Nd.a.T0,{["Reason"]:Od.a.j_b}),8;const G=this.u5.lsa(x);if(1!==G&&2!==
G)return 2;(b=this.insertionPointFormatting.w1b(b))?(c=qd.a.ROa(b),a=u.AFrameworkApplication.Ta.ki(c,a,2,!1,f,l)):(a=new Id.GraphTransaction(7),a.gd(c),this.HO.ILe(x,c),a.dispose(),a=32);l=Ka.a.NM(l);f.IP=l>>>16^l&65535;return a}KFk(a,b,c,f,l){if(H.a.instance.ga(61)){const x=this.Gpc.Q4(a,b,c,f,l,null,0);if(2!==x)return x}return this.Gpc.Q4(a,b,c,f,l,null,12)}Zai(a,b,c,f,l){const x={};x[this.Gpc.Xna]=6168;x[this.Gpc.Wna]=6169;let G=12;if(H.a.instance.ga(61)){if(!b.view.Lh)return 2;var R=b.view.Gb,
fa=R?R.Kj:null;if(!fa)return this.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),8;if(H.a.instance.ga(11)&&this.Yl.Iqa(W.ImageReader.Fvb,fa))return this.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$Wb}),8;if(H.a.instance.ga(14)&&this.Yi.qTc(fa))return this.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.qD}),8;fa=this.u5.eub();if(l&&fa){var wa=fa.DG(l);wa&&(fa=this.u5.Z0d(wa,fa),wa=this.u5.lsa(wa),fa&&(R=R.Oa.ga(0),R.sba&&R.Ua.contextId===Bb.a.textRange||2===R.length&&R.Ua.contextId===Bb.a.textRange&&R.Ve.contextId===Bb.a.endOfParagraph)&&
(wa=1,l=fa.getValue(Kg.a.hEb)),1===wa?G=0:3===wa&&(G=14))}}return this.Gpc.Q4(a,b,c,f,l,x,G)}z3d(a,b){if(a&&b&&yb.ParagraphReader.Vd(b))b=this.u5.MK(b);else return null;return b.DG(a)}}Object(e.a)(tC,"StyleActor",null,[]);const CI=a=>a.contextId===Bb.a.gYd;class xg{static get Yl(){return Df.ContextSetEditor.instance}static get Yi(){return ed.a.instance}static get Tc(){return rb.a.instance}static get qe(){return xg.Yc||(xg.Yc=fb.a.instance.resolve("Box4.IFeatureHelper"))}static Sq(){return xg.xm||
(xg.xm=fb.a.instance.Ka("Box4.IExternalSelectionManager"))}static get PL(){return xg.gG||(xg.gG=fb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static J5b(a){return u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===E.a.$Ha||a===E.a.YXa||a===E.a.T4||a===E.a.HIa)}static U6(a,b,c,f,l){var x=!0;if(!b.view.Lh)return 2;var G=b.view,R=G.Gb;R&&R.Oa.kb||(xg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),x=!1);if(H.a.instance.ga(11)&&(xg.Yl.Iqa(W.ImageReader.e5b,G.Gb.Kj)&&(xg.Tc.Tb(Nd.a.vh,
{["Reason"]:Od.a.SPd}),x=!1),xg.Yl.Iqa(W.ImageReader.Fvb,G.Gb.Kj)))return xg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$Wb}),8;H.a.instance.ga(14)&&xg.Yi.qTc(G.Gb.Kj)&&(xg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.qD}),x=!1);xg.Yl.Iqa(W.ImageReader.dae,G.Gb.Kj)&&(xg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.iSf}),x=!1);xg.Yl.Iqa($t.c,G.Gb.Kj)&&(xg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.jSf}),x=!1);xg.Yl.Iqa(CI,G.Gb.Kj)&&(xg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.hSf}),x=!1);xg.Sq()&&xg.Sq().instance&&xg.Sq().instance.lW(G.Gb.Kj)&&(xg.Tc.Tb(Nd.a.vh,
{["Reason"]:Od.a.externalSelection}),x=!1);a!==E.a.C0||H.a.instance.ga(54)||H.a.instance.ga(84)||(x=!1);var fa=null;R&&R.Oa.kb&&(fa=R.Oa.kb);a===E.a.Ihl&&fa&&fa.sba&&yb.ParagraphReader.mW(fa.Ua.node)&&!Ib.ListReader.Ww&&(x=!1);if(1===c||!x||!fa)return x?32:8;x=a===E.a.Wja||a===E.a.Nha||a===E.a.cna||a===E.a.pCa;G=a===E.a.YDk||a===E.a.RGi||a===E.a.keh;const wa=a===E.a.Wgb||a===E.a.Xgb||a===E.a.C0,Wa=new Id.GraphTransaction(15);Wa.gd(fa.Ua.node);fa=new Ha.a;let mb=!1;if(x||G||wa)Me.a.mark(7121),b=xg.Yl.$Xi(b.fE);
else{Me.a.mark(7119);b=oi.Nra(R.Oa,!0);if(!b)return xg.Tc.Tb(Nd.a.wia,{["Reason"]:Od.a.pKc}),Wa.dispose(),8;R=a===E.a.Cxj||a===E.a.Dxj;b.Rw&&R&&(mb=xg.ltj(fa,b))}b.Rw&&1<b.length&&xg.mtj(b)&&(l||(l={}),l.InContextSet=!0);u.AFrameworkApplication.Ta.ki(b,a,c,!0,f,l);mb&&xg.yhk(fa,b,l);Wa.dispose();Cb.App.Hb.updateCommandUI();x||G||wa?Me.a.mark(7122):Me.a.mark(7120);return 32}static ltj(a,b){if(!b.Rw)return!1;let c=!1,f=!1;for(let x=0;x<b.length;x++)if(b.getContext(x).Qk){var l=b.getContext(x).node;
if(l)if(l=xg.PL.wtb(l),2===l.specialIndentType)c=!0,a.add(x);else if(1===l.specialIndentType||0===l.specialIndentType)f=!0}return f&&c}static yhk(a,b,c){if(b.Rw)for(let l=0;l<a.count;l++){var f=b.getContext(a.ga(l));if(!f.Qk)continue;f=f.node;const x=xg.PL.wtb(f);2!==x.specialIndentType||De.a.Jy(c.value,x.nN)||f.setValue(Mb.a.Rl,x.nN-x.KIb)}}static fal(a,b){let c=!0;b.contextId!==Bb.a.paragraph?c=!1:H.a.instance.ga(14)&&xg.Yi.dEa(b)?(xg.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),c=!1):xg.Sq()&&xg.Sq().instance&&
xg.Sq().instance.lW(b)&&(xg.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.externalSelection}),c=!1);return{returnValue:1!==a&&c,XE:c?32:8}}static Bqh(a,b){let c=!0;b.contextId!==Bb.a.image&&b.contextId!==Bb.a.embeddedFile&&(c=!1);H.a.instance.ga(11)&&(c=!1);return{returnValue:1!==a&&c,XE:c?32:8}}static mtj(a){if(!a.Rw)return!1;let b=1;for(let f=0;f<a.length;f++)if(a.getContext(f).Qk){var c=a.getContext(f).node;if(c)if(c=yb.ParagraphReader.fN(c),!f)b=c;else if(c!==b)return!0}return!1}}xg.Yc=null;xg.xm=null;xg.gG=
null;Object(e.a)(xg,"FormattingActionHelper",null,[]);class Cs extends zs.a{constructor(a,b,c,f,l,x,G,R){super();this.Xvf=this.BB=null;this.init(a);this.Fl("FormattingViewOperation");this.qDa(u.AFrameworkApplication.Ta,b,f,l,x);this.Qu=c;this.IKa=0;this.Lp=!0;this.SNh=G;this.xm=R}get vra(){return this.xm.instance}run(){const a=this.Qu.view;var b=null;a.Lh&&(b=a.Gb);if(b){var c=b.Oa.kb;!c||H.a.instance.ga(14)&&Cs.Yi.bce(c)?(Cs.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.qD}),this.Lp=!1):this.vra&&this.vra.Uvb(c)&&
(Cs.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.externalSelection}),this.Lp=!1)}else Cs.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$la}),this.Lp=!1;1!==this.behavior&&this.Lp||(this.Lp&&(c=b.Oa.kb,1===b.Oa.length&&1===c.length&&cb.SelectionEditor.Vj(c.Ua)&&Ie.b(c.Ua)&&(Cs.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.PFc}),this.Lp=!1)),(c=this.Lp)&&this.actionId===E.a.qU&&((c=bb.AT(b.Oa.kb,vb.a.kSf))||Cs.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.sUd})),this.rp=c?32:8,this.IKa=3);0===this.IKa&&(Me.a.mark(5730),this.Xvf=zl.SelectionReferenceFactory.instance.Oqa(),
c=b.Oa.kb.Ua,this.BB=new Id.GraphTransaction(15),this.BB.gd(c.node),this.IKa=1);if(1===this.IKa){this.Ez||this.Ggb(this.Qu.fE);if(1===this.Cma())return;this.IKa=2}if(2===this.IKa){if(this.actionId===E.a.qU)if(b=b.Kj,b.Rw)for(c=0;c<b.length;c++){let f=b.getContext(c);this.jBh(f)}else this.jBh(b);b=this.actionId===E.a.w$||this.actionId===E.a.UAa||this.actionId===E.a.clearFormatting||this.actionId===E.a.GV;xg.J5b(this.actionId)||this.Xvf.hU(b);(b=Object(ua.a)(420,this.kd))&&!b.ffa||v.FocusManager.instance().Bf(a.eI);
this.BB.dispose();this.BB=null;xg.J5b(this.actionId)||Cb.App.Hb.updateCommandUI();Me.a.mark(5731);this.IKa=3;this.rp=32}3===this.IKa&&(this.SNh.process(this.actionId,this.Qu,this.behavior,this.response),this.$X())}jBh(a){(cb.SelectionEditor.xu(a)||cb.SelectionEditor.Ll(a))&&Cb.App.kR.fR(a.node)}static get Yi(){return ed.a.instance}static get Tc(){return rb.a.instance}}Object(e.a)(Cs,"FormattingViewOperation",zs.a,[]);var NP=d(473),OP=d(402);class Bd{constructor(a,b,c,f,l){this.jza=new va.ScriptSharpLegacyMap;
this.z8k=x=>{x=Lb.HyperlinkReader.Q6i(x,this.bD);for(let G of x)(x=G.paragraph)&&x.Ra&&(x=x.Ra.yS(G.Qa))&&x.formatting&&Bd.ih.Yhh(x.formatting)};this.dOh=a;this.O3e=b;this.Ov=c;this.bD=f;if(!l)throw Error.argumentNull("interactiveViewManager");Bd.If=l;this.ylb=!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("FontPreviewEnabled")}ub(){const a=u.AFrameworkApplication.Ta,b=Object(C.a)(this,this.gFk,"queryNonParagraphFormatting");H.a.instance.ga(105)&&(Bd.qe?Bd.qe.NDa(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"))?
(a.ya(E.a.font,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.Jr,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.nI,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.BJ,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.gt,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.GV,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.w$,Bb.a.endOfParagraph,
Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.UAa,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.bold,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.setItalic,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.underline,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.qna,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.superscript,Bb.a.endOfParagraph,
Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.subscript,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.strikethrough,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.Js,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.qU,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP")),a.ya(E.a.clearFormatting,Bb.a.endOfParagraph,Object(C.a)(this,this.rP,"applyFormattingEOP"))):Cb.App.$9a&&(a.ya(E.a.font,
Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")),a.ya(E.a.Jr,Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")),a.ya(E.a.gt,Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")),a.ya(E.a.GV,Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")),Ib.ListReader.Ww&&(a.ya(E.a.bold,Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")),a.ya(E.a.setItalic,Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")),
a.ya(E.a.superscript,Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")),a.ya(E.a.subscript,Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")),a.ya(E.a.strikethrough,Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")),a.ya(E.a.Js,Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP"))),H.a.instance.ga(94)||H.a.instance.ga(96))&&(a.ya(E.a.nI,Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")),a.ya(E.a.BJ,
Bb.a.endOfParagraph,Object(C.a)(this,this.dba,"applyListFormattingEOP")));const c=Cb.App.VJa.aUf(f=>oi.Nra(f.Oa,!0));a.pa(E.a.gmd,Bb.a.textRange,Object(C.a)(this,this.gmd,"toggleChangeCase"),1028);H.a.instance.ga(77)||a.ya(E.a.rwa,Bb.a.table,Object(C.a)(this,this.QFk,"queryTableFormatting"));a.ya(E.a.fFb,Bb.a.view,Object(C.a)(this,this.l$g,"queryCharacterFormatting"));a.ya(E.a.fDe,Bb.a.view,Object(C.a)(this,this.l$g,"queryCharacterFormatting"));a.ya(E.a.rwa,Bb.a.view,c);a.ya(E.a.rwa,Bb.a.paragraph,
Object(C.a)(this,this.rwa,"queryParagraphFormatting"));a.ya(E.a.rwa,Bb.a.image,Object(C.a)(this,this.$Ek,"queryImageFormatting"));a.ya(E.a.rwa,Bb.a.unsupportedObject,b);a.he(E.a.fFb,99|(H.a.instance.ga(7)?0:1028));a.he(E.a.fDe,1127);a.he(E.a.rwa,97|(H.a.instance.ga(7)?0:1028));u.AFrameworkApplication.fa.ka("RulerEnabled")&&(a.ya(E.a.hFb,Bb.a.view,c),a.ya(E.a.hFb,Bb.a.paragraph,Object(C.a)(this,this.hFb,"queryParagraphIndentation")),a.he(E.a.hFb,97|(H.a.instance.ga(7)?0:1028)));this.EB(a,E.a.font);
this.EB(a,E.a.Jr);this.ylb&&(this.EB(a,E.a.$Ha),this.EB(a,E.a.YXa),this.EB(a,E.a.T4),this.EB(a,E.a.HIa));if(H.a.instance.ga(94)||H.a.instance.ga(96))this.EB(a,E.a.nI),this.EB(a,E.a.BJ);a.pAa(E.a.S6f,Bb.a.view,Object(C.a)(this,this.ZJd,"applyCharacterFormattingViewAsync"));a.he(E.a.S6f,1092);this.EB(a,E.a.gt);this.EB(a,E.a.GV);this.EB(a,E.a.w$);this.EB(a,E.a.lEc);this.EB(a,E.a.SVb);this.EB(a,E.a.TVb);this.EB(a,E.a.Xpb);this.EB(a,E.a.mEc);this.EB(a,E.a.UAa);this.EB(a,E.a.bold);a.ugb(E.a.bold,Object(C.a)(this,
this.D6a,"generateActionArguments"));this.EB(a,E.a.setItalic);a.ugb(E.a.setItalic,Object(C.a)(this,this.D6a,"generateActionArguments"));this.EB(a,E.a.underline);a.ugb(E.a.underline,Object(C.a)(this,this.D6a,"generateActionArguments"));this.EB(a,E.a.qna);this.EB(a,E.a.superscript);a.ugb(E.a.superscript,Object(C.a)(this,this.D6a,"generateActionArguments"));this.EB(a,E.a.subscript);a.ugb(E.a.subscript,Object(C.a)(this,this.D6a,"generateActionArguments"));this.EB(a,E.a.strikethrough);a.ugb(E.a.strikethrough,
Object(C.a)(this,this.D6a,"generateActionArguments"));this.EB(a,E.a.Js);a.ugb(E.a.Js,Object(C.a)(this,this.D6a,"generateActionArguments"));a.pa(E.a.G8a,Bb.a.textRange,Object(C.a)(this,this.tCc,"applyCharacterFormatting"),96);a.pAa(E.a.qU,Bb.a.view,Object(C.a)(this,this.ZJd,"applyCharacterFormattingViewAsync"));a.ya(E.a.qU,Bb.a.paragraph,Object(C.a)(this,this.eKd,"applyParagraphFormatting"));a.ya(E.a.qU,Bb.a.textRange,Object(C.a)(this,this.tCc,"applyCharacterFormatting"));a.ya(E.a.qU,Bb.a.Of,Object(C.a)(this,
this.$Jd,"applyFormattingIp"));a.ya(E.a.clearFormatting,Bb.a.view,Object(C.a)(this,this.kpi,"clearFormattingView"));a.ya(E.a.clearFormatting,Bb.a.paragraph,Object(C.a)(this,this.jpi,"clearFormattingParagraph"));a.ya(E.a.clearFormatting,Bb.a.textRange,Object(C.a)(this,this.tCc,"applyCharacterFormatting"));a.ya(E.a.clearFormatting,Bb.a.Of,Object(C.a)(this,this.$Jd,"applyFormattingIp"));a.he(E.a.clearFormatting,1028);a.ya(E.a.u4a,Bb.a.textRange,Object(C.a)(this,this.u4a,"clearFormattingParagraphLevel"));
a.ya(E.a.u4a,Bb.a.Of,Object(C.a)(this,this.u4a,"clearFormattingParagraphLevel"));a.ya(E.a.tOd,Bb.a.view,Object(C.a)(this,this.tOd,"clearFormattingMultiParagraphLevel"));a.ya(E.a.gJa,Bb.a.view,xg.U6);a.ya(E.a.gJa,Bb.a.paragraph,Object(C.a)(this,this.eKd,"applyParagraphFormatting"));a.ya(E.a.gJa,Bb.a.image,Object(C.a)(this,this.sIf,"applyTextDirectionToImage"));a.ya(E.a.gJa,Bb.a.unsupportedObject,Object(C.a)(this,this.tIf,"applyTextDirectionToNonParagraph"));a.he(E.a.gJa,1028);a.ya(E.a.KYa,Bb.a.view,
xg.U6);a.ya(E.a.KYa,Bb.a.paragraph,Object(C.a)(this,this.eKd,"applyParagraphFormatting"));a.ya(E.a.KYa,Bb.a.image,Object(C.a)(this,this.sIf,"applyTextDirectionToImage"));a.ya(E.a.KYa,Bb.a.unsupportedObject,Object(C.a)(this,this.tIf,"applyTextDirectionToNonParagraph"));a.he(E.a.KYa,1028)}EB(a,b){a.pAa(b,Bb.a.view,Object(C.a)(this,this.ZJd,"applyCharacterFormattingViewAsync"));a.ya(b,Bb.a.textRange,Object(C.a)(this,this.tCc,"applyCharacterFormatting"));a.ya(b,Bb.a.Of,Object(C.a)(this,this.$Jd,"applyFormattingIp"));
a.he(b,1028)}D6a(){return new L(2)}gmd(a,b,c){if(1===c)return 32;a=b.node.characterData.substr(b.Qa,b.Kb-b.Qa);return Bd.zce(a,0,a.length)?this.kEc(b,E.a.SVb):Bd.lQj(a)?this.kEc(b,E.a.Xpb):this.kEc(b,E.a.TVb)}l$g(a,b,c,f,l){f=!0;b.contextId!==Bb.a.view&&(f=!1);if(1===c&&!f)return 8;if(a===E.a.fDe)a=l.formatting,l=l.PGl;else{if(!b.view||!b.view.Lh)return 2;b=b.view;if(!b.Gb||!b.Gb.Oa.kb)return 8;a=l;l=b.Gb.Oa}this.Hsi(l,a);return 32}Hsi(a,b){for(let l of a){a=l.vl;for(let x of l){let G=null;if(x.contextId===
Bb.a.textRange){if(Ie.b(x))continue;G=[];var c=x.node.Ra;if(c){var f=c.length-1;const R=x.Qa,fa=x.Kb;let wa=!1;for(let Wa=0;Wa<f;Wa++){const mb=c.ga(Wa).cp,Kb=c.ga(Wa+1).cp;if(c.ga(Wa).formatting&&Math.max(mb,R)<Math.min(Kb,fa))wa=!0,Array.add(G,c.ga(Wa).formatting);else if(wa)break}c.ga(f).formatting&&x.Kb>c.ga(f).cp&&Array.add(G,c.ga(f).formatting)}}else if(x.contextId===Bb.a.paragraph){if(G=[],c=x.node.Ra)for(f=0;f<c.length;f++)c.ga(f).formatting&&Array.add(G,c.ga(f).formatting)}else if(x.contextId===
Bb.a.endOfParagraph)G=[vb.a.Ls(x)];else if(x.contextId===Bb.a.Of){this.EEk(x,b);return}if(G&&0<G.length)for(const R of G)if(vb.a.Dnd(b,R.cache,x,a))return}}}EEk(a,b){var c=vb.a.Ls(a);if(c){c=c.cache;var f=Bd.insertionPointFormatting.kI(tb.a.bold,c.isBold);b.bold=f?1:0;f=Bd.insertionPointFormatting.kI(tb.a.italic,c.isItalic);b.italic=f?1:0;f=Bd.insertionPointFormatting.kI(tb.a.underline,c.GD);b.underline=f?1:0;b.Cw=Bd.insertionPointFormatting.kI(tb.a.Cw,c.Cw);f=Bd.insertionPointFormatting.kI(tb.a.superscript,
c.isSuperscript);b.superscript=f?1:0;f=Bd.insertionPointFormatting.kI(tb.a.subscript,c.sF);b.subscript=f?1:0;f=Bd.insertionPointFormatting.kI(tb.a.strikethrough,c.rF);b.strikethrough=f?1:0;f=Bd.insertionPointFormatting.kI(Kg.a.Js,c.TZ);b.Js=f?1:0;b.fontName=ad.Font.ECa(Bd.insertionPointFormatting.kI(tb.a.font,c.eN));b.Hna=c.FU;b.fontSize=this.Ov.Z6a(Bd.insertionPointFormatting.kI(tb.a.fontSize,c.fontSize),a.node);b.fontColor=Bd.insertionPointFormatting.kI(tb.a.fontColor,c.fontColor);b.highlight=Bd.insertionPointFormatting.kI(tb.a.highlight,
c.highlight)}}ZJd(a,b,c,f,l,x){return new Cs(a,b,c,f,l,x,this.dOh,Bd.Sq())}tCc(a,b,c,f,l){f=!0;let x=b;b.contextId!==Bb.a.textRange&&b.contextId!==Bb.a.Of?f=!1:(H.a.instance.ga(14)&&Bd.Yi.Xsa(x)&&(Bd.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),f=!1),Bd.Sq()&&Bd.Sq().instance&&Bd.Sq().instance.lW(x)&&(f=!1),f&&cb.SelectionEditor.Vj(b)&&Ie.b(x)&&(Bd.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.PFc}),f=!1));if(1===c||!f)return f?32:8;if(b.contextId===Bb.a.Of)return 2;this.Ov.Grh(a)&&(b=cb.SelectionEditor.cKb(x),cb.SelectionEditor.Pg(b)||
(x=b));b=x.node;xg.J5b(a)&&(b.Ena=!0);a==E.a.gt&&H.a.instance.ga(119)&&u.AFrameworkApplication.fa.isChangeGateEnabled("HyperlinkPartialColorSupported")&&this.z8k(x);Bd.RRe.uCc(x,G=>{this.Amh(G,a,l,x.Kb)});xg.J5b(a)&&(b.Ena=!1);this.EFj(a)&&this.kEc(x,a);return 32}wOc(a){if(!this.ylb||!a||!a.paragraph)return null;const b=Bd.If.Nd;if(!b)return null;a=Object(ua.a)(418,a.paragraph.sg(b.Ma));return a?(a=Object(ua.a)(419,a))?a:null:null}NQc(a){return this.ylb&&!!a&&!!a.Fi}Tmh(a,b,c){if(a&&a.kd){var f=b.cache,
l=a.kd,x=-1;if("string"===typeof l)this.ylb&&c===E.a.T4&&this.g4a(b,f.eN,tb.a.font),a=l;else if(this.ylb&&c===E.a.T4&&(this.g4a(b,f.eN,tb.a.font),this.g4a(b,f.FU,Mb.a.FU)),a=l.fontName,x=l.Hna,ad.Font.FSa()){this.ylb&&c===E.a.T4&&(this.g4a(b,f.isBold,tb.a.bold),this.g4a(b,f.isItalic,tb.a.italic));const G=1===l.bold;l=1===l.italic;if(G||l)Bd.ih.xJ(b,G),Bd.ih.setItalic(b,l)}a=a.substr(0,31);Bd.ih.ZX(b,a);H.a.instance.ga(53)&&(c===E.a.T4&&this.g4a(b,f.FU,Mb.a.FU),Bd.ih.hJa(b,x))}}g4a(a,b,c){this.jza.Jb(a.ye.cp)||
this.jza.$(a.ye.cp,new va.ScriptSharpLegacyMap);this.jza.ga(a.ye.cp).Jb(c)||this.jza.ga(a.ye.cp).$(c,b)}s0b(a,b){if(!this.jza.Jb(a.ye.cp))return null;const c=this.jza.ga(a.ye.cp).ga(b);this.jza.ga(a.ye.cp).remove(b);this.jza.ga(a.ye.cp).count||this.jza.remove(a.ye.cp);return c}Amh(a,b,c,f){var l=a.cache,x=Object(ua.a)(420,c);switch(b){case E.a.bold:2===c.value&&(c.value=l.isBold?0:1);Bd.ih.xJ(a,1===c.value);break;case E.a.setItalic:2===c.value&&(c.value=l.isItalic?0:1);Bd.ih.setItalic(a,1===c.value);
break;case E.a.underline:2===c.value&&(c.value=l.GD?0:1);Bd.ih.E0(a,1===c.value);break;case E.a.qna:Bd.ih.qna(a,c);break;case E.a.superscript:2===c.value&&(c.value=l.isSuperscript?0:1);Bd.ih.eY(a,1===c.value);break;case E.a.subscript:2===c.value&&(c.value=l.sF?0:1);Bd.ih.k5(a,1===c.value);break;case E.a.strikethrough:2===c.value&&(c.value=l.rF?0:1);Bd.ih.cY(a,1===c.value);break;case E.a.Js:2===c.value&&(c.value=l.TZ?0:1);Bd.ih.Hgb(a,1===c.value);break;case E.a.font:this.Tmh(x,a,E.a.font);break;case E.a.T4:c=
this.wOc(a);this.NQc(c)&&(this.Tmh(x,a,E.a.T4),c.HJ(null));break;case E.a.HIa:c=this.wOc(a);this.NQc(c)&&(x=this.s0b(a,tb.a.font))&&(f=this.s0b(a,tb.a.bold),l=this.s0b(a,tb.a.italic),f&&Bd.ih.xJ(a,f),l&&Bd.ih.setItalic(a,l),x=x.substr(0,31),Bd.ih.ZX(a,x),f=this.s0b(a,Mb.a.FU),H.a.instance.ga(53)&&f&&Bd.ih.hJa(a,f),c.HJ(null));break;case E.a.gt:Bd.ih.gt(a,c,null);break;case E.a.GV:Bd.ih.GV(a);break;case E.a.w$:Bd.ih.lna(a,c);break;case E.a.UAa:Bd.ih.mWb(a);break;case E.a.Jr:Bd.ih.Jr(a,x.kd);break;
case E.a.$Ha:c=this.wOc(a);this.NQc(c)&&(this.g4a(a,l.fontSize,tb.a.fontSize),Bd.ih.Jr(a,x.kd),c.HJ(null));break;case E.a.YXa:c=this.wOc(a);this.NQc(c)&&(f=this.s0b(a,tb.a.fontSize))&&(Bd.ih.Jr(a,f),c.HJ(null));break;case E.a.nI:Bd.ih.hQc(a);break;case E.a.BJ:Bd.ih.Mjd(a);break;case E.a.qU:l=H.a.instance.ga(20)?Mb.a.noProof:Oc.a.Dva;l=c.sa(l,!1);Bd.ih.Zkc(a,c.getValue(tb.a.Rs),f,l);break;case E.a.G8a:Bd.ih.mHb(a);break;case E.a.clearFormatting:Bd.ih.SAa(a);break;case E.a.SVb:case E.a.TVb:case E.a.lEc:case E.a.Xpb:case E.a.mEc:l.FRa&&
2===l.capitalization&&Bd.ih.oOd(a)}}u4a(a,b,c){a=!0;b.contextId!==Bb.a.textRange&&b.contextId!==Bb.a.Of?a=!1:(H.a.instance.ga(14)&&Bd.Yi.Xsa(b)&&(Bd.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),a=!1),a&&cb.SelectionEditor.Vj(b)&&Ie.b(b)&&(Bd.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.PFc}),a=!1));if(1===c||!a)return a?32:8;Bd.paragraphEditor.oWb(b.node,!1);return 32}tOd(a,b,c,f,l){a={};a[bi.Xna]=6168;a[bi.Wna]=6169;const x=b.view;var G=null;x.$o&&(G=x);var R=!0;let fa=32;G&&(G=G.Gb.Oa.kb)&&H.a.instance.ga(14)&&(Bd.Yi.bce(G)?
(Bd.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.qD}),fa=8,R=!1):1===c&&(fa=32,R=!1));R&&H.a.instance.ga(54)&&(R=new Id.GraphTransaction(1===c?3:15),R.gd(x.root),fa=bi.Q4(E.a.u4a,b,c,f,l,a,12),R.dispose());return fa}$Jd(a,b,c,f,l){var x=!0,G=32;b.contextId!==Bb.a.Of?x=!1:H.a.instance.ga(14)&&Bd.Yi.Xsa(b)&&(Bd.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),x=!1);if(1===c||!x)return x?32:8;c=b.node;x=null;if(H.a.instance.ga(54)&&H.a.instance.ga(61)&&a===E.a.clearFormatting){Bd.jo.jqb(c);Bd.paragraphEditor.hQf(c);const R=Uc.StyleReader.MK(c).DG(Uc.StyleReader.DKa);
Bd.HO.y$(R,c,!0)}if(a!==E.a.clearFormatting||H.a.instance.ga(49))x=Bd.insertionPointFormatting.w1b(b);if(x)G=qd.a.ROa(x),G=u.AFrameworkApplication.Ta.ki(G,a,2,!1,f,l);else switch(f=Object(ua.a)(420,l),b=vb.a.Ls(b).cache,a){case E.a.font:f&&f.kd&&(l=f.kd,f=-1,"string"===typeof l?b=l:(b=l.fontName,f=l.Hna),Bd.insertionPointFormatting.Ahd(b),H.a.instance.ga(53)&&Bd.insertionPointFormatting.hJa(f));break;case E.a.gt:Bd.insertionPointFormatting.gt(l);break;case E.a.GV:Bd.insertionPointFormatting.GV();
break;case E.a.w$:Bd.insertionPointFormatting.lna(l);break;case E.a.UAa:Bd.insertionPointFormatting.mWb();break;case E.a.Jr:Bd.insertionPointFormatting.Jr(f.kd);break;case E.a.nI:l=Bd.insertionPointFormatting.kI(tb.a.fontSize,b.fontSize);Bd.insertionPointFormatting.Jr(Bd.ih.nI(l));break;case E.a.BJ:l=Bd.insertionPointFormatting.kI(tb.a.fontSize,b.fontSize);Bd.insertionPointFormatting.Jr(Bd.ih.BJ(l));break;case E.a.bold:Bd.insertionPointFormatting.xJ(!Bd.insertionPointFormatting.kI(tb.a.bold,b.isBold));
break;case E.a.setItalic:Bd.insertionPointFormatting.setItalic(!Bd.insertionPointFormatting.kI(tb.a.italic,b.isItalic));break;case E.a.underline:Bd.insertionPointFormatting.E0(!Bd.insertionPointFormatting.kI(tb.a.underline,b.GD));break;case E.a.qna:Bd.insertionPointFormatting.qna(l);break;case E.a.superscript:Bd.insertionPointFormatting.eY(!Bd.insertionPointFormatting.kI(tb.a.superscript,b.isSuperscript));break;case E.a.subscript:Bd.insertionPointFormatting.k5(!Bd.insertionPointFormatting.kI(tb.a.subscript,
b.sF));break;case E.a.strikethrough:Bd.insertionPointFormatting.cY(!Bd.insertionPointFormatting.kI(tb.a.strikethrough,b.rF));break;case E.a.Js:Bd.insertionPointFormatting.Hgb(!Bd.insertionPointFormatting.kI(Kg.a.Js,b.TZ));break;case E.a.clearFormatting:Bd.insertionPointFormatting.SXa();H.a.instance.ga(54)||(Bd.jo.jqb(c),Bd.paragraphEditor.oWb(c,!0),H.a.instance.ga(71)&&Bd.HO.PEc(c));break;case E.a.qU:l.Sa(tb.a.Rs)&&Bd.insertionPointFormatting.qU(l.getValue(tb.a.Rs)),b=H.a.instance.ga(20)?Mb.a.noProof:
Oc.a.Dva,l.Sa(b)&&(l=l.getValue(b),Bd.insertionPointFormatting.F5k(l))}xg.J5b(a)||Cb.App.Hb.updateCommandUI();return G}AQk(a,b){E.a.clearFormatting===b&&Xb.OutlineElementNavigator.EA(a).properties.removeProperty(tb.a.HX)}rP(a,b,c,f,l){f=Bd.Tc.Kp(E.a.U3k);var x=!0;b.contextId!==Bb.a.endOfParagraph&&(x=!1);if(1===c||!x)return x?32:8;c=b.node;b=nb.GraphIterator.mb(b.node);b.af();x=b.aja(4);if((b=!!x&&Bd.Tf.Ica(x))&&!Cb.App.$9a)return 8;const G=!yb.ParagraphReader.textLength(c);f.properties.$("Action",
a.toString());f.properties.$("ListContext",b.toString());f.properties.$("IsEmptyParagraph",G.toString());Z.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",a,b,G);this.O3e.iwh(b)?this.GDh(a,l,x):(b=c.Ra.last,this.AQk(c,a),x=b.formatting,c=Bd.characterPropertiesEditor.DVd(c),this.O3e.xxg(x)&&(c.Ud(c.ye),this.Amh(c,a,l,b.cp)));f.end();return 32}GDh(a,b,c){const f=Object(ua.a)(420,b);switch(a){case E.a.gt:Bd.Uca.gt(c,b);break;case E.a.Jr:Bd.Uca.Jr(c,f.kd);
break;case E.a.GV:Bd.Uca.GV(c);break;case E.a.nI:Bd.Uca.nI(c);break;case E.a.BJ:Bd.Uca.BJ(c);break;case E.a.font:Bd.Uca.q4k(c,f.kd);break;case E.a.bold:a=this.gGb(b,tb.a.bold,c);Bd.Uca.xJ(c,a);break;case E.a.setItalic:a=this.gGb(b,tb.a.italic,c);Bd.Uca.setItalic(c,a);break;case E.a.subscript:a=this.gGb(b,tb.a.subscript,c);Bd.Uca.k5(c,a);break;case E.a.superscript:a=this.gGb(b,tb.a.superscript,c);Bd.Uca.eY(c,a);break;case E.a.strikethrough:a=this.gGb(b,tb.a.strikethrough,c);Bd.Uca.cY(c,a);break;case E.a.Js:a=
this.gGb(b,Kg.a.Js,c),Bd.Uca.Hgb(c,a)}}gGb(a,b,c){2===a.value&&(a.value=c?c.sa(b,!1)?0:1:0);return 1===a.value}dba(a,b,c,f,l){f=!0;const x=nb.GraphIterator.mb(b.node);x.af();b.contextId===Bb.a.endOfParagraph&&x.aja(4)||(Bd.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.iee}),f=!1);b=x.currentNode;if(!Bd.Tf.Ica(b))return 8;if(1===c||!f)return f?32:8;this.GDh(a,l,b);return 32}rwa(a,b,c,f,l){a=!0;b.contextId!==Bb.a.paragraph&&(a=!1);if(1===c&&!a)return 8;c=b.node;-1!==l.xl?l.xl!==yb.ParagraphReader.fN(c)&&(l.xl=0):
l.xl=yb.ParagraphReader.fN(c);H.a.instance.ga(54)&&(H.a.instance.ga(59)||H.a.instance.ga(34))&&(a=Bd.PL.wtb(c),l.KA?(!l.yFl&&this.ntj(l.KA,a)&&2===l.KA.specialIndentType&&(l.KA.specialIndentType=0),l.KA.ORc===a.ORc&&De.a.Jy(l.KA.nN,a.nN)||(l.KA.nN=Number.MAX_VALUE),l.KA.QRc===a.QRc&&De.a.Jy(l.KA.cvb,a.cvb)||(l.KA.cvb=Number.MAX_VALUE)):l.KA=a,b=Bd.Yl.oJf(b.fE),void 0!==b&&null!==b&&(b=b.node,void 0!==b&&null!==b&&(b=NP.WordSectionNavigator.instance.fve(b),void 0!==b&&null!==b&&(b=Bd.QWe.esa(b)-(Bd.QWe.r1d(b)+
Bd.QWe.s1d(b)+Cb.App.$Cl),a.PRc=b-a.nN,a.NRc=b-a.cvb,l.KA.NRc=Math.min(l.KA.NRc,a.NRc),l.KA.PRc=Math.min(l.KA.PRc,a.PRc)))));if(H.a.instance.ga(54)&&H.a.instance.ga(59)||H.a.instance.ga(84))b=Bd.fVj.YV(c),l.spacing?(l.spacing.beforeSpacing=Bd.XFf(b.beforeSpacing,l.spacing.beforeSpacing),l.spacing.afterSpacing=Bd.XFf(b.afterSpacing,l.spacing.afterSpacing),l.spacing.lineSpacing.Sf===b.lineSpacing.Sf&&De.a.Jy(l.spacing.lineSpacing.value,b.lineSpacing.value)||(l.spacing.lineSpacing.Sf=0,l.spacing.lineSpacing.value=
0)):l.spacing=b;b=new nb.GraphIterator;b.set(c);b.pc(11);if(c=b.Rg(11))l.isRtl=ae.OutlineElementReader.jm(c);c=Bd.Tf.Pw(b);b=16;void 0!==c&&null!==c&&(b=c.listType);l.listType=Bd.U2i(l.listType,b);l.$S=16===l.listType?null:c;return 32}ntj(a,b){return this.GIf(a,b)||this.GIf(b,a)}GIf(a,b){return(1===a.specialIndentType||0===a.specialIndentType)&&2===b.specialIndentType}gFk(a,b,c,f,l){a=Xb.OutlineElementNavigator.EA(b.node);l.isRtl=ae.OutlineElementReader.jm(a);return 32}tIf(a,b,c){if(a===E.a.KYa)a=
!0;else if(a===E.a.gJa)a=!1;else return 2;a&&this.Yee(b);if(1===c)return 32;b=Xb.OutlineElementNavigator.EA(b.node);Bd.Nh.eJa(b,a);return 32}$Ek(a,b,c,f,l){a=b.node;b=Xb.OutlineElementNavigator.EA(a);l.isRtl=ae.OutlineElementReader.isRtl(b);l.xl=W.ImageReader.fN(a);return 32}QFk(a,b,c,f,l){a=b.node;b=Xb.OutlineElementNavigator.EA(a);l.isRtl=ae.OutlineElementReader.isRtl(b);l.xl=Jd.TableReader.fN(a);if(-1===l.xl||0===l.xl)l.xl=l.isRtl?3:1;return 32}sIf(a,b,c){if(!({XE:c}=xg.Bqh(c,b)).returnValue)return c;
c=b.node;switch(a){case E.a.gJa:case E.a.KYa:c=Xb.OutlineElementNavigator.EA(c);let f=!0;a===E.a.gJa&&(f=!1);Bd.Nh.eJa(c,f);f&&this.Yee(b)}return 32}eKd(a,b,c,f,l){let x;if(!({XE:x}=xg.fal(c,b)).returnValue)return x;const G=b.node;switch(a){case E.a.gJa:Bd.Nh.MHb(G,!1);break;case E.a.KYa:this.Yee(b);Bd.Nh.MHb(G,!0);break;case E.a.qU:x=u.AFrameworkApplication.Ta.ki(b.fE,a,c,!0,f,l),32===x&&yb.ParagraphReader.im(b)&&Bd.whc&&Bd.whc.fR(G)}return 32}kpi(a,b,c,f,l){const x={};x[bi.Xna]=6168;x[bi.Wna]=6169;
var G=b.view;const R=new Id.GraphTransaction(1===c?3:15);R.gd(G.root);let fa=bi.Q4(a,b,c,f,l,x,0),wa=null;G.$o&&(wa=G);G=!0;let Wa=null;wa&&(Wa=wa.Gb.Oa.kb)&&H.a.instance.ga(14)&&(Bd.Yi.bce(Wa)?(Bd.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.qD}),fa=8,G=!1):1===c&&(fa=32,G=!1));G&&this.pQj(Wa)&&(fa=H.a.instance.ga(54)?bi.Q4(E.a.u4a,b,c,f,l,x,12):bi.Q4(a,b,c,f,l,x,12));R.dispose();return fa}jpi(a,b,c){a=!0;b.contextId!==Bb.a.paragraph&&b.contextId!==Bb.a.Of?a=!1:H.a.instance.ga(14)&&Bd.Yi.dEa(b)&&(Bd.Tc.Tb(Nd.a.Ko,
{["Reason"]:Od.a.qD}),a=!1);if(1===c||!a)return a?32:8;b=b.node;c=new Id.GraphTransaction(15);c.gd(b);Bd.jo.jqb(b);Bd.paragraphEditor.oWb(b,!0);Bd.HO.PEc(b);c.dispose();return 2}hFb(a,b,c,f,l){a=b.contextId===Bb.a.paragraph;if(1===c&&!a)return 8;l.KA||(b=b.node,c=Bd.PL.wtb(b),l.KA=c,c=new nb.GraphIterator,c.set(b),c.pc(11),b=c.Rg(11),l.isRtl=b?ae.OutlineElementReader.jm(b):!1);return 32}pQj(a){return!a||cb.SelectionEditor.Uw(a)||1===a.length&&cb.SelectionEditor.Vj(a.Ua)&&!cb.SelectionEditor.Svb(a.Ua)?
!1:!0}Yee(a){Bd.ivf.Jb(a.contextId)||(Z.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",a.contextId),Bd.ivf.$(a.contextId,!0))}EFj(a){return a===E.a.lEc||a===E.a.SVb||a===E.a.TVb||a===E.a.Xpb||a===E.a.mEc}kEc(a,b){const c=a.node;b=Bd.onl(c.characterData.substr(a.Qa,a.Kb-a.Qa),b);c.characterData=c.characterData.substr(0,a.Qa)+b+c.characterData.substr(a.Kb);return 32}static get ih(){return Bd.Hf||(Bd.Hf=fb.a.instance.resolve("Box4.IFormattingEditor"))}static get characterPropertiesEditor(){return Bd.Yg||
(Bd.Yg=fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get paragraphEditor(){return Bd.Hw||(Bd.Hw=fb.a.instance.resolve("Box4.IParagraphEditor"))}static get fVj(){return Bd.dMa||(Bd.dMa=fb.a.instance.resolve("Box4.ILineSpacingHelper"))}static get HO(){return Bd.iK||(Bd.iK=fb.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get Nh(){return Bd.Ai||(Bd.Ai=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get insertionPointFormatting(){return Bd.rt||(Bd.rt=fb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static get Uca(){return Bd.Tlb||
(Bd.Tlb=fb.a.instance.resolve("Box4.List.IListFormattingEditor"))}static get PL(){return Bd.gG||(Bd.gG=fb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static Sq(){return Bd.xm||(Bd.xm=fb.a.instance.Ka("Box4.IExternalSelectionManager"))}static get Yl(){return Df.ContextSetEditor.instance}static get Yi(){return ed.a.instance}static get Tc(){return rb.a.instance}static get qe(){return Bd.Yc||(Bd.Yc=fb.a.instance.qb("Box4.IFeatureHelper"))}static get whc(){return Cb.App.kR}static get Qf(){return Bd.Xc||
(Bd.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get H5(){return Bd.Ro||(Bd.Ro=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get RRe(){return Bd.oNa||(Bd.oNa=fb.a.instance.resolve("Box4.TextFormattingHelper"))}static get Tf(){return Bd.Sg||(Bd.Sg=fb.a.instance.resolve("Box4.List.IListReader"))}static get jo(){return Bd.Po||(Bd.Po=fb.a.instance.resolve("Box4.List.IListEditor"))}static get QWe(){return OP.a.instance}static U2i(a,
b){return 42===a?b:a!==b||16===a?16:a}static XFf(a,b){a.rug||(b.rug?b=a:b.Sf===a.Sf&&De.a.Jy(b.value,a.value)||(b.value=-1));return b}static onl(a,b){switch(b){case E.a.SVb:return a.toLowerCase();case E.a.TVb:return a.toUpperCase();case E.a.lEc:case E.a.Xpb:return Bd.Bmi(a,b===E.a.Xpb);case E.a.mEc:return Bd.Xol(a);default:return a}}static Xol(a){let b="";for(let c=0;c<a.length;c++)b=a.charAt(c)===a.charAt(c).toUpperCase()?b+a.charAt(c).toLowerCase():b+a.charAt(c).toUpperCase();return b}static Bmi(a,
b){let c,f,l=!0,x=a.length,G=0,R=Bd.zce(a,G,x);for(;0<x;){f=c=!1;var fa=x;let Wa;var wa=void 0;for(wa=0;0<fa&&Bd.loi(a.charAt(G+wa));wa++,fa--)f=Bd.zVc(a.charAt(G+wa));for(Wa=wa;0<fa&&!(c=Bd.zVc(a.charAt(G+wa)))&&" "!==a.charAt(G+wa)&&"/"!==a.charAt(G+wa);wa++,fa--);fa=wa-Wa;if(0>=fa)break;G+=Wa;wa=a.substr(G,fa);wa=wa===wa.toUpperCase();if(R||!wa)a=l||f||b?a.substr(0,G)+a.charAt(G).toUpperCase()+a.substr(G+1,fa-1).toLowerCase()+a.substr(G+fa):a.substr(0,G)+a.substr(G,fa).toLowerCase()+a.substr(G+
fa);x-=fa+Wa;G+=fa;if(l=c)G++,x--,R=Bd.zce(a,G,x)}return a}static zce(a,b,c){for(;0<c&&!Bd.zVc(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toUpperCase())return!1;b++;c--}return!0}static lQj(a){for(var b=0;b<a.length&&!Bd.zVc(a.charAt(b));){if(a.charAt(b)!==a.charAt(b).toLowerCase())return!1;b++}return!0}static zVc(a){return"."===a||"!"===a||"?"===a?!0:!1}static loi(a){return-1==="0123456789".indexOf(a)&&a.toUpperCase()===a.toLowerCase()}}Bd.Hf=null;Bd.Ai=null;Bd.ivf=new ah.a;Bd.If=null;Bd.dMa=null;
Bd.Yg=null;Bd.Hw=null;Bd.iK=null;Bd.rt=null;Bd.Tlb=null;Bd.gG=null;Bd.xm=null;Bd.Yc=null;Bd.Xc=null;Bd.Ro=null;Bd.oNa=null;Bd.Sg=null;Bd.Po=null;Object(e.a)(Bd,"TextFormattingActor",null,[]);class DI{constructor(a){this.Ca=a}get kn(){return this.Ca}mHb(a,b=!1){this.kn.ki(a,E.a.G8a,2,!0,null,b)}qU(a){this.kn.La(E.a.qU,2,a)}}Object(e.a)(DI,"TextFormattingCommands",null,[388]);class au{get Xna(){return bi.Xna}get Wna(){return bi.Wna}get aLb(){return bi.aLb}Q4(a,b,c,f,l,x,G){return bi.Q4(a,b,c,f,l,x,
G)}yeb(a,b,c,f,l,x){return bi.yeb(a,b,c,f,l,x)}static get instance(){au.Ja||(au.Ja=new au);return au.Ja}}au.Ja=null;Object(e.a)(au,"ViewActionHandlerProxy",null,[417]);class EI{constructor(a){this.Ca=a}get kn(){return this.Ca}Sfk(a){if(4===a)a=E.a.leftArrow;else if(2===a)a=E.a.rightArrow;else if(1===a)a=E.a.upArrow;else if(3===a)a=E.a.downArrow;else return;this.kn.processAction(a,2)}ura(){this.kn.processAction(E.a.ura,2)}}Object(e.a)(EI,"SelectionCommands",null,[387]);class FI{Mg(a,b){return rd.SelectionFactory.Mg(a,
b)}bN(a,b){return rd.SelectionFactory.bN(a,b)}nu(a,b=!0){return rd.SelectionFactory.nu(a,b)}p2(a,b,c){return rd.SelectionFactory.p2(a,b,c)}gl(a){return rd.SelectionFactory.gl(a)}gKb(a,b,c=!1){return rd.SelectionFactory.gKb(a,b,c)}}Object(e.a)(FI,"SelectionFactoryProxy",null,[374]);var PP=d(864),qx=d(247),pz=d(977);class GI extends pz.a{constructor(a,b,c,f,l,x,G=null,R=null){super(a,x,G,R);this.Zn=this.Hw=this.A1=null;this.Foa=!1;this.y0a=u.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");
this.D1a=0;this.fFd=new Ha.a;ze.a(8128527,307,ae.OutlineElementReader.Ug(a));this.UE=b;this.UE.fpb(this);this.Svd=c;this.Po=f;this.Sg=l;this.lxk=R;this.fBd=Ib.ListReader.kk(this.zb)}get X7(){return this.A1||(this.A1=fb.a.instance.qb("Box4.IInternalLinkManager"))}get paragraphEditor(){return this.Hw||(this.Hw=fb.a.instance.resolve("Box4.IParagraphEditor"))}get aPa(){return null}get O4a(){return this.fBd&&!this.UE.Eba}get d5a(){return 0<this.D1a}get hv(){return this.Svd}get jo(){return this.Po}get Tf(){return this.Sg}get dDc(){return this.lxk}g0(a,
b){if(!this.BY.PTe(b)){ze.a(8701077,307,yb.ParagraphReader.Rk(this.zb));var c=this.zb.currentNode,f=Mc.a.QOa(c);this.y0a&&this.Zn.z6a&&(c=c.Ra.last,this.Foa&&(c.formatting=this.Zn.z6a.Ud(c),this.Foa=!1),a=this.BY.p5d(a,b),this.BY.ona(this.zb.currentNode,this.Zn.yea,b));this.characterPropertiesEditor.replaceTextRange(f,a)}}kma(){ze.a(8701078,307,yb.ParagraphReader.Rk(this.zb));const a=Mc.a.QOa(this.zb.currentNode);this.characterPropertiesEditor.eSc(a,b=>new zv.a(b,zv.a.DHc),se.AParagraphNode.AZ)}SWa(){}ima(){this.y0a&&
(this.Foa=!0)}Jva(){ze.a(8701079,307,yb.ParagraphReader.Rk(this.zb))}Iva(){ze.a(8701080,307,yb.ParagraphReader.Rk(this.zb))}fA(a){this.UE.Eba||(this.y0a?(this.SJd(a),this.Zn.Imd(this.zb.currentNode),a&&"P"===a.ZT.u3b&&this.dDc.cJa(this.zb.currentNode,this.Zn.had),this.BY.ona(this.zb.currentNode,this.Zn.yea,a)):this.Ndi(a))}eA(){this.UE.Eba||this.z2()}Ova(){}DHa(){}nma(){ze.a(8701081,307,ae.OutlineElementReader.Ug(this.zb)||bj.OutlineReader.Lt(this.zb)||yb.ParagraphReader.Rk(this.zb)&&this.UE.Eba);
let a=!1;this.d5a||(a=this.O4a||!0);a||(this.RL+=1);this.D1a++}lma(){this.D1a--;let a=!1;this.d5a||(a=this.O4a||!0);a||--this.RL}Nva(a){ze.a(8701082,307,ae.OutlineElementReader.Ug(this.zb)||bj.OutlineReader.Lt(this.zb)||yb.ParagraphReader.Rk(this.zb)&&this.UE.Eba);ze.a(8701083,307,0!==a.listStyleType)}mma(){ze.a(8701084,307,ae.OutlineElementReader.Ug(this.zb)||yb.ParagraphReader.Rk(this.zb)&&this.UE.Eba);this.UE.Eba||ze.a(8701085,307,this.zb.pI(2))}FX(a){this.UE.FX(a)}CX(){this.UE.CX()}umd(a){this.fFd.add(a)}EX(a){this.UE.EX(a)}DX(){this.UE.DX()}BX(a){this.UE.BX(a)}AX(){this.UE.AX()}Ndi(a){this.DCb(!1);
(new nb.GraphIterator).Pc(this.zb);a=pz.a.Nh.yba(this.zb,this.SQa(a));ze.a(8128534,307,a===this.zb.currentNode);ze.a(8128535,307,yb.ParagraphReader.Vd(a))}z2(){ze.a(8128536,307,yb.ParagraphReader.Rk(this.zb));Xb.OutlineElementNavigator.Ke(this.zb)}reset(){this.y0a&&(super.reset(),this.Zn=this.F_d(!0))}SJd(a){this.DCb(!1);(new nb.GraphIterator).Pc(this.zb);a=pz.a.Nh.yba(this.zb,this.SQa(a));ze.a(36577367,307,a===this.zb.currentNode);ze.a(36577368,307,yb.ParagraphReader.Vd(a));-1!==this.Zn.JD&&this.paragraphEditor.$L(a,
this.Zn.JD);this.Zn.lineSpacing&&this.dDc.C0(a,this.Zn.lineSpacing);this.Zn.lfa&&this.dDc.Boh(a,this.Zn.lfa);this.Zn.gXc&&this.dDc.snh(a,this.Zn.gXc);this.Foa=!0;this.Zn.paragraph=a}static pQd(a,b){let c=0;switch(b){case 3:c=we.a.Csa(a);break;case 7:c=Re.a.Cea(a,0);break;case 1:c=we.a.HNd(a);break;case 5:c=we.a.Csa(we.a.ebd(a));break;default:Z.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",a,b)}return c}}Object(e.a)(GI,"TextOnlyBox4PasteSteward",
pz.a,[]);class uC{constructor(a,b,c,f){this.FQb=a;this.Po=b;this.Sg=c;this.BY=f}create(a,b,c,f,l=null,x=null){return 1===a?new GI(b,f,this.FQb,this.Po,this.Sg,l,x,this.BY):new qx.Box4PasteSteward(b,c,f,this.FQb,this.Po,this.Sg,l,x,this.BY)}}Object(e.a)(uC,"Box4PasteStewardFactory",null,[422]);class Gg{static get mvj(){return Gg.bPh}static get svj(){return Gg.ePh}static get rvj(){return Gg.dPh}static pDk(a,b){const c=a.currentNode;Qd.forEachCell(a,b.rowSpan,b.colSpan,(f,l,x)=>{const G=f.currentNode;
G!==c&&(G.isGhostCell=!0,Gg.jYf(f),!x&&1<=b.colSpan&&(G.colSpan=b.colSpan),Gg.Zmh(f,b.x5,l,x,b.rowSpan,b.colSpan))})}static JDk(a,b){Qd.forEachCell(a,b.rowSpan,b.colSpan,c=>{Gg.Uai(c);Gg.jYf(c)})}static Uai(a){a=a.currentNode;a.isGhostCell=!0;a.isSkippedCell=!0;a.mhb=!0}static jYf(a){a&&(a.Ab(1),Object(Ma.a)(eI.a,a.currentNode)&&a.Ii())}static lbi(a,b,c){0<b&&(a=Object(ua.a)(px.TableCellNode,a.currentNode))&&(a.width=c?b:Re.a.Ff(b,0))}static Aai(a,b,c){if(a=Object(ua.a)(uy.a,a.currentNode))0<b&&(a.Rl=
Re.a.Cea(b,0)),0<c&&(a.IX=Re.a.Cea(c,0))}static wIf(a,b){void 0!==b&&null!==b&&a.currentNode.properties.setValue(Mb.a.eRe,Gg.svj[b+""])}static iIf(a,b){void 0!==b&&null!==b&&""!==b&&a.currentNode.properties.setValue(tb.a.iEc,parseInt(qx.Box4PasteSteward.Q4a(b),16))}static $ij(a){const b=new nb.GraphIterator;b.Pc(a);return(a=Vh.OutlineNavigator.Jfd(b))&&bj.OutlineReader.Lt(b)?a.Xh(Mb.a.vea)-a.Xh(Mb.a.marginLeft)-a.Xh(Mb.a.marginRight):0}static mOj(a){return!(void 0===a||null===a||1===a)}static S2k(a,
b,c,f,l){if(void 0===b||null===b||""!==b){switch(b){case "thin":b=we.a.dbd(.25);break;case "initial":case "medium":b=we.a.dbd(.5);break;case "thick":b=we.a.dbd(1);break;default:b=Gg.lgj(b,c,f)}l.currentNode.properties.setValue(a,b)}}static qKe(a,b,c){void 0!==b&&null!==b&&0!==b&&c.currentNode.properties.setValue(a,Gg.rvj[b+""])}static R2k(a,b,c){void 0!==b&&null!==b&&""!==b&&c.currentNode.properties.setValue(a,parseInt(qx.Box4PasteSteward.Q4a(b),16))}static lgj(a,b,c){let f=0;const l=({Sf:a}=qx.Box4PasteSteward.qad(a)).returnValue;
switch(a){case 5:f=we.a.dbd(l);break;case 1:f=we.a.dmi(l);break;case 3:f=we.a.Ung(l);break;case 7:f=Re.a.Fxk(l,c)}if(6===b||7===b||10===b)f/=3;return Math.round(f)}static mgj(a,b){let c=0;const f=({Sf:a}=qx.Box4PasteSteward.qad(a)).returnValue;switch(a){case 5:c=we.a.mH(f);break;case 1:c=we.a.emi(f);break;case 3:c=we.a.cW(f);break;case 7:c=Re.a.Ff(f,b)}return c}static lhd(a,b,c,f,l,x,G){if(l&&(!G||16===l.oi||G||14!==l.oi)&&12!==c){if(G)switch(f){case 7:f=Mb.a.Xwh;var R=Mb.a.Zwh;var fa=Mb.a.Ywh;var wa=
0;break;case 6:f=Mb.a.Uwh;R=Mb.a.Wwh;fa=Mb.a.Vwh;wa=1;break;case 0:f=Mb.a.Owh;R=Mb.a.Qwh;fa=Mb.a.Pwh;wa=0;break;case 5:f=Mb.a.Rwh;R=Mb.a.Twh;fa=Mb.a.Swh;wa=1;break;default:return}else switch(f){case 7:f=Mb.a.Rll;R=Mb.a.Tll;fa=Mb.a.Sll;wa=0;break;case 6:f=Mb.a.Oll;R=Mb.a.Qll;fa=Mb.a.Pll;wa=1;break;case 0:f=Mb.a.Ill;R=Mb.a.Kll;fa=Mb.a.Jll;wa=0;break;case 5:f=Mb.a.Lll;R=Mb.a.Nll;fa=Mb.a.Mll;wa=1;break;default:return}void 0!==l.currentNode&&null!==l.currentNode&&(Gg.mOj(c)?(Gg.R2k(f,a,l),Gg.qKe(R,c,l),
Gg.S2k(fa,b,c,wa,l)):x||G||l.currentNode.properties.setValue(R,"nil"))}}static Zmh(a,b,c,f,l,x){f||(Gg.cIf(b,a,!1,!1),Gg.hKd(b,a,!0,!1));f===x-1&&Gg.hKd(b,a,!0,!1);c||Gg.uIf(b,a,!0,!1);c===l-1&&Gg.UHf(b,a,!0,!1)}static SHf(a,b,c,f){a&&(Gg.uIf(a,b,c,f),Gg.hKd(a,b,c,f),Gg.UHf(a,b,c,f),Gg.cIf(a,b,c,f))}static uIf(a,b,c,f){Gg.lhd(a.borderTopColor,a.borderTopWidth,a.borderTopStyle,7,b,c,f)}static hKd(a,b,c,f){Gg.lhd(a.borderRightColor,a.borderRightWidth,a.borderRightStyle,6,b,c,f)}static UHf(a,b,c,f){Gg.lhd(a.borderBottomColor,
a.borderBottomWidth,a.borderBottomStyle,0,b,c,f)}static cIf(a,b,c,f){Gg.lhd(a.borderLeftColor,a.borderLeftWidth,a.borderLeftStyle,5,b,c,f)}static mhd(a,b,c){if(c&&16===c.oi&&""!==a){switch(b){case 3:b=Mb.a.rJb;var f=0;break;case 2:b=Mb.a.qJb;f=1;break;case 0:b=Mb.a.nJb;f=0;break;case 1:b=Mb.a.oJb;f=1;break;default:return}(a=Gg.mgj(a,f))&&c.currentNode.properties.setValue(b,a)}}static lai(a,b){b&&(Gg.gbi(b,a),Gg.Qai(b,a),Gg.mai(b,a),Gg.Fai(b,a))}static gbi(a,b){Gg.mhd(a.Zli,3,b)}static Qai(a,b){Gg.mhd(a.Yli,
2,b)}static mai(a,b){Gg.mhd(a.Wli,0,b)}static Fai(a,b){Gg.mhd(a.Xli,1,b)}}Gg.Kgk=8;Gg.eGi="Table Grid";Gg.bPh=ta.a.tH("MsoNormalTable","Normal Table","MsoTableGrid",Gg.eGi,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2",
"Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5",
"Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2",
"Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5",
"Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6",
"MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1",
"List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3",
"MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4",
"MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3",
"MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5",
"List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6",
"List Table 7 Colorful Accent 6");Gg.ePh=ta.a.tH("0","center","1","top","2","center","3","bottom");Gg.dPh=ta.a.tH("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset");Object(e.a)(Gg,"Box4TableStewardHelper",null,[]);class rx{constructor(a,b,c,f=!1,l=!1,x=!1){this.Gv=null;this.E1a=0;this.zb=a;this.jo=b;this.Hq=c;this.snb=f;this.QQb=l;this.cBd=x}fpb(a){this.Gv=a}get Eba(){return 0<this.E1a}FX(a){ze.a(7869459,
307,!!this.Gv);ze.a(7869460,307,ae.OutlineElementReader.Ug(this.zb)||bj.OutlineReader.Lt(this.zb));ze.c(38563978,307,50,"Table pasting started");this.Gv.DCb(!0);const b=new nb.GraphIterator;b.Pc(this.zb);Object(ua.a)(String,Gg.mvj[a.Svh]);const c=this.Hq.CLk(this.zb,a.WX,a.Dqa,this.Gv.SQa(a),a.Otg);if(this.snb&&(ze.c(23938568,307,50,a.DOa?"Table-widths exist":"Table-widths missing, table may be invalid"),a.cRe&&Gg.SHf(a.cRe,this.zb,!1,!0),Gg.Aai(this.zb,a.Q7d.Chl,a.Q7d.Bhl),a.DOa)){var f=0;const R=
Array(a.DOa.length);var l=0;a.jEa&&H.a.instance.ga(63)&&(l=(l=we.a.wBh(Gg.$ij(this.zb)))?l:1);for(var x=0;x<a.DOa.length;x++)R[x]=0<l?l/100*a.DOa[x]:Re.a.Ff(a.DOa[x],0),f+=R[x];l=c.getValue(tb.a.Iu);var G=new nb.GraphIterator;G.Pc(this.zb);a=0;if(Se.isInTableCell(G)){if(l=Qd.returnToContainingCell(G))a=l.width;x=Nn.a(G);G=Qd.returnToContainingTable(G);if(-1!==x&&x<=G.FOa.length){let fa=0;for(let wa=x;wa<x+l.colSpan&&wa<G.FOa.length;wa++)fa+=G.FOa[wa];a=Math.min(a,fa);a===fa&&(a-=Re.a.Ff(Gg.Kgk,0))}}else if(l)for(x=
0;x<l.length;x++)a+=l[x];if(0<a&&f>a&&f)for(f=a/f,a=0;a<R.length;a++)R[a]*=f;c.setValue(tb.a.Iu,R)}this.Gv.xCc(b,!1);this.E1a++;H.a.instance.ga(63)&&Ib.ListReader.kk(b)&&this.Gv.umd(b.currentNode);ze.a(7869461,307,Jd.TableReader.Vp(this.zb))}CX(){ze.a(7869462,307,!!this.Gv);ze.a(7869463,307,gk.l(this.zb));ze.c(38563979,307,50,"Table pasting finished");Xb.OutlineElementNavigator.Ke(this.zb);this.E1a--}EX(a){ze.a(7869464,307,!!this.Gv);Jd.TableReader.Vp(this.zb)?Qd.moveToFirstRow(this.zb):gk.l(this.zb)&&
Qd.moveToNextRow(this.zb);this.snb&&a.height&&this.zb.currentNode.setValue(Mb.a.au,Re.a.Ff(a.height,1));ze.a(7869465,307,gk.l(this.zb))}DX(){ze.a(7869466,307,!!this.Gv);ze.a(7869467,307,Se.isTableCell(this.zb));Qd.returnToContainingRow(this.zb)}BX(a){ze.a(7869468,307,!!this.Gv);ze.a(7869469,307,!this.Gv.RL);gk.l(this.zb)?Qd.moveToFirstColumn(this.zb):Se.isTableCell(this.zb)?Qd.moveToNextColumn(this.zb):ze.a(7869471,307,!1);u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings");
if(this.QQb){if(!this.zb.currentNode)return;var b=Object(ua.a)(px.TableCellNode,this.zb.currentNode);ze.a(50689760,307,!b&&16!==this.zb.currentNode.type||!!b&&16===this.zb.currentNode.type);if(!b)return;let c=new nb.GraphIterator;c.Pc(this.zb);if(!a.colSpan||!a.rowSpan)return;if(a.Owb){Gg.JDk(c,a);return}if(1<a.colSpan||1<a.rowSpan){const f=Qd.returnToContainingTable(c);if(!f)return;f.setValue(Mb.a.complexTable,!0);c.Pc(this.zb);Gg.pDk(c,a);b.rowSpan=a.rowSpan;b.colSpan=a.colSpan}}this.snb&&(Gg.iIf(this.zb,
a.zlc),Gg.wIf(this.zb,a.verticalAlignment),this.cBd&&Gg.lai(this.zb,a.ald));this.QQb&&Gg.SHf(a.x5,this.zb,!a.colSpan&&!a.rowSpan,!1);this.snb&&(this.QQb||(b=new nb.GraphIterator,b.Pc(this.zb),Qd.forEachCell(b,a.rowSpan,a.colSpan,(c,f,l)=>{Gg.iIf(c,a.zlc);Gg.wIf(c,a.verticalAlignment);Gg.Zmh(c,a.x5,f,l,a.rowSpan,a.colSpan)})),Gg.lbi(this.zb,a.width,a.jEa));ze.a(7869472,307,bj.OutlineReader.Lt(this.zb))}AX(){ze.a(7869473,307,!!this.Gv);ze.a(7869474,307,ae.OutlineElementReader.Ug(this.zb)||Se.isTableCell(this.zb));
Qd.returnToCell(this.zb);ze.a(7869475,307,0>=this.Gv.RL);this.Gv.xOd()}static get Nh(){return rx.Ai||(rx.Ai=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}}rx.Ai=null;Object(e.a)(rx,"Box4TableSteward",null,[444,445]);class bu{constructor(a,b,c){this.Gv=null;this.E1a=0;this.zb=a;this.jo=b;this.Hq=c}fpb(a){this.Gv=a}get Eba(){return 0<this.E1a}FX(){this.Eba&&(ze.a(8787101,307,yb.ParagraphReader.Rk(this.zb)),Xb.OutlineElementNavigator.Ke(this.zb));ze.a(8701086,307,!!this.Gv);ze.a(8701087,307,ae.OutlineElementReader.Ug(this.zb)||
bj.OutlineReader.Lt(this.zb));this.E1a++}CX(){ze.a(8701088,307,!!this.Gv);Xb.OutlineElementNavigator.Ke(this.zb);this.E1a--;if(this.Eba){this.Gv.DCb(!0);const a=bu.Nh.yba(this.zb);ze.a(8787102,307,a===this.zb.currentNode);ze.a(8787103,307,yb.ParagraphReader.Rk(this.zb))}}EX(a){ze.a(8701089,307,!!this.Gv);this.Gv.DCb(!0);const b=new nb.GraphIterator;b.Pc(this.zb);this.Gv.xCc(b,!1);H.a.instance.ga(63)&&Ib.ListReader.kk(b)&&this.Gv.umd(b.currentNode);a=bu.Nh.yba(this.zb,this.Gv.SQa(a));ze.a(8701090,
307,a===this.zb.currentNode);ze.a(8701091,307,yb.ParagraphReader.Rk(this.zb))}DX(){ze.a(8701120,307,!!this.Gv);ze.a(8701121,307,yb.ParagraphReader.Rk(this.zb));Xb.OutlineElementNavigator.Ke(this.zb)}BX(){ze.a(8701122,307,!!this.Gv);ze.a(8701123,307,yb.ParagraphReader.Rk(this.zb));ze.a(8701124,307,!this.Gv.RL);var a=this.zb.currentNode;yb.ParagraphReader.textLength(a)&&(a=Mc.a.QOa(a),this.Gv.characterPropertiesEditor.replaceTextRange(a,", "))}AX(){ze.a(8701125,307,!!this.Gv);ze.a(8701126,307,yb.ParagraphReader.Rk(this.zb));
ze.a(8701127,307,0>=this.Gv.RL);this.Gv.xOd()}static get Nh(){return bu.Ai||(bu.Ai=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}}bu.Ai=null;Object(e.a)(bu,"TextOnlyBox4TableSteward",null,[444,445]);class vC{constructor(a,b,c=!1,f=!1,l=!1){this.Po=a;this.gD=b;this.snb=c;this.QQb=f;this.cBd=l}create(a,b){return 1===a?new bu(b,this.Po,this.gD):new rx(b,this.Po,this.gD,this.snb,this.QQb,this.cBd)}}Object(e.a)(vC,"Box4TableStewardFactory",null,[421]);class HI{create(){return new tn.a}}Object(e.a)(HI,
"Factory",null,[375]);class II{Wb(a){a.register(uC,"Box4.Actors.Box4PasteStewardFactory").as("Box4.Actors.IBox4PasteStewardFactory").ma().na(()=>new uC(nv.a.Htb,a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.Actors.IBox4PasteStewardBridge")));a.register(WB,"Box4.Actors.Box4PasteStewardUtils").as("Box4.Actors.IBox4PasteStewardUtils").ma().na(()=>new WB(u.AFrameworkApplication.fa.ka("WacPasteBrAsNewParagraphIsEnabled")));a.register(xH.ClipboardActor,"Box4.Actors.ClipboardActor").ma().na(()=>
new xH.ClipboardActor(a.le("Box4.Actors.IClipboardOperationFactory"),a.resolve("Box4.Actors.ISystemClipboard"),rb.a.instance,a.resolve("Box4.IClipboardDataHelper"),qd.a.instance,u.AFrameworkApplication.Ta,a.resolve("Box4.IUndoManager"),u.AFrameworkApplication.fa));a.register(368,"Common.App.ChromeExtensionHelper.IChromeExtensionHelper").ma().na(()=>new WA(u.AFrameworkApplication.fa));a.register(369,"Box4.Clipboard.ISystemClipboardAccessManagerFactory").ma().na(()=>new vI(u.AFrameworkApplication.fa,
a.resolve("Common.App.ChromeExtensionHelper.IChromeExtensionHelper"),a.resolve("Box4.IClipboardDataHelper"),pc.a.instance));a.register(370,"Box4.Clipboard.ISystemClipboardAccessManager").ma().na(()=>a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory").create());a.register(371,"Box4.Actors.ISystemClipboard").ma().na(()=>new rI(a.resolve("Box4.Clipboard.ISystemClipboardAccessManager"),pa.InteractiveViewManager.instance,Cb.App.Hb.Hd,v.FocusManager.instance(),a.resolve("Box4.IEditingDomManager"),
a.resolve("Box4.IEditViewStateManager"),pc.a.instance));a.register(372,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().na(()=>new AH);a.register(373,"Box4.Actors.IDeleteTableSegmentStrategy").ma().na(()=>new wI);a.register(374,"Box4.ISelectionFactory").ma().na(()=>new FI);a.register(375,"Box4.IRenderOrderGraphIteratorFactory").ma().na(()=>new HI);a.register(376,"Common.IDomElementContentStateFactory").ma().na(()=>new eH);a.register(377,"Box4.Actors.IClipboardOperationPasteOvertypeStrategy").ma().na(()=>
new MH(qd.a.instance,a.resolve("Box4.IParagraphReader"),a.resolve("Box4.Styles.IStyleReader"),H.a.instance.ga(71)));a.register(pC,"Box4.Actors.PasteFloatieFeatureSetBuilder").ma().na(()=>new pC(a.resolve("Box4.IClipboardDataHelper"),Cb.App.nD.jS));a.register(378,"Box4.Actors.IClipboardOperationPasteFactory").ma().na(()=>new KH(rb.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.Actors.PasteCoordinator"),yg.a.instance,qd.a.instance,u.AFrameworkApplication.Ta,a.resolve("Box4.Actors.IClipboardOperationPasteStrategyFactory"),
a.le("Box4.IUndoManager"),a.resolve("Common.IDomElementContentStateFactory"),a.resolve("Box4.Actors.IClipboardOperationPasteOvertypeStrategy"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance));a.register(379,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().na(()=>new zH(u.AFrameworkApplication.Ta,rb.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),qd.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),
Qh.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper")));a.register(380,"Box4.Actors.IClipboardOperationClipboardAccessHelper").ma().na(()=>new yH(rb.a.instance,pc.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Common.ISimpleOperationFactory"),
u.AFrameworkApplication.fa.appSettings.ChromeClipboardAccessOperationTimeout));a.register(381,"Box4.Actors.IClipboardOperationPasteStrategyFactory").ma().na(()=>new PH(u.AFrameworkApplication.fa));a.register(382,"Box4.Actors.IClipboardOperationFactory").ma().na(()=>new IH(a.resolve("Box4.Actors.InternalClipboard"),u.AFrameworkApplication.Ta,u.AFrameworkApplication.pjd()&&!(r.a.QS&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix")),rb.a.instance,Qh.a.instance,pc.a.instance,a.resolve("Box4.Graph.IGraphTransactionFactory"),
a.resolve("Box4.Actors.IClipboardOperationPasteFactory"),a.resolve("Box4.Actors.IClipboardOperationCutCopyFactory"),a.resolve("Box4.Actors.IClipboardOperationClipboardAccessHelper"),a.resolve("Box4.Actors.ClipboardOperationWordStrategy"),a.resolve("Box4.ICannotCutDialog"),a.resolve("Common.ISimpleOperationFactory"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IUndoManager"),a.resolve("Box4.IPasteFloatieEventSource"),
a.resolve("Common.Utils.Telemetry.ITelemetry")));a.register(383,"Box4.Actors.IExternalPasteExecutionManagerFactory").ma().na(()=>new $H(a.le("Box4.Actors.IBox4PasteStewardFactory"),a.le("Box4.Actors.IBox4ImageStewardFactory"),a.le("Box4.Actors.IBox4TableStewardFactory"),a.le("Box4.Actors.IBox4WordConverterFactory"),a.resolve("HtmlImport.IHtmlTranslatorSettings"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.Actors.IExternalPasteCssConverter"),a.resolve("HtmlImport.IHtmlNormalizerSettings")));
a.register(Mh,"Box4.Actors.InternalClipboard").ma().na(()=>new Mh(a.resolve("Box4.Images.IImageEditor"),a.resolve("Box4.ITableEditor"),a.resolve("Box4.IOutlineEditor"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.List.IListEditor"),Cb.App.JO,a.resolve("Box4.IParagraphIndentationReader"),u.AFrameworkApplication.fa,a.resolve("Box4.Graph.IGraphNodeFactory"),a.resolve("Box4.Graph.IGraphTransactionFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,a.resolve("Box4.IConstantsProvider").Wlh,a.resolve("Box4.IFormattingPropertyTransitStrategy")));a.register(384,"Box4.Actors.IInternalPasteExecutionManagerFactory").ma().na(()=>new mI(a.resolve("Box4.Actors.InternalClipboard"),new Sa.a(()=>Cb.App.Hb.Hd.nn)));a.register(385,"Box4.List.IListCommands").ma().na(()=>new xI(u.AFrameworkApplication.Ta));a.register(Mr,"Box4.Actors.PasteCoordinator").ma().na(()=>new Mr(a.resolve("Box4.Actors.InternalClipboard"),
a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory")));H.a.instance.ga(78)||a.register(vC,"Box4.Actors.Box4TableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().na(()=>new vC(fb.a.instance.resolve("Box4.List.IListEditor"),fb.a.instance.resolve("Box4.ITableEditor"),a.resolve("Common.IAppSettingsManager").ka("TablePasteRefactoringAndFixesIsEnabled"),a.resolve("Common.IAppSettingsManager").ka("PasteComplexTablesIsEnabled"),
a.resolve("Common.IAppSettingsManager").ka("PasteTableCellMarginImprovementsIsEnabled")));a.register(hC,"Box4.Actors.ClipboardOperationWordStrategy").ma().na(()=>new hC(rb.a.instance,qd.a.instance,Cb.App.Ih,ed.a.instance,H.a.instance.ga(14),H.a.instance.ga(50)));a.register(eC,"Box4.Actors.Box4WordConverterFactory").as("Box4.Actors.IBox4WordConverterFactory").ma().na(()=>new eC(u.AFrameworkApplication.fa));a.register(386,"Box4.Actors.IExternalPasteCssConverter").ma().na(()=>new QH(u.AFrameworkApplication.fa));
a.register(387,"Box4.ISelectionCommands").ma().na(()=>new EI(u.AFrameworkApplication.Ta));a.register(388,"Box4.ITextFormattingCommands").ma().na(()=>new DI(u.AFrameworkApplication.Ta));a.register(UB,"Box4.Actors.AccessibilityActor").ma().na(()=>new UB(a.Ka("Box4.Accessibility.IAccessibilityContextManager"),a.resolve("Box4.Proofing.IErrorRangeEditor")));a.register(wq,"Box4.Actors.InsertionPointFormatting").as("Box4.IInsertionPointFormatting").ma().na(()=>new wq(a.qb("Box4.IFontSlotProvider"),a.resolve("Box4.Actors.IFontNameFormattingStrategy")));
a.register(sC,"Box4.Actors.ProofingActor").ma().na(()=>new sC(fb.a.instance.resolve("Box4.Proofing.IErrorRangeEditor"),u.AFrameworkApplication.Ta,()=>fb.a.instance.resolve("Box4.UI.ILanguageDialog"),fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),fb.a.instance.resolve("Box4.Graph.IGraphTransactionFactory"),qd.a.instance,fb.a.instance.Ka("Box4.IExternalSelectionManager"),Qh.a.instance,fb.a.instance.resolve("Box4.ISelectionContextMenuProvider"),ed.a.instance,rb.a.instance,fb.a.instance.resolve("Box4.IContextMenuController"),
fb.a.instance.resolve("Box4.Proofing.IProofingFeatureConfiguration"),fb.a.instance.Ka("Box4.Actors.IProofingErrorPresenter"),H.a.instance));a.register(tC,"Box4.Actors.StyleActor").ma().na(()=>new tC(fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),fb.a.instance.resolve("Box4.Styles.IStyleEditor"),PP.a.instance,fb.a.instance.resolve("Box4.IFormattingEditor"),Df.ContextSetEditor.instance,fb.a.instance.resolve("Box4.IInsertionPointFormatting"),ed.a.instance,rb.a.instance,fb.a.instance.resolve("Box4.TextFormattingHelper"),
au.instance));a.register(Bd,"Box4.Actors.TextFormattingActor").ma().na(()=>new Bd(a.resolve("Box4.Actors.IFormattingViewOperationFinishedStageProcessor"),a.resolve("Box4.Actors.IEopFormattingStrategy"),a.resolve("Box4.ITextRenderingStrategy"),a.resolve("Box4.IHyperlinkStrategy"),pa.InteractiveViewManager.instance));a.register(VB,"Box4.Actors.AutoCorrectActor").ma().na(()=>new VB(u.AFrameworkApplication.Ta,rb.a.instance,()=>fb.a.instance.resolve("Box4.UI.IAutoCorrectOptionsDialog")))}}Object(e.a)(II,
"Box4ActorsComponentConfiguration",null,[3]);const RP=(a,b,c)=>Cb.App.MTd?8:2===c?(a=new Di.StandardDialog,a.yd=4,a.Zwa(1),a.Ue(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),a.Ue(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),a.Xel(QP),32):2,QP=a=>{1===a&&u.AFrameworkApplication.Ta.processAction(E.a.yUd,2)},JI=(a,b,c)=>{if(Cb.App.MTd)return 8;if(1===c)return b.node.Sa(tb.a.embeddedFileContainer)?32:2;if(2===c&&(b.contextId===Bb.a.view&&b.view.Gb&&(b=b.view.Gb.Kj),db.EmbeddedFileReader.HHj(b))){a=
db.EmbeddedFileReader.b0d(b.node);Pi.a.T8k();try{SP(a)}catch(f){Z.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",f)}}return 32},SP=a=>{if(1!==Cb.App.mode||!u.AFrameworkApplication.fa.ka("OneNoteSaveFileThroughRequest")||u.AFrameworkApplication.fa.ka("IsTeamsSession")&&r.a.QS)window.open(a);else{var b=(new hj.QueryStringBuilder(a)).Haj(),c=new XMLHttpRequest;c.onloadstart=()=>{c.responseType="blob"};c.open("GET",a,!0);c.onload=()=>{try{const G=c.response;let R=b;R||(R="GetImage",
G.type&&-1!=G.type.indexOf("image/")&&"bmp gif ico jpeg png svg tiff webp".split(" ").forEach(fa=>{-1!=G.type.indexOf(fa)&&(R="GetImage."+fa)}));R=decodeURIComponent(escape(R));if(r.a.US)"undefined"!==typeof navigator.msSaveBlob?navigator.msSaveBlob(G,R):window.open(a);else{var f=window.URL||window.webkitURL,l=f.createObjectURL(G),x=document.createElement("a");x.href=l;x.download=R;document.body.appendChild(x);x.click();setTimeout(()=>{document.body.removeChild(x);f.revokeObjectURL(l)},0)}}catch(G){window.open(a)}};
c.send()}};var TP=d(547),xq=d(1195),Av;(function(a){a[a.automatic=1]="automatic";a[a.clear=2]="clear";a[a.themeColors=3]="themeColors";a[a.standardColors=4]="standardColors";a[a.recentColors=5]="recentColors"})(Av||(Av={}));Object(e.b)("ColorMenuControls",Av);class sx{constructor(a){this.eQb=this.fQb=null;this.xrc={};this.F1=a}j4b(){this.eQb=this.fQb=null}$7f(a,b){if(this.eQb)return this.eQb;if(!a)return null;const c=Object.assign(new wj.a,{Id:String.format("menu{0}Color",this.F1),ExternalId:String.format("{0}Color",
this.F1)});c.MenuSectionList=[];Array.add(c.MenuSectionList,this.D0h());Array.add(c.MenuSectionList,this.M0h());Array.add(c.MenuSectionList,this.g4h(a,b));Array.add(c.MenuSectionList,this.Q3h());return this.eQb=c}wyi(a,b){if(this.fQb)return this.fQb;a=this.$7f(a,b);return this.fQb=lj.l(a)}YAc(a,b){Av[a]in this.xrc||(this.xrc[Av[a]]=b)}k4h(a){a.OCf(Object(C.a)(this,this.j4b,"invalidateMenu"),1)}D0h(){if(!({actionId:b}=this.Mmd(1)).returnValue)return null;const a=Object.assign(new Mi.a,{Id:String.format("{0}Color",
this.F1),ControlsId:String.format("{0}.Color.Menu.Controls",this.F1),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new Ef.a,{Command:b.toString(),LabelText:Ka.a.je(Box4Intl.Box4Strings.L_Automatic),Image16by16:u.AFrameworkApplication.gm,Image16by16Class:vo.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});Array.add(a.ControlList,b);return a}M0h(){if(!({actionId:b}=this.Mmd(2)).returnValue)return null;const a=Object.assign(new Mi.a,{Id:String.format("{0}Color",
this.F1),ControlsId:String.format("{0}.Color.Menu.Controls",this.F1),DisplayMode:"Menu16",ControlList:[]});var b=Object.assign(new Ef.a,{Command:b.toString(),LabelText:Ka.a.je(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:u.AFrameworkApplication.gm,Image16by16Class:vo.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});Array.add(a.ControlList,b);return a}g4h(a,b){if(!({actionId:f}=this.Mmd(3)).returnValue)return null;const c=Object.assign(new Mi.a,{Id:"Colors",
ControlsId:String.format("{0}.Color.Menu.Controls",this.F1),ControlList:[]});var f=Object.assign(new Sy.a,{Id:String.format("Theme{0}ColorPicker",this.F1),ExternalId:String.format("Theme{0}ColorPicker",this.F1),McuExternalId:String.format("Theme{0}ColorPickerMCU",this.F1),McuLayout:!0,Command:f.toString(),Width:10});f.Colors=sx.Whj(a,b);Array.add(c.ControlList,f);return c}Q3h(){if(!({actionId:b}=this.Mmd(4)).returnValue)return null;const a=Object.assign(new Mi.a,{Id:String.format("{0}Colors",this.F1),
ControlsId:String.format("{0}.Color.Menu.Controls",this.F1),Title:Ka.a.je(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]});var b=Object.assign(new Sy.a,{Id:String.format("Standard{0}ColorPicker",this.F1),ExternalId:String.format("Standard{0}ColorPicker",this.F1),Command:b.toString(),Width:10,Colors:[]});b.Colors=sx.bgj();Array.add(a.ControlList,b);return a}Mmd(a){a=Av[a];return a in this.xrc?{returnValue:!0,actionId:this.xrc[a]}:{returnValue:!1,actionId:0}}static bgj(){const a=[];a.push(Object.assign(new xq.a,
{Color:"0000C0",Alt:Ka.a.je(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"}));a.push(Object.assign(new xq.a,{Color:"0000FF",Alt:Ka.a.je(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"}));a.push(Object.assign(new xq.a,{Color:"00C0FF",Alt:Ka.a.je(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"}));a.push(Object.assign(new xq.a,{Color:"00FFFF",Alt:Ka.a.je(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"}));a.push(Object.assign(new xq.a,{Color:"50D092",
Alt:Ka.a.je(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"}));a.push(Object.assign(new xq.a,{Color:"50B000",Alt:Ka.a.je(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"}));a.push(Object.assign(new xq.a,{Color:"F0B000",Alt:Ka.a.je(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"}));a.push(Object.assign(new xq.a,{Color:"C07000",Alt:Ka.a.je(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"}));a.push(Object.assign(new xq.a,{Color:"602000",
Alt:Ka.a.je(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"}));a.push(Object.assign(new xq.a,{Color:"A03070",Alt:Ka.a.je(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"}));return a}static Whj(a,b){const c=a.properties.sa(Mb.a.themeColors,null);a=a.properties.getValue(Mb.a.pyh).split(" ");const f=Array(10);f[0]=Box4Intl.Box4Strings.l_ThemeLabel1;f[1]=Box4Intl.Box4Strings.l_ThemeLabel2;f[2]=Box4Intl.Box4Strings.l_ThemeLabel3;f[3]=Box4Intl.Box4Strings.l_ThemeLabel4;f[4]=
Box4Intl.Box4Strings.l_ThemeLabel5;f[5]=Box4Intl.Box4Strings.l_ThemeLabel6;f[6]=Box4Intl.Box4Strings.l_ThemeLabel7;f[7]=Box4Intl.Box4Strings.l_ThemeLabel8;f[8]=Box4Intl.Box4Strings.l_ThemeLabel9;f[9]=Box4Intl.Box4Strings.l_ThemeLabel10;const l=[];for(let R=0;6>R;R++)for(let fa=0;10>fa;fa++){var x=10*R+fa,G=c[x];x=x+1<<24;G=G&4278190080|(G&255)<<16|G&65280|(G&16711680)>>>16;const wa=sx.npl(f,R,fa,b[a[fa]],c[fa]);l.push(Object.assign(new xq.a,{Color:Ka.a.Sv(x,8),DisplayColor:"#"+Ka.a.Sv(G,6),Alt:Ka.a.je(wa)}))}return l}static npl(a,
b,c,f,l){if(b){var x=l&255,G=(l&65280)>>>8;l=(l&16711680)>>>16;x=Math.floor((Math.min(Math.min(x,G),l)+Math.max(Math.max(x,G),l))/2);--b;x?255===x?(x=!0,b=[242,217,191,166,127][b]):204<x?(x=!1,b=[229,191,127,64,25][b]):51>x?(x=!0,b=[25,64,127,191,229][b]):(G=[51,102,153],l=[191,127],b=(x=b<G.length)?G[b]:l[b-G.length]):(x=!1,b=[127,166,191,217,242][b]);b=255-b;return String.format(x?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,f,a[c],Math.round(100*
b/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,f,a[c])}}Object(e.a)(sx,"ColorMenu",null,[410]);class br{constructor(a){this.wrc=null;this.ESh=a}get R6f(){this.wrc||(this.wrc=new sx(br.jri),this.cAj(this.wrc));return this.wrc}cAj(a){a.YAc(1,E.a.GV);a.YAc(3,E.a.gt);a.YAc(4,E.a.gt);a.YAc(5,E.a.gt);a.k4h(this.ESh)}ub(){const a=u.AFrameworkApplication.Ta;a.ya(E.a.vEb,Bb.a.view,Object(C.a)(this,this.vEb,"populateFontColor"));a.he(E.a.vEb,1127)}vEb(a,b,c,f,l){if(1===c)return 32;
if(2===c&&!l)return 8;a=br.Ak.uaj(b);if(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up){b=this.R6f.$7f(a,Cb.App.YQf);if(!b)return 8;l.MenuItems=b}a=this.R6f.wyi(a,Cb.App.YQf);if(!a)return 8;l.PopulationXML=a;return 32}static X5i(){return new br(TP.a.instance)}static get instance(){return br.yt||(br.yt=br.X5i())}static get Ak(){return Pw.PageReader.instance}}br.jri="Font";br.yt=null;Object(e.a)(br,"FontColorActor",null,[]);class kf{constructor(a){this.lga=this.Ro=this.A1=null;this.ROb=
!1;this.Gg=pa.InteractiveViewManager.instance.Nd;this.Lj=a;kf.YR&&cb.SelectionEditor.Vj(a)&&(a=cb.SelectionEditor.uoc(this.Lj),cb.SelectionEditor.Vj(a)?this.Lj=a:Z.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak."));a=cb.SelectionEditor.cKb(this.Lj);cb.SelectionEditor.Vj(a)&&(this.Lj=a)}get X7(){return this.A1||(this.A1=fb.a.instance.qb("Box4.IInternalLinkManager"))}get H5(){return this.Ro||(this.Ro=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}get titleText(){return Box4Intl.Box4Strings.l_InsertLinkTitle}get epg(){return Box4Intl.Box4Strings.l_InsertLinkButtonText}dispose(){}e3f(a,
b,c){if(b!==this.Lj.Kb||a!==this.Lj.Qa)a=rd.SelectionFactory.p2(c,a,b),this.Gg.Gb.setSelection(a),this.Lj=cb.SelectionEditor.cKb(a.Ua.clone())}dag(a){let b,c,f,l;l=Lb.HyperlinkReader.v1b(this.Lj);c=this.Lj.Qa;f=this.Lj.Kb;b="";if(!l.length)return this.lga=a.substring(this.Lj.Qa,this.Lj.Kb),{returnValue:!0,Qgd:b,$Jc:c,aKc:f,vRc:l};if(l[0].hyperlink){let x,G=0,R=Math.max(0,a.length-1),fa=0;for(let wa=0;wa<l.length;wa++)l[wa].Qa>=G&&({Qa:x,Kb:G}=kf.Jt.IZ(this.Lj,l[wa]),R=Math.min(x,R),fa=Math.max(G,
fa));c=Math.min(R,c);f=Math.max(fa,f);this.lga=a.substring(c,f);c===R&&(b=l[0].hyperlink.url);return{returnValue:!0,Qgd:b,$Jc:c,aKc:f,vRc:l}}return{returnValue:!1,Qgd:b,$Jc:c,aKc:f,vRc:l}}lSc(a,b){if(this.Gg.ho){var c=kf.ysa?Lb.HyperlinkReader.v1b(this.Lj):Lb.HyperlinkReader.VB(this.Lj,!0);var f=this.Gg.Gb.Oa.kb;if(f){f=f.Ua;yb.ParagraphReader.im(f)&&(f=Mc.a.createTextRange(f.node,0,yb.ParagraphReader.textLength(f.node)));if(kf.YR&&cb.SelectionEditor.Vj(f)){var l=cb.SelectionEditor.uoc(f);cb.SelectionEditor.Vj(l)?
f=l:Z.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}l=cb.SelectionEditor.cKb(f);cb.SelectionEditor.Vj(l)&&(f=l);0===a||H.a.instance.ga(22)&&32!==u.AFrameworkApplication.Ta.ki(f,E.a.insertHyperlink,1,!0,null,null)||this.jKj(c)||!this.Lj.equals(f)?this.Gg.hR():(Me.a.mark(5562),H.a.instance.ga(50)&&Cb.App.Ih&&Cb.App.Ih.Zv&&this.Gg.Gb.ATb(),a=new Id.GraphTransaction(15),a.gd(this.Lj.node),this.Lj.node.zG().graphTransactionOperations.Cha(4),
f=b.txtDisplay,b=b.txtLink.trim(),this.insertLink(f,b,c),a.dispose(),Me.a.mark(5563),this.f2())}else Z.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}}jKj(a){return kf.ysa?!1:1<a.length||1===a.length&&(a[0].Qa>this.Lj.Qa||a[0].Kb<this.Lj.Kb)}insertLink(a,b,c){var f=null;a||(a=b);if(b&&(!c.length||b!==c[0].hyperlink.url)){b=Lb.HyperlinkReader.RCa(b);var l="";this.X7&&({Rdh:l}=this.X7.bAh(b,!1)).returnValue&&(b=l)}this.ROb||(a=kf.hyperlinkEditor.kUk(a));
if((!c.length||kf.ysa)&&b)(f=0<c.length)&&kf.Jt.JFb(this.Lj,c),c=!0,kf.uKj&&(c=yb.ParagraphReader.text(this.Lj.node).substring(this.Lj.Qa,this.Lj.Kb)!==a),c&&kf.characterPropertiesEditor.replaceTextRange(this.Lj,a,!0),c=Mc.a.createTextRange(this.Lj.node,this.Lj.Qa,this.Lj.Qa+a.length),kf.hyperlinkEditor.aia(c,b,f,!1),f=rd.SelectionFactory.Mg(this.Lj.node,this.Lj.Qa+a.length);else if(0<c.length){l=c[0];let x;const G=({Qa:c,Kb:x}=kf.Jt.IZ(this.Lj,l)).returnValue;if(b)if(l.hyperlink.JRa){if(b!==l.hyperlink.url)if(kf.Qf.TJb){let R=
Mc.a.createTextRange(this.Lj.node,c,c+a.length);kf.hyperlinkEditor.BLi(R,l.hyperlink,b)}else kf.Jt.uDh(b,G);a!==this.lga&&(kf.Jt.gve()&&kf.Jt.JFb(this.Lj,G),kf.characterPropertiesEditor.replaceTextRange(Mc.a.createTextRange(this.Lj.node,c,x),a,!0),f=Mc.a.createTextRange(this.Lj.node,c,c+a.length),kf.Jt.gve()&&kf.hyperlinkEditor.aia(f,b,!1),f=rd.SelectionFactory.Mg(this.Lj.node,c+a.length))}else kf.Jt.JFb(this.Lj,G),kf.characterPropertiesEditor.replaceTextRange(Mc.a.createTextRange(this.Lj.node,c,
x),a,!0),f=Mc.a.createTextRange(this.Lj.node,c,c+a.length),kf.hyperlinkEditor.aia(f,b,!1),f=rd.SelectionFactory.Mg(this.Lj.node,c+a.length);else kf.hyperlinkEditor.xO(l.paragraph,l.hyperlink)}f&&this.Gg.Gb.setSelection(f)}static get hyperlinkEditor(){return kf.jn||(kf.jn=fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get characterPropertiesEditor(){return kf.Yg||(kf.Yg=fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Qf(){return kf.Xc||(kf.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get Jt(){return kf.bD||
(kf.bD=fb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get ysa(){null==kf.s_a&&(kf.s_a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return kf.s_a}static get uKj(){null==kf.Rwd&&(kf.Rwd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("KeepHyperlinkFormatFixIsEnabled"):!1);return kf.Rwd}static get d9a(){null==kf.c1a&&(kf.c1a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return kf.c1a}static get YR(){null==
kf.rM&&(kf.rM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return kf.rM}}kf.jn=null;kf.Yg=null;kf.Xc=null;kf.bD=null;kf.s_a=null;kf.Rwd=null;kf.c1a=null;kf.rM=null;kf.source="Source";kf.mRf="CommandingInterface";kf.v5a="DisplayText";kf.url="Url";kf.id="InsertLinkDialog";Object(e.a)(kf,"AInsertLinkDialog",null,[106]);class tx{static get mg(){return Lh.a.UB(tx.fo,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)}}
tx.fo="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(e.a)(tx,"InsertLinkDialogHtml",null,[]);class KI extends kf{constructor(a,b){super(a,b);this.uf=
new Lh.a;this.uf.ng=kf.id;var c=this.lga="";const f=yb.ParagraphReader.text(this.Lj.node);let l=this.Lj.Qa,x=this.Lj.Kb,G;kf.ysa?{Qgd:c,$Jc:l,aKc:x,vRc:G}=this.dag(f):(G=Lb.HyperlinkReader.VB(this.Lj,!0),1===G.length&&G[0].Qa<=this.Lj.Qa&&G[0].Kb>=this.Lj.Kb&&G[0].hyperlink?(this.lga=kf.Jt.FNc(a,G[0],f),c=G[0].hyperlink.url):G.length||(this.lga=f.substring(this.Lj.Qa,this.Lj.Kb)));(b=Object(ua.a)(Object,b))&&(b[kf.source]&&b[kf.source]===kf.mRf||b[kf.url]&&b[kf.v5a])?this.insertLink(b[kf.v5a],b[kf.url],
G):(kf.ysa&&G[0]&&this.e3f(l,x,G[0].paragraph),this.uf.mg=tx.mg,""===c.trim()&&this.uf.Ue(1,this.epg),c={["txtLink"]:c,["txtDisplay"]:this.lga},this.uf.eIc=Object(C.a)(this,this.XM,"dialogDefaultEnterKeyHandler"),this.uf.dIc=Object(C.a)(this,this.XM,"dialogDefaultEnterKeyHandler"),this.uf.tj(this.titleText,Object(C.a)(this,this.lSc,"insertLinkDialogHandler"),c),kf.d9a&&(c=document.getElementById("txtLink"),Ed.a.addHandler(c,ma.a.input,Object(C.a)(this,this.CHa,"onLinkChanged")),Ed.a.addHandler(c,
ma.a.change,Object(C.a)(this,this.CHa,"onLinkChanged"))),document.getElementById("txtLink").focus(),kf.YR?0<Ie.h(Mc.a.OOa(l,x,!1,this.Lj.node)).length&&(this.ROb=!0,document.getElementById("txtDisplay").disabled=!0):1>=G.length&&kf.Jt.QPd(a,G[0],1===G.length)&&(this.ROb=!0,document.getElementById("txtDisplay").disabled=!0))}CHa(){if(this.uf){const a=document.getElementById("txtLink");this.uf.JC(1,!a||!a.value.length||Lb.HyperlinkReader.$ce(a.value))}}XM(a){return this.uf?kf.d9a?this.uf.n9f(this.uf.Fkb)?
this.uf.XM(a):!1:this.uf.XM(a):!1}f2(){if(kf.d9a){const a=document.getElementById("txtLink");a&&(Ed.a.removeHandler(a,ma.a.change,Object(C.a)(this,this.CHa,"onLinkChanged")),Ed.a.removeHandler(a,ma.a.input,Object(C.a)(this,this.CHa,"onLinkChanged")))}this.uf&&(this.uf=null)}}Object(e.a)(KI,"InsertLinkDialog",kf,[]);class LI extends kf{constructor(a,b,c){super(a,b);const f=new Lh.a(!1,!1,!0),l={};l.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText;l.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress;
l.textDisplayInitialFocus=c;c=this.lga="";const x=yb.ParagraphReader.text(this.Lj.node);let G=this.Lj.Qa,R=this.Lj.Kb,fa;kf.ysa?{Qgd:c,$Jc:G,aKc:R,vRc:fa}=this.dag(x):(fa=Lb.HyperlinkReader.VB(this.Lj,!0),1===fa.length&&fa[0].Qa<=this.Lj.Qa&&fa[0].Kb>=this.Lj.Kb&&fa[0].hyperlink?(this.lga=kf.Jt.FNc(a,fa[0],x),c=fa[0].hyperlink.url):fa.length||(this.lga=x.substring(this.Lj.Qa,this.Lj.Kb)));(b=Object(ua.a)(Object,b))&&(b[kf.source]&&b[kf.source]===kf.mRf||b[kf.url]&&b[kf.v5a])?this.insertLink(b[kf.v5a],
b[kf.url],fa):(kf.ysa&&fa[0]&&this.e3f(G,R,fa[0].paragraph),b=CommonUIStrings.l_DialogOk,""===c.trim()&&(b=this.epg),f.Ue(1,b),l.txtLink=c,l.txtDisplay=this.lga,kf.YR?0<Ie.h(Mc.a.OOa(G,R,!1,this.Lj.node)).length&&(this.ROb=!0,l.textDisplayDisabled=!0):1>=fa.length&&kf.Jt.QPd(a,fa[0],1===fa.length)&&(this.ROb=!0,l.textDisplayDisabled=!0),a={["id"]:kf.id,["bodyControls"]:l},f.tj(this.titleText,Object(C.a)(this,this.lSc,"insertLinkDialogHandler"),a))}f2(){}}Object(e.a)(LI,"ReactInsertLinkDialog",kf,
[]);class cu{constructor(){this.Moa=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.gC}yUf(a,b,c){this.Moa?new LI(a,b,c):new KI(a,b)}static get instance(){return cu.Ja||(cu.Ja=new cu)}}cu.Ja=null;Object(e.a)(cu,"InsertLinkDialogFactory",null,[412]);class Hk extends Lh.a{constructor(a){super();this.hK=a;this.Gg=pa.InteractiveViewManager.instance.Nd;this.n2a=this.Gg.Gb.Oa.kb;this.UXd=a[0].Qa;this.Ade=a[a.length-1].Kb;this.ng="InsertMultiParagraphLinkDialog";a=this.wwl();this.showDialog("",
a)}showDialog(a,b){Z.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows.");this.mg=tx.mg;""===b.trim()&&this.Ue(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);a={["txtLink"]:b,["txtDisplay"]:a};this.tj(Box4Intl.Box4Strings.l_InsertLinkTitle,Object(C.a)(this,this.lSc,"insertLinkDialogHandler"),a);document.getElementById("txtLink").focus();document.getElementById("txtDisplay").disabled=!0;Hk.d9a&&(a=document.getElementById("txtLink"),Ed.a.addHandler(a,ma.a.input,Object(C.a)(this,
this.CHa,"onLinkChanged")),Ed.a.addHandler(a,ma.a.change,Object(C.a)(this,this.CHa,"onLinkChanged")))}hide(){if(Hk.d9a){const a=document.getElementById("txtLink");a&&(Ed.a.removeHandler(a,ma.a.change,Object(C.a)(this,this.CHa,"onLinkChanged")),Ed.a.removeHandler(a,ma.a.input,Object(C.a)(this,this.CHa,"onLinkChanged")))}super.hide()}CHa(){const a=document.getElementById("txtLink");this.JC(1,!a||!a.value.length||Lb.HyperlinkReader.$ce(a.value))}XM(a){return Hk.d9a?this.n9f(this.Fkb)?super.XM(a):!1:
super.XM(a)}wwl(){let a;let b;a="";const c=this.hK.length,f=Lb.HyperlinkReader.VB(this.hK[0],!1);0<f.length&&({Qa:l,Kb:b}=Hk.Jt.IZ(this.hK[0],f[0]),l<=this.hK[0].Qa&&(a=f[0].hyperlink.url),this.UXd=Math.min(this.UXd,l));var l=Lb.HyperlinkReader.VB(this.hK[c-1],!1);0<l.length&&({Qa:l,Kb:b}=Hk.Jt.IZ(this.hK[c-1],l[l.length-1]),this.Ade=Math.max(this.Ade,b));this.Erl(this.UXd,this.Ade);return a}Erl(a,b){const c=this.hK.length;if(a!==this.hK[0].Qa||b!==this.hK[c-1].Kb){a=Mc.a.ak(this.hK[0].node,a);a=
rd.SelectionFactory.nu(a);b=Mc.a.ak(this.hK[c-1].node,b);b=rd.SelectionFactory.bN(a,b);a=this.bhg(b.Ua.clone());const f=this.bhg(b.Ve.clone());a&&f&&(this.hK[0]=a,this.hK[c-1]=f,this.Gg.Gb.setSelection(b),this.n2a=b)}}lSc(a,b){if(this.Gg.ho){var c=this.Gg.Gb.Oa.kb;if(c)if(c.equals(this.n2a)&&0!==a){a=new Id.GraphTransaction(15);a.gd(this.hK[0].node);for(c=0;c<this.hK.length;c++)this.hK[c].node.zG().graphTransactionOperations.Cha(4);b=b.txtLink.trim();this.zGi();this.GBj(b);this.hide();a.dispose()}else this.Gg.hR()}}GBj(a){if(a){a=
Lb.HyperlinkReader.RCa(a);for(let c=0;c<this.hK.length;c++){var b=this.hK[c];if(Hk.YR&&cb.SelectionEditor.Vj(b)&&(b=cb.SelectionEditor.uoc(b),!cb.SelectionEditor.Vj(b)))continue;b=Mc.a.createTextRange(this.hK[c].node,b.Qa,b.Kb);Hk.hyperlinkEditor.aia(b,a,!1)}}}bhg(a){return yb.ParagraphReader.im(a)&&!cb.SelectionEditor.jW(a)&&yb.ParagraphReader.textLength(a.node)?Mc.a.createTextRange(a.node,0,yb.ParagraphReader.textLength(a.node)):cb.SelectionEditor.Vj(a)?a:null}zGi(){let a=!1;for(const b of this.hK){const c=
Lb.HyperlinkReader.VB(b,!1);c&&(a=Hk.Jt.JFb(b,c)||a)}}static get Jt(){return Hk.bD||(Hk.bD=fb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get Qf(){return Hk.Xc||(Hk.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get hyperlinkEditor(){return Hk.jn||(Hk.jn=fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get YR(){null==Hk.rM&&(Hk.rM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Hk.rM}static get d9a(){null==
Hk.c1a&&(Hk.c1a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkUrlValidationIsEnabled"):!1);return Hk.c1a}}Hk.bD=null;Hk.Xc=null;Hk.jn=null;Hk.rM=null;Hk.c1a=null;Object(e.a)(Hk,"InsertMultiParagraphLinkDialog",Lh.a,[]);class Ge{static get Yi(){return ed.a.instance}static get hyperlinkEditor(){return Ge.jn||(Ge.jn=fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Jt(){return Ge.bD||(Ge.bD=fb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static Sq(){return Ge.xm||(Ge.xm=
fb.a.instance.Ka("Box4.IExternalSelectionManager"))}static get Qf(){return Ge.Xc||(Ge.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get poc(){return Ge.hD||(Ge.hD=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get bLb(){null==Ge.zpd&&(Ge.zpd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("ViewAndOpenImageHyperlinksIsEnabled"):!1);return Ge.zpd}static get ysa(){null==Ge.s_a&&(Ge.s_a=u.AFrameworkApplication.fa?
u.AFrameworkApplication.fa.ka("HyperlinkExpandEditEnabled"):!1);return Ge.s_a}static get Tdc(){null==Ge.t_a&&(Ge.t_a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return Ge.t_a}static get YR(){null==Ge.rM&&(Ge.rM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Ge.rM}static ub(){const a=u.AFrameworkApplication.Ta;a.ya(E.a.insertHyperlink,Bb.a.view,Ge.Oub);a.ya(E.a.insertHyperlink,
Bb.a.Of,Ge.insertLink);a.ya(E.a.insertHyperlink,Bb.a.textRange,Ge.insertLink);a.he(E.a.insertHyperlink,1028);a.ya(E.a.xO,Bb.a.view,Ge.Oub);a.ya(E.a.xO,Bb.a.Of,Ge.weh);a.ya(E.a.xO,Bb.a.textRange,Ge.weh);a.he(E.a.xO,1028);a.ya(E.a.mJe,Bb.a.view,Ge.Oub);a.ya(E.a.mJe,Bb.a.Of,Ge.glh);a.ya(E.a.mJe,Bb.a.textRange,Ge.glh);a.ya(E.a.WWa,Bb.a.view,Ge.Oub);a.ya(E.a.WWa,Bb.a.Of,Ge.f4g);a.ya(E.a.WWa,Bb.a.textRange,Ge.f4g);a.ya(E.a.WWa,Bb.a.image,Ge.eze);a.ya(E.a.WWa,Bb.a.J_b,Ge.eze);a.ya(E.a.z3b,Bb.a.view,Ge.Oub);
a.ya(E.a.z3b,Bb.a.Of,Ge.linkText);a.ya(E.a.z3b,Bb.a.textRange,Ge.linkText);a.he(E.a.z3b,1028);Ge.bLb&&a.ya(E.a.WWa,Bb.a.anchoredObject,Ge.eze);a.ya(E.a.tQd,Bb.a.view,Ge.Oub)}static Oub(a,b,c,f,l){if(Ge.Tdc)return Ge.Avj(a,b,c,f,l);if(!b.view.Lh)return 2;var x=b.view.Gb;if(!x||!x.Oa||!x.Oa.length)return 8;var G=x.Oa.kb;let R=G.Ua.clone();if(2===G.length){if(G=G.ga(1),!cb.SelectionEditor.Vj(R)||!cb.SelectionEditor.Ll(G)||R.node!==G.node)return 8}else if(2<G.length)return 8;if(x.Oa.MG)return 8;yb.ParagraphReader.im(R)&&
!cb.SelectionEditor.jW(R)&&(x=R.node,R=Mc.a.createTextRange(x,0,yb.ParagraphReader.textLength(x)));return a===E.a.tQd?Ge.kTf(b,R,c,f,l):u.AFrameworkApplication.Ta.ki(R,a,c,!0,f,l)}static Avj(a,b,c,f,l){if(!b.view.Lh)return 2;var x=b.view.Gb;if(!x||!x.Oa||!x.Oa.length||x.Oa.MG)return 8;var G=x.Oa.kb;if(x=Ge.c6b(G))G=Ge.V3d(G.Ua.clone(),!0);else{let R=G.ga(0).clone(),fa=1;for(;fa<G.length&&(!yb.ParagraphReader.textLength(R.node)||cb.SelectionEditor.Ll(R)||Ge.YR&&Ie.m(R));)R=G.ga(fa).clone(),fa++;G=
Ge.V3d(R,!1)}return Ge.YR&&cb.SelectionEditor.Vj(G)&&Ie.m(G)||!cb.SelectionEditor.Vj(G)&&!x?8:a===E.a.tQd?Ge.kTf(b,G,c,f,l):u.AFrameworkApplication.Ta.ki(G,a,c,!0,f,l)}static c6b(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua.clone();a=a.ga(1);return cb.SelectionEditor.Vj(b)&&cb.SelectionEditor.Ll(a)&&b.node===a.node?!0:!1}return!1}static QRf(a){let b;b=null;const c=[];for(let f=0;f<a.length;f++){const l=Ge.V3d(a.ga(f).clone(),!1);if(cb.SelectionEditor.Vj(l))Ge.YR&&Ie.m(l)||Array.add(c,
l);else if(!cb.SelectionEditor.Ll(l)&&!yb.ParagraphReader.im(l))return{returnValue:!1,jQd:b}}b=Qa.a.KJb(c);return{returnValue:!Ge.YR||0<b.length?!0:!1,jQd:b}}static lpg(a,b,c,f){if(Ge.Tdc)return Ge.LBj(a,b,c,f);if(!Ge.pNd()||!Ge.XDc(a)||qd.a.instance.Oa.MG)return 8;if(Ge.bLb&&cb.SelectionEditor.VDa(a))return 2;let l;if(!({hyperlink:l}=Ge.dTa(a,!0)).returnValue||Ge.OFc())return 8;if(1===b)return 32;if(!l&&cb.SelectionEditor.Pg(a)&&cb.SelectionEditor.Kwb(a)&&(b=cb.SelectionEditor.UPa(a,!1))&&(qd.a.instance.setSelection(b),
a=b.Ua,Ge.OFc()))return 8;cu.instance.yUf(a,c,f);return 32}static LBj(a,b,c,f){var l=qd.a.instance.Oa.kb;const x=Ge.c6b(l);if(x)a=[a];else if(!({jQd:a}=Ge.QRf(l)).returnValue)return 8;if(!Ge.pNd())return 8;for(l=0;l<a.length;l++)if(!Ge.XDc(a[l]))return 8;if(qd.a.instance.Oa.MG)return 8;l=Array(a.length);let G=null;for(let R=0;R<a.length;R++)if(l[R]=a[R],!({hyperlink:G}=Ge.dTa(l[R],!0)).returnValue||Ge.OFc())return 8;if(f&&!Ge.oSj(l[0]))return 8;if(1===b)return 32;if(!G&&1===l.length&&x&&cb.SelectionEditor.Pg(l[0])&&
cb.SelectionEditor.Kwb(l[0])&&(b=cb.SelectionEditor.UPa(l[0],!1))&&(qd.a.instance.setSelection(b),l[0]=b.Ua,Ge.OFc()))return 8;x?cu.instance.yUf(l[0],c,f):new Hk(l,c);return 32}static insertLink(a,b,c,f,l){return Ge.lpg(b,c,l,!1)}static linkText(a,b,c,f,l){return Ge.lpg(b,c,l,!0)}static weh(a,b,c){if(Ge.Tdc)return Ge.iQk(a,b,c);if(!Ge.XDc(b)||Ge.bLb&&cb.SelectionEditor.VDa(b))return 2;let f;if(!({hyperlink:f}=Ge.dTa(b,!1)).returnValue)return 2;if(2===c){c=new Id.GraphTransaction(15);try{c.fd=a,c.gd(f.paragraph),
Ge.ysa?Ge.Meh(b):Ge.Jt.xO(b,f)}finally{c&&c.dispose()}}return 32}static iQk(a,b,c){var f=qd.a.instance.Oa.kb;if(Ge.c6b(f))b=[b];else if(!({jQd:b}=Ge.QRf(f)).returnValue)return 8;if(!Ge.pNd())return 8;for(f=0;f<b.length;f++)if(!Ge.XDc(b[f]))return 8;if(1===c&&!Ge.dTa(b[0],!1).returnValue)return 2;if(2===c){for(c=0;c<b.length;c++)if(!Ge.dTa(b[c],!0).returnValue)return 2;c=new Id.GraphTransaction(15);try{let l=b[0];c.fd=a;c.gd(l.node);for(a=0;a<b.length;a++)Ge.Meh(b[a])}finally{c&&c.dispose()}}return 32}static Meh(a){const b=
Lb.HyperlinkReader.v1b(a);let c=0;for(let f=0;f<b.length;f++)if(b[f].Qa>=c){const l=({Kb:c}=Ge.Jt.IZ(a,b[f])).returnValue;Ge.Jt.JFb(a,l)}}static glh(a,b,c){if(Ge.bLb&&W.ImageReader.Gvb(b)||!({hyperlink:a}=Ge.dTa(b,!1)).returnValue)return 2;2===c&&({Qa:b,Kb:c}=Ge.Jt.IZ(b,a),qd.a.instance.setSelection(rd.SelectionFactory.p2(a.paragraph,b,c)));return 32}static f4g(a,b,c){let f;if(Ge.bLb&&({hyperlink:f}=Ge.cSj(b)).returnValue)Z.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");
else if(!({hyperlink:f}=Ge.dTa(b,!1)).returnValue)return 2;2===c&&Cb.App.R_b(f.hyperlink.url);return 32}static eze(a,b,c){a=W.ImageReader.IZ(b.node);if(!a)return 2;2===c&&Cb.App.R_b(a);return 32}static kTf(a,b,c,f,l){if(Ge.bLb&&W.ImageReader.Gvb(b))return 2;const x=pa.InteractiveViewManager.instance.editingView;if(!x.Kl)return 2;let G;if(!({hyperlink:G}=Ge.dTa(b,!1)).returnValue)return 2;if(1===c)return 32;({Qa:b,Kb:c}=Ge.Jt.IZ(b,G));qd.a.instance.setSelection(rd.SelectionFactory.p2(G.paragraph,b,
c));var R=x.ownerDocument;c=x.Hn;b=new Dg.a(c);ya.a.ku(c);R=R.createElement("span");c.appendChild(R);R.innerText=G.hyperlink.url;x.MIa();x.k7k();a=u.AFrameworkApplication.Ta.ki(a,E.a.copy,2,!0,f,l);b.restore();return a}static dTa(a,b){let c;c=null;if(cb.SelectionEditor.Vj(a)){var f=Ie.h(a);const l=Qa.a.all(f,x=>6===x.Lq);if(0<f.length&&(!Ge.YR||!l))return{returnValue:!1,hyperlink:c}}if(Ge.ysa)return Ge.ZRj(a,b);f=Lb.HyperlinkReader.VB(a,!0);return 1===f.length&&f[0].Qa<=a.Qa&&f[0].Kb>=a.Kb&&f[0].hyperlink?
(c=f[0],{returnValue:!0,hyperlink:c}):{returnValue:!f.length&&b,hyperlink:c}}static cSj(a){let b;b=null;return W.ImageReader.Gvb(a)&&(b=Lb.HyperlinkReader.HNc(a))?{returnValue:!0,hyperlink:b}:{returnValue:!1,hyperlink:b}}static ZRj(a,b){let c;c=null;const f=Lb.HyperlinkReader.v1b(a);return f.length?f[0].hyperlink?(c=f[0],a.Qa<f[0].Qa?{returnValue:b,hyperlink:c}:{returnValue:!0,hyperlink:c}):{returnValue:!1,hyperlink:c}:{returnValue:b,hyperlink:c}}static oSj(a){if(cb.SelectionEditor.Vj(a)){var b=Ie.h(a),
c=Qa.a.all(b,f=>6===f.Lq);if(0<b.length&&!c)return!1}b=Lb.HyperlinkReader.VB(a,!0);if(!(1===b.length&&b[0].Qa<=a.Qa&&b[0].Kb>=a.Kb&&b[0].hyperlink))return!1;c=yb.ParagraphReader.text(a.node);a=Ge.Jt.FNc(a,b[0],c);return!(0<=a.indexOf("\r")||0<=a.indexOf("\n")||0<=a.indexOf("\x0B")||0<=a.indexOf("\ufffc"))}static OFc(){if(Ge.Qf.ag)for(let a=0;a<null.count;++a)if(2===null.ga(a).WEl.changeType)return!0;return!1}static pNd(){return Ge.Qf.ag?!0:!H.a.instance.ga(45)||!Cb.App.nD.UJb}static XDc(a){return H.a.instance.ga(14)&&
Ge.Yi.N4a(a)||Ge.Sq()&&Ge.Sq().instance&&Ge.Sq().instance.lW(a)?!1:!0}static V3d(a,b){return yb.ParagraphReader.im(a)&&!cb.SelectionEditor.jW(a)&&(yb.ParagraphReader.textLength(a.node)||b)?Mc.a.createTextRange(a.node,0,yb.ParagraphReader.textLength(a.node)):a}}Ge.jn=null;Ge.bD=null;Ge.xm=null;Ge.Xc=null;Ge.hD=null;Ge.zpd=null;Ge.s_a=null;Ge.t_a=null;Ge.rM=null;Object(e.a)(Ge,"HyperlinkActor",null,[]);class Hg{static get hv(){return nv.a.Htb}static get Yl(){return Df.ContextSetEditor.instance}static get Yi(){return ed.a.instance}static get Tc(){return rb.a.instance}static Sq(){return Hg.xm||
(Hg.xm=fb.a.instance.Ka("Box4.IExternalSelectionManager"))}static get paragraphEditor(){return Hg.Hw||(Hg.Hw=fb.a.instance.resolve("Box4.IParagraphEditor"))}static get O4(){return Hg.ir||(Hg.ir=fb.a.instance.resolve("Box4.IParagraphReader"))}static get PL(){return Hg.gG||(Hg.gG=fb.a.instance.resolve("Box4.IParagraphIndentationReader"))}static get vuk(){return Hg.paragraphEditor.hv}static get Tf(){return Hg.Sg||(Hg.Sg=fb.a.instance.resolve("Box4.List.IListReader"))}static ub(){const a=u.AFrameworkApplication.Ta;
a.ya(E.a.lz,Bb.a.view,Hg.gIf);a.ya(E.a.lz,Bb.a.outlineElement,Hg.fIf);a.he(E.a.lz,1028);a.ya(E.a.rD,Bb.a.view,Hg.gIf);a.ya(E.a.rD,Bb.a.outlineElement,Hg.fIf);a.he(E.a.rD,1028)}static gIf(a,b,c,f,l){var x=b.view;if(!x.Lh)return 2;const G=x.Gb;if(!G)return Hg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$la}),8;var R=G.Kj;if(!R)return Hg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.noSelection}),8;if(H.a.instance.ga(62)&&1===c)return 32;if(H.a.instance.ga(11)&&Hg.Yl.Iqa(Hg.FJd,R))return Hg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$Wb}),
8;if(H.a.instance.ga(14)&&Hg.Yi.qTc(R))return Hg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.qD}),8;if(Hg.Sq()&&Hg.Sq().instance&&Hg.Sq().instance.lW(R))return Hg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.externalSelection}),8;R={};R[bi.Xna]=5794;R[bi.Wna]=5795;let fa=2;if(u.AFrameworkApplication.fa.ka("Box4PartialPromoteDemoteIsEnabled")){x=Hg.GNf(a===E.a.lz,b,!0);if(1===c)return x?32:8;x&&(fa=bi.yeb(a,b,c,f,l,R))}else fa=bi.yeb(a,b,1,f,l,R),1!==c&&32===fa?(x.Gb.Dye(),x=new Id.GraphTransaction(15),x.gd(b.view.vg),fa=Hg.GNf(a===
E.a.lz,b,!1)?bi.yeb(a,b,c,f,l,R):8,x.dispose()):1!==c&&8===fa&&(x.Gb.Dye(),Hg.lsi(a,b,G));return fa}static GNf(a,b,c){b=b.view.Gb;if(!b||!b.Oa.kb)return Hg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$7c}),!1;if(b.Oa.MG)return Hg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.qSf}),!1;b=oi.Nra(b.Oa,!1);if(!b)return Hg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.pKc}),!1;let f=!1;for(let l=0;l<b.length;l++){const x=b.getContext(l),G=new nb.GraphIterator;G.set(x.node);cb.SelectionEditor.kt(G);if(!ae.OutlineElementReader.Ug(G))if(c)continue;
else return Hg.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.Jba}),!1;if(a?!Hg.hv.Mpb(G):!Hg.hv.UDc(G))if(c)continue;else return Hg.Tc.Tb(Nd.a.XYb,{["Reason"]:Od.a.dOf}),!1;f=!0}return c?f:!0}static fIf(a,b,c,f,l){if(b.contextId!==Bb.a.outlineElement)return 2;if(H.a.instance.ga(14))if(f=b.clone().uPe(),Jd.TableReader.Ozg(f)){if(Hg.Yi.Pzg(f))return Hg.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),8}else if(Hg.Yi.dEa(f))return Hg.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),2;f=new nb.GraphIterator;f.set(b.node);cb.SelectionEditor.kt(f);
if(!ae.OutlineElementReader.Ug(f))return 2;switch(a){case E.a.lz:b=Hg.hv.Mpb(f);break;case E.a.rD:b=Hg.hv.UDc(f);break;default:return 2}if(1===c||!b)return b?32:8;c=0;a===E.a.rD&&l&&l.sa(Oc.a.DJf,!1)&&(c|=2);switch(a){case E.a.lz:Hg.hv.Teb(f,-1,c);break;case E.a.rD:Hg.hv.UHc(f,1)}return 32}static lsi(a,b,c){const f=new Id.GraphTransaction(15);try{f.gd(b.view.vg);b=!0;var l=oi.Nra(c.Oa,!1);for(let x=0;x<l.length;x++){const G=l.getContext(x);let R=new nb.GraphIterator;R.set(G.node);cb.SelectionEditor.kt(R);
if(!ae.OutlineElementReader.Ug(R))b=!1;else if(a===E.a.lz?Hg.hv.Mpb(R):Hg.hv.UDc(R))switch(b=!1,a){case E.a.lz:Hg.hv.Teb(R,-1,0);break;case E.a.rD:Hg.hv.UHc(R,1)}}if(b){const x=c.Oa.kb;for(c=0;c<x.length;c++){const G=x.ga(c);if(G.Qk){const R=Hg.PL.wtb(G.node),fa=R.KIb;if(a===E.a.lz?R.nN>fa:R.nN<18*fa){let wa=new nb.GraphIterator;wa.set(G.node);l=fa;l=a===E.a.lz?R.nN>=2.5*fa?R.nN-2*fa:fa:R.nN<16*fa?R.nN+2*fa:18*fa;Hg.vuk.Kgb(wa,1,l)}}}}}finally{f&&f.dispose()}}}Hg.xm=null;Hg.Hw=null;Hg.ir=null;Hg.gG=
null;Hg.Sg=null;Hg.FJd=W.ImageReader.Fvb;Object(e.a)(Hg,"IndentationActor",null,[]);class ig{static get q7d(){return ig.rlb||(ig.rlb=fb.a.instance.resolve("Box4.Images.IImageEditor"))}static get paragraphEditor(){return ig.Hw||(ig.Hw=fb.a.instance.resolve("Box4.IParagraphEditor"))}static get Hq(){return ig.gD||(ig.gD=fb.a.instance.resolve("Box4.ITableEditor"))}static get Yi(){return ed.a.instance}static get Tc(){return rb.a.instance}static Sq(){return ig.xm||(ig.xm=fb.a.instance.Ka("Box4.IExternalSelectionManager"))}static ub(){const a=
u.AFrameworkApplication.Ta;H.a.instance.ga(77)||(a.ya(E.a.leftJustify,Bb.a.table,ig.yKd),a.ya(E.a.centerJustify,Bb.a.table,ig.yKd),a.ya(E.a.rightJustify,Bb.a.table,ig.yKd));a.ya(E.a.leftJustify,Bb.a.view,xg.U6);a.ya(E.a.leftJustify,Bb.a.paragraph,ig.yha);a.ya(E.a.leftJustify,Bb.a.image,ig.EAa);a.ya(E.a.leftJustify,Bb.a.embeddedFile,ig.EAa);a.he(E.a.leftJustify,1028);a.ya(E.a.centerJustify,Bb.a.view,xg.U6);a.ya(E.a.centerJustify,Bb.a.paragraph,ig.yha);a.ya(E.a.centerJustify,Bb.a.image,ig.EAa);a.ya(E.a.centerJustify,
Bb.a.embeddedFile,ig.EAa);a.he(E.a.centerJustify,1028);a.ya(E.a.rightJustify,Bb.a.view,xg.U6);a.ya(E.a.rightJustify,Bb.a.paragraph,ig.yha);a.ya(E.a.rightJustify,Bb.a.image,ig.EAa);a.ya(E.a.rightJustify,Bb.a.embeddedFile,ig.EAa);a.he(E.a.rightJustify,1028);H.a.instance.ga(54)&&(a.ya(E.a.fullJustify,Bb.a.view,xg.U6),a.ya(E.a.fullJustify,Bb.a.paragraph,ig.yha),a.he(E.a.fullJustify,1028),a.ya(E.a.SYb,Bb.a.view,xg.U6),a.ya(E.a.SYb,Bb.a.paragraph,ig.yha),a.he(E.a.SYb,1028),a.ya(E.a.G6b,Bb.a.view,xg.U6),
a.ya(E.a.G6b,Bb.a.paragraph,ig.yha),a.he(E.a.G6b,1028),a.ya(E.a.ulc,Bb.a.view,xg.U6),a.ya(E.a.ulc,Bb.a.paragraph,ig.yha),a.he(E.a.ulc,1028));a.ya(E.a.Wja,Bb.a.view,xg.U6);a.ya(E.a.Wja,Bb.a.paragraph,ig.yha);a.ya(E.a.Wja,Bb.a.image,ig.EAa);a.he(E.a.Wja,1028);a.ya(E.a.Nha,Bb.a.view,xg.U6);a.ya(E.a.Nha,Bb.a.paragraph,ig.yha);a.ya(E.a.Nha,Bb.a.image,ig.EAa);a.he(E.a.Nha,1028);a.ya(E.a.cna,Bb.a.view,xg.U6);a.ya(E.a.cna,Bb.a.paragraph,ig.yha);a.ya(E.a.cna,Bb.a.image,ig.EAa);a.he(E.a.cna,1028);H.a.instance.ga(54)&&
(a.ya(E.a.pCa,Bb.a.view,xg.U6),a.ya(E.a.pCa,Bb.a.paragraph,ig.yha),a.he(E.a.pCa,1028))}static yKd(a,b,c){let f=!0;if(!b)return 8;Jd.TableReader.Ozg(b)?H.a.instance.ga(14)&&ig.Yi.Pzg(b)?(ig.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),f=!1):ig.Sq()&&ig.Sq().instance&&ig.Sq().instance.lW(b)&&(ig.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.externalSelection}),f=!1):(ig.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.tUd}),f=!1);if(1===c||!f)return f?32:8;b=b.node;switch(a){case E.a.leftJustify:ig.Hq.$L(b,1);break;case E.a.centerJustify:ig.Hq.$L(b,
2);break;case E.a.rightJustify:ig.Hq.$L(b,3)}return 32}static EAa(a,b,c){if(!({XE:c}=xg.Bqh(c,b)).returnValue)return c;b=b.node;switch(a){case E.a.leftJustify:case E.a.Wja:ig.q7d.$L(b,1);break;case E.a.centerJustify:case E.a.Nha:ig.q7d.$L(b,2);break;case E.a.rightJustify:case E.a.cna:ig.q7d.$L(b,3)}return 32}static yha(a,b,c,f,l){f=!0;b.contextId!==Bb.a.paragraph?f=!1:H.a.instance.ga(14)&&ig.Yi.dEa(b)?(ig.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.qD}),f=!1):ig.Sq()&&ig.Sq().instance&&ig.Sq().instance.lW(b)&&
(ig.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.externalSelection}),f=!1);if(1===c||!f)return f?32:8;b=b.node;c=yb.ParagraphReader.fN(b);switch(a){case E.a.leftJustify:case E.a.Wja:ig.paragraphEditor.$L(b,1===c&&ig.XVc(l)?6:1);break;case E.a.centerJustify:case E.a.Nha:ig.paragraphEditor.$L(b,2===c&&ig.XVc(l)?1:2);break;case E.a.rightJustify:case E.a.cna:ig.paragraphEditor.$L(b,3===c&&ig.XVc(l)?1:3);break;case E.a.fullJustify:case E.a.pCa:ig.paragraphEditor.$L(b,6===c&&ig.XVc(l)?1:6);break;case E.a.G6b:ig.paragraphEditor.$L(b,
11);break;case E.a.SYb:ig.paragraphEditor.$L(b,7);break;case E.a.ulc:ig.paragraphEditor.$L(b,13)}return 32}static XVc(a){let b=!1;null!==a&&Object.getType(a)===Object&&a.hasOwnProperty("InContextSet")&&(b=a.InContextSet);return!b&&H.a.instance.ga(110)}}ig.rlb=null;ig.gD=null;ig.Hw=null;ig.xm=null;Object(e.a)(ig,"JustificationActor",null,[]);class du{ub(){const a=u.AFrameworkApplication.Ta;a.ya(E.a.activateRibbonTab,Bb.a.view,Object(C.a)(this,this.activateRibbonTab,"activateRibbonTab"));a.he(E.a.activateRibbonTab,
5);a.ya(E.a.VAg,Bb.a.view,Object(C.a)(this,this.kUj,"launchJewelOpenMenuShortcut"))}activateRibbonTab(){return 32}kUj(){u.AFrameworkApplication.DN("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings");Cb.App.nD.jS.UAg();return 32}static get instance(){return du.Ja||(du.Ja=du.WB())}static WB(){return new du}}du.Ja=null;Object(e.a)(du,"RibbonActor",null,[]);class Pn{constructor(a,b,c){this.Nzf=!1;this.Ca=a;this.eb=b;this.Etc=c}ub(){this.Ca.pa(F.a.iM,Bb.a.view,Object(C.a)(this,this.zpl,
"touchStartHandler"),4);this.Ca&&this.eb&&(this.eb.ka("TouchImageGrippiesResizedIsEnabled")&&(this.Ca.pa(E.a.ezh,Bb.a.view,Object(C.a)(this,this.kDk,"processImageOnTouchSelection"),4),this.Ca.pa(E.a.fzh,Bb.a.view,Object(C.a)(this,this.jDk,"processImageOnClickSelection"),4)),this.eb.ka("HideGrippersWhenPinchingIsEnabled")&&(this.Ca.pa(F.a.Xil,Bb.a.application,Object(C.a)(this,this.LDk,"processStartPinchToZoom"),4),this.Ca.pa(F.a.$Mi,Bb.a.application,Object(C.a)(this,this.cDk,"processEndPinchToZoom"),
4)))}zpl(a,b,c){if(2!==c)return 2;this.Nzf||(this.Nzf=!0);u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings");u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings");r.a.Nj&&u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordForceSelectionIntoTopWhenTouchSettings");return 32}kDk(a,b,c,f,l){if(2!==c)return 2;this.x9g(l,!0);return 32}jDk(a,b,c,f,l){if(2!==c)return 2;this.x9g(l,!1);return 32}x9g(a,
b){if(a)for(a=a.firstChild;a;){if("SPAN"===a.tagName&&Sys.UI.DomElement.containsCssClass(a,Pn.Vwj)){for(a=a.firstChild;a;)this.j9h(a,b),a=a.nextSibling;break}a=a.nextSibling}}j9h(a,b){if(Sys.UI.DomElement.containsCssClass(a,Pn.Cng)){b&&!Sys.UI.DomElement.containsCssClass(a,Pn.FRc)?Sys.UI.DomElement.addCssClass(a,Pn.FRc):!b&&Sys.UI.DomElement.containsCssClass(a,Pn.FRc)&&Sys.UI.DomElement.removeCssClass(a,Pn.FRc);const c="WACImageResizeHandleTouch"+this.x6i(a);b&&!Sys.UI.DomElement.containsCssClass(a,
c)?Sys.UI.DomElement.addCssClass(a,c):!b&&Sys.UI.DomElement.containsCssClass(a,c)&&Sys.UI.DomElement.removeCssClass(a,c)}}CNc(a){a=a.className.split(" ");for(let b=0;b<a.length;b++){const c=a[b].toString();if(c.startsWith("WACImageResizeHandle")&&c!==Pn.Cng)return c}return""}x6i(a){a=this.CNc(a);return""!==a?Ka.a.substring(a,20,a.length):""}LDk(a,b,c){if(2!==c)return 2;if(!this.Etc)return 8;this.Etc.zuj();return 32}cDk(a,b,c){if(2!==c)return 2;if(!this.Etc)return 8;this.Etc.UWk();return 32}static Aij(){return new Pn(u.AFrameworkApplication.Ta,
u.AFrameworkApplication.fa,qf.GrippersManager.instance)}static get instance(){return Pn.yt||(Pn.yt=Pn.Aij())}}Pn.Cng="WACImageResizeHandles";Pn.FRc="WACImageResizeHandlesTouch";Pn.Vwj="WACImgSelection";Pn.yt=null;Object(e.a)(Pn,"TouchInputActor",null,[]);class cr{constructor(a){this.Hs=null;this.XY=a}get yn(){return this.Hs||(this.Hs=this.XY())}ub(){const a=u.AFrameworkApplication.Ta,b=Object(C.a)(this,this.undoRedo,"undoRedo");a.pa(E.a.undo,Bb.a.view,b,1028);a.pa(E.a.redo,Bb.a.view,b,1028)}undoRedo(a,
b,c,f,l){b=b.view;if(!b.Lh)return cr.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.$7c}),8;f=a===E.a.undo?this.yn.aW:this.yn.hja;if(1===c)return f?32:8;if(!f)return Z.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",a===E.a.undo?"undo":"redo"),cr.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.Qtl}),2;c=new Id.GraphTransaction(3);c.gd(b.vg);c.Agb();a=a===E.a.undo?this.yn.undo():this.yn.redo();c.dispose();l&&qf.GrippersManager.instance.c_a(l.jv);if(a)return 32;cr.Tc.Tb(Nd.a.XYb,{["Reason"]:Od.a.cXg});return 8}static get instance(){return cr.Ja||
(cr.Ja=cr.WB())}static WB(){const a=fb.a.instance;return new cr(()=>a.resolve("Box4.IUndoManager"),a.le("Box4.ICoauthCashTelemetry"))}static get Tc(){return rb.a.instance}}cr.Ja=null;Object(e.a)(cr,"UndoActor",null,[]);class wC{constructor(){this.Da=null}get name(){return"Box4.Actors"}Wb(a){this.Da=a;(new II).Wb(a)}init(){this.Da.resolve("Box4.Actors.ClipboardActor").ub();u.AFrameworkApplication.Ta.ya(E.a.MKi,Bb.a.embeddedFile,RP);u.AFrameworkApplication.Ta.ya(E.a.yUd,Bb.a.embeddedFile,JI);u.AFrameworkApplication.Ta.ya(E.a.yUd,
Bb.a.I_b,JI);br.instance.ub();Ge.ub();Hg.ub();ig.ub();Pn.instance.ub();this.Da.resolve("Box4.ISelectAllHandlers").ub();H.a.instance.ga(70)&&this.Da.resolve("Box4.Actors.ProofingActor").ub();du.instance.ub();const a=this.Da.qb("Box4.IFeatureHelper");a?a.llj.continueWith(()=>{this.Edh()}):this.Edh();Dc.ub(Cb.App.VJa);this.Da.resolve("Box4.Actors.TextFormattingActor").ub();cr.instance.ub();this.Da.resolve("Box4.Actors.AccessibilityActor").oFe();this.Da.resolve("Box4.IClipboardCommands");Cb.App.Hb.updateCommandUI()}Edh(){H.a.instance.ga(71)&&
this.Da.resolve("Box4.Actors.StyleActor").ub()}dispose(){}static main(){m.a.instance.Bc(new wC)}}Object(e.a)(wC,"Box4ActorsPackage",null,[2,3]);class Em{constructor(a,b){this.u6=this.MRh=null;this.ORh=a;this.alb=b}get Xbd(){return this.levelText}get Y6b(){return this.MRh}get levelText(){return this.ORh}get listStyle(){return 6}get JD(){return"left"}get Vla(){return this.u6}get font(){return this.alb}}Object(e.a)(Em,"ListMarkerBullet",null,[408]);class Bf{static get jo(){return Bf.Po||(Bf.Po=fb.a.instance.resolve("Box4.List.IListEditor"))}static get Tf(){return Bf.Sg||
(Bf.Sg=fb.a.instance.resolve("Box4.List.IListReader"))}static get insertionPointFormatting(){return Bf.rt||(Bf.rt=fb.a.instance.resolve("Box4.IInsertionPointFormatting"))}static Sq(){return Bf.xm||(Bf.xm=fb.a.instance.Ka("Box4.IExternalSelectionManager"))}static get Yl(){return Df.ContextSetEditor.instance}static get Yi(){return ed.a.instance}static get Tc(){return rb.a.instance}static get eL(){return Bf.ZJ||(Bf.ZJ=fb.a.instance.qb("Box4.List.ListSettings"))}static get tmc(){return Bf.nSb||(Bf.nSb=
fb.a.instance.qb("Box4.List.ISingleLevelListEditor"))}static ub(){const a=u.AFrameworkApplication.Ta;a.ya(E.a.KO,Bb.a.view,Bf.EUb);a.ya(E.a.KO,Bb.a.outlineElement,Bf.Hob);a.he(E.a.KO,1036);a.ya(E.a.lR,Bb.a.view,Bf.EUb);a.ya(E.a.lR,Bb.a.outlineElement,Bf.Hob);a.he(E.a.lR,1036);Bf.Tf.b$a&&(a.ya(E.a.uWa,Bb.a.view,Bf.EUb),a.ya(E.a.uWa,Bb.a.outlineElement,Bf.Hob),a.he(E.a.uWa,1036));a.ya(E.a.dIf,Bb.a.view,Kd.ActionManager.Hg);a.ya(E.a.OPf,Bb.a.view,Kd.ActionManager.Hg);a.ya(E.a.joinList,Bb.a.view,Kd.ActionManager.Hg);
a.ya(E.a.YJd,Bb.a.view,Kd.ActionManager.Hg);a.ya(E.a.dKd,Bb.a.view,Kd.ActionManager.Hg);a.ya(E.a.rwh,Bb.a.view,Kd.ActionManager.Hg);a.ya(E.a.swh,Bb.a.view,Kd.ActionManager.Hg);a.ya(E.a.vUe,Bb.a.view,Kd.ActionManager.Hg)}static EUb(a,b,c,f,l){if(!b.view.Lh)return 2;const x=Bf.Tc.Kp(E.a.EUb);f.IP=42;f.l7=42;const G={};G[bi.Xna]=5796;G[bi.Wna]=5797;var R=b.view;if(H.a.instance.ga(11)){if(Bf.Yl.Iqa(Bf.xwj,R.Gb.Kj))return Bf.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.SPd}),x.end(),8;if(Bf.Yl.Iqa(Bf.FJd,R.Gb.Kj))return Bf.Tc.Tb(Nd.a.vh,
{["Reason"]:Od.a.$Wb}),x.end(),8}if(H.a.instance.ga(14)&&Bf.Yi.qTc(R.Gb.Kj))return Bf.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.qD}),x.end(),8;if(Bf.Sq()&&Bf.Sq().instance&&Bf.Sq().instance.lW(b))return Bf.Tc.Tb(Nd.a.vh,{["Reason"]:Od.a.externalSelection}),x.end(),8;if(1===c)return x.end(),32;l||(l=new D.DictionaryPropertySet);let fa=null;var wa=2;if(2===c){fa=new Id.GraphTransaction(15);fa.gd(b.view.vg);Bf.m6b=!1;const mb=oi.Nra(R.Gb.Oa,!1);if(!mb)return fa.dispose(),Bf.Tc.Tb(Nd.a.wia,{["Reason"]:Od.a.pKc}),
x.end(),8;u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");1<mb.length&&l.setValue(Oc.a.vWg,null);const Kb=l.sa(Oc.a.aT,-1),nc=l.sa(Oc.a.LD,-1);Bf.eL.a6b&&Bf.tmc&&Bf.tmc.XEl(mb);if(Bf.Tf.qwh){var Wa=Bf.F$k(Kb,nc,mb);Wa&&(l.setValue(Oc.a.LD,16),l.setValue(Oc.a.Vca,0));if(!cb.SelectionEditor.Pg(R.Gb.Kj)&&!Wa&&a!==E.a.uWa&&0<mb.length&&Kb){R=new nb.GraphIterator;Wa=Array(mb.length);for(let oc=0;oc<mb.length;oc++)R.set(mb.getContext(oc).node),
Wa[oc]=Bf.Tf.Pw(R);Bf.E$k(Wa,l)&&(wa=new D.DictionaryPropertySet,wa.setValue(Oc.a.LD,16),wa.setValue(Oc.a.Vca,0),wa=bi.Q4(a,b,c,f,wa,G,11),u.AFrameworkApplication.Ta.processAction(E.a.swh,2),Z.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),Bf.m6b=!0)}}R=new nb.GraphIterator;R.set(mb.getContext(0).node);R=Bf.Tf.Pw(R);Bf.cZj(Kb,nc,R,mb.length)}H.a.instance.ga(63)||H.a.instance.ga(77)?wa=bi.Q4(a,b,c,f,l,G,11):H.a.instance.ga(30)&&(wa=bi.yeb(a,b,c,f,l,G));32===wa&&
l.sa(Oc.a.DJf,!1)&&(H.a.instance.ga(62)?wa=bi.Q4(E.a.rD,b,c,f,l,G,11):H.a.instance.ga(29)?wa=bi.yeb(E.a.rD,b,c,f,l,G):H.a.instance.ga(76));fa&&fa.dispose();x.end();return wa}static E$k(a,b){let c=null;var f=!1;for(let l=a.length-1;0<=l&&(c?(f=a[l],f=-1!==b.sa(Oc.a.aT,-3)?f?c.listType!==f.listType||c.listStyle!==f.listStyle:!0:f?c.listType!==f.listType:!0):c=a[l],!f);l--);return c&&(a=!1,f||(a=b.sa(Oc.a.aT,-3),a=b.sa(Oc.a.LD,42)!==c.listType||0<a),f||a)?!0:!1}static cZj(a,b,c,f){0>=f||Bf.m6b||(a?c?
(c=c.listType,-1===a&&b===c?(u.AFrameworkApplication.Ta.processAction(E.a.vUe,2),Z.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):0<a&&(0===b||1===b)&&(u.AFrameworkApplication.Ta.processAction(0===b?E.a.dKd:E.a.YJd,2),Z.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",0===b?"Numbering":"Bullet"))):(u.AFrameworkApplication.Ta.processAction(0===b?E.a.dKd:E.a.YJd,2),Z.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",0===b?
"Numbering":"Bullet")):(u.AFrameworkApplication.Ta.processAction(E.a.vUe,2),Z.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style")))}static F$k(a,b,c){if(-1!==a&&a||!c.length)return!1;a=new nb.GraphIterator;let f=null;for(let l=c.length-1;0<=l&&!(a.set(c.getContext(l).node),f=Bf.Tf.Pw(a));l--);return f&&b===f.listType?!0:!1}static Hob(a,b,c,f,l){if(b.contextId!==Bb.a.outlineElement)return 2;if(H.a.instance.ga(14)){var x=b.clone().uPe();if(Bf.Yi.dEa(x))return Bf.Tc.Tb(Nd.a.Ko,
{["Reason"]:Od.a.qD}),2}const G=new nb.GraphIterator;G.set(b.node);cb.SelectionEditor.kt(G);if(!ae.OutlineElementReader.Ug(G))return 2;if(1===c)switch(a){case E.a.KO:return 32;case E.a.lR:return 32;case E.a.uWa:return 32;default:return 2}x=Bf.Tf.Pw(G);let R=l;if(!R)return 8;!Ib.ListReader.Ww&&a===E.a.lR&&G.gDa()&&(G.pI(4)||R.setValue(Oc.a.sTa,1),G.yp());Bf.Tf.b$a?(a===E.a.lR||a===E.a.KO?(R=Bf.jo.b2f(a,R),b=Ae.a.AP(R.getValue(Oc.a.LD),R.getValue(Oc.a.Vca))):b=a===E.a.uWa?Ae.a.AP(0,1):null,Bf.oQ(a,
R),Bf.n5k(b,R)):(R=Bf.jo.b2f(a,R),b=Ae.a.AP(R.getValue(Oc.a.LD),R.getValue(Oc.a.Vca)));Ib.ListReader.Ww||(b.iA=R.sa(tb.a.uTa,wf.a.yw));Bf.u6k(R,G);if(!({u8a:b}=Bf.jo.Hob(R,G,b,!1)).returnValue)return Bf.Tc.Tb(Nd.a.Ko,{["Reason"]:Od.a.iee}),2;2===c&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),a=l.sa(Oc.a.LD,-1),b&&-1!==a&&((l=l.sa(Mb.a.f_,"Invalid MultiLevel Type"),x)?0!==b.listType&&1!==b.listType||Bf.m6b||(u.AFrameworkApplication.Ta.processAction(E.a.rwh,
2),Z.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",a?"Bullet":"Numbering",l)):16===b.listType?(u.AFrameworkApplication.Ta.processAction(E.a.OPf,2),Z.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",a?"Bullet":"Numbering",l)):0!==b.listType&&1!==b.listType||Bf.m6b||(u.AFrameworkApplication.Ta.processAction(E.a.dIf,2),Z.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",a?"Bullet":"Numbering",l))),l=v.FocusManager.instance(),
l.ze.name===I.AppFrame.Ofd&&l.IC(y.AFrame.PV));f.IP=b.listType;f.l7=b.listStyle;return 32}static u6k(a,b){var c=new nb.GraphIterator;c.Pc(b);(b=c.Ab(2))&&yb.ParagraphReader.Vd(b)&&(c=qd.a.instance.Oa.kb)&&c.Ua&&c.Ua.node===b&&cb.SelectionEditor.yVc(c)&&(Bf.r4k(a),Bf.p4k(a))}static n5k(a,b){b.Sa(Mb.a.f_)&&a.m5k(b.getValue(Mb.a.f_));a.aT=b.sa(Oc.a.aT,-1);a.wce?(b=Bf.G8i(a,b),Bf.r6k(a,b)):Bf.E3k(a)}static E3k(a){if(a.JUc)a.HQc&&-1===a.aT||(a.levelText="%1.",a.propertySet.Sa(tb.a.Ni)||a.$Ia(0,1));else if(1===
a.listType)a.HQc&&-1===a.aT||(a.font=wf.a.DFi,a.levelText=wf.a.defaultBullet,a.propertySet.Sa(tb.a.Ni)||a.$Ia(1,6));else return;a.JD="left"}static r6k(a,b){1===a.f_?Bf.B5k(a,b):Bf.D4k(a,b)}static B5k(a,b){a.Vla=b.Vla}static D4k(a,b){a.levelText=b.levelText;a.JUc?a.$Ia(0,b.listStyle):(a.font=b.font,a.$Ia(1,1));a.JD=b.JD}static G8i(a,b){let c=null;2===a.f_?c=a.JUc?fb.a.instance.qb("Box4.ListMarkerGallery.ListMarkerNumberingLoader"):fb.a.instance.qb("Box4.ListMarkerGallery.ListMarkerBulletLoader"):1===
a.f_&&(c=fb.a.instance.qb("Box4.ListMarkerGallery.ListMarkerMultilevelLoader"));let f=c.sCg.value;a=a.aT+"";a in f||(f=c.vVj);return a in f||!b.Sa(tb.a.font)?f[a]:new Em(Ka.a.fromCharCode(parseInt(a)),b.sa(tb.a.font,""))}static p4k(a){Bf.insertionPointFormatting.Sa(tb.a.fontColor)&&a.setValue(tb.a.fontColor,Bf.insertionPointFormatting.fontColor())}static r4k(a){Bf.insertionPointFormatting.Sa(tb.a.fontSize)&&a.setValue(tb.a.fontSize,Bf.insertionPointFormatting.fontSize())}static oQ(a,b){Z.ULS.sendTraceTag(22923024,
324,50,"{ListType:%1, ListStyleId:%2}",a===E.a.KO?0:a===E.a.lR?1:a===E.a.uWa?2:-1,b.sa(Oc.a.aT,-1))}}Bf.xwj=W.ImageReader.e5b;Bf.FJd=W.ImageReader.Fvb;Bf.Po=null;Bf.Sg=null;Bf.rt=null;Bf.xm=null;Bf.ZJ=null;Bf.nSb=null;Bf.m6b=!1;Object(e.a)(Bf,"ListActor",null,[]);var MI=d(1169);class eu{constructor(){this.PRh=new Sa.a(Object(C.a)(this,this.jRd,"createListMarkerDictionary"));this.QRh={}}get sCg(){return this.PRh}get vVj(){return this.QRh}}Object(e.a)(eu,"AListMarkerGalleryLoader",null,[413]);var NI=
d(1196);class qz extends Zw.a{constructor(){super();this.LevelInfo=null}get Type(){return 5}}Object(e.a)(qz,"ListGalleryButtonProps",Zw.a,[]);class Ds{constructor(a,b,c,f){this.JPb=null;this.wLf="BulletLibraryGallery";this.Gik="NumberingLibraryGallery";this.qgk="MultilevelGallery";this.t1a=a;this.RRh=b;switch(a){case 0:this.JPb="BulletStyle";break;case 1:this.JPb="NumberingStyle";break;case 2:this.JPb="MultilevelStyle";break;default:this.JPb="BulletStyle"}this.SQh=f}get wVj(){return this.RRh}IDf(a){let b;
var c=1;switch(this.t1a){case 0:var f=Box4Intl.Box4Strings.L_BulletsLibraryTitle;var l=b="BulletsLibrary";break;case 1:f=Box4Intl.Box4Strings.L_NumberingLibraryTitle;b="NumberingLibrary";c=5;l="NumberingLibrary";break;case 2:f=Box4Intl.Box4Strings.L_ListLibraryTitle;b="MultilevelLibrary";c=5;l="Multilevel";break;default:f=Box4Intl.Box4Strings.L_BulletsLibraryTitle,l=b="BulletsLibrary"}f=Object.assign(new Mi.a,{Id:String.format("msListMarkersPosition{0}",b),Title:f,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",
ControlList:[]});var x=0===this.t1a?"Size40by40":"Size48by48";c=Object.assign(new tq.a,{Id:String.format("galleryListMarkersPosition{0}",b),ExternalId:l,ExternalGalleryId:this.t0d(this.t1a),Type:c,Width:6,ElementDimensions:x,GalleryItems:[]});l=this.wVj.sCg.value;x=uq.a(l);const G=Math.min(18,x.length);for(let R=0;R<G;R++){const fa=l[x[R]];this.SQh&&a&&((1===this.t1a||2===this.t1a)&&!fa.Y6b||0===this.t1a&&fa.levelText===Box4Intl.Box4Strings.L_ListStyleNone)||c.GalleryItems.push(this.s0d(this.JPb+
b+"_"+R,fa,this.t1a))}Array.add(f.ControlList,c);return f}t0d(a){switch(a){case 0:return this.wLf;case 1:return this.Gik;case 2:return this.qgk;default:return this.wLf}}ibg(a){const b={},c=ia.FontUtils.Xha(a.font);b.fontFamily=ia.FontUtils.gob(c,a.font,!0,!1,!1);return b}s0d(a,b,c){var f="";let l=!1;0===c&&b.levelText!==Box4Intl.Box4Strings.L_ListStyleNone&&(f=Ka.a.Sv(b.levelText.charCodeAt(0),4),f=Ds.FEj(b.font)&&!f.indexOf("f")?" 0x0"+f.substr(1):" 0x"+f,f=b.font+f,l=!0);let x,G;switch(c){case 0:c=
E.a.KO;x=E.a.G$g;G=Object.assign(new NI.a,{Character:b.levelText,Style:this.ibg(b)});break;case 1:c=E.a.lR;x=E.a.dFk;G=Object.assign(new qz,{LevelInfo:b.Y6b});break;case 2:c=E.a.uWa;x=E.a.cFk;G=Object.assign(new qz,{LevelInfo:b.Y6b});b.Vla&&(f=b.Vla.description,l=!0);break;default:c=E.a.KO,x=E.a.G$g,G=Object.assign(new NI.a,{Character:b.levelText,Style:this.ibg(b)})}G.Id=a;G.Command=c.toString();G.QueryCommand=x.toString();G.Alt=f;G.InnerHTML=Ka.a.je(this.tVj(b));G.ShouldSetTitle=l.toString();return G}tVj(a){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',
this.e1d(a),this.d1d(a))}e1d(a){const b=new Sys.StringBuilder;b.append("position: relative; ");if(a.Xbd===Box4Intl.Box4Strings.L_ListStyleNone&&a.font===Ds.Csg)b.append("font-size: 12pt; "),b.append("top: 22%;");else{b.append("font-family: ");const c=ia.FontUtils.Xha(a.font);b.append(ia.FontUtils.gob(c,a.font,!0,!1,!1));b.append("; ");b.append("font-size: 24pt;")}return b.toString()}d1d(a){return a.Xbd}static FEj(a){for(let b=0;b<Ds.ZIf.length;b++)if(a===Ds.ZIf[b])return!0;return!1}}Ds.Csg="EXYdHRyjlYTe8nDSGfyW";
Ds.ZIf=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"];Object(e.a)(Ds,"ListMarkerGalleryUtility",null,[]);class xC extends eu{constructor(){super();new MI.a(hB.a.Tq())}jRd(){const a={};a["0"]=new Em(Box4Intl.Box4Strings.L_ListStyleNone,Ds.Csg);a["1"]=new Em(String.fromCharCode(61623),"Symbol");a["2"]=new Em(String.fromCharCode(111),"Courier New");a["3"]=new Em(String.fromCharCode(61607),"Wingdings");a["4"]=new Em(String.fromCharCode(9643),"Courier New");a["5"]=new Em(String.fromCharCode(61611),
"Wingdings");a["6"]=new Em(String.fromCharCode(61614),"Symbol");a["7"]=new Em(String.fromCharCode(61483),"Symbol");a["8"]=new Em(String.fromCharCode(61485),"Symbol");a["9"]=new Em(String.fromCharCode(9830),"Courier New");a["10"]=new Em(String.fromCharCode(61664),"Symbol");a["11"]=new Em(String.fromCharCode(61558),"Wingdings");a["12"]=new Em(String.fromCharCode(61656),"Wingdings");a["13"]=new Em(String.fromCharCode(61514),"Wingdings");a["14"]=new Em(String.fromCharCode(61516),"Wingdings");a["15"]=
new Em(String.fromCharCode(61692),"Wingdings");a["16"]=new Em(String.fromCharCode(61691),"Wingdings");a["17"]=new Em(String.fromCharCode(61553),"Wingdings");return a}}Object(e.a)(xC,"ListMarkerBulletLoader",eu,[]);class Ik{constructor(){this.styleAtLevel=this.textAtLevel=null}}Object(e.a)(Ik,"InfoAtLevel",null,[]);class fu{constructor(a){this.u6=a}get font(){return"Calibri"}get listStyle(){return 42}get JD(){return"left"}get Vla(){return this.u6}get Xbd(){return this.u6?this.kCk():this.mCk()}get Y6b(){return this.u6?
this.lCk():null}get levelText(){return""}K5i(a){switch(a){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}}kCk(){let a="";for(let b=0;3>b;b++)a+=this.OCa(b);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',fu.v_d(),a)}lCk(){const a=[];for(let b=0;3>b;b++)a.push(Object.assign(new Ik,{textAtLevel:this.ueg(b),styleAtLevel:this.ygj(b)}));return a}mCk(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',
fu.w_d(),Box4Intl.Box4Strings.L_ListStyleNone)}ueg(a){a=this.u6.dCg[a];for(let b=0;9>b;b++)a=Ka.a.replaceAll(a,"%"+(b+1),this.K5i(this.u6.nXc[b]));return a}ygj(a){const b={};b.fontFamily=6===this.u6.nXc[a]?this.u6.P6f[a]:this.font;return b}OCa(a){const b=this.ueg(a),c=new Sys.StringBuilder;6===this.u6.nXc[a]&&c.append(String.format("font-family:{0};",this.u6.P6f[a]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',
a,c.toString(),b)}static v_d(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static w_d(){const a=new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(e.a)(fu,"ListMarkerMultilevel",null,[408]);class rz{constructor(a,b,c,f,l){this.dCg=a;this.nXc=b;this.hTj=f;this.P6f=c;this.description=l}}Object(e.a)(rz,"MultilevelDefInfo",null,[]);class OI{Syi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle;
let b="";const c=Array(9),f=Array(9),l=Array(9),x=Array(9);for(let G=0;9>G;G++)b+="%"+(G+1)+".",c[G]=b,f[G]=1,l[G]="left";return new rz(c,f,x,l,a)}fBi(){var a=Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle;const b=Array(9),c=Array(9);for(let f=0;9>f;f++)b[f]=2===f%3?"right":"left";return new rz("%1) %2) %3) (%4) (%5) (%6) %7. %8. %9.".split(" "),[1,2,3,1,2,3,1,2,3],c,b,a)}iyi(){var a=[61558,61656,61607,61623,9830,61656,61607,61623,9830],b=Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle;
const c=Array(9),f=Array(9),l=Array(9);for(let x=0;9>x;x++)l[x]=String.fromCharCode(a[x]),c[x]=6,f[x]="left";return new rz(l,c,"Wingdings;Wingdings;Wingdings;Symbol;Courier New;Wingdings;Wingdings;Symbol;Courier New".split(";"),f,b)}}Object(e.a)(OI,"MultilevelDefInfoAdaptor",null,[]);class yC extends eu{constructor(){super()}jRd(){const a=new OI,b={};b["0"]=new fu(null);b["1"]=new fu(a.Syi());b["2"]=new fu(a.fBi());b["3"]=new fu(a.iyi());return b}}Object(e.a)(yC,"ListMarkerMultilevelLoader",eu,[]);
class Xm{constructor(a,b){this.u6=null;this.n1a=a;this.uvc=b}get font(){return"Calibri"}get listStyle(){return this.uvc}get JD(){switch(this.uvc){case 3:case 5:return"right";default:return"left"}}get Vla(){return this.u6}get Xbd(){switch(this.uvc){case 1:return this.aIa("1","2","3");case 2:return this.aIa("a","b","c");case 3:return this.aIa("i","ii","iii");case 4:return this.aIa("A","B","C");case 5:return this.aIa("I","II","III");case 0:return this.nCk();default:return this.aIa("1","2","3")}}get Y6b(){const a=
[],b={};b.fontFamily=ia.FontUtils.Xha(this.font);switch(this.uvc){case 1:return a.push(Object.assign(new Ik,{textAtLevel:this.hN("1"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("2"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("3"),styleAtLevel:b})),a;case 2:return a.push(Object.assign(new Ik,{textAtLevel:this.hN("a"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("b"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("c"),
styleAtLevel:b})),a;case 3:return a.push(Object.assign(new Ik,{textAtLevel:this.hN("i"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("ii"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("iii"),styleAtLevel:b})),a;case 4:return a.push(Object.assign(new Ik,{textAtLevel:this.hN("A"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("B"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("C"),styleAtLevel:b})),a;case 5:return a.push(Object.assign(new Ik,
{textAtLevel:this.hN("I"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("II"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("III"),styleAtLevel:b})),a;case 0:return null;default:return a.push(Object.assign(new Ik,{textAtLevel:this.hN("1"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("2"),styleAtLevel:b})),a.push(Object.assign(new Ik,{textAtLevel:this.hN("3"),styleAtLevel:b})),a}}get levelText(){return this.n1a}aIa(a,b,c){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',
Xm.v_d(),this.OCa(a),this.OCa(b),this.OCa(c))}nCk(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',Xm.w_d(),Box4Intl.Box4Strings.L_ListStyleNone)}OCa(a){a=this.hN(a);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}hN(a){return Ka.a.replaceAll(this.n1a,"%1",a)}static v_d(){const a=new Sys.StringBuilder;a.append("padding-left: 2pt; ");a.append("font-size: 9pt; ");return a}static w_d(){const a=
new Sys.StringBuilder;a.append("text-align: center; ");a.append("margin-top: 22%; ");a.append("font-size: 12pt; ");return a}}Object(e.a)(Xm,"ListMarkerNumbering",null,[408]);class zC extends eu{constructor(){super();new MI.a(hB.a.Tq())}jRd(){const a={};a["0"]=new Xm(Box4Intl.Box4Strings.L_ListStyleNone,0);a["1"]=new Xm("%1.",5);a["2"]=new Xm("%1.",4);a["3"]=new Xm("%1.",1);a["4"]=new Xm("%1.",2);a["5"]=new Xm("%1.",3);a["6"]=new Xm("%1)",5);a["7"]=new Xm("%1)",4);a["8"]=new Xm("%1)",1);a["9"]=new Xm("%1)",
2);a["10"]=new Xm("%1)",3);a["11"]=new Xm("(%1)",5);a["12"]=new Xm("(%1)",4);a["13"]=new Xm("(%1)",1);a["14"]=new Xm("(%1)",2);a["15"]=new Xm("(%1)",3);return a}}Object(e.a)(zC,"ListMarkerNumberingLoader",eu,[]);class AC{constructor(){this.Da=null}get name(){return"Box4.ListMarker"}init(){Bf.ub()}dispose(){}Wb(a){this.Da=a;this.Da.register(xC,"Box4.ListMarkerGallery.ListMarkerBulletLoader").ma().na(()=>new xC);this.Da.register(zC,"Box4.ListMarkerGallery.ListMarkerNumberingLoader").ma().na(()=>new zC);
this.Da.register(yC,"Box4.ListMarkerGallery.ListMarkerMultilevelLoader").ma().na(()=>new yC)}static main(){m.a.instance.Bc(new AC)}}Object(e.a)(AC,"Box4ListMarkerPackage",null,[2,3]);class BC{constructor(a){this.oqd=a}Sug(a){if(!this.oqd)return!0;a=Ze.a.DNc(a);if(!a)return!1;a=a.toLowerCase();for(let b=0;b<this.oqd.length;b++)if(a.endsWith(this.oqd[b]))return!0;return!1}}Object(e.a)(BC,"DomainAllowListManager",null,[]);class PI{constructor(a,b){this.xSd=null;this.GFd=a;this.url=b}get VVe(){return Ze.a.Mma(this.url)}get qB(){return this.GFd}CSe(){const a=
{},b=this.qB;a.a=this.VVe;a.b=this.round(b.navigationStart);a.c=this.round(b.unloadEventStart);a.d=this.round(b.unloadEventEnd);a.e=this.round(b.redirectStart);a.f=this.round(b.redirectEnd);a.g=this.round(b.fetchStart);a.h=this.round(b.domainLookupStart);a.i=this.round(b.domainLookupEnd);a.j=this.round(b.connectStart);a.k=this.round(b.connectEnd);a.l=void 0!==b.secureConnectionStart&&null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.m=this.round(b.requestStart);a.n=this.round(b.responseStart);
a.o=this.round(b.responseEnd);a.q=this.round(b.domInteractive);a.r=this.round(b.domContentLoadedEventStart);a.s=this.round(b.domContentLoadedEventEnd);a.t=this.round(b.domComplete);a.u=this.round(b.loadEventStart);a.v=this.round(b.loadEventEnd);a.w=this.xSd;return a}round(a){return Math.round(1E3*a)/1E3}}Object(e.a)(PI,"PerformanceTimingEntry",null,[]);const QI=(a,b)=>{const c={};let f=null;switch(a){case 0:f="ResourceTiming";a=b.a;null!=a&&(c.Url=a);a=b.b;null!=a&&(c.InitiatorType=a);a=null==b.c?
null:b.c.toString();null!=a&&(c.RedirectStart=a);a=null==b.d?null:b.d.toString();null!=a&&(c.RedirectEnd=a);a=null==b.e?null:b.e.toString();null!=a&&(c.FetchStart=a);a=null==b.f?null:b.f.toString();null!=a&&(c.DomainLookupStart=a);a=null==b.g?null:b.g.toString();null!=a&&(c.DomainLookupEnd=a);a=null==b.h?null:b.h.toString();null!=a&&(c.ConnectStart=a);a=null==b.i?null:b.i.toString();null!=a&&(c.ConnectEnd=a);a=null==b.j?null:b.j.toString();null!=a&&(c.SecureConnectionStart=a);a=null==b.k?null:b.k.toString();
null!=a&&(c.RequestStart=a);a=null==b.l?null:b.l.toString();null!=a&&(c.ResponseStart=a);a=null==b.m?null:b.m.toString();null!=a&&(c.ResponseEnd=a);a=b.n;null!=a&&(c.CustomText=a);a=null==b.o?null:b.o.toString();null!=a&&(c.DecodedBodySize=a);a=null==b.p?null:b.p.toString();null!=a&&(c.EncodedBodySize=a);b=null==b.q?null:b.q.toString();null!=b&&(c.TransferSize=b);break;case 1:f="PerformanceTiming",a=b.a,null!=a&&(c.Url=a),a=null==b.b?null:b.b.toString(),null!=a&&(c.NavigationStart=a),a=null==b.c?
null:b.c.toString(),null!=a&&(c.UnloadEventStart=a),a=null==b.d?null:b.d.toString(),null!=a&&(c.UnloadEventEnd=a),a=null==b.e?null:b.e.toString(),null!=a&&(c.RedirectStart=a),a=null==b.f?null:b.f.toString(),null!=a&&(c.RedirectEnd=a),a=null==b.g?null:b.g.toString(),null!=a&&(c.FetchStart=a),a=null==b.h?null:b.h.toString(),null!=a&&(c.DomainLookupStart=a),a=null==b.i?null:b.i.toString(),null!=a&&(c.DomainLookupEnd=a),a=null==b.j?null:b.j.toString(),null!=a&&(c.ConnectStart=a),a=null==b.k?null:b.k.toString(),
null!=a&&(c.ConnectEnd=a),a=null==b.l?null:b.l.toString(),null!=a&&(c.SecureConnectionStart=a),a=null==b.m?null:b.m.toString(),null!=a&&(c.RequestStart=a),a=null==b.n?null:b.n.toString(),null!=a&&(c.ResponseStart=a),a=null==b.o?null:b.o.toString(),null!=a&&(c.ResponseEnd=a),a=null==b.p?null:b.p.toString(),null!=a&&(c.DomLoading=a),a=null==b.q?null:b.q.toString(),null!=a&&(c.DomInteractive=a),a=null==b.r?null:b.r.toString(),null!=a&&(c.DomContentLoadedEventStart=a),a=null==b.s?null:b.s.toString(),
null!=a&&(c.DomContentLoadedEventEnd=a),a=null==b.t?null:b.t.toString(),null!=a&&(c.DomComplete=a),a=null==b.u?null:b.u.toString(),null!=a&&(c.LoadEventStart=a),a=null==b.v?null:b.v.toString(),null!=a&&(c.LoadEventEnd=a),b=b.w,null!=b&&(c.CustomText=b)}c.Table=f;return Sys.Serialization.JavaScriptSerializer.serialize(c)};var Th=d(284);class Nr{constructor(a,b=null,c=null){this.mi=a;this.UVe=this;this.nOh=b||(()=>window.location.href);this.ltd=new BC(c)}run(){if(Nr.NAa(window.performance))try{const l=
this.nOh();if(Nr.sZh.exec(l)&&this.ltd.Sug(l)){var a=new PI(window.performance.timing,l);Gh.a.instance.DKk(a.qB.fetchStart);Gh.a.instance.FKk(a.qB.navigationStart);Gh.a.instance.jWa(Th.a.XWi,"connectStart","requestStart");Gh.a.instance.jWa(Th.a.cXi,"requestStart","responseStart");Gh.a.instance.jWa(Th.a.eXi,"responseStart","responseEnd");this.UVe.e$a(1,a.CSe());this.mi.hc(Th.a.mCa,a.qB.fetchStart);this.mi.hc(Th.a.aXi,a.qB.domainLookupStart);this.mi.hc(Th.a.v7f,a.qB.domainLookupEnd);this.mi.hc(Th.a.ZWi,
a.qB.connectStart);this.mi.hc(Th.a.fXi,a.qB.secureConnectionStart);this.mi.hc(Th.a.YWi,a.qB.connectEnd);this.mi.hc(Th.a.x7f,a.qB.requestStart);this.mi.hc(Th.a.GLc,a.qB.responseStart);this.mi.hc(Th.a.w7f,a.qB.responseEnd-a.qB.responseStart);this.mi.hc(Th.a.dXi,a.qB.responseStart-a.qB.requestStart);var b=0,c=0,f=0;({transferSize:b,lVd:c,ISd:f}=this.Asl(l)).returnValue&&(this.mi.hc(Th.a.gXi,b),this.mi.hc(Th.a.$Wi,f),this.mi.hc(Th.a.bXi,c));this.mi.hc(Th.a.Z_b,a.qB.navigationStart)}}catch(l){Z.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",l)}}Asl(a){let b,c,f;f=c=b=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:b,lVd:c,ISd:f};a=window.performance.getEntriesByName(a,"navigation");if(void 0===a||null===a||1!==a.length)return{returnValue:!1,transferSize:b,lVd:c,ISd:f};a=a[0];var l=a.transferSize;void 0!==b&&null!==b&&(b=l);l=a.decodedBodySize;void 0!==l&&null!==l&&(f=l);a=a.encodedBodySize;void 0!==
a&&null!==a&&(c=a);return{returnValue:!0,transferSize:b,lVd:c,ISd:f}}e$a(a,b){Z.ULS.sendTraceTag(4551815,306,50,QI(a,b))}static get instance(){return Nr.Ja||(Nr.Ja=new Nr(tg.a.instance,null,u.AFrameworkApplication.fa.ka("PerfTimingLoggerFilterDomainsIsEnabled")?u.AFrameworkApplication.fa.XB("ResourceLoggerDomainAllowList"):null))}static NAa(a){return!(void 0===a||null===a)&&!(void 0===a.timing||null===a.timing)}}Nr.Ja=null;Nr.sZh=RegExp("^https?://.*","i");Object(e.a)(Nr,"PerformanceTimingLogger",
null,[405]);class Es{constructor(a,b){this.xSd=null;this.GFd=a;this.behavior=b;this.url=this.qB.name}get VVe(){return 2===this.behavior?this.url:Ze.a.Mma(this.url)}get qB(){return this.GFd}CSe(){const a={},b=this.qB;a.a=this.VVe;a.b=b.initiatorType;a.c=this.round(b.redirectStart);a.d=this.round(b.redirectEnd);a.e=this.round(b.fetchStart);a.f=this.round(b.domainLookupStart);a.g=this.round(b.domainLookupEnd);a.h=this.round(b.connectStart);a.i=this.round(b.connectEnd);a.j=void 0!==b.secureConnectionStart&&
null!==b.secureConnectionStart?this.round(b.secureConnectionStart):0;a.k=this.round(b.requestStart);a.l=this.round(b.responseStart);a.m=this.round(b.responseEnd);a.o=this.round(Es.Rtb(b,"decodedBodySize"));a.p=this.round(Es.Rtb(b,"encodedBodySize"));a.q=this.round(Es.Rtb(b,"transferSize"));a.n=this.xSd;return a}round(a){return Math.round(1E3*a)/1E3}static Rtb(a,b){return a[b]}}Object(e.a)(Es,"ResourceTimingEntry",null,[443]);class RI{constructor(a,b=null,c=100){this.wYe=a;this.Wyc=b;this.Fjb={};this.AKh=
c}prl(a){var b=a.name.toLowerCase();const c=Ze.a.T1d(b);this.GWk(c,b)&&(c in this.Fjb?Z.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",c):(b={},b.fetchstart=a.fetchStart,b.responseend=a.responseEnd,b.iscached=this.jRj(a),b.encodedsize=Es.Rtb(a,"encodedBodySize"),b.decodedsize=Es.Rtb(a,"decodedBodySize"),this.Fjb[c]=b))}GWk(a,b){if(this.wYe)return Array.contains(this.wYe,a);if(this.Wyc)for(a=Ze.a.yD(b),b=0;b<this.Wyc.length;b++)if(this.Wyc[b]&&a.endsWith(this.Wyc[b]))return!0;
return!1}jRj(a){try{const b=Es.Rtb(a,"transferSize");if(void 0!==b&&null!==b)return!b;Z.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return a.responseEnd-a.fetchStart<this.AKh}catch(b){Z.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",b.message)}return!1}rLk(){if(ta.a.Va(this.Fjb))Z.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");
else{var a=u.AFrameworkApplication.wS?u.AFrameworkApplication.wS.split(";"):[],b=Object.assign(new mk.a,{extendedProperties:eq.a.Fz()});b.extendedProperties.set("Flights",Yd.c(a));this.$Yj(b,this.Fjb,vf.Health.instance)}}rZd(a){let b=0,c=0,f=0,l=0;const x=this.Fjb;for(let R in x){var G=x[R];R.endsWith(".js")&&(G=Object(ua.a)(Object,G),G.responseend<a&&(b+=1,c+=G.decodedsize,l+=G.encodedsize,f+=G.iscached?0:G.encodedsize))}a={};a.filesLoaded=b;a.decodedBytes=c;a.transferredBytes=f;a.encodedBytes=l;
return a}$Yj(a,b,c){if(b){var f=0,l=0,x=0,G=0,R=0,fa=0,wa=0,Wa=0,mb=0,Kb=0,nc=0;for(let Ic in b){var oc=b[Ic];try{const Kc=Object(ua.a)(Object,oc);if(!Kc)continue;const Hc=Kc.iscached?Boolean.parse(Kc.iscached.toString()):!1,ie=Kc.fetchstart?this.parseFloat(Kc.fetchstart.toString()):0,He=(Kc.responseend?this.parseFloat(Kc.responseend.toString()):0)-ie,fe=Kc.encodedsize?this.parseFloat(Kc.encodedsize.toString()):0,Te=Kc.decodedsize?this.parseFloat(Kc.decodedsize.toString()):0;f+=He;G+=fe;wa+=Te;Kb++;
Hc?(x+=He,fa+=fe,mb+=Te,nc++):(l+=He,R+=fe,Wa+=Te)}catch(Kc){Z.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Kc.message)}}a.extendedProperties.set("StaticResources",Yd.c(b));a.extendedProperties.set("TotalResourceDownloadLatency",f.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",l.toString());a.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",x.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
G.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",R.toString());a.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",fa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",wa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Wa.toString());a.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",mb.toString());a.extendedProperties.set("TotalNumberOfResourcesDownloaded",Kb.toString());
a.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",nc.toString());c.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);c.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",a)}}parseFloat(a){if(!a)return 0;a=parseFloat(a);return isNaN(a)?0:a}}Object(e.a)(RI,"AppStaticResourceManager",null,[]);class SI extends Sys.EventArgs{constructor(a){super();this.entries=a}}Object(e.a)(SI,"EntriesAvailableEventArgs",Sys.EventArgs,[]);class Bv{constructor(a,
b,c=null,f=null,l=100){this.Fxd=!1;this.Lm=null;this.GMb=0;this.Pa=new ic.a;this.Mjb=null;this.yga=!1;this.Fzf=0;this.Rd=a;this.J0e=0;this.UVe=this;this.ltd=new BC(c);this.fD=b;f&&(this.Mjb=new RI(null,f,l))}get PKf(){try{return!(void 0===this.fD||null===this.fD)&&!(void 0===this.fD.getEntriesByType||null===this.fD.getEntriesByType)}catch(a){return Z.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",a),!1}}get BFi(){return this.J0e}get isActive(){return this.yga}get tSe(){return this.Fzf}JEf(a){this.Pa.addHandler(Bv.SVd,
a)}Yeh(a){this.Pa.removeHandler(Bv.SVd,a)}Wb(a,b){const c=this.tSe!==a;this.Fzf=a;this.isActive&&this.Rd&&c&&(this.Ng(),this.Cb());this.J0e=b}activate(){!this.isActive&&this.PKf&&(this.Cb(),this.yga=!0)}deactivate(a){this.isActive&&(this.Ng(),a&&this.flush(),this.yga=!1)}flush(){if(this.isActive&&this.PKf)try{var a=window.performance.getEntriesByType("resource");0<a.length-this.GMb&&Z.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",
a.length-this.GMb);const b=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);b&&(window.performance.clearResourceTimings(),this.GMb=0);const c=[];for(let f=this.GMb;f<a.length;f++)this.ltd.Sug(a[f].name)&&(this.Mjb&&this.Mjb.prl(a[f]),c.push(new Es(a[f],this.BFi)));b||(this.GMb=a.length);this.Pa.raiseEvent(Bv.SVd,new SI(c));for(a=0;a<c.length;a++)0!==c[a].behavior&&2!==c[a].behavior||this.UVe.e$a(0,c[a].CSe());0<c.length&&Z.ULS.sendTraceTag(19506834,
306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",c.length)}catch(b){Z.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",b)}}e$a(a,b){Z.ULS.sendTraceTag(4310804,306,50,QI(a,b))}yKk(){this.Mjb.rLk()}rZd(a){return this.Mjb.rZd(a)}Cb(){this.Rd&&0<this.tSe&&(this.Lm=new xe.a(3,2,1E3*this.tSe,()=>{this.flush()},5),this.Rd.Cb(this.Lm),this.Fxd=!0)}Ng(){this.Fxd&&(this.Rd.Ng(this.Lm),this.Lm=null,this.Fxd=!1)}}Bv.SVd="EntriesAvailable";
Object(e.a)(Bv,"ResourceTimingLogger",null,[365,405]);class CC{constructor(){this.Da=null}get name(){return"Common.ResourceTiming"}init(){this.Da.resolve("Common.NetworkTiming.IResourceTimingLogger");Nr.instance.run()}dispose(){}Wb(a){this.Da=a;let b=null;if(u.AFrameworkApplication.fa.ka("ResourceLoggerFilterDomainsIsEnabled"))try{b=u.AFrameworkApplication.fa.XB("ResourceLoggerDomainAllowList")}catch(l){Z.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}const c=
[];c.push(Ze.a.yD(sp.a.GO).toLowerCase());c.push(Ze.a.yD(sp.a.YHb).toLowerCase());const f=u.AFrameworkApplication.fa.Cc("AppStaticResourceMonitorCacheThresholdInMs",100);a.register(365,"Common.NetworkTiming.IResourceTimingLogger").ma().na(()=>new Bv(u.AFrameworkApplication.pe,window.performance,b,c,f))}static main(){m.a.instance.Bc(new CC)}}Object(e.a)(CC,"ResourceTimingPackage",null,[2,3]);class Cv{}Cv.visible="visible";Cv.hidden="hidden";Object(e.a)(Cv,"PlatformVisibilityState",null,[]);var sz=
d(195);class TI extends Sys.EventArgs{constructor(a,b){super();this.qff={};this.uTh=a;this.cTh=b}get oldState(){return this.uTh}get newState(){return this.cTh}Kfb(a,b){this.qff[a]=b}toString(){return Yd.c(this.qff)}}Object(e.a)(TI,"VisibilityStateChangeEventArgs",Sys.EventArgs,[]);class DC{constructor(a,b,c,f){this.Dzf=this.uNa=null;this.Kwf=!0;this.Pa=new ic.a;this.Rd=a;this.Gud=b;this.U0e=c;this.w_h=f;this.Qbf=!1;u.AFrameworkApplication.fa&&(this.Qbf=u.AFrameworkApplication.fa.ka("WordPriorityTaskLoggingOnComingOutOfFrozenIsEnabled"),
this.Kwf=u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ListenToResumeEvents",!0));this.yYe=0;this.Bzf=new Date;this.Gud()===Cv.hidden&&this.HTf();$addHandler(window,"focus",Object(C.a)(this,this.p1g,"onPlatformFocusHandler"));$addHandler(window,"blur",Object(C.a)(this,this.$9c,"onPlatformBlurHandler"));$addHandler(document,"freeze",Object(C.a)(this,this.q1g,"onPlatformFreezeHandler"));$addHandler(document,"visibilitychange",Object(C.a)(this,this.r1g,"onPlatformVisibilityChangeHandler"));
this.Kwf&&($addHandler(document,"pageshow",Object(C.a)(this,this.$9c,"onPlatformBlurHandler")),$addHandler(document,"resume",Object(C.a)(this,this.$9c,"onPlatformBlurHandler")))}get G3a(){return this.yYe}get isVisible(){return 2!==this.G3a}EBc(a){this.Pa.addHandler("VST",a)}tSk(a){this.Pa.removeHandler("VST",a)}$9c(a){this.YJb(a.type,this.r4d())}p1g(a){this.YJb(a.type,0)}q1g(a){3!==this.G3a&&(this.dQf(),this.YJb(a.type,2),this.YJb(a.type,3),u.AFrameworkApplication.Tg.rdk())}r4d(){return this.Gud()===
Cv.hidden?2:document.hasFocus()?0:1}YJb(a,b){const c=this.G3a;this.yYe=b;if(c!==this.G3a){3===c&&this.Qbf&&this.l_k();const f=new Date,l=new TI(c,this.G3a);l.Kfb("FromState",Wg[c]);l.Kfb("ToState",Wg[b]);l.Kfb("OriginatingEvent",a);l.Kfb("TimeInState",(+f-+this.Bzf).toString());this.Bzf=f;this.w_h.VDg(l);this.Pa.raiseEvent("VST",l)}}r1g(a){this.Gud()===Cv.hidden?this.uNa?this.Rd.a5(this.uNa,this.U0e):this.HTf():(this.dQf(),this.YJb(a?a.type:"",this.r4d()))}dispose(){$removeHandler(window,"focus",
Object(C.a)(this,this.p1g,"onPlatformFocusHandler"));$removeHandler(window,"blur",Object(C.a)(this,this.$9c,"onPlatformBlurHandler"));$removeHandler(document,"freeze",Object(C.a)(this,this.q1g,"onPlatformFreezeHandler"));$removeHandler(document,"visibilitychange",Object(C.a)(this,this.r1g,"onPlatformVisibilityChangeHandler"))}dQf(){this.uNa&&(this.Rd.Ng(this.uNa),this.uNa=null)}HTf(){this.uNa=new xe.a(4,1,this.U0e,Object(C.a)(this,this.psj,"handleVisibilityUpdate"),157);this.Rd.Cb(this.uNa)}psj(){this.uNa=
null;this.YJb("TaskItem",this.r4d())}t_j(a){Z.ULS.sendTraceTag(557977793,324,50,"Time to execute task with Priority {0}:{1} Emergency View State: {2}",a.cEg,+new Date-+this.Dzf,sz.SessionStatusManager.instance.gja)}l_k(){this.Dzf=new Date;this.Rd.Cb(this.RXb(0,"Realtime"));this.Rd.Cb(this.RXb(1,"AboveNormal"));this.Rd.Cb(this.RXb(2,"Normal"));this.Rd.Cb(this.RXb(3,"Background"));this.Rd.Cb(this.RXb(4,"Low"))}RXb(a,b){return new xe.a(a,1,0,Object(C.a)(this,this.t_j,"logTimeToExecuteTask"),0,b)}}Object(e.a)(DC,
"VisibilityManager",null,[407,106]);class UP{VDg(){}}Object(e.a)(UP,"NullVisibilityManagerTelemetry",null,[404]);class tz{constructor(){this.Pa=new ic.a}VDg(a){Z.ULS.sendTraceTag(590901976,324,50,a.toString())}static create(){return new tz}}Object(e.a)(tz,"VisibilityManagerTelemetry",null,[404]);class EC{constructor(){this.Da=null}get name(){return"Common.App.VisibilityManager"}init(){this.Da.resolve("Common.App.VisibilityManagement.IVisibilityManager")}dispose(){const a=this.Da.qb("Common.App.VisibilityManagement.VisibilityManager");
a&&a.dispose()}Wb(a){this.Da=a;this.Da.register(tz,"Common.App.VisibilityManagement.VisibilityManagerTelemetry").as("Common.App.VisibilityManagement.IVisibilityManagerTelemetry").na(()=>tz.create()).ma();this.Da.register(DC,"Common.App.VisibilityManagement.VisibilityManager").as("Common.App.VisibilityManagement.IVisibilityManager").na(()=>new DC(u.AFrameworkApplication.pe,()=>window.document.visibilityState,6E4*u.AFrameworkApplication.fa.Cc("VisibilityManagerDelayTransitionToHiddenInMin",1),this.Da.resolve("Common.App.VisibilityManagement.VisibilityManagerTelemetry"))).ma()}static main(){m.a.instance.Bc(new EC)}}
Object(e.a)(EC,"VisibilityManagerPackage",null,[2,3]);var VP=d(1184);class UI{constructor(a,b){this.NZc=new ef.a;this.QZc=new ef.a;this.IAb=b;this.cUa=a}zp(a){!a||this.NZc.Jb(a.id)||this.QZc.Jb(a.id)||this.cUa.zp(a)}rdh(a){this.YMk(a)}sdh(a){this.$Mk(a)}YMk(a){var b=null;this.IAb&&a&&(this.zp(a),b=b||Object(C.a)(this,this.nxe,"onDragOver"),this.NZc.$(a.id,b),this.cUa.ob(ma.a.drop,a,b))}$Mk(a){var b=null;this.IAb&&a&&(this.zp(a),b=b||Object(C.a)(this,this.oxe,"onDrop"),this.QZc.$(a.id,b),this.cUa.ob(ma.a.C5a,
a,b))}xb(a){this.IAb&&a&&(this.cUa.Oq(a),this.NZc.ga(a.id)&&this.cUa.xb(ma.a.C5a,a,this.NZc.ga(a.id)),this.QZc.ga(a.id)&&this.cUa.xb(ma.a.drop,a,this.QZc.ga(a.id)))}Bvj(){this.cUa&&this.cUa.dispose()}oxe(a){a=a.mc;a.preventDefault();a.stopPropagation();return!0}nxe(a){a=a.mc;a.preventDefault();a.stopPropagation();return!0}}Object(e.a)(UI,"PPTDragDropInputHelper",null,[338]);class FC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.DragDrop"}Wb(a){if(!a)throw Error.argumentNull("container");
this.K=a;this.K.register(338,"PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").ma().na(()=>new UI(VP.a.instance,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointDragInsertImageIsEnabled))}init(){const a=this.K.resolve("PowerPointWebEditor.AppFrame").TJd;a?(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").rdh(a),this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").sdh(a)):(this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").rdh(this.K.resolve("PowerPointWebEditor.AppFrame").c1),
this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").sdh(this.K.resolve("PowerPointWebEditor.AppFrame").c1))}dispose(){this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").xb(this.K.resolve("PowerPointWebEditor.AppFrame").TJd);this.K.resolve("PowerPointWebEditor.DragDrop.IPPTDragDropInputHelper").Bvj()}static main(){m.a.instance.Bc(new FC)}}Object(e.a)(FC,"PPTWebEditorDragDropPackage",null,[2,3]);class VI{constructor(a){this.LUh=a}TMe(){return Math.random()<this.LUh}}
Object(e.a)(VI,"RandomSampler",null,[1500]);class WI{constructor(a){this.YNb=null;this.sXh=a}jUb(a,b){if("ForceSample"===b||this.sXh())this.YNb||(this.YNb=[]),Array.add(this.YNb,a)}getData(){return this.YNb}reset(){this.YNb=null}}Object(e.a)(WI,"SampleDataAggregator",null,[1496]);var XI=d(526);class YI{constructor(){this.metadata=null;this.duration=this.ths=this.timeStamp=0;this.isCoauth=null}}Object(e.a)(YI,"PPTEventTimingData",null,[]);class yq{constructor(){this.tqe=!1;this.d9={};this.m9j=a=>{window.requestAnimationFrame(a)};
this.Kyb=[];this.d9.ArrowDown=!0;this.d9.ArrowLeft=!0;this.d9.ArrowRight=!0;this.d9.ArrowUp=!0;this.d9.Backspace=!0;this.d9.Delete=!0;this.d9.End=!0;this.d9.Enter=!0;this.d9.Home=!0;this.d9.PageDown=!0;this.d9.PageUp=!0;this.d9.Tab=!0}Rlc(a){return a.ctrlKey&&"Control"!==a.key||a.altKey&&"Alt"!==a.key||a.key in this.d9}Hgi(a){const b={};b.key=this.Rlc(a)?a.key:" "===a.key?"Space":"Char";b.alt=(void 0===a.altKey||null===a.altKey?!1:a.altKey).toString();b.ctrl=a.ctrlKey.toString();b.shift=a.shiftKey.toString();
return b}fvh(a){const b=new YI;b.metadata=this.Hgi(a);b.ths=window.performance.now()-a.timeStamp;b.timeStamp=a.timeStamp;b.isCoauth=yq.COa?(!yq.COa.amIAlone).toString():"null";this.Kyb.push(b);this.mOk()}wvh(a){if(this.Kyb.length)for(const b of this.Kyb)if(b.timeStamp===a.timeStamp){b.duration=window.performance.now()-a.timeStamp-b.ths;break}}mOk(){this.tqe||(this.m9j(()=>{this.tqe=!1;window.dispatchEvent(XI.a.instance.create(ma.a.uJd,this.Kyb.slice(0,this.Kyb.length)));this.Kyb=[]}),this.tqe=!0)}keyPressedEventHandlerStart(a){yq.PTc(a)&&
!this.Rlc(a)&&this.fvh(a)}keyPressedEventHandlerEnd(a){yq.PTc(a)&&!this.Rlc(a)&&this.wvh(a)}keyDownEventHandlerStart(a){yq.PTc(a)&&this.Rlc(a)&&this.fvh(a)}keyDownEventHandlerEnd(a){yq.PTc(a)&&this.Rlc(a)&&this.wvh(a)}static get COa(){return yq.OQf||(yq.OQf=fb.a.instance.qb("PowerPointWebEditor.ICoauthStateGetter"))}static PTc(a){return!!a&&a.timeStamp<window.performance.now()}}yq.OQf=null;Object(e.a)(yq,"PPTEventTimingMeter",null,[336]);class Or{constructor(){this.J9b=[];this.dAb=this.E1c=this.VFa=
this.O3c=null;this.N3c=0;this.m1c=!1}start(a){if(!this.m1c){Array.clear(this.J9b);for(let b=0;b<Or.Y_b.length;++b)this.J9b.push(0);this.O3c=window.setInterval(Object(C.a)(this,this.Lgh,"reportMeasuredFrames"),1E3*a);this.N3c=window.performance.now();this.rVe(null);$addHandler(window,"visibilitychange",Object(C.a)(this,this.rVe,"updateMeasureCurrentFrameLoop"));this.m1c=!0}}stop(){this.m1c&&($removeHandler(window,"visibilitychange",Object(C.a)(this,this.rVe,"updateMeasureCurrentFrameLoop")),null!=
this.O3c&&(window.clearInterval(this.O3c),this.O3c=null),null!=this.VFa&&(window.cancelAnimationFrame(this.VFa),this.VFa=null),this.Lgh(),this.m1c=!1)}Lgh(){if(null!=this.dAb){var a={};for(var b=0;b<Or.Y_b.length;++b)a[Or.Y_b[b].toString()]=this.J9b[b],this.J9b[b]=0;b=window.performance.now();var c={};c.intervalStart=this.N3c;c.duration=b-this.N3c;c.maxFrameLengthMs=this.dAb;c.frameData=a;window.dispatchEvent(XI.a.instance.create(ma.a.$Ge,c));this.dAb=null;this.N3c=b}}rVe(){Or.yMj&&null==this.VFa?
(this.E1c=null,this.VFa=window.requestAnimationFrame(Object(C.a)(this,this.NUg,"measureCurrentFrame"))):null!=this.VFa&&(window.cancelAnimationFrame(this.VFa),this.VFa=null)}NUg(a){if(null!=this.E1c){const b=a-this.E1c;if(null==this.dAb||this.dAb<b)this.dAb=b;for(let c=0;c<Or.Y_b.length;++c)if(b<Or.Y_b[c]){++this.J9b[c];break}}this.E1c=a;this.VFa=window.requestAnimationFrame(Object(C.a)(this,this.NUg,"measureCurrentFrame"))}static get yMj(){return"visible"===window.document.visibilityState}}Or.Y_b=
[17,34,42,67,100,200,400,800,1E3,1500,2E3,3E3,Number.POSITIVE_INFINITY];Object(e.a)(Or,"PPTFrameTimingMeter",null,[337]);class GC{constructor(){this.Fbc=this.L7b=null;this.aLg=this.UKg=!1}Wb(a){window.performance&&window.performance.now&&window.requestAnimationFrame&&(u.AFrameworkApplication.fa.ka("PodEventTimingMeterIsEnabled")&&!r.a.Aj&&(a.register(336,"Common.IEventTimingMeter").ma().na(()=>new yq),this.UKg=!0),a.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterIsEnabled&&
(a.register(337,"Common.IFrameTimingMeter").ma().na(()=>new Or),this.aLg=!0))}get name(){return"PowerPointWebEditor.EventTimingMeter"}init(){if(this.UKg){var a=new VI(u.AFrameworkApplication.fa.Cc("PodEventTimingMeterEventSamplingPercent",0)/100);a=new WI(Object(C.a)(a,a.TMe,"shouldBeInSample"));const b=ro.a.TV(16,1,a);this.L7b=c=>{if(c&&(c=c.rawEvent.detail))for(const f of c)b.track(f,"EventTimingData")};Ed.a.addHandler(window.self,ma.a.uJd,this.L7b)}this.aLg&&(this.Fbc=b=>{b&&(b=b.rawEvent)&&Aa.a.J(39706653,
306,50,Yd.c(b.detail))},Ed.a.addHandler(window.self,ma.a.$Ge,this.Fbc))}dispose(){this.L7b&&(Ed.a.removeHandler(window.self,ma.a.uJd,this.L7b),this.L7b=null);this.Fbc&&(Ed.a.removeHandler(window.self,ma.a.$Ge,this.Fbc),this.Fbc=null)}static main(){m.a.instance.Bc(new GC)}}Object(e.a)(GC,"PPTEventTimingMeterPackage",null,[2,3]);var HC=d(445);class ZI{constructor(a){this.jgf=new ef.a(null);this.PNh=a}ga(a){let b;({value:b}=this.jgf.Rf(a)).returnValue||(b=this.PNh(a),this.jgf.$(a,b));return b}}Object(e.a)(ZI,
"MemoizedLookup",null,[1530]);var WP=d(823),XP=d(696);class IC{constructor(a){this.Xvk=0;this.lO=a}}Object(e.a)(IC,"GraphMergerResponse",null,[]);var YP=d(314);class JC extends ff.a{constructor(){super();this.YourRevisions=this.TheirRevisions=this.MergedRevision=this.BaseRevisions=null;this.IgnoreConflictsInLastServerRevision=!1;this.MergeHint=0;this.RequestId=this.ObjectSpaceId=null;this.Reason=this.Source=0}Ok(){return 33}static construct(a,b,c,f,l,x,G,R,fa){const wa=new JC;wa.BaseRevisions=a;wa.TheirRevisions=
b;wa.YourRevisions=c;wa.IgnoreConflictsInLastServerRevision=f;wa.MergeHint=l;wa.ObjectSpaceId=x?Zd.a(x):null;wa.RequestId=G?Zd.a(G):null;wa.Source=R;wa.Reason=fa;return wa}}Object(e.a)(JC,"CreateGraphMergeReplayRequest",ff.a,[]);d(816);class uz{Sa(a){return a.Sa(void 0)}Deg(a,b){return a.sa(b,null)}FOc(a,b){a=(a=a.sa(b,null))?Array.clone(a):[];return new Si.a(a)}Geg(a,b){return a.sa(b,"")}Znh(a,b,c){a.setValue(b,c)}}Object(e.a)(uz,"MergeableObjectUtilities",null,[390]);class ZP{constructor(a,b=null,
c=null){this.jzd=b||new uz;c||Object(C.a)(this,this.bKi,"doParagraphMergeNoOP")}bKi(a,b){return{uGl:a,tGl:b}}}Object(e.a)(ZP,"GraphMergeSelectionRecordUpdater",null,[]);class $I{constructor(){this.source=0;this.Cu=this.jLb=this.YJa=null;this.wdc=0;this.zRc=!1;this.SPe=0}}Object(e.a)($I,"InputState",null,[]);class aJ{constructor(){this.timeout=this.succeeded=this.crash=!1;this.lO=null}}Object(e.a)(aJ,"OutputState",null,[]);class bJ{constructor(){this.RLc=this.ljd=this.amc=!1;this.BZa=this.$tl=this.bSi=
this.nue=this.ZBh=this.v4f=this.SJf=this.BFc=null}}Object(e.a)(bJ,"RuntimeState",null,[]);class cJ{constructor(){this.input=new $I;this.runtime=new bJ;this.output=new aJ}}Object(e.a)(cJ,"MergeState",null,[]);var $c=d(1067);class ux{constructor(a,b,c){this.cVh=a;this.vTh=b;this.dTh=c;this.twd=new Sa.a(Object(C.a)(this,this.lni,"checkIfDifferent"))}get bFb(){return this.cVh}get oldValue(){return this.vTh}get newValue(){return this.dTh}get Y7(){return!!this.newValue&&!this.oldValue}get isDeleted(){return!this.newValue&&
!!this.oldValue}get P8a(){return this.Y7||this.isDeleted||this.twd.value}lni(){return this.Y7||this.isDeleted?!0:!$c.a.LIf(this.bFb,this.oldValue,this.newValue)}}Object(e.a)(ux,"PropertyDiff",null,[]);class vx{constructor(a,b){this.sTh=a;this.aTh=b;this.twd=new Sa.a(()=>this.DTc(null));this.eVh=new Sa.a(Object(C.a)(this,this.jPi,"evaluatePropertyDiffs"))}get iDb(){return this.sTh}get H4(){return this.aTh}get Y7(){return!!this.H4&&!this.iDb}get isDeleted(){return!this.H4&&!!this.iDb}get P8a(){return this.Y7||
this.isDeleted||this.twd.value}get lXa(){return this.eVh.value}DTc(a){let b=!1;this.lXa.forEach((c,f)=>{b=f.P8a&&(!a||7!==a.ga(c));return!b});return b}jPi(){const a=new ef.a;var b=this.H4,c=this.iDb;if(this.Y7){c=b.Mz();for(var f=0;f<c.length;f++){var l=c[f];a.$($c.a.rb(l),new ux(l,null,b.bsa(l)))}}else if(this.isDeleted)for(b=c.Mz(),f=0;f<b.length;f++)l=b[f],a.$($c.a.rb(l),new ux(l,c.bsa(l),null));else{f=c.Mz();for(l=0;l<f.length;l++){var x=f[l];a.$($c.a.rb(x),new ux(x,c.bsa(x),b.Sa(x)?b.bsa(x):
null))}f=b.Mz();for(l=0;l<f.length;l++)x=f[l],c.Sa(x)||a.$($c.a.rb(x),new ux(x,null,b.bsa(x)))}return a}}Object(e.a)(vx,"MergeableObjectDiff",null,[]);class wx{constructor(a,b){this.D4=b?a.z4a():a;this.Lzc=new qa.a}q8k(a){this.Lzc=a}aVg(a){(new vx(this.D4,a)).lXa.forEach((b,c)=>{c.P8a&&!this.Lzc.contains(b)&&(this.Lzc.add(b),c.isDeleted?(c=this.D4,c.Sa($c.a.Lra(b))&&c.removeProperty($c.a.Lra(b))):this.D4.aJa($c.a.Lra(b),c.newValue));return!0})}}Object(e.a)(wx,"PartialMergeResult",null,[]);class dJ extends ff.a{constructor(){super();
this.Location=null}Ok(){return 34}static construct(a){const b=new dJ;b.Location=a;return b}}Object(e.a)(dJ,"PlayGraphMergeReplayRequest",ff.a,[]);class Dv{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){this.mge=new WP.a;this.S9j=a;this.l7j=b;this.$Ua=c(this.a1b());this.M3j=f;this.N3j=l;this.Z3c=x;this.j2c=G;this.eJg=R;this.J3j=Wa;this.K3j=fa;this.L3j=wa}IK(){return(new Date).getTime()}Qhb(a,...b){return String.format.apply(null,[a].concat(b))}Znl(a){throw Rl.a.invalidOperation(a);}g5i(a){return String.format("Name: {0}, Message: {1}, Stack: {2}",
a.name,a.message,a.stack)}fpj(a,b,c,f){f.$(a,new wx(b,!1));Z.ULS.sendTraceTag(19019783,808,50,"Merging Object: [Id: {0}] [ClassId: {1}]. Object wasn't in base revision, but was in conflict and favored.",a,c.Oe);return!0}eyl(a,b){const c=new Gn.a;c.id=xn.a.Uea;c.aJa(sb.a.Mfd,5===b?2:4);a.aEf(c);a.amd().bxa(c.id,4)}M0k(a){var b=!a.output.succeeded&&(this.K3j||a.output.crash),c=!!a.input.YJa&&0<a.input.YJa.length;if(c=this.L3j&&c&&(this.J3j||b)){b=c?Ga.a.create():Ga.a.nil;c=c?String.format(" [Merge Request Id: {0}]",
b):"";Dv.hZj(a,c);var f,l;({Adi:x,Tnl:f,TDl:l}=this.FCi(a,Object(C.a)(this,this.qVf,"createSerializedRevisionFrom")));c=Dv.o6i(a);b=JC.construct(x._list,f._list,l._list,a.input.zRc,a.input.wdc,a.input.Cu,b,a.input.source,c);var x=a.output.lO;3===c&&0<x.length&&(b.MergedRevision=this.qVf(a.output.lO.last()));a=new YP.a;a.oH=b;a.status=1;b=this.mge.n0b(0,null);b.aZ(a);b.GBa()}}qVf(a){const b=a.BV,c=Cb.App.Hb.Hd.Ci;return new XP.a(a,b,c.vi,null,c.ijc,c.contextId,b?b.id:Ga.a.nil,this.Z3c,!1,!0)}Z6c(a,
b,c,f,l,x,G){c=this.PAi(a,b,f,l,x,G);f=0;const R=c.runtime.ljd;try{if(R){const fa=a.length?a.getItemAt(a.length-1):null,wa=b.length?b.getItemAt(b.length-1):null;Z.ULS.sendTraceTag(18641173,808,50,"MergeChanges: Begin.  [TheirChanges - Length:{0} Last:{1} Base:{2}] [YourChanges - Length:{3} Last:{4} Base:{5}] [MergeHint: {6}] [IgnoreConflictsInLastServerRevision: {7}] [MaxMergeTimeInMs: {8}] [FullPropertyLoggingIsEnabled: {9}] [Source: {10}]",a.length,fa?fa.id:Ga.a.nil,fa?fa.BV?fa.BV.id:Ga.a.nil:Ga.a.nil,
b.length,wa?wa.id:Ga.a.nil,wa?wa.BV?wa.BV.id:Ga.a.nil:Ga.a.nil,l,x,this.j2c,this.eJg,G)}for(a=!0;f<this.$Ua.length&&a;f++)a=(0,this.$Ua[f])(c);return new IC(c.output.lO)}catch(fa){const wa=!c.output.timeout;c.output.crash=wa;const Wa=String.format("Merge {0}!  Failing the merge.  [{1}] [Will continue: {2}]",wa?"Crashed":"Timed Out",this.g5i(fa),!!c.output.lO);wa?Z.ULS.sendTraceTag(18613134,808,10,"MergeChanges Crash. [Error: {0}]",Wa):Z.ULS.sendTraceTag(18613136,808,15,"MergeChanges Timeout. [Error: {0}]",
Wa);if(c.output.lO)return new IC(c.output.lO);throw fa;}finally{c.output.succeeded?R&&Z.ULS.sendTraceTag(18613138,808,50,this.K0b(c,f,"Succeeded")):c.output.timeout?Z.ULS.sendTraceTag(18641178,808,15,this.K0b(c,f,"Timeout")):c.output.crash?c.output.lO?Z.ULS.sendTraceTag(18613142,808,15,this.K0b(c,f,"Crash - Rejection")):Z.ULS.sendTraceTag(18613144,808,15,this.K0b(c,f,"Crash - Failed")):R&&Z.ULS.sendTraceTag(18613140,808,50,this.K0b(c,f,"Rejection")),this.M0k(c)}}K0b(a,b,c){const f=a.output.lO,l=f&&
f.length?f.getItemAt(f.length-1):null;return this.Qhb("MergeChanges: End. {0}. [ElapsedTime: {1}ms] [Function: {2}] [MergedRevisions - Length:{3} Last:{4} Base:{5}] [Source: {6}]",c,this.IK()-a.input.SPe,b,f?f.length:0,l?l.id:Ga.a.nil,l?l.BV?l.BV.id:Ga.a.nil:Ga.a.nil,a.input.source)}PAi(a,b,c,f,l,x){const G=new cJ,R=G.input;R.YJa=a;R.jLb=b;R.Cu=c;R.wdc=f;R.zRc=l;R.SPe=this.IK();R.source=x;a=G.runtime;a.RLc=this.eJg;a.amc=!0;a.ljd=!0;let fa="";a.BZa=wa=>{if(this.j2c){var Wa=this.IK()-R.SPe,mb=Wa>this.j2c;
fa+=this.Qhb(" ({0}: {1})",wa,Wa);mb&&(G.output.timeout=!0,wa=this.Qhb("Exceeded [MaxMergeTimeInMs: {0}] when we reached [Details: {1}] [Elapsed Time: {2}] [Timeline:{3}]",this.j2c,wa,Wa,fa),this.Znl(wa))}};return G}a1b(){return[Object(C.a)(this,this.ntk,"otherAuthorsHaveChangesToMerge"),Object(C.a)(this,this.ZJj,"isInputValid"),Object(C.a)(this,this.kAj,"initializeOutputMergeState"),Object(C.a)(this,this.EAj,"initializeRuntimeMergeState"),Object(C.a)(this,this.Bsl,"tryObjectMerge"),Object(C.a)(this,
this.D2h,"addMergeResultsToOutput")]}ntk(a){const b=a.input.YJa;a=a.output;return b?b.length?!0:(Z.ULS.sendTraceTag(18613150,808,100,"OtherAuthorsHaveChangesToMerge: Received an empty list of changes to merge."),a.lO=b,a.succeeded=!0,!1):(Z.ULS.sendTraceTag(18613148,808,100,"OtherAuthorsHaveChangesToMerge: Didn't receive any changes to merge."),a.lO=b,a.succeeded=!0,!1)}ZJj(a){var b=a.input;const c=b.YJa,f=b.jLb,l=b.Cu,x=b.wdc;b=b.zRc;a=a.output;if(!f||!f.length)return a.lO=c,!1;let G=!0;if(2!==x&&
1!==x)return a.lO=c,!1;l&&l!==Ga.a.nil||(G=!1);c.length<(b?2:1)&&(Z.ULS.sendTraceTag(18613155,808,100,"OtherAuthorsHaveChangesToMerge: Too few revisions. This will happen if the server failed its merge and rejected your change.  [ignoreConflictsInLastServerRevision: {0}]",b),G=!1);G||(a.lO=2===x?c:f);return G}EAj(a){var b=a.input,c=b.YJa,f=b.jLb;const l=b.wdc;let x,G;({Snl:x,SDl:G,BFc:b}=this.i8i(a,c,f,b.zRc));if(!b)return Z.ULS.sendTraceTag(18613185,808,15,"MergeChanges: Couldn't find a common base change. [TheirLastChange.Id: {0}] [YourLastChange.Id: {1}]",
x.id,G.id),this.JDg(x,c.length,"TheirChanges"),this.JDg(G,f.length,"YourChanges"),a.output.lO=2===l?c:f,!1;a.runtime.BFc=b;({Ytl:c,$Ri:f}=this.UHi(l,x,G));({Ztl:b,aSi:c,Bdi:f}=Dv.S9i(a,c,f,b));a.runtime.SJf=f;a.runtime.ZBh=b;a.runtime.v4f=c;a.runtime.nue=new ef.a;return!0}JDg(a,b,c){const f=new Si.a;for(;a;)f.add(a),a=a.BV;const l=new Sys.StringBuilder;l.append(this.Qhb("{0} [PartialChainLength: {1}] [FullChainLength: {2}]",c,b,f.length));let x=f.length,G=0;f.forEach(R=>({Zmg:x,bEg:G}=this.F3h(l,
R,f,x,G)).returnValue);Z.ULS.sendTraceTag(18613187,808,50,l.toString())}F3h(a,b,c,f,l){a.append(this.Qhb(" [{0} {1} {2}]",f,b.Pja?"S":"B",b.id));f--;l++;return 50<l&&c.length!==l?(a.append(" ...Truncated."),{returnValue:!1,Zmg:f,bEg:l}):{returnValue:!0,Zmg:f,bEg:l}}i8i(a,b,c,f){b=b.getItemAt(b.length-1-(f?1:0));c=c.getItemAt(c.length-1);f=b.MMc(c);a.runtime.BZa("GetCommonBase");return{Snl:b,SDl:c,BFc:f}}UHi(a,b,c){2===a?(a=b,b=c):a=c;return{Ytl:b,$Ri:a}}kAj(a){const b=a.input,c=b.YJa,f=b.jLb;a.output.lO=
(2===b.wdc?c:f).D9k();a.runtime.BZa("InitializeOutputMergeState");return!0}D2h(a){var b=a.input.Cu;const c=a.runtime.nue,f=a.output.lO;b=this.QAi(a,f.getItemAt(f.length-1),b,Ga.a.create());this.VSi(a,b,c);this.eyl(b,a.input.source);f.add(b);return a.output.succeeded=!0}QAi(a,b,c,f){a.runtime.ljd&&Z.ULS.sendTraceTag(18613189,808,50,"AddMergeRevisionToList: Creating mergeRevision with [objectSpaceId: {0}] [revisionId: {1}].",c,f);a=this.S9j(f);a.Pdi(b,c);return a}VSi(a,b,c){a.runtime.ljd&&Z.ULS.sendTraceTag(18613191,
808,50,"FillRevision: Adding {0} objects to merged revision.",c.count);c.forEach((f,l)=>{xn.a.Uea.equals(f)||b.aEf(l.D4);return!0})}Bsl(a){const b=a.runtime,c=b.SJf,f=b.ZBh,l=b.v4f,x=b.nue;let G=!0;const R=a.runtime.amc;let fa=0,wa=0,Wa=0;f.forEach((mb,Kb)=>{R&&Z.ULS.sendTraceTag(18613193,808,100,"Merging Object: [Id: {0}] [ClassId: {1}]",mb,Kb.Oe);wa++;50===wa&&(fa++,a.runtime.BZa(this.Qhb("ObjectMerge [Cycles: {0}] [ComplexMerges: {1}]",fa,Wa)),wa=0);if(Dv.$fl(Kb.Oe))return!0;var nc=l.get(mb);if(!nc)return x.Jb(mb)?
x.ga(mb).aVg(Kb):x.$(mb,new wx(Kb,!1)),!0;if(!c.ga(mb))return G=this.fpj(mb,nc,Kb,x);const oc=x.oOc(mb,new wx(c.ga(mb),!0));({R9:nc,returnValue:G}=this.N3j.merge(a,this.M3j,this.l7j,oc,nc,Kb));Wa++;G&&(a.runtime.BZa(this.Qhb("ObjectMerge [Id: {0}] [ClassId: {1}] [ComplexMerges: {2}] [Cycles: {3}]",mb,Kb.Oe,Wa,fa)),nc&&(x.Jb(nc.D4.id)?x.ga(nc.D4.id).aVg(nc.D4):x.$(nc.D4.id,nc)));return G});R&&Z.ULS.sendTraceTag(18613199,808,100,"TryObjectMerge: Merged {0} objects. {1} were complex merges.",f.count,
Wa);return G}FCi(a,b){const c=new Si.a,f=new Si.a,l=new Si.a;var x=a.runtime.BFc;const G=x?x.id:Ga.a.nil;this.kee(x).forEach(R=>{c.add(b(R));return!0});x=a.input.YJa.getItemAt(a.input.YJa.length-1);this.kee(x,G).forEach(R=>{f.add(b(R));return!0});a=a.input.jLb.getItemAt(a.input.jLb.length-1);this.kee(a,G).forEach(R=>{l.add(b(R));return!0});return{Adi:c,Tnl:f,TDl:l}}kee(a,b=null){const c=new Si.a;b||(b=Ga.a.nil);for(;a&&!b.equals(a.id);)c.add(a),a=a.BV;c.reverse();return c}ub(){}get delayedMergeOperation(){return null}set delayedMergeOperation(a){}static hZj(a,
b){Z.ULS.sendTraceTag(18613146,808,50,"Sending merge backup. [Crash: {0}] [Timeout: {1}] {2}",a.output.crash,a.output.timeout,b)}static o6i(a){return a.output.crash?2:a.output.succeeded?3:1}static S9i(a,b,c,f){let l;({result:l}=b.a7c(f));a.runtime.BZa("GetUnfavoredChanges");let x;new ef.a;({result:x}=c.a7c(f));5===a.input.source&&(a.runtime.bSi=HC.a.Peg(c.amd()),a.runtime.$tl=HC.a.Peg(b.amd()));b=x;a.runtime.BZa("GetFavoredChanges");f=new ZI(Object(C.a)(f,f.Ctb,"getMergeableObject"));a.runtime.BZa("GetModifiedObjects");
return{Ztl:l,aSi:b,Bdi:f}}static $fl(a){switch(a){case 1074135137:case 1074135138:case 1074135140:return!0}return!1}}Object(e.a)(Dv,"GraphMerger",null,[393,335]);class eJ{get yBa(){return 8}get kIa(){return[]}get EKa(){return[$c.a.rb(sb.a.dM),$c.a.rb(sb.a.tnc)]}get vKa(){return[]}get yOa(){return[$c.a.rb(tb.a.BA)]}get gPa(){return[]}PF(a){return 1074135126===a.Oe}KZa(){return!0}get xBa(){return[$c.a.rb(sb.a.cid),$c.a.rb(sb.a.sid)]}get UYa(){return!0}}Object(e.a)(eJ,"CommentContentNodeComplexMerge",
null,[391]);class fJ{get yBa(){return 8}get kIa(){return[]}get EKa(){return[$c.a.rb(sb.a.tqb),$c.a.rb(sb.a.rPd),$c.a.rb(sb.a.rqb),$c.a.rb(sb.a.LWb),$c.a.rb(sb.a.JBe),$c.a.rb(sb.a.IBe),$c.a.rb(sb.a.dM),$c.a.rb(sb.a.tnc),$c.a.rb(sb.a.GOd)]}get vKa(){return[$c.a.rb(sb.a.qba),$c.a.rb(sb.a.Gqa),$c.a.rb(sb.a.hPd),$c.a.rb(sb.a.MWb),$c.a.rb(sb.a.tFc)]}get yOa(){return[]}get gPa(){return[]}PF(a){return 1074135127===a.Oe}KZa(){return!0}get xBa(){return[$c.a.rb(sb.a.cid),$c.a.rb(sb.a.sid),$c.a.rb(sb.a.commentId),
$c.a.rb(sb.a.ewa),$c.a.rb(Mb.a.iPd),$c.a.rb(sb.a.jPd),$c.a.rb(sb.a.MWb),$c.a.rb(sb.a.tFc)]}get UYa(){return!0}}Object(e.a)(fJ,"CommentNodeComplexMerge",null,[391]);class gJ{constructor(a){this.H4c=a}get yBa(){return 8}get kIa(){return[]}get EKa(){return this.H4c.EKa}get vKa(){return[]}get yOa(){return[$c.a.rb(tb.a.BA)]}get gPa(){return[]}PF(a){return 393326===a.Oe}KZa(){return!0}get xBa(){const a=new Ha.a;Vq.a(a,this.H4c.kIa);Vq.a(a,this.H4c.xBa);Vq.a(a,this.H4c.vKa);Vq.a(a,[$c.a.rb(sb.a.owb),$c.a.rb(sb.a.c8c)]);
return a.toArray()}get UYa(){return!0}}Object(e.a)(gJ,"NotesContentNodeComplexMerge",null,[391]);class hJ{get yBa(){return 8}get kIa(){return[$c.a.rb(sb.a.rKi),$c.a.rb(sb.a.lKi),$c.a.rb(sb.a.N3b),$c.a.rb(sb.a.m$k)]}get EKa(){return[$c.a.rb(sb.a.sob),$c.a.rb(sb.a.tob),$c.a.rb(sb.a.Fob),$c.a.rb(sb.a.Gob),$c.a.rb(sb.a.DBa),$c.a.rb(sb.a.ave),$c.a.rb(sb.a.Gue),$c.a.rb(sb.a.bve),$c.a.rb(sb.a.WFb),$c.a.rb(sb.a.ZFb),$c.a.rb(sb.a.Xub),$c.a.rb(sb.a.krb),$c.a.rb(sb.a.sEb)]}get vKa(){return[]}get yOa(){return[$c.a.rb(tb.a.M4a),
$c.a.rb(Mb.a.appsNode)]}get gPa(){return[]}PF(a){return 393271===a.Oe}get xBa(){return[$c.a.rb(sb.a.presentationId),$c.a.rb(sb.a.slideWidth),$c.a.rb(sb.a.slideHeight),$c.a.rb(sb.a.RX),$c.a.rb(sb.a.l$),$c.a.rb(sb.a.X7a),$c.a.rb(sb.a.kCb),$c.a.rb(sb.a.P9),$c.a.rb(sb.a.aDb),$c.a.rb(sb.a.hea),$c.a.rb(sb.a.embeddedFonts),$c.a.rb(sb.a.ZHa)]}get UYa(){return!0}KZa(){return!0}}Object(e.a)(hJ,"PresentationNodeComplexMerge",null,[391]);class iJ{get yBa(){return 8}get kIa(){return[$c.a.rb(sb.a.jIa),$c.a.rb(sb.a.rGb)]}get EKa(){return[$c.a.rb(tb.a.font),
$c.a.rb(sb.a.JA),$c.a.rb(sb.a.cEc),$c.a.rb(sb.a.Aeb),$c.a.rb(sb.a.dM),$c.a.rb(sb.a.fZa),$c.a.rb(sb.a.$m),$c.a.rb(sb.a.cXa),$c.a.rb(sb.a.Zub),$c.a.rb(sb.a.kja),$c.a.rb(sb.a.WYa),$c.a.rb(sb.a.s0),$c.a.rb(sb.a.Vna),$c.a.rb(sb.a.IYb),$c.a.rb(sb.a.zsb),$c.a.rb(sb.a.DIa),$c.a.rb(sb.a.vxa),$c.a.rb(sb.a.xna),$c.a.rb(sb.a.uxa),$c.a.rb(sb.a.mediaType),$c.a.rb(sb.a.Aeb),$c.a.rb(sb.a.axb),$c.a.rb(sb.a.s4g),$c.a.rb(sb.a.u4g),$c.a.rb(sb.a.ghb),$c.a.rb(sb.a.NYa),$c.a.rb(sb.a.Iph),$c.a.rb(sb.a.Nid),$c.a.rb(tb.a.xl),
$c.a.rb(tb.a.EI),$c.a.rb(sb.a.Uxh),$c.a.rb(sb.a.Vxh),$c.a.rb(sb.a.xJb),$c.a.rb(sb.a.TJa),$c.a.rb(sb.a.H$),$c.a.rb(sb.a.Gnc),$c.a.rb(sb.a.SDb),$c.a.rb(sb.a.outlineWidth),$c.a.rb(Cc.a.sgd),$c.a.rb(sb.a.ecd),$c.a.rb(Sl.a.A4b),$c.a.rb(sb.a.QM),$c.a.rb(sb.a.xP),$c.a.rb(sb.a.tnc),$c.a.rb(sb.a.GIb),$c.a.rb(sb.a.YYa),$c.a.rb(sb.a.$pb),$c.a.rb(sb.a.hxb),$c.a.rb(sb.a.LM),$c.a.rb(sb.a.Yth),$c.a.rb(sb.a.$ub)]}get vKa(){return[$c.a.rb(sb.a.alt),$c.a.rb(sb.a.altTitle),$c.a.rb(sb.a.W9),$c.a.rb(sb.a.isHorizontallyFlipped),
$c.a.rb(sb.a.isVerticallyFlipped),$c.a.rb(sb.a.rja),$c.a.rb(sb.a.shapeType),$c.a.rb(sb.a.yJb),$c.a.rb(sb.a.rotation),$c.a.rb(sb.a.jkc),$c.a.rb(sb.a.Lba),$c.a.rb(sb.a.Kba),$c.a.rb(tb.a.Rx),$c.a.rb(tb.a.KD),$c.a.rb(tb.a.fz),$c.a.rb(tb.a.gz),$c.a.rb(sb.a.widthPersisted),$c.a.rb(sb.a.heightPersisted),$c.a.rb(sb.a.xPersisted),$c.a.rb(sb.a.yPersisted),$c.a.rb(sb.a.Z1),$c.a.rb(sb.a.iR),$c.a.rb(sb.a.Eha),$c.a.rb(sb.a.Dha),$c.a.rb(sb.a.Gha),$c.a.rb(sb.a.Fha),$c.a.rb(sb.a.ePe),$c.a.rb(sb.a.Kid),$c.a.rb(sb.a.Vea),
$c.a.rb(sb.a.Mid),$c.a.rb(sb.a.nta),$c.a.rb(sb.a.SBc)]}get yOa(){return[$c.a.rb(tb.a.BA)]}get gPa(){return[]}PF(a){return 1074135132===a.Oe}KZa(){return!0}get xBa(){return[$c.a.rb(sb.a.cid),$c.a.rb(sb.a.sid),$c.a.rb(sb.a.shapeId),$c.a.rb(sb.a.GSa),$c.a.rb(sb.a.XWa),$c.a.rb(sb.a.mHa),$c.a.rb(sb.a.MGj),$c.a.rb(sb.a.ZK),$c.a.rb(sb.a.isResizable),$c.a.rb(sb.a.isEditable),$c.a.rb(sb.a.gta),$c.a.rb(sb.a.sI),$c.a.rb(sb.a.Cj),$c.a.rb(sb.a.jU),$c.a.rb(sb.a.zPa),$c.a.rb(sb.a.APa),$c.a.rb(sb.a.V7a),$c.a.rb(sb.a.d6b),
$c.a.rb(sb.a.hasText),$c.a.rb(sb.a.hW),$c.a.rb(sb.a.Wq),$c.a.rb(sb.a.isConnected),$c.a.rb(sb.a.Jf),$c.a.rb(sb.a.UDa),$c.a.rb(sb.a.Uq),$c.a.rb(sb.a.Ky),$c.a.rb(sb.a.Tp),$c.a.rb(sb.a.Kca),$c.a.rb(sb.a.Sk),$c.a.rb(sb.a.VS),$c.a.rb(sb.a.wk),$c.a.rb(sb.a.Pf),$c.a.rb(sb.a.a_),$c.a.rb(sb.a.Vp),$c.a.rb(sb.a.Ny),$c.a.rb(sb.a.pqa),$c.a.rb(sb.a.bCc),$c.a.rb(sb.a.aqb),$c.a.rb(tb.a.vN),$c.a.rb(Mb.a.e_),$c.a.rb(sb.a.N3b),$c.a.rb(sb.a.X_f),$c.a.rb(sb.a.UUd),$c.a.rb(sb.a.RTk),$c.a.rb(sb.a.Ued),$c.a.rb(sb.a.jh),$c.a.rb(sb.a.Y7c),
$c.a.rb(sb.a.V5d),$c.a.rb(sb.a.L5d),$c.a.rb(sb.a.cS),$c.a.rb(sb.a.Lsa),$c.a.rb(sb.a.eVb),$c.a.rb(sb.a.jQ),$c.a.rb(sb.a.qKb),$c.a.rb(sb.a.embeddedFonts),$c.a.rb(sb.a.KDa),$c.a.rb(sb.a.Fnc),$c.a.rb(sb.a.GGh),$c.a.rb(sb.a.T9g),$c.a.rb(sb.a.cXc),$c.a.rb(sb.a.Lid),$c.a.rb(sb.a.gea),$c.a.rb(sb.a.Vma),$c.a.rb(sb.a.d3),$c.a.rb(sb.a.WCb),$c.a.rb(sb.a.XCb),$c.a.rb(sb.a.YCb),$c.a.rb(sb.a.Zla),$c.a.rb(sb.a.h3)]}get UYa(){return!0}}Object(e.a)(iJ,"ShapeNodeComplexMerge",null,[391]);class xx{constructor(a,b){this.y$j=
a;this.hak=b}get yBa(){return this.hak}get kIa(){return[]}get EKa(){return[]}get vKa(){return[]}get yOa(){return[]}get gPa(){return[]}PF(a){return this.y$j(a)}KZa(){return!1}get xBa(){return[]}get UYa(){return!1}}Object(e.a)(xx,"SimpleStrategyComplexMerge",null,[391]);class jJ{get yBa(){return 8}get kIa(){return[]}get EKa(){return[$c.a.rb(sb.a.backgroundColor),$c.a.rb(sb.a.kra),$c.a.rb(sb.a.iSe),$c.a.rb(sb.a.W$),$c.a.rb(sb.a.Bma),$c.a.rb(sb.a.m$),$c.a.rb(sb.a.nB),$c.a.rb(sb.a.fqa),$c.a.rb(sb.a.QM),
$c.a.rb(sb.a.xP),$c.a.rb(sb.a.dM),$c.a.rb(sb.a.yxa)]}get vKa(){return[$c.a.rb(sb.a.FZa),$c.a.rb(sb.a.pj),$c.a.rb(sb.a.Cn),$c.a.rb(sb.a.Pe),$c.a.rb(sb.a.T1),$c.a.rb(sb.a.PLc),$c.a.rb(sb.a.HJd)]}get yOa(){return[$c.a.rb(tb.a.BA),$c.a.rb(sb.a.notesContentNode),$c.a.rb(Mb.a.commentContentNode)]}get gPa(){return[]}PF(a){return 393227===a.Oe}KZa(){return!0}get xBa(){return[$c.a.rb(sb.a.cid),$c.a.rb(sb.a.sid),$c.a.rb(sb.a.gZ),$c.a.rb(sb.a.Ath),$c.a.rb(tb.a.Rm),$c.a.rb(sb.a.aTa),$c.a.rb(sb.a.rca),$c.a.rb(sb.a.CRa),
$c.a.rb(sb.a.g8a),$c.a.rb(sb.a.title),$c.a.rb(sb.a.RX),$c.a.rb(sb.a.l$),$c.a.rb(sb.a.N3b),$c.a.rb(sb.a.f8a),$c.a.rb(sb.a.Y7a),$c.a.rb(sb.a.jh),$c.a.rb(sb.a.Vma)]}get UYa(){return!0}}Object(e.a)(jJ,"SlideNodeComplexMerge",null,[391]);class kJ{constructor(a,b){this.EHg=a;this.W1j=b}ga(a){return this.EHg.oOc(a,this.W1j)}get $Vd(){return this.EHg}}Object(e.a)(kJ,"PropertyMergeStrategies",null,[]);const KC=(a,b,c,f,l)=>{if(b){f=f||new uz;if(!a){a=b=b.z4a();const x=a.Mz();for(let G=0;G<x.length;G++){const R=
x[G];if(Wn.a.E7f(R)===Wn.a.string){const fa=f.Geg(a,R);f.Znh(a,R,fa?"Redacted: "+fa.length:"null")}}}Z.ULS.sendTraceTag(18613206,l,50,c,b.$ld())}else Z.ULS.sendTraceTag(18613204,l,10,c,"{0}: Node was null.",c)};class lJ{constructor(a,b,c){this.hGg=new qa.a;this.m2c=a;this.vua=b;this.$Ua=c(this.a1b());this.k7j=new Sa.a(Object(C.a)(this,this.$Vd,"evalPropertyMergeStrategies"))}jYj(a){if(!a.fGh){a.fGh=!0;var b=a.b7c.runtime.RLc,c=a.Yek;KC(b,a.T3a.value.iDb,"Base",c,808);KC(b,a.T3a.value.H4,"Favored",
c,808);KC(b,a.YUb.value.H4,"Conflict",c,808)}}wsl(a,b,c,f){this.xTa(a,c);const l=a.R9;if(2===f||7===f||a.ydc.contains(c))return!0;if(5===f)return!1;if(4===f||3===f){if(({value:x}=a.T3a.value.lXa.Rf(c)).returnValue&&x.P8a)return 4!==f;f=0}if(0===f){if(!b.isDeleted)return l.aJa($c.a.Lra(c),b.newValue),!0;f=6}if(8===f){let G=a.IFc.value;b=!0;if(({value:x}=G.lXa.Rf(c)).returnValue&&G.P8a){var x=this.m2c.sej(a.b7c.input.source,x);void 0!==x&&null!==x?l.aJa($c.a.Lra(c),x):(b=!1,f=6)}if(b)return!0}return 9===
f&&(b=!0,({value:x}=a.IFc.value.lXa.Rf(c)).returnValue&&(x=this.m2c.Khg(a.b7c.input.source,x),void 0!==x&&null!==x?l.aJa($c.a.Lra(c),x):(b=!1,f=6)),b)?!0:6===f?(l.removeProperty($c.a.Lra(c)),!0):1===f?this.vua.KZa(a,c):!1}fWa(a){return a}a1b(){return[Object(C.a)(this,this.Fsl,"tryPreProcessFavoredRevision"),Object(C.a)(this,this.iqi,"cloneObjectAndRemoveNeededProperties"),Object(C.a)(this,this.vsl,"tryMergeNodeInternal")]}get hcd(){return this.k7j.value}usl(a){const b=a.T3a.value;Z.ULS.sendTraceTag(18659235,
808,100,"TryMergeNode: Complex merge begin for object: [Id: {0}] [ClassId: {1}]",b.H4.id,b.H4.Oe);for(let c=0;c<this.$Ua.length;c++)if(!(0,this.$Ua[c])(a))return Z.ULS.sendTraceTag(18659265,808,50,"TryMergeNode: Complex Merge failed for object: [Id: {0}] [ClassId: {1}] [Step: {2}]",b.H4.id,b.H4.Oe,c),this.jYj(a),a.R9=null,!1;Z.ULS.sendTraceTag(18659267,808,100,"TryMergeNode: Complex Merge succeeded for object: [Id: {0}] [ClassId: {1}]",b.H4.id,b.H4.Oe);return!0}Fsl(a){const b=a.T3a.value;if(!b.P8a)return!0;
const c=this.hcd;let f=!0;b.lXa.forEach((l,x)=>{if(!x.P8a||a.ydc.contains(l))return!0;x=c.ga(l);if(5===x)return Z.ULS.sendTraceTag(18659269,808,50,"TryPreProcessFavoredRevision: Failed for [ClassId: {0}] [Property: {1}] was different from the base revision, but has a [MergeStrategy: {2}].",b.iDb.Oe,l,x),f=!1;6===x&&a.NCe.add(l);return!0});return f}iqi(a){a.R9=a.T3a.value.H4.z4a();const b=a.NCe,c=a.R9;b&&b.forEach(f=>{c.removeProperty($c.a.Lra(f));return!0});return!0}vsl(a){const b=a.YUb.value,c=b.iDb.Oe,
f=this.hcd;let l=!0;b.lXa.forEach((x,G)=>{if(this.vua.UYa&&!this.hcd.$Vd.Jb(x)){var R=String.format("prop id: {0} is missed in merge handlers for class {1}, please add it",x,c);Z.ULS.sendTraceTag(18970259,808,50,R)}R=f.ga(x);l=this.wsl(a,G,x,R);l||(a.R9=null,Z.ULS.sendTraceTag(18659271,808,50,"TryMergeProperty: Failed for [ClassId: {0}] [Property: {1}] [MergeStrategy: {2}].",c,x,R));return l});return l}V6i(){return[$c.a.rb(tb.a.j1f),$c.a.rb(tb.a.lastModifiedTime),$c.a.rb(tb.a.iE),$c.a.rb(tb.a.Zfb),
$c.a.rb(tb.a.zih),$c.a.rb(Kg.a.fec),$c.a.rb(Mb.a.Ysi),$c.a.rb(Mb.a.W_f),$c.a.rb(As.a.tw)]}$Vd(){var a=this.V6i(),b=this.vua.kIa,c=this.vua.EKa,f=this.vua.vKa,l=this.vua.gPa,x=this.vua.yOa;const G=this.vua.xBa,R=new ef.a(0);for(let fa=0;fa<a.length;fa++)R.$(a[fa],this.fWa(7));for(a=0;a<b.length;a++)R.$(b[a],this.fWa(8));for(b=0;b<c.length;b++)R.$(c[b],this.fWa(7));for(c=0;c<f.length;c++)R.$(f[c],this.fWa(9));for(f=0;f<l.length;f++)R.$(l[f],this.fWa(1));for(l=0;l<x.length;l++)R.$(x[l],this.fWa(9)),
this.hGg.add(x[l]);for(x=0;x<G.length;x++)R.$(G[x],this.fWa(this.vua.yBa));return new kJ(R,this.fWa(this.vua.yBa))}xTa(a,b){this.hGg.contains(b)&&(a=a.R9,Z.ULS.sendTraceTag(18956752,808,50,"Merge child nodes for [ObjectId: {0}] [ClassId: {1}] [PropertyId: {2}] []",a.id,a.Oe,b))}}Object(e.a)(lJ,"GraphNodeComplexMerge",null,[414]);class mJ{constructor(a,b){this.nl=a;this.h0c=b;this.z1j=this.Qzi()}Qzi(){const a=[];this.nl.forEach(b=>{a.push(new lJ(this.h0c,b,c=>c))});return a}Pzi(a){for(let b=0;b<this.nl.length;b++)if(this.nl[b].PF(a))return this.z1j[b];
return null}}Object(e.a)(mJ,"GraphNodeComplexMergeFactory",null,[333]);class nJ{sej(a,b){this.HFh(a);return 5===a?b.newValue:b.oldValue}Khg(a,b){this.HFh(a);return 5===a?b.oldValue:b.newValue}HFh(a){1!==a&&5!==a&&Z.ULS.sendTraceTag(18613264,808,15,"Unexpected merge source: {0}",a)}}Object(e.a)(nJ,"GraphNodeComplexMergeHelper",null,[389]);class oJ{constructor(a,b,c,f,l,x){this.NCe=this.ydc=null;this.l6b=this.fGh=!1;this.R9=null;this.amc=a.runtime.amc;this.b7c=a;this.Yek=b;this.T3a=c;this.YUb=f;this.IFc=
l;this.Sig=x}}Object(e.a)(oJ,"GraphNodeComplexMergeState",null,[]);class pJ{constructor(a){this.$Ua=a(this.a1b())}a1b(){return[Object(C.a)(this,this.Tfl,"simpleMerge"),Object(C.a)(this,this.osi,"complexMerge")]}y9k(a,b,c,f,l,x){a=new oJ(a,c,new Sa.a(()=>new vx(f.D4,l)),new Sa.a(()=>new vx(f.D4,x)),new Sa.a(()=>new vx(x,l)),b.Pzi(l));a.ydc=f.Lzc;a.NCe=new Si.a;return a}merge(a,b,c,f,l,x){a=this.y9k(a,b,c,f,l,x);b=!0;for(c=0;c<this.$Ua.length&&b;c++)b=(0,this.$Ua[c])(a);(b=a.l6b&&a.R9?new wx(a.R9,!1):
null)&&b.q8k(a.ydc);return{returnValue:a.l6b,R9:b}}Tfl(a){var b=a.Sig.hcd;return a.YUb.value.DTc(b)&&a.IFc.value.DTc(b)?a.T3a.value.DTc(b)?!0:(b=a.YUb.value.H4,a.l6b=!0,a.R9=b.z4a(),!1):(a.l6b=!0,!1)}osi(a){const b=a.YUb.value.H4;a.amc&&Z.ULS.sendTraceTag(18613266,808,100,"ComplexMerge: Begin [Id: {0}] [ClassId: {1}]",b.id,b.Oe);const c=a.Sig.usl(a);a.l6b=c;Z.ULS.sendTraceTag(18613268,808,c?100:50,"ComplexMerge: {0} for object: [Id: {1}] [ClassId: {2}] [MergedObject returned: {3}]",c?"Succeeded":
"Failed",b.id,b.Oe,!!a.R9);return c}}Object(e.a)(pJ,"GraphNodeMerge",null,[334]);class gu{constructor(a){this.m2c=a}UJi(a){const b=a.IFc.value,c=a.R9;a=a.b7c.input.source;for(const l of gu.pgd)if(({value:f}=b.lXa.Rf(l)).returnValue){var f=this.m2c.Khg(a,f);void 0!==f&&null!==f?c.aJa($c.a.Lra(l),f):c.removeProperty($c.a.Lra(l))}}get kIa(){return[$c.a.rb(sb.a.VS),$c.a.rb(sb.a.C$d),$c.a.rb(sb.a.D$d),$c.a.rb(sb.a.c$d)]}get EKa(){return[]}get vKa(){return[]}get yOa(){return[]}get gPa(){return gu.pgd}get xBa(){return[]}get UYa(){return!1}get yBa(){return 9}PF(a){return 393230===
a.Oe}KZa(a,b){return 0<=Array.indexOf(gu.pgd,b)?(this.UJi(a),gu.pgd.forEach(c=>{a.ydc.add(c)}),!0):!1}}gu.pgd=[$c.a.rb(tb.a.iq),$c.a.rb(tb.a.kib),$c.a.rb(tb.a.Hnc),$c.a.rb(tb.a.zJa),$c.a.rb(tb.a.Eva),$c.a.rb(Mb.a.kXa)];Object(e.a)(gu,"ParagraphNodeComplexMerge",null,[391]);class LC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.GraphMerge"}Wb(a){this.K=a;a.register(nJ,"PowerPointWebEditor.GraphMerge.GraphNodeComplexMergeHelper").as("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper").ma();
const b=[393229,393234,1074135136,131073,1179649,393252,393250,393251];a.register(333,"PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory").ma().na(()=>{const c=new iJ;return new mJ([new hJ,new jJ,c,new gu(a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper")),new eJ,new fJ,new gJ(c),new xx(f=>Array.contains(b,f.Oe),9),new xx(f=>131140===f.Oe,6),new xx(f=>131164===f.Oe,8),new xx(()=>!0,5)],a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeHelper"))});a.register(uz,
"PowerPointWebEditor.GraphMerge.MergeableObjectUtilities").as("Box4.StorageObjectSpace.IMergeableObjectUtilities").ma();a.register(334,"PowerPointWebEditor.GraphMerge.IGraphNodeMerge").ma().na(()=>new pJ(c=>c));a.register(335,"Box4.IBrowserGraphMerger").ma().na(()=>new Dv(c=>new HC.a(c),a.resolve("Box4.StorageObjectSpace.IMergeableObjectUtilities"),c=>c,a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeComplexMergeFactory"),a.resolve("PowerPointWebEditor.GraphMerge.IGraphNodeMerge"),(c,f,l)=>new In.a(c,
f,l),a.resolve("PowerPointWebEditor.IApplicationSettings").$Pc,a.resolve("PowerPointWebEditor.IApplicationSettings").Wvg,a.resolve("PowerPointWebEditor.IApplicationSettings").cJj,a.resolve("PowerPointWebEditor.IApplicationSettings").aJj,a.resolve("PowerPointWebEditor.IApplicationSettings").bJj))}init(){const a=this.K.resolve("Box4.IBrowserGraphMerger");Cb.App.WJa.mei(a)}dispose(){}static main(){m.a.instance.Bc(new LC)}}Object(e.a)(LC,"PPTWebEditorGraphMergePackage",null,[2,3]);class qJ{constructor(a,
b){this.nl=a;this.MQ=b}BYi(a){let b=null,c=null;if(a&&a.rootNode)for(const f of this.nl)if(f.PEj(a)){c=f;const l=this.MQ.zi("UserAction",f.name);b=f.yYi(a);l.stop();break}b||Aa.a.J(21860568,307,15,"{0} processed {1} but did not generate any HTML",c?c.name:"NoHandler",a&&a.rootNode?a.rootNode.type:0);return b}AYi(a){if(!a||1>a.length)return null;const b=document.createElement("div");for(const c of a)(a=this.BYi(c))&&b.appendChild(a);return b}}Object(e.a)(qJ,"HtmlExportProcessor",null,[330]);class MC{constructor(){this.eyc=
null}get rootNode(){return this.eyc}clone(){return Object.assign(new MC,{eyc:this.rootNode})}}Object(e.a)(MC,"HtmlExportContext",null,[]);class rJ{zYi(a,b){const c=[];for(const f of a)b&&!b(f)||c.push(Object.assign(new MC,{eyc:f}));return c}}Object(e.a)(rJ,"HtmlExportUtils",null,[332]);class sJ{constructor(a){this.hie=null;this.zq=a}get kLi(){return this.hie=this.hie||document.createElement("div")}CYi(a,b){if(!a||!a.rootNode||!b)return null;b.LAa(this.kLi);const c=this.zq.ke(3);try{c.gd(a.rootNode),
c.jJa(b.Ma),b.Hx(a.rootNode),b.oya()}finally{c&&c.dispose()}a=b.j3f;b.detach();return a}}Object(e.a)(sJ,"HtmlGenerator",null,[331]);class NC{constructor(a,b,c){this.$3j=a;this.a4j=b;this.Nb=c}get name(){return"PPTTableHtmlExportHandler"}PEj(a){return 14===a.rootNode.type?!0:10===a.rootNode.type?(a=Object(ua.a)(4,a.rootNode),!!a&&a.qd):!1}yYi(a){return this.a4j.CYi(this.nhj(a),this.$3j)}nhj(a){if(10===a.rootNode.type){const b=a.clone();a=this.Nb.Kc(a.rootNode);a.Ab(1);b.eyc=a.Ab(2);return b}return a}}
Object(e.a)(NC,"PPTTableHtmlExportHandler",null,[396]);class OC extends rg.a{constructor(a,b){super(new yo.a,a,b)}get j3f(){return this.jyh}}Object(e.a)(OC,"AHtmlExportView",rg.a,[402,352,201,106]);class PC{}PC.gQi="ExportedPPTTable";Object(e.a)(PC,"HtmlExportConstants",null,[]);class QC extends OC{constructor(a,b){super(a,b)}get j3f(){const a=this.jyh.getElementsByTagName("table");return 0<a.length?(Sys.UI.DomElement.addCssClass(a[0],PC.gQi),a[0]):null}get Kl(){return!0}get oF(){return 480}}Object(e.a)(QC,
"PPTTableHtmlExportView",OC,[]);class RC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.HtmlExport"}Wb(a){this.K=a;this.K.register(330,"PowerPointWebEditor.HtmlExport.IHtmlExportProcessor").ma().na(()=>new qJ([this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler")],this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));this.K.register(331,"PowerPointWebEditor.HtmlExport.IHtmlGenerator").ma().na(()=>new sJ(this.K.resolve("Box4.Graph.IGraphTransactionFactory")));
this.K.register(332,"PowerPointWebEditor.HtmlExport.IHtmlExportUtils").ma().na(()=>new rJ);this.$ti()}init(){}dispose(){}$ti(){this.K.register(QC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView").ma().na(()=>new QC(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("Box4.IViewManager")));this.K.register(NC,"PowerPointWebEditor.HtmlExport.PPTTableHtmlExportHandler").ma().na(()=>new NC(this.K.resolve("PowerPointWebEditor.HtmlExport.PPTTableHtmlExportView"),this.K.resolve("PowerPointWebEditor.HtmlExport.IHtmlGenerator"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory")))}static main(){m.a.instance.Bc(new RC)}}Object(e.a)(RC,"HtmlExportPackage",null,[2,3]);class vz extends Lh.a{constructor(a,b){super();this.Yrc=0;this.Xxd=null;this.fo="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>";
this.aef=a;this.$df=b;this.ng="LanguageDialog"}gmc(){this.mg=this.dZd();this.Yrc=({W9g:a}=this.aef.pfg()).returnValue;var a={["LanguageList"]:10,["DoNotCheckSpelling"]:!a};this.tj(Box4Intl.Box4Strings.l_Language,Object(C.a)(this,this.c5k,"setLanguageHandler"),a);this.Xxd=document.getElementById("LanguageList");this.$df.Kyk(this.Xxd,this.Yrc)}dZd(){return Lh.a.UB(this.fo,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)}c5k(a,
b){if(H.a.instance.ga(70)){var c=rb.a.instance.Kp(E.a.b5k);1!==a?c.properties.$("canceled","true"):(a=b.DoNotCheckSpelling,0<=b.LanguageList&&(b=parseInt(this.Xxd.value),this.aef.soh(b,a),c.properties.$("PreviousLCID",this.Yrc.toString()),c.properties.$("ChangedLCID",b.toString()),c.properties.$("NoProof",a.toString()),this.$df.a5k(b,this.Yrc)),Cb.App.Hb.updateCommandUI(!0));c.end()}}}Object(e.a)(vz,"LanguageDialog",Lh.a,[990]);class tJ{constructor(){this.USj=["version","xmlns","xmlns:xlink","style"]}sanitize(a){try{const b=
{};b.inputString=a;b.unsupportedContentCallback=Object(C.a)(this,this.cTj,"jsanityUnsupportedCallBack");return jSanity.sanitize(b)}catch(b){Aa.a.J(38398044,815,10,"Unexpected exception when converting svg: {0}, stack: {1}",b.message,b.stack)}return null}jZk(a){var b=this.sanitize(a);let c=null;if(b&&b.innerHTML&&b.innerHTML.startsWith("<svg")){c=b.innerHTML;if(0<a.indexOf("viewBox")&&0>c.indexOf("viewBox"))if((b=a.match(RegExp('viewBox="[^"]*')))&&1===b.length&&b[0])c=c.replace("<svg",String.format('<svg {0}"',
b[0]));else return null;if(0<a.replace(" ","").indexOf('xmlns="http://www.w3.org/'))c=0<c.indexOf("xmlns=")?c:c.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else return null}return c}cTj(a,b){b=b.toLowerCase();for(const c of this.USj)if(b===c)return;Aa.a.J(38398046,822,50,"JSanity unsupported callback unsupportContentName: {0}, unsupportContentValue:{1} ",a,b)}}Object(e.a)(tJ,"JSanityHelper",null,[328]);class SC extends vz{constructor(a,
b,c){super(a,c);this.Z2j=b}dZd(){return this.Z2j.hSa?Lh.a.UB(this.fo,Box4Intl.Box4Strings.l_MarkSelectedText,ResourceStrings.l_LanguageDialogDescription,ResourceStrings.l_DoNotCheckSpellingOrGrammar):super.dZd()}}Object(e.a)(SC,"PPTLanguageDialog",vz,[]);class uJ{constructor(a,b,c,f){this.l$j=a;this.V1j=b;this.v6j=c;this.EF=f}getInstance(a){return new SC((a?this.l$j:this.V1j)(),this.EF,this.v6j)}}Object(e.a)(uJ,"PPTLanguageDialogFactory",null,[326]);var Bk=d(113);class vJ{constructor(){this.NQe="rect,circle,ellipse,line,polyline,polygon,path";
this.Mkd=[];this.rfa=[[],[1,3],[4,3],[4,3,1,3],[8,3,1,3],[8,3],[8,3,1,3,1,3],[3,1],[1,1],[3,1,1,1],[3,1,1,1,1,1]];this.FAe=96}ntl(a,b=null){try{const c=this.L2d(a);if(!c)return null;const f=b?Hb.a.ZH(b.UC):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const x=c[b];x.setAttribute(Bk.a.sXd,f);x.setAttribute(Bk.a.P4f,l)}return a}catch(c){return Aa.a.J(38536015,815,10,"TryUpdateSVGDomelementFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,
c.stack),null}}sBh(a,b=null){try{const c=this.L2d(a);if(!c)return null;const f=b?Hb.a.ZH(b.UC):"none",l=b?b.alpha:1;for(b=0;b<c.length;++b){if(!c[b])continue;const x=c[b];x.setAttribute(Bk.a.vkd,f);x.setAttribute(Bk.a.Dvh,l)}return a}catch(c){return Aa.a.J(38536017,815,10,"TryUpdateSVGDomelementLineFillIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}otl(a,b){try{const f=this.L2d(a);if(!f)return null;var c=this.Adj(b);let l="";for(const x of c)l+=
x+" ";for(c=0;c<f.length;++c){if(!f[c])continue;const x=f[c];x.setAttribute(Bk.a.Cvh,l);x.setAttribute(Bk.a.cQe,"miter");x.setAttribute(Bk.a.Yjl,"4");switch(b){case 8:x.setAttribute(Bk.a.bQe,"round");break;case 2:case 0:x.setAttribute(Bk.a.bQe,"butt");break;default:x.setAttribute(Bk.a.bQe,"round")}}return a}catch(f){return Aa.a.J(38536019,815,10,"TryUpdateSVGDomelementLineDashIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",f.message,f.stack),null}}tBh(a,b,c,f){try{if(!a)return null;
this.Goh(c,b*this.FAe*f/we.a.RBa,a);return a}catch(l){return Aa.a.J(38536021,815,10,"TryUpdateSVGDomelementLineWidthIfSupport Unexpected exception when update svg domelement fill: {0}, stack: {1}",l.message,l.stack),null}}Cdj(){if(!this.Mkd||1>this.Mkd.length)this.Mkd=this.NQe.split(",");return this.Mkd}L2d(a){if(!a)return null;a=a.querySelectorAll(this.NQe);return 1>a.length?null:a}Goh(a,b,c){if(c){var f=c.getAttribute(Bk.a.WJb)?c.getAttribute(Bk.a.WJb).toString():"";1<f.length?(f=f.substring(f.indexOf("(")+
1,f.indexOf(")")),f=f.split(","),6===f.length?(f=Math.sqrt(Math.abs(parseFloat(f[0])*parseFloat(f[3]))+Math.abs(parseFloat(f[1])*parseFloat(f[2]))),f*=a):f=a):f=a;a=c.tagName.toLowerCase();for(var l of this.Cdj())if(l===a){c.setAttribute(Bk.a.dQe,(b/f).toString());break}if(c.children&&0<c.children.length)for(l=0;l<c.children.length;++l)this.Goh(f,b,c.children[l])}}Adj(a){switch(a){case 0:return this.rfa[0];case 1:return this.rfa[1];case 2:return this.rfa[2];case 3:return this.rfa[3];case 4:return this.rfa[4];
case 5:return this.rfa[5];case 6:return this.rfa[6];case 7:return this.rfa[7];case 8:return this.rfa[8];case 9:return this.rfa[9];case 10:return this.rfa[10];default:return Aa.a.J(38536023,815,15,"GetSVGDashArray: unsupport ST_PresetLineDashVal."),this.rfa[0]}}}Object(e.a)(vJ,"SVGIconLocalEditor",null,[329]);class wJ{constructor(a,b){this.SQg=b;this.Md=a}yI(a,b){if(!a)return!1;const c=a.Q2(f=>!f.Sk).length;return!this.R$k(a.LYb,c+b)}AJ(a){const b=a.we+1;this.Md.FG(222,c=>{c.NB=1;c.XPa=[b.toString(),
this.SQg.toString()];return!1})}R$k(a,b){if(!a&&b<this.SQg)return!1;Aa.a.J(22410754,822,50,"Can not edit. Shape count:{0}.",b);return!0}}Object(e.a)(wJ,"ShapeCountValidator",null,[327]);class TC{constructor(a,b,c,f,l,x){this.B6j=a;this.Fa=b;this.xSg=c;this.Fb=f;this.WI=l;this.Ea=x}get Gb(){return this.B6j.value}pfg(){let a,b=0;a=!0;const c=this.Gb.Yd();1===c.length&&c[0].hVc&&(b=this.Ea.QQa(c[0]),a=!this.Ea.H1d(c[0]));return{returnValue:b,W9g:a}}soh(a,b){const c=this.Gb.Yd();if(1===c.length&&c[0].hVc&&
this.xSg){var f=new D.DictionaryPropertySet;f.setValue(tb.a.Rs,a);f.setValue(Oc.a.Dva,b);a=this.Fb.ud(15);try{a.kc(c[0]);c[0].Kra();const l=Object(ua.a)(4,c[0]);l&&this.WI&&this.WI.Txl(l,b);this.xSg.qU(f);this.Fa.Ad()}finally{a&&a.dispose()}}}}Object(e.a)(TC,"ShapeLanguageEditor",null,[363]);class UC{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeEdit"}Wb(a){this.K=a;const b=this.K.resolve("PowerPointWebEditor.IApplicationContext");this.K.register(vz,"Box4.UI.LanguageDialog").as("Box4.UI.ILanguageDialog").na(()=>
new SC(this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration"),this.K.resolve("Box4.UI.ILanguageListHelper")));this.K.register(326,"PowerPointWebEditor.IPPTLanguageDialogFactory").ma().na(()=>new uJ(()=>this.K.resolve("PowerPointWebEditor.ShapeLanguageEditor"),()=>this.K.resolve("Box4.UI.ILanguageEditor"),this.K.resolve("Box4.UI.ILanguageListHelper"),this.K.resolve("Box4.Proofing.IProofingFeatureConfiguration")));this.K.register(TC,"PowerPointWebEditor.ShapeLanguageEditor").ma().na(()=>
new TC(this.K.le("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.qb("Box4.ITextFormattingCommands"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),this.K.resolve("PowerPointWebEditor.IShapeReader")));this.K.register(327,"PowerPointWebEditor.ShapeEdit.IShapeCountValidator").ma().na(()=>new wJ(fb.a.instance.resolve("PowerPointWebEditor.IErrorHandler"),b.ld.powerPointEditServerEditableShapeCountThreshold));
this.K.register(328,"PowerPointWebEditor.IJSanityHelper").ma().na(()=>new tJ);this.K.register(329,"PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor").ma().na(()=>new vJ)}init(){this.K.resolve("PowerPointWebEditor.IJSanityHelper")}dispose(){}static main(){m.a.instance.Bc(new UC)}}Object(e.a)(UC,"PPTWebEditorShapeEditPackage",null,[2,3]);var VC=d(280);class Fs{static get GZ(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?
"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}static requestFullscreen(a){a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.requestFullscreen?a.requestFullscreen():Z.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")}static exitFullscreen(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():
document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():Z.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")}static get W4b(){return document.webkitFullscreenEnabled||document.msFullscreenEnabled||document.mozFullScreenEnabled||document.fullscreenEnabled}static get f8(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}Object(e.a)(Fs,
"FullscreenUtils",null,[]);class xJ{get GZ(){return Fs.GZ}requestFullscreen(a){Fs.requestFullscreen(a)}exitFullscreen(){Fs.exitFullscreen()}get W4b(){return Fs.W4b}get f8(){return Fs.f8}get zNf(){return this.W4b&&!r.a.Vw}}Object(e.a)(xJ,"FullscreenUtilsProxy",null,[318]);class yJ{r7i(a){return inkButton.InkButtonManagerFactory.createInkButtonManager(a)}}Object(e.a)(yJ,"InkButtonHelper",null,[323]);class zJ{constructor(){this.menuDefinition=null;this.autoOpenMenu=!1;this.menuHostId=null;this.autoOpenMenu=
!1;this.menuHostId="SlideshowToolbarCalloutMenuContainer"}}Object(e.a)(zJ,"FlyoutMenuExtraProps",null,[]);class yx{}yx.pii="_136_16_N_20";yx.qii="none";Object(e.a)(yx,"InkButtonConstants",null,[]);class wz{constructor(){this.menuDefinition=this.controlInMenuRendererFunction=this.menuHostId=this.selectedColor=this.selectedItem=this.icon=null}static create(){return{}}}Object(e.a)(wz,"InkButtonProps",null,[]);class WC{constructor(){this.onInkMenuActivity=null}}Object(e.a)(WC,"IInkButtonSettings",null,
[]);class AJ extends WC{constructor(){super()}}Object(e.a)(AJ,"InkButtonSettings",WC,[]);class BJ{constructor(){this.color=this.item=null}}Object(e.a)(BJ,"InkManagerActivity",null,[]);class xz{constructor(){this.Ene=!1;this.Jre=this.ise=0;this.Zhe=""}get o3(){return this.Ene}set o3(a){this.Ene=a}get startingSlideIndex(){return this.ise}set startingSlideIndex(a){this.ise=a}get sJa(){return this.Jre}set sJa(a){this.Jre=a}get iZf(){return this.Zhe}set iZf(a){this.Zhe=a}get POk(){const a={};a.IsStartRehearsal=
this.Ene;a.StartingSlideIndex=this.ise;a.SlideCount=this.Jre;a.DisabledRehearsalRealtimeFeaturesStr=this.Zhe;return JSON.stringify(a)}}Object(e.a)(xz,"RehearsalContext",null,[321]);class yz extends Lh.a{constructor(a,b,c){super(!1,!0);this.upe=50001;this.hb=a;this.fe=b;this.Io=new xz;this.Xa=c;this.hb.sha(Object(C.a)(this,this.tea,"onSlideshowExitHandler"));this.hb.cUb(Object(C.a)(this,this.nea,"onGetCurrentPositionHandler"));this.hb.getCurrentPosition();this.HFa=!1}dispose(){super.dispose();this.HFa||
this.hb.restoreFocus()}px(){super.px();document.getElementById("WACDialogOverlay").style.zIndex=String(this.upe);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideshowSubtitleProactiveDialogContainer")}QF(){super.QF();var a=document.getElementById(this.ji("WACDialogPanel"));a.style.minWidth=$e.a.Nc(300);a.style.width=$e.a.Nc(300);a=document.getElementById(this.ji("WACDialogButtonPanel"));var b=document.getElementById(this.ji("WACDialogActionButton"));
a&&b&&a.removeChild(b);if(a=document.getElementById(this.ji("WACDialogCancelButton")))a.style.color="#ffffff",a.style.font="12pt",a.style.background="#A92B1A",a.innerText="Got it";if(a=document.getElementById(this.ji("WACDialogPanel"))){b=$e.a.Ce();b.style.position="absolute";b.style.bottom="20px";b.style.left="20px";const c=$e.a.vba();c.setAttribute("href","https://support.office.com/en-ie/article/present-with-real-time-automatic-captions-or-subtitles-in-powerpoint-68d20e49-aec3-456a-939d-34a79e8ddd5f#OfficeVersion=Online");
c.setAttribute("target","_blank");c.innerText="More Tips";b.appendChild(c);a.appendChild(b)}}open(){Aa.a.J(512495708,830,50,"SlideshowSubtitleProactiveDialog: Open");var a=this.fe.hk("SubtitleProactive_clearly.png");const b=this.fe.hk("SubtitleProactive_network.png"),c=this.fe.hk("SubtitleProactive_noNoise.png");this.mg="<div id='subtitleDlg'><div id='captions' class='SubtitleProactiveCaptions'><label id='captionID'></label></div><div id='sectiontitle' class='SubtitleProactiveSectionTitle '><span id='sectiontitle1'><label id='str1ID'></label></span></br><span id='sectiontitle2'><label id='str2ID'></label></span></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
a+"' style='width: 190px; height: 125px;'/><span id='block1_1' class='SubtitleProactiveBlockTitle'><label id='speakStr1ID'></label></span></br></br><span id='block1_2'><label id='speakStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+c+"' style='width: 190px; height: 125px;'/><span id='block2_1' class='SubtitleProactiveBlockTitle'><label id='noiseStr1ID'></label></span></br><span id='block2_2'><label id='noiseStr2ID'></label></span></br></br></br></div><div id='block' class='SubtitleProactiveBlock'><img src= '"+
b+"' style='width: 190px; height: 125px;'/><span id='block3_1' class='SubtitleProactiveBlockTitle'><label id='networkStr1ID'></label></span></br></br><span id='block3_2'><label id='networkStr2ID'></label></span></br></br></br></div></div>";a={["captionID"]:ResourceStrings.L_SubtitleProactive_Caption,["str1ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle1,["str2ID"]:ResourceStrings.L_SubtitleProactive_Sectiontitle2,["speakStr1ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr1,["speakStr2ID"]:ResourceStrings.L_SubtitleProactive_SpeakStr2,
["noiseStr1ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr1,["noiseStr2ID"]:ResourceStrings.L_SubtitleProactive_NoiseStr2,["networkStr1ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr1,["networkStr2ID"]:ResourceStrings.L_SubtitleProactive_NetworkStr2};this.tj("",Object(C.a)(this,this.mea,"onClickHandler"),a);this.hb.setVisibility(!0)}X6(){super.X6()}$qa(){super.$qa()}Bfb(){}nea(){this.hb.Cfb(Object(C.a)(this,this.nea,"onGetCurrentPositionHandler"));this.open()}tea(){this.HFa=!0;this.hb.Nea(Object(C.a)(this,
this.tea,"onSlideshowExitHandler"));this.hb.Cfb(Object(C.a)(this,this.nea,"onGetCurrentPositionHandler"));this.hide()}mea(a){0===a&&(a=Date.now(),this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,3,a,this.Io))}static OBg(a,b,c){new yz(a,b,c)}}Object(e.a)(yz,"SlideshowSubtitleProactiveDialog",Lh.a,[]);var Ah=d(664);class CJ{constructor(){this.buttonIdDictionary=null}}Object(e.a)(CJ,"SlideshowToolbarSettings",null,[]);class zx extends Sys.EventArgs{constructor(a){super();
this.text=a}}Object(e.a)(zx,"ReadOutEventArgs",Sys.EventArgs,[]);class XC{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){this.lzb=this.Io=this.Fc=this.eda=this.ee=this.J_c=this.Zre=this.$i=null;this.KT=this.AVa=this.CVa=this.$yb=this.sUa=this.Cle=0;this.rL=!1;this.ble=!0;this.N0c=this.DQ=this.Nse=this.Ege=!1;this.hb=c;this.gf=G;this.Qt=R;this.Xa=wa;this.ia=a;this.Ha=b;this.qte=l;this.Rb=x;this.s4j=fb.a.instance.Ka("PowerPointWebEditor.IInkButtonHelper");this.fe=f;this.Nt=Wa}init(a,b){Aa.a.J(512495955,830,
50,"ReactSlideshowToolbar.Init");this.ble=!0;this.Ege=!1;var c={};c[Ah.a.MicButton]=this.Ha.isMicButtonInSlideShowToolbarEnabled;c[Ah.a.PrevButton]=!0;c[Ah.a.NextButton]=!0;c[Ah.a.GridButton]=!0;c[Ah.a.InkButton]=!0;c[Ah.a.SubtitlesButton]=!0;c[Ah.a.LiveButton]=!0;c[Ah.a.MoreButton]=!0;c[Ah.a.ExitButton]=!0;c[Ah.a.CoachButton]=this.Ha.isCoachButtonInSlideShowToolbarEnabled;this.Zre=new CJ;this.Zre.buttonIdDictionary=c;if(!document.getElementById("slideshow-toolbar")){this.ee=document.createElement("div");
this.ee.id="slideshow-toolbar";this.ee.className="ReactSlideshowToolbar";this.Ha.pptEditorVoiceUXEnabled&&(this.J_c=document.getElementById("slideshowfooterContainerElement"),this.ee.className="ReactSlideshowToolbarWithFooter");c=document.createElement("div");c.id="slideshow-toolbar-accessibility";c.style.position="absolute";c.style.left="0px";c.style.top="auto";c.style.width="0px";c.style.height="0px";c.style.overflow="hidden";c.setAttribute("aria-label",ResourceStrings.l_SlideShowToolbar);this.Ha.pptEditorVoiceUXEnabled?
this.J_c.appendChild(this.ee):this.gf.appendChild(this.ee);this.$i=slideshowToolbar.SlideshowToolbarFactory.createToolbar(this.Zre,this.ee);if(!this.$i){Aa.a.J(512495954,830,10,"ReactSlideshowToolbar.Init m_slideshowToolbarManager is null.");const f=Jf.a.Qh(359);u.AFrameworkApplication.jp(f);vf.Health.instance.recordQosError(Jf.a.tba(f),["SlideShowACE"],!1,!0,!0,!1,null)}this.$i.renderToolbar();this.ee.appendChild(c);this.ee.tabIndex=0}this.eda||(this.eda=document.createElement("div"),this.eda.id=
"SlideshowToolbarCalloutMenuContainer",this.eda.className="SlideshowToolbarCalloutMenuContainer",this.Qt()&&(this.eda.style.direction=te.a.mZa),this.gf.appendChild(this.eda));this.Fc=a;this.Io=b;this.$i.registerButtonCallback(Ah.a.MicButton,()=>{this.cok()});this.$i.registerButtonCallback(Ah.a.CoachButton,()=>{this.Hkk()});this.Fc.Kh||this.Rb&&this.Rb.instance&&this.Rb.instance.Rq?(this.DQ=!0,this.$i.setToolbarButtonToggleState(Ah.a.MicButton,this.DQ),this.$i.showToolbarButton(Ah.a.MicButton)):(this.DQ=
!1,this.$i.setToolbarButtonToggleState(Ah.a.MicButton,this.DQ),this.$i.hideToolbarButton(Ah.a.MicButton));this.$i.registerButtonCallback(Ah.a.PrevButton,f=>{this.CDb(f)});this.$i.registerButtonCallback(Ah.a.NextButton,f=>{this.xDb(f)});this.$i.registerButtonCallback(Ah.a.GridButton,f=>{this.uDb(f)});this.$i.showToolbarButton(Ah.a.GridButton);this.Fc.csb&&!this.Io.o3&&(this.$i.registerButtonCallback(Ah.a.SubtitlesButton,f=>{this.I$c(f)}),this.$i.setToolbarButtonToggleState(Ah.a.SubtitlesButton,this.Fc.Kh),
this.$i.showToolbarButton(Ah.a.SubtitlesButton));this.$i.registerButtonCallback(Ah.a.ExitButton,f=>{this.tDb(f)});this.Ha.isInkingInSlideShowEnabled&&this.Ha.isInkUIInSlideShowEnabled&&(a=wz.create(),a.icon=yx.pii,a.selectedColor=yx.qii,this.$i.updateElementProps(Ah.a.InkButton,a),this.$i.registerButtonCallback(Ah.a.InkButton,()=>{this.myj()}),this.$i.showToolbarButton(Ah.a.InkButton));this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&!this.Io.o3&&(this.$i.registerButtonCallback(Ah.a.LiveButton,()=>
{this.Mnk()}),this.$i.updateFlyoutButtonCallback(Ah.a.LiveButton,this.Rb.instance.Rq),this.$i.setToolbarButtonToggleState(Ah.a.LiveButton,this.Rb.instance.Rq),this.$i.showToolbarButton(Ah.a.LiveButton),this.Rb.instance.mFf(Object(C.a)(this,this.Oec,"onLiveSessionStarted")),this.Rb.instance.kFf(Object(C.a)(this,this.Nec,"onLiveSessionEnded")),this.Rb.instance.iFf(Object(C.a)(this,this.Mec,"onLiveRelaunchPausedSession")),this.Rb.instance.a6h(Object(C.a)(this,this.B0g,"onLiveCalloutMenuDefintionChanged")));
this.vKb();this.xsb();this.hb.sha(Object(C.a)(this,this.gma,"onExitHandler"));this.hb.BId(Object(C.a)(this,this.Pdb,"onBrowserEventHandler"));this.hb.xBc(Object(C.a)(this,this.Lva,"onGetCurrentSlideDimensionsHandler"));this.hb.BBc(Object(C.a)(this,this.Vva,"onSpecialKeyHandler"));this.hb.DId(Object(C.a)(this,this.Qdb,"onContextMenuHandler"));this.hb.FId(Object(C.a)(this,this.Z8c,"onEnterEndOfShowHandler"));this.hb.HId(Object(C.a)(this,this.y9c,"onLeaveEndOfShowHandler"));Ed.a.addHandler(this.ee,ma.a.fq,
Object(C.a)(this,this.Xdb,"onMouseOverHandler"));Ed.a.addHandler(this.ee,ma.a.ys,Object(C.a)(this,this.Qec,"onMouseOutHandler"));Ed.a.addHandler(this.eda,ma.a.click,Object(C.a)(this,this.mea,"onClickHandler"));Ed.a.addHandler(this.ee,ma.a.Xf,Object(C.a)(this,this.BHa,"onKeyDownHandler"))}yel(){window.clearTimeout(this.Cle);this.Cle=window.setTimeout(Object(C.a)(this,this.Buj,"hideMouse"),3E3);this.hb.hfa(!0)}Buj(){this.rL||(window.clearTimeout(this.Cle),this.hb.hfa(!1))}JC(a,b){b?this.$i.showToolbarButton(a):
this.$i.hideToolbarButton(a)}setToolbarButtonToggleState(a,b){this.$i.setToolbarButtonToggleState(a,b)}show(){if(this.Qt()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.CVa+this.KT-16-this.$i.getToolbarWidth()).toString()+"px";a.style.left=b}}this.$i.showToolbar();this.$i.enterFocusTrapZone();window.clearTimeout(this.sUa);window.clearTimeout(this.$yb);this.ble?(this.sUa=window.setTimeout(Object(C.a)(this,this.hide,"hide"),2E3),this.ble=!1,this.Ege=!0):this.sUa=window.setTimeout(Object(C.a)(this,
this.hide,"hide"),3E3);this.hb.hfa(!0)}dth(){if(this.Qt()){const a=document.getElementById("slideshow-toolbar");if(a){const b=(this.CVa+this.KT-16-this.$i.getToolbarWidth()).toString()+"px";a.style.left=b}}this.$i.showToolbar();this.$i.enterFocusTrapZone();window.clearTimeout(this.sUa);window.clearTimeout(this.$yb);this.$yb=window.setTimeout(Object(C.a)(this,this.hide,"hide"),1E4)}hide(){if(!this.rL){const a=document.getElementById("slideshow-toolbar");a&&!this.$i.isAnyToolbarElementFocused()&&document.activeElement===
a&&this.LZa(ResourceStrings.l_SlideShowToolbarDismissed);window.clearTimeout(this.sUa);window.clearTimeout(this.$yb);this.$i.hideToolbar();this.hb.hfa(!1);this.ee.style.display===te.a.Cf&&this.hb.restoreFocus()}}xsb(){this.rL||(this.Ege&&this.LZa(ResourceStrings.l_SlideShowToolbarDismissed),window.clearTimeout(this.sUa),window.clearTimeout(this.$yb),this.$i.forceHideToolbar(),this.hb.hfa(!1),this.ee.style.display===te.a.Cf&&this.hb.restoreFocus())}remove(){this.$i.closeToolbar();this.eda.style.visibility=
te.a.As;this.N0c=!1;this.hb.Nea(Object(C.a)(this,this.gma,"onExitHandler"));this.hb.gGe(Object(C.a)(this,this.Pdb,"onBrowserEventHandler"));this.hb.Med(Object(C.a)(this,this.Lva,"onGetCurrentSlideDimensionsHandler"));this.hb.Ped(Object(C.a)(this,this.Vva,"onSpecialKeyHandler"));this.hb.iGe(Object(C.a)(this,this.Qdb,"onContextMenuHandler"));this.hb.jGe(Object(C.a)(this,this.Z8c,"onEnterEndOfShowHandler"));this.hb.lGe(Object(C.a)(this,this.y9c,"onLeaveEndOfShowHandler"));Ed.a.removeHandler(this.ee,
ma.a.fq,Object(C.a)(this,this.Xdb,"onMouseOverHandler"));Ed.a.removeHandler(this.ee,ma.a.ys,Object(C.a)(this,this.Qec,"onMouseOutHandler"));Ed.a.removeHandler(this.eda,ma.a.click,Object(C.a)(this,this.mea,"onClickHandler"));Ed.a.removeHandler(this.ee,ma.a.Xf,Object(C.a)(this,this.BHa,"onKeyDownHandler"));this.ee&&(this.gf.contains(this.ee)||this.J_c&&this.J_c.contains(this.ee))&&(this.rL=!1);this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&(this.Rb.instance.vfh(Object(C.a)(this,this.Oec,"onLiveSessionStarted")),
this.Rb.instance.ufh(Object(C.a)(this,this.Nec,"onLiveSessionEnded")),this.Rb.instance.sfh(Object(C.a)(this,this.Mec,"onLiveRelaunchPausedSession")),this.Rb.instance.FRk(Object(C.a)(this,this.B0g,"onLiveCalloutMenuDefintionChanged")))}gma(){this.remove()}LZa(a){Ka.a.Va(a)?Aa.a.J(512495953,830,15,"ReactSlideshowToolbar::TryRaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.qte.Ibh(new zx(a))}Lva(a,b){try{this.CVa=b.Eth;this.AVa=b.Bth;this.KT=b.slideWidth;if("NaN"===this.CVa.toString()||
"NaN"===this.AVa.toString()){Aa.a.J(512495952,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler slide dimension info is null.");const c=Jf.a.Qh(359);u.AFrameworkApplication.jp(c);vf.Health.instance.recordQosError(Jf.a.tba(c),["SlideShowACE"],!1,!0,!0,!1,null)}else{const c=this.Rb.instance&&this.Rb.instance.Rq&&!this.N0c?26:0;if(this.Ha.pptEditorVoiceUXEnabled){const f=document.getElementById("slideshowfooterContainerElement");if(f){let l;l=this.Qt()?(this.CVa+this.KT-16-this.$i.getToolbarWidth()).toString()+
"px":(this.CVa+2).toString()+"px";f.style.left=l;if(this.Fc.Kh&&"AboveSlide"===this.Fc.Fv)f.style.bottom="0px";else{const G=ya.a.KPc();a=0;const R=document.getElementById("AppHeaderPanel");R&&(a=R.clientHeight);f.style.bottom=this.Nt.f8?(G-this.AVa-c).toString()+"px":(G-this.AVa-a-c).toString()+"px"}f.style.top="auto";const x=document.getElementById("ReactToolbarInnerContainer");x&&(x.style.position="relative")}}else{const f=document.getElementById("slideshow-toolbar");if(f){let l;l=this.Qt()?(this.CVa+
this.KT-16-this.$i.getToolbarWidth()).toString()+"px":(this.CVa+2).toString()+"px";f.style.left=l;const x=this.Rb.instance&&this.Rb.instance.Rq?(this.AVa+c).toString()+"px":this.AVa.toString()+"px";"AboveSlide"===this.Fc.Fv?(f.style.bottom="0px",f.style.top="auto"):(f.style.top=x,f.style.bottom="auto");f.style.top=x}}}this.show()}catch(c){Aa.a.J(512495951,830,10,"ReactSlideshowToolbar.OnGetCurrentSlideDimensionsHandler: Exception thrown when trying to access the OnGetCurrentSlideDimensionsEventArgs, exception: {0}",
c)}}Z8c(){this.N0c=!0}y9c(){this.N0c=!1}BHa(a){this.$i.isAnyCalloutMenuOpen()||(this.rL=!1);try{this.ee.style.display===te.a.Lk&&(a.keyCode===w.a.ujb||a.keyCode===w.a.vB||a.keyCode===w.a.$0?this.hb.prev():a.keyCode===w.a.uya||a.keyCode===w.a.uB||a.keyCode===w.a.Y0?this.hb.next():a.keyCode===w.a.mR?this.Qt()?this.hb.next():this.hb.prev():a.keyCode===w.a.MO?this.Qt()?this.hb.prev():this.hb.next():a.keyCode===w.a.xKa?(this.Nse=!0,this.xsb()):a.shiftKey&&a.keyCode===w.a.coa||a.keyCode===w.a.qLb?this.xsb():
this.hb.SJe(a))}catch(b){Aa.a.J(512495950,822,10,"ReactSlideshowToolbar.OnKeyDownHandler Exception in KeyDownHandler : {0}.",b)}}Vva(a,b){this.$i.isAnyCalloutMenuOpen()||(this.rL=!1);if(b.key===w.a.qLb||b.shiftKey&&b.key===w.a.coa)a="off",this.ee.style.display===te.a.Cf?(this.dth(),a="on"):this.xsb(),Aa.a.J(512495949,830,50,"ReactSlideshowToolbar.OnSpecialKeyHandler: T key pressed, turned slideshow toolbar {0}",a)}Qdb(){if(this.Nse)this.Nse=!1;else{var a="off";this.ee.style.display===te.a.Cf?(this.dth(),
a="on"):this.$i.isAnyCalloutMenuOpen()||this.xsb();Aa.a.J(512495948,830,50,"ReactSlideshowToolbar.OnContextMenuHandler: ContextMenu event received, turned slideshow toolbar {0}",a)}}Pdb(a,b){this.yel();b.clientY<this.AVa+8+20&&b.clientY>this.AVa-20-8&&this.show()}Xdb(a){(a=a.target)&&this.ee.contains(a)&&(this.rL=!0)}Qec(a){a.target&&(this.$i.isAnyCalloutMenuOpen()?this.eda.style.visibility=te.a.oz:(this.rL=!1,this.show()));this.$i.isAnyCalloutMenuOpen()||this.$i.enterFocusTrapZone()}mea(a){this.rL=
!1;window.clearTimeout(this.sUa);window.clearTimeout(this.$yb);this.eda.style.visibility=te.a.As;this.sUa=window.setTimeout(Object(C.a)(this,this.hide,"hide"),3E3);"SlideshowToolbarCalloutMenuContainer"===a.target.id&&this.$i.enterFocusTrapZone()}CDb(){Aa.a.J(512495947,830,50,"ReactSlideshowToolbar.OnPrevClickHandler");this.hb.prev()}xDb(){Aa.a.J(512495946,830,50,"ReactSlideshowToolbar.OnNextClickHandler");this.hb.next()}tDb(){Aa.a.J(512495945,830,50,"ReactSlideshowToolbar.OnExitClickHandler");this.$i.closeToolbar();
this.hb.exit()}KSe(a){const b=!!this.Rb&&!!this.Rb.instance&&this.Rb.instance.Rq;var c=this.Fc.H3f&&5!==a&&!b;5!==a&&(this.Fc.Kh&&(Pi.a.aM("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Pi.a.JL)||Aa.a.J(512495944,822,10,"ReactSlideshowToolbar::ToggleTranscriber - Failed to set cookie for discoverability opt out to true")),this.Fc.Kh=!this.Fc.Kh);this.$i.setToolbarButtonToggleState(Ah.a.SubtitlesButton,this.Fc.Kh);Aa.a.J(512495943,830,50,"ReactSlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Fc.Kh);this.Fc.Kh&&c&&yz.OBg(this.hb,this.fe,this.Xa);c||(c=Date.now(),b?this.DQ||this.Rb.instance.gsb()?this.hb.toggleTranscriberUIVisibility(null):(this.Rb.instance.Tjg(),this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,a,c,this.Io)):this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,a,c,this.Io));this.DQ=this.Fc.Kh||b;this.Rnd();this.vKb()}Rnd(){this.$i.setToolbarButtonToggleState(Ah.a.MicButton,
this.DQ);this.DQ?this.$i.showToolbarButton(Ah.a.MicButton):this.$i.hideToolbarButton(Ah.a.MicButton)}vKb(){const a=this.Fc.Kh,b=!!this.Rb&&!!this.Rb.instance&&this.Rb.instance.Rq,c=this.Io.o3,f=32!==this.ia.processAction(ba.a.Kma,1);a||b||c||f?this.$i.hideToolbarButton(Ah.a.CoachButton):this.$i.showToolbarButton(Ah.a.CoachButton)}cok(){Aa.a.J(512495942,830,50,"ReactSlideshowToolbar.OnMicToggleHandler");this.DQ=!this.DQ;this.$i.setToolbarButtonToggleState(Ah.a.MicButton,this.DQ);this.hb.setMicrophoneState(!this.DQ);
if(this.Rb&&this.Rb.instance&&this.Rb.instance.Rq&&this.DQ&&!this.Rb.instance.gsb()){this.Rb.instance.Tjg();const a=this.Fc.Kh;this.Rb.instance.Uba=!this.Fc.Kh;this.Fc.Kh=!0;this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,5,Date.now(),this.Io);this.Fc.Kh=a}}Hkk(){Aa.a.J(512495941,830,50,"ReactSlideshowToolbar.OnCoachClickHandler");32===this.ia.La(ba.a.Kma,2,{entryPoint:2})?this.Ha.pptEditorRehearsalSpeechClientEnabled||(this.Io.o3=
!0):Aa.a.J(512495940,830,10,"ReactSlideshowToolbar.OnCoachClickHandler - Failed to start Rehearsal Session")}I$c(){Aa.a.J(512495939,830,50,"ReactSlideshowToolbar.OnTranscribeHandler");this.KSe(3)}uDb(){Aa.a.J(512495938,830,50,"ReactSlideshowToolbar.OnGridViewClickHandler");this.ia.La(ba.a.oIb,2,null)}Mnk(){this.Rb&&this.Rb.instance&&(Aa.a.J(512495937,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Rb.instance.Rq),this.Rb.instance.Rq||(this.Rb.instance.Imc(3,u.AFrameworkApplication.userSessionId,
this.Ha.podsWebServiceBase,this.Xa.podSessionId,u.AFrameworkApplication.hh),this.Rb.instance.Uba=!this.Fc.Kh,this.Fc.csb&&!this.Fc.Kh&&(Aa.a.J(512495936,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Fc.Kh=!0,this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,5,Date.now(),this.Io),this.Fc.Kh=!1,this.DQ=!0,this.Rnd()),this.rL=!1,this.$i.setToolbarButtonToggleState(Ah.a.LiveButton,!0)));this.vKb()}Oec(){this.$i.setToolbarButtonToggleState(Ah.a.LiveButton,
!0);this.Qnd(!1,!1);this.DQ=!0;this.Rnd();this.vKb();this.wWg()}Nec(){this.$i.setToolbarButtonToggleState(Ah.a.LiveButton,!1);this.Qnd(!1,!0);this.Rb&&this.Rb.instance&&this.Rb.instance.Uba&&!this.Fc.Kh&&(Aa.a.J(512495907,830,50,"Stopping subtitle for stopping live session."),this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,5,Date.now(),this.Io));this.Rb.instance.Uba=!1;this.Fc.Kh||(this.DQ=!1,this.Rnd());this.vKb()}Mec(){this.Rb&&
this.Rb.instance&&(this.rL=!0,this.show(),this.eda.style.visibility=te.a.oz,this.Qnd(!0,!1),this.wWg());this.vKb()}wWg(){this.Ha.Lbd&&!this.Rb.instance.gsb()&&(this.DQ=!1,this.$i.setToolbarButtonToggleState(Ah.a.MicButton,this.DQ),this.Fc.Kh=!1,this.$i.setToolbarButtonToggleState(Ah.a.SubtitlesButton,this.Fc.Kh))}B0g(){this.Qnd(!1,!1)}Qnd(a,b){if(this.Rb&&this.Rb.instance){const c=new zJ;c.menuDefinition=b?null:this.Rb.instance.getCalloutMenuDefinition();c.autoOpenMenu=a;this.$i.updateElementProps(Ah.a.LiveButton,
c);this.$i.updateFlyoutButtonCallback(Ah.a.LiveButton,!b)}}myj(){this.s4j.execute(Object(C.a)(this,this.lyj,"initInkButton"));const a=new BJ;a.item="Init";this.hb.bBe(a);this.$i.registerButtonCallback(Ah.a.InkButton,()=>{})}lyj(a){const b=new AJ;b.onInkMenuActivity=c=>{this.knk(c)};this.lzb=a.r7i(b);a=wz.create();a.icon=this.lzb.getIcon();a.menuDefinition=this.lzb.getControlsInMenu();a.menuHostId="SlideshowToolbarCalloutMenuContainer";this.$i.updateElementProps(Ah.a.InkButton,a)}knk(a){this.hb.bBe(a);
a=wz.create();a.selectedColor=this.lzb.getSelectedColor();a.icon=this.lzb.getIcon();a.menuDefinition=this.lzb.getControlsInMenu();this.$i.updateElementProps(Ah.a.InkButton,a);re.a("DismissToolbarOnSelection")&&this.xsb()}}Object(e.a)(XC,"ReactSlideshowToolbar",null,[991,992]);class YC{constructor(a,b){this.Zh=a;this.F9b=document.createElement("div");this.F9b.id="slideshowfooterContainerElement";this.F9b.className="slideshowFooterContainer";this.ia=b}init(){Aa.a.J(595198370,830,50,"SlideShowFooterContainer.Init");
this.Zh&&this.Zh.appendChild(this.F9b)}remove(){this.Zh&&this.Zh.contains(this.F9b)&&this.Zh.removeChild(this.F9b)}ub(){this.ia.ya(ba.a.msh,sc.a.application,Object(C.a)(this,this.Odl,"showFooterElements"));this.ia.ya(ba.a.jmg,sc.a.application,Object(C.a)(this,this.xuj,"hideFooterElements"))}Odl(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display="flex");return 32}xuj(a,b,c){2===c&&(a=document.getElementById("slideshowfooterContainerElement"))&&(a.style.display=
te.a.Cf);return 32}}Object(e.a)(YC,"SlideShowFooterContainer",null,[1E3]);class DJ{constructor(){this.hostElement=null;this.baseZIndex=0}}Object(e.a)(DJ,"IVoiceActorSettings",null,[]);class EJ{constructor(){this.Zcc=this.Zh=this.gdb=null}init(){Aa.a.J(595198290,830,50,"SlideShowVoiceNotification.Init");this.gdb=document.createElement("div");this.gdb.id="voiceNotificationContainerElement";this.gdb.className="voiceNotificationContainer";(this.Zh=document.getElementById("slideshowfooterContainerElement"))&&
this.Zh.insertBefore(this.gdb,this.Zh.firstChild);const a=new DJ;a.baseZIndex=50002;a.hostElement=this.gdb;this.Zcc=voiceUI.VoiceActorFactory.CREATE_VOICE_ACTOR(a)}remove(){this.Zh&&this.Zh.contains(this.gdb)&&this.Zh.removeChild(this.gdb)}show(a,b){this.Zcc&&this.Zcc.showNotification(a,b)}hide(){this.Zcc&&this.Zcc.hideNotification()}}Object(e.a)(EJ,"SlideShowVoiceNotification",null,[324]);class ZC extends Lh.a{constructor(a,b){super(!1,!0);this.hcc=null;this.Z$a=this.$Ta=0;this.upe=50001;this.Kzb=
null;this.hb=a;this.M7j=b;this.hb.sha(Object(C.a)(this,this.tea,"onSlideshowExitHandler"));this.hb.cUb(Object(C.a)(this,this.nea,"onGetCurrentPositionHandler"));this.hb.getCurrentPosition();this.HFa=!1}get Sjd(){if(void 0===this.hcc||null===this.hcc)this.hcc=document.getElementById("GotoDlgInput");return this.hcc}NAl(){if(!RegExp("^[0-9]+$").test(this.Sjd.value))return this.Sjd.value=this.$Ta.toString(),!1;this.Z$a=Number.parseInvariant(this.Sjd.value);this.Z$a=Math.min(this.Z$a,this.M7j);this.Z$a=
Math.max(this.Z$a,1);return!0}dispose(){super.dispose();this.hcc=null;this.HFa||this.hb.restoreFocus()}px(){super.px();document.getElementById("WACDialogOverlay").style.zIndex=String(this.upe);const a=document.getElementById("WACDialogOuterContainer");Sys.UI.DomElement.addCssClass(a,"SlideShowGoToDialogContainer")}QF(){super.QF();const a=document.getElementById(this.ji("WACDialogPanel"));a.style.minWidth=$e.a.Nc(300);a.style.width=$e.a.Nc(300)}open(){Aa.a.J(24133980,830,50,"SlideshowGoToDialog: Open");
this.mg="<div id='GotoDlgLabelHolder'><label id='GotoDlgLabel'></label></div><input id='GotoDlgInput' type='text'/>";const a={["GotoDlgLabel"]:ResourceStrings.l_GotoSlideLabel,["GotoDlgInput"]:this.$Ta.toString()};this.tj(ResourceStrings.L_GoTo,Object(C.a)(this,this.mea,"onClickHandler"),a);this.hb.setVisibility(!0);this.Sjd.focus()}X6(){super.X6();this.Kzb=Object(C.a)(this,this.BHa,"onKeyDownHandler");u.AFrameworkApplication.Aa.TF.ked(ma.a.Xf,window.document,this.Kzb,null)}$qa(){super.$qa();void 0!==
this.Kzb&&null!==this.Kzb&&u.AFrameworkApplication.Aa.TF.GUe(ma.a.Xf,window.document,this.Kzb);this.Kzb=null}Bfb(){}nea(a,b){this.hb.Cfb(Object(C.a)(this,this.nea,"onGetCurrentPositionHandler"));this.$Ta=b.slideIndex+1;this.open()}tea(){this.HFa=!0;this.hb.Nea(Object(C.a)(this,this.tea,"onSlideshowExitHandler"));this.hb.Cfb(Object(C.a)(this,this.nea,"onGetCurrentPositionHandler"));this.hide()}BHa(a){a=a.mc.keyCode;return a===w.a.lq?(this.NAl()&&(this.mRa(this.Z$a),this.hide()),!0):a===w.a.rLb||a===
w.a.yKa||a===w.a.tFh||a===w.a.sod?!0:!1}mea(a){1===a&&this.mRa(this.Z$a)}mRa(a){this.hb.mRa(a-1)}static nUj(a,b){1>=b||void 0!==Vg.a.Mw&&null!==Vg.a.Mw||new ZC(a,b)}}Object(e.a)(ZC,"SlideshowGoToDialog",Lh.a,[]);class $C{constructor(a,b,c,f,l,x,G,R,fa){this.Z3=this.K=null;this.qzb=!1;this.I3=[];this.dUa=this.SD=this.K9b=null;this.hb=a;this.Qb=b;this.fua=c;this.ia=f;this.Ee=l;this.gf=x;this.Qt=G;this.Nt=R;this.Rb=fa}init(){this.K||(this.K=document.createElement("div"),this.K.id="SlideshowContextMenuContainer",
this.K.className="SlideshowContextMenuContainer");this.Z3=document.createElement("div");this.Z3.className="SlideshowContextMenu cui-menu";this.Z3.tabIndex=0;const a=document.createElement("ul");a.className="SlideshowContextMenuList cui-menusection-items";const b=this.Qt();let c=this.vK(ResourceStrings.L_Next,Object(C.a)(this,this.xDb,"onNextClickHandler"),b);Array.add(this.I3,c);a.appendChild(c);c=this.vK(ResourceStrings.L_Previous,Object(C.a)(this,this.CDb,"onPrevClickHandler"),b);Array.add(this.I3,
c);a.appendChild(c);c=this.vK(ResourceStrings.l_GotoCell,Object(C.a)(this,this.Umk,"onGoToClickHandler"),b);Array.add(this.I3,c);a.appendChild(c);c=this.vK(ResourceStrings.L_GridView_SeeAllSlides,Object(C.a)(this,this.uDb,"onGridViewClickHandler"),b);Array.add(this.I3,c);a.appendChild(c);this.Nt.zNf&&(this.K9b=this.vK(this.Nt.f8?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen,Object(C.a)(this,this.AHa,"onFullscreenClickHandler"),b),Array.add(this.I3,this.K9b),a.appendChild(this.K9b),
this.Nt.GZ&&!this.SD&&(this.SD=Object(C.a)(this,this.Fec,"onFullscreenChangeHandler"),$addHandler(this.gf,this.Nt.GZ,this.SD)));c=this.vK(ResourceStrings.L_EndShow,Object(C.a)(this,this.tDb,"onExitClickHandler"),b);Array.add(this.I3,c);a.appendChild(c);this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&(this.dUa=this.vK(ResourceStrings.l_EndLivePresentation,Object(C.a)(this,this.Tlk,"onEndLivePresentationClickHandler"),b),Array.add(this.I3,this.dUa));this.Z3.appendChild(a);this.K.appendChild(this.Z3);
this.gf.appendChild(this.K);this.fua.addHandler(this.K,ma.a.click,Object(C.a)(this,this.mea,"onClickHandler"));this.fua.addHandler(this.K,ma.a.contextMenu,Object(C.a)(this,this.$_g,"onHostContextMenuHandler"));this.fua.addHandler(this.Z3,ma.a.fq,Object(C.a)(this,this.Xdb,"onMouseOverHandler"));this.hb.DId(Object(C.a)(this,this.Qdb,"onContextMenuHandler"));this.hb.sha(Object(C.a)(this,this.gma,"onExitHandler"))}show(){if(this.Rb&&this.Rb.instance&&this.Rb.instance.Rq&&this.dUa&&!this.dUa.parentNode){const a=
this.Z3.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].appendChild(this.dUa)}this.qzb||(this.fua.addHandler(window.document,ma.a.Xf,Object(C.a)(this,this.BHa,"onKeyDownHandler")),this.fua.addHandler(window.document,ma.a.wl,Object(C.a)(this,this.Lec,"onKeyUpHandler")),this.qzb=!0);this.K.style.visibility=te.a.oz}hide(){this.fua.removeHandler(window.document,ma.a.Xf,Object(C.a)(this,this.BHa,"onKeyDownHandler"));this.fua.removeHandler(window.document,ma.a.wl,
Object(C.a)(this,this.Lec,"onKeyUpHandler"));this.qzb=!1;this.K.style.visibility=te.a.As;if(this.dUa&&this.dUa.parentNode){const a=this.Z3.getElementsByClassName("SlideshowContextMenuList cui-menusection-items");1===a.length&&a[0].removeChild(this.dUa)}}remove(){this.K&&(this.fua.removeHandler(this.K,ma.a.click,Object(C.a)(this,this.mea,"onClickHandler")),this.fua.removeHandler(this.K,ma.a.contextMenu,Object(C.a)(this,this.$_g,"onHostContextMenuHandler")),this.gf.contains(this.K)&&this.gf.removeChild(this.K));
this.K=null;Array.clear(this.I3)}gma(){this.hb.Nea(Object(C.a)(this,this.gma,"onExitHandler"));this.hb.iGe(Object(C.a)(this,this.Qdb,"onContextMenuHandler"));this.K9b&&($removeHandler(this.gf,this.Nt.GZ,this.SD),this.SD=null);this.remove()}mea(a){"SlideshowContextMenuContainer"===a.target.id&&(this.hide(),this.hb.restoreFocus())}Qdb(a,b){this.K3g(b.clientX,b.clientY)}$_g(a){this.K3g(a.clientX,a.clientY)}Xdb(a){(a=a.target)&&"li"===a.tagName.toLowerCase()&&(this.MFe(document.activeElement),this.bR(a))}BHa(a){const b=
a.keyCode,c=a.shiftKey;b===w.a.Iq||b===w.a.P5?this.yWg(!!(1^c)):b===w.a.vY&&this.yWg(!!(0^c));a.preventDefault()}Lec(a){var b=a.keyCode;b===w.a.lq||b===w.a.NO?(b=document.activeElement,Array.contains(this.I3,b)&&b.click()):b===w.a.Z0&&this.hb.exit();a.preventDefault()}K3g(a,b){this.setPosition(a,b);this.ipi();this.show();this.Z3.focus();this.Ee.Hbh(new zx(ResourceStrings.L_ControlMenu))}setPosition(a,b){if(this.Z3){var c=this.Z3.offsetWidth,f=this.Z3.offsetHeight,l=this.K.clientHeight;a+c>this.K.clientWidth&&
(a-=c);b+f>l&&(b-=f);this.Z3.style.top=$e.a.Nc(b);this.Z3.style.left=$e.a.Nc(a)}}vK(a,b,c){const f=document.createElement("li");f.className="SlideshowContextMenuItem cui-ctl-mediumlabel";f.innerText=a;f.style.direction=c?"rtl":"ltr";f.tabIndex=1;this.fua.addHandler(f,ma.a.click,b);return f}CDb(){Aa.a.J(24133957,830,50,"SlideshowContextMenu.OnPrevClickHandler");this.hb.prev();this.hide();this.hb.restoreFocus()}xDb(){Aa.a.J(24133959,830,50,"SlideshowContextMenu.OnNextClickHandler");this.hb.next();this.hide();
this.hb.restoreFocus()}Umk(){Aa.a.J(24133961,830,50,"SlideshowContextMenu.OnGoToClickHandler");this.hide();ZC.nUj(this.hb,this.Qb.Hj())}uDb(){Aa.a.J(50602842,830,50,"SlideshowContextMenu.OnGridViewClickHandler");this.hide();this.ia.La(ba.a.oIb,2,null)}AHa(){Aa.a.J(40935580,830,50,"SlideshowContextMenu.OnFullscreenClickHandler");this.hb.GSe();this.hide();this.hb.restoreFocus()}Fec(){this.K9b.innerText=this.Nt.f8?ResourceStrings.L_ExitFullscreen:ResourceStrings.L_EnterFullscreen}tDb(){Aa.a.J(24133963,
830,50,"SlideshowContextMenu.OnExitClickHandler");this.hide();this.hb.exit()}Tlk(){Aa.a.J(50619421,830,50,"SlideshowContextMenu.OnEndLivePresentationClickHandler");this.hide();this.hb.restoreFocus();this.Rb&&this.Rb.instance&&this.Rb.instance.Rq&&this.Rb.instance.showEndSessionDialog(()=>{this.Rb.instance.GZb(4)},()=>{})}yWg(a){const b=document.activeElement,c=Array.indexOf(this.I3,b);a=this.I3[((-1===c?a?0:-1:a?c+1:c-1)+this.I3.length)%this.I3.length];void 0!==a&&null!==a&&(this.MFe(b),this.bR(a))}ipi(){this.I3.forEach(a=>
{this.MFe(a)})}bR(a){void 0!==a&&null!==a&&(Sys.UI.DomElement.addCssClass(a,"SlideshowContextMenuItemFocus"),a.focus(),this.Ee.Hbh(new zx(a.innerText)))}MFe(a){void 0!==a&&null!==a&&Sys.UI.DomElement.removeCssClass(a,"SlideshowContextMenuItemFocus")}}Object(e.a)($C,"SlideshowContextMenu",null,[992]);var $P=d(973),Ax=d(259);class FJ{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He){this.va=new ic.a;this.SD=null;this.Xre=this.Yre=this.$4c=this.lcc=-1;this.MFg=this.OFg=this.NFg=this.Mzb=
null;this.G7b="";this.o6c=this.e5c=-1;this.JMg=new Date(0);this.wMg="";this.iHg=null;this.RIg=this.Eab=this.Gke=this.Gme=!1;this.oGa=this.Io=this.Fc=null;this.E8b=-1;this.hIg=this.yIg=!1;this.Nt=a;this.hb=b;this.pda=c;this.Qb=fa;this.la=G;this.F1j=f;this.pi=l;this.ew=x;this.Ws=R;this.Xa=wa;this.Wy=Wa;this.Md=mb;this.$ua=Kb;this.Mc=nc;this.u6c=oc;this.lva=Ic;this.Wt=this.Ws.hF();this.NRg=this.la.pptEditorHermesSlideShowStartTimeout;this.ute=this.la.slideShowWaitForRehydrationTimeoutInMs;this.Mc.IB(Object(C.a)(this,
this.gB,"onSessionEnd"));this.Wy.NId(Object(C.a)(this,this.BDb,"onPodSessionUnavailable"));this.Mc.JB(Object(C.a)(this,this.to,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&(this.Wy.hob(Object(C.a)(this,this.oea,"onPodSessionRefreshed")),this.Wy.tFf(Object(C.a)(this,this.b$c,"onPodSessionRefreshedFromBrowser")));this.ia=Kc;this.Rb=Hc;this.Y4c=ie;this.Bl=He;a=document.createElement("div");a.id="HiddenFocusTrapAnchor";u.AFrameworkApplication.fa.ka("RegionComposerIsEnabled")||
u.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")?a.style.position="absolute":a.style.position="position: absolute";a.style.left="-10000px";a.style.top="auto";a.style.width="1px";a.style.height="1px";a.style.overflow="hidden";a.tabIndex=-1;this.Wt.insertBefore(a,this.Wt.firstChild)}dispose(){this.Mc.Oea(Object(C.a)(this,this.gB,"onSessionEnd"));this.Wy.ySk(Object(C.a)(this,this.BDb,"onPodSessionUnavailable"));this.Mc.Pea(Object(C.a)(this,this.to,"onSessionRehydrated"));this.la.allowDisablingSlideShowButtonDueToRehydration&&
(this.Wy.Ffb(Object(C.a)(this,this.oea,"onPodSessionRefreshed")),this.Wy.Afh(Object(C.a)(this,this.b$c,"onPodSessionRefreshedFromBrowser")))}Oyj(a,b,c,f){this.iHg=b;"Legacy"==this.hb.V2()&&this.hb.init(a,b,c,this.Xa.podSessionId);this.Fc=f;this.Io=new xz}V2(){return this.hb.V2()}g6b(){return!Ka.a.Va(this.G7b)}get G6d(){return this.Eab}set G6d(a){this.Eab=a}A5k(){this.hIg=!0}fkd(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){vf.Health.instance.addQosPillar("Present");this.g6b()&&Aa.a.J(512495816,830,15,"SlideshowManager:StartFrom starting a new SlideShow while one is already running");
u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&(this.oGa=fb.a.instance.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager"))&&this.oGa.bbb&&(this.E8b=b,this.ia.processAction(ba.a.Hjd,2,null),this.oGa.F6h(Object(C.a)(this,this.hpk,"onPresenterViewSyncMessageReceivedHandler")));const nc=c;this.la.pptEditorRehearsalSpeechClientEnabled&&(c=!1);this.lcc=wa;this.$4c=Date.now();const oc=document.createElement("div");oc.id="startingSlideshowHiddenDiv";oc.style.position="position: absolute";
oc.style.left="-10000px";oc.style.top="auto";oc.style.width="1px";oc.style.height="1px";oc.style.overflow="hidden";oc.tabIndex=-1;oc.setAttribute("aria-live","assertive");this.Wt.insertBefore(oc,this.Wt.firstChild);oc.innerText=ResourceStrings.l_StartingSlideShow;const Ic=R+wa.toString();this.G7b=Ic;this.$ua&&this.$ua.olc(!0);this.la.OPj&&this.u6c&&this.u6c.olc(!0);this.Io&&(this.Io.o3=c,this.Io.startingSlideIndex=b,this.Io.sJa=this.Qb.Hj(),this.Io.iZf=this.la.QOk);this.la.pptEditorVoiceUXEnabled&&
this.Y4c&&this.Y4c.init();this.la.pptEditorVoiceUXEnabled&&this.Bl&&this.Bl.execute(Hc=>{Hc.init()});this.pda.execute(Hc=>{Hc.init(this.Fc,this.Io)});this.NFg=this.Wt.style.top;this.Wt.style.top=$e.a.Nc(0);this.la.JSa&&(this.OFg=this.Wt.style.width,this.MFg=this.Wt.style.height,this.Wt.style.width="100%",this.Wt.style.height="100%");this.hb.show();this.SBg();this.la.Jth&&Er.a.fKb(!1);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.oGa&&this.oGa.bbb&&this.hb.INa(Object(C.a)(this,this.s$c,
"onSlideChangedHandler"));this.hb.sha(Object(C.a)(this,this.gma,"onExitHandler"));this.hb.dFf(Object(C.a)(this,this.AHa,"onFullscreenClickHandler"));this.hb.ABc(Object(C.a)(this,this.L2g,"onSlideshowReadyHandler"));this.hb.aFf(Object(C.a)(this,this.a9c,"onErrorHandler"));this.hb.BBc(Object(C.a)(this,this.Vva,"onSpecialKeyHandler"));this.hb.IId(Object(C.a)(this,this.a$c,"onPodSessionExpiredHandler"));this.hb.hFf(Object(C.a)(this,this.C9c,"onLogEndOfTranscriptionSessionHandler"));this.hb.gFf(Object(C.a)(this,
this.B9c,"onLiveSubtitlesDockedViewHandler"));this.hb.xFf(Object(C.a)(this,this.$dd,"recordQosErrorHandler"));this.la.allowDisablingSlideShowButtonDueToRehydration||(this.Wy.hob(Object(C.a)(this,this.oea,"onPodSessionRefreshed")),this.Wy.tFf(Object(C.a)(this,this.b$c,"onPodSessionRefreshedFromBrowser")));this.A6h(Object(C.a)(this,this.w9c,"onKeydownHandler"));c=Date.now();let Kc=!this.la.byg||Wa;Kc||(Kc=this.pi.VMc().$P());this.yIg=Kc;wa=Date.now();Aa.a.J(512495815,830,50,"SlideshowManager: Outbound decision time in {0} ms, fWaitForForceOutbound is {1}, fFailOverInProgress is {2}.",
wa-c,Kc?"True":"False",Wa?"True":"False");this.Yre=Date.now();this.pi.VMc().forceOutbound(()=>{Aa.a.J(512495814,830,50,"SlideshowManager: Will notify Replication Cache to flush unsaved revisions.");this.pi.flush(()=>{this.Xre=Date.now();Aa.a.J(512495813,830,50,"SlideshowManager: Finished flushing in {0} ms.",this.Xre-this.Yre);this.G7b===Ic&&Kc&&(Wa&&mb&&(Aa.a.J(512495812,830,50,"SlideshowManager: Refreshing the pod sessionId."),l=mb.fk,x=mb.podSessionId),this.Suh(a,b,f,l,x,G,R,fa,Kb,nc),Aa.a.J(512495811,
830,50,"SlideshowManager: Launched slideshow after ForceOutbound response."))},Hc=>{Aa.a.J(512495810,830,10,"SlideshowManager: Failed to make Replication Cache flush unsaved revisions. {0}",Hc.ServerError);return!1})},(Hc,ie)=>{Aa.a.J(512495809,830,10,"SlideshowManager: Failed to force outbound. {0}",ie)},null);this.G7b!==Ic||Kc||(this.Suh(a,b,f,l,x,G,R,fa,Kb,nc),Aa.a.J(512495808,830,50,"SlideshowManager: Launched slideshow without waiting for ForceOutbound."))}Suh(a,b,c,f,l,x,G,R,fa,wa=!1){const Wa=
zh.a.create().toString();this.la.dwg&&this.Nwk(c,l,G,Wa);const mb={};mb.SlideShowKind=this.hb.V2();mb.IsFrameNull=this.hb?"false":"true";mb.slideshowClickTimeMs=this.lcc;void 0!==window.performance.timing&&null!==window.performance.timing&&(mb.slideshowClickTimePerformanceAPI=this.lcc-window.performance.timing.navigationStart);Aa.a.J(590976135,830,15,JSON.stringify(mb));this.hb.fkd(a,b,f,l,x,G,R,Wa,this.lcc);0<this.NRg&&(this.e5c=window.setTimeout(Object(C.a)(this,this.hrk,"onStartSlideshowTimeoutHandler"),
this.NRg));this.Rb&&this.Rb.instance&&this.Rb.instance.v$c(a,b,c,f,l,x,G,u.AFrameworkApplication.hh,fa);this.Fc&&this.Fc.OZk();wa&&(this.Fc.Kh=!1);re.a("PresenterCoachTabFix")&&this.hb.Qlh()}Vva(a,b){if(b.key===w.a.Z0)Aa.a.J(512495779,830,50,"SlideshowManager.OnSpecialKeyHandler Esc key"),this.pda.execute(c=>{c.remove()}),this.hb.exit();else if(b.key===w.a.oLb)this.ia.La(ba.a.imd,2,null);else if(b.key===w.a.rpd&&this.la.Rja&&this.Fc&&this.Fc.aCa&&this.Io&&this.Qb&&!this.Io.o3&&this.la.vRj&&this.Fc.J3f)try{this.Fc.Kh&&
(Pi.a.aM("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Pi.a.JL)||Aa.a.J(512495778,822,10,"SlideShowManager::OnSpecialKeyHandler - Failed to set cookie for discoverability opt out to true"));this.Fc.Kh=!this.Fc.Kh;Aa.a.J(512495777,830,50,"SlideshowManager.OnSpecialKeyHandler m_subtitleContext FUseSubtitles is changed to: {0}",this.Fc.Kh);const c=document.getElementById("buttonSubtitle");if(c){const l=c.getElementsByTagName("span")[0].getElementsByTagName("img")[0];l&&(l.className=this.Fc.Kh?"prt2_SubtitleSlideShowToggleHover_40x40x32":
"prt2_SubtitleSlideShowToggleOff_40x40x32")}const f=!!this.Rb&&!!this.Rb.instance&&this.Rb.instance.Rq;if(f)this.hb.toggleTranscriberUIVisibility(null);else{let l=Date.now();this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,4,l,this.Io)}this.pda.execute(l=>{l.setToolbarButtonToggleState(Ah.a.SubtitlesButton,this.Fc.Kh);l.JC(Ah.a.CoachButton,!this.Fc.Kh&&!f)})}catch(c){Aa.a.J(512495776,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the J key: {0}",
c)}else if(b.key===w.a.eqc&&this.Rb&&this.Rb.instance&&this.Rb.instance.aCa&&this.Rb.instance.RQi&&this.Io&&!this.Io.o3)try{if(this.Rb.instance.Rq)this.Rb.instance.showWelcomeScreen();else{this.Rb.instance.Uba=!this.Fc.Kh;if(this.Fc.csb&&!this.Fc.Kh){this.Fc.Kh=!0;let c=Date.now();this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,5,c,this.Io);this.Fc.Kh=!1}this.Rb.instance.Imc(4,u.AFrameworkApplication.userSessionId,this.la.podsWebServiceBase,
this.Xa.podSessionId,u.AFrameworkApplication.hh)}}catch(c){Aa.a.J(512495775,830,50,"SlideshowManager.OnSpecialKeyHandler Exception thrown when pressing the L key: {0}",c)}}hpk(a,b){b&&(a=b.slideIndex,a!==this.E8b&&(this.E8b=a,this.hb.mRa(a)))}UWa(){Aa.a.J(512495774,830,50,"OnVisibilityChangeHandler: Full screen exited due to tab visibility change.");this.Gme=!0}Nwk(a,b,c,f){Aa.a.J(512495773,830,50,"SlideshowManager.PauseResumeMerge. correlationId: {0}",f);a=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked={2}",
a,b,!0);b={WaitForSessionTimeoutMs:"0"};b["X-UserSessionId"]=c;b["X-CorrelationID"]=f;b["X-WacCluster"]=this.iHg;this.ew.yj(a,2,null,b,!1,2,()=>{Aa.a.J(512495772,830,50,"SlideshowManager.PauseResumeMerge: Pause/resume merge succeeded. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},()=>{Aa.a.J(512495771,830,10,"SlideshowManager.PauseResumeMerge: Pause/resume merge failed. isPaused: {0}, userSessionId: {1}, correlationId: {2} ",!0,c,f)},null,void 0,void 0,void 0,void 0,Ax.a("14"))}sha(a){this.va.addHandler("OnExitSlideshow",
a)}Nea(a){this.va.removeHandler("OnExitSlideshow",a)}INa(a){this.va.addHandler("OnPositionChangeEventId",a)}Dfb(a){this.va.removeHandler("OnPositionChangeEventId",a)}A6h(a){this.Mzb||(this.Mzb=a,Ed.a.addHandler(window.document.body,"keydown",this.Mzb))}kGe(){this.Mzb&&(Ed.a.removeHandler(window.document.body,"keydown",this.Mzb),this.Mzb=null)}Fec(){if(this.Nt.f8)Aa.a.J(512495770,830,50,"SlideshowManager.OnFullscreenChangeHandler still in full screen");else{this.zPf();this.hb.pGe(Object(C.a)(this,
this.UWa,"onVisibilityChangeHandler"));Aa.a.J(512495769,830,50,"SlideshowManager.OnFullscreenChangeHandler: Leaving full screen mode.");var a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.FJ);a=!!a&&"teams"===a.toLowerCase();this.Gme||this.Gke||!document.hasFocus()||a||(Aa.a.J(512495768,830,50,"SlideshowManager.OnFullscreenChangeHandler: Exiting SlideshowFrame"),this.pda.execute(b=>{b.remove()}),this.hb.exit());this.Gme=!1}this.Gke=!1}s$c(a,b){b&&this.E8b!==b.slideIndex&&(this.E8b=b.slideIndex,
this.oGa.u1k(b))}gma(a,b){Aa.a.J(512495767,830,50,"SlideshowManager.OnExitHandler Exiting SlideShow.");this.bQf();var c=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var f of c)(c=document.getElementById(f))&&Sys.UI.DomElement.removeCssClass(c,"SlideShowAXItemNavigationFocusTrap");this.G7b="";this.$ua&&this.$ua.olc(!1);this.u6c&&this.u6c.olc(!1);this.Fc&&this.Fc.$Wk();this.hb.Nea(Object(C.a)(this,this.gma,"onExitHandler"));this.hb.ofh(Object(C.a)(this,
this.AHa,"onFullscreenClickHandler"));this.hb.Oed(Object(C.a)(this,this.L2g,"onSlideshowReadyHandler"));this.hb.lfh(Object(C.a)(this,this.a9c,"onErrorHandler"));this.hb.Ped(Object(C.a)(this,this.Vva,"onSpecialKeyHandler"));this.hb.pGe(Object(C.a)(this,this.UWa,"onVisibilityChangeHandler"));this.hb.mGe(Object(C.a)(this,this.a$c,"onPodSessionExpiredHandler"));this.hb.qfh(Object(C.a)(this,this.C9c,"onLogEndOfTranscriptionSessionHandler"));this.hb.pfh(Object(C.a)(this,this.B9c,"onLiveSubtitlesDockedViewHandler"));
this.hb.Gfh(Object(C.a)(this,this.$dd,"recordQosErrorHandler"));this.kGe(Object(C.a)(this,this.w9c,"onKeydownHandler"));(f=document.getElementById("startingSlideshowHiddenDiv"))&&f.parentNode.removeChild(f);this.la.allowDisablingSlideShowButtonDueToRehydration||(this.Wy.Ffb(Object(C.a)(this,this.oea,"onPodSessionRefreshed")),this.Wy.Afh(Object(C.a)(this,this.b$c,"onPodSessionRefreshedFromBrowser")));this.la.Jth&&(Er.a.fKb(!0),this.Nt.f8||gG.a.fYa(u.AFrameworkApplication.isRtl));this.zPf();Fs.exitFullscreen();
this.Wt.style.top=this.NFg;this.la.JSa&&(this.Wt.style.width=this.OFg,this.Wt.style.height=this.MFg);this.Ws.Fq();this.va.raiseEvent("OnExitSlideshow",b,a);this.Rb&&this.Rb.instance&&this.Rb.instance.Sqk();this.Io&&this.Io.o3&&b.summary&&this.ia.La(ba.a.qJa,2,b.summary);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")&&this.oGa&&this.oGa.bbb&&this.ia.processAction(ba.a.cFc,2,null);this.Io&&(this.Io.o3=!1);this.la.pptEditorVoiceUXEnabled&&this.Bl&&this.Bl.instance&&this.Bl.instance.remove();
this.la.pptEditorVoiceUXEnabled&&this.Y4c&&this.Y4c.remove();this.qql()}qql(){u.AFrameworkApplication.fa.ka("798")&&fb.a.instance.Ka("Common.ISystemInitiatedFeedback").execute(a=>{window.setTimeout(()=>{Aa.a.J(512495766,830,15,"Trigger NPS after slideshow");a.logActivity("AppUsageTimeSatisfiedNPS",null)},1E3)})}AHa(){this.Gke=!0;this.Nt.f8?Fs.exitFullscreen():this.SBg()}SBg(){this.Nt.W4b&&(this.Nt.GZ&&!this.SD&&(this.SD=Object(C.a)(this,this.Fec,"onFullscreenChangeHandler"),$addHandler(this.Wt,this.Nt.GZ,
this.SD)),this.Nt.requestFullscreen(this.Wt),this.hb.qFf(Object(C.a)(this,this.UWa,"onVisibilityChangeHandler")))}L2g(){this.bQf();var a=["WACInnerFrame","WACStatusBarContainer","WACDebugPanelFrame","ClipboardTarget","application_AssertiveNotifier"];for(var b of a)(a=document.getElementById(b))&&Sys.UI.DomElement.addCssClass(a,"SlideShowAXItemNavigationFocusTrap");if(-1!==this.$4c){b=Date.now();Aa.a.J(23098073,830,15,"slideshow ready in {0} ms",b-this.$4c);a={};a.SlideshowClickTimeMs=this.lcc;a.SlideshowStartTimeMs=
this.$4c;a.SlideshowStartFlushTimeMs=this.Yre;a.SlideshowFinishFlushTimeMs=this.Xre;a.SlideShowFinishedTimeMs=b;a.NoBlockingOutBoundSetting=this.la.byg;a.NoBlockingOutBound=!this.yIg;Aa.a.J(512495765,830,50,JSON.stringify(a));this.pda.execute(()=>{this.la.r5b&&this.hb.getCurrentSlideDimensions()});!this.la.tg||!this.la.c8g&&this.la.r5b||this.F1j.init(this.Fc,this.Io);b=!!this.Rb&&!!this.Rb.instance&&this.Rb.instance.lr&&this.Rb.instance.$Ba;a=!!this.Rb&&!!this.Rb.instance&&(this.Rb.instance.bQa||
this.Rb.instance.Rq);if((this.la.Rja||this.la.t6b)&&this.Fc&&this.Io&&this.Qb&&(this.Fc.Kh||this.Io.o3||b||a)&&this.Fc.J3f){const c=Date.now();let f=2;u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up&&(f=1);const l=this.Fc.Kh;b||a?(this.Fc.Kh||(f=5),this.Rb.instance.Uba=!this.Fc.Kh,this.Fc.Kh=!0):this.Rb&&this.Rb.instance&&(this.Rb.instance.Uba=!1);this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,f,c,this.Io);this.Fc.Kh=
l}b&&(this.Rb.instance.$Ba=!1);this.kGe(Object(C.a)(this,this.w9c,"onKeydownHandler"));this.hb.hfa(!1);this.hb.setOsfLocalStorage()}}w9c(a){27===a.keyCode&&(Aa.a.J(512495764,830,50,"SlideshowManager.OnKeydownHandler: Esc"),this.kGe(Object(C.a)(this,this.w9c,"onKeydownHandler")),this.pda.execute(b=>{b.remove()}),this.hb.exit())}C9c(a,b){a={};try{const c=ta.a.JK(b.vx);for(const f of c)try{a[f]=b.vx[f]}catch(l){Aa.a.J(512495763,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when adding transcription session telemetry value for key: {0}, exception: {1}",
f,l)}}catch(c){Aa.a.J(512495762,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when logging transcription telemetry. Exception: {0}",c)}Aa.a.J(512495761,830,50,JSON.stringify(a));try{!(this.Io&&this.Io.o3||!this.la.WAk||this.RIg)&&a.WebSocketConnectionDurationMS&&6E4<parseInt(a.WebSocketConnectionDurationMS.toString())&&(Aa.a.J(512495760,830,50,"Floodgate survey triggered for transcription."),this.RIg=!0,this.lva.continueWith(()=>{this.lva.result.logActivity("TranscriptionUsed",
"PPTTranscriptionFloodgateSurveyEnabled")}))}catch(c){Aa.a.J(512495759,830,10,"SlideshowManager.OnLogEndOfTranscriptionSessionHandler: Exception thrown when trying to trigger floodgate survey. Exception: {0}",c)}}B9c(a,b){this.la.r5b||((a=document.getElementById("slideshow-toolbar"))?b.i6b?"BelowSlide"===b.Fv?(a.style.bottom="15%",a.style.left="8%"):"AboveSlide"===b.Fv?(a.style.bottom="6px",a.style.left="8%"):(a.style.left="0%",a.style.bottom="6px",a.style.top="auto"):(a.style.left="0%",a.style.bottom=
"6px",a.style.top="auto"):Aa.a.J(512495758,830,10,"SlideshowManager.OnLiveSubtitlesDockedViewHandler: Can't find pptViewerAnchor-Met or slideshow-toolbar"))}a$c(a,b){Aa.a.J(512495757,830,50,"SlideshowManager.OnPodSessionExpiredHandler ErrorCode: {0}, Reason: {1}, request PodSessionId: {2}",b.code,b.reason,b.podSessionId);if(b.podSessionId!==this.Xa.podSessionId)Aa.a.J(512495756,830,15,"SlideshowManager.OnPodSessionExpiredHandler: Failing request PODS ID and m_sessionInfoOwner PODS ID do not match, so will return. m_sessionInfoOwner has a newer PODS ID: {0}, and this failing request is coming from an old PODS ID: {1}.",
this.Xa.podSessionId,b.podSessionId);else{if((a=this.la.slideShowErrorsThatTriggerRehydration)&&0<a.length&&a[0]){var c=new Date(this.JMg.getTime()+1E3*this.la.slideShowMinimumTimeBetweenRehydrationAttemptsInSec);const f=new Date,l=f>c;Aa.a.J(512495755,830,50,"SlideshowManager.OnPodSessionExpiredHandler: currentTime: {0} time after which rehydration is allowed: {1} canTriggerRehydration: {2}",f,c,l);if(l)for(c=0;c<a.length;c++){if(a[c]===b.code.toString()&&(Aa.a.J(512495754,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Error from Slideshow: {0}",
b.code),this.Md.es(Object.assign(new bg.a,{Code:223,Source:4}),b.podSessionId),0<this.ute)){Aa.a.J(512495753,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Triggered rehydration and will wait for {0} ms before calling the timeout handler.",this.ute);this.JMg=new Date;this.wMg=b.podSessionId;this.o6c=window.setTimeout(Object(C.a)(this,this.UOk,"rehydrationTimeout"),this.ute);return}}else if(this.wMg===b.podSessionId){Aa.a.J(512495752,830,50,"SlideshowManager.OnPodSessionExpiredHandler: A request to rehydrate the session based on the pod session id: {0} has already been sent. Wait for rehydration to complete.",
b.podSessionId);return}}u.AFrameworkApplication.jp(Jf.a.Qh(359));vf.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!1,!0,!1,null);this.la.podExitSlideshowOnError&&(Aa.a.J(512495751,830,10,"SlideshowManager.OnPodSessionExpiredHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.pda.execute(f=>{f.remove()}),this.hb.exit())}}a9c(a,b){a=String.format("Category: {0}, Code: {1}, SessionId: {2}, CorrelationId: {3}, Message: {4}, ExtraInfo: {5}, IsApiError: {6}",b.category,
b.code,b.sessionId,b.correlationId,b.message,b.Dy,b.sEj.toString());Aa.a.J(512495750,830,10,"SlideshowManager.OnErrorHandler: Error from Slideshow: {0}",a);u.AFrameworkApplication.jp(Jf.a.Qh(359));vf.Health.instance.recordQosError("SlideShowFailure",["SlideShowACE"],!1,!0,!0,!0,null);this.la.podExitSlideshowOnError&&(Aa.a.J(512495749,830,10,"SlideshowManager.OnErrorHandler: Will exit slideshow. Error from Slideshow: {0}",b.code),this.pda.execute(c=>{c.remove()}),this.hb.exit())}zPf(){this.SD&&(Aa.a.J(512495748,
830,50,"SlideshowManager.CleanupFullscreenChangeHandler"),$removeHandler(this.Wt,this.Nt.GZ,this.SD),this.SD=null)}hrk(){Aa.a.J(512495747,830,15,"SlideshowManager.OnStartSlideshowTimeoutHandler");u.AFrameworkApplication.jp(Jf.a.Qh(360));vf.Health.instance.recordQosError("SlideShowTimeout",["SlideShowACE"],!1,!0,!0,!0,null);this.pda.execute(a=>{a.remove()});this.hb.exit()}UOk(){Aa.a.J(512495746,830,15,"SlideshowManager.RehydrationTimeout");u.AFrameworkApplication.jp(Jf.a.Qh(371));vf.Health.instance.recordQosError("SlideShowWaitForRehydrationTimedOut",
["SlideShowACE"],!1,!0,!0,!0,null);this.pda.execute(a=>{a.remove()});this.hb.exit()}$dd(a,b){a=0<b.durationMs?Object.assign(new mk.a,{durationMs:b.durationMs}):null;vf.Health.instance.recordQosError(b.errorName,[b.vetoName],b.isIntentional,b.isInternal,b.alertOnPillar,b.isSessionEndingError,a)}oea(a,b){Aa.a.J(512495745,830,50,"SlideshowManager.OnPodSessionRefreshed: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration);
this.Eab=!1;this.gQf();this.g6b()||"Legacy"!=this.hb.V2()?(Aa.a.J(512495715,830,15,"SlideshowManager.OnPodSessionRefreshed: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.xX,this.Xa.fk),this.hb.refreshPodSession(b.xX,this.Xa.fk)):Aa.a.J(512495744,830,50,"SlideshowManager.OnPodSessionRefreshed: Skip updating due to not active.")}b$c(a,b){Aa.a.J(512495714,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration);this.Eab=!1;this.gQf();this.g6b()||"Legacy"!=this.hb.V2()?(Aa.a.J(512495712,830,15,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Refreshing PodSession. PodSessionId:{0}, WacCluster:{1}",b.xX,this.Xa.fk),this.hb.refreshPodSession(b.xX,this.Xa.fk)):Aa.a.J(512495713,830,50,"SlideshowManager.OnPodSessionRefreshedFromBrowser: Skip updating due to not active.")}to(){this.Eab=!1;Aa.a.J(512495711,830,50,"SlideshowManager.OnSessionRehydrated: Enabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",
this.la.allowDisablingSlideShowButtonDueToRehydration)}gB(){this.Eab=!0;Aa.a.J(512495710,830,50,"SlideshowManager.OnSessionEnd: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}BDb(){this.Eab=!0;Aa.a.J(512495709,830,50,"SlideshowManager.OnPodSessionUnavailable: Disabling the SlideShow button. AllowDisablingSlideShowButtonDueToRehydration: {0}",this.la.allowDisablingSlideShowButtonDueToRehydration)}bQf(){-1!==
this.e5c&&(window.clearTimeout(this.e5c),this.e5c=-1)}gQf(){-1!==this.o6c&&(window.clearTimeout(this.o6c),this.o6c=-1)}}Object(e.a)(FJ,"SlideshowManager",null,[325]);class aD{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){this.sua=this.O9b=this.Mcb=this.Lyb=this.kab=this.eUa=this.kAb=this.NAb=this.Io=this.Fc=this.ee=null;this.R9b=0;this.rL=!1;this.SD=null;this.hb=c;this.fe=f;this.qte=l;this.gf=G;this.Qt=R;this.Xa=wa;this.Nt=Wa;this.ia=a;this.Ha=b;this.soe=null;this.A8j=fa;this.Rb=x}init(a,b){this.ee=document.createElement("div");
this.ee.id="slideshow-toolbar";this.ee.className="SlideshowToolbar";this.gf.appendChild(this.ee);this.Fc=a;this.Io=b;this.Qt()?(this.NAb=this.Mqa("buttonPrevSlide","navigationButton navigationButtonRtl","SlideShowNextServer",ResourceStrings.L_Next),this.kAb=this.Mqa("buttonNextSlide","navigationButton navigationButtonRtl","SlideShowPrevServer",ResourceStrings.L_Previous)):(this.NAb=this.Mqa("buttonPrevSlide","navigationButton navigationButtonLtr","SlideShowPrevServer",ResourceStrings.L_Previous),
this.kAb=this.Mqa("buttonNextSlide","navigationButton navigationButtonLtr","SlideShowNextServer",ResourceStrings.L_Next));this.ee.appendChild(this.NAb);this.ee.appendChild(this.kAb);Ed.a.addHandler(this.NAb,ma.a.click,Object(C.a)(this,this.CDb,"onPrevClickHandler"));Ed.a.addHandler(this.kAb,ma.a.click,Object(C.a)(this,this.xDb,"onNextClickHandler"));this.O9b=this.Mqa("buttonEnterGridView","navigationButton navigationButtonLtr","GridView",ResourceStrings.L_GridView_SeeAllSlides);this.ee.appendChild(this.O9b);
Ed.a.addHandler(this.O9b,ma.a.click,Object(C.a)(this,this.uDb,"onGridViewClickHandler"));this.kab=this.eUa=null;this.Nt.zNf&&(this.eUa=this.Mqa("buttonEnterFullscreen","navigationButton navigationButtonLtr","SlideShowFullscreen",ResourceStrings.L_EnterFullscreen),this.kab=this.Mqa("buttonExitFullscreen","navigationButton navigationButtonLtr","SlideShowBackToWindow",ResourceStrings.L_ExitFullscreen),a=this.Nt.f8,this.eUa.style.display=a?te.a.Cf:te.a.Lk,this.kab.style.display=a?te.a.Lk:te.a.Cf,this.ee.appendChild(this.eUa),
this.ee.appendChild(this.kab),Ed.a.addHandler(this.eUa,ma.a.click,Object(C.a)(this,this.AHa,"onFullscreenClickHandler")),Ed.a.addHandler(this.kab,ma.a.click,Object(C.a)(this,this.AHa,"onFullscreenClickHandler")),this.Nt.GZ&&!this.SD&&(this.SD=Object(C.a)(this,this.Fec,"onFullscreenChangeHandler"),$addHandler(this.gf,this.Nt.GZ,this.SD)));this.Mcb=null;this.Fc.csb&&!this.Io.o3&&(this.Mcb=this.Mqa("buttonSubtitle","navigationButton navigationButtonLtr","SubtitleSlideShowToggleOff",ResourceStrings.L_UseSubtitles),
this.ee.appendChild(this.Mcb),Ed.a.addHandler(this.Mcb,ma.a.click,Object(C.a)(this,this.I$c,"onTranscribeHandler")));this.Lyb=this.Mqa("buttonExitSlideShow","navigationButton navigationButtonLtr","ExitSlideShowServer",ResourceStrings.L_EndShow);this.ee.appendChild(this.Lyb);Ed.a.addHandler(this.Lyb,ma.a.click,Object(C.a)(this,this.tDb,"onExitClickHandler"));this.sua=null;this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&!this.Io.o3&&(this.Rb.instance.mFf(Object(C.a)(this,this.Oec,"onLiveSessionStarted")),
this.Rb.instance.kFf(Object(C.a)(this,this.Nec,"onLiveSessionEnded")),this.Rb.instance.$5h(Object(C.a)(this,this.A0g,"onLiveCalloutDismissed")),this.Rb.instance.iFf(Object(C.a)(this,this.Mec,"onLiveRelaunchPausedSession")),this.Rb.instance.$5a?this.FUf():this.Rb.instance.P6h(Object(C.a)(this,this.C0g,"onLivePresenterResourcesLoaded")));this.rL=!1;this.hide();this.hb.sha(Object(C.a)(this,this.gma,"onExitHandler"));this.hb.BId(Object(C.a)(this,this.Pdb,"onBrowserEventHandler"));Ed.a.addHandler(this.ee,
ma.a.fq,Object(C.a)(this,this.Xdb,"onMouseOverHandler"));Ed.a.addHandler(this.ee,ma.a.ys,Object(C.a)(this,this.Qec,"onMouseOutHandler"))}show(){this.ee.style.display=te.a.Lk;window.clearTimeout(this.R9b);this.R9b=window.setTimeout(Object(C.a)(this,this.hide,"hide"),3E3);this.hb.hfa(!0)}hide(){this.rL||(window.clearTimeout(this.R9b),this.ee.style.display=te.a.Cf,this.hb.hfa(!1))}remove(){this.ee&&this.gf.contains(this.ee)&&(this.gf.removeChild(this.ee),this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&
(this.Rb.instance.vfh(Object(C.a)(this,this.Oec,"onLiveSessionStarted")),this.Rb.instance.ufh(Object(C.a)(this,this.Nec,"onLiveSessionEnded")),this.Rb.instance.ERk(Object(C.a)(this,this.A0g,"onLiveCalloutDismissed")),this.Rb.instance.hSk(Object(C.a)(this,this.C0g,"onLivePresenterResourcesLoaded")),this.Rb.instance.sfh(Object(C.a)(this,this.Mec,"onLiveRelaunchPausedSession"))),this.rL=!1)}JC(){}setToolbarButtonToggleState(){}gma(){this.hb.Nea(Object(C.a)(this,this.gma,"onExitHandler"));this.hb.gGe(Object(C.a)(this,
this.Pdb,"onBrowserEventHandler"));Ed.a.removeHandler(this.ee,ma.a.fq,Object(C.a)(this,this.Xdb,"onMouseOverHandler"));Ed.a.removeHandler(this.ee,ma.a.ys,Object(C.a)(this,this.Qec,"onMouseOutHandler"));Ed.a.removeHandler(this.NAb,ma.a.click,Object(C.a)(this,this.CDb,"onPrevClickHandler"));Ed.a.removeHandler(this.kAb,ma.a.click,Object(C.a)(this,this.xDb,"onNextClickHandler"));Ed.a.removeHandler(this.Lyb,ma.a.click,Object(C.a)(this,this.tDb,"onExitClickHandler"));this.sua&&Ed.a.removeHandler(this.sua,
ma.a.click,Object(C.a)(this,this.z0g,"onLiveBroadcastHandler"));this.Mcb&&Ed.a.removeHandler(this.Mcb,ma.a.click,Object(C.a)(this,this.I$c,"onTranscribeHandler"));this.eUa&&(Ed.a.removeHandler(this.eUa,ma.a.click,Object(C.a)(this,this.AHa,"onFullscreenClickHandler")),Ed.a.removeHandler(this.kab,ma.a.click,Object(C.a)(this,this.AHa,"onFullscreenClickHandler")),$removeHandler(this.gf,this.Nt.GZ,this.SD),this.SD=null);this.O9b&&Ed.a.removeHandler(this.O9b,ma.a.click,Object(C.a)(this,this.uDb,"onGridViewClickHandler"));
this.remove()}Pdb(){this.show()}Fec(){const a=this.Nt.f8;this.eUa.style.display=a?te.a.Cf:te.a.Lk;this.kab.style.display=a?te.a.Lk:te.a.Cf}Xdb(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?a.className.startsWith("prt2_SubtitleSlideShowToggleOff_40x40x32")&&(a.className=a.className.replace("Off_40x40x32","Hover_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle_40x40x32")&&(a.className=
a.className.replace("_40x40x32","Hover_40x40x32")):a.className=a.className.replace("_40x40x32","Hvr_40x40x32"),this.rL=!0}Qec(a){if(a=a.target)a.className.startsWith("prt2_SubtitleSlideShowToggle")?!this.Fc.Kh&&a.className.startsWith("prt2_SubtitleSlideShowToggleHover_40x40x32")&&(a.className=a.className.replace("Hover_40x40x32","Off_40x40x32")):a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggle")?this.Rb&&!this.Rb.instance.Rq&&a.className.startsWith("prt2_PresentLiveSlideshowToolbarToggleHover_40x40x32")&&
(a.className=a.className.replace("Hover_40x40x32","_40x40x32")):a.className=a.className.replace("Hvr_40x40x32","_40x40x32"),this.EWd()||(this.rL=!1);this.EWd()||this.hb.restoreFocus()}CDb(){Aa.a.J(23954837,830,50,"SlideshowToolbar.OnPrevClickHandler");this.LZa(this.NAb.title);this.hb.prev();this.hb.restoreFocus()}xDb(){Aa.a.J(23954839,830,50,"SlideshowToolbar.OnNextClickHandler");this.LZa(this.kAb.title);this.hb.next();this.hb.restoreFocus()}tDb(){Aa.a.J(23954841,830,50,"SlideshowToolbar.OnExitClickHandler");
this.LZa(this.Lyb.title);this.hb.exit()}AHa(){Aa.a.J(40449118,830,50,"SlideshowToolbar.OnFullscreenClickHandler");this.hb.GSe()}z0g(){this.Rb&&this.Rb.instance&&(this.LZa(this.sua.title),Aa.a.J(41231116,830,50,"FLiveBroadcastInUse is changed to: {0}",this.Rb.instance.Rq),this.Rb.instance.Rq?(this.hb.pausePresentation(),this.Rb.instance.showCallout(this.sua)):(this.Rb.instance.Imc(3,u.AFrameworkApplication.userSessionId,this.A8j,this.Xa.podSessionId,u.AFrameworkApplication.hh),this.Rb.instance.Uba=
!this.Fc.Kh,this.Fc.csb&&!this.Fc.Kh&&(Aa.a.J(41682897,830,50,"Starting subtitle in OnLiveBroadcastHandler for starting live session."),this.Fc.Kh=!0,this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,5,Date.now(),this.Io),this.Fc.Kh=!1)),this.nVe())}KSe(a,b){this.LZa(this.Mcb.title);const c=!!this.Rb&&!!this.Rb.instance&&this.Rb.instance.Rq,f=this.Fc.H3f&&5!==a&&!c;5!==a&&(this.Fc.Kh=!this.Fc.Kh);Aa.a.J(39682065,830,50,"SlideshowToolbar.ToggleTranscriber m_subtitleContext FUseSubtitles is changed to: {0}",
this.Fc.Kh);b&&(this.Fc.Kh?(b.className="prt2_SubtitleSlideShowToggleHover_40x40x32",f&&yz.OBg(this.hb,this.fe,this.Xa)):b.className="prt2_SubtitleSlideShowToggleOff_40x40x32");f||(b=Date.now(),c?this.hb.toggleTranscriberUIVisibility(null):this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,a,b,this.Io))}I$c(a){this.KSe(3,a.target)}uDb(){Aa.a.J(595204312,830,50,"SlideshowToolbar.OnGridViewClickHandler");this.ia.La(ba.a.oIb,2,null)}FUf(){this.sua||
(this.sua=this.Mqa("buttonLiveBroadcast","navigationButton navigationButtonLtr","PresentLiveSlideshowToolbarToggle",ResourceStrings.L_UseLiveBroadcast),this.ee.insertBefore(this.sua,this.Lyb),Ed.a.addHandler(this.sua,ma.a.click,Object(C.a)(this,this.z0g,"onLiveBroadcastHandler")))}Mqa(a,b,c,f){const l=document.createElement("div");l.id=a;l.className=b;if("buttonSubtitle"===a)return a=vo.createClusteredImageFromCluster(40,40,"SubtitleSlideShowToggle"+(this.Fc.Kh?"Hover_40x40x32":"Off_40x40x32"),"prt2",
this.fe.hk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,l;if("buttonLiveBroadcast"===a)return a=vo.createClusteredImageFromCluster(40,40,"PresentLiveSlideshowToolbarToggle"+(this.Rb&&this.Rb.instance&&this.Rb.instance.Rq?"Hover_40x40x32":"_40x40x32"),"prt2",this.fe.hk("prt2.png"),null,null,!0,null),l.appendChild(a),l.title=f,1===a.children.length&&(this.soe=a.children[0]),l;a=vo.createClusteredImageFromCluster(40,40,c+"_40x40x32","prt2",this.fe.hk("prt2.png"),null,null,!0,null);l.appendChild(a);
l.title=f;return l}LZa(a){Ka.a.Va(a)?Aa.a.J(23396621,830,15,"SlideshowToolbar::RaiseSlideshowNavigationToolbarClickedEvent, Toolbar title is null"):this.qte.Ibh(new zx(a))}EWd(){return!!this.Rb&&!!this.Rb.instance&&this.Rb.instance.fRi}nVe(){this.Rb&&this.Rb.instance&&this.soe&&(this.soe.className="prt2_PresentLiveSlideshowToolbarToggle"+(this.Rb.instance.Rq?"Hover_40x40x32":"_40x40x32"))}C0g(){this.FUf()}Oec(){this.nVe()}Nec(){this.Rb&&this.Rb.instance&&this.Rb.instance.Uba&&!this.Fc.Kh&&(Aa.a.J(41682899,
830,50,"Stopping subtitle for stopping live session."),this.hb.transcribe(u.AFrameworkApplication.userSessionId,this.Xa.podSessionId,this.Xa.fk,u.AFrameworkApplication.hh,5,Date.now(),this.Io));this.Rb.instance.Uba=!1;this.nVe()}Mec(){this.Rb&&this.Rb.instance&&(this.rL=!0,this.show(),this.hb.pausePresentation(),this.Rb.instance.showCallout(this.sua))}A0g(){this.rL=this.EWd();this.rL||(window.clearTimeout(this.R9b),this.R9b=window.setTimeout(Object(C.a)(this,this.hide,"hide"),3E3))}}Object(e.a)(aD,
"SlideshowToolbar",null,[991,992]);class hu{constructor(a){this.bzb=this.F9=this.bCb=null;this.ose="BelowSlide";this.mab=this.XHg=!1;this.u9b=!0;this.x_c=-1;this.wIg=this.h9b=this.Dke=!1;this.pqe=this.pse=this.rse=this.qse=null;this.la=a;u.AFrameworkApplication.fa.ff(Object(C.a)(this,this.Gm,"onFullAppSettingsReady"));a=Yd.b(u.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());this.mFg=a.Ring||"Unknown";this.EFg=u.AFrameworkApplication.buildVersion||"Unknown";this.WMg=this.la.UHa||
"Unknown";this.rTg=a.Host||"Unknown";this.qTg=a.WACDatacenter||"Unknown";this.IRg=this.G3i();this.Lcc=this.J3i();this.OSg=this.IPc();this.Syb=hu.aWe;switch(this.la.Tpl){case "ByUIHostName":a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.FJ);this.mab=!(!a||"teams"!==a.toLowerCase());break;case "ByAppIsEmmbeded":this.mab=u.AFrameworkApplication.isEmbedded;break;default:this.mab=u.AFrameworkApplication.fa.ka("IsUIEmbedMode")}Aa.a.J(40977669,822,50,"Initialized SubtitleContext with cookie: {0}, default position:{1}",
this.Syb,this.ose)}Gm(){this.bCb=this.getUserId();this.F9=u.AFrameworkApplication.fa.Ga("TenantId");this.bzb=this.la.hostAuthType||u.AFrameworkApplication.fa.Ga("HostAuthType")||"Unknown"}getUserId(){let a=u.AFrameworkApplication.fa.Ga("PptEditingUserId");Ka.a.Va(a)&&(a=u.AFrameworkApplication.fa.Ga("LoggableUserId"),Aa.a.J(593793674,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",Ka.a.Va(a)));return a}get e_b(){return this.XHg}set e_b(a){Aa.a.J(40407360,830,50,"SubtitleContext: Update FEnabledInBaseDoc to {0}",
a);this.XHg=a}get Kh(){return this.la.Rja&&this.e_b&&this.Syb&&!this.mab}set Kh(a){this.Syb!==a&&(this.Syb=a,hu.aWe=this.Syb)}get d_b(){return this.la.Rja&&this.h9b}set d_b(a){this.h9b!==a&&(this.h9b=a)}get b4f(){return this.wIg}get J3f(){return!this.mab}get isb(){return this.Dke}set isb(a){this.Dke!==a&&(this.Dke=a)}get csb(){return this.la.Rja&&this.e_b&&this.la.sRj&&!this.mab}get H3f(){const a=Pi.a.get("PPTLiveSubtitleEnabled");return this.la.Rja&&this.la.xRj&&Ka.a.Va(a)&&!this.mab}get AQe(){if(!this.pse){const b=
new Ha.a;var a=this.la.S7g;if(!Ka.a.Va(a)){a=a.split(",");for(const c of a)c.endsWith("*")||b.add(c)}this.pse=hu.AGf(b)}return this.pse}get zQe(){if(!this.pqe){const b=new Ha.a;var a=this.la.S7g;if(!Ka.a.Va(a)){a=a.split(",");for(const c of a)c.endsWith("*")&&b.add(c.replace("*"," ").trim())}this.pqe=hu.AGf(b)}return this.pqe}get cJb(){this.qse||(this.qse=Ka.a.Va(this.la.T7g)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(this.la.T7g,!0));return this.qse}get nPe(){this.rse||(this.rse=hu.n$h(this.cJb));
return this.rse}OZk(){this.x_c=this.Syb?1:0}$Wk(){-1!==this.x_c&&(this.Kh=1===this.x_c?!0:!1,this.x_c=-1)}G3i(){try{const a=sa.a.oe(u.AFrameworkApplication.lcid);if(!a)return Aa.a.J(41158484,822,15,"SubtitleContext::GetDefaultSpeechLanguage Getting the culture info returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),"en-us";const b=a.name.toLowerCase();for(let c of this.AQe)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;for(let c of this.zQe)if(0<=c.toLowerCase().indexOf(b.toLowerCase()))return b;
this.h9b=!0;return"en-us"}catch(a){Aa.a.J(41158486,822,10,"SubtitleContext::GetDefaultSpeechLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",u.AFrameworkApplication.lcid,a)}this.h9b=!0;return"en-us"}J3i(){try{const a=sa.a.oe(u.AFrameworkApplication.lcid);if(!a||Ka.a.Va(a.name))return Aa.a.J(41158488,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the culture info or culture info name returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),
"en";const b=a.name.toLowerCase();if(!Ka.a.Va(b)&&this.cJb[b])return b;const c=sa.a.oe(a.languageId);if(!c||Ka.a.Va(c.name))return Aa.a.J(41158490,822,15,"SubtitleContext::GetDefaultTranslationLanguage Getting the two-letter culture info returned null. Language lcid: {0}: ",u.AFrameworkApplication.lcid),"en";let f=c.name.toLowerCase();this.cJb[f]||(Aa.a.J(41972259,822,15,"SubtitleContext::GetDefaultTranslationLanguage No matching default language was found for the user's locale. Will default to English. User's culture info name: {0} User's culture info two letter name: {1} Language lcid: {2}: ",
b,f,u.AFrameworkApplication.lcid),f="en");return f}catch(a){Aa.a.J(41158492,822,10,"SubtitleContext::GetDefaultTranslationLanguage Exception thrown when trying to get the culture info for language lcid: {0}, exception: {1}.",u.AFrameworkApplication.lcid,a)}return"en"}IPc(){try{if(Ka.a.Va(this.Lcc))return Aa.a.J(41972290,822,10,"SubtitleContext::GetValueForTranslationLanguage m_translationLanguages is null. Language lcid: {0}",u.AFrameworkApplication.lcid),"en-us";const a=this.cJb[this.Lcc.toLowerCase()];
if(!Ka.a.Va(a))return a}catch(a){Aa.a.J(41972292,822,10,"SubtitleContext::GetValueForTranslationLanguage Exception thrown when trying to get the value for key: {0} language lcid: {1}, exception: {2}.",this.Lcc,u.AFrameworkApplication.lcid,a)}return"en-us"}g1i(a){if(Ka.a.Va(a))return Aa.a.J(595140824,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var b=a.split("-");if(!b.length)return Aa.a.J(595140822,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",
a),null;b=b[0];const c=this.cJb;var f=this.nPe;for(let l of f)if(f=c[l.toLowerCase()],f.startsWith(b))return f;Aa.a.J(595140820,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",a);return null}get yna(){return this.IRg}set yna(a){this.IRg=a;this.wIg=!0}get userId(){return this.bCb}set userId(a){this.bCb=a}get locale(){return this.WMg}set locale(a){this.WMg=a}get audienceGroup(){return this.mFg}set audienceGroup(a){this.mFg=
a}get buildVersion(){return this.EFg}set buildVersion(a){this.EFg=a}get identityProvider(){return this.bzb}set identityProvider(a){this.bzb=a}get wacHost(){return this.rTg}set wacHost(a){this.rTg=a}get wacDatacenter(){return this.qTg}set wacDatacenter(a){this.qTg=a}get tenantId(){return this.F9}set tenantId(a){this.F9=a}get bya(){return this.Lcc}set bya(a){this.Lcc=a}get Eib(){return this.OSg}set Eib(a){this.OSg=a}get Fv(){return this.ose}set Fv(a){this.ose=a}get okl(){const a={};a.UserId=this.userId;
a.TenantId=this.tenantId;a.AudienceGroup=this.audienceGroup;a.BuildVersion=this.buildVersion;a.IdentityProvider=this.identityProvider;a.Locale=this.locale;a.WacHost=this.wacHost;a.WacDatacenter=this.wacDatacenter;a.SubtitlesPosition=this.Fv;a.SpeechLanguage=this.yna;a.TranslationLanguages=this.Eib;a.FUseSubtitles=this.Kh;return JSON.stringify(a)}get aCa(){return this.u9b}set aCa(a){this.u9b=a}get YQi(){return 0<=this.la.pptEditorTranscribeRTLTranslationLanguages.indexOf(this.bya)}static get aWe(){const a=
Pi.a.get("PPTLiveSubtitleEnabled");return a?"true"===a.toLowerCase():!1}static set aWe(a){Pi.a.aM("PPTLiveSubtitleEnabled",a.toString(),Pi.a.JL)||Aa.a.J(40977672,822,10,"Failed to set cookie for use live subtitle to {0}",a.toString())}static AGf(a){const b={},c=new Ha.a;for(let f of a)try{const l=sa.a.oe(f).displayName;c.add(l);b[l]=f}catch(l){Aa.a.J(40423770,822,10,"SubtitleContext::AlphabetizeSpokenLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",f,l)}c.Sc((f,l)=>f.localeCompare(l));
a=new Ha.a;for(let f of c)f&&0<f.length&&a.add(b[f]);return a}static n$h(a){const b=ta.a.JK(a);a={};const c=new Ha.a;for(var f of b)try{const l=sa.a.oe(f).displayName;Ka.a.Va(l)?Aa.a.J(41972252,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Couldn't get display name for language code: {0}, language lcid: {1}.",f,u.AFrameworkApplication.lcid):(c.add(l),a[l]=f)}catch(l){Aa.a.J(40423772,822,10,"SubtitleContext::AlphabetizeSubtitleLanguagesByLocale Exception when trying to show language: {0}, e: {1}.",
f,l)}c.Sc((l,x)=>l.localeCompare(x));f=new Ha.a;for(let l of c)l&&0<l.length&&f.add(a[l]);return f}}Object(e.a)(hu,"SubtitleContext",null,[320]);const bD=()=>{var a=window.navigator.userAgent.toLowerCase();(a=-1!==a.indexOf("windows nt 6.3")&&-1!==a.indexOf("rv:11.0"))||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("windows")?(a=GJ(a,"msie (\\d+)"),a=!isNaN(a)&&10>=a):a=!1);a||(a=window.navigator.userAgent.toLowerCase(),-1!==a.indexOf("iphone")||-1!==a.indexOf("ipad")||-1!==a.indexOf("ipod")?
(a=GJ(a,"os (\\d+)_"),a=!isNaN(a)&&9>=a):a=!1);if(a||-1!==window.navigator.userAgent.indexOf("Windows NT 6.3; ARM"))return!1;try{const b=document.createElement("canvas");if(window.self.WebGLRenderingContext&&(b.getContext("webgl")||b.getContext("experimental-webgl")))return!0}catch(b){}return!1},GJ=(a,b)=>(a=(new RegExp(b)).exec(a))&&2<=a.length?parseInt(a[1]):Number.NaN;class HJ{constructor(a){this.Eo=a}Afi(){return bD()}zfi(){let a=!1;const b=this.Afi();if(b&&!this.Eo.zN(1))try{const c=document.createElement("canvas"),
f=c.getContext("2d");if(f){const l=new Image;l.src="data:image/svg+xml;charset=utf8,%3Csvg xmlns='http://www.w3.org/2000/svg'%3E%3C/svg%3E";f.drawImage(l,0,0,10,10);c.toDataURL("image/png");a=!0}}catch(c){}Aa.a.J(33595541,830,50,"IsRenderingSVGInWebGLSupported - {0}",{["Browser"]:this.Eo.zy,["SupportWebGL"]:b,["SupportSVGInWebGL"]:a});return a}}Object(e.a)(HJ,"WebGLHelperProxy",null,[319]);var IJ=d(633),aQ=d(697);class cD{constructor(){this.la=this.pb=this.K=null}get name(){return"PowerPointWebEditor.SlideShow"}Wb(a){this.K=
a;const b=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.pb=b.hF();this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.K.register(318,"PowerPointWebEditor.IFullscreenHelper").ma().na(()=>new xJ);this.K.register(319,"PowerPointWebEditor.IWebGLHelper").ma().na(()=>new HJ(this.K.resolve("Common.IBrowserUtils")));this.K.register(320,"PowerPointWebEditor.ISubtitleContext").ma().na(()=>new hu(this.la));this.K.register(321,"PowerPointWebEditor.IRehearsalContext").ma().na(()=>
new xz);this.u7b({["Type"]:"CheckBrowserStart"});a={};var c=this.sFj(a);const f=bD()&&this.la.QSa&&c&&this.rFj(),l=this.la.QSa&&this.qFj(),x=!f&&l;this.u7b({["Type"]:"CheckBrowserEnd",["IsSupportedBrowser"]:f||l,["IsModernWebGLSupportedBrowser"]:f,["IsModernSupportedBrowser"]:l,["IsBrowserShapeBuilderCompatible"]:c,["log"]:a,["useSvg"]:x});if(this.la.ka("DefaultToModernSlideShow")&&(f||l)){this.K.register(322,"PowerPointWebEditor.ISlideshowFrame").ma().na(()=>new aQ.SlideShowCoreFrame(this.pb,this.la,
this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Jv,this.K.Ka("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.Ka("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.IFullscreenHelper"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),x,this.K.resolve("PowerPoint.IPathManager"),this.K.Ka("Common.App.HostNotification.EditNotificationEventSource"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),
this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,u.AFrameworkApplication.Ge));const wa={};wa.loadScriptStart=Date.now();a=VC.a.create(u.AFrameworkApplication.Jj("powerpoint-slideshow-strings",3));ql.a.Kx(a);a=new Ha.a;c=this.K.resolve("Common.IDynamicScriptLoaderProvider").Jv;a.add(c.loadScript("SlideShowCore"));a.add(c.loadScript("PodsProxy"));a.add(c.loadScript("PPTSpeechClient"));Promise.all(a.toArray()).then(()=>{wa.loadScriptEnd=Date.now();const Wa={Type:"LoadedJS"};ta.a.forEach(wa,
(mb,Kb)=>{Wa[mb]=Kb},null);this.u7b(Wa);this.K.resolve("PowerPointWebEditor.ISlideshowFrame").preloadShaders();this.K.resolve("PowerPointWebEditor.ISlideshowFrame").init(u.AFrameworkApplication.buildVersion,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").fk,u.AFrameworkApplication.userSessionId,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId);this.K.resolve("PowerPointWebEditor.ISlideshowManager").A5k();this.K.Ka("PowerPointWebEditor.IRibbonUser").execute(mb=>{mb.JF()});
return null}).catch(Wa=>{this.u7b({["Type"]:"Error",["Reason"]:"FailedDownloadingResources"});Aa.a.J(512309318,830,10,"LoadSlideShowResources Failed to load the resources for SlideShowCore: {0}",Wa)})}else this.la.ka("DefaultToModernSlideShow")?this.u7b({["Type"]:"Fallback",["Reason"]:"UnSupportedBrowser"}):Aa.a.J(512309319,830,50,"PptDefaultToModernSlideShow is disabled"),this.K.register(322,"PowerPointWebEditor.ISlideshowFrame").ma().na(()=>new $P.SlideshowFrame(this.K.resolve("PowerPointWebEditor.IWebGLHelper"),
this.pb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),this.K.Ka("PowerPointLive.ILivePresenter"),this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.Ka("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("Common.IDynamicScriptLoaderProvider").Jv));this.K.register(YC,"PowerPointWebEditor.SlideShowFooterContainer").na(()=>new YC(this.pb,u.AFrameworkApplication.Ta));this.K.resolve("PowerPointWebEditor.SlideShowFooterContainer").ub();
let G;if(!this.la.r5b||this.la.c8g)this.K.register(aD,"PowerPointWebEditor.SlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().na(()=>new aD(u.AFrameworkApplication.Ta,this.la,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.Ka("PowerPointLive.ILivePresenter"),this.pb,()=>u.AFrameworkApplication.isRtl,this.la.podsWebServiceBase,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),
this.K.resolve("PowerPointWebEditor.IFullscreenHelper"))),this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");else{a=Wy.a(this.K);c=new Ha.a;c.add(a("slideshowToolbar"));this.la.GAk&&c.add(a("uiFabricLazy"));Promise.all(c.toArray()).catch(Wa=>Aa.a.J(50907106,830,10,"Failed to load the resources for the slideshowToolbar feature: {0}",Wa)).then(()=>this.$qk()).catch(Wa=>Aa.a.J(50907136,830,10,"Failed to load the React slideshowToolbar: {0}",Wa));this.la.isInkUIInSlideShowEnabled&&(a("inkButton").catch(Wa=>
Aa.a.J(51218050,830,10,"Failed to load the resources for the ink button feature: {0}",Wa)).then(()=>this.lnk()).catch(Wa=>Aa.a.J(51218052,830,10,"Failed to load the React ink button: {0}",Wa)),this.K.register(323,"PowerPointWebEditor.IInkButtonHelper").ma().na(()=>new yJ));if(this.la.pptEditorVoiceUXEnabled){const Wa=this;a("voiceUI").catch(mb=>Aa.a.J(595198419,830,10,"Failed to load the resources for the voice UI feature: {0}",mb)).then(()=>Wa.ark()).catch(mb=>Aa.a.J(595198417,830,10,"Failed to load the voice UI script: {0}",
mb));this.K.register(324,"PowerPointWebEditor.ISlideShowVoiceNotification").ma().na(()=>new EJ)}const wa=this;this.K.register(XC,"PowerPointWebEditor.ReactSlideshowToolbar").as("PowerPointWebEditor.ISlideshowToolbar").ma().na(()=>new XC(u.AFrameworkApplication.Ta,wa.la,wa.K.resolve("PowerPointWebEditor.ISlideshowFrame"),wa.K.resolve("PowerPoint.IPathManager"),wa.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),wa.K.Ka("PowerPointLive.ILivePresenter"),wa.pb,()=>u.AFrameworkApplication.isRtl,
wa.la.podsWebServiceBase,wa.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),wa.K.resolve("PowerPointWebEditor.IFullscreenHelper")))}G=this.K.Ka("PowerPointWebEditor.ISlideshowToolbar");const R=this;this.K.register($C,"PowerPointWebEditor.SlideshowContextMenu").na(()=>new $C(R.K.resolve("PowerPointWebEditor.ISlideshowFrame"),R.K.resolve("PowerPointWebEditor.IPresentationReader"),R.K.resolve("PowerPointWebEditor.IInputHandlerManager"),u.AFrameworkApplication.Ta,R.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),
R.pb,()=>u.AFrameworkApplication.isRtl,R.K.resolve("PowerPointWebEditor.IFullscreenHelper"),R.K.Ka("PowerPointLive.ILivePresenter")));const fa=this;this.K.register(325,"PowerPointWebEditor.ISlideshowManager").ma().na(()=>new FJ(fa.K.resolve("PowerPointWebEditor.IFullscreenHelper"),fa.K.resolve("PowerPointWebEditor.ISlideshowFrame"),G,fa.K.resolve("PowerPointWebEditor.SlideshowContextMenu"),fa.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),u.AFrameworkApplication.Ge,fa.la,b,fa.K.resolve("PowerPointWebEditor.IPresentationReader"),
fa.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),fa.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),fa.K.resolve("PowerPointWebEditor.IErrorHandler"),fb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),fa.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),fa.K.resolve("PowerPointWebEditor.IZoomContentFetcher"),Mn.a.Ju(fb.a.instance.Ka("Common.ISystemInitiatedFeedback")),u.AFrameworkApplication.Ta,fb.a.instance.Ka("PowerPointLive.ILivePresenter"),fa.K.resolve("PowerPointWebEditor.SlideShowFooterContainer"),
fa.K.Ka("PowerPointWebEditor.ISlideShowVoiceNotification")))}u7b(a){Aa.a.J(594583632,830,15,JSON.stringify(a))}rFj(){const a=this.la.Ga("PptModernSlideShowWebGLBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ga("SessionStartInfoJson").toString());Aa.a.J(512309317,830,50,"IsBrowserModernWebGLCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&parseInt(b.BrowserMajorVersion||
"",10)<parseInt(c.split(":")[1],10))return Aa.a.J(512309316,830,50,"IsBrowserModernWebGLCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}qFj(){const a=this.la.Ga("PptModernSlideShowBlockListForBrowserVersion").split(";"),b=JSON.parse(this.la.Ga("SessionStartInfoJson").toString());Aa.a.J(512309315,830,50,"IsBrowserModernCompatible Browser:{0}, BrowserMajorVersion:{1}",b.Browser,b.BrowserMajorVersion);for(const c of a)if(c.split(":")[0].toLowerCase()===(b.Browser||"").toLowerCase()&&
parseInt(b.BrowserMajorVersion||"",10)<parseInt(c.split(":")[1],10))return Aa.a.J(512309314,830,50,"IsBrowserModernCompatible Name {0}, Version {1}",b.Browser,b.BrowserMajorVersion),!1;return!0}sFj(a){return IJ.a(a)}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(C.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){wd.a.get_instance().gk(10,null).continueWith(()=>{if(!this.la.NS&&this.la.Z7g&&this.la.YBk)try{Mn.a.Ju(fb.a.instance.Ka("Common.ISystemInitiatedFeedback")).continueWith(a=>{a.result.logActivity("HasPresentButtonSeen",
"PresentTeachingUIEnabled")}),Aa.a.J(512495957,830,50,"Present Teaching UI triggered")}catch(a){Aa.a.J(512495956,830,10,"Exception thrown when trying to trigger Present teaching UI. Exception: {0}",a)}})}$qk(){this.K.resolve("PowerPointWebEditor.ISlideshowToolbar");return null}lnk(){this.K.resolve("PowerPointWebEditor.IInkButtonHelper");return null}ark(){this.K.resolve("PowerPointWebEditor.ISlideShowVoiceNotification");return null}dispose(){}static main(){m.a.instance.Bc(new cD)}}Object(e.a)(cD,"PPTWebEditorSlideShowPackage",
null,[2,3]);var bQ=d(759);class JJ{constructor(){this.T8b=null}pdl(a,b){Ej.UISurfaces.gN().then(c=>{this.T8b=a.jJi(c,a.zBi(b),b,this.T8b)});Aa.a.J(527303443,843,50,"{0} Toast is displayed",Object.getType(a).toString())}GPk(a){Ej.UISurfaces.gN().then(b=>{this.T8b=a.vPk(b,this.T8b)});Aa.a.J(523871965,843,50,"{0} Toast is removed",this.T8b)}}Object(e.a)(JJ,"DeferredNotificationCalloutVisibilityManager",null,[]);var KJ=d(994);const cQ=a=>{const b={featureArea:"Partial Presentation"};b.sourceContext=a;
a={};a.telemetryGroup=b;return a},dQ=(a,b,c,f)=>{const l=new Di.StandardDialog;l.yd=0;if(u.AFrameworkApplication.sE){const x=cQ(b);l.IHd(ResourceStrings.L_GiveFeedback,void 0,void 0,x)}l.nx(c,f,0,a?x=>{1===x?(Aa.a.J(526989467,830,50,"User selected Present Anyway in {0}",b),a()):Aa.a.J(526989468,830,50,"User selected Cancel in {0}",b)}:null)};class dD{constructor(a,b,c,f,l,x,G){this.F8={};this.bva=new ef.a;this.t3c=this.qqe=null;this.h2c=this.Doe=0;this.ZHg=!1;this.U2j=re.a("PartialDoc.SkipCheckGraphForPresentationDeferred");
this.B4c={};if(!G)throw Error.argumentNull("coreEventSource");this.CL=a;this.xq=c;this.CL.Yj(Object(C.a)(this,this.i2g,"onShapeNodePropertyChanged"));this.CL.tha(Object(C.a)(this,this.dfc,"onShapeNodeLoaded"));this.CL.rha(Object(C.a)(this,this.h2g,"onShapeNodeConnected"));this.QGg=new JJ;this.lh=l;b.qId(Object(C.a)(this,this.Vwe,"onClientError"));b.QId(Object(C.a)(this,this.Eye,"onServerError"));u.AFrameworkApplication.sBc(Object(C.a)(this,this.rxe,"onErrorDialogDisplayed"));this.cHg=f;this.Cka=x;
this.Ei=G;this.Ei.JB(Object(C.a)(this,this.Y1g,"onSessionRehydratedHandler"))}wEf(a,b){this.bva.Jb(a)||this.bva.$(a,new qa.a);const c=this.bva.ga(a);c.add(b);this.bva.$(a,c)}leh(a,b){if(this.bva.Jb(a)){var c=this.bva.ga(a);c.remove(b);this.bva.$(a,c);this.T5d(a)||this.bva.remove(a);uq.a(this.F8).length||Aa.a.J(520927263,843,50,"DeferredContentManager::RemoveFromSlideDeferredInfo - no more deferred content in document")}else Aa.a.J(524321747,843,15,"DeferredContentManager::RemoveFromSlideDeferredInfo - no deferred content on slideId:{0} shapeNodeId:{1}",
a,b)}T5d(a){return this.bva.Jb(a)&&0<this.bva.ga(a).count}LOf(a){if(a.slideId&&a.slideId.sid&&a.BXc){var b=a.BXc;a.h3?(this.ZHg||(this.ZHg=!0,Aa.a.J(555836314,843,50,"DeferredContentManager - deferred content detected: FForceShowDeferralUI: {0}",this.Cka)),b in this.F8||(this.F8[b]=new Date),this.wEf(a.slideId.sid.toString(),b)):b in this.F8&&(delete this.F8[b],this.leh(a.slideId.sid.toString(),b),Aa.a.J(520927262,843,15,"DeferredContentManager - Rehydration scenario, Node already in deferred list on load/connect."))}}dfc(a,
b){(a=Object(ua.a)(4,b.node))?this.LOf(a):Aa.a.J(557126034,843,10,"IDeferrable object is null")}h2g(a,b){(a=Object(ua.a)(4,b.node))?this.LOf(a):Aa.a.J(557126035,843,10,"IDeferrable object is null")}i2g(a,b){var c=Object(ua.a)(4,b.node);if(!c)Aa.a.J(557126873,843,10,"IDeferrable object is null");else if((b.property===sb.a.h3||this.Cka&&c.BXc in this.F8&&!c.h3)&&c.slideId)if(b=c.BXc,a=c.slideId.sid.toString(),c.h3)b in this.F8?Aa.a.J(557164308,843,15,"ShapeNode is already deferred:{0}, FForceShowDeferralUI: {1}",
b,this.Cka):(Aa.a.J(527720478,843,50,"ShapeNode is deferred:{0}, FForceShowDeferralUI: {1}",b,this.Cka),this.F8[b]=new Date,this.wEf(a,b));else{if(c=this.F8[b])c=(new Date).getTime()-c.getTime(),Aa.a.J(557164309,843,50,"ShapeNode:{0}, DeferredDurationMS:{1}, FForceShowDeferralUI:{2}",b,c,this.Cka),delete this.F8[b],this.leh(a,b),this.h2c=c>this.h2c?c:this.h2c;this.cHg&&!this.hasDeferredContent()&&(Aa.a.J(520471008,843,50,"All deferred blobs loaded"),this.Xpa("AllDeferredBlobsLoaded","true"),this.t3c&&
(Aa.a.J(520471007,843,50,"Previously called user requested actions triggered"),this.Xpa("PreviouslyDeferredActionsTriggeredOnBlobsLoad","true"),this.t3c(),this.QGg.GPk(this.qqe),this.qqe=this.t3c=null))}}Y1g(){Aa.a.J(520722338,843,50,"Session rehydrated with {0} currently deferred blobs",uq.a(this.F8).length)}JNe(a,b,c){this.cHg?(this.qqe=b,this.t3c=c,this.QGg.pdl(b,this.lh)):(c=Object(Ma.a)(KJ.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle:ResourceStrings.l_DeferredContentWaitDialogTitle,
b=Object(Ma.a)(KJ.a,b)?ResourceStrings.l_DeferredContentDownloadACopyWaitDialogMessage:ResourceStrings.l_DeferredContentWaitDialogMessage,dQ(null,a.toString(),c,b));Aa.a.J(526989469,801,100,"ShowDeferredContentWaitUI shown for :{0}",a)}Xpa(a,b){this.B4c[a]&&Aa.a.J(522269249,843,15,"DeferredContentManager - This action has been requested before. Key: {0}, Value: {1}",a,this.B4c[a]);this.B4c[a]=b}Vwe(a,b){this.recordError("ClientError",b)}Eye(a,b){this.recordError("ServerError",b)}rxe(a,b){(a=Object(ua.a)(bQ.a,
b))&&this.recordError("Crash",a.errorCode)}recordError(a,b){this.hasDeferredContent()&&Aa.a.J(556364418,843,15,"DeferredContentManager - Error while there is deferred content: ErrorType:{0}, ErrorInfo:{1}, FForceShowDeferralUI:{2}",a,b,this.Cka)}dispose(){this.CL.tm(Object(C.a)(this,this.i2g,"onShapeNodePropertyChanged"));this.CL.HXa(Object(C.a)(this,this.dfc,"onShapeNodeLoaded"));this.CL.Uma(Object(C.a)(this,this.h2g,"onShapeNodeConnected"));this.Ei.Pea(Object(C.a)(this,this.Y1g,"onSessionRehydratedHandler"));
this.log()}hasDeferredContent(){const a=uq.a(this.F8),b=(!this.U2j||this.Cka)&&0<a.length||0<this.xq.k5a;if(b){const c={};c.DeferredNodeCount=a.length.toString();c.DeferredBlobCount=this.xq.k5a.toString();c.FForceShowDeferralUI=this.Cka.toString();Aa.a.J(521175389,843,50,JSON.stringify(c));this.Doe=Math.max(this.xq.k5a,this.Doe)}return b}Qsj(a){return Qa.a.any(a,b=>b.hasDeferredContent)?(Aa.a.J(556312344,843,50,"{0} DeferredSlideCount: {1}, FForceShowDeferralUI: {2}","CutCopySlides",a.length,this.Cka),
!0):!1}S5d(a,b){return Qa.a.any(a,c=>c.h3)?(Aa.a.J(556312348,843,50,"{0} DeferredShapeCount: {1}, FForceShowDeferralUI: {2}",b,a.length,this.Cka),!0):!1}log(){const a=uq.a(this.F8),b={};b.MaxDeferredTime=this.h2c.toString();b.DeferredCountOnClose=a.length.toString();b.MaxNumberOfDeferredBlobs=this.Doe.toString();b.FForceShowDeferralUI=this.Cka.toString();Aa.a.J(556364419,843,15,"SessionLogs: {0}, PersistedLogs: {1}",JSON.stringify(b),JSON.stringify(this.B4c))}}Object(e.a)(dD,"DeferredContentManager",
null,[362]);class eD{constructor(){this.gw=this.K=null}get name(){return"PowerPointWebEditor.PartialDoc"}Wb(a){this.K=a;this.K.register(dD,"PowerPointWebEditor.DeferredContentManager").as("PowerPointWebEditor.IDeferredContentManager").ma().na(()=>new dD(this.K.resolve("Box4.Graph.IGraphInstance").vd(10),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),this.K.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),this.K.resolve("Common.IF6Manager"),
0<this.K.resolve("Common.IAppSettingsManager").Cc("ForceShowDeferralUIMS",0),this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource")))}init(){this.gw=this.K.resolve("PowerPointWebEditor.IDeferredContentManager")}dispose(){this.gw&&this.gw.dispose()}static main(){m.a.instance.Bc(new eD)}}Object(e.a)(eD,"PPTWebEditorPartialDocPackage",null,[2,3]);class Ev{constructor(a,b){this.shapeNode=a;this.position=b}}Object(e.a)(Ev,"MoveShapeData",null,[]);class LJ{constructor(a,b){this.ZN=null;this.fp=a;this.ia=
b}start(){this.ZN=[];for(let a=0;a<this.fp.length;++a)Array.add(this.ZN,new zc.a(this.fp[a].x,this.fp[a].y)),this.fp[a].tD(!1)}jNd(a,b){if(1!==a||this.fp.length!==b.length)return!1;for(a=0;a<b.length;a++)if(!this.DHj(b[a]))return!1;return!0}DHj(a){for(let b=0;b<this.fp.length;b++)if(a.$a.equals(this.fp[b].$a))return!0;return!1}perform(a){for(let c=0;c<this.fp.length;c++){var b=new zc.a(this.fp[c].x,this.fp[c].y);b=zc.a.add(b,a);this.fp[c].setPosition(b.x,b.y,!0)}}end(){this.ZN&&Aa.a.J(17597603,815,
50,"ShapeKeyboardDragManager::ShapeMoveAction - moving {0} shapes by ( {1}, {2} )",this.fp.length,this.fp[0].x-this.ZN[0].x,this.fp[0].y-this.ZN[0].y);const a=[];for(let b=0;b<this.fp.length;++b){const c=this.fp[b].AMc();Array.add(a,new Ev(this.fp[b].shapeNode,c));this.fp[b].Hz(!1)}this.ia.La(ba.a.hHa,2,a)}}Object(e.a)(LJ,"ShapeMoveAction",null,[1056]);class zz{constructor(a,b,c=null,f=null){this.G0=a;this.s0=b;this.dZb=c;this.JVg=f}}Object(e.a)(zz,"ResizeShapeData",null,[]);class MJ{constructor(a,
b){this.KEa=this.gyb=this.hse=null;this.FF=a;this.ia=b}start(){this.hse=[];this.gyb=[];this.KEa=[];for(const c of this.FF){c.YK=!0;c.tD(!1);Array.add(this.hse,c.AWa);Array.add(this.gyb,new Of.a);var a=c.Ssb(),b=zc.a.$l(a.ik(Sc.a.Bu),a.ik(Sc.a.gE));a=zc.a.$l(a.ik(Sc.a.Bu),a.ik(Sc.a.sH));Array.add(this.KEa,a?b/a:1);c.shapeNode.Jf&&c.shapeNode.isEditable&&(b=c,b.Fk&&(b.Fk.visible=!0))}}jNd(a,b){if(2!==a)return!1;for(a=0;a<b.length;a++)if(b[a].ll||!b[a].$a.equals(this.FF[a].$a))return!1;return!0}perform(a,
b){for(let f=0;f<this.FF.length;f++){var c=a;let l=b;({deltaX:c,deltaY:l}=this.dwl(c,l,f));let x;(x=this.gyb[f]).right=x.right+c;let G;(G=this.gyb[f]).bottom=G.bottom+l;this.FF[f].setOffsets(Of.a.add(this.hse[f],this.gyb[f]),!0);this.FF[f].shapeNode.Jf&&this.FF[f].shapeNode.isEditable&&(c=this.FF[f],c.w6d(),c.hRc())}}dwl(a,b,c){if(!this.FF[c].shapeNode.isAspectRatioLocked)return{deltaX:a,deltaY:b};b?a=b*this.KEa[c]:b=a/this.KEa[c];return{deltaX:a,deltaY:b}}end(){const a=[];for(let b=0;b<this.FF.length;b++)this.FF[b].ll||
(this.FF[b].shapeNode.Jf&&this.FF[b].shapeNode.isEditable||(this.FF[b].YK=!1),this.FF[b].Hz(!1),Array.add(a,new zz(this.FF[b].shapeNode,this.gyb[b])));this.ia.La(ba.a.Qfb,2,a);this.FF=null}}Object(e.a)(MJ,"ShapeResizeAction",null,[1056]);class wp{constructor(a,b){this.shapeNode=a;this.qXf=b%wp.sfc}}wp.sfc=360;Object(e.a)(wp,"ShapeRotateData",null,[]);class NJ{constructor(a,b){this.dGg=null;this.xfe=0;this.Qd=a;this.ia=b}start(){this.Qd.tD(!1);this.dGg=this.Qd.Ssb().Vf()}jNd(a,b){return 3===a&&!this.Qd.ll&&
this.Qd.$a.equals(b[0].$a)}perform(a){this.xfe=(this.Qd.rotation+a)%wp.sfc;this.Qd.setRotation(this.xfe,this.dGg)}end(){if(!this.Qd.ll){this.Qd.Hz(!1);var a=new wp(this.Qd.shapeNode,this.xfe);this.ia.La(ba.a.hkc,2,a)}}}Object(e.a)(NJ,"ShapeRotateAction",null,[1056]);class xp{constructor(a){this.WGa=this.pQ=null;this.ia=a}cpc(){this.WGa&&Nc.a.hqb(this.WGa);this.WGa=Nc.a.z$(Object(C.a)(this,this.R0f,"endAction"),xp.sji)}vVd(a,b){this.pQ&&!this.pQ.jNd(a,b)&&(this.pQ.end(),this.pQ=null);if(!this.pQ){this.pQ=
this.oZi(a,b);if(!this.pQ)throw Error.invalidOperation("Could not create keyboard action");this.pQ.start()}this.cpc();return this.pQ}R0f(){this.pQ&&(this.pQ.end(),this.pQ=null);this.WGa=null}move(a,b){a=this.vVd(1,a);b=this.XYf(b);a.perform(b)}resize(a,b){a=this.vVd(2,a);b=this.XYf(b);a.perform(b.x,b.y)}rotate(a,b,c){a=this.vVd(3,a);c=c?xp.jji:xp.iji;a.perform(b?c:-1*c)}XYf(a){let b=0,c=0;a.equals(Sc.a.north)?c=-1*xp.CDc:a.equals(Sc.a.east)?b=xp.CDc:a.equals(Sc.a.south)?c=xp.CDc:a.equals(Sc.a.west)&&
(b=-1*xp.CDc);return new zc.a(b,c)}oZi(a,b){return b?1===a?new LJ(b,this.ia):2===a?new MJ(b,this.ia):3===a&&(1<b.length&&Aa.a.J(17651872,815,15,"ShapeKeyboardDragManager::GetActionForType - Currently we don't support multi-shapes rotation, will only rotate the first shape by keyboard."),3===a)?new NJ(b[0],this.ia):null:null}}xp.sji=1E3;xp.CDc=1;xp.iji=15;xp.jji=1;Object(e.a)(xp,"ShapeKeyboardDragManager",null,[1003]);var Ag=d(153),Gs=d(537);const Qn=a=>{a&&Nc.a.Eb&&(Nc.a.Eb.ajg=a.Jf,Nc.a.Eb.Yvh=a.Og)};
var zq=d(242),OJ=d(491),Bx=d(319);class fD{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He){if(!Ic)throw Error.argumentNull("ISessionInfoOwner is null");if(!Kc)throw Error.argumentNull("IPPTUnitConversion is null");if(!Hc)throw Error.argumentNull("IZoomContext is null");oc||Aa.a.J(560321568,815,10,"ShapeManipulationActor constructor null WebSocketFrontDoor");this.ia=a;this.Af=b;this.$p=c;this.Fa=f;this.nb=l;this.G4c=x;this.Fb=G;this.Mb=R;this.Ea=fa;this.Ee=wa;this.ks=Kb;this.Vz=Wa;
this.W9j=mb;this.Ha=nc;this.V$b=new va.ScriptSharpLegacyMap;this.bWa=oc;this.Xa=Ic;this.hj=Kc;this.aj=Hc;this.yi=ie;this.Yta=He}ub(){this.ia.pa(ba.a.v4a,sc.a.application,Object(C.a)(this,this.dnj,"handleDeleteSelectedShapes"),4);this.ia.pa(ba.a.CYb,sc.a.application,Object(C.a)(this,this.enj,"handleDeleteShapes"),4);this.ia.pa(ba.a.hHa,sc.a.application,Object(C.a)(this,this.Woj,"handleMoveShapes"),4);this.ia.pa(ba.a.Qfb,sc.a.application,Object(C.a)(this,this.Vqj,"handleResizeShapes"),4);this.ia.pa(ba.a.hkc,
sc.a.application,Object(C.a)(this,this.z5d,"handleRotateShape"),4);this.ia.pa(ba.a.VXk,sc.a.application,Object(C.a)(this,this.vkg,"handleRotateShapeAnchor"),4);this.ia.pa(ba.a.WXk,sc.a.application,Object(C.a)(this,this.vkg,"handleRotateShapeAnchor"),4);this.ia.pa(ba.a.Xea,sc.a.application,Object(C.a)(this,this.wkg,"handleRotateShapeByDirection"),4);this.ia.pa(ba.a.Sih,sc.a.application,Object(C.a)(this,this.wkg,"handleRotateShapeByDirection"),4);re.a("FlipInMultiSelectEnabledV2")?(this.ia.pa(ba.a.Xfd,
sc.a.application,Object(C.a)(this,this.Djg,"handleFlipShape"),4),this.ia.pa(ba.a.Wfd,sc.a.application,Object(C.a)(this,this.Djg,"handleFlipShape"),4)):(this.ia.pa(ba.a.Xfd,sc.a.application,Object(C.a)(this,this.Ejg,"handleFlipShapeForSingleSelection"),4),this.ia.pa(ba.a.Wfd,sc.a.application,Object(C.a)(this,this.Ejg,"handleFlipShapeForSingleSelection"),4));this.ia.pa(ba.a.G4a,sc.a.application,Object(C.a)(this,this.Mmj,"handleCommitKeyboardShapeManipulation"),4);this.ia.pa(ba.a.Kdc,Bb.a.view,Object(C.a)(this,
this.nQc,"handleMoveShapesKeyboard"),4);this.ia.pa(ba.a.Ldc,Bb.a.view,Object(C.a)(this,this.nQc,"handleMoveShapesKeyboard"),4);this.ia.pa(ba.a.Mdc,Bb.a.view,Object(C.a)(this,this.nQc,"handleMoveShapesKeyboard"),4);this.ia.pa(ba.a.Ndc,Bb.a.view,Object(C.a)(this,this.nQc,"handleMoveShapesKeyboard"),4);this.ia.pa(ba.a.Tjc,Bb.a.view,Object(C.a)(this,this.vQc,"handleResizeShapesKeyboard"),4);this.ia.pa(ba.a.Ujc,Bb.a.view,Object(C.a)(this,this.vQc,"handleResizeShapesKeyboard"),4);this.ia.pa(ba.a.Vjc,Bb.a.view,
Object(C.a)(this,this.vQc,"handleResizeShapesKeyboard"),4);this.ia.pa(ba.a.Wjc,Bb.a.view,Object(C.a)(this,this.vQc,"handleResizeShapesKeyboard"),4);this.ia.pa(ba.a.dIe,Bb.a.view,Object(C.a)(this,this.wQc,"handleRotateShapeKeyboard"),4);this.ia.pa(ba.a.Zfd,Bb.a.view,Object(C.a)(this,this.wQc,"handleRotateShapeKeyboard"),4);this.ia.pa(ba.a.Yfd,Bb.a.view,Object(C.a)(this,this.wQc,"handleRotateShapeKeyboard"),4);this.ia.pa(ba.a.ikc,Bb.a.view,Object(C.a)(this,this.wQc,"handleRotateShapeKeyboard"),4);this.ia.pa(ba.a.DDe,
sc.a.application,Object(C.a)(this,this.k5d,"handleIsDirectManipulationEnabled"),97);this.ia.pa(ba.a.J8g,sc.a.application,Object(C.a)(this,this.kkg,"handlePreviewRotate"),4);this.ia.pa(ba.a.K8g,sc.a.application,Object(C.a)(this,this.kkg,"handlePreviewRotate"),4);this.ia.pa(ba.a.wXk,sc.a.application,Object(C.a)(this,this.Yqj,"handleRevertPreviewRotate"),4)}xe(){const a=this.Fa.Dc(Yb.a.Bg);a.bindAction(A.KeyInputManager.Na(w.a.P5,4),ba.a.Tjc);a.bindAction(A.KeyInputManager.Na(w.a.V$,4),ba.a.Ujc);a.bindAction(A.KeyInputManager.Na(w.a.Ifa,
4),ba.a.Vjc);a.bindAction(A.KeyInputManager.Na(w.a.vY,4),ba.a.Wjc);a.bindAction(A.KeyInputManager.Na(w.a.V$,5),ba.a.Yfd);a.bindAction(A.KeyInputManager.Na(w.a.Ifa,5),ba.a.ikc);a.bindAction(A.KeyInputManager.Na(w.a.V$,1),ba.a.dIe);a.bindAction(A.KeyInputManager.Na(w.a.Ifa,1),ba.a.Zfd);a.bindAction(A.KeyInputManager.Na(w.a.Una,0),ba.a.v4a);a.bindAction(A.KeyInputManager.Na(w.a.wH,0),ba.a.v4a);this.Fa.Dc(Yb.a.jj).bindAction(A.KeyInputManager.Na(w.a.V$,1),F.a.Ae)}Woj(a,b,c,f,l){if(!l||!Object(Ma.a)(Array,
l)||1>l.length)return 8;for(const G of l)if(b=G.shapeNode,this.QPa(b),b.get_smartArtModelId()&&(b=this.Ea.nr(b)),!this.CNf(b)||this.Af.Zc(G.shapeNode))return 16;if(1===c)return 32;if(Nc.a.Eb){Nc.a.Eb.Oj=!0;for(var x of l)if((c=x.shapeNode)&&(c.Jf||c.Og)){Qn(c);break}}x=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{x.kc(l[0].shapeNode);x.fd=a;const G=this.Mb.Fd;for(const R of l){const fa=new zc.a(G.Ff(R.position.x,0),G.Ff(R.position.y,1));nq.c(R.shapeNode.get_smartArtModelId()?this.Ea.nr(R.shapeNode):
R.shapeNode,fa.x,fa.y)}}finally{x&&x.dispose()}return 32}Vqj(a,b,c,f,l){if(!l||!Object(Ma.a)(Array,l)||1>l.length)return 8;for(b=0;b<l.length;b++){if(!this.MVb(l[b].G0))return Aa.a.J(17622101,815,15,"ShapeManipulationActor::ResizeShapes - Try to execute HandleResizeShapes when {0} shape is not resizable.",l[b].G0.get_shapeId()),16;if(this.Af.Zc(l[b].G0))return 16}if(1===c)return 32;if(Nc.a.Eb){Nc.a.Eb.Oj=!0;for(var x of l)if((c=x.G0)&&(c.Jf||c.Og)){Qn(c);break}}x=this.Fb.ud(15,void 0,()=>{this.nb.kj();
const G=this.Fa.ze;!G||G.name!==Yb.a.Bg&&G.name!==Yb.a.HC||this.Fa.Ad()});try{for(x.kc(l[0].G0),x.fd=a,a=0;a<l.length;a++)l[a].G0.Hph=l[a].s0}finally{x&&x.dispose()}if(this.nb.aL()&&(a=this.nb.UCa(),(a=this.Pk(a))&&Object(Ma.a)(Gs.a,a.Fk)&&Object(ua.a)(Gs.a,a.Fk).clearChildSelection(),this.bWa&&this.Ha.Ygl))for(const G of l)this.r1k(G);return 32}r1k(a){const b=a.G0;if(b&&b.Pf&&!b.Og){var c=Nc.a.Eb?Nc.a.Eb.actionId:zh.a.create().toString(),f=u.AFrameworkApplication.userSessionId,l=this.Xa.podSessionId,
x=this.Rgl,G=this.yhb,R=G/x,fa=Re.a.JX(this.hj.YL(a.s0.left,R),0),wa=Re.a.JX(this.hj.YL(a.s0.top,R),1),Wa=Re.a.JX(this.hj.YL(a.s0.right,R),0);a=Re.a.JX(this.hj.YL(a.s0.bottom,R),1);R=Math.abs(b.get_widthPersisted()+Wa-fa);var mb=Math.abs(b.get_heightPersisted()+a-wa);Wa=Cl.o(b.slideCid,b.slideSid);a=Cl.b(b.get_shapeId(),null);var Kb=Cl.f(Wa,a);fa=Cl.m((b.get_xPersisted()+fa).toString(),(b.get_yPersisted()+wa).toString());fa=Cl.n(R,mb,fa);fa=Cl.c(Kb,fa);wa=null;this.yi&&this.yi.highContrastColors&&
(wa=Cl.k(Cl.j(this.yi.highContrastColors.foregroundTextColor),Cl.j(this.yi.highContrastColors.backgroundColor),Cl.j(this.yi.highContrastColors.linkColor)));f=Cl.d(Wa,a,1,b.jh,0,0,c,f,this.yi.isInHighContrastMode,wa,this.Ha.Jlh&&this.Yta?this.Yta.S7i():null);l=Cl.e(f,[],l);l.editOps.push(fa);l=Cl.q(null,l,null,null,this.Xa.fk);f=Nc.a.rY();Nc.a.Eb&&f&&(Nc.a.Eb.Wa("editOpCorrelationId",c),Nc.a.Eb.Wa("editOpRequestStartTick",f.toString()));this.bWa.ux(l);Aa.a.J(561292930,815,50,"ShapeManipulationActor::HandleResizeShapes Sent SmartArtEditOpRequest; correlationId:{0}, slideSid:{1}, slideCid:{2}, shapeId:{3}, slideZoomFactor:{4}, slideImageZoom:{5}, SendKnownGlyphsForSmartArtResizeEditOp:{6}",
c,b.slideSid,b.slideCid,b.get_shapeId(),x,G,this.Ha.Jlh)}}get Rgl(){let a=this.aj.mG;this.$p&&this.$p.Ba&&this.$p.Ba.Fw&&null!=this.$p.Ba.Fw.Pr&&(a=this.$p.Ba.Fw.Pr);a||(Aa.a.J(561292931,815,15,"ShapeManipulationActor.SlideZoomFactor: zero slideZoomFactor"),a=1);return a}get yhb(){let a=1;if(this.$p&&this.$p.Ba){const b=Object(ua.a)(553,this.$p.Ba.sg(this.Mb.Ma));b?a=b.bW:Aa.a.J(561292932,815,15,"ShapeManipulationActor.SlideImageZoom: no active ISlideViewElement; imageZoom:{0}",a)}else Aa.a.J(561292933,
815,15,"ShapeManipulationActor.SlideImageZoom: no active slide; imageZoom:{0}",a);a||(Aa.a.J(561292934,815,15,"ShapeManipulationActor.SlideImageZoom: zero imageZoom"),a=1);return a}wkg(a,b,c,f,l){return 1===c?32:Ag.a("Rotate",a,()=>{Aa.a.J(50598791,822,50,"ShapeManipulationActor::HandleRotateShapeByDirection, Rotate operation performed");const x=this.nb.og();if(!x)return Aa.a.J(50598793,822,10,"ShapeManipulationActor::HandleRotateShapeByDirection, selected nodes: null"),16;this.W9j&&1===x.length&&
this.QPa(x[0]);switch(a){case ba.a.Xea:Aa.a.J(50598795,822,50,"ShapeManipulationActor::RotateLeft: Rotate Left is selected");for(const G of x)l=new wp(G,Math.round(G.get_shapeRotation()+270)),this.z5d(a,b,c,f,l);break;case ba.a.Sih:Aa.a.J(50598797,822,50,"ShapeManipulationActor::RotateRight: Rotate Right is selected");for(const G of x)l=new wp(G,Math.round(G.get_shapeRotation()+90)),this.z5d(a,b,c,f,l);break;default:return 8}return 32})}z5d(a,b,c,f,l){if(!l||!Object(Ma.a)(wp,l))return 8;b=l.shapeNode;
f=this.NVb(b);if(1===c)return f?32:8;if(!f||this.Af.Zc(b))return 16;Nc.a.Eb&&(Nc.a.Eb.Oj=!0,b&&(b.Jf||b.Og)&&Qn(b));c=this.Fb.ud(15,void 0,()=>{this.nb.kj();const x=this.Fa.ze;!x||x.name!==Yb.a.Bg&&x.name!==Yb.a.HC||this.Fa.Ad()});try{c.kc(b),c.fd=a,b.set_shapeRotation(l.qXf)}finally{c&&c.dispose()}return 32}vkg(){const a=this.nb.og();return 0<a.length&&this.DOj(a)?32:8}kkg(a,b,c){return this.Ha.fhc?1===c?32:Ag.a("HandlePreviewRotate:",a,()=>{var f=this.nb.og();for(const l of f){if(!l){Aa.a.J(562317533,
822,50,"HandlePreviewRotate, shape with shape id : {0} is null",l.get_shapeId());continue}if(l.qd)continue;this.V$b.Jb(l.get_shapeId())?this.V$b.$(l.get_shapeId(),l.get_shapeRotation()):this.V$b.add(l.get_shapeId(),l.get_shapeRotation());f=this.Pk(l);if(!f){Aa.a.J(562317534,822,50,"HandlePreviewRotate, shapeViewElement with shape id : {0} is null",l.get_shapeId());continue}const x=f.Ssb().Vf();switch(a){case ba.a.J8g:f.setRotation((l.get_shapeRotation()+270)%wp.sfc,x);break;case ba.a.K8g:f.setRotation((l.get_shapeRotation()+
90)%wp.sfc,x)}}return 32}):2}Yqj(a,b,c){if(!this.Ha.fhc)return 2;if(1===c)return 32;a=this.nb.og();for(const f of a)if(!f)Aa.a.J(562317535,822,50,"HandleRevertPreviewRotate, shape with shape id : {0} is null",f.get_shapeId());else if(!f.qd)if(a=this.Pk(f))if(b=a.Ssb().Vf(),this.V$b.Jb(f.get_shapeId()))a.setRotation(this.V$b.ga(f.get_shapeId()),b);else return Aa.a.J(562626886,815,10,"HandleRevertPreviewRotate: Revert Preview operation on the shape failed with id : {0}",f.get_shapeId()),8;else Aa.a.J(562317536,
822,50,"HandleRevertPreviewRotate, shapeViewElement with shape id : {0} is null",f.get_shapeId());return 32}dnj(a,b,c,f,l){b=this.nb.og();if(1===b.length&&this.nb.cC())return 16;f=1===b.length&&!!b[0]&&b[0].H8a();f=0<b.length&&!f;if(1===c)return f?32:8;if(!f)return 16;if(Nc.a.Eb){Nc.a.Eb.actionName="ClearPlaceholders";Nc.a.Eb.Oj=!0;for(const x of b)if(x.Jf||x.Og){Qn(x);break}}if(this.nb.aL()&&re.a("EnableSmartArtSubShapeDeletion")&&this.g5d(b[0],a,l))return 32;c=null;if(l=this.Ea.Y6a(b))re.a("SmartArtSubNodeEditing")?
c=this.Ea.nr(l):(this.nb.efd(l),b=this.nb.og());return this.CYb(a,b,this.nb.rn(),c)?32:16}enj(a,b,c,f,l){if(!l)return 1===c?8:16;b=this.$p.presentation;if(!b)throw Error.argumentNull("Presentation is null");l=Array.isArray(l.shapeNodes)?l.shapeNodes:null;if(!l)return 1===c?8:16;if(1===c)return 32;Nc.a.Eb&&(Nc.a.Eb.actionName="DeleteShapes",Nc.a.Eb.Oj=!0);return l.length&&this.CYb(a,l,Object(ua.a)(120,b.$B(l[0].slideId)))?32:16}CYb(a,b,c,f=null){if(!c||!b.length||this.Af.dC(b))return!1;let l=!1;for(var x of b)if(x.KDa){l=
!0;break}x=this.Fb.ud(15,void 0,()=>{this.nb.Uh()});try{f?x.gd(f):x.gd(c);x.fd=a;x.Dy[zq.a.wub]=l;for(const G of b)if(G&&G.Og){const R=this.Ea.ds(G);if(R){const fa=Ni.c(R,this.Mb.Ma);fa&&(fa.Fk.visible=!1)}}f?f.Qeh(b):c.gU(b)}finally{x&&x.dispose()}for(const G of b)this.ks.ybh(new OJ.a(G));return!0}Ejg(a,b,c){b=this.nb.og();const f=0<b.length?b[0]:null,l=1===b.length&&this.nNd(f);if(1===c)return l?32:8;if(!l||this.Af.Zc(f))return 16;this.QPa(f);for(const x of b)if(x.Jf||x.Og){Qn(x);break}return Ag.a("Rotate",
a,()=>{let x,G;switch(a){case ba.a.Wfd:G=f.get_isVerticallyFlipped();x=!f.get_isHorizontallyFlipped();break;case ba.a.Xfd:G=!f.get_isVerticallyFlipped();x=f.get_isHorizontallyFlipped();break;default:return 8}const R=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{R.kc(f),R.fd=a,f.set_isVerticallyFlipped(G),f.set_isHorizontallyFlipped(x)}finally{R&&R.dispose()}return 32})}Djg(a,b,c){const f=this.nb.og();b=!0;if(!f||f&&!f.length)b=!1;for(const G of f)if(b=this.nNd(G),!b)break;if(1===c)return b?
32:8;if(!b)return Aa.a.J(537499273,815,10,"ShapeManipulationActor:: HandleFlipShape shape horizontal flip change with no rotateable shape selected"),16;for(const G of f){if(this.Af.Zc(G))return 16;this.QPa(G)}for(const G of f)if(G.Jf||G.Og){Qn(G);break}const l=a===ba.a.Wfd,x=a===ba.a.Xfd;return l||x?Ag.a("Rotate",a,()=>{const G=Array(f.length),R=Array(f.length);for(var fa=0;fa<f.length;fa++)R[fa]=!!(x^f[fa].get_isVerticallyFlipped()),G[fa]=!!(l^f[fa].get_isHorizontallyFlipped());fa=this.Fb.ud(15,
void 0,()=>{this.nb.kj();this.Fa.Ad()});try{fa.kc(f[0]);fa.fd=a;for(let wa=0;wa<f.length;wa++)f[wa].set_isVerticallyFlipped(R[wa]),f[wa].set_isHorizontallyFlipped(G[wa])}finally{fa&&fa.dispose()}return 32}):(Aa.a.J(538589339,815,10,"ShapeManipulationActor:: HandleFlipShape Invalid request"),8)}Mmj(){this.G4c.R0f();return 32}nQc(a,b,c){const f=Ni.b(b);if(!f)return 16;b=this.nb.og();if(!b.length)return 16;let l=!0;const x=[];for(const G of b)if(G.get_smartArtModelId()){x.push(this.Ea.nr(G));break}else x.push(G);
for(const G of x)if(!this.CNf(G)){l=!1;break}if(1===c)return l?32:8;if(!l)return 16;c=Ni.d(x,f.Ma);if(this.Af.dC(b))return 16;switch(a){case ba.a.Kdc:a=Sc.a.south;break;case ba.a.Ldc:a=Sc.a.west;break;case ba.a.Mdc:a=Sc.a.east;break;case ba.a.Ndc:a=Sc.a.north;break;default:return 8}this.G4c.move(c,a);this.Vz&&this.nb.aL()&&(a=this.nb.UCa(),this.Ee.kfb(new Bx.a(a)));Nc.a.Eb&&(Nc.a.Eb.Oj=!0,Nc.a.Eb.WE=new Date);return 32}vQc(a,b,c){const f=Ni.b(b);b=this.nb.og();const l=[];for(var x of b){if(x.get_smartArtModelId()){this.nb.efd(x);
Array.add(l,this.Ea.nr(x));break}!x.isResizable||x.sI||x.qd||Array.add(l,x)}x=Ni.d(l,f.Ma);if(1===c)return 0<l.length?32:8;if(0>=b.length||this.Af.dC(l))return 16;switch(a){case ba.a.Tjc:a=Sc.a.south;break;case ba.a.Ujc:a=Sc.a.west;break;case ba.a.Vjc:a=Sc.a.east;break;case ba.a.Wjc:a=Sc.a.north;break;default:return 8}this.G4c.resize(x,a);this.Vz&&this.nb.aL()&&(a=this.nb.UCa(),this.Ee.kfb(new Bx.a(a)));Nc.a.Eb&&(Nc.a.Eb.Oj=!0,Nc.a.Eb.WE=new Date);return 32}wQc(a,b,c){var f=this.nb.og();const l=0<
f.length?f[0]:null,x=1===f.length&&this.NVb(l);if(1===c)return x?32:8;if(!x||this.Af.Zc(l))return 16;b=Ni.b(b);f=Ni.d(f,b.Ma);c=a===ba.a.Zfd||a===ba.a.ikc;a=a===ba.a.Yfd||a===ba.a.ikc;0<f.length&&f[0].shapeNode.Jf&&f[0].shapeNode.isEditable&&(b=f[0].shapeNode.sg(b.Ma))&&b.hRc();this.G4c.rotate(f,c,a);Nc.a.Eb&&(Nc.a.Eb.Oj=!0,Nc.a.Eb.WE=new Date);return 32}k5d(a,b,c,f,l){return l&&Object(Ma.a)(9,l)?this.Af.Zc(l)?16:32:8}DOj(a){for(const b of a)if(!this.NVb(b)&&!this.nNd(b))return!1;return!0}CNf(a){return!!a&&
a.uI&&a.MA&&!a.sI}MVb(a){return!!a&&a.isResizable&&a.MA&&!a.sI}NVb(a){return!!a&&a.ZK&&!a.sI}nNd(a){return!!a&&a.vIj&&!a.sI}Pk(a){return a?Object(ua.a)(121,a.oc(this.Mb.Ma)):null}QPa(a){a&&a.Mx&&(a=this.Pk(a))&&a.x0(!1)}g5d(a,b,c){return(a=this.Pk(a))&&Object(Ma.a)(Gs.a,a.Fk)&&(a=Object(ua.a)(Gs.a,a.Fk))?a.Mad(ba.a.Jz(b),c):!1}}Object(e.a)(fD,"ShapeManipulationActor",null,[]);var Fv=d(411),Qi=d(66);class gD extends Fv.DragSelectionDragAdapter{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){super(a,b,
c);this.ra=f;this.Fa=l;this.la=R;this.Ea=x;this.Tbk=G;this.wC=fa;this.Nb=wa;this.Wp=Wa;this.Jda=mb;this.tc=Kb;this.Yqc=this.Zqc=null}get LDc(){return this.Zqc}get KDc(){return this.Yqc}Du(a){for(var b=this.OTe(),c=a.Ac,f=c,l=this.wC.jI(f);!l&&f;){l=this.wC.jI(f);if(Sys.UI.DomElement.containsCssClass(f,"Outline")&&Sys.UI.DomElement.containsCssClass(f,"OutlineSized"))break;f=f.parentNode}l||Aa.a.J(39175171,820,15,"The element doesn't have a owner and it's parent don't have owner className: "+c.className+
" tagName: "+c.tagName);if(!b||!l)return!1;b=b.node;l=l.$a;c=this.Nb.Kc(l);if(b===l||c.af()&&c.h_a()===b){l=super.Du(a);if(!l)return l;this.Ea.j3(b)&&(c=this.tc.iN(Object(ua.a)(4,b)))&&c.Ap()&&(c=this.Jda.FXd(a.clientPoint,c,null,null))&&(f=c.oc(this.Ef.Ma),this.Ef.J5(a.clientPoint,f,c,this.Ef,a.shiftKey));null!==this.Wp&&(a=this.Ea.qd(b),this.Wp.Ywa(Qi.a.G$),a&&(this.Zqc=this.Jda.k1d(b),this.Yqc=this.Jda.Kcg(b)));return l}return!1}Yt(a){super.Yt(a);this.F1f();null!==this.Wp&&this.Wp.Cwa();this.LDc&&
(this.Zqc=null);this.KDc&&(this.Yqc=null)}Sn(a){super.Sn(a);this.F1f();null!==this.Wp&&this.Wp.Cwa();this.LDc&&(this.Zqc=null);this.KDc&&(this.Yqc=null)}ZCb(a,b,c){({Or:b,graphNode:c}=super.ZCb(a,b,c));if(this.la.Wyg&&(a=this.OTe())){const f=this.V1i(c);f&&f===a||(c=a,b=c.oc(this.Ef.Ma))}return{Or:b,graphNode:c}}Doc(a){let b=super.Doc(a);if(!b&&this.la.Wyg){let c=this.OTe();if(c&&this.Ea.qd(c.node)){const f=this.ra.Yo();this.Jda.iTc(a.clientPoint,f)&&(c=this.Jda.FXd(a.clientPoint,f,this.LDc,this.KDc))}c&&
(b=c.oc(this.Ef.Ma))}return b}V1i(a){return a?this.Ea.tn(a):null}OTe(){const a=this.Tbk.sfg(this.Ef.Ma);return!a||a.MG?null:this.ra.rq()}F1f(){(this.ra.JG()||this.ra.wu())&&this.Fa.Ad()}}Object(e.a)(gD,"PPTDragSelectionDragAdapter",Fv.DragSelectionDragAdapter,[1001,232]);class PJ{constructor(a,b,c){this.Ne=a;this.H8=b;this.tc=c}iTc(a,b){if(!a||!b)return!1;b=b.oc(this.Ne);return b?(b=ib.a.ei(b.htmlElement))?!!a&&!!b&&a.x>=b.x&&a.y>=b.y&&a.x<=b.x+b.width&&a.y<=b.y+b.height:!1:!1}FXd(a,b,c=null,f=null){return(a=
this.l5f(a,b,c,f))?a.Gy():null}l5f(a,b,c=null,f=null){if(!a||!b)return null;c&&f||(f=this.Kcg(b),c=this.k1d(b));if(!(c&&f&&c.length&&f.length))return null;var l=b.oc(this.Ne);if(!l)return null;var x=ib.a.ei(l.htmlElement);if(!x)return null;l=a.x-x.x;x=a.y-x.y;var G=0;for(a=0;a<c.length&&!(G+=c[a],G>=x);a++);for(G=x=0;G<f.length&&!(x+=f[G],x>=l);G++);a=Math.min(a,c.length-1);G=Math.min(G,f.length-1);return 0>a||a>=c.length||0>G||G>=f.length?null:b.jf(a,G)}k1d(a){if(a){a=this.tc.Zia(a);if(!a||!a.length)return null;
const c=a.length,f=Array(c);for(let l=0;l<c;l++){var b=a[l].oc(this.Ne);if(!b)return null;b=ib.a.ei(b.htmlElement);f[l]=b.height}return f}return null}Kcg(a){if(a){a=Nn.b(Object(ua.a)(lg.a,a));if(!a||!a.length)return null;const b=a.length,c=Array(b);for(let f=0;f<b;f++)c[f]=this.H8.Ie(a[f],0);return c}return null}}Object(e.a)(PJ,"PptTableDragSelectionHelper",null,[317]);var Pr=d(638),Az=d(331);class QJ{constructor(a,b,c,f,l,x,G){this.ta=this.zm=null;if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!f)throw Error.argumentNull("pageView");if(!l)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!x)throw Error.argumentNull("insertShapeOverlayViewElement");if(!G)throw Error.argumentNull("graphTopologyManager");this.ia=a;this.Hc=b;this.hj=c;this.Mb=f;this.nzb=l;this.wda=x;this.ua=G}mv(a){try{return a?a.dA===Sys.UI.MouseButton.rightButton?!1:2===this.nzb.drg?!0:!1:(Aa.a.J(512336010,822,10,"Event argument is null in isDragPossible for shapes"),
!1)}catch(b){throw Aa.a.J(512336009,822,10,"Exception {0} occured in isDragPossible for shapes",b),b;}}Du(a){try{if(!a)return Aa.a.J(512336008,822,10,"Event argument is null in OnDragStart for shapes"),!1;if(!this.mv(a))return!1;this.wda.Yk(Qi.a.RIb);this.zm=Pr.a(a.clientPoint,this.Hc.Gc);const b=new Of.a;b.left=this.zm.x;b.top=this.zm.y;b.bottom=this.zm.y+5;b.right=this.zm.x+5;a={};a.offsets=b;a.insertShapeActionId=this.wda.lvb;a.insertLocalShape=!0;if(32!=this.ia.La(ba.a.wSc,2,a))return!1;this.ta=
a.node;return!0}catch(b){throw Aa.a.J(512336007,822,10,"Exception {0} occured in OnDragStart for shapes",b),b;}}mw(a){try{if(!a)return Aa.a.J(512336006,822,10,"Event argument is null in OnDragMove for shapes"),!1;if(!this.Mb.isActive)return!1;const b=Pr.a(a.clientPoint,this.Hc.Gc),c=Pr.b(this.bmd(Math.min(this.zm.y,b.y)-this.zm.y),this.bmd(Math.max(this.zm.y,b.y)-this.zm.y-5),this.bmd(Math.min(this.zm.x,b.x)-this.zm.x),this.bmd(Math.max(this.zm.x,b.x)-this.zm.x-5));Object(ua.a)(Az.a,this.ta.oc(0)).setOffsets(c,
!0);return!0}catch(b){throw Aa.a.J(512336005,822,10,"Exception {0} occured in OnDragMove for shapes",b),b;}}Sn(a){try{if(a)if(this.zm){var b=Pr.a(a.clientPoint,this.Hc.Gc),c=Pr.b(Math.min(this.zm.y,b.y),Math.max(this.zm.y,b.y),Math.min(this.zm.x,b.x),Math.max(this.zm.x,b.x));a={};a.offsets=c;a.insertShapeActionId=this.wda.lvb;a.insertLocalShape=!1;this.IXf();this.ia.La(ba.a.wSc,2,a);this.rK()}else Aa.a.J(512336003,822,10,"m_dragBeginPosition should not be null in OnDragEnd for shapes");else Aa.a.J(512336004,
822,10,"Event argument is null in OnDragEnd for shapes")}catch(f){throw Aa.a.J(512336002,822,10,"Exception {0} occured in OnDragEnd for shapes",f),f;}}Yt(){this.rK()}dispose(){this.rK()}bmd(a){return this.hj.cM(a,this.Hc.Gc.bW)}rK(){this.zm=null;this.ta&&(this.IXf(),this.nzb.Ryh(0),this.ta=null)}IXf(){this.ua.Ba.gU([this.ta])}}Object(e.a)(QJ,"ShapeDrawDragAdapter",null,[232,106]);class Cx{constructor(a,b){this.oHg=null;this.Cyb=-1;this.Epe=a;this.K2j=b}Du(a){return this.h_g(a)?(this.Epe.Iad(),!0):
!1}mw(a){if(!a)return!1;this.K2j?(this.oHg=a,this.h_k()):this.mxe(a);return!0}Sn(a){this.$zh()&&this.y_f(0);this.e_g(a);this.Epe.$jc()}Yt(){this.$zh();this.c_g();this.Epe.$jc()}h_k(){-1===this.Cyb&&(this.Cyb=window.requestAnimationFrame(Object(C.a)(this,this.y_f,"dragMoveTask")))}$zh(){return-1!==this.Cyb?(window.cancelAnimationFrame(this.Cyb),this.Cyb=-1,!0):!1}y_f(){this.mxe(this.oHg);this.Cyb=-1}}Object(e.a)(Cx,"ShapeDragAdapter",null,[232]);class RJ extends Cx{constructor(a,b,c,f,l,x,G,R,fa,wa,
Wa,mb,Kb,nc,oc,Ic,Kc,Hc){super(nc,Ic);this.Y8b=0;this.V8b=this.fp=this.ZN=this.lHg=null;this.GFa=!1;this.Mb=a;this.ia=b;this.o_=c;this.Dq=f;this.yv=l;this.oC=x;this.nb=G;this.RD=R;this.wC=fa;this.Ea=wa;this.tc=Wa;this.Ee=mb;this.ncc=Kb;this.Wp=oc;this.Vz=Kc;this.Fp=Hc}mv(a){return this.tI(a).returnValue}tI(a){let b;var c=[];b=!1;if(!a||a.dA!==Sys.UI.MouseButton.leftButton||this.oC.ZZ)return{returnValue:!1,Hdc:c,H6b:b};const f=Object(ua.a)(554,this.wC.jI(a.Ac));if(!f||!f.M$d(a.Ac))return{returnValue:!1,
Hdc:c,H6b:b};if((b=f.isSelected)||f.shapeNode.Og){c=[];a=Object(ua.a)(121,this.wC.jI(a.Ac));a.shapeNode.Jf&&this.nb.UXf(a.shapeNode);a=this.nb.og();for(const l of a)if(l.get_smartArtModelId()){c.push(this.Ea.nr(l));break}else c.push(l);c=Ni.d(c,this.Mb.Ma);for(const l of c)if(!this.cvg(l))return{returnValue:!1,Hdc:c,H6b:b}}else{if(!this.cvg(f))return{returnValue:!1,Hdc:c,H6b:b};Array.add(c,f)}return{returnValue:!0,Hdc:c,H6b:b}}cvg(a){return a&&a.$a&&a.$a.uI&&a.$a.MA&&!a.shapeNode.sI&&32===this.ia.La(ba.a.DDe,
1,a.$a)?!0:!1}h_g(a){var b;let c;if(!({Hdc:b,H6b:c}=this.tI(a)).returnValue)return!1;this.ia.processAction(ba.a.G4a,2);this.lHg=zc.a.rQa(a.clientPoint);this.V8b=Object(ua.a)(554,this.wC.jI(a.Ac));null!==this.o_&&this.o_.Yk(3);if(!this.V8b||!b||!b.length)return!1;null!==this.Wp&&this.Wp.Ywa(Qi.a.Cxa);this.V8b.shapeNode.Mx||(this.nb.kj(),this.RD.Ad());for(a=0;a<b.length;++a)this.ZAc(b[a]);c||(this.nb.setSelection(rd.SelectionFactory.gl(this.fp[0].$a)),this.yv.Yv());for(b=0;b<this.fp.length;++b)this.fp[b].tD(!0);
this.GFa=1<this.fp.length?!1:!0;this.Y8b=Date.now();this.Vz&&this.nb.aL()&&this.Ee.wEe();this.Fp&&this.ia.processAction(E.a.Dia,2);return!0}ZAc(a){this.fp||(this.fp=[]);this.ZN||(this.ZN=[]);Array.add(this.fp,a);Array.add(this.ZN,new zc.a(a.x,a.y))}mxe(a){if(a){var b=this.gOc(zc.a.rQa(a.clientPoint),this.lHg);a=null;var c=this.GFa&&!this.V8b.shapeNode.Mx;for(let f=0;f<this.fp.length;++f)a=zc.a.add(this.ZN[f],b),this.fp[f].setPosition(a.x,a.y,!c);b=this.ncc.b2g(!1,this.GFa,this.fp[0],null);c&&!b&&
a&&this.fp[0].setPosition(a.x,a.y,!0)}}gOc(a,b){a=zc.a.yU(a,b);return new zc.a(this.Dq.Hm(a.x),this.Dq.Hm(a.y))}e_g(a){const b=[];for(var c=0;c<this.fp.length;++c){var f=this.fp[c].AMc();Array.add(b,new Ev(this.fp[c].shapeNode,f));this.fp[c].Hz(!1);if(f=this.tc.iN(this.fp[c].shapeNode))f=f.Ap(),Aa.a.J(512497684,815,50,"Drag to move table, isComplexTable:{0}",f)}this.V8b.shapeNode.Mx||(c={},a&&a.mc&&a.mc.rawEvent&&(c[si.a.YBa]=a.mc.rawEvent.timeStamp),this.ia.La(ba.a.hHa,2,b,c));1===b.length&&(Aa.a.J(512497683,
815,50,"ShapeMoveDragAdapter - moving shape {0} - timespan by {1}",this.fp[0].shapeNode?this.fp[0].shapeNode.sr:"",(Date.now()-this.Y8b).toString()),this.Vz&&this.nb.aL()&&(a=this.nb.UCa(),this.Ee.kfb(new Bx.a(a))));this.u2()}c_g(){if(this.fp){for(let a=0;a<this.fp.length;++a)this.fp[a].setPosition(this.ZN[a].x,this.ZN[a].y,!0),this.fp[a].Hz(!0);this.u2()}}u2(){this.ncc.f2g(this.GFa);null!==this.o_&&this.o_.q0();this.Mb.hR();this.ZN=this.fp=null;null!==this.Wp&&this.Wp.Cwa()}}Object(e.a)(RJ,"ShapeMoveDragAdapter",
Cx,[]);class hD{constructor(a){this.GZc=this.z_=this.$_=this.Kac=this.J_=null;this.Qd=a}Q5k(a,b,c,f,l){this.J_=a;this.Kac=b;this.$_=c;this.z_=f;this.GZc=l}}Object(e.a)(hD,"ResizeShapesCalculationData",null,[]);var iD=d(615);class Jk{static XMd(a,b,c,f,l){return f?Jk.XMf(a,c):Jk.eki(a,b,c,l)}static XMf(a,b){const c=new Of.a;if(a.equals(Sc.a.Bu)||a.kwb(Sc.a.Bu))c.left=b.x,c.top=b.y;else if(a.equals(Sc.a.uE)||a.kwb(Sc.a.uE))c.right=b.x,c.bottom=b.y;return c}static eki(a,b,c,f){b=a.G4b()?Jk.Vji(a,b,c,
f):Jk.gki(a,b,c);c=new Of.a;if(a.kwb(Sc.a.north)||a.equals(Sc.a.north))c.top=-1*b.y;if(a.kwb(Sc.a.east)||a.equals(Sc.a.east))c.right=b.x;if(a.kwb(Sc.a.south)||a.equals(Sc.a.south))c.bottom=b.y;if(a.kwb(Sc.a.west)||a.equals(Sc.a.west))c.left=-1*b.x;return c}static Vji(a,b,c,f){var l=b.ik(a),x=b.ik(a.m6a()),G=b.ik(a.zVi());a=b.ik(a.AVi());var R=new zc.a(l._x+c.x,l._y+c.y);const fa=iD.b(x,G,R);b=iD.b(x,a,R);c=Jk.eOd(x,G,fa);l=Jk.eOd(x,a,b);b=zc.a.$l(b,R);R=zc.a.$l(fa,R);G=zc.a.$l(x,G);x=zc.a.$l(x,a);
f?(x||(Aa.a.J(8959632,822,10,"ResizeHelper - shape has height 0"),x=1),G||(Aa.a.J(8959634,822,10,"ResizeHelper - shape has width 0"),G=1),f=G/x,!R||b/R>f?(b<Jk.d2&&(b=Jk.d2),R=b/f,R<Jk.d2&&(R=Jk.d2,b=R*f)):(R<Jk.d2&&(R=Jk.d2),b=R*f,b<Jk.d2&&(b=Jk.d2,R=b/f))):(b<Jk.d2&&(b=Jk.d2),R<Jk.d2&&(R=Jk.d2));return new zc.a(b*c-G,R*l-x)}static gki(a,b,c){var f=a.iOc();a=a.Dtb();f=b.ik(f);var l=b.ik(a);b=b.ik(a.m6a());a=zc.a.l7a(f,l);a.IL(c.x,c.y);c=iD.b(b,f,a);a=zc.a.$l(b,c);l=zc.a.$l(f,b);a<Jk.d2&&(a=Jk.d2);
f=a*Jk.eOd(b,f,c)-l;return new zc.a(f,f)}static eOd(a,b,c){return b._x!==a._x?0>(c._x-a._x)/(b._x-a._x)?-1:1:0>(c._y-a._y)/(b._y-a._y)?-1:1}}Jk.d2=6;Object(e.a)(Jk,"ResizeHelper",null,[]);class Hs extends Cx{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic){super(Wa,nc);this.hka=this.F_=this.NFa=this.kge=this.lge=this.Qd=this.FF=null;this.GFa=!1;this.HQ=this.yQ=null;this.Mb=a;this.ia=b;this.oC=c;this.vVa=f;this.RD=l;this.wC=x;this.hj=G;this.Ee=R;this.Ea=fa;this.ncc=wa;this.Vz=oc;this.Wp=mb;this.De=
Kb;this.Fp=Ic}mv(a){if(!a||a.dA===Sys.UI.MouseButton.rightButton)return!1;this.HQ=[];this.Qd=Object(ua.a)(121,this.wC.jI(a.Ac));if(!this.Qd||!this.Qd.CD(a.Ac))return!1;a=this.Qd.shapeNode;if(!a||!a.isResizable||this.oC.ZZ)return!1;this.FF=[];if(a.Ky)Array.add(this.FF,this.Qd);else{var b=this.vVa.Yd();(b=this.Ea.Y6a(b))&&this.vVa.efd(b);a.Jf&&this.vVa.UXf(a);b=this.vVa.og();this.FF=Ni.d(b,this.Mb.Ma)}if(this.Ea.j3(this.Qd.shapeNode))Array.add(this.HQ,new hD(this.Qd));else for(const c of this.FF){if(!this.wPj(c))return this.HQ=
null,!1;c.shapeNode.isResizable&&!c.shapeNode.qd&&Array.add(this.HQ,new hD(c))}return!0}wPj(a){return 32!==this.ia.La(ba.a.DDe,1,a.$a)||this.oC.ZZ||!a.aQ?!1:!0}h_g(a){if(!a||!this.mv(a))return!1;this.vVa.kj();this.RD.Ad();this.ia.processAction(ba.a.G4a,2);this.hka=this.Qd.p0b();if(!this.Qd.CD(a.Ac))return!1;null!==this.Wp&&this.Wp.Ywa(Qi.a.RIb);this.yQ=this.Beg(this.Qd.CD(a.Ac),this.Qd,this.hka,!1);this.NFa=this.Lqa(a.clientPoint);({width:this.lge,height:this.kge}=this.gNf(this.hka,this.Qd.shapeNode.a_));
this.F_=new zc.a(0,0);for(const c of this.HQ){var b=c.Qd.p0b();a=c.Qd;let f,l;({width:f,height:l}=this.gNf(b,this.Qd.shapeNode.a_));const x=this.Beg(this.yQ,a,b,!0);c.Q5k(b,a.AWa,f,l,x);a.YK=!0;a.tD(!0);b=Ni.c(a.shapeNode,this.Mb.Ma);a.shapeNode.Jf&&b.Fk&&(b.Fk.visible=!0)}this.GFa=this.Ea.j3(this.Qd.shapeNode)?!0:1<this.FF.length?!1:!0;this.Vz&&this.vVa.aL()&&this.Ee.wEe();this.Fp&&this.ia.processAction(E.a.Dia,2);return!0}mxe(a){if(a){var b=this.Lqa(a.clientPoint),c=zc.a.yU(b,this.NFa);this.F_=
zc.a.add(this.F_,this.Ceg(c,this.hka,!1));var f=null;c=this.GFa&&!this.Qd.shapeNode.Mx;for(const l of this.HQ){let x=new zc.a(l.$_/this.lge*this.F_.x,l.z_/this.kge*this.F_.y);new Of.a;if(l.Qd.shapeNode.Ky){this.Qd.shapeNode.Ky&&(x=this.F_);if(!l.GZc)continue;f=Jk.XMf(l.GZc,x)}else f=Jk.XMd(l.GZc,l.J_,this.Ceg(x,l.J_,!0),l.Qd.shapeNode.Ky,l.Qd.shapeNode.isAspectRatioLocked||a.shiftKey);f=Of.a.add(l.Kac,this.s6f(f,l.J_));l.Qd.setOffsets(f,!c);l.Qd.shapeNode.Jf&&l.Qd.shapeNode.isEditable&&l.Qd.w6d()}this.NFa=
b;a=this.ncc.b2g(!0,this.GFa,this.Qd,this.yQ);c&&!a&&f&&this.Qd.setOffsets(f,!0)}}s6f(a,b){if(this.Ea.j3(this.Qd.shapeNode))return a;const c=new Of.a;c.left=b.VTc?a.right:a.left;c.right=b.VTc?a.left:a.right;c.top=b.Z8a?a.bottom:a.top;c.bottom=b.Z8a?a.top:a.bottom;return c}e_g(a){const b=[];for(var c=0;c<this.HQ.length;c++){let f=Of.a.yU(this.HQ[c].Qd.AWa,this.HQ[c].Kac);f=this.s6f(f,this.HQ[c].J_);Array.add(b,new zz(this.HQ[c].Qd.shapeNode,f,this.yQ,this.F_));this.HQ[c].Qd.shapeNode.Jf&&this.HQ[c].Qd.shapeNode.isEditable||
(this.HQ[c].Qd.YK=!1);this.HQ[c].Qd.Hz(!1)}this.Qd.shapeNode.Mx?Cb.App.Hb.updateCommandUI():(c={},a&&a.mc&&a.mc.rawEvent&&(c[si.a.YBa]=a.mc.rawEvent.timeStamp),this.Ea.j3(this.Qd.shapeNode)?(this.Qd.VBa(),this.ia.La(ba.a.Whh,2,b,c)):this.ia.La(ba.a.Qfb,2,b,c));this.Vz&&this.vVa.aL()&&(a=this.vVa.UCa(),this.Ee.kfb(new Bx.a(a)));this.rK()}c_g(){if(this.HQ){for(const a of this.HQ)a.Qd.setOffsets(a.Kac,!0),a.Qd.YK=!1,a.Qd.Hz(!0);this.rK()}}rK(){this.ncc.f2g(this.GFa);this.hka=this.kge=this.lge=this.Qd=
this.FF=this.HQ=this.yQ=this.F_=this.NFa=null;null!==this.Wp&&this.Wp.Cwa()}gNf(a,b){let c;var f=b?this.RZd(a):a;c=zc.a.$l(f.ga(0),f.ga(1));f=zc.a.$l(f.ga(0),f.ga(3));b||(a=we.a.sO(zc.a.pG(a.ga(0),a.ga(1))),Math.floor((a+45)/90)%2&&(a=f,f=c,c=a),c||(Aa.a.J(17622149,822,10,"ShapeResizeDragAdapter - shape {0} has width 0",this.Qd.shapeNode.sr),c=1),f||(Aa.a.J(17622151,822,10,"ShapeResizeDragAdapter - shape {0} has height 0",this.Qd.shapeNode.sr),f=1));return{width:c,height:f}}Beg(a,b,c,f){if(b.shapeNode.Ky){if(this.Qd.shapeNode.Ky)return a;
if(a.equals(Sc.a.gE)||a.equals(Sc.a.sH))return null;if(a.equals(Sc.a.Bu)||a.equals(Sc.a.uE))return c.ga(0).x>c.ga(1).x?a.m6a():a;if(b.shapeNode.a_){f=we.a.sO(zc.a.pG(c.ga(0),c.ga(1)));if(a.equals(Sc.a.north)||a.equals(Sc.a.south))return Math.abs(f-90)<Hs.oac||Math.abs(f-270)<Hs.oac?c.ga(0).y<c.ga(1).y?a:a.m6a():null;if(a.equals(Sc.a.east)||a.equals(Sc.a.west))if(Math.abs(f-180)<Hs.oac||360-f<Hs.oac||f<Hs.oac)return c.ga(0).x<c.ga(1).x?a:a.m6a()}return null}c=zc.a.pG(c.ga(0),c.ga(1));c=Math.floor((c+
Math.PI/4)/(Math.PI/2));for(b=0;b<c;b++)a=f?a.iOc().iOc():a.Dtb().Dtb();return a}Ceg(a,b,c){if(this.Qd.shapeNode.Ky||this.Ea.j3(this.Qd.shapeNode))return a;var f=zc.a.pG(b.ga(0),b.ga(1));const l=Math.floor((f+Math.PI/4)/(Math.PI/2))%4;f=b.ga(3-l);b=b.ga(3>l?2-l:3);f=zc.a.pG(f,b);return c?new zc.a(Math.cos(f)*a.x-Math.sin(f)*a.y,Math.sin(f)*a.x+Math.cos(f)*a.y):new zc.a(Math.cos(f)*a.x+Math.sin(f)*a.y,Math.cos(f)*a.y-Math.sin(f)*a.x)}Lqa(a){var b=this.Qd.g2(this.hj.Hm(a.x)),c=this.Qd.g2(this.hj.Hm(a.y));
if(this.Ea.j3(this.Qd.shapeNode)){c=this.yQ;this.yQ.G4b()||(c=c.Dtb());b=this.De.ei(this.Qd.$Na);b.x+=sf.a.Fid;b.y+=sf.a.Fid;b.width-=2*sf.a.Fid;b.height-=2*sf.a.Fid;var f=th.a.Zba(b);b=f.ik(c);f=f.ik(c.m6a());c=b.y<=f.y?Math.min(a.y,f.y):Math.max(a.y,f.y);b=this.Qd.g2(this.hj.Hm(b.x<=f.x?Math.min(a.x,f.x):Math.max(a.x,f.x)));c=this.Qd.g2(this.hj.Hm(c))}return new zc.a(b,c)}RZd(a){const b=zc.a.l7a(a.ga(0),a.ga(3));a=zc.a.l7a(a.ga(1),a.ga(2));return new th.a(new zc.a(b.x,b.y),new zc.a(a.x,b.y),new zc.a(a.x,
a.y),new zc.a(b.x,a.y))}}Hs.oac=3;Object(e.a)(Hs,"ShapeResizeDragAdapter",Cx,[]);var SJ=d(190);class Bz{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.Xne=this.rpe=null;this.Jac=0;this.$qe=this.Zbc=null;this.AZc=0;this.HNg=8;this.vPg=4;this.y0j="AngleUIRendered";this.aH=this.Qd=null;this.Mb=a;this.ia=b;this.oC=f;this.o_=c;this.ra=l;this.RD=x;this.wC=G;this.hj=R;this.lc=fa;this.fe=wa;this.Wp=Wa;this.Fp=mb;this.tFa=Kb}mv(a){if(!a||a.dA!==Sys.UI.MouseButton.leftButton||this.oC.ZZ)return!1;this.Qd=
Object(ua.a)(121,this.wC.jI(a.Ac));return this.Qd&&this.Qd.Pbe(a.Ac)?(this.aH=this.Qd.shapeNode)&&this.aH.ZK&&this.Qd.aQ?!0:!1:!1}Du(a){if(!a||!this.mv(a))return!1;this.ra.kj();this.RD.Ad();this.ia.processAction(ba.a.G4a,2);null!==this.Wp&&this.Wp.Ywa($e.a.GP(this.fe.hk("rotatehandlecursor.cur"),Qi.a.Ivh));this.Jac=this.aH.get_shapeRotation();this.Zbc=this.Qd.p0b().Vf();this.$qe=this.Qd.Ssb().Vf();this.rpe=this.Lqa(a.clientPoint);this.Qd.Nja=!0;this.tFa&&this.tLe(!0);this.Qd.tD(!0);this.Fp&&this.ia.processAction(E.a.Dia,
2);return!0}mw(a){if(!a)return!1;this.Xne=this.Lqa(a.clientPoint);if(!this.Xne)return!1;this.AZc=we.a.sO(zc.a.pG(this.Xne,this.Zbc))-we.a.sO(zc.a.pG(this.rpe,this.Zbc));let b=this.Jac+this.AZc;this.tFa&&(b=this.guh(b));this.Qd.setRotation(Math.round(b),this.$qe);this.tFa&&(a=this.Lqa(a.clientPoint,!1),this.gyl(a,Math.round(b)));return!0}guh(a){return this.Xdi(a)?10*Math.round(a/10):a}Xdi(a){0>a&&(a=(a+360)%360);return(a+this.vPg/2)%90<=this.vPg?!0:!1}gyl(a,b){var c=this.lc.ig(this.Qd.$a);c=Ni.e(c,
this.Mb.Ma);c.kkc.pB(2);c.kkc.setPosition(a.x+this.HNg,a.y+this.HNg);c.kkc.xa.style.position="absolute";0>b&&(b+=360);c.kkc.xa.innerText=(b%360).toString()+"\u00b0"}tLe(a){const b=this.lc.ig(this.Qd.$a);Ni.e(b,this.Mb.Ma).kkc.Ld(a)}Sn(a){this.tFa&&this.tLe(!1);this.Qd.Nja=!1;this.Qd.Hz(!1);var b=this.Jac+this.AZc;this.tFa&&(b=this.guh(b));b=new wp(this.aH,Math.round(b));const c={};a&&a.mc&&a.mc.rawEvent&&(c[si.a.YBa]=a.mc.rawEvent.timeStamp);this.tFa&&(c[this.y0j]=1);this.ia.La(ba.a.hkc,2,b,c);this.u2()}Yt(){this.Zbc&&
(this.Qd.setRotation(this.Jac,this.$qe),this.tFa&&this.tLe(!1),this.Qd.Nja=!1,this.Qd.Hz(!0),this.u2())}Lqa(a,b=!0){var c=this.lc.ig(this.Qd.$a);return(c=Ni.e(c,this.Mb.Ma).mB)?(a=zc.a.rQa(SJ.a.HQa(a,c)),b?new zc.a(this.Qd.g2(this.hj.Hm(a.x)),this.Qd.g2(this.hj.Hm(a.y))):a):null}u2(){null!==this.o_&&this.o_.q0();null!==this.Wp&&this.Wp.Cwa();this.Mb.hR();this.rpe=null;this.Jac=0;this.Zbc=null;this.AZc=0;this.Qd=this.aH=null}static getInstance(a){return Bz.WB(a)}static WB(a){return new Bz(a,fb.a.instance.resolve("Common.IActionManagerExtended"),
fb.a.instance.resolve("Common.ICursorPinningTool"),fb.a.instance.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),fb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),fb.a.instance.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),fb.a.instance.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),fb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),fb.a.instance.resolve("PowerPointWebEditor.ISlideReader"),fb.a.instance.resolve("PowerPoint.IPathManager"),
fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?fb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").wBe)}}Object(e.a)(Bz,"ShapeRotateDragAdapter",null,[232]);var jD=d(322);class TJ{constructor(a,b,c,f,l){this.zm=this.Cr=null;if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("pageView");if(!f)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!l)throw Error.argumentNull("insertShapeOverlayViewElement");this.ia=a;this.Hc=b;this.Mb=c;this.nzb=f}kOi(){if(this.Cr)return this.Cr;this.Cr=new $l.a;this.Cr.jr("MarqueeDiv");this.Cr.Rj(0);this.Cr.xa.style.borderStyle="solid";this.Cr.xa.style.borderWidth="thin";this.Cr.xa.style.borderColor="black";this.Cr.xa.style.opacity="0.5";
this.Cr.Ld(!1);return this.Cr}pBh(a,b){this.Cr&&this.Cr.gh(a,b)}oBh(a,b){this.Cr&&this.Cr.setPosition(a,b)}rK(){this.zm=null;this.Cr&&(this.Cr.Ld(!1),this.Cr.qq())}aLd(a){const b=this.Hc.Gc;if(!b||!b.ie||!b.ie.xa)return Aa.a.J(512497682,822,10,"Unable to attach marquee element to the slide view element"),!1;b.ie.xa.appendChild(a.xa);a.pB(2+jD.a.baa);a.Ld(!0);return!0}mv(a){try{return a?a.dA===Sys.UI.MouseButton.rightButton?!1:1===this.nzb.drg?!0:!1:(Aa.a.J(512497681,822,10,"Event argument is null in isDragPossible"),
!1)}catch(b){throw Aa.a.J(512497680,822,10,"Exception {0} occured in isDragPossible",b),b;}}Du(a){try{if(!a)return Aa.a.J(512497679,822,10,"Event argument is null in OnDragStart"),!1;if(!this.mv(a))return!1;this.zm=Pr.a(a.clientPoint,this.Hc.Gc);const b=this.kOi();if(!this.aLd(b))return!1;this.oBh(this.zm.x,this.zm.y);this.pBh(0,0);return!0}catch(b){throw Aa.a.J(512497678,822,10,"Exception {0} occured in OnDragStart",b),b;}}mw(a){try{if(!a)return Aa.a.J(512497677,822,10,"Event argument is null in OnDragMove"),
!1;if(!this.Mb.isActive)return!1;const b=Pr.a(a.clientPoint,this.Hc.Gc),c=Math.min(this.zm.x,b.x),f=Math.min(this.zm.y,b.y),l=Math.max(this.zm.x,b.x),x=Math.max(this.zm.y,b.y);this.oBh(c,f);this.pBh(l-c,x-f);return!0}catch(b){throw Aa.a.J(512497676,822,10,"Exception {0} occured in OnDragMove",b),b;}}Sn(a){try{if(a)if(this.zm){var b=Pr.a(a.clientPoint,this.Hc.Gc),c=Pr.b(Math.min(this.zm.y,b.y),Math.max(this.zm.y,b.y),Math.min(this.zm.x,b.x),Math.max(this.zm.x,b.x));this.ia.La(ba.a.xSc,2,c);re.a("TelemetryForClickAndDragOperation")&&
Aa.a.J(512497673,822,50,"TextboxDrawDragAdapter::OnDragEnd");this.rK()}else Aa.a.J(512497674,822,10,"m_dragBeginPosition should not be null in OnDragEnd");else Aa.a.J(512497675,822,10,"Event argument is null in OnDragEnd")}catch(f){throw Aa.a.J(512497672,822,10,"Exception {0} occured in OnDragEnd",f),f;}}Yt(){this.rK()}dispose(){this.rK();this.Cr=null}}Object(e.a)(TJ,"TextboxDrawDragAdapter",null,[232,106]);class Is{constructor(a,b,c){this.Q2c=0;this.ZN=null;this.A7b=!1;this.kpe=this.OZc=null;this.oAb=
new zc.a(0,0);this.ula=1;this.aj=a;this.Hc=b;this.D2j=c;this.D2j.uV(Object(C.a)(this,this.QWa,"onSlideNavigation"))}Lpb(a){return a?!0:!1}QWa(){this.ula=1;this.oAb=new zc.a(0,0);this.setTransform(new zc.a(0,0))}jwb(a){if(!a)return!1;a=this.zhg(a.mc);return!!a&&1<a.length}Sye(a){if(!a)return!1;this.Q2c=this.aj.kU;if(!this.jwb(a))return!1;this.ZN=this.AOc(a.mc);return!1}ofc(a){if(!a)return!1;this.jwb(a)?(a=this.AOc(a.mc),this.ZN||(this.ZN=a),this.fpd(this.tki(this.ZN,a))):this.Erk(a);return!0}Erk(a){a&&
(a=this.AOc(a.mc),this.A7b?(a=this.QMf(this.OZc,a),this.setTransform(a)):(this.A7b=!0,this.OZc=a))}Sn(a){if(this.A7b&&a){a=this.AOc(a.mc);var b=this.QMf(this.OZc,a);a=b.x+this.oAb.x;b=b.y+this.oAb.y;this.A7b=!1;this.oAb=new zc.a(a,b)}}QMf(a,b){return!a||1>a.length||!b||1>b.length?new zc.a(0,0):new zc.a(b[0].x-a[0].x,b[0].y-a[0].y)}setTransform(a){if(this.Hc&&this.Hc.Gc&&this.Hc.Gc.$T){var b=this.Hc.Gc.$T;this.kpe||(this.kpe=b.style.cssText);b.style.cssText=this.kpe+"  width:100%;height:100%; transform:translate("+
(a.x+this.oAb.x+"px,"+(a.y+this.oAb.y)+"px) scale("+this.ula+","+this.ula+")")}}V6k(){this.setTransform(new zc.a(0,0))}LDb(a){if(!a)return!1;this.Sn(a);this.vpl();return!1}fpd(a){this.Q2c&&(a*=this.Q2c,a<Is.iVg?a=Is.iVg:a>Is.FUg&&(a=Is.FUg),this.aj.Cja=!1,this.ula=this.aj.kU=a,this.V6k())}PMf(a){if(!a||1>=a.length)return-1;const b=a.length;return Math.sqrt(Math.pow(a[0].x-a[b-1].x,2)+Math.pow(a[0].y-a[b-1].y,2))}tki(a,b){a=this.PMf(a);b=this.PMf(b);return-1!==a&&-1!==b&&a?b/a:0}zhg(a){let b=null;
if(!a)return null;a=a.rawEvent?a.rawEvent:a;a.touches&&(b=a.touches,!b.length&&a.changedTouches&&(b=a.changedTouches));return b}AOc(a){let b=null;a=this.zhg(a);if(!a)return b;b=[];for(const c of a)Array.add(b,new zc.a(c.screenX,c.screenY));return b}vpl(){this.Q2c=0;this.ZN=null;this.A7b=!1;this.OZc=null}}Is.iVg=1;Is.FUg=5;Object(e.a)(Is,"ZoomSettingTouchAdapter",null,[364]);var eQ=d(412);class UJ{constructor(a,b,c,f,l,x){this.Boe=!1;this.zm=null;this.zne=!1;this.Mb=a;this.A4=b;this.nb=c;this.Hc=f;
this.Fa=l;this.ua=x;this.Cr=new $l.a;this.Cr.jr("Marquee");this.Cr.Rj(0);this.Cr.xa.style.backgroundColor="darkgrey";this.Cr.xa.style.opacity="0.5";this.Cr.Ld(!1)}aLd(){this.Cr&&(this.Hc.Gc.ie.xa.appendChild(this.Cr.xa),this.Boe=!0)}rK(){this.zm=null;this.Cr&&(this.Cr.Ld(!1),this.Cr.qq(),this.Boe=!1);this.zne=!1}mv(a){if(!a||a.dA===Sys.UI.MouseButton.rightButton)return!1;a=new eQ.a(a,this.Mb);return this.Mb.f6b(a)}Du(a){if(!a||!this.Mb.isActive||!this.mv(a))return!1;this.A4.Ebh(new ji(!0));a.ctrlKey||
a.shiftKey?Aa.a.J(8959586,816,50,"MarqueeSelectDragAdapter used: Ctrl {0}, Shift {1}",a.ctrlKey,a.shiftKey):this.nb.Uh();this.Fa.Ad();this.zne=a.shiftKey?!0:!1;this.zm=this.Lqa(a.clientPoint);this.Boe||this.aLd();this.Cr.setPosition(this.zm.x,this.zm.y);this.Cr.gh(0,0);this.Cr.pB(1+jD.a.baa);this.Cr.Ld(!0);return!0}mw(a){if(!a||!this.Mb.isActive)return!1;var b=this.Lqa(a.clientPoint);a=Math.min(this.zm.x,b.x);const c=Math.min(this.zm.y,b.y),f=Math.max(this.zm.x,b.x);b=Math.max(this.zm.y,b.y);this.Cr.setPosition(a,
c);this.Cr.gh(f-a,b-c);return!0}Sn(a){if(a){var b=this.Lqa(a.clientPoint);a=Math.min(this.zm.x,b.x);var c=Math.min(this.zm.y,b.y),f=Math.max(this.zm.x,b.x);b=Math.max(this.zm.y,b.y);var l=this.ua.Ba,x=l?l.jl():[];l=[];var G=[],R=this.nb.Yd();for(const fa of x)(x=Object(ua.a)(121,fa.oc(this.Mb.Ma)))&&x.aQ&&(x.Sp?x.Ejd():(x=x.s4d(!1),x.Yb>=a&&x.$b>=c&&x.Vb<=f&&x.Ub<=b&&(this.zne?Array.contains(R,fa)?G.push(fa):l.push(fa):Array.contains(R,fa)||l.push(fa))));0<l.length&&this.nb.mYa(l,!1);0<G.length&&
this.nb.Wqa(G);this.rK()}}Yt(){this.zm&&this.rK()}Lqa(a){const b=this.Hc.Gc.mB;return b?zc.a.rQa(SJ.a.HQa(a,b)):zc.a.rQa(a)}dispose(){this.zm&&this.rK();this.Cr=null}}Object(e.a)(UJ,"MarqueeSelectDragAdapter",null,[232,106]);class VJ{constructor(a){this.PW=null;this.cgi(a);this.R5d=!1}cgi(a){null!==a&&(this.PW=$e.a.Ce(),this.PW.style.position=Qi.a.absolute,this.PW.style.top="0px",this.PW.style.left="0px",a.appendChild(this.PW))}Ywa(a){null!==a&&null!==this.PW&&null!==this.PW.parentNode&&(this.PW.style.cursor=
a,this.PW.style.zIndex=String(Qi.a.UDl),this.PW.style.height="100%",this.PW.style.width="100%",this.R5d=!0)}Cwa(){if(null!==this.PW||this.R5d)this.PW.style.height="0px",this.PW.style.width="0px",this.PW.style.cursor=Qi.a.Ivh,this.PW.style.zIndex="-1",this.R5d=!1}}Object(e.a)(VJ,"CursorContainerManager",null,[316]);class kD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.ShapeManipulation"}Wb(a){this.K=a;a.register(316,"PowerPointWebEditor.ShapeManipulation.ICursorContainerManager").ma().na(()=>
new VJ(a.resolve("PowerPointWebEditor.AppFrame").c1));a.register(fD,"PowerPointWebEditor.ShapeManipulationActor").ma().na(()=>new fD(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),new xp(a.resolve("Common.IActionManagerExtended")),a.resolve("Common.Transaction.ITransactionFactory"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").eIe,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),
a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Common.Utils.IHighContrastDetector"),a.resolve("Gc2.IGlyphStore")));a.register(gD,"PowerPointWebEditor.ShapeManipulation.PPTDragSelectionDragAdapter").as("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter").ma().na(()=>new gD(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IActivityManager"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IShapeReader"),pa.InteractiveViewManager.instance,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader")));a.register(317,"PowerPointWebEditor.IPptTableDragSelectionHelper").ma().na(()=>new PJ(a.resolve("Box4.IPageView").Ma,a.resolve("Box4.IPageView").Fd,a.resolve("PowerPointWebEditor.Graph.ITableReader")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTextEditOnlyMode||this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled||
this.dyj();this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointTouchZoomEnabled&&this.Vyj();this.Sxj()}Vyj(){const a=this.K.resolve("PowerPointWebEditor.IZoomContext");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").XMk(new Is(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")))}dyj(){var a=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");const b=this.K.resolve("Common.IActionManagerExtended");
var c=this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext");const f=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),l=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?null:this.K.resolve("Common.CursorManager"),x=this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),G=this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),R=this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),fa=this.K.resolve("PowerPointWebEditor.ISlideReader"),
wa=this.K.resolve("PowerPointWebEditor.IShapeReader"),Wa=this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),mb=this.K.resolve("PowerPointWebEditor.ISmartGuideManager"),Kb=this.K.resolve("PowerPointWebEditor.Core.IPauseTheWorldManager"),nc=this.K.resolve("PowerPoint.IPathManager"),oc=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,Ic=!!window.requestAnimationFrame&&
!!window.cancelAnimationFrame;this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").BFb(2,this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").BFb(1,new RJ(a,b,l,R,this.K.resolve("Box4.IUndoManager"),c,f,x,G,wa,this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),Wa,mb,Kb,oc,Ic,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),
new Hs(a,b,c,f,x,G,R,Wa,wa,mb,Kb,oc,this.K.resolve("PowerPoint.IBrowserHelperManager"),Ic,this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled),new Bz(a,b,l,c,f,x,G,R,fa,nc,oc,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").wBe),new UJ(a,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),
f,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));c=new QJ(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"));
this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").udh(c);this.K.resolve("PowerPointWebEditor.IApplicationSettings").ovb&&(a=new TJ(b,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a,this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),this.K.resolve("PowerPointWebEditor.IInsertShapeOverlayViewElement")),this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").udh(a));Aa.a.J(509691227,813,50,"Shape manipulation drag adapter init complete")}Sxj(){const a=
this.K.resolve("PowerPointWebEditor.ShapeManipulationActor");a.xe();a.ub()}dispose(){}static main(){m.a.instance.Bc(new kD)}}Object(e.a)(kD,"PPTWebEditorShapeManipulationPackage",null,[2,3]);var fQ=d(1115),Dx=d(1171),dr=d(112);class Ex{constructor(a,b,c,f,l,x,G,R){this.eoe=null;this.Une=new Date;this.pQ=a;this.n7j=b;this.dbk=c;this.h1j=f;this.Z6j=l;this.ZFa=x;G.Cb(new xe.a(R,2,this.h1j,Object(C.a)(this,this.bPf,"checkTask"),90,"61"))}bPf(){this.Isl()}Isl(){var a=new Date;const b=+new Date-+this.eoe>
this.dbk;if(!(this.Une<this.eoe)||b){if(+a-+this.Une<this.n7j)return;this.pQ()}a=+new Date-+a;a>this.Z6j&&Aa.a.J(8958035,813,10,"PrefetchManager::PrefetchThrottler::TryPrefetchIfAppropriate() took too long to check  prefetch: {0}ms for {1}",a,this.ZFa)}uld(){this.eoe=new Date}pld(){this.Une=new Date}}Object(e.a)(Ex,"PrefetchThrottler",null,[]);class Tp{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc){this.qgd=250;this.Y9b=this.v8b=null;this.eLg=this.IKg=!1;this.XAb=[];this.Pii=5;this.mMf=10;
this.YAb=[];this.Qii=5;this.hVa=!1;this.$Sg=this.GI=this.eYc=null;this.r1c=!1;this.jqe=[];this.Zb=a;this.ua=b;this.WG=c;this.vj=f;this.bhe=l;this.Sy=Kc;this.Hla=x;this.Ha=G;this.yb=R;this.lc=fa;this.qv=wa;this.EL=Wa;this.od=mb;this.N$j=Kb;this.Mc=nc;this.Hk=oc;this.Sx=Ic;this.A$j=this.Ha.CNj;this.V8j=u.AFrameworkApplication.fa.ka("PrefetchThrottlerNormalPriorityEnabled");this.S8j=u.AFrameworkApplication.fa.ka("PrefetchLookaheadSlideEnabled");!r.a.Ki||this.Ha.DNj?this.setEnabled(this.Ha.tGj,this.Ha.KJj):
this.setEnabled(!1,!1);this.U8j=this.Ha.prefetchSlideForwardMax;this.T8j=this.Ha.prefetchSlideBackwardMax;this.d2j=u.AFrameworkApplication.fa.ka("PodDisableAlwaysPrefetchSlidesInVisibleRange");this.YYk=u.AFrameworkApplication.fa.Cc("SlidePrefetchLookaheadCount",0);this.cH=!1;this.Mc.IB(Object(C.a)(this,this.ML,"onSessionClosed"));this.Mc.A3a(Object(C.a)(this,this.sea,"onSessionRehydrating"));this.Mc.JB(Object(C.a)(this,this.to,"onSessionRehydrated"));u.AFrameworkApplication.fa.ka("SlidePrefetchThrottlerMinDelayReduced")&&
(this.qgd=125);this.Sx&&this.Sx.FDa(()=>{this.Zil()})}Zil(){this.$Sg=new xe.a(2,1,this.qgd,Object(C.a)(this,this.updateSlidePrefetchRange,"updateSlidePrefetchRange"),90,"59");this.r1c=!1;const a=this.V8j?2:3;this.v8b=new Ex(Object(C.a)(this,this.Gsl,"tryPrefetchContentModel"),this.qgd,Tp.ZYk,Tp.Qjh,Tp.Kjh,"content model",this.yb,a);this.od.kob(Object(C.a)(this,this.VWa,"onVisibleThumbnailsChanged"));this.Hk.UH(Object(C.a)(this,this.dB,"onActiveSlideChanged"));this.Y9b=new Ex(Object(C.a)(this,this.Jsl,
"tryPrefetchImages"),this.qgd,Tp.XYk,Tp.Qjh,Tp.Kjh,"image",this.yb,3);this.EL&&(this.EL.tha(Object(C.a)(this,this.OCg,"loadedHandler")),this.EL.Yj(Object(C.a)(this,this.Y9g,"propertyChangedHandler")))}get yf(){this.eYc&&this.eYc.isConnected||(this.eYc=this.Zb.yf);return this.eYc}get Ba(){this.GI||(this.GI=this.ua.Ba);return this.GI}setEnabled(a,b){this.IKg=a;this.eLg=b}t8c(){this.XAb=[];this.YAb=[];this.hVa=!1}dispose(){this.od.Ufh(Object(C.a)(this,this.VWa,"onVisibleThumbnailsChanged"));this.Hk.Y4(Object(C.a)(this,
this.dB,"onActiveSlideChanged"));this.Mc.Oea(Object(C.a)(this,this.ML,"onSessionClosed"));this.Mc.sGe(Object(C.a)(this,this.sea,"onSessionRehydrating"));this.Mc.Pea(Object(C.a)(this,this.to,"onSessionRehydrated"));this.EL&&(this.EL.HXa(Object(C.a)(this,this.OCg,"loadedHandler")),this.EL.tm(Object(C.a)(this,this.Y9g,"propertyChangedHandler")))}ML(){this.cH=!0}sea(){this.t8c()}to(){this.cH=!1}Gsl(){this.IKg&&this.crh()&&this.sBk()}sBk(){var a=this.n4d();const b=this.hVa?null:Vq.b(a,c=>c?c.Bb:null);
(a=this.E6g(0,a))?(a=a.Bb,this.v8b&&this.v8b.uld(),this.qv.prefetchSlide(a,b,()=>{this.hVa=!0}),this.yEk(a)):this.hVa||this.qv.prefetchSlide(Oe.a.empty,b,()=>{this.hVa=!0})}dB(){this.GI=null;this.hVa=!1}VWa(){this.Wql();this.hVa=!1}OCg(a,b){(a=Object(ua.a)(120,b.node))&&a.DD&&this.zec(a)}Y9g(a,b){a=b.property;b.node&&a===sb.a.cid&&(this.hVa=!1)}zec(a){if(a.isConnected){var b=Object(ua.a)(120,a);b&&(b.fEa=!0,this.yb.Cb(new xe.a(2,1,0,Object(C.a)(this.Y9b,this.Y9b.bPf,"checkTask"),90,"60")),u.AFrameworkApplication.fa.ka("PPTOTextPreloadServiceFonts")&&
(Array.clear(this.jqe),this.hId(b.Z5f),this.hId(b.ryh),this.hId(b.cCh),b=new xe.a(3,1,0,Object(C.a)(this,this.Hsl,"tryPrefetchFonts"),90,"114"),b.customData=this.jqe,this.yb.Cb(b)))}this.v8b&&(this.v8b.pld(),this.XAb=[]);a.Uxa=!0;this.Hla.HZa()}yEk(a){this.XAb.length>=this.mMf&&(this.XAb=[]);Array.add(this.XAb,a)}hId(a){if(!Ka.a.Va(a)){a=a.split(",");for(const b of a)this.jqe.push(b)}}E6g(a,b=null){const c=this.Ba;if(!c||!c.isConnected)return null;b||(b=this.n4d());return this.x$i(c,a,b)}x$i(a,b,
c){for(const f of c)if(f)if(c=f.Bb,this.Itj(c))Aa.a.J(512497862,813,50,"PrefetchManager::PickBestSlide() prefetching content model for slide={0} and fetchType={1} failed many times",c,b);else if(this.$al(f,b)){const l=a.Bb;a=this.lc.E1b(a);const x=this.lc.E1b(f);Aa.a.J(512497861,813,50,"PrefetchManager::PickBestSlide() prefetching {0} at {1} with offset {2} from currentSlide {3} at {4} for fetchType={5}",c,x,x-a,l,a,b);return f}return null}Itj(a){let b=0;for(const c of this.XAb)a.equals(c)&&(b+=1);
if(b>=this.Pii)return!0;b=0;for(const c of this.YAb)a.equals(c)&&(b+=1);return b>=this.Qii}$al(a,b){if(!a)return!1;const c=a.Bb;if(Oe.a.Sw(c))return!1;const f=!!a&&a.DD;if(0===b)return!f;if(!f||!a.fEa)return!1;b=a.WRa(new dr.a(a.hq,a.Kk));if(null===b)return Aa.a.J(512497860,813,50,"PrefetchManager::ShouldPrefetchSlide() null images for {0}",c),!1;for(const l of b)if(!this.WG.DRc.Dfd(l).data)return!0;return a.fEa=!1}Jsl(){if(this.eLg&&this.crh()){const b=this.E6g(1);if(b){var a=b.Bb;this.Y9b.uld();
this.tSi(b);this.zEk(a)}}}Hsl(a){a=Array.isArray(a.customData)?a.customData:null;for(const b of a)this.Sy.OKi(b)}crh(){return this.cH||!this.A$j&&2===this.vj.Cba||!this.yf||this.bhe.Osa(this.yf)||!this.Ba||this.Ba.XK?!1:!0}zEk(a){this.YAb.length>=this.mMf&&(this.YAb=[]);Array.add(this.YAb,a)}tSi(a){if(a){var b=a.WRa(new dr.a(a.hq,a.Kk));b&&0<b.length?this.WG.msb(b,!0,()=>{this.Y9b.pld();this.YAb=[];a.fEa=!1},u.AFrameworkApplication.fa.ka("FetchSlideImageBatchInRealTimeEnabled")):a.fEa=!1}}Wql(){this.r1c||
(this.yb.Cb(this.$Sg),this.r1c=!0)}updateSlidePrefetchRange(){this.r1c=!1;this.qv.syncCurrentSlideIdAndPrefetchRange(this.Ba,null,this.Hla.Yna,null)}tjj(){return Vq.b(this.n4d(),a=>a?a.Bb:null)}n4d(){var a=this.Ba;if(!a||!a.isConnected)return[];a=this.lc.E1b(a);var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");b=b.slides||[];const c=b.length,f=[],l=[];if(!this.d2j)for(var x of this.Hla.Yna.b3)x!==a&&x<c&&(Array.add(l,b[x]),f[x]=!0);if(this.S8j&&!f.length)for(x=1;x<=
this.YYk;x++){const G=this.Hla.Yna.lastIndex+x;G!==a&&G<c&&(Array.add(l,b[G]),f[G]=!0)}if(0<=a){a=this.N$j.Ofg(a,b.length,this.U8j,this.T8j);for(const G of a)if(void 0===f[G]||null===f[G])f[G]=!0,Array.add(l,b[G])}return l}}Tp.Qjh=1E3;Tp.ZYk=2E3;Tp.XYk=6E4;Tp.Kjh=500;Object(e.a)(Tp,"PrefetchManager",null,[313,106]);class lD{constructor(a,b,c,f){this.pi=b;this.$D=c;this.ra=f;this.Mc=a;this.Mc.LNa(Object(C.a)(this,this.deb,"onSessionEnding"))}deb(a,b){if(this.ra.cC()){a=this.ra.Yd();if(!a.length){const c=
this.ra.qfg();c&&a.push(c)}for(const c of a)this.pi.B4a(c)}this.$D.DWi(b.vJ)}dispose(){this.Mc.rGe(Object(C.a)(this,this.deb,"onSessionEnding"))}}Object(e.a)(lD,"SessionCleanupHandler",null,[106]);var WJ=d(424),gQ=d(933);class mD{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.vxd=this.Quc=this.Fre=!1;if(!b)throw Error.argumentNull("taskManager");if(!c)throw Error.argumentNull("context");this.Ha=a;this.PQg=a.sessionTimeoutInMs;this.yb=b;this.PD=c;this.ra=f;this.nUa=l;this.kC=x;this.Md=G;this.ua=
R;this.Xb=fa;this.Bm=wa;this.QQg=Wa;this.Ho=mb;this.pGg=Kb;this.Sbc=0}get cca(){return this.nUa.instance}get l8(){return u.AFrameworkApplication.Vg}get ezg(){return 1===this.Sbc}get Lwb(){return this.Quc}get DVc(){return this.vxd}get vJ(){return this.Sbc}set vJ(a){this.Sbc=a}get INf(){return this.Ha.podsSeamlessFailoverEnabled&&!!this.Ho.instance}start(){if(!this.l8){var a=new xe.a(4,2,3E4,Object(C.a)(this,this.QTg,"manageLifetime$p"),90,"56");this.yb.Cb(a)}}Ick(){this.QTg(null)}QTg(){if(!this.Fre){var a=
+new Date-+Nc.a.Q6b;a>this.PQg&&this.dQi(a);u.AFrameworkApplication.Kz&&u.AFrameworkApplication.fa.ka("WOPITokenRefreshStopWhenOutOfRangeIsEnabled")&&a>=this.Ha.wopiTokenRefreshMaxDurationInMs&&this.kC.fJk()}}dQi(a){this.l8||(this.DQf(2),this.INf?this.pGg.instance&&this.pGg.instance.U7a&&(Aa.a.J(512360777,805,15,"SessionLifetimeManager::ExpireSession - ShowCustomizedTimeoutMessageForCommentDraft"),vf.Health.instance.recordQosError("TimeoutDialogForCommentDraft",["SessionExpired"],!0,!0,!1,!0,null),
this.QQg.Afl()):this.QQg.zfl(),this.kC.gIk(),Aa.a.J(512360776,801,15,"SessionLifetimeManager::ExpireSession - Session has expired after idle {0}, timeout {1}. CanRehydrate:{2}; ValidFailoverInstance:{3}; SeamlessFailoverEnabled:{4};",a,this.PQg,this.INf,!!this.Ho.instance,this.Ha.podsSeamlessFailoverEnabled))}closeSession(a=1){this.DQf(a)}DQf(a){0===a&&Aa.a.J(512360775,801,50,"SessionCloseReason should not be unknown!");if(!this.l8)try{this.Quc=!0,Aa.a.J(512360774,801,15,"SessionLifetimeManager::CloseSession() - closing session, reason:{0}",
WJ.a[a]),this.Sbc=a,this.ra.setSelection(null),u.AFrameworkApplication.Vg=!0,this.PD.o7a().$8c=!0,this.Md.disabled=!0,Vg.a.Mw&&4!==a&&Vg.a.Mw.hide(),this.kC.hEe(new gQ.a(a)),this.cca&&0<this.cca.eCa.count&&this.cca.jjc(this.PD.aRa().presentationId,"instanceId",!0,!1),this.Ha.podsSeamlessFailoverEnabled&&this.Ho.instance&&(1===a?this.Ho.instance.YGd("abortedOnExitApp"):this.Ho.instance.YGd("SessionClose_"+a)),this.yb.stop(),this.Bm.isPaused||this.Bm.pause(),4!==a&&2!==a&&this.Xb.blockContent(this.ua.presentation,
"CloseSession",!0),this.kC.Mdd(new Hn.a(a))}finally{this.vxd=this.Quc=!1}}fgl(){this.Fre=!0}kXk(){this.Fre=!1}markSessionClosingAtForceSave(a){Aa.a.J(512360773,801,15,"SessionLifetimeManager::MarkSessionClosingAtForceSave reason:{0}",WJ.a[a]);this.vxd=this.Quc=!0;this.Sbc=a}}Object(e.a)(mD,"SessionLifetimeManager",null,[1031]);var eg=d(414);class XJ{constructor(){this.trigger=null;this.L$=this.Jhb=this.qZa=0;this.yQd={}}}Object(e.a)(XJ,"SuggestionsInfo",null,[]);class YJ{constructor(){this.SessionID=
this.SerializedUser=this.BaseDocQueryStringWithoutVersion=null}}Object(e.a)(YJ,"StartRtcConnectionRequest",null,[]);class ZJ{constructor(){this.SessionID=null}}Object(e.a)(ZJ,"StopRtcConnectionRequest",null,[]);var hQ=d(282);class $J{constructor(a,b){this.slideId=a;this.imageId=hQ.a.IGc(b)}}Object(e.a)($J,"ThumbnailImageId",null,[]);var Js=d(273);const aK=a=>{let b,c,f;var l;let x,G;b=null;f=c=0;x=l=null;G=-1;return(a=a.match(RegExp("/IncSuggestion/(.*),(\\d+),(\\d+),(\\d+),(\\d+),(.*),(\\d+)")))&&
8===a.length?(b=a[1],c=Number.parseInvariant(a[2]),f=Number.parseInvariant(a[3]),l=Object.assign(new Js.a,{Sid:Number.parseInvariant(a[4]),Cid:Number.parseInvariant(a[5])}),l=new Oe.a(l),x=a[6],G=Number.parseInvariant(a[7]),{returnValue:!0,correlationID:b,zU:c,L$:f,slideID:l,trigger:x,Jhb:G}):{returnValue:!1,correlationID:b,zU:c,L$:f,slideID:l,trigger:x,Jhb:G}},iQ=a=>{const b=new Ha.a;try{const c=Yd.a(a);for(const f of c.SlideSuggestions)b.add(f.Index)}catch(c){Aa.a.J(42342594,829,10,"ContentKeyHelper:TryGetSuggestionIndexesListFromValue - parsing suggestionResults failed.")}return b};
var Cz;(function(a){a[a.none=0]="none";a[a.alone=1]="alone";a[a.coauthoring=2]="coauthoring"})(Cz||(Cz={}));Object(e.b)("CoauthorStatus",Cz);class bK extends Sys.EventArgs{constructor(a){super();this.xha=a}}Object(e.a)(bK,"AppliedPolicyIdEventArgs",Sys.EventArgs,[]);class cK extends Sys.EventArgs{constructor(a){super();this.DKc=a}}Object(e.a)(cK,"FileRevisionHistoryEventArgs",Sys.EventArgs,[]);class dK extends Sys.EventArgs{constructor(a,b,c,f,l){super();this.bQc=a;this.sKc=b;this.ZIj=c;this.confidence=
f;this.imageDescription=l}}Object(e.a)(dK,"ImageDescriptionReadyEventArgs",Sys.EventArgs,[]);class eK extends Sys.EventArgs{constructor(a){super();this.m5b=a}}Object(e.a)(eK,"IsManuallyAppliedEventArgs",Sys.EventArgs,[]);class fK extends Sys.EventArgs{constructor(){super()}}Object(e.a)(fK,"CommentsChangedEventArgs",Sys.EventArgs,[]);class gK extends Sys.EventArgs{constructor(a){super();this.OXd=a}}Object(e.a)(gK,"FindRtcSessionEventArgs",Sys.EventArgs,[]);class hK extends Sys.EventArgs{constructor(){super()}}
Object(e.a)(hK,"LastMergeEditUTCChangedEventArgs",Sys.EventArgs,[]);class iK extends Sys.EventArgs{constructor(){super()}}Object(e.a)(iK,"RealTimeEditEventArgs",Sys.EventArgs,[]);class nD extends Sys.EventArgs{constructor(a,b=null){super();this.pak=a;this.G2j=b}get Fwh(){return this.pak}get uQi(){return this.G2j}}Object(e.a)(nD,"SyncLoopStatusNotifiedEventArgs",Sys.EventArgs,[]);class jK extends Sys.EventArgs{constructor(a){super();this.bCk=a}}Object(e.a)(jK,"PresentationLastModifiedTimeReceivedEventArgs",
Sys.EventArgs,[]);var jQ=d(861);class kK extends Sys.EventArgs{constructor(a){super();this.slideId=a}}Object(e.a)(kK,"DesignerSuggestionCoauthModifiedEventArgs",Sys.EventArgs,[]);class Dz extends Sys.EventArgs{constructor(a,b,c,f,l,x,G){super();this.H7d=!1;this.Xmc=null;this.correlationId=a;this.qZa=b;this.L$=c;this.trigger=l;this.slideId=x;this.JBa=G;this.BJa=f}}Object(e.a)(Dz,"DesignerSuggestionsUpdatedEventArgs",Sys.EventArgs,[]);class Fx extends Sys.EventArgs{constructor(a,b,c){super();this.correlationId=
a;this.slideId=b;this.JBa=c}}Object(e.a)(Fx,"FixItSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class lK extends Sys.EventArgs{constructor(a,b,c,f){super();this.slideId=a;this.jY=c;this.shapeId=b;this.JBa=f}}Object(e.a)(lK,"IconSuggestionUpdatedEventArgs",Sys.EventArgs,[]);class mK extends Sys.EventArgs{constructor(a,b,c,f,l,x){super();this.correlationId=a;this.Pca=b;this.slideId=c;this.shapeId=f;this.xIa=l;this.JBa=x}}Object(e.a)(mK,"ReplaceObjectUpdatedEventArgs",Sys.EventArgs,[]);class oD{constructor(a,
b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg){this.Cje=this.vje=!1;this.pMg=null;this.ANg={};this.Hla=b;this.yl=mg;this.xq=l;this.eZc=x;this.Zb=R;this.ua=fa;this.qv=wa;this.m3c=Wa;this.Md=mb;this.kC=Kb;this.Ee=nc;this.iZc=oc;this.hw=Ic;this.Xa=a;this.cO=Kc;this.DAb=Hc;this.Mc=ie;this.JZc=c;this.Ha=He;this.Mt=fe;this.yb=Te;this.uv=We;this.jc=Qf;this.qLg=this.Ha.tg&&this.Ha.pptNoRtcConnectWhenReadOnlyEnabled;this.Mc.LNa(Object(C.a)(this,this.gB,"onSessionEnd"));this.Mc.IB(Object(C.a)(this,
this.iYd,"flushOnSessionEnd"));this.JZc.eFf(Object(C.a)(this,this.S0g,"onNormalChannelDocNotifyClientItemsUpdated"));f&&f.eFf(Object(C.a)(this,this.S0g,"onNormalChannelDocNotifyClientItemsUpdated"));this.Ha.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&this.Mc.JB(Object(C.a)(this,this.d$,"onPodSessionRehydrated"));this.qLg&&this.Mc.cba(Object(C.a)(this,this.jz,"onUnifiedAppStateChanged"))}S0g(a,b){this.Hlk(b,this.eZc)}Hlk(a,b){let c=!1;const f=[],l=[],x=new XJ;for(const Hc of a.items){const ie=
new Date,He=this.Mt.SDa;var G=void 0,R=void 0,fa=void 0,wa=void 0,Wa=void 0,mb=void 0;if(Hc.Key===eg.a.A8g)b.S0d(eg.a.A8g)>Hc.TimeStamp||(Aa.a.J(512497797,813,50,"Need to reload the whole presentation."),c=!0);else{var Kb=void 0;Kb=null;(R=Hc.Key.match(RegExp("/Thumb\\[(\\d+),(\\d+)\\]/ID\\[(\\d+),(\\d+)\\]")))&&5===R.length?(Kb=new Js.a,Kb.Sid=Number.parseInvariant(R[3]),Kb.Cid=Number.parseInvariant(R[4]),Kb=new Oe.a(Kb),R={returnValue:!0,slideId:Kb}):R={returnValue:!1,slideId:Kb};if(({slideId:R}=
R).returnValue)R=eg.a.$3d(R.sid,R.cid),b.S0d(R)>=Hc.TimeStamp||(R=Sys.Serialization.JavaScriptSerializer.deserialize(Hc.Value),Array.add(f,new jQ.a(R,0<R.SnapshotTimeStamp?R.SnapshotTimeStamp:Hc.TimeStamp)));else if(Hc.Key.startsWith(eg.a.d0f))R=Sys.Serialization.JavaScriptSerializer.deserialize(Hc.Value),this.xq.MDh(R),Aa.a.J(512497796,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Notify clientID to websession; clientId: {0};",R);else if(Hc.Key===eg.a.eMi)R=Sys.Serialization.JavaScriptSerializer.deserialize(Hc.Value),
Aa.a.J(512497795,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - EditorTable; LastRequestCorrelationID:{0}; TimeStamp:{1}; EditorsCount:{2};",Hc.LastRequestCorrelationID,Hc.TimeStamp,R.length),this.xq.fDh(R);else if(Hc.Key===eg.a.Lqi)R=Sys.Serialization.JavaScriptSerializer.deserialize(Hc.Value),Aa.a.J(512497794,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - CoauthStatus; LastRequestCorrelationID:{0}; TimeStamp:{1}; NewStatus:{2};",Hc.LastRequestCorrelationID,
Hc.TimeStamp,Cz[R]),this.xq.Soc(R);else if(Hc.Key===eg.a.Qvi)Aa.a.J(39913162,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated - Content update; LastEditorID:{0}; LastRequestCorrelationID:{1}; TimeStamp:{2}; RevisionId:{3}; IsFromRealTimeChannel:{4}",Hc.LastEditorID,Hc.LastRequestCorrelationID,Hc.TimeStamp,Hc.Value,!1),this.kC.IGk(),this.qv.fF(this.Zb.Ci);else{if(Kb=Hc.Key.startsWith(eg.a.YXf)){a:{Kb=void 0;R=Hc.Value;try{const fe=R?R.split(","):[];if(3!==fe.length){Kb=Oe.a.tE(0,0);
Aa.a.J(23089477,823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Coauth modified value member is not expected; value:{0}.",R);var nc={returnValue:!1,slideId:Kb};break a}const Te=Number.parseInvariant(fe[0]),We=Number.parseInvariant(fe[1]),Qf=fe[2];Kb=Oe.a.tE(Number.parseInvariant(fe[0]),Number.parseInvariant(fe[1]));Aa.a.J(23089479,823,50,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Sid:{0}, Cid:{1}, modified Guid:{2}.",Te,We,Qf)}catch(fe){Aa.a.J(23089481,
823,10,"ContentKeyHelper::TryGetSlideIdFromSuggestionCoauthModifiedKey - Cannot get slide id from coauth modified key. Value:{0}, exception log:{0}.",R,fe.toString());Kb=Oe.a.tE(0,0);nc={returnValue:!1,slideId:Kb};break a}nc={returnValue:!0,slideId:Kb}}Kb=({slideId:R}=nc).returnValue}if(Kb)Aa.a.J(512497793,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Coauth Modified notification returned, slide id:{0}",Hc.Value),this.Ee.MGk(new kK(R));else{if(Kb=Hc.Key.startsWith(eg.a.awh)){{var oc=
void 0;let fe;R=null;G=0;oc=fe=null;(Kb=Hc.Key.match(RegExp("/Suggestion\\[(.*),(\\d+)]/ID\\[(\\d+),(\\d+),(.*),(.*)]")))&&7===Kb.length?(R=Kb[1],G=Number.parseInvariant(Kb[2]),oc=Object.assign(new Js.a,{Sid:Number.parseInvariant(Kb[3]),Cid:Number.parseInvariant(Kb[4])}),fe=new Oe.a(oc),oc=Kb[6],G={returnValue:!0,correlationID:R,zU:G,slideID:fe,trigger:oc}):G={returnValue:!1,correlationID:R,zU:G,slideID:fe,trigger:oc}}Kb=({correlationID:G,zU:x.qZa,slideID:R,trigger:x.trigger}=G).returnValue}if(Kb)Aa.a.J(512497792,
829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer suggestion notification returned, CorrelationId:{0}",G),R=new Dz(G,x.qZa,x.qZa,0,x.trigger,R,Hc.Value),R.Xmc=new Ha.a,this.yCe(R);else if(this.Ha.designerIncrementalRenderEnabled&&Hc.Key.startsWith(eg.a.J7d)&&({correlationID:G,zU:x.qZa,L$:x.L$,slideID:R,trigger:x.trigger,Jhb:x.Jhb}=aK(Hc.Key)).returnValue)Aa.a.J(512497763,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Designer incremental suggestion notification returned, CorrelationId: {0}; startIdx: {1}; Suggestions in notification: {2}; Expected total: {3}",
G,x.Jhb,x.qZa,x.L$),R=new Dz(G,x.qZa,x.L$,x.Jhb,x.trigger,R,Hc.Value),G in x.yQd||(x.yQd[G]=this.Qgj(G,a.items)),R.Xmc=x.yQd[G],R.H7d=!0,this.yCe(R);else{if(Kb=Hc.Key.startsWith(eg.a.i6f))R=G=null,(Kb=Hc.Key.match(RegExp("/FixItSuggestion\\[(.*)]/ID\\[(\\d+),(\\d+),(.*)]")))&&5===Kb.length?(G=Kb[1],R=Object.assign(new Js.a,{Sid:Number.parseInvariant(Kb[2]),Cid:Number.parseInvariant(Kb[3])}),R=new Oe.a(R),G={returnValue:!0,correlationID:G,slideID:R}):G={returnValue:!1,correlationID:G,slideID:R},Kb=
({correlationID:G,slideID:R}=G).returnValue;if(Kb)Aa.a.J(512497762,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - FixIt suggestion notification returned, CorrelationId:{0}",G),this.yCe(new Fx(G,R,Hc.Value));else{if(Kb=Hc.Key.startsWith(eg.a.nsg))mb=null,fa=0,Kb=null,G=R=0,(wa=Hc.Key.match(RegExp("/Intelligence\\[(.*),(\\d+),(\\d+),(\\d+),(\\d+),(\\d+)]")))&&7===wa.length?(mb=wa[1],fa=Number.parseInvariant(wa[2]),G=Object.assign(new Js.a,{Sid:Number.parseInvariant(wa[3]),Cid:Number.parseInvariant(wa[4])}),
Kb=new Oe.a(G),R=Number.parseInvariant(wa[5]),G=Number.parseInvariant(wa[6]),fa={returnValue:!0,correlationID:mb,Pca:fa,slideID:Kb,shapeId:R,xIa:G}):fa={returnValue:!1,correlationID:mb,Pca:fa,slideID:Kb,shapeId:R,xIa:G},Kb=({correlationID:G,Pca:fa,slideID:R,shapeId:wa,xIa:mb}=fa).returnValue;if(Kb)Aa.a.J(512497761,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - ReplaceObject notification returned, CorrelationId:{0}",G),this.Ee.YHk(new mK(G,fa,R,wa,mb,Hc.Value));else if(Hc.Key===eg.a.LDl)this.tsj();
else if(Hc.Key===eg.a.n4f&&this.pMg!==Hc.Value)this.Hnj(Hc);else if(Hc.Key===eg.a.Gwh)!Ka.a.Va(Hc.Value)&&Ka.a.pwb(Hc.Value)?(R=Sys.Serialization.JavaScriptSerializer.deserialize(Hc.Value),Aa.a.J(512497760,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; PopSessionID:{1}; PodSessionID:{2}",R,this.Xa.Bk,this.Xa.podSessionId),240===R?this.cO.Mea(1):(432!==R||this.Cje||this.FZf(),this.DAb.Jbh(new nD(R)))):(R=Sys.Serialization.JavaScriptSerializer.deserialize(Hc.Value),
Aa.a.J(512497759,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Sync loop exited with status:{0}; HasExtraErrorParams:{1}; PopSessionID:{2}; PodSessionID:{3}",R.Code,!!R.ExtraErrorParam,this.Xa.Bk,this.Xa.podSessionId),240===R.Code?this.cO.Mea(1):(432!==R.Code||this.Cje||this.FZf(),this.DAb.Jbh(new nD(R.Code,R.ExtraErrorParam))));else if(Hc.Key===eg.a.LBg)this.Coj(Hc);else if(Hc.Key===eg.a.ivj)Aa.a.J(512497758,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Host Session Failover notification received oldsessionId:{0};",
this.Xa.Bk),this.cO.Mea(1);else if(Hc.Key===eg.a.cCk)R=Sys.Serialization.JavaScriptSerializer.deserialize(Hc.Value),this.Zb.yf.HBe=R,this.hw.RHk(new jK(R));else if(Hc.Key.startsWith(eg.a.DRf)){Aa.a.J(512497757,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Comment has been createed or updated with key: {0}",Hc.Key);a:{R=Hc.Key;try{const fe=R.match(RegExp("\\d+","g"));if(fe&&0<fe.length&&!(fe.length%2)){Kb=[];for(oc=0;oc<fe.length;oc+=2)Kb.push(Object.assign(new Js.a,{Sid:Number.parseInvariant(fe[oc]),
Cid:Number.parseInvariant(fe[oc+1])}));var Ic=Kb;break a}}catch(fe){Aa.a.J(25011930,805,10,"ContentKeyHelper::TryGetSlideIdsFromCommentPrefixKey - Cannot get slide id array from key. Key:{0}, Exception:{1}",R,fe)}Ic=null}(R=Ic)&&0<R.length&&this.kC.DGk(new fK(R))}else if(Hc.Key.startsWith(eg.a.Bng))this.eoj(Hc);else if(Hc.Key===eg.a.N4f)this.iZc.VGk(new cK(Hc.Value));else{if(Kb=Hc.Key.startsWith(eg.a.bng)){a:{Wa=Hc.Key;Kb=null;R=0;wa="";try{const fe=Wa.match(RegExp("/IconSuggestion\\[(\\d+),(\\d+),(\\d+),{(.*)}]"));
if(fe&&5===fe.length){const Te=Object.assign(new Js.a,{Sid:Number.parseInvariant(fe[1]),Cid:Number.parseInvariant(fe[2])});Kb=new Oe.a(Te);R=Number.parseInvariant(fe[3]);wa=fe[4];var Kc={returnValue:!0,slideID:Kb,shapeId:R,nodeId:wa};break a}}catch(fe){Aa.a.J(38279246,823,10,"ContentKeyHelper::TryGetIconSuggestionInfoFromServiceKey - Cannot get IconSuggestionInfo from key. Value:{0}, exception log:{0}.",Wa,fe.toString())}Kc={returnValue:!1,slideID:Kb,shapeId:R,nodeId:wa}}Kb=({slideID:R,shapeId:wa,
nodeId:Wa}=Kc).returnValue}if(Kb)Aa.a.J(512497756,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IconSuggestion notification returned."),this.Ee.fHk(new lK(R,wa,Wa,Hc.Value));else if(Hc.Key===eg.a.cUi)this.DAb.WGk(new gK(Hc.Value));else{if(Kb=Hc.Key.startsWith(eg.a.wyh))Kb=null,(R=Hc.Key.match(RegExp("/ThumbImgId\\[(\\d+),(\\d+)\\]")))&&3===R.length?(Kb=new Js.a,Kb.Sid=Number.parseInvariant(R[1]),Kb.Cid=Number.parseInvariant(R[2]),Kb=new Oe.a(Kb),R={returnValue:!0,slideId:Kb}):R=
{returnValue:!1,slideId:Kb},Kb=({slideId:R}=R).returnValue;if(Kb)R=new $J(R,Hc.Value),R.imageId&&l.push(R);else if(Hc.Key===eg.a.nKi)this.uv.aVe(parseInt(Hc.Value));else if(Hc.Key===eg.a.QHf)this.iZc.uGk(new bK(Hc.Value));else if(Hc.Key===eg.a.$wg)this.iZc.nHk(new eK("true"===Hc.Value.toLowerCase()));else if(Hc.Key===eg.a.iYk)this.xq.$ih=Hc.Value,this.xq.v1g();else if(Hc.Key===eg.a.gYk)try{this.xq.Yid=Boolean.parse(Hc.Value)}catch(fe){Aa.a.J(512497755,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",
fe)}else if(Hc.Key===eg.a.CBg)R=Sys.Serialization.JavaScriptSerializer.deserialize(Hc.Value),Aa.a.J(512497754,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - LastMergeEditUTC updated: {0}",R.toString()),this.kC.sHk(new hK(R));else if(Hc.Key===eg.a.nch)R=Sys.Serialization.JavaScriptSerializer.deserialize(Hc.Value),Aa.a.J(512497753,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated- Raising a RealTimeChannelEditEvent. UTC Time: {0}",R.toString()),this.kC.THk(new iK(R));
else if(Hc.Key===eg.a.mxj)try{this.xq.r$d=Boolean.parse(Hc.Value),Aa.a.J(512497752,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - IsConnectedToOCS: {0}",this.xq.r$d)}catch(fe){Aa.a.J(512497751,817,15,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Can't parse the notification message: {0}",fe)}else if(Hc.Key===eg.a.gvj)this.xq.ugc=Hc.Value,Aa.a.J(512497750,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - PopsHostProtocol: {0}",this.xq.ugc);else if(Hc.Key===
eg.a.VDl)Aa.a.J(512497749,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received ZeroByteFileEnsuredOnHost notification"),this.xq.UGh=!0;else if(Hc.Key===eg.a.dXj)Aa.a.J(512497748,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockId: {0}",Hc.Value),this.xq.r3=Hc.Value;else if(Hc.Key===eg.a.eXj)Aa.a.J(512497747,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received LockIsCoauthorable: {0}",Hc.Value),this.xq.UCg=Boolean.parse(Hc.Value);
else if(Hc.Key===eg.a.pXf)try{this.xq.k5a=Number.parseInvariant(Hc.Value),Aa.a.J(512497746,843,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - DeferredBlobCount: {0}",this.xq.k5a)}catch(fe){Aa.a.J(512497745,843,15,"Can't parse the notification message: {0}",fe)}else if(Hc.Key===eg.a.yGf){let fe;try{fe=Boolean.parse(Hc.Value),this.xq.minorVersionLimitReached=fe}catch(Te){fe=this.xq.minorVersionLimitReached=!1}fe&&!this.vje&&(this.tJi(),this.vje=!0);Aa.a.J(512497744,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Received AllowSaveAtMinorVersionLimit: {0}, m_fIsMinorVersionLimitReachedDisplayed: {1}",
Hc.Value,this.vje)}else Aa.a.J(512497743,817,50,"Notification key ignored {0}",Hc.Key)}}}}}}}Aa.a.J(512497742,817,50,"CoauthNotificationManager::OnDocNotifyClientItemsUpdated docItem.Key:{0}, ProcessNotificationStart:{1}, ProcessNotificationDuration:{2}",Hc.Key,Nc.a.$e(ie),(+new Date-+ie).toString());He&&!this.Mt.SDa&&Aa.a.J(512497741,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Dragging is stopped while processing docItem.Key:{0}",Hc.Key)}this.Tvl(c,f,b,l)}Qgj(a,b){const c=new Ha.a;
b=aj.e(b,f=>f.Key.startsWith(eg.a.J7d));for(const f of b)b=aK(f.Key),b.returnValue&&b.correlationID===a&&(1===b.zU?c.add(b.Jhb):1<b.zU&&c.addRange(iQ(f.Value)));return c}tJi(){this.yl.ZM(24);Aa.a.J(512497740,809,50,"CoauthNotificationManager::DisplayVersionLimitHitInfo reached - business bar for MinorVersionLimit")}FZf(){this.Cje=!0;this.yl.ZM(25);Aa.a.J(512497739,809,15,"CoauthNotificationManager::DisplayNetworkLocationUnauthorizedInfo reached - business bar for UserNetworkLocationUnauthorized Shown")}yCe(a){let b;
b=Object(Ma.a)(Fx,a)?()=>{this.Ee.raiseFixItSuggestionUpdatedEvent(Object(ua.a)(Fx,a))}:()=>{this.Ee.raiseDesignerSuggestionsUpdatedEvent(Object(ua.a)(Dz,a))};if(this.Mt.SDa&&this.Ha.processSuggestionNotificationInTaskIfInDragIsEnabled){const c=new xe.a(2,1,0,()=>{b()},90,Object(Ma.a)(Fx,a)?"114":"92");this.yb.Cb(c)}else b()}Tvl(a,b,c,f){a&&(this.Hla.Jlj(),this.m3c.instance&&this.m3c.instance.t8c());b.forEach(l=>{const x=l.pZb.Id;c.Rvl(eg.a.$3d(x.Sid,x.Cid),l.cfa)});this.Hla.Inj(b,f)}tsj(){Aa.a.J(512497738,
817,10,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Document was already opened by antoher DC.");this.Zb.Ci&&this.Zb.Ci.contentReplicator&&(this.Zb.Ci.contentReplicator.enabled=0);this.Md.FG(158,a=>{a.NB=1;return!1})}Hnj(a){Aa.a.J(512497737,829,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Failover notification received");this.kC.UGk(new fl(!1,!0));let b=null;this.m3c.instance&&(b=this.m3c.instance.tjj());this.qv.syncCurrentSlideIdAndPrefetchRange(this.ua.Ba,b,null,null);
this.pMg=a.Value}Coj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);if(this.Xa.podSessionId!==a)if(this.Ha.ignorePodSessionRefreshedFromPops)Aa.a.J(512497736,817,50,"CoauthNotificationManager::HandleLatestPodSessionNotification - Ignore Pop rehydrated Pod session");else{const b=this.Xa.podSessionId;this.Xa.podSessionId=a;this.DAb.hbh(new Bp.a(b,a))}else Aa.a.J(512497735,817,50,"CoauthNotificationManager::DocNotifyClientItemsUpdated - Same PodSessionId:{0}",a)}eoj(a){a=Sys.Serialization.JavaScriptSerializer.deserialize(a.Value);
try{if(a){const b=a.split(";",6);a=!0;for(let c=0;5>c;c++)if(!b[c]){a=!1;break}if(6>b.length||!a)Aa.a.J(512497733,817,15,"Invalid format of image description notification");else{const c=Ga.a.Mf(b[1]),f=Boolean.parse(b[2]),l=Boolean.parse(b[3]);this.iZc.gHk(new dK(c,f,l,parseFloat(b[4]),b[5]))}}else Aa.a.J(512497734,817,15,"Response data is null")}catch(b){Aa.a.J(512497732,817,15,"Can't parse the notification message: {0}",b)}}NVi(){let a=0;const b=[],c=(new Date).getTime(),f=this.ANg;for(let x in f){var l=
x;0<c-f[x]&&(a++,delete this.ANg[l])}(0<a||0<b.length)&&Aa.a.J(512497731,817,50,"FlushDocNotifyTelemetry - normal channel only:{0}, normal channel delay:{1}",a,Qa.a.join(b,","))}iYd(){this.NVi()}bvh(){if(this.qLg&&!this.jc.WK)Aa.a.J(512497730,801,50,"StartServerRtcConnection: Do not start server RTC in readonly mode");else{var a=fb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=zh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StartRtcConnection&source=Browser",
this.Ha.podsWebServiceBase),f=Object.assign(new YJ,{BaseDocQueryStringWithoutVersion:u.AFrameworkApplication.hh,SerializedUser:this.Ha.serializedBaseUser,SessionID:a}),l={};l.PodSID=a;l["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;l["X-CorrelationID"]=b;a=Yd.c(f);u.AFrameworkApplication.Ge.sV(c,2,a,l,[Jg.a.P4],0,x=>{this.ODg(50,String.format("EnqueueTime:{0}; InvokedTime:{1}; CompletedTime: {2}; ResponseData:{3}",x.data.aI,x.data.Kt,x.data.Wu,x.data.Sd))},x=>{const G=fb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");
this.ODg(10,G.Nia(x))},null,void 0,void 0,void 0,void 0,Ax.a("3"))}}uvh(){var a=fb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId;const b=zh.a.create().toString(),c=String.format("{0}PodHandler.ashx?action=StopRtcConnection",this.Ha.podsWebServiceBase),f={};f.PodSID=a;f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;f["X-CorrelationID"]=b;a=Object.assign(new ZJ,{SessionID:a});a=Yd.c(a);u.AFrameworkApplication.Ge.sV(c,2,a,f,[Jg.a.P4],0,()=>{Aa.a.J(38904456,801,50,
"StopServerRtcConnection - request succeeded")},l=>{const x=fb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager");Aa.a.J(38904458,801,10,"StopServerRtcConnection -  Failed with status code: {0}",x.Nia(l))},null,void 0,void 0,void 0,void 0,Ax.a("9"))}ODg(a,b){Aa.a.J(512497729,801,a,"StartServerRtcResult: {0}",b)}d$(){this.bvh()}jz(a,b){b.zae&&!this.jc.WK&&(Aa.a.J(512497728,801,50,"OnUnifiedAppStateChanged: Disconnect from server RTC in readonly mode"),this.uvh())}gB(){this.uvh()}}Object(e.a)(oD,
"CoauthNotificationManager",null,[]);class nK{constructor(a,b){this.fLh=a;this.I_e=b}get coauthoringStartTime(){return this.fLh}get PQf(){return this.I_e}k3k(a){this.I_e=a}}Object(e.a)(nK,"CoauthoringDurationRecord",null,[]);var kQ=d(931);class oK extends Sys.EventArgs{constructor(a,b,c=!1){super();this.YIf=a;this.$Bg=b;this.pIj=c}}Object(e.a)(oK,"EditorTableChangedEventArgs",Sys.EventArgs,[]);class Ez{constructor(a,b,c){this.Jla=this.sbb=null;this.I$a=[];this.mGg=new ti.a;this.wNg=new ti.a;this.Toe=
null;this.SHg=!1;this.Loe=0;this.gIg=this.l_c=!1;this.g3c="";this.$ih=null;this.minorVersionLimitReached=this.UGh=this.dyg=this.Yid=this.a4f=!1;this.uoe=null;this.UCg=!1;this.k5a=0;this.gVc=!1;this.SEa=a;this.Mc=b;this.oZc=0;this.fab=[];this.Mc.OId(Object(C.a)(this,this.Zdb,"onPopSessionClosed"));this.A6j=c}get yC(){return this.sbb}set yC(a){this.sbb!==a&&(this.sbb&&0<this.sbb.length&&2===this.oZc&&Aa.a.J(509670560,804,10,String.format("MyEditorID is changed from {0} to {1}",this.sbb,a)),this.sbb=
a)}get userName(){return this.Jla}get r$d(){return this.l_c}set r$d(a){(this.l_c=a)&&!this.gIg&&vf.Health.instance&&(this.gIg=!0,vf.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.l_c.toString()))}get ugc(){return this.g3c}set ugc(a){a!==this.g3c&&(this.g3c=a,Aa.a.J(509670558,804,50,"CoauthStateCache - PopsHostProtocol:{0}",this.g3c))}get r3(){return this.uoe}set r3(a){this.uoe=a;(a=this.A6j.value.instance)?(a.YOd=this.uoe,Aa.a.J(509670557,804,50,"CoauthStateCache::LockId - renameProps.CoauthLockId: {0}",
a.YOd)):Aa.a.J(509670556,804,50,"CoauthStateCache::LockId - renameProps == null");this.SEa.uHk()}get zZ(){const a=[];Array.addRange(a,this.fab);return a}get dAl(){return this.zZ.length?this.zZ.length:1}get amIAlone(){return 2!==this.Cba}get Zv(){return this.UCg}get Cba(){return this.oZc}set Cba(a){this.oZc!==a&&(Aa.a.J(509670554,804,50,"Coauth State Changing to: {0}",1===a?"alone":"coauthoring"),this.oZc=a)}get aBa(){return this.mGg.task}get r7c(){return this.wNg.task}get YKc(){return this.Toe}set YKc(a){this.Toe||
(this.Toe=a,this.wNg.Dg(a.getTime()))}fDh(a){let b;({WKd:a,leaving:b}=this.qwl(a)).returnValue&&(a=new oK(a,b,!this.gVc),this.QKk(),this.SEa.QGk(a))}QKk(){const a=[],b=this.zZ;for(const c of b)Array.add(a,c.ID)}Soc(a){const b=this.Cba;2===a&&(this.YKc=new Date);0!==b||this.SHg||(Aa.a.J(509670553,804,50,"Set coauthoring start point: {0}",1===a?"alone":"coauthoring"),this.SHg=!0,this.mGg.Dg(1===a?1:0));this.Cba=a;b!==this.Cba&&(this.SEa.BGk(new kQ.a(this.Cba)),this.Hvl(this.Cba))}Hvl(a){var b=new Date;
2===a?(b=new nK(b,new Date(9999,12,31)),Array.add(this.I$a,b)):(a=this.I$a.length,0<a&&this.I$a[a-1].k3k(b))}MDh(a){this.yC=a;Aa.a.J(509670552,814,50,"App::UpdateMyEditorID; MyClientId: {0}; EditorTableCount: {1}",this.yC,this.zZ.length);this.SEa.AGk()}Mib(a){let b;a&&(a=a.toLowerCase());b=null;for(let c=0;c<this.fab.length;c++){const f=this.fab[c];if(a===f.ID){b=f;break}}return{returnValue:!!b,editor:b}}qwl(a){let b,c;const f=[];b=[];c=[];let l=!1;const x=a?a.length:0;for(let G=0;G<x;G++){const R=
a[G];R&&R.ID&&(R.ID=R.ID.toLowerCase());let fa;({editor:fa}=this.Mib(R.ID)).returnValue?(l=l||!Ez.hMi(R,fa),Array.remove(this.fab,fa)):(R.ID!==this.sbb?Array.add(b,R):this.Jla=R.Name,l=!0);Array.add(f,R)}Array.addRange(c,this.fab);l=l||0<c.length;this.fab=f;this.Loe=Math.max(this.Loe,this.fab.length);vf.Health.instance&&vf.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.Loe.toString());return{returnValue:l,WKd:b,leaving:c}}CMc(a,b){let c=0;const f=this.I$a.length;if(0<f&&a<this.I$a[f-
1].PQf){a=a.getTime();b=b.getTime();for(let l=0;l<f;++l){const x=Math.max(this.I$a[l].coauthoringStartTime.getTime(),a),G=Math.min(this.I$a[l].PQf.getTime(),b);x<G&&(c+=G-x)}}return c}v1g(){this.dyg=!0;this.SEa.QHk()}Zdb(){this.ugc=""}static hMi(a,b){return a.EmailAddress===b.EmailAddress&&a.ColorIndex===b.ColorIndex&&a.Name===b.Name&&a.ID===b.ID&&a.SIPAddress===b.SIPAddress}}Object(e.a)(Ez,"CoauthStateCache",null,[1029,1030]);var iu=d(368);class ll{constructor(){this.KeyRoot=null;this.TimeStamp=
0}}Object(e.a)(ll,"KeyRootSubscription",null,[]);class Gv{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.Ecc=iu.a.empty;this.us=[];this.aua=[];this.jIg=this.ije=!1;this.JZc=a;this.k0c=b;this.We=c;this.CYc=wa.mfi;this.Hla=f;this.eZc=l;this.vj=x;this.Zbk=G.$Qd(1E3,Object(C.a)(this,this.QOi,"ensureVisibleThumbnailsSubscriptionImpl"));this.Mc=R;this.od=fa;this.Xa=wa;Wa.qHd(this);this.r9j=mb;this.G$b=Kb;this.cH=!1;this.r9j&&this.Mc.T5h(Object(C.a)(this,this.Wjk,"onBackendChanged"));this.Mc.IB(Object(C.a)(this,
this.ML,"onSessionClosed"));this.Mc.JB(Object(C.a)(this,this.to,"onSessionRehydrated"))}Sva(){this.cH=!1;this.eZc.reset();this.Pog()}Pog(){Array.clear(this.us);this.Ecc=iu.a.empty;this.Pld=this.Hla.Yna;this.od.kob(()=>{this.Pld=this.Hla.Yna});const a=new ll;a.KeyRoot=eg.a.i9f(this.CYc);a.TimeStamp=0;this.us.push(a);var b=new ll;b.KeyRoot=eg.a.z8g;b.TimeStamp=0;this.us.push(b);b=new ll;b.KeyRoot=eg.a.Kqi;this.us.push(b);var c=new ll;c.KeyRoot=eg.a.awh;this.us.push(c);c=new ll;c.KeyRoot=eg.a.J7d;this.us.push(c);
c=new ll;c.KeyRoot=eg.a.nsg;this.us.push(c);c=new ll;c.KeyRoot=eg.a.YXf;this.us.push(c);c=new ll;c.KeyRoot=eg.a.n4f;this.us.push(c);c=new ll;c.KeyRoot=eg.a.Gwh;this.us.push(c);const f=new ll;f.KeyRoot=eg.a.LBg;this.us.push(f);const l=new ll;l.KeyRoot=eg.a.kvj;this.us.push(l);var x=new ll;x.KeyRoot=eg.a.DRf;this.us.push(x);x=new ll;x.KeyRoot=eg.a.Bng;this.us.push(x);x=Object.assign(new ll,{KeyRoot:eg.a.N4f,TimeStamp:0});this.us.push(x);x=new ll;x.KeyRoot=eg.a.bng;this.us.push(x);this.G$b&&(x=new ll,
x.KeyRoot=eg.a.wyh,this.us.push(x));x=new ll;x.KeyRoot=eg.a.QHf;this.us.push(x);x=new ll;x.KeyRoot=eg.a.$wg;this.us.push(x);x=new ll;x.KeyRoot=eg.a.CBg;this.us.push(x);x=new ll;x.KeyRoot=eg.a.nch;this.us.push(x);x=new ll;x.KeyRoot=eg.a.i6f;this.us.push(x);x=new ll;x.KeyRoot=eg.a.yGf;this.us.push(x);const G=new ll;G.KeyRoot=eg.a.pXf;this.us.push(G);this.JZc.qlc(this.us);this.k0c&&(Array.clear(this.aua),this.aua.push(b),this.aua.push(a),this.aua.push(c),this.aua.push(f),this.aua.push(l),this.aua.push(x),
this.We.hA?(this.k0c.qlc(this.aua),this.ije=!0):this.We.Gfa?(this.Mc.PId(Object(C.a)(this,this.KWa,"onPopSessionInitialized")),this.jIg=!0):this.We.tgc.task.continueWith(()=>{this.We.hA&&this.k0c.qlc(this.aua)}))}KWa(){this.ije||(this.k0c.qlc(this.aua),this.ije=!0)}get Pld(){return this.Ecc}set Pld(a){iu.a.equals(this.Ecc,a)||(iu.a.equals(a,iu.a.empty)?this.Ecc=iu.a.empty:this.Ecc=iu.a.Esb(a.EZ,a.lastIndex),this.Zbk.perform())}Wjk(a,b){this.cH||(a=b.htk)&&0<a.length&&(Aa.a.J(512497699,817,50,"CoauthManager::OnBackendChanged - Backend machine id changed from {0} to {1}",
a,this.Xa.QCc),this.Sva())}ML(){this.cH=!0}to(){this.Sva()}QOi(){const a=this.us;var b=this.eZc;const c=[];var f=null;for(const x of this.Pld.b3){var l=eg.a.fij(x);f&&f.KeyRoot!==l&&(c.push(f),f=null);f||(f=new ll,f.KeyRoot=l,f.TimeStamp=Number.MAX_VALUE);if(l=this.Hla.cub(x))l=b.S0d(eg.a.$3d(l.sid,l.cid)),f.TimeStamp>l&&(f.TimeStamp=l)}f&&c.push(f);aj.d(a,Object(C.a)(this,this.wRi,"fNeedResetBrowserKeySubscription"),x=>{x.TimeStamp=0},1);b=aj.e(a,x=>x.KeyRoot.startsWith(eg.a.xyh));f=aj.a(c,b,Gv.rde);
aj.a(b,f,Gv.rde);if(b.length||c.length)aj.a(a,b,Gv.rde),Array.addRange(a,c),this.JZc.qlc(a)}wRi(a){return a.KeyRoot.startsWith(eg.a.i9f(this.CYc))&&!this.vj.yC?(Aa.a.J(512497698,817,50,"CoauthSubscriptionManager::ResetBrowserKeyIfNeeded; Resetting timestamp of BrowserID Key subscription as clientId has not been received"),!0):!1}dispose(){this.Mc.Oea(Object(C.a)(this,this.ML,"onSessionClosed"));this.Mc.Pea(Object(C.a)(this,this.to,"onSessionRehydrated"));this.jIg&&this.Mc.qGe(Object(C.a)(this,this.KWa,
"onPopSessionInitialized"))}static rde(a,b){return a.KeyRoot===b.KeyRoot}}Object(e.a)(Gv,"CoauthSubscriptionManager",null,[1028,106,1027]);class pK extends Sys.EventArgs{constructor(){super();this.items=null}}Object(e.a)(pK,"ItemsModifiedEventArgs",Sys.EventArgs,[]);class qK{constructor(a,b,c,f,l,x){this.id=zh.a.create();this.PYc=a;this.jg=b;this.Xa=c;this.Ha=l;this.Md=f;this.nX=x}Pqj(a,b){this.nX&&!this.PYc.rW&&this.nX.aIc(a.TX);a&&a.telemetry&&0<a.telemetry.length&&this.jg.mWa(a.telemetry);Nc.a.cF(this.jg,
()=>{this.PYc.O1g(this.id,a.result,a.TX,b)})}Oqj(a,b,c){if(!this.PYc.rW&&(this.nX&&this.nX.aIc(a.TX),a&&a.error&&this.Ha.pptFailoverInLongPollingFailHandlerEnabled&&a.error.Pm===Jf.a.Qh(223))){Aa.a.J(35497247,801,15,"LongPollingResponseHandler::HandleRequestFailedEventHandler. The server is unable to find PodSessionId:{0}.",this.Xa.podSessionId||"NULL");this.Md.es(Object.assign(new bg.a,{Code:223,Source:6}),c);return}Nc.a.cF(this.jg,()=>{this.PYc.O1g(this.id,null,a.TX,b)})}}Object(e.a)(qK,"LongPollingResponseHandler",
null,[]);var lQ=d(860);class pD{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){this.PFa=this.LFa=null;this.zMg=zh.a.nil;this.DBb=this.jUa=0;this.SGg=[10,100,1E3,1E4];this.TUa=null;this.eX=[];this.E3=Wa?"GetPopWacUpdates":"GetUpdates";this.n4=a;this.Xa=c;this.We=f;this.Mc=l;this.L8=x;this.Md=G;this.jc=R;this.nX=fa;this.Mc.IB(Object(C.a)(this,this.ML,"onSessionClosed"));this.Mc.A3a(Object(C.a)(this,this.sea,"onSessionRehydrating"));this.Mc.JB(Object(C.a)(this,this.to,"onSessionRehydrated"));this.We.Gfa&&Wa&&
(this.Mc.PId(Object(C.a)(this,this.KWa,"onPopSessionInitialized")),this.Mc.OId(Object(C.a)(this,this.Zdb,"onPopSessionClosed")));this.Jse=a.lol;this.z5j=a.qMj;this.GAb=a.b7g;this.Lzb=[];b.o7a().qHd(this);this.rbk=wa;this.HQh=Wa;this.mka=!1;this.AAb=Wa?3E4:6E4}ML(){this.close("SessionClosed")}sea(){this.TUa&&this.TUa.Jmd()}to(){this.lIa("SessionRehydrated")}O1g(a,b,c,f){this.LFa=null;const l=+new Date-+this.PFa;if(this.mka)Aa.a.J(512360732,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since DocNotifyClient is closed.",
this.E3);else if(a.equals(this.zMg))if(this.n4.clientIgnoreClosePopsErrorCodeEnable&&this.rW&&this.mka)Aa.a.J(512360730,801,50,"DocNotifyClient.PerformCall - {0} - ignore the server response since pops is closing.",this.E3);else if(a=this.We.Qca,f&&f.length&&a!==f)Aa.a.J(512360729,801,15,"DocNotifyClient.PerformCall - {0} - Ignore {1} response since PopSessionId is changed. CurrentPopSession:{2}; LastAttemptedEnsureHostSessionId:{3}; RequestPopSession:{4}; RetryAttempts:{5}. Triggering another request in {6}ms.",
this.E3,b?"Success":"Failure",this.Xa.Bk,this.We.Qca,f,this.DBb,this.Jse),this.DBb++,this.U3f(l,this.DBb)||this.wkc(this.Jse);else if(this.DBb=0,b){this.PFa=new Date;this.jUa=0;this.We.Jde=this.PFa;this.We.Ide=f;Aa.a.J(512360727,801,50,"DocNotifyClient.OnResponseReceived - {0} - Success response. TimeSinceLastServerConnected:{1}, Now:{2}, PopSessionID:{3}",this.E3,l,Nc.a.$e(new Date),this.rW?this.Xa.Bk:"Not Applicable");c=0;f={};for(const x of b.Items)x.TimeStamp>c&&(c=x.TimeStamp),f[x.LastRequestCorrelationID]=
x.LastRequestCorrelationID in f?String.format("{0},{1}",f[x.LastRequestCorrelationID].toString(),x.Key):x.Key,aj.d(this.Lzb,G=>x.Key.startsWith(G.KeyRoot),G=>{x.TimeStamp>G.TimeStamp&&(G.TimeStamp=x.TimeStamp)},1);this.wkc(this.Jse);0<Object.keys(f).length&&Nc.a.qk("RequestCorrelationIDsAndKeyRoots",Fi.c(f));c=new Date;Nc.a.cF(Nc.a.Eb,()=>{const x=Object.assign(new pK,{items:b.Items});for(const G of this.eX)try{G(this,x)}catch(R){Aa.a.J(512360726,801,15,"DocNotifyClient::OnResponseReceived - {0} - Unhandled exception notifying clients {1}, {2}",
this.E3,R.toString(),R.stack)}});Nc.a.qk("ProcessItemStartTime",Nc.a.$e(c));Nc.a.qk("ProcessItemDurationInMS",(+new Date-+c).toString());Nc.a.Eb.finish()}else Aa.a.J(512360728,801,15,"DocNotifyClient.PerformCall - {0} - NULL response, TimeSinceLastServerConnected:{1}, RequestStatus:{2}, HttpStatusCode:{3}, PodSessionId:{4}, PopSessionId:{5}",this.E3,l,c?c.status:3,c?c.Le:-1,this.Xa.podSessionId,this.rW?this.Xa.Bk:"Not Applicable"),this.U3f(l,this.jUa)||(f=3<=this.jUa?this.SGg[3]:this.SGg[this.jUa],
this.jUa++,this.wkc(f),Nc.a.qk("FailureCountSinceLastSuccess",this.jUa.toString()),Nc.a.qk("NextDelayInMS",f.toString()),c&&(Nc.a.qk("RequestStatus",jk.a[c.status]),Nc.a.qk("HttpStatus",c.Le.toString()),Nc.a.qk("Duration",(+c.Wu-+c.Kt).toString())),Nc.a.Eb.finish());else Aa.a.J(512360731,801,50,"DocNotifyClient.PerformCall - {0} - requestID not matched.",this.E3)}U3f(a,b){return this.rW&&(a>=this.GAb||b>this.n4.getHostSessionInfoMaxRetryCount)?(Aa.a.J(512360725,801,15,"DocNotifyClient.PerformCall - {0} - Failed enough times, for a time long enough. FailureCount:{1}, PopSessionId:{2}, PopSessionInitialized:{3}",
this.E3,b,this.Xa.Bk,this.We.hA),!0):!1}close(a){Aa.a.J(512360724,801,50,"DocNotifyClient.Close - {0} - Reason: {1}",this.E3,a);this.mka=!0;this.TUa&&this.TUa.Jmd()}wkc(a){const b=Nc.a.Pl(this.E3,2);b.Wa("DelayInMS",a.toString());this.z5j?Nc.a.z$(()=>{Nc.a.cF(b,Object(C.a)(this,this.w6g,"performCall"))},a,0):window.setTimeout(()=>{Nc.a.cF(b,Object(C.a)(this,this.w6g,"performCall"))},a)}w6g(){if(!this.enabled||u.AFrameworkApplication.Vg||this.LFa&&+new Date-+this.LFa<this.AAb||this.rW&&!this.jc.WK||
this.L8.EUc)Aa.a.J(512360723,801,50,"DocNotifyClient.PerformCall - {0} - Skipped. Enabled:{1}, IsShuttingDown:{2}, LastCallStartTime:{3}, Now:{4}, PerformCallExpireTimeInMs:{5}, IsNonDismissibleDialogShown:{6}, AppInReadMode:{7}, AppInReadModeAndCanNotEditAnyway:{8}",this.E3,this.enabled,u.AFrameworkApplication.Vg,this.LFa?Nc.a.$e(this.LFa):"null",Nc.a.$e(new Date),this.AAb,this.L8.EUc,!this.jc.un,!this.jc.WK);else{var a=zh.a.create().toString();Aa.a.J(512360722,801,50,"DocNotifyClient.PerformCall - {0} - Executed, LastCallStartTime:{1}, Now:{2}, PerformCallExpireTimeInMs:{3}, PopSessionId:{4}, CorrelationId:{5}",
this.E3,this.LFa?Nc.a.$e(this.LFa):"null",Nc.a.$e(new Date),this.AAb,this.rW?this.Xa.Bk:"Not Applicable",a);if(!this.rW){var b=aj.e(this.Lzb,x=>x.KeyRoot===eg.a.z8g);b&&b.length&&Aa.a.J(512360721,801,50,"Getupdates. CurrentTimestamp:{0}",b[0].TimeStamp)}this.LFa=new Date;b=Nc.a.Eb;var c=new qK(this,b,this.Xa,this.Md,this.n4,this.rW?null:this.nX);this.zMg=c.id;this.TUa=new lQ.a;var f=this.rW?this.Xa.Bk:"",l=this.rW?"":this.Xa.podSessionId;b.Wa(si.a.Jqb,a);this.rbk(f,this.Xa.presentationId.string,this.Lzb,
x=>{c.Pqj(x,f)},x=>{c.Oqj(x,f,l)},this.TUa,{["X-CorrelationId"]:a},null,this.AAb)}}get enabled(){return 0<this.Lzb.length&&!this.mka}get rW(){return this.HQh}Wmc(){this.We.Gfa||this.We.tgc.task.continueWith(()=>{this.nye()})}KWa(){this.lIa("PopSessionInitialized")}Zdb(){this.close("PopsUninitialized")}nye(){this.We.hA?this.lIa("PopSessionInitialized"):this.close("PopsUninitialized");this.Wmc()}qlc(a){a||(a=[]);Aa.a.J(512360719,801,50,"DocNotifyClient.SetSubscriptions - {0} - {1} subscriptions.",this.E3,
a.length);for(const b of a);this.Lzb=a;this.PFa=new Date;this.DBb=this.jUa=0;this.rW&&!this.We.Gfa&&this.Wmc();this.wkc(0)}eFf(a){Array.add(this.eX,a)}Sva(){this.lIa("AppListener:OnReboot")}lIa(a){Aa.a.J(512360718,801,50,"DocNotifyClient.Reboot - {0} - Reason: {1}, PopSession: {2}",this.E3,a,this.rW?this.Xa.Bk:"Not Applicable");this.rW&&"PopSessionInitialized"===a&&this.aWk();this.mka=!1;this.LFa=null;this.PFa=new Date;this.DBb=this.jUa=0;this.TUa&&this.TUa.Jmd();this.wkc(0)}aWk(){for(const a of this.Lzb)a.TimeStamp=
0}dispose(){this.Mc.Oea(Object(C.a)(this,this.ML,"onSessionClosed"));this.Mc.sGe(Object(C.a)(this,this.sea,"onSessionRehydrating"));this.Mc.Pea(Object(C.a)(this,this.to,"onSessionRehydrated"));this.rW&&this.We.Gfa&&(this.Mc.Bfh(Object(C.a)(this,this.Zdb,"onPopSessionClosed")),this.Mc.qGe(Object(C.a)(this,this.KWa,"onPopSessionInitialized")))}}Object(e.a)(pD,"DocNotifyClient",null,[298,106,299,1027]);class qD{constructor(){this.VWc=0}}Object(e.a)(qD,"TimeStampData",null,[]);class rK{constructor(){this.XEa=
{}}reset(){this.XEa={}}copy(a){this.reset();a=a.XEa;for(let f in a){var b=f,c=a[f];const l=new qD;l.VWc=c.VWc;this.XEa[b]=l}}Rvl(a,b){var c=a in this.XEa?this.XEa[a]:new qD;this.XEa[a]=c;c=this.XEa;for(let l in c){var f=c[l];l.startsWith(a)&&(f.VWc=b)}}S0d(a){return a in this.XEa?this.XEa[a].VWc:0}}Object(e.a)(rK,"HermesContentTimeStampManager",null,[300]);var Gx=d(299);class Hx{constructor(a,b,c,f=null){this.Iae=a;this.aea=b;this.Idc=c;this.Ba=f}}Object(e.a)(Hx,"SlideMoveData",null,[]);var mQ=d(636),
Oj=d(297);class sK{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){this.W8b=this.Tta=null;this.lT=0;this.xF=null;this.rle=0;this.QYc=null;this.Zle=this.z1c=this.nKg=this.pKg=0;this.GI=this.FGa=this.RW=null;this.vla=this.H1c=0;this.aq=a;this.Fa=b;this.ia=c;this.Zb=f;this.ua=l;this.Mt=x;this.uc=G;this.jc=R;this.Qt=fa;this.K_=this.aq.aU;this.Xab=wa;this.ra=Wa;this.zq=mb;this.ep=Kb;this.tta=nc}gzj(){this.lT=-1;this.Tta=document.createElement("div");this.Tta.style.visibility=te.a.As;this.Tta.className=
Oj.a.ZKi;this.K_.appendChild(this.Tta);this.rle=this.vla=this.H1c=0;if(this.tta){this.W8b=document.createElement("div");this.W8b.className=Oj.a.Mkj;const a=document.createElement("span");a.className=Oj.a.Nkj;this.W8b.appendChild(a)}}dispose(){this.K_.removeChild(this.Tta);this.Mt.yE(this.K_,this);this.Tta=this.xF=null}mv(a){return a?this.tI(a).returnValue:!1}tI(a){var b=null;if(3===a.Wf||a.dA!==Sys.UI.MouseButton.leftButton||!this.K_.contains(a.Ac)||!this.jc.un)return{returnValue:!1,Brb:b,a3:null};
var c=a.clientPoint.y-this.QSe+this.K_.scrollTop;b=a.clientPoint.x-this.K_.offsetLeft;this.Qt&&(b-=this.K_.offsetWidth-this.K_.clientWidth);b=this.dij(b,c);if(!b||!b.SS)return{returnValue:!1,Brb:b,a3:null};if(this.tta){a=this.ra.nf();if(1>a.length)return{returnValue:!1,Brb:b,a3:null};for(var f of a)if(f.qN||32!==this.ia.La(ba.a.IDe,1,f.Bb))return{returnValue:!1,Brb:b,a3:null};f=this.aq.qY-this.ra.nf().length+1;this.nKg=Math.min(this.x9f(c),f);this.pKg=Math.min(b.slideIndex,f-1)}else if(c=b.slideId,
Oe.a.Sw(c)||32!==this.ia.La(ba.a.IDe,1,c))return{returnValue:!1,Brb:b,a3:null};return{returnValue:!0,Brb:b,a3:null}}Du(a){if(!a)return!1;this.Tta||this.gzj();this.QYc=mQ.a(0,0);if(!({Brb:this.RW,a3:G}=this.tI(a)).returnValue)return!1;if(this.ep){var b=!1,c=this.RW.slideId,f=this.ra.nf();for(var l of f)if(l.Bb.equals(c)){b=!0;break}if(b){if(this.GI=this.ua.Ba,1<f.length&&!this.tta)return!1}else this.ra.Uh(),this.GI=this.RW.Ed,this.ra.bY(this.RW.Ed)}if(this.tta){this.DEh();var x=this.RW.Vub;var G=x.cloneNode(!0);
b=G.getElementsByTagName("img")[0];this.anh(b,Oj.a.F4d,Oj.a.E4d,Oj.a.X5f,Oj.a.X5f);G.className=Oj.a.qig;c=this.ra.nf();f=1;if(1<c.length){for(l=0;l<c.length;l++)if(this.RW.slideIndex!==c[l].slideIndex){f++;x=this.aq.LZ(c[l].slideIndex).Vub;x=(x=x.getElementsByTagName("img"))&&0<x.length?x[0].cloneNode(!0):b.cloneNode(!0);const R=Oj.a.E4d*f;this.anh(x,Oj.a.F4d-f,Oj.a.E4d-1,R,R);G.appendChild(x);if(3===f)break}G.appendChild(this.W8b);this.W8b.firstChild.innerText=this.ra.nf().length.toString()}this.xF?
this.aq.aU.replaceChild(G,this.xF):this.aq.aU.appendChild(G);this.xF=G}else b=this.RW.Vub,this.xF?(b=this.xF.getElementsByTagName("img"),G=G.cloneNode(!0),G.style.zIndex=String(Oj.a.F4d),this.xF.replaceChild(G,b[0]),this.xF.style.zIndex=String(Oj.a.Kkj)):(this.xF=b.cloneNode(!0),this.aq.aU.appendChild(this.xF),this.xF.className=Oj.a.qig);this.rle=parseInt(dh.a.It(this.xF).height);$e.a.kna(this.xF,Oj.a.U4g+Oj.a.p4g+Oj.a.apg,this.Qt);this.xF.style.visibility=te.a.oz;this.xF.style.cursor=te.a.Qmc;u.AFrameworkApplication.Wj("Microsoft.Office.Server.Powerpoint.Web.IPptSlideReorderingImprovementSettings");
Aa.a.J(512497671,819,50,"PPT drag slide start.");this.mw(a);return!0}DEh(){this.z1c=this.nKg;this.Zle=this.pKg;let a=0;for(let b=0;b<this.aq.qY;b++){const c=this.aq.LZ(b);c.isSelected?c.bpc(-2):(a===this.RW.slideIndex&&(a+=1),c.bpc(a),a++)}}anh(a,b,c,f,l){a.className=Oj.a.Jkj;a.style.zIndex=String(b);a.style.borderWidth=c.toString()+"px";a.style.top=f.toString()+"px";a.style.left=l.toString()+"px"}mw(a){if(!a)return!1;var b=a.clientPoint,c=b.y-this.QSe+this.K_.scrollTop,f=this.rle/2;if(this.Xab){if(r.a.US&&
!a.mc.rawEvent.buttons)return Aa.a.J(512497670,819,50,"PPT cancel drag slide in IE/Edge because release mouse button outside of the browser window."),!1;this.xF.style.top=Math.min(c-f,this.tta?Gx.a.HU+(this.aq.qY-this.ra.nf().length)*this.aq.hra:Gx.a.HU+this.aq.qY*this.aq.hra)+"px"}else{a=this.j2b(this.aq.qY)+this.aq.hra/2;if(this.yRi(b.x)||c>a)return this.Enh(),!0;this.xF.style.top=c-f+"px"}this.$mh(!0);this.Pmi(b.y);this.I3k(Math.min(this.x9f(c),this.tta?this.aq.qY-this.ra.nf().length+1:this.aq.qY));
this.Tta.style.visibility=this.bVc(b)&&!this.tta?te.a.oz:te.a.As;if(this.tta&&0<=this.lT)if(this.bVc(b)){this.xF.style.visibility=te.a.oz;if(this.z1c===this.lT)return!0;b=this.z1c<this.lT?0>this.lT-1?0:this.lT-1:0>this.lT?0:this.lT;c=0;for(f=0;f<this.aq.qY;f++)a=this.aq.LZ(f),a.isSelected||(c<b?a.bpc(c):a.bpc(c+1),c++);this.z1c=this.lT;this.Zle=b}else this.DEh(),this.xF.style.visibility=te.a.As;return!0}Sn(a){if(!this.ua.presentation)throw Error.argumentNull("Presentation is null");var b=a.clientPoint;
if(this.tta){if(a=this.ra.nf(),0<a.length&&0<=this.lT&&this.bVc(b)){b=[];for(const c of a)c&&b.push(Object(ua.a)(119,c));this.fol(b,this.Cfj(this.Zle));Aa.a.J(512497669,819,50,"PPT drag slide succeed.")}}else 0<=this.lT&&this.RW&&this.bVc(b)&&this.RW.slideIndex!==this.lT&&this.RW.slideIndex+1!==this.lT&&(this.$nl(this.RW.slideIndex,this.lT),Aa.a.J(512497668,819,50,"PPT drag slide succeed."));this.rK()}Cfj(a){let b=0;for(let c=0;c<this.aq.qY;c++)if(!this.aq.LZ(c).isSelected&&(b++,a===b))return c+1;
return 0}bVc(a){a=a.x>=this.K_.offsetLeft&&a.x<=this.K_.offsetLeft+this.K_.offsetWidth;return!this.Xab||a}Yt(){this.rK()}dij(a,b){if(!this.aq.hra)return null;var c=Math.floor((b-Gx.a.HU)/this.aq.hra);if(0<=c&&c<=this.aq.qY-1){c=this.aq.LZ(c);if(!c)return null;const f=c.qib;a=this.Qt?a-parseInt(f.style.right.replace("px","")):a-parseInt(f.style.left.replace("px",""));b-=parseInt(f.style.top.replace("px",""));if(0<=a&&0<=b&&a<=f.clientWidth&&b<=f.clientHeight)return c}return null}yRi(a){return this.Qt?
this.QYc.width-Oj.a.z_f>a||this.QYc.width<a:0>a||Oj.a.z_f<a}Pmi(a){const b=a-this.QSe,c=this.QYc.height;if(Oj.a.GJf>b)this.vla=-Oj.a.FJf;else if(Oj.a.IJf>b)this.vla=-Oj.a.HJf;else if(Oj.a.KJf>b)this.vla=-Oj.a.JJf;else if(c-Oj.a.GJf<a)this.vla=Oj.a.FJf;else if(c-Oj.a.IJf<a)this.vla=Oj.a.HJf;else if(c-Oj.a.KJf<a)this.vla=Oj.a.JJf;else{this.vla=0;return}this.v6g()}v6g(){if(0!==this.vla){const a=this.H1c,b=(new Date).getTime();0<a&&(this.K_.scrollTop=Math.max(0,this.K_.scrollTop+Math.floor((b-a)*this.vla/
1E3)));this.H1c=b;window.setTimeout(Object(C.a)(this,this.v6g,"performAutoScrolling"),Oj.a.gdi)}else this.H1c=0}j2b(a){return this.aq.hra*a+Gx.a.HU*(this.Xab?.75:1)}x9f(a){a+=this.aq.hra/2;a-=Gx.a.HU;a=Math.floor(a/this.aq.hra);return this.Xab?Math.max(0,a):a}I3k(a){this.lT!==a&&(this.lT=a,0>this.lT||(this.Tta.style.top=$e.a.Nc(this.j2b(a))))}Enh(){this.$mh(!1)}$mh(a){this.xF.style.cursor=a?te.a.Qmc:te.a.akl}$nl(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");
if((this.FGa=Qa.a.clone(this.ua.presentation.CJ))&&!(b>this.FGa.length||a>=this.FGa.length)){var f=null;a=c.j3d(a);b&&(f=c.j3d(b-1));b=new Hx(!1,[a],f);this.ia.La(ba.a.Odc,2,b)}}fol(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");!(this.FGa=Qa.a.clone(this.ua.presentation.CJ))||b>this.FGa.length||!this.kLj(a,b)||(b=b?c.j3d(b-1):null,a=new Hx(!1,a,b,this.GI),this.ia.La(ba.a.Odc,2,a))}kLj(a,b){const c=Object.assign(new Ha.a,{});for(var f=0;f<a.length;f++)c.add(a[f].slideIndex);
c.Sc((l,x)=>l-x);a=c.count;for(f=0;f<a-1;f++)if(1!==c.ga(f+1)-c.ga(f))return!0;return c.ga(0)<=b&&c.ga(a-1)+1>=b?!1:!0}rK(){this.Wul();this.Enh();this.xF.style.visibility=te.a.As;this.xF.style.top="0px";this.xF.style.cursor=te.a.mA;this.Tta.style.visibility=te.a.As;if(this.tta){const a=this.zq.ke(3);try{const b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a.gd(b);a.jJa(this.aq.Ma);const c=b.slides||[];for(const f of c){const l=Object(ua.a)(120,f);l&&l.anchor.Uj(this.aq.Ma,
16)}}finally{a&&a.dispose()}this.aq.hYa()}this.vla=0;this.RW&&(this.RW=null);this.Fa.ze&&this.Fa.ze.name===Yb.a.vE||this.Fa.Bf(Yb.a.vE)}Wul(){this.ep?this.GI&&(this.Zb.Ba=this.uc.kl(this.GI.Bb)):this.RW&&(this.Zb.Ba=this.RW.Ed)}get QSe(){let a=this.K_,b=0;for(;a;)b+=a.offsetTop,a=a.offsetParent;return b}}Object(e.a)(sK,"ThumbnailNavPaneDragAdapter",null,[308,232,106]);class rD{}rD.e0h=[ba.a.print,ba.a.find,ba.a.Z4,ba.a.D5a,ba.a.Gbd,ba.a.Fbd,ba.a.bringForward,ba.a.bringToFront,ba.a.sendBackward,ba.a.sendToBack,
ba.a.Tha,ba.a.Qld,ba.a.Rld,ba.a.DZa,ba.a.CZa,ba.a.tib,ba.a.rib,ba.a.ZYa,ba.a.DIb,ba.a.pKb,ba.a.Akc,ba.a.ifa,ba.a.H0,ba.a.D8a,ba.a.zhb,ba.a.Ahb,ba.a.Bhb,ba.a.Chb,ba.a.Tjc,ba.a.Ujc,ba.a.Vjc,ba.a.Wjc,ba.a.Yfd,ba.a.ikc,ba.a.dIe,ba.a.Zfd,ba.a.v4a,ba.a.x6a,ba.a.Cia,ba.a.FYa,ba.a.GYa,ba.a.HYa,ba.a.Elc,ba.a.XHb,ba.a.AHb,ba.a.UHb,ba.a.Vgb,ba.a.hhb,ba.a.WM,ba.a.qS,ba.a.dea,ba.a.ydb,ba.a.vdb,ba.a.xdb,ba.a.wdb,ba.a.Oeb,ba.a.Neb,ba.a.ehk,ba.a.qCk,ba.a.Zqi,ba.a.$qi,ba.a.Jue,ba.a.Kue,ba.a.Lue,ba.a.Mue,ba.a.usk,
ba.a.Hri,ba.a.deleteComment,ba.a.hvb,ba.a.kSc,ba.a.tUk,ba.a.fhk,ba.a.rCk,ba.a.Tnc,ba.a.Mnc,ba.a.Onc,ba.a.Nnc,ba.a.Rnc,ba.a.Qnc];Object(e.a)(rD,"ActionHandledList",null,[]);class Ks{constructor(a,b,c,f){this.W_=new ah.a;this.sre=new ah.a;this.ia=a;this.Ha=b;this.ra=c;this.lh=f;this.Jyj();this.Kyj()}moj(a,b,c=null){this.Ha.remapShapeEditCommandEnabled&&((this.ra.JG()||this.ra.wu())&&this.W_.Jb(a)?a=this.W_.ga(a):this.ra.cC()&&this.sre.Jb(a)&&(a=this.sre.ga(a)));if(this.Ha.podsTableRTTEnabled&&this.Ha.podsTableCellLockEnabled&&
Array.contains(Ks.KYk,a)&&(this.ra.h8()||this.ra.VKj()))return 32;if(!Array.contains(rD.e0h,a))return this.ia.La(a,2,b,c);const f=this.ia.oq,l=this.ia.LS;let x=this.ia.La(a,1,b);32===x&&(this.Ha.pptDragCancelFix&&(this.ia.oq=f,this.ia.LS=l),x=this.ia.La(a,2,b,c));return x}gal(a){return this.lh.Zrb!==a&&this.lh.$rb!==a}psb(a,b,c){return b&&b.name===Yb.a.Bg&&!this.ra.wu()&&1===this.ra.Yd().length&&this.ra.cC()&&this.gal(c)?a.psb(a.Dc(b.parent),c):a.psb(b,c)}Jyj(){this.W_.$(E.a.upArrow,ba.a.Chb);this.W_.$(E.a.downArrow,
ba.a.zhb);this.W_.$(E.a.leftArrow,ba.a.Ahb);this.W_.$(E.a.rightArrow,ba.a.Bhb);this.W_.$(E.a.ZHb,ba.a.Wjc);this.W_.$(E.a.jhb,ba.a.Tjc);this.W_.$(E.a.PYa,ba.a.Ujc);this.W_.$(E.a.QYa,ba.a.Vjc);this.W_.$(E.a.ura,ba.a.Akc);this.W_.$(E.a.rWa,ba.a.tib);this.W_.$(E.a.qWa,ba.a.rib);this.W_.$(ba.a.Tha,ba.a.ZUb);for(const a of Ks.bZk)this.W_.$(a,F.a.Ae)}Kyj(){for(const a of Ks.cZk)this.sre.$(a,F.a.Ae)}}Ks.bZk=[E.a.rBa,E.a.sBa,E.a.dYb,E.a.Xqb,E.a.YOa,E.a.ZOa,E.a.Z4a,E.a.XOa,E.a.udb,E.a.WPa,E.a.V5a,E.a.tdb,E.a.VPa,
E.a.U5a];Ks.cZk=[ba.a.D5a,ba.a.x6a,ba.a.Cia,ba.a.pKb];Ks.KYk=[E.a.backspace,E.a.wK,ba.a.v4a];Object(e.a)(Ks,"ProcessInputStrategy",null,[305]);class tK{get pFc(){return[361033,9175267,13924352,749464,2893476,15559503,11745730,8880899,3750201,748043,12084359,1837941,7632250,9195008,3036814,8288617,9967496,7363328]}}Object(e.a)(tK,"PPTColorTable",null,[297]);var nQ=d(932);class uK{constructor(){this.j4c={}}J_d(a){return a&&a in this.j4c?this.j4c[a]:null}jLf(a,b){a&&b&&a!==b&&(a in this.j4c||(this.j4c[a]=
b))}}Object(e.a)(uK,"PresenceEmailConverter",null,[1026]);var vK=d(879),Ix;(function(a){a[a.appInitInteractivityReady=0]="appInitInteractivityReady";a[a.appInitChromeReady=1]="appInitChromeReady";a[a.B2I=2]="B2I";a[a.fHasTabSwitch=3]="fHasTabSwitch";a[a.presentationIdReady=4]="presentationIdReady";a[a.earlyDownloadEditorTableCount=5]="earlyDownloadEditorTableCount";a[a.earlyDownloadEditorTable=6]="earlyDownloadEditorTable";a[a.firstCoauthoringStatus=7]="firstCoauthoringStatus";a[a.presenceJsLoadStart=
8]="presenceJsLoadStart";a[a.peoplesWellPackageRegister=9]="peoplesWellPackageRegister";a[a.peoplesWellPackageConfig=10]="peoplesWellPackageConfig";a[a.peoplesWellInit=11]="peoplesWellInit";a[a.peoplesWellInited=12]="peoplesWellInited";a[a.peopleWellPageHiddenDuration=13]="peopleWellPageHiddenDuration";a[a.peoplesWellControlViewRefresh=14]="peoplesWellControlViewRefresh";a[a.peoplesWellUpdateTriggered=15]="peoplesWellUpdateTriggered";a[a.peoplesWellUpdateTriggeredAfterChromeReady=16]="peoplesWellUpdateTriggeredAfterChromeReady";
a[a.peoplesWellDisplayed=17]="peoplesWellDisplayed";a[a.jquerySignalRLoadStart=18]="jquerySignalRLoadStart";a[a.jquerySignalRLoadEnd=19]="jquerySignalRLoadEnd";a[a.presence1JsLoadStart=20]="presence1JsLoadStart";a[a.presencePackageRegister=21]="presencePackageRegister";a[a.presencePackageConfigure=22]="presencePackageConfigure";a[a.presencePackageInitInternalStart=23]="presencePackageInitInternalStart";a[a.presencePackageInit=24]="presencePackageInit";a[a.presencePackageInited=25]="presencePackageInited";
a[a.usedEarlyFindSessionResult=26]="usedEarlyFindSessionResult";a[a.startRTCConnection=27]="startRTCConnection";a[a.rtcConnected=28]="rtcConnected";a[a.rehydrationCount=29]="rehydrationCount";a[a.presenceCount=30]="presenceCount";a[a.presenceDisplayed=31]="presenceDisplayed";a[a.presencePageHiddenDuration=32]="presencePageHiddenDuration";a[a.presenceUpdateNotificationReceived=33]="presenceUpdateNotificationReceived";a[a.presenceUpdateProcessed=34]="presenceUpdateProcessed";a[a.presenceFirstMessageSent=
35]="presenceFirstMessageSent";a[a.coauthoringStartTime=36]="coauthoringStartTime";a[a.isSecondUser=37]="isSecondUser";a[a.getFirstPresenceStateUserCount=38]="getFirstPresenceStateUserCount";a[a.receivedCompletePeristentState=39]="receivedCompletePeristentState";a[a.networkConnectivityLoss=40]="networkConnectivityLoss"})(Ix||(Ix={}));Object(e.b)("EntryName",Ix);class wK{constructor(a,b,c,f){this.Ho=null;this.lqe=this.a3c=0;this.Fne=this.HKg=this.Rme=this.f1c=!1;this.Qfe=this.Rfe=this.Ble=this.hge=
this.$ke=0;this.TYc=this.hje=null;this.r3c=new ti.a;this.xPg=new ti.a;this.HOg=new ti.a;this.Wje=this.ake=!1;this.Rac=a;this.Qqe=b;this.vj=c;f.execute(l=>{this.Ho=l});this.mX={};kn.Task.WAA(this.vj.aBa,this.r3c.task,this.xPg.task).continueWith(()=>{try{this.Cmh(),this.AJc(this.mX),0<ta.a.count(this.mX)&&Z.ULS.sendTraceTag(51242144,814,15,ta.a.toJSON(this.mX)),this.ake=!0}catch(l){Z.ULS.sendTraceTag(51242145,814,10,l.toString())}});kn.Task.WAA(this.vj.aBa,this.HOg.task).continueWith(()=>{try{this.Cmh(),
this.AJc(this.mX),0<ta.a.count(this.mX)&&Z.ULS.sendTraceTag(594879178,814,15,ta.a.toJSON(this.mX)),this.Wje=!0}catch(l){Z.ULS.sendTraceTag(594879177,814,10,l.toString())}});this.FZc={};this.fle={}}ZNi(a){this.WAc(a,8,"g_hermesPresenceJS");this.WAc(a,20,"g_hermesPresence1JS");this.WAc(a,18,"g_JquerySignalRMergeJS");this.WAc(a,19,"g_JquerySignalRMergeJSEnd")}WAc(a,b,c){b=Ix[b];b in a||(c=this.J7i(c),0<c&&this.mha(a,b,c))}J7i(a){a=window[a];return void 0===a||null===a?-1:a.getTime()}dispose(){this.z6f();
this.QVi();this.OBh();this.mX=this.fle=this.FZc=null}iOi(){this.Spa(25)}hOi(){this.Spa(12)}zZj(){this.Spa(15);0<this.appInitChromeReady&&this.Spa(16)}cOi(a){try{this.a3c||(this.a3c=a,this.Wh(17,this.a3c),this.Wh(13,this.Ebg(this.B2I,this.a3c)),this.HOg.jM(!0))}catch(b){Z.ULS.sendTraceTag(594879176,814,10,b.toString())}}bYj(a,b){this.Wh(6,a);this.Wh(5,b)}dOi(){this.lqe||(this.lqe=Date.now(),this.Wh(31,this.lqe),this.z6f())}eOi(){this.Spa(28)}fOi(){this.Spa(27)}gOi(){this.Spa(40)}ivk(a){const b=[];
for(let f in a){var c=a[f];c&&Array.add(b,c.Presence)}return b}jOi(a){a&&(a=this.ivk(a),this.Wh(38,a.length),this.Wh(37,0<a.length),this.Spa(39));this.xPg.Dg(!0)}tYj(a){try{this.r3c.task.isCompleted||ta.a.Va(a)||(this.Spa(34),this.r3c.jM(!0))}catch(b){Z.ULS.sendTraceTag(51242146,814,10,b.toString())}}uYj(a){if(!(ta.a.Va(a)||"presenceUpdateNotificationReceived"in this.mX)){var b=Date.now();this.Wh(33,b);this.Ble=this.Ebg(this.B2I,b);this.Wh(32,this.Ble);this.Wh(30,ta.a.count(a));this.Ho&&this.Wh(29,
this.Ho.m4f)}}DRi(){return!this.r3c.task.isCompleted&&(!this.Ho||!this.Ho.m4f)&&!this.Ble}sYj(){this.Spa(35);this.vj.YKc&&this.Wh(36,this.vj.YKc.getTime())}xOi(){this.Qqe&&!this.f1c&&(this.f1c=!0,this.Qqe.JEf(Object(C.a)(this,this.Zec,"onResourceTimingEntriesAvailable")))}Zec(a,b){try{a={};for(let c=0;c<b.entries.length;c++){const f=b.entries[c],l=Ze.a.Mma(f.url);!this.Rme&&l.endsWith("rtc2/signalr/negotiate")?(this.Rme=!0,this.nBc(a,"Negotiate",f.qB)):l.endsWith("rtc2/signalr/connect")?(this.HKg=
!0,this.nBc(a,"Connect",f.qB)):!this.Fne&&l.endsWith("rtc2/signalr/start")?(this.Fne=!0,this.nBc(a,"Start",f.qB)):l.endsWith("rtc2/findsession")&&(this.nBc(a,this.$ke.toString()+"_FindSession",f.qB),this.$ke++)}if(this.Rme||this.HKg||this.Fne||0<this.$ke)this.OBh(),this.y6f(a)}catch(c){Z.ULS.sendTraceTag(51242147,814,10,c.toString())}}nBc(a,b,c){this.mha(a,b+"FS",c.fetchStart);this.mha(a,b+"RS",c.responseStart);this.mha(a,b+"RE",c.responseEnd)}OBh(){this.f1c&&(this.f1c=!1,this.Qqe.Yeh(Object(C.a)(this,
this.Zec,"onResourceTimingEntriesAvailable")))}Spa(a){this.Wh(a,Date.now())}Wh(a,b){this.F1h(Ix[a],b)}F1h(a,b){this.mha(this.FZc,a,b);this.mha(this.mX,a,b)}mha(a,b,c){b in a||(a[b]=c)}AJc(a){this.ZNi(a);this.mha(a,"B2I",this.B2I);null!=this.fHasTabSwitch&&this.mha(a,"fHasTabSwitch",this.fHasTabSwitch);null!=this.TYc&&this.mha(a,"firstCoauthoringStatus",this.TYc);this.appInitInteractivityReady&&this.mha(a,"appInitInteractivityReady",this.appInitInteractivityReady);this.appInitChromeReady&&this.mha(a,
"appInitChromeReady",this.appInitChromeReady)}Cmh(){null==this.TYc&&(this.TYc=this.vj.aBa.result)}z6f(){this.y6f({})}y6f(a){try{this.AJc(this.FZc),ta.a.forEach(this.FZc,(b,c)=>{b in this.fle||(this.fle[b]=c,a[b]=c)},null),0<ta.a.count(a)&&Z.ULS.sendTraceTag(41239941,828,50,ta.a.toJSON(a))}catch(b){Z.ULS.sendTraceTag(51242176,814,10,b.toString())}}QVi(){Z.ULS.sendTraceTag(51242177,814,100,"FlushRecords: m_fPresenceUpdateLogged={0}, m_fPeoplesWellDisplayed={1}",this.ake,this.Wje);if(!this.ake||!this.Wje)try{this.AJc(this.mX),
0<ta.a.count(this.mX)&&Z.ULS.sendTraceTag(51242178,814,50,ta.a.toJSON(this.mX))}catch(a){Z.ULS.sendTraceTag(51242179,814,10,a.toString())}}get B2I(){!this.hge&&tg.a.instance.xo(Th.a.contentEditable)&&(this.hge=tg.a.instance.$g(Th.a.contentEditable));return this.hge}get appInitInteractivityReady(){!this.Rfe&&tg.a.instance.xo("AppInitStatus_interactivityReady")&&(this.Rfe=tg.a.instance.$g("AppInitStatus_interactivityReady"));return this.Rfe}get appInitChromeReady(){!this.Qfe&&tg.a.instance.xo("AppInitStatus_chromeReady")&&
(this.Qfe=tg.a.instance.$g("AppInitStatus_chromeReady"));return this.Qfe}get fHasTabSwitch(){null==this.hje&&tg.a.instance.xo(Th.a.Lod)&&(this.hje=tg.a.instance.$g(Th.a.Lod));return this.hje}Ebg(a,b){return this.Rac?this.Rac.Sdg(new Date(a),new Date(b)):-1}}Object(e.a)(wK,"PresencePerfLogger",null,[302,106]);class xK{constructor(a,b,c){this.qQg=this.b9b=this.XZc=this.Jla=null;this.Eie=!1;this.ere=null;this.hi=a;this.n4=b;this.xq=c}GPc(){this.Rrb();return this.Jla}C4i(){this.Rrb();return this.XZc}getFindSessionResponse(){return this.hi?
this.hi.FindSessionResponse:null}zag(){this.Rrb();return this.b9b}tdj(){this.Rrb();return this.qQg}rdj(){this.Rrb();return this.ere}Yid(){this.Rrb();return this.Eie}xZj(){if(this.hi){const a=!!this.hi.PresenceException,b=!isNaN(this.hi.PresenceDownloadEditorTableHttpStatus)&&200!==this.hi.PresenceDownloadEditorTableHttpStatus||!isNaN(this.hi.PresenceFindSessionHttpStatus)&&200!==this.hi.PresenceFindSessionHttpStatus,c={};c.EarlyFindSessionEnabled=this.n4.presenceEarlyFindSessionEnabled;c.EditorCount=
this.XZc?this.XZc.length:0;c.ShouldConnectToRtcByDefault=this.Eie;c.EditorTableHttpStatus=this.hi.PresenceDownloadEditorTableHttpStatus;c.FindSessionHttpStatus=this.hi.PresenceFindSessionHttpStatus;c.CachedException=this.hi.PresenceException;c.IsFindSessionResponseEmpty=!this.hi.FindSessionResponse;c.IsEditorTableResponseEmpty=!this.hi.CoauthHandlerResponse;c.RtcBootTokenContainsValue=!!this.ere;Aa.a.J(41501202,804,a||b?15:50,ta.a.toJSON(c))}}Rrb(){if(this.hi&&!this.Jla)try{if(this.hi.CoauthHandlerResponse){const a=
Sys.Serialization.JavaScriptSerializer.deserialize(this.hi.CoauthHandlerResponse);this.XZc=a.EditorTable;this.Jla=a.UserName;this.b9b=a.Email;this.qQg=a.RtcEndpointUrl;this.Eie=a.FConnectByDefault;this.ere=a.RtcBootToken;this.xq.v1g()}}catch(a){Aa.a.J(41501204,804,10,"PresencePrepCacheParser - caught exception when parse cache: "+a)}}}Object(e.a)(xK,"PresencePrepCacheParser",null,[311]);class sD{constructor(a,b,c,f=5E3){if(!a)throw Error.create("RTCParams : ClientId is null");this.clientId=a;this.userSessionId=
u.AFrameworkApplication.userSessionId;this.egd=u.AFrameworkApplication.egd;this.oba=u.AFrameworkApplication.Ge;this.zw=b;this.cmh=c;this.Zih=f}}Object(e.a)(sD,"RtcParams",null,[]);class yK{constructor(a,b,c){this.c0j=a;this.bre=b;this.PXc=c}gpi(a,b,c){ya.a.ku(a);ya.a.ku(b);ya.a.ku(c)}nJd(a,b,c,f){return f=!a&&0>b?f+Math.abs(b):this.c0j?(c-b)/4:(c-b)/2}oJd(a,b,c){if(!this.PXc||!b)return c;if(0<=b.className.indexOf(hc.a.aN))if(b.previousSibling)b=b.previousSibling;else return c;const f=this.gPc(b,X.a.lXc),
l=this.gPc(b,X.a.pLc);if(isNaN(f)||!f||isNaN(l)||!l||f>=l)return c;const x=new Sys.UI.Bounds(c.x,c.y,c.width,c.height);if(f>=.9*l)return c=(l-f)/2,x.y+=c,x.height-=2*c,x;a=this.mfj(b,a);if(isNaN(a)||!a)return c;c=(a-f)/2;x.y+=c;x.height-=2*c;return x}Tfj(a,b){if(!this.PXc)return 0;a=this.gPc(a,X.a.lXc);b=Math.ceil((a-b)/2);if(isNaN(b)||0>b)b=0;return b}mfj(a,b){let c=Object(ua.a)(1021,b);b||(c=Object(ua.a)(1021,this.bre.s1b(a)));if(c&&this.bre.aGj(c))return this.gPc(a,X.a.pLc);b=0;const f=a.getClientRects();
f&&0<f.length&&(b=f[0],b=new Sys.UI.Bounds(Math.floor(b.left),Math.floor(b.top),Math.floor(b.width),Math.floor(b.height)),b=this.bre.zfa(b,c,()=>a.offsetWidth/a.offsetHeight).height);return b}gPc(a,b){let c=a;for(a=null;!a&&c&&"P"!==c.tagName;)a=K.a.te(c,b),c=0<=c.className.indexOf(hc.a.Z6b)?c.previousSibling:c.parentNode;b=0;a&&(b=parseInt(a.toString(),10));return b}}Object(e.a)(yK,"PptMeasureBoundsUsingSpansStrategy",null,[306]);class tD{constructor(){this.MGa=null}get ndc(){return this.MGa?this.MGa.ndc:
0}get Vlc(){return this.MGa?this.MGa.Vlc:!1}get bjd(){return this.MGa?this.MGa.bjd:!1}hXb(a,b){b&&(this.MGa?this.MGa.hXb(a,b):b(null))}jei(a){this.MGa=a}}Object(e.a)(tD,"PPTProcessImageStrategyProxy",null,[1016,1017]);class uD{constructor(a,b){this.$Th=a;this.Lif=b}get $tk(){return this.$Th}get zze(){return this.Lif}X5k(a){this.Lif=a}}Object(e.a)(uD,"PageHiddenRecord",null,[]);class zK{constructor(){this.dla=[];Aa.a.J(24440908,801,50,"Init PageHiddenMeter");if(this.ane=window.document.hidden){const a=
new uD(new Date,new Date(9999,12,31));this.dla.push(a)}fb.a.instance.qb("Common.ITaskManager").Cb(new xe.a(4,2,9E5,Object(C.a)(this,this.maintainPageHiddenRecords,"maintainPageHiddenRecords"),90,"2"));$addHandler(window,"visibilitychange",Object(C.a)(this,this.onVisibilityChange,"onVisibilityChange"))}Sdg(a,b){const c=this.dla.length;let f=0;if(0<c&&a<this.dla[c-1].zze){a=a.getTime();b=b.getTime();for(let l=0;l<c;++l){const x=Math.max(this.dla[l].$tk.getTime(),a),G=Math.min(this.dla[l].zze.getTime(),
b);x<G&&(f+=G-x)}}return f}onVisibilityChange(){Aa.a.J(24440910,801,50,"Page hidden: {0}",window.document.hidden);this.hLk()}hLk(){var a=window.document.hidden,b=new Date;this.ane!==a&&((this.ane=a)?(b=new uD(b,new Date(9999,12,31)),this.dla.push(b)):(a=this.dla.length,0<a&&this.dla[a-1].X5k(b)))}maintainPageHiddenRecords(){const a=new Date;for(;0<this.dla.length&&9E5<+a-+this.dla[0].zze;)Array.removeAt(this.dla,0)}}Object(e.a)(zK,"PageHiddenMeter",null,[296]);class vD{c5(a){let b=ba.a.Jz(a);return b||
(b=E.a.Jz(a))?b:(b=F.a.Jz(a))?b:""}}Object(e.a)(vD,"ActionNameResolver",null,[1014]);class wD{constructor(){this.va=new ic.a}AGk(){this.va.raiseEvent("CIU",Sys.EventArgs.Empty)}BGk(a){this.va.raiseEvent("CSC",a)}QGk(a){this.va.raiseEvent("ETC",a)}Obh(a){this.va.raiseEvent("TLSC",a)}QIk(a){this.va.raiseEvent("TCVEL",a)}QHk(){this.va.raiseEvent("PRTCC",null)}uHk(){this.va.raiseEvent("LCK",null)}rId(a){this.va.addHandler("CSC",a)}cGe(a){this.va.removeHandler("CSC",a)}tId(a){this.va.addHandler("ETC",
a)}Xeh(a){this.va.removeHandler("ETC",a)}u8h(a){this.va.addHandler("TLSC",a)}hTk(a){this.va.removeHandler("TLSC",a)}n8h(a){this.va.addHandler("TCVEL",a)}o7h(a){this.va.addHandler("PRTCC",a)}Cfh(a){this.va.removeHandler("PRTCC",a)}G5h(a){this.va.addHandler("LCK",a)}}Object(e.a)(wD,"CoauthEventSource",null,[1011,1012,1013]);class xD{constructor(){this.va=new ic.a}GIk(){var a=new Sys.EventArgs;this.va.raiseEvent("OnShowHideAltTextPane",a)}gHk(a){this.va.raiseEvent("OnImageDescriptionReady",a)}VGk(a){this.va.raiseEvent("FRHRE",
a)}uGk(a){this.va.raiseEvent("APIRE",a)}nHk(a){this.va.raiseEvent("IMARE",a)}Y6h(a){this.va.addHandler("OnShowHideAltTextPane",a)}nSk(a){this.va.removeHandler("OnShowHideAltTextPane",a)}w6h(a){this.va.addHandler("OnImageDescriptionReady",a)}URk(a){this.va.removeHandler("OnImageDescriptionReady",a)}p6h(a){this.va.addHandler("FRHRE",a)}PRk(a){this.va.removeHandler("FRHRE",a)}R5h(a){this.va.addHandler("APIRE",a)}zRk(a){this.va.removeHandler("APIRE",a)}z6h(a){this.va.addHandler("IMARE",a)}WRk(a){this.va.removeHandler("IMARE",
a)}}Object(e.a)(xD,"CoreExtEventSource",null,[1008,1009,1010]);var AK=d(999);class yD extends AK.a{constructor(a,b,c,f,l,x,G){super(f,c,a,x,G);this.EYc=new ef.a(0);this.QTa=b;this.voe=l}zyj(a,b){let c;(c=this.EYc).$(b,c.ga(b)+1);this.l1f(a.name,Object(C.a)(this,this.rog,"initPackageCallback"),a)}Ayj(a,b){let c;(c=this.EYc).$(b,c.ga(b)+1);this.m1f(a.name,Object(C.a)(this,this.rog,"initPackageCallback"),1,a)}rog(a){a.yyj()}Qrh(a,b){return!!a&&!!b&&a.context.BLf!==b.context.BLf}vxe(a,b){if(b>=this.voe){const c=
new Sys.StringBuilder;for(let f=0;f<a.length;++f)0<f&&c.append(","),c.append(String.format('{{"N":"{0}","D":{1}}}',a[f].name,De.a.VX(a[f].duration,0)));Z.ULS.sendTraceTag(39966927,813,50,"{0}:{1}",c.toString(),De.a.VX(b,0))}}onIdle(a){const b=[];this.EYc.forEach((c,f)=>{0<f&&(b.push(c),this.EYc.$(c,0),this.QTa.HXc(c));return!0});Z.ULS.sendTraceTag(39966928,813,50,"[{0}]:{1}",b.join(","),De.a.VX(a,0))}}Object(e.a)(yD,"DelayLoadedPackageInitializer",AK.a,[]);class Jx{constructor(a,b,c,f,l,x,G,R,fa){this.Ere=
this.Dre=null;this.Ha=a;this.LI=b;this.xq=c;this.vj=f;this.ia=l;this.JI=x;this.Ob=G;this.fe=fa;this.E$j=R;this.LI.tId(Object(C.a)(this,this.n0f,"editorTableUpdate"))}dispose(){this.LI.Xeh(Object(C.a)(this,this.n0f,"editorTableUpdate"))}n0f(){const a=this.vj.zZ;this.P1f();this.xq.gVc&&(Aa.a.J(512496593,814,50,"App::EditorTableUpdate; Refresh Peoples well; MyClientId: {0}; new editor table count: {1}",this.vj.yC,a.length),this.ia.processAction(F.a.C4a,2))}P1f(){if(!this.xq.gVc&&this.vj.yC){Aa.a.J(23437903,
814,50,"App::EnsurePresence; Presence not loaded yet. Ensure presence on editor table update");try{if(!this.Ob)throw Error.create("Presence is being loaded before the app frame");this.Aql()}catch(a){Aa.a.J(512496591,814,10,"App : EnsurePresence; Exception loading presence: {0}",a)}}}Aql(){Aa.a.J(512496590,814,50,"App::EnsurePresence: trigger download js");if(this.Ha.Noc)fb.a.instance.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Rba("pptedit.presence",null,()=>d.e(11).then(d.bind(null,
1211)));else{const a=Dx.a.create("pptedit.presence",this.RBi(),()=>d.e(11).then(d.bind(null,1211)));ql.a.Kx(a)}}RBi(){this.mth.ZR((a,b)=>{this.E$j.gce=b.succeeded});return[this.mth]}get Rfl(){this.Ere||(this.Ere=this.Vcg());return this.Ere}get mth(){this.Dre||(this.Dre=this.PCi());return this.Dre}PCi(){return this.x9i()}x9i(){return VC.a.create(this.Vcg(),null,null,Cb.App.lzg)}Vcg(){return this.Ha.podsUseVersionLessJqueryAndSignalR?this.fe.Djj("jquery.signalr.merge.1.1"+Jx.IMd):u.AFrameworkApplication.Jj("jquery.signalr.merge.1.1",
2)}}Jx.IMd=".min.js";Object(e.a)(Jx,"PresenceLoader",null,[]);class BK{constructor(a,b,c,f,l,x,G,R,fa){this.vFa=this.wFa=!1;this.wka=this.nka=null;this.Ha=a;this.Sx=b;this.SW=c;this.Ea=f;this.uab=l;this.lle=x;this.yb=G;this.iC=R;this.Qy=fa;this.Y8=this.Ha.podsHtmlTextForEmbeddedFontsIsEnabled&&!!window.self.Promise&&this.uab.Dzg}ned(a){if(this.Y8&&a&&!a.ll&&a.ywb)if(a.Pce)a.Pce=!1;else if(this.Ea.LTc(a.shapeNode)){var b=this.Ea.CPc(a.shapeNode);b.length&&(this.Qy&&this.Qy.isEnabled||this.Qy&&this.Qy.isEnabled?
(this.nka=this.wka=null,this.vFa=this.wFa=!1,this.Qy&&this.Qy.isEnabled&&this.Qy.oS&&(this.Qy.E8a(c=>{Aa.a.J(51217114,801,50,"CustomFontListDownloadAndParseCompleted");this.wka=c;this.DIc(a,b)}),this.Qy.oS.F8a(()=>{Aa.a.J(51217116,801,15,"CustomFontWebRequestFailed");this.wFa=!0;this.DIc(a,b)})),this.iC&&this.iC.isEnabled&&this.iC.oS&&(this.iC.E8a(c=>{Aa.a.J(41521282,801,50,"CloudFontListDownloadAndParseCompleted");this.nka=c;this.DIc(a,b)}),this.iC.oS.F8a(()=>{Aa.a.J(41494535,801,15,"CloudFontWebRequestFailed");
this.vFa=!0;this.DIc(a,b)}))):this.YAh(a,b,null,null))}}LDa(a){return a?!0:!1}DIc(a,b){(this.LDa(this.nka)&&this.LDa(this.wka)||this.LDa(this.nka)&&this.wFa||this.vFa&&this.LDa(this.wka)||this.vFa&&this.wFa)&&this.YAh(a,b,this.nka,this.wka)}YAh(a,b,c,f){a&&!a.ll&&b&&b.length&&(Aa.a.J(41521286,801,50,"TryRemoveFidelityViewOnEmbeddedFontsLoaded"),Promise.all(this.lle.kGh(b,c,Object(C.a)(this.iC,this.iC.createFontUrl,"createFontUrl"),f,Object(C.a)(this.Qy,this.Qy.createFontUrl,"createFontUrl"),this.SW.vFh,
Object(C.a)(this.SW,this.SW.createFontUrl,"createFontUrl"))).then(()=>{Aa.a.J(41521288,801,50,"WebFontsLoadCompleted");this.Sx.FDa(()=>{this.yb.Cb(new xe.a(2,1,0,()=>{a&&!a.ll&&(Aa.a.J(41494539,801,50,"TriggerDrawByRemoveFidelityViewOnEmbeddedFontsLoaded"),a.VBa(),a.Pce=!0,a.oA())},90,"109"))})},l=>{Aa.a.J(41494541,801,10,"WebFontsLoad failed: {0}",l.toString());a&&!a.ll&&a.shapeNode&&(a.shapeNode.MRa=!0)}))}}Object(e.a)(BK,"RemoveShapeFidelityViewForEmbeddedFontController",null,[310]);class CK{constructor(a,
b,c,f,l,x,G,R,fa){this.vFa=this.wFa=!1;this.wka=this.nka=null;this.ela=new Ha.a;this.zta=a;this.Tm=b;this.SW=c;this.Ea=f;this.uab=l;this.lle=x;this.yb=G;this.iC=R;this.Qy=fa}NPk(a){window.self.Promise&&this.uab.Dzg?this.yb.Cb(new xe.a(2,1,0,()=>{try{this.removeFidelityViewOnWebFontsLoaded(a)}catch(b){Aa.a.J(40429063,801,10,"RemoveFidelityViewOnWebFontsLoaded exception {0}",b),this.bKb(a)}},90,"102")):this.bKb(a)}bKb(a){if(a&&a.length){for(var b of a)b.ll||(b.ywb=!0,b.oA()),this.Tm.Pnh();b=0;tg.a.instance.xo(Th.a.zP)&&
(b=(new Date).getTime()-tg.a.instance.$g(Th.a.zP));Aa.a.J(560837531,801,50,"RemoveFidelityView - MissingFonts: {0}, Total Duration Since Viewable : {1}",this.ela.count,b);if(0<this.ela.count){const c=new Map;c.set("PendingFontsCount",this.ela.count.toString());c.set("FidelityViewDuration",b.toString());vf.Health.instance.recordQosError("RemoveFidelityViewWithMissingFonts",["MissingFont"],!1,!1,!0,!1,Object.assign(new mk.a,{extendedProperties:c}))}a.length=0;Aa.a.J(40429065,801,50,"shapeViewElementsDuringBoot draw done")}}removeFidelityViewOnWebFontsLoaded(a){Aa.a.J(40429067,
801,50,"RemoveFidelityViewOnWebFontsLoadedAndBootComplete");for(var b of a)!b.ll&&b.LA&&b.VBa();b=new Date;for(const c of a)if(!c.ll){const f=this.Ea.E7a(c.shapeNode);for(const l of f)this.ela.contains(l)||this.ela.add(l)}Aa.a.J(40429069,801,50,"GetUnsupportedFontsDuration: {0}",+new Date-+b);if(this.ela.count){if(!this.Qy||!this.Qy.isEnabled)if(!re.a("EnableRemoveFidelityCloudServiceCheck")||!this.iC||!this.iC.isEnabled){this.jeh(a,this.ela,null,null);return}this.nka=this.wka=null;this.vFa=this.wFa=
!1;this.Qy&&this.Qy.isEnabled&&(this.Qy.E8a(c=>{Aa.a.J(51217157,801,50,"CustomFontListDownloadAndParseCompleted");this.wka=c;this.EIc(a,this.ela)}),this.Qy.oS&&this.Qy.oS.F8a(()=>{Aa.a.J(51217159,801,50,"CustomFontWebRequestFailed");this.wFa=!0;this.EIc(a,this.ela)}));this.iC&&this.iC.isEnabled&&(this.iC.E8a(c=>{Aa.a.J(40429075,801,50,"CloudFontListDownloadAndParseCompleted");this.nka=c;this.EIc(a,this.ela)}),this.iC.oS&&this.iC.oS.F8a(()=>{Aa.a.J(40429083,801,50,"CloudFontWebRequestFailed");this.vFa=
!0;this.EIc(a,this.ela)}))}else Aa.a.J(40429071,801,50,"No unsupported fonts"),this.bKb(a)}LDa(a){return a?!0:!1}EIc(a,b){(this.LDa(this.nka)&&this.LDa(this.wka)||this.LDa(this.nka)&&(this.wFa||re.a("FidelityCustomServiceDisableCheck")&&!this.Qy.isEnabled)||this.vFa&&this.LDa(this.wka)||this.vFa&&this.wFa)&&this.jeh(a,b,this.nka,this.wka)}jeh(a,b,c,f){b&&b.count?(Aa.a.J(41521300,801,50,"RemoveFidelityViewOnWebFontsLoadedInternal"),Promise.all(this.lle.kGh(b.toArray(),c,Object(C.a)(this.iC,this.iC.createFontUrl,
"createFontUrl"),f,Object(C.a)(this.Qy,this.Qy.createFontUrl,"createFontUrl"),this.SW.vFh,Object(C.a)(this.SW,this.SW.createFontUrl,"createFontUrl"))).then(l=>{Aa.a.J(40429079,801,50,"WebFontsLoadCompleted");if(l)for(let x=0;x<l.length;x++)if(l[x])for(let G=0;G<l[x].length;G++)if(l[x][G]){Aa.a.J(40429081,801,50,"Status {0}",l[x][G].status);const R=l[x][G].family;Ka.a.Va(R)||l[x][G].status!==sl.loaded||-1===R.lastIndexOf("_")||b.remove(R.substring(0,R.lastIndexOf("_")))}this.bKb(a)},l=>{Aa.a.J(41521304,
801,10,"WebFontsLoad failed: {0}",l.toString());this.yb.Cb(new xe.a(2,1,this.zta.pptWaitForWebFontsLoadingTimeoutMs,()=>{Aa.a.J(40429073,801,50,"Check removing Fidelity View");this.bKb(a)},90,"103"))})):this.bKb(a)}}Object(e.a)(CK,"RemoveShapeFidelityViewOnBootController",null,[309]);class DK{constructor(a){this.ia=a}zfl(){this.bth(ResourceStrings.l_SessionTimeoutErrorMessage)}Afl(){this.bth(ResourceStrings.l_SessionTimeoutErrorMessageForCommentDraft)}bth(a){const b=new Di.StandardDialog;b.yd=4;b.ng=
"PPTTimeoutDialog";b.Ue(1,ResourceStrings.L_Refresh);b.Ue(2,ResourceStrings.L_Close);b.DO(ResourceStrings.l_GenericDialogTitle,a,Object(C.a)(this,this.h2k,"sessionTimeoutDialogHandler"))}h2k(a,b){1===a?(Aa.a.J(24261827,801,50,"Button={0};DontShowAgain={1}",a,b),this.gbl()?(Aa.a.J(24655755,801,50,"Session Token is expired or about to expire, refresh the page."),this.ia.processAction(ba.a.refreshPage,2)):this.ia.La(ba.a.refresh,2,{refreshtrigger:"SessionTimeoutIndicator::SessionTimeoutDialogHandler"})):
(Aa.a.J(24261829,801,50,"Button={0};DontShowAgain={1}",a,b),this.ia.processAction(ba.a.wsb,2))}gbl(){const a=u.AFrameworkApplication.Wl,b=u.AFrameworkApplication.iha;return 0<a&&(new Date).getTime()>=a-1E3*b}}Object(e.a)(DK,"SessionTimeoutIndicator",null,[303]);class EK{constructor(){this.l1c=!1;this.DOg=[]}get gce(){return this.l1c}set gce(a){if(!this.l1c&&(this.l1c=a)){for(const b of this.DOg)b();Array.clear(this.DOg)}}}Object(e.a)(EK,"SignalRLoadCompletedListener",null,[304]);class Fz{constructor(a,
b,c,f,l,x,G){this.yRg=this.SLg=!1;this.Tda=this.Qre=null;this.KNg=this.Dne=!1;this.zRg=this.ARg=this.lOg=this.mOg=0;this.ia=a;this.X1j=b;this.Ep=f;this.cse=x;this.Lc=l;this.Ys=G;this.Lc.NEf(Object(C.a)(this,this.Jnk,"onLazySorterViewActorActionRegistrationHandler"))}ub(){this.Ys||(this.ia.ya(ba.a.sxa,Bb.a.application,Object(C.a)(this,this.pfl,"showStatusBarSorterView")),this.ia.ya(ba.a.nqb,Bb.a.application,Object(C.a)(this,this.Dqi,"closeStatusBarSorterView")))}pfl(a,b,c,f,l){if(2!==c)return 32;if(this.Dne)return this.cse.instance.sxa(a,
b,c,f,l);this.Lc.NEf(Object(C.a)(this,this.luh,"sorterViewEventHandler"));this.yWj();this.SLg||(this.qee(),this.KNg=!0);return 32}Dqi(a,b,c,f,l){if(2!==c)return 32;this.Lc.sRk(Object(C.a)(this,this.luh,"sorterViewEventHandler"));(this.Tda=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.Tda);return this.Dne?this.cse.instance.nqb(a,b,c,f,l):32}qee(){this.yRg||(this.yRg=!0,this.Qre=this.xWj(),this.Qre.ZR(Object(C.a)(this,this.Uqk,
"onSlideSorterGridLoaded")),ql.a.Kx(this.Qre),this.mOg=Date.now())}Uqk(){this.SLg=!0;this.Ep&&this.Ep.V4("SlideSoterGridDownloadFinished");this.lOg=Date.now();const a=tg.a.instance;a&&(a.hc("SlideSorterOnDemandLoad",this.KNg),a.hc("SlideSorterPkgST",this.mOg),a.hc("SlideSorterPkgET",this.lOg))}yWj(){this.ia.processAction(ba.a.zWb,2);this.Tda=$e.a.Ce();this.Tda.id="SlideSorterViewLoadingElementId";this.Tda.className="sorterview-ui-loading-element-class";const a=$e.a.Ce();a.className="sorterview-ui-loading-textmessage-class";
a.innerText=ResourceStrings.l_SorterViewLoadingTextMessage;const b=$e.a.Ce();b.className="sorterview-ui-loading-spinner-class";const c=$e.a.Ce();c.className="sorterview-ui-loading-spinner-inner-class";b.appendChild(c);this.Tda.appendChild(b);this.Tda.appendChild(a);document.getElementById("WACDocumentPanel").appendChild(this.Tda);this.ARg=Date.now()}luh(){(this.Tda=document.getElementById("SlideSorterViewLoadingElementId"))&&document.getElementById("WACDocumentPanel").removeChild(this.Tda);this.zRg=
Date.now();this.cse.instance.sxa(ba.a.sxa,null,2,null,null);const a=tg.a.instance;a&&(a.hc("SlideSorterLoadingExpST",this.ARg),a.hc("SlideSorterLoadingExpET",this.zRg))}Jnk(){this.Dne=!0}xWj(){var a=u.AFrameworkApplication.Jj("slidegrid"+Fz.IMd,5);a=this.X1j.LXb(a);return Dx.a.create("pptedit.sorterGrid",this.Ys?null:[a],()=>d.e(17).then(d.bind(null,1217)))}dispose(){}}Fz.IMd=".min.js";Object(e.a)(Fz,"SorterViewActorMain",null,[106,312]);class Hv{constructor(a){this.jhf=a}onBlur(a,b){this.Nee("OnBlur",
a,b);(a=pa.InteractiveViewManager.instance.Nd)&&v.FocusManager.mM()&&a.endEditing(!1,20)}setFocus(a,b){this.Nee("SetFocus",a,b);const c=this.jhf();c&&!c.isActive&&(a.name!==I.AppFrame.fuj&&a.name!==I.AppFrame.qWi||b.name!==y.AFrame.PV||(c.fjd=!1),c.POi())}onFocus(a,b){this.Nee("OnFocus",a,b);if(v.FocusManager.mM()&&(b=this.jhf())&&b.isActive){var c=!!b.editingView;a=a?a.name:"";r.a.Ki&&(a.startsWith(Vg.a.JYb)&&(qf.GrippersManager.instance.j3b=!0),a.startsWith(Vg.a.JYb)||a===y.AFrame.rdb||a===y.AFrame.Bwh)&&
(c=!1);c&&this.OOi(b,a)}}OOi(a,b){const c=a.editingView,f=v.FocusManager.instance();f.C7d=!0;a.hR();1===c.mode&&3!==u.AFrameworkApplication.Ta.mode&&b===y.AFrame.rdb&&(a.Gb.Gna.GYd(),c.ngb());f.C7d=!1}Nee(a,b,c){a=String.format("InteractiveViewFocusScopeActions.{0} called. (Scope is moving from '{1}' to '{2}')",a,b?b.name:null,c?c.name:null);El.a.instance.$v&&Z.ULS.sendTraceTag(38293642,321,15,String.format("{0} {1}","Handling focus/blur events while TaskManager.Instance.IsYielding!",a))}static bSf(a){const b=
new Hv(()=>a),c=a.eI,f=v.FocusManager.instance();f.Dc(c).rAa(Object(C.a)(b,b.onBlur,"onBlur"));f.Dc(c).bba(Object(C.a)(b,b.setFocus,"setFocus"));f.Dc(c).$aa(Object(C.a)(b,b.onFocus,"onFocus"))}}Object(e.a)(Hv,"InteractiveViewFocusScopeActions",null,[]);class zD extends Hv{constructor(a){super(()=>a);this.Mb=a}fuk(){this.Mb.isActive||this.Mb.tOi()}static Jui(a,b){const c=new zD(a);a=a.eI;b.Dc(a).rAa(Object(C.a)(c,c.onBlur,"onBlur"));b.Dc(a).bba(Object(C.a)(c,c.fuk,"pageViewSetFocus"));b.Dc(a).$aa(Object(C.a)(c,
c.onFocus,"onFocus"))}}Object(e.a)(zD,"PageViewInteractiveViewFocusScopeActions",Hv,[]);class Gz{constructor(){this.Ha=this.K=null;this.FLg=!1}get name(){return"PowerPointWebEditor.CoreExt"}Wb(a){this.K=a;this.Ha=a.resolve("PowerPointWebEditor.IApplicationSettings");this.Ha.jtg&&a.register(296,"PowerPointWebEditor.IPageHiddenMeter").ma().na(()=>new zK);Gz.eui(this.K);a.register(wD,"PowerPointWebEditor.CoreExt.CoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventSource").as("PowerPointWebEditor.CoreExt.ICoauthEventNotifier").as("PowerPointWebEditor.CoreExt.ICoauthEventHandler").ma().na(()=>
new wD);a.register(xD,"PowerPointWebEditor.CoreExt.CoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventSource").as("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier").as("PowerPointWebEditor.CoreExt.ICoreExtEventHandler").ma().na(()=>new xD);a.register(297,"Common.IColorTable").ma().na(()=>new tK);a.register(Ez,"PowerPointWebEditor.CoauthStateCache").as("PowerPointWebEditor.ICoauthStateGetter").as("PowerPointWebEditor.ICoauthStateSetter").ma().na(()=>new Ez(a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),
a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),new Sa.a(()=>fb.a.instance.Ka("Common.IRenameProps"))));a.register(298,"PowerPointWebEditor.IDocNotifyClient").ma().na(()=>new pD(this.Ha,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.Ha.tg?a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"):null,(b,c,f,l,x,G)=>{a.resolve("PowerPointWebEditor.IPPTWebService").i4d(c,f,l,x,G)},!1));a.register(299,"PowerPointWebEditor.IPodsDocNotifyClient").ma().na(()=>new pD(this.Ha,a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.IErrorDialog"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.PodsPopsCore.ISessionHealthManager"),(b,c,f,l,x,G,R,fa,wa)=>{a.resolve("PowerPointWebEditor.IPopWebService").COc(b,c,f,l,x,G,R,fa,wa)},!0));a.register(300,"PowerPointWebEditor.IContentTimeStampManager").ma().na(()=>new rK);a.register(Gv,"PowerPointWebEditor.CoauthSubscriptionManager").as("PowerPointWebEditor.ICoauthSubscriptionManager").ma().na(()=>new Gv(a.resolve("PowerPointWebEditor.IDocNotifyClient"),
this.Ha.tg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.IPopSessionState"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),
a.resolve("PowerPointWebEditor.NotificationManager"),this.Ha.aFe,this.Ha.podsPushThumbnailImageIds));a.register(oD,"PowerPointWebEditor.CoauthNotificationManager").ma().na(()=>new oD(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IDocNotifyClient"),this.Ha.tg?a.resolve("PowerPointWebEditor.IPodsDocNotifyClient"):null,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.IContentTimeStampManager"),
a.resolve("PowerPointWebEditor.ICoauthSubscriptionManager"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.Ka("PowerPointWebEditor.IPrefetchManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventNotifier"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventNotifier"),
a.resolve("PowerPointWebEditor.PodsPopsCore.IPopSessionManager"),a.resolve("PowerPointWebEditor.Core.IPodsPopsEventNotifier"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.Ha,a.resolve("Common.DragInputManager"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.Application.IReadOnlyManager"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),a.resolve("PowerPointWebEditor.IBusinessBarController")));a.register(Jx,"PowerPointWebEditor.PresenceLoader").ma().na(()=>new Jx(this.Ha,
a.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),a.resolve("PowerPointWebEditor.ICoauthStateSetter"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IPPTApp"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener"),a.resolve("PowerPoint.IPathManager")));a.register(uK,"PowerpointPresence.PresenceEmailConverter").as("PowerpointPresence.IPresenceEmailConverter").ma();
a.register(301,"PowerpointPresence.IPresenceColorProvider").ma().na(()=>new nQ.a(a.resolve("Common.App.People.IPeopleColorUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").ryg,a.resolve("PowerPointWebEditor.IApplicationSettings").podsDefaultToRtcForPresenceEnabled));a.register(302,"PowerpointPresence.IPresencePerfLogger").ma().na(()=>new wK(a.qb("PowerPointWebEditor.IPageHiddenMeter"),a.resolve("PowerPointWebEditor.IApplicationSettings").podsLogRealTimeChannelResourceTiming?a.resolve("Common.NetworkTiming.IResourceTimingLogger"):
null,a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.Ka("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager")));a.register(sD,"PowerpointPresence.RtcParams").ma().na(()=>new sD(a.resolve("PowerPointWebEditor.ICoauthStateGetter").yC,a.resolve("PowerPointWebEditor.IApplicationContext").rgg(),a.Ka("Common.ISessionExpirationManager"),a.resolve("Common.IAppSettingsManager").Cc("RTCReconnectionSlowDurationMilliseconds",5E3)));a.register(303,"PowerPointWebEditor.ISessionTimeoutIndicator").ma().na(()=>
new DK(a.resolve("Common.IActionManager")));a.register(304,"PowerPointWebEditor.ISignalRLoadCompletedListener").ma().na(()=>new EK);a.register(mD,"PowerPointWebEditor.SessionLifetimeManager").as("PowerPointWebEditor.ISessionLifetimeManager").ma().na(()=>new mD(this.Ha,a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IApplicationContext"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.Ka("PowerPointWebEditor.IGetDocumentCopyHelper"),a.resolve("PowerPointWebEditor.Core.ICoreEventNotifier"),
a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("Box4.IReplicationScheduler"),a.resolve("PowerPointWebEditor.ISessionTimeoutIndicator"),a.Ka("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),a.Ka("PowerPointWebEditor.ICommentSessionManager")));a.register(lD,"PowerPointWebEditor.SessionCleanupHandler").ma().na(()=>new lD(a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
a.resolve("PowerPointWebEditor.BootStorage.ICoreOutboundHelper"),a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(305,"Common.IProcessInputStrategy").ma().na(()=>new Ks(a.resolve("Common.IActionManager"),this.Ha,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Common.IF6Manager")));this.Ha.Rea||a.register(vK.a,"PowerpointPresence.PresenceEventSource").as("PowerpointPresence.IPresenceEventSource").as("PowerpointPresence.IPresenceEventNotifier").as("PowerpointPresence.IPresenceEventHandlers").ma().na(()=>
new vK.a);a.register(306,"Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy").ma().na(()=>new yK(this.Ha.pptEditorDifferentLineHeightEnabled,a.resolve("Box4.IRotatingCoordinateConverter"),this.Ha.gyg));a.register(307,"Box4.TextMetricsApi.ITextMetricsHelper").ma().na(()=>new P);a.register(308,"PowerPointWebEditor.IThumbnailNavPaneDragAdapter").ma().na(()=>new sK(a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.DragInputManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),u.AFrameworkApplication.isRtl,this.Ha.pyg,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.Ha.Ly,this.Ha.Abe));a.register(309,"PowerPointWebEditor.IRemoveShapeFidelityViewOnBootController").ma().na(()=>
new CK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IImageViewManager"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(310,"PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController").ma().na(()=>
new BK(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.Fonts.IEmbeddedFontsManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Fonts.IFontFaceSetObserver"),a.resolve("PowerPointWebEditor.Fonts.IFontsObserver"),a.resolve("Common.ITaskManager"),a.resolve("Box4.CloudFontService"),a.resolve("Box4.CustomFontService")));a.register(vD,"PowerPointWebEditor.ActionNameResolver").as("PowerPointWebEditor.IActionNameResolver").ma().na(()=>
new vD);a.register(tD,"PowerPointWebEditor.PPTProcessImageStrategyProxy").as("PowerPointWebEditor.IPPTProcessImageStrategy").as("Box4.IProcessImageStrategy").ma().na(()=>new tD);a.register(yD,"PowerPointWebEditor.DelayLoadedPackageInitializer").ma().na(()=>{let b=2;const c=fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptDelayLoadedPackageInitializerTaskPriority;0<=c&&6>c?b=c:Aa.a.J(512360583,809,50,"Invalid delay loaded initializer task priority:{0}",c);return new yD(fb.a.instance.resolve("Common.ITaskManager"),
fb.a.instance.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),fb.a.instance.resolve("PowerPointWebEditor.Core.IPerformanceHelper"),fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").delayLoadedPackageInitTimeSliceInMs,fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorCPUMeterProfilingLogThresholdInMS,b,94)});a.register(311,"PowerpointPresence.IPresencePrepCacheParser").ma().na(()=>new xK(window.self,a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.ICoauthStateSetter")));a.register(312,"PowerPointWebEditor.ISorterViewActorMain").na(()=>new Fz(u.AFrameworkApplication.Ta,a.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"),a.resolve("PowerPointWebEditor.IPPTApp").bBg,a.resolve("PowerPointWebEditor.ISessionState"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ka("PowerPointWebEditor.ISorterViewActorLazy"),a.resolve("PowerPointWebEditor.IApplicationSettings").Rea)).ma();a.resolve("PowerPointWebEditor.ISorterViewActorMain")}init(){var a=
window.g_hermesExtJS;void 0!==a&&null!==a&&tg.a.instance.hc("FirstExtJsExecTime",a);a=new sB.a("CoreExtPackage::Init");try{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").vja&&this.oZg();this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").FDa(()=>{this.K.resolve("Common.ITaskManager").Cb(new xe.a(0,1,0,Object(C.a)(this,this.jkk,"onBootComplete_DelayExecuted"),90,"21"))});this.Ha.jtg&&this.K.resolve("PowerPointWebEditor.IPageHiddenMeter");this.K.resolve("Common.IProcessInputStrategy");
this.K.resolve("PowerPointWebEditor.SessionCleanupHandler");this.K.resolve("PowerPointWebEditor.Graph.GraphNodeDelayConnectValidator").disable();this.K.resolve("Box4.IEditingView");const b=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");zD.Jui(b,this.K.resolve("Common.IFocusManager"));b.izi(this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter"));this.K.resolve("PowerPointWebEditor.IThumbnailNavPaneDragAdapter");this.K.resolve("PowerPointWebEditor.DelayLoadedPackageInitializer");
this.K.resolve("PowerPointWebEditor.IRemoveShapeFidelityViewForEmbeddedFontController");this.K.resolve("PowerPointWebEditor.IPPTApp").glk()}finally{a&&a.dispose()}}dispose(){this.K.resolve("PowerPointWebEditor.IPrefetchManager").dispose();this.K.resolve("PowerPointWebEditor.SessionCleanupHandler").dispose();this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").dispose();this.K.resolve("PowerPointWebEditor.IDocNotifyClient").dispose();this.K.resolve("PowerPointWebEditor.IPodsDocNotifyClient").dispose();
this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").dispose()}oZg(){const a=new sB.a("App::DelayLoadRibbon");try{this.K.resolve("PowerPointWebEditor.IRibbonUser")}finally{a&&a.dispose()}this.FLg=!0;re.a("FixBootRequestForDeepLink")||this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").iYa(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)}tuj(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableRibbon&&(document.getElementById("PptEditingRibbon").parentNode.style.display=
"none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableTitleBar&&(document.getElementById("AppHeaderPanel").style.display="none",document.getElementById("AppHeaderPanel").style.visibility="hidden");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableStatusBar&&(document.getElementById("WACStatusBarContainer").style.display="none");this.K.resolve("PowerPointWebEditor.IApplicationSettings").disableNotes&&(document.getElementById("EditingNotesPanel").parentNode.style.display=
"none")}tai(){"bottom"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").thumbnailPos&&(this.RJd("WACDocumentPanelContent","Horizontal"),this.RJd("EditingThumbnailsPanel","Horizontal"),this.RJd("EditingThumbnailsPanel","EditingThumbnailsPanelShadow"))}RJd(a,b){let c=document.getElementById(a).getAttribute("class").toString();c+=" "+b;document.getElementById(a).setAttribute("class",c)}n9d(){const a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba;if(a){const b=new Id.GraphTransaction(2);
try{b.gd(a),a.yca(16)}finally{b&&b.dispose()}}}g7b(a,b){const c=this.K.resolve("PowerPointWebEditor.ISessionState");a.ZR(()=>{c&&c.V4(b+"DownloadFinished")});ql.a.Kx(a)}PVj(){if(this.Ha.Noc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Rba("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1207)));else{const a=Dx.a.create("pptedit.comment",null,()=>d.e(7).then(d.bind(null,1207)));this.g7b(a,"comment")}}OVj(){if(this.Ha.Noc)this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Rba("pptedit.chronosslim",
null,()=>d.e(5).then(d.bind(null,1204)));else{const a=Dx.a.create("pptedit.chronosslim",null,()=>d.e(5).then(d.bind(null,1204)));this.g7b(a,"chronosslim")}}jkk(){this.K.resolve("PowerPointWebEditor.IPrefetchManager");this.FLg||this.oZg();this.tuj();this.tai();const a=this.K.resolve("PowerPointWebEditor.ISessionState");this.Ha.separateDownloadSignalREnabled&&this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Rba(this.K.resolve("PowerPointWebEditor.PresenceLoader").Rfl,(f,l)=>{Cb.App.lzg()&&
(this.K.resolve("PowerPointWebEditor.ISignalRLoadCompletedListener").gce=l.succeeded)},null);const b=()=>{Aa.a.J(512360582,809,50,"Start to download chronos.js file");this.PVj();this.OVj();this.Ha.Mth||this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").qee()},c=()=>{this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").Ysg(()=>{b()})};(new Ys.a(this.Ha.Dea)).HOj?this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader").KCg().continueWith(()=>{this.n9d()}).continueWith(()=>
{c()}):c();this.K.resolve("PowerPointWebEditor.ISessionTimeUpdater").tTe();this.K.resolve("PowerPointWebEditor.ISessionLifetimeManager").start();a&&a.V4("ChronosStartDownloadTime");try{if(this.Ha.wacAirSpaceResourceLink){const f=sp.a.OWb("wacairspaceanimationlibrary.js"),l=VC.a.create(f,null,null);ql.a.Kx(l)}}catch(f){Aa.a.J(512360581,814,10,"App : OnBootComplete; Exception loading wacAirSpace Resource: {0}",f)}this.Ha.tg&&this.K.resolve("PowerPointWebEditor.PodsPops.IPopSessionInfoClient").Ozj();
u.AFrameworkApplication.fa.ff(()=>{fQ.a.instance.eoi()});MSOJS.ClientUtils.InitUrls(u.AFrameworkApplication.NXk,u.AFrameworkApplication.LXk,u.AFrameworkApplication.MXk)}static main(){u.AFrameworkApplication.Vg&&r.a.eg?Aa.a.J(512360580,809,15,"Firefox attempts to load core ext package when App is disposing"):m.a.instance.Bc(new Gz)}static eui(a){a.register(313,"PowerPointWebEditor.IPrefetchManager").ma().na(()=>new Tp(a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.Image.IImageManager"),a.resolve("PowerPointWebEditor.ICoauthStateGetter"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationViewController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IInboundHelper"),a.resolve("Box4.Graph.IGraphInstance").vd(8),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.ISlideCacheStrategy"),a.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IAppBootCompletedListener"),a.resolve("PowerPointWebEditor.IFontUtilsManager")))}}Object(e.a)(Gz,"CoreExtPackage",null,[2,3]);class FK{constructor(){this.yZc=this.gf=this.Wc=this.pb=null;this.va=new ic.a;this.Db=!1}init(a,b){this.gf=a;this.Wc=b;this.vA()}dispose(){this.pb&&(this.visible=!1,this.Wc.xb(ma.a.click,
this.pb,Object(C.a)(this,this.vHa,"onBackgroundClick")),this.gf&&this.pb&&(this.gf.removeChild(this.pb),this.pb=null),this.va&&(this.va.dispose(),this.va=null))}vA(){this.pb=document.createElement("div");this.pb.className="EditingNotesDefaultView";u.AFrameworkApplication.isRtl&&(this.pb.style.direction=te.a.mZa);this.gf.appendChild(this.pb);this.yZc=document.createElement("p");this.yZc.className="EditingNotesDefaultViewContent";this.yZc.innerText=ResourceStrings.l_ClickToAddNotes;this.pb.appendChild(this.yZc);
this.Wc.ob(ma.a.click,this.pb,Object(C.a)(this,this.vHa,"onBackgroundClick"))}vHa(a){this.va.raiseEvent("OnBackgroundClick",a);return!0}UEf(a){this.va.addHandler("OnBackgroundClick",a)}onResize(){}get visible(){return this.Db}set visible(a){this.Db=a;this.pb.style.display=a?Qi.a.block:Qi.a.none}get xa(){return this.pb}}Object(e.a)(FK,"NotesPromptView",null,[1005,1006,106]);class GK{constructor(a){this.B3c=this.gf=this.pb=null;this.t0c=this.Db=!1;this.Q5j=a}init(a,b){b.nwb&&(this.gf=a,this.pb=document.createElement("div"),
this.pb.className="EditingNotesReadOnlyView",this.Q5j&&(this.pb.style.direction=te.a.mZa),this.gf.appendChild(this.pb),this.B3c=document.createElement("div"),this.B3c.className="EditingNotesReadOnlyViewContent",a={},a.inputString=b.c8c,b=jSanity.sanitize(a),this.B3c.appendChild(b),this.pb.appendChild(this.B3c),this.t0c=!0)}dispose(){this.t0c&&(this.visible=!1,this.gf&&this.pb&&(this.gf.removeChild(this.pb),this.pb=null),this.t0c=!1)}get visible(){return this.Db}set visible(a){this.t0c&&(this.Db=a,
this.pb.style.display=a?Qi.a.block:Qi.a.none)}get xa(){return this.pb}}Object(e.a)(GK,"NotesReadOnlyView",null,[1007,106]);var Hz=d(483),AD=d(632);class er extends Hz.a{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He){super(a,b);this.lAb=this.gg=this.sh=this.tbb=null;this.FUa=!1;this.pua=Cb.App.Mm;this.$Fa=Object(ua.a)(1002,b);this.pb=this.Gd.container;this.kc(this.pb);this.Wc=c;this.Fa=f;this.ecb=l;this.UAb=wa;this.Nl=x;this.pi=G;this.yv=R;this.WI=fa;this.nb=Wa;this.k$a=mb;this.X8=
Object(ua.a)(353,a);this.N9b=Kb;this.jc=nc;this.bqe=oc;this.Gua=Ic;this.cJ=Kc;this.fe=Hc;this.C8j=ie;this.Fp=He;this.N_c=this.fe.hk("formatpaintertext.cur");this.Fp&&this.cJ.XId(Object(C.a)(this,this.nfc,"onTextFPActiveChanged"));this.sh||this.vA()}dispose(){this.Wc.xb(ma.a.click,this.pb.parentNode,Object(C.a)(this,this.vHa,"onBackgroundClick"));this.Fp&&this.cJ.xGe(Object(C.a)(this,this.nfc,"onTextFPActiveChanged"));this.ecb&&(this.ecb.dispose(),this.ecb=null);this.UAb&&(this.UAb.dispose(),this.UAb=
null);super.dispose()}oy(a){super.oy(a);this.Uoc()}Q$(a){this.uD(this.gg,a,-1)}N5(){this.Fjd()}vA(){this.C8j&&(this.lAb=this.Gd.createElement("div"),this.lAb.className="NotesResizeHandle",Qc.c(this.lAb,!0),Sys.UI.DomElement.addCssClass(this.lAb,"NotesResizeHandle"),this.htmlElement.appendChild(this.lAb),this.No(this.lAb));this.tbb=this.Gd.createElement("div");this.tbb.className="NotesContentContainer";this.tbb.id="NotesContentContainer";this.No(this.tbb);this.htmlElement.appendChild(this.tbb);this.sh=
this.Gd.createElement("div");Sys.UI.DomElement.addCssClass(this.sh,"NotesView");Sys.UI.DomElement.addCssClass(this.sh,"NotesEditViewVisible");this.tbb.appendChild(this.sh);this.No(this.sh);this.gg=this.Gd.createElement("div");Sys.UI.DomElement.addCssClass(this.gg,"NotesViewContent");this.sh.appendChild(this.gg);this.No(this.gg);u.AFrameworkApplication.isRtl&&(this.sh.style.direction=te.a.mZa);this.Wc.ob(ma.a.click,this.pb.parentNode,Object(C.a)(this,this.vHa,"onBackgroundClick"));this.ecb.init(this.pb.parentNode,
this.Wc);this.UAb.init(this.pb.parentNode,this.$Fa);this.Fjd();this.ecb.UEf(Object(C.a)(this,this.klk,"onDefaultViewClick"))}Fjd(){if(this.$Fa.nwb)this.mJa(!1),this.uOe(!1),this.Yel();else{var a=this.Nl.abe(this.$Fa);a=this.FUa||!a;this.mJa(a);this.uOe(!a);this.Fp&&this.LC(er.nda)}}nfc(a,b){er.nda=b.FLc;this.LC(er.nda)}LC(a){const b=this.pb.querySelectorAll(".OutlineElement, .EditingSurfaceBody");if(2===a)for(this.pb.style.cursor=$e.a.GP(this.N_c,Qi.a.mA),this.gg.style.cursor=$e.a.GP(this.N_c,Qi.a.mA),
a=0;a<b.length;a++)if(b[a].style.cursor!==$e.a.GP(this.N_c,Qi.a.mA))b[a].style.cursor=$e.a.GP(this.N_c,Qi.a.G$);else break;else for(this.pb.style.cursor=Qi.a.mA,this.gg.style.cursor=Qi.a.mA,a=0;a<b.length;a++)b[a].style.cursor=Qi.a.G$}Uoc(){this.htmlElement.style.zIndex="0";const a=this.Nl.XQa(this.$Fa,this.Gd.Fd),b=this.Nl.U0b(this.$Fa,this.Gd.Fd);var c=a.width-b[1]-b[3];0>c&&(b[1]+=c/2,b[3]+=c/2);c=a.height-b[0]-b[2];0>c&&(b[1]+=c/2,b[3]+=c/2);er.kLe(this.sh,b);er.kLe(this.ecb.xa,b);er.kLe(this.UAb.xa,
b);this.Gua.Rgb(new zc.a(a.x,a.y),u.AFrameworkApplication.isRtl,this.sh,!0)}jeb(){this.FUa=!0;this.UT();this.startEditing()}keb(){this.FUa=!1;this.UT();this.endEditing()}NK(){return this.FUa}startEditing(){this.Fva.nwb?this.nb.kj():(this.Fjd(),this.qxg()||(this.pua=this.Fva.vEa,this.WI.Mnh(this.$Fa,!1),this.WI.$Dk(this.$Fa)))}endEditing(){if(!this.Fva.nwb&&(this.k$a.setVisibility(!1),this.Fjd(),!this.qxg())){this.sXg.endEditing(!0,14);this.N9b.EVd(this.X8);var a=this.bqe.Rsa(this.Fva,this.pua),b=
!!this.Fva&&this.Fva.isConnected;a&&(b&&this.Fva.bid(),this.pi.B4a(this.Fva),this.yv.nOd());this.WI.Mnh(this.$Fa,b&&this.Fva.QTc)}}klk(a,b){this.vHa(b)}vHa(){this.Fa.Gj(zi.a.c2,!0);this.mJa(!0);this.uOe(!1);this.sXg.hR();this.IOe();this.pua=this.Fva.vEa;return!0}qxg(){return!this.jc.un}get xa(){return this.htmlElement}get Fva(){return this.$Fa}get sXg(){return this.Oc}IOe(){this.S$(!0)}Yel(){this.UAb.visible=!0}uOe(a){this.ecb.visible=a}mJa(a){AD.b(a,this.tbb,"NotesContentContainerHidden","NotesContentContainerVisible")}S$(a){AD.b(a,
this.sh,"NotesEditViewHidden","NotesEditViewVisible")}static kLe(a,b){a&&(a.style.paddingTop=$e.a.Nc(b[0]),a.style.paddingRight=$e.a.Nc(b[1]),a.style.paddingBottom=$e.a.Nc(b[2]),a.style.paddingLeft=$e.a.Nc(b[3]))}static MLj(a){return a?Sys.UI.DomElement.containsCssClass(a,"NotesResizeHandle"):!1}}er.nda=0;Object(e.a)(er,"NotesViewElement",Hz.a,[1004,359]);var Qr=d(374),oQ=d(603),pQ=d(819),HK=d(481),Iz=d(480);class IK extends Iz.a{constructor(a,b){super(a,b);this.lda=[];this.X8b=0}BFb(a,...b){Array.addRange(this.lda,
b);this.X8b=a}ejc(){if(this.lda)for(const a of this.lda)this.Ft.djc(this.container,a,this.X8b);this.Ft.nJ(this.container,this.v2)}Poc(){this.Ft.yE(this.container,this.v2);for(const a of this.lda)this.Ft.yE(this.container,a)}}Object(e.a)(IK,"NotesViewDomManager",Iz.a,[]);var Jz=d(545);class JK extends Jz.ViewSelectionChangedHandler{constructor(a,b){super(a);this.ra=b}Tqb(){return[Object(C.a)(this,this.bfc,"onSetup"),Object(C.a)(this,this.Aec,"onEnsurePageViewElementsCreated"),Object(C.a)(this,this.Bec,
"onEnsureSelectedContentViewElementsCreated"),Object(C.a)(this,this.Pec,"onMainLoop"),Object(C.a)(this,this.rok,"onNotesContentSelect"),Object(C.a)(this,this.wec,"onCommit"),Object(C.a)(this,this.mfc,"onTearDown")]}rok(a,b){this.efa(b);a=Object(ua.a)(1002,this.yh.vg);if(!a)return!0;a=Object(ua.a)(1004,a.oc(this.yh.Ma));if(!a)return!0;this.ra.Ija()?a.NK()||a.jeb():a.NK()&&a.keb();return!0}}Object(e.a)(JK,"NotesViewSelectionChangedHandler",Jz.ViewSelectionChangedHandler,[]);class BD extends Fv.DragSelectionDragAdapter{constructor(a,
b,c,f,l,x){super(a,b,c);this.Wp=f;this.rfe=x;this.Nl=l}Du(a){if(this.rfe){var b=this.Doc(a);const c=b?b.$a:null;if(c){const f=this.Nl.$Da(c)?Object(ua.a)(1002,c):this.Nl.Ltb(c);if(f&&this.Nl.abe(f))return!1}if(a.ctrlKey&&b&&c&&(b=this.Ef.MZa(a.clientPoint,b,c,this.Ef,!1))&&Lb.HyperlinkReader.Gja(b,!0))return!1}a=super.Du(a);null!==this.Wp&&a&&this.Wp.Ywa(Qi.a.G$);return a}Yt(a){super.Yt(a);null!==this.Wp&&this.Wp.Cwa()}Sn(a){super.Sn(a);null!==this.Wp&&this.Wp.Cwa()}tI(a){return this.Ef.isActive?
super.tI(a):!1}static V0b(a){return new BD(a,fb.a.instance.resolve("Common.IActionManagerExtended"),fb.a.instance.resolve("Common.IActivityManager"),fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?fb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):null,fb.a.instance.resolve("PowerPointWebEditor.Graph.INotesReader"),fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix)}}Object(e.a)(BD,
"NotesDragSelectionDragAdapter",Fv.DragSelectionDragAdapter,[]);var Kz=d(227);class CD{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){this.bOg=this.Dac=this.gHg=this.jpe=this.OFa=0;this.y9=this.S8b=this.D2c=null;this.b8b=this.RFg=this.k2c=0;this.cie=!1;this.X8=a;this.o_=b;this.hj=c;this.Ob=f;this.Xz=l;this.Jg=x;this.uc=G;this.Hc=R;this.Fb=fa;wa.HNa(Object(C.a)(this,this.Uec,"onOutboundReplication"));this.ia=Wa}mv(a){return a&&a.dA!==Sys.UI.MouseButton.rightButton?er.MLj(a.Ac):!1}Du(a){if(!this.mv(a))return!1;
this.cie=!0;this.D2c=this.Xz.xa;if(!this.D2c)return!1;this.y9=this.Hc.Gc;if(this.y9&&(this.S8b=this.Jg.xa))this.gHg=this.S8b.clientHeight;else return!1;this.k2c=Math.floor(.75*(this.D2c.clientHeight+this.S8b.clientHeight));this.jpe=this.D2c.clientHeight;this.Dac=this.OFa=a.clientPoint.y;this.bOg=this.y9.bW;this.o_.Yk(7);this.X8.endEditing(!0,14);return!0}mw(a){if(!a)return!1;this.OFa=a.clientPoint.y;a=this.ZMf(this.OFa);this.Xz.hea=a;this.Ob.Fq();a=this.gHg+this.jpe-a;this.S8b.style.height=a+"px";
this.y9.W5k(a-1);this.y9.b8k(this.bOg);return!0}Sn(a){this.o_.q0();this.X8.hR();this.b8b=this.ZMf(a?a.clientPoint.y:this.OFa);this.ia.La(ba.a.fLe,2,this.b8b)}Yt(){this.cie&&(this.cie=!1,this.Sn(null))}Uec(){this.b8b!==this.RFg&&2===Cb.App.Hb.mode&&(this.RFg=this.b8b,this.vtk(this.b8b))}vtk(a){const b=this.uc.Gn,c=this.Fb.ud(4);try{c.kc(b),b.aDb=4320,b.hea=this.aki(a)}finally{c&&c.dispose()}}ZMf(a){a=this.jpe+this.hj.Hm(this.Dac-a);0<this.k2c&&a>this.k2c?a=this.k2c:a<Kz.a.BPa&&a>sf.a.YIc?a=Kz.a.BPa:
a<sf.a.YIc&&(a=sf.a.S_f);return a}aki(a){return this.hj.GAe(a,1)}static V0b(a){return new CD(a,fb.a.instance.resolve("Common.CursorManager"),fb.a.instance.resolve("PowerPointWebEditor.IPPTUnitConversion"),fb.a.instance.resolve("Box4.IAppFrame"),fb.a.instance.resolve("PowerPointWebEditor.INotesPane"),fb.a.instance.resolve("PowerPointWebEditor.ISlidePane"),fb.a.instance.resolve("PowerPointWebEditor.IPresentationReader"),fb.a.instance.resolve("PowerPointWebEditor.IActiveSlideViewManager"),fb.a.instance.resolve("Common.Transaction.ITransactionFactory"),
fb.a.instance.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),fb.a.instance.resolve("Common.IActionManagerExtended"))}}Object(e.a)(CD,"NotesResizeDragAdapter",null,[232]);class KK extends Qr.a{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){super(zi.a.c2,a,b,c,f,l,G,R,mb);this.Wme=!1;this.ZGa=x;this.jc=fa;this.Yf=wa;this.NN=Wa;this.rfe=Kb;this.Fp=nc}get PJd(){return u.AFrameworkApplication.fa}Hx(a,b=null){this.Fp&&this.Yf.ob(ma.a.dJ,this.container,Object(C.a)(this,this.t7c,"mouseUpHandlerFilter"));
super.Hx(a,b);(a=Object(ua.a)(1002,a))&&a.nwb&&this.yg&&this.yg.Hn&&this.yg.Hn.setAttribute("aria-readonly","true")}detach(){this.Fp&&this.ho&&this.Yf.xb(ma.a.dJ,this.container,Object(C.a)(this,this.t7c,"mouseUpHandlerFilter"));super.detach()}mVb(a,b){return new IK(a,b)}wca(a){a=super.wca(a);a.v2=BD.V0b(this);a.BFb(1,CD.V0b(this));return a}Pva(a){this.jvc=a.Wf;if(!this.Sic||this.isActive||!this.rfe||(a.mc.type===ma.a.mouseDown||a.mc.type===ma.a.iOa)&&a.dA!==Sys.UI.MouseButton.leftButton)return!1;
var b=a.Ac;if(b&&Sys.UI.DomElement.containsCssClass(b,"NotesResizeHandle"))return!1;let c=!1;Qr.a.e7&&(c=Qr.a.e7.fra());Cb.App.nD.jS&&Cb.App.nD.jS.ZHe(f=>{f&&(c=!0)});b=!re.a("DeprecateIE.NotesView")&&c&&r.a.oW;a=new oQ.a(a,this,!0,b);this.ADk(a);return!1}ADk(a){this.DBe();this.j5(r.a.eg||r.a.xSa);this.xp.raiseEvent(Qr.a.ESc,new pQ.a(a.graphNode));this.uLc(a.graphNode);this.qWe();const b=[Object(C.a)(this,this.Cve,"noneClickHandler"),Object(C.a)(this,this.Whk,"notesSnapToContentClickHandler"),Object(C.a)(this,
this.Rhk,"notesDefaultClickHandler")];for(const c of b)if(c(a).X2){this.Wme=!0;break}}t7c(){return this.Wme&&this.NN.$Sa?(this.Ca.processAction(E.a.Cia,2),!0):this.Wme=!1}Rhk(a){const b=Qr.a.Tc.Kp(E.a.lqb);b.properties.$(Dd.a.source,"DefaultClickHandler");this.J5(a.BU,a.Or,a.graphNode,a.Oc,a.Vi.shiftKey,a.Vi.ctrlKey,a.Vi.Wf);b.end();a.ysb&&this.j5(!0);this.editingView.W9a(a.Vi.shiftKey,a.BU,a.Vi.Wf);return Hh.a.Jl(!0)}Whk(a){if(!a.Or){const b=a.Or,c=a.graphNode,f=Qr.a.Tc.Kp(E.a.lqb);f.properties.$(Dd.a.source,
"SnapToContentClickHandler");this.J5(a.BU,b,c,this,a.Vi.shiftKey,a.Vi.ctrlKey,a.Vi.Wf);f.end();a.ysb&&this.j5(!0);this.editingView.W9a(a.Vi.shiftKey,a.BU,a.Vi.Wf);return Hh.a.Jl(!0)}return Hh.a.notHandled}dma(){super.dma();this.yg&&this.yg.Hn&&(this.PJd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.yg.Ukc(Jc.a.FCc):this.yg.fKe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,"",Jc.a.FCc),this.yg.Hn.setAttribute(Jc.a.Wr,ResourceStrings.l_NotesPane))}Lkd(){this.ME.Nd===this&&
this.suspend()}Afd(){this.ME.Nd===this&&this.resume()}VOc(){return new JK(this,fb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"))}zMc(){return[Object(C.a)(this,this.Cve,"noneClickHandler"),Object(C.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(C.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(C.a)(this,this.defaultClickHandler,"defaultClickHandler")]}fNc(){return[Object(C.a)(this,this.Cve,"noneClickHandler"),Object(C.a)(this,this.defaultDoubleClickHandler,
"defaultDoubleClickHandler")]}Cve(a){return this.owb(a)||this.NLj()?Hh.a.Jl(!0):Hh.a.notHandled}UMc(){return[Object(C.a)(this,this.noContextMenuHandler,"noContextMenuHandler"),Object(C.a)(this,this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(C.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}oxa(a){this.owb(a)||super.oxa(a)}noContextMenuHandler(a){return this.owb(a)?Pm.a.Jl(null):Pm.a.notHandled}owb(a){return!!a&&!!a.graphNode&&
60===a.graphNode.type&&a.graphNode.nwb}NLj(){return!this.jc.un}w7a(){return HK.a.tue}get oF(){return super.oF|96}get dIb(){return!0}Q5(a,b,c=null){this.ZGa.vX(this)&&super.Q5(a,b,c)}}Object(e.a)(KK,"NotesView",Qr.a,[314,351,352,201,106,353,354,355,356,357]);var LK=d(482),Lz=d(206);class DD{constructor(a,b,c,f){this.DNg=null;this.xua=a;this.ua=b;this.Eq=c;this.tle=f}eAj(){this.DNg=new LK.a(Lz.App.m3a.Uhk,"EditingNotesPanel","EditingNotesPanel InteractiveView");this.xua.LAa(this.DNg.rya);Hv.bSf(this.xua);
this.iJf(this.ua.Ba);this.Eq.T4h(Object(C.a)(this,this.YYg,"onAttachNotesView"))}YYg(a,b){this.qOi();this.iJf(b.Ed)}iJf(a){this.ua.presentation&&a&&a.isConnected&&(a=this.tle.Sag(a,27),this.xua.Hx(a))}qOi(){this.xua.ho&&(this.xua.editingView.disable(!0,14),this.xua.detach())}dispose(){this.Eq.WQk(Object(C.a)(this,this.YYg,"onAttachNotesView"))}}Object(e.a)(DD,"NotesViewHelper",null,[106]);class ED{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Notes"}Wb(a){this.K=a;this.K.register(314,
"PowerPointWebEditor.INotesView").ma().na(()=>new KK(this.K.resolve("Box4.IWorkspace"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),this.K.Ka("Box4.ITextMetricsAdapter"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),
this.K.resolve("Common.MouseInputManager"),this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNoteDragSelectionFix,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));this.K.register(DD,"PowerPointWebEditor.Notes.NotesViewHelper").ma().na(()=>new DD(this.K.resolve("PowerPointWebEditor.INotesView"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.Graph.IGraphNodeHelper")))}init(){this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393326,new rj.a((a,b)=>Object(Ma.a)(314,a)?new er(a,b,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),new FK,this.K.resolve("PowerPointWebEditor.Graph.INotesReader"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),new GK(u.AFrameworkApplication.isRtl),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoActionBehavior"),this.K.resolve("PowerPointWebEditor.ViewCore.IPPTPositionEditor"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").E7g,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled):null));this.K.resolve("Box4.IEditingView");this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").eAj()}dispose(){this.K.resolve("PowerPointWebEditor.Notes.NotesViewHelper").dispose()}static main(){m.a.instance.Bc(new ED)}}Object(e.a)(ED,"PPTWebEditorNotesPackage",null,[2,3]);class FD extends Fv.DragSelectionDragAdapter{constructor(a,
b,c,f){super(a,b,c);this.Wp=f}Du(a){a=super.Du(a);null!==this.Wp&&a&&this.Wp.Ywa(Qi.a.G$);return a}Yt(a){super.Yt(a);null!==this.Wp&&this.Wp.Cwa()}Sn(a){super.Sn(a);null!==this.Wp&&this.Wp.Cwa()}tI(a){return this.Ef.isActive?super.tI(a):!1}static V0b(a){return new FD(a,fb.a.instance.resolve("Common.IActionManagerExtended"),fb.a.instance.resolve("Common.IActivityManager"),fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?fb.a.instance.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null)}}Object(e.a)(FD,"SmartArtTextViewDragSelectionDragAdapter",Fv.DragSelectionDragAdapter,[]);class MK extends Iz.a{constructor(a,b){super(a,b);this.lda=[];this.X8b=0}BFb(a,...b){Array.addRange(this.lda,b);this.X8b=a}ejc(){if(this.lda)for(const a of this.lda)this.Ft.djc(this.container,a,this.X8b);this.Ft.nJ(this.container,this.v2)}Poc(){this.Ft.yE(this.container,this.v2);for(const a of this.lda)this.Ft.yE(this.container,a)}}Object(e.a)(MK,"SmartArtTextViewDomManager",Iz.a,[]);class NK extends Jz.ViewSelectionChangedHandler{constructor(a,
b,c,f){super(a);this.ra=b;this.Ne=c;this.fO=f}Tqb(){return[Object(C.a)(this,this.bfc,"onSetup"),Object(C.a)(this,this.Aec,"onEnsurePageViewElementsCreated"),Object(C.a)(this,this.Bec,"onEnsureSelectedContentViewElementsCreated"),Object(C.a)(this,this.Pec,"onMainLoop"),Object(C.a)(this,this.crk,"onSmartArtContentSelect"),Object(C.a)(this,this.wec,"onCommit"),Object(C.a)(this,this.mfc,"onTearDown")]}crk(a,b){this.efa(b);b=Object(ua.a)(4,this.yh.vg);if(!b)return!1;a=Object(ua.a)(358,b.oc(this.yh.Ma));
b=Object(ua.a)(121,b.oc(this.Ne));if(!a)return!1;this.ra.USa()?a.NK()||(a.jeb(),this.fO.kp(!0),b&&b.jeb()):a.NK()&&(a.keb(),this.fO.kp(!1),b&&b.keb());return!0}}Object(e.a)(NK,"SmartArtTextViewSelectionChangedHandler",Jz.ViewSelectionChangedHandler,[]);class OK extends Qr.a{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){super(Yb.a.sU,a,c,f,l,G,fa,wa,Wa);this.ZGa=R;this.ra=b;this.zq=x;this.Ne=mb;this.fO=Kb;this.Fa=nc;this.Fd.bWe=!0;this.Fd.KYd=!1}get PJd(){return u.AFrameworkApplication.fa}mVb(a,b){return new MK(a,
b)}wca(a){a=super.wca(a);a.v2=FD.V0b(this);return a}dma(){super.dma();this.yg&&this.yg.Hn&&(this.PJd.ka("AccessibilityNotificationEnabledViaAriaLiveRegion")?this.yg.Ukc(Jc.a.FCc):this.yg.fKe(Box4Intl.Box4Strings.l_EditingSurfaceScreenReaderTitleMessage,Box4Intl.Box4Strings.l_EditingSurfaceF2ScreenReaderDescribedByMessage,Jc.a.FCc),this.yg.Hn.setAttribute(Jc.a.Wr,ResourceStrings.l_SmartArtTextPane))}Lkd(){this.ME.Nd===this&&this.suspend()}Afd(){this.ME.Nd===this&&this.resume()}VOc(){return new NK(this,
fb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),this.Ne,this.fO)}cqb(){this.ME.Nd===this&&this.ra.bOd();return!1}zMc(){return[Object(C.a)(this,this.snapToContentClickHandler,"snapToContentClickHandler"),Object(C.a)(this,this.floatieClickHandler,"floatieClickHandler"),Object(C.a)(this,this.tripleClickHandler,"tripleClickHandler"),Object(C.a)(this,this.defaultClickHandler,"defaultClickHandler")]}fNc(){return[Object(C.a)(this,this.defaultDoubleClickHandler,"defaultDoubleClickHandler")]}UMc(){return[Object(C.a)(this,
this.noViewElementContextMenuHandler,"noViewElementContextMenuHandler"),Object(C.a)(this,this.domElementSelectedContextMenuHandler,"domElementSelectedContextMenuHandler")]}onClick(a){a=super.onClick(a);this.Fa.Gj(Yb.a.sU,!0);return a}w7a(){return HK.a.tue}get oF(){let a=super.oF;return a=re.a("SmartArt.ListensToRenderOverlayInvalidations")?a|64:a|96}get dIb(){return!0}Q5(a,b,c=null){this.ZGa.vX(this)&&super.Q5(a,b,c)}j7k(a){const b=this.zq.ke(2);try{b.gd(a);let c=null;c=rd.SelectionFactory.rj(a,!0);
this.setSelection(c)}finally{b&&b.dispose()}}}Object(e.a)(OK,"SmartArtTextView",Qr.a,[294,351,352,201,106,353,354,355,356,357]);class PK extends Hz.a{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){super(a,b);this.gg=this.sh=null;this.FUa=!1;this.pua=Cb.App.Mm;this.a5c=b;this.pb=this.Gd.container;this.kc(this.pb);this.Wc=c;this.Fa=f;this.ia=l;this.pi=x;this.yv=G;this.WI=R;this.k$a=fa;this.X8=a;this.N9b=wa;this.od=Wa;this.vA()}dispose(){this.Wc.xb(ma.a.click,this.pb.parentNode,Object(C.a)(this,this.vHa,"onBackgroundClick"));
this.od.ZSk(Object(C.a)(this,this.P2g,"onSmartArtTextPaneWidthChanged"));super.dispose()}oy(a){super.oy(a)}Q$(a){this.uD(this.gg,a,-1)}N5(){this.mJa(!0)}vA(){this.sh=this.Gd.createElement("div");Sys.UI.DomElement.addCssClass(this.sh,"SmartArtTextView");Sys.UI.DomElement.addCssClass(this.sh,"SmartArtTextViewVisible");this.htmlElement.appendChild(this.sh);this.No(this.sh);this.gg=this.Gd.createElement("div");Sys.UI.DomElement.addCssClass(this.gg,"SmartArtTextViewContent");this.gg.style.width=$e.a.Nc(sf.a.ymc-
2*sf.a.FIb-2*sf.a.gPe-sf.a.Zth);this.sh.appendChild(this.gg);this.No(this.gg);u.AFrameworkApplication.isRtl&&(this.sh.style.direction=te.a.mZa);this.mJa(!0);this.Wc.ob(ma.a.click,this.pb.parentNode,Object(C.a)(this,this.vHa,"onBackgroundClick"));this.od.h8h(Object(C.a)(this,this.P2g,"onSmartArtTextPaneWidthChanged"))}jeb(){this.FUa=!0;this.UT();this.startEditing()}keb(){this.FUa=!1;this.UT();this.endEditing()}NK(){return this.FUa}startEditing(){this.mJa(!0);this.pua=this.aZa.vEa;this.WI.clc(this.a5c,
!1);this.WI.dcd(this.a5c)}endEditing(){this.k$a.setVisibility(!1);this.mJa(!0);this.auh.endEditing(!0,14);this.N9b.EVd(this.X8);const a=new Ju.a(this.aZa,this.pua);this.ia.La(ba.a.cfb,2,a);const b=!!this.aZa&&this.aZa.isConnected;a.Rsa&&(b&&this.aZa.bid(),this.pi.B4a(this.aZa),this.yv.nOd());this.WI.clc(this.a5c,b&&this.aZa.QTc)}vHa(){this.Fa.Gj(Yb.a.sU,!0);this.auh.hR();this.mJa(!0);this.pua=this.aZa.vEa;return!0}get xa(){return this.htmlElement}get aZa(){return this.a5c}get auh(){return this.Oc}mJa(a){AD.b(a,
this.sh,"SmartArtTextViewHidden","SmartArtTextViewVisible")}P2g(a,b){this.gg.style.width=$e.a.Nc($e.a.qn(b.width))}}Object(e.a)(PK,"SmartArtTextViewElement",Hz.a,[358,359]);class QK{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){this.ERg=this.w$a=null;this.fO=a;this.JGa=b;this.od=c;this.Fa=f;this.yv=l;this.CL=x;this.ra=G;this.Mb=Object(ua.a)(353,R);this.Eq=fa;this.lh=wa;this.jc=Wa;this.D_=mb}IAj(){this.ERg=new LK.a(this.fO.U_f,"SmartArtTextViewContainer","SmartArtTextViewContainer InteractiveView EditMode");
this.JGa.LAa(this.ERg.rya);Hv.bSf(this.JGa);this.od.Z7h(Object(C.a)(this,this.w2g,"onSingleSmartArtShapeViewElementSelected"));this.od.$7h(Object(C.a)(this,this.x2g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.od.g8h(Object(C.a)(this,this.O2g,"onSmartArtShapeViewElementDeselected"));this.od.eUb(Object(C.a)(this,this.t$c,"onSlideHtmlUpdated"));this.od.a5h(Object(C.a)(this,this.N2g,"onSmartArtCommentsVisibilityChanged"));this.CL.R6(Object(C.a)(this,this.cfc,"onShapeDisconneted"));
this.Eq.KId(Object(C.a)(this,this.YT,"onFocusChanged"));this.Eq.tBc(Object(C.a)(this,this.YT,"onFocusChanged"));this.Mb.KNa((a,b)=>{this.t$c(a,b)})}fta(){return!this.jc.un}DOe(a){if(this.D_){if(this.fta()||a.Zla)return}else if(this.fta())return;a&&a.Pf&&!a.get_smartArtModelId()&&a.isConnected?(Aa.a.J(38618783,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is SmartArt"),a.dPe||(this.w$a!==a&&(this.w$a=a,this.MVd(),this.jJf(a)),this.fO.CVe(a),this.fO.kp(!0))):Aa.a.J(38618785,822,50,
"SmartArtTextViewHelper::ShowSmartArtTextPane - shapeNode is not SmartArt or not connected")}mfl(a){this.fta()||(a&&a.Pf&&!a.get_smartArtModelId()&&a.isConnected?(Aa.a.J(38618787,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is SmartArt"),a.dPe||(this.w$a!==a&&(this.w$a=a,this.MVd(),this.jJf(a)),this.Fa.Gj(Yb.a.sU,!0),this.yv.Yv(),this.JGa.j7k(a),this.fO.CVe(a),this.fO.kp(!0))):Aa.a.J(38618817,822,50,"SmartArtTextViewHelper::ShowSmartArtTextPaneForEdit - shapeNode is not SmartArt or not connected"))}yZf(){this.fO.isVisible&&
(Aa.a.J(38618819,822,50,"SmartArtTextViewHelper::DismissSmartArtTextPane"),this.fO.kp(!1))}w2g(a,b){this.fta()||this.DOe(b.shapeNode)}x2g(a,b){this.fta()||this.mfl(b.shapeNode)}O2g(){this.fta()||this.yZf()}t$c(){if(!this.fta()&&this.ra.aL()){const a=this.ra.UCa();Aa.a.J(38618821,822,50,"SmartArtTextViewHelper::OnSlideHtmlUpdated");a&&this.fO.CVe(a)}}YT(a,b){this.fta()||(a=b.UCb,a===Yb.a.sU?this.lh.lK(Yb.a.sU):this.lh.T4b(a)&&this.lh.zo(Yb.a.sU))}jJf(a){a&&a.isConnected&&this.JGa.Hx(a)}MVd(){this.JGa.ho&&
(this.JGa.editingView.disable(!0,14),this.JGa.detach())}cfc(a,b){this.fta()||b.node!==this.w$a||(this.w$a=null,this.MVd(),this.fO.kp(!1))}N2g(a,b){this.fta()||((a=b.K9k)?a.Pf&&this.DOe(a):(a=this.ra.UCa())?this.w$a!==a&&this.DOe(a):this.yZf())}dispose(){this.od.RSk(Object(C.a)(this,this.w2g,"onSingleSmartArtShapeViewElementSelected"));this.od.SSk(Object(C.a)(this,this.x2g,"onSingleSmartArtShapeViewElementSelectedAndEnterTextEdit"));this.od.YSk(Object(C.a)(this,this.O2g,"onSmartArtShapeViewElementDeselected"));
this.od.aRk(Object(C.a)(this,this.N2g,"onSmartArtCommentsVisibilityChanged"));this.CL.vIa(Object(C.a)(this,this.cfc,"onShapeDisconneted"));this.Eq.wfh(Object(C.a)(this,this.YT,"onFocusChanged"));this.Eq.Jed(Object(C.a)(this,this.YT,"onFocusChanged"));this.od.Tfh(Object(C.a)(this,this.t$c,"onSlideHtmlUpdated"));this.Mb.xjc((a,b)=>{this.t$c(a,b)})}}Object(e.a)(QK,"SmartArtTextViewHelper",null,[295,106]);class GD{constructor(){this.K=null;this.Vz=!1}get name(){return"PowerPointWebEditor.SmartArt"}Wb(a){this.K=
a;this.K.register(294,"PowerPointWebEditor.ISmartArtTextView").ma().na(()=>new OK(this.K.resolve("Box4.IWorkspace"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IInteractiveViewManager"),()=>this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Graph.IGraphTransactionFactory"),this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPointWebEditor.View.IViewValidateStrategy"),this.K.resolve("Box4.IInteractiveEventNotifier"),
this.K.Ka("Box4.ITextMetricsAdapter"),this.K.resolve("Box4.IRotatingCoordinateConverter"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.register(295,"PowerPointWebEditor.ISmartArtTextViewHelper").ma().na(()=>new QK(this.K.resolve("PowerPointWebEditor.View.ISmartArtTextPane"),this.K.resolve("PowerPointWebEditor.ISmartArtTextView"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("Box4.Graph.IGraphInstance").vd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").dja))}init(){const a=this.K.resolve("Common.IAppSettingsManager");
a.ff(()=>{if(this.Vz=a.ka("341"))this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(1074135132,new rj.a((b,c)=>Object(Ma.a)(294,b)?(c=Object(ua.a)(4,c))&&c.Pf?new PK(b,c,this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),this.K.resolve("PowerPointWebEditor.Proofing.IProofingBehaviorController"),
this.K.resolve("Box4.IGrippersManager"),this.K.resolve("PowerPointWebEditor.IGraphUpdateStrategy"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")):null:null)),this.K.resolve("Box4.IEditingView"),this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").IAj()})}dispose(){this.Vz&&(this.K.resolve("PowerPointWebEditor.ISmartArtTextViewHelper").dispose(),this.K.resolve("PowerPointWebEditor.ISmartArtTextView").dispose())}static main(){m.a.instance.Bc(new GD)}}Object(e.a)(GD,
"PPTWebEditorSmartArtPackage",null,[2,3]);class RK{constructor(){this.lvl9pPrField=this.lvl8pPrField=this.lvl7pPrField=this.lvl6pPrField=this.lvl5pPrField=this.lvl4pPrField=this.lvl3pPrField=this.lvl2pPrField=this.lvl1pPrField=this.defPPrField=null}}Object(e.a)(RK,"CT_WebTextListStyle",null,[]);var Mz=d(494),Vi=d(239);class Iv{constructor(a,b,c,f){this.type=a;this.stops=b;this.angle=c;this.Jwk=f}GU(){const a=Vq.b(this.stops,b=>b.GU()).join(",");if(0===this.type)return String.format("linear-gradient({0}deg, {1})",
this.angle,a);if(1===this.type||2===this.type)return String.format("radial-gradient(circle at {0}, {1})",this.Jwk.GU(),a);Aa.a.J(18392962,822,15,String.format("Unexpected gradient type encountered: {0}.",this.type));return Vi.Color.auto.GU()}static createLinearGradient(a,b){return new Iv(0,a,b,null)}static BBi(a,b){return new Iv(1,a,0,b)}}Object(e.a)(Iv,"GradientFill",null,[]);class HD{constructor(a,b){this.left=a;this.top=b}GU(){return String.format("{0}% {1}%",this.left,this.top)}}Object(e.a)(HD,
"GradientPathCenter",null,[]);class SK{constructor(a,b){this.color=a;this.position=b}GU(){return String.format("{0} {1}%",this.color.GU(),this.position)}}Object(e.a)(SK,"GradientStop",null,[]);const Nz=a=>{a=Fi.a(a);return!a||!a.blipFillField&&!a.gradFillField&&!a.grpFillField&&!a.noFillField&&!a.pattFillField&&!a.solidFillField},Kx=a=>{uf.Box4ColorHelper.JPa(a)},qQ=(a,b)=>{if(!a)return null;var c=a.gsLstField;if(c){var f=new Ha.a;for(const l of c)c=uf.Box4ColorHelper.eKc(l),uf.Box4ColorHelper.k$d(c)?
Aa.a.J(18397184,822,15,"Encountered invalid gradient stop color."):f.add(new SK(uf.Box4ColorHelper.UL(c,b),l.posField/1E3));b=f.toArray()}else b=null;if(a.linField)return f=90,a.linField.angFieldSpecified&&(f=(a.linField.angField/6E4+90)%360),Iv.createLinearGradient(b,f);if(a.pathField)return f=new HD(50,50),a.pathField.fillToRectField&&(f=new HD(a.pathField.fillToRectField.lField/1E3,a.pathField.fillToRectField.tField/1E3)),Iv.BBi(b,f);Aa.a.J(18397154,822,50,"Gradient fill's linField and pathField are both null");
return Iv.createLinearGradient(b,90)},TK=a=>{if(!a)return null;a=Fi.a(a);return Object.assign(new Mz.a,{blipFillField:a.blipFillField||null,gradFillField:a.gradFillField||null,grpFillField:a.grpFillField||null,noFillField:a.noFillField||null,pattFillField:a.pattFillField||null,solidFillField:a.solidFillField||null})};class UK{constructor(a){this.jka=a}V1(a,b){const c=a.tableStyle;if(c){var f=a.tableLook,l=!!(f&32)&&!!c.firstRowField,x=!!(f&64)&&!!c.lastRowField,G=!!(f&128)&&!!c.firstColField,R=!!(f&
256)&&!!c.lastColField,fa=l&&G&&!!c.nwCellField,wa=l&&R&&!!c.neCellField,Wa=x&&G&&!!c.swCellField,mb=x&&R&&!!c.seCellField,Kb=!!(f&512)&&!!c.band1HField,nc=!!(f&512)&&!!c.band2HField,oc=!!(f&1024)&&!!c.band1VField;f=!!(f&1024)&&!!c.band2VField;var Ic=!b.ge,Kc=b.Zf===a.WX,Hc=!b.$d;a=b.Lf===a.Dqa;var ie=1===b.ge%2===l;b=1===b.$d%2===G;var He=!(l&&Ic)&&!(x&&Kc),fe=!(G&&Hc)&&!(R&&a);c.wholeTblField&&this.apply(c.wholeTblField);He&&(Kb&&ie||nc&&!ie)&&(ie?this.apply(c.band1HField):this.apply(c.band2HField));
fe&&(oc&&b||f&&!b)&&(b?this.apply(c.band1VField):this.apply(c.band2VField));a&&R&&this.apply(c.lastColField);Hc&&G&&this.apply(c.firstColField);Kc&&x&&(this.apply(c.lastRowField),a&&mb&&this.apply(c.seCellField),Hc&&Wa&&this.apply(c.swCellField));Ic&&l&&(this.apply(c.firstRowField),a&&wa&&this.apply(c.neCellField),Hc&&fa&&this.apply(c.nwCellField))}}apply(a){if(a.tcTxStyleField){var b=a.tcTxStyleField;a=Fi.a(b);uf.Box4ColorHelper.k$d(a)||(uf.Box4ColorHelper.JPa(this.jka),this.jka.solidFillField=new Nq.a,
uf.Box4ColorHelper.yai(this.jka.solidFillField,a));a=b.bField;var c=b.iField;if(b.fontRefField){b=b.fontRefField.idxField;var f=this.jka;0===b||1===b?(f.latinField=Fe.Vqb(b,0),f.eaField=Fe.Vqb(b,1),f.csField=Fe.Vqb(b,2)):Aa.a.J(8959121,820,10,"StyleResolverHelper::ResolveToThemeFont - Invalid font collection index encountered")}else b.fontField&&(b=b.fontField,null!==b.latinField&&(this.jka.latinField=b.latinField),null!==b.eaField&&(this.jka.eaField=b.eaField),null!==b.csField&&(this.jka.csField=
b.csField));if(0===a||1===a)this.jka.bFieldSpecified=!0,this.jka.bField=0===a;if(0===c||1===c)this.jka.iFieldSpecified=!0,this.jka.iField=0===c}}}Object(e.a)(UK,"CellTextStylePartApplier",null,[]);class Ls{constructor(a){this.zSg=a}get value(){return this.zSg.valField/1E5}set value(a){this.zSg.valField=Math.floor(1E5*a)}get type(){return Ls.EVb}}Ls.EVb="CT_TextSpacingPercent:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(e.a)(Ls,"LineSpacingPercent",null,[1096,1097]);class fr{constructor(a){this.ASg=
a}get value(){return this.ASg.valField/100}set value(a){this.ASg.valField=Math.floor(100*a)}get type(){return fr.EVb}}fr.EVb="CT_TextSpacingPoint:#Microsoft.Office.Server.Powerpoint.Interface.Edit";Object(e.a)(fr,"LineSpacingPoint",null,[1096,1097]);class rQ{constructor(){this.valField=0}}Object(e.a)(rQ,"CT_TextSpacingPoint",null,[]);class Ms{constructor(a){this.Mge=a}get lineSpacing(){return this.Mge}get value(){return this.Mge.value}set value(a){this.Mge.value=a}static FXb(a){if(a.__type===Ls.EVb)return new Ms(new Ls(a));
if(a.__type===fr.EVb)return new Ms(new fr(a));Aa.a.J(8958300,820,10,"Unsupported line spacing format {0}",a.__type);return null}}Object(e.a)(Ms,"LineSpacingWrapper",null,[]);const VK=(a,b)=>{switch(b){case 0:return a.defPPrField;case 1:return a.lvl1pPrField;case 2:return a.lvl2pPrField;case 3:return a.lvl3pPrField;case 4:return a.lvl4pPrField;case 5:return a.lvl5pPrField;case 6:return a.lvl6pPrField;case 7:return a.lvl7pPrField;case 8:return a.lvl8pPrField;case 9:return a.lvl9pPrField;default:return null}},
WK=(a,b)=>{b.baselineFieldSpecified&&(a.baselineFieldSpecified=!0,a.baselineField=b.baselineField);b.bFieldSpecified&&(a.bFieldSpecified=!0,a.bField=b.bField);b.capFieldSpecified&&(a.capFieldSpecified=!0,a.capField=b.capField);b.iFieldSpecified&&(a.iFieldSpecified=!0,a.iField=b.iField);b.noProofFieldSpecified&&(a.noProofFieldSpecified=!0,a.noProofField=b.noProofField);b.rtlFieldSpecified&&(a.rtlFieldSpecified=!0,a.rtlField=b.rtlField);b.strikeFieldSpecified&&(a.strikeFieldSpecified=!0,a.strikeField=
b.strikeField);b.szFieldSpecified&&(a.szFieldSpecified=!0,a.szField=b.szField);b.uFieldSpecified&&(a.uFieldSpecified=!0,a.uField=b.uField);b.altLangField&&(a.altLangField=b.altLangField);b.blipFillField&&(a.blipFillField=b.blipFillField);b.csField&&(a.csField=b.csField);a.dirtyField=b.dirtyField;b.eaField&&(a.eaField=b.eaField);a.errField=b.errField;b.gradFillField&&(a.gradFillField=b.gradFillField);b.grpFillField&&(a.grpFillField=b.grpFillField);b.highlightField&&(a.highlightField=b.highlightField);
b.hlinkClickField&&(a.hlinkClickField=b.hlinkClickField);b.hlinkMouseOverField&&(a.hlinkMouseOverField=b.hlinkMouseOverField);b.langField&&(a.langField=b.langField);b.latinField&&(a.latinField=b.latinField);b.noFillField&&(a.noFillField=b.noFillField);b.pattFillField&&(a.pattFillField=b.pattFillField);b.solidFillField&&(a.solidFillField=b.solidFillField);b.symField&&(a.symField=b.symField)},sQ=a=>{switch(a){case 1:return 2;case 2:return 3;case 3:return 6;case 4:return 10;case 5:return 7;case 6:return 13;
default:return 1}};class Lx{constructor(){this.Zpb=Array(Lx.azh);this.Fze=Array(Lx.azh)}}Lx.azh=9;Object(e.a)(Lx,"TextListStyleCache",null,[]);class XK{constructor(){this.restartInfo=this.nextNumber=1;this.listStyle=this.nextListId=0;this.autonumberBulletType=8}}Object(e.a)(XK,"NumberingData",null,[]);class Jv{}Jv.pMd="\u2022";Jv.Ehi="p";Jv.Fhi="n";Object(e.a)(Jv,"ListFormats",null,[]);class YK{constructor(a,b,c,f){this.eTg=this.fTg=Cb.App.Mm;this.QFg=null;this.lc=a;this.Nl=b;this.xL=c;this.Wz=f}get caches(){return this.QFg||
(this.QFg={})}D9f(a,b,c){const f=c-1;let l=a.e_;var x;const G=!!l&&!Ga.a.nil.equals(l[f]);if(G&&(x=this.caches[l[f].toString()]))return x=x.clone(),b=Ga.a.create(),a.Fh.jE(x,b),x;if(!G)if(l)l=Array.clone(l);else for(l=Array(9),x=0;x<l.length;x++)l[x]=Ga.a.nil;const R=G?l[f]:Ga.a.create();x=this.qsi(a,b,c);l[f]=R;this.caches[R.toString()]=x;G||(a.e_=l);a.Fh.jE(x,R);G&&(x=x.clone(),a.Fh.jE(x,Ga.a.create()));return x}qsi(a,b,c){const f=Qg.a.instance.createInstance(131073);if(b){var l=b.s9f(a.rowIndex,
a.ni,a.rowSpan,a.colSpan);b=(b=(b=a.listStyle)?VK(b,c):null)||new Oq;if(l){var x=c-1;c=l.Zpb[x];x=l.Fze[x];if(c||x){l=b.defRPrField||new iq;if(x){const G=Yd.a(Yd.c(x));x=G;b.algnFieldSpecified&&(x.algnFieldSpecified=!0,x.algnField=b.algnField);b.indentFieldSpecified&&(x.indentFieldSpecified=!0,x.indentField=b.indentField);b.lvlFieldSpecified&&(x.lvlFieldSpecified=!0,x.lvlField=b.lvlField);b.marLFieldSpecified&&(x.marLFieldSpecified=!0,x.marLField=b.marLField);b.marRFieldSpecified&&(x.marRFieldSpecified=
!0,x.marRField=b.marRField);b.rtlFieldSpecified&&(x.rtlFieldSpecified=!0,x.rtlField=b.rtlField);b.buAutoNumField&&(x.buAutoNumField=b.buAutoNumField);b.buCharField&&(x.buCharField=b.buCharField);b.buClrField&&(x.buClrField=b.buClrField);b.buClrTxField&&(x.buClrTxField=b.buClrTxField);b.buFontField&&(x.buFontField=b.buFontField);b.buFontTxField&&(x.buFontTxField=b.buFontTxField);b.buNoneField&&(x.buNoneField=b.buNoneField);b.buSzPctField&&(x.buSzPctField=b.buSzPctField);b.buSzPtsField&&(x.buSzPtsField=
b.buSzPtsField);b.buSzTxField&&(x.buSzTxField=b.buSzTxField);b.defRPrField&&(x.defRPrField=b.defRPrField);b.lnSpcField&&(x.lnSpcField=b.lnSpcField);b.spcAftField&&(x.spcAftField=b.spcAftField);b.spcBefField&&(x.spcBefField=b.spcBefField);b=G}c&&(c=Yd.a(Yd.c(c)),WK(c,l),b.defRPrField=c)}}a=Object(ua.a)(119,this.lc.ig(a));this.ysi(f,b,a?a.Pe:null)}f.me(sb.a.P3b,!0);return f}ysi(a,b,c){this.xsi(a,b);if(b){if(b.algnFieldSpecified){var f=sQ(b.algnField);a.setValue(tb.a.xl,f);a.setValue(tb.a.EI,f)}b.marLFieldSpecified&&
a.me(Mb.a.Rl,we.a.Lrb(b.marLField));b.marRFieldSpecified&&a.me(Mb.a.IX,we.a.Lrb(b.marRField));b.indentFieldSpecified&&a.me(Mb.a.Tn,we.a.Lrb(b.indentField));b.defTabSzFieldSpecified&&a.setValue(Mb.a.hrb,we.a.Lrb(b.defTabSzField));b.spcAftField&&(f=Ms.FXb(b.spcAftField.itemField),Object(Ma.a)(Ls,f.lineSpacing)?a.setValue(sb.a.Yja,2):Object(Ma.a)(fr,f.lineSpacing)&&a.setValue(sb.a.Yja,4),a.setValue(sb.a.Sca,f.value));b.spcBefField&&(f=Ms.FXb(b.spcBefField.itemField),Object(Ma.a)(Ls,f.lineSpacing)?a.setValue(sb.a.Zja,
2):Object(Ma.a)(fr,f.lineSpacing)&&a.setValue(sb.a.Zja,4),a.setValue(sb.a.Tca,f.value));b.lnSpcField&&(f=Ms.FXb(b.lnSpcField.itemField),Object(Ma.a)(Ls,f.lineSpacing)?a.setValue(sb.a.yW,2):Object(Ma.a)(fr,f.lineSpacing)&&a.setValue(sb.a.yW,4),a.setValue(sb.a.Zw,f.value))}else Aa.a.J(8959502,820,10,"TextPropertyHelper::ComposeParagraphProperties - ParagraphProperties is null");b.defRPrField&&Ql.rsi(a,b.defRPrField,c)}wVk(a){if(a=a.e_)for(let b=0;b<a.length;b++){const c=a[b];c&&!Ga.a.nil.equals(c)&&
delete this.caches[c.toString()]}}xsi(a,b){var c=this.Pw(b);a.Jx(c.propertySet);b.marLFieldSpecified&&a.setValue(Mb.a.Rl,we.a.Lrb(b.marLField));b.indentFieldSpecified&&a.setValue(Mb.a.Tn,we.a.Lrb(b.indentField));b.defRPrField&&b.defRPrField.szFieldSpecified&&a.setValue(tb.a.fontSize,Ql.USf(b.defRPrField.szField));b.spcAftField&&(c=Ms.FXb(b.spcAftField.itemField),Object(Ma.a)(fr,c.lineSpacing)&&(a.setValue(sb.a.Yja,4),a.setValue(sb.a.Sca,c.value)));b.spcBefField&&(b=Ms.FXb(b.spcBefField.itemField),
Object(Ma.a)(fr,b.lineSpacing)&&(a.setValue(sb.a.Zja,4),a.setValue(sb.a.Tca,b.value)))}Pw(a){let b;({hfe:b,V_j:c}=this.h1d(a));var c=Ae.a.AP(b,c);0===b&&(c.iA=c.wW=a.buAutoNumField.startAtField);return c}h1d(a){let b,c;b=16;c=1;if(a)if(a.buCharField)switch(b=1,a.buCharField.charField){case Jv.Ehi:case Jv.Fhi:c=3}else if(a.buAutoNumField)switch(b=0,a.buAutoNumField.typeField){case 9:case 8:case 6:case 7:c=1;break;case 4:case 0:case 2:c=2;break;case 14:case 10:case 12:c=3;break;case 5:case 1:case 3:c=
4;break;case 15:case 11:case 13:c=5}return{hfe:b,V_j:c}}validate(a){if(Object(ua.a)(lg.a,a)&&(this.Nl.$Da(a)||bj.OutlineReader.qW(a))&&a.isConnected){this.fTg=new Date;var b=Array(Zo.a.Z6);for(var c=0;c<Zo.a.Z6;++c)b[c]=new XK;c=-1;var f=0,l=!1;a=Xe.a.Gz(a);for(a.Sl(Object(C.a)(this,this.yVj,"listOEFilter"),null);a.moveNext();){16===a.iterator.currentNode.type&&(c=-1,f=0,l=!1,this.JSc(b,0),this.l9d(b,0,0));if(11!==a.iterator.currentNode.type)continue;const x=a.iterator,G=this.gca(x);let R=b[G].nextListId,
fa=null;if(Ib.ListReader.kk(x)){this.Wz.Ula(x);fa=this.Wz.a1d(x);const wa=this.D_i(x);x.yc();if(!fa){rb.a.instance.Tb("PossibleIncorrectListNumbering",{["Reason"]:"ListInfoNotFound"});continue}if(0===fa.listType){if(fa.iA!==wf.a.yw&&b[G].restartInfo!==fa.iA||fa.listStyle!==b[G].listStyle||wa!==b[G].autonumberBulletType)l=!0,b[G].restartInfo=b[G].nextNumber=fa.iA===wf.a.yw?1:fa.iA,R=b[G].nextListId=0,b[G].listStyle=fa.listStyle,b[G].autonumberBulletType=wa;fa.wW=b[G].nextNumber;c!==G||l?(fa.pia=b[G].nextNumber,
l=!1):fa.pia=wf.a.yw;this.xL.isEmpty(x,!1)?l=!0:b[G].nextNumber++}else 1!==fa.listType&&rb.a.instance.Tb("PossibleUnexpectedListAlteration",{["Reason"]:"UnknownListType"});R||(R=b[G].nextListId=++f);x.currentNode.listID=R}c=G;fa?(0===fa.listType?this.JSc(b,G+1):this.JSc(b,G),this.l9d(b,G+1,R)):(this.JSc(b,G),this.l9d(b,G,0))}this.eTg=new Date;Aa.a.J(22344988,820,50,"ListCore::Validate {0}",+this.eTg-+this.fTg)}}gca(a){this.xL.Ug(a)||rb.a.instance.Tb("PossibleListLevelIncorrect",{["Reason"]:Od.a.Jba});
return a.currentNode.sa(Mb.a.listLevel,og.a.pDa)}A8i(a){this.xL.Ug(a)||rb.a.instance.Tb("PossibleLossOfAccessibilityInfoForList",{["Reason"]:Od.a.Jba});return a.currentNode.listID}yVj(a){return this.xL.Ug(a)||Jd.TableReader.Vp(a)||gk.l(a)||Se.isTableCell(a)}JSc(a,b){for(;b<Zo.a.Z6;++b)a[b].nextNumber=a[b].restartInfo=1}l9d(a,b,c){for(;b<Zo.a.Z6;++b)a[b].nextListId=c}D_i(a){return a.currentNode.sa(sb.a.autonumberBulletType,8)}}Object(e.a)(YK,"ListCore",null,[290]);class Up{constructor(a,b,c=null){this.Tf=
a;this.Ai=b;this.wt=null;this.Tlb=c}get jbl(){return!1}dKk(a){return a}rHb(a){let b,c,f;b=Ib.ListReader.Y5a;c=a.propertySet.sa(Mb.a.listID,0);f=a.propertySet.sa(Mb.a.listLevel,-1);if(H.a.instance.ga(85)||b&&0<c&&0<=f)this.wt=a;else{let l=1;const x=a.listStyle;b&&42!==x&&0<x&&(l=x);this.wt=Ae.a.AP(a.listType,l,null,c,f,void 0,"")}}e6k(a){a&&(this.wt=a)}KUd(){}createList(a){const b=rb.a.instance.Kp(E.a.createList);ae.OutlineElementReader.Ug(a)||rb.a.instance.Tb("PossiblyIncorrectListCreation",{["Reason"]:Od.a.Jba});
Ib.ListReader.kk(a)&&rb.a.instance.Tb("PossiblyIncorrectListCreation",{["Reason"]:Od.a.qvi});const c=this.zAi();a.pl(c,4);a.Gk(c);b.end();return c}zAi(){return ps.a.instance.createInstance(393234)}Pma(a){const b=rb.a.instance.Kp(E.a.Pma);ae.OutlineElementReader.Ug(a)||rb.a.instance.Tb("PossiblyIncorrectListRemoval",{["Reason"]:Od.a.Jba});Ib.ListReader.kk(a)&&this.oQk(a);b.end()}oQk(a){this.Tf.Ula(a);a.Ii()}Hob(a,b,c,f=!1){const l=rb.a.instance.Kp(E.a.nai);if(!this.uNf(b,c))return{returnValue:!1,u8a:c};
this.ioh(a,c,f);f=a.Sa(Oc.a.vWg);var x=a.sa(Oc.a.Vtg,!1);let G=!1;1===c.f_&&c.wce&&!c.aT&&(G=!0);const R=c.propertySet.sa(Mb.a.b7b,null);R&&R===Box4Intl.Box4Strings.L_ListStyleNone&&(1===c.listType?G=c.wce&&!c.aT:0===c.listType&&(G=0===c.listStyle));x?G&&(c.$Ia(16,0),a.setValue(Oc.a.LD,16),a.setValue(Oc.a.Vca,0)):(x=this.Tf.Pw(b),this.Crh(c,x,f,G,a)&&(l.properties.$("ToggledOff","true"),c.$Ia(16,0),this.p5k(a)),0===c.listType&&a.Sa(Oc.a.sTa)&&(c.iA=a.getValue(Oc.a.sTa),a.removeProperty(Oc.a.sTa)));
if(f&&(l.properties.$("MultipleOESelection","true"),({u8a:c}=this.trh(b,c)).returnValue))return l.end(),{returnValue:!1,u8a:c};this.V8h(b,c,a);a.setValue(Oc.a.Vtg,!0);l.end();return{returnValue:!0,u8a:c}}Crh(a,b,c,f){if(f)return!0;if(b){f=a.listType===b.listType;const l=0===a.listStyle&&a.iA===wf.a.yw;a=a.listStyle===b.listStyle&&a.iA===b.iA;this.Tf.b$a&&(a=a&&!c);return f&&(l||a)}return!1}p5k(a){a.setValue(Oc.a.LD,16);a.setValue(Oc.a.Vca,0)}ioh(){}uNf(){return!0}trh(a,b){return{returnValue:16!==
b.listType&&ae.OutlineElementReader.isEmpty(a,!0),u8a:b}}jqb(a){const b=rb.a.instance.Kp(E.a.jqb);yb.ParagraphReader.Vd(a)||rb.a.instance.Tb("ClearingListFromNonParagraph",{["Reason"]:Od.a.sUd});const c=new nb.GraphIterator;c.set(a);c.af();c.lB(12);Xb.OutlineElementNavigator.Ke(c);this.H3a(c,null);b.end()}bKd(){}merge(a,b,c){const f=rb.a.instance.Kp(E.a.xVj);ae.OutlineElementReader.Ug(b)||rb.a.instance.Tb("PossibleIncorrectMergeOfOEs",{["Reason"]:"SrcIsNotOE"});ae.OutlineElementReader.Ug(a)||rb.a.instance.Tb("PossibleIncorrectMergeOfOEs",
{["Reason"]:"DestIsNotOE"});if(Ib.ListReader.kk(b)){f.properties.$("UseSourceListWithNonlistDestination",c.toString());let l;l=Ib.ListReader.Y5a;c&&this.jbl&&Ib.ListReader.kk(a)&&this.Pma(a);if(!Ib.ListReader.kk(a)||c&&l)c&&(u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),c=this.$0d(b),this.Tf.qwh&&c.propertySet.me(tb.a.uTa,wf.a.yw),1===c.f_&&c.cPf(),this.H3a(a,c),f.properties.$("MoveListInfoFromSrcToDestOE","true")),u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");
Up.eL.iVc&&this.Ili(b,a);this.Pma(b);f.properties.$("RemoveListFromSrcOE","true")}f.end();return!0}Ili(a,b){a=yb.ParagraphReader.ptb(a.currentNode);b=this.Tf.Gcg(b);this.Hhd(b,a,null)}$0d(a){return this.Tf.Pw(a)}Hhd(a,b,c){if(a){b=Mc.a.create(b);b=vb.a.Ls(b);this.BYa(a,tb.a.fontColor,c,b);this.BYa(a,tb.a.fontSize,c,b);if(this.Tlb){let f,l;({value:f}=this.getPropertyValue(tb.a.font,c,b,"")).returnValue&&this.Tlb.ZX(a,f);({value:l}=this.getPropertyValue(Mb.a.FU,c,b,-1)).returnValue&&this.Tlb.hJa(a,
l)}else this.BYa(a,tb.a.font,c,b),this.BYa(a,Mb.a.FU,c,b);u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");Up.eL.iVc&&(this.BYa(a,tb.a.bold,c,b),this.BYa(a,tb.a.italic,c,b),this.BYa(a,tb.a.superscript,c,b),this.BYa(a,tb.a.subscript,c,b))}}Xnh(){}BYa(a,b,c,f){c&&c.Sa(b)?a.setValue(b,c.getValue(b)):f&&f.cache&&(c=f.cache,c.Sa(b)&&a.setValue(b,c.getValue(b)))}getPropertyValue(a,b,c,f){if(b&&b.Sa(a))return f=b.getValue(a),{returnValue:!0,
value:f};if(!c||!c.cache)return{returnValue:!1,value:f};b=c.cache;return b.Sa(a)?(f=b.getValue(a),{returnValue:!0,value:f}):{returnValue:!1,value:f}}b2f(a,b){b.Sa(Oc.a.LD)||(a===E.a.KO?b.setValue(Oc.a.LD,1):a===E.a.lR&&b.setValue(Oc.a.LD,0));b.Sa(Oc.a.Vca)||b.setValue(Oc.a.Vca,0);return b}YNa(a,b,c,f,l,x,G){a=rb.a.instance.Kp(E.a.YNa);const R=this.Tf.Pw(b);c=Ae.a.AP(0,c);c.iA=f;c.qqa=x;R&&c.Y5d(R)&&c.iA===R.wW||(f=new Id.GraphTransaction(15),f.iy(b),b=this.U$i(c),null!=b&&G.numbering(b)&&(Z.ULS.sendTraceTag(509747284,
393,50,"Found list insert matching string "+x),Up.characterPropertiesEditor.replaceTextRange(l,"")),f.dispose());a.end()}U$i(a){var b;let c=null===(b=null===qv||void 0===qv?void 0:qv[a.listType])||void 0===b?void 0:b[a.qqa];if(null==c)return null;b=new D.DictionaryPropertySet;b.setValue(Oc.a.LD,a.listType);b.setValue(Oc.a.Vca,a.listStyle);b.setValue(Oc.a.sTa,a.iA);b.setValue(tb.a.Ni,c.Ni);this.K2k(b,c.autonumberBulletType);return b}static get characterPropertiesEditor(){return Up.Yg||(Up.Yg=fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get eL(){return Up.ZJ||
(Up.ZJ=fb.a.instance.qb("Box4.List.ListSettings"))}}Up.Yg=null;Up.ZJ=null;Object(e.a)(Up,"ListEditor",null,[289]);class Rn{}Rn.Lte=80640;Rn.Mte=0;Rn.M7d=80640;Rn.N7d=-80640;Object(e.a)(Rn,"ParagraphConstants",null,[]);var Vl=d(183);class ZK extends Up{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc){super(a,b);this.DYc=[tb.a.Ni,tb.a.font];this.a2c=[tb.a.Ni,tb.a.font,tb.a.fontColor,sb.a.autonumberBulletType,sb.a.vsb];this.Fbb=c;this.aac=f;this.Zme=l.Ixg;this.xL=x;this.Nl=G;this.ZG=fa;this.bA=wa;this.nj=
Wa;this.fVa=mb;this.tLg=l.mbe;this.$0c=l.Kxg;this.oL=Kb;this.Nb=nc;this.Ea=oc;this.kua=l.pptCopyPasteListMarkerEnabled;this.B$b=l.pptCopyPasteMarginAndIndentationEnabled;this.ALg=l.pptCopyPasteTextWithSpacingFromExternal}rHb(a){super.rHb(a);this.$0c&&this.fGc(a.propertySet,this.wt.propertySet)}XKe(a){if(this.Zme&&this.wt&&this.wt.propertySet){const b=this.wt.propertySet.sa(Mb.a.listLevel,-1);-1!==b&&this.YKe(a,b)}this.kua&&this.wt&&(this.wt.Dsb=!0);this.ALg&&this.Knh(a);this.cKd(a,this.wt);this.wt=
null}wnh(a,b,c){b=this.Ai.d4b(a);this.Ai.LIb(a,b,c,!1,!0)}uNf(a,b){if(!a||!b)return!1;if(a.Ab(4)){var c=this.Tf.a1d(a);this.Fbb.Ke(a);if(c&&c.listType===b.listType&&(1===b.listType||0===b.listType))return!0}c=a.Ab(2);const f=c.sa(Mb.a.Tn,og.a.indent),l=c.sa(Mb.a.Rl,og.a.leftMargin);this.Fbb.Ke(a);a=f;let x=l;({indent:a,margin:x}=this.UMd(Ql.wKf(yb.ParagraphReader.xia(c,tb.a.fontSize,0)),b.listType,f,l,a,x));return!!(this.YKj(x)&this.TJj(a))}Tbg(a,b,c,f){if(!a)return Aa.a.J(512496326,820,15,"ListEditor::GetIndentationFromListStyle - paragraphNode is null"),
{Yde:c,L7d:f};b&&(c=b.sa(sb.a.vYb,og.a.leftMargin),f=b.sa(sb.a.SSd,og.a.indent),(a=this.Ea.tn(a))&&a.qd&&(c=b.sa(Mb.a.Rl,og.a.leftMargin),f=b.sa(Mb.a.Tn,og.a.indent)));return{Yde:c,L7d:f}}NMf(a,b,c,f){if(!a||!this.xL.Ug(b))return Aa.a.J(512496325,820,15,"ListEditor::CalculateDefaultMarginAndIndent - paragraphNode is null or iterator is not outline element "),{xXd:c,wXd:f};var l=this.PP(b,this.ZG.gca(b));if(l){const x=a.sa(Mb.a.Rl,og.a.leftMargin),G=a.sa(Mb.a.Tn,og.a.indent);c=x;f=G;let R=og.a.leftMargin,
fa=og.a.indent;({Yde:R,L7d:fa}=this.Tbg(a,l,R,fa));l=Ae.a.pBa(l,null).listType;const wa=x+(0<=G?0:G),Wa=R+(0<=fa?0:fa),mb=b.Ab(4);let Kb=16;mb&&(Kb=this.aac.Btb(mb),b.yc());fa&&wa===Wa&&l===Kb?(c=R,f=fa):({indent:f,margin:c}=this.UMd(this.Z6a(a),Kb,G,x,f,c),c=Math.max(Math.min(c,Rn.Lte),Rn.Mte),f=Math.max(Math.min(f,Rn.M7d),Rn.N7d))}return{xXd:c,wXd:f}}C3i(a,b){if(!a||!this.xL.Ug(b))return Aa.a.J(512496324,820,15,"ListEditor::GetDefaultMargin - paragraphNode is null or iterator is not outline element "),
og.a.leftMargin;let c=og.a.leftMargin,f=og.a.indent;({xXd:c,wXd:f}=this.NMf(a,b,c,f));0<c&&Aa.a.J(512496323,820,50,"Get defaultMargin from liststyle");return c}y3i(a,b){if(!a||!this.xL.Ug(b))return Aa.a.J(512496322,820,15,"ListEditor::GetDefaultIndent - paragraphNode is null or iterator is not outline element "),og.a.indent;let c=og.a.leftMargin,f=og.a.indent;({xXd:c,wXd:f}=this.NMf(a,b,c,f));0<f&&Aa.a.J(512496321,820,50,"Get defaultIndent from liststyle");return f}trh(a,b){return{returnValue:!1,
u8a:b}}Crh(a,b,c,f,l){return f?!0:!b||l&&l.Sa(tb.a.Ni)?!1:a.listType===b.listType}YKj(a){return a<Rn.Lte&&a>=Rn.Mte}TJj(a){return a<Rn.M7d&&a>=Rn.N7d}Wid(){return u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertBulletViaKeyboardEnabled",!1)}K2k(a,b){a.setValue(sb.a.autonumberBulletType,b)}kcl(a){return a}KUd(a,b){a.Sa(Mb.a.listLevel)&&b.me(Mb.a.listLevel,a.Xh(Mb.a.listLevel))}N8i(a,b){return Object(Ma.a)(Vl.TableCellNode,a)?this.ZG.D9f(a,this.bA.pPc(a),b):
this.F$i(a,b)}F$i(a,b){--b;const c=a.sa(Mb.a.e_,[]);return 0>b||b>=c.length?(Aa.a.J(512496320,820,10,"ListEditor::DictionaryPropertySet - Level is out of bounds {0}",b),rb.a.instance.Tb("PossibleLossOfListStyle",{["Reason"]:"ListLevelOutOfBounds"}),null):a.Fh.te(c[b])}Hhd(){}YKe(a,b){if(this.xL.Ug(a)&&0<=b&&b<Zo.a.Z6){const c=a.currentNode,f=a.Ab(2);c&&c.setValue(Mb.a.listLevel,b);f&&(f.setValue(Mb.a.listLevel,b),a.yc())}}G5k(a,b){if(this.xL.Ug(a)&&b&&b.propertySet){var c=a.Ab(4);c&&(b.yub&&b.t8&&
(this.$0c?(this.fGc(b.propertySet,c),this.kua&&b.propertySet.Sa(sb.a.autonumberBulletType)&&c.setValue(sb.a.autonumberBulletType,b.propertySet.getValue(sb.a.autonumberBulletType))):c.setValue(tb.a.Ni,b.t8)),a.yc())}}Xnh(a){if(this.xL.Ug(a)){if(this.Zme&&this.wt&&this.wt.propertySet){const b=this.wt.propertySet.sa(Mb.a.listLevel,-1);-1!==b&&this.YKe(a,b);this.G5k(a,this.wt)}this.B$b&&this.g5k(a);this.kua&&(this.wt&&this.wt.propertySet?this.VIj(this.wt)||(Aa.a.J(512496285,820,50,"Copied from external, such as website."),
this.ZKe(a)):(Aa.a.J(512496286,820,50,"Copied from external, such as win32 ppt."),this.ZKe(a)));this.ALg&&this.Knh(a);this.wt=null}else Aa.a.J(512496288,820,10,"ListEditorCssVersion::SetProperPendingListInfoAfterPaste - input GraphIterator is not outline element ")}Knh(a){const b=this.ZG.gca(a),c=this.PP(a,b),f=a.Ab(2);c&&f&&0<=b&&b<Zo.a.Z6&&(this.wt&&this.wt.propertySet&&this.wt.propertySet.Sa(sb.a.Zw)||(Aa.a.J(512496284,820,50,"Get master defined line-spacing "),f.setValue(sb.a.Zw,c.sa(sb.a.NFi,
og.a.lineSpacing)),f.setValue(sb.a.yW,c.sa(sb.a.OFi,2))),this.wt&&this.wt.propertySet&&this.wt.propertySet.Sa(sb.a.Tca)||(Aa.a.J(512496283,820,50,"Get master defined line-spacing before"),f.setValue(sb.a.Tca,c.sa(sb.a.bGi,og.a.hCg)),f.setValue(sb.a.Zja,c.sa(sb.a.cGi,4))),this.wt&&this.wt.propertySet&&this.wt.propertySet.Sa(sb.a.Sca)||(Aa.a.J(512496282,820,50,"Get master defined line-spacing after"),f.setValue(sb.a.Sca,c.sa(sb.a.$Fi,og.a.gCg)),f.setValue(sb.a.Yja,c.sa(sb.a.aGi,4))));a.yc()}VIj(a){if(a.propertySet.Sa(tb.a.Ni)){const b=
a.propertySet.getValue(tb.a.Ni).length;if(1===b&&a.propertySet.Sa(tb.a.font)||3===b&&a.propertySet.Sa(sb.a.autonumberBulletType))return!0}return!1}g5k(a){var b=this.ZG.gca(a);const c=this.PP(a,b),f=a.Ab(2);c&&f&&0<=b&&b<Zo.a.Z6&&(this.wt&&this.wt.propertySet&&this.wt.propertySet.Sa(Mb.a.Rl)||(Aa.a.J(512496281,820,50,"Get master defined indent-left."),c.Sa(sb.a.vYb)&&f.setValue(Mb.a.Rl,c.getValue(sb.a.vYb)),(b=this.Ea.tn(f))&&b.qd&&f.setValue(Mb.a.Rl,c.sa(Mb.a.Rl,og.a.leftMargin))),this.wt&&this.wt.propertySet&&
this.wt.propertySet.Sa(Mb.a.Tn)||(Aa.a.J(512496280,820,50,"Get master defined firstline indent."),c.Sa(sb.a.SSd)&&f.setValue(Mb.a.Tn,c.getValue(sb.a.SSd)),(b=this.Ea.tn(f))&&b.qd&&f.setValue(Mb.a.Tn,c.sa(Mb.a.Tn,og.a.leftMargin))));a.yc()}ZKe(a){const b=this.ZG.gca(a),c=this.PP(a,b),f=a.Ab(4);c&&f&&0<=b&&b<Zo.a.Z6&&(Aa.a.J(512496279,820,50,"Get master defined list marker"),c.Sa(tb.a.Ni)?(f.setValue(tb.a.Ni,c.getValue(tb.a.Ni)),c.Sa(tb.a.font)?f.setValue(tb.a.font,c.getValue(tb.a.font)):c.Sa(sb.a.autonumberBulletType)&&
f.setValue(sb.a.autonumberBulletType,c.getValue(sb.a.autonumberBulletType))):(f.setValue(tb.a.font,yj.vLf),f.setValue(tb.a.Ni,[yj.pMd])));a.yc()}tUc(a){return a?16!==this.ZG.h1d(a).hfe:!1}jqb(){Aa.a.J(512496278,820,10,"ListEditor::ClearListFromParagraph - Ppt doesn't implement ClearFormatting command");rb.a.instance.Tb("FormattingNotCleared",{["Reason"]:Od.a.Asg})}rPk(a){if(this.xL.Ug(a)){var b=a.Ab(4);b&&(1===this.aac.Btb(b)&&b.removeProperty(sb.a.autonumberBulletType),a.yc())}}c6k(a){this.xL.Ug(a)&&
(a=a.currentNode)&&a.setValue(sb.a.hMj,!0)}merge(a,b,c,f){const l=this.ZG.gca(b),x=this.PP(a,this.ZG.gca(a)),G=this.PP(b,l);x&&a&&(a.Ab(2),a.currentNode&&(a.currentNode.Sa(Mb.a.Rl)&&x.Sa(Mb.a.Rl)&&!OA.APropertySet.nXa(Mb.a.Rl.type,a.currentNode.Xh(Mb.a.Rl),x.Xh(Mb.a.Rl))&&x.me(Mb.a.Rl,a.currentNode.Xh(Mb.a.Rl)),a.currentNode.Sa(Mb.a.Tn)&&x.Sa(Mb.a.Tn)&&!OA.APropertySet.nXa(Mb.a.Tn.type,a.currentNode.Xh(Mb.a.Tn),x.Xh(Mb.a.Tn))&&x.me(Mb.a.Tn,a.currentNode.Xh(Mb.a.Tn))),a.yc());super.merge(a,b,c);c&&
this.Zme&&(this.YKe(a,l),this.c6k(a),this.rPk(a));this.g9h(b,G,x);if(f&&(a.Ab(2),c=a.currentNode.sa(sb.a.jIa,""),a.yc(),c.length))for(a=this.Nb.w0d(b);a.vf(1)&&a.currentNode!==f.currentNode;)a.Ab(2),a.currentNode.setValue(sb.a.jIa,c),a.yc();return!0}V8h(a,b,c){const f=Nc.a.Eb;f&&(f.Oj=!0);this.cKd(a,b,c)}$pl(a,b){var c=nb.GraphIterator.mb(b);this.Tf.Ula(c);b=c.currentNode;c.yc();c=this.createList(a);a.yc();c.R4a(b,sb.a.shapeId,sb.a.dwa)}H3a(a,b){this.cKd(a,b)}bGf(a,b,c){this.xL.Ug(a)||rb.a.instance.Tb("PossibleIndentNotAdjusted",
{["Reason"]:Od.a.Jba});const f=a.Ab(2),l=f.sa(Mb.a.Tn,og.a.indent),x=f.sa(Mb.a.Rl,og.a.leftMargin);this.Fbb.Ke(a);if(16===b)this.fVa.hv.Jgb(f,0),0>l&&(rb.a.instance.Tb("UnexpectedlyChangingLeftIdent",{["Reason"]:"NegativeLeftIndent"}),this.Ai.Kgb(a,1,Math.max(x+l,0)));else{var G=this.PP(a,this.ZG.gca(a));G||(G=new D.DictionaryPropertySet,Aa.a.J(512496273,820,50,"listStyle is null"));var R=og.a.indent;let fa=og.a.leftMargin;c?{Yde:fa,L7d:R}=this.Tbg(f,G,fa,R):(R=G.sa(Mb.a.Tn,og.a.indent),fa=G.sa(Mb.a.Rl,
og.a.leftMargin));G=Ae.a.pBa(G,null).listType;const wa=fa+(0<=R?0:R);R&&x+(0<=l?0:l)===wa&&G===b?(this.fVa.hv.Jgb(f,R),this.Ai.Kgb(a,1,fa)):(R=l,G=x,{indent:R,margin:G}=this.UMd(this.Z6a(f),b,l,x,R,G),0<this.ZG.gca(a)&&c&&(G+=fa),G=Math.max(Math.min(G,Rn.Lte),Rn.Mte),R=Math.max(Math.min(R,Rn.M7d),Rn.N7d),this.fVa.hv.Jgb(f,R),this.Ai.Kgb(a,1,G))}}Z6a(a){if(!a)return 0;a=this.Nl.xja(a)?this.Nl.Hhj(this.Nl.Ltb(a)):yb.ParagraphReader.xia(a,tb.a.fontSize,0);return Ql.wKf(a)}UMd(a,b,c,f,l,x){let G=(b=1===
b)?.3125:.375;0<a&&(G=12>=a?b?.1875:.25:12<a&&18>=a?b?.3125:.375:18<a&&25>=a?b?.375:.5:25<a&&35>=a?b?.5:.5625:35<a&&44>=a?b?.625:.8125:44<a&&56>=a?b?.75:1:56<a&&72>=a?b?.9375:1.25:b?1.25:1.5);a=-1*we.a.Csa(G);0>=c&&a<c?(x=a-c,l=c+x,x=f-x):0<c&&(l=a,x=f-a);return{indent:l,margin:x}}g9h(a,b,c){if(b&&c){Xb.OutlineElementNavigator.ri(a);var f=a.pq;if(yb.ParagraphReader.Rk(a)){b=b.sa(tb.a.fontSize,Cr.fontSize);c=c.sa(tb.a.fontSize,Cr.fontSize);for(let l=0;l<f.Ra.length;++l){const x=f.Ra.ga(l);x&&x.formatting&&
x.formatting.Iz&&x.formatting.Iz.Sa(tb.a.fontSize)&&x.formatting.Iz.getValue(tb.a.fontSize)===b&&this.nj.Jr(x.formatting,c)}}Xb.OutlineElementNavigator.Ke(a)}}$0d(a){if(this.kua){if(a=this.Tf.Pw(a))a.Dsb=!0;return a}return super.$0d(a)}cKd(a,b,c=null){if(this.xL.Ug(a)){this.m9h(b,c,a);var f=a.Ab(4);if(!f||b&&16!==b.listType)if(b&&0!==b.listStyle){f?Ae.a.pBa(f,f).nWb():f=this.createList(a);a.yc();const l=a.Ab(2);a.yc();this.tLg&&l.sa(Oc.a.C5b,!1)||this.kua&&b.Dsb?f.R4a(b.propertySet,sb.a.shapeId,sb.a.dwa,
Mb.a.listLevel,tb.a.Ni,Oc.a.LD):f.R4a(b.propertySet,sb.a.shapeId,sb.a.dwa,Mb.a.listLevel,sb.a.ZDa);c&&c.Sa(sb.a.autonumberBulletType)&&f.setValue(sb.a.autonumberBulletType,c.getValue(sb.a.autonumberBulletType));this.kua&&b.Dsb&&b.yub&&(3===b.t8.length&&b.propertySet.Sa(sb.a.autonumberBulletType)?(f.setValue(tb.a.Ni,b.t8),c=b.propertySet.getValue(sb.a.autonumberBulletType),f.setValue(sb.a.autonumberBulletType,c),Aa.a.J(512496267,826,50,"Support CCP customized number list")):1===b.t8.length&&b.$7a?
(f.setValue(tb.a.Ni,b.t8),f.setValue(tb.a.font,b.font),Aa.a.J(512496266,826,50,"Support CCP customized bullet")):(Aa.a.J(512496265,826,50,"Set list use dst master liststyle."),this.ZKe(a)))}else return;else a.Ii();b&&b.A7f||(this.tLg?(f=this.Tf.Pw(a),this.bGf(a,f?f.listType:16,b?b.Dsb:!1)):this.bGf(a,b?b.listType:16,b?b.Dsb:!1))}else Aa.a.J(512496269,820,10,"ListEditor::ApplyListInfoInternal - iterator is not outline element "),rb.a.instance.Tb("FailedToApplyListProperties",{["Reason"]:Od.a.Jba})}m9h(a,
b,c){b&&a&&(1===a.listType||0===a.listType)&&(this.oL.Jx(b,a.propertySet,this.DYc),c=this.PP(c,this.ZG.gca(c))||new D.DictionaryPropertySet,1===a.listType&&(a.propertySet.setValue(Oc.a.Vca,6),b.Sa(tb.a.Ni)||(a.propertySet.setValue(tb.a.font,yj.vLf),a.propertySet.setValue(tb.a.Ni,[yj.pMd]),c.Sa(tb.a.Ni)&&(b=c.getValue(tb.a.Ni)[0],b!==yj.wSd&&b!==yj.qHa&&this.oL.Jx(c,a.propertySet,this.DYc)))))}PP(a,b){this.xL.Ug(a)||rb.a.instance.Tb("PossibleLossOfListStyle",{["Reason"]:Od.a.Jba});a=this.Fhj(a);return a?
this.N8i(a,1+b):(Aa.a.J(512496263,820,10,"ListEditor::DictionaryPropertySet - Outline is null"),rb.a.instance.Tb("PossibleLossOfListStyle",{["Reason"]:Od.a.gSf}),null)}Fhj(a){a=nb.GraphIterator.wG(a);a.I5(bj.OutlineReader.z5b);const b=a.Dw(16);return b?b:a.h_a()}Btb(a){return this.ZG.h1d(a).hfe}ioh(a,b,c){c||0!==b.listType||(b.iA=a.sa(tb.a.uTa,wf.a.yw))}fGc(a,b){this.oL.gxi(a,b,this.a2c)}}Object(e.a)(ZK,"ListEditor",Up,[288,289]);class Ns{constructor(a,b){this.rVb=a;this.spb=b}}Object(e.a)(Ns,"BulletMarker",
null,[]);class Os{constructor(a,b){this.yLf=a;this.VXg=b}}Object(e.a)(Os,"ListMarkerPreview",null,[]);class Ps{constructor(a,b,c){this.LXg=a;this.RXg=b;this.uLd=c}}Object(e.a)(Ps,"NumberingMarker",null,[]);class $K{constructor(a,b){this.Nb=a;this.PBb=b;this.H6j=new Sa.a(Object(C.a)(this,this.uAi,"createListBulletDictionary"));this.M6j=new Sa.a(Object(C.a)(this,this.AAi,"createListNumberingDictionary"));this.L6j=new Sa.a(Object(C.a)(this,this.yAi,"createListMarkerPreviewDictionary"));this.J6j=new Sa.a(Object(C.a)(this,
this.xAi,"createListMarkerAltTextDictionary"))}uAi(){const a=new ef.a;a.$(3,new Ns(8226,"Arial"));a.$(4,new Ns(111,"Courier New"));a.$(5,new Ns(167,"Wingdings"));a.$(6,new Ns(113,"Wingdings"));a.$(7,new Ns(118,"Wingdings"));a.$(8,new Ns(216,"Wingdings"));a.$(9,new Ns(252,"Wingdings"));return a}AAi(){const a=new ef.a;a.$(11,new Ps(0,".",8));a.$(12,new Ps(0,")",7));a.$(13,new Ps(1,".",15));a.$(14,new Ps(3,".",5));a.$(15,new Ps(4,")",2));a.$(16,new Ps(4,".",4));a.$(17,new Ps(2,".",14));return a}yAi(){const a=
new ef.a;a.$(1,new Os("\u2022",["1.","2.","3."]));a.$(2,new Os("o",["1)","2)","3)"]));a.$(3,new Os("\uf0a7",["I.","II.","III."]));a.$(4,new Os("\uf071",["A.","B.","C."]));a.$(5,new Os("\uf076",["a)","b)","c)"]));a.$(6,new Os("\uf0d8",["a.","b.","c."]));a.$(7,new Os("\uf0fc",["i.","ii.","iii."]));return a}xAi(){const a=new ef.a;a.$(3,ResourceStrings.l_ListMarkerAltText_Bullet_1);a.$(4,ResourceStrings.l_ListMarkerAltText_Bullet_2);a.$(5,ResourceStrings.l_ListMarkerAltText_Bullet_3);a.$(6,ResourceStrings.l_ListMarkerAltText_Bullet_4);
a.$(7,ResourceStrings.l_ListMarkerAltText_Bullet_5);a.$(8,ResourceStrings.l_ListMarkerAltText_Bullet_6);a.$(9,ResourceStrings.l_ListMarkerAltText_Bullet_7);a.$(11,ResourceStrings.l_ListMarkerAltText_Numbered_1);a.$(12,ResourceStrings.l_ListMarkerAltText_Numbered_2);a.$(13,ResourceStrings.l_ListMarkerAltText_Numbered_3);a.$(14,ResourceStrings.l_ListMarkerAltText_Numbered_4);a.$(15,ResourceStrings.l_ListMarkerAltText_Numbered_5);a.$(16,ResourceStrings.l_ListMarkerAltText_Numbered_6);a.$(17,ResourceStrings.l_ListMarkerAltText_Numbered_7);
return a}get qTa(){return this.H6j.value}get l8c(){return this.M6j.value}get mXc(){return this.L6j.value}get pCg(){return this.J6j.value}zIf(a,b){const c=this.Nb.Kc(a);c.set(a);for(a=c.Ab(1);a;){var f=c.Ab(4);if(f){if(1===b){if(1!==f.sa(Oc.a.LD,16))return!1}else if(2===b){if(0!==f.sa(Oc.a.LD,16))return!1}else if(a=f.sa(tb.a.Ni,null),this.PBb.YSc(b)){f=f.sa(tb.a.font,"");const l=this.qTa.ga(b);if(!a||1!==a.length||l.rVb!==a[0]||l.spb!==f)return!1}else if(this.PBb.ZSc(b)){if(f=this.l8c.ga(b),!a||3!==
a.length||f.LXg!==a[1]||f.RXg!==Ka.a.fromCharCode(a[2]))return!1}else return!1;c.yc()}else if(0!==b)return!1;a=c.vf(1)}return!0}YSc(a){return this.PBb.YSc(a)}ZSc(a){return this.PBb.ZSc(a)}X1b(a){return this.PBb.X1b(a)}tPc(a){return this.PBb.tPc(a)}}Object(e.a)($K,"PptListMarkersLoader",null,[292,291]);class aL{Rzl(a,b){if(!a)return!1;b.Ab(2);a=b.currentNode.sa(Oc.a.C5b,!1);b.yc();return!a}}Object(e.a)(aL,"PptMergeListEditorInOutlineElementStrategy",null,[293]);class Oz{constructor(){this.Dhi=[0,3,
4,5,6,7,8,9];this.Fik=[0,11,12,13,14,15,16,17]}YSc(a){return 3<=a&&9>=a}ZSc(a){return 11<=a&&17>=a}X1b(a){return Oz.Zgg(a,this.Dhi,1)}tPc(a){return Oz.Zgg(a,this.Fik,2)}static Zgg(a,b,c){return 0<=a&&a<b.length?b[a]:c}}Object(e.a)(Oz,"TextBulletTypeHelper",null,[291]);class ID{get name(){return"PowerPointWebEditor.ListEditor"}Wb(a){a.register(288,"PowerPointWebEditor.IPptListEditor").ma().na(()=>new ZK(a.resolve("Box4.List.IListReader"),a.resolve("Box4.IOutlineElementEditor"),a.resolve("Box4.IOutlineElementNavigator"),
a.resolve("PowerPointWebEditor.IListInfoHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("PowerPointWebEditor.ListReader"),a.resolve("PowerPointWebEditor.IPptListCore"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IGraphUtils"),a.resolve("Box4.Graph.IGraphIteratorFactory"),
a.resolve("PowerPointWebEditor.IShapeReader")));a.register(289,"Box4.List.IListEditor").ma().na(()=>a.resolve("PowerPointWebEditor.IPptListEditor"));a.register(290,"PowerPointWebEditor.IPptListCore").ma().na(()=>new YK(a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.Graph.INotesReader"),a.resolve("Box4.IOutlineElementReader"),a.resolve("PowerPointWebEditor.ListReader")));a.register(291,"PowerPointWebEditor.ITextBulletTypeHelper").ma().na(()=>new Oz);a.register(292,"PowerPointWebEditor.IPptListMarkersLoader").ma().na(()=>
new $K(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("PowerPointWebEditor.ITextBulletTypeHelper")));a.register(293,"Box4.IMergeListEditorInOutlineElementStrategy").ma().na(()=>new aL)}init(){}dispose(){}static main(){m.a.instance.Bc(new ID)}}Object(e.a)(ID,"PPTWebEditorListEditorPackage",null,[2,3]);var tQ=d(866);class bL{jk(a){return Jd.TableReader.jk(a)}wi(a){return Jd.TableReader.wi(a)}MOc(a,b,c){return Jd.TableReader.MOc(a,b,c)}vu(a){return Jd.TableReader.vu(a)}G9a(a){return Jd.TableReader.G9a(a)}hs(a){return Jd.TableReader.hs(a)}fN(a){return Jd.TableReader.fN(a)}}
Object(e.a)(bL,"TableReaderProxy",null,[1049]);class cL{Jwg(){return gk.j(void 0)}mdj(a){return gk.c(a)}}Object(e.a)(cL,"TableRowReaderProxy",null,[1048]);class dL extends tl.a{constructor(a,b,c,f,l){super(a,b);this.mRh=l;this.jK=f;a=l&&this.$a.sa(Mb.a.skippedCell,!1);b=this.Gd.Wo(la.a.td);this.kc(b);a?this.htmlElement.className="SkippedGhostCell":(this.htmlElement.className=this.jK.dr?"GhostWithBorder":"Ghost",this.htmlElement.title=Box4Intl.Box4Strings.l_GhostCellTooltip);this.htmlElement.innerText=
"\u00a0";this.jZf()}eU(){return ul.a.dec}oy(){this.mRh&&this.$a.sa(Mb.a.skippedCell,!1)&&this.v7k()}v7k(){this.jK.dr&&(this.htmlElement.style.borderTop="",this.htmlElement.style.borderLeft="",this.htmlElement.style.borderBottom="",this.htmlElement.style.borderRight="")}}Object(e.a)(dL,"GhostTableCellViewElement",tl.a,[1073,418,345,106]);class eL{constructor(a,b,c){this.$Ed=a;this.jK=b;this.Gkb=c}create(a,b){return Se.isGhostCellNode(b.node)?Se.shouldRenderGhostCellNode(b.node)?new dL(a,b,this.$Ed,
this.jK,H.a.instance.ga(63),H.a.instance.ga(77)):null:this.Gkb.create(a,b)}}Object(e.a)(eL,"GhostTableCellViewElementFactory",null,[361]);class fL{constructor(a,b,c){this.tc=a;this.Jda=b;this.YOg=c;this.wF=null;this.Xyb=this.Yyb=-1}W7k(a,b=null){this.Y7k(a);this.wF&&this.w4k(b)}Cpi(){this.wF=null;this.Xyb=this.Yyb=-1}V9f(a,b,c){if(!a||!this.wF)return{row:b,column:c};var f=this.Jda.l5f(a,this.wF,this.YOg.LDc,this.YOg.KDc);if(!f)return{row:b,column:c};let l=f.rowIndex;f=f.ni;l===b||this.Jda.iTc(a,this.wF)||
(l=b);var x=0,G=this.tc.wi(this.wF)-1;let R=0,fa=this.tc.jk(this.wF)-1;this.Jda.iTc(a,this.wF)&&b>=R&&b<=fa&&c>=x&&c<=G&&(a=(x=(x=this.wF.jf(b,c))?x.Gy():null)?x.rowSpan:0,G=x?x.colSpan:0,x=c,G=c+G-1,R=b,fa=b+a-1);l>=R&&l<=fa&&f>=x&&f<=G&&(b=l,c=f);return{row:b,column:c}}Fgk(a){a=this.Lgg(a);return!!a&&14===a.type&&a.Ap()}s9h(a,b,c,f,l,x){if(!this.wF||!a||14!==a.type||this.wF!==a||!b)return{J7f:c,y7f:f,Jyh:l,Gyh:x};this.wF.jf(c,f).isControllingCell&&({rowIndex:c,Rha:f}=this.e6i(c,f));if(this.wF.jf(l,
x).isControllingCell||!this.Jda.iTc(b,this.wF))({row:l,column:x}=this.V9f(b,l,x));Aa.a.J(41209862,816,50,"Drag to select table cells in complex table.");return{J7f:c,y7f:f,Jyh:l,Gyh:x}}Y7k(a){(a=this.Lgg(a))&&14===a.type&&(this.wF=a)}Lgg(a){return 1074135132===a.Oe&&a.qd?this.tc.iN(a):this.tc.T1b(a)}w4k(a){this.wF&&a&&({row:this.Yyb,column:this.Xyb}=this.V9f(a,this.Yyb,this.Xyb))}e6i(a,b){if(!this.wF)return{rowIndex:a,Rha:b};let c=null;0<=a&&a<this.tc.jk(this.wF)&&0<=b&&b<this.tc.wi(this.wF)&&(c=
this.wF.jf(a,b));this.TIj(c)&&(a=this.Yyb,b=this.Xyb);return{rowIndex:a,Rha:b}}TIj(a){if(!this.wF)return!1;let b=0;var c=this.tc.wi(this.wF)-1;let f=0;var l=this.tc.jk(this.wF)-1;if(a){l=a.rowIndex;c=a.ni;const x=a.rowSpan;a=a.colSpan;b=c;c=c+a-1;f=l;l=l+x-1}return this.Yyb>=f&&this.Yyb<=l&&this.Xyb>=b&&this.Xyb<=c}}Object(e.a)(fL,"PptTableDragSelectionCellExtendStrategy",null,[275]);var gL=d(814),Ym=d(236);class hL{constructor(){this.XQc=this.colSpan=this.bgd=0}}Object(e.a)(hL,"HeightInfo",null,
[]);class iL{constructor(){this.sOa=null;this.rowSpan=this.height=this.width=this.top=this.offsetTop=this.left=0;this.dlg=this.Glg=this.nwg=this.pwg=this.owg=!1}}Object(e.a)(iL,"TableCellInfo",null,[]);class jL{constructor(){this.KKh=[]}get cells(){return this.KKh}tHd(a){this.cells.push(a)}}Object(e.a)(jL,"TableRowInfo",null,[]);class kL{constructor(){this.sOa=null;this.height=this.width=this.left=this.top=this.offsetTop=0;this.Cvg=this.Iwg=this.Hvg=!1}}Object(e.a)(kL,"UpdateInfo",null,[]);var uQ=
d(1036),lL=d(549);class Kv extends lL.a{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){super(a,b,mb);this.XLa=!1;this.W0a=this.avf=this.SCd=this.V0a=this.UEa=null;this.qzd=0;this.cmi=1;this.ami=16;this.Sli=256;this.Vli=4096;this.bmi=65536;this.iuc=this.Euc=this.Puc=this.Zuc=!1;this.iZe=this.Jzf=this.cyc=this.svc=this.Vfa=0;this.The=this.Uhe=null;this.vYh=Object(ua.a)(128,b);this.Baa=c;this.Qaa=nc;this.Yc=Wa;this.mV=Kb;this.jK=wa;this.lzc=R;this.Mga=fa;this.Lga=G;this.ir=x;this.L0c=!!u.AFrameworkApplication.fa&&
u.AFrameworkApplication.fa.ka("PPTOTableCellDiagonalBordersEnabled");a=this.Gd.Wo(la.a.td);this.kc(a);this.FY=this.Gd.Wo(la.a.div);a.appendChild(this.FY);this.FY.className="TableCellContent";this.No(this.FY)}u0b(){return this.FY.offsetHeight+this.FY.offsetTop}Zoc(a,b,c,f){a=this.XLa?a:a+c;this.UEa||(this.UEa=this.vGc());this.UEa.style.left=a-2.5+"px";this.UEa.style.top=b+"px";this.UEa.style.height=f+"px"}iVf(){const a=this.Gd.Wo(la.a.div);Qc.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);
return a}vGc(){const a=this.iVf();a.className="TableColumnResizeHandle";return a}BRd(){const a=this.Gd.Wo(la.a.div);Qc.c(a,!0);this.htmlElement.insertBefore(a,this.htmlElement.firstChild);a.className=Cf.a.YOk;return a}Jvl(a,b,c,f){f?(a=this.XLa?a:a+b,this.V0a||(this.V0a=this.xyi()),b=this.V0a.style,b.top=c+"px",b.left=a+"px"):this.V0a&&(this.BPf(this.V0a,!1),this.V0a=null);return this.V0a}xyi(){const a=this.BRd(),b=this.Gd.Wo(la.a.div);Qc.c(b,!0);b.className=Cf.a.z8d;a.appendChild(b);return a}iyl(a,
b,c,f){this.zOi();const l=this.SCd.style;l.top=c+"px";l.left=f+"px";c=this.avf.style;c.marginTop=b-2.5+"px";c.width=a+"px"}zOi(){if(!this.SCd){const a=this.BRd(),b=this.Gd.Wo(la.a.div);Qc.c(b,!0);b.className=Cf.a.Yog;a.appendChild(b);this.SCd=a;this.avf=b}}myl(a,b,c){c?(this.W0a||(this.W0a=this.sCi()),c=this.W0a.style,c.top=a+b-10+"px",this.XLa?c.right="-15px":c.left="-15px"):this.W0a&&(this.BPf(this.W0a,!0),this.W0a=null);return this.W0a}sCi(){const a=this.BRd(),b=this.Gd.Wo(la.a.div);Qc.c(b,!0);
b.className=Cf.a.A8d;a.appendChild(b);return a}deh(a){(a=this.htmlElement.querySelector("."+a))&&this.htmlElement.removeChild(a.parentNode)}BPf(a,b){b?Ym.a.Noi(a):Ym.a.Joi(a);this.htmlElement.removeChild(a)}uwg(a){a=a?E.a.BDa:u.AFrameworkApplication.isRtl?E.a.z8a:E.a.aSa;return 8!==u.AFrameworkApplication.Ta.ki(Mc.a.create(this.$a),a,1,!0,new uQ.a,null)}eU(a){super.eU(a);const b=super.eU(a);this.qzd=this.hhj(a);if(this.Qaa.Ww&&!this.Oc.Kl){var c=eh.a.mb(a.b1,a.currentNode);c.af();this.Lga.Ke(c);a=
this.lzc.getContainingTable(a);this.Mga.Ug(c)&&a&&!this.ir.eBa(a)&&(c=c.Mq)&&c.htmlElement&&this.Baa.KTf(c.htmlElement,a,this.Ma)}return new ul.a(b.Qla+this.svc+On.a.cib,Math.max(b.minWidth,this.qzd),b.Rla+this.cyc+On.a.cib)}hhj(a){return Jd.TableReader.Zvb(a)?(a=this.Qaa.jbe?this.$a.sa(Kg.a.ENd,1):1,a*On.a.dRe+(a-1)*(this.svc+this.cyc+On.a.cib)):On.a.dRe}N5(a){this.FY.style.paddingLeft=a.Qla-On.a.cib+"px";this.FY.style.paddingRight=a.Rla-On.a.cib+"px";this.Qaa.HUc&&this.Qaa.jbe&&(this.FY.style.minWidth=
this.qzd+"px")}Q$(a){this.uD(this.FY,a,1)}oy(){this.QCh();this.zmh();var a=nb.GraphIterator.mb(this.$a);a.pc(14);const b=Qd.getContainingTable(a),c=Se.isFirstCellInColumn(a);a=Se.isFirstCellInRow(a);let f="";c&&Kv.Rzg(b,32)&&(f="columnheader");a&&!c&&Kv.Rzg(b,128)&&(f="rowheader");""!==f?Ca.d(this.htmlElement,Da.a.role,f):this.htmlElement.removeAttribute(Jc.a.Ye);this.Yc&&this.Yc.NDa(65)&&(this.$a.cXb?Sys.UI.DomElement.addCssClass(this.htmlElement,Tb.c3):Sys.UI.DomElement.removeCssClass(this.htmlElement,
Tb.c3));this.jK.dr&&(this.htmlElement.style.border="",this.vVk(),this.b3k(b),this.htmlElement.style.verticalAlign=this.jK.dr.C0i(this.$a));this.R6k();this.Qaa.HUc&&this.Qaa.jbe&&(this.$a.Sa(Kg.a.tOf)?this.noh():this.htmlElement.removeAttribute("rowspan"),this.$a.Sa(Kg.a.ENd)?this.Emh():this.htmlElement.removeAttribute("colspan"));this.Oc.Kl&&this.Qaa.HQj&&(this.htmlElement.style.width=this.Gd.Fd.Ie(this.vYh.width,0)+"px")}R6k(){if(this.Qaa.nNj||this.Qaa.OSj)this.$a.g6d?this.noh():this.htmlElement.removeAttribute("rowspan"),
this.$a.W7a?this.Emh():this.htmlElement.removeAttribute("colspan")}QCh(){let a=null;if(this.Yc&&this.Yc.NDa(65)){var b=nb.GraphIterator.mb(this.$a);b.pc(15);b=b.Dw(15);if(b.qoc){Sys.UI.DomElement.addCssClass(this.htmlElement,Tb.nxh);return}if(b.vmd){Sys.UI.DomElement.addCssClass(this.htmlElement,Tb.qxh);return}}this.$a.Sa(tb.a.iEc)?(a=Hb.a.ZH(this.$a.sa(tb.a.iEc,Hb.a.nil)),this.Vfa|=this.bmi):this.Qaa.kQj&&this.jK.dr&&(a=this.jK.dr.I9f(this.$a));a=a||"transparent";this.htmlElement.style.backgroundColor=
a;"transparent"!==a&&4.5>Hb.a.t1i(a)?this.htmlElement.className="LowContrastShading":this.htmlElement.className=this.htmlElement.className.replace("LowContrastShading","");this.Yc&&this.Yc.NDa(65)&&(Sys.UI.DomElement.removeCssClass(this.htmlElement,Tb.nxh),Sys.UI.DomElement.removeCssClass(this.htmlElement,Tb.qxh))}noh(){Ca.d(this.htmlElement,Da.a.rowSpan,this.Qaa.HUc?this.$a.sa(Kg.a.tOf,1):this.$a.rowSpan)}Emh(){Ca.d(this.htmlElement,Da.a.colSpan,this.Qaa.HUc?this.$a.sa(Kg.a.ENd,1):this.$a.colSpan)}vVk(){this.iuc=
this.Puc=this.Euc=this.Zuc=!1}b3k(a){this.jK.dr&&(this.X4k(),this.htmlElement.style.border="0px none",this.dHb(this.$a,a,7),this.dHb(this.$a,a,5),this.dHb(this.$a,a,0),this.dHb(this.$a,a,6),this.L0c&&(this.dHb(this.$a,a,2),this.dHb(this.$a,a,1)),Ca.d(this.htmlElement,Da.a.ESd,this.Vfa),this.ATk())}zmh(){var a=new nb.GraphIterator;a.set(this.$a);a.pc(14);a.Rg(14);a=a.currentNode;this.svc=On.a.oPc(this.$a,a,Mb.a.oJb,this.jK.dr,Mb.a.rml,0);this.cyc=On.a.oPc(this.$a,a,Mb.a.qJb,this.jK.dr,Mb.a.sml,0);
this.Jzf=On.a.oPc(this.$a,a,Mb.a.rJb,this.jK.dr,Mb.a.tml,1);this.iZe=On.a.oPc(this.$a,a,Mb.a.nJb,this.jK.dr,Mb.a.nml,1);this.FY.style.paddingLeft=this.svc+"px";this.FY.style.paddingRight=this.cyc+"px";this.FY.style.paddingTop=this.Jzf+"px";this.FY.style.paddingBottom=this.iZe+"px"}X4k(){var a=nb.GraphIterator.mb(this.$a);a.pc(14);a=this.lzc.getContainingTable(a);this.XLa=Jd.TableReader.jm(a)}dHb(a,b,c){this.mV&&this.mV.DFj(b);a=this.jK.dr.H4i(a,c);b=a.Rei;const f=a.vlj;if(""!==b)switch(""!==f&&Sys.UI.DomElement.addCssClass(this.htmlElement,
f),c){case 7:this.htmlElement.style.borderTop=b;this.hUc(b)&&(this.Zuc=!0);a.iIc&&(this.Vfa|=this.cmi);break;case 5:this.umh(5,b);this.hUc(b)&&(this.Euc=!0);a.iIc&&(this.Vfa|=this.Vli);break;case 0:this.htmlElement.style.borderBottom=b;this.hUc(b)&&(this.iuc=!0);a.iIc&&(this.Vfa|=this.Sli);break;case 6:this.umh(6,b);this.hUc(b)&&(this.Puc=!0);a.iIc&&(this.Vfa|=this.ami);break;case 2:this.Uhe=b;break;case 1:this.The=b}}hUc(a){return!a||a.startsWith("0px none")?!1:!0}umh(a,b){if(5===a&&!this.XLa||6===
a&&this.XLa)this.htmlElement.style.borderLeft=b;if(5===a&&this.XLa||6===a&&!this.XLa)this.htmlElement.style.borderRight=b}ATk(){if(this.Kbl()){var a=nb.GraphIterator.mb(this.$a);if(a.pc(14)){var b=Se.isFirstCellInRow(a),c=Se.isLastCellInRow(a);this.Zuc||(this.htmlElement.style.borderTop="solid 1px #c8cacc",this.Zuc=!0);this.iuc||(this.htmlElement.style.borderBottom="solid 1px #c8cacc",this.iuc=!0);b=b?"solid 1px #c8cacc":"dashed 1px #c8cacc";c=c?"solid 1px #c8cacc":"dashed 1px #c8cacc";a=a.Dw(14);
a=!Jd.TableReader.jm(a);this.Euc||(this.htmlElement.style.borderLeft=a?b:c,this.Euc=!0);this.Puc||(this.htmlElement.style.borderRight=a?c:b,this.Puc=!0)}}}Kbl(){const a=this.Oc;return a.Lh&&a.features.Sbl?!0:!1}get Vha(){return this.FY}HJ(a){super.HJ(a);this.UT()}UT(){if(!this.Gd.Kl&&this.MA){const a=Object(ua.a)(1045,this.$Q);a&&a.dUg(this.FY)}}get qqb(){return this.UEa}static Rzg(a,b){return null!==a&&a.Sa(Mb.a.tableLook)?!!(a.properties.getValue(Mb.a.tableLook)&b):!1}}Object(e.a)(Kv,"TableCellViewElement",
lL.a,[1072,418,345,106]);class hm extends tl.a{constructor(a,b,c,f=null){super(a,b);this.rR=null;this.Pqc=!0;this.vm=[];this.Pu=[];this.Zzc=this.cG=null;this.K_e=this.$uf=0;hm.tTa=c;this.mV=f;b=this.Gd.Wo(la.a.div);b.className="TableContainer";this.Sj=this.Gd.Wo(la.a.table);b.appendChild(this.Sj);this.Sj.className="Table";Sys.UI.DomElement.addCssClass(this.Sj,hm.Vkd);this.mBf=a;this.$za=this.Gd.Wo(la.a.div);this.$za.id=Ga.a.create().toString();this.$za.className=hm.Xll;this.$za.setAttribute(Jc.a.pK,
Jc.a.KB);b.insertBefore(this.$za,this.Sj);Qc.c(this.$za,!0);a.Kl&&Ca.d(this.Sj,Da.a.border,this.$a.sa(tb.a.bib,!0)?"1":"0");this.kc(b);a.Kl||(this.rR=this.Gd.Wo(la.a.Tqi),this.Sj.appendChild(this.rR));this.TR=this.Gd.Wo(la.a.Exh);this.Sj.appendChild(this.TR);this.No(this.Sj)}get M0(){return this.TR}get table(){return this.Sj}get rFc(){return this.rR}oy(a){this.Sj.style.borderCollapse="collapse";if(Uc.StyleReader.dr)Sys.UI.DomElement.removeCssClass(this.Sj,hm.Vkd),Sys.UI.DomElement.removeCssClass(this.Sj,
hm.gRe);else{var b=this.$a.sa(tb.a.bib,!0);b&&!this.Pqc?(Sys.UI.DomElement.removeCssClass(this.Sj,hm.gRe),Sys.UI.DomElement.addCssClass(this.Sj,hm.Vkd),this.Pqc=!0):!b&&this.Pqc&&(Sys.UI.DomElement.removeCssClass(this.Sj,hm.Vkd),Sys.UI.DomElement.addCssClass(this.Sj,hm.gRe),this.Pqc=!1)}H.a.instance.ga(71)&&Uc.StyleReader.dr&&(Ca.d(this.Sj,Da.a.GSd,"Custom"),Ca.d(this.Sj,Da.a.FSd,0));var c=this.rR?Jd.TableReader.wi(this.$a):0;b=this.rR?c-this.rR.childNodes.length:0;for(var f=0;f<b;++f){var l=this.Gd.Wo(la.a.col);
this.rR.appendChild(l)}for(f=0;f>b;--f)this.rR.removeChild(this.rR.firstChild);f=Nn.b(this.$a);var x=0;this.mV&&(x=this.mV.A2d(this.$a));l=Array(c);var G=!0;b=0;for(var R=0;R<c;++R){let fa=this.J7(R);0<=f[R]?(l[R]=Math.max(fa,this.Gd.Fd.Ie(f[R],0)-x),this.rR.childNodes[R].style.width=l[R]+"px",b+=l[R]):(l[R]=-1,G=!1,this.rR.childNodes[R].style.width="",b+=fa)}if(H.a.instance.ga(63)||H.a.instance.ga(77))G?Sys.UI.DomElement.addCssClass(this.Sj,hm.DGh):Sys.UI.DomElement.removeCssClass(this.Sj,hm.DGh);
if(this.vm.length===c)for(x=this.wMc(),G=0;G<c;++G)R=this.J7(G),this.vm[G].childNodes[x].style.width=0<=f[G]?Math.max(R,l[G])+"px":R+"px";c=Jd.TableReader.jm(this.$a);if(this.$a.Sa(tb.a.xl))switch(Jd.TableReader.fN(this.$a)){case 1:this.Sj.style.marginLeft="";this.Sj.style.marginRight="auto";break;case 2:this.Sj.style.marginLeft="auto";this.Sj.style.marginRight="auto";break;case 3:this.Sj.style.marginLeft="auto";this.Sj.style.marginRight="";break;case 14:this.Sj.style.marginLeft=c?"auto":"";this.Sj.style.marginRight=
c?"":"auto";break;case 15:this.Sj.style.marginLeft=c?"":"auto";this.Sj.style.marginRight=c?"auto":"";break;default:this.Sj.style.marginLeft="",this.Sj.style.marginRight=""}else this.Sj.style.marginLeft="",this.Sj.style.marginRight="",H.a.instance.ga(63)&&this.$a.Sa(Mb.a.Rl)&&(f=({Sf:a}=Jd.TableReader.Mia(a)).returnValue,a=(new ov.a(a,f)).ZKb+"px",c?this.Sj.style.marginRight=a:this.Sj.style.marginLeft=a);(H.a.instance.ga(71)||H.a.instance.ga(77))&&this.U7k(Uc.StyleReader.dr,this.$a,this.Sj);this.$a.properties.sa(tb.a.iug,
!1)?(Sys.UI.DomElement.addCssClass(this.Sj,hm.$Rf),Ca.d(this.Sj,Da.a.Rbi,"conflictSRDescription")):(Sys.UI.DomElement.removeCssClass(this.Sj,hm.$Rf),this.Sj.removeAttribute(Jc.a.kqa));(a=Jd.TableReader.L3d(this.$a))&&this.Sj.setAttribute("title",a);(a=Jd.TableReader.K3d(this.$a))?this.mBf.Kl&&1===this.mBf.mode?this.Sj.removeAttribute(Jc.a.kqa):(this.$za.innerText=a,this.Sj.setAttribute(Jc.a.kqa,this.$za.id)):(this.$za.innerText="",this.Sj.removeAttribute(Jc.a.kqa));pc.a.instance.Nj&&!H.a.instance.ga(30)&&
(this.Sj.style.width="0px");H.a.instance.ga(30)&&(this.Sj.style.minWidth=b+"px");this.f3k();this.Z7k()}f3k(){if(this.mV){const a=this.mV.dGl(this.$a);""!==a&&(this.Sj.style["border-spacing"]=a);this.f$d&&(this.Sj.style.borderCollapse="separate")}}get f$d(){return!!this.mV&&this.mV.DFj(this.$a)}YZd(a){return this.mV?this.mV.vFl(this.$a,a):0}Z7k(){this.Sj.style.borderTop="";this.Sj.style.borderBottom="";this.Sj.style.borderLeft="";this.Sj.style.borderRight=""}J7(a){return(Uc.StyleReader.dr?Uc.StyleReader.dr.J7(this.$a,
a):On.a.dld)+(this.mV?this.mV.A2d(this.$a):0)}U7k(a,b,c){a&&(c.style.background=a.ohj(b))}Q$(a){this.uD(this.htmlElement,a,88);1<this.htmlElement.children.length&&this.htmlElement.firstChild===this.Sj&&(this.mjc(this.htmlElement,this.Sj),this.htmlElement.appendChild(this.Sj));this.uD(this.TR,a,1);let b=!1;this.TR.firstChild!==this.cG&&(this.cG=this.TR.firstChild,b=!0);H.a.instance.ga(30)&&Jd.TableReader.vu(a.currentNode)||!this.rR||(u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")?
(a=!1,(this.vm&&this.vm.length?this.vm[0].parentNode:null)!==(this.cG?this.cG.firstChild:null)&&(a=!0),this.bgh(b||a)):this.rTk(b),Ym.a.nv||this.FGe(b))}wMc(){let a=1;(H.a.instance.ga(63)||H.a.instance.ga(30))&&Jd.TableReader.vu(this.$a)&&(a=0);return a}dispose(){H.a.instance.ga(50)&&Cb.App.Ih&&Cb.App.Ih.Zv&&this.$dh();this.Pu=this.vm=this.Sj=this.TR=this.rR=this.$za=this.cG=null;super.dispose()}eU(a){var b=Nn.b(this.$a),c=null;if(a.Ab(1)){do{var f=a.Mq.rJa;c=c?yv.pri(c,f):f.copy()}while(a.zj(1))
}c||(c=new yv(b.length));for(f=0;f<b.length;f++)-1<b[f]&&c.Dmh(f,Math.max(c.A1i(f),this.Gd.Fd.Ie(b[f],0)));b=On.a.cib;c=new ul.a(b,Math.max(0,c.Fek()-2*b),b);b=new nb.GraphIterator;b.set(this.$a);f=!1;b.pc(16)&&(f=!0);c=f?new ul.a(0,c.total,0):new ul.a(c.Qla,c.minWidth,c.Rla);a.Ab(88)&&(c=ul.a.max(c,a.Mq.rJa),a.yc());return c}TCj(){this.$dh();this.vm=[];this.Pu=[]}$dh(){if(this.Pu)for(var a=0;a<this.Pu.length;++a)K.a.qIa(this.Pu[a]),ya.a.vO(this.Pu[a]);if(this.vm)for(a=0;a<this.vm.length;++a)K.a.qIa(this.vm[a]),
this.Pu&&this.Pu[a]&&this.Pu[a].parentNode&&ya.a.vO(this.vm[a])}bgh(a){if(this.vm&&this.cG&&this.cG.firstChild){var b=r.a.Vw||r.a.io?"":" 16 20",c=String.format("url('{0}'){1}, pointer",vy.a.box4Image("ColumnSelect.cur"),b);b=Nn.b(this.$a);var f=b.length,l=this.cG.firstChild;if(a){a=Math.min(f,this.vm.length);for(var x=0;x<a;x++)l.insertBefore(this.vm[x],l.firstChild)}if(f>this.vm.length)for(a=this.vm.length;a<f;a++){x=this.Gd.createElement("div");x.className="TableColumnHandleAnchor";Qc.c(x,!0);
Array.add(this.vm,x);var G=this.Gd.createElement("div");G.className=Ym.a.fRe;G.style.cursor=c;x.appendChild(G);G=this.Gd.createElement("div");G.className="TableColumnWidthSpacer";x.appendChild(G);l.insertBefore(this.vm[a],l.firstChild)}if(f<this.vm.length){for(c=f;c<this.vm.length;c++)K.a.qIa(this.vm[c]),ya.a.vO(this.vm[c]);c=[];for(l=0;l<f;l++)Array.add(c,this.vm[l]);this.vm=c}c=this.wMc();l=0;for(a=0;a<f;a++)x=this.J7(a),x=Math.max(x,this.Gd.Fd.Ie(b[a],0)),this.vm[a].childNodes[c].style.width=x+
"px",this.vm[a].style.left=l+"px",this.vm[a].setAttribute("ColumnIndex",a.toString()),l+=x}}rTk(a){var b=r.a.Vw||r.a.io?"":" 16 20";b=String.format("url('{0}'){1}, pointer",vy.a.box4Image("ColumnSelect.cur"),b);if(a){a=this.cG.firstChild;var c=Math.min(this.cG.childNodes.length,this.vm.length);for(var f=0;f<c;++f)a.insertBefore(this.vm[f],a.firstChild),a=a.nextSibling}a=this.cG.childNodes.length;if(a>this.vm.length){c=this.cG.firstChild;for(f=0;f<this.vm.length;++f)c.insertBefore(this.vm[f],c.firstChild),
c=c.nextSibling;for(f=this.vm.length;f<a;++f){const x=this.Gd.createElement("div");x.className="TableColumnHandleAnchor";Qc.c(x,!0);Array.add(this.vm,x);var l=this.Gd.createElement("div");l.className=Ym.a.fRe;l.style.cursor=b;x.appendChild(l);l=this.Gd.createElement("div");l.className="TableColumnWidthSpacer";x.appendChild(l);c.insertBefore(x,c.firstChild);c=c.nextSibling}}else if(a<this.vm.length){for(b=a;b<this.vm.length;++b)K.a.qIa(this.vm[b]),ya.a.vO(this.vm[b]);b=[];for(c=0;c<a;++c)Array.add(b,
this.vm[c]);this.vm=b;b=this.cG.firstChild;for(a=0;a<this.vm.length;++a)b.insertBefore(this.vm[a],b.firstChild),b=b.nextSibling}b=this.wMc();a=Nn.b(this.$a);for(c=0;c<this.vm.length;++c)f=this.J7(c),this.vm[c].childNodes[b].style.width=0<=a[c]?Math.max(f,this.Gd.Fd.Ie(a[c],0))+"px":f+"px"}FGe(a){if(!this.Pu.length){a=this.Gd.createElement("div");a.innerText="\u00a0";a.className="TableLastResizeAnchor";var b=this.Gd.createElement("div");b.className=Ym.a.hld+" Last";a.appendChild(b);Array.add(this.Pu,
a);Qc.c(a,!0);a=!0}if(a){a=Math.min(this.Pu.length,this.cG.childNodes.length);for(b=1;b<a;++b){var c=this.cG.childNodes[b];c.insertBefore(this.Pu[b],c.firstChild)}(a=this.cG.lastChild)?a.insertBefore(this.Pu[0],a.firstChild):Z.ULS.sendTraceTag(38285521,324,15,"Table first row has no child")}a=this.cG.childNodes.length;if(a>this.Pu.length){for(b=1;b<this.Pu.length;++b)c=this.cG.childNodes[b],c.insertBefore(this.Pu[b],c.firstChild);for(b=this.Pu.length;b<a;++b){c=this.Gd.createElement("div");c.className=
Ym.a.hld;Qc.c(c,!0);Array.add(this.Pu,c);let f=this.cG.childNodes[b];f.insertBefore(c,f.firstChild)}a=this.cG.lastChild;a.insertBefore(this.Pu[0],a.firstChild)}else if(a<this.Pu.length){for(b=a;b<this.Pu.length;++b)K.a.qIa(this.Pu[b]),ya.a.vO(this.Pu[b]);b=[];for(c=0;c<a;++c)Array.add(b,this.Pu[c]);this.Pu=b;for(a=1;a<this.Pu.length;++a)b=this.cG.childNodes[a],b.insertBefore(this.Pu[a],b.firstChild);(a=this.cG.lastChild)?a.insertBefore(this.Pu[0],a.firstChild):Z.ULS.sendTraceTag(38285522,324,15,"Table first row has no child")}}jJe(a,
b){let c=-1;if(Jd.TableReader.jm(this.$a))if(b<=Sys.UI.DomElement.getLocation(this.TR.firstChild.lastChild).x)c=this.TR.firstChild.childNodes.length-1;else for(var f=0;f<this.TR.firstChild.childNodes.length;++f){var l=Sys.UI.DomElement.getLocation(this.TR.firstChild.childNodes[f]);if(b>=l.x){c=f;break}}else if(b<=Sys.UI.DomElement.getLocation(this.TR.firstChild.firstChild).x)c=0;else for(f=this.TR.firstChild.childNodes.length-1;0<=f;--f)if(l=Sys.UI.DomElement.getLocation(this.TR.firstChild.childNodes[f]),
b>=l.x){c=f;break}c<a&&(b=c,c=a,a=b);f=[];l=nb.GraphIterator.mb(this.$a);const x=new nb.GraphIterator;b=new Id.GraphTransaction(2);b.iy(l);Qd.moveToFirstRow(l);Qd.moveToColumnByIndex(l,a);x.Pc(l);Qd.moveToColumnByIndex(x,c);do(a=rd.SelectionFactory.WGc(l,x))&&Array.add(f,a),Qd.moveToNextRow(x);while(Qd.moveToNextRow(l));a=new Ob.SelectionCollection(f,f.length-1,0);this.Oc.Gb.qE(a);b.dispose()}slc(a,b){const c=this.wMc();this.vm&&a<this.vm.length&&this.vm[a]&&(this.vm[a].childNodes[c].style.width=
Math.max(this.J7(a),b)+"px");this.rR.childNodes[a].style.width=Math.max(1,b)+"px"}X2i(a){return this.TR.firstChild.childNodes[a]?this.TR.firstChild.childNodes[a].offsetWidth:(Z.ULS.sendTraceTag(36726402,341,10,"Column {0} does not exist in first row of table. Table Rows: {1} | First row view cells {2}",a,this.TR.childNodes.length,this.TR.firstChild.childNodes.length),0)}DMc(a){a=parseInt(this.rR.childNodes[a].style.width);return isNaN(a)?On.a.dRe:a}N5(a){super.N5(a);H.a.instance.ga(63)&&this.kyl();
this.QVe()}QVe(){this.Zzc||(this.Zzc=new xe.a(3,1,0,Object(C.a)(this,this.updateTableDOMElements,"updateTableDOMElements"),119),u.AFrameworkApplication.pe.Cb(this.Zzc))}updateTableDOMElements(){this.Zzc=null;this.M0&&(H.a.instance.ga(63)?this.TDk(this.ZJk()):Ym.a.nv&&this.uCe(this.D2d()),u.AFrameworkApplication.fa.ka("IsComplexTableColumnSelectionHandleFixEnabled")&&this.bgh(!1))}Lnd(){this.KTk()}D0i(a){return a.offsetWidth+this.YZd(0)/2}D2d(){const a=this.dRa(),b=a.length,c=[];let f=0,l=!1;const x=
Jd.TableReader.vu(this.$a);for(let R=0;R<b;R++){const fa=a[R];if(x){let Wa;({dgd:Wa}=this.Qmd(fa)).returnValue&&(l=gk.f(Wa.$a))}const wa=fa.childNodes;for(let Wa=0;Wa<wa.length;Wa++){var G=wa[Wa];if(void 0!==G.colSpan&&null!==G.colSpan&&void 0!==G.rowSpan&&null!==G.rowSpan){let mb;({GNd:mb}=this.GTe(G)).returnValue&&(G=Object.assign(new kL,{sOa:mb,left:G.offsetLeft,top:this.f$d?fa.offsetTop:f,width:this.D0i(G),height:G.offsetHeight,Hvg:!R,Iwg:R+G.rowSpan===b,Cvg:!l&&!Wa}),c.push(G))}}f+=fa.offsetHeight}return c}kyl(){if(this.M0){var a=
new nb.GraphIterator;a.set(this.$a);if(Jd.TableReader.uSf(a)&&this.rR){a=this.rR.childNodes.length;var b=Array(a),c=[],f=this.dRa(),l=f.length,x=0;for(let G=0;G<l;G++){let R=0;const fa=f[G],wa=fa.childNodes;let Wa=0;for(let mb=0;mb<a;mb++){let Kb;if(b[mb]){let nc;(nc=b[mb]).XQc=nc.XQc-x;let oc;(oc=b[mb]).bgd=oc.bgd-1;Kb=b[mb].colSpan;1===b[mb].bgd&&(R=Math.max(R,b[mb].XQc),b[mb]=null)}else{const nc=wa[Wa];Wa++;if(!nc)continue;let oc=0,Ic;({GNd:Ic}=this.GTe(nc)).returnValue&&(oc=Ic.u0b());Kb=nc.colSpan;
1<nc.rowSpan?b[mb]=Object.assign(new hL,{colSpan:nc.colSpan,XQc:oc,bgd:nc.rowSpan}):R=Math.max(R,oc)}mb+=Kb-1}({dgd:x}=this.Qmd(fa)).returnValue?(x.d3k(R)&&c.push(x),x=x.Wih):x=0}for(const G of c)G.jyl()}}}KTk(){const a=this.dRa();if(Cb.App.instance.HTc&&a.length&&!(a.length<=this.$uf&&a[0].childNodes.length===this.K_e)){this.$uf=a.length;this.K_e=a[0].childNodes.length;var b;for(let c=0;c<a.length;c++)!ya.a.$ba(a[c].firstChild,"DragHandle")&&({dgd:b}=this.Qmd(a[c])).returnValue&&b.tTk()}}Ztg(a,b){b=
a.querySelector("."+b);return!!b&&b.parentNode.parentNode===a}uCe(a){if(a)for(const b of a)b.sOa.Zoc(b.left,b.top,b.width,b.height,b.Hvg,b.Iwg,b.Cvg)}dRa(){return this.M0.children}GTe(a){let b;b=null;a&&(a=Qc.a(a),b=Object(ua.a)(Kv,a));return{returnValue:!!b,GNd:b}}Qmd(a){let b;b=null;a&&(a=Qc.a(a),b=Object(ua.a)(Zt,a));return{returnValue:!!b,dgd:b}}ZJk(){let a=0;const b=Jd.TableReader.vu(this.$a),c=this.f$d,f=this.dRa(),l=[];let x=!1;for(let R=0,fa=f.length;R<fa;R++){const wa=f[R];if(!wa)continue;
if(b){let nc;({dgd:nc}=this.Qmd(wa)).returnValue&&(x=gk.f(nc.$a))}const Wa=new jL,mb=!R,Kb=wa.childNodes;for(let nc=0,oc=Kb.length;nc<oc;nc++){var G=Kb[nc];let Ic;if(({GNd:Ic}=this.GTe(G)).returnValue){const Kc=G.offsetTop,Hc=G.rowSpan,ie=!nc;G=Object.assign(new iL,{sOa:Ic,left:G.offsetLeft,offsetTop:Kc,top:c?Kc:a,width:G.offsetWidth,height:G.offsetHeight,rowSpan:Hc,owg:mb,pwg:R+Hc===fa,nwg:!x&&ie,Glg:!ie&&this.Ztg(G,Cf.a.A8d),dlg:!mb&&this.Ztg(G,Cf.a.z8d)});Wa.tHd(G)}}a+=wa.offsetHeight;l.push(Wa)}return l}TDk(a){if(a.length){var b=
this.YZd(1)/2,c=this.YZd(0)/2,f=a[0].cells[0].sOa,l=f.uwg(!1);f=f.uwg(!0);var x=[];for(var G of a[0].cells){var R=G.sOa.Jvl(G.left,G.width+c,G.offsetTop,l);R&&x.push(R)}Ym.a.GMk(x);l=[];for(G=0;G<a.length;G++)x=a[G].cells[0],(R=x.sOa.myl(x.height+b,x.offsetTop,f))&&l.push(R),1<x.rowSpan&&(G+=x.rowSpan-1);Ym.a.vOk(l);for(const fa of a)for(const wa of fa.cells)a=wa.sOa,f=wa.width,l=wa.height,a.iyl(f,l+b,wa.offsetTop,wa.left),a.Zoc(wa.left,wa.top,f+c,l,wa.owg,wa.pwg,wa.nwg),wa.Glg&&a.deh(Cf.a.A8d),wa.dlg&&
a.deh(Cf.a.z8d)}}}hm.Vkd="Border";hm.gRe="NoBorder";hm.$Rf="Conflict";hm.DGh="TableWordWrap";hm.Xll="WACAltTextDescribedBy";hm.tTa=null;Object(e.a)(hm,"TableViewElement",tl.a,[1038,418,345,106]);class Lv extends Zt{constructor(a,b,c){super(a,b,c,null,null)}LHb(a){this.htmlElement.style.height=a+"px"}get Vih(){return this.Gd.Fd.Ie(this.$a.sa(sb.a.au,0),1)+"px"}static Thg(a){a=Qc.a(a);let b=null;a&&(b=Object(ua.a)(Lv,a));return b}}Object(e.a)(Lv,"TableRowViewElement",Zt,[]);class Mx{constructor(a,b,
c=!1){this.Rei=a;this.vlj=b;this.iIc=c}}Object(e.a)(Mx,"TableBorderProperty",null,[]);var ml=d(493);class Vp{constructor(a,b,c,f,l){this.H8=a;this.lc=c;this.Nb=b;this.MBb=f;this.p5j=l}tbj(a){switch(a){case 0:a=Mb.a.nJb;break;case 1:a=Mb.a.oJb;break;case 2:a=Mb.a.qJb;break;case 3:a=Mb.a.rJb;break;default:a=null}return{returnValue:!!a,Tck:a}}Tra(a,b){let c=0;if(!a)return c;let f;({Tck:f}=this.tbj(b)).returnValue&&(c=3===b||0===b?a.sa(f,.1):a.sa(f,Vp.hAk));return c}VMf(a){return.0555555555555556+this.Tra(a,
1)+this.Tra(a,2)}VMd(a,b){const c=Jd.TableReader.jk(a);if(0>b||b>=c)return.0555555555555556;a=this.Nb.Kc(a).Rp(b,1);return this.NDc(a)}NDc(a){let b=.0555555555555556;a=this.Nb.Kc(a);a.Ab(1);do{const c=a.currentNode;b=Math.max(b,.0555555555555556+this.Tra(c,0)+this.Tra(c,3))}while(a.vf(1));return b}Cpb(a,b){var c=Jd.TableReader.wi(a);if(0>b||b>=c)return.0555555555555556;c=.0555555555555556;a=this.Nb.Kc(a);a.Ab(1);do{const f=a.Rp(b,1);c=Math.max(c,this.VMf(f));a.yc()}while(a.vf(1));return c}c0d(a){return a&&
a.tblBgField&&a.tblBgField.fillField&&(a.tblBgField.fillField.solidFillField||a.tblBgField.fillField.gradFillField)?a.tblBgField.fillField:ml.a.grb}M3d(a,b){let c=b;if(this.p5j&&b&&b.cellShading){let f;({Xja:f}=this.LTe(a,b.cellShading)).returnValue&&(b=Object(ua.a)(119,this.lc.ig(b)),c=this.MBb.aih(a,b?b.Pe:null,f))}return c}o0b(a,b){let c=ml.a.frb;const f=Vp.$Qa(b);f.returnValue&&(a=this.M3d(b,a),a.Sa(f.fOa)&&(c=a.getValue(f.fOa)));return c}cZd(a,b,c){if(c&&c.UC===Hb.a.auto)return Bk.a.none;a=this.l3i(a);
b=this.QZd(b);c=c.GU();return String.format("{0} {1}px {2}",a,b,c)}QZd(a){a=this.H8.Ie(a,0);r.a.mta&&0<a&&1>a&&(a=1);return a}$ob(a,b,c=!1){let f=Hb.a.iPa.GU();if(a.solidFillField){var l=uf.Box4ColorHelper.UL(uf.Box4ColorHelper.xxa(a.solidFillField),b);c&&(l.r=l.g=l.b=255);f=l.GU()}else if(a.gradFillField){a=qQ(a.gradFillField,b);if(c)for(l of a.stops)l.color.r=l.color.g=l.color.b=255;f=a.GU()}return f}Wkj(a){const b=a.currentNode.ni;a.yc();const c=a.lF(1);a.Rp(b,1);return c?a.currentNode:null}alj(a){return a.lF(1)}LTe(a,
b){switch(a){case 7:a=b.lnTField;break;case 0:a=b.lnBField;break;case 5:a=b.lnLField;break;case 6:a=b.lnRField;break;default:a=null}return{returnValue:!!a,Xja:a}}l3i(a){switch(a){case 2:case 3:case 4:case 5:case 6:case 7:case 9:case 10:return"dashed";case 1:case 8:return"dotted";default:return"solid"}}static $Qa(a){let b,c;switch(a){case 7:a=sb.a.Jxa;b=sb.a.Zhb;c=sb.a.tll;break;case 0:a=sb.a.sfa;b=sb.a.Gxa;c=sb.a.oll;break;case 5:a=sb.a.Ixa;b=sb.a.Yhb;c=sb.a.rll;break;case 6:a=sb.a.tfa;b=sb.a.Hxa;
c=sb.a.sll;break;case 2:a=sb.a.aib;b=sb.a.Xhb;c=sb.a.qll;break;case 1:a=sb.a.$hb;b=sb.a.Whb;c=sb.a.pll;break;default:c=b=a=null}return{returnValue:!!a,fOa:a,Y3a:b,hpb:c}}}Vp.hAk=.2;Object(e.a)(Vp,"TableStyleReaderHelper",null,[280]);class JD{constructor(a,b,c=-1){this.mva=a;this.$Fg=b;this.kKg=c}}Object(e.a)(JD,"TableStyle",null,[]);var gr=d(323);class Pz{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te){this.mva=new ef.a;this.y5c=new ef.a;this.x5c=new ef.a;this.t5c=new ef.a;
this.mRe=[];this.Nb=a;this.ZG=c;this.lc=b;this.Jk=f;this.H8=l;this.Wda=x;this.SGa=G;this.uc=R;this.tse=fa;this.Hak=wa;this.Cak=Wa;this.tak=mb;this.tc=Kb;this.OVa=nc;this.$I=oc;this.Eo=Ic;this.Eq=Kc;this.E0c=Hc;this.f6j=ie;this.Ezb=He;this.FFa=fe;this.OUa=Te;this.SGa.rha(Object(C.a)(this,this.E$c,"onTableConnectedOrDisconnected"));this.SGa.R6(Object(C.a)(this,this.E$c,"onTableConnectedOrDisconnected"));this.SGa.Yj(Object(C.a)(this,this.d3g,"onTablePropertyChanged"));this.Eq.E6h(Object(C.a)(this,this.f1g,
"onPageViewBeforeValidate"))}dispose(){this.SGa.Uma(Object(C.a)(this,this.E$c,"onTableConnectedOrDisconnected"));this.SGa.vIa(Object(C.a)(this,this.E$c,"onTableConnectedOrDisconnected"));this.SGa.tm(Object(C.a)(this,this.d3g,"onTablePropertyChanged"));this.Eq.$Rk(Object(C.a)(this,this.f1g,"onPageViewBeforeValidate"))}H9f(a){if(!a||!a.length)return null;const b=this.uMc(Object(ua.a)(lg.a,a[0]));if(!b)return null;for(let c=1;c<a.length;c++){const f=this.uMc(Object(ua.a)(lg.a,a[c]));if(!f||f.UC!==b.UC)return null}return b}x3d(a){let b=
null;if(a=this.U1b(a))b=new mq.a,b.me(sb.a.tableStyle,new JD(a,Number.MAX_VALUE));return b}pPc(a){if(14!==a.type){a=this.Nb.Kc(a);a.pc(14);var b=a.Rg(14)}else b=a;a=b.id;this.x5c.Jb(a)||(b=this.y3d(b),this.x5c.$(a,this.Cak(b)));return this.x5c.ga(a)}O8i(a){return(a=this.uc.p3d(Object(ua.a)(119,this.lc.ig(a))))?a.TableListStyle:null}y3d(a){const b=Object(ua.a)(119,this.lc.ig(a));return this.tse(()=>a.WX,()=>a.c7,()=>a.tableLook,()=>this.O8i(a),()=>b?b.Pe:null,()=>this.U1b(a))}E$c(a,b){this.Psg(b.node)}d3g(a,
b){a=b.property;b=b.node;if(a===sb.a.LJa||a===sb.a.jnc||a===tb.a.Lxa||a===tb.a.ufa||a===tb.a.BA){if(a===tb.a.Lxa||a===tb.a.BA)b.knc=!1;a!==sb.a.LJa&&a!==sb.a.jnc||this.Psg(b);this.i4b(b)}}udk(a){Array.contains(this.mRe,a)||(this.i4b(a),this.mRe.push(a))}f1g(){Array.clear(this.mRe)}gDj(a){this.t5c.remove(a.id)}Psg(a){a=a.id;this.mva.remove(a);this.y5c.remove(a);this.x5c.remove(a)}nPc(a){const b=a.id;this.t5c.Jb(b)||this.t5c.$(b,this.tak(this.y3d(a)));return this.t5c.ga(b)}U1b(a){const b=a.id;if(this.mva.Jb(b))return this.mva.ga(b);
var c=a.sa(sb.a.LJa,null);if(!c)return null;let f=null;const l=Uq.n3f(c);l&&a.Fh&&(f=a.Fh.te(l));a=null;if(f)a=Kj.a.DQa(f,sb.a.tableStyle);else if(c=this.Wda.Ngg("{"+c.toString()+"}"))a=c.mva;a&&this.mva.$(b,a);return a}p1d(a){return a.tableLook}J7(a,b){a=this.Jk.Cpb(a,b);return this.H8.Ie(a,0)}C0i(a){if(a.Sa(sb.a.iR))switch(a.sa(sb.a.iR,0)){case 2:return"bottom";case 1:return"middle"}return"top"}I9f(a){var b=null;if(!a)return null;if(a.cellShading){var c=TK(a.cellShading);Nz(c)||(b=c)}b||(b=this.qsa(a,
sb.a.cellShading,ml.a.grb));c=Object(ua.a)(119,this.lc.ig(a));b=this.Jk.$ob(b,c?c.Pe:null,this.E0c);a.rowIndex||1!==a.ni||Aa.a.J(9242778,822,50,"CellId={0} BGCss={1}",a.id.toString(),b);return b}uMc(a){var b=null;let c=null;if(!a)return null;if(a.cellShading){const f=TK(a.cellShading);Nz(f)||(b=f)}b||(b=this.qsa(a,sb.a.cellShading,ml.a.grb));a=(a=Object(ua.a)(119,this.lc.ig(a)))?a.Pe:null;(b=b.solidFillField)&&(c=uf.Box4ColorHelper.vCa(b,a));return c}A7a(a){var b=null;var c=Object(ua.a)(5,a);c&&(a=
c.sa(Mb.a.listLevel,og.a.pDa),c=this.Nb.Kc(c),c.pc(7)&&Jd.TableReader.hs(c)&&(c=Object(ua.a)(Vl.TableCellNode,c.Rg(16))))&&(this.s8g(c),b=1+a,b=this.ZG.D9f(c,this.pPc(c),b));return{tableStyle:b,I4a:null}}ohj(a){let b=Kj.a.xi(a,sb.a.cellShading,ml.a.grb);if(Nz(b)){const c=this.U1b(a);c&&(b=this.Jk.c0d(c))}a=Object(ua.a)(119,this.lc.ig(a));return this.Jk.$ob(b,a?a.Pe:null)}r3i(a){return!re.a("PPTOEnableTableDiagonalBorders")||2!==a&&1!==a?ml.a.frb:ml.a.GFi}H4i(a,b){if(this.f6j&&this.Eo.US&&!this.hFj(a,
b))return new Mx("","");var c=Object(ua.a)(127,a);if(({fOa:x,Y3a:G,hpb:R}=Vp.$Qa(b)).returnValue)if(this.OUa&&re.a("TableBordersLocalRenderingFix")){var f=this.qsa(c,x,this.r3i(b),!0);var l=this.qsa(c,R,ml.a.erb,!0);var x=c.sa(x,f);f={};if(re.a("FixClearTableBorder")){let fa=this.Nb.Kc(c);fa.pc(14);if(fa.Rg(14).Sa(sb.a.LJa)){f.Color="##T,0,0,0";f=uf.Box4ColorHelper.sY(f);f=this.qsa(c,G,f,!0);var G=Kj.a.xi(c,G,f);G=uf.Box4ColorHelper.xxa(G);a=this.lc.ig(a);a=(a=uf.Box4ColorHelper.UL(G,a?a.Pe:null))?
uf.Box4ColorHelper.Jna(a):null}else f.Color="#000000",a=uf.Box4ColorHelper.sY(f),a=uf.Box4ColorHelper.Mra(a)}else f.Color="##T,0,0,0",f=uf.Box4ColorHelper.sY(f),f=this.qsa(c,G,f,!0),G=Kj.a.xi(c,G,f),G=uf.Box4ColorHelper.xxa(G),a=this.lc.ig(a),a=(a=uf.Box4ColorHelper.UL(G,a?a.Pe:null))?uf.Box4ColorHelper.Jna(a):null;l=c.sa(R,l)}else l=this.Jk.M3d(b,c),x=l.Sa(x)?l.getValue(x):this.qsa(c,x,ml.a.frb,!0),a=this.A9f(l,c,G),l=l.Sa(R)?l.getValue(R):this.qsa(c,R,ml.a.erb,!0);else x=ml.a.frb,a=ml.a.BHc,l=ml.a.erb;
5!==b||a.UC===Hb.a.auto||c.rowIndex||1!==c.ni||Aa.a.J(9242780,822,50,"CellId={0} BGR={1} Alpha={2}",c.id.toString(),a.UC,a.alpha);var R=!1;a.UC!==Hb.a.auto||7!==b&&5!==b||(f=this.Nb.Kc(c),f.pc(14),7===b?(G=sb.a.Gxa,f=this.Jk.Wkj(f)):(G=sb.a.Hxa,f=this.Jk.alj(f)),f&&(c=this.Jk.M3d(b,c),this.A9f(c,f,G).UC===Hb.a.auto&&(l=ml.a.erb,x=ml.a.ulj,a=ml.a.tlj,R=!0)));c=this.Jk.cZd(l,x,a);return R&&7===b?new Mx(c,"Top"):R&&5===b?new Mx(c,"Left"):new Mx(c,"")}iNc(a,b){switch(b){case 7:b=sb.a.Jxa;break;case 6:b=
sb.a.tfa;break;case 0:b=sb.a.sfa;break;case 5:b=sb.a.Ixa;break;default:b=null}const c=this.qsa(a,b,ml.a.frb,!0);return a.sa(b,c)}hFj(a,b){if(!a||a.isGhostCell||2===b||1===b)return!0;const c=this.Nb.Kc(a);if(!c.pc(14))return!0;var f=c.Dw(14);if(!f.Ap())return!0;const l=a.rowSpan,x=a.colSpan;if(1===l&&1===x)return!0;f=this.tc.lhj(f);const G=new gr.a;G.ge=this.OVa.mdj(c);G.Zf=G.ge+l;G.$d=this.$I.EMc(Object(ua.a)(127,a));G.Lf=G.$d+x;switch(b){default:Aa.a.J(560562957,822,15," Unknown position type: {0} ",
b);break;case 5:if(!G.$d||1===l)break;if(4!==(f.$r(G.ge,G.$d-1)&4)||8!==(f.$r(G.Zf-1,G.$d-1)&8))break;for(a=G.ge+1;a<G.Zf;++a)if(4===(f.$r(a,G.$d-1)&4))return!1;break;case 6:if(G.Lf===f.TQ||1===l)break;if(4!==(f.$r(G.ge,G.Lf)&4)||8!==(f.$r(G.Zf-1,G.Lf)&8))break;for(a=G.ge+1;a<G.Zf;++a)if(4===(f.$r(a,G.Lf)&4))return!1;break;case 7:if(!G.ge||1===x)break;if(1!==(f.$r(G.ge-1,G.$d)&1)||2!==(f.$r(G.ge-1,G.Lf-1)&2))break;for(a=G.$d+1;a<G.Lf;++a)if(1===(f.$r(G.ge-1,a)&1))return!1;break;case 0:if(G.Zf!==f.oO&&
1!==x&&1===(f.$r(G.Zf,G.$d)&1)&&2===(f.$r(G.Zf,G.Lf-1)&2))for(a=G.$d+1;a<G.Lf;++a)if(1===(f.$r(G.Zf,a)&1))return!1}return!0}A9f(a,b,c){if(this.OUa){const f=uf.Box4ColorHelper.sY({Color:"##T,0,0,0"});a=Kj.a.xi(a,c,f);a=uf.Box4ColorHelper.xxa(a);b=this.lc.ig(b);b=(b=uf.Box4ColorHelper.UL(a,b?b.Pe:null))?uf.Box4ColorHelper.Jna(b):null}else a.Sa(c)?(b=a.Xh(c),b=Object(Ma.a)(Hb.a,b)?b:new Hb.a(a.getValue(c))):b=this.qsa(b,c,ml.a.BHc,!0);this.E0c&&(b=new Hb.a(0,b.alpha));return b}i4b(a){const b=this.FFa?
this.Nb.j1d(a):this.Nb.Kc(a);let c=Object(ua.a)(157,b.Ji());for(a=Object(ua.a)(158,a);c;)c.$fd=!1,c=Object(ua.a)(157,b.yp());this.gDj(a);this.FFa?this.QCj(a):a.yca(4)}QCj(a){if(a&&a.isConnected)for(a=this.Nb.j1d(a),a=Xe.a.Xu(a);a.moveNext();)a.currentNode.anchor.rr(4)}vCl(a){a&&(this.pPc(a),this.U1b(a),this.nPc(a))}qsa(a,b,c,f=!1){if(!a)return c;var l=this.Nb.Kc(a);l.pc(14);l=l.Rg(14);var x=l.id;if(this.Ezb&&f){if(!l.Sa(sb.a.LJa))return c;x=a.rowIndex;a=a.ni;return(a=this.nPc(l).Y_i(l,x,a))&&a.Sa(b)?
a.Xh(b):c}this.s8g(a);f=a.xU;if(!f){if(!l.Sa(sb.a.LJa))return c;f=a.rowIndex;let G=a.ni;const R=a.rowSpan,fa=a.colSpan;this.y5c.Jb(x)||this.y5c.$(x,this.Hak(this.y3d(l)));f=this.y5c.ga(x).VZd(f,G,R,fa);a.xU=f}return f&&f.Sa(b)?f.Xh(b):c}Mji(a){const b=this.Nb.OQa();b.set(a);let c=0,f=Object(ua.a)(157,b.Ab(1));for(;f;)f.rowIndex=c,c++,f=Object(ua.a)(157,b.yp());a.knc=!0}SBk(a){let b=0;const c=a.rowIndex,f=this.Nb.OQa();f.set(a);let l=Object(ua.a)(127,f.Ab(1));for(;l;)l.rowIndex=c,l.ni=b,l.xU=null,
this.ZG.wVk(l),l.v1f(),l=Object(ua.a)(127,f.yp()),b++;a.$fd=!0}s8g(a){var b=this.Nb.Kc(a);b.pc(14);a=Object(ua.a)(157,b.Rg(15));(b=Object(ua.a)(158,b.Rg(14)))&&!b.knc&&this.Mji(b);a&&!a.$fd&&this.SBk(a)}}Object(e.a)(Pz,"TableStyleReader",null,[1039,1040,1041]);class Hl extends hm{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc){super(a,b,c);this.y1c=this.$x=this.mBb=this.Lta=this.PG=null;this.tcc=l;this.Jk=x;this.Eo=G;this.De=R;this.S_=[];this.uc=f;this.Ubb=mb;this.jc=Kb;this.lc=nc;this.aj=
oc;this.Gzb=wa.pptIsTableColumnRowResizeHandleRenderedByCSSEnabled;this.ume=wa.pptComplexTableLayoutSyncEnabled;this.D_=wa.dja;this.bPg=Wa;this.tc=Ic;this.Nb=Kc;this.Hne=wa.j$;this.p1c=wa.mxh;if(Hc)this.$x=Hc;else throw Error.argumentNull("slideDimensionsHelper");if(this.Oc.$o){if(this.PG=fa?fa(a):null)this.PG.MBh(),this.vk&&this.vk.nU&&(this.PG.nei(this,this.vk.nU,this.table),this.PG.xx(!this.jc.un));re.a("DeprecateIE.TableViewElement.ctor")||!this.Eo.i9a&&!this.Eo.k9a||(this.htmlElement.style.backgroundColor=
"rgba(0,0,0,0)")}this.vk&&(this.vk.l6h(Object(C.a)(this,this.d2g,"onShapeEnterTextEditing")),this.vk.CFf(Object(C.a)(this,this.m2g,"onShapeSelectionChanged")),this.vk.n6h(Object(C.a)(this,this.e2g,"onShapeExitTextEditing")),this.vk.P5h(Object(C.a)(this,this.DYg,"onAfterDraw")),this.vk.u7h(Object(C.a)(this,this.z1g,"onReadModeChanged")),this.vk.j6h(Object(C.a)(this,this.$Zg,"onDisplayOnActiveSlide")))}get ooi(){return this.PG}$Zg(){this.$Qe()}get vk(){if(this.Lta)return this.Lta;if(this.Oc.$o){const a=
eh.a.mb(this.Oc.Ma,this.$a);a.af();a.XXa();this.Lta=Object(ua.a)(121,a.ePa)}return this.Lta}g2d(){if(!this.p1c)return 1;var a=this.lc.ig(this.$a);if(!a)return 1;var b=a.oc(this.Ma);if(!b)return 1;b=b.rba?b.rba.xa.style.visibility===Qi.a.visible:!1;var c=new dr.a(a.hq,a.Kk);if(!this.$x)return 1;b=this.$x.D1b(c,b).AO;c=this.aj.mG;a=this.uc.bPc(a)*c;return b/a}ukh(a){if(1!==a&&this.p1c){var b=this.tc.Zia(this.$a);for(var c of b)b=this.Gd.Fd.Ie(c.sa(sb.a.au,0),1)*a,c.oc(this.Ma).htmlElement.style.height=
b+"px";c=Nn.b(this.$a);for(b=0;b<c.length;b++){const f=this.Gd.Fd.Ie(c[b],0)*a;this.rFc.childNodes[b].style.width=f+"px"}}}oy(a){super.oy(a);this.ukh(this.g2d());this.Pyh(this.Ubb.Nvb?!!this.vk&&this.vk.NK()&&(this.vk.LA||this.vk.Kn):!!this.vk&&this.vk.Kn)}eU(){const a=this.tcc,b=Nn.b(this.$a),c=Jd.TableReader.wi(this.$a);let f=0;for(let l=0;l<c;l++)f+=Math.max(a.J7(this.$a,l),this.Gd.Fd.Ie(b[l],0));return new ul.a(0,f,0)}N5(a){super.N5(a);if(this.Oc.$o&&(a=this.bPg.XOc(this.$a,this.Ma))&&0!==a.LSc){const b=
this.$a;if(b.wN)return;this.ume?a.EDh(b):a.LSc&2?a.EDh(b):a.exl(b,c=>{c&&this.$Qe()})}this.$Qe()}$Qe(){this.PG&&this.vk&&this.vk.Kn&&this.ZQe()}Noh(a,b){Object(ua.a)(Pz,Uc.StyleReader.dr);if(1!==b)for(var c=0;c<this.M0.childNodes.length;c++){var f=this.M0.childNodes[c];if(!f||"TR"!==f.tagName.toUpperCase())continue;const x=f.offsetHeight*b;var l=this.Jk.VMd(this.$a,c);l=this.Gd.Fd.Ie(l,1);f.style.height=(x<l?0:x)+"px"}if(1!==a)for(b=0;b<this.rFc.childNodes.length;b++)c=$e.a.qn(this.rFc.childNodes[b].style.width),
f=this.Jk.Cpb(this.$a,b),f=this.Gd.Fd.Ie(f,0),this.slc(b,Math.max(c*a,f))}edj(a){a>this.M0.childNodes.length&&Error.argumentOutOfRange("rowIdx");const b=this.M0.childNodes[a];b&&"TR"===b.tagName.toUpperCase()||Error.invalidOperation(String.format("Child node '{0}' is not a table row",a));return $e.a.qn(b.style.height)}Q1b(){return th.a.Zba(this.De.ei(this.table))}get CKj(){const a=this.bPg.XOc(this.$a,this.Ma);return!a||0===a.LSc}efg(){const a=[0];for(let b=1;b<=this.M0.childNodes.length;++b)a[b]=
a[b-1]+this.M0.childNodes[b-1].offsetHeight;return a}$9f(){const a=[0];for(let b=1;b<=this.rFc.childNodes.length;++b)a[b]=a[b-1]+this.DMc(b-1);return a}FGe(a){if(14!==this.$a.type)Aa.a.J(512497121,808,10,"The source node of the table view element is not a table node but {0}",this.$a.type);else if(this.$a.sa(sb.a.complexTable,!0))Aa.a.J(512497118,808,50,"Disable column resizing for table with merged cells");else{super.FGe(a);a=new nb.GraphIterator;a.set(this.$a);Qd.moveToFirstRow(a);Qd.moveToFirstColumn(a);
let b=1;const c=this.Gd.Fd.Ie(this.Jk.o0b(a.currentNode,6),0);for(;!Se.isLastCellInRow(a);){Qd.moveToNextColumn(a);const f=this.Pu[b++],l=$e.a.Nc(-1*c);Jd.TableReader.jm(this.$a)?f.style.marginRight=l:f.style.marginLeft=l}this.Pu.length!==b&&Aa.a.J(512497119,808,10,"Table has inconsistent column resize handles: {0} handles, {1} columns",this.Pu.length,b)}}Q$(a){super.Q$(a);this.Oc.Kl||this.MTk();this.$a.sa(sb.a.complexTable,!0)||Ym.a.nv||this.LTk()}dispose(){super.dispose();this.PG&&(this.PG.dispose(),
this.PG=null);this.vk&&(this.vk.NRk(Object(C.a)(this,this.d2g,"onShapeEnterTextEditing")),this.vk.Kfh(Object(C.a)(this,this.m2g,"onShapeSelectionChanged")),this.vk.ORk(Object(C.a)(this,this.e2g,"onShapeExitTextEditing")),this.vk.xRk(Object(C.a)(this,this.DYg,"onAfterDraw")),this.vk.BSk(Object(C.a)(this,this.z1g,"onReadModeChanged")),this.vk.LRk(Object(C.a)(this,this.$Zg,"onDisplayOnActiveSlide")));this.Lta=null}DYg(){this.vk.BN&&this.ZQe(!0)}hmi(){if(this.Hne){var a=this.$a,b=a.S1b();if(a.knc)for(const c of b){a=
c;if(!a)continue;a=a.oc(this.Ma);if(!a)continue;b=this.tcc.iNc(c,7);const f=this.tcc.iNc(c,6),l=this.tcc.iNc(c,0),x=this.tcc.iNc(c,5);0===b&&a.ged("Top");0===f&&a.ged("Right");0===l&&a.ged("Bottom");0===x&&a.ged("Left")}}}m2g(a,b){this.Pyh(b.isSelected);a=this.table;this.hmi();b.isSelected?Sys.UI.DomElement.containsCssClass(a,"Selected_Table")||Sys.UI.DomElement.addCssClass(a,"Selected_Table"):Sys.UI.DomElement.containsCssClass(a,"Selected_Table")&&Sys.UI.DomElement.removeCssClass(a,"Selected_Table")}z1g(a,
b){this.PG&&this.PG.xx(b.$Nj)}Pyh(a){if(this.PG)if(this.D_){const b=this.Nb.Kc(this.$a);b.af();b.XXa().getValue(sb.a.isResizable)?this.PG.visible=a:this.PG.visible=!1}else this.PG.visible=a;this.vk&&this.vk.Nd&&this.vk.shapeNode&&this.vk.shapeNode.jQ&&(this.vk.Nd.visible=a)}LTk(){if(!this.S_.length){var a=this.UOa();Sys.UI.DomElement.addCssClass(a,"First");this.S_.push(a);a=this.uCi();Sys.UI.DomElement.addCssClass(Hl.zbg(a),"Last");this.S_.push(a)}var b=this.dRa();a=b.length;var c=a+1-this.S_.length;
if(!(0>=a)){if(0<c)for(var f=0;f<c;f++){let l=this.UOa();this.S_.splice(this.S_.length-1,0,l)}if(0>c){for(f=0;f<c;f++)this.IFb(this.S_[f+1]);this.S_.splice(1,c)}for(c=0;c<a;c++)f=b[c].firstChild,f.insertBefore(this.S_[c],f.firstChild);b=b[a-1].firstChild;b.insertBefore(this.S_[a],b.firstChild);this.i9h()}}i9h(){const a=new nb.GraphIterator;a.set(this.$a);Qd.moveToFirstRow(a);Qd.moveToFirstColumn(a);let b=1;for(;b<this.S_.length;){var c=this.Gd.Fd.Ie(this.Jk.o0b(a.currentNode,5),0),f=this.Gd.Fd.Ie(this.Jk.o0b(a.currentNode,
0),1);let l=this.S_[b];Hl.RQj(l)&&(l=Hl.zbg(l));c=$e.a.Nc(-1*c);f=$e.a.Nc(-1*f-(b===this.S_.length-1?4:0));Jd.TableReader.jm(this.$a)?l.style.marginRight=c:l.style.marginLeft=c;l.style.marginTop=f;Qd.moveToNextRow(a);b++}}MTk(){if(!this.mBb){const a=String.format("url('{0}'), pointer",vy.a.box4Image("RowSelect.cur"));this.mBb=this.Gd.createElement("div");this.mBb.className=Al.a.lml;Qc.c(this.mBb,!0);const b=this.Gd.createElement("div");b.className=Al.a.hRe;b.style.cursor=a;this.mBb.appendChild(b);
this.table.appendChild(this.mBb)}}gdj(){return this.dRa()}UOa(){const a=this.Gd.createElement("div");a.className="TableRowResizeHandle";a.style.width="100%";Qc.c(a,!0);return a}uCi(){const a=this.Gd.createElement("div");a.className="TableRowResizeAnchor";const b=this.UOa();a.appendChild(b);Qc.c(a,!0);return a}IFb(a){K.a.qIa(a);ya.a.vO(a)}dhj(a){var b=this.lc.ig(this.$a);let c=this.aj.mG;b&&b.Fw&&null!=b.Fw.Pr&&(c=b.Fw.Pr);b=this.uc.bPc(this.lc.ig(this.$a))*c;a=a.copy();a.move(-a.Yb,-a.$b);a.scale(1/
b,1/b);return a}d2g(){this.table.clientWidth&&this.ZQe(!0);!this.Ubb.Nvb&&this.PG&&(this.PG.visible=!0,this.vk&&this.vk.Nd&&(this.vk.Nd.visible=!0));this.vk&&this.vk.NK()&&!Sys.UI.DomElement.containsCssClass(this.table,"Selected_Table")&&Sys.UI.DomElement.addCssClass(this.table,"Selected_Table")}e2g(){this.PG&&(this.PG.visible=!1);this.vk&&this.vk.Nd&&(this.vk.Nd.visible=!1)}ZQe(a=!1){var b=this.Q1b();let c=Of.a.epd;this.y1c&&(c=th.a.d1b(b,this.y1c));const f=zc.a.YWe;a=!!this.vk&&(!this.y1c||!f.equals(zc.a.YWe)||
!c.equals(Of.a.epd)||a);this.y1c=b;if(a&&(a=this.vk.KUe,b=th.a.d1b(this.dhj(b),a),this.vk.setOffsets(b,!0),!re.a("DeprecateIE.TableViewElement.SynchronizeViews")&&this.Eo.i9a&&0<this.M0.childNodes.length))for(b=this.M0.childNodes[0].offsetWidth,a=0;a<this.S_.length;a++)this.S_[a].style.width=b+"px";this.PG&&this.PG.Gl();this.Gzb||this.QVe()}D2d(){return this.Gzb?null:super.D2d()}uCe(a){if(this.Gzb){var b=this.tc.jk(this.$a);a=Object(ua.a)(nb.GraphIterator,this.Nb.Kc(this.$a));Qd.forEachCellInTable(a,
(c,f,l)=>{c=c.currentNode;const x=c.oc(this.Ma);x&&x.Zoc(0,0,0,0,!f,f+c.rowSpan===b,!l);return!0})}else super.uCe(a)}l$i(a){let b=-1;var c=Jd.TableReader.wi(this.$a),f=Nn.b(this.$a);const l=Array(c);for(let x=0;x<c;x++)l[x]=Math.floor(this.Gd.Fd.Ie(f[x],0));if(Jd.TableReader.jm(this.$a))if(a<=Sys.UI.DomElement.getLocation(this.M0.firstChild.lastChild).x)b=c-1;else{a-=Sys.UI.DomElement.getLocation(this.M0.firstChild.lastChild).x;for(--c;0<=c;c--)if(a>=l[c])a-=l[c];else{b=c;break}-1===b&&(b=0)}else if(a<=
Sys.UI.DomElement.getLocation(this.M0.firstChild.firstChild).x)b=0;else{a-=Sys.UI.DomElement.getLocation(this.M0.firstChild.firstChild).x;for(f=0;f<c;f++)if(a>=l[f])a-=l[f];else{b=f;break}-1===b&&(b=c-1)}return b}klh(a,b,c=!0){const f=nb.GraphIterator.mb(this.$a),l=new nb.GraphIterator,x=new Id.GraphTransaction(2);x.iy(f);Qd.moveToFirstRow(f);c?(Qd.moveToRowByIndex(f,a),Qd.moveToFirstColumn(f)):Qd.moveToColumnByIndex(f,a);l.Pc(f);c?(Qd.moveToRowByIndex(l,b),Qd.moveToLastColumn(l)):(Qd.moveToColumnByIndex(l,
b),Qd.moveToLastRow(l));a=rd.SelectionFactory.QXb(f,l);this.Oc.Gb.qE(a);x.dispose()}static idj(a){return Hl.jdj(a,Ym.a.nv)}static jdj(a,b){return b?Hl.hdj(a):Hl.kdj(a)}static kdj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){Hl.Z$d(a)||Hl.Kae(a)||(b=b.previousSibling);break}b=b.parentNode}return Lv.Thg(b)}static hdj(a){let b=a;for(;b;){if("tr"===b.nodeName.toLowerCase()){if(Hl.Kae(a)){if((a=a.parentNode)&&void 0!==a.rowSpan&&null!==a.rowSpan){a=a.rowSpan;for(let c=1;c<a&&b;c++)b=b.nextSibling}}else Hl.Z$d(a)||
(b=b.previousSibling);break}b=b.parentNode}return b?Lv.Thg(b):null}static p3(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnResizeHandle")}static WSa(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeHandle")}static RQj(a){return Sys.UI.DomElement.containsCssClass(a,"TableRowResizeAnchor")}static ita(a){return Sys.UI.DomElement.containsCssClass(a,"TableColumnHandle")}static o6b(a){return Sys.UI.DomElement.containsCssClass(a,Al.a.hRe)}static khj(a){for(;a;){if("TABLE"===a.nodeName.toUpperCase())return a;
a=a.parentNode}return null}static Z$d(a){return Sys.UI.DomElement.containsCssClass(a,"First")}static Kae(a){return Sys.UI.DomElement.containsCssClass(a,"Last")}static Dvg(a){return Sys.UI.DomElement.containsCssClass(a,"FirstLeft")}static zbg(a){return a.firstChild}}Object(e.a)(Hl,"TableViewElement",hm,[1036,1037,1038,418,345,106]);class mL extends gL.a{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){super(a,b);this.WLf="ShowDashedLine";this.ala=this.Wd=this.Qd=this.YNg=this.SNg=this.fOg=this.Ebb=this.qpe=this.ppe=
this.ee=this.$Ng=null;this.SPg=this.RPg=this.k4=this.j4=this.hcb=this.Mda=0;this.C9=c;this.Wab=f;this.vs=l;this.tc=x;this.ra=G;this.bA=R;this.ia=fa;this.Fp=Wa;this.w$b=this.yme=!1;this.g6j=wa}get DHe(){this.XOf();return this.ee.offsetLeft}set DHe(a){this.XOf();this.ee.style.left=$e.a.Nc(a)}get zoom(){return 1}Du(a){const b=super.Du(a);if(b&&this.DM){this.QMd(a.Ac);Sys.UI.DomElement.addCssClass(this.ee,this.WLf);if(this.vaa=Hl.Dvg(a.Ac))this.li=0,this.PE=this.fl.DMc(this.li);this.Qd=this.fl.vk;this.Wd=
this.tc.T1b(this.Qd.$a);this.w$b=!1;this.QMe()&&this.z1i(a)}else b&&!this.DM&&(a=a.Ac,Hl.ita(a)&&(Aa.a.J(512497184,816,50,"Drag from table column handle"),this.li=parseInt(a.parentNode.getAttribute("columnindex").toString())));b&&this.Fp&&this.ia.processAction(E.a.Dia,2);return b}mw(a){this.DM?(a=this.WMf(a.clientPoint.x),this.DHe=this.$Ng+(a-this.PE)*(this.vaa?-1:1)):(a=this.fl.l$i(a.clientPoint.x),this.fl.klh(this.li,a,!1));return!0}Sn(a){if(this.DM){const f=this.C9.zi("UserAction","PPTColumnResize");
a&&Aa.a.J(8959051,822,50,String.format("Start Column resize for table: {0}, IsComplex: {1}",this.fl.$a.sa(sb.a.xCb,""),this.fl.$a.Ap()));const l=new Id.GraphTransaction(15);l.gd(this.fl.$a);const x=this.fl.$a.sa(tb.a.Iu,null);var b=this.WMf(a.clientPoint.x),c=this.fl.Gd.Fd;const G=c.Ff(b,0);(this.vaa||this.li===this.$F-1)&&this.vs.vYa(this.fl.$a,this.li,G);if(this.vaa&&b!==this.PE&&(b=this.PE-b)){this.Qd.setPosition(this.Qd.x+b,this.Qd.y,!0);b=c.Ff(this.Qd.x,0);c=c.Ff(this.Qd.y,1);const R=this.fl.vk.shapeNode;
R.fz=b;R.gz=c}!this.vaa&&this.li<this.$F-1&&this.JLe(G,x);this.moc();l.dispose();Cb.App.Hb.updateCommandUI();this.end();this.Wd?this.vs.BXa(this.Wd):Aa.a.J(512497183,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");f&&f.stop();a&&Aa.a.J(8959053,822,50,String.format("End Column resize for table: {0}, IsComplex: {1}, IsFirstColumnLeftResizeHandle: {2}",this.fl.$a.sa(sb.a.xCb,""),this.fl.$a.Ap(),this.vaa))}else a&&Cb.App.Hb.p5(a.clientPoint,a.Wf),super.Sn(a)}Yt(a){super.Yt(a);
this.DM&&this.moc()}Igg(){return null}XOf(){if(!this.ee)throw Error.argumentNull("m_element","Try to use the resize handle before it is initialized");if(!Ym.a.p3(this.ee))throw Error.invalidOperation("Element is not the table column resize handle");}QMd(a){this.ee=a;this.$Ng=this.DHe;this.ppe=this.ee.style.marginLeft;this.qpe=this.ee.style.marginRight;this.Ebb=this.ee.style.height;this.fOg=this.ee.style.top;this.SNg=this.ee.style.bottom;this.YNg=this.ee.style.left;this.ee.style.marginLeft=this.ee.style.marginRight=
"auto";this.ee.style.top="0";this.ee.style.height="auto";this.ee.style.bottom="0";this.Wab&&(a=Ym.a.V1b(a))&&(this.ee.style.top=-a.offsetTop+"px",this.ee.style.bottom=-(this.fl.getBounds().height-a.offsetTop-a.offsetHeight)+"px")}moc(){this.ee&&(Sys.UI.DomElement.removeCssClass(this.ee,this.WLf),this.ee.style.marginLeft=this.ppe,this.ee.style.marginRight=this.qpe,this.ppe=this.qpe="auto",this.ee.style.left=this.g6j?this.YNg:"auto",this.ee.style.top=this.fOg,this.ee.style.height=this.Ebb,this.ee.style.bottom=
this.SNg,this.ee=null)}z1i(a){this.w$b=this.yme=!1;a=a.Ac;if(Ym.a.p3(a)){var b=null,c=null;({Y9a:b,$fb:c}=this.y1i(a,b,c)).returnValue&&this.j2i(b,c)&&this.C2d()&&this.Wd&&(a=this.tc.wi(this.Wd),b=this.tc.jk(this.Wd),0<=this.Mda&&this.Mda<b&&0<=this.hcb&&this.hcb<b&&0<=this.j4&&this.j4<a&&0<=this.k4&&this.k4<a&&(this.w$b=!0))}}y1i(a,b,c){if(!Ym.a.p3(a)||!this.Wd)return{returnValue:!1,Y9a:b,$fb:c};var f=Ym.a.V1b(a);f=Qc.a(f);this.ala=Object(ua.a)(Vl.TableCellNode,f.$a);if(!this.ala)return{returnValue:!1,
Y9a:b,$fb:c};f=this.UNc(this.ala);if(0>f||f>=this.tc.wi(this.Wd))return{returnValue:!1,Y9a:b,$fb:c};const l=this.ala.rowIndex;if(0>l||l>=this.tc.jk(this.Wd))return{returnValue:!1,Y9a:b,$fb:c};if(Hl.Dvg(a))return{returnValue:!1,Y9a:null,$fb:c};b=this.Wd.jf(l,f);if(f===this.tc.wi(this.Wd)-1)return{returnValue:!1,Y9a:b,$fb:null};c=this.Wd.jf(l,f+1);return{returnValue:!0,Y9a:b,$fb:c}}j2i(a,b){if(!this.Wd||!a||!b)return!1;this.Mda=a.rowIndex;if(0>this.Mda||this.Mda>=this.tc.jk(this.Wd))return!1;this.hcb=
this.Mda;this.j4=this.E0b(a);if(0>this.j4||this.j4>=this.tc.wi(this.Wd))return!1;this.k4=this.UNc(b);if(0>this.k4||this.k4>=this.tc.wi(this.Wd))return!1;var c=this.iZi(a,b);a=c?this.N_i(a,b):!1;if(c=c&&a)this.yme=this.oHj(b.ni);return c}oHj(a){let b=!0;if(0<this.Mda)for(var c=this.Mda-1;0<=c;){var f=this.Wd.jf(c,a);if(f&&!f.isGhostCell){b=!1;break}--c}if(this.hcb<this.Wd.WX-1)for(c=this.Mda+1;c<=this.Wd.WX-1;){if((f=this.Wd.jf(c,a))&&!f.isGhostCell){b=!1;break}c+=1}return b}C2d(){if(!this.Wd)return!1;
const a=this.tc.wi(this.Wd);if(0>this.j4||this.j4>=a||0>this.k4||this.k4>=a||0>this.li||this.li>=a||0>this.li+1||this.li+1>=a)return!1;this.RPg=this.v4d(this.Wd,this.j4,this.li)-this.A1d(this.Wd,this.j4);this.SPg=this.v4d(this.Wd,this.k4,this.li+1)-this.A1d(this.Wd,this.k4);return!0}v4d(a,b,c){if(b>c)return this.v4d(a,c,b);if(!a||0>b||b>=this.tc.wi(a)||0>c||c>=this.tc.wi(a))return-1;a=a.g_d;let f=0;for(;b<=c;b++)f+=a[b];return Math.floor(this.fl.Gd.Fd.Ie(f,0))}A1d(a,b){return Uc.StyleReader.dr?Uc.StyleReader.dr.J7(a,
b):On.a.dld}KCa(a,b){return this.fl.Gd.Fd.Ff(this.A1d(a,b),0)}iZi(a,b){if(!a||!b)return!1;a=a.w0b();const c=b.ni;for(b=b.w0b();b&&(!b.isGhostCell||this.E0b(b)===c);)this.Mda--,this.j4=Math.max(this.j4,this.E0b(a)),this.k4=Math.min(this.k4,this.UNc(b)),a=a.w0b(),b=b.w0b();return!0}N_i(a,b){if(!a||!b)return!1;a=a.sMc();const c=b.ni;for(b=b.sMc();b&&(!a.isGhostCell||this.E0b(b)===c);)this.hcb++,this.j4=Math.max(this.j4,this.E0b(a)),this.k4=Math.min(this.k4,this.UNc(b)),a=a.sMc(),b=b.sMc();return!0}E0b(a){return a?
(a=a.Gy())?a.ni:-1:-1}UNc(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.Gy());a=null;b&&(a=b.P0d(2));return a?a.ni:-1}WMf(a){this.QMe()&&this.w$b?(a=this.fl.$a.FOj?Math.floor((this.x6-a)/this.zoom)+this.PE:Math.floor((a-this.x6)/this.zoom)+this.PE,a=Math.min(a,this.PE+this.SPg),a=Math.max(a,this.PE-this.RPg)):a=this.WMd(a);return a}JLe(a,b){if(this.QMe()&&this.w$b){if(!this.ra.JG()){var c=rd.SelectionFactory.Mg(Object(ua.a)(lg.a,this.ala.C_b),0);this.ra.setSelection(c)}let f=c=-1,l=-1;({u_f:c,OZf:f,
PZf:l}=this.s4i(a-b[this.li],b,c,f,l));this.yme&&(c===this.li&&Math.abs(f)>=this.KCa(this.Wd,c)||c===this.li+1&&c<this.tc.wi(this.Wd)-1&&Math.abs(l)>=this.KCa(this.Wd,c+1)||c===this.li+1&&c===this.tc.wi(this.Wd)-1)?(Aa.a.J(512497182,815,50,"DragAcrossColumn: scenario-1, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.li.toString(),c.toString(),f.toString(),l.toString()),a=b[this.li]+b[this.li+1],c===this.li?(f=Math.max(f,this.KCa(this.Wd,
c)),l=a-f):c===this.li+1&&(l=Math.max(l,this.KCa(this.Wd,c)),f=a-l),this.vs.vYa(this.Wd,this.li,f),this.vs.vYa(this.Wd,this.li+1,l)):(c>this.j4&&Math.abs(f)<this.KCa(this.Wd,c)?(Aa.a.J(512497181,815,50,"DragAcrossColumn: scenario-2, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.li.toString(),c.toString(),f.toString(),l.toString()),this.pdb(c,this.li+1)):c<this.k4&&Math.abs(l)<this.KCa(this.Wd,c+1)?(Aa.a.J(512497180,815,50,"DragAcrossColumn: scenario-3, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",
this.li.toString(),c.toString(),f.toString(),l.toString()),this.pdb(c+1,this.li+1)):(Aa.a.J(512497179,815,50,"DragAcrossColumn: scenario-4, _originColumn = {0}, dragEndInColumnIndex = {1}, distanceWithLeftBorder = {2}, distanceWithRightBorder = {3}",this.li.toString(),c.toString(),f.toString(),l.toString()),this.Yhl(c,f,l)),this.vs.$Fe(this.Wd),a=nb.GraphIterator.mb(this.Wd),this.vs.SUe(a),this.Wd.yca(511),this.bA.i4b(this.Wd))}else this.vs.vYa(this.Wd,this.li,a),this.vs.vYa(this.Wd,this.li+1,b[this.li]+
b[this.li+1]-a)}s4i(a,b,c,f,l){if(!a)return c=this.li,f=b[this.li],{u_f:c,OZf:f,PZf:0};f=0;if(0<a){for(c=this.li;f<=a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.li+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{u_f:c,OZf:f,PZf:l}}pdb(a,b){if(b!==a){var c=this.l2i(b-1);for(let f=this.Mda;f<=this.hcb;f++){const l=this.Wd.jf(f,b),x=this.Wd.jf(f,a);this.Iue(c[f],l,x)}}}Iue(a,b,c){if(c.isGhostCell){var f=b.rowSpan,l=a.colSpan+c.ni-b.ni,x=a.colSpan+b.colSpan-l;tm.c(Object(ua.a)(lg.a,b),Object(ua.a)(lg.a,c),
this.vs.FNd);tm.c(Object(ua.a)(lg.a,b),Object(ua.a)(lg.a,c),[sb.a.jIa]);var G=nb.GraphIterator.mb(c);G.af();var R=new nb.GraphIterator;R.set(Object(ua.a)(lg.a,b));R.Ab(1)&&tm.h(G,null,1,1,R,-1);c.isGhostCell=b.isGhostCell;this.$Xd(G);b.Un(sb.a.rowSpan,sb.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=x,c.rowSpan=f);a.rowIndex===c.rowIndex&&(a.colSpan=l)}}$Xd(a){const b=a.currentNode.getValue(sb.a.rowId),c=a.currentNode.getValue(sb.a.cellId);for(a=Xe.a.Xu(a);a.moveNext();){const f=a.currentNode.sa(sb.a.cellId,
null);a.currentNode.sa(sb.a.rowId,null)&&a.currentNode.setValue(sb.a.rowId,b);f&&a.currentNode.setValue(sb.a.cellId,c)}}Yhl(a,b,c){var f=nb.GraphIterator.mb(this.Wd);Qd.moveToFirstRow(f);f.Rp(a,1);this.vs.E8d(f);if(f=this.Wd.sa(tb.a.Iu,null))f=Qa.a.clone(f),b<this.KCa(this.Wd,a)?(b=this.KCa(this.Wd,a),c=f[a]-b):(c=Math.max(c,this.KCa(this.Wd,a+1)),b=f[a]-c),f[a]=b,f[a+1]=c,this.Wd.setValue(tb.a.Iu,f);b=this.li+1;a+=1;a<=b&&(b+=1);this.pdb(a,b)}l2i(a){const b=Array(this.tc.jk(this.Wd));for(let c=this.Mda;c<=
this.hcb;c++){const f=this.Wd.jf(c,a);b[c]=f.Gy()}return b}QMe(){return!!this.Wd&&this.Wd.Ap()&&!this.vaa&&this.li<this.$F-1}}Object(e.a)(mL,"PowerPointColumnDragAdapter",gL.a,[]);class KD{constructor(a,b){this.lx=this.v4=null;this.Dac=this.zbb=0;this.cBb=!1;this.X8=a;this.o_=b}mv(a){if(3===a.Wf)return!1;a=a.Ac;return Hl.WSa(a)||Hl.o6b(a)}Yt(){if(this.cBb){const a=new Id.GraphTransaction(3);a.gd(this.v4.$a);this.v4.source.kv(4,!0);a.dispose()}this.end()}end(){this.X8.hR()}dispose(){this.v4=null}}
Object(e.a)(KD,"CommonRowHandleDragAdapter",null,[232,106]);class nL extends KD{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){super(a,b);this.Nme=this.xzb=!1;this.VNg=this.OFa=0;this.ala=this.Wd=this.Qd=this.Qua=this.ZNg=this.XNg=this.TNg=this.WNg=this.UNg=null;this.eOg=this.Ne=this.QPg=this.PPg=this.i4=this.h4=this.sGa=this.Q_=this.Zz=0;this.C9=f;this.Dq=c;this.Jk=l;this.Wab=x;this.vs=G;this.tc=R;this.ra=fa;this.bA=wa;this.yak=Wa;this.ia=Kb;this.Fp=nc;this.MVa=null;this.x$b=this.M0c=this.B0c=!1;
this.$q=mb}Du(a){if(!this.mv(a))return!1;const b=a.Ac;if(Hl.o6b(b)){Aa.a.J(512497178,816,50,"drag from table row handle");this.cBb=!1;var c=Hl.khj(b);if(!c)return!1;this.Wd=Qc.a(c).$a;this.lx=this.Wd.oc(this.Ne);if(!this.lx)return Aa.a.J(512497177,816,10,"OnDragStart : m_tableViewElement is null"),!1;this.eOg=this.$q.E1d(this.lx,a.clientPoint);this.o_.Tad(b);return!0}this.v4=Hl.idj(b);if(!this.v4)return!1;c=Object(ua.a)(157,this.v4.$a);this.Ne=this.v4.Ma;this.Wd=c?c.getContainingTable():null;if(!this.Wd)return!1;
this.lx=this.Wd.oc(this.Ne);this.MVa=this.yak.k1d(this.Wd);if(!this.lx||!this.MVa)return!1;this.xzb=Hl.Z$d(b);this.Nme=Hl.Kae(b);this.zbb=this.v4.htmlElement.offsetHeight;this.Dac=this.OFa=a.clientPoint.y;this.o_.Yk(21);this.X8.endEditing(!0,14);this.Qd=this.lx.vk;this.M0c=this.B0c=this.x$b=!1;this.cBb=!0;this.RMe()&&this.qdj(b);this.QMd(b);this.Fp&&this.ia.processAction(E.a.Dia,2);return!0}mw(a){this.cBb?(this.OFa=a.clientPoint.y,a=(this.$Mf(this.OFa)-this.zbb)*(this.xzb?-1:1)+this.VNg,this.Qua.style.top=
a+"px"):(a=this.$q.E1d(this.lx,a.clientPoint),this.lx.klh(this.eOg,a));return!0}Sn(a){let b=null;a&&(b=this.C9.zi("UserAction","PPTRowResize"),Aa.a.J(512497175,822,50,String.format("Start Row resize for table: {0}, IsComplex: {1}",this.lx.$a.sa(sb.a.xCb,""),this.lx.$a.Ap())));if(this.cBb){var c=this.$Mf(a?a.clientPoint.y:this.OFa),f=new Id.GraphTransaction(15);if(this.RMe()&&this.x$b&&this.M0c)Me.a.mark(11077),f.gd(this.Wd),this.JLe(c);else{this.v4.LHb(c);var l=this.v4.htmlElement.offsetHeight;Me.a.mark(11077);
var x=this.v4.$a;f.gd(x);c=this.X8.Fd;x.setValue(sb.a.au,c.Ff(l,1));this.xzb&&l!==this.zbb&&(l=this.zbb-l)&&(this.Qd.setPosition(this.Qd.x,this.Qd.y+l,!0),l=c.Ff(this.Qd.x,0),c=c.Ff(this.Qd.y,1),x=this.lx.vk.shapeNode,x.fz=l,x.gz=c)}this.moc();f.dispose();Cb.App.Hb.updateCommandUI();Me.a.mark(11078);this.end();this.Wd?this.vs.BXa(this.Wd):Aa.a.J(512497174,822,15," OnDragEnd: m_tableNode is null. Unable to Redraw Diagonal borders.");b&&b.stop();a&&Aa.a.J(512497173,822,50,String.format("End Row resize for table: {0}, IsComplex: {1}",
this.lx.$a.sa(sb.a.xCb,""),this.lx.$a.Ap()))}else a&&Cb.App.Hb.p5(a.clientPoint,a.Wf),this.o_.q0()}Yt(a){a.uTe?(super.Yt(a),this.cBb&&this.moc()):this.Sn(null)}end(){this.o_.q0();super.end()}$Mf(a){a=this.zbb+this.Dq.Hm(a-this.Dac)*(this.xzb?-1:1);if(this.RMe()&&this.x$b&&this.M0c)a=Math.min(a,this.zbb+this.QPg),a=Math.max(a,this.zbb-this.PPg);else{var b=this.Jk.NDc(this.v4.$a);b=this.v4.Gd.Fd.Ie(b,1);a=Math.max(b,a)}return a}QMd(a){this.Qua=a;Sys.UI.DomElement.addCssClass(this.Qua,"ShowDashedLine");
this.VNg=a.offsetTop;this.ZNg=a.style.marginTop;this.XNg=a.style.width;this.UNg=a.style.left;this.WNg=a.style.top;this.TNg=a.style.bottom;a.style.marginTop="auto";a.style.width="auto";a.style.right=a.style.left="0";a.style.bottom="auto";if(this.Wab){const b=Ym.a.V1b(a);b&&(a.style.left=-b.offsetLeft+"px",a.style.right=-(this.v4.getBounds().width-b.offsetLeft-b.offsetWidth)+"px")}}moc(){Sys.UI.DomElement.removeCssClass(this.Qua,"ShowDashedLine");this.Qua.style.marginTop=this.ZNg;this.Qua.style.width=
this.XNg;this.Qua.style.left=this.UNg;this.Qua.style.right="auto";this.Qua.style.top=this.WNg;this.Qua.style.bottom=this.TNg}qdj(a){this.x$b=this.B0c=!1;if(this.Wd&&Hl.WSa(a)){var b=null,c=null;({j3a:b,X3a:c}=this.pdj(a,b,c)).returnValue&&this.k2i(b,c)&&this.C2d()&&(a=this.tc.wi(this.Wd),b=this.tc.jk(this.Wd),0<=this.Q_&&this.Q_<a&&0<=this.sGa&&this.sGa<a&&0<=this.h4&&this.h4<b&&0<=this.i4&&this.i4<b&&(this.x$b=!0),this.M0c=0<this.Q_||this.sGa<a-1?!0:!1)}}pdj(a,b,c){if(!Hl.WSa(a)||!this.Wd)return{returnValue:!1,
j3a:b,X3a:c};a=Ym.a.V1b(a);a=Qc.a(a);this.ala=Object(ua.a)(Vl.TableCellNode,a.$a);if(!this.ala)return{returnValue:!1,j3a:b,X3a:c};a=this.Zz=this.ala.rowIndex-1;if(0>a||a>=this.tc.jk(this.Wd))return{returnValue:!1,j3a:b,X3a:c};const f=this.ala.ni;if(0>f||f>=this.tc.wi(this.Wd))return{returnValue:!1,j3a:b,X3a:c};if(this.xzb)return{returnValue:!1,j3a:null,X3a:c};b=this.Wd.jf(a,f);if(this.Nme)return{returnValue:!1,j3a:b,X3a:null};c=this.Wd.jf(a+1,f);return{returnValue:!0,j3a:b,X3a:c}}k2i(a,b){if(!this.Wd||
!a||!b)return!1;this.Q_=a.ni;if(0>this.Q_||this.Q_>=this.tc.wi(this.Wd))return!1;this.sGa=this.Q_;var c=a.Gy();this.h4=c?c.rowIndex:-1;if(0>this.h4||this.h4>=this.tc.jk(this.Wd))return!1;this.i4=this.Q0d(b);if(0>this.i4||this.i4>=this.tc.jk(this.Wd))return!1;a=(c=this.m8i(a,b))?this.Ycj(a,b):!1;if(a=c&&a)this.B0c=this.pHj(b.rowIndex);return a}C2d(){if(!this.Wd)return!1;const a=this.tc.jk(this.Wd);if(0>this.h4||this.h4>=a||0>this.i4||this.i4>=a)return!1;this.PPg=this.A0d(this.Wd,this.h4,this.Zz)-this.RQa(this.Wd,
this.h4);this.QPg=this.A0d(this.Wd,this.i4,this.Zz+1)-this.RQa(this.Wd,this.i4);return!0}m8i(a,b){if(!a||!b)return!1;a=a.N6a();const c=b.rowIndex;for(b=b.N6a();b&&a;){var f=b.Gy();if(b.isGhostCell&&f&&f.rowIndex!==c)break;this.Q_--;if(f=a.Gy())this.h4=Math.max(this.h4,f.rowIndex);this.i4=Math.min(this.i4,this.Q0d(b));a=a.N6a();b=b.N6a()}return!0}Ycj(a,b){if(!a||!b)return!1;a=a.HZ();const c=b.rowIndex;for(b=b.HZ();b&&(!b.isGhostCell||b.Gy().rowIndex===c);)this.sGa++,this.h4=Math.max(this.h4,a.Gy().rowIndex),
this.i4=Math.min(this.i4,this.Q0d(b)),a=a.HZ(),b=b.HZ();return!0}pHj(a){let b=!0,c;if(0<this.Q_)for((c=this.Wd.jf(a,this.Q_))&&(c=c.N6a());c;){if(!c.isGhostCell){b=!1;break}c=c.N6a()}if(this.sGa<this.Wd.c7-1)for((c=this.Wd.jf(a,this.sGa))&&(c=c.HZ());c;){if(!c.isGhostCell){b=!1;break}c=c.HZ()}return b}Q0d(a){if(!a)return-1;let b=a;a.isGhostCell&&(b=a.Gy());return b&&(b=b.P0d(1))?b.rowIndex:-1}A0d(a,b,c){if(b>c)return this.A0d(a,c,b);if(!a||0>b||b>=this.tc.jk(a)||0>c||c>=this.tc.jk(a))return-1;for(a=
0;b<=c;b++)a+=this.MVa[b];return Math.floor(a)}RQa(a,b){a=this.Jk.VMd(a,b);return Math.floor(this.X8.Fd.Ie(a,1))}JLe(a){if(!this.ra.JG()){var b=this.ala.w0b().Gy().C_b;b=rd.SelectionFactory.Mg(Object(ua.a)(lg.a,b),0);this.ra.setSelection(b)}let c=b=-1;var f=-1;({v_f:b,MZf:c,NZf:f}=this.t4i(a-this.MVa[this.Zz],this.MVa,b,c,f));if(this.B0c&&(b===this.Zz&&Math.abs(c)>=this.RQa(this.Wd,this.Zz)||b===this.Zz+1&&b<this.tc.jk(this.Wd)&&Math.abs(f)>=this.RQa(this.Wd,this.Zz+1)||b===this.Zz+1&&b===this.tc.jk(this.Wd)-
1)){Aa.a.J(512497172,815,50,"DragAcrossRow: scenario-1, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.Zz.toString(),b.toString(),c.toString(),f.toString());f=nb.GraphIterator.mb(this.Wd);this.Sdc(f,this.Zz);a=f.currentNode;var l=this.MVa[this.Zz];const G=a.oc(this.Ne);Qd.moveToNextRow(f);f=f.currentNode;var x=this.MVa[this.Zz+1];const R=f.oc(this.Ne);x=l+x;l=this.X8.Fd;b===this.Zz+1&&(c+=this.MVa[this.Zz]);G.LHb(Math.floor(c));b=G.htmlElement.offsetHeight;
a.setValue(sb.a.au,l.Ff(b,1));b=x-b;b=Math.max(b,this.RQa(this.Wd,this.Zz+1));R.LHb(Math.floor(b));f.setValue(sb.a.au,l.Ff(R.htmlElement.offsetHeight,1))}else b>this.h4&&Math.abs(c)<this.RQa(this.Wd,b)?(Aa.a.J(512497171,815,50,"DragAcrossRow: scenario-2, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.Zz.toString(),b.toString(),c.toString(),f.toString()),this.pdb(b,this.Zz+1)):b<this.i4&&Math.abs(f)<this.RQa(this.Wd,b+1)?(Aa.a.J(512497170,
815,50,"DragAcrossRow: scenario-3, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.Zz.toString(),b.toString(),c.toString(),f.toString()),this.pdb(b+1,this.Zz+1)):(Aa.a.J(512497169,815,50,"DragAcrossRow: scenario-4, m_resizedRow = {0}, dragEndInRowIndex = {1}, distanceWithAboveBorder = {2}, distanceWithBelowBorder = {3}",this.Zz.toString(),b.toString(),c.toString(),f.toString()),this.Zhl(b,c,f)),this.vs.$Fe(this.Wd),b=nb.GraphIterator.mb(this.Wd),
this.vs.SUe(b),this.Wd.yca(511),this.bA.i4b(this.Wd)}t4i(a,b,c,f,l){if(!a)return c=this.Zz,f=b[this.Zz],{v_f:c,MZf:f,NZf:0};f=0;if(0<a){for(c=this.Zz;f<a;)c++,f+=b[c];l=f-a;f=b[c]-l}else{for(c=this.Zz+1;f>a;)c--,f-=b[c];f=a-f;l=b[c]-f}return{v_f:c,MZf:f,NZf:l}}pdb(a,b){if(b!==a){var c=this.m2i(b-1);b=this.Wd.jf(b,this.Q_);a=this.Wd.jf(a,this.Q_);for(let f=this.Q_;f<=this.sGa;f++)this.Iue(c[f],b,a),b=b.HZ(),a=a.HZ()}}Iue(a,b,c){if(c.isGhostCell){var f=b.colSpan,l=a.rowSpan+c.rowIndex-b.rowIndex,x=
a.rowSpan+b.rowSpan-l;tm.c(Object(ua.a)(lg.a,b),Object(ua.a)(lg.a,c),this.vs.FNd);tm.c(Object(ua.a)(lg.a,b),Object(ua.a)(lg.a,c),[sb.a.jIa]);var G=nb.GraphIterator.mb(c);G.af();var R=new nb.GraphIterator;R.set(Object(ua.a)(lg.a,b));R.Ab(1)&&tm.h(G,null,1,1,R,-1);c.isGhostCell=b.isGhostCell;this.$Xd(G);b.Un(sb.a.rowSpan,sb.a.colSpan);b.isGhostCell=!0;c.isGhostCell||(c.colSpan=f,c.rowSpan=x);a.ni===G.pq.ni&&(a.rowSpan=l)}}$Xd(a){const b=a.currentNode.getValue(sb.a.rowId),c=a.currentNode.getValue(sb.a.cellId);
for(a=Xe.a.Xu(a);a.moveNext();){const f=a.currentNode.sa(sb.a.cellId,null);a.currentNode.sa(sb.a.rowId,null)&&a.currentNode.setValue(sb.a.rowId,b);f&&a.currentNode.setValue(sb.a.cellId,c)}}Zhl(a,b,c){var f=nb.GraphIterator.mb(this.Wd);this.Sdc(f,a);const l=f.currentNode;f=this.vs.F8d(f);const x=this.X8.Fd,G=l.oc(this.Ne);G.LHb(Math.floor(b));l.setValue(sb.a.au,x.Ff(G.htmlElement.offsetHeight,1));c=Math.max(c,this.RQa(this.Wd,a+1));f.setValue(sb.a.au,x.Ff(Math.floor(c),1));b=this.Zz+1;a+=1;a<=b&&(b+=
1);this.pdb(a,b)}Sdc(a,b){if(!(14!==a.oi||0>b||b>=this.tc.jk(a.currentNode)))for(Qd.moveToFirstRow(a);0<b--;)Qd.moveToNextRow(a)}m2i(a){a=this.Wd.jf(a,this.Q_);const b=Array(this.tc.wi(this.Wd));for(let c=this.Q_;c<=this.sGa;c++)b[c]=a.Gy(),a=a.HZ();return b}RMe(){return!!this.Wd&&this.Wd.Ap()&&!this.xzb&&!this.Nme}}Object(e.a)(nL,"PowerpointRowHandleDragAdapter",KD,[]);class LD{constructor(a,b,c,f){this.bA=f;this.qFa=a;this.qFa.Yj(Object(C.a)(this,this.fh,"onPropertyChanged"))}fh(a,b){a=b.property;
(b=Object(ua.a)(127,b.node))&&(a===sb.a.colSpan||a===sb.a.rowSpan)&&(b=b.getContainingTable())&&(this.bA.udk(b),b.mY=null)}dispose(){this.qFa.tm(Object(C.a)(this,this.fh,"onPropertyChanged"))}}Object(e.a)(LD,"TableCellNodeBehavior",null,[106]);class oL extends Bc.a{constructor(a,b){super(a,b,"TableCellSelected")}dUg(a){this.selected&&!Sys.UI.DomElement.containsCssClass(a,this.nYa)?Sys.UI.DomElement.addCssClass(a,this.nYa):!this.selected&&Sys.UI.DomElement.containsCssClass(a,this.nYa)&&Sys.UI.DomElement.removeCssClass(a,
this.nYa)}}Object(e.a)(oL,"TableCellSelectionBehavior",Bc.a,[1045,558]);class pL extends Sys.EventArgs{constructor(a){super();this.xYh=a}get tableCellNode(){return this.Vll.tableCellNode}get Vll(){return this.xYh}}Object(e.a)(pL,"TableCellViewElementLockedEventArgs",Sys.EventArgs,[]);class MD extends Sys.EventArgs{constructor(a){super();this.TEi=a}}Object(e.a)(MD,"TypingLockStatusChangedEventArgs",Sys.EventArgs,[]);var Wp=d(186);class Qs extends Kv{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc){super(a,
b,f,l,fb.a.instance.resolve("Box4.ITableCellReader"),fb.a.instance.resolve("Box4.IParagraphReader"),fb.a.instance.resolve("Box4.IOutlineElementNavigator"),fb.a.instance.resolve("Box4.ITableNavigator"),fb.a.instance.resolve("Box4.IOutlineElementReader"),fb.a.instance.resolve("Box4.Styles.IStyleReader"),fb.a.instance.qb("Box4.IFeatureHelper"),new oL(a,b),fb.a.instance.qb("Box4.Styles.ITableCellspacingReader"),fb.a.instance.resolve("Box4.TableCellViewElementSettings"));this.ooe=this.poe=this.o5c=this.u5c=
this.KBb=this.Bh=this.Qcb=this.KN=this.SN=this.R_=null;this.Qka=!1;this.tka=null;this.ij=Object(ua.a)(127,b);this.Ea=c;this.bA=x;this.Jk=G;this.Lc=R;this.SEa=fa;this.tc=wa;this.Wab=Wa;this.Gzb=mb;this.D_=Kb;this.o1c=nc;this.k$b=re.a("PPTOEnableTableDiagonalBorders");this.ra=oc;this.Lta=this.t$f();(this.Wab||this.Gzb)&&Sys.UI.DomElement.addCssClass(this.htmlElement,"TableCellRelativePosition")}N5(){}oy(a){super.oy(a);this.Wab&&!this.Gd.Kl&&this.c3k()}uCa(a,b){return a&&a.length&&"none"!==a&&b&&b.length&&
b.endsWith("px")?parseFloat(b.substr(0,b.length-2)):0}Txg(){const a=this.ra.UZi(),b=this.ij.getContainingTable();return b?Array.contains(a,b):!1}gMk(a){switch(a){case "Top":this.Bh.style.top="-0.5px";this.Bh.style.borderTopWidth="1px";break;case "Right":this.Bh.style.right="-0.5px";this.Bh.style.borderRightWidth="1px";break;case "Bottom":this.Bh.style.bottom="-0.5px";this.Bh.style.borderBottomWidth="1px";break;case "Left":this.Bh.style.left="-0.5px",this.Bh.style.borderLeftWidth="1px"}}fMk(a){switch(a){case "Top":this.Bh.style.top=
"0px";this.Bh.style.borderTopWidth="0px";break;case "Right":this.Bh.style.right="0px";this.Bh.style.borderRightWidth="0px";break;case "Bottom":this.Bh.style.bottom="0px";this.Bh.style.borderBottomWidth="0px";break;case "Left":this.Bh.style.left="0px",this.Bh.style.borderLeftWidth="0px"}}ged(a){this.Bh&&(this.Txg()?this.gMk(a):this.fMk(a))}a3k(a,b,c){const f=!re.a("TableBorderOutsideBorderHalfClippingDisabled");this.NVd();var l=nb.GraphIterator.mb(this.$a);l.pc(14);var x=l.Rg(14);l=this.tc.jk(x);x=
this.tc.wi(x);c=c?c.GU():"";switch(a){case "Top":b=this.Gd.Fd.Ie(b,1);!this.ij.rowIndex&&f?(this.Bh.style.top="0px",this.Bh.style.borderTopWidth=b/2+"px"):(this.Bh.style.top=-b/2+"px",this.Bh.style.borderTopWidth=b+"px");this.Bh.style.borderTopColor=c;break;case "Bottom":b=this.Gd.Fd.Ie(b,1);this.ij.rowIndex+this.ij.rowSpan===l&&f?(this.Bh.style.bottom="0px",this.Bh.style.borderBottomWidth=b/2+"px"):(this.Bh.style.bottom=-b/2+"px",this.Bh.style.borderBottomWidth=b+"px");this.Bh.style.borderBottomColor=
c;break;case "Left":b=this.Gd.Fd.Ie(b,0);!this.ij.ni&&f?(this.Bh.style.left="0px",this.Bh.style.borderLeftWidth=b/2+"px"):(this.Bh.style.left=-b/2+"px",this.Bh.style.borderLeftWidth=b+"px");this.Bh.style.borderLeftColor=c;break;case "Right":b=this.Gd.Fd.Ie(b,0);this.ij.ni+this.ij.colSpan===x&&f?(this.Bh.style.right="0px",this.Bh.style.borderRightWidth=b/2+"px"):(this.Bh.style.right=-b/2+"px",this.Bh.style.borderRightWidth=b+"px");this.Bh.style.borderRightColor=c;break;case "DiagonalUp":this.k$b&&
(b=this.Gd.Fd.Ie(b,0),this.E_f(a,b,c));break;case "DiagonalDown":this.k$b&&(b=this.Gd.Fd.Ie(b,0),this.D_f(a,b,c))}this.eph()}E_f(a,b,c){this.x1f();this.poe||(this.poe=this.dUf());this.Nmh(this.poe,a,b,c)}D_f(a,b,c){this.x1f();this.ooe||(this.ooe=this.dUf());this.Nmh(this.ooe,a,b,c)}dUf(){const a=new Cn.a;this.u5c.appendChild(a.xa);this.No(a.xa);return a}Nmh(a,b,c,f){b=this.Qyi(b);a.y0(b);a.Hu(f);a.ar(c)}Qyi(a){switch(a){case "DiagonalUp":return String.format("M 0 {0} L {1} 0",this.XZd(),this.ZZd());
case "DiagonalDown":return String.format("M 0 0 L {0} {1}",this.ZZd(),this.XZd())}Aa.a.J(571479943,822,10,"CreateDAttrib : Unknown borderType "+a);return null}x1f(){this.NVd();this.KBb||(this.KBb=this.Gd.Wo(la.a.div),this.KBb.className="PPTTableDiagonalBorder",this.Qcb.appendChild(this.KBb),this.No(this.KBb));this.o5c||(this.o5c=new zm.a,this.u5c=this.o5c.xa,this.KBb.appendChild(this.u5c),this.No(this.u5c));this.o5c.gxa(String.format("0 0 {0} {1}",this.ZZd(),this.XZd()))}NVd(){this.Qcb||(this.Qcb=
this.Gd.Wo(la.a.div),this.Qcb.className="PPTTableBorderContainer",this.htmlElement.insertBefore(this.Qcb,this.htmlElement.firstChild),this.No(this.Qcb));this.Bh||(this.Bh=this.Gd.Wo(la.a.div),this.Bh.className="PPTTableBorder",this.Qcb.appendChild(this.Bh),this.No(this.Bh))}eph(){this.o1c&&re.a("MergeDifferentBordersFixEnabled")?this.Bh.style.zIndex=this.Ywb(this.ij)?"1":(this.mSa(this.ij.Jxa)||this.mSa(this.ij.sfa))&&(this.mSa(this.ij.Ixa)||this.mSa(this.ij.tfa))?"3":"2":this.Bh.style.zIndex=(this.mSa(this.ij.Jxa)||
this.mSa(this.ij.sfa))&&(this.mSa(this.ij.Ixa)||this.mSa(this.ij.tfa))?"1":"0"}Ywb(a){return 1<a.rowSpan||1<a.colSpan}cHj(a){return"DiagonalUp"===a||"DiagonalDown"===a}UIa(a,b,c,f){const l=this.o1c&&re.a("MergeDifferentBordersFixEnabled")&&this.Ywb(this.ij);this.o1c&&!this.cHj(a)&&this.Txg()&&0===b&&(b=1,c="rgb(255, 255, 255)");switch(a){case "Top":l&&!this.rEj()&&(b=0);this.Bh.style.borderTopWidth=b+"px";this.Bh.style.borderTopColor=c;this.Bh.style.borderTopStyle=f;this.Bh.style.top=-b/2+"px";break;
case "Right":l&&!this.qEj()&&(b=0);this.Bh.style.borderRightWidth=b+"px";this.Bh.style.borderRightColor=c;this.Bh.style.borderRightStyle=f;this.Bh.style.right=-b/2+"px";break;case "Bottom":l&&!this.lEj()&&(b=0);this.Bh.style.borderBottomWidth=b+"px";this.Bh.style.borderBottomColor=c;this.Bh.style.borderBottomStyle=f;this.Bh.style.bottom=-b/2+"px";break;case "Left":l&&!this.nEj()&&(b=0);this.Bh.style.borderLeftWidth=b+"px";this.Bh.style.borderLeftColor=c;this.Bh.style.borderLeftStyle=f;this.Bh.style.left=
-b/2+"px";break;case "DiagonalUp":this.k$b&&this.E_f(a,b,c);break;case "DiagonalDown":this.k$b&&this.D_f(a,b,c)}}ZZd(){var a=0;for(let b=0;b<this.ij.colSpan;b++)a+=this.ij.getContainingTable().g_d[this.ij.ni+b];a=this.Gd.Fd.Ie(a,0);return Math.round(100*a)/100}XZd(){var a=this.tc.MOc(this.ij.getContainingTable(),this.ij.rowIndex,this.ij.rowIndex+this.ij.rowSpan-1);let b=0;for(let c of a)Object(Ma.a)(157,c)?b+=c.sa(sb.a.au,0):Aa.a.J(571479944,822,15,String.format("GetCellHeight : node {0} is not of the type ITableRowNode",
c));this.ij.marginTop+this.ij.marginBottom>b&&Aa.a.J(559724693,822,15,String.format("GetCellHeight :: degenerate case : cell height : {0} is less than sum of margins top : {1}  and bottom : {2} ",b,this.ij.marginTop,this.ij.marginBottom));b=Math.max(b,this.ij.marginTop+this.ij.marginBottom);a=this.Gd.Fd.Ie(b,1);return Math.round(100*a)/100}rEj(){if(!this.ij.rowIndex)return!0;const a=this.ij.getContainingTable();if(!a)return!0;const b=this.ij.rowIndex-1;var c=this.ij.ni;const f=c+this.ij.colSpan-1;
for(;c<=f;c++){const l=a.jf(b,c);if(l&&(l.isGhostCell||this.Ywb(l)))return!0}return!1}nEj(){if(!this.ij.ni)return!0;const a=this.ij.getContainingTable();if(!a)return!0;const b=this.ij.ni-1;var c=this.ij.rowIndex;const f=c+this.ij.rowSpan-1;for(;c<=f;c++){const l=a.jf(c,b);if(l&&(l.isGhostCell||this.Ywb(l)))return!0}return!1}qEj(){const a=this.ij.getContainingTable();if(!a||this.ij.ni+this.ij.colSpan===this.tc.wi(a))return!0;const b=this.ij.ni+this.ij.colSpan;var c=this.ij.rowIndex;const f=c+this.ij.rowSpan-
1;for(;c<=f;c++){const l=a.jf(c,b);if(l&&(l.isGhostCell||this.Ywb(l)))return!0}return!1}lEj(){const a=this.ij.getContainingTable();if(!a||this.ij.rowIndex+this.ij.rowSpan===this.tc.jk(a))return!0;const b=this.ij.rowIndex+this.ij.rowSpan;var c=this.ij.ni;const f=c+this.ij.colSpan-1;for(;c<=f;c++){const l=a.jf(b,c);if(l&&(l.isGhostCell||this.Ywb(l)))return!0}return!1}c3k(){var a=!re.a("TableBorderOutsideBorderHalfClippingDisabled");this.NVd();if(a){a=nb.GraphIterator.mb(this.$a);a.pc(14);var b=a.Rg(14);
a=this.tc.jk(b);b=this.tc.wi(b);var c=this.uCa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth);this.UIa("Left",c,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle);this.ij.ni?this.Bh.style.left=-c/2+"px":(this.Bh.style.left="0px",this.Bh.style.borderLeftWidth=c/2+"px");c=this.uCa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth);this.UIa("Right",c,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle);
this.ij.ni+this.ij.colSpan===b?(this.Bh.style.right="0px",this.Bh.style.borderRightWidth=c/2+"px"):this.Bh.style.right=-c/2+"px";b=this.uCa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth);this.UIa("Top",b,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle);this.ij.rowIndex?this.Bh.style.top=-b/2+"px":(this.Bh.style.top="0px",this.Bh.style.borderTopWidth=b/2+"px");b=this.uCa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth);
this.UIa("Bottom",b,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.ij.rowIndex+this.ij.rowSpan===a?(this.Bh.style.bottom="0px",this.Bh.style.borderBottomWidth=b/2+"px"):this.Bh.style.bottom=-b/2+"px"}else a=this.uCa(this.htmlElement.style.borderLeft,this.htmlElement.style.borderLeftWidth),this.UIa("Left",a,this.htmlElement.style.borderLeftColor,this.htmlElement.style.borderLeftStyle),a=this.uCa(this.htmlElement.style.borderRight,this.htmlElement.style.borderRightWidth),
this.UIa("Right",a,this.htmlElement.style.borderRightColor,this.htmlElement.style.borderRightStyle),a=this.uCa(this.htmlElement.style.borderTop,this.htmlElement.style.borderTopWidth),this.UIa("Top",a,this.htmlElement.style.borderTopColor,this.htmlElement.style.borderTopStyle),a=this.uCa(this.htmlElement.style.borderBottom,this.htmlElement.style.borderBottomWidth),this.UIa("Bottom",a,this.htmlElement.style.borderBottomColor,this.htmlElement.style.borderBottomStyle);this.C_f();this.o1c&&this.eph();
this.htmlElement.style.border=""}C_f(){this.k$b&&(this.Uhe&&this.Mmh("DiagonalUp",this.Uhe),this.The&&this.Mmh("DiagonalDown",this.The))}mSa(a){return!!a}Mmh(a,b){const c=b.split(" ");if(3!==c.length)Aa.a.J(570832849,822,10,String.format("SetDiagonalBorderProps : split of string [ {0} ] has greater or less than 3 sub-parts",b));else{var f=c[0];b=this.uCa(b,c[1]);this.UIa(a,b,c[2],f)}}Zoc(a,b,c,f,l,x,G){if(!this.D_||this.Ea.tn(this.ij).getValue(sb.a.isResizable))this.Gzb?this.cyl(l,x,G):this.byl(a,
b,c,f,l,x,G)}cyl(a,b,c){this.UEa||(this.UEa=this.vGc(),this.No(this.UEa));this.R_||(this.R_=this.UOa(),this.No(this.R_));a?Sys.UI.DomElement.addCssClass(this.R_,"First"):Sys.UI.DomElement.removeCssClass(this.R_,"First");b^!!this.SN&&(b?(this.SN=this.UOa(),this.No(this.SN)):(this.IFb(this.SN),this.SN=null));this.SN&&Sys.UI.DomElement.addCssClass(this.SN,"Last");c^!!this.KN&&(c?(this.KN=this.vGc(),this.No(this.KN)):(this.IFb(this.KN),this.KN=null));this.KN&&Sys.UI.DomElement.addCssClass(this.KN,"FirstLeft")}byl(a,
b,c,f,l,x,G){super.Zoc(a,b,c,f,l,x,G);this.qqb&&this.No(this.qqb);this.R_||(this.R_=this.UOa(),this.No(this.R_));this.R_.style.left=a+"px";this.R_.style.top=b+"px";this.R_.style.width=c+"px";l?Sys.UI.DomElement.addCssClass(this.R_,"First"):Sys.UI.DomElement.removeCssClass(this.R_,"First");x^!!this.SN&&(x?(this.SN=this.UOa(),this.No(this.SN)):(this.IFb(this.SN),this.SN=null));this.SN&&(this.SN.style.bottom="0",this.SN.style.left=a+"px",this.SN.style.width=c+"px",Sys.UI.DomElement.addCssClass(this.SN,
"Last"));G^!!this.KN&&(G?(this.KN=this.vGc(),this.No(this.KN)):(this.IFb(this.KN),this.KN=null));this.KN&&(this.KN.style.left="0",this.KN.style.top=b+"px",this.KN.style.height=f+"px",Sys.UI.DomElement.addCssClass(this.KN,"FirstLeft"));this.Wab&&(this.R_.style.left="0",this.R_.style.top="0",this.qqb&&(this.qqb.style.left=c+"px",this.qqb.style.top="0",this.qqb.style.height=f+"px"),this.SN&&(this.SN.style.left="0"),this.KN&&(this.KN.style.top="0"))}zmh(){var a=this.Gd.Fd,b=a.Ie(this.Jk.Tra(this.$a,3),
1);this.Vha.style.paddingTop=b+"px";b=a.Ie(this.Jk.Tra(this.$a,0),1);this.Vha.style.paddingBottom=b+"px";b=a.Ie(this.Jk.Tra(this.$a,1),0);this.Vha.style.paddingLeft=b+"px";a=a.Ie(this.Jk.Tra(this.$a,2),0);this.Vha.style.paddingRight=a+"px"}e3k(a,b){const c=this.Gd.Fd;switch(b){case ba.a.inc:a=c.QZ(a.marginTop,1);this.Vha.style.paddingTop=a+"px";break;case ba.a.fnc:a=c.QZ(a.marginBottom,1);this.Vha.style.paddingBottom=a+"px";break;case ba.a.gnc:a=c.QZ(a.marginLeft,0);this.Vha.style.paddingLeft=a+"px";
break;case ba.a.hnc:a=c.QZ(a.marginRight,0),this.Vha.style.paddingRight=a+"px"}}eU(){var a=this.Jk.Tra(this.$a,1),b=this.Jk.Tra(this.$a,2);const c=this.Jk.o0b(this.$a,5),f=this.Jk.o0b(this.$a,6);var l=this.Gd.Fd;a=l.Ie(a+c,0);b=l.Ie(b+f,0);l=l.Ie(this.Jk.VMf(this.$a),0);return new ul.a(a,l,b)}QCh(){this.htmlElement.style.background=this.bA.I9f(this.$a)}UT(){if(!this.Bh)super.UT();else if(!this.Gd.Kl&&this.MA){const a=Object(ua.a)(1045,this.$Q);a&&a.dUg(this.Bh)}}UOa(){const a=this.iVf();a.className=
"TableRowResizeHandle";return a}IFb(a){K.a.qIa(a);ya.a.vO(a)}get tableCellNode(){return this.ij}get uXc(){return this.tka}get vk(){this.Lta||(this.Lta=this.t$f());return this.Lta}set vk(a){this.Lta=a}get Sp(){return this.Qka}RHb(a){this.Qka=a;this.tableCellNode.Jvb=a}lock(a){this.Sp&&this.tka===a||(this.vk.Pkd(),this.tka=a,this.RHb(!0),this.Lc.mz(new Wp.a(7)),this.SEa.Obh(new MD(a)),this.SEa.QIk(new pL(this)))}unlock(){this.Sp&&(this.tka=null,this.RHb(!1),this.Lc.mz(new Wp.a(7)),this.SEa.Obh(new MD(null)))}t$f(){let a=
null;const b=this.Ea.tn(this.ij);b&&(a=Object(ua.a)(121,b.sg(this.Ma)));return a}}Object(e.a)(Qs,"TableCellViewElement",Kv,[1046,418,345,106]);var Qz=d(296),vQ=d(495);class im extends Kh{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){super(a,b);Kh.B0a=()=>Uq.n3f(zh.a.create());this.Jk=c;this.Cl=f;this.$I=x;this.OVa=l;this.tc=G;this.u4=R;this.LVa=fa;this.Ezb=wa;this.Ne=Wa;this.L0c=re.a("PPTOEnableTableDiagonalBorders")}JPf(a,b){Kh.Xoi(a,b,Jd.TableReader.wi(a))}lVf(a,b,c,f=null,l=!1){const x=a.parentNode.getValue(sb.a.shapeId);
a.currentNode.setValue(sb.a.shapeId,x);for(var G=0;G<b;++G){var R=new vQ.a;a.pl(R,1);R.setValue(sb.a.shapeId,x);R.setValue(sb.a.rowId,zh.a.create())}b=null;G=!0;a.Ab(1);do{R=a.currentNode.getValue(sb.a.rowId);for(let fa=0;fa<c;++fa){const wa=this.Rqa();a.pl(wa,1);wa.setValue(sb.a.shapeId,x);wa.setValue(sb.a.rowId,R);wa.setValue(sb.a.cellId,zh.a.create());({Qkh:b,isFirst:G}=this.H5f(a,wa,l,f,b,G));Qd.returnToContainingRow(a)}}while(a.zj(1))}BXa(a){if(this.L0c&&a&&(a=this.tc.jF(a)))for(const b of a)b&&
!b.isGhostCell&&(a=Object(ua.a)(Qs,b.oc(this.Ne)))&&a.C_f()}EHe(a,b,c,f,l){var x=this.$I.FMc(a);for(var G=0;G<x.length;G++){const R=this.Jk.Cpb(a,G);x[G]=Math.max(R,x[G]*b)}a.setValue(tb.a.Iu,x);if(1!==c)for((new nb.GraphIterator).set(a),b=a?a.firstRow:null,c=0;b;){x=l.Ff(f.edj(c),1);G=this.Jk.VMd(a,c);x<=G&&(x=0);b.setValue(sb.a.au,x);if(b.Jwg())break;else b=b.lHa;c++}this.BXa(a)}$2k(a,b){a=this.tc.jF(a);for(let c=0;c<a.length;c++){const f=a[c].cellShading;f.anchorField=b;a[c].cellShading=f;a[c].Fna=
b}}Z2k(a,b){for(let f=0;f<a.length;f++){const l=a.ga(f);for(let x=0;x<l.length;x++){var c=l.ga(x).iterator;c.pc(16);c.Rg(16);c=c.pq;const G=c.cellShading;G.anchorField=b;c.cellShading=G;c.Fna=b}}}e4b(a,b,c,f,l){super.e4b(a,b,c,f,l);c=[];Array.add(c,sb.a.au);tm.b(f,b,c);c=a.currentNode.getValue(sb.a.shapeId);const x=a.pq.getValue(sb.a.sid);a=a.pq.getValue(sb.a.cid);const G=Uq.fTf(zh.a.create());b.setValue(sb.a.sid,x);b.setValue(sb.a.cid,a);b.setValue(sb.a.shapeId,c);b.setValue(sb.a.rowId,G);this.lyl(f,
b,l)}W3b(a,b,c,f,l){super.W3b(a,b,c,f,l);return this.E8c(a.currentNode,b,c,f,!1,!1)}LTb(a,b,c,f,l){super.LTb(a,b,c,f,l);return this.E8c(a.currentNode,b,c,f,l,!1)}get FNd(){if(!im.t$){im.t$=[];let a,b,c;for(const f of im.zYc)if(this.L0c||2!==f&&1!==f)({fOa:b,Y3a:a,hpb:c}=Vp.$Qa(f)),Array.add(im.t$,b),Array.add(im.t$,a),Array.add(im.t$,c);Array.add(im.t$,tb.a.iE);Array.add(im.t$,sb.a.cellShading);Array.add(im.t$,Mb.a.oJb);Array.add(im.t$,Mb.a.qJb);Array.add(im.t$,Mb.a.rJb);Array.add(im.t$,Mb.a.nJb);
Array.add(im.t$,sb.a.iR)}return im.t$}E8c(a,b,c,f,l,x){c=x?this.noj(b,c,l):this.ooj(b,c,f,l);tm.c(c,b,this.FNd);f=a.getValue(sb.a.sid);x=a.getValue(sb.a.cid);const G=a.getValue(sb.a.shapeId),R=c.getValue(sb.a.cellId);a=a.getValue(sb.a.rowId);b.setValue(sb.a.sid,f);b.setValue(sb.a.cid,x);b.setValue(sb.a.shapeId,G);b.setValue(sb.a.rowId,a);l?b.setValue(sb.a.cellId,R):b.setValue(sb.a.cellId,b.id.tq);return c}vGf(a,b,c,f,l,x){a=a.currentNode;const G=Array(c);let R=0,fa=0,wa=0;for(;R<f;R++)G[R]=b[R],fa+=
G[R];for(l=l?b[f]:b[f-1];R<f+x;R++)G[R]=l,wa+=G[R];for(;R<c;R++)G[R]=b[R-x],fa+=G[R];b=fa/(wa+fa);for(R=0;R<c;R++)G[R]=Math.max(G[R]*b,this.Jk.Cpb(a,R));return G}Iec(a,b,c,f,l){super.Iec(a,b,c,f,l);var x=a.getValue(sb.a.dib);l=Array(x.length+f);let G=0;for(;G<b;G++)l[G]=x[G];for(;G<b+f;G++)l[G]=im.YAi();for(;G<l.length;G++)l[G]=x[G-f];a.setValue(sb.a.dib,l);x=c?l[b+f]:l[b-1];a=Object(ua.a)(Qz.TableNode,a);this.Ivl(a,x,l.slice(b,f+b),b,c);if(this.Ezb)for(l=this.LVa.create(a),f=b+f,x=(!c||!b)&&b<this.tc.wi(a)-
1,b+=c?1:0,f+=c?1:0,c=b;c<f;c++)this.u4.cYd(a,l,c,0,this.tc.jk(a),x)}Nxe(a,b,c,f){super.Nxe(a,b,c,f);if(this.Ezb){a=Object(ua.a)(158,a);const l=this.LVa.create(a);f=c+f;const x=(!b||!c)&&c<this.tc.jk(a)-1;c+=b?1:0;f+=b?1:0;for(b=c;b<f;b++)this.u4.aYd(a,l,b,0,this.tc.wi(a),x)}}hxe(a,b,c){super.hxe(a,b,c);this.DKb(a,sb.a.complexTable);this.Ezb&&(a=Object(ua.a)(158,a.currentNode),c=this.LVa.create(a),this.u4.aYd(a,c,b,0,this.tc.wi(a),!0))}gxe(a,b,c){super.gxe(a,b,c);const f=a.currentNode.getValue(sb.a.dib),
l=Array(f.length-c);let x=0;for(;x<b;x++)l[x]=f[x];for(;x<l.length;x++)l[x]=f[x+c];a.currentNode.setValue(sb.a.dib,l);this.DKb(a,sb.a.complexTable);this.Ezb&&(a=Object(ua.a)(158,a.currentNode),c=this.LVa.create(a),this.u4.cYd(a,c,b,0,this.tc.jk(a),!0))}lyl(a,b,c){a=a.getValue(sb.a.rowId);b.setValue(sb.a.LLk,a);b.setValue(sb.a.insertBefore,c)}Ivl(a,b,c,f,l){a=a.firstRow;do for(let x=0;x<c.length;++x){const G=nb.GraphIterator.mb(a),R=G.Rp(f+x,1);R.setValue(sb.a.KLk,b);R.setValue(sb.a.insertBefore,l);
R.setValue(sb.a.cellId,c[x]);im.$nh(G,sb.a.cellId,c[x])}while(a=a.lHa)}Rqa(){const a=super.Rqa();a.isGhostCell=!0;a.rowSpan=1;a.colSpan=1;return a}Owe(a,b){this.Zmj(a,b,c=>{c.currentNode.isGhostCell=!1;Kh.Cx.c4b(c,null,!0);const f=c.currentNode.getValue(sb.a.rowId),l=c.currentNode.getValue(sb.a.cellId);for(c=Xe.a.Xu(c);c.moveNext();){const x=c.currentNode.sa(sb.a.cellId,null);c.currentNode.sa(sb.a.rowId,null)&&c.currentNode.setValue(sb.a.rowId,f);x&&c.currentNode.setValue(sb.a.cellId,l)}})}Ced(a){Jd.TableReader.vu(a.currentNode)&&
this.beh(a,b=>b.Xh(sb.a.au),(b,c)=>{b.me(sb.a.au,c)},sb.a.complexTable)}$Fe(a){a&&(a=nb.GraphIterator.mb(a),this.Ced(a,0))}dxa(a,b){if(a)for(a=this.Cl.Nqa(a),a.Sl(c=>15===c.oi,null);a.moveNext();){const c=Object(ua.a)(157,a.iterator.currentNode),f=this.OVa.b7a(c);c.setValue(sb.a.au,f*b)}}JYa(a,b){if(a&&14===a.type){const c=this.$I.FMc(a);for(let f=0;f<c.length;f++){const l=this.Jk.Cpb(a,f);c[f]=Math.max(l,c[f]*b)}a.setValue(tb.a.Iu,c)}}Koh(a,b){if(a&&0<a.length)for(const c of a)c.setValue(sb.a.au,
we.a.cW(b))}Joh(a,b,c){if(a&&b&&0<b.length){const f=this.$I.FMc(a);for(let l=0;l<b.length;l++)f[b[l]]=we.a.cW(c);a.setValue(tb.a.Iu,f)}}F8d(a){const b=new nb.GraphIterator;b.Pc(a);var c=b.currentNode;b.Ab(1);const f=a.yc();this.jya(a);const l=ps.a.instance.createInstance(393251);this.e4b(a,l,c,c,!1);a.Gk(l);c=this.tc.wi(f);for(let x=0;x<c;++x){const G=this.Rqa();super.LTb(a,G,b.currentNode,!1,!0);this.E8c(l,G,b.currentNode,!1,!0,!0);b.vf(1)}this.wHb(f,this.tc.jk(f)+1);return a.currentNode}E8d(a){const b=
nb.GraphIterator.mb(a.ZEh());let c=this.tc.wi(b.currentNode);var f=this.$I.EMc(Object(ua.a)(127,a.currentNode));a=f+1;this.jya(b);b.Ab(1);do{const l=b.Rp(f,1);b.yc();const x=this.Rqa();super.W3b(b,x,l,!1,!1);this.E8c(b.currentNode,x,l,!1,!1,!0)}while(b.zj(1));(f=b.currentNode.sa(tb.a.Iu,null))&&(f=Qa.a.clone(f));this.gHb(b.currentNode,++c);f&&(Array.insert(f,a,0),b.currentNode.setValue(tb.a.Iu,f));this.Iec(b.currentNode,a,!1,1,null)}SUe(a){this.DKb(a,sb.a.complexTable)}noj(a,b,c){let f=b;const l=
b.gHa;if(l)if(b.isGhostCell)Kh.mOc(l,!c)||Kh.Dgb(l.controlCell,c,Kh.Vsb(l.controlCell,c)+1);else{let x=Kh.Vsb(b,c);1<x&&(f=Kh.G5i(l,!c));Kh.Dgb(b,c,x+1)}else Kh.Dgb(b,c,2);a.isGhostCell=!0;return f}static $nh(a,b,c){a.currentNode.me(b,c);let f=a.Ji();if(f){for(;f;)im.$nh(a,b,c),f=a.yp();a.yc()}}static YAi(){return Uq.fTf(zh.a.create())}}im.t$=null;im.zYc=[5,6,7,0,2,1];Object(e.a)(im,"TableEditor",Kh,[1044]);const qL=(a,b,c,f,l)=>{const x=l.WX,G=l.Dqa;var R=l.tableLook;const fa=0<(R&32);l=0<(R&128);
const wa=0<(R&64),Wa=0<(R&256),mb=fa?1:0,Kb=l?1:0;R=a?a===x-c?wa?3:(a-mb)%2+mb:(a-mb)%2+mb:0;x-c||(R=fa?0:wa?3:(a-mb)%2+mb);a=b?b===G-f?Wa?3:(b-Kb)%2+Kb:(b-Kb)%2+Kb:0;G-f||(a=l?0:Wa?3:(b-Kb)%2+Kb);return{JMf:R,HMf:a}};class ND{constructor(a){this.Y_=a;this.b2c=Array(4);for(a=0;4>a;a++)this.b2c[a]=Array(4)}s9f(a,b,c,f){let l,x;({JMf:l,HMf:x}=qL(a,b,c,f,this.Y_));if(!this.b2c[l][x]){c=Object.assign(new gr.a,{$d:b,Lf:b+f,ge:a,Zf:a+c});a=this.b2c[l];b=x;f=this.Y_;var G=f.tableStyle,R=new iq;R.latinField=
Fe.Vqb(1,0);R.eaField=Fe.Vqb(1,1);R.csField=Fe.Vqb(1,2);R.solidFillField=Object.assign(new Nq.a,{schemeClrField:Object.assign(new cn.a,{valField:1})});G&&(new UK(R)).V1(f,c);c=R;G=f.CVj;f=new Lx;G=G||new RK;for(R=1;9>=R;R++){var fa=VK(G,R);const wa=R-1;f.Fze[wa]=fa?Yd.a(Yd.c(fa)):new Oq;fa=f.Fze[wa].defRPrField;f.Zpb[wa]=fa?Yd.a(Yd.c(fa)):new iq}for(G=1;9>=G;G++)WK(f.Zpb[G-1],c);a[b]=f}return this.b2c[l][x]}V$f(a,b,c,f,l){let x=Hb.a.iPa;a&&(b=this.s9f(b,c,f,l))&&b.Zpb&&0<b.Zpb.length&&(b=b.Zpb[0])&&
(x=uf.Box4ColorHelper.fGb(b,a));return x}}Object(e.a)(ND,"TableListStyleCache",null,[1047]);class OD{constructor(a,b,c,f){this.qFa=a;this.dSg=b;this.qFa.Yj(Object(C.a)(this,this.fh,"onPropertyChanged"));this.qFa.rha(Object(C.a)(this,this.onConnected,"onConnected"));this.Ne=c;this.Hme=f}onConnected(a,b){a=Object(ua.a)(158,b.node);this.dSg.MEh(a)}fh(a,b){a=b.property;b=Object(ua.a)(158,b.node);a===tb.a.Iu?this.dSg.MEh(b):a===tb.a.Lxa||a===tb.a.ufa||a===tb.a.BA?b.mY=null:!this.Hme||a!==sb.a.GSa&&a!==
sb.a.isResizable&&a!==sb.a.ZK||b.oc(this.Ne).QVe()}dispose(){this.qFa.tm(Object(C.a)(this,this.fh,"onPropertyChanged"));this.qFa.Uma(Object(C.a)(this,this.onConnected,"onConnected"))}}Object(e.a)(OD,"TableNodeBehavior",null,[106]);var wQ=d(184);class Mv{constructor(a,b,c,f,l,x,G,R){this.J_=this.yQ=this.xn=this.NFa=this.F_=this.w5c=this.jFa=null;this.Ebb=this.P2c=0;this.aOg=this.Kac=this.Qd=this.lx=null;this.NN=a;this.ia=c;this.Dq=f;this.vs=l;this.wC=x;this.C9=b;this.Wp=G;this.Fp=R}rK(){this.J_=this.yQ=
this.xn=this.F_=this.NFa=null;null!==this.Wp&&this.Wp.Cwa()}mv(a){if(!a||a.dA===Sys.UI.MouseButton.rightButton||this.NN.ZZ)return!1;this.Qd=(this.lx=Object(ua.a)(1037,this.wC.jI(a.Ac)))?this.lx.vk:null;if(!this.Qd)return!1;this.jFa=this.lx.ooi;if(!this.jFa)return!1;this.yQ=this.jFa.kng(a.Ac);if(!this.yQ)return!1;this.Fp&&this.ia.processAction(E.a.Dia,2);return!0}Du(a){if(!a||!this.mv(a))return!1;this.w5c=this.lx=this.wC.jI(this.jFa.xa);if(!this.lx)return Aa.a.J(8959070,808,10,"The draggable chrome should be owned by Box4 TableViewElement"),
!1;this.ia.processAction(ba.a.G4a,2);this.jFa.tD(!0);this.Qd.tD(!0);null!==this.Wp&&this.Wp.Ywa(Qi.a.RIb);this.J_=this.w5c.Q1b();this.P2c=this.Dq.Hm(zc.a.$l(this.J_.ga(0),this.J_.ga(1)));this.Ebb=this.Dq.Hm(zc.a.$l(this.J_.ga(0),this.J_.ga(3)));this.NFa=this.dTf(a.clientPoint);this.F_=new zc.a(0,0);this.xn=new Of.a;this.aOg=new zc.a(this.Qd.x+this.P2c,this.Qd.y+this.Ebb);return!0}mw(a){if(!a)return!1;a=this.dTf(a.clientPoint);var b=zc.a.yU(a,this.NFa);this.F_=zc.a.add(this.F_,b);b=Jk.XMd(this.yQ,
this.J_,this.F_,!1,!1);this.xn=Object.assign(new Of.a,{bottom:this.Dq.Hm(b.bottom),left:this.Dq.Hm(b.left),right:this.Dq.Hm(b.right),top:this.Dq.Hm(b.top)});let c;({OGh:b,SGh:c}=this.aNf());const f=new wQ.a;f.aba(b,c);f.HB(this.xn.left,this.xn.top);this.jFa.Gq(f);this.NFa=a;return!0}Sn(a){let b=null;a&&(b=this.C9.zi("UserAction","PPTTableResize"),Aa.a.J(19142416,822,50,String.format("Start Table resize for table: {0}, IsComplex: {1}",this.lx.$a.sa(sb.a.xCb,""),Jd.TableReader.vu(this.lx.$a))));this.jFa.Hz(!1);
({OGh:l,SGh:x}=this.aNf());this.lx.Noh(l,x);this.YQe();const c=new Id.GraphTransaction(15);c.gd(this.lx.$a);var f=this.lx.Gd.Fd;this.vs.EHe(Object(ua.a)(Qz.TableNode,this.lx.$a),l,x,this.w5c,f);if(Mv.GDa(this.yQ)||Mv.GDa(this.yQ,!0)){var l=this.lx.vk.shapeNode;var x=f.Ff(this.Qd.x,0);f=f.Ff(this.Qd.y,1);l.fz=x;l.gz=f}this.Qd.Hz(!1);c.dispose();this.rK();Cb.App.Hb.updateCommandUI();b&&b.stop();a&&Aa.a.J(8959107,822,50,String.format("End Table resize for table: {0}, IsComplex: {1}",this.lx.$a.sa(sb.a.xCb,
""),Jd.TableReader.vu(this.lx.$a)))}YQe(){var a=Mv.GDa(this.yQ),b=Mv.GDa(this.yQ,!0);if(a||b){b=this.w5c.Q1b();a=this.Dq.Hm(b.Vb-b.Yb);b=this.Dq.Hm(b.Ub-b.$b);const c=this.aOg;c._x+=this.xn.right;c._y+=this.xn.bottom;this.Qd.setPosition(c.x-a,c.y-b,!0)}}Yt(){this.F_&&(this.jFa.Hz(!0),this.jFa.Gq(null),this.Qd.Hz(!0),this.rK())}aNf(){return{OGh:this.P2c?1+(this.xn.right-this.xn.left)/this.P2c:1,SGh:this.Ebb?1+(this.xn.bottom-this.xn.top)/this.Ebb:1}}dTf(a){a=zc.a.rQa(a);var b=this.yQ;this.yQ.G4b()||
(b=b.Dtb());const c=this.J_.ik(b);b=this.J_.ik(b.m6a());return a=new zc.a(c.x<=b.x?Math.min(a.x,b.x):Math.max(a.x,b.x),c.y<=b.y?Math.min(a.y,b.y):Math.max(a.y,b.y))}static GDa(a,b=!1){return a.equals(Sc.a.Bu)?!0:b?a.equals(Sc.a.north)||a.equals(Sc.a.gE):a.equals(Sc.a.west)||a.equals(Sc.a.sH)}}Object(e.a)(Mv,"TableResizeDragAdapter",null,[232]);class PD{constructor(a,b){this.Y_=a;this.MBb=b;this.hi=Array(4);for(a=0;4>a;a++)this.hi[a]=Array(4);this.xte=Array(16)}VZd(a,b,c,f){let l,x;({JMf:l,HMf:x}=
qL(a,b,c,f,this.Y_));this.hi[l][x]||(this.hi[l][x]=this.MBb.jWk(this.Y_,a,b,c,f));c=this.hi[l][x].clone();if(a=this.Ujj(a,b))for(const G of a.Mz())c.Sa(G)||c.me(G,a.Xh(G));return c}clear(){for(let a=0;4>a;a++)this.hi[a]=Array(4);this.xte=Array(16)}Ujj(a,b){var c=a===this.Y_.WX-1;const f=b===this.Y_.Dqa-1;let l=0;a||(l|=8);!b&&(l|=4);c&&(l|=2);f&&(l|=1);(c=this.xte[l])||(this.xte[l]=c=this.MBb.BWk(this.Y_,a,b));return c}}Object(e.a)(PD,"TableStyleCache",null,[1042]);class rL{constructor(a){this.OUa=
a}jWk(a,b,c,f,l){const x=a.WX;var G=a.Dqa,R=a.tableLook;const fa=a.tableStyle;a=a.Pe;const wa=new mq.a,Wa=0<(R&32),mb=0<(R&128),Kb=!b&&Wa,nc=!c&&mb;f=b===x-f&&0<(R&64);l=c===G-l&&0<(R&256);G=!(R&512)&&!Kb&&!f;R=!(R&1024)&&!nc&&!l;this.CWk(fa.wholeTblField,wa);G&&this.Iwa((Wa?1!==(b&1):b&1)?fa.band2HField:fa.band1HField,a,wa);R&&this.Iwa((mb?1!==(c&1):c&1)?fa.band2VField:fa.band1VField,a,wa);l&&this.Iwa(fa.lastColField,a,wa);nc&&this.Iwa(fa.firstColField,a,wa);f&&(this.Iwa(fa.lastRowField,a,wa),l&&
this.Iwa(fa.seCellField,a,wa),nc&&this.Iwa(fa.swCellField,a,wa));Kb&&(this.Iwa(fa.firstRowField,a,wa),l&&this.Iwa(fa.neCellField,a,wa),nc&&this.Iwa(fa.nwCellField,a,wa));return wa}BWk(a,b,c){var f=a.WX;const l=a.Dqa;var x=a.tableStyle;a=a.Pe;const G=new mq.a;if(x&&0<=b&&b<f&&0<=c&&c<l){const R=!c;f=b===f-1;c=c===l-1;(x=x.wholeTblField)&&x.tcStyleField&&(x=x.tcStyleField.tcBdrField)&&(this.TXa(7,b?x.insideHField:x.topField,a,G),this.TXa(0,f?x.bottomField:x.insideHField,a,G),this.TXa(5,R?x.leftField:
x.insideVField,a,G),this.TXa(6,c?x.rightField:x.insideVField,a,G))}return G}aih(a,b,c){const f=new mq.a;this.Zhh(a,c,b,f);return f}CWk(a,b){a&&a.tcStyleField&&a.tcStyleField.fillField&&b.me(sb.a.cellShading,a.tcStyleField.fillField)}Iwa(a,b,c){a&&a.tcStyleField&&(a.tcStyleField.fillField&&c.me(sb.a.cellShading,a.tcStyleField.fillField),a=a.tcStyleField.tcBdrField)&&(this.TXa(7,a.topField,b,c),this.TXa(0,a.bottomField,b,c),this.TXa(5,a.leftField,b,c),this.TXa(6,a.rightField,b,c))}TXa(a,b,c,f){b&&b.itemField&&
this.Zhh(a,b.itemField,c,f)}Zhh(a,b,c,f){let l;({fOa:l,Y3a:a}=Vp.$Qa(a));b.wFieldSpecified&&f.me(l,we.a.eVd(b.wField));if(b.solidFillField)if(this.OUa)f.me(a,b.solidFillField);else{if(b=uf.Box4ColorHelper.Rfb(b.solidFillField,c))b=uf.Box4ColorHelper.Jna(b),f.me(a,b)}else b.noFillField&&(this.OUa&&re.a("TableBordersLocalRenderingFix")?(b=uf.Box4ColorHelper.sY({Color:"##T,0,0,0"}),f.me(a,b),f.me(l,0)):f.me(a,Hb.a.iPa))}}Object(e.a)(rL,"TableStyleResolver",null,[281]);var sL=d(321),QD=d(185);class Nx{constructor(a,
b,c,f=null){this.vva=!1;this.QA=this.Pn=this.pb=this.jGg=this.lTg=null;this.tC=[];this.zk=this.Uz=!1;this.U_=null;this.Go=this.Oab=!1;this.Fa=b;this.xOg=a;this.Wc=f;this.oT=(this.H0c=c)?10:6;this.mre=c?2:sf.a.rE}get visible(){return this.vva}set visible(a){this.vva!==a&&(this.vva=a,this.joh())}get xa(){return this.pb.viewport.xa}nei(a,b,c){this.lTg=a;this.jGg=c;this.ym();this.Wc.ob(ma.a.click,this.xa,Object(C.a)(this,this.FXg,"notifySelectShapeByClick"));b.appendChild(this.pb.viewport);this.lTg.hM(this.xa,
!0);this.Oab=!0;this.setZIndex(2+jD.a.baa+1)}MBh(){this.Oab&&this.pb&&this.Wc.xb(ma.a.click,this.xa,Object(C.a)(this,this.FXg,"notifySelectShapeByClick"));this.Oab=!1}setZIndex(a){this.Oab&&this.pb.pB(a)}ym(){this.pb||(this.pb=new QD.a,this.Pn=new Cn.a,this.Pn.oE(Bk.a.none),this.Pn.Hu(sf.a.F0),this.Pn.ar(sf.a.rE),this.pb.Yk(Qi.a.mA),this.pb.appendChild(this.Pn),this.QA=new en.a,this.NXb(this.QA),this.pb.appendChild(this.QA),this.pb.Ld(!1),this.pb.viewport.xa.setAttribute(Bk.a.qEb,Bk.a.none))}Gl(){if(this.Oab){var a=
this.nej(this.jGg);this.Uz?(this.U_&&this.U_.ql(a),this.Pn.ht(a.points)):(a=a.points,this.Pn.ht(a),a=new th.a(a[0],a[1],a[2],a[3]));this.KX(a);this.pb.Gl()}}NXb(a){for(let f=0;8>f;++f){var b="selectionHandle"+f;const l=new en.a;l.xa.id=b;if(r.a.FJa){var c=new sL.a;c.xa.id=b;c.xa.setAttribute("class",Al.a.jld);c.setVisibility(!1);c.setPosition(-10,-10);c.gh(20,20);l.appendChild(c)}c=new sL.a;c.xa.id=b;c.xa.setAttribute("class",Al.a.jld);b=this.oT/2*-1;c.setPosition(b,b);c.gh(this.oT,this.oT);this.H0c&&
c.moh(this.oT/2,this.oT/2);c.oE("white");c.Hu(sf.a.F0);c.ar(this.mre);c.Foh();l.appendChild(c);l.Rj(1);this.tC[f]=l;a.appendChild(l)}}KX(a){for(let b=0;8>b;++b){const c=this.tC[b];c.Yk(Nx.qkc[b]);this.YIa(c,a.ik(new Sc.a(b)))}}nej(a){return new th.a(new zc.a(0,0),new zc.a(a.offsetWidth,0),new zc.a(a.offsetWidth,a.offsetHeight),new zc.a(0,a.offsetHeight))}nE(a){this.Go||((this.Uz=a)?(this.Pn.oE(sf.a.A_f),this.Pn.Hu(sf.a.F0),this.Pn.ar(sf.a.rE),this.QA.Ld(!1),this.xOg.endEditing(!0,14)):(this.Pn.oE(Bk.a.none),
this.Pn.Hu(sf.a.F0),this.Pn.ar(sf.a.rE),this.QA.Ld(!0),this.Fa.Bf(Yb.a.Bg),this.xOg.hR()))}dispose(){this.zk||(this.MBh(),this.Pn=this.pb=null,Array.clear(this.tC),this.QA=null,this.Oab=!1,this.zk=!0)}kng(a){if(!this.Oab)return null;for(let b=0;8>b;++b)if(this.tC[b].xa.id===a.id)return new Sc.a(b);return null}YIa(a,b){a.setPosition(b.x,b.y)}FXg(a){return this.kng(a.Ac)?!0:!1}tD(a){this.nE(!0,a)}Hz(){this.nE(!1)}Gq(a){this.U_&&this.U_.clear();this.U_=a;this.Gl()}xx(a){this.Go=a;this.joh()}joh(){this.pb&&
this.pb.Ld(!this.Go&&this.vva)}static xXb(a){return new Nx(a,fb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").pptChangeResizeHandleEnabled,u.AFrameworkApplication.Aa.my)}}Nx.qkc=[Qi.a.iQe,Qi.a.hQe,Qi.a.gQe,Qi.a.fQe,Qi.a.jQe,Qi.a.kQe,Qi.a.lQe,Qi.a.mQe];Object(e.a)(Nx,"DraggablePandoraChromeView",null,[1043]);class tL{}Object(e.a)(tL,"TableStyleCategoryInfo",null,[]);class yf{static EOi(){if(yf.Xg)return yf.Xg;yf.Xg=new Lc.a;
yf.Xg.$("No Style, No Grid",ResourceStrings.l_TableThemedStyle1);yf.Xg.$("Themed Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,1));yf.Xg.$("Themed Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,2));yf.Xg.$("Themed Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,3));yf.Xg.$("Themed Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,1,4));yf.Xg.$("Themed Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,5));yf.Xg.$("Themed Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,1,6));yf.Xg.$("No Style, Table Grid",ResourceStrings.l_TableThemedStyle2);yf.Xg.$("Themed Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,1));yf.Xg.$("Themed Style 2 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,2));yf.Xg.$("Themed Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,3));yf.Xg.$("Themed Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,4));yf.Xg.$("Themed Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleThemed,2,5));yf.Xg.$("Themed Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleThemed,2,6));yf.Xg.$("Light Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,1));yf.Xg.$("Light Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,1));yf.Xg.$("Light Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,2));yf.Xg.$("Light Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
1,3));yf.Xg.$("Light Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,4));yf.Xg.$("Light Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,5));yf.Xg.$("Light Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,1,6));yf.Xg.$("Light Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,2));yf.Xg.$("Light Style 2 - Accent 1",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,1));yf.Xg.$("Light Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,2));yf.Xg.$("Light Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,3));yf.Xg.$("Light Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,4));yf.Xg.$("Light Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleLight,2,5));yf.Xg.$("Light Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,2,6));yf.Xg.$("Light Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleLight,3));yf.Xg.$("Light Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,1));yf.Xg.$("Light Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,
3,2));yf.Xg.$("Light Style 3 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,3));yf.Xg.$("Light Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,4));yf.Xg.$("Light Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,5));yf.Xg.$("Light Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleLight,3,6));yf.Xg.$("Medium Style 1",
String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,1));yf.Xg.$("Medium Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,1));yf.Xg.$("Medium Style 1 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,2));yf.Xg.$("Medium Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,3));yf.Xg.$("Medium Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleMedium,1,4));yf.Xg.$("Medium Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,5));yf.Xg.$("Medium Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,1,6));yf.Xg.$("Medium Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,2));yf.Xg.$("Medium Style 2 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
2,1));yf.Xg.$("Medium Style 2 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,2));yf.Xg.$("Medium Style 2 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,3));yf.Xg.$("Medium Style 2 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,4));yf.Xg.$("Medium Style 2 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,5));
yf.Xg.$("Medium Style 2 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,2,6));yf.Xg.$("Medium Style 3",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleMedium,3));yf.Xg.$("Medium Style 3 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,1));yf.Xg.$("Medium Style 3 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,2));yf.Xg.$("Medium Style 3 - Accent 3",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,3));yf.Xg.$("Medium Style 3 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,4));yf.Xg.$("Medium Style 3 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,5));yf.Xg.$("Medium Style 3 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,3,6));yf.Xg.$("Medium Style 4",String.format(ResourceStrings.l_TableStyleNoAccent,
ResourceStrings.l_TableStyleMedium,4));yf.Xg.$("Medium Style 4 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,1));yf.Xg.$("Medium Style 4 - Accent 2",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,2));yf.Xg.$("Medium Style 4 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,3));yf.Xg.$("Medium Style 4 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,
4,4));yf.Xg.$("Medium Style 4 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,5));yf.Xg.$("Medium Style 4 - Accent 6",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleMedium,4,6));yf.Xg.$("Dark Style 1",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));yf.Xg.$("Dark Style 1 - Accent 1",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,1));yf.Xg.$("Dark Style 1 - Accent 2",
String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,2));yf.Xg.$("Dark Style 1 - Accent 3",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,3));yf.Xg.$("Dark Style 1 - Accent 4",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,4));yf.Xg.$("Dark Style 1 - Accent 5",String.format(ResourceStrings.l_TableStyleName,ResourceStrings.l_TableStyleDark,1,5));yf.Xg.$("Dark Style 1 - Accent 6",String.format(ResourceStrings.l_TableStyleName,
ResourceStrings.l_TableStyleDark,1,6));yf.Xg.$("Dark Style 2",String.format(ResourceStrings.l_TableStyleNoAccent,ResourceStrings.l_TableStyleDark,2));yf.Xg.$("Dark Style 2 - Accent 1/Accent 2",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,1,2));yf.Xg.$("Dark Style 2 - Accent 3/Accent 4",String.format(ResourceStrings.l_TableStyleNameAccent,ResourceStrings.l_TableStyleDark,2,2,3));yf.Xg.$("Dark Style 2 - Accent 5/Accent 6",String.format(ResourceStrings.l_TableStyleNameAccent,
ResourceStrings.l_TableStyleDark,2,4,5));return yf.Xg}static Ogg(a){const b=yf.EOi();return b.Jb(a)?b.ga(a):a}}yf.Xg=null;Object(e.a)(yf,"TableStyleNameReader",null,[]);class uL{constructor(a){this.RHg=!1;this.fyb=[];this.Jle=new ef.a(0);this.Cge=[];this.UPg=a}t1f(){this.RHg||(this.RHg=this.jyk())}jyk(){const a=this.UPg.instance?this.UPg.instance.pml:null;if(a&&a.tblStyleCategoriesField){let b=0;this.fyb=[];this.Jle=new ef.a(0);this.Cge=[];for(let c=0;c<a.tblStyleCategoriesField.length;c++){const f=
a.tblStyleCategoriesField[c];if(f.tblStylesField&&0<f.tblStylesField.length){Array.add(this.Cge,Object.assign(new tL,{id:f.idField,begin:b,end:b+f.tblStylesField.length-1}));for(let l=0;l<f.tblStylesField.length;l++){const x=f.tblStylesField[l],G=new D.DictionaryPropertySet,R=new JD(x,f.idField,l);G.me(sb.a.tableStyle,R);this.fyb.push(G);this.Jle.$(x.styleIdField.toLowerCase(),b++)}}}return!0}return!1}vZd(){return this.fyb}dub(a){return 0<=a&&a<this.fyb.length?this.fyb[a]:null}sgj(a,b){let c=null;
for(const f of this.Cge)if(f.id===a){c=f;break}return c&&(a=c.begin+b,a<=c.end)?this.dub(a):null}Bgj(a){return this.M1b(a).mva.styleIdField}Cgj(a){return(a=this.M1b(a).mva.styleNameField)?re.a("TableStyleNameLocalization")?yf.Ogg(a):a:""}vgj(a){return this.M1b(a).$Fg}M1b(a){return a.Xh(sb.a.tableStyle)}Ngg(a){return(a=this.shj(a))?a.Xh(sb.a.tableStyle):null}shj(a){this.t1f();return this.fyb[this.Jle.ga(a.toLowerCase())]}}Object(e.a)(uL,"TableStyleGalleryManager",null,[282]);class vL{constructor(a,
b,c,f,l){this.fL=0;f||(f=Object.assign(new gr.a,{ge:0,Zf:c.oO,$d:0,Lf:c.TQ}));this.Kge=a;this.sak=b;this.Cla=c;this.XD=f;this.Pz=new gr.a;this.dO=this.fL=-1;this.C_c=l}get Hyg(){return-1===this.dO||-1===this.fL}moveNext(){this.Hyg&&(this.dO=this.XD.ge,this.Pz.Lf=this.XD.$d);for(;;){this.fL=this.Pz.Lf;if(this.fL>=this.XD.Lf&&(this.fL=this.XD.$d,++this.dO>=this.XD.Zf))return this.reset(),!1;this.Pz=this.Kge.dI(this.Cla,this.dO,this.fL);if(this.dO===this.XD.ge||this.dO===this.Pz.ge)if(!this.C_c||this.C_c.ZGd(this))return!0}}agk(){this.Hyg&&
(this.fL=this.XD.$d,this.Pz.Zf=this.XD.ge);for(;;){this.dO=this.Pz.Zf;if(this.dO>=this.XD.Zf&&(this.dO=this.XD.ge,++this.fL>=this.XD.Lf)){this.reset();break}this.Pz=this.Kge.dI(this.Cla,this.dO,this.fL);if(this.fL===this.XD.$d||this.fL===this.Pz.$d)if(!this.C_c||this.C_c.ZGd(this))break}}moveTo(a,b){this.Pz=this.Kge.dI(this.Cla,a,b);if(!this.Pz.cRi(this.XD))return this.reset(),!1;this.dO=Math.min(Math.max(a,this.XD.ge),this.XD.Zf-1);this.fL=Math.min(Math.max(b,this.XD.$d),this.XD.Lf-1);return!0}reset(){this.dO=
this.fL=-1}t0b(){return this.sak.jf(this.Pz.ge,this.Pz.$d)}}Object(e.a)(vL,"CellIterator",null,[1071]);class wL{constructor(a){this.Cq=a}WBa(a,b,c,f=null){return new vL(this.Cq,a,b,c,f)}}Object(e.a)(wL,"CellIteratorFactory",null,[276]);class RD{constructor(a,b,c){this.Cq=b;this.Cla=c;this.nC=this.Cq.bKc(this.Cla,a.XD);this.x8=Array(this.nC.TQ*(this.nC.oO+1));this.dO=this.nC.ge;this.J$a=this.nC.$d;this.kyb=this.nC.$d-1;this.Gp=0;this.h8d(a)}h8d(a){const b=a.XD;for(;a.moveNext();){const f=a.Pz;for(let l=
f.$d;l<f.Lf;l++){var c=this.tCa(f.ge,l);this.x8[c]=0!==this.x8[c]?2:l<b.$d&&f.ge>b.ge?16:l>=b.Lf&&f.ge>b.ge?64:1;c=this.tCa(f.Zf,l);this.x8[c]=0!==this.x8[c]?2:l<b.$d&&f.Zf<b.Zf?16:l>=b.Lf&&f.Zf<b.Zf?64:4}}}tCa(a,b){return this.nC.TQ*(a-this.nC.ge)+(b-this.nC.$d)}moveNext(){this.J$a=this.kyb;do{this.J$a++;this.J$a>=this.nC.Lf&&(this.dO++,this.J$a=this.nC.$d);if(this.dO>this.nC.Zf)return!1;this.Gp=this.x8[this.tCa(this.dO,this.J$a)]}while(0===this.Gp);for(this.kyb=this.J$a;this.kyb+1<this.nC.Lf&&this.x8[this.tCa(this.dO,
this.kyb+1)]===this.Gp;)this.kyb++;return!0}r1i(){return this.kyb+1}static n$d(a){return!!(a&87)}}Object(e.a)(RD,"HorizontalTableBorderIterator",null,[1069,401]);class xL{constructor(a){this.Cq=a}Wzi(a,b){return new RD(a,this.Cq,b)}}Object(e.a)(xL,"HorizontalTableBorderIteratorFactory",null,[277]);var Rz;(function(a){a[a.none=0]="none";a[a.firstLayout=1]="firstLayout";a[a.paragraphPropertyChange=2]="paragraphPropertyChange";a[a.cellChildTopoChange=3]="cellChildTopoChange";a[a.rowPropertyChange=4]=
"rowPropertyChange";a[a.cellPropertyChange=5]="cellPropertyChange";a[a.panelLayoutChange=6]="panelLayoutChange";a[a.tablePropertyChange=7]="tablePropertyChange";a[a.tableNodeConnected=8]="tableNodeConnected";a[a.tableViewElementDisconnected=9]="tableViewElementDisconnected";a[a.tableComplexityChange=10]="tableComplexityChange";a[a.slideInvalidateRenderSize=11]="slideInvalidateRenderSize"})(Rz||(Rz={}));Object(e.b)("LayoutInvalidateTrigger",Rz);class yL{constructor(){this.Rha=this.TLd=this.loc=this.aQd=
0}get rowSpan(){return this.TLd-this.loc}toString(){return String.format("C[{0}][{1}]",this.loc,this.Rha)}}Object(e.a)(yL,"CellInfo",null,[]);class hr{constructor(){this.$Sc=!1;this.Vc=this.uOf=this.telemetry=null;this.X9a=this.Ylc=!1;this.lld=null;this.JUg=0;this.tableNode=this.Ude=this.zxa=null;this.KWd=!1}}Object(e.a)(hr,"LayoutContext",null,[]);class zL{constructor(){this.yth=this.Mod=0}}Object(e.a)(zL,"LayoutTelemtry",null,[]);class SD{constructor(){this.offset=this.Bdc=this.index=0}toString(){return String.format("Index {0}, H {1}, O {2}",
this.index,this.Bdc,this.offset)}}Object(e.a)(SD,"RowSeamInfo",null,[]);class Bh{constructor(a,b,c,f,l,x,G){this.sC=null;this.pzb=[];this.yGa=[];this.ZW=0;this.zk=this.P1c=!1;this.Pbb=null;this.W0c=!1;this.T1c=0;this.jg=null;this.az=a;this.yb=f;this.Jk=x;this.Nb=c;this.pX=G;this.h4b(1)}RCj(a,b){if(!this.P1c&&!this.W0c)try{2!==this.ZW&&(1===this.ZW?this.pzb[0]!==a&&this.h4b(b):(this.pzb[this.pzb.length]=a,this.ZW=1,this.T1c=b))}catch(c){this.h4b(0),Aa.a.J(512495695,808,10,"PPTTableLayoutService::InvalidateCell failed {0}",
c.toString())}}h4b(a){this.W0c||2===this.ZW||this.P1c||(this.ZW=2,this.pzb=[],this.T1c=a)}d6d(){return 0!==this.ZW&&!this.P1c}get LSc(){return this.ZW}EDh(a){this.d6d()&&(a=Object.assign(new hr,{tableNode:a}),this.layout(a))}exl(a,b){this.d6d()?this.Pbb||(this.Pbb=new xe.a(3,1,0,Object(C.a)(this,this.cxk,"performLayout"),90,"9"),this.Pbb.customData=Object.assign(new hr,{tableNode:a,$Sc:!0,Ude:b}),this.yb.Cb(this.Pbb)):b&&b(!1)}cxk(a){this.layout(Object(ua.a)(hr,a.customData))}layout(a){this.W0c=!0;
const b=new hd.a(null,Object(C.a)(this,this.Zzj,"initializeLayoutState"),a);b.Xi=!a.$Sc;b.run()}Zzj(a,b){b=Object(ua.a)(hr,b);try{this.aOi();b.Vc=this.jg;b.telemetry=new zL;this.bBl();if(!this.d6d())return a.Zg(Object(C.a)(this,this.Qxa,"tearDownLayout")),!0;this.ZW=0;if(!b.tableNode.isConnected)return a.Zg(Object(C.a)(this,this.Qxa,"tearDownLayout")),!0;const c=Object(ua.a)(1037,b.tableNode.oc(this.az));if(!c)return a.Zg(Object(C.a)(this,this.Qxa,"tearDownLayout")),!0;b.lld=c;b.Vc.Wa(Bh.mci,b.$Sc.toString());
b.tableNode.Ap()?(b.Vc.Wa(Bh.XBg,Rz[this.T1c]),a.Zg(Object(C.a)(this,this.RBk,"prepareTableMetrics"))):(b.Vc.Wa(Bh.XBg,"tableComplexityChange"),b.Ylc=!0,b.X9a=!0,a.Zg(Object(C.a)(this,this.Qxa,"tearDownLayout")))}catch(c){b.Vc.Wa(Bh.V6b,c.message),a.Zg(Object(C.a)(this,this.Qxa,"tearDownLayout"))}return!0}RBk(a,b){b=Object(ua.a)(hr,b);try{b.zxa=new Date,this.pX.v8g(b.tableNode,this.az),b.Vc.Wa(Bh.MBk,(+new Date-+b.zxa).toString()),b.Vc.Wa(Bh.efk,this.pX.WGj.toString()),a.Zg(Object(C.a)(this,this.uUj,
"layoutBaselineTable"))}catch(c){b.Vc.Wa(Bh.V6b,c.message),a.Zg(Object(C.a)(this,this.Qxa,"tearDownLayout"))}return!0}uUj(a,b){b=Object(ua.a)(hr,b);try{b.zxa=new Date;b.KWd=!0;b.JUg=Bh.nek;this.sC=[];this.sC[this.sC.length]=Object.assign(new SD,{index:0,Bdc:0,offset:0});const c=new eh.a(this.az);c.set(b.tableNode);if(!c.Ab(1))throw Error.invalidOperation(Bh.o4f);const f=b.tableNode;let l=c.currentNode,x=l,G=0,R=0,fa=0;for(;l;){15===l.type&&(x=l,fa=G=0,l=c.Ab(1));const wa=l;if(!wa)throw Aa.a.J(512495690,
808,10,"PPTTableLayoutService::LayoutBaselineTable Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");if(1===wa.rowSpan){const Wa=Object(ua.a)(Qs,l.oc(this.az));G=Math.max(G,this.pX.u0b(f,Wa.Vha,R,fa))}l=c.zj(1);fa++;if(!l){const Wa=Object.assign(new SD,{index:this.sC.length});let mb=x.sa(sb.a.au,0);mb=Math.max(mb,this.Jk.NDc(x));let Kb=b.lld.Gd.Fd.Ie(mb,1);Kb=Math.max(Kb,G);Wa.offset=Kb+this.sC[Wa.index-1].offset;Wa.Bdc=Kb;this.sC[this.sC.length]=Wa;l=c.vf(1);R++}}a.Zg(Object(C.a)(this,
this.zUj,"layoutRowSeams"));b.Vc.Wa(Bh.xUj,(+new Date-+b.zxa).toString())}catch(c){b.Vc.Wa(Bh.V6b,c.message),b.Ylc=!0,a.Zg(Object(C.a)(this,this.Qxa,"tearDownLayout"))}return!0}zUj(a,b){b=Object(ua.a)(hr,b);try{if(1===this.sC.length)throw Error.create(Bh.QRi);let c=b.uOf;if(!c){b.zxa=new Date;c=new eh.a(this.az);c.set(b.tableNode);if(!c.Ab(1))throw Error.invalidOperation(Bh.o4f);b.uOf=c}const f=b.tableNode;let l=c.currentNode,x=0,G=0,R=0;for(;l&&x<b.JUg;){15===l.type&&(l=c.Ab(1),G=0);const fa=l;if(!fa)throw Aa.a.J(512495687,
808,10,"PPTTableLayoutService::LayoutRowSeams Cell is Null"),Error.argumentNull("Casting of GraphNode to cell is null");x++;b.telemetry.Mod++;1===fa.rowSpan||bj.OutlineReader.isEmpty(c)?b.telemetry.yth++:this.BUj(this.myi(f,fa,R,G),b.Vc);l=c.zj(1);G++;l||(l=c.vf(1),R++)}l||(this.dll(),a.Zg(Object(C.a)(this,this.tVi,"fixupTableMinRowHeight")),b.Vc.Wa(Bh.AUj,(+new Date-+b.zxa).toString()))}catch(c){b.Vc.Wa(Bh.V6b,c.message),b.Ylc=!0,a.Zg(Object(C.a)(this,this.Qxa,"tearDownLayout"))}return!0}tVi(a,b){b=
Object(ua.a)(hr,b);try{const l=b.lld;b.zxa=new Date;const x=[];var c=new eh.a(this.az);c.set(b.tableNode);for(var f=c.Ab(1);f;)x[x.length]=c.Mq,f=c.zj(1);if(this.yGa.length===x.length){c=[];for(f=0;f<x.length;++f)c[f]=0,1<Math.abs(this.yGa[f]-x[f].htmlElement.offsetHeight)&&(c[f]=this.yGa[f]);for(f=0;f<c.length;++f)0<c[f]&&x[f].LHb(c[f]*l.g2d())}else throw Error.invalidOperation(String.format("RowMisMatch{0},{1}",this.yGa.length,x.length));a.Zg(Object(C.a)(this,this.Qxa,"tearDownLayout"));b.Vc.Wa(Bh.pVi,
(+new Date-+b.zxa).toString());b.X9a=!0}catch(l){b.Vc.Wa(Bh.V6b,l.message),b.Ylc=!0,a.Zg(Object(C.a)(this,this.Qxa,"tearDownLayout"))}return!0}Qxa(a,b){a=Object(ua.a)(hr,b);a.zxa=new Date;a.Ylc?(this.XWk(a.Vc,a.tableNode,a.lld),a.KWd=!0):a.Vc&&(a.Vc.Wa(Bh.DUj,a.telemetry.Mod.toString()),a.Vc.Wa(Bh.CUj,a.telemetry.yth.toString()));this.Pbb&&!a.$Sc&&this.yb.Ng(this.Pbb);this.W0c=!1;this.Pbb=null;this.T1c=0;a.Vc&&(a.Vc.Wa(Bh.X9a,a.X9a.toString()),!a.X9a&&a.Vc&&a.Vc.Wa(Bh.tableLayout,this.pX.JUd(a.tableNode)),
a.Vc.Wa(Bh.Nml,(+new Date-+a.zxa).toString()),a.Vc.finish());a.X9a||(this.P1c=!0);this.sC=null;this.pzb=[];this.jg=null;this.pX.reset();a.Ude&&a.Ude(a.KWd);return!1}XWk(a,b,c){if(b.isConnected)try{const f=new eh.a(this.az);f.set(b);let l=f.Ab(1);for(;l;){const x=Object(ua.a)(Lv,f.ePa);if(!x)throw Error.argument("tableRowViewElement");let G=c.Gd.Fd.Ie(l.sa(sb.a.au,0),1);const R=c.g2d();G*=R;x.LHb(G);l=f.zj(1)}}catch(f){a&&a.Wa(Bh.WWk,f.message)}}BUj(a,b){if(!a)throw Error.create(Bh.PRi);var c=this.sC[a.loc];
const f=this.sC[a.TLd];c=Math.max(this.G9i(c,f),a.aQd)-(f.offset-c.offset);if(!(0>=c)&&(this.u9h(f.index,c),f.offset<=this.sC[f.index-1].offset)){b.Wa(Bh.Uli,a.toString());for(a=0;a<=f.index;++a)b.Wa(Bh.E_k,this.sC[a].toString());throw Error.create(Bh.RRi);}}dll(){if(this.sC){this.yGa=[];for(let a=1;a<this.sC.length;++a)this.yGa[this.yGa.length]=this.sC[a].offset-this.sC[a-1].offset}else this.yGa=null}u9h(a,b){if(b)for(var c=a,f=0;c<this.sC.length;){b=c===a?b:b+this.sC[c].Bdc-this.sC[c].offset+f;
if(0>=b)break;f=this.sC[c].offset;this.sC[c].offset+=b;c++}}G9i(a,b){if(a.index>=b.index)return 0;let c=0;for(a=a.index;a<b.index;)c+=this.sC[a+1].Bdc,a++;return c}myi(a,b,c,f){if(!b||!b.isConnected)return null;const l=Object(ua.a)(Qs,b.oc(this.az)),x=this.Nb.Kc(b);x.pc(14);a=Object.assign(new yL,{aQd:this.pX.u0b(a,l.Vha,c,f),loc:gk.c(x),Rha:f});a.TLd=a.loc+b.rowSpan;return a}dispose(){this.zk||(this.pzb=this.sC=this.yGa=null,this.ZW=0,this.zk=!0)}bBl(){if(this.zk)throw Error.invalidOperation("table layout service is already disposed");
}aOi(){this.jg||(this.jg=Nc.a.Pl("TableLayout"))}get Ma(){return this.az}}Bh.nek=25;Bh.V6b="FailureReason";Bh.WWk="RestoreFailureReason";Bh.tableLayout="Layout";Bh.E_k="SI";Bh.Uli="CI";Bh.mci="FAsync";Bh.DUj="CellVisited";Bh.CUj="CellSkipped";Bh.X9a="Succeeded";Bh.xUj="LETD";Bh.AUj="LRST";Bh.pVi="FMTR";Bh.Nml="TDLD";Bh.MBk="PM";Bh.XBg="Trigger";Bh.efk="MC";Bh.PRi="CellDisconnected";Bh.QRi="ChildOfTableNotLoaded";Bh.RRi="SeamPositionInvariant";Bh.o4f="NoRowViewElement";Object(e.a)(Bh,"PPTTableLayoutService",
null,[1070,106]);class AL{constructor(a,b,c,f,l){this.Nb=a;this.yb=b;this.wak=c;this.Jk=f;this.pX=l}create(a,b){return new Bh(a,b,this.Nb,this.yb,this.wak,this.Jk,this.pX)}}Object(e.a)(AL,"PPTTableLayoutServiceFactory",null,[284]);class BL{constructor(a,b,c,f,l,x,G,R,fa){this.P8j=a;this.Eo=b;this.Nb=c;this.NVa=f;this.gSg=l;this.Rcb=x;this.Vac=G;this.eq=R;this.D0c=!0;this.ume=fa;this.rua=new Lc.a;this.Eo.tF&&!this.Eo.Nj&&(this.D0c=!1);this.D0c&&(this.NVa.AId(Object(C.a)(this,this.jZg,"onBeforeTableViewElementDisconnected")),
this.NVa.rha(Object(C.a)(this,this.a3g,"onTableNodeConnected")),this.NVa.Yj(Object(C.a)(this,this.c3g,"onTableNodePropertyChanged")),this.NVa.R6(Object(C.a)(this,this.b3g,"onTableNodeDisconnected")),this.gSg.Yj(Object(C.a)(this,this.e3g,"onTableRowNodePropertyChanged")),this.Rcb.Yj(Object(C.a)(this,this.C$c,"onTableCellNodePropertyChanged")),this.Rcb.nG(Object(C.a)(this,this.$2g,"onTableCellNodeChildTopoChanged")),this.Vac.Yj(Object(C.a)(this,this.i1g,"onParagraphNodePropertyChanged")),this.eq.d8h(Object(C.a)(this,
this.A2g,"onSlideInvalidateRenderSize")))}XOc(a,b){if(!this.D0c)return null;var c=a.id.toString();this.rua.Jb(c)||this.rua.$(c,new vt.a);c=this.rua.ga(c);var f=a.Ap();f=this.ume?f&&Jd.TableReader.uSf(Object(ua.a)(nb.GraphIterator,this.Nb.Kc(a))):f;if(c.Jb(b))return b=c.ga(b),f||0!==b.LSc||(this.veh(a),b=null),b;if(f)c.$(b,this.P8j.create(b,a.id));else return null;return c.ga(b)}uvb(a,b,c){a.Ap()?this.Dsg(a.id.toString(),b,c):10===c&&this.Dsg(a.id.toString(),b,c)}Dsg(a,b,c){if(this.rua.Jb(a))for(let f of this.rua.ga(a).values)b?
f.RCj(b,c):f.h4b(c)}g9d(a,b,c){a.isConnected&&(a=this.Nb.Kc(a),a.pc(14)&&this.uvb(a.Dw(14),b,c))}JCj(a){a.isConnected&&(a=this.Nb.Kc(a),a.pc(14)&&this.uvb(a.Dw(14),a.Dw(16),2))}jZg(a,b){b.Or.Oc.$o&&this.uvb(b.Or.$a,null,9)}a3g(a,b){this.uvb(b.node,null,8);a=Object(ua.a)(Qz.TableNode,b.node);a=!!a&&a.Ap();Aa.a.J(41007133,808,50,"Render table, isComplexTable: {0}",a)}b3g(a,b){this.veh(b.node)}veh(a){a=a.id.toString();if(this.rua.Jb(a)){const b=this.rua.ga(a);for(let c of b.values)c&&c.dispose();this.rua.remove(a)}}c3g(a,
b){a=b.property;b.node.isConnected&&(a===tb.a.Iu||a===tb.a.ufa||a===tb.a.BA||a===sb.a.dib||a===sb.a.cid||a===sb.a.LJa||a===sb.a.jnc?this.uvb(b.node,null,7):a===sb.a.complexTable&&this.uvb(b.node,null,10))}e3g(a,b){a=b.property;b.node.isConnected&&a===sb.a.au&&this.g9d(b.node,null,4)}C$c(a,b){a=b.property;!b.node.isConnected||a!==sb.a.rowSpan&&a!==sb.a.colSpan||this.g9d(b.node,null,5)}$2g(a,b){b.node.isConnected&&1===b.lZ&&this.g9d(b.node,b.node,3)}i1g(a,b){a=Object(ua.a)(5,b.node);b=b.property;a&&
a.isConnected&&a.Sa(sb.a.cellId)&&!a.xhc&&(b===tb.a.iq||b===tb.a.kib)&&this.JCj(a)}A2g(){for(let a of this.rua.keys)for(let b of this.rua.ga(a).values)b.h4b(11)}dispose(){this.D0c&&(this.NVa.fGe(Object(C.a)(this,this.jZg,"onBeforeTableViewElementDisconnected")),this.NVa.Uma(Object(C.a)(this,this.a3g,"onTableNodeConnected")),this.NVa.tm(Object(C.a)(this,this.c3g,"onTableNodePropertyChanged")),this.NVa.vIa(Object(C.a)(this,this.b3g,"onTableNodeDisconnected")),this.gSg.tm(Object(C.a)(this,this.e3g,"onTableRowNodePropertyChanged")),
this.Rcb.tm(Object(C.a)(this,this.C$c,"onTableCellNodePropertyChanged")),this.Rcb.yO(Object(C.a)(this,this.$2g,"onTableCellNodeChildTopoChanged")),this.Vac.tm(Object(C.a)(this,this.i1g,"onParagraphNodePropertyChanged")),this.eq.VSk(Object(C.a)(this,this.A2g,"onSlideInvalidateRenderSize")))}}Object(e.a)(BL,"PPTTableLayoutServiceManager",null,[285,106]);class TD{constructor(a,b,c){this.Cq=b;this.Cla=c;this.nC=this.Cq.bKc(this.Cla,a.XD);this.x8=Array(this.nC.oO*(this.nC.TQ+1));this.fL=this.nC.$d;this.qcb=
this.nC.ge;this.lBb=this.nC.ge-1;this.Gp=0;this.h8d(a)}h8d(a){const b=a.XD;for(;a.moveNext();){const f=a.Pz;for(let l=f.ge;l<f.Zf;l++){var c=this.tCa(l,f.$d);this.x8[c]=0!==this.x8[c]?32:l<b.ge&&f.$d>b.$d?1:l>=b.Zf&&f.$d>b.$d?4:16;c=this.tCa(l,f.Lf);this.x8[c]=0!==this.x8[c]?32:l<b.ge&&f.Lf<b.Lf?1:l>=b.Zf&&f.Lf<b.Lf?4:64}}}tCa(a,b){return this.nC.oO*(b-this.nC.$d)+(a-this.nC.ge)}moveNext(){this.qcb=this.lBb;do{this.qcb++;this.qcb>=this.nC.Zf&&(this.fL++,this.qcb=this.nC.ge);if(this.fL>this.nC.Lf)return!1;
this.Gp=this.x8[this.tCa(this.qcb,this.fL)]}while(0===this.Gp);for(this.lBb=this.qcb;this.lBb+1<this.nC.Zf&&this.x8[this.tCa(this.lBb+1,this.fL)]===this.Gp;)this.lBb++;return!0}ndj(){return this.lBb+1}static n$d(a){return!!(a&117)}}Object(e.a)(TD,"VerticalTableBorderIterator",null,[400,401]);class nl{constructor(a,b,c,f,l,x,G){this.Jk=a;this.Cq=b;this.Nb=c;this.bA=f;this.gda=l;this.W3j=x;this.Kbk=G}Evl(a,b,c){const f=b.getContainingTable();f&&(this.Arl(b,f,a,c.Lf,c.ge),this.zrl(b,f,a,c.Zf,c.$d))}aYd(a,
b,c,f,l,x){if(c&&c!==b.oO)for(;f<l;f++)if(9===(b.$r(c-1,f)&9)&&5===(b.$r(c,f)&5)){var G=this.Cq.dI(b,c-1,f),R=this.Cq.dI(b,c,f);G=a.jf(G.ge,G.$d);R=a.jf(R.ge,R.$d);x?this.Hqb(R,G,7,0):this.Hqb(G,R,0,7)}}qKe(a,b,c,f,l){l=this.gda.WBa(a,b,c,l);c=f.Z_i();if(TD.n$d(c)){let x=this.Kbk.XDi(l,b);for(;x.moveNext();)0!==(c&x.Gp)&&this.XLe(a,b,x.fL,x.qcb,x.ndj(),f.dub(x.Gp),!0)}if(RD.n$d(c))for(l=this.W3j.Wzi(l,b);l.moveNext();)0!==(c&l.Gp)&&this.QKe(a,b,l.dO,l.J$a,l.r1i(),f.dub(l.Gp),!0)}XLe(a,b,c,f,l,x,G=
!1){let R=this.bA.nPc(a),fa=null;0<c&&(fa=a.jf(f,c-1));let wa=null;for(c<b.TQ&&(wa=a.jf(f,c));f<l;){if(fa){if(6===(b.$r(f,c-1)&6)){var Wa=this.Cq.dI(b,f,c-1),mb=a.jf(Wa.ge,Wa.$d);G&&R?R=this.eHb(R,mb,Wa.ge,Wa.$d,6,x):nl.rlc(6,mb,x)}f+1<l&&(fa=a.jf(f+1,c-1))}wa&&(5===(b.$r(f,c)&5)&&(Wa=this.Cq.dI(b,f,c),mb=a.jf(Wa.ge,Wa.$d),G&&R?R=this.eHb(R,mb,Wa.ge,Wa.$d,5,x):nl.rlc(5,mb,x)),f+1<l&&(wa=a.jf(f+1,c)));f+=1}}cYd(a,b,c,f,l,x){if(c&&c!==b.TQ)for(;f<l;f++)if(6===(b.$r(f,c-1)&6)&&5===(b.$r(f,c)&5)){var G=
this.Cq.dI(b,f,c-1),R=this.Cq.dI(b,f,c);G=a.jf(G.ge,G.$d);R=a.jf(R.ge,R.$d);x?this.Hqb(R,G,5,6):this.Hqb(G,R,6,5)}}QKe(a,b,c,f,l,x,G=!1){let R=this.bA.nPc(a),fa=null;0<c&&(fa=a.jf(c-1,f));let wa=null;for(c<b.oO&&(wa=a.jf(c,f));f<l;){if(fa){if(9===(b.$r(c-1,f)&9)){var Wa=this.Cq.dI(b,c-1,f),mb=a.jf(Wa.ge,Wa.$d);G&&R?R=this.eHb(R,mb,Wa.ge,Wa.$d,0,x):nl.rlc(0,mb,x)}f+1<l&&(fa=a.jf(c-1,f))}wa&&(5===(b.$r(c,f)&5)&&(Wa=this.Cq.dI(b,c,f),mb=a.jf(Wa.ge,Wa.$d),G&&R?R=this.eHb(R,mb,Wa.ge,Wa.$d,7,x):nl.rlc(7,
mb,x)),f+1<l&&(wa=a.jf(c,f)));f+=1}}kAh(a,b,c,f){var l=null;if(!({ge:f}=nl.yAh(b,c,f)).returnValue)return{returnValue:!1,Xja:l};l=6;0<c&&nl.Xvb(b,f,c-1)?(b=this.Cq.dI(b,f,c-1),a=this.Nb.Kc(a.jf(b.ge,b.$d))):(l=5,b=this.Cq.dI(b,f,c),a=this.Nb.Kc(a.jf(b.ge,b.$d)));l=this.xcg(a,l);return{returnValue:!0,Xja:l}}gAh(a,b,c,f){const l=nl.rAh(b,c,f);if(!l.returnValue)return{returnValue:!1,Xja:null};f=0;0<c&&nl.M9a(b,l.$d,c-1)?(b=this.Cq.dI(b,c-1,l.$d),a=this.Nb.Kc(a.jf(b.ge,b.$d))):(f=7,b=this.Cq.dI(b,c,l.$d),
a=this.Nb.Kc(a.jf(b.ge,b.$d)));return{returnValue:!0,Xja:this.xcg(a,f)}}eHb(a,b,c,f,l,x){const G=b.rowSpan;b=b.colSpan;for(let R=c;R<c+G;R++)for(let fa=f;fa<f+b;fa++)a.eHb(R,fa,l,x);return a}xcg(a,b){a=a.pq;if(!a||!a.cellShading)return null;let c=null;({Xja:c}=this.Jk.LTe(b,a.cellShading));return c}Hqb(a,b,c,f){if(a!==b&&!a.id.equals(b.id)){var l=null;b.cellShading&&(l=Kj.a.DQa(b,sb.a.cellShading));l&&({Xja:b}=this.Jk.LTe(f,l),nl.rlc(c,a,b))}}Arl(a,b,c,f,l){let x;({ge:x}=nl.yAh(c,f,l)).returnValue&&
(l=6,0<f&&nl.Xvb(c,x,f-1)?c=this.Cq.dI(c,x,f-1):(l=5,c=this.Cq.dI(c,x,f)),b=b.jf(c.ge,c.$d),this.Hqb(a,b,6,l))}zrl(a,b,c,f,l){let x;({$d:x}=nl.rAh(c,f,l)).returnValue&&(l=0,0<f&&nl.M9a(c,x,f-1)?c=this.Cq.dI(c,f-1,x):(l=7,c=this.Cq.dI(c,f,x)),b=b.jf(c.ge,c.$d),this.Hqb(a,b,0,l))}static rlc(a,b,c){let f=null;b.cellShading&&(f=b.cellShading);if(f){switch(a){case 7:f.lnTField=c;break;case 0:f.lnBField=c;break;case 5:f.lnLField=c;break;case 6:f.lnRField=c}b.cellShading=f}}static yAh(a,b,c){let f,l;f=c;
l=c+1;if(!nl.M9a(a,b,c))return{returnValue:!1,ge:f,Zf:l};for(;0<f&&!(0<b&&nl.Xvb(a,f,b-1))&&!(b<a.TQ&&nl.Xvb(a,f,b));f--);for(;l<a.oO&&!(0<b&&nl.Xvb(a,l,b-1))&&!(b<a.TQ&&nl.Xvb(a,l,b));l++);return{returnValue:!0,ge:f,Zf:l}}static rAh(a,b,c){let f;f=c;for(c+=1;0<f&&!(0<b&&nl.M9a(a,f,b-1))&&!(b<a.oO&&nl.M9a(a,f,b));f--);for(;c<a.TQ&&!(0<b&&nl.M9a(a,c,b-1))&&!(b<a.oO&&nl.M9a(a,c,b));c++);return{returnValue:!0,$d:f,Lf:c}}static M9a(a,b,c){return 0<b&&!(a.$r(c,b-1)&2)||b<a.TQ&&!(a.$r(c,b)&1)?!1:!0}static Xvb(a,
b,c){return 0<b&&!(a.$r(b-1,c)&8)||b<a.oO&&!(a.$r(b,c)&4)?!1:!0}}Object(e.a)(nl,"TableBorderEditor",null,[1034,1035]);class CL{constructor(a,b,c,f){this.Bge=!1;this.Y_=a;this.uak=b;this.MBb=c;this.Hne=f;this.hi=Array(this.Y_.WX);for(a=0;a<this.Y_.WX;a++)for(this.hi[a]=Array(this.Y_.Dqa),b=0;b<this.Y_.Dqa;b++)this.hi[a][b]=new mq.a}Y_i(a,b,c){this.Bge||(this.uak.tWk(a,this.Y_),this.Bge=!0);if(re.a("BugFixCacheInvalidIndex")){if(this.hi&&0<=b&&b<this.hi.length&&this.hi[b]&&0<=c&&c<this.hi[b].length)return this.hi[b][c];
a=String.format("GetBorderStylePropertySet : Illegal cache access m_cache : {0} ,  row : {1}, col : {2} ",this.hi,b,c);this.hi&&(a+=String.format(" m_cache.Length : {0} ",this.hi.length),a=this.hi[b]?a+String.format(" m_cache[ row ].Length : {0} ",this.hi[b].length):a+" m_cache[ row ] is null ");Aa.a.J(559724692,822,15,a);return null}return this.hi[b][c]}eHb(a,b,c,f){var l=this.MBb.aih(c,this.Y_.Pe,f);a=this.hi[a][b];for(var x of l.Mz())a.me(x,l.Xh(x));this.Hne&&re.a("TableBordersLocalRenderingFix")&&
({fOa:l,Y3a:c,hpb:x}=Vp.$Qa(c),f.wFieldSpecified&&(f.noFillField?a.me(l,0):a.me(l,we.a.eVd(f.wField))),f.solidFillField&&a.me(c,f.solidFillField),f.prstDashField&&a.me(x,f.prstDashField))}dispose(){this.hi=null;this.Bge=!1}}Object(e.a)(CL,"TableBorderStyleCache",null,[1033,106]);class UD{constructor(a){this.Bpe=a?1:0}ZGd(a){const b=a.Pz;a=a.XD;return b.$d%2===this.Bpe&&a.bsb(b)}}Object(e.a)(UD,"BandedColumnFilter",null,[1093]);class VD{constructor(a){this.Bpe=a?1:0}ZGd(a){const b=a.Pz;a=a.XD;return b.ge%
2===this.Bpe&&a.bsb(b)}}Object(e.a)(VD,"BandedRowFilter",null,[1093]);class DL{constructor(){this.diagBL2TR=this.right=this.insideVer=this.left=this.diagTL2BR=this.bottom=this.insideHor=this.top=null}Z_i(){let a=0;this.top&&(a|=1);this.insideHor&&(a|=2);this.bottom&&(a|=4);this.diagTL2BR&&(a|=8);this.left&&(a|=16);this.insideVer&&(a|=32);this.right&&(a|=64);this.diagBL2TR&&(a|=128);return a}dub(a){switch(a){case 1:return this.top;case 2:return this.insideHor;case 4:return this.bottom;case 8:return this.diagTL2BR;
case 16:return this.left;case 32:return this.insideVer;case 64:return this.right;case 128:return this.diagBL2TR;default:return null}}}Object(e.a)(DL,"TableBorderSet",null,[]);class EL{constructor(a,b){this.u4=a;this.Aak=b}tWk(a,b){const c=b.WX,f=b.Dqa;var l=b.tableLook;b=b.tableStyle;const x=this.Aak.create(a),G=!!(l&32)&&!!b.firstRowField,R=!!(l&64)&&!!b.lastRowField,fa=!!(l&128)&&!!b.firstColField,wa=!!(l&256)&&!!b.lastColField,Wa=G&&fa&&!!b.nwCellField,mb=G&&wa&&!!b.neCellField,Kb=R&&fa&&!!b.swCellField,
nc=R&&wa&&!!b.seCellField;var oc=!(l&512)&&!!b.band1HField,Ic=!(l&512)&&!!b.band2HField,Kc=!(l&1024)&&!!b.band1VField;const Hc=!(l&1024)&&!!b.band2VField;l=new gr.a;b.wholeTblField&&(l.ge=0,l.Zf=c,l.$d=0,l.Lf=f,this.apply(a,x,b.wholeTblField,l));l.ge=G?1:0;l.Zf=c-(R?1:0);l.$d=0;l.Lf=f;oc&&(oc=new VD(G),this.apply(a,x,b.band1HField,l,oc));Ic&&(Ic=new VD(!G),this.apply(a,x,b.band2HField,l,Ic));l.ge=0;l.Zf=c;l.$d=fa?1:0;l.Lf=f-(wa?1:0);Kc&&(Kc=new UD(fa),this.apply(a,x,b.band1VField,l,Kc));Hc&&(Kc=new UD(!Hc),
this.apply(a,x,b.band2VField,l,Kc));wa&&(l.ge=0,l.Zf=c,l.$d=f-1,l.Lf=f,this.apply(a,x,b.lastColField,l));fa&&(l.ge=0,l.Zf=c,l.$d=0,l.Lf=1,this.apply(a,x,b.firstColField,l));R&&(l.ge=c-1,l.Zf=c,l.$d=0,l.Lf=f,this.apply(a,x,b.lastRowField,l),nc&&(l.$d=f-1,l.Lf=f,this.apply(a,x,b.seCellField,l)),Kb&&(l.$d=0,l.Lf=1,this.apply(a,x,b.swCellField,l)));G&&(l.ge=0,l.Zf=1,l.$d=0,l.Lf=f,this.apply(a,x,b.firstRowField,l),mb&&(l.$d=f-1,l.Lf=f,this.apply(a,x,b.neCellField,l)),Wa&&(l.$d=0,l.Lf=1,this.apply(a,x,
b.nwCellField,l)))}apply(a,b,c,f,l=null){if(!f.$Pa()&&c&&c.tcStyleField&&(c=c.tcStyleField.tcBdrField)){const x=new DL;c.topField&&c.topField.itemField&&(x.top=c.topField.itemField);c.bottomField&&c.bottomField.itemField&&(x.bottom=c.bottomField.itemField);c.insideHField&&c.insideHField.itemField&&(x.insideHor=c.insideHField.itemField);c.leftField&&c.leftField.itemField&&(x.left=c.leftField.itemField);c.rightField&&c.rightField.itemField&&(x.right=c.rightField.itemField);c.insideVField&&c.insideVField.itemField&&
(x.insideVer=c.insideVField.itemField);this.u4.qKe(a,b,f,x,l)}}}Object(e.a)(EL,"TableBorderStyleResolver",null,[279]);class Nv{constructor(){}Ali(a,b){const c=new gr.a;if(a.$Pa())return c;const f=Nv.w5f(b,a,a.ge,!0),l=Nv.w5f(b,a,a.Zf-1,!1),x=Nv.Y4f(b,a,a.$d,!0);a=Nv.Y4f(b,a,a.Lf-1,!1);c.ge=f;c.Zf=l+1;c.$d=x;c.Lf=a+1;return c}CFj(a,b){for(var c=a.ge;c<a.Zf;++c)if(!(b.$r(c,a.$d)&1&&b.$r(c,a.Lf-1)&2))return!1;for(c=a.$d;c<a.Lf;++c)if(!(b.$r(a.ge,c)&4&&b.$r(a.Zf-1,c)&8))return!1;return!0}F9f(a){let b;
b=null;const c=new gr.a;if(!(a&&a.vl&&a.kb&&a.y5))return{returnValue:c,tableNode:b};var f=a.ga(0).hg.Ua,l=Object(ua.a)(Vl.TableCellNode,f.node);l&&(b=l.getContainingTable());if(!l||!b)return{returnValue:c,tableNode:b};f=l.rowIndex;l=l.ni;var x=Object(ua.a)(Vl.TableCellNode,a.ga(0).hg.Ve.node);var G=0;x&&(G=x.ni+1);if(b.Ap()&&1!==a.length){G=Object(ua.a)(Vl.TableCellNode,a.hZa.currentNode);f=Object(ua.a)(Vl.TableCellNode,a.ria.currentNode);if(!G||!f)return{returnValue:c,tableNode:b};l=G.rowIndex;a=
G.ni;x=f.rowIndex;G=f.ni;f=Math.min(l,x);x=Math.max(l,x)+1;l=Math.min(a,G);G=Math.max(G,a)+1}else x=f+a.length;c.ge=f;c.Zf=x;c.$d=l;c.Lf=G;return{returnValue:c,tableNode:b}}dI(a,b,c){b=Object.assign(new gr.a,{ge:b,Zf:b+1,$d:c,Lf:c+1});return this.bKc(a,b)}bKc(a,b){const c=new gr.a;let f=b.ge,l=b.Zf-1;for(var x=b.$d;x<b.Lf;x++){for(var G=b.ge;0<G&&!(a.$r(G,x)&4);G--);G<f&&(f=G);G=b.Zf-1;for(var R=a.oO-1;G<R&&!(a.$r(G,x)&8);G++);G>l&&(l=G)}x=b.$d;G=b.Lf-1;for(R=b.ge;R<b.Zf;R++){let fa=b.$d;for(;0<fa&&
!(a.$r(R,fa)&1);fa--);fa<x&&(x=fa);fa=b.Lf-1;for(const wa=a.TQ-1;fa<wa&&!(a.$r(R,fa)&2);fa++);fa>G&&(G=fa)}c.ge=f;c.$d=x;c.Lf=G+1;c.Zf=l+1;return c}static w5f(a,b,c,f){if(f)for(;0<c;c--)for(f=b.$d;f<b.Lf;++f){if(a.$r(c,f)&4)return c}else for(f=a.oO-1;c<f;c++)for(let l=b.$d;l<b.Lf;++l)if(a.$r(c,l)&8)return c;return c}static Y4f(a,b,c,f){if(f)for(;0<c;c--)for(f=b.ge;f<b.Zf;++f){if(a.$r(f,c)&1)return c}else for(f=a.TQ-1;c<f;++c)for(let l=b.ge;l<b.Zf;++l)if(a.$r(l,c)&2)return c;return c}}Object(e.a)(Nv,
"TableCellSelectionHelper",null,[274]);class FL{constructor(a,b,c){this.tQ=null;this.D3=!1;if(!a||!a.isConnected||14!==a.type)throw Error.argument("tableNode");this.Wd=a;this.tc=b;this.pX=c;this.ZW=3}oWe(){try{var a=nb.GraphIterator.mb(this.Wd);Qd.forEachCellInTable(a,(b,c,f)=>{var l=Object(ua.a)(127,b.currentNode);if(l&&!l.isGhostCell){b=l.rowSpan+c;l=l.colSpan+f;for(let x=c;x<b;++x)for(let G=f;G<l;++G)x===c&&(this.tQ[x][G]|=4),x===b-1&&(this.tQ[x][G]|=8),G===f&&(this.tQ[x][G]|=1),G===l-1&&(this.tQ[x][G]|=
2)}return!0})}catch(b){a=this.pX.JUd(this.Wd),Aa.a.J(38043909,822,15,"TableLayoutInfo:{0}, Message:{1}",a,b.message)}}validate(){if(this.D3)throw Error.invalidOperation("cache disposed");if(0!==this.ZW){if(3===(this.ZW&3)){const a=this.tc.jk(this.Wd),b=this.tc.wi(this.Wd);this.tQ=Array(a);for(let c=0;c<a;++c){this.tQ[c]=Array(b);for(let f=0;f<b;++f)this.tQ[c][f]=0}}1===(this.ZW&1)&&this.oWe();this.ZW=0}}$r(a,b){try{this.validate();var c=this.tQ[a][b]}catch(f){c=this.pX.JUd(this.Wd),Aa.a.J(38043911,
822,15,"NumRows:{0} NumCols:{1} Row:{2} Col:{3}, TableLayoutInfo:{4}, Message:{5}",this.oO,this.TQ,a,b,c,f.message),c=0}return c}gSa(a){this.ZW|=a}dispose(){this.D3=!0;this.tQ=null}get oO(){this.validate();return this.tQ?this.tQ.length:0}get TQ(){this.validate();return this.tQ&&this.tQ.length?this.tQ[0].length:0}}Object(e.a)(FL,"TableInfoCache",null,[1068,106]);class GL{constructor(a,b){this.tc=a;this.pX=b}create(a){return new FL(a,this.tc,this.pX)}}Object(e.a)(GL,"TableInfoCacheFactory",null,[286]);
class Sz{constructor(a,b,c,f,l,x){this.X9j=a;this.r1j=b;this.Dak=c;this.N6j=f;this.Tak=l;this.Iak=x}get WX(){return this.X9j()}get Dqa(){return this.r1j()}get tableLook(){return this.Dak()}get CVj(){return this.N6j()}get Pe(){return this.Tak()}get tableStyle(){return this.Iak()}static FVf(a,b,c,f,l,x){return new Sz(a,b,c,f,l,x)}}Object(e.a)(Sz,"TableListStyleParams",null,[1032]);class HL{constructor(a){this.Lla=null;this.S0c=!1;this.sse=this.jyb=null;this.Nb=a}get WGj(){return!!this.jyb}v8g(a,b){this.sse=
a.id.toString();this.S0c=!this.Nb.n6i(a).currentNode.oc(b).OUc();this.jyb=null;this.S0c&&(a=a.oc(b),this.oOi(),ya.a.kXb(a.htmlElement,this.Lla),this.jyb=this.nUi(this.Lla))}u0b(a,b,c,f){if(a.id.toString()!==this.sse)throw Error.argument("table","Wrong table metrics");if(this.S0c){if(!this.jyb)throw Error.invalidOperation("m_clonedTableNode is null");a=this.jyb.rows[c].cells[f];c=a.lastChild;c.className!==b.className&&(Z.ULS.sendTraceTag(587465758,808,10,"Cell content DOM structure changed, last child {0}",
c.className),c=ya.a.$ba(a,b.className));if(!c)throw Error.invalidOperation("No content");b=c}return b.offsetHeight}reset(){ya.a.vSa(this.Lla)&&this.Lla.parentNode.removeChild(this.Lla);this.jyb=this.Lla=null;this.S0c=!1;this.sse=null}JUd(a){const b=new Sys.StringBuilder;try{b.append(String.format("Row:{0},Col:{1},",a.properties.sa(tb.a.Lxa,0),a.properties.sa(tb.a.ufa,0)));const c=this.Nb.Kc(a);Qd.forEachCellInTable(c,(f,l,x)=>{var G=f.currentNode;f=G.rowSpan;G=G.colSpan;(1<f||1<G)&&b.append(String.format("C[{0}][{1}]:{2}|{3},",
l,x,f,G));return!0});return b.toString()}catch(c){return b.append(c.message),b.toString()}}oOi(){this.Lla||(this.Lla=document.createElement("div"),this.Lla.className="TableMetricsWorkingDiv",document.body.appendChild(this.Lla));ya.a.TAa(this.Lla)}nUi(a){for(a=a.firstChild;a;){if("table"===a.nodeName.toLowerCase())return a;a=a.nextSibling}return null}}Object(e.a)(HL,"TableMetrics",null,[283]);class IL{constructor(a){this.bA=a}uWk(a,b,c){return b&&a&&c&&(a=this.bA.pPc(a).V$f(c,b.rowIndex,b.ni,b.rowSpan,
b.colSpan))&&a!==Hb.a.auto?a.UC:-1}}Object(e.a)(IL,"TableThemeColorHelper",null,[287]);class JL{constructor(a){this.Cq=a}XDi(a,b){return new TD(a,this.Cq,b)}}Object(e.a)(JL,"VerticalTableBorderIteratorFactory",null,[278]);class WD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Table"}Wb(a){this.K=a;this.K.register(274,"PowerPointWebEditor.ITableCellSelectionHelper").ma().na(()=>new Nv);a.register(275,"Box4.ITableDragSelectionCellExtendStrategy").ma().na(()=>new fL(this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.ShapeManipulation.IPPTDragSelectionDragAdapter")));this.K.register(nl,"PowerPointWebEditor.TableBorderEditor").as("PowerPointWebEditor.ITableBorderEditor").as("PowerPointWebEditor.ITableBorderHelper").ma().na(()=>new nl(this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("PowerPointWebEditor.IHorizontalTableBorderIteratorFactory"),this.K.resolve("PowerPointWebEditor.IVerticalTableBorderIteratorFactory")));this.K.register(276,"PowerPointWebEditor.ICellIteratorFactory").ma().na(()=>new wL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(277,"PowerPointWebEditor.IHorizontalTableBorderIteratorFactory").ma().na(()=>new xL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));
this.K.register(278,"PowerPointWebEditor.IVerticalTableBorderIteratorFactory").ma().na(()=>new JL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(279,"PowerPointWebEditor.ITableBorderStyleResolver").ma().na(()=>new EL(this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory")));this.K.register(im,"PowerPointWebEditor.TableEditor").as("PowerPointWebEditor.ITableEditor").as("Box4.ITableEditor").ma().na(()=>
new im(this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("Box4.IOutlineElementEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("PowerPointWebEditor.Graph.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("Box4.IPageView").Ma));this.K.register(OD,"PowerPointWebEditor.TableNodeBehavior").ma().na(()=>new OD(this.K.resolve("Box4.Graph.IGraphInstance").vd(14),this.K.resolve("Box4.ITableNodeBehaviorHelper"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IApplicationSettings").T4d));this.K.register(280,"PowerPointWebEditor.ITableStyleReaderHelper").ma().na(()=>new Vp(this.K.resolve("Box4.IPageView").Fd,
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.ITableStyleResolver"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").PVc));this.K.register(Pz,"PowerPointWebEditor.TableStyleReader").as("Box4.Styles.ITableStyleReader").as("PowerPointWebEditor.IPPTTableStyleReader").as("PowerPointWebEditor.ITableStyleCacheHelper").ma().na(()=>new Pz(this.K.resolve("PowerPointWebEditor.Graph.IPptGraphIteratorFactory"),
this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IPptListCore"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Box4.IPageView").Fd,this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),this.K.resolve("Box4.Graph.IGraphInstance").vd(14),this.K.resolve("PowerPointWebEditor.IPresentationReader"),Sz.FVf,b=>new PD(b,a.resolve("PowerPointWebEditor.ITableStyleResolver")),b=>new ND(b),b=>new CL(b,a.resolve("PowerPointWebEditor.ITableBorderStyleResolver"),
a.resolve("PowerPointWebEditor.ITableStyleResolver"),a.resolve("PowerPointWebEditor.IApplicationSettings").j$),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPointWebEditor.View.IViewEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").Ntg,this.K.resolve("PowerPointWebEditor.IApplicationSettings").FQj,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptNewResolveTableBorderStyleEnabled,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptRenderNonActiveTableAsyncEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").j$));this.K.register(281,"PowerPointWebEditor.ITableStyleResolver").ma().na(()=>new rL(this.K.resolve("PowerPointWebEditor.IApplicationSettings").j$));this.K.register(282,"PowerPointWebEditor.ITableStyleGalleryManager").ma().na(()=>new uL(this.K.Ka("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(283,"PowerPointWebEditor.ITableMetrics").ma().na(()=>
new HL(this.K.resolve("Box4.Graph.IGraphIteratorFactory")));this.K.register(284,"PowerPointWebEditor.IPPTTableLayoutServiceFactory").ma().na(()=>new AL(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(285,"PowerPointWebEditor.IPPTTableLayoutServiceManager").ma().na(()=>new BL(this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceFactory"),
this.K.resolve("Common.IBrowserUtils"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.Graph.IGraphInstance").vd(14),this.K.resolve("Box4.Graph.IGraphInstance").vd(15),this.K.resolve("Box4.Graph.IGraphInstance").vd(16),this.K.resolve("Box4.Graph.IGraphInstance").vd(12),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptComplexTableLayoutSyncEnabled));this.K.register(LD,"PowerPointWebEditor.TableCellNodeBehavior").ma().na(()=>
new LD(this.K.resolve("Box4.Graph.IGraphInstance").vd(16),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")));this.K.register(bL,"Box4.TableReaderProxy").as("Box4.ITableReader").ma();this.K.register(cL,"Box4.TableRowReaderProxy").as("Box4.ITableRowReader").ma();this.K.register(tQ.a,"Box4.TableCellReaderProxy").as("Box4.ITableCellReader").ma();this.K.register(286,"PowerPointWebEditor.ITableInfoCacheFactory").ma().na(()=>
new GL(this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.ITableMetrics")));this.K.register(287,"PowerPointWebEditor.ITableThemeColorHelper").ma().na(()=>new IL(this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader")))}init(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,b=this.K.resolve("Common.IActionManagerExtended");this.K.resolve("PowerPointWebEditor.ITableThemeColorHelper");this.K.resolve("PowerPointWebEditor.View.IPPTPageViewDomManager").BFb(1,
new Mv(this.K.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementUtility"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptCursorContainerManagerIsEnabled?this.K.resolve("PowerPointWebEditor.ShapeManipulation.ICursorContainerManager"):
null,a),new nL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("PowerPointWebEditor.IPPTUnitConversion"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),b,a),new mL(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("Common.CursorManager"),this.K.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,this.K.resolve("PowerPointWebEditor.TableEditor"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),
this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.Styles.ITableStyleReader"),b,this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,a));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393250,new rj.a((c,f)=>new Hl(c,f,this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.IBrowserUtils"),this.K.resolve("PowerPoint.IBrowserHelperManager"),l=>Nx.xXb(l),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager"),this.K.resolve("PowerPointWebEditor.Core.IPkgLoadStatusContext"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("PowerPointWebEditor.IZoomContext"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393251,new rj.a((c,f)=>new Lv(c,f,new Bc.a(c,f,Bc.a.kml))));this.K.resolve("PowerPointWebEditor.ViewElements.IHtmlViewElementFactoryHelper").extend(393252,new eL(this.K.resolve("Box4.ITableCellReader"),this.K.resolve("Box4.Styles.IStyleReader"),
new rj.a((c,f)=>new Qs(c,f,this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IListMarkerUtility"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTTableStyleReader"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventNotifier"),this.K.resolve("Box4.ITableReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptFixCellSizeWithBorder,
this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptIsTableColumnRowResizeHandleRenderedByCSSEnabled,this.K.resolve("PowerPointWebEditor.IApplicationSettings").dja,this.K.resolve("PowerPointWebEditor.IApplicationSettings").j$,this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))));Uc.StyleReader.dr=this.K.resolve("Box4.Styles.ITableStyleReader");this.K.resolve("PowerPointWebEditor.TableNodeBehavior");this.K.resolve("PowerPointWebEditor.TableCellNodeBehavior");this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager")}dispose(){this.K.resolve("PowerPointWebEditor.IPPTTableLayoutServiceManager").dispose()}static main(){m.a.instance.Bc(new WD)}}
Object(e.a)(WD,"PPTWebEditorTablePackage",null,[2,3]);var xQ=d(1197),Nh=d(108);class KL{constructor(){this.podsUrl=this.fileUrl=null}}Object(e.a)(KL,"IFileInfo",null,[]);class LL extends Sys.EventArgs{constructor(a){super();this.slideIndex=a.SlideIndex}}Object(e.a)(LL,"OnPresenterViewSyncMessageEventArgs",Sys.EventArgs,[]);class ML{constructor(){this.messageType=0;this.data=this.sender=null}}Object(e.a)(ML,"IPresentationMessage",null,[]);class NL{constructor(){this.useDefaultResourceProvider=this.thumbnailsEnabled=
!1;this.presenterWindowWidth=this.presenterWindowHeight=0}}Object(e.a)(NL,"IPresenterViewSettings",null,[]);class OL{constructor(){this.uiHost=this.userSessionId=null}}Object(e.a)(OL,"ISessionInfo",null,[]);var yQ=d(527);class PL{constructor(a,b,c){this.xQ="";this.J8=null;this.bbb=!1;this.MAb=null;this.va=new ic.a;this.ia=a;this.la=b;this.Lc=c;this.IBk()}ub(){this.ia.pa(ba.a.Lic,sc.a.application,Object(C.a)(this,this.Lic,"queryUsePresenterView"),96);this.ia.ya(ba.a.dFh,sc.a.application,Object(C.a)(this,
this.$ol,"toggleUsePresenterView"));this.ia.ya(ba.a.Hjd,Bb.a.application,Object(C.a)(this,this.Hjd,"showPresenterView"));this.ia.ya(ba.a.cFc,sc.a.application,Object(C.a)(this,this.cFc,"closePresenterView"));this.bbb=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")}Lic(a,b,c,f,l){(a=Object(ua.a)(Nh.a,l))&&a.Nf(this.bbb);return 32}$ol(a,b,c){if(1===c&&!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return Aa.a.J(512496092,830,10,"PresenterViewManager: presenter view is not enabled but ToggleUsePresenterView is triggered."),
8;2===c&&(this.bbb=!this.bbb,this.Lc.mz(new Wp.a(1)));return 32}Hjd(a,b,c){try{if(!u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))return Aa.a.J(512496091,822,10,"PresenterViewManager: ShowPresenterView triggered but feature is disabled by BRS."),2;if(2===c&&0<this.xQ.length){if(!this.MAb){const f=this.la.podsWebServiceBase,l=String.format("{0}presenter.aspx",f),x=new KL;x.fileUrl=this.xQ;x.podsUrl=f;const G=new OL;G.userSessionId=u.AFrameworkApplication.userSessionId;G.uiHost="UnifiedApp";
const R=new NL;R.presenterWindowWidth=1024;R.presenterWindowHeight=576;this.MAb=new PresenterView.PresentationProxy(2,l,x,G,R)}this.MAb.startPresentation();this.MAb.subscribe(Object(C.a)(this,this.epk,"onPresentationChannelMessageHandler"))}return 32}catch(f){return Aa.a.J(512496090,822,10,"PresenterViewManager: Failed to handle ShowPresenterView: {0}",f),16}}cFc(a,b,c){2===c&&(Aa.a.J(512496089,822,50,"PresenterViewManager: ClosePresenterView called"),this.MAb.terminatePresentation());return 32}F6h(a){this.va.addHandler("OnPresenterViewSyncMessageReceived",
a)}u1k(a){a=this.dci(a);this.MAb.sendMessage(a)}dci(a){const b=new ML;b.sender="slideshow";b.messageType=1;b.data=JSON.stringify({["slideLocation"]:{["slideId"]:{["sid"]:a.slideId,["cid"]:0},["slideIndex"]:a.slideIndex},["timelineMappings"]:a.$nc});return b}epk(a){try{if(!a||0>=a.length)Aa.a.J(512496088,830,15,"No message");else{var b=JSON.parse(a),c=b.sender;if(c&&"slideshow"!==c)switch(b.messageType||Aa.a.J(512496087,830,15,"No message"),b.messageType){case 1:const l=b.data;if(l&&!(0>=l.length)){var f=
JSON.parse(l).slideLocation.slideIndex;this.va.raiseEvent("OnPresenterViewSyncMessageReceived",new LL({["SlideIndex"]:f}))}}}}catch(l){Aa.a.J(512496086,830,10,"Exception: {0}",l)}}IBk(){var a=fb.a.instance.resolve("PowerPointWebEditor.ISessionInfoOwner").podSessionId,b=fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings").podsWebServiceBase;a=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",b,a);b=new xQ.a(u.AFrameworkApplication.Ge);this.J8=yQ.b(b.QJe(a));this.J8.then(c=>
{try{const f=JSON.parse(c),l=f.downloadUrl;Ka.a.Va(l)?Aa.a.J(512496085,822,10,"PresenterViewManager: GetSnappedDownloadLink returned a bad response: {0}",f):this.xQ=l}catch(f){Aa.a.J(512496084,822,10,"PresenterViewManager: Failed to retreive document download URL: {0}",f)}return null})}}Object(e.a)(PL,"PresenterViewManager",null,[273]);class XD{constructor(){this.pb=this.la=this.K=null;this.CLg=!1}get name(){return"PowerPointWebEditor.PresenterView"}Wb(a){this.K=a;this.la=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.pb=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").hF()}init(){u.AFrameworkApplication.fa.ff(Object(C.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){try{(this.CLg=u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled"))&&this.K.resolve("Common.IDynamicScriptLoaderProvider").Jv.loadScript("presenterView").catch(a=>Aa.a.J(594031833,830,10,"Failed to load presenterView js: {0}",a)).then(()=>this.gpk()).catch(a=>Aa.a.J(594031831,830,10,"Failure in OnPresenterScriptLoaded: {0}",a))}catch(a){Z.ULS.sendTraceTag(594031830,
811,10,"PPTWebEditorPresenterViewPackage: exception in OnFullAppSettingsReady: {0}",a)}}gpk(){this.yXb();return null}yXb(){const a=document.createElement("link");a.setAttribute("rel","stylesheet");a.setAttribute("type","text/css");a.setAttribute("href",u.AFrameworkApplication.fa.Ga("PPTPresenterViewCssUrl"));this.pb.appendChild(a);this.K.register(273,"PowerPointWebEditor.PresenterView.IPresenterViewManager").na(()=>new PL(u.AFrameworkApplication.Ta,this.la,this.K.resolve("PowerPointWebEditor.View.IViewEventSource"))).ma();
this.K.resolve("PowerPointWebEditor.PresenterView.IPresenterViewManager").ub()}dispose(){}static main(){m.a.instance.Bc(new XD)}}Object(e.a)(XD,"PPTWebEditorPresenterViewPackage",null,[2,3]);class QL{constructor(a){this.gda=a}zDi(a,b,c){if(c.$Pa())return null;a=this.gda.WBa(a,b,c);for(b=Array(b.oO);a.moveNext();){c=a.t0b();var f=a.Pz;b[f.ge]||(b[f.ge]=[]);f=b[f.ge];f[f.length]=Zq.TableNodeContext.create(c)}a=[];for(c=0;c<b.length;++c)b[c]&&(a[a.length]=new Ua.Selection(b[c],!0));return new Ob.SelectionCollection(a,
a.length-1,0)}}Object(e.a)(QL,"PPTSelectionFactory",null,[271]);class RL{constructor(a,b,c,f){this.pne=this.Cla=this.Fge=null;this.AYh=a;this.JKh=b;this.Cq=c;this.LVa=f}get $li(){return this.JKh}get Rpb(){this.Fge||(this.Fge=this.Cq.Ali(this.$li,this.mY));return this.Fge}get tableNode(){return this.AYh}get mY(){this.Cla||(this.Cla=this.LVa.create(this.tableNode));return this.Cla}get iOj(){this.pne||(this.pne=this.Cq.CFj(this.Rpb,this.mY));return this.pne}}Object(e.a)(RL,"TableCellSelectionInfo",null,
[]);class SL{constructor(a,b){this.LVa=a;this.Cq=b}create(a,b){return new RL(b,a,this.Cq,this.LVa)}}Object(e.a)(SL,"TableCellSelectionInfoFactory",null,[269]);var zQ=d(979);class TL{constructor(a,b,c){this.$Rg=a;this.Cq=b;this.YEa=c}R1b(a){let b=null;const c=new Date,f=({tableNode:a}=this.Cq.F9f(a)).returnValue,l=!f.$Pa();l&&(b=this.$Rg.create(f,a),Nc.a.Eb&&Nc.a.Eb.Wa("CellRange",f.toString()));Aa.a.J(512495623,808,l?50:10,"Table cell selection range {0}, took {1}",f.toString(),+new Date-+c);return b}lfj(a){if(!a)return null;
var b=this.YEa.uA(a);let c=a=null;for(let l=0;l<b.length;++l)if(b[l].Qk){var f=Object(ua.a)(5,b[l].node);if(f){f=f.HK();if(!f)return null;if(!a)a=f,c=a.id.toString();else if(c!==f.id.toString())return null}}if(!a)return null;b=Object.assign(new gr.a,{ge:a.rowIndex,$d:a.ni});b.Zf=b.ge+1;b.Lf=b.$d+1;return this.$Rg.create(b,a.getContainingTable())}}Object(e.a)(TL,"TableSelectionAdapter",null,[270]);class YD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableMergeSplit"}Wb(a){this.K=
a;this.K.register(269,"PowerPointWebEditor.ITableCellSelectionInfoFactory").ma().na(()=>new SL(this.K.resolve("PowerPointWebEditor.ITableInfoCacheFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper")));this.K.register(270,"PowerPointWebEditor.ITableSelectionAdapter").ma().na(()=>new TL(this.K.resolve("PowerPointWebEditor.ITableCellSelectionInfoFactory"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("Box4.Graph.IGraphIteratorFactory"),
this.K.resolve("Box4.ITableRowReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),this.K.resolve("Box4.ITableNavigator")));this.K.register(271,"PowerPointWebEditor.ISelectionFactory").ma().na(()=>new QL(this.K.resolve("PowerPointWebEditor.ICellIteratorFactory")));this.K.register(272,"PowerPointWebEditor.ITableMergeSplitEditor").ma().na(()=>new zQ.TableMergeSplitEditor(this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("Box4.ITableNavigator"),this.K.resolve("Box4.Styles.ITableStyleReader"),
this.K.resolve("PowerPointWebEditor.ITableBorderEditor"),this.K.resolve("PowerPointWebEditor.ITableBorderHelper"),this.K.resolve("PowerPointWebEditor.IGraphUtils"),this.K.resolve("PowerPointWebEditor.ITableEditor"),this.K.resolve("Box4.ITableCellReader"),this.K.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),this.K.resolve("PowerPointWebEditor.ICellIteratorFactory"),this.K.resolve("Box4.IOutlineEditor"),this.K.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),this.K.resolve("Common.Transaction.ITransactionFactory"),
this.K.resolve("Box4.ISelectionManager"),this.K.resolve("PowerPointWebEditor.ISelectionFactory")))}init(){}dispose(){}static main(){m.a.instance.Bc(new YD)}}Object(e.a)(YD,"PPTWebEditorTableMergeSplitPackage",null,[2,3]);class bl{constructor(a,b,c,f,l,x,G,R){this.unb=a;this.eFd=b;this.Ca=c;this.cFd=f;this.rk=l;this.rt=x;this.Xc=G;this.$Qh=R}ub(){this.hed(Cb.App.VJa.bUf())}hed(a){this.Ca.ya(E.a.Hic,Bb.a.view,a);this.Ca.ya(E.a.Hic,Bb.a.table,Object(C.a)(this,this.Hic,"queryTableStyle"));this.Ca.he(E.a.Hic,
103);this.Ca.ya(E.a.V1,Bb.a.view,Object(C.a)(this,this.jRe,"tableStyleGenericViewActionHandler"));this.Ca.ya(E.a.V1,Bb.a.table,Object(C.a)(this,this.V1,"applyTableStyle"));this.Ca.he(E.a.V1,6);this.Ca.ya(E.a.J3a,Bb.a.table,Object(C.a)(this,this.V1,"applyTableStyle"));this.Ca.ya(E.a.FAa,Bb.a.view,Object(C.a)(this,this.jRe,"tableStyleGenericViewActionHandler"));this.Ca.ya(E.a.FAa,Bb.a.table,Object(C.a)(this,this.FAa,"applyTableStyleOption"));this.Ca.he(E.a.FAa,14);this.Ca.ya(E.a.Iic,Bb.a.view,a);this.Ca.ya(E.a.Iic,
Bb.a.table,Object(C.a)(this,this.Iic,"queryTableStyleOption"));this.Ca.he(E.a.Iic,103);this.Ca.ya(E.a.ygc,Bb.a.view,a);this.Ca.ya(E.a.ygc,Bb.a.table,Object(C.a)(this,this.ygc,"populateMenuMoreTableStyles"));this.Ca.he(E.a.ygc,102);this.Ca.ya(E.a.kqb,Bb.a.view,Object(C.a)(this,this.jRe,"tableStyleGenericViewActionHandler"));this.Ca.ya(E.a.kqb,Bb.a.table,Object(C.a)(this,this.kqb,"clearTableFormatting"));this.Ca.he(E.a.kqb,4)}Hic(a,b,c,f,l){if(!({XE:a}=this.Nlc(b,c,l,!0,!0)).returnValue)return a;this.eFd.Fzi(l,
b.node);return 32}Iic(a,b,c,f,l){return this.Lkg(b,c,f,l,!0)}ygc(a,b,c,f,l){if(!({XE:a}=this.Nlc(b,c,l,!1,!0)).returnValue)return a;this.eFd.MAi(l,b.node);Z.ULS.sendTraceTag(7878019,324,50,"Gallery expanded");return 32}V1(a,b,c,f,l){if(!({XE:c}=this.Nlc(b,c,l,!1,!0)).returnValue)return c;const x=b.node;let G=null;(G=a===E.a.V1?this.eFd.kld(l[ai.a.SourceControlId],x):null)?(this.lAe(x,()=>{this.cFd.M7k(G,x)}),c=32):c=8;a===E.a.V1&&32===c&&Z.ULS.sendTraceTag(38410445,311,50,"ApplyTableStyle succeeded");
Z.ULS.shipAssertTag(541172699,324,32===c);return c}FAa(a,b,c,f,l){return this.Lkg(b,c,f,l,!1)}Lkg(a,b,c,f,l){if(!({XE:b}=this.Nlc(a,b,f,l,!0)).returnValue)return b;a=a.node;b=this.unb.p1d(a);const x=f[ai.a.On],G=bl.mhj(u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up?f.MenuItemId:f[ai.a.SourceControlId]);l?f[ai.a.On]=bl.Cbl(b,G):(this.bbi(b,G,x,a),c.IP=G,c.l7=x?0:1,Z.ULS.shipAssertTag(541172700,324,0!==G));return 32}jRe(a,b,c,f,l){return bi.Q4(a,b,c,f,l,{},14)}lAe(a,b){const c=this.rk.ke(15);
try{c.gd(a),this.rt.SXa(),b()}finally{c&&c.dispose()}}Nlc(a,b,c,f,l){return this.SQj(a,b,c,f,l)?{returnValue:f||2===b,XE:32}:{returnValue:!1,XE:8}}SQj(a,b,c,f,l){if(a.contextId!==Bb.a.table)return!1;if(f||2===b)if(l&&!c||!Object(Ma.a)(uy.a,a.node)||this.$Qh(a.node))return!1;return!0}bbi(a,b,c,f){const l=(512===b||1024===b?!c:c)?a|b:a&~b;l!==a&&this.lAe(f,()=>{this.cFd.q5k(l,f)})}kqb(a,b,c,f,l){if(!({XE:a}=this.Nlc(b,c,l,!1,!1)).returnValue)return a;const x=b.node;this.lAe(x,()=>{this.cFd.Epi(x)});
return 32}static fr(){bl.kNa[bl.OUi]=32;bl.kNa[bl.JUi]=128;bl.kNa[bl.WTj]=64;bl.kNa[bl.OTj]=256;bl.kNa[bl.ydi]=512;bl.kNa[bl.xdi]=1024}static Cbl(a,b){a=!!(a&b);if(512===b||1024===b)a=!a;return a}static mhj(a){let b=0;a in bl.kNa&&(b=bl.kNa[a]);return b}}bl.OUi="buttonFirstRow";bl.JUi="buttonFirstColumn";bl.WTj="buttonLastRow";bl.OTj="buttonLastColumn";bl.ydi="buttonBandedRow";bl.xdi="buttonBandedColumn";bl.kNa={};Object(e.a)(bl,"TableStyleActor",null,[]);bl.fr();class yp{constructor(a){this.Wda=
a}M7k(a,b){a=this.Wda.M1b(a);yp.KPf(b);b.setValue(sb.a.LJa,zh.a.Mf(a.mva.styleIdField))}q5k(a,b){b.setValue(sb.a.jnc,a)}Epi(a){yp.KPf(a);a.removeProperty(sb.a.LJa)}static KPf(a){if(a=Object(ua.a)(Qz.TableNode,a)){a=a.S1b();for(const c of a){if(c.cellShading){var b=Fi.b(c.cellShading);b?(a=b,Kx(a),a&&(a.cell3DField=null,a.extLstField=null,a.lnBField=null,a.lnBlToTrField=null,a.lnLField=null,a.lnRField=null,a.lnTField=null,a.lnTlToBrField=null),c.cellShading=b):Aa.a.J(22078240,822,15,"Encountered null cell shading.")}for(const f of yp.Qei){let l;
({fOa:b,Y3a:a,hpb:l}=Vp.$Qa(f));c.removeProperty(a);c.removeProperty(b);c.removeProperty(l)}yp.cpi(Object(ua.a)(lg.a,c))}}else Aa.a.J(587531030,822,10,"Casting of GraphNode to ITableNode is null")}static cpi(a){const b=new yF.a;b.set(a);for(a=b.Ab(1);a;){for(a=b.Ab(2);a;)12===a.type&&yp.epi(a),a=b.zj(2);a=b.zj(1)}}static epi(a){if(a.Ra&&0<a.Ra.length)for(let b=0;b<a.Ra.length;b++)a.Ra.ga(b)&&yp.fpi(a.Ra.ga(b))}static fpi(a){if(a=a.formatting){const f=a.paragraph.Fh;if(f){var b=a.Iz,c=!1;if(b){for(let l=
0;l<yp.DIe.length;l++)b.Sa(yp.DIe[l])&&(c||(c=!0,b=b.clone()),b.removeProperty(yp.DIe[l]));c&&(b=f.pIa(b),a.em=b.id)}}}}}yp.DIe=[tb.a.font,sb.a.latinFont,sb.a.eastAsianFont,sb.a.complexScriptFont,sb.a.mJb,tb.a.fontColor,tb.a.bold,tb.a.italic,sb.a.schemeColor];yp.Qei=[5,6,7,0];Object(e.a)(yp,"PPTTableStyleEditor",null,[349]);class ZD{constructor(){this.K=null}get name(){return"PowerPointWebEditor.TableStyleEditor"}Wb(a){this.K=a}init(){(new bl(this.K.resolve("Box4.Styles.ITableStyleReader"),this.K.resolve("Box4.TableEditors.ITableStyleRibbonControls"),
this.K.resolve("Common.IActionManagerExtended"),new yp(this.K.resolve("PowerPointWebEditor.ITableStyleGalleryManager")),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Box4.IInsertionPointFormatting"),this.K.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,()=>!1)).ub()}dispose(){}static main(){m.a.instance.Bc(new ZD)}}Object(e.a)(ZD,"PPTWebEditorTableStyleEditorPackage",null,[2,3]);class $D{constructor(a,b,c){this.Vse=0;this.yle=!1;this.Hk=a;
this.Ot=b;this.ra=c;this.Hk.LEf(Object(C.a)(this,this.WJf,"beforeForceOutboundGraphTransactionInitialize"));this.Hk.vAa(Object(C.a)(this,this.Zig,"graphTransactionDisposed"));this.Ot.$pa(Object(C.a)(this,this.EWa,"onBeforeValidatePersistence"))}dispose(){this.Hk.Zeh(Object(C.a)(this,this.WJf,"beforeForceOutboundGraphTransactionInitialize"));this.Hk.GXa(Object(C.a)(this,this.Zig,"graphTransactionDisposed"));this.Ot.wjc(Object(C.a)(this,this.EWa,"onBeforeValidatePersistence"))}WJf(){this.Vse++}EWa(){0<
this.Vse&&(this.yle=!0)}Zig(){if(!(0<--this.Vse)&&this.yle){this.yle=!1;var a=Nc.a.Eb;if(a){const b=this.ra.Yd();let c=0;for(const f of b)f.$K&&c++;a.Wa("ShapeCount",b.length.toString());a.Wa("SupportSVGCount",c.toString())}}}}Object(e.a)($D,"SVGShapeTelemetry",null,[106]);class aE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Telemetry"}Wb(a){this.K=a;this.K.register($D,"PowerPointWebEditor.Telemetry.SVGShapeTelemetry").ma().na(()=>new $D(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("Box4.Graph.IGraphInstance").vd(10),this.K.resolve("PowerPointWebEditor.IPptSelectionManager")))}init(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry")}dispose(){this.K.resolve("PowerPointWebEditor.Telemetry.SVGShapeTelemetry").dispose()}static main(){m.a.instance.Bc(new aE)}}Object(e.a)(aE,"PPTWebEditorTelemetryPackage",null,[2,3]);class Tz{}Tz.X9g="faProofing";Object(e.a)(Tz,"ContextMenuControlId",null,[]);class bE{constructor(a,b,c,f,l,x,G){this.CM=b;this.wRb=a;
this.ouc=b.iHj;this.Luc=b.Cbe;this.nQh=x;this.Ytc=f;this.Ztc=l;this.NLa=c;this.ZO=G;this.JLa=new Vb.a;this.JLa.$(1,"SpellingIssue_16x16x32");this.JLa.$(2,"GrammarIssue_16x16x32");this.JLa.$(3,"WritingIssue_16x16x32");this.JLa.$(4,null);this.JLa.$(0,null)}create(a,b,c){b=Object(ua.a)(Po.a,b);if(!b)return Z.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";const f=new Sys.StringBuilder;a=this.mcg(a);this.OXb(f,b,c,a);this.fRd(f,b);this.UBi(f,b,a);return f.toString()}Et(a,b,c){b=
Object(ua.a)(Po.a,b);if(!b)return Z.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),[];const f=[];a=this.mcg(a);this.LRd(f,b,c,a);this.gRd(f,b);this.VBi(f,b,a);return f}OXb(a,b,c,f=null){0===b.errorType?a.append(this.wRb.build()):1===b.errorType&&(this.SPa(b)||a.append(this.hMd(b,c,f)))}LRd(a,b,c,f=null){0===b.errorType?a.push(this.wRb.lLf()):1===b.errorType&&(this.SPa(b)||a.push(this.$fi(b,c,f)))}fRd(a,b){if(!H.a.instance.ga(92)){const c=new Sys.StringBuilder;this.Rsh(b)?c.append(lj.a("btnIgnoreAllSpellingError",
(2===b.errorType?E.a.wnd:E.a.h7d).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.SPa(b)||c.append(lj.a("btnIgrnoreSpellingError",this.Obg(b.errorType).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null));this.Vsh(b)&&(this.CM.I$d&&c.append(lj.a("btnDoNotCheckForThisIssue","2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),c.append(lj.a("btnGrammarOptions","3380187414",Ka.a.je(Box4Intl.Box4Strings.l_GrammarOptions),null)));c.isEmpty()||(a.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),
a.append(c.toString()),a.append("</Controls></MenuSection>"))}}gRd(a,b){if(!H.a.instance.ga(92)){const f=Object.assign(new Mi.a,{ControlList:[]});if(this.Rsh(b)){var c=Object.assign(new Ef.a,{ExternalId:2===b.errorType?"UnknownAllSpellingError":"IgnoreAllSpellingError"});Array.add(f.ControlList,c)}else this.SPa(b)||(c=Object.assign(new Ef.a,{ExternalId:"btnIgrnoreSpellingError",Command:this.Obg(b.errorType).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError}),Array.add(f.ControlList,
c));this.Vsh(b)&&(this.CM.I$d&&(b=Object.assign(new Ef.a,{ExternalId:"DoNotCheckForThisIssue",Command:"2157977488",LabelText:Box4Intl.Box4Strings.l_DoNotCheckForThisIssue}),Array.add(f.ControlList,b)),b=Object.assign(new Ef.a,{ExternalId:"GrammerSettingsContext",Command:"3380187414",LabelText:Box4Intl.Box4Strings.l_GrammarOptions}),Array.add(f.ControlList,b));a.push(f)}}mcg(a){if(!this.ZO)return null;a=this.ZO.language(this.ZO.Ls(a.Ua));return sa.a.oe(a).name}Obg(a){return 2===a?E.a.wnd:this.CM.gwg?
E.a.BRc:E.a.Asa}UBi(a,b,c=null){if(this.XMe(b)){var f=Ka.a.je(b.UM.CategoryTitle);f=lj.j(Tz.X9g,F.a.xob,this.JLa.ga(b.proofingType),""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[a.toString()],this.Ytc,this.Ztc);f=lj.c("cgProofingOuter",[f]);a.clear();a.append(lj.e("msProofingOuter",f,"Menu16",void 0,void 0,c,"ariaLabelledById"));Z.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}VBi(a,b,c=null){if(this.XMe(b)){var f=
Ka.a.je(b.UM.CategoryTitle);c=Object.assign(new gh.a,{ExternalId:String.format("{0}_{1}",Tz.X9g,b.proofingType),Command:"798637440",Image16by16Class:this.JLa.ga(b.proofingType),LabelText:""!==f?f:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:c,Menu:Object.assign(new wj.a,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.u_i(b),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});Array.addRange(c.Menu.MenuSectionList,
a);Array.clear(a);f=Object.assign(new Mi.a,{ControlList:[]});Array.add(f.ControlList,c);a.push(f);Z.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",b.proofingType,b.typeId)}}hMd(a,b,c=null){const f=this.V4i(a);var l=[];let x=!1;var G=a.UM.Suggestions;if(G)if(G=G.slice(0,Math.min(3,G.length)),this.ouc&&(x=!Qa.a.any(G,R=>!R||!R.Description)),1===G.length&&0===G[0].Action)b=Ka.a.je(G[0].Text),l.push(lj.a("btnCorrectWord0","3587447601",b,null,null,null,null,null,
null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,f,b)));else{let R=0,fa=null;x&&(fa="font-weight: bold;");for(const wa of G){if(!wa)continue;G=null;let Wa="",mb=Ka.a.je(wa.Text);x&&(G=this.m9f(wa.Description),Wa=this.l9f(wa.Description));l.push(lj.a("btnCorrectWord"+R,b[R].toString(),mb,null,null,null,null,null,fa,null,G,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,f,mb),"ariaLabelledById",
String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.bTf(a.token)),"ariaDescribedById",Wa));R++}}b="Menu16";0<l.length?x&&(b="Menu16DescriptionEnabled"):l=[lj.a("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)];return lj.e("msUnknownWord",lj.c(null,l),b,f,this.r9i(a),c,"ariaLabelledById")}$fi(a,b,c=null){var f=1!==a.proofingType&&0!==a.proofingType?a.UM.ExplanationTitle:"";f=Object.assign(new Mi.a,{Title:f,Lang:c,ControlList:[]});let l=
!1;var x=a.UM.Suggestions;if(x)if(x=x.slice(0,Math.min(3,x.length)),this.ouc&&(l=!Qa.a.any(x,G=>!G||!G.Description)),1===x.length&&0===x[0].Action)a=x[0],a=Object.assign(new Ef.a,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:a.Text}),Array.add(f.ControlList,a);else{let G=0;for(const R of x){if(!R)continue;x=null;let fa="";l&&(x=this.m9f(R.Description),fa=this.l9f(R.Description));if(G>=b.length)break;x?(x=Object.assign(new mB,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",
G,a.proofingType),Command:b[G].toString(),LabelText:R.Text,Description:x,Lang:c,AriaDescription:fa}),Array.add(f.ControlList,x)):(x=Object.assign(new Ef.a,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",G,a.proofingType),Command:b[G].toString(),LabelText:R.Text,Lang:c,RoleInMenu:"menuitem"}),Array.add(f.ControlList,x));G++}}0>=f.ControlList.length&&Array.add(f.ControlList,Object.assign(new Ef.a,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions}));
return f}V4i(a){return Ka.a.je(1!==a.proofingType&&0!==a.proofingType?a.UM.ExplanationTitle:"")}r9i(a){return this.XMe(a)?null:this.JLa.ga(a.proofingType)}XMe(a){return this.Luc&&2!==a.errorType&&(1!==a.errorType||!this.SPa(a))}Rsh(a){return this.nQh&&0!==a.errorType&&1===a.proofingType&&!this.SPa(a)}u_i(a){return 1===a.proofingType?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,a.token,this.bTf(a.token)):""}Vsh(a){return this.CM.LSa&&this.Luc&&1===a.errorType&&(2===
a.proofingType||3===a.proofingType)}SPa(a){return 0!==a.errorType&&!!this.NLa&&this.NLa.contains(a.token,a.lcid)}m9f(a){return""===a?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):a}l9f(a){return""!==a?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,a):""}bTf(a){let b="";if(a){let c;for(c=0;c<a.length-1;c++)b=b+a.charAt(c)+",";b+=a.charAt(c)}return b}}Object(e.a)(bE,"EditorServiceProofingContextMenuCreator",null,[]);class Aq{B$(a,b){this.jli&&this.kdl(a,
b,Aq.TUg,Aq.kb)}kdl(a,b,c,f){switch(c){case 1:case 6:case 2:case 3:case 4:case 5:Aq.HLi.show(f,a,b)}}RUg(){switch(Aq.TUg){case 5:case 1:return!0;default:return!1}}get jli(){return 1!==Cb.App.Hb.state}static get HLi(){return Aq.Y2e||(Aq.Y2e=fb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu"))}static s9i(a){if(!a)return 0;if(2===Cb.App.Hb.mode)if(H.a.instance.ga(17)&&1===a.length&&bj.OutlineReader.x5b(a.Ua)&&Cb.App.Hb.Hd.nn&&Cb.App.Hb.Hd.nn.$o){if(a=nb.GraphIterator.mb(a.Ua.node),a.Mu(),!Tf.b(a))return 5}else{const b=
a.Ua.node;let c=nb.GraphIterator.mb(b);c.Mu();return $t.e(c.currentNode)?2:u.AFrameworkApplication.$ib||!db.EmbeddedFileReader.T8a(b)||db.EmbeddedFileReader.tN(b)?a.Ua.contextId===Bb.a.iFrame||CI(a.Ua)?6:1:3}else return 4;return 0}static get kb(){return qd.a.instance.Oa.kb}static get TUg(){return Aq.s9i(Aq.kb)}}Aq.Y2e=null;Object(e.a)(Aq,"SelectionContextMenuProvider",null,[262]);class UL{constructor(a){this.la=a}kYd(a,b,c,f,l){const x=c?u.AFrameworkApplication.gm:"";c=c?vo.getImageClass(c):"";return String.format('<FlyoutAnchor Id="{0}" Command="{1}" Image16by16="{2}" \r\n              Image16by16Class="{3}" LabelText="{4}"> {5} </FlyoutAnchor>',
a,b,x,c,Ka.a.je(f),l)}menu(a,b){return String.format('<Menu Id="{0}"> {1} </Menu>',a,b)}menuSection(a,b){return String.format('<MenuSection Id="{0}" DisplayMode="Menu16"><Controls> {1} </Controls></MenuSection>',a,b)}gDi(){let a=ResourceStrings.l_ContextMenuSmartLookup;var b=(new dx.a).getSelectedText();b=(b=b.neighborhood.substr(b.mentionStart,b.mentionLength))?b.trim():null;let c=20;b&&0<b.length&&(b.length>c&&(c=Ka.a.Xw(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b);b&&0<b.length&&(a=String.format(ResourceStrings.l_ContextMenuTextSmartLookup,
b));return a}uni(){var a=(new dx.a).getSelectedText();a=a.neighborhood.substr(a.mentionStart,a.mentionLength);return!(a&&0<a.trim().length)}wDi(){let a=ResourceStrings.l_SynonymsSerpletContextMenu;var b=(new dx.a).getSelectedText();b=b.neighborhood.substr(b.mentionStart,b.mentionLength);if(!b)return a;b=b.trim();let c=14;0<b.length&&(b.length>c&&(c=Ka.a.Xw(b,c)?c-1:c),b=b.length>c?b.substr(0,c).trim()+"...":b,a=String.format(ResourceStrings.l_ContextMenuTextSynonyms,b));return a}}Object(e.a)(UL,"ContextMenuHelper",
null,[268]);class Ox extends mv{constructor(a,b,c,f){super(a,c);this.nGg=b;this.XTa=f}XLc(a){let b=null,c=!1;var f=qd.a.instance.Oa.kb;f=fb.a.instance.resolve("Box4.UI.AEditSurfaceContextMenu").P5d(f,a);switch(this.XTa){case 7:b=["Picture","Comment"];c=!0;break;case 15:case 6:case 10:case 5:b=["Shape","Comment"];c=!0;break;case 8:b=["SmartArtStylesOptions","Comment"];c=!0;break;case 13:case 11:b=["SVG","Comment"];c=!0;break;default:const l=!!this.nGg&&this.nGg.Jyg("1898844988"),x=fb.a.instance.resolve("Box4.ISelectionContextMenuProvider").RUg(),
G=u.AFrameworkApplication.fa.ka("PPTOTableCellBordersEnabled");l?b=G?3===a&&f?"Paste FontFormatting Table TableStyle Comment ContextMenu".split(" "):["FontFormatting","Table","TableStyle","Comment"]:3===a&&f?["Paste","FontFormatting","Table","Comment","ContextMenu"]:["FontFormatting","Table","Comment"]:x&&(b=3===a&&f?["Paste","FontFormatting","Comment","ContextMenu"]:["FontFormatting","Comment"])}3===a&&f&&c&&b.push("ContextMenu");return b}static Czj(a,b,c,f){a.iei(()=>Ox.Wui(b,c,f))}static Wui(a,
b,c){return new Ox(a,b,c,0)}}Object(e.a)(Ox,"PowerPointReactFloatie",mv,[]);class VL{constructor(a,b){this.qHg=b;this.the=a}dispose(){}JF(){}$Ii(){this.the.fra()}o5(a,b,c,f){this.qHg.Hmh(f);this.the.o5(a,b,c)}ldl(a,b,c,f){14===f?this.o5(a,b,c,f):(this.qHg.Hmh(f),a=new Ox(fb.a.instance.qb("Common.IReactContextualUILauncher"),Cb.App.nD.jS,fb.a.instance.qb("Common.IExternalUICommandDefinitionMapping"),f),this.the.tjd(b,c,a,fb.a.instance.qb("Box4.ISelectionContextMenuProvider")))}}Object(e.a)(VL,"ReactContextMenuUser",
null,[266]);class XL{constructor(){this.whitelistedControlIds=this.M$=this.VF=null;this.zSj=!1;this.h4k=this.Ana=this.nvh=null}}Object(e.a)(XL,"ReactStatusBarInitOptions",null,[]);class YL{constructor(){this.whitelistedControlIds=null}}Object(e.a)(YL,"StatusBarProps",null,[]);class Ov{constructor(a,b,c=!0){this.aCd=!1;this.htf=null;this.a3a=b.VF;this.$xf=b.nvh;c?wd.a.get_instance().gk(7,()=>{this.nDc(a,b)}):this.nDc(a,b)}nDc(a,b){const c={};c.StatusBarBuildStartTime=Date.now();window.setTimeout(()=>
{c.FirstTimeoutCallbackExecutionStartTime=Date.now();qc.a.instance.LF(()=>{Ej.UISurfaces.hgj().then(f=>{c.StatusBarApiResolutionTime=Date.now();const l=Object.assign(new YL,{whitelistedControlIds:b.whitelistedControlIds});f.initializeNewStatusBar(a,l,this.$xf);this.htf=f;this.aCd=!0;c.ReactStatusBarInitializedTime=Date.now();window.setTimeout(()=>{c.SecondTimeoutCallbackExecutionStartTime=Date.now();qc.a.instance.LF(()=>{const x=[];if(b.M$){const G=b.M$;for(let R in G)x.push(appChrome.actions.updateControlHiddenState(R,
G[R]));appChrome.api.dispatch(x)}c.PollingStartTime=Date.now();this.JF();c.PollingEndTime=Date.now();Z.ULS.sendTraceTag(509748573,813,50,JSON.stringify(c))},"RSB:I2")},0);return null}).catch(()=>{Z.ULS.sendTraceTag(51656736,324,10,"Failed to load React Status Bar API");return null})},"RSB:I1");if(b.Ana&&a){Ov.w6e||(u.AFrameworkApplication.Ta.ya(F.a.pvh,xd.a.frame,Object(C.a)(this,this.qvh,"statusBarTabAction")),u.AFrameworkApplication.Ta.ya(F.a.ovh,xd.a.frame,Object(C.a)(this,this.qvh,"statusBarTabAction")),
Ov.w6e=!0);const f=Er.a.j8d(b.Ana,b.h4k,a,!1);f.cL=!0;this.rFb(f,F.a.pvh,F.a.ovh)}},0)}JF(){this.aCd&&this.a3a&&window.setTimeout(()=>{this.a3a(this.htf.selectors.getStatusBarControlsMap(this.$xf),7)},0)}h5(a,b){this.aCd&&window.setTimeout(()=>{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState(a,b))},0)}rFb(a,b,c){const f=A.KeyInputManager.Na(w.a.Iq,0),l=A.KeyInputManager.Na(w.a.Iq,4);a.np(f);a.np(l);a.bindAction(f,b);a.bindAction(l,c)}qvh(){return 4}}Ov.w6e=!1;Object(e.a)(Ov,"ReactStatusBar",
null,[]);class cE{constructor(a,b,c,f,l,x,G,R,fa){this.TAb=null;this.h5c={};this.fc=R;this.FBb=a;this.Uk=l;this.p9j=x;this.fak=G;this.QTa=f||new PG.a;this.mh=this.QTa.tRd(3,"StatusBarUser");this.J0j=fa;a=()=>{this.nDc();this.QTa.HXc(3)};this.h5c.callbackRegisterTime=Date.now();re.a("StatusBarTTVRImprovementEnabled")&&Object(Ma.a)(109,this.fc)?this.fc.xvb(a):this.fc.ff(a);this.sOg=c;this.sOg.nG(Object(C.a)(this,this.jfc,"onSlidesTopologyChanged"))}dispose(){this.sOg.yO(Object(C.a)(this,this.jfc,"onSlidesTopologyChanged"))}nDc(){this.h5c.callbackExecutionStartTime=
Date.now();const a=this.mh.ju("createStatusBar"),b=new XL;b.M$=this.ocj();b.zSj=!1;b.VF=Object(C.a)(this,this.Oyl,"updateStatusBarControls");b.nvh="PptEditingStatusBar";re.a("ReactStatusBarRTLSupport")&&u.AFrameworkApplication.isRtl&&this.FBb&&(this.FBb.style.direction="rtl");this.fc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.BuildiReactStatusBarIndependentlyOnAppStage",!1)?this.TAb=new Ov(this.FBb,b,!1):this.J0j.gk(5,()=>{this.TAb=new Ov(this.FBb,b,!1)});this.mh.qu(a);this.h5c.callbackExecutionEndTime=
Date.now();Aa.a.J(512313048,813,50,JSON.stringify(this.h5c))}JF(){this.TAb&&this.TAb.JF()}h5(a,b){this.TAb&&this.TAb.h5(this.Stb(a),!b)}Stb(a){const b=this.p9j.S_d(a);return b&&0<b.count?b.ga(0):a}jfc(a,b){2===b.lZ&&this.JF()}Oyl(a){Cb.App.Hb&&Cb.App.Hb.VF(a)}ocj(){const a=this.fak.Hij(),b={};for(const c of Object.keys(a))b[this.Stb(c)]=a[c];u.AFrameworkApplication.fa.ka("FeedbackPaneExperienceIsEnabled")&&u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(b[this.Stb("PptEditingStatusBar.GiveFeedbackPane")]=
!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.Stb("PptEditingStatusBar.GiveFeedback")]=!0):(b[this.Stb("PptEditingStatusBar.GiveFeedback")]=!u.AFrameworkApplication.fa.ka("ShowFeedback"),b[this.Stb("PptEditingStatusBar.GiveFeedbackPane")]=!0);return b}}cE.xtc=null;Object(e.a)(cE,"ReactStatusBarUser",null,[350,265]);class ZL{constructor(a){this.la=a}Hij(){const a={};this.la.Qvb||(a["PptEditingStatusBar.ZoomScale"]=!0,a["PptEditingStatusBar.FitToWindow"]=!0);this.la.$Eb||(a["PptEditingStatusBar.LanguageButton"]=
!0);this.la.Hsa||(a["PptEditingStatusBar.AddInCommandsLoadStatus"]=!0);this.la.officeOnlineInGallatinTextVisible||(a["PptEditingStatusBar.MiddleStatus"]=!0);this.la.Vrh||(a["PptEditingStatusBar.PerfStats"]=!0);this.la.tg&&(a["PptEditingStatusBar.Reading"]=!0);u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")||(a["PptEditingStatusBar-SlideSorterView"]=!0);u.AFrameworkApplication.fa.ka("PptPresenterViewEnabled")||(a["PptEditingStatusBar-PresenterView"]=!0);return a}}Object(e.a)(ZL,"StatusBarUserHelper",
null,[264]);class dE{constructor(){this.Xuf=null}get Pih(){return this.Xuf||(this.Xuf=fb.a.instance.qb("Common.IRootManager"))}ub(){}xe(){}UAg(){}UXk(){this.Pih&&this.Pih.AFc()}}Object(e.a)(dE,"ABox4BridgeCommandUi",null,[267,106]);class $L extends dE{constructor(a,b,c,f){super();this.BGg=a;this.ZD=b;this.ia=c;this.e4c=f}VF(a){Object(ua.a)(348,this.ZD).xKb(a)}V0(a){return 32===this.ia.La(ba.a.V0,2,a)}cyk(){this.BGg.clearCache();this.ZD.JF()}FKb(){this.ZD.FKb()}ZHe(a){a?a(this.e4c.fra()):this.e4c.fra()}Jyg(a){return this.BGg.T5b(a)}UAg(){const a=
Object(ua.a)(348,this.ZD);a&&a.jUj()}dispose(){}}Object(e.a)($L,"Box4BridgeCommandUi",dE,[]);var eE=d(1198);class ir{static get e7(){return ir.d6||(ir.d6=fb.a.instance.resolve("Box4.IContextMenuController"))}static showContextMenu(a,b){ir.e7.showContextMenu(a,b)}static o5(a,b,c){ir.e7.o5(a,b,c)}static sjd(a,b,c,f=null){ir.e7.sjd(a,b,c,f)}}ir.d6=null;Object(e.a)(ir,"BaseContextMenu",null,[]);class zp extends Xw{constructor(){super();this.vHd();this.fId()}vHd(){this.addCommandToMaps(Object.assign(new Ta.a("AlignCenter",
"4284004393"),{legacyControlId:"CenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignLeft","2539120357"),{legacyControlId:"LeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignRight","393413924"),{legacyControlId:"RightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableTopLeft","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableTopCenter",
"1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableTopRight","1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableCenterLeft","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableCenter","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",
queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableCenterRight","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableBottomLeft","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableBottomCenter","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));
this.addCommandToMaps(Object.assign(new Ta.a("AlignTableBottomRight","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableTopLeft_MLR","428881244"),{legacyControlId:"TableCellJustifyTopLeft",queryCommandId:"1001772032"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableTopCenter_MLR","1718508548"),{legacyControlId:"TableCellJustifyTopCenter",queryCommandId:"43364900"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableTopRight_MLR",
"1925534309"),{legacyControlId:"TableCellJustifyTopRight",queryCommandId:"948656099"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableCenterLeft_MLR","150838934"),{legacyControlId:"TableCellJustifyMiddleLeft",queryCommandId:"3335457338"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableCenter_MLR","3219509138"),{legacyControlId:"TableCellJustifyMiddleCenter",queryCommandId:"296402530"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableCenterRight_MLR","4038626531"),{legacyControlId:"TableCellJustifyMiddleRight",
queryCommandId:"2444984437"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableBottomLeft_MLR","12275744"),{legacyControlId:"TableCellJustifyBottomLeft",queryCommandId:"3942794232"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableBottomCenter_MLR","1910316280"),{legacyControlId:"TableCellJustifyBottomCenter",queryCommandId:"812840340"}));this.addCommandToMaps(Object.assign(new Ta.a("AlignTableBottomRight_MLR","719753309"),{legacyControlId:"TableCellJustifyBottomRight",queryCommandId:"347437379"}));
this.addCommandToMaps(Object.assign(new Ta.a("ApplyStyle","1040747875"),{queryCommandId:"3123760305",populationProps:new Ng("681481568",!1),previewControlIds:["buttonStyle0","buttonStyle1","buttonStyle2","buttonStyle3","buttonStyle4"]}));this.addCommandToMaps(Object.assign(new Ta.a("AutoCorrectOptions","880879461"),{legacyControlId:"fseaOpenAutoCorrectOptionsDialog"}));this.addCommandToMaps(Object.assign(new Ta.a("AutomaticFontColor","3491966299"),{legacyControlId:"fontColor"}));this.addCommandToMaps(Object.assign(new Ta.a("Bold",
"4143129361"),{legacyControlId:"fsbcBold",queryCommandId:"1465813983"}));this.addCommandToMaps(Object.assign(new Ta.a("BulletLibrary","3552651681"),{queryCommandId:"3827179399",populationProps:new Ng("2466004410",!1)}));this.addCommandToMaps(Object.assign(new Ta.a("BulletNone","3552651681"),{queryCommandId:"990335323",menuItemId:"BulletStyleBulletsLibrary_0"}));this.addCommandToMaps(Object.assign(new Ta.a("CellShading","2765388691"),{legacyControlId:"cellShadingColor",populationProps:new Ng("462656847",
!1)}));this.addCommandToMaps(Object.assign(new Ta.a("ClearFormatting","2319895756"),{legacyControlId:"fseaClearFormatting"}));this.addCommandToMaps(Object.assign(new Ta.a("ClearShadingColor","3275596206"),{legacyControlId:"clear"}));this.addCommandToMaps(new Ta.a("ClearStyleFormatting","2319895756"));this.addCommandToMaps(Object.assign(new Ta.a("ClearTableFormatting","3835123874"),{legacyControlId:"fseaClearTableFormatting"}));this.addCommandToMaps(Object.assign(new Ta.a(zp.Ywi,"3383614517"),{legacyControlId:"fseaCopy"}));
this.addCommandToMaps(Object.assign(new Ta.a(zp.eFi,"2309168610"),{legacyControlId:"fseaCut"}));this.addCommandToMaps(Object.assign(new Ta.a("DecreaseIndent","3376107472"),{legacyControlId:"fseaOutdent",queryCommandId:"1599543798"}));this.addCommandToMaps(Object.assign(new Ta.a("DeleteColumn","2983091615"),{legacyControlId:"btnColumnDelete"}));this.addCommandToMaps(Object.assign(new Ta.a("DeleteRow","1368263559"),{legacyControlId:"btnRowDelete"}));this.addCommandToMaps(Object.assign(new Ta.a("DeleteTable",
"1819681963"),{legacyControlId:"btnTableDelete"}));this.addCommandToMaps(Object.assign(new Ta.a("Dictation","1394650145"),{legacyControlId:"btnStartDictation",queryCommandId:"2417470717",populationProps:new Ng("1546254036",!0)}));this.addCommandToMaps(Object.assign(new Ta.a("DictationFloatieToggle","1394650145"),{legacyControlId:"btnDictationFloatieToggle",queryCommandId:"2417470717"}));this.addCommandToMaps(Object.assign(new Ta.a("DictationSettingsLanguages","3662249320"),{queryCommandId:"569982264",
populationProps:new Ng("3836866597",!0)}));this.addCommandToMaps(new Ta.a("DictationSettingsHelp","3819824931"));this.addCommandToMaps(new Ta.a("DictationSettingsHelpShowCommands","2729830074"));this.addCommandToMaps(Object.assign(new Ta.a("DictationSettingsAutoPunctuation","992784617"),{queryCommandId:"1118940415"}));this.addCommandToMaps(Object.assign(new Ta.a("EditInApp","3588168074"),{legacyControlId:"btnOpenInClient"}));this.addCommandToMaps(Object.assign(new Ta.a("EditingView","329275380"),
{legacyControlId:"btnEditOnWeb",queryCommandId:"214409533"}));this.addCommandToMaps(Object.assign(new Ta.a("EditTableAltText","868579142"),{legacyControlId:"btnTableAltText"}));this.addCommandToMaps(Object.assign(new Ta.a("FlipHorizontal","2545543284"),{legacyControlId:"buttonFlipHorizontal",menuItemId:"buttonFlipHorizontal"}));this.addCommandToMaps(Object.assign(new Ta.a("FlipVertical","2545543284"),{legacyControlId:"buttonFlipVertical",menuItemId:"buttonFlipVertical"}));this.addCommandToMaps(Object.assign(new Ta.a("FontColor",
"1970784898"),{legacyControlId:"fontColor",populationProps:new Ng("2077552168",!1)}));u.AFrameworkApplication.fa.ka("FontPreviewEnabled")?(this.addCommandToMaps(Object.assign(new Ta.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Ng("179506844",!1),commandPreviewId:"2655634065",commandRevertId:"1138852411"})),this.addCommandToMaps(Object.assign(new Ta.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462",commandPreviewId:"1666858098",
commandRevertId:"1250696292"}))):(this.addCommandToMaps(Object.assign(new Ta.a("FontName","3430668515"),{legacyControlId:"fontName",queryCommandId:"1223894949",populationProps:new Ng("179506844",!1)})),this.addCommandToMaps(Object.assign(new Ta.a("FontSize","3217001754"),{legacyControlId:"fontSize",queryCommandId:"3829328462"})));this.addCommandToMaps(Object.assign(new Ta.a("FormatPainter","2458503775"),{legacyControlId:"fseaFormatPainter",queryCommandId:"2544399836"}));this.addCommandToMaps(Object.assign(new Ta.a("GrammarSettings",
"3380187414"),{legacyControlId:"btnGrammarSettings"}));this.addCommandToMaps(Object.assign(new Ta.a("GrowFontSize","286819199"),{legacyControlId:"fseaGrowFontSize"}));this.addCommandToMaps(Object.assign(new Ta.a("Highlighter","1784019754"),{legacyControlId:"fontBackgroundColor"}));this.addCommandToMaps(new Ta.a("HighlighterColor","1784019754"));this.addCommandToMaps(Object.assign(new Ta.a("ImmersiveReader","1925081555"),{legacyControlId:"btnImmersiveMode"}));this.addCommandToMaps(Object.assign(new Ta.a("IncreaseIndent",
"4073520836"),{legacyControlId:"fseaIndent",queryCommandId:"2667230914"}));this.addCommandToMaps(Object.assign(new Ta.a("IndentFirstLine","682091331"),{legacyControlId:"buttonSpecialIndentFirstLine",queryCommandId:"1728659747"}));this.addCommandToMaps(Object.assign(new Ta.a("IndentHanging","4114875119"),{legacyControlId:"buttonSpecialIndentHanging",queryCommandId:"4115573199"}));this.addCommandToMaps(Object.assign(new Ta.a("IndentLeft","3058254979"),{legacyControlId:"spnIndentBefore",queryCommandId:"2987841675"}));
this.addCommandToMaps(Object.assign(new Ta.a("IndentNone","3839386673"),{legacyControlId:"buttonSpecialIndentNone",queryCommandId:"738769293"}));this.addCommandToMaps(Object.assign(new Ta.a("IndentRight","1217598046"),{legacyControlId:"spnIndentAfter",queryCommandId:"3085515826"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertAbove","2167983890"),{legacyControlId:"btnInsertRowAbove"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertBelow","3709283166"),{legacyControlId:"btnInsertRowBelow"}));
this.addCommandToMaps(Object.assign(new Ta.a("InsertCameraPicture","2935789186"),{legacyControlId:"fseaInsertCameraPicture"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertEmoji","2994090608"),{legacyControlId:"flyInsertEmojis",queryCommandId:"35811376",populationProps:new Ng("1124716226",!0)}));this.addCommandToMaps(Object.assign(new Ta.a("InsertLeft","1006902144"),{legacyControlId:"btnInsertColumnLeft"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertRight","1735639577"),{legacyControlId:"btnInsertColumnRight"}));
this.addCommandToMaps(Object.assign(new Ta.a("InsertLink","2711544537"),{legacyControlId:"fseaInsertHyperlink"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertPicture","2670646631"),{legacyControlId:"fseaInsertPicture"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertOnlinePicture","1685987254"),{legacyControlId:"fseaFlyInsertOnlinePictureFromSearch"}));this.addCommandToMaps(Object.assign(new Ta.a("InsertPictureFromHost","720118144"),{legacyControlId:"fseaFlyInsertOnlinePictureFromHost",
queryCommandId:"3612507612"}));let a;this.addCommandToMaps((a=new Ta.a("InsertSymbol","3471878106"),a.legacyControlId="flyInsertSymbols",a.populationProps=new Ng("1256496096",!0),a));let b;this.addCommandToMaps((b=new Ta.a("InsertTable","975293073"),b.legacyControlId="flyInsertTable",b));let c;this.addCommandToMaps((c=new Ta.a("Italic","3569444222"),c.legacyControlId="fsbcItalic",c.queryCommandId="4231335074",c));let f;this.addCommandToMaps((f=new Ta.a("Justify","1733835213"),f.legacyControlId="FullJustify",
f.queryCommandId="1257252315",f));let l;this.addCommandToMaps((l=new Ta.a("LeftToRightTextDirection","927903232"),l.legacyControlId="TextDirLTR",l.queryCommandId="1154761034",l));let x;this.addCommandToMaps((x=new Ta.a("LineSpacing","2222099814"),x.legacyControlId="flyLineSpacing",x.populationProps=new Ng("2818132660",!0),x));let G;this.addCommandToMaps((G=new Ta.a("LineSpacingOptions","2465215107"),G.legacyControlId="grpParagraphDialogLauncherButton",G));let R;this.addCommandToMaps((R=new Ta.a("LockAspectRatio",
"3369422509"),R.legacyControlId="toggleBtnLockAspectRatio",R.queryCommandId="4201275867",R));let fa;this.addCommandToMaps((fa=new Ta.a("Margins","1451516907"),fa.legacyControlId="flyMargins",fa));let wa;this.addCommandToMaps((wa=new Ta.a("MergeCells","4127468093"),wa.legacyControlId="btnMergeTableCells",wa));this.addCommandToMaps(new Ta.a("MoreEmojis","1145444901"));this.addCommandToMaps(new Ta.a("MoreStyles","3340688468"));let Wa;this.addCommandToMaps((Wa=new Ta.a("MoreSymbols","3574218963"),Wa.legacyControlId=
"btnMoreSymbols",Wa));let mb;this.addCommandToMaps((mb=new Ta.a("MultilevelStyle1","3062940477"),mb.queryCommandId="1240192421",mb.menuItemId="MultilevelStyleMultilevelLibrary_1",mb));let Kb;this.addCommandToMaps((Kb=new Ta.a("MultilevelStyle2","3062940477"),Kb.queryCommandId="1240192421",Kb.menuItemId="MultilevelStyleMultilevelLibrary_2",Kb));let nc;this.addCommandToMaps((nc=new Ta.a("MultilevelStyle3","3062940477"),nc.queryCommandId="1240192421",nc.menuItemId="MultilevelStyleMultilevelLibrary_3",
nc));let oc;this.addCommandToMaps((oc=new Ta.a("NoHighlight","562361573"),oc.legacyControlId="noFontBackgroundColor",oc));let Ic;this.addCommandToMaps((Ic=new Ta.a("NumberingLibrary","2213049770"),Ic.queryCommandId="3488367157",Ic.populationProps=new Ng("3149136033",!1),Ic));let Kc;this.addCommandToMaps((Kc=new Ta.a("Orientation","1451516907"),Kc.legacyControlId="flyOrientation",Kc));let Hc;this.addCommandToMaps((Hc=new Ta.a("ParagraphOptions","2465215107"),Hc.legacyControlId="grpLayoutParagraphDialogLauncherButton",
Hc));this.addCommandToMaps(new Ta.a(zp.iwk,"237279923"));let ie;this.addCommandToMaps((ie=new Ta.a(zp.dwk,"1656143904"),ie.legacyControlId="fseaNewPaste",ie));this.addCommandToMaps(new Ta.a(zp.cwk,"1656143904"));let He;this.addCommandToMaps((He=new Ta.a("PageSize","1451516907"),He.legacyControlId="flySize",He));this.addCommandToMaps(new Ta.a("Photos","2670646631"));let fe;this.addCommandToMaps((fe=new Ta.a("PictureAbsoluteHeight","2808088361"),fe.legacyControlId="spnAbsoluteHeight",fe.queryCommandId=
"2181343285",fe));let Te;this.addCommandToMaps((Te=new Ta.a("PictureAbsoluteWidth","3108736954"),Te.legacyControlId="spnAbsoluteWidth",Te.queryCommandId="1960824158",Te));this.addCommandToMaps(new Ta.a("Print","1588554917"));let We;this.addCommandToMaps((We=new Ta.a("PrintToWeb","1997662572"),We.legacyControlId="jbtnDigitalPrint",We));let Qf;this.addCommandToMaps((Qf=new Ta.a("ReadingView","3849298593"),Qf.legacyControlId="btnReadingMode",Qf));let mg;this.addCommandToMaps((mg=new Ta.a("Redo","4183277502"),
mg.legacyControlId="btnRedo",mg));let Xg;this.addCommandToMaps((Xg=new Ta.a("ResetPicture","2916220093"),Xg.legacyControlId="btnResetPicture",Xg));let Mg;this.addCommandToMaps((Mg=new Ta.a("RightToLeftTextDirection","2632572640"),Mg.legacyControlId="TextDirRTL",Mg.queryCommandId="1154760330",Mg));let Sf;this.addCommandToMaps((Sf=new Ta.a("RotatePictureMenu","2545543284"),Sf.legacyControlId="flyRotate",Sf));let uh;this.addCommandToMaps((uh=new Ta.a("RotateLeft90","2545543284"),uh.legacyControlId="buttonRotateLeft90",
uh.menuItemId="buttonRotateLeft90",uh));let Sg;this.addCommandToMaps((Sg=new Ta.a("RotateRight90","2545543284"),Sg.legacyControlId="buttonRotateRight90",Sg.menuItemId="buttonRotateRight90",Sg));let li;this.addCommandToMaps((li=new Ta.a("SelectCell","111222446"),li.legacyControlId="btnSelectCell",li));let Ui;this.addCommandToMaps((Ui=new Ta.a("SelectColumn","2341852628"),Ui.legacyControlId="btnSelectColumn",Ui));let Cj;this.addCommandToMaps((Cj=new Ta.a("SelectRow","3508003794"),Cj.legacyControlId=
"btnSelectRow",Cj));let jj;this.addCommandToMaps((jj=new Ta.a("SelectTable","2306914518"),jj.legacyControlId="btnSelectTable",jj));let kj;this.addCommandToMaps((kj=new Ta.a("ShrinkFontSize","3575191971"),kj.legacyControlId="fseaShrinkFontSize",kj));let Gi;this.addCommandToMaps((Gi=new Ta.a("SetProofingLanguage","510284732"),Gi.legacyControlId="fseaOpenLanguageDialog",Gi));let yk;this.addCommandToMaps((yk=new Ta.a("SpacingAfter","2322582597"),yk.legacyControlId="spnSpacingAfter",yk.queryCommandId=
"2340669283",yk));let Dj;this.addCommandToMaps((Dj=new Ta.a("SpacingBefore","1804274502"),Dj.legacyControlId="spnSpacingBefore",Dj.queryCommandId="26138520",Dj));let ok;this.addCommandToMaps((ok=new Ta.a("SpecialIndent","2798144440"),ok.legacyControlId="flySpecialIndent",ok));let Fl;this.addCommandToMaps((Fl=new Ta.a("Spelling","2646312425"),Fl.legacyControlId="fseaNextSpellingError",Fl));let Xk;this.addCommandToMaps((Xk=new Ta.a("StandardShadingColorPicker","2765388691"),Xk.legacyControlId="cellShadingColorTable",
Xk));this.addCommandToMaps(new Ta.a("StandardFontColorPicker","1970784898"));this.addCommandToMaps(new Ta.a("RecentFontColorPicker","1970784898"));let Gl;this.addCommandToMaps((Gl=new Ta.a("Strikethrough","4169095173"),Gl.legacyControlId="fsbcStrikethrough",Gl.queryCommandId="2742230607",Gl));let ak;this.addCommandToMaps((ak=new Ta.a("StyleOptionsBandedColumns","1583455318"),ak.legacyControlId="buttonBandedColumn",ak.queryCommandId="1762426222",ak.menuItemId="buttonBandedColumn",ak));let Sj;this.addCommandToMaps((Sj=
new Ta.a("StyleOptionsBandedRows","1583455318"),Sj.legacyControlId="buttonBandedRow",Sj.queryCommandId="1762426222",Sj.menuItemId="buttonBandedRow",Sj));let bk;this.addCommandToMaps((bk=new Ta.a("StyleOptionsFirstColumn","1583455318"),bk.legacyControlId="buttonFirstColumn",bk.queryCommandId="1762426222",bk.menuItemId="buttonFirstColumn",bk));let Gk;this.addCommandToMaps((Gk=new Ta.a("StyleOptionsHeaderRow","1583455318"),Gk.legacyControlId="buttonFirstRow",Gk.queryCommandId="1762426222",Gk.menuItemId=
"buttonFirstRow",Gk));let Nj;this.addCommandToMaps((Nj=new Ta.a("StyleOptionsLastColumn","1583455318"),Nj.legacyControlId="buttonLastColumn",Nj.queryCommandId="1762426222",Nj.menuItemId="buttonLastColumn",Nj));let vh;this.addCommandToMaps((vh=new Ta.a("StyleOptionsTotalRow","1583455318"),vh.legacyControlId="buttonLastRow",vh.queryCommandId="1762426222",vh.menuItemId="buttonLastRow",vh));let Yk;this.addCommandToMaps((Yk=new Ta.a("Subscript","1455408143"),Yk.legacyControlId="fsbcSubscript",Yk.queryCommandId=
"3960255053",Yk));let Ul;this.addCommandToMaps((Ul=new Ta.a("Superscript","1107614"),Ul.legacyControlId="fsbcSuperscript",Ul.queryCommandId="692901994",Ul));let sm;this.addCommandToMaps((sm=new Ta.a("Table","28738965"),sm.legacyControlId="flyInsertTable",sm));let zk;this.addCommandToMaps((zk=new Ta.a("TableStyles","4171428777"),zk.queryCommandId="2135594455",zk.populationProps=new Ng("3359297384",!1),zk.previewControlIds="buttonTableStyleRibbon0 buttonTableStyleRibbon1 buttonTableStyleRibbon2 buttonTableStyleRibbon3 buttonTableStyleRibbon4 buttonTableStyleRibbon5 buttonTableStyleRibbon6".split(" "),
zk));this.addCommandToMaps(Object.assign(new Ta.a("TextAlignmentAnchor",null),{legacyControlId:"legacyTextAlignmentAnchor"}));this.addCommandToMaps(Object.assign(new Ta.a("TextAlignmentCenterJustify","4284004393"),{legacyControlId:"legacyTextAlignmentCenterJustify",queryCommandId:"3263071675"}));this.addCommandToMaps(Object.assign(new Ta.a("TextAlignmentFullJustify","1733835213"),{legacyControlId:"legacyTextAlignmentFullJustify",queryCommandId:"1257252315"}));this.addCommandToMaps(Object.assign(new Ta.a("TextAlignmentLeftJustify",
"2539120357"),{legacyControlId:"legacyTextAlignmentLeftJustify",queryCommandId:"3797776291"}));this.addCommandToMaps(Object.assign(new Ta.a("TextAlignmentRightJustify","393413924"),{legacyControlId:"legacyTextAlignmentRightJustify",queryCommandId:"2003732276"}));this.addCommandToMaps(new Ta.a("ThemeShadingColorPicker","2765388691"));this.addCommandToMaps(new Ta.a("ThemeShadingColorPickerMCU","2765388691"));this.addCommandToMaps(new Ta.a("ThemeFontColorPicker","1970784898"));this.addCommandToMaps(new Ta.a("ThemeFontColorPickerMCU",
"1970784898"));this.addCommandToMaps(new Ta.a("ToggleChangeCase","1208649786"));this.addCommandToMaps(Object.assign(new Ta.a("Underline","1863297734"),{legacyControlId:"fsbcUnderline",queryCommandId:"2302164066"}));this.addCommandToMaps(Object.assign(new Ta.a("Undo","2792113512"),{legacyControlId:"btnUndo"}));this.addCommandToMaps(new Ta.a("OpenInClientUpsell","3588168074"));this.addCommandToMaps(Object.assign(new Ta.a("SelectAll","344786228"),{legacyControlId:"SelectAllButton"}));this.addCommandToMaps(Object.assign(new Ta.a("EditInClient",
"3588168074"),{legacyControlId:"btnjEditInClient"}));this.addCommandToMaps(Object.assign(new Ta.a("OpenInClient","3588168074"),{legacyControlId:"btnjOpenInClient"}));let pk;this.addCommandToMaps((pk=new Ta.a("PrintDocument","1588554917"),pk.legacyControlId="jbtnDirectPrint",pk));let mi;this.addCommandToMaps((mi=new Ta.a("PrintToPdf","1588554917"),mi.legacyControlId="jbtnPrintToPdf",mi));let wg;this.addCommandToMaps((wg=new Ta.a("ProtectDocument","1642700244"),wg.legacyControlId="btnProtectDocument",
wg.queryCommandId="3993403020",wg));let ni;this.addCommandToMaps((ni=new Ta.a("TransformToWebPage","1997662572"),ni.legacyControlId="jbtnTransformToWeb",ni));let cg;this.addCommandToMaps((cg=new Ta.a("OpenInClientWithIcon","3588168074"),cg.legacyControlId="btnOpenInClient",cg));let Gd;this.addCommandToMaps((Gd=new Ta.a("BulletLibrary_MLR","3552651681"),Gd.queryCommandId="3827179399",Gd.populationProps=new Ng("2466004410",!1),Gd));let Ce;this.addCommandToMaps((Ce=new Ta.a("InsertPicture_MLR","2670646631"),
Ce.legacyControlId="fseaInsertPicture",Ce));let Hf;this.addCommandToMaps((Hf=new Ta.a("NumberingLibrary_MLR","2213049770"),Hf.queryCommandId="3488367157",Hf.populationProps=new Ng("3149136033",!1),Hf));let je;this.addCommandToMaps((je=new Ta.a("PasteStandalone","237279923"),je.legacyControlId="fseaPaste",je));let Fg;this.addCommandToMaps((Fg=new Ta.a("Clipboard_MLR","237279923"),Fg.legacyControlId="fseaNewPaste",Fg));let $h;this.addCommandToMaps(($h=new Ta.a("InsertOnlinePictureStandalone","1685987254"),
$h.legacyControlId="fseaInsertOnlinePicture",$h));let Hi;this.addCommandToMaps((Hi=new Ta.a("InsertPictureFromHostStandalone","720118144"),Hi.legacyControlId="fseaInsertOnlinePictureFromHost",Hi.queryCommandId="3612507612",Hi))}fId(){this.addTabToMap("Picture","3523575366");this.addTabToMap("Table","1898844988")}}zp.eFi="Cut";zp.Ywi="Copy";zp.iwk="Paste";zp.dwk="PasteAsTextOnly";zp.cwk="PasteAsTextOnlyContextMenu";Object(e.a)(zp,"Box4ReactCommandDefinitionMapping",Xw,[]);class Gj extends ir{constructor(a,
b,c){super();this.Osf=b;this.wm=c;this.ub(a)}ub(a){a.pa(E.a.RAe,Bb.a.application,Object(C.a)(this,this.c7g,"populateContextMenu"),96);a.pa(E.a.h7g,Bb.a.application,Object(C.a)(this,this.c7g,"populateContextMenu"),96)}show(a,b,c){let f=null,l=new Sys.UI.Bounds(0,0,0,0);const x=this.Obj(a);if(x&&(a=a.Ua.node)&&(a=a.oc(pa.InteractiveViewManager.instance.Nd.Ma))){l=O.a.Bt(a,x.end);if(u.AFrameworkApplication.isRtl&&l.x>b.x||!u.AFrameworkApplication.isRtl&&l.x+l.width<b.x||l.y+l.height<b.y)l=O.a.Bt(a,x.end-
1);b.x=l.x+(u.AFrameworkApplication.isRtl?0:l.width);b.y=l.y+l.height;f=6}ir.sjd("mnuSpellingError",new Sys.UI.Bounds(b.x,b.y,l.width,l.height),c,f)}c7g(a,b,c,f,l){if(1===c)return 32;a=l.jv;l=l.kd;b=Object.assign(new wj.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]});this.NAi(b,a);l.MenuItems=b;return 32}P5d(a,b){return this.Xsh(a)||Gj.GOf(E.a.lWa)||Gj.GOf(E.a.MIb)||this.ufl(a,b)||this.bdl(a,b)||Gj.oel()||Gj.Bsh(a).returnValue}Xsh(a){return 2===Cb.App.Hb.mode&&this.AUc(a)}OXb(a,
b,c,f=null){if(this.Xsh(a)){c=this.Nbj(a);var l=sa.a.oe(c.lcid);l=l?l.name:"UNKNOWN";var x=Object(Ma.a)(Po.a,c)?c.typeId:"";Z.ULS.sendTraceTag(8712398,324,50,"ErrorType:{0}, ProofingType:{1}, CritiqueId:{2}, CultureTag:{3}",c.errorType,c.proofingType,x,l);f?(a=this.Osf.JXb(a,c))&&f.push.apply(f,a):b.append(this.Osf.create(a,c))}}Nbj(a){return this.wm.KQa(a.Ua).Gh}AUc(a){return this.wm.Ekc(a)}gag(){return null}Obj(a){return this.AUc(a)?this.wm.KQa(a.Ua):(a=this.gag(a))?new Wk.a(a.TM,a.Kb):null}ufl(a,
b){if(2!==Cb.App.Hb.mode||!a||!Gj.XLj&&this.vfl(a,b))return!1;a=Fa.a.WOa(a.toArray());return!!Gj.Yl.Y1(a,14)}vfl(a,b){return 2===b||3===b&&!this.AUc(a)}bdl(a,b){return 3!==b||this.AUc(a)}static get Tf(){return Gj.Sg||(Gj.Sg=fb.a.instance.resolve("Box4.List.IListReader"))}static get Yl(){return Df.ContextSetEditor.instance}static get XLj(){return 1===Cb.App.mode}static get CJj(){null==Gj.Kwd&&(Gj.Kwd=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("HyperlinkContextMenuOnEOPFixIsEnabled"):
!1);return Gj.Kwd}static get Tdc(){null==Gj.t_a&&(Gj.t_a=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("MultiParagraphHyperlinkEditEnabled"):!1);return Gj.t_a}static get YR(){null==Gj.rM&&(Gj.rM=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("AddHyperlinkWhenSelectionContainsLineBreak"):!1);return Gj.rM}static GOf(a){return 32===u.AFrameworkApplication.Ta.processAction(a,1)}static oel(){return 2===Cb.App.Hb.mode&&!!Cb.App.nD.jS&&Cb.App.nD.jS.Jyg("510284732")}static Bsh(a){let b,
c;b=c=!1;if(!a)return{returnValue:!1,LRa:b,w3b:c};if(Gj.Tdc)return Gj.ael(a);if(!(a.sba||Gj.CJj&&2===a.length&&a.Ve.contextId===Bb.a.endOfParagraph))return{returnValue:!1,LRa:b,w3b:c};a=a.Ua.clone();b=32===u.AFrameworkApplication.Ta.ki(a,E.a.WWa,1,!0,null,null);c=32===u.AFrameworkApplication.Ta.ki(a,E.a.insertHyperlink,1,!0,null,null);return{returnValue:b||c,LRa:b,w3b:c}}static ael(a){let b;let c;var f=a.Ua.clone();c=Gj.YR&&Ie.m(f);b=!c&&32===u.AFrameworkApplication.Ta.ki(f,E.a.WWa,1,!0,null,null);
if(a.sba||2===a.length&&a.Ve.contextId===Bb.a.endOfParagraph)f=!c&&32===u.AFrameworkApplication.Ta.ki(f,E.a.insertHyperlink,1,!0,null,null);else{f=!0;const l=a.length;for(let x=0;x<l;x++){const G=a.ga(x).clone();if(G.contextId===Bb.a.paragraph||G.contextId===Bb.a.textRange)(c=Gj.YR&&Ie.m(G))||(f=32===u.AFrameworkApplication.Ta.ki(G,E.a.insertHyperlink,1,!0,null,null)&&f);else if(G.contextId!==Bb.a.endOfParagraph)return f=b=!1,{returnValue:!1,LRa:b,w3b:f}}}return{returnValue:b||f,LRa:b,w3b:f}}static bAi(a,
b){let c=!1,f=!1;({LRa:c,w3b:f}=Gj.Bsh(a)).returnValue&&(c?f?b.push(Gj.x1d(["EditHyperlink","SelectHyperlink","OpenHyperlink","CopyHyperlink","RemoveHyperlink"])):b.push(Gj.x1d(["OpenHyperlink"])):f&&b.push(Gj.x1d(["InsertLink"])))}static x1d(a){const b=Object.assign(new Mi.a,{ControlList:[]});for(const c of a)Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:c}));return b}}Gj.Kwd=null;Gj.Sg=null;Gj.t_a=null;Gj.rM=null;Object(e.a)(Gj,"AEditSurfaceContextMenu",ir,[]);class Uz extends Gj{constructor(a,
b,c,f,l,x,G,R,fa,wa){super(a,c,b,void 0,wa);this.XTa=0;this.uhe=f;this.YEa=l;this.la=x;this.h9j=this.la.$Eb;this.gKg=this.la.K3b;this.bSg=this.la.PVc;this.hSg=this.la.Hce;this.Pbc=this.la.cgb;this.YIg=this.la.HWi;this.f2j=this.la.ehc;this.aPg=wa;this.mC=b;this.jPg=G;this.YD=R;this.Qb=fa}NAi(a,b){const c=[];switch(this.XTa){case 4:this.Rpa(c,!0);this.GDf(c);this.P1h(c);this.h2h(c);this.Pbc&&this.r3h(c);this.RTb(c);this.ENa(c);break;case 7:case 8:case 13:case 15:case 11:case 14:case 16:this.Rpa(c,!1);
this.bId(c,this.XTa);this.RTb(c);this.ENa(c);this.Rqb(c);break;case 6:case 5:this.Rpa(c,!1);this.bId(c,this.XTa);this.la.$Eb&&this.la.Gph&&this.EDf(c);this.ENa(c);this.Rqb(c);break;case 2:this.Rpa(c,!0);this.jBc(c,!0);break;case 1:this.Rpa(c,!1);this.jBc(c,!1);this.GDf(c);this.Q1h(c);this.vDf(c);bx.zqh&&this.nEf(c);this.RTb(c);this.ENa(c);this.Rqb(c);break;case 3:this.F0h(c);this.Rqb(c);break;case 19:this.M3h(c);this.jBc(c,!1);this.vDf(c);bx.zqh&&this.nEf(c);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&
this.gEf(c);this.RTb(c);break;case 21:this.z4h(c);break;case 20:this.Rpa(c,!0);this.jBc(c,!0);u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&this.gEf(c);this.RTb(c);break;case 9:this.Rpa(c,!1);this.ENa(c);break;case 22:this.Rpa(c,!1);this.bId(c,this.XTa);this.ENa(c);break;case 10:this.Rpa(c,!1);this.G2h(c);this.ENa(c);this.Rqb(c);break;case 17:this.B2h(c);break;case 18:this.C2h(c);break;case 0:if(this.Qb.Hj()){var f=pa.InteractiveViewManager.instance.Nd.Gb.Oa.kb;this.OXb(f,null,
b,c);this.Rpa(c,!1);this.la.powerPointSmartLookupIsEnabled&&(this.L3h(c),this.Y3h(c));3===b&&this.fLj(f)&&this.t1h(c);this.W2h(c);Gj.bAi(f,c);this.BDi(f,c);this.ADi(f,c);this.h9j&&this.EDf(c);this.Gyi(c);this.ENa(c);this.Rqb(c)}}for(const l of c)Array.add(a.MenuSectionList,l);this.XTa=0}Hmh(a){this.XTa=a}Et(){return Object.assign(new Mi.a,{ControlList:[]})}tfl(a){if(!this.bSg&&!this.hSg||2!==Cb.App.Hb.mode)return!1;a=Fa.a.WOa(a.toArray());return!!this.YEa.Y1(a,14)}sfl(a){if(!a||!this.f2j||2!==Cb.App.Hb.mode)return!1;
a=Fa.a.WOa(a.toArray());return!!this.YEa.Y1(a,14)}Rpa(a,b){const c=this.Et();b||(Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"Cut"})),Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"Copy"})));this.SDf(a,c)}SDf(a,b){const c=Object.assign(new Mi.a,{DisplayMode:"Size24by24",ControlList:[],Title:ResourceStrings.L_PasteOptions,ShowMenuSectionTitleIcon:!1,ShowMenuSectionTitleBackground:!1,MenuSectionTitleFocusable:!1}),f=Object.assign(new tq.a,{Id:"PasteOptions",ExternalId:"PasteOptionsSection",
ExternalGalleryId:"PasteOptionsGallery",Type:4,Width:5,ElementDimensions:"Size24by24",GalleryItems:[]});Array.add(c.ControlList,f);for(let l=1;5>=l;l++)f.GalleryItems.push(this.VLc(l));a.push(b);a.push(c)}VLc(a){const b={root:{width:"24px",height:"24px"}};let c,f,l;switch(a){case 1:l="ContextMenu.Paste";a="Paste_20";c="3642315978";f=ResourceStrings.L_Paste;break;case 2:l="ContextMenu.PasteKeepingDestinationTheme";a="Pastedestinationtheme_20";c="4207422373";f=ResourceStrings.L_PasteWithDestinationTheme;
break;case 3:l="ContextMenu.PasteKeepingSourceFormatting";a="Pastesourceformatting_20";c="2529825506";f=ResourceStrings.l_PasteWithSourceTheme;break;case 4:l="ContextMenu.PasteAsImage";a="Pasteaspicture_20";c="1302928870";f=ResourceStrings.l_PasteAsImage;break;case 5:l="ContextMenu.PasteTextOnly";a="PasteTextOnly_20";c="2061487721";f=ResourceStrings.L_PasteTextOnly;break;default:l="ContextMenu.Paste",a="Paste_20",c="3642315978",f=ResourceStrings.L_Paste}return Object.assign(new eE.a,{Id:l,Icon:a,
Alt:f,PreviewIconStyle:b,FullIconStyle:b,Command:c})}z4h(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"CopyInVersionHistory"}));a.push(b)}M3h(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"Cut"}));Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"Copy"}));this.SDf(a,b)}jBc(a,b){const c=this.Et();Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"NewSlideWithoutDialog"}));b||(Array.add(c.ControlList,Object.assign(new Ef.a,
{ExternalId:"DuplicateSlide"})),Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"DeleteSlide"})));a.push(c)}P1h(a){if(this.YIg){const b=this.Et();b.ControlList.push(Object.assign(new Ef.a,{ExternalId:"FormatBackgroundFromCanvas"}));a.push(b)}}Q1h(a){if(this.YIg){const b=this.Et();b.ControlList.push(Object.assign(new Ef.a,{ExternalId:"FormatBackgroundFromThumbnailPane"}));a.push(b)}}F0h(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"Paste"}));Array.add(b.ControlList,
Object.assign(new Ef.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}vDf(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"HideSlide"}));this.la.F6d&&Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"UnhideSlide"}));a.push(b)}nEf(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"ShareSlide"}));a.push(b)}C2h(a){const b=this.n$f();a.push(b)}gEf(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"AddSection"}));
a.push(b)}bId(a,b){const c=this.Et();7===b?(this.la.YHa?Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"ChangePictureContextMenu"})):Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"ChangePicture"})),this.la.uSa&&Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"AlternativeText"}))):13===b?this.la.YHa&&Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"ChangeGraphicContextMenu"})):8===b?Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"SmartArtEditText"})):
14!==b&&15!==b&&16!==b&&22!==b&&Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"BeginEditShapeText"}));22!==b&&(this.uDf(c),this.la.bLc&&this.mDf(c));this.aDf(c);this.GKf(c);this.Slh(c);a.push(c)}GDf(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:this.la.yXa?"ChangeLayoutFlyout":"ChangeLayout"}));a.push(b)}EDf(a){const b=this.Et();this.gKg&&Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"ImmersiveReader"}));Array.add(b.ControlList,Object.assign(new Ef.a,
{ExternalId:"OpenPowerPointLanguageDialog"}));a.push(b)}RTb(a){if(this.gKg){var b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"ImmersiveReader"}));a.push(b)}}Slh(a){Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"SendToBackFlyout"}))}GKf(a){Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"BringToFrontFlyout"}))}uDf(a){Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"GroupAnchor"}))}aDf(a){Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"ShowHideFormatShapePane"}))}mDf(a){Array.add(a.ControlList,
Object.assign(new Ef.a,{ExternalId:"FixIt"}))}G2h(a){const b=this.Et();this.uDf(b);this.la.bLc&&this.mDf(b);this.aDf(b);this.GKf(b);this.Slh(b);a.push(b)}ENa(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"InsertComment"}));a.push(b)}h2h(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"DesignerHome"}));a.push(b)}r3h(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"ShowHideRuler"}));a.push(b)}jAi(){const a=
this.uhe.gDi();return Object.assign(new Ef.a,{ExternalId:"SmartLookupContextMenu",LabelText:a})}L3h(a){const b=this.Et();Array.add(b.ControlList,this.jAi());a.push(b)}Y3h(a){if(!this.uhe.uni()){var b=this.uhe.wDi();if(b){var c=this.Et();Array.add(c.ControlList,Object.assign(new Ef.a,{ExternalId:"SmartLookupSynonyms",LabelText:b}));a.push(c)}}}W2h(a){const b=this.Et();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"ParagraphOptions"}));a.push(b)}t1h(a){const b=this.Et();Array.add(b.ControlList,
Object.assign(new Ef.a,{ExternalId:"Delete"}));a.push(b)}Gyi(a){var b=fb.a.instance.qb("PowerPointWebEditor.IContextMenuExtensibilityHandler");b&&(b=b.oYi())&&a.push(b)}BDi(a,b){a&&this.tfl(a)&&(a=this.Et(),this.bSg&&Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"MergeTableCells"})),this.hSg&&Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"SplitTableCells"})),b.push(a))}ADi(a,b){this.sfl(a)&&(a=this.Et(),Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"SetSizeAnchor"})),
Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"TableDistribute"})),b.push(a))}fLj(a){return this.mC.Ekc(a)}B2h(a){const b=this.n$f();Array.add(b.ControlList,Object.assign(new Ef.a,{ExternalId:"NewSlideWithoutDialog"}));a.push(b)}n$f(){const a=this.Et();Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"RenameSection"}));Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"RemoveSection"}));Array.add(a.ControlList,Object.assign(new Ef.a,{ExternalId:"MoveSectionUp"}));Array.add(a.ControlList,
Object.assign(new Ef.a,{ExternalId:"MoveSectionDown"}));return a}Rqb(a){this.jPg&&this.jPg.JXb(this.g0b(),a)}g0b(){return this.YD.instance?this.YD.instance.g0b():[]}}Object(e.a)(Uz,"EditSurfaceContextMenu",Gj,[]);class aM{constructor(a,b,c,f,l,x,G,R,fa,wa){this.Tbc=null;this.kBb=0;this.gO=b;this.ZD=c;this.qka=f;this.yb=x;this.L1j=G;this.ia=fa;this.Lc=R;this.Lc.c5h(Object(C.a)(this,this.sZg,"onCUIStatusChanged"));this.Lc.tBc(Object(C.a)(this,this.YT,"onFocusChanged"));this.Lc.KId(Object(C.a)(this,
this.p$c,"onSetFocus"));this.e4c=wa}get inKeytipMode(){return appChrome.api.inKeytipMode()}dispose(){this.Lc.bRk(Object(C.a)(this,this.sZg,"onCUIStatusChanged"));this.Lc.Jed(Object(C.a)(this,this.YT,"onFocusChanged"));this.Lc.wfh(Object(C.a)(this,this.p$c,"onSetFocus"))}initialize(){this.ub();this.JF()}YT(){}p$c(a,b){b.UCb!==Yb.a.Wea||b.ohc===y.AFrame.rdb||b.ohc.endsWith("/modal")||appChrome.api.enterKeytipMode()}Nql(a){this.kBb|=a;this.Tbc||(this.Tbc=new xe.a(0,1,0,Object(C.a)(this,this.j8k,"setTimeOutWithCurrentActionContext"),
90,"11"),this.Tbc.customData=new Date,this.yb.Cb(this.Tbc))}ub(){this.ia.pa(ba.a.V0,sc.a.application,Object(C.a)(this,this.ipj,"handleOpenMenu"),64)}ipj(a,b,c,f,l){return this.V0(l)?32:8}j8k(a){Nc.a.rPi(Object(C.a)(this,this.JF,"poll"),Object(ua.a)(Date,a.customData));this.Tbc=null}sZg(a,b){this.Nql(b.tjl)}JF(){this.L1j.clearCache();0!==(this.kBb&1)&&this.ZD.JF();0!==(this.kBb&2)&&this.gO.JF();0!==(this.kBb&4)&&this.qka.JF();this.kBb=0}V0(a){return this.e4c.V0(a)}}Object(e.a)(aM,"CUIManager",null,
[263,106]);var fE=d(1199),gE=d(1170),AQ=d(1037),hE=d(1058);class Rs{constructor(){this.italic=0;this.oWc=!1;this.underline=0;this.LU=this.mnd=!1;this.superscript=0;this.Gkd=!1;this.subscript=0;this.Ckd=!1;this.strikethrough=0;this.ukd=!1;this.Js=0;this.OIc=!1;this.fontName=null;this.S_b=this.Nld=this.oLc=this.nLc=!1;this.highlight=0;this.lRc=!1;this.bold=this.italic=this.underline=this.strikethrough=this.Js=this.superscript=this.subscript=2;this.fontColor=this.highlight=this.fontSize=-1;this.Cw=ad.Font.OCj;
this.Hna=-1;this.QLd=this.oWc=this.mnd=this.LU=this.Gkd=this.Ckd=this.ukd=this.OIc=this.nLc=this.oLc=this.Nld=this.S_b=this.lRc=!1}}Object(e.a)(Rs,"FormattingData",null,[]);var iE=d(810),BQ=d(776);class Kk{constructor(){this.Nm=this.ieb=0;this.kd=null;this.GF=!1;this.zK=null}}Object(e.a)(Kk,"CuiEnabledInfo",null,[]);class Zg{constructor(){this.Nm=this.ieb=0;this.kd=null;this.GF=this.Dbe=this.Ebe=this.sW=this.Pq=this.q6d=!1;this.zK=null}}Object(e.a)(Zg,"CuiExecuteInfo",null,[]);class CQ{constructor(){this.oQe=
new mq.a;this.rae=!1}}Object(e.a)(CQ,"TextRangeStyleData",null,[]);class ug{constructor(){this.gb=new ef.a;this.Uc=new ef.a;this.o5e=new Rs;this.Pif=new iE.a;this.$ud=this.Zud=!1}initialize(){ug.Cwh=ug.MRd();this.gb.$(E.a.undo,ug.V3b);this.gb.$(E.a.redo,ug.V3b);this.gb.$(E.a.V7c,ug.V3b);this.gb.$(E.a.h7g,ug.xpl);this.gb.$(E.a.openInClient,ug.Esk);this.gb.$(F.a.close,ug.vqi);this.gb.$(E.a.wK,ug.wIi);this.gb.$(E.a.font,ug.vYd);this.gb.$(E.a.Jr,Object(C.a)(this,this.kZd,"genericFontSizeExecuteBridge"));
u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(this.gb.$(E.a.T4,ug.vYd),this.gb.$(E.a.HIa,ug.vYd),this.gb.$(E.a.$Ha,Object(C.a)(this,this.kZd,"genericFontSizeExecuteBridge")),this.gb.$(E.a.YXa,Object(C.a)(this,this.vXk,"revertPreviewFontSizeExecuteBridge")));this.gb.$(E.a.bold,ug.Asb);this.gb.$(E.a.setItalic,ug.Asb);this.gb.$(E.a.underline,ug.Asb);this.gb.$(E.a.strikethrough,ug.Asb);this.gb.$(E.a.superscript,ug.Asb);this.gb.$(E.a.subscript,ug.Asb);this.gb.$(E.a.Chc,Object(C.a)(this,this.qwa,
"queryFormattingExecuteBridge"));this.gb.$(E.a.Ihc,Object(C.a)(this,this.qwa,"queryFormattingExecuteBridge"));this.gb.$(E.a.Kic,Object(C.a)(this,this.qwa,"queryFormattingExecuteBridge"));this.gb.$(E.a.sic,Object(C.a)(this,this.qwa,"queryFormattingExecuteBridge"));this.gb.$(E.a.uic,Object(C.a)(this,this.qwa,"queryFormattingExecuteBridge"));this.gb.$(E.a.ODe,Object(C.a)(this,this.qwa,"queryFormattingExecuteBridge"));this.gb.$(E.a.Aic,Object(C.a)(this,this.qwa,"queryFormattingExecuteBridge"));this.gb.$(E.a.scd,
Object(C.a)(this,this.qwa,"queryFormattingExecuteBridge"));this.gb.$(E.a.Ghc,Object(C.a)(this,this.qwa,"queryFormattingExecuteBridge"));this.gb.$(E.a.dDe,Object(C.a)(this,this.qwa,"queryFormattingExecuteBridge"));this.gb.$(E.a.eDe,Object(C.a)(this,this.WEk,"queryFormatPainterExecuteBridge"));this.gb.$(E.a.Khc,Object(C.a)(this,this.Fcd,"queryParaFormattingExecuteBridge"));this.gb.$(E.a.jic,Object(C.a)(this,this.Fcd,"queryParaFormattingExecuteBridge"));this.gb.$(E.a.Fhc,Object(C.a)(this,this.Fcd,"queryParaFormattingExecuteBridge"));
this.gb.$(E.a.Hhc,Object(C.a)(this,this.Fcd,"queryParaFormattingExecuteBridge"));this.gb.$(E.a.rD,ug.E2f);this.gb.$(E.a.lz,ug.E2f);this.gb.$(F.a.aPd,ug.Ehc);this.gb.$(E.a.Sde,ug.V3b);this.Uc.$(E.a.vEb,ug.gIc);this.Uc.$(E.a.wEb,ug.gIc);this.Uc.$(E.a.vgc,ug.gIc);this.Uc.$(E.a.kbd,ug.gIc);this.Uc.$(E.a.Chc,ug.Awa);this.Uc.$(E.a.Ihc,ug.Awa);this.Uc.$(E.a.Kic,ug.Awa);this.Uc.$(E.a.sic,ug.Awa);this.Uc.$(E.a.uic,ug.Awa);this.Uc.$(E.a.ODe,ug.Awa);this.Uc.$(E.a.Aic,ug.Awa);this.Uc.$(E.a.scd,ug.Awa);this.Uc.$(E.a.Ghc,
ug.Awa);this.Uc.$(E.a.dDe,ug.Awa);this.Uc.$(E.a.Khc,ug.xed);this.Uc.$(E.a.Fhc,ug.xed);this.Uc.$(E.a.jic,ug.xed);this.Uc.$(E.a.Hhc,ug.xed);this.gb.$(E.a.hRf,Object(C.a)(this,this.EBj,"insertHyperLinkBridge"));this.gb.$(E.a.fPd,Object(C.a)(this,this.gRf,"commandingInputMethodExecuteBridge"));this.gb.$(E.a.lRf,Object(C.a)(this,this.gRf,"commandingInputMethodExecuteBridge"));this.gb.$(E.a.iRf,Object(C.a)(this,this.OBj,"insertOnLinePictureExecuteBridge"));this.gb.$(E.a.jRf,Object(C.a)(this,this.gCj,"insertSymbolBridge"));
this.gb.$(E.a.kRf,Object(C.a)(this,this.Fri,"commandingInsertTableExecuteBridge"));this.gb.$(E.a.Gri,Object(C.a)(this,this.vgk,"navToPageExecuteBridge"));this.gb.$(E.a.fRf,ug.eRf);this.gb.$(E.a.ePd,ug.eRf);u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")&&this.Uc.$(F.a.Dgd,ug.J_k)}clearCache(){this.o5e=new Rs;this.Pif=new iE.a;this.$ud=this.Zud=!1}Eag(a,b,c){const f=this.gb.ga(a);f?c=f(a,b,c):(c=new Zg,c.kd=b);c.ieb=a;c.Nm||(c.Nm=ug.Mck(a));Lg.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.FlagExclusivelyMappedCommands")&&this.yri(a,b)&&(c.kd||(c.kd={}),"object"===typeof c.kd&&(c.kd.MappedCommand=!0));return c}nNc(a,b=null){const c=this.Uc.ga(a);b=c?c(a,b):new Kk;b.ieb=a;b.Nm||(b.Nm=a);return b}qwa(){const a=new Zg;a.q6d=this.$ud;this.$ud=!0;a.Nm=E.a.fFb;a.kd=this.o5e;a.sW=!0;return a}Fcd(){const a=new Zg;a.q6d=this.Zud;this.Zud=!0;a.Nm=E.a.rwa;a.kd=this.Pif;a.Dbe=!0;a.sW=!0;return a}kZd(a,b){const c=new Zg;c.Pq=!0;let f=
0;({number:f}=Ka.a.Gvk(b.CommandValueId||b.Value,u.AFrameworkApplication.numberFormat));if(isNaN(f))return Cb.App.Hb.updateCommandUI(),c.zK=!1,c;a===E.a.$Ha&&(b[sn.a.ffa]=!1);c.kd=ug.EQd(Math.floor(2*f),b);return c}vXk(a,b){a=new Zg;a.Pq=!0;b[sn.a.ffa]=!1;a.kd=ug.EQd(0,b);return a}gRf(a){var b={Visible:!0};a===E.a.fPd?(b.LabelText="Undo",b.SourceControlId="btnUndo"):(b.LabelText="Redo",b.SourceControlId="btnRedo");a=new gE.a(b,2);b=new Zg;b.kd=a;return b}OBj(a,b){a=new Zg;const c=new D.DictionaryPropertySet;
b=b.Value?b.Value:null;if(!b||""===b)return null;b=String.format("<img src={0}>",b);c.setValue(Oc.a.bU,b);a.kd=c;return a}EBj(a,b){a=new Zg;b.Source="CommandingInterface";a.kd=b;return a}Fri(a,b){a=new Zg;a.Pq=!0;const c=new hI;c.rows=b.Row;c.columns=b.Col;a.kd=c;return a}gCj(a,b){a=new Zg;a.Pq=!0;b=b.Value;a.kd=new D.DictionaryPropertySet;const c=this.mPc(b),f={};f.SourceControlId="symbol_"+b+"_"+c;f.InnerHtml=String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',
c);a.kd=f;return a}vgk(a,b){a=new Zg;a.kd=b.Value?b.Value:"";return a}WEk(){const a=new Zg;a.kd=fb.a.instance.qb("Box4.IFormatPainter");a.sW=!0;return a}mPc(a){return ug.Cwh[a.toString()]}yri(a,b){a=b&&b.launcherCommandId?b.launcherCommandId:a;b=!!this.Uc.ga(a)||!!this.gb.ga(a);return!u.AFrameworkApplication.Ta.xS(a)&&b}static MRd(){return{0:"\u2022",1:"\u20ac",2:"\u00a3",3:"\u00a5",4:"\u00a9",5:"\u00ae",6:"\u2122",7:"\u00b1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\u00f7",12:"\u00d7",13:"\u221e",14:"\u00b5",
15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\u00b0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"}}static FUb(a,b){var c=Object(ua.a)(Rs,a.kd),f=Object(ua.a)(iE.a,a.kd);let l=!0;switch(a.ieb){default:l=!1;break;case E.a.k$g:b[ai.a.On]=!0;break;case E.a.Chc:b[ai.a.On]=1===c.bold;break;case E.a.Ihc:b[ai.a.On]=1===c.italic;break;case E.a.Kic:b[ai.a.On]=1===c.underline;break;case E.a.ODe:b[BG.a.On]=1===c.subscript;break;case E.a.uic:b[ai.a.On]=1===c.subscript;break;case E.a.Aic:b[ai.a.On]=
1===c.superscript;break;case E.a.sic:b[ai.a.On]=1===c.strikethrough||1===c.Js;break;case E.a.scd:b[bo.a.IsFreeForm]=!0;b[bo.a.Value]=void 0!==c.fontName&&null!==c.fontName?vb.a.iag(c.fontName,c.Hna):"";break;case E.a.Ghc:a="";-1!==c.fontSize&&(a=Ka.a.ALc(c.fontSize/2,0,u.AFrameworkApplication.numberFormat));b[bo.a.IsFreeForm]=!0;b[bo.a.Value]=a;break;case E.a.dDe:if(void 0!==c.fontName&&null!==c.fontName){if(a=1===c.bold,f=1===c.italic,a=ia.FontUtils.XEk(c.fontName,a,f,a&&f?Box4Intl.Box4Strings.L_FontNameBoldItalic:
a?Box4Intl.Box4Strings.L_FontNameBold:f?Box4Intl.Box4Strings.L_FontNameItalic:"{0}"),void 0===c.fontName||null===c.fontName)a=vb.a.iag(c.fontName,c.Hna),a=appChrome.api.selectedFont(a,c.fontName)}else a=appChrome.api.selectedFont("");void 0!==a.isMissingFont&&null!==a.isMissingFont||void 0===a.name||null===a.name||""===a.name||(a.isMissingFont=ia.FontUtils.isMissingFont(void 0!==a.key&&null!==a.key&&""!==a.key?a.key:a.name));b[co.SelectedFont]=a;break;case E.a.Khc:b[ai.a.On]=1===f.xl;break;case E.a.Fhc:b[ai.a.On]=
2===f.xl;break;case E.a.jic:b[ai.a.On]=3===f.xl;break;case E.a.Hhc:b[ai.a.On]=6===f.xl;break;case E.a.eDe:if(c=Object(ua.a)(986,a.kd))b[ai.a.On]=c.TK;case F.a.aPd:}return l}static E2f(){return new Zg}static Ehc(a,b){a=new Zg;a.kd=b;a.sW=!0;return a}static V3b(a,b,c){a=new gE.a(b,c.InvocationMethod);b=new Zg;b.kd=a;return b}static xpl(a,b){a=new gE.a(b,3);b=new Zg;b.kd=a;return b}static Esk(a,b,c){a=new Zg;AQ.a.TCg(c.CommandLocation)||26===c.CommandLocation||(a.kd=!1);return a}static YCe(){const a=
new Zg;a.kd=new D.DictionaryPropertySet;a.sW=!0;return a}static wIi(){const a=new Zg;a.kd=new D.DictionaryPropertySet;return a}static vqi(){const a=new Zg;a.kd=Li.b;return a}static gIc(){const a=new Kk;a.kd=new D.DictionaryPropertySet;return a}static J_k(a,b=null){a=new Kk;a.kd=b;return a}static Asb(){const a=new Zg;a.kd=new L(2);a.Pq=!0;return a}static xed(){const a=new Kk;a.Nm=E.a.rwa;return a}static Awa(){const a=new Kk;a.Nm=E.a.fFb;return a}static vYd(a,b){const c=new Zg;c.Pq=!0;var f=b.CommandValueId?
b.CommandValueId:b.Value;c.kd=f;if(ad.Font.FSa()){const x=new Rs;var l=b.MenuItemId;l&&(x.Hna=ad.Font.Xhj(l));(l=Object(ua.a)(BQ.a,b[co.Formatting]))&&(l.isBold||l.isItalic)&&(x.bold=l.isBold?1:0,x.italic=l.isItalic?1:0);x.fontName=f;c.kd=x}ug.yYj(b);(a=u.AFrameworkApplication.fa.ka("FontPreviewEnabled")&&(a===E.a.T4||a===E.a.HIa))&&(b[sn.a.ffa]=!1);c.kd=ug.EQd(c.kd,b);a||(ia.FontUtils.$Ac(f),f=b[co.RequestUpdateMru],void 0!==f&&null!==f&&appChrome.api.dispatch(appChrome.actions.addFontToMru(b.SourceControlId,
f)));return c}static yYj(a){void 0!==a[bo.a.IsFreeForm]&&null!==a[bo.a.IsFreeForm]&&a[bo.a.IsFreeForm]?Z.ULS.sendTraceTag(51390360,324,50,"Font applied is not a valid menu item"):void 0!==a.MenuItemId&&null!==a.MenuItemId&&Z.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is in MenuItemID:{0}",a.MenuItemId))}static eRf(a,b){a=new Zg;b=b.Color?b.Color:null;if(!b||6!==b.length)return null;a.kd=ug.Q4a(b);a.Pq=!0;return a}static Q4a(a){return 6!==a.length?null:a.substring(4,6)+a.substring(2,
4)+a.substring(0,2)}static Mck(a){switch(a){case E.a.fPd:return E.a.undo;case E.a.lRf:return E.a.redo;case E.a.kRf:return E.a.insertTable;case E.a.iRf:return E.a.tqa;case E.a.jRf:return E.a.dSa;case E.a.hRf:return E.a.insertHyperlink;case E.a.fRf:return E.a.gt;case E.a.ePd:return E.a.w$;default:return a}}static EQd(a,b){const c=new hE.a(a);return u.AFrameworkApplication.Aa.jb.Up?new hE.a(a,b[sn.a.ffa]):c}}ug.Cwh={};Object(e.a)(ug,"CuiActionBridge",null,[]);class bM{constructor(){this.qKd=this.FUb=
this.ZAe=this.xBe=null}}Object(e.a)(bM,"GeneralCuiUserHooks",null,[]);var DQ=d(492);class Pv{constructor(){this.tU=this.tXa=null;this.menuItemId=0}}Object(e.a)(Pv,"QueryData",null,[]);let jf;class Cd extends ug{constructor(a,b,c,f,l,x,G,R){super();this.la=a;this.ra=b;this.f0j=c;this.JAb=f;this.tc=l;this.Qb=x;this.Mb=G;this.yUa=R}initialize(){super.initialize();this.DAj();this.VAj();this.Wzj();this.HAj();this.lzj();this.SAj();this.nAj();this.ozj();this.Nzj();this.wzj()}nNc(a,b=null){if(u.AFrameworkApplication.fa.ka("CuiActionBridgeBridgeFunctionEnabledInWebEditor")){const c=
this.Uc.ga(a);b=c?c(a,b):new Kk;b.ieb=a;b.Nm||(b.Nm=a);b&&this.Mb&&1===this.Mb.Xo&&!Cd.l$d(a)&&(b.zK=!1);return b}(b=super.nNc(a))&&this.Mb&&1===this.Mb.Xo&&!Cd.l$d(a)&&(b.zK=!1);return b}DAj(){this.la.dgb&&(this.Uc.$(ba.a.PEb,Object(C.a)(this,this.Lma,"remapRumTrackerEnabledBridge")),this.Uc.$(ba.a.lhc,Object(C.a)(this,this.Lma,"remapRumTrackerEnabledBridge")),this.Uc.$(F.a.eoc,Object(C.a)(this,this.Lma,"remapRumTrackerEnabledBridge")),this.Uc.$(ba.a.zjd,Object(C.a)(this,this.Lma,"remapRumTrackerEnabledBridge")),
this.Uc.$(E.a.foc,Object(C.a)(this,this.Lma,"remapRumTrackerEnabledBridge")),this.Uc.$(F.a.fCa,Object(C.a)(this,this.Lma,"remapRumTrackerEnabledBridge")));this.Uc.$(ba.a.uhb,Object(C.a)(this,this.Lma,"remapRumTrackerEnabledBridge"));this.Uc.$(ba.a.shb,Object(C.a)(this,this.Lma,"remapRumTrackerEnabledBridge"));this.Uc.$(ba.a.sxa,Object(C.a)(this,this.Lma,"remapRumTrackerEnabledBridge"));this.Uc.$(ba.a.kZa,Object(C.a)(this,this.Lma,"remapRumTrackerEnabledBridge"));this.Uc.$(ba.a.ZWe,Object(C.a)(this,
this.Lma,"remapRumTrackerEnabledBridge"))}VAj(){this.gb.$(ba.a.Phc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.Vhc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.fic,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.Rhc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.Whc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.Zhc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.Uhc,Object(C.a)(this,
this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.cic,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.bic,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.aic,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.Shc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.Thc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.Qhc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.Yhc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));
this.gb.$(ba.a.dIa,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.dfb,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.jFb,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.iFb,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.M$g,Cd.hf);this.gb.$(ba.a.$hc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.Xhc,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.xDe,Object(C.a)(this,this.kE,"remapTextQueryExecute"));
this.gb.$(ba.a.wDe,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.efb,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.gb.$(ba.a.ffb,Object(C.a)(this,this.kE,"remapTextQueryExecute"));this.Uc.$(ba.a.Phc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Vhc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.fic,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Rhc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Whc,
Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Zhc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Uhc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.cic,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.bic,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.aic,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Shc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Thc,Object(C.a)(this,
this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Qhc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Yhc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.dIa,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.dfb,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.jFb,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.iFb,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.$hc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));
this.Uc.$(ba.a.Xhc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.xDe,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.wDe,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.efb,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.ffb,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.gb.$(ba.a.Dgc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Kgc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.bhc,Object(C.a)(this,
this.$s,"remapTextExecute"));this.gb.$(ba.a.yEb,Object(C.a)(this,this.vWc,"justifyExecuteBridge"));this.gb.$(ba.a.FEb,Object(C.a)(this,this.vWc,"justifyExecuteBridge"));this.gb.$(ba.a.IEb,Object(C.a)(this,this.vWc,"justifyExecuteBridge"));this.gb.$(ba.a.DEb,Object(C.a)(this,this.vWc,"justifyExecuteBridge"));this.gb.$(ba.a.BEb,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Qgc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Tgc,Object(C.a)(this,this.$s,"remapTextExecute"));
this.gb.$(ba.a.CEb,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Rgc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Ugc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.JEb,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.EEb,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Ama,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.zma,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.yma,Object(C.a)(this,this.$s,"remapTextExecute"));
this.gb.$(ba.a.Wgc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Mgc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Ngc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Ogc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Pgc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Bbd,Cd.qCg);this.gb.$(ba.a.Cbd,Cd.qCg);this.gb.$(ba.a.lwa,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.fXa,Object(C.a)(this,this.$s,"remapTextExecute"));
this.gb.$(ba.a.THb,Object(C.a)(this,this.rCg,"listMarkerGalleryShapeExecuteBridge"));this.gb.$(ba.a.BHb,Object(C.a)(this,this.rCg,"listMarkerGalleryShapeExecuteBridge"));this.gb.$(ba.a.tbd,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.ubd,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.AEb,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Igc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Egc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Hgc,
Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Sgc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Hbd,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Vgc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.insertHyperlink,Object(C.a)(this,this.dPk,"remapInsertHyperlinkExecute"));this.gb.$(ba.a.Lgc,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.GEb,Object(C.a)(this,this.$s,"remapTextExecute"));this.gb.$(ba.a.Xgc,Object(C.a)(this,this.$s,
"remapTextExecute"));this.gb.$(ba.a.Ygc,Object(C.a)(this,this.$s,"remapTextExecute"));this.Uc.$(ba.a.Dgc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Kgc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.bhc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.yEb,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.FEb,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.IEb,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.DEb,Object(C.a)(this,
this.zs,"remapTextEnabled"));this.Uc.$(ba.a.BEb,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Qgc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Tgc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.CEb,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Rgc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.Ugc,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.Uc.$(ba.a.JEb,Object(C.a)(this,this.zs,"remapTextEnabled"));
this.Uc.$(ba.a.EEb,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Ama,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.zma,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.yma,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Wgc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Mgc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Ngc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Ogc,Object(C.a)(this,this.zs,"remapTextEnabled"));
this.Uc.$(ba.a.Pgc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.lwa,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.fXa,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.tbd,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.ubd,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.AEb,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Igc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Egc,Object(C.a)(this,this.zs,"remapTextEnabled"));
this.Uc.$(ba.a.Hgc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Sgc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Hbd,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Vgc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Lgc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.GEb,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.insertHyperlink,Object(C.a)(this,this.cPk,"remapInsertHyperlinkEnabled"));this.Uc.$(ba.a.efb,Object(C.a)(this,
this.zs,"remapTextEnabled"));this.Uc.$(ba.a.ffb,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Xgc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.Ygc,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.efb,Object(C.a)(this,this.zs,"remapTextEnabled"));this.Uc.$(ba.a.ffb,Object(C.a)(this,this.zs,"remapTextEnabled"))}Wzj(){this.gb.$(ba.a.z$g,Object(C.a)(this,this.bfb,"queryInkControlToggledExecuteBridge"));this.gb.$(ba.a.t$g,Object(C.a)(this,this.bfb,"queryInkControlToggledExecuteBridge"));
this.gb.$(ba.a.w$g,Object(C.a)(this,this.bfb,"queryInkControlToggledExecuteBridge"));this.gb.$(ba.a.u$g,Object(C.a)(this,this.bfb,"queryInkControlToggledExecuteBridge"));this.gb.$(ba.a.x$g,Object(C.a)(this,this.bfb,"queryInkControlToggledExecuteBridge"));this.gb.$(ba.a.y$g,Object(C.a)(this,this.bfb,"queryInkControlToggledExecuteBridge"));this.gb.$(ba.a.v$g,Object(C.a)(this,this.bfb,"queryInkControlToggledExecuteBridge"))}HAj(){this.gb.$(ba.a.lic,Cd.hf);this.gb.$(ba.a.mic,Cd.hf);this.gb.$(ba.a.oic,
Cd.hf);this.gb.$(ba.a.bdd,Cd.hf);this.gb.$(ba.a.$cd,Cd.hf);this.gb.$(ba.a.cdd,Cd.hf);this.gb.$(ba.a.ddd,Cd.hf);this.gb.$(ba.a.fdd,Cd.hf);this.gb.$(ba.a.Zcd,Cd.hf);this.gb.$(ba.a.hdd,Cd.hf);this.gb.$(ba.a.edd,Cd.hf);this.gb.$(ba.a.mdd,Cd.hf);this.gb.$(ba.a.ldd,Cd.hf);this.gb.$(ba.a.kdd,Cd.hf);this.gb.$(ba.a.ifb,Cd.hf);this.gb.$(ba.a.jfb,Cd.hf);this.gb.$(ba.a.rXa,Object(C.a)(this,this.xcd,"queryListMarkerQueryDataExecuteBridge"));this.gb.$(ba.a.sXa,Object(C.a)(this,this.xcd,"queryListMarkerQueryDataExecuteBridge"));
this.gb.$(ba.a.Ycd,Cd.hf);this.gb.$(ba.a.Xcd,Cd.hf);this.gb.$(ba.a.nic,Cd.hf);this.gb.$(ba.a.idd,Cd.hf);this.gb.$(ba.a.jdd,Cd.hf);this.Uc.$(ba.a.Tgb,Cd.gy);this.Uc.$(ba.a.Ugb,Cd.gy);this.Uc.$(ba.a.zHb,Cd.gy);this.Uc.$(ba.a.ehb,Cd.gy);this.Uc.$(ba.a.VHb,Cd.gy);this.Uc.$(ba.a.vMe,Cd.gy);this.gb.$(ba.a.Tgb,Object(C.a)(this,this.dWi,"fontNameExecuteBridge"));this.gb.$(ba.a.Ugb,Object(C.a)(this,this.kZd,"genericFontSizeExecuteBridge"));this.gb.$(ba.a.zHb,Cd.UQe);this.gb.$(ba.a.ehb,Cd.UQe);this.gb.$(ba.a.VHb,
Cd.UQe);this.Uc.$(ba.a.jIf,Cd.OYa);this.Uc.$(ba.a.kIf,Cd.OYa);this.Uc.$(ba.a.pKd,Cd.OYa);this.Uc.$(ba.a.lKd,Cd.OYa);this.Uc.$(ba.a.oKd,Cd.OYa);this.Uc.$(ba.a.mKd,Cd.OYa);this.Uc.$(ba.a.lIf,Cd.OYa);this.Uc.$(ba.a.bIf,Cd.OYa);this.gb.$(ba.a.Yhd,Cd.iCg);this.gb.$(ba.a.qXa,Cd.E$g);this.gb.$(ba.a.gdd,Cd.E$g);this.gb.$(ba.a.uma,Cd.iCg)}lzj(){this.gb.$(ba.a.Jea,Object(C.a)(this,this.twa,"queryQueryTransitionResultExecuteBridge"));this.gb.$(ba.a.uwa,Object(C.a)(this,this.twa,"queryQueryTransitionResultExecuteBridge"));
this.gb.$(ba.a.gIa,Object(C.a)(this,this.twa,"queryQueryTransitionResultExecuteBridge"));this.gb.$(ba.a.Jic,Object(C.a)(this,this.twa,"queryQueryTransitionResultExecuteBridge"));this.gb.$(ba.a.oFb,Object(C.a)(this,this.twa,"queryQueryTransitionResultExecuteBridge"));this.gb.$(ba.a.$De,Object(C.a)(this,this.twa,"queryQueryTransitionResultExecuteBridge"));this.gb.$(ba.a.fIa,Cd.dU);this.gb.$(ba.a.exa,Object(C.a)(this,this.Dmd,"transitionExecuteBridge"));this.gb.$(ba.a.OHb,Object(C.a)(this,this.Dmd,"transitionExecuteBridge"));
this.Uc.$(ba.a.exa,Cd.gy);this.Uc.$(ba.a.fxa,Cd.gy);this.Uc.$(ba.a.iJa,Cd.gy);this.Uc.$(ba.a.qid,Cd.gy);this.Uc.$(ba.a.PHb,Cd.gy);this.gb.$(ba.a.Zeb,Object(C.a)(this,this.twa,"queryQueryTransitionResultExecuteBridge"));this.gb.$(ba.a.Veb,Object(C.a)(this,this.twa,"queryQueryTransitionResultExecuteBridge"));this.gb.$(ba.a.Yeb,Object(C.a)(this,this.twa,"queryQueryTransitionResultExecuteBridge"));this.gb.$(ba.a.$eb,Object(C.a)(this,this.twa,"queryQueryTransitionResultExecuteBridge"));this.gb.$(ba.a.nB,
Object(C.a)(this,this.Dmd,"transitionExecuteBridge"));this.gb.$(ba.a.bHb,Object(C.a)(this,this.Dmd,"transitionExecuteBridge"));this.Uc.$(ba.a.nB,Cd.gy);this.Uc.$(ba.a.wgb,Cd.gy);this.Uc.$(ba.a.bHb,Cd.gy);this.Uc.$(ba.a.Pkc,Cd.gy);this.Uc.$(ba.a.zgb,Cd.gy);this.gb.$(ba.a.Ueb,Cd.dU);this.Uc.$(ba.a.omh,Cd.gy);this.Uc.$(ba.a.xgb,Cd.gy);this.gb.$(ba.a.Xeb,Cd.dU);this.Uc.$(ba.a.pmh,Cd.gy);this.Uc.$(ba.a.ygb,Cd.gy);this.Uc.$(ba.a.HGf,Cd.gy);this.gb.$(ba.a.mcd,Cd.hf);this.Uc.$(ba.a.jKe,Cd.gy);this.Uc.$(ba.a.kKe,
Cd.gy);this.Uc.$(ba.a.lKe,Cd.gy);this.Uc.$(ba.a.mKe,Cd.gy)}SAj(){this.gb.$(E.a.kFb,ug.YCe);this.gb.$(ba.a.T$g,ug.YCe);this.gb.$(ba.a.Fic,Cd.dU);this.gb.$(ba.a.Gic,Cd.dU);this.gb.$(ba.a.rdd,Cd.dU);this.gb.$(ba.a.VDe,Cd.dU);this.gb.$(ba.a.Cic,Cd.dU);this.gb.$(ba.a.Dic,Cd.dU);this.gb.$(ba.a.Eic,Cd.dU);this.gb.$(ba.a.Bic,Cd.dU);this.gb.$(ba.a.vbd,Object(C.a)(this,this.wed,"remapTableExecute"));this.gb.$(E.a.Fba,Object(C.a)(this,this.wed,"remapTableExecute"));this.gb.$(E.a.Ckc,Object(C.a)(this,this.wed,
"remapTableExecute"));this.gb.$(E.a.insertTable,Object(C.a)(this,this.wed,"remapTableExecute"));this.Uc.$(E.a.insertTable,Object(C.a)(this,this.xni,"checkInsertTableRibbonEnabledBridge"));this.Uc.$(E.a.Fba,Object(C.a)(this,this.eqb,"checkWholeTableLockEnabledBridge"));this.Uc.$(E.a.V1,Object(C.a)(this,this.eqb,"checkWholeTableLockEnabledBridge"));this.Uc.$(E.a.FAa,Object(C.a)(this,this.eqb,"checkWholeTableLockEnabledBridge"));this.Uc.$(ba.a.D7g,Object(C.a)(this,this.eqb,"checkWholeTableLockEnabledBridge"));
this.Uc.$(ba.a.mwa,Object(C.a)(this,this.eqb,"checkWholeTableLockEnabledBridge"));this.Uc.$(ba.a.gXa,Object(C.a)(this,this.eqb,"checkWholeTableLockEnabledBridge"));this.gb.$(E.a.V1,Object(C.a)(this,this.xOa,"checkSelectionBeforeExecute"));this.gb.$(E.a.FAa,Object(C.a)(this,this.xOa,"checkSelectionBeforeExecute"));this.gb.$(E.a.kqb,Object(C.a)(this,this.xOa,"checkSelectionBeforeExecute"));this.gb.$(ba.a.ahc,Object(C.a)(this,this.xOa,"checkSelectionBeforeExecute"));this.gb.$(ba.a.$gc,Object(C.a)(this,
this.xOa,"checkSelectionBeforeExecute"));this.gb.$(ba.a.Zgc,Object(C.a)(this,this.xOa,"checkSelectionBeforeExecute"));this.gb.$(ba.a.mwa,Object(C.a)(this,this.xOa,"checkSelectionBeforeExecute"));this.gb.$(ba.a.gXa,Object(C.a)(this,this.xOa,"checkSelectionBeforeExecute"));this.gb.$(ba.a.uah,Cd.hf);this.gb.$(ba.a.vah,Cd.hf);this.gb.$(ba.a.wah,Cd.hf);this.gb.$(ba.a.xah,Cd.hf);this.gb.$(ba.a.yah,Cd.hf);this.gb.$(ba.a.zah,Cd.hf);this.gb.$(ba.a.Aah,Cd.hf);this.gb.$(ba.a.Bah,Cd.hf);this.gb.$(ba.a.Cah,Cd.hf);
this.gb.$(ba.a.iah,Cd.hf);this.gb.$(ba.a.jah,Cd.hf);this.gb.$(ba.a.kah,Cd.hf);this.gb.$(ba.a.lah,Cd.hf);this.gb.$(ba.a.mah,Cd.hf);this.gb.$(ba.a.nah,Cd.hf);this.gb.$(ba.a.oah,Cd.hf);this.gb.$(ba.a.pah,Cd.hf);this.gb.$(ba.a.qah,Cd.hf);this.gb.$(ba.a.rah,Cd.hf);this.gb.$(ba.a.sah,Cd.hf);this.gb.$(ba.a.tah,Cd.hf);this.gb.$(ba.a.TDe,Cd.hf);this.gb.$(ba.a.SDe,Cd.hf);this.gb.$(ba.a.RDe,Cd.hf);this.gb.$(ba.a.UDe,Cd.hf)}nAj(){this.Uc.$(ba.a.zDe,Cd.gy);this.gb.$(ba.a.zDe,Cd.hf);this.Uc.$(ba.a.hsg,Cd.bPk);
this.gb.$(ba.a.cSa,Object(C.a)(this,this.uad,"parseSmartArtParametersBridge"));this.gb.$(ba.a.ZVb,Object(C.a)(this,this.uad,"parseSmartArtParametersBridge"));this.gb.$(ba.a.qEc,Object(C.a)(this,this.uad,"parseSmartArtParametersBridge"));this.gb.$(ba.a.rEc,Object(C.a)(this,this.uad,"parseSmartArtParametersBridge"));this.Uc.$(ba.a.ZCe,Cd.gy);this.gb.$(ba.a.ZCe,Cd.hf);this.gb.$(ba.a.tOa,Object(C.a)(this,this.wmi,"changePictureStyleExecuteBridge"));this.gb.$(ba.a.ndd,Cd.hf);this.gb.$(ba.a.Lhc,Cd.dU);
this.gb.$(ba.a.Nhc,Cd.dU);this.gb.$(ba.a.Mhc,Cd.dU);this.gb.$(ba.a.Kcd,Cd.dU)}ozj(){this.gb.$(ba.a.N$g,ug.YCe);this.gb.$(ba.a.ncd,Cd.hf);this.gb.$(ba.a.Mcd,Cd.hf);this.gb.$(ba.a.Dcd,Cd.hf);this.gb.$(ba.a.Ucd,Cd.hf);this.gb.$(ba.a.Vcd,Cd.hf);this.gb.$(ba.a.Tcd,Cd.hf);this.gb.$(ba.a.Wcd,Cd.hf);this.gb.$(ba.a.qdd,Cd.hf);this.gb.$(ba.a.Lcd,Cd.hf);this.gb.$(ba.a.Acd,Cd.hf);this.gb.$(ba.a.vcd,Cd.hf);this.gb.$(ba.a.Qcd,Cd.hf)}Nzj(){this.gb.$(ba.a.pcd,Cd.hf);this.gb.$(ba.a.Ecd,Cd.hf);this.gb.$(ba.a.dic,Object(C.a)(this,
this.xcd,"queryListMarkerQueryDataExecuteBridge"));this.gb.$(ba.a.eic,Object(C.a)(this,this.xcd,"queryListMarkerQueryDataExecuteBridge"));this.gb.$(ba.a.nFb,Cd.hf);this.gb.$(ba.a.mFb,Cd.hf);this.gb.$(ba.a.lFb,Cd.hf);this.gb.$(ba.a.JDe,Cd.hf);this.gb.$(ba.a.OFk,Cd.hf);this.gb.$(ba.a.tdd,Cd.Ncd);this.gb.$(ba.a.sdd,Cd.Ncd);this.gb.$(ba.a.EDe,Cd.Ncd);this.gb.$(ba.a.gDe,Cd.Ncd);this.gb.$(ba.a.ric,Object(C.a)(this,this.ePk,"remapRumTrackerExecuteQueryBridge"));this.gb.$(ba.a.Jhc,Cd.hf);this.gb.$(ba.a.Rcd,
ug.Ehc);this.gb.$(ba.a.H$g,Cd.hf);this.gb.$(ba.a.Icd,Cd.hf);this.gb.$(ba.a.qcd,Cd.hf);this.gb.$(ba.a.iic,Cd.hf);this.gb.$(ba.a.pdd,Cd.hf);this.gb.$(ba.a.Gah,ug.Ehc);this.gb.$(ba.a.MDe,Cd.hf);this.gb.$(ba.a.LDe,Cd.hf);this.gb.$(ba.a.$$g,Cd.hf);this.gb.$(ba.a.vic,Cd.hf);this.gb.$(ba.a.yic,Cd.hf);this.gb.$(ba.a.zic,Cd.hf);this.gb.$(ba.a.xic,Cd.hf);this.gb.$(ba.a.wic,Cd.hf);this.gb.$(ba.a.gic,Cd.hf);this.gb.$(ba.a.pic,Cd.hf);this.gb.$(ba.a.hic,Cd.hf);this.gb.$(F.a.Bhc,ug.Ehc);this.Uc.$(ba.a.Eze,Cd.gy);
this.gb.$(ba.a.l4a,Cd.Wjd);this.gb.$(ba.a.vOa,Cd.Wjd);this.gb.$(ba.a.HUb,Cd.Wjd);this.gb.$(ba.a.vCc,Cd.Wjd);this.Uc.$(ba.a.l7f,Cd.EWi);this.gb.$(ba.a.HDe,Cd.fFk);this.Uc.$(ba.a.vDe,Cd.gy);this.gb.$(ba.a.vDe,Cd.hf);this.Uc.$(ba.a.x6a,Object(C.a)(this,this.qw,"remapTextQueryEnabled"));this.gb.$(ba.a.eIa,ug.Ehc);this.gb.$(ba.a.W$g,Cd.hf);this.gb.$(ba.a.FDe,Cd.hf);this.gb.$(ba.a.O$g,Cd.hf);this.gb.$(ba.a.P$g,Cd.hf);this.gb.$(ba.a.Lic,Cd.hf);this.gb.$(ba.a.q$g,Cd.hf);this.gb.$(E.a.RAe,ug.V3b);this.gb.$(E.a.cut,
Object(C.a)(this,this.tHc,"cutCopyPasteExecuteBridge"));this.gb.$(E.a.copy,Object(C.a)(this,this.tHc,"cutCopyPasteExecuteBridge"));this.gb.$(E.a.paste,Object(C.a)(this,this.tHc,"cutCopyPasteExecuteBridge"));this.gb.$(E.a.iwa,Object(C.a)(this,this.tHc,"cutCopyPasteExecuteBridge"));this.gb.$(E.a.openInClient,Object(C.a)(this,this.Ksk,"openInPowerPointExecuteBridge"));this.gb.$(E.a.wcd,Cd.hf);this.gb.$(ba.a.ycd,Cd.hf);this.gb.$(ba.a.Ibd,Object(C.a)(this,this.Udh,"remapUndoRedoExecute"));this.gb.$(ba.a.Dbd,
Object(C.a)(this,this.Udh,"remapUndoRedoExecute"));this.gb.$(ba.a.Ggc,Object(C.a)(this,this.ved,"remapCutCopyPasteExecute"));this.gb.$(ba.a.Fgc,Object(C.a)(this,this.ved,"remapCutCopyPasteExecute"));this.gb.$(ba.a.HEb,Object(C.a)(this,this.ved,"remapCutCopyPasteExecute"));this.gb.$(ba.a.Abd,Object(C.a)(this,this.ved,"remapCutCopyPasteExecute"));this.Uc.$(ba.a.Ibd,Object(C.a)(this,this.Tdh,"remapUndoRedoEnabled"));this.Uc.$(ba.a.Dbd,Object(C.a)(this,this.Tdh,"remapUndoRedoEnabled"));this.Uc.$(ba.a.Ggc,
Object(C.a)(this,this.vfb,"remapCutCopyPasteEnabled"));this.Uc.$(ba.a.Fgc,Object(C.a)(this,this.vfb,"remapCutCopyPasteEnabled"));this.Uc.$(ba.a.HEb,Object(C.a)(this,this.vfb,"remapCutCopyPasteEnabled"));this.Uc.$(ba.a.Abd,Object(C.a)(this,this.vfb,"remapCutCopyPasteEnabled"));this.Uc.$(E.a.cut,Object(C.a)(this,this.vfb,"remapCutCopyPasteEnabled"));this.Uc.$(E.a.paste,Object(C.a)(this,this.vfb,"remapCutCopyPasteEnabled"));this.Uc.$(E.a.iwa,Object(C.a)(this,this.vfb,"remapCutCopyPasteEnabled"));this.gb.$(E.a.w$,
Cd.dJf);this.gb.$(E.a.gt,Cd.dJf);this.gb.$(E.a.KO,Object(C.a)(this,this.zCg,"listsExecuteBridge"));this.gb.$(E.a.lR,Object(C.a)(this,this.zCg,"listsExecuteBridge"));this.gb.$(ba.a.pIb,Cd.Vdl);this.gb.$(ba.a.dFb,Cd.dU);this.gb.$(ba.a.eFb,Cd.dU);this.gb.$(ba.a.Scd,Cd.hf);this.gb.$(ba.a.tcd,Cd.hf);this.gb.$(ba.a.ucd,Cd.hf);this.gb.$(ba.a.Pcd,Cd.hf);this.la.zob&&this.gb.$(ba.a.lcd,Cd.hf)}wzj(){this.Uc.$(ba.a.WBj,Object(C.a)(this,this.YYb,"doPresentationCheckEnableRemap"));this.Uc.$(ba.a.umi,Object(C.a)(this,
this.YYb,"doPresentationCheckEnableRemap"));this.Uc.$(ba.a.kmi,Object(C.a)(this,this.YYb,"doPresentationCheckEnableRemap"));this.Uc.$(ba.a.bCj,Object(C.a)(this,this.YYb,"doPresentationCheckEnableRemap"));this.Uc.$(ba.a.kCj,Object(C.a)(this,this.YYb,"doPresentationCheckEnableRemap"))}YYb(a){const b=new Kk;this.Mb&&1===this.Mb.Xo&&!Cd.l$d(a)?b.zK=!1:(b.GF=!0,b.Nm=ba.a.vrb);return b}R2i(){const a=new bM;a.FUb=Cd.Bzk;a.qKd=Cd.Czk;a.xBe=Object(C.a)(this,this.fAk,"powerPointPreExecCommand");a.ZAe=null;
return a}fAk(a,b){var c=this.ra.Yd();c=1===c.length&&c[0].qd&&this.ra.JG()&&!c[0].jQ;switch(a.Nm){case E.a.font:case E.a.T4:case E.a.HIa:case E.a.bold:case E.a.setItalic:case E.a.underline:case E.a.strikethrough:case E.a.gt:case E.a.w$:case E.a.UAa:case E.a.nI:case E.a.BJ:case E.a.$Ha:case E.a.YXa:case E.a.rD:case E.a.lz:case E.a.KO:case E.a.lR:case E.a.Nha:case E.a.Wja:case E.a.cna:case E.a.pCa:case ba.a.uma:case ba.a.Ama:case ba.a.zma:case ba.a.yma:case E.a.nPa:case E.a.Asa:case E.a.Mxa:case E.a.Nxa:case E.a.Oxa:case E.a.MJa:case E.a.NJa:case E.a.FAa:case E.a.V1:case ba.a.mwa:case ba.a.gXa:case ba.a.Ygb:case ba.a.IYa:case ba.a.dxa:case ba.a.JYa:case ba.a.Zjd:case ba.a.Yjd:b||
(b={}),b[si.a.EAc]=!(this.ra.USa()||c),b[si.a.pCf]=!!this.ra.Yia()}return null}rCg(a,b,c){const f=new Zg;b=b.MenuItemId;f.kd=this.Kte(b,a);b&&Aa.a.J(512493027,820,50,"ListGallery Set on Shape from {0}",c.CommandLocation);return f}Kte(a,b){a=a?parseInt(a):-1;switch(b){case ba.a.THb:case E.a.KO:case ba.a.dic:case ba.a.rXa:return this.JAb.X1b(a);case ba.a.BHb:case E.a.lR:case ba.a.eic:case ba.a.sXa:return this.JAb.tPc(a);default:return 18}}dWi(a,b){a=new Zg;a.kd=b.CommandValueId;return a}xcd(a,b){const c=
new Zg,f=new Pv;f.tXa=new Nh.a;f.menuItemId=this.Kte(b.MenuItemId,a);c.kd=f;c.sW=!0;return c}twa(a,b){a=new Zg;const c={};c.queryResult=new Nh.a;const f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.kd=c;a.sW=!0;return a}Dmd(a,b){a=new Zg;const c={},f=b.SourceControlId;c.SourceControlId=f.startsWith("Animation")?f.substring(9,f.length):f;c.MenuItemId=b.MenuItemId;a.kd=c;return a}wmi(a,b){a=new Zg;a.kd=parseFloat(b[b.MenuItemId?
"MenuItemId":"SourceControlId"]);return a}bfb(a){const b=new Zg,c={},f=new Nh.a;switch(a){case ba.a.z$g:f.Nf(this.yUa.isEnabled(ke.wDa));break;case ba.a.t$g:f.Nf(this.yUa.isEnabled(ke.vDa));break;case ba.a.w$g:f.Nf(this.yUa.isEnabled(ke.V7));break;case ba.a.u$g:f.Nf(this.yUa.isEnabled(ke.U7));break;case ba.a.x$g:f.Nf(this.yUa.isEnabled(ke.bC));break;case ba.a.y$g:f.Nf(this.yUa.isEnabled(ke.nF));break;case ba.a.v$g:f.Nf(this.yUa.isEnabled(ke.mF));break;case ba.a.aFk:f.Nf(this.yUa.isEnabled(ke.Esa))}c.queryResult=
f;b.kd=c;b.sW=!0;return b}zCg(a,b,c){const f=new Zg;f.kd=new D.DictionaryPropertySet;b=b.MenuItemId;this.ixl(f.kd,a,this.Kte(b,a));b&&Aa.a.J(512493026,820,50,"ListGallery Set in Box4 View from {0}",c.CommandLocation);return f}xni(){return Object.assign(new Kk,{kd:new Nh.a,zK:!!this.f0j.Ba})}eqb(){const a=new Kk,b=this.ra.Yo();if(!b)return a;this.tc.P9d(b)&&(a.GF=!1,a.zK=!1,a.Nm=Kd.ActionManager.AZb);return a}ixl(a,b,c){let f=14,l=0;0===c?(f=16,l=0):b===E.a.KO?(l=f=1,this.JAb.YSc(c)&&(b=this.JAb.qTa.ga(c),
a.setValue(tb.a.Ni,[b.rVb]),a.setValue(tb.a.font,b.spb))):b===E.a.lR&&(f=0,l=1,a.setValue(tb.a.uTa,1),a.setValue(sb.a.autonumberBulletType,8),this.JAb.ZSc(c)&&(b=this.JAb.l8c.ga(c),a.setValue(sb.a.autonumberBulletType,b.uLd),a.setValue(tb.a.Ni,[65533,b.LXg,Ka.a.charCodeAt(b.RXg,0)])));a.setValue(Oc.a.LD,f);a.setValue(Oc.a.Vca,l)}$md(a){let b;if(this.Tqh()||this.ra.Yia()){if(({ve:b}=Cd.Umd(a,this.ra.cC())).returnValue)return{returnValue:!0,G4:b}}else if(this.Nal()&&({ve:b}=Cd.IAh(a)).returnValue)return{returnValue:!0,
G4:b};return{returnValue:!1,G4:0}}cUe(a){let b;b=0;a===ba.a.Ibd?b=ba.a.Oeb:a===ba.a.Dbd&&(b=ba.a.Neb);return{returnValue:!!b,G4:b}}bUe(a){let b;b=0;this.Tqh()?a===ba.a.Ggc?b=E.a.cut:a===ba.a.Fgc?b=E.a.copy:a===ba.a.HEb?b=E.a.paste:a===ba.a.Abd&&(b=E.a.iwa):(a===ba.a.Ggc&&(b=ba.a.drb),a===ba.a.Fgc?b=ba.a.oXb:a===ba.a.HEb&&(b=ba.a.$fc));return{returnValue:!!b,G4:b}}WAh(a){switch(a){case E.a.Fba:return a=ba.a.zEb,{returnValue:!0,ve:a};case E.a.Ckc:return a=ba.a.kBe,{returnValue:!0,ve:a};case E.a.insertTable:return a=
ba.a.H7g,{returnValue:!0,ve:a}}a=Kd.ActionManager.J4;return{returnValue:!1,ve:a}}$s(a){let b=new Zg;if(({result:b}=this.Dvb(a)).returnValue)return b;({G4:a}=this.$md(a)).returnValue&&(b.GF=!0,b.Nm=a);return b}oqh(a){switch(a){case ba.a.CEb:case ba.a.Rgc:case ba.a.Ugc:case ba.a.EEb:case ba.a.JEb:case ba.a.GEb:if(this.ra.Ija()||this.ra.aL())return Object.assign(new Kk,{GF:!1,zK:!1});break;case ba.a.jFb:case ba.a.iFb:case ba.a.Qgc:case ba.a.Tgc:case ba.a.BEb:if(this.ra.Ija())return Object.assign(new Kk,
{GF:!1,zK:!1});break;case ba.a.fXa:case ba.a.lwa:case ba.a.O7g:case ba.a.yEb:case ba.a.FEb:case ba.a.IEb:case ba.a.DEb:case ba.a.Sgc:case ba.a.Hgc:if(this.ra.aL())return Object.assign(new Kk,{GF:!1,zK:!1});break;case ba.a.Vgc:case ba.a.Hbd:if(this.ra.aL()){var b=this.ra.Oa.kb;if(b)for(let c of b)if(c&&c.node&&(b=c.node.sa(Mb.a.listLevel,0),a===ba.a.Vgc&&!b||Zo.a.Fvg(c.node)))return Object.assign(new Kk,{GF:!1,zK:!1})}}return null}zs(a){let b;new Kk;if(({result:b}=this.I9d(a)).returnValue)return this.Jhd(b,
a);b=this.oqh(a);if(!b){let c;b=new Kk;({G4:c}=this.$md(a)).returnValue&&(b.GF=!0,b.Nm=c)}return this.Jhd(b,a)}Lma(a,b=null){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Kk,{ieb:a,Nm:ba.a.lIe,kd:c})}ePk(a,b){const c={};c.OriginalActionId=a;c.Properties=b;return Object.assign(new Zg,{Nm:ba.a.lIe,kd:c,sW:!0})}kE(a){let b=new Zg;if(({result:b}=this.Dvb(a)).returnValue)return b;({G4:a}=this.$md(a)).returnValue?(b.GF=!0,b.Nm=a):(b.kd=new Nh.a,b.sW=!0);return b}qw(a){let b;new Kk;
if(({result:b}=this.I9d(a)).returnValue)return this.Jhd(b,a);b=this.oqh(a);if(!b){let c;b=new Kk;({G4:c}=this.$md(a)).returnValue?(b.GF=!0,b.Nm=c):b.kd=new Nh.a}return this.Jhd(b,a)}Udh(a){const b=new Zg;({G4:a}=this.cUe(a)).returnValue&&(b.GF=!0,b.Nm=a);return b}Tdh(a){const b=new Kk;({G4:a}=this.cUe(a)).returnValue&&(b.GF=!0,b.Nm=a);return b}cPk(){const a=new Kk;a.GF=!0;a.Nm=ba.a.gBe;return a}dPk(){const a=new Zg;a.GF=!0;a.Nm=ba.a.gBe;return a}ved(a){let b=new Zg;if(({result:b}=this.Dvb(a)).returnValue)return b;
({G4:a}=this.bUe(a)).returnValue&&(b.GF=!0,b.Nm=a);return b}wed(a){let b=new Zg;if(({result:b}=this.Dvb(a)).returnValue)return b;({ve:a}=this.WAh(a)).returnValue&&(b.GF=!0,b.Nm=a);return b}xOa(a,b){let c=new Zg;if(({result:c}=this.Dvb(a)).returnValue)return c;if(this.ra.wu())return c.GF=!0,c.Nm=Kd.ActionManager.AZb,c;c.Nm=a;c.kd=b;return c}vfb(a){let b=new Kk;if(!this.Qb.Hj())return b.zK=!1,b;if(({result:b}=this.I9d(a)).returnValue)return b;({G4:a}=this.bUe(a)).returnValue&&(b.GF=!0,b.Nm=a);return b}Tqh(){return this.ra.cC()}Nal(){return this.ra.JG()}uad(a,
b){const c=new Zg;if(!b)throw Error.argumentNull();b=b[b.MenuItemId?"MenuItemId":"SourceControlId"].split(",");b=Object.assign(new DQ.a,{Uri:b[0],Category:b[1]});const f=b.Uri;a!==ba.a.cSa&&a!==ba.a.qEc||Aa.a.J(512493024,801,50,(a===ba.a.cSa?"InsertSmartArt: ":"ChangeSmartArtLayout: ")+"{0}",f);c.kd=b;return c}vWc(a,b,c){return this.$s(a,b,c)}tHc(a){let b=new Zg;if(({result:b}=this.Dvb(a)).returnValue)return b;b.Pq=this.la.gTc||this.la.Yug&&this.la.tHj&&r.a.io;return b}Ksk(a,b,c){a=new Zg;Aa.a.J(512493023,
801,50,"CuiActionBridge::OpenInPowerPointExecuteBridge - Open In PowerPoint from {0}",c.CommandLocation);return a}Dvb(a){let b;b=new Zg;return this.dtg(a)?(b.GF=!1,b.zK=!1,b.Nm=Kd.ActionManager.AZb,{returnValue:!0,result:b}):{returnValue:!1,result:b}}I9d(a){let b;b=new Kk;return this.dtg(a)?(b.GF=!1,b.zK=!1,b.Nm=Kd.ActionManager.AZb,{returnValue:!0,result:b}):{returnValue:!1,result:b}}dtg(a){return this.HDj(a)}HDj(a){return this.la.podsTableCellLockEnabled&&this.la.podsTableRTTEnabled&&Cd.lii.contains(a)?
this.ra.h8()?!0:!1:!1}Jhd(a,b){if(re.a("SetMappedCommandActionData")){let c=0;if(({ve:c}=Cd.Umd(b,this.ra.cC())).returnValue||({ve:c}=Cd.IAh(b)).returnValue||({G4:c}=this.cUe(b)).returnValue||({G4:c}=this.bUe(b)).returnValue||({ve:c}=this.WAh(b)).returnValue)a.kd||(a.kd={}),a.kd.MappedCommand=c}return a}static l$d(a){const b=Cd.Sfj();let c=!1;for(const f of b)if(f===a){c=!0;break}return c}static Sfj(){Cd.occ||(Cd.occ=[ba.a.Ibd,ba.a.Dbd,ba.a.HEb,ba.a.reb,ba.a.seb,ba.a.Fgc,ba.a.deleteObject,ba.a.H_f,
ba.a.vrb,ba.a.kHa,ba.a.gRc,ba.a.$Bh,ba.a.qS,ba.a.print,ba.a.xCk,ba.a.U8g,ba.a.V8g,ba.a.Ebd,ba.a.L7g,ba.a.M7g,ba.a.downloadACopy,ba.a.PIc,ba.a.QIc,ba.a.RIc,ba.a.l4a,ba.a.Bcd,ba.a.vOa,ba.a.ELe,ba.a.DLe,ba.a.a4g,ba.a.zgc,ba.a.Jic,ba.a.fIa,ba.a.oFb,ba.a.Jea,ba.a.uwa,ba.a.exa,ba.a.OHb,ba.a.qid,ba.a.PHb,ba.a.fxa,ba.a.Nmc,ba.a.kZa,ba.a.OJb,ba.a.vic,ba.a.QEb,ba.a.mhc,ba.a.Ubd,ba.a.hic,ba.a.Meb,ba.a.gic,ba.a.pic,ba.a.eah,ba.a.lbd,ba.a.mbd,ba.a.nmd,ba.a.yic,ba.a.omd,ba.a.zic,ba.a.mmd,ba.a.xic,ba.a.lmd,ba.a.wic,
ba.a.hoc,ba.a.iic,ba.a.Kma,ba.a.sed,ba.a.Lic,ba.a.dFh,ba.a.Ong,F.a.xob,F.a.ocd,ba.a.openInClient,F.a.MOe,F.a.ufc,F.a.rhc,F.a.jmc,F.a.kmc,ba.a.shb,ba.a.sxa,ba.a.$3g,ba.a.Jhc,ba.a.Nkd,ba.a.Okd,E.a.RAe,ba.a.ryk,ba.a.dea,ba.a.l7f,ba.a.qS,ba.a.WM,ba.a.AGe,ba.a.Leh,ba.a.UVg,ba.a.TVg,ba.a.IVe,ba.a.aob,ba.a.immersiveReader,E.a.copy,E.a.paste,ba.a.drb,ba.a.oXb,ba.a.$fc,ba.a.Oeb,ba.a.Neb,ba.a.Lph,F.a.fCa,F.a.renameFile,ba.a.PEb,ba.a.x8g,ba.a.Wad,ba.a.Vbd,ba.a.ted]);Cd.occ.push(ba.a.eid);if(u.AFrameworkApplication.fa.ka("ReactNewSlideLayoutEnabled")){const a=
[ba.a.m7g,ba.a.Ccd,ba.a.ySc];let b;(b=Cd.occ).push.apply(b,a)}return Cd.occ}static Czk(a,b){const c=a.ieb;let f=!0,l=null;if(null===a||null===a.kd)return!1;a=a.kd;null!==a.queryResult&&(l=a.queryResult);if(null!==l&&null!==l.C$)switch(c){case ba.a.fIa:case ba.a.Fic:case ba.a.Gic:case ba.a.rdd:case ba.a.VDe:case ba.a.Cic:case ba.a.Dic:case ba.a.Eic:case ba.a.Bic:case ba.a.Lhc:case ba.a.Nhc:case ba.a.Mhc:case ba.a.Kcd:case ba.a.dFb:case ba.a.eFb:case ba.a.Ueb:case ba.a.Xeb:a=parseFloat(l.C$);0<a||c===
ba.a.fIa||c===ba.a.Lhc||c===ba.a.Nhc||c===ba.a.Mhc||c===ba.a.Kcd||c===ba.a.dFb||c===ba.a.eFb||c===ba.a.Ueb||c===ba.a.Xeb||0<=a&&(c===ba.a.Cic||c===ba.a.Dic||c===ba.a.Eic||c===ba.a.Bic)?(b[Vm.Text]=l.C$,b[Vm.Number]=a):(b[Vm.Text]="",b[Vm.Number]=Number.NaN);b[Vm.UnitType]=c===ba.a.fIa||c===ba.a.Ueb||c===ba.a.Xeb?8:3;break;default:f=!1}return f}static Bzk(a,b){if(ug.FUb(a,b))return!0;if(!a||!a.kd)return!1;var c=null;Object(Ma.a)(Nh.a,a.kd)?c=a.kd:Object(Ma.a)(Pv,a.kd)?(c=a.kd,b.SourceControlId=c.tU,
c=c.tXa):Object(Ma.a)(Object,a.kd)&&(a=a.kd,a.queryResult&&(c=a.queryResult));c&&(b[ai.a.On]=c.fmd?c.fmd.value:!1,c.sFc&&(b[bo.a.IsFreeForm]=c.sFc.value),c.qCa&&(b[gm.a.InnerHTML]=c.qCa),c.Jsb&&(b[gm.a.Alt]=c.Jsb),c.ULc&&(b[gm.a.On]=c.ULc.value),void 0!==c.qZ&&null!==c.qZ&&(b[bo.a.Value]=c.qZ),void 0!==c.rDc&&null!==c.rDc&&(b[fE.a.LabelText]=c.rDc),c.J2&&(b[gm.a.GalleryButtonProps]=c.J2),c.HLf&&(b[fE.a.Image32by32Class]=c.HLf),void 0!==c.C6a&&null!==c.C6a&&(b[um.a.labelText]=c.C6a));return!0}static gy(){const a=
new Kk;a.kd=new Nh.a;return a}static hf(){const a=new Zg;a.kd=new Nh.a;a.sW=!0;return a}static qCg(a,b,c){Aa.a.J(512493021,820,50,"ListGallery Dropdown from {0}",c.CommandLocation);a=new Zg;a.kd=b;return a}static UQe(a,b){a=new Zg;a.kd=b.Color;return a}static dJf(a,b){a=new Zg;a.kd=b.Color;a.Pq=!0;return a}static Vdl(){const a=new Zg;a.kd={InvokeSource:0,ShowRevisionTrackingStatus:1};return a}static Ncd(a,b){a=new Zg;const c=new Pv;c.tXa=new Nh.a;c.tU=b.SourceControlId;a.kd=c;a.sW=!0;return a}static Wjd(a,
b){a=new Zg;a.kd=b.SourceControlId;return a}static dU(){const a=new Zg,b={},c=new Nh.a;b.queryResult=c;a.kd=b;a.Ebe=!0;return a}static OYa(a){const b=new Kk;switch(a){case ba.a.jIf:b.Nm=ba.a.GUb;break;case ba.a.kIf:b.Nm=ba.a.Lob;break;case ba.a.pKd:b.Nm=ba.a.ACc;break;case ba.a.lKd:b.Nm=ba.a.yCc;break;case ba.a.oKd:b.Nm=ba.a.nKd;break;case ba.a.mKd:b.Nm=ba.a.zCc;break;case ba.a.lIf:b.Nm=ba.a.HUb;break;case ba.a.bIf:b.Nm=ba.a.vCc}return b}static EWi(){const a=new Kk;a.Nm=ba.a.w6a;return a}static fFk(){const a=
new Zg,b={},c=new Nh.a;c.Nf(!1);b.queryResult=c;a.kd=b;a.sW=!0;return a}static Umd(a,b){switch(a){case ba.a.Dgc:return a=E.a.bold,{returnValue:!0,ve:a};case ba.a.yEb:return a=E.a.Nha,{returnValue:!0,ve:a};case ba.a.BEb:return a=E.a.font,{returnValue:!0,ve:a};case ba.a.Qgc:return a=E.a.T4,{returnValue:!0,ve:a};case ba.a.Tgc:return a=E.a.HIa,{returnValue:!0,ve:a};case ba.a.AEb:return a=E.a.gt,{returnValue:!0,ve:a};case ba.a.Igc:return a=E.a.w$,{returnValue:!0,ve:a};case ba.a.Egc:return a=E.a.UAa,{returnValue:!0,
ve:a};case ba.a.Kgc:return a=E.a.setItalic,{returnValue:!0,ve:a};case ba.a.FEb:return a=E.a.Wja,{returnValue:!0,ve:a};case ba.a.Mgc:return a=ba.a.Eze,{returnValue:!0,ve:a};case ba.a.Ngc:return a=E.a.wEb,{returnValue:!0,ve:a};case ba.a.CEb:return a=E.a.Jr,{returnValue:!0,ve:a};case ba.a.Rgc:return a=E.a.$Ha,{returnValue:!0,ve:a};case ba.a.Ugc:return a=E.a.YXa,{returnValue:!0,ve:a};case ba.a.JEb:return a=E.a.BJ,{returnValue:!0,ve:a};case ba.a.EEb:return a=E.a.nI,{returnValue:!0,ve:a};case ba.a.Wgc:return a=
E.a.strikethrough,{returnValue:!0,ve:a};case ba.a.Ogc:return a=ba.a.T4g,{returnValue:!0,ve:a};case ba.a.Pgc:return a=ba.a.VHa,{returnValue:!0,ve:a};case ba.a.IEb:return a=E.a.cna,{returnValue:!0,ve:a};case ba.a.DEb:return a=E.a.pCa,{returnValue:!0,ve:a};case ba.a.bhc:return a=E.a.underline,{returnValue:!0,ve:a};case ba.a.Sgc:return a=E.a.lz,{returnValue:!0,ve:a};case ba.a.Hgc:return a=E.a.rD,{returnValue:!0,ve:a};case ba.a.Vgc:return a=E.a.lz,{returnValue:!0,ve:a};case ba.a.Hbd:return a=E.a.rD,{returnValue:!0,
ve:a};case ba.a.lwa:return a=E.a.KO,{returnValue:!0,ve:a};case ba.a.fXa:return a=E.a.lR,{returnValue:!0,ve:a};case ba.a.Lgc:return a=ba.a.uma,{returnValue:!0,ve:a};case ba.a.GEb:return a=ba.a.aee,{returnValue:!0,ve:a};case ba.a.x6a:return a=E.a.BLc,{returnValue:!0,ve:a};case ba.a.Xgc:return a=E.a.subscript,{returnValue:!0,ve:a};case ba.a.Ygc:return a=E.a.superscript,{returnValue:!0,ve:a}}return b?Cd.tsl(a):Cd.HAh(a)}static IAh(a){switch(a){case ba.a.Dgc:return a=ba.a.FYa,{returnValue:!0,ve:a};case ba.a.yEb:return a=
ba.a.UHb,{returnValue:!0,ve:a};case ba.a.BEb:return a=ba.a.Tgb,{returnValue:!0,ve:a};case ba.a.CEb:return a=ba.a.Ugb,{returnValue:!0,ve:a};case ba.a.Kgc:return a=ba.a.GYa,{returnValue:!0,ve:a};case ba.a.FEb:return a=ba.a.Vgb,{returnValue:!0,ve:a};case ba.a.IEb:return a=ba.a.hhb,{returnValue:!0,ve:a};case ba.a.DEb:return a=ba.a.AHb,{returnValue:!0,ve:a};case ba.a.bhc:return a=ba.a.HYa,{returnValue:!0,ve:a};case ba.a.lwa:return a=ba.a.THb,{returnValue:!0,ve:a};case ba.a.tbd:return a=ba.a.Dlc,{returnValue:!0,
ve:a};case ba.a.ubd:return a=ba.a.Jid,{returnValue:!0,ve:a};case ba.a.AEb:return a=ba.a.zHb,{returnValue:!0,ve:a};case ba.a.Igc:return a=ba.a.ehb,{returnValue:!0,ve:a};case ba.a.Egc:return a=ba.a.VHb,{returnValue:!0,ve:a};case ba.a.fXa:return a=ba.a.BHb,{returnValue:!0,ve:a};case ba.a.Ngc:return a=ba.a.vMe,{returnValue:!0,ve:a};case ba.a.JEb:return a=ba.a.XHb,{returnValue:!0,ve:a};case ba.a.EEb:return a=ba.a.Elc,{returnValue:!0,ve:a};case ba.a.Wgc:return a=ba.a.CHb,{returnValue:!0,ve:a};case ba.a.Ama:return a=
ba.a.aid,{returnValue:!0,ve:a};case ba.a.zma:return a=ba.a.$hd,{returnValue:!0,ve:a};case ba.a.yma:return a=ba.a.Zhd,{returnValue:!0,ve:a};case ba.a.Ogc:case ba.a.Mgc:return Cd.Umd(a,!0);case ba.a.Pgc:return Cd.Umd(a,!0);case ba.a.Lgc:return a=ba.a.Yhd,{returnValue:!0,ve:a};case ba.a.GEb:return a=ba.a.tMe,{returnValue:!0,ve:a};case ba.a.Xgc:return a=ba.a.Hlc,{returnValue:!0,ve:a};case ba.a.Ygc:return a=ba.a.Ilc,{returnValue:!0,ve:a}}return Cd.HAh(a)}static tsl(a){switch(a){case ba.a.Phc:return a=
E.a.Chc,{returnValue:!0,ve:a};case ba.a.Rhc:return a=E.a.Fhc,{returnValue:!0,ve:a};case ba.a.Vhc:return a=E.a.Ihc,{returnValue:!0,ve:a};case ba.a.jFb:return a=F.a.xob,{returnValue:!0,ve:a};case ba.a.iFb:return a=F.a.xob,{returnValue:!0,ve:a};case ba.a.Shc:return a=E.a.scd,{returnValue:!0,ve:a};case ba.a.Thc:return a=E.a.Ghc,{returnValue:!0,ve:a};case ba.a.Whc:return a=E.a.Khc,{returnValue:!0,ve:a};case ba.a.Zhc:return a=E.a.jic,{returnValue:!0,ve:a};case ba.a.Uhc:return a=E.a.Hhc,{returnValue:!0,
ve:a};case ba.a.cic:return a=ba.a.nFb,{returnValue:!0,ve:a};case ba.a.bic:return a=ba.a.mFb,{returnValue:!0,ve:a};case ba.a.aic:return a=ba.a.lFb,{returnValue:!0,ve:a};case ba.a.fic:return a=E.a.Kic,{returnValue:!0,ve:a};case ba.a.Qhc:return a=ba.a.pcd,{returnValue:!0,ve:a};case ba.a.Yhc:return a=ba.a.Ecd,{returnValue:!0,ve:a};case ba.a.dIa:return a=ba.a.dic,{returnValue:!0,ve:a};case ba.a.dfb:return a=ba.a.eic,{returnValue:!0,ve:a};case ba.a.$hc:return a=E.a.sic,{returnValue:!0,ve:a};case ba.a.Xhc:return a=
ba.a.qXa,{returnValue:!0,ve:a};case ba.a.efb:return a=E.a.uic,{returnValue:!0,ve:a};case ba.a.ffb:return a=E.a.Aic,{returnValue:!0,ve:a}}a=Kd.ActionManager.J4;return{returnValue:!1,ve:a}}static HAh(a){switch(a){case ba.a.Phc:return a=ba.a.lic,{returnValue:!0,ve:a};case ba.a.Rhc:return a=ba.a.Zcd,{returnValue:!0,ve:a};case ba.a.Vhc:return a=ba.a.mic,{returnValue:!0,ve:a};case ba.a.Shc:return a=ba.a.cdd,{returnValue:!0,ve:a};case ba.a.Thc:return a=ba.a.ddd,{returnValue:!0,ve:a};case ba.a.Whc:return a=
ba.a.fdd,{returnValue:!0,ve:a};case ba.a.Zhc:return a=ba.a.hdd,{returnValue:!0,ve:a};case ba.a.Uhc:return a=ba.a.edd,{returnValue:!0,ve:a};case ba.a.cic:return a=ba.a.mdd,{returnValue:!0,ve:a};case ba.a.bic:return a=ba.a.ldd,{returnValue:!0,ve:a};case ba.a.aic:return a=ba.a.kdd,{returnValue:!0,ve:a};case ba.a.fic:return a=ba.a.oic,{returnValue:!0,ve:a};case ba.a.Qhc:return a=ba.a.ifb,{returnValue:!0,ve:a};case ba.a.jFb:return a=ba.a.bdd,{returnValue:!0,ve:a};case ba.a.iFb:return a=ba.a.$cd,{returnValue:!0,
ve:a};case ba.a.Yhc:return a=ba.a.jfb,{returnValue:!0,ve:a};case ba.a.dIa:return a=ba.a.rXa,{returnValue:!0,ve:a};case ba.a.dfb:return a=ba.a.sXa,{returnValue:!0,ve:a};case ba.a.$hc:return a=ba.a.nic,{returnValue:!0,ve:a};case ba.a.Xhc:return a=ba.a.gdd,{returnValue:!0,ve:a};case ba.a.efb:return a=ba.a.idd,{returnValue:!0,ve:a};case ba.a.ffb:return a=ba.a.jdd,{returnValue:!0,ve:a}}a=Kd.ActionManager.J4;return{returnValue:!1,ve:a}}static bPk(a){const b=new Kk;switch(a){case ba.a.hsg:b.Nm=ba.a.cSa}return b}static iCg(a,
b){a=new Zg;if(!b)throw Error.argumentNull();a.kd=Cd.ycg(b.MenuItemId);return a}static E$g(a,b){a=new Zg;const c={},f=new Nh.a;f.Nf(!1);c.queryResult=f;c.MenuItemId=Cd.ycg(b.MenuItemId);c.LineSpacingValue=-1;c.LineSpacingUnit=0;a.kd=c;a.sW=!0;a.Dbe=!0;return a}static ycg(a){return parseFloat(a)}}Cd.occ=null;Cd.lii=(jf=new Ha.a,jf.add(E.a.cut),jf.add(E.a.paste),jf.add(E.a.iwa),jf.add(E.a.Fba),jf.add(E.a.w$),jf.add(E.a.ePd),jf.add(E.a.UAa),jf.add(E.a.T4),jf.add(E.a.HIa),jf.add(E.a.$Ha),jf.add(E.a.YXa),
jf.add(ba.a.Phc),jf.add(ba.a.Vhc),jf.add(ba.a.fic),jf.add(ba.a.Rhc),jf.add(ba.a.Whc),jf.add(ba.a.Zhc),jf.add(ba.a.Uhc),jf.add(ba.a.cic),jf.add(ba.a.bic),jf.add(ba.a.aic),jf.add(ba.a.Shc),jf.add(ba.a.Thc),jf.add(ba.a.Qhc),jf.add(ba.a.Yhc),jf.add(ba.a.dIa),jf.add(ba.a.dfb),jf.add(ba.a.jFb),jf.add(ba.a.iFb),jf.add(ba.a.$hc),jf.add(ba.a.Xhc),jf.add(ba.a.efb),jf.add(ba.a.ffb),jf.add(ba.a.Q$g),jf.add(ba.a.S$g),jf.add(ba.a.R$g),jf.add(ba.a.xDe),jf.add(ba.a.wDe),jf.add(ba.a.Dgc),jf.add(ba.a.Kgc),jf.add(ba.a.bhc),
jf.add(ba.a.yEb),jf.add(ba.a.FEb),jf.add(ba.a.IEb),jf.add(ba.a.DEb),jf.add(ba.a.Igc),jf.add(ba.a.Egc),jf.add(ba.a.BEb),jf.add(ba.a.Qgc),jf.add(ba.a.Tgc),jf.add(ba.a.CEb),jf.add(ba.a.Rgc),jf.add(ba.a.Ugc),jf.add(ba.a.JEb),jf.add(ba.a.EEb),jf.add(ba.a.Ama),jf.add(ba.a.zma),jf.add(ba.a.yma),jf.add(ba.a.Wgc),jf.add(ba.a.Mgc),jf.add(ba.a.Ngc),jf.add(ba.a.Ogc),jf.add(ba.a.Pgc),jf.add(ba.a.Bbd),jf.add(ba.a.Cbd),jf.add(ba.a.lwa),jf.add(ba.a.fXa),jf.add(ba.a.THb),jf.add(ba.a.ehb),jf.add(ba.a.VHb),jf.add(ba.a.BHb),
jf.add(ba.a.tbd),jf.add(ba.a.ubd),jf.add(ba.a.AEb),jf.add(ba.a.Hgc),jf.add(ba.a.Sgc),jf.add(ba.a.insertHyperlink),jf.add(ba.a.Lgc),jf.add(ba.a.GEb),jf.add(ba.a.Xgc),jf.add(ba.a.Ygc),jf.add(ba.a.Ggc),jf.add(ba.a.HEb),jf.add(ba.a.Abd),jf.add(ba.a.zEb),jf.add(ba.a.eBe),jf.add(ba.a.vbd),jf.add(ba.a.ahc),jf.add(ba.a.$gc),jf.add(ba.a.Zgc),jf);Object(e.a)(Cd,"CuiActionBridge",ug,[]);class jE{constructor(){this.K=null}get name(){return"PowerPointWebEditor.UI"}Wb(a){this.K=a;this.K.register(262,"Box4.ISelectionContextMenuProvider").ma().na(()=>
new Aq);let b=this.K.resolve("PowerPointWebEditor.IApplicationSettings").rwb;r.a.Nj&&(b=b&&!this.K.resolve("PowerPointWebEditor.Ribbon.IPPTChromeExtensionHelper").ixa);this.K.register(Uz,"PowerPointWebEditor.EditSurfaceContextMenu").as("Box4.UI.AEditSurfaceContextMenu").ma().na(()=>new Uz(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Proofing.IErrorRangeEditor"),this.K.resolve("Box4.UI.IProofingContextMenuSectionFactory"),this.K.resolve("PowerPointWebEditor.IContextMenuHelper"),
this.K.resolve("Box4.IContextSetEditor"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder"),this.K.Ka("PowerpointPresence.IPresenceManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),b));a.register(263,"PowerPointWebEditor.ICUIManager").ma().na(()=>new aM(a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("PowerPointWebEditor.IContextMenuUser"),
a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.CuiActionBridge"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Common.IActionManagerExtended"),a.resolve("Common.IRibbonExternal")));a.register(Cd,"PowerPointWebEditor.CuiActionBridge").as("Box4.UI.CuiActionBridge").ma().na(()=>new Cd(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IInkRibbonManager")));this.K.register(264,"PowerPointWebEditor.IStatusBarUserHelper").ma().na(()=>new ZL(a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(265,"PowerPointWebEditor.IStatusBarUser").ma().na(()=>new cE(a.resolve("PowerPointWebEditor.IStatusBarPane").xa,
a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Graph.IGraphInstance").vd(7),a.qb("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.resolve("Common.IExternalUICommandDefinitionMapping"),a.resolve("PowerPointWebEditor.IStatusBarUserHelper"),a.resolve("Common.IAppSettingsManager"),wd.a.get_instance()));a.register(ax,"CommandUI.ReactRibbonRoot").ma().na(()=>new ax(Gr.instance,a.resolve("Common.IExternalUICommandDefinitionMapping"),
a.resolve("Box4.IGeneralCuiUser")));a.register(266,"PowerPointWebEditor.IContextMenuUser").ma().na(()=>new VL(a.resolve("Box4.IContextMenuController"),Object(ua.a)(Uz,a.resolve("Box4.UI.AEditSurfaceContextMenu"))));a.register(267,"Box4.IBox4BridgeCommandUi").ma().na(()=>new $L(a.resolve("Box4.IGeneralCuiUser"),a.resolve("PowerPointWebEditor.IRibbonUser"),a.resolve("Common.IActionManager"),a.resolve("Common.IRibbonExternal")));this.K.register(268,"PowerPointWebEditor.IContextMenuHelper").ma().na(()=>
new UL(a.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(bE,"Box4.UI.EditorServiceProofingContextMenuCreator").ma().na(()=>new bE(a.resolve("Box4.UI.IProofingRepeatedWordSectionBuilder"),a.resolve("Box4.Proofing.IProofingFeatureConfiguration"),a.qb("Box4.Proofing.IIgnoreAllKeywords"),"pegal",a.resolve("PowerPoint.IPathManager").hk("pegal.png"),!1,a.resolve("Box4.IFormattingReader")))}init(){this.K.resolve("PowerPointWebEditor.ActionCommandsRumTrackerReporter");this.K.resolve("PowerPointWebEditor.CuiActionBridge").initialize();
this.K.resolve("PowerPointWebEditor.ICUIManager").initialize();this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame").fei(this.K.resolve("Box4.IBox4BridgeCommandUi"))}dispose(){this.K.resolve("PowerPointWebEditor.ICUIManager").dispose();this.K.resolve("PowerPointWebEditor.IStatusBarUser").dispose();this.K.resolve("PowerPointWebEditor.IContextMenuUser").dispose()}static main(){m.a.instance.Bc(new jE)}}Object(e.a)(jE,"PPTWebEditorUIPackage",null,[2,3]);class cM{constructor(a){this.kLh="FontPicker";
this.Swd=null;this.f1=a;this.Xsc=this.f1.sfb(Fr.a.lTa,Object(C.a)(this,this.ksb,"featureStateChangeCallback"));this.f1.isFeatureEnabled(Fr.a.lTa,!1).then(b=>{this.Swd=b})}get isLicensed(){return this.Swd}ksb(a){this.Swd=a.isEnabled;a=appChrome.actions.updateFontPickerLicenseState(this.kLh,a.isEnabled);appChrome.api.dispatch(a)}dispose(){this.f1.HFb(Fr.a.lTa,this.Xsc)}}Object(e.a)(cM,"ModernFontPickerFeatureHelper",null,[257,106]);class Vz{constructor(a){this.lGa=null;a?Object.getType(a)===String?
this.lGa=Vz.deserialize(a):this.lGa=a:(Z.ULS.sendTraceTag(543475146,3021,10,"Failed to populate pinned fonts."),this.lGa=[]);this.yFa=!1}get isDirty(){return this.yFa}get Uad(){return Array.clone(this.lGa)}M1h(a){Array.contains(this.lGa,a)||(Array.add(this.lGa,a),this.yFa=!0)}QPk(a){Array.contains(this.lGa,a)&&(Array.remove(this.lGa,a),this.yFa=!0)}serialize(){return JSON.stringify(this.lGa)}BVk(){this.yFa=!1}static deserialize(a){try{return JSON.parse(a)}catch(b){return Z.ULS.sendTraceTag(543475147,
3021,10,"Deserialize failed: {0}",b.toString()),[]}}}Object(e.a)(Vz,"PinnedFontStore",null,[]);class dM{constructor(a,b,c,f){this.ia=a;this.la=c;this.mQg=b;this.yb=f;this.d4=null}initialize(){this.ia.ya(F.a.kgc,xd.a.frame,Object(C.a)(this,this.kgc,"pinOrUnpinFont"));this.ia.pa(F.a.U6f,xd.a.frame,Object(C.a)(this,this.S_g,"onFontPickerMenuClose"),96);this.mQg.m4d("getPPTPinnedFontsSettings").continueWith(Object(C.a)(this,this.Opk,"onRoamingSettingLoaded"))}AOj(a){return a.Jn?!1:a.hm?(Z.ULS.sendTraceTag(543273993,
3021,10,"Load setting failed with exception {0}",a.Wi),!1):!0}Opk(a){this.AOj(a)?this.d4=new Vz(a.result||this.qeg()):this.d4=new Vz(this.qeg());this.h$g()}h$g(){appChrome.api.dispatch(appChrome.actions.updatePinnedFonts("FontPicker",this.Uad))}get Uad(){return this.d4?this.d4.Uad:[]}qeg(){return this.la.Ga("RecommendedFonts")}kgc(a,b,c,f,l){if(!this.d4)return Z.ULS.sendTraceTag(543475150,3021,50,"Roaming setting is not available yet"),64;(a=l.CommandValueId)&&(l.IsPinned?this.d4.M1h(a):this.d4.QPk(a));
return 32}S_g(){if(!this.d4||!this.d4.isDirty)return 32;const a=xe.a.RGc(10,Object(C.a)(this,this.updatePinnedFonts,"updatePinnedFonts"));this.yb.Cb(a);return 32}updatePinnedFonts(){this.d4&&(this.h$g(),this.kkh(),this.d4.BVk())}kkh(){if(this.d4&&this.d4.isDirty){var a=this.d4.serialize();this.mQg.H8k(a)}}dispose(){this.kkh();this.ia.uO(F.a.kgc,xd.a.frame,Object(C.a)(this,this.kgc,"pinOrUnpinFont"));this.ia.uO(F.a.U6f,xd.a.frame,Object(C.a)(this,this.S_g,"onFontPickerMenuClose"))}}Object(e.a)(dM,
"FontPinningHandler",null,[258,106]);class Bq{static get ead(){return CommonUIStrings.l_ModernFontPicker_FontInfoPaneTitle}}Bq.kCa="fontInfoTaskPane";Bq.bQi="modernfontpicker";Object(e.a)(Bq,"FontInfoPaneConstants",null,[]);class eM{constructor(){this.type="FontInfoTaskPaneProps";this.onUpsellButtonClicked=null;this.isLicensed=!1;this.paneId=this.helpArticleUrl=this.trigger=this.fontName=null}}Object(e.a)(eM,"FontInfoTaskPaneProps",null,[]);var ju=d(637);class Wz{constructor(a,b,c,f=null){this.V2a=
this.$U=this.Xsc=null;this._state=this.Olb=0;this.xRh=a;this.f1=b;this.dKh=c;this.Kd=f}get kn(){return this.xRh.value}initialize(){this.kn.ya(F.a.gHe,xd.a.frame,Object(C.a)(this,this.gHe,"requestFontInfo"));this.Xsc=this.f1.sfb(Fr.a.lTa,Object(C.a)(this,this.ksb,"featureStateChangeCallback"));this.chb()}Tl(a=!1){const b=Ej.UISurfaces.Ms(),c=this.f1.isFeatureEnabled(Fr.a.lTa,!1),f=[];f.push(b);f.push(c);Promise.all(f).then(l=>{l[0].showTaskPane(Bq.kCa,this.Aba(l[1]));a&&this.Mr()})}ZDh(a){Ej.UISurfaces.Ms().then(b=>
{b.updateTaskPane(Bq.kCa,this.Aba(a));return null})}ksb(a){this.ZDh(a.isEnabled)}gHe(a,b,c,f,l){this.$U=l.CommandValueId;this.V2a=l.Trigger;this.Olb=l.InputMethod;this.Tl(2===this._state&&1===this.Olb);return 32}Aba(a){const b=new eM;b.onUpsellButtonClicked=Object(C.a)(this,this.onUpsellButtonClicked,"onUpsellButtonClicked");b.fontName=this.$U;b.isLicensed=a;b.trigger=this.V2a;b.helpArticleUrl=this.Zui();b.paneId=Bq.kCa;a=this.Tyj();a.contentProps=b;return a}Tyj(){return Object.assign(new ju.a,{title:Bq.ead,
hideHeader:!1,width:320,location:2,isModernPane:!0,enableResize:!0,minResizeWidth:320,maxResizeWidth:920,onOpen:Object(C.a)(this,this.onOpen,"onOpen"),onClose:Object(C.a)(this,this.onClose,"onClose"),onShow:Object(C.a)(this,this.onShow,"onShow"),onHide:Object(C.a)(this,this.onHide,"onHide")})}chb(){if(this.Kd){var a=this.Kd.Dc(Bq.kCa);a.parent=y.AFrame.jj;a.cL=!0}}onOpen(){this._state=2;this.Mr()}onShow(a){0!==this._state&&(this._state=2,1===a&&(this.Olb=a),this.Mr())}onClose(){this.Olb=this._state=
0;this.blur()}onHide(){this._state=1;this.Olb=0}Mr(){this.Kd&&1===this.Olb&&this.Kd.Bf(Bq.kCa)}blur(){this.Kd&&this.Kd.ze&&this.Kd.ze.name===Bq.kCa&&this.Kd.Bf(this.Kd.m7)}onUpsellButtonClicked(){this.f1.launchUpsellExperience(Bq.bQi)}dispose(){this.f1.HFb(Fr.a.lTa,this.Xsc)}Zui(){return String.format("{0}&EntryPoint=True&IsFontPane=True&HelpId={1}&ShowNav=False&NS={2}&uilcid={3}",this.dKh,this.D6i(),"PPWAENDUSER",u.AFrameworkApplication.lcid)}D6i(){switch(this.V2a){case "missing":return"hlpFontInfoMissingFont";
case "embedded":return"hlpFontInfoEmbeddedFont";case "compatible":return"hlpFontInfoCompatibilityFont";case "theme":return"hlpFontInfoThemeFont"}return Wz.Mfi(this.$U)}static Mfi(a){let b="hlpFontInfo";for(let c=0;c<a.length;++c){const f=Ka.a.charAt(a,c);if(255<a.charCodeAt(c)||Ka.a.ptg(f))b+=f}return b}}Object(e.a)(Wz,"FontInfoPane",null,[259,106]);class fM extends Wz{constructor(a,b,c,f){super(a,b,c.Ga("FontInfoHelpBaseUrl"),f)}ksb(a){this.ZDh(a.isEnabled)}}Object(e.a)(fM,"PPTFontInfoPane",Wz,[]);
class kE{constructor(){this.s2c=this.D9b=this.E9b=this.K=null}get name(){return"PowerPointWebEditor.ModernFontPicker"}Wb(a){this.K=a;this.K.register(257,"Common.ModernFontPicker.IModernFontPickerFeatureHelper").ma().na(()=>new cM(this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(258,"Box4.IFontPinningStore").ma().na(()=>new dM(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IRoamingServiceRequestManager"),this.K.resolve("Common.IAppSettingsManager"),
this.K.resolve("Common.ITaskManager")));this.K.register(259,"Common.ModernFontPicker.IFontInfoPane").ma().na(()=>new fM(new Sa.a(()=>u.AFrameworkApplication.Ta),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("Common.IFocusManager")))}init(){const a=this.K.resolve("Common.IAppSettingsManager");a.ff(()=>{this.K.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{a.ka("PPTOModernFontPickerIsEnabled")&&
(this.s2c=this.K.resolve("Common.ModernFontPicker.IModernFontPickerFeatureHelper"),this.D9b=this.K.resolve("Common.ModernFontPicker.IFontInfoPane"),this.D9b.initialize(),b.isFeatureEnabled(Fr.a.lTa,!1).then(c=>{!u.AFrameworkApplication.fa.ka("IsAnonymousUser")&&c&&(this.E9b=this.K.resolve("Box4.IFontPinningStore"),this.E9b.initialize())}),Cb.App.Hb.updateCommandUI())})})}dispose(){this.D9b&&(this.D9b.dispose(),this.D9b=null);this.E9b&&(this.E9b.dispose(),this.E9b=null);this.s2c&&(this.s2c.dispose(),
this.s2c=null)}static main(){m.a.instance.Bc(new kE)}}Object(e.a)(kE,"PPTModernFontPickerPackage",null,[2,3]);var lE=d(1046);class gM{constructor(a){this.C9=a;this.Lcb=this.C9.nCb("UserAction","ImageProcessor");this.W0j=67}ECg(a,b){if(b)if(a&&this.ERj){let c=new Image;c.onload=()=>{b(c);URL.revokeObjectURL(c.src);c=null};(a=URL.createObjectURL(a))?c.src=a:b(null)}else b(null)}gth(a,b,c){c-=this.W0j;if(0>=c||!a)return null;let f=a.width,l=a.height;if(0>=f||0>=l)return null;let x=null,G=1,R=0;try{const fa=
Math.ceil(1.37*b);if(c<=fa){const wa=Math.sqrt(c/(1.3*fa));f=Math.floor(a.width*wa);l=Math.floor(a.height*wa)}if(x=this.YZf(a,f,l))if(R=x.length,x.length>=c){const wa=this.Nfg(a.width,a.height);wa*Math.floor(a.width)*wa*Math.floor(a.height)>=f*l?x=null:(G++,(x=this.Mfl(a))&&x.length>=c&&(x=null))}}catch(fa){x=null,Z.ULS.sendTraceTag(20841025,826,15,"ShrinkImageBySize failed. Error message: "+fa.message+", Call stack: "+fa.stack)}a=String.format("ShrinkImageBySize: BlobSize={0},numTry={1},Base64AfterFirstShrink={2},FinalBase64Length={3}",
b,G,R,x?x.length:0);Z.ULS.sendTraceTag(20841026,826,50,a);return x}Mfl(a){let b=null;if(a){let c=a.width,f=a.height;const l=this.Nfg(c,f);c=Math.floor(c*l);f=Math.floor(f*l);try{b=this.YZf(a,c,f)}catch(x){Z.ULS.sendTraceTag(20841027,826,15,"ShrinkHTML5ImageByResolution failed. Error message: "+x.message+", Call stack: "+x.stack)}}return b}YZf(a,b,c){if(0>=b||0>=c)return null;let f;this.Lcb.start();var l=document.createElement("canvas");l.width=b;l.height=c;var x=l.getContext("2d");f=this.Lcb.Kq;x.drawImage(a,
0,0,b,c);x=this.Lcb.Kq-f;l=l.toDataURL("image/png");a=String.format("DoShrink: Before={0}x{1},After={2}x{3},CreateCanvas={4}ms,DrawImage={5}ms,ToDataURL={6}ms",a.width,a.height,b,c,f,x,this.Lcb.Kq-(f+x));Z.ULS.sendTraceTag(20841028,813,50,a);return l}Nfg(a,b){return 0>=a||0>=b?0:1280<a||1280<b?Math.min(1280/a,1280/b):1}get ERj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}get URL(){return window.URL||window.webkitURL}}Object(e.a)(gM,"ImageProcessor",null,[1132]);class mE{constructor(a,
b,c,f,l){this.Ca=a;this.pKh=b;this.oKh=c;this.oZe=f;this.jUh=l}get kn(){return this.Ca}ifi(a){this.kn.$bd(a,this.pKh,null,null)}gfi(a){this.kn.$bd(a,this.oKh,null,null)}tqa(a,b,c){c?this.kn.$bd(a,this.oZe,b,null):this.kn.La(this.oZe,2,b)}N5g(a,b=!1){const c=new D.DictionaryPropertySet;c.setValue(Oc.a.bU,a);c.setValue(Oc.a.Had,!0);c.setValue(Oc.a.U8a,b);this.kn.La(this.jUh,2,c)}}Object(e.a)(mE,"ClipboardCommands",null,[1109]);class nE{RZb(){}}Object(e.a)(nE,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",
null,[1378]);class Cq{constructor(a,b,c,f,l,x){this.dD=a;this.Yg=b;this.Ou=c;this.xm=f;this.Ro=l;this.Xc=x}KBj(a,b){a=b.view;b=b.fE;if(!b||H.a.instance.ga(14)&&!this.dD.evg(b,!0)||this.xm&&this.xm.instance&&this.xm.instance.lW(b))return 2;var c=Cq.uU?!Cq.Jt.Gja(b):!0;this.Ou&&c&&this.Ou.Boc(b.node,w.a.lq,b.Qa);this.Yg.eSc(b,l=>new zv.a(l,zv.a.DHc),se.AParagraphNode.AZ);if(this.Xc.ag&&this.Xc.By){c=new Id.GraphTransaction(15);try{c.gd(b.node)}finally{c&&c.dispose()}}var f=b.node;c=b.Kb+1;" "===yb.ParagraphReader.text(f).charAt(c)&&
(f=Mc.a.createTextRange(f,c,c+1),this.Yg.replaceTextRange(f,"\u00a0"));b=Mc.a.ak(b.node,c);a.Gb.setSelection(rd.SelectionFactory.nu(b));return 32}static get Jt(){return Cq.bD||(Cq.bD=fb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get uU(){null==Cq.QH&&(Cq.QH=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Cq.QH}}Cq.bD=null;Cq.QH=null;Object(e.a)(Cq,"InsertLineBreakStrategy",null,[]);class Sn{static get Nh(){return Sn.Ai||(Sn.Ai=
fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get Yl(){return Df.ContextSetEditor.instance}static get H5(){return Sn.Ro||(Sn.Ro=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get Qf(){return Sn.Xc||(Sn.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static TBj(a,b,c,f,l){if(l&&l.Sa(Oc.a.targetObject)){var x=b.view.vg.Fh.te(l.getValue(Oc.a.targetObject));x=Mc.a.create(x)}else x=Sn.Yl.Y1(b.fE,11);if(!x)return 8;a=
u.AFrameworkApplication.Ta.ki(x,a,c,!0,f,l);if(32===a&&2===c){if(!b.view.Lh)return 2;b=b.view;f=b.Gb.Kj;if(f=Sn.Yl.Y1(f,11)){c=new tn.a;c.set(f.node);c.af();if(l&&l.Sa(Oc.a.targetObject))for(l=l.Xh(Oc.a.targetObject);!c.currentNode.id.equals(l)&&c.yc()&&(Xb.OutlineElementNavigator.Ke(c),11===c.oi););Xb.OutlineElementNavigator.Ava(c,!1,!1);l=cb.SelectionEditor.yia(c,!0);l=yb.ParagraphReader.Xr(l)?rd.SelectionFactory.Mg(l,0):rd.SelectionFactory.gl(l);b.Gb.setSelection(l)}}return a}static N8d(a,b,c,
f,l){a=a===E.a.a4b;b=b.node;if(l&&l.Sa(Oc.a.targetObject)&&!b.id.equals(l.Xh(Oc.a.targetObject)))return 2;if(1===c)return 32;c=new nb.GraphIterator;c.set(b);c.pc(10);Sn.Nh.xca(c,a,!0);Sn.Qf.ag&&Sn.Qf.By&&Xb.OutlineElementNavigator.ri(c);return 32}}Sn.Ai=null;Sn.Ro=null;Sn.Xc=null;Object(e.a)(Sn,"InsertOutlineElementStrategy",null,[]);var EQ=d(404);class Xz{constructor(a,b,c,f,l,x,G,R){this.Ou=b;this.kNh=a;this.rt=l;this.Po=f;this.Ai=c;this.dD=x;this.Qc=G;this.p2a=R}Wgk(a,b,c,f,l){if(!b.view.Lh)return 2;
b=b.view;let x=null;b.$o&&(x=b);const G=b.Gb.Kj;let R=!0,fa=!1,wa=null;if(!G)return 2;const Wa=new Id.GraphTransaction(15);Wa.gd(b.vg);let mb=null;2===c&&(mb=new tn.a,mb.set(G.node),mb.af(),wa=new lx(mb),2===Cb.App.mode&&cb.SelectionEditor.Pg(G)&&(mb.lB(11)&&Ib.ListReader.kk(mb)&&ae.OutlineElementReader.isEmpty(mb,!1)&&(R=!1),R&&Cb.App.Ih.Zv&&ae.OutlineElementReader.eC(mb,G,!1)&&!ae.OutlineElementReader.eC(mb,G,!0)&&(R=!1)),Xb.OutlineElementNavigator.Ke(mb),ae.OutlineElementReader.isEmpty(mb,!1)&&
(EQ.a.jMj(mb)&&(R=!1),1===Cb.App.mode&&Ib.ListReader.kk(mb)&&(fa=!0)));a=u.AFrameworkApplication.Ta.ki(G,a,c,!1,f,l);R&&32===a&&2===c&&(fa||Xb.OutlineElementNavigator.iHa(mb,!1,!cb.SelectionEditor.Pg(G),!1),fa&&wa&&wa.restore(mb),H.a.instance.ga(101)&&this.rt.freeze(),b.Gb.setSelection(rd.SelectionFactory.rj(mb.currentNode,!0)),H.a.instance.ga(101)&&this.rt.eSe(),this.kNh.yn.Yv());x&&(R||x.Rwa());qf.GrippersManager.instance.c_a(1);Wa.dispose();return a}cB(a,b,c){a=!1;if(W.ImageReader.VDa(b)||W.ImageReader.Fvb(b))b=
this.twi(b),a=!0;const f=b;b=cb.SelectionEditor.Pg(b);if(1===c)return 32;const l=f.node,x=new nb.GraphIterator;x.set(l);x.af();Xb.OutlineElementNavigator.Ke(x);c=new Id.GraphTransaction(15);c.iy(x);b?(b=!0,H.a.instance.ga(101)&&yb.ParagraphReader.Vd(l)&&f.Qa===yb.ParagraphReader.textLength(l)&&Ie.n(f)&&9===yb.ParagraphReader.sOc(l)&&this.rt.ixi(f),1===Cb.App.mode&&ae.OutlineElementReader.isEmpty(x,!1)&&Ib.ListReader.kk(x)&&(b=!1),this.Po.wnh(x,b,f,l),this.Ou&&this.Ou.Boc(l,w.a.lq,f.Qa),a&&(Xb.OutlineElementNavigator.eJ(x,
!1,!1),a=x.Ab(2),(a=this.p2a.Mg(a,0))&&this.Qc.setSelection(a))):this.Ai.xca(x,!0,!0);c.dispose();Cb.App.Hb&&Cb.App.Hb.updateCommandUI();return 32}twi(a){if(W.ImageReader.VDa(a))var b=Mc.a.ak(a.node,a.Qa);else{b=yb.ParagraphReader.eBa(a.node);var c=b.properties.Xh(Mb.a.XX);a=a.node.properties.getValue(Mb.a.runId);c=Xz.F2i(a,c,b.Ra);b=Mc.a.ak(b,c)}return b}static dUi(a,b){let c=0;for(;c<b.length&&!(a<b[c]);)c++;return c}static F2i(a,b,c){let f=0;a=Xz.dUi(a,b);let l=0;if(a===b.length)l=c.length-1;else for(;l<
c.length;){b=c.ga(l);if(b.formatting&&b.formatting.kg===a)break;l++}l<c.length&&(f=c.ga(l).cp);return f}}Object(e.a)(Xz,"NewLineStrategy",null,[]);class ku{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.Hs=null;this.XY=a;this.Psc=x;this.dwc=new Xz(this,b,c,f,l,G,wa,Wa);this.W7e=new Cq(G,R,b,fa,mb,Kb)}get yn(){return this.Hs||(this.Hs=this.XY())}ub(){const a=u.AFrameworkApplication.Ta,b=Object(C.a)(this.dwc,this.dwc.cB,"newLine");a.pa(E.a.enter,Bb.a.view,Object(C.a)(this.Psc.value,this.Psc.value.UOi,
"enterView"),1124);a.pa(E.a.Rid,Bb.a.view,Object(C.a)(this.Psc.value,this.Psc.value.r$k,"shiftEnterView"),1124);a.ya(E.a.cB,Bb.a.view,Object(C.a)(this.dwc,this.dwc.Wgk,"newLineView"));a.ya(E.a.cB,Bb.a.Of,b);a.ya(E.a.cB,Bb.a.image,b);a.ya(E.a.cB,Bb.a.textRange,b);a.ya(E.a.cB,Bb.a.anchoredObject,b);a.ya(E.a.cB,Bb.a.embeddedFile,b);a.ya(E.a.cB,Bb.a.ink,b);a.ya(E.a.cB,Bb.a.paragraph,b);a.ya(E.a.cB,Bb.a.iFrame,b);a.ya(E.a.cB,Bb.a.unsupportedObject,b);a.he(E.a.cB,1124);a.pa(E.a.Z3b,Bb.a.view,Object(C.a)(this.W7e,
this.W7e.KBj,"insertLineBreakView"),1028);a.ya(E.a.a4b,Bb.a.view,Sn.TBj);a.ya(E.a.a4b,Bb.a.outlineElement,Sn.N8d);a.he(E.a.a4b,1092)}static get instance(){return ku.Ja||(ku.Ja=ku.WB())}static WB(){return new ku(()=>fb.a.instance.resolve("Box4.IUndoManager"),fb.a.instance.qb("Box4.IAutoCorrectScheduler"),fb.a.instance.resolve("Box4.IOutlineElementEditor"),fb.a.instance.resolve("Box4.List.IListEditor"),fb.a.instance.resolve("Box4.IInsertionPointFormatting"),fb.a.instance.le("Box4.Actors.IEnterViewStrategy"),
ed.a.instance,fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"),fb.a.instance.Ka("Box4.IExternalSelectionManager"),qd.a.instance,fb.a.instance.resolve("Box4.ISelectionFactory"),fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}}ku.Ja=null;Object(e.a)(ku,"EnterActor",null,[]);class hM{iwh(a){return a}xxg(){return!0}}Object(e.a)(hM,"EopFormattingStrategy",null,[1112]);var iM=d(150);class oE{constructor(a,
b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.FMa=this.OQb=this.ekb=null;this.oEd=0;this.iwd=!1;this.Pa=new ic.a;this.UNb=null;this.iK=a;this.rt=b;this.Hf=c;this.Hw=f;this.ir=l;this.Po=x;this.Sg=G;this.Yg=R;this.dD=fa;this.Yc=wa;this.Xc=Wa;this.Ro=mb;this.oNa=Kb}get YMi(){return H.a.instance.ga(105)?this.Yc?this.Yc.isFeatureEnabled(55):u.AFrameworkApplication.fa.ka("Box4EndOfParagraphFormattingIsEnabled"):!1}get Yba(){return this.UNb||(this.UNb=fb.a.instance.resolve("Box4.IFormatPainterStrategy"))}get TK(){return this.iwd}set TK(a){this.iwd!==
a&&(this.iwd=a,this.Pa.raiseEvent("FormatPainterBrushActiveStatusChanged"))}Y4h(a){this.Pa.addHandler("FormatPainterBrushActiveStatusChanged",a)}G6g(a){const b=a.Ua;Z.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",b.contextId);this.reset();var c=b.node;a=this.fxg(a);if(this.Yba.arh(b.contextId,a))try{this.FMa=this.ir.fsa(c)}catch(f){throw Z.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",f.message),f;}this.OQb=Uc.StyleReader.BD(c);c=vb.a.Ls(b);c.Iz&&(this.ekb=
Object(ua.a)(mq.a,c.Iz.clone()));this.oEd=a?Bb.a.paragraph:b.contextId;this.Yba.aGf(b.node,this.FMa,this.ekb)}YHf(a){const b=H.a.instance.ga(14),c=this.fxg(a);for(let R=0;R<a.length;R++){var f=a.ga(R);if(f.Qk){var l=void 0;if(f.contextId===Bb.a.Of||f.contextId===Bb.a.textRange)l=b&&this.dD.Xsa(f);else if(f.contextId===Bb.a.paragraph)l=b&&this.dD.QUc(f);else if(f.contextId===Bb.a.endOfParagraph)l=b&&this.dD.NTc(f);else{Z.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",f.contextId);
continue}Z.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",f.contextId);if(l)Z.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");else{l=Object(ua.a)(se.AParagraphNode,f.node);var x=!1;l&&(x=f.contextId===Bb.a.textRange&&!!l&&!f.Qa&&f.Kb===this.ir.textLength(l));if(x=this.Yba.rqh(this.oEd,f.contextId,c,x))try{yb.ParagraphReader.Vd(l)?(this.OQb&&this.iK.y$(this.OQb,l,!0),this.Hw.eIf(l,this.FMa)):Z.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",
f.node.type)}catch(fa){throw Z.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",fa.message),fa;}var G=f;f.contextId===Bb.a.paragraph?G=Mc.a.createTextRange(l,0,yb.ParagraphReader.textLength(l)):f.contextId===Bb.a.Of&&(G=this.rt.w1b(f),G=qd.a.ROa(G));if(G&&G.contextId===Bb.a.textRange)try{this.xai(G,this.ekb,x?null:this.OQb)}catch(fa){throw Z.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",fa.message),fa;}if(f.contextId===Bb.a.paragraph||f.contextId===
Bb.a.endOfParagraph){x=new nb.GraphIterator;x.set(l);x.af();x.Rg(11);G=Ib.ListReader.kk(x);const fa=!yb.ParagraphReader.textLength(l);Z.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",G,fa);G?(this.Sg.Ula(x),f=x.currentNode,this.Sg.Ica(f)&&this.Po.Hhd(f,l,this.ekb)):this.YMi&&this.wai(f,this.ekb)}}}else Z.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",f.contextId)}}wai(a,b){b&&(a=this.Yg.DVd(a.node),a.Ud(a.ye),this.ZHf(a,
b,null))}xai(a,b,c){if(b||c)0<Ie.h(a).length&&Z.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this.oNa.uCc(a,f=>{this.ZHf(f,b,c)})}ZHf(a,b,c){this.Hf.SAa(a);a.Iz&&a.Iz.removeProperty(tb.a.highlight);this.Hf.HEc(a);this.Jx(a,c);this.Jx(a,b)}Jx(a,b){if(b){var c=a.paragraph.Fh;if(c){var f=a.Iz;f=f?Object(ua.a)(iM.a,f.clone()):mq.a.cBa(1179725);for(const x of b.Mz())if(x!==Mb.a.qG&&x!==Mb.a.fieldInstruction&&x!==tb.a.Qs&&x!==tb.a.WZ&&x!==Mb.a.M8a&&x!==tb.a.Rs&&x!==Mb.a.languageHint&&
x!==Mb.a.noProof){if(x===Kg.a.e2){var l=b.sa(Kg.a.e2,Ga.a.nil);if(l!==Ga.a.nil&&(l=Object(ua.a)(mq.a,c.te(l)),l=Uc.StyleReader.lPc(l),l===Box4Intl.Box4Strings.L_StyleWordHyperlink)){l=Uc.StyleReader.MK(a.paragraph).ugj(l);f.Jx(l);continue}}f.setValue(x,b.Xh(x))}f.B9a?b=c.pIa(f):(c.jE(f),b=f);a.em=b.id}}}fxg(a){return!a.sba&&a.Ve.contextId!==Bb.a.endOfParagraph}reset(){this.FMa=this.OQb=this.ekb=null;this.oEd=Bb.a.none}}Object(e.a)(oE,"FormatPainter",null,[986]);class Yz{constructor(a){this.Xk=this.transaction=
null;this.Ef=a;this.Dqb=this.kq=0}}Object(e.a)(Yz,"SelectAllArguments",null,[]);class Rr{constructor(a,b,c,f,l){this.ZTh=a;this.Cga=b;this.rk=c;this.zwd=f;this.mPb=l}get xze(){return this.ZTh}get yn(){return this.Cga.value}get U_k(){return this.zwd?this.mPb?Object(C.a)(this,this.YPi,"expandSelectionOneNote"):Object(C.a)(this,this.ZPi,"expandSelectionWord"):Object(C.a)(this,this.Xkh,"selectAllInOutline")}get Ykh(){return this.mPb?Object(C.a)(this,this.Ggd,"selectAllOutlines"):null}ub(){const a=u.AFrameworkApplication.Ta;
this.Ykh&&a.pa(E.a.Ggd,Bb.a.view,this.Ykh,2);a.ya(E.a.B$,xd.a.frame,Rr.Xrh);a.ya(E.a.Tid,xd.a.frame,Rr.Xrh);a.pa(E.a.ura,Bb.a.view,this.U_k,2);a.pa(E.a.q$h,Bb.a.view,y.AFrame.Ae,100);a.pa(E.a.Que,Bb.a.view,Rr.Que,4)}YPi(a,b,c){return this.ura(b,c,null)}ura(a,b,c){if(1===b)return 32;if(!a.view.Lh)return 2;b=a.view;if(!b.Gb)return 8;const f=b.Gb.Oa;if(!f||!f.length)return 8;Me.a.mark(5798);Cb.App.Hb.Hd.isEditingAllowed||Cb.App.Hb.Hd.My?a=cb.SelectionEditor.G1d(f):(v.FocusManager.instance().IC(y.AFrame.PV),
a=rd.SelectionFactory.gJe(b.vg));if(!a)return 8;this.zwd&&!f.Sqa&&Z.ULS.sendTraceTag(39098305,324,50,"Progress selection start");c&&this.xze.r9a(cb.SelectionEditor.L$f(a))?c=c(b):(c=new Yz(b),c.Xk=a,c=new hd.a(null,Object(C.a)(this,this.WEb,"processSetSelection"),c),c.Fl("ExpandSelection"),c.run());return c.inProgress?1:32}ZPi(a,b,c,f,l){return b.view.$o?this.ura(b,c,Object(C.a)(this,this.Xuh,"startOperationOfSelectAllInOutline")):this.Xkh(a,b,c,f,l)}WEb(a,b){return 0===b.kq?(b.transaction=this.rk.ke(2),
b.transaction.gd(b.Ef.vg),b.kq=1,!0):1===b.kq?(b.Ef.Gb.yHb(b.Xk,a),b.kq=2,!0):2===b.kq?(b.Ef.Gb.Oa.Sqa=b.Xk.Sqa,this.yn.Yv(),b.transaction.oU(a),b.kq=3,b.transaction.dispose(),Me.a.mark(5799),!0):!1}Xkh(a,b,c){if(1===c)return 32;if(!b.view.Lh)return 2;a=b.view;return a.Gb&&a.Gb.Oa&&a.Gb.Oa.kb?this.Xuh(a).inProgress?1:32:8}Xuh(a){u.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings");this.zwd&&a.$o&&Z.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");
a=new hd.a(null,Object(C.a)(this,this.FDk,"processSelectAllInOutline"),new Yz(a));a.Fl("SelectAllInOutline");a.run();return a}FDk(a,b){if(0===b.kq)return b.Xk=rd.SelectionFactory.V_k(b.Ef.Gb.Oa.kb),b.transaction=this.rk.ke(2),b.transaction.gd(b.Ef.vg),b.kq=1,!0;if(1===b.kq){if(!b.Dqb)return H.a.instance.ga(77)&&H.a.instance.ga(104)&&b.Xk.vl?(b.Ef.Gb.yHb(b.Xk,a),b.Dqb=b.Xk.length):(b.Ef.Gb.setSelection(b.Xk.ga(0),a),++b.Dqb),!0;if(b.Dqb<b.Xk.length)return b.Ef.Gb.iEf(b.Xk.ga(b.Dqb),a),++b.Dqb,!0;b.kq=
2}return 2===b.kq?(b.Ef.Gb.Oa.Sqa=b.Xk.Sqa,this.yn.Yv(),b.transaction.oU(a),b.kq=3,b.transaction.dispose(),!0):!1}Ggd(a,b,c){if(1===c)return 32;if(!b.view.Lh)return 2;b=b.view;a=rd.SelectionFactory.gJe(b.vg);if(!a)return 8;b=new Yz(b);b.Xk=a;a=new hd.a(null,Object(C.a)(this,this.WEb,"processSetSelection"),b);a.Fl("ExpandSelection");a.run();return a.inProgress?1:32}static get qgb(){return Rr.o2a||(Rr.o2a=fb.a.instance.resolve("Box4.ISelectionContextMenuProvider"))}static Que(a,b,c){if(1===c)return 32;
if(!b.view.Lh)return 8;a=b.view;b=rd.SelectionFactory.rj(a.root.graphNode,!0);if(!b)return 8;a.Gb.setSelection(b);return 32}static Xrh(){if(!H.a.instance.ga(75))return 2;var a=Cb.App.Hb.Hd.nK;if(!a.Lh)return 2;if(a.Lh&&1!==Cb.App.Hb.state){Me.a.mark(4668);var b=a.Gb.Oa.kb;if(!b&&u.AFrameworkApplication.fa.ka("ContextMenuOnSelectionFixIsEnabled"))return 2;b=cb.SelectionEditor.Hha(b);let c=b.x,f=b.y+b.height;if(!a.container)return 8;a=Sys.UI.DomElement.getBounds(a.container);if(b.y<a.y||b.y>a.y+a.height||
b.x<a.x||b.x>a.x+a.width)c=a.x,f=a.y;Rr.qgb.B$(new Sys.UI.Point(c,f),1);Me.a.mark(4669)}return 32}}Rr.o2a=null;Object(e.a)(Rr,"SelectAllHandlers",null,[1113]);class jM extends Di.StandardDialog{constructor(a,b,c=null){super();this.yd=1;b?(b=CommonUIStrings.l_GoToClassicRibbonDialogMesage,this.IHd(CommonUIStrings.l_ToggleRibbonUXDialogTellUsWhy,c)):b=CommonUIStrings.l_GoToSingleLineRibbonDialogMessage;this.pCb(CommonUIStrings.l_ToggleRibbonUXDialogTitle,b,null,null,a,null)}}Object(e.a)(jM,"ToggleRibbonUXDialog",
Di.StandardDialog,[]);const HQ=()=>{const a=u.AFrameworkApplication.Ta;a.pa(F.a.wFk,xd.a.frame,FQ,101);a.ya(F.a.Tol,xd.a.frame,GQ)},GQ=(a,b,c)=>{if(1===c)return 32;if(b.contextId!==xd.a.frame)return 2;Z.ULS.sendTraceTag(25523336,340,50,"User opened the toggle Ribbon UX dialog from the {0}",u.AFrameworkApplication.Aa.jb.Up?"Single Line Ribbon":"Classic Ribbon");new jM(f=>{1===f&&u.AFrameworkApplication.Ta.processAction(F.a.Uyh,2)},u.AFrameworkApplication.Aa.jb.Up);return 32},FQ=(a,b,c,f,l)=>{l[ai.a.On]=
u.AFrameworkApplication.Aa.jb.Up;return 32};class pE{constructor(a){this.Hf=a}NKe(a,b){this.Hf.ZX(a,b.cache.eN);this.Hf.Jr(a,b.cache.fontSize)}yKe(){}X0d(){return null}YV(){return null}hRa(){return null}I7(){return null}urh(){return!1}}Object(e.a)(pE,"FormattingStewardBridge",null,[1106]);var kM=d(716),IQ=d(668);class lM{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){if(a)if(b)if(c)if(f)if(l)if(x)if(G){if(!R)throw Error.argumentNull("errorHandler");if(!fa)throw Error.argumentNull("sessionInfo");}else throw Error.argumentNull("graphActionBlockingManager");
else throw Error.argumentNull("graphTopologyManager");else throw Error.argumentNull("graphOperationEventSource");else throw Error.argumentNull("pptWorkspace");else throw Error.argumentNull("transactionFactory");else throw Error.argumentNull("pptSelectionManager");else throw Error.argumentNull("actionManager");this.ia=a;this.nb=b;this.Fb=c;this.kX=f;this.ks=l;this.ua=x;this.Xb=G;this.Md=R;this.Fe=fa;this.EEg=wa;this.jTg=Wa;this.rbb=mb}ub(){this.ia.pa(ba.a.B1h,sc.a.application,Object(C.a)(this,this.Clj,
"handleAddEditOrSetAsSlideTitle"),4);this.ia.pa(ba.a.editSlideTitle,sc.a.application,Object(C.a)(this,this.wjg,"handleEditSlideTitle"),4);this.ia.pa(ba.a.addSlideTitle,sc.a.application,Object(C.a)(this,this.djg,"handleAddSlideTitle"),4);this.ia.pa(ba.a.c2h,sc.a.application,Object(C.a)(this,this.Elj,"handleAddHiddenSlideTitle"),4);this.ia.pa(ba.a.setAsSlideTitle,sc.a.application,Object(C.a)(this,this.Akg,"handleSetAsSlideTitle"),4);this.ia.pa(ba.a.Jzk,sc.a.application,Object(C.a)(this,this.aoj,"handleHyperlinkText"),
4);this.ia.ya(ba.a.W_h,sc.a.application,Object(C.a)(this,this.Alj,"handleAccessibleAuthoringHelp"));this.ia.pa(ba.a.vBj,Bb.a.application,Object(C.a)(this,this.Okg,"handleUploadCaptionsDialog"),4);this.ia.pa(ba.a.wBj,Bb.a.application,Object(C.a)(this,this.Okg,"handleUploadCaptionsDialog"),4);this.ia.pa(ba.a.mPk,sc.a.application,Object(C.a)(this,this.Iqj,"handleRemoveAllCaptions"),4)}xe(){}YCa(){const a=this.nb.rn();return a?a.YCa():null}onShapeSelected(a,b){this.ks.Pfh(Object(C.a)(this,this.onShapeSelected,
"onShapeSelected"));b.shapeNode.q3?32!==this.ia.processAction(ba.a.ZUb,2)&&Aa.a.J(509724675,822,10,"Not able to begin edit shape text on title placeholder"):Aa.a.J(509724674,822,10,"After selecting title placeholder, the selected shape is not the title placeholder")}$kh(){const a=this.YCa();return a?(this.ks.GFf(Object(C.a)(this,this.onShapeSelected,"onShapeSelected")),this.nb.selectShape(a,!0),!0):!1}$ug(){const a=this.nb.nf();return!!a&&1===a.length&&!!this.YCa()}itg(){for(const a of this.nb.nf())if(a&&
!a.YCa())return!0;return!1}fzg(){var a=this.nb.Yd();if(1!==a.length)return!1;a=a[0];return!a.q3&&!a.Jf&&!a.Og&&!a.Pf&&a.hasText&&0<a.textLength()}Clj(a,b,c,f,l){if(1===c)return 32;var x=this.YCa();const G=this.nb.Yd(),R=1===G.length?G[0]:null;0<G.length&&R!==x?this.fzg()?(x=3,a=this.Akg(a,b,c,f,l)):(x=4,a=32):this.$ug()?(x=1,a=this.wjg(a,b,c,f,l)):this.itg()?(x=2,a=this.djg(a,b,c,f,l)):(Aa.a.J(509724673,822,10,"SlideTitle performed no action since none were enabled"),x=5,a=8);on.a("AddEditOrSetAsSlideTitle",
32===a,void 0,[Object.assign(new B.a,{name:"SubAction",int64:x})]);return a}wjg(a,b,c){return 1===c?this.$ug()?32:2:this.$kh()?32:8}ejg(a,b,c){if(1===b)return this.itg()?32:2;b=new Date;const f=this.Fb.ud(15,void 0,void 0,()=>{const l=this.nb.nf();if(l&&1===l.length){const x=new Date;let G=0;G=window.setInterval(()=>{this.$kh()?window.clearInterval(G):2E3<+new Date-+x&&(Aa.a.J(509724672,822,50,"AddSlideTitle or AddHiddenSlideTitle couldn't find title placeholder {0}ms after executing",2E3),window.clearInterval(G))},
100)}});try{Aa.a.J(509724643,822,50,"HandleAddSlideTitle called with isOffSlideTitle {0}",c);f.kc(this.kX.yf);f.fd=a;for(const l of this.nb.nf())l&&!l.YCa()&&(l.aEa=c)}finally{f&&f.dispose()}a=new Date;Aa.a.J(509724642,822,50,"HandleAddSlideTitle completed with isOffSlideTitle {0}",c);if(c=Nc.a.Eb)c.Om("AddSlideTitleStart",b),c.Om("AddSlideTitleEnd",a),c.Oj=!1,c.Kr=!0,Nc.a.Lea(c);return 32}djg(a,b,c){return this.ejg(a,c,!1)}Elj(a,b,c){return this.ejg(a,c,!0)}Akg(a,b,c){if(1===c)return this.fzg()?
32:2;c=this.nb.rn();const f=this.nb.Yd();if(1!==f.length)return Aa.a.J(509724641,822,10,"SetAsSlideTitle should only be enabled with 1 shape selected"),8;b=new Date;const l=this.Fb.ud(15);try{Aa.a.J(509724640,822,50,"HandleSetAsSlideTitle called for SlideId.Cid {0} with shapeId {1}",c.Bb.cid,f[0].get_shapeId()),l.kc(c),l.fd=a,c.kJa=f[0].get_shapeId()}finally{l&&l.dispose()}a=new Date;Aa.a.J(509724639,822,50,"HandleSetAsSlideTitle completed for SlideId.Cid {0} with shapeId {1}",c.Bb.cid,f[0].get_shapeId());
if(c=Nc.a.Eb)c.Om("SetAsSlideTitleStart",b),c.Om("SetAsSlideTitleEnd",a),c.Oj=!1,c.Kr=!0,Nc.a.Lea(c);32!==this.ia.processAction(ba.a.ZUb,2)&&Aa.a.J(509724638,822,10,"Not able to begin edit shape text after Set as Slide Title");return 32}aoj(a,b,c){return this.nb.a8()?this.ia.processAction(E.a.z3b,c):this.ia.processAction(ba.a.cCc,c)}Alj(a,b,c){if(1===c)return 32;a={};this.EEg&&(a.query="AssetID="+this.EEg);b={};b.CU=ResourceStrings.L_Help;b.assetId="FA000000012";b.nonPersistedSettings=a;return this.ia.La(ba.a.nJa,
2,b)}bKj(){if(!this.jTg)return!1;const a=this.nb.Yd();return 1!==a.length?!1:a[0].lQ}Okg(a,b,c){const f=this.ua.Ba;if(!f||this.Xb.Zc(f))return 8;if(1===c)return this.bKj()?32:2;b=Nc.a.Pl("Captions::Insert");try{return IQ.a.JOe(".vtt",kM.b,()=>kM.a(a,Object(C.a)(this,this.xBj,"insertCaptionsSuccessAfterUpload"),"captions",this.Fe,f),"captions",f,this.ua.presentation,this.Xb,this.Md,b,!1,this.rbb,50,10,3),b&&b.Wa("CaptionsDialogInitialized","true"),32}catch(l){Aa.a.J(509724637,818,10,"Error while rendering new captions selection dialog.")}b&&
(b.Wa("CaptionsDialogInitialized","false"),b.finish(),b=null);return 8}xBj(a,b,c,f,l,x,G){f.rN(c)&&Aa.a.J(509724636,822,15,"Captions::InsertCaptionsSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+c.Uha);f.GJ(c);l&&l.Wa("CaptionsUploadToRC","true");Object(re.a)("FixForInsertMediaSlideNavigationIssue")||(G=this.ua.Ba);if(G&&G.isConnected){x=x.files[0].name;f=c="";var R=x.split(".");2<=R.length&&(f=R[R.length-2]);sa.a.oe(f)||(c=x.lastIndexOf("."),c=0<=c?x.substring(0,
c):x,f="");x=this.nb.Yd();if(1===x.length){x=x[0];R=this.Fb.ud(15);try{R.kc(G),R.fd=a,l&&l.Wa("InsertCaptionsInProgress","true"),x.Upb=b,x.Spb=c,x.Tpb=f}finally{R&&R.dispose()}l&&(l.Wa("InsertCaptionsSuccessful","true"),l.finish())}}}jOj(){if(!this.jTg)return!1;const a=this.nb.Yd();return 1!==a.length?!1:a[0].lQ}Iqj(a,b,c){if(1===c)return this.jOj()?32:2;b=this.nb.Yd();if(1!==b.length)return 16;c=b[0];b=new Date;const f=this.Fb.ud(15);try{Aa.a.J(509724635,822,50,"RemoveAllCaptions started"),f.kc(this.kX.yf),
f.fd=a,c.Awb=!0}finally{f&&f.dispose()}a=new Date;Aa.a.J(509724634,822,50,"RemoveAllCaptions completed");if(c=Nc.a.Eb)c.Om("RemoveAllCaptionsStart",b),c.Om("RemoveAllCaptionsEnd",a),c.Oj=!1,c.Kr=!0,Nc.a.Lea(c);return 32}}Object(e.a)(lM,"AccessibleAuthoringActor",null,[229]);var JQ=d(135),KQ=d(168),LQ=d(179);class mM{constructor(a,b,c,f){this.A0c=!1;this.E8="";this.uzb=!1;this.yVa=null;this.fZc=-1;this.Azb=!1;this.bka=[];this.fc=b;this.la=c;this.$5c=f;a&&this.fc.ff(()=>{a.VH(Object(C.a)(this,this.iqk,
"onSelectionChangeFinished"))})}ub(){}xe(){}t1b(a,b,c){const f=[];for(const l of a)f.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:b,["controlId"]:l},c));return f}EOc(a){const b=[];for(let c=0;4>c;c++){const f={["type"]:"DropPreviewItemFromGallery",["controlId"]:a};let l=null;2>c&&(l=0);b.push(appChrome.actions.addScalingStepInTab("Home",f,l))}b.push(appChrome.actions.addScalingStepInTab("Home",{["type"]:"GalleryToFlyout",["controlId"]:a},null));return b}kfg(a){const b=[];let c=!1;if(a){switch(this.E8){case "FormatPicture":Array.addRange(b,
this.EOc("PictureStyles"));c=!0;break;case "Table":this.Azb||Array.addRange(b,this.EOc("TableStyles"));c=!0;break;case "SmartArtDesign":Array.addRange(b,this.EOc("ChangeSmartArtLayoutAnchor"));c=!0;break;case "Graphics":Array.addRange(b,this.EOc("GraphicsStylePreviewGallery"));c=!0;break;case "Audio":c=!0;break;case "FormatShape":Array.addRange(b,this.t1b(["InsertShapeTextBoxBig","AlternativeText"],"DropLabel",0)),Array.addRange(b,this.t1b(["InsertShapeTextBoxBig","AlternativeText"],"MoveToOverflow",
0)),Array.addRange(b,this.t1b(["SetWidth","SetHeight"],"MoveToOverflow",null))}c&&(a=null,this.Azb&&(a=0),Array.addRange(b,this.t1b(this.yVa,"DropLabel",a)),a=this.yVa.slice(0,this.yVa.length).reverse(),Array.addRange(b,this.t1b(a,"MoveToOverflow",null)))}else for(const f of this.yVa)b.push(appChrome.actions.removeControlScalingStepsFromTab(f,"Home"));return b}r_d(a){const b={};for(const c of a)try{b[c]=appChrome.selectors.getModelType(c)}catch(f){return this.EEa("Error","GetModelType failed for "+
c),null}return b}E_d(a){switch(a){case "FormatPicture":case "SmartArtDesign":case "Audio":case "Graphics":return["Font","Paragraph","Drawing"]}return[]}wKb(a){this.$5c&&(a=this.r_d(a))&&this.$5c(a)}$ul(a){if(a.length){if(this.$5c){var b=this.r_d(a);if(!b)return;var c=this.E_d(this.E8);if(0<c.length&&!this.uzb){for(var f of c)this.bka.push(appChrome.actions.updateGroupHiddenState(f,!0));this.uzb=!0}else if(this.uzb&&!c.length){c=[];f=this.E_d("FormatPicture");for(var l of f)this.bka.push(appChrome.actions.updateGroupHiddenState(l,
!1)),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup(l));if(l=this.r_d(c))for(let x in l)b[x]=l[x];this.uzb=!1}this.$5c(b)}this.yVa=a;b=[];for(const x of a)appChrome.selectors.isControlDisabled(x)&&b.push(x);0<b.length&&this.EEa("Disabled",b.join(","));0<this.yVa.length&&(this.bka.push(appChrome.actions.updateGroupHiddenState("Adaptive",!1)),this.bka.push(appChrome.actions.updateControlsInGroup("Adaptive",this.yVa)),Array.addRange(this.bka,this.kfg(!0)),this.A0c=!0)}}Ghh(a){""!==this.E8&&
this.E8!==a&&Array.addRange(this.bka,this.kfg(!1))}NUe(a,b){if(a||this.A0c)if(this.bka.push(appChrome.actions.updateGroupHiddenState("Adaptive",!a)),this.A0c=a,b=this.E_d(b),a&&0<b.length||this.uzb){for(var c of b)this.bka.push(appChrome.actions.updateGroupHiddenState(c,a));a||(c=appChrome.selectors.getVisibleControlsInGroup("Font"),Array.addRange(c,appChrome.selectors.getVisibleControlsInGroup("Paragraph")),this.wKb(c));this.uzb=a}}AZf(){0<this.bka.length&&(appChrome.api.dispatch(this.bka),this.bka=
[])}Mni(a,b){if(0>Array.indexOf(a,b)||"SmartArtDesign"===b&&(this.wKb(["SmartArtEditText"]),appChrome.selectors.getButtonToggleState("SmartArtEditText")))return!1;a=!1;if("Table"===b&&Yl.a.instance.kb){const c=!Yl.a.instance.kb.vl&&!Yl.a.instance.kb.RVc;if(a=(""===this.E8||this.E8===b)&&c!==this.Azb)this.Azb=c}a?this.Ghh("TableCellEdit"):this.Ghh(b);this.E8=b;return!0}b0k(){const a="Table FormatPicture SmartArtDesign Audio Graphics FormatShape".split(" ");let b=!1;const c=appChrome.selectors.getActiveContextualTabIds();
for(const f of a)if(this.Mni(c,f)){b=!0;break}return b?this.E8:""}t_i(){switch(this.E8){case "FormatPicture":return"ChangePictureFlyout ChangePicture ResetPicture PictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");case "Table":return this.Azb?["Select","TableDelete","TableInsert","TableAlignmentAnchor"]:"Select TableDelete TableInsert MergeTableCells SplitTableCells SetSizeAnchor TableDistribute TableAlignmentAnchor TableCellMarginAnchor ApplyTableStyleOptionAnchor TableStyles PowerPointCellShadingMenuOpen TableAlternativeText TableBordersMenuOpen TableBorderWidthAnchor SetCellBorderColor".split(" ");
case "SmartArtDesign":return"SmartArtEditText SmartArtPromote SmartArtDemote SmartArtReverse ChangeSmartArtLayoutAnchor ChangeSmartArtColorAnchor SmartArtStyles SmartArtResetGraphic AlternativeText SetWidth SetHeight".split(" ");case "FormatShape":return["SetWidth","SetHeight","InsertShapeTextBoxBig","AlternativeText"];case "Audio":return"AudioPlay AudioPause SetVolume StartAudio SetAudioOptions PlayInBackground NoAudioStyle ChangePictureFlyout ChangePicture ResetPicture AudioPictureStyles PictureBorders AlternativeText ArrangeAnchor PictureCropAnchor SetWidth SetHeight".split(" ");
case "Graphics":return"GraphicsStylePreviewGallery ChangeGraphicFlyout GraphicsFill GraphicsOutline AlternativeText ArrangeAnchor SetWidth SetHeight".split(" ")}return[]}iqk(a,b){if(!this.la.una&&"Home"===appChrome.selectors.getSelectedTabId()&&b.Xk&&b.Xk.kb&&b.Xk.length){var c=()=>{const f=this.E8;""===this.b0k()?this.NUe(!1,f):this.Azb||""===f||f!==this.E8?this.$ul(this.t_i()):this.A0c||(this.wKb(this.yVa),this.NUe(!0,this.E8));this.AZf()};-1!==this.fZc&&window.clearTimeout(this.fZc);this.fZc=window.setTimeout(()=>
{this.fZc=-1;let f=!1;try{window.self.requestIdleCallback(c)}catch(l){f=!0}f&&window.self.requestAnimationFrame(c)},250)}else this.NUe(!1,this.E8),this.AZf()}EEa(a,b){a={["Time"]:window.performance.now(),["Event"]:a,["Message"]:b,["Scenario"]:"AdaptiveTabGroup"};JQ.a.sendActivityEvent(Object.assign(new LQ.a,{name:"Office.TellMe.TellMeWAC.Events",dataFields:KQ.a.sD(a),durationMs:window.performance.now()}))}}Object(e.a)(mM,"AdaptiveTabGroupUpdaterActor",null,[229]);class nM extends It{constructor(a,
b){super(a);this.qZh=b;this.Qu=a}getAltText(a){return(a=this.CS(a))?a.get_altTitle():""}$$f(a){return(a=this.CS(a))?a.get_alt():""}BJd(a,b){if(1===a)if(this.hide(),a=this.CS(this.Qu)){const c=this.qZh.ke(15);c.kc(a);a.YYa=!1;a.set_altTitle(b[lq.DJd]);a.set_alt(b[lq.AJd]);c.dispose()}else Aa.a.J(17876899,822,10,"Try to set alternative text on a null shape.")}CS(a){let b;return(a=(a=Ni.b(a))?a.Gb:null)&&(b=a.Yd())&&1===b.length?b[0]:null}}Object(e.a)(nM,"ShapeAltTextDialog",It,[]);class oM{constructor(a,
b,c,f,l,x){this.Fb=l;this.ia=a;this.la=b;this.nb=f;this.O$a=c;this.Xb=x}ub(){this.la.qtg&&this.ia.pa(ba.a.cCc,Bb.a.view,Object(C.a)(this,this.o$h,"altTextDispatcher"),4)}xe(){}a_i(a){new nM(a,this.Fb)}o$h(a,b,c){if(a!==ba.a.cCc)return 16;a=this.nb.Yd();if(!a||1!==a.length||this.Xb.Zc(a[0]))return Aa.a.J(17876881,822,50,"No or multiple shapes selected or the selected shape is blocked. Disable the alternative text button."),16;if(1===c)return 32;Aa.a.J(17876883,822,50,"Begin setting the alternative text for shape.");
a[0].wk&&!a[0].get_isSVGBlipFilled()&&this.la.uSa?this.O$a.GIk():this.a_i(b);return 32}}Object(e.a)(oM,"AltTextActor",null,[229]);class pM{constructor(a,b,c,f,l,x,G,R){this.MD=null;this.ia=a;this.nb=b;this.Fa=c;this.Fb=f;this.x$a=l;this.hua=x;this.jc=R;this.x$a&&this.x$a.execute(fa=>{this.MD=fa})}ub(){this.ia.pa(ba.a.dLd,sc.a.application,Object(C.a)(this,this.gmj,"handleAudioPlay"),96);this.ia.pa(ba.a.KCc,sc.a.application,Object(C.a)(this,this.fmj,"handleAudioPause"),96);this.ia.pa(ba.a.tJf,sc.a.application,
Object(C.a)(this,this.Oci,"audioPlayPauseCommandHandler"),96);this.ia.pa(ba.a.H2k,sc.a.application,Object(C.a)(this,this.I2b,"handleSetAudioOptions"),96);this.ia.pa(ba.a.ncd,sc.a.application,Object(C.a)(this,this.ncd,"queryAudioOptions"),96);this.ia.pa(ba.a.playAcrossSlides,sc.a.application,Object(C.a)(this,this.I2b,"handleSetAudioOptions"),96);this.ia.pa(ba.a.Lcd,sc.a.application,Object(C.a)(this,this.Lcd,"queryPlayAcrossSlides"),96);this.ia.pa(ba.a.loopUntilStopped,sc.a.application,Object(C.a)(this,
this.I2b,"handleSetAudioOptions"),96);this.ia.pa(ba.a.Acd,sc.a.application,Object(C.a)(this,this.Acd,"queryLoopUntilStopped"),96);this.ia.pa(ba.a.hideDuringShow,sc.a.application,Object(C.a)(this,this.I2b,"handleSetAudioOptions"),96);this.ia.pa(ba.a.vcd,sc.a.application,Object(C.a)(this,this.vcd,"queryHideDuringShow"),96);this.ia.pa(ba.a.rewindAfterPlaying,sc.a.application,Object(C.a)(this,this.I2b,"handleSetAudioOptions"),96);this.ia.pa(ba.a.Qcd,sc.a.application,Object(C.a)(this,this.Qcd,"queryRewindAfterPlaying"),
96);this.ia.ya(ba.a.playInBackground,sc.a.application,Object(C.a)(this,this.Bkg,"handleSetAudioStyles"));this.ia.ya(ba.a.noAudioStyle,sc.a.application,Object(C.a)(this,this.Bkg,"handleSetAudioStyles"));this.ia.pa(ba.a.Mcd,sc.a.application,Object(C.a)(this,this.Mcd,"queryPlayInBackground"),96);this.ia.pa(ba.a.Dcd,sc.a.application,Object(C.a)(this,this.Dcd,"queryNoAudioStyle"),96);this.ia.pa(ba.a.setVolume,sc.a.application,Object(C.a)(this,this.J2b,"handleSetVolume"),96);this.ia.pa(ba.a.cMe,sc.a.application,
Object(C.a)(this,this.J2b,"handleSetVolume"),96);this.ia.pa(ba.a.Ucd,sc.a.application,Object(C.a)(this,this.Ucd,"querySetVolumeLow"),96);this.ia.pa(ba.a.dMe,sc.a.application,Object(C.a)(this,this.J2b,"handleSetVolume"),96);this.ia.pa(ba.a.Vcd,sc.a.application,Object(C.a)(this,this.Vcd,"querySetVolumeMedium"),96);this.ia.pa(ba.a.bMe,sc.a.application,Object(C.a)(this,this.J2b,"handleSetVolume"),96);this.ia.pa(ba.a.Tcd,sc.a.application,Object(C.a)(this,this.Tcd,"querySetVolumeHigh"),96);this.ia.pa(ba.a.eMe,
sc.a.application,Object(C.a)(this,this.J2b,"handleSetVolume"),96);this.ia.pa(ba.a.Wcd,sc.a.application,Object(C.a)(this,this.Wcd,"querySetVolumeMute"),96);this.ia.pa(ba.a.Ail,sc.a.application,Object(C.a)(this,this.Jrj,"handleStartAudio"),96);this.ia.pa(ba.a.qdd,sc.a.application,Object(C.a)(this,this.qdd,"queryStartAudio"),96)}xe(){}gmj(a,b,c,f,l){b=this.nb.Yd();if(1<b.length||!this.MD)return 16;const x=this.MD.FK(b[0]);if(!x||!x.isPlayerReady())return 16;if(1===c)return 32;let G=!1;l&&(G=!!l.ActionFromPlayer);
return Ag.b("AudioPlaybackOptionsActor::HandleAudioPlay ActionFromPlayer",G.toString(),a,()=>{x&&!G&&x.startPlaying();const R=[appChrome.actions.updateControlHiddenState("AudioPlay",!0),appChrome.actions.updateControlEnabledDisabledState("AudioPause",!1),appChrome.actions.updateControlHiddenState("AudioPause",!1)];appChrome.api.dispatch(R);return 32})}fmj(a,b,c,f,l){const x=this.nb.Yd();if(1<x.length||!this.MD)return 16;if(1===c)return 32;let G=!1;l&&(G=!!l.ActionFromPlayer);return Ag.b("AudioPlaybackOptionsActor::HandleAudioPause ActionFromPlayer",
G.toString(),a,()=>{var R=this.MD.FK(x[0]);R&&!G&&R.pause();R=[appChrome.actions.updateControlEnabledDisabledState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPlay",!1),appChrome.actions.updateControlHiddenState("AudioPause",!0)];appChrome.api.dispatch(R);return 32})}Oci(){var a=this.nb.aPc();if(!a||!this.MD)return 2;(a=this.MD.FK(a))&&!a.isPlayerFocused()&&(a.isAudioPlaying()?this.ia.processAction(ba.a.KCc,2):this.ia.processAction(ba.a.dLd,2));return 32}I2b(a,b,c,f,l){if(1===
c)return 32;if(!l)return Aa.a.J(512500762,822,10,"AudioPlaybackOptionsActor::HandleSetAudioOptions actionData is null"),8;const x=l.On;return Ag.b("AudioPlaybackOptionsActor::HandleSetAudioOptions audioOption: ",l.SqmControlId,a,()=>{const G=this.nb.og();if(G&&0<G.length){const R=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{R.kc(G[0]);for(const fa of G){if(!fa||!fa.media)continue;const wa=fa.media;switch(a){case ba.a.playAcrossSlides:wa.plyAcrssSldsField=x;break;case ba.a.loopUntilStopped:wa.repeatField=
x;break;case ba.a.hideDuringShow:wa.hideDrngShwField=x;break;case ba.a.rewindAfterPlaying:wa.rewindField=x}fa.media=wa;if(this.hua&&this.MD&&(a===ba.a.loopUntilStopped||a===ba.a.rewindAfterPlaying)){const Wa=this.MD.FK(fa);Wa&&(a===ba.a.loopUntilStopped?Wa.setRepeat(wa.repeatField):a===ba.a.rewindAfterPlaying&&Wa.setRewind(wa.rewindField))}}}finally{R&&R.dispose()}}return 32})}Bkg(a,b,c,f,l){return 1===c?32:l?Ag.b("AudioPlaybackOptionsActor::HandleSetAudioStyles",l.SourceControlId,a,()=>{const x=
this.nb.og();if(x&&0<x.length){const G=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{G.kc(x[0]);for(const R of x){if(!R||!R.media||R.Og)continue;const fa=R.media;switch(a){case ba.a.playInBackground:fa.plyAcrssSldsField=!0;fa.repeatField=!0;fa.hideDrngShwField=!0;fa.strtField=0;break;case ba.a.noAudioStyle:fa.plyAcrssSldsField=!1,fa.repeatField=!1,fa.hideDrngShwField=!1,fa.strtField=2}R.media=fa}}finally{G&&G.dispose()}}return 32}):(Aa.a.J(512500761,822,10,"AudioPlaybackOptionsActor::HandleSetAudioStyles actionData is null"),
8)}Jrj(a,b,c,f,l){if(1===c)return 32;if(!l)return Aa.a.J(512500760,822,10,"AudioPlaybackOptionsActor::HandleStartAudio actionData is null"),8;const x=l.CommandValueId;return Ag.b("AudioPlaybackOptionsActor::HandleStartAudio Start Option: ",x,a,()=>{if(!x||""===x.trim())return 32;const G=this.nb.og();if(G&&0<G.length){const R=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{R.kc(G[0]);for(const fa of G){if(!fa||!fa.media||fa.Og)continue;const wa=fa.media;wa.strtField="Automatically"===x?0:
2;fa.media=wa}}finally{R&&R.dispose()}}return 32})}Mcd(a,b,c,f,l){return this.swa(l,1)}Dcd(a,b,c,f,l){return this.swa(l,0)}J2b(a,b,c,f,l){return 1===c?32:l?Ag.b("AudioPlaybackOptionsActor::HandleSetVolume Volume: ",l.SourceControlId,a,()=>{const x=this.nb.og();if(x&&0<x.length){const G=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{G.kc(x[0]);for(const R of x){if(!R||!R.media)continue;const fa=R.media;switch(a){case ba.a.eMe:fa.mteField=!0;break;case ba.a.cMe:fa.vlmField=.2;fa.mteField=
!1;break;case ba.a.dMe:fa.vlmField=.5;fa.mteField=!1;break;case ba.a.bMe:fa.vlmField=.8,fa.mteField=!1}this.jc.WK&&(R.media=fa);const wa=l.ActionFromPlayer;if(this.hua&&this.MD&&!wa){const Wa=this.MD.FK(R);Wa&&(Wa.setMute(fa.mteField),Wa.setVolume(fa.vlmField))}}}finally{G&&G.dispose()}}return 32}):(Aa.a.J(512500759,822,10,"AudioPlaybackOptionsActor::HandleSetVolume actionData is null"),8)}Ucd(a,b,c,f,l){return this.swa(l,2)}Vcd(a,b,c,f,l){return this.swa(l,3)}Tcd(a,b,c,f,l){return this.swa(l,4)}Wcd(a,
b,c,f,l){return this.swa(l,5)}qdd(a,b,c,f,l){if(a=Object(ua.a)(Nh.a,l))c=this.nb.og(),b=this.$xg(c,2),c=this.$xg(c,0),b?(a.qZ=ResourceStrings.L_AudioStartWhenClickedOn,a.Qkc()):c&&(a.qZ=ResourceStrings.L_AudioStartAutomatically,a.Qkc());return 32}ncd(){this.ice()&&Cb.App.Hb.VF({PlayAcrossSlides:"CheckboxModel",LoopUntilStopped:"CheckboxModel",RewindAfterPlaying:"CheckboxModel",HideDuringShow:"CheckboxModel"});return 32}Lcd(a,b,c,f,l){return this.swa(l,6)}Acd(a,b,c,f,l){return this.swa(l,7)}vcd(a,
b,c,f,l){return this.swa(l,9)}Qcd(a,b,c,f,l){return this.swa(l,8)}HMi(a){return a.media.plyAcrssSldsField&&a.media.repeatField&&!a.media.strtField}GMi(a){return!a.media.plyAcrssSldsField&&!a.media.repeatField&&!!a.media.strtField}$xg(a,b){if(a&&0<a.length){for(const c of a)if(!c||!c.media||c.media.strtField!==b)return!1;return!0}return!1}swa(a,b){if(a=Object(ua.a)(Nh.a,a)){const c=this.nb.og();if(c&&0<c.length){let f=!1;for(const l of c)if(l&&l.media){switch(b){case 0:f=this.GMi(l);break;case 1:f=
this.HMi(l);break;case 5:f=l.media.mteField;break;case 2:f=!l.media.mteField&&.2>=l.media.vlmField;break;case 3:f=!l.media.mteField&&.2<l.media.vlmField&&.8>l.media.vlmField;break;case 4:f=!l.media.mteField&&.8<=l.media.vlmField;break;case 6:f=l.media.plyAcrssSldsField;break;case 7:f=l.media.repeatField;break;case 8:f=l.media.rewindField;break;case 9:f=l.media.hideDrngShwField;break;default:f=!1}if(!f)break}a.Nf(f)}}return 32}ice(){return!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up}}
Object(e.a)(pM,"AudioPlaybackOptionsActor",null,[229]);class qM{constructor(){this.type="AudioSettingsTaskPaneProps";this.hiddenSettings=this.onSubtitleLanguageUpdated=this.onSpokenLanguageUpdated=this.onSpeakersUpdated=this.onMicrophoneUpdated=this.availableSubtitleLanguages=this.availableSpokenLanguages=this.deviceSpeakers=this.deviceMicrophones=null;this.disableDeviceDropdown=!0;this.showDeviceErrorMessage=!1}}Object(e.a)(qM,"AudioSettingsTaskPaneProps",null,[]);class lu{constructor(){this.text=
this.key=null;this.itemType=0;this.selected=!1}}Object(e.a)(lu,"DropdownOption",null,[]);class rM{constructor(a,b,c,f,l){this.BL=null;this.DFa=this.Db=!1;a.loadScript("audio-settings-strings").then(()=>{this.DFa=!0;Aa.a.J(592447300,833,50,"audio-settings-strings loaded successfully")}).catch(x=>{Aa.a.J(592447298,833,10,"Failed to load audio-settings-strings "+x.toString())});this.ia=b;this.RD=f;this.Fc=c;this.IN=l}ub(){this.ia.ya(ba.a.TNe,sc.a.application,Object(C.a)(this,this.TNe,"showHideAudioSettingsPane"));
this.ia.pa(ba.a.pic,sc.a.application,Object(C.a)(this,this.pic,"queryShowHideAudioSettingsPane"),96)}xe(){}TNe(a,b,c){return b.contextId===sc.a.application&&this.DFa?1===c?32:Ag.a("AudioSettingsPaneToggle",a,()=>{(this.Db=!this.Db)?(this.Tl(),this.IN.U4h(Object(C.a)(this,this.ZYg,"onAudioDevicesChanged")),Aa.a.J(592447296,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane show")):(this.IN.XQk(Object(C.a)(this,this.ZYg,"onAudioDevicesChanged")),this.tK(),Aa.a.J(592447266,833,50,"AudioSettingsPaneActor::ShowHideAudioSettingsPane close"));
return 32}):2}pic(a,b,c,f,l){if(!Object(Ma.a)(Nh.a,l))return 8;l.Nf(this.Db);return 32}Tl(a=!1){a||this.YB();const b=Object.assign(new ju.a,{title:ResourceStrings.L_AudioSettings,hideHeader:!1,width:320,location:2,contentProps:this.BL,onOpen:()=>{},onClose:()=>{this.Db=!1},isModernPane:!0}),c=document.getElementById("AudioSettingsPaneFocus-panel");this.RD.T7(Yb.a.XNa,Yb.a.jj,c,()=>{this.jA(!0)},()=>{this.jA(!1)});Ej.UISurfaces.Ms().then(f=>{a?this.Db&&f.updateTaskPane(Yb.a.XNa,b):f.showTaskPane(Yb.a.XNa,
b);return null}).catch(f=>{Aa.a.J(592447264,833,10,"AudioSettingsPaneActor::ShowPane exception: {0}",f.toString())})}tK(){Ej.UISurfaces.Ms().then(a=>{a.hideTaskPane(Yb.a.XNa,2);return null}).catch(a=>{Aa.a.J(592447262,833,10,"AudioSettingsPaneActor::ClosePane exception: {0}",a.toString())})}YB(){this.BL=Object.assign(new qM,{deviceMicrophones:[],deviceSpeakers:[],availableSpokenLanguages:this.Zfj(),availableSubtitleLanguages:this.Kgj(),onMicrophoneUpdated:Object(C.a)(this,this.rxl,"updateMicrophone"),
onSpeakersUpdated:Object(C.a)(this,this.Hyl,"updateSpeaker"),onSpokenLanguageUpdated:Object(C.a)(this,this.Kyl,"updateSpokenLanguage"),onSubtitleLanguageUpdated:Object(C.a)(this,this.Qyl,"updateSubtitleLanguage"),hiddenSettings:["Speaker"],disableDeviceDropdown:!0,showDeviceErrorMessage:!1});this.IN.enumerateDevices(Object(C.a)(this,this.Cec,"onEnumerateDevicesSuccess"),Object(C.a)(this,this.IWa,"onDevicesFailure"),Object(C.a)(this,this.TWa,"onUnsupported"))}jA(a){const b=document.getElementById("TaskPaneCloseBtnAudioSettingsPaneFocus");
a&&b&&b.focus()}Cec(a){if(0!==a.length)if(Ka.a.Va(a[0].label))this.IN.requestPermission(Object(C.a)(this,this.Ipk,"onRequestPermissionSuccess"),Object(C.a)(this,this.IWa,"onDevicesFailure"),Object(C.a)(this,this.TWa,"onUnsupported")),Aa.a.J(592447260,833,50,"AudioSettingsPaneActor::OnEnumerateDevicesSuccess requesting device permission");else{var b=new Ha.a,c=new Ha.a;for(const f of a)Ka.a.Va(f.deviceId)||(a=Object.assign(new lu,{key:f.deviceId,text:Ka.a.Va(f.label)?f.deviceId:f.label}),"audiooutput"===
f.kind?c.add(a):"audioinput"===f.kind&&b.add(a));0<b.count&&(b.ga(0).selected=!0);0<c.count&&(c.ga(0).selected=!0);this.BL.deviceMicrophones=b.toArray();this.BL.deviceSpeakers=c.toArray();this.BL.disableDeviceDropdown=!1;this.BL.showDeviceErrorMessage=!1;this.Tl(!0)}}Ipk(){this.IN.enumerateDevices(Object(C.a)(this,this.Cec,"onEnumerateDevicesSuccess"),Object(C.a)(this,this.IWa,"onDevicesFailure"),Object(C.a)(this,this.TWa,"onUnsupported"));Aa.a.J(592447258,833,50,"AudioSettingsPaneActor::OnRequestPermissionSuccess successfully received permissions")}IWa(a){this.BL.disableDeviceDropdown=
!0;this.BL.showDeviceErrorMessage=!0;this.Tl(!0);Aa.a.J(592447256,833,10,"AudioSettingsPaneActor::OnDevicesFailure unable to get devices. Error: {0}",a.toString())}TWa(){this.BL.disableDeviceDropdown=!0;this.Tl(!0);Aa.a.J(592447254,833,10,"AudioSettingsPaneActor::OnDevicesUnsupported mediaDevices API not available for browser: {0}",r.a.zy)}rxl(a){this.IN.microphoneDeviceId=a.key;Aa.a.J(592447252,833,50,"AudioSettingsPaneActor::UpdateMicrophone user updated microphone")}Hyl(){Aa.a.J(592447250,833,
50,"AudioSettingsPaneActor::UpdateSpeaker user updated speaker")}ZYg(a,b){b.sek&&this.IN.enumerateDevices(Object(C.a)(this,this.Cec,"onEnumerateDevicesSuccess"),Object(C.a)(this,this.IWa,"onDevicesFailure"),Object(C.a)(this,this.TWa,"onUnsupported"))}Zfj(){const a=new Ha.a;for(let b of this.Fc.AQe)a.add(Object.assign(new lu,{key:b,text:sa.a.oe(b).displayName,selected:this.Fc.yna.toLowerCase()===b.toLowerCase()}));a.add(Object.assign(new lu,{key:"seperator",text:"-",itemType:1}));a.add(Object.assign(new lu,
{key:"header",text:ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle,itemType:2}));for(let b of this.Fc.zQe)a.add(Object.assign(new lu,{key:b,text:sa.a.oe(b).displayName,selected:this.Fc.yna.toLowerCase()===b.toLowerCase()}));return a.toArray()}Kgj(){const a=new Ha.a;for(let b of this.Fc.nPe)a.add(Object.assign(new lu,{key:b,text:sa.a.oe(b).displayName,selected:this.Fc.bya.toLowerCase()===b.toLowerCase()}));return a.toArray()}Kyl(a){this.Fc.yna=a.key;Aa.a.J(592447248,833,50,"AudioSettingsPaneActor::UpdateSpokenLanguage user updated spoken language")}Qyl(a){this.Fc.bya=
a.key;this.Fc.Eib=this.Fc.IPc();Aa.a.J(592447246,833,50,"AudioSettingsPaneActor::UpdateSpeaker user updated subtitle language")}}Object(e.a)(rM,"AudioSettingsPaneActor",null,[229]);class sM{constructor(){this.type="CaptionDiscoverabilityTaskPaneProps";this.podiumPresentationImageUrl=null;this.enableDoNotShowAgain=!1;this.onLaunchSlideShowButtonClicked=this.onDismissButtonClicked=this.onTurnOnButtonClicked=null}}Object(e.a)(sM,"CaptionDiscoverabilityTaskPaneProps",null,[]);class Qv{constructor(a,b,
c,f,l,x,G,R,fa,wa){this.WLg=!1;a.loadScript("powerpoint-discoverability-strings").then(()=>{this.WLg=!0;Aa.a.J(591971352,801,50,"powerpoint-discoverability-strings is loaded successfully")}).catch(Wa=>{Aa.a.J(591971350,801,10,"Failed to load powerpoint-discoverability-strings "+Wa.toString())});this.ia=b;this.Lc=c;this.uc=f;this.fe=l;this.RD=x;this.Fc=G;this.IN=R;this.w6j=wa;this.Y$j=fa;this.gRg=Pi.a.get("PPTCaptionDiscoverabilityLastShownTime")?!0:!1;this.o$b=!1;this.Lc.z3a(Object(C.a)(this,this.e$,
"onRibbonTabSwitched"))}dispose(){this.Lc.TFb(Object(C.a)(this,this.e$,"onRibbonTabSwitched"))}ub(){this.ia.ya(ba.a.dmc,sc.a.application,Object(C.a)(this,this.dmc,"showCaptionDiscoverabilityPane"))}xe(){}dmc(a,b,c){if(b.contextId!==sc.a.application||!this.WLg)return 2;if(1===c)return 32;if(Qv.yae||Qv.jUd||!this.uRi()||!this.tRi())return 8;this.o$b||this.Omi(a);return 32}Omi(a){Ag.a("CaptionDiscoverabilityPaneActor::CheckAudioAndShowPane",a,()=>{this.o$b=!0;this.IN.enumerateDevices(Object(C.a)(this,
this.Tjk,"onAudioInputAvailable"),Object(C.a)(this,this.IWa,"onDevicesFailure"),Object(C.a)(this,this.TWa,"onUnsupported"));return 32})}Tjk(a){if(a.length){for(const b of a)if("audioinput"===b.kind&&!this.Y$j.Twb()){Qv.yae=!0;this.Tl();break}this.o$b=!1}}IWa(a){this.o$b=!1;Aa.a.J(591538019,822,10,"CaptionDiscoverabilityPaneActor::OnDevicesFailure exception: {0}",a.toString())}TWa(){this.o$b=!1;Aa.a.J(591538017,822,15,"CaptionDiscoverabilityPaneActor::OnUnsupported mediaDevices API not available for browser: {0}",
r.a.zy)}Tl(){const a=this.YB(),b=Object.assign(new ju.a,{title:ResourceStrings.l_CaptionDiscoverabilityPane,hideHeader:!1,width:320,location:2,contentProps:a,onOpen:()=>{Aa.a.J(591538015,822,50,"CaptionDiscoverabilityPaneActor::ShowPane")},onClose:()=>{Aa.a.J(591738121,822,50,"CaptionDiscoverabilityPaneActor::ClosePane")},isModernPane:!0});this.RD.T7(Yb.a.k4a,Yb.a.jj,null,()=>{},()=>{});Ej.UISurfaces.Ms().then(c=>{c.showTaskPane(Yb.a.k4a,b);return null}).catch(c=>{Aa.a.J(591971348,822,10,"CaptionDiscoverabilityPaneActor::ShowPane exception: {0}",
c.toString())})}Ns(){Ej.UISurfaces.Ms().then(a=>{a.hideTaskPane(Yb.a.k4a,2);return null}).catch(a=>{Aa.a.J(591971346,822,10,"CaptionDiscoverabilityPaneActor::HidePane exception: {0}",a.toString())})}YB(){return Object.assign(new sM,{podiumPresentationImageUrl:this.fe.hk("CaptionDiscoverabilityPromptViewImage.png"),enableDoNotShowAgain:this.gRg,onTurnOnButtonClicked:Object(C.a)(this,this.onTurnOnButtonClicked,"onTurnOnButtonClicked"),onDismissButtonClicked:Object(C.a)(this,this.onDismissButtonClicked,
"onDismissButtonClicked"),onLaunchSlideShowButtonClicked:Object(C.a)(this,this.onLaunchSlideShowButtonClicked,"onLaunchSlideShowButtonClicked")})}onTurnOnButtonClicked(){Ag.a("CaptionDiscoverabilityPaneTurnOn",ba.a.OJb,()=>{let a=8;this.Fc.Kh||(a=this.ia.La(ba.a.OJb,2,{}));this.w6j&&8!==a||this.Ns();return a})}onDismissButtonClicked(){this.gRg&&(Qv.jUd=!0,Aa.a.J(591738117,822,50,"CaptionDiscoverabilityPaneActor::DoNotShowAgain"));this.Ns()}onLaunchSlideShowButtonClicked(){Ag.a("CaptionDiscoverabilityPaneLaunchSlideshow",
ba.a.Nmc,()=>{this.Ns();return this.ia.processAction(ba.a.Nmc,2)})}e$(a,b){2!==b.jv&&3!==b.jv&&4!==b.jv||!b.V9||"SlideShow"!==b.V9||Ag.a("OnRibbonTabSwitched",ba.a.dmc,()=>this.ia.processAction(ba.a.dmc,2))}tRi(){let a=0,b=!1,c=!1;for(var f of this.uc.cMc()){if(f.Rm){b=!0;break}if(f.CRa&&(a+=f.KP.length,4<=a))break;if(f.g8a){c=!0;break}}f=c||b||4<=a;Aa.a.J(591738113,822,50,"CaptionDiscoverabilityPaneActor::FMeetsIntentToPresent - Result: {0}; Animation Count: {1}; Hidden slide: {2}, Transition: {3}",
f.toString(),a.toString(),b.toString(),c.toString());return f}uRi(){return!this.Fc.Kh&&this.bRi()}bRi(){const a=sa.a.oe(u.AFrameworkApplication.lcid);return!a||Ka.a.Va(a.name)?!1:a.name.toLowerCase()===this.Fc.yna}static get yae(){var a=Pi.a.get("PPTCaptionDiscoverabilityLastShownTime");if(!a)return!1;const b=new Date;a=new Date(decodeURIComponent(a));return 14>(+b-+a)/864E5}static set yae(a){Pi.a.aM("PPTCaptionDiscoverabilityLastShownTime",(new Date).toUTCString(),Pi.a.JL)||Aa.a.J(591971344,822,
10,"Failed to set cookie for discoverability last shown time to {0}",a.toString())}static get jUd(){const a=Pi.a.get("PPTCaptionDiscoverabiltyDoNotShowAgain");return a?"true"===a.toLowerCase():!1}static set jUd(a){Pi.a.aM("PPTCaptionDiscoverabiltyDoNotShowAgain",a.toString(),Pi.a.JL)||Aa.a.J(591971342,822,10,"Failed to set cookie for discoverability opt out to {0}",a.toString())}}Object(e.a)(Qv,"CaptionDiscoverabilityPaneActor",null,[229]);var tM=d(714);class Ss{constructor(a,b){this.id=a;this.version=
b}}Object(e.a)(Ss,"PackageAccessKey",null,[]);const Rv=a=>a?Yd.c({["I"]:a.id,["V"]:a.version}):null;var Ap=d(324);class Px{constructor(a,b){this.lu=a;this.Sb=b}}Object(e.a)(Px,"ClipServiceCopyParams",null,[]);class Qx extends Px{constructor(a,b,c){super(a,b);this.A$=c}}Object(e.a)(Qx,"ClipServiceShapeCopyParams",Px,[]);class Zz extends Px{constructor(a,b,c){super(a,b);this.Gth=c}}Object(e.a)(Zz,"ClipServiceSlideCopyParams",Px,[]);var qE=d(698),rE=d(434);class Rx{constructor(a,b,c){this.ia=a;this.Fa=
b;this.gGa=c}NP(a){a=Rx.M0b(a);return this.gGa.v4b(this.Fa)&&!!a&&!!a.src}paste(a){u.AFrameworkApplication.mQ?rE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):this.ia.La(ba.a.bgc,2,a)}static M0b(a){if(!a||!a.$m)return Aa.a.J(558445148,826,15,"ImagePasteHandler: User attempted to paste null content."),null;a=a.$m.getElementsByTagName($e.a.R7);if(!a.length)return null;a=a[0];return a.src?a:null}}Object(e.a)(Rx,"ImagePasteHandler",null,[1166]);var Fm=d(422);class sE{constructor(){this.M8g=
this.uUd=null}}Object(e.a)(sE,"PasteSlideAsImageData",null,[]);class tE{constructor(){this.pastedContent=this.gwa=null}}Object(e.a)(tE,"PasteSlideAsImageFromRibbonData",null,[]);class $z extends Sys.EventArgs{constructor(){super()}}Object(e.a)($z,"SlidesChangedArgs",Sys.EventArgs,[]);class uE extends Sys.EventArgs{constructor(a,b,c){super();this.Np=a;this.Oli=b;this.Pli=c}}Object(e.a)(uE,"UpdateCcpInfoEventArgs",Sys.EventArgs,[]);class uM{constructor(){this.ShapeId=this.Cid=this.Sid=0}}Object(e.a)(uM,
"CopiedShape",null,[]);class vM{constructor(){this.Cid=this.Sid=0}}Object(e.a)(vM,"CopiedSlide",null,[]);class vE extends ff.a{constructor(){super();this.Shapes=this.Slides=this.Location=this.CcpId=null;this.MultiSlideCopy=!1;this.PackageAccessKey=this.CcpCorrelation=null}Ok(){return 65}}Object(e.a)(vE,"CopyRequest",ff.a,[]);class Sx{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg,Sf){this.Yne=this.wua=null;this.ia=a;this.gT=f;this.Fa=l;this.Xb=x;this.ua=G;this.Fb=
R;this.nL=Hc;this.pi=fa;this.Zb=wa;this.ax=Wa;this.ZEa=mb;this.Mb=Kb;this.ol=nc;this.la=b;this.ra=oc;this.bGg=Ic;this.m8j=ie;this.Je=Kc;this.Qb=He;this.n8j=fe;this.Dr=Te;this.Dpe=this.la.qyg;this.Xqe=this.la.Iih;this.ks=We;this.wc=Qf;this.qC=mg;this.tv=Xg;this.AOg=Mg;this.sQ=Sf;if(!this.qC)throw Aa.a.J(512356641,826,10,"ClipServiceActor pastemanager is null"),Error.argumentNull("ClipServiceActor pastemanager is null");}ub(){this.ia.pa(ba.a.qTf,sc.a.application,Object(C.a)(this,this.Umj,"handleCopySlidesToClipService"),
0);this.ia.pa(ba.a.Ead,sc.a.application,Object(C.a)(this,this.s5d,"handlePasteSlidesFromClipService"),4);this.ia.pa(ba.a.Fad,sc.a.application,Object(C.a)(this,this.ypj,"handlePasteSlideKeepingDestinationThemeFromFloatie"),4);this.ia.pa(ba.a.cgc,sc.a.application,Object(C.a)(this,this.zpj,"handlePasteSlideKeepingSourceFormattingFromFloatie"),4);this.ia.pa(ba.a.lFk,sc.a.application,Object(C.a)(this,this.Hcd,"queryPasteOptions"),97);this.ia.pa(ba.a.pTf,sc.a.application,Object(C.a)(this,this.Tmj,"handleCopyShapesToClipService"),
0);this.ia.pa(ba.a.V5g,sc.a.application,Object(C.a)(this,this.vpj,"handlePasteShapesFromClipService"),4);this.ia.pa(ba.a.X5g,sc.a.application,Object(C.a)(this,this.r5d,"handlePasteSlideFromDesktop"),4);this.ia.pa(ba.a.Dad,sc.a.application,Object(C.a)(this,this.wpj,"handlePasteSlideAsImage"),4);this.ia.pa(ba.a.W5g,sc.a.application,Object(C.a)(this,this.xpj,"handlePasteSlideAsImageFromRibbon"),4);this.ia.pa(ba.a.yWf,sc.a.application,Object(C.a)(this,this.Vmj,"handleCutShapes"),4);this.ia.pa(ba.a.mWd,
sc.a.application,Object(C.a)(this,this.mWd,"expandPasteFloatieMenu"),96);this.ia.pa(ba.a.zWf,Bb.a.application,Object(C.a)(this,this.Wmj,"handleCutSlides"),4);this.ia.pa(ba.a.$5g,Bb.a.application,Object(C.a)(this,this.opj,"handlePasteCancelledByUser"),2048)}xe(){}xpj(a,b,c,f,l){Aa.a.J(512356640,826,50,"HandlePasteSlideAsImageFromRibbon called");a=Object(ua.a)(tE,l);if(!a||!a.gwa)return Aa.a.J(512356639,826,10,"HandlePasteSlideAsImageFromRibbon pasteSlideAsImageFromRibbonData is invalid"),8;if(1===
c)return 32;c=a.gwa.Sb;b=this.wc.FO(2,1,"HandlePasteSlideAsImageFromRibbon");this.wc.Wh("PasteSlideAsImageFromRibbon",c,b);a.gwa.Sb=b;this.qC.paste(a.gwa,a.pastedContent,!0);return 32}wpj(a,b,c,f,l){a=Object(ua.a)(sE,l);if(!a||!a.uUd)return Aa.a.J(512356638,826,10,"HandlePasteSlideAsImage PasteSlideAsImageData is null"),8;if(1===c)return 32;this.qC.Dad(a.uUd,a.M8g);return 32}mWd(a,b,c){if(1===c)return 32;this.m8j.TGk();return 32}Hcd(a,b,c,f,l){if(!this.Dr||!this.Dr.teb)return 8;a=this.Dr.teb.kA;l.SourceControlId&&
("PasteSlideKeepDestinationFromClipService"===l.SourceControlId?l[ai.a.On]=null!=a&&!a:"PasteSlideKeepSourceFromClipService"===l.SourceControlId&&(l[ai.a.On]=null!=a&&a));return 32}zpj(a,b,c,f){if(1===c)return 32;const l=this.Dr.teb;if(!l)return 8;const x=l.lu,G=l.SL;if(!x&&!G)return 8;if(null!=l.kA&&l.kA)return 32;l.Sb=this.wc.FO(2,2,"HandlePasteSlideKeepingSourceFormattingFromFloatie");l.kA=!0;const R=this.Qb.CG(this.Dr.Uze);Aa.a.J(512356637,307,50,"HandlePasteSlideKeepingSourceFormattingFromFloatie - KeepSource set to true");
if(G)return G.skipUndo=!0,G.selectionSlide=R,this.r5d(a,b,c,f,l);x.skipUndo=!0;x.selectionSlide=R;return this.s5d(a,b,c,f,l)}ypj(a,b,c,f){if(1===c)return 32;const l=this.Dr.teb;if(!l)return 8;const x=l.lu,G=l.SL;if(!x&&!G)return 8;if(null!=l.kA&&!l.kA)return 32;l.Sb=this.wc.FO(2,2,"HandlePasteSlideKeepingDestinationThemeFromFloatie");l.kA=!1;const R=this.Qb.CG(this.Dr.Uze);Aa.a.J(512356636,307,50,"HandlePasteSlideKeepingDestinationThemeFromFloatie - KeepSource set to false");if(G)return G.skipUndo=
!0,G.selectionSlide=R,this.r5d(a,b,c,f,l);x.skipUndo=!0;x.selectionSlide=R;return this.s5d(a,b,c,f,l)}Tmj(a,b,c,f,l){a=Object(ua.a)(Qx,l);if(!a)return Aa.a.J(512356635,307,50,"ClipServiceCopyParams are null."),8;b=a.lu;c=a.A$;if(!b||!c||!c.length)return Aa.a.J(512356634,307,50,"Copied shapes are empty."),this.wc.Eg(!1,a.Sb,23),8;if(this.Xb.pSa())return this.wc.Eg(!1,a.Sb,2),16;if(Qa.a.any(c,G=>G.h3))return Aa.a.J(512356633,826,15,"HandleCopyShapesToClipService: deferred content detected."),8;f=[];
for(var x of c)f.push(Object.assign(new uM,{Sid:x.slideSid,Cid:x.slideCid,ShapeId:x.get_shapeId()}));x=Object.assign(new vE,{CcpId:b.Np,Location:b.location,Shapes:f,CcpCorrelation:a.Sb,PackageAccessKey:Rv(new Ss(a.lu.kz,b.version))});this.VJc(x,2,a.Sb);return 32}vpj(a,b,c,f,l){b=Object(ua.a)(Fm.a,l);if(!b)return 8;3!==b.lu.dataType?this.wc.oB(2,b.Sb):(this.wc.oB(7,b.Sb),this.wc.vw(5,b.Sb));c=b.lu;if(!c)return this.wc.Eg(!1,b.Sb,16),Aa.a.J(512356632,307,50,"HandlePasteShapesFromClipService: Cross-session pasted shapes are empty."),
8;3!==b.lu.dataType&&this.wc.vw(qE.ClipboardHelper.bug(c)?2:3,b.Sb);f=this.ua.Ba;if(!f||!f.isConnected)return this.wc.Eg(!1,b.Sb,3),Aa.a.J(512356631,307,50,"HandlePasteShapesFromClipService: targetSlide: {0}.",f?"not null":"null"),16;if(this.Xb.Zc(f))return this.wc.Eg(!1,b.Sb,3),Aa.a.J(512356630,307,50,"HandlePasteShapesFromClipService: failed since the targetSlide is blocked."),2;if(!this.ol.yI(f,c.objectCount))return this.wc.Eg(!1,b.Sb,8),Aa.a.J(512356629,307,50,"HandlePasteShapesFromClipService: failed since there are too many shapes on the target slide."),
this.ol.AJ(f),16;this.sHd(c.Np,b.Sb);Nc.a.gya("PasteShapesFromClipService",!0);Nc.a.LO(!1,!1);this.Yne&&this.Yne===c.Np||(this.wua=new ef.a(0));f.QM=c.Np;f.xP=c.location;f.h2=c.BE;f.mZ=Sx.wSe(c.wra);f.kz=Rv(new Ss(c.kz,c.version));l=null;this.wc.S5b(b.Sb)&&(l=Rx.M0b(b));if(this.Xqe&&3===b.lu.dataType)try{let x=0;this.wua&&this.wua.Jb(f.Bb)&&(x=this.wua.ga(f.Bb));this.Xb.ILd(f,a,x);Aa.a.J(512356628,307,50,"HandlePasteShapesFromClipService: shimmer view successful")}catch(x){Aa.a.J(512356627,307,10,
"HandlePasteShapesFromClipService: failed to show shimmer view")}this.ZEa.lEi(f,c,this.wua,a,b.Sb,l);this.Yne=c.Np;this.wc.Eg(!0,b.Sb);return 32}Vmj(a,b,c,f,l){if(this.Xb.pSa())return 16;if(1===c)return 32;Nc.a.LO(!0,!0);const x=this.ra.og();b=this.ra.rn();var G=f=c=null;let R=[];l=Object(ua.a)(Qx,l);if(!l)return 8;if(l.lu){var fa=l.lu;R=l.A$;if(!R||!R.length)return 8;c=fa.Np;G=fa.version;f=fa.location;G=Rv(new Ss(fa.kz,G))}else for(fa of x)fa.NVc&&R.push(fa);for(var wa of R)if(wa.Jf||wa.Og){Qn(wa);
break}wa=this.Fb.ud(15,void 0,()=>{this.ra.Uh()});try{wa.kc(b),wa.fd=a,this.bGg.Qbh(new uE(c,f,G)),b.Sb=l.Sb,b.gU(R)}finally{wa&&wa.dispose()}for(const Wa of R)this.ks.ybh(new OJ.a(Wa));this.gT.zde=c;return 32}Wmj(a,b,c,f,l){b=this.ra.nf();if(!b||!b.length||!this.ua.Ba)return 16;for(var x of b)if(!x||this.Xb.Zc(x)||!x.isConnected)return 16;if(1===c)return 32;Nc.a.Eb&&(Nc.a.Eb.actionName="CutSlide",Nc.a.Eb.Kr=!1,Nc.a.Eb.Oj=!0,Nc.a.Eb.WE=new Date,Nc.a.Eb.Wa("SlideCount",b.length.toString()));f=x=c=
null;var G=[];l=Object(ua.a)(Zz,l);if(!l)return 8;if(l.lu){f=l.lu;G=l.Gth;if(!G||!G.length)return 8;c=f.Np;G=f.version;x=f.location;f=Rv(new Ss(f.kz,G))}G=this.Zb.yf;if(!G)return 16;const R=this.Fb.ud(15,void 0,()=>{this.ra.Uh()});try{this.bGg.Qbh(new uE(c,x,f));R.kc(G);for(const fa of b)fa&&!fa.Bb.equals(this.ua.Ba.Bb)&&G.WM(fa);G.WM(this.ua.Ba);R.fd=a;G.Sb=l.Sb}finally{R&&R.dispose()}this.la.unblockContentWhenDeletingSlideEnabled||this.Xb.Jw(G,a);this.ks?this.ks.uEe(new $z(b)):Aa.a.J(512356626,
826,10,"HandleCutSlides: graphOperationEventNotifier is null for raising event.");this.gT.zde=c;return 32}VJc(a,b){this.gT.$jk(a);var c=[String.format("{0}={1}","CcpId",a.CcpId),String.format("{0}={1}",Ap.a.type,tM.a(b))];Nc.a.qk("CcpId",a.CcpId);c=new Xj.a(a,()=>{this.flk(a)},f=>this.elk(f,a,b),f=>0===f.StatusCode,void 0,c);Aa.a.J(512356625,307,50,String.format("Created task: {0} for ccpid: {1}",c.id,a.CcpId));this.pi.Cb(c)}flk(a){this.gT.CYg(!0,a)}elk(a,b,c){Aa.a.J(512356624,307,10,String.format("Failed to copy {0} for ccpid: {1} with statuscode: {2}.",
tM.a(c),b.CcpId,a.StatusCode));this.gT.CYg(!1,b);return!0}sHd(a,b){const c=Nc.a.Eb;c&&(c.Wa("CcpId",a),this.wc.Wh("CcpId",a,b))}Umj(a,b,c,f,l){a=Object(ua.a)(Zz,l);if(!a||!a.lu)return Aa.a.J(512356623,307,50,"HandleCopySlidesToClipService: either copyParams '{0}' or copyParams.ClipServiceObject is null.",a?"not null":"null"),8;Aa.a.J(512356622,307,50,"HandleCopySlidesToClipService: executing for ccpid: {0}",a.lu.Np);b=a.Gth;if(!b||!b.length||0>=aj.e(b,x=>Object(Ma.a)(120,x)).length)return Aa.a.J(512356621,
307,50,"HandleCopySlidesToClipService: no slide is copied"),8;if(Qa.a.any(b,x=>x.hasDeferredContent))return Aa.a.J(512356620,826,15,"HandleCopySlidesToClipService: trying to copy slides with deferred content to clipboard service"),8;b=Object.assign(new vE,{CcpId:a.lu.Np,Location:a.lu.location,MultiSlideCopy:!0,Slides:aj.c(b,x=>Object.assign(new vM,{Sid:x.sid,Cid:x.cid})),CcpCorrelation:a.Sb,PackageAccessKey:Rv(new Ss(a.lu.kz,a.lu.version))});this.VJc(b,1,a.Sb);return 32}r5d(a,b,c,f,l){if(1===c)return 32;
b=Object(ua.a)(Fm.a,l);if(!b)return Aa.a.J(512356619,826,10,"HandlePasteSlideFromDesktop: PasteParams is null."),8;c=b.SL;if(!c||Ka.a.Va(c.ccpid)||Ka.a.Va(c.data))return Aa.a.J(512356618,826,10,String.format("HandlePasteSlideFromDesktop: Invalid pickling data ccpid: {0}",c?c.ccpid:"null")),this.wc.Eg(!1,b.Sb,28),8;Nc.a.gya("PasteSlideFromDesktop",!0);this.sHd(c.ccpid,b.Sb);this.wc.vw(12,b.Sb);f={};f.CcpCorrId=b.Sb;return this.gkg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.kA?b.kA:!0,c.ccpid,
null,null,u.AFrameworkApplication.userSessionId,0,f,c.data,c.isDataCompressed)}s5d(a,b,c,f,l){if(1===c)return 32;b=Object(ua.a)(Fm.a,l);if(!b)return Aa.a.J(51520671,307,10,"HandlePasteSlidesFromClipService: PasteParams is null."),8;Nc.a.gya("PasteSlidesFromClipService",!0);c=b.lu;if(!c)return this.wc.Eg(!1,b.Sb,16),Aa.a.J(512356617,307,10,"HandlePasteSlidesFromClipService: Cross-session pasted slides are empty."),8;this.wc.vw(qE.ClipboardHelper.bug(c)?2:3,b.Sb);this.sHd(c.Np,b.Sb);f=this.ax.z$d(c);
return!this.la.lyg&&f?(this.wc.Eg(!1,b.Sb,17),Aa.a.J(34481168,307,10,"HandlePasteSlidesFromClipService: Don't support cross-dc paste slide: {0}",c),16):this.gkg(b,a,c.skipUndo,c.selectionSlide,c.objectCount,null!=b.kA?b.kA:!0,c.Np,c.location,c.BE,c.kz,c.version,c.wra,null,!1)}gkg(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){this.wc.oB(19,a.Sb);const oc=this.ua.presentation;if(!oc)return this.wc.Eg(!1,a.Sb,3),Aa.a.J(512356616,307,10,"HandlePasteSlide: Failed because presentation node is null"),16;if(this.Xb.Zc(oc))return this.wc.Eg(!1,
a.Sb,3),Aa.a.J(512356615,307,10,"HandlePasteSlide: Can't continue because the presentation was being blocked."),2;var Ic=this.ua.Ba;if(Ic&&!Ic.isConnected)return this.wc.Eg(!1,a.Sb,3),Aa.a.J(512356614,307,10,"HandlePasteSlide: Failed since the selected slide is disconnected."),16;Aa.a.J(512356613,307,50,String.format("HandlePasteSlide skipUndo: {0} and keepSource value is: {1}",c.toString(),x.toString()));this.Dpe&&!this.ax.Ltg(a)&&this.n8j.A3h();this.Dr.NWc=Date.now();this.nL.kW(this.Qb.Gn)&&Aa.a.J(512356612,
307,50,"cross session paste slide happened before last action server result is not returned");Nc.a.LO(!1,!1);let Kc;var Hc=null;Ic=this.la.Tjd&&!Ka.a.Va(Kb)&&1!==this.Mb.Xo;if(c)Hc=f,Kc=null;else{Hc=this.ua.presentation;if(!Hc)throw Error.argumentNull("Presentation is null");Kc=Array.isArray(Hc.xVf(l,a.Sb,Ic))?Hc.xVf(l,a.Sb,Ic):null;f=Hc=this.Uaj();this.Dr.position=null;this.Dr.Uze=Hc?Hc.slideIndex:0}l=null;c||(l=()=>{let ie;(ie=this.ra).bY.apply(ie,Kc)});l=this.Fb.ud(15,void 0,()=>{this.Fa.Bf(Yb.a.vE)},
l);try{if(l.kc(oc),l.fd=c?oc.P9a?ba.a.cgc:ba.a.Fad:b,Ic?(oc.Nsa=!0,this.tv.init(G)):(oc.QM=G,oc.P9a=x,oc.Sze=Hc?Hc.Bb:null,oc.xP=R,oc.h2=fa,oc.mZ=Sx.wSe(mb),oc.skipUndo=c,oc.kz=Rv(new Ss(wa,Wa)),oc.twb=null==nc?!1:nc,oc.dgc=Kb,oc.Sb=a.Sb),!c){R=Hc;for(fa=0;fa<Kc.length;fa++)oc.nvb(Kc[fa],R,null),R=Kc[fa],Ic&&(Kc[fa].Nsa=!0,this.tv.bja.add(Kc[fa].id));this.Zb.Ba=Kc[Kc.length-1];this.Je.L5a=!0}}finally{l&&l.dispose()}Ic?(this.tv.xnd(!0),this.Xb.blockContent(oc,b)):this.Xb.Jw(oc,b);this.Dr.teb=a;this.Dr.qhb=
!0;this.Dr.OHa=null;this.Je.L5a=!0;this.Dr.hYb=this.Qb.Gn.CJ;Ic&&(this.wc.Wh("DisplayNewPasteProgressUX","true",a.Sb),this.mFi(Kb,u.AFrameworkApplication.userSessionId,Hc,c,x,G,mb,nc,a.Sb));this.wc.Eg(!0,a.Sb);return 32}mFi(a,b,c,f,l,x,G,R,fa){const wa=this.wc.FO(2,0,"DataUploadInit");this.wc.vw(13,wa);this.wc.oB(19,wa);this.wc.Wh("DataUploadInitOldCcpCorrId",fa,wa);this.tv.Dvl(wa);const Wa=(new Date).getTime();this.AOg.jjl(a,b,x,()=>{const mb=(new Date).getTime()-Wa;Aa.a.J(512356611,826,50,"DataUploadInit: Upload pasted data successful for ccpid: {0} time: {1}",
x,mb);this.wc.Wh("DataUploadTime",mb.toString(),wa);this.lFi(wa,b,c,f,l,x,G,R)},mb=>{Aa.a.J(512356610,826,10,"DataUploadInit: Upload pasted data failed for ccpid: {0}, error:{1} time: {2}",x,gl.a[mb.error.Code],(new Date).getTime()-Wa);this.Xmj();this.wc.Eg(!1,wa,30)})}lFi(a,b,c,f,l,x,G,R){const fa=this.ua.presentation;if(fa){this.tv.fik();Nc.a.LO(!1,!1);Aa.a.J(512356608,307,50,"DataUploadFinish: FakeSlideIds: {0}",this.tv.bja.toArray().join(",").toString());var wa=this.Fb.ud(15);try{wa.kc(fa),wa.fd=
ba.a.cgc,fa.Sze=c?c.Bb:null,fa.hWb=b,fa.egc=this.tv.bja.toArray().join(",").toString(),fa.QM=x,fa.mZ=Sx.wSe(G),fa.skipUndo=f,fa.twb=null==R?!1:R,fa.P9a=l,fa.Sb=a}finally{wa&&wa.dispose()}this.wc.Eg(!0,a)}else Aa.a.J(512356609,307,10,"DataUploadFinish: Failed because presentation node is null")}opj(a,b,c,f,l){if(1===c)return 32;if(!(l&&"UploadId"in l&&"CcpCorrId"in l))return Aa.a.J(512356579,307,10,"HandlePasteCancelledByUser: actionDataDictionary invalid {0}",l),8;a=l.UploadId;l=l.CcpCorrId;Aa.a.J(512356578,
307,50,"HandlePasteCancelledByUser: uploadId: {0}",a);this.AOg.yli(a);this.wc.Eg(!1,l,31);return 32}Xmj(){this.tv.VNf(!0);this.sQ.nxa(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,20)}vhl(a){a.sort((b,c)=>c.slideIndex-b.slideIndex)}Uaj(){const a=this.ra.nf();return 0<a.length&&(this.vhl(a),a[0])?a[0]:this.ua.Ba}static wSe(a){return JSON.stringify(a)}}Object(e.a)(Sx,"ClipServiceActor",null,[229]);class wE{constructor(){this.actionId=
0;this.context=null;this.behavior=0;this.kd=this.rJ=null}}Object(e.a)(wE,"AActionArgs",null,[]);class xE extends wE{constructor(){super()}}Object(e.a)(xE,"ActionArgs$2",wE,[]);class yE extends xE{constructor(){super()}}Object(e.a)(yE,"ActionArgs$1",xE,[]);var Dq=d(453),mu=d(375);class Ts{constructor(a,b=!1){this.sug=!0;this.Sb=null;this.dataType=0;this.rRi=a;this.Psa=b}}Object(e.a)(Ts,"CutCopyParams",null,[]);var Sv=d(433),wM=d(528);class aA{constructor(a,b,c,f){this.ia=a;this.F6j=f;this.gGa=c;this.Fa=
b}NP(a){return this.gGa.v4b(this.Fa)&&!!aA.Xag(a)}paste(a){this.F6j?rE.a(ResourceStrings.l_GenericDialogTitle,CommonUIStrings.l_NeedToSignIn,null):(Aa.a.J(17310402,826,50,"TablePasteHandler: Execute command to paste table from clipboard."),this.ia.La(ba.a.hwa,2,a))}static Xag(a){return a&&a.$m?(a=a.$m.getElementsByTagName($e.a.uJb))&&a.length?a[0]:null:null}}Object(e.a)(aA,"TablePasteHandler",null,[1166]);class Lk{static get nA(){return fb.a.instance.qb("PowerPointWebEditor.ISystemClipboard")}}Object(e.a)(Lk,
"SystemClipboardFactory",null,[]);class xM{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg){this.wua=this.A1c=null;this.yHg=0;if(!Mg)throw Error.argumentNull("DeferredContentManager");this.ia=a;this.Fa=b;this.ra=c;this.kh=Kb;this.Xb=wa;this.xka=Wa;this.qC=mb;this.Zb=f;this.$p=l;this.gw=Mg;this.Fb=x;this.Sz=G;this.Aq=fa;this.ZEa=nc;this.Qb=oc;this.Dm=Ic;this.Mb=Kc;this.XGg=Hc;this.G$a=ie;this.ol=He;this.hT=fe;this.AUa=We;this.yb=Qf;this.W8=mg;this.wc=Xg;this.la=
R}ub(){this.la.gTc?(this.ia.pa(ba.a.drb,sc.a.application,Object(C.a)(this,this.sjg,"handleCutCopyToSystemClipboardAsync"),4),this.ia.pa(ba.a.oXb,sc.a.application,Object(C.a)(this,this.sjg,"handleCutCopyToSystemClipboardAsync"),0),this.ia.pa(ba.a.$fc,sc.a.application,Object(C.a)(this,this.qQc,"handlePasteFromSystemClipboardAsync"),4),this.ia.pa(ba.a.reb,sc.a.application,Object(C.a)(this,this.qQc,"handlePasteFromSystemClipboardAsync"),4),this.ia.pa(ba.a.seb,sc.a.application,Object(C.a)(this,this.qQc,
"handlePasteFromSystemClipboardAsync"),4),this.ia.pa(ba.a.jEb,sc.a.application,Object(C.a)(this,this.qQc,"handlePasteFromSystemClipboardAsync"),4)):(this.ia.pa(ba.a.drb,sc.a.application,Object(C.a)(this,this.rjg,"handleCutCopyToSystemClipboard"),4),this.ia.pa(ba.a.oXb,sc.a.application,Object(C.a)(this,this.rjg,"handleCutCopyToSystemClipboard"),0),this.ia.pa(ba.a.$fc,sc.a.application,Object(C.a)(this,this.pQc,"handlePasteFromSystemClipboard"),4),this.ia.pa(ba.a.reb,sc.a.application,Object(C.a)(this,
this.pQc,"handlePasteFromSystemClipboard"),4),this.ia.pa(ba.a.seb,sc.a.application,Object(C.a)(this,this.pQc,"handlePasteFromSystemClipboard"),4),this.ia.pa(ba.a.jEb,sc.a.application,Object(C.a)(this,this.pQc,"handlePasteFromSystemClipboard"),4));this.ia.pa(ba.a.oTf,sc.a.application,Object(C.a)(this,this.Smj,"handleCopyShapes"),0);this.ia.pa(ba.a.Bad,Bb.a.application,Object(C.a)(this,this.upj,"handlePasteShapes"),4);this.ia.pa(ba.a.bgc,sc.a.application,Object(C.a)(this,this.tpj,"handlePastePicture"),
4);this.ia.pa(ba.a.hwa,Bb.a.application,Object(C.a)(this,this.Bpj,"handlePasteTable"),4);this.ia.pa(ba.a.Cad,sc.a.application,Object(C.a)(this,this.Apj,"handlePasteSlides"),4);this.ia.pa(ba.a.Xze,sc.a.application,Object(C.a)(this,this.Cpj,"handlePasteTextIntoNewShape"),4);this.ia.qV(ba.a.C7g,sc.a.application,Object(C.a)(this,this.pmj,"handleBrowserCut"),4);this.ia.qV(ba.a.rbd,sc.a.application,Object(C.a)(this,this.omj,"handleBrowserCopy"),0);this.ia.qV(ba.a.sbd,sc.a.application,Object(C.a)(this,this.qmj,
"handleBrowserPaste"),4);this.ia.qV(ba.a.K7g,sc.a.application,Object(C.a)(this,this.rpj,"handlePasteGivenText"),4);this.ia.pa(ba.a.I5g,sc.a.application,Object(C.a)(this,this.qpj,"handlePasteContentFromPandora"),4);this.ia.pa(ba.a.LHa,Bb.a.application,Object(C.a)(this,this.handlePasteHtml,"handlePasteHtml"),4);this.ia.pa(ba.a.zad,Bb.a.application,Object(C.a)(this,this.spj,"handlePasteHtmlAsync"),4);this.ia.pa(ba.a.vQd,xd.a.frame,Object(C.a)(this,this.ppj,"handlePasteChartAsImage"),4);this.ia.ya(ba.a.BSd,
xd.a.frame,Object(C.a)(this,this.qjg,"handleCutCopyThroughShortcuts"));this.ia.ya(ba.a.sTf,xd.a.frame,Object(C.a)(this,this.qjg,"handleCutCopyThroughShortcuts"));this.ia.pa(ba.a.Z5g,xd.a.frame,Object(C.a)(this,this.Dpj,"handlePasteThroughShortcuts"),4)}xe(){if(re.a("ShortcutsFixInMac")&&r.a.W5b){const a=[this.Fa.Dc(zi.a.oD),this.Fa.Dc(Yb.a.Bg)];for(const b of a)b.bindAction(A.KeyInputManager.Na(w.a.sya,A.KeyInputManager.He),ba.a.sTf),b.bindAction(A.KeyInputManager.Na(w.a.p_a,A.KeyInputManager.He),
ba.a.Z5g)}}qjg(a){a=ba.a.BSd===a;const b=this.wc.FO(a?1:0,0,a?"OnBrowserCut":"OnBrowserCopy");this.xka.jra(Object.assign(new Ts(!1,a),{Sb:b}));return 32}Dpj(){const a=this.wc.FO(2,0,"OnBrowserPaste");this.qC.paste(Object.assign(new Fm.a(!0),{Sb:a}),null,!1);return 32}sjg(a,b,c,f){let l,x;if(!({XE:l,sHc:x}=this.LSf(c,a)).returnValue)return l;if(!Lk.nA)return this.wc.Eg(!1,x.Sb,1),8;this.Qba(a,b,c,f,!0,x.Sb);return 32}qQc(a,b,c,f){if(1===c)return this.ra.kSa()?2:a===ba.a.reb?2:a===ba.a.seb?this.Mlc(!1):
a===ba.a.jEb?this.Mlc(!0):32;const l=this.wc.FO(2,1,"HandlePasteFromSystemClipboardAsync");if(this.ra.h8())return this.wc.Eg(!1,l,3),16;if(!Lk.nA)return this.wc.Eg(!1,l,1),8;this.Qba(a,b,c,f,!1,l);Nc.a.LO(!0,!1);return 32}Mlc(a){Aa.a.J(512356577,826,50,"ShouldEnablePasteAsOptions called");return this.ra.a8()?(Aa.a.J(512356576,826,15,"ShouldEnablePasteAsOptions: inside textbox hence disabled"),2):this.qC.Kmi(a)?32:2}RZf(a,b){a===ba.a.drb?this.xka.jra(Object.assign(new Ts(!1,!0),{Sb:b})):a===ba.a.oXb?
this.xka.jra(Object.assign(new Ts(!1),{Sb:b})):a===ba.a.$fc?this.qC.paste(Object.assign(new Fm.a(!1),{Sb:b}),null,!1):a===ba.a.reb?this.qC.paste(Object.assign(new Fm.a(!1),{Sb:b,kA:!1}),null,!1):a===ba.a.seb?this.qC.paste(Object.assign(new Fm.a(!1),{Sb:b,kA:!0}),null,!1):a===ba.a.jEb?this.qC.paste(Object.assign(new Fm.a(!1),{Sb:b,a6a:!0}),null,!1):(Aa.a.J(512356575,826,50,"Only Copy or Paste command are accepted."),this.wc.Eg(!1,b,5))}Qba(a,b,c,f,l,x){Lk.nA.Qba(l);l=Lk.nA.d5;null!=l&&l?this.RZf(a,
x):(a=new hd.a(null,Object(C.a)(this,this.HWe,"waitingForEnsureAccessOperationResult"),Object.assign(new yE,{actionId:a,context:b,behavior:c,rJ:f,kd:x})),a.Fl("ClipboardPreProcess"),this.yHg=Date.now(),a.run())}HWe(a,b){a=!0;let c=!1;const f=b.kd.toString(),l=Lk.nA.d5,x=Lk.nA.Px;null!=l?(a=!1,l?this.RZf(b.actionId,f):c=!0):Date.now()-this.yHg>this.la.mPf&&null!=x&&(Aa.a.J(512356574,826,15,"Timeout while trying to execute SystemClipboardAccessManager.EnsureSystemClipboardAccess method."),a=!1,c=!0);
c&&this.wc.Eg(!1,f,29);return a}rjg(a,b,c){if(!({XE:a,sHc:b}=this.LSf(c,a)).returnValue)return a;this.xka.jra(b);return 32}LSf(a,b){let c;c=32;const f=ba.a.drb===b;b=new Ts(!1,f);const l=!!this.xka&&this.xka.NP(b);if(1===a)return c=this.ra.kSa()?2:l?32:16,{returnValue:!1,XE:c,sHc:b};a=this.wc.FO(f?1:0,1,"HandleCutCopyToSystemClipboard");this.wc.vw(1,a);b.Sb=a;return!l||this.Xb.pSa()?(this.wc.Eg(!1,a,2),{returnValue:!1,XE:16,sHc:b}):{returnValue:!0,XE:c,sHc:b}}pQc(a,b,c){if(1===c)return this.ra.kSa()?
2:a===ba.a.reb?this.Mlc(!1):a===ba.a.seb?this.Mlc(!1):a===ba.a.jEb?this.Mlc(!0):32;b=this.wc.FO(2,1,"HandlePasteFromSystemClipboard");c=this.$p.Ba;if(!c||this.Xb.Zc(c)||this.ra.h8())return this.wc.Eg(!1,b,3),16;c=null;let f=!1;a===ba.a.reb?c=!1:a===ba.a.seb?c=!0:a===ba.a.jEb&&(f=!0);this.qC.paste(Object.assign(new Fm.a(!1),{Sb:b,kA:c,a6a:f}),null,!1);return 32}Smj(a,b,c){if(this.Xb.pSa())return 16;if(1===c)return 32;a=this.ra.og();for(const f of a)if(f.Jf||f.Og){Qn(f);break}this.cxl(a);return 32}cxl(a){if(!a||
!a.length)this.wua=this.A1c=null;else if(!this.A1c||!this.Fbi(this.A1c,a)){const b=[];for(const c of a)b.push(c);this.wua=new ef.a(0);this.wua.$(b[0].slideId,1);this.A1c=b}}Fbi(a,b){if(a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(a[c]!==b[c])return!1;return!0}Nej(a,b,c,f){let l;l=b?b.Ftb(110,75):this.Qb.hsa(c.clientWidth,c.clientHeight);a=this.Dm.uRd(a.Bb.cid,a.Bb.sid,!0,l._x,l._y,c.width,c.height,a.ev()+1,c.src,c.alt&&c.alt.length?c.alt:"image",f);b&&(a.kba=b.id);return a}tpj(a,b,c,
f,l){b=this.$p.Ba;if(!b)return Aa.a.J(512356573,826,50,"Active Slide is null"),8;if(1===c)return this.Xb.Zc(b)?16:32;if(!l)return 16;this.wc.oB(5,l.Sb);if(!this.ol.yI(b,1))return this.wc.Eg(!1,l.Sb,8),this.ol.AJ(b),16;Nc.a.gya("PastePicture",!1);f=Rx.M0b(l);if(!f||!f.src)return this.wc.Eg(!1,l.Sb,10),8;if((c=b.L2(this.ra.Yd()))&&this.Xb.Zc(c))return this.wc.Eg(!1,l.Sb,3),16;const x=this.Nej(b,c,f,l.Sb);f=this.Fb.ud(15,void 0,()=>{this.ra.Cy();this.Fa.Ad()},()=>{this.ra.selectShape(x,!0)});try{f.kc(b),
f.fd=a,f.Dy[zq.a.W2b]=!0,c&&b.gU([c]),b.GB(x)}finally{f&&f.dispose()}this.wc.Eg(!0,l.Sb);return 32}S_i(){if(!this.$p.Ba)return null;const a=this.$p.Ba.jl();for(const b of a)if(b.WDc)return b;return null}Bpj(a,b,c,f,l){b=this.$p.Ba;if(!b)return Aa.a.J(512356572,826,50,"Active Slide is null"),8;if(1===c)return b&&!this.Xb.Zc(b)?32:16;if(!l)return 8;this.wc.oB(6,l.Sb);if(!this.ol.yI(b,1))return this.ol.AJ(b),this.wc.Eg(!1,l.Sb,8),16;const x=this.S_i();if(x){if(this.Xb.Zc(x))return this.wc.Eg(!1,l.Sb,
3),16;if(x.sI)return Aa.a.J(512356571,826,50,"Unable to block placeholder because the shape {0} is changing ShapeIds",x.id),this.wc.Eg(!1,l.Sb,3),32}f=aA.Xag(l);if(!(f&&f.innerHTML&&f.rows&&f.rows.length&&f.getElementsByTagName($e.a.eld).length))return this.wc.Eg(!1,l.Sb,24),8;c=document.createElement("div");if(!c)return this.wc.Eg(!1,l.Sb,24),8;c.appendChild(f.cloneNode(!0));c=c.innerHTML;if(!c||0>=c.length)return this.wc.Eg(!1,l.Sb,24),8;Aa.a.J(512356570,826,50,"Paste table with {0} rows, table length {1}",
f.rows.length,c.length);var G=this.dcg();f=G.x-55;G=G.y-37.5;if(x){b=this.Fb.ud(15,void 0,()=>{this.ra.Cy();this.ra.Uh();this.Fa.Ad()},()=>{this.ra.selectShape(x,!0)});try{b.kc(x),b.fd=a,b.Dy[zq.a.X2b]=!0,x.Sb=l.Sb,x.cXa=c}finally{b&&b.dispose()}this.Xb.Jw(x,a)}else c=b.ABi(f,G,b.ev()+1,c,l.Sb),c.Sb=l.Sb,this.Sz.B2([Object(ua.a)(4,c)],Object(ua.a)(120,b),a);this.wc.Eg(!0,l.Sb);return 32}spj(a,b,c,f,l){if(1===c)return 32;b=l?Object(ua.a)(wM.a,l):null;if(!b)return Aa.a.J(512356569,826,50,"Html paste context should not be null."),
8;c=this.$p.Ba;if(!c)return Aa.a.J(512356568,826,50,"Active Slide is null"),8;if(!c||this.Xb.Zc(c))return this.wc.Eg(!1,b.Sb,3),16;Nc.a.gya("PasteHtmlAsync",!0);Aa.a.J(512356567,826,50,"Paste html start");return this.WZf(b,c,a)}handlePasteHtml(a,b,c,f,l){if(1===c)return this.ra.kSa()?2:32;const x=l?Object(ua.a)(wM.a,l):null;if(!x)return Aa.a.J(512356566,826,50,"Html paste context should not be null"),8;b=this.$p.Ba;if(!b)return Aa.a.J(512356565,826,50,"Active Slide is null"),8;if(!b||this.Xb.Zc(b))return this.wc.Eg(!1,
x.Sb,3),16;Aa.a.J(512356564,826,50,"Paste html start");Nc.a.LO(!1,!1);Nc.a.gya("PasteHtml",!0);Nc.a.qk(si.a.nwk,"Image:"+x.tca.length.toString()+",Table:"+x.fib.length.toString()+",Text:"+(x.oY?x.oY.length.toString():"0"));f=this.ra.Yd();a=Dq.a.Ehh(0<x.tca.length?!0:!1,!1,0<x.fib.length?!0:!1,!1,this.la.cya,a);if(x.Wlc)return Aa.a.J(512356563,826,50,"Will replace text"),this.wc.oB(1,x.Sb),a=this.eKi(x,f[0],a),16!==a?this.wc.Eg(!0,x.Sb):this.wc.Eg(!1,x.Sb,15),a;Aa.a.J(512356562,826,50,"Will paste html into new shapes");
if(x.XUc){if(this.la.jyg){const G=Nc.a.Eb;this.yb.Cb(new xe.a(2,1,0,()=>{Nc.a.cF(G,()=>{this.ia.La(ba.a.zad,c,x)})},90,"66"));return 64}return this.WZf(x,b,a)}return this.cKi(x,b,f,a)}eKi(a,b,c){if(this.Xb.Zc(b))return 16;if(a.oY&&0<a.oY.length){Aa.a.J(512356561,826,50,String.format("ReplaceText: {0}",this.ZEa.YMd([b])));if(this.eAg(a.oY))return 16;this.Xb.Jw(b,c);const f=this.Fb.ud(15);try{b.Sb=a.Sb,f.kc(b),f.fd=c,b.Ijc=a.oY,Object(Ma.a)(1374,f)&&b.id&&(Object(ua.a)(1374,f).Dy[zq.a.g6g]=b.id.toString())}finally{f&&
f.dispose()}}return 32}cKi(a,b,c,f){const l=[],x=b.ev();var G=this.dcg(),R=G.x,fa=G.y;G=0;for(var wa=0;wa<a.fib.length;++wa)G=this.Dm.vRd(!0,b.cid,b.sid,!1,R,fa,110,75,x+1,a.fib[wa],a.Sb),l.push(G),G=6;R=a.tca;fa=1===R.length?0:Dq.a.a7;for(wa=0;wa<R.length;wa++){const Wa=this.Dm.uRd(b.cid,b.sid,!1,fa,fa,R[wa].width,R[wa].height,x+1,R[wa].src,R[wa].alt,a.Sb);l.push(Wa);fa+=Dq.a.a7;G=0===G?5:20}if(a.oY&&0<a.oY.length)if(Aa.a.J(512356560,826,50,String.format("PasteTextIntoNewTextbox: {0}",this.ZEa.YMd(c))),
!this.eAg(a.oY))c=this.Dm.wRd(b.cid,b.sid,x+1,a.oY,a.Sb),l.push(c),G=0===G?1:20;else if(!l.length)return this.wc.oB(1,a.Sb),this.wc.Eg(!1,a.Sb,7),16;this.wc.oB(G,a.Sb);if(0<l.length){if(!this.ol.yI(b,l.length))return this.ol.AJ(b),this.wc.Eg(!1,a.Sb,8),16;1===l.length&&a&&this.la.insertVideoWithPasteEnabled?(c=a.oY,this.W8.FAg(c)?(this.wc.oB(8,a.Sb),Aa.a.J(512356559,826,50,String.format("[Insert Online Video]: Inserting online video by paste!")),this.Sz.B2(l,b,f),this.W8.qsl(c,Object(C.a)(this,this.GBl,
"videoInsertionFail"))):(this.Sz.B2(l,b,f),this.Xb.Jw(b,f))):(this.Sz.B2(l,b,f),this.Xb.Jw(b,f));this.wc.Eg(!0,a.Sb)}else this.wc.Eg(!1,a.Sb,9);return 32}GBl(){Aa.a.J(512356557,826,50,String.format("[Insert Online Video] Failed to insert online video by paste!"))}WZf(a,b,c){this.wc.oB(5,a.Sb);if(Qa.a.Va(a.tca))return this.wc.Eg(!1,a.Sb,10),16;if(!b)return 16;var f=Object(ua.a)(553,b.oc(this.Mb.Ma));if(!f)return this.wc.Eg(!1,a.Sb,3),8;var l=Nc.a.Eb;l&&(l.actionName="SinglePicturePaste",l.Kr=!0,l.Oj=
!0,l.Wa("PreloadImageDuration",a.Wze.toString()));l=a.tca[0];const x=b.L2(this.ra.Yd());var G=b.ev();let R,fa;({cXd:fa,MC:R}=this.AUa.HPd(x,l.width,l.height));G=this.Dm.uRd(b.cid,b.sid,!1,R.x,R.y,fa.width,fa.height,G+1,l.src,l.alt,a.Sb);Nc.a.qk("ImageSrcSize",l.src.length.toString());f=this.AUa.ULd(this.Mb.Fd,fa,R,f.bW);G.jU=f;x&&(G.kba=x.id);G.isResizable=!0;G.p5b=!0;G.ZK=!0;G.mHa=!0;G.Yca=l.src;this.Sz.B2([G],b,c,null,x);this.wc.Eg(!0,a.Sb);return 32}eAg(a){return 65535<a.length?(Aa.a.J(512356556,
826,50,"Exceed text size limit: {0}",a.length),!0):!1}upj(a,b,c,f,l){b=this.$p.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(1===c)return 32;c=Object(ua.a)(Fm.a,l);if(!c)return 8;f=c.eW;if(Qa.a.Va(f))return this.wc.Eg(!1,c.Sb,11),8;this.wc.oB(2,c.Sb);this.wc.vw(2,c.Sb);l=this.$p.Ba;if(!l||this.Xb.Zc(l))return this.wc.Eg(!1,c.Sb,3),16;Nc.a.gya("PasteShape",!1);if(!this.ol.yI(l,f.length))return this.ol.AJ(l),this.wc.Eg(!1,c.Sb,8),16;Aa.a.J(512356555,826,50,"Start Handle paste shapes");
var x=Vq.b(f,fa=>fa.shapeNode);this.gw.S5d(x,"HandlePasteShapes");for(var G of f){if(!G||!G.shapeNode.isConnected)return Aa.a.J(512356554,826,50,"Paste deleted shapes"),this.XGg.pmc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),this.wc.Eg(!1,c.Sb,12),16;if(this.Xb.rN(G.shapeNode))return this.wc.Eg(!1,c.Sb,3),16;if(!G.shapeNode.get_shapeId())return this.wc.Eg(!1,c.Sb,12),16}G=[];for(x=0;x<f.length;x++)G.push(f[x].shapeNode);
for(var R of G)if(R.Jf||R.Og){Qn(R);break}R=Object(ua.a)(120,b.$B(f[0].shapeNode.slideId));this.ZEa.U5g(R,l,G,this.wua,a,c.Sb);Aa.a.J(512356553,826,50,({contentType:a}=this.ZEa.ZMd(G)).returnValue);this.wc.oB(a,c.Sb);Nc.a.LO(!0,!0);this.wc.Eg(!0,c.Sb);return 32}ppj(a,b,c,f,l){(a=Object(ua.a)(Fm.a,l))&&this.qC.fwk(a.Sb);return 32}Apj(a,b,c,f,l){if(1===c)return 32;b=Object(ua.a)(Fm.a,l);if(!b)return 8;this.wc.oB(19,b.Sb);this.wc.vw(2,b.Sb);if(Qa.a.Va(b.eW))return this.wc.Eg(!1,b.Sb,11),8;Nc.a.gya("PasteSlide",
!0);if(c=Array.isArray(b.eW)?b.eW:null){let G=0;c.forEach(R=>{R.Ed&&R.Ed.hasDeferredContent&&G++});0<G&&Aa.a.J(512356552,843,50,"HandlePasteSlides total: {0}, deferredSlideCount: {1}",c.length,G)}c=[];for(var x of b.eW){f=Object(ua.a)(Sv.a,x);if(!f)return this.wc.Eg(!1,b.Sb,11),8;f=f.Ed;if(!f||!f.isConnected)return Aa.a.J(512356551,826,50,"Paste deleted slide"),this.XGg.pmc(ResourceStrings.l_CannotPasteDeletedObjectsTitle,String.format(ResourceStrings.l_CannotPasteDeletedObjectsMessage),null),b.J3g&&
(this.Aq.Nq=null),this.wc.Eg(!1,b.Sb,13),16;if(this.Xb.Zc(f))return this.wc.Eg(!1,b.Sb,3),16;Array.add(c,f)}x=Array.clone(this.ra.nf());x.sort((G,R)=>G.we-R.we);x=x[x.length-1];if(!x)return Aa.a.J(512356550,826,50,"Paste slides with no slide selected"),this.wc.Eg(!1,b.Sb,13),8;Nc.a.qk("SlideCount",c.length.toString());x=this.Sz.J2f(c,a,x,b.Sb,!1);c=!0;for(const G of x)if(!G.yN){c=!1;break}c||this.Xb.Jw(this.Zb.yf,a);Nc.a.LO(!0,!0);this.wc.Eg(!0,b.Sb);return 32}hNe(){return this.ra.wu()||this.ra.JG()}Oal(){if(this.ra.wu())return!0;
if(this.ra.JG()){const a=this.ra.Yd();return 1!==a.length||!a[0].isEditable}return!1}pmj(a,b,c,f,l,x){const G=this.wc.FO(1,0,"HandleBrowserCut");this.wc.oB(1,G);this.hNe()?(a=this.G$a(a,this.ia,b,c,f,l,x,this.wc,G),a.H4a(16)):(Nc.a.LO(!0,!0),this.wc.jdc(G),a=this.G$a(a,this.ia,E.a.jVb,c,f,l,x,this.wc,G),a.TRc());return a}omj(a,b,c,f,l,x){const G=this.wc.FO(0,0,"HandleBrowserCopy");this.wc.oB(1,G);this.hNe()?(a=this.G$a(a,this.ia,b,c,f,l,x,this.wc,G),2===f&&this.xka.jra(Object.assign(new Ts(!0),{sug:!1,
Sb:G})),a.H4a(32)):(this.wc.jdc(G),a=this.G$a(a,this.ia,E.a.eDc,c,f,l,x,this.wc,G),a.TRc());return a}qmj(a,b,c,f,l,x){const G=this.wc.FO(2,0,"HandleBrowserPaste"),R=this.hNe();a=this.G$a(a,this.ia,R?b:E.a.tqa,c,f,l,x,this.wc,G);x=Object(ua.a)(10,x);Nc.a.LO(!0,!1);if(this.ra.h8())return a.H4a(16),this.wc.Eg(!1,G,3),a;x&&x.Sa(Oc.a.bU)?2===f&&this.Xmd(x,G)?a.H4a(32):R?(2===f&&this.qC.paste(Object.assign(new Fm.a(!0),{Uxg:!1}),x.getValue(Oc.a.bU),!1),a.H4a(32)):a.TRc():(Aa.a.J(512356549,826,50,"Invalid action data for browser paste, expect PastedHtmlContent"),
a.H4a(16),this.wc.Eg(!1,G,14));return a}rpj(a,b,c,f,l,x){Nc.a.gya("PasteGivenText",!1);this.Oal()?(a=this.G$a(a,this.ia,b,c,f,l,x,this.wc,""),a.H4a(16)):(Nc.a.LO(!0,!0),a=this.G$a(a,this.ia,E.a.yad,c,f,l,x,this.wc,""),a.TRc());return a}Cpj(a,b,c,f,l){if(1===c)return 32;if((b=this.ra.Yd())&&0<b.length)return Aa.a.J(512356548,826,50,"HandlePasteTextIntoNewShape: do not paste text into a new textbox since a shape is selected. {0}",this.ZEa.YMd(b)),16;Aa.a.J(512356547,826,50,"HandlePasteTextIntoNewShape: a. Paste text as new shape.");
if(!(l&&l.$m&&l.$m.innerHTML&&l.$m.innerHTML.length))return Aa.a.J(512356546,826,50,"HandlePasteTextIntoNewShape: a. User attempted to paste null content."),8;Nc.a.gya("PasteTextIntoNewShape",!0);b=this.$p.Ba;if(!b)return Aa.a.J(512356545,826,50,"insert shape with no slide selected"),16;if(!this.ol.yI(b,1))return this.ol.AJ(b),16;l=this.Dm.wRd(b.cid,b.sid,b.ev()+1,l.$m.innerHTML,l.Sb);this.Sz.B2([l],b,a);return 32}dcg(){const a=this.Qb.su();return new zc.a(Math.floor(a.width/2),Math.floor(a.height/
2))}qpj(a,b,c,f,l){if(1===c)return 32;a="";l&&(a=l.getAttribute(mu.a.pOf).toString());this.wc.bxb(a)||(a=this.wc.FO(2,1,"HandlePasteContentFromPandora"));b=this.ia.processAction(ba.a.Tha,2);if(32!==b)return this.wc.Eg(!1,a,15),Aa.a.J(512356544,826,50,"Exit from box4 failed."),b;a=Object.assign(new Fm.a(!0),{Sb:a});this.hT.$Ij(l)?a.$m=l:($e.a.MEc(this.kh),this.kh.contentWindow.document.body.appendChild(l));this.qC.paste(a,null,!1);Aa.a.J(512356515,826,50,null);return 32}Xmd(a,b){if(a){if(this.la.b$d){const c=
a.sa(Oc.a.ERc,"");if(c.startsWith("data:image/"))return this.wc.oB(5,b),this.qC.Vze(c,b)}a=a.getValue(Oc.a.bU);Ka.a.Va(a)||(a=this.hT.$Wa(a),this.wc.a8k(a,b))}return!1}}Object(e.a)(xM,"ClipboardActor",null,[229]);var Eq=d(1096);class yM{constructor(a,b){this.ia=a;this.xq=b;this.ub()}ub(){this.ia.pa(ba.a.GEk,xd.a.frame,Object(C.a)(this,this.Soc,"updateCoauthStatus"),96)}xe(){}Soc(a,b,c,f,l){if(1===c)return 32;a=this.xq.ugc;Ka.a.Va(a)&&(a="NotConnected");this.xq.k5a&&(a=String.format("{0} ~:{1}",a,
this.xq.k5a));l[Eq.a.Value]=a;l[um.a.labelText]=a;l[Eq.a.Visible]=!0;return 32}}Object(e.a)(yM,"CoauthActor",null,[229]);var nu=d(258),Mk=d(339);class zM{constructor(a,b,c,f){this.CFa=!1;a("powerpoint-editor-intl").then(()=>{Aa.a.J(51519637,801,50,"Icons and strings script is loaded successfully");a("colorPickerManager").then(()=>{Aa.a.J(51519639,801,50,"Color Picker Manager script is loaded successfully");this.CFa=!0}).catch(l=>{Aa.a.J(51519641,801,10,"Failed to load colorpickerManager "+l.toString())})}).catch(l=>
{Aa.a.J(51519643,801,10,"Failed to load powerpoint-editor-intl "+l.toString())});this.ia=b;this.Fa=c;this.Zb=f}ub(){this.ia.ya(ba.a.renderColorPicker,sc.a.application,Object(C.a)(this,this.renderColorPicker,"renderColorPicker"));this.ia.ya(ba.a.tAa,sc.a.application,Object(C.a)(this,this.tAa,"addRecentColor"))}xe(){}renderColorPicker(a,b,c,f,l){if(1===c)return this.CFa?32:8;a=!1;b=l.currentColor;c=l.handleCommand;l.hideAlphaSlider&&(a=!0);this.qTk(b,c,a);return 32}tAa(a,b,c,f,l){if(a=nu.a.parse(l.Color)){b=
this.Zb.yf;if(!b)return Aa.a.J(595186576,822,10,"AddRecentColor: pagemanifestnode is null"),8;b.me(sb.a.YEi,a.RGBColor);b.me(sb.a.j2,JSON.stringify(Mk.g(b.j2,a.RGBColor)))}else return Aa.a.J(595186574,822,10,"AddRecentColor: failed to parse colorinfo, colorInfo is null"),8;return 32}qTk(a,b,c){let f="#000000",l=100;a&&(f=Hb.a.ZH(a.UC),l=100*a.alpha);a=document.getElementById("colorPickerDiv");a||(a=document.createElement("div"),a.id="colorPickerDiv",document.getElementById("WACInnerFrame").appendChild(a),
this.Fa.XRc(Yb.a.EWb,Yb.a.jj,a));const x=colorPickerManager.FactoryGlobal.getColorPickerManagerInstance();if(x)if(x.addEventListener("onColorChange",fa=>{const wa={};wa.Color=fa;wa.sourceControlId="CustomColors";let Wa=8;Ag.a("ColorPicker_ColorApplied",b,()=>Wa=this.ia.La(b,2,wa));32===Wa?Aa.a.J(595186570,822,50,"RenderColorPickerDialog: Color applied successfully from color picker dialog through {0} command.",b):Aa.a.J(595186568,822,50,"RenderColorPickerDialog: Color not applied successfully from color picker dialog through {0} command.",
b);this.Fa.Gj(Yb.a.EWb,!1)}),x.addEventListener("onCancel",()=>{this.Fa.Gj(Yb.a.EWb,!1)}),Ag.a("ColorPicker_DialogInvocation",b,()=>{x.render("colorPickerDiv",f,l,c);return 32}),Aa.a.J(595186566,822,50,"RenderColorPickerDialog: Color Picker Dialog invoked through {0} command.",b),this.Fa.Gj(Yb.a.EWb,!0),a=this.Fa.Dc(Yb.a.EWb)){a.cL=!0;var G=A.KeyInputManager.Na(w.a.Iq,0),R=A.KeyInputManager.Na(w.a.Iq,4);a.np(G);a.np(R);a.bindAction(G,F.a.ira);a.bindAction(R,F.a.ira)}else Aa.a.J(595186564,822,10,"RenderColorPickerDialog: colorPickerScope is null");
else Aa.a.J(595186572,822,10,"RenderColorPickerDialog: colorPickerManagerInstace is null")}}Object(e.a)(zM,"ColorPickerActor",null,[229]);var MQ=d(1013);class AM{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb=!1,Kb=!1){this.ia=a;this.K8b=b;this.wQ=c;this.Gla=l.Pnc;this.qka=f;this.ua=x;this.Ea=G;this.ra=R;this.Fa=fa;this.I_=wa;this.Q4j=mb;this.Mb=Wa;this.Ys=Kb}ub(){this.ia.ya(ba.a.VFc,sc.a.application,Object(C.a)(this,this.Yrj,"handleThumbnailPanelContextMenu"));this.ia.ya(ba.a.iQd,sc.a.application,Object(C.a)(this,
this.Erj,"handleSorterViewThumbnailContextMenu"));this.ia.ya(ba.a.GSf,sc.a.application,Object(C.a)(this,this.Drj,"handleSorterViewBlankSpaceMenu"));this.ia.ya(ba.a.fQd,sc.a.application,Object(C.a)(this,this.drj,"handleSectionContextMenu"));this.ia.ya(ba.a.hQd,Bb.a.view,Object(C.a)(this,this.yrj,"handleSlidePanelContextMenu"));this.ia.ya(ba.a.gQd,Bb.a.view,Object(C.a)(this,this.Zoj,"handleMultiSelectShapeContextMenu"));this.ia.ya(ba.a.JSf,sc.a.application,Object(C.a)(this,this.osj,"handleVersionHistoryThumbnailContextMenu"));
this.ia.he(ba.a.VFc,2048)}xe(){this.Q4j&&r.a.Nj&&(this.Fa.Dc(I.AppFrame.QV).bindAction(A.KeyInputManager.Na(w.a.xKa,0),E.a.B$),this.Fa.Dc(I.AppFrame.EEe).bindAction(A.KeyInputManager.Na(w.a.xKa,0),E.a.B$))}Yrj(a,b,c,f,l){if(1===c)return 32;if(this.ia.pW)return this.I_.show(1,-1),32;this.K8b.t6a();if(l.Ac&&Sys.UI.DomElement.containsCssClass(l.Ac,Rf.a.CAa))return 16;if(this.wQ.SZ||!l.Ac)return 32;2===l.Wf||3===l.Wf?(a=l.clientPoint.y-te.a.daj(this.Gla.aU)+this.Gla.aU.scrollTop,a=this.Gla.OWd(a),b=new Sys.UI.Point(l.clientPoint.x,
l.clientPoint.y)):(a=0>this.Gla.selectedIndex?2:1,b=Sys.UI.DomElement.getLocation(this.Gla.aU),b=new Sys.UI.Point(b.x+sf.a.Kqa,b.y+sf.a.Kqa));this.qka.value.o5(sf.a.lra,b,l.Wf,a);return 32}osj(a,b,c,f,l){if(1===c)return 32;if(l.Ac&&Sys.UI.DomElement.containsCssClass(l.Ac,Rf.a.CAa))return 16;if(!l.Ac)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);this.qka.value.o5(sf.a.lra,a,l.Wf,21);return 32}Drj(a,b,c,f,l){if(1===c)return 32;a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);b=20;
this.Ys&&0===this.Mb.Xo&&(b=2);this.qka.value.o5(sf.a.lra,a,l.Wf,b);return 32}Erj(a,b,c,f,l){if(1===c)return 32;if(l.Ac&&Sys.UI.DomElement.containsCssClass(l.Ac,Rf.a.CAa))return 16;if(this.wQ.SZ||!l.Ac)return 32;if(2===l.Wf||3===l.Wf||1===l.Wf)b=19,this.Ys&&0===this.Mb.Xo&&(b=1),a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y),this.qka.value.o5(sf.a.lra,a,l.Wf,b);return 32}drj(a,b,c,f,l){if(1===c)return 32;u.AFrameworkApplication.fa.ka("PPTSorterViewSectionMenuEnabled")&&(a=l.contextMenuArgs,b=
new Sys.UI.Point(a.clientPoint.x,a.clientPoint.y),l.isEmptySection?this.qka.value.o5(sf.a.lra,b,a.Wf,17):this.qka.value.o5(sf.a.lra,b,a.Wf,18));return 32}yrj(a,b,c,f,l){if(1===c)return 32;this.K8b.t6a();if(l.Ac&&Sys.UI.DomElement.containsCssClass(l.Ac,Rf.a.CAa))return 16;if(this.wQ.SZ||!l.Ac)return 32;if(2===l.Wf||3===l.Wf)a=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{a=Ni.b(b);a=Ni.e(this.ua.Ba,a.Ma);if(!a)return 16;a=Sys.UI.DomElement.getLocation(a.mB);a=new Sys.UI.Point(a.x+sf.a.Kqa,
a.y+sf.a.Kqa)}this.qka.value.o5(sf.a.lra,a,l.Wf,4);return 32}Zoj(a,b,c,f,l){if(1===c||l.Ac&&Sys.UI.DomElement.containsCssClass(l.Ac,sf.a.z$h))return 32;this.K8b.t6a();if(l.Ac&&Sys.UI.DomElement.containsCssClass(l.Ac,Rf.a.CAa))return 16;if(this.wQ.SZ||!l.Ac)return 32;b=Ni.b(b);var x;if(!(b&&b.Gb&&(x=this.ra.og())&&x.length))return 16;a=this.E$i(x);if(2===l.Wf||3===l.Wf)x=new Sys.UI.Point(l.clientPoint.x,l.clientPoint.y);else{x=Ni.c(x[0],b.Ma);if(!x||!x.xa)return 16;x=ib.a.ei(x.xa.xa);b=ib.a.ei(b.container);
c=x.x+sf.a.Kqa<b.x?b.x:x.x+sf.a.Kqa;x=x.y+sf.a.Kqa<b.y?b.y:x.y+sf.a.Kqa;c=c>b.x+b.width?b.x+b.width:c;x=x>b.y+b.height?b.y+b.height:x;x=new Sys.UI.Point(c,x)}1===l.Wf||4===a?this.qka.value.o5(sf.a.lra,x,l.Wf,a):this.qka.value.ldl(sf.a.lra,x,l.Wf,a);return 32}E$i(a){let b=a[0];b.get_smartArtModelId()&&(b=this.Ea.nr(b));return 1<a.length?this.Ea.ZBc(a)?11:10:b.Ky||!b.gta||b.Jf?5:b.get_isSVGBlipFilled()?13:b.wk||1===b.mediaType?7:b.Pf?8:b.Ny?6:b.Uq?22:b.Wq?9:b.qd?14:b.Tp?15:b.d3?16:0}}Object(e.a)(AM,
"ContextMenuActor",null,[229]);class BM{constructor(a,b,c,f,l,x,G){this.ia=a;this.ra=b;this.Ea=c;this.l$a=f;this.F5j=l;this.mme=x;this.rT=G}ub(){this.ia.pa(ba.a.xxk,sc.a.application,Object(C.a)(this,this.yxk,"pictureToolsTabViewHandler"),4);this.ia.pa(ba.a.eLi,sc.a.application,Object(C.a)(this,this.fLi,"drawingToolsTabViewHandler"),4);this.ia.pa(ba.a.Pci,sc.a.application,Object(C.a)(this,this.Qci,"audioPlaybackToolsTabViewHandler"),4);this.ia.pa(ba.a.Mci,sc.a.application,Object(C.a)(this,this.Nci,
"audioFormatToolsTabViewHandler"),4);this.ia.pa(ba.a.Rci,sc.a.application,Object(C.a)(this,this.Sci,"audioSettingsTabViewHandler"),4);this.ia.pa(ba.a.ZEk,sc.a.application,Object(C.a)(this,this.slj,"graphicsTabViewHandler"),100);this.ia.pa(ba.a.T$g,sc.a.application,Object(C.a)(this,this.uml,"tableTabViewHandler"),100);this.ia.pa(ba.a.N$g,sc.a.application,Object(C.a)(this,this.Lci,"audioContextualGroupHandler"),100);this.ia.pa(ba.a.jCf,sc.a.application,Object(C.a)(this,this.Y_h,"accessibleAuthoringViewHandler"),
4)}xe(){}yxk(){return this.fJj()?32:this.Zxg(this.ra.og())?32:8}fLi(){const a=this.ra.og();return a&&a.length?1===a.length?this.Svg(a)?32:16:this.g$h(a)||this.JEj(a)&&this.Svg(a)?32:this.uob(a)||this.bLj(a)?16:32:16}Qci(){return this.mme?this.dUc()?32:this.uob(this.ra.og())?32:8:2}Nci(){return this.rT?this.dUc()?32:this.uob(this.ra.og())?32:8:2}Sci(){return this.rT&&this.mme?this.dUc()?32:this.uob(this.ra.og())?32:8:2}slj(){return this.F5j?this.gJj()?32:this.Ea.bnc(this.ra.og())?32:16:2}uml(){const a=
this.ra.Yd();return a&&1===a.length&&a[0].qd?32:8}Lci(){return this.rT||this.mme?this.dUc()?32:this.uob(this.ra.og())?32:8:2}Y_h(){return this.l$a&&this.l$a.isVisible?32:2}bLj(a){if(!a)return!1;let b=!0;for(const c of a){if(c.Tp||1===c.mediaType)return!0;c.wk||(b=!1)}return b}g$h(a){if(!a)return!1;for(const b of a)if(!b.Tp)return!1;return!0}Zxg(a){if(!a)return!1;let b=!1;for(const c of a)if(c)if(c.wk&&!c.get_isSVGBlipFilled())b=!0;else if(c.Tp)return!1;return b}uob(a){if(!a||!a.length)return!1;for(const b of a)if(b&&
1!==b.mediaType)return!1;return!0}JEj(a){if(!a||!a.length)return!1;for(const b of a)if(b&&1===b.mediaType)return!0;return!1}Svg(a){if(!a)return!1;for(const b of a)if(b&&(b.Usa||b.d3))return!0;return!1}fJj(){return this.qae(this.ra.og())&&this.Zxg(this.ra.wO(this.ra.Yd()))}gJj(){return this.qae(this.ra.og())&&this.IOj(this.ra.wO(this.ra.Yd()))}dUc(){return this.qae(this.ra.og())&&this.uob(this.ra.wO(this.ra.Yd()))}IOj(a){if(!a)return!1;for(const b of a)if(b&&b.Og&&b.get_isSVGBlipFilled())return!0;
return!1}qae(a){if(!a)return!1;for(const b of a)if(b&&b.Jf)return!0;return!1}}Object(e.a)(BM,"ContextualTabsActor",null,[229]);class CM{constructor(a,b,c,f){this.Wqe=null;this.ia=a;this.ua=b;this.Fb=c;this.NHg=f;this.NHg.Yj(Object(C.a)(this,this.S1g,"onRichApiResponseReceived"))}ub(){this.ia.pa(ba.a.gWd,Bb.a.application,Object(C.a)(this,this.Dnj,"handleExecuteAddinBatchOperation"),4)}xe(){}dispose(){this.NHg.tm(Object(C.a)(this,this.S1g,"onRichApiResponseReceived"))}S1g(a,b){this.Wqe&&(a=Object(ua.a)(1373,
b.node))&&a.HHe&&this.Wqe(a.HHe)}Dnj(a,b,c,f,l){b=this.ua.presentation;if(1===c)return b?32:8;if(!b)return Aa.a.J(590995482,802,10,"HandleExecuteAddinBatchOperation with null IPageManifestNode."),16;if(!l)return Aa.a.J(590995480,802,10,"HandleExecuteAddinBatchOperation with null action data."),16;this.Wqe=l.promiseToResolve;c=this.Fb.ud(15,void 0,void 0,void 0,!0);try{c.kc(b),c.fd=a,b.UHd(l.requestBody)}finally{c&&c.dispose()}return 32}}Object(e.a)(CM,"ExtensibilityActor",null,[229]);var Tx;(function(a){a[a.height=
0]="height";a[a.width=1]="width";a[a.rotation=2]="rotation";a[a.leftMargin=3]="leftMargin";a[a.rightMargin=4]="rightMargin";a[a.topMargin=5]="topMargin";a[a.bottomMargin=6]="bottomMargin"})(Tx||(Tx={}));Object(e.b)("FormatPaneProperty",Tx);class bA{constructor(a,b){this.G0=a;this.Q9=b}}Object(e.a)(bA,"MarginShapeData",null,[]);class zE{constructor(){this.type="FormatShapeTaskPaneProps";this.onToggleAspectRatio=this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.rotation=
this.width=this.height=this.numberFormatInfo=null;this.isMarginFieldEnabled=this.isAspectRatioFeatureEnabled=this.isAspectRatioDisabled=this.isAspectRatioLocked=!1;this.emptyValueFields=this.disabled=0}}Object(e.a)(zE,"FormatShapeTaskPaneProps",null,[]);class DM{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc){this.WGa=this.ocb=this.fX=this.Pua=null;this.CMg=0;this.Db=!1;this.uVa=null;this.uFa=this.gua=!1;this.s5j=!0;this.nb=b;this.Ob=c;this.ia=f;this.Fa=l;this.Ig=G;this.od=R;this.Lc=fa;this.Mb=
wa;this.FEa=Wa;this.Zb=mb;this.Ig.UH(Object(C.a)(this,this.Kva,"onChangeRenderFormatShapePane"));this.Ig.vAa(Object(C.a)(this,this.Kva,"onChangeRenderFormatShapePane"));this.Lc.JNa(Object(C.a)(this,this.Kva,"onChangeRenderFormatShapePane"));this.od.yAa(Object(C.a)(this,this.Kva,"onChangeRenderFormatShapePane"));this.Ob.JM(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"));this.AKg=nc;this.b_c=oc;this.Ea=Kb;this.D_=Ic;this.Tm=Kc;re.a("FixHeightAndWidthButtonValues")&&this.Tm&&this.Tm.uId(Object(C.a)(this,
this.Kva,"onChangeRenderFormatShapePane"))}dispose(){this.Ig.Y4(Object(C.a)(this,this.Kva,"onChangeRenderFormatShapePane"));this.Ig.GXa(Object(C.a)(this,this.Kva,"onChangeRenderFormatShapePane"));this.Lc.Efb(Object(C.a)(this,this.Kva,"onChangeRenderFormatShapePane"));this.od.Gfb(Object(C.a)(this,this.Kva,"onChangeRenderFormatShapePane"));this.Ob.QX(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"));re.a("FixHeightAndWidthButtonValues")&&this.Tm.Ked(Object(C.a)(this,this.Kva,"onChangeRenderFormatShapePane"))}ub(){this.ia.pa(ba.a.VNe,
sc.a.application,Object(C.a)(this,this.VNe,"showHideFormatShapePane"),4);this.ia.pa(ba.a.dKe,sc.a.application,Object(C.a)(this,this.dKe,"setAbsoluteHeight"),4);this.ia.pa(ba.a.wPe,sc.a.application,Object(C.a)(this,this.wPe,"spinAbsoluteHeight"),4);this.ia.pa(ba.a.dFb,sc.a.application,Object(C.a)(this,this.dFb,"queryAbsoluteHeight"),100);this.ia.pa(ba.a.eKe,sc.a.application,Object(C.a)(this,this.eKe,"setAbsoluteWidth"),4);this.ia.pa(ba.a.xPe,sc.a.application,Object(C.a)(this,this.xPe,"spinAbsoluteWidth"),
4);this.ia.pa(ba.a.eFb,sc.a.application,Object(C.a)(this,this.eFb,"queryAbsoluteWidth"),100);this.ia.pa(ba.a.tcd,sc.a.application,Object(C.a)(this,this.tcd,"queryFormatShapePane"),96)}xe(){}Kva(){this.Db&&this.Tl(!0)}lw(a){1===a.mode&&this.Db&&(this.Db=!1,this.Ns(),this.Fa.Gj(Yb.a.FZ,this.Db))}OIj(a){return this.Zb.isEditingAllowed&&this.s5j&&!this.kNe(a)}tcd(a,b,c,f,l){(a=Object(ua.a)(Nh.a,l))&&a.Nf(this.Db);return 32}VNe(a,b,c){b=this.nb.og();return 1===c?b.length&&this.OIj(b)?32:8:Ag.b("FormatShapePaneActor::ShowHideFormatShapePane PaneOpen:",
this.Db.toString(),a,()=>{(this.Db=!this.Db)?this.Tl():this.Ns();return 32})}dKe(a,b,c,f,l){b=this.nb.og();return 1===c?this.xqh(b)?8:32:Ag.a("FormatShapePaneActor::SetAbsoluteHeight",a,()=>{if(!l)return Aa.a.J(512500608,822,10,"FormatShapePaneActor::SetAbsoluteHeight actionData == null"),8;const x=l.Number;void 0===x||null===x||isNaN(x)||this.Rva(x,0);return 32})}wPe(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.Rva(0,0),this.I3a());return 32}dFb(a,b,c,f,l){if(!l)return Aa.a.J(512500579,822,10,"FormatShapePaneActor::QueryAbsoluteHeight actionData is null"),
8;if(a=l.queryResult)b=this.YB(),a.C$=b.height.toFixed(2).toString()+'"',1===(b.emptyValueFields&1)&&(a.C$="");return 32}eKe(a,b,c,f,l){b=this.nb.og();return 1===c?this.xqh(b)?8:32:Ag.a("FormatShapePaneActor::SetAbsoluteWidth",a,()=>{if(!l)return Aa.a.J(512500578,822,10,"FormatShapePaneActor::SetAbsoluteWidth actionData == null"),8;const x=l.Number;void 0===x||null===x||isNaN(x)||this.Rva(x,1);return 32})}xPe(a,b,c,f,l){if(!l)return 8;l.Increment&&(this.Rva(0,1),this.I3a());return 32}eFb(a,b,c,f,
l){if(!l)return Aa.a.J(512500577,822,10,"FormatShapePaneActor::QueryAbsoluteWidth actionData is null"),8;if(a=l.queryResult)b=this.YB(),a.C$=b.width.toFixed(2).toString()+'"',2===(b.emptyValueFields&2)&&(a.C$="");return 32}Tl(a=!1){const b=this.YB(),c=Object.assign(new ju.a,{title:ResourceStrings.l_FormatOptions,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.Db=!1},isModernPane:!0});Ej.UISurfaces.Ms().then(f=>{a?f.updateTaskPane(Yb.a.FZ,c):f.showTaskPane(Yb.a.FZ,
c);return null})}Ns(){Ej.UISurfaces.Ms().then(a=>{a.hideTaskPane(Yb.a.FZ,2);return null})}YB(){const a=this.nb.og();var b=[];for(var c of a)c.Jf?b=Array.isArray(b.concat.apply(b,this.Ea.Ow(c)))?b.concat.apply(b,this.Ea.Ow(c)):null:b.push(c);if(!(c=this.Pk(a[0]))||this.kNe(a))return this.uFa=!0,this.Wmh(0,0,0,0,0,0,0,127,127);var f=this.getBounds(a[0]),l=c.nd;c=this.B0d(f);c=this.ZFc(c,1,l);f=this.w4d(f);f=this.ZFc(f,0,l);this.uFa=0===c||0===f?!0:!1;l=Math.round(a[0].get_shapeRotation());l=0>l&&re.a("fixBugOfNegativeAngle")?
l+360:l;b=this.Pk(b[0]);let x=0,G=0,R=0,fa=0;b&&(x=b.YRa[0],G=b.YRa[1],R=b.YRa[2],fa=b.YRa[3]);c=this.Wmh(c,f,l,x,G,R,fa,this.h4i(a),0);this.Wxl(a,c);return c}h4i(a){let b=[];for(var c of a)c.Jf?b=Array.isArray(b.concat.apply(b,this.Ea.Ow(c)))?b.concat.apply(b,this.Ea.Ow(c)):null:b.push(c);c=0;for(let f=0;f<a.length;f++)this.NVb(a[f])||(c|=4),this.D_&&!this.MVb(a[f])&&(c|=1,c|=2);for(a=0;a<b.length;a++)if(!b[a].$wb){c|=120;break}return c}NVb(a){return!!a&&a.ZK&&!a.sI}MVb(a){return!!a&&a.isResizable&&
!a.sI}xqh(a){if(0>=a.length)return!0;let b=!1;if(this.D_){b=!0;for(let c=0;c<a.length;c++)if(a[c]&&this.MVb(a[c])){b=!1;break}}return b||this.kNe(a)}kNe(a){if(!a.length)return!0;let b=!1;for(let c=0;c<a.length;c++)if(a[c]&&a[c].qd){b=!0;break}return b}Wxl(a,b){if(this.b_c){var c=[];for(var f of a)f.Jf?c=Array.isArray(c.concat.apply(c,this.Ea.Ow(f)))?c.concat.apply(c,this.Ea.Ow(f)):null:c.push(f);var l=f=!0,x=!0,G=!0;if(2<=c.length)for(var R=1;R<c.length;R++){var fa=c[R];if(!fa)continue;if(!this.getBounds(fa))continue;
fa=this.Pk(fa);let wa=0,Wa=0,mb=0,Kb=0;fa&&(wa=fa.YRa[0],Wa=fa.YRa[1],mb=fa.YRa[2],Kb=fa.YRa[3]);f&&b.leftMargin!==wa&&(b.leftMargin=0,b.emptyValueFields|=8,f=!1);l&&b.rightMargin!==Wa&&(b.rightMargin=0,b.emptyValueFields|=16,l=!1);x&&b.topMargin!==mb&&(b.topMargin=0,b.emptyValueFields|=32,x=!1);G&&b.bottomMargin!==Kb&&(b.bottomMargin=0,b.emptyValueFields|=64,G=!1);if(!(f||l||x||G))break}}if(!(2>a.length))for(l=f=c=!0,x=1;x<a.length;x++)if(G=a[x])if(R=this.getBounds(G))if(fa=this.Pk(G).nd,G=this.B0d(R),
G=this.ZFc(G,1,fa),R=this.w4d(R),R=this.ZFc(R,0,fa),fa=a[x].get_shapeRotation(),c&&b.height.toFixed(2).localeCompare(G.toFixed(2))&&(b.height=0,b.emptyValueFields|=1,c=!1),f&&b.width.toFixed(2).localeCompare(R.toFixed(2))&&(b.width=0,b.emptyValueFields|=2,f=!1),l&&b.rotation!==fa&&(b.rotation=0,b.emptyValueFields|=4,l=!1),!(c||f||l))break}t4k(a,b,c,f,l,x,G,R,fa){const wa=new zE,Wa=Object(ua.a)(Object,Lg.e().numberFormatInfo);wa.numberFormatInfo=Wa;wa.height=a;wa.width=b;wa.rotation=c;wa.leftMargin=
f;wa.rightMargin=l;wa.topMargin=x;wa.bottomMargin=G;wa.disabled=R;wa.onChange=Object(C.a)(this,this.Rva,"onPropertyChange");wa.emptyValueFields=fa;wa.isAspectRatioLocked=this.gua;wa.isAspectRatioDisabled=this.uFa;wa.onToggleAspectRatio=Object(C.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");wa.isAspectRatioFeatureEnabled=this.AKg;wa.isMarginFieldEnabled=this.b_c;return wa}u4k(a,b,c,f,l){const x=new zE,G=Object(ua.a)(Object,Lg.e().numberFormatInfo);x.numberFormatInfo=G;x.height=a;x.width=
b;x.rotation=c;x.disabled=f;x.onChange=Object(C.a)(this,this.Rva,"onPropertyChange");x.emptyValueFields=l;x.isAspectRatioLocked=this.gua;x.isAspectRatioDisabled=this.uFa;x.onToggleAspectRatio=Object(C.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");x.isAspectRatioFeatureEnabled=this.AKg;return x}Wmh(a,b,c,f,l,x,G,R,fa){return this.b_c?this.t4k(a,b,c,f,l,x,G,R,fa):this.u4k(a,b,c,R,fa)}Rva(a,b){const c=this.nb.og();this.CMg!==b&&(this.I3a(),this.CMg=b);switch(b){case 0:case 1:this.resize(a,
c,b);break;case 3:case 4:case 5:case 6:this.nmi(a,c,b);break;case 2:this.rotate(a,c)}}onToggleAspectRatio(a){this.gua=a}OMf(a,b,c,f){a/=b;return c?Math.round(c/a):Math.round(f*a)}nmi(a,b,c){let f=[];for(const x of b)x.Jf?f=Array.isArray(f.concat.apply(f,this.Ea.Ow(x)))?f.concat.apply(f,this.Ea.Ow(x)):null:f.push(x);this.uVa=b=f;let l=!0;this.fX||(this.fX=[],l=!1);Ag.b("FormatShapePaneActor::ChangeMargin Property:",Tx[c]+"; AspectRatioLocked: "+(!this.uFa&&this.gua),ba.a.tlc,()=>{for(let x=0;x<b.length;x++){const G=
b[x],R=this.Pk(G);if(!R)continue;l||this.fX.push(new bA(G,new Of.a));this.fX.length===x&&this.fX.push(new bA(G,new Of.a));this.fX[x]||(this.fX[x]=new bA(G,new Of.a));const fa=this.fX[x];fa.Q9.left=G.Eha;fa.Q9.right=G.Fha;fa.Q9.top=G.Gha;fa.Q9.bottom=G.Dha;3===c&&(this.fX[x].Q9.left=a);4===c&&(this.fX[x].Q9.right=a);5===c&&(this.fX[x].Q9.top=a);6===c&&(this.fX[x].Q9.bottom=a);R.kya(this.fX[x].Q9)}return 32});this.cpc()}resize(a,b,c){this.uVa=b;let f=!0;const l=[],x=[];this.Pua||(this.Pua=[],f=!1);
0===a&&(this.uFa=!0);Ag.b("FormatShapePaneActor::Resize Property:",Tx[c]+"; AspectRatioLocked: "+(!this.uFa&&this.gua),ba.a.Qfb,()=>{for(let wa=0;wa<b.length;wa++){var G=b[wa];const Wa=this.Pk(G);if(this.D_){if(!Wa||!this.MVb(G))continue}else if(!Wa)continue;var R=this.getBounds(G),fa=this.B0d(R);R=this.w4d(R);f||(Array.add(this.Pua,new zz(G,new Of.a)),Wa.YK=!0,Wa.tD(!1));Array.add(l,Wa.AWa);Array.add(x,new Of.a);Wa.shapeNode.Jf&&Wa.shapeNode.isEditable&&Wa.Fk&&(Wa.Fk.visible=!0);G=Wa.nd;if(0===c){G=
this.XSf(a,1,G);G=Math.round(G-fa);x[wa].bottom=G;let mb;(mb=this.Pua[wa].s0).bottom=mb.bottom+G;if(!this.uFa&&this.gua){fa=this.OMf(R,fa,0,G);x[wa].right=fa;let Kb;(Kb=this.Pua[wa].s0).right=Kb.right+fa}}else{G=this.XSf(a,0,G);G=Math.round(G-R);x[wa].right=G;let mb;(mb=this.Pua[wa].s0).right=mb.right+G;if(!this.uFa&&this.gua){fa=this.OMf(R,fa,G,0);x[wa].bottom=fa;let Kb;(Kb=this.Pua[wa].s0).bottom=Kb.bottom+fa}}Wa.setOffsets(Of.a.add(l[wa],x[wa]),!0);Wa.shapeNode.Jf&&Wa.shapeNode.isEditable&&(Wa.w6d(),
Wa.hRc())}return 32});this.cpc()}rotate(a,b){this.uVa=b;let c=!0;a=Math.round(a);this.ocb||(this.ocb=[],c=!1);Ag.a("FormatShapePaneActor::Rotate",ba.a.hkc,()=>{for(let f=0;f<b.length;f++){const l=b[f],x=this.Pk(l);if(!x)continue;const G=x.Ssb().Vf(),R=a%wp.sfc;c||(x.tD(!1),Array.add(this.ocb,new wp(l,R)));this.ocb[f].qXf=R;x.setRotation(R,G)}return 32});this.cpc()}Pk(a){return a?Object(ua.a)(Az.a,a.sg(this.Mb.Ma)):(Aa.a.J(512500576,822,10,"shapeNode == null"),null)}getBounds(a){var b=this.Pk(a);if(!b)return Aa.a.J(512500575,
822,10,"shapeViewElement == null"),null;b=b.p0b();a.a_&&(b=this.RZd(b));return b}XSf(a,b,c){return this.FEa.cM(this.Mb.Fd.QZ(a,b),c)}ZFc(a,b,c){a=this.Mb.Fd.Ff(this.FEa.YL(a,c),b);return we.a.Av(a)}B0d(a){a=zc.a.$l(a.ik(Sc.a.Bu),a.ik(Sc.a.sH));return 1>=a?0:a}w4d(a){a=zc.a.$l(a.ik(Sc.a.Bu),a.ik(Sc.a.gE));return 1>=a?0:a}I3a(){this.b_c&&this.fX&&(this.ia.La(ba.a.tlc,2,this.fX),this.fX=null);if(this.Pua){for(var a=0;a<this.uVa.length;a++){var b=this.Pk(this.uVa[a]);b&&!b.ll&&(b.shapeNode.Jf&&b.shapeNode.isEditable||
(b.YK=!1),b.Hz(!1))}this.ia.La(ba.a.Qfb,2,this.Pua);this.Pua=null}if(this.ocb){for(a=0;a<this.uVa.length;a++)(b=this.Pk(this.uVa[a]))&&!b.ll&&(b.Hz(!1),this.ia.La(ba.a.hkc,2,this.ocb[a]));this.ocb=null}this.WGa=this.uVa=null}cpc(){this.WGa&&Nc.a.hqb(this.WGa);this.WGa=Nc.a.z$(Object(C.a)(this,this.I3a,"applyPendingChangesToServerIfRequired"),1E3)}RZd(a){const b=zc.a.l7a(a.ga(0),a.ga(3));a=zc.a.l7a(a.ga(1),a.ga(2));return new th.a(new zc.a(b.x,b.y),new zc.a(a.x,b.y),new zc.a(a.x,a.y),new zc.a(b.x,
a.y))}}Object(e.a)(DM,"FormatShapePaneActor",null,[106,229]);class cA{constructor(a,b,c,f,l,x,G){this.type="FormatTableTaskPaneProps";this.onChange=this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=this.tableWidth=this.tableHeight=this.cellWidth=this.cellHeight=this.numberFormatInfo=null;this.isAspectRatioLocked=!1;this.onToggleAspectRatio=null;this.disabled=!1;this.emptyValueFields=0;const R=Object(ua.a)(Object,Lg.e().numberFormatInfo);if(!R)throw Error.argumentNull("numberFormatInfo");
this.numberFormatInfo=R;this.cellHeight=b;this.cellWidth=c;this.tableHeight=f;this.tableWidth=l;this.leftMargin=a.leftMargin;this.rightMargin=a.rightMargin;this.topMargin=a.topMargin;this.bottomMargin=a.bottomMargin;this.disabled=x;this.emptyValueFields=G}}Object(e.a)(cA,"FormatTableTaskPaneProps",null,[]);class EM{constructor(){this.bottomMargin=this.topMargin=this.rightMargin=this.leftMargin=0;this.D8g=this.G8g=this.F8g=this.E8g=-1}}Object(e.a)(EM,"Margins",null,[]);class FM{constructor(a,b,c,f,
l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc){this.gua=this.Db=!1;this.Cii=320;this.sVa=!1;if(!a)throw Error.argumentNull("pptSelectionManager");if(!b)throw Error.argumentNull("appFrame");if(!c)throw Error.argumentNull("actionManager");if(!f)throw Error.argumentNull("focusManager");if(!l)throw Error.argumentNull("formatTablePane");if(!x)throw Error.argumentNull("graphOperationEventHandler");if(!G)throw Error.argumentNull("viewElementEventHandlers");if(!R)throw Error.argumentNull("viewEventSource");if(!fa)throw Error.argumentNull("pageView");
if(!wa)throw Error.argumentNull("unitConversion");if(!Wa)throw Error.argumentNull("workspace");if(!Kb)throw Error.argumentNull("tableReader");if(!nc)throw Error.argumentNull("rowReader");if(!oc)throw Error.argumentNull("columnReader");if(!mb)throw Error.argumentNull("dynamicScriptLoader");mb.loadScript("powerpoint-editor-intl").then(()=>{this.sVa=!0}).catch(Ic=>{Aa.a.J(512500574,801,10,"Failed to load powerpoint-editor-intl "+Ic.toString())});this.nb=a;this.Ob=b;this.ia=c;this.Fa=f;this.Ig=x;this.od=
G;this.Lc=R;this.Ig.UH(Object(C.a)(this,this.FWa,"onChangeRenderFormatTablePane"));this.Ig.vAa(Object(C.a)(this,this.FWa,"onChangeRenderFormatTablePane"));this.Lc.JNa(Object(C.a)(this,this.FWa,"onChangeRenderFormatTablePane"));this.od.yAa(Object(C.a)(this,this.FWa,"onChangeRenderFormatTablePane"));this.Ob.JM(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"));this.$I=oc;this.OVa=nc;this.tc=Kb}dispose(){this.Ig.Y4(Object(C.a)(this,this.FWa,"onChangeRenderFormatTablePane"));this.Ig.GXa(Object(C.a)(this,
this.FWa,"onChangeRenderFormatTablePane"));this.Lc.Efb(Object(C.a)(this,this.FWa,"onChangeRenderFormatTablePane"));this.od.Gfb(Object(C.a)(this,this.FWa,"onChangeRenderFormatTablePane"));this.Ob.QX(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"))}ub(){this.ia.pa(ba.a.aOe,sc.a.application,Object(C.a)(this,this.aOe,"showHideReactFormatTablePane"),4);this.ia.pa(ba.a.Pcd,sc.a.application,Object(C.a)(this,this.Pcd,"queryReactFormatTablePane"),96)}xe(){}FWa(){this.Db&&this.Tl(!0)}lw(a){1===a.mode&&this.Db&&
(this.Db=!1,this.Ns(),this.Fa.Gj(Yb.a.JJa,this.Db))}Pcd(a,b,c,f,l){(a=Object(ua.a)(Nh.a,l))&&a.Nf(this.Db);return 32}aOe(a,b,c){if(!this.sVa)return 8;b=this.nb.og();if(1===c)return b.length?32:8;this.Db=!this.Db;return Ag.b("FormatTablePaneActor::ShowHideFormatTablePane PaneOpen: ",this.Db.toString(),a,()=>{this.Db?this.Tl():this.Ns();return 32})}Tl(a=!1){const b=this.YB(),c=Object.assign(new ju.a,{title:ResourceStrings.L_FormatTable,hideHeader:!1,width:this.Cii,location:2,contentProps:b,onOpen:()=>
{Aa.a.J(512500573,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now visible")},onClose:()=>{this.Db=!1;Aa.a.J(512500572,833,50,"FormatTablePaneActor::ShowHideReactFormatTablePane pane is now hidden")},isModernPane:!0});Ej.UISurfaces.Ms().then(f=>{a?f.updateTaskPane(Yb.a.JJa,c):f.showTaskPane(Yb.a.JJa,c);return null}).catch(f=>{Aa.a.J(512500571,822,10,"FormatTablePaneActor::ShowPane, Failed to show format table pane. Exception: "+f.toString())})}Ns(){Ej.UISurfaces.Ms().then(a=>
{a.hideTaskPane(Yb.a.JJa,2);return null}).catch(a=>{Aa.a.J(512500570,822,10,"FormatTablePaneActor::HidePane, Failed to hide format table pane. Exception: "+a.toString())})}YB(){var a=this.nb.Yo();const b=new EM;if(!a)return a=new cA(b,0,0,0,0,!0,255),this.LKe(a);let c=0,f=0;({cellHeight:c,cellWidth:f}=this.Vbj(a,c,f));const l=we.a.Av(this.tc.Q3d(a)),x=we.a.Av(this.tc.S3d(a));let G=this.nb.Ey();G&&G.length||(G=this.tc.jF(a));if(!G||!G.length)return a=new cA(b,c,f,l,x,!0,255),this.LKe(a);this.Ubj(G,
b);a=new cA(b,c,f,l,x,!1,0);this.LKe(a);this.Vxl(a);return a}LKe(a){a.onChange=Object(C.a)(this,this.Rva,"onPropertyChange");a.isAspectRatioLocked=this.gua;a.onToggleAspectRatio=Object(C.a)(this,this.onToggleAspectRatio,"onToggleAspectRatio");return a}Vbj(a,b,c){let f=this.nb.TOc(),l=this.nb.Ytb();f&&f.length||(f=this.tc.Zia(a));l&&l.length||(l=this.fub(a));f.length&&(b=we.a.Av(this.OVa.m$f(f)));l.length&&(c=we.a.Av(this.$I.o$f(a,l)));return{cellHeight:b,cellWidth:c}}Ubj(a,b){let c=!0,f=!0,l=!0,x=
!0;for(const G of a)G&&!G.isGhostCell&&({dTc:c,hEc:b.leftMargin,Wbd:b.E8g}=this.znd(c,b.leftMargin,G.marginLeft,b.E8g),{dTc:f,hEc:b.rightMargin,Wbd:b.F8g}=this.znd(f,b.rightMargin,G.marginRight,b.F8g),{dTc:l,hEc:b.topMargin,Wbd:b.G8g}=this.znd(l,b.topMargin,G.marginTop,b.G8g),{dTc:x,hEc:b.bottomMargin,Wbd:b.D8g}=this.znd(x,b.bottomMargin,G.marginBottom,b.D8g))}znd(a,b,c,f){a&&(b=we.a.Av(c),0<=f&&f!==b&&(b=-1,a=!1),f=b);return{dTc:a,hEc:b,Wbd:f}}Vxl(a){0>a.cellHeight&&(a.emptyValueFields|=1);0>a.cellWidth&&
(a.emptyValueFields|=2);0>a.leftMargin&&(a.emptyValueFields|=16);0>a.rightMargin&&(a.emptyValueFields|=32);0>a.topMargin&&(a.emptyValueFields|=64);0>a.bottomMargin&&(a.emptyValueFields|=128)}Rva(a,b){const c={};c.Number=a;switch(b){case 0:this.ia.La(ba.a.Ygb,2,c);break;case 1:this.ia.La(ba.a.IYa,2,c);break;case 2:this.ia.La(ba.a.dxa,2,c);break;case 3:this.ia.La(ba.a.JYa,2,c);break;case 4:this.ia.La(ba.a.gnc,2,c);break;case 5:this.ia.La(ba.a.hnc,2,c);break;case 6:this.ia.La(ba.a.inc,2,c);break;case 7:this.ia.La(ba.a.fnc,
2,c)}}onToggleAspectRatio(a){this.gua=a;this.ia.La(ba.a.Ihd,2,null)}fub(a){let b=null;a&&14===a.type&&(b=this.tc.O3d(a.firstRow));return b}}Object(e.a)(FM,"FormatTablePaneActor",null,[106,229]);class dA{constructor(a,b,c){this.ra=a;this.Mb=b;this.Ea=c}process(a,b,c,f){2===c&&32===f&&b.contextId===Bb.a.view&&Array.contains(dA.SYk,a)&&(a=this.ra.Yd(),0<a.length&&0<this.Ea.textLength(a[0])&&this.Qmi(a[0]))}Qmi(a){if(!a.W9){var b=rd.SelectionFactory.gl(a);b=cb.SelectionEditor.v_b(b);var c=cb.SelectionEditor.u_b(b,
!1);b=rd.SelectionFactory.bN(b,c.Ua,!1);if((c=this.ra.Oa)&&c.kb&&c.kb.contains(b)&&2===a.nz){var f=Object(ua.a)(121,a.oc(this.Mb.Ma));if(f){b=a.nz;c=a.I0;var l=a.J0;a.nz=1;a.I0=1;a.J0=0;f=f.p1f();f.eKf();f.kJf();f.oya();f.F3f()&&(a.nz=b,a.I0=c,a.J0=l);f.detach();f.zUe()}}}}}dA.SYk=[E.a.Jr,E.a.nI,E.a.BJ];Object(e.a)(dA,"FormattingViewOperationFinishedStageProcessor",null,[1134]);var NQ=d(609);class GM extends Sys.EventArgs{constructor(a){super();this.section=a}}Object(e.a)(GM,"SectionNodeChangedArgs",
Sys.EventArgs,[]);class HM{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.uQ=null;this.Xs=a;this.Fb=b;this.Zb=c;this.ra=f;this.Fa=l;this.la=R;this.ep=this.la.Ly;this.Je=G;this.EFa=this.la.Abe;this.Qb=x;this.p6j=this.la.w6b;this.Xb=fa;this.hw=wa;this.ua=Wa;this.Mb=mb;Kb.execute(nc=>{this.uQ=nc})}HPi(a,b,c){if(a&&a.length){for(var f of a)if(!f||Oe.a.Sw(f.Bb))return;f=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Mb&&1===this.Mb.Xo;var l=this.Fb.ud(15,void 0,()=>{this.Fa.Bf(zi.a.oD);
this.ra.Uh()});try{l.kc(this.Xs),this.EFa?this.Xs.Wue(a,b,c,f):this.Xs.Vue(a[0],b,c,f)}finally{l&&l.dispose()}}}N2f(a,b){var c=this.Qb.Gn;if(c&&c.Ip)if(b&&!a||!b&&a===c.Ip.length-1)Aa.a.J(50856009,822,50,"ExecuteMoveSectionGraphTransaction: User has attempted to move a section out of range.");else{var f=c.Ip,l=Date.now(),x=this.Fb.ud(15,void 0,()=>{},()=>{});try{x.kc(this.Xs);const G=f[a],R=b?f[a-1]:f[a+1];c.setValue(sb.a.igk,G);c.setValue(sb.a.Ofk,R);if(G&&R){let fa=-1,wa=-1;for(let Wa=0;Wa<f.length&&
!(G===f[Wa]&&(fa=Wa),R===f[Wa]&&(wa=Wa),0<=fa&&0<=wa);Wa++);Array.removeAt(f,fa);Array.insert(f,wa,G);c.anchor?c.anchor.Vhb(f,34,!1):Aa.a.J(50856011,822,10,"ExecuteMoveSectionGraphTransaction: Presentation node should have valid anchor.")}}finally{x&&x.dispose()}this.ua.AA=b?0<=a-1?a-1:0:a+1;c=Date.now();Aa.a.J(50954449,822,50,"ExecuteMoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, isMoveUp: {4}",a,l,c,c-l,b);this.hw?this.hw.rEe():
Aa.a.J(51172825,822,10,"ExecuteMoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else Aa.a.J(50856007,808,10,"ExecuteMoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}qPi(a,b){if(a){var c=this.Qb.Gn;if(c){var f=c.Ip;f&&f.length||Aa.a.J(50676770,822,50,"ExecuteAddSectionGraphTransaction: User has added first section.");c=Date.now();var l=this.Fb.ud(15,void 0,()=>{},()=>{});try{l.kc(this.Xs);l.fd=b;const x=f&&f.length?this.Je.$V(a.Bb):0;this.Xs.aob(a,
x)}finally{l&&l.dispose()}this.Xb.Jw(this.Xs,b);b=Date.now();Aa.a.J(50954454,822,50,"ExecuteAddSectionGraphTransaction: selectedSlideIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}",a.slideIndex,c,b,b-c);this.hw?this.hw.rEe():Aa.a.J(51172831,822,10,"ExecuteAddSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else Aa.a.J(50676768,808,10,"ExecuteAddSectionGraphTransaction: pageManifest is null.")}else Aa.a.J(50676766,808,10,"ExecuteAddSectionGraphTransaction: selectedSlideNode is null.")}TPi(a){var b=
this.Qb.Gn;if(b&&b.Ip){var c=b.Ip;if(!a||a.sectionIndex>=c.length)Aa.a.J(50647325,808,10,"ExecuteUpdateSectionGraphTransaction: invalid .");else{var f=b.ofg(a.sectionIndex);c=null;f&&(c=Object(ua.a)(NQ.a,b.Odj(f.mE)));b=Date.now();f=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()},()=>{});try{f.kc(c),c.title=a.xzl}finally{f&&f.dispose()}c=Date.now();Aa.a.J(50954458,822,50,"ExecuteUpdateSectionGraphTransaction: updateSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, ",
a.sectionIndex,b,c,c-b)}}else Aa.a.J(50647323,808,10,"ExecuteUpdateSectionGraphTransaction: pageManifest or SectionNodes are null.")}MPi(a,b){const c=this.Qb.Gn;if(c&&c.Ip){var f=c.Ip,l=this.ua.Yaa,x=Date.now(),G=f.length,R=this.Fb.ud(15,void 0,()=>{},()=>{});try{R.kc(this.Xs);R.fd=b;if(a){const fa=this.Qb.Wtb(a-1);let wa=l.lA;if(fa&&wa){const Wa=fa.lA?fa.lA:[];for(let mb=0;mb<wa.length;mb++)Array.insert(Wa,Wa.length,wa[mb]);wa=[];fa.lA=Wa}}Array.removeAt(f,a);c.MXf(l)}finally{R&&R.dispose()}this.ua.AA=
0<=a-1?a-1:0;this.Xb.Jw(this.Xs,b);b=Date.now();Aa.a.J(50954461,822,50,"ExecuteRemoveSectionGraphTransaction: selectedSectionIndex: {0}, transactionStartTime: {1}, transactionFinishTime: {2}, elapse: {3}, initialSectionArrayLength: {4}, finialSectionArrayLength: {5}",a,x,b,b-x,G,f.length);this.hw?this.hw.dIk(new GM(l)):Aa.a.J(51172866,822,10,"ExecuteRemoveSectionGraphTransaction: graphOperationEventNotifier is null for raising event.")}else Aa.a.J(50689950,808,10,"ExecuteRemoveSectionGraphTransaction: pageManifest or SectionNodes are null.")}ZJc(a,
b,c,f){if(!b||!this.p6j&&!c)return null;let l=null;const x=this.Fb.ud(15,void 0,()=>{re.a("FixDocumentFocusIssue")||this.Fa.Ad();this.ra.Uh()},()=>{1!==this.Mb.Xo&&(re.a("FixDocumentFocusIssue")?this.Fa.Bf(this.Fa.ze.name):this.Fa.Bf(zi.a.oD))});try{const G=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Mb&&1===this.Mb.Xo;let R;R=re.a("SlideSorterInsertionAfterFirstSlide")?!!this.Mb&&1===this.Mb.Xo&&-1===this.Zb.pEb:!!this.Mb&&1===this.Mb.Xo&&!this.Zb.pEb;const fa=this.ua.Yaa;if(G&&
fa&&(!fa.CJ||!fa.CJ.length)||R)R&&(this.Zb.pEb=-1),a=null;x.kc(this.Zb.yf);x.fd=f;l=Object(ua.a)(120,this.Xs.cBc(a,fa,b,c,G));this.ep&&this.ra.bY(l);this.Zb.Ba=l;this.Zb.yf.removeProperty(sb.a.Tze)}finally{x&&x.dispose()}return l}GPi(a,b,c,f,l){if(5!==f)throw Error.invalidOperation();const x=Object(ua.a)(120,this.Xs.JRd(a,b,c));if(!x)return Aa.a.J(51676491,822,10,"CreateSlideNodeForInsertion returned null"),null;b=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Mb&&1===this.Mb.Xo;c=
this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()},()=>{this.ep&&this.ra.bY(x);this.Fa.Bf(zi.a.oD)});try{c.kc(this.Zb.yf),c.fd=l,this.Xs.nvb(x,a,null,b),this.Zb.Ba=x}finally{c&&c.dispose()}return x}APi(a,b){var c=null;if(!a)throw Error.argumentNull("srcSlideNode");c||(c=a);const f=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Mb&&1===this.Mb.Xo;let l=null;const x=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()},()=>{1!==this.Mb.Xo&&this.Fa.Bf(zi.a.oD)});try{x.kc(this.Zb.yf),
x.fd=b,l=Object(ua.a)(120,this.Xs.qS(Object(ua.a)(119,a),Object(ua.a)(119,c),f,!0)),this.uQ&&this.uQ.tYf([l]),this.ep&&this.ra.bY(l),this.Zb.Ba=l}finally{x&&x.dispose()}return l}J2f(a,b,c,f,l){if(!a||!a.length)throw Error.argumentNull("srcSlideNodes");const x=[];a=Array.clone(a);a.sort((fa,wa)=>wa.we-fa.we);c||(c=a[0]);const G=u.AFrameworkApplication.fa.ka("PPTSorterViewEnabled")&&!!this.Mb&&1===this.Mb.Xo,R=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()},()=>{1!==this.Mb.Xo&&this.Fa.Bf(zi.a.oD)});
try{R.kc(this.Zb.yf);R.fd=b;for(b=0;b<a.length;b++){if(!a[b])continue;const wa=Object(ua.a)(120,this.Xs.qS(Object(ua.a)(119,a[b]),Object(ua.a)(119,c),G,l));Ka.a.Va(f)||(wa.Sb=f);Array.add(x,wa)}0<x.length&&this.uQ&&this.uQ.tYf(x);let fa;(fa=this.ra).bY.apply(fa,x);this.Zb.Ba=x[x.length-1];this.Je.L5a=!0}finally{R&&R.dispose()}return x}B2(a,b,c,f=null,l=null,x=!0){if(!a)throw Error.argumentNull("shapeNodes");if(!a.length)throw Error.argumentOutOfRange("shapeNodes.Length",a.length);if(!b)throw Error.argumentNull("slideNode");
if(f&&a.length!==f.length)throw Error.invalidOperation();let G=null;x&&1!==this.Mb.Xo&&(G=()=>{this.ra.mYa(a,!0)});x=this.Fb.ud(15,void 0,()=>{this.ra.Cy();this.ra.Uh();this.Fa.Ad()},G);try{x.kc(b);x.fd=c;this.r4h(x,a);const R=new Sys.StringBuilder;for(c=0;c<a.length;c++){const fa=f?f[c]:null;a[c]&&(b.GB(a[c],fa),a[c].id&&R.append(a[c].id.toString()+";"))}x.Dy[zq.a.g6g]=R.toString();l&&b.gU([l])}finally{x&&x.dispose()}}r4h(a,b){if(1!==b.length||!b[0].qd&&Ka.a.Va(b[0].cXa))for(const c of b){if(c.t9a||
c.wk)a.Dy[zq.a.W2b]=!0;if(c.Tp||2===c.mediaType||1===c.mediaType)a.Dy[zq.a.KQc]=!0;c.Wq&&(a.Dy[zq.a.JQc]=!0)}else a.Dy[zq.a.X2b]=!0}S5a(a,b){if(!(1>b.length)){var c=this.Fb.ud(15);try{c.kc(b[0]);const f=this.ra.wO(Array.isArray(b)?b:null);for(const l of f)a(l)}finally{c&&c.dispose()}}}tia(a,b){this.S5a(c=>{(c=Object(ua.a)(4,c))&&a(c)},b)}}Object(e.a)(HM,"GraphTransactionHelperProxy",null,[1107]);var eA=d(294),fo=d(295);class IM{constructor(a,b,c,f){this.nkc=a;this.okc=b;this.GWc=c;this.HWc=f}vVe(a,
b,c,f){a<this.nkc&&(this.nkc=a);b<this.okc&&(this.okc=b);a+c>this.GWc&&(this.GWc=a+c);b+f>this.HWc&&(this.HWc=b+f)}}Object(e.a)(IM,"GroupShapeOffset",null,[]);class JM{constructor(a,b,c,f,l,x,G,R,fa,wa){this.ia=a;this.Fb=b;this.ra=c;this.Ea=f;this.ua=l;this.Dm=x;this.Mb=G;this.hj=R;this.MI=fa;this.la=wa}ub(){this.ia.pa(ba.a.G7g,sc.a.application,Object(C.a)(this,this.Xnj,"handleGroupShapes"),4);this.ia.pa(ba.a.P7g,sc.a.application,Object(C.a)(this,this.csj,"handleUngroupShapes"),4);this.ia.pa(ba.a.Izk,
sc.a.application,Object(C.a)(this,this.Wnj,"handleGroupFlyoutAnchor"),4)}xe(){const a=this.MI.Bo.Dc(Yb.a.Bg);a.bindAction(A.KeyInputManager.Na(w.a.oLb,A.KeyInputManager.He),ba.a.G7g);a.bindAction(A.KeyInputManager.Na(w.a.oLb,A.KeyInputManager.He|4),ba.a.P7g)}yNf(a){let b=1<a.length&&!a[0].Og&&!a[1].Og;if(b)for(const c of a)if(this.la.dja){if(c.XCb||c.Sk||c.qd){b=!1;break}}else if(c.Sk||c.qd){b=!1;break}return b}M$i(a){a=a.get_shapeRotation()%180;0<=a&&45>a?a=0:45<=a&&135>a?a=90:135<=a&&180>a&&(a=
0);return a}Xnj(a,b,c){const f=this.ra.Yd();return this.yNf(f)?1===c?32:Ag.a("GroupOperations_GroupShapes",a,()=>{const l=[];for(var x of f)l.push(x.id);x=Object(ua.a)(120,this.ua.Ba);if(!x)throw Error.argumentNull("ActiveSlide is null");const G=x.ev(),R=new IM(x.hq,x.Kk,0,0);var fa=0;let wa=fa=0;for(var Wa of f)(fa=this.M$i(Wa),Wa.Ky)?(fa=Wa.fz,wa=Wa.gz,R.vVe(fa,wa,Wa.Lba,Wa.Kba)):fa?90===fa&&(fa=Wa.fz+Wa.Rx/2-Wa.KD/2,wa=Wa.gz+Wa.KD/2-Wa.Rx/2,R.vVe(fa,wa,Wa.KD,Wa.Rx)):(fa=Wa.fz,wa=Wa.gz,R.vVe(fa,
wa,Wa.Rx,Wa.KD));const mb=this.Dm.Y4a(!1,x.Bb.cid,x.Bb.sid,0,10,R.nkc,R.okc,R.GWc-R.nkc,R.HWc-R.okc,G+1);Aa.a.J(595359714,822,50,"GroupUngroupShapesActor::HandleGroupShapes : Group Action performed on {0}",f.length);this.YBj(mb,x.Bb,R.GWc-R.nkc,R.HWc-R.okc);x.GB(mb);Wa=this.Fb.ud(15,void 0,void 0,()=>{this.ra.selectShape(mb,!0)});try{Wa.kc(x),Wa.fd=a,1<l.length&&(x.N7=l)}finally{Wa&&Wa.dispose()}return 32}):8}NNf(a){for(const b of a)if(this.la.dja){if(b.Jf&&!b.YCb)return!0}else if(b.Jf)return!0;return!1}csj(a,
b,c){const f=this.ra.Yd();return this.NNf(f)?1===c?32:Ag.a("GroupOperations_UngroupShapes",a,()=>{const l=[];var x=[];for(const R of f)if(R.Jf){l.push(R.id);const fa=this.Ea.Ow(R);for(const wa of fa)x.push(wa);this.ra.n7(R)}for(var G of x)x=Ni.c(G,this.Mb.Ma),this.ra.n7(G),x.ija(),x.HGb=!0;G=this.ua.Ba;Aa.a.J(595359712,822,50,"GroupUngroupShapesActor::HandleUngroupShapes : Ungroup Action performed on {0}",f.length);x=this.Fb.ud(15);try{x.kc(G),x.fd=a,G.Nna=l}finally{x&&x.dispose()}return 32}):8}Wnj(a,
b,c){b=this.ra.Yd();a=this.yNf(b);b=this.NNf(b);return 1===c?a||b?32:8:32}YBj(a,b,c,f){var l=Object(ua.a)(553,Object(ua.a)(120,this.ua.Ba).sg(this.Mb.Ma));const x=this.Mb.Fd,G=Math.round(this.hj.cM(x.Ie(c,0),l.bW));l=Math.round(this.hj.cM(x.Ie(f,1),l.bW));a.setValue(tb.a.Rx,c);a.setValue(tb.a.KD,f);a.setValue(sb.a.widthPersisted,c);a.setValue(sb.a.heightPersisted,f);a.isEditable=!0;a.Jf=!0;a.setValue(sb.a.cS,4);a.setValue(sb.a.Ued,!0);a.Lba=Re.a.SHa(G,0);a.Kba=Re.a.SHa(l,1);a.setValue(sb.a.zPa,0);
a.setValue(sb.a.APa,0);a.setValue(sb.a.GSa,!0);a.setValue(sb.a.isResizable,!0);a.setValue(sb.a.ZK,!0);a.vN=!0;a.ASa=!0;a.ZK=!0;a.isResizable=!0;a.SF=Oe.a.tE(b.sid,b.cid);a.Ghb=a.get_shapeId();a.setValue(sb.a.Lsa,!0);b=Object.assign(new eA.a,{TopLeft:Object.assign(new fo.a,{X:0,Y:0}),TopRight:Object.assign(new fo.a,{X:G,Y:0}),BottomLeft:Object.assign(new fo.a,{X:0,Y:l}),BottomRight:Object.assign(new fo.a,{X:G,Y:l})});a.jU=b;this.Ea.$K(a)&&Nc.a.Eb&&(Nc.a.Eb.Oj=!0)}}Object(e.a)(JM,"GroupUngroupShapesActor",
null,[229]);class KM{constructor(){this.isFooterInsert=this.omitOnTitle=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.isSlideNumInsert=!1}}Object(e.a)(KM,"FooterPaneInfo",null,[]);var LM=d(608);class AE{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.IsToggled=this.IsSlideNumInsert=this.IsOmitOnTitlePh=this.IsFooterInsert=!1;this.SFooterName=null}}Object(e.a)(AE,"PresFooterInfo",null,[]);var MM=d(634);class NM{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.Ika=null;a("powerpoint-editor-intl").then(()=>
{Aa.a.J(594321887,801,50,"Icons and strings script is loaded successfully");a("headerFooterManager").then(()=>{Aa.a.J(594321885,801,50,"Header Footer Pane Manager script is loaded successfully");this.Ika=headerFooterManager.FactoryGlobal.getHeaderFooterManagerInstance();this.zNk()}).catch(nc=>{Aa.a.J(594321883,801,10,"Failed to load headerfooter pane manager "+nc.toString())})}).catch(nc=>{Aa.a.J(594321881,801,10,"Failed to load powerpoint-editor-intl "+nc.toString())});this.nb=b;this.Ob=c;this.ia=
f;this.Zb=l;this.ua=x;this.Fa=G;this.pv=R;this.Ig=fa;this.od=wa;this.Lc=Wa;this.Fb=mb;this.Ig.UH(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Ig.job(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Ig.vAa(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Lc.JNa(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.od.yAa(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Ob.JM(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"));
this.Ty=null;this.gAb=!1;this.wBb=Kb}dispose(){this.Ig.Y4(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Ig.Sed(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Ig.GXa(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Lc.Efb(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.od.Gfb(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Ob.QX(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"))}xe(){}ub(){this.ia.pa(ba.a.jvb,sc.a.application,
Object(C.a)(this,this.jvb,"insertFooterFlyoutMenu"),4);this.ia.pa(ba.a.H0,sc.a.application,Object(C.a)(this,this.H0,"showHideHeaderFooterPane"),4);this.ia.pa(ba.a.D8a,sc.a.application,Object(C.a)(this,this.D8a,"insertSlideNumber"),4);this.ia.pa(ba.a.ucd,sc.a.application,Object(C.a)(this,this.ucd,"queryHeaderFooterPane"),96)}ucd(a,b,c,f,l){(a=Object(ua.a)(Nh.a,l))&&a.Nf(this.pv.isVisible);return 32}jvb(){return this.Ika&&this.Zb&&this.ua.Ba&&this.Zb.isEditingAllowed?32:8}H0(a,b,c){if(1===c)return this.pv&&
this.ua.Ba?32:8;if(!this.pv)return 8;this.Ty=null;this.pv.isVisible=!this.pv.isVisible;this.pv.isVisible?(Ag.a("FooterPaneOpen",a,()=>{this.Bjc();return 32}),this.wBb||(this.Fa.Gj(Yb.a.PK,!0),this.Ika.focus())):this.Fa.Gj(Yb.a.PK,!1);return 32}D8a(a,b,c,f,l){return 1===c?this.ua.Ba?32:8:Ag.a("FooterPaneInsertSldNumber",a,()=>{const x=this.wgc();this.$oc(x.OmitOnTitlePh,x.IsFooterInsert,x.SFooterName,!0);return this.H0(a,b,c,f,l)})}lw(a){1===a.mode&&this.pv&&this.pv.isVisible&&(this.Ty=null,this.pv.isVisible=
!1,this.Fa.Gj(Yb.a.PK,!1))}b2d(a){const b=new Ha.a;a=a.AD();for(const c of a)(a=yb.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}wgc(){const a=new LM.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ba;if(!b)return a;if((b=b.jl(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.Sk&&(5===c.Cj?a.IsSlideNumInsert=!0:6===c.Cj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.fC?this.b2d(c):"",0<b.length?a.SFooterName=b:Aa.a.J(594321879,822,50,"Footer string is empty")));
a.OmitOnTitlePh=this.Zb.yf.uHa;return a}isMultipleSlidesSelected(){const a=this.nb.nf();return a&&1<a.length?!0:!1}Bjc(){if(this.pv.isVisible)if(this.ua.Ba){var a=this.wgc(),b=this.isMultipleSlidesSelected();if(!this.Ty||a.IsFooterInsert!==this.Ty.IsFooterInsert||a.IsSlideNumInsert!==this.Ty.IsSlideNumInsert||a.OmitOnTitlePh!==this.Ty.OmitOnTitlePh||a.SFooterName.localeCompare(this.Ty.SFooterName)||b!==this.gAb){this.Ty=a;this.gAb=b;var c=new KM;c.isFooterInsert=a.IsFooterInsert;c.isSlideNumInsert=
a.IsSlideNumInsert;c.sFooterName=a.SFooterName;c.omitOnTitle=a.OmitOnTitlePh;c.isMultipleSlidesSelected=b;this.Ika.renderHeaderFooterTaskPane(MM.a.c7d,c)}}else this.pv.isVisible=!1,this.Ty=null}gJ(){this.Bjc()}zNk(){this.Ika.addCloseHeaderFooterPaneEventListener(()=>{this.pv.isVisible=!1;this.Ty=null});this.Ika.addFocusHeaderFooterPaneListener(()=>{this.Fa.Gj(Yb.a.PK,!0)});this.Ika.addUpdateHeaderFooterListener((a,b,c,f,l)=>{this.gVe(a,b,c,f,l)});this.Ika.addUpdateMultiSlideHeaderFooterListener((a,
b,c,f)=>{this.sVe(a,b,c,f)})}gVe(a,b,c,f,l){this.ua.Ba&&(l?this.DVe(a,b,c,f):this.$oc(a,b,c,f))}sVe(a,b,c,f){this.ua.Ba&&Ag.a("FooterPaneMultiSlide",ba.a.H0,()=>{const l=this.Fb.ud(15,void 0,()=>{this.nb.kj()});try{l.kc(this.ua.Ba);const x=this.nb.nf();if(x&&1<x.length){for(const G of x){const R=G.w7;R.IsSlideNumInsert=f;R.IsFooterInsert=b;R.OmitOnTitlePh=a;R.SFooterName=c;R.IsToggled=!R.IsToggled;G.w7=R}this.Zb.yf.uHa=a}}finally{l&&l.dispose()}return 32})}$oc(a,b,c,f){let l="FooterPaneSingleSlide";
const x=this.ua.Ba,G=x.w7;if(a||b||f)G.OmitOnTitlePh!==a?l+="_OPH":G.IsSlideNumInsert!==f?l+="_ISN":G.IsFooterInsert!==b&&(l+="_IFT");Ag.a(l,ba.a.H0,()=>{const R=this.Fb.ud(15,void 0,()=>{this.nb.kj()});try{R.kc(this.ua.Ba),G.IsSlideNumInsert=f,G.IsFooterInsert=b,G.OmitOnTitlePh=a,G.SFooterName=c,G.IsToggled=!G.IsToggled,this.Zb.yf.uHa=a,x.w7=G}finally{R&&R.dispose()}return 32})}DVe(a,b,c,f){Ag.a("FooterPaneAllSlides",ba.a.H0,()=>{const l=this.Fb.ud(15,void 0,()=>{this.nb.kj()});try{const x=this.Zb.yf;
l.kc(x);let G=x.ZHa;G||(G=new AE);const R=this.ua.Ba;G.ActiveSlideCid=R.cid;G.ActiveSlideSid=R.sid;G.IsSlideNumInsert=f;G.IsFooterInsert=b;G.IsOmitOnTitlePh=a;G.SFooterName=c;G.IsToggled=!G.IsToggled;x.uHa=a;x.ZHa=G}finally{l&&l.dispose()}return 32})}}Object(e.a)(NM,"HeaderFooterPaneActor",null,[229]);class OM{constructor(){this.isFooterInsert=!1;this.sFooterName=null;this.isMultipleSlidesSelected=this.omitOnTitle=this.isSlideNumInsert=!1}}Object(e.a)(OM,"FooterPaneInfo",null,[]);class PM{constructor(){this.type=
"HeaderFooterContentProps";this.onFocusPane=this.onUpdateMultiSlideHeaderFooter=this.onUpdateHeaderFooter=this.activeSlideFooterInfo=null}}Object(e.a)(PM,"HeaderFooterContentProps",null,[]);class QM{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.g0c=!1;Kb?this.g0c=!0:a("powerpoint-editor-intl").then(()=>{Aa.a.J(590210325,801,50,"Icons and strings script is loaded successfully");a("powerpoint-ribbon-intl").then(()=>{Aa.a.J(590210323,801,50,"Ribbon script is loaded successfully");a("taskPanes").then(()=>
{Aa.a.J(590210321,801,50,"Header Footer Pane script is loaded successfully");this.g0c=!0}).catch(()=>{Aa.a.J(590210319,801,10,"Failed to load Header Footer Pane script")})}).catch(()=>{Aa.a.J(590210317,801,10,"Failed to load Ribbon script")})}).catch(nc=>{Aa.a.J(590210315,801,10,"Failed to load powerpoint-editor-intl "+nc.toString())});this.nb=b;this.Ob=c;this.ia=f;this.Zb=l;this.ua=x;this.pv=R;this.Ig=fa;this.od=wa;this.Lc=Wa;this.Fb=mb;this.Ig.UH(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));
this.Ig.job(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Ig.vAa(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Lc.JNa(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.od.yAa(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Ob.JM(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"));this.Ty=null;this.gAb=!1;this.wBb=Kb}dispose(){this.Ig.Y4(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Ig.Sed(Object(C.a)(this,this.gJ,
"onChangeRenderHeaderFooterPane"));this.Ig.GXa(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Lc.Efb(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.od.Gfb(Object(C.a)(this,this.gJ,"onChangeRenderHeaderFooterPane"));this.Ob.QX(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"))}xe(){}ub(){this.ia.pa(ba.a.jvb,sc.a.application,Object(C.a)(this,this.jvb,"insertFooterFlyoutMenu"),4);this.ia.pa(ba.a.H0,sc.a.application,Object(C.a)(this,this.H0,"showHideHeaderFooterPane"),
4);this.ia.pa(ba.a.D8a,sc.a.application,Object(C.a)(this,this.D8a,"insertSlideNumber"),4)}jvb(){return this.Zb&&this.ua.Ba&&this.Zb.isEditingAllowed?32:8}H0(a,b,c){if(1===c)return this.g0c?32:8;if(!this.pv)return 8;this.Ty=null;this.pv.isVisible=!this.pv.isVisible;this.pv.isVisible?Ag.a("WACFooterPaneOpen:: IsTabbedPaneEnabled: "+this.wBb.toString(),a,()=>{this.Bjc();return 32}):this.Ns();return 32}lw(a){1===a.mode&&this.pv&&this.pv.isVisible&&(this.Ty=null,this.pv.isVisible=!1,this.Ns())}Tl(a=!1){const b=
this.YB(),c=Object.assign(new ju.a,{title:ResourceStrings.l_InsertFooter,hideHeader:!1,width:320,location:2,contentProps:b,onOpen:()=>{},onClose:()=>{this.pv.isVisible=!1},isModernPane:!0});this.wBb?Ej.UISurfaces.Ms().then(f=>{a?f.updateTaskPane(Yb.a.PK,c):f.showTaskPane(Yb.a.PK,c);return null}):(this.pv.isVisible=!0,taskPanes.taskPane.renderTaskPane(MM.a.c7d,c))}Ns(){this.wBb&&Ej.UISurfaces.Ms().then(a=>{a.hideTaskPane(Yb.a.PK,2);return null})}YB(){const a=new OM;a.isFooterInsert=this.Ty.IsFooterInsert;
a.sFooterName=this.Ty.SFooterName;a.isSlideNumInsert=this.Ty.IsSlideNumInsert;a.omitOnTitle=this.Ty.OmitOnTitlePh;a.isMultipleSlidesSelected=this.gAb;const b=new PM;b.activeSlideFooterInfo=a;b.onUpdateHeaderFooter=Object(C.a)(this,this.gVe,"updateFooterInfo");b.onUpdateMultiSlideHeaderFooter=Object(C.a)(this,this.sVe,"updateMultiSlidesFooterInfo");return b}D8a(a,b,c,f,l){return 1===c?this.g0c?32:8:Ag.a("WACFooterPaneInsertSldNumber:: IsTabbedPaneEnabled: "+this.wBb.toString(),a,()=>{const x=this.wgc();
this.$oc(x.OmitOnTitlePh,x.IsFooterInsert,x.SFooterName,!0);return this.H0(a,b,c,f,l)})}b2d(a){const b=new Ha.a;a=a.AD();for(const c of a)(a=yb.ParagraphReader.text(c))&&0<a.length&&b.add(a);return b.toArray().join(" ")}wgc(){const a=new LM.a;a.IsSlideNumInsert=!1;a.IsFooterInsert=!1;a.SFooterName="";var b=this.ua.Ba;if(!b)return a;if((b=b.jl(!0))&&0<b.length)for(const c of b)!c.isLocal&&c.Sk&&(5===c.Cj?a.IsSlideNumInsert=!0:6===c.Cj&&(a.IsFooterInsert=!0,b=c.isEditable&&!c.fC?this.b2d(c):"",0<b.length?
a.SFooterName=b:Aa.a.J(590210313,822,50,"Footer string is empty")));a.OmitOnTitlePh=this.Zb.yf.uHa;return a}isMultipleSlidesSelected(){const a=this.nb.nf();return a&&1<a.length?!0:!1}Bjc(a=!1){if(this.pv.isVisible)if(this.ua.Ba){var b=this.wgc(),c=this.isMultipleSlidesSelected();if(!this.Ty||b.IsFooterInsert!==this.Ty.IsFooterInsert||b.IsSlideNumInsert!==this.Ty.IsSlideNumInsert||b.OmitOnTitlePh!==this.Ty.OmitOnTitlePh||b.SFooterName.localeCompare(this.Ty.SFooterName)||c!==this.gAb)this.Ty=b,this.gAb=
c,this.Tl(a)}else this.pv.isVisible=!1,this.Ty=null}gJ(){this.Bjc(!0)}gVe(a,b,c,f,l){this.ua.Ba&&(f?this.DVe(a,b,l,c):this.$oc(a,b,l,c))}sVe(a,b,c,f){this.ua.Ba&&Ag.a("FooterPaneMultiSlide",ba.a.H0,()=>{const l=this.Fb.ud(15,void 0,()=>{this.nb.kj()});try{l.kc(this.ua.Ba);const x=this.nb.nf();if(x&&1<x.length){for(const G of x){const R=G.w7;R.IsSlideNumInsert=c;R.IsFooterInsert=b;R.OmitOnTitlePh=a;R.SFooterName=f;R.IsToggled=!R.IsToggled;G.w7=R}this.Zb.yf.uHa=a}}finally{l&&l.dispose()}return 32})}$oc(a,
b,c,f){let l="FooterPaneSingleSlide";const x=this.ua.Ba,G=x.w7;if(a||b||f)G.OmitOnTitlePh!==a?l+="_OPH":G.IsSlideNumInsert!==f?l+="_ISN":G.IsFooterInsert!==b&&(l+="_IFT");Ag.a(l,ba.a.H0,()=>{const R=this.Fb.ud(15,void 0,()=>{this.nb.kj()});try{R.kc(this.ua.Ba),G.IsSlideNumInsert=f,G.IsFooterInsert=b,G.OmitOnTitlePh=a,G.SFooterName=c,G.IsToggled=!G.IsToggled,this.Zb.yf.uHa=a,x.w7=G}finally{R&&R.dispose()}return 32})}DVe(a,b,c,f){Ag.a("FooterPaneAllSlides",ba.a.H0,()=>{const l=this.Fb.ud(15,void 0,
()=>{this.nb.kj()});try{const x=this.Zb.yf;l.kc(x);let G=x.ZHa;G||(G=new AE);const R=this.ua.Ba;G.ActiveSlideCid=R.cid;G.ActiveSlideSid=R.sid;G.IsSlideNumInsert=f;G.IsFooterInsert=b;G.IsOmitOnTitlePh=a;G.SFooterName=c;G.IsToggled=!G.IsToggled;x.uHa=a;x.ZHa=G}finally{l&&l.dispose()}return 32})}}Object(e.a)(QM,"HeaderFooterPaneWacActor",null,[229]);class RM{constructor(a,b,c,f,l){this.xv=a;this.ia=b;this.Zb=c;this.ua=f;this.Xb=l}ub(){this.ia.pa(ba.a.kSc,Bb.a.application,Object(C.a)(this,this.poj,"handleInsertContentFromStream"),
4)}xe(){}poj(a,b,c,f,l){b=this.ua.Ba;if(this.Xb.Zc(b))return 16;if(1===c)return 32;Nc.a.qk("SlideCount","1");this.xv.GPi(b,l.streamUrl,l.formatType,l.objectType,a).yN||this.Xb.Jw(this.Zb.yf,a);return 32}}Object(e.a)(RM,"InsertContentFromStreamActor",null,[229]);class SM{constructor(a,b){this.hj=a;this.Qb=b}ULd(a,b,c,f){const l=G=>this.hj.cM(a.Ie(Re.a.Ff(G,0),0),f),x=Math.round(l(c.x+b.width))-Math.round(l(c.x));b=Math.round(l(c.y+b.height))-Math.round(l(c.y));return Object.assign(new eA.a,{TopLeft:Object.assign(new fo.a,
{X:0,Y:0}),TopRight:Object.assign(new fo.a,{X:x,Y:0}),BottomLeft:Object.assign(new fo.a,{X:0,Y:b}),BottomRight:Object.assign(new fo.a,{X:x,Y:b})})}HPd(a,b,c){var f=a?a.s6d:9;const l=Re.a.Ie(a?a.LWe:6,0,!1);f=Re.a.Ie(f,1,!1);b=this.Ssi(l,f,b,c);a=a?a.Ftb(b.width,b.height,!0):this.Qb.hsa(b.width,b.height);return{cXd:b,MC:a}}Ssi(a,b,c,f){let l=0,x=0;0<c&&0<f&&(a=Math.min(1*a/c,1*b/f,1),l=Math.max(c*a,1),x=Math.max(f*a,1));return new dr.a(l,x)}}Object(e.a)(SM,"InsertImageHelper",null,[1138]);class be{constructor(a,
b,c,f){this.gZa=a;this.shapeType=b;this.height=c;this.width=f}}Object(e.a)(be,"AutoShapeProps",null,[]);class ou{static GRd(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc){x=mb.Y4a(!1,a.cid,a.sid,0,b.shapeType,x,G,R,fa,wa+1);x.setValue(sb.a.cS,b.gZa);({Kph:f,Cph:nc}=l.Dfg(f,b,c,oc,Kb,nc));Kb=Kb.Fd;x.setValue(tb.a.Rx,Kb.Ff(oc.YL(f,c),0));x.setValue(tb.a.KD,Kb.Ff(oc.YL(nc,c),1));x.setValue(sb.a.widthPersisted,x.Rx);x.setValue(sb.a.heightPersisted,x.KD);x.setValue(sb.a.Ued,!0);x.Lba=Re.a.SHa(f,0);x.Kba=Re.a.SHa(nc,
1);x.setValue(sb.a.zPa,0);x.setValue(sb.a.APa,0);x.setValue(sb.a.GSa,!0);x.setValue(sb.a.isResizable,!0);x.setValue(sb.a.ZK,!0);x.vN=!0;x.ASa=!0;oc=(Kb=95===b.gZa||97===b.gZa)||Array.contains(ou.fCg,b.gZa);x.ZK=!Kb;x.isResizable=!0;x.setValue(sb.a.Ky,Kb);x.setValue(sb.a.a_,95===b.gZa);x.SF=Oe.a.tE(a.sid,a.cid);x.Ghb=x.get_shapeId();x.setValue(sb.a.Lsa,!0);a=l.RTf(f,nc,c);x.jU=a;(Wa.$K(x)||Wa.Eja(x))&&Nc.a.Eb&&(Nc.a.Eb.Oj=!0);oc?l.unh(x):l.Fnh(x);return x}}ou.fCg=[88,93,94,89,90,91,92];Object(e.a)(ou,
"InsertContentShapeNodeFactory",null,[]);class TM{Dfg(a,b,c,f){b=a.right-a.left;let l=a.bottom-a.top;b=Math.max(b,1);l=Math.max(l,1);re.a("FixInkDotInsertionAtHighZooms")?(a=f.cM(b,c),c=f.cM(l,c)):(a=Math.round(f.cM(b,c)),c=Math.round(f.cM(l,c)));return{Kph:a,Cph:c}}RTf(a,b,c){return Object.assign(new eA.a,{TopLeft:Object.assign(new fo.a,{X:0,Y:0}),TopRight:Object.assign(new fo.a,{X:a*c,Y:0}),BottomLeft:Object.assign(new fo.a,{X:0,Y:b*c}),BottomRight:Object.assign(new fo.a,{X:a*c,Y:b*c})})}unh(){}Fnh(){}}
Object(e.a)(TM,"InsertInkActorHelper",null,[1401]);var OQ=d(496);class fA{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.V8=Kb;this.xv=a;this.ia=b;this.ua=c;this.Xb=f;this.Mb=l;this.Yx=R;this.Dm=fa;this.ol=wa;this.Ea=Wa;this.hj=mb}dispose(){}ub(){this.ia.pa(ba.a.kpg,Bb.a.application,Object(C.a)(this,this.qoj,"handleInsertInk"),4)}xe(){}qoj(a,b,c,f,l){if(!l)return 16;b=l.Ed;if(!b)return Aa.a.J(595080221,822,15,"HandleInsertInk was called with invalid slideNode!"),8;f=b.Bb;if(Oe.a.Sw(f)||this.Xb.Zc(b))return 16;
if(1===c)return 32;c=this.m0b(a);if(!c)return 8;if(!this.ol.yI(b,1))return this.ol.AJ(b),16;var x=l.JBj;if(!x)return Aa.a.J(595153805,822,15,"HandleInsertInk was called with invalid actionData!"),8;if(!x.count)return Aa.a.J(595153803,822,15,"HandleInsertInk was called with 0 ink objects!"),8;l=new Ha.a;for(let Wa of x){x=Wa.Uei;if(!x)return 16;var G=b.Fw;G=G&&null!=G.Pr?G.Pr:1;x.right=x.left+(x.right-x.left)/(1/G);x.bottom=x.top+(x.bottom-x.top)/(1/G);var R=x.right-x.left,fa=x.bottom-x.top;R=Math.max(R,
1);fa=Math.max(fa,1);var wa=this.Mb.Fd;R=Re.a.Ff(R,0);fa=Re.a.Ff(fa,1);const mb=wa.Ff(x.left,0);wa=wa.Ff(x.top,1);const Kb=b.ev();x=ou.GRd(f,c,G,x,new TM,mb,wa,R,fa,Kb,this.Ea,this.Dm,this.Mb,this.ua,this.hj);x.setValue(sb.a.rja,Wa.json);x.setValue(sb.a.UDa,!0);Nc.a.Eb&&(Nc.a.Eb.actionName=fA.gQc);x.WH=new OQ.a([Wa.stroke],Wa.json,!1);l.add(x)}this.xv.B2(l.toArray(),b,a,void 0,void 0,!1);for(let Wa of l)this.V8.registerInkWithStrokeCollection(Wa.WH.Axa,Wa.id);this.Yx.CI=l.ga(l.count-1);return 32}m0b(){return new be(4,
10,1,1)}}fA.gQc="InsertInk";Object(e.a)(fA,"InsertInkActor",null,[229,106]);class UM{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa){this.Fj=null;this.J0c=!1;this.Mb=a;this.Dm=b;this.Fa=c;this.ua=f;this.Qb=l;this.ra=G;this.Yx=R;this.ol=fa;this.Fb=wa;this.Xb=Wa;this.la=x;this.Fzl=x.insertOnlineVideoUrlPatterns;this.thh=x.insertOnlineVideoEndpoint;this.ew=u.AFrameworkApplication.Ge;this.vol=3E4}get startTime(){return this.Fj}LQi(a){if(!a)return null;const b=a.trim();this.FJj(b)&&(Aa.a.J(38322700,352,50,"[Insert Online Video] Used iframe instead of url"),
a=this.MQi(b));return a}FAg(a){if(!a)return!1;a=a.trim();for(const b of this.Fzl)if((new RegExp(b)).test(a))return!0;return!1}uSj(a){if(!a)return!1;a=a.trim();a=Ze.a.yD(a).toLowerCase();return!this.la.Y8a&&"shorts.flipgrid.com"===a||"flipgrid.com"===a||"www.flipgrid.com"===a||!this.la.Xwb&&("embed.ted.com"===a||"www.ted.com"===a||"ted.com"===a)?!1:!0}qsl(a,b){this.requestVideoData(a,c=>{this.isg(c)},b)}requestVideoData(a,b,c){this.J0c?Aa.a.J(38901280,352,15,"[Insert Online Video] Multiple videos at the same time!"):
(this.J0c=!0,c=c||Object(C.a)(this,this.aKi,"doNothingCallback"),this.Fj=new Date,a=Ka.a.Qe(a),a=this.thh+(0<this.thh.indexOf("?")?"&":"?")+"url="+a,this.ew.yj(a,1,null,null,!1,2,f=>{b(f);this.J0c=!1},f=>{c(f);this.J0c=!1},null,void 0,void 0,void 0,this.vol,Ax.a("1")))}isg(a){var b=+new Date-+this.startTime;Aa.a.J(38322702,352,50,"[Insert Online Video] Success!!! Hubble call completed in {0}ms",b);Nc.a.qk("HubbleCallDuration",b.toString());if((b=this.ua.Ba)&&!this.Xb.Zc(b)&&this.ol.yI(b,1))try{const R=
b.L2(this.ra.Yd());if(!R||!this.Xb.Zc(R)){var c=this.x7a(b,R),f=JSON.parse(a.data.Sd),l=f.width,x=f.height;c.iLe(f.embed_url,f.thumbnail_url,f.title,f.description,0<l?l:0,0<x?x:0);var G=this.Fb.ud(15,void 0,()=>{this.ra.Cy();this.ra.Uh();this.Fa.Ad()},()=>{this.ra.selectShape(c,!0)});try{G.gd(b),this.la.vql&&(G.fd=ba.a.ADa,G.Dy[zq.a.PBa]=zq.a.online),R&&b.gU([R]),b.GB(c)}finally{G&&G.dispose()}this.Xb.Jw(b,"InsertOnlineVideo");this.Yx.CI=c;Aa.a.J(38322704,352,50,"[Insert Online Video] Video inserted")}}catch(R){Aa.a.J(38322706,
352,10,"[Insert Online Video] Exception after successful Hubble callback: Exception = [{0}], stack = {1}.",R.message,R.stack)}else this.ol.AJ(b)}aKi(){}x7a(a,b){if(!a)return null;var c=a.Bb;a=a.ev();let f;const l=sf.a.uX,x=sf.a.E4;f=b?b.Ftb(sf.a.uX,sf.a.E4):this.Qb.hsa(sf.a.uX,sf.a.E4);const G=b?0:0*Dq.a.a7;c=this.Dm.Qqa(!0,c.cid,c.sid,0,f.x+G,f.y+G,l,x,a+1,!0);b&&(c.kba=b.id);return c}MQi(a){if(!a)return null;a=RegExp("src\\s*=\\s*['\"][^'\"]*").exec(a);if(!a||1!==a.length)return Aa.a.J(38322708,
352,10,"[Insert Online Video] iframe error"),null;a=a[0];let b=a.indexOf('"');-1===b&&(b=a.indexOf("'"));return a=a.substr(b+1)}FJj(a){return a?RegExp(".*iframe.*").test(a):!1}qag(a){if(!a)return"NA";let b=a.indexOf(".com/");if(-1===b)return"NA";if(a.startsWith("https://"))a=a.substring(8,b);else if(a.startsWith("http://"))a=a.substring(7,b);else return"NA";b=a.lastIndexOf(".");return-1===b?a:a.substr(b+1)}}Object(e.a)(UM,"InsertOnlineVideoDialogHelper",null,[1108]);class BE{constructor(){this.limField=
0;this.limFieldSpecified=!1}}Object(e.a)(BE,"CT_LineJoinMiterProperties",null,[]);class gA{constructor(){this.algnField=0;this.algnFieldSpecified=!1;this.bevelField=null;this.capField=0;this.capFieldSpecified=!1;this.cmpdField=0;this.cmpdFieldSpecified=!1;this.tailEndField=this.solidFillField=this.roundField=this.prstDashField=this.pattFillField=this.noFillField=this.miterField=this.headEndField=this.gradFillField=this.extLstField=this.custDashField=null;this.wField=0;this.wFieldSpecified=!1}}Object(e.a)(gA,
"CT_LineProperties",null,[]);class VM{constructor(){this.valField=0}}Object(e.a)(VM,"CT_PositiveFixedPercentage",null,[]);class hA{constructor(){this.valField=0;this.valFieldSpecified=!1}}Object(e.a)(hA,"CT_PresetLineDashProperties",null,[]);class CE{Dfg(a,b,c,f,l,x){a=Object(ua.a)(553,x.Ba.sg(l.Ma));c=l.Fd;l=Math.round(f.cM(c.Ie(b.width*we.a.fJ,0),a.bW));b=Math.round(f.cM(c.Ie(b.height*we.a.fJ,1),a.bW));return{Kph:l,Cph:b}}RTf(a,b){return Object.assign(new eA.a,{TopLeft:Object.assign(new fo.a,{X:0,
Y:0}),TopRight:Object.assign(new fo.a,{X:a,Y:0}),BottomLeft:Object.assign(new fo.a,{X:0,Y:b}),BottomRight:Object.assign(new fo.a,{X:a,Y:b})})}unh(a){a.lineStyle=Object.assign(new gA,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new BE,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new hA,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new Nq.a,{schemeClrField:Object.assign(new cn.a,{valField:4})}),
wField:6350,wFieldSpecified:!0})}Fnh(a){a.fill=Object.assign(new Mz.a,{solidFillField:Object.assign(new Nq.a,{schemeClrField:Object.assign(new cn.a,{valField:4})})});a.lineStyle=Object.assign(new gA,{algnField:0,algnFieldSpecified:!0,capField:2,capFieldSpecified:!0,cmpdField:0,cmpdFieldSpecified:!0,miterField:Object.assign(new BE,{limField:8E5,limFieldSpecified:!0}),prstDashField:Object.assign(new hA,{valField:0,valFieldSpecified:!0}),solidFillField:Object.assign(new Nq.a,{schemeClrField:this.yCi(Object.assign(new VM,
{valField:5E4}))}),wField:12700,wFieldSpecified:!0})}yCi(a){const b={itemsElementNameField:[26]};b.itemsField=[a];b.valField=4;return b}}Object(e.a)(CE,"InsertShapeActorHelper",null,[1401]);class Pj{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg){this.t2c=this.qbb=0;if(!Hc)throw Error.argumentNull("insertShapeOverlayViewStateManager");if(!Te)throw Error.argumentNull("appFrame");if(!We)throw Error.argumentNull("viewEventNotifier");this.xv=a;this.ia=b;this.Fa=c;this.ra=
f;this.ska=0;this.ua=fa;this.Xb=l;this.Mb=x;this.ZEa=G;this.Yx=Wa;this.hPg=R;this.Ig=wa;this.Xs=fa.presentation;this.Dm=mb;this.ol=Kb;this.l5j=nc;this.sBb=oc;this.Ea=Ic;this.hj=Kc;this.nzb=Hc;this.wda=ie;this.v$b=He;this.y4j=fe;this.Ob=Te;this.Ee=We;this.bhe=Qf;this.UQg=mg;this.Ig.UH(Object(C.a)(this,this.QWa,"onSlideNavigation"));this.hPg.Yj(Object(C.a)(this,this.aeb,"onPresentationPropertyChanged"));this.v$b&&(this.Ob.JM(Object(C.a)(this,this.lw,"onAppFrameModeSwitched")),this.Ee.z3a(Object(C.a)(this,
this.e$,"onRibbonTabSwitched")),this.Ee.j5h(Object(C.a)(this,this.r_g,"onEscapeKeyPressed")));Pj.b8c.push(ba.a.$8d);Pj.b8c.push(ba.a.Y8d);this.TMf()}dispose(){this.hPg.tm(Object(C.a)(this,this.aeb,"onPresentationPropertyChanged"));this.Ig.Y4(Object(C.a)(this,this.QWa,"onSlideNavigation"));this.v$b&&(this.Ob.QX(Object(C.a)(this,this.lw,"onAppFrameModeSwitched")),this.Ee.TFb(Object(C.a)(this,this.e$,"onRibbonTabSwitched")),this.Ee.eRk(Object(C.a)(this,this.r_g,"onEscapeKeyPressed")))}ub(){for(const a of Pj.qnl)this.ia.pa(a,
Bb.a.application,Object(C.a)(this,this.Qjg,"handleInsertShape"),4);for(const a of Pj.a8c)this.ia.pa(a,Bb.a.application,Object(C.a)(this,this.Qjg,"handleInsertShape"),4);this.ia.pa(ba.a.wSc,Bb.a.application,Object(C.a)(this,this.soj,"handleInsertShapeAtSpecifiedLocation"),4);this.ia.pa(ba.a.xSc,Bb.a.application,Object(C.a)(this,this.toj,"handleInsertShapeTextBoxAtSpecifiedLocation"),4);this.ia.pa(ba.a.uli,Bb.a.application,Object(C.a)(this,this.kjg,"handleCancelInsertShape"),4);this.ia.pa(ba.a.UNf,
Bb.a.application,Object(C.a)(this,this.kjg,"handleCancelInsertShape"),4);this.ia.pa(ba.a.D5a,Bb.a.application,Object(C.a)(this,this.qnj,"handleDuplicateShape"),4)}xe(){this.Fa.Dc(Yb.a.Bg).bindAction(A.KeyInputManager.Na(w.a.HKa,A.KeyInputManager.He),ba.a.D5a);this.Fa.Dc(Yb.a.LP).bindAction(A.KeyInputManager.Na(w.a.HKa,A.KeyInputManager.He),ba.a.D5a)}TMf(){if(this.Xs){var a=Math.min(this.Xs.Qgl,this.Xs.ugl);a=Math.max(a-50,0);this.qbb=Math.floor(a/(2*Dq.a.a7))-1;this.qbb=Math.max(this.qbb,0);this.t2c=
-1*this.qbb}else this.qbb=1,this.t2c=-1}aeb(a,b){b.property!==sb.a.slideWidth&&b.property!==sb.a.slideHeight||this.TMf()}QWa(){this.ska=0;this.v$b&&this.Vxa(0)}lw(a){1===a.mode&&this.Vxa(0)}e$(){this.Vxa(0)}r_g(){this.Vxa(0)}Vxa(a){1===a&&this.Fa.Ad();this.nzb.Ryh(a)}Qjg(a,b,c,f,l){b=this.ua.Ba;if(!b)return 16;f=b.Bb;if(Oe.a.Sw(f)||this.Xb.Zc(b))return 16;if(1===c)return 32;c=this.m0b(a);if(!c)return 8;if(!this.ol.yI(b,1))return this.ol.AJ(b),16;const x=this.l5j&&this.sBb.uN;var G=b.Pe.HasDefaultShape,
R=b.Pe.HasDefaultLine,fa=95===c.gZa||97===c.gZa||Array.contains(ou.fCg,c.gZa);R=R&&fa;G=G&&!fa;fa=!1;l&&(sn.a.jv in l?l=l[sn.a.jv]:(Aa.a.J(512349792,829,15,"actionData {0} does not contain the InputMethod",l),l=0),fa=!Array.contains(Pj.Lhk,l));if(fa){if(a===ba.a.mvb)return this.Vxa(1),this.wda.instance.lvb=-1,32;if(x&&!Array.contains(Pj.b8c,a)&&!G&&!R){this.Vxa(2);if(null==this.wda.instance)throw Error.argumentNull("insertShapeOverlayViewElement");this.wda.instance.lvb=a;return 32}}this.Vxa(0);let wa,
Wa;var mb=this.Xs.slideWidth,Kb=this.Xs.slideHeight;fa=new zc.a((mb-c.width*we.a.fJ)/2,(Kb-c.height*we.a.fJ)/2);l=fa.x+Re.a.Ff(this.ska*Dq.a.a7,0);Wa=fa.y+Re.a.Ff(this.ska*Dq.a.a7,1);x?(fa=c.width*we.a.fJ,wa=c.height*we.a.fJ):(fa=Re.a.Ff(Pj.sMf,0),wa=Re.a.Ff(Pj.rMf,1),l=mb/2-Re.a.Ff(Pj.sMf/2-this.ska*Dq.a.a7,0),Wa=Kb/2-Re.a.Ff(Pj.rMf/2-this.ska*Dq.a.a7,1));this.ska++;this.ska>this.qbb&&(this.ska=this.t2c);mb=b.ev();Kb=Object(ua.a)(553,this.ua.Ba.sg(this.Mb.Ma));Nc.a.Eb&&(R||G)&&Nc.a.Eb.Wa(si.a.q4f,
R?"HasDefaultLine":"HasDefaultShape");!x||a===ba.a.mvb||Array.contains(Pj.b8c,a)||G||R?f=this.Dm.Y4a(!1,f.cid,f.sid,0,c.shapeType,l,Wa,fa,wa,mb+1):(f=ou.GRd(f,c,Kb.bW,null,new CE,l,Wa,fa,wa,mb,this.Ea,this.Dm,this.Mb,this.ua,this.hj),Nc.a.Eb&&(Nc.a.Eb.actionName=Pj.gQc));re.a("MoveCursorToTextboxAfterKeyboardInsert")&&a===ba.a.mvb&&(this.FDf(),this.gbb=f);f.isEditable=!Array.contains(Pj.a8c,a);this.xv.B2([f],b,a);this.Yx.CI=f;this.pTe();return 32}FDf(){this.Mme||(this.UQg.$pa(this.jkh.bind(this)),
this.Ig.GBc(this.NVg.bind(this)),this.Mme=!0)}eQk(){this.Mme&&(this.UQg.wjc(this.jkh.bind(this)),this.Ig.Ifh(this.NVg.bind(this)),this.Mme=!1)}jkh(a,b){a=b.node;null!=a&&a==this.gbb&&(this.gbb=a,this.uMg=b.revisionId.toString())}NVg(a,b){b.o$&&b.o$.Id&&this.uMg==b.o$.Id&&(null==this.gbb||this.bhe.Osa(this.gbb)||setTimeout(()=>{this.ia.La(ba.a.cOa,2,new jn.a(this.gbb,!0,null));this.eQk();this.uMg=this.gbb=null},0))}toj(a,b,c,f,l){if(1===c)return 2;this.Vxa(0);b=this.ua.Ba;if(!b)return 16;c=b.Bb;if(Oe.a.Sw(c)||
this.Xb.Zc(b))return 16;f=this.m0b(a);if(!f)return 16;if(!this.ol.yI(b,1))return this.ol.AJ(b),16;this.ska++;this.ska>this.qbb&&(this.ska=this.t2c);if(!re.a("IsAnyOffsetZeroForTextbox")){if(!(l&&l.left&&l.right&&l.bottom&&l.top))return Aa.a.J(512349791,829,10,"Invalid offsets : {0}",l),16}else if(!l)return Aa.a.J(512336011,829,10,"Invalid offsets"),16;const x=this.ua.Ba.Fw.Pr;let G=Re.a.Ff(this.hj.cM(l.right-l.left,x),0),R=Re.a.Ff(this.hj.cM(l.bottom-l.top,x),1);R||G||(this.y4j?(G=f.width*we.a.fJ,
R=f.height*we.a.fJ):(G=Re.a.Ff(Pj.sii,0),R=Re.a.Ff(Pj.rii,1)));G=G?G:Re.a.Ff(Pj.Tii,0);R=R?R:Re.a.Ff(Pj.Sii,1);const fa=Re.a.Ff(this.hj.cM(l.left,x),0);l=Re.a.Ff(this.hj.cM(l.top,x),1);l=this.Dm.Y4a(!1,c.cid,c.sid,0,f.shapeType,fa,l,G,R,b.ev()+1);if(!l)return Aa.a.J(512349790,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;re.a("MoveCursorToTextboxAfterInsert")&&this.FDf();l.isEditable=!Array.contains(Pj.a8c,a);this.gbb=l;this.xv.B2([l],b,a);this.Yx.CI=l;this.pTe();Aa.a.J(512349789,
829,50,"Successfully inserted the textbox at specified location");return 32}soj(a,b,c,f,l){if(1===c)return Aa.a.J(512349511,829,10,"behavior is ActionBehavior.isEnabled"),2;this.Vxa(0);b=this.ua.Ba;if(!b)return Aa.a.J(512349510,829,10,"slideNode is null"),16;c=b.Bb;if(Oe.a.Sw(c))return Aa.a.J(512349509,829,10,"slideNode is fake"),16;if(this.Xb.Zc(b))return Aa.a.J(512349508,829,10,"GraphNodeAndParent is blocked"),16;f=this.m0b(l.insertShapeActionId);if(!f)return Aa.a.J(512349507,829,10,"autoShapeProps is null"),
16;if(!this.ol.yI(b,1))return this.ol.AJ(b),16;var x=l.offsets;if(!x)return Aa.a.J(512349788,829,10,"Invalid offsets"),16;const G=this.ua.Ba.sg(this.Mb.Ma);let R=this.Mb.Fd.Ff(x.right-x.left,0),fa=this.Mb.Fd.Ff(x.bottom-x.top,1);fa||R||(R=f.width*we.a.fJ,fa=f.height*we.a.fJ);const wa=this.Mb.Fd.Ff(x.left,0);x=this.Mb.Fd.Ff(x.top,1);f.height=fa/we.a.fJ;f.width=R/we.a.fJ;const Wa=b.ev();c=ou.GRd(c,f,G.bW,null,new CE,wa,x,R,fa,Wa,this.Ea,this.Dm,this.Mb,this.ua,this.hj);Nc.a.Eb&&(Nc.a.Eb.actionName=
Pj.gQc);if(!c)return Aa.a.J(512349787,829,10,"Unable to create shape node as CreateShapeNode returned null"),16;c.isEditable=!Array.contains(Pj.a8c,a);l.insertLocalShape?b.GB(c,null):(this.xv.B2([c],b,a),this.wda.instance.lvb=-1,this.Yx.CI=c,this.pTe());l.node=c;Aa.a.J(512349786,829,50,"Successfully inserted the shape at specified location");return 32}kjg(a,b,c){if(1===c)return 32;this.Vxa(0);return 32}m0b(a){switch(a){case ba.a.mvb:return new be(34,16,.5,3);case ba.a.xSc:return new be(34,16,.5,3);
case ba.a.eqg:return new be(34,9,1,1);case ba.a.$rg:return new be(2,17,1,1.16);case ba.a.vrg:return new be(3,55,1,1);case ba.a.erg:return new be(6,56,1,1.33);case ba.a.Zrg:return new be(7,57,1.33,1);case ba.a.Tpg:return new be(5,58,1,1);case ba.a.Brg:return new be(9,59,1,1.05);case ba.a.nqg:return new be(10,60,1,1.16);case ba.a.mqg:return new be(11,61,1,1);case ba.a.$qg:return new be(12,62,1,1);case ba.a.Ppg:return new be(13,63,1,1);case ba.a.Xpg:return new be(14,64,1,1);case ba.a.grg:return new be(39,
65,1,1);case ba.a.Apg:return new be(87,66,1,1);case ba.a.Xrg:return new be(35,67,1,1);case ba.a.jqg:return new be(83,68,1,1);case ba.a.kqg:return new be(84,69,1,1);case ba.a.qqg:return new be(85,70,1,1);case ba.a.Spg:return new be(86,71,1,1);case ba.a.Gpg:return new be(130,72,1,1);case ba.a.hrg:return new be(33,73,1,1);case ba.a.xpg:return new be(73,7,1.33,1);case ba.a.Hpg:return new be(72,8,1.33,1.33);case ba.a.vpg:return new be(82,74,1.14,1.14);case ba.a.Ypg:return new be(41,75,1,1);case ba.a.Yqg:return new be(42,
76,1,1);case ba.a.wpg:return new be(40,77,1,1);case ba.a.iqg:return new be(81,78,1,1);case ba.a.Drg:return new be(78,79,1,1);case ba.a.lqg:return new be(75,18,1,1);case ba.a.zqg:return new be(74,80,1,1);case ba.a.Wrg:return new be(76,81,1,1);case ba.a.Wqg:return new be(77,82,1,.5);case ba.a.Cpg:return new be(120,83,1,1);case ba.a.spg:return new be(88,84,1,1);case ba.a.$pg:return new be(93,85,1,1);case ba.a.Zpg:return new be(94,86,1,1.17);case ba.a.uqg:return new be(89,87,1,.08);case ba.a.urg:return new be(90,
88,1,.08);case ba.a.tqg:return new be(91,89,1,.17);case ba.a.trg:return new be(92,90,1,.17);case ba.a.Uqg:return new be(175,19,1,1);case ba.a.Rqg:return new be(176,20,1,1);case ba.a.Sqg:return new be(177,21,1,1);case ba.a.Pqg:return new be(178,22,1,1);case ba.a.Qqg:return new be(179,23,1,1);case ba.a.Tqg:return new be(180,24,1,1);case ba.a.$8d:return new be(95,12,1,1);case ba.a.a9d:return new be(95,13,1,1);case ba.a.b9d:return new be(95,14,1,1);case ba.a.Y8d:return new be(97,26,1,1);case ba.a.X8d:return new be(97,
155,1,1);case ba.a.Z8d:return new be(97,156,1,1);case ba.a.V8d:return new be(101,25,1,1);case ba.a.U8d:return new be(101,153,1,1);case ba.a.W8d:return new be(101,154,1,1);case ba.a.bqg:return new be(46,0,1.07,.53);case ba.a.rqg:return new be(44,1,.53,1.07);case ba.a.vqg:return new be(50,2,.53,1.33);case ba.a.rrg:return new be(43,3,.53,1.07);case ba.a.bsg:return new be(45,4,1.07,.53);case ba.a.dsg:return new be(51,5,1.33,.53);case ba.a.xqg:return new be(53,27,.93,1.33);case ba.a.tpg:return new be(62,
28,.95,.89);case ba.a.asg:return new be(63,29,.96,.97);case ba.a.yqg:return new be(52,30,.93,.93);case ba.a.upg:return new be(49,31,.8,.93);case ba.a.Lpg:return new be(67,32,1.33,.8);case ba.a.Kpg:return new be(68,33,1.33,.8);case ba.a.Mpg:return new be(69,34,.8,1.33);case ba.a.Ipg:return new be(70,46,.8,1.33);case ba.a.Urg:return new be(47,35,.53,1.07);case ba.a.Zqg:return new be(48,36,.53,1.07);case ba.a.frg:return new be(36,37,.53,1.07);case ba.a.zpg:return new be(37,38,.53,.53);case ba.a.srg:return new be(56,
39,1,1);case ba.a.cqg:return new be(58,40,1,1);case ba.a.sqg:return new be(55,41,1,1);case ba.a.csg:return new be(57,42,1,1);case ba.a.wqg:return new be(59,43,.63,1.33);case ba.a.org:return new be(61,44,1.33,1.33);case ba.a.Bpg:return new be(64,45,1.07,1.07);case ba.a.nrg:return new be(54,47,1.33,1.33);case ba.a.prg:return new be(4,10,1,1);case ba.a.zrg:return new be(25,11,1,1);case ba.a.wrg:return new be(28,48,1,1);case ba.a.xrg:return new be(27,49,1,1);case ba.a.yrg:return new be(26,50,1,1);case ba.a.Frg:return new be(29,
51,1,1);case ba.a.Erg:return new be(32,52,1,1);case ba.a.Grg:return new be(31,53,1,1);case ba.a.Hrg:return new be(30,54,1,1);case ba.a.qrg:return new be(116,91,.67,1);case ba.a.Arg:return new be(117,6,.67,1);case ba.a.crg:return new be(118,92,.67,1);case ba.a.Dpg:return new be(119,93,.67,1);case ba.a.Aqg:return new be(104,94,.67,1);case ba.a.Eqg:return new be(105,95,.67,1);case ba.a.Iqg:return new be(106,96,.67,1);case ba.a.Bqg:return new be(107,97,.67,1);case ba.a.Fqg:return new be(108,98,.67,1);
case ba.a.Jqg:return new be(109,99,.67,1);case ba.a.Cqg:return new be(110,100,.67,1);case ba.a.Gqg:return new be(111,101,.67,1);case ba.a.Kqg:return new be(112,102,.67,1);case ba.a.Dqg:return new be(113,103,.67,1);case ba.a.Hqg:return new be(114,104,.67,1);case ba.a.Lqg:return new be(115,105,.67,1);case ba.a.fqg:return new be(79,106,1,1);case ba.a.gqg:return new be(80,107,1,1);case ba.a.Org:return new be(15,108,1,1);case ba.a.Prg:return new be(16,15,1,1);case ba.a.Qrg:return new be(17,109,1,1);case ba.a.Rrg:return new be(18,
110,1,1);case ba.a.Srg:return new be(19,111,1,1);case ba.a.Jrg:return new be(20,112,1,1);case ba.a.Krg:return new be(21,113,1,1);case ba.a.Lrg:return new be(22,114,1,1);case ba.a.Mrg:return new be(23,115,1,1);case ba.a.Nrg:return new be(24,116,1,1);case ba.a.esg:return new be(122,117,.67,1.33);case ba.a.dqg:return new be(121,118,.67,1.33);case ba.a.Npg:return new be(124,119,.83,1.33);case ba.a.Jpg:return new be(123,120,.83,1.33);case ba.a.fsg:return new be(126,121,1.25,1.13);case ba.a.oqg:return new be(127,
122,1.13,1.25);case ba.a.gsg:return new be(128,123,1,1);case ba.a.aqg:return new be(129,124,1,1);case ba.a.krg:return new be(131,125,.67,1);case ba.a.rpg:return new be(158,126,.67,1);case ba.a.Qpg:return new be(132,127,.67,1);case ba.a.Opg:return new be(133,128,.67,1);case ba.a.irg:return new be(134,129,.67,1);case ba.a.pqg:return new be(135,130,.67,.67);case ba.a.Wpg:return new be(136,131,.67,1);case ba.a.Xqg:return new be(137,132,.83,1.16);case ba.a.Yrg:return new be(138,133,.33,1);case ba.a.jrg:return new be(139,
134,.67,1.16);case ba.a.Nqg:return new be(140,135,.5,1);case ba.a.Oqg:return new be(141,136,.67,1);case ba.a.Fpg:return new be(142,137,.5,.5);case ba.a.arg:return new be(159,138,.67,.67);case ba.a.ypg:return new be(143,139,.88,1);case ba.a.lrg:return new be(144,140,.88,1);case ba.a.Vrg:return new be(145,141,.67,.67);case ba.a.brg:return new be(146,142,.67,.67);case ba.a.Epg:return new be(147,143,1,.5);case ba.a.Irg:return new be(148,144,1,.5);case ba.a.hqg:return new be(149,145,.75,.75);case ba.a.Vqg:return new be(150,
146,.75,.75);case ba.a.Trg:return new be(152,147,.67,1);case ba.a.Rpg:return new be(157,148,.67,.67);case ba.a.Crg:return new be(153,149,.67,.67);case ba.a.Mqg:return new be(154,150,.67,1);case ba.a.Upg:return new be(155,151,.75,1);case ba.a.Vpg:return new be(156,152,.67,1);default:return null}}qnj(a,b,c){b=this.ra.og();if(!(b&&0<b.length&&Dq.a.q0k(b)))return 16;if(1===c)return 32;c=this.ua.Ba;if(!c)return 16;if(!this.ol.yI(c,b.length))return this.ol.AJ(c),16;if(this.Xb.Zc(c))return 16;this.ZEa.U5g(c,
c,b,null,a);return 32}pTe(){try{const a=fb.a.instance.Ka("Common.ISystemInitiatedFeedback");a&&a.execute(b=>{b.logActivity("InsertShapeActivity",null)})}catch(a){Aa.a.J(512349783,829,10,"Exception thrown while triggering InsertShapeActivity. Exception: {0}",a)}}}Pj.sMf=110;Pj.rMf=75;Pj.sii=19;Pj.rii=38;Pj.Tii=4;Pj.Sii=4;Pj.gQc="InsertShape";Pj.qnl=[ba.a.Uqg,ba.a.Rqg,ba.a.Sqg,ba.a.Pqg,ba.a.Qqg,ba.a.Tqg,ba.a.mvb,ba.a.eqg,ba.a.$rg,ba.a.vrg,ba.a.erg,ba.a.Zrg,ba.a.Tpg,ba.a.Brg,ba.a.nqg,ba.a.mqg,ba.a.$qg,
ba.a.Ppg,ba.a.Xpg,ba.a.grg,ba.a.Apg,ba.a.Xrg,ba.a.jqg,ba.a.kqg,ba.a.qqg,ba.a.Spg,ba.a.Gpg,ba.a.hrg,ba.a.xpg,ba.a.Hpg,ba.a.vpg,ba.a.Ypg,ba.a.Yqg,ba.a.wpg,ba.a.iqg,ba.a.Drg,ba.a.lqg,ba.a.zqg,ba.a.Wrg,ba.a.Wqg,ba.a.Cpg,ba.a.spg,ba.a.$pg,ba.a.Zpg,ba.a.uqg,ba.a.urg,ba.a.tqg,ba.a.trg,ba.a.prg,ba.a.zrg,ba.a.wrg,ba.a.xrg,ba.a.yrg,ba.a.Frg,ba.a.Erg,ba.a.Grg,ba.a.Hrg,ba.a.qrg,ba.a.Arg,ba.a.crg,ba.a.Dpg,ba.a.Aqg,ba.a.Eqg,ba.a.Iqg,ba.a.Bqg,ba.a.Fqg,ba.a.Jqg,ba.a.Dqg,ba.a.Hqg,ba.a.Lqg,ba.a.Cqg,ba.a.Gqg,ba.a.Kqg,
ba.a.fqg,ba.a.gqg,ba.a.Org,ba.a.Prg,ba.a.Qrg,ba.a.Rrg,ba.a.Srg,ba.a.Jrg,ba.a.Krg,ba.a.Lrg,ba.a.Mrg,ba.a.Nrg,ba.a.esg,ba.a.dqg,ba.a.Npg,ba.a.Jpg,ba.a.fsg,ba.a.oqg,ba.a.gsg,ba.a.aqg,ba.a.krg,ba.a.rpg,ba.a.Qpg,ba.a.Opg,ba.a.irg,ba.a.pqg,ba.a.Wpg,ba.a.Xqg,ba.a.Yrg,ba.a.jrg,ba.a.Nqg,ba.a.Oqg,ba.a.Fpg,ba.a.arg,ba.a.ypg,ba.a.lrg,ba.a.Vrg,ba.a.brg,ba.a.Epg,ba.a.Irg,ba.a.hqg,ba.a.Vqg,ba.a.Trg,ba.a.Rpg,ba.a.Crg,ba.a.Mqg,ba.a.Upg,ba.a.Vpg,ba.a.rrg,ba.a.bqg,ba.a.rqg,ba.a.bsg,ba.a.dsg,ba.a.vqg,ba.a.xqg,ba.a.tpg,
ba.a.asg,ba.a.yqg,ba.a.upg,ba.a.Lpg,ba.a.Kpg,ba.a.Ipg,ba.a.Mpg,ba.a.Urg,ba.a.Zqg,ba.a.frg,ba.a.zpg,ba.a.srg,ba.a.cqg,ba.a.sqg,ba.a.csg,ba.a.wqg,ba.a.org,ba.a.Bpg,ba.a.nrg];Pj.a8c=[ba.a.$8d,ba.a.a9d,ba.a.b9d,ba.a.V8d,ba.a.U8d,ba.a.W8d,ba.a.Y8d,ba.a.X8d,ba.a.Z8d];Pj.b8c=[ba.a.a9d,ba.a.b9d,ba.a.V8d,ba.a.U8d,ba.a.W8d,ba.a.X8d,ba.a.Z8d];Pj.Lhk=[1,5];Object(e.a)(Pj,"InsertShapeActor",null,[229,106]);class WM{constructor(){this.type="LivePollTaskPaneProps";this.formsUrl=this.onCloseButtonClicked=null}}Object(e.a)(WM,
"LivePollTaskPaneProps",null,[]);class XM{constructor(a,b,c,f,l,x,G,R){this.BL=null;this.DFa=this.Db=!1;a.loadScript("powerpoint-live-strings").then(()=>{this.DFa=!0;Aa.a.J(512500544,833,50,"powerpoint-live-strings loaded successfully")}).catch(fa=>{Aa.a.J(512500515,833,10,"Failed to load powerpoint-live-strings "+fa.toString())});if(!b)throw Error.argumentNull("formsDesignPageUrl LivePollPaneActor is null");if(!c)throw Error.argumentNull("formsResultsPageUrl for LivePollPaneActor is null");if(!f)throw Error.argumentNull("actionManager for LivePollPaneActor is null");
if(!l)throw Error.argumentNull("actionBlockingManager for LivePollPaneActor is null");if(!x)throw Error.argumentNull("graphTopologyManager for LivePollPaneActor is null");if(!G)throw Error.argumentNull("selectionManager for LivePollPaneActor is null");if(!R)throw Error.argumentNull("shapeCountValidator for LivePollPaneActor is null");this.t3j=b;this.u3j=c;this.ia=f;this.ua=x;this.Af=l;this.ra=G;this.ol=R;this.uOg=Object(C.a)(this,this.Fml,"taskPaneMessageHandler")}ub(){this.ia.ya(ba.a.XNe,sc.a.application,
Object(C.a)(this,this.XNe,"showHideLivePollPane"))}xe(){}XNe(a,b,c){return b.contextId===sc.a.application&&this.DFa?1===c?32:Ag.a("LivePollPaneToggle",a,()=>{(this.Db=!this.Db)?(this.Tl(),Aa.a.J(512500514,833,50,"LivePollPaneActor::ShowHideLivePollPane show")):(this.tK(),Aa.a.J(512500513,833,50,"LivePollPanePaneActor::ShowHideLivePollPanePane close"));return 32}):2}Tl(){this.YB();const a=Object.assign(new ju.a,{title:ResourceStrings.L_LivePollTaskPane,hideHeader:!1,width:320,location:2,contentProps:this.BL,
onOpen:()=>{},onClose:()=>{this.Db=!1},isModernPane:!0});Ej.UISurfaces.Ms().then(b=>{b.showTaskPane("LivePollTaskPaneProps",a);window.addEventListener("message",this.uOg,!1);return null}).catch(b=>{Aa.a.J(512500512,833,10,"LivePollPaneActor::ShowPane exception: {0}",b.toString())})}tK(){Ej.UISurfaces.Ms().then(a=>{a.hideTaskPane("LivePollTaskPaneProps",2);window.removeEventListener("message",this.uOg);return null}).catch(a=>{Aa.a.J(512500511,833,10,"LivePollPaneActor::ClosePane exception: {0}",a.toString())})}YB(){this.BL=
Object.assign(new WM,{onCloseButtonClicked:Object(C.a)(this,this.onCloseButtonClicked,"onCloseButtonClicked"),formsUrl:this.b6i()})}b6i(){return String.format("{0}{1}{2}",this.t3j,"&auth_upn=",u.AFrameworkApplication.fa.Ga("UserPrincipalName"))}onCloseButtonClicked(){this.tK()}Fml(a){if("data"in a){var b;({ou:b}=Yd.d(a.data)).returnValue&&b&&"type"in b&&"PollCreated"===b.type&&"payload"in b&&(a=b.payload,"formId"in a&&(a=String.format("{0}{1}{2}{3}{4}",this.u3j,"?Id=",a.formId,"&auth_pvr=OrgId&auth_upn=",
u.AFrameworkApplication.fa.Ga("UserPrincipalName")),this.roj(a)))}}roj(a){const b=this.ua.Ba;if(b&&!this.Af.Zc(b))if(this.ol.yI(b,1)){var c=b.Bb;b.gBi(c.sid,c.cid,a,b.ev());b.L2(this.ra.Yd())}else this.ol.AJ(b)}}Object(e.a)(XM,"LivePollPaneActor",null,[229]);var PQ=d(938);class Ux{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){this.Xz=f;this.xua=l;this.ia=a;this.Xb=b;this.Fa=c;this.MI=R;this.Zb=x;this.ua=G;this.Hc=fa;this.Ob=wa;this.$ua=Wa;this.Mb=mb}ub(){this.ia.ya(ba.a.uhb,sc.a.application,Object(C.a)(this,
this.uhb,"showHideNotes"));this.ia.pa(ba.a.H$g,sc.a.application,Object(C.a)(this,this.hFk,"queryNotesPaneState"),96);this.ia.pa(ba.a.Gbd,sc.a.application,Object(C.a)(this,this.N4g,"pageScrollNotesPane"),64);this.ia.pa(ba.a.Fbd,sc.a.application,Object(C.a)(this,this.N4g,"pageScrollNotesPane"),64);this.ia.ya(ba.a.fLe,sc.a.application,Object(C.a)(this,this.Vhk,"notesResize"))}xe(){const a=this.Fa.Dc(zi.a.c2);a.bindAction(A.KeyInputManager.Na(w.a.vB,0),ba.a.Gbd);a.bindAction(A.KeyInputManager.Na(w.a.uB,
0),ba.a.Fbd)}uhb(a,b,c,f,l){if(this.Mb&&0!==this.Mb.Xo)return 2;a=this.Zb.yf;if(!this.ua.Ba||!a||this.Xb.rN(a))return 16;if(1===c)return 32;l&&Object(Ma.a)(PQ.a,l)?l.Zlc?this.Xz.qOe():this.Xz.Cuj():(this.Xz.Brk(),this.Xz.JUb()&&this.xua.ho?this.Fa.Gj(zi.a.c2,!0):this.Fa.Gj(zi.a.c2,!1));this.MI.rRa();return 32}hFk(a,b,c,f,l){if(!l||!Object(Ma.a)(Nh.a,l))return 8;l.Nf(this.Xz.JUb());return 32}N4g(a,b,c){return 1===c?32:this.Xz?(a===ba.a.Fbd?this.Xz.xa.scrollTop+=Ux.AMf:a===ba.a.Gbd&&(this.Xz.xa.scrollTop-=
Ux.AMf),32):8}Vhk(a,b,c,f,l){Aa.a.J(37524685,822,50,"Notes Resize Begin");if(!this.Xz||!l||"number"!==typeof l)return Aa.a.J(37524687,822,50,"Notes Resize Fail"),8;this.Xz.hea=l;this.Hc.Gc.yoh(1);this.Ob.Fq();this.$ua.hBl();Aa.a.J(37524689,822,50,"Notes Resize Success, Notes status:{0}, Notes Height:{1}",this.Xz.Thk?"On":"Off",this.Xz.hea);return 32}}Ux.AMf=80;Object(e.a)(Ux,"NotesActor",null,[229]);class YM{constructor(a,b,c,f){this.ia=a;this.Cac=b;this.la=c;this.HMg=0;this.gO=f}xe(){}ub(){this.ia.pa(ba.a.iFk,
xd.a.frame,Object(C.a)(this,this.jFk,"queryOfflineStatusHandler"),2144)}jFk(a,b,c,f,l){if(1===c)return 32;switch(this.Cac.status){case 0:1===this.HMg&&(l[Eq.a.Value]=CommonUIStrings.L_Connected,l[um.a.labelText]=CommonUIStrings.L_Connected,l[Eq.a.Visible]=!0,this.hideIcon(),El.a.instance.Cb(new xe.a(2,1,this.la.offlineLabelTimeoutInMs,()=>{this.cel();this.gO.h5("GetOfflineStatus",!1);this.gO.JF()},90,"108")));break;case 2:l[Eq.a.Value]=CommonUIStrings.L_Disconnected;l[um.a.labelText]=CommonUIStrings.L_Disconnected;
l[Eq.a.Visible]=!0;break;case 1:l[Eq.a.Value]=CommonUIStrings.L_Reconnecting,l[um.a.labelText]=CommonUIStrings.L_Reconnecting,l[Eq.a.Visible]=!0}this.HMg=this.Cac.status;return 32}hideIcon(){this.gnh(Qi.a.hidden)}cel(){this.gnh(Qi.a.visible)}gnh(a){const b=document.querySelector("[data-icon-name='SBVBASecurity_16']");b&&(b.style.visibility=a)}}Object(e.a)(YM,"OfflineStatusLabelActor",null,[229]);class ZM{constructor(a,b,c,f,l,x,G,R){this.KLg=!1;this.Khe=null;this.ia=a;this.Af=b;this.MI=c;this.Fa=
c.Bo;this.Fb=f;this.ra=l;this.Ea=x;this.$p=G;this.x_=R}ub(){this.ia.pa(ba.a.bringForward,sc.a.application,Object(C.a)(this,this.oQc,"handleOrganizeAction"),4);this.ia.pa(ba.a.bringToFront,sc.a.application,Object(C.a)(this,this.oQc,"handleOrganizeAction"),4);this.ia.pa(ba.a.sendBackward,sc.a.application,Object(C.a)(this,this.oQc,"handleOrganizeAction"),4);this.ia.pa(ba.a.sendToBack,sc.a.application,Object(C.a)(this,this.oQc,"handleOrganizeAction"),4);this.ia.pa(ba.a.dfi,sc.a.application,Object(C.a)(this,
this.Fjg,"handleFrontBackFlyout"),4);this.ia.pa(ba.a.B1k,sc.a.application,Object(C.a)(this,this.Fjg,"handleFrontBackFlyout"),4);u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)&&re.a("DelayRegisterArrangeShapesAction")?this.Khe=()=>{this.ia.pa(ba.a.WIf,sc.a.application,Object(C.a)(this,this.dkg,"handleOrganizeShapeAnchor"),4)}:this.ia.pa(ba.a.WIf,sc.a.application,Object(C.a)(this,this.dkg,"handleOrganizeShapeAnchor"),4)}xe(){const a=this.MI.Bo.Dc(Yb.a.Bg);
a.bindAction(A.KeyInputManager.Na(w.a.wpc,A.KeyInputManager.He),ba.a.bringForward);a.bindAction(A.KeyInputManager.Na(w.a.wpc,A.KeyInputManager.He|4),ba.a.bringToFront);a.bindAction(A.KeyInputManager.Na(w.a.upc,A.KeyInputManager.He),ba.a.sendBackward);a.bindAction(A.KeyInputManager.Na(w.a.upc,A.KeyInputManager.He|4),ba.a.sendToBack)}Fjg(a,b,c){return 1===c?this.ra.e3()?32:8:32}dkg(){return this.KLg?32:this.ra.e3()?32:16}oQc(a,b,c){b=this.$p.presentation;if(!b)throw Error.argumentNull("Presentation is null");
let f=this.ra.og();var l=this.Ea.Y6a(f);l&&(this.ra.efd(l),f=this.ra.og());if(!this.ra.e3()||this.Af.dC(f))return 16;if(1===c)return 32;switch(a){case ba.a.bringForward:c=1;break;case ba.a.bringToFront:c=0;break;case ba.a.sendBackward:c=3;break;case ba.a.sendToBack:c=2;break;default:return 8}Nc.a.Eb&&(Nc.a.Eb.Kr=!1,Nc.a.Eb.Oj=!0);1===f.length?Aa.a.J(17598029,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing only one shape."):1<f.length&&Aa.a.J(17598031,815,50,"OrganizeShapesActor::HandleOrganizeAction Organizing {0} shapes.",
f.length);l=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{l.kc(f[0]);l.fd=a;const x=Object(ua.a)(120,b.$B(f[0].slideId));this.gtk(x,f,c)}finally{l&&l.dispose()}return 32}bgk(a,b){const c=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{const f=this.$p.Ba,l=f.ZB(a),x=f.ZB(b);c.kc(l);this.cgk(f,l.id,x.id)}finally{c&&c.dispose()}}i7k(){this.KLg=!0;re.a("DelayRegisterArrangeShapesAction")&&this.Khe&&this.Khe()}gtk(a,b,c){a&&b&&0<b.length&&Aa.a.J(51164099,815,50,"OrganizeShapes has invalid params");
let f=Qa.a.clone(a.getValue(tb.a.BA));const l=[];let x=null;Qa.a.Zna(b,G=>!G.Og).length||(x=this.Ea.ds(b[0]))&&(f=Qa.a.clone(x.getValue(tb.a.BA)));for(const G of b)l.push(G.id);a.f_b(c,f,l)&&(x&&x.anchor?x.anchor.Vhb(f,1,!1):a.anchor?a.anchor.Vhb(f,1,!1):Aa.a.J(51164101,815,50,"slideNode/groupNode should have valid anchor"))}ftk(a,b,c){var f=this.ra.Yd(),l=this.J4i(f,b);a.reverse();b=new Ha.a;f=[];let x=-1,G=!1;for(let fa=0;fa<a.length;fa++){let wa=!1;for(var R of l)if(R.equals(a[fa])){b.add(R);wa=
G=!0;break}wa||f.push(a[fa]);c.equals(a[fa])&&(x=fa)}if(G)if(-1===x)Aa.a.J(593514880,815,10,"Invalid param endShapeId"),G=!1;else{c=0;R=a.length;for(l=0;c<x;)a[c++]=f[l++];for(let fa of b)a[c++]=fa;for(;c<R;)a[c++]=f[l++]}a.reverse();return G}J4i(a,b){let c=[],f=!1;for(const l of a)l.id.equals(b)&&(f=!0),c.push(l.id);f||(c=[],c.push(b));return c}cgk(a,b,c){if(a){var f=Qa.a.clone(a.getValue(tb.a.BA));var l=this.x_.jca(b);var x=this.x_.jca(c);l=this.Ea.ds(l);x=this.Ea.ds(x);l?x===l&&(f=Qa.a.clone(l.getValue(tb.a.BA))):
x&&(c=x.id);this.ftk(f,b,c)&&(Aa.a.J(51385985,815,50,"ReorderShapeInSelectionPane : Reorder shape"),l?l.anchor?l.anchor.Vhb(f,1,!1):Aa.a.J(594023564,815,10,"shapeNode should have valid anchor"):a.anchor?a.anchor.Vhb(f,1,!1):Aa.a.J(51385987,815,10,"slideNode should have valid anchor"))}else Aa.a.J(51385955,815,10,"MoveShapeOnTopOfShape has invalid params")}}Object(e.a)(ZM,"OrganizeShapesActor",null,[229]);class $M extends zs.a{constructor(a,b,c,f,l,x,G,R,fa){super();this.c5c=0;this.jg=f;this.wc=R;
this.aGg=fa;this.init(a);this.Fl("PPTClipboardActionOperation");(a=Object(ua.a)(10,G))||(a=new D.DictionaryPropertySet);a.setValue(Sl.a.Sb,fa);this.qDa(b,c,l,x,a)}TRc(){this.Ggb(this.jg)}H4a(a){this.rp=a;this.c5c=1}run(){if(0===this.c5c){if(1===this.Cma())return;this.c5c=1}1===this.c5c&&this.$X();this.wc.mFj(this.aGg)&&this.wc.Eg(!0,this.aGg)}}Object(e.a)($M,"PPTClipboardActionOperation",zs.a,[1371,346,347]);var aN=d(363),DE=d(529);class pu{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,
ie,He,fe,Te,We,Qf,mg,Xg,Mg,Sf,uh){this.ia=a;this.ra=b;this.Fa=c;this.Wz=f;this.lbb=l;this.Fb=x;this.pJg=G;this.Nb=R;this.Fda=fa;this.rAb=wa;this.Ea=Wa;this.YEa=mb;this.sL=Kb;this.J5j=nc;this.F$b=oc;this.t1j=Ic;this.BLg=Kc;this.tc=Hc;this.Fp=ie;this.vs=He;this.rQ=fe;this.Ob=Te;this.Zb=We;this.NN=Qf;this.BUa=mg;this.HT=Xg;if(re.a("RulerIndentBugFix")){if(!Mg)throw Error.argumentNull("paragraphIndentationReader");if(!Sf)throw Error.argumentNull("paragraphEditor");}this.j9=Mg;this.fVa=Sf;this.Pbc=uh}ub(){this.ia.pa(ba.a.Eze,
sc.a.application,Object(C.a)(this,this.Kpj,"handlePopulateFontColorDropdown"),101);this.ia.pa(ba.a.T4g,sc.a.application,Object(C.a)(this,this.Mpj,"handlePopulateFontSizeDropdown"),100);this.ia.pa(ba.a.Tha,sc.a.application,Object(C.a)(this,this.Omj,"handleCommitShapeText"),4);this.ia.pa(ba.a.pcd,sc.a.application,Object(C.a)(this,this.F$g,"queryListCommonLevel"),96);this.ia.pa(ba.a.Ecd,sc.a.application,Object(C.a)(this,this.F$g,"queryListCommonLevel"),96);this.ia.pa(ba.a.dic,sc.a.application,Object(C.a)(this,
this.Eah,"queryTextListMarkerGallery"),96);this.ia.pa(ba.a.eic,sc.a.application,Object(C.a)(this,this.Eah,"queryTextListMarkerGallery"),96);this.ia.pa(ba.a.Bbd,sc.a.application,Object(C.a)(this,this.jkg,"handlePopulateListMarkerDropdown"),100);this.ia.pa(ba.a.Cbd,sc.a.application,Object(C.a)(this,this.jkg,"handlePopulateListMarkerDropdown"),100);this.ia.pa(ba.a.aee,Bb.a.view,Object(C.a)(this,this.Goj,"handleLineSpacingMenuOpen"),68);this.ia.pa(ba.a.Mfk,sc.a.application,Object(C.a)(this,this.Ooj,"handleMoreFontColors"),
96);this.ia.pa(ba.a.ybd,sc.a.application,Object(C.a)(this,this.Poj,"handleMoreFontColorsResponse"),96);this.ia.ya(ba.a.qXa,Bb.a.paragraph,Object(C.a)(this,this.qXa,"queryLineSpacing"));this.ia.ya(ba.a.qXa,Bb.a.view,this.Fda);this.ia.he(ba.a.qXa,96);this.ia.ya(ba.a.uma,Bb.a.paragraph,Object(C.a)(this,this.C0,"setLineSpacing"));this.ia.ya(ba.a.uma,Bb.a.view,this.Fda);this.ia.he(ba.a.uma,68);this.ia.ya(ba.a.VHa,sc.a.application,Object(C.a)(this,this.VHa,"populateLineSpacingFlyout"));this.ia.ya(ba.a.S4g,
sc.a.application,Object(C.a)(this,this.lpj,"handlePandoraEscapeKeyPressed"));this.ia.ya(ba.a.Xgb,Bb.a.paragraph,Object(C.a)(this,this.mIf,"applySpacingToParagraph"));this.ia.ya(ba.a.Xgb,Bb.a.view,this.Fda);this.ia.he(ba.a.Xgb,4);this.ia.ya(ba.a.Wgb,Bb.a.paragraph,Object(C.a)(this,this.mIf,"applySpacingToParagraph"));this.ia.ya(ba.a.Wgb,Bb.a.view,this.Fda);this.ia.he(ba.a.Wgb,4);this.ia.ya(ba.a.mja,Bb.a.paragraph,Object(C.a)(this,this.Kob,"applyIndentationToParagraph"));this.ia.ya(ba.a.mja,Bb.a.view,
this.Fda);this.ia.he(ba.a.mja,4);this.ia.ya(ba.a.EHb,Bb.a.paragraph,Object(C.a)(this,this.Kob,"applyIndentationToParagraph"));this.ia.ya(ba.a.EHb,Bb.a.view,this.Fda);this.ia.he(ba.a.EHb,4);this.ia.ya(ba.a.GHb,Bb.a.paragraph,Object(C.a)(this,this.Kob,"applyIndentationToParagraph"));this.ia.ya(ba.a.GHb,Bb.a.view,this.Fda);this.ia.he(ba.a.GHb,4);this.ia.ya(ba.a.IHb,Bb.a.paragraph,Object(C.a)(this,this.Kob,"applyIndentationToParagraph"));this.ia.ya(ba.a.IHb,Bb.a.view,this.Fda);this.ia.he(ba.a.IHb,4);
this.Pbc&&(this.ia.ya(ba.a.FHb,Bb.a.paragraph,Object(C.a)(this,this.Kob,"applyIndentationToParagraph")),this.ia.ya(ba.a.FHb,Bb.a.view,this.Fda),this.ia.he(ba.a.FHb,4),this.ia.ya(ba.a.HHb,Bb.a.paragraph,Object(C.a)(this,this.Kob,"applyIndentationToParagraph")),this.ia.ya(ba.a.HHb,Bb.a.view,this.Fda),this.ia.he(ba.a.HHb,4));this.ia.pa(ba.a.zzk,sc.a.application,Object(C.a)(this,this.Tpj,"handlePowerPointTextAlignmentAnchor"),4);this.ia.pa(ba.a.O7g,sc.a.application,Object(C.a)(this,this.Upj,"handlePowerPointTextAnchoringAnchor"),
4);this.ia.ya(ba.a.Ama,Bb.a.view,this.rAb);this.ia.ya(ba.a.zma,Bb.a.view,this.rAb);this.ia.ya(ba.a.yma,Bb.a.view,this.rAb);this.ia.ya(ba.a.Ama,Bb.a.outline,Object(C.a)(this,this.w5d,"handlePowerPointTextAnchoring"));this.ia.ya(ba.a.zma,Bb.a.outline,Object(C.a)(this,this.w5d,"handlePowerPointTextAnchoring"));this.ia.ya(ba.a.yma,Bb.a.outline,Object(C.a)(this,this.w5d,"handlePowerPointTextAnchoring"));this.ia.he(ba.a.Ama,4);this.ia.he(ba.a.zma,4);this.ia.he(ba.a.yma,4);this.ia.ya(ba.a.nFb,Bb.a.view,
this.rAb);this.ia.ya(ba.a.nFb,Bb.a.outline,Object(C.a)(this,this.WDe,"queryTextAnchoring"));this.ia.he(ba.a.nFb,96);this.ia.ya(ba.a.mFb,Bb.a.view,this.rAb);this.ia.ya(ba.a.mFb,Bb.a.outline,Object(C.a)(this,this.WDe,"queryTextAnchoring"));this.ia.he(ba.a.mFb,96);this.ia.ya(ba.a.lFb,Bb.a.view,this.rAb);this.ia.ya(ba.a.lFb,Bb.a.outline,Object(C.a)(this,this.WDe,"queryTextAnchoring"));this.ia.he(ba.a.lFb,96);this.Fp&&(this.ia.pa(E.a.BLc,Bb.a.view,Object(C.a)(this,this.Qnj,"handleFormatPainterPick"),4),
this.ia.pa(ba.a.QYd,Bb.a.view,Object(C.a)(this,this.Rlj,"handleApplyFormatToText"),4),this.ia.pa(E.a.Dia,Bb.a.view,Object(C.a)(this,this.Pnj,"handleFormatPainterCancel"),4),this.rQ.Y4h(()=>{this.NN.$Sa=this.rQ.TK;this.Ob.updateCommandUI()}))}xe(){var a=this.Fa.Dc(Yb.a.LP);const b=this.Fa.Dc(zi.a.c2),c=this.Fa.Dc(Yb.a.sU),f=A.KeyInputManager.Na(w.a.Z0,0);a.bindAction(A.KeyInputManager.Na(w.a.$pc,0),ba.a.Tha);a.bindAction(f,ba.a.S4g);c.bindAction(f,ba.a.Tha);b.bindAction(A.KeyInputManager.Na(w.a.upd,
2),F.a.Ae);a.bindAction(A.KeyInputManager.Na(w.a.upd,2),F.a.Ae);this.F$b&&(a.bindAction(A.KeyInputManager.Na(w.a.Ifa,5),ba.a.rD),a.bindAction(A.KeyInputManager.Na(w.a.V$,5),ba.a.lz));this.Fp&&(a=this.Fa.Dc(zi.a.oD),a.np(f),a.bindAction(f,E.a.Dia))}Qnj(a,b,c){a=this.ra.rq();b=!1;let f=null,l=this.ra.Oa.kb;const x=!!this.ra.Oa&&this.ra.Oa.vl;x&&(l=this.ra.Oa.ga(0));l&&(f=l.Ua);if(f){switch(f.contextId){case Bb.a.textRange:case Bb.a.paragraph:case Bb.a.endOfParagraph:case Bb.a.Of:b=!0}b&&cb.SelectionEditor.Vj(f)&&
Ie.b(f)&&(b=!1);f.contextId===Bb.a.outline&&a.qd&&(b=!0);a&&!a.gwh&&(b=!1)}if(1===c||!b)return b?32:8;6!==this.ia.oq?(this.rQ.TK?Aa.a.J(40703699,820,50,"User deactivated the Format Painter button"):(Aa.a.J(40703697,820,50,"User activated the Format Painter button"),this.F6g(l,x,a)),this.rQ.TK=!this.rQ.TK):(Aa.a.J(40703701,820,50,"User picked format from keyboard shortcut"),this.F6g(l,x,a));return 32}F6g(a,b,c){this.rQ.G6g(a);var f=a.Ua;const l=Object(ua.a)(se.AParagraphNode,f.node);var x=Object(ua.a)(788,
this.Ob.Hd);let G=null;if(l&&x&&(G=x.Ci)){x=this.Fb.ke(4);const fa=G.vi;x.kc(G);var R=this.Nb.Kc(l);R.pc(8);const wa=this.tc.hs(R);let Wa=f.Qa,mb=f.Kb-f.Qa;a=!a.sba&&a.Ve.contextId!==Bb.a.endOfParagraph;b?(Wa=0,mb=yb.ParagraphReader.textLength(l)+1):({selectionStart:Wa,slh:mb}=this.bNf(f,l,R,Wa,mb,null,!1),a&&f.contextId===Bb.a.textRange&&mb++);b=this.HT.QCa(fa);f=null;wa&&(R.Rg(16),f=Object(ua.a)(127,R.currentNode));R.lB(8);R=Object(ua.a)(120,R.currentNode);this.HT.HVe(b,!0,l.sa(sb.a.ZDa,!1),R,c,
f,null,Wa,mb);(c=fa.zhc(b))&&G.Axb(c);x.dispose()}}bNf(a,b,c,f,l,x,G){switch(a.contextId){case Bb.a.Of:l=null;G&&(l=this.BUa.w1b(a))?(l=l.Ua,f=l.Qa,l=l.Kb-l.Qa):(f=0<f?f-1:0,l=1);break;case Bb.a.paragraph:f=0;l=yb.ParagraphReader.textLength(b)+1;break;case Bb.a.endOfParagraph:f=yb.ParagraphReader.textLength(b),l=1}for(c.lB(11);c.gDa();)c.Ab(2),(a=Object(ua.a)(se.AParagraphNode,c.currentNode))&&(f+=yb.ParagraphReader.textLength(a)+1),c.lB(11);if(G)for(c=1;c<x.length;c++)if((G=Object(ua.a)(Mc.a,x.ga(c)))&&
yb.ParagraphReader.Vd(G.node))switch(G.contextId){case Bb.a.textRange:l+=G.Kb-G.Qa;break;case Bb.a.Of:l+=1;break;case Bb.a.paragraph:l+=yb.ParagraphReader.textLength(G.node)+1;break;case Bb.a.endOfParagraph:l+=1}return{selectionStart:f,slh:l}}Rlj(a){if(6===this.ia.oq||this.rQ.TK){Aa.a.J(40703703,820,50,"User applied the Format Painter from command location: {0}",this.ia.oq);const G=this.ra.rq();if(G&&!pu.APj(G))return 2;var b=this.ra.Oa.kb;if(b&&b.Ua){var c=b.Ua;const R=Object(ua.a)(se.AParagraphNode,
c.node);var f=Object(ua.a)(788,this.Ob.Hd),l=null;if(R&&f&&(l=f.Ci)){f=this.Fb.ke(15);f.kc(l);f.fd=a;const fa=this.ra.Oa.vl;a=R.sa(sb.a.ZDa,!1);if(fa)for(var x of this.ra.Oa)this.rQ.YHf(x);else this.rQ.YHf(b);Nc.a.Eb&&(Nc.a.Eb.Oj=!1,Nc.a.Eb.actionName="FormatPainterApplyToText",Nc.a.Eb.WE=new Date);const wa=this.Nb.Kc(R);wa.pc(8);x=c.Qa;let Wa=c.Kb-c.Qa;fa?x=Wa=-1:{selectionStart:x,slh:Wa}=this.bNf(c,R,wa,x,Wa,b,!0);wa.Rg(8);b=Object(ua.a)(120,wa.currentNode);c=this.ra.Ey();l=this.HT.QCa(l.vi);this.HT.HVe(l,
!1,a,b,G,null,c,x,Wa);6!==this.ia.oq&&(this.rQ.TK=!1);f.dispose()}}}return 32}lpj(a,b,c,f,l){this.Fp&&this.ia.La(E.a.Dia,c,l);re.a("PandoraEscapeKeyPressed")&&this.ia.La(ba.a.Tha,c,l);return 32}Pnj(){this.NN.$Sa&&(this.rQ.TK=!1);return 32}Tpj(){return this.K0f()}Upj(){return this.K0f()}w5d(a,b,c){let f=!1;b=this.pJg.Oej(b);var l=this.ra.Yo();if(b&&b.$wb||l)f=!0;if(!f)return 16;if(1===c)return 32;switch(a){case ba.a.Ama:c=0;break;case ba.a.zma:c=1;break;case ba.a.yma:c=2;break;default:return 8}if(l)this.ra.JG()?
this.vs.$2k(l,c):(b=this.Fb.ke(15),b.kc(l),b.fd=a,this.vs.Z2k(this.ra.Oa,c),b.dispose());else{l=this.Fb.ke(15);try{l.kc(b),l.fd=a,b.setValue(sb.a.iR,c)}finally{l&&l.dispose()}}return 32}WDe(a,b,c,f,l){c=!1;b=this.pJg.vbg(b);f=this.ra.Oa;let x=0;const G=this.ra.Yo();if(b.Sa(sb.a.iR)||G){switch(a){case ba.a.nFb:c=G?({$va:x}=this.tc.Omd(f)).returnValue&&0===x:0===b.getValue(sb.a.iR);break;case ba.a.mFb:c=G?({$va:x}=this.tc.Omd(f)).returnValue&&1===x:1===b.getValue(sb.a.iR);break;case ba.a.lFb:c=G?({$va:x}=
this.tc.Omd(f)).returnValue&&2===x:2===b.getValue(sb.a.iR)}l.Nf(c);return 32}return 8}F$g(a,b,c,f,l){if(this.ra.wu())return l.Nf(!1),32;b=this.YEa.uA(this.ra.Kj);c=!0;for(const x of b)if((b=x.Qk?x.node:null)?(c=this.Nb.Kc(b),c.set(b),c.pc(11),c.Rg(11),c=(b=this.Wz.Pw(c))?a===ba.a.pcd?1===b.listType:a===ba.a.Ecd?0===b.listType:!1:!1):c=!1,!c)break;l.Nf(c);return 32}Eah(a,b,c,f,l){b=l.tXa;l=l.menuItemId;if(this.ra.wu())return b.Nf(!1),32;f=this.YEa.uA(this.ra.Kj);c=!0;for(const G of f){if(f=G.Qk?G.node:
null){var x=this.Nb.Kc(f);x.set(f);x.pc(11);x.Rg(11);if(f=this.Wz.Pw(x)){if(0===l){c=!1;break}a===ba.a.dic?(c=this.sL.qTa.ga(l).rVb,x=this.sL.qTa.ga(l).spb,c=f.yub&&0<f.t8.length&&f.t8[0]===c&&f.$7a&&f.font===x):a===ba.a.eic?(c=this.sL.l8c.ga(l).uLd,c=!!f.propertySet&&f.propertySet.Sa(sb.a.autonumberBulletType)&&f.propertySet.getValue(sb.a.autonumberBulletType)===c):c=!1}else 0!==l&&(c=!1)}if(!c)break}b.Nf(c);return 32}Mpj(a,b,c,f,l){if(1===c)return 32;l.PopulationXML=String.format("<Menu Id='menuFontSize'>\r\n               <MenuSection Id='fontSizes'>\r\n                    <Controls Id='ctrlFontSizes'>\r\n                        <Button MenuItemId='8'  Id='8'  Command='{0}' LabelText='8'/>\r\n                        <Button MenuItemId='9'  Id='9'  Command='{0}' LabelText='9'/>\r\n                        <Button MenuItemId='10' Id='10' Command='{0}' LabelText='10'/>\r\n                        <Button MenuItemId='10.5' Id='10.5' Command='{0}' LabelText='10.5'/>\r\n                        <Button MenuItemId='11' Id='11' Command='{0}' LabelText='11'/>\r\n                        <Button MenuItemId='12' Id='12' Command='{0}' LabelText='12'/>\r\n                        <Button MenuItemId='14' Id='14' Command='{0}' LabelText='14'/>\r\n                        <Button MenuItemId='16' Id='16' Command='{0}' LabelText='16'/>\r\n                        <Button MenuItemId='18' Id='18' Command='{0}' LabelText='18'/>\r\n                        <Button MenuItemId='20' Id='20' Command='{0}' LabelText='20'/>\r\n                        <Button MenuItemId='24' Id='24' Command='{0}' LabelText='24'/>\r\n                        <Button MenuItemId='28' Id='28' Command='{0}' LabelText='28'/>\r\n                        <Button MenuItemId='32' Id='32' Command='{0}' LabelText='32'/>\r\n                        <Button MenuItemId='36' Id='36' Command='{0}' LabelText='36'/>\r\n                        <Button MenuItemId='40' Id='40' Command='{0}' LabelText='40'/>\r\n                        <Button MenuItemId='44' Id='44' Command='{0}' LabelText='44'/>\r\n                        <Button MenuItemId='48' Id='48' Command='{0}' LabelText='48'/>\r\n                        <Button MenuItemId='54' Id='54' Command='{0}' LabelText='54'/>\r\n                        <Button MenuItemId='60' Id='60' Command='{0}' LabelText='60'/>\r\n                        <Button MenuItemId='66' Id='66' Command='{0}' LabelText='66'/>\r\n                        <Button MenuItemId='72' Id='72' Command='{0}' LabelText='72'/>\r\n                        <Button MenuItemId='80' Id='80' Command='{0}' LabelText='80'/>\r\n                        <Button MenuItemId='88' Id='88' Command='{0}' LabelText='88'/>\r\n                        <Button MenuItemId='96' Id='96' Command='{0}' LabelText='96'/>\r\n                     </Controls>\r\n               </MenuSection>\r\n            </Menu>",
"2016320825");return 32}Ooj(a,b,c,f,l){if(1===c)return this.ia.La(ba.a.renderColorPicker,1,l);u.AFrameworkApplication.Ta.La(E.a.fFb,2,l);a=new Hb.a(l&&0<=l.fontColor&&16777215>=l.fontColor?l.fontColor:0);b={};b.currentColor=a;b.handleCommand=ba.a.ybd;b.hideAlphaSlider=!0;return this.ia.La(ba.a.renderColorPicker,2,b)}Poj(a,b,c,f,l){if(1===c)return this.ia.La(ba.a.gt,c,l);if(!l)return Aa.a.J(595186523,820,10,"HandleMoreFontColorsResponse: actionData is null"),16;if(a=nu.a.parse(l.Color))return a=this.ia.La(ba.a.gt,
c,"@"+a.RGBColor),32===a&&this.ia.La(ba.a.tAa,c,l),a;Aa.a.J(595186521,820,10,"HandleMoreFontColorsResponse: failed to parse colorinfo, colorInfo is null");return 8}Kpj(a,b,c,f,l){if(1===c)return 32;a=(a=this.ra.rn())?a.Pe:null;b=ba.a.AEb;var x=ba.a.ybd;c=this.Zb.yf.j2;if(!l.MenuId||0>Ka.a.wg(l.MenuId).indexOf("floatie")){f=b.toString();x=x.toString();b=Object.assign(new wj.a,{Id:"menuFontColor",MenuSectionList:[]});const G=re.a("ColorPickerHighlighterFix")?DE.a.themeColors:"Colors";Array.add(b.MenuSectionList,
Mk.e(a,G,"Font.Color.Menu.Controls","fontColor","ThemeFontColorPicker",f,0,!this.BLg));Array.add(b.MenuSectionList,Mk.d("fontColor","Font.Color.Menu.Controls","fontColor","StandardFontColorPicker",f,!0));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",!1)),Array.add(b.MenuSectionList,Mk.c(c,"Recent Colors","Font.Color.Menu.Controls","recentColor","FontRecentColors",x,!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("FontRecentColors",
!0));Array.add(b.MenuSectionList,Mk.a("More Font Color","Font.Color.Menu.Controls","862825906",ResourceStrings.l_MoreFontColors,"Color.Menu.MoreFontColors","MoreFontColors","per_AppointmentColor0_16x16x32",ResourceStrings.l_MoreFontColorsKeytip));if(re.a("ColorPickerHighlighterFix")&&(c=new Rs,32===u.AFrameworkApplication.Ta.La(E.a.fFb,2,c)&&c&&!c.S_b))if(c=c.fontColor,-1===c)Mk.h(b,null,a);else if(c=Pk.i(c)||"",c=nu.a.parse(c))c=uf.Box4ColorHelper.vCa(c.bKa(),a),Mk.h(b,c,a);l.MenuItems=b}else a=
this.t1j.d$f(a,!this.BLg),l.PopulationXML=a.Chi(b,c,ba.a.ybd);return 32}Omj(a,b,c){if(!this.ra.cC())return 16;if(1===c)return 32;a=this.ra.Yd();if(!a||1!==a.length)return 16;this.ra.selectShape(a[0],!0);this.Fa.Ad();return 32}Goj(){return 32}VHa(a,b,c,f,l){if(1===c)return 32;a=new wj.a;a.MenuSectionList=[];b=Object.assign(new Mi.a,{ControlList:[]});for(c=0;5>c;++c)f=Object.assign(new Uy.a,{Id:"buttonLineSpacing"+pu.bee[c].replace(".","_"),LabelText:pu.bee[c].substring(0,3),ExternalId:"LineSpacingButton"+
pu.bee[c].replace(".","_")}),Array.add(b.ControlList,f);Array.add(a.MenuSectionList,b);l.MenuItems=a;return 32}jkg(a,b,c,f,l){if(1===c)return 32;a=a===ba.a.Bbd?1:a===ba.a.Cbd?0:14;Nc.a.Eb&&(1===a?Nc.a.Eb.actionName="PowerPointPopulateListMarkerBulletsDropDown":0===a&&(Nc.a.Eb.actionName="PowerPointPopulateListMarkerNumberingsDropDown"));!l.MenuId||0>Ka.a.wg(l.MenuId).indexOf("floatie")?l.MenuItems=this.ssi(a):l.PopulationXML=this.tsi(a);return 32}qXa(a,b,c,f,l){var x=l.MenuItemId;a=l.queryResult;
c=l.LineSpacingValue;f=l.LineSpacingUnit;let G=!1;b=this.lbb.YV(b.node);x=De.a.Jy(b.lineSpacing.value,x)&&2===b.lineSpacing.Sf;if(-1===c)f=b.lineSpacing.Sf,c=b.lineSpacing.value;else if(c!==b.lineSpacing.value||f!==b.lineSpacing.Sf)c=f=0;0!==f&&(G=x);a.Nf(G);l.LineSpacingUnit=f;l.LineSpacingValue=c;return 32}C0(a,b,c,f,l){if(1===c)return 32;if(void 0===l||null===l)return Aa.a.J(8955530,820,10,"PandoraActor::SetLineSpacing - Null action data passed. "),8;c=this.Fb.ke(15);b=b.node;c.kc(b);c.fd=a;b.setValue(sb.a.yW,
2);a=l;this.J5j&&(a+=this.Ea.FZd(this.Ea.tn(b)));b.setValue(sb.a.Zw,a);c.dispose();return 32}mIf(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;c=new aN.a(l.Sf,l.value);l=c.Sf;c=c.value;switch(a){case ba.a.Xgb:b.setValue(sb.a.Tca,c);b.setValue(sb.a.Zja,l);break;case ba.a.Wgb:b.setValue(sb.a.Sca,c),b.setValue(sb.a.Yja,l)}return 32}Kob(a,b,c,f,l){b=b.node;if(12!==b.type||!l)return 8;l=(new ov.a(l.Sf,l.value)).oM;c=this.j9.I7(b).oM;f=this.j9.hRa(b);switch(a){case ba.a.mja:b.setValue(Mb.a.Rl,l);break;
case ba.a.EHb:b.setValue(Mb.a.Tn,l);break;case ba.a.GHb:b.setValue(Mb.a.Tn,-l);break;case ba.a.IHb:b.setValue(Mb.a.Tn,0);break;case ba.a.FHb:this.Pbc&&b.setValue(Mb.a.Tn,l-c);break;case ba.a.HHb:this.Pbc&&(this.fVa.hv.Jgb(b,(1===f.specialIndentType?c+f.oM:c-f.oM)-l),this.fVa.hv.Ehd(b,1,l))}return 32}tsi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="menuListMarkersDropDown">');b.append('<MenuSection Id="msListMarkersPosition" ShowMenuSectionSeparator="false" DispalyMode="Menu16">');b.append('<Gallery Id="galleryListMarkersPosition" Width="3" ElementDimensions="Size48by48">');
let c,f,l;switch(a){case 1:c="BulletsLibrary_";f=ba.a.lwa;l=ba.a.dIa;break;case 0:c="NumberingLibrary_";f=ba.a.fXa;l=ba.a.dfb;break;default:c="BulletsLibrary_",f=ba.a.lwa,l=ba.a.dIa}for(let x=0;8>x;++x)b.append(String.format('<GalleryButton Id="{0}" Command="{1}" QueryCommand="{2}" InnerHTML="{3}" Alt="{4}" MenuItemId="{5}" ShouldSetTitle="true" />',c+x,f,l,Ka.a.je(String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',this.e1d(a,x),this.d1d(a,x))),this.Ccg(a,x),x));b.append("</Gallery>");
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}ssi(a){const b=Object.assign(new wj.a,{Id:"menuListMarkersDropDown",MenuSectionList:[]});Array.add(b.MenuSectionList,this.IDf(a));return b}IDf(a){var b="",c="";let f="",l=ba.a.lwa,x=ba.a.dIa;switch(a){case 1:b="Bullets Library";f="BulletsLibrary_";l=ba.a.lwa;x=ba.a.dIa;c="BulletLibrarySection";break;case 0:b="Numbering Library",f="NumberingLibrary_",l=ba.a.fXa,x=ba.a.dfb,c="NumberingLibrarySection"}b=Object.assign(new Mi.a,{Id:"msListMarkersPosition",
Title:b,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]});c=Object.assign(new tq.a,{Id:"galleryListMarkersPosition",ExternalId:c,ExternalGalleryId:this.t0d(a),Type:5,Width:3,ElementDimensions:"Size48by48",GalleryItems:[]});for(let G=0;8>G;++G)c.GalleryItems.push(this.s0d(a,G,f+G,l.toString(),x.toString(),this.Ccg(a,G)));Array.add(b.ControlList,c);return b}t0d(a){switch(a){case 1:return"BulletLibraryGallery";case 0:return"NumberingLibraryGallery";default:return""}}s0d(a,b,c,f,l,x){a=
Object.assign(new qz,{LevelInfo:this.p8i(a,b)});a.Id=c;a.Command=f;a.QueryCommand=l;a.Alt=x;a.ShouldSetTitle="true";a.MenuItemId=b.toString();return a}p8i(a,b){const c=[],f={};f.fontFamily=ia.FontUtils.Xha("Calibri");if(!b)return Object.assign(new Ik,{textAtLevel:Box4Intl.Box4Strings.L_ListStyleNone,styleAtLevel:f});f.fontFamily=ia.FontUtils.Xha(this.Ecg(a,b));1===a?(a=this.sL.mXc.ga(b).yLf,c.push(Object.assign(new Ik,{textAtLevel:a,styleAtLevel:f})),c.push(Object.assign(new Ik,{textAtLevel:a,styleAtLevel:f})),
c.push(Object.assign(new Ik,{textAtLevel:a,styleAtLevel:f}))):0===a&&(a=this.sL.mXc.ga(b).VXg,c.push(Object.assign(new Ik,{textAtLevel:a[0],styleAtLevel:f})),c.push(Object.assign(new Ik,{textAtLevel:a[1],styleAtLevel:f})),c.push(Object.assign(new Ik,{textAtLevel:a[2],styleAtLevel:f})));return c}Ccg(a,b){return 1===a?this.sL.pCg.ga(this.sL.X1b(b)):0===a?this.sL.pCg.ga(this.sL.tPc(b)):""}d1d(a,b){return b?1===a?(a=this.sL.mXc.ga(b).yLf,this.aIa([a,a,a])):0===a?(a=this.sL.mXc.ga(b).VXg,this.aIa(a)):
"":Box4Intl.Box4Strings.L_ListStyleNone}aIa(a){return a&&3===a.length?String.format('<DIV class="ListNumberPreview" style="padding-left: 2pt; font-size: 9pt; ">{0}{1}{2}</DIV>',this.OCa(a[0]),this.OCa(a[1]),this.OCa(a[2])):""}OCa(a){return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',a)}e1d(a,b){const c=new Sys.StringBuilder;c.append("position: relative; ");b?(c.append("font-family: "),c.append(ia.FontUtils.Xha(this.Ecg(a,
b))),c.append("; "),c.append("font-size: 24pt;")):(c.append("font-size: 12pt; "),c.append("top: 22%;"));c.append("color: black;");return c.toString()}Ecg(a,b){return 1===a?this.sL.qTa.ga(this.sL.X1b(b)).spb:0===a?"Calibri":""}K0f(){let a=16;if(this.ra.h8())return 16;const b=this.ra.rq(),c=this.ra.Yo();if(b&&b.$wb||c)a=32;return a}static APj(a){return!!a&&(a.fwh||a.qd)}}pu.bee=["1.00","1.50","2.00","2.50","3.00"];Object(e.a)(pu,"PandoraActor",null,[229]);var QQ=d(731);class qu{constructor(a,b){this.wvd=
this.K0a=null;this.Ca=a;this.eza=b;if(this.ule=u.AFrameworkApplication.fa.ka("HandleRaceConditionInHostManagerInit"))this.wvd=QQ.a.create();this.PR=fb.a.instance.Ka("Common.ISystemInitiatedFeedback")}get dQ(){return this.K0a}ub(){this.Ca.pa(F.a.close,xd.a.frame,Object(C.a)(this,this.closeDocument,"closeDocument"),2176);this.Ca.pa(F.a.m_b,xd.a.frame,Object(C.a)(this,this.m_b,"fileProperties"),128);this.Ca.ya(F.a.fCa,xd.a.frame,Object(C.a)(this,this.fCa,"fileSharing"));this.Ca.pa(F.a.copyAndEdit,xd.a.frame,
Object(C.a)(this,this.copyAndEdit,"copyAndEdit"),128);this.Ca.pa(F.a.bGb,xd.a.frame,Object(C.a)(this,this.bGb,"replyWithChanges"),128);this.Ca.pa(F.a.PNe,xd.a.frame,Object(C.a)(this,this.SSi,"fileVersion"),128);this.Ca.ya(F.a.downloadACopy,xd.a.frame,Object(C.a)(this,this.downloadACopy,"downloadACopy"));this.Ca.ya(F.a.JKi,xd.a.frame,Kd.ActionManager.Hg);this.Ca.pa(F.a.XGe,xd.a.frame,Object(C.a)(this,this.XGe,"reportAbuseLink"),128);this.Ca.pa(F.a.Ojd,xd.a.frame,Object(C.a)(this,this.qmc,"signInInternal"),
128);this.Ca.ya(F.a.workflow,xd.a.frame,Object(C.a)(this,this.workflow,"workflow"));u.AFrameworkApplication.fa.ka("DocumentNameInJewelInfoMenuIsEnabled")&&this.Ca.pa(F.a.ocd,xd.a.frame,Object(C.a)(this,this.ocd,"queryBreadcrumbDocName"),96);this.Ca.pa(F.a.VCe,xd.a.frame,Object(C.a)(this,this.VCe,"queryCopyAndEditButton"),96);u.AFrameworkApplication.fa.ka("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this.Ca.pa(F.a.SCe,xd.a.frame,Object(C.a)(this,this.SCe,"queryBuildVersion"),2144),this.Ca.pa(F.a.CDe,
xd.a.frame,Object(C.a)(this,this.CDe,"querySessionId"),2144));this.Ca.ya(F.a.fXb,xd.a.frame,Object(C.a)(this,this.fXb,"conversation"));this.eza.execute(Object(C.a)(this,this.Hec,"onHostPostmessengerCreated"));Z.ULS.sendTraceTag(536987588,306,50,"WebAppFrameCommandUIActor-RegisterActions done.")}Hec(a){this.K0a=a;this.ule&&(this.wvd.instance=a);Z.ULS.sendTraceTag(536987589,306,this.dQ?50:10,String.format("OnHostPostmessengerCreated - Setting OnHostPostmessengerCreated as null value = {0}",!this.dQ))}closeDocument(a,
b,c,f,l){a=2===c;c=Li.h;l&&(c=l);return b&&a&&!this.WCc(c)?8:this.uqi(a,c)}WCc(){return!0}uqi(a,b){if(u.AFrameworkApplication.Aa.jb.UMe("3033402446"))return Z.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),this.hna(a,bf.a.G4f,!0,{});if(u.AFrameworkApplication.Kjc&&b&&b===Li.f)return Z.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),u.AFrameworkApplication.Aa.mO(a,u.AFrameworkApplication.Kjc);
if(u.AFrameworkApplication.isEmbedded)return a&&Z.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(u.AFrameworkApplication.GQf){if(!a)return 32;Z.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");try{return window.top.close(),32}catch(l){return Z.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",l),8}}let c=u.AFrameworkApplication.dFc;if(!c)return a&&Z.ULS.sendTraceTag(6070361,
306,50,"CloseDocumentInternal - no closeUrl found"),8;b||(b=Li.h);if(b===Li.c||b===Li.h)return u.AFrameworkApplication.Aa.mO(a,c);let f;if(u.AFrameworkApplication.KXa)return a&&Z.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),f=b===Li.d||b===Li.b?this.hna(a,bf.a.bGb,u.AFrameworkApplication.mpc,{["event_source"]:b}):2,32!==f?(c=b?Ze.a.Ri(u.AFrameworkApplication.KXa,Li.e,b):u.AFrameworkApplication.KXa,u.AFrameworkApplication.Aa.mO(a,c)):f;a&&Z.ULS.sendTraceTag(6070363,
306,50,"CloseDocumentInternal - Using FileClose postmessage");f=b===Li.b?this.hna(a,bf.a.G4f,u.AFrameworkApplication.XVe,null):2;return 32!==f?u.AFrameworkApplication.Aa.mO(a,c):f}qmc(a,b,c,f,l){a=this.hna(2===c,bf.a.Ojd,!0,l);8===a&&(window.top.location=u.AFrameworkApplication.signInUrl,a=32);return a}m_b(a,b,c){a=this.hna(2===c,bf.a.m_b,u.AFrameworkApplication.YEh,null);return 32!==a?u.AFrameworkApplication.Aa.mO(2===c,u.AFrameworkApplication.L4f):a}fCa(a,b,c,f,l){if(1===c)return sz.SessionStatusManager.instance.gja?
8:32;a=F.a.a$k;b=zh.a.create().toString();f={};f.event_source=l;f[ki.a.Jlc]=b;var x=l?l.nav:null;x&&(f[ki.a.d$k]=x);(x=l?l.scenarioId:null)&&(f[ki.a.e$k]=x);l&&"CopyLink"===l.SourceControlId&&(l.mode="copy",a=F.a.$9k);l&&"ManageAccess"===l.SourceControlId&&(l.mode="manageAccess",a=F.a.b$k);l&&"ShareTopBar"===l.SourceControlId&&(u.AFrameworkApplication.s7b("CfShareVsInviteA;TfShareVsInviteB;TfShareVsInviteC"),u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.isTUIEnabledOnShare",
!1)&&qu.xp.raiseEvent(qu.Ymi));(x=l?l.mode:null)&&(f[ki.a.c$k]=x);if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.ShareWithSummaryIsEnabled",!1)){var G=l?l.additionalData:null;G&&(f[ki.a.R8h]=G)}2===c&&(G={},G[ki.a.Jlc]=b,x&&(G.mode=x),Z.ULS.sendTraceTag(38278995,306,50,Yd.c(G)));b=this.hna(2===c,bf.a.o$k,u.AFrameworkApplication.ZVe,f);if(32!==b){if(u.AFrameworkApplication.n_b)return l=l?Ze.a.Ri(u.AFrameworkApplication.n_b,Li.e,l):u.AFrameworkApplication.n_b,u.AFrameworkApplication.Aa.mO(2===
c,l,!0);Z.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{["Result"]:b})}on.c(a);return b}fXb(a,b,c){return this.hna(2===c,bf.a.fXb,!0,{})}workflow(a,b,c){a=this.hna(2===c,bf.a.workflow,u.AFrameworkApplication.eWe,{["WorkflowType"]:u.AFrameworkApplication.Qpc});if(32!==a){if(u.AFrameworkApplication.$od)return u.AFrameworkApplication.Aa.mO(2===c,u.AFrameworkApplication.$od,!0);Z.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",
{["Result"]:a})}return a}XGe(a,b,c){a=2===c;return b&&a&&!this.WCc(Li.f)?8:u.AFrameworkApplication.Aa.mO(a,u.AFrameworkApplication.Kjc)}copyAndEdit(a,b,c){a={};2===c&&(a=u.AFrameworkApplication.Aa.jb.z$f());a=this.hna(2===c,bf.a.copyAndEdit,u.AFrameworkApplication.XEh,a);return 32!==a?u.AFrameworkApplication.Aa.mO(2===c,u.AFrameworkApplication.sQd,u.AFrameworkApplication.hideHeader):a}downloadACopy(a,b,c){return 1===c?u.AFrameworkApplication.lJ||u.AFrameworkApplication.hQ||sz.SessionStatusManager.instance.gja?
8:32:u.AFrameworkApplication.Aa.mO(2===c,u.AFrameworkApplication.vPa,!0)}bGb(a,b,c){a=2===c;if(b&&a&&!this.WCc(Li.d))return 8;b=this.hna(a,bf.a.bGb,u.AFrameworkApplication.mpc,{["event_source"]:Li.d});return 32!==b?(b=Ze.a.Ri(u.AFrameworkApplication.KXa,Li.e,Li.d),u.AFrameworkApplication.Aa.mO(a,b)):b}SSi(a,b,c){a=this.hna(2===c,bf.a.TSi,u.AFrameworkApplication.$Ve,null);return 32!==a?u.AFrameworkApplication.Aa.mO(2===c,u.AFrameworkApplication.rXd):a}ocd(a,b,c,f,l){if(2===c){if(!l)return 8;l.Value=
Ka.a.yG(u.AFrameworkApplication.pu.Ix)}return 32}SCe(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=u.AFrameworkApplication.instance.WHi}return 32}CDe(a,b,c,f,l){if(2===c){if(!l)return 8;l.Text=u.AFrameworkApplication.instance.XHi}return 32}hna(a,b,c,f){return this.ule?this.l1k(a,b,c,f):c?a?this.dQ.sendMessage(b,f)?32:8:32:2}l1k(a,b,c,f){return c?a?this.dQ?this.dQ.sendMessage(b,f)?32:8:(Z.ULS.sendTraceTag(528234241,306,15,"SendPostmessage called when HostPostmessenger was not initialized yet.Queueing the request."),
this.wvd.execute(()=>{Z.ULS.sendTraceTag(528234242,306,50,"HostPostmessenger now available. Executing the request.");this.dQ.sendMessage(b,f)}),32):32:2}VCe(a,b,c,f,l){if(2===c){if(!l)return 8;u.AFrameworkApplication.fa.ka("IsEditAndReplyFlow")&&(l.LabelText=CommonUIStrings.l_EditAndReply)}return 32}}qu.xp=new ic.a;qu.Ymi="CheckEditorSuggestions";Object(e.a)(qu,"WebAppFrameCommandUIActor",null,[]);class bN extends qu{constructor(a,b,c,f,l,x,G){super(a,b);this.zu=c;this.$D=f;this.ra=l;this.Ha=x;this.Xa=
G}ub(){super.ub();this.Ha.pptEnablePreviousVersionsOptionForOneDriveConsumer&&this.Ca.ya(ba.a.N7g,xd.a.frame,Object(C.a)(this,this.sBe,"pptoShowFileVersion"))}sBe(a,b,c){return 1===c&&this.Xa.Gca?2:this.Ca.processAction(F.a.PNe,c)}workflow(a,b,c,f,l){if(1===c)return 32;this.ra.Uh();this.zu.NOe(!0,ResourceStrings.l_Loading,a);Aa.a.J(20187205,801,50,"PPT save and launch workflow");this.$D.G2(!1,!0,()=>{this.Fki(l)},Object(C.a)(this,this.Owa,"saveFailureCallback"));return 32}WCc(a){return a!==Li.a||
u.AFrameworkApplication.isEmbedded||u.AFrameworkApplication.GQf||u.AFrameworkApplication.dFc||this.RLj()?!0:(Aa.a.J(37007442,306,15,"PptWebAppFrameCommandUIActor::BeforeCloseDocument - CloseUrl is null, fallback to RefreshPage"),this.Ca.La(ba.a.refresh,2,{refreshtrigger:"PptWebAppFrameCommandUIActor::BeforeCloseDocument"}),!1)}RLj(){var a=u.AFrameworkApplication.fa.Ga(u.AFrameworkApplication.FJ);a=u.AFrameworkApplication.K9a&&!!a&&"teams"===a.toLowerCase();return re.a("ReactDialogsProtocolLaunchingTeamsFix")&&
this.Ha.hVd&&a&&u.AFrameworkApplication.Aa.jb.UMe("3033402446")}Fki(a){this.zu.hide();super.workflow(0,null,2,null,a)}Owa(){this.zu.hide();return!1}}Object(e.a)(bN,"PptWebAppFrameCommandUIActor",qu,[]);class cN{constructor(a,b,c){if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("focusManager");if(!c)throw Error.argumentNull("presentationReader");this.ia=a;this.Fa=b;this.uc=c}ub(){this.ia.pa(ba.a.afd,sc.a.application,Object(C.a)(this,this.afd,"replaceFonts"),4)}xe(){const a=
[this.Fa.Dc(zi.a.oD),this.Fa.Dc(zi.a.c2),this.Fa.Dc(Yb.a.Bg),this.Fa.Dc(Yb.a.LP)];for(const b of a)b.bindAction(A.KeyInputManager.Na(w.a.pLb,A.KeyInputManager.He),ba.a.afd)}afd(a,b,c){return b.contextId!==sc.a.application?2:1===c?this.uc.Hj()?32:8:32}}Object(e.a)(cN,"ReplaceFontsActor",null,[]);var dN=d(1045);class eN extends Sys.EventArgs{constructor(a,b,c){super();this.pYg=a;this.V9=b;this.jv=c}}Object(e.a)(eN,"RibbonTabSwitchedEventArgs",Sys.EventArgs,[]);class fN{constructor(a,b,c,f,l,x,G,R){if(!a)throw Error.argumentNull("actionManager");
if(!b)throw Error.argumentNull("frameContext");if(!c)throw Error.argumentNull("ribbonUser");if(!f)throw Error.argumentNull("focusManager");if(!G)throw Error.argumentNull("ribbonExternal");this.Fa=f;this.ia=a;this.MI=b;this.ZD=c;this.AGg=l;this.Ee=x;this.x0j=R}ub(){this.ia.ya(F.a.$He,xd.a.frame,Object(C.a)(this,this.Mpk,"onRibbonFocus"));this.ia.pa(F.a.GXk,xd.a.frame,Object(C.a)(this,this.$qj,"handleRibbonStateChanged"),64);this.ia.ya(F.a.kmd,sc.a.application,Object(C.a)(this,this.kmd,"toggleRibbonState"));
this.ia.ya(F.a.JXk,Bb.a.view,Object(C.a)(this,this.arj,"handleRibbonTabSwitched"));this.ia.ya(F.a.Pfd,Bb.a.view,Object(C.a)(this,this.Pfd,"ribbonModeToggledToMLR"));this.ia.ya(F.a.Qfd,Bb.a.view,Object(C.a)(this,this.Qfd,"ribbonModeToggledToSLR"));wd.a.get_instance().gk(7,Object(C.a)(this,this.registerOnShyRibbonStateChange,"registerOnShyRibbonStateChange"))}xe(){const a=v.FocusManager.instance().Dc(zi.a.SLf);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.aqc,A.KeyInputManager.He),F.a.kmd);y.AFrame.Zj(a,A.KeyInputManager.Na(r.a.lk?
w.a.Hfa:w.a.zod,1),F.a.$He);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.yKa,r.a.lk?2:1),F.a.$He);this.x0j&&(this.MI.Q9a.ked(ma.a.wl,window.document,Object(C.a)(this,this.pwj,"ignoreAltKeyUpOnDocument")),lE.a.instance().fFf(Object(C.a)(this,this.xok,"onOnlyAltKeyPressed")))}Pfd(a,b,c){try{if(1===c)return 32;re.a("ReactMLRReuseSLRCookieForMLR")?this.poh(!1):this.hlc(!0);Aa.a.J(512500443,822,50,"[ReactRibbon] - Ribbon mode toggled to MLR");this.MI.rRa()}catch(f){Aa.a.J(512500442,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to MLR",
f)}return 32}Qfd(a,b,c){try{if(1===c)return 32;re.a("ReactMLRReuseSLRCookieForMLR")||this.hlc(!1);this.poh(!0);Aa.a.J(512500441,822,50,"[ReactRibbon] - Ribbon mode toggled to SLR");this.MI.rRa()}catch(f){Aa.a.J(512500440,822,10,"[ReactRibbon] - Error when Ribbon mode toggled to SLR",f)}return 32}poh(a){Pi.a.aM(u.AFrameworkApplication.fa.Ga("IsSimplifiedRibbonOnCookieName"),a.toString(),Pi.a.JL)}hlc(a){Pi.a.aM(u.AFrameworkApplication.fa.Ga("ReactRibbonMLRPreferenceCookieName"),a.toString(),Pi.a.JL)}$qj(a,
b,c){if(1===c)return 32;this.MI.rRa();return 32}kmd(){return 32}arj(a,b,c,f,l){if(!l)return 8;l&&l.NewContextId!==l.OldContextId&&(a=0,l&&l[sn.a.jv]&&(a=l[sn.a.jv]),this.Ee.bIk(new eN(l.OldContextId,l.NewContextId,a)));this.Fa.ze&&2===l[sn.a.jv]&&this.Fa.ze.name===Yb.a.Wea&&(b=b.view)&&!Ka.a.Va(b.eI)&&this.Fa.Bf(b.eI);return 32}xok(){dN.a.instance.keyCode===w.a.wKa&&(appChrome.api.inKeytipMode()?appChrome.api.exitKeytipMode():appChrome.api.enterKeytipMode(),this.ukg())}pwj(a){return a.mc.keyCode===
w.a.wKa}ukg(){if(document.activeElement&&document.activeElement.id!==sf.a.vWb)return this.Fa.Syh(!this.AGg.inKeytipMode,!1),32;this.Fa.ze&&this.Fa.Syh(this.Fa.ze.name===Yb.a.Wea||this.AGg.inKeytipMode,!0);return 32}Mpk(a,b,c){return 1===c?32:this.ukg()}registerOnShyRibbonStateChange(){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Do&&Lg.a("registerOnShyRibbonStateChange")&&appChrome.api.registerOnShyRibbonStateChange((a,b)=>{if(3===a&&3!==b||0===a&&3===b)Aa.a.J(512500439,822,50,"[ReactRibbon] - Ribbon shy mode toggled. Relayout the app."),
this.MI.rRa()})}}Object(e.a)(fN,"RibbonStateActor",null,[229]);class iA{constructor(a,b){this.sectionIndex=a;this.slideIndex=b}}Object(e.a)(iA,"SelectSectionAndSlidesData",null,[]);class gN{constructor(a,b,c,f,l){this.tVa=null;this.ia=a;this.Sz=b;this.ua=c;this.obc=f;this.hw=l;this.obc.nG(Object(C.a)(this,this.fB,"onChildTopologyChanged"));this.ua.presentation&&(this.tVa=this.ua.presentation.Ip)}ub(){this.ia.pa(ba.a.Leh,Bb.a.application,Object(C.a)(this,this.Kqj,"handleRemoveSection"),4);this.ia.pa(ba.a.UVg,
Bb.a.application,Object(C.a)(this,this.Uoj,"handleMoveSectionUp"),4);this.ia.pa(ba.a.TVg,Bb.a.application,Object(C.a)(this,this.Toj,"handleMoveSectionDown"),4);this.ia.pa(ba.a.IVe,Bb.a.application,Object(C.a)(this,this.isj,"handleUpdateSectionTitle"),4);this.ia.pa(ba.a.aob,Bb.a.application,Object(C.a)(this,this.Glj,"handleAddSection"),4)}xe(){}isj(a,b,c,f,l){if(1===c)return(a=this.ua.presentation)&&a.Ip&&a.Ip.length?32:8;if(!l)return Aa.a.J(50647327,822,10,"HandleUpdateSectionTitle with null action data."),
8;this.Sz.TPi(l);return 32}Kqj(a,b,c){b=this.ua.AA;const f=this.ua.Yaa;if(1===c){const l=this.ua.presentation;if(!l||!l.Ip||!l.Ip.length)return 8;if(!b&&1<l.Ip.length)return f&&!f.CJ.length?32:8}if(2===c){Aa.a.J(50652321,822,50,"HandleRemoveSection called.");try{f&&this.Sz.MPi(b,a),this.tVa=this.ua.presentation.Ip,this.ia.La(ba.a.Kgd,2,new iA(this.ua.AA,this.ua.Ba.slideIndex))}catch(l){Aa.a.J(50689955,822,10,"SectionActor: Exception in HandleRemoveSection: {0}.",l)}}return 32}Uoj(a,b,c){a=this.ua.AA;
if(1===c)return c=this.ua.presentation,!c||!c.Ip||!c.Ip.length||0>=a?8:32;if(2===c){Aa.a.J(50652323,822,50,"HandleMoveSectionUp called.");try{-1!==a&&(this.Sz.N2f(a,!0),this.ia.La(ba.a.Kgd,2,new iA(this.ua.AA,this.ua.Ba.slideIndex)))}catch(f){Aa.a.J(50856024,822,10,"SectionActor: Exception in HandleMoveSectionUp: {0}.",f)}}return 32}Toj(a,b,c){a=this.ua.AA;if(1===c)return(c=this.ua.presentation)&&c.Ip&&c.Ip.length&&a!==c.Ip.length-1&&-1!==a?32:8;if(2===c){Aa.a.J(50652353,822,50,"HandleMoveSectionDown called.");
try{-1!==a&&(this.Sz.N2f(a,!1),this.ia.La(ba.a.Kgd,2,new iA(this.ua.AA,this.ua.Ba.slideIndex)))}catch(f){Aa.a.J(50856027,822,10,"SectionActor: Exception in HandleMoveSectionDown: {0}.",f)}}return 32}Glj(a,b,c){if(2===c){b=-1;c=this.ua.AA;Aa.a.J(50676807,822,50,"HandleAddSection called.");try{this.Sz.qPi(this.ua.Ba,a),b=this.ua.AA}catch(f){Aa.a.J(50676809,822,10,"SectionActor: Exception in HandleAddSection: {0}.",f)}-1!==b&&b!==c&&this.ia.processAction(ba.a.rTe,2)}return 32}fB(a,b){try{if(34===b.lZ&&
!b.node.isDirty){const c=this.tVa?Array.clone(this.tVa):null;this.tVa=Array.clone(this.ua.presentation.Ip);if(!c&&this.tVa||c.length<this.tVa.length)2===this.tVa.length&&-1===this.ua.AA&&(this.ua.AA=1),this.hw?this.hw.rEe():Aa.a.J(51172877,822,10,"SectionActor: graphOperationEventNotifier is null for raising event."),this.ia.processAction(ba.a.rTe,2)}}catch(c){Aa.a.J(51144129,822,10,"SectionActor: Exception in OnChildTopologyChanged: {0}.",c)}}dispose(){this.obc.yO(Object(C.a)(this,this.fB,"onChildTopologyChanged"))}}
Object(e.a)(gN,"SectionActor",null,[229]);var hN=d(620);class iN{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie){if(!Hc)throw Error.argumentNull("viewEventNotifier");this.ia=a;this.Af=b;this.Fa=c;this.wQ=f;this.Zb=l;this.ua=x;this.nb=G;this.oC=R;this.Qb=fa;this.LTa=wa;this.Je=Wa;this.ep=mb;this.A4=Kb;this.Ea=nc;this.iw=oc;this.M9=Ic;this.hua=Kc;this.Ee=Hc;this.H4j=ie}ub(){this.ia.ya(ba.a.Qld,sc.a.application,Object(C.a)(this,this.GGb,"selectNextSlideHandler"));this.ia.ya(ba.a.Rld,sc.a.application,
Object(C.a)(this,this.GGb,"selectNextSlideHandler"));this.ia.ya(ba.a.DZa,sc.a.application,Object(C.a)(this,this.GGb,"selectNextSlideHandler"));this.ia.ya(ba.a.CZa,sc.a.application,Object(C.a)(this,this.GGb,"selectNextSlideHandler"));this.ia.ya(ba.a.tib,sc.a.application,Object(C.a)(this,this.GGb,"selectNextSlideHandler"));this.ia.ya(ba.a.rib,sc.a.application,Object(C.a)(this,this.GGb,"selectNextSlideHandler"));this.ep&&(this.ia.ya(ba.a.Tnc,sc.a.application,Object(C.a)(this,this.qub,"handleKeyboardMultiSelectSlides")),
this.ia.ya(ba.a.Mnc,sc.a.application,Object(C.a)(this,this.qub,"handleKeyboardMultiSelectSlides")),this.ia.ya(ba.a.Onc,sc.a.application,Object(C.a)(this,this.qub,"handleKeyboardMultiSelectSlides")),this.ia.ya(ba.a.Nnc,sc.a.application,Object(C.a)(this,this.qub,"handleKeyboardMultiSelectSlides")),this.ia.ya(ba.a.Rnc,sc.a.application,Object(C.a)(this,this.qub,"handleKeyboardMultiSelectSlides")),this.ia.ya(ba.a.Qnc,sc.a.application,Object(C.a)(this,this.qub,"handleKeyboardMultiSelectSlides")),this.ia.ya(ba.a.Zkh,
sc.a.application,Object(C.a)(this,this.X_k,"selectAllSlidesHandler")),this.ia.ya(ba.a.hYa,sc.a.application,Object(C.a)(this,this.crj,"handleScrollSelectedThumbnailsIntoView")));this.ia.ya(ba.a.jgb,sc.a.application,Object(C.a)(this,this.brj,"handleScrollActiveThumbnailIntoViewSlim"));this.ia.ya(ba.a.ZYa,sc.a.application,Object(C.a)(this,this.hlh,"selectNextShapeHandler"));this.ia.ya(ba.a.DIb,sc.a.application,Object(C.a)(this,this.hlh,"selectNextShapeHandler"));this.ia.ya(ba.a.pKb,sc.a.application,
Object(C.a)(this,this.Nul,"unselectShapesHandler"));this.ia.ya(ba.a.Akc,sc.a.application,Object(C.a)(this,this.W_k,"selectAllShapesHandler"));this.ia.ya(ba.a.Bph,sc.a.application,Object(C.a)(this,this.I9k,"shapeEscapeKeyPressedHandler"));this.ia.ya(ba.a.zhb,sc.a.application,Object(C.a)(this,this.yQc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ba.a.Ahb,sc.a.application,Object(C.a)(this,this.yQc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ba.a.Bhb,sc.a.application,Object(C.a)(this,this.yQc,"handleSlideScopeArrowKeyboard"));
this.ia.ya(ba.a.Chb,sc.a.application,Object(C.a)(this,this.yQc,"handleSlideScopeArrowKeyboard"));this.ia.ya(ba.a.puh,sc.a.application,Object(C.a)(this,this.Frj,"handleSpaceKeyPressed"));this.ia.ya(ba.a.N6g,sc.a.application,Object(C.a)(this,this.Kxk,"playVideoCommandHandler"))}xe(){var a=this.Fa.Dc(zi.a.oD);const b=this.Fa.Dc(Yb.a.Bg),c=this.Fa.Dc(Yb.a.LP);a.bindAction(A.KeyInputManager.Na(w.a.Iq,0),ba.a.Qld);a.bindAction(A.KeyInputManager.Na(w.a.Iq,4),ba.a.Rld);a.bindAction(A.KeyInputManager.Na(w.a.vB,
0),ba.a.DZa);a.bindAction(A.KeyInputManager.Na(w.a.$0,0),ba.a.DZa);a.bindAction(A.KeyInputManager.Na(w.a.uB,0),ba.a.CZa);a.bindAction(A.KeyInputManager.Na(w.a.Y0,0),ba.a.CZa);a.bindAction(A.KeyInputManager.Na(w.a.zE,0),ba.a.tib);a.bindAction(A.KeyInputManager.Na(w.a.Ew,0),ba.a.rib);this.ep&&(a.bindAction(A.KeyInputManager.Na(w.a.$0,4),ba.a.Tnc),a.bindAction(A.KeyInputManager.Na(w.a.Y0,4),ba.a.Mnc),a.bindAction(A.KeyInputManager.Na(w.a.zE,4),ba.a.Onc),a.bindAction(A.KeyInputManager.Na(w.a.Ew,4),ba.a.Nnc),
a.bindAction(A.KeyInputManager.Na(w.a.vB,4),ba.a.Rnc),a.bindAction(A.KeyInputManager.Na(w.a.uB,4),ba.a.Qnc),a.bindAction(A.KeyInputManager.Na(w.a.n_a,2),ba.a.Zkh));b.bindAction(A.KeyInputManager.Na(w.a.vB,0),ba.a.DZa);b.bindAction(A.KeyInputManager.Na(w.a.uB,0),ba.a.CZa);b.bindAction(A.KeyInputManager.Na(w.a.zE,0),ba.a.tib);b.bindAction(A.KeyInputManager.Na(w.a.Ew,0),ba.a.rib);b.bindAction(A.KeyInputManager.Na(w.a.Iq,0),ba.a.ZYa);b.bindAction(A.KeyInputManager.Na(w.a.Iq,4),ba.a.DIb);b.bindAction(A.KeyInputManager.Na(w.a.Z0,
0),ba.a.Bph);b.bindAction(A.KeyInputManager.Na(w.a.n_a,2),ba.a.Akc);b.bindAction(A.KeyInputManager.Na(w.a.P5,0),ba.a.zhb);b.bindAction(A.KeyInputManager.Na(w.a.V$,0),ba.a.Ahb);b.bindAction(A.KeyInputManager.Na(w.a.Ifa,0),ba.a.Bhb);b.bindAction(A.KeyInputManager.Na(w.a.vY,0),ba.a.Chb);a=A.KeyInputManager.Na(w.a.vB,0);c.np(a);c.bindAction(a,ba.a.DZa);a=A.KeyInputManager.Na(w.a.uB,0);c.np(a);c.bindAction(a,ba.a.CZa);b.bindAction(A.KeyInputManager.Na(w.a.NO,0),ba.a.puh)}GGb(a,b,c){if(this.wQ.SZ||this.Af.Zc(this.Zb.yf))return 16;
if(1===c)return 32;if(!this.Zb.yf||!this.ua.Ba)return 16;32===this.ia.processAction(ba.a.Qdc,1)&&this.ia.processAction(ba.a.Pdc,2);b=this.D$i(this.ua.Ba,a);if(b===this.ua.Ba.we)return 32;if(this.iw&&a!==ba.a.tib&&a!==ba.a.rib&&(a=this.Je.LZ(b),!a||!a.SS))return 16;this.Fa.Bba===Yb.a.Bg&&this.Fa.Ad();return this.Je.U9(b)}D$i(a,b){a=a.we;const c=this.Qb.Hj();switch(b){case ba.a.CZa:a=Math.min(a+1,c-1);break;case ba.a.Qld:a=a+1>c-1?0:a+1;break;case ba.a.DZa:a=Math.max(a-1,0);break;case ba.a.Rld:a=0>
a-1?c-1:a-1;break;case ba.a.tib:a=0;break;case ba.a.rib:a=c-1}return a}qub(a,b,c){if(this.wQ.SZ||this.Af.Zc(this.Zb.yf)||!this.Zb.yf||!this.ua.Ba)return 16;if(1===c)return 32;32===this.ia.processAction(ba.a.Qdc,1)&&this.ia.processAction(ba.a.Pdc,2);if(1>=this.Qb.Hj())return 32;Aa.a.J(34395531,816,50,"Selected multiple Slides by Shift+Up/Down, Shift+Home/End and Shift+PageUp/PageDown");switch(a){case ba.a.Tnc:case ba.a.Mnc:case ba.a.Onc:case ba.a.Nnc:this.gsj(a);break;case ba.a.Rnc:case ba.a.Qnc:this.kpj(a);
break;default:return Aa.a.J(25751680,816,50,"SelectionActor::HandleKeyboardMultiSelectSlides does not recognize this action"),8}return 32}Ffj(a,b){const c=[];var f=this.Qb.Hj();for(b=b>f-1?f-1:b;a<=b;a++)(f=this.Qb.CG(a))&&c.push(f);return c}gsj(a){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");const b=this.nb.nf();b.sort((Wa,mb)=>Wa.we-mb.we);const c=b[0].we,f=b[b.length-1].we,l=this.ua.Ba.we,x=this.Qb.Hj();var G=[];let R=l,fa=l,wa=l;G=!0;switch(a){case ba.a.Tnc:1===b.length?wa=R=
0<=l-1?l-1:l:l===c?fa=0<=f-1?f-1:f:c?wa=R=c-1:G=!1;break;case ba.a.Mnc:1===b.length?wa=fa=l<x-1?l+1:l:l===c&&f<x-1?wa=fa=f+1:l===c&&f===x-1?G=!1:R=c+1;break;case ba.a.Onc:R=0;break;case ba.a.Nnc:fa=x-1}if(this.iw&&wa!==l&&(a=this.Je.LZ(wa),!a||!a.SS))return;if(G){G=this.Ffj(R,fa);let Wa;(Wa=this.nb).bY.apply(Wa,G);this.Je.Swa(R===l?fa:R)}}kpj(a){const b=this.nb.nf();b.sort((fa,wa)=>fa.we-wa.we);const c=b[0].we,f=b[b.length-1].we,l=this.ua.Ba;if(!l)throw Error.argumentNull("ActiveSlide is null");const x=
l.we,G=this.Qb.Hj();let R=null;if(!(1>=G)){switch(a){case ba.a.Rnc:if(!x)break;(R=this.Qb.CG(x-1))&&1<b.length&&x===f&&this.Nob(b)&&this.nb.tjc(l);break;case ba.a.Qnc:x!==G-1&&(R=this.Qb.CG(x+1))&&1<b.length&&x===c&&this.Nob(b)&&this.nb.tjc(l)}if(R){if(this.iw&&(a=R.sg(this.Je.Ma),!a||!a.SS))return;this.Zb.Ba=R;this.nb.w3a(R);this.Je.Swa(R.we)}}}Nob(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].we-a[b].we)return!1;return!0}crj(a,b,c){if(!this.Zb.yf||!this.ua.Ba||
this.Af.Zc(this.Zb.yf))return 16;2===c&&this.Je.hYa();return 32}brj(a,b,c){if(!this.Zb.yf||!this.ua.Ba||this.Af.Zc(this.Zb.yf))return 16;2===c&&this.Je.Agd();return 32}yQc(a,b,c){return this.nb.e3()?this.Voj(a,c):this.irj(a,c)}irj(a,b){if(this.ep&&1!==this.nb.nf().length)return 8;let c;switch(a){case ba.a.zhb:case ba.a.Bhb:a=ba.a.CZa;c="ThumbnailPageDownNavigation";break;case ba.a.Chb:case ba.a.Ahb:a=ba.a.DZa;c="ThumbnailPageUpNavigation";break;default:return Aa.a.J(8955553,816,50,"SelectionActor::HandleSelectSlideKeyboard does not recognize this action"),
8}Nc.a.Eb&&(Nc.a.Eb.actionName=c,Nc.a.Eb.Oj=!1,Nc.a.Eb.Kr=!0);return this.ia.processAction(a,b)}Voj(a,b){switch(a){case ba.a.zhb:a=ba.a.Kdc;break;case ba.a.Ahb:a=ba.a.Ldc;break;case ba.a.Bhb:a=ba.a.Mdc;break;case ba.a.Chb:a=ba.a.Ndc;break;default:return Aa.a.J(8955555,816,50,"SelectionActor::HandleMoveShapeKeyboard does not recognize this action"),8}return this.ia.processAction(a,b)}hlh(a,b,c,f,l){if(this.wQ.SZ)return 16;if(1===c)return 32;b=this.ua.Ba;if(!b)return 16;c=b.jl();if(!c||!c.length)return 16;
this.Ad();f=this.nb.og();if(this.nb.LGb){if(c=this.nb.LGb.sg(this.Zb.nK.Ma))c.C6d(),c.imh(!1);f.length||f.push(this.nb.LGb);this.nb.LGb=null}f&&this.pJa(f,!1);c=null;a===ba.a.ZYa?c=l?l:b.n7a(f,!1,0):a===ba.a.DIb&&(c=b.n7a(f,!0,0));if(!c)return Z.ULS.sendTraceTag(587563472,816,10,"SelectionActor.SelectNextShapeHandler: failed to find next shape to select"),16;if(this.H4j){l=Object(ua.a)(Az.a,c.sg(this.Zb.nK.Ma));if(c.WDa&&l&&a===ba.a.DIb){const x=document.getElementById(hN.a.qze+l.IS);if(x&&document.activeElement!==
x)return l.pJa(),x.focus(),32}if(f.length&&(l=f[0],f=Object(ua.a)(Az.a,l.sg(this.Zb.nK.Ma)),l.WDa&&f&&a===ba.a.ZYa&&(a=document.getElementById(hN.a.qze+f.IS))&&document.activeElement!==a))return a.focus(),32}return this.K9g(c,b)}W_k(a,b,c){if(this.wQ.SZ)return 16;if(1===c)return 32;a=this.ua.Ba;if(!a)return 16;b=a.jl();if(!b.length)return 16;a=[];for(const f of b)(b=Object(ua.a)(121,f.sg(this.Zb.nK.Ma)))&&b.Sp?b.pJa():(b&&b.shapeNode&&b.shapeNode.Mx&&b.x0(!1),a.push(f));this.nb.mYa(a,!0);this.A4.EIk();
this.pJa(a,!0);this.Ad();return 32}X_k(a,b,c){if(1===c)return 32;a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");a=a.slides||[];if(!a.length)return 16;Aa.a.J(34358608,816,50,"Selected All Slides");let f;(f=this.nb).bY.apply(f,a);this.Je.Swa(this.Qb.Hj()-1);return 32}I9k(a,b,c){if(1===c)return 32;this.ia.processAction(ba.a.y8d,2);this.ia.processAction(ba.a.pKb,2);re.a("RaiseEscapeKeyPressedEvent")&&this.Ee.RGk();return 32}Nul(a,b,c){if(!this.nb.JG())return 16;if(1===c)return 32;
this.oC.oOa();a=this.nb.Yd();if(b=this.Ea.Y6a(a))return a=this.Ea.nr(b),this.K9g(a,this.ua.Ba);this.pJa(a,!1);this.nb.Uh();this.Ad();return 32}Frj(){this.ia.processAction(ba.a.N6g,2);this.hua&&this.ia.processAction(ba.a.tJf,2);return 32}Kxk(){if(!this.nb.rbi()&&!this.nb.sbi())return 2;const a=this.nb.Yd();if(1<a.length)return 2;for(let b=0;b<a.length;b++){const c=this.M9.lRa(a[b]);c&&c.startPlaying()}return 32}K9g(a,b){const c=a.sg(this.Zb.nK.Ma);if(c){if(c.Sp)return this.nb.Uh(),c.pJa(),c.imh(!0),
c.bR(),b=null,c.uXc?b=String.format(ResourceStrings.L_CannotEditHint,c.uXc.userName):Aa.a.J(19140689,828,10,"Shape is locked but the LockOwner is null. Shape: {0}.",c.shapeNode?c.shapeNode.get_shapeId().toString():""),this.LTa.lch(a,b),this.nb.LGb=a,32}else return Z.ULS.sendTraceTag(587563469,816,10,"SelectionActor.SelectNextShapeHandler: ShapeViewElement of next shape is null"),8;this.nb.selectShape(a,!0);(a=b.sg(this.Zb.nK.Ma))&&a.Rwa();c&&(c.pJa(),c.bR());return 32}Ad(){this.Zb.nK.$o||this.Fa.Ad()}pJa(a,
b){for(const c of a)(a=c.sg(this.Zb.nK.Ma))&&(b?a.pJa():a.C6d())}}Object(e.a)(iN,"SelectionActor",null,[229]);class jA{constructor(){this.isHiddenShape=!1;this.shapeName=null;this.shapeId=0;this.key=null;this.isFocussedShape=!1;this.children=null}}Object(e.a)(jA,"SelectionPaneShapeNode",null,[]);var RQ=d(873);class jN{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc){this.tac=this.KQ=null;a("powerpoint-editor-intl").then(()=>{Aa.a.J(512500438,801,50,"Icons and strings script is loaded successfully");
a("selectionPaneManager").then(()=>{Aa.a.J(512500437,801,50,"selection Pane Manager script is loaded successfully");this.KQ=selectionPaneManager.FactoryGlobal.getSelectionPaneManagerInstance();this.xOk();fa.i7k()}).catch(Hc=>{Aa.a.J(512500436,801,10,"Failed to load selectionPaneManager "+Hc.toString())})}).catch(Hc=>{Aa.a.J(512500435,801,10,"Failed to load powerpoint-editor-intl "+Hc.toString())});this.nb=b;this.Ob=c;this.ia=f;this.ua=l;this.Fa=x;this.aA=G;this.bRg=R;this.$7j=fa;this.Ig=wa;this.od=
Wa;this.Lc=mb;this.C9=Kb;this.MI=nc;this.Ea=oc;this.az=Ic;this.Fb=Kc;this.lEg=!1;this.Ig.UH(Object(C.a)(this,this.GWa,"onChangeRenderSelectionPane"));this.Ig.vAa(Object(C.a)(this,this.GWa,"onChangeRenderSelectionPane"));this.Lc.JNa(Object(C.a)(this,this.GWa,"onChangeRenderSelectionPane"));this.od.yAa(Object(C.a)(this,this.GWa,"onChangeRenderSelectionPane"));this.Ob.JM(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"));this.DTa=!1;this.pPg=null}dispose(){this.Ig.Y4(Object(C.a)(this,this.GWa,"onChangeRenderSelectionPane"));
this.Ig.GXa(Object(C.a)(this,this.GWa,"onChangeRenderSelectionPane"));this.Lc.Efb(Object(C.a)(this,this.GWa,"onChangeRenderSelectionPane"));this.od.Gfb(Object(C.a)(this,this.GWa,"onChangeRenderSelectionPane"));this.Ob.QX(Object(C.a)(this,this.lw,"onAppFrameModeSwitched"))}xe(){const a=this.Fa.Dc(Yb.a.OF);a.bindAction(A.KeyInputManager.Na(w.a.o_a,6),ba.a.Gkc);a.bindAction(A.KeyInputManager.Na(w.a.boa,6),ba.a.hVb)}Gkc(a){return Ag.a("SelectionPaneBringBackward",a,()=>{this.DTa=!0;this.ia.processAction(ba.a.sendBackward,
2);Aa.a.J(512500434,822,50,"SelectionPane SendBackwardSelectionPane action is generated");return 32})}hVb(a){return Ag.a("SelectionPaneBringForward",a,()=>{this.DTa=!0;this.ia.processAction(ba.a.bringForward,2);Aa.a.J(512500433,822,50,"SelectionPane BringForwardSelectionPane action is generated");return 32})}ub(){this.ia.pa(ba.a.ifa,sc.a.application,Object(C.a)(this,this.ifa,"showHideSelectionPane"),4);this.ia.pa(ba.a.Scd,sc.a.application,Object(C.a)(this,this.Scd,"querySelectionPane"),96);this.ia.ya(ba.a.Gkc,
sc.a.application,Object(C.a)(this,this.Gkc,"sendBackwardSelectionPane"));this.ia.ya(ba.a.hVb,sc.a.application,Object(C.a)(this,this.hVb,"bringForwardSelectionPane"))}Scd(a,b,c,f,l){(a=Object(ua.a)(Nh.a,l))&&a.Nf(this.aA.isVisible);return 32}ifa(a,b,c){return 1===c?this.KQ&&this.ua.Ba?32:8:Ag.a("SelectionPaneOpen",a,()=>{this.aA.isVisible=!this.aA.isVisible;this.ngh();this.aA.isVisible?(this.MI.notesPane&&this.MI.notesPane.JUb()&&this.Fa.Ad(),this.Fa.Gj(Yb.a.OF,!0),this.KQ.focusShowAllButton()):this.Fa.Gj(Yb.a.OF,
!1);return 32})}lw(a){1===a.mode&&this.aA&&this.aA.isVisible&&(this.aA.isVisible=!1,this.Fa.Gj(Yb.a.OF,!1))}fvi(){const a={};this.tac=new va.ScriptSharpLegacyMap;var b=this.ua.Ba,c=b?b.jl(!0):null;b=this.nb.og();const f=new Ha.a;let l=0;if(c){c.reverse();for(const G of c)if(!G.isLocal)if(c=this.ufg(G,b),G.Jf){if(l++,c=this.Ea.Ow(G)){c.reverse();for(const R of c){c=this.ufg(R,b);let fa=null;for(const wa of R.IA){var x=void 0;wa.ShapeId.toString()in a?(x=Object(ua.a)(jA,a[wa.ShapeId.toString()]),this.tac.ga(wa.ShapeId).push(R.get_shapeId())):
(x=[R.get_shapeId()],this.tac.add(wa.ShapeId,x),x=this.mej(wa,b),a[wa.ShapeId.toString()]=x,fa?fa.children.push(x):f.add(x));fa=x}fa.children.push(c)}}}else f.add(c)}0<l&&!this.lEg&&(Aa.a.J(512500432,822,50,"SelectionPane Group count:{0}",l),this.lEg=!0);return f}ufg(a,b){const c=new jA;c.shapeId=a.get_shapeId();c.key=a.get_shapeId().toString();c.shapeName=a.shapeName;c.isHiddenShape=a.isHiddenShape;c.isFocussedShape=Array.contains(b,a);c.children=[];return c}mej(a,b){const c=new jA;c.shapeId=a.ShapeId;
c.shapeName=a.ShapeName;c.isHiddenShape=a.IsHidden;c.isFocussedShape=!1;const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");if(a=f.ZB(a.ShapeId))c.isFocussedShape=Array.contains(b,a),c.shapeName=a.shapeName,c.isHiddenShape=a.isHiddenShape;c.children=[];return c}ngh(){if(!this.ua.Ba)this.aA.isVisible=!1;else if(this.aA.isVisible){var a=this.fvi();if(this.HIf(a?a.toArray():null,this.pPg)){this.pPg=a?a.toArray():null;var b=this.C9.zi("UserAction","SelectionPane Rendering started");
this.KQ.renderSelectionPane(RQ.a.tlh,a.toArray());a=b.Kq.toString();b.stop();Aa.a.J(512500430,822,50,"SelectionPane Rendering Completed. Time(in ms) : {0}",a)}else Aa.a.J(512500431,822,50,"SelectionPane Rendering not required.")}}HIf(a,b){if(!a&&b||a&&!b)return!0;if(!a&&!b||!a.length&&!b.length)return!1;if(a.length!==b.length)return!0;for(let c=0;c<a.length;c++){const f=a[c],l=b[c];if(f||l)if(!f&&l||f&&!l||f.shapeId!==l.shapeId||f.key!==l.key||f.shapeName!==l.shapeName||f.isHiddenShape!==l.isHiddenShape||
f.isFocussedShape!==l.isFocussedShape||this.HIf(f.children,l.children))return!0}return!1}GWa(){this.ngh();this.DTa&&(this.aA.isVisible?this.Fa.Gj(Yb.a.OF,!0):this.Fa.Gj(Yb.a.OF,!1));this.DTa=!1}YNe(a,b,c){let f;const l=c.IA.length,x=[];f=!1;for(let G=0;G<l;G++){const R=c.IA[G];R.ShapeId===a&&(2===b?(R.IsHidden=!R.IsHidden,f=R.IsHidden):0===b?f=R.IsHidden=!0:1===b&&(f=R.IsHidden=!1));x.push(R)}return{returnValue:x,tLj:f}}omi(a){var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");
var c=this.tac.ga(a);if(!c||1>=c.length)Aa.a.J(512500429,801,10,"There should be atleast 2 child shapes in the nested group");else{var f=b.ZB(c[0]);if(f){var l=!1;a=({tLj:l}=this.YNe(a,2,f)).returnValue;for(const x of c){const G=(c=b.ZB(x))?Object(ua.a)(121,c.oc(this.az)):null;G&&(l?(G.ija(),this.nb.uW(c)&&this.nb.n7(c)):!l&&G.kKa())}b=this.Fb.ud(15);try{b.kc(f),f.IA=a}finally{b&&b.dispose()}}else Aa.a.J(512500428,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}ssh(a){const b=
this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");var c=b.jl(!0),f=[];for(const l of c)if(l.Jf){const x=this.Ea.Ow(l);f=f.concat.apply(f,x)}if((c=c.concat.apply(c,f))&&c.length){a&&(this.nb.kj(),this.nb.Wqa(c));for(const l of c)!a&&l.isHiddenShape?Object(ua.a)(121,l.oc(this.az)).kKa():a&&!l.isHiddenShape&&Object(ua.a)(121,l.oc(this.az)).ija();f=this.Fb.ud(15);try{f.kc(b);for(const l of c)!a&&l.isHiddenShape?l.isHiddenShape=!1:a&&!l.isHiddenShape&&(l.isHiddenShape=!0);for(let l of this.tac)if(!b.ZB(l.key)){const x=
l.value;if(!x||1>=x.length){Aa.a.J(512500427,801,10,"There should be atleast 2 child shapes in the nested group");continue}const G=b.ZB(x[0]);G?(c=[],c=a?this.YNe(l.key,0,G).returnValue:this.YNe(l.key,1,G).returnValue,G.IA=c):Aa.a.J(512500426,801,10,"ChildShapeNode for nested group with the given Id should not be NULL")}}finally{f&&f.dispose()}}}xOk(){this.KQ.addCloseSelectionPaneEventListener(()=>{Aa.a.J(512500425,822,50,"SelectionPane AddCloseSelectionPaneEventListener event is generated");this.aA.isVisible=
!1});this.KQ.addFocusSelectionPaneListener(()=>{Aa.a.J(512500424,822,50,"SelectionPane AddFocusSelectionPaneListener event is generated");this.Fa.Gj(Yb.a.OF,!0)});this.KQ.addSelectShapeEventListener(a=>{Aa.a.J(512500423,822,50,"SelectionPane AddSelectShapeEventListener event is generated");const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");(a=b.ZB(a))&&(a.isHiddenShape||this.nb.selectShape(a,!0))});this.KQ.addSelectMultipleShapesEventListener(a=>{Aa.a.J(512500422,822,50,"SelectionPane AddSelectMultipleShapesEventListener event is generated");
const b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");Ag.a("SelectionPaneMultiSelect",ba.a.ifa,()=>{if(!a.length){var c=this.nb.Yd();this.nb.Wqa(c)}c=0;for(const f of a){const l=b.ZB(f);l&&!l.isHiddenShape&&(c?this.nb.selectShape(l,!1):(this.nb.selectShape(l,!0),c++))}return 32})});this.KQ.addToggleVisibilityListener(a=>{Aa.a.J(512500421,822,50,"SelectionPane ToggleShapeVisibility event is generated");var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");const c=
b.ZB(a);b="";if(!c||c.Og||c.Jf)b="Group";Ag.b("SelectionPaneToggleVisibilty",b,ba.a.ifa,()=>{c?this.bRg.Vol(a):this.omi(a);return 32})});this.KQ.addShapeRenameListener((a,b)=>{Aa.a.J(512500420,822,50,"SelectionPane AddShapeRenameListener event is generated");var c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");c=c.ZB(a);let f="";if(!c||c.Og||c.Jf)f="Group";Ag.b("SelectionPaneRename",f,ba.a.ifa,()=>{this.bRg.p7k(a,b);return 32})});this.KQ.addShapeReorderListener((a,b)=>{Aa.a.J(512500419,
822,50,"SelectionPane AddShapeReorderListener event is generated");var c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");const f=c.ZB(a);let l="";if(!f||f.Og||f.Jf)l="Group";else if(c=c.ZB(b),!c||c.Og||c.Jf)l="Group";Ag.b("SelectionPaneReorder",l,ba.a.ifa,()=>{this.$7j.bgk(a,b);return 32})});this.KQ.addShowAllButtonEventListener(()=>{this.DTa=!0;Aa.a.J(512500418,822,50,"SelectionPane ShowOrHideAllShapes event is generated");Ag.a("SelectionPaneShowAll",ba.a.ifa,()=>{this.ssh(!1);return 32})});
this.KQ.addHideAllButtonEventListener(()=>{this.DTa=!0;Aa.a.J(512500417,822,50,"SelectionPane AddHideAllButtonEventListener event is generated");Ag.a("SelectionPaneHideAll",ba.a.ifa,()=>{this.ssh(!0);return 32})});this.KQ.addBringForwardButtonEventListener(()=>{this.DTa=!0;Aa.a.J(512500416,822,50,"SelectionPane AddBringForwardButtonEventListener event is generated");Ag.a("SelectionPaneBringForward",ba.a.ifa,()=>{this.ia.processAction(ba.a.bringForward,2);return 32})});this.KQ.addBringBackwardButtonEventListener(()=>
{this.DTa=!0;Aa.a.J(512500387,822,50,"SelectionPane AddBringBackwardButtonEventListener event is generated");Ag.a("SelectionPaneBringBackward",ba.a.ifa,()=>{this.ia.processAction(ba.a.sendBackward,2);return 32})});Aa.a.J(512500386,822,50,"SelectionPane RegisterSelectionPaneEventListeners is finished")}}Object(e.a)(jN,"SelectionPaneActor",null,[229]);class kN{constructor(a,b,c,f){this.bda=!1;this.$$b="ShapeAlignToSelectedObjects";this.ia=a;this.Mb=c;this.nb=b;this.D_=f}ub(){Aa.a.J(50630811,822,50,
"ShapeAlignmentActor::RegisterActions() - OptIn: True");this.ia.pa(ba.a.e$h,sc.a.application,Object(C.a)(this,this.ARa,"handleShapesAlignment"),4);this.ia.pa(ba.a.E9k,sc.a.application,Object(C.a)(this,this.ARa,"handleShapesAlignment"),4);this.ia.pa(ba.a.qMe,sc.a.application,Object(C.a)(this,this.ARa,"handleShapesAlignment"),4);this.ia.pa(ba.a.Eid,sc.a.application,Object(C.a)(this,this.ARa,"handleShapesAlignment"),4);this.ia.pa(ba.a.rMe,sc.a.application,Object(C.a)(this,this.ARa,"handleShapesAlignment"),
4);this.ia.pa(ba.a.Aid,sc.a.application,Object(C.a)(this,this.ARa,"handleShapesAlignment"),4);this.ia.pa(ba.a.Bid,sc.a.application,Object(C.a)(this,this.ARa,"handleShapesAlignment"),4);this.ia.pa(ba.a.Did,sc.a.application,Object(C.a)(this,this.ARa,"handleShapesAlignment"),4);this.ia.pa(ba.a.sPa,sc.a.application,Object(C.a)(this,this.Dkg,"handleShapesDistribution"),4);this.ia.pa(ba.a.yIc,sc.a.application,Object(C.a)(this,this.Dkg,"handleShapesDistribution"),4);this.ia.pa(ba.a.Ycd,sc.a.application,
Object(C.a)(this,this.Ycd,"queryShapeAlignToSlide"),96);this.ia.ya(ba.a.ISe,sc.a.application,Object(C.a)(this,this.ISe,"toggleShapeAlignToSlide"));this.ia.pa(ba.a.Xcd,sc.a.application,Object(C.a)(this,this.Xcd,"queryShapeAlignToSelectedObjects"),96);this.ia.ya(ba.a.HSe,sc.a.application,Object(C.a)(this,this.HSe,"toggleShapeAlignToSelectedObjects"))}xe(){}ice(){return u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up?!0:!1}ARa(a,b,c){if(this.D_){b=this.nb.Yd();for(const l of b)if(!l.getValue(sb.a.GSa))return 16}const f=
this.nb.og();return f?1===c?f.length?32:8:Ag.a("Align",a,()=>{Aa.a.J(50598728,822,50,"ShapeAlignmentActor::HandleShapesAlignment, Align operation performed");const l=[],x=1===f.length||this.bda?this.u5f(a):this.t5f(a,f);if(null===x)return Aa.a.J(50598730,822,10,"ShapeAlignmentActor::HandleShapesAlignment, error in finding reference point"),16;for(const G of f)l.push(new Ev(G,this.$9i(a,G,x)));if(!l[0].shapeNode.Og)for(const G of l)this.Pk(G.shapeNode).setPosition(G.position.x,G.position.y,!0);this.ia.La(ba.a.hHa,
2,l);return 32}):(Aa.a.J(50598726,822,10,"ShapeAlignmentActor::HandleShapesAlignment, selected nodes: null"),16)}Ycd(a,b,c,f,l){if(!l||!Object(Ma.a)(Nh.a,l))return Aa.a.J(50598732,822,10,"ShapeAlignmentActor::QueryShapeAlignToSlide Invalid actionData"),8;l.Nf(this.bda);Aa.a.J(50598734,822,50,"ShapeAlignmentActor::QueryShapeAlignToSlide: Align to Slide button is selected");return 32}ISe(a,b,c,f,l){a=this.nb.og();if(1===c)return 2>a.length&&(this.bda=!0,this.$$b="ShapeAlignToSlide",Aa.a.J(50598736,
822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide single shape selected, enable Align to slide button")),32;if(!l||"object"!==typeof l)return Aa.a.J(50598738,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSlide requires actionData"),8;this.ECh(l)&&(this.bda=!0,Aa.a.J(50598740,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSlide: Align to slide is enabled"));return 32}Xcd(a,b,c,f,l){if(!l||!Object(Ma.a)(Nh.a,l))return Aa.a.J(50598742,822,10,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects Invalid actionData"),
8;l.Nf(!this.bda);Aa.a.J(50598744,822,50,"ShapeAlignmentActor::QueryShapeAlignToSelectedObjects: Align Selected Objects button is enabled");return 32}HSe(a,b,c,f,l){a=this.nb.og();if(1===c)return 1<a.length?32:8;if(!l||"object"!==typeof l)return Aa.a.J(50598746,822,10,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects requires actionData"),8;this.ECh(l)&&(this.bda=!1,Aa.a.J(50598748,822,50,"ShapeAlignmentActor::ToggleShapeAlignToSelectedObjects: Align Selected Objects is enabled"));return 32}$9i(a,
b,c){let f=null;var l=this.Pk(b);b=l.AMc();l=l.Zr();switch(a){case ba.a.qMe:Aa.a.J(50598750,822,50,"ShapeAlignmentActor::ShapeAlignLeft: Align Left is selected ");f=new zc.a(b.x-l.Yb+c,b.y);break;case ba.a.Eid:Aa.a.J(50598752,822,50,"ShapeAlignmentActor::ShapeAlignRight: Align Right is selected");f=new zc.a(b.x+(c-l.Vb),b.y);break;case ba.a.rMe:Aa.a.J(50598754,822,50,"ShapeAlignmentActor::ShapeAlignTop: Align Top is selected");f=new zc.a(b.x,b.y-l.$b+c);break;case ba.a.Aid:Aa.a.J(50598784,822,50,
"ShapeAlignmentActor::ShapeAlignBottom: Align Bottom is selected");f=new zc.a(b.x,b.y+(c-l.Ub));break;case ba.a.Bid:Aa.a.J(50598786,822,50,"ShapeAlignmentActor::ShapeAlignCenter: Align Center is selected");f=new zc.a(b.x+(c-l.Vf().x),b.y);break;case ba.a.Did:Aa.a.J(50598788,822,50,"ShapeAlignmentActor::ShapeAlignMiddle: Align Middle is selected"),f=new zc.a(b.x,b.y+(c-l.Vf().y))}return f}Dkg(a,b,c){const f=this.nb.og();return f?1===c?!f.length||2===f.length&&!this.bda?8:32:Ag.a("Align",a,()=>{Aa.a.J(50902275,
822,50,"ShapeAlignmentActor::HandleShapesDistribution, Distribute operation performed");this.mPe(f,a,0,f.length-1);var l=1===f.length||2===f.length||this.bda?this.u5f(a):this.t5f(a,f);if(null===l)return Aa.a.J(527013341,815,10,"ShapeAlignmentActor::HandleShapesDistribution, error in finding reference point"),16;var x=l-this.oki(a,f);l=this.Zji(f,x);x=this.cki(a,f,x,l);this.OJi(a,f,f.length-1,l,x);return 32}):(Aa.a.J(50902273,822,10,"ShapeAlignmentActor::HandleShapesDistribution, selected nodes: null"),
16)}oki(a,b){return a===ba.a.sPa?this.pki(b):this.qki(b)}pki(a){let b=0;for(const c of a)a=this.Pk(c),b+=a.Zr().Ub-a.Zr().$b;return b}qki(a){let b=0;for(const c of a)a=this.Pk(c),b+=a.Zr().Vb-a.Zr().Yb;return b}cki(a,b,c,f){if(1===b.length||this.bda)return 0<c?f:0;b=this.Pk(b[0]);return a===ba.a.sPa?b.Zr().Ub+f:b.Zr().Vb+f}Zji(a,b){return(1===a.length||this.bda)&&0<b?1*b/(a.length+1):1*b/(a.length-1)}OJi(a,b,c,f,l){var x=0;const G=[];1<b.length&&!this.bda?(Aa.a.J(50902277,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Selected Objects"),
x++,c--):Aa.a.J(50902279,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute: Align to Slide");for(a===ba.a.sPa?Aa.a.J(50902281,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Vertically"):Aa.a.J(50902283,822,50,"ShapeAlignmentActor::DistributeShapes, Distribute Horizontally");x<=c;x++){const fa=b[x];if(!fa)continue;let wa=this.Pk(fa);if(wa){var R=wa.AMc();a===ba.a.sPa?(R=new zc.a(R.x,l),G.push(new Ev(fa,R)),l+=wa.Zr().Ub-wa.Zr().$b+f):(R=new zc.a(l,R.y),G.push(new Ev(fa,R)),l+=wa.Zr().Vb-
wa.Zr().Yb+f)}}if(G[0]&&!G[0].shapeNode.Og)for(const fa of G)this.Pk(fa.shapeNode).setPosition(fa.position.x,fa.position.y,!0);this.ia.La(ba.a.hHa,2,G)}u5f(a){const b=Object(ua.a)(553,this.nb.rn().oc(this.Mb.Ma));if(!b)return Aa.a.J(51500956,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide,Error in finding reference point: SlideViewElement is NULL, ActionID: {0}",a),null;switch(a){case ba.a.Eid:case ba.a.yIc:return b.mB.clientWidth;case ba.a.Aid:case ba.a.sPa:return b.mB.clientHeight;
case ba.a.Bid:return b.mB.clientWidth/2;case ba.a.Did:return b.mB.clientHeight/2;default:return Aa.a.J(51500958,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSlide, Error in finding reference point, ActionID: {0}",a),0}}t5f(a,b){switch(a){case ba.a.qMe:var c=Number.MAX_VALUE;for(const x of b)b=this.Pk(x),c=Math.min(b.Zr().Yb,c);return c;case ba.a.Eid:c=-Number.MAX_VALUE;for(const x of b)b=this.Pk(x),c=Math.max(b.Zr().Vb,c);return c;case ba.a.rMe:c=Number.MAX_VALUE;for(const x of b)b=this.Pk(x),
c=Math.min(b.Zr().$b,c);return c;case ba.a.Aid:c=-Number.MAX_VALUE;for(const x of b)b=this.Pk(x),c=Math.max(b.Zr().Ub,c);return c;case ba.a.Bid:var f=Number.MAX_VALUE,l=-Number.MAX_VALUE;for(c of b)b=this.Pk(c),f=Math.min(b.Zr().Yb,f),l=Math.max(b.Zr().Vb,l);return f+(l-f)/2;case ba.a.Did:c=Number.MAX_VALUE;l=-Number.MAX_VALUE;for(f of b)b=this.Pk(f),c=Math.min(b.Zr().$b,c),l=Math.max(b.Zr().Ub,l);return c+(l-c)/2;case ba.a.sPa:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(l of b)b=this.Pk(l),c=Math.min(c,
b.Zr().$b),f=Math.max(b.Zr().Ub,f);return f-c;case ba.a.yIc:c=Number.MAX_VALUE;f=-Number.MAX_VALUE;for(const x of b)b=this.Pk(x),c=Math.min(c,b.Zr().Yb),f=Math.max(b.Zr().Vb,f);return f-c;default:return Aa.a.J(51500960,822,10,"ShapeAlignmentActor::FindReferencePointRelativeToSelectedObjects, Error in finding reference point, ActionID: {0}, No of selectedNodes: {1}",a,b.length),null}}mPe(a,b,c,f){if(!(c>=f)){var l=this.Zvk(a,b,c,f);this.mPe(a,b,c,l-1);this.mPe(a,b,l+1,f)}}Zvk(a,b,c,f){if(b===ba.a.sPa)return this.awk(a,
c,f);if(b===ba.a.yIc)return this.$vk(a,c,f);Aa.a.J(50902285,822,10,"ShapeAlignmentActor::SortSelectedShapes:PartitionSelectedNodesList, actionId not supported");return-1}awk(a,b,c){var f=this.Pk(a[c]).Zr().Vf().y;let l=b-1;for(;b<=c-1;b++)if(this.Pk(a[b]).Zr().Vf().y<f){l++;const x=a[l];a[l]=a[b];a[b]=x}f=a[l+1];a[l+1]=a[c];a[c]=f;return l+1}$vk(a,b,c){var f=this.Pk(a[c]).Zr().Vf().x;let l=b-1;for(;b<=c-1;b++)if(this.Pk(a[b]).Zr().Vf().x<f){l++;const x=a[l];a[l]=a[b];a[b]=x}f=a[l+1];a[l+1]=a[c];a[c]=
f;return l+1}ECh(a){const b=a.SourceControlId;return a[ai.a.On]&&this.$$b!==b?(this.bda="ShapeAlignToSelectedObjects"===this.$$b,this.ice()&&(a={},a[b]="ToggleButtonModel",a[this.$$b]="ToggleButtonModel",Cb.App.Hb.VF(a)),this.$$b=b,!0):!1}Pk(a){return a?Object(ua.a)(121,a.oc(this.Mb.Ma)):null}}Object(e.a)(kN,"ShapeAlignmentActor",null,[229]);class Vx{}Object(e.a)(Vx,"CT_NoFillProperties",null,[]);class kA{constructor(a,b){this.dnl=a;this.snc=b}}Object(e.a)(kA,"FormatPainterData",null,[]);var lN=d(715);
class fi{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te){this.Qkl="data:image/svg+xml;charset=utf8,";this.FAe=96;this.ia=a;this.ra=G;this.fe=f;this.Fb=c;this.Fa=b;this.oC=l;this.Xb=x;this.Dle=fa;this.KI=R;this.Pne=Wa;this.XLg=(a=!Hc||!Hc.isInHighContrastMode)&&Kc.X9d;this.$W=Kc.powerPointGraphicToolTabIsEnabled;this.vne=a&&Kc.svgIconLocalEditingIsEnabled;this.Ocb=wa;this.az=Te;this.Ea=mb;this.rQ=Kb;this.HT=nc;this.Zb=oc;this.ua=Ic;this.tc=ie;this.Fp=Kc.pptTextFormatPainterIsEnabled;
this.ZIg=Kc.formatPainterApplyRemappedIsEnabled;this.PLg=Kc.FVc;this.abb=Kc.hBk;this.rT=Kc.KEb;this.la=Kc;this.aj=He;this.U$b=new va.ScriptSharpLegacyMap;this.bA=fe}ub(){this.ia.pa(ba.a.Xyk,sc.a.application,Object(C.a)(this,this.Opj,"handlePopulateShapeFillMenu"),96);this.ia.pa(ba.a.FVg,sc.a.application,Object(C.a)(this,this.Noj,"handleMoreFillColors"),96);this.ia.pa(ba.a.GVg,sc.a.application,Object(C.a)(this,this.Soj,"handleMoreOutlineColors"),96);this.ia.pa(ba.a.GUb,sc.a.application,Object(C.a)(this,
this.hjg,"handleApplyShapeFillColor"),4);this.ia.pa(ba.a.jKd,sc.a.application,Object(C.a)(this,this.Ylj,"handleApplyShapeFillCustomColor"),4);this.ia.pa(ba.a.$Hf,sc.a.application,Object(C.a)(this,this.hjg,"handleApplyShapeFillColor"),4);this.ia.pa(ba.a.WFe,sc.a.application,Object(C.a)(this,this.nkg,"handleRemoveShapeFill"),4);this.ia.pa(ba.a.neh,sc.a.application,Object(C.a)(this,this.nkg,"handleRemoveShapeFill"),4);this.ia.pa(ba.a.Yyk,sc.a.application,Object(C.a)(this,this.Ppj,"handlePopulateShapeOutlineMenu"),
96);this.ia.pa(ba.a.Lob,sc.a.application,Object(C.a)(this,this.ijg,"handleApplyShapeOutlineColor"),4);this.ia.pa(ba.a.kKd,sc.a.application,Object(C.a)(this,this.Zlj,"handleApplyShapeOutlineCustomColor"),4);this.ia.pa(ba.a.aIf,sc.a.application,Object(C.a)(this,this.ijg,"handleApplyShapeOutlineColor"),4);this.ia.pa(ba.a.ACc,sc.a.application,Object(C.a)(this,this.cmj,"handleApplyShapeOutlineWidth"),4);this.ia.pa(ba.a.yCc,sc.a.application,Object(C.a)(this,this.$lj,"handleApplyShapeOutlineDashStyle"),
4);this.PLg&&this.ia.pa(ba.a.nKd,sc.a.application,Object(C.a)(this,this.bmj,"handleApplyShapeOutlineSketchStyle"),4);this.ia.pa(ba.a.zCc,sc.a.application,Object(C.a)(this,this.amj,"handleApplyShapeOutlineEndStyle"),4);this.ia.pa(ba.a.XFe,sc.a.application,Object(C.a)(this,this.okg,"handleRemoveShapeOutline"),4);this.ia.pa(ba.a.oeh,sc.a.application,Object(C.a)(this,this.okg,"handleRemoveShapeOutline"),4);this.ia.pa(ba.a.x6a,sc.a.application,Object(C.a)(this,this.Zrj,"handleToggleFormatPainterActive"),
4);this.ia.pa(ba.a.Cia,sc.a.application,Object(C.a)(this,this.Plj,"handleApplyFormat"),4);this.ia.pa(ba.a.PYd,sc.a.application,Object(C.a)(this,this.Qlj,"handleApplyFormatToShape"),5);this.ia.pa(ba.a.vDe,sc.a.application,Object(C.a)(this,this.dqj,"handleQueryFormatPainter"),97);this.ia.pa(ba.a.oCk,sc.a.application,Object(C.a)(this,this.Vpj,"handlePreviewShapeFillColor"),4);this.ia.pa(ba.a.xXk,sc.a.application,Object(C.a)(this,this.Zqj,"handleRevertPreviewShapeFillColor"),4)}xe(){const a=this.Fa.Dc(Yb.a.Bg);
a.bindAction(A.KeyInputManager.Na(w.a.sya,6),ba.a.x6a);const b=this.Fa.Dc(Yb.a.LP);let c=A.KeyInputManager.Na(w.a.sya,6);b.np(c);this.Fp?b.bindAction(c,E.a.BLc):b.bindAction(c,ba.a.x6a);Aa.a.J(512500379,815,50,"formatPainterApplyRemapped: {0}",this.ZIg);this.ZIg||(c=A.KeyInputManager.Na(w.a.p_a,6),a.bindAction(c,ba.a.Cia),b.np(c),this.Fp?b.bindAction(c,ba.a.QYd):b.bindAction(c,ba.a.Cia))}stb(a,b){const c=[];if(a)for(const f of a)(f.Usa||b&&f.get_isSVGBlipFilled()||f.wk||this.rT&&1===f.mediaType)&&
Array.add(c,f);return c}$6a(a,b){const c=[];if(a)for(const f of a)(f.Usa&&!f.Ky||b&&f.get_isSVGBlipFilled()||this.abb&&f.qd)&&Array.add(c,f);return c}Opj(a,b,c,f,l){if(!this.ra.e3()||this.Xb.dC(this.ra.Yd()))return 16;if(1===c)return 32;if(!l)return 8;b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");a=b.j2;b=(c=this.ra.rq())?b.$B(c.slideId):null;if(!b)return 16;var x=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");c=x?ba.a.$Hf:ba.a.GUb;f=x?ba.a.neh:ba.a.WFe;const G=ba.a.FVg;
if(l.MenuId&&"fill"===l.MenuId){var R=new lN.a(b.Pe);x=new Sys.StringBuilder;x.append(String.format(fi.qMf,"PptRibbon.Drawing.ShapeFill"));if(!b.Pe)return 8;x.append(R.z4d(c,a,ba.a.jKd));x.append(fi.yMf);x.append(String.format(fi.wMf,f,u.AFrameworkApplication.gm,ResourceStrings.L_RemoveShapeFill,CommonUIStrings.l_RemoveShapeFillKeytip));x.append(fi.xMf);x.append(fi.Wii);x.append(String.format(fi.Uii,G,u.AFrameworkApplication.gm,ResourceStrings.L_MoreFillColors,CommonUIStrings.l_MoreFillColorsKeytip));
x.append(fi.Vii);x.append(fi.pMf);l.PopulationXML=x.toString()}else{R=Object.assign(new wj.a,{Id:"PptRibbon.Drawing.ShapeFill",MenuSectionList:[]});const fa=x?"StandardGraphicFillColorPicker":"StandardShapeFillColorPicker",wa=x?"GraphicNoFill":"ShapeNoFill";Array.add(R.MenuSectionList,Mk.f(b.Pe,DE.a.themeColors,"Color.Menu.Controls","themeColor",x?"ThemeGraphicFillColorPicker":"ThemeShapeFillColorPicker",c.toString(),1));Array.add(R.MenuSectionList,Mk.d("Standard Colors","Color.Menu.Controls","standardColor",
fa,c.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!1)),Array.add(R.MenuSectionList,Mk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeFillRecentColors","3745557472",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeFillRecentColors",!0));Array.add(R.MenuSectionList,Mk.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor",wa,
"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));Array.add(R.MenuSectionList,Mk.a("More Fill Color","Color.Menu.Controls",G.toString(),ResourceStrings.L_MoreFillColors,"Color.Menu.MoreFillColor","MoreFillColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreFillColorsKeytip));re.a("ColorPickerHighlighterFix")&&(a=this.Ydj(b.Pe),Mk.h(R,a,b.Pe));l.MenuItems=R}return 32}Ppj(a,b,c,f,l){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.ra.e3()||
this.Xb.dC(this.ra.Yd()))return 16;if(1===c)return 32;if(!l)return 8;c=(c=this.ra.rq())?a.$B(c.slideId):null;if(!c||!c.Pe)return 8;a=a.j2;var x=this.fe.hk("pegal.png"),G=!!l.MenuId&&-1!==l.MenuId.indexOf("Graphics");b=G?ba.a.aIf:ba.a.Lob;f=G?ba.a.oeh:ba.a.XFe;const R=ba.a.GVg;if(l.MenuId&&"outline"===l.MenuId){var fa=new Sys.StringBuilder;fa.append(String.format(fi.qMf,"PptRibbon.Drawing.ShapeOutline"));c=new lN.a(c.Pe);fa.append(c.z4d(b,a,ba.a.kKd));fa.append(fi.yMf);fa.append(String.format(fi.wMf,
f,u.AFrameworkApplication.gm,ResourceStrings.L_RemoveShapeOutline,CommonUIStrings.l_RemoveShapeOutlineKeytip));fa.append(fi.xMf);fa.append(fi.Zii);fa.append(String.format(fi.Xii,R,u.AFrameworkApplication.gm,ResourceStrings.L_MoreOutlineColors,CommonUIStrings.l_MoreOutlineColorsKeytip));fa.append(fi.Yii);c=this.ra.Yd();a=fi.Bdj(c,this.$W);if(!a||!a.length||c&&c.length!==a.length)fa.append('<MenuSection Id="OutlineEffects"><Controls Id="OutlineControls">'),fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineWeightAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineWidth_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineWeight">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineWeight" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineWeight.Controls">\r\n                         <Button\r\n                            Id="OutlineWidthPresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineWidthPresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_GalLineWidthStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ba.a.pKd,ba.a.ACc,u.AFrameworkApplication.gm,ResourceStrings.L_ApplyShapeOutlineWidth,ResourceStrings.L_ApplyShapeOutlineWidth_1,ResourceStrings.L_ApplyShapeOutlineWidth_2,ResourceStrings.L_ApplyShapeOutlineWidth_3,ResourceStrings.L_ApplyShapeOutlineWidth_4,x,CommonUIStrings.l_ApplyShapeOutlineWidthKeytip)),fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineDashesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_DashStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{8}">\r\n                   <Menu Id="MenuOutlineDashStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineDashStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineDashStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineDashStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{7}"\r\n                            Image16by16Class="pegal_DashStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ba.a.lKd,ba.a.yCc,u.AFrameworkApplication.gm,ResourceStrings.L_ApplyShapeOutlineDashStyle,ResourceStrings.L_ApplyShapeOutlineDashStyle_1,ResourceStrings.L_ApplyShapeOutlineDashStyle_2,ResourceStrings.L_ApplyShapeOutlineDashStyle_3,x,CommonUIStrings.l_PPTApplyShapeOutlineDashStyleKeytip)),this.PLg&&fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineSketchesAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_GalLineSketchy_16x16x32"\r\n                   LabelText="{3}">\r\n                   Keytip="{9}">\r\n                   <Menu Id="MenuOutlineSketchStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineSketchStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineSketchStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchNone_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleCurve_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchSubtleWave_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineSketchStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{8}"\r\n                            Image16by16Class="pegal_OartLineSketchIntenseWave_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ba.a.oKd,ba.a.nKd,u.AFrameworkApplication.gm,ResourceStrings.l_ApplyShapeOutlineSketchStyle,ResourceStrings.l_ApplyShapeOutlineSketchStyle_1,ResourceStrings.l_ApplyShapeOutlineSketchStyle_2,ResourceStrings.l_ApplyShapeOutlineSketchStyle_3,ResourceStrings.l_ApplyShapeOutlineSketchStyle_4,x,CommonUIStrings.l_PPTApplyShapeOutlineSketchStyleKeytip)),fa.append(String.format('<FlyoutAnchor\r\n                   Id="OutlineArrowsAnchor"\r\n                   Command="{0}"\r\n                   Image16by16="{2}"\r\n                   Image16by16Class="per_ArrowStyle_16x16x32"\r\n                   LabelText="{3}"\r\n                   Keytip="{12}">\r\n                   <Menu Id="MenuOutlineEndStyle">\r\n                      <MenuSection\r\n                         Id="MenuSectionOutlineEndStyle" DisplayMode="Menu16">\r\n                         <Controls Id="MenuSectionOutlineEndStyle.Controls">\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,1"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle1_16x16x32"\r\n                            LabelText="{4}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,2"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle2_16x16x32"\r\n                            LabelText="{5}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,3"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle3_16x16x32"\r\n                            LabelText="{6}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,4"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle4_16x16x32"\r\n                            LabelText="{7}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,5"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle5_16x16x32"\r\n                            LabelText="{8}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,6"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle6_16x16x32"\r\n                            LabelText="{9}"/>\r\n                         <Button\r\n                            Id="OutlineEndStylePresent,7"\r\n                            Command="{1}"\r\n                            Image16by16="{11}"\r\n                            Image16by16Class="pegal_ArrowStyle7_16x16x32"\r\n                            LabelText="{10}"/>\r\n                         </Controls>\r\n                      </MenuSection>\r\n                   </Menu>\r\n                </FlyoutAnchor>',
ba.a.mKd,ba.a.zCc,u.AFrameworkApplication.gm,ResourceStrings.L_ApplyShapeOutlineEndStyle,ResourceStrings.L_ApplyShapeOutlineEndStyle_1,ResourceStrings.L_ApplyShapeOutlineEndStyle_2,ResourceStrings.L_ApplyShapeOutlineEndStyle_3,ResourceStrings.L_ApplyShapeOutlineEndStyle_4,ResourceStrings.L_ApplyShapeOutlineEndStyle_5,ResourceStrings.L_ApplyShapeOutlineEndStyle_6,ResourceStrings.L_ApplyShapeOutlineEndStyle_7,x,CommonUIStrings.l_ApplyShapeOutlineEndStyleKeytip)),fa.append("</Controls></MenuSection>");
fa.append(fi.pMf);l.PopulationXML=fa.toString()}else{x=G?"ThemeGraphicOutlineColorPicker":"ThemeShapeOutlineColorPicker";fa=G?"StandardGraphicOutlineColorPicker":"StandardShapeOutlineColorPicker";const wa=G?"GraphicNoOutline":"ShapeNoOutline";G=Object.assign(new wj.a,{Id:"PptRibbon.Drawing.ShapeOutline",MenuSectionList:[]});Array.add(G.MenuSectionList,Mk.f(c.Pe,"Theme Colors","Color.Menu.Controls","themeColor",x,b.toString(),1));Array.add(G.MenuSectionList,Mk.d("Standard Colors","standardColor","Standard Colors",
fa,b.toString(),!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!1)),Array.add(G.MenuSectionList,Mk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","ShapeOutlineRecentColors","1244537109",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("ShapeOutlineRecentColors",!0));Array.add(G.MenuSectionList,Mk.b("Remove Color","Color.Menu.Controls",f.toString(),ResourceStrings.L_RemoveShapeOutline,"Color.Menu.RemoveColor",
wa,"per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeOutlineKeytip));Array.add(G.MenuSectionList,Mk.a("More Outline Color","Color.Menu.Controls",R.toString(),ResourceStrings.L_MoreOutlineColors,"Color.Menu.MoreOutlineColor","MoreOutlineColors","per_AppointmentColor0_16x16x32",CommonUIStrings.l_MoreOutlineColorsKeytip));re.a("ColorPickerHighlighterFix")&&(a=this.Xdj(c.Pe),Mk.h(G,a,c.Pe));l.MenuItems=G}return 32}Vpj(a,b,c,f,l){if(!l)return Aa.a.J(512500374,815,10,"HandlePreviewShapeFillColor: action data cannot be null."),
8;if(!this.la.dhc)return 2;b=this.ra.og();const x=this.$6a(b,this.$W);return x&&x.length?this.abb&&1===x.length&&x[0].qd?(Aa.a.J(512500372,815,50,"HandlePreviewShapeFillColor: Preview for table shapes to be handled separately."),32):Ag.a("HandlePreviewShapeFillColor:",a,()=>{const G=this.ra.wO(x),R=this.KI.sY(l),fa=Object.assign(new Mz.a,{});fa.solidFillField=R;for(const wa of G)wa?wa.qd||(this.U$b.Jb(wa.get_shapeId())?this.U$b.$(wa.get_shapeId(),wa.fill):this.U$b.add(wa.get_shapeId(),wa.fill),wa.fill=
fa,wa.Vea=null):Aa.a.J(512500371,822,50,"HandlePreviewShapeFillColor, shape with shape id : {0} is null",wa.get_shapeId());return 32}):(Aa.a.J(512500373,815,50,"HandlePreviewShapeFillColor: No shape is selected to show preview color."),16)}Zqj(a,b,c,f,l){if(!l)return Aa.a.J(512500370,815,10,"HandleRevertPreviewShapeFillColor: action data cannot be null."),8;if(!this.la.dhc)return 2;a=this.ra.og();a=this.$6a(a,this.$W);if(!a||!a.length)return Aa.a.J(512500369,815,50,"HandleRevertPreviewShapeFillColor: No shape is selected to show preview color."),
16;if(this.abb&&1===a.length&&a[0].qd)return Aa.a.J(512500368,815,50,"HandleRevertPreviewShapeFillColor: Preview for table shapes to be handled separately."),32;a=this.ra.wO(a);for(const x of a)if(!x)Aa.a.J(512500367,822,50,"HandleRevertPreviewShapeFillColor, shape with shape id : {0} is null",x.get_shapeId());else if(!x.qd)if(this.U$b.Jb(x.get_shapeId()))x.fill=this.U$b.ga(x.get_shapeId()),x.Vea=null;else return Aa.a.J(512500366,815,10,"HandleRevertPreviewShapeFillColor: last applied shape fill color cannot be empty."),
8;return 32}hjg(a,b,c,f,l){var x=this.ua.presentation;if(!x)throw Error.argumentNull("Presentation is null");f=this.ra.og();b=this.$6a(f,this.$W);const G={type:"ColorPickerPayload",color:""};l&&(G.color=l.Color);if(!(b&&0<b.length||this.ra.aL()&&this.szg(f[0],a,G))||this.Xb.dC(b))return 16;const R=this.ra.rq();x=R?x.$B(R.slideId):null;if(!x||!x.Pe||!x.Pe.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;if(this.abb&&1===b.length&&b[0].qd)return Aa.a.J(512500364,815,50,"HandleApplyShapeFillColor: send PowerPointCellShadingColor"),
this.ia.La(ba.a.mwa,c,l);c=fi.Zfc(l);if(!c)return 8;1<f.length?Aa.a.J(512500362,815,50,"HandleApplyShapeFillColor: Apply shape fill color on {0} selected shapes.",f.length):Aa.a.J(512500361,815,50,"HandleApplyShapeFillColor: Apply shape fill color on one selected shape.");for(var fa of f)if(fa.Jf||fa.Og){Qn(fa);break}if(this.ra.aL()&&this.szg(f[0],a,G)&&this.g5d(f[0],a,G))return 32;fa=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{fa.kc(b[0]);fa.fd=a;const wa=this.KI.sY(l),Wa=this.ra.wO(b);
for(const mb of Wa)if(mb.qd){if(!this.abb)continue;Aa.a.J(512500360,815,50,"HandleApplyShapeFillColor: Process table");const Kb=this.tc.iN(mb);if(!Kb){Aa.a.J(512500359,815,10,"HandleApplyShapeFillColor: Table Node from shape is null");continue}const nc=Kb.S1b();for(const oc of nc){const Ic=oc.cellShading;Kx(Ic);Ic.solidFillField=wa;oc.cellShading=Ic}}else{const Kb=this.W1f(mb);Kb&&(this.KI.JPa(Kb),Kb.solidFillField=wa,mb.fill=Kb,mb.Vea=null,this.nEh(mb,Kb));mb.NYa=JSON.stringify(c);this.ZGb(mb)}}finally{fa&&
fa.dispose()}return 32}Noj(a,b,c,f,l){if(1===c)return this.ia.La(ba.a.renderColorPicker,1,l);a=this.Wdj();b={};b.currentColor=a;b.handleCommand=ba.a.jKd;return this.ia.La(ba.a.renderColorPicker,2,b)}Ylj(a,b,c,f,l){if(1===c)return this.ia.La(ba.a.GUb,c,l);if(!l)return Aa.a.J(512500358,815,10,"HandleApplyShapeFillCustomColor: actionData is null"),16;a=this.ia.La(ba.a.GUb,c,l);32===a&&this.ia.La(ba.a.tAa,c,l);return a}Soj(a,b,c,f,l){a=this.ra.og();a=re.a("FixColorPickerPictureBorderColor")?this.stb(a,
this.$W):this.$6a(a,this.$W);a=this.ra.wO(a);if(1===c)return this.ia.La(ba.a.renderColorPicker,1,l);c=null;1===a.length&&a[0].nta&&(c=uf.Box4ColorHelper.Mra(a[0].nta));l={};l.currentColor=c;l.handleCommand=ba.a.kKd;return this.ia.La(ba.a.renderColorPicker,2,l)}nkg(a,b,c,f,l){f=this.ra.og();b=this.$6a(f,this.$W);const x=!!b&&0<b.length;if(this.Xb.dC(b))return 16;if(1===c)return x?32:8;if(!x)return 16;1<f.length?Aa.a.J(512500357,815,50,"HandleRemoveShapeFill: Remove shape fill on {0} selected shapes.",
f.length):Aa.a.J(512500356,815,50,"HandleRemoveShapeFill: Remove shape fill on one selected shape.");if(this.abb&&1===b.length&&b[0].qd)return Aa.a.J(512500355,815,50,"HandleRemoveShapeFill: send PowerPointRemoveCellShading"),this.ia.La(ba.a.gXa,c,l);c=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{c.kc(b[0]);c.fd=a;const G=this.ra.wO(b);for(const R of G)if(R.qd){if(!this.abb)continue;Aa.a.J(512500354,815,50,"HandleRemoveShapeFill: Process table");const fa=this.tc.iN(R);if(!fa){Aa.a.J(512500353,
815,10,"HandleRemoveShapeFill: Table Node from shape is null");continue}const wa=fa.S1b();for(const Wa of wa){const mb=Wa.cellShading;Kx(mb);mb.noFillField=new Vx;Wa.cellShading=mb}}else{const fa=this.W1f(R);fa&&(this.KI.JPa(fa),fa.noFillField=new Vx,R.fill=fa,R.Vea=null,this.nEh(R,fa));R.OPk();this.ZGb(R)}}finally{c&&c.dispose()}return 32}ijg(a,b,c,f,l){var x=this.ua.presentation;if(!x)throw Error.argumentNull("Presentation is null");f=this.ra.og();b=this.stb(f,this.$W);if(!(b&&0<b.length)||this.Xb.dC(b))return 16;
const G=this.ra.rq();x=G?x.$B(G.slideId):null;if(!x||!x.Pe||!x.Pe.PresetSchemeColorMapping)return 16;if(1===c)return 32;if(!l)return 8;c=fi.Zfc(l);if(!c)return 8;1<f.length?Aa.a.J(512500322,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on {0} selected shapes.",f.length):Aa.a.J(512500321,815,50,"HandleApplyShapeOutlineColor: Apply shape outline color on one selected shape.");for(var R of f)if(R.Jf||R.Og){Qn(R);break}R=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{R.kc(b[0]);
R.fd=a;const fa=this.ra.wO(b);for(const wa of fa){const Wa=this.LVd(wa);if(Wa){this.KI.JPa(Wa);const mb=this.KI.sY(l);Wa.solidFillField=mb;wa.lineStyle=Wa;wa.nta=null;this.Ynd(wa,Wa)}wa.ghb=JSON.stringify(c);this.ZGb(wa)}}finally{R&&R.dispose()}return 32}Zlj(a,b,c,f,l){if(1===c)return this.ia.La(ba.a.Lob,c,l);if(!l)return Aa.a.J(512500320,815,10,"HandleApplyShapeOutlineCustomColor: actionData is null"),16;a=this.ia.La(ba.a.Lob,c,l);32===a&&this.ia.La(ba.a.tAa,c,l);return a}cmj(a,b,c,f,l){f=this.ra.og();
b=this.stb(f,this.$W);if(!(b&&0<b.length)||this.Xb.dC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.APc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(c>=fi.Tjh.length||0>c)return 8;1<f.length?Aa.a.J(512500317,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on {0} selected shapes.",f.length):Aa.a.J(512500316,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline width on one selected shape.");l=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{l.kc(b[0]);
l.fd=a;const x=this.ra.wO(b);for(const G of x){const R=this.LVd(G);R&&(R.wField=fi.iZk[c],R.wFieldSpecified=!0,this.Ynd(G,R),this.N1f(R),G.lineStyle=R);G.outlineWidth=fi.Tjh[c];this.ZGb(G)}}finally{l&&l.dispose()}return 32}ZGb(a){this.Ea.$K(a)&&Nc.a.Eb&&(Nc.a.Eb.Oj=!0)}W1f(a){if(!this.XLg)return null;let b=a.fill;b||!a.$K&&!a.get_isSVGBlipFilled()||(b=new Mz.a);return b}LVd(a){var b=this.ua.presentation;if(!b)throw Error.argumentNull("Presentation is null");if(!this.XLg)return null;let c=a.lineStyle;
if(this.vne&&a.pVc()&&c&&c.wFieldSpecified){b=Object(ua.a)(120,b.$B(a.slideId));var f=this.aj.mG;b&&b.Fw&&null!=b.Fw.Pr&&(f=b.Fw.Pr);b=c.wField/f;f=this.z1b(a);if(!f||!f.$Na||!f.PCc)return c.wField=b,c;var l;(l=f.Fk&&f.Fk.NG&&f.Fk.NG.VK()&&1===f.Fk.NG.xa.childNodes.length?f.Fk.NG.xa.childNodes[0].getAttribute("width"):f.$Na.getAttribute("width"))&&!Ka.a.Va(l.toString())&&(l=parseFloat(l.toString()),isNaN(l)||(f=Math.sqrt(l*l/(f.kdi*f.PCc)),1E-6<f&&(b/=f)));c.wField=b}c||!a.$K&&!a.get_isSVGBlipFilled()||
(c=new gA);return c}N1f(a){if(a.noFillField||Nz(a))a.noFillField=null,a.solidFillField=Object.assign(new Nq.a,{schemeClrField:Object.assign(new cn.a,{valField:1})})}$lj(a,b,c,f,l){f=this.ra.og();b=this.stb(f,this.$W);if(!(b&&0<b.length)||this.Xb.dC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.APc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return 8;1<f.length?Aa.a.J(512500313,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on {0} selected shapes.",
f.length):Aa.a.J(512500312,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline dash style on one selected shape.");l=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{l.kc(b[0]);l.fd=a;const x=this.ra.wO(b);for(const G of x){const R=this.LVd(G);R&&(R.prstDashField=R.prstDashField||new hA,R.prstDashField.valField=this.Ebj(c),R.prstDashField.valFieldSpecified=!0,R.custDashField=null,this.Ynd(G,R),this.N1f(R),G.lineStyle=R);G.SDb=c;this.ZGb(G)}}finally{l&&l.dispose()}return 32}Ebj(a){switch(a){case 0:return 0;
case 1:return 8;case 3:return 2;default:return 0}}amj(a,b,c,f,l){f=this.ra.og();b=fi.w8i(f);if(!(b&&0<b.length)||this.Xb.dC(b))return 16;if(1===c)return 32;if(!l)return 8;c=this.APc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);l=parseInt(c)-1;if(0>l||l>=fi.Gjh.length)return 8;c=fi.Gjh[l];l=fi.eZk[l];1<f.length?Aa.a.J(512500308,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on {0} selected shapes.",f.length):Aa.a.J(512500307,815,50,"HandleApplyShapeOutlineEndStyle: Apply shape outline end style on one selected shapes.");
f=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{f.kc(b[0]);f.fd=a;const x=this.ra.wO(Array.isArray(b)?b:null);for(const G of x)G.q7k(c,l)}finally{f&&f.dispose()}return 32}okg(a,b,c){const f=this.ra.og();b=this.stb(f,this.$W);if(!(b&&0<b.length)||this.Xb.dC(b))return 16;if(1===c)return 32;1<f.length?Aa.a.J(512500306,815,50,"HandleRemoveShapeOutline: Remove shape outline on {0} selected shapes.",f.length):Aa.a.J(512500305,815,50,"HandleRemoveShapeOutline: Remove shape outline on one selected shape.");
c=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{c.kc(b[0]);c.fd=a;const l=this.ra.wO(b);for(const x of l){const G=x.lineStyle;G&&(this.KI.JPa(G),G.noFillField=new Vx,x.lineStyle=G,x.nta=null,this.Ynd(x,G));x.sQk();this.ZGb(x)}}finally{c&&c.dispose()}return 32}bmj(a,b,c,f,l){f=this.ra.og();b=this.stb(f,this.$W);if(!(b&&0<b.length)||fi.r0k(f))return 8;if(this.Xb.dC(b))return 16;if(1===c)return 32;if(!l)return Aa.a.J(512500304,815,50,"HandleApplyShapeOutlineSketchStyle requires actionData"),
8;c=this.APc(l[l.MenuItemId?"MenuItemId":"SourceControlId"]);c=parseInt(c)-1;if(0>c)return Aa.a.J(512500303,815,50,"Invalid outline sketch style ",c),8;1<f.length?Aa.a.J(512500301,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on {0} selected shapes.",f.length):Aa.a.J(512500300,815,50,"HandleApplyShapeOutlineWidth: Apply shape outline sketch style on one selected shape.");l=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{l.kc(b[0]);l.fd=a;for(const x of b)x.Cfc=c,
x.setValue(sb.a.d6b,!0)}finally{l&&l.dispose()}return 32}Zrj(a,b,c){b=this.ra.og();a=this.ra.rq();if(!(this.oC.isActive||1===b.length&&a&&a.gwh||this.Fp&&this.ra.Ija()))return 16;if(1===c)return 32;if(this.Xb.Zc(a))return 16;c=32;if(this.oC.isActive)this.oC.oOa();else if(this.Fp)if(this.rQ.TK)this.rQ.TK=!1;else{b=this.ra.Oa.kb;var f=null;if(b&&(f=b.Ua)&&(f.contextId===Bb.a.Of||f.contextId===Bb.a.textRange||f.contextId===Bb.a.endOfParagraph||f.contextId===Bb.a.paragraph))c=this.ia.processAction(E.a.BLc,
2);else if(a.qd&&this.ra.$Z(this.ra.Oa)){if(b=a.J3d())if(b=b.jf(0,0)){b.s4k(this.rQ);var l=b.C_b;f=-1;l&&(f=yb.ParagraphReader.textLength(Object(ua.a)(lg.a,l))+1);if(l=this.Zb.Ci){const x=this.Fb.ke(4),G=l.vi;x.kc(l);const R=this.HT.QCa(G),fa=Object(ua.a)(120,this.Dle.Vfg(b));this.HT.HVe(R,!0,!1,fa,a,b,null,0,f);(a=G.zhc(R))&&l.Axb(a);x.dispose()}}}else this.oC.J6g(a)}else this.oC.J6g(a);Cb.App.Hb.updateCommandUI();return c}Plj(a,b,c){return this.Fp&&(a=this.ra.Oa.kb)&&(a=a.Ua)&&(a.contextId===Bb.a.Of||
a.contextId===Bb.a.textRange||a.contextId===Bb.a.endOfParagraph||a.contextId===Bb.a.paragraph)?(this.oC.oOa(),this.ia.processAction(ba.a.QYd,2)):(a=this.ra.rq())?this.ia.La(ba.a.PYd,c,new kA(this.oC.cnl,a)):16}Qlj(a,b,c,f,l){if(!l||!Object(Ma.a)(kA,l))return Aa.a.J(512500299,822,10,"Invalid ActionData. Type: {0}",l?Object.getType(l).getName():"null"),8;if(this.Fp&&this.rQ.TK)return this.rQ.TK=!1,16;b=l.snc;if(!(this.oC.isActive&&b&&b.fwh))return this.oC.oOa(),16;if(this.Xb.Zc(b))return 16;if(1===
c)return 32;Nc.a.Eb&&(Nc.a.Eb.Oj=!1,Nc.a.Eb.actionName="FormatPainterApplyToShape",Nc.a.Eb.Kr=!0);c=this.Fb.ud(15,void 0,()=>{this.ra.kj();this.Fa.Ad()});try{c.kc(l.snc),c.fd=a,l.snc.zsb=l.dnl.id}finally{c&&c.dispose()}this.oC.oOa();return 32}dqj(a,b,c,f,l){if(!l||!Object(Ma.a)(Nh.a,l))return 8;l.Nf(this.oC.isActive||(this.Fp?this.rQ.TK:!1));return 32}YEk(a,b,c){return(a=this.z1b(a))&&Object(Ma.a)(Gs.a,a.Fk)&&(a=Object(ua.a)(Gs.a,a.Fk))?a.UCe(ba.a.Jz(b),c):!1}g5d(a,b,c){return(a=this.z1b(a))&&Object(Ma.a)(Gs.a,
a.Fk)&&(a=Object(ua.a)(Gs.a,a.Fk))?a.Mad(ba.a.Jz(b),c):!1}APc(a){return a.split(",")[1]}nEh(a,b){if(this.vne&&a.pVc()){var c=this.z1b(a),f=this.aTf(c,a);a=b.noFillField?null:this.UL(b,a);f=this.Ocb.ntl(f,a);this.gHf(c,f)}}Ynd(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");if(this.vne&&a.pVc()){var f=this.z1b(a),l=this.aTf(f,a);if(null!==l){if(b.noFillField)l=this.Ocb.sBh(l);else{if(b.wFieldSpecified){var x=Object(ua.a)(120,c.$B(a.slideId)),G=this.aj.mG;x&&x.Fw&&
null!=x.Fw.Pr&&(G=x.Fw.Pr);l=this.Ocb.tBh(l,b.wField,f.nd,G)}b.prstDashField&&b.prstDashField.valFieldSpecified&&(l=this.Ocb.otl(l,b.prstDashField.valField));if(b.solidFillField){b=this.UL(b,a);l=this.Ocb.sBh(l,b);if(!l)return;b=l.querySelectorAll(this.Ocb.NQe);x=!0;for(G=0;G<b.length;++G){const R=b[G].getAttribute("stroke-width");if(R&&!Ka.a.Va(R.toString())){x=!1;break}}x&&(a=Object(ua.a)(120,c.$B(a.slideId)),c=this.aj.mG,a&&a.Fw&&null!=a.Fw.Pr&&(c=a.Fw.Pr),l=this.Ocb.tBh(l,we.a.MAe/this.FAe,f.nd,
c))}}this.gHf(f,l)}}}UL(a,b){const c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");b=c.$B(b.slideId);return this.KI.fGb(a,b.Pe)}gHf(a,b){if(b&&a&&a.Fk){a.Fk.hZ.Ld(!1);var c=a.Fk.NG.xa.childNodes;for(let f=0;f<c.length;++f)a.Fk.NG.xa.removeChild(c[f]);a.Fk.NG.xa.appendChild(b);(b=a.$Na.getAttribute("transform"))&&a.Fk.NG.xa.setAttribute("transform",b.toString());a.Fk.NG.Ld(!0);Nc.a.Eb&&(Nc.a.Eb.Oj=!0,Nc.a.Eb.WE=new Date)}}szg(a,b,c){return re.a("EnableSmartArtFillColor")&&
this.YEk(a,b,c)}Wdj(){var a=this.ra.og();a=this.$6a(a,this.$W);var b=this.ra.wO(a),c=null;a=null;re.a("FixColorPickerSelectedColor")&&(a=this.ua.Ba);if(1===b.length){if(b[0].Vea)c=uf.Box4ColorHelper.Mra(b[0].Vea);else if(b[0].qd&&re.a("FixColorPickerSelectedColor")){const f=this.ra.Ey();if(!f||!f.length){if(b=this.ra.Yo())b=b.jf(0,0),c=uf.Box4ColorHelper.vCa(b.cellShading.solidFillField,a.Pe);return c}c=f[0];c=c.cellShading&&c.cellShading.solidFillField&&a?uf.Box4ColorHelper.vCa(c.cellShading.solidFillField,
a.Pe):this.bA.uMc(Object(ua.a)(lg.a,c))}!c&&re.a("FixColorPickerSelectedColor")&&b[0].fill&&b[0].fill.solidFillField&&(c=uf.Box4ColorHelper.vCa(b[0].fill.solidFillField,a.Pe))}return c}Vol(a){var b=this.ua.Ba;if(!b)throw Error.argumentNull("ActiveSlide is null");b=b.ZB(a).isHiddenShape;this.s7k(a,b)}Uol(a,b){a.isHiddenShape=!b;const c=Object(ua.a)(121,a.oc(this.az));b?c.kKa():(c.ija(),this.ra.uW(a)&&this.ra.n7(a))}s7k(a,b){const c=this.Fb.ud(15,void 0,()=>{this.ra.kj()});try{const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");
const l=f.ZB(a);c.kc(l);this.Uol(l,b)}finally{c&&c.dispose()}}p7k(a,b){const c=this.Fb.ud(15,void 0,()=>{this.ra.kj()});try{const f=this.ua.Ba;if(!f)throw Error.argumentNull("ActiveSlide is null");const l=f.ZB(a);c.kc(l);l.shapeName=b}finally{c&&c.dispose()}}Udj(){var a=this.ra.og();a=this.$6a(a,this.$W);return this.ra.wO(a)}Ydj(a){const b=this.Udj();return b&&1===b.length?b[0].qd?this.bA.H9f(this.ra.Ey()):b[0].fill&&b[0].fill.solidFillField?uf.Box4ColorHelper.vCa(b[0].fill.solidFillField,a):null:
null}Xdj(a){const b=this.ra.og();return b&&1===b.length&&b[0].lineStyle&&b[0].lineStyle.solidFillField?uf.Box4ColorHelper.vCa(b[0].lineStyle.solidFillField,a):null}z1b(a){return a?Object(ua.a)(121,a.oc(this.az)):null}aTf(a,b){try{if(!(a&&a.$Na&&a.Fk&&a.Fk.NG))return null;if(a.Fk.NG.VK()){if(!a.Fk.NG.xa)return null;const l=a.Fk.NG.xa.childNodes;for(a=0;a<l.length;++a)if("svg"===l[a].tagName.toLowerCase())return l[a];return null}if(!a.$Na.getAttribute(Bk.a.GRc))return null;let c=a.$Na.getAttribute(Bk.a.GRc).toString();
if(!c.toLowerCase().startsWith(this.Qkl))return null;c=decodeURIComponent(c.substr(c.indexOf(",")+1));const f=this.Pne.sanitize(c);return f&&1===f.children.length?f.children[0]:(b.ORa=!0,null)}catch(c){return Aa.a.J(512500295,815,10,"ConvertSourceToDOMElement Unexpected exception when update svg domelement fill: {0}, stack: {1}",c.message,c.stack),null}}static Bdj(a,b){const c=[];if(a)for(const f of a)b&&f.get_isSVGBlipFilled()&&Array.add(c,f);return c}static w8i(a){if(!a)return null;const b=[];for(const c of a)c.Ky&&
Array.add(b,c);return b}static r0k(a){let b;for(let c=0;c<a.length;c++){if(!a[c])return!0;b=a[c].shapeType;if(127===b||121===b||124===b)return!0}return!1}static Zfc(a){return nu.a.parse(a.Color)}}fi.Tjh=[.5,1,2.25,4.5];fi.iZk=[6350,12700,28575,57150];fi.Gjh=[0,0,2,2,0,1,1];fi.eZk=[0,2,0,2,1,0,1];fi.qMf='<Menu Id="{0}">';fi.yMf='<MenuSection Id="Remove Color"><Controls Id="Color.Menu.Controls">';fi.wMf='<Button Id="Color.Menu.RemoveColor" Command="{0}" Image16by16="{1}" Image16by16Class="per_AppointmentColor0_16x16x32" LabelText="{2}" Keytip="{3}" />';
fi.xMf="</Controls> </MenuSection>";fi.Wii='<MenuSection Id="More Fill Colors"><Controls Id="Color.Menu.Controls">';fi.Uii='<Button Id="Color.Menu.MoreFillColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';fi.Vii="</Controls> </MenuSection>";fi.Zii='<MenuSection Id="More Outline Colors"><Controls Id="Color.Menu.Controls">';fi.Xii='<Button Id="Color.Menu.MoreOutlineColors" Command="{0}" Image16by16="{1}" Image16by16Class="per_MoreColors_16x16x32" LabelText="{2}" Keytip="{3}" />';
fi.Yii="</Controls> </MenuSection>";fi.pMf="</Menu>";Object(e.a)(fi,"ShapesFormatActor",null,[229]);class pi{constructor(a,b,c){this.F4c=Array(pi.EV);this.Z1c=Array(pi.EV);this.tfe=Array(pi.EV);if(!a)throw Error.argumentNull("mainMasterResources");if(!b)throw Error.argumentNull("theme");if(!c)throw Error.argumentNull("resourceViewElementResolver");this.OI=a;this.qm=b;this.k6c=c;this.Lua={}}dispose(){Array.clear(this.F4c);Array.clear(this.Z1c);this.qm=this.OI=null;const a=ta.a.JK(this.Lua);a.length&&
appChrome.api.unregisterIcons(a);this.Lua=null}get pj(){return this.OI.MasterId}q2d(a,b,c){const f=Object.assign(new wj.a,{Id:"PptRibbon.DrawingFormat.StylesMenu",MenuSectionList:[]});var l=Object.assign(new Mi.a,{Id:"MenuSectionShapeStyles",ControlsId:"MenuSectionShapeStyles.Controls",Title:"Quick Styles",DisplayMode:"Size48by48",ControlList:[]});Array.add(f.MenuSectionList,l);var x=c?"GraphicsStyleSection":"ApplyShapeStyleSection",G=c?"GraphicsStyleGallery":"ApplyShapeStyleGallery";x=Object.assign(new tq.a,
{Id:"ControlsShapeStyles",ExternalId:x,ExternalGalleryId:G,Type:4,Width:pi.EV,ElementDimensions:"Size48by48",GalleryItems:[]});Array.add(l.ControlList,x);l=pi.EV*(a?pi.RLf:pi.VLf);c&&(l=pi.EV*pi.ULf);for(G=0;G<l;++G){const R=c?"ApplyGraphicsStyle"+G:"ApplyShapeStyle"+G;Array.add(x.GalleryItems,c?this.iZd(R,G,a,b,!0):this.iZd(R,G,a,b,!1))}return f}iZd(a,b,c,f,l){if(l){var x=this.OI?this.OI.SVGStyles[b]:null;c="SVGStyle";x=x?x.ToolTip:""}else x=this.OI?this.OI.ShapeStyles[b]:null,c=c?"LineStyle":"ShapeStyle",
x=x?this.e3d(x.StyleId):"";return Object.assign(new eE.a,{Id:a,ExternalId:a,Icon:pi.n1b(c,f,b),PreviewIconStyle:pi.Gbj(),Command:l?"2748140308":"1963674920",QueryCommand:l?"1903137544":"2375118752",Alt:x})}led(a){this.addIconToMap(this.OI.ShapeStyles,"ShapeStyle");this.addIconToMap(this.OI.LineStyles,"LineStyle");a&&this.addIconToMap(this.OI.SVGStyles,"SVGStyle");appChrome.api.registerIconProvider(()=>this.Lua)}Eej(a){if(a<pi.EV&&this.F4c[a])return this.F4c[a];if(a>=this.OI.ShapeStyles.length)return"";
var b=this.OI.ShapeStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.e3d(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.M_d(this.k6c.resolve(Jg.a.Drb,b.Icon.ImgId)),
l,f);a<pi.EV&&(this.F4c[a]=b);return b}zdj(a){if(a<pi.EV&&this.tfe[a])return this.tfe[a];if(a>=this.OI.SVGStyles.length)return"";var b=this.OI.SVGStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.ffg(b.StyleId);b=
String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.M_d(this.k6c.resolve(Jg.a.Drb,b.Icon.ImgId)),l,f);a<pi.EV&&(this.tfe[a]=b);return b}u8i(a){if(a<pi.EV&&this.Z1c[a])return this.Z1c[a];if(a>=this.OI.LineStyles.length)return"";var b=this.OI.LineStyles[a];const c=String.format("width:{0}px; height:{1}px; position:relative; overflow:hidden; display:inline-block;",b.Icon.Clip.Bounds.Right-b.Icon.Clip.Bounds.Left,b.Icon.Clip.Bounds.Bottom-b.Icon.Clip.Bounds.Top),f=String.format("position:absolute; top:{0}px; left:{1}px;",
-1*b.Icon.Clip.Bounds.Top,-1*b.Icon.Clip.Bounds.Left),l=this.zcg(b.StyleId);b=String.format('<Span Style="{0}"><Img Src="{1}" Alt="{2}" Style="{3}"></Span>',c,this.M_d(this.k6c.resolve(Jg.a.Drb,b.Icon.ImgId)),l,f);a<pi.EV&&(this.Z1c[a]=b);return b}e3d(a){let b=null;switch(parseInt(String(a/pi.EV))){case 0:b=ResourceStrings.l_ShapeStyleColoredOutline;break;case 1:b=ResourceStrings.l_ShapeStyleColoredFill;break;case 2:b=ResourceStrings.l_ShapeStyleLightOutlineColoredFill;break;case 3:b=ResourceStrings.l_ShapeStyleSubtleEffect;
break;case 4:b=ResourceStrings.l_ShapeStyleModerateEffect;break;case 5:b=ResourceStrings.l_ShapeStyleIntenseEffect}let c;({color:a,myh:c}=this.b$f(a));return String.format(b,a.toString(),c)}ffg(a){return(a=this.OI?this.OI.SVGStyles[a]:null)?a.ToolTip:""}zcg(a){let b=null;switch(parseInt(String(a/pi.EV))){case 0:b=ResourceStrings.l_LineStyleSubtleEffect;break;case 1:b=ResourceStrings.l_LineStyleModerateEffect;break;case 2:b=ResourceStrings.l_LineStyleIntenseEffect}let c;({color:a,myh:c}=this.b$f(a));
return String.format(b,a.toString(),c)}M_d(a){return null===a?"":Ka.a.t3b(a)}addIconToMap(a,b){for(let f=0;f<a.length;++f){var c=a[f];const l=pi.n1b(b,this.pj,f),x={},G={};G.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top);G.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left);G.position="absolute";x.root=G;c=appChrome.buildImageIconFromUrl(this.k6c.resolve(Jg.a.Drb,c.Icon.ImgId),x);this.Lua[l]=c}}b$f(a){let b,c;c=b=null;a%=pi.EV;switch(a){case 0:b=Vi.Color.Oi(this.qm.Dark1);c=String.format(ResourceStrings.l_DarkFormat,
1);break;case 1:b=Vi.Color.Oi(this.qm.Accent1);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 2:b=Vi.Color.Oi(this.qm.Accent2);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 3:b=Vi.Color.Oi(this.qm.Accent3);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 4:b=Vi.Color.Oi(this.qm.Accent4);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 5:b=Vi.Color.Oi(this.qm.Accent5);c=String.format(ResourceStrings.L_AccentFormat,a);break;case 6:b=Vi.Color.Oi(this.qm.Accent6),
c=String.format(ResourceStrings.L_AccentFormat,a)}return{color:b,myh:c}}static get qei(){return pi.IYk}static get oei(){return pi.GYk}static get pei(){return pi.HYk}static Gbj(){const a={},b=28/48,c=(28-28*b)/2,f={};f.width=String.format("{0}px",28);f.height=String.format("{0}px",28);f.transform=String.format("matrix({0},0,0,{1},-{2},-{3})",b,b,c,c);a.root=f;return a}static NZd(a,b){const c=new Sys.StringBuilder;c.append('<Menu Id="PptRibbon.DrawingFormat.StylesMenu">');c.append('<MenuSection Id="MenuSectionShapeStyles"><Gallery Id="ControlsShapeStyles" ElementDimensions="Size48by48" Width="7">');
a*=pi.EV;for(let f=0;f<a;++f)c.append(String.format('<GalleryButton Id="Style{0}" ElementDimensions="Size48by48" Command="{1}" QueryCommand="{2}" Alt="" InnerHTML=""/>',f,b?ba.a.vCc:ba.a.HUb,b?ba.a.gDe:ba.a.EDe));c.append("</Gallery> </MenuSection>");c.append("</Menu>");return c.toString()}static n1b(a,b,c){return String.format("{0}_{1}_{2}",a,b,c)}}pi.EV=7;pi.VLf=6;pi.ULf=4;pi.RLf=3;pi.IYk=pi.NZd(pi.VLf,!1);pi.HYk=pi.NZd(pi.RLf,!1);pi.GYk=pi.NZd(pi.ULf,!0);Object(e.a)(pi,"StyleGalleryBuilder",null,
[106]);class mN{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){this.HBb="";this.Zyb=[];this.ia=a;this.$p=b;this.Af=c;this.Fa=l;this.Fb=f;this.yu=x;this.dBb=G;this.ra=R;this.Ea=fa;this.Xa=wa;this.$W=Wa;mb.JB(Object(C.a)(this,this.to,"onSessionRehydrated"));this.Xa.lFf(Object(C.a)(this,this.o$c,"onSessionInfoChanged"))}ub(){this.ia.pa(ba.a.EDe,sc.a.application,Object(C.a)(this,this.gqj,"handleQueryShapesStyle"),97);this.ia.pa(ba.a.Zyk,sc.a.application,Object(C.a)(this,this.Qpj,"handlePopulateShapesStyles"),
96);this.ia.pa(ba.a.HUb,sc.a.application,Object(C.a)(this,this.dmj,"handleApplyShapesStyle"),4);this.ia.pa(ba.a.gDe,sc.a.application,Object(C.a)(this,this.eqj,"handleQueryGraphicsStyle"),97);this.ia.pa(ba.a.Fyk,sc.a.application,Object(C.a)(this,this.Npj,"handlePopulateGraphicsStyles"),96);this.ia.pa(ba.a.vCc,sc.a.application,Object(C.a)(this,this.Slj,"handleApplyGraphicsStyle"),4)}xe(){}eqj(a,b,c,f,l){return this.T2f(l,!0)}gqj(a,b,c,f,l){return this.T2f(l,!1)}T2f(a,b){var c=this.$p.presentation;if(!c)throw Error.argumentNull("Presentation is null");
if(!a||!Object(Ma.a)(Pv,a))return 8;var f=a.tU.startsWith("Style")?"Style":b?"ApplyGraphicsStyle":"ApplyShapeStyle";f=parseInt(a.tU.substr(f.length));if(isNaN(f)||0>f)return Aa.a.J(509678939,822,10,"ExecuteQuery{0}Style: Invalid style id recieved from the gallery",b?"Graphics":"Shapes"),8;var l=this.ra.og();if(!l||!l.length)return 16;const x=a.tXa;if(!x)return 8;var G=c.$B(l[0].slideId);if(!G)return 16;c=G.pj;G=this.sbg(G);a.tU.startsWith(b?"ApplyGraphicsStyle":"ApplyShapeStyle")?(this.HBb=(l=this.lUb(l))?
"SGT_Line":"SGT_Shape",x.J2=G?G.iZd(a.tU,f,l,c,b?!0:!1):null):G?(this.lUb(l)?(this.HBb="SGT_Line",x.qCa=G.u8i(f),x.Jsb=G.zcg(f)):b?(this.HBb="SGT_SVG",x.qCa=G.zdj(f),x.Jsb=G.ffg(f)):(this.HBb="SGT_Shape",x.qCa=G.Eej(f),x.Jsb=G.e3d(f)),x.pU(!1)):(x.qCa="",x.Jsb="");return 32}Npj(a,b,c,f,l){return this.R2f(c,l,!0)}Qpj(a,b,c,f,l){return this.ra.kSa()?8:this.R2f(c,l,!1)}R2f(a,b,c){var f=this.$p.presentation;if(!f)throw Error.argumentNull("Presentation is null");if(1===a)return 32;if(!b)return Aa.a.J(509678937,
822,10,"ExecutePopulate{0}Styles - Invalid action data",c?"Graphics":"Shapes"),8;a=this.ra.og();f=a[0]?f.$B(a[0].slideId):null;const l=this.sbg(f);if(b.MenuId&&"style"===b.MenuId)this.lUb(a)?b.PopulationXML=pi.pei:b.PopulationXML=c?pi.oei:pi.qei;else{this.HBb=(a=this.lUb(a))?"SGT_Line":"SGT_Shape";if(!f)return 16;b.MenuItems=l?l.q2d(a,f.pj,c?!0:!1):null}return 32}Slj(a,b,c,f,l){if(re.a("FixForPictureAndGraphicsStyleForGrpShapes")){if(0>=this.Zdj().length)return 8}else if(!this.Ea.bnc(this.ra.og()))return 16;
return this.jjg(a,c,l,!0)}Zdj(){var a=this.ra.Yd();const b=[];let c=!1;for(const f of a){if(!f)return b.length=0,b;f.Og&&(c=!0)}if(c)for(const f of a)f.Og&&this.Ea.bnc([f])&&b.push(f);else for(const f of a)if(this.Ea.bnc([f]))b.push(f);else if(f.Jf){a=this.Ea.Ow(f);for(const l of a)this.Ea.bnc([l])&&b.push(l)}return b}dmj(a,b,c,f,l){return this.N9k(this.ra.og())?this.jjg(a,c,l,!1):16}jjg(a,b,c,f){var l=this.$p.presentation;if(!l)throw Error.argumentNull("Presentation is null");const x=this.ra.og();
if(!x||!x.length||this.Af.dC(x))return 16;l=l.$B(x[0].slideId);var G=this.yu.Qcg(l);if(!G)return this.yu.Qil(l),Aa.a.J(509678936,822,15,"HandleApply{0}Style - MainMasterResources are missing",f?"Graphics":"Shapes"),8;if(1===b)return 32;if(!c)return Aa.a.J(509678935,822,10,"HandleApply{0}Style - Invalid action data",f?"Graphics":"Shapes"),8;b=this.lUb(x)?G.LineStyles.length:G.ShapeStyles.length;G=c.startsWith("Style")?"Style":f?"ApplyGraphicsStyle":"ApplyShapeStyle";c=parseInt(c.substr(G.length));
if(isNaN(c)||0>c||c>=b)return Aa.a.J(509678934,822,10,"HandleApply{0}Style - Invalid style id recieved from gallery",f?"Graphics":"Shapes"),16;1===x.length?Aa.a.J(509678933,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on only one {1}.",f?"Graphics":"Shapes",f?"SVG":"Shape"):1<x.length&&Aa.a.J(509678932,815,50,"ShapesStyleActor::HandleApply{0}Style Applying style on {1} {2}.",f?"Graphics":"Shapes",x.length,f?"SVGs":"Shapes");f=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.kj()});try{f.kc(Object(ua.a)(120,
l));f.fd=a;const R=this.ra.wO(Array.isArray(x)?x:null);for(const fa of R)fa&&fa.r7k(c,this.HBb)}finally{f&&f.dispose()}return 32}o$c(){for(const a of this.Zyb)a.dispose();Array.clear(this.Zyb)}sbg(a){const b=this.yu.Qcg(a);if(!b||!a)return Aa.a.J(509678931,815,15,"ShapesStyleActor::GetGalleryBuilderForCurrentSlide: MainMasterResource is null now!"),null;for(const c of this.Zyb)if(c.pj===a.pj)return c;a=new pi(b,a.Pe,this.dBb);Array.add(this.Zyb,a);a.led(this.$W);return a}N9k(a){if(!a||!a.length||
this.Ea.ZBc(a))return!1;for(const b of a)if(b.Usa)return!0;return!1}lUb(a){if(!a)return!1;for(const b of a)if(!b.Ky)return!1;return!0}to(){this.Sva()}Sva(){this.yu.clearCache();for(const a of this.Zyb)a.dispose();Array.clear(this.Zyb)}}Object(e.a)(mN,"ShapesStyleActor",null,[229,1027]);class Tv{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){this.ex=this.Fm=-1;this.xv=a;this.ia=b;this.Fa=c;this.Af=f;this.Sy=l;this.ra=x;this.nj=G;this.Ea=R;this.N4j=fa;this.S4j=wa;this.Pka=Wa;this.tc=mb}get Gb(){return this.ra}ub(){this.ia.pa(ba.a.FYa,
sc.a.application,Object(C.a)(this,this.qRa,"handleFontFormatAction"),4);this.ia.pa(ba.a.GYa,sc.a.application,Object(C.a)(this,this.qRa,"handleFontFormatAction"),4);this.ia.pa(ba.a.HYa,sc.a.application,Object(C.a)(this,this.qRa,"handleFontFormatAction"),4);this.ia.pa(ba.a.Elc,sc.a.application,Object(C.a)(this,this.qRa,"handleFontFormatAction"),4);this.ia.pa(ba.a.XHb,sc.a.application,Object(C.a)(this,this.qRa,"handleFontFormatAction"),4);this.ia.pa(ba.a.CHb,sc.a.application,Object(C.a)(this,this.qRa,
"handleFontFormatAction"),4);this.ia.pa(ba.a.zHb,sc.a.application,Object(C.a)(this,this.B2b,"handleFont"),5);this.ia.pa(ba.a.Tgb,sc.a.application,Object(C.a)(this,this.B2b,"handleFont"),5);this.ia.pa(ba.a.Ugb,sc.a.application,Object(C.a)(this,this.B2b,"handleFont"),5);this.ia.pa(ba.a.vMe,sc.a.application,Object(C.a)(this,this.Lpj,"handlePopulateFontNameDropdown"),97);this.ia.pa(ba.a.ehb,sc.a.application,Object(C.a)(this,this.B2b,"handleFont"),4);this.ia.pa(ba.a.VHb,sc.a.application,Object(C.a)(this,
this.B2b,"handleFont"),4);this.ia.pa(ba.a.Ilc,sc.a.application,Object(C.a)(this,this.qRa,"handleFontFormatAction"),4);this.ia.pa(ba.a.Hlc,sc.a.application,Object(C.a)(this,this.qRa,"handleFontFormatAction"),4);this.ia.pa(ba.a.lic,sc.a.application,Object(C.a)(this,this.tub,"handleQueryFontToggleButton"),97);this.ia.pa(ba.a.mic,sc.a.application,Object(C.a)(this,this.tub,"handleQueryFontToggleButton"),97);this.ia.pa(ba.a.oic,sc.a.application,Object(C.a)(this,this.tub,"handleQueryFontToggleButton"),97);
this.ia.pa(ba.a.nic,sc.a.application,Object(C.a)(this,this.tub,"handleQueryFontToggleButton"),97);this.ia.pa(ba.a.bdd,sc.a.application,Object(C.a)(this,this.rQc,"handleQueryFont"),100);this.ia.pa(ba.a.$cd,sc.a.application,Object(C.a)(this,this.rQc,"handleQueryFont"),100);this.ia.pa(ba.a.cdd,sc.a.application,Object(C.a)(this,this.rQc,"handleQueryFont"),97);this.ia.pa(ba.a.ddd,sc.a.application,Object(C.a)(this,this.rQc,"handleQueryFont"),97);this.ia.pa(ba.a.jdd,sc.a.application,Object(C.a)(this,this.tub,
"handleQueryFontToggleButton"),97);this.ia.pa(ba.a.idd,sc.a.application,Object(C.a)(this,this.tub,"handleQueryFontToggleButton"),97)}xe(){const a=this.Fa.Dc(Yb.a.Bg);a.bindAction(A.KeyInputManager.Vv(ResourceStrings.l_HK_Bold),ba.a.FYa);a.bindAction(A.KeyInputManager.Vv(ResourceStrings.l_HK_Italic),ba.a.GYa);a.bindAction(A.KeyInputManager.Vv(ResourceStrings.l_HK_Underline),ba.a.HYa);a.bindAction(A.KeyInputManager.Na(w.a.yKa,A.KeyInputManager.He|4),ba.a.Elc);a.bindAction(A.KeyInputManager.Na(w.a.sod,
A.KeyInputManager.He|4),ba.a.XHb)}rQc(a,b,c,f,l){c=this.Gb.og();if(!c||1>c.length)return 16;f=this.Ea.KZ(c);var x=this.Gb.Yia();if(1>f.length&&!x)return 16;b=null;this.Fm=Date.now();x&&(b=this.tc.s$f(x,new Rs),this.ex=Date.now(),Aa.a.J(512500294,815,50,"Query table shape font timespan by {0}",(this.ex-this.Fm).toString()));c=x?[c[0]]:f;for(const G of c){switch(a){case ba.a.bdd:case ba.a.$cd:break;case ba.a.cdd:c=this.Sy.Y0b(G.qd&&b?b.fontName:G.zJb);if(l.qZ&&l.qZ!==c){l.qZ="";break}l.qZ=c;l.Qkc();
break;case ba.a.ddd:c="";G.qd&&b?-1!==b.fontSize&&(c=Ka.a.ALc(b.fontSize/2,0,u.AFrameworkApplication.numberFormat)):c=G.H$?Tv.q$f(G).toString():"";f=parseFloat(c);if(!isNaN(f)&&(x=l.qZ)&&x!==c){x=Math.min(f,parseFloat(x)).toString()+"+";l.qZ=x;break}l.qZ=c;l.Qkc();break;default:return Aa.a.J(512500293,820,10,"Unexpected actionId for HandleQueryFont"),8}if(l&&l.qZ&&!l.qZ.length)break}return 32}tub(a,b,c,f,l){b=this.Gb.og();if(!b||1>b.length)return 16;b=this.Ea.KZ(b);c=this.Gb.Yia();if(1>b.length&&
!c)return 16;a=c?this.SFk(c,a,new Rs):this.U$g(b,a);l.Nf("select"===a);return"disable"!==a?32:8}B2b(a,b,c,f,l){b=this.Gb.og();if(!b||1>b.length)return 16;const x=this.Gb.Yia();f=this.Ea.KZ(b);if(1>f.length&&!x||this.Af.dC(f)||this.Af.dC([x]))return 16;if(1===c)return 32;this.Gb.kj();this.Fa.Ad();switch(a){case ba.a.zHb:const R=this.jsa(l,!0);if(!R)return 8;1<b.length?Aa.a.J(512500292,815,50,"Set {0} shapes font color.",b.length):Aa.a.J(512500291,815,50,"Set one shape font color.");for(const mb of b)if(mb.Jf||
mb.Og){Qn(mb);break}this.xv.tia(mb=>{mb.TJa=R},f);break;case ba.a.ehb:case ba.a.VHb:let fa;if(a===ba.a.ehb){if(fa=this.jsa(l,!1),!fa)return 8}else fa="";1<b.length?Aa.a.J(512500290,815,50,"Set {0} shapes highlight.",b.length):Aa.a.J(512500289,815,50,"Set one shape highlight.");this.xv.tia(mb=>{mb.highlight=fa},f);break;case ba.a.Tgb:if(!l)return 8;const wa=this.Sy.Y0b(l);if(wa.length){1<b.length?Aa.a.J(512500288,815,50,"Set {0} shapes font name.",b.length):Aa.a.J(512500259,815,50,"Set one shape font name.");
var G=null;for(const mb of b)if(mb.Jf||mb.Og)Qn(mb),mb.Jf&&(G=mb);if(1>this.bdg(f,a,wa).length)return 16;this.xv.tia(mb=>{mb.zJb=wa},f);G&&(G.zJb=wa);this.Sy.$Ac(l)}break;case ba.a.Ugb:l=Object(ua.a)(hE.a,l);if(!l||!l.kd)return 8;const Wa=this.nj.XWb(l.kd);if(isNaN(Wa))return 8;1<b.length?Aa.a.J(512500258,815,50,"Set {0} shapes font size.",b.length):Aa.a.J(512500257,815,50,"Set one shape font size.");l=null;for(G of b)if(G.Jf||G.Og)Qn(G),G.Jf&&(l=G);if(1>this.bdg(f,a,Wa*Nl.a.k8a).length)return 16;
this.xv.tia(mb=>{mb.Poh(Wa)},f);l&&l.Poh(Wa);break;default:return Aa.a.J(512500256,820,10,"Unexpected actionId for HandleFont"),8}return 32}qRa(a,b,c){b=this.Gb.og();if(!b||1>b.length)return 16;const f=this.Gb.Yia(),l=this.Ea.KZ(b);if(1>l.length&&!f||this.Af.dC(l)||this.Af.dC([f]))return 16;if(1===c)return 32;const x="select"!==this.U$g(this.Ea.KZ(b),a);this.Gb.kj();this.Fa.Ad();switch(a){case ba.a.FYa:1<b.length?Aa.a.J(512500255,815,50,"Set {0} shapes bold.",b.length):Aa.a.J(512500254,815,50,"Set one shape bold.");
f&&Object(re.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ba.a.bold,2);this.xv.tia(R=>{R.isBold=x},l);break;case ba.a.GYa:1<b.length?Aa.a.J(512500253,815,50,"Set {0} shapes italic.",b.length):Aa.a.J(512500252,815,50,"Set one shape italic.");f&&Object(re.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ba.a.setItalic,2);this.xv.tia(R=>{R.isItalic=x},l);break;case ba.a.HYa:1<b.length?Aa.a.J(512500251,815,50,"Set {0} shapes underline.",b.length):Aa.a.J(512500250,815,50,"Set one shape underline.");
f&&Object(re.a)("FixTableModifyFontShortcut")&&this.ia.processAction(ba.a.underline,2);this.xv.tia(R=>{R.GD=x},l);break;case ba.a.CHb:1<b.length?Aa.a.J(512500249,815,50,"Set {0} shapes strikethrough.",b.length):Aa.a.J(512500248,815,50,"Set one shape strikethrough.");this.xv.tia(R=>{R.rF=x},l);break;case ba.a.Elc:case ba.a.XHb:const G=a===ba.a.XHb?!1:!0;1<b.length?Aa.a.J(512500247,815,50,"Step {0} shapes font size.",b.length):Aa.a.J(512500246,815,50,"Step one shape font size.");this.xv.tia(R=>{R.axb=
G},l);break;case ba.a.Ilc:1<b.length?Aa.a.J(512500245,815,50,"Step {0} shapes superscript.",b.length):Aa.a.J(512500244,815,50,"Step one shape superscript.");this.xv.tia(R=>{R.LM=x?3E4:0},l);break;case ba.a.Hlc:1<b.length?Aa.a.J(512500243,815,50,"Step {0} shapes subscript.",b.length):Aa.a.J(512500242,815,50,"Step one shape subscript.");this.xv.tia(R=>{R.LM=x?-25E3:0},l);break;default:return 8}return 32}Lpj(a,b,c,f,l){if(1===c)return 32;ad.Font.n8d(b);l.MenuItems=ia.FontUtils.d8f(Tv.kjd,Tv.DLc,this.N4j,
this.Pka,this.S4j);return 32}U$g(a,b){let c="select";for(const f of a){switch(b){case ba.a.lic:case ba.a.FYa:c=f.isBold?"select":"normal";break;case ba.a.mic:case ba.a.GYa:c=f.isItalic?"select":"normal";break;case ba.a.oic:case ba.a.HYa:c=f.GD?"select":"normal";break;case ba.a.nic:case ba.a.CHb:c=f.rF?"select":"normal";break;case ba.a.jdd:case ba.a.Ilc:c=0<f.LM?"select":"normal";break;case ba.a.idd:case ba.a.Hlc:c=0>f.LM?"select":"normal";break;default:return"disable"}if("select"!==c)break}return c}SFk(a,
b,c){this.Fm=Date.now();c=this.tc.s$f(a,c);switch(b){case ba.a.lic:a=1===c.bold?"select":"normal";break;case ba.a.mic:a=1===c.italic?"select":"normal";break;case ba.a.oic:a=1===c.underline?"select":"normal";break;case ba.a.nic:a=1===c.strikethrough?"select":"normal";break;default:return"disable"}this.ex=Date.now();Aa.a.J(512500241,815,50,"Query table shape font state timespan by {0}",(this.ex-this.Fm).toString());return a}bdg(a,b,c){const f=[];for(const l of a)switch(b){case ba.a.FYa:l.isBold!==c&&
Array.add(f,l);break;case ba.a.GYa:l.isItalic!==c&&Array.add(f,l);break;case ba.a.HYa:l.GD!==c&&Array.add(f,l);break;case ba.a.CHb:l.rF!==c&&Array.add(f,l);break;case ba.a.Tgb:l.zJb!==c&&Array.add(f,l);break;case ba.a.Ugb:Tv.q$f(l)!==c&&Array.add(f,l);break;case ba.a.Ilc:0<l.LM!==c&&Array.add(f,l);break;case ba.a.Hlc:0>l.LM!==c&&Array.add(f,l);break;default:Aa.a.J(512500240,820,10,"ShapesTextFontActor::GetModifiedShapeMonikers unsupported action Id: {0}.",b)}return f}jsa(a,b){if(b)return b=xm.SchemeColor.parse(a),
b&&b.rsa?Pk.i(Pk.g(b.vP)):(Aa.a.J(512500239,820,10,"Font color '{0}' is incorrect",a),null);b=nu.a.parse(a);return b&&b.RGBColor?b.RGBColor:(Aa.a.J(512500238,820,10,"Color '{0}' is incorrect",a),null)}static DLc(a,b){return b}static kjd(){return!1}static q$f(a){const b=a.Z1;return De.a.Jy(b,1)?a.H$:Math.round(a.H$)*b}}Object(e.a)(Tv,"ShapesTextFontActor",null,[229]);class nN{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.ex=this.Fm=-1;this.xv=a;this.ia=b;this.Fa=c;this.Af=f;this.ra=l;this.Ea=x;
this.lbb=G;this.sL=R;this.Nb=fa;this.Fb=wa;this.QXc=Wa;this.tc=mb;this.Wz=Kb}get Gb(){return this.ra}ub(){this.ia.pa(ba.a.THb,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.BHb,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.Vgb,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.UHb,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.hhb,sc.a.application,Object(C.a)(this,
this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.AHb,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.Dlc,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.Jid,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.aid,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.$hd,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.Zhd,sc.a.application,
Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.Yhd,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.tMe,sc.a.application,Object(C.a)(this,this.lkg,"handleQueryLineSpacing"),4);this.ia.pa(ba.a.tlc,sc.a.application,Object(C.a)(this,this.O7,"handleFormatAction"),4);this.ia.pa(ba.a.ifb,sc.a.application,Object(C.a)(this,this.sRa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.jfb,sc.a.application,Object(C.a)(this,this.sRa,"handleQueryToggleButton"),97);
this.ia.pa(ba.a.rXa,sc.a.application,Object(C.a)(this,this.sRa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.sXa,sc.a.application,Object(C.a)(this,this.sRa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.fdd,sc.a.application,Object(C.a)(this,this.sRa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.Zcd,sc.a.application,Object(C.a)(this,this.sRa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.hdd,sc.a.application,Object(C.a)(this,this.sRa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.edd,sc.a.application,
Object(C.a)(this,this.sRa,"handleQueryToggleButton"),97);this.ia.pa(ba.a.mdd,sc.a.application,Object(C.a)(this,this.x5d,"handleQueryTextAnchoring"),97);this.ia.pa(ba.a.ldd,sc.a.application,Object(C.a)(this,this.x5d,"handleQueryTextAnchoring"),97);this.ia.pa(ba.a.kdd,sc.a.application,Object(C.a)(this,this.x5d,"handleQueryTextAnchoring"),97);this.ia.pa(ba.a.gdd,sc.a.application,Object(C.a)(this,this.lkg,"handleQueryLineSpacing"),97)}xe(){const a=this.Fa.Dc(Yb.a.Bg);a.bindAction(A.KeyInputManager.Vv(ResourceStrings.l_HK_FullJustify),
ba.a.AHb);a.bindAction(A.KeyInputManager.Vv(ResourceStrings.l_HK_CenterJustify),ba.a.UHb);r.a.lk?(a.bindAction(A.KeyInputManager.Vv(ResourceStrings.l_HK_LeftJustify_Mac),ba.a.Vgb),a.bindAction(A.KeyInputManager.Vv(ResourceStrings.l_HK_RightJustify_Mac),ba.a.hhb)):(a.bindAction(A.KeyInputManager.Vv(ResourceStrings.l_HK_LeftJustify),ba.a.Vgb),a.bindAction(A.KeyInputManager.Vv(ResourceStrings.l_HK_RightJustify),ba.a.hhb))}sRa(a,b,c,f,l){const x=this.Gb.og();if(!x||1>x.length)return 16;b=this.Gb.Yia();
const G=this.Ea.KZ(x);if(1>G.length&&!b)return 16;f=c=null;let R=a===ba.a.ifb?1:a===ba.a.jfb?2:18;Object(Ma.a)(Nh.a,l)?f=l:Object(Ma.a)(Pv,l)&&(f=l.tXa,R=l.menuItemId);l=b?[x[0]]:G;this.Fm=Date.now();for(const fa of l){switch(a){case ba.a.ifb:c=fa.qd?this.R3d(R,a):this.a3d(R,fa,a);break;case ba.a.jfb:c=fa.qd?this.R3d(R,a):this.a3d(R,fa,a);break;case ba.a.rXa:case ba.a.sXa:c=fa.qd?this.R3d(R,a):this.a3d(R,fa,a);break;case ba.a.fdd:c=fa.qd?1===this.tc.NMc(b)?"select":"normal":1===fa.xl?"select":"normal";
break;case ba.a.Zcd:c=fa.qd?2===this.tc.NMc(b)?"select":"normal":2===fa.xl?"select":"normal";break;case ba.a.hdd:c=fa.qd?3===this.tc.NMc(b)?"select":"normal":3===fa.xl?"select":"normal";break;case ba.a.edd:c=fa.qd?6===this.tc.NMc(b)?"select":"normal":4===fa.xl?"select":"normal";break;default:c="disable"}if("normal"===c)break}f.Nf("select"===c);this.ex=Date.now();b&&Aa.a.J(512500237,815,50,"Query table shape timespan by {0}",(this.ex-this.Fm).toString());return"disable"!==c?32:8}a3d(a,b,c){return c===
ba.a.rXa||c===ba.a.ifb||c===ba.a.sXa||c===ba.a.jfb?this.sL.zIf(b,a)?"select":"normal":"normal"}R3d(a,b){var c=!0,f=this.Gb.Yia();f=rd.SelectionFactory.FGc(Object(ua.a)(lg.a,f));for(const l of f){if(c=l.Qk?l.node:null)if(f=this.Nb.Kc(c),f.set(c),f.pc(11),f.Rg(11),c=this.Wz.Pw(f)){if(0===a){c=!1;break}if(b===ba.a.ifb)c=1===c.listType;else if(b===ba.a.jfb)c=0===c.listType;else if(b===ba.a.rXa){f=this.sL.qTa.ga(a).rVb;const x=this.sL.qTa.ga(a).spb;c=c.yub&&0<c.t8.length&&c.t8[0]===f&&c.$7a&&c.font===
x}else b===ba.a.sXa?(f=this.sL.l8c.ga(a).uLd,c=!!c.propertySet&&c.propertySet.Sa(sb.a.autonumberBulletType)&&c.propertySet.getValue(sb.a.autonumberBulletType)===f):c=!1}else c=0===a?b===ba.a.rXa||b===ba.a.sXa?!0:!1:!1;else c=!1;if(!c)break}return c?"select":"normal"}O7(a,b,c,f,l){f=this.Gb.og();if(!f||1>f.length)return 16;b=this.Ea.KZ(f);const x=this.Gb.Yia(),G=!!x&&(a===ba.a.Dlc||a===ba.a.Jid);if(!b.length&&!x||G||this.Af.dC(b)||this.Af.dC([x]))return 16;if(1===c)return 32;this.Gb.kj();a!==ba.a.tlc&&
this.Fa.Ad();switch(a){case ba.a.THb:case ba.a.BHb:if(Object.getType(l)!==Number)return 8;this.o7k(f,b,l);break;case ba.a.Vgb:case ba.a.UHb:case ba.a.hhb:case ba.a.AHb:var R=this.TXf(b);this.m7k(b,a,l);R&&this.ra.selectShape(R,!1);Nc.a.LO(!0,!1);break;case ba.a.Dlc:case ba.a.Jid:l=[];const fa=a===ba.a.Dlc?1:2;for(R of b)Array.add(l,R);1<f.length?Aa.a.J(512500236,815,50,"Set {0} shapes text direction.",f.length):Aa.a.J(512500235,815,50,"Set one shape text direction.");this.xv.S5a(Wa=>{if(Wa=Object(ua.a)(4,
Wa))Wa.yJb=fa},l);break;case ba.a.tlc:if(!l||!Object(Ma.a)(Array,l)||1>l.length)return 8;Nc.a.Eb&&(Nc.a.Eb.Oj=!0);b=this.Fb.ud(15);try{for(b.kc(l[0].G0),b.fd=a,a=0;a<l.length;a++)l[a].G0.Eha=l[a].Q9.left,l[a].G0.Fha=l[a].Q9.right,l[a].G0.Gha=l[a].Q9.top,l[a].G0.Dha=l[a].Q9.bottom}finally{b&&b.dispose()}Nc.a.LO(!0,!1);break;case ba.a.aid:case ba.a.$hd:case ba.a.Zhd:l=[];let wa=1;switch(a){case ba.a.aid:wa=0;break;case ba.a.$hd:wa=1;break;case ba.a.Zhd:wa=2}for(const Wa of b)Array.add(l,Wa);Aa.a.J(512500234,
815,50,"Set text anchoring, shape count: {0}.",f.length);this.xv.S5a(Wa=>{if(Wa=Object(ua.a)(4,Wa))Wa.Fna=wa},l);Nc.a.LO(!0,!1);break;case ba.a.Yhd:if(!l||Object.getType(l)!==Number)return 8;R=this.TXf(b);this.n7k(b,l,a);R&&this.ra.selectShape(R,!1);Nc.a.LO(!0,!1);break;default:return 8}return 32}x5d(a,b,c,f,l){b=this.Gb.og();if(!b||1>b.length)return 16;b=this.Gb.i0d(b);f=b.$wb;c=0;const x=this.Gb.Yia();if(!f&&!x)return 16;switch(a){case ba.a.mdd:a=x?({$va:c}=this.tc.HTe(x)).returnValue&&0===c?"select":
"normal":0===b.Fna?"select":"normal";break;case ba.a.ldd:a=x?({$va:c}=this.tc.HTe(x)).returnValue&&1===c?"select":"normal":1===b.Fna?"select":"normal";break;case ba.a.kdd:a=x?({$va:c}=this.tc.HTe(x)).returnValue&&2===c?"select":"normal":2===b.Fna?"select":"normal";break;default:a="disable"}l.Nf("select"===a);return"disable"!==a?32:8}lkg(a,b,c,f,l){c=this.Gb.og();if(!c||1>c.length)return 16;b=this.Gb.Yia();c=this.Ea.KZ(c);if(!c.length&&!b)return 16;this.Fm=Date.now();switch(a){case ba.a.tMe:break;
case ba.a.gdd:a=new aN.a;a.Sf=2;a.value=l.MenuItemId;f=!0;b&&(f=this.jcl(b,l),this.ex=Date.now(),Aa.a.J(512500233,815,50,"Query table shape timespan by {0}",(this.ex-this.Fm).toString()));for(const x of c){b=this.Ea.$2d(x);if(!b||!this.lbb.FIf(b,a)){f=!1;break}this.QXc&&2===b.Sf&&(b.value=Math.max(0,b.value-this.Ea.FZd(x)))}l.queryResult.Nf(f);break;default:return 8}return 32}n7k(a,b,c){const f=this.Fb.ud(15);try{f.kc(a[0]);f.fd=c;for(const l of a)l.Kra();this.ia.La(ba.a.uma,2,b)}finally{f&&f.dispose()}}m7k(a,
b,c){const f=[];let l=0,x=0;switch(b){case ba.a.Vgb:l=1;x=E.a.Wja;break;case ba.a.UHb:l=2;x=E.a.Nha;break;case ba.a.hhb:l=3;x=E.a.cna;break;case ba.a.AHb:l=4,x=E.a.pCa}a=this.ra.wO(a);for(const G of a)G.xl!==l&&Array.add(f,G);if(x&&f.length){for(const G of a)if(G.Jf||G.Og){Qn(G);break}a=this.Fb.ud(15);try{a.kc(f[0]);for(const G of f)G.Kra(),G.c8k(l);this.ia.La(x,2,c)}finally{a&&a.dispose()}}}o7k(a,b,c){const f=[];let l=1===c||2===c;for(const G of b)this.sL.zIf(G,c)||(l=!1,Array.add(f,G));1<a.length?
Aa.a.J(512500231,815,50,"ListGallery enabled, set {0} shapes bullet.",a.length):Aa.a.J(512500230,815,50,"ListGallery enabled, set one shape bullet.");for(const G of a)if(G.Jf||G.Og){Qn(G);break}a=l?b:f;2!==c||l||(a=b,c=11);if(l||0===c)c=18;const x=this.sL.qTa.ga(c);0<a.length&&this.xv.S5a(G=>{G.setValue(sb.a.xJb,c);x&&(G.setValue(sb.a.Vxh,x.spb),G.setValue(sb.a.Uxh,x.rVb))},a)}jcl(a,b){let c=!1;const f=b.MenuItemId;let l=b.LineSpacingValue;b=b.LineSpacingUnit;a=rd.SelectionFactory.FGc(Object(ua.a)(lg.a,
a));for(const x of a){if(a=x.Qk?x.node:null){a=this.lbb.YV(a);const G=De.a.Jy(a.lineSpacing.value,f)&&2===a.lineSpacing.Sf;if(-1===l)b=a.lineSpacing.Sf,l=a.lineSpacing.value;else if(l!==a.lineSpacing.value||b!==a.lineSpacing.Sf)l=b=0,c=!1;0!==b&&(c=G)}if(!c)break}return c}TXf(a){return 0<a.length&&a[0].Og&&(a=this.Ea.ds(a[0]))?(this.ra.n7(a),a):null}}Object(e.a)(nN,"ShapesTextParagraphActor",null,[229]);var SQ=d(667);class oN{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.ia=a;this.Af=b;this.Fb=
c;this.Sz=f;this.Fa=l;this.ra=x;this.Zb=G;this.ua=R;this.Qb=fa;this.Ha=wa;this.hw=Wa;this.Mb=mb;if(!Kb)throw Error.argumentNull("GraphOperationEventHandler is null");this.Ig=Kb}ub(){this.ia.pa(ba.a.deleteObject,Bb.a.application,Object(C.a)(this,this.Ymj,"handleDelete"),4);this.Ha.podsEnableSlideScoreCard&&this.ia.pa(ba.a.xFk,xd.a.frame,Object(C.a)(this,this.Cyl,"updateSlideScore"),96);this.ia.pa(ba.a.H_f,sc.a.application,Object(C.a)(this,this.pnj,"handleDuplicate"),4);this.ia.pa(ba.a.kDf,sc.a.application,
Object(C.a)(this,this.Dlj,"handleAddFirstSlide"),4);this.Ha.wNj?(this.ia.pa(ba.a.WM,Bb.a.application,Object(C.a)(this,this.gnj,"handleDeleteSlides"),4),this.ia.pa(ba.a.qS,sc.a.application,Object(C.a)(this,this.snj,"handleDuplicateSlides"),4),this.Ha.F6d?(this.ia.pa(ba.a.gRc,sc.a.application,Object(C.a)(this,this.$nj,"handleHideSlides"),4),this.ia.pa(ba.a.$Bh,sc.a.application,Object(C.a)(this,this.dsj,"handleUnhideSlides"),4),this.Ig.job(Object(C.a)(this,this.Tgl,"slidesSelectionChangedHandler"))):
this.ia.pa(ba.a.gRc,sc.a.application,Object(C.a)(this,this.h5d,"handleHideSlidesOld"),4),this.ia.pa(ba.a.JDe,Bb.a.application,Object(C.a)(this,this.jqj,"handleQuerySlidesHidden"),96)):(this.ia.pa(ba.a.WM,Bb.a.application,Object(C.a)(this,this.fnj,"handleDeleteSlide"),4),this.ia.pa(ba.a.qS,sc.a.application,Object(C.a)(this,this.rnj,"handleDuplicateSlide"),4),this.ia.pa(ba.a.gRc,sc.a.application,Object(C.a)(this,this.Znj,"handleHideSlide"),4),this.ia.pa(ba.a.JDe,Bb.a.application,Object(C.a)(this,this.iqj,
"handleQuerySlideHidden"),96));this.ia.pa(ba.a.fTd,Bb.a.application,Object(C.a)(this,this.$mj,"handleDeleteFakeSlides"),2048);this.ia.pa(ba.a.FPf,Bb.a.application,Object(C.a)(this,this.Fmj,"handleClearAndResizeSlideCanvas"),2048);this.ia.ya(ba.a.Lph,sc.a.application,Object(C.a)(this,this.trj,"handleShareSlide"));this.ia.pa(ba.a.IDe,Bb.a.application,Object(C.a)(this,this.k5d,"handleIsDirectManipulationEnabled"),97)}xe(){const a=this.Fa.Dc(zi.a.oD);a.bindAction(A.KeyInputManager.Na(w.a.Una,0),ba.a.WM);
a.bindAction(A.KeyInputManager.Na(w.a.wH,0),ba.a.WM);a.bindAction(A.KeyInputManager.Na(w.a.HKa,A.KeyInputManager.He),ba.a.qS)}Ymj(a,b,c,f,l){if(this.Fa.ze)if(this.Fa.Bba===zi.a.oD||1===this.Mb.Xo)a=ba.a.WM;else if(this.Fa.Bba===Yb.a.Bg)a=ba.a.v4a;else return 8;else return 8;return this.ia.La(a,c,l)}fnj(a,b,c){b=this.ua.Ba;if(!b||this.Af.Zc(b)||this.Ha.Ly&&1!==this.ra.nf().length)return 16;if(1===c)return 32;if(!b.isConnected)return 16;Nc.a.Eb&&(Nc.a.Eb.actionName="DeleteSlide",Nc.a.Eb.Kr=!1,Nc.a.Eb.Oj=
!0,Nc.a.Eb.Wa("SlideCount","1"));c=this.Zb.yf;if(!c)return 16;const f=this.Fb.ud(15,void 0,()=>{this.ra.Uh()});try{f.kc(c),f.fd=a,c.WM(b)}finally{f&&f.dispose()}this.Af.Jw(c,a);a=[];a.push(b);this.hw?this.hw.uEe(new $z(a)):Aa.a.J(512313375,822,10,"HandleDeleteSlide: graphOperationEventNotifier is null for raising event.");return 32}Fmj(a,b,c){a=this.Qb.CG(this.ua.MWc?this.ua.MWc.slideIndex:0);if(!a)return Aa.a.J(512313374,822,50,"HandleClearAndResizeSlideCanvas: slideNode null"),8;a=Object(ua.a)(553,
a.oc(this.Mb.Ma));if(!a)return Aa.a.J(512313373,822,50,"HandleClearAndResizeSlideCanvas: slideViewElement null"),16;if(1===c)return 32;Aa.a.J(512313372,822,50,"HandleClearAndResizeSlideCanvas: updating slideViewElement");a.lLe(!1);a.updateOffSlideView(0,!0);return 32}$mj(a,b,c){b=[];for(const f of this.Qb.cMc())f.qN&&Array.add(b,f);if(!b.length||!this.ua.Ba)return Aa.a.J(512313371,822,50,"HandleDeleteFakeSlides: empty fake slides"),8;if(1===c)return 32;Aa.a.J(512313370,822,50,"HandleDeleteFakeSlides: deleting fake slides");
return this.PXf(b,"DeleteFakeSlide",a)}gnj(a,b,c){b=this.ra.nf();if(!b||!b.length||!this.ua.Ba)return 16;for(const f of b)if(!f||this.Af.Zc(f))return 16;if(1===c)return 32;for(const f of b)if(!f.isConnected)return 16;return this.PXf(b,"DeleteSlide",a)}PXf(a,b,c){Nc.a.Eb&&(Nc.a.Eb.actionName=b,Nc.a.Eb.Kr=!1,Nc.a.Eb.Oj=!0,Nc.a.Eb.Wa("SlideCount",a.length.toString()));1<a.length?Aa.a.J(512313369,822,50,"HandleDeleteSlides: Selected slidenodes: {0}",a.length):Aa.a.J(512313368,822,50,"HandleDeleteSlides: Selected one slidenode.");
b=this.Zb.yf;if(!b)return 16;this.MGi(b,a,c,()=>{this.ra.Uh()});return 32}MGi(a,b,c,f){f=this.Fb.ud(15,void 0,f);try{f.kc(a);for(const l of b)l&&!l.Bb.equals(this.ua.Ba.Bb)&&a.WM(l);a.WM(this.ua.Ba);f.fd=c}finally{f&&f.dispose()}this.Ha.unblockContentWhenDeletingSlideEnabled||this.Af.Jw(a,c);this.hw?this.hw.uEe(new $z(b)):Aa.a.J(512313367,822,10,"HandleDeleteSlides: graphOperationEventNotifier is null for raising event.")}iqj(a,b,c,f,l){a=this.ua.Ba;if(!a)return 16;l.Nf(a.Rm);return 32}jqj(a,b,c,
f,l){a=this.ra.nf();if(!a||!a.length)return 16;a=this.HKd(a);l.Nf(a);return 32}trj(a,b,c,f,l){a=this.ua.Ba;if(!a||this.Af.Zc(a)||1!==this.ra.nf().length)return 16;if(1===c)return 32;Nc.a.Eb&&(Nc.a.Eb.Kr=!1,Nc.a.Eb.Wa("SlideCount","1"));c=a.Bb;if(!c)return 16;c=JSON.stringify({["sId"]:c.sid,["cId"]:c.cid});l.nav=SQ.a(c);l.mode="copy";Aa.a.J(512313364,822,50,"HandleShareSlide: nav:{0}",c);this.ia.La(F.a.fCa,2,l);return 32}Znj(a,b,c){b=this.ua.Ba;if(!b||this.Af.Zc(b)||this.Ha.Ly&&1!==this.ra.nf().length)return 16;
if(1===c)return 32;Nc.a.Eb&&(Nc.a.Eb.Kr=!1,Nc.a.Eb.Wa("SlideCount","1"));c=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()},()=>{1!==this.Mb.Xo&&this.Fa.Bf(zi.a.oD)});try{c.kc(b),c.fd=a,b.Rm=!b.Rm}finally{c&&c.dispose()}return 32}h5d(a,b,c){b=this.ra.nf();if(!b||!b.length)return 16;for(var f of b)if(!f||this.Af.Zc(f))return 8;if(1===c)return 32;Aa.a.J(512313363,822,50,"HandleHideSlidesOld: Selected slidenodes: {0}",b.length);Nc.a.Eb&&(Nc.a.Eb.Kr=!1,Nc.a.Eb.Wa("SlideCount",b.length.toString()));
c=!this.HKd(b);f=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()},()=>{1!==this.Mb.Xo&&this.Fa.Bf(zi.a.oD)});try{f.kc(this.Zb.yf);f.fd=a;for(const l of b)l.Rm=c}finally{f&&f.dispose()}return 32}$nj(a,b,c,f,l){const x=this.ra.nf();if(!x||!x.length)return 16;for(const G of x)if(!G||this.Af.Zc(G))return 8;if(this.HKd(x))return this.BQc(),32;this.h5d(a,b,c,f,l);this.BQc();return 32}dsj(a,b,c,f,l){const x=this.ra.nf();if(!x||!x.length)return 16;for(const G of x)if(!G||this.Af.Zc(G))return 8;if(1===
c)return 32;this.h5d(a,b,c,f,l);this.BQc();return 32}BQc(){var a=this.ra.nf();if(a&&a.length){for(var b of a)if(!b||this.Af.Zc(b))return;if(Lg.c()){b=!0;for(const c of a)if(!c.Rm){b=!1;break}a=[appChrome.actions.updateControlHiddenState("HideSlide",b),appChrome.actions.updateControlEnabledDisabledState("UnhideSlide",!b),appChrome.actions.updateControlHiddenState("UnhideSlide",!b)];appChrome.api.dispatch(a)}else Aa.a.J(512313362,822,50,"HandleToggleHiddenBehavior: appChrome not defined")}}Tgl(){this.BQc()}Cyl(a,
b,c,f,l){if(1===c)return 32;this.ua.Ba&&(a="Slide Complex: "+this.ua.Ba.sa(sb.a.Vma,0).toString(),l[Eq.a.Value]=a,l[um.a.labelText]=a,l[Eq.a.Visible]=!0);return 32}pnj(a,b,c,f,l){if(this.Fa.ze)if(this.Fa.Bba===zi.a.oD)a=ba.a.qS;else if(this.Fa.Bba===Yb.a.Bg)a=ba.a.D5a;else return 8;else return 8;return this.ia.La(a,c,l)}rnj(a,b,c){b=this.ua.Ba;if(!b||this.Af.Zc(b)||this.Ha.Ly&&1!==this.ra.nf().length)return 16;if(1===c)return 32;Nc.a.qk("SlideCount","1");this.Sz.APi(b,a).yN||this.Af.Jw(this.Zb.yf,
a);return 32}snj(a,b,c){b=this.ra.nf();if(!b||!b.length)return 16;for(var f of b)if(!f||this.Af.Zc(f))return 16;if(1===c)return 32;1<b.length?Aa.a.J(512313361,822,50,"HandleDuplicateSlides: Selected slidenodes: {0}",b.length):Aa.a.J(512313360,822,50,"HandleDuplicateSlides: Selected one slidenode.");Nc.a.qk("SlideCount",b.length.toString());c=this.Sz.J2f(b,a,null,null,!0);f=!0;for(const l of c)if(!l.yN){f=!1;break}f||this.Af.Jw(this.Zb.yf,a);return 32}Dlj(){try{Aa.a.J(512313359,801,50,"SlideActor: HandleAddFirstSlide called.");
const a=this.Qb.hI();a&&0<a.length&&this.Sz.ZJc(null,a[0].Id,this.Ha.w6b?0:a[0].ContentMasters[0].Id,ba.a.RCb);return 32}catch(a){return Aa.a.J(512313358,801,10,"Exception in HandleAddFirstSlide: {0}.",a),8}}k5d(a,b,c,f,l){return l&&Object(Ma.a)(Oe.a,l)?this.Af.Zc(this.Qb.kl(l))?16:32:8}HKd(a){for(const b of a)if(!b.Rm)return!1;return!0}}Object(e.a)(oN,"SlideActor",null,[229]);class pN{constructor(){this.InsertionPoint=this.GalleryButtons=this.Title=this.SectionId=null}}Object(e.a)(pN,"GallerySectionProps",
null,[]);const EE=()=>{appChrome.PRIToastManager.dismissToast()};class FE{constructor(a,b,c){this.slideId=a;this.nck=b;this.Jvi=c}}Object(e.a)(FE,"NewSlideWithLayoutData",null,[]);class vj{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){this.qua=0;this.n0c={};this.GQg=this.HQg=0;this.ia=a;this.Xb=b;this.Fa=c;this.X4j=vj.sHj(f);this.ra=l;this.Fb=x;this.Sz=G;this.Zb=R;this.ua=fa;this.Qb=wa;this.Vhe=Wa;this.yu=mb;this.yu.yBc(Object(C.a)(this,this.P3g,"openIgnoredDialog"));this.Ha=Kb;this.dBb=nc;this.Lua=
{}}ub(){this.Ha.vNj?this.ia.pa(ba.a.wqa,sc.a.application,Object(C.a)(this,this.Hkg,"handleSlidesChangeLayout"),4):this.ia.pa(ba.a.wqa,sc.a.application,Object(C.a)(this,this.xmj,"handleChangeLayout"),4);this.ia.pa(ba.a.kHa,sc.a.application,Object(C.a)(this,this.Zjg,"handleNewSlideWithLayoutOptions"),4);this.ia.pa(ba.a.dea,sc.a.application,Object(C.a)(this,this.Yjg,"handleNewSlideWithDefaultLayout"),4);this.ia.pa(ba.a.RCb,sc.a.application,Object(C.a)(this,this.Yjg,"handleNewSlideWithDefaultLayout"),
4);this.ia.pa(ba.a.P7c,sc.a.application,Object(C.a)(this,this.dpj,"handleNewSlideWithLayout"),4);this.ia.pa(ba.a.m7g,sc.a.application,Object(C.a)(this,this.Zjg,"handleNewSlideWithLayoutOptions"),4);this.ia.pa(ba.a.ySc,sc.a.application,Object(C.a)(this,this.Gqj,"handleReactInsertSlideWithLayout"),4);this.ia.pa(ba.a.myk,sc.a.application,Object(C.a)(this,this.Hkg,"handleSlidesChangeLayout"),4);this.ia.pa(ba.a.RNd,sc.a.application,Object(C.a)(this,this.Fqj,"handleReactChangeSlideLayout"),4);this.ia.pa(ba.a.Ccd,
sc.a.application,Object(C.a)(this,this.Ccd,"queryNewSlideLayout"),4);this.ia.pa(ba.a.TCe,sc.a.application,Object(C.a)(this,this.TCe,"queryChangeSlideLayout"),4)}xe(){const a=this.Fa.Dc(zi.a.oD),b=this.Fa.Dc(zi.a.c2),c=this.Fa.Dc(Yb.a.Bg),f=this.Fa.Dc(Yb.a.LP);a.bindAction(A.KeyInputManager.Na(w.a.lq,0),ba.a.dea);a.bindAction(A.KeyInputManager.Na(w.a.Mfa,A.KeyInputManager.He),ba.a.dea);c.bindAction(A.KeyInputManager.Na(w.a.Mfa,A.KeyInputManager.He),ba.a.dea);b.bindAction(A.KeyInputManager.Na(w.a.Mfa,
A.KeyInputManager.He),ba.a.dea);f.bindAction(A.KeyInputManager.Na(w.a.Mfa,A.KeyInputManager.He),ba.a.dea)}$lc(){return this.X4j||this.Qb.U5d()}xmj(a,b,c){const f=this.ua.Ba;if(!f||this.Xb.Zc(f)||this.Ha.Ly&&1!==this.ra.nf().length)return 16;a=f.pj;if(!a)return 8;b=this.Qb.hI();if(!this.Ha.TSa){if(!b)return Aa.a.J(512500229,822,10,"SlideLayoutActor::HandleChangeLayout fails to get mainMasters"),8;if(!this.cjb(b,a))return 8}if(1===c)return 32;if((!this.Ha.TSa||b&&this.cjb(b,a))&&this.yu.kO.Jb(a)&&this.Vde()){this.qua=
0;c=f.Cn;if(!c)return Aa.a.J(512500227,822,10,"SlideLayoutActor::HandleChangeLayout fails to get contentMasterId"),8;this.Vhe.UQd(0,this.Qb.su(),b,this.yu.kO,a,Object(C.a)(this,this.RNd,"changeSlideLayout"),this.$lc(),u.AFrameworkApplication.isRtl).Djd(c)}else Aa.a.J(512500228,822,50,"SlideLayoutActor::HandleChangeLayout does not have MainMasterResources ready yet"),this.yu.JPe(a),this.qua=ba.a.wqa;return 32}Hkg(a,b,c,f,l){b=this.ra.nf();if(!b||!b.length)return 8;f=0;const x=[],G=this.Qb.hI();if(!G)return Aa.a.J(512500226,
822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get mainMasters"),8;for(var R of b){if(this.Xb.Zc(R)||!R)return 16;f=R.pj;if(!f)return Aa.a.J(512500225,822,50,"SlideLayoutActor::HandleSlidesChangeLayout MainmasterId is 0"),8;x.push(f);if(!this.Ha.TSa&&!this.cjb(G,f))return Aa.a.J(512500224,822,50,"SlideLayoutActor::HandleSlidesChangeLayout fails to validate masters"),8}if(1===c&&!this.Ha.yXa)return 32;for(const fa of x)if(this.Ha.TSa&&!this.cjb(G,f)||!this.yu.kO.Jb(fa)){Aa.a.J(512500195,
822,50,"SlideLayoutActor::HandleSlidesChangeLayout does not have MainMasterResources ready yet");this.yu.JPe(f);if(this.Ha.yXa)return this.H5d(a,c,()=>{this.yu.yBc(EE)},l);this.qua=ba.a.wqa;return 32}R=this.qua=0;for(const fa of b)if(R=fa.Cn,!R)return Aa.a.J(512500194,822,10,"SlideLayoutActor::HandleSlidesChangeLayout fails to get contentMasterId"),8;1<b.length?Aa.a.J(512500193,822,50,"HandleSlidesChangeLayout: Selected slidenodes: {0}",b.length):Aa.a.J(512500192,822,50,"HandleSlidesChangeLayout: Selected one slidenode.");
1<b.length&&(R=0);if(!this.Vde())return Aa.a.J(512500191,822,50,"HandleSlidesChangeLayout: Layout masters not ready yet "),re.a("RaiseFirstMasterRetrievedEvent")?this.H5d(a,c,()=>{this.yu.q6h(EE)},l):8;if(this.Ha.yXa){if(1===c)return 32;if(!l)return 8;this.GQg=R;this.l7g(l,G,f,!0)}else this.Vhe.UQd(0,this.Qb.su(),G,this.yu.kO,f,Object(C.a)(this,this.zOf,"changeSlidesLayout"),this.$lc(),u.AFrameworkApplication.isRtl).Djd(R);return 32}RNd(a,b){const c=this.ua.Ba;if(c){var f=()=>{this.Fa.Ad();this.ra.Uh()},
l=()=>{this.Fa.Bf(zi.a.oD)};a=parseInt(a);b=parseInt(b);if(a!==c.pj||b!==c.Cn){const x=Nc.a.Eb;Nc.a.cnd("ChangeSlideLayout");Nc.a.Eb&&(Nc.a.Eb.Kr=!0,Nc.a.Eb.Wa("SlideCount","1"));f=this.Fb.ud(15,void 0,f,l);try{f.kc(c),f.fd=ba.a.wqa,c.pj=a,c.Cn=b}finally{f&&f.dispose()}this.Xb.Jw(c,"ChangeSlideLayout");Nc.a.Eb=x}}}zOf(a,b){const c=this.ra.nf();if(c&&c.length){a=parseInt(a);b=parseInt(b);var f=Nc.a.Eb;Nc.a.cnd("ChangeSlidesLayout");Nc.a.Eb.Kr=!0;var l=[];for(var x of c)a===x.pj&&b===x.Cn||l.push(x);
if(l.length){Nc.a.qk("SlideCount",l.length.toString());x=this.Fb.ud(15,void 0,()=>{this.Fa.Ad();this.ra.Uh()},()=>{this.Fa.Bf(zi.a.oD)});try{x.kc(this.ua.Ba);x.fd=ba.a.wqa;for(const G of l)G.pj=a,G.Cn=b}finally{x&&x.dispose()}for(const G of c)this.Xb.Jw(G,"ChangeSlidesLayout");Nc.a.Eb=f}}}Fqj(a,b,c,f,l){if(1===c)return 32;if(!l)return 8;try{let x,G;if(!({masterId:x,layoutId:G}=this.ZTe(l.SourceControlId)).returnValue)return 8;Aa.a.J(512500189,822,50,"SlideLayoutActor:: React Change Layout Dropdown invoked command to Change Layout.");
this.zOf(x,G)}catch(x){return Aa.a.J(512500188,822,10,"SlideLayoutActor:: react change slide layout failed with Exception {0} ",x),8}return 32}Zjg(a,b,c,f,l){f=this.Zb.yf;if((b=this.ua.Ba)&&this.Xb.Zc(b)||this.Xb.Zc(f))return Aa.a.J(512500187,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutOptions Graph node blocked"),16;f=this.Qb.hI();if(!f||!f.length)return Aa.a.J(512500186,822,10,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to get mainMasters"),8;let x=0;if(b){if(x=b.pj,!x)return Aa.a.J(512500185,
822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog MainMasterId is 0"),8}else x=f[0].Id;let G=0;({pj:x,Cn:G}=this.ZMc(f,b));if(!this.Ha.TSa&&!this.cjb(f,x))return Aa.a.J(512500184,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog fails to validate mainMasters"),8;if(1===c){if(!this.Qb.Hj())return 8;if(!this.Ha.yXa)return 32}if(this.Ha.TSa&&!this.cjb(f,x)||!this.yu.kO.Jb(x)||!this.Vde()){Aa.a.J(512500183,822,50,"SlideLayoutActor::HandleNewSlideWithLayoutDialog does not have MainMasterResources ready yet");
this.yu.JPe(x);if(this.Ha.yXa)return this.H5d(a,c,()=>{this.yu.yBc(EE)},l);this.qua=ba.a.kHa}else if(this.qua=0,this.Ha.yXa){if(1===c)return 32;if(!l)return 8;this.HQg=G;this.l7g(l,f,x,!1)}else this.Vhe.UQd(1,this.Qb.su(),f,this.yu.kO,x,Object(C.a)(this,this.ySc,"insertSlideWithLayout"),this.$lc(),u.AFrameworkApplication.isRtl).Djd(G);return 32}l7g(a,b,c,f){a.MenuId&&"style"===a.MenuId||(a.MenuItems=re.a("ReactSlideLayoutSectionsAPIEnabled")?this.q2d(b,c,f):this.kcj(b,c,f));Aa.a.J(512500182,822,50,
"SlideLayoutActor:: React Slide Layout DropDown Invoked. Type : IsChangeLayout : {0}  ",f)}N2d(){const a=this.Qb.su();if(!a||!a.width||!a.height)return Aa.a.J(512500181,822,15,"SlideLayoutActor:: Slide size is null or 0"),new dr.a(vj.kMf,vj.Iii);const b=vj.kMf;return new dr.a(b,a.height/a.width*b)}tbg(){const a={},b={},c=this.N2d();b.root=this.qCi(c.width+vj.uMf,c.height+vj.uMf+vj.Bii+vj.Oii);b.flexContainer={flexDirection:"column"};b.label={"margin-top":"5px","max-width":"100px","font-size":"10px"};
a.galleryButtonInExpanded=b;return a}qCi(a,b){const c={};c.width=a;c.height=b;c.backgroundColor="transparent";return c}kcj(a,b,c){this.led();const f=Object.assign(new wj.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});let l=0,x=!1;const G=a.length;if(!G||1===G&&a&&a[0]&&!a[0].InContent)return f;for(var R=0;R<G;R++)a[R].Id===b&&(l=R,x=!0);x&&(b=this.Ucg(a[l],b,c,l),Array.add(f.MenuSectionList,b));for(b=0;b<G;b++)x&&b===l||(R=this.Ucg(a[b],a[b].Id,
c,b),Array.add(f.MenuSectionList,R));return f}Ucg(a,b,c,f){const l=Object.assign(new Mi.a,{ControlList:[],Title:a.Name});if(!(a.InContent&&this.yu.kO&&this.yu.kO.Jb(a.Id)))return l;var x=this.tbg(),G=c?"ChangeLayout":"NewSlide",R=c?"ChangeLayoutControls":"NewSlideLayoutControls";vj.X5c++;f=re.a("ReactSlideLayoutUniqueIdFix")?f.toString():b.toString()+"_"+vj.X5c.toString();x=Object.assign(new tq.a,{Id:R,ExternalId:G+"_"+f,Type:4,Title:a.Name,GalleryStyle:x,Width:3,GalleryItems:[]});a=a.ContentMasters;
if(!a)return l;G=a.length;for(R=0;R<G;R++)f=a[R],!f||!this.$lc()&&this.Qb.Q8a(f)||Array.add(x.GalleryItems,this.VLc(f,b,c));Array.add(l.ControlList,x);return l}npi(){try{const a=[],b=this.Lua;for(let c in b)a.push(c);this.Lua={};this.n0c={};appChrome.api.unregisterIcons(a)}catch(a){Aa.a.J(512500180,822,15,"SlideLayoutActor::Failed to unregister icons for react new slide layout {0}",a)}}led(){this.npi();try{const a=this.Qb.hI();if(a){for(let b=0;b<a.length;b++){const c=a[b];c&&this.yu.kO&&this.yu.kO.count&&
this.yu.kO.Jb(c.Id)&&this.addIconToMap(this.yu.kO.ga(c.Id).LayoutIcons,c.Id)}appChrome.api.registerIconProvider(()=>this.Lua)}}catch(a){Aa.a.J(512500179,822,15,"SlideLayoutActor::Failed to register icons for react new slide layout {0}",a)}}n1b(a,b){a=String.format("{0}_{1}_{2}",vj.Hvj,a,b);a in this.n0c||(vj.X5c++,this.n0c[a]=a+"_"+vj.X5c.toString());return this.n0c[a]}addIconToMap(a,b){if(this.ua.Ba&&a)for(let f=0;f<a.length;++f){var c=a[f];if(!c)continue;const l=this.n1b(b,c.LayoutId),x={},G={};
c.Icon&&c.Icon.Clip&&c.Icon.Clip.Bounds&&(G.top=String.format("-{0}px",c.Icon.Clip.Bounds.Top),u.AFrameworkApplication.isRtl&&re.a("ReactSlideLayoutRTLFix")?G.right=String.format("-{0}px",c.Icon.Clip.Bounds.Left):G.left=String.format("-{0}px",c.Icon.Clip.Bounds.Left));G.position="absolute";const R={},fa={},wa=this.N2d();fa.height=wa.height.toString()+"px";fa.width=wa.width.toString()+"px";fa.position="relative";fa.overflow="hidden";fa.display="inline-block";R.root=fa;x.root=G;this.dBb&&c.Icon&&(c=
appChrome.buildLayoutImageIconFromUrlWithStyles(this.dBb.resolve(Jg.a.Drb,c.Icon.ImgId),x,R),this.Lua[l]=c)}}q2d(a,b,c){this.led();const f=Object.assign(new wj.a,{Id:c?"PptRibbon.ChangeLayout":"PptRibbon.NewSlideLayout",MenuSectionList:[],UpdateDynamically:!0});var l=Object.assign(new Mi.a,{Id:c?"ChangeLayoutMenuSection":"NewSlideLayoutMenuSection",ControlsId:c?"ChangeLayoutMenuSection.Controls":"NewSlideLayoutMenuSection.Controls",ControlList:[]});Array.add(f.MenuSectionList,l);var x=this.tbg();
x=Object.assign(new tq.a,{Id:c?"ChangeLayoutControls":"NewSlideLayoutControls",ExternalId:c?"ChangeLayoutSection":"NewSlideSection",ExternalGalleryId:c?"ChangeLayoutGallery":"NewSlideGallery",GalleryStyle:x,Width:3,Type:4,GallerySections:[]});Array.add(l.ControlList,x);l=0;let G=!1;const R=a.length;Aa.a.J(512500178,822,50,"React Slide layout: Count of main masters :{0}",R);if(!R||1===R&&a&&a[0]&&!a[0].InContent)return Aa.a.J(512500177,822,10,"React Slide layout rendered empty as main masters not loaded; Type: IsChangelayout:{0} cMainMasters: {1} InContent: {2} ",
c,R,1===R&&!!a&&!!a[0]&&a[0].InContent),f;for(var fa=0;fa<R;fa++)a[fa].Id===b&&(l=fa,G=!0);G&&(b=this.j7g(a[l],b,c),x.GallerySections.push(b));for(b=0;b<R;b++)G&&b===l||(fa=this.j7g(a[b],a[b].Id,c),x.GallerySections.push(fa));return f}j7g(a,b,c){const f=Object.assign(new pN,{SectionId:b.toString(),Title:a.Name,GalleryButtons:[]});if(!(a.InContent&&this.yu.kO&&this.yu.kO.Jb(a.Id)))return Aa.a.J(512500176,822,50,"React Slide layout: Gallery section rendered empty as main masters not loaded;Type: IsChangelayout:{0} , mainMaster.InContent: {1} , presentatonresourcemanager contains main master : {2} ",
c,a.InContent,!!this.yu.kO&&this.yu.kO.Jb(a.Id)),f;a=a.ContentMasters;if(!a)return Aa.a.J(512500175,822,50,"React Slide layout: Gallery section rendered empty as content master is null ;Type: IsChangelayout:{0} ",c),f;const l=a.length;for(let x=0;x<l;x++){const G=a[x];!G||!this.$lc()&&this.Qb.Q8a(G)||Array.add(f.GalleryButtons,this.VLc(G,b,c))}return f}zCa(a,b,c){return re.a(vj.xOf)?(c?"ChangeLayoutButton_":"NewSlideLayoutButton_")+a+"_"+b:a+"_"+b}VLc(a,b,c){const f=a.Id,l=this.zCa(b.toString(),f.toString(),
c),x={},G={},R=this.N2d();G.width=R.width.toString()+"px";G.height=R.height.toString()+"px";re.a("ReactNewSlideLayoutIconBorderFix")||(G.border="#858585 1px solid");x.root=G;return Object.assign(new eE.a,{Id:l,ExternalId:l,Icon:this.n1b(b,f),Command:c?"3430900587":"1579226270",QueryCommand:re.a("NewSlideLayoutShowCurrentLayout")?c?"630989293":"2230133927":null,LabelText:a.Name,FullIconStyle:x,Alt:a.Name})}Yjg(a,b,c){if(this.Xb.rN(this.Zb.yf))return 16;b=this.Qb.hI();if(!b)return 8;let f=null;if(this.Ha.Ly){var l=
this.ra.nf();1<=l.length&&(l.sort((G,R)=>G.we-R.we),a!==ba.a.RCb&&(f=l[l.length-1]))}else a!==ba.a.RCb&&(f=this.ua.Ba);if(this.Xb.Zc(f))return 16;let x;({pj:l,Cn:x}=this.ZMc(b,this.ua.Ba));if(!this.cjb(b,l))return 8;if(1===c)return 32;c=this.Sz.ZJc(Object(ua.a)(120,f),l,x,a);this.BDf(l,x);c.yN||this.Xb.Jw(c,a);return 32}dpj(a,b,c,f,l){if(this.Xb.rN(this.Zb.yf))return 16;if(1===c)return 32;if(!l)return 8;c=l.slideId;b=l.nck;l=l.Jvi;f=null;this.Ha.Ly?(c=this.ra.nf(),1<=c.length&&(c.sort((x,G)=>x.we-
G.we),f=c[c.length-1])):f=this.Qb.kl(c);c=this.Sz.ZJc(f,b,l,a);this.BDf(b,l);c.yN||this.Xb.Jw(c,a);return 32}dispose(){this.yu.YRk(Object(C.a)(this,this.P3g,"openIgnoredDialog"));this.Lua=null}ySc(a,b){const c=this.ua.Ba;let f=Oe.a.empty;c&&(f=c.Bb);const l=this.Qb.hI();l&&("0"===a||"0"===b?{pj:a,Cn:b}=this.ZMc(l,c):(a=parseInt(a),b=parseInt(b)),this.ia.La(ba.a.P7c,2,new FE(f,a,b)))}Gqj(a,b,c,f,l){if(1===c)return 32;if(!l||!({masterId:c,layoutId:b}=this.ZTe(l.SourceControlId)).returnValue)return 8;
f=this.ua.Ba;a=Oe.a.empty;f&&(a=f.Bb);l=this.Qb.hI();if(!l)return 8;"0"===c||"0"===b?{pj:c,Cn:b}=this.ZMc(l,f):(c=parseInt(c),b=parseInt(b));Aa.a.J(512500172,822,50,"SlideLayoutActor:: React New Slide Dropdown invoked command to insert new slide.");return this.ia.La(ba.a.P7c,2,new FE(a,c,b))}ZMc(a,b){let c,f;f=c=0;if(!this.WQi(a))return{pj:c,Cn:f};if(b){c=b.pj;if(!c)return{pj:c,Cn:f};if(!this.Ha.w6b||this.sRi(c)){f=b.Cn;if(!f)return{pj:c,Cn:f};if(b.aTa)for(b=0;b<a.length;b++)if(a[b].Id===c&&1<a[b].ContentMasters.length){f=
a[b].ContentMasters[1].Id;break}}}else c=a[0].Id,f=this.Ha.w6b?0:a[0].ContentMasters[0].Id;return{pj:c,Cn:f}}S2f(a,b,c){if(1===a)return 32;a=this.ZTe(b.SourceControlId);if(!a.returnValue)return 8;a.layoutId&&"0"!==a.layoutId&&(b[gm.a.On]=a.layoutId===(c?this.GQg.toString():this.HQg.toString()));return 32}Ccd(a,b,c,f,l){return this.S2f(c,l,!1)}TCe(a,b,c,f,l){return this.S2f(c,l,!0)}ZTe(a){let b,c;c=b=null;if(!a)return Aa.a.J(512500171,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),
{returnValue:!1,masterId:b,layoutId:c};a=a.split("_");const f=re.a(vj.xOf),l=f?1:0,x=f?2:1;if(!a||a.length!==(f?3:2))return Aa.a.J(512500170,822,10,"SlideLayoutActor::Unable to get master id and layout id from action data"),{returnValue:!1,masterId:b,layoutId:c};b=a[l];c=a[x];return{returnValue:!0,masterId:b,layoutId:c}}WQi(a){if(0===a.length)return!1;for(let b=0;b<a.length;++b)if(0!==a[b].ContentMasters.length)return!0;return!1}P3g(){this.qua&&(Aa.a.J(512500169,822,50,"SlideLayoutActor::OpenIgnoredDialog is auto-opening dialog {0}",
this.qua===ba.a.wqa?"ChangeLayout":"NewSlide"),this.ia.processAction(this.qua,2));this.qua=0}cjb(a,b){for(let c=0;c<a.length;c++)if(a[c].Id===b)return!0;return!1}BDf(a,b){Nc.a.qk("MainMasterId",a.toString());Nc.a.qk("ContentMasterId",b.toString());const c=this.Qb.hI(),f=new Sys.StringBuilder;if(c){for(let l=0;l<c.length;l++)f.appendLine(String.format("MainMasterId={0}, ContentMasterCount={1}; ",c[l].Id,c[l].ContentMasters.length));Aa.a.J(512500168,813,50,"Insert slide with layout: MainMasterCount={0}. {1}. SelectedMainMasterId={2}, SelectedContentMasterId={3}",
c.length,f,a,b)}}Vde(){return this.yu.gJf()}sRi(a){if(0===a)return!1;const b=this.Qb.Nsb();if(b&&0<b.length)for(const c of b)if(c.idField===a&&0<c.layoutCountField)return!0;return!1}H5d(a,b,c,f){this.Ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ExtendedPRIIsEnabled",!1)?1===b?a=32:2===b?(b={},f=!!f&&f.IsShadowMenuOpen,b.payload={["isShadowRendering"]:f},u.AFrameworkApplication.oEb.handleCommand(Kd.ActionManager.k3a(a),b),f||c(),a=2):a=8:a=8;return a}static sHj(a){return a===vj.Lii||a===
vj.Mii||a===vj.Jii||a===vj.Nii||a===vj.Kii}}vj.Lii=1041;vj.Mii=1042;vj.Jii=2052;vj.Nii=1028;vj.Kii=3076;vj.Hvj="LayoutIcon";vj.xOf="ReactSlideLayoutButtonIdChange";vj.kMf=145;vj.Iii=82;vj.uMf=24;vj.Bii=14;vj.Oii=5;vj.X5c=1;Object(e.a)(vj,"SlideLayoutActor",null,[229,106]);class qN{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.CF=this.l9=this.Qbb=this.m9=null;this.ia=a;this.wQ=b;this.Fa=c;this.Xb=f;this.Sz=l;this.Zb=x;this.ua=G;this.uc=R;this.Je=fa;this.Lhe=wa(500,Object(C.a)(this,this.Nad,"performKeyboardThumbnailReorder"));
this.ra=Wa;this.ep=mb;this.EFa=Kb}ub(){this.ia.pa(ba.a.Odc,Bb.a.application,Object(C.a)(this,this.Xoj,"handleMoveSlide"),4);this.ia.pa(ba.a.VVg,Bb.a.application,Object(C.a)(this,this.Yoj,"handleMoveSlideById"),4);this.ia.pa(ba.a.ydb,sc.a.application,Object(C.a)(this,this.uQc,"handleReorderSlide"),4);this.ia.pa(ba.a.vdb,sc.a.application,Object(C.a)(this,this.uQc,"handleReorderSlide"),4);this.ia.pa(ba.a.xdb,sc.a.application,Object(C.a)(this,this.uQc,"handleReorderSlide"),4);this.ia.pa(ba.a.wdb,sc.a.application,
Object(C.a)(this,this.uQc,"handleReorderSlide"),4);this.ia.pa(ba.a.Pdc,sc.a.application,Object(C.a)(this,this.Nmj,"handleCommitPendingMoveSlideData"),4);this.ia.pa(ba.a.Qdc,sc.a.application,Object(C.a)(this,this.aqj,"handleQueryCommitMoveSlideDataEnabled"),100)}xe(){const a=this.Fa.Dc(zi.a.oD);a.bindAction(A.KeyInputManager.Na(w.a.$0,A.KeyInputManager.He),ba.a.ydb);a.bindAction(A.KeyInputManager.Na(w.a.Y0,A.KeyInputManager.He),ba.a.vdb);a.bindAction(A.KeyInputManager.Na(w.a.$0,A.KeyInputManager.He|
4),ba.a.xdb);a.bindAction(A.KeyInputManager.Na(w.a.Y0,A.KeyInputManager.He|4),ba.a.wdb)}Yoj(a,b,c,f,l){a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.EFa&&(this.ep&&1<this.ra.nf().length||this.Xb.pSa()))return 16;if(1===c)return 32;if(!l)return Aa.a.J(50348433,822,10,"HandleMoveSlideById with no null action data."),8;b=l.aea;c=[];for(var x of b)(b=a.$B(x))?c.push(b):Aa.a.J(50348435,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",
x.sid,x.cid);x=l.Ba?a.$B(l.Ba):null;b=a.$B(l.Idc);f=null;0<=l.sectionIndex&&(f=a.ofg(l.sectionIndex));return this.Wjg(c,b,x,f,l.Iae)}Xoj(a,b,c,f,l){return!this.EFa&&(this.ep&&1<this.ra.nf().length||this.Xb.pSa())?16:1===c?32:l?this.Wjg(l.aea,l.Idc,l.Ba,null,l.Iae):8}Wjg(a,b,c,f,l){if(this.EFa)for(var x of a)if(!x||this.Xb.Zc(this.uc.kl(x.Bb)))return 16;x=[];for(var G of a){if(!G)continue;const R=this.uc.kl(G.Bb);R?x.push(R):Aa.a.J(591737178,822,15,"HandleMoveSlideById: slide node is null for given Sid:{0}, Cid:{1}.",
G.Bb.sid,G.Bb.cid)}if(G=Nc.a.Eb)G.Oj=!0,G.WE||(G.WE=new Date),x&&G.Wa("SlideCount",a.length.toString());G=null;l||(this.EFa?c&&(G=c):a&&0<a.length&&(G=a[0]),G&&!this.Zb.Ba.Bb.equals(G.Bb)&&(this.Zb.Ba=this.uc.kl(G.Bb)));a=b?this.uc.kl(b.Bb):null;this.Sz.HPi(x,a,f);return 32}uQc(a,b,c){if(this.wQ.SZ||!this.ua.Ba||this.Xb.Zc(this.Zb.yf)||!this.EFa&&this.ep&&1<this.ra.nf().length)return 16;if(1===c)return 32;if(this.EFa){b=this.ra.nf();if(!b||!b.length)return 16;this.gol(b,a)}else this.aol(this.ua.Ba,
a);return 32}Nmj(a,b,c){if(this.Xb.Zc(this.Zb.yf)||!this.UOf())return 16;if(1===c)return 32;this.Nad();return 32}aqj(){return this.m9?32:16}Nob(a){if(!a||!a.length)return!1;if(1<a.length)for(let b=0;b<a.length-1;b++)if(1!==a[b+1].slideIndex-a[b].slideIndex)return!1;return!0}aol(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.Je.qY;if(!(1>=f)){var l=!1;this.Qbb||(this.Qbb=a,this.CF=c.slides||[],l=!0);a=-1;for(c=0;c<f;c++)if(this.CF[c]&&this.Qbb.Bb.equals(this.CF[c].Bb)){a=
c;break}if((b!==ba.a.ydb&&b!==ba.a.xdb||a)&&(b!==ba.a.vdb&&b!==ba.a.wdb||a!==f-1)){switch(b){case ba.a.ydb:b=a-1;break;case ba.a.vdb:b=a+1;break;case ba.a.xdb:b=0;break;case ba.a.wdb:b=f-1;break;default:return}Array.removeAt(this.CF,a);Array.insert(this.CF,b,this.Qbb);for(l=0;l<f;l++)this.CF[l]?this.CF[l].we=l:Aa.a.J(576758465,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",l,f);this.Je.Swa(b);f=new Hx(!0,[this.Qbb],0<b?this.CF[b-1]:null);this.mJf(f)}else l&&
(this.CF=this.Qbb=null)}}gol(a,b){var c=this.ua.presentation;if(!c)throw Error.argumentNull("Presentation is null");var f=this.Je.qY;if(!(1>=f)&&(a.sort((x,G)=>x.slideIndex-G.slideIndex),this.Nob(a))){var l=!1;this.l9||(this.l9=a,this.CF=c.slides||[],l=!0);a=this.cPc(this.l9[0],this.CF);c=this.cPc(this.l9[this.l9.length-1],this.CF);if((b!==ba.a.ydb&&b!==ba.a.xdb||a)&&(b!==ba.a.vdb&&b!==ba.a.wdb||c!==f-1)){l=null;switch(b){case ba.a.ydb:l=0<=a-2?this.CF[a-2]:null;b=a-1;break;case ba.a.vdb:b=a+this.l9.length<
f?a+this.l9.length:f-1;l=this.CF[b];break;case ba.a.xdb:l=null;b=0;break;case ba.a.wdb:l=this.CF[f-1];b=f-1;break;default:return}for(a=this.l9.length-1;0<=a;a--)this.A9h(this.l9[a],l);for(a=0;a<f;a++)this.CF[a]?this.CF[a].we=a:Aa.a.J(576758466,822,50,"Attempted to set ThumbnailSlideIndex on a null slide - slide {0} of {1} is null",a,f);this.Je.Swa(b);f=new Hx(!0,this.l9,l);this.mJf(f)}else l&&(this.CF=this.l9=null)}}A9h(a,b){const c=this.cPc(a,this.CF);Array.removeAt(this.CF,c);b=this.cPc(b,this.CF)+
1;Array.insert(this.CF,b,a)}cPc(a,b){if(a&&b)for(let c=0;c<b.length;c++)if(a.Bb.equals(b[c].Bb))return c;return-1}Ibi(a,b){if(!a||!b)return a!==b?!1:!0;if(a.length!==b.length)return!1;for(const c of a){a=!1;for(const f of b)if(c&&f&&c.Bb.equals(f.Bb)){a=!0;break}if(!a)return!1}return!0}mJf(a){if(!a)throw Error.argumentNull("moveData");this.EFa?this.Ibi(this.l9,a.aea)||this.Nad():this.m9&&this.m9.aea&&a.aea&&this.m9.aea[0]&&a.aea[0]&&!this.m9.aea[0].Bb.equals(a.aea[0].Bb)&&this.Nad();this.m9=a;this.Lhe.perform()}Nad(){if(this.UOf()){var a=
this.m9;this.l9=this.Qbb=this.m9=null;Array.clear(this.CF);this.ia.La(ba.a.Odc,2,a)}}UOf(){const a=this.ua.presentation;if(!a)throw Error.argumentNull("Presentation is null");if(!this.m9)return!1;let b=!0,c=!this.m9.Idc;for(let f=0;f<this.m9.aea.length;f++)b=!!a.$B(this.m9.aea[f].Bb)&&b;c||(c=!!a.$B(this.m9.Idc.Bb));return b&&c}}Object(e.a)(qN,"SlideMoveActor",null,[229]);class Wx extends Zw.a{constructor(){super();this.TableStyles=this.TableCellStyles=null;this.columns=0}}Object(e.a)(Wx,"TableGalleryButtonProps",
Zw.a,[]);class rN extends Wx{constructor(){super()}get Type(){return 8}}Object(e.a)(rN,"ChangeColorsGalleryButtonProps",Wx,[]);class sN{constructor(){this.hasMath=this.fReverseEnabled=this.fReverseChecked=!1;this.SemanticNodes=null;this.SmartArtLayout=0}}Object(e.a)(sN,"SmartArtInfo",null,[]);var Us=d(485);class Ii{constructor(a,b,c){this.zF=a;this.k8j=b;this.N9j=c}get id(){return this.zF}get parameter(){return this.k8j}get eih(){return this.N9j}}Object(e.a)(Ii,"SmartArtColorInfo",null,[]);class tN{constructor(a,
b,c,f,l,x,G,R,fa,wa,Wa,mb){this.Zp=[];this.ia=a;this.Xb=b;this.nb=c;this.Fb=f;this.Fa=l;this.ua=x;this.Yx=G;this.Qb=R;this.Mb=wa;this.ol=Wa;this.Ea=mb;this.bzk()}ub(){this.ia.pa(ba.a.cSa,Bb.a.view,Object(C.a)(this,this.uoj,"handleInsertSmartArt"),4);this.ia.pa(ba.a.ghl,Bb.a.application,Object(C.a)(this,this.Crj,"handleSmartArtToolsTabViewHandler"),4);this.ia.pa(ba.a.qEc,Bb.a.application,Object(C.a)(this,this.Cmj,"handleChangeSmartArtLayout"),4);this.ia.pa(ba.a.azk,Bb.a.application,Object(C.a)(this,
this.Rpj,"handlePopulateSmartArtColorStyles"),96);this.ia.pa(ba.a.ZVb,Bb.a.application,Object(C.a)(this,this.Amj,"handleChangeSmartArtColor"),4);this.ia.pa(ba.a.Ami,Bb.a.application,Object(C.a)(this,this.Bmj,"handleChangeSmartArtColorAnchor"),4);this.ia.pa(ba.a.rEc,Bb.a.application,Object(C.a)(this,this.Dmj,"handleChangeSmartArtStyle"),4);this.ia.pa(ba.a.DIa,Bb.a.application,Object(C.a)(this,this.Tqj,"handleResetSmartArt"),4);this.ia.pa(ba.a.uih,Bb.a.application,Object(C.a)(this,this.Xqj,"handleReverseSmartArt"),
4);this.ia.pa(ba.a.zDe,Bb.a.application,Object(C.a)(this,this.fqj,"handleQueryReverseSmartArt"),97);this.ia.pa(ba.a.GLi,Bb.a.application,Object(C.a)(this,this.tnj,"handleEditSmartArtText"),4);this.ia.pa(ba.a.ZCe,Bb.a.application,Object(C.a)(this,this.bqj,"handleQueryEditSmartArtText"),96)}xe(){}uoj(a,b,c,f,l){b=this.ua.Ba;if(!b||this.Xb.Zc(b))return 16;if(1===c)return 32;this.tad(l,a);if(!l)return 8;if((c=b.L2(this.nb.Yd()))&&this.Xb.Zc(c))return 16;if(!this.ol.yI(b,1))return this.ol.AJ(b),16;const x=
this.Kfj(b,c,l);l=this.Fb.ud(15,void 0,()=>{this.nb.Cy();this.nb.Uh();this.Fa.Ad()},()=>{this.nb.selectShape(Object(ua.a)(4,x),!0)});try{l.kc(b),l.fd=a,c&&b.gU([c]),b.GB(Object(ua.a)(4,x))}finally{l&&l.dispose()}this.Yx.CI=Object(ua.a)(4,x);return 32}Crj(){return Object(ua.a)(1364,this.fya())?32:16}Cmj(a,b,c,f,l){b=this.fya();if(!b||this.Xb.Zc(b))return 16;if(1===c)return 32;c=this.nb.Yd();for(var x of c){if(x.Pf){b=x;break}if(x.get_smartArtModelId()){b=this.Ea.nr(x);this.nb.n7(x);this.nb.selectShape(b,
!1);break}}this.tad(l,a);x=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{x.kc(b),x.fd=a,Object(ua.a)(1364,b).ensureModelData().get_elementCollection().documentElement.xna=l}finally{x&&x.dispose()}return 32}Rpj(a,b,c,f,l){if(!this.fya())return 16;a=this.nb.rn();if(!a)return 16;if(1===c)return 32;if(!l)return 8;l.MenuId&&"color"===l.MenuId?l.PopulationXML=this.lhi(a):l.MenuItems=this.chi(a);return 32}Amj(a,b,c,f,l){b=this.fya();if(!b||this.Xb.Zc(b))return 16;if(1===c)return 32;this.tad(l,
a);c=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{c.kc(b),c.fd=a,Object(ua.a)(1364,b).ensureModelData().get_elementCollection().documentElement.uxa=l}finally{c&&c.dispose()}return 32}Bmj(){return this.fya()?32:16}Dmj(a,b,c,f,l){b=this.fya();if(!b||this.Xb.Zc(b))return 16;if(1===c)return 32;this.tad(l,a);c=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{c.kc(b),c.fd=a,Object(ua.a)(1364,b).ensureModelData().get_elementCollection().documentElement.vxa=l}finally{c&&c.dispose()}return 32}Tqj(a,
b,c){b=Object(ua.a)(1364,this.fya());if(!b||this.Xb.Zc(Object(ua.a)(4,b)))return 16;if(1===c)return 32;c=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{c.kc(b),c.fd=a,b.DIa=!0}finally{c&&c.dispose()}return 32}Xqj(a,b,c){b=this.fya();if(!b||!b.pce||this.Xb.Zc(b))return 16;if(1===c)return 32;c=new sN;c.fReverseEnabled=b.pce;c.fReverseChecked=!b.oce;const f=this.Fb.ud(15,void 0,()=>{this.nb.kj();this.Fa.Ad()});try{f.kc(b),f.fd=a,Object(ua.a)(1364,b).ensureModelData().get_elementCollection().documentElement.smartArtInfo=
c}finally{f&&f.dispose()}return 32}fqj(a,b,c,f,l){a=this.fya();a=!!a&&a.oce;if(!Object(Ma.a)(Nh.a,l))return 8;l.Nf(a);return 32}tnj(a,b,c){a=this.fya();if(!a||this.Xb.Zc(a))return 16;if(1===c)return 32;this.ia.La(ba.a.cOa,2,new jn.a(a,!0,null));return 32}bqj(a,b,c,f,l){a=this.nb.cC();if(!Object(Ma.a)(Nh.a,l))return 8;l.Nf(a);return 32}Kfj(a,b,c){if(!a)return null;const f=a.ev();let l;l=b?b.Ftb(sf.a.uX,sf.a.E4):this.Qb.hsa(sf.a.uX,sf.a.E4);return a.KRd(!0,0,b,c,l.x,l.y,sf.a.uX,sf.a.E4,f+1)}fya(){const a=
this.nb.Yd();for(const b of a){if(b.Pf)return b;if(b.get_smartArtModelId())return this.Ea.nr(b)}return null}bzk(){Array.add(this.Zp,new Ii(0,"accent0_1,mainScheme",ResourceStrings.L_SmartArtDark1Outline));Array.add(this.Zp,new Ii(1,"accent0_2,mainScheme",ResourceStrings.L_SmartArtDark2Outline));Array.add(this.Zp,new Ii(2,"accent0_3,mainScheme",ResourceStrings.L_SmartArtDark2Fill));Array.add(this.Zp,new Ii(3,"colorful1,colorful",ResourceStrings.L_SmartArtColorful1));Array.add(this.Zp,new Ii(4,"colorful2,colorful",
ResourceStrings.L_SmartArtColorful2));Array.add(this.Zp,new Ii(5,"colorful3,colorful",ResourceStrings.L_SmartArtColorful3));Array.add(this.Zp,new Ii(6,"colorful4,colorful",ResourceStrings.L_SmartArtColorful4));Array.add(this.Zp,new Ii(7,"colorful5,colorful",ResourceStrings.L_SmartArtColorful5));Array.add(this.Zp,new Ii(8,"accent1_1,accent1",ResourceStrings.L_SmartArtColoredOutline1));Array.add(this.Zp,new Ii(9,"accent1_2,accent1",ResourceStrings.L_SmartArtColoredFill1));Array.add(this.Zp,new Ii(10,
"accent1_3,accent1",ResourceStrings.L_SmartArtGradientRange1));Array.add(this.Zp,new Ii(11,"accent1_4,accent1",ResourceStrings.L_SmartArtGradientLoop1));Array.add(this.Zp,new Ii(12,"accent1_5,accent1",ResourceStrings.L_SmartArtTransparentGradientRange1));Array.add(this.Zp,new Ii(13,"accent2_1,accent2",ResourceStrings.L_SmartArtColoredOutline2));Array.add(this.Zp,new Ii(14,"accent2_2,accent2",ResourceStrings.L_SmartArtColoredFill2));Array.add(this.Zp,new Ii(15,"accent2_3,accent2",ResourceStrings.L_SmartArtGradientRange2));
Array.add(this.Zp,new Ii(16,"accent2_4,accent2",ResourceStrings.L_SmartArtGradientLoop2));Array.add(this.Zp,new Ii(17,"accent2_5,accent2",ResourceStrings.L_SmartArtTransparentGradientRange2));Array.add(this.Zp,new Ii(18,"accent3_1,accent3",ResourceStrings.L_SmartArtColoredOutline3));Array.add(this.Zp,new Ii(19,"accent3_2,accent3",ResourceStrings.L_SmartArtColoredFill3));Array.add(this.Zp,new Ii(20,"accent3_3,accent3",ResourceStrings.L_SmartArtGradientRange3));Array.add(this.Zp,new Ii(21,"accent3_4,accent3",
ResourceStrings.L_SmartArtGradientLoop3));Array.add(this.Zp,new Ii(22,"accent3_5,accent3",ResourceStrings.L_SmartArtTransparentGradientRange3));Array.add(this.Zp,new Ii(23,"accent4_1,accent4",ResourceStrings.L_SmartArtColoredOutline4));Array.add(this.Zp,new Ii(24,"accent4_2,accent4",ResourceStrings.L_SmartArtColoredFill4));Array.add(this.Zp,new Ii(25,"accent4_3,accent4",ResourceStrings.L_SmartArtGradientRange4));Array.add(this.Zp,new Ii(26,"accent4_4,accent4",ResourceStrings.L_SmartArtGradientLoop4));
Array.add(this.Zp,new Ii(27,"accent4_5,accent4",ResourceStrings.L_SmartArtTransparentGradientRange4));Array.add(this.Zp,new Ii(28,"accent5_1,accent5",ResourceStrings.L_SmartArtColoredOutline5));Array.add(this.Zp,new Ii(29,"accent5_2,accent5",ResourceStrings.L_SmartArtColoredFill5));Array.add(this.Zp,new Ii(30,"accent5_3,accent5",ResourceStrings.L_SmartArtGradientRange5));Array.add(this.Zp,new Ii(31,"accent5_4,accent5",ResourceStrings.L_SmartArtGradientLoop5));Array.add(this.Zp,new Ii(32,"accent5_5,accent5",
ResourceStrings.L_SmartArtTransparentGradientRange5));Array.add(this.Zp,new Ii(33,"accent6_1,accent6",ResourceStrings.L_SmartArtColoredOutline6));Array.add(this.Zp,new Ii(34,"accent6_2,accent6",ResourceStrings.L_SmartArtColoredFill6));Array.add(this.Zp,new Ii(35,"accent6_3,accent6",ResourceStrings.L_SmartArtGradientRange6));Array.add(this.Zp,new Ii(36,"accent6_4,accent6",ResourceStrings.L_SmartArtGradientLoop6));Array.add(this.Zp,new Ii(37,"accent6_5,accent6",ResourceStrings.L_SmartArtTransparentGradientRange6))}chi(a){const b=
Object.assign(new wj.a,{Id:"ControlsChangeSmartArtColor",MenuSectionList:[]}),c=Object.assign(new Mi.a,{Id:"MenuSectionChangeSmartArtColor",ControlList:[]});Array.add(b.MenuSectionList,c);const f=Vi.Color.Oi(a.Pe.Light1),l=Vi.Color.Oi(a.Pe.Dark1),x=Vi.Color.Oi(a.Pe.Light2),G=Vi.Color.Oi(a.Pe.Dark2),R=Array(6);R[0]=Vi.Color.Oi(a.Pe.Accent1);R[1]=Vi.Color.Oi(a.Pe.Accent2);R[2]=Vi.Color.Oi(a.Pe.Accent3);R[3]=Vi.Color.Oi(a.Pe.Accent4);R[4]=Vi.Color.Oi(a.Pe.Accent5);R[5]=Vi.Color.Oi(a.Pe.Accent6);a=0;
Array.add(c.ControlList,({D3b:a}=this.Xgi(a,f,l,x,G)).returnValue);Array.add(c.ControlList,({D3b:a}=this.Ufi(a,f,R)).returnValue);Array.addRange(c.ControlList,({D3b:a}=this.Ffi(a,f,R)).returnValue);return b}Xgi(a,b,c,f,l){const x=Object.assign(new tq.a,{Id:"PrimaryThemeColorsGallery",ExternalId:"ChangeSmartArtColorGalleryPrimary",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_PrimaryThemeColors,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(x.GalleryItems,
this.hdc(b,c,a++));Array.add(x.GalleryItems,this.hdc(b,l,a++));Array.add(x.GalleryItems,this.hdc(l,f,a++));return{returnValue:x,D3b:a}}Ufi(a,b,c){const f=Object.assign(new tq.a,{Id:"ColorfulGallery",ExternalId:"ChangeSmartArtColorGalleryColorful",ExternalGalleryId:"ChangeSmartArtColorGallery",Title:ResourceStrings.L_Colorful,Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});Array.add(f.GalleryItems,this.F6c(c[1],c[2],c[3],c[4],c[5],c[1],b,a++));for(let l=1;5>l;l++)Array.add(f.GalleryItems,
this.Jte(c[l],c[l+1],b,a++));return{returnValue:f,D3b:a}}Ffi(a,b,c){const f=[];for(let G=0;6>G;G++){const R=Object.assign(new tq.a,{Id:"ColorfulGallery"+(G+1),ExternalId:"ChangeSmartArtColorGalleryAccent"+(G+1),ExternalGalleryId:"ChangeSmartArtColorGallery",Title:String.format(ResourceStrings.L_AccentFormat,G+1),Type:8,Width:5,ElementDimensions:"Size64by48",GalleryItems:[]});var l=new Vi.Color;l.r=l.g=l.b=255;var x=new Vi.Color;l=Vi.Color.jZ(c[G],l,.5);x=Vi.Color.jZ(c[G],x,.25);Array.add(R.GalleryItems,
this.hdc(b,c[G],a++));Array.add(R.GalleryItems,this.hdc(c[G],b,a++));Array.add(R.GalleryItems,this.Jte(c[G],l,b,a++));Array.add(R.GalleryItems,this.Bck(x,c[G],l,b,a++));Array.add(R.GalleryItems,this.Jte(c[G],l,b,a++));Array.add(f,R)}return{returnValue:f,D3b:a}}hdc(a,b,c){return this.F6c(a,a,a,a,a,a,b,c)}Jte(a,b,c,f){const l=Us.a.jZ(a,b,2/6),x=Us.a.jZ(a,b,.5),G=Us.a.jZ(a,b,4/6),R=Us.a.jZ(a,b,5/6);return this.F6c(a,l,x,G,R,b,c,f)}Bck(a,b,c,f,l){const x=Vi.Color.jZ(b,c,.5);return this.F6c(a,b,x,c,x,
b,f,l)}F6c(a,b,c,f,l,x,G,R){R=this.agg(R);const fa="ChangeSmartArtColor__"+R.parameter.replace(",","__");return Object.assign(new rN,{Id:fa,ExternalId:fa,MenuItemId:R.parameter,Command:"367274693",QueryCommand:"1384172858",Alt:R.eih,TableCellStyles:[this.lCb(a,G),this.lCb(b,G),this.lCb(c,G),this.lCb(f,G),this.lCb(l,G),this.lCb(x,G)]})}lCb(a,b){const c={};c.backgroundColor=this.aRf(a);c.border=String.format("1px solid {0}",this.aRf(b));return c}aRf(a){return String.format("rgb( {0:d},{1:d},{2:d} )",
a.r,a.g,a.b)}lhi(a){const b=new Sys.StringBuilder;b.append('<Menu Id="ControlsChangeSmartArtColor">');const c=new Vi.Color;c.r=c.g=c.b=255;const f=new Vi.Color,l=Vi.Color.Oi(a.Pe.Light1);var x=Vi.Color.Oi(a.Pe.Dark1),G=Vi.Color.Oi(a.Pe.Light2),R=Vi.Color.Oi(a.Pe.Dark2);const fa=Array(6);fa[0]=Vi.Color.Oi(a.Pe.Accent1);fa[1]=Vi.Color.Oi(a.Pe.Accent2);fa[2]=Vi.Color.Oi(a.Pe.Accent3);fa[3]=Vi.Color.Oi(a.Pe.Accent4);fa[4]=Vi.Color.Oi(a.Pe.Accent5);fa[5]=Vi.Color.Oi(a.Pe.Accent6);a=0;b.append(String.format('<MenuSection Id="PrimaryThemeColors" Title="{0}">',
ResourceStrings.L_PrimaryThemeColors));b.append('<Gallery Id="PrimaryThemeColorsGallery" ElementDimensions="Size64by48" Width="5">');this.gdc(b,l,x,a++);this.gdc(b,l,R,a++);this.gdc(b,R,G,a++);b.append("</Gallery>");b.append("</MenuSection>");b.append(String.format('<MenuSection Id="Colorful" Title="{0}">',ResourceStrings.L_Colorful));b.append('<Gallery Id="ColorfulGallery" ElementDimensions="Size64by48" Width="5">');this.B6c(b,fa[1],fa[2],fa[3],fa[4],fa[5],fa[1],l,a++);for(x=1;5>x;x++)this.Fte(b,
fa[x],fa[x+1],l,a++);b.append("</Gallery>");b.append("</MenuSection>");for(x=0;6>x;x++)G=String.format(ResourceStrings.L_AccentFormat,x+1),b.append(String.format('<MenuSection Id="Accent{0}" Title="{1}">',x+1,G)),b.append(String.format('<Gallery Id="ColorfulGallery{0}" ElementDimensions="Size64by48" Width="5">',x+1)),G=Vi.Color.jZ(fa[x],c,.5),R=Vi.Color.jZ(fa[x],f,.25),this.gdc(b,l,fa[x],a++),this.gdc(b,fa[x],l,a++),this.Fte(b,fa[x],G,l,a++),this.wck(b,R,fa[x],G,l,a++),this.Fte(b,fa[x],G,l,a++),b.append("</Gallery>"),
b.append("</MenuSection>");b.append("</Menu>");return b.toString()}gdc(a,b,c,f){this.B6c(a,b,b,b,b,b,b,c,f)}Fte(a,b,c,f,l){const x=Us.a.jZ(b,c,2/6),G=Us.a.jZ(b,c,.5),R=Us.a.jZ(b,c,4/6),fa=Us.a.jZ(b,c,5/6);this.B6c(a,b,x,G,R,fa,c,f,l)}wck(a,b,c,f,l,x){const G=Vi.Color.jZ(c,f,.5);this.B6c(a,b,c,G,f,G,c,l,x)}B6c(a,b,c,f,l,x,G,R,fa){fa=this.agg(fa);a.append('<GalleryButton Id="');a.append(fa.parameter);a.append('" Command="');a.append(ba.a.ZVb.toString());a.append('" QueryCommand="');a.append(ba.a.HDe.toString());
a.append('" InnerHTML="');a.append("&lt;div style=&quot;width:64px;height:48px;position:relative;font-size:1px;&quot;&gt;");this.mCb(a,b,R,8,-1);this.mCb(a,c,R,34,-1);this.mCb(a,f,R,8,16);this.mCb(a,l,R,34,16);this.mCb(a,x,R,8,33);this.mCb(a,G,R,34,33);a.append("&lt;/div&gt;");a.append('" Alt="');a.append(fa.eih);a.append('"/>')}tad(a,b){a.Uri=b===ba.a.ZVb?"urn:microsoft.com/office/officeart/2005/8/colors/"+a.Uri:b===ba.a.rEc?"3d8"===a.Uri?"urn:microsoft.com/office/officeart/2009/2/quickstyle/3d8":
"urn:microsoft.com/office/officeart/2005/8/quickstyle/"+a.Uri:"timeline"===a.Category?"BasicTimeline"===a.Uri||"HexagonTimeline"===a.Uri||"RoundedRectangleTimeline"===a.Uri||"AccentHomeChevronProcess"===a.Uri?"urn:microsoft.com/office/officeart/2016/7/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2017/3/layout/"+a.Uri:"urn:microsoft.com/office/officeart/2005/8/layout/"+a.Uri}agg(a){let b;for(let c=0;c<this.Zp.length;c++)if(b=this.Zp[c],b.id===a)return b;return new Ii(-1,"","")}mCb(a,b,c,f,l){a.append("&lt;div style=&quot;");
b.IWd()||(b=String.format("rgb( {0:d},{1:d},{2:d} )",b.r,b.g,b.b),a.append("background-color:"),a.append(b),a.append(";"));a.append("left:");a.append(f.toString());a.append("px;top:");a.append(l.toString());a.append("px;width:22px;height:14px;position:absolute;");c.IWd()||(c=String.format("rgb( {0:d},{1:d},{2:d} )",c.r,c.g,c.b),a.append("border:solid 1px "),a.append(c),a.append(";"));a.append("&quot;&gt;&lt;/div&gt;")}}Object(e.a)(tN,"SmartArtActor",null,[229]);class Xx{constructor(a,b,c,f){this.$re=
"BottomOverlaid";this.ia=a;this.Fc=f;this.uc=b;this.Lc=c;this.ase="productionSpokenLanguages_"+this.Fc.yna;this.bse="productionSubtitleLanguages_"+this.Fc.bya}ub(){Aa.a.J(512500167,822,50,"SubtitleActor::RegisterActions - OptIn: True, FUseSubtitles:{0}",this.Fc.Kh);this.ia.pa(ba.a.vic,sc.a.application,Object(C.a)(this,this.vic,"querySubtitleIsEnabled"),96);this.ia.ya(ba.a.OJb,sc.a.application,Object(C.a)(this,this.OJb,"toggleUseSubtitles"));this.ia.pa(ba.a.eah,sc.a.application,Object(C.a)(this,this.LFk,
"querySubtitleSettingsIsEnabled"),96);this.ia.pa(ba.a.mbd,sc.a.application,Object(C.a)(this,this.mbd,"populateTranscriptionSubtitleLanguage"),96);this.ia.pa(ba.a.lbd,sc.a.application,Object(C.a)(this,this.lbd,"populateTranscriptionSpokenLanguage"),96);this.ia.ya(ba.a.Yol,sc.a.application,Object(C.a)(this,this.$rj,"handleToggleTranscriptionSpokenLanguage"));this.ia.ya(ba.a.Zol,sc.a.application,Object(C.a)(this,this.asj,"handleToggleTranscriptionSubtitleLanguage"));this.ia.pa(ba.a.YDe,sc.a.application,
Object(C.a)(this,this.YDe,"queryToggleTranscriptionSpokenLanguage"),96);this.ia.pa(ba.a.ZDe,sc.a.application,Object(C.a)(this,this.ZDe,"queryToggleTranscriptionSubtitleLanguage"),96);this.ia.pa(ba.a.yic,sc.a.application,Object(C.a)(this,this.yic,"querySubtitlesBottomOverlay"),96);this.ia.ya(ba.a.nmd,sc.a.application,Object(C.a)(this,this.nmd,"toggleSubtitlesBottomOverlay"));this.ia.pa(ba.a.zic,sc.a.application,Object(C.a)(this,this.zic,"querySubtitlesTopOverlay"),96);this.ia.ya(ba.a.omd,sc.a.application,
Object(C.a)(this,this.omd,"toggleSubtitlesTopOverlay"));this.ia.pa(ba.a.xic,sc.a.application,Object(C.a)(this,this.xic,"querySubtitlesBelowSlide"),96);this.ia.ya(ba.a.mmd,sc.a.application,Object(C.a)(this,this.mmd,"toggleSubtitlesBelowSlide"));this.ia.pa(ba.a.wic,sc.a.application,Object(C.a)(this,this.wic,"querySubtitlesAboveSlide"),96);this.ia.ya(ba.a.lmd,sc.a.application,Object(C.a)(this,this.lmd,"toggleSubtitlesAboveSlide"))}xe(){}vic(a,b,c,f,l){if(!l||!Object(Ma.a)(Nh.a,l))return 8;l.Nf(this.Fc.Kh);
return 32}LFk(a,b,c,f,l){return 1===c?this.uc.Hj()?32:8:l&&"object"===typeof l?this.Fc&&this.Fc.e_b?32:(Aa.a.J(512500164,822,10,"QuerySubtitleSettingsIsEnabled requires valid subtitleContext"),8):(Aa.a.J(512500165,822,10,"QuerySubtitleSettingsIsEnabled requires actionData"),8)}yic(a,b,c,f,l){if(!l||!Object(Ma.a)(Nh.a,l))return Aa.a.J(512500163,822,10,"SubtitleActor::QuerySubtitlesBottomOverlay requires actionData"),8;l.Nf("BottomOverlay"===this.Fc.Fv);Aa.a.J(512500162,822,50,"SubtitleActor::QuerySubtitlesBottomOverlay: subtitles position is {0}",
this.Fc.Fv);return 32}zic(a,b,c,f,l){if(!l||!Object(Ma.a)(Nh.a,l))return 8;l.Nf("TopOverlay"===this.Fc.Fv);Aa.a.J(512500160,822,50,"SubtitleActor::QuerySubtitlesTopOverlay: subtitles position is {0}",this.Fc.Fv);return 32}xic(a,b,c,f,l){try{l&&l.Nf("BelowSlide"===this.Fc.Fv)}catch(x){Aa.a.J(512500131,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",x)}return 32}wic(a,b,c,f,l){try{l&&l.Nf("AboveSlide"===this.Fc.Fv)}catch(x){Aa.a.J(512500130,822,10,"Exception in QuerySubtitlesBelowSlide: {0}.",
x)}return 32}OJb(a,b,c,f,l){if(1===c)return this.uc.Hj()?32:8;if(!l||"object"!==typeof l)return 8;this.Fc.Kh&&(Pi.a.aM("PPTCaptionDiscoverabiltyDoNotShowAgain","true",Pi.a.JL)||Aa.a.J(512500128,822,10,"SubtitleActor::ToggleUseSubtitles - Failed to set cookie for discoverability opt out to true"));this.Fc.Kh=!this.Fc.Kh;Aa.a.J(512500127,822,50,"SubtitleActor::HandleToggleUseSubtitles: Changed UseSubtitles status to:{0}",this.Fc.Kh);Cb.App.Hb.VF({AlwaysUseSubtitles:"SplitButtonModel",UseSubtitles:"CheckboxModel"});
return 32}mbd(a,b,c,f,l){try{if(1===c)return 32;if(!l)return Aa.a.J(512500126,822,10,"PopulateTranscriptionSubtitleLanguage requires actionData"),8;this.k7g(l,!1)}catch(x){Aa.a.J(512500125,822,10,"Exception in PopulateTranscriptionSubtitleLanguage: {0}.",x)}return 32}lbd(a,b,c,f,l){try{if(1===c)return 32;if(!l)return Aa.a.J(512500124,822,10,"PopulateTranscriptionSpokenLanguage requires actionData"),8;this.k7g(l,!0)}catch(x){Aa.a.J(512500123,822,10,"Exception in PopulateTranscriptionSpokenLanguage: {0}.",
x)}return 32}asj(a,b,c,f,l){try{if(l){this.Fc.bya=l.MenuItemId;this.Fc.Eib=this.Fc.IPc();const x=l.SourceControlId;this.bse!==x&&(a={},a[x]="ToggleButtonModel",a[this.bse]="ToggleButtonModel",Cb.App.Hb.VF(a),this.bse=x)}}catch(x){Aa.a.J(512500122,822,10,"Exception in HandleToggleTranscriptionSubtitleLanguage: {0}.",x)}return 32}ZDe(a,b,c,f,l){try{l&&(l[ai.a.On]=l.MenuItemId.toLowerCase()===this.Fc.bya.toLowerCase())}catch(x){Aa.a.J(512500121,822,10,"Exception in QueryToggleTranscriptionSubtitleLanguage: {0}.",
x)}return 32}$rj(a,b,c,f,l){try{if(l){this.Fc.yna=l.MenuItemId;const x=l.SourceControlId;this.ase!==x&&(a={},a[x]="ToggleButtonModel",a[this.ase]="ToggleButtonModel",Cb.App.Hb.VF(a),this.ase=x)}}catch(x){Aa.a.J(512500120,822,10,"Exception in HandleToggleTranscriptionSpokenLanguage: {0}.",x)}return 32}YDe(a,b,c,f,l){try{l&&(l[ai.a.On]=l.MenuItemId.toLowerCase()===this.Fc.yna.toLowerCase())}catch(x){Aa.a.J(512500119,822,10,"Exception in QueryToggleTranscriptionSpokenLanguage: {0}.",x)}return 32}nmd(a,
b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return Aa.a.J(512500118,822,10,"SubtitleActor::ToggleSubtitlesBottomOverlay requires actionData"),8;l[ai.a.On]&&(this.Fc.Fv="BottomOverlay",Aa.a.J(512500117,822,50,"SubtitleActor::ToggleSubtitlesBottomOverlay: Bottom overlay is enabled"));this.$nd(l.SourceControlId);return 32}omd(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return Aa.a.J(512500116,822,10,"SubtitleActor::ToggleSubtitlesTopOverlay requires actionData"),8;l[ai.a.On]&&
(this.Fc.Fv="TopOverlay",Aa.a.J(512500115,822,50,"SubtitleActor::ToggleSubtitlesTopOverlay: Top overlay is enabled"));this.$nd(l.SourceControlId);return 32}mmd(a,b,c,f,l){if(1===c)return 32;if(!l||"object"!==typeof l)return Aa.a.J(512500114,822,10,"SubtitleActor::ToggleSubtitlesBelowSlide requires actionData"),8;l[ai.a.On]&&(this.Fc.Fv="BelowSlide",Aa.a.J(512500113,822,50,"SubtitleActor::ToggleSubtitlesBelowSlide: Below Slide is enabled"));this.$nd(l.SourceControlId);return 32}lmd(a,b,c,f,l){if(1===
c)return 32;if(!l||"object"!==typeof l)return Aa.a.J(512500112,822,10,"SubtitleActor::ToggleSubtitlesAboveSlide requires actionData"),8;l[ai.a.On]&&(this.Fc.Fv="AboveSlide",Aa.a.J(512500111,822,50,"SubtitleActor::ToggleSubtitlesAboveSlide: Above Slide is enabled"));this.$nd(l.SourceControlId);return 32}k7g(a,b){a.MenuItems=Object.assign(new wj.a,{Id:b?"SpokenLanguageList":"SubtitleLanguageList",MenuSectionList:[],UpdateDynamically:!0});b?((b=this.Fc.AQe)&&0<b.count&&(b=Xx.zVf(b,"productionSpokenLanguages",
""),Array.add(a.MenuItems.MenuSectionList,b)),(b=this.Fc.zQe)&&0<b.count&&(b=Xx.zVf(b,"previewSpokenLanguages",ResourceStrings.L_SubtitlesPreviewSpokenLanguageSectionTitle),Array.add(a.MenuItems.MenuSectionList,b))):(b=this.Fc.cJb)&&0<ta.a.count(b)&&(b=Xx.rDi(this.Fc.nPe),Array.add(a.MenuItems.MenuSectionList,b));a.PopulationXML=lj.l(a.MenuItems)}$nd(a){if(this.$re!==a){const b={};b[a]="ToggleButtonModel";b[this.$re]="ToggleButtonModel";Cb.App.Hb.VF(b);this.$re=a;this.Lc.mz(new Wp.a(1))}}static zVf(a,
b,c){c=Object.assign(new Mi.a,{DisplayMode:"Menu",Title:c,Id:b,ControlsId:"ctr"+b,ControlList:[]});for(let f of a)try{const l=f.toLowerCase(),x=Object.assign(new Uy.a,{Id:b+"_"+l,ExternalId:b+"_"+l,LabelText:sa.a.oe(f).displayName,Command:"892576938",MenuItemId:l,QueryCommand:"1887433262",Visible:!0,AriaLabel:Jc.a.Qob});Array.add(c.ControlList,x)}catch(l){Aa.a.J(512500110,822,10,"SubtitleActor::CreateSpokenLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",f,l)}return c}static rDi(a){const b=
Object.assign(new Mi.a,{DisplayMode:"Menu",Title:"",Id:"productionSubtitleLanguages",ControlsId:"ctrproductionSubtitleLanguages",ControlList:[]});for(let c of a)try{const f=Object.assign(new Uy.a,{Id:"productionSubtitleLanguages_"+c,ExternalId:"productionSubtitleLanguages_"+c,LabelText:sa.a.oe(c).displayName,Command:"2717950896",MenuItemId:c,QueryCommand:"4282741576",Visible:!0,AriaLabel:Jc.a.Qob});Array.add(b.ControlList,f)}catch(f){Aa.a.J(512500109,822,10,"SubtitleActor::CreateSubtitleLanaguageMenuSection Exception when trying to show language: {0}, e: {1}.",
c,f)}return b}}Object(e.a)(Xx,"SubtitleActor",null,[229]);var TQ=d(395);class go{constructor(a){this.Cx=this.Hs=this.Ou=this.NJ=this.NH=null;this.XY=a}get XUb(){return this.NJ||(this.NJ=fb.a.instance.qb("Box4.IAutoCorrectRules"))}get fba(){return this.Ou||(this.Ou=fb.a.instance.qb("Box4.IAutoCorrectScheduler"))}get iJ(){return this.NH||(this.NH=fb.a.instance.qb("Box4.Pages.IPageContentEditor"))}get hB(){return this.Cx||(this.Cx=fb.a.instance.qb("Box4.IOutlineEditor"))}get yn(){return this.Hs||(this.Hs=
this.XY())}uxb(a,b,c){if(this.hB&&go.ih){var f=Df.ContextSetEditor.O0d(b);a=f.node;cb.SelectionEditor.Ll(f)&&(f=Mc.a.ak(a,yb.ParagraphReader.textLength(a)));var l=vb.a.language(vb.a.Ls(f));f=nb.GraphIterator.mb(c.vg);go.Ql.GIa(f);var x=a=null;if(f)for(let G=f.Ab(1);G&&!x;G=f.zj(1))bj.OutlineReader.qW(G)&&(x=G);if(f&&!x){if(!this.iJ||!this.hB)return;a=new Id.GraphTransaction(7);a.iy(f);x=this.iJ.GXb(f);this.hB.Lhd(x,c.i2b());this.hB.eZ(f,!0);l&&(Xb.OutlineElementNavigator.ri(f),f=Mc.a.ak(f.currentNode,
0),go.ih.zYa(vb.a.Ls(f),l))}l=rd.SelectionFactory.rj(x,!0);c.Gb.setSelection(l);cb.SelectionEditor.Pg(b)&&(c=nb.GraphIterator.mb(b.node),c.Mu(),Vh.OutlineNavigator.Jfd(c),this.XUb&&this.fba&&bj.OutlineReader.eC(c,b,!0)&&(b=this.XUb.EXd(b,-1,!1,w.a.Iq))&&this.fba.Akh(b));this.yn&&this.yn.Yv();a&&a.dispose()}}RVd(a,b,c){a=nb.GraphIterator.mb(c.vg);a=TQ.a(a);a=rd.SelectionFactory.rj(a,!1);c.Gb.setSelection(a)}static get ih(){return go.Hf||(go.Hf=fb.a.instance.qb("Box4.IFormattingEditor"))}static get instance(){return go.Ja||
(go.Ja=go.WB())}static WB(){return new go(()=>fb.a.instance.qb("Box4.IUndoManager"))}static get Ql(){return xy.PageNavigator.instance}}go.Ja=null;go.Hf=null;Object(e.a)(go,"TitleViewEditor",null,[]);class ru{constructor(a,b,c,f=null,l=null,x,G,R=null,fa=null){this.Hs=null;this.XAf=!1;this.XY=a;this.YEd=b;this.xm=c;this.NJ=f;this.Ou=l;this.Yc=R;this.rk=fa}get yn(){return this.Hs||(this.Hs=this.XY())}ub(){const a=u.AFrameworkApplication.Ta,b=Object(C.a)(this,this.kll,"tabView");a.pa(E.a.tab,Bb.a.view,
b,1124);a.pa(E.a.Llc,Bb.a.view,b,1124);a.ya(E.a.$og,Bb.a.view,Kd.ActionManager.Hg)}kll(a,b,c,f,l){if(1===c)return 32;const x=a===E.a.Llc;if(!b.view.Lh)return 2;const G=b.view,R=G.Gb;var fa=R.Kj;if(!fa||H.a.instance.ga(14)&&ru.Yi.N4a(fa))return 2;if(this.xm&&this.xm.instance&&this.xm.instance.lW(fa))return 4;var wa=null,Wa=Kd.ActionManager.J4,mb=!1,Kb=cb.SelectionEditor.Pg(fa);if(fa.Rw){if(R.Oa.MG&&(Wa=fa.getContext(0),wa=new nb.GraphIterator,wa.set(Wa.node),wa.Mu(),Wa=x?E.a.BJe:E.a.Igd),Wa=this.YEd.BCk(Wa,
x?E.a.lz:E.a.rD),Wa===Kd.ActionManager.J4){var nc=ru.Yl.Y1(fa,16);if(nc)x&&(Wa=E.a.J7c),wa=new nb.GraphIterator,wa.set(nc.node),wa.af();else{if(H.a.instance.ga(77))return 2;if(ru.BGj(fa)){if(x)return 2;Wa=E.a.uxb}else Wa=x?E.a.lz:E.a.rD}}}else if(fa.Qk)wa=new nb.GraphIterator,wa.set(fa.node),cb.SelectionEditor.kt(wa),bj.OutlineReader.Jja(fa)?Wa=x?E.a.BJe:E.a.Igd:(Wa=x?this.YEd.olj(wa,fa,Wa):this.YEd.nlj(wa,fa,Wa),ae.OutlineElementReader.Ug(wa)&&fa.contextId===Bb.a.Of&&(mb=ae.OutlineElementReader.eC(wa,
fa,!1)),(nc=Ib.ListReader.kk(wa)&&mb)&&Z.ULS.sendTraceTag(509659340,383,50,"Tab pressed at starting of list item IsLevelIncreased:{0}",Wa===E.a.rD),Wa!==Kd.ActionManager.J4||Se.isTableCellOrInside(wa)||nc||(this.XAf||(Z.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this.XAf=!0),u.AFrameworkApplication.Ta.processAction(E.a.$og,2),u.AFrameworkApplication.DN("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),this.Yc&&this.Yc.isFeatureEnabled(84)&&
this.Yc.isFeatureEnabled(83)));else return 2;if(!x&&Wa===Kd.ActionManager.J4&&Se.isTableCellOrInside(wa))if(Qd.returnToCell(wa),Se.isLastCellInTable(wa)||Jd.TableReader.Zvb(wa)&&Se.isLastCellInTableIgnoringGhostCells(wa)){if(Wa=this.fHd(wa,fa),!Wa)return 2}else Wa=E.a.zWg;if(Wa===Kd.ActionManager.J4)return 2;switch(Wa){case E.a.uxb:go.instance.uxb(a,fa,b.view);fa=32;break;case E.a.RVd:go.instance.RVd(a,fa,b.view);fa=32;break;case E.a.zWg:case E.a.J7c:mb=Wa===E.a.J7c;Kb&&this.NJ&&this.Ou&&(Kb=this.NJ.EXd(fa,
-1,!0,w.a.Iq))&&this.Ou.Akh(Kb);fa=32;Qd.returnToCell(wa);Qd.moveToNextOrPreviousCell(wa,mb)&&(Kb=!0,mb=!1,bj.OutlineReader.IQc(wa)||(Vh.OutlineNavigator.Yue(wa,!1),Xb.OutlineElementNavigator.ri(wa),yb.ParagraphReader.Xr(wa.currentNode)&&(Kb=!1,yb.ParagraphReader.textLength(wa.currentNode)||(mb=!0)),mb||Qd.returnToCell(wa)),mb?wa=rd.SelectionFactory.Mg(wa.currentNode,0):(wa=rd.SelectionFactory.gl(wa.currentNode),!Kb&&cb.SelectionEditor.Ll(wa.Ve)&&(Kb=wa.toArray(),Array.removeAt(Kb,Kb.length-1),wa=
new Ua.Selection(Kb,wa.rf))),R.setSelection(wa));break;case E.a.BJe:case E.a.Igd:Wa===E.a.Igd?Vh.OutlineNavigator.cWg(wa,!1):Vh.OutlineNavigator.cWg(wa,!0);R.setSelection(rd.SelectionFactory.gl(wa.currentNode));fa=32;break;case E.a.bZa:fa=u.AFrameworkApplication.Ta.ki(b,Wa,c,!0,f,l);1===Cb.App.mode&&Qd.moveToNextOrPreviousCell(wa,!1)&&(Qd.returnToCell(wa),wa=rd.SelectionFactory.rj(wa.currentNode,!0),cb.SelectionEditor.Ll(wa.Ve)&&(Kb=wa.toArray(),Array.removeAt(Kb,Kb.length-1),wa=new Ua.Selection(Kb,
wa.rf)),R.setSelection(wa));break;default:if(fa=u.AFrameworkApplication.Ta.ki(b,Wa,c,!0,f,l),!mb&&Kb&&(Wa===E.a.lz||Wa===E.a.rD)){const oc=cb.SelectionEditor.Hha(R.Oa.kb).y;Cb.App.rMk(()=>{this.$fk(R,G,oc)})}}32===fa&&b.view.Lh&&this.yn.Yv();return fa}$fk(a,b,c){if(a&&b){var f=a.Oa.kb;cb.SelectionEditor.Hha(f).y<c?(b=cb.SelectionEditor.r_b(b,f,!1),b=cb.SelectionEditor.Fra(b,!1,!1,!1,!0)):b=cb.SelectionEditor.PKc(b,f,!1);a.setSelection(b)}}fHd(){return E.a.BDa}QVg(a,b,c){if(a&&b){var f=a.Oa.kb;cb.SelectionEditor.Hha(f).y<
c?(b=cb.SelectionEditor.r_b(b,f,!1),b=cb.SelectionEditor.Fra(b,!1,!1,!1,!0)):b=cb.SelectionEditor.Fra(f,!1,!1,!1,!0);a.setSelection(b)}}static get Yi(){return ed.a.instance}static get Yl(){return Df.ContextSetEditor.instance}static BGj(a){a=ru.Yl.Y1(a,10);return!!a&&Tf.a(a)}}Object(e.a)(ru,"TabActor",null,[]);class uN extends ru{constructor(a,b,c,f){super(a,b,c);this.la=f}fHd(a,b){return this.la.Zwb?super.fHd(a,b):0}}Object(e.a)(uN,"Box4TabActor",ru,[]);class vN{constructor(a,b,c,f){this.rak=new uN(a,
b,c,f)}ub(){this.rak.ub()}xe(){}}Object(e.a)(vN,"TabActor",null,[229]);class wN{constructor(a,b,c){this.jKg=b;this.ra=a;this.YEa=c}BCk(a,b){const c=this.ra.Kj;return c&&this.YEa.Y1(c,16)?a:this.$Me(b)?b:F.a.Ae}olj(a,b,c){(c=Object(ua.a)(5,b.node))&&c.hs()?c=E.a.J7c:(Xb.OutlineElementNavigator.Ke(a),c=(cb.SelectionEditor.Vj(b)||cb.SelectionEditor.Pg(b)&&ae.OutlineElementReader.eC(a,b,!1))&&this.jKg.Mpb(a)&&this.$Me(E.a.lz)?E.a.lz:F.a.Ae,Aa.a.J(8955994,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanPromote actionToTake={0}",
c===E.a.lz?"Promote":"DoNothing"));return c}nlj(a,b,c){const f=Object(ua.a)(5,a.pq);if(f&&f.hs())return c;Xb.OutlineElementNavigator.Ke(a);c=(cb.SelectionEditor.Vj(b)||cb.SelectionEditor.Pg(b)&&ae.OutlineElementReader.eC(a,b,!1))&&this.jKg.UDc(a)&&this.$Me(E.a.rD)?E.a.rD:F.a.Ae;Aa.a.J(8955996,820,50,"TabActorPromoteDemoteStrategy::GraphNodePlanDemote actionToTake={0}",c===E.a.lz?"Demote":"DoNothing");return c}$Me(a){var b=this.ra.Oa.kb;let c=!1;if(b)for(let f of b)if(f&&f.node)if(yb.ParagraphReader.mW(f.node)){if(b=
f.node.sa(Mb.a.listLevel,0),a===E.a.rD&&b>=Zo.a.Z6-1||a===E.a.lz&&!b||this.ra.aL()&&Zo.a.Fvg(f.node)){c=!0;break}}else{c=!0;break}return!c}}Object(e.a)(wN,"TabActorPromoteDemoteStrategy",null,[1362]);var xN=d(387),UQ=d(841),yN=d(940);class Uv extends Lh.a{constructor(a,b,c,f,l,x,G,R,fa){super(void 0,void 0,!0);this.Sta=null;this.c2j=b;this.sNg=f;this.qNg=l;this.nNg=x;this.iNg=G;this.NGg=R;this.MGg=fa;this.pva=a;this.D$a=c}ujd(){this.ng=this.c2j;const a={};a.bodyControls=this.OZd();this.tj(this.pva,
Object(C.a)(this,this.FTd,"dialogResultHandler"),a)}FTd(a,b){1===a&&this.D$a(parseInt(this.dRa(b)),parseInt(this.C1i(b)));this.dispose()}OZd(){this.Sta=Uv.G_d();const a={};this.lui(a);this.pti(a);return a}lui(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.sNg,this.nNg),c=[yN.a("None",0,this.sNg,this.nNg,1)];a.rowsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogRowSpinner",["label"]:ResourceStrings.l_InsertTableDialogRowLabelText,["customTooltip"]:b,
["unitType"]:"None",["value"]:this.NGg,["validUnits"]:c,["numberFormatInfo"]:this.Sta,["validReservedValues"]:[""]}}pti(a){const b=String.format(ResourceStrings.l_InsertTableMouseHoverMessage,this.qNg,this.iNg),c=[yN.a("None",0,this.qNg,this.iNg,1)];a.columnsSpinButtonProps={["type"]:"AppSpinButtonProps",["id"]:"TableSizeDialogColumnSpinner",["label"]:ResourceStrings.l_InsertTableDialogColumnLabelText,["customTooltip"]:b,["unitType"]:"None",["value"]:this.MGg,["validUnits"]:c,["numberFormatInfo"]:this.Sta,
["validReservedValues"]:[""]}}dRa(a){return a.rows&&""!==a.rows.toString()?a.rows.toString():this.NGg.toString()}C1i(a){return a.columns&&""!==a.columns.toString()?a.columns.toString():this.MGg.toString()}static G_d(){return{["negativeSign"]:"-",["numberDecimalDigits"]:0,["numberDecimalSeparator"]:".",["numberNegativePattern"]:1,["numberGroupSeparator"]:",",["numberGroupSizes"]:[3]}}}Object(e.a)(Uv,"AReactTableSizeDialog",Lh.a,[]);class zN extends Uv{constructor(a){super(ResourceStrings.L_InsertTableDialogTitleText,
"InsertTableDialog",a,1,1,35,35,2,5)}}Object(e.a)(zN,"ReactInsertTableDialog",Uv,[]);class AN extends Uv{constructor(a,b,c){super(ResourceStrings.L_SplitTableCells,"SplitTableCellsDialog",a,1,1,b,c,1,Math.min(2,c))}}Object(e.a)(AN,"ReactSplitTableCellsDialog",Uv,[]);var Vv=d(610),BN=d(935);class su{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg){this.HTa={};this.gac=!1;this.l3c=null;this.Dz=[0,.25,.5,.75,1,1.5,2.25,3,4.5,6];this.pF=new va.ScriptSharpLegacyMap;
this.Zb=nc;this.ua=oc;this.Nb=b;this.ia=a;this.Af=c;this.ra=Ic;this.Fa=f;this.Wz=l;this.Ea=x;this.vs=Wa;this.Dm=wa;this.Ha=mb;this.Fb=Kb;this.$I=fa;this.OVa=R;this.tc=G;this.ol=Kc;this.LBb=Hc;this.cSg=ie;this.gda=He;this.Mb=fe;this.FEa=Te;this.Yx=We;this.pX=Qf;this.gLg=mg;this.eH=1;this.jx=uf.Box4ColorHelper.sY({Color:"##T,1,0,0"});this.ZD=Xg;this.bA=Mg}ub(){this.HTa["465284484"]=0;this.HTa["212166888"]=1;this.HTa["530759702"]=2;this.HTa["1915511548"]=0;this.HTa["2003354004"]=1;this.HTa["2257534378"]=
2;Dc.I2d=Object(C.a)(this,this.H2d,"getRowOrColumnsForDelete");Dc.w2d=Object(C.a)(this,this.Acj,"getRefRowWhenInsertRow");Dc.t2d=Object(C.a)(this,this.ucj,"getRefCellWhenInsertColumn");Dc.u2d=Object(C.a)(this,this.wcj,"getRefColumnFromRefCell");Dc.v2d=Object(C.a)(this,this.ycj,"getRefColumnsWhenSelectColumn");Dc.x2d=Object(C.a)(this,this.Ccj,"getRefRowsWhenSelectRow");Dc.K4d=Object(C.a)(this,this.flj,"gotoFocusCellAfterInsertColumn");Dc.Etb=Object(C.a)(this,this.idg,"getNewOutlineElementInfoFromCell");
Dc.Ewb=a=>this.Ha.nv||!Jd.TableReader.Zvb(a);this.ia.pa(ba.a.zEb,sc.a.application,Object(C.a)(this,this.hnj,"handleDeleteTable"),4);this.ia.pa(ba.a.vbd,Bb.a.view,Object(C.a)(this,this.jnj,"handleDeleteTableRow"),4);this.ia.pa(ba.a.eBe,Bb.a.view,Object(C.a)(this,this.inj,"handleDeleteTableColumn"),4);this.ia.pa(ba.a.kBe,sc.a.application,Object(C.a)(this,this.jrj,"handleSelectTable"),4);this.ia.pa(ba.a.wbd,sc.a.application,Object(C.a)(this,this.voj,"handleInsertTable"),4);this.ia.pa(ba.a.hBe,sc.a.application,
Object(C.a)(this,this.woj,"handleInsertTableDialog"),4);this.ia.pa(ba.a.H7g,sc.a.application,Object(C.a)(this,this.xoj,"handleInsertTableFromRibbon"),4);this.ia.pa(ba.a.iAk,sc.a.application,xr.a.GG,4);this.ia.pa(ba.a.jAk,sc.a.application,xr.a.GG,4);this.ia.pa(ba.a.oFk,sc.a.application,xr.a.m0,96);this.ia.pa(ba.a.pFk,sc.a.application,xr.a.m0,96);this.ia.pa(ba.a.S$g,Bb.a.view,Object(C.a)(this,this.QDe,"queryTableCellAnchoring"),96);this.ia.pa(ba.a.R$g,Bb.a.view,Object(C.a)(this,this.QDe,"queryTableCellAnchoring"),
96);this.ia.pa(ba.a.Q$g,Bb.a.view,Object(C.a)(this,this.QDe,"queryTableCellAnchoring"),96);this.ia.ya(ba.a.ahc,Bb.a.view,Dc.Gia);this.ia.ya(ba.a.$gc,Bb.a.view,Dc.Gia);this.ia.ya(ba.a.Zgc,Bb.a.view,Dc.Gia);this.ia.ya(ba.a.ahc,Bb.a.tableCell,Object(C.a)(this,this.F5d,"handleTableCellAnchoring"));this.ia.ya(ba.a.$gc,Bb.a.tableCell,Object(C.a)(this,this.F5d,"handleTableCellAnchoring"));this.ia.ya(ba.a.Zgc,Bb.a.tableCell,Object(C.a)(this,this.F5d,"handleTableCellAnchoring"));this.ia.he(ba.a.ahc,4);this.ia.he(ba.a.$gc,
4);this.ia.he(ba.a.Zgc,4);this.ia.ya(ba.a.D7g,Bb.a.view,Object(C.a)(this,this.umj,"handleCellShadingMenuOpen"));this.ia.pa(ba.a.eAk,Bb.a.view,Object(C.a)(this,this.Gpj,"handlePopulateCellShadingColor"),96);this.ia.ya(ba.a.mwa,Bb.a.view,Dc.Gia);this.ia.ya(ba.a.mwa,Bb.a.tableCell,Object(C.a)(this,this.smj,"handleCellShadingColor"));this.ia.ya(ba.a.dAk,Bb.a.view,Object(C.a)(this,this.Moj,"handleMoreCellShadingColor"));this.ia.ya(ba.a.cBe,Bb.a.view,Dc.Gia);this.ia.ya(ba.a.cBe,Bb.a.tableCell,Object(C.a)(this,
this.tmj,"handleCellShadingCustomColor"));this.ia.ya(ba.a.gXa,Bb.a.view,Dc.Gia);this.ia.ya(ba.a.gXa,Bb.a.tableCell,Object(C.a)(this,this.Jqj,"handleRemoveCellShading"));this.ia.he(ba.a.mwa,4);this.ia.he(ba.a.gXa,4);this.ia.pa(ba.a.ycd,Bb.a.application,Object(C.a)(this,this.ycd,"queryLockAspectRatio"),96);this.ia.pa(ba.a.Ihd,Bb.a.application,Object(C.a)(this,this.Ihd,"setLockAspectRatio"),4);this.ia.pa(ba.a.Gic,Bb.a.view,Object(C.a)(this,this.Gic,"queryTableRowHeight"),96);this.ia.pa(ba.a.Fic,Bb.a.view,
Object(C.a)(this,this.Fic,"queryTableColumnWidth"),96);this.ia.pa(ba.a.Ygb,Bb.a.view,Object(C.a)(this,this.Ygb,"setTableRowHeight"),4);this.ia.pa(ba.a.IYa,Bb.a.view,Object(C.a)(this,this.IYa,"setTableColumnWidth"),4);this.ia.pa(ba.a.Zjd,Bb.a.view,Object(C.a)(this,this.Ygb,"setTableRowHeight"),4);this.ia.pa(ba.a.Yjd,Bb.a.view,Object(C.a)(this,this.IYa,"setTableColumnWidth"),4);this.ia.pa(ba.a.Whh,sc.a.application,Object(C.a)(this,this.Uqj,"handleResizeFallbackTable"),4);this.ia.pa(ba.a.rdd,Bb.a.view,
Object(C.a)(this,this.Dah,"queryTableSize"),96);this.ia.pa(ba.a.VDe,Bb.a.view,Object(C.a)(this,this.Dah,"queryTableSize"),96);this.ia.pa(ba.a.dxa,Bb.a.view,Object(C.a)(this,this.Loh,"setTableSize"),4);this.ia.pa(ba.a.JYa,Bb.a.view,Object(C.a)(this,this.Loh,"setTableSize"),4);this.ia.pa(ba.a.mergeTableCells,Bb.a.view,Object(C.a)(this,this.Koj,"handleMergeTableCells"),4);this.ia.pa(ba.a.splitTableCells,Bb.a.view,Object(C.a)(this,this.Irj,"handleSplitTableCells"),4);this.ia.pa(ba.a.NJi,Bb.a.view,Object(C.a)(this,
this.ujg,"handleDistributeRows"),4);this.ia.pa(ba.a.MJi,Bb.a.view,Object(C.a)(this,this.lnj,"handleDistributeColumns"),4);this.ia.pa(ba.a.Yll,Bb.a.view,Object(C.a)(this,this.ujg,"handleDistributeRows"),4);this.ia.pa(ba.a.lyk,Bb.a.view,Object(C.a)(this,this.Fpj,"handlePopulateCellBorderColorMenu"),96);this.ia.pa(ba.a.Dzk,Bb.a.view,Object(C.a)(this,this.rmj,"handleCellBorderRecentColor"),96);this.ia.pa(ba.a.Lfk,Bb.a.view,Object(C.a)(this,this.Loj,"handleMoreCellBorderColors"),96);this.ia.pa(ba.a.Gll,
Bb.a.view,Object(C.a)(this,this.Trj,"handleTableBorderWidthAnchor"),4);this.ia.pa(ba.a.Hll,Bb.a.view,Object(C.a)(this,this.lrj,"handleSelectTableBorderWidth"),4);this.ia.pa(ba.a.nll,Bb.a.view,Object(C.a)(this,this.Rrj,"handleTableBorderColorAnchor"),4);this.ia.pa(ba.a.Wkd,Bb.a.view,Object(C.a)(this,this.krj,"handleSelectTableBorderColor"),4);this.ia.pa(ba.a.Ell,Bb.a.view,Object(C.a)(this,this.Srj,"handleTableBorderTypeAnchor"),4);this.ia.pa(ba.a.Fll,Bb.a.view,Object(C.a)(this,this.xQc,"handleSelectTableBorderType"),
4);this.ia.pa(ba.a.yll,Bb.a.view,Object(C.a)(this,this.grj,"handleSelectInsideTableBorderType"),4);this.ia.pa(ba.a.xll,Bb.a.view,Object(C.a)(this,this.ykg,"handleSelectInsideHorizontalTableBorderType"),4);this.ia.pa(ba.a.Dll,Bb.a.view,Object(C.a)(this,this.zkg,"handleSelectInsideVerticalTableBorderType"),4);this.ia.pa(ba.a.uah,Bb.a.view,Object(C.a)(this,this.wqj,"handleQueryTableBorderWidth_1"),96);this.ia.pa(ba.a.vah,Bb.a.view,Object(C.a)(this,this.xqj,"handleQueryTableBorderWidth_2"),96);this.ia.pa(ba.a.wah,
Bb.a.view,Object(C.a)(this,this.yqj,"handleQueryTableBorderWidth_3"),96);this.ia.pa(ba.a.xah,Bb.a.view,Object(C.a)(this,this.zqj,"handleQueryTableBorderWidth_4"),96);this.ia.pa(ba.a.yah,Bb.a.view,Object(C.a)(this,this.Aqj,"handleQueryTableBorderWidth_5"),96);this.ia.pa(ba.a.zah,Bb.a.view,Object(C.a)(this,this.Bqj,"handleQueryTableBorderWidth_6"),96);this.ia.pa(ba.a.Aah,Bb.a.view,Object(C.a)(this,this.Cqj,"handleQueryTableBorderWidth_7"),96);this.ia.pa(ba.a.Bah,Bb.a.view,Object(C.a)(this,this.Dqj,
"handleQueryTableBorderWidth_8"),96);this.ia.pa(ba.a.Cah,Bb.a.view,Object(C.a)(this,this.Eqj,"handleQueryTableBorderWidth_9"),96);this.ia.pa(ba.a.pah,Bb.a.view,Object(C.a)(this,this.rqj,"handleQueryTableBorderType_LeftBorder"),96);this.ia.pa(ba.a.sah,Bb.a.view,Object(C.a)(this,this.uqj,"handleQueryTableBorderType_RightBorder"),96);this.ia.pa(ba.a.tah,Bb.a.view,Object(C.a)(this,this.vqj,"handleQueryTableBorderType_TopBorder"),96);this.ia.pa(ba.a.jah,Bb.a.view,Object(C.a)(this,this.lqj,"handleQueryTableBorderType_BottomBorder"),
96);this.ia.pa(ba.a.lah,Bb.a.view,Object(C.a)(this,this.nqj,"handleQueryTableBorderType_DiagonalUpBorder"),96);this.ia.pa(ba.a.kah,Bb.a.view,Object(C.a)(this,this.mqj,"handleQueryTableBorderType_DiagonalDownBorder"),96);this.ia.pa(ba.a.nah,Bb.a.view,Object(C.a)(this,this.pqj,"handleQueryTableBorderType_InsideHorizontalBorder"),96);this.ia.pa(ba.a.oah,Bb.a.view,Object(C.a)(this,this.qqj,"handleQueryTableBorderType_InsideVerticalBorder"),96);this.ia.pa(ba.a.mah,Bb.a.view,Object(C.a)(this,this.oqj,"handleQueryTableBorderType_InsideBorder"),
96);this.ia.pa(ba.a.rah,Bb.a.view,Object(C.a)(this,this.tqj,"handleQueryTableBorderType_OutsideBorder"),96);this.ia.pa(ba.a.iah,Bb.a.view,Object(C.a)(this,this.kqj,"handleQueryTableBorderType_AllBorder"),96);this.ia.pa(ba.a.qah,Bb.a.view,Object(C.a)(this,this.sqj,"handleQueryTableBorderType_NoBorder"),96)}xe(){}iqa(a){return a.Ap()?re.a("TableBordersComplexTableFixEnabled"):!0}m5(){var a=!1;this.ua.Ba&&(a=this.ra.rq(),a=!!a&&a.qd);return a}umj(){return this.m5()?32:8}Gpj(a,b,c,f,l){if(!this.m5())return 16;
if(1===c)return 32;if(!l)return 8;a=this.ua.Ba;if(!a)throw Error.argumentNull("ActiveSlide is null");c=this.Zb.yf.j2;b=Object.assign(new wj.a,{Id:"PptRibbon.TableDesign.Shading",MenuSectionList:[]});Array.add(b.MenuSectionList,Mk.f(a.Pe,DE.a.themeColors,"Color.Menu.Controls","themeColor","ThemeCellShadingColorPicker","3704601382",1));Array.add(b.MenuSectionList,Mk.d("Standard Colors","Color.Menu.Controls","standardColor","StandardCellShadingColorPicker","3704601382",!1));Array.add(b.MenuSectionList,
Mk.b("Remove Color","Color.Menu.Controls","2292419401",ResourceStrings.L_RemoveShapeFill,"Color.Menu.RemoveColor","ShapeNoFill","per_AppointmentColor0_16x16x32",CommonUIStrings.l_RemoveShapeFillKeytip));c&&0<c.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",!1)),Array.add(b.MenuSectionList,Mk.c(c,"Recent Colors","Color.Menu.Controls","recentColor","CellShadingRecentColors","4078162917",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellShadingRecentColors",
!0));re.a("ColorPickerHighlighterFix")&&(c=this.bA.H9f(this.ra.Ey()),Mk.h(b,c,a.Pe));l.MenuItems=b;return 32}Moj(a,b,c,f,l){if(!this.m5())return Aa.a.J(512500107,822,10,"HandleMoreCellShadingColor: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.La(ba.a.renderColorPicker,1,l);a=this.Sdj();b={};b.currentColor=a;b.handleCommand=ba.a.cBe;return this.ia.La(ba.a.renderColorPicker,2,b)}tmj(a,b,c,f,l){if(1===c)return this.ia.La(ba.a.mwa,c,l);if(!l)return Aa.a.J(512500106,822,10,
"HandleCellShadingCustomColor: actionData is null"),16;a=this.ia.La(ba.a.mwa,c,l);32===a&&this.ia.La(ba.a.tAa,c,l);return a}smj(a,b,c,f,l){if(!this.m5())return 16;if(1===c)return 32;if(!l)return 8;b=b.node;l=uf.Box4ColorHelper.sY(l);if(!l)return 8;c=this.Fb.ke(15);c.kc(b);c.fd=a;a=b.cellShading;Kx(a);a.solidFillField=l;b.cellShading=a;c.dispose();Aa.a.J(573437397,822,15,String.format("HandleCellShadingColor: EntryPoint:{0} ",xN.a[this.ia.oq]));return 32}Jqj(a,b,c){if(!this.m5())return 16;if(1===c)return 32;
b=b.node;c=this.Fb.ke(15);c.kc(b);c.fd=a;a=Kj.a.xi(b,sb.a.cellShading,new UQ.a);Kx(a);a.noFillField=new Vx;b.cellShading=a;c.dispose();return 32}Trj(){const a=this.ra.Yo();return a&&this.m5()&&this.Ha.MEb&&this.iqa(a)?32:8}lrj(a,b,c,f,l){a=this.ra.Yo();if(!(a&&this.m5()&&this.iqa(a)&&this.Ha.MEb))return 16;if(1===c)return 32;if(!l)return 8;switch(l.SourceControlId){case "TableBorderWidth_1":this.eH=this.Dz[1];break;case "TableBorderWidth_2":this.eH=this.Dz[2];break;case "TableBorderWidth_3":this.eH=
this.Dz[3];break;case "TableBorderWidth_4":this.eH=this.Dz[4];break;case "TableBorderWidth_5":this.eH=this.Dz[5];break;case "TableBorderWidth_6":this.eH=this.Dz[6];break;case "TableBorderWidth_7":this.eH=this.Dz[7];break;case "TableBorderWidth_8":this.eH=this.Dz[8];break;case "TableBorderWidth_9":this.eH=this.Dz[9]}this.ZD.JF();return 32}cIa(a,b){return(a=Object(ua.a)(Nh.a,a))?(this.eH===b?a.Nf(!0):a.Nf(!1),32):8}wqj(a,b,c,f,l){return this.cIa(l,this.Dz[1])}xqj(a,b,c,f,l){return this.cIa(l,this.Dz[2])}yqj(a,
b,c,f,l){return this.cIa(l,this.Dz[3])}zqj(a,b,c,f,l){return this.cIa(l,this.Dz[4])}Aqj(a,b,c,f,l){return this.cIa(l,this.Dz[5])}Bqj(a,b,c,f,l){return this.cIa(l,this.Dz[6])}Cqj(a,b,c,f,l){return this.cIa(l,this.Dz[7])}Dqj(a,b,c,f,l){return this.cIa(l,this.Dz[8])}Eqj(a,b,c,f,l){return this.cIa(l,this.Dz[9])}Rrj(){const a=this.ra.Yo();return a&&this.m5()&&this.Ha.Geb&&this.iqa(a)?32:8}krj(a,b,c,f,l){a=this.ra.Yo();if(!(a&&this.m5()&&this.iqa(a)&&this.Ha.Geb))return 16;if(1===c)return 32;if(!l)return 8;
this.jx=uf.Box4ColorHelper.sY(l);this.ZD.JF();return 32}Fpj(a,b,c,f,l){a=this.ra.Yo();if(!(a&&this.m5()&&this.iqa(a)))return 16;if(1===c)return 32;if(!l)return 8;c=this.ua.Ba;if(!c)throw Error.argumentNull("ActiveSlide is null");a=this.Zb.yf.j2;b=Object.assign(new wj.a,{Id:"PptRibbon.TableDesign.CellBorderColors",MenuSectionList:[]});Array.add(b.MenuSectionList,Mk.f(c.Pe,"Theme Colors","Color.Menu.Controls","themeColor","CellBorderColorPicker","71763897",1));Array.add(b.MenuSectionList,Mk.d("Standard Colors",
"Color.Menu.Controls","standardColor","StandardCellBorderColorPicker","71763897",!1));a&&0<a.length?(appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!1)),Array.add(b.MenuSectionList,Mk.c(a,"Recent Colors","Color.Menu.Controls","recentColor","CellBorderRecentColors","1124206375",!1))):appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("CellBorderRecentColors",!0));l.MenuItems=b;return 32}rmj(a,b,c,f,l){if(1===c)return this.ia.La(ba.a.Wkd,c,
l);if(!l)return Aa.a.J(512500100,822,10,"HandleCellBorderRecentColor: actionData is null"),16;a=this.ia.La(ba.a.Wkd,c,l);32===a&&this.ia.La(ba.a.tAa,c,l);return a}Loj(a,b,c,f,l){a=this.ra.Yo();if(!(a&&this.m5()&&this.Ha.Geb&&this.iqa(a)))return Aa.a.J(512500099,822,10,"HandleMoreCellBorderColors: ShouldExecuteTableEditAction returned false"),16;if(1===c)return this.ia.La(ba.a.renderColorPicker,1,l);c=null;b.Qk&&(b=b.node)&&b.cellShading&&b.cellShading.solidFillField&&(c=uf.Box4ColorHelper.Mra(b.cellShading.solidFillField));
b={};b.currentColor=c;b.handleCommand=ba.a.Wkd;return this.ia.La(ba.a.renderColorPicker,2,b)}Srj(){const a=this.ra.Yo();return a&&this.m5()&&this.Ha.j$&&this.iqa(a)?32:8}grj(a,b,c,f,l){if(2===c)return this.xQc(a,b,c,f,l);const x=this.ykg(a,b,c,f,l);a=this.zkg(a,b,c,f,l);return 32===x||32===a?32:8}ykg(a,b,c,f,l){if(2===c)return this.xQc(a,b,c,f,l);c=this.ra.Yo();a=!!c&&this.m5()&&this.Ha.j$&&this.iqa(c);if(!a)return 8;if(this.ra.wu())return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.tc.jF(c));
if(!b||!b.length)return 16;a=!1;c=b[0].rowIndex;for(const x of b)if(c!==x.rowIndex){a=!0;break}return a?32:8}zkg(a,b,c,f,l){if(2===c)return this.xQc(a,b,c,f,l);c=this.ra.Yo();a=!!c&&this.m5()&&this.Ha.j$&&this.iqa(c);if(!a)return 8;if(this.ra.wu())return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.tc.jF(c));if(!b||!b.length)return 16;a=!1;c=b[0].ni;for(const x of b)if(c!==x.ni){a=!0;break}return a?32:8}xQc(a,b,c,f,l){if(this.ra.wu())return 16;const x=this.ra.Yo();if(!x)return 16;if(1===c)return this.iqa(x)?
32:8;if(!l)return Aa.a.J(512500098,822,10,"HandleSelectTableBorderType: actionData is null"),16;let G=this.ra.Ey();if(!G)return 16;G.length||(G=this.gCa(this.tc.jF(x)));if(!G||!G.length)return Aa.a.J(512500097,822,10,"HandleSelectTableBorderType: unable to get valid cellNodes"),16;b=this.eH;let R=we.a.mH(b),fa=this.jx;const wa=l.SourceControlId;if(!wa||!fa)return Aa.a.J(512500096,822,10,String.format("HandleSelectTableBorderType: Invalid Table Border params recorded.")),8;this.pF.Jb(wa)&&this.pF.ga(wa)&&
(R=b=0,fa=nu.a.parse("000000").bKa());return su.FPi(a,wa,b.toString(),this.Jwi(fa),xN.a[this.ia.oq],()=>{const Wa=this.Fb.ke(15);Wa.kc(x);Wa.fd=a;switch(wa){case "TableBordersTopBorder":this.zRa(x,G,R,fa,!1,!1);break;case "TableBordersBottomBorder":this.uRa(x,G,R,fa,!1,!1);break;case "TableBordersLeftBorder":this.xRa(x,G,R,fa,!1,!1);break;case "TableBordersRightBorder":this.yRa(x,G,R,fa,!1,!1);break;case "TableBordersInsideHorizontalBorder":this.vRa(x,G,R,fa,!1,!1,!1);break;case "TableBordersInsideVerticalBorder":this.wRa(x,
G,R,fa,!1,!1,!1);break;case "TableBordersInsideBorders":this.vRa(x,G,R,fa,!1,!1,!1);this.wRa(x,G,R,fa,!1,!1,!1);break;case "TableBordersOutsideBorders":this.zRa(x,G,R,fa,!1,!1);this.uRa(x,G,R,fa,!1,!1);this.xRa(x,G,R,fa,!1,!1);this.yRa(x,G,R,fa,!1,!1);break;case "TableBordersNoBorder":R=0;fa=nu.a.parse("000000").bKa();this.zRa(x,G,R,fa,!1,!0);this.uRa(x,G,R,fa,!1,!0);this.xRa(x,G,R,fa,!1,!0);this.yRa(x,G,R,fa,!1,!0);this.vRa(x,G,R,fa,!1,!1,!1);this.wRa(x,G,R,fa,!1,!1,!1);this.Ha.uBe&&(this.gjg(G,
R,fa),this.fjg(G,R,fa));break;case "TableBordersAllBorders":this.zRa(x,G,R,fa,!1,!1);this.uRa(x,G,R,fa,!1,!1);this.xRa(x,G,R,fa,!1,!1);this.yRa(x,G,R,fa,!1,!1);this.vRa(x,G,R,fa,!1,!1,!1);this.wRa(x,G,R,fa,!1,!1,!1);break;case "TableBordersDiagonalUpBorder":this.gjg(G,R,fa);break;case "TableBordersDiagonalDownBorder":this.fjg(G,R,fa);break;default:Aa.a.J(512500067,822,10,String.format("HandleSelectTableBorderType: Invalid Table borderType : {0} with actionId : {1} ",wa,a))}Wa.dispose();return 32})}gCa(a){const b=
[];for(const c of a)c.isGhostCell||b.push(c);return b}rqj(a,b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.gCa(this.tc.jF(a)));if(!b||!b.length)return Aa.a.J(512500066,822,10,"HandleQueryTableBorderType_LeftBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Nh.a,l);c=we.a.mH(this.eH);return l?(this.xRa(a,b,c,this.jx,!0,!1)?(this.pF.$("TableBordersLeftBorder",!0),l.Nf(!0)):(this.pF.$("TableBordersLeftBorder",!1),l.Nf(!1)),32):8}uqj(a,b,c,f,l){a=this.ra.Yo();
if(!a)return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.gCa(this.tc.jF(a)));if(!b||!b.length)return Aa.a.J(512500065,822,10,"HandleQueryTableBorderType_RightBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Nh.a,l);c=we.a.mH(this.eH);return l?(this.yRa(a,b,c,this.jx,!0,!1)?(this.pF.$("TableBordersRightBorder",!0),l.Nf(!0)):(this.pF.$("TableBordersRightBorder",!1),l.Nf(!1)),32):8}vqj(a,b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.gCa(this.tc.jF(a)));
if(!b||!b.length)return Aa.a.J(512500064,822,10,"HandleQueryTableBorderType_TopBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Nh.a,l);c=we.a.mH(this.eH);return l?(this.zRa(a,b,c,this.jx,!0,!1)?(this.pF.$("TableBordersTopBorder",!0),l.Nf(!0)):(this.pF.$("TableBordersTopBorder",!1),l.Nf(!1)),32):8}lqj(a,b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.gCa(this.tc.jF(a)));if(!b||!b.length)return Aa.a.J(512500063,822,10,"HandleQueryTableBorderType_BottomBorder: unable to get valid cellNodes"),
16;l=Object(ua.a)(Nh.a,l);c=we.a.mH(this.eH);return l?(this.uRa(a,b,c,this.jx,!0,!1)?(this.pF.$("TableBordersBottomBorder",!0),l.Nf(!0)):(this.pF.$("TableBordersBottomBorder",!1),l.Nf(!1)),32):8}pqj(a,b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.tc.jF(a));if(!b||!b.length)return Aa.a.J(512500062,822,10,"HandleQueryTableBorderType_InsideHorizontalBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Nh.a,l);c=we.a.mH(this.eH);return l?(this.vRa(a,b,c,
this.jx,!0,!1,!1)?(this.pF.$("TableBordersInsideHorizontalBorder",!0),l.Nf(!0)):(this.pF.$("TableBordersInsideHorizontalBorder",!1),l.Nf(!1)),32):8}qqj(a,b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.tc.jF(a));if(!b||!b.length)return Aa.a.J(512500061,822,10,"HandleQueryTableBorderType_InsideVerticalBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Nh.a,l);c=we.a.mH(this.eH);return l?(this.wRa(a,b,c,this.jx,!0,!1,!1)?(this.pF.$("TableBordersInsideVerticalBorder",
!0),l.Nf(!0)):(this.pF.$("TableBordersInsideVerticalBorder",!1),l.Nf(!1)),32):8}nqj(a,b,c,f,l){return this.mkg(l,"TableBordersDiagonalUpBorder")}mqj(a,b,c,f,l){return this.mkg(l,"TableBordersDiagonalDownBorder")}mkg(a,b){if(!this.Ha.uBe)return 8;const c=this.ra.Yo();if(!c||!a)return 16;var f=this.ra.Ey();if(!f)return 16;f.length||(f=this.gCa(this.tc.jF(c)));if(!f||!f.length)return Aa.a.J(512500060,822,10,String.format("HandleQueryTableBorderType: unable to get valid cellNodes, borderType : {0} ",
b)),16;a=Object(ua.a)(Nh.a,a);if(null===a)return 8;f=this.fFj(b,f,we.a.mH(this.eH));this.pF.$(b,f);a.Nf(f);return 32}fFj(a,b,c){switch(a){case "TableBordersDiagonalUpBorder":return this.Oug(b,c,this.jx,!1);case "TableBordersDiagonalDownBorder":return this.Nug(b,c,this.jx,!1);default:return Aa.a.J(512500059,822,10,String.format("IsBorderApplied: Invalid Table borderType : {0} ",a)),!1}}oqj(a,b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.tc.jF(a));if(!b||!b.length)return Aa.a.J(512500058,
822,10,"HandleQueryTableBorderType_InsideBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Nh.a,l);c=we.a.mH(this.eH);return l?(1<b.length&&this.wRa(a,b,c,this.jx,!0,!1,!0)&&this.vRa(a,b,c,this.jx,!0,!1,!0)?(this.pF.$("TableBordersInsideBorders",!0),l.Nf(!0)):(this.pF.$("TableBordersInsideBorders",!1),l.Nf(!1)),32):8}tqj(a,b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.gCa(this.tc.jF(a)));if(!b||!b.length)return Aa.a.J(512500057,822,10,"HandleQueryTableBorderType_OutsideBorder: unable to get valid cellNodes"),
16;l=Object(ua.a)(Nh.a,l);c=we.a.mH(this.eH);return l?(this.zRa(a,b,c,this.jx,!0,!1)&&this.yRa(a,b,c,this.jx,!0,!1)&&this.uRa(a,b,c,this.jx,!0,!1)&&this.xRa(a,b,c,this.jx,!0,!1)?(this.pF.$("TableBordersOutsideBorders",!0),l.Nf(!0)):(this.pF.$("TableBordersOutsideBorders",!1),l.Nf(!1)),32):8}kqj(a,b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.gCa(this.tc.jF(a)));if(!b||!b.length)return Aa.a.J(512500056,822,10,"HandleQueryTableBorderType_AllBorder: unable to get valid cellNodes"),
16;l=Object(ua.a)(Nh.a,l);c=we.a.mH(this.eH);return l?(this.zRa(a,b,c,this.jx,!0,!1)&&this.yRa(a,b,c,this.jx,!0,!1)&&this.uRa(a,b,c,this.jx,!0,!1)&&this.xRa(a,b,c,this.jx,!0,!1)&&this.vRa(a,b,c,this.jx,!0,!1,!0)&&this.wRa(a,b,c,this.jx,!0,!1,!0)?(this.pF.$("TableBordersAllBorders",!0),l.Nf(!0)):(this.pF.$("TableBordersAllBorders",!1),l.Nf(!1)),32):8}sqj(a,b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.Ey();if(!b)return 16;b.length||(b=this.gCa(this.tc.jF(a)));if(!b||!b.length)return Aa.a.J(512500055,
822,10,"HandleQueryTableBorderType_NoBorder: unable to get valid cellNodes"),16;l=Object(ua.a)(Nh.a,l);c=we.a.mH(this.eH);return l?(f=!0,this.Ha.uBe&&(f=this.Oug(b,c,this.jx,!0)&&this.Nug(b,c,this.jx,!0)),f&&this.zRa(a,b,c,this.jx,!0,!0)&&this.yRa(a,b,c,this.jx,!0,!0)&&this.uRa(a,b,c,this.jx,!0,!0)&&this.xRa(a,b,c,this.jx,!0,!0)&&this.vRa(a,b,c,this.jx,!0,!0,!0)&&this.wRa(a,b,c,this.jx,!0,!0,!0)?(this.pF.$("TableBordersNoBorder",!0),l.Nf(!0)):(this.pF.$("TableBordersNoBorder",!1),l.Nf(!1)),32):8}jDa(a,
b){if(!a)return!1;const c=uf.Box4ColorHelper.xxa(a),f=uf.Box4ColorHelper.xxa(b);a=uf.Box4ColorHelper.Mra(a);b=uf.Box4ColorHelper.Mra(b);return c.schemeClrField&&f.schemeClrField&&!a&&!b&&c.schemeClrField.valField===f.schemeClrField.valField?!0:a&&b?a.alpha===b.alpha&&a.UC===b.UC:!1}Jwi(a){a=uf.Box4ColorHelper.xxa(a);const b=this.ua.Ba;return(a=uf.Box4ColorHelper.UL(a,b?b.Pe:null))&&uf.Box4ColorHelper.Jna(a)?uf.Box4ColorHelper.Jna(a).GU():null}Crb(a,b,c,f){if(a=Object(ua.a)(Qs,a.oc(this.Mb.Ma))){f=
uf.Box4ColorHelper.xxa(f);var l=this.ua.Ba;f=(f=uf.Box4ColorHelper.UL(f,l?l.Pe:null))?uf.Box4ColorHelper.Jna(f):null;a.a3k(b,c,f)}}Vu(a,b,c,f){if(a)switch(b){case "Top":a.Jxa=c;a.Zhb=f;this.Crb(a,"Top",c,f);break;case "Right":a.tfa=c;a.Hxa=f;this.Crb(a,"Right",c,f);break;case "Bottom":a.sfa=c;a.Gxa=f;this.Crb(a,"Bottom",c,f);break;case "Left":a.Ixa=c;a.Yhb=f;this.Crb(a,"Left",c,f);break;case "DiagonalUp":a.aib=c;a.Xhb=f;this.Crb(a,"DiagonalUp",c,f);break;case "DiagonalDown":a.$hb=c,a.Whb=f,this.Crb(a,
"DiagonalDown",c,f)}}zRa(a,b,c,f,l,x){const G=new va.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,fa=-1;for(const wa of b)b=wa.ni,R=Math.min(R,b),fa=Math.max(fa,b),G.Jb(b)?G.$(b,Math.min(G.ga(b),wa.rowIndex)):G.$(b,wa.rowIndex);if(l)return this.qRj(a,c,f,R,fa,G,x);this.emj(a,c,f,R,fa,G);return!0}emj(a,b,c,f,l,x){if(re.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=a.jf(x.ga(f),f);this.Vu(R,"Top",b,c);let fa=f;const wa=f+R.colSpan;for(;fa<wa;){var G=a.jf(x.ga(f)-1,fa);G?G.isGhostCell?(G=
G.Gy(),G.ni<f?fa+=1:(this.Vu(G,"Bottom",b,c),fa+=G.colSpan)):(this.Vu(G,"Bottom",b,c),fa+=G.colSpan):fa+=1}f+=R.colSpan}else for(;f<=l;++f)this.Vu(a.jf(x.ga(f),f),"Top",b,c),this.Vu(a.jf(x.ga(f)-1,f),"Bottom",b,c)}qRj(a,b,c,f,l,x,G){for(;f<=l;){const R=a.jf(x.ga(f),f),fa=R.Zhb,wa=we.a.KL(R.Jxa),Wa=we.a.KL(b);if(G){if(wa!==this.Dz[0])return!1}else if(wa!==Wa||!this.jDa(fa,c))return!1;f+=R.colSpan}return!0}uRa(a,b,c,f,l,x){const G=new va.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,fa=-1;for(const wa of b)b=
wa.ni,R=Math.min(R,b),fa=Math.max(fa,b),G.Jb(b)?G.$(b,Math.max(G.ga(b),wa.rowIndex)):G.$(b,wa.rowIndex);if(l)return this.iFj(a,c,f,R,fa,G,x);this.Olj(a,c,f,R,fa,G);return!0}Olj(a,b,c,f,l,x){if(re.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=a.jf(x.ga(f),f);this.Vu(R,"Bottom",b,c);let fa=f;const wa=f+R.colSpan;for(;fa<wa;){var G=a.jf(x.ga(f)+R.rowSpan,fa);G?G.isGhostCell?(G=G.Gy(),G.ni<f?fa+=1:(this.Vu(G,"Top",b,c),fa+=G.colSpan)):(this.Vu(G,"Top",b,c),fa+=G.colSpan):fa+=1}f+=R.colSpan}else for(;f<=
l;++f)this.Vu(a.jf(x.ga(f),f),"Bottom",b,c),this.Vu(a.jf(x.ga(f)+1,f),"Top",b,c)}iFj(a,b,c,f,l,x,G){for(;f<=l;){const R=a.jf(x.ga(f),f),fa=R.Gxa,wa=we.a.KL(R.sfa),Wa=we.a.KL(b);if(G){if(wa!==this.Dz[0])return!1}else if(wa!==Wa||!this.jDa(fa,c))return!1;f+=R.colSpan}return!0}xRa(a,b,c,f,l,x){const G=new va.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,fa=-1;for(const wa of b)b=wa.rowIndex,R=Math.min(R,b),fa=Math.max(fa,b),G.Jb(b)?G.$(b,Math.min(G.ga(b),wa.ni)):G.$(b,wa.ni);if(l)return this.EKj(a,c,f,
R,fa,G,x);this.Vlj(a,c,f,R,fa,G);return!0}Vlj(a,b,c,f,l,x){if(re.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=a.jf(f,x.ga(f));this.Vu(R,"Left",b,c);let fa=f;const wa=f+R.rowSpan;for(;fa<wa;){var G=a.jf(fa,x.ga(f)-1);G?G.isGhostCell?(G=G.Gy(),G.rowIndex<f?fa+=1:(this.Vu(G,"Right",b,c),fa+=G.rowSpan)):(this.Vu(G,"Right",b,c),fa+=G.rowSpan):fa+=1}f+=R.rowSpan}else for(;f<=l;++f)this.Vu(a.jf(f,x.ga(f)),"Left",b,c),this.Vu(a.jf(f,x.ga(f)-1),"Right",b,c)}EKj(a,b,c,f,l,x,G){for(;f<=l;){const R=
a.jf(f,x.ga(f)),fa=R.Yhb,wa=we.a.KL(R.Ixa),Wa=we.a.KL(b);if(G){if(wa!==this.Dz[0])return!1}else if(wa!==Wa||!this.jDa(fa,c))return!1;f+=R.rowSpan}return!0}yRa(a,b,c,f,l,x){const G=new va.ScriptSharpLegacyMap;let R=Number.MAX_VALUE,fa=-1;for(const wa of b)b=wa.rowIndex,R=Math.min(R,b),fa=Math.max(fa,b),G.Jb(b)?G.$(b,Math.max(G.ga(b),wa.ni)):G.$(b,wa.ni);if(l)return this.zOj(a,c,f,R,fa,G,x);this.Wlj(a,c,f,R,fa,G);return!0}Wlj(a,b,c,f,l,x){if(re.a("TableBordersComplexTableFixEnabled"))for(;f<=l;){const R=
a.jf(f,x.ga(f));this.Vu(R,"Right",b,c);let fa=f;const wa=f+R.rowSpan;for(;fa<wa;){var G=a.jf(fa,x.ga(f)+R.colSpan);G?G.isGhostCell?(G=G.Gy(),G.rowIndex<f?fa+=1:(this.Vu(G,"Left",b,c),fa+=G.rowSpan)):(this.Vu(G,"Left",b,c),fa+=G.rowSpan):fa+=1}f+=R.rowSpan}else for(;f<=l;++f)this.Vu(a.jf(f,x.ga(f)),"Right",b,c),this.Vu(a.jf(f,x.ga(f)+1),"Left",b,c)}zOj(a,b,c,f,l,x,G){for(;f<=l;){const R=a.jf(f,x.ga(f)),fa=R.Hxa,wa=we.a.KL(R.tfa),Wa=we.a.KL(b);if(G){if(wa!==this.Dz[0])return!1}else if(wa!==Wa||!this.jDa(fa,
c))return!1;f+=R.rowSpan}return!0}wRa(a,b,c,f,l,x,G){b=this.ra.Ytb();if(!b)return!1;b.length||(b=this.tc.jF(a));if(!b||!b.length)return Aa.a.J(512500054,822,10,"HandleSelectionInsideVerticalBorders: unable to get valid cellNodes"),!1;const R=new va.ScriptSharpLegacyMap,fa=new va.ScriptSharpLegacyMap;let wa=Number.MAX_VALUE,Wa=-1;for(const mb of b)b=mb.rowIndex,wa=Math.min(wa,b),Wa=Math.max(Wa,b),R.Jb(b)?R.$(b,Math.min(R.ga(b),mb.ni)):R.$(b,mb.ni),fa.Jb(b)?fa.$(b,Math.max(fa.ga(b),mb.ni)):fa.$(b,mb.ni);
if(l)return this.eKj(a,c,f,wa,Wa,R,fa,x,G);this.Ulj(a,c,f,wa,Wa,R,fa);return!0}Ulj(a,b,c,f,l,x,G){if(re.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(x.Jb(f)&&G.Jb(f))for(var R=x.ga(f),fa=G.ga(f);R<fa;){const Wa=a.jf(f,R);if(!Wa.isGhostCell&&Wa.ni+Wa.colSpan<=fa){this.Vu(Wa,"Right",b,c);let mb=f;const Kb=f+Wa.rowSpan;for(;mb<Kb;){var wa=a.jf(mb,R+Wa.colSpan);wa?wa.isGhostCell?(wa=wa.Gy(),wa.rowIndex<f?mb+=1:(this.Vu(wa,"Left",b,c),mb+=wa.rowSpan)):(this.Vu(wa,"Left",b,c),mb+=wa.rowSpan):
mb+=1}}R+=Wa.colSpan}}else for(;f<=l;++f)for(R=x.ga(f),fa=G.ga(f);R<fa;++R)this.Vu(a.jf(f,R),"Right",b,c),this.Vu(a.jf(f,R+1),"Left",b,c)}eKj(a,b,c,f,l,x,G,R,fa){if(re.a("TableBordersComplexTableFixEnabled")){for(var wa=!1;f<=l;f++)if(x.Jb(f)&&G.Jb(f))for(var Wa=x.ga(f),mb=G.ga(f);Wa<mb;){var Kb=a.jf(f,Wa);if(!Kb.isGhostCell&&Kb.ni+Kb.colSpan<=mb){var nc=Kb.Hxa;let oc=we.a.KL(Kb.tfa),Ic=we.a.KL(b);wa=!0;if(R){if(oc!==this.Dz[0])return!1}else if(oc!==Ic||!this.jDa(nc,c))return!1}Wa+=Kb.colSpan}return wa?
!0:fa}for(wa=f;wa<=l;++wa){mb=x.ga(wa);f=G.ga(wa);if(mb===f)return fa?!0:!1;for(;mb<f;++mb)if(Kb=a.jf(wa,mb),Wa=Kb.Hxa,Kb=we.a.KL(Kb.tfa),nc=we.a.KL(b),R){if(Kb!==this.Dz[0])return!1}else if(Kb!==nc||!this.jDa(Wa,c))return!1}return!0}vRa(a,b,c,f,l,x,G){b=this.ra.Ytb();if(!b)return!1;b.length||(b=this.tc.jF(a));if(!b||!b.length)return Aa.a.J(512500053,822,10,"HandleSelectionInsideHorizontalBorders: unable to get valid cellNodes"),!1;const R=new va.ScriptSharpLegacyMap,fa=new va.ScriptSharpLegacyMap;
let wa=Number.MAX_VALUE,Wa=-1;for(const mb of b)b=mb.ni,wa=Math.min(wa,b),Wa=Math.max(Wa,b),R.Jb(b)?R.$(b,Math.min(R.ga(b),mb.rowIndex)):R.$(b,mb.rowIndex),fa.Jb(b)?fa.$(b,Math.max(fa.ga(b),mb.rowIndex)):fa.$(b,mb.rowIndex);if(l)return this.dKj(a,c,f,wa,Wa,R,fa,x,G);this.Tlj(a,c,f,wa,Wa,R,fa);return!0}Tlj(a,b,c,f,l,x,G){if(re.a("TableBordersComplexTableFixEnabled"))for(;f<=l;f++){if(x.Jb(f)&&G.Jb(f))for(var R=x.ga(f),fa=G.ga(f);R<fa;){const Wa=a.jf(R,f);if(!Wa.isGhostCell&&Wa.rowIndex+Wa.rowSpan<=
fa){this.Vu(Wa,"Bottom",b,c);let mb=f;const Kb=f+Wa.colSpan;for(;mb<Kb;){var wa=a.jf(R+Wa.rowSpan,mb);wa?wa.isGhostCell?(wa=wa.Gy(),wa.ni<f?mb+=1:(this.Vu(wa,"Top",b,c),mb+=wa.colSpan)):(this.Vu(wa,"Top",b,c),mb+=wa.colSpan):mb+=1}}R+=Wa.rowSpan}}else for(;f<=l;++f)for(R=x.ga(f),fa=G.ga(f);R<fa;++R)this.Vu(a.jf(R,f),"Bottom",b,c),this.Vu(a.jf(R+1,f),"Top",b,c)}dKj(a,b,c,f,l,x,G,R,fa){if(re.a("TableBordersComplexTableFixEnabled")){for(var wa=!1;f<=l;f++)if(x.Jb(f)&&G.Jb(f))for(var Wa=x.ga(f),mb=G.ga(f);Wa<
mb;){var Kb=a.jf(Wa,f);if(!Kb.isGhostCell&&Kb.rowIndex+Kb.rowSpan<=mb){var nc=Kb.Gxa;let oc=we.a.KL(Kb.sfa),Ic=we.a.KL(b);wa=!0;if(R){if(oc!==this.Dz[0])return!1}else if(oc!==Ic||!this.jDa(nc,c))return!1}Wa+=Kb.rowSpan}return wa?!0:fa}for(wa=f;wa<=l;++wa){mb=x.ga(wa);f=G.ga(wa);if(mb===f)return fa?!0:!1;for(;mb<f;++mb)if(Kb=a.jf(mb,wa),Wa=Kb.Gxa,Kb=we.a.KL(Kb.sfa),nc=we.a.KL(b),R){if(Kb!==this.Dz[0])return!1}else if(Kb!==nc||!this.jDa(Wa,c))return!1}return!0}gjg(a,b,c){for(const f of a)this.Vu(f,
"DiagonalUp",b,c)}Oug(a,b,c,f){for(const l of a)if(!this.Ryg(we.a.KL(l.aib),we.a.KL(b),l.Xhb,c,f))return!1;return!0}fjg(a,b,c){for(const f of a)this.Vu(f,"DiagonalDown",b,c)}Nug(a,b,c,f){for(const l of a)if(!this.Ryg(we.a.KL(l.$hb),we.a.KL(b),l.Whb,c,f))return!1;return!0}Ryg(a,b,c,f,l){if(l){if(a!==this.Dz[0])return!1}else if(a!==b||!this.jDa(c,f))return!1;return!0}QDe(a,b,c,f,l){if(!l)return 8;if(1===c)return 32;l[ai.a.On]=!1;a=this.HTa[a.toString()];if(!this.ra||!this.ra.Oa.kb||this.ra.h8())return 16;
b=0;({$va:b}=this.tc.Omd(this.ra.Oa)).returnValue&&b===a&&(l[ai.a.On]=!0);return 32}flc(a,b){a=a.queryResult;null!==a&&(a.C$=parseFloat(b.toFixed(2)).toString())}ycd(a,b,c,f,l){if(!l)return 16;l.Nf(this.gac);return 32}Ihd(a,b,c){if(1===c)return 32;2===c&&(this.gac=!this.gac);Cb.App.Hb.VF({SetLockAspectRatio:"CheckboxModel"});return 32}Dah(a,b,c,f,l){if(!l)return 16;b=this.ra.Yo();if(!b)return 8;a=a===ba.a.rdd?this.tc.Q3d(b):this.tc.S3d(b);this.flc(l,we.a.Av(a));return 32}Loh(a,b,c,f,l){const x=this.ra.Yo();
return a!==ba.a.dxa&&a!==ba.a.JYa||!x?16:1===c?32:Ag.a(String.format("{0}::Entry point:{1}",ba.a.Jz(a),this.ia.oq),a,()=>{if(!l)return Aa.a.J(512500052,822,10,"TableActor::SetTableSize actionData == null"),8;var G=we.a.cW(l.Number);var R=a===ba.a.dxa?this.tc.Q3d(x):this.tc.S3d(x);if(G<Vv.a.i7c||R<Vv.a.i7c)return 16;G/=R;R=this.Fb.ke(15);try{R.kc(x),R.fd=a,a===ba.a.dxa?(this.vs.dxa(x,G),this.gac&&this.vs.JYa(x,G)):(this.vs.JYa(x,G),this.gac&&this.vs.dxa(x,G)),this.vs.BXa(x)}finally{R&&R.dispose()}return 32})}Gic(a,
b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.TOc();if(!b)return 16;b.length||(b=this.tc.Zia(a));if(!b.length)return 16;a=this.OVa.m$f(b);this.flc(l,we.a.Av(a));return 32}Ygb(a,b,c,f,l){const x=this.ra.Yo();return x?1===c?32:Ag.a(String.format("SetTableRowHeight::Entry point:{0}",this.ia.oq),a,()=>{if(null===l)return Aa.a.J(512500051,822,10,"TableActor::SetTableRowHeight actionData == null"),16;let G=this.ra.TOc();if(!G)return Aa.a.J(512500050,822,10,"TableActor::SetTableRowHeight, selected table row nodes == null"),
16;G.length||(G=this.tc.Zia(x));if(!G.length)return 16;let R=Vv.a.qVg;a!==ba.a.Zjd&&(R=l.Number);const fa=this.Fb.ke(15);try{fa.kc(x),fa.fd=a,this.vs.Koh(G,R)}finally{fa&&fa.dispose()}this.vs.BXa(x);return 32}):16}Fic(a,b,c,f,l){a=this.ra.Yo();if(!a)return 16;b=this.ra.Ytb();if(!b)return 16;b.length||(b=this.fub(a));if(!b.length)return 16;a=this.$I.o$f(a,b);this.flc(l,we.a.Av(a));return 32}IYa(a,b,c,f,l){const x=this.ra.Yo();return x?1===c?32:Ag.a(String.format("SetTableColumnWidth::Entry point:{0}",
this.ia.oq),a,()=>{if(null===l)return Aa.a.J(512500049,822,10,"TableActor::SetTableColumnWidth actionData == null"),16;var G=this.ra.Ytb();if(!G)return Aa.a.J(512500048,822,10,"TableActor::SetTableColumnWidth, selected column node == null"),16;G.length||(G=this.fub(x));if(!G.length)return 16;let R=Vv.a.pVg;a!==ba.a.Yjd&&(R=l.Number);G=this.$I.k_d(G);const fa=this.Fb.ke(15);try{fa.kc(x),fa.fd=a,this.vs.Joh(x,G,R)}finally{fa&&fa.dispose()}this.vs.BXa(x);return 32}):16}ujg(a,b,c,f,l){const x=this.ra.Yo();
return x?1===c?re.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:x.Ap()?8:32:Ag.a("HandleDistributeRows:Entry point:"+this.ia.oq,a,()=>{if(2===c){if(null===l)return 16;let fa=this.ra.TOc();if(!fa)return 16;var G=this.ra.Ey();if(!G)return 16;fa.length&&1!==G.length||(fa=this.tc.Zia(x));if(!fa)return 16;if(!fa.length)return Aa.a.J(512500047,822,50,"HandleDistributeRows: unable to get valid tableRowNodes"),16;G=0;for(var R of fa)R&&(G+=this.OVa.b7a(R));R=this.E9i(fa,x);const wa=fa.length;G=G<
wa*R?R:G/wa;R=this.Fb.ke(15);try{R.kc(x),R.fd=a,this.vs.Koh(fa,we.a.Av(G))}finally{R&&R.dispose()}Aa.a.J(512500046,822,50,"HandleDistributeRows: Table Rows Distributed with height: {0}, from Entry Point: {1}",we.a.Av(G),this.ia.oq);this.vs.BXa(x)}return 32}):16}E9i(a,b){let c=we.a.cW(Vv.a.qVg);for(const l of a){a=this.tc.z7a(l);for(const x of a)if(x&&(a=x.C_b)&&(a=yb.ParagraphReader.text(a))&&0<a.length){var f=x.rowIndex;const G=x.ni;if(a=Object(ua.a)(Qs,x.oc(this.Mb.Ma)))this.pX.v8g(b,this.Mb.Ma),
f=this.pX.u0b(b,a.Vha,f,G),a=a.Gd.Fd.Ff(f,1),re.a("DistributeRowsAndColumnsComplexTableFixEnabled")&&1<x.rowSpan&&(a/=x.rowSpan),c=Math.max(c,a)}}return c}lnj(a,b,c,f,l){const x=this.ra.Yo();return x?1===c?re.a("DistributeRowsAndColumnsComplexTableFixEnabled")?32:x.Ap()?8:32:Ag.a("HandleDistributeColumns:Entry point:"+this.ia.oq,a,()=>{if(2===c){if(null===l)return 16;var G=this.ra.Ytb();G.length||(G=this.fub(x));if(!G)return 16;var R=this.ra.Ey();if(!R)return 16;G.length&&1!==R.length||(G=this.fub(x));
if(!G.length)return Aa.a.J(512500045,822,50,"HandleDistributeColumns: unable to get valid tableColumnNodes"),16;R=0;G=this.$I.k_d(G);if(!G)return Aa.a.J(512500044,822,50,"HandleDistributeColumns: table columnIndex array is null"),16;var fa=x.g_d;if(!fa)return Aa.a.J(512500043,822,50,"HandleDistributeColumns: table columnWidths array is null"),16;for(let wa=0;wa<G.length;wa++)R+=fa[G[wa]];R/=G.length;if(we.a.Av(R)<Vv.a.pVg)return 16;fa=this.Fb.ke(15);try{fa.kc(x),fa.fd=a,this.vs.Joh(x,G,we.a.Av(R))}finally{fa&&
fa.dispose()}Aa.a.J(512500042,822,50,"HandleDistributeColumns: Table Columns Distributed with width: {0}, from Entry Point: {1}",we.a.Av(R),this.ia.oq);this.vs.BXa(x)}return 32}):16}F5d(a,b,c,f,l){if(!this.Ha.Cce||this.ra.h8())return 16;if(1===c)return 32;if(!l)return 8;c=this.HTa[a.toString()];b=b.node;f=this.Fb.ke(15);f.kc(b);f.fd=a;a=b.cellShading;a.anchorField=c;b.cellShading=a;b.Fna=c;f.dispose();return 32}voj(a,b,c,f,l){b=this.ua.Ba;if(!b||this.Af.Zc(b))return 16;if(!this.ol.yI(b,1))return this.ol.AJ(b),
16;c=l.Rows;f=l.Columns;l=l.From;var x=b.Bb;x=b.g7(x.sid,x.cid,0,c,f,b.ev());var G=b.L2(this.ra.Yd());if(G){if(this.Af.Zc(G)||this.Ea.sI(G))return 16;this.Dm.Y2k(x,G.id);this.Af.Jw(G,a)}G=this.Fb.ud(15,void 0,()=>{this.ra.Cy();this.ra.Uh();this.Fa.Ad()});try{G.kc(b),G.fd=a,b.GB(x)}finally{G&&G.dispose()}this.ra.selectShape(x,!0);Aa.a.J(512500040,822,50,"Insert {0}x{1} table from {2}",f,c,l);this.Yx.CI=x;return 32}woj(){(new zN((a,b)=>{const c={};c.Rows=a;c.Columns=b;c.From="Placeholder";this.ia.La(ba.a.wbd,
2,c)})).ujd();return 32}xoj(a,b,c,f,l){l.From="Ribbon";return this.ia.La(ba.a.wbd,c,l)}hnj(a,b,c){b=this.ua.Ba;if(!b||this.ra.h8())return 16;const f=this.ra.rq();if(!f||!f.qd||this.Af.Zc(f))return 16;if(1===c)return 32;Nc.a.LO(!0,!0);c=this.Fb.ud(15,void 0,()=>{this.ra.setSelection(null);this.Fa.Ad()});try{c.kc(b),c.fd=a,this.Dm.sZf(f)}finally{c&&c.dispose()}this.Af.Jw(b,a);return 32}jnj(a,b,c,f,l){if(this.ra.wu())return 16;a=this.H2d(this.ra.Kj,!0,this.ra);return this.pEj(a)?16:32!==a.response?8:
a.DC&&a.DC.length===Jd.TableReader.jk(a.Vo)?this.ia.processAction(ba.a.zEb,c):this.ia.ki(b,E.a.deleteRow,c,!1,f,l)}inj(a,b,c,f,l){if(this.ra.wu())return 16;a=this.H2d(this.ra.Kj,!1,this.ra);return this.oEj(a)?16:32!==a.response?8:a.DC&&a.DC.length===Jd.TableReader.wi(a.Vo)?this.ia.processAction(ba.a.zEb,c):this.ia.ki(b,E.a.zBa,c,!1,f,l)}jrj(a,b,c,f,l){return 1===c?32:this.ia.ki(b,ba.a.Tha,c,!1,f,l)}Koj(a,b,c){if(this.ra.wu()||this.ra.h8()||!this.Ha.PVc)return 16;b=this.ra.Oa;if(!b||!b.vl||1===b.length&&
1===b.ga(0).length)return 16;b=this.LBb.R1b(b);if(!b)return Aa.a.J(36721626,822,50,"Unable to get cell selection info"),8;if(!b.iOj)return 16;if(1===c)return 32;Nc.a.Eb&&(Nc.a.Eb.Oj=!0,Nc.a.Eb.WE=new Date);Aa.a.J(36721628,822,50,"Perform table merge cells");const f=b.tableNode;c=this.Fb.ke(15);c.kc(f);c.fd=a;a=this.cSg.merge(f,b.Rpb,b.mY);a=Zq.TableNodeContext.create(a);a=rd.SelectionFactory.MXb(rd.SelectionFactory.nu(a));this.ra.qE(a);c.dispose();Aa.a.J(36721630,822,50,"Table merge cells succeeded");
return 32}Irj(a,b,c){if(this.ra.wu()||this.ra.h8()||!this.Ha.Hce)return 16;var f=null;f=this.ra.Oa.vl?this.LBb.R1b(this.ra.Oa):this.LBb.lfj(b.view.Gb.Kj);if(!f)return 16;const l=f.tableNode.sg(this.Mb.Ma);if(l&&!l.CKj)return Aa.a.J(512500037,822,50,"Suspend split cells as table layout service is running"),16;const x=Object(ua.a)(158,f.tableNode);if(this.tc.P9d(x))return 16;const G=f.Rpb;if(!({rows:b,cols:a}=this.bsl(x,G)).returnValue)return 8;if(1===c)return 1<b||1<a?32:16;const R=f.mY,fa=new Date;
({rows:c,cols:f}=this.X0i(x,R,G,l));const wa=Nc.a.Eb;wa&&(wa.Wa("GetClientSplitLimit",(+new Date-+fa).toString()),wa.Kr=!1);(new AN((Wa,mb)=>{this.cSg.ail(x,G,Wa,mb,R,l,this.Mb.Fd,Object(C.a)(this,this.idg,"getNewOutlineElementInfoFromCell"),()=>{})},Math.min(b,c),Math.min(a,f))).ujd();return 32}Uqj(a,b,c,f,l){if(!l||!Object(Ma.a)(Array,l))return 8;if(1!==l.length)return Aa.a.J(512500036,822,50,"Fallback table resize fail: reiszeShapeData length is {0}.",l.length),8;if(this.Af.Zc(l[0].G0))return 16;
b=l[0].G0;if(!(b&&b.isConnected&&b.isResizable&&b.qd)||b.sI)return Aa.a.J(512500035,822,50,"Fallback table resize: try to resize shape {0} which is not resizeable",b.get_shapeId()),16;f=Object(ua.a)(121,b.oc(this.Mb.Ma));if(!f)return Aa.a.J(512500034,822,50,"Fallback table resize fail: shape {0} has no shapeviewelement",b.get_shapeId()),8;const x=this.tc.iN(b);if(!x)return Aa.a.J(512500033,822,50,"Fallback table resize fail: shape {0} has no table node",b.get_shapeId()),8;const G=x.oc(this.Mb.Ma);
if(!G)return Aa.a.J(512500032,822,50,"Fallback table resize fail: fallback table shape {0} has no tableviewelement and no rendered",b.get_shapeId()),8;if(!l[0].dZb)return f&&f.setOffsets(new Of.a,!0),Aa.a.J(512500003,822,50,"Fallback table resize fail: resizeShapeData no drag direction"),8;if(1===c)return 32;let R=c=1;try{f.Fk.wkh.yqb.length||(this.l3c=new Of.a);f.setOffsets(new Of.a,!0);var fa=G.Q1b();const wa=this.FEa.Hm(fa.Vb-fa.Yb),Wa=this.FEa.Hm(fa.Ub-fa.$b),mb=new zc.a(f.x+wa,f.y+Wa),Kb=new zc.a(f.bfa(l[0].JVg.x),
f.bfa(l[0].JVg.y)),nc=Jk.XMd(l[0].dZb,fa,Kb,!1,!1);c=wa?1+(nc.right-nc.left)/wa:1;R=Wa?1+(nc.bottom-nc.top)/Wa:1;G.Noh(c,R);const oc=G.Q1b();let Ic=th.a.d1b(oc,fa);Ic.Dj(1/f.nd);this.l3c&&(Ic=Of.a.add(Ic,this.l3c));f.setOffsets(Ic,!0);this.l3c=Ic;l[0].s0.Dj(f.nd);this.YQe(l[0].dZb,f,oc,mb,l[0].s0)}catch(wa){return Aa.a.J(512500002,822,50,"Fallback table resize fail: ",wa.toString()),8}fa=this.Fb.ke(15);fa.kc(x);fa.fd=a;a=G.Gd.Fd;this.vs.EHe(x,c,R,G,a);if(su.GDa(l[0].dZb)||su.GDa(l[0].dZb,!0))l=a.Ff(f.x,
0),a=a.Ff(f.y,1),b.fz=l,b.gz=a;fa.dispose();return 32}bsl(a,b){let c,f;c=f=1;try{return c=Math.max(1,Math.floor((35-this.tc.jk(a))/b.oO)+1),f=Math.max(1,Math.floor((35-this.tc.wi(a))/b.TQ)+1),{returnValue:!0,rows:c,cols:f}}catch(l){Aa.a.J(512500001,822,10,"Failed to get server split limits, Exception: {0}",l.toString())}return{returnValue:!1,rows:c,cols:f}}X0i(a,b,c,f){a=this.gda.WBa(a,b,c);b=f.efg();f=f.$9f();let l=c=Number.MAX_VALUE;for(;a.moveNext();){const x=a.Pz;l=Math.min(l,b[x.Zf]-b[x.ge]);
c=Math.min(c,f[x.Lf]-f[x.$d])}return{rows:Math.max(1,Math.floor(l/BN.a)),cols:Math.max(1,Math.floor(c/BN.a))}}idg(a){const b=Kh.Ndg(a,!1);b.style||(b.style=new mq.a);a=Object(ua.a)(nb.GraphIterator,this.Nb.Kc(a));a.Mu();if(a.HA(1)){if(Ib.ListReader.kk(a)){const f=this.Wz.Pw(a),l=Ae.a.AP(f.listType,f.listStyle);0===l.listType&&(l.iA=l.wW=f.iA);f.propertySet.Sa(tb.a.Ni)&&l.propertySet.setValue(tb.a.Ni,f.propertySet.getValue(tb.a.Ni));f.propertySet.Sa(tb.a.font)&&l.propertySet.setValue(tb.a.font,f.propertySet.getValue(tb.a.font));
f.propertySet.Sa(sb.a.autonumberBulletType)&&l.propertySet.setValue(sb.a.autonumberBulletType,f.propertySet.getValue(sb.a.autonumberBulletType));b.style.Jx(l.propertySet)}var c;(c=b.style).R4a.apply(c,[a.currentNode].concat(Uq.D4d()));if(c=a.HA(2)){let f;(f=b.style).R4a.apply(f,[c].concat(Uq.D4d()));a.yc()}}return b}Acj(a,b){const c=new Yt;c.response=8;if(!a)return c;let f=null;var l=null,x=!1;const G=Df.ContextSetEditor.instance.uA(a);a=[];for(var R=0;R<G.length;++R)if(G[R].Qk){var fa=Object(ua.a)(5,
G[R].node);if(!fa||!fa.hs())return c;fa=fa.HK();f||(f=fa.PMc());l?l!==fa&&(x=!0):l=fa}if(!f)return c;R=f.getContainingTable();if(!R)return c;if(x){b=new Ha.a;if(this.gLg){l=this.LBb.R1b(this.ra.Oa).Rpb;if(l.$Pa())return c;for(x=l.ge;x<l.Zf;x++)b.add(x);Aa.a.J(5125E5,822,50,"Insert {0} rows",b.count)}else if(b=this.P1i(G),1!==b.count)return c;l=R.fdj(b.ga(0));for(x=0;x<b.count;x++)Array.add(a,Mc.a.create(Object(ua.a)(lg.a,l))),l=l.lHa}else{if(!b)for(b=l.rowSpan;0<--b;)f=f.lHa;Array.add(a,Mc.a.create(Object(ua.a)(lg.a,
f)))}c.DC=a;c.AIb=Object(ua.a)(lg.a,f);c.Vo=Object(ua.a)(lg.a,R);c.Jdb=a.length;if(this.Ha.nv||!Jd.TableReader.vu(c.Vo))c.response=32;return c}ucj(a,b){const c=new Yt;c.response=8;if(!a)return c;var f=null,l=null,x=Df.ContextSetEditor.instance.uA(a);let G=!1;a=[];for(let fa=0;fa<x.length;++fa)if(x[fa].Qk){var R=Object(ua.a)(5,x[fa].node);if(!R||!R.hs())return c;R=R.HK();f||(f=R.u$f());l?l!==R&&(G=!0):l=R}if(!l)return c;f=f.getContainingTable();if(!f)return c;if(G){b=new Ha.a;if(this.gLg){l=this.LBb.R1b(this.ra.Oa).Rpb;
if(l.$Pa())return c;for(x=l.$d;x<l.Lf;x++)b.add(x);Aa.a.J(512499998,822,50,"Insert {0} columns",b.count)}else if(b=this.N1i(x),1!==b.count)return c;l=f.jf(0,b.ga(0));for(x=0;x<b.count;x++)Array.add(a,Mc.a.create(Object(ua.a)(lg.a,l))),l=l.HZ()}else b&&(l=f.jf(0,l.ni+l.colSpan-1)),Array.add(a,Mc.a.create(Object(ua.a)(lg.a,l)));c.DC=a;c.AIb=Object(ua.a)(lg.a,l);c.Vo=Object(ua.a)(lg.a,f);c.Jdb=a.length;if(this.Ha.nv||!f.Ap())c.response=32;return c}P1i(a){const b=new Ha.a,c=new va.ScriptSharpLegacyMap;
let f=0;for(let G=0;G<a.length;++G)if(a[G].Qk){var l=Object(ua.a)(5,a[G].node);if(l&&l.hs()){f++;var x=l.HK();l=x.rowIndex;for(x=l+x.rowSpan;l<x;l++)if(c.Jb(l)){let R;c.$(R=l,c.ga(R)+1)}else c.add(l,1)}}for(let G of c.keys)c.ga(G)===f&&b.add(G);return b}N1i(a){const b=new Ha.a,c=new va.ScriptSharpLegacyMap;let f=0;for(let G=0;G<a.length;++G)if(a[G].Qk){var l=Object(ua.a)(5,a[G].node);if(l&&l.hs()){f++;var x=l.HK();l=x.ni;for(x=l+x.colSpan;l<x;l++)if(c.Jb(l)){let R;c.$(R=l,c.ga(R)+1)}else c.add(l,
1)}}for(let G of c.keys)c.ga(G)===f&&b.add(G);return b}wcj(a){return Nn.a(a)}ycj(a){const b=new Yt;b.response=8;if(!a)return b;if(a.vl){var c=a.hZa;a=a.ria;if(!c||!a)return b;c=Object(ua.a)(127,c.currentNode);a=Object(ua.a)(127,a.currentNode);if(!c||!a)return b;var f=c.ni;a=a.ni;if(f>a){var l=f;f=a;a=l}}else{c=qd.a.rpb(a);c=Df.ContextSetEditor.instance.uA(c);if(!c||1>c.length||!c[0].Qk)return b;c=Object(ua.a)(5,c[0].node);if(!c||!c.hs())return b;c=c.HK();a=f=c.ni}l=this.tc.T1b(c);if(!l||14!==l.type||
0>f||0>a)return b;const x=[];let G=l.jf(0,f);if(!G)return b;for(;f<=a;)Array.add(x,Mc.a.create(Object(ua.a)(lg.a,G))),G=G.HZ(),f++;b.DC=x;b.AIb=Object(ua.a)(lg.a,c);b.Vo=Object(ua.a)(lg.a,l);b.Jdb=x.length;if(this.Ha.nv||!l.Ap())b.response=32;return b}Ccj(a){const b=new Yt;b.response=8;if(!a)return b;if(a.vl){var c=a.hZa;a=a.ria;if(!c||!a)return b;var f=gk.c(c);a=gk.c(a);c=Object(ua.a)(Vl.TableCellNode,c.currentNode);if(f>a){var l=f;f=a;a=l}}else{a=qd.a.rpb(a);a=Df.ContextSetEditor.instance.uA(a);
if(!a||1>a.length||!a[0].Qk)return b;a=Object(ua.a)(5,a[0].node);if(!a||!a.hs())return b;c=a.HK();a=f=c.rowIndex}if(!c)throw Aa.a.J(512499997,822,10,"TypeCasting to ITableCellNode failed"),Error.argumentNull("TypeCasting to ITableCellNode failed");l=c.getContainingTable();if(!l||14!==l.type||0>f||0>a)return b;const x=[];let G=l.jf(f,0).PMc();for(;f<=a;)Array.add(x,Mc.a.create(Object(ua.a)(lg.a,G))),G=G.lHa,f++;b.DC=x;b.AIb=Object(ua.a)(lg.a,c);b.Vo=Object(ua.a)(lg.a,l);b.Jdb=x.length;if(this.Ha.nv||
!Jd.TableReader.vu(b.Vo))b.response=32;return b}flj(a,b){if(a=Object(ua.a)(Vl.TableCellNode,a.currentNode)){if(b)for(b=a.colSpan;0<b--;)a=a.HZ();else a=a.N6a();a&&(b=a.getContainingTable().firstRow,a=a.getContainingTable().jf(b.rowIndex,a.ni),a=a.Gy(),nb.GraphIterator.mb(Object(ua.a)(lg.a,a)))}}H2d(a,b,c){const f=new Yt;f.response=8;if(!a||!c||!c.Oa)return f;const l=[],x=[];c=c.Oa;if(c.vl){if(c=this.LBb.R1b(c))if(a=c.Rpb,c=c.tableNode.firstRow,b)for(b=0;b<=a.Gde;b++){var G=c.rowIndex;G>=a.$5f&&G<=
a.Gde&&l.push(c);c=c.lHa}else for(b=c.S5f,c=0;c<=a.yde;c++)G=b.ni,G>=a.T5f&&G<=a.yde&&x.push(b),b=b.HZ()}else for(a=Df.ContextSetEditor.instance.uA(a),c=0;c<a.length;++c)if(a[c].Qk){G=Object(ua.a)(5,a[c].node);if(!G||!G.hs())return f;var R=G.HK();if(b)for(G=R.rowSpan,R=R.PMc();0<G--;)Array.contains(l,R)||l.push(R),R=R.lHa;else for(G=R.colSpan,R=R.u$f();0<G--;)Array.contains(x,R)||x.push(R),R=R.HZ()}if(!l.length&&!x.length)return f;b=[];for(a=0;a<l.length;a++)Array.add(b,Mc.a.create(Object(ua.a)(lg.a,
l[a])));for(a=0;a<x.length;a++)Array.add(b,Mc.a.create(Object(ua.a)(lg.a,x[a])));f.DC=b;f.AIb=0<l.length?Object(ua.a)(lg.a,l[0]):Object(ua.a)(lg.a,x[0]);f.Vo=0<l.length?Object(ua.a)(lg.a,l[0].getContainingTable()):Object(ua.a)(lg.a,x[0].getContainingTable());if(this.Ha.nv||!Object(ua.a)(158,f.Vo).Ap())f.response=32;return f}pEj(a){if(!a.DC)return!1;for(let c=0;c<a.DC.length;c++){var b=Object(ua.a)(Mc.a,a.DC[c]);if(b&&(b=Object(ua.a)(157,b.node))){b=this.tc.z7a(b);for(const f of b)if(f&&f.Jvb)return!0}}return!1}oEj(a){if(!a.DC)return!1;
var b=Object(ua.a)(158,a.Vo);if(!b)return!1;var c=Object(ua.a)(Mc.a,a.DC[0]);if(!c)return!1;c=Object(ua.a)(127,c.node);if(!c)return!1;c=Object(ua.a)(nb.GraphIterator,this.Nb.Kc(c));c.pc(14);b=this.tc.jk(b);a=a.DC.length;const f=new nb.GraphIterator;f.Pc(c);for(let l=0;l<b;l++){for(let x=0;x<a;x++){const G=Object(ua.a)(127,c.currentNode);if(G&&G.Jvb)return!0;c.vf(1)}Qd.moveToNextRow(f);c.Pc(f)}return!1}fub(a){let b=null;a&&14===a.type&&(b=this.tc.O3d(a.firstRow));return b}YQe(a,b,c,f,l){var x=su.GDa(a);
a=su.GDa(a,!0);if(x||a)x=this.FEa.Hm(c.Vb-c.Yb),c=this.FEa.Hm(c.Ub-c.$b),f._x+=this.FEa.Hm(l.right),f._y+=this.FEa.Hm(l.bottom),b.setPosition(f.x-x,f.y-c,!0)}Sdj(){var a=null;const b=this.ua.Ba;var c=this.ra.Ey();if(re.a("FixColorPickerSelectedColor")){if(!c||!c.length){if(c=this.ra.Yo())a=c.jf(0,0),a=uf.Box4ColorHelper.vCa(a.cellShading.solidFillField,b.Pe);return a}(c=c[0])&&(a=c.cellShading&&c.cellShading.solidFillField?uf.Box4ColorHelper.vCa(c.cellShading.solidFillField,b.Pe):this.bA.uMc(Object(ua.a)(lg.a,
c)))}return a}static FPi(a,b,c,f,l,x){const G=Nc.a.Pl("HandleSelectTableBorderType");G.Wa("CommandId",a.toString());G.Wa("BorderType",b);G.Wa("BorderWidth",c);G.Wa("BorderColor",f);G.Wa("CommandLocation",l);try{return x()}finally{G.finish(!0)}}static GDa(a,b=!1){return a.equals(Sc.a.Bu)?!0:b?a.equals(Sc.a.north)||a.equals(Sc.a.gE):a.equals(Sc.a.west)||a.equals(Sc.a.sH)}}Object(e.a)(su,"TableActor",null,[229]);class Wv{constructor(){this.marginRight=this.marginLeft=this.marginBottom=this.marginTop=
0}}Object(e.a)(Wv,"TableCellMargin",null,[]);class Xv{constructor(a,b,c,f,l,x,G,R){this.RGa=null;this.x1c=0;this.WDl=we.a.ebd(2);this.cXf=Object.assign(new Wv,{marginTop:.05,marginBottom:.05,marginLeft:.1,marginRight:.1});this.bXf=Object.assign(new Wv,{marginTop:0,marginBottom:0,marginLeft:0,marginRight:0});this.aXf=Object.assign(new Wv,{marginTop:.05,marginBottom:.05,marginLeft:.05,marginRight:.05});this.mXf=Object.assign(new Wv,{marginTop:.15,marginBottom:.15,marginLeft:.15,marginRight:.15});this.iCh=
Object.assign(new Wv,{marginTop:-1,marginBottom:-1,marginLeft:-1,marginRight:-1});if(a)if(b)if(c)if(f)if(l)if(x){if(!G)throw Aa.a.J(512499990,822,50,"Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:functionThrottlerFactory cannot be null");if(!R)throw Aa.a.J(512499989,822,50,"Table Cell Margin Actor constructor argument:pageView cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:pageView cannot be null");
}else throw Aa.a.J(512499991,822,50,"Table Cell Margin Actor constructor argument:tableReader cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:tableReader cannot be null");else throw Aa.a.J(512499992,822,50,"Table Cell Margin Actor constructor argument:selectionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:selectionManager cannot be null");else throw Aa.a.J(512499993,822,50,"Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null"),
Error.argumentNull("Table Cell Margin Actor constructor argument:graphTopologyManager cannot be null");else throw Aa.a.J(512499994,822,50,"Table Cell Margin Actor constructor argument:transactionFactory cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:transactionFactory cannot be null");else throw Aa.a.J(512499995,822,50,"Table Cell Margin Actor constructor argument:applicationSettings cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:applicationSettings cannot be null");
else throw Aa.a.J(512499996,822,50,"Table Cell Margin Actor constructor argument:actionManager cannot be null"),Error.argumentNull("Table Cell Margin Actor constructor argument:actionManager cannot be null");this.ia=a;this.Ha=b;this.Fb=c;this.ua=f;this.ra=l;this.tc=x;this.N1j=G.$Qd(50,Object(C.a)(this,this.I3a,"applyPendingChangesToServerIfRequired"));this.Mb=R}ub(){this.ia.pa(ba.a.bxh,Bb.a.view,Object(C.a)(this,this.K2b,"handleTableCellMargins"),4);this.ia.pa(ba.a.$kd,Bb.a.tableCell,Object(C.a)(this,
this.K2b,"handleTableCellMargins"),4);this.ia.pa(ba.a.TDe,sc.a.application,Object(C.a)(this,this.tQc,"handleQueryTableCellDefaultMargins"),96);this.ia.pa(ba.a.Zkd,Bb.a.tableCell,Object(C.a)(this,this.K2b,"handleTableCellMargins"),4);this.ia.pa(ba.a.SDe,sc.a.application,Object(C.a)(this,this.tQc,"handleQueryTableCellDefaultMargins"),96);this.ia.pa(ba.a.Ykd,Bb.a.tableCell,Object(C.a)(this,this.K2b,"handleTableCellMargins"),4);this.ia.pa(ba.a.RDe,sc.a.application,Object(C.a)(this,this.tQc,"handleQueryTableCellDefaultMargins"),
96);this.ia.pa(ba.a.bld,Bb.a.tableCell,Object(C.a)(this,this.K2b,"handleTableCellMargins"),4);this.ia.pa(ba.a.UDe,sc.a.application,Object(C.a)(this,this.tQc,"handleQueryTableCellDefaultMargins"),96);this.ia.ya(ba.a.$kd,Bb.a.view,Dc.Gia);this.ia.ya(ba.a.Zkd,Bb.a.view,Dc.Gia);this.ia.ya(ba.a.Ykd,Bb.a.view,Dc.Gia);this.ia.ya(ba.a.bld,Bb.a.view,Dc.Gia);this.ia.pa(ba.a.gnc,Bb.a.view,Object(C.a)(this,this.AQc,"handleTableCellCustomMargins"),4);this.ia.pa(ba.a.Cic,Bb.a.view,Object(C.a)(this,this.sQc,"handleQueryTableCellCustomMargins"),
96);this.ia.pa(ba.a.hnc,Bb.a.view,Object(C.a)(this,this.AQc,"handleTableCellCustomMargins"),4);this.ia.pa(ba.a.Dic,Bb.a.view,Object(C.a)(this,this.sQc,"handleQueryTableCellCustomMargins"),96);this.ia.pa(ba.a.inc,Bb.a.view,Object(C.a)(this,this.AQc,"handleTableCellCustomMargins"),4);this.ia.pa(ba.a.Eic,Bb.a.view,Object(C.a)(this,this.sQc,"handleQueryTableCellCustomMargins"),96);this.ia.pa(ba.a.fnc,Bb.a.view,Object(C.a)(this,this.AQc,"handleTableCellCustomMargins"),4);this.ia.pa(ba.a.Bic,Bb.a.view,
Object(C.a)(this,this.sQc,"handleQueryTableCellCustomMargins"),96)}xe(){}K2b(a,b,c,f,l){return this.Cqh(a)?1===c?32:Ag.a("HandleTableCellMargins:Entry point:"+this.ia.oq,a,()=>{if(!l)return Aa.a.J(512499987,822,50,"HandleTableCellMargins: actionData cannot be null"),16;if(!b||!b.node)return Aa.a.J(512499986,822,50,"HandleTableCellMargins: Either node context is null or unable to extract Table cell node from context"),16;const x=b.node,G=this.yQi(a);if(!G)return Aa.a.J(512499985,822,50,"HandleTableCellMargins: unable to get Table cell margins"),
16;const R=this.Fb.ke(15);R.kc(x);R.fd=a;this.XHf(x,G);R.dispose();Aa.a.J(512499984,822,50,"HandleTableCellMargins: EntryPoint={1} ActionId={2}",this.ia.oq,a);return 32}):(Aa.a.J(512499988,822,50,"HandleTableCellMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}tQc(a,b,c,f,l){if(!this.Ha.sJb)return 8;b=Object(ua.a)(Nh.a,l);if(!b)return 16;f=this.ra.Yo();if(!f)return Aa.a.J(512499983,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid tableNode"),16;c=this.ra.Ey();if(!c)return 16;
c.length||(c=this.tc.jF(f));if(!c||!c.length)return Aa.a.J(512499982,822,50,"QueryTableCellDefaultMarginsOptions: unable to get valid cellNodes"),16;f=!1;switch(a){case ba.a.TDe:f=this.LMc(c,this.cXf);break;case ba.a.SDe:f=this.LMc(c,this.bXf);break;case ba.a.RDe:f=this.LMc(c,this.aXf);break;case ba.a.UDe:f=this.LMc(c,this.mXf)}b.Nf(f);return 32}LMc(a,b){for(const c of a)if(c&&!c.isGhostCell&&(we.a.Av(c.marginTop)!==b.marginTop||we.a.Av(c.marginBottom)!==b.marginBottom||we.a.Av(c.marginLeft)!==b.marginLeft||
we.a.Av(c.marginRight)!==b.marginRight))return!1;return!0}yQi(a){let b=Fi.b(this.iCh);switch(a){case ba.a.$kd:b=this.cXf;break;case ba.a.Zkd:b=this.bXf;break;case ba.a.Ykd:b=this.aXf;break;case ba.a.bld:b=this.mXf}return b}XHf(a,b){0<=b.marginLeft&&(a.marginLeft=we.a.cW(b.marginLeft));0<=b.marginRight&&(a.marginRight=we.a.cW(b.marginRight));0<=b.marginTop&&(a.marginTop=we.a.cW(b.marginTop));0<=b.marginBottom&&(a.marginBottom=we.a.cW(b.marginBottom))}z9h(a,b){b=Math.max(we.a.cW(this.WDl+b.marginLeft+
b.marginRight),a);De.a.Jy(b,a)||(a={},a.Number=we.a.Av(b),this.ia.La(ba.a.IYa,2,a))}Cqh(a){if(!this.ua.Ba)return!1;const b=this.ra.rq();return!!b&&b.qd&&(this.Ha.sJb&&Array.contains(Xv.DYk,a)||this.Ha.eib&&Array.contains(Xv.OYk,a))}sQc(a,b,c,f,l){if(!this.Ha.eib)return 8;b=this.ra.Yo();if(!b)return Aa.a.J(512499981,822,50,"HandleQueryTableCellCustomMargins: unable to get valid tableNode"),16;c=this.ra.Ey();if(!c)return Aa.a.J(512499980,822,50,"HandleQueryTableCellCustomMargins: unable to get selected table cells"),
16;c.length||(c=this.tc.jF(b));if(!c||!c.length)return Aa.a.J(512499979,822,50,"HandleQueryTableCellCustomMargins: unable to get valid cellNodes"),16;b=this.dej(c,a);this.flc(l,we.a.Av(b));Aa.a.J(512499978,822,50,"HandleQueryTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.oq,a);return 32}dej(a,b){let c=-1,f=-1;for(const l of a)if(l&&!l.isGhostCell){switch(b){case ba.a.Cic:c=l.marginLeft;break;case ba.a.Dic:c=l.marginRight;break;case ba.a.Eic:c=l.marginTop;break;case ba.a.Bic:c=l.marginBottom}if(0<=
f&&f!==c)return-1;f=c}return c}flc(a,b){a=a.queryResult;null!==a&&(a.C$=parseFloat(b.toFixed(2)).toString())}AQc(a,b,c,f,l){return this.Cqh(a)?1===c?32:Ag.a("HandleTableCellCustomMargins:Entry point:"+this.ia.oq,a,()=>{if(!l)return Aa.a.J(512499976,822,50,"HandleTableCellCustomMargins: actionData cannot be null"),16;const x=this.ra.Yo();if(!x)return Aa.a.J(512499975,822,50,"HandleTableCellCustomMargins: unable to get valid tableNode"),16;let G=this.ra.Ey();if(!G)return Aa.a.J(512499974,822,50,"HandleTableCellCustomMargins: unable to get selected table cells"),
16;G.length||(G=this.tc.jF(x));this.hlk(a,G,l);Aa.a.J(512499973,822,50,"HandleTableCellCustomMargins: EntryPoint={1} ActionId={2}",this.ia.oq,a);return 32}):(Aa.a.J(512499977,822,50,"HandleTableCellCustomMargins: ShouldExecuteTableEditMarginsAction returned false"),8)}hlk(a,b,c){this.x1c!==a&&(this.I3a(),this.x1c=a);this.RGa||(this.RGa=[]);Ag.a("OnCustomMarginChange:Entry point:"+this.ia.oq,a,()=>{for(let l=0;l<b.length;l++){var f=b[l];if(!f||!f||f.isGhostCell)continue;const x=Object(ua.a)(Qs,f.oc(this.Mb.Ma));
if(x){this.RGa[l]||(this.RGa[l]=new Vw.a(f,this.fhj(f)));f=this.RGa[l];switch(a){case ba.a.gnc:f.second.marginLeft=c.Number;break;case ba.a.hnc:f.second.marginRight=c.Number;break;case ba.a.inc:f.second.marginTop=c.Number;break;case ba.a.fnc:f.second.marginBottom=c.Number}x.e3k(f.second,a)}}return 32});this.N1j.perform()}I3a(){this.Ha.eib&&this.RGa&&this.RGa.length&&(Ag.a("ApplyPendingChangesToServerIfRequired:Entry point:"+this.ia.oq,this.x1c,()=>{const a=this.Fb.ke(15);try{a.fd=this.x1c;let b=null;
for(const c of this.RGa)b||(b=c.first.getContainingTable(),a.kc(b)),this.XHf(c.first,c.second),this.z9h(c.first.width,c.second);a.dispose()}finally{a&&a.dispose()}return 32}),this.RGa=null)}fhj(a){const b=Fi.b(this.iCh);b.marginLeft=we.a.Av(a.marginLeft);b.marginRight=we.a.Av(a.marginRight);b.marginTop=we.a.Av(a.marginTop);b.marginBottom=we.a.Av(a.marginBottom);return b}}Xv.DYk=[ba.a.bxh,ba.a.$kd,ba.a.Zkd,ba.a.Ykd,ba.a.bld];Xv.OYk=[ba.a.gnc,ba.a.hnc,ba.a.inc,ba.a.fnc];Object(e.a)(Xv,"TableCellMarginActor",
null,[229]);class Fq{constructor(a,b,c,f,l,x,G,R){this.qm=this.scc=null;this.aSg=0;this.c0c=!1;this.roe=this.mse=this.uSg=this.qFg=this.tSg=this.pFg=null;this.bA=a;this.Jk=b;this.Dle=c;this.Wda=f;this.tse=l;this.Gak=x;this.Bak=G;this.OUa=R}qml(a,b){const c=new Sys.StringBuilder('<div class="PreviewStyleContainer" aria-hidden="true" style="display:table-cell; text-align:center; vertical-align:middle;">');this.p8d(a,b);try{c.append(String.format('<table class="TableStylePreview" style="background:{0}">',
this.Jk.$ob(this.Jk.c0d(this.scc),this.qm)));for(a=0;5>a;a++){c.append("<tr>");for(b=0;5>b;b++){const f=this.mse.VZd(a,b,1,1),l=this.cbg(this.roe,this.qm,a,b),x=this.Jk.$ob(f.Sa(sb.a.cellShading)?f.Xh(sb.a.cellShading):ml.a.grb,this.qm),G=new Sys.StringBuilder;for(let R=0;R<Fq.W7b.length;R++){const fa=Vp.$Qa(Fq.zYc[R]),wa=f.sa(fa.Y3a,ml.a.BHc),Wa=f.sa(fa.hpb,ml.a.erb);G.append(Fq.W7b[R]);if(wa.UC===Hb.a.auto){const mb=this.Jk.QZd(.0277777777777778);G.append(String.format("inset {0}px transparent",
mb))}else G.append(this.Jk.cZd(Wa,.0277777777777778,wa));G.append(";")}c.append(String.format('<td style="color: {0}; background-color: {1}; {2}">',l,x,G));c.append("<div>&#x2014;</div>");c.append("</td>")}c.append("</tr>")}c.append("</table></div>")}finally{this.c0c&&this.kih()}return c.toString()}B0i(a,b){const c=[];this.p8d(a,b);try{for(a=0;5>a;a++)for(b=0;5>b;b++){const f={},l=this.mse.VZd(a,b,1,1),x=this.cbg(this.roe,this.qm,a,b);f.color=x;const G=this.Jk.$ob(l.Sa(sb.a.cellShading)?l.Xh(sb.a.cellShading):
ml.a.grb,this.qm);f["background-color"]=G;f.overflow="visible";for(let R=0;R<Fq.W7b.length;R++){let fa=null,wa=null,Wa=null;({fOa:fa,Y3a:wa,hpb:Wa}=Vp.$Qa(Fq.zYc[R]));let mb;if(this.OUa){const Kc=uf.Box4ColorHelper.sY({Color:"##T,0,0,0"}),Hc=Kj.a.xi(l,wa,Kc),ie=uf.Box4ColorHelper.xxa(Hc),He=uf.Box4ColorHelper.UL(ie,this.qm);mb=He?uf.Box4ColorHelper.Jna(He):null}else mb=l.sa(wa,ml.a.BHc);const Kb=l.sa(Wa,ml.a.erb),nc=Fq.W7b[R].substring(0,Fq.W7b[R].length-1),oc=l.sa(fa,ml.a.frb),Ic=this.OUa&&re.a("TableBordersLocalRenderingFix");
if(Ic&&!oc||!Ic&&mb.UC===Hb.a.auto){const Kc=this.Jk.QZd(.0277777777777778);f[nc]=String.format("inset {0}px transparent",Kc)}else f[nc]=this.Jk.cZd(Kb,.0277777777777778,mb)}c.push(f)}}finally{this.c0c&&this.kih()}return c}qPc(a,b){this.p8d(a,b);a={};a.background=this.Jk.$ob(this.Jk.c0d(this.scc),this.qm);return a}p8d(a,b){this.scc=this.Wda.M1b(a).mva;this.aSg=this.bA.p1d(b);this.qm=this.Dle.Vfg(b).Pe;this.c0c=this.Otj(this.scc);this.pFg=this.qm.PresetSchemeColorMapping.Background1;this.tSg=this.qm.PresetSchemeColorMapping.Text1;
this.qFg=this.qm.PresetSchemeColorMapping.Background2;this.uSg=this.qm.PresetSchemeColorMapping.Text2;this.c0c&&(this.qm.PresetSchemeColorMapping.Background1=this.qm.PresetSchemeColorMapping.Light1,this.qm.PresetSchemeColorMapping.Text1=this.qm.PresetSchemeColorMapping.Dark1,this.qm.PresetSchemeColorMapping.Background2=this.qm.PresetSchemeColorMapping.Light2,this.qm.PresetSchemeColorMapping.Text2=this.qm.PresetSchemeColorMapping.Dark2);a=this.tse(()=>5,()=>5,()=>this.aSg,()=>null,()=>this.qm,()=>
this.scc);this.mse=this.Gak(a);this.roe=this.Bak(a)}kih(){this.qm.PresetSchemeColorMapping.Background1=this.pFg;this.qm.PresetSchemeColorMapping.Text1=this.tSg;this.qm.PresetSchemeColorMapping.Background2=this.qFg;this.qm.PresetSchemeColorMapping.Text2=this.uSg}Otj(a){if(a.tblBgField&&a.tblBgField.fillField)return!1;if(!a.wholeTblField||!a.wholeTblField.tcStyleField)return!0;a=a.wholeTblField.tcStyleField.fillField;return!a||a.noFillField?!0:!1}cbg(a,b,c,f){let l="black";a&&(l=a.V$f(b,c,f,1,1).GU());
return l}}Fq.W7b=["border-top:","border-left:","border-bottom:","border-right:"];Fq.zYc=[7,5,0,6];Object(e.a)(Fq,"TableStylePreviewGenerator",null,[1130]);class GE extends Wx{constructor(){super()}get Type(){return 6}}Object(e.a)(GE,"TableStyleGalleryButtonProps",Wx,[]);class HE{}HE.Ghk=2147483647;Object(e.a)(HE,"TableStyleUtil",null,[]);class dp{constructor(a,b,c,f,l){this.COd="Clear";this.X5a=null;this.unb=a;this.$5e=c;this.a6e=f;this.yOh=l;this.dFd=b;this.mN=u.AFrameworkApplication.mN;this.gm=
u.AFrameworkApplication.gm}MZb(){}T1h(a,b){this.MZb();const c=this.vZd(),f=c.length;if(!(0>=f)){var l=HE.Ghk,x=null;for(let wa=0;wa<f;wa++){var G=c[wa],R=this.yOh(G);l!==R&&(l=Object.assign(new Mi.a,{Id:"msMoreTableStyles"+R,Title:this.rhj(R),ControlList:[]}),x=Object.assign(new tq.a,{Type:6,Id:"galleryMoreTableStyles"+R,ExternalGalleryId:"TableStylesGallery",Width:dp.Wvh,ElementDimensions:"Size64by48",GalleryItems:[]}),u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up&&this.X5a&&(x.ExternalId=
this.X5a[R.toString()]),Array.add(l.ControlList,x),Array.add(b.MenuSectionList,l),l=R);var fa=this.a6e(G);G=dp.iRe+wa;R=!!u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up;fa=Object.assign(new GE,{Id:G,ExternalId:G,Command:"4171428777",QueryCommand:"2135594455",LabelText:fa?Ka.a.je(fa):"",Alt:R?fa:null,VerticalCenterAlign:"true"});R&&(fa.TableCellStyles=this.Kgg(G,a),fa.TableStyles=this.qPc(G,a));x&&x.GalleryItems.push(fa)}}}R1h(a){const b=Object.assign(new Mi.a,{Id:"msMoreTableStyleCommands",
DisplayMode:"Menu16",ControlsId:"ctrlMoreTableStyleCommands",ControlList:[]}),c=Object.assign(new Ef.a,{Id:"fseaClearTableFormatting",Command:"3835123874",LabelText:Ka.a.je(this.COd),Alt:Ka.a.je(this.COd),Image16by16:this.gm,Image16by16Class:vo.getImageClassWithCluster(this.mN,dp.Dpi),KeyTip:CommonUIStrings.l_ClearTableFormattingKeytip});Array.add(b.ControlList,c);Array.add(a.MenuSectionList,b)}Fzi(a,b){this.MZb();const c=a[ai.a.SourceControlId],f=this.kld(c,b);if(f){var l=this.unb.x3d(b);l=l?this.$5e(l):
null;var x=this.a6e(f),G=this.$5e(f);a[gm.a.Alt]=x;a[gm.a.On]=G===l;u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up?(b=Object.assign(new GE,{Id:c,ExternalId:c,Command:"4171428777",QueryCommand:"2135594455",TableCellStyles:this.Kgg(c,b),TableStyles:this.qPc(c,b),Alt:x}),a[gm.a.GalleryButtonProps]=b):(b=this.dFd.qml(f,b),a[gm.a.InnerHTML]=b)}else a[gm.a.InnerHTML]=null,a[gm.a.Alt]=null,a[gm.a.On]=!1,a[gm.a.GalleryButtonProps]=null}Kgg(a,b){this.MZb();return(a=this.kld(a,b))?this.dFd.B0i(a,
b):null}qPc(a,b){this.MZb();return(a=this.kld(a,b))?this.dFd.qPc(a,b):null}MAi(a,b){u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.Up?a.MenuItems=this.ddg(b):a.PopulationXML=lj.l(this.ddg(b))}ddg(a){const b=Object.assign(new wj.a,{Id:"menuMoreTableStyles",MenuSectionList:[]});this.T1h(a,b);this.R1h(b);return b}kld(a,b){return a?a.startsWith(dp.iRe)?this.Dgj(parseInt(a.substr(dp.iRe.length))):this.qWk(parseInt(a.substr(dp.oml.length)),b):null}}dp.iRe="buttonTableStyleMenu";dp.oml="buttonTableStyleRibbon";
dp.Wvh=7;dp.Dpi="ClearTableStyle_16x16x32";Object(e.a)(dp,"ATableStyleRibbonControl",null,[1131]);class CN extends dp{constructor(a,b,c,f,l){super(a,l,Object(C.a)(f,f.Bgj,"getStyleIdFromStyleContainer"),Object(C.a)(f,f.Cgj,"getStyleNameFromStyleContainer"),Object(C.a)(f,f.vgj,"getStyleCatogeryFromStyleContainer"));this.bA=a;this.Wda=f;this.COd=ResourceStrings.L_ClearTableStyle;this.mN=sf.a.fgc;this.gm=c.hk(sf.a.Kad);this.wyk()}rhj(a){switch(a){case 1:return ResourceStrings.L_Themed;case 2:return ResourceStrings.L_Light;
case 3:return ResourceStrings.L_Medium;case 4:return ResourceStrings.L_Dark;case 5:return ResourceStrings.L_Customize;default:return ResourceStrings.L_Customize}}qWk(a,b){let c=null;(b=this.bA.U1b(b))&&(c=this.Wda.Ngg(b.styleIdField));return c?this.Wda.sgj(c.$Fg,c.kKg-c.kKg%dp.Wvh+a):this.Wda.dub(a)}vZd(){return this.Wda.vZd()}Dgj(a){return this.Wda.dub(a)}MZb(){this.Wda.t1f()}wyk(){this.X5a={};this.X5a["1"]="TableStylesBestMatch";this.X5a["2"]="TableStylesLight";this.X5a["3"]="TableStylesMedium";
this.X5a["4"]="TableStylesDark"}}Object(e.a)(CN,"TableStyleRibbonControls",dp,[]);class DN{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc){this.MD=this.QVa=null;this.ia=a;this.Af=b;this.Ha=c;this.Fa=f;this.ra=l;this.yv=x;this.Zd=G;this.O7b=R;this.Mb=fa;this.Ea=wa;this.Ee=Wa;this.Jda=Kb;this.tc=nc;this.Uda=oc;this.bWa=Kc;this.Vz=mb;Ic.execute(ie=>{this.QVa=ie});this.Ha.uP&&Hc.execute(ie=>{this.MD=ie})}get re(){return this.Zd.instance}get $E(){return this.O7b.value}ub(){this.ia.pa(ba.a.ZJf,
sc.a.application,Object(C.a)(this,this.jmj,"handleBeginEditShapeTextByF2"),4);this.ia.pa(ba.a.ZUb,sc.a.application,Object(C.a)(this,this.imj,"handleBeginEditShapeText"),4);this.ia.pa(ba.a.cOa,Bb.a.view,Object(C.a)(this,this.kmj,"handleBeginEditShapeTextForShapeMoniker"),5)}xe(){const a=this.Fa.Dc(Yb.a.Bg),b=this.Fa.Dc(zi.a.c2);a.bindAction(A.KeyInputManager.Na(w.a.$pc,0),ba.a.ZJf);a.bindAction(A.KeyInputManager.Na(w.a.lq,0),ba.a.ZUb);b.bindAction(A.KeyInputManager.Na(w.a.$pc,0),ba.a.Mdi)}imj(a,b,
c){if(this.Uda&&this.Uda.isVisible())return Aa.a.J(40735957,820,50,"The slideless pane is shown, hide and replace it with new slide on default master by VK_Enter."),this.Uda.hide(2,!0),32;if(1===c&&this.ra.kSa())return 2;a=this.ra.rq();if(!a)return 16;b=Object(ua.a)(4,a.P5i(re.a("EnableRetrieveFirstIcon")));if(a.get_smartArtModelId())a=this.Ea.nr(a);else{if(a.Pf&&b)return this.ia.La(ba.a.ZYa,c,b);if(a.Jf){var f=this.Ea.Ow(a);if(0<f.length)return this.ia.La(ba.a.ZYa,c,f[0])}else if(this.Ha.uP&&1===
a.mediaType&&!a.Og&&this.MD)return(f=this.MD.FK(a))&&f.setFocusOnPlayer(),32}return this.ia.La(ba.a.cOa,c,new jn.a(a,!1))}jmj(a,b,c){a=this.ra.rq();if(!a)return 16;a.get_smartArtModelId()&&(a=this.Ea.nr(a));return this.ia.La(ba.a.cOa,c,new jn.a(a,!1))}kmj(a,b,c,f,l){if(!l||!Object(Ma.a)(jn.a,l))return Aa.a.J(8956046,820,10,"Invalid ActionData"),8;a=l.shapeNode;if(!a||!(a.isEditable&&!a.gea||a.Uq)||this.Af.Zc(a))return 16;if(1===c)return 32;a.qd&&(c=this.tc.iN(a),c=!!c&&c.Ap(),Aa.a.J(41007122,820,
50,"Entering table edit mode, isComplexTable:{0}",c),this.ia.processAction(ba.a.G4a,2));if(a.Uq){if(this.$E&&this.re)return l=this.$E.m2(a),this.re.notifyAgave(l.id,11),32;Aa.a.J(18989144,820,10,"AppForOffice package should have already been loaded.");return 8}c=a.sg(this.Mb.Ma);if(!c)return 16;this.QVa&&this.QVa.$Wd(a,!0);this.bWa&&this.Ha.G1k&&this.bWa.ping();Nc.a.Eb&&(Nc.a.Eb.actionName="BeginEditShapeText",(a.Jf||a.Og)&&Qn(a));if(this.Vz&&a.Pf&&c.NK())Nc.a.qk(si.a.EAc,"false"),this.Ee.Cbh(new Bx.a(a));
else{this.Fa.Bf(Yb.a.Bg,l.hal);this.yv.Yv();c.IOe();if(a.qd&&l.TEc&&(c=this.tc.iN(a))&&c.Ap())return(a=this.Jda.FXd(l.TEc.clientPoint,c,null,null))?(c=a.oc(this.Mb.Ma),this.Mb.J5(l.TEc.clientPoint,c,a,this.Mb,!1,!1,0),32):8;a.Og&&(c=this.Ea.ds(a))&&(c=c.sg(this.Mb.Ma))&&c.Nd&&c.Nd.nHb(!0);this.Mb.n0k(a,l.TEc)}return 32}}Object(e.a)(DN,"TextEditorLaunchingActor",null,[229]);class IE{constructor(a,b,c,f,l,x,G,R){this.ia=a;this.Fa=b;this.Ea=c;this.xv=f;this.Af=l;this.ra=x;this.BUa=G;this.Hh=R}ub(){this.ia.ya(ba.a.gmi,
sc.a.application,Object(C.a)(this,this.vmj,"handleChangeCaseMenu"));this.ia.ya(ba.a.gBe,sc.a.application,Object(C.a)(this,this.Spj,"handlePowerPointInsertHyperlink"));this.ia.pa(ba.a.clearFormatting,sc.a.application,Object(C.a)(this,this.Gmj,"handleClearFormatting"),4)}xe(){this.Fa.Dc(Yb.a.LP).bindAction(A.KeyInputManager.Na(w.a.NO,2),ba.a.clearFormatting)}vmj(){var a=this.ra.Oa.kb;return a&&(a=a.Ua)&&(a.contextId===Bb.a.Of||a.contextId===Bb.a.textRange)?32:this.KFh(!0)?32:8}Spj(a,b,c,f,l){return(a=
this.ra.Oa.kb)&&this.ra.LIj()?8:!a||this.ra.USa()&&!IE.c6b(a)?8:this.ia.La(ba.a.insertHyperlink,c,l)}Gmj(a,b,c){if(!this.KFh(!1))return 16;a=this.ra.Oa.kb;if(!a)return 8;2===c&&this.SAa(a);return 32}SAa(a){Aa.a.J(593892321,820,50,"TextOperationsActor: Clear Formatting Triggered");var b=this.ra.Yd();let c;if((c=this.cfj(b))&&c.length){if(1===c.length){b=a.Ua;if(!b){Aa.a.J(594614167,820,50,"TextOperationsActor: ClearCharacterFormatting - Could not create GraphNodeContext");return}if(b.contextId===Bb.a.Of){this.oai(b,
c[0]);return}if(b.contextId===Bb.a.textRange||b.contextId===Bb.a.paragraph){this.qai(a,c);return}}this.pai(c)}else b.length?this.RFc(b)?Aa.a.J(593892317,820,50,"ClearFormatting on table(s)"):Aa.a.J(593892315,820,50,"ClearFormatting attempted on non table and non text formattable shape"):Aa.a.J(593892319,820,50,"ClearFormatting triggered when nothing selected")}cfj(a){a=this.Ea.KZ(a,!1);const b=[];let c=!0;for(const f of a)f.Jf&&(c=!1,1!==a.length&&this.X9k(f,a)?b.push.apply(b,this.peh(f,a,!1)):b.push.apply(b,
this.peh(f,a,!0)));return c?a:b}X9k(a,b){for(const c of b)if(c&&!c.Jf&&(b=c.ds(),!b||a!==b))return!1;return!0}peh(a,b,c=!1){const f=[];for(const l of b)if(l!==a)f.push(l);else if(c){const x=this.Ea.KZ(this.ra.wO(b),!1);f.push.apply(f,x)}return f}pai(a){this.xv.S5a(b=>{this.sKe(b,0,this.Vej(b))},a)}qai(a,b){const c=a.Ua,f=this.Zbg(c,b[0]);if(c.contextId===Bb.a.paragraph||-1!==f){var l=this.Thj(a);this.xv.S5a(x=>{this.sKe(x,f,l)},b)}}oai(a,b){const c=this.BUa.w1b(a);if(c){var f=c.Ua,l=this.Zbg(a,b)+
f.Qa;this.xv.S5a(x=>{this.sKe(x,l,f.Kb-f.Qa)},[b])}}sKe(a,b,c){a.me(sb.a.clearFormatting,!0);a.me(sb.a.bSe,b);a.me(sb.a.aSe,c)}Zbg(a,b){let c=0,f=!1;if(!this.Hh.Vd(a.node))return-1;const l=a.node;this.Ea.kJ(b,x=>{x===l?f=!0:f||(c+=this.Hh.textLength(x)+1)});return f?a.contextId===Bb.a.paragraph||a.contextId===Bb.a.Of?c:c+a.Qa:-1}Thj(a){let b=0;for(let c=0;c<a.length;c++){const f=a.ga(c);f.contextId===Bb.a.textRange?b+=f.Kb-f.Qa:f.contextId===Bb.a.paragraph?b+=this.Hh.textLength(f.node)+1:f.contextId===
Bb.a.endOfParagraph&&b++}return b}Vej(a){let b=0;if(a.fC)return 1;this.Ea.kJ(a,c=>{b+=this.Hh.textLength(c)+1});return b}RFc(a){for(const b of a)if(b.qd)return!0;return!1}KFh(a){const b=this.ra.Yd();if(!b||1>b.length)return!1;const c=this.ra.Yo();if(c&&!a&&1===b.length)return!1;a=this.Ea.KZ(b);return 1>a.length&&!c||this.Af.dC(a)||this.Af.dC([c])?!1:!0}static c6b(a){if(1===a.length)return!0;if(2===a.length){const b=a.Ua;a=a.ga(1);return!(!cb.SelectionEditor.Vj(b)||!cb.SelectionEditor.Ll(a)||b.node!==
a.node)}return!1}}Object(e.a)(IE,"TextOperationsActor",null,[229]);class JE{iTd(a,b,c){return 1===c?32:JE.JGi(b.node)}static JGi(a){const b=new nb.GraphIterator;b.set(a);b.Mu();if(Tf.b(b))return 2;a=new Id.GraphTransaction(7);a.iy(b);b.Ii();a.dispose();return 32}}Object(e.a)(JE,"DeleteOutlineLevelContentStrategy",null,[]);class cl{constructor(){this.rMh=new JE}ub(a){const b=Object(C.a)(this.MHc,this.MHc.jTd,"deleteView"),c=Object(C.a)(this,this.iTd,"deleteOutlineLevelContent"),f=Object(C.a)(this.JXf,
this.JXf.KGi,"deleteParagraphContent");a.ya(E.a.backspace,Bb.a.Of,f);a.ya(E.a.backspace,Bb.a.textRange,f);a.ya(E.a.backspace,Bb.a.endOfParagraph,Kd.ActionManager.$u);a.ya(E.a.backspace,Bb.a.outline,c);a.ya(E.a.backspace,Bb.a.view,b);a.he(E.a.backspace,1124);a.ya(E.a.BBa,Bb.a.Of,Kd.ActionManager.$u);a.ya(E.a.BBa,Bb.a.textRange,f);a.ya(E.a.BBa,Bb.a.endOfParagraph,Kd.ActionManager.$u);a.ya(E.a.BBa,Bb.a.outline,c);a.ya(E.a.BBa,Bb.a.view,b);a.pa(E.a.Wqb,Bb.a.view,b,1124);a.ya(E.a.wK,Bb.a.Of,f);a.ya(E.a.wK,
Bb.a.textRange,f);a.ya(E.a.wK,Bb.a.endOfParagraph,Kd.ActionManager.$u);a.ya(E.a.wK,Bb.a.outline,c);a.ya(E.a.wK,Bb.a.view,b);a.he(E.a.wK,1124);a.pa(E.a.cYb,Bb.a.view,b,1124);a.pa(E.a.ABa,Bb.a.view,cl.ABa,1028);a.ya(E.a.mPa,Bb.a.view,Object(C.a)(this.MHc,this.MHc.mPa,"deleteFromInputEvent"));a.ya(E.a.mPa,Bb.a.textRange,f);a.he(E.a.mPa,1028)}iTd(a,b,c,f,l){return this.rMh.iTd(a,b,c,f,l)}static get Ql(){return xy.PageNavigator.instance}static get Nh(){return cl.Ai||(cl.Ai=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get iJ(){return cl.NH||
(cl.NH=fb.a.instance.resolve("Box4.Pages.IPageContentEditor"))}static get IGi(){return cl.g0a||(cl.g0a=fb.a.instance.resolve("Box4.Actors.IDeleteOutlineElementNodeStrategy"))}static get hB(){return cl.Cx||(cl.Cx=fb.a.instance.resolve("Box4.IOutlineEditor"))}static get qe(){return cl.Yc||(cl.Yc=fb.a.instance.qb("Box4.IFeatureHelper"))}static ABa(a,b,c,f,l){f=b.view;if(!f.Gb||!f.Gb.Oa.kb||cb.SelectionEditor.Uw(f.Gb.Oa.kb))return 8;if(1===c)return 32;c=f.Gb.Oa;const x=c.kb;var G=x.Ua;let R=!1;var fa=
null,wa=!1;if(c.MG)if(Tf.a(G))R=!0;else{if(G.contextId===Bb.a.outline&&1===c.length){for(a=nb.GraphIterator.mb(G.node);a.Ji();)a.Ii();cl.hB.eZ(a,!0);Xb.OutlineElementNavigator.ri(a);a=rd.SelectionFactory.Mg(a.currentNode,0);f.Gb.setSelection(a);return 32}var Wa=G.node;fa=null;if($t.c(G)){var mb=Wa.oc(f.Ma);mb&&(mb=mb.iGl)&&0<=mb.width&&0<=mb.height&&(fa=new Qw.a(Re.a.Ff(mb.x,0),Re.a.Ff(mb.y,1)));fa||(fa=nq.b(Wa))}else fa=nq.b(G.node);G=nb.GraphIterator.mb(G.node);G.Mu();cl.Ql.GIa(G);Wa=cl.iJ.GXb(G);
nq.c(Wa,fa.x,fa.y);cl.hB.eZ(G,!0);fa=rd.SelectionFactory.rj(Wa,!0)}else if(1===c.length){wa=c.last;G=qd.a.ROa(wa);if(cl.qe&&cl.qe.isFeatureEnabled(33)&&Df.ContextSetEditor.instance.OOe(G).returnValue)return 2;wa=wa.Ve;wa=!Tf.a(wa)&&!c.vl&&(cb.SelectionEditor.Ll(wa)||yb.ParagraphReader.im(wa)||cb.SelectionEditor.jW(wa))}wa&&(wa=cb.SelectionEditor.Hl(x,!1,!1,void 0,cl.IGi.dNe(null,1)),f.Gb.setSelection(wa),u.AFrameworkApplication.Ta.ki(b,E.a.cB,2,!1,null,l),fa=f.Gb.Oa.kb,f.Gb.setSelection(x));l||(l=
new D.DictionaryPropertySet);l.setValue(Oc.a.urb,!0);u.AFrameworkApplication.Ta.ki(b,E.a.wK,2,!0,null,l);if(fa&&fa.Ua.isValid)return f.Gb.setSelection(fa),32;c.MG&&(R||go.instance.uxb(a,b.fE,f));cb.SelectionEditor.Uw(f.Gb.Oa.kb)||u.AFrameworkApplication.Ta.ki(b,E.a.cB,2,!1,null,l);return 32}}cl.NH=null;cl.Ai=null;cl.g0a=null;cl.Cx=null;cl.Yc=null;Object(e.a)(cl,"ADeleteActor",null,[]);class Nk{get Yi(){return ed.a.instance}KGi(a,b,c,f,l){if(1===c)return 32;f=a===E.a.backspace||a===E.a.mPa;if(Nk.Sq()&&
Nk.Sq().instance&&Nk.Sq().instance.lW(b))return 4;c=b.node;var x=b.Qa;b=b.Kb;const G=yb.ParagraphReader.text(c),R=G.length;let fa=!1;if(x===b){if(f&&!x||!f&&x===R)return 2;f?(H.a.instance.ga(14)&&({cp:x,returnValue:fa}=this.Yi.Zfk(c,x)),fa||(x--,Ka.a.Xw(G,x)&&x--),a=E.a.KAa):(H.a.instance.ga(14)&&({cp:b,returnValue:fa}=this.Yi.Yfk(c,b)),fa||(b++,Ka.a.Xw(G,b)&&b++),a=E.a.lPa)}x=x===b?Mc.a.ak(c,x):Mc.a.createTextRange(c,x,b);f=new Id.GraphTransaction(15);f.fd=a;f.gd(c);c=Object(Ma.a)(Bs,l)&&l.W_b;if(Nk.Qf.ag&&
Nk.Qf.By&&!c){c=Nk.Qf.cpb();try{let wa;if(({type:wa}=null.Ghg()).returnValue){const Wa=Object(ua.a)(10,l);if(Wa&&Wa.sa(As.a.Iug,!1)||1===wa)Nk.Qf.o6g=wa}l=0;for(let Wa=null.length-1;0<=Wa;--Wa){let mb;const Kb=({kAg:mb}=null.getContext(Wa)).returnValue;mb?(Nk.hyperlinkEditor.$Cb(Kb,null),l+=0,Nk.H5.BQd=b+l):this.KXf(Kb)}}finally{c&&c.dispose()}}else this.KXf(x);f.dispose();return 32}static get Qf(){return Nk.Xc||(Nk.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get H5(){return Nk.Ro||
(Nk.Ro=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get poc(){return Nk.hD||(Nk.hD=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get hyperlinkEditor(){return Nk.jn||(Nk.jn=fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static Sq(){return Nk.xm||(Nk.xm=fb.a.instance.Ka("Box4.IExternalSelectionManager"))}}Nk.Xc=null;Nk.Ro=null;Nk.hD=null;Nk.jn=null;Nk.xm=null;Object(e.a)(Nk,"ADeleteParagraphContentStrategy",null,[]);class Yv extends Nk{constructor(){super()}KXf(a){Yv.characterPropertiesEditor.replaceTextRange(a,
"")}static get characterPropertiesEditor(){return Yv.xjh||(Yv.xjh=fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}}Yv.xjh=null;Object(e.a)(Yv,"DeleteParagraphContentStrategy",Nk,[]);var VQ=d(464);class EN{constructor(a,b,c,f){this.vWe=a;this.rJ=c;this.kd=f;this.actionId=b}}Object(e.a)(EN,"DeleteActionData",null,[]);class cf{get dqi(){return cf.y_e||(cf.y_e=fb.a.instance.resolve("Box4.Clipboard.IClipboardOperationCutStrategy"))}Epl(a){return!cb.SelectionEditor.Vj(a)}oej(a,b,c){if(!a)return null;
if(!c)return a;b=cb.SelectionEditor.iQa(a,!1,!b,!0,!0,!0);return rd.SelectionFactory.bN(a,b.Ua,!1)}jTd(a,b,c,f,l){if(1===c)return 32;var x=!1;a===E.a.cYb&&(a=E.a.wK,x=!0);a===E.a.Wqb&&(a=E.a.backspace,x=!0);a===E.a.BBa&&(b=new gC.a(Cb.App.Hb.Hd.nn));var G=b;if(!G.view.Lh)return 2;var R=G.view.Gb;qf.GrippersManager.instance.setVisibility(!1);G=a===E.a.wK;R=0<R.Oa.length?R.Oa.ga(0):null;x=this.oej(R,G,x);return this.SXf(a,b,c,f,l,x,G)}SXf(a,b,c,f,l,x,G){const R=b.view,fa=R.Gb;var wa=l,Wa=l;a===E.a.BBa&&
(Wa=wa=null,x=new Ua.Selection(l,!0));if(!x)return 32;const mb=new EN(b,a,f,Wa),Kb=this.P$k(wa,G,fa);wa=!1;if(({qSa:wa}=this.$qh(a,Kb,fa)).returnValue)return a=wa?E.a.zBa:E.a.deleteRow,u.AFrameworkApplication.Ta.ki(b,a,c,!1,f,l);let nc;G?Me.a.mark(nc=5009):Me.a.mark(nc=5011);c=new Id.GraphTransaction(15);c.fd=a;c.gd(R.vg);wa=null;let oc=({UZk:wa}=this.h2i(a,l,fa,x)).returnValue;Wa=null;({Njd:Wa}=Df.ContextSetEditor.instance.OOe(oc)).returnValue&&(oc=Wa);if(!oc)return c.dispose(),32;this.izh(oc);const Ic=
this.IZi(x,G);let Kc=null;G?Kc=new $q(x):Ic&&(Kc=new $q(Ic));Wa=!1;if(cb.SelectionEditor.Pg(oc)){if(a===E.a.mPa)return 2;const Hc=Jh.kOc(R.vg,Kb);cf.kS.LF(()=>{this.BGi(b,f,l,oc,G,Kc,x,Hc,fa,Kb,mb,Ic)},"DeleteViewStrategy:DeleteAtInsertionPointContext")}else cf.Qf.ag&&cf.Qf.By?(this.Dpl(a,R.vg,oc,G,x,fa,Kb,mb,Kc),Wa=!0):Wa=this.y6g(a,R.vg,oc,fa,Kb,mb,Kc,wa);cf.TUi(fa);this.Ohh(oc);c.dispose();Me.a.mark(nc+1);return a===E.a.BBa?Wa?32:8:32}mPa(a,b,c,f,l){return b.view.Lh?this.SXf(a,b,c,f,null,l,!1):
2}y6g(a,b,c,f,l,x,G,R){b=Jh.kOc(b,l);this.Epl(c)&&b.Kna(c);a=cf.Tc.Kp(a);a.properties.$("CountOfParagraphsDeleted",cf.O4.zQd(c).toString());c=cf.eJi(cf.T$k,Object(C.a)(this,this.S$k,"shouldDispatchNoSpecialize"),c,f,l,b,x,G,R);a.end();return c}Dpl(a,b,c,f,l,x,G,R,fa){var wa=0,Wa=null;const mb=Df.ContextSetEditor.instance.uA(c),Kb=mb[mb.length-1];if(Kb.contextId===Bb.a.paragraph||Kb.contextId===Bb.a.endOfParagraph){var nc=nb.GraphIterator.mb(Kb.node);nc.af();Xb.OutlineElementNavigator.Ke(nc);Xb.OutlineElementNavigator.eJ(nc,
!0,!1)&&(Wa=Xb.OutlineElementNavigator.ri(nc))&&(wa=cf.O4.textLength(Wa))}else wa=cf.O4.textLength(Kb.node)-Kb.Kb;if((nc=Object(ua.a)(10,R.kd))&&nc.sa(As.a.Iug,!1))this.x6g(a,b,c,x,G,R,fa,!1);else{nc=cf.Qf.cpb();try{this.x6g(a,b,c,x,G,R,fa,!0)}finally{nc&&nc.dispose()}}if(f){if(c.Rw){a=mb.length-1;do l=mb[a],a--;while(!l.node.isConnected&&0<=a)}else l=c;if(!cf.O4.Vd(l.node))return;switch(Kb.contextId){case Bb.a.paragraph:case Bb.a.endOfParagraph:wa=Wa&&Wa.isConnected?0:wa;break;case Bb.a.Of:case Bb.a.textRange:break;
default:wa=0}wa=rd.SelectionFactory.Mg(l.node,cf.O4.textLength(l.node)-wa);l.n3a===wa.Ua.Qa&&(wa.Ua.hS=l.hS)}else{wa=l.Ua.node;if(!cf.O4.Vd(wa))return;Wa=l.Ua.contextId===Bb.a.paragraph?0:l.Ua.contextId===Bb.a.endOfParagraph?cf.O4.textLength(wa):l.Ua.Qa;wa=rd.SelectionFactory.Mg(wa,Wa)}qd.a.instance.setSelection(wa)}x6g(a,b,c,f,l,x,G,R){this.ZXi(f,c);!({type:fa}=null.Ghg()).returnValue||R&&1!==fa||(cf.Qf.o6g=fa);for(c=null.length-1;0<=c;--c){var fa=({kAg:R}=null.getContext(c)).returnValue;R?cf.hyperlinkEditor.$Cb(fa,
2):this.y6g(a,b,fa,f,l,x,G,null)}}ZXi(a,b){if(Object(Ma.a)(VQ.a,b))for(a=oi.Nra(a.Oa,!0),b=0;b<a.length&&a.getContext(b).contextId!==Bb.a.table;b++);}h2i(a,b,c,f){a===E.a.BBa?(c=Fa.a.WOa(b),a=zl.SelectionReferenceFactory.instance.Oqa()):(a=null,c=1===c.Oa.length?qd.a.ROa(f):c.Kj);return{returnValue:c,UZk:a}}Xki(a){return!a.Qk||a.contextId!==Bb.a.paragraph||!cf.O4.Vd(a.node)||cf.Qf.ag&&cf.Qf.By||H.a.instance.ga(14)&&cf.Yi.QUc(a)?!1:!0}izh(a){if(a.Rw)for(let b=0;b<a.length;b++)this.izh(a.getContext(b));
else this.Xki(a)&&(a.node.TDc=!0)}Ohh(a){if(a.Rw)for(let b=0;b<a.length;b++)this.Ohh(a.getContext(b));else a.Qk&&(a=a.node)&&cf.O4.Vd(a)&&(a.TDc=!1)}BGi(a,b,c,f,l,x,G,R,fa,wa,Wa,mb){const Kb=new nb.GraphIterator,nc=f.node;Kb.set(nc);Kb.af();cb.SelectionEditor.eC(Kb.currentNode,f,l)?this.FGi(a,b,c,f,l,x,G,R,fa,Wa,mb,Kb,nc):cf.GGi(f,l,x,G,R,fa,wa,Wa)}mQc(a,b,c,f){return!a&&Ib.ListReader.kk(b)?(f=cf.Pma(b,c),{returnValue:!0,response:f}):{returnValue:!1,response:f}}goj(a,b,c,f,l,x){return H.a.instance.ga(65)&&
!a&&0<ae.OutlineElementReader.otb(b)?(x=u.AFrameworkApplication.Ta.ki(c,E.a.keh,2,!1,f,l),{returnValue:!0,response:x}):{returnValue:!1,response:x}}ssj(a,b,c,f,l,x){return H.a.instance.ga(54)&&!a&&0<ae.OutlineElementReader.a7a(b)?(x=u.AFrameworkApplication.Ta.ki(c,E.a.UPk,2,!1,f,l),{returnValue:!0,response:x}):{returnValue:!1,response:x}}Zpj(a,b,c,f,l,x){return H.a.instance.ga(80)&&!a&&cf.hv.Mpb(b)?(x=u.AFrameworkApplication.Ta.ki(c,E.a.lz,2,!1,f,l),{returnValue:!0,response:x}):{returnValue:!1,response:x}}Ilj(a,
b,c,f,l,x,G,R,fa,wa,Wa){const mb=new tn.a;mb.Pc(b);if(Xb.OutlineElementNavigator.iHa(mb,!1,!a,!1)){Wa=!0;wa=32;const Kb=new nb.GraphIterator;Kb.Pc(mb);Xb.OutlineElementNavigator.ri(mb);x&&f&&cb.SelectionEditor.jW(f.Ua)?(c.Kna(l),cf.Nh.BPk(b.currentNode)):mb.currentNode.iW?(H.a.instance.ga(68)&&c.Kna(l),Xb.OutlineElementNavigator.Ke(mb),mb.Ii()):H.a.instance.ga(66)&&a&&x?cf.Yi.Qxg(R)&&!({kxa:Wa}=this.u9g(a,R,mb.currentNode,f,Wa)).returnValue&&(c.Kna(l),cf.jo.Pma(b),b.Ii()):Jd.TableReader.Vp(mb)?(c.Kna(l),
this.RXf&&({response:wa,returnValue:Wa}=this.RXf.eFl(a,Kb,b,mb,G,fa,wa))):cf.O4.Vd(mb.currentNode)&&(({kxa:Wa}=this.u9g(a,R,mb.currentNode,f,Wa)).returnValue||this.LXf&&this.LXf.CGi(a,c,l,b,R,mb));return{returnValue:!0,response:wa,kxa:Wa}}return{returnValue:!1,response:wa,kxa:Wa}}u9g(a,b,c,f,l){return cf.Qf.ag&&cf.Qf.By&&(a=(a?b:c).Ra.last,b=u.AFrameworkApplication.userName,!a.uo||a.uo.authorName!==b)?(f&&(qd.a.instance.setSelection(f),l=!1),{returnValue:!0,kxa:l}):{returnValue:!1,kxa:l}}Vrj(a,b,
c,f,l,x,G,R){return H.a.instance.ga(67)&&ae.OutlineElementReader.Evg(b,a)?(Se.isInTableCell(b)&&(Qd.returnToContainingCell(b),Se.isEmpty(b)&&c.Kna(f),{Sal:a,returnValue:R}=cf.Gfk(b,G,a,l,x),a||(R=2)),{returnValue:!0,response:R}):{returnValue:!1,response:R}}yoj(a,b,c,f,l,x,G,R){ae.OutlineElementReader.Evg(b,a)||({response:G,kxa:R}=cf.TJi(c,f,a,x,l,G,R));return{returnValue:!1,response:G,kxa:R}}FGi(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){let nc=!1,oc=2;const Ic=cf.O4.isEmpty(mb),Kc=mb.currentNode;Xb.OutlineElementNavigator.Ke(mb);
({response:oc}=this.mQc(l,mb,wa,oc)).returnValue||({response:oc}=this.goj(l,mb,a,b,c,oc)).returnValue||({response:oc}=this.ssj(l,mb,a,b,c,oc)).returnValue||({response:oc}=this.Zpj(l,mb,a,b,c,oc)).returnValue||({response:oc,kxa:nc}=this.Ilj(l,mb,R,Wa,f,Ic,Kc,Kb,fa,oc,nc)).returnValue||({response:oc}=this.Vrj(l,mb,R,f,fa,wa,Kc,oc)).returnValue||({response:oc,kxa:nc}=this.yoj(l,mb,b,c,R,G,oc,nc));cf.iXg(R,32===oc);nc&&cf.hU(fa,x)}P$k(a,b,c){return a&&a.Sa(Oc.a.urb)?this.dqi.wqh()||a.getValue(Oc.a.urb)?
!a.sa(Oc.a.urb,!1):this.X$f(!1,c):this.X$f(b,c)}$qh(){return{returnValue:!1,qSa:!1}}static get characterPropertiesEditor(){return cf.Yg||(cf.Yg=fb.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}static get Tf(){return cf.Sg||(cf.Sg=fb.a.instance.resolve("Box4.List.IListReader"))}static get O4(){return cf.ir||(cf.ir=fb.a.instance.resolve("Box4.IParagraphReader"))}static get hyperlinkEditor(){return cf.jn||(cf.jn=fb.a.instance.resolve("Box4.IHyperlinkEditor"))}static get jo(){return cf.Po||(cf.Po=
fb.a.instance.resolve("Box4.List.IListEditor"))}static get Nh(){return cf.Eif||(cf.Eif=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}static get vH(){return qj.a.instance}static get hv(){return nv.a.Htb}static get Qf(){return cf.Xc||(cf.Xc=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get H5(){return cf.Ro||(cf.Ro=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance)}static get poc(){return cf.hD||(cf.hD=fb.a.instance.resolve("Box4.TrackChange.ITrackChangeReaderFactory").instance)}static get Tc(){return rb.a.instance}static get Yi(){return ed.a.instance}static get Jt(){return cf.bD||
(cf.bD=fb.a.instance.resolve("Box4.IHyperlinkStrategy"))}static get kS(){return qc.a.instance}static TUi(a){if(1===a.Oa.length&&(a=a.Oa.ga(0),cb.SelectionEditor.Uw(a))){var b=a.Ua;a=b.node;b=b.Qa;var c=cf.O4.text(a);b<c.length&&0<b&&" "===c.charAt(b-1)&&" "===c.charAt(b)&&cf.characterPropertiesEditor.replaceTextRange(Mc.a.createTextRange(a,b-1,b),"\u00a0")}}static rdi(a,b){if(!b.hyperlink.$vb){const c=new Id.GraphTransaction(15);try{c.gd(a.node),cf.Jt.xO(a,b)}finally{c&&c.dispose()}}}static Pma(a,
b){a=cf.Tf.Pw(a).JUc?E.a.lR:E.a.KO;return u.AFrameworkApplication.Ta.ki(b.vWe,a,2,!1,b.rJ,b.kd)}static TJi(a,b,c,f,l,x,G){if(c=cb.SelectionEditor.iQa(f,!1,!c,!1,!1,!0)){f=rd.SelectionFactory.bN(f,c.Ua);x=32;for(c=0;c<f.length;++c){l.Kna(f.ga(c));const R=u.AFrameworkApplication.Ta.ki(f.ga(c),E.a.wK,2,!0,a,b);2!==R&&(x=R)}32===x&&(G=!0)}return{response:x,kxa:G}}static eJi(a,b,c,f,l,x,G,R,fa){let wa=!1;a(c)?(wa=cf.XTd(c,!0,f,l,x,G))&&cf.rKa(R,f,fa):b(c)?(wa=cf.XTd(c,!1,f,l,x,G))&&cf.rKa(R,f,fa):(x.normalize(),
cf.rKa(R,f,fa));return wa}static rKa(a,b,c){c&&c.hU()||cf.hU(b,a)}static XTd(a,b,c,f,l,x){f||bj.OutlineReader.Jja(a)||(c=cf.htl(c))&&l.T7k(c);a=32===u.AFrameworkApplication.Ta.ki(a,x.actionId,2,b,x.rJ,x.kd);cf.iXg(l,a);return a}static iXg(a,b){b?a.normalize():a.cancel()}static hU(a,b){b&&(b=b.restore())&&a.setSelection(b)}static GGi(a,b,c,f,l,x,G,R){let fa;!b&&({y3b:fa}=cf.Jt.l9a(a)).returnValue?(c=new $q(f),cf.rdi(a,fa),l.normalize(),cf.hU(x,c)):cf.XTd(a,!1,x,G,l,R)&&(b&&cf.Qf.ag&&cf.Qf.By?(b=cf.H5.BQd)?
(x.setSelection(rd.SelectionFactory.Mg(a.node,b)),cf.H5.BQd=null):cf.hU(x,c):cf.hU(x,c))}static Gfk(a,b,c,f,l){let x,G=2;x=!0;if(Se.isEmpty(a)){const R=Qd.getContainingTable(a),fa=Jd.TableReader.jk(R),wa=Jd.TableReader.wi(R);1===fa&&1===wa?(G=u.AFrameworkApplication.Ta.ki(Mc.a.create(R),E.a.E4a,2,!1,l.rJ,l.kd),f.setSelection(rd.SelectionFactory.Mg(b,0)),x=!1):1===fa?G=u.AFrameworkApplication.Ta.ki(l.vWe,E.a.zBa,2,!1,l.rJ,l.kd):(b=Se.isEmptyIncludingTheRestOfTheRow(a),Se.isFirstCellInRow(a)&&b?G=u.AFrameworkApplication.Ta.ki(l.vWe,
E.a.deleteRow,2,!1,l.rJ,l.kd):!c&&b&&(G=32,a=cb.SelectionEditor.Gra(f.Oa.kb,!1,!1,!1,!0),f.setSelection(a),x=!1))}return{returnValue:G,Sal:x}}static T$k(a){return a.Rw||bj.OutlineReader.Jja(a)||cf.O4.im(a)}static htl(a){return(a=oi.Nra(a.Oa,!0))&&1===a.length&&(a=a.getContext(0).node,Jd.TableReader.G9a(a))?a:null}}cf.Sg=null;cf.Yg=null;cf.Eif=null;cf.ir=null;cf.jn=null;cf.Po=null;cf.Xc=null;cf.Ro=null;cf.hD=null;cf.y_e=null;cf.bD=null;Object(e.a)(cf,"ADeleteViewStrategy",null,[]);class tu{constructor(a,
b){this.Nb=a;this.Hh=b}CGi(a,b,c,f,l,x){l=this.Nb.Kc(l);a&&!this.Hh.isEmpty(l)?(Xb.OutlineElementNavigator.Ke(x),b.kzh(x.currentNode),tu.Nh.merge(f,x,!1,!1)):(Xb.OutlineElementNavigator.Ke(x),b.Kna(c),tu.Nh.merge(x,f,!1,!1))}static get Nh(){return tu.Ai||(tu.Ai=fb.a.instance.resolve("Box4.IOutlineElementEditor"))}}tu.Ai=null;Object(e.a)(tu,"DeleteParagraphNodeStrategy",null,[1411]);class FN extends cf{constructor(a,b,c,f){super();this.a2j=new tu(c,f);this.la=a;this.hOg=b;this.Nb=c}get RXf(){throw Error.notImplemented();
}get LXf(){return this.a2j}IZi(a,b){return cb.SelectionEditor.iQa(a,!0,!b,!1,!1,!0)}S$k(a){return cb.SelectionEditor.Vj(a)}X$f(a,b){if(!this.la.Dce||!this.la.Zwb||!this.la.Ece||a)return!1;a=this.phj(b);return 1===(a&1)&&2!==(a&2)}phj(a){var b=a.Oa;if(!b.length)return 0;a=Object(ua.a)(5,b.ga(0).Ua.node);if(!a||!a.hs())return 0;a=(a=(a=a.HK())?a.whg():null)?a.getContainingTable():null;if(!a)return 0;const c=[];for(var f=0;f<b.length;++f){var l=b.ga(f);if(l){var x=oi.uNc(l,!0),G=oi.uNc(l,!1);if(x&&G){if(cb.SelectionEditor.xu(x)&&
!cb.SelectionEditor.Svb(x)||!yb.ParagraphReader.Y$d(x.node)||x!==G&&cb.SelectionEditor.xu(G)&&!cb.SelectionEditor.Svb(G)||!yb.ParagraphReader.yKj(G.node))return 0;if(l=Object(ua.a)(Fa.a,Df.ContextSetEditor.instance.a0b(Fa.a.WOa(l.toArray()),16,!1)))for(x=0;x<l.length;++x)G=Object(ua.a)(Vl.TableCellNode,l.getContext(x).node),a.Ap()&&G.isControllingCell?this.kDj(G,c):G.isGhostCell||Array.add(c,G)}}}if(!c.length)return 0;b=a.WX;f=a.c7;x=l=0;G=Array(b);const R=Array(f);for(var fa=0;fa<b;++fa)G[fa]=0;
for(fa=0;fa<f;++fa)R[fa]=0;for(fa=0;fa<c.length;++fa){const wa=c[fa].whg();++G[wa.rowIndex]===f&&++l;++R[wa.ni]===b&&++x}if(0<l&&0<x){if(l===b&&x===f)return 3}else if(l||x){if(0<l){if(!a.Ap())for(a=0;a<f;++a)if(R[a]!==l)return 0;return 1}if(0<x){if(!a.Ap())for(a=0;a<b;++a)if(G[a]!==x)return 0;return 1}}return 0}kDj(a,b){Se.foreachMergedCells(Object(ua.a)(lg.a,a),c=>{Array.add(b,c)})}mQc(a,b,c,f){if(!a&&Ib.ListReader.kk(b)){var l=this.Nb.OQa();l.Pc(b);if((l=Object(ua.a)(4,l.Rg(10)))&&l.Pf){if(this.hOg.Mpb(b))this.hOg.Teb(b,
-1,0),f=32;else if(b.lF(1)){if(b.vf(1),({response:f}=super.mQc(a,b,c,f)).returnValue)return{returnValue:!1,response:f}}else f=32;return{returnValue:!0,response:f}}return super.mQc(a,b,c,f)}return{returnValue:!1,response:f}}$qh(a,b,c){if(!(b&&a===E.a.backspace&&c.Oa&&c.Oa.length&&c.Oa.vl))return{returnValue:!1,qSa:!1};b=c.Yo();if(!b||!b.Ap())return{returnValue:!1,qSa:!1};a=b.WX;b=b.c7;let f=a,l=0,x=b,G=0;c=Df.ContextSetEditor.instance.uA(c.Kj);for(let wa=0;wa<c.length;wa++){if(!c[wa].Qk)return a=!1,
{returnValue:!1,qSa:a};var R=Object(ua.a)(5,c[wa].node);if(!R||!R.hs())return a=!1,{returnValue:!1,qSa:a};var fa=(R=R.HK())?R.Gy():null;if(!fa)return a=!1,{returnValue:!1,qSa:a};R=fa.rowIndex;const Wa=fa.ni,mb=fa.rowSpan;fa=fa.colSpan;f=Math.min(f,R);l=Math.max(l,R+mb-1);x=Math.min(x,Wa);G=Math.max(G,Wa+fa-1)}return l-f+1!==a&&G-x+1!==b?{returnValue:!1,qSa:!1}:{returnValue:!0,qSa:l-f+1===a?!0:!1}}}Object(e.a)(FN,"DeleteViewStrategy",cf,[]);class GN extends cl{constructor(a,b,c,f){super();this.b2j=
new FN(a,b,c,f);this.$1j=new Yv}get MHc(){return this.b2j}get JXf(){return this.$1j}}Object(e.a)(GN,"Box4DeleteActor",cl,[]);class HN{constructor(a,b,c,f,l){this.ia=a;this.Z1j=new GN(b,c,f,l);pa.InteractiveViewManager.instance.editingView.yYb=!0}ub(){this.Z1j.ub(this.ia)}xe(){var a=E.a.backspace;const b=v.FocusManager.instance().Dc(I.AppFrame.QV);b.bindAction(A.KeyInputManager.Na(w.a.wH,0),a);b.bindAction(A.KeyInputManager.Na(w.a.wH,4),E.a.backspace);b.bindAction(A.KeyInputManager.Na(w.a.wH,4|A.KeyInputManager.He),
F.a.Ae);b.bindAction(A.KeyInputManager.Na(w.a.wH,A.KeyInputManager.He),E.a.Wqb);b.bindAction(A.KeyInputManager.Na(w.a.Una,0),E.a.wK);b.bindAction(A.KeyInputManager.Na(w.a.Una,A.KeyInputManager.He),E.a.cYb);r.a.lk&&(b.bindAction(A.KeyInputManager.Na(w.a.wH,3),E.a.backspace),b.bindAction(A.KeyInputManager.Na(w.a.wH,7),E.a.backspace),b.bindAction(A.KeyInputManager.Na(w.a.wH,5),E.a.backspace),b.bindAction(A.KeyInputManager.Na(w.a.wH,1),E.a.Wqb))}}Object(e.a)(HN,"DeleteActor",null,[229]);class IN{constructor(a){this.$0j=
a}ub(){this.$0j.ub()}xe(){}}Object(e.a)(IN,"EnterActor",null,[229]);class Xp{constructor(a,b,c){this.Ou=a;this.aTb=b;this.xm=c}get yn(){return this.aTb.value}UOi(a,b,c,f,l){var x;if(!({Ef:c,selected:x,XE:fa}=this.drh(b,c,!1)).returnValue)return fa;Me.a.mark(5013);var G=Xp.Yl.uA(x);for(var R=0;R<G.length;++R){if(!G[R].isValid)continue;let wa=G[R].iterator;wa.Mu();if(bj.OutlineReader.Lt(wa))return this.d2f(c,wa);if(Tf.b(wa))return go.instance.uxb(a,x,c),this.yn.Yv(),Me.a.mark(5014),32}G=this.Y4i(x);
if(x.Rw||cb.SelectionEditor.Vj(x)||yb.ParagraphReader.im(x)&&!cb.SelectionEditor.jW(x)){if(Xp.qe&&Xp.qe.isFeatureEnabled(33)&&Df.ContextSetEditor.instance.OOe(x).returnValue)return 8;var fa=this.e2f(b,c,a,f,l,G)}else if(cb.SelectionEditor.Ll(x))fa=this.c2f(b,c,a,f,l,G);else if(cb.SelectionEditor.Pg(x)){fa=new nb.GraphIterator;fa.set(x.node);fa.pc(10);if(this.Hgk()&&(R=Lb.HyperlinkReader.VB(x,!1),0<R.length)){if(!R[0].hyperlink)return Z.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",
R[0].Qa,R[0].Kb),8;Cb.App.R_b(R[0].hyperlink.url);return 32}Se.isInTableCell(fa)&&!H.a.instance.ga(77)&&(Qd.returnToContainingCell(fa),H.a.instance.ga(30)&&Se.isLastCellInTable(fa)&&!bj.OutlineReader.IQc(fa)&&bj.OutlineReader.eC(fa,x,!0)&&(Vh.OutlineNavigator.T9(fa),Ib.ListReader.kk(fa)||(G=E.a.BDa),Qd.returnToCell(fa)),Se.isFirstCellInRow(fa)&&(R=new nb.GraphIterator,R.Pc(fa),Qd.returnToContainingRow(R),H.a.instance.ga(30)&&gk.j(R)&&gk.e(R)&&1<Jd.TableReader.jk(Qd.getContainingTable(R))?G=E.a.deleteRow:
bj.OutlineReader.eC(fa,x,!1)&&(gk.g(R)&&0>=x.hS?(G=E.a.a4b,Qd.returnToContainingTable(fa),Xb.OutlineElementNavigator.Ke(fa),l||(l=new D.DictionaryPropertySet),l.me(Oc.a.targetObject,fa.currentNode.id)):H.a.instance.ga(30)&&(G=E.a.C8a))));fa=this.g2f(b,c,a,f,l,G)}else cb.SelectionEditor.jW(x)&&(fa=u.AFrameworkApplication.Ta.ki(b,E.a.cB,2,!1,f,l));Me.a.mark(5014);return fa}drh(a,b,c){let f,l;l=f=null;if(1===b)return{returnValue:!1,Ef:f,selected:l,XE:32};if(!a.view.Lh)return{returnValue:!1,Ef:f,selected:l,
XE:2};f=a.view;l=f.Gb.Kj;return!l||H.a.instance.ga(14)&&!Xp.Yi.evg(l,c)?{returnValue:!1,Ef:f,selected:l,XE:2}:this.xm&&this.xm.instance&&this.xm.instance.lW(l)?{returnValue:!1,Ef:f,selected:l,XE:4}:{returnValue:!0,Ef:f,selected:l,XE:2}}r$k(a,b,c,f,l){let x,G;if(!({Ef:c,selected:x,XE:G}=this.drh(b,c,!0)).returnValue)return G;const R=Xp.Yl.uA(x);for(let fa=0;fa<R.length;++fa){if(!R[fa].isValid)continue;const wa=R[fa].iterator;wa.Mu();if(bj.OutlineReader.Lt(wa))return this.d2f(c,wa)}x.Rw||cb.SelectionEditor.Vj(x)?
G=this.e2f(b,c,a,f,l,E.a.Z3b):cb.SelectionEditor.Ll(x)?G=this.c2f(b,c,a,f,l,E.a.Z3b):cb.SelectionEditor.Pg(x)?G=this.g2f(b,c,a,f,l,E.a.Z3b):cb.SelectionEditor.jW(x)&&(G=u.AFrameworkApplication.Ta.ki(b,E.a.cB,2,!1,f,l));return G}d2f(a,b){a.Gb.setSelection(rd.SelectionFactory.rj(b.currentNode,!1));return 32}e2f(a,b,c,f,l,x){const G=new Id.GraphTransaction(15);G.fd=c;G.gd(b.vg);b=new D.DictionaryPropertySet;b.setValue(Oc.a.urb,!0);b=u.AFrameworkApplication.Ta.ki(a,E.a.wK,2,!0,f,b);32===b&&(b=u.AFrameworkApplication.Ta.ki(a,
x,2,!1,f,l));G.dispose();return b}c2f(a,b,c,f,l,x){const G=new Id.GraphTransaction(15);G.fd=c;G.gd(b.vg);b.Gb.setSelection(cb.SelectionEditor.Hl(b.Gb.Oa.ga(0),!1,!1));a=u.AFrameworkApplication.Ta.ki(a,x,2,!1,f,l);G.dispose();return a}g2f(a,b,c,f,l,x){const G=new Id.GraphTransaction(15,c);G.fd=c;G.gd(b.vg);a=u.AFrameworkApplication.Ta.ki(a,x,2,!1,f,l);G.dispose();return a}static get Yl(){return Df.ContextSetEditor.instance}static get Yi(){return ed.a.instance}static get qe(){return Xp.Yc||(Xp.Yc=fb.a.instance.qb("Box4.IFeatureHelper"))}}
Xp.Yc=null;Object(e.a)(Xp,"AEnterViewStrategy",null,[1370]);class Vs extends Xp{constructor(a,b,c){super(a,b,c)}Y4i(a){let b=E.a.cB;if(a&&(a=Xp.Yl.uA(a))&&0<a.length){const c=new nb.GraphIterator;c.set(a[0].node);c.pc(10);(a=c.h_a())&&a.Sa(sb.a.Cj)&&(a=a.getValue(sb.a.Cj),0===a||2===a)&&(b=E.a.Z3b)}return b}Hgk(){return Vs.uU?!1:!0}static get uU(){null==Vs.QH&&(Vs.QH=u.AFrameworkApplication.fa?u.AFrameworkApplication.fa.ka("SplitHyperlinkFixWithEnterIsEnabled"):!1);return Vs.QH}}Vs.QH=null;Object(e.a)(Vs,
"EnterViewStrategy",Xp,[]);class KE{constructor(a){this.s3j=a}Ahd(a,b){this.s3j.ZX(a,b)}}Object(e.a)(KE,"PPTFontNameFormattingStrategy",null,[1361]);class JN{wqh(){return!1}}Object(e.a)(JN,"PptClipboardOperationCutStrategy",null,[372]);class KN{constructor(a,b){this.xL=a;this.ra=b}IMj(a){return 10===a.oi||16===a.oi||60===a.oi}Wki(a){if(this.xL.n9a(a)&&this.xL.Vvb(a))return!1;let b=a=null;this.ra.Oa.kb&&(b=this.ra.Oa.kb.Ua,a=this.ra.Oa.kb.Ve);return this.ede(b)&&this.ede(a)}ede(a){if(a){if(a.contextId===
Bb.a.paragraph)return!0;if(a.contextId===Bb.a.endOfParagraph&&(a=a.node))return Ka.a.Va(a.characterData)}return!1}Hal(a,b){return this.dNe(a,b)}dNe(a,b){let c=null;this.ra.Oa.kb&&(c=this.ra.Oa.kb.Ua);return this.ede(c)?!!a&&this.xL.Vvb(a)||1===b:!1}}Object(e.a)(KN,"PptDeleteOutlineElementNodeStrategy",null,[1114]);class LN{constructor(a,b,c){this.Cq=a;this.$I=b;this.nb=c}C2f(a){if(this.nb.Oa&&this.nb.Oa.vl){const f=this.Cq.F9f(this.nb.Oa).returnValue;if(!f.$Pa()&&a.Rw){a=new Fa.a;var b=this.nb.Ey();
for(const l of b)if(b=Object(ua.a)(Vl.TableCellNode,l)){var c=nb.GraphIterator.mb(b);if(c.af()){const x=gk.c(c);c=this.$I.EMc(Object(ua.a)(127,c.currentNode));f.VQi(x,c)&&a.lha(qd.a.ROa(rd.SelectionFactory.gl(b)))}}}}return a}}Object(e.a)(LN,"PptDeleteTableSegmentStrategy",null,[373]);class MN{iwh(){return!1}xxg(a){return!!a&&!a.em.equals(Ga.a.nil)}}Object(e.a)(MN,"PptEopFormattingStrategy",null,[1112]);class NN{constructor(a,b,c){this.u1c=!1;this.Ea=a;this.VN=b;this.ra=c}hBh(a,b){a&&b&&(b.beforeSpacing&&
(a.setValue(sb.a.Tca,b.beforeSpacing.value),a.setValue(sb.a.Zja,b.beforeSpacing.Sf)),b.afterSpacing&&(a.setValue(sb.a.Sca,b.afterSpacing.value),a.setValue(sb.a.Yja,b.afterSpacing.Sf)),b.lineSpacing&&(a.setValue(sb.a.Zw,b.lineSpacing.value),a.setValue(sb.a.yW,b.lineSpacing.Sf)));return!0}tqh(){return!1}hrh(){return!1}qqh(){return!this.u1c}arh(a,b){return a===Bb.a.paragraph||a===Bb.a.endOfParagraph||b}rqh(a,b,c){this.ra.Oa&&this.ra.Oa.kb&&(c=!this.ra.Oa.kb.sba);return a!==Bb.a.textRange&&(b===Bb.a.paragraph||
c)}aGf(a,b,c){this.u1c=!1;if(a.hs()&&this.ra.Oa.kb){var f=this.ra.Oa.kb.Ua;this.ra.Oa&&this.ra.Oa.vl&&this.ra.Oa.ga(0)&&(f=this.ra.Oa.ga(0).Ua);if(f=vb.a.Ls(yb.ParagraphReader.Vd(f.node)?f:rd.SelectionFactory.gl(a).Ua))if(f=f.cache)!c.Sa(sb.a.latinFont)&&f.Sa(sb.a.latinFont)&&c.setValue(sb.a.latinFont,f.eN),!c.Sa(tb.a.fontColor)&&f.Y2&&c.setValue(tb.a.fontColor,f.fontColor),!c.Sa(tb.a.fontSize)&&f.ssa&&c.setValue(tb.a.fontSize,f.fontSize),!c.Sa(tb.a.bold)&&f.ERa&&c.setValue(tb.a.bold,f.isBold)}if(b){if(f=
a.PP(this.VN)){b.$S||a.sa(sb.a.c$d,!1)||f.sa(sb.a.c$d,!1)||(this.u1c=!0);const l=b.spacing;l&&(!l.beforeSpacing||l.beforeSpacing.value||f.Sa(sb.a.Tca)||(l.beforeSpacing=null),!l.afterSpacing||l.afterSpacing.value||f.Sa(sb.a.Sca)||(l.afterSpacing=null),l.lineSpacing&&2===l.lineSpacing.Sf&&1===l.lineSpacing.value&&!f.Sa(sb.a.Zw)&&(l.lineSpacing=null))}this.u1c||(b.$S||(b.$S=Ae.a.AP(16,0)),b.$S.A7f=!0)}if((f=a.Afg())&&!f.W9&&(c.Sa(tb.a.fontSize)&&(f=this.Ea.xCa(this.Ea.tn(a)),c.setValue(tb.a.fontSize,
c.getValue(tb.a.fontSize)*f)),b&&b.spacing&&b.spacing.lineSpacing&&2===b.spacing.lineSpacing.Sf)){let l;(l=b.spacing.lineSpacing).value=l.value-this.Ea.atb(this.Ea.tn(a))}c.sa(tb.a.Qs,!1)&&c.setValue(tb.a.Qs,!1);c.sa(tb.a.WZ,!1)&&c.setValue(tb.a.WZ,!1)}}Object(e.a)(NN,"PptFormatPainterStrategy",null,[1115]);var LE=d(421);class lA{constructor(a,b,c,f,l,x,G){this.ia=a;this.Fa=f;this.ra=b;this.$D=c;this.zu=l;this.WA=x;this.rVa=!G.tg;this.Bne=G.oyg}ub(){this.ia.pa(F.a.Uyh,xd.a.frame,Object(C.a)(this,
this.VAk,"pptToggleRibbonUXHandler"),128);this.ia.ya(F.a.Qgh,xd.a.frame,Kd.ActionManager.Hg);this.ia.ya(F.a.Pgh,xd.a.frame,Kd.ActionManager.Hg)}xe(){}VAk(a,b){if(b.contextId!==xd.a.frame)return 2;this.ra.Uh();this.Fa.Ad();this.zu.show(!0,a);this.Bne?(Aa.a.J(33859651,340,50,"User is switching to the Classic Ribbon from Single Line Ribbon"),u.AFrameworkApplication.Ta.processAction(F.a.Qgh,2)):(Aa.a.J(33859653,340,50,"User is switching to the Single Line Ribbon from Classic Ribbon"),u.AFrameworkApplication.Ta.processAction(F.a.Pgh,
2));u.AFrameworkApplication.Ku&&u.AFrameworkApplication.Ku.v7();this.WA.l8&&2===this.WA.vJ?lA.ekh(this.ia,this.Bne,LE.a.Obd):this.$D.G2(!1,this.rVa,()=>{lA.ekh(this.ia,this.Bne,LE.a.Obd)},null);return 32}static ekh(a,b,c){Pi.a.aM(c,(!b).toString(),Pi.a.JL);a.processAction(ba.a.refresh,2)}}Object(e.a)(lA,"ToggleRibbonUXActor",null,[229]);class ON extends Sys.EventArgs{constructor(a,b,c){super();this.actionId=a;this.AUe=b;this.L9a=c}}Object(e.a)(ON,"UndoRedoEventArgs",Sys.EventArgs,[]);class PN{constructor(a,
b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){this.ia=a;this.Af=b;this.ra=c;this.Fa=f;this.yv=l;this.t5j=x;this.G8j=G;this.nPg=R;this.YD=fa;this.Scb=wa;this.FI=Wa;this.T3j=mb;this.Ee=nc}ub(){this.ia.pa(ba.a.Oeb,sc.a.application,Object(C.a)(this,this.Nkg,"handleUndoRedo"),4);this.ia.pa(ba.a.Neb,sc.a.application,Object(C.a)(this,this.Nkg,"handleUndoRedo"),4)}xe(){const a=this.Fa.Dc(Yb.a.jj);a.$Cc(A.KeyInputManager.Na(w.a.sLb,A.KeyInputManager.He),ba.a.Oeb,()=>!0);a.bindAction(A.KeyInputManager.Na(w.a.wpd,A.KeyInputManager.He),
ba.a.Neb)}Nkg(a,b,c,f,l){b=!0;a===ba.a.Neb&&(b=!1);if(this.Af.Zc(this.nPg)||!this.A$k(b,l))return 16;if(!this.B$k())return this.yv.bna(),16;if(1===c)return 32;if(c=!this.yv.PGj(b))this.ra.kj(),this.FVk();f=this.yv.XMc(b);(l=this.FI.c5(f))&&Nc.a.qk("UndoRedoActionName",l);this.Scb.z8c(!c);this.Ee.WIk(new ON(a,f,b));(f=this.yv.z_d(b))&&f.t5!==Ga.a.nil&&Nc.a.qk("UndoRedoRevision",Nc.a.t7a(f.t5.toString()).toString());this.T3j.z8c(f,l,b);if(b?!this.yv.undo():!this.yv.redo())return Z.ULS.sendTraceTag(512499928,
801,10,"User perform {0} failed!!",a===ba.a.undo?"undo":"redo"),8;c&&this.Af.Jw(this.nPg,a);return 32}A$k(a,b){a&&!this.yv.aW&&b&&Z.ULS.sendTraceTag(512499927,801,50,"User pressed ctrl+z, but no undo entry left. Is in box4? {0}",this.yv.f9a());return(a?this.yv.aW:this.yv.hja)&&!(this.Fa.ze&&this.Fa.ze.name===Yb.a.CJd)&&this.C$k()}B$k(){return this.t5j||!this.LJj()}LJj(){return!this.G8j.rCa&&!!this.YD.instance&&this.YD.instance.GNj()}C$k(){return!this.MJj()}MJj(){const a=this.ra.rq();return a?a.Mx:
!1}FVk(){const a=this.Fa.ze;!a||a.name!==Yb.a.Bg&&a.name!==Yb.a.Gva||this.Fa.Ad()}}Object(e.a)(PN,"UndoRedoActor",null,[229]);class QN{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We,Qf,mg,Xg,Mg,Sf,uh,Sg,li,Ui,Cj,jj){this.kFa=this.Cua=this.W3c=null;this.fAb=0;this.GJg=this.Bme=!1;this.$D=x;this.ia=a;this.myb=b;this.Fa=c;this.lh=f;this.ra=l;this.Af=G;this.fe=R;this.Zb=fa;this.ua=wa;this.Qb=Wa;this.bdc=mb;this.fc=Kb;this.la=nc;this.zu=oc;this.Xa=Ic;this.WA=Kc;this.Je=Hc;this.eva=
ie;this.qOg=He;this.qv=fe;this.yb=Te;this.ew=We;this.t1c=Qf;this.cLg=nc.dwg;this.Lc=mg;this.L$a=Xg;this.Ho=Mg;this.Fc=Sf;this.Rb=uh;this.Mb=Sg;this.gO=li;this.Ob=Ui;this.fH=Cj;this.gw=jj;this.gni()}ub(){this.ia.pa(ba.a.qcd,sc.a.application,Object(C.a)(this,this.qcd,"queryEdit"),96);this.ia.pa(ba.a.pdd,sc.a.application,Object(C.a)(this,this.pdd,"querySorterView"),96);this.ia.pa(ba.a.ric,sc.a.application,Object(C.a)(this,this.ric,"querySlideInformation"),96);this.ia.ya(ba.a.mch,sc.a.application,Object(C.a)(this,
this.Wkl,"switchToReadingMode"));this.ia.ya(ba.a.Nmc,sc.a.application,Object(C.a)(this,this.fjl,"startSlideShowFromBegnning"));this.ia.ya(ba.a.lhc,sc.a.application,Object(C.a)(this,this.lhc,"present"));this.ia.ya(ba.a.PEb,sc.a.application,Object(C.a)(this,this.PEb,"presentDropDown"));this.ia.ya(ba.a.Wad,sc.a.application,Object(C.a)(this,this.Wad,"playFromBeginningTopBar"));this.ia.ya(ba.a.kZa,sc.a.application,Object(C.a)(this,this.kZa,"startSlideShowFromCurrentSlide"));this.ia.ya(ba.a.wsb,sc.a.application,
Object(C.a)(this,this.wsb,"forceClose"));this.ia.ya(ba.a.Kma,sc.a.application,Object(C.a)(this,this.Kma,"rehearsePresentation"));this.ia.ya(ba.a.ted,sc.a.application,Object(C.a)(this,this.ted,"rehearsePresentationTopBar"));this.la.pptEditorRehearsalSpeechClientEnabled&&(this.ia.ya(ba.a.rJc,sc.a.application,Object(C.a)(this,this.rJc,"enableSubtitlesKeyboardShortcut")),this.ia.ya(ba.a.qJc,sc.a.application,Object(C.a)(this,this.qJc,"enableLivePresenterKeyboardShortcut")));this.w2h();this.ia.ya(ba.a.shb,
sc.a.application,Object(C.a)(this,this.shb,"showEditTriPaneView"));this.fc.ka("PPTSorterViewEnabled")&&(this.Bme=this.fc.ka("FeedbackPaneExperienceIsEnabled")&&this.fc.ka("HelpTabIsEnabled"),this.ia.ya(ba.a.zWb,sc.a.application,Object(C.a)(this,this.zWb,"closeEditTriPaneView")));this.la.eUc&&this.eva.Oyj(u.AFrameworkApplication.buildVersion,this.Xa.fk,u.AFrameworkApplication.userSessionId,this.Fc)}xe(){if(this.fc.ka("SlideShowByShortcutEnabled")){const a=this.Fa.Dc(y.AFrame.jj);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.bqc,
A.KeyInputManager.He|4),ba.a.kZa);y.AFrame.Zj(a,A.KeyInputManager.Na(w.a.bqc,A.KeyInputManager.He),ba.a.Nmc)}}w2h(){this.ia.ya(ba.a.mhc,sc.a.application,Object(C.a)(this,this.mhc,"presentLive"));this.ia.ya(ba.a.Vbd,sc.a.application,Object(C.a)(this,this.Vbd,"presentLiveTopBar"));this.ia.ya(ba.a.Meb,sc.a.application,Object(C.a)(this,this.Meb,"presentLiveSetAccessControlAnyone"));this.ia.ya(ba.a.Ubd,sc.a.application,Object(C.a)(this,this.Ubd,"presentLiveSetAccessControlOrganization"));this.ia.pa(ba.a.gic,
sc.a.application,Object(C.a)(this,this.gic,"queryPresentLiveAccessControlAnyone"),96);this.ia.pa(ba.a.hic,sc.a.application,Object(C.a)(this,this.hic,"queryPresentLiveAccessControlOrganization"),96);fb.a.instance.Ka("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(a=>{a.M2("L_PublicLivePresentations",!0).then(b=>{b||(Aa.a.J(512499926,822,15,"Public Live Presentations is disabled by publiclivepresentations policy"),this.ia.uO(ba.a.Meb,Bb.a.application,Object(C.a)(this,this.Meb,
"presentLiveSetAccessControlAnyone")),Cb.App.Hb.YZa(ba.a.Meb,Object(C.a)(new zp,(new zp).wCa,"getCommandById")));return null},b=>{Aa.a.J(512499925,822,10,"Could not get publiclivepresentations policy {0}",b);return null})})}ric(a,b,c,f,l){a=(a=this.ua.Ba)?a.we+1:0;a=(b=this.Qb.Hj())?String.format(ResourceStrings.l_SlideMenuButtonLabel,a,b):ResourceStrings.l_Slide;l[Eq.a.Value]=a;l[um.a.labelText]=a;return 32}qcd(a,b,c,f,l){this.Mb&&0!==this.Mb.Xo?l.Nf(!1):l.Nf(!0);return 32}pdd(a,b,c,f,l){(a=Object(ua.a)(Nh.a,
l))&&(1!==this.Mb.Xo?a.Nf(!1):a.Nf(!0));return 32}shb(a,b,c){try{if(1===c)return 32;2===c&&0!==this.Mb.Xo&&(Aa.a.J(512499924,822,50,"ViewSwitchingActor: ShowEditTriPaneView."),this.Mb.Xo=0,this.Ob&&(this.Ob.slidePane.Tl(),this.la.Rea||this.Ob.thumbnailPane.Tl(),this.Ob.notesPane.Tl(),this.fH&&this.fH.setVisibility(!0)),this.ia.processAction(ba.a.jgb,2),this.ia.processAction(ba.a.nqb,2),this.gO.h5("PptEditingStatusBar.Notes",!0),this.gO.h5("PptEditingStatusBar.ZoomScale",!0),this.gO.h5("PptEditingStatusBar.FitToWindow",
!0),this.Bme?this.gO.h5("PptEditingStatusBar.GiveFeedbackPane",!0):this.gO.h5("PptEditingStatusBar.GiveFeedback",!0),this.Lc.mz(new Wp.a(2)),this.Lc.mz(new Wp.a(1)),this.lh.lK(Yb.a.vE),this.lh.lK(Yb.a.Gva),this.lh.lK(Yb.a.Bg),this.lh.lK(Yb.a.LP))}catch(f){Aa.a.J(512499923,822,10,"ViewSwitchingActor - Expcetion in ShowEditTriPaneView: {0}.",f)}return 32}zWb(a,b,c){try{if(1===c)return 32;2===c&&(this.Ob&&(this.Ob.slidePane.Ns(),this.Ob.thumbnailPane.Ns(),this.Ob.notesPane.Ns(),this.fH&&this.fH.setVisibility(!1)),
this.gO.h5("PptEditingStatusBar.Notes",!1),this.gO.h5("PptEditingStatusBar.ZoomScale",!1),this.gO.h5("PptEditingStatusBar.FitToWindow",!1),this.Bme?this.gO.h5("PptEditingStatusBar.GiveFeedbackPane",!1):this.gO.h5("PptEditingStatusBar.GiveFeedback",!1),this.Lc.mz(new Wp.a(2)),this.Lc.mz(new Wp.a(1)),this.lh.zo(Yb.a.vE),this.lh.zo(Yb.a.Gva),this.lh.zo(Yb.a.Bg),this.lh.zo(Yb.a.LP),this.ra.Uh())}catch(f){Aa.a.J(512499922,822,10,"ViewSwitchingActor - Exception in CloseEditTriPaneView: {0}.",f)}return 32}Wkl(a,
b,c){if(this.Af.Zc(this.Zb.yf))return 16;if(1===c)return this.ua.Ba?32:16;b=(new Date).getTime();let f=Ze.a.Ri(window.document.URL,Jg.a.r5g,Jg.a.readingView,!0);if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");c=this.ua.Ba.Bb;f=Ze.a.Ri(f,Jg.a.Xfc,c?c.sid.toString():"",!0);f=this.myb.instance&&this.myb.instance.isVisible?Ze.a.Ri(f,Jg.a.q5g,"1",!0):Ze.a.removeParameter(f,Jg.a.q5g,!0);this.fni();f=Ze.a.Ri(f,u.AFrameworkApplication.n7c,b.toString(),!0);this.ra.Uh();this.Fa.Ad();this.zu.show(!0,
a);this.$D.G2(!1,!0,()=>{this.$uh(f)},()=>{Aa.a.J(512499921,818,10,"SwitchingToReadingMode: ForceSave triggered failed.");this.$uh(f);return!0});return 32}$uh(a){this.bdc.openWindow(1,a,!1)||this.zu.hide()}lhc(a,b,c){return this.Khb(a,c,null)}PEb(a,b,c){return this.Khb(a,c,null)}Wad(a,b,c){return this.Khb(a,c,null)}fjl(a,b,c){return this.Khb(a,c,null)}kZa(a,b,c){return this.Khb(a,c,this.ua.Ba?this.ua.Ba.Bb:null)}Khb(a,b,c,f=!1,l=!1){if(!this.la.eUc)return this.Oil(a,b,c);if(this.Af.Zc(this.Zb.yf)||
!this.Qb.Hj()||this.la.preventDuplicateSlideShowLaunches&&this.eva.g6b()||this.la.allowDisablingSlideShowButtonDueToRehydration&&this.eva.G6d)return 16;if(1===b)return this.Rwb()?32:8;this.la.Uug&&!re.a("DummyChangeGateForTest")&&Aa.a.J(512499920,830,100,"StartSlideShow::DummyChangeGateForTest is disabled");this.gw.hasDeferredContent()&&Aa.a.J(512499919,830,100,"StartSlideShow attemped with deferred content");this.ejl(c,f,l);return 32}ejl(a,b,c){this.fAb=(new Date).getTime();this.ra.Uh();this.Fa.Bf(Yb.a.mD);
this.Lc.Fbh();Aa.a.J(512499918,830,50,"ViewSwitchActor.StartSlideShowFrom Should HideSlideShowButton: {0}",this.eva.G6d);const f=a?a.sid:-1;a=(a=a?Object(ua.a)(119,this.Qb.VCa(a.sid)):null)?a.we+1:-1;let l=!1;this.Ho.instance?l=this.Ho.instance.CZ?!0:!1:Aa.a.J(512499917,818,15,"StartSlideShowFrom: m_podSeamlessFailoverManager is null.");this.eva.fkd(f,a,b,this.fc.Ga("361"),this.Xa.fk,this.Xa.podSessionId,this.fc.Ga("387"),u.AFrameworkApplication.userSessionId,this.la.FNj,this.fAb,l,this.Xa,c);this.eva.sha(Object(C.a)(this,
this.b9c,"onExitSlideshowHandler"));this.WA.fgl()}ted(a,b,c,f){return this.Kma(a,b,c,f,{entryPoint:4})}Kma(a,b,c,f,l){switch(c){case 2:if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");this.la.pptEditorRehearsalSpeechClientEnabled&&(b=0,l&&(b=l&&"entryPoint"in l?l.entryPoint:1),this.ia.La(ba.a.Lmc,2,b),this.Fc&&(this.Fc.aCa=!1),this.Rb&&this.Rb.instance&&(this.Rb.instance.aCa=!1));return this.eva.g6b()?(this.Fc&&(this.Fc.Kh=!1),32):this.Khb(a,c,this.ua.Ba.Bb,!0);case 1:if(0<this.Qb.Hj())if(this.la.pptEditorRehearsalSpeechClientEnabled){if(32===
this.ia.processAction(ba.a.qJa,1)&&32===this.ia.processAction(ba.a.Lmc,1)&&this.Rwb())return 32;break}else return this.Rwb()?this.ia.processAction(ba.a.qJa,1):8;else break;default:Aa.a.J(512499916,822,10,"RehearsePresentation: Unimplemented action behavior")}return 8}rJc(a,b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Fc)return this.Fc.aCa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:Aa.a.J(512499915,822,10,"EnableSubtitlesKeyboardShortcut: Unimplemented action behavior")}return 8}qJc(a,
b,c){switch(c){case 2:if(this.la.pptEditorRehearsalSpeechClientEnabled&&this.Rb&&this.Rb.instance)return this.Rb.instance.aCa=!0,32;break;case 1:return this.la.pptEditorRehearsalSpeechClientEnabled?32:8;default:Aa.a.J(512499914,822,10,"EnableLivePresenterKeyboardShortcut: Unimplemented action behavior")}return 8}Vbd(a,b,c,f,l){return this.mhc(a,b,c,f,l)}mhc(a,b,c){if(this.GJg){try{appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0))}catch(f){Aa.a.J(512499913,833,10,
"ViewSwitchingActor::PresentLive unhandled exception: {0}",f)}return 8}if(1===c)return this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&this.Rb.instance.$5a&&this.Rwb()?0<this.Qb.Hj()?32:8:8;this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&(this.Rb.instance.$Ba=!0);if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");return this.Khb(a,c,this.ua.Ba.Bb,!1,!0)}Meb(a,b,c){if(1===c)return this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&this.Rb.instance.$5a&&this.Rwb()?32:8;this.Rb.instance.Rq&&
0!==this.Rb.instance.accessControl?this.Rb.instance.showEndSessionDialog(()=>{this.Rb.instance.GZb(5);this.Rb.instance.accessControl=0;this.Lc.mz(new Wp.a(1))},()=>{}):(this.Rb.instance.accessControl=0,this.Lc.mz(new Wp.a(1)));return 32}Ubd(a,b,c){if(1===c)return this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&this.Rb.instance.$5a&&this.Rb.instance.Q3f&&this.Rwb()?32:8;this.Rb.instance.Rq&&1!==this.Rb.instance.accessControl?this.Rb.instance.showEndSessionDialog(()=>{this.Rb.instance.GZb(5);this.Rb.instance.accessControl=
1;this.Lc.mz(new Wp.a(1))},()=>{}):(this.Rb.instance.accessControl=1,this.Lc.mz(new Wp.a(1)));return 32}gic(a,b,c,f,l){try{const x=Object(ua.a)(Nh.a,l);x&&this.Rb.instance&&x.Nf(0===this.Rb.instance.accessControl)}catch(x){Aa.a.J(512499912,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlAnyone unhandled exception: {0}",x)}return 32}hic(a,b,c,f,l){try{const x=Object(ua.a)(Nh.a,l);x&&this.Rb.instance&&x.Nf(1===this.Rb.instance.accessControl)}catch(x){Aa.a.J(512499911,833,10,"ViewSwitchingActor::QueryPresentLiveAccessControlOrganization unhandled exception: {0}",
x)}return 32}Oil(a,b,c){if(this.Af.Zc(this.Zb.yf))return 16;if(1===b)return this.Qb.Hj()?32:16;this.fAb=(new Date).getTime();this.ra.Uh();this.Fa.Bf(Yb.a.mD);this.Lc.Fbh();this.zu.show(!0,a);this.$D.G2(!1,!0,()=>{this.dkh(c,this.fAb)},()=>{Aa.a.J(512499910,818,10,"StartSlideShowFrom: ForceSave triggered failed.");this.dkh(c,this.fAb);return!0});return 32}b9c(a,b){a=((new Date).getTime()-this.fAb).toString();Aa.a.J(512499909,830,50,"ViewSwitchingActor.OnExitSlideshowHandler: Exit slideshow. Duration: {0}. HasDeferredContentInFile: {1}, HasDeferredContentOnSlide: {2}",
a,this.gw.hasDeferredContent(),this.gw.T5d(b.slideId.toString()));this.gw.hasDeferredContent()||this.gw.T5d(b.slideId.toString())?this.gw.Xpa("DeferredExitSlideshowDuration",a):this.gw.Xpa("ExitSlideshowDuration",a);this.eva.Nea(Object(C.a)(this,this.b9c,"onExitSlideshowHandler"));(this.Cua=b)&&!this.Cua.ZEj&&!this.Cua.SIj&&0<this.Cua.slideId&&0<=this.Cua.slideIndex&&this.wgk(this.Cua.slideId,this.Cua.slideIndex);this.Fa.Ad();this.cLg?(this.kFa=Nc.a.Pl("ExitSlideshow"),this.Af.blockContent(this.Zb.yf,
"ExitSlideshow"),this.qOg.Yj(Object(C.a)(this,this.d1g,"onPageManifestNodePropertyChanged")),this.kFa.Wa("UnlockPodsSessionStartTime",Nc.a.$e(new Date)),this.unlockPodsSession(c=>{this.kFa&&(this.kFa.Wa("UnlockPodsSessionWithMerge",c.toString()),this.kFa.Wa("UnlockPodsSessionEndTime",Nc.a.$e(new Date)));c?this.qv.vWi():this.MHe()})):this.MHe()}MHe(a=null){a&&(this.W3c=null);this.Cua&&(this.cLg&&(this.qOg.tm(Object(C.a)(this,this.d1g,"onPageManifestNodePropertyChanged")),this.Af.GJ(this.Zb.yf),this.kFa&&
(this.kFa.Wa("InboundPresentationEndTime",Nc.a.$e(new Date)),this.kFa.finish(),this.kFa=null)),this.Cua=null,this.WA.kXk())}unlockPodsSession(a){const b=zh.a.create().toString();Aa.a.J(512499907,830,50,"ViewSwitchingActor.UnlockPodsSession: Unlock Pods session, correlation={0}",b);const c=String.format("{0}PodHandler.ashx?action=LockUnlockSession&PodSID={1}&locked=false",u.AFrameworkApplication.fa.appSettings["361"],this.Xa.podSessionId),f={WaitForSessionTimeoutMs:"0"};f["X-UserSessionId"]=u.AFrameworkApplication.userSessionId;
f["X-CorrelationID"]=b;f["X-WacCluster"]=this.Xa.fk;this.Ulh(c,f,0,a)}Ulh(a,b,c,f){this.ew.yj(a,2,null,b,!1,2,l=>{this.iul(l,c,f)},l=>{this.fCh(l,a,b,c,f)},null,void 0,void 0,void 0,void 0,Ax.a("2"))}iul(a,b,c){if(b)Aa.a.J(512499905,830,50,"ViewSwitchingActor.UnlockPodsSession: Succeed with retry: {0}",b);else{b=!1;try{a.data.Sd&&0<a.data.Sd.length&&(b=JSON.parse(a.data.Sd).FMerged)}catch(f){Aa.a.J(512499906,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed to deserialize unlock Pods session response: {0}",
a.toString())}c(b)}}fCh(a,b,c,f,l){f||l(!1);3>f?this.Ulh(b,c,f+1,l):Aa.a.J(512499904,830,10,"ViewSwitchingActor.UnlockPodsSession: Failed with status code: {0}, retry count: {1}",this.t1c.Nia(a),f)}d1g(a,b){this.W3c||b.property!==sb.a.N3b||(this.W3c=new xe.a(2,1,0,Object(C.a)(this,this.MHe,"resumeEditor"),90,"65"),this.yb.Cb(this.W3c))}dkh(a,b){this.zu.hide();let c=!0,f=!1,l=this.fe.slideShowUrl;l||(l=Ze.a.Ri(window.document.URL,Jg.a.r5g,Jg.a.slideShowView,!0),f=!0);l=Ze.a.removeParameter(l,Jg.a.Uuk);
l=a?Ze.a.Ri(l,Jg.a.Xfc,a.sid.toString(),!0):Ze.a.removeParameter(l,Jg.a.Xfc);0<b&&(l=Ze.a.Ri(l,u.AFrameworkApplication.n7c,b.toString(),!0));a=String.format("menubar=false,fullscreen=yes,scrollbars=yes,resizable=yes,left=0,top=0,width={0},height={1}",window.screen.width,window.screen.height);b=null;try{b=this.bdc.gze(4,l,"SlideShowWindow",a,f,!1)}catch(x){Aa.a.J(512499875,818,10,"StartSlideShowFrom: Exception throw trying to open the window. {0}",x),c=!1}b||(Aa.a.J(512499874,818,10,"StartSlideshowFrom:: failed to open slide show window"),
c=!1);Nc.a.qk("Window Opened",c.toString());Nc.a.Kmd()}wsb(a,b,c){if(2!==c)return this.ia.processAction(F.a.close,c);a=this.ia.processAction(F.a.close,2);32!==a&&(Aa.a.J(512499873,801,50,"Close action failed to execute. Response: {0}",a),window.location="about:blank");return 32}wgk(a,b){Aa.a.J(512499872,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideIndex={0}",b);(a=this.Qb.VCa(a))?this.Je.U9(a.we):(Aa.a.J(512499871,830,50,"ViewSwitchingActor.NavigateAtSlideshowExit: SlideId does not exist.  Navigate to slide index {0}.",
b),a=this.Qb.Hj()-1,b=b>a?a:b,0>b||this.Je.U9(b))}fni(){this.L$a.instance&&this.L$a.instance.rSa&&(this.L$a.instance.kHc.TB?this.L$a.instance.endCommentSession(this.L$a.instance.kHc.TB.draftId,7):this.L$a.instance.endCommentSession("",7),this.L$a.instance.VDf())}Rwb(){return"Legacy"==this.eva.V2()||this.eva.hIg}gni(){this.la.powerPointLiveBroadcastEnabled&&fb.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(a=>{a.isFeatureEnabled("PowerPointLivePresentations",
!1).then(b=>{b||(Aa.a.J(512499870,822,15," User doesn't have license for PPTLive, Hiding Present Live button"),this.GJg=!0);return null})})}}Object(e.a)(QN,"ViewSwitchingActor",null,[229]);class RN{constructor(a,b){this.sGg=null;this.Xa=a;this.aWa=b;this.TKf();this.Xa.lFf(Object(C.a)(this,this.o$c,"onSessionInfoChanged"))}TKf(){const a=new Sys.StringBuilder;a.append(String.format("?{0}",this.Xa.presentationId.string));a.append(String.format("&{0}={1}",Jg.a.Z1k,this.Xa.Erb));a.append(String.format("&{0}={1}",
Jg.a.vma,"368"in u.AFrameworkApplication.fa.appSettings?void 0===this.Xa.sessionInfo||null===this.Xa.sessionInfo?"undefined":this.Xa.sessionInfo:this.Xa.sessionInfo));this.Xa.fk&&a.append(String.format("&{0}={1}",Jg.a.s5g,this.Xa.fk));this.Xa.podSessionId&&a.append(String.format("&{0}={1}",Jg.a.g$,this.Xa.podSessionId));a.append(String.format("&{0}=",Jg.a.Tuk));this.sGg=a.toString()}o$c(){this.TKf()}resolve(a,b){return b&&b.length?b.startsWith("./"+a)?b:this.aWa+a+this.sGg+b:null}dispose(){this.Xa.lSk(Object(C.a)(this,
this.o$c,"onSessionInfoChanged"))}}Object(e.a)(RN,"ResourceViewElementResolver",null,[1140,106]);var WQ=d(1012),XQ=d(936);class SN{constructor(a,b){this.cYc=this.C3=0;this.kMg=null;this.lMg=-1;this.mMg=null;this.Hta=a;this.wc=b}get x$d(){return 0<this.cYc}get vBg(){return this.kMg}$jk(a){this.cYc++;this.wc.Yuh(a.CcpId,a.CcpCorrelation)}get zde(){return this.mMg}set zde(a){this.mMg=a}CYg(a,b){if(!a){const c=this.Bjj(b);c>this.lMg&&(this.lMg=c,this.kMg=b.CcpId)}0<this.cYc?this.cYc--:Aa.a.J(20760084,
307,15,"ClipServiceManager - bad state");this.wc.b1f(b.CcpId,a,0)}SQd(a,b,c=!1,f=!1){a=Object.assign(new XQ.a,{uZ:32,Np:zh.a.create().toString(),version:this.C3++,location:this.Hta.ccpInfo,BE:this.Hta.fk||Ap.a.bGh,dataType:a,objectCount:b,ODa:c,MDa:f,kz:zh.a.create().toString()});Aa.a.J(24945860,307,50,"CreateClipServiceObject: A ClipServiceObject was just created for Ccpid: {0}.",a);return a}Bjj(a){let b=null;a:{var c=a.PackageAccessKey;let l;l=null;if(c)try{const x=Yd.a(c);if(x&&"I"in x&&"V"in x){l=
new Ss(x.I,parseInt(x.V));var f={returnValue:!0,kz:l};break a}}catch(x){}f={returnValue:!1,kz:l}}if(({kz:b}=f).returnValue&&b)return b.version;Aa.a.J(21066257,307,15,"Fail to parse packageAccessKeyString for ccpid: {0}",a.CcpId);return-1}}Object(e.a)(SN,"ClipServiceManager",null,[1129]);class TN{constructor(a,b,c,f,l,x,G,R,fa){this.kh=a;this.L9b=c;this.r5c=f;this.vge=l;this.Ar=x;this.wc=G;this.I_=R;this.ia=fa;this.nl=b;this.dda=this.kh.contentWindow.document.body;this.Ar.addHandler(this.dda,ma.a.cut,
Object(C.a)(this,this.qZg,"onBrowserCut"));this.Ar.addHandler(this.dda,ma.a.copy,Object(C.a)(this,this.pZg,"onBrowserCopy"))}get Gc(){return this.L9b.Gc}dispose(){this.kh&&this.kh.contentWindow&&(this.Ar.removeHandler(this.dda,ma.a.cut,Object(C.a)(this,this.qZg,"onBrowserCut")),this.Ar.removeHandler(this.dda,ma.a.copy,Object(C.a)(this,this.pZg,"onBrowserCopy")));this.kh=null}qZg(){if(Lk.nA&&!Lk.nA.DWd){var a=this.wc.FO(1,0,"OnBrowserCut");this.jra(Object.assign(new Ts(!0,!0),{Sb:a}))}}pZg(){if(Lk.nA&&
!Lk.nA.DWd){var a=this.wc.FO(0,0,"OnBrowserCopy");this.jra(Object.assign(new Ts(!0),{Sb:a}))}}NP(a){if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&(u.AFrameworkApplication.rO||u.AFrameworkApplication.lJ)&&!u.AFrameworkApplication.KPa)return!1;for(let b=0;b<this.nl.length;b++)if(this.nl[b].NP(a))return!0;return!1}jra(a){if(this.ia.pW)this.I_?(this.I_.show(5,-1),this.wc.Eg(!1,a.Sb,26)):Aa.a.J(545047123,826,10,"m_offlineModalCallout is null");
else if(u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)&&(u.AFrameworkApplication.rO||u.AFrameworkApplication.lJ)&&!u.AFrameworkApplication.KPa)this.wc.Eg(!1,a.Sb,32);else{var b=0,c=!1;for(var f=0;f<this.nl.length;f++)if(this.nl[f].NP(a)){c=!0;this.nl[f].jra(a)||(b=21);break}switch(a.dataType){case 2:f=2;break;case 1:f=19;break;default:f=0}this.wc.oB(f,a.Sb);if(c){if(a.sug&&(this.vge.mgb(this.kh),!a.rRi)){if(!this.r5c){this.wc.Eg(!1,
a.Sb,1);return}this.r5c.copy(this.kh)||0!==b||(b=22)}this.wc.Eg(0===b,a.Sb,b)}else this.wc.Eg(!1,a.Sb,20)}}}Object(e.a)(TN,"CutCopyManager",null,[1125,106]);var YQ=d(889);class UN{constructor(a,b,c){this.oX=a;this.oX.Yj(Object(C.a)(this,this.fh,"onPropertyChanged"));this.EL=b;this.EL.Yj(Object(C.a)(this,this.fh,"onPropertyChanged"));this.Aq=c}fh(a,b){this.Aq.Nq&&0<this.Aq.Nq.length&&(this.Aq.Nq=Qa.a.Zna(this.Aq.Nq,c=>!(Ga.a.sP(c.id,b.node.id)||Object(Ma.a)(Sv.a,c))));this.Aq.Nq&&!this.Aq.Nq.length&&
(this.Aq.Nq=null)}}Object(e.a)(UN,"GraphNodeChangeListener",null,[]);class VN{constructor(a,b){this.C8b=null;a&&b&&new UN(a,b,this)}get Nq(){return this.C8b}set Nq(a){const b=this.C8b&&0<this.C8b.length?this.C8b[0]:null,c=a?a[0]:null,f=!!b&&!!c&&b.id.equals(c.id)&&b.BGf;this.C8b=a;c&&(c.BGf=f,c.sQf=f&&b?b.sQf:YQ.a.create().toString())}}Object(e.a)(VN,"InternalClipboard",null,[1124]);class WN{constructor(a,b,c,f,l,x,G,R,fa,wa){this.yFg=a;this.nj=b;this.Ida=c;this.fGa=f;this.j9=l;this.Ea=x;this.$me=
G;this.zLg=R;this.H5j=fa;this.a1c=wa}yKe(a,b,c){this.yFg.yKe(a,b,c);b=new iM.a;this.$me&&c||(b.setValue(tb.a.bold,!1),b.setValue(tb.a.underline,!1),b.setValue(tb.a.Cw,ad.Font.LU),b.setValue(tb.a.strikethrough,!1),b.setValue(tb.a.italic,!1),b.setValue(tb.a.Qs,!1),b.setValue(tb.a.WZ,!1));this.nj.LLe(a,b)}NKe(a,b,c){const f=b.cache;if(this.a1c){var l=this.x3i(b);Ka.a.Va(l)||c?f.propertySet.Sa(tb.a.font)&&(f.sa(sb.a.yTc,!1)||c)&&this.nj.ZX(a,f.eN):this.nj.ZX(a,l);f.ssa&&this.nj.Jr(a,f.fontSize)}else this.yFg.NKe(a,
b,c);(!this.zLg||this.$me&&c)&&f.Y2&&(this.nj.um(a,tb.a.fontColor,f.fontColor),this.zLg&&(l=xm.SchemeColor.create(null,f.fontColor),this.nj.um(a,sb.a.schemeColor,l.toString())));this.$me&&c&&(this.nj.xJ(a,f.isBold),this.nj.setItalic(a,f.isItalic),this.nj.cY(a,f.rF),this.nj.Hgb(a,f.TZ),this.nj.E0(a,f.GD),this.nj.qna(a,f.Cw),this.nj.AYa(a,f.Qs),this.nj.Lgb(a,f.WZ),this.nj.k5(a,f.sF),this.nj.eY(a,f.isSuperscript),this.nj.axa(a,f.Rm));this.nj.AYa(a,!1);this.w6k(a,b)}X0d(a){return this.Ida.YQa(a)}YV(a){return this.Ida.YV(a)}hRa(a){return this.fGa.hRa(a)}I7(a){return this.j9.I7(a)}w6k(a,
b){b=b.Iz;if(null!==b&&b.Sa(sb.a.jIa)){b=b.getValue(sb.a.jIa);var c=a.Iz;null===c?this.nj.um(a,sb.a.jIa,b):c.setValue(sb.a.jIa,b)}}urh(a){return this.H5j&&a&&(a=a.paragraph)&&(a=this.Ea.tn(a))&&a.Pf?!0:!1}x3i(a){if(!this.a1c||!a)return null;let b="";var c=a.paragraph;if(!c)return null;var f=this.Ea.tn(c);if(!f)return null;a=f.sa(Mb.a.e_,[]);c=c.sa(Mb.a.listLevel,og.a.pDa);a&&0<=c&&c<a.length&&(f=f.Fh)&&(a=f.te(a[c]))&&(a.Sa(sb.a.TSd)?b=a.getValue(sb.a.TSd):a.Sa(sb.a.QSd)?b=a.getValue(sb.a.QSd):a.Sa(sb.a.NSd)?
b=a.getValue(sb.a.NSd):a.Sa(sb.a.XSd)&&(b=a.getValue(sb.a.XSd)));return b}}Object(e.a)(WN,"PPTFormattingStewardBridge",null,[1106]);class XN{constructor(a,b,c,f){this.lc=c;this.bA=f}}Object(e.a)(XN,"PPTFormattingStewardHelper",null,[1111]);class YN{constructor(a,b,c,f,l){this.h8j=[Mb.a.Rl,Mb.a.Tn];this.la=a;this.ayb=b;this.aJg=c;this.VN=f;this.Nb=l;this.$0c=a.Kxg;this.kua=a.pptCopyPasteListMarkerEnabled;this.B$b=a.pptCopyPasteMarginAndIndentationEnabled}PTe(a){return this.ayb.vMj(a)}p5d(a,b){return this.ayb.dPi(a,
b)}ona(a,b,c,f=null,l=null){if(this.aJg.Aad)if(this.ayb.Wug(c))a.setValue(Oc.a.gvg,!0);else if(this.ayb.Rk(c)){if(this.B$b&&a&&b){var x=this.Nb.Kc(a);x.pc(11);x.Rg(11);c=Ib.ListReader.kk(x);const G=this.VN.C3i(a,x);x=this.VN.y3i(a,x);c&&(f||(Aa.a.J(41219841,826,50,"Default marginLeft for internal"),b[Mb.a.Rl.id.toString()]=G),l||(Aa.a.J(41219843,826,50,"Default textIndent for internal"),b[Mb.a.Tn.id.toString()]=x));f&&Aa.a.J(41018240,826,50,"Customized marginLeft");l&&Aa.a.J(41018242,826,50,"Customized textIndent")}this.aJg.ona(a,
b)}if(this.la.nUc&&!yb.ParagraphReader.mW(a))for(const G of this.h8j)void 0===a.Xh(G)&&a.me(G,0)}rHb(a,b,c){if(this.$0c){var f=b.propertySet.Sa(tb.a.Ni)?b.propertySet.getValue(tb.a.Ni).length:1;if(a=this.VN.PP(a,b.propertySet.sa(Mb.a.listLevel,0)))if(this.kua&&(0<c.opb||c.wOa&&0<c.wOa.length)){f="";b.$7a&&!b.xlg&&(f=c.font);let l=null;c.wOa&&0<c.wOa.length&&(l=c.wOa,1===c.wOa.length&&Aa.a.J(41219847,826,50,"Customized bullet."));let x=-1;0<c.opb&&(x=c.opb,Aa.a.J(41219849,826,50,"Customized number list."));
this.VN.fGc(a,b.propertySet);l&&b.propertySet.setValue(tb.a.Ni,l);Ka.a.Va(f)||b.propertySet.setValue(tb.a.font,f);0<x&&b.propertySet.setValue(sb.a.autonumberBulletType,x)}else a.sa(tb.a.Ni,[]).length===f&&this.VN.fGc(a,b.propertySet)}}$Tc(a){return this.ayb.$Tc(a)}get VUc(){return this.ayb.VUc}C0(a,b){2===b.Sf?(a.setValue(sb.a.yW,2),a.setValue(sb.a.Zw,b.value)):Aa.a.J(36779851,826,50,"the un-support text spacing unit")}cJa(a,b){b.beforeSpacing.value&&(a.setValue(sb.a.Tca,b.beforeSpacing.value),a.setValue(sb.a.Zja,
4));b.afterSpacing.value&&(a.setValue(sb.a.Sca,b.afterSpacing.value),a.setValue(sb.a.Yja,4))}Boh(a,b){const c=(new ov.a(b.Sf,b.value)).oM;1===b.specialIndentType?a.setValue(Mb.a.Tn,c):2===b.specialIndentType?a.setValue(Mb.a.Tn,-c):0===b.specialIndentType&&a.setValue(Mb.a.Tn,0)}snh(a,b){b=(new ov.a(b.Sf,b.value)).oM;a.setValue(Mb.a.Rl,b)}get xrh(){return!0}}Object(e.a)(YN,"PPTPasteStewardBridge",null,[476]);class ZN extends mv{constructor(a,b){super(a,b)}XLc(){return["PasteSlide"]}}Object(e.a)(ZN,
"PasteSlideReactFloatie",mv,[]);class $N{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe,Te,We){this.$kg=!1;this.JQ=[];this.Mbc=[];this.Jfe=[];this.eie=0;this.uc=c;this.ra=f;this.Wcb=l;this.Ucb=x;this.Gla=G;this.Wc=R;this.Dpe=ie;this.od=a;this.Sak=b;this.Hk=Wa;this.X8j=fa;this.Zb=mb;this.Fa=Kb;this.Dr=nc;this.O3j=oc;this.G3j=Ic;this.Xb=Kc;this.jQg=Hc;this.fc=He;this.a9j=fe;this.kh=We;this.M$a=fb.a.instance.qb("Common.IReactContextualUILauncher");this.Myb=fb.a.instance.qb("Common.IExternalUICommandDefinitionMapping")}a$(a){2===
a.behavior&&(a=a.actionId,a!==ba.a.l4a&&a!==ba.a.vOa&&a!==ba.a.kHa&&a!==ba.a.dea&&a!==ba.a.wqa&&a!==ba.a.qS&&a!==ba.a.insertPicture&&a!==ba.a.kHa&&a!==ba.a.w6a&&a!==ba.a.MYd&&a!==ba.a.zLc&&a!==ba.a.insertPicture&&a!==ba.a.LYd&&a!==ba.a.i7g&&a!==ba.a.Cad||this.YM(new jc(!0)))}Z9(){}A3h(){this.Dpe&&!this.$kg&&(this.ra.VH(Object(C.a)(this,this.rea,"onSelectionChange")),this.Sak.vd(7).nG(Object(C.a)(this,this.fB,"onChildTopologyChanged")),this.od.yAa(Object(C.a)(this,this.GX,"onThumbnailDrawCompleted")),
Ed.a.addHandler(this.Gla.aU,"scroll",Object(C.a)(this,this.gYa,"scrollHandler")),Ed.a.addHandler(this.kh.contentWindow.document.body,ma.a.Xf,Object(C.a)(this,this.onKeyDown,"onKeyDown")),this.Wc.ob(ma.a.click,this.Gla.aU,Object(C.a)(this,this.MB,"clickHandler")),u.AFrameworkApplication.Aa.uha(Object(C.a)(this,this.Sea,"resizeHandler")),this.X8j.B3a(Object(C.a)(this,this.f0,"onSlidePresenceChanged")),this.Hk.rFf(Object(C.a)(this,this.Hye,"onSlidesIdReturned")),this.O3j.GBc(Object(C.a)(this,this.k$c,
"onRevisionProcessedOnServerHandler")),this.G3j.Z5h(Object(C.a)(this,this.ikk,"onBlockingHandler")),this.a9j.fFf(Object(C.a)(this,this.yok,"onOnlyKeyPressed")),this.$kg=!0)}yok(){if(dN.a.instance.keyCode===w.a.Hfa){const c=document.getElementById("PasteSlideControl");if(c){var a=ib.a.ei(c),b=this.jQg.xa.style.height;a.y+a.height+61+2<parseInt(b.substr(0,b.length-2))+Kz.a.CUe?Aa.a.J(512497815,826,10,"recoveryUIElement rendering to wrong place"):(a=c.getAttribute(Jc.a.Pob)||"",Jc.a.lqa===a&&c.click())}else Aa.a.J(512497816,
826,10,"recoveryUIElement is null")}}onKeyDown(a){a.keyCode===w.a.Z0&&this.YM(new jc(!0))}ikk(a,b){1===b.block?this.YM(null):2===b.block&&this.YM(new jc(!0))}k$c(a,b){b&&(a=b.o$)&&a.ActionInformation.ActionId!==""+ba.a.Fad&&a.ActionInformation.ActionId!==""+ba.a.cgc&&a.ActionInformation.ActionId!==""+ba.a.Ead&&this.Dr.NWc&&this.Dr.NWc<parseInt(a.ActionInformation.ActionTime)&&this.YM(new jc(!0))}f0(a,b){this.y5f(b.slideId.sid,this.JQ)&&(this.YM(new jc(!0)),this.Dr.qhb=!1)}y5f(a,b){for(const c of b)if(c.sid===
a)return!0;return!1}Hye(a,b){if(b&&b.yWa){if(this.Jfe.length>=b.yWa.length&&!this.M$a.Wvb&&(this.setSelection(b.yWa),this.JQ.length===b.yWa.length)){this.showFloatie({},new ik(1,u.AFrameworkApplication.isRtl));let c;(c=this.ra).w3a.apply(c,this.JQ)}this.Dr.OHa.length||(this.Dr.OHa=b.yWa,Array.clear(this.JQ),Array.clear(this.Mbc))}}rea(a,b){if(this.Dr.qhb){for(a=0;a<b.hE.length;a++)if(Object(ua.a)(4,b.hE[a].context.node)){this.YM(new jc(!0));return}!this.Fa.ze||this.Fa.ze.name!==zi.a.c2&&this.Fa.ze.name!==
zi.a.TLf&&this.Fa.ze.name!==zi.a.QLf&&this.Fa.ze.name!==Yb.a.OF&&this.Fa.ze.name!==Yb.a.PK&&this.Fa.ze.name!==Yb.a.FZ||this.YM(new jc(!0))}}Sea(){this.M$a.Wvb&&this.YM(new jc(!1))}gYa(){this.pch()}MB(){this.pch();return!0}pch(){if(this.Dr.qhb){const a=new ik(1,u.AFrameworkApplication.isRtl);this.showFloatie(null,a)}}GX(a,b){a=this.Dr.OHa;this.Jfe.push(b.Ed);if(!this.M$a.Wvb&&this.Dr.qhb&&a&&a.length>=this.Mbc.length&&b.succeeded)for(var c of a)if((b=this.uc.kl(new Oe.a(c)))&&!this.y5f(b.sid,this.Mbc)&&
(this.Mbc.push(b),this.eie++,b=a.length,this.eie===b)){this.ra.FYb();this.setSelection(a);var f=void 0;(f=this.ra).w3a.apply(f,this.JQ);if(c=this.M5i())this.Zb.Ba=c;this.eie=0;c=!0;for(f=0;f<b;f++)(a=this.JQ[f].sg(this.Wcb))&&a.Keb&&a.Keb.K7()&&0<a.Keb.K7().length&&(c=!1);c&&this.showFloatie({},new ik(1,u.AFrameworkApplication.isRtl));break}}M5i(){let a=this.JQ.length;if(!a&&(this.setSelection(this.Dr.OHa),a=this.JQ.length,!a))return Aa.a.J(512497814,826,50,"GetLastPastedSlideNode and selectedNode is empty"),
null;let b=this.JQ[0];for(let c=1;c<a;c++)b.slideIndex>this.JQ[c].slideIndex&&(b=this.JQ[c]);return b}setSelection(a){if(a&&a.length){Array.clear(this.JQ);for(const b of a)(a=this.uc.kl(new Oe.a(b)))?this.JQ.push(a):Aa.a.J(512497813,826,50,"Cannot find the slide")}}h8i(){let a=this.JQ.length;if(!a&&(this.setSelection(this.Dr.OHa),a=this.JQ.length,!a))return Aa.a.J(512497812,826,50,"GetLastPastedSlideNode and selectedNode is empty"),null;Aa.a.J(512497811,826,50,String.format("Pasted slides count is: {0} ",
a));let b=this.JQ[0];for(let c=1;c<a;c++)b.slideIndex<this.JQ[c].slideIndex&&(b=this.JQ[c]);return b}showFloatie(a,b){b.location=this.wNc();if(b.location){const c=this.Xb.Zc(this.uc.Gn);if(!c||c&&a)Aa.a.J(512497810,826,50,"ShowFloatie number"),this.fc.ka("ReactSlidePasteFloatieEnabled")&&(new ZN(this.M$a,this.Myb)).ksh(b.location,b.jv),Array.clear(this.Jfe)}}YM(a){this.M$a.Wvb&&(this.M$a.YM(),a&&(this.Dr.qhb=!a.S4f,a.S4f&&this.Dr.teb&&(a=this.Dr.teb.kA,null!=a&&Aa.a.J(512497809,826,50,String.format("last user selcted keepSource:{0}",
a.toString()))),this.Dr.qhb||(this.Dr.NWc=0)))}isi(a){if(!this.Dr.hYb)return!0;a=a.CJ;if(a.length!==this.Dr.hYb.length)return!0;let b=0;for(let c=0;c<a.length;c++)if(a[c]&&!a[c].equals(this.Dr.hYb[c])||!a[c]&&this.Dr.hYb[c])if(b++,b>this.Mbc.length)return!0;return!1}fB(a,b){this.M$a.Wvb&&(a=Object(ua.a)(526,b.node))&&this.isi(a)&&this.YM(null)}wNc(){var a=this.h8i();if(!a)return Aa.a.J(512497808,826,50,null),null;a=a.sg(this.Wcb);if(!a)return Aa.a.J(512497807,826,50,null),null;a=ib.a.ei(a.qib);const b=
a.x+a.width-86;let c=a.y+a.height+61+2;const f=this.Ucb.xa.style.height;var l=this.jQg.xa.style.height;l=parseInt(l.substr(0,l.length-2))+Kz.a.CUe;if(c>parseInt(f.substr(0,f.length-2))+l)c=c-a.height/2-2;else if(c<l)return this.YM(new jc(!1)),null;this.Dr.position=new Sys.UI.Point(b,c);return this.Dr.position}}Object(e.a)($N,"PasteFloatieHelper",null,[1110,147]);class ME{constructor(){this.qhb=!1;this.NWc=0;this.teb=null;this.Uze=0;this.Lbb=[];this.position=this.hYb=null}get OHa(){return this.Lbb}set OHa(a){a?
this.Lbb=a:Array.clear(this.Lbb)}}Object(e.a)(ME,"PasteFromFloatieArgs",null,[]);var ZQ=d(1011);class aO{v4b(a){a=a.Bba;return a===Yb.a.Bg||a===Yb.a.vE||a===Yb.a.rU}}Object(e.a)(aO,"PasteHandlerUtil",null,[1127]);class bO{constructor(a,b,c,f,l,x){this.kT=0;this.ia=a;this.X3=b;this.gGa=c;this.ax=f;this.qme=l;this.R4j=x}NP(a){if(!this.gGa.v4b(this.X3.value))return!1;if(this.ax.TEj(a)){a=Array.isArray(a.eW)?a.eW:null;if(this.Rsj(a)&&!this.ptj(a))return!1;this.kT=1}else if(this.qme&&(this.ax.REj(a)||
this.ax.QEj(a))){a=this.ax.z$d(a.lu);if(!this.R4j&&a)return Z.ULS.sendTraceTag(36558551,307,50,"Cross-dc shape pasting is not allowed since its BRS is off."),this.kT=0,!1;this.kT=2}else this.kT=0;return 0!==this.kT}paste(a){1===this.kT?this.ia.La(ba.a.Bad,2,a):2===this.kT&&this.ia.La(ba.a.V5g,2,a)}Rsj(a){for(const b of a)if(!b.isConnected)return!0;return!1}ptj(a){for(const b of a)if(a=b.shapeNode,!a.wk&&!a.qd)return!0;return!1}}Object(e.a)(bO,"ShapePasteHandler",null,[1166]);class cO{constructor(a,
b,c){this.kT=0;this.ia=a;this.ax=b;this.e$b=c}NP(a){this.ax.Ltg(a)?this.kT=1:this.e$b&&this.ax.SEj(a)?this.kT=2:this.kT=this.ax.VEj(a)?3:0;return 0!==this.kT}paste(a){a.kA=null!=a.kA?a.kA:!0;re.a("UseClipServiceForDestinationThemePaste")&&1===this.kT&&!a.kA&&a.lu&&(this.kT=2);1===this.kT?this.ia.La(ba.a.Cad,2,a):2===this.kT?(a.lu?Aa.a.J(512356509,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams keepsource value {0}",a.kA):Aa.a.J(512356508,826,50,"SlidePasteHandler:Paste FromClipService, pasteParams is null"),
this.ia.La(ba.a.Ead,2,a)):3===this.kT&&this.ia.La(ba.a.X5g,2,a)}}Object(e.a)(cO,"SlidePasteHandler",null,[1166]);class NE{constructor(a,b,c,f){this.aHg=[$e.a.lng,$e.a.uJb,$e.a.sxh,$e.a.eld];this.ia=a;this.Fa=b;this.gGa=c;this.ax=f}NP(a){if(!this.gGa.v4b(this.Fa)||NE.PMj(a)||this.ax.fSj(a))return!1;a.NP=!this.ovi(a.$m);return a.NP}ovi(a){for(let b=0;b<this.aHg.length;++b)if(0<a.getElementsByTagName(this.aHg[b]).length)return!0;return!1}paste(a){Aa.a.J(17310408,826,50,"TextPasteHandler: Execute command to paste text as new shape.");
this.ia.La(ba.a.Xze,2,a)}static PMj(a){if(!a||!a.$m)return Aa.a.J(17310404,826,15,"TextPasteHandler: User attempted to paste null content."),!0;a=Ca.b(a.$m);return a&&a.length?!1:(Aa.a.J(17310406,826,15,"TextPasteHandler: User attempted to paste empty content."),!0)}}Object(e.a)(NE,"TextPasteHandler",null,[1166]);var $Q=d(867),aR=d(1016),bR=d(432),mA=d(665);class dO{constructor(a,b){this.gwa=a;this.pastedContent=b}}Object(e.a)(dO,"PasteContext",null,[]);class eO{constructor(a){this.$ne=0;this.TBb=
null;this.gak=a;this.Lcb=this.gak.nCb("UserAction","TimingLogger");this.reset()}start(){this.reset();this.Lcb.start()}TTb(a){if(a&&0<a.length){this.TBb||(this.TBb={});const b=this.Lcb.Kq;this.TBb[a]=b-this.$ne;this.$ne=b}}flush(a=null){let b="";a&&0<a.length&&(b=a+":");if(this.TBb){a=this.TBb;for(let c in a)b+=String.format(" {0}={1}ms,",c,a[c])}0<b.length&&Aa.a.J(20570128,826,50,b);this.reset()}reset(){this.$ne=0;this.TBb=null}}Object(e.a)(eO,"TimingLogger",null,[]);class Yp{constructor(){this.objectCount=
0;this.data=this.ccpid=null;this.contentType=this.dataSize=this.errorInCopying=0;this.packageSize=this.packageKey=this.isDataCompressed=null;this.skipUndo=!1;this.selectionSlide=null}static HBi(a){if(!a)return null;a=a.getData(Yp.Zhi);return Yp.sog(Yp.jch(a))}static IBi(a){return a?Yp.sog(Yp.jch(a.pptSlide)):null}static sog(a){if(!a||0===a.contentType)return Aa.a.J(541405764,826,15,"InitPicklingClipboardObject mimetype not supported"),null;a.dataSize=a.data?a.data.length/Yp.Uhi:Number.MAX_VALUE;a.skipUndo=
!1;Aa.a.J(540932290,826,50,"InitPicklingClipboardObject successful ccpid: {0}, datasize: {1}, objectCount: {2}, errorCode: {3}",a.ccpid,a.dataSize,a.objectCount,a.errorInCopying);return a}static lSj(a){return!!a&&0<a.objectCount&&!!a.ccpid&&(!!a.data||!a.data&&!!a.errorInCopying)&&null!=a.isDataCompressed}static jch(a){try{let b=null;if(!a)return null;b=JSON.parse(a);if(Yp.lSj(b))return b.contentType=1,b.errorInCopying=void 0===b.errorInCopying||null===b.errorInCopying?0:b.errorInCopying,b}catch(b){Aa.a.J(541405765,
826,15,"ReadPicklingData exception occured in parsing")}return null}}Yp.Uhi=1048576;Yp.Zhi="ppt/slides";Object(e.a)(Yp,"PicklingClipboardObject",null,[]);var cR=d(666);class qh{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie,He,fe){this.ine=!1;this.gPg=0;this.xVa=null;this.ecc=!1;this.Zne=null;this.bne=!1;this.X3=a;this.kh=b;this.Aq=c;this.z$a=l;this.la=f;this.nl=x;this.Ar=G;this.dda=this.kh.contentWindow.document.body;this.Ar.addHandler(this.dda,ma.a.paste,Object(C.a)(this,this.Kwe,
"onBrowserPaste"));this.Md=R;this.Eo=fa;this.X9b=Kb;this.Ila=new eO(wa);this.ika=mb;this.$ac=null;this.h6j=f.$Qj;this.ILg=this.Eo.zN(7);this.ax=Wa;this.gT=nc;this.hT=oc;this.Ea=Kc;this.lc=Ic;this.wc=Hc;this.I_=ie;this.ia=He;this.Koe=f.pptEditingImageMaxSizeInBytes;this.mNg=Math.floor(f.pptEditingImageMaxSizeInBytes*qh.RJf);this.CKg=f.Ptg;this.e$b=f.i$d;this.J4j=f.PFj;this.iRg=f.ZNj&&this.Eo.oW;this.Ane=this.k1c=!1;this.qme=f.h$d;this.QKg=f.Yug&&this.Eo.io;this.x$j=f.M6i&&this.Eo.eg;this.d0j=f.pptCopyPasteRotateImageOnSafariFixIsEnabled&&
this.Eo.cta;this.c5j=this.la.sIj;this.sQ=fe}dispose(){this.kh&&this.Ar.removeHandler(this.dda,ma.a.paste,Object(C.a)(this,this.Kwe,"onBrowserPaste"));this.Ila=this.kh=null}fwk(a){a===this.Zne.Sb&&this.ia.La(ba.a.bgc,2,this.Zne)}Kwe(a){const b=this.wc.FO(2,0,"OnBrowserPaste");this.Ila.start();this.k1c=this.bne=!1;if(Lk&&Lk.nA&&!Lk.nA.DWd){!this.Eo.tF||this.Eo.Nj||this.d0j?$e.a.MEc(this.kh):this.z$a.mgb(this.kh);var c=this.hT.bca(a);c=this.ax.WUc()?Yp.HBi(c):null;var f=new sE;f.uUd=a;f.M8g=b;null!=
this.xVa&&(this.wc.Wh(qh.aMf,"menu",b),this.wc.Wh(qh.ZLf,this.xVa?qh.cii:qh.aii,b));this.ecc&&(this.wc.Wh(qh.aMf,"menu",b),this.wc.Wh(qh.ZLf,qh.bii,b));!this.ecc&&c&&this.K5g(c,null,b,ba.a.Dad,f)?this.xVa=null:(this.J5g(a,b),this.xVa=null,this.ecc=!1)}}J5g(a,b){var c=this.hT.bca(a);const f=this.hT.v3f(c);this.wc.KLe(f,b);if(!this.srl(a,b)){var l=Object.assign(new Fm.a(!0),{Sb:b,kA:this.xVa}),x=null;u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SlideSorterPasteViaKeyboardEnabled",
!1)&&document.activeElement.classList.contains("grid-content-editable-cursor-hide-class")&&(Aa.a.J(509669642,826,50,"Getting html from dom event for slide sorter"),(x=a=this.hT.Q0b(c))||(x=c.getData("text/plain")));this.x$j&&(Aa.a.J(512356507,826,50,"OnBrowserPaste::Getting html data from Clipboard"),c=this.hT.Q0b(c),a=this.hT.$Wa(c),c?(this.dPf(a)&&(this.Aq.Nq[0].y4a=a.firstChild.className,l.eW=null),l.$m=a):Aa.a.J(512356506,826,15,"OnBrowserPaste::htmlString is empty"));this.Zne=l;Nc.a.z$(()=>{this.jwe(void 0,
l,x)},0,this.la.sMj?0:2)}}Kmi(a){let b=!1;Lk.nA.r4a(c=>{Aa.a.J(512356505,826,50,"CheckAndEnablePasteAsOptions: isAccessible : {0}",c);null!=c&&c&&(b=this.Rmi(a))});return b}Rmi(a){const b=Date.now();let c=!1;Lk.nA.bca(this.kh,a,f=>{Aa.a.J(512356504,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, time taken : "+(Date.now()-b));if(f){if(!a)f.html&&f.html.length<=qh.Rii?-1!==f.html.indexOf(qh.kji)&&(c=!0):f.pptSlide&&f.pptSlide.length&&(c=!0);else if(f.img||f.isImageAvailable)c=
!0;c&&(f=[],a?(f.push(appChrome.actions.updateControlEnabledDisabledState(qh.eji,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(qh.dji,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(qh.cji,!1))):(f.push(appChrome.actions.updateControlEnabledDisabledState(qh.uii,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(qh.mji,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(qh.wii,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(qh.oji,
!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(qh.vii,!1)),f.push(appChrome.actions.updateControlEnabledDisabledState(qh.nji,!1))),appChrome.api.dispatch(f));Aa.a.J(512356502,826,50,"CheckClipboardDataAndEnablePasteAsOptions: isCopiedDataCompatible={0}, time taken : {1}",c,Date.now()-b)}else Aa.a.J(512356503,826,50,"CheckClipboardDataToEnablePasteAsOptions: GetClipboardData returned, clipboardObject is null")});return c}K5g(a,b,c,f,l){b||(b=Object.assign(new Fm.a(!0),{Sb:c,kA:this.xVa}));
b.SL=a;this.wc.Wh(qh.objectCount,a.objectCount.toString(),c);this.wc.Wh(qh.isDataCompressed,null==a.isDataCompressed?!1:a.isDataCompressed.toString(),c);this.wc.Wh(qh.fji,(b.SL.packageSize?null==b.SL.packageSize?0:b.SL.packageSize/qh.RJf:b.SL.dataSize).toString(),b.Sb);return 0!==b.SL.errorInCopying?(Aa.a.J(541647952,826,15,"PastePicklingData invalid package ccpid: {0}, objectCount: {1}, error: {2}",b.SL.ccpid,b.SL.objectCount,b.SL.errorInCopying),this.ish(b.SL.errorInCopying,f,l,b),!0):this.ax.UMj(b.SL.dataSize)?
this.ZTd(b):(Aa.a.J(541647953,826,15,"PastePicklingData package size exceeds limit ccpid: {0}, size: {1}, objectCount: {2}",b.SL.ccpid,b.SL.dataSize,b.SL.objectCount),this.ish(1,f,l,b),!0)}ish(a,b,c,f){switch(a){case 1:this.wc.Eg(!1,f.Sb,27);this.sQ.nxa(ResourceStrings.l_PasteAsImageErrorCalloutTitle,ResourceStrings.l_PasteAsImageErrorCalloutMessage,!0,ResourceStrings.l_PasteAsImageButtonTitle,!0,CommonUIStrings.l_DialogCancel,b,0,c,null,!1,qh.$Lf);break;default:this.wc.Eg(!1,f.Sb,28),this.sQ.nxa(ResourceStrings.l_SomethingWentWrongCalloutTitle,
ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,qh.$Lf)}}Dad(a,b){Aa.a.J(512356499,826,50,"PasteSlideAsImage called");const c=this.wc.FO(2,0,"PasteSlideAsImage");this.wc.Wh("PasteSlideAsImage",b,c);this.Ila.start();this.k1c=this.bne=!1;this.J5g(a,c)}Sni(a){a=a.split("+");const b=this.lc.ig(this.Aq.Nq[0].Ed).Bb;return b.cid.toString()===a[0]&&b.sid.toString()===a[1]}srl(a,b){let c=!1,f=this.ecc;var l=this.hT.d_d(a.rawEvent,this.kh.contentWindow);if(l){let x=null;({H3b:x,
PXg:l}=this.hT.Pmd(l,this.la.clipboardDataImageBlobNumberLimitaton,this.CKg?50*qh.cIh:this.mNg));this.Ila.TTb("GetBlob");0<l&&(Aa.a.J(512356498,826,50,"Blob is too large"),this.Bjd(b),c=!0);x&&1===x.length&&(Nc.a.z$(()=>{this.xki(x,b,f)},0),this.iRg&&a.preventDefault(),c=!0)}else this.h6j&&this.ILg&&(this.$ac=this.ika.Yrl(a.rawEvent));c&&this.wc.oB(5,b);return c}xki(a,b,c){if(c||a&&(this.hT.mod(this.dda)||this.iRg)){const f=a[0],l=Nc.a.Eb;Nc.a.qk(si.a.sei,f.size.toString());this.CKg&&f.size>=this.mNg?
(this.Ane&&Aa.a.J(512356497,826,50,"Ctrl-v pressed while shrinking image"),this.X9b.ECg(f,x=>{Nc.a.cF(l,()=>{x&&this.Lfl(x,f.size,b)||(this.k1c=!0,this.jwe(b));this.Ane=!1})}),this.Ane=!0):(new $Q.a).sAh(a,x=>{Nc.a.cF(l,()=>{this.h7i(x,b)})})}else this.jwe(b)}h7i(a,b){this.Ila.TTb("GetDataUrl");this.Dsl(a,b)||(Aa.a.J(512356496,826,15,"Paste image data uri failed"),this.paste(Object.assign(new Fm.a(!0),{Sb:b}),null,!1))}jwe(a="",b=null,c=null){this.paste(b||Object.assign(new Fm.a(!0),{Sb:a}),c,!1)}pwk(a,
b){if(Lk.nA){Aa.a.J(512356495,826,50,"PasteManager::PastePicklingData called ccpCorrId: {0}",a.Sb);var c=Date.now();Lk.nA.bca(this.kh,a.a6a,f=>{a.a6a&&(f.html=null,f.pptSlide=null,f.text=null);this.GXj(f,c);if(f=Yp.IBi(f)){var l=new tE;l.pastedContent=b;l.gwa=a;this.K5g(f,a,a.Sb,ba.a.W5g,l)}else this.paste(a,b,!0)})}}GXj(a,b){if(a){var c=a.img?a.img.length:0,f=a.html?a.html.length:0,l=a.text?a.text.length:0;a=a.pptSlide?a.pptSlide.length:0;Aa.a.J(512356493,826,50,"LogClipboardObjectLength:: timeTaken: {0}, imgLength: {1}, htmlLength: {2}, textLength: {3}, pptSlideLength: {4}",
Date.now()-b,c,f,l,a)}else Aa.a.J(512356494,826,50,"clipboardObject is null")}paste(a,b,c){if(this.ia.pW)this.I_.show(5,-1),this.wc.Eg(!1,a.Sb,26);else if(a.C3f)this.q5d(a,b);else if(Lk.nA){var f=this.Eo.QS&&u.AFrameworkApplication.fa.ka("ElectronClipboardAccessFix");this.la.gTc&&!f||this.QKg?(a.SL=null,this.ax.WUc()&&!c?this.pwk(a,b):(Aa.a.J(512356492,826,50,"Paste::m_isEdgeContextMenuPasteFixEnabled {0} or IsChromeClipboardAccessEnabled: {1} is enabled",this.QKg,this.la.gTc),this.pIe(a,b))):(this.xVa=
a.kA,this.ecc=a.a6a,this.ax.WUc()&&Lk.nA.Lql(this.kh,a.Sb)?(this.wc.Wh(qh.ywk,"true",a.Sb),this.wc.Eg(!0,a.Sb)):(this.xVa=null,({content:b}=Lk.nA.paste(this.kh,this.X3.value,a.Sb,!1)).returnValue?this.q5d(a,b):(Lk.nA.Qba(!1),b=Lk.nA.Px,null==b?(a=new hd.a(null,Object(C.a)(this,this.JRi,"fWaitForAsyncAPIResult"),Object.assign(new yE,{kd:a.Sb})),a.Fl("ClipboardPreProcessForAsyncAPI"),a.run()):null!=b&&b&&this.pIe(a,null))))}else this.wc.Eg(!1,a.Sb,1)}JRi(a,b){a=Lk.nA.Px;if(null==a)return!0;b=b.kd.toString();
a?this.pIe(Object.assign(new Fm.a(!1),{Sb:b}),null):this.wc.Eg(!1,b,29);return!1}pIe(a,b){this.gPg=Date.now();this.ine=!1;Lk.nA.prepareForPaste(a.a6a,c=>{this.wc.Wh("isPasteFromAsyncApi",c.toString(),a.Sb);this.ine=!0});b=new dO(a,b);(new hd.a(null,Object(C.a)(this,this.prepareForPaste,"prepareForPaste"),b)).run()}Vze(a,b){return a&&0<a.length?(a=Object.assign(new Fm.a(!0),{Sb:b,m7d:a,nKc:!0}),this.ZTd(a),!0):!1}prepareForPaste(a,b){a=!0;let c=!1;if(this.ine){let f;({content:f}=Lk.nA.paste(this.kh,
this.X3.value,b.gwa.Sb,b.gwa.a6a)).returnValue&&f?this.q5d(b.gwa,f):c=!0;a=!1}else Date.now()-this.gPg>this.la.mPf&&(Aa.a.J(512356491,826,50,null),a=!1,c=!0,Lk.nA.reset());c&&this.wc.Eg(!1,b.gwa.Sb,29);return a}get ral(){return this.Eo.Aj&&this.la.wFj}q5d(a,b){if(!a.$m)if(Aa.a.J(512356490,826,50,"HandlePasteContent::pasteParams.PastedHtml is empty"),!b||a.Uxg&&this.ral)if(this.Wal()){b=$e.a.SB();b.src=this.$ac;this.$ac=null;var c=$e.a.Ce();c.appendChild(b);a.$m=c}else this.dPf(this.dda)&&(Aa.a.J(512356488,
826,50,"HandlePasteContent::CheckWhetherFixClipboardId is true"),this.Aq.Nq[0].y4a=this.dda.firstChild.className,a.eW=null),Aa.a.J(512356487,826,50,"HandlePasteContent::Using m_body for PastedHTML."),a.$m=this.dda;else Aa.a.J(512356489,826,50,"HandlePasteContent::Paste not from IFrame Clipboard or !ShouldGetPastedContentFromClipboardTargetDOM"),c=$e.a.Ce(),aR.a.Fhd(c,b,"PasteManager"),a.$m=c;this.iMd(a);b=this.ax.LHj(a.$m.firstChild);c=this.ax.OHj(a.$m.firstChild);if(b||c)Aa.a.J(512356486,826,50,
"HandlePasteContent:pasteParams.PastedHtml is empty clipboard {0} / empty placeholder {1}",b,c),this.wc.Eg(!0,a.Sb);else if(this.SUi(a.$m),b=a.$m.innerHTML.startsWith("<img"),c=a.$m.innerHTML.length,a.C3f&&b&&(this.Ila.TTb("ConvertDataUrlToDOMNode"),this.Ila.flush(String.format("Browser={0}, Length={1}, IsFromBlob={2}",this.Eo.zy,c,this.bne))),!c&&this.k1c)this.Bjd(a.Sb);else{var f=0,l=!1;({KOd:f,GWd:l}=this.qrl(a));1===f?(Aa.a.J(512356485,843,15,"Failed to attach clipServiceObject due to deferred content, IsSlidePaste: {0}",
l),this.wc.Eg(!1,a.Sb,25)):!a.eW&&!a.lu&&c>this.Koe?(re.a("PasteManagerOacr73010Fix")?(this.kh.contentWindow.document.body.innerText="",a.$m.innerText=""):(this.kh.contentWindow.document.body.innerHTML=null,a.$m.innerHTML=null),b?(Aa.a.J(512356484,826,50,"Image too large"),this.Bjd(a.Sb)):(Aa.a.J(512356483,826,50,String.format("Paste content size is {0} which is too big.",c)),this.wc.Eg(!1,a.Sb,7))):(a.lu?(Aa.a.J(512356482,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams keepsource value {0}",
a.kA),this.wc.Wh(Ap.a.Np,a.lu.Np,a.Sb)):Aa.a.J(512356481,826,50,"HandlePasteContent - Before DispatchPaste,  pasteParams ClipServiceObject is null"),this.ZTd(a))}}iMd(a){a?a.$m?a.$m.firstChild?a.$m.firstChild.getAttribute||Aa.a.J(512356449,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild.getAttribute is null"):Aa.a.J(512356450,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml.FirstChild is null"):Aa.a.J(512356451,826,50,"BuildDiagnosticInfo:pasteParams.PastedHtml is null"):Aa.a.J(512356480,
826,50,"BuildDiagnosticInfo:pasteParams is null")}dPf(a){if(!(this.J4j&&a.firstChild&&a.firstChild.tagName&&"A"===a.firstChild.tagName.toUpperCase()&&a.firstChild.getAttribute(Ap.a.type)&&a.firstChild.getAttribute(Ap.a.fhb)&&this.Aq.Nq))return!1;const b=a.firstChild.className;return a.firstChild.getAttribute(Ap.a.sessionId).toString()===this.Aq.Nq[0].sessionId&&b.startsWith("CID")&&b!==this.Aq.Nq[0].y4a&&(Object(Ma.a)(mA.a,this.Aq.Nq[0])&&"shape"===a.firstChild.getAttribute(Ap.a.type).toString()&&
this.Qni(a.firstChild.getAttribute(Ap.a.fhb).toString())||Object(Ma.a)(Sv.a,this.Aq.Nq[0])&&"slide"===a.firstChild.getAttribute(Ap.a.type).toString()&&this.Sni(a.firstChild.getAttribute(Ap.a.slideId).toString()))}Qni(a){a=a.split(",");let b=0;if(a.length!==this.Aq.Nq.length)return!1;for(const c of a)for(const f of this.Aq.Nq)if(c===this.Ea.aub(f.shapeNode).toString()){b++;break}return b===a.length}ZTd(a){let b=!1;for(let c=0;c<this.nl.length;c++)if(this.nl[c].NP(a)){b=!0;this.nl[c].paste(a);break}b||
this.wc.Eg(!1,a.Sb,19);return b}Lfl(a,b,c){if(a){const f=new cR.a("ShrinkImage",!0);a=this.X9b.gth(a,b,this.Koe);f.stop();if(a)return this.Ila.TTb("LoadAndShrinkImage"),this.Ila.flush(String.format("Browser={0}, Length={1}",this.Eo.zy,a.length)),Nc.a.qk(si.a.Ywj,f.D$.toFixed(0)),Nc.a.qk(si.a.Xwj,f.VIc.toFixed(0)),Nc.a.qk(si.a.Zwj,a.length.toString()),this.Vze(a,c)}return!1}SUi(a){this.c5j&&a&&(a=a.ownerDocument)&&(a=a.getElementById(Ap.a.Kng))&&a.parentNode&&a.parentNode.removeChild(a)}qrl(a){let b,
c;b=0;c=!1;if(a&&a.$m&&a.$m.firstChild&&a.$m.firstChild.getAttribute){var f=a.$m.firstChild;const l=f.getAttribute(Ap.a.Np),x=this.Aq.Nq;if(x&&0<x.length&&x[0]&&Sys.UI.DomElement.containsCssClass(f,x[0].y4a)){let G=!1;(this.e$b&&Object(Ma.a)(Sv.a,x[0])||this.qme&&Object(Ma.a)(mA.a,x[0]))&&this.hKj(x)&&(this.TFj(l)?G=!0:(a.J3g=!1,Aa.a.J(512356448,826,50,"Cannot use ClipService due to copy failure: ccpCorrId: {0}.",a.Sb)),Aa.a.J(512356447,826,50,"The copied graph nodes has been deleted, try to fall back to clip service; ccpCorrId: {0}, useClipService: {1}.",
a.Sb,G));if(G)Aa.a.J(512356446,826,50,"TryAttachClipboardObjects: Using clip service for ccpCorrId: {0} for in-session COPY/PASTE but actually use clip service to fulfill the request.",a.Sb),this.Aq.Nq=null;else if(Aa.a.J(512356445,826,50,"TryAttachClipboardObjects: Using internal objects for in-session COPY/PASTE for ccpCorrId: {0}.",a.Sb),a.eW=x,!re.a("UseClipServiceForDestinationThemePaste"))return{returnValue:!0,KOd:b,GWd:c}}else Aa.a.J(512356444,826,50,"it is not an internal paste, use ClipService instead; ccpId: {0}, ccpCorrId: {1} .",
l,a.Sb);f=this.ax.zQi(f,a.Sb);b=f.LOa;c=1===f.dataType;if(this.ax.XRj(f)&&void 0!==f&&null!==f&&32===f.uZ)return a.lu=f,Aa.a.J(512356443,826,50,"This is IsValidClipServiceObject and copy action has succeeded, clipServiceObject.DataType {0}, pasteParams keepsource value {1} ",f.dataType,a.kA),{returnValue:!0,KOd:b,GWd:c};Aa.a.J(512356442,826,10,"Failed to use clip service, ClipServiceObject: [{0}].",f?f.toString():"(null)")}Aa.a.J(512356441,826,50,"TryAttachClipboardObjects::Failed to attach ClipboardObjects.");
return{returnValue:!1,KOd:b,GWd:c}}Dsl(a,b){let c=!1;if(this.ika.Azg(a))if(a.length>=this.Koe)this.Bjd(b),c=!0;else{if(a=this.ika.Hrl(a))this.Ila.TTb("ExtractDataUri"),this.Ila.flush(String.format("Browser={0}, Length={1}, IsFromBlob=true",this.Eo.zy,a.length));c=this.Vze(a,b)}return c}hKj(a){for(const b of a)if(b.sxg)return!0;return!1}TFj(a){if(this.gT.x$d)return Aa.a.J(512356439,826,50,"Cannot predict copy result due to incompletion"),!1;Aa.a.J(512356440,826,50,"ccpId: {0}, LastCopyFailureCcpId: {1}.",
a,this.gT.vBg);return!!a&&a!==this.gT.vBg}Bjd(a){this.wc.Eg(!1,a,18);this.Md.FG(60,null)}Wal(){let a=!1;if(this.$ac&&0<this.$ac.length&&this.ILg){const b=this.dda.getElementsByTagName($e.a.R7);if(b){for(let c=0;c<b.length;c++){const f=b[c];if(f.src&&f.src.toLowerCase().startsWith("webkit-fake-url:")){a=!0;break}}Aa.a.J(512356438,826,50,"Get image url in Safari "+(a?"Succeeded":"Failed"))}}return a}}qh.cIh=1048576;qh.RJf=.75;qh.Rii=5E3;qh.ywk="PasteViaTriggeringEvent";qh.objectCount="ObjectCount";
qh.isDataCompressed="IsDataCompressed";qh.fji="PastedObjectDataSize";qh.ZLf="ActionName";qh.aMf="CcpMethod";qh.cii="PasteKeepingSourceFormatting";qh.aii="PasteKeepingDestinationTheme";qh.bii="PasteAsImage";qh.kji='data-clipservice-type="slide"';qh.uii="ContextMenu.PasteKeepingDestinationTheme";qh.mji="ContextMenu.PasteKeepingSourceFormatting";qh.wii="PasteKeepingDestinationTheme";qh.oji="PasteKeepingSourceFormatting";qh.vii="PasteKeepingDestinationThemeMLR";qh.nji="PasteKeepingSourceFormattingMLR";
qh.$Lf=20;qh.eji="PasteAsImageSLR";qh.dji="PasteAsImageMLR";qh.cji="ContextMenu.PasteAsImage";Object(e.a)(qh,"PasteManager",null,[1126,106]);class fO{constructor(a,b){this.JGg=a;this.Ha=b}jjl(a,b,c,f,l){this.JGg.K0(this.Ha.poi,a,b,c,this.Ha.qoi,this.Ha.roi,this.Ha.soi,f,l)}yli(a){this.JGg.xli(a)}}Object(e.a)(fO,"PastedDataUploader",null,[1122]);class OE{static create(a){const b=new OE;b.hzg=Vq.b(a,c=>c.isEditable);return b}}Object(e.a)(OE,"ShapeCopyPasteParams",null,[]);class gO{constructor(a,b,c,
f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic,Kc,Hc,ie){this.ra=a;this.kh=b;this.X3=c;this.Aq=l;this.L9b=f;this.ika=x;this.ax=G;this.gT=R;this.ia=fa;this.Y3j=wa;this.Z3j=Wa;this.FKg=mb;this.KKg=Kb;this.K4j=nc;this.wme=oc;this.xcb=Ic;this.Ea=Kc;this.wc=Hc;this.gw=ie}NP(a){const b=this.ra.og();let c=!1;b&&0<b.length&&this.X3.value.Bba===Yb.a.Bg&&(a.dataType=2,c=a.Psa?this.OQi(b):!this.ra.kSa());return c}OQi(a){let b=!0;for(const c of a){if(c.NVc&&!c.isLocal)return!0;c.fC||(b=!1)}return b}jra(a){u.AFrameworkApplication.Wj("Microsoft.Office.Server.Powerpoint.Web.IPPTEditorPasteShapesWithEmbeddedClipServiceSettings");
const b=this.ra.og();if(!b||!b.length)return this.Aq.Nq=null,!1;var c;let f=({contentType:c}=this.ika.ZMd(b)).returnValue;this.wc.oB(c,a.Sb);a.Psa?({dhb:f,returnValue:c}=this.VJi(b,a.Sb,f),f="Cut:"+f):({dhb:f,returnValue:c}=this.SJi(b,a.Sb,f),f="Copy:"+f);this.gw.S5d(b,"DoCutCopy")&&(Aa.a.J(525960395,826,50,"ShapeCutCopyHandler: DoCutCopy HasDeferredContentOnShape: True"),a.Psa?this.gw.Xpa("ShapeCutCopyHandlerHasDeferredContentIsCut","true"):this.gw.Xpa("ShapeCutCopyHandlerHasDeferredContentIsCopy",
"true"));Aa.a.J(23614726,307,50,f);return c}VJi(a,b,c){let f=!0,l=[];for(const x of a)x.NVc&&l.push(x),x.fC||(f=!1);l=f?a:l;b=({dhb:c}=this.HGh(l,l,!0,!0,c,b,f)).returnValue;this.nTf(l);this.KKg&&this.rTf(a);return{returnValue:32===this.ia.La(ba.a.yWf,2,b),dhb:c}}SJi(a,b,c){if(this.FKg&&this.CGj(this.Qej(),a))return{returnValue:!0,dhb:c};const f=[];for(const l of a)l.NVc&&f.push(l);b=({dhb:c}=this.HGh(a,f,this.FKg,!1,c,b)).returnValue;b.lu&&this.ia.La(ba.a.pTf,2,b);this.nTf(a);this.KKg&&this.rTf(a);
return{returnValue:32===this.ia.processAction(ba.a.oTf,2),dhb:c}}CGj(a,b){if(!this.gT.x$d||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!a[c].id||!a[c].id.equals(b[c].id))return!1;return!0}hcl(a){if(!a.length)return!0;let b=0,c=0;for(let f=0;f<a.length;f++){const l=a[f];if(l.isLocal)return!0;!l.wk||l.get_isSVGBlipFilled()||l.isGif||b++;l.qd&&c++}return this.K4j?c===a.length:b+c===a.length}B7i(a){const b=[];for(const c of a)c&&(a=new mA.a(c),a.sessionId=this.xcb,b.push(a));return b}Qej(){const a=
[];if(this.Aq.Nq&&this.Aq.Nq.length)for(const b of this.Aq.Nq){const c=Object(ua.a)(mA.a,b);if(c&&c.shapeNode)a.push(c.shapeNode);else return[]}return a}HGh(a,b,c,f,l,x,G=!1){let R=new Qx(null,x,null);this.Aq.Nq=this.B7i(a);!c||this.hcl(b)?(c&&(Aa.a.J(23614724,307,50,"Clip service shapes cut/copy is throttled"),this.wc.Wh(mu.a.pQf,"true",x)),this.ax.apd(this.kh,this.Aq.Nq,null,this.xcb,this.Efg(a),null,x)):(this.ika.juh(b),c=this.gT.SQd(2,b.length,f,G),c.kec=OE.create(b),this.wme&&this.gw.S5d(a,f?
"ShapeCutCopyHandler_DoCut":"ShapeCutCopyHandler_DoCopy")&&(c.LOa=1,c.uZ=8),this.wc.Wh(mu.a.Np,c.Np,x),l+=String.format(", CcpId={0}",c.Np),this.ax.apd(this.kh,this.Aq.Nq,c,this.xcb,this.Efg(a),null,x),R=new Qx(c,x,b));return{returnValue:R,dhb:l}}Efg(a){const b=[];for(const c of a)Array.add(b,this.Ea.aub(c));return b}nTf(a){for(const b of a)if(b&&b.wk&&(a=Ni.c(b,this.L9b.Gc.Ma))&&!a.ll){a=a.$Na;if(!a)continue;a=a.getAttribute(Bk.a.GRc);if(!a)continue;const c=$e.a.SB();c.src=a.toString();b.get_shapeRotation()||
this.ika.L4k(c,b.Rx,b.KD);c.className+=this.Aq.Nq[0].y4a;this.kh.contentWindow.document.body.appendChild(c)}}rTf(a){(a=this.Z3j.zYi(a,b=>!!b&&b.qd))&&0<a.length&&(a=this.Y3j.AYi(a))&&this.kh.contentWindow.document.body.appendChild(a)}}Object(e.a)(gO,"ShapeCutCopyHandler",null,[1358]);class Sr{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb){this.kh=b;this.X3=c;this.Aq=f;this.ua=l;this.ia=x;this.ax=G;this.gT=R;this.M4j=fa;this.wme=wa;this.ra=a;this.xcb=Wa;this.wc=mb;this.gw=Kb}NP(a){var b=this.X3.value.Bba;
if(b=!!this.ua.Ba&&!!b&&b===zi.a.oD||b===Yb.a.Bg&&!this.ra.Yd().length||b===Yb.a.rU)a.dataType=1;return b}jra(a){this.wc.oB(19,a.Sb);return this.dFi(a)}get Gb(){return this.ra}dFi(a){var b=this.Gb.nf();if(!b||!b.length)return this.Aq.Nq=null,Z.ULS.sendTraceTag(512497806,826,10,"Tried to copy slides but no slides were selected."),!1;var c=Sr.r$f(b,!0);if(!c.length)return a=this.Wfg(b).join(","),Z.ULS.sendTraceTag(512497805,826,10,"Tried to copy slides but all of them were disconnected: '{0}'.",a),
!1;b.length!==c.length&&(b=Sr.r$f(b,!1),b=this.Wfg(b).join(","),Z.ULS.sendTraceTag(512497804,826,15,"Tried to copy slides but some of them were disconnected: '{0}', ignore them and continue",b));var f=Sr.getSlides(this.Aq),l=Sr.mAi(this.xcb,c);this.Aq.Nq=Sr.Fol(l);b=(b=c[0])?b.Bb:null;const x=this.gw.Qsj(c);this.M4j?this.zNe(f,l)?(Aa.a.J(512497801,307,50,"Clip service slide copy is throttled for ccopCorrId: {0}",a.Sb),this.wc.Wh(mu.a.pQf,"true",a.Sb)):(f=this.gT.SQd(1,c.length,a.Psa),c=new Zz(f,a.Sb,
c),this.wc.Wh(mu.a.Np,f.Np,a.Sb),l=8,x?this.wme&&(f.LOa=1,f.uZ=8):a.Psa||(l=this.ia.La(ba.a.qTf,2,c),f.uZ=l),this.ax.apd(this.kh,this.Aq.Nq,f,this.xcb,null,b,a.Sb),!x&&a.Psa&&(l=this.ia.La(ba.a.zWf,2,c)),Aa.a.J(512497802,307,32!==l?10:50,"Clip service slide isCut: {0} status: {1} for ccpid: {2}",a.Psa,f.uZ,f.Np),a.Psa?this.gw.Xpa("DeferredSlideCutStatus",f.uZ.toString()):this.gw.Xpa("DeferredSlideCopyStatus",f.uZ.toString())):(this.ax.apd(this.kh,this.Aq.Nq,null,this.xcb,null,b,a.Sb),Aa.a.J(576745568,
307,15,"Clip service has been disabled. CcpCorId: {0}",a.Sb));return!0}Wfg(a){return aj.c(a,b=>b?b.Bb.toString():null)}zNe(a,b){if(!b||!b.length||Sr.pbi(b))return!0;if(this.gT.x$d){if(!a||a.length!==b.length)return!1;for(let c=0;c<b.length;c++)if(!Sr.Gbi(a[c],b[c]))return!1;return!0}return!1}static r$f(a,b){const c=new Ha.a;for(const f of a)f.isConnected===b&&c.add(f);return c.toArray()}static getSlides(a){const b=[];if(!a||!a.Nq||!a.Nq.length)return b;for(let c=0;c<a.Nq.length;c++)b.push(Object(ua.a)(Sv.a,
a.Nq[c]));return b}static Gbi(a,b){return!a&&!b||!!a&&!a.Ed&&!!b&&!b.Ed||!!a&&!!a.Ed&&!!b&&!!b.Ed&&(!a.Ed.id&&!b.Ed.id||!!a.Ed.id&&!!b.Ed.id&&a.Ed.id.equals(b.Ed.id))}static pbi(a){for(let b=0;b<a.length;b++)if(a[b]&&a[b].Ed&&!Oe.a.Sw(a[b].Ed.Bb))return!1;return!0}static Fol(a){const b=[];for(const c of a)b.push(c);return b}static mAi(a,b){const c=[];for(const f of b)c.push(Object.assign(new Sv.a(f),{sessionId:a}));return c}}Object(e.a)(Sr,"SlideCopyHandler",null,[1358]);class hO{constructor(a,b,
c,f){this.Dka=this.vke=!1;this.CSb=null;this.z$a=a;this.qak=b;this.K8b=c;this.wc=f}get gM(){this.CSb||(this.CSb=this.qak.create());return this.CSb}get DWd(){return this.Dka}Qba(a){this.gM.Qba(a)}r4a(a){this.gM.r4a(a)}get d5(){return this.gM.d5}get Px(){return this.gM.Px}prepareForPaste(a,b){this.Dka=!0;this.gM.prepareForPaste(b,a,this.K8b.XAa.contentWindow.document)}bca(a,b,c){this.Dka=!0;this.gM.bca(a,b,c);this.Dka=!1}reset(){this.Dka=!1}Lql(a,b){if(!this.RJa(a,b))return!1;try{const c=a.contentWindow.document;
let f=c.body;ya.a.ku(f);this.gM.Q5a(c,f);return!0}catch(c){Aa.a.J(512497800,826,10,"TriggerPasteRequest: We failed to generate the system clipboard event, even though we thought we had access!")}return!1}paste(a,b,c){let f;f="";b.Bf(Yb.a.Bg);if(!this.RJa(a,c)&&(null==this.Px||null!=this.Px&&!this.Px))return{returnValue:!1,content:f};b=a.contentWindow.document;let l=b.body;this.Dka=!0;ya.a.ku(l);let x=!1;try{this.z$a.mgb(a),l=this.gM.Q5a(b,l),f=l.innerHTML,x=!0}catch(G){this.z2b(c)}this.Dka=!1;return{returnValue:x,
content:f}}copy(a){a.contentWindow.focus();this.Dka=!0;let b;try{this.gM.WJc(a.contentWindow.document),b=!0}catch(c){b=!1}this.Dka=!1;return b?!0:!1}RJa(a,b){if(this.vke)return!0;this.Dka=!0;let c=!1;try{c=this.gM.RJa(a.contentWindow.document.body,()=>{ya.a.ku(a.contentWindow.document.body)},()=>{this.z$a.mgb(a)})}catch(f){}this.Dka=!1;c?this.vke=!0:r.a.Aj||null==this.Px||this.Px||this.z2b(b);return c}z2b(a){this.vke=!1;vq.instance.Mqb(null,null);this.wc.Eg(!1,a,29)}}Object(e.a)(hO,"SystemClipboard",
null,[1123]);class iO{constructor(a,b,c,f,l,x,G,R){this.Sme=!0;this.XIg=!1;l.pptOfflineModeEnabled&&a.uBc(Object(C.a)(this,this.wDb,"onNetworkHealthStateChanged"));this.Ws=b;this.ia=c;this.I_=f;this.la=l;this.gO=x;this.nL=G;this.ua=R;this.iG=0;this.Vab=!1;this.NYc=0;this.GMg=new Date}get status(){return this.iG}wDb(a,b){this.Sme=b.CUc;this.XIg||this.enh(this.Sme,"NetworkHealthStateChanged")}d7f(a){this.XIg=!a;this.Sme&&this.enh(a,"PodSeamlessFailoverManager")}enh(a,b){a&&this.Vab&&(this.I_.Zlc=!1,
this.iG=1,this.gO.JF());const c=!a,f=this.NYc+1;El.a.instance.Cb(new xe.a(2,1,c?this.la.switchToOfflineDelayInMs:this.la.switchToOnlineDelayInMs,()=>{this.Ogb(c,f)},90,"107"));this.NYc++;Z.ULS.sendTraceTag(41272025,813,50,Fi.c({["Current state"]:this.Vab.toString(),["Received signal"]:a.toString(),["Change id"]:f.toString(),["State change source"]:b}))}Ogb(a,b){this.NYc===b&&this.Vab!==a&&(this.I_.Zlc=a,a&&3!==this.ia.mode||((this.Vab=a)?(this.iG=2,this.gO.JF(),this.nL.kW(this.ua.presentation)&&this.I_.show(0,
-1)):(this.iG=0,this.I_.dismiss(),this.gO.JF()),this.Ws.Ogb(a),Z.ULS.sendTraceTag(41272026,813,50,"PPTO switches to {0}. The change id is {1} and the last state switching time is {2}",a?"Offline":"Online",this.NYc,Nc.a.$e(this.GMg)),this.GMg=new Date))}}Object(e.a)(iO,"PPTOfflineManager",null,[1142]);class jO{pmc(a,b,c){rE.a(a,b,c)}}Object(e.a)(jO,"WarningDialogProxy",null,[1120]);var dR=d(276);class Yx extends Lh.a{constructor(a,b,c,f,l,x,G,R,fa){super();this.j_c=!1;this.j8b=null;this.kbb=0;this.U1c=
this.O$b=this.R1c=this.O1c=this.g4c=this.Y1c=this.LZc=this.Z5c=this.VUa=this.loe=this.Coe=this.V_=this.W3=null;this.Ala=a;this.hac=b;this.OI=c;this.X6j=f;this.X_j=l;this.T2j=fa;this.Fa=x;this.kRg=R;this.uc=G}dispose(){this.loe=this.Coe=this.V_=this.W3=null;super.dispose()}fsh(a){this.vCh();this.tj(a,Object(C.a)(this,this.VMi,"endDialogHandler"),{["MasterId"]:0,["LayoutId"]:0})}flh(a){if(a)for(let b=0;b<this.VUa.length;b++){const c=document.getElementById(this.VUa[b]);if(parseInt(c.getAttribute("LayoutId"))===
a){this.EGb(c);break}}}px(){super.px();$e.a.Ce().appendChild(this.oAi());const a=document.getElementById(this.ji("WACDialogPanel"));a&&a.removeAttribute(Jc.a.kqa)}QF(){super.QF();var a=document.getElementById(this.ji("WACDialogPanel"));a.style.width=$e.a.Nc(532);a=parseInt(dh.a.It(a).top);this.W3.style.height=$e.a.Nc(Math.min(Math.max(0,Vg.a.tma-a-100),398));this.mg=this.W3.parentNode.innerHTML}X6(){super.X6();this.Coe=document.getElementById("MasterId");this.loe=document.getElementById("LayoutId");
this.O$b=Object(C.a)(this,this.R9a,"keyPressHandler");u.AFrameworkApplication.Aa.TF.ked(ma.a.Xf,window.document,this.O$b,null);this.O1c=Object(C.a)(this,this.vUj,"layoutClickHandler");this.R1c=Object(C.a)(this,this.wUj,"layoutDoubleClickHandler");this.U1c=Object(C.a)(this,this.yUj,"layoutOnFocus");for(let a=0;a<this.VUa.length;a++){const b=document.getElementById(this.VUa[a]);this.en.ob(ma.a.click,b,this.O1c);this.en.ob(ma.a.doubleClick,b,this.R1c);Ed.a.addHandler(b.firstChild,"focus",this.U1c)}}$qa(){super.$qa();
this.O$b&&u.AFrameworkApplication.Aa.TF.GUe(ma.a.Xf,window.document,this.O$b);this.O$b=null;for(let a=0;a<this.VUa.length;a++){const b=document.getElementById(this.VUa[a]);this.en.xb(ma.a.click,b,this.O1c);this.en.xb(ma.a.doubleClick,b,this.R1c);Ed.a.removeHandler(b.firstChild,"focus",this.U1c)}this.U1c=this.R1c=this.O1c=null}oAi(){if(this.W3)return this.W3;this.W3=$e.a.Ce();this.W3.id="LayoutPickerDiv";this.W3.className="LayoutPicker";this.kbb=0;this.VUa=[];var a=this.hac.length;if(!a||1===a&&!this.hac[0].InContent)return Aa.a.J(546137666,
822,10,"Legacy LayoutDialog:: Master not loaded."),this.W3;var b=0;let c=!1;for(var f=0;f<a;f++)this.hac[f].Id===this.X6j&&(b=f,c=!0);c&&this.XCf(this.hac[b],1!==a);for(f=0;f<a;f++)c&&f===b||this.XCf(this.hac[f],1!==a);a=$e.a.xUf();a.id="MasterId";a.type="hidden";b=$e.a.xUf();b.id="LayoutId";b.type="hidden";this.W3.appendChild(a);this.W3.appendChild(b);return this.W3}XCf(a,b){a.InContent&&this.OI.Jb(a.Id)&&(b&&this.W3.appendChild(this.HAi(a)),this.W3.appendChild(this.Cyi(a)))}HAi(a){const b=$e.a.Ce();
b.className="MasterSlideTitleBar";b.innerText=a.Name;return b}Cyi(a){const b=a.Id;a=a.ContentMasters;if(!this.OI.Jb(b))return null;const c=this.OI.ga(b),f=$e.a.Ce();f.className="LayoutTableContainer";var l=$e.a.DVf();const x=$e.a.yDi();let G=null;f.appendChild(l);l.appendChild(x);l=this.Ala.width;let R=this.Ala.height,fa;l||(l=1);R||(R=1);fa=R/l*145;let wa=0;const Wa=a.length;for(var mb=0;mb<Wa;mb++)!this.kRg&&this.uc.Q8a(a[mb])||wa++;mb=1;for(let Kc=0;Kc<Wa;Kc++){var Kb=a[Kc];if(!this.kRg&&this.uc.Q8a(Kb))continue;
1===mb%3&&(G=$e.a.NRd(),x.appendChild(G));var nc=Kb.Id.toString();const Hc=Kb.Name,ie=$e.a.XGc();ie.id="Layout"+this.kbb;ie.setAttribute("LayoutIndex",this.kbb);ie.setAttribute("MasterId",b);ie.setAttribute("LayoutId",nc);ie.setAttribute(Jc.a.Ye,Jc.a.KM);Array.add(this.VUa,ie.id);var oc=null;if(nc=!!c.LayoutIcons&&c.LayoutIcons.length>Kc&&!!c.LayoutIcons[Kc].Icon){oc=-1;for(var Ic=0;Ic<c.LayoutIcons.length;Ic++)if(c.LayoutIcons[Ic].LayoutId===Kb.Id){oc=Ic;break}-1===oc&&(oc=Kc);oc=c.LayoutIcons[oc].Icon;
Ic=new dR.a(oc.Clip.Bounds.Left,oc.Clip.Bounds.Top,145,fa);Kb=$e.a.SB();Kb.src=fb.a.instance.resolve("PPTe.IResourceViewElementResolver").resolve(Jg.a.Drb,oc.ImgId);Kb.title=Hc;Kb.style.clip=this.HLk(Ic);Kb.style.left=$e.a.Nc(-Ic.q_a);Kb.style.overflow=te.a.As;Kb.style.position=te.a.Dna;Kb.style.top=$e.a.Nc(-Ic.r_a);Kb.style.zIndex="0";l<R&&(Kb.style.height=$e.a.Nc(fa));Kb.setAttribute(Jc.a.Ye,Jc.a.UNa);oc=document.createElement("span");oc.style.width=$e.a.Nc(145);oc.style.height=$e.a.Nc(fa);oc.setAttribute("Unselectable",
"on");oc.style.zIndex="0";oc.style.overflow=te.a.As;oc.style.display=te.a.bkl;oc.style.position=te.a.Umc;oc.appendChild(Kb);oc.setAttribute(Jc.a.pK,Jc.a.KB)}Kb=$e.a.Ce();Kb.id="title_Layout"+this.kbb;Kb.className="LayoutTitle LayoutTitleHighContrast";Kb.innerText=Hc;Ic=$e.a.vba();Ic.setAttribute("tabindex","0");Ic.setAttribute("onclick","return false;");Ic.setAttribute("unselectable","on");Ic.setAttribute(Jc.a.Wr,Hc);Ic.setAttribute(Jc.a.Ye,Jc.a.UNa);Ic.setAttribute(Jc.a.TKd,mb);Ic.setAttribute(Jc.a.UKd,
wa);nc&&Ic.appendChild(oc);Ic.appendChild(Kb);G.appendChild(ie);ie.appendChild(Ic);this.kbb++;mb++}Wa%3&&(this.kbb+=3-Wa%3);return f}HLk(a){let b;b="rect( "+($e.a.Nc(a.r_a)+", ");b+=$e.a.Nc(a.AIh)+", ";b+=$e.a.Nc(a.BIh)+", ";return b+=$e.a.Nc(a.q_a)+")"}VMi(a,b){this.j_c&&(Nc.a.hqb(this.j8b),this.j_c=!1,this.j8b=null);1===a&&this.X_j(b.MasterId,b.LayoutId)}yUj(a){a=a.target.parentNode;this.V_&&a.id===this.V_.id||this.EGb(a)}R9a(a){a=a.mc;var b=this.k$i(a);if(b===w.a.rLb)return!0;if(b===w.a.lq)return(a=
this.Fa.il())&&"WACDialogCancelButton"!==a.uj.vZ.id?(this.Roa(1),this.hide(),!0):!1;a.preventDefault();if(!this.V_)return a=document.getElementById("Layout0"),this.EGb(a),!0;a=parseInt(this.V_.getAttribute("LayoutIndex"));b=this.k8i(b);for(let c=0;c<b.length;c++){const f=document.getElementById("Layout"+(a+b[c]));if(f){this.EGb(f);break}}return!0}k$i(a){let b=w.a.rLb;switch(a.keyCode){case w.a.$0:b=w.a.$0;break;case w.a.Y0:b=w.a.Y0;break;case w.a.mR:b=w.a.mR;break;case w.a.MO:b=w.a.MO;break;case w.a.lq:b=
w.a.lq}this.T2j&&(b===w.a.MO?b=w.a.mR:b===w.a.mR&&(b=w.a.MO));return b}k8i(a){let b=[0];switch(a){case w.a.$0:if(!this.Z5c)for(this.Z5c=Array(3),a=0;3>a;a++)this.Z5c[a]=-3-a;b=this.Z5c;break;case w.a.mR:if(!this.Y1c)for(this.Y1c=Array(3),a=0;3>a;a++)this.Y1c[a]=-1-a;b=this.Y1c;break;case w.a.MO:if(!this.g4c)for(this.g4c=Array(3),a=0;3>a;a++)this.g4c[a]=a+1;b=this.g4c;break;case w.a.Y0:if(!this.LZc)for(this.LZc=Array(3),a=0;3>a;a++)this.LZc[a]=3-a;b=this.LZc}return b}vUj(a){this.EGb(a.LB);return!0}wUj(a){a=
a.LB;a!==this.V_&&this.EGb(a);this.Roa(1);this.hide();return!0}EGb(a){this.vCh();this.V_=a;const b=this.Fa.il();b?b.uj.wE(a.firstChild):Aa.a.J(8959683,807,10,"LayoutDialog::SelectElement cannot find current FocusRegion");Sys.UI.DomElement.addCssClass(this.V_,"Selected");this.Vvl();this.j_c=!0;this.j8b||(this.j8b=Nc.a.z$(Object(C.a)(this,this.d0k,"selectElement_Finish"),0))}d0k(){this.V_&&this.B_k(this.V_);this.j_c=!1;this.j8b=null}vCh(){this.V_&&(Sys.UI.DomElement.removeCssClass(this.V_,"Selected"),
this.V_=null)}B_k(a){const b=document.getElementById("LayoutPickerDiv");if(b){var c=b.scrollTop,f=b.offsetHeight,l=$e.a.iYg(b,a)._y,x=a.offsetHeight;l<c?3>a.getAttribute("LayoutIndex")?b.scrollTop=0:b.scrollTop=l:(a=f+c,l=x+l,l>a&&(b.scrollTop=c+(l-a)))}}Vvl(){this.Coe.value=this.V_.getAttribute("MasterId");this.loe.value=this.V_.getAttribute("LayoutId")}}Object(e.a)(Yx,"LayoutPicker",Lh.a,[]);class kO extends Yx{constructor(a,b,c,f,l,x,G,R,fa){super(a,b,c,f,l,x,G,R,fa)}dispose(){super.dispose()}Djd(a){this.fsh(ResourceStrings.l_NewSlideTitle);
this.flh(a)}px(){this.Ue(1,ResourceStrings.l_AddSlide);super.px()}}Object(e.a)(kO,"AddSlideDialog",Yx,[1367]);class lO extends Yx{constructor(a,b,c,f,l,x,G,R,fa){super(a,b,c,f,l,x,G,R,fa)}dispose(){super.dispose()}Djd(a){this.fsh(ResourceStrings.L_SlideLayoutDialog);this.flh(a)}px(){this.Ue(1,ResourceStrings.L_ChangeLayout);super.px()}}Object(e.a)(lO,"ChangeLayoutDialog",Yx,[1367]);class mO{constructor(a,b){this.Fa=a;this.uc=b}UQd(a,b,c,f,l,x,G,R){switch(a){case 1:return new kO(b,c,f,l,x,this.Fa,
this.uc,G,R);case 0:return new lO(b,c,f,l,x,this.Fa,this.uc,G,R);default:return null}}}Object(e.a)(mO,"DialogFactory",null,[1357]);class nO{constructor(a,b,c,f,l){this.Dla=null;this.ia=a;this.CL=b;this.eq=c;this.NN=f;this.Fp=l;this.CL.R6(Object(C.a)(this,this.cfc,"onShapeDisconneted"));this.eq.VId(Object(C.a)(this,this.PWa,"onSlideBackgroundClicked"));this.eq.N7h(Object(C.a)(this,this.q2g,"onShapeViewElementBackgroundClicked"))}J6g(a){if(!a)throw Error.argumentNull("template");this.Dla=a;Aa.a.J(18368227,
822,50,"FormatPainter::PickupFormat Template shape {0}",a.get_shapeId());this.NN.ZZ=!0}uai(a){if(!a)throw Error.argumentNull("target");let b=!1;!this.Dla||a.id.equals(this.Dla.id)?b=!0:a.get_isSVGBlipFilled()&&(this.Dla.Ny||!this.Dla.bta&&!this.Dla.get_isSVGBlipFilled())&&(b=!0);b?this.oOa():(Aa.a.J(18368260,822,50,"FormatPainter::ApplyFormat Template shape {0} Target shape {1}",this.Dla.get_shapeId(),a.get_shapeId()),this.ia.La(ba.a.PYd,2,new kA(this.Dla,a)))}oOa(){this.isActive&&(Aa.a.J(18368262,
822,50,"FormatPainter::CancelFormat"),this.Dla=null,this.NN.ZZ=!1)}dispose(){this.CL.vIa(Object(C.a)(this,this.cfc,"onShapeDisconneted"));this.eq.uGe(Object(C.a)(this,this.PWa,"onSlideBackgroundClicked"));this.eq.KSk(Object(C.a)(this,this.q2g,"onShapeViewElementBackgroundClicked"))}cfc(a,b){b.node===this.Dla&&this.oOa()}PWa(){const a=this.isActive;this.oOa();this.Fp&&a&&this.ia.processAction(E.a.Dia,2)}q2g(a,b){this.isActive&&this.uai(b.xw.shapeNode)}get isActive(){return this.NN.ZZ}get cnl(){return this.Dla}}
Object(e.a)(nO,"FormatPainter",null,[1139,106]);var eR=d(1116),nA;(function(a){a[a.unsaved=0]="unsaved";a[a.rightClickThumbnailPanel=1]="rightClickThumbnailPanel";a[a.rightClickCanvas=2]="rightClickCanvas";a[a.clickObjectOnCanvas=3]="clickObjectOnCanvas";a[a.tokenRefresh=4]="tokenRefresh";a[a.clipServiceCopy=5]="clipServiceCopy"})(nA||(nA={}));Object(e.b)("OfflineModalCalloutTrigger",nA);class oO{constructor(a){this.lo=null;this.Zlc=!1;this.Ob=a;a=document.createElementNS(Bk.a.OQe,"polyline");a.setAttribute(Bk.a.Y6g,
"1,1 15,14 30,1");a.setAttribute(Bk.a.vkd,"rgb(234,234,234)");a.setAttribute(Bk.a.dQe,"2");a.setAttribute(Bk.a.sXd,"white");a.setAttribute(Bk.a.cQe,"bevel");this.nge=new zm.a;this.nge.gh(32,16);this.nge.xa.appendChild(a);this.e8b=document.createElement("p");this.e8b.innerText=CommonUIStrings.l_ModalCalloutContentWhenDisconnected;this.e8b.style.width="258px";this.e8b.style.color="black";this.e8b.style.fontSize="14px"}dismiss(){this.lo&&(this.lo.dismiss(),this.lo=null)}show(a,b){Z.ULS.sendTraceTag(512497097,
813,50,"OfflineModalCallout.Show is triggered by {0}",nA[a]);if(this.Zlc){if(this.lo){if(this.lo.VK)return;this.lo.dispose()}let c=null;c=document.querySelector("[data-unique-id='GetOfflineStatus']");re.a("OfflineModalCalloutCrashFix")&&!c?Z.ULS.sendTraceTag(512497096,813,10,"[Offline Modal Callout] Call out not shown as top element is null"):(a=ib.a.ei(c),this.lo=eR.a.mRd(a,c,this.Ob.nkd,2),this.lo.iZ=4,0<b&&(this.lo.qSe=b),this.lo.qr=!0,this.lo.content=this.e8b,this.lo.SOd=()=>{Z.ULS.sendTraceTag(512497095,
813,50,"The user clicks the button to close the callout.");this.lo&&(this.lo.dispose(),this.lo=null)},this.lo.r$c=()=>{if(this.lo&&this.lo.content){this.lo.content.parentNode.style.width="258px";this.lo.hJ.style.borderColor="rgb(234,234,234)";for(var f=this.lo.apb;f.firstChild;)f.removeChild(f.firstChild);f.appendChild(this.nge.xa);this.lo.CLe()}else Z.ULS.sendTraceTag(512497094,813,50,"callout content is empty in OnShowCallback")},this.lo.show(),Z.ULS.sendTraceTag(512497093,813,50,"Display the callout control"))}}}
Object(e.a)(oO,"OfflineModalCallout",null,[1141]);var pO=d(298),oA=d(204);class qO{constructor(a,b,c){this.Wg=this.ON=this.wb=null;this.Db=!0;this.ta=a;this.rab=b;this.ipe=a.esb?a.Yca:null;this.yda=c}dispose(){this.yda&&this.ON&&($removeHandler(this.ON.xa,"error",Object(C.a)(this,this.g0g,"onImageLoadError")),this.ON.dispose(),this.ON=null);this.wb&&this.wb.qq();this.ON=this.Wg=this.wb=null;this.ipe&&(this.rab.revokeObjectURL(this.ipe),this.ipe=null)}ym(a){this.wb=new QD.a;this.wb.jna(Qi.a.pQe);a.appendChild(this.wb.viewport);
this.ON=new pO.a;this.ON.Rj(0);this.wb.appendChild(this.ON);this.ON.vw(this.ta.Yca);$addHandler(this.ON.xa,"error",Object(C.a)(this,this.g0g,"onImageLoadError"));a=this.ta.Uo;const b=th.a.Lyh(a);this.ON.setPosition(a.Yb,a.$b);this.ON.gh(b.width,b.height);this.ON.Ld(!0);this.Wg=new Cn.a;this.Wg.Rj(1);this.Wg.setVisibility(!1);this.Wg.xa.setAttribute("class","ShapeMoveHandle");this.Wg.Ld(!0);this.Wg.ht(a.points);this.Wg.dY("cursor: move");this.wb.appendChild(this.Wg);this.wb.Gl()}g0g(){Aa.a.J(34182307,
826,15,"Locally rendered a broken image, IsPastingPicture={0}",this.ta.t9a)}setPosition(a,b){this.wb.setPosition(a,b)}LC(){}Dj(a){this.wb.Dj(a)}Gq(a){this.wb.pE(a,oA.a.iba)}Gu(a){this.wb.pE(a,oA.a.Apb)}setZIndex(a){this.wb.pB(a)}Ay(){}CD(){return null}jB(){return[]}draw(){}nE(){}Qp(){return this.Db?this.wb.Qp():null}get visible(){return this.Db}set visible(a){this.Db=a;this.wb.Ld(this.Db)}get jq(){return this.Wg}get ie(){return this.wb}kN(a){return a.Ac===this.jq.xa}xx(){}setSelection(){}}Object(e.a)(qO,
"LocalImageView",null,[1366,535,536,106]);class rO{constructor(a,b){this.rab=a;this.k4j=b}create(a){return new qO(a,this.rab,this.k4j)}}Object(e.a)(rO,"Factory",null,[1135]);class sO{constructor(a){this.Db=!0;this.OTa=this.vUa=this.wb=null;this.Qd=a}dispose(){this.wb&&this.wb.qq();this.vUa=this.OTa=this.wb=null;this.Db=!1}ym(a){this.wb=new QD.a;this.wb.jna(Qi.a.pQe);a.appendChild(this.wb.viewport);this.OTa=new Cn.a;this.wb.appendChild(this.OTa);this.OTa.oE(Bk.a.none);a=this.Qd.shapeNode.Uo;this.OTa.Hu(sf.a.F0);
this.OTa.ar(sf.a.rE);this.OTa.pna("2,2");this.OTa.ht(a.points);this.vUa=new pO.a;this.vUa.Rj(0);this.wb.appendChild(this.vUa);this.vUa.vw(sp.a.uK(sf.a.Dma));a=th.a.Lyh(a);const b=sf.a.YEb,c=sf.a.ccd;this.vUa.setPosition(a.width/2-b/2,a.height/2-c/2);this.vUa.gh(b,c);this.vUa.Ld(!0);this.wb.Gl()}setPosition(a,b){this.wb.setPosition(a,b)}LC(){}Dj(){}Gq(a){this.wb.pE(a,oA.a.iba)}Gu(a){this.wb.pE(a,oA.a.Apb)}setZIndex(a){this.wb.pB(a)}Ay(){}CD(){return null}jB(){return[]}draw(){}nE(){}Qp(){return this.Db?
this.wb.Qp():null}get visible(){return this.Db}set visible(a){this.Db=a;this.wb.Ld(this.Db)}get ie(){return this.wb}kN(){return!1}xx(){}setSelection(){}}Object(e.a)(sO,"ShapeProgressIndicatorView",null,[1365,535,536,106]);class tO{create(a){return new sO(a)}}Object(e.a)(tO,"Factory",null,[1136]);var Tr=d(317);class PE{constructor(){this.Hy=null;this.yqa=this.OM=this.zqa=0;this.startTime=this.bcd=this.ru=this.pH=this.JA=this.k_b=null}cec(){return this.OM<this.Hy.RK?Object.assign(new PE,{Hy:this.Hy,
zqa:this.OM,OM:this.OM+Math.min(this.yqa,this.Hy.RK-this.OM),yqa:this.yqa,k_b:this.k_b,JA:this.JA,pH:this.pH,ru:this.ru,bcd:this.bcd}):null}}Object(e.a)(PE,"ChunkUploadingContext",null,[]);var Ur=d(498);class Zv{constructor(a,b,c,f){this.tf=this.aJ=this.hH=null;this.M$b=b;this.i8b=c;this.Tbb=f;this.yb=a}get p8(){return!!this.hH}K0(a,b,c,f,l,x,G,R=null,fa=null){this.p8?G(new Ur.a(Object.assign(new Tr.a,{Code:59}))):(fa&&fa.register(Object(C.a)(this,this.abort,"abort")),0<l&&(this.aJ=Object.assign(new xe.a(2,
1,l,Object(C.a)(this,this.NL,"onTimeout"),90,"85"),{customData:G}),this.yb.Cb(this.aJ)),(this.hH=Object.assign(new PE,{Hy:a,k_b:c,zqa:0,OM:0,yqa:b,JA:f,pH:x,ru:G,bcd:R,startTime:new Date}).cec())?this.PKb(this.hH):G(new Ur.a(Object.assign(new Tr.a,{Code:92}))))}PKb(a){this.M$b();if(this.i8b()||!this.p8)this.reset();else{this.owa();var b=a.Hy,c=a.JA,f=a.zqa,l=a.OM,x=a.yqa,G=!f&&l===b.RK,R=new FormData;R.append("Type","2");R.append("FileName",a.Hy.fileName);c&&R.append("ImageToken",c);R.append("Content-Range",
"bytes "+f+"-"+(l-1)+"/"+b.RK);Aa.a.J(34420808,818,50,"ChunkedPictureUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, chunkSize:{2}, fileSize:{3}",f,l,x,b.RK);this.tf.onreadystatechange=()=>{this.tf&&4===this.tf.readyState&&this.Swe(a,this.tf.status)};b=G?a.k_b:a.k_b.slice(f,l);R.append("chunk",b);this.tf.send(R)}}Swe(a,b){let c=Object.assign(new Tr.a,{Code:94});if(200===b){this.Tbb.Roc(this.tf.getResponseHeader(Zv.tNd));b=a.bcd;let f=null;try{f=Sys.Serialization.JavaScriptSerializer.deserialize(this.tf.responseText)}catch(l){Aa.a.J(34420810,
818,10,"ChunkedPictureUploader::UploadChunk - failed to deserialize response {0}",l)}if(f&&!f.Error&&f.Result){const l=f.Result;a.JA=l.ItemId;const x=a.cec();a.zqa===l.XOffset&&l.ItemId?x?(b&&b.jpk(100*a.OM/a.Hy.RK,!1),c=null,this.PKb(x)):(b&&b.jpk(100,!0),c=null,Aa.a.J(34420812,818,50,"ChunkedPictureUploader::UploadChunk - upload completed, duration:{0}",+new Date-+a.startTime),this.reset(),a.pH(new Lj.a(f.Result))):c.Code=152}else f&&f.Error&&(c=f.Error)}else Aa.a.J(34869445,818,10,"ChunkedPictureUploader::UploadChunk - upload failed, status:{0}, imageToken:{1}",
b,a.JA||"");c&&(this.reset(),a.ru(new Ur.a(c)))}owa(){this.tf=new XMLHttpRequest;this.tf.open("POST",this.Tbb.F7a(),!0);u.AFrameworkApplication.accessToken&&(this.tf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.tf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.M6.toString()));u.AFrameworkApplication.canary&&this.tf.setRequestHeader(Zv.mli,u.AFrameworkApplication.canary)}NL(a){Aa.a.J(34420816,818,15,"ChunkedPictureUploader::OnTimeout - upload timeout");this.aJ=
null;this.abort();(a=a.customData)&&a(new Ur.a(Object.assign(new Tr.a,{Code:299})))}abort(){if(this.p8){Aa.a.J(34420818,818,15,"ChunkedPictureUploader::Aborting upload");const a=this.tf;this.reset();a&&a.abort()}}reset(){this.aJ&&(this.yb.Ng(this.aJ),this.aJ=null);this.hH=this.tf=null}}Zv.mli="X-Key";Zv.tNd="X-NewKey";Object(e.a)(Zv,"ChunkedPictureUploader",null,[1119]);class uO{constructor(a,b,c,f){this.yb=a;this.c3j=b;this.X9b=c;this.Joe=f.pptEditingImageMaxSizeInBytes;this.rNg=Math.floor(.75*this.Joe);
this.b7j=52428800;this.OLg=f.Ptg&&f.b$d;this.BKg=f.b$d;this.d5j=f.tIj;this.yLg=f.jyg}get ndc(){return this.OLg?this.b7j:this.rNg}get Vlc(){return this.BKg}get bjd(){return this.d5j}hXb(a,b){if(b)if(a&&1===a.length){const c=a[0];c.size<this.rNg?this.convertToBase64AndCallback(a,b):this.OLg?this.shrinkToBase64AndCallback(c,b):b(null)}else b(null)}convertToBase64AndCallback(a,b){const c=this.c3j.create();this.BKg?c.Zrl(a,f=>{let l=f&&0<f.length?f[0]:null;l&&l.length>=this.Joe&&(l=null);this.yLg?b(l):
this.yb.Cb(new xe.a(2,1,0,()=>{b(l)},90,"83"))}):c.sAh(a,b)}shrinkToBase64AndCallback(a,b){this.X9b.ECg(a,c=>{const f=this.X9b.gth(c,a.size,this.Joe);this.yLg?b(f):this.yb.Cb(new xe.a(2,1,0,()=>{b(f)},90,"84"))})}}Object(e.a)(uO,"PPTProcessImageStrategy",null,[1017]);var fR=d(1094);class pA{static get mg(){return Lh.a.UB(pA.fo,ResourceStrings.l_ImageUploadMessage,ResourceStrings.l_NoImageSpecifiedErrorMessage)}}pA.fo="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block2'> <input type='file' id='fileInput' name='fileInput' class='WACDialogInputFile'/> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(e.a)(pA,"InsertImageDialogHtml",null,[]);class vO extends Lh.a{constructor(a){super();this.zl=null;this.Pv=[];this.Yz=a;this.Cyf=!1;this.a$b=u.AFrameworkApplication.fa.ka("InsertLocalPictureMultiSelectionEnabled")}iel(a){this.mg=pA.mg;this.Ue(1,ResourceStrings.L_Insert);this.showDialog(ResourceStrings.L_InsertPicture,Object(C.a)(this,this.HBj,"insertImageDialogHandler"));if(this.zl=document.getElementById("fileInput"))this.zl.setAttribute("accept","image/*"),this.a$b&&a&&this.zl.setAttribute("multiple",
"multiple");a=[];this.zl&&(Ed.a.addHandler(this.zl,ma.a.Xf,Object(C.a)(this,this.onKeyDown,"onKeyDown")),a.push(this.zl));var b=this.pMc(1);b&&a.push(b);(b=this.pMc(0))&&a.push(b);this.Pv=a;this.nxl()}validate(){const a=this.Yz.Aod(this.zl.value);if(0!==a){const b=document.getElementById("errorText");b.innerText=this.Yz.e5i(a);b.style.display="inline-block";return!1}return!0}dispose(){this.zl&&Ed.a.removeHandler(this.zl,ma.a.Xf,Object(C.a)(this,this.onKeyDown,"onKeyDown"));super.dispose()}HBj(a){1===
a&&this.Yz.Xok(this.zl);this.zl=null}nxl(){if(0<this.Pv.length){const a=new fR.a(this.Pv),b=v.FocusManager.instance().il();b&&(this.Pv[0].focus(),b.uj=a,b.DW=!0)}}onKeyDown(a){4!==v.FocusManager.instance().y9g(a)&&a.preventDefault()}}Object(e.a)(vO,"InsertImageDialog",Lh.a,[]);class QE{constructor(){this.CRc=this.file=this.fileName=null;this.$3f=!1;this.fDb=null;this.RK=this.imageHeight=this.imageWidth=0;this.BWd=!1}}Object(e.a)(QE,"ImageType",null,[]);class wO{constructor(a,b,c,f,l,x,G,R,fa,wa){this.QKb=
0;this.EZc=this.gbc=this.VMg=this.khb=!1;this.lL=[];this.zUa="image/*";this.ia=a;this.Hbb=b?b.xa:null;this.XGa=null;this.Md=c;this.$pe=f;this.gte=l;this.d3c=R.pptEditingUploadedImageMaxSizeInBytes;this.rab=x;this.j1j=G;this.Ppe=R.pptEditingUploadLargeImageMaxSizeInBytes;this.s8j=R.pptEditingUploadLargeImageChunkSizeInBytes;this.t8j=1E3*R.pptEditingUploadLargeImageTimeoutInSeconds;if(this.cdb=R.Bxk)this.zUa=this.cdb.join(",");this.a$b=R.NBj;this.Tbb=fa;this.Fe=wa;this.YGg=R.EIi}get tXc(){return this.VMg}set tXc(a){this.VMg=
a;this.gbc=0<this.Ppe&&this.rab.SLj&&a}get Axk(){return this.gbc}Xok(a){this.RCf(a);this.Hbb&&this.gte.TRd(this.Hbb,a,Object(C.a)(this,this.Xye,"onUploadFrameInitialized"),Object(C.a)(this,this.k2d,"getPictureUploadEndPoint"),this.zUa,!1,!1)}DNf(){return!(void 0===window.self.FormData||null===window.self.FormData)}S9g(a){if(this.Hbb){if(this.YGg){if(this.DNf()){this.gte.TRd(this.Hbb,null,Object(C.a)(this,this.Xye,"onUploadFrameInitialized"),Object(C.a)(this,this.k2d,"getPictureUploadEndPoint"),this.zUa,
a&&this.a$b,!0);this.EZc=!1;return}Aa.a.J(558445203,822,10,"Browser does not support directly opening file dialog. Falling back to the old method")}r.a.Aj||r.a.Fwb||r.a.Kvb&&72>r.a.EEc?(this.gte.TRd(this.Hbb,null,Object(C.a)(this,this.Xye,"onUploadFrameInitialized"),Object(C.a)(this,this.k2d,"getPictureUploadEndPoint"),this.zUa,!1,!1),this.EZc=!1):((new vO(this)).iel(a),this.EZc=!0)}else Aa.a.J(18643099,822,15,"PictureUploader initialize failed.")}YKi(a){this.jod&&(Array.addRange(this.lL,a),this.QEh())}get jod(){return 1>
this.lL.length}QEh(){if(!this.jod){const a=new QE,b=this.lL[0];b?(a.fileName=this.yWd(b.name),a.BWd=!0,this.hch(a)):(Aa.a.J(40993185,822,15,"PictureUploader.UploadNextImage File is null. Count of files: {0}.",this.lL.length.toString()),Array.clear(this.lL))}}k2d(){return this.Tbb.F7a()}Xye(a){this.XGa=a;if(!this.EZc){if(this.YGg&&this.DNf()){a.iUd(Object(C.a)(this,this.lok,"onMultipleFileChosen"));return}if(r.a.tF){a.iUd(Object(C.a)(this,this.Qqk,"onSingleFileChosen"));return}a=a.iUd(null);if(!a)return;
this.lL.push(a.files[0])}this.rJd()}RCf(a){if(a)if(this.a$b)for(const b of a.files)this.lL.push(b);else this.lL.push(a.files[0])}lok(a){this.RCf(a);this.rJd()}iKi(a){a=this.Aod(a.fileName);return 0!==a?(this.XGa&&this.XGa.IHc(),2!==a&&3!==a||this.it(90,a),!1):!0}p_b(a){let b=!0;this.tXc&&a.CRc&&!this.LAl(a)&&(this.XGa&&(this.XGa.z6b=!1),b=!1);!a.fDb||!this.khb&&b||(this.rab.revokeObjectURL(a.fDb),a.fDb=null);if(b){switch(this.QKb){case 0:this.ia.La(ba.a.MKc,2,a);break;case 1:this.ia.La(ba.a.zLc,2,
a)}this.QEh()}else Array.clear(this.lL)}yWd(a){if(a){let b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);return a.substr(b+1)}return null}LAl(a){if(a.RK>this.d3c){if(this.gbc&&a.RK<this.Ppe)return Aa.a.J(34420823,822,50,"Upload large image: {0}",a.RK),a.BWd=!0;Aa.a.J(20828424,822,50,"Image size is: {0} MB, bigger than {1} MB ",a.RK/1024/1024,this.d3c/1024/1024);this.it(87,4);return!1}return!0}AQi(a){if(!a)return null;const b=a.lastIndexOf(".");return-1===b?null:a.substr(b+
1)}kkd(a,b,c,f=null){if(a.BWd||this.a$b&&1<this.lL.length){const l=this.XGa,x=this.lL[0];Array.remove(this.lL,x);const G=Nc.a.Eb;G&&G.Wa("FChuckedPictureUpload","True");this.j1j().K0(a,this.s8j,x,f,this.t8j,R=>{l&&(l.z6b=!1,l.dispose());b(R)},R=>{l&&(l.z6b=!1,l.dispose());Array.clear(this.lL);c(R)})}else this.XGa&&(a=this.rbj(f),this.XGa.hkl(b,c,a)),Array.clear(this.lL)}rbj(a){const b=new Lc.a;b.$("PresentationId",this.Fe.presentationId.string);b.$(Jg.a.vma,this.Fe.sessionInfo);b.$("Canary",u.AFrameworkApplication.canary);
b.$("access_token",u.AFrameworkApplication.accessToken);b.$("Type",this.QKb.toString());a&&b.$("ImageToken",a);return b}Qqk(a){a&&(Array.add(this.lL,a.files[0]),this.rJd())}rJd(){if(this.jod||!this.lL[0])Array.clear(this.lL);else{var a=new QE;a.fileName=this.yWd(this.lL[0].name);this.XGa.z6b=!0;this.hch(a)}}hch(a){this.iKi(a)?this.tXc?this.VJk(a):this.p_b(a):Array.clear(this.lL)}Aod(a,b=!1){if(a&&a.length){if(1===this.QKb&&this.AQj(a))return Aa.a.J(39154959,822,50,"Try to set background picture using svg file but not supported."),
3;if(this.Qlg(a))return 0;this.AQi(a)?Aa.a.J(20471823,822,50,"Insert local picture with invalid extension forCopyPaste: {0}",b):Aa.a.J(20471825,822,50,"Insert local picture with empty extension, forCopyPaste: {0}",b);return 1===this.QKb?3:2}return 1}AQj(a){return!!a&&0<a.length&&Ka.a.wg(a).endsWith(".svg")}e5i(a){switch(a){case 1:return ResourceStrings.l_NoImageSpecifiedErrorMessage;case 2:return this.Hzg()?ResourceStrings.l_InvalidImageErrorWithSvgSupportedMessage:ResourceStrings.l_InvalidImageErrorMessage;
case 3:return ResourceStrings.l_InvalidImageErrorMessage;default:return""}}Hzg(){return this.Qlg(".svg")}Qlg(a){a=Ka.a.wg(a);for(let b=0;b<this.cdb.length;++b)if(this.cdb[b]&&0<this.cdb[b].length&&a.endsWith(this.cdb[b].trim().toLowerCase()))return!0;return!1}it(a,b){if(87===a){const c=this.gbc?this.Ppe:this.d3c;this.Md.FG(a,f=>{f.NB=1;f.XPa=[(c/1024/1024).toString()];return!1})}else{const c=this.d5i(b);this.Md.FG(a,f=>{f.NB=1;f.message=c;return!1})}}d5i(a){return 2===a&&this.Hzg()?String.format(ResourceStrings.imageFileNotListedInPptPictureUploadSupportedExtensions,
this.cdb.join(", ")):ResourceStrings.invalidImageFileError}VJk(a){let b=this.lL[0];if(b){a.RK=b.size;a.file=b;if(b.size>this.d3c&&this.gbc)try{b=b.slice(0,6),a.$3f=!0}catch(c){Aa.a.J(34420828,822,50,"File.slice throw exception"),this.khb=!0,this.p_b(a)}this.$pe.UJk(b,c=>{this.I_i(c,a)})}}I_i(a,b){try{let c=a.target.result;b.CRc=c;b.$3f&&(c=this.rab.createObjectURL(b.file),b.fDb=c);let f=new Image;f.onload=()=>{b.imageWidth=f.width;b.imageHeight=f.height;this.hEj(b.CRc)&&(this.khb=!0,Aa.a.J(22880261,
822,50,"Fallback for gif"));f.onload=f.onerror=null;f.src="";f=null;this.p_b(b)};f.onerror=()=>{Aa.a.J(20828428,822,50,"Read image failed");this.khb=!0;this.p_b(b)};f.src=c}catch(c){Aa.a.J(20828430,822,50,"GetBase64Image throw exception"),this.khb=!0,this.p_b(b)}}hEj(a){return 0<a.indexOf("base64,R0lGODlh")||0<a.indexOf("base64,R0lGODdh")}}Object(e.a)(wO,"PictureUploader",null,[1118]);class xO{constructor(a){this.Fe=a}F7a(){let a="pptPictureUpload.ashx";if(Cb.App.webServiceBase)a=Cb.App.webServiceBase+
a;else if(r.a.eg||r.a.mta)a=Ze.a.Ora(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.eRa(),this.Fe.presentationId.string,u.AFrameworkApplication.q0b());this.Fe.podSessionId&&(a+=String.format("&{0}={1}",Jg.a.g$,this.Fe.podSessionId));this.Fe.fk&&(a+=String.format("&waccluster={0}",this.Fe.fk));return a}Roc(a){if(a){var b=a.split(",");if(4===b.length){const c=b[0].trim()+","+b[1].trim();b=b[2].trim()+","+b[3].trim();a=c===b?c:a}u.AFrameworkApplication.canary=a;u.AFrameworkApplication.m7b&&
Aa.a.J(37818512,818,50,"PictureUploaderHelper::UpdateCanary - New canary in response: {0}",a)}}}Object(e.a)(xO,"PictureUploaderHelper",null,[1117]);class qA{constructor(a,b,c,f,l,x,G,R,fa,wa){this.z6b=!1;this.pT=null;this.Lka=!1;this.tf=this.gX=this.eVa=this.y9b=this.Rcc=this.zl=this.hx=this.Tke=null;this.gf=a;this.r4j=f;this.Fe=c;this.I8=l;this.Eme=x;b&&(this.zl=b.cloneNode(!0));this.E3j=G;this.zUa=R;this.A7j=fa;(this.cab=wa)?this.G1f():this.Kxi()}Kxi(){this.pT=document.createElement("iframe");this.pT.style.visibility=
Qi.a.hidden;this.pT.id=qA.yji;this.pT.className="ObjectInDialog";this.gf.appendChild(this.pT);this.Rcc=Object(C.a)(this,this.x3g,"onUploadFrameLoad");Ed.a.addHandler(this.pT,"load",this.Rcc);r.a.tF&&this.x3g(null)}iUd(a){u.AFrameworkApplication.Aa.Jeb();if(!this.zl)return null;this.cab?Ed.a.addHandler(this.zl,"change",()=>{this.HSi(a)}):r.a.tF&&(this.Tke=a,this.y9b=Object(C.a)(this,this.zKc,"fileInputChange"),Ed.a.addHandler(this.zl,"change",this.y9b));try{this.zl.click()}catch(b){const c=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
b.message,b.stack);Aa.a.J(19505501,818,10,c);return null}return this.zl}HSi(a){a&&a(this.zl)}zKc(){this.Tke&&this.Tke(this.zl)}hkl(a,b,c){a||Aa.a.J(590210183,818,10,"UploadFrame::SubmitForm - The responseHandler value is null.");b||Aa.a.J(590210181,818,10,"UploadFrame::SubmitForm - The errorHandler value is null.");this.eVa=a;this.gX=b;if(c.Jb("ImageToken")||c.Jb("AudioToken"))a=this.hx.action,a+=String.format("&{0}={1}",Jg.a.Kuk,1),this.Fe.podSessionId&&(a+=String.format("&{0}={1}","NoAuth","1")),
this.hx.action=a;for(let f of c.keys)this.b2h(f,c.ga(f));this.cab?this.ikl():this.hx.submit()}ikl(){try{Aa.a.J(558445200,818,50,"SubmitFormWithRequest is preparing to send an upload request");const a=new (Type.parse("FormData"))(this.hx);this.k1k(a)}catch(a){Aa.a.J(558445201,818,10,"SubmitFormWithRequest failed to send the request with exception "+a.message),this.hpc("SubmitFormWithRequest failed to send the request with exception "+a.message),this.IHc()}}k1k(a){if(a){const b=this.hx.action;this.tf=
new XMLHttpRequest;this.tf.open("POST",b);this.tf.onreadystatechange=Object(C.a)(this,this.Xrk,"onUploadResponseReceived");this.tf.send(a)}}Xrk(){4===this.tf.readyState&&(this.tf.status===dq.a.py?this.hpc(this.tf.responseText):(Aa.a.J(558445202,818,10,"Upload request failed with status: {0} [isResponseNull: {1}]",this.tf.status,this.tf.responseText?!1:!0),this.hpc("Upload request failed")),this.IHc())}dispose(){this.I8(this);this.cab&&this.gf?this.gf.removeChild(this.hx):this.gf&&this.pT&&(this.gf.contains(this.pT)&&
this.gf.removeChild(this.pT),this.Rcc&&Ed.a.removeHandler(this.pT,"load",this.Rcc),this.Rcc=null);this.y9b&&(Ed.a.removeHandler(this.zl,"change",this.y9b),this.y9b=null);this.pT=this.zl=this.hx=this.gf=null}b2h(a,b){const c=this.iAi();c.type="hidden";c.id=a;c.name=a;c.value=b;this.hx.appendChild(c)}iAi(){return this.cab?document.createElement("input"):this.pT.contentWindow.document.createElement("input")}x3g(a){try{if(!this.pT.contentWindow.document.body)return}catch(b){Aa.a.J(8958480,818,10,"UploadFrame::OnUploadFrameLoaded - Javascript exception thrown while accessing the document body: {0}",
b.toString());this.hpc("0;Javascript exception thrown accessing the document body.");this.dispose();return}this.Lka?this.eVa?(this.hpc(this.Wij(this.pT.contentWindow.document.body)),this.IHc()):Aa.a.J(35984990,818,10,"UploadFrame::OnUploadFrameLoaded - Triggered by {0}",a?"load event":"explicit call"):this.G1f()}G1f(){if(!this.Lka){const a=this.E3j();this.cab?(this.hx=document.createElement("form"),this.gf.appendChild(this.hx)):(this.hx=this.pT.contentWindow.document.createElement("form"),this.pT.contentWindow.document.body.appendChild(this.hx));
this.szi();this.hx.id="formId";this.hx.method="post";this.hx.encoding="multipart/form-data";this.hx.action=a;this.hx.appendChild(this.zl);this.Lka=!0;this.r4j(this)}}szi(){this.zl||(this.cab?(this.zl=document.createElement("input"),this.zl.style.opacity="0",this.A7j&&(this.zl.multiple="multiple")):this.zl=this.pT.contentWindow.document.createElement("input"),this.zl.type="file",this.zl.accept=this.zUa,this.zl.id="fileInputId",this.zl.name="fileInputId")}delayedDispose(){this.dispose()}IHc(){const a=
new xe.a(2,1,0,Object(C.a)(this,this.delayedDispose,"delayedDispose"),90,"82");u.AFrameworkApplication.pe.Cb(a)}hpc(a){let b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a)}catch(c){Aa.a.J(8958484,818,10,"UploadFrame::UploadResponseReceived - Exception when deserializing response. Response: {0}",a)}b&&!b.Error?this.eVa?this.eVa(new Lj.a(b.Result)):Aa.a.J(8958482,818,10,"UploadFrame::SubmitInsertPictureForm - The m_onFinished value is null."):(a=b&&b.Error?b.Error:Object.assign(new Tr.a,
{Code:94}),this.gX?this.gX(new Ur.a(a)):Aa.a.J(8958486,818,10,"UploadFrame::SubmitForm - The m_onError value is null."))}U$k(){return this.Lka&&!this.z6b}Wij(a){let b=null;this.Eme?(this.fQk(a,c=>3!==c.nodeType||!!c.nodeValue&&!c.nodeValue.trim().length),a.firstChild&&3===a.firstChild.nodeType&&(b=a.firstChild.nodeValue)):b=r.a.Aj?a.innerText:a.innerHTML;return b||"No response got from server"}fQk(a,b){for(;a.firstChild&&b(a.firstChild);)a.removeChild(a.firstChild)}}qA.yji="ppt_uploadframe";Object(e.a)(qA,
"UploadFrame",null,[1239,1240,1241]);class yO{constructor(a,b){this.Wyb=[];this.Fe=a;this.Eme=b}TRd(a,b,c,f,l,x,G){if(0<this.Wyb.length)for(let R=this.Wyb.length-1;0<=R;R--)this.Wyb[R].U$k()&&this.Wyb[R].dispose();a=new qA(a,b,this.Fe,c,Object(C.a)(this,this.AJi,"disposeHandler"),this.Eme,f,l,x,G);Array.add(this.Wyb,a)}AJi(a){Array.remove(this.Wyb,a)}}Object(e.a)(yO,"UploadFrameFactory",null,[1116]);class zO extends wq{constructor(a,b,c,f,l){super(a,b);this.lc=c;this.ra=f;this.h$b=l}gt(a){var b="";
if(this.h$b){const c=xm.SchemeColor.parse(a);c&&(c.color&&!c.rsa&&(b=Object(ua.a)(119,this.lc.ig(this.ra.Oa.kb.Ua.node)),(b=c.resolve(b?b.Pe:null))?c.vP=Pk.g(b.ZXa):Aa.a.J(38061255,826,15,"PptInsertionPointFormatting: SetFontColor: Couldn't resolve font color: {0}",Pk.c(a))),b=c.toString());Aa.a.J(41267233,826,50,"PptInsertionPointFormatting: SetFontColor: set SchemeColor to: {0}",Pk.c(b));this.Nk.setValue(sb.a.schemeColor,b);c&&c.rsa&&(a=Pk.i(c.vP))}Ka.a.Va(a)||super.gt(a)}}Object(e.a)(zO,"PptInsertionPointFormatting",
wq,[]);class RE{constructor(){this.yqa=this.OM=this.zqa=0;this.packageKey=this.qz=this.Sna=null;this.nGb=this.iWa=this.X1=0;this.startTime=this.ru=this.pH=null}cec(){return this.OM<this.Sna.length?Object.assign(new RE,{zqa:this.OM,OM:this.OM+Math.min(this.yqa,this.Sna.length-this.OM),yqa:this.yqa,Sna:this.Sna,qz:this.qz,packageKey:this.packageKey,pH:this.pH,ru:this.ru,X1:0,iWa:this.iWa,nGb:this.nGb,startTime:new Date}):null}}Object(e.a)(RE,"ChunkContext",null,[]);class AO{constructor(a,b,c,f,l){this.tf=
this.aJ=this.hH=null;this.M$b=b;this.i8b=c;this.yb=a;this.Fe=f;this.tv=l}get p8(){return!!this.hH}K0(a,b,c,f,l,x,G,R,fa){this.p8?(Aa.a.J(512496902,818,15,"ChunkedDataUploader::StartUpload - already uploading with uploadId: {0}, not starting new upload for uploadId: {1}",this.hH.qz,f),fa&&fa(new Ur.a(Object.assign(new Tr.a,{Code:59})))):(0<l&&(this.aJ=Object.assign(new xe.a(2,1,l,Object(C.a)(this,this.NL,"onTimeout"),90,"85"),{customData:fa}),this.yb.Cb(this.aJ)),(this.hH=Object.assign(new RE,{zqa:0,
OM:0,yqa:a,Sna:b,packageKey:c,qz:f,pH:R,ru:fa,X1:0,iWa:x,nGb:G,startTime:new Date}).cec())?this.PKb(this.hH):(Aa.a.J(512496901,818,10,"ChunkedDataUploader::StartUpload - m_uploadingContext is null for uploadId: {0}",f),fa&&fa(new Ur.a(Object.assign(new Tr.a,{Code:437})))))}xli(a){this.p8&&(Aa.a.J(512496900,818,50,"ChunkedDataUploader::CancelUpload - cancelling upload for uploadId: {0}",this.hH.qz),this.hH.qz===a&&this.abort())}PKb(a){this.M$b();if(this.i8b()||!this.p8)Aa.a.J(512496899,818,15,"ChunkedDataUploader::UploadChunk - session expired or not uploading for uploadId: {0}",
a.qz),this.reset();else{var b=this.owa(a);this.tf.onreadystatechange=()=>{this.tf&&4===this.tf.readyState&&this.Swe(a,this.tf.status)};this.tf.send(b)}}Swe(a,b){let c=Object.assign(new Tr.a,{Code:94});if(200===b){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(this.tf.responseText)}catch(f){Aa.a.J(512496898,818,10,"ChunkedDataUploader::OnChunkUploadComplete - failed to deserialize response {0}, uploadId: {1}",f,a.qz)}if(b&&!b.Error&&b.Result){const f=a.cec();f?(this.tv.qKa(100*a.OM/
a.Sna.length),this.PKb(f)):(Aa.a.J(512496897,818,50,"ChunkedDataUploader::OnChunkUploadComplete - upload completed, duration:{0}, uploadId: {1}",+new Date-+a.startTime,a.qz),this.tv.qKa(100),this.reset(),a.pH&&a.pH(new Lj.a(b.Result)))}b&&(c=b.Error)}else Aa.a.J(512496896,818,10,"ChunkedDataUploader::OnChunkUploadComplete - upload failed, status:{0}, uploadId:{1}",b,a.qz);c&&(a.X1<a.iWa?(Aa.a.J(512496867,818,15,"ChunkedDataUploader::OnChunkUploadComplete - Retrying a chunk to upload again - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",
a.zqa,a.OM,a.qz),window.setTimeout(()=>{a.X1++;this.PKb(a)},a.nGb)):(Aa.a.J(512496866,818,10,"ChunkedDataUploader::OnChunkUploadComplete - Retry count exceeded - upload chunkStart:{0}, chunkEnd:{1}, uploadId:{2}",a.zqa,a.OM,a.qz),this.reset(),a.ru&&a.ru(new Ur.a(c))))}owa(a){this.tf=new XMLHttpRequest;this.tf.open("POST",this.F7a(),!0);u.AFrameworkApplication.accessToken&&(this.tf.setRequestHeader("X-AccessToken",u.AFrameworkApplication.accessToken),this.tf.setRequestHeader("X-AccessTokenTtl",u.AFrameworkApplication.M6.toString()));
const b=a.packageKey,c=a.zqa,f=a.OM,l=!c&&f===a.Sna.length,x=new FormData;x.append("FileName",a.qz);b&&x.append("PackageKey",b);x.append("Content-Range","bytes "+c+"-"+(f-1)+"/"+a.Sna.length);Aa.a.J(512496865,818,50,"ChunkedDataUploader::UploadChunk - upload chunkStart:{0}, chunkEnd:{1}, uploadLength: {2}, uploadId:{3}",c,f,a.Sna.length,a.qz);a=l?a.Sna:a.Sna.slice(c,f);x.append("ChunkData",a);return x}F7a(){let a="PastedDataUpload.ashx";if(Cb.App.webServiceBase)a=Cb.App.webServiceBase+a;else if(r.a.eg||
r.a.mta)a=Ze.a.Ora(a);a+=String.format("?{0}&{1}&{2}",u.AFrameworkApplication.eRa(),this.Fe.presentationId.string,u.AFrameworkApplication.q0b());this.Fe.podSessionId&&(a+=String.format("&{0}={1}",Jg.a.g$,this.Fe.podSessionId));this.Fe.fk&&(a+=String.format("&waccluster={0}",this.Fe.fk));return a}NL(a){Aa.a.J(512496864,818,15,"ChunkedDataUploader::OnTimeout - upload timeout for uploadId: {0}",this.hH.qz);this.aJ=null;this.abort();(a=a.customData)&&a(new Ur.a(Object.assign(new Tr.a,{Code:299})))}abort(){if(this.p8){Aa.a.J(512496863,
818,15,"ChunkedDataUploader::Aborting upload for uploadId: {0}",this.hH.qz);const a=this.tf;this.reset();a&&a.abort()}}reset(){this.aJ&&(this.yb.Ng(this.aJ),this.aJ=null);this.hH=this.tf=null}}Object(e.a)(AO,"ChunkedDataUploader",null,[1121]);class BO{constructor(){this.N2j=new Sa.a(Object(C.a)(this,this.oFj,"isBrowerSupportObjectUrl"))}get SLj(){return this.N2j.value}oFj(){return!!this.URL&&!!this.URL.createObjectURL&&!!this.URL.revokeObjectURL}createObjectURL(a){return URL.createObjectURL(a)}revokeObjectURL(a){URL.revokeObjectURL(a)}get URL(){return window.URL||
window.webkitURL}}Object(e.a)(BO,"PPTFileApiHelper",null,[1137]);class CO{tFj(){return window.FileReader?!0:!1}UJk(a,b){const c=new FileReader;c.onload=b;c.readAsDataURL(a)}readAsArrayBuffer(a,b){const c=new FileReader;c.onload=b;c.readAsArrayBuffer(a)}yWd(a){var b=null;if(a){b=-1;const c=a.lastIndexOf("\\"),f=a.lastIndexOf("/");-1!==f?b=f:-1!==c&&(b=c);b=a.substr(b+1)}return b}}Object(e.a)(CO,"PPTFileReaderHelper",null,[1133]);var gR=d(939),hR=d(612);class DO{constructor(){this.MHg=this.p4c=this.$le=
this.ame=this.Kre=this.qC=this.xka=this.K=null}get name(){return"PowerPointWebEditor.Actor"}Wb(a){this.K=a;const b=a.resolve("PowerPointWebEditor.IApplicationContext");a.resolve("PowerPointWebEditor.IApplicationSettings").sJj?a.register(1106,"Box4.Actors.IFormattingStewardBridge").ma().na(()=>new WN(new pE(a.resolve("Box4.IFormattingEditor")),a.resolve("Box4.IFormattingEditor"),a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPPTParagraphReader"),a.resolve("Box4.IParagraphIndentationReader"),
a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").rwb,a.resolve("PowerPointWebEditor.IApplicationSettings").kyg,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteTextWithHighlight,a.resolve("PowerPointWebEditor.IApplicationSettings").pptCopyPasteFontFamilyEnabled)):a.register(1106,"Box4.Actors.IFormattingStewardBridge").ma().na(()=>new pE(a.resolve("Box4.IFormattingEditor")));a.register(1107,"PowerPointWebEditor.IGraphTransactionHelper").ma().na(()=>
new HM(a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.Ka("PowerPointWeb.Comments.ICommentFrame")));a.register(1108,"PowerPointWebEditor.IInsertOnlineVideoDialogHelper").ma().na(()=>new UM(a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),a.resolve("Common.Transaction.ITransactionFactory"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager")));a.register(436,"Box4.IInsertionPointFormatting").ma().na(()=>new zO(a.qb("Box4.IFontSlotProvider"),
a.resolve("Box4.Actors.IFontNameFormattingStrategy"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").dVc));a.register(1109,"Box4.IClipboardCommands").ma().na(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").remapShapeEditCommandEnabled?new mE(u.AFrameworkApplication.Ta,ba.a.C7g,ba.a.rbd,ba.a.sbd,ba.a.K7g):new mE(u.AFrameworkApplication.Ta,E.a.jVb,E.a.eDc,E.a.tqa,E.a.yad));a.register(528,
"HtmlImport.IHtmlNormalizerSettings").ma().na(()=>new nC(!1,a.resolve("Common.IAppSettingsManager").ka("SplitHyperlinkFixWithEnterIsEnabled")));a.register(510,"HtmlImport.IHtmlTranslatorSettings").ma().na(()=>{const c=a.resolve("PowerPointWebEditor.IApplicationSettings");return new bC(c.Ixg&&a.resolve("Common.IAppSettingsManager").ka("ListMarkerIsEnabled"),void 0,void 0,void 0,!0,c.V8a||c.lwk,c.V8a,c.pptCopyPasteTextWithHighlight,c.V8a,c.V8a||c.pptCopyPasteFontFamilyEnabled,void 0,c.pptCopyPasteMarginAndIndentationEnabled,
a.resolve("Common.IAppSettingsManager").ka("CopyAndPasteTextFromWordWin32FixIsEnabled"),c.pptCopyPasteFontFamilyEnabled,a.resolve("Common.IAppSettingsManager").ka("SupportCloudFontInExternalPasteIsEnabled"),void 0,void 0,c.V8a,f=>f.rTc&&c.mbe,()=>c.ybe)});a.register(476,"Box4.Actors.IBox4PasteStewardBridge").ma().na(()=>new YN(a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("Box4.Actors.IBox4PasteStewardUtils"),a.resolve("Box4.IFormattingPropertyTransitStrategy"),a.resolve("PowerPointWebEditor.IPptListEditor"),
a.resolve("Box4.Graph.IGraphIteratorFactory")));a.register(lE.a,"Common.PressOnlyKeyEvent").ma().na(()=>lE.a.instance());a.register(ME,"PowerPointWebEditor.PasteFromFloatieArgs").ma().na(()=>new ME);a.register(1110,"PowerPointWebEditor.IPasteFloatieHelper").ma().na(()=>new $N(a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("Box4.Graph.IGraphInstance"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,
a.resolve("PowerPointWebEditor.IThumbnailPane"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),a.resolve("Common.IClickInputManager"),a.resolve("PowerpointPresence.IPresenceEventSource"),a.resolve("PowerPointWebEditor.IDialogManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),
a.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IRibbonPane"),a.resolve("PowerPointWebEditor.IApplicationSettings").qyg,a.resolve("Common.IAppSettingsManager"),a.resolve("Common.PressOnlyKeyEvent"),a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IDesignModeManager").XAa));a.register(nE,"Box4.Clipboard.NoOpEdgeSystemClipboardSelectionEnsureStrategy").as("Box4.Clipboard.IEdgeSystemClipboardSelectionEnsureStrategy").ma().na(()=>
new nE);a.register(173,"Box4.IContextSetEditor").ma().na(()=>Df.ContextSetEditor.instance);a.register(1111,"PowerPointWebEditor.IPPTFormattingStewardHelper").ma().na(()=>new XN(a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.ITableCellReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IPPTTableStyleReader")));a.register(Vs,"PowerPointWebEditor.EnterViewStrategy").as("Box4.Actors.IEnterViewStrategy").ma().na(()=>new Vs(a.qb("Box4.IAutoCorrectScheduler"),
a.le("Box4.IUndoManager"),a.Ka("Box4.IExternalSelectionManager")));a.register(KE,"PowerPointWebEditor.PPTFontNameFormattingStrategy").as("Box4.Actors.IFontNameFormattingStrategy").ma().na(()=>new KE(a.resolve("PowerPointWebEditor.IFormattingHelper")));a.register(1112,"Box4.Actors.IEopFormattingStrategy").ma().na(()=>a.resolve("PowerPointWebEditor.IApplicationSettings").$9a?Object(ua.a)(1112,new MN):Object(ua.a)(1112,new hM));a.register(1113,"Box4.ISelectAllHandlers").ma().na(()=>new Rr(Pw.PageReader.instance,
a.le("Box4.IUndoManager"),a.resolve("Box4.Graph.IGraphTransactionFactory"),!1,!0));a.register(1114,"Box4.Actors.IDeleteOutlineElementNodeStrategy").ma().na(()=>new KN(a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.ISelectionManager")));a.register(1115,"Box4.IFormatPainterStrategy").ma().na(()=>new NN(a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptListEditor"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(372,"Box4.Clipboard.IClipboardOperationCutStrategy").ma().na(()=>
new JN);a.register(373,"Box4.Actors.IDeleteTableSegmentStrategy").ma().na(()=>new LN(a.resolve("PowerPointWebEditor.ITableCellSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager")));a.register(1116,"PowerPointWebEditor.IUploadFrameFactory").ma().na(()=>new yO(a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").uIj));a.register(1117,"PowerPointWebEditor.IPictureUploaderHelper").ma().na(()=>
new xO(a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(1118,"PowerPointWebEditor.IPictureUploader").ma().na(()=>new wO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ISlidePane"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.IPPTFileReaderHelper"),a.resolve("PowerPointWebEditor.IUploadFrameFactory"),a.resolve("PowerPointWebEditor.IFileApiHelper"),()=>a.resolve("PowerPointWebEditor.IChunkedPictureUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.IPictureUploaderHelper"),a.resolve("PowerPointWebEditor.ISessionInfoOwner")));a.register(1119,"PowerPointWebEditor.IChunkedPictureUploader").na(()=>new Zv(a.resolve("Common.ITaskManager"),()=>{Nc.a.O9a()},Object(C.a)(tk.a.instance,tk.a.instance.o4a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.IPictureUploaderHelper")));a.register(1120,"PowerPointWebEditor.IWarningDialog").ma().na(()=>new jO);a.register(529,"PowerPointWebEditor.ICalloutNotificationAdapter").ma().na(()=>
new WQ.a(a.resolve("Common.App.CalloutNotification.ICalloutNotification"),a.resolve("PowerPointWebEditor.IRibbonPane").xa));a.register(1121,"PowerPointWebEditor.IDataUploader").na(()=>new AO(a.resolve("Common.ITaskManager"),()=>{Nc.a.O9a()},Object(C.a)(tk.a.instance,tk.a.instance.o4a,"checkAndTriggerSessionHasExpired"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(1122,"PowerPointWebEditor.IPastedDataUploader").ma().na(()=>
new fO(a.resolve("PowerPointWebEditor.IDataUploader"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")));a.register(162,"PowerPointWebEditor.IMediaUploader").na(()=>new hR.a(a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),()=>{Nc.a.O9a()},tk.a.instance.o4a.bind(tk.a.instance)));a.register(1123,"PowerPointWebEditor.ISystemClipboard").ma().na(()=>
new hO(a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("Box4.Clipboard.ISystemClipboardAccessManagerFactory"),a.resolve("PowerPointWebEditor.IDesignModeManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IApplicationSettings")));a.register(1124,"PowerPointWebEditor.IInternalClipboard").ma().na(()=>new VN(a.resolve("PowerPointWebEditor.IApplicationSettings").Kvg?a.resolve("Box4.Graph.IGraphInstance").vd(10):null,a.resolve("PowerPointWebEditor.IApplicationSettings").Kvg?
a.resolve("Box4.Graph.IGraphInstance").vd(8):null));a.register(1125,"PowerPointWebEditor.ICutCopyManager").ma().na(()=>new TN(a.resolve("PowerPointWebEditor.IDesignModeManager").XAa,[new gO(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").XAa,a.le("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),
a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportProcessor"),a.resolve("PowerPointWebEditor.HtmlExport.IHtmlExportUtils"),a.resolve("PowerPointWebEditor.IApplicationSettings").VFj,a.resolve("PowerPointWebEditor.IApplicationSettings").JGj,a.resolve("PowerPointWebEditor.IApplicationSettings").UFj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),
u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager")),new Sr(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").XAa,a.le("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("PowerPointWebEditor.IApplicationSettings").WFj,a.resolve("Common.IAppSettingsManager").ka("UseToastForDeferredBlobsEnabled"),u.AFrameworkApplication.userSessionId,a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))],a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPoint.IBrowserHelperManager"),
a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended")));a.register(1126,"PowerPointWebEditor.IPasteManager").ma().na(()=>new qh(a.le("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IDesignModeManager").XAa,a.resolve("PowerPointWebEditor.IInternalClipboard"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPoint.IBrowserHelperManager"),
[new bO(a.resolve("Common.IActionManagerExtended"),a.le("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").h$d,a.resolve("PowerPointWebEditor.IApplicationSettings").lyg),new cO(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").i$d),new ZQ.a(a.resolve("Common.IActionManagerExtended"),
a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IWarningDialog"),a.resolve("Common.IBrowserUtils"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("PowerPointWebEditor.IApplicationSettings").LMj,a.resolve("PowerPointWebEditor.IApplicationSettings").nOj,a.resolve("PowerPoint.IBrowserHelperManager"),a.resolve("PowerPointWebEditor.IPictureUploader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")),
new Rx(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil")),new aA(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),u.AFrameworkApplication.mQ),new NE(a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IFocusManager"),a.resolve("PowerPointWebEditor.IPasteHandlerUtil"),a.resolve("PowerPointWebEditor.IClipboardHelper"))],
a.resolve("PowerPointWebEditor.IInputHandlerManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("Common.IBrowserUtils"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IClipServiceManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPointWebEditor.IShapeReader"),
a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")));a.register(818,"PowerPointWebEditor.ICopyPasteUtility").ma().na(()=>new Dq.a(a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(1127,"PowerPointWebEditor.IPasteHandlerUtil").ma().na(()=>new aO);a.register(1128,"PowerPointWebEditor.IClipboardHelper").ma().na(()=>new qE.ClipboardHelper(a.resolve("PowerPointWebEditor.IInternalClipboard"),b.aRa().fk||Ap.a.bGh,a.resolve("Common.IAppSettingsManager").Ga("RedisCacheServiceEnabledDatacenters"),
a.resolve("Common.IAppSettingsManager").Cc("ClipServiceItemExpireTimeInMinutes",60),a.resolve("Common.IAppSettingsManager").ka("PptEditingSlideCopyAsImageUrlEnabled"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(1129,"PowerPointWebEditor.IClipServiceManager").ma().na(()=>new SN(b.aRa(),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(1130,"Box4.TableEditors.ITableStylePreviewGenerator").ma().na(()=>new Fq(a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("PowerPointWebEditor.ITableStyleReaderHelper"),
a.resolve("PowerPointWebEditor.DataModel.IHierarchyHelper"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),Sz.FVf,c=>new PD(c,a.resolve("PowerPointWebEditor.ITableStyleResolver")),c=>new ND(c),a.resolve("PowerPointWebEditor.IApplicationSettings").j$));a.register(1131,"Box4.TableEditors.ITableStyleRibbonControls").ma().na(()=>new CN(a.resolve("PowerPointWebEditor.IPPTTableStyleReader"),a.resolve("PowerPointWebEditor.ISlideReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.ITableStyleGalleryManager"),
a.resolve("Box4.TableEditors.ITableStylePreviewGenerator")));a.register(1132,"Common.App.ImageProcessor.IImageProcessor").ma().na(()=>new gM(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder")));a.register(1133,"PowerPointWebEditor.IPPTFileReaderHelper").ma().na(()=>new CO);a.register(1134,"Box4.Actors.IFormattingViewOperationFinishedStageProcessor").ma().na(()=>new dA(a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IPageView"),a.resolve("PowerPointWebEditor.IShapeReader")));
a.register(1135,"PowerPointWebEditor.ILocalImageViewFactory").ma().na(()=>new rO(a.resolve("PowerPointWebEditor.IFileApiHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings").e9a));a.register(1136,"PowerPointWebEditor.IShapeProgressIndicatorViewFactory").ma().na(()=>new tO);a.register(679,"PPTe.IColorPickerBuilderFactory").ma().na(()=>new MQ.a);a.register(1137,"PowerPointWebEditor.IFileApiHelper").ma().na(()=>new BO);a.register(1138,"PowerPointWebEditor.IInsertImageHelper").ma().na(()=>new SM(a.resolve("PowerPointWebEditor.IPPTUnitConversion"),
a.resolve("PowerPointWebEditor.IPresentationReader")));a.register(oE,"Box4.Actors.FormatPainter").as("Box4.IFormatPainter").ma().na(()=>new oE(a.resolve("Box4.Styles.IStyleEditor"),a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IFormattingEditor"),a.resolve("Box4.IParagraphEditor"),a.resolve("Box4.IParagraphReader"),a.resolve("Box4.List.IListEditor"),a.resolve("Box4.List.IListReader"),a.resolve("Box4.ICharacterPropertiesEditor"),ed.a.instance,a.qb("Box4.IFeatureHelper"),a.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance,
a.resolve("Box4.TrackChange.ITrackChangeEditorFactory").instance,a.resolve("Box4.TextFormattingHelper")));a.register(1139,"PowerPointWebEditor.IFormatPainter").ma().na(()=>new nO(a.resolve("Common.IActionManagerExtended"),a.resolve("Box4.Graph.IGraphInstance").vd(10),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled));a.register(1140,
"PPTe.IResourceViewElementResolver").ma().na(()=>new RN(b.aRa(),Cb.App.webServiceBase));a.register(1141,"PowerPointWebEditor.IOfflineModalCallout").ma().na(()=>new oO(a.resolve("Box4.IAppFrame")));a.register(1142,"PowerPointWebEditor.IPPTOfflineManager").ma().na(()=>new iO(a.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.IApplicationSettings"),
a.resolve("PowerPointWebEditor.IStatusBarUser"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));a.register(1102,"PowerPointWebEditor.IClipboardTelemetry").ma().na(()=>new mu.a(a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("Box4.Graph.IGraphInstance").vd(8),
a.resolve("Box4.Graph.IGraphInstance").vd(10),a.resolve("Box4.Graph.IGraphInstance").vd(12),a.resolve("Box4.Graph.IGraphInstance").vd(60),a.resolve("Box4.Graph.IGraphInstance").vd(7),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter"),a.resolve("PowerPointWebEditor.Core.IPasteProgressManager")))}init(){const a=this.K;var b=a.resolve("Common.AFrameworkApplication");const c=b.bS;var f=b.kr;const l=c.ld;var x=a.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),
G=f.xeb;const R=a.resolve("Common.IActionManagerExtended"),fa=a.resolve("PowerPointWebEditor.IFrameContext"),wa=a.resolve("PowerPointWebEditor.IFocusManager"),Wa=a.resolve("PowerPointWebEditor.IFormatPainter"),mb=a.resolve("PowerPointWebEditor.CoauthManager"),Kb=a.resolve("PowerPointWebEditor.ISessionLifetimeManager"),nc=fb.a.instance.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),oc=fb.a.instance.resolve("PowerPointWebEditor.IDialogManager"),Ic=fb.a.instance.resolve("PowerPointWebEditor.IPptSelectionManager"),
Kc=fb.a.instance.resolve("Box4.ISelectionManager"),Hc=fb.a.instance.Ka("Box4.IExternalSelectionManager"),ie=fb.a.instance.resolve("PowerPoint.IPathManager");var He=fb.a.instance.resolve("PowerPointWebEditor.IInternalClipboard");const fe=f.Hd,Te=fb.a.instance.resolve("PowerPointWebEditor.IRibbonChangeManager");b=fb.a.instance.resolve("PowerPointWebEditor.ISaveBlockingUI");const We=fb.a.instance.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Qf=fb.a.instance.resolve("PowerPointWebEditor.UndoRedo.IPPTUndoManager"),
mg=fb.a.instance.resolve("PowerPointWebEditor.INotesView"),Xg=fb.a.instance.resolve("Box4.IFormatPainter"),Mg=a.resolve("PowerPointWebEditor.IRevisionMetadataHelper"),Sf=a.resolve("Common.Transaction.ITransactionFactory"),uh=a.resolve("PowerPointWebEditor.IPresentationReader"),Sg=a.resolve("PowerPointWebEditor.IShapeReader"),li=a.resolve("PowerPointWebEditor.Graph.ITableReader"),Ui=a.resolve("PowerPointWebEditor.Graph.ITableColumnReader"),Cj=a.resolve("PowerPointWebEditor.Graph.ITableRowReader");
var jj=a.resolve("PowerPointWebEditor.ITableEditor");const kj=fb.a.instance.resolve("PowerPointWebEditor.IShapeEditor"),Gi=fb.a.instance.resolve("PowerPointWebEditor.IGraphTransactionHelper"),yk=a.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),Dj=a.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),ok=a.resolve("PowerPointWebEditor.Graph.IGraphNodeContextHelper"),Fl=fb.a.instance.resolve("Box4.List.IListReader"),Xk=a.resolve("Box4.Graph.IGraphIteratorFactory"),Gl=a.resolve("PPTe.IColorPickerBuilderFactory"),
ak=a.resolve("PowerPointWebEditor.View.IPPTPageView");this.xka=fb.a.instance.resolve("PowerPointWebEditor.ICutCopyManager");this.qC=fb.a.instance.resolve("PowerPointWebEditor.IPasteManager");const Sj=fb.a.instance.resolve("PowerPointWebEditor.IPresentationResourcesManager"),bk=fb.a.instance.resolve("PPTe.IResourceViewElementResolver");fb.a.instance.resolve("PowerPointWebEditor.ILocalImageViewFactory");fb.a.instance.resolve("PowerPointWebEditor.IShapeProgressIndicatorViewFactory");const Gk=fb.a.instance.resolve("PowerPointWebEditor.IGraphHotColdManager"),
Nj=fb.a.instance.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),vh=a.resolve("Common.Utils.IHighContrastDetector"),Yk=fb.a.instance.resolve("PowerPointWebEditor.ISubtitleContext"),Ul=a.resolve("PowerPointWebEditor.IRibbonUser"),sm=a.resolve("Box4.CloudFontService"),zk=a.resolve("Box4.CustomFontService");this.Kre=new vj(R,nc,wa,fa.LCID,Ic,Sf,Gi,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),uh,new mO(fb.a.instance.resolve("PowerPointWebEditor.IFocusManager"),fb.a.instance.resolve("PowerPointWebEditor.IPresentationReader")),
Sj,l,bk);this.ame=new Pj(Gi,R,wa,Ic,nc,ak,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),a.resolve("Box4.Graph.IGraphInstance").vd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),Te,kj,Nj,a.resolve("PowerPointWebEditor.IApplicationSettings").aKj,a.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInsertShapeOverlayViewStateManager"),
a.Ka("PowerPointWebEditor.IInsertShapeOverlayViewElement"),a.resolve("PowerPointWebEditor.IApplicationSettings").ovb,l.mCj,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IGraphHotColdManager"),a.resolve("Box4.Graph.IGraphInstance").vd(10));this.$le=new fA(Gi,R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),nc,ak,a.resolve("Box4.Graph.IGraphInstance").vd(7),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation,
Te,kj,Nj,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IInkDryStore"));He=new xM(R,wa,a.resolve("PowerPointWebEditor.IPptSelectionManager"),fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Sf,a.resolve("PowerPointWebEditor.IGraphTransactionHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),He,nc,this.xka,this.qC,a.resolve("PowerPointWebEditor.IDesignModeManager").XAa,a.resolve("PowerPointWebEditor.ICopyPasteUtility"),
uh,kj,ak,a.resolve("PowerPointWebEditor.IWarningDialog"),(ni,cg,Gd,Ce,Hf,je,Fg,$h,Hi)=>new $M(ni,cg,Gd,Ce,Hf,je,Fg,$h,Hi),Nj,a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.ISystemClipboard"),a.resolve("PowerPointWebEditor.IInsertImageHelper"),a.resolve("Common.ITaskManager"),a.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),a.resolve("PowerPointWebEditor.IDeferredContentManager"));const pk=new fi(R,wa,Sf,G,Wa,
nc,a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("PowerPointWebEditor.IBox4ColorHelper"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),a.resolve("PowerPointWebEditor.ShapeEdit.ISVGIconLocalEditor"),a.resolve("PowerPointWebEditor.IJSanityHelper"),a.resolve("PowerPointWebEditor.IShapeReader"),Xg,Mg,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),vh,a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("PowerPointWebEditor.IZoomContext"),a.resolve("Box4.Styles.ITableStyleReader"),a.resolve("Box4.IPageView").Ma),mi=new ZM(R,nc,fa,Sf,Ic,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"));G=new JM(R,Sf,Ic,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeEditor"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
a.resolve("PowerPointWebEditor.IPPTUnitConversion"),fa,a.resolve("PowerPointWebEditor.IApplicationSettings"));x=[new oM(R,l,x,Ic,Sf,nc),He,new Sx(R,l,u.AFrameworkApplication.fa.ka("UseToastForDeferredBlobsEnabled"),a.resolve("PowerPointWebEditor.IClipServiceManager"),wa,nc,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Sf,yk,fe,a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.ICopyPasteUtility"),ak,Nj,a.resolve("PowerPointWebEditor.IPptSelectionManager"),
a.resolve("PowerPointWebEditor.ICcpEventNotifier"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),Gk,a.resolve("Box4.IPasteFloatieEventNotifier"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IPasteFloatieHelper"),a.resolve("PowerPointWebEditor.PasteFromFloatieArgs"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.IClipboardTelemetry"),this.qC,a.resolve("PowerPointWebEditor.Core.IPasteProgressManager"),
a.resolve("PowerPointWebEditor.IPastedDataUploader"),a.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new AM(R,fb.a.instance.resolve("PowerPointWebEditor.IDesignModeManager"),oc,a.le("PowerPointWebEditor.IContextMenuUser"),fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),wa,a.resolve("PowerPointWebEditor.IOfflineModalCallout"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),
l.pptContextMenuOnSelectionFixIsEnabled,l.Rea),new BM(R,Ic,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.View.IAccCheckPane"),l.powerPointGraphicToolTabIsEnabled,l.d8g,l.KEb),new HN(R,l,nv.a.Htb,Xk,a.resolve("Box4.IParagraphReader")),new IN(ku.instance),this.ame,this.$le,G,new Ux(R,nc,wa,fa.notesPane,mg,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),fa,a.resolve("PowerPointWebEditor.IActiveSlideViewManager"),f,fb.a.instance.resolve("PowerPointWebEditor.ISlideCacheManager"),
a.resolve("PowerPointWebEditor.View.IPPTPageView")),new YM(R,a.resolve("PowerPointWebEditor.IPPTOfflineManager"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IStatusBarUser")),mi,new fN(R,fa,Ul,wa,a.resolve("PowerPointWebEditor.ICUIManager"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"),a.resolve("Common.IRibbonExternal"),a.resolve("Common.IAppSettingsManager").ka("AltForKeytipEnabled")),new iN(R,nc,wa,oc,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
a.resolve("PowerPointWebEditor.IPptSelectionManager"),Wa,a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPointWebEditor.IAriaManager"),a.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),l.Ly,a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IShapeReader"),l.podsNewThumbnailVisibleRangeFetchExperience,a.resolve("PowerPointWebEditor.IVideoManagerStore"),l.uP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),l.j4a),
pk,new mN(R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),nc,Sf,wa,Sj,bk,Ic,Sg,a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointGraphicToolTabIsEnabled,a.resolve("PowerPointWebEditor.Core.ICoreEventHandler")),new Tv(Gi,R,wa,nc,a.resolve("PowerPointWebEditor.IFontUtilsManager"),a.resolve("PowerPointWebEditor.IPptSelectionManager"),a.resolve("Box4.IFormattingEditor"),Sg,!!sm&&sm.isEnabled,!!zk&&zk.isEnabled,a.resolve("PowerPointWebEditor.IApplicationSettings").podsHtmlTextForEmbeddedFontsIsEnabled,
a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),new nN(Gi,R,wa,nc,Ic,Sg,a.resolve("PowerPointWebEditor.Graph.IPPTLineSpacingHelper"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),a.resolve("Box4.Graph.IGraphIteratorFactory"),Sf,l.zbe,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("Box4.List.IListReader"),a.resolve("PowerPointWebEditor.IApplicationSettings")),this.Kre,new oN(R,nc,Sf,Gi,wa,Ic,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
uh,l,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers")),new qN(R,oc,wa,nc,Gi,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),uh,We,(ni,cg)=>new gR.a(ni,cg),a.resolve("PowerPointWebEditor.IPptSelectionManager"),l.Ly,l.Abe),new tN(R,nc,Ic,Sf,wa,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Te,uh,kj,ak,Nj,a.resolve("PowerPointWebEditor.IShapeReader")),
new vN(()=>Qf,new wN(Kc,nv.a.Htb,a.resolve("Box4.IContextSetEditor")),Hc,l),new DN(R,nc,l,wa,Ic,Qf,a.Ka("PowerPointWebEditor.IAppForOfficeManager"),a.le("PowerPointWebEditor.IAppforOfficeClassFactory"),ak,a.resolve("PowerPointWebEditor.IShapeReader"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventNotifier"),a.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEditSmartArtTextPaneIsEnabled,a.resolve("PowerPointWebEditor.IPptTableDragSelectionHelper"),a.resolve("PowerPointWebEditor.Graph.ITableReader"),
a.resolve("PowerPointWebEditor.ISlidelessPane"),a.Ka("PowerPointWebEditor.ITextLayoutManager"),a.resolve("PowerPointWebEditor.WebSocketFrontDoor.IWebSocketFrontDoor"),a.Ka("PowerPointWebEditor.IAudioManagerStore")),new lA(R,Ic,Dj,wa,b,Kb,fb.a.instance.resolve("PowerPointWebEditor.IApplicationSettings")),new QN(R,a.Ka("PowerPointWebEditor.ICommentsPane"),wa,a.resolve("Common.IF6Manager"),Ic,Dj,nc,ie,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),uh,a.resolve("PowerPointWebEditor.IWindowUtils"),
u.AFrameworkApplication.fa,l,b,c.aRa(),Kb,We,fb.a.instance.resolve("PowerPointWebEditor.ISlideshowManager"),fb.a.instance.resolve("Box4.Graph.IGraphInstance").vd(7),fb.a.instance.resolve("PowerPointWebEditor.IInboundHelper"),fb.a.instance.resolve("Common.ITaskManager"),u.AFrameworkApplication.Ge,fb.a.instance.resolve("PowerPointWebEditor.IJsonpHelperManager"),fb.a.instance.resolve("PowerPointWebEditor.View.IViewEventSource"),a.Ka("PowerPointWeb.Comments.ICommentFrame"),a.Ka("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
Yk,fb.a.instance.Ka("PowerPointLive.ILivePresenter"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IStatusBarUser"),f,a.resolve("PowerPointWebEditor.ITaskPaneManager"),a.resolve("PowerPointWebEditor.IDeferredContentManager"))];jj=new su(R,Xk,nc,wa,Fl,Sg,li,Cj,Ui,kj,jj,l,Sf,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ic,Nj,a.resolve("PowerPointWebEditor.ITableSelectionAdapter"),a.resolve("PowerPointWebEditor.ITableMergeSplitEditor"),a.resolve("PowerPointWebEditor.ICellIteratorFactory"),
a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IRibbonChangeManager"),a.resolve("PowerPointWebEditor.ITableMetrics"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptIsInsertMultiRowColumnEnabled,Ul,a.resolve("Box4.Styles.ITableStyleReader"));x.push(new pu(R,Ic,wa,Fl,a.resolve("Box4.ILineSpacingHelper"),Sf,ok,Xk,Cb.App.VJa.yGc(12),Cb.App.VJa.yGc(10),Sg,a.resolve("Box4.IContextSetEditor"),a.resolve("PowerPointWebEditor.IPptListMarkersLoader"),
l.zbe,l.isPromoteDemoteOnParagraphEnabled,Gl,l.dVc,a.resolve("PowerPointWebEditor.Graph.ITableReader"),a.resolve("PowerPointWebEditor.IApplicationSettings").pptTextFormatPainterIsEnabled,a.resolve("PowerPointWebEditor.ITableEditor"),Xg,f,fe,a.resolve("PowerPointWebEditor.ViewCore.IFormatPainterContext"),a.resolve("Box4.IInsertionPointFormatting"),Mg,a.resolve("Box4.IParagraphIndentationReader"),a.resolve("Box4.IParagraphEditor"),a.resolve("PowerPointWebEditor.IApplicationSettings").cgb));x.push(jj);
f=new IE(R,wa,Sg,Gi,nc,Ic,a.resolve("Box4.IInsertionPointFormatting"),a.resolve("Box4.IParagraphReader"));x.push(f);l.cUk&&x.push(new cN(R,wa,a.resolve("PowerPointWebEditor.IPresentationReader")));l.$Ak&&x.push(new yM(R,a.resolve("PowerPointWebEditor.ICoauthStateSetter"),l));(l.sJb||l.eib)&&x.push(new Xv(R,l,Sf,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ic,li,a.resolve("PowerPointWebEditor.IFunctionThrottlerFactory"),a.resolve("PowerPointWebEditor.View.IPPTPageView")));l.u0h&&x.push(new mM(Ic,
u.AFrameworkApplication.fa,l,Object(C.a)(Lz.App.m3a,Lz.App.m3a.g7f,"forceUpdateRibbonControls")));for(const ni of x)ni.ub(),ni.xe();fb.a.instance.Ka("PowerPointWebEditor.ISorterViewActorMain").execute(ni=>{ni.ub()});a.resolve("PowerPointWebEditor.IPPTProcessImageStrategy").jei(new uO(a.resolve("Common.ITaskManager"),a.resolve("Box4.IFileReaderHelperFactory"),a.resolve("Common.App.ImageProcessor.IImageProcessor"),a.resolve("PowerPointWebEditor.IApplicationSettings")));const wg=this;u.AFrameworkApplication.fa.ff(()=>
{const ni=Wy.a(a),cg=[new PN(R,nc,Ic,wa,Qf,l.oLj,mb,fe.yf,a.Ka("PowerpointPresence.IPresenceManager"),a.resolve("PowerPointWebEditor.ITablePartialEditController"),a.resolve("PowerPointWebEditor.IActionNameResolver"),a.resolve("PowerPointWebEditor.IGroupUngroupUndoRedoActionController"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.View.IViewEventNotifier"))],Gd=u.AFrameworkApplication.fa.ka("LiveSubtitlesEnabled");l.Rja&&Gd&&cg.push(new Xx(R,a.resolve("PowerPointWebEditor.IPresentationReader"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),Yk));wg.p4c=new gN(R,Gi,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("Box4.Graph.IGraphInstance").vd(7),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"));cg.push(wg.p4c);cg.push(new kN(R,Ic,ak,a.resolve("PowerPointWebEditor.IApplicationSettings").dja));cg.push(new jN(ni,Ic,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.ISelectionPane"),
pk,mi,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder"),fa,Sg,a.resolve("Box4.IPageView").Ma,a.resolve("Common.Transaction.ITransactionFactory")));cg.push(new DM(ni,Ic,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,wa,a.resolve("PowerPointWebEditor.View.IFormatShapePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),Sg,l.JWi,l.O9k,l.dja,a.resolve("PowerPointWebEditor.IImageViewManager")));cg.push(new FM(Ic,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,wa,a.resolve("PowerPointWebEditor.View.IFormatTablePane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.View.IPPTPageView"),a.resolve("PowerPointWebEditor.IPPTUnitConversion"),a.resolve("PowerPointWebEditor.IPPTWorkspace"),a.resolve("Common.IDynamicScriptLoaderProvider").Jv,li,Cj,Ui));l.Jxg?cg.push(new QM(ni,Ic,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),
a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),a.resolve("PowerPointWebEditor.View.IViewEventSource"),Sf,l.rBe)):cg.push(new NM(ni,Ic,a.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),R,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),wa,a.resolve("PowerPointWebEditor.View.IHeaderFooterPane"),a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),a.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
a.resolve("PowerPointWebEditor.View.IViewEventSource"),Sf,l.rBe));cg.push(new zM(ni,R,wa,fe));l.powerPointSmartLookupIsEnabled&&cg.push(new RM(Gi,R,fe,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),nc));l.XAk&&cg.push(new rM(a.resolve("Common.IDynamicScriptLoaderProvider").Jv,R,a.resolve("PowerPointWebEditor.ISubtitleContext"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext")));cg.push(new pM(R,Ic,wa,Sf,a.Ka("PowerPointWebEditor.IAudioManagerStore"),
l.uP,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.Core.IUnifiedAppState")));cg.push(new lM(R,Ic,Sf,fe,a.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),a.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),a.resolve("PowerPointWebEditor.IErrorHandler"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),l.X_h,l.IBl,()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")));
l.cBk&&cg.push(new XM(a.resolve("Common.IDynamicScriptLoaderProvider").Jv,l.aBk,l.bBk,R,nc,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Ic,Nj));l.pptoCaptionDiscoverabilityPaneEnabled&&cg.push(new Qv(a.resolve("Common.IDynamicScriptLoaderProvider").Jv,R,a.resolve("PowerPointWebEditor.View.IViewEventSource"),a.resolve("PowerPointWebEditor.IPresentationReader"),a.resolve("PowerPoint.IPathManager"),a.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),a.resolve("PowerPointWebEditor.ISubtitleContext"),
a.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),a.resolve("PowerPointWebEditor.ISlideshowFrame"),l.YAk));wg.MHg=new CM(R,a.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Sf,a.resolve("Box4.Graph.IGraphInstance").vd(82));cg.push(wg.MHg);for(const Ce of cg)Ce.ub(),Ce.xe();Yk.e_b=Gd});(new bN(c.EK(),c.C0d(),b,Dj,Ic,a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.ISessionInfoOwner"),a.resolve("PowerPointWebEditor.IActionNameResolver"))).ub();
u.AFrameworkApplication.Aa&&u.AFrameworkApplication.Aa.jb.hce&&HQ()}dispose(){this.xka.dispose();this.qC.dispose();this.Kre.dispose();this.ame.dispose();this.$le.dispose();this.p4c&&this.p4c.dispose();const a=this.K.Ka("PowerPointWebEditor.IDesignerManager").instance;a&&a.dispose()}}Object(e.a)(DO,"ActorPackage",null,[2,3]);class EO{constructor(a,b,c,f,l,x,G,R,fa,wa){this.cH=!1;this.Zb=a;this.ua=b;this.Ig=c;this.WG=f;this.Qb=l;this.qv=x;this.yb=G;this.yua=R;this.tRg=fa;this.Mc=wa;this.iqe=[0,1,2,
3];this.o4=new ef.a;for(const Wa of this.iqe)this.o4.$(Wa,[]);this.o4.$(4,[]);this.Ig.UH(Object(C.a)(this,this.dB,"onActiveSlideChanged"));this.yua.Yj(Object(C.a)(this,this.D9c,"onMainMastersLoaded"));this.tRg.tha(Object(C.a)(this,this.Gye,"onSlideLoaded"));this.tRg.Yj(Object(C.a)(this,this.qma,"onSlidePropertyChanged"));this.Mc.IB(Object(C.a)(this,this.ML,"onSessionClosed"));this.Mc.A3a(Object(C.a)(this,this.sea,"onSessionRehydrating"));this.Mc.JB(Object(C.a)(this,this.to,"onSessionRehydrated"));
this.fPg=new Ex(Object(C.a)(this,this.vBk,"prefetchSlideMasterNode"),250,15E3,8E3,500,"slide master node",this.yb,3);this.ePg=new Ex(Object(C.a)(this,this.uBk,"prefetchSlideMasterImage"),250,6E4,8E3,500,"slide master image",this.yb,3);this.dB(null,null)}dB(){this.xVd()}xVd(){const a=this.ua.Ba;a&&8===a.type&&a.Sa(sb.a.pj)&&a.Sa(sb.a.Cn)&&this.Ksl(a.pj,a.Cn)}vBk(){if(!this.cH){var a=this.o4.ga(0),b=this.o4.ga(1);if(0<a.length){const c=a.length-1,f=a[c];this.XPj(f.first,f.second)&&(Array.removeAt(a,
c),Array.add(b,f),this.fPg.uld(),this.qv.tBk(f.first,f.second))}}}uBk(){if(!this.cH){this.Amd(1,2,c=>!!this.Qb.qsb(c.first,c.second));var a=this.o4.ga(2);if(0<a.length){const c=a[0];var b=this.Qb.qsb(c.first,c.second);b&&this.mNe(b)?(b=b.Yub(new dr.a(b.hq,b.Kk)),this.ePg.uld(),Array.removeAt(a,0),Array.add(this.o4.ga(3),c),this.WG.msb(b,!0,()=>{this.Amd(3,4,f=>!this.mNe(this.Qb.qsb(f.first,f.second)));this.ePg.pld()})):(Array.removeAt(a,0),Array.add(this.o4.ga(4),c))}this.Amd(3,4,c=>!this.mNe(this.Qb.qsb(c.first,
c.second)))}}WPf(){for(const a of this.iqe)Array.clear(this.o4.ga(a));Array.clear(this.o4.ga(4))}Gye(a,b){(a=Object(ua.a)(120,b.node))&&a.DD&&this.zec(a)}qma(a,b){a=b.property;b.node&&a===sb.a.Cn&&b.node===this.ua.Ba&&this.xVd()}zec(a){if(this.UPj(a)&&a){const b=a.pj,c=a.Cn;b&&c&&(this.Amd(1,2,f=>f.first===b&&f.second===c),this.fPg.pld())}}D9c(a,b){a=b.property;if(a===sb.a.kCb||a===sb.a.RX)this.WPf(),this.xVd()}ML(){this.cH=!0}sea(){this.WPf()}to(){this.cH=!1}Ksl(a,b){this.VPj(a,b)||this.WPj(a,b)||
Array.add(this.o4.ga(0),new Vw.a(a,b))}WPj(a,b){for(const c of this.iqe)for(const f of this.o4.ga(c))if(f.first===a&&f.second===b)return!0;return!1}VPj(a,b){for(const c of this.o4.ga(4))if(c.first===a&&c.second===b)return!0;return!1}Amd(a,b,c){a=this.o4.ga(a);b=this.o4.ga(b);for(let f=a.length-1;0<=f;--f)if(c(a[f])){const l=a[f];Array.removeAt(a,f);Array.add(b,l)}}mNe(a){if(!a)return!1;a=a.Yub(new dr.a(a.hq,a.Kk));if(null===a)return!1;for(const b of a)if(!this.WG.DRc.Dfd(b).data)return!0;return!1}UPj(a){const b=
this.Zb.yf.sa(sb.a.Fth,null);if(!b)return!1;for(let c=0;c<b.length;++c)if(b[c].equals(a.id))return!0;return!1}XPj(a,b){var c=this.Qb.hI();if(!c)return!1;for(let f=0;f<c.length;++f)if(c[f].Id===a){a=c[f].ContentMasters;if(!a)break;for(c=0;c<a.length;++c)if(a[c].Id===b)return!0;break}return!1}}Object(e.a)(EO,"SlideMasterPrefetchManager",null,[260]);var iR=d(942);class FO{constructor(a,b,c,f,l,x,G){this.Db=!1;this.NW=null;if(!b)throw Error.argumentNull("appFrame");if(!f)throw Error.argumentNull("viewElementEventSource");
if(!x)throw Error.argumentNull("taskManager");if(!l)throw Error.argumentNull("viewElementEventHandlers");this.yb=x;this.xr=a;this.Ob=b;this.Qt=c;this.ay=f;this.od=l;this.GKg=G;this.z9j=new xe.a(0,1,0,Object(C.a)(this,this.sTk,"renderCommentShimmerHandler"),90,"115")}get isVisible(){return this.Db}hfl(){if(!this.Db&&this.xr&&this.xr.xa){this.NW=this.Wfi();this.GKg||this.xr.xa.appendChild(this.NW);this.xr.setVisibility(!0);this.GKg&&this.od.WEf(Object(C.a)(this,this.L8c,"onCommentContainersChanged"));
var a=new iR.a(!0);this.ay.Pah(a);this.Ob.Hdb(1);this.Db=!0}}L8c(){this.Ob.zBc(Object(C.a)(this,this.dgh,"renderCommentShimmerOnSlideResize"));this.od.HRk(Object(C.a)(this,this.L8c,"onCommentContainersChanged"))}dgh(){this.yb.Cb(this.z9j);this.Ob.Ned(Object(C.a)(this,this.dgh,"renderCommentShimmerOnSlideResize"))}sTk(){!this.NW||this.G3f()?Aa.a.J(522724993,805,10,"Either CommentShimmerView is null or the Element is already added to DOM"):this.xr.xa.appendChild(this.NW)}tmg(){if(this.Db&&this.xr&&
this.xr.xa&&this.G3f()){this.xr.xa.removeChild(this.NW);this.NW=null;this.Db=!1;var a={};a.commentShimmerHideTime=(new Date).getTime();Aa.a.J(523352018,809,50,ta.a.toJSON(a))}}MRi(){this.Db&&this.xr&&this.xr.xa&&(this.NW.className+=" CommentShimmerFadeAwayStyles",window.setTimeout(Object(C.a)(this,this.tmg,"hideShimmerUX"),600))}Wfi(){const a=document.createElement("div");a.className="CommentShimmerFrameStyles";for(let b=0;2>b;b++)a.appendChild(this.Xfi());return a}Xfi(){const a=document.createElement("div");
a.className=this.Qt?"CommentShimmerContainerRtlStyles":"CommentShimmerContainerStyles";a.id="CommentShimmerContainer";const b=document.createElement("div");b.className="CommentShimmerPersonaStyles";const c=document.createElement("div");c.className="CommentShimmerHeaderStyles";const f=document.createElement("div");f.className="CommentShimmerBodyDiv1Styles";const l=document.createElement("div");l.className="CommentShimmerBodyDiv2Styles";const x=document.createElement("div");x.className="CommentShimmerActionStyles";
a.appendChild(b);a.appendChild(c);a.appendChild(f);a.appendChild(l);a.appendChild(x);return a}G3f(){return!!document.getElementById("CommentShimmerContainer")}}Object(e.a)(FO,"CommentShimmerView",null,[261]);class SE{constructor(a,b){this.Ob=a;this.sva=b;this.sva.zFf(Object(C.a)(this,this.tkh,"scaleOnUIChanged"))}dispose(){this.sva.Jfh(Object(C.a)(this,this.tkh,"scaleOnUIChanged"))}a$(){}Z9(a){2===a.behavior&&(a=a.actionId,a!==ba.a.Ama&&a!==ba.a.zma&&a!==ba.a.yma&&a!==ba.a.uma||this.updateCommandUI())}tkh(){this.updateCommandUI()}updateCommandUI(){this.Ob.updateCommandUI()}}
Object(e.a)(SE,"UpdateCommandUIActionListener",null,[147,106]);class TE{constructor(){this.correlationId=this.sessionId=this.UBd=null;this.actionId=0;this.kd=null}get Gf(){return this.UBd?this.UBd:""}set Gf(a){this.UBd=a}}Object(e.a)(TE,"AssistanceSearchVariableUrlParameterSet",null,[]);class jr{constructor(){this.cP=!1;this.bP=!0;this.Gvf=this.ILb=null}get isInitialized(){return this.cP}initialize(a,b){const c=!!a&&!!b;c&&(this.ILb=a,this.Gvf=b);this.cP=c;u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1)||fb.a.instance.Ka("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(f=>{f.M2("Enabled").then(l=>{this.bP=l;return null},()=>null)})}ub(a){a||(a=u.AFrameworkApplication.Ta);u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)&&(this.bP=u.AFrameworkApplication.sE,fb.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(b=>{b.isFeatureEnabled("mso_sendASmile",
!0).then(c=>{this.bP=u.AFrameworkApplication.sE&&c;(c=u.AFrameworkApplication.Aa)&&c.updateCommandUI();return null},()=>null)}));a.ya(F.a.Dgd,xd.a.frame,Object(C.a)(this,this.efl,"showSearchResults"))}efl(a,b,c,f,l){if(1===c)return u.AFrameworkApplication.fa.ka("IsFeedbackExperiencesAvailable")||(this.bP=!1),l&&"SourceControlId"in l&&(l=l.SourceControlId,("GiveFeedback"===l||"btnFeedback"===l||"btnFeedbackPane"===l||"PptEditingStatusBar.GiveFeedbackPane"===l||"GiveFeedbackPane"===l)&&!this.bP)?8:
sz.SessionStatusManager.instance.gja?8:32;Z.ULS.sendTraceTag(4761738,1302,50,"");Me.a.mark(4771);if(this.isInitialized){a=l.CommandValueId;b=l.SourceControlId;l=Object.assign(new TE,{actionId:F.a.Dgd,kd:l});if(void 0!==a&&null!==a)l=jr.Yij(a);else if(void 0!==b&&null!==b)switch(b){case "btnFeedback":case "btnFeedbackPane":case "PptEditingStatusBar.GiveFeedbackPane":case "GiveFeedbackPane":case "GiveFeedback":l.actionId=F.a.giveFeedback;break;case "btnContactSupport":case "ContactSupport":l.actionId=
F.a.OPd;break;case "btnShowTraining":case "Training":l.actionId=F.a.mzh;break;case "btnWhatsNew":case "WhatsNew":l.actionId=F.a.nGh}this.ILb.gdl(this.Gvf,l);Me.a.mark(4772);return 32}Me.a.mark(4772);return 8}dispose(){this.ILb&&(this.ILb.dispose(),this.ILb=null)}static get instance(){jr.Ja||(jr.Ja=new jr);return jr.Ja}static Yij(a){const b=new TE,c=a.indexOf("|");b.sessionId=a.substring(0,c);const f=a.indexOf("|",c+1);b.correlationId=a.substring(c+1,f);b.Gf=a.substr(f+1);return b}}jr.Ja=null;Object(e.a)(jr,
"AssistanceActor",null,[106]);class UE{constructor(){this.IYe=this.eb=this.Pjb=null;this.RAd=!1}gdl(a,b){if(b.actionId!==F.a.giveFeedback||u.AFrameworkApplication.sE)if(this.RAd&&!u.AFrameworkApplication.dra)this.Pjb||(this.Pjb=this.IYe()),this.Pjb.Tl(a,b);else if(b.actionId===F.a.giveFeedback)this.Rcl();else{a=a.FPc(b);b=null;try{Ka.a.g8(a)&&(b=ib.a.an(a,"_blank","height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",
"AssistanceDisplayManager:HelpWindow"))}catch(c){throw Z.ULS.sendTraceTag(4543175,1302,10,"An exception has occured while trying to launch the Online Assistance window: "+c.message),c;}b?Z.ULS.sendTraceTag(4543177,1302,50,"Window.Open() returned a window when opened with URL {0}",a):Z.ULS.sendTraceTag(4543176,1302,15,"Window.Open() returned a null window when opened with URL {0} and help options {1}",a,"height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no")}else Z.ULS.sendTraceTag(554295451,
356,15,"ShowFeedbackButton is false, but ShowContent got called, some feedback entry point is still visible")}dispose(){this.Pjb&&(this.Pjb.dispose(),this.Pjb=null)}sph(a,b,c){c&&Zk.b(a)?this.RAd=!1:(this.IYe=a,this.RAd=c);this.eb=b}Rcl(){u.AFrameworkApplication.Ta.processAction(F.a.giveFeedback,2)}static createInstance(a,b,c=null){const f=new UE;null==c?f.sph(a,b,u.AFrameworkApplication.bJf||b.ka("HelpTabIsEnabled")):f.sph(a,b,c);return f}}Object(e.a)(UE,"AssistanceDisplayManager",null,[1251,106]);
class $v{constructor(a,b,c,f,l){this.fG=a;this.USh=b;this.Evc=c;this.BJh=f;this.URh=l}get lcid(){return this.fG}get namespace(){return this.USh}get dHa(){return this.Evc}get mbi(){return this.BJh}get locale(){return this.URh}static Gij(a){const b=a.indexOf(".");return 0<=b&&b<a.length&&(a=parseInt(a.substring(0,b)),!isNaN(a))?a:$v.jci}static createInstance(a){return new $v(u.AFrameworkApplication.lcid,a,$v.Gij(u.AFrameworkApplication.buildVersion),"WDWAENDUSER,XLWAENDUSER,PPWAENDUSER,ONWAENDUSER",
sa.a.oe(u.AFrameworkApplication.lcid).name)}}$v.jci=16;Object(e.a)($v,"AssistanceSearchUrlParameterSet",null,[]);class VE{constructor(a,b){a=new hj.QueryStringBuilder(a);a.Ti("clid",b.lcid.toString());a.Ti("p1",b.namespace);a.Ti("ver",b.dHa.toString());a.Ti("apps",b.mbi);a.Ti("lc",b.locale);this._url=a.toString()}FPc(a){const b=new hj.QueryStringBuilder(this._url);b.Ti("src","TellMe");b.Ti("query",a.Gf);b.Ti("sessionid",a.sessionId);b.Ti("correlationid",a.correlationId);return b.toString()}static createInstance(a){return new VE(u.AFrameworkApplication.cJf,
a)}}Object(e.a)(VE,"AssistanceSearchUrlProvider",null,[1250]);class WE{Wb(){}init(){u.AFrameworkApplication.Tob&&!u.AFrameworkApplication.iJb&&jr.instance.ub(u.AFrameworkApplication.Ta)}dispose(){jr.instance.dispose()}yog(a){jr.instance.initialize(UE.createInstance(a,u.AFrameworkApplication.fa),VE.createInstance($v.createInstance("PPWAEndUser")))}}Object(e.a)(WE,"AssistancePackage",null,[2,3]);var jR=d(990);class GO{constructor(a,b,c,f,l,x){this.ia=a;this.Zd=b;this.P1j=c;this.O1j=f;this.Rke=l;this.u$a=
x}Tl(a,b){if(b&&this.ia){a={};let c;switch(b.actionId){case F.a.OPd:a.query="contactsupport";c=ResourceStrings.L_ContactSupport;break;case F.a.giveFeedback:a.feedback=this.Vui(b);a.query="givefeedback";c=ResourceStrings.L_GiveFeedback;break;case F.a.mzh:a.query="showtraining";c=ResourceStrings.L_Training;break;case F.a.nGh:a.query="whatsnew";c=ResourceStrings.L_WhatsNew;break;default:a.query=b.Gf,c=ResourceStrings.L_Help}const f={};f.CU=c;f.assetId="FA000000012";this.u$a.cbe&&b.actionId===F.a.giveFeedback&&
(f.sourceLocationOverrideResourceId="Help.GiveFeedback.Url");f.nonPersistedSettings=a;b.actionId==F.a.OPd&&(f.sourceLocationOverrideResourceId="Help.ContactSupport.Url");this.ia.La(ba.a.nJa,2,f)}}Ns(){const a=this.Tdg();a&&this.ia&&this.ia.La(ba.a.ZEc,2,a)}dispose(){}Tdg(){if(this.Zd.instance){const a=this.Zd.instance.DZ("FA000000012");if(a)return a.instanceId}return null}Vui(a){this.u$a.cbe||(this.Rke?this.Rke.pPb?this.iOf():this.O1j.zUd(Object(C.a)(this,this.fSi,"feedbackDownloaded")):Aa.a.J(512324302,
1302,15,"feedbackFormManager is undefined"));a=a.kd?a.kd:{};u.AFrameworkApplication.fa.wDf(a);a=this.P1j.getContext(a);let b={};"telemetryGroup"in a&&(b=a.telemetryGroup);b.processSessionId=a.sessionId;b.officeBuild=a.build;a.telemetryGroup=b;if(void 0===a.feedbackType||null===a.feedbackType)a.feedbackType=-1;"disableIncludeScreenshot"in a||(a.disableIncludeScreenshot=!1);"screenshot"in a||(a.screenshot=!0);a.disableScreenshotPreview=!1;a.includeScreenshotSelectedDefault=!0;return a}iOf(){if(jR.a.dYg())Aa.a.J(512324300,
1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(Object(C.a)(this,this.z7g,"postScreenshotData"));return}catch(a){Aa.a.J(512324299,1302,15,"Failed to use createScreenshot. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(Object(C.a)(this,this.z7g,"postScreenshotData"))}catch(a){Aa.a.J(512324298,1302,15,"Failed to use html2canvas. "+(a?"Message: "+a.message+" Stack: "+a.stack:null))}}}fSi(a){a&&
(this.Rke.$Ag(a),this.iOf())}z7g(a){a=a.toDataURL("image/jpeg");const b=this.Tdg(),c={};c.screenshot=a;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(b,"onScreenshot",c,null)}}Object(e.a)(GO,"AgaveAssistancePane",null,[1212,106]);class HO extends WE{constructor(){super();this.BYe=this.q4e=this.B0e=this.C0e=this.Da=null;this.Load=this.load}get name(){return"PowerPointEditor.Assistance"}Wb(a){this.Da=a}load(){this.init()}init(){super.init();!u.AFrameworkApplication.Tob&&u.AFrameworkApplication.iJb?
Aa.a.J(512258326,1302,50,"Not initializing the PowerPoint Assistance package because the feature is disabled."):(Aa.a.J(512258325,1302,50,"Initializing the PowerPoint Assistance package (the feature is enabled)."),u.AFrameworkApplication.fa.ka("HelpTabIsEnabled")?(this.C0e=this.Da.resolve("Common.App.ICustomerFeedbackUiWrapper"),this.B0e=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager"),this.q4e=this.Da.resolve("Common.App.CustomerFeedback.ICustomerFeedbackFormManager"),
this.BYe=this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.yog(()=>new GO(this.Da.resolve("Common.IActionManagerExtended"),this.Da.Ka("PowerPointWebEditor.IAppForOfficeManager"),this.C0e,this.B0e,this.q4e,this.BYe))):this.yog(null))}}Object(e.a)(HO,"PowerPointAssistancePackage",WE,[1143]);class XE{wUi(a,b,c){return a?this.xTi(b,c):this.xUi(b,c)}s5f(a,b,c){return a?this.$Ti(b,c):this.STi(b,c)}QTi(a){var b=a.rf?a.hg.Ve:a.hg.Ua;const c=new nb.GraphIterator;a.gq?c.Pc(a.gq):c.set(b.node);
c.pc(14);a=new nb.GraphIterator;a.Pc(c);a.pc(14);b=Se.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!Se.isLastCellInRow(a)){do if((f=Qd.moveToNextColumn(a))&&Se.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Se.isLastCellInRow(a))}if(!l&&!Se.isLastCellInColumn(c)){do if((f=Qd.moveToNextRow(c))&&Se.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Se.isLastCellInColumn(c))}return l?f:null}YTi(a){var b=a.rf?a.hg.Ve:a.hg.Ua;const c=new nb.GraphIterator;a.gq?c.Pc(a.gq):
c.set(b.node);c.pc(14);a=new nb.GraphIterator;a.Pc(c);a.pc(14);b=Se.findControllingCellFromNode(c.currentNode);let f=null,l=!1;if(!Se.isFirstCellInRow(a)){do if((f=Qd.moveToPreviousColumn(a))&&Se.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Se.isFirstCellInRow(a))}if(!l&&!Se.isFirstCellInColumn(c)){do if((f=Qd.moveToPreviousRow(c))&&Se.findControllingCellFromNode(f)!==b){l=!0;break}while(f&&!Se.isFirstCellInColumn(c))}return l?f:null}SKc(a,b){var c=a.rf?a.hg.Ve:a.hg.Ua;const f=new nb.GraphIterator;
a.gq?f.Pc(a.gq):f.set(c.node);f.pc(14);a=Se.findControllingCellFromNode(c.node);c=null;if(b){do{if(Se.isFirstCellInColumn(f))break;c=Qd.moveToPreviousRow(f)}while(c&&Se.findControllingCellFromNode(c)===a)}else{do{if(Se.isLastCellInColumn(f))break;c=Qd.moveToNextRow(f)}while(c&&Se.findControllingCellFromNode(c)===a)}return c}r5f(a,b){if(!gk.l(a))return null;a=nb.GraphIterator.mb(a.currentNode);a.pc(14);let c;const f=Jd.TableReader.vu(a.origin);do c=b?Qd.moveToPreviousRow(a):Qd.moveToNextRow(a);while(f&&
c&&gk.h(a));return c}tWa(a,b,c,f,l){let x=null;Xb.OutlineElementNavigator.Ke(a);const G=ae.OutlineElementReader.isRtl(a.currentNode);if(c)if(Qd.returnToCell(a),b=Se.isLastCellInRow(a),c=Se.isFirstCellInRow(a),l||!G&&c||G&&f&&b)Qd.returnToContainingRow(a),(f=this.r5f(a,!0))?x=rd.SelectionFactory.rj(f,!b):l&&(Xb.OutlineElementNavigator.Ke(a),l=new tn.a,l.Pc(a),(a=Xb.OutlineElementNavigator.Ava(l,!1,!1))&&(x=rd.SelectionFactory.rj(a,!1)));else{do G?Qd.moveToNextColumn(a):Qd.moveToPreviousColumn(a);while(Se.isGhostCell(a)&&
!Se.isFirstCellInColumn(a));Se.isGhostCell(a)||(x=rd.SelectionFactory.rj(a.currentNode,!G))}else ae.OutlineElementReader.eC(a,b,G)||cb.SelectionEditor.Pg(b)||Qd.returnToCell(a),x=rd.SelectionFactory.rj(a.currentNode,!G);return x}sWa(a,b,c,f,l){let x=null;Xb.OutlineElementNavigator.Ke(a);const G=ae.OutlineElementReader.isRtl(a.currentNode);if(c)if(Qd.returnToCell(a),c=Se.isLastCellInRow(a),b=Se.isFirstCellInRow(a),l||!G&&f&&c||G&&!f&&b)Qd.returnToContainingRow(a),(f=this.r5f(a,!1))?x=rd.SelectionFactory.rj(f,
b):(Xb.OutlineElementNavigator.Ke(a),f=new tn.a,f.Pc(a),(a=Xb.OutlineElementNavigator.eJ(f,!1,!1))&&(x=rd.SelectionFactory.rj(a,!0)));else{do G?Qd.moveToPreviousColumn(a):Qd.moveToNextColumn(a);while(Se.isGhostCell(a)&&!Se.isLastCellInRow(a));Se.isGhostCell(a)||(x=rd.SelectionFactory.rj(a.currentNode,G))}else ae.OutlineElementReader.eC(a,b,!G)||cb.SelectionEditor.Pg(b)||Qd.returnToCell(a),x=rd.SelectionFactory.rj(a.currentNode,G);return x}}Object(e.a)(XE,"ATableCellSelectionStrategy",null,[1104]);
class YE extends XE{constructor(){super()}STi(a,b){var c=a.kb;let f=null;if(a.vl){let l=null;if(b){if(c.gq=a.ria,a=Object(ua.a)(Vl.TableCellNode,this.QTi(c)))a.isGhostCell&&(l=a,a=a.Gy()),f=c.rG.isValid&&c.rG.node&&a===c.rG.node?rd.SelectionFactory.rj(c.rG.node,!c.rf):rd.SelectionFactory.nu(Zq.TableNodeContext.create(Object(ua.a)(lg.a,a)),c.rf)}else if(c=a.ga(Math.max(0,Math.min(a.gia,a.Kxa))),c=Object(ua.a)(Vl.TableCellNode,c.hg.Ve.node),c.isControllingCell&&(c=c.P0d(2)),a=c.HZ(),b=c.PMc().lHa,!a&&
b&&(c=b.S5f),a=c)a.isGhostCell&&(l=a,a=a.Gy()),f=cb.SelectionEditor.Hl(rd.SelectionFactory.gl(Object(ua.a)(lg.a,a)),!0,!1);f&&l&&(f.gq=nb.GraphIterator.mb(l))}return f}$Ti(a,b){let c=a.kb,f=null;a.vl&&(b?(c.gq=a.ria,a=Object(ua.a)(Vl.TableCellNode,this.YTi(c)),b=null,a&&(a.isGhostCell&&(b=a,a=a.Gy()),(f=c.rG&&c.rG.isValid&&a===Object(ua.a)(127,c.rG.node)?rd.SelectionFactory.rj(c.rG.node,!c.rf):rd.SelectionFactory.nu(Zq.TableNodeContext.create(Object(ua.a)(lg.a,a)),c.rf))&&b&&(f.gq=nb.GraphIterator.mb(Object(ua.a)(lg.a,
b))))):(a.gia>a.Kxa?(c=a.y5,c.gq=c.rf?a.hZa:null):c.gq=c.rf?null:a.ria,f=cb.SelectionEditor.Hl(rd.SelectionFactory.gl(c.hg.Ua.node),!0,!1),f.gq=c.gq));return f}xUi(a,b){let c=a.kb;var f=null;if(a.vl){const l=a.gia>a.Kxa;let x=null;if(b){if(c.gq=a.ria,a=Object(ua.a)(Vl.TableCellNode,this.SKc(c,!0)))a.isGhostCell&&(x=a,a=a.Gy()),f=l&&c.rG&&c.rG.isValid&&a===c.rG.node?rd.SelectionFactory.rj(c.rG.node,!c.rf):rd.SelectionFactory.nu(Zq.TableNodeContext.create(Object(ua.a)(lg.a,a)),c.rf)}else l?(c=a.y5,
c.rf&&(c=c.ssb(),c.gq=a.hZa)):c.rf?c=c.ssb():c.gq=a.ria,f=Object(ua.a)(Vl.TableCellNode,this.SKc(c,!0)),f?f.isGhostCell&&(x=f,f=f.Gy()):(f=Object(ua.a)(Vl.TableCellNode,c.hg.Ua.node),x=c.gq?Object(ua.a)(Vl.TableCellNode,c.gq.currentNode):null),f=rd.SelectionFactory.rj(Object(ua.a)(lg.a,f),!0);f&&x&&(f.gq=nb.GraphIterator.mb(Object(ua.a)(lg.a,x)))}return f}xTi(a,b){let c=a.kb;var f=null;if(a.vl){const l=a.gia<a.Kxa;let x=null;if(b){if(c.gq=a.ria,a=Object(ua.a)(Vl.TableCellNode,this.SKc(c,!1)))a.isGhostCell&&
(x=a,a=a.Gy()),f=l&&c.rG&&c.rG.isValid&&a===Object(ua.a)(127,c.rG.node)?rd.SelectionFactory.rj(c.rG.node,!c.rf):rd.SelectionFactory.nu(Zq.TableNodeContext.create(Object(ua.a)(lg.a,a)),c.rf)}else l?(c=a.y5,c.rf&&(c=c.ssb(),c.gq=a.hZa)):c.rf?c=c.ssb():c.gq=a.ria,f=Object(ua.a)(Vl.TableCellNode,this.SKc(c,!1)),f?f&&f.isGhostCell&&(x=f,f=f.Gy()):(f=Object(ua.a)(Vl.TableCellNode,c.hg.Ua.node),x=c.gq?Object(ua.a)(Vl.TableCellNode,c.gq.currentNode):null),f=rd.SelectionFactory.rj(Object(ua.a)(lg.a,f),!0);
f&&x&&(f.gq=nb.GraphIterator.mb(Object(ua.a)(lg.a,x)))}return f}}Object(e.a)(YE,"TableCellSelectionStrategy",XE,[]);class IO extends dz{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic){super(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc);this.AWh=l;this.GPh=c;this.orc=Ic}mXb(a,b){var c=Object(ua.a)(cp,b);c&&c.mXa&&this.jni(this.GPh.fSe)&&(c=c.mXa.sa(Sl.a.Sb,""),this.orc.jdc(c),this.orc.oB(6,c));return super.mXb(a,b)}jni(a){const b=new mC;for(b.enqueue(a);0<b.count;){a=b.dequeue();if(14===a.type)return!0;
a=nb.GraphIterator.mb(a);let c=a.Ji();for(;c;)b.enqueue(c),c=a.yp()}return!1}KHc(a,b){var c=Object(ua.a)(cp,b);if(c&&c.mXa){c=c.mXa.sa(Sl.a.Sb,"");const f=Object(ua.a)(5,this.AWh.Oa.kb.Ve.node);f&&(f.Sb=c)}return super.KHc(a,b)}}Object(e.a)(IO,"PPTClipboardOperationCutCopy",dz,[]);class JO{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic){this.Ca=a;this.hd=b;this.Sr=c;this.WY=x;this.Qc=l;this.Ai=f;this.ir=G;this.ef=R;this.Lga=fa;this.YJ=wa;this.Mga=Wa;this.Dmb=mb;this.p2a=Kb;this.eb=nc;this.Xj=
oc;this.orc=Ic}create(){return new IO(this.Ca,this.hd,this.Sr,this.Ai,this.Qc,this.WY,this.ir,this.ef,this.Lga,this.YJ,this.Mga,this.Dmb,this.p2a,this.eb,this.Xj,this.orc)}}Object(e.a)(JO,"Factory",null,[379]);class KO{constructor(){}get Sad(){return!1}fpb(){}get BUg(){return!1}set BUg(a){}get cek(){return!1}jma(){}NWa(){}get OXg(){return-1}get ZHc(){return null}}Object(e.a)(KO,"NoImageSteward",null,[1103]);class ZE{constructor(a){this.E$b=a}create(a,b){return this.E$b||1!==a?new KO(b):null}}Object(e.a)(ZE,
"PPTImageStewardFactory",null,[1094]);class Gq extends Mr{constructor(a,b,c,f,l,x,G){super(a,b,c);this.ia=f;this.ax=l;this.wc=G;this.B5j=x.gwk;this.e$b=x.i$d;this.L4j=x.h$d;this.E$b=x.rwb;this.C5j=x.oNj}Dae(a,b,c){const f=Gq.z9f(c);a=(!H.a.instance.ga(82)||this.tMj(a,b,f))&&super.Dae(a,b,c);3===c.MOa?this.wc.vw(2,f):2===c.MOa&&this.wc.vw(3,f);a&&(this.wc.jdc(f),this.PCh(b,f));return a}VMe(a,b,c){const f=Gq.z9f(c);a.setAttribute(mu.a.pOf,f);let l=!1;const x=Gq.rMj(a);if(x)Aa.a.J(17310354,826,50,null),
l=!0;else if(this.C5j&&1===a.getElementsByTagName("Table").length&&!b.iterator.pc(60))this.wc.oB(6,f),l=!0;else{const G=Ca.b(a);G&&G.length||!Gq.M0b(a)||(Aa.a.J(17310356,826,50,null),l=!0)}l&&!Gq.Fjh&&(u.AFrameworkApplication.DN("Microsoft.Office.Server.Powerpoint.Web.IPasteContentFromPandoraSettings"),Gq.Fjh=!0);if(!this.B5j)return!0;l&&(this.E$b&&this.Vxg(c)?Aa.a.J(36779848,826,50,"Paste text only action."):(Aa.a.J(17310358,826,50,null),this.KPi(a.cloneNode(!0),x)));if(a=!l&&super.VMe(a,b,c))this.wc.jdc(f),
this.wc.oB(1,f),this.PCh(b,f);return a}KPi(a,b){b&&a.firstChild&&a.firstChild.className&&(a.className=a.firstChild.className,(this.e$b||this.L4j)&&this.ax.fqi(a.firstChild,a));Nc.a.z$(()=>{this.ia.La(ba.a.I5g,2,a)},100)}tMj(a,b,c){if(u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("ComplexTableCellPasteWithFormattingIsEnabled")){a=Gq.thj(a);if(1!==a.count)return!1;this.wc.oB(6,c);a=a.ga(0);return!u.AFrameworkApplication.fa.ka("ComplexTableCellPasteFromComplexTableIsEnabled")&&this.Lsj(a)?
!1:Gq.MMj(b)}c=Object(ua.a)(5,b.iterator.currentNode);let f=null;c&&(f=(c=c.HK())?c.getContainingTable():null);return!!u.AFrameworkApplication.fa&&u.AFrameworkApplication.fa.ka("PPTInternalPasteTableInTableIsEnabled")&&b.Qk&&b.node.Sa(sb.a.cellId)&&1===a.getElementsByTagName("Table").length&&!!f&&!f.Ap()}Lsj(a){a=a.getElementsByTagName("Table");if(1===a.length){a=a[0].getElementsByTagName("td");for(let c=0;c<a.length;c++){var b=a[c];if(!b)continue;const f=b.attributes.getNamedItem("rowspan");if(!f||
!f.specified||"1"!==f.value)return!0;b=b.attributes.getNamedItem("colspan");if(!b||!b.specified||"1"!==b.value)return!0}}return!1}PCh(a,b){if(Object(ua.a)(5,a.node)&&a.iterator)if(a.iterator.pc(10)){if(a=Object(ua.a)(4,a.iterator.Dw(10)))a.Sb=b}else a.iterator.pc(60)&&(a=Object(ua.a)(1002,a.iterator.Dw(60)))&&(a.Sb=b)}static thj(a){a=a.getElementsByTagName("Table");if(1===a.length){var b;return b=new Ha.a,b.add(a[0]),b}b=new Ha.a;if(2===a.length){for(let c=0;c<a.length;c++){if(0<a[c].getElementsByTagName("Table").length){if(0<=
a[c].className.indexOf("Selected_Table"))continue;b.clear();break}b.add(a[c])}1<b.count&&b.clear()}return b}static MMj(a){return a.Qk&&a.node.Sa(sb.a.cellId)&&a.iterator.pc(14)?!0:!1}static M0b(a){a=a.getElementsByTagName($e.a.R7);if(!a.length)return null;a=a[0];return a.src?a:null}static rMj(a){return!!a.firstChild&&!!a.firstChild.className&&bR.a.ctg(a.firstChild.className)}static z9f(a){let b="";a&&a.mXa&&(b=a.mXa.sa(Sl.a.Sb,""));return b}}Gq.Fjh=!1;Object(e.a)(Gq,"PPTPasteCoordinator",Mr,[]);class LO{constructor(){}fpb(){}get Eba(){return!1}FX(){}CX(){}EX(){}DX(){}BX(){}AX(){}}
Object(e.a)(LO,"TextOnlyTableSteward",null,[444,445]);class $E{constructor(a){this.E$b=a}create(a,b){return this.E$b||1!==a?new LO(b):null}}Object(e.a)($E,"PPTTableStewardFactory",null,[421]);class aF{constructor(a,b,c){this.y3j=a;this.z6j=b;this.la=c}oFe(){this.y3j.execute(a=>{this.la.pbe&&a.yFe(this.z6j.value)})}}Object(e.a)(aF,"AccessibilityActor",null,[]);class uu{get key(){return"LIST"}get d7(){return Box4Intl.Box4Strings.l_ListContentTitle}ITe(a){let b;b=null;const c=uu.Tf.Pw(a);if(!c)return{returnValue:!1,
Aqb:b};a=this.C8i(a,c);b=Object.assign(new $y,{j0:this.key,contentId:a.listId,yP:a});return{returnValue:!0,Aqb:b}}TMc(a,b){a=a.yP;const c=this.H7i(a.$S),f=new Si.a;b?(b=b.yP,b.level!==a.level?(f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c)):b.id.equals(a.id)&&b.$S.listType===a.$S.listType||f.add(c)):(f.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),f.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,a.level)),f.add(c));
return f.toArray().join(" ")}H7i(a){let b="";const c=a.listStyle;if(0===a.listType)b=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,a.wW);else if(1===a.listType)switch(c){case 1:b=this.zLf;break;case 2:b=this.Ghi;break;case 3:b=this.Hhi;break;default:b=this.zLf}return b}static get Tf(){return uu.Sg||(uu.Sg=fb.a.instance.resolve("Box4.List.IListReader"))}}uu.Sg=null;Object(e.a)(uu,"ListDetailsProvider",null,[512,513]);class MO{constructor(){this.$S=this.listId=this.id=null;this.level=
0}}Object(e.a)(MO,"ListItemInfo",null,[]);class bF extends uu{constructor(a){super();this.ZG=a}get zLf(){return ResourceStrings.l_BulletStyle1}get Ghi(){return ResourceStrings.l_BulletStyle1}get Hhi(){return ResourceStrings.l_BulletStyle1}C8i(a,b){const c=this.ZG.gca(a),f=this.ZG.A8i(a);return Object.assign(new MO,{id:a.currentNode.id,listId:new Ga.a(zh.a.nil,f),$S:b,level:c+1})}}Object(e.a)(bF,"ListDetailsProvider",uu,[]);class NO{constructor(){this.JI=this.K=null}dispose(){}Wb(a){this.K=a;this.JI=
this.K.resolve("Common.AFrameworkApplication");a.register(ZE,"PowerPointWebEditor.PPTImageStewardFactory").as("Box4.Actors.IBox4ImageStewardFactory").ma().na(()=>new ZE(a.resolve("PowerPointWebEditor.IApplicationSettings").rwb));a.register($E,"PowerPointWebEditor.PPTTableStewardFactory").as("Box4.Actors.IBox4TableStewardFactory").ma().na(()=>new $E(a.resolve("PowerPointWebEditor.IApplicationSettings").rwb));a.register(Mr,"Box4.Actors.PasteCoordinator").ma().na(()=>new Gq(a.resolve("Box4.Actors.InternalClipboard"),
a.resolve("Box4.Actors.IInternalPasteExecutionManagerFactory"),a.resolve("Box4.Actors.IExternalPasteExecutionManagerFactory"),a.resolve("Common.IActionManagerExtended"),a.resolve("PowerPointWebEditor.IClipboardHelper"),a.resolve("PowerPointWebEditor.IApplicationSettings"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(379,"Box4.Actors.IClipboardOperationCutCopyFactory").ma().na(()=>new JO(u.AFrameworkApplication.Ta,rb.a.instance,a.resolve("Box4.Actors.InternalClipboard"),a.resolve("Box4.IOutlineElementEditor"),
qd.a.instance,a.resolve("Box4.Actors.ISystemClipboard"),a.resolve("Box4.IParagraphReader"),Qh.a.instance,a.resolve("Box4.IOutlineElementNavigator"),a.resolve("Box4.Graph.IGraphIteratorFactory"),a.resolve("Box4.IOutlineElementReader"),a.resolve("Box4.IRenderOrderGraphIteratorFactory"),a.resolve("Box4.ISelectionFactory"),a.resolve("Common.IAppSettingsManager"),a.resolve("Box4.IClipboardDataHelper"),a.resolve("PowerPointWebEditor.IClipboardTelemetry")));a.register(bF,"PowerPointWebEditor.ListDetailsProvider").na(()=>
new bF(a.resolve("PowerPointWebEditor.IPptListCore")));a.register(aF,"PowerPointWebEditor.AccessibilityActor").ma().na(()=>new aF(a.Ka("Box4.Accessibility.IAccessibilityContextManager"),a.le("PowerPointWebEditor.ListDetailsProvider"),this.JI.bS.ld));a.register(YE,"PowerPointWebEditor.TableCellSelectionStrategy").as("Box4.ITableCellSelectionStrategy").ma().na(()=>new YE)}init(){const a=Cb.App.nD.jS;Ox.Czj(this.JI.kr,this.K.resolve("Common.IReactContextualUILauncher"),a,this.K.resolve("Common.IExternalUICommandDefinitionMapping"));
this.K.resolve("PowerPointWebEditor.AccessibilityActor").oFe()}get name(){return"PowerPointWebEditor.Box4DelayedLoadedPackage"}}Object(e.a)(NO,"Box4DelayedLoadedPackage",null,[2,3]);class OO{constructor(a,b,c,f,l,x,G,R){this.R$a=this.Mta=null;this.$Xc=0;this.WXc=new ef.a(0);this.iab=this.uie=this.f9b=null;this.XXc=!1;this.HHg=[ma.a.contextMenu,ma.a.$xa,ma.a.iM,ma.a.mouseDown,ma.a.pointerDown,ma.a.iOa,ma.a.Cdb,ma.a.paste];this.PSg=[ma.a.Xf,ma.a.wl,ma.a.Qx,ma.a.click,ma.a.doubleClick,ma.a.XQ,ma.a.cMd,
ma.a.dJ,ma.a.F7c];this.FI=a;this.yfe=c||[];this.m0j=f||[];this.u1j=l||[];this.hRg=x;this.Mc=b;this.Mc.P4h(Object(C.a)(this,this.QYg,"onAppClosing"));this.Mc.IB(Object(C.a)(this,this.gB,"onSessionEnd"));this.y8j=G;R&&(zd.EventHandlerManager.instance.tFe(this.HHg,Object(C.a)(this,this.akk,"onBeforeEventActionContextCreated")),zd.EventHandlerManager.instance.Cdh(this.HHg,Object(C.a)(this,this.ojk,"onAfterEventActionContextCreated")),zd.EventHandlerManager.instance.tFe(this.PSg,Object(C.a)(this,this.bkk,
"onBeforeEventTriggered")),zd.EventHandlerManager.instance.Cdh(this.PSg,Object(C.a)(this,this.pjk,"onAfterEventTriggered")));this.Tme=!1}a$(a){if(2===a.behavior){var b=a.actionId;if(this.tna(b)){var c=this.getCommandName(b);Aa.a.J(18956760,817,50,"ActionContextListener::OnBeforeAction "+this.Wmg(a,c,"",!1)+"; Current Event: "+(this.iab||"")+"; Current ActionContext: "+(Nc.a.Eb?Nc.a.Eb.toString():""));if(!this.$Xc)if(this.XXc=!0,this.K$k(a)){this.Mta=Nc.a.cnd(c);this.Tme=!0;a=a.telemetryData;c=this.f9b;
let f=this.uie;null===c&&a&&a[si.a.YBa]&&(c=a[si.a.YBa],f=Nc.a.Nib(c));null!==f&&(this.Mta.Wa(si.a.l3a,f.toFixed(2)),null!==c&&this.Mta.Wa(si.a.YBa,c.toFixed(2)));a&&ta.a.forEach(a,(l,x)=>{this.Mta.dya(l,(null===x||void 0===x?void 0:x.toString())||"")},null);c=!1;Array.contains(am.v0k,b)?c=!0:this.Mta.Kr=!0;c=c||this.Oj(b,a);this.Mta.Oj=c}else this.Mta=Nc.a.Eb}this.$Xc++}}Z9(a){if(2===a.behavior){var b=a.actionId;if(this.tna(b)){var c=Nc.a.Eb;const f=c?c.DJ(si.a.pCf).toString():"";Aa.a.J(18956762,
817,50,"ActionContextListener::OnAfterAction "+this.Wmg(a,this.getCommandName(b),f,!0)+";Result:"+a.response.toString()+";Current Event:"+(this.iab||"")+";Current ActionContext:"+(c?c.toString():"")+";RevisionId: "+(c?c.DJ(si.a.UX).toString():""))}this.dcl(b)&&(c=this.WXc.oOc(b,0),this.WXc.add(b,c+1));this.$Xc--;0<this.$Xc||!Nc.a.Eb||!this.Mta||(Nc.a.qk(si.a.j0h,a.response.toString()),Nc.a.Eb!==this.Mta||this.R$a||this.KYg(),this.Mta=null)}}KYg(){const a=Nc.a.Eb;if(a){var b=new Date;a.Oj&&!a.hIb&&
null===a.WE&&(a.WE=b);a.dya(si.a.d0h,(+b-+a.iD).toString());a.Kr?0<a.DJ(si.a.UX).length&&Nc.a.Lea(a):Nc.a.Kmd();this.Tme&&(Nc.a.Eb=null,this.Tme=!1)}}tna(a){if(!this.hRg)return!1;if(Array.contains(this.yfe,a))return!0;a=u.AFrameworkApplication.Ta.xS(a);return!!a&&!(a.flags[32]||a.flags[64])}Oj(a,b){return Array.contains(this.m0j,a)?b&&si.a.EAc in b?b[si.a.EAc]:!0:!1}dcl(a){return this.hRg&&Array.contains(this.u1j,a)}K$k(a){return this.y8j?!Nc.a.Eb:!Nc.a.Eb&&a.Xi}Wmg(a,b,c,f){if(null===a)return"null";
b="ActionName="+b+", IsTableShapeSelected="+c+", ActionId="+a.actionId+", BeginMode="+a.XCc+", InvocationMethod="+a.LS+", CommandLocation="+a.oq+", CommandTabName="+a.Eqa;return f?"Response="+a.response+", "+b:b}getCommandName(a){const b=this.FI?this.FI.c5(a):null;return b?b:a.toString()}QYg(){if(!(1>this.WXc.count)){var a={};this.WXc.forEach((b,c)=>{b=this.getCommandName(b);a[b]=c;return!0});Aa.a.J(512491875,817,15,"ActionContextListener::OnAppClosed {0}",Yd.c(a));this.Mc.VQk(Object(C.a)(this,this.QYg,
"onAppClosing"))}}gB(){Nc.a.Boi()}akk(a){this.iab=a.type;this.R$a=Nc.a.cnd(this.iab);this.R$a.Oj=!0;this.XXc=!1;a=Nc.a.Nmd(a);null!==a&&Nc.a.lrl(a)&&this.R$a.Wa(si.a.YBa,a.toFixed(2))}ojk(){this.R$a&&Nc.a.Eb===this.R$a&&this.XXc&&this.KYg();Nc.a.Eb=null;this.XXc=!1;this.R$a=this.iab=null}bkk(a){this.iab=a.type;this.f9b=Nc.a.Nmd(a);null!==this.f9b&&(this.uie=Nc.a.Nib(this.f9b))}pjk(){this.iab=this.uie=this.f9b=null}}Object(e.a)(OO,"ActionContextListener",null,[147]);var kR=d(365),lR=d(425);class cF{constructor(){this.K=
null;this.dHg=[];this.Hk=null;this.Eua="";this.hX=[new NO,new DO];this.a9=!!window.performance&&!!window.performance.now}get name(){return"PowerPointWebEditor.EditingPackage"}Wb(a){this.Eua=String.format("EditingPackage ConfigureStart:{0}",(new Date).getTime());tg.a.instance.hc("EditingPackageConfigureStart",Date.now());this.K=a;this.ub();for(const b of this.hX)b.Wb(a);this.K.resolve("PowerPointWebEditor.IApplicationSettings").cwg&&this.K.register(260,"PowerPointWebEditor.ISlideMasterPrefetchManager").ma().na(()=>
new EO(this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.Image.IImageManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Box4.Graph.IGraphInstance").vd(7),this.K.resolve("Box4.Graph.IGraphInstance").vd(8),
this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler")));this.K.register(SE,"PowerPointWebEditor.UpdateCommandUIActionListener").ma().na(()=>new SE(this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers")))}onj(a,b,c){return 1===c?32:2===c?(this.Xzj(),Aa.a.J(512497352,822,50,"Draw tab was clicked."),this.K.resolve("Common.IActionManagerExtended").processAction(ba.a.Sog,2),32):8}tzj(){const a=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");
a.Fq();this.K.resolve("Box4.IGeneralCuiUser");a.updateCommandUI()}Log(a){const b=this.K.resolve("PowerPointWebEditor.ShapeSVG.IShapeSVGDependencyLoader");b.RVf=!0;b.pwh=a;b.KCg()}HVj(a,b){Aa.a.J(512497351,835,50,"Init GC2 started");const c=new Date,f=this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.IGraphicalContentComponentsDependencyLoader");f.jWj().continueWith(l=>{var x=new Date;Aa.a.J(512497350,813,50,"gc2 dependency loader loadJS starts: {0}, ends: {1}, durationMS: {2}",Nc.a.$e(c),
Nc.a.$e(x),+x-+c);if(6===l.status){l=IJ.a({});const G=(x=bD())&&l&&(b||a);Aa.a.J(512497349,835,50,"{0}",{["message"]:"InitializeGraphicalContentComponents",["gc2ShapeBuilderImageRenderingEnabled"]:a,["gc2PreloadShadersEnabled"]:b,["isBrowserShapeBuilderCompatible"]:l,["browserSupportsWebGL"]:x,["shouldUseShapeBuilder"]:G});l=G?document.createElement("canvas"):null;f.Qzj(l,this.K.resolve("Gc2.IGlyphStore"))}}).continueWith(l=>{6!==l.status&&Aa.a.J(512497348,835,10,"Exception: {0}",l.Wi)})}$Aj(){this.K.resolve("PowerPointWebEditor.Video.IVideoDependencyLoader").NCg()}Xzj(){this.K.resolve("PowerPointWebEditor.Ink.IInkDependencyLoader").Bxb().continueWith(()=>
{this.K.resolve("PowerPointWebEditor.WetInkView")})}ub(){this.K.resolve("Common.IActionManagerExtended").ya(ba.a.Vgh,xd.a.frame,Object(C.a)(this,this.onj,"handleDrawTabClicked"))}init(){const a=!this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").presentation;this.Eua=String.format("{0}, InitStart:{1}, OpenEarlyNotBack:{2}",this.Eua,(new Date).getTime(),a);tg.a.instance.hc("EditingPackageInitStart",Date.now());a?(this.Hk=this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.Hk.vFf(Object(C.a)(this,this.nog,"initEditingPackage"))):this.oog()}nog(){this.Hk.Efh(Object(C.a)(this,this.nog,"initEditingPackage"));this.oog()}oog(){const a=this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener");this.Eua=String.format("{0}, IsBootComplete:{1}, OnBootCompleteTime:{2}",this.Eua,a.vja,(new Date).getTime());a.FDa(()=>{this.fyj(a)});a.Ysg(()=>{this.Kui()})}fyj(a){this.Eua=String.format("{0}, InitStartInternal:{1}",this.Eua,(new Date).getTime());tg.a.instance.hc("EditingPackageInitStartInternal",
Date.now());var b=this.K.resolve("Common.AFrameworkApplication");const c=this.K.resolve("PowerPointWebEditor.IApplicationSettings"),f=new HO;f.Wb(this.K);f.load(b);for(const x of this.hX)x.init();c.pptSkipFidelityImageFetchDuringBootIfRemoveFidelityEnabled&&(fb.a.instance.resolve("PowerPointWebEditor.IImageViewManager").Ihb(),c.ESa&&b.kr.vmg());this.tzj();this.K.resolve("Common.IActionManagerExtended").Jma(new OO(this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),
am.YCg,am.aXj,c.Ari,c.BMj,c.podsEnableAyncActionContext,c.actionContextEnableEventCallbacks));if(c.vCb){let x=null;(b=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(b=Ni.e(b,this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ma))?x=b.rba:Aa.a.J(512497347,809,10,"slideViewElement is null."):Aa.a.J(512497346,809,15,"activeSlide is null. SlideCount: "+this.K.resolve("PowerPointWebEditor.IPresentationReader").Hj());this.K.register(261,"PowerPointWebEditor.ICommentShimmerView").ma().na(()=>
new FO(x,this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),u.AFrameworkApplication.isRtl,this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Common.ITaskManager"),c.Wri))}this.K.resolve("Common.IActionManagerExtended").Jma(this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener"));a.Jsa||(Gh.a.instance.JEe((new Date).getTime()),c.podsRibbonEarlyRendererExposureControl&&
c.vCb&&PowerPointWebEditor.Ribbon.EarlyRenderedRibbon.RegisterOrInvokeOnInitializeEarlyRenderedPptRibbon(()=>{PowerPointWebEditor.MinimalBoot.SetRealRibbon("OnContentEditable")}),kR.a.AKk(),this.K.resolve("PowerPointWebEditor.ISessionState").V4("AppInteractive"),this.a9&&tg.a.instance.hc("ContentEditablePerfMark",window.performance.now()),this.K.resolve("PowerPointWebEditor.IPPTRumTracker").iea("canvas","slide"),c.podTransmitMetricsBeaconOnBoot&&(Lz.App.RGb(null,Th.a.contentEditable),this.BXj()),
wd.a.get_instance().wJ(4),a.Jsa=!0);c.vCb&&((a=this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager").Ba)?(a=a.xD(),this.K.resolve("PowerPointWebEditor.Graph.ICommentReader").Skg(a)&&(this.K.resolve("PowerPointWebEditor.ICommentShimmerView").hfl(),Aa.a.J(512497345,809,50,"CommentLandingSlide: true"))):Aa.a.J(512497344,809,10,"activeSlide is null"));tg.a.instance.hc(lR.a.rWd,(new Date).getTime());c.Noc?this.K.resolve("PowerPointWebEditor.ScriptLoader.IUnifiedScriptLoader").Rba("pptedit.extcommon",
null,()=>d.e(6).then(d.bind(null,1213))):(a=Dx.a.create("pptedit.extcommon",null,()=>d.e(6).then(d.bind(null,1213))),ql.a.Kx(a));this.$Aj();(a=this.K.resolve("Common.Utils.IHighContrastDetector"))&&a.isInHighContrastMode&&Aa.a.J(512497315,809,50,"HighContrastMode enabled");!c.X9d||a&&a.isInHighContrastMode?c.r8d&&c.X9d&&this.Log(!1):this.Log(!0);c.eQc&&(this.dHg.push(this.K.resolve("PowerPointWebEditor.GraphicalContentComponents.Gc2WebSocketFrontDoorResponseHandler")),this.HVj(c.SLc,c.RXi));u.AFrameworkApplication.Ku||
(u.AFrameworkApplication.Ku=Aa.a.DXb());c.cwg&&this.K.resolve("PowerPointWebEditor.ISlideMasterPrefetchManager");const l=this.K.qb("Common.IFrameTimingMeter");l&&(Aa.a.J(512497314,809,50,"Frame timing meter start:{0}",window.performance.now()),l.start(this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterReportingIntervalInSeconds),this.K.resolve("Common.ITaskManager").Cb(new xe.a(3,1,this.K.resolve("PowerPointWebEditor.IApplicationSettings").podsFrameTimingMeterRunningTimeInMiliseconds,
()=>{l.stop()},90,"93")));this.Eua=String.format("{0}, InitDone:{1}",this.Eua,(new Date).getTime());tg.a.instance.hc("EditingPackageInitDone",Date.now());Aa.a.J(512497313,809,50,this.Eua)}Kui(){const a=this.K.resolve("PowerPointWebEditor.IApplicationSettings");Aa.a.J(39370892,809,50,"Connect RTC by default: BrowserToServerRtc:{0}",a.podsTriggerServerRtcConnectionFromBrowserIsEnabled);const b=Date.now(),c=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter");c.MDh("{"+u.AFrameworkApplication.userSessionId+
"}");const f=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").C4i();f&&(c.Soc(0<f.length?2:1),c.fDh(f),this.K.resolve("PowerpointPresence.IPresencePerfLogger").bYj(Date.now(),f.length));this.K.resolve("PowerPointWebEditor.PresenceLoader").P1f();this.K.resolve("PowerPointWebEditor.CoauthNotificationManager");this.K.resolve("PowerPointWebEditor.ICoauthSubscriptionManager").Pog();Aa.a.J(512497312,828,50,"PresenceCallback took {0}ms",Date.now()-b);a.podsTriggerServerRtcConnectionFromBrowserIsEnabled&&
u.AFrameworkApplication.fa.ff(Object(C.a)(this.K.resolve("PowerPointWebEditor.CoauthNotificationManager"),this.K.resolve("PowerPointWebEditor.CoauthNotificationManager").bvh,"startServerRtcConnection"))}BXj(){if(tg.a.instance.c8a)Aa.a.J(512497311,813,15,"LogBootMetrics: Cannot import metrics from PageLoadPerfRecorder since it has been logged and disposed.");else{var a={};for(var b of[Th.a.mCa,Th.a.v7f,Th.a.x7f,Th.a.GLc,Th.a.w7f,Th.a.Bob,Th.a.iCc,Th.a.Iba,Th.a.zP,Th.a.contentEditable,Th.a.qpc,"UserClickTime",
"DocPageNavigationStart","DocPageFetchStart","DocPageResponseStart","DocPageResponseEnd","BootJsStartTime","BootJsEndTime",Th.a.tfd,"BootSegments","BootOperations","EditingPackageInitStartInternal","FirstExtJsExecTime","PageViewValidationStart","PageViewValidationDuration","AllViewsValidationDuration","ViewValidationYieldTime","ViewValidationYieldCount","ThumbnailNavigationPaneViewValidationStart","ThumbnailNavigationPaneViewValidationDuration","TMYielded","MicrosoftAjaxLoadStartTime","HermesIntlLoadStartTime",
"EditCoreJsExecStartTime","EditCoreJsLoadStartTime","EditCoreJsLoadEndTime","EditingPackageConfigureStart","EditingPackageInitStart","EditExtSliceTaskRegTime",Th.a.D_b,Th.a.E_b,"MBootFirstImgReqStart","MBootFirstImgReqEnd","MBootFirstImgDrawEnd","MBootRetryCount","MBootCacheHit","NPLT","SplashScreenShown","LogoScreenHideTime","SplashScreenHideSource","SplashScreenTextShownTime","OpenEarlyRequestServerReceived","OpenEarlyRequestServerEnd","OpenEarlyImagesRequestStartTime","OpenEarlyImagesRequestEndTime",
"OpenEarlyImagesRequestImagesCount","OpenEarlyClientRequestSentTime","OpenEarlyClientResponseReceivedTime","TimeDiffToOpenEarly","OpenEarlyCacheDisposed","DocModelManagerLoadAsyncStart","DocModelManagerLoadDocModelEnd","DocModelManagerGetObjectsStart","DocModelManagerGetObjectsEnd","DocModelManagerOnDocModelChanged","DocModelManagerGetHeadersEnd","FluidNewContainerStart","FluidNewContainerAfterCreateDocModel","FluidNewContainerBeforeAttach","FluidNewContainerAfterAttach","FluidNewContainerEnd","ParseOpenEarlyServerResponseStart",
"ParseOpenEarlyServerResponseEnd","AppBootCompleted","FirstDrawStarted","EditingPackageRegisterTime","PackageConfigurerAndInitiatorStartTime","CalculateVisibleThumbRangeWaitTime","CalculateVisibleThumbRangeStartTime","DeepLinkSlideIndex","CalculateVisibleThumbRangeEndTime"])tg.a.instance.xo(b)&&(a[b]=tg.a.instance.$g(b));u.AFrameworkApplication.fa.Ga("PodSID")&&(a.PodSessionID=u.AFrameworkApplication.fa.Ga("PodSID"));(b=window.self.RealRibbonDisplayTime)&&(a.RealRibbonDisplayTime=b);(b=window.self.RealRibbonDisplaySource)&&
(a.RealRibbonDisplaySource=b);(b=window.self.ThumbnailShimmerHideTime)?a.ThumbnailShimmerHideTime=b:tg.a.instance.xo("ThumbnailShimmerHideTime")&&(a.ThumbnailShimmerHideTime=tg.a.instance.$g("ThumbnailShimmerHideTime"));Aa.a.J(39184516,809,50,"Perf metrics: "+ta.a.toJSON(a));b=this.K.resolve("PowerPointWebEditor.IApplicationSettings");b.WKj&&this.vZj(a,b)}}vZj(a,b){if(a[Th.a.zP])if(a[Th.a.contentEditable])if(a.UserClickTime||a.DocPageFetchStart){if(a[Th.a.contentEditable]-a[Th.a.zP]>b.ldi){var c=
new Map;c.set("ContentEditable",a[Th.a.contentEditable].toString());c.set("ContentViewable",a[Th.a.zP].toString());vf.Health.instance.recordQosError("InteractiveOpenSlowError",["InteractiveOpenSlow"],!1,!0,!1,!1,Object.assign(new mk.a,{extendedProperties:c}))}c=b.hPi;b=a.UserClickTime?a.UserClickTime:a.DocPageFetchStart;a[Th.a.zP]-b>c&&(c=new Map,c.set("TimingOrigin",b.toString()),c.set("ContentViewable",a[Th.a.zP].toString()),vf.Health.instance.recordQosError("PerceivedOpenSlowError",["PerceivedOpenSlow"],
!1,!0,!1,!1,Object.assign(new mk.a,{extendedProperties:c})))}else Aa.a.J(512497308,809,15,"Both UserClickTime and DocPageFetchStart are null");else Aa.a.J(512497309,809,15,"ContentEditable is null");else Aa.a.J(512497310,809,15,"ContentViewable is null")}dispose(){for(const a of this.hX)a.dispose();for(const a of this.dHg)a.dispose();this.K.resolve("PowerPointWebEditor.UpdateCommandUIActionListener").dispose()}static main(){const a=(new Date).getTime();Aa.a.J(38876352,809,50,"EditingPackage::Register time:{0}",
a);tg.a.instance.hc("EditingPackageRegisterTime",a);m.a.instance.Bc(new cF)}}Object(e.a)(cF,"EditingPackage",null,[2,3]);var mR=d(570);class dF{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc,oc,Ic){this.Ska=this.c9=!1;this.BL={};this.M3=this.NI=null;this.Wva=()=>{this.c9&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!f)throw Error.argumentNull("viewPanelContainer");if(!l)throw Error.argumentNull("selectionManager");
if(!x)throw Error.argumentNull("shapeReader");if(!G)throw Error.argumentNull("pageView");if(!R)throw Error.argumentNull("actionManager");if(!fa)throw Error.argumentNull("slideDimensionsHelper");if(!wa)throw Error.argumentNull("presentationReader");if(!Wa)throw Error.argumentNull("transactionFactory");if(!mb)throw Error.argumentNull("pptPageView");if(!Kb)throw Error.argumentNull("applicationSettings");if(!nc)throw Error.argumentNull("viewElementEventHandlers");if(!oc)throw Error.argumentNull("viewCoreEventHandlers");
this.Ob=a;this.Hc=b;this.De=c;this.YGa=f;this.ra=l;this.Ea=x;this.Mb=G;this.ia=R;this.Qt=Ic;this.$x=fa;this.uc=wa;this.Fb=Wa;this.aqe=mb;this.Zqe=Kb.hjh;this.are=Kb.gjh;this.od=nc;this.cJ=oc}get $cc(){return document.getElementById(I.AppFrame.WFh)}dispose(){this.c9=!1;this.Ob.ffh(Object(C.a)(this,this.renderRuler,"renderRuler"));Ed.a.removeHandler(this.$cc,ma.a.scroll,Object(C.a)(this,this.Uib,"updateRulerLocation"));this.od.tGe(Object(C.a)(this,this.vec,"onCloseTextEditView"));this.od.Red(Object(C.a)(this,
this.Tec,"onOpenTextEditView"));this.cJ.Ied(this.Wva);this.NI&&this.M3?(ya.a.sIa(this.NI,"ShowWACHorizontalRulerContainer"),ya.a.bI(this.NI,"HideWACHorizontalRulerContainer"),Ej.UISurfaces.NOc().then(a=>{a.dispose(this.M3);return null}),this.NI.removeChild(this.M3),this.YGa.removeChild(this.NI),this.M3=this.NI=null):Aa.a.J(512496006,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.NI&&this.M3){ya.a.sIa(this.NI,"HideWACHorizontalRulerContainer");
ya.a.bI(this.NI,"ShowWACHorizontalRulerContainer");var b=this.Hc.Gc;if(b&&b.Ed){var c=b.Ed;c=new dr.a(c.hq,c.Kk);b=this.$x.D1b(c,b.rba?b.rba.xa.style.visibility===Qi.a.visible:!1).width;c=this.De.ei(this.Hc.Gc.mB).width;1===this.aqe.Xo||0>=b||0>=c?Aa.a.J(512496003,824,50,"Ruler should not be rendered"):(this.BL.rulerCanvasProps=this.kyk(Re.a.Cea(b,0)),c=Object(C.a)(this,this.gnk,"onIndentChange"),this.BL.onIndentChange=c,this.BL.indents=this.BL.rulerCanvasProps.textEditableArea?this.Tyk():null,this.BL.rtl=
this.Ska?!this.Qt:this.Qt,this.BL.inverted=this.Ska?!this.Qt:this.Qt,this.M3.style.width=this.De.Nc(b),this.Uib(null),Ej.UISurfaces.NOc().then(f=>{f.renderRuler(this.M3,this.BL);return null}),b=window.performance.now(),Aa.a.J(512496002,824,15,"HorizontalRenderRulerDuration:{0}",(b-a).toString()))}else Aa.a.J(512496004,824,50,"Unable to get slideViewElement")}else Aa.a.J(512496005,824,50,"Ruler container div / Ruler div null")}kyk(a){const b={},c=we.a.Av(this.uc.Gn.getValue(sb.a.slideWidth));var f=
a/2;let l=0,x=Re.a.EJ(a,0);b.zeroScale=Re.a.EJ(f,0);this.Ska=!1;b.textEditableArea=!1;if(this.ra.a8()&&!this.ra.USa()){f=this.ra.JZ();var G=f.oc(this.Mb.Ma),R=G.rotation;R>this.Zqe&&R<this.are&&(this.Ska=!0);const fa=G.htmlElement.querySelector(".ShapeViewContent"),wa=this.Ea.WNc(f,this.Mb.Fd);R=0;f.Og&&(R=f.ds().oc(this.Mb.Ma).htmlElement.offsetLeft);R+=G.htmlElement.offsetLeft+fa.parentNode.offsetLeft+(wa?wa.e:0);G=R+fa.offsetWidth;f=(this.Ska?!this.Qt:this.Qt)?G:R;R>=l&&R<=x&&G>=l&&G<=x&&(l=R,
x=G,b.zeroScale=f,b.textEditableArea=!0)}R=we.a.Csa(c)/a;a=R*Re.a.Cea(x-l,0);R*=Re.a.Cea(l,0);b.leftMargin=l;b.rightMargin=x;b.precision=.0625;b.scale=c;b.rulerType="Horizontal";b.rightBoundary=we.a.jKa(a);b.leftBoundary=we.a.jKa(R);return b}Tec(){this.c9&&this.renderRuler()}vec(){this.c9&&this.renderRuler()}Tyk(){var a={};if(32!==this.ia.La(E.a.hFb,2,a))return Aa.a.J(512496001,824,10,"Unable to read paragraph indentation for Ruler"),null;const b={type:"FirstLineIndent"},c={type:"HangingIndent"},
f={type:"LeftIndent"};a=a.KA;if(!a)return Aa.a.J(512496E3,824,10,"indentInfo is null"),null;b.value=1===a.specialIndentType?we.a.jKa(a.KIb+a.nN):2===a.specialIndentType?we.a.jKa(a.nN-a.KIb):we.a.jKa(a.nN);c.value=we.a.jKa(a.nN);f.value=we.a.jKa(a.nN);return[b,c,f]}gnk(a,b){const c=new mR.a;c.Sf=1;c.value=we.a.Csa(b);this.Exj(a,c)}Exj(a,b){var c=this.ra.JZ();if(a&&b&&c){var f=window.performance.now(),l=this.Fb.ke(15);l.kc(c);c=8;switch(a){case "FirstLineIndent":c=this.ia.La(ba.a.FHb,2,b);l.fd=ba.a.FHb;
break;case "HangingIndent":c=this.ia.La(ba.a.HHb,2,b);l.fd=ba.a.HHb;break;case "LeftIndent":c=this.ia.La(ba.a.mja,2,b);l.fd=ba.a.mja;break;default:Aa.a.J(512495970,824,10,"IndentChangeHandler called with invalid type")}l.dispose();b=window.performance.now();Aa.a.J(512495969,824,15,"Indent type:{0} indentChangeDuration: {1}",a,(b-f).toString());32!==c&&Aa.a.J(512495968,824,10,"Indent operation: {0} failed",c)}else Aa.a.J(512495971,824,10,"IndentChangeHandler called with invalid params")}oJ(){this.YHd();
this.c9=!0;this.Ob.VEf(Object(C.a)(this,this.renderRuler,"renderRuler"));Ed.a.addHandler(this.$cc,ma.a.scroll,Object(C.a)(this,this.Uib,"updateRulerLocation"));this.od.IBc(Object(C.a)(this,this.vec,"onCloseTextEditView"));this.od.dUb(Object(C.a)(this,this.Tec,"onOpenTextEditView"));this.cJ.rBc(this.Wva)}Uib(){if(this.c9){var a=this.Hc.Gc;a&&a.mB&&window.requestAnimationFrame(()=>{const b=ib.a.V6a(a.mB),c=ib.a.V6a(this.YGa);this.M3.style.marginLeft=this.De.Nc(b.x-c.x+1)})}else Aa.a.J(512495967,824,
10,"UpdateRulerLocation called with cookie value false")}PNi(){if(this.NI)return this.NI;this.NI=document.createElement("div");this.NI.id="WACHorizontalRulerContainer";this.NI.className="WACHorizontalRulerContainer";this.NI.setAttribute(Jc.a.Wr,"ruler");this.NI.setAttribute(Jc.a.Ye,Jc.a.GAa);Sys.UI.DomElement.addCssClass(this.NI,"HideWACHorizontalRulerContainer");return this.NI}QNi(){if(this.M3)return this.M3;this.M3=document.createElement("div");this.M3.className="WACHorizontalRuler";this.M3.id=
"WACHorizontalRuler";return this.M3}YHd(){this.NI=this.PNi();this.NI.appendChild(this.QNi());this.YGa.insertBefore(this.NI,this.YGa.firstChild)}}Object(e.a)(dF,"HorizontalRuler",null,[344]);class eF{constructor(a,b,c,f,l){this.ZGj=!0;if(!a)throw Error.argumentNull("actionManager");if(!b)throw Error.argumentNull("activeAppFrame");if(!c)throw Error.argumentNull("rulerFactory");if(!f)throw Error.argumentNull("horizontalRuler");if(!l)throw Error.argumentNull("verticalRuler");this.ia=a;this.Ob=b;this.tQg=
c;this.j0c=f;this.d6c=l}ub(){this.ia.pa(ba.a.dOe,Bb.a.application,Object(C.a)(this,this.dOe,"showHideRuler"),4);this.ia.pa(ba.a.ADe,Bb.a.application,Object(C.a)(this,this.ADe,"queryRulerToggle"),96)}Eyj(){this.oVc()&&(Aa.a.J(523351431,824,15,"Ruler init is called"),this.tQg.Kog())}dOe(a,b,c){return this.oVc()?this.Iuj(c):this.dfl(c)}kEh(){this.Ob.VF({ShowHideRuler:"ToggleButtonModel"})}dfl(a){if(1===a)return 32;Aa.a.J(523351432,824,15,"ShowRuler called");this.tQg.Kog();this.ooh(!0);this.Ob.Fq();this.kEh();
return 32}Iuj(a){if(1===a)return 32;Aa.a.J(523351433,824,15,"HideRuler called");this.GJi();this.ooh(!1);this.Ob.Fq();this.kEh();return 32}GJi(){this.oVc()&&(this.j0c.dispose(),this.d6c.dispose(),this.Ob.Fq())}ADe(a,b,c,f,l){if(1===c)return 32;l&&(l[ai.a.On]=this.oVc());return 32}oVc(){return Pi.a.sCa(LE.a.$7g,this.ZGj)}ooh(a){Pi.a.aM(u.AFrameworkApplication.fa.Ga("IsRulerOnCookieName"),a.toString(),Pi.a.JL)}}Object(e.a)(eF,"RulerActor",null,[]);class PO{constructor(a,b,c){if(!a)throw Error.argumentNull("horizontalRuler");
if(!b)throw Error.argumentNull("verticalRuler");if(!c)throw Error.argumentNull("appFrame");this.j0c=a;this.d6c=b;this.Ob=c}Kog(){this.j0c.oJ();this.d6c.oJ();this.Ob.Fq();this.j0c.renderRuler();this.d6c.renderRuler()}}Object(e.a)(PO,"RulerFactory",null,[255]);class Hq{constructor(a,b,c,f,l,x,G,R,fa,wa,Wa,mb,Kb,nc){this.DMd="HideWACVerticalRulerContainer";this.CMf="ShowWACVerticalRulerContainer";this.Ska=this.c9=!1;this.y4=this.bJ=null;this.Wva=()=>{this.c9&&this.renderRuler()};if(!a)throw Error.argumentNull("appFrame");
if(!b)throw Error.argumentNull("activeSlideViewManager");if(!c)throw Error.argumentNull("browserHelper");if(!l)throw Error.argumentNull("selectionManager");if(!x)throw Error.argumentNull("shapeReader");if(!G)throw Error.argumentNull("pageView");if(!R)throw Error.argumentNull("slideDimensionsHelper");if(!fa)throw Error.argumentNull("presentationReader");if(!wa)throw Error.argumentNull("pptPageView");if(!Wa)throw Error.argumentNull("applicationSettings");if(!mb)throw Error.argumentNull("viewElementEventHandlers");
if(!Kb)throw Error.argumentNull("viewCoreEventHandlers");this.Ob=a;this.Hc=b;this.De=c;this.YGa=f;this.ra=l;this.Mb=G;this.uc=fa;this.Qt=nc;this.$x=R;this.aqe=wa;this.Zqe=Wa.hjh;this.are=Wa.gjh;this.od=mb;this.cJ=Kb}get $cc(){return document.getElementById(I.AppFrame.WFh)}dispose(){this.c9=!1;Ed.a.removeHandler(this.$cc,ma.a.scroll,Object(C.a)(this,this.Uib,"updateRulerLocation"));this.Ob.ffh(Object(C.a)(this,this.renderRuler,"renderRuler"));this.od.tGe(Object(C.a)(this,this.vec,"onCloseTextEditView"));
this.od.Red(Object(C.a)(this,this.Tec,"onOpenTextEditView"));this.cJ.Ied(this.Wva);this.bJ&&this.y4?(ya.a.sIa(this.bJ,this.CMf),ya.a.bI(this.bJ,this.DMd),Ej.UISurfaces.NOc().then(a=>{a.dispose(this.y4);return null}),this.bJ.removeChild(this.y4),this.YGa.removeChild(this.bJ),this.y4=this.bJ=null):Aa.a.J(512495966,824,50,"Ruler container div / Ruler div null")}renderRuler(){const a=window.performance.now();if(this.bJ&&this.y4){ya.a.sIa(this.bJ,this.DMd);ya.a.bI(this.bJ,this.CMf);var b=this.Hc.Gc;if(b&&
b.Ed){var c=b.Ed;c=new dr.a(c.hq,c.Kk);b=this.$x.D1b(c,b.rba?b.rba.xa.style.visibility===Qi.a.visible:!1).height;c=this.De.ei(this.Hc.Gc.mB).height;if(1===this.aqe.Xo||0>=b||0>=c)Aa.a.J(512495963,824,50,"Ruler should not be rendered");else{var f={};f.rulerCanvasProps=this.Vyk(Re.a.Cea(b,1));f.rtl=this.Ska?!this.Qt:this.Qt;f.inverted=this.Ska?!this.Qt:this.Qt;this.y4.style.height=this.De.Nc(b);this.Uib(null);Ej.UISurfaces.NOc().then(l=>{l.renderRuler(this.y4,f);return null});b=window.performance.now();
Aa.a.J(512495962,824,15,"VerticalRenderRulerDuration:{0}",(b-a).toString())}}else Aa.a.J(512495964,824,50,"Unable to get slideViewElement")}else Aa.a.J(512495965,824,50,"Ruler container div / Ruler div null")}Vyk(a){const b={},c=we.a.Av(this.uc.Gn.getValue(sb.a.slideHeight));var f=a/2;let l=0;a=Re.a.EJ(a,0);b.zeroScale=Re.a.EJ(f,0);this.Ska=!1;b.textEditableArea=!1;if(this.ra.a8()&&!this.ra.USa()){f=this.ra.JZ();var x=f.oc(this.Mb.Ma);const R=x.htmlElement.querySelector(".ShapeViewContent");var G=
x.rotation;G>this.Zqe&&G<this.are&&(this.Ska=!0);G=0;f.Og&&(G=f.ds().oc(this.Mb.Ma).htmlElement.offsetTop);G+=x.htmlElement.offsetTop+R.parentNode.offsetTop+R.offsetTop;x=G+R.offsetHeight;f=(this.Ska?!this.Qt:this.Qt)?x:G;G>=l&&G<=a&&x>=l&&x<=a&&(l=G,a=x,b.zeroScale=f,b.textEditableArea=!0)}b.precision=.0625;b.topMargin=l;b.bottomMargin=a;b.rulerType="Vertical";b.scale=c;return b}oJ(){this.YHd();this.c9=!0;Ed.a.addHandler(this.$cc,ma.a.scroll,Object(C.a)(this,this.Uib,"updateRulerLocation"));this.Ob.VEf(Object(C.a)(this,
this.renderRuler,"renderRuler"));this.od.IBc(Object(C.a)(this,this.vec,"onCloseTextEditView"));this.od.dUb(Object(C.a)(this,this.Tec,"onOpenTextEditView"));this.cJ.rBc(this.Wva)}Uib(){if(this.c9){var a=this.Hc.Gc;a&&a.mB&&window.requestAnimationFrame(()=>{const b=ib.a.V6a(a.mB),c=ib.a.V6a(this.YGa);this.y4.style.marginTop=this.De.Nc(b.y-c.y+1)})}else Aa.a.J(512495961,824,10,"UpdateRulerLocation called with cookie value false")}Tec(){this.c9&&this.renderRuler()}vec(){this.c9&&this.renderRuler()}YHd(){this.bJ=
this.MOi();this.bJ.appendChild(this.NOi());this.YGa.insertBefore(this.bJ,this.YGa.firstChild)}MOi(){if(this.bJ)return this.bJ;this.bJ=document.createElement("div");this.bJ.id=Hq.Bji;this.bJ.className=Hq.Aji;this.bJ.setAttribute(Jc.a.Wr,"ruler");this.bJ.setAttribute(Jc.a.Ye,Jc.a.GAa);Sys.UI.DomElement.addCssClass(this.bJ,this.DMd);return this.bJ}NOi(){if(this.y4)return this.y4;this.y4=document.createElement("div");this.y4.className=Hq.zji;this.y4.id=Hq.Cji;return this.y4}}Hq.Bji="WACVerticalRulerContainer";
Hq.Aji="WACVerticalRulerContainer";Hq.Cji="WACVerticalRuler";Hq.zji="WACVerticalRuler";Object(e.a)(Hq,"VerticalRuler",null,[344]);class fF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Ruler"}Wb(a){this.K=a}init(){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").cgb){var a=this.K.resolve("PowerPointWebEditor.AppFrame");this.K.register(dF,"PowerPointWebEditor.Ruler.HorizontalRuler").ma().na(()=>new dF(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),
a?a.Jpc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),u.AFrameworkApplication.isRtl));this.K.register(Hq,"PowerPointWebEditor.Ruler.VerticalRuler").ma().na(()=>new Hq(a,this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager"),this.K.resolve("PowerPoint.IBrowserHelperManager"),a?a.Jpc:null,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("Box4.IPageView"),this.K.resolve("PowerPointWebEditor.ISlideDimensionsHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.ViewCore.IViewCoreEventHandlers"),u.AFrameworkApplication.isRtl));this.K.register(255,"PowerPointWebEditor.Ruler.IRulerFactory").ma().na(()=>new PO(this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler"),
a));this.K.register(eF,"PowerPointWebEditor.Ruler.RulerActor").ma().na(()=>new eF(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.Ruler.IRulerFactory"),this.K.resolve("PowerPointWebEditor.Ruler.HorizontalRuler"),this.K.resolve("PowerPointWebEditor.Ruler.VerticalRuler")));this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").ub();wd.a.get_instance().gk(8,()=>{this.Iwe()})}}Iwe(){this.K.resolve("PowerPointWebEditor.Ruler.RulerActor").Eyj()}dispose(){}static main(){m.a.instance.Bc(new fF)}}
Object(e.a)(fF,"PPTWebEditorRulerPackage",null,[2,3]);class rA{static get cEl(){return rA.dEl}}rA.dEl="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>";Object(e.a)(rA,"ZoomDialogHtml",null,[]);class Zx extends Lh.a{constructor(a,b,c,f,l=!1){super(!1,!1,l);this.vTb=this.uTb=this.Da=this.qqc=null;this.YDl=
"ZoomDialogBoxGroup";this.yNa=a;this.uAc=b;this.aCf=c;this.Kd=f;this.mg=this.dgi();this.yd=1;this.ng="ZoomDialog"}get fEe(){return"ListRadioBox"}get Mic(){return"radiobox"}get Iah(){return"WACZoomDialogRadioRow"}get eEe(){return"WACZoomDialogRadioRow-highlight"}get Bo(){return this.Kd}get N6(){return this.qqc}fth(a,b){if(this.kK)this.Kfl(a,b);else{const c={};for(let f=0;f<this.yNa.length;f++)c[this.Mic+f]=this.uAc[f]===b?!0:!1;this.tj(a,Object(C.a)(this,this.$Dl,"zoomDialogHandler"),c);this.HEe();
this.qFe()}}Kfl(a,b){var c=Array(this.yNa.length);let f="";for(let l=0;l<this.yNa.length;l++){const x=l.toString();c[l]={["key"]:x,["text"]:this.yNa[l]};b===this.uAc[l]&&(f=x)}b={};b.dialogChoiceGroupProps={["id"]:this.YDl,["defaultSelectedKey"]:f,["options"]:c};c={["id"]:"OptionsDialog",["bodyControls"]:b};this.tj(a,Object(C.a)(this,this.eEl,"zoomDialogReactHandler"),c)}g0k(){this.qqc=document.getElementsByName(this.fEe)[0];this.lLc(this.N6)}X6(){this.Da||(this.Da=document.getElementById("WACDialogText"));
this.Da&&(this.uTb||(this.uTb=Object(C.a)(this,this.ZDl,"zoomDialogClickHandler"),this.en.ob(ma.a.click,this.Da,this.uTb)),this.vTb||(this.vTb=Object(C.a)(this,this.aEl,"zoomDialogKeyDownHandler"),this.Lg.ob(ma.a.Xf,this.Da,this.vTb)));super.X6();this.rc&&this.Lg.ob(ma.a.wl,this.rc,Object(C.a)(this,this.XM,"dialogDefaultEnterKeyHandler"))}HEe(){this.Bo.il().scope.np(v.FocusManager.instance().ypa);this.Bo.il().scope.np(v.FocusManager.instance().zpa);this.Bo.il().scope.bindAction(v.FocusManager.instance().ypa,
F.a.Spc);this.Bo.il().scope.bindAction(v.FocusManager.instance().zpa,F.a.Rpc)}qFe(){const a=document.getElementsByName(this.fEe);for(let b=0;b<a.length;b++){const c=a[b];Ed.a.addHandler(c,ma.a.focus,Object(C.a)(this,this.udd,"radioButtonFocusHandler"));c.checked&&(this.qqc=c)}}$Dl(a,b){if(1===a)for(a=0;a<this.yNa.length;a++)if(b[this.Mic+a]){this.aCf(this.uAc[a]);break}}udd(a){this.lLc(a.target)}ZDl(a){a=a.Ac;if(!a||!a.parentNode||"label"!==a.tagName.toLowerCase()&&!a.className.startsWith(this.Iah))return!1;
a=this.Vbg(a);a=document.getElementById(this.Mic+a);this.lLc(a);return!0}eEl(a,b){1===a&&(a=Number.parseInvariant(b.selectedOption.toString()),this.aCf(this.uAc[a]))}aEl(a){a=a.mc.keyCode;if(a!==Sys.UI.Key.down&&a!==Sys.UI.Key.right&&a!==Sys.UI.Key.up&&a!==Sys.UI.Key.left)return!1;let b=this.Vbg(this.N6);const c=this.yNa.length-1;if(a===Sys.UI.Key.down||a===Sys.UI.Key.right)b=b<c?b+1:0;else if(a===Sys.UI.Key.up||a===Sys.UI.Key.left)b=0<b?b-1:c;a=document.getElementById(this.Mic+b);this.lLc(a);return!0}XM(a){return a.eventName===
ma.a.wl&&a.mc.keyCode===Sys.UI.Key.enter?(super.XM(a),!0):!1}lLc(a){a&&(a.checked=!0,this.Bo.ze&&this.Bo.ze.name===this.DK||this.Bo.Bf(this.DK),this.Bo.il().uj.wE(a),a.focus(),this.N6&&Sys.UI.DomElement.removeCssClass(this.N6.parentNode,this.eEe),Sys.UI.DomElement.addCssClass(a.parentNode,this.eEe),this.qqc=a)}Vbg(a){return Number.parseInvariant(Ka.a.substr(a.id,a.id.length-1,1))}QF(){super.QF();const a=document.getElementById(this.ji("WACDialogPanel"));a.style.minWidth=String.format("{0}px",200);
a.style.width=String.format("{0}px",200)}dgi(){let a="";for(let b=0;b<this.yNa.length;b++)a+=Lh.a.UB(Zx.bEl,b.toString(),this.yNa[b],this.fEe);return a}dispose(){this.Da&&(this.en&&this.uTb&&this.en.xb(ma.a.click,this.Da,this.uTb),this.Lg&&this.vTb&&this.Lg.xb(ma.a.Xf,this.Da,this.vTb));this.en&&this.rc&&this.Lg.xb(ma.a.wl,this.rc,Object(C.a)(this,this.XM,"dialogDefaultEnterKeyHandler"));super.dispose()}}Zx.bEl=rA.cEl;Object(e.a)(Zx,"ZoomDialog",Lh.a,[248]);class gF{constructor(){this.uf=null}create(a,
b,c,f){return this.uf=new Zx(a,b,c,f)}}Object(e.a)(gF,"ZoomDialogFactory",null,[247]);class hF{constructor(){this.Da=null}get name(){return"Common.App.Zoom"}init(){}dispose(){}Wb(a){this.Da=a;this.Da.register(gF,"Common.App.Zoom.ZoomDialogFactory").as("Common.App.Zoom.IZoomDialogFactory").na(()=>new gF).ma()}static main(){m.a.instance.Bc(new hF)}}Object(e.a)(hF,"ZoomPackage",null,[2,3]);class QO{constructor(a,b,c,f,l,x,G){this.fck=[ResourceStrings.L_ZoomDialogFit,"400%","200%","150%","100%","66%",
"50%","33%"];this.w6c="fittowindow 4 2 1.5 1 0.66 0.5 0.33".split(" ");this.uf=null;this.ia=a;this.Fa=b;this.uc=l;this.aj=c;this.Ob=f;this.Uk=x;this.gFg=G}ub(){this.ia.pa(ba.a.Gah,sc.a.application,Object(C.a)(this,this.aGk,"queryZoom"),96);this.ia.ya(ba.a.atk,sc.a.application,Object(C.a)(this,this.usj,"handleZoomConfig"));this.ia.ya(ba.a.ZWe,sc.a.application,Object(C.a)(this,this.vsj,"handleZoomToFit"));this.ia.ya(F.a.Spc,xd.a.frame,Object(C.a)(this,this.VGh,"zoomDialogTabFocusHandler"));this.ia.ya(F.a.Rpc,
xd.a.frame,Object(C.a)(this,this.VGh,"zoomDialogTabFocusHandler"));u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&(this.ia.ya(F.a.rYb,xd.a.frame,Object(C.a)(this,this.rYb,"decreaseZoom")),this.ia.ya(F.a.O3b,xd.a.frame,Object(C.a)(this,this.O3b,"increaseZoom")),this.ia.ya(F.a.gEl,xd.a.frame,Object(C.a)(this,this.lsk,"onZoomToPercentage")),this.ia.pa(F.a.bGk,xd.a.frame,Object(C.a)(this,this.npk,"onQueryZoomPercentage"),96),re.a("ZoomShortCutsEnabled")&&(this.ia.ya(E.a.XVf,xd.a.frame,Kd.ActionManager.Hg),
this.ia.ya(E.a.WVf,xd.a.frame,Kd.ActionManager.Hg)))}xe(){if(u.AFrameworkApplication.fa.ka("ZoomSliderIsEnabled")&&re.a("ZoomShortCutsEnabled")){const a=this.Fa.Dc(Yb.a.jj);a.bindAction(A.KeyInputManager.Na(w.a.uod,A.KeyInputManager.He),F.a.O3b);a.bindAction(A.KeyInputManager.Na(w.a.xod,A.KeyInputManager.He),F.a.O3b);a.bindAction(A.KeyInputManager.Na(w.a.vod,A.KeyInputManager.He),F.a.rYb);a.bindAction(A.KeyInputManager.Na(w.a.vpc,A.KeyInputManager.He),F.a.rYb);this.gFg&&ja.a.instance.ob(ma.a.zCb,
this.gFg,Object(C.a)(this,this.G9h,"adjustZoomOnMouseWheel"))}}G9h(a){return a?a.rZ?(0<a.oGh?this.tKa(this.$Wg):0>a.oGh&&this.tKa(this.aXg),!0):!1:!1}get b5a(){return Math.round(100*this.aj.kU)}get aXg(){return Math.floor(this.b5a/10)/10+.1}get $Wg(){return Math.ceil(this.b5a/10)/10-.1}aGk(a,b,c,f,l){if(!l||re.a("ZoomPercentageNaNBugFixEnabled")&&(isNaN(this.b5a)||0==this.b5a))return 8;l[fE.a.LabelText]=Math.round(100*this.aj.kU)+"%";this.Uk&&(this.Uk.jea(this.Uk.lZa,this.Uk.WGh),this.Uk.iea(this.Uk.lZa,
this.Uk.WGh));return 32}usj(a,b,c,f,l){if(1===c)return this.uc.Hj()?32:8;if(!l)return 8;this.uf=new Zx(this.fck,this.w6c,Object(C.a)(this,this.fpd,"zoomSettingAction"),v.FocusManager.instance(),!0);this.uf.fth(CommonUIStrings.l_ZoomDialogTitle,this.aj.Cja?this.w6c[0]:this.aj.kU.toString());return 32}fpd(a){if(a!==this.w6c[0]){const b=parseFloat(a);if(isNaN(b)){Aa.a.J(512288459,827,10,"Invalid Zoom Value: {0}",a);return}this.aj.Cja=!1;this.aj.kU=b;this.aj.jjb=2}else this.aj.Cja=!0;this.Ob.Fq();Aa.a.J(512288458,
827,50,"Succeeded to Zoom: {0}",a)}vsj(a,b,c,f,l){if(1===c)return this.uc.Hj()?32:8;if(!l)return 8;this.fpd(this.w6c[0]);return 32}VGh(a){if(!this.uf)return 8;var b=this.uf.Bo.il().uj.vZ;if(b===this.uf.Hv&&a===F.a.Spc||b===this.uf.XC&&a===F.a.Rpc)this.uf.N6||this.uf.g0k(),this.uf.Bo.il().uj.wE(this.uf.N6);else if(b.id.startsWith(this.uf.Mic)||b.className.startsWith(this.uf.Iah))b=null,a===F.a.Spc?b=this.uf.XC:a===F.a.Rpc&&(b=this.uf.Hv),this.uf.Bo.il().uj.wE(b),Sys.UI.DomElement.removeCssClass(this.uf.N6.parentNode,
this.uf.eEe);else if(a===F.a.Spc)this.uf.Bo.il().CCb();else if(a===F.a.Rpc)this.uf.Bo.il().ACb();else return 16;return 32}O3b(a,b,c){if(1===c)return 32;this.tKa(this.aXg);Aa.a.J(512288456,827,50,"Increase Zoom triggered via ZoomIn");return 32}rYb(a,b,c){if(1===c)return 32;this.tKa(this.$Wg);Aa.a.J(512288455,827,50,"Decrease Zoom triggered via ZoomOut");return 32}lsk(a,b,c,f,l){if(1===c)return 32;a=l.value/100;this.tKa(a);Aa.a.J(512288454,827,50,"Zoom changed via zoom slider: {0}",a);f&&(f.IP=Math.floor(100*
a));return 32}npk(a,b,c,f,l){if(re.a("ZoomPercentageNaNBugFixEnabled")&&(isNaN(this.b5a)||0==this.b5a))return 8;l.MinValue=10;l.MaxValue=400;l.value=this.b5a;return 32}tKa(a){.1>a?a=.1:4<a&&(a=4);this.aj.Cja=!1;this.aj.kU=a;this.aj.jjb=2;this.Ob.Fq()}}Object(e.a)(QO,"ZoomActor",null,[229]);class iF{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Zoom"}Wb(a){this.K=a}init(){var a=this.K.resolve("PowerPointWebEditor.AppFrame");const b=this.K.resolve("Common.IActionManagerExtended"),
c=this.K.resolve("PowerPointWebEditor.IFocusManager");a=new QO(b,c,this.K.resolve("PowerPointWebEditor.IZoomContext"),a,this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IPPTRumTracker"),a.TJd);a.ub();a.xe()}dispose(){}static main(){m.a.instance.Bc(new iF)}}Object(e.a)(iF,"PPTWebEditorZoomPackage",null,[2,3]);Type.registerNamespace("B4A11Y");Type.registerNamespace("B4Ac");Type.registerNamespace("B4AuC");Type.registerNamespace("B4Im");Type.registerNamespace("B4LE");
Type.registerNamespace("B4OLE");Type.registerNamespace("B4Proofing");Type.registerNamespace("B4TLE");Type.registerNamespace("B4TM");Type.registerNamespace("B4TaE");Type.registerNamespace("B4TaVE");Type.registerNamespace("B4UI");Type.registerNamespace("B4UndoRedo");Type.registerNamespace("B4Up");Type.registerNamespace("Box3");Type.registerNamespace("Box4");Type.registerNamespace("Box4.Clipboard");Type.registerNamespace("Box4.ContentEditable");Type.registerNamespace("Box4.Insights");Type.registerNamespace("Box4.ListMarker");
Type.registerNamespace("Box4.ListMarkerGallery");Type.registerNamespace("Box4.ParagraphRenderElements");Type.registerNamespace("Box4.Shortcuts");Type.registerNamespace("Box4.WordPrediction");Type.registerNamespace("Box4.WordPrediction.Telemetry");Type.registerNamespace("ColorPickerManager");Type.registerNamespace("Microsoft.Office.Infrared");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPoint");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Aria");
Type.registerNamespace("PowerPointWebEditor.Assistance");Type.registerNamespace("PowerPointWebEditor.AugmentationLoop");Type.registerNamespace("PowerPointWebEditor.AutoFit");Type.registerNamespace("PowerPointWebEditor.CoreExt");Type.registerNamespace("PowerPointWebEditor.DragDrop");Type.registerNamespace("PowerPointWebEditor.DynamicScriptLoader");Type.registerNamespace("PowerPointWebEditor.ErrorHandling");Type.registerNamespace("PowerPointWebEditor.EventTiming");Type.registerNamespace("PowerPointWebEditor.Fonts");
Type.registerNamespace("PowerPointWebEditor.GraphEditor");Type.registerNamespace("PowerPointWebEditor.GraphMerge");Type.registerNamespace("PowerPointWebEditor.HtmlExport");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.ModernFontPicker");Type.registerNamespace("PowerPointWebEditor.Notes");Type.registerNamespace("PowerPointWebEditor.Paragraph");Type.registerNamespace("PowerPointWebEditor.PodsPops");Type.registerNamespace("PowerPointWebEditor.PowerPointFeedback");
Type.registerNamespace("PowerPointWebEditor.PresenterView");Type.registerNamespace("PowerPointWebEditor.Proofing");Type.registerNamespace("PowerPointWebEditor.Proofing.CloudAL");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.Ribbon");Type.registerNamespace("PowerPointWebEditor.Ruler");Type.registerNamespace("PowerPointWebEditor.ShapeEdit");Type.registerNamespace("PowerPointWebEditor.ShapeManipulation");Type.registerNamespace("PowerPointWebEditor.SlideShow");
Type.registerNamespace("PowerPointWebEditor.SmartArt");Type.registerNamespace("PowerPointWebEditor.SmartGuide");Type.registerNamespace("PowerPointWebEditor.Storage");Type.registerNamespace("PowerPointWebEditor.Table");Type.registerNamespace("PowerPointWebEditor.TableStyleEditor");Type.registerNamespace("PowerPointWebEditor.Telemetry");Type.registerNamespace("PowerPointWebEditor.TextEditing");Type.registerNamespace("PowerPointWebEditor.TextFormatting");Type.registerNamespace("PowerPointWebEditor.UI");
Type.registerNamespace("PowerPointWebEditor.UndoRedo");Type.registerNamespace("PowerPointWebEditor.UnifiedApp");Type.registerNamespace("PowerPointWebEditor.ViewEventHandler");Type.registerNamespace("PowerPointWebEditor.WebSocketFrontDoor");Type.registerNamespace("PowerpointPresence");Type.registerNamespace("TableCellMargin");Type.registerNamespace("PowerPointWebEditor.Zoom");window.g_hermesExtJS=Date.now();Q.main();ea.main();Xd.main();ue.main();Il.main();$m.main();m.a.instance.Bc(new Ij);Wf.main();
Ml.main();Co.main();Bn.main();uk.main();nm.main();sj.main();ek.main();Xn.main();Bl.main();No.main();mn.main();Type.registerNamespace("Common.App.AccountSwitching");to.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.ChromeExtensionHelper");Type.registerNamespace("CommonUI");Type.registerNamespace("Common.App.HostNotification");qm.main();Type.registerNamespace("Common");dt.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Bu.main();Type.registerNamespace("Common.App.ImageProcessor");
Type.registerNamespace("Common.App.NewAndOpen.Core");m.a.instance.Bc(new et);Type.registerNamespace("Common");Type.registerNamespace("Common.App.People");Fu.main();Su.main();Yu.main();Type.registerNamespace("Common.App.People");vr.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");window.MSOJS=kq;sd.main();Type.registerNamespace("Common");m.a.instance.Bc(new Ck);Type.registerNamespace("CAUI");Nm.main();Type.registerNamespace("Common.App.SaveStatus");m.a.instance.Bc(new $x);
Type.registerNamespace("Fdbk");Type.registerNamespace("Common.App.CustomerFeedback");d(1105).CustomerFeedbackPackage.main();Type.registerNamespace("Common.App.Zoom");hF.main();window.PPTUserInitiatedSurveysDictionary_FromAppPackage={PPTIdeasSurvey:{campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",
ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},PPTRehearsePresentationSurvey:{campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",
ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"},TellMeSurvey:{campaignId:"e55e81b0-5645-4111-b08e-18d7cdaf2bef",commentQuestion:"Please tell us more. Why did you choose that answer?",isZeroBased:!1,promptQuestion:"We have two questions for you.",promptNoButtonText:"Not now",promptYesButtonText:"Sure",ratingQuestion:"How satisfied are you with using Microsoft Search in PowerPoint?",
ratingValuesAscending:["Very dissatisfied","Dissatisfied ","Neutral","Satisfied","Very satisfied"],showEmailRequest:!0,showPrompt:!1,surveyType:4,title:"We'd love your feedback on Microsoft Search in PowerPoint"}};uA.main();Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.Controls");Type.registerNamespace("CommandUI");Type.registerNamespace("CommandUI.React");vA.main();CA.main();EA.main();FA.main();GA.main();HA.main();MA.main();NA.main();VA.main();window.PowerPointEditingJewelRibbonData=
{name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"PptJewel",DefaultSelection:"PptJewel.Open",TextDirection:"STR@L_TextDirection",LabelText:"STR@L_JewelText",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Menu"},children:[{name:"MenuSection",attrs:{Id:"PptJewel.PrimaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.PrimaryMenu.Controls"},children:[{name:"Button",
attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@prt2@CloseFileMenuPowerPoint_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Info",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Info.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"MenuFileName",Title:"STR@L_Info",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblBreadcrumbDocName",
QueryCommand:"0xE55B9734",LabelText:""}}]}]},{name:"MenuSection",attrs:{DisplayMode:"Menu48",ShowMenuSectionSeparator:"false"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Info.OpenInClient",LabelText:"STR@L_OpenInPowerPoint",Description:"STR@L_OpenInPowerPointDescription",Image48by48:"IMGMAP@prt2@PowerPoint_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInPowerPointKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.VersionHistory",LabelText:"STR@L_FileHistory",
Description:"STR@L_FileHistoryDescription",Image48by48:"IMGMAP@prt2@History_48x48x32",Command:"0x1BD57F1B",Keytip:"STR@l_FileVersionKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Info.FileVersion",LabelText:"STR@L_FileVersion",Description:"STR@L_FileVersionDescription",Image48by48:"IMGMAP@prt2@Versions_48x48x32",Command:"0xFF30AFCC",Keytip:"STR@l_FileVersionKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.New",LabelText:"STR@L_New",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",
AllowDefaultContent:"true",PopulateQueryCommand:"0x7BA0BBA5",Keytip:"STR@l_NewKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelNew"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingNew",DisplayMode:"MenuLoading",Title:"STR@L_New"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblNewButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Open",LabelText:"STR@L_Open",Command:"0x2F9A3D80",PopulateDynamically:"true",PopulateOnlyOnce:"false",AllowDefaultContent:"true",
PopulateQueryCommand:"0xA6D756C7",Keytip:"STR@l_OpenKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelOpen"},children:[{name:"MenuSection",attrs:{Id:"menuLoadingMru",DisplayMode:"MenuLoading",Title:"STR@L_Open"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblMruButtonsLoading"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Rename",LabelText:"STR@L_RenameButtonTitle",Command:"0x2F9A3D80",Keytip:"STR@l_RenameButtonTitleKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Rename.Menu"},
children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_RenameButtonTitle"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Rename.RenameDialog",LabelText:"STR@L_RenameButtonTitle",Description:"STR@L_RenameButtonDescription",Image48by48:"IMGMAP@prt2@RenameColumn_48x48x32",Command:"0x8E08F41F",Keytip:"STR@l_RenameButtonTitleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.SaveACopy",LabelText:"STR@L_SaveACopy",Command:"0x2F9A3D80",Keytip:"STR@l_SaveAsKeytip"},
children:[{name:"Menu",attrs:{Id:"PptJewel.SaveACopy.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_SaveACopy"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveACopy",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveAsButtonDescription",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0x72B6A68C",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveAsToHost",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",
Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xB8A8271F",Keytip:"STR@l_SaveAsKeytip"}},{name:"Button",attrs:{Id:"PptJewel.SaveACopy.SaveToSharePoint",LabelText:"STR@L_SaveACopy",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@prt2@SaveAs_48x48x32",Command:"0xBAA2DFAC",Keytip:"STR@l_SaveAsKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"SaveAsInformationMenuSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuSaveButton"},children:[{name:"Controls",attrs:{},children:[{name:"Label",
attrs:{Id:"PptJewel.SaveACopy.WheresTheSaveButton",LabelText:"STR@L_WheresTheSaveButton",Description:"STR@L_WheresTheSaveButtonDescription"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Print",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Print.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Print.PrintToPdf",
LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@prt2@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintFullSlide",LabelText:"STR@L_PrintFullSlide",Description:"STR@L_PrintFullSlideDescription",Image48by48:"IMGMAP@prt2@HandoutsLandscapeSlides_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintNotes",LabelText:"STR@L_PrintNotes",Description:"STR@L_PrintNotesDescription",
Image48by48:"IMGMAP@prt2@HandoutsPortraitNotesLandscapePaper_48x48x32",Command:"0x108EE012",Keytip:"STR@l_PrintToPdfKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Print.PrintHandouts",LabelText:"STR@L_PrintHandouts",Description:"STR@L_PrintHandoutsDescription",Image48by48:"IMGMAP@prt2@HandoutsPortraitOnPortrait3_48x48x32",Command:"0x866D929F",Keytip:"STR@l_PrintToPdfKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Share",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},
children:[{name:"Menu",attrs:{Id:"PptJewel.Share.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Share.ShareWithPeople",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",Image48by48:"IMGMAP@prt2@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.Embed",LabelText:"STR@L_Embed",Description:"STR@L_EmbedDescription",
Image48by48:"IMGMAP@prt2@EmbedDocument15_48x48x32",Command:"0x3A7B8B90",Keytip:"STR@l_EmbedKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Share.ReplyWithChanges",LabelText:"STR@L_ReplyWithChanges",Description:"STR@L_ReplyWithChangesDescription",Image48by48:"IMGMAP@prt2@SendAsLink_48x48x32",Command:"0x4759B1F9",Keytip:"STR@l_ReplyWithChangesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.DownloadAs",LabelText:"STR@L_DownloadAs",Command:"0x2F9A3D80",Keytip:"STR@l_DownloadAsKeytip"},children:[{name:"Menu",
attrs:{Id:"PptJewel.DownloadAs.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_DownloadAs"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopy",LabelText:"STR@L_DownloadCopy",Description:"STR@L_DownloadCopyDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointPptx_48x48x32",Command:"0xD3EF8F78",Keytip:"STR@l_DownloadCopyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsPdf",LabelText:"STR@L_DownloadAsPdf",
Description:"STR@L_DownloadCopyAsPdfDescription",Image48by48:"IMGMAP@prt2@PDF_file_48x48x32",Command:"0x91656D12",Keytip:"STR@l_DownloadAsPDFKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadACopyAsOdp",LabelText:"STR@L_DownloadAsOdp",Description:"STR@L_DownloadCopyAsOdpDescription",Image48by48:"IMGMAP@prt2@SaveAsPowerPointOdp_48x48x32",Command:"0x4A7CCC65",Keytip:"STR@l_DownloadAsOdpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.DownloadAs.DownloadAsImages",LabelText:"STR@L_DownloadAsImages",
Description:"STR@L_DownloadAsImagesDescription",Image48by48:"IMGMAP@prt2@Downloadasimage_48x48x32",Command:"0x47057070",Keytip:"STR@l_DownloadAsImagesKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.About",LabelText:"STR@L_AboutOffice",Command:"0x2F9A3D80",Keytip:"STR@l_AboutOfficeKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.About.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_AboutOffice"},children:[{name:"Controls",attrs:{},children:[{name:"Button",
attrs:{Id:"PptJewel.About.TermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.Privacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.TrustCenter",LabelText:"STR@L_TrustCenter",
Description:"STR@L_TrustCenterDescription",Image48by48:"IMGMAP@prt2@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}},{name:"Button",attrs:{Id:"PptJewel.About.ThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@prt2@Info_48x48x32",Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"PptJewel.About.DiagnosticsSection",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},
children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"PptJewel.About.Diagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.SessionId",LabelText:"STR@L_DiagnosticsSessionId",QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"PptJewel.About.Build",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",
ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"PptJewel.Help",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"PptJewel.Help.Menu"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"PptJewel.Help.Help",LabelText:"STR@L_Help",Description:"STR@L_HelpDescription",Image48by48:"IMGMAP@prt2@OfficeAssistant_48x48x32",Command:"0x56B04A51",
Keytip:"STR@l_HelpKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.GiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@prt2@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Id:"PptJewel.Help.ReportAbuse",LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@prt2@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},
{name:"MenuSection",attrs:{Id:"PptJewel.SecondaryMenu",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"PptJewel.SecondaryMenu.Controls"},children:[{name:"Button",attrs:{Id:"PptJewel.Close",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]};BB.main();Type.registerNamespace("Common.App.Insights");m.a.instance.Bc(new UG);Type.registerNamespace("Common.App.Activities");FB.main();Type.registerNamespace("Common.App.ActivityAggregator");KB.main();Type.registerNamespace("Common.App.AppsForOffice");
window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Xq;Type.registerNamespace("Common.App.Assistance");Type.registerNamespace("Common.App.BrowserInfoLogger");LB.main();Type.registerNamespace("Common.App.CommandUIActors");Type.registerNamespace("CADWLTR");MB.main();Type.registerNamespace("Common.App.EventsCacheManager");NB.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.FloatPane");QB.main();Type.registerNamespace("Common.App.InsertFile");
Type.registerNamespace("Common.App.InsertPicture");TB.main();wC.main();AC.main();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("CNT");CC.main();Type.registerNamespace("Common.App.VisibilityManagement");EC.main();Type.registerNamespace("Common.ModernFontPicker");FC.main();GC.main();LC.main();RC.main();UC.main();cD.main();eD.main();kD.main();Gz.main();ED.main();GD.main();ID.main();WD.main();XD.main();YD.main();
ZD.main();aE.main();jE.main();kE.main();cF.main();fF.main();iF.main()},123:function(J,V,d){d.d(V,"a",function(){return h});d.d(V,"b",function(){return e});const h=m=>null===m||"undefined"===typeof m||!m.length,e=m=>null===m||"undefined"===typeof m},153:function(J,V,d){d.d(V,"a",function(){return e});d.d(V,"b",function(){return m});var h=d(41);const e=(r,v,A)=>{r=h.a.Pl(r);r.Wa("CommandId",v.toString());try{return A()}finally{r.finish(!0)}},m=(r,v,A,w)=>e(r+v,A,w)},228:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{}h.WBc="AfterValidate";h.autoCorrect="AutoCorrect";h.Jdi="BeforeValidate";h.bFi="CutAction";h.NLi="EditingElementContainerDisconnectingFromView";h.endEditing="EndEditing";h.DUi="FinishingSelectionValidation";h.cxj="ImeTypingEnd";h.exj="ImeTypingStart";h.CDj="IpMode";h.Qx="KeyPress";h.Xf="KeyDown";h.Hhk="NotFinishingSelectionValidation";h.Rtk="OvertypeEnd";h.Ttk="OvertypeStart";h.Wtk="PaddingChanged";h.d5g="ParagraphContentUpdated";h.bwk="PasteAction";h.y5k="SetMode";h.typingProcess=
"TypingProcess";h.bqi="ClipboardModeBegin";h.cqi="ClipboardModeEnd";Object(J.a)(h,"EditEventKeys",null,[])},243:function(J,V,d){d.d(V,"a",function(){return m});var h=d(25),e=d(13);const m=r=>h.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk:Object(e.a)(r.resolve("Common.IDynamicScriptLoaderProvider").Jv,r.resolve("Common.IDynamicScriptLoaderProvider").Jv.loadScript,"loadScript")},247:function(J,V,d){d.r(V);J=d(0);var h=d(376),e=d(55),m=d(25),r=d(45),v=d(573),A=d(1174),
w=d(17);d(1166);var y=d(977),u=d(27),D=d(75),F=d(121),I=d(31),H=d(40),L=d(34),E=d(74),aa=d(51),Q=d(71),O=d(56),T=d(86);d(407);var K=d(49),X=d(409);class P{constructor(C,pa,Z,qa,ya){this.UAd=C;this.dZh=Z;this.cZh=pa;this.cOh=qa;this.pTh=ya}DZk(C,pa){pa.EZk(C,this.UAd,this.cZh,this.dZh,this.cOh,this.pTh)}}Object(J.a)(P,"MathPropertyObject",null,[]);var ea=d(30),ia=d(114);d.d(V,"Box4PasteSteward",function(){return ja});class ja extends y.a{constructor(C,pa,Z,qa,ya,Ka,Da,la=null,ma=null){super(C,Da,la,
ma);this.Zn=this.A1=null;this.Foa=!1;this.L0a=null;this.nlb=-1;this.D1a=0;this.fFd=new w.a;ia.a(4223754,307,O.OutlineElementReader.Ug(C));this.P0a=pa;this.P0a.fpb(this);this.UE=Z;this.UE.fpb(this);this.Svd=qa;this.Po=ya;this.dSh=Ka;this.fBd=E.ListReader.kk(this.zb);ja.lAj();ja.$zj();ja.QAj()}get X7(){return this.A1||(this.A1=e.a.instance.qb("Box4.IInternalLinkManager"))}get aPa(){return this.Zn}get O4a(){return this.fBd&&!this.UE.Eba}get d5a(){return 0<this.D1a}get hv(){return this.Svd}get jo(){return this.Po}get LXc(){return this.dSh}get Xei(){return!!m.AFrameworkApplication.fa&&
m.AFrameworkApplication.fa.ka("Box4EnsurePasteFormatOnTextIsEnabled")}reset(){super.reset();this.Zn=this.F_d(!1)}SJd(C){ia.a(4223762,307,O.OutlineElementReader.Ug(this.zb)||Q.OutlineReader.Lt(this.zb));this.DCb(!1);var pa=new ea.GraphIterator;pa.Pc(this.zb);C=y.a.Nh.yba(this.zb,this.SQa(C));this.xCc(pa,!1);ia.a(4223763,307,C===this.zb.currentNode);ia.a(4223764,307,I.ParagraphReader.Vd(C));-1!==this.Zn.JD&&ja.paragraphEditor.$L(C,this.Zn.JD);if(ja.paragraphEditor.hv&&!this.BY.xrh){if(this.Zn.textIndent){let ya;
({Sf:qa,returnValue:ya}=ja.qad(this.Zn.textIndent));var Z=!1;if(ya||!E.ListReader.Y5a){0>ya&&(Z=!0,ya*=-1);var qa=ja.pQd(ya,qa);Z||ja.paragraphEditor.hv.Jgb(C,qa)}}!this.Zn.marginLeft||ja.eL.iVc||E.ListReader.kk(pa)||({Sf:pa,returnValue:Z}=ja.qad(this.Zn.marginLeft),pa=ja.pQd(Z,pa),ja.paragraphEditor.hv.Ehd(C,1,pa))}(ja.Qf.ag&&ja.Qf.By||L.a.instance.ga(45)&&u.App.nD.UJb)&&C.setValue(H.a.q5b,!0);this.Zn.lineSpacing&&ja.paragraphEditor.C0(C,this.Zn.lineSpacing);this.Zn.paragraph=C;this.Foa=!0}xCc(C,
pa){ia.a(8128518,307,!pa);this.RL&&!L.a.instance.ga(76)&&(0<this.RL&&this.hv.UHc(C,this.RL),0>this.RL&&this.hv.Teb(C,this.RL,0));L.a.instance.ga(29)&&(this.zb.Pc(C),aa.OutlineElementNavigator.ri(this.zb));!this.O4a||2===u.App.mode&&this.LXc.Ahc?C&&this.jo.XKe(C,this.d5a):this.jo.Xnh(C);this.RL=0}umd(C){this.fFd.add(C)}xOd(){this.RL=0}g0(C,pa=null){ia.a(4223772,307,I.ParagraphReader.Rk(this.zb));const Z=this.zb.currentNode;this.Zn.BTe(Z);if(!this.BY.PTe(pa)){m.AFrameworkApplication.Wj("Microsoft.Office.Web.Common.Flighting.IBox4EnsurePasteFormatOnTextSettings");
var qa=Z.Ra.last,ya=K.a.QOa(Z),Ka=!1;this.Foa&&(qa.formatting=this.Zn.z6a.Ud(qa),L.a.instance.ga(57)&&Z.Nu(),this.Foa=!1,Ka=!0);C=this.BY.p5d(C,pa);this.BY.ona(this.zb.currentNode,this.Zn.yea,pa);this.characterPropertiesEditor.replaceTextRange(ya,C);this.Xei&&Ka&&(C=Z.Qrb(ya.Qa),C.formatting=this.Zn.z6a.Ud(C));L.a.instance.ga(2)}}kma(C){this.BY.VUc&&this.BY.$Tc(C)?(this.eA(),this.fA(C)):(ia.a(4223773,307,I.ParagraphReader.Rk(this.zb)),C=K.a.QOa(this.zb.currentNode),this.characterPropertiesEditor.eSc(C,
pa=>new X.a(pa,X.a.DHc),D.AParagraphNode.AZ))}SWa(){}jma(C){this.P0a.jma(C)}ima(C){this.Zn=C;this.Foa=!0}Jva(C){ia.a(4223774,307,I.ParagraphReader.Rk(this.zb));ia.a(4223775,307,!this.L0a);ia.a(4223776,307,0>this.nlb);this.L0a=C;this.nlb=I.ParagraphReader.textLength(this.zb.currentNode)}Iva(){ia.a(4223777,307,I.ParagraphReader.Rk(this.zb));ia.a(4223778,307,!!this.L0a);ia.a(4223779,307,0<=this.nlb);let C=K.a.createTextRange(this.zb.currentNode,this.nlb,I.ParagraphReader.textLength(this.zb.currentNode)),
pa="",Z="";this.X7&&({Rdh:pa,kXi:Z}=this.X7.bAh(F.HyperlinkReader.RCa(this.L0a),!0)).returnValue&&(this.L0a=pa,Z&&(this.characterPropertiesEditor.replaceTextRange(C,Z),C=K.a.createTextRange(this.zb.currentNode,this.nlb,I.ParagraphReader.textLength(this.zb.currentNode))));ja.hyperlinkEditor.aia(C,this.L0a,!1);this.Foa=!0;this.L0a=null;this.nlb=-1}fA(C){this.SJd(C);this.Zn.Imd(this.zb.currentNode);C&&"P"===C.ZT.u3b&&ja.paragraphEditor.cJa(this.zb.currentNode,this.Zn.had);this.BY.ona(this.zb.currentNode,
this.Zn.yea,C,this.Zn.marginLeft,this.Zn.textIndent)}eA(){ia.a(4223808,307,I.ParagraphReader.Rk(this.zb));ja.hyperlinkEditor.TNi(this.zb.currentNode);aa.OutlineElementNavigator.Ke(this.zb)}MWa(){}LWa(){}Ova(){}DHa(){}nma(){ia.a(4223809,307,O.OutlineElementReader.Ug(this.zb)||Q.OutlineReader.Lt(this.zb));let C=!1;this.d5a||(C=this.O4a||!0);C||(this.RL+=1);this.D1a++}lma(){this.D1a--;let C=!1;this.d5a||(C=this.O4a||!0);C||--this.RL}Nva(C){ia.a(4223810,307,O.OutlineElementReader.Ug(this.zb)||Q.OutlineReader.Lt(this.zb));
ia.a(4223811,307,0!==C.listStyleType);this.jo.rHb(this.qVj(C))}mma(){ia.a(4223813,307,O.OutlineElementReader.Ug(this.zb));m.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings");if(ja.eL.iVc&&E.ListReader.kk(this.zb)){const C=I.ParagraphReader.ptb(this.zb.currentNode),pa=this.LXc.Gcg(this.zb);this.jo.Hhd(pa,C,null)}}NWa(C){this.P0a.NWa(C)}FX(C){this.UE.FX(C)}CX(){this.UE.CX()}EX(C){this.UE.EX(C)}DX(){this.UE.DX()}BX(C){this.UE.BX(C)}AX(){this.UE.AX()}static get paragraphEditor(){return ja.Hw||
(ja.Hw=e.a.instance.resolve("Box4.IParagraphEditor"))}static get hyperlinkEditor(){return ja.jn||(ja.jn=e.a.instance.resolve("Box4.IHyperlinkEditor"))}static get Qf(){return ja.Xc||(ja.Xc=e.a.instance.resolve("Box4.TrackChange.ITrackChangeManagerFactory").instance)}static get bJb(){return ja.syf}static get eL(){return ja.ZJ||(ja.ZJ=e.a.instance.qb("Box4.List.ListSettings"))}static lAj(){const C=L.a.instance.ga(61);ja.JHa[1]=C?T.StyleReader.Tod:T.StyleReader.SIb;ja.JHa[2]=C?T.StyleReader.Uod:T.StyleReader.TIb;
ja.JHa[3]=C?T.StyleReader.Vod:T.StyleReader.UIb;ja.JHa[4]=C?T.StyleReader.Wod:T.StyleReader.VIb;ja.JHa[5]=C?T.StyleReader.Xod:T.StyleReader.WIb;ja.JHa[6]=C?T.StyleReader.Yod:T.StyleReader.XIb;ja.JHa[7]=C?null:T.StyleReader.Rmc}static $zj(){ja.Wca.unspecified=0;ja.Wca.defaultUnordered=1;ja.Wca.defaultOrdered=1;ja.Wca.none=0;ja.Wca.disc=1;ja.Wca.circle=2;ja.Wca.square=3;ja.Wca.decimal=1;ja.Wca.lowerAlpha=2;ja.Wca.lowerRoman=3;ja.Wca.upperAlpha=4;ja.Wca.upperRoman=5}static QAj(){ja.syf=T.StyleReader.eub()}static Q4a(C){return r.a.substring(C,
4,6)+r.a.substring(C,2,4)+r.a.substring(C,0,2)}static qad(C){let pa,Z;pa=0;const qa=C.length;Z=parseFloat(r.a.substring(C,0,qa-2));C=r.a.substr(C,qa-2,2);switch(C){case "in":pa=3;break;case "px":pa=7;break;case "cm":pa=1;break;case "pt":pa=5;break;default:h.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",C),Z=0}return{returnValue:Z,Sf:pa}}static pQd(C,pa){let Z=0;switch(pa){case 3:Z=v.a.Csa(C);break;case 7:Z=A.a.Cea(C,0);
break;case 1:Z=v.a.HNd(C);break;case 5:Z=v.a.Csa(v.a.ebd(C));break;default:h.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",C,pa)}return Z}}ja.Hw=null;ja.jn=null;ja.Xc=null;ja.JHa=Array(8);ja.Wca={};ja.syf=null;ja.ZJ=null;Object(J.a)(ja,"Box4PasteSteward",y.a,[])},263:function(J,V,d){d.r(V);J=d(0);d(376);var h=d(906);d(907);var e=d(25),m=d(95),r=d(55),v=d(35);class A{}Object(J.a)(A,"RibbonUpsellButtonCreator",null,[]);class w extends Sys.EventArgs{constructor(X){super();
this.LCl=X}}Object(J.a)(w,"TopRowCreatedEventArgs",Sys.EventArgs,[]);d(377);var y=d(355);d(170);var u=d(134);d(73);var D=d(219),F=d(159),I=d(65);class H{constructor(X,P){this.cluster=X;this.eHc=P}}Object(J.a)(H,"ImageInfo",null,[]);class L{constructor(X,P,ea,ia,ja,C,pa,Z,qa,ya,Ka,Da,la,ma,Ea=null,ta=null){this.id=X;this.xAc=P;this.BAc=ea;this.AAc=ia;this.zAc=ja;this.yAc=C;this.DAc=pa;this.eHd=Z;this.BIb=new H(qa,ya);this.Pjd=new H(Ka,Da);this.H7c=new H(la,ma);Ea&&ta&&new H(Ea,ta)}}Object(J.a)(L,"PeoplesWellBaseSettings",
null,[]);class E{constructor(){this.BKf=null}}Object(J.a)(E,"BreadcrumbControls",null,[]);class aa{constructor(X){this.id=X}}new aa("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32");Object(J.a)(aa,"ChatButtonSettings",null,[]);class Q{constructor(){this.id=this.image=this.label=this.command=null}}Object(J.a)(Q,"SkypeButtonInfo",null,[]);class O{constructor(){this.gWe=this.Eyh=this.YLd=null}}Object(J.a)(O,"TopRowControls",null,[]);var T=d(198);d(45);
d.d(V,"CuiHelper",function(){return K});class K{constructor(X,P,ea=null,ia,ja=null){this.sga=X;this.HPh=T.a.Xek(P,ja);this.HPh.push(CommonUIStrings);h.b();K.Ca=void 0===ea||null===ea?e.AFrameworkApplication.Ta:ea}static get duj(){return K.Ioa||(K.Ioa=r.a.instance.resolve("Common.App.Header.HeaderEventSource"))}static abj(X,P,ea){return new L(K.hAe,v.a.Mqi,v.a.aPd,v.a.Pqi,v.a.Oqi,v.a.Nqi,v.a.Qqi,v.a.C4a,X,"per_SingleCollabUserGlyph_16x16x32",P,"per_SingleCollabUserGlyph_32x32x32",ea,"per_MoreUsersGlyph_16x16x32",
null,null)}static JJi(X){X.YLd&&(K.IJi(X.YLd),X.YLd=null);X.Eyh&&(K.HJi(),X.Eyh=null);X.gWe&&(K.KJi(X.gWe),X.gWe=null);K.duj.DHk();let P;({f3b:P}=y.a.fKb(!1)).returnValue&&m.a.TAa(P)}static R3b(){e.AFrameworkApplication.Ta.processAction(v.a.R3b,2)}static HJi(){e.AFrameworkApplication.NIc&&F.EventHandlerManager.instance.und(e.AFrameworkApplication.NIc)}static addButton(X,P,ea,ia,ja,C,pa,Z){P=u.a(X,P,ea,ia,null,null,null,C,null,null,void 0,void 0,ja);(X=Z.hostControl(X,P,C))&&pa.appendChild(X);return X}static sGc(X,
P,ea){let ia;ia=document.createElement("span");ia.className="BreadcrumbItem";ia.id=P;ia.innerText=ea;ia.setAttribute("dir","auto");X.appendChild(ia);return ia}static IJi(X){X.BKf&&F.EventHandlerManager.instance.oul(X.BKf)}static KJi(X){D.a.instance.oCh(I.a.click,X,K.Mqk,!0)}static Mqk(){e.AFrameworkApplication.dWe?(e.AFrameworkApplication.Aa.qmc(e.AFrameworkApplication.Aa.jb.Pfg()),e.AFrameworkApplication.dWe=!1):window.top.location=e.AFrameworkApplication.signInUrl;return!0}static $Vc(){return!!e.AFrameworkApplication.Aa&&
e.AFrameworkApplication.Aa.jb.$Vc}}K.Ioa=null;K.Z9k="ShareServerWhite_20x20x32";K.xWd="ExternalHeaderFullTopBars";K.iuj="HeaderTopBars";K.ZLd="BreadcrumbBrand";K.$Ld="BreadcrumbFolder";K.aMd="BreadcrumbTitle";K.O6f="FolderSeparator";K.LRe="sbTellMe";K.SOe="TellMe-SearchBox";K.Q3g="btnOpenInClient";K.CMe="btnFileSharing";K.igl="BasicChat";K.gfd="btnReplyWithChanges";K.x4f="jbtnGiveFeedback";K.hAe="PeoplesWellControl";K.V_f="EditableBreadcrumbItem";K.Ca=null;K.CUe=50;K.buj=null;Object(J.a)(K,"CuiHelper",
null,[678])},300:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.alt="Alt";h.iconColor="IconColor";h.Uub="Image16by16Class";h.uwj="Image30by30Class";h.nDa="Image32by32Class";h.l7d="Image48by48Class";h.labelText="LabelText";h.JTj="LabelTextUserGeneratedPlaceholderReplacements";h.visible="Visible";h.tU="SourceControlId";h.customTooltip="CustomTooltip";h.Icon="Icon";h.IconSet="IconSet";h.Ych="ReduxActions";Object(J.a)(h,"SharedControlCommandProperties",null,[])},302:function(J,V,d){J=
d(0);var h=d(55),e=d(377),m=d(585),r=d(127),v=d(376),A=d(95),w=d(644),y=d(390),u=d(45),D=d(196),F=d(54),I=d(1079),H=d(25),L=d(162);class E{constructor(la,ma){this.cp=la;this.distance=ma}}Object(J.a)(E,"CpDistanceResult",null,[]);class aa{constructor(){this.hDa=0;this.Ss=null;this.arb=this.brb=this.dPa=this.tBa=0;this.Dnc=this.zEa=this.yJa=null;this.oxb=this.Vba=this.P6c=0;this.IWe=this.HTd=!1;this.jYb=this.jCa=this.dia=this.r2=this.qhc=0;this.XGh=this.d6f=this.Dmc=this.HIb=!1;this.result=null;this.wXb=
this.CQd=this.S4a=this.f7=this.uba=0;this.Bja=this.nGc=!1;this.zO=null}}Object(J.a)(aa,"CpFromPointState",null,[]);class Q{constructor(la,ma,Ea,ta,Ga,oa,sa,Ha=null,bb=0,Ya=null){this.jBa=this.cp=this.Qa=0;this.vXb=-1;this.deltaX=this.BTf=Number.MAX_VALUE;this.CWa=0;this.oTa=-Number.MAX_VALUE;this.mTa=-Number.MAX_VALUE;this.VWd=this.XZb=this.epb=this.bxe=!1;this.element=la;this.point=Ea;this.Z9a=ta;this.lFe=Ga;this.kFe=oa;this.ssg=sa;this.Kha=Ha;this.f4a=bb;this.originalText=ma;this.FHa=this.originalText.length;
this.Kb=this.FHa-1;this.i5b=4===this.Z9a||3===this.Z9a;this.zO=Ya}}Object(J.a)(Q,"CpFromPointElementState",null,[]);var O=d(42);class T{constructor(la,ma,Ea){this.CpBegin=la;this.CpEnd=ma;this.IsEop=Ea}}Object(J.a)(T,"CpFromPointResult",null,[]);class K{constructor(la,ma,Ea){this.LineBounds=la;this.ClientRects=ma;this.IsRangeMultipleLines=Ea}}Object(J.a)(K,"LineCoordinateResult",null,[]);class X{constructor(la,ma,Ea,ta,Ga,oa){this.Xjb={};this.NOb=!0;this.wBg=this.rwc=this.Syc=this.hnb=this.C2a=null;
this.hd=la;this.PY=ma;this.Xuc=Ea?Ea.ka("TextFidelityLayoutFixesEnabled"):!1;this.mQh=Ea?Ea.ka("HyperlinkFirstCharacterSelectionFixIsEnabled"):!1;this.YPh=Ea?Ea.ka("CharacterBeforeEOPSelectionFixIsEnabled"):!1;(this.nMa=ta)||v.ULS.sendTraceTag(21051272,324,10,"_measureBoundsUsingSpansStrategy is null");this.iP=Ga;this.bZh=oa}zca(){this.NOb=!1}T4a(la,ma,Ea,ta=null){this.wBg=[];var Ga=la.C5;if(!la.textLength)return this.znj(la,ma,Ea,ta);ta=Object.assign(new aa,{yJa:Array(Ga.length),zEa:Array(Ga.length),
Dnc:Array(Ga.length),HTd:!0,Ss:Ga,zO:ta});for(var oa=0;oa<=Ga.length;oa++){ta.tBa=0;ta.dPa=0;ta.brb=0;ta.arb=0;ta.hDa=0;ta.HIb=!1;ta.Dmc=!1;if(oa<Ga.length){if(!this.NTi(la,ta,oa))continue}else{ta.oxb=oa-1;break}if(this.oUi(ma,ta,oa))break}if(ta.IWe&&ta.qhc<ma.y&&ma.y<ta.r2)return this.K_k(la,ma,Ea,ta);ta.result=null;ta.uba=-1;ta.f7=ta.jCa;ta.S4a=Number.MAX_VALUE;ta.CQd=0;ta.wXb=0;ta.nGc=!1;ta.Bja=!1;for(Ga=ta.Vba;Ga<=ta.oxb;Ga++)if(oa=this.mUi(la,ma,Ea,Ga,ta))return oa;return this.lmj(la,ma,Ea,ta)}znj(la,
ma,Ea,ta){const Ga=la.isRtl;if(!Ea)return new T(0,0,!1);la=this.hOa(la,ta);return!Ga&&ma.x>la.x+la.width/2||Ga&&ma.x<la.x+la.width/2?new T(-1,-1,!0):new T(0,0,!0)}NTi(la,ma,Ea){if(this.Ini(ma.Ss[Ea].htmlElement)||ma.Ss[Ea].Hvb)return!1;var ta=this.WLd(ma.Ss[Ea],ma.zO);ma.yJa[Ea]=ta;var Ga=ta.y;let oa=ta.y+ta.height;ma.Ss[Ea].dvg||ma.Ss[Ea].Bja||ma.Ss[Ea].f3&&!ma.Ss[Ea].ySa?({oWf:Ga,nWf:oa}=this.$Ff(ma.Ss[Ea].htmlElement,Ga,oa),ma.tBa=ma.brb=Ga,ma.dPa=ma.arb=oa,ma.zEa[Ea]=oa-Ga,ma.Dnc[Ea]=ma.zEa[Ea]):
(this.wcl(la,Ea)?(ta=this.Bt(la,ma.jYb,void 0,void 0,void 0,ma.zO),Ga=this.R0b(ma.Ss[Ea].htmlElement),la=1<Ga?this.Bt(la,ma.jYb+Ga-1,void 0,void 0,void 0,ma.zO):ta,ma.tBa=Ga=ta.y,ma.dPa=ta.y+ta.height,ma.brb=la.y,ma.arb=la.y+la.height,ma.zEa[Ea]=ta.height,ma.Dnc[Ea]=ta.height):(la=this.bZh.Khj(ma.Ss[Ea].htmlElement),ma.hDa=this.nMa.Tfj(ma.Ss[Ea].htmlElement,la),{oWf:Ga,nWf:oa}=this.$Ff(ma.Ss[Ea].htmlElement,Ga,oa),ma.XGh=1<Math.abs(ta.width-this.O6i(ma.Ss[Ea].htmlElement))||1<Math.abs(ta.height-this.N6i(ma.Ss[Ea].htmlElement)),
ma.XGh&&this.PY.instance&&(la=Math.round(la*this.PY.instance.s2),ma.hDa=Math.round(ma.hDa*this.PY.instance.s2)),ma.tBa=Ga-ma.hDa,ma.dPa=Ga+la+ma.hDa,ma.brb=oa-la-ma.hDa,ma.arb=oa+ma.hDa,ma.zEa[Ea]=la+2*ma.hDa,ma.Dnc[Ea]=la),ma.P6c=Math.max(ma.P6c,ma.zEa[Ea]));ma.d6f||(ma.r2=ma.tBa,ma.dia=ma.dPa,ma.d6f=!0);ma.Dmc=ma.brb>(ma.tBa+ma.dPa)/2;Ea=X.Rra(ma.P6c);this.Xuc&&(Ea=this.nJd(ma,Ea));ma.HIb=this.lFj(ma.r2,ma.dia,Ga,Ea);return!0}lFj(la,ma,Ea,ta){return la===ma?Ea>ma:Ea>=ma-ta}nJd(la,ma){return ma=
this.nMa.nJd(!!la.zO&&la.zO.Dwb,la.tBa,la.dPa,ma)}oUi(la,ma,Ea){if(ma.HIb||ma.Dmc){ma.HIb?ma.oxb=Ea-1:(ma.r2=Math.min(ma.r2,ma.tBa),ma.dia=Math.max(ma.dia,ma.dPa),ma.oxb=Ea);Array.add(this.wBg,ma.dia);if(la.y<=ma.dia)return!0;ma.qhc=ma.dia;ma.r2=ma.brb;ma.dia=ma.arb;ma.Vba=Ea;ma.jCa=ma.jYb;ma.HTd=ma.HIb;ma.IWe=ma.Dmc;ma.P6c=ma.Ss[Ea].Bja||ma.Ss[Ea].f3&&!ma.Ss[Ea].ySa?0:ma.zEa[Ea]}else ma.r2=Math.min(ma.r2,ma.tBa),ma.dia=Math.max(ma.dia,ma.arb);la.y>ma.qhc&&la.y<ma.r2&&!ma.Ss[ma.Vba].Bja&&!ma.Ss[ma.Vba].f3&&
ma.r2-ma.qhc<ma.Dnc[ma.Vba]/2&&(ma.r2=la.y);ma.jYb+=this.SEi(ma.Ss[Ea]);return!1}K_k(la,ma,Ea,ta){if(ta.Ss[ta.Vba].f3)return Ea?new T(ta.jCa,ta.jCa,!1):new T(ta.jCa,ta.jCa+1,!1);if(Ea=this.ATf(ta.Ss[ta.Vba].htmlElement,ta.yJa[ta.Vba],ma,ta.HTd?4:3,ta.qhc,ta.r2,ta.zEa[ta.Vba],la.isRtl,la.Kha,ta.jCa,ta.zO))return Ea=ta.jCa+Ea.cp,Ea=this.WFf(la,ma,Ea,ta.Vba,ta.jCa,void 0,void 0,ta.zO),new T(Ea,Ea,!1);this.hd.Tb(w.a.jhk,{["Reason"]:m.a.l4f});return null}mUi(la,ma,Ea,ta,Ga){if(Ga.Ss[ta].Hvb)return null;
const oa=Ga.Ss[ta].f3,sa=Ga.Ss[ta].Bja;let Ha=!1;if(oa){if(Ga.yJa[ta].y>=Ga.r2&&(Ga.Ss[ta].ySa||Ga.Ss[ta].NUc)){var bb=Ga.yJa[ta];const Ya=bb.x+bb.width/2,ua=Math.abs(ma.x-Ya);if(ua<Ga.S4a||!bb.width&&ua===Ga.S4a)Ga.nGc=!0,Ga.S4a=ua,Ga.Bja=!1,Ga.uba=!Ea||!la.isRtl&&ma.x<Ya||la.isRtl&&ma.x>Ya?Ga.f7:Ga.f7+1}if(!Ga.Ss[ta].ySa&&!Ga.Ss[ta].NUc){bb=Ga.yJa[ta];if(!Ea&&ma.x>bb.x&&ma.x<bb.x+bb.width&&!Ga.Ss[ta].DJj)return new T(Ga.f7,Ga.f7+1,!1);Ga.result=ma.x<bb.x+bb.width/2?new E(la.isRtl?1:0,Math.max(bb.x-
ma.x,0)):new E(la.isRtl?0:1,Math.max(ma.x-bb.x-bb.width,0))}}else sa?(la=this.hOa(la,Ga.zO),Ha=1>la.width,Ga.result=new E(-1,y.a.xIc(ma,la))):Ga.result=this.ATf(Ga.Ss[ta].htmlElement,Ga.yJa[ta],ma,ta===Ga.Vba&&Ga.IWe?1:ta===Ga.oxb&&!Ga.HIb&&Ga.Dmc?0:2,Ga.r2,Ga.dia,Ga.zEa[ta],la.isRtl,la.Kha,Ga.f7,Ga.zO);Ga.result&&(Ga.result.distance<Ga.S4a||Ha&&Ga.result.distance<=Ga.S4a+1)&&(Ga.uba=Ga.result.cp+Ga.f7,Ga.Bja=sa,Ga.S4a=Ga.result.distance,Ga.CQd=Ga.f7,Ga.wXb=ta,Ga.nGc=oa);Ga.f7=oa?Ga.f7+1:Ga.f7+this.R0b(Ga.Ss[ta].htmlElement);
return null}lmj(la,ma,Ea,ta){if(-1===ta.uba)return this.hd.Tb(w.a.ICj,{["Reason"]:m.a.g4f}),null;const Ga=la.textLength;if(ta.Bja){if(Ea)return Ea=ta.yJa[ta.yJa.length-1],!la.isRtl&&ma.x<Ea.x+Ea.width/2||la.isRtl&&ma.x>Ea.x+Ea.width/2?new T(Ga,Ga,!1):new T(-1,-1,!0);ta.uba=Ga}ta.uba>Ga&&(ta.uba=Ga);!ta.nGc&&ta.uba<Ga&&(ta.uba=this.WFf(la,ma,ta.uba,ta.wXb,ta.CQd,ta.wXb===ta.Vba,ta.wXb===ta.oxb,ta.zO));return new T(ta.uba,ta.uba,!1)}WFf(la,ma,Ea,ta,Ga,oa=!1,sa=!1,Ha=null){const bb=la.isRtl,Ya=la.characterData,
ua=la.textLength;Ea=u.a.Xw(Ya,Ea)?Ea-1:Ea;const Ma=u.a.wJj(Ya,Ea)?Ea+2:Ea+1,Ca=this.Bt(la,Ea,void 0,void 0,void 0,Ha);ma=ma.x>Ca.x+Ca.width/2;if(Ea-Ga===this.R0b(la.C5[ta].htmlElement)&&la.C5.length>ta+1&&la.C5[ta+1].f3)return Ea;if(la.C5[ta].sGj)return++Ea;if(la.C5[ta].rGj)return Ea;let Va=null,Za=!1;0<Ea&&(Va=this.Bt(la,u.a.Xw(Ya,Ea-1)?Ea-2:Ea-1,void 0,void 0,void 0,Ha),0<Ea-Ga?Za=Va.y+Va.height/2>Ca.y:oa||la.C5[ta-1].f3||(Za=!0));oa=null;let Db=!1;if(this.YPh?Ma<=ua:Ma<ua)oa=this.Bt(la,Ma,void 0,
void 0,void 0,Ha),Ma-Ga<this.R0b(la.C5[ta].htmlElement)?Db=oa.y+oa.height/2<Ca.y+Ca.height:sa||la.C5[ta+1].ySa||la.C5[ta+1].NUc||(Db=!0);Za&&Db?Va.x<=Ca.x&&oa.x>=Ca.x?ma&&(Ea=Ma):Va.x>=Ca.x&&oa.x<=Ca.x?ma||(Ea=Ma):Va.x<oa.x?ma||(Ea=Ma):oa.x<Va.x&&ma&&(Ea=Ma):Za||(Db?oa.x>=Ca.x&&ma?Ea=Ma:oa.x<=Ca.x&&!ma&&(Ea=Ma):!u.a.Oy(Ya.charCodeAt(Ea))&&(!bb&&ma||bb&&!ma)&&(Ea=Ma));return Ea}L6i(la){return A.a.fv(la)}N6i(la){return la.offsetHeight}O6i(la){return la.offsetWidth}Ini(la){return!la.parentNode}R0b(la){return A.a.W6a(la)}wcl(la,
ma){ma=la.C5[ma];if(ma.f3)return!1;la=la.htmlElement;Sys.UI.DomElement.containsCssClass(la,"Paragraph")||(la=la.firstChild);return""!==la.style.lineHeight&&la.style.lineHeight!==ma.htmlElement.style.lineHeight}SEi(la){return la.f3?1:A.a.W6a(la.htmlElement)}$Ff(la,ma,Ea){Ea=new Sys.UI.Bounds(0,ma,0,Ea-ma);this.a9h(la,[Ea]);ma=Ea.y;Ea=Ea.y+Ea.height;return{oWf:ma,nWf:Ea}}a9h(la,ma){if(la=D.a.It(la)){var Ea=la.borderTopWidth,ta=Ea.indexOf("px");if(-1<ta)for(Ea=parseInt(Ea.substr(0,ta)),ta=0;ta<ma.length;ta++)ma[ta].y+=
Ea,ma[ta].height-=Ea;la=la.borderBottomWidth;Ea=la.indexOf("px");if(-1<Ea)for(la=parseInt(la.substr(0,Ea)),Ea=0;Ea<ma.length;Ea++)ma[Ea].height-=la}}ATf(la,ma,Ea,ta,Ga,oa,sa,Ha,bb,Ya,ua=null){if(this.nIj(la))return this.hd.Tb(w.a.IUi,{["Reason"]:m.a.k4f}),new E(0,y.a.xIc(Ea,ma));if(this.mIj(la))return this.hd.Tb(w.a.XKc,{["Reason"]:m.a.XKc}),null;la=this.Lyi(la,Ea,ta,Ga,oa,sa,bb,Ya,ua);if(1>=la.FHa)return new E(0,y.a.xIc(la.point,ma));this.aXk(la);do{if(la.Qa>la.Kb)return this.jGb(),this.hd.Tb(w.a.ihk,
{["Reason"]:m.a.bXg}),null;this.egk(la)}while(!la.bxe);for(la.jBa=!Ha&&la.CWa<la.point.x||Ha&&la.CWa>la.point.x?la.Kb:la.Qa;!la.epb&&!this.dei(la););if(la.VWd)for(la.cp=la.Qa;la.cp<=la.Kb&&!this.iVj(la);la.cp++);return this.Doi(la)}Lyi(la,ma,Ea,ta,Ga,oa,sa,Ha,bb=null){return new Q(la,this.L6i(la),ma,Ea,ta,Ga,oa,sa,Ha,bb)}nIj(la){return!la.firstChild}mIj(la){return 3!==la.firstChild.nodeType}aXk(la){let ma;if(0===la.Z9a){la.oTa=la.lFe;la.mTa=la.kFe;for(var Ea=40;Ea<la.FHa;Ea+=40)if(ma=this.gOa(la.element,
la.originalText,Ea,la.Kha,la.f4a,void 0,void 0,la.zO),ma.height&&ma.y+ma.height/2>la.mTa){la.Kb=Ea;break}}else if(1===la.Z9a)for(la.Kb=la.FHa-1,la.oTa=la.lFe,la.mTa=la.kFe,Ea=la.FHa-40;0<=Ea;Ea-=40){if(ma=this.gOa(la.element,la.originalText,Ea,la.Kha,la.f4a,void 0,void 0,la.zO),ma.height&&ma.y+ma.height/2<la.oTa){la.Qa=Ea;break}}else if(2===la.Z9a)la.Kb=la.FHa-1,la.oTa=la.lFe,la.mTa=la.kFe;else if(3===la.Z9a||4===la.Z9a)for(Ea=0;Ea<la.FHa+40;Ea+=40){const ta=Ea<la.FHa?Ea:la.FHa-1;ma=this.gOa(la.element,
la.originalText,ta,la.Kha,la.f4a,void 0,void 0,la.zO);if(ma.height&&(ma.y+ma.height<la.point.y&&(la.Qa=ta),ma.y>la.point.y)){la.Kb=ta;break}}}egk(la){const ma=Math.floor((la.Qa+la.Kb)/2);la.cp=ma;let Ea=this.gOa(la.element,la.originalText,la.cp,la.Kha,la.f4a,void 0,void 0,la.zO);for(;la.cp<la.Kb&&!Ea.height;)la.cp++,Ea=this.gOa(la.element,la.originalText,la.cp,la.Kha,la.f4a,void 0,void 0,la.zO);la.cp!==la.Kb||Ea.height?!la.i5b&&Ea.y+Ea.height/2<la.oTa||la.i5b&&Ea.y+la.ssg<la.point.y?la.Qa=la.cp+1:
!la.i5b&&Ea.y+Ea.height/2>la.mTa||la.i5b&&Ea.y>la.point.y?la.Kb=la.cp-1:Ea.x<=la.point.x&&Ea.x+Ea.width>=la.point.x?(la.epb=!0,la.XZb=!0,la.bxe=!0):(la.bxe=!0,la.CWa=Ea.x+Ea.width/2,la.vXb=la.cp,la.deltaX=Math.abs(la.CWa-la.point.x),la.i5b&&(la.oTa=Ea.y,la.mTa=Ea.y+la.ssg)):la.Kb=ma-1}dei(la){var ma=Math.abs(la.jBa-la.cp);if(ma<la.BTf)la.BTf=ma;else return la.epb=!0,la.VWd=!0;ma=Math.floor((la.cp+la.jBa)/2);ma===la.cp&&(ma=la.jBa);var Ea=this.gOa(la.element,la.originalText,ma,la.Kha,la.f4a,void 0,
void 0,la.zO);if(0<Ea.height&&Ea.y+Ea.height/2<=la.oTa||Ea.y+Ea.height/2>=la.mTa)la.jBa=la.cp<la.jBa?ma-1:ma+1;else if(Ea.x<=la.point.x&&Ea.x+Ea.width>=la.point.x)la.cp=ma,la.XZb=!0,la.epb=!0;else{Ea=Ea.x+Ea.width/2;const ta=Math.abs(la.CWa-Ea),Ga=Math.abs(la.CWa-la.point.x),oa=Math.abs(Ea-la.point.x);oa<la.deltaX&&(la.vXb=ma,la.deltaX=oa);ta+oa===Ga?(la.cp=ma,la.CWa=Ea):Ga+oa===ta?(la.jBa=la.cp<la.jBa?la.cp+1:la.cp-1,la.cp=ma,la.CWa=Ea):ta+Ga===oa&&(la.epb=!0,la.VWd=!0)}la.jBa===la.cp&&(la.epb=!0);
return!1}iVj(la){var ma=this.gOa(la.element,la.originalText,la.cp,la.Kha,la.f4a,void 0,void 0,la.zO);if(0<ma.height&&ma.y+ma.height/2<=la.oTa||ma.y+ma.height/2>=la.mTa)return!1;if(ma.x<=la.point.x&&ma.x+ma.width>=la.point.x)return la.XZb=!0;ma=Math.abs(ma.x+ma.width/2-la.point.x);ma<la.deltaX&&(la.vXb=la.cp,la.deltaX=ma);return!1}Doi(la){if(!la.XZb&&-1===la.vXb)return this.jGb(),this.hd.Tb(w.a.khk,{["Reason"]:m.a.h4f}),null;la.XZb?la.deltaX=0:la.cp=la.vXb;u.a.Xw(la.originalText,la.cp)&&la.cp--;this.jGb();
return new E(la.cp,la.deltaX)}Bt(la,ma,Ea=!1,ta=!1,Ga=!1,oa=null){let sa;la||v.ULS.sendTraceTag(6870734,315,50,"paragraphElement is null");let Ha=({i:Ca,Ss:sa,f7:Ga,Ngk:ma}=this.ggg(la,ma,Ga)).returnValue,bb="";bb=la.Kha;la=A.a.fv(Ha.htmlElement);let Ya=la.length,ua,Ma=!1;if(!Ya)if(ua=Sys.UI.DomElement.getBounds(Ha.htmlElement),Ma=!0,!ua.height&&Ca<sa.length-1)Ca++,Ha=sa[Ca],la=L.b(Ha.htmlElement),Ya=la.length;else if(!Ha.htmlElement.firstChild||Ha.dvg)return this.iP.zfa(ua,oa,()=>Ha.htmlElement.offsetWidth/
Ha.htmlElement.offsetHeight);var Ca=!1;!Ma&&ma>=Ya&&(ma=Ya-1,Ca=!0);if(ua=Ha.f3||!Ha.htmlElement.firstChild||Ha.nug?this.WLd(Ha,oa):this.gOa(Ha.htmlElement,la,ma,bb,Ga,Ea,ta,oa))Ma?ua.width=1:Ca&&(ua.x+=ua.width,ua.width=1);this.jGb();return ua}WCa(la,ma,Ea=!1,ta=!0){return this.ggg(la,ma,Ea,ta).returnValue}X5b(la,ma){return ma.y>la.y+la.height-X.Rra(la.height)}ggg(la,ma,Ea=!1,ta=!0){let Ga,oa,sa=la;Ga=la.C5;for(la=oa=0;la<Ga.length;la++){if(Ga[la].Hvb)continue;let Ha;if(Ga[la].f3){if(!ma){Ea||this.DKj(Ga,
la)?sa=Ga[la]:(sa=Ga[la-1],ma=Ha=A.a.W6a(sa.htmlElement),oa-=Ha);break}ma--;oa++;continue}Ha=A.a.W6a(Ga[la].htmlElement);let bb=!1;if(this.mQh){const Ya=Ga[la].htmlElement,ua=Ya.nextSibling;ua&&(bb=Sys.UI.DomElement.containsCssClass(Ya,"EmptyTextRun")&&Sys.UI.DomElement.containsCssClass(ua,"Hyperlink"))}if(ma<Ha||!ma&&ta&&!bb||la>=Ga.length-1){sa=Ga[la];break}else ma-=Ha,oa+=Ha}return{returnValue:sa,i:la,Ss:Ga,f7:oa,Ngk:ma}}DKj(la,ma){if(!ma)return!0;const Ea=this.jpb(la[ma-1].htmlElement);la=this.jpb(la[ma].htmlElement);
return this.X5b(Ea,la)}gOa(la,ma,Ea,ta,Ga,oa=!1,sa=!1,Ha=null){let bb=Ea+1;Ea||ma.length?u.a.Xw(ma,Ea)?Ea--:u.a.Xw(ma,bb)&&bb++:bb=0;if(""!==ta)if(ta=Ga+Ea+"-"+ta,this.NOb){if(Ga=this.Xjb[ta],void 0!==Ga&&null!==Ga)return ta=this.iP.zfa(Ga,Ha,()=>this.iP.L9f(la,Ea)),ta=this.nMa.oJd(Ha,la,ta)}else this.Xjb={},this.NOb=!0;Ga=this.jpc(la,Ea,bb);oa=oa&&(F.a.Aj||F.a.io);if(!Ga&&!sa||oa)ma=this.qek(la,ma,Ea,bb),Ga||(Ga=ma),oa&&Ga&&(Ga.y=ma.y,Ga.height=ma.height);""!==ta&&Ga&&(this.Xjb[ta]=new Sys.UI.Bounds(Ga.x,
Ga.y,Ga.width,Ga.height));ta=this.iP.zfa(Ga,Ha,()=>this.iP.L9f(la,Ea));return ta=this.nMa.oJd(Ha,la,ta)}jpc(la,ma,Ea){let ta=null;if(this.R0b(la)<Ea)return null;F.a.AU&&(ta=this.pek(la,ma,Ea));!ta&&F.a.Aj&&(ta=this.rek(la,ma,Ea));return ta}tKf(la,ma=null){return this.jpb(la.htmlElement.firstChild,ma)}WLd(la,ma=null){return la.ySa?this.tKf(la,ma):this.jpb(la.htmlElement,ma)}jpb(la,ma=null){var Ea=Sys.UI.DomElement.getBounds(la);Ea=this.iP.zfa(Ea,ma,()=>la.offsetWidth/la.offsetHeight);return Ea=this.nMa.oJd(ma,
la,Ea)}kZ(la,ma,Ea,ta,Ga,oa){return la!==ma.characterData.length||Ea?this.Wei(la,ma,Ea,ta,Ga,oa):this.Vei(ma)}Vei(la){const ma=this.hOa(la);return this.Oag(ma,!la.isRtl)}Wei(la,ma,Ea,ta,Ga,oa){var sa=ma.textLength;if(F.a.US&&Ea&&0<la&&la<sa){var Ha=this.WCa(ma,la-1,!0),bb=this.WCa(ma,la,!0);Ha===bb&&(Ea=!1)}var Ya=Ea?la-1:la;u.a.Xw(ma.characterData,Ya)&&--Ya;var ua=!0;bb=this.WCa(ma,Ya,!0,!1);if(bb.f3)if(bb.ySa){if(Ea)return this.kZ(la,ma,!1,ta,!1,oa);Ha=this.tKf(bb)}else if(bb.NUc){if(Ea)return this.kZ(la,
ma,!1,ta,!1,oa);if(la)return this.kZ(la,ma,!0,ta,!1,oa);Ha=this.WLd(bb)}else Ha=this.jpb(bb.htmlElement),bb.UJj&&(ua=!1);else{bb=Ya;do{Ha=this.Bt(ma,bb,Ga,oa);if(!Ha)return null;bb+=1}while(!Ha.height&&bb<=sa)}bb=sa=ma.isRtl;if(ua){ua=this.QBc(ma,Ya,-1,Ga,oa);Ga=this.QBc(ma,Ya,1,Ga,oa);oa=new Sys.UI.Point(Ha.x+Ha.width/2,Ha.y+Ha.height/2);Ya=Ha.y;var Ma=Ha.y+Ha.height;Ya=!ua||ua.y+ua.height<=Ya;Ma=!Ga||Ga.y>=Ma;let Ca=!1;Ya||Ma?Ya||u.a.Oy(ma.characterData.charCodeAt(la))?Ma||(Ga.x>=oa.x?bb=!1:Ga.x<=
oa.x&&(bb=!0),Ca=bb!==sa):(ua.x<=oa.x?bb=!1:ua.x>=oa.x&&(bb=!0),Ca=bb!==sa):ua.x<=oa.x&&oa.x<=Ga.x?bb=!1:Ga.x<=oa.x&&oa.x<=ua.x?bb=!0:ua.x<Ga.x?(bb=!0,Ca=Ea?oa.x<ua.x:ua.x<oa.x):Ga.x<ua.x&&(bb=!1,Ca=Ea?ua.x<oa.x:oa.x<ua.x);if(Ca&&F.a.tF){if(Ea&&!ta)return this.kZ(la,ma,!1,!1);la||(Ha=this.d4i(ma,sa))}}return this.Oag(Ha,bb===Ea)}QBc(la,ma,Ea,ta,Ga){if(0>Ea&&0>=ma||0<Ea&&ma>=la.characterData.length-1)return null;const oa=ma+Ea;return u.a.Xw(la.characterData,oa)?this.QBc(la,oa,Ea,ta,Ga):this.WCa(la,
ma,!0,!1).ySa?null:(ma=this.Bt(la,oa,ta,Ga))?ma.height&&ma.width?ma:this.QBc(la,oa,Ea,ta,Ga):null}d4i(la,ma){let Ea=null;for(var ta=0;ta<la.C5.length;ta++){const Ga=la.C5[ta];if(!Ga.Hvb){Ea=Ga.htmlElement;break}}for(ta=Ea.childNodes[0];ta&&1===ta.nodeType;)Ea=ta,ta=Ea.childNodes[0];ta=A.a.fv(Ea);A.a.wx(Ea,(ma?"\u202e":"\u202d")+ta);this.zca();la=this.Bt(la,0);A.a.wx(Ea,ta);this.zca();return la}Oag(la,ma){return new Sys.UI.Bounds(ma?la.x:la.x+la.width,la.y,0,la.height)}hOa(la,ma=null){return this.jpb(la.h2f.htmlElement,
ma)}pek(la,ma,Ea){this.jGb();try{const ta=la.firstChild,Ga=ta.ownerDocument.createRange();Ga.setStart(ta,ma);Ga.setEnd(ta,Ea);const oa=this.W$i(Ga,(sa,Ha)=>(0<sa||ma===Ea)&&0<Ha);if(!oa||!oa.length)return null;this.VFf(ta,oa[0]);Ga.detach();return oa[0]}catch(ta){return null}}W$i(la,ma){this.jGb();try{let Ea;Ea=la.getClientRects();la=[];for(let ta=0;ta<Ea.length;ta++){const Ga=Ea[ta];if(Ga){const oa=Math.floor(Ga.width/1),sa=Math.floor(Ga.height/1);if(ma(oa,sa)){const Ha=new Sys.UI.Bounds(Math.floor(Ga.left/
1),Math.floor(Ga.top/1),oa,sa);Array.add(la,Ha)}}}return la}catch(Ea){return null}}rek(la,ma,Ea){if(!F.a.hJb)return null;let ta=null;try{ta=la.ownerDocument.body.createTextRange(),ta.moveToElementText(la)}catch(Ga){return null}if(ta.collapse&&ta.move&&ta.moveEnd)ta.collapse(),ta.move("character",ma),ta.moveEnd("character",Ea-ma);else return null;ma=new Sys.UI.Bounds(ta.boundingLeft,ta.boundingTop,ta.boundingWidth,ta.boundingHeight);if(!(ma.x||ma.y||ma.width||ma.height))return null;this.VFf(la,ma);
la=window.screen.deviceXDPI/window.screen.logicalXDPI;1!==la&&(ma.x=Math.round(ma.x/la),ma.y=Math.round(ma.y/la),ma.width=Math.round(ma.width/la),ma.height=Math.round(ma.height/la));return ma}qek(la,ma,Ea,ta){this.C2a&&this.C2a.ownerDocument===la.ownerDocument||(this.C2a=la.ownerDocument.createElement("SPAN"),this.hnb=la.ownerDocument.createElement("SPAN"),this.Syc=la.ownerDocument.createElement("SPAN"));la.firstChild!==this.C2a&&(this.rwc=new I.a(la),A.a.ku(la),this.nMa&&this.nMa.gpi(this.C2a,this.hnb,
this.Syc),la.appendChild(this.C2a),la.appendChild(this.hnb),la.appendChild(this.Syc));A.a.wx(this.C2a,u.a.substring(ma,0,Ea));A.a.wx(this.hnb,u.a.substring(ma,Ea,ta));A.a.wx(this.Syc,u.a.substring(ma,ta,ma.length));H.AFrameworkApplication.fa.ka("ChromiumSpanIssueFixIsEnabled")&&F.a.Nj&&F.a.NFj&&" "===u.a.substring(ma,Ea,ta)&&Sys.UI.DomElement.addCssClass(this.hnb,"WhiteSpaceSpanElement");return Sys.UI.DomElement.getBounds(this.hnb)}VFf(la,ma){this.W8h(la,[ma])}W8h(la,ma){try{if(void 0!==la.ownerDocument.parentWindow){var Ea=
la.ownerDocument.parentWindow.frameElement;if(Ea&&("0"===Ea.frameBorder||"no"===Ea.frameBorder))for(la=0;la<ma.length;la++)ma[la].x+=2,ma[la].y+=2}}catch(ta){}}jGb(){this.rwc&&this.rwc.restore();this.rwc=null}kpb(la,ma){if(""!==ma){let Ea;if(this.NOb){if(Ea=this.Xjb["VE-"+ma])return la=new Sys.UI.Bounds(Ea.x,Ea.y,Ea.width,Ea.height)}else this.Xjb={},this.NOb=!0;Ea=Sys.UI.DomElement.getBounds(la);this.Xjb["VE-"+ma]=Ea;return la=new Sys.UI.Bounds(Ea.x,Ea.y,Ea.width,Ea.height)}return Sys.UI.DomElement.getBounds(la)}static get instance(){return X.Ja||
(X.Ja=new X(e.a.instance,h.a.instance.Ka("Common.IZoomManager"),H.AFrameworkApplication.fa,h.a.instance.resolve("Box4.TextMetricsApi.IMeasureBoundsUsingSpansStrategy"),h.a.instance.resolve("Box4.IRotatingCoordinateConverter"),h.a.instance.resolve("Box4.TextMetricsApi.ITextMetricsHelper")))}static Rra(la){return O.SelectionEditor.Rra(la)}}X.Ja=null;Object(J.a)(X,"TextMetrics",null,[]);var P=d(96);class ea{get ySa(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.Z6b)}get f3(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
P.a.MM)}get NUc(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.Ytk)}get UJj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.jBj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.iBj)||Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.gBj)}get dvg(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.dVd)}get nug(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.zSf)}}Object(J.a)(ea,"ATextMetricsElement",null,[426]);var ia=
d(31),ja=d(148);class C extends ea{constructor(la){super();this.$O=la}get htmlElement(){return this.$O}get Bja(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.aN)}get Hvb(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,ja.a.yV)}get DJj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.EDj)}get sGj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.uei)||Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.lBj)}get rGj(){return Sys.UI.DomElement.containsCssClass(this.htmlElement,
P.a.tei)||Sys.UI.DomElement.containsCssClass(this.htmlElement,P.a.kBj)}}Object(J.a)(C,"TextMetricsLeafElement",ea,[449,426]);var pa=d(51),Z=d(56);class qa extends ea{constructor(la){super();this.nmb=la;this.Gi=this.nmb.$a;this.HSb=Array(la.Ts.length);for(la=0;la<this.nmb.Ts.length;la++){const ma=new C(this.nmb.Ts[la]);this.HSb[la]=ma}}get C5(){return this.HSb}get paragraphId(){return this.Gi.id.toString()}get htmlElement(){return this.nmb.htmlElement}get Kha(){return this.nmb.Oc.Lh?this.nmb.$a.id.toString():
""}get textLength(){return ia.ParagraphReader.textLength(this.Gi)}get isRtl(){return Z.OutlineElementReader.jm(pa.OutlineElementNavigator.EA(this.Gi))}get Xr(){return ia.ParagraphReader.Vd(this.Gi)&&!this.Gi.iW}get characterData(){return this.Gi.characterData}get h2f(){return this.HSb.length?this.HSb[this.HSb.length-1]:null}static X4a(la){return new qa(la)}}Object(J.a)(qa,"TextMetricsParagraphElement",ea,[425,426]);var ya=d(49),Ka=d(32);d.d(V,"a",function(){return Da});class Da{static get uXb(){return Da.pA||
(Da.pA=h.a.instance.qb("Box4.CharacterPointConverter"))}static get Tc(){return e.a.instance}static Bt(la,ma,Ea=!1,ta=!1,Ga=!1,oa=null){la=qa.X4a(la);return X.instance.Bt(la,ma,Ea,ta,Ga,oa)}static jpc(la,ma,Ea){return X.instance.jpc(la,ma,Ea)}static kpb(la,ma){return X.instance.kpb(la,ma)}static kZ(la,ma,Ea,ta,Ga=!1,oa=!1){ma=qa.X4a(ma);return X.instance.kZ(la,ma,Ea,ta,Ga,oa)}static hOa(la,ma=null){la=qa.X4a(la);return X.instance.hOa(la,ma)}static zca(){X.instance.zca()}static T4a(la,ma,Ea,ta=null){let Ga=
null,oa=null;try{const sa=qa.X4a(la);let Ha=null;Ga=Da.Tc.Kp(Ka.a.J0i);(Ha=X.instance.T4a(sa,ma,Ea,ta))&&(oa=Da.uXb?Da.uXb.aFl(Ha,la.$a):ya.a.OOa(Ha.CpBegin,Ha.CpEnd,Ha.IsEop,la.$a))}catch(sa){Da.Tc.Tb(r.a.MDl,{["Reason"]:m.a.oPi,["ExceptionMessage"]:sa.message,["ExceptionCallstack"]:sa.stack}),oa=null}Ga&&Ga.end();return oa}static WCa(la,ma,Ea=!1,ta=!0){la=qa.X4a(la);return X.instance.WCa(la,ma,Ea,ta).htmlElement}static X5b(la,ma){return X.instance.X5b(la,ma)}}Da.pA=null;Object(J.a)(Da,"TextMetricsAdapter",
null,[])},307:function(J,V,d){J=d(0);var h=d(376),e=d(25),m=d(1193);const r=(A,w)=>{const y={};let u=null;switch(A){case 0:u="HtmlProcessor";var D=w.a;null!=D&&(y.SessionID=D);var F=w.b.toString();null!=F&&(y.Elements=F);var I=w.c.toString();null!=I&&(y.PrunedElements=I);var H=w.d.toString();null!=H&&(y.TransparentElements=H);var L=w.e.toString();null!=L&&(y.VoidElements=L);var E=w.f.toString();null!=E&&(y.UnknownElements=E);break;case 1:u="WordConverter";var aa=w.a;null!=aa&&(y.SessionID=aa);var Q=
w.b.toString();null!=Q&&(y.BulletsConverted=Q);var O=w.c.toString();null!=O&&(y.NumberedConverted=O);break;case 2:u="FormattingSteward";var T=w.a;null!=T&&(y.SourceApp=T);var K=w.b;null!=K&&(y.Browser=K);var X=w.c;null!=X&&(y.OperationId=X);var P=w.d.toString();null!=P&&(y.Lang=P);var ea=w.e.toString();null!=ea&&(y.TextDir=ea);var ia=w.f.toString();null!=ia&&(y.Bold=ia);var ja=w.g.toString();null!=ja&&(y.Math=ja);var C=w.h.toString();null!=C&&(y.Italics=C);var pa=w.i.toString();null!=pa&&(y.Underline=
pa);var Z=w.j.toString();null!=Z&&(y.Strikethrough=Z);var qa=w.k.toString();null!=qa&&(y.Subscript=qa);var ya=w.l.toString();null!=ya&&(y.Superscript=ya);var Ka=w.m.toString();null!=Ka&&(y.Fontsize=Ka);var Da=w.n.toString();null!=Da&&(y.Fontface=Da);var la=w.o.toString();null!=la&&(y.GrowFontsize=la);var ma=w.p.toString();null!=ma&&(y.ShrinkFontsize=ma);var Ea=w.q.toString();null!=Ea&&(y.FontColor=Ea);var ta=w.r.toString();null!=ta&&(y.FontHighlight=ta);var Ga=w.s.toString();null!=Ga&&(y.ParagraphStyle=
Ga);var oa=w.t.toString();null!=oa&&(y.TextAlign=oa);var sa=w.u.toString();null!=sa&&(y.TextIndent=sa);var Ha=w.v.toString();null!=Ha&&(y.MarginLeft=Ha);var bb=w.w.toString();null!=bb&&(y.ParagraphSpaceBefore=bb);var Ya=w.x.toString();null!=Ya&&(y.ParagraphSpaceAfter=Ya);var ua=w.y.toString();null!=ua&&(y.LineSpace=ua);var Ma=w.z.toString();null!=Ma&&(y.CellShadingColor=Ma);break;case 3:u="SemanticEvents";var Ca=w.a;null!=Ca&&(y.SessionID=Ca);var Va=w.b.toString();null!=Va&&(y.Text=Va);var Za=w.c.toString();
null!=Za&&(y.LineBreak=Za);var Db=w.d.toString();null!=Db&&(y.Image=Db);var Lb=w.e.toString();null!=Lb&&(y.File=Lb);var yb=w.f.toString();null!=yb&&(y.FormattingChange=yb);var Bc=w.g.toString();null!=Bc&&(y.Anchor=Bc);var tb=w.h.toString();null!=tb&&(y.Paragraph=tb);var Mb=w.i.toString();null!=Mb&&(y.Math=Mb);var Hb=w.j.toString();null!=Hb&&(y.List=Hb);var vb=w.k.toString();null!=vb&&(y.ListItem=vb);var Xb=w.l.toString();null!=Xb&&(y.RenderAugmentation=Xb);var Uc=w.m.toString();null!=Uc&&(y.Span=
Uc);break;case 4:u="SemanticTableEvents";var hb=w.a;null!=hb&&(y.SessionID=hb);var Zb=w.b.toString();null!=Zb&&(y.Tables=Zb);var Fc=w.c.toString();null!=Fc&&(y.TableRow=Fc);var ob=w.d.toString();null!=ob&&(y.TableCell=ob);var ac=w.e.toString();null!=ac&&(y.TablePart=ac);break;case 5:u="HtmlEvents";var pb=w.a;null!=pb&&(y.OperationId=pb);var nb=w.b;null!=nb&&(y.SourceApp=nb);var Tb=w.c;null!=Tb&&(y.Browser=Tb);var Ub=null==w.d?null:w.d.toString();null!=Ub&&(y.Text=Ub);var hc=null==w.e?null:w.e.toString();
null!=hc&&(y.A=hc);var Wb=null==w.f?null:w.f.toString();null!=Wb&&(y.Abbr=Wb);var fd=null==w.g?null:w.g.toString();null!=fd&&(y.Acronym=fd);var fc=null==w.h?null:w.h.toString();null!=fc&&(y.Address=fc);var bc=null==w.i?null:w.i.toString();null!=bc&&(y.Applet=bc);var cc=null==w.j?null:w.j.toString();null!=cc&&(y.Area=cc);var kb=null==w.k?null:w.k.toString();null!=kb&&(y.B=kb);var ab=null==w.l?null:w.l.toString();null!=ab&&(y.Base=ab);var Pb=null==w.m?null:w.m.toString();null!=Pb&&(y.Basefont=Pb);var rc=
null==w.n?null:w.n.toString();null!=rc&&(y.Bdo=rc);var ic=null==w.o?null:w.o.toString();null!=ic&&(y.Big=ic);var md=null==w.p?null:w.p.toString();null!=md&&(y.Blockquote=md);var Fd=null==w.q?null:w.q.toString();null!=Fd&&(y.Body=Fd);var ne=null==w.r?null:w.r.toString();null!=ne&&(y.Br=ne);var ud=null==w.s?null:w.s.toString();null!=ud&&(y.Button=ud);var gb=null==w.t?null:w.t.toString();null!=gb&&(y.Caption=gb);var Vb=null==w.u?null:w.u.toString();null!=Vb&&(y.Center=Vb);var Lc=null==w.v?null:w.v.toString();
null!=Lc&&(y.Cite=Lc);var Xc=null==w.w?null:w.w.toString();null!=Xc&&(y.Code=Xc);var Ib=null==w.x?null:w.x.toString();null!=Ib&&(y.Col=Ib);var gc=null==w.y?null:w.y.toString();null!=gc&&(y.Colgroup=gc);var Fb=null==w.z?null:w.z.toString();null!=Fb&&(y.Dd=Fb);var fb=null==w.ba?null:w.ba.toString();null!=fb&&(y.Del=fb);var Pc=null==w.bb?null:w.bb.toString();null!=Pc&&(y.Dfn=Pc);var dd=null==w.bc?null:w.bc.toString();null!=dd&&(y.Dir=dd);var kd=null==w.bd?null:w.bd.toString();null!=kd&&(y.Div=kd);var Td=
null==w.be?null:w.be.toString();null!=Td&&(y.Dl=Td);var ce=null==w.bf?null:w.bf.toString();null!=ce&&(y.Dt=ce);var ld=null==w.bg?null:w.bg.toString();null!=ld&&(y.Em=ld);var ad=null==w.bh?null:w.bh.toString();null!=ad&&(y.Fieldset=ad);var Yf=null==w.bi?null:w.bi.toString();null!=Yf&&(y.Font=Yf);var Xd=null==w.bj?null:w.bj.toString();null!=Xd&&(y.Form=Xd);var fg=null==w.bk?null:w.bk.toString();null!=fg&&(y.Frame=fg);var ue=null==w.bl?null:w.bl.toString();null!=ue&&(y.Frameset=ue);var Sa=null==w.bm?
null:w.bm.toString();null!=Sa&&(y.H=Sa);var rb=null==w.bn?null:w.bn.toString();null!=rb&&(y.Head=rb);var pc=null==w.bo?null:w.bo.toString();null!=pc&&(y.Hr=pc);var cd=null==w.bp?null:w.bp.toString();null!=cd&&(y.Html=cd);var zd=null==w.bq?null:w.bq.toString();null!=zd&&(y.I=zd);var wd=null==w.br?null:w.br.toString();null!=wd&&(y.Iframe=wd);var Oa=null==w.bs?null:w.bs.toString();null!=Oa&&(y.Img=Oa);var jb=null==w.bt?null:w.bt.toString();null!=jb&&(y.Input=jb);var qc=null==w.bu?null:w.bu.toString();
null!=qc&&(y.Ins=qc);var ib=null==w.bv?null:w.bv.toString();null!=ib&&(y.Isindex=ib);var Cb=null==w.bw?null:w.bw.toString();null!=Cb&&(y.Kbd=Cb);var yc=null==w.bx?null:w.bx.toString();null!=yc&&(y.Label=yc);var gd=null==w.by?null:w.by.toString();null!=gd&&(y.Legend=gd);var od=null==w.bz?null:w.bz.toString();null!=od&&(y.Li=od);var Mc=null==w.ca?null:w.ca.toString();null!=Mc&&(y.Link=Mc);var Rd=null==w.cb?null:w.cb.toString();null!=Rd&&(y.Map=Rd);var ye=null==w.cc?null:w.cc.toString();null!=ye&&(y.Math=
ye);var oe=null==w.cd?null:w.cd.toString();null!=oe&&(y.Menu=oe);var Bb=null==w.ce?null:w.ce.toString();null!=Bb&&(y.Meta=Bb);var Ff=null==w.cf?null:w.cf.toString();null!=Ff&&(y.Noframes=Ff);var pg=null==w.cg?null:w.cg.toString();null!=pg&&(y.Noscript=pg);var xf=null==w.ch?null:w.ch.toString();null!=xf&&(y.Object=xf);var qe=null==w.ci?null:w.ci.toString();null!=qe&&(y.Ol=qe);var Oh=null==w.cj?null:w.cj.toString();null!=Oh&&(y.Optgroup=Oh);var Cf=null==w.ck?null:w.ck.toString();null!=Cf&&(y.Option=
Cf);var Bg=null==w.cl?null:w.cl.toString();null!=Bg&&(y.P=Bg);var Gf=null==w.cm?null:w.cm.toString();null!=Gf&&(y.Param=Gf);var dh=null==w.cn?null:w.cn.toString();null!=dh&&(y.Pre=dh);var qg=null==w.co?null:w.co.toString();null!=qg&&(y.Q=qg);var Pf=null==w.cp?null:w.cp.toString();null!=Pf&&(y.S=Pf);var qd=null==w.cq?null:w.cq.toString();null!=qd&&(y.Samp=qd);var Tf=null==w.cr?null:w.cr.toString();null!=Tf&&(y.Script=Tf);var Pg=null==w.cs?null:w.cs.toString();null!=Pg&&(y.Select=Pg);var Ee=null==w.ct?
null:w.ct.toString();null!=Ee&&(y.Small=Ee);var xe=null==w.cu?null:w.cu.toString();null!=xe&&(y.Span=xe);var jh=null==w.cv?null:w.cv.toString();null!=jh&&(y.Strike=jh);var yg=null==w.cw?null:w.cw.toString();null!=yg&&(y.Strong=yg);var xc=null==w.cx?null:w.cx.toString();null!=xc&&(y.Style=xc);var me=null==w.cy?null:w.cy.toString();null!=me&&(y.Sub=me);var Dd=null==w.cz?null:w.cz.toString();null!=Dd&&(y.Sup=Dd);var Qe=null==w.da?null:w.da.toString();null!=Qe&&(y.Tables=Qe);var tf=null==w.db?null:w.db.toString();
null!=tf&&(y.Tbody=tf);var Rb=null==w.dc?null:w.dc.toString();null!=Rb&&(y.Td=Rb);var Jc=null==w.dd?null:w.dd.toString();null!=Jc&&(y.Textarea=Jc);var Qc=null==w.de?null:w.de.toString();null!=Qc&&(y.Tfoot=Qc);var Ph=null==w.df?null:w.df.toString();null!=Ph&&(y.Th=Ph);var ng=null==w.dg?null:w.dg.toString();null!=ng&&(y.Thead=ng);var se=null==w.dh?null:w.dh.toString();null!=se&&(y.Title=se);var pf=null==w.di?null:w.di.toString();null!=pf&&(y.Tr=pf);var $d=null==w.dj?null:w.dj.toString();null!=$d&&(y.Tt=
$d);var Ye=null==w.dk?null:w.dk.toString();null!=Ye&&(y.U=Ye);var Kd=null==w.dl?null:w.dl.toString();null!=Kd&&(y.Ul=Kd);var Yd=null==w.dm?null:w.dm.toString();null!=Yd&&(y.Var=Yd);var Zf=null==w.dn?null:w.dn.toString();null!=Zf&&(y.Unknown=Zf);break;case 6:u="List";var ef=w.a;null!=ef&&(y.SessionID=ef);var Ke=w.b.toString();null!=Ke&&(y.MaxListLevel=Ke)}y.Table=u;return Sys.Serialization.JavaScriptSerializer.serialize(y)};d.d(V,"a",function(){return v});class v{static get i8(){null==v.d1a&&(v.d1a=
!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("UsageEditorLoggingIsDisabled"));return v.d1a}static get Vwg(){null==v.Vwd&&(v.Vwd=!!e.AFrameworkApplication.fa&&e.AFrameworkApplication.fa.ka("WordUsageEditorLoggingIsEnabled"));return v.Vwd}static oQ(A){h.ULS.sendTraceTag(5822145,307,50,A)}static Jbg(A){const w={};w.a=A;w.b=0;w.c=0;w.d=0;w.e=0;w.f=0;return w}static LYj(A){v.i8||v.oQ(r(0,A))}static x4d(A){const w={};w.a=A;w.b=0;w.c=0;return w}static I_j(A){v.i8||v.oQ(r(1,A))}static Ibg(A,
w){const y={};y.c=m.a[A];y.a=w;return y}static KYj(A,w){v.Vwg&&A&&(A.b=w,v.oQ(r(5,A)))}static wfg(A){const w={};w.a=A;w.b=0;w.c=0;w.d=0;w.e=0;w.f=0;w.g=0;w.h=0;w.i=0;w.j=0;w.k=0;w.l=0;w.m=0;return w}static WZj(A){v.i8||v.oQ(r(3,A))}static xfg(A){const w={};w.a=A;w.b=0;w.c=0;w.d=0;w.e=0;return w}static XZj(A){v.i8||v.oQ(r(4,A))}static r0d(A,w){const y={};y.b=m.a[A];y.c=w;y.d=0;y.e=0;y.f=0;y.g=0;y.h=0;y.i=0;y.j=0;y.k=0;y.l=0;y.m=0;y.n=0;y.o=0;y.p=0;y.q=0;y.r=0;y.s=0;y.t=0;y.w=0;y.x=0;y.y=0;y.z=0;y.u=
0;y.v=0;return y}static zYj(A,w){v.Vwg&&A&&(A.a=w,v.oQ(r(2,A)))}static Q8i(A){const w={};w.a=A;w.b=-1;return w}static dZj(A){!v.i8&&A&&0<=A.b&&v.oQ(r(6,A))}}v.d1a=null;v.Vwd=null;Object(J.a)(v,"UsageEditor",null,[])},322:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.baa=1E5;Object(J.a)(h,"ViewConstants",null,[])},323:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ge=this.Zf=this.$d=this.Lf=0}cRi(e){return e.ge<this.Zf&&this.ge<e.Zf&&e.$d<this.Lf&&
this.$d<e.Lf}bsb(e){return e.ge>=this.ge&&e.Zf<=this.Zf&&e.$d>=this.$d&&e.Lf<=this.Lf}VQi(e,m){return e>=this.$5f&&e<=this.Gde&&m>=this.T5f&&m<=this.yde}$Pa(){return 0>=this.oO||0>=this.TQ}equals(e){return e.ge===this.ge&&e.Zf===this.Zf&&e.$d===this.$d&&e.Lf===this.Lf}clone(){return Object.assign(new h,{ge:this.ge,Zf:this.Zf,$d:this.$d,Lf:this.Lf})}toString(){return String.format("CellRange, rowFirst:{0}, rowLim:{1}, colFirst:{2}, colLim:{3}",this.ge,this.Zf,this.$d,this.Lf)}get oO(){return this.Zf-
this.ge}get TQ(){return this.Lf-this.$d}get Gde(){return this.Zf-1}get yde(){return this.Lf-1}get $5f(){return this.ge}get T5f(){return this.$d}}Object(J.a)(h,"CellRange",null,[])},324:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.uZ="data-copystatus";h.LOa="data-copyfailedreason";h.Np="data-clipservice-ccpid";h.version="data-clipservice-version";h.location="data-clipservice-location";h.BE="data-clipservice-dc";h.type="data-clipservice-type";h.bwe="data-clipservice-param";h.count=
"data-clipservice-count";h.ODa="data-clipservice-cut";h.MDa="data-clipservice-isEmptyPlaceholder";h.client="data-clipservice-client";h.Ypi="data-clipboardasbytes-url";h.bGh="wacserver";h.sessionId="data-SessionId";h.fhb="data-ShapeIds";h.slideId="data-SlideId";h.timeStamp="data-TimeStamp";h.fxj="data-willexpire";h.Kng="ClipboardAsImage";h.kz="data-pkey";Object(J.a)(h,"ClipServiceConstants",null,[])},338:function(J,V,d){J=d(0);var h=d(376),e=d(268),m=d(651),r=d(27),v=d(513);class A{}Object(J.a)(A,
"ProofingFeedbackLoopRequestObject",null,[]);var w=d(514),y=d(32),u=d(512);d.d(V,"a",function(){return D});class D extends m.a{constructor(F,I,H,L,E=null){super(I);this.kaa=F;this.KQh=H;this.UUh=L;this.z7e=!1;this.eb=E;this.errorType=1===(this.kaa.CritiqueActions&1)?0:1}get proofingType(){return v.b(this.kaa)}get traceId(){return this.kaa.TraceId}get typeId(){return this.kaa.TypeId}get UM(){return this.kaa}get suggestions(){const F=[];if(this.kaa.Suggestions)for(const I of this.kaa.Suggestions)F.push(I.Text);
return F}get metadata(){const F=[];if(this.kaa.Metadata&&0<this.kaa.Metadata.length)for(const I of this.kaa.Metadata)I.Name&&I.Value&&F.push(I);return F}dKa(F,I=0){this.Ssf.track(()=>Object.assign(new w.a,{E:2,T:this.proofingType,A:F,I,G:this.typeId}));if(this.KQh){var H=e.a.oe(this.lcid);let L="";H?L=H.name:h.ULS.sendTraceTag(36316369,375,50,"Lcid results in null CultureInfo: [LCID: {0}]",this.lcid);H=null;h.ULS.sendTraceTag(39416218,375,50,"Sending proofing context with feedback loop API");H=Object.assign(new A,
{AppId:u.a[r.App.mode]+"_online",TraceId:this.traceId,LanguageId:L,CritiqueTypeId:this.typeId,EventId:this.Qck(F),FlaggedText:this.token,SuggestionText:this.Sgj(F),PreContextBegin:this.k$,PostContextEnd:this.XHa,OriginalText:this.originalText,Suggestions:this.suggestions,CritiquePriority:this.kaa.Priority,Metadata:this.kaa.Metadata});14!==H.EventId&&this.UUh.S0k(H)}}Qck(F){switch(F){case y.a.Asa:return 0;case y.a.h7d:return 1;case y.a.nPa:return 3;case y.a.Mxa:return 4;case y.a.Nxa:return 5;case y.a.Oxa:return 6;
case y.a.UYb:return 13;default:return 14}}Sgj(F){switch(F){case y.a.Mxa:return this.suggestions[0];case y.a.Nxa:return this.suggestions[1];case y.a.Oxa:return this.suggestions[2];case y.a.MJa:return this.suggestions[3];case y.a.NJa:return this.suggestions[4];default:return""}}get mDa(){return this.z7e}set mDa(F){this.z7e=F}}Object(J.a)(D,"EditorServiceErrorDetails",m.a,[658,659])},339:function(J,V,d){var h=d(290),e=d(775),m=d(1195),r=d(45),v=d(221),A=d(25);J=d(0);class w{constructor(){this.g=this.b=
0;this.hex=null;this.r=0}}Object(J.a)(w,"RecentColor",null,[]);var y=d(239),u=d(258),D=d(224),F=d(262),I=d(1013),H=d(529),L=d(26);d.d(V,"f",function(){return E});d.d(V,"e",function(){return aa});d.d(V,"d",function(){return Q});d.d(V,"c",function(){return O});d.d(V,"g",function(){return T});d.d(V,"b",function(){return K});d.d(V,"a",function(){return X});d.d(V,"h",function(){return P});const E=(ia,ja,C,pa,Z,qa,ya)=>aa(ia,ja,C,pa,Z,qa,ya,!1),aa=(ia,ja,C,pa,Z,qa,ya,Ka)=>{ja=Object.assign(new h.a,{Id:ja,
ControlsId:C,Title:ResourceStrings.L_ThemeFontColor,ControlList:[]});pa=Object.assign(new e.a,{Id:pa,ExternalId:Z,McuExternalId:String.format("{0}MCU",Z),McuLayout:!0,Command:qa,Width:10});if(ia)if(Z=[],1===ya||2===ya){Ka=(new I.a).w1i(ia);({themeColors:ia,kyh:ya}=ea(Ka,ia));for(var Da=0;6>Da;Da++)for(var la=0;la<ia.length;la++){qa=Z;C=qa.push;var ma=void 0,Ea=void 0;ma=Ka;var ta=ia[la][Da];Ea=ia[la][0];var Ga=ya[la],oa=Da,sa=la;ta=r.a.Sv(ta.r,2)+r.a.Sv(ta.g,2)+r.a.Sv(ta.b,2);({mFc:ma,SJb:Ea}=ma.j_d(Ea,
ta,Ga,oa,sa));ta=Object.assign(new m.a,{Color:"#"+ma,DisplayColor:"#"+ta,Alt:Ea});C.call(qa,ta)}}else for(Ka=(new I.a).d$f(ia,Ka),{themeColors:ia,kyh:ya}=ea(Ka,ia),Da=0;6>Da;Da++)for(la=0;la<ia.length;la++)qa=Z,C=qa.push,ma=Ka,ta=ia[la][Da],Ea=ia[la][0],Ga=ya[la],oa=Da,sa=la,ta=r.a.Sv(ta.r,2)+r.a.Sv(ta.g,2)+r.a.Sv(ta.b,2),{mFc:Ea,SJb:ma}=ma.j_d(Ea,ta,Ga,oa,sa),{CXk:Ea,p_k:ma,SJb:ta}={CXk:ta,p_k:Ea,SJb:ma},ta=Object.assign(new m.a,{Color:ma,DisplayColor:"#"+Ea,Alt:ta}),C.call(qa,ta);else Z=null;pa.Colors=
Z;Array.add(ja.ControlList,pa);return ja},Q=(ia,ja,C,pa,Z,qa)=>{ia=Object.assign(new h.a,{Id:ia,ControlsId:ja,Title:ResourceStrings.L_StandardFontColor,ControlList:[]});C=Object.assign(new e.a,{Id:C,ExternalId:pa,Command:Z,Width:10,Colors:[]});qa?(C.Colors.push(Object.assign(new m.a,{Color:"0000C0",Alt:r.a.je(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),C.Colors.push(Object.assign(new m.a,{Color:"0000FF",Alt:r.a.je(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),C.Colors.push(Object.assign(new m.a,
{Color:"00C0FF",Alt:r.a.je(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),C.Colors.push(Object.assign(new m.a,{Color:"00FFFF",Alt:r.a.je(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),C.Colors.push(Object.assign(new m.a,{Color:"50D092",Alt:r.a.je(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),C.Colors.push(Object.assign(new m.a,{Color:"50B000",Alt:r.a.je(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),C.Colors.push(Object.assign(new m.a,
{Color:"F0B000",Alt:r.a.je(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),C.Colors.push(Object.assign(new m.a,{Color:"C07000",Alt:r.a.je(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),C.Colors.push(Object.assign(new m.a,{Color:"602000",Alt:r.a.je(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),C.Colors.push(Object.assign(new m.a,{Color:"A03070",Alt:r.a.je(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"}))):(C.Colors.push(Object.assign(new m.a,
{Color:"#C00000",Alt:r.a.je(ResourceStrings.L_FontColorDarkRed),DisplayColor:"#C00000"})),C.Colors.push(Object.assign(new m.a,{Color:"#FF0000",Alt:r.a.je(ResourceStrings.L_FontColorRed),DisplayColor:"#FF0000"})),C.Colors.push(Object.assign(new m.a,{Color:"#FFC000",Alt:r.a.je(ResourceStrings.L_FontColorOrange),DisplayColor:"#FFC000"})),C.Colors.push(Object.assign(new m.a,{Color:"#FFFF00",Alt:r.a.je(ResourceStrings.L_FontColorYellow),DisplayColor:"#FFFF00"})),C.Colors.push(Object.assign(new m.a,{Color:"#92D050",
Alt:r.a.je(ResourceStrings.L_FontColorLightGreen),DisplayColor:"#92D050"})),C.Colors.push(Object.assign(new m.a,{Color:"#00B050",Alt:r.a.je(ResourceStrings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),C.Colors.push(Object.assign(new m.a,{Color:"#00B0F0",Alt:r.a.je(ResourceStrings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),C.Colors.push(Object.assign(new m.a,{Color:"#0070C0",Alt:r.a.je(ResourceStrings.L_FontColorBlue),DisplayColor:"#0070C0"})),C.Colors.push(Object.assign(new m.a,{Color:"#002060",
Alt:r.a.je(ResourceStrings.L_FontColorDarkBlue),DisplayColor:"#002060"})),C.Colors.push(Object.assign(new m.a,{Color:"#7030A0",Alt:r.a.je(ResourceStrings.L_FontColorPurple),DisplayColor:"#7030A0"})));Array.add(ia.ControlList,C);return ia},O=(ia,ja,C,pa,Z,qa,ya)=>{ja=Object.assign(new h.a,{Id:ja,ControlsId:C,Title:ResourceStrings.L_RecentColors,ControlList:[]});pa=Object.assign(new e.a,{Id:pa,ExternalId:Z,Command:qa,Width:10,Colors:[]});if(ya)for(ya=0;ia&&ya<ia.length&&ia[ya];ya++)Z=ia[ya],pa.Colors.push(Object.assign(new m.a,
{Color:Z.hex,Alt:r.a.je(Z.hex),DisplayColor:Z.hex}));else for(ya=0;ia&&ya<ia.length&&ia[ya];ya++)Z=ia[ya],pa.Colors.push(Object.assign(new m.a,{Color:"#"+Z.hex,Alt:r.a.je("#"+Z.hex),DisplayColor:"#"+Z.hex}));Array.add(ja.ControlList,pa);return ja},T=(ia,ja)=>{if(!ja)return ia;var C=new w;C.hex=ja;const pa=[];let Z=0;pa[Z++]=C;for(C=0;ia&&C<ia.length&&10>C&&10>Z&&ia[C];C++)ia[C].hex!==ja&&(pa[Z++]=ia[C]);return pa},K=(ia,ja,C,pa,Z,qa,ya,Ka)=>{ia=Object.assign(new h.a,{Id:ia,ControlsId:ja,DisplayMode:"Menu16",
ControlList:[]});C=Object.assign(new v.a,{Command:C,LabelText:pa,Image16by16:A.AFrameworkApplication.gm,Image16by16Class:ya,Id:Z,ExternalId:qa,KeyTip:Ka});Array.add(ia.ControlList,C);return ia},X=(ia,ja,C,pa,Z,qa,ya,Ka)=>{ia=Object.assign(new h.a,{Id:ia,ControlsId:ja,DisplayMode:"Menu16",ControlList:[]});C=Object.assign(new v.a,{Command:C,LabelText:pa,Image16by16:A.AFrameworkApplication.gm,Image16by16Class:ya,Id:Z,ExternalId:qa,KeyTip:Ka});Array.add(ia.ControlList,C);return ia},P=(ia,ja,C)=>{for(let ma=
0;ma<ia.MenuSectionList.length;ma++){var pa=ia.MenuSectionList[ma],Z=pa.ControlList;if(Z&&0<Z.length&&(Z=Z[0]))if(ja)if(pa.Id===H.a.themeColors&&C){var qa=D.i(ja.UC)||"";pa=C;var ya=Z.Colors,Ka="#";if(ya&&ya.length)if(r.a.Va(qa))L.a.J(523531867,820,10,"selectedFontColor should not be empty in FindSelectedThemeColor");else for(var Da=0;Da<ya.length;Da++){var la=ya[Da].Color;if(!r.a.Va(la)&&(la=(la=u.a.parse(ya[Da].Color))?la.boc():F.SchemeColor.parse(ya[Da].Color),pa&&la&&la.cFe(pa)&&la.rsa&&(la=D.i(la.vP),
la.toLowerCase()===qa.toLowerCase()))){Ka=ya[Da].Color;break}}pa=Ka;Z.SelectedColorId=pa}else{ya=D.i(D.g(ja.UC))||"";pa=Z.Colors;qa="#";if(pa&&pa.length)if(r.a.Va(ya))L.a.J(523531868,820,10,"selectedFontColor should not be empty in FindSelectedStandardColor");else for(Ka=0;Ka<pa.length;Ka++)if(Da=pa[Ka].DisplayColor,!r.a.Va(Da)&&Da.replace("#","").toLowerCase()===ya.toLowerCase()){qa=pa[Ka].Color;break}pa=qa;Z.SelectedColorId=pa}else Z.SelectedColorId="#"}},ea=(ia,ja)=>{let C;C=Array(10);C[0]=ia.GK(y.Color.Oi(ja.PresetSchemeColorMapping.Background1));
C[1]=ia.GK(y.Color.Oi(ja.PresetSchemeColorMapping.Text1));C[2]=ia.GK(y.Color.Oi(ja.PresetSchemeColorMapping.Background2));C[3]=ia.GK(y.Color.Oi(ja.PresetSchemeColorMapping.Text2));C[4]=ia.GK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent1));C[5]=ia.GK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent2));C[6]=ia.GK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent3));C[7]=ia.GK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent4));C[8]=ia.GK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent5));C[9]=ia.GK(y.Color.Oi(ja.PresetSchemeColorMapping.Accent6));
ia=Array(10);ia[0]=ResourceStrings.l_ThemeLabel1;ia[1]=ResourceStrings.l_ThemeLabel2;ia[2]=ResourceStrings.l_ThemeLabel3;ia[3]=ResourceStrings.l_ThemeLabel4;ia[4]=ResourceStrings.l_ThemeLabel5;ia[5]=ResourceStrings.l_ThemeLabel6;ia[6]=ResourceStrings.l_ThemeLabel7;ia[7]=ResourceStrings.l_ThemeLabel8;ia[8]=ResourceStrings.l_ThemeLabel9;ia[9]=ResourceStrings.l_ThemeLabel10;return{themeColors:C,kyh:ia}}},369:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.TRf="CU";h.Csi="CS";h.zsi=
"CE";h.qde="KP";h.tnl="TI";h.XYj="L";Object(J.a)(h,"CharacterBlockTrackerKeys",null,[])},370:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(33);class e{constructor(m,r){this.Flight=this.BaseDocQuerySignature=null;this.BaseDocQuerySignature=m;this.Flight=r}serialize(){return h.c([this.Ok(),this])}}Object(J.a)(e,"ACommonHandlerRequest",null,[])},375:function(J,V,d){J=d(0);var h=d(54),e=d(25),m=d(45),r=d(106),v=d(1193),A=d(13),w=d(1166),y;(function(ia){ia[ia.none=0]="none";ia[ia.noSystemClipboardAccess=
1]="noSystemClipboardAccess";ia[ia.cutCopyDisallowed=2]="cutCopyDisallowed";ia[ia.pasteDisallowed=3]="pasteDisallowed";ia[ia.invalidPasteContext=4]="invalidPasteContext";ia[ia.invalidCcpOperation=5]="invalidCcpOperation";ia[ia.multiSlideCcpDisallowed=6]="multiSlideCcpDisallowed";ia[ia.pastedHtmlLengthExceeded=7]="pastedHtmlLengthExceeded";ia[ia.tooManyShapesAfterPaste=8]="tooManyShapesAfterPaste";ia[ia.noShapesPasted=9]="noShapesPasted";ia[ia.invalidImagePasteArgs=10]="invalidImagePasteArgs";ia[ia.invalidClipboardData=
11]="invalidClipboardData";ia[ia.invalidCopiedShapes=12]="invalidCopiedShapes";ia[ia.invalidCopiedSlides=13]="invalidCopiedSlides";ia[ia.invalidHtmlContent=14]="invalidHtmlContent";ia[ia.textEditFailed=15]="textEditFailed";ia[ia.clipServiceDataInvalid=16]="clipServiceDataInvalid";ia[ia.crossDCPasteDisallowed=17]="crossDCPasteDisallowed";ia[ia.imageTooLarge=18]="imageTooLarge";ia[ia.noAvailablePasteHandler=19]="noAvailablePasteHandler";ia[ia.noAvailableCutCopyHandler=20]="noAvailableCutCopyHandler";
ia[ia.cutCopyHandlerFailed=21]="cutCopyHandlerFailed";ia[ia.systemClipboardCopyFailed=22]="systemClipboardCopyFailed";ia[ia.copyObjectEmpty=23]="copyObjectEmpty";ia[ia.tableInvalid=24]="tableInvalid";ia[ia.copyObjectHasDeferredContent=25]="copyObjectHasDeferredContent";ia[ia.userOffline=26]="userOffline";ia[ia.picklingPasteFailedDueToMaxSizeLimit=27]="picklingPasteFailedDueToMaxSizeLimit";ia[ia.picklingInvalidCopyData=28]="picklingInvalidCopyData";ia[ia.systemClipboardAccessFailure=29]="systemClipboardAccessFailure";
ia[ia.chunkUploaderFailure=30]="chunkUploaderFailure";ia[ia.pasteCancelledByUser=31]="pasteCancelledByUser";ia[ia.cutCopyIRMRestricted=32]="cutCopyIRMRestricted"})(y||(y={}));Object(J.b)("CcpFailure",y);var u=d(919),D=d(111),F=d(26),I=d(324),H;(function(ia){ia[ia.none=0]="none";ia[ia.text=1]="text";ia[ia.shape=2]="shape";ia[ia.textbox=3]="textbox";ia[ia.normalShape=4]="normalShape";ia[ia.image=5]="image";ia[ia.table=6]="table";ia[ia.chart=7]="chart";ia[ia.video=8]="video";ia[ia.list=9]="list";ia[ia.ink=
10]="ink";ia[ia.addin=11]="addin";ia[ia.smartArt=12]="smartArt";ia[ia.group=13]="group";ia[ia.placeholder=14]="placeholder";ia[ia.line=15]="line";ia[ia.activeX=16]="activeX";ia[ia.oleObject=17]="oleObject";ia[ia.media=18]="media";ia[ia.slide=19]="slide";ia[ia.mixed=20]="mixed"})(H||(H={}));Object(J.b)("ClipboardContentType",H);var L;(function(ia){ia[ia.keyboard=0]="keyboard";ia[ia.menu=1]="menu";ia[ia.floatie=2]="floatie";ia[ia.ribbon=3]="ribbon"})(L||(L={}));Object(J.b)("ClipboardMethod",L);var E;
(function(ia){ia[ia.copy=0]="copy";ia[ia.cut=1]="cut";ia[ia.paste=2]="paste"})(E||(E={}));Object(J.b)("ClipboardOperation",E);var aa;(function(ia){ia[ia.other=0]="other";ia[ia.pptOnline=1]="pptOnline";ia[ia.pptOnlineSameSession=2]="pptOnlineSameSession";ia[ia.pptOnlineCrossSession=3]="pptOnlineCrossSession";ia[ia.wordOnline=4]="wordOnline";ia[ia.xlOnline=5]="xlOnline";ia[ia.oneNoteOnline=6]="oneNoteOnline";ia[ia.pptWin32=7]="pptWin32";ia[ia.wordWin32=8]="wordWin32";ia[ia.xlWin32=9]="xlWin32";ia[ia.oneNoteWin32=
10]="oneNoteWin32";ia[ia.googleDocs=11]="googleDocs";ia[ia.pptDesktop=12]="pptDesktop";ia[ia.pptDesktopWithDataUpload=13]="pptDesktopWithDataUpload"})(aa||(aa={}));Object(J.b)("ClipboardSource",aa);class Q{constructor(){this.data={};this.xKf=!1;this.Mhb=null}}Object(J.a)(Q,"TelemetryEntry",null,[]);var O=d(1011),T=d(422),K=d(41),X=d(28),P=d(67);d.d(V,"a",function(){return ea});class ea{constructor(ia,ja,C,pa,Z,qa,ya,Ka,Da,la,ma,Ea){this.zFg=h.a.zy;this.kQg=this.JJg=this.wZc="";this.MQ=ia;this.hT=
ja;this.wv=new P.a;this.J9=new P.a;pa.GBc(Object(A.a)(this,this.yye,"onRevisionProcessedOnServer"));Z.$pa(Object(A.a)(this,this.Qpl,"trackSlideCcpRevision"));qa.$pa(Object(A.a)(this,this.Ppl,"trackShapeCcpRevision"));ya.$pa(Object(A.a)(this,this.Mpl,"trackParagraphCcpRevision"));Ka.$pa(Object(A.a)(this,this.Lpl,"trackNotesCcpRevision"));Da&&Da.$pa(Object(A.a)(this,this.Npl,"trackPresentationCcpRevision"));this.sQ=ma;this.ia=la;this.xEg=C.Tjd;this.tv=Ea;if(ia=e.AFrameworkApplication.$c)this.JJg=Object(w.a)(String,
ia.Host)||"",this.kQg=Object(w.a)(String,ia.Ring)||"",this.wZc=Object(w.a)(String,ia.WACDatacenter)||""}bxb(ia){return this.wv.Jb(ia)}oB(ia,ja){m.a.Va(ja)||(this.bxb(ja)?ea.contentType in this.wv.ga(ja).data&&!this.uGj(ja,ia)||this.tV(ea.contentType,H[ia],ja):F.a.J(50393377,826,15,"attempted to update clipboard telemetry before tracking started "+ja))}B7a(ia,ja){if(!this.wv.Jb(ia))return null;let C=null;if(this.wv.ga(ia)&&!(ja in this.wv.ga(ia).data))switch(ja){case ea.contentType:C="none";break;
case ea.source:C="other"}return C?C:this.wv.ga(ia).data[ja].toString()}v$f(ia){return this.B7a(ia,ea.contentType)}W9f(ia){return this.B7a(ia,ea.source)}b1i(ia){return this.B7a(ia,ea.operation)}S5b(ia){return"xlOnline"===this.W9f(ia)&&"chart"===this.v$f(ia)}JVc(ia){return"slide"===this.v$f(ia)&&"paste"===this.b1i(ia)}mvk(ia){const ja=H;for(let pa in ja){var C=ja[pa];if(pa.toLowerCase()===ia.toLowerCase())return C}return 0}nvk(ia){const ja=aa;for(let pa in ja){var C=ja[pa];if(pa.toLowerCase()===ia.toLowerCase())return C}return 0}uGj(ia,
ja){ia=this.mvk(this.wv.ga(ia).data[ea.contentType].toString());return ja>ia}vw(ia,ja){m.a.Va(ja)||(this.bxb(ja)?ea.source in this.wv.ga(ja).data&&!this.eQj(ja,ia)||this.tV(ea.source,aa[ia],ja):F.a.J(50393379,826,15,"attempted to update clipboard telemetry before tracking started "+ja))}eQj(ia,ja){ia=this.nvk(this.wv.ga(ia).data[ea.source].toString());return ja>ia}Wh(ia,ja,C){m.a.Va(C)||this.tV(ia,ja,C)}FO(ia,ja,C){const pa=K.a.Eb&&!m.a.Va(K.a.Eb.actionName)?K.a.Eb.actionName:C,Z=r.a.create().toString();
this.wv.$(Z,Object.assign(new Q,{Mhb:this.MQ.zi("UserAction","ClipboardTelemetry")}));this.tV(ea.qOf,Z,Z);this.tV(ea.actionName,pa,Z);this.tV("ActualActionName",C,Z);this.tV("CcpOperation",E[ia],Z);this.tV("CcpMethod",L[ja],Z);this.tV("CcpBrowser",this.zFg,Z);this.tV("CcpHost",this.JJg,Z);this.tV("CcpDatacenter",this.wZc,Z);this.tV("CcpRing",this.kQg,Z);F.a.J(51179864,826,50,"start telemetry tracking. browser: {0}; CcpCorrelation: {1}; method: {2}; operation: {3}; actionName: {4}",this.zFg,Z,L[ja],
E[ia],pa);return Z}Eg(ia,ja,C=0){if(m.a.Va(ja))F.a.J(51478666,826,15,"attempted to end telemetry tracking for empty correlation");else if(m.a.Va(ja)||!this.bxb(ja))F.a.J(51478669,826,15,"attempted to end telemetry tracking for invalid correlation id: {0}",ja);else{var pa=this.wv.ga(ja);this.tV("CcpTotalMs",pa.Mhb.Kq.toString(),ja);this.tV(ea.rOf,ia.toString(),ja);0!==C&&(this.tV("CcpFailureReason",y[C],ja),this.S5b(ja)?16===C?this.sQ.nxa(ResourceStrings.l_CopyErrorCalloutTitle,ResourceStrings.l_CopyErrorCalloutMessage,
!1,null,!1,null,0,0,null,null,!0,ea.Jpb):(ia=Object.assign(new T.a(!0),{Sb:ja}),this.sQ.nxa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,X.a.lTf,X.a.vQd,null,ia,!0,ea.Jpb)):25===C&&(F.a.J(523298057,826,15,"Attempted to paste deferred content/slide on another deck with correlation: {0}",ja),this.sQ.nxa(ResourceStrings.l_DeferredContentPasteDialogTitle,
ResourceStrings.l_DeferredContentPasteDialogMessage,!1,null,!1,null,0,0,null,null,!1,ea.Jpb)));F.a.J(50733397,826,50,D.c(pa.data));this.S5b(ja)||this.JVc(ja)||this.wv.remove(ja)}}a8k(ia,ja){m.a.Va(ja)||(this.vw(0,ja),this.Moh(ia,ja,0))}Moh(ia,ja,C){if(ia){if(C>=O.a.tDc)throw Error.create(String.format("Exceeds the maximum recursions ({0}).",O.a.tDc));if(1===ia.nodeType){for(var pa=ia.firstChild;pa;)this.Moh(pa,ja,C+1),pa=pa.nextSibling;this.KLe(ia,ja)}}}KLe(ia,ja){const {ClipboardHelper:C}=d(698);
if(!m.a.Va(ja))if(!this.bxb(ja))F.a.J(50393415,826,15,"attempted to update clipboard telemetry before tracking started "+ja);else if(ia)if("head"===ia.tagName.toLowerCase()){var pa=this.hT.w3f(ia);m.a.Va(pa)||this.J7k(pa,ja)}else{pa=0;var Z=ia.getAttribute(I.a.sessionId);Z?pa=C.Syg(Z.toString())?2:3:ia.getAttribute(u.a.CWf)?pa=5:ia.getAttribute(u.a.DWf)||ia.getAttribute(u.a.HWf)?pa=1:ia.id&&ia.id.startsWith&&ia.id.startsWith(u.a.Iig)&&(pa=11);if(ia.className&&ia.className.split)for(const qa of ia.className.split(" "))if(qa.startsWith(h.a.iVb)&&
qa.length===h.a.iVb.length+1&&(ia=parseInt(m.a.substring(qa,qa.length-1,qa.length)),isNaN(ia)||this.tV("CcpSourceBrowser",v.a[ia],ja)),0===pa)if(qa.startsWith(u.a.J7g))pa=1;else if(qa.startsWith(u.a.E3g))pa=6;else if(qa.startsWith(u.a.xGh))pa=4;else if(qa===u.a.tWg||qa===u.a.uWg)pa=8,this.oB(9,ja);0!==pa&&this.vw(pa,ja)}}J7k(ia,ja){switch(ia){case "PowerPoint.Slide":this.vw(7,ja);break;case "Word.Document":this.vw(8,ja);break;case "Excel.Sheet":this.vw(9,ja);break;case "OneNote.File":this.vw(10,ja)}}tV(ia,
ja,C){this.wv.Jb(C)&&(this.wv.ga(C).data[ia]=ja)}yye(ia,ja){ja.o$&&!m.a.Va(ja.o$.Id)&&this.J9.Jb(ja.o$.Id)&&this.b1f(ja.o$.Id,!ja.o$.Error,ja.o$.Error?ja.o$.Error.Code:0)}Qpl(ia,ja){this.ooc(C=>{let pa=null;if(C=Object(w.a)(120,C.node))pa=C.Sb,C.Sb=null;return pa},ja)}Ppl(ia,ja){this.ooc(C=>{let pa=null;if(C=Object(w.a)(4,C.node))pa=C.Sb,C.Sb=null;return pa},ja)}Mpl(ia,ja){this.ooc(C=>{let pa=null;if(C=Object(w.a)(5,C.node))pa=C.Sb,C.Sb=null;return pa},ja)}Lpl(ia,ja){this.ooc(C=>{let pa=null;if(C=
Object(w.a)(1002,C.node))pa=C.Sb,C.Sb=null;return pa},ja)}Npl(ia,ja){this.ooc(C=>{let pa=null;if(C=Object(w.a)(526,C.node))pa=C.Sb,C.Sb=null;return pa},ja)}ooc(ia,ja){ja.revisionId&&ja.node&&(ia=ia(ja),m.a.Va(ia)||this.Yuh(ja.revisionId.toString(),ia))}Yuh(ia,ja){m.a.Va(ia)||m.a.Va(ja)||this.J9.$(ia,ja)}b1f(ia,ja,C){if(!m.a.Va(ia)&&this.J9.Jb(ia)){this.xEg&&"pptDesktopWithDataUpload"===this.W9f(this.J9.ga(ia))&&this.tv.oVd();var pa={};pa[ea.qOf]=this.J9.ga(ia);pa[ea.rOf]=ja;pa[ea.$pi]=C;this.S5b(this.J9.ga(ia))?
(pa[ea.source]="xlOnline",pa[ea.contentType]="chart",0!==C&&(ja=Object.assign(new T.a(!0),{Sb:this.J9.ga(ia)}),this.sQ.nxa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteErrorCalloutMessage,!0,CommonUIStrings.l_CalloutNotificationPButtonLabel,!0,CommonUIStrings.l_CalloutNotificationSButtonLabel,X.a.lTf,X.a.vQd,null,ja,!0,ea.Jpb))):433===C?(this.JVc(this.J9.ga(ia))&&this.ia.processAction(X.a.WM,2),this.sQ.nxa(ResourceStrings.l_CopyPasteErrorCalloutTitle,ResourceStrings.l_CopyPasteLargeDataErrorCalloutMessage,
!1,null,!1,null,0,0,null,null,!0,ea.Jpb)):434===C&&(this.JVc(this.J9.ga(ia))&&(this.xEg?this.ia.processAction(X.a.fTd,2):this.ia.processAction(X.a.WM,2)),this.sQ.nxa(ResourceStrings.l_SomethingWentWrongCalloutTitle,ResourceStrings.errorTitle_PasteSlideFailed,!1,null,!1,null,0,0,null,null,!0,ea.Jpb));F.a.J(50733400,826,50,D.c(pa));(this.S5b(this.J9.ga(ia))||this.JVc(this.J9.ga(ia)))&&this.wv.remove(this.J9.ga(ia));this.J9.remove(ia)}}mFj(ia){return!m.a.Va(ia)&&this.wv.Jb(ia)?this.wv.ga(ia).xKf:!1}jdc(ia){m.a.Va(ia)||
(this.bxb(ia)?this.wv.ga(ia).xKf=!0:F.a.J(595206346,826,15,"attempted to update clipboard telemetry before tracking started "+ia))}}ea.source="CcpSource";ea.contentType="CcpContentType";ea.operation="CcpOperation";ea.rOf="CcpSuccess";ea.actionName="ActionName";ea.Jpb=20;ea.qOf="CcpCorrelation";ea.$wi="CcpCopyIframeContent";ea.pQf="ClipServiceThrottled";ea.pOf="data-corr-id";ea.Np="CcpId";ea.$pi="ClipServiceFailureReason";Object(J.a)(ea,"ClipboardTelemetry",null,[1102])},426:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);class h{constructor(){this.body=this.contextId=this.revId=this.source=this.id=null}}Object(J.a)(h,"Item",null,[])},427:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.open="open";h.refresh="refresh";h.GIe="saveAs";h.translate="translate";h.modeSwitch="modeSwitch";h.WAi="createNew";h.convert="convert";Object(J.a)(h,"ReasonList",null,[])},428:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.func=this.outputSchema=this.inputSchema=
this.name=null}}Object(J.a)(h,"Lambda",null,[725])},429:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.wmc="SlideTextTile";h.BMe="ShapeTextTile";Object(J.a)(h,"AugmentationSchemas",null,[])},430:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d(25);class h{static ub(){}static m0(e,m,r,v,A){return 1===r?32:h.HEk(e,A)?32:8}static GG(e,m,r,v,A){return 1===r?32:h.eik(e,A)?32:8}static eik(e,m){const r=h.HLh[e.toString()];if(void 0===r||null===r)return!1;r(e,m);return!0}static HEk(e,
m){const r=h.KLh[e.toString()];if(void 0===r||null===r)return!1;r(e,m);return!0}}h.HLh={};h.KLh={};Object(J.a)(h,"DialogCuiControlActor",null,[])},431:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.description=this.title=this.yP=this.j0=null}}Object(J.a)(h,"CpContentDetails",null,[542])},432:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(106);class e{constructor(){this.BGf=!1;this.sessionId=this.sQf=null;this.y4a=e.QYi()}static QYi(){return"CID"+
h.a.create().toString()}static ctg(m){return m&&m.length?m.startsWith("CID")&&h.a.isValid(m.substring(3,m.length))?!0:!1:!1}}Object(J.a)(e,"InternalClipboardObject",null,[])},433:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(432);class h extends d.a{constructor(e){super();this.Ed=e}get sxg(){return!this.Ed||!this.Ed.isConnected}get id(){return this.Ed.id}get isConnected(){return this.Ed.isConnected}}Object(J.a)(h,"InternalClipboardSlide",d.a,[])},434:function(J,V,d){d.d(V,"a",function(){return e});
var h=d(104);const e=(m,r,v)=>{const A=new h.StandardDialog;A.yd=0;A.DO(m,r,v);return A}},448:function(J,V,d){J=d(0);var h=d(376),e=d(13),m=d(25),r=d(177),v=d(73),A=d(65),w=d(169),y=d(100),u=d(168);d(72);class D{constructor(){this.secondActionButtonProps=this.firstActionButtonProps=this.messageTitle=this.message=null;this.isMultiline=!1;this.messageBarType=0;this.closeable=!1;this.messageBarIconProps=this.linkProps=this.dismissButtonAriaLabel=this.onDismiss=null}}Object(J.a)(D,"MessageBarProps",null,
[]);class F{constructor(T,K){this.onExecute=this.label=this.type=null;this.label=T;this.type="AppButtonProps";this.onExecute=K}}Object(J.a)(F,"AppButtonProps",null,[]);var I=d(141),H=d(767),L=d(133),E=d(213),aa=d(106),Q=d(35);d.d(V,"a",function(){return O});class O{constructor(T,K,X){this._message=this.AB=null;this.Zwd=this.ikb=!1;this.Nqd=0;this.rga="";this.FR=0;this.DE=this.qR=this.poa=this.n6=this.r1a=this.TLb=this.SLb=this.RLb=this.QLb=this.FM=this.W5=this.Gpa=this.OLa=null;this.akb=this.$jb=
!1;this.rZe=this.grd="";this.erd=!1;this.sZe=this.krd="";this.ird=!1;this.jrd=this.frd=null;this.IPb=!1;this.$ef=this.Slb="";this.q1a=null;this.QOb=this.B8e=!1;this.dBa=this.i2=this.uca=this.$O=this.businessBar=null;this.errorCode=0;this.FGf=this.visible=!1;this.title=T;this.message=K;this.p4b=X;this.id=0;this.image=1;this.Xae=!0;this.QJf=5}get htmlElement(){return this.$O}get Xae(){return this.Zwd}set Xae(T){this.Zwd=T}get QJf(){return this.Nqd}set QJf(T){this.Nqd=T}get title(){return this.AB}set title(T){this.AB!==
T&&(this.AB=T,this.Gpa&&(this.Gpa.innerText=this.AB))}get message(){return this._message}set message(T){this._message!==T&&(this._message=T,this.W5&&(this.W5.innerText=this._message))}get image(){return this.FR}set image(T){this.FR=T;4!==this.FR&&(this.uca="")}get oDa(){return this.rga}set oDa(T){this.rga=T}get closeable(){return this.ikb}set closeable(T){this.ikb!==T&&(this.ikb=T,this.poa&&(this.poa.style.display=this.ikb?"table-cell":"none"))}get Qic(){return m.AFrameworkApplication.fa.ka("ReactBusinessBarIsEnabled")}get KAl(){return m.AFrameworkApplication.fa.ka("Fluent2StyleIsEnabled")}addButton(T,
K,X,P=!1){this.grd=T;this.frd=K;this.$jb=!0;this.rZe=X;this.erd=P}ZHd(T,K){this.krd=T;this.jrd=K;this.akb=!0;this.sZe="";this.ird=!1}HDf(T,K){this.Slb=T;this.q1a=K;this.IPb=!0}ZBi(){var T=E.a.sCa(m.AFrameworkApplication.fa.Ga("VNextStyleOptOutCookieName"),!1);T=this.KAl&&!T;this.$O=document.createElement("div");this.htmlElement.className=String.format("{0} {1} {2}",O.qZe,O.pVh,T?O.m_h:"");this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.dBa&&null!==this.dBa&&(this.htmlElement.id=this.dBa);
T=()=>{I.UISurfaces.z9i().then(K=>{this.businessBar.Gbe||(K.initializeMessageBarInStore(),this.businessBar.Gbe=!0);const X=Object.assign(new D,{message:this._message,messageTitle:this.AB,isMultiline:this.Zwd,messageBarType:this.Nqd});if(this.ikb){X.closeable=!0;var P=this._message+". "+CommonUIStrings.l_DialogClose;this.AB&&(P=this.AB+". "+P);X.dismissButtonAriaLabel=P;X.onDismiss=()=>{this.UOd(this)}}4===this.FR&&(X.messageBarIconProps={["iconName"]:this.uca});this.IPb&&(X.linkProps={["type"]:"AppLinkProps",
["text"]:this.Slb,["handler"]:{["href"]:this.$ef,["target"]:"_blank"}},this.q1a&&(P=Object(e.a)(this,this.Wnk,"onMessageBarLinkClicked"),X.linkProps.handler=P));this.$jb&&(X.firstActionButtonProps=new F(this.grd,()=>{this.Lhi(this)}));this.akb&&(X.secondActionButtonProps=new F(this.krd,()=>{this.Nhi(this)}));K.createNewMessageBarWithCallback?K.createNewMessageBarWithCallback(this.htmlElement,X,()=>{m.AFrameworkApplication.Aa.Fq()}):K.createNewMessageBar(this.htmlElement,X);return null}).catch(()=>
{h.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API");return null})};r.a.get_instance().isCompleted(7)?T():r.a.get_instance().gk(7,T);this.p4b&&(m.AFrameworkApplication.Aa.my.ob(A.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick")),m.AFrameworkApplication.Aa.TF.fU(A.a.wl,this.htmlElement,Object(e.a)(this,this.Gwe,"onBodyKeyUp"),this),this.B8e&&!this.QOb&&(m.AFrameworkApplication.Aa.I$.ob(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.QOb=
!0));return this.htmlElement}createElement(){m.AFrameworkApplication.DN("Microsoft.Office.Web.SessionSettings.IWacWordReactBusinessBarSettings");if(this.Qic)return this.ZBi();this.$O=document.createElement("div");this.htmlElement.className=O.qZe;this.htmlElement.setAttribute("UNSELECTABLE","on");void 0!==this.dBa&&null!==this.dBa&&(this.htmlElement.id=this.dBa);this.OLa=null;if(0!==this.FR){this.OLa=document.createElement("span");this.OLa.className="WACBusinessBarIcon";this.htmlElement.appendChild(this.OLa);
var T=null;let K=null;switch(this.FR){case 2:T=O.pNh;K=CommonUIStrings.l_DialogError;break;case 1:T=O.y_h;K=CommonUIStrings.l_DialogWarning;break;case 3:T=O.wPh;K=CommonUIStrings.l_DialogInfo;break;case 4:T=this.uca,K=this.rga}this.OLa.title=K;this.OLa.setAttribute(L.a.Ye,L.a.PIf);this.OLa.appendChild(v.createClusteredImage(24,24,T,O.mPh,!0,""))}T=aa.a.create().toString();this.FM=document.createElement("div");this.FM.id="BBTitleAndBody"+T;this.FM.className=O.yKh;this.FM.tabIndex=0;this.AB&&(this.Gpa=
document.createElement("p"),this.Gpa.innerText=this.AB,this.Gpa.className=O.zKh+" UIFontBold",this.Gpa.id="BBTitle"+T,this.Gpa.setAttribute("UNSELECTABLE","on"),this.FM.setAttribute(L.a.W1,this.Gpa.id),this.FM.appendChild(this.Gpa));this.W5=document.createElement("p");this.W5.className=O.tKh;this.W5.innerText=this._message;this.W5.id="BBBody"+T;this.W5.setAttribute("UNSELECTABLE","on");this.W5.style.width="100%";this.FM.setAttribute(L.a.kqa,this.W5.id);this.$jb&&this.WCf(this.W5,this.rZe);this.akb&&
this.WCf(this.W5,this.sZe);this.FM.appendChild(this.W5);T=document.createElement("div");T.setAttribute(L.a.Ye,L.a.NKd);T.appendChild(this.FM);this.htmlElement.appendChild(T);this.$jb&&(this.RLb=document.createElement("span"),this.QLb=document.createElement("button"),this.TTf(this.RLb,this.QLb,this.grd,Object(e.a)(this,this.ILf,"buttonOneClickHandler")));this.akb&&(this.TLb=document.createElement("span"),this.SLb=document.createElement("button"),this.TTf(this.TLb,this.SLb,this.krd,Object(e.a)(this,
this.JLf,"buttonTwoClickHandler")));this.IPb&&(this.r1a=document.createElement("span"),this.r1a.className=O.xKh,this.n6=document.createElement("a"),this.n6.className=H.a.wKh,this.n6.innerText=this.Slb,this.q1a?(this.n6.tabIndex=0,m.AFrameworkApplication.Aa.my.fU(A.a.click,this.n6,Object(e.a)(this,this.jCg,"linkClickHandler"),this),m.AFrameworkApplication.Aa.TF.fU(A.a.wl,this.n6,Object(e.a)(this,this.y0g,"onLinkKeyUp"),this)):(this.n6.href=this.$ef,this.n6.target="_blank"),this.r1a.appendChild(this.n6),
this.htmlElement.appendChild(this.r1a));m.AFrameworkApplication.Aa.my.ob(A.a.click,this.htmlElement,Object(e.a)(this,this.onClick,"onClick"));m.AFrameworkApplication.Aa.TF.fU(A.a.wl,this.FM,Object(e.a)(this,this.Gwe,"onBodyKeyUp"),this);this.B8e&&!this.QOb&&(m.AFrameworkApplication.Aa.I$.ob(this.htmlElement,Object(e.a)(this,this.onClick,"onClick"),null),this.QOb=!0);this.ikb&&(this.poa=document.createElement("span"),this.poa.className=O.bLh,this.qR=document.createElement("a"),this.qR.className=O.cLh,
this.qR.tabIndex=0,this.qR.title=CommonUIStrings.l_DialogClose,this.qR.setAttribute(L.a.Ye,L.a.hu),this.DE=v.createClusteredImage(16,16,O.dLh,"",!0,""),this.qR.appendChild(this.DE),this.poa.style.display="table-cell",this.poa.appendChild(this.qR),this.htmlElement.appendChild(this.poa),m.AFrameworkApplication.Aa.my.fU(A.a.click,this.qR,Object(e.a)(this,this.BZg,"onCloseClick"),this),m.AFrameworkApplication.Aa.TF.fU(A.a.wl,this.qR,Object(e.a)(this,this.CZg,"onCloseKeyUp"),this));return this.htmlElement}xdl(){this.FM&&
this.FM.setAttribute(L.a.pK,L.a.lqa)}WCf(T,K){if(K&&""!==K){var X=document.createElement("span");X.className=O.sWh;X.innerText=K;T.appendChild(X)}}TTf(T,K,X,P){T.className=O.vKh;K.setAttribute("type","button");K.className=O.uKh;K.innerText=X;T.appendChild(K);this.htmlElement.appendChild(T);m.AFrameworkApplication.Aa.my.fU(A.a.click,K,P,this)}Xhh(){this.Qic||(this.FM.style.whiteSpace="nowrap",this.closeable?this.poa.style.width="auto":this.IPb?this.r1a.style.width="auto":this.akb?this.TLb.style.width=
"auto":this.$jb?this.RLb.style.width="auto":this.FM.style.width="auto",this.htmlElement.clientWidth>this.businessBar.htmlElement.clientWidth?this.FM.style.whiteSpace="normal":this.closeable?this.poa.style.width="100%":this.IPb?this.r1a.style.width="100%":this.akb?this.TLb.style.width="100%":this.$jb?this.RLb.style.width="100%":this.FM.style.width="100%")}uUe(T,K){if(u.a.gDb()){var X={};X.WacSessionId=m.AFrameworkApplication.userSessionId;X.ActionName="BusinessBar"+T;X.InputMethod=K;h.ULS.sendTraceTag(35489761,
207,50,JSON.stringify(X))}}AW(T,K,X,P){this.uUe(T,X);u.a.cTa()&&y.c(K,!0,y.e,P,10)}ILf(T){this.frd(T.TC);this.AW("ButtonOne",Q.a.CLf,"Mouse",2);this.erd&&(this.AW("Close",Q.a.tpb,"Mouse_ButtonOne",2),this.close(T));return!0}Lhi(T){this.frd(T);this.AW("ButtonOne",Q.a.CLf,"Mouse",2);this.erd&&(this.AW("Close",Q.a.tpb,"Mouse_ButtonOne",2),this.UOd(T))}JLf(T){this.jrd(T.TC);this.AW("ButtonTwo",Q.a.DLf,"Mouse",2);this.ird&&(this.AW("Close",Q.a.tpb,"Mouse_ButtonTwo",2),this.close(T));return!0}Nhi(T){this.jrd(T);
this.AW("ButtonTwo",Q.a.DLf,"Mouse",2);this.ird&&(this.AW("Close",Q.a.tpb,"Mouse_ButtonTwo",2),this.UOd(T))}jCg(T){this.q1a(T.TC);this.AW("Link",Q.a.GLf,"Mouse",2);return!0}Wnk(){this.q1a(null)}y0g(T){return T.mc.keyCode!==w.a.lq||T.mc.altKey?!1:(this.q1a(T.TC),this.AW("Link",Q.a.GLf,"Keyboard",1),!0)}Gwe(T){return T.mc.keyCode===w.a.lq&&!T.mc.altKey&&this.p4b?(this.p4b(T.TC,T),this.AW("Invoke",Q.a.FLf,"Keyboard",1),!0):!1}dispose(){this.htmlElement&&(m.AFrameworkApplication.Aa.my.xb(A.a.click,this.htmlElement,
Object(e.a)(this,this.onClick,"onClick")),this.QOb&&m.AFrameworkApplication.Aa.I$.xb(this.htmlElement,Object(e.a)(this,this.onClick,"onClick")));this.qR&&(m.AFrameworkApplication.Aa.my.xb(A.a.click,this.qR,Object(e.a)(this,this.BZg,"onCloseClick")),m.AFrameworkApplication.Aa.TF.xb(A.a.wl,this.qR,Object(e.a)(this,this.CZg,"onCloseKeyUp")));this.QLb&&m.AFrameworkApplication.Aa.my.xb(A.a.click,this.QLb,Object(e.a)(this,this.ILf,"buttonOneClickHandler"));this.SLb&&m.AFrameworkApplication.Aa.my.xb(A.a.click,
this.SLb,Object(e.a)(this,this.JLf,"buttonTwoClickHandler"));this.n6&&this.q1a&&(m.AFrameworkApplication.Aa.my.xb(A.a.click,this.n6,Object(e.a)(this,this.jCg,"linkClickHandler")),m.AFrameworkApplication.Aa.TF.xb(A.a.wl,this.n6,Object(e.a)(this,this.y0g,"onLinkKeyUp")));this.FM&&m.AFrameworkApplication.Aa.TF.xb(A.a.wl,this.FM,Object(e.a)(this,this.Gwe,"onBodyKeyUp"));this.businessBar=this.qR=this.poa=this.DE=this.r1a=this.n6=this.TLb=this.SLb=this.RLb=this.QLb=this.FM=this.W5=this.$O=this.Gpa=this.OLa=
this.rga=null}onClick(T){this.AW("Invoke",Q.a.FLf,"Mouse",2);return!!this.p4b&&this.p4b(this,T)}BZg(T){this.AW("Close",Q.a.tpb,"Mouse",2);this.close(T);return!0}CZg(T){return T.mc.keyCode!==w.a.lq||T.mc.altKey?!1:(this.AW("Close",Q.a.tpb,"Keyboard",1),this.close(T),!0)}close(T){const K=T.TC;this.businessBar.removeEntry(K);this.Rsg(K,T.Wf)}Rsg(T,K){if(T.i2){const X=m.AFrameworkApplication.Ta;X.oq=10;X.LS=K;T.i2(T);X.oq=0;X.LS=0}}UOd(T){T&&this.businessBar&&(this.businessBar.removeEntry(T),this.Rsg(T,
0))}}O.qZe="WACBusinessBarEntry";O.zKh="WACBusinessBarTitle";O.tKh="WACBusinessBarBody";O.yKh="WACBusinessBarTitleBodyHolder";O.vKh="WACBusinessBarButtonHolder";O.uKh="WACBusinessBarButton";O.xKh="WACBusinessBarLinkHolder";O.cLh="WACBusinessBarClose";O.bLh="WACBusinessBarCloseHolder";O.dLh="BusinessBarClose_16x16x32";O.mPh="WACBusinessBarImage";O.sWh="WACScreenReaderOnly";O.pNh="CancelRequest_24x24x32";O.y_h="Risks_24x24x32";O.wPh="Info_24x24x32";O.pVh="ReactBusinessBarEntry";O.m_h="VNextBusinessBarEntry";
Object(J.a)(O,"BusinessBarEntry",null,[556,106])},453:function(J,V,d){J=d(0);var h=d(45),e=d(198),m=d(1174),r=d(1166),v=d(57);class A{constructor(){this.shapeType=this.Wte=this.KUg=this.kYg=this.jYg=0;this.Wq=this.Vp=this.Tp=this.wk=!1;this.RCc=null}}Object(J.a)(A,"ShapeProperties",null,[]);var w=d(26),y=d(41),u=d(103),D=d(208);d.d(V,"a",function(){return F});class F{constructor(I,H,L,E,aa,Q,O,T,K){this.xv=I;this.Dm=H;this.Ea=O;this.C$j=Q.Zbl;this.k9j=this.XBi();this.$p=L;this.nL=E;this.Ne=aa.Ma;
this.cX=Q.eta;this.l6j=Q.cya;this.Qb=K}U5g(I,H,L,E,aa,Q=null){if(H){var O=this.Ea.Y6a(L);O&&(Array.remove(L,O),Array.add(L,this.Ea.nr(O)));this.juh(L);var T=L.length;O=Array(T);E=this.ndg(H,E);for(var K=0;K<T;K++){var X=L[K],P=this.C$i(X,E);O[K]=Object.assign(new A,{jYg:P.x,kYg:P.y,KUg:X.Rx,Wte:X.KD,shapeType:X.shapeType,wk:X.wk,Tp:X.Tp||2===X.mediaType||1===X.mediaType,Vp:X.qd,Wq:X.Wq,RCc:""});O[K].wk&&(P=Object(r.a)(121,X.oc(this.Ne)),O[K].RCc=P?P.pPe:"",w.a.J(512500632,826,50,"PendingImage: {0}, State: {1}, HasImageId: {2}",
X.b6d,this.nL.kW(X),0<O[K].RCc.length))}K=H.Bb;X=H.ev();P=[];E=!0;var ea=I.pj===H.pj,ia=I.Cn===H.Cn,ja=!1;I!==H&&(ea?(ja=I.f8a||H.f8a,ia||(ja=I.Y7a||H.Y7a||ja),E=!ja):E=!1,E&&this.cX&&(I.hq!==H.hq||I.Kk!==H.Kk)&&(E=!1));for(var C=0;C<T;C++)this.Ybl(L[C])||(P.push(L[C]),E&&(E=this.Z$k(L[C],ia)));L=P;w.a.J(512500631,826,50,"{0}",{["LocalRenderEnabled"]:E,["SameSlide"]:I===H,["SameMaster"]:ea,["SameLayout"]:ia,["ThemeOverrides"]:ja});T=[];C=ja=ia=ea=P=!1;for(let pa=0;pa<L.length;pa++){const Z=O[pa];
let qa=this.Dm.hzi(K.cid,K.sid,Z.jYg,Z.kYg,Z.KUg,1>Z.Wte?1:Z.Wte,X+L[pa].get_zIndex(),I.id,L[pa],Z.shapeType,Z.wk,Z.RCc,E);h.a.Va(Q)||(qa.Sb=Q);T.push(qa);P=P||Z.wk;ea=ea||Z.Tp;ia=ia||Z.Vp;ja=ja||Z.Wq;C=C||this.l6j&&F.dNj(qa)}aa=F.Ehh(P,ea,ia,ja,C,aa);if(0<T.length&&(I=E?L:null,this.xv.B2(T,H,aa,I),E&&y.a.Eb)){if(I){H="";for(const pa of I)H+=this.Ea.p1b(pa)+",";y.a.Eb.Wa(u.a.Vwi,H);y.a.Eb.Wa(u.a.F9k,I.length.toString())}y.a.Eb.Oj=!0;y.a.Eb.hIb=!0}}}lEi(I,H,L,E,aa,Q){var O=this.ndg(I,L);L=[];const T=
H.kec,K=!!T&&!e.a.Va(T.hzg);Q=this.B$i(Q,O);for(O=0;O<H.objectCount;O++){const X=this.Dm.syi(I.cid,I.sid,Q.x,Q.y,aa);X.isEditable=K&&T.hzg[O];L.push(X)}0<L.length&&this.xv.B2(L,I,E)}B$i(I,H){const L=H*F.a7;H*=F.a7;let E=new v.a(L,H);I&&(E=this.Qb.hsa(I.clientWidth,I.clientHeight))&&(E.x+=L,E.y+=H);return E}Ybl(I){return I.fC&&this.C$j||!I.uug}Z$k(I,H){return I.b6d||this.nL.kW(I)||I.Sk&&I.hasText&&!H&&10!==I.Cj&&12!==I.Cj||I.Uq?!1:!0}juh(I){I.sort((H,L)=>H.get_zIndex()-L.get_zIndex())}RNj(I){return I?
this.k9j.contains(I):!1}ndg(I,H){if(!I)return 0;if(!H)return F.xii;let L,E;return H.$(L=I.Bb,(E=H.ga(L))+1),E}C$i(I,H){var L=this.$p.presentation;if(!L)throw Error.argumentNull("Presentation is null");let E=I.fz,aa=I.gz;I=L.Bfj(L.$B(I.slideId));L=Math.round(F.a7/I)*I;I=m.a.Ff(L,0);for(L=m.a.Ff(L,1);0<H;)E+=I,aa+=L,H--;return new v.a(E,aa)}Yrl(I){try{if(I&&I.clipboardData){const H=I.clipboardData.types;for(let L=0;L<H.length;L++){const E=I.clipboardData.getData(H[L]);if(this.AFj(E))return E}}}catch(H){}return null}AFj(I){return!!I&&
0<I.length&&this.SRj(I)}SRj(I){I=I.trim().toLowerCase();return I.startsWith("http:")||I.startsWith("https:")}L4k(I,H,L){I&&(I.setAttribute(F.hMf,H.toString()),I.setAttribute(F.gMf,L.toString()),I.setAttribute(F.iMf,"true"))}XBi(){const I=new D.a;I.add("param");I.add("map");I.add("area");I.add("script");I.add("noscript");I.add("col");I.add("colgroup");I.add("caption");I.add("head");I.add("title");I.add("link");I.add("meta");I.add("style");I.add("base");I.add("input");I.add("textarea");I.add("select");
I.add("option");I.add("optgroup");I.add("button");I.add("hr");return I}g7i(I){return this.QAh(I,F.hMf)}Z6i(I){return this.QAh(I,F.gMf)}HJj(I){return I?"true"===I.getAttribute(F.iMf):!1}Hrl(I){if(this.Azg(I)){const H=I.indexOf('"')+1,L=I.lastIndexOf('"');if(1<H&&L>H&&(I=I.slice(H,L),I.startsWith(F.Dii)))return I}return null}Azg(I){return!!I&&I.length>F.bji&&I.startsWith(F.Eii)}QAh(I,H){let L=0;this.HJj(I)&&(L=parseFloat(I.getAttribute(H)));return isNaN(L)?0:L}YMd(I){return this.ZMd(I).returnValue}ZMd(I){let H;
H=2;let L=0,E=0,aa=0,Q=0,O=0,T=0,K=0,X=0,P=0,ea=0,ia=0,ja=0,C=0,pa=0,Z=0,qa=0,ya=0;for(const Ka of I)Ka.qd?(H=2===H?6:20,L++):Ka.Pf?(H=2===H?12:20,E++):Ka.Wq?(H=2===H?7:20,aa++):Ka.Jf?(H=2===H?13:20,Q++):22===Ka.u2b?(H=2===H?10:20,O++):Ka.wk?(H=2===H?5:20,T++):Ka.Ny?(H=2===H?3:20,K++):Ka.q3?(H=2===H?14:20,Ka.fC&&P++,X++):Ka.Sk?(H=2===H?14:20,Ka.fC&&ia++,ea++):Ka.Ky?(H=2===H?15:20,ja++):Ka.hW?(H=2===H?16:20,C++):Ka.Tp?(H=2===H?18:20,pa++):Ka.Uq?(H=2===H?11:20,Z++):Ka.Kca?(H=2===H?17:20,qa++):(H=2===
H?4:20,ya++);return{returnValue:String.format("numTotalShapes={0}, numTables={1}, numSmartArt={2}, numCharts={3}, numGroups={4}, numInk={5}, numPictures={6}, numTextbox={7}, numTitlePlaceholder={8}, numEmptyTitlePlaceholder={9}, numNonTitlePlaceholder={10}, numEmptyNonTitlePlaceholder={11}, numLine={12}, numActiveX={13}, numMedia={14}, numAppForOffice={15}, numOleObject={16}, numNormalShape={17}",I.length,L,E,aa,Q,O,T,K,X,P,ea,ia,ja,C,pa,Z,qa,ya),contentType:H}}static q0k(I){for(const H of I)if(!H.uug||
H.isLocal)return!1;return!0}static dNj(I){return I&&4===I.cS?(!I.fill||!!I.fill.noFillField)&&(!I.lineStyle||!!I.lineStyle.noFillField):!1}static Ehh(I,H,L,E,aa,Q){return I||H||L||E||aa?Q:0}}F.iMf="data-from-ppt-online";F.hMf="data-image-width-mu";F.gMf="data-image-height-mu";F.Dii="data:image/";F.Eii="<img src=";F.bji=14;F.xii=1;F.a7=15;Object(J.a)(F,"CopyPasteUtility",null,[818])},454:function(J,V,d){J=d(0);var h=d(511),e=d(128);class m extends h.a{constructor(){super();this.nextId=this.prevId=
null;this.H_=Object.assign(new e.a,{T_:m.getTypeName(),B_:m.ul()})}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static ul(){return["AugLoop_Core_Operation"]}}Object(J.a)(m,"OperationWithSiblingContext",h.a,[]);d.d(V,"a",function(){return r});class r extends m{constructor(){super();this.H_=Object.assign(new e.a,{T_:r.getTypeName(),B_:r.ul()})}static getTypeName(){return"AugLoop_Core_AddOperation"}static ul(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}}
Object(J.a)(r,"AddOperation",m,[])},509:function(J,V,d){d.d(V,"a",function(){return r});J=d(0);var h=d(63),e=d(510),m=d(892);class r{GWb(v,A){if(1===v.nodeType&&A){var w=this.VV(A);v=this.B5f(v,w);this.sri(w,v,A)}}B5f(v,A){const {CombineHelper:w}=d(1117),y=[];let u=null;for(let F=0;F<v.childNodes.length;F++){var D=v.childNodes[F];3===D.nodeType?(u||(u=new w(v,F,A)),u.e4h(F)):(u&&(u.end(y,F-1),u=null),D=this.B5f(D,A),Array.addRange(y,D))}u&&u.end(y,v.childNodes.length-1);return y}sri(v,A,w){v=v.clone();
let y=!1;for(let u=A.length-1;0<=u;u--){const D=A[u].rri();y=v.merge(D)||y}y&&this.setSelection(v,w)}setSelection(v,A){A=h.a.ACa(A);A.setStart(v.start.element,v.start.offset);A.setEnd(v.end.element,v.end.offset)}VV(v){return(v=h.a.ACa(v))?Object.assign(new m.a,{start:Object.assign(new e.a,{element:v.startContainer,offset:v.startOffset}),end:Object.assign(new e.a,{element:v.endContainer,offset:v.endOffset})}):new m.a}}r.unused=-1;Object(J.a)(r,"TextNodeCombiner",null,[1414])},510:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);class h{constructor(){this.element=null;this.offset=0}clone(){return Object.assign(new h,{element:this.element,offset:this.offset})}merge(e){if(!e.element||this.element===e.element&&this.offset===e.offset)return!1;this.element=e.element;this.offset=e.offset;return!0}}Object(J.a)(h,"SelectionSide",null,[])},511:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(255);var h=d(128);class e extends V.a{constructor(){super();this.items=this.parentRevId=this.parentPath=
null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),B_:e.ul()})}static getTypeName(){return"AugLoop_Core_Operation"}static ul(){return[]}}Object(J.a)(e,"Operation",V.a,[])},512:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.none=0]="none";e[e.oneNote=1]="oneNote";e[e.word=2]="word";e[e.wordViewer=3]="wordViewer";e[e.powerPoint=4]="powerPoint"})(h||(h={}));Object(J.b)("AppMode",h)},513:function(J,V,d){d.d(V,"a",function(){return e});d.d(V,"b",function(){return m});
d.d(V,"c",function(){return r});const h=v=>{switch(v){case 1:return 5;case 2:return 4;case 3:return 3;case 5:return 2;case 4:return 1;default:return 0}},e=v=>h(r(v.Priority,v.Tag)),m=v=>r(v.Priority,v.Tag),r=(v,A)=>{switch(v){case 0:return 1;case 1:return 2;case 2:return A&1?5:3;case 3:return 4;default:return 0}}},514:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.C=this.T=this.E=0;this.F=null;this.I=this.A=0;this.G=null}}Object(J.a)(h,"ProofingTraceMetrics",null,
[])},515:function(J,V,d){d.d(V,"a",function(){return m});d.d(V,"b",function(){return r});d.d(V,"c",function(){return v});var h=d(25),e=d(516);const m=()=>{const A=h.AFrameworkApplication.Aa.jb.rm;return(3===A||1===A||2===A||4===A)&&h.AFrameworkApplication.fa.ka("PremiumUpsellIsEnabled")},r=(A,w,y,u=!1)=>{w=1===w;1===A&&(w=2===h.AFrameworkApplication.Aa.mode);return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",e.a[A],w?"Editor":"Viewer",u?"Dime":"Unknown",y?y:"dimedefault")},v=A=>{switch(A){case 3:return"OfficeOnlineWord";
case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}},516:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.unknown=0]="unknown";e[e.excel=1]="excel";e[e.powerPoint=2]="powerPoint";e[e.word=3]="word";e[e.oneNote=4]="oneNote";e[e.visio=5]="visio"})(h||(h={}));Object(J.b)("OfficeAppType",h)},517:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.uJf="AugEditorServiceTileCheckRequest";
h.vJf="AugEditorServiceTileCheckResponse";h.aMi="EditorServiceTileCheckRequest";h.HQf="Proofing.ProofingRequest";h.WOd="Proofing.ProofingResponse";Object(J.a)(h,"ProofingAugmentationSchemaNames",null,[])},518:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.slideId=null;this.B8g=this.vmc=0}}Object(J.a)(h,"SlidePresenceInfo",null,[])},519:function(J,V,d){d.d(V,"a",function(){return r});J=d(0);var h=d(376),e=d(1029),m=d(33);class r{execute(v,A,w=null){h.ULS.sendTraceTag(572846934,
380,50,"reqType:{0}",v.Ok());const y=new e.a,u=this.t7(v,A,w);u.continueWith(()=>{if(u.hm)y.UF(u.Wi);else if(u.Jn)y.R0();else{const D=u.result;if(D&&!D.succeeded&&D.Ui&&D.Ui.data&&5===u.result.Ui.data.status){const F=this.t7(v,A,w);F.continueWith(()=>{F.hm?y.UF(F.Wi):F.Jn?y.R0():y.jM(F.result)})}else y.jM(D)}});return y.task}t7(v,A,w){w=this.uej(w);return A(w,{"Content-Type":"application/json; charset=utf-8"},v.serialize())}uej(v){return v?String.format("{0}/{1}",v,"people.ashx"):"people.ashx"}static o5a(v){if(!v)return h.ULS.sendTraceTag(572846935,
380,10,"ResponseBodyTask from PeopleHandler is null"),null;try{return m.a(v)}catch(A){h.ULS.sendTraceTag(572846936,380,10,"Could not parse the response. Message: {0}",A.message)}return null}}Object(J.a)(r,"CommonHandlerRequestManager",null,[])},520:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(376);class e{equals(m,r){if(!m||!r)return!m&&!r;if(m.UserId!==r.UserId){if(!e.e_f(m.Provider)||!e.e_f(r.Provider))return!1;const A=m.UserId.startsWith(e.HTb);var v=r.UserId.startsWith(e.HTb);
if(A&&v){if(m.Provider!==r.Provider)return h.ULS.sendTraceTag(593368202,327,10,"Provider mismatch when both IDs are in AD format. Providers: {0} , {1}",m.Provider,r.Provider),!1;v=e.t3f(m.UserId);r=e.t3f(r.UserId);return!!v&&v===r}m=m.Email&&""!==m.Email?m.Email:A?e.Z5a(m.UserId):m.UserId;r=r.Email&&""!==r.Email?r.Email:v?e.Z5a(r.UserId):r.UserId;return!!m&&m===r}return m.Provider!==r.Provider?!1:m.Provider&&""!==m.Provider||m.UserId&&""!==m.UserId?!0:m.DisplayName===r.DisplayName}T2(){return 0}static e_f(m){return"O365"===
m||"AD"===m}static Z5a(m){if(!m.startsWith(e.HTb))return null;m=m.substr(e.HTb.length);const r=m.lastIndexOf("::");return-1===r?null:m.substr(0,r)}static t3f(m){if(!m.startsWith(e.HTb))return null;var r=m.lastIndexOf("::");if(-1===r)return null;r+=2;return r>=m.length?null:m.substr(r)}}e.HTb="S::";Object(J.a)(e,"CommentTaskPersonIdentityComparer",null,[135])},521:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.MessageId=e;this.SendTime=0;this.CorrelationId="";this.Values=
{}}}Object(J.a)(h,"CrossDocumentMessage",null,[])},522:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.additionalDataFields=this.otelEvent=null}}Object(J.a)(h,"OtelTelemetryEvent",null,[])},523:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m){this.previewControlIds=this.legacyControlId=this.populationProps=this.menuItemId=this.commandRevertId=this.commandPreviewId=this.queryCommandId=this.commandId=this.externalUxCommand=null;this.externalUxCommand=
e;this.commandId=m}}Object(J.a)(h,"CommandMetadata",null,[])},524:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(300);class h{}h.CommandValueId="CommandValueId";h.Description="Description";h.Image16by16Class=d.a.Uub;h.Image30by30Class=d.a.uwj;h.Image32by32Class=d.a.nDa;h.Image48by48Class=d.a.l7d;h.On="On";h.LabelText=d.a.labelText;h.Visible=d.a.visible;h.SourceControlId="SourceControlId";h.DisplayMode="DisplayMode";h.Alt=d.a.alt;Object(J.a)(h,"ToggleButtonCommandProperties",null,[])},
525:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.jv="InputMethod";h.ffa="ShouldCanvasTakeFocus";h.HBh="UILocation";Object(J.a)(h,"ReactRibbonConstants",null,[])},526:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{static get instance(){const {NewCustomEventFactory:e}=d(1090),{IECustomEventFactory:m}=d(1091);h.Ja||(h.Ja="function"===typeof window.CustomEvent?new e:new m);return h.Ja}}h.Ja=null;Object(J.a)(h,"CustomEventFactory",null,[])},527:function(J,V,d){d.d(V,
"a",function(){return e});d.d(V,"b",function(){return r});var h=d(8);d(1029);const e=A=>m(A),m=A=>new Promise((w,y)=>{A.continueWith(u=>{u.hm?y(u.Wi.message):u.Jn?y(h.a.uGc()):w(null)})}),r=A=>v(A),v=A=>new Promise((w,y)=>{A.continueWith(()=>{A.hm?y(A.Wi.message):A.Jn?y(h.a.uGc()):w(A.result)})})},528:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.fib=this.tca=this.oY=null;this.XUc=this.Wlc=!1;this.Wze=0;this.Sb=null;this.reset()}reset(){this.tca=[];this.oY=null;
this.fib=[];this.XUc=this.Wlc=!1;this.Wze=0;this.Sb=null}}Object(J.a)(h,"HtmlPasteContext",null,[])},529:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.themeColors="Theme Colors";Object(J.a)(h,"ReactColorConstants",null,[])},541:function(J,V,d){J=d(0);var h=d(376),e=d(343),m=d(55),r=d(65),v=d(169),A=d(90),w=d(25);d(13);var y=d(33),u=d(48),D=d(99);class F{constructor(){this.Ieb=this.S4=null;this.Yyh=0}}Object(J.a)(F,"CandidateManager",null,[]);var I=d(647),H=d(645),L=d(646);class E{constructor(){this.keyCode=
0;this.bDl=this.aDl=null}}Object(J.a)(E,"PredictionKeptState",null,[]);class aa{constructor(){this.values={}}Yng(Ga,oa,sa){Ga=this.ogg(Ga);Ga[oa]=oa in Ga?Ga[oa]+sa:sa}add(Ga,oa,sa){this.ogg(Ga)[oa]=sa}ga(Ga){return this.values[Ga]}$(Ga,oa){return this.values[Ga]=oa}mSf(Ga){return Ga in this.values?!0:!1}ogg(Ga){let oa;Ga in this.values?oa=this.values[Ga]:(oa={},this.values[Ga]=oa);return oa}}Object(J.a)(aa,"PredictionState",null,[]);class Q{constructor(){this.WordPredIsEnabled=!0;this.PredictionSeenCount=
0;this.PredictionAccepted=!1}}Object(J.a)(Q,"TypeAheadRoamingSettings",null,[]);var O=d(198),T=d(1166),K=d(17),X=d(896),P=d(648);d(898);var ea=d(897);class ia{constructor(Ga){this.Hqc=null;this.YC=Ga;Ga=m.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Jv;const oa=m.a.instance.resolve("Common.ISharedDependencyLoader");this.initialize(Ga,oa)}initialize(Ga,oa){const sa=new P.a;return Ga?oa?this.Hqc?this.Hqc:w.AFrameworkApplication.Aa.jb.pvg?this.Hqc=new Promise((Ha,bb)=>{const Ya=w.AFrameworkApplication.Jj("al",
2);oa.Cxb(Ya).continueWith(ua=>{ua.hm?(this.D0g(),bb(ua.Wi.message)):(this.Aog(sa),Ha({}))})}):this.Hqc=Ga.loadScript("al").then(()=>{this.Aog(sa)}).catch(Ha=>{this.D0g();return Promise.reject(Ha)}):Promise.reject("SharedDependencyLoader is null"):Promise.reject("DynamicScriptLoader is null")}Aog(Ga){ia.kS.LF(()=>{h.ULS.sendTraceTag(595091613,3010,50,"AugLoop TextPrediction Load success");const oa=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();let sa=w.AFrameworkApplication.fa.Ga("OfficeApplicationName")||
"";sa=sa.replace("Web","");Ga.appName=Ga.appName||sa;Ga.serviceUrl=Ga.serviceUrl||w.AFrameworkApplication.fa.Ga("AugLoopCloudALServiceUrl");Ga.appVersion=Ga.appVersion||w.AFrameworkApplication.fa.Ga("BuildVersion")||"";Ga.releaseAudienceGroup=Ga.releaseAudienceGroup||(w.AFrameworkApplication.$c?Object(T.a)(String,w.AFrameworkApplication.$c.AudienceGroup)||"":"");Ga.sessionId=Ga.sessionId||w.AFrameworkApplication.fa.Ga("SessionId")||"";Ga.uiLanguage=Ga.uiLanguage||w.AFrameworkApplication.uiCulture;
Ga.flights=this.x_i();Ga.initSession=Ga.initSession||!0;oa.initialize(Ga);oa.activateAnnotation(Object.assign(new X.a,{annotationType:ea.a.getTypeName(),handler:this.YC}))},"WordPredictionAL:Initialize")}D0g(){h.ULS.sendTraceTag(595091612,3010,50,"AugLoop TextPrediction Load Fail")}x_i(){var Ga=w.AFrameworkApplication.fa.Ga("FlightId"),oa=w.AFrameworkApplication.fa.XB("AugLoopFlightKeywordList");Ga=this.bTi(Ga,oa);oa="";0<Ga.length&&(oa=O.a.join(Ga,";"),h.ULS.sendTraceTag.apply(null,[595091610,3010,
50,"FlightCount: [{0}], flightIds: [{1}]",Ga.length].concat(Ga)));return oa}bTi(Ga,oa){const sa=new K.a;if(Ga&&""!==Ga&&oa&&0<oa.length){for(let Ha=0;Ha<oa.length;Ha++)oa[Ha]=oa[Ha].toLowerCase();Ga=Ga.toLowerCase().split(";");for(const Ha of Ga)O.a.any(oa,bb=>-1<Ha.indexOf(bb))&&sa.add(Ha)}return sa.toArray()}static get kS(){return e.a.instance}}Object(J.a)(ia,"WordPredictionAugLoopHandler",null,[842]);var ja=d(135),C=d(179),pa=d(124);class Z{constructor(Ga,oa,sa,Ha){this.pYb=null;this.LUg=Ga;this.W1k=
sa;this.zli=Ha;this.J1k=oa;this.wHc=Array(Ga);this.Ihh();this.Thh()}zxj(Ga,oa,sa){Ga>this.LUg-1||this.Xng(this.wHc[Ga],oa,sa)}s8a(Ga,oa){this.Xng(this.pYb,Ga,oa)}zHd(Ga,oa){this.pYb[Ga]=oa}flush(){Z.kS.LF(()=>{for(let Ga=0;Ga<this.wHc.length;Ga++){const oa=this.uZi(Ga);oa&&(oa.dataFields.push(Object.assign(new pa.a,{name:H.a.OO,int64:Ga})),ja.a.sendActivityEvent(oa))}this.Ihh()},"WPT:F")}RVi(){Z.kS.LF(()=>{const Ga=this.tZi();Ga&&ja.a.sendActivityEvent(Ga);this.Thh()},"WPT:FSD")}MVi(Ga){Z.kS.LF(()=>
{const oa=this.sZi(Ga);oa&&ja.a.sendActivityEvent(oa)},"WPT:FCD")}tZi(){const Ga=this.F1d(this.W1k);for(var oa=0;oa<L.a.vQa.length;oa++)this.AHd(L.a.vQa[oa],this.pYb,Ga.dataFields);for(oa=0;oa<L.a.h0b.length;oa++)this.WTb(L.a.h0b[oa],this.pYb,Ga.dataFields);return Ga.dataFields.length?Ga:null}uZi(Ga){const oa=this.F1d(this.J1k);for(let sa=0;sa<H.a.vQa.length;sa++)this.AHd(H.a.vQa[sa],this.wHc[Ga],oa.dataFields);return oa.dataFields.length?oa:null}sZi(Ga){const oa=this.F1d(this.zli);for(var sa=0;sa<
I.a.vQa.length;sa++)this.AHd(I.a.vQa[sa],Ga,oa.dataFields);for(sa=0;sa<I.a.h0b.length;sa++)this.WTb(I.a.h0b[sa],Ga,oa.dataFields);return oa.dataFields.length?oa:null}Xng(Ga,oa,sa){Ga[oa]=oa in Ga?Ga[oa]+sa:sa}F1d(Ga){const oa=new C.a;oa.name=Ga;oa.dataFields=[];return oa}AHd(Ga,oa,sa){Ga in oa&&Array.add(sa,Object.assign(new pa.a,{name:Ga,int64:oa[Ga]}))}WTb(Ga,oa,sa){Ga in oa&&Array.add(sa,Object.assign(new pa.a,{name:Ga,string:oa[Ga]}))}Ihh(){for(let Ga=0;Ga<this.LUg;Ga++)this.wHc[Ga]={}}Thh(){this.pYb=
{}}static get kS(){return e.a.instance}}Object(J.a)(Z,"WordPredictionTelemetryHandler",null,[843]);var qa=d(62),ya=d(31),Ka=d(374),Da=d(302),la=d(92);d(228);var ma=d(49),Ea=d(32);d(454);d(426);d(1015);d.d(V,"a",function(){return ta});class ta{static get kS(){return e.a.instance}static get pD(){ta.drc||(ta.drc=new F);return ta.drc}static set pD(Ga){ta.drc=Ga}static get eVc(){return ta.TBf}static set eVc(Ga){ta.TBf=Ga}static get yGh(){ta.MGd||(ta.MGd=ta.PBi());return ta.MGd}static get settings(){ta.Cyc||
(ta.Cyc=Object.assign(new Q,{WordPredIsEnabled:!0,PredictionSeenCount:0,PredictionAccepted:!1}));return ta.Cyc}static set settings(Ga){ta.Cyc=Ga}static get hXa(){ta.zBd||(ta.zBd=new aa);return ta.zBd}static get Vml(){return ta.gGi}static get z5(){ta.OGd||(ta.OGd=new Z(ta.Vml,"Office.Word.Online.WordPredictionTelemetryData","Office.Word.Online.WordPredictionTelemetryDataPerSession","Office.Word.Online.WordPredictionTelemetryDataPerCandidate"));return ta.OGd}static get UEi(){return ta.i3a?ta.i3a.instance?
ta.i3a.instance.s2:1:(ta.i3a=m.a.instance.Ka("Common.IZoomManager"),ta.i3a&&ta.i3a.instance?ta.i3a.instance.s2:1)}static get characterPropertiesEditor(){ta.Erd||(ta.Erd=m.a.instance.resolve("Box4.ICharacterPropertiesEditor"));return ta.Erd}static get fcd(){ta.LBd||m.a.instance.Ka("Box4.Proofing.IProofingSentenceSeparator").execute(Ga=>{Ga&&(ta.LBd=Ga)});return ta.LBd}static get cDl(){ta.NGd||(ta.NGd=m.a.instance.resolve("Box4.WordPrediction.IWordPredictionSettingsInfo"));return ta.NGd}static SZk(){window.setTimeout(()=>
{const Ga={};Ga.WordPredIsEnabled=ta.settings.WordPredIsEnabled;Ga.PredictionSeenCount=ta.settings.PredictionSeenCount;Ga.PredictionAccepted=ta.settings.PredictionAccepted;ta.cDl.xGl(y.c(Ga))},ta.UWf)}static l5d(Ga,oa){if(!Ga||!oa||Ga.eventName!==r.a.bOa)return!1;const sa=Ga.mc.keyCode;if(ta.Ttg(oa)){ta.hNk();oa=oa.node;if((sa===v.a.MO||sa===v.a.Iq)&&ta.KSa)return A.a.ln(Ga.mc),ta.aCj(oa),ta.Qxl(sa),h.ULS.sendTraceTag(578307398,820,50,"Prediction Text Accepted"),!0;if(sa===v.a.NO)ta.eVc&&(ta.eVc=
!1);else if(sa===v.a.Z0&&ta.KSa)ta.eVc=!0,h.ULS.sendTraceTag(578307397,820,50,"Prediction Text Rejected"),ta.TRa();else if(sa===v.a.sLb&&Ga.mc.ctrlKey&&ta.yBd)return h.ULS.sendTraceTag(578307396,820,50,"Prediction Undid"),ta.Rhh(),!1}if(sa===v.a.bjb&&Ga.mc.shiftKey||sa===v.a.Hfa&&Ga.mc.ctrlKey||sa===v.a.wKa&&Ga.mc.altKey)return!1;oa=ta.pD.S4;const Ha=sa===v.a.vY||sa===v.a.P5||sa===v.a.Ifa||sa===v.a.V$;if(Ha||Ha&&(Ga.mc.ctrlKey||Ga.mc.shiftKey)||sa!==v.a.Hfa&&Ga.mc.ctrlKey||sa!==v.a.wKa&&Ga.mc.altKey||
sa===v.a.wH||ta.KSa&&oa&&0<oa.M7.length&&!oa.M7.toLowerCase().startsWith(String.fromCharCode(sa).toLowerCase()))ta.TRa(),ta.pD.S4=null,h.ULS.sendTraceTag(578307395,820,50,"Prediction hidden due to user typing a character that did not match prediction");ta.Rhh();return!1}static erj(){5>ta.settings.PredictionSeenCount&&(ta.settings.PredictionSeenCount+=1)}static TRa(){Ka.a.TRa();ta.KSa=!1}static aCj(Ga){ta.kS.LF(()=>{var oa=document.getElementById("inlinePredictedWord");if(oa){var sa=oa.innerText;if(sa&&
0<sa.length&&(Ga=Ga?Ga:ta.zaj())){var Ha=new u.GraphTransaction(7);Ha.gd(Ga);var bb=Ga.Ra.last,Ya=ma.a.QOa(Ga),ua=la.a.Ls(Ya);bb.formatting=ua.Ud(bb);ta.characterPropertiesEditor.replaceTextRange(Ya,sa,!0,!0,Ea.a.typing);Ha.dispose();sa=D.InteractiveViewManager.instance.Nd;Ha=Ga.sg(sa.Ma);Ha=Da.a.Bt(Ha,ya.ParagraphReader.textLength(Ga));bb=new Sys.UI.Point(Ha.x,Ha.y);bb.y+=Ha.height;sa.J5(bb,null,null,sa,!1);ta.KSa=!1;oa.innerText="";(oa=document.getElementById("inlinePlaceholderTab"))&&ta.Jkg()&&
(oa.className="hidePanel")}}},"WPT:IIG")}static z5k(Ga){ta.qwf=Ga;ta.z5.zHd(L.a.modelId,Ga.modelId);ta.z5.zHd(L.a.modelVersion,Ga.modelVersion);ta.z5.zHd(L.a.configId,Ga.configId)}static P9i(){return ta.qwf}static fKd(Ga,oa){const sa=ta.yGh;var Ha=document.getElementById("inlinePredictedWord");Ha&&(Ha.innerText=oa,(oa=document.getElementById("WACViewPanel_EditingElement_WrappingDiv").getElementsByClassName("TextRun"))&&0<oa.length&&(oa=oa[oa.length-1],Ha.style.fontSize=oa.style.fontSize,Ha.style.fontFamily=
oa.style.fontFamily,Ha.style.color=oa.style.color,Ha.style.whiteSpace="pre",Ha=Ha.parentNode,Ga="suggestion: "+Ga,oa=document.getElementById("inlinePlaceholderTab"),oa.className="hidePanel",oa&&ta.Jkg()&&(oa.className="inlinePlaceholderTab",Ga+=". Tab to accept"),Ha.parentNode.setAttribute("aria-label",Ga)),sa&&(sa.className="textareaCaretTracker"),ta.m6k()&&(ta.KSa=!0,h.ULS.sendTraceTag(578307393,820,50,"Ghost Text Visible")))}static Ttg(Ga){Ga||(Ga=ta.d2i());if(Ga){const oa=Ga.node;try{return ya.ParagraphReader.textLength(oa)<=
Ga.Qa}catch(sa){}}return!1}static yXj(Ga){Ga=ta.hXa.ga(Ga);Ga=Ga[L.a.IJd]-Ga[L.a.rmc];300<Ga?(ta.z5.s8a(L.a.BXf,Ga),ta.z5.s8a(L.a.AXf,1)):(ta.z5.s8a(L.a.wJf,Ga),ta.z5.s8a(L.a.JGf,1))}static hYd(Ga){ta.Lvg("TextPredictionTelemetryIsEnabled")&&ta.z5.MVi(Ga)}static iDg(Ga,oa){Ga=ta.hXa.ga(Ga);const sa=Ga[L.a.rmc];oa?ta.z5.s8a(L.a.nth,Ga[L.a.KGf]-sa):ta.z5.s8a(L.a.lth,Ga[L.a.IGf]-sa)}static n7b(Ga){ta.z5.s8a(Ga,1)}static ota(Ga,oa,sa){ta.z5.zxj(Ga,oa,sa)}static rfd(){ta.pD.S4=null;ta.pD.Ieb=null}static pBk(){ta.Hib("TextPredictionsSeen",
"TextPredictionsSeenIsEnabled");ta.erj();ta.zDj()}static Hib(Ga,oa){ta.Lvg(oa)&&window.setTimeout(()=>{const sa=m.a.instance.Ka("Common.ISystemInitiatedFeedback");sa&&sa.execute(Ha=>{Ha.logActivity(Ga,oa)})},ta.UWf)}static Lvg(Ga){return!!w.AFrameworkApplication.fa&&w.AFrameworkApplication.fa.ka(Ga)}static PBi(){var Ga=document.body;const oa=document.createElement("div");if(Ga){Ga.appendChild(oa);oa.setAttribute("id","textareaCaretTracker");oa.className="hidePanel";oa.setAttribute("role","alert");
Ga=document.createElement("button");const sa=document.createElement("span");Ga.setAttribute("disabled",!0);Ga.setAttribute("aria-disabled",!0);Ga.setAttribute("aria-hidden",!0);sa.setAttribute("aria-disabled",!0);sa.setAttribute("aria-hidden",!0);sa.setAttribute("id","inlinePredictedWord");sa.className="inlinePredictedWord";Ga.className="inlinePredictedWordButton";Ga.appendChild(sa);oa.appendChild(Ga);oa.appendChild(ta.xDi());(Ga=document.getElementById("WACViewPanel"))&&$addHandler(Ga,"scroll",ta.mpj)}return oa}static m6k(){const Ga=
ta.yGh;var oa=document.getElementById("WACViewPanel_EditingElement_WrappingDiv");oa=(oa=oa?oa.getElementsByClassName("EOP")[0]:null)?oa.getBoundingClientRect():null;return Ga&&oa?(Ga.style.cssText="transform: scale("+ta.UEi+"); transform-origin: 0% 0%",Ga.style.top=oa.top+"px",Ga.style.left=oa.left+"px",!0):!1}static Jkg(){return!ta.settings.PredictionAccepted}static zDj(){5!==ta.settings.PredictionSeenCount||ta.settings.PredictionAccepted||(ta.Hib("PredictionNotAccepted","PredictionNotAcceptedIsEnabled"),
ta.SZk())}static xDi(){const Ga=document.createElement("button");Ga.setAttribute("aria-hidden",!0);Ga.className="hidePanel";Ga.id="inlinePlaceholderTab";Ga.disabled=!0;Ga.innerText="Tab";return Ga}static mpj(){ta.TRa()}static zaj(){const Ga=qa.a.instance.Oa.kb;return Ga&&Ga.Ve?Ga.Ve.node:null}static hNk(){ta.jFd||(ta.jFd=window.setTimeout(ta.Onj,6E4*ta.fGi))}static Onj(){ta.z5.flush();ta.z5.RVi();ta.jFd=0}static qcg(Ga){return Ga&&0<Ga.length&&(Ga=Ga.split(" "),0<Ga.length)?Ga[Ga.length-1].length:
-1}static Qxl(Ga){const oa=ta.pD.S4,sa=ta.pD.Ieb;oa&&(ta.yBd=Object.assign(new E,{keyCode:Ga,aDl:oa,bDl:sa}))}static d2i(){const Ga=qa.a.instance.Oa.kb;return Ga&&Ga.Ve?Ga.Ve:null}static Rhh(){ta.yBd=null}}ta.gGi=30;ta.fGi=5;ta.UWf=5E3;ta.MGd=null;ta.LBd=null;ta.Erd=null;ta.i3a=null;ta.TBf=!1;ta.jFd=0;ta.OGd=null;ta.zBd=null;ta.yBd=null;ta.NGd=null;ta.Cyc=null;ta.qwf=null;ta.drc=null;ta.KSa=!1;Object(J.a)(ta,"WordPredictionHandler",null,[])},644:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);
class h{}h.ihk="NoCharacterPositionOnLine";h.khk="NoCharacterPositionOnSpan";h.jhk="NoCharacterPositionOnMultilineSpan";h.XYb="DoNothingResult";h.wia="FailedProcessingStep";h.c6a="FailedResult";h.XKc="FirstChildNotText";h.IUi="FirstChildNull";h.ICj="InvalidCharacterPositionResult";h.vh="NoExecute";h.Ko="NoApply";h.T0="UnexpectedState";Object(J.a)(h,"ActivityEventName",null,[])},645:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.OO="WordIndex";h.sgh="RenderedCandidateCount";h.lXg=
"NotRenderedCandidateCount";h.cOf="CandidateListCount";h.aWf="CumulativeIndexOfSeen";h.EEi="CumulativeIndexOfRejected";h.DEi="CumulativeIndexOfKept";h.$Vf="CumulativeIndexOfCorrect";h.CEi="CumulativeIndexOfAcceptedCandidate";h.Wkh="SeenCount";h.XOk="RejectedCount";h.pTj="KeptCount";h.zBh="TypedThroughCount";h.FEi="CumulativeScoreOfKept";h.GEi="CumulativeScoreOfRejected";h.cWf="CumulativeScoreOfTypeThrough";h.tgh="RenderedCharSum";h.oTj="KeptCharSum";h.nTj="KeptCandidateTokenSum";h.Ttl="UndoOfKeptCount";
h.Wtl="UndoneKeptCharCount";h.ABh="TypedThroughLastMatchingCharCount";h.language="Language";h.vQa=[h.sgh,h.lXg,h.cOf,h.aWf,h.EEi,h.DEi,h.$Vf,h.CEi,h.Wkh,h.XOk,h.pTj,h.zBh,h.FEi,h.GEi,h.cWf,h.tgh,h.oTj,h.nTj,h.Ttl,h.Wtl,h.ABh,h.language];Object(J.a)(h,"DataFieldsPerSentence",null,[])},646:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.modelId="ModelId";h.configId="ConfigId";h.modelVersion="ModelVersion";h.nBk="PredictionAcceptedByTab";h.mBk="PredictionAcceptedByRightArrow";h.wJf=
"AugLoopResponseTime";h.nth="SignalRenderedTime";h.lth="SignalNotRenderedTime";h.BXf="DelayedResponseTime";h.Pfl="SignalGeneratedCount";h.JGf="AnnotationReceivedCount";h.l8g="PredictionRenderedCount";h.k8g="PredictionNotRenderedCount";h.cVd="EmptyPredictionResponseCount";h.zth="SkippedPredictionResponseCount";h.AXf="DelayedResponseCount";h.uhk="NonEnglishSkipCount";h.rmc="SignalGenerationTime";h.IJd="AnnotationReceivedTime";h.KGf="AnnotationRenderedTime";h.IGf="AnnotationNotRenderedTime";h.vQa=[h.mBk,
h.nBk,h.wJf,h.nth,h.lth,h.BXf,h.Pfl,h.JGf,h.l8g,h.k8g,h.cVd,h.zth,h.AXf,h.uhk];h.h0b=[h.modelId,h.configId,h.modelVersion];Object(J.a)(h,"DataFieldsPerSession",null,[])},647:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.language="Language";h.UNd="CharIndex";h.vEc="CharIndexRendered";h.mBg="KeptCharCount";h.modelId="ModelId";h.j8g="PredictionLength";h.m8g="PredictionTokenCount";h.score="Score";h.status="Status";h.qUe="TypedThroughCharCount";h.OO="WordIndex";h.modelVersion="ModelVersion";
h.Byh="TimeTakenAugloop";h.Wld="TimeToRender";h.configId="ConfigId";h.vQa=[h.UNd,h.vEc,h.mBg,h.j8g,h.m8g,h.score,h.status,h.qUe,h.OO,h.Byh,h.Wld];h.h0b=[h.language,h.modelId,h.configId,h.modelVersion];Object(J.a)(h,"DataFieldsPerCandidate",null,[])},648:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.syncDeltaTimeout=this.disableSyncDeltaSending=this.isDeltaGeneratorEnabled=this.powerpoint=this.downloadPolymerBaseUrl=this.inferenceServiceVersion=this.downloadBaseUrl=
this.sessionCreationOptions=this.disabledServiceGroups=this.privateMode=this.flights=this.excelServer=this.initSession=this.sessionId=this.releaseFork=this.releaseCustomAudience=this.releaseChannel=this.releaseAudienceGroup=this.uiLanguage=this.appVersion=this.appName=this.serviceUrl=null}}Object(J.a)(h,"InitializeParameters",null,[])},649:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.yFa=!0;this.AYc=this.f4c=this.O5c=this.X1c=null;this.hka=e}copy(){return new h(this.hka.copy())}move(e,
m){this.yFa=!0;this.hka.move(e,m)}setOffsets(e){this.yFa=!0;this.hka.setOffsets(e)}Vf(){return this.hka.Vf()}get Yb(){this.ynd();return this.X1c}get $b(){this.ynd();return this.O5c}get Vb(){this.ynd();return this.f4c}get Ub(){this.ynd();return this.AYc}ynd(){if(this.yFa){var e=this.hka.points;this.X1c=this.f4c=e[0].x;this.O5c=this.AYc=e[0].y;for(const m of e)this.X1c=Math.min(this.X1c,m.x),this.O5c=Math.min(this.O5c,m.y),this.f4c=Math.max(this.f4c,m.x),this.AYc=Math.max(this.AYc,m.y);this.yFa=!1}}}
Object(J.a)(h,"Boundary",null,[])},650:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.vJ=e}}Object(J.a)(h,"SessionEndedEventArgs",Sys.EventArgs,[])},651:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(55);class e{constructor(m){this.PCg=this.errorType=0;this.originalText=this.token=null;this.XHa=this.k$=this.lcid=0;this.gGh=!1;this.Ssf=m}vae(){const m=this.token?this.token:null;return 0!==this.errorType&&e.owj.contains(m,
this.lcid)}static get owj(){return e.NLa||(e.NLa=h.a.instance.resolve("Box4.Proofing.IIgnoreAllKeywords"))}}e.NLa=null;Object(J.a)(e,"ProofingErrorDetails",null,[659])},652:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.Load=0]="Load";e[e.Edit=1]="Edit"})(h||(h={}));Object(J.b)("UserAction",h)},653:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);V=d(107);class h extends V.a{constructor(){super();this.Input=null;this.Lcid=0;this.UserActionType=this.PostContextText=
this.PreContextText=null;this.ApplicationMode=0}Ok(){return 4}static tXi(e,m){const r=new h;h.PAe(r,e,m);r.UserActionType=e.paragraphNode.XOb?"Edit":"Load";return r}static PAe(e,m,r){e.Lcid=m.range.lcid;e.Input=m.sma.substring(m.range.begin,m.range.end);e.ApplicationMode=r;0<=m.range.k$&&(e.PreContextText=m.sma.substring(m.range.k$,m.range.begin));0<=m.range.XHa&&(e.PostContextText=m.sma.substring(m.range.end,m.range.XHa))}static rej(e,m,r,v,A,w,y,u){const {SpellingRequestObjectUpdatedV2:D}=d(1080),
{SpellingRequestObjectUpdated:F}=d(1081);return u?D.ZYd(m,r):e?F.ZYd(m,r,v,A,w,y):h.tXi(m,r)}}Object(J.a)(h,"SpellingRequestObject",V.a,[])},654:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(78);class e{static cob(m,r,v="GenericCommentsTask"){v=new h.a(2,1,0,()=>{r()},92,v);m.Cb(v)}static mu(m){return Error.create("SDXHostAPI Error : "+m,{["SDXHostAPIErrorCode"]:m})}}Object(J.a)(e,"OfficeSharedCommentsUtils",null,[])},655:function(J,V,d){d.d(V,"a",function(){return r});J=d(0);var h=
d(376);V=d(712);var e=d(1004),m=d(904);class r extends V.a{constructor(v,A,w=null){super(v,A,w||e.a.instance,r.qzj)}static qzj(){m.a.sendTraceTag=r.D1k;m.a.debugAssertTag=r.oFi}static D1k(v,A,w,...y){h.ULS.sendTraceTag.apply(null,[v,204,r.kEi(A),w].concat(y))}static oFi(){}static kEi(v){switch(v){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}}}r.QBe="wdPreviousSession";r.lWf="wdUserSession";Object(J.a)(r,"CommonCrossDocumentMessenger",V.a,
[])},656:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(376),e=d(25);class m{static l4d(r,v){let A=null;if(r&&0<r.length&&v&&0<v.length){const w=window[v];w?w&&r in w?A=w[r]:h.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+r+" from dictionary "+v):h.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+v)}return A}static eae(){const r=e.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateLatestVersionIsEnabled",
!1);r?h.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "):h.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version");return r}}Object(J.a)(m,"CommonUtils",null,[])},657:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.type=null;this.type=e}}Object(J.a)(h,"CustomContentProps",null,[])},658:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(300);class h{}h.LabelText=d.a.labelText;h.LabelTextUserGeneratedPlaceholderReplacements=d.a.JTj;
h.Visible=d.a.visible;h.ImageIsVisible="ImageIsVisible";h.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible";h.Image16by16Class=d.a.Uub;h.Image32by32Class=d.a.nDa;h.Image48by48Class=d.a.l7d;h.ImageBackColor="ImageBackColor";h.On="On";h.SourceControlId="SourceControlId";Object(J.a)(h,"FlyoutAnchorCommandProperties",null,[])},659:function(J,V,d){d.d(V,"a",function(){return w});J=d(0);var h=d(263),e=d(25),m=d(355),r=d(196),v=d(95),A=d(63);class w{static fYa(y){let u,D;({opl:u,ppl:D}=w.vTi());
w.XZk(u,D,y)}static vTi(){({f3b:u}=m.a.fKb(!e.AFrameworkApplication.bQ));var y=$get(h.CuiHelper.iuj);if(u)var u=document.getElementById(h.CuiHelper.xWd);else u=y.childNodes[0],y=y.childNodes[1];return{opl:u,ppl:y}}static XZk(y,u,D){if(y&&u&&0<u.clientHeight){const F=-1!==u.parentNode.parentNode.className.indexOf("cui-ribbon");w.skh(y,u,D,F)}}static skh(y,u,D,F){let I=null,H=null,L=null,E=null,aa=null,Q=null,O=null,T=null,K=null,X=null,P=null,ea=null,ia=null,ja=null,C=null,pa=null,Z=null,qa=null,ya=
null,Ka=null;({v0f:I,u0f:H,w0f:L,G5a:E,H5a:aa,FPa:Q,tS:O,av:T,GPa:K,MP:X,HPa:P,x0f:Ka}=w.e5f(y,I,H,L,E,aa,Q,O,T,K,X,P,Ka));({xZb:ea,vG:ia,t0f:ja,r0f:C,I5a:pa,Irb:Z,Jrb:qa,s0f:ya}=w.D5f(u,ea,ia,ja,C,pa,Z,qa,ya));y=[I,H,L,E,aa,Q,O,T,K,X,P,ja,C,pa,Z,qa,ya,Ka];for(var Da of y)w.udl(Da);Da=[I,H,L,aa,O,T,X,P,C,Z,qa,ya];for(const la of Da)w.MUe(la);w.Qhh(H);w.dnh(ia,0);w.pOi(I,H,L,E,aa,Q,O,T,K,X,P,ea,ia,ja,C,pa,Z,qa,ya,Ka,F,D);w.Z8h(Q,O)}static $Zk(y,u){w.skh(y,null,u,!1)}static Z8h(y,u){y&&u&&(y.style.marginTop=
(u.offsetHeight-y.offsetHeight)/2+"px")}static e5f(y,u,D,F,I,H,L,E,aa,Q,O,T,K){for(let X=0;y&&X<y.childNodes.length;X++){const P=y.childNodes[X],ea=v.a.Iia(P),ia=!!P.id;-1!==ea.indexOf("cui-QATRowLeft")?u=P:-1!==ea.indexOf("cui-QATRowCenter")?D=P:-1!==ea.indexOf("cui-QATRowRight")?F=P:-1!==ea.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?I=P:P.id===h.CuiHelper.ZLd?H=P:P.id===h.CuiHelper.O6f?L=P:P.id===h.CuiHelper.$Ld?E=P:P.id===h.CuiHelper.aMd?aa=P:ia&&w.EHj(P)?Q=P:-1!==ea.indexOf("UsernameNameContainer")?
O=P:-1!==ea.indexOf("UsernameNameItem")?T=P:-1!==ea.indexOf("FreemiumUpsellButton")&&(K=P);({v0f:u,u0f:D,w0f:F,G5a:I,H5a:H,FPa:L,tS:E,av:aa,GPa:Q,MP:O,HPa:T,x0f:K}=w.e5f(P,u,D,F,I,H,L,E,aa,Q,O,T,K))}return{v0f:u,u0f:D,w0f:F,G5a:I,H5a:H,FPa:L,tS:E,av:aa,GPa:Q,MP:O,HPa:T,x0f:K}}static D5f(y,u,D,F,I,H,L,E,aa){for(let Q=0;y&&Q<y.childNodes.length;Q++){const O=y.childNodes[Q],T=v.a.Iia(O),K=!!O.id;-1!==T.indexOf("cui-jewel-container")?u=O:-1!==T.indexOf("cui-tts")?D=O:-1!==T.indexOf("cui-TabRowInline")?
I=O:-1!==T.indexOf("cui-TabRowRight")?aa=O:-1!==T.indexOf("cui-separator")?F=O:K&&O.id.startsWith(h.CuiHelper.Q3g)&&!H?H=O:K&&O.id.startsWith(h.CuiHelper.x4f)?L=O:K&&O.id.startsWith(h.CuiHelper.hAe)&&(E=O);({xZb:u,vG:D,t0f:F,r0f:I,I5a:H,Irb:L,Jrb:E,s0f:aa}=w.D5f(O,u,D,F,I,H,L,E,aa))}return{xZb:u,vG:D,t0f:F,r0f:I,I5a:H,Irb:L,Jrb:E,s0f:aa}}static WZk(y,u,D,F,I,H,L,E,aa){w.YQ(y,u,aa)&&(w.TQc(u),w.YQ(y,u,aa)&&w.TQc(u));w.YQ(u,F,aa)&&(w.QK(D),w.QK(I),w.YQ(u,F,aa)&&(w.TQc(u),w.YQ(u,F,aa)&&(w.TQc(u),w.YQ(u,
F,aa)&&w.QK(F))));w.YQ(F,E,aa)&&(w.QK(D),w.QK(I));y=[H,L,E];w.fmg(F,E,y,aa);w.fmg(u,E,y,aa)}static fmg(y,u,D,F){let I=0;for(;I<D.length&&w.YQ(y,u,F);)w.QK(D[I]),I++}static Idj(y){if(!y)return 0;if(void 0===y._scaleStep||null===y._scaleStep){let u=0;-1!==y.className.indexOf("cui-tts-scale1")?u=1:-1!==y.className.indexOf("cui-tts-scale2")&&(u=2);y._scaleStep=u}return parseInt(y._scaleStep)}static TQc(y){let u=w.Idj(y);2>u&&w.dnh(y,++u)}static dnh(y,u){y&&(y.className=w.FXk[u],y._scaleStep=u)}static YQ(y,
u,D){return y&&u?A.a.aCg(A.a.ei(y),A.a.ei(u),D):!1}static UDb(y,u,D){let F=0;y&&u&&(F=A.a.Xde(A.a.ei(y),A.a.ei(u),D));return F}static kQd(y){for(let u=0;y&&u<y.childNodes.length;u++)if(-1!==y.childNodes[u].className.indexOf("cui-cg"))return!0;return!1}static f0d(y){let u=null;for(let D=y.childNodes.length-1;y&&0<=D;D--){const F=y.childNodes[D];if(-1===F.className.indexOf("cui-cg"))break;u=F}return u}static dKb(y,u,D){if(y&&!w.Rm(y)){var F=r.a.It(y);F=v.a.QL(F.paddingLeft)+v.a.QL(F.paddingRight);D=
y.offsetWidth-D-F;let I=0;for(;u&&u!==y;)(F=r.a.It(u))&&(I+=v.a.QL(F.paddingLeft)+v.a.QL(F.paddingRight)),u=u.parentNode;D=Math.max(D,75+I);y.style.width=D+"px"}}static YUk(y,u,D){if(y&&u){let F=0,I=0;({left:F,top:I}=A.a.xag(u,F,I));w.Tfk(y,D?F-y.offsetWidth:F+u.offsetWidth)}}static pOi(y,u,D,F,I,H,L,E,aa,Q,O,T,K,X,P,ea,ia,ja,C,pa,Z,qa){Z&&w.WZk(T,K,X,P,ea,ia,ja,C,qa);w.kQd(K)?w.e_k(K,y,u,D,F,I,H,L,E,aa,Q,O,pa,qa):w.d_k(y,u,D,F,I,H,L,E,aa,Q,O,pa,qa)}static d_k(y,u,D,F,I,H,L,E,aa,Q,O,T,K){const X=
!!I,P=!!L,ea=!!E;let ia=0;if((P||ea)&&0<(ia=w.UDb(y,u,K))){let ja=P;ea&&(!P||E.offsetWidth>L.offsetWidth)&&(ja=!1);w.dKb(ja?L:E,ja?L:E,ja?ia:2*ia);P&&ea&&0<(ia=w.UDb(y,u,K))&&w.dKb(ja?L:E,ja?L:E,ja?ia:2*ia)}if(P&&w.YQ(L,u,K)||X&&w.YQ(I,u,K))w.QK(F),w.QK(I),w.QK(H),w.QK(L),ea&&(w.MUe(u),w.MUe(E));w.Vdh(u,D,E,aa,Q,O,T,K);ea&&w.gOf(E,y,D,K)}static e_k(y,u,D,F,I,H,L,E,aa,Q,O,T,K,X){const P=!!E,ea=!!aa,ia=!!Q,ja=!!K,C=w.f0d(y);0<(u=w.UDb(u,C,X))&&(P&&w.dKb(E,E,u),!P||w.YQ(E,C,X))&&(w.QK(I),w.QK(H),w.QK(L),
w.QK(E));w.YQ(y,D,X)&&w.YUk(D,y,X);w.Vdh(D,F,aa,Q,O,T,K,X);0<(u=w.UDb(y,F,X))&&(w.dKb(O,T,u),ja&&w.YQ(y,F,X)&&w.QK(K),ia&&w.YQ(y,F,X)&&w.QK(Q));ea&&!w.Rm(D)&&w.gOf(aa,y,F,X)}static Vdh(y,u,D,F,I,H,L,E){const aa=!!D,Q=!!F,O=!!I,T=!!L;let K=0;if((aa||O)&&0<(K=w.UDb(y,u,E))){const X=!!y&&"absolute"!==y.style.position;let P=aa;O&&(!aa||I.offsetWidth>D.offsetWidth)&&(P=!1);w.dKb(P?D:I,P?D:H,P&&X?2*K:K);aa&&O?(0<(K=w.UDb(y,I,E))&&(P=!P,w.dKb(P?D:I,P?D:H,P&&X?2*K:K)),w.YQ(y,I,E)&&w.QK(y)):aa&&w.YQ(y,u,E)&&
w.QK(y)}T&&w.YQ(y,u,E)&&w.QK(L);Q&&w.YQ(y,u,E)&&w.QK(F)}static Rm(y){if(!y)return!0;y=y._isHidden;return!(void 0===y||null===y||"0"===y)}static QK(y){y&&!w.Rm(y)&&(y.style.display="none",y._isHidden="1")}static udl(y){y&&w.Rm(y)&&(y.style.display="",y._isHidden="0")}static MUe(y){y&&(y.style.width="auto",y.style.maxWidth="none")}static Tfk(y,u){y&&(y.style.position="absolute",y.style.left=u+"px")}static Qhh(y){y&&(y.style.position="static",y.style.left="auto")}static gOf(y,u,D,F){if(y&&y.parentNode&&
y.parentNode.parentNode){var I=w.fxk(y);"auto"!==y.parentNode.style.width&&(y.style.width=y.parentNode.offsetWidth-I+"px");var H=F?D:u;u=F?u:D;D=A.a.ei(y.parentNode.parentNode);H=H?A.a.ei(H):new Sys.UI.Bounds(D.x,0,0,0);u=u?A.a.V6a(u):new Sys.UI.Point(D.x+D.width,0);"absolute"===y.parentNode.style.position?I=u.x-(H.x+H.width)-I-1:(D=A.a.ei(y.nextSibling?y.parentNode:y),D=D.x+D.width/2,I=2*Math.min(D-(H.x+H.width),u.x-D)-I-1);y.style.maxWidth=I+"px"}}static fxk(y){var u=r.a.It(y);u=u?v.a.QL(u.paddingLeft)+
v.a.QL(u.paddingRight):0;var D=r.a.It(y.parentNode);D=D?v.a.QL(D.paddingLeft)+v.a.QL(D.paddingRight):0;let F=0;for(;y.nextSibling;)y=y.nextSibling,F+=y.offsetWidth;return u+D+F}static EHj(y){return!!y.id&&(y.id.startsWith(h.CuiHelper.CMe)||y.id.startsWith(h.CuiHelper.gfd))}}w.FXk=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"];Object(J.a)(w,"RibbonTabScalingActor",null,[])},660:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(376),e=d(13),m=d(25),r=d(135),v=d(55),A=d(179),w=d(124);class y{constructor(){this.dNa=
null;this.$wf=!1}dUe(){try{this.dNa||(this.dNa=v.a.instance.resolve("Common.App.SearchCommon.ISearchOAuthManager"),this.$wf=!!m.AFrameworkApplication.fa&&m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TellMe.EnableOAuthMgrForService",!1))}catch(u){h.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+u)}}$8i(){this.dUe();return this.dNa?this.dNa.getToken("Search",m.AFrameworkApplication.gfe,!1):null}zgg(){if("Dev Box"===m.AFrameworkApplication.fa.Ga("StatusBarEnvironmentNameToUse")&&
void 0!==window.TellMeSubstrateTokenOverride&&null!==window.TellMeSubstrateTokenOverride)return new Promise(u=>{window.setTimeout(()=>{u(window.TellMeSubstrateTokenOverride)},750)});this.dUe();return this.dNa?this.dNa.getToken("Search",m.AFrameworkApplication.uQe,!0):null}Ahj(){this.dUe();return this.dNa?this.dNa.getToken("Search",this.xhj(),this.$wf):null}xhj(){return m.AFrameworkApplication.fa.Ga("TellMeServiceAuthEndpointForSearch")}a9i(){return Object(e.a)(this,this.$8i,"getLokiTokenPromise")}Jgj(){return Object(e.a)(this,
this.zgg,"getSubstrateTokenPromise")}eIb(){return!!m.AFrameworkApplication.Aa&&m.AFrameworkApplication.Aa.jb.eIb}lij(){const u={};this.eIb()&&(u.Loki=this.a9i(),u.Substrate=this.Jgj());return u}v7b(u){r.a.PIa(Object.assign(new A.a,{name:"Events",dataFields:[Object.assign(new w.a,{name:"Event",string:"StringsLoaded"}),Object.assign(new w.a,{name:"Status",bool:u})],durationMs:Math.round(window.performance.now())}),"TellMeWAC.")}EWj(){return m.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("tellme-strings").catch(()=>
{this.v7b(!1);return!1}).then(()=>{this.v7b(!0);return!0}):new Promise((u,D)=>{const F=v.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Jv;F?F.loadScript("tellme-strings").then(()=>{this.v7b(!0);u(!0)}).catch(()=>{this.v7b(!1);D(!1)}):(this.v7b(!1),D(!1))})}static ZOj(){return!!m.AFrameworkApplication.Aa&&(m.AFrameworkApplication.Aa.jb.p6b||m.AFrameworkApplication.Aa.jb.Nwb)}static sVc(){return!!m.AFrameworkApplication.Aa&&m.AFrameworkApplication.Aa.jb.Nwb}}Object(J.a)(y,"ReactSharedHeaderSearchUtils",
null,[])},661:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(376),e=d(45),m=d(918),r=d(27),v=d(42),A=d(75),w=d(31);class y{constructor(u=2E3){this.mMa=u}QGj(){const u=y.VV();return this.bSj(u)}bSj(u){return 0<this.UOc(u).mentionLength}getSelectedText(){const u=y.VV();return this.UOc(u)}UOc(u){return this.fej(u)}fej(u){var D=null;u&&u.sba&&v.SelectionEditor.Pg(u.Ua)&&v.SelectionEditor.Kwb(u.Ua)&&(h.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),
D=v.SelectionEditor.UPa(u.Ua,!1));D&&(u=D);if(!u)return Object.assign(new m.a,{neighborhood:"",mentionStart:0,mentionLength:0});const F=new Sys.StringBuilder;let I=D=0;const H=[],L=u.length;for(let aa=0;aa<L;aa++){const Q=u.ga(aa);if(!w.ParagraphReader.Vd(Q.node)||Array.contains(H,Q.node.mKa))continue;H.push(Q.node.mKa);let O=w.ParagraphReader.text(Q.node),T=0;var E=w.ParagraphReader.dsa(Q.node,!0,!0,!0);let K=w.ParagraphReader.dsa(Q.node,!1,!0,!0),X=0;for(;O.length<this.mMa&&(E||K);){if(!(X%2)&&
E){const P=w.ParagraphReader.text(E);O=P+" "+O;T+=P.length+1;E=w.ParagraphReader.dsa(E,!0,!0,!0)}1===X%2&&K&&(O=O+" "+w.ParagraphReader.text(K),K=w.ParagraphReader.dsa(K,!1,!0,!0));X++}E=aa===L-1;aa||-1===Q.Qa||(D=Q.Qa);I+=E&&-1!==Q.Kb?Q.Kb:O.length;F.append(O);D+=T;I+=T;E||(F.append(" "),I++)}for(u=A.AParagraphNode.Fed(F.toString()," ");D<I&&e.a.Oy(u.charCodeAt(D));)D++;for(;I>D&&e.a.Oy(u.charCodeAt(I-1));)I--;return this.w9h(u,D,I)}w9h(u,D,F){if(u.length>this.mMa){var I=F-D;if(I>this.mMa)u=u.substr(D,
this.mMa),F=this.mMa,D=0;else{I=Math.max(D-Math.floor((this.mMa-I)/2),0);let H;H=Math.min(I+this.mMa,u.length);I=Math.max(H-this.mMa,0);D-=I;F-=I;u=u.substring(I,H)}}return Object.assign(new m.a,{neighborhood:u,mentionStart:D,mentionLength:F-D})}static VV(){var u=r.App.Hb.Hd.nn;if(!u)return h.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;u=u.Gb;return u&&u.Oa&&u.Oa.length?u.Oa.kb:(h.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}}Object(J.a)(y,
"Box4InsightsSelection",null,[398,399])},662:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.style=this.formatting=null;this.languageId=0}}Object(J.a)(h,"NewOutlineElementInfo",null,[])},663:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.e8c="Listening";h.bDb="Warning";h.zWa="Error";Object(J.a)(h,"VoiceNotificationResourceStrings",null,[])},664:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.CoachButton="coachButton";h.MicButton=
"micButton";h.PrevButton="prevButton";h.NextButton="nextButton";h.GridButton="gridButton";h.InkButton="inkButton";h.SubtitlesButton="subButton";h.LiveButton="liveButton";h.MoreButton="moreButton";h.ExitButton="exitButton";Object(J.a)(h,"SlideshowToolbarButtonIDs",null,[])},665:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(432);class h extends d.a{constructor(e){super();this.shapeNode=e}get sxg(){return!this.shapeNode||!this.shapeNode.isConnected}get id(){return this.shapeNode.id}get isConnected(){return this.shapeNode.isConnected}}
Object(J.a)(h,"InternalClipboardShape",d.a,[])},666:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(41);class e{constructor(m,r){this.Jcb=!1;this.std=this.Xxf=-1;this.Gw=m;r&&this.start()}start(){this.Jcb=!0;this.std=-1;const m=h.a.rY();m&&(this.Xxf=m)}stop(){this.Jcb=!1;const m=h.a.rY();m&&0<this.D$&&m>=this.D$&&(this.std=m-this.D$)}get operation(){return this.Gw}get VIc(){return this.std}get D$(){return this.Xxf}}Object(J.a)(e,"PPTStopwatch",null,[])},667:function(J,V,d){d.d(V,"a",
function(){return e});d.d(V,"b",function(){return m});var h=d(45);const e=r=>{r=btoa(r);r=r.replace(RegExp("\\+","g"),"-");r=r.replace(RegExp("\\/","g"),"_");return r=r.replace(RegExp("\\=+$","g"),"")},m=r=>{if(h.a.Va(r))return null;const v=RegExp("%([0-9A-F]{2})","g");r=encodeURIComponent(r);let A="",w=0,y;for(;y=v.exec(r);){const u=v.lastIndex-3;u>w&&(A+=r.substring(w,u));A+=h.a.fromCharCode(parseInt(String("0x"+y[1])));w=v.lastIndex}w<r.length&&(A+=r.substring(w,r.length));return btoa(A)}},668:function(J,
V,d){d.d(V,"a",function(){return w});J=d(0);var h=d(25),e=d(172),m=d(90),r=d(13);V=d(17);var v=d(26),A=d(66);class w{constructor(y,u,D,F,I,H,L,E,aa,Q,O,T,K,X){this.x4=this.zl=this.hx=null;this.vNf=!0;this.zUa=y;this.Hbk=u;this.B3j=D;this.z9b=F;this.e4=H;this.Xb=L;this.Md=E;this.jg=aa;this.vbk=Q;this.rbb=O;this.j7j=T;this.i7j=K;this.h7j=X;this.GI=I}openDialog(){this.Bzi();h.AFrameworkApplication.Aa.Jeb();try{this.zl.click()}catch(y){const u=String.format("UploadFrame::DoFileOpenDialog failed. Message: {0}. Stack: {1}",
y.message,y.stack);v.a.J(509727820,818,10,u);throw y;}}submit(){const y=this.zl.files[0];this.x4=this.B3j();this.x4.Ewe&&this.x4.Ewe(this.e4,this.Xb,this.Md,this.jg);if(this.vbk)this.Azl(y);else{const u=new FormData;for(let F of this.x4.kJd)u.append(F.key,F.value);u.append("fileInputId",y,y.name);const D=new XMLHttpRequest;D.onreadystatechange=()=>{this.MDb(D)};D.open("POST",this.x4.t7g);D.send(u)}}MDb(y){if(4===y.readyState){const u=y.status;if(!u||u>=e.a.py&&u<e.a.wdi){if(this.x4.onSuccess)this.x4.onSuccess(y.responseText,
this.e4,this.Xb,this.Md,this.jg,this.zl)}else this.x4.hz&&this.x4.hz(y.responseText,this.e4,this.Xb,this.Md,this.jg);this.dispose()}}Azl(y){this.rbb().K0(this.z9b,this.GI,y.size,y,this.x4.kJd.ga("MediaToken"),this.j7j,this.i7j,this.h7j,u=>{if(this.x4.onSuccess)this.x4.onSuccess(u.result,this.e4,this.Xb,this.Md,this.jg,this.zl)},u=>{this.x4.hz&&this.x4.hz(u.error.Code.toString(),this.e4,this.Xb,this.Md,this.jg)})}dispose(){this.hx&&(m.a.removeHandler(this.zl,"change",Object(r.a)(this,this.zKc,"fileInputChange")),
document.body.removeChild(this.hx),this.zl=this.hx=null,w.SVe.remove(this))}Bzi(){this.hx||(this.hx=document.createElement("form"),this.hx.id="uploadFormId",this.hx.style.visibility=A.a.hidden,this.hx.method="post",this.hx.encoding="multipart/form-data",this.hx.action="",this.zl=document.createElement("input"),this.zl.style.visibility=A.a.hidden,this.zl.type="file",this.zl.id="uploadFileInputId",this.zl.name="uploadFileInputId",this.zl.accept=this.zUa,this.hx.appendChild(this.zl),document.body.appendChild(this.hx),
m.a.addHandler(this.zl,"change",Object(r.a)(this,this.zKc,"fileInputChange")))}zKc(){this.zl.value&&this.zl.value.length?(this.vNf=!1,this.Hbk(this.zl,this.Md,this.jg,this.z9b).then(()=>{this.submit()}).catch(()=>{this.dispose()})):this.dispose()}static JOe(y,u,D,F,I,H,L,E,aa,Q,O,T,K,X){for(let P of w.SVe)P.vNf&&P.dispose();y=new w(y,u,D,F,I,H,L,E,aa,Q,O,T,K,X);w.SVe.add(y);y.openDialog()}}w.SVe=new V.a;Object(J.a)(w,"UploadFileDialog",null,[])},687:function(J,V,d){d.r(V);J=d(0);var h=d(376),e=d(189),
m=d(914),r=d(1064),v=d(25),A=d(1063),w=d(13),y=d(1165),u=d(1166),D=d(27),F=d(458);class I extends F.a{constructor(Da,la,ma,Ea,ta,Ga){super();this.init(Da);this.Fl("DummyClipboardOperation");this.qDa(v.AFrameworkApplication.Ta,la,Ea,ta,Ga);this.Qu=ma;this.rp=8;this.$X()}run(){this.SLa=!0;this.Ggb(this.Qu);this.Cma();this.rp=32}}Object(J.a)(I,"DummyClipboardOperation",F.a,[]);var H=d(95),L=d(127),E=d(116),aa=d(59);class Q{constructor(Da,la,ma){h.ULS.shipAssertTag(6305502,307,!!Da);this.properties=Da;
this.hd=la;this.upa=ma}get Tc(){return this.hd}$dg(){return this.properties.sa(aa.a.bU,"")}q8g(){return!0}qAh(){let Da,la=!1;Da=null;const ma=this.$dg();if(this.upa||""!==ma)try{({z5a:Da,returnValue:la}=this.YTe(ma))}catch(Ea){h.ULS.shipAssertTag(4203138,307,!1),this.Tc.Tb(L.a.wia,{["Reason"]:E.a.IKf}),H.a.TAa(Da)}else h.ULS.sendTraceTag(3994443,307,50,"PastedHTMLString empty"),this.Tc.Tb(L.a.T0,{["Reason"]:E.a.nWd});return{returnValue:la,UFc:Da}}}Object(J.a)(Q,"AStringInputImportStrategy",null,[509]);
class O extends Q{constructor(Da,la,ma,Ea,ta){super(Da,la,ta);this.Xj=ma;this.QDd=Ea}YTe(Da){const {ClipboardActor:la}=d(687);let ma;if(this.upa&&!Da)return h.ULS.sendTraceTag(541172643,307,10,"No htmlDomContent and htmlClipboardDataContent"),{returnValue:!1,z5a:null};ma=null;if(this.upa)return ma=this.Xj.$Wa(Da),{returnValue:!0,z5a:ma};if(this.QDd){const Ea=this.properties.sa(aa.a.$ze,"");Ea&&(ma=this.Xj.$Wa(Ea))}ma||(h.ULS.sendTraceTag(520931392,307,15,"HtmlStringImportStrategy:: use of innerHtml because domContainer is null"),
ma=la.S5g,ma.innerHTML=Da);return{returnValue:!0,z5a:ma}}}Object(J.a)(O,"HtmlStringImportStrategy",Q,[]);var T=d(45);class K extends Q{constructor(Da,la,ma){super(Da,la,ma)}YTe(Da){let la;if(this.upa&&!Da)return h.ULS.sendTraceTag(541172642,307,10,"No htmlDomContent"),{returnValue:!1,z5a:null};la=document.createElement("div");Da=Da.split(RegExp("\r\n|\r|\n"));for(var ma=0;ma<Da.length-1;ma++){const Ea=document.createElement("p");Ea.innerText=this.cee(Da[ma]);la.appendChild(Ea)}ma=document.createElement("span");
ma.innerText=T.a.kVd(Da[Da.length-1]);la.appendChild(ma);return{returnValue:!0,z5a:la}}cee(Da){return T.a.kVd(Da.length?Da:" ")}}Object(J.a)(K,"MultiLineTextImportStrategy",Q,[]);class X extends K{constructor(Da,la,ma){super(Da,la,ma)}$dg(){return this.properties.sa(aa.a.veb,"")}cee(Da){Da=super.cee(Da);return Da.length&&" "!==Da?Da:"\u00a0"}}Object(J.a)(X,"MultiLinePlainTextImportStrategy",K,[]);class P extends Q{constructor(Da,la,ma){super(Da,la,ma)}YTe(Da){var {ClipboardActor:la}=d(687);if(this.upa&&
!Da)return h.ULS.sendTraceTag(541172641,307,10,"No htmlDomContent"),{returnValue:!1,z5a:null};la=la.S5g;la.innerText=Da;return{returnValue:!0,z5a:la}}}Object(J.a)(P,"PlainTextImportStrategy",Q,[]);var ea=d(377);class ia{constructor(Da){this.fg=this.Bbe=!1;this.WY=Da}q8g(){this.Bbe||(this.Bbe=!0,this.fg=!1,this.WY.prepareForPaste(()=>{this.fg=!0}));return this.fg}qAh(){let Da;this.Bbe=!1;Da=this.WY.paste();return Da?Da.hasChildNodes()?{returnValue:!0,UFc:Da}:(h.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),
ia.Tc.Tb(L.a.T0,{["Reason"]:E.a.nWd}),{returnValue:!1,UFc:Da}):(h.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),ia.Tc.Tb(L.a.c6a,{["Reason"]:E.a.aRe}),{returnValue:!1,UFc:Da})}static get Tc(){return ea.a.instance}}Object(J.a)(ia,"SystemClipboardImportStrategy",null,[509]);var ja=d(62),C=d(34),pa=d(49),Z=d(39),qa=d(32),ya=d(257);d.d(V,"ClipboardActor",function(){return Ka});class Ka{constructor(Da,la,ma,Ea,ta,Ga,oa,sa){this.uZe=null;this.APb=0;this.$Kh=Da;this.WY=la;this.hd=ma;this.Xj=
Ea;this.Qc=ta;this.Ca=Ga;this.Hs=oa;this.Pcf=!!sa&&sa.ka("SupportImageDragDropExternalIsEnabled");this.dEd=!!sa&&sa.ka("ShowKeepSourceFormattingOnPasteFloatieIsEnabled");this.yM=new ya.a;this.yM.$(qa.a.paste,257);this.yM.$(qa.a.iwa,8449);this.yM.$(qa.a.tqa,1);this.yM.$(qa.a.xsg,513);this.yM.$(qa.a.reformatPastedContent,4097);this.yM.$(qa.a.bed,12289);this.yM.$(qa.a.yad,7);this.yM.$(qa.a.xad,1);this.yM.$(qa.a.M5g,8193);this.yM.$(qa.a.copy,272);this.yM.$(qa.a.eDc,16);this.yM.$(qa.a.cut,304);this.yM.$(qa.a.jVb,
48);this.yM.$(qa.a.y7c,64);this.yM.$(qa.a.z7c,64);this.yM.$(qa.a.showPlaceholderGlossary,65536);this.Pcf&&this.yM.$(qa.a.t_f,1)}get rQf(){return this.$Kh.value}get nA(){return this.WY}ub(){this.Ca.pa(qa.a.kFk,Z.a.application,Object(w.a)(this,this.Hcd,"queryPasteOptions"),97);this.Ca.pa(qa.a.mFk,Z.a.application,Object(w.a)(this,this.Hcd,"queryPasteOptions"),97);this.dEd?this.Ca.pa(qa.a.J$g,Z.a.application,Object(w.a)(this,this.yDe,"queryReformatPasteOptions"),97):this.Ca.pa(qa.a.K$g,Z.a.application,
Object(w.a)(this,this.yDe,"queryReformatPasteOptions"),97);this.Ca.pa(qa.a.L$g,Z.a.application,Object(w.a)(this,this.yDe,"queryReformatPasteOptions"),97);this.Ca.qV(qa.a.jVb,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"),1028);this.Ca.qV(qa.a.cut,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"),1028);this.Ca.pAa(qa.a.eDc,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"));this.Ca.pAa(qa.a.copy,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"));this.Pcf&&this.Ca.qV(qa.a.t_f,Z.a.view,
Object(w.a)(this,this.gLi,"dropBrowserContent"),1028);this.Ca.qV(qa.a.tqa,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"),1028);this.Ca.qV(qa.a.paste,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"),1028);this.Ca.qV(qa.a.iwa,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"),1028);this.Ca.qV(qa.a.M5g,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"),1028);this.Ca.qV(qa.a.xad,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"),1028);this.Ca.qV(qa.a.yad,Z.a.view,Object(w.a)(this,this.HV,
"clipboardAction"),1028);this.Ca.qV(qa.a.reformatPastedContent,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"),1028);this.Ca.qV(qa.a.bed,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"),1028);this.Ca.ya(qa.a.mfd,Z.a.view,e.ActionManager.Hg);this.Ca.ya(qa.a.Iwk,Z.a.view,e.ActionManager.Hg);this.Ca.ya(qa.a.d6g,Z.a.view,e.ActionManager.Hg);this.Ca.ya(qa.a.e6g,Z.a.view,e.ActionManager.Hg);this.Ca.ya(qa.a.f6g,Z.a.view,e.ActionManager.Hg);this.Ca.ya(qa.a.c6g,Z.a.view,e.ActionManager.Hg);this.Ca.pAa(qa.a.y7c,
Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"));this.Ca.pAa(qa.a.z7c,Z.a.view,Object(w.a)(this,this.z7c,"moveSelectedContentWithinCurrentParagraph"));this.Ca.pAa(qa.a.xsg,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"));this.Ca.pAa(qa.a.showPlaceholderGlossary,Z.a.view,Object(w.a)(this,this.HV,"clipboardAction"));this.Ca.ya(qa.a.YVf,Z.a.view,e.ActionManager.Hg);this.Ca.ya(qa.a.xWf,Z.a.view,e.ActionManager.Hg)}Hcd(Da,la,ma,Ea,ta){if(1===ma)return 32;ta[m.a.On]=!1;return 32}gLi(Da,la,ma,
Ea,ta,Ga){h.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var oa=Ga.DataTransfer;Ga=oa.getData("text/html");oa=oa.getData("text/plain");let sa=!1;const Ha=new r.DictionaryPropertySet;0<Ga.length?(h.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),Ha.setValue(aa.a.bU,Ga),sa=!0):0<oa.length&&(h.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),Ha.setValue(aa.a.veb,oa),sa=!0);if(sa){const bb=this.yM.ga(la);return this.rQf.create(Da,
la,bb,new y.a(()=>this.sYf(bb,Ha)),ma,Ea,ta,Ha)}return null}yDe(Da,la,ma,Ea,ta){if(la=Object(u.a)(Object,ta))v.AFrameworkApplication.Wj("Microsoft.Office.Web.SessionSettings.IWacWordShowKeepSourceFormattingOnPasteFloatieSettings"),!this.dEd&&Da===qa.a.K$g||this.dEd&&Da===qa.a.J$g?(Da=this.APb!==qa.a.reformatPastedContent&&this.APb!==qa.a.bed,la[m.a.On]=this.APb===qa.a.reformatPastedContent||Da):Da===qa.a.L$g&&(la[m.a.On]=this.APb===qa.a.bed);return 32}HV(Da,la,ma,Ea,ta,Ga){if(v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",
!1)){if((v.AFrameworkApplication.rO||v.AFrameworkApplication.lJ)&&!v.AFrameworkApplication.KPa||C.a.instance.ga(83))return new I(Da,la,ma,Ea,ta,Ga)}else if(v.AFrameworkApplication.rO||C.a.instance.ga(83))return new I(Da,la,ma,Ea,ta,Ga);const oa=this.yM.ga(la);1!==Ea&&oa&1&&(this.APb=la);1!==Ea&&Ga&&oa&1&&(this.uZe=Ga);1!==Ea&&!Ga&&oa&4096&&(Ga=this.uZe);return this.rQf.create(Da,la,oa,new y.a(()=>this.sYf(oa,Ga)),ma,Ea,ta,Ga)}z7c(Da,la,ma,Ea,ta,Ga){Ga=pa.a.ak(ja.a.instance.Oa.kb.Ua.node,Ga);return this.HV(Da,
la,ma,Ea,ta,Ga)}sYf(Da,la){return Da&256?new ia(this.nA):Da&2?Da&4096?new O(la,this.hd,this.Xj,D.App.instance.b5b,D.App.instance.bIb):new P(la,this.hd,D.App.instance.bIb):la.Sa(aa.a.veb)?new X(la,this.hd,D.App.instance.bIb):new O(la,this.hd,this.Xj,D.App.instance.b5b,D.App.instance.bIb)}static get S5g(){return A.a.v7a("Box4PasteScratchPad")}}Object(J.a)(Ka,"ClipboardActor",null,[])},695:function(J,V,d){J=d(0);var h=d(17),e=d(13),m=d(387),r=d(388);class v{constructor(F,I,H,L=0,E=0,aa=null,Q=null){this.commandId=
F;this.controlId=I;this.timeStamp=H;this.commandSurface=m.a[L];this.jv=r.a[E];this.contentType=aa;this.zld=Q}}Object(J.a)(v,"CommandActionInfo",null,[]);class A{constructor(){this.QIh=RegExp("(Close|TabSwitch|((Populate|Query|Report|Show|BrowserFocus).+)|(.+(Rendered|Seen|Scroll)))")}qSj(F){return!this.QIh.exec(F)}}Object(J.a)(A,"EventsCacheLoggingUtils",null,[]);var w=d(25),y=d(1087),u=d(740);d.d(V,"a",function(){return D});class D{constructor(){this.Hff=null;this.Zyd=20;this.dtc=this.S_a=this.BMb=
null}init(){this.Hff=new A;this.BMb=new h.a;this.S_a=new h.a;this.dtc=new h.a;this.Zyd=w.AFrameworkApplication.fa.Cc("MaxCommandClickedEventQueueSize",20);y.a.c6h(Object(e.a)(this,this.xri,"commandClickEventRaised"));u.a.instance.PEf(Object(e.a)(this,this.qKk,"recordActionEvent"))}wTe(F){F.count>this.Zyd&&F.removeAt(this.Zyd)}xri(F,I){this.BMb.insert(0,new v(I.commandId,I.controlId,I.time,I.commandSurface,I.jv,I.contentType));this.wTe(this.BMb)}qKk(F,I){this.S_a.insert(0,new v(I.actionName,I.controlId,
I.timeStamp,I.commandSurface,I.jv,I.contentType,I.zld));this.wTe(this.S_a);this.Hff.qSj(I.actionName)&&(this.dtc.insert(0,new v(I.actionName,I.controlId,I.timeStamp,I.commandSurface,I.jv,I.contentType,I.zld)),this.wTe(this.dtc))}static get instance(){return D.Ja||(D.Ja=new D)}}D.Ja=null;Object(J.a)(D,"CommandClickEventsCache",null,[])},697:function(J,V,d){function h(Da,la,ma,Ea){function ta(Ga){return Ga instanceof ma?Ga:new ma(function(oa){oa(Ga)})}return new (ma||(ma=Promise))(function(Ga,oa){function sa(Ya){try{bb(Ea.next(Ya))}catch(ua){oa(ua)}}
function Ha(Ya){try{bb(Ea["throw"](Ya))}catch(ua){oa(ua)}}function bb(Ya){Ya.done?Ga(Ya.value):ta(Ya.value).then(sa,Ha)}bb((Ea=Ea.apply(Da,la||[])).next())})}d.r(V);J=d(0);var e=d(386),m=d(77),r=d(135),v=d(90),A=d(65),w=d(285),y=d(25),u=d(45),D=d(268),F=d(54),I=d(94),H=d(26),L=d(38),E=d(84),aa=d(930),Q=d(922),O=d(920),T=d(923),K=d(924),X=d(927),P=d(928),ea=d(925),ia=d(921),ja=d(929),C=d(926),pa=d(55);class Z{createAuthProviderAsync(Da){pa.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").q4a();
return new Promise(la=>{pa.a.instance.Ka("PowerPointWebEditor.IAppForOfficeAuthFactory").execute(ma=>{ma=ma.dyi(Da);la(ma)})})}}Object(J.a)(Z,"SlideShowAppForOfficeAuthFactory",null,[]);var qa=d(975),ya=d(69);d.d(V,"SlideShowCoreFrame",function(){return Ka});class Ka{constructor(Da,la,ma,Ea,ta,Ga,oa,sa,Ha,bb,Ya,ua,Ma,Ca){this.Wm=this.wbc=this.e3c=null;this.Bda=new e.a;this.va=new m.a;this.tte="";this.ND=null;this.n6c="";this.Wre=this.uKg=this.kcc=this.xQ=this.A9=this.z9=this.$ta=this.K=null;this.mcc=
!0;this.UUa=Date.now();this.SUa=Date.now();this.wab=this.LRg=0;this.Czb=!1;this.Olk=()=>{H.a.J(512309270,830,50,"SlideShowSwitcher::OnEditHappened");this.SUa=Date.now()};this.Enk=()=>{H.a.J(512309269,830,50,"SlideShowSwitcher::OnLastMergeEditUTCChangedHandler");this.SUa=Date.now()};this.rpk=()=>{H.a.J(512309268,830,50,"SlideShowSwitcher::OnRealTimeEditHandler");this.SUa=Date.now()};this.gf=Da;this.la=la;this.Fc=ma;this.Dyb=Ea;this.Bl=ta;this.Rb=Ga;this.IN=sa;this.Nt=oa;this.ite=Ha;this.fe=bb;this.pHg=
Ya;this.Ei=ua;this.bO=Ma;this.ew=Ca;this.Lak=r.a.getInstance();this.pHg&&this.pHg.execute(Va=>{Va.wBc(this.Olk)});this.Ei&&(this.Ei.E5h(this.Enk),this.Ei.v7h(this.rpk));try{const Va=this.n4=JSON.parse(this.la.Ga("Settings"))||{};Va.slideshowcore||(Va.slideshowcore={});Va.slideshowcore&&Va.slideshowcore.forceSvg&&"true"===Va.slideshowcore.forceSvg.toString().toLowerCase()?this.ite=!0:this.ite&&(Va.slideshowcore.forceSvg="True")}catch(Va){H.a.J(512495906,830,15,"Exception in parsing settings:{0}",Va),
this.n4={}}}preloadShaders(){this.lMe();this.zid();SlideShowCore.SlideShowCore.preloadShaders()}init(Da,la,ma,Ea){this.tte=ma;this.bO=Ea;this.n6c=la;this.ND||(this.$ta=document.getElementById("HiddenFocusTrapAnchor"),this.ND=document.createElement("div"),this.ND.id="SlideShowBackground",this.ND.className="SlideShowBackground",this.ND.style.visibility=ya.a.As,this.ND.tabIndex=-1,this.K=document.createElement("div"),this.K.id="SlideShowContainer",this.K.className="SlideShowContainer",this.K.tabIndex=
-1,this.K.style.width=window.screen.width+"px",this.K.style.height=window.screen.height+"px",v.a.addHandler(this.ND,A.a.yva,ta=>{this.iok(ta)}),w.a.instance.ob(this.ND,ta=>this.Qdb(ta)),this.ND.appendChild(this.K),L.a("PresenterCoachTabFix")&&this.$ta?this.gf.insertBefore(this.ND,this.$ta):this.gf.appendChild(this.ND),Da=this.la.Ga("pptSlideShowCoreCssUrl"),la=document.createElement("link"),la.setAttribute("rel","stylesheet"),la.setAttribute("type","text/css"),la.setAttribute("href",Da),this.K.appendChild(la),
qa.a.instance.init(this.la,this.ND,this.Fc,this,this.Bl,this.Rb,this.IN),this.z9=document.getElementById("slideshowBeginningFocusTrap"),this.A9=document.getElementById("slideshowEndFocusTrap"),this.z9||this.A9||(this.z9=document.createElement("div"),this.z9.id="slideshowBeginningFocusTrap",this.z9.className="FocusTrap",this.z9.tabIndex=0,v.a.addHandler(this.z9,A.a.focus,ta=>{this.hfc(ta)}),this.A9=document.createElement("div"),this.A9.id="slideshowEndFocusTrap",this.A9.className="FocusTrap",this.A9.tabIndex=
0,v.a.addHandler(this.A9,A.a.focus,ta=>{this.hfc(ta)}),L.a("PresenterCoachTabFix")&&this.$ta?(this.gf.insertBefore(this.z9,this.gf.firstChild),this.gf.insertBefore(this.A9,this.$ta.nextSibling)):(Da=document.getElementById("slideshow-toolbar"),this.gf.insertBefore(this.z9,this.ND),this.gf.insertBefore(this.A9,Da))),this.cgg(1))}cgg(Da){const la=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.bO),ma={"Content-Type":"application/json; charset=utf-8",
WaitForSessionTimeoutMs:"0"};ma["X-UserSessionId"]=y.AFrameworkApplication.userSessionId;const Ea=new Date;this.ew.yj(la,1,"",ma,!1,0,ta=>{this.Exe(ta,Ea)},ta=>{this.Dxe(ta,Da)},null,null)}Exe(Da,la){H.a.J(512309283,830,50,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded. Time-Taken : {0}",+new Date-+la);Da=JSON.parse(Da.data.Sd);this.xQ=Da.downloadUrl;u.a.Va(this.xQ)?H.a.J(512309282,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlSucceeded but downloadUrl is null or empty - {0}",Da):(this.UUa=
Date.now(),this.Nyj())}Ieg(){const Da={};Da.settings=this.n4;Da.retryCount=this.la.Cc("GetItemsRetryCount",3);Da.retryOnCategories=this.la.Ga("GetItemsRetryCategories").split(";");const la={};la.Slide=ResourceStrings.l_Slide;la.AnimNum=ResourceStrings.l_AccSsAnimNum;la.SldNameWithTooltip=ResourceStrings.l_AccSsSldNameWithTooltip;la.SldNameWithoutTooltip=ResourceStrings.l_AccSsSldNameWithoutTooltip;la.AnimTotalSingular=ResourceStrings.l_AccSsAnimTotalSingular;la.AnimTotalPlural=ResourceStrings.l_AccSsAnimTotalPlural;
Da.localizedStrings=la;return Da}Nyj(){this.lMe();this.zid();this.e3c=new PodsProxy.PodsProxy(this.la.i7a?this.la.RNc:this.la.podsWebServiceBase,{DownloadUrl:this.xQ,DocID:y.AFrameworkApplication.hh,CustomFontCatalogUrl:this.la.Ga("CustomFontCatalogURL")},this.la.THa?u.a.WV(this.la.THa).toLowerCase():"",this.Bda,this.feg(),this.geg());this.wbc=new SlideShowCore.DefaultResourceProviders(this.e3c,this.Bda,this.Ieg());const Da={};Da.initTime=Ka.g1b();Da.uiHost="Unified App";Da.serverUrl=u.a.Qe(this.la.podsWebServiceBase);
Da.userSessionId=this.tte;Da.jsScriptsBasePath=this.la.Ga("StaticContentHost")+"pptscripts/ssapp/";Da.fileHost=this.la.Ga("FileHost");Da.isRtl=y.AFrameworkApplication.isRtl;Da.applicationLcid=y.AFrameworkApplication.lcid;Da.applicationLocaleName=y.AFrameworkApplication.uiCulture;Da.areThirdPartyAddInsAllowed=y.AFrameworkApplication.jqa;Da.theWsaClient=y.AFrameworkApplication.ej;Da.appForOfficeContextActivationParameters=aa.a.qgg(this.fe);Da.hubbleVideoEndpoint=this.la.insertOnlineVideoEndpoint;Da.acceptLanguage=
D.a.oe(y.AFrameworkApplication.lcid).name;this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.ModernSlideShowAddInSSO",!1)&&(Da.appForOfficeAuthFactory=new Z);const la={};la.settings=this.n4;la.transitionResourceCDNPath=this.la.wWf;la.transitionDisabledList=this.la.fKa;la.clickTargetEnabled=!0;la.mediaEnabled=!0;la.gifEnabled=!0;la.convertGifToVideo=!0;la.crossSlideAudioEnabled=!0;la.editAudioEnabled=this.la.ka("PPTOAudioPlaybackOptionsEnabled");la.flipgridVideoEnabled=this.la.ka("PptModernSlideShowFlipgridVideoEnabled");
la.useNewYoutubePlayer=!0;la.useNewVimeoPlayer=!0;la.useOnlineVideoPlayer=!0;la.tedVideoEnabled=this.la.ka("PptModernSlideShowTEDVideoEnabled");la.isStream2Enabled=this.la.ka("IsStream2VideoEnabled");la.endOfShowText=ResourceStrings.l_EndOfSlideShowMessage;la.enableSVGAsWebGLTexture=!F.a.eg&&this.la.ka("SlideShowShapeBuilderSVGEnabled");la.maxSvgTextureSize=this.la.Cc("ShapeBuilderMaxSvgTextureSize",2048);la.enableSlideSizeAdjust=this.la.ka("EnableSlideSizeAdjust");la.slideSizeMax={["x"]:this.la.Cc("SlideShowMaxWidth",
1504),["y"]:this.la.Cc("SlideShowMaxHeight",849)};la.slideSizeMin={["x"]:this.la.Cc("SlideShowMinWidth",348),["y"]:this.la.Cc("SlideShowMinHeight",261)};la.slideSizeDefault={["x"]:this.la.Cc("SlideShowDefaultWidth",1504),["y"]:this.la.Cc("SlideShowDefaultHeight",849)};la.streamVideoUseThinEmbed=this.la.ka("StreamVideoUseThinEmbed");la.slideMetadataEnabled=this.la.ka("PptModernSlideShowSlideMetadataEnabled");la.disabledChangeGates=this.la.Ga("PPTDisabledChangeGates");la.combineBootRequest=!0;la.localVideoTelemetryEnabled=
this.la.ka("IsGFXVideoLocalTelemetryEnabled");la.imageSettings={["imageAppendOption"]:"all"};const ma={["slideShowCoreSettings"]:la,["appSettings"]:Da};this.Wm=new SlideShowCore.SlideShowCore(this.K,this.wbc,this.Bda,ma);new SlideShowCore.PrefetchAddon(this.Wm,this.Bda,{["forwardPrefechCount"]:this.la.Cc("PptModernSlideShowForwardPrefetchCount",10),["backwardPrefechCount"]:this.la.Cc("PptModernSlideShowBackwardPrefetchCount",5),["forwardPrerenderCount"]:this.la.Cc("PptModernSlideShowForwardPrerenderCount",
2),["backwardPrerenderCount"]:this.la.Cc("PptModernSlideShowBackwardPrerenderCount",2)});new SlideShowCore.SlideAdvanceAddon(this.Wm,this.Bda);this.LRg=Date.now();this.Wre=this.Wm.init();this.Wre.then(()=>{this.mcc=!1;this.uKg=new SlideShowCore.InputsAddon(this.Wm,this.K,y.AFrameworkApplication.isRtl);new SlideShowCore.AnimationLoggerAddon(this.Wm,ma,this.Bda);new SlideShowCore.TransitionLoggerAddon(this.Wm,ma,this.Bda);new SlideShowCore.PerfCheckerAddon(this.Wm,ma,this.Bda);this.kcc=new SlideShowCore.SlideShowInkAddon(this.Wm,
this.Bda,this.K,()=>this.Dyb.loadScript("slideshowink"),{["telemetryLogger"]:this.Lak});this.uKg.events.on("keydown",Ea=>{this.BHa(Ea)})});this.Wm.events.on("slideLocationChanged",()=>{this.c$c()});this.Wm.events.on("animationStateChanged",()=>{this.c$c()});this.Wm.events.on("slideDimensionsChanged",()=>{this.getCurrentSlideDimensions()});this.Wm.events.on("exitFromEndOfShow",()=>{this.sxe(!0)});this.Wm.events.on("blankSlideStateChanged",Ea=>{this.hkk(Ea)});this.Wm.events.on("slideshowError",Ea=>
{this.a9c(Ea)})}geg(){const Da={};Da.timeout=this.la.Cc("PptModernSlideShowGetItemsTimeoutMs",3E4);Da.throwHttpErrors=!1;Da.enableServerSpecificErrorCode=L.a("SSCore.EnableServerSpecificErrorCode");return Da}zid(){try{const Da=this.n4;if(Da.slideshowcore){const la={};la.settings=Da;la.logger=this.Bda;la.disabledChangeGates=this.la.Ga("PPTDisabledChangeGates");window.SlideShowCore.setupGlobals_SlideShowCore(la)}}catch(Da){H.a.J(509703488,830,15,"Exception in passing settings to slideshowcore:{0}",
Da)}}lMe(){try{const Da=this.n4;if(Da.podsproxy){const la={};la.settings=Da;window.PodsProxy.setupGlobals_PodsProxy(la)}}catch(Da){H.a.J(512309267,830,15,"Exception in passing settings to podsproxy:{0}",Da)}}xEh(Da,la){return h(this,void 0,void 0,function*(){this.lMe();this.zid();this.e3c=new PodsProxy.PodsProxy(this.la.i7a?this.la.RNc:this.la.podsWebServiceBase,{DownloadUrl:this.xQ,DocID:y.AFrameworkApplication.hh,CustomFontCatalogUrl:this.la.Ga("CustomFontCatalogURL")},this.la.THa?u.a.WV(this.la.THa).toLowerCase():
"",this.Bda,this.feg(),this.geg());const ma=this.wbc;this.wbc=new SlideShowCore.DefaultResourceProviders(this.e3c,this.Bda,this.Ieg());yield this.Wm.updateResourceProviders(this.wbc,{shouldRerenderSlide:!0});ma&&ma.dispose();H.a.J(593827098,830,50,"Done updating ResourceProvider. StartUrl:{0}, downloadUrl:{1}, updatedResourceProvider:{2}, IsSlideShowVisible:{3}",Da,la,Date.now(),this.Twb())})}Dxe(Da,la){Da=Da.data?Da.data.Le:-1;0<la--?(H.a.J(512309281,830,15,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
Da),this.cgg(la)):H.a.J(512309280,830,10,"SlideShowCoreFrame - OnGettingSnappedUrlFailed : HttpStatus: {0}",Da)}fkd(Da,la,ma,Ea,ta,Ga,oa,sa,Ha){h(this,void 0,void 0,function*(){if(this.Wm&&!u.a.Va(this.xQ)){const bb={};this.SUa>this.UUa||this.mcc?(this.n4.slideshowcore.vetoBootDurationMs=this.la.Cc("PptModernSlideShowEditVetoBootDurationMs",8E3),bb.BootScenario=this.SUa>this.UUa?"AfterEdit":"Init",H.a.J(509703459,830,50,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",
this.la.Cc("PptModernSlideShowEditVetoBootDurationMs",8E3),this.SUa,this.UUa,this.mcc)):(this.n4.slideshowcore.vetoBootDurationMs=this.la.Cc("PptModernSlideShowCachedVetoBootDurationMs",2E3),bb.BootScenario="Relaunch",H.a.J(509703458,830,50,"SlideShowCoreFrame::StartFrom - Setting vetoBootDurationMs to: {0}, LastEditTime: {1}, LastSnapTime: {2}, SlideshowWaitedForInit: {3}",this.la.Cc("PptModernSlideShowCachedVetoBootDurationMs",2E3),this.SUa,this.UUa,this.mcc));this.zid();this.SUa>this.UUa&&(yield this.yEh(1));
bb.startFromTime=Ha-window.performance.timing.navigationStart;bb.SSCoreFrameStartTime=Ka.g1b();qa.a.instance.KQk();this.K.style.top="0";this.z9&&this.A9&&(this.z9.tabIndex=0,this.A9.tabIndex=0);const Ya={["slideId"]:{["sid"]:Da,["cid"]:0}};Ya.slideIndex=la-1;this.Nt.W4b&&!this.Nt.f8?this.ini(Ya,bb):this.N5f(Ya,bb)}else H.a.J(512495901,830,15,"Failed to get download Url")})}prev(){this.Wm&&this.Wm.prevStep("0_anim").then(()=>{})}next(){this.Wm&&this.Wm.nextStep("0_anim",3).then(()=>{})}show(){this.goc(!0)}Twb(){return this.ND&&
this.ND.style.visibility===ya.a.oz?!0:!1}V2(){return"Modern"}goc(Da){qa.a.instance.setVisibility(Da&&this.Fc.Kh);Da?(this.ND.style.visibility=ya.a.oz,$addHandler(window,"visibilitychange",la=>{this.UWa(la)})):(this.ND.style.visibility=ya.a.As,$removeHandler(window,"visibilitychange",la=>{this.UWa(la)}))}exit(){this.sxe(!1)}QLc(){this.sxe(!1)}transcribe(Da,la,ma,Ea,ta,Ga,oa){const sa=!!this.Rb&&!!this.Rb.instance&&(this.Rb.instance.bQa||this.Rb.instance.Rq);(this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&
this.Rb.instance.$Ba||sa)&&!this.Rb.instance.gsb()?H.a.J(512495900,830,50,"SlideShowCoreFrame::Transcribe - LivePresenter prevented transcriber from starting"):(qa.a.instance.transcribe(Da,la,ma,Ea,ta,Ga,oa),this.Fc.Kh&&this.Wm.recordSessionStats({["metadata"]:"subtitles"}),this.mUd())}N5f(Da,la){this.Wm.clearNavigationState();const ma={navigationType:"init"};ma.startFromTime=la.startFromTime;la.waitedForInit=this.mcc;la.startInitTime=this.LRg;la.beforeInitPromise=Ka.g1b();this.Wre.then(()=>{la.afterInitPromise=
Ka.g1b();ma.bootMetrics=la;if(0>Da.slideIndex)this.Wm.gotoFirstSlide(!0,ma).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)});else{const Ea={};Ea.actionContext=ma;Ea.fSkipTransition=!0;this.Wm.gotoSlide(Da,Ea).then(()=>{this.K.style.height="100%";this.K.style.width="100%";this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)})}})}ini(Da,la){const ma=this.la.Cc("PptModernSlideShowCheckFullscreenCounter",10);let Ea=ma;this.wab=
window.setInterval(()=>{Ea--;H.a.J(512495899,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen counter: {0}.",Ea);if(this.Nt.f8||0>=Ea){window.clearInterval(this.wab);this.wab=0;const ta=20*(ma-Ea);la.checkFullscreenMs=ta;H.a.J(512495898,830,50,"SlideShowCoreFrame::StartFrom - check fullscreen duration: {0} ms.",ta);this.N5f(Da,la)}},20)}mUd(){let Da=0,la=100;this.Fc.Kh&&qa.a.instance.isVisible()&&("AboveSlide"===this.Fc.Fv?(Da=15,la=85):"BelowSlide"===this.Fc.Fv&&(la=85));const ma=document.getElementById("LiveURLBarLayerHost");
this.Czb&&ma?(this.K.style.top=String.format("calc({0}% + {1})",Da.toString(),"26px"),this.K.style.height=String.format("calc({0}% - {1})",la.toString(),"26px")):(this.K.style.top=Da.toString()+"%",this.K.style.height=la.toString()+"%")}setMicrophoneState(Da){qa.a.instance.setMicrophoneState(Da)}NJb(Da,la=""){this.Czb=Da;qa.a.instance.Tyh(Da,la);this.mUd()}toggleTranscriberUIVisibility(Da){qa.a.instance.setVisibility(Da);qa.a.instance.RBc();this.mUd()}GSe(){this.va.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}restoreFocus(){this.ND.style.visibility===ya.a.As||this.N$d()||this.K.focus()}pausePresentation(){}getCurrentPosition(){if(this.Wm){const Da=this.Wm.getSlideLocation();Da?this.va.raiseEvent("OnGetCurrentPosition",new T.a({["SlideId"]:Da.slideId.sid,["SlideIndex"]:Da.slideIndex})):H.a.J(512495897,830,15,"SlideShowCoreFrame::GetCurrentPosition: currentLocation is null")}}getCurrentPositionWithTimeLines(){if(this.Wm){const Da=this.Wm.getSlideLocation();if(Da){const la=this.Wm.getAnimationState(!0),
ma=la.timelineStates,Ea=[];for(let ta=0;ta<ma.length;ta+=1)Ea.push({["TimeLineId"]:ma[ta].timelineId,["Step"]:ma[ta].step,["LastClickTime"]:ma[ta].lastClickTime,["StartTimeOffset"]:la.startTimeOffset});this.va.raiseEvent("OnGetCurrentPosition",new T.a({["SlideId"]:Da.slideId.sid,["SlideIndex"]:Da.slideIndex,["TimeLineMappings"]:Ea}))}else H.a.J(512495896,830,15,"SlideShowCoreFrame::GetCurrentPositionWithTimeLines: currentLocation is null")}}getCurrentSlideDimensions(){if(this.Wm&&this.ND.style.visibility!==
ya.a.As){const Da=document.getElementById(this.ite?"svg-canvas":"webgl-canvas");Da&&this.va.raiseEvent("OnGetCurrentSlideDimensions",new K.a({["SlideHeight"]:Da.offsetHeight,["SlideWidth"]:Da.offsetWidth,["SlideLeftBound"]:Da.offsetLeft,["SlideBottomBound"]:Da.offsetTop+Da.offsetHeight}))}}mRa(Da){this.Wm&&this.Wm.gotoSlide({["slideIndex"]:Da},{actionContext:{navigationType:"goto"},fSkipTransition:!1}).then(()=>{})}Fig(Da,la){if(this.Wm){const ma={},Ea=[];let ta=0;for(let Ga=0;Ga<la.length;Ga+=1){const oa=
{};oa.timelineId=la[Ga].TimeLineId;oa.step=la[Ga].Step;oa.lastClickTime=la[Ga].LastClickTime;ta=la[Ga].StartTimeOffset;Ea.push(oa)}ma.timelineStates=Ea;ma.startTimeOffset=ta;la={actionContext:{navigationType:"goto"}};la.animationState=ma;la.fSkipTransition=!1;this.Wm.gotoSlide({["slideIndex"]:Da},la).then(()=>{})}}yEh(Da){return h(this,void 0,void 0,function*(){H.a.J(512309260,830,50,"updateSlideShowCoreAfterEdit: CurrentPodSessionId:{0}",this.bO);const la=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",
this.la.podsWebServiceBase,this.bO),ma={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};ma["X-UserSessionId"]=y.AFrameworkApplication.userSessionId;const Ea=new Date;return new Promise((ta,Ga)=>{this.ew.yj(la,1,"",ma,!1,0,oa=>h(this,void 0,void 0,function*(){yield this.Smk(oa,Ea);ta()}),oa=>h(this,void 0,void 0,function*(){yield this.Qmk(oa,Da);Ga()}),null,null)})})}Smk(Da,la){return h(this,void 0,void 0,function*(){const ma=new Date;H.a.J(512309279,830,50,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit. Time-Taken : {0}",
+ma-+la);const Ea=JSON.parse(Da.data.Sd);this.xQ=Ea.downloadUrl;u.a.Va(this.xQ)?H.a.J(512309278,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededAfterEdit but downloadUrl is null or empty : {0}",Ea):(this.UUa=Date.now(),yield this.xEh(la,ma))})}Qmk(Da,la){return h(this,void 0,void 0,function*(){const ma=Da.data?Da.data.Le:-1;0<la--?(H.a.J(512309277,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
ma),yield this.yEh(la)):H.a.J(512309276,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedAfterEdit : HttpStatus: {0}",ma)})}refreshPodSession(Da,la,ma=1){H.a.J(512309259,830,50,"RefreshPodSession: CurrentPodSessionId:{0}, UpdatedPodSessionId:{1}",this.bO,Da);this.bO=Da;this.n6c=la;Da=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}",this.la.podsWebServiceBase,this.bO);la={"Content-Type":"application/json; charset=utf-8",WaitForSessionTimeoutMs:"0"};la["X-UserSessionId"]=
y.AFrameworkApplication.userSessionId;const Ea=new Date;this.ew.yj(Da,1,"",la,!1,0,ta=>h(this,void 0,void 0,function*(){yield this.Tmk(ta,Ea)}),ta=>h(this,void 0,void 0,function*(){yield this.Rmk(ta,ma)}),null,null)}Tmk(Da,la){return h(this,void 0,void 0,function*(){var ma=new Date;H.a.J(512309275,830,50,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession. Time-Taken : {0}",+ma-+la);const Ea=JSON.parse(Da.data.Sd);this.xQ=Ea.downloadUrl;u.a.Va(this.xQ)?(H.a.J(512309274,830,10,"SlideShowCoreFrame - onGettingSnappedUrlSucceededOnRefreshPodSession but downloadUrl is null or empty : {0}",
Ea),this.Twb()&&(ma=E.a.Qh(413),y.AFrameworkApplication.jp(ma),I.Health.instance.recordQosError(E.a.tba(ma),["SlideShowACE"],!1,!0,!0,!0,null),this.Wm&&this.Wm.recordSessionStats({["errorName"]:"ErrorSlideShowRehydrationFailed"}),this.exit())):(this.UUa=Date.now(),yield this.xEh(la,ma))})}Rmk(Da,la){Da=Da.data?Da.data.Le:-1;0<la--?(H.a.J(512309273,830,15,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : Retrying to Get Snapped Download Url. Current Retry Count: {0}, HttpStatus: {1}",
Da),this.refreshPodSession(this.bO,this.n6c,la)):(H.a.J(512309272,830,10,"SlideShowCoreFrame - onGettingSnappedUrlFailedOnRefreshPodSession : HttpStatus: {0}",Da),this.Twb()&&this.exit())}setVisibility(Da){this.goc(Da)}hfa(Da){this.ND.style.cursor=Da?"default":"none";qa.a.instance.hfa(Da)}setOsfLocalStorage(){}bBe(Da){if(this.kcc)this.kcc.onInkManagerActivity(Da)}BHa(Da){this.SJe(Da)}SJe(Da){this.va.raiseEvent("OnSpecialKey",new ia.a({["Key"]:Da.keyCode,["ShiftKey"]:Da.shiftKey}))}Qlh(){}hfc(){this.ND&&
this.restoreFocus()}feg(){const Da=new Map;Da.set("X-UserSessionId",this.tte);Da.set("X-WacNoAuth","1");Da.set("X-WacCluster",this.n6c);Da.set("Client","Unified App");this.la.I7i&&Da.set("UseDocCache","True");return Da}sxe(Da=!1){this.wab&&(H.a.J(512495890,830,50,"SlideShowCoreFrame::OnExitFromSlideShowHandler m_fullscreenCheckerId is not zero: {0}",this.wab),window.clearInterval(this.wab),this.wab=0);this.kcc&&this.kcc.resetInkCanvas();this.z9&&this.A9&&(this.z9.tabIndex=-1,this.A9.tabIndex=-1);
if(this.Wm){const la=this.Wm.getSlideLocation();this.Wm.endSession(Ka.g1b());la?this.va.raiseEvent("OnExit",new O.a({["SlideId"]:la.slideId.sid,["IsBeforeReady"]:!1,["SlideIndex"]:la.slideIndex,["IsFromEndOfSlideshow"]:Da})):H.a.J(512495889,830,15,"SlideShowCoreFrame::OnExitFromSlideShowHandler: currentLocation is null")}this.K.style.width=window.screen.width+"px";this.K.style.height=window.screen.height+"px";this.goc(!1);qa.a.instance.WPe()}c$c(){if(this.Wm&&this.ND.style.visibility!==ya.a.As){const Da=
this.Wm.getSlideLocation();if(Da){const la=this.Wm.getAnimationState(!0),ma=la.timelineStates,Ea=[];for(let ta=0;ta<ma.length;ta+=1)Ea.push({["TimeLineId"]:ma[ta].timelineId,["Step"]:ma[ta].step,["LastClickTime"]:ma[ta].lastClickTime,["StartTimeOffset"]:la.startTimeOffset});this.va.raiseEvent("OnPositionChangeEventId",new P.a({["SlideId"]:Da.slideId.sid,["SlideIndex"]:Da.slideIndex,["TimeLineMappings"]:Ea}))}else H.a.J(512495888,830,50,"SlideShowCoreFrame::OnPositionChangedHandler: currentLocation is null")}}hkk(Da){if(this.Wm&&
this.ND.style.visibility!==ya.a.As)switch(Da){case "Hidden":this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty);break;case "EndOfShow":this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty);break;default:H.a.J(512495887,830,50,"SlideshowCoreFrame.OnBlankSlideStateChangedHandler {0}",Da)}}a9c(Da){if(this.Wm){H.a.J(512495886,830,15,"SlideshowCoreFrame.OnErrorHandler {0}",Da);let la;Da.startsWith("Server")&&(Da="GetItemsRequestFailed");switch(Da){case "GetItemsFailedDownloadFile":H.a.J(512495885,
830,50,"SlideshowCoreFrame.OnErrorHandler ErrorSlideShowFailedToDownloadFile PodSessionId {0}",this.bO);this.va.raiseEvent("OnPodSessionExpired",new X.a({["Code"]:5341407,["Reason"]:"Failed To Download File",["PodSessionId"]:this.bO}));return;case "LoadFailed":la=407;break;case "GetItemsFailedInvalidResponse":la=408;break;case "GetItemsRequestFailed":la=409;break;case "GetItemsTimeout":la=411;break;case "EnsureSlideFailed":la=412;break;case "SetupWebGLContextFailed":case "RestoreWebGLContextFailed":la=
414;break;default:la=359}0!==la&&(this.Twb()?(Da=E.a.Qh(la),y.AFrameworkApplication.jp(Da),I.Health.instance.recordQosError(E.a.tba(Da),["SlideShowACE"],!1,!0,!0,!0,null),this.Wm.recordSessionStats({["errorName"]:E.a.tba(Da)})):H.a.J(512495884,830,15,"SlideshowCoreFrame.OnErrorHandler received error when frame is hidden. ErrorCode:{0}",Da))}}J$c(Da){H.a.J(512495883,830,50,"SlideshowCoreFrame.OnTranscriberStartedHandler");this.Wm&&this.ND.style.visibility!==ya.a.As&&this.va.raiseEvent("OnTranscriberStartedEventId",
new ja.a({["TranscriberSessionId"]:Da}));this.Fc.isb=!0}UWa(){H.a.J(512495882,830,50,"SlideshowCoreFrame.OnVisibilityChangeHandler");window.document.hidden&&this.va.raiseEvent("OnVisibilityChangeEventId",new C.a(!1))}N$d(){return!!this.Rb&&!!this.Rb.instance&&this.Rb.instance.L3f}ABc(Da){this.va.addHandler("OnSlideshowReady",Da)}Oed(Da){this.va.removeHandler("OnSlideshowReady",Da)}BId(Da){this.va.addHandler("OnBrowserEvent",Da)}gGe(Da){this.va.removeHandler("OnBrowserEvent",Da)}dFf(Da){this.va.addHandler("OnFullscreenClick",
Da)}ofh(Da){this.va.removeHandler("OnFullscreenClick",Da)}DId(Da){this.va.addHandler("OnSlideshowContextMenu",Da)}iGe(Da){this.va.removeHandler("OnSlideshowContextMenu",Da)}sha(Da){this.va.addHandler("OnExit",Da)}Nea(Da){this.va.removeHandler("OnExit",Da)}aFf(Da){this.va.addHandler("OnSlideshowError",Da)}lfh(Da){this.va.removeHandler("OnSlideshowError",Da)}xBc(Da){this.va.addHandler("OnGetCurrentSlideDimensions",Da)}Med(Da){this.va.removeHandler("OnGetCurrentSlideDimensions",Da)}cUb(Da){this.va.addHandler("OnGetCurrentPosition",
Da)}Cfb(Da){this.va.removeHandler("OnGetCurrentPosition",Da)}BBc(Da){this.va.addHandler("OnSpecialKey",Da)}Ped(Da){this.va.removeHandler("OnSpecialKey",Da)}qFf(Da){this.va.addHandler("OnVisibilityChangeEventId",Da)}pGe(Da){this.va.removeHandler("OnVisibilityChangeEventId",Da)}IId(Da){this.va.addHandler("OnPodSessionExpired",Da)}mGe(Da){this.va.removeHandler("OnPodSessionExpired",Da)}hFf(Da){this.va.addHandler("OnLogEndOfTranscriptionSession",Da)}qfh(Da){this.va.removeHandler("OnLogEndOfTranscriptionSession",
Da)}INa(Da){this.va.addHandler("OnPositionChangeEventId",Da)}Dfb(Da){this.va.removeHandler("OnPositionChangeEventId",Da)}gFf(Da){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",Da)}pfh(Da){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",Da)}FId(Da){this.va.addHandler("OnEnterEndOfShowEventId",Da)}jGe(Da){this.va.removeHandler("OnEnterEndOfShowEventId",Da)}HId(Da){this.va.addHandler("OnLeaveEndOfShowEventId",Da)}lGe(Da){this.va.removeHandler("OnLeaveEndOfShowEventId",Da)}oFf(Da){this.va.addHandler("OnSubtitleUpdatedEventId",
Da)}xfh(Da){this.va.removeHandler("OnSubtitleUpdatedEventId",Da)}pFf(Da){this.va.addHandler("OnTranscriberStartedEventId",Da)}yfh(Da){this.va.removeHandler("OnTranscriberStartedEventId",Da)}xFf(Da){this.va.addHandler("RecordQosErrorEventId",Da)}Gfh(Da){this.va.addHandler("RecordQosErrorEventId",Da)}iok(Da){this.va.raiseEvent("OnBrowserEvent",new Q.a({["ClientX"]:Da.clientX,["ClientY"]:Da.clientY}))}Qdb(Da){this.va.raiseEvent("OnSlideshowContextMenu",new ea.a({["ClientX"]:Da.clientPoint.x,["ClientY"]:Da.clientPoint.y}));
return!0}static g1b(){return Math.round(window.performance.now())}}Object(J.a)(Ka,"SlideShowCoreFrame",null,[322])},698:function(J,V,d){d.r(V);J=d(0);var h=d(703),e=d(25),m=d(45),r=d(54),v=d(106),A=d(1167),w=d(1168),y=d(22),u=d(324);const D=(K,X)=>{if(K){K=K.trim().toLowerCase();if("true"===K)return!0;if("false"===K)return!1}return X};var F=d(714),I=d(26),H=d(936),L;(function(K){K[K.none=0]="none";K[K.internal=1]="internal";K[K.clipService=2]="clipService"})(L||(L={}));Object(J.b)("ClipboardIframeContent",
L);var E=d(375),aa=d(665),Q=d(433),O=d(46);d.d(V,"ClipboardHelper",function(){return T});class T{constructor(K,X,P,ea,ia,ja){this.l1j=[u.a.uZ,u.a.Np,u.a.location,u.a.BE,u.a.type,u.a.bwe,u.a.count,u.a.ODa,u.a.MDa,u.a.fhb,u.a.slideId,u.a.sessionId,u.a.timeStamp,u.a.kz];this.wqe=new h.a;this.Ope=new A.a(w.a.Tq());this.Aq=K;this.DGg=X;this.wc=ja;if(P&&0<P.length){K=P.split(";");for(const C of K)K=this.qdg(C),0<K.length&&this.wqe.add(K)}this.m1j=ea;this.c6j=ia;if(this.WUc()){ea=e.AFrameworkApplication.fa.Ga("PicklingAPIMaxPackageSizeInMB").split(";");
for(const C of ea)ea=C.split(":"),2===ea.length&&0<ea[0].length&&0<ea[1].length&&this.Ope.add(ea[0],parseInt(ea[1]))}}apd(K,X,P,ea,ia,ja,C){if(K.contentWindow&&K.contentWindow.document&&K.contentWindow.document.body){O.a.MEc(K);const Z=O.a.vba();var pa=document.createTextNode(O.a.Ave);Z.appendChild(pa);pa=null;let qa=0;if(!X)I.a.J(512329178,826,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: internalClipboardObjects is empty for ccpCorrId: {0}",C),Sys.UI.DomElement.addCssClass(Z,O.a.aVd);
else if(X.length&&X[0]&&X[0].y4a&&(Sys.UI.DomElement.addCssClass(Z,this.Aq.Nq[0].y4a),qa=1,P)){m.a.Va(P.BE)&&I.a.J(512329177,307,10,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: DC was empty for the given ccpid: {0}",P.Np);qa=2;X=F.a(P.dataType);Z.setAttribute(u.a.uZ,P.uZ);Z.setAttribute(u.a.LOa,P.LOa);Z.setAttribute(u.a.Np,P.Np);Z.setAttribute(u.a.version,P.version);Z.setAttribute(u.a.location,P.location);Z.setAttribute(u.a.BE,P.BE);Z.setAttribute(u.a.type,X);Z.setAttribute(u.a.count,
P.objectCount.toString());Z.setAttribute(u.a.ODa,P.ODa);Z.setAttribute(u.a.MDa,P.MDa);Z.setAttribute(u.a.kz,P.kz);const ya=(new Date).toUTCString();I.a.J(512329176,307,50,"ClipboardHelper::WriteClipboardObjectsToClipboardTarget: A {0} cut/copy:{1} was performed at UTC Time: {2}",X,P.ODa,ya);Z.setAttribute(u.a.timeStamp,ya);if(1===P.dataType||2===P.dataType)X=String.format("{0}GetClipboardBytes.ashx",e.AFrameworkApplication.fa.Ga("361"))+"?Id="+m.a.Qe(P.Np)+"&DC="+m.a.Qe(P.BE)+"&pkey="+m.a.Qe(P.kz)+
"&wdwaccluster="+m.a.Qe(P.BE)+"&DataType="+X,Z.setAttribute(u.a.Ypi,X);P.kec&&Z.setAttribute(u.a.bwe,this.O1k(P.kec));1===P.dataType&&this.c6j&&(pa=O.a.SB(),pa.id=u.a.Kng,pa.setAttribute(u.a.fxj,"true"),P=String.format("{0}GetClipboardImage.ashx",e.AFrameworkApplication.fa.Ga("361"))+"?Id="+m.a.Qe(P.Np)+"&DC="+m.a.Qe(P.BE)+"&pkey="+m.a.Qe(P.kz)+"&wdwaccluster="+m.a.Qe(P.BE),pa.src=P)}Z.setAttribute(u.a.sessionId,ea);Z.setAttribute(u.a.fhb,ia?ia.join(","):"");ja?Z.setAttribute(u.a.slideId,ja.cid.toString()+
"+"+ja.sid.toString()):Z.setAttribute(u.a.slideId,"");K.contentWindow.document.body.appendChild(Z);pa&&K.contentWindow.document.body.appendChild(pa);this.wc.Wh(E.a.$wi,L[qa],C)}}UMj(K){var X="";r.a.Nj?X="Chromium":r.a.eg?X="Firefox":r.a.W5b&&(X="Safari");X=this.Ope.Jb(X)?this.Ope.ga(X):0;(X=Math.ceil(K)<=X)||I.a.J(512329175,307,15,"Package size exceeds for pickling paste browser:{0}, size:{1}",r.a.zy,K);return X}LHj(K){return K&&Sys.UI.DomElement.containsCssClass(K,O.a.aVd)?!0:!1}OHj(K){return!!K&&
!!K.getAttribute&&D(K.getAttribute(u.a.MDa),!1)}fSj(K){return!!K&&!!K.$m&&!!K.$m.firstChild&&!!K.$m.firstChild.className&&this.gSj(K.$m.firstChild.className)}gSj(K){return!!K&&K.startsWith("CID")&&v.a.isValid(K.substring(3,K.length))}XRj(K){return!!K&&!!K.Np&&!!K.BE&&0!==K.dataType&&0<K.objectCount&&!!K.kz}Xal(K){if(!this.aEj(K))return I.a.J(512329174,307,50,"DC '{0}' is not allowed",K.BE),!1;if(K.wra&&"TimeStamp"in K.wra){var X=new Date(Date.parse(K.wra.TimeStamp));K=60*this.m1j-5;X=T.RMf(X);if(X>=
K)return I.a.J(512329173,307,50,"The data copied expired: expireTime: '{0}', elapsedTime: '{1}'.",K,X),!1}return!0}qdg(K){return K?K.trim().toUpperCase():""}aEj(K){return!this.z$d(K)||this.wqe.contains(this.qdg(K.BE))||this.wqe.contains("ALL")}Ktg(K){return!!K&&!!K.eW&&!!K.eW.length&&!!K.eW[0]}Ltg(K){return this.Ktg(K)&&Object(y.a)(Q.a,K.eW[0])}TEj(K){return this.Ktg(K)&&Object(y.a)(aa.a,K.eW[0])}Y9d(K){return!!K&&!!K.lu&&this.Xal(K.lu)}SEj(K){return this.Y9d(K)&&1===K.lu.dataType}REj(K){return this.Y9d(K)&&
2===K.lu.dataType}QEj(K){return this.Y9d(K)&&3===K.lu.dataType}UEj(K){return!!K&&!!K.SL}VEj(K){return this.UEj(K)&&1===K.SL.contentType}WUc(){return!(r.a.Vw||r.a.W5b)&&e.AFrameworkApplication.fa.ka("PicklingAPISlidePasteEnabled")}fqi(K,X){if(K&&X&&K.getAttribute)for(const P of this.l1j){const ea=K.getAttribute(P);ea&&X.setAttribute(P,ea)}}z$d(K){if(K.BE!==this.DGg)return I.a.J(512329172,307,50,String.format("IsCrossDCPaste: It's a cross-dc paste '{0}': from '{1}' to '{2}', {3}.",F.a(K.dataType),K.BE,
this.DGg,K.Np)),!0;I.a.J(512329171,307,50,String.format("IsCrossDCPaste: It's a paste '{0}' in '{1}', {2}.",F.a(K.dataType),K.BE,K.Np));return!1}zQi(K,X){var P=K.getAttribute(u.a.Np),ea=parseInt(K.getAttribute(u.a.version)),ia=K.getAttribute(u.a.kz),ja=parseInt(K.getAttribute(u.a.uZ)),C=parseInt(K.getAttribute(u.a.LOa)),pa=K.getAttribute(u.a.type);pa=pa?F.b(pa):2;var Z=Object,qa=Z.assign,ya=new H.a;ja=isNaN(ja)?32:ja;C=isNaN(C)?0:C;ea=isNaN(ea)?0:ea;var Ka=K.getAttribute(u.a.location),Da=K.getAttribute(u.a.BE),
la=K.getAttribute(u.a.count);la=parseInt(la);P=qa.call(Z,ya,{uZ:ja,LOa:C,Np:P,version:ea,location:Ka,BE:Da,dataType:pa,objectCount:isNaN(la)?-1:la,ODa:D(K.getAttribute(u.a.ODa),!1),MDa:D(K.getAttribute(u.a.MDa),!1),kz:ia});ia=T.GQi(K);pa=T.KQi(K);P.wra={["SessionId"]:ia,["TimeStamp"]:pa?pa.toUTCString():""};X=T.iMd(P,pa,this.wc,X);I.a.J(512329170,307,50,"ExtractClipboardObjectFromClipboard: {0}",X);if(K=K.getAttribute(u.a.bwe))P.kec=this.gHi(K);return P}O1k(K){return JSON.stringify(K)}gHi(K){try{return JSON.parse(K)}catch(X){return I.a.J(512329169,
826,15,"{0} when parse json string: {1}",X.toString(),K),null}}static bug(K){return K&&K.wra&&"SessionId"in K.wra?T.Syg(K.wra.SessionId.toString()):!1}static Syg(K){return m.a.Va(K)||m.a.Va(e.AFrameworkApplication.userSessionId)?!1:e.AFrameworkApplication.userSessionId.toLowerCase()===K.toLowerCase()}static iMd(K,X,P,ea){const ia=F.a(K.dataType);K=String.format("A {0} ClipServiceObject was just created: '{1}'",ia,K);X&&(X=T.RMf(X),K+=String.format(", time elapsed between COPY and PASTE: {0} seconds.",
X),P.Wh("CopyPasteElapsedSec",X.toString(),ea));return K}static GQi(K){K=K.getAttribute(u.a.sessionId);return void 0===K||null===K?"":K}static KQi(K){K=K.getAttribute(u.a.timeStamp);return void 0===K||null===K?null:new Date(Date.parse(K))}static RMf(K){var X=new Date;if(!K)throw Error.argumentNull("fromTime");if(!X)throw Error.argumentNull("toTime");return(X.getTime()-K.getTime())/1E3}}Object(J.a)(T,"ClipboardHelper",null,[1128])},712:function(J,V,d){J=d(0);var h=d(13),e=d(25),m=d(80),r=d(54),v=d(106);
class A{constructor(I,H){this.message=I;this.Vi=H}}Object(J.a)(A,"CrossDocumentEventArgs",null,[]);var w=d(521),y=d(171),u=d(564),D=d(904);d.d(V,"a",function(){return F});class F{constructor(I,H,L,E){this._name="";this.KKa={};this.qgf=null;this.nRb=[];this.ZNb=[];this.$Nb=[];this.zQb=[];this.Nyf=I;this.Myf=H;this.s6={};this.paa={};this.iQb=L;F._id++;E&&E();this.bG=this.enable()}get OJa(){return this.Myf}get xxh(){return this.Nyf}enable(){if(!u.a())return D.a.sendTraceTag(5018251,2,"Not supported for current browser."),
!1;this.DCj();D.a.sendTraceTag(5018252,2,"Enabled.");return!0}isEnabled(){return this.bG}DCj(){D.a.debugAssertTag(5018253,!!this.iQb,null);this.qgf=Object(h.a)(this,this.afk,"messageListener");this.iQb.vci(this.qgf)}disable(){this.bG=!1;this.nRb=[];this.ZNb=[];this.$Nb=[];this.zQb=[];this.Nyf=null;this.Myf="";this.iQb.CHi();this.s6={};this.paa={}}dispose(){this.disable()}Sae(I){return!!this.nRb&&Array.contains(this.nRb,I)||this.cxg(I)}cxg(I){return!!this.ZNb&&Array.contains(this.ZNb,I)}fu(I){D.a.debugAssertTag(5018259,
!!this.nRb,null);Array.add(this.nRb,I);D.a.sendTraceTag(5018260,2,"Allow receiving : {0}",I)}FCf(I){D.a.debugAssertTag(5018261,!!this.ZNb,null);Array.add(this.ZNb,I);D.a.sendTraceTag(5018262,2,"Allow free receiving: {0}",I)}cLj(I){return!!this.$Nb&&Array.contains(this.$Nb,I)}GCf(I){D.a.debugAssertTag(5018263,!!this.$Nb,null);Array.add(this.$Nb,I);D.a.sendTraceTag(5018264,2,"Allow free sending: {0}",I)}w5b(I){I=m.a.AS(I);return!!I&&!!this.zQb&&Array.contains(this.zQb,I)}LAc(I){D.a.debugAssertTag(5018265,
!!this.zQb,null);if(I===F.sUb)return D.a.debugAssertTag(5018266,!1,null),!1;const H=m.a.AS(I);if(!H)return D.a.sendTraceTag(5018267,4,"Get origin fail:{0}",I),!1;Array.add(this.zQb,H);D.a.sendTraceTag(5018268,2,"Add origin:{0}",H);return!0}send(I,H=null){let L=this.OJa;if(H){H=m.a.AS(H);if(!H)return!1;L=H}return this.tgb(I,this.xxh,L)}sendMessage(I,H,L=""){L=L&&""!==L?L:v.a.create().toString();return this.send(this.uze(I,H,L,e.AFrameworkApplication.userSessionId))}postMessage(I){const H=v.a.create().toString();
if(!e.AFrameworkApplication.fa.ka("RetryablePostMessagingIsEnabled")||!I.shouldRetry)return this.send(this.uze(I.messageId,I.values,H,I.userSessionId));if(!this.s6[I.vAc]){this.fu(I.vAc);const L=Object(h.a)(this,this.ackMessageHandler,"ackMessageHandler");this.kB(I.vAc,L)}this.KKa[H]="";return this.x7g(I,H,1)}x7g(I,H,L){if(""!==H&&H in this.KKa&&"ACK_RECEIVED"===this.KKa[H])return delete this.KKa[H],!0;if(L>I.xva)return D.a.sendTraceTag(40716250,4,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',
I.vAc,H),delete this.KKa[H],!1;D.a.sendTraceTag(40716251,1<L?4:2,'Sending postmessage. Attempts remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',I.xva-L,I.messageId,H);L++;window.setTimeout(()=>{this.x7g(I,H,L)},I.$_h);I.values[y.a.Z_h]=!0;return this.send(this.uze(I.messageId,I.values,H,I.userSessionId))}ackMessageHandler(I){I=I.CorrelationId;""!==I&&I in this.KKa&&(D.a.sendTraceTag(42783044,2,"Received Ack for Message {0} CorrelationId: {1}",this.KKa[I],I),this.KKa[I]="ACK_RECEIVED")}uze(I,
H,L,E){I=new w.a(I);I.CorrelationId=L;H&&(I.Values=H);I.Values.wdUserSession=E;return I}tgb(I,H,L){D.a.debugAssertTag(5018269,!!I,null);if(!this.bG)return!1;D.a.debugAssertTag(5018270,!!H,null);D.a.debugAssertTag(5018271,!!L,null);if(!H||!L)return D.a.debugAssertTag(5018272,!1,null),!1;if(L===F.sUb&&!this.cLj(I.MessageId))return D.a.sendTraceTag(5018273,1,"Got unregistered message {0}",{["id"]:I.MessageId}),!1;I.SendTime=(new Date).getTime();let E="";try{E=Sys.Serialization.JavaScriptSerializer.serialize(I)}catch(aa){return D.a.sendTraceTag(5018274,
4,"JSON Ser failed {0}",{["Exception"]:aa.message}),!1}H=F.sendMessage(H,E,L);D.a.sendTraceTag(5018275,2,"Send {0}. {1}",H?"succeeded":"failed",{["id"]:I.MessageId,["origin"]:L});return H}kB(I,H){D.a.debugAssertTag(5018304,!!H,null);D.a.debugAssertTag(5018305,!!this.s6&&!!this.paa,null);this.bG&&(this.Sae(I)?this.s6[I]!==H&&(D.a.debugAssertTag(5018307,!this.s6[I]&&!this.paa[I],null),this.s6[I]=H,delete this.paa[I]):D.a.sendTraceTag(5018306,2,"Not allow receiving {0}",{["id"]:I}))}DXa(I,H){D.a.debugAssertTag(40420062,
!!H,null);D.a.debugAssertTag(40420063,!!this.paa&&!!this.s6,null);this.bG&&(this.Sae(I)?this.paa[I]!==H&&(D.a.debugAssertTag(40420065,!this.s6[I]&&!this.paa[I],null),this.paa[I]=H,delete this.s6[I]):D.a.sendTraceTag(40420064,2,"Not allow receiving {0}",{["id"]:I}))}pul(I){this.bG&&(this.s6[I]&&delete this.s6[I],this.paa[I]&&delete this.paa[I])}afk(I){const H=this.A9i(I);if(!H)return!1;if(this.s6[H.MessageId])return this.iQb.NSc(this.s6[H.MessageId],H),!0;if(this.paa[H.MessageId]){let L=this.paa[H.MessageId];
I=new A(H,I);this.iQb.lDj(L,I);return!0}return!1}A9i(I){const H=new Date;this.IZj(I);if(!I.origin||!I.source||void 0===I.data||null===I.data)return D.a.sendTraceTag(5018308,4,"eventArgs missing required properties."),null;const L=this.eTj(I.data);if(!L)return null;if(!this.w5b(I.origin)){if(!this.cxg(L.MessageId))return D.a.sendTraceTag(5018309,1,"{0}",{["id"]:L.MessageId}),null;if(!r.a.j9a&&I.source!==this.xxh)return D.a.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),
null}D.a.debugAssertTag(5018311,!!L.Values,null);L.Values.m_Source=I.source;L.Values.m_Origin=I.origin;L.Values.m_ReceivedTime=H.getTime();return L}eTj(I){if(!I)return null;let H=null;try{H=Sys.Serialization.JavaScriptSerializer.deserialize(I,!0)}catch(aa){return 2>F.a1e&&(D.a.sendTraceTag(5018312,2,"Deser failed"),F.a1e++),null}if(!H)return D.a.debugAssertTag(5018313,!1,null),null;for(I=0;I<F.dHc.length;I++)if(!H[F.dHc[I]])return"MessageId"!==F.dHc[I]&&D.a.sendTraceTag(41502555,2,"Cannot find required message field: {0}",
F.dHc[I]),null;if(H.Values)try{H.Values}catch(aa){return D.a.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",aa.message),null}else D.a.sendTraceTag(41502556,2,"No values in message");I=H.MessageId;if(!this.Sae(I))return D.a.sendTraceTag(5018315,1,"Ignore recvd {0}",{["id"]:I}),null;const L=H.SendTime,E=(new Date).getTime()-L;if(0>L)return D.a.sendTraceTag(520435660,2,"{0}",{["t"]:L,["id"]:I}),null;if(6E4<E)return D.a.sendTraceTag(520435659,2,"{0}",{["t"]:L,["delta"]:E,["id"]:I}),null;-300>E&&
D.a.sendTraceTag(520435658,2,"{0}",{["t"]:L,["delta"]:E,["id"]:I});I=new w.a;I.MessageId=H.MessageId;I.SendTime=H.SendTime;I.CorrelationId=H.CorrelationId;H.Values&&(I.Values=H.Values);D.a.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",I.MessageId,I.SendTime,I.CorrelationId);return I}IZj(I){D.a.sendTraceTag(5018318,1,String.format("Received: {0}",{["origin"]:I.origin,["data"]:I.data,["source"]:I.source}))}static sendMessage(I,H,L){if(!u.a())return D.a.debugAssertTag(5018319,
!1,null),!1;try{return I.postMessage(H,L),!0}catch(E){D.a.sendTraceTag(5018320,4,"{0}",{["exception"]:E.message})}return!1}}F.dHc=["MessageId","SendTime"];F.sUb="*";F._id=0;F.a1e=0;Object(J.a)(F,"CrossDocumentMessenger",null,[106,626])},714:function(J,V,d){J=d(0);class h{}h.slideType="slide";h.shapeType="shape";h.aqb="chart";Object(J.a)(h,"ClipserviceDataConstants",null,[]);d.d(V,"b",function(){return e});d.d(V,"a",function(){return m});const e=r=>r===h.slideType?1:r===h.shapeType?2:r===h.aqb?3:0,
m=r=>1===r?h.slideType:2===r?h.shapeType:""},715:function(J,V,d){J=d(0);var h=d(17),e=d(45),m=d(828),r=d(239),v=d(258),A=d(224),w=d(485);class y{constructor(D,F){this.ZXa=D;this.description=F}}Object(J.a)(y,"ColorEntry",null,[]);d.d(V,"a",function(){return u});class u{constructor(D){this.che={};this.fse=null;this.qm=D}get yil(){if(!this.fse){const D=new Sys.StringBuilder;for(let F of this.standardColors)D.append(String.format(u.KMd,this.Kyh(F.ZXa),this.xSe(F.ZXa),F.description));this.fse=D.toString()}return this.fse}get standardColors(){let D;
return D=new h.a,D.add(new y(12582912,ResourceStrings.L_FontColorDarkRed)),D.add(new y(16711680,ResourceStrings.L_FontColorRed)),D.add(new y(16760832,ResourceStrings.L_FontColorOrange)),D.add(new y(16776960,ResourceStrings.L_FontColorYellow)),D.add(new y(9621584,ResourceStrings.L_FontColorLightGreen)),D.add(new y(45136,ResourceStrings.L_FontColorDarkGreen)),D.add(new y(45296,ResourceStrings.L_FontColorLightBlue)),D.add(new y(28864,ResourceStrings.L_FontColorBlue)),D.add(new y(8288,ResourceStrings.L_FontColorDarkBlue)),
D.add(new y(7352480,ResourceStrings.L_FontColorPurple)),D}Kyh(D){return String.format("#{0}",A.i(D))}xSe(D){return A.i(D)}boc(D){return Object.assign(new v.a,{ThemeColor:D.ThemeColor,ColorLuminance:D.ColorLuminance,FTintColor:D.FTintColor}).toString()}z4d(D,F,I){const H=new Sys.StringBuilder;H.append(this.gMd("ThemeColors",ResourceStrings.L_ThemeFontColor,!0,D));this.h4h(H);H.append(this.fMd());H.append(this.gMd("StandardColors",ResourceStrings.L_StandardFontColor,!1,D));H.append(this.yil);H.append(this.fMd());
F&&0<F.length&&(H.append(this.gMd("RecentColors",ResourceStrings.L_RecentColors,!1,I)),H.append(this.qcj(F)),H.append(this.fMd()));return H.toString()}qcj(D){const F=new Sys.StringBuilder;for(let I=0;I<D.length;I++){const H=D[I];F.append(String.format(u.KMd,"#"+H.hex,H.hex,"#"+H.hex))}return F.toString()}gMd(D,F,I,H){return String.format(u.nii,D,F,"ColorPicker",I?'McuLayout = "true" ':"",H)}fMd(){return u.mii}h4h(D){const F=Array(10);F[0]=this.GK(r.Color.Oi(this.qm.PresetSchemeColorMapping.Background1));
F[1]=this.GK(r.Color.Oi(this.qm.PresetSchemeColorMapping.Text1));F[2]=this.GK(r.Color.Oi(this.qm.PresetSchemeColorMapping.Background2));F[3]=this.GK(r.Color.Oi(this.qm.PresetSchemeColorMapping.Text2));F[4]=this.GK(r.Color.Oi(this.qm.PresetSchemeColorMapping.Accent1));F[5]=this.GK(r.Color.Oi(this.qm.PresetSchemeColorMapping.Accent2));F[6]=this.GK(r.Color.Oi(this.qm.PresetSchemeColorMapping.Accent3));F[7]=this.GK(r.Color.Oi(this.qm.PresetSchemeColorMapping.Accent4));F[8]=this.GK(r.Color.Oi(this.qm.PresetSchemeColorMapping.Accent5));
F[9]=this.GK(r.Color.Oi(this.qm.PresetSchemeColorMapping.Accent6));const I=Array(10);I[0]=ResourceStrings.l_ThemeLabel1;I[1]=ResourceStrings.l_ThemeLabel2;I[2]=ResourceStrings.l_ThemeLabel3;I[3]=ResourceStrings.l_ThemeLabel4;I[4]=ResourceStrings.l_ThemeLabel5;I[5]=ResourceStrings.l_ThemeLabel6;I[6]=ResourceStrings.l_ThemeLabel7;I[7]=ResourceStrings.l_ThemeLabel8;I[8]=ResourceStrings.l_ThemeLabel9;I[9]=ResourceStrings.l_ThemeLabel10;for(let H=0;5>=H;H++)for(let L=0;L<F.length;L++)D.append(this.NYi(F[L][H],
F[L][0],I[L],H,L))}GK(D){const F=e.a.Sv(D.r,2)+e.a.Sv(D.g,2)+e.a.Sv(D.b,2);if(this.che[F])return this.che[F];const I=w.a.pQa(D),H=[];Array.add(H,D);if(D.IWd())for(var L=0;L<m.a.pGh.length;++L)D=w.a.$_b(I),D.darken(m.a.pGh[L]/100),Array.add(H,D.jsa());else if(D.dRi())for(L=0;L<m.a.gKf.length;++L)D=w.a.$_b(I),D.lighten(m.a.gKf[L]/100),Array.add(H,D.jsa());else if(I.lum<u.Yhi)for(L=0;L<m.a.jEg.length;++L)D=w.a.$_b(I),D.lighten(m.a.jEg[L]/100),Array.add(H,D.jsa());else if(I.lum>u.Xhi)for(L=0;L<m.a.iEg.length;++L)D=
w.a.$_b(I),D.darken(m.a.iEg[L]/100),Array.add(H,D.jsa());else for(L=0;L<m.a.oFc.length+m.a.ZQf.length;++L)D=w.a.$_b(I),L<m.a.oFc.length?D.lighten(m.a.oFc[L]/100):D.darken(m.a.ZQf[L-m.a.oFc.length]/100),Array.add(H,D.jsa());return this.che[F]=H}NYi(D,F,I,H,L){D=this.xSe(D.ZXa);({mFc:F,SJb:I}=this.j_d(F,D,I,H,L));return String.format(u.KMd,F,D,I)}j_d(D,F,I,H,L){var E;var aa=E=null;if(0>H)return{mFc:E,SJb:aa};F=Object.assign(new v.a,{RGBColor:F,ThemeColor:L,ColorLuminance:0,FTintColor:!1});H?(L=w.a.pQa(D),
aa=H-1,L.lum?1===L.lum?(H=!1,aa=[242,217,191,166,127][aa]):.8<L.lum?(H=!1,aa=[229,191,127,64,25][aa]):.2>L.lum?(H=!0,aa=[25,64,127,191,229][aa]):(L=[51,102,153],E=[191,127],aa=(H=aa<L.length)?L[aa]:E[aa-L.length]):(H=!0,aa=[127,166,191,217,242][aa]),aa=255-aa,aa=Math.round(100*aa/255),F.ColorLuminance=100-aa,F.FTintColor=H,aa=String.format(H?ResourceStrings.l_ColorPickerTooltipTint:ResourceStrings.l_ColorPickerTooltipShade,D.toString(),I,aa)):aa=String.format(ResourceStrings.l_ColorPickerTooltipBase,
D.toString(),I);E=this.boc(F);return{mFc:E,SJb:aa}}}u.nii='<MenuSection Id="{0}" Title="{1}"><Controls Id="Color.Menu.Controls"><ColorPicker Id="{2}" {3}Width="10" Command="{4}"><Colors>';u.mii="</Colors></ColorPicker></Controls></MenuSection>";u.KMd='<Color Color="{0}" DisplayColor="#{1}" Alt="{2}" />';u.Yhi=.2;u.Xhi=.8;Object(J.a)(u,"ColorPickerBuilder",null,[])},716:function(J,V,d){var h=d(106),e=d(54),m=d(80),r=d(25),v=d(33),A=d(85),w=d(27),y=d(225),u=d(317),D=d(26),F=d(941);J=d(0);class I{constructor(){this.hz=
this.onSuccess=this.Ewe=this.kJd=this.t7g=null}}Object(J.a)(I,"UploadFileDialogData",null,[]);var H=d(67),L=d(38);d.d(V,"a",function(){return E});d.d(V,"b",function(){return aa});const E=(K,X,P,ea,ia)=>{const ja=String.format("{0}{1}",P,h.a.create().toString());return Object.assign(new I,{kJd:T(ja,ea),t7g:O(P,ea),Ewe:(C,pa)=>{switch(P){case "video":pa.blockContent(ia,K);break;default:pa.blockContent(C,"Insert Media")}},onSuccess:(C,pa,Z,qa,ya,Ka)=>{X(K,ja,pa,Z,ya,Ka,ia)},hz:(C,pa,Z,qa,ya)=>{Z.rN(pa)?
D.a.J(509727823,822,15,"Media::InsertMediaFailureAfterUpload:Presentation was blocked with loader for {0} milliseconds",+new Date-+pa.Uha):Z.rN(ia)&&D.a.J(509666848,822,15,"Media::InsertMediaFailureAfterUpload:Slide was blocked with loader for {0} milliseconds",+new Date-+ia.Uha);L.a("FixHideShimmerIssueOnUploadFailure")&&"video".match(P)?Z.GJ(ia):Z.GJ(pa);pa=null;try{const Ka=v.a(C);pa=Ka?Ka.Error:null}catch(Ka){D.a.J(509727822,818,10,"UploadResponseReceived - Exception when deserializing response. Response: {0}",
C)}if(!pa){let Ka;L.a("FixHideShimmerIssueOnUploadFailure")&&C&&!isNaN(parseInt(C))&&(Ka=Enum.parse(y.a,y.a[parseInt(C)],!0));pa=Object.assign(new u.a,{Code:Ka?Ka:444})}ya&&(ya.finish(),ya=null);D.a.J(509727821,822,10,"Upload media failed");Q(qa,ya,pa.Code,null)}})},aa=(K,X,P,ea)=>new Promise((ia,ja)=>{const C=new F.a(ea);D.a.J(509727828,822,50,"Media File details: Number of media files: {0}, media file extension: {1}, media file size: {2}",K&&K.value?K.files.length:0,F.a.X_d(K),F.a.Nag(K));P&&P.Wa("MediaFileValidationStarts",
String.format("Number of media files: {0}, media file extension: {1}, media file size: {2}",K&&K.value?K.files.length:0,F.a.X_d(K),F.a.Nag(K)));if(K&&K.value&&K.value.length)if(C.$Al(K.value)){var pa=K.files[0];C.aBl(pa.size)?C.oni(pa).then(Z=>{Z?(P&&P.Wa("MediaFileValidationPassedOnUI","true"),ia(!0)):(Q(X,P,443,[C.WVa.join(", ")]),ja(443))},()=>{D.a.J(509727825,822,10,"Invalid media file");Q(X,P,443,[C.WVa.join(", ")]);ja(443)}):(D.a.J(509727826,822,10,"Media::Insert:Invalid media file size:{0}",
pa.size),pa=L.a("FetchMediaSizeLimitFromValidationHelper")?C.kac.toString():"16",Q(X,P,442,[pa]),ja(442))}else D.a.J(509727827,822,10,"Media::Insert:Invalid media file type:{0}",F.a.X_d(K)),Q(X,P,441,[C.WVa.join(", ")]),ja(441);else Q(X,P,440,null),ja(440)}),Q=(K,X,P,ea)=>{X&&X.finish();K.FG(P,ia=>{ia.NB=1;ia.XPa=ea;return!1})},O=(K,X)=>{let P="MediaUpload.ashx";if(w.App.webServiceBase)P=w.App.webServiceBase+P;else if(e.a.eg||e.a.mta)P=m.a.Ora(P);let ea="";switch(K){case "audio":ea="audio";break;
case "captions":ea="captions";break;default:D.a.J(509727824,822,10,"Media::GetMediaUploadEndpoint: file type not supported")}P+=String.format("?MediaType={0}&{1}&{2}&{3}",ea,r.AFrameworkApplication.eRa(),X.presentationId.string,r.AFrameworkApplication.q0b());X.podSessionId&&(P+=String.format("&{0}={1}",A.a.g$,X.podSessionId));X.fk&&(P+=String.format("&waccluster={0}",X.fk));return P},T=(K,X)=>{const P=new H.a;P.$("PresentationId",X.presentationId.string);P.$(A.a.vma,X.sessionInfo);P.$("Canary",r.AFrameworkApplication.canary);
P.$("access_token",r.AFrameworkApplication.accessToken);P.$("MediaToken",K);return P}},891:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.xve="TraceIdNoBar";h.fXc="TraceIdLeftBar";h.Sfd="TraceIdRightBar";h.cDc="TraceIdBothBar";Object(J.a)(h,"ConsistencyCheckTraceIdType",null,[])},892:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(510);class e{constructor(){this.start=new h.a;this.end=new h.a}clone(){return Object.assign(new e,{start:this.start.clone(),end:this.end.clone()})}merge(m){let r=
!1;m.start&&(r=this.start.merge(m.start));m.end&&(r=this.end.merge(m.end)||r);return r}}Object(J.a)(e,"TextNodeSelection",null,[])},893:function(J,V,d){d.d(V,"a",function(){return 19})},894:function(J,V,d){d.r(V);d.d(V,"WordPredictionAugLoopResponseManager",function(){return u});J=d(0);V=d(17);var h=d(343),e=d(895),m=d(647),r=d(645),v=d(646),A=d(541),w=d(62),y=d(31);class u{G2b(D){u.kS.LF(()=>{this.X$k(D)||(this.cTe(D),this.Wyl(),this.Nai())},"WPT:PR")}Nai(){const D=A.a.pD.S4,F=A.a.pD.Ieb;if(D){var I=
w.a.instance.Oa.kb;if(I&&I.Ve&&A.a.Ttg(I.Ve)){I=I.Ve.node;var H=y.ParagraphReader.text(I);H=H.substring(D.bhd,H.length);I=this.v0d(I,D,H);"string"===typeof I?I.length?(D.M7=I,D.zIb+=1,A.a.fKd(D.text,I),this.ayl(),D.Hze=H,this.$xl(D)):F&&0===F[m.a.status]?(this.NDh(),A.a.rfd()):this.mzl():(this.NDh(),A.a.rfd())}}}$xl(D){u.ypd.count>=u.tSh&&u.ypd.removeAt(0);u.ypd.add(this.eqi(D))}eqi(D){return Object.assign(new e.a,{id:D.id,txa:D.txa,ox:D.ox,bhd:D.bhd,text:D.text,M7:D.M7,$Vb:D.$Vb,m4a:D.m4a,score:D.score,
NSe:D.NSe,MSe:D.MSe,OO:D.OO,zIb:D.zIb,Hze:D.Hze})}X$k(D){if(D&&D.parentPath&&7===D.parentPath.length){const F=D.parentPath[6];A.a.hXa.add(F,v.a.IJd,(new Date).getTime());A.a.yXj(F)}else return A.a.n7b(v.a.cVd),!0;return A.a.KSa?(D=this.Bhg(D),D=this.r8g(D[0]),D[m.a.status]=5,A.a.hYd(D),A.a.n7b(v.a.zth),!0):!1}cTe(D){(D=this.Bhg(D))&&D.length?(A.a.pD.S4=D[0],A.a.pD.Yyh=D.length,A.a.pD.Ieb=this.r8g(D[0])):(A.a.rfd(),A.a.n7b(v.a.cVd))}Bhg(D){if(!D||!D.items||!D.parentPath||7!==D.parentPath.length)return null;
var F=D.items[0];let I;try{I=F.body}catch(Q){return null}F=D.parentPath[2];const H=parseInt(D.parentPath[3]),L=parseInt(D.parentPath[4]),E=D.parentPath[5];D=D.parentPath[6];if(!I.predictions.length)return null;A.a.z5k(I.modelInfo);const aa=Array(I.predictions.length);for(let Q=0;Q<I.predictions.length;Q++){const O=I.predictions[Q];if(O.text){const T=O.characterRange,K=O.tokenRange;aa[Q]=Object.assign(new e.a,{id:E,txa:D,ox:F,bhd:H,text:O.text,M7:O.text.substr(T.start),$Vb:T.start,m4a:T.length,score:O.score,
NSe:K.start,MSe:K.length,OO:L,zIb:0})}}return aa}r8g(D){const F={};F[m.a.language]="en-US";const I=A.a.P9i();F[m.a.modelId]=I.modelId;F[m.a.modelVersion]=I.modelVersion;F[m.a.configId]=I.configId;F[m.a.UNd]=D.m4a;F[m.a.vEc]=D.m4a;F[m.a.mBg]=D.M7.length;F[m.a.j8g]=D.text.length;F[m.a.m8g]=D.text.split(" ").length;F[m.a.score]=D.score;F[m.a.status]=0;F[m.a.qUe]=D.M7.length;F[m.a.OO]=D.OO;D=A.a.hXa.ga(D.txa);F[m.a.Byh]=D[v.a.IJd]-D[v.a.rmc];F[m.a.Wld]=0;return F}Wyl(){const D=A.a.pD.S4;D&&(A.a.ota(D.OO,
r.a.cOf,A.a.pD.Yyh),A.a.ota(D.OO,r.a.$Vf,D.m4a))}ayl(){const D=A.a.pD.S4,F=A.a.pD.Ieb;if(D&&1===D.zIb){const I=(new Date).getTime();A.a.hXa.Yng(D.txa,v.a.KGf,I);A.a.iDg(D.txa,!0);A.a.n7b(v.a.l8g);const H=A.a.hXa.ga(D.txa)[v.a.rmc];F[m.a.Wld]=I-H;F[m.a.status]=1;F[m.a.vEc]=D.text.length-D.M7.length;A.a.ota(D.OO,r.a.Wkh,1);A.a.ota(D.OO,r.a.sgh,1);A.a.ota(D.OO,r.a.tgh,D.M7.length);A.a.ota(D.OO,r.a.aWf,D.text.length-D.M7.length);A.a.pBk()}}mzl(){const D=A.a.pD.S4,F=A.a.pD.Ieb;D&&(F[m.a.status]=3,F[m.a.vEc]=
0,F[m.a.qUe]=D.text.length-F[m.a.UNd],A.a.hYd(F),A.a.ota(D.OO,r.a.zBh,1),A.a.ota(D.OO,r.a.cWf,D.score),A.a.ota(D.OO,r.a.ABh,D.text.length-D.m4a),A.a.rfd())}NDh(){const D=A.a.pD.S4,F=A.a.pD.Ieb;if(D){if(0===F[m.a.status]){const I=(new Date).getTime();A.a.hXa.Yng(D.txa,v.a.IGf,I);A.a.iDg(D.txa,!1);A.a.n7b(v.a.k8g);const H=A.a.hXa.ga(D.txa)[v.a.rmc];F[m.a.Wld]=I-H;A.a.ota(D.OO,r.a.lXg,1);F[m.a.status]=6}A.a.hYd(F)}}v0d(D,F,I){let H=null;F.ox===D.id.toString()&&I&&F.$Vb<I.length&&(D=I.substring(0,F.$Vb)+
F.text,D=D.replace(RegExp("\\u00a0","g")," "),I=I.replace(RegExp("\\u00a0","g")," "),0<D.length&&0<I.length&&(D.indexOf(I)||(H=D.substring(I.length,D.length))));return H}static get kS(){return h.a.instance}}u.tSh=4;u.ypd=new V.a;Object(J.a)(u,"WordPredictionAugLoopResponseManager",null,[])},895:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ox=this.txa=this.id=null;this.OO=this.bhd=0;this.M7=this.text=null;this.zIb=this.MSe=this.NSe=this.score=this.m4a=this.$Vb=
0;this.Hze=null}}Object(J.a)(h,"Candidate",null,[])},896:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.stateUpdateHandler=this.handler=this.config=this.annotationType=null}}Object(J.a)(h,"ActivateAnnotationParameters",null,[])},897:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(599);var h=d(128);class e extends V.a{constructor(){super();this.tokenRange=this.predictions=this.modelInfo=this.characterRange=null;this.H_=Object.assign(new h.a,{T_:e.getTypeName(),
B_:e.ul()})}static getTypeName(){return"AugLoop_Text_TextPredictionAnnotation"}static ul(){return["AugLoop_Core_Annotation"]}}Object(J.a)(e,"TextPredictionAnnotation",V.a,[])},898:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.operation=null}}Object(J.a)(h,"SubmitOperationParameters",null,[])},899:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);V=d(255);var h=d(128);class e extends V.a{constructor(){super();this.timestamp=this.targetObject=null;this.H_=Object.assign(new h.a,
{T_:e.getTypeName(),B_:e.ul()})}static getTypeName(){return"AugLoop_Signals_Signal"}static ul(){return[]}}Object(J.a)(e,"Signal",V.a,[])},900:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m,r){super();this.actionId=e;this.hwb=m;this.revisionId=r}}Object(J.a)(h,"UndoRedoMarkedUndoEventArgs",Sys.EventArgs,[])},901:function(J,V,d){d.d(V,"c",function(){return v});d.d(V,"b",function(){return A});d.d(V,"a",function(){return w});var h=d(17),e=d(376),m=
d(25),r=d(33);const v=y=>{if(!y)return null;let u;try{u=r.b(y)}catch(D){u=null,e.ULS.sendTraceTag(578352835,202,15,"MruActor.TryDeserializeMruV2Response: SecureDeserialize Exception: {0}",D)}return u},A=(y,u)=>{let D=[];if(y.breadcrumbs&&0<y.breadcrumbs.length)D=y.breadcrumbs;else{const F=y.service_info;F&&F.friendly_service_name&&Array.add(D,F.friendly_service_name);y.display_path&&Array.addRange(D,y.display_path)}return D.join(u?" \u00ab ":" \u200f\u00bb ")},w=(y,u=!1)=>{if(!y)return[];if(!y.documents)return e.ULS.sendTraceTag(578352838,
202,15,"missing documents object"),[];if(!y.documents.items)return e.ULS.sendTraceTag(578352839,202,15,"missing items object"),[];y=y.documents.items;const D=new h.a;for(let I=0;I<y.length;I++){const H=y[I];var F=H.web_url;if(!F){e.ULS.sendTraceTag(578320064,202,15,"Empty web_url");if(!H.url){e.ULS.sendTraceTag(578140248,202,15,"Empty url");continue}F=String.format("{0}?web=1",H.url)}const L={};L.DocumentUrl=F;L.MruId=H.mru_id;{F=H;let E=F.title;E?(F.extension&&(E=String.format("{0}.{1}",E,F.extension)),
F=E):(e.ULS.sendTraceTag(578352837,202,15,"empty file title"),F="")}L.FileName=F;L.IsPinned=H.is_pinned;L.Path=A(H,m.AFrameworkApplication.isRtl);u&&(L.App=H.app,L.TimeStamp=H.time_stamp);D.add(L)}return D.toArray()}},902:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(376),e=d(989),m=d(1166),r=d(13),v=d(17),A=d(36),w=d(38);class y{constructor(u,D,F,I,H,L,E,aa,Q){this.WQ=new e.a;this.lPg=u;this.Qb=D;this.PA=H;this.Ea=F;this.Zd=L;this.O7b=E;this.Nl=I;this.Hh=aa;this.la=Q;this.Byj()}get re(){return this.Zd.instance}get $E(){return this.O7b.value}Byj(){this.WQ.$(0,
[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.WQ.$(1,[ResourceStrings.l_PhTypeBody,ResourceStrings.l_ClickToAddText]);this.WQ.$(2,[ResourceStrings.l_PhTypeCenterTitle,ResourceStrings.l_ClickToAddTitle]);this.WQ.$(3,[ResourceStrings.l_PhTypeSubTitle,ResourceStrings.l_ClickToAddSubTitle]);this.WQ.$(8,[ResourceStrings.l_PhTypeObject,ResourceStrings.l_ClickToAddText]);this.WQ.$(9,[ResourceStrings.l_PhTypeGraph,ResourceStrings.l_InsertContent]);this.WQ.$(10,[ResourceStrings.l_PhTypeTable,
ResourceStrings.l_InsertContent]);this.WQ.$(11,[ResourceStrings.l_PhTypeClipArt,ResourceStrings.l_InsertContent]);this.WQ.$(12,[ResourceStrings.l_PhTypeSmartArt,ResourceStrings.l_ClickToAddSmartArt]);this.WQ.$(13,[ResourceStrings.l_PhTypeMedia,ResourceStrings.l_InsertContent]);this.WQ.$(15,[ResourceStrings.l_PhTypePicture,ResourceStrings.l_ClickToAddPicture]);this.WQ.$(6,[ResourceStrings.l_PhTypeFooter,ResourceStrings.l_ClickToAddFooter]);this.WQ.$(5,[ResourceStrings.l_PhTypeSlideNumber,ResourceStrings.l_ClickToAddSlideNumber])}Cfg(u,
D){u&&(this.kca(u,D),u.bta?D.insert(0,document.createTextNode(ResourceStrings.l_ShapeObject)):this.l2d(u,null,D));return null}Rej(u){if(!this.lPg.instance||!u)return null;u=this.lPg.instance.Hfg(u);if(!u||!u.length)return null;const D=u.length;return 1===D?String.format(ResourceStrings.l_ShapePresenceForOneUser,u[0].userName):2===D?String.format(ResourceStrings.l_ShapePresenceForTwoUsers,u[0].userName,u[1].userName):3===D?String.format(ResourceStrings.l_ShapePresenceForThreeUsers,u[0].userName,u[1].userName,
u[2].userName):String.format(ResourceStrings.l_ShapePresenceForFourOrMoreUsers,D)}Y3d(u){let D="";u&&u.SS&&u.image.title&&0<u.image.title.length&&(D=u.image.title);u&&(D=String.format(ResourceStrings.l_ThumbnailInfoNew,u.slideIndex+1,this.Qb.Hj(),D),u=this.eij(u),0<u.length&&(D+=u));return D}eij(u){const D=new Sys.StringBuilder;u.isSelected&&D.append(ResourceStrings.L_SlideIsSelected);u.Rm&&D.append(ResourceStrings.l_SlideIsHidden);const F=Object(m.a)(120,u.Ed);if(F){var I=F.VQa();I&&!this.Nl.abe(I)&&
D.append(ResourceStrings.l_SlideHasNotes);(I=F.xD())&&this.PA.instance&&this.PA.instance.elg(I)&&(I=this.PA.instance.KMc(I),D.append(1===I?ResourceStrings.l_SlideHasOneComment:String.format(ResourceStrings.l_SlideHasCommentsWithCount,I)))}u.ZP&&D.append(ResourceStrings.l_SlideHasAnimationOrTransition);if(u.Keb&&(u=u.Keb.K7())&&0<u.length)if(1===u.length)D.append(String.format(ResourceStrings.l_SlideHasPresenceForOneUser,u[0].userName));else{I="";for(const H of u)I+=H.userName+",";D.append(String.format(ResourceStrings.l_SlideHasPresenceForTwoOrMoreUsers,
I))}F&&F.isUnread&&D.append(ResourceStrings.l_RevisionTracking_SlideHasUnreadChanges);return D.toString()}m7a(u,D){return String.format(ResourceStrings.l_MultipleSlidesSelected,u,D)}R3i(u,D){return String.format(ResourceStrings.l_DesignerSuggestionSelected,u+1,D)}rfj(){return ResourceStrings.l_SlidePanel}h$i(){return ResourceStrings.l_MultipleShapes}QNk(u){u&&(this.la.j4a&&u.W4(Object(r.a)(this,this.u0i,"getCameoAccMessage")),u.W4(Object(r.a)(this,this.chj,"getTableAccMessage")),u.W4(Object(r.a)(this,
this.W6i,"getImageAccMessage")),u.W4(Object(r.a)(this,this.p9i,"getMediaAccMessage")),u.W4(Object(r.a)(this,this.K0i,"getChartAccMessage")),this.ajd?(u.W4(Object(r.a)(this,this.$fg,"getSmartArtAccMessage")),u.W4(Object(r.a)(this,this.l2d,"getPlaceHolderAccMessage"))):(u.W4(Object(r.a)(this,this.l2d,"getPlaceHolderAccMessage")),u.W4(Object(r.a)(this,this.$fg,"getSmartArtAccMessage"))),u.W4(Object(r.a)(this,this.Vhj,"getTextboxAccMessage")),u.W4(Object(r.a)(this,this.Gej,"getShapeGroupAccMessage")),
u.W4(Object(r.a)(this,this.Dej,"getShapeAccMessage")),u.W4(Object(r.a)(this,this.CZi,"getAddinAccMessage")),u.W4(Object(r.a)(this,this.gZi,"get3DAccMessage")))}l2d(u,D,F,I=null){if(u&&F&&u.Sk&&(this.vPc(u,F),D=u.get_altTitle(),this.WQ.Jb(u.Cj))){I&&I(String.format("{0} {1}",this.WQ.ga(u.Cj)[0],ResourceStrings.l_Placeholder));if(u.VS||!F.count){F=this.WQ.ga(u.Cj)[0];I="";if(!this.ajd||u.VS)I=this.WQ.ga(u.Cj)[1];return String.format(u.get_alt()?ResourceStrings.l_AccMessagePlaceHolderPromptAlt:ResourceStrings.l_AccMessagePlaceHolderPrompt,
F,D,I,u.get_alt())}u=String.format(u.get_alt()?ResourceStrings.l_AccMessagePlaceHolderTextAlt:ResourceStrings.l_AccMessagePlaceHolderText,this.WQ.ga(u.Cj)[0],D,u.get_alt());F.insert(0,document.createTextNode(u))}return null}Vhj(u,D,F,I=null){if(u&&F&&u.Ny)if(this.vPc(u,F),I&&I(ResourceStrings.L_TextBox),0<F.count)u=String.format(u.get_alt()?ResourceStrings.l_AccMessageTextboxHasTextAlt:ResourceStrings.l_AccMessageTextboxHasText,u.get_altTitle(),u.get_alt()),F.insert(0,document.createTextNode(u));
else return String.format(u.get_alt()?ResourceStrings.l_AccMessageTextboxNoTextAlt:ResourceStrings.l_AccMessageTextboxNoText,u.get_altTitle(),u.get_alt());return null}$fg(u,D,F,I=null){if(u&&F&&u.Pf)if(this.vPc(u,F),I&&I(ResourceStrings.L_SmartArt),0<F.count)u=String.format(u.get_alt()?ResourceStrings.l_AccMessageSmartArtHasTextAlt:ResourceStrings.l_AccMessageSmartArtHasText,this.bgg(u)||"",u.get_altTitle(),u.get_alt()),F.insert(0,document.createTextNode(u));else return String.format(u.get_alt()?
ResourceStrings.l_AccMessageSmartArtNoTextAlt:ResourceStrings.l_AccMessageSmartArtNoText,this.bgg(u)||"",u.get_altTitle(),u.get_alt());return null}kca(u,D){u&&D&&this.Ea.kJ(u,F=>{F.Sa(A.a.iq)&&this.ncg(F,D)})}vPc(u,D){if(u&&D){const F=this.ajd?new v.a:D;let I=!1;this.Ea.kJ(u,H=>{const L=this.Hh.mW(H),E=this.Hh.oeb(H);L&&F.add(document.createTextNode(String.format(ResourceStrings.l_AccMessageTextLevel,E)));I=this.ncg(H,F)||I});this.ajd&&I&&D.addRange(F);D.count||(u=u.ORe)&&D.add(document.createTextNode(u))}}get ajd(){return w.a("AriaMessageHelper.FixAccMessageForEmptyList")}ncg(u,
D){let F;const I=u.sa(A.a.Hnc,null),H=u.sa(A.a.iq,"");if(H&&D){if(I){let L=0,E=null,aa;for(let Q=0;Q<I.length+1;Q++)aa=this.Ea.SNc(u,Q),E&&E!==aa&&(F=document.createElement("span"),F.setAttribute("lang",E),F.innerText=H.substring(L,I[Q-1]),L=I[Q-1],D.add(F)),E=aa;F=document.createElement("span");E&&F.setAttribute("lang",E);F.innerText=H.substring(L,H.length)}else F=document.createElement("span"),(u=this.Ea.SNc(u,0))&&F.setAttribute("lang",u),F.innerText=H;D.add(F)}return!!H&&0<H.length}chj(u,D,F,
I=null){return u&&u.qd?(I&&I(ResourceStrings.L_Table),String.format(u.get_alt()?ResourceStrings.l_AccMessageTableAlt:ResourceStrings.l_AccMessageTable,u.get_altTitle(),u.get_alt())):null}W6i(u,D,F,I=null){return u&&u.wk?(I&&I(ResourceStrings.l_Image),String.format(u.get_alt()?ResourceStrings.l_AccMessageImageAlt:ResourceStrings.l_AccMessageImage,u.get_altTitle(),u.get_alt())):null}u0i(u,D,F,I=null){if(!u||!u.WDa)return null;I&&I(ResourceStrings.l_Cameo);return u.get_alt()?String.format(ResourceStrings.l_AccMessageCameoAlt,
u.get_altTitle(),u.get_alt(),ResourceStrings.l_CameoLearnMoreMessage):String.format(ResourceStrings.l_AccMessageCameo,u.get_altTitle(),ResourceStrings.l_CameoLearnMoreMessage)}p9i(u,D,F,I=null){if(u){if(0===u.mediaType)return null;if(1===u.mediaType)return I&&I(ResourceStrings.l_Audio),this.la.uP?String.format(ResourceStrings.l_AccMessageCanvasAudio,u.shapeName):String.format(u.get_alt()?ResourceStrings.l_AccMessageAudioAlt:ResourceStrings.l_AccMessageAudio,u.get_altTitle(),u.get_alt());if(2===u.mediaType)return I&&
I(ResourceStrings.l_Video),String.format(u.get_alt()?ResourceStrings.l_AccMessageVideoAlt:ResourceStrings.l_AccMessageVideo,u.get_altTitle(),u.get_alt())}return null}K0i(u,D,F,I=null){return u&&u.Wq?(I&&I(ResourceStrings.l_Chart),String.format(u.get_alt()?ResourceStrings.l_AccMessageChartAlt:ResourceStrings.l_AccMessageChart,this.L0i(u)||"",u.get_altTitle(),u.get_alt())):null}Gej(u,D,F,I=null){return u&&u.Jf?(I&&I(ResourceStrings.L_GroupObjects),w.a("GroupShapeAltTitleFixEnabled")?String.format(u.get_alt()?
ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,u.Ow().length,u.get_alt()):String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeGroupAlt:ResourceStrings.l_AccMessageShapeGroup,u.get_altTitle(),u.get_alt())):null}Dej(u,D,F,I=null){if(u&&F&&u.bta&&!u.Ny)if(this.vPc(u,F),D=this.Ea.Jfg(u),u.KDa&&(D=ResourceStrings.l_DecorativeLabel),I&&I(D||ResourceStrings.l_TextShape),0<F.count)u=String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeHasTextAlt:ResourceStrings.l_AccMessageShapeHasText,
D||ResourceStrings.l_TextShape,u.get_altTitle(),u.get_alt()),F.insert(0,document.createTextNode(u));else return String.format(u.get_alt()?ResourceStrings.l_AccMessageShapeNoTextAlt:ResourceStrings.l_AccMessageShapeNoText,D||ResourceStrings.l_TextShape,u.get_altTitle(),u.get_alt());return null}CZi(u,D,F,I=null){return u&&u.Uq&&this.re&&this.$E?(u=this.$E.m2(u),u=this.re.Psb(u.id),I&&I(u?u.wha:null),u?u.wha:null):null}gZi(u,D,F,I=null){return u&&u.d3?(I&&I(ResourceStrings.l_3DModel),String.format(u.get_alt()?
ResourceStrings.l_AccMessage3DAlt:ResourceStrings.l_AccMessage3D,u.get_altTitle(),u.get_alt())):null}bgg(u){return u.smartArtInfo?y.Z2d(u.smartArtInfo.SmartArtLayout,1,177,"L_SAType"):(h.ULS.sendTraceTag(588375196,815,10,"SmartArt {0}#{1} has no SmartArtInfo",u.slideId?u.slideId.toString():"",u.get_shapeId()),null)}L0i(u){return y.Z2d(u.aqb,0,102,"L_ChartType")}Sej(u,D){return(u=this.Ea.LOc(u))&&D?String.format(ResourceStrings.l_RevisionTracking_ShapeHasUnreadChanges,D,u):null}static Uhj(u){return y.Z2d(u,
1,177,"L_SAType")}static Z2d(u,D,F,I){return u>=D&&u<=F&&(u=ResourceStrings[I+u])?u:null}}Object(J.a)(y,"AriaMessageHelper",null,[956])},903:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m=null,r=null,v=null,A=!1,w=null){this.DisplayName=this.ClientId=this.Provider=this.UserId=null;this.IsAnonymous=!1;this.Email=null;this.UserId=e;this.Provider=m;this.DisplayName=r;this.Email=v;this.IsAnonymous=A;this.ClientId=w}}Object(J.a)(h,"Person",null,[])},904:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);class h{static E1k(){}static pFi(){}}h.sendTraceTag=h.E1k;h.debugAssertTag=h.pFi;Object(J.a)(h,"BULS",null,[])},905:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(980),e=d(25),m=d(163),r=d(55);class v{constructor(A,w,y,u,D,F){this.Gaa=A;this.Haa=w;this.Bvd=y;this.TO=u;this.tsc=D;this.Njb=F}get psh(){return!this.Haa&&!this.Bvd}get cYg(){return 2===this.Njb?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}get id(){return"OICErrorDialogWithTrial"}get m2f(){return CommonUIStrings.l_OICErrorMessageNoOffice}get Ymg(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}get QRa(){return CommonUIStrings.l_OICErrorHelpLink}get Ylg(){return"OICFailure"}get icon(){return 3}get nCf(){return 2===
this.Njb?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}get qPa(){return CommonUIStrings.l_DefaultDialogTitle}zJk(A){this.nYg(A)}UUj(A){this.nYg(A)}nYg(A){let w=10;1===A?(r.a.instance.resolve("Common.IOfficeTrialExperience").Qde(this.Njb),w=3):2===A&&((!this.Bvd||this.Bvd(this.TO))&&this.Haa&&h.a.instance.jBi(this.Haa,this.Gaa,this.TO),w=5);(0===A||1===A)&&this.Gaa&&this.Gaa(this.TO);e.AFrameworkApplication.Mfb(m.a.U3g,this.tsc,w);this.dispose()}dispose(){this.TO=
this.Haa=this.Gaa=null}}Object(J.a)(v,"AOICErrorDialogWithTrial",null,[106])},906:function(J,V,d){d.d(V,"b",function(){return r});d.d(V,"g",function(){return v});d.d(V,"d",function(){return A});d.d(V,"f",function(){return y});d.d(V,"e",function(){return u});d.d(V,"c",function(){return D});d.d(V,"a",function(){return F});var h=d(25);d(701);var e=d(1084),m=d(515);d(463);const r=()=>h.AFrameworkApplication.isEmbedded,v=()=>{const I=h.AFrameworkApplication.Aa.jb.xN;return!r()&&!h.AFrameworkApplication.hideHeader&&
m.a()&&(I||1===h.AFrameworkApplication.iXi)},A=()=>h.AFrameworkApplication.fa.ka("DiscoverPremiumButtonEnabled"),w=()=>h.AFrameworkApplication.rrh&&!r()&&!h.AFrameworkApplication.hideHeader,y=()=>w()&&"officecomhwa"!==(h.AFrameworkApplication.fa.Ga(h.AFrameworkApplication.FJ)||"").toLowerCase()&&!h.AFrameworkApplication.bmg,u=()=>!h.AFrameworkApplication.z6d&&w(),D=()=>!r()&&!h.AFrameworkApplication.hideHeader&&h.AFrameworkApplication.fa.ka("BasicChatIsEnabled"),F=()=>{if(h.AFrameworkApplication.wmg)return null;
var I=!!h.AFrameworkApplication.Aa&&h.AFrameworkApplication.Aa.jb.xN;if((h.AFrameworkApplication.Mbe&&h.AFrameworkApplication.KXa||h.AFrameworkApplication.mpc)&&I)return Object.assign(new e.a,{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:d(263).CuiHelper.gfd});if(h.AFrameworkApplication.workflowEnabled){I="";switch(h.AFrameworkApplication.Qpc){case "Assign":I=CommonUIStrings.l_Assign;break;case "Submit":I=CommonUIStrings.l_Submit}if(""!==I)return Object.assign(new e.a,{command:"2988588587",
label:I,id:"btnWorkflow"})}return null}},907:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"RibbonPeripheralSection",null,[])},908:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.isForAlertableKpi=this.extendedProperties=null}}Object(J.a)(h,"IKpiUsageOptionalProperties",null,[])},909:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.kpiName=null;this.kpiType=0;this.blockFutureEmissionDurationInMs=this.optionalProperties=
null}}Object(J.a)(h,"KpiUsageParams",null,[])},910:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.vetoPillar=this.crewAlias=this.featureName=this.topLevelKpiName=null}}Object(J.a)(h,"FeatureUsageAndHealthConfig",null,[])},911:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.onFullRenderComplete=this.useCoachmark=this.jumpToCalloutTargetButtonEnabled=this.hasDynamicSizing=this.preventLightDismiss=this.useTeachingStyles=this.hasFocusableControls=
this.calloutProps=this.showCloseIcon=this.secondaryButtonProps=this.primaryButtonProps=this.title=this.content=this.target=null}}Object(J.a)(h,"CalloutParameters",null,[])},912:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"ICalloutProps",null,[])},913:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.IsFreeForm="IsFreeForm";h.Value="Value";h.Key="Key";h.FontStyle="FontStyle";Object(J.a)(h,"ComboBoxCommandProperties",null,[])},914:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);class h{}h.Alt="Alt";h.CommandValueId="CommandValueId";h.InnerHTML="InnerHTML";h.On="On";h.IsRtl="IsRtl";h.GalleryButtonProps="GalleryButtonProps";h.Text="Text";h.HighlightOn="HighlightOn";Object(J.a)(h,"GalleryButtonCommandProperties",null,[])},915:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"PersonaInfo",null,[])},916:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"PersonaIdentifiers",null,[])},917:function(J,
V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.hn=e}oZd(e){const m=[];if(e)for(let A in e){var r=A,v=e[A];const w=this.hn.S_d(r);if(w)for(let y of w)m.push(appChrome.actions.updateControlHiddenState(y,v));else if(r=this.hn.v6i(r))for(const y of r)if(y.externalUxCommandIds)for(const u of y.externalUxCommandIds)m.push(appChrome.actions.updateControlHiddenState(u,v));else m.push(appChrome.actions.updateGroupHiddenState(y.externalUxGroupId,v))}return m}rZi(e){const m=[];if(e)for(let r in e){if(!e[r])continue;
const v=r;v&&m.push(appChrome.actions.deactivateRibbonTab(v))}return m}}Object(J.a)(h,"ReactRibbonTrimmingHelper",null,[])},918:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.neighborhood=null;this.mentionLength=this.mentionStart=0}}Object(J.a)(h,"InsightsParameters",null,[])},919:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.CWf="data-ccp-timestamp";h.DWf="data-clipservice-ccpid";h.HWf="data-shapeids";h.Iig="docs-internal-guid-";h.E3g="SCXO";
h.J7g="SCXP";h.xGh="SCXW";h.tWg="MsoListParagraphCxSpFirst";h.uWg="MsoListParagraphCxSpLast";Object(J.a)(h,"HtmlContentMetadataConstants",null,[])},920:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.ZEj=e.IsBeforeReady;this.SIj=e.IsFromEndOfSlideshow;this.summary=e.Summary}}Object(J.a)(h,"OnExitSlideshowEventArgs",Sys.EventArgs,[])},921:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.key=e.Key;this.shiftKey=e.ShiftKey}}Object(J.a)(h,"OnSpecialKeyEventArgs",Sys.EventArgs,[])},922:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(J.a)(h,"OnBrowserEventArgs",Sys.EventArgs,[])},923:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;
this.slideIndex=e.SlideIndex;this.$nc=e.TimeLineMappings}}Object(J.a)(h,"OnGetCurrentPositionEventArgs",Sys.EventArgs,[])},924:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideHeight=e.SlideHeight;this.slideWidth=e.SlideWidth;this.Eth=e.SlideLeftBound;this.Bth=e.SlideBottomBound}}Object(J.a)(h,"OnGetCurrentSlideDimensionsEventArgs",Sys.EventArgs,[])},925:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();
this.clientX=e.ClientX;this.clientY=e.ClientY}}Object(J.a)(h,"OnSlideshowContextMenuEventArgs",Sys.EventArgs,[])},926:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.isVisible=e.IsVisible}}Object(J.a)(h,"OnVisibilityChangeEventArgs",Sys.EventArgs,[])},927:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.code=e.Code;this.reason=e.Reason;this.podSessionId=e.PodSessionId}}
Object(J.a)(h,"OnPodSessionExpiredEventArgs",Sys.EventArgs,[])},928:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.slideId=e.SlideId;this.slideIndex=e.SlideIndex;this.$nc=e.TimeLineMappings}}Object(J.a)(h,"OnPositionChangedEventArgs",Sys.EventArgs,[])},929:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(1166);class e extends Sys.EventArgs{constructor(m){super();this.nzh=null;this.nzh="string"===typeof m?Object(h.a)(String,
m):m.TranscriberSessionId}}Object(J.a)(e,"OnTranscriberStartedEventArgs",Sys.EventArgs,[])},930:function(J,V,d){d.d(V,"a",function(){return y});J=d(0);var h=d(376),e=d(268),m=d(25),r=d(170),v=d(54),A=d(45),w=d(234);class y{static qgg(u){const D={};D.appSettings=y.Xxi();D.singleSignOnSettings=y.Qfg();D.appVersion="16";D.appUILocale=e.a.oe(m.AFrameworkApplication.lcid).Bsb;D.dataLocale=e.a.oe(m.AFrameworkApplication.lcid).Bsb;D.osfOmexBaseUrl=m.AFrameworkApplication.fa.Ga("50");D.firstPartyManifestCDNUrl=
m.AFrameworkApplication.fa.Ga("565");D.sdxCdnUrl=m.AFrameworkApplication.fa.Ga("649");D.sdxDmsUrl=m.AFrameworkApplication.fa.Ga("650");D.sdxAssetsToPrefetchMapping=m.AFrameworkApplication.fa.Ga("974");D.docUrl=u?u.documentUrl:"";D.pageBaseUrl=r.a.GO;D.lcid=m.AFrameworkApplication.lcid.toString();D.allowExternalMarketplace=m.AFrameworkApplication.fa.ka("51");D.localizedScriptsUrl=r.a.GO+m.AFrameworkApplication.fa.Ga("52");u=u?u.wng:"";D.localizedImagesUrl=r.a.GO+u;D.localizedStylesUrl=r.a.GO+u;D.localizedResourcesUrl=
r.a.R_h(u);D.enableAddinCommands=m.AFrameworkApplication.fa.ka("203");D.enableMyApps=m.AFrameworkApplication.fa.ka("186");D.enableMyOrg=m.AFrameworkApplication.fa.ka("187");D.enableUploadFileDevCatalog=m.AFrameworkApplication.fa.ka("203")&&!m.AFrameworkApplication.fa.ka("847");D.enableDevCatalog=m.AFrameworkApplication.fa.ka("221");D.devCatalogUrl=m.AFrameworkApplication.fa.Ga("220");D.enablePrivateCatalog=m.AFrameworkApplication.fa.ka("305");D.showSignOutFromPrivateCatalogMessage=m.AFrameworkApplication.fa.ka("307");
D.enableBlackForestRedirect=m.AFrameworkApplication.fa.ka("348");D.enableSingleSignOnForAddin=m.AFrameworkApplication.fa.ka("342")&&m.AFrameworkApplication.zEj;D.enableTaskpaneUpgradeToAppCommand=m.AFrameworkApplication.fa.ka("381");D.hideAppsExtensionUrl=m.AFrameworkApplication.hideAppsExtensionUrl;D.enableAnonymousUseLegacyCatalogService=m.AFrameworkApplication.fa.ka("549");D.enableInsertDialogAccessibilityFix=m.AFrameworkApplication.fa.ka("584");D.enableFirstPartySDXErrorMessages=m.AFrameworkApplication.fa.ka("677");
D.disableAppsForOfficeThirdParty=m.AFrameworkApplication.fa.ka("569");D.wacSessionId=m.AFrameworkApplication.userSessionId;D.disableLogging=!m.AFrameworkApplication.fa.ka("AriaLoggingIsEnabled");D.loggableUserId=m.AFrameworkApplication.fa.Ga("LoggableUserId");D.sessionStartInfoJson=m.AFrameworkApplication.fa.Ga("SessionStartInfoJson");D.wopiHostOriginFromPostMessage=m.AFrameworkApplication.wopiHostOriginFromPostMessage;D.wopiHostOriginFromWacPropBag=m.AFrameworkApplication.fa.Ga("PostMessageOrigin");
D.wacIsEmbedded=m.AFrameworkApplication.fa.ka("IsEmbedded");D.accessibilityAllowFocusAddinTaskpane=m.AFrameworkApplication.fa.ka("1055");D.disableMicrophonePermission=v.a.zN(1)&&m.AFrameworkApplication.fa.ka("TranscriberSafariEnabled")&&m.AFrameworkApplication.fa.ka("RehearsalSafariEnabled");D.isHostFrameTrustCheckEnabledForAddIns=m.AFrameworkApplication.fa.ka("1100");D.isHostFrameTrusted=m.AFrameworkApplication.isHostFrameTrusted;D.hostAllowedSdxEmbedding=m.AFrameworkApplication.fa.ka("HostAllowedSdxEmbedding");
D.hostAllowedOfficeStore=m.AFrameworkApplication.fa.ka("HostAllowedOfficeStore");D.hostInstallAddIns=m.AFrameworkApplication.fa.Ga("HostInstallAddIns");D.hostInstallAddInsIsEnabled=m.AFrameworkApplication.fa.ka("HostInstallAddInsIsEnabled");D.approvedAddIns=m.AFrameworkApplication.fa.Ga("ApprovedAddIns");D.isUpnCheckEnabled=m.AFrameworkApplication.fa.ka("1132");D.wacUpn=m.AFrameworkApplication.fa.Ga("UserPrincipalName");D.isReactRibbonEnabled=!0;D.enableSetFocusOnTaskpaneOnUserAction=m.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",
!1);D.enableMyOrg&&D.docUrl&&(u=D.docUrl.split("/"),D.spBaseUrl=2<u.length?u[0]+"//"+u[2]:null,D.spBaseUrl||h.ULS.sendTraceTag(512263002,806,10,String.format("Failed to parse SpBaseUrl from DocUrl: {0}",D.docUrl)));D.userNameHashCode=A.a.NM(m.AFrameworkApplication.userName);D.envCode=m.AFrameworkApplication.fa.Cc("312",0).toString();return D}static Xxi(){const u={};u.AddinRibbonIdAllowUnknown=m.AFrameworkApplication.fa.ka("AddinRibbonIdAllowUnknown");u.AddinRibbonNativeGroupControlIsEnabled=!0;u.AddinRibbonTabAutoFocusIsEnabled=
!0;u.AddinRibbonTabPositionIsEnabled=!0;u.AgaveAddinUploadEnabled=m.AFrameworkApplication.fa.ka("AgaveAddinUploadEnabled");u.DevConsoleEnabled=m.AFrameworkApplication.fa.ka("AddinDevConsoleLog");u.ManifestParserDevConsoleEnabled=!0;u.flightingTreatmentVariables=m.AFrameworkApplication.fa.dLc;return u}static Qfg(){try{const u={};v.a.rEa&&w.OAuthManagerSettings.i8a&&(u.UiHostSupportsAuthTokenAddinList=y.ZKc);u.UiHostSupportsAuthToken=w.OAuthManagerSettings.i8a;return u}catch(u){h.ULS.sendTraceTag(512263001,
344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",u.message)}return null}}y.ZKc="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");Object(J.a)(y,"AppForOfficeHelper",null,[])},931:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.RWg=e}}Object(J.a)(h,"CoauthorStatusChangedEventArgs",Sys.EventArgs,[])},932:function(J,
V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,r){this.VVa={};this.FOg=e;this.jne=m;this.j$b=r}$Ca(e,m,r,v){m=h.fXf;if(this.jne)if(this.j$b){const A=e.UserId?e.UserId.toLowerCase():null;r=r?r.toLowerCase():null;m=A&&A in this.VVa?this.VVa[A]:r&&r in this.VVa?this.VVa[r]:this.FOg.$Ca(e,v);!A||A in this.VVa||(this.VVa[A]=m);!r||r in this.VVa||(this.VVa[r]=m)}else m=this.FOg.$Ca(e,v);return m}}h.fXf="#C0C0C0";Object(J.a)(h,"PresenceColorProvider",null,[301])},933:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.vJ=e}}Object(J.a)(h,"BeforeSessionEndEventArgs",Sys.EventArgs,[])},934:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(1115),e=d(25),m=d(33),r=d(80);class v{constructor(){this.BaseDocQuerySignature=null;this.RoamingApp=0}UGb(){return m.c([this.Ok(),this])}execute(A,w,y){let u="RoamingAppsHandler.ashx";h.a.instance.aIe&&0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(u=r.a.Ri(u,"wdEnableRoaming",
"1"));e.AFrameworkApplication.Ge.yj(u,2,this.UGb(),{"Content-Type":"application/json; charset=utf-8"},!1,this.Ptb(),A,w,y,void 0,void 0,void 0,void 0,"6")}}Object(J.a)(v,"ARoamingAppsRequest",null,[])},935:function(J,V,d){d.d(V,"a",function(){return 2});d.d(V,"c",function(){return h});d.d(V,"b",function(){return e});const h=(m,r,v=2)=>{let A;if(0>r||r>m[m.length-1])throw Error.argumentOutOfRange("y");A=!0;let w=0,y;const u=m.length-1;for(y=0;y<u;y++){const D=w;w=m[y+1];if(r<w){w-r<v&&y<u-1?y++:r-
D>=v&&(A=!1);break}}return{returnValue:y<u?y:-1,gbe:A}},e=(m,r,v=2)=>{let A;if(0>r||r>m[m.length-1])throw Error.argumentOutOfRange("x");A=!0;let w=0,y;const u=m.length-1;for(y=0;y<u;y++){const D=w;w=m[y+1];if(r<w){w-r<v&&y<u-1?y++:r-D>=v&&(A=!1);break}}return{returnValue:y<u?y:-1,gbe:A}}},936:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.LOa=this.uZ=0;this.skipUndo=!1;this.Np=this.selectionSlide=null;this.version=0;this.BE=this.location=null;this.dataType=0;this.kec=
null;this.objectCount=0;this.MDa=this.ODa=!1;this.kz=this.wra=this.nodes=null}toString(){const e=JSON.stringify(this.wra);return String.format("CcpId:{0}, version:{1}, DC:{2}, DataType:{3}, ObjectCount:{4}, Cut?:{5}, IsEPH?:{6}, ExtraData:[{7}], CopyStatus: {8}.",this.Np,this.version,this.BE,this.dataType,this.objectCount,this.ODa,this.MDa,e,this.uZ)}}Object(J.a)(h,"ClipServiceObject",null,[])},937:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(13),e=d(73),m=d(65),r=d(133);class v extends Sys.UI.Control{constructor(A,
w,y,u){super(document.createElement("div"));this.b6=this.Z5=this.DE=this.Y_a=this.DR=this.UKa=this.DMa=null;this.jOb=this.FLa=!1;this.content=this.AB=null;this.Y$=0;this.UJf=null;this.iZ=0;this.r$c=null;this.Lyf=A;this.omb=w;this.eP=y;this.SOd=u;this.ai=w.ownerDocument;this.c3b=this.qr=this.SOb=!1}get hJ(){this.DMa||(this.DMa=this.ai.createElement("div"),this.DMa.id=this.ji("WACCalloutOuter"),this.DMa.className="WACCalloutOuter",this.DMa.setAttribute(r.a.Ye,r.a.QKd),this.DMa.style.width=this.Y$+"px");
return this.DMa}get apb(){if(!this.UKa){this.UKa=this.ai.createElement("div");this.UKa.id=this.ji("WACCalloutBeakContainer");this.UKa.className="WACCalloutBeakContainer";var A="CalloutBeakTopFilled_32x16x32";if(5===this.iZ||6===this.iZ||4===this.iZ)A="CalloutBeakBottomFilled_32x16x32";A=e.createClusteredImage(32,16,A,"WACCalloutBeak",!0,"");this.UKa.appendChild(A)}return this.UKa}set apb(A){this.UKa=A}get VK(){return this.SOb}get title(){return this.AB}set title(A){this.AB!==A&&(this.AB=A,this.Z5&&
(this.Z5.innerText=this.AB))}get qr(){return this.FLa}set qr(A){this.FLa!==A&&(this.FLa=A,this.DR&&(this.DR.contains(this.DE)&&!this.FLa?this.DR.removeChild(this.DE):!this.DR.contains(this.DE)&&this.FLa&&this.SCf()))}get c3b(){return this.jOb}set c3b(A){this.jOb!==A&&(this.jOb=A,this.DR&&(this.DR.contains(this.Z5)&&!this.jOb?this.DR.removeChild(this.Z5):!this.DR.contains(this.Z5)&&this.jOb&&this.rEf()))}show(){this.SOb||(this.fzi(),this.tci(),this.omb.appendChild(this.hJ),this.hJ.style.display="Block",
this.CLe(),this.SOb=!0,this.r$c&&this.r$c())}dismiss(){this.SOb&&(this.AHi(),this.omb.removeChild(this.hJ),this.SOb=!1,this.SOd&&this.SOd())}dispose(){this.dismiss();this.Z5=this.DE=this.Y_a=this.UKa=this.DR=this.DMa=null;Sys.Component.prototype.dispose.call(this)}ji(A){return this.get_element().id+A}fzi(){this.DR=this.ai.createElement("div");this.DR.id=this.ji("WACCalloutHeader");this.DR.className="WACCalloutHeader";this.qr&&this.SCf();this.c3b&&this.rEf();this.Y_a=this.ai.createElement("div");this.Y_a.id=
this.ji("WACCalloutContent");this.Y_a.className="WACCalloutContent";this.Y_a.style.width=190<this.Y$?this.Y$-26+"px":"164px";this.Y_a.appendChild(this.content);this.hJ.appendChild(this.apb);this.hJ.appendChild(this.DR);this.hJ.appendChild(this.Y_a)}SCf(){this.DE=this.ai.createElement("a");this.DE.className="WACCalloutCloseAnchor";this.DE.id=this.ji("WACCalloutCloseAnchor");this.DE.href="#";this.DR.appendChild(this.DE);const A=e.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",
!0,CommonUIStrings.l_DialogClose);this.DE.appendChild(A)}rEf(){this.Z5=this.ai.createElement("div");this.Z5.className="WACCalloutTitle UIFontBold";this.Z5.style.width=190<this.Y$?this.Y$-30+"px":"160px";this.Z5.id=this.ji("WACCalloutTitle");this.Z5.innerText=this.title;this.DR.contains(this.DE)?this.DR.insertBefore(this.Z5,this.DE):this.DR.appendChild(this.Z5)}CLe(){var A=this.Lyf;let w;if(1===this.iZ){var y=this.UJf.y+16;w=-16}else 2===this.iZ||3===this.iZ||0===this.iZ?(y=A.y+A.height+15,w=-15):
(y=A.y-this.hJ.clientHeight-15-2,w=this.hJ.clientHeight-1);this.hJ.style.top=y+"px";this.apb.style.top=w+"px";1===this.iZ?(A=this.UJf.x-16,this.hJ.style.left="50%",this.hJ.style.marginLeft=-this.Y$/2+"px",y=Sys.UI.DomElement.getBounds(this.hJ),this.apb.style.left=A-y.x+"px"):(y=A.x+this.Lyf.width/2,2===this.iZ||5===this.iZ?(A=20,y-=36):0===this.iZ||4===this.iZ?(A=this.Y$/2-16,y-=this.Y$/2):(A=this.Y$-20-32,y=y-this.Y$+36),this.hJ.style.left=y+"px",this.apb.style.left=A+"px")}tci(){this.qr&&!this.b6&&
(this.b6=Object(h.a)(this,this.i2,"closeHandler"),this.eP.ob(m.a.click,this.DE,this.b6,null))}AHi(){this.qr&&this.b6&&(this.eP.xb(m.a.click,this.DE,this.b6),this.b6=null)}i2(){this.dismiss();return!0}}Object(J.a)(v,"Callout",Sys.UI.Control,[792])},938:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e){this.B$j=e}get Zlc(){return this.B$j}}Object(J.a)(h,"ShowHideNotesData",null,[])},939:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);d=d(876);class h extends d.a{constructor(e,
m){super(m);this.xNg=e;this.ebb=0}T3f(){const e=(new Date).getTime(),m=e-this.ebb;if(0<this.ebb&&0>=this.xNg-m)return this.ebb=0,this.zNd(),!0;this.ebb=e;this.zNd();this.setTimeout(this.xNg);return!1}}Object(J.a)(h,"FunctionDelayer",d.a,[])},940:function(J,V,d){d.d(V,"b",function(){return e});d.d(V,"a",function(){return m});d.d(V,"c",function(){return r});var h=d(45);d(390);d(27);d(59);const e=(v,A)=>{const w=[];if(v.length!==A.length)return w;for(let y=0;y<v.length;y++){const u={};u.key=A[y];u.text=
v[y];u.type="AppComboBoxItem";w[y]=u}return w},m=(v,A,w,y,u)=>({["unitType"]:v,["unitPlaceholder"]:h.a.HAe(A),["minValue"]:w,["maxValue"]:y,["step"]:u}),r=v=>"1.00"===v?1:"1.50"===v?1.5:"2.00"===v?2:0},941:function(J,V,d){d.d(V,"a",function(){return v});J=d(0);var h=d(45),e=d(90),m=d(26),r=d(38);class v{constructor(A){this.WVa=null;this.kac=0;this.z9b=A;switch(this.z9b){case "audio":this.WVa=v.Ebk;this.kac=v.P0j;break;case "captions":this.WVa=v.Fbk;this.kac=v.f1j;break;case "video":this.WVa=v.Gbk;
this.kac=v.Nbk;break;default:m.a.J(509727835,822,10,"Invalid file type")}}static set MAl(A){v.Gbk=A}static set HBl(A){v.Nbk=A}oni(A){switch(this.z9b){case "audio":return v.mni(A);case "captions":return v.nni(A);case "video":return r.a("DisableVideoAsFileCheck")?new Promise(w=>{w(!0)}):v.pni(A);default:return m.a.J(509727834,822,10,"Invalid file type"),new Promise(w=>{w(!1)})}}$Al(A){A=h.a.wg(A);for(let w=0;w<this.WVa.length;++w){const y=this.WVa[w];if(y&&0<y.length&&A.endsWith(y))return!0}return!1}aBl(A){return A<=
1048576*this.kac}static mni(A){return new Promise((w,y)=>{if(A&&A.size){var u=document.createElement("video"),D=URL.createObjectURL(A);u.setAttribute("src",D);e.a.addHandler(u,"loadedmetadata",()=>{URL.revokeObjectURL(D);const F=u.videoHeight,I=u.videoWidth;0<u.duration&&!F&&!I?w(!0):(m.a.J(509727832,822,10,"Invalid audio File"),w(!1))});e.a.addHandler(u,"error",()=>{URL.revokeObjectURL(D);m.a.J(509727831,822,10,"Invalid audio File");y(ResourceStrings.L_InvalidAudioFileError)})}else m.a.J(509727833,
822,10,"Empty media File"),w(!1)})}static nni(A){return new Promise((w,y)=>{if(A&&A.size){var u=URL.createObjectURL(A),D=document.createElement("video"),F=document.createElement("track");D.appendChild(F);e.a.addHandler(F,"load",()=>{URL.revokeObjectURL(u);w(!0)});e.a.addHandler(F,"error",()=>{URL.revokeObjectURL(u);m.a.J(509727829,822,10,"Invalid captions File");y(ResourceStrings.l_InvalidCaptionsFileError)});F.setAttribute("src",u);F.setAttribute("default","true")}else m.a.J(509727830,822,10,"Empty captions File"),
w(!1)})}static pni(A){return new Promise((w,y)=>{if(A&&A.size){var u=document.createElement("video"),D=URL.createObjectURL(A);u.setAttribute("src",D);e.a.addHandler(u,"loadedmetadata",()=>{URL.revokeObjectURL(D);const F=u.videoHeight,I=u.videoWidth;0<u.duration&&0<F&&0<I?w(!0):(m.a.J(509727837,822,10,"Invalid video File"),w(!1))});e.a.addHandler(u,"error",()=>{URL.revokeObjectURL(D);m.a.J(509727836,822,10,"Invalid video File");y(ResourceStrings.L_InvalidVideoFileError)})}else m.a.J(509727838,822,
10,"Empty media File"),w(!1)})}static Nag(A){return A&&A.value?A.files[0].size.toString():"Invalid number of files"}static X_d(A){if(!A||!A.value)return"Input file name is null";const w=A.value.lastIndexOf(".");return-1===w?"":A.value.substring(w+1,w+5)}}v.P0j=16;v.f1j=16;v.Fbk=[".vtt"];v.Ebk=[".mp3",".wav",".m4a",".aac",".oga"];Object(J.a)(v,"MediaValidationHelper",null,[])},942:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e){super();this.E3f=e}}
Object(J.a)(h,"CommentContainersChangedEventArgs",Sys.EventArgs,[])},973:function(J,V,d){d.r(V);J=d(0);var h=d(77),e=d(45),m=d(90),r=d(65),v=d(25),A=d(1165),w=d(13),y=d(17),u=d(85),D=d(337),F=d(26),I=d(38);class H{constructor(Va){this.ApiType=0;this.ApiType=Va}}Object(J.a)(H,"SlideshowApiMessage",null,[]);class L extends H{constructor(){super(14);this.TopValue="0%";this.HeightValue="100%"}}Object(J.a)(L,"DockSlideshowViewMessage",H,[]);class E extends H{constructor(){super(6);this.AnimStep=this.SlideIndex=
0}}Object(J.a)(E,"GoToSlideApiMessage",H,[]);class aa extends H{constructor(){super(16);this.SlideIndex=0;this.TimeLineMappings=null}}Object(J.a)(aa,"GoToSlideWithTimeLinesApiMessage",H,[]);class Q extends H{constructor(){super(19);this.Color=this.Item=null}}Object(J.a)(Q,"InkManagerMessage",H,[]);class O{constructor(Va){this.bH=Va.origin;this.FRg=Va.source;this.Qta=Va.data}}Object(J.a)(O,"MessageEvent",null,[]);var T=d(922),K=d(920),X=d(923),P=d(924);class ea extends Sys.EventArgs{constructor(Va){super();
this.i6b=Va.IsStartTranscription;this.Fv=Va.SubtitlesPosition}}Object(J.a)(ea,"OnLiveSubtitlesDockedViewEventArgs",Sys.EventArgs,[]);class ia extends Sys.EventArgs{constructor(Va){super();this.vx=Va.SessionTelemetry}}Object(J.a)(ia,"OnLogEndOfTranscriptionSessionEventArgs",Sys.EventArgs,[]);var ja=d(927),C=d(928),pa=d(925);class Z extends Sys.EventArgs{constructor(Va,Za){super();this.sEj=Va;this.category=Za.Category;this.code=Za.Code;this.message=Za.Message;this.Dy=Za.ExtraInfo;this.correlationId=
Za.CorrelationId;this.sessionId=Za.SessionId}}Object(J.a)(Z,"OnSlideshowErrorEventArgs",Sys.EventArgs,[]);var qa=d(921);class ya extends Sys.EventArgs{constructor(Va){super();this.isFinal=Va.IsFinal;this.ozh=Va.Transcripts}}Object(J.a)(ya,"OnSubtitleUpdatedEventArgs",Sys.EventArgs,[]);var Ka=d(929),Da=d(926);class la extends Sys.EventArgs{constructor(Va){super();this.errorName=Va.ErrorName;this.vetoName=Va.VetoName;this.isIntentional=Va.IsIntentional;this.isInternal=Va.IsInternal;this.alertOnPillar=
Va.AlertOnPillar;this.isSessionEndingError=Va.IsSessionEndingError;this.durationMs=Va.DurationMs}}Object(J.a)(la,"RecordQosErrorEventArgs",Sys.EventArgs,[]);class ma extends H{constructor(){super(11);this.StartSlideShowTime=0}}Object(J.a)(ma,"RecordStartedSlideShowTimestampApiMessage",H,[]);class Ea extends H{constructor(){super(7);this.WacCluster=this.PodSessionId=null}}Object(J.a)(Ea,"RefreshPodSessionApiMessage",H,[]);class ta extends H{constructor(){super(21);this.IsMute=!1}}Object(J.a)(ta,"SetMicrophoneStateMessage",
H,[]);class Ga extends H{constructor(){super(12);this.OsfLocalStorageData=null}}Object(J.a)(Ga,"SetOsfLocalStorageApiMessage",H,[]);class oa{constructor(){this.i6b=this.Pwg=!1;this.Fv=null}}Object(J.a)(oa,"SlideShowViewDockingState",null,[]);var sa=d(975);class Ha extends H{constructor(){super(0);this.SlideIndex=this.SlideId=0;this.WacCluster=this.Endpoint=this.PodSessionId=this.WacUserSessionId=this.UserId=null;this.FPrerenderSS=!1;this.PrerenderCid=null;this.SlideShowClickTime=0;this.EndSlideShowText=
null;this.FSupportSVGInWebGL="0";this.HostSupportsSessionRefreshEnabled=!1;this.RenderShapeBuilder="0";this.CustomTransitionResourceUrl=this.DisabledTransitionsList=this.VetoAppSettingsStr=this.FileHost=null;this.StreamVideoUseThinEmbed=!1;this.DisabledChangeGates=null;this.AllowExternalMarketplace=this.AreThirdPartyAddInsAllowed=!1}}Object(J.a)(Ha,"StartSlideShowApiMessage",H,[]);class bb extends H{constructor(){super(13);this.IsToggleOn=!1;this.PragueSessionInfo=""}}Object(J.a)(bb,"ToggleTranscriberLiveBroadcastModeMessage",
H,[]);class Ya extends H{constructor(){super(18);this.HideUI=!1}}Object(J.a)(Ya,"ToggleTranscriberUIVisibilityMessage",H,[]);class ua extends H{constructor(){super(8);this.SubtitlesResourceStr=this.SubtitlesContextStr=this.SubtitlesAppSettingsStr=null;this.MicrophoneDeviceId=this.LiveBroadcastContextStr=this.RehearsalContextStr=""}}Object(J.a)(ua,"TranscribeApiMessage",H,[]);var Ma=d(69);d.d(V,"SlideshowFrame",function(){return Ca});class Ca{constructor(Va,Za,Db,Lb,yb,Bc,tb,Mb){this.hb=this.XUa=this.WUa=
this.$ta=null;this.va=new h.a;this.iFa=null;this.ese=this.JRg=!1;this.gf=Za;this.la=Db;this.Fc=Lb;this.Rb=yb;this.IN=Bc;this.Bl=tb;this.Dyb=Mb;this.y6j=new A.a(Object(w.a)(Va,Va.zfi,"browserSupportsRenderingSVGInWebGL"))}init(Va,Za,Db){if(!this.hb){this.$ta=document.getElementById("HiddenFocusTrapAnchor");this.hb=document.createElement("iframe");this.hb.id="SlideShowHostFrame";this.hb.className="SlideShowHostFrame";this.hb.style.display=Ma.a.Cf;this.hb.setAttribute("allow","microphone; autoplay");
this.iFa=new oa;Db=this.la.isHermesSlideShowPreloadEnabled?String.format("EndSlideShowText={0}&UserSessionId={1}&WacCluster={2}",e.a.Qe(ResourceStrings.l_EndOfSlideShowMessage),e.a.Qe(Db),e.a.Qe(Za)):"";Db+=String.format(Db?"&HostSupportsSessionRefreshEnabled={0}":"HostSupportsSessionRefreshEnabled={0}",e.a.Qe(this.la.hostSupportsSessionRefreshEnabled.toString()));Db+=String.format(Db?"&InkingEnabled={0}":"InkingEnabled={0}",e.a.Qe(this.la.isInkingInSlideShowEnabled.toString()));Db+=String.format(Db?
"&VideoThruTransparentCanvas={0}":"VideoThruTransparentCanvas={0}",e.a.Qe(this.la.vSj.toString()));Db+=String.format(Db?"&IsFlipgridVideoEnabled={0}":"IsFlipgridVideoEnabled={0}",e.a.Qe(this.la.Y8a.toString()));Db+=String.format(Db?"&IsTEDVideoEnabled={0}":"IsTEDVideoEnabled={0}",e.a.Qe(this.la.Xwb.toString()));Db+=String.format(Db?"&IsAllowExternalMarketplace={0}":"IsAllowExternalMarketplace={0}",e.a.Qe(this.la.otg.toString()));Db+=String.format(Db?"&IsNewSlideShowToolbarEnabled={0}":"IsNewSlideShowToolbarEnabled={0}",
e.a.Qe(this.la.r5b.toString()));Db+=String.format("&ImageCachingEnabled={0}",e.a.Qe(this.la.Fgl.toString()));Db+=String.format("&PodSlideshowEnableTabLoopFix={0}",e.a.Qe(this.la.Pxk.toString()));Db+=String.format("&PodsLoadSlideShowFrameFromCdn={0}",e.a.Qe(this.la.podsLoadSlideShowFrameFromCdn.toString()));Db+=String.format("&PodsBase={0}",e.a.Qe(this.la.podsWebServiceBase));var Lb=this.la.Dea;this.la.QSa&&(Lb=new D.a(Lb),Lb.ppc=this.la.QSa,Lb.Clc=this.la.zph,Lb.Blc=this.la.yph,Lb=Lb.toString());
var yb=this.la.podsLoadSlideShowFrameFromCdn&&!e.a.Va(this.la.podsBaseSlideShowFramePath);this.hb.src=yb?this.la.podsBaseSlideShowFramePath:"./SlideShowFrame.html";this.hb.src=String.format(this.hb.src+"?Version={0}&WacCluster={1}&BootJS={2}&{3}={4}",Va,e.a.Qe(Za),e.a.Qe(this.la.pptEditorSlideShowWrsEndpoint),u.a.Yfc,Lb);F.a.J(512495881,830,50,String.format("LoadFromCdn {0}, IsTranscriberEnabled {1}",yb,this.la.Rja));if(this.la.Rja||this.la.t6b)this.hb.src=String.format(this.hb.src+"&TranscriberJS={0}&ClientAudioMessageJS={1}&SpeechResultMessageJS={2}&TranscriberURI={3}",
e.a.Qe(this.la.pptEditorTranscriberJsUri),e.a.Qe(this.la.pptEditorTransciberClientAudioMessageJsUri),e.a.Qe(this.la.pptEditorTransciberSpeechResultMessageJsUri),e.a.Qe(this.la.pptEditorSpeechHandlerBaseUri)),this.hb.src=String.format(this.hb.src+"&SpeechResponseMessageJS={0}",e.a.Qe(this.la.pptEditorTranscriberSpeechResponseMessageJsUri)),e.a.wg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js")&&(this.hb.src=String.format(this.hb.src+"&QualityStatusMessageJS={0}",
e.a.Qe(this.la.pptEditorTranscriberQualityStatusMessageJsUri))),this.la.t6b&&e.a.wg(this.la.pptEditorTranscriberRehearsalResultMessageJsUri).endsWith("rehearsalresultmessage.js")&&(this.hb.src=String.format(this.hb.src+"&RehearsalResultMessageJS={0}",e.a.Qe(this.la.pptEditorTranscriberRehearsalResultMessageJsUri))),this.la.pptEditorTranscriberLiveAgentEnabled&&e.a.wg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js")&&(this.hb.src=String.format(this.hb.src+"&AgentCommandMessageJS={0}",
e.a.Qe(this.la.pptEditorTranscriberAgentCommandMessageJsUri)));this.la.powerPointLiveBroadcastEnabled&&(this.hb.src+="&wdLiveBroadcast=true");this.hb.src=String.format(this.hb.src+"#{0}",Db);I.a("PresenterCoachTabFix")&&this.$ta?this.gf.insertBefore(this.hb,this.$ta):this.gf.appendChild(this.hb);m.a.addHandler(window,r.a.message,Object(w.a)(this,this.Yqk,"onSlideshowMessage"));this.Fc.csb&&this.la.Jbd&&this.zWj();I.a("PresenterCoachTabFix")&&(this.WUa=document.getElementById("legacySlideshowBeginningFocusTrap"),
this.XUa=document.getElementById("legacySlideshowEndFocusTrap"),this.WUa||this.XUa||(this.WUa=document.createElement("div"),this.WUa.id="legacySlideshowBeginningFocusTrap",this.WUa.className="FocusTrap",this.WUa.tabIndex=0,m.a.addHandler(this.WUa,r.a.focus,Object(w.a)(this,this.hfc,"onSlideShowContainerDivFocusHandler")),this.XUa=document.createElement("div"),this.XUa.id="legacySlideshowEndFocusTrap",this.XUa.className="FocusTrap",this.XUa.tabIndex=0,m.a.addHandler(this.XUa,r.a.focus,Object(w.a)(this,
this.hfc,"onSlideShowContainerDivFocusHandler")),this.gf.insertBefore(this.WUa,this.gf.firstChild),this.gf.insertBefore(this.XUa,this.$ta.nextSibling)))}}b6a(){return this.la.Jbd&&this.ese}erk(){F.a.J(512495880,830,50,"SlideShowFrame::OnSpeechClientScriptLoaded Speech client script has been loaded successfully");this.JRg=!0;return null}zWj(){const Va=new y.a;Va.add(this.Dyb.loadScript("PPTSpeechClient"));Promise.all(Va.toArray()).then(()=>this.erk()).catch(Za=>{F.a.J(512495879,830,10,"SlideShowFrame::LoadSpeechClientResources Failed to load the resources for SlideShowCore: {0}",
Za)})}fkd(Va,Za,Db,Lb,yb,Bc,tb,Mb,Hb){this.iFa=new oa;tb&&F.a.J(512495878,830,50,String.format("Will trigger slideshow bundle rendering, correlation = {0}",Mb));this.KF(Object.assign(new Ha,{WacCluster:Db,PodSessionId:Lb,UserId:yb,WacUserSessionId:Bc,SlideId:Va,SlideIndex:Za,FPrerenderSS:tb,PrerenderCid:Mb,SlideShowClickTime:Hb,EndSlideShowText:ResourceStrings.l_EndOfSlideShowMessage,FSupportSVGInWebGL:this.y6j.value?"1":"0",RenderShapeBuilder:this.la.QSa?"1":"0",FileHost:v.AFrameworkApplication.fa.Ga("FileHost"),
VetoAppSettingsStr:this.Fjj(),DisabledTransitionsList:this.la.fKa,CustomTransitionResourceUrl:this.la.wWf,StreamVideoUseThinEmbed:v.AFrameworkApplication.fa.ka("StreamVideoUseThinEmbed"),DisabledChangeGates:v.AFrameworkApplication.fa.Ga("PPTDisabledChangeGates"),AreThirdPartyAddInsAllowed:v.AFrameworkApplication.jqa,AllowExternalMarketplace:v.AFrameworkApplication.fa.ka("51")}))}prev(){this.KF(new H(2))}next(){this.KF(new H(1))}transcribe(Va,Za,Db,Lb,yb,Bc,tb){var Mb=!!this.Rb&&!!this.Rb.instance&&
(this.Rb.instance.bQa||this.Rb.instance.Rq);(this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&this.Rb.instance.$Ba||Mb)&&!this.Rb.instance.gsb()?F.a.J(512495877,830,50,"LivePresenter prevented transcriber from starting"):this.b6a()?(sa.a.instance.transcribe(Va,Za,Db,Lb,yb,Bc,tb),this.HIc(this.Fc.Kh&&5!==yb,this.Fc.Fv)):(Mb={},Mb.TranslationLanguages=this.la.powerPointLiveBroadcastEnabled?this.la.liveBroadcastTranslationLanguagesOverride:"",Mb.BroadcastSubtitlesFromSpeechFrontDoorForLive=this.la.powerPointLiveBroadcastEnabled?
!0:!1,this.KF(Object.assign(new ua,{SubtitlesAppSettingsStr:this.Lgj(Va,Db,Za,Lb,yb,Bc),SubtitlesContextStr:this.Fc.okl,SubtitlesResourceStr:this.Mgj(),RehearsalContextStr:tb?tb.POk:"",LiveBroadcastContextStr:JSON.stringify(Mb),MicrophoneDeviceId:this.IN.microphoneDeviceId})))}setMicrophoneState(Va){this.b6a()?sa.a.instance.setMicrophoneState(Va):(this.KF(Object.assign(new ta,{IsMute:Va})),this.Rb&&this.Rb.instance&&(Va?this.Rb.instance.ynh():this.Rb.instance.znh()))}NJb(Va,Za=""){this.iFa.Pwg=Va;
F.a.J(512495876,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");this.b6a()?(sa.a.instance.Tyh(Va,Za),this.HIc(this.Fc.Kh,this.Fc.Fv)):this.KF(Object.assign(new bb,{IsToggleOn:Va,PragueSessionInfo:Za}));this.a_g()}toggleTranscriberUIVisibility(Va){F.a.J(512495875,830,50,"Toggling Transcriber UI visibilitye ... On: {showUI}");this.b6a()?(Va=Va?Va?!1:!0:!sa.a.instance.isVisible(),sa.a.instance.setVisibility(Va),sa.a.instance.RBc(),this.HIc(this.Fc.Kh,this.Fc.Fv)):this.KF(Object.assign(new Ya,
{HideUI:Va}))}HIc(Va,Za){this.iFa.i6b=Va;this.iFa.Fv=Za;this.a_g()}setOsfLocalStorage(){const Va={};let Za=!1;try{const Db=RegExp("^osfCacheVersion|_?_OSF_.+$");for(let Lb=0;Lb<localStorage.length;++Lb){const yb=localStorage.key(Lb);if(Db.test(yb)){const Bc=localStorage.getItem(yb);Va[yb]=Bc;Za=!0}}}catch(Db){F.a.J(512495874,830,50,"SlideShowFrame::Exception while retrieving OSF Local Storage data: {0}",Db.toString())}Za&&this.KF(Object.assign(new Ga,{OsfLocalStorageData:Va}))}show(){F.a.J(512495873,
830,50,"SlideShowFrame::Show Making frame visible.");if(this.hb){this.hb.style.display=Ma.a.Lk;var Va=(new Date).getTime();F.a.J(512495843,830,50,"SlideShowFrame::Show Sending startedSlideShowTimestamp: {0} to SlideShowFrame.html",Va);this.KF(Object.assign(new ma,{StartSlideShowTime:Va}))}else F.a.J(512495872,830,15,"SlideShowFrame::Show Making frame visible, but m_frame is null.")}Twb(){return this.hb&&this.hb.style.display!==Ma.a.Cf?!0:!1}V2(){return"Legacy"}goc(Va){this.hb.style.display=Va?Ma.a.Lk:
Ma.a.Cf;this.b6a()&&sa.a.instance.setVisibility(Va&&this.Fc.Kh)}QLc(){F.a.J(512495842,830,50,"SlideShowFrame: Exiting with post message");this.KF(new H(3))}exit(){this.hb.style.display===Ma.a.Cf?this.va.raiseEvent("OnExit",new K.a({SlideId:0,IsBeforeReady:!0})):(F.a.J(512495841,830,50,"SlideShowFrame: Making frame invisible"),this.hb.style.display=Ma.a.Cf,this.KF(new H(3)));this.b6a()&&sa.a.instance.WPe()}restoreFocus(){this.hb.style.display===Ma.a.Cf||this.N$d()||(this.hb.focus(),this.KF(new H(4)))}pausePresentation(){this.KF(new H(15))}GSe(){this.va.raiseEvent("OnFullscreenClick",
new Sys.EventArgs)}getCurrentPosition(){this.KF(new H(5))}getCurrentPositionWithTimeLines(){this.KF(new H(17))}getCurrentSlideDimensions(){this.KF(new H(20))}mRa(Va){this.KF(Object.assign(new E,{SlideIndex:Va,AnimStep:0}))}bBe(Va){this.KF(Object.assign(new Q,{Item:Va.item,Color:Va.color}))}SJe(Va){this.va.raiseEvent("OnSpecialKey",new qa.a({["Key"]:Va.keyCode,["ShiftKey"]:Va.shiftKey}))}Qlh(){this.KF(new H(22))}Fig(Va,Za){this.KF(Object.assign(new aa,{SlideIndex:Va,TimeLineMappings:Za}))}refreshPodSession(Va,
Za){this.KF(Object.assign(new Ea,{PodSessionId:Va,WacCluster:Za}))}setVisibility(Va){this.hb.style.visibility=Va?Ma.a.oz:Ma.a.As}hfa(Va){this.KF(new H(Va?9:10));this.b6a()&&sa.a.instance.hfa(Va)}ABc(Va){this.va.addHandler("OnSlideshowReady",Va)}Oed(Va){this.va.removeHandler("OnSlideshowReady",Va)}BId(Va){this.va.addHandler("OnBrowserEvent",Va)}gGe(Va){this.va.removeHandler("OnBrowserEvent",Va)}dFf(Va){this.va.addHandler("OnFullscreenClick",Va)}ofh(Va){this.va.removeHandler("OnFullscreenClick",Va)}DId(Va){this.va.addHandler("OnSlideshowContextMenu",
Va)}iGe(Va){this.va.removeHandler("OnSlideshowContextMenu",Va)}IId(Va){this.va.addHandler("OnPodSessionExpired",Va)}mGe(Va){this.va.removeHandler("OnPodSessionExpired",Va)}INa(Va){this.va.addHandler("OnPositionChangeEventId",Va)}Dfb(Va){this.va.removeHandler("OnPositionChangeEventId",Va)}sha(Va){this.va.addHandler("OnExit",Va)}Nea(Va){this.va.removeHandler("OnExit",Va)}aFf(Va){this.va.addHandler("OnSlideshowError",Va)}lfh(Va){this.va.removeHandler("OnSlideshowError",Va)}cUb(Va){this.va.addHandler("OnGetCurrentPosition",
Va)}Cfb(Va){this.va.removeHandler("OnGetCurrentPosition",Va)}xBc(Va){this.va.addHandler("OnGetCurrentSlideDimensions",Va)}Med(Va){this.va.removeHandler("OnGetCurrentSlideDimensions",Va)}BBc(Va){this.va.addHandler("OnSpecialKey",Va)}Ped(Va){this.va.removeHandler("OnSpecialKey",Va)}qFf(Va){this.va.addHandler("OnVisibilityChangeEventId",Va)}pGe(Va){this.va.removeHandler("OnVisibilityChangeEventId",Va)}hFf(Va){this.va.addHandler("OnLogEndOfTranscriptionSession",Va)}qfh(Va){this.va.removeHandler("OnLogEndOfTranscriptionSession",
Va)}gFf(Va){this.va.addHandler("OnLiveSubtitlesDockedViewEventId",Va)}pfh(Va){this.va.removeHandler("OnLiveSubtitlesDockedViewEventId",Va)}FId(Va){this.va.addHandler("OnEnterEndOfShowEventId",Va)}jGe(Va){this.va.removeHandler("OnEnterEndOfShowEventId",Va)}HId(Va){this.va.addHandler("OnLeaveEndOfShowEventId",Va)}lGe(Va){this.va.removeHandler("OnLeaveEndOfShowEventId",Va)}oFf(Va){this.va.addHandler("OnSubtitleUpdatedEventId",Va)}xfh(Va){this.va.removeHandler("OnSubtitleUpdatedEventId",Va)}pFf(Va){this.va.addHandler("OnTranscriberStartedEventId",
Va)}yfh(Va){this.va.removeHandler("OnTranscriberStartedEventId",Va)}xFf(Va){this.va.addHandler("RecordQosErrorEventId",Va)}Gfh(Va){this.va.removeHandler("RecordQosErrorEventId",Va)}Yqk(Va){Va=new O(Va.rawEvent);if(this.mSj(Va)){var Za=this.lXk(Va.Qta),Db=Za.EventType;28===Db&&F.a.J(512495840,830,50,"SlideshowFrame.OnSlideshowMessage: Receive message event: {0}",Va.Qta);switch(Db){case 23:this.b9c(Za);break;case 18:this.Pdb(Za);break;case 6:this.fpk();break;case 11:this.I2g(!1,Za);break;case 13:this.I2g(!0,
Za);break;case 2:this.nea(Za);break;case 7:this.Lva(Za);break;case 12:this.Vva(Za);break;case 24:this.Xqk(Za);break;case 26:this.UWa(Za);break;case 27:this.a$c(Za);break;case 29:this.C9c(Za);break;case 5:this.c$c(Za);break;case 30:this.krk(Za);break;case 32:this.J$c(Za);break;case 31:this.B9c(Za);break;case 19:this.Z8c(Za);break;case 20:this.y9c(Za);break;case 33:this.$dd(Za)}}}mSj(Va){try{if(Va.FRg!==this.hb.contentWindow)return F.a.J(512495839,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Invalid message source or origin: {0}",
Va.FRg.location.href),!1}catch(Za){return F.a.J(512495838,830,50,"SlideshowFrame.IsValidSlideshowEventSourceAndOrigin: Exception at checking event source/origin: {0}",Za.toString()),!1}return!0}lXk(Va){try{return Sys.Serialization.JavaScriptSerializer.deserialize(Va)}catch(Za){let Db=Za.toString();I.a("DisableLogPostMsgData")&&(Va="<redacted>");I.a("DisableLogPostMsgEx")&&(Db="<redacted>");F.a.J(512495837,830,15,"SlideshowFrame.RetrieveMsgEventData: Exception at deserializing event data: {0}.  Exception: {1}",
Va,Db)}return{}}fpk(){if(this.la.Jbd&&this.JRg&&!this.ese)try{const Va=(new Date).getTime();sa.a.instance.init(this.la,this.hb.contentDocument.body,this.Fc,this,this.Bl,this.Rb,this.IN);this.ese=!0;F.a.J(512495836,833,50,"SlideshowFrame.OnPresentationOpenedHandler: SpeechClient initialized successfully! TimeUsed: {0} ms",(new Date).getTime()-Va)}catch(Va){F.a.J(512495835,830,10,"SlideshowFrame.OnPresentationOpenedHandler: Exception thrown: {0}.",Va.toString())}F.a.J(512495834,830,50,"SlideshowFrame.OnPresentationOpenedHandler");
this.va.raiseEvent("OnSlideshowReady",new Sys.EventArgs)}Pdb(Va){this.va.raiseEvent("OnBrowserEvent",new T.a(Va))}b9c(Va){F.a.J(512495833,830,50,"SlideshowFrame.OnExitSlideshowHandler");F.a.J(512495832,830,50,"SlideShowFrame: Making frame invisible");this.hb.style.display=Ma.a.Cf;this.va.raiseEvent("OnExit",new K.a(Va))}nea(Va){F.a.J(512495831,830,50,"SlideshowFrame.OnGetCurrentPositionHandler");this.va.raiseEvent("OnGetCurrentPosition",new X.a(Va))}Lva(Va){F.a.J(512495830,830,50,"SlideshowFrame.OnGetCurrentSlideDimensionsHandler");
this.va.raiseEvent("OnGetCurrentSlideDimensions",new P.a(Va))}I2g(Va,Za){this.va.raiseEvent("OnSlideshowError",new Z(Va,Za))}Vva(Va){Va=new qa.a(Va);F.a.J(512495829,830,50,"SlideshowFrame.OnSpecialKeyHandler: Key={0}",Va.key);this.va.raiseEvent("OnSpecialKey",Va)}Xqk(Va){F.a.J(512495828,830,50,"SlideshowFrame.OnSlideshowContextMenuHandler");this.va.raiseEvent("OnSlideshowContextMenu",new pa.a(Va))}UWa(Va){F.a.J(512495827,830,50,"SlideshowFrame.OnVisibilityChangeHandler");this.va.raiseEvent("OnVisibilityChangeEventId",
new Da.a(Va))}a$c(Va){F.a.J(512495826,830,50,"SlideshowFrame.OnPodSessionExpiredHandler");this.va.raiseEvent("OnPodSessionExpired",new ja.a(Va))}C9c(Va){F.a.J(512495825,830,50,"SlideshowFrame.OnLogEndOfTranscriptionSessionHandler");this.va.raiseEvent("OnLogEndOfTranscriptionSession",new ia(Va));this.Fc.isb=!1}c$c(Va){F.a.J(512495824,830,50,"SlideshowFrame.OnPositionChangedHandler");this.va.raiseEvent("OnPositionChangeEventId",new C.a(Va))}krk(Va){F.a.J(512495823,830,50,"SlideshowFrame.OnSubtitleUpdatedHandler");
this.va.raiseEvent("OnSubtitleUpdatedEventId",new ya(Va))}J$c(Va){F.a.J(512495822,830,50,"SlideshowFrame.OnTranscriberStartedHandler");this.va.raiseEvent("OnTranscriberStartedEventId",new Ka.a(Va));this.Fc.isb=!0}hfc(){this.restoreFocus()}B9c(Va){F.a.J(512495821,830,50,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler");try{const Za=new ea(Va);this.HIc(Za.i6b,Za.Fv);this.va.raiseEvent("OnLiveSubtitlesDockedViewEventId",Za)}catch(Za){F.a.J(512495820,830,15,"SlideshowFrame.OnLiveSubtitlesDockedViewHandler threw exception: {0}.",
Za.toString())}}Z8c(){F.a.J(512495819,830,50,"SlideshowFrame.OnEnterEndOfShowHandler");this.va.raiseEvent("OnEnterEndOfShowEventId",Sys.EventArgs.Empty)}y9c(){F.a.J(512495818,830,50,"SlideshowFrame.OnLeaveEndOfShowHandler");this.va.raiseEvent("OnLeaveEndOfShowEventId",Sys.EventArgs.Empty)}$dd(Va){F.a.J(512495817,830,50,"SlideshowFrame.RecordQosErrorHandler");this.va.raiseEvent("RecordQosErrorEventId",new la(Va))}KF(Va){this.hb&&this.hb.contentWindow&&this.hb.contentWindow.postMessage(Sys.Serialization.JavaScriptSerializer.serialize(Va),
"*")}a_g(){var Va=0,Za=100;this.iFa.i6b&&("BelowSlide"===this.iFa.Fv?(Va=0,Za=85):"AboveSlide"===this.iFa.Fv&&(Va=15,Za=85));Va=Va.toString()+"%";Za=Za.toString()+"%";this.iFa.Pwg&&(Va=String.format("calc({0} + {1})",Va,"26px"),Za=String.format("calc({0} - {1})",Za,"26px"));this.KF(Object.assign(new L,{TopValue:Va,HeightValue:Za}))}Fjj(){const Va={};Va.AnimTranstionMinDurationMs=v.AFrameworkApplication.fa.Cc("PodSlideShowVetoAnimTranstionMinDurationMs",1E3);Va.AnimTranstionWorstFrameIndex=v.AFrameworkApplication.fa.Cc("PodSlideShowVetoAnimTranstionWorstFrameIndex",
3);Va.AnimTranstionMaxFrameDurationMs=v.AFrameworkApplication.fa.Cc("PodSlideShowVetoAnimTranstionMaxFrameDurationMs",300);Va.AnimTranstionMinFPS=v.AFrameworkApplication.fa.Cc("PodSlideShowVetoAnimTranstionMinFPS",24);Va.NavDurationMs=v.AFrameworkApplication.fa.Cc("PodSlideShowVetoNavDurationMs",1250);Va.SlideShowEUPLThresholdInMs=v.AFrameworkApplication.fa.Cc("SlideShowEUPLThresholdInMs",6E3);Va.SlideShowNavigationThresholdInMs=v.AFrameworkApplication.fa.Cc("SlideShowNavigationThresholdInMs",1250);
return JSON.stringify(Va)}Lgj(Va,Za,Db,Lb,yb,Bc){const tb=this.la.sAk&&e.a.wg(this.la.pptEditorTranscriberQualityStatusMessageJsUri).endsWith("qualitystatusmessage.js"),Mb={};Mb.WacUserSessionId=Va;Mb.WacUserDatacenterCluster=Za;Mb.PodSessionId=Db;Mb.DocId=Lb;Mb.EntryPoint=yb;Mb.StartTime=Bc;Mb.PodsWebServiceBase=this.la.podsWebServiceBase;Mb.TranscriberLoggingIntervalInMS=this.la.Vpl;Mb.TranscribeRealTimeFactorLowerThreshold=this.la.Rpl;Mb.TranscribeRealTimeFactorUpperThreshold=this.la.Spl;Mb.IsTranscriberLogEachTranscriptMessage=
this.la.wRj;Mb.IsTranscriberContentLoggingEnabled=this.la.tRj;Mb.FUseEndpointInWebapp=this.la.zRj;Mb.CustomEndpointRequestTimeoutInMs=this.la.pptEditorTransriberCustomEndpointRequestTimeoutInMs;Mb.RTLLanguages=this.la.pptEditorTranscribeRTLTranslationLanguages;Mb.HeartbeatInterval=5E3;Mb.RoundtripLatencyThreshold=1E6;Mb.AudioSendingCountIntervalMS=this.la.pptEditorTranscribeAudioSendingCountIntervalMS;Mb.FragmentLatencyWarnThreshold=1E6;Mb.FragmentLatencyErrorThreshold=1E6;Mb.MessageType=this.la.pptEditorTransciberMessageType;
Mb.MaxAllowedFragmentLatencyMS=this.la.Sxk;Mb.DynamicBufferEnabled=this.la.uRj;Mb.DefaultBufferSize=this.la.Upl;Mb.MaxAllowedFinalFragmentLatencyMS=this.la.Rxk;Mb.FSupportSpeechResponseMessage=tb;Mb.IsLiveAgent=this.la.pptEditorTranscriberLiveAgentEnabled&&tb&&e.a.wg(this.la.pptEditorTranscriberAgentCommandMessageJsUri).endsWith("agentcommandmessage.js");Mb.ShouldCreateCustomEndpointWithSession=this.la.pptEditorTranscriberCustomEndpointWithSession;Mb.TranscriberShowListeningDetectionTextInMS=this.la.rAk;
Mb.PodTranscriberAudioContextSampleRate=this.la.Qxk;Mb.RehearsalGrammarIsEnabled=this.la.nBe;Mb.PodRehearsalMonotoneEnabled=this.la.JAe;return JSON.stringify(Mb)}Mgj(){const Va={};Va.Detection_AudioQualityIssue=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Va.Detection_HighBackgroundNoise=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;Va.Detection_HighJitter=ResourceStrings.L_SubtitleDetection_HighJitter;Va.Detection_HighLatency=ResourceStrings.L_SubtitleDetection_HighLatency;Va.Detection_Listening=
ResourceStrings.L_SubtitleDetection_Listening;Va.Detection_MicReady=ResourceStrings.L_SubtitleDetection_MicReady;Va.Detection_NetworkQualityIssue=ResourceStrings.L_SubtitleDetection_NetworkQualityIssue;Va.Detection_NoMicrophone=ResourceStrings.L_SubtitleDetection_NoMicrophone;Va.Detection_SoundReminder=ResourceStrings.L_SubtitleDetection_SoundReminder;Va.Detection_SpeakingTooLoud=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Va.Detection_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;
Va.DetectionText_AudioQualityIssue=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;Va.DetectionText_HighBackgroundNoise=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;Va.DetectionText_HighJitter=ResourceStrings.L_SubtitleDetectionText_HighJitter;Va.DetectionText_HighLatency=ResourceStrings.L_SubtitleDetectionText_HighLatency;Va.DetectionText_NetworkQualityIssue=ResourceStrings.L_SubtitleDetectionText_NetworkQualityIssue;Va.DetectionText_SpeakingTooLoud=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;
Va.DetectionText_SpeakingTooQuiet=ResourceStrings.L_SubtitleDetectionText_SpeakingTooQuiet;Va.Accessibility_Content=ResourceStrings.L_SubtitleAccessibilityContent;Va.Accessibility_Window=ResourceStrings.L_SubtitleAccessibilityWindow;Va.InitialMessage=ResourceStrings.L_SubtitleInitMessage;Va.GenericErrorMessage=ResourceStrings.L_SubtitleGenericErrorMessage;Va.RetryErrorMessage=ResourceStrings.L_SubtitleRetryErrorMessage;Va.ErrorAudioDevice=ResourceStrings.L_SubtitleAudioDeviceErrorMessage;Va.GenericRetryErrorMessage=
ResourceStrings.L_SpeechGenericRetryErrorMessage;Va.GenericNetworkErrorMessage=ResourceStrings.L_SpeechGenericNetworkErrorMessage;return JSON.stringify(Va)}N$d(){return!!this.Rb&&!!this.Rb.instance&&this.Rb.instance.L3f}}Object(J.a)(Ca,"SlideshowFrame",null,[322])},975:function(J,V,d){J=d(0);var h=d(285),e=d(25),m=d(45),r=d(13),v=d(22),A=d(1166),w=d(33),y=d(26);class u{}u.speechMode="Subtitles";u.pWf=[u.speechMode];u.sourceLanguage=null;u.targetLanguages=null;u.speechFDBase=null;u.podSessionId=null;
u.cGh=null;u.docId=null;u.webServiceBase=null;u.userSessionId=e.AFrameworkApplication.userSessionId;Object(J.a)(u,"PPTSpeechClientConfig",null,[]);var D=d(77);class F{constructor(){this.va=new D.a}onFinalRecognitionText(ea){this.va.raiseEvent("OnFinalRecognitionText",ea)}onPartialRecognitionText(ea){this.va.raiseEvent("OnPartialRecognitionText",ea)}onError(ea){this.va.raiseEvent("OnError",ea)}onSpeechRecognitionStarted(ea){this.va.raiseEvent("OnSpeechRecognitionStarted",ea)}onEventUpdate(ea){this.va.raiseEvent("OnEventUpdate",
ea)}o5h(ea){this.va.addHandler("OnFinalRecognitionText",ea)}iRk(ea){this.va.removeHandler("OnFinalRecognitionText",ea)}l7h(ea){this.va.addHandler("OnPartialRecognitionText",ea)}wSk(ea){this.va.removeHandler("OnPartialRecognitionText",ea)}i5h(ea){this.va.addHandler("OnError",ea)}dRk(ea){this.va.removeHandler("OnError",ea)}i8h(ea){this.va.addHandler("OnSpeechRecognitionStarted",ea)}$Sk(ea){this.va.removeHandler("OnSpeechRecognitionStarted",ea)}k5h(ea){this.va.addHandler("OnEventUpdate",ea)}fRk(ea){this.va.removeHandler("OnEventUpdate",
ea)}}Object(J.a)(F,"PPTSpeechClientObserverController",null,[]);var I=d(376),H=d(386);class L{constructor(){this.accessToken=null}}Object(J.a)(L,"IAuthenticationProvider",null,[]);class E{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(J.a)(E,"IDocumentDownloadConfig",null,[]);class aa{constructor(){this.documentDownloadConfig=this.userSessionId=this.speechFDBase=this.properties=this.targetLanguages=this.sourceLanguage=this.speechMode=null;
this.clientApp=0;this.clientMetaData=null;this.captureAudioPauseResumeRecordingState=this.requestServiceCustomEndpoint=!1;this.microphoneDeviceId=null}}Object(J.a)(aa,"ISpeechConfig",null,[]);class Q{constructor(ea){this.r4=ea}onFinalText(){}onFragmentText(){}onFinalRecognitionText(ea,ia){this.r4.onFinalRecognitionText(ea,ia)}onPartialRecognitionText(ea,ia){this.r4.onPartialRecognitionText(ea,ia)}onError(ea){if("ErrorNone"!==ea)switch(ea){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.r4.onError("AccessDenied");
break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":case "ErrorConnectionRetryFailure":this.r4.onError("FailedToConnect");break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.r4.onError("Timeout");break;case "ErrorInitialSilenceTimeout":this.r4.onError("InitialSilenceTimeout");break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.r4.onError("UnknownError");
break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.r4.onError("MicrophoneError");break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":this.r4.onError("NotAllowedError");break;case "ErrorAudioNotFoundError":this.r4.onError("NotFoundError");break;case "ErrorAudioNotReadableError":this.r4.onError("NotReadableError");break;default:this.r4.onError("CustomError-"+ea)}}onSpeechRecognitionStarted(ea){I.ULS.sendTraceTag(594355729,
830,50,"PPTSpeechClientObserver::OnSpeechRecognitionStarted {0}",ea);this.r4.onSpeechRecognitionStarted(ea)}onEventUpdate(ea){this.r4.onEventUpdate(ea)}}Object(J.a)(Q,"PPTSpeechClientObserver",null,[456]);class O{constructor(ea){this.B9=null;this.LGa=0;this.microphoneDeviceId="";this.dak=new Q(ea)}gQj(){return 2===this.LGa}KAj(){const ea=this.TQd(),ia=Object.assign(new L,{accessToken:""});this.B9&&0!==this.LGa&&(this.B9.stopSpeechRecognition(),this.LGa=0);this.B9=(new PPTSpeechClient.SpeechClientFactory).createSpeechClient(ea,
this.dak,ia,null,new H.a);return this.B9?!0:(I.ULS.sendTraceTag(594355727,830,10,"Speech client was not successfully created"),!1)}dvh(){this.B9&&(0===this.LGa?(this.B9.startSpeechRecognition(),this.LGa=2):1===this.LGa&&(this.B9.resumeSpeechRecognition(),this.LGa=2))}Fjl(){this.B9&&(this.B9.stopSpeechRecognition(),this.LGa=0)}Owk(){this.B9&&(this.B9.pauseSpeechRecognition(),this.LGa=1)}setCustomSetting(ea,ia){this.B9&&this.B9.setCustomSetting(ea,ia)}TQd(){return Object.assign(new aa,{speechMode:u.speechMode,
sourceLanguage:u.sourceLanguage,targetLanguages:u.targetLanguages,speechFDBase:u.speechFDBase,captureAudioPauseResumeRecordingState:!0,clientApp:0,documentDownloadConfig:Object.assign(new E,{docId:u.docId,podsSessionId:u.podSessionId,userDataCenterClusterId:u.cGh,webServiceBase:u.webServiceBase}),userSessionId:u.userSessionId,microphoneDeviceId:this.microphoneDeviceId})}}Object(J.a)(O,"PPTSpeechClientProxy",null,[]);var T;(function(ea){ea[ea.none=0]="none";ea[ea.singleLineRibbon=1]="singleLineRibbon";
ea[ea.multipleLineRibbon=2]="multipleLineRibbon";ea[ea.slideShowToolbar=3]="slideShowToolbar";ea[ea.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";ea[ea.liveBroadcast=5]="liveBroadcast"})(T||(T={}));Object(J.b)("TranscriptionEntryPoint",T);var K=d(663),X=d(69);d.d(V,"a",function(){return P});class P{constructor(){this.gf=this.D9=this.uC=this.Ncb=this.Er=this.hb=this.la=this.Rb=this.Fc=null;this.Czb=!1;this.Bl=null;this.Xcb=this.Hcc=0;this.pLg=!1;this.PGa=this.OGa="";this.u_c=!1;this.nse=
"";this.Ehe=0;this.bzb=this.F9=this.bCb="";this.IN=null;this.iva={};this.hla=new F;this.p9=new O(this.hla);P.OAj()}init(ea,ia,ja,C,pa,Z,qa){y.a.J(512495707,830,50,"SlideshowSubtitles.Init");this.gf=ia;this.la=ea;this.Fc=ja;this.hb=C;this.Bl=pa;this.Rb=Z;this.IN=qa;this.Er=document.createElement("div");this.Er.id="SubtitleContainer";this.Er.className="SubtitleContainer";this.Er.style.display=X.a.Cf;this.Er.style.visibility=X.a.As;this.Ncb=document.createElement("div");this.Ncb.id="SubtitleResultDiv";
this.Ncb.className="SubtitleResultDiv";this.Fc.YQi&&(this.Ncb.style.direction="rtl");this.uC=document.createElement("span");this.uC.id="SubtitleResultSpan";this.uC.className="SubtitleResultSpan";this.uC.setAttribute("aria-hidden","true");this.D9=document.createElement("span");this.D9.id="SubtitleAccessibilitySpan";this.D9.className="SubtitleAccessibilitySpan";this.D9.innerText="";this.D9.setAttribute("lang",this.Fc.bya);this.D9.setAttribute("aria-live","assertive");this.D9.setAttribute("aria-label",
ResourceStrings.L_SubtitleAccessibilityWindow);this.D9.setAttribute("aria-atomic","true");this.Ncb.appendChild(this.uC);this.Ncb.appendChild(this.D9);this.Er.appendChild(this.Ncb);this.gf.appendChild(this.Er);h.a.instance.ob(this.uC,()=>!1);e.AFrameworkApplication.fa.Eca?this.Gm():e.AFrameworkApplication.fa.ff(Object(r.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){this.bCb=this.getUserId();this.F9=e.AFrameworkApplication.fa.Ga("TenantId");this.bzb=this.la.hostAuthType||e.AFrameworkApplication.fa.Ga("HostAuthType")||
"Unknown"}getUserId(){let ea=e.AFrameworkApplication.fa.Ga("PptEditingUserId");m.a.Va(ea)&&(ea=e.AFrameworkApplication.fa.Ga("LoggableUserId"),y.a.J(512495706,822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",m.a.Va(ea)));return ea}KQk(){this.Er.style.display=X.a.Cf;this.Er.style.visibility=X.a.As}transcribe(ea,ia,ja,C,pa,Z){this.Swb()&&(this.Bl.instance.show(ResourceStrings.L_SubtitleDetection_SoundReminder,K.a.e8c),this.Hcc=window.setTimeout(Object(r.a)(this,this.H6d,
"hideSoundReminderNotification"),3E3));this.Bxl(ia,ja,C,this.Fc);this.p9&&(this.p9.microphoneDeviceId=this.IN.microphoneDeviceId);this.Fc.Kh&&this.p9.KAj()?(this.iva.StartTime=Z,this.iva.LastError="ErrorNone",this.iva.EntryPoint=T[pa],this.hla.o5h(Object(r.a)(this,this.I_g,"onFinalRecognitionTextHandler")),this.hla.l7h(Object(r.a)(this,this.k1g,"onPartialRecognitionTextHandler")),this.hla.i5h(Object(r.a)(this,this.Q2g,"onSpeechProxyErrorHandler")),this.hla.k5h(Object(r.a)(this,this.R2g,"onSpeechProxyEventUpdateHandler")),
this.hla.i8h(Object(r.a)(this,this.S2g,"onSpeechRecognitionStartedHandler")),this.p9.dvh(),this.p9.setCustomSetting("clientMetadata",JSON.stringify(this.T$f())),this.uC.innerText="["+ResourceStrings.L_SubtitleInitMessage+"]",this.uC.style.color="rgba( 255, 255, 0, 1 )",this.setVisibility(5!==pa),this.RBc(),this.hb.xBc(Object(r.a)(this,this.Lva,"onGetCurrentSlideDimensionsHandler")),this.hb.INa(Object(r.a)(this,this.s$c,"onSlideChangedHandler"))):this.WPe()}T$f(ea=""){const ia=w.b(e.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
ja={};ja.userID=this.bCb;ja.tenantId=this.F9;ja.identityProvider=this.bzb;ja.audienceChannel="";ja.audienceGroup=ia.Ring||"Unknown";ja.buildVersion=e.AFrameworkApplication.buildVersion||"Unknown";ja.locale=this.la.UHa||"Unknown";ja.wacHost=ia.Host||"Unknown";ja.wacDatacenter=ia.WACDatacenter||"Unknown";ja.livePragueSessionInfo=ea;return ja}WPe(){this.Er.style.display=X.a.Cf;this.Er.style.visibility=X.a.As;this.p9.Fjl();this.hla.iRk(Object(r.a)(this,this.I_g,"onFinalRecognitionTextHandler"));this.hla.wSk(Object(r.a)(this,
this.k1g,"onPartialRecognitionTextHandler"));this.hla.dRk(Object(r.a)(this,this.Q2g,"onSpeechProxyErrorHandler"));this.hla.fRk(Object(r.a)(this,this.R2g,"onSpeechProxyEventUpdateHandler"));this.hla.$Sk(Object(r.a)(this,this.S2g,"onSpeechRecognitionStartedHandler"));this.hb.Med(Object(r.a)(this,this.Lva,"onGetCurrentSlideDimensionsHandler"));this.hb.Dfb(Object(r.a)(this,this.s$c,"onSlideChangedHandler"));this.Swb()&&this.Bl.instance.hide();this.iva.EndTime=Date.now();y.a.J(512495705,817,15,JSON.stringify(this.iva,
P.Otl));this.iva={};this.Fc.isb=!1}RBc(){let ea=3;this.iva.LastPosition=this.Fc.Fv;"AboveSlide"===this.Fc.Fv&&this.Er.style.visibility===X.a.oz?(this.Er.style.display=X.a.Dxa,this.Er.style.backgroundColor="black",this.Er.style.bottom="auto"):"BelowSlide"===this.Fc.Fv&&this.Er.style.visibility===X.a.oz?(this.Er.style.display=X.a.Dxa,this.Er.style.backgroundColor="black",this.Er.style.bottom="3%",ea=-1):"TopOverlay"===this.Fc.Fv?(this.Er.style.display=X.a.Dxa,this.Er.style.backgroundColor="transparent",
this.Er.style.bottom="auto",ea=5):"BottomOverlay"===this.Fc.Fv&&(this.Er.style.display=X.a.Dxa,this.Er.style.backgroundColor="transparent",this.Er.style.bottom="5%",ea=-1);this.Czb&&document.getElementById("LiveURLBarLayerHost")?this.Er.style.top=-1<ea?String.format("calc({0}% + {1})",ea.toString(),"26px"):"auto":(this.Er.style.top=-1<ea?ea.toString()+"%":"auto",this.iGf())}isVisible(){return this.Er.style.visibility===X.a.oz}Tyh(ea,ia=""){u.pWf=ea?["Live","Subtitles"]:["Subtitles"];this.Czb=ea;this.setVisibility(this.Er.style.visibility===
X.a.oz);this.RBc();this.p9.setCustomSetting("clientMetadata",JSON.stringify(this.T$f(ia)));this.p9.setCustomSetting("slideIndex",this.Ehe);this.p9.setCustomSetting("currentSpeechModes",JSON.stringify(u.pWf))}hfa(ea){this.Er.style.cursor=ea?"default":"none"}iGf(){this.uC.style.fontSize=Math.floor(this.Er.clientHeight/2/1.5).toString()+"px";this.nse=Math.floor(this.Er.clientHeight/12-2)+"px";this.uC.style.display="inline"}setVisibility(ea){this.Er?(null===ea&&(ea=this.Er.style.visibility===X.a.As),
this.Er.style.visibility=ea?X.a.oz:X.a.As):y.a.J(509703457,817,50,"SlideshowSubtitles::setVisibility SubtitleContainer is null")}Lva(){this.iGf()}s$c(ea,ia){this.Ehe=ia.slideIndex;this.p9.gQj()&&this.Czb&&(this.p9.setCustomSetting("currentSlideIndex",this.Ehe),y.a.J(512495704,817,50,"SlideshowSubtitles::OnSlideChangedHandler Updated current slide index for live"))}setMicrophoneState(ea){ea?(this.p9.Owk(),this.Sjc(),this.u_c=!0,this.Rb&&this.Rb.instance&&this.Rb.instance.ynh()):(this.p9.dvh(),this.Rb&&
this.Rb.instance&&this.Rb.instance.znh())}H6d(){this.Swb()&&(window.clearTimeout(this.Hcc),this.Bl.instance.hide())}Bxl(ea,ia,ja,C){u.sourceLanguage=C.yna;u.targetLanguages=C.Eib;u.podSessionId=ea;u.cGh=ia;u.docId=ja;u.webServiceBase=this.la.podsWebServiceBase;u.speechFDBase=e.AFrameworkApplication.fa.Ga("715");ea=!!this.Rb&&!!this.Rb.instance&&(this.Rb.instance.bQa||this.Rb.instance.Rq);u.speechMode=this.Rb&&this.Rb.instance&&this.Rb.instance.lr&&this.Rb.instance.$Ba||ea?"Live":"Subtitles"}GZf(ea,
ia){this.pLg||(this.uC.style.color="rgba( 255, 255, 255, 1 )",window.clearTimeout(this.Xcb),this.uC.innerText=this.Dij(ea,ia),this.uC.scrollTop=this.uC.scrollHeight,this.Xcb=window.setTimeout(Object(r.a)(this,this.Sjc,"resetSubtitlesToEmpty"),1E4),ia&&(this.D9.innerText=ea,this.D9.focus()),this.uC.style.padding=m.a.Va(ea)?"0px":this.nse)}Zu(ea){this.pLg||(this.uC.style.color="rgba( 255, 255, 0, 1 )",m.a.Va(ea)&&(ea=ResourceStrings.L_SubtitleGenericErrorMessage),window.clearTimeout(this.Xcb),this.uC.innerText=
"["+ea+"]",this.uC.scrollTop=this.uC.scrollHeight,this.Xcb=window.setTimeout(Object(r.a)(this,this.Sjc,"resetSubtitlesToEmpty"),1E4),this.uC.style.padding=this.nse,this.D9.innerText="",this.D9.focus())}Hrj(ea){if(null!==ea)switch(ea){case "NotAllowedError":case "NotFoundError":case "NotReadableError":case "MicrophoneError":this.Zu(ResourceStrings.L_SubtitleAudioDeviceErrorMessage);this.iva.LastError="MicrophoneError";break;case "FailedToConnect":this.Zu(ResourceStrings.L_SubtitleRetryErrorMessage);
this.iva.LastError="FailedToConnect";break;case "AccessDenied":case "UnknownError":case "Timeout":this.Zu(ResourceStrings.L_SubtitleGenericErrorMessage);this.iva.LastError="FailedToCreateSpeechSession";break;default:y.a.J(512495703,830,15,"HandleSpeechProxyError {0}",ea)}}I_g(ea,ia){this.Er.style.visibility!==X.a.As&&this.GZf(ia[this.Fc.Eib],!0)}k1g(ea,ia){this.Er.style.visibility!==X.a.As&&this.GZf(ia[this.Fc.Eib],!1)}Q2g(ea,ia){y.a.J(512495702,830,10,"OnSpeechProxyErrorHandler {0}",ia);(ea=ia.toString())&&
(-1<ea.indexOf("NotAllowedError")||-1<ea.indexOf("NotFoundError")||-1<ea.indexOf("NotReadableError")||-1<ea.indexOf("MicrophoneError"))&&this.Swb()&&this.Bl.instance.show(ResourceStrings.L_SubtitleDetection_NoMicrophone,K.a.zWa);this.Hrj(ea)}S2g(ea,ia){({SlideShowCoreFrame:ea}=d(697));const {SlideshowFrame:ja}=d(973);y.a.J(512495701,830,50,"OnSpeechRecognitionStartedHandler {0}",ia.toString());Object(v.a)(ea,this.hb)?Object(A.a)(ea,this.hb).J$c(ia.toString()):Object(v.a)(ja,this.hb)&&this.la.Jbd&&
Object(A.a)(ja,this.hb).J$c(ia.toString());this.Sjc();this.Swb()&&this.Bl.instance.hide()}R2g(ea,ia){if(this.Swb())switch(ea=ia.eventName,ea){case "MediaEvent":"AudioDeviceConnected"===ia.mediaStatus&&this.Bl.instance.show(ResourceStrings.L_SubtitleDetection_MicReady,K.a.e8c);break;case "ConnectionRetry":this.Bl.instance.show(ResourceStrings.L_SpeechGenericRetryErrorMessage,K.a.zWa);this.Zu(ResourceStrings.L_SubtitleGenericErrorMessage);break;case "QualityStatusUpdate":const ja=ia.shortCode;ea=ia.longCode;
const C=ia.shortString,pa=ia.longString;switch(ia.severity){case 0:this.Bl.instance.hide();break;case 1:(ia=0<ja?P.OX[ja]:C)&&this.Bl.instance.show(ia,K.a.bDb);break;case 2:(ia=0<ja?P.OX[ja]:C)&&this.Bl.instance.show(ia,K.a.zWa),ia=null===ea?pa:P.OX[ea],m.a.Va(ia)||(window.clearTimeout(this.Xcb),this.Zu(ia),this.Xcb=window.setTimeout(Object(r.a)(this,this.Sjc,"resetSubtitlesToEmpty"),3E4))}break;default:y.a.J(512495700,830,50,"OnSpeechProxyEventUpdateHandler Event {0}",ea)}}Swb(){return this.la.pptEditorVoiceUXEnabled&&
!!this.Bl&&!!this.Bl.instance}Sjc(){this.uC.style.color="rgba( 255, 255, 255, 1 )";this.uC.innerText="";this.uC.scrollTop=this.uC.scrollHeight;this.PGa=this.OGa="";this.u_c=!1;this.Xcb=0;this.uC.style.padding="0px"}Dij(ea,ia){this.u_c?this.fai(ea):this.dUk(ea);this.u_c=ia;return m.a.Va(this.OGa)||m.a.Va(this.PGa)?m.a.Va(this.OGa)?this.PGa:this.OGa:this.OGa+"\n"+this.PGa}fai(ea){this.OGa=m.a.Va(this.PGa)?this.OGa:this.PGa;this.PGa=ea}dUk(ea){m.a.Va(this.OGa)||m.a.Va(this.PGa)?this.OGa=ea:this.PGa=
ea}static get instance(){return P.Dp}static OAj(){P.OX[1]=ResourceStrings.L_SubtitleDetection_Listening;P.OX[2]=ResourceStrings.L_SubtitleDetectionText_AudioQualityIssue;P.OX[3]=ResourceStrings.L_SubtitleDetectionText_HighBackgroundNoise;P.OX[4]=ResourceStrings.L_SubtitleDetectionText_SpeakingTooLoud;P.OX[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet}static Otl(ea,ia){return"undefined"===typeof ia?null:ia}}P.OX=Array(20);P.Dp=new P;Object(J.a)(P,"SlideshowSubtitles",null,[403])},977:function(J,
V,d){J=d(0);var h=d(25),e=d(54),m=d(55),r=d(268),v=d(307);class A{constructor(Ya,ua=null){this.eTh=Ya;this.UR=ua||v.a.r0d(e.a.Z3a,"")}get Au(){return this.eTh}get Ib(){return this.UR}UKe(Ya){this.Ib.d++;return this.Au.UKe(Ya)}MHb(Ya){this.Ib.e++;return this.Au.MHb(Ya)}xJ(Ya){this.Ib.f++;return this.Au.xJ(Ya)}yYa(Ya){this.Ib.h++;return this.Au.yYa(Ya)}E0(Ya){this.Ib.i++;return this.Au.E0(Ya)}cY(Ya){this.Ib.j++;return this.Au.cY(Ya)}k5(Ya){this.Ib.k++;return this.Au.k5(Ya)}eY(Ya){this.Ib.l++;return this.Au.eY(Ya)}KKe(Ya){this.Ib.m++;
return this.Au.KKe(Ya)}XIa(Ya,ua=!1){this.Ib.n++;return this.Au.XIa(Ya,ua)}W4d(){this.Ib.o++;return this.Au.W4d()}POe(){this.Ib.p++;return this.Au.POe()}aHb(Ya){this.Ib.m++;return this.Au.aHb(Ya)}gt(Ya){this.Ib.q++;return this.Au.gt(Ya)}lna(Ya){this.Ib.r++;return this.Au.lna(Ya)}tHb(Ya){this.Ib.g++;return this.Au.tHb(Ya)}iid(Ya){return this.Au.iid(Ya)}EYa(Ya){this.Ib.s++;return this.Au.EYa(Ya)}Nhd(Ya){this.Ib.s++;return this.Au.Nhd(Ya)}dfa(Ya){this.Ib.s++;return this.Au.dfa(Ya)}DYa(Ya){this.Ib.s++;
return this.Au.DYa(Ya)}Zgb(Ya){this.Ib.t++;return this.Au.Zgb(Ya)}jid(Ya){this.Ib.u++;return this.Au.jid(Ya)}alc(Ya){this.Ib.v++;return this.Au.alc(Ya)}ona(Ya){return this.Au.ona(Ya)}nhd(Ya){this.Ib.z++;return this.Au.nhd(Ya)}tHe(){return this.Au.tHe()}cJa(Ya,ua){this.Ib.w++;this.Ib.x++;return this.Au.cJa(Ya,ua)}C0(Ya){this.Ib.y++;return this.Au.C0(Ya)}clearFormatting(){return this.Au.clearFormatting()}clone(){return new A(this.Au.clone(),this.Ib)}}Object(J.a)(A,"FormattingStewardUsageCollector",
null,[478]);class w extends A{constructor(Ya,ua=null){super(Ya,ua)}get I4(){return this.Au}get JD(){return this.I4.JD}set JD(Ya){this.I4.JD=Ya}get textIndent(){return this.I4.textIndent}get marginLeft(){return this.I4.marginLeft}get had(){return this.I4.had}get lineSpacing(){return this.I4.lineSpacing}get lfa(){return this.I4.lfa}get gXc(){return this.I4.gXc}get yea(){return this.I4.yea}get paragraph(){return this.I4.paragraph}set paragraph(Ya){this.I4.paragraph=Ya}get z6a(){return this.I4.z6a}Imd(Ya){return this.I4.Imd(Ya)}BTe(Ya){return this.I4.BTe(Ya)}clone(){const Ya=
this.Au.clone();return new w(Ya,this.Ib)}}Object(J.a)(w,"FormattingStewardUsageCollector",A,[477,478]);var y=d(31),u=d(74),D=d(191),F=d(662),I=d(51),H=d(144),L=d(71),E=d(56),aa=d(342),Q=d(1064),O=d(330),T=d(45),K=d(1174),X=d(1169),P=d(1168),ea=d(110),ia=d(36),ja=d(79),C=d(40),pa=d(34),Z=d(86),qa=d(303);class ya{}ya.yellow="FFFF00";ya.lime="00FF00";ya.aqua="00FFFF";ya.fuchsia="FF00FF";ya.blue="0000FF";ya.red="FF0000";ya.navy="000080";ya.teal="008080";ya.green="008000";ya.purple="800080";ya.maroon=
"800000";ya.olive="808000";ya.gray="808080";ya.Ugl="C0C0C0";ya.black="000000";Object(J.a)(ya,"FontHighlightColorEnum",null,[]);var Ka=d(333),Da=d(49),la=d(868),ma=d(363),Ea=d(114);class ta{constructor(Ya,ua,Ma,Ca,Va,Za,Db,Lb,yb=null,Bc=!1){this.Iv=this.Qwc=null;this.NQb=0;this.d_e=this.MQb=null;this.E1=0;this.FMa=this.kzc=this.rvc=this.Tyc=this.p1a=this.Oga=this.Fvc=this.xzc=null;this.eXf=.25*ea.Font.$H;this.paragraph=Ya;this.Hf=ua;this.iK=Ma;this.ZO=Ca;this.kga=Va;this.aV=Za;this.LY=Db;this.y0a=
Lb;yb?(Ea.a(4223818,307,!!yb.Iv),this.Iv=yb.Iv.YEc(this.paragraph),this.NQb=yb.NQb,this.MQb=yb.MQb,yb.Oga&&(this.Oga=new la.a,this.Oga.afterSpacing.value=yb.Oga.afterSpacing.value,this.Oga.beforeSpacing.value=yb.Oga.beforeSpacing.value),yb.p1a&&(this.p1a=yb.p1a.clone()),this.E1=yb.E1,this.kzc=yb.kzc.clone(),this.xzc=yb.xzc,this.Fvc=yb.Fvc,this.Tyc=yb.Tyc,this.rvc=yb.rvc,yb.yea&&(this.FMa=yb.yea)):(this.Iv=new qa.a(this.paragraph,0),this.Iv.formatting=new Ka.a(this.Iv,aa.a.nil),ua=Da.a.QOa(Ya),ua=
this.ZO.Ls(ua),this.D3k(ua),ta.zcl(Ya)?(this.kga.NKe(this.Iv.formatting,ua,Bc),this.E1=Ya.Sa(ia.a.xl)?Ya.getValue(ia.a.xl):0):this.E1=-1,this.NQb=0,this.MQb=null,this.Oga=this.E3i(),this.y0a&&(this.Oga=this.kga.YV(Ya),this.p1a=this.kga.X0d(Ya),this.Tyc=this.kga.hRa(Ya),this.rvc=this.kga.I7(Ya)),this.kzc=new Q.DictionaryPropertySet,this.kga.yKe(this.Iv.formatting,Ya,Bc))}get paragraph(){return this.Qwc}set paragraph(Ya){Ea.a(4223816,307,!!Ya&&y.ParagraphReader.Vd(Ya));this.Qwc=Ya}get z6a(){return this.Iv.formatting}get Qfc(){return this.NQb}get g5g(){return this.MQb}get e2(){return this.d_e}get JD(){return this.E1}set JD(Ya){Ea.a(4223817,
307,1===Ya||2===Ya||3===Ya||pa.a.instance.ga(54)&&6===Ya);this.E1=Ya}get textIndent(){return this.xzc}get marginLeft(){return this.Fvc}get had(){return this.Oga}get lineSpacing(){return this.p1a}get lfa(){return this.Tyc}get gXc(){return this.rvc}get yea(){return this.FMa}D3k(Ya){const ua=this.ZO.language(Ya);ua&&this.Hf.Zkc(this.Iv.formatting,ua,0,Ya.cache.HSa,!1)}E3i(){if(pa.a.instance.ga(54))return null;const Ya=new la.a;Ya.afterSpacing.value=this.eXf;Ya.beforeSpacing.value=this.eXf;return Ya}UKe(Ya){(Ya=
r.a.oe(Ya))&&this.Hf.zYa(this.Iv.formatting,Ya.LCID);return!0}MHb(){return!1}xJ(Ya){this.Hf.xJ(this.Iv.formatting,Ya);return!0}yYa(Ya){this.Hf.setItalic(this.Iv.formatting,Ya);return!0}E0(Ya){this.Hf.E0(this.Iv.formatting,Ya);return!0}cY(Ya){this.Hf.cY(this.Iv.formatting,Ya);return!0}k5(Ya){this.Hf.k5(this.Iv.formatting,Ya);return!0}eY(Ya){this.Hf.eY(this.Iv.formatting,Ya);return!0}KKe(Ya){if(0>=Ya)return!1;this.Hf.Jr(this.Iv.formatting,Ya);return!0}XIa(Ya,ua){if(!Ya||""===Ya)return!1;if(({fontInfo:Ma}=
O.FontUtils.etl(Ya)).returnValue)return this.Hf.ZX(this.Iv.formatting,Ma.fontName),!0;var Ma=!1;const Ca=O.FontUtils.HF(Ya);ua&&this.MVc(Ca,this.aV)&&(this.aV.createFontUrl(Ya),Ma=!0);this.MVc(Ca,this.LY)&&(Ma=!0);Ma&&this.Hf.ZX(this.Iv.formatting,Ca);return Ma}MVc(Ya,ua){return!!ua&&ua.isEnabled&&ua.MVc(Ya)}W4d(){this.Hf.hQc(this.Iv.formatting);return!0}POe(){this.Hf.Mjd(this.Iv.formatting);return!0}aHb(Ya){if(0>=Ya)return!1;this.Hf.aHb(this.Iv.formatting,Ya);return!0}gt(Ya){var {Box4PasteSteward:ua}=
d(247);if(!this.Hf.Vyg(Ya)){if(null===Ya||""===Ya)return!1;Ya=ua.Q4a(Ya)}ua=null;this.yea&&this.yea.hasOwnProperty(C.a.listLevel.id.toString())&&(ua=this.yea[C.a.listLevel.id.toString()]);this.Hf.gt(this.Iv.formatting,Ya,ua);return!0}lna(Ya){const {Box4PasteSteward:ua}=d(247);if(!Ya||""===Ya||pa.a.instance.ga(49)&&!ta.Hkj().contains(Ya)||this.kga.urh(this.Iv.formatting))return!1;this.Hf.lna(this.Iv.formatting,ua.Q4a(Ya));return!0}tHb(Ya){this.Hf.tHb(this.Iv.formatting,Ya);return!0}iid(Ya){let ua=
0;switch(T.a.wg(Ya)){case "small-caps":ua=1;break;case "uppercase":ua=2}this.Hf.um(this.Iv.formatting,ja.a.capitalization,ua);return!0}nhd(Ya){const {Box4PasteSteward:ua}=d(247);if(!Ya||""===Ya)return!1;this.kzc.setValue(ia.a.iEc,parseInt(ua.Q4a(Ya),16));return!0}DYa(Ya){return 0>=Ya?!1:this.Nhd(Z.StyleReader.Agj(Ya))}EYa(Ya){this.clearFormatting();this.NQb=Ya;return!0}Nhd(Ya){const {Box4PasteSteward:ua}=d(247);return Ya&&0<Ya.length&&ua.bJb&&ua.bJb.DG(Ya)?(this.MQb=Ya,!0):!1}dfa(Ya){const {Box4PasteSteward:ua}=
d(247);return Ya&&0<Ya.length&&ua.bJb&&ua.bJb.DG(Ya)?(this.d_e=Ya,!0):!1}BTe(Ya){if(this.e2){Ya=d(247).Box4PasteSteward.bJb||Z.StyleReader.MK(Ya);if(!Ya)return Ea.a(41968715,307,!1),!1;(Ya=Ya.DG(this.e2))&&this.Hf.dfa(this.Iv.formatting,Ya);return!0}return!1}cJa(Ya,ua){if(pa.a.instance.ga(54))return!1;Ea.a(5297416,307,0<=Ya&&0<=ua);0<=Ya&&(this.Oga.beforeSpacing.value=Ya);0<=ua&&(this.Oga.afterSpacing.value=ua);return 0<=Ya||0<=ua}C0(Ya){if(!pa.a.instance.ga(54)||!Ya)return!1;const ua=parseFloat(T.a.substring(Ya,
0,T.a.wg(Ya).indexOf("px")));if(!isNaN(ua))return this.p1a=new ma.a(3,K.a.Cea(ua,1)),!0;Ya=parseFloat(T.a.substring(Ya,0,T.a.wg(Ya).indexOf("%")));return isNaN(Ya)?!1:(this.p1a=new ma.a(2,Ya/100),!0)}Zgb(Ya){let ua=0;if(!Ya||""===Ya)return!1;switch(Ya){case "left":ua=1;break;case "center":ua=2;break;case "right":ua=3;break;case "justify":pa.a.instance.ga(54)&&(ua=6)}if(0===ua)return!1;this.JD=ua;return!0}jid(Ya){this.xzc=Ya;return!0}alc(Ya){this.Fvc=Ya;return!0}ona(Ya){this.FMa=JSON.parse(Ya);return this.yea?
!0:!1}clearFormatting(){this.Iv.formatting=new Ka.a(this.Iv,aa.a.nil);return!0}tHe(){this.E1=0;return!0}Imd(Ya){var {Box4PasteSteward:ua}=d(247);if(!pa.a.instance.ga(71))return!1;if(0<this.Qfc&&ua.JHa[this.Qfc]){Ea.a(4223819,307,1<=this.Qfc);Ea.a(4223820,307,7>=this.Qfc);ua=Z.StyleReader.MK(Ya);if(!ua)return Ea.a(4223821,307,!1),!1;ua=ua.DG(d(247).Box4PasteSteward.JHa[this.Qfc]);this.iK.y$(ua,Ya,!1);return!0}if(this.g5g){ua=d(247).Box4PasteSteward.bJb||Z.StyleReader.MK(Ya);if(!ua)return Ea.a(41968716,
307,!1),!1;this.iK.y$(ua.DG(this.g5g),Ya,!1);return!0}return!1}clone(){return new ta(this.paragraph,this.Hf,this.iK,this.ZO,this.kga,this.aV,this.LY,this.y0a,this)}static Hkj(){ta.oP||(ta.oP=new X.a(P.a.Tq()),ta.oP.add(ya.yellow),ta.oP.add(ya.lime),ta.oP.add(ya.aqua),ta.oP.add(ya.fuchsia),ta.oP.add(ya.blue),ta.oP.add(ya.red),ta.oP.add(ya.navy),ta.oP.add(ya.teal),ta.oP.add(ya.green),ta.oP.add(ya.purple),ta.oP.add(ya.maroon),ta.oP.add(ya.olive),ta.oP.add(ya.gray),ta.oP.add(ya.Ugl),ta.oP.add(ya.black));
return ta.oP}static zcl(Ya){if(!pa.a.instance.ga(71))return!0;Ya=Z.StyleReader.UP(Z.StyleReader.BD(Ya));return Ya===Z.StyleReader.zGh||Ya===Z.StyleReader.DKa||Ya===Z.StyleReader.CGh||Ya===Z.StyleReader.Cna}}ta.oP=null;Object(J.a)(ta,"FormattingSteward",null,[477,478]);class Ga{PTe(){return!1}p5d(Ya){return Ya}ona(){}rHb(){}$Tc(){return!1}get VUc(){return!1}C0(){}cJa(){}Boh(){}snh(){}get xrh(){return!1}}Object(J.a)(Ga,"NoOpPasteStewardBridge",null,[476]);var oa=d(17);class sa{constructor(Ya,ua){this.Ohk=
Ya;this.Phk=ua||"Normal"}}Object(J.a)(sa,"NoteTagInfoBox4",null,[]);const Ha=Ya=>{const ua=new oa.a;for(let Ma of Ya)Ya=new sa(Ma.Ohk,Ma.Phk),ua.add(Ya);return ua};d.d(V,"a",function(){return bb});class bb{constructor(Ya,ua,Ma=null,Ca=null){this.LY=this.aV=null;this.$Vi=h.AFrameworkApplication.fa.ka("FollowDestinationFormattingPasteIsEnabled");this.ejf=0;this.zb=Ya;this.fG=ua;this.BY=Ca||new Ga;this.UR=Ma||v.a.r0d(e.a.Z3a,"")}get Ib(){return this.UR}get characterPropertiesEditor(){return bb.Yg||(bb.Yg=
m.a.instance.resolve("Box4.ICharacterPropertiesEditor"))}get fontService(){return this.aV||(this.aV=m.a.instance.qb("Box4.IFontService"))}get vBa(){return this.LY||(this.LY=m.a.instance.qb("Box4.CustomFontService"))}reset(){}get uYb(){return this.F_d(!1)}F_d(Ya){Ea.a(4223770,307,E.OutlineElementReader.Ug(this.zb));const ua=I.OutlineElementNavigator.ri(this.zb);I.OutlineElementNavigator.Ke(this.zb);Ea.a(4223771,307,!!ua&&y.ParagraphReader.Vd(ua));Ya=new ta(ua,bb.ih,bb.HO,bb.RWi,bb.SWi,this.fontService,
this.vBa,this.$Vi,void 0,Ya);return new w(Ya,this.Ib)}g0(){}kma(){}SWa(){}jma(){}ima(){}Jva(){}Iva(){}fA(){}eA(){}MWa(){}LWa(){}Ova(){}DHa(){}nma(){}lma(){}Nva(){}mma(){}NWa(){}DCb(Ya){E.OutlineElementReader.Ug(this.zb)?(bb.Nh.d4b(this.zb,!0),I.OutlineElementNavigator.eJ(this.zb,!1,!1)):L.OutlineReader.Lt(this.zb)?H.OutlineNavigator.T9(this.zb)?Ya?(this.zb.Ii(),bb.hB.eZ(this.zb,!1)):bb.Nh.njc(this.zb):bb.hB.eZ(this.zb,!1):Ea.a(8128524,307,!1,"Unexpected node type {0} encountered",this.zb.oi)}SQa(Ya){let ua=
null;if(Ya&&Ya.ZT&&Ya.cultureName)try{ua=Object.assign(new F.a,{languageId:r.a.oe(Ya.cultureName).LCID})}catch(Ma){Ea.a(8128526,307,!1,"Setting up culture {0} encountered {1}",Ya.cultureName,Ma)}ua||null==this.fG||(ua=Object.assign(new F.a,{languageId:this.fG}));return ua}get RL(){return this.ejf}set RL(Ya){this.ejf=Ya}xCc(){}umd(){}xOd(){}get O4a(){return!1}get d5a(){return!1}qVj(Ya){let ua=1;if(Ya.Mwg){var Ma=0;switch(Ya.listStyleType){case 1:ua=0;break;case 7:ua=1;break;case 8:ua=2;break;case 9:ua=
3;break;case 10:ua=4;break;case 11:ua=5}}else switch(Ma=1,Ya.listStyleType){case 1:ua=0;break;case 3:ua=1;break;case 4:ua=2;break;case 5:ua=3}let Ca;Ma=(Ca=u.ListReader.Y5a)?D.a.AP(Ma,ua,Ha(Ya.N4),Ya.listId,Ya.listLevel,Ya.levelText,Ya.font):D.a.AP(Ma,ua,Ha(Ya.N4));Ya.Mwg&&!Ya.OEj&&(Ma.iA=Ca&&0<Ya.listId&&0<=Ya.listLevel&&!Ya.lEb?Ya.Vil:Ya.NEi);this.BY.rHb(this.zb,Ma,Ya);return Ma}FX(){}CX(){}EX(){}DX(){}BX(){}AX(){}static get Nh(){return bb.Ai||(bb.Ai=m.a.instance.resolve("Box4.IOutlineElementEditor"))}static get hB(){return bb.Cx||
(bb.Cx=m.a.instance.resolve("Box4.IOutlineEditor"))}static get ih(){return bb.Hf||(bb.Hf=m.a.instance.resolve("Box4.IFormattingEditor"))}static get HO(){return bb.iK||(bb.iK=m.a.instance.resolve("Box4.Styles.IStyleEditor"))}static get RWi(){return bb.ZO||(bb.ZO=m.a.instance.resolve("Box4.IFormattingReader"))}static get SWi(){return bb.kga||(bb.kga=m.a.instance.resolve("Box4.Actors.IFormattingStewardBridge"))}}bb.Ai=null;bb.Cx=null;bb.Yg=null;bb.Hf=null;bb.iK=null;bb.ZO=null;bb.kga=null;Object(J.a)(bb,
"Box4PasteStewardBase",null,[457,458,445])},979:function(J,V,d){d.r(V);J=d(0);var h=d(703),e=d(996),m=d(984),r=d(198),v=d(13),A=d(36),w=d(71),y=d(30),u=d(37),D=d(26),F=d(41);class I{constructor(P,ea){this.ge=P;this.Zf=ea}}Object(J.a)(I,"RowSpan",null,[]);class H{constructor(P){this.aB=P;this.KGa=[]}eId(P,ea){Array.add(this.KGa,new I(P,ea))}bYk(P){for(let ea=0;ea<this.KGa.length;ea++){const ia=this.KGa[ea];P<=ia.ge&&ia.ge++;P<=ia.Zf&&ia.Zf++}}get x(){return this.aB}get Yih(){return this.KGa}static ode(P,
ea){return P.aB===ea}static yPd(P,ea){P=P.aB-ea.aB;return 0<P?1:0>P?-1:0}}Object(J.a)(H,"ColSplit",null,[]);const L=(P,ea,ia)=>{let ja;ja=-1;for(let C=0;C<P.length;++C)if(ia(P.ga(C),ea))return ja=C,{returnValue:!0,Rub:ja};return{returnValue:!1,Rub:ja}};class E{constructor(P,ea){this.$d=P;this.Lf=ea}}Object(J.a)(E,"ColSpan",null,[]);class aa{constructor(P){this.bB=P;this.KGa=[]}eId(P,ea){Array.add(this.KGa,new E(P,ea))}Rqi(P){for(let ea=0;ea<this.KGa.length;ea++){const ia=this.KGa[ea];P<=ia.$d&&ia.$d++;
P<=ia.Lf&&ia.Lf++}}get UQf(){return this.KGa}get y(){return this.bB}static ode(P,ea){return P.bB===ea}static yPd(P,ea){P=P.bB-ea.bB;return 0<P?1:0>P?-1:0}}Object(J.a)(aa,"RowSplit",null,[]);var Q=d(935),O=d(27);class T{constructor(P,ea,ia,ja,C,pa,Z,qa,ya,Ka,Da,la,ma,Ea,ta){this.wSa=!1;this.Wi=this.fEc=this.ORg=this.i5c=null;this.xBh=P;this.Vc=ea;this.Cuh=ia;this.cZa=ja;this.Mod=C;this.tableNode=pa;this.Fd=Z;this.mY=qa;this.SQa=ya;this.cYk=Ka;this.Sqi=Da;this.cgd=la;this.hFc=ma;this.rows=Ea;this.cols=
ta;this.dZa=0;this.k6b=!1}W3a(P){this.i5c=new Date;this.ORg=P}J5a(){this.i5c>O.App.Mm&&this.Vc&&this.Vc.Wa(this.ORg,(+new Date-+this.i5c).toString());this.i5c=O.App.Mm}finish(){const {TableMergeSplitEditor:P}=d(979);this.Vc&&(this.Wi&&(this.k6b=!1,this.Vc.Wa(P.iFl,this.Wi.message)),this.Vc.Wa("SplitCellsSucceeded",this.k6b.toString()),this.Vc.finish(),this.Vc=null);if(this.Wi)throw this.Wi;this.Cuh&&this.Cuh(this.k6b,this.cZa)}}Object(J.a)(T,"SplitCellsArguments",null,[]);var K=d(323);d.d(V,"TableMergeSplitEditor",
function(){return X});class X{constructor(P,ea,ia,ja,C,pa,Z,qa,ya,Ka,Da,la,ma,Ea,ta){this.Nb=P;this.qX=ea;this.bA=ia;this.u4=ja;this.s5c=C;this.oL=pa;this.k3c=Z;this.Cq=ya;this.gda=Ka;this.Oac=Da;this.Jk=la;this.Fb=ma;this.ra=Ea;this.v4c=ta}merge(P,ea,ia){const ja=P.jf(ea.ge,ea.$d),C=this.Nb.Kc(ja);let pa=C.HA(1);const Z=[u.a.rowId,u.a.cellId];pa&&C.yc();let qa=!0;for(let Ka=ea.ge;Ka<ea.Zf;++Ka){let Da=P.jf(Ka,ea.$d);for(let la=ea.$d+(Ka===ea.ge?1:0);la<ea.Lf;++la)if(la!==ea.$d&&(Da=P.jf(Ka,la)),
!Da||!Da.isGhostCell){Da.Un(u.a.rowSpan,u.a.colSpan);Da.isGhostCell=!0;var ya=y.GraphIterator.mb(Da);w.OutlineReader.isEmpty(ya)?this.ceh(ya):(qa&&w.OutlineReader.isEmpty(C)&&(qa=!1,pa=null,this.ceh(C)),this.oL.sWi(Da,ma=>{this.oL.Jx(C.currentNode,ma,Z);return!0},ma=>11===ma.type||22===ma.type||12===ma.type),ya=this.Nb.w0d(ya),ya.Ab(1),this.oL.Rfk(C,pa,ya.role,ya.role,ya),ya.nub(1),pa=ya.currentNode)}}this.u4.Evl(ia,ja,ea);ja.rowSpan=ea.oO;ja.colSpan=ea.TQ;P.setValue(u.a.complexTable,!0);this.k3c.$Fe(P);
P.yca(511);this.bA.i4b(P);return ja}ail(P,ea,ia,ja,C,pa,Z,qa,ya){if(1>=ia&&1>=ja)ya&&ya(!0,ea);else{var Ka=new Date,Da=F.a.Pl("SplitCells",1);Da.Oj=!0;var la=new h.a,ma=new e.a,Ea=new e.a,ta=this.gda.WBa(P,C,ea);ea=this.Cq.bKc(C,ea);var Ga=pa.efg();for(pa=pa.$9f();ta.moveNext();){la.add(ta.t0b().id.toString());const bb=ta.Pz;for(var oa=1;oa<ia;oa++){var sa=Ga[bb.ge];sa+=(Ga[bb.Zf]-sa)*oa/ia;var Ha=void 0;({Rub:Ha}=L(ma,sa,aa.ode)).returnValue||(Ha=ma.length,ma.add(new aa(sa)));ma.ga(Ha).eId(bb.$d,
bb.Lf)}for(oa=1;oa<ja;oa++)sa=pa[bb.$d],sa+=(pa[bb.Lf]-sa)*oa/ja,({Rub:Ha}=L(Ea,sa,H.ode)).returnValue||(Ha=Ea.length,Ea.add(new H(sa))),Ea.ga(Ha).eId(bb.ge,bb.Zf)}ma=ma.toArray();Ea=Ea.toArray();ma.sort((bb,Ya)=>aa.yPd(Ya,bb));Ea.sort((bb,Ya)=>H.yPd(Ya,bb));Da.Wa("Prep",(+new Date-+Ka).toString());Ka=this.Fb.ke(15);Ka.kc(P);P=new T(Ka,Da,ya,ea,la,P,Z,C,qa,Ga,pa,ma,Ea,ia,ja);P=new m.a(null,Object(v.a)(this,this.iil,"splitRowSeams"),P);P.Xi=!1;P.Fl("SplitTableCells");P.run()}}iil(P,ea){try{for(ea.W3a("SplitRowSeams");ea.dZa<
ea.cgd.length;){const ia=({wSa:ea.wSa}=this.Rxi(ea.tableNode,ea.Fd,ea.mY,ea.SQa,ea.cYk,ea.cgd[ea.dZa])).returnValue;ea.dZa++;if(ea.wSa){let ja;(ja=ea.cZa).Zf=ja.Zf+1;for(let C=0;C<ea.hFc.length;C++)ea.hFc[C].bYk(ia)}if(P.Ina)return!0}ea.J5a();ea.dZa=0;P.Zg(Object(v.a)(this,this.eil,"splitColSeams"))}catch(ia){ea.Wi=ia,P.Zg(Object(v.a)(this,this.hib,"tearDownSplit"))}return!0}eil(P,ea){try{for(ea.W3a("SplitColSeams");ea.dZa<ea.hFc.length;){const ia=({wSa:ea.wSa}=this.Qxi(ea.tableNode,ea.Fd,ea.mY,ea.SQa,
ea.Sqi,ea.hFc[ea.dZa])).returnValue;ea.dZa++;if(ea.wSa){let ja;(ja=ea.cZa).Lf=ja.Lf+1;for(let C=0;C<ea.cgd.length;++C)ea.cgd[C].Rqi(ia)}if(P.Ina)return!0}ea.J5a();ea.dZa=0;P.Zg(Object(v.a)(this,this.DKb,"updateIsComplexTableProperty"))}catch(ia){ea.Wi=ia,P.Zg(Object(v.a)(this,this.hib,"tearDownSplit"))}return!0}DKb(P,ea){try{ea.W3a("UpdateComplex"),this.k3c.SUe(this.Nb.Kc(ea.tableNode)),ea.J5a(),ea.fEc=this.gda.WBa(ea.tableNode,ea.mY,ea.cZa),P.Zg(Object(v.a)(this,this.bVi,"fixSplitCells"))}catch(ia){ea.Wi=
ia,P.Zg(Object(v.a)(this,this.hib,"tearDownSplit"))}return!0}bVi(P,ea){try{for(ea.W3a("FixInsideBorders");ea.fEc.moveNext();)if(ea.Mod.contains(ea.fEc.t0b().id.toString())&&this.aVi(ea.tableNode,ea.mY,ea.fEc,ea.rows,ea.cols),P.Ina)return!0;ea.J5a();P.Zg(Object(v.a)(this,this.mOi,"ensureMinRowHeightColumnWidth"))}catch(ia){ea.Wi=ia,P.Zg(Object(v.a)(this,this.hib,"tearDownSplit"))}return!0}mOi(P,ea){try{ea.W3a("EnsureMinHeightWidth"),1<ea.rows&&this.nOi(ea.tableNode,ea.cZa),1<ea.cols&&this.lOi(ea.tableNode,
ea.cZa),ea.J5a(),P.Zg(Object(v.a)(this,this.setSelection,"setSelection"))}catch(ia){ea.Wi=ia,P.Zg(Object(v.a)(this,this.hib,"tearDownSplit"))}return!0}setSelection(P,ea){try{ea.W3a("SetSelection");ea.k6b=!ea.cZa.$Pa();if(ea.k6b){const ia=this.v4c.zDi(ea.tableNode,ea.mY,ea.cZa);ia&&this.ra.qE(ia)}ea.J5a();ea.W3a("Render");P.Xi||ea.xBh.Gnh(P);ea.xBh.dispose();P.Zg(Object(v.a)(this,this.hib,"tearDownSplit"))}catch(ia){ea.Wi=ia,P.Zg(Object(v.a)(this,this.hib,"tearDownSplit"))}return!0}hib(P,ea){ea.J5a();
ea.finish();return!1}Rxi(P,ea,ia,ja,C,pa){var Z;let qa=({gbe:Z}=Q.c(C,pa.y)).returnValue;if(Z=!Z){qa++;var ya=C[qa-1],Ka=C[qa],Da=this.Nb.Kc(P);this.Sdc(Da,qa-1);var la=Da.currentNode;Da=this.k3c.F8d(Da);ya=pa.y-ya;la.setValue(u.a.au,ea.Ff(ya,1));ya=Ka-pa.y;Da.setValue(u.a.au,ea.Ff(ya,1));Array.insert(C,qa,pa.y);ia.gSa(3)}for(ea=0;ea<pa.UQf.length;++ea){C=pa.UQf[ea];Ka=[];for(la=C.$d;la<=C.Lf;++la)({Xja:ya}=this.s5c.kAh(P,ia,la,qa)),Ka[Ka.length]=ya;la=new K.a;la.$d=C.$d;la.Lf=C.Lf;la.ge=qa-1;la.Zf=
qa+1;for(la=this.gda.WBa(P,ia,la);la.moveNext();)ya=la.Pz,Da=la.t0b(),this.hTf(qa,ya.$d,Da),this.Rmh(qa,ya.$d,Da,ja);for(la=C.$d;la<C.Lf;++la){ya=P.jf(qa-1,la);Da=P.jf(qa,la);var ma=this.Cq.dI(ia,qa-1,la);ma.$d===la&&(ya=P.jf(ma.ge,ma.$d),ma=qa-ma.ge,Da.rowSpan=ya.rowSpan-ma,ya.rowSpan=ma,Da.colSpan=ya.colSpan);Da.isGhostCell=ya.isGhostCell}ia.gSa(1);this.u4.aYd(P,ia,qa,C.$d,C.Lf,!0);for(let Ea=C.$d,ta=0;Ea<=C.Lf;++Ea,++ta)Ka[ta]&&this.u4.XLe(P,ia,Ea,qa,qa+1,Ka[ta])}return{returnValue:qa,wSa:Z}}Qxi(P,
ea,ia,ja,C,pa){var Z;let qa=({gbe:Z}=Q.b(C,pa.x)).returnValue;if(Z=!Z){qa++;var ya=C[qa-1],Ka=C[qa],Da=this.Nb.Kc(P);this.qX.ZVg(Da);Da.Rp(qa-1,1);this.k3c.E8d(Da);if(Da=P.sa(A.a.Iu,null))Da=r.a.clone(Da),Da[qa-1]=ea.Ff(pa.x-ya,0),Da[qa]=ea.Ff(Ka-pa.x,0),P.setValue(A.a.Iu,Da);Array.insert(C,qa,pa.x);ia.gSa(3)}for(ea=0;ea<pa.Yih.length;++ea){C=pa.Yih[ea];ya=[];for(Ka=C.ge;Ka<=C.Zf;++Ka)({Xja:Da}=this.s5c.gAh(P,ia,Ka,qa)),ya[ya.length]=Da;Ka=new K.a;Ka.ge=C.ge;Ka.Zf=C.Zf;Ka.$d=qa-1;Ka.Lf=qa+1;for(Ka=
this.gda.WBa(P,ia,Ka);Ka.moveNext();){Da=Ka.Pz;var la=Ka.t0b();this.hTf(Da.ge,qa,la);this.Rmh(Da.ge,qa,la,ja)}for(Ka=C.ge;Ka<C.Zf;++Ka){Da=P.jf(Ka,qa-1);la=P.jf(Ka,qa);var ma=this.Cq.dI(ia,Ka,qa-1);ma.ge===Ka&&(Da=P.jf(ma.ge,ma.$d),ma=qa-ma.$d,la.colSpan=Da.colSpan-ma,Da.colSpan=ma,la.rowSpan=Da.rowSpan);la.isGhostCell=Da.isGhostCell}ia.gSa(1);this.u4.cYd(P,ia,qa,C.ge,C.Zf,!0);for(let Ea=C.ge,ta=0;Ea<=C.Zf;++Ea,++ta)ya[ta]&&this.u4.QKe(P,ia,Ea,qa,qa+1,ya[ta])}return{returnValue:qa,wSa:Z}}aVi(P,ea,
ia,ja,C){var pa=this.gda.WBa(P,ea,ia.XD);pa.moveTo(ia.dO,ia.fL);ia=pa.Pz;for(let Z=1;Z<ja;++Z)pa.agk(),ia.Zf=pa.Pz.Zf,ia.Lf=pa.Pz.Lf;for(ja=1;ja<C;++ja)pa.moveNext(),ia.Zf=pa.Pz.Zf,ia.Lf=pa.Pz.Lf;for(C=this.gda.WBa(P,ea,ia);C.moveNext();){pa=C.Pz;let Z;pa.Zf<ia.Zf&&({Xja:Z}=this.s5c.gAh(P,ea,ia.Zf,pa.$d)).returnValue&&this.u4.QKe(P,ea,pa.Zf,pa.$d,pa.Lf,Z);pa.Lf<ia.Lf&&({Xja:Z}=this.s5c.kAh(P,ea,ia.Lf,pa.ge)).returnValue&&this.u4.XLe(P,ea,pa.Lf,pa.ge,pa.Zf,Z)}}nOi(P,ea){P=this.Nb.Kc(P);this.Sdc(P,
ea.ge);for(let ia=ea.ge;ia<ea.Zf;++ia){const ja=P.currentNode.sa(u.a.au,0);ja&&ja<this.Jk.NDc(P.currentNode)&&P.currentNode.setValue(u.a.au,0);P.vf(1)}}lOi(P,ea){let ia=P.sa(A.a.Iu,null),ja=!1;if(ia){ia=r.a.clone(ia);for(let C=ea.$d;C<ea.Lf;++C){const pa=this.Jk.Cpb(P,C);ia[C]&&ia[C]<pa&&(ia[C]=pa,ja=!0)}}ja&&P.setValue(A.a.Iu,ia)}hTf(P,ea,ia){const ja=ia.getContainingTable();ja||D.a.J(512495627,822,10,"Not able to access TableNode from Table Cell Node");ja.jf(P,ea).cellShading=ia.cellShading}Rmh(P,
ea,ia,ja){const C=ia.getContainingTable();C||D.a.J(512495625,822,10,"Not able to access TableNode from Table Cell Node");P=y.GraphIterator.mb(C.jf(P,ea));this.Oac.eZ(P,!0,ja(ia))}Sdc(P,ea){for(this.qX.ZVg(P);0<ea--;)this.qX.ggk(P)}ceh(P){P=this.Nb.w0d(P);let ea=P.Ab(1);for(;ea;)ea=P.rPa(1)}}Object(J.a)(X,"TableMergeSplitEditor",null,[272])},980:function(J,V,d){J=d(0);var h=d(13),e=d(376),m=d(25),r=d(163),v=d(194),A=d(55);class w{constructor(Q,O,T,K){this.Wyd=null;this.tsc=K;this.Gaa=Q;this.Haa=O;
this.TO=T;this.Pwf=this.ITg.Ual;Q=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.fSh=Q[0];this.eSh=Q[1]}get ITg(){return this.Wyd||(this.Wyd=A.a.instance.resolve("Common.IMacOfficeOffer"))}get id(){return"OICErrorDialog"}get errorMessage(){return CommonUIStrings.l_OICErrorMessage}get QRa(){return CommonUIStrings.l_OICErrorHelpLink}get Tlc(){return this.Pwf}get KTg(){return this.fSh}get JTg(){return this.eSh}get HTg(){return CommonUIStrings.l_OICErrorMacOFficeLink}get icon(){return this.Pwf?
3:2}get UZb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get QFc(){return!!this.Haa}get VZb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get qPa(){return CommonUIStrings.l_DefaultDialogTitle}CEe(Q){this.pec(Q)}Zde(Q){this.pec(Q)}pec(Q){let O=10;this.Haa&&1===Q&&(this.Haa(this.TO),O=1);this.Gaa&&this.Gaa(this.TO);this.jp(O)}Ndb(){v.Redirect.showHelp("OICFailure");this.jp(2)}ewe(){this.ITg.UBg();this.jp(4)}jp(Q){e.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",
this.tsc,Q);m.AFrameworkApplication.Mfb(r.a.S3g,this.tsc,Q)}dispose(){this.TO=this.Gaa=this.Haa=null}}Object(J.a)(w,"AOICErrorDialog",null,[106]);var y=d(90),u=d(104);class D extends w{constructor(Q,O,T,K){super(Q,O,T,K);this.jMa=this.xz=null;Q=document.createElement("span");Q.id="errorMessageText";Q.innerText=this.errorMessage;Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));this.xz=document.createElement("a");this.xz.href="#";this.xz.innerText=this.QRa;Q.appendChild(this.xz);
y.a.addHandler(this.xz,"click",Object(h.a)(this,this.Ndb,"oicErrorHelpLinkHandler"));O=new u.StandardDialog;O.ng=this.id;this.Tlc?(T=document.createElement("span"),K=document.createElement("span"),T.innerText=this.KTg,K.innerText=this.JTg,this.jMa=document.createElement("a"),this.jMa.href="#",this.jMa.innerText=this.HTg,Q.appendChild(document.createElement("br")),Q.appendChild(T),Q.appendChild(this.jMa),Q.appendChild(K),y.a.addHandler(this.jMa,"click",Object(h.a)(this,this.ewe,"oicErrorMacOfferLinkHandler"))):
this.QFc&&(Q.appendChild(document.createElement("br")),Q.appendChild(document.createElement("br")),T=document.createElement("span"),T.innerText=this.UZb,Q.appendChild(T));this.QFc?(O.yd=1,O.Ue(1,this.VZb)):O.yd=0;O.nx(this.qPa,null,this.icon,Object(h.a)(this,this.Zde,"legacyOICErrorDialogHandler"),Q);O.i5("errorMessageText")}dispose(){this.xz&&(y.a.removeHandler(this.xz,"click",Object(h.a)(this,this.Ndb,"oicErrorHelpLinkHandler")),this.xz=null);this.jMa&&(y.a.removeHandler(this.jMa,"click",Object(h.a)(this,
this.ewe,"oicErrorMacOfferLinkHandler")),this.jMa=null);super.dispose()}}Object(J.a)(D,"OICErrorDialog",w,[]);class F{constructor(Q,O,T){this.Gaa=O;this.Haa=Q;this.TO=T}get id(){return"OICErrorDialogWithDownload"}get n2f(){return CommonUIStrings.l_OICErrorNoOfficeDetected}get QRa(){return CommonUIStrings.l_OICErrorHelpLink}get UZb(){return CommonUIStrings.l_OICErrorFileDownloadOffer}get VZb(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}get icon(){return 2}get qPa(){return CommonUIStrings.l_DefaultDialogTitle}CEe(Q){this.pec(Q)}Zde(Q){this.pec(Q)}pec(Q){let O=
10;1===Q&&(this.Haa(this.TO),O=1);this.Gaa&&this.Gaa(this.TO);this.jp(O)}Ndb(){v.Redirect.showHelp("OICFailure");this.jp(2)}jp(Q){m.AFrameworkApplication.Mfb(r.a.T3g,3,Q)}dispose(){this.TO=this.Haa=this.Gaa=null}}Object(J.a)(F,"AOICErrorDialogWithDownload",null,[106]);class I extends F{constructor(Q,O,T){super(Q,O,T);this.xz=null;Q=document.createElement("span");Q.id="errorMessageText";Q.innerText=this.n2f;Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));this.xz=
document.createElement("a");this.xz.href="#";this.xz.innerText=this.QRa;Q.appendChild(this.xz);y.a.addHandler(this.xz,"click",Object(h.a)(this,this.Ndb,"oicErrorHelpLinkHandler"));Q.appendChild(document.createElement("br"));Q.appendChild(document.createElement("br"));O=document.createElement("span");O.innerText=this.UZb;Q.appendChild(O);O=new u.StandardDialog;O.ng=this.id;O.yd=1;O.Ue(1,this.VZb);O.nx(this.qPa,null,this.icon,Object(h.a)(this,this.Zde,"legacyOICErrorDialogHandler"),Q);O.i5("errorMessageText")}dispose(){this.xz&&
(y.a.removeHandler(this.xz,"click",Object(h.a)(this,this.Ndb,"oicErrorHelpLinkHandler")),this.xz=null);super.dispose()}}Object(J.a)(I,"OICErrorDialogWithDownload",F,[]);var H=d(82);class L extends w{constructor(Q,O,T,K){super(Q,O,T,K);O={["errorMessage"]:this.errorMessage};O.helpLink={["type"]:"AppLinkProps",["id"]:"helpLink",["text"]:this.QRa,["onExecute"]:X=>{this.Ndb(X)}};this.Tlc?(O.macOfficePreLinkText=this.KTg,O.macOfficeLink={["type"]:"AppLinkProps",["id"]:"macOfficeLink",["text"]:this.HTg,
["onExecute"]:X=>{this.ewe(X)}},O.macOfficePostText=this.JTg):this.QFc&&(O.errorFileDownloadOffer=this.UZb);Q=new H.a(!1,!1,!0);this.QFc?(Q.yd=1,Q.Ue(1,this.VZb)):Q.yd=0;Q.ng=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};Q.tj(this.qPa,Object(h.a)(this,this.CEe,"reactOICErrorDialogHandler"),O)}}Object(J.a)(L,"ReactOICErrorDialog",w,[]);class E extends F{constructor(Q,O,T){super(Q,O,T);O={["errorMessage"]:this.n2f,["errorFileDownloadOffer"]:this.UZb};O.helpLink={["type"]:"AppLinkProps",
["id"]:"helpLink",["text"]:this.QRa,["onExecute"]:K=>{this.Ndb(K)}};Q=new H.a(!1,!1,!0);Q.yd=1;Q.Ue(1,this.VZb);Q.ng=this.id;O={["id"]:this.id,["dialogIcon"]:this.icon,["bodyControls"]:O};Q.tj(this.qPa,Object(h.a)(this,this.CEe,"reactOICErrorDialogHandler"),O)}}Object(J.a)(E,"ReactOICErrorDialogWithDownload",F,[]);d.d(V,"a",function(){return aa});class aa{constructor(){this.Moa=!!m.AFrameworkApplication.Aa&&m.AFrameworkApplication.Aa.jb.gC}iBi(Q,O,T){this.Moa?new L(Q,O,null,T):new D(Q,O,null,T)}jBi(Q,
O,T){this.Moa?new E(Q,O,T):new I(Q,O,T)}kBi(Q,O,T,K,X){const {ReactOICErrorDialogWithTrial:P}=d(1082),{OICErrorDialogWithTrial:ea}=d(1083);this.Moa?new P(Q,O,T,null,K,X):new ea(Q,O,T,null,K,X)}static get instance(){return aa.Ja||(aa.Ja=new aa)}}aa.Ja=null;Object(J.a)(aa,"OICErrorDialogFactory",null,[1287])},985:function(J,V,d){J=d(0);var h=d(376);d(1166);var e=d(94),m=d(63),r=d(87);class v{constructor(){this.hasImpliedUsage=this.additionalValues=this.isInternal=this.isIntentional=null}}Object(J.a)(v,
"IKpiFailureOptionalProperties",null,[]);class A{constructor(){this.hasImpliedUsage=this.additionalValues=null}}Object(J.a)(A,"IKpiSuccessOptionalProperties",null,[]);var w=d(908);class y{constructor(){this.blockFutureEmissionDurationInMs=this.optionalVeto=this.optionalProperties=this.errorName=this.kpiName=null}}Object(J.a)(y,"KpiFailureParams",null,[]);class u{constructor(){this.blockFutureEmissionDurationInMs=this.optionalProperties=this.kpiName=null}}Object(J.a)(u,"KpiSuccessParams",null,[]);
var D=d(909);d.d(V,"a",function(){return F});class F{static getInstance(I){try{return healthSmall.HealthFactoryGlobal.getExtendedHealthInstance(e.Health.instance,I)}catch(H){return h.ULS.sgb(521457890,383,10,H,"Failed to initialize extendedHealth"),null}}static ZKk(I,H){const L=F.getInstance(I);L&&L.logKpiUsage(F.X7i());const E=m.a.sj();try{const aa=H();aa.then(Q=>{const O=F.W7i(m.a.sj()-E);L&&L.logKpiSuccess(O);return Q}).catch(Q=>{let O="UnknownError";Q&&(O=Q.toString());Q=F.lcg(O,m.a.sj()-E);L&&
L.logKpiFailure(Q)});return aa}catch(aa){throw I="",I=aa.message,I=F.lcg(I,m.a.sj()-E),L&&L.logKpiFailure(I),aa;}}static X7i(){const I=Object.assign(new w.a,{extendedProperties:F.Q_d()});return Object.assign(new D.a,{kpiName:"InitFloodgate",kpiType:0,optionalProperties:I,blockFutureEmissionDurationInMs:3E5})}static W7i(I=null){I=Object.assign(new A,{additionalValues:Object.assign(new r.a,{extendedProperties:F.Q_d(),durationMs:I})});return Object.assign(new u,{kpiName:"InitFloodgate",optionalProperties:I,
blockFutureEmissionDurationInMs:3E5})}static lcg(I,H=null){H=Object.assign(new v,{additionalValues:Object.assign(new r.a,{extendedProperties:F.Q_d(),durationMs:H})});return Object.assign(new y,{kpiName:"InitFloodgate",errorName:I,optionalProperties:H,optionalVeto:null,blockFutureEmissionDurationInMs:3E5})}static Q_d(){const I=new Map;I.has("SkipAria")||I.set("SkipAria","True");return I}}Object(J.a)(F,"ExtendedHealth",null,[])},990:function(J,V,d){J=d(0);var h=d(376),e=d(1166),m=d(1167),r=d(1168),
v=d(119),A=d(25),w=d(985),y=d(197),u=d(269),D=d(93),F=d(248),I=d(305),H=d(33),L=d(54),E=d(45);class aa{constructor(){this.cvFlights=this.uiHost=this.productName=null;this.isCVSurveyEnabled=!1}}Object(J.a)(aa,"CustomerVoiceSurveyParams",null,[]);var Q=d(135),O=d(522);class T{sendTelemetryEvent(P){const ea=new O.a;ea.otelEvent=P;Q.a.sendOtelEvent(ea)}}Object(J.a)(T,"OtelTelemetrySink",null,[1318]);var K=d(910);d.d(V,"a",function(){return X});class X{static init(P,ea,ia,ja,C){C.onDismiss=P;C.onError=
ea;P=null;OfficeBrowserFeedback.initOptions?("screenshot"in C&&(OfficeBrowserFeedback.initOptions.screenshot=C.screenshot),"showEmailAddress"in C&&(OfficeBrowserFeedback.initOptions.showEmailAddress=C.showEmailAddress),"feedbackForumUrl"in C&&(OfficeBrowserFeedback.initOptions.feedbackForumUrl=C.feedbackForumUrl),P=C):OfficeBrowserFeedback.initOptions=C;OfficeBrowserFeedback.initOptions.telemetrySink||(OfficeBrowserFeedback.initOptions.telemetrySink=X.$Uf());OfficeBrowserFeedback.multiFeedback(P).then(()=>
{h.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")}).catch(pa=>h.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+pa.toString()))}static a8d(P,ea,ia,ja){h.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback");if(X.slb===X.initialized)return Promise.resolve(1);if(X.slb===X.Nog)return X.Oog||(X.Oog=!0,h.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(X.slb!==X.error){X.slb=X.Nog;h.ULS.sendTraceTag(36546400,356,50,"BFCOCV.InitSIFeedback:past init check");
if(X.Fyj(P,ea,ia,ja))return X.kyj();X.slb=X.error;Promise.reject(X.ZXg)}return Promise.reject(0)}static kyj(){try{return w.a.ZKk(X.V7i(),()=>OfficeBrowserFeedback.floodgate.initialize().then(()=>X.GPe())).catch(P=>{h.ULS.sendTraceTag(36546402,356,10,"BFCOCV Floodgate initialize error:"+P.toString())})}catch(P){return h.ULS.sendTraceTag(590975881,356,15,"BFCOCV Floodgate initialize error:"+P.toString()),Promise.reject(X.Nik)}}static V7i(){return Object.assign(new K.a,{featureName:"Floodgate",crewAlias:"floodgatecrew",
vetoPillar:"OfficeBrowserFeedback"})}static GPe(){return OfficeBrowserFeedback.floodgate.start().then(()=>{X.FVi()}).catch(P=>{h.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+P.toString())})}static FVi(){X.slb=X.initialized;h.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate");try{const P=A.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateTestActivity","");for(const ea of P.split("|"))ea&&X.logActivity(ea,null)}catch(P){h.ULS.sendTraceTag(539015366,
356,50,"Error triggering test activity")}}static jta(){let P=!1;const ea=A.AFrameworkApplication.fa;ea&&(P="teams"===(ea.Ga(A.AFrameworkApplication.FJ)||"").toLowerCase());return L.a.rEa||P}static dYg(){return"undefined"==typeof OfficeBrowserFeedback}static Fyj(P,ea,ia,ja){let C=!0;try{if(X.dYg())return h.ULS.sendTraceTag(39900617,356,15,X.ZXg),!1;OfficeBrowserFeedback.initOptions||(ia.onDismiss=ja,ia.onError=ea,ia=X.S$h(ia),OfficeBrowserFeedback.initOptions=ia);OfficeBrowserFeedback.initOptions.telemetrySink||
(OfficeBrowserFeedback.initOptions.telemetrySink=X.$Uf());ea={};ja={};ja.onSurveyActivated=X.ork;ja.onTeachingCampaignRender=ia.onTeachingCampaignRender;ea.onSurveyActivatedCallback=ja;ea.onDismiss=P;ea.autoDismiss=ia.FloodgateUIAutoDismissTimeEnum;ea.telemetryGroup=ia.telemetryGroup;ea.uIStringGetter=ia.uIStringGetter;ea.authTokenCallback=ia.authTokenCallback;ea.augLoopCallback=ia.augLoopCallback;ea.campaignFlights="";ea.governanceServiceEnabled=ia.governanceServiceEnabled;ea.governanceServiceConfig=
ia.governanceServiceConfig;ea.personalizerEnabled=ia.personalizerEnabled;ea.messagingServiceSettings=ia.messagingServiceSettings;ea.isPriorityEnabled=ia.isPriorityEnabled;A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateAdminControlsEnabled",!1)&&("surveyEnabled"in ia&&(ea.surveyEnabled=ia.surveyEnabled),"showEmailAddress"in ia&&(ea.showEmailAddress=ia.showEmailAddress));ea.isEudbUxEnabled=!1;A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EUDBUXIsEnabled",
!1)&&(ea.isEudbUxEnabled=!0);const Z=X.Y2i(ia),qa=X.abg(Z);let ya=X.s3i(ia);for(let Ka in qa){P=Ka;var pa=qa[Ka];-1!==P.toLowerCase().indexOf("flight")?ea.campaignFlights+=pa+";":ya=ya+P+"="+pa+"&"}h.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+ea.campaignFlights+" campaignQueryParameters: "+ya);ea.campaignQueryParameters=ya;ea.customerVoiceSurveyParams=X.j3i(ia.Application.toString(),X.jta()?X.Kml:"");OfficeBrowserFeedback.floodgate.initOptions=ea}catch(Z){C=!1,h.ULS.sendTraceTag(39900618,
356,15,Z.toString())}return C}static S$h(P){try{const ea=P.applicationGroup?P.applicationGroup:{},ia=ea.appData,ja=ia?H.a(H.a('"'+ia+'"')):{};ja.fgUIAutoDismiss=P.FloodgateUIAutoDismissTimeEnum;ea.appData=H.c(ja);P.applicationGroup=ea}catch(ea){h.ULS.sendTraceTag(588842831,356,10,"Failed to parse applicationGroup.appData",ea.toString())}return P}static Y2i(P){P=Array.isArray(P.Flights)?P.Flights:null;P||(P=(P=A.AFrameworkApplication.fa.Ga("FlightId"))?P.toString().split(";"):null);if(A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FloodgateTreatmentVariableFlighting",
!0)){const ea=A.AFrameworkApplication.fa.dLc;if(ea)for(let ia in ea){const ja={key:ia,value:ea[ia]};-1!==(ja&&ja.key?ja.key.toLowerCase():"").indexOf("floodgateflight")&&"unset"!==(ja&&ja.value?ja.value.toString().toLowerCase():"")&&P.push(ja.key)}}return P}static abg(P){const ea={SelfTriggerActivity:""};if(!P||!P.length)return ea;try{for(let C=0;C<P.length;C++){let pa=P[C]?P[C].toLowerCase():"";if(-1===pa.indexOf("floodgateflight"))continue;const Z=pa.lastIndexOf(".");-1!==Z&&(pa=pa.substring(Z+
1,pa.length));if(-1!==("AppFlights"in ea?ea.AppFlights:"").indexOf(pa))continue;ea.AppFlights="AppFlights"in ea?ea.AppFlights+(";"+pa):pa;const qa=E.a.replaceAll(pa,"-",""),ya=A.AFrameworkApplication.fa.Ga(qa);if(ya)try{const Ka=H.a(ya);Ka&&Ka.SelfTriggerActivity||(ea.SelfTriggerActivity+=";"+qa);if(Ka)for(let Da in Ka){var ia=Da,ja=Ka[Da];ia in ea?ea[ia]!==ja&&(ea[ia]=ea[ia]+";"+ja):ea[ia]=ja}}catch(Ka){h.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+qa+" json data",Ka.toString())}else ea.SelfTriggerActivity+=
";"+qa}}catch(C){h.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",C.toString())}return ea}static s3i(P){let ea="";const ia={["OFC_Audience"]:"AudienceGroup",["Datacenter"]:"WACDatacenter",["TenantId"]:"TenantId"};for(let pa in ia){var ja=pa,C=ia[pa];let Z=P[Object(e.a)(String,C)];Z||(Z=A.AFrameworkApplication.fa.Ga(Object(e.a)(String,C)));Z&&(ea+=ja+"="+encodeURIComponent(Z)+"&")}return ea}static B3k(P){X.ySd=P}static ork(P,ea,ia){if(P)try{const C=
ea?ea.getCampaignId():"",pa=ea?ea.getLauncherType():"",Z=ia?ia.contextInfo:null;var ja=ea?ea.getSurveyInfo():null;const qa=ja?ja.getPreferredLaunchType():null,ya=ja?ja.getMetadata():null,Ka=ya?ya.getContentMetadata():null,Da=Ka?Ka.customSurveyName:null,la=Ka?Ka.telemetryEventName:null;X.zFj(C)?h.ULS.sendTraceTag(539015367,356,50,"BFCOCV.onSurveyActivated campaign disabled -"+C):(ja={},ja.campaignId=C,ja.surveyName=Da,ja.launcherType=pa,ja.contextInfoLength=Z?Z.length.toString():"-1",ja.preferredLaunchType=
qa,ja.telemetryEventName=la,h.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated -  "+JSON.stringify(ja)),pa&&"coachingux"===pa.toLowerCase()&&qa&&"default"!==qa.toLowerCase()&&X.Ikg(Ka,ea,ia)?h.ULS.sendTraceTag(555071513,356,50,"BFCOCV.onSurveyActivated. Custom survey activation successful - "+JSON.stringify(ja)):(P.launch(ia),X.tph()))}catch(C){h.ULS.sendTraceTag(555071514,356,10,"BFCOCV.onSurveyActivated. Error handling activation callback - "+(C?C.toString():""))}else h.ULS.sendTraceTag(36706400,
356,10,"BFCOCV.onSurveyActivated given a null launcher")}static Wrj(P){P=P?P.surfaceContext:null;if(!P||!P.surveyForm)return h.ULS.sendTraceTag(555071516,356,10,"Missing activation arguments"),!1;try{const ea=P.surveyForm.getSurveyInfo(),ia=ea?ea.getMetadata():null,ja=ia?ia.getContentMetadata():null;return X.Ikg(ja,P.surveyForm,P.surveyParams)}catch(ea){h.ULS.sendTraceTag(555071517,356,10,"BFCOCV.HandleActivationCallback Error - "+(ea?ea.toString():""))}return!1}static Ikg(P,ea,ia){if(!P||!P.customSurveyName||
!ea)return h.ULS.sendTraceTag(555071518,356,10,"Survey arguments not provided "+(P?P.customSurveyName:null)),!1;const ja=ea.getCampaignId();if(P.telemetryEventName){var C={["action"]:"Opened",["id"]:ja,["success"]:"true",["triggerType"]:"custom",["customSurveyName"]:P.customSurveyName,["telemetryEventName"]:P.telemetryEventName};X.ySd?X.ySd(P.telemetryEventName,C):(A.AFrameworkApplication.Wj(P.telemetryEventName),A.AFrameworkApplication.s7b(P.telemetryEventName),h.ULS.sendTraceTag(512505554,356,50,
"BFCOCV.onSurveyActivated survey activated -"+JSON.stringify(C)))}C=X.sCf.Jb(P.customSurveyName)?X.sCf.ga(P.customSurveyName):null;if(!C)return h.ULS.sendTraceTag(555071519,356,50,"Activation callback not found - "+P.customSurveyName+", "+ja),!1;(P=C(ea,ia))&&P.then(pa=>{h.ULS.sendTraceTag(555071520,356,50,"Activation callback result - "+JSON.stringify(pa))}).catch(pa=>{h.ULS.sendTraceTag(555071521,356,50,"Error in activation callback handling: "+(pa?pa.toString():""))});return!0}static zFj(P){try{return-1!==
A.AFrameworkApplication.fa.getStringFeatureGate("Microsoft.Office.SharedOnline.FloodgateDisabledCampaigns","").toLowerCase().indexOf((P||"").toLowerCase())}catch(ea){h.ULS.sendTraceTag(539015368,356,10,"Error checking if campaign is disabled - "+P)}return!1}static logActivity(P,ea=null){if(X.dOd(P,"LogActivity")){var ia=X.j0d();ia&&(h.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+P),ia.logActivity(P,1,ea))}}static yIb(P){P?(h.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),
OfficeBrowserFeedback.floodgate.showCustomSurvey(P),X.tph()):h.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")}static tph(){X.Upa(X.v6f)}static Izj(P,ea,ia){var ja=[3,2,5,1];const C=D.FocusManager.instance(),pa=C.Dc(P);pa.parent=v.AFrame.jj;pa.cL=!0;u.a.instance.P1(P,!0);ea&&pa.$aa(ea);if(ia){F.a.instance.O6(P,ia,!1,!0);I.a.instance.O6(P,ia,!1,!0);P=new y.DOMFocusListing(()=>ia);for(ea=0;ea<ja.length;++ea)P.vo(ja[ea]);C.Jha(()=>ia,pa,P).DW=!0}}static Upa(P){const ea=document.getElementById(P);
ea?X.Izj(P,X.lmk,ea):h.ULS.sendTraceTag(36706402,356,15,"BFCOCV.Could not find container "+P)}static lmk(P,ea){h.ULS.sendTraceTag(37107265,356,100,"BFCOCV.OnFocusAction. PrevScopeName "+(P?P.name:"")+" NextScopeName "+(ea?ea.name:""));ea&&(P=D.FocusManager.instance().SP(ea.name))&&P.u7c()}static l7b(P){if(X.dOd(P,"LogActivityStart")){var ea=X.j0d();ea&&(h.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+P),ea.logActivityStartTime(P))}}static VCg(P){if(X.dOd(P,"LogActivityEnd")){var ea=
X.j0d();ea&&(h.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+P),ea.logActivityStopTime(P,new Date))}}static GVi(){OfficeBrowserFeedback.floodgate.start()}static HVi(){OfficeBrowserFeedback.floodgate.stop()}static dOd(P,ea){P||h.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+ea);return!!P}static j0d(){let P=null;const ea=OfficeBrowserFeedback.floodgate.getEngine();ea?(P=ea.getActivityListener())||h.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):
X.JXg||(X.JXg=!0,h.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null"));return P}static $Uf(){return new T}static j3i(P,ea){return Object.assign(new aa,{productName:P,uiHost:ea,cvFlights:"",isCVSurveyEnabled:!0})}}X.v6f="obf-ToastContainer";X.notInitialized=0;X.Nog=1;X.initialized=2;X.error=-1;X.slb=X.notInitialized;X.JXg=!1;X.Oog=!1;X.ZXg="OFB still undefined";X.Nik="OFB Floodgate is undefined or does not contain initialize function";X.Kml="Teams";X.sCf=new m.a(r.a.Tq());X.ySd=
null;Object(J.a)(X,"BrowserFeedbackControlOCV",null,[])},994:function(J,V,d){J=d(0);var h=d(340),e=d(657);class m extends e.a{constructor(D,F=null,I=null){super("DeferredContentType");this.title=this.isDeferred=this.messageText=null;this.title=F;this.messageText=D;this.isDeferred=I}}Object(J.a)(m,"DeferredContentProps",e.a,[]);var r=d(26),v=d(911),A=d(912);const w=(D,F)=>Object.assign(new v.a,{target:".EditingRibbonPanel",content:D,useTeachingStyles:!1,showCloseIcon:!0,calloutProps:Object.assign(new A.a,
{directionalHint:6,gapSpace:4,isBeakVisible:!1,preventDismissOnScroll:!0,onDismiss:F,preventDismissOnResize:!0})});var y=d(47);d.d(V,"a",function(){return u});class u{constructor(){this.iT=new m(ResourceStrings.l_DeferredContentDownloadACopyWaitToastMessage,ResourceStrings.l_DeferredContentDownloadACopyWaitDialogTitle,!0)}jJi(D,F,I,H){H=Object.assign(new h.a,{onShow:()=>{I.lK(y.a.ihb)}});F=D.callout(F);return H=D.addNotification(F,H)}vPk(D,F){D.removeNotification(F);r.a.J(523871964,843,10,"DownloadACopy Toast can not be removed!");
return F}zBi(D){return w(this.iT,()=>{D.zo(y.a.ihb)})}}Object(J.a)(u,"DownloadACopyDeferred",null,[484])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.ext.js.map