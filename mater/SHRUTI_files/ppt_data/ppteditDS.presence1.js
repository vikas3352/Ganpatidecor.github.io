'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1005:function(J,V,d){J=d(0);var h;(function(m){m[m.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";m[m.peopleImageClassName=1]="peopleImageClassName";m[m.peopleImageClusterPath=4]="peopleImageClusterPath";m[m.multipleBrowserImageClusterPath=5]="multipleBrowserImageClusterPath";m[m.imageDimension=6]="imageDimension";m[m.rtl=8]="rtl";m[m.pointerInputManager=9]="pointerInputManager";m[m.clickInputManager=
10]="clickInputManager";m[m.vertical=11]="vertical";m[m.zIndex=12]="zIndex";m[m.contextMenuInputManager=13]="contextMenuInputManager";m[m.imageDomElement=14]="imageDomElement";m[m.useIdleTooltip=15]="useIdleTooltip";m[m.viewportBoundsCallback=16]="viewportBoundsCallback";m[m.flipHorizontalDirection=17]="flipHorizontalDirection";m[m.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";m[m.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";m[m.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(h||
(h={}));Object(J.b)("PresenceTooltipSettingKeys",h);d.d(V,"a",function(){return e});class e{constructor(){this.ty={}}get(m,r=null){m=h[m];return"number"===typeof r?(r=this.ty[m])?Number.parseInvariant(r.toString()):0:this.ty[m]}add(m,r){this.ty[h[m]]=r}lD(m,r){h[m]in this.ty||(this.ty[h[m]]=r)}remove(m){delete this.ty[h[m]]}}Object(J.a)(e,"PresenceTooltipSettings",null,[])},1006:function(J,V,d){d.r(V);J=d(0);var h=d(376),e=d(13),m=d(1029),r=d(342),v=d(17);class A{constructor(y){this.messageId=y;this.A1k=
(new Date).getTime();this.Kde=new v.a}}Object(J.a)(A,"MessageLatencyDetails",null,[]);d.d(V,"ClientToClientMessageTelemetry",function(){return w});class w{constructor(y,u,D){this.Soa=null;this.Vyd=this.BDd=0;this.Ic=u;this.sgf=D;this.YRb=!1;this.el=y;this.el.zAa(Object(e.a)(this,this.hKk,"receiveMessage"))}start(){if(this.sgf&&!this.YRb){const y=this.Ic.ejh;this.Vyd=this.Ic.bjh;y<=this.Vyd?(h.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",
this.Ic.ejh,this.Ic.bjh),this.sgf=!1):(this.YRb=!0,this.BDd=window.setInterval(Object(e.a)(this,this.sendMessage,"sendMessage"),y))}}sendMessage(){if(this.YRb){const y=r.a.create().toString();this.Soa=new A(y);this.el.sEe(16,y,!1,new m.a);window.setTimeout(()=>{this.iZj(y)},this.Vyd)}}iZj(y){this.Soa&&this.Soa.messageId===y&&(0<this.Soa.Kde.count?(y=this.Soa.Kde.toArray().join(","),h.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",y)):h.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),
this.Soa=null)}stop(){this.BDd&&(window.clearInterval(this.BDd),this.YRb=!1)}hKk(y,u){16===u.type?this.el.sEe(17,u.iya,!1,new m.a):17===u.type&&this.YRb&&u.iya&&this.qDk(u.iya)}qDk(y){y&&this.Soa&&y.toString()===this.Soa.messageId&&this.Soa.Kde.add((new Date).getTime()-this.Soa.A1k)}static get instance(){return w.Ja}static haj(y,u,D){return w.instance||(w.Ja=new w(y,u,D))}}w.Ja=null;Object(J.a)(w,"ClientToClientMessageTelemetry",null,[])},1101:function(J,V,d){d.r(V);d.d(V,"RealtimeChannelMetrics",
function(){return v});J=d(0);var h=d(376),e=d(172),m=d(101),r=d(187);class v{constructor(){this.Fhf=this.Ghf=this.Hhf=this.Dhf=this.Chf=this.Ehf=this.sQb=this.dAd=0;this.htc=this.ryd=this.EPb=this.hyd=this.iyd=this.$xd=this.aMa=this.yPb=this.Mlb=this.Zxd=this.ftc=this.Zkb=null;this.$yd=this.aQb=this.jwf=this.q_e=0;this.ugf=!1;this.Xdd=this.KEe;this.NEe=this.OEe;this.Ydd=this.MEe;this.Tic=this.QEe;this.Ach=this.PEe;this.XEe=this.YEe;this.UEe=this.VEe;this.lfb=this.SEe;this.Vic=this.TEe;this.vch=this.LEe;
this.OCb=this.mve;this.Zdc=this.nve}KEe(){this.dAd++;this.Zxd=new Date;this.Zkb||(this.Zkb=new Date)}OEe(){this.sQb++;this.aMa=new Date;this.ftc||(this.ftc=this.aMa);this.EPb=this.aMa;this.Isi()}MEe(){this.Ehf++;this.$xd=new Date}QEe(){this.Chf++;this.Mlb=new Date}PEe(){this.Dhf++;this.yPb=new Date}VEe(){this.iyd=new Date;this.Hhf++}TEe(){this.htc||(this.htc=new Date);this.Ghf++}SEe(){this.hyd=new Date;this.Fhf++}YEe(){if(!this.ugf&&this.dAd){var A=this.kFc();h.ULS.sendTraceTag(39321871,500,15,m.a.toJSON(A));
this.ugf=!0}}LEe(A){let w,y;({a7d:A,b7d:w,Wi:y}=r.RtcUtils.u3f(A));A&&A!==e.a.py&&(h.ULS.sendTraceTag(40157596,500,15,m.a.toJSON({["HttpErrorCode"]:A,["HttpErrorStatus"]:w,["Exception"]:y})),e.a.$tg(A)&&this.q_e++,e.a.dzg(A)&&this.jwf++)}mve(){this.ryd=new Date}nve(){this.Mlb=this.EPb=new Date}kFc(){return{["numberOfConnectionAttempts"]:this.dAd,["numberOfSuccessfulConnections"]:this.sQb,["numberOfFailedConnections"]:this.Ehf,["numberOfDisconnectedConnections"]:this.Chf,["numberOfExplicitDisconnectedConnections"]:this.Dhf,
["numberOfSentMessages"]:this.Hhf,["numberOfReceivedMessages"]:this.Ghf,["numberOfLostMessages"]:this.Fhf,["firstConnectionAttempt"]:this.Zkb?this.Zkb:null,["firstMessageReceived"]:this.htc?this.htc:null,["firstConnectionSuccess"]:this.ftc?this.ftc:null,["lastConnectionAttempt"]:this.Zxd?this.Zxd:null,["lastConnectionSuccess"]:this.aMa?this.aMa:null,["lastConnectionFailure"]:this.$xd?this.$xd:null,["lastMessageSent"]:this.iyd?this.iyd:null,["lastMessageLost"]:this.hyd?this.hyd:null,["lastDisconnect"]:this.Mlb?
this.Mlb:null,["lastExplicitDisconnect"]:this.yPb?this.yPb:null,["lastTimeOnline"]:this.EPb?this.EPb:null,["lastTimeOffline"]:this.ryd?this.ryd:null,["maxDisconnectedTimeMs"]:this.aQb,["maxExplicitDisconnectedTimeMs"]:this.$yd,["clientConnectionErrors"]:this.q_e,["serverConnectionErrors"]:this.jwf}}Isi(){this.Zkb&&1===this.sQb&&(this.aQb=Math.max(this.aQb,this.aMa.getTime()-this.Zkb.getTime()));this.Mlb&&1<this.sQb&&(this.aQb=Math.max(this.aQb,this.aMa.getTime()-this.Mlb.getTime()));this.yPb&&1<this.sQb&&
(this.$yd=Math.max(this.$yd,this.aMa.getTime()-this.yPb.getTime()))}static createInstance(A){v.Ja||(v.Ja=new v,h.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",A));return v.Ja}}v.Ja=null;Object(J.a)(v,"RealtimeChannelMetrics",null,[1393,241])},1102:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.OKb=e;this.tZf=m}}Object(J.a)(h,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1103:function(J,V,d){d.d(V,
"a",function(){return h});J=d(0);var h;(function(e){e[e.unspecified=0]="unspecified";e[e.word=1]="word";e[e.excel=2]="excel";e[e.powerPoint=3]="powerPoint";e[e.test=4]="test";e[e.wacFrontEnd=5]="wacFrontEnd";e[e.oneNote=6]="oneNote";e[e.visio=7]="visio";e[e.officeMobile=8]="officeMobile";e[e.cosmosDBChangefeed=9]="cosmosDBChangefeed";e[e.last=10]="last"})(h||(h={}));Object(J.b)("RtcClientAppName",h)},1107:function(J,V,d){J=d(0);var h=d(376),e=d(13),m=d(229),r=d(230);class v{static A_d(Z,qa,ya){return v.B_d(Z,
qa,ya,!0)}static B_d(Z,qa,ya,Ka){const Da=document.createElementNS(v.ijb,"svg");Da.setAttribute("viewBox",String.format(v.DSd,v.Ipc,v.Hpc));Da.appendChild(v.F3d(Z,qa,ya,Ka));return Da}static F3d(Z,qa,ya,Ka){const Da=v.Ipc/Z,la=qa/2*Da,ma=v.Hpc/2;let Ea=0;Ka&&(Ea=(Z-3*qa-4*ya)*Da/2);Z=document.createElementNS(v.ijb,"g");Sys.UI.DomElement.addCssClass(Z,v.CSd);for(Ka=1;3>=Ka;Ka++)Z.appendChild(v.a_d(Ka,la,Ea+(Ka*(qa+ya)-qa/2)*Da,ma));return Z}static a_d(Z,qa,ya,Ka){const Da=document.createElementNS(v.ijb,
"circle");Sys.UI.DomElement.addCssClass(Da,String.format("{0}-{1}",v.mOd,Z));Da.setAttribute("cx",String.format("{0}",ya));Da.setAttribute("cy",String.format("{0}",Ka));Da.setAttribute("r",String.format("{0}",qa));return Da}}v.ijb="http://www.w3.org/2000/svg";v.CSd="prDancingDots";v.mOd="prAnimateCircle";v.DSd="0 0 {0} {1}";v.Hpc=40;v.Ipc=120;Object(J.a)(v,"ModernPresenceTooltipDancingDots",null,[]);var A=d(25),w=d(170),y=d(73),u=d(65),D=d(133),F=d(196),I=d(95),H=d(45),L=d(2);class E extends m.a{constructor(Z,
qa){super(Z);this.hTb=this.zR=this.R_a=this.AM=this.vM=this.Qo=this.zn=null;this.OH=qa.get(8,!1);this.wR=qa.get(6,0);this.qGd=qa.get(15,!1);this.Ic=qa;this.CNb=0;this.element=Z;this.element.className=E.p6a;this.Gs=document.createElement("span");this.element.appendChild(this.Gs);this.xtd=v.A_d(qa.get(6,0),4,2);this.oJ(qa);this._state=5}vV(Z){this.addHandler(r.a.Zo,Z)}p0(Z){this.removeHandler(r.a.Zo,Z)}get user(){return this.hTb}get state(){return this._state}dispose(){this.element&&(this.zn.xb(u.a.click,
this.element,Object(e.a)(this,this.onClick,"onClick")),this.zn.xb(u.a.doubleClick,this.element,Object(e.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),this.Qo.xb(u.a.pointerDown,this.element,Object(e.a)(this,this.Pva,"onPointerDown")),this.Qo.xb(u.a.pointerOut,this.element,Object(e.a)(this,this.iz,"onPointerOut")),this.Qo.xb(u.a.pointerOver,this.element,Object(e.a)(this,this.zC,"onPointerOver")),this.vM.xb(this.element,Object(e.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")));
super.dispose()}oJ(Z){this.zn=Z.get(10);this.zn.ob(u.a.click,this.element,Object(e.a)(this,this.onClick,"onClick"));this.zn.ob(u.a.doubleClick,this.element,Object(e.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior"));this.Qo=Z.get(9);this.Qo.ob(u.a.pointerOver,this.element,Object(e.a)(this,this.zC,"onPointerOver"));this.Qo.ob(u.a.pointerOut,this.element,Object(e.a)(this,this.iz,"onPointerOut"));this.Qo.ob(u.a.pointerDown,this.element,Object(e.a)(this,this.Pva,"onPointerDown"));this.vM=Z.get(13);
this.vM.ob(this.element,Object(e.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior"))}hide(Z=null,qa=0,ya=0){this.qGd&&Z?this.fOe(Z,qa,ya):(3===this.state&&this.rjc(),this.visible=!1,this._state=5)}fOe(Z,qa,ya=0){this.show(Z,qa,15,4,void 0,ya)}emc(Z,qa,ya,Ka=!1,Da=!1,la=!1,ma=0){this.show(Z,qa,ya+20,Ka?2:Da?1:0,la,ma)}ONe(Z,qa,ya,Ka=!1,Da=0){this.show(Z,qa,ya+20,3,Ka,Da)}show(Z,qa,ya,Ka=3,Da=!1,la=0){!Z||Ka===this.state&&this.h6d(qa,ya)||(this.uHd(Ka,Da,la),this.Fx(Z,Ka,la),this._state=Ka,
4===la||0===la&&!this.OH?this.element.style.left=qa+"px":this.element.style.right=qa+"px",this.element.style.top=ya+"px",this.visible=!0)}Fx(Z,qa,ya){this.hTb=Z;I.a.ku(this.Gs);F.a.cQf(this.Gs);this.Gs.id="fly_"+Z.clientId;this.Gs.style.backgroundColor=Z.color;4!==qa?(this.Gs.style.height=this.wR+"px",this.Gs.style.lineHeight=this.wR+"px",F.a.dY(this.Gs,"border-radius",this.wR+"px")):4===ya||0===ya&&!this.OH?this.Gs.style.left="0px":this.Gs.style.right="0px";2!==qa&&(4===qa?I.a.wx(this.Gs,""):1===
qa?this.Gs.appendChild(this.xtd):(this.Gs.setAttribute("dir","auto"),ya=H.a.N0d(Z.userName,!1),(!Z.isAnonymous||A.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&ya||0!==qa?(Z=Z.userName,0===qa&&(Z=ya,F.a.dY(this.Gs,"text-align","center")),I.a.wx(this.Gs,Z)):(this.AM||(this.AM=this.JQd()),this.Gs.appendChild(this.AM),F.a.dY(this.Gs,"text-align","start"))))}onClick(Z){if(0===this.state)return this.raiseEvent(r.a.Zo,new r.a(1,Z)),!0;
3===this.state&&h.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1}iz(Z){3===this.state&&this.raiseEvent(r.a.Zo,new r.a(3,Z));return!1}zC(Z){3!==Z.Wf&&this.raiseEvent(r.a.Zo,new r.a(2,Z));return!1}Pva(Z){if(3!==Z.Wf)return!0;this.raiseEvent(r.a.Zo,new r.a(4,Z));return!1}JQd(){const Z=document.createElement("img");Z.src=w.a.uK("doughperson_white_glyph.svg");Z.setAttribute("Unselectable","on");D.a.BO(Z,D.a.Ye,D.a.KM);return y.createClusteredImageFromClusterWithImageClass(this.wR,
this.wR,null,null,E.nYd,"",!1,"",this.element.ownerDocument,Z)}uHd(Z,qa=!1,ya=0){if(!this.zja(this.state)||!this.zja(Z))switch(Sys.UI.DomElement.removeCssClass(this.element,this.R_a),this.state){case 4:3===Z?this.IM(E.q6a,E.P_b):this.zja(Z)&&this.IM(E.o6a,E.P_b);break;case 3:4===Z?this.IM(E.s6a,E.O_b):this.zja(Z)&&(qa&&this.rjc(),this.IM(E.o6a,E.O_b,qa?E.mYd:""));break;case 0:case 1:case 2:4===Z?this.IM(E.s6a,E.r6a):3===Z&&(qa&&this.HHd(),this.IM(E.q6a,E.r6a,qa?E.Q_b:"",3===ya?E.pYd:E.oYd));break;
default:4===Z?this.IM(E.s6a):3===Z?this.IM(E.q6a):this.zja(Z)&&this.IM(E.o6a)}}IM(...Z){this.R_a=Z.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.R_a)}HHd(){this.CNb=window.setTimeout(()=>{this.element&&(this.zR=this.element.cloneNode(!0),this.element.parentNode.appendChild(this.zR),this.element.style.zIndex="2",this.zR.style.zIndex="1")},300)}rjc(){window.clearTimeout(this.CNb);this.zR&&(Sys.UI.DomElement.removeCssClass(this.zR,E.r6a+" "+E.Q_b),Sys.UI.DomElement.addCssClass(this.zR,E.lYd),
L.Task.delay(300).continueWith(()=>{this.element&&this.element.parentNode===this.zR.parentNode&&this.element.parentNode.removeChild(this.zR)}),F.a.NFb(this.element,"z-index"))}zja(Z){return 0===Z||1===Z||2===Z}h6d(Z,qa){const ya=F.a.lH(this.element.style.top);return F.a.lH(this.element.style.left)===Z&&ya===qa}Pfb(Z){3===Z&&F.a.wP(this.element,"left")?(Z=F.a.lH(this.element.style.left),F.a.NFb(this.element,"left"),this.element.style.right=-1*Z+"px"):4===Z&&F.a.wP(this.element,"right")&&(Z=F.a.lH(this.element.style.right),
F.a.NFb(this.element,"right"),this.element.style.left=-1*Z+"px")}}E.p6a="prModernFlyout UIFont";E.s6a="flyoutIdle";E.q6a="flyoutExpanded";E.o6a="flyoutCollapsed";E.P_b="flyoutFromIdle";E.O_b="flyoutFromExpanded";E.r6a="flyoutFromCollapsed";E.Q_b="flyoutStacked";E.mYd="flyoutFromStacked";E.lYd="flyoutFadeOut";E.nYd="cui-img-cont-float cui-img-20by20";E.oYd="flyoutLtrDir";E.pYd="flyoutRtlDir";Object(J.a)(E,"ModernPresenceTooltipFlyoutControl",m.a,[]);class aa{constructor(Z,qa,ya=2,Ka=4){this.offsetTop=
Z;this.offsetLeft=qa;this.zpc=ya;this.n3b=Ka}}Object(J.a)(aa,"FlyoutsPositioningInfo",null,[]);var Q=d(63);class O{constructor(Z=!1,qa=!1){this.Qi=Z;this.x0a=qa}V0d(Z,qa,ya,Ka,Da,la,ma){const Ea=ma.y,ta=ma.height;var Ga=this.TZd(la);const oa=Ga+qa;Da=Z*ya+(Z-1)*Da;ya=null;1===Z||this.kNd(Ga,Da,Ea,ta)?Z=new aa(0,0,2):(Z=this.ZXd(oa,Da,Ea,ta),Z.offsetTop-=Ga);this.x0a?ya=new aa(0,0,void 0,this.Qi?4:3):(la=this.SZd(la,ma),Ga=Math.max(0,ma.x),ma=ma.width,qa=la+qa,this.lNd(la,Ka,Ga,ma)?ya=new aa(0,0,void 0,
this.Qi?3:4):this.mNd(qa,Ka,Ga)&&(ya=new aa(0,0,void 0,this.Qi?4:3)),ya||(ya=this.YXd(la,qa,Ga,ma)));return new aa(Z.offsetTop,ya.offsetLeft,Z.zpc,ya.n3b)}TZd(Z){return Q.a.nMc(Z)}SZd(Z,qa){return this.Qi?qa.width-Q.a.h9f(Z):Q.a.mMc(Z)}kNd(Z,qa,ya,Ka){return Z+qa<=ya+Ka}ZXd(Z,qa,ya,Ka){let Da=1,la=Math.max(ya,Z-qa);qa>Z-ya&&(Da=2,la=qa<Ka?Ka-qa:ya);return new aa(la,0,Da)}lNd(Z,qa,ya,Ka){return Z+qa<=ya+Ka}mNd(Z,qa,ya){return qa<=Z-ya}YXd(Z,qa,ya,Ka){Ka-qa>=Z-ya?Z=4:(qa=Z,Z=3);return new aa(0,qa,void 0,
Z)}}Object(J.a)(O,"ModernPresenceTooltipPositioner",null,[]);class T{constructor(Z,qa,ya,Ka,Da,la,ma){this.Kv=Z;this._parent=qa;this.nMb=ya;this.Xrd=Ka;this.Dvd=Da;this.J6=la;this.OH=ma;this._element=document.createElement("div");this.element.className="prTouchTarget"}get element(){return this._element}update(Z,qa){if(3!==Z)if(5!==Z&&this.Kv&&this.Kv.length){if(4===Z){var ya=this.Dvd;var Ka=(this.J6-ya)/2;this.element.style.height=this.J6+"px";this.element.style.width=this.J6+"px";Z=F.a.lH(this.Kv[0].element.style.top);
qa=F.a.lH(this.OH?this.Kv[0].element.style.right:this.Kv[0].element.style.left)}else ya=this.nMb,Ka=(this.J6-ya)/2,this.element.style.height=this.J6+"px",this.element.style.width=this.h_d()+2*Ka+"px",Z=F.a.lH(this.Kv[this.Kv.length-1].element.style.top),qa=this.$Md(this.Kv[this.Kv.length-1].element,ya,qa);F.a.dY(this.element,"border-radius",this.J6+"px");this.element.style.top=Z-Ka-ya+"px";this.OH?this.element.style.right=qa-Ka+"px":this.element.style.left=qa-Ka+"px";this.element.parentNode||this._parent.insertBefore(this.element,
this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)}$Md(Z,qa,ya){return this.OH&&!ya?F.a.lH(Z.style.right):this.OH||ya?this.OH&&ya?-F.a.lH(Z.style.left)-qa:-F.a.lH(Z.style.right)-qa:F.a.lH(Z.style.left)}h_d(){return this.Kv&&this.Kv.length?this.nMb+Math.min(this.Kv.length-1,2)*this.Xrd:0}}Object(J.a)(T,"ModernPresenceTooltipTarget",null,[]);var K=d(72),X=d(115),P=d(198);class ea extends m.a{constructor(Z,qa,ya){super(Z);this.D6=this.HH=this.DOb=
this.OY=!1;this.xf=[];this.fza={};this.Ic=ya;this.Qi=ya.get(8,!1);this.oOb=ya.get(15,!1);this.Hsd=ya.get(12,0);this.gS=ya.get(6,0);this.B2a=qa;this.jTb=ya.get(16);this.x0a=ya.get(17,!1);this.Fvd=ya.get(19,!1);this.ABd=ya.get(20,!1);this.lza=0;this.tBd=new O(this.Qi,this.x0a);this.Nfa=this.G0b();this.T1a=!1;this.sM=[];this.qga=[];this.element.id=ea.F6a();this.element.className=m.a.Sqb("prControl",this.Qi);this.defaultZIndex&&(this.zIndex=this.defaultZIndex);this.rtl=this.Qi;this.Fgb(qa);this.LE=this.createElement("div");
this.LE.className="prFlyoutContainer";this.element.appendChild(this.LE);this.Kv=[];this.ER=new T(this.Ks,this.element,this.gS,4,6,32,this.Qi);this.Qo=ya.get(9);this.Qo.ob(u.a.pointerDown,this.ER.element,Object(e.a)(this,this.c$,"onHitTarget"));this.Qo.ob(u.a.pointerOver,this.ER.element,Object(e.a)(this,this.c$,"onHitTarget"));this.Qo.ob(u.a.pointerOut,this.ER.element,Object(e.a)(this,this.c$,"onHitTarget"))}get Leb(){return P.a.clone(this.xf)}get Ks(){return this.Kv}get defaultZIndex(){return this.Hsd}get dN(){return this.Ks?
this.Ks.length:0}get IU(){return 0<this.dN?this.Ks[0].state:5}get W8a(){return 3===this.IU&&!this.OY}vV(Z){this.addHandler(r.a.Zo,Z)}p0(Z){this.removeHandler(r.a.Zo,Z)}dispose(){if(this.W8a)this.T1a=!0;else{if(this.Ks)for(const Z of this.Ks)Z.p0(Object(e.a)(this,this.IF,"onInteractivityChanged")),X.a.rx(Z);this.Kv=null;this.Qo.xb(u.a.pointerDown,this.ER.element,Object(e.a)(this,this.c$,"onHitTarget"));this.Qo.xb(u.a.pointerOver,this.ER.element,Object(e.a)(this,this.c$,"onHitTarget"));this.Qo.xb(u.a.pointerOut,
this.ER.element,Object(e.a)(this,this.c$,"onHitTarget"));super.dispose()}}jfa(){this.pZ();this.visible=!0}vhb(){this.visible=!0;this.b_b();this.OY=!0}mxa(){this.vhb()}hide(){this.sjc();this.lN();this.ER.update(this.IU,this.D6)}Fx(Z){const qa=this.IU,ya=this.OY;Z.clientId||(Z.clientId=(ea.vga++).toString());if(Z.clientId in this.fza){var Ka=this.vS(Z.clientId);if(0<=Ka){Ka=this.xf[Ka];if(Ka.color===Z.color&&Ka.userName===Z.userName)return;this.qJ(Z.clientId)}}this.hide();Ka=new E(this.createElement("div"),
this.Ic);Ka.vV(Object(e.a)(this,this.IF,"onInteractivityChanged"));this.LE.insertBefore(Ka.element,this.LE.firstChild);this.fza[Z.clientId]=Ka;Array.add(this.xf,Z);Array.add(this.Ks,Ka);this.epc(qa,ya);this.visible=!0}qJ(Z){if(this.W8a)Array.add(this.qga,Z);else{var qa=this.IU,ya=this.OY;this.hide();this.Sma(Z);this.epc(qa,ya)}}Adb(Z){const qa=this.vS(Z);if(!(0>=qa)){var ya=this.xf[qa];Z=this.fza[Z];Array.removeAt(this.xf,qa);Array.insert(this.xf,0,ya);Array.removeAt(this.Ks,qa);Array.insert(this.Ks,
0,Z);this.LE.removeChild(Z.element);this.LE.appendChild(Z.element);this.pZ()}}epc(Z,qa){0>=this.xf.length?this.hide():3===Z&&qa?this.vhb():this.jfa()}$gb(Z,qa){qa?this.nHd(Z):this.ljc(Z)}WZb(Z){if(this.W8a&&this.Fvd)return!1;Z=ea.q7a(Z);if(this.LE!==Z&&I.a.Qsa(this.LE,Z))return!0;for(const qa of this.Ks)if(I.a.Qsa(qa.element,Z))return!0;return!1}position(Z,qa){this.element.style.top=qa+"px";this.element.style.left=Z+"px"}pZ(Z=!1){if(!Z||this.HH){this.DOb&&this.ilc(!0);var qa=Math.min(3,this.dN)-1;
Z=0;var ya=1,Ka=0;this.D6&&(Z=this.Nfa,ya=-1,Ka=-this.gS);for(let Da=this.dN-1;Da>qa;Da--)this.Ks[Da].emc(this.xf[Da],-4*qa*ya+Ka,0,!0,!1,!0,Z);for(;0<=qa;qa--)this.Ks[qa].emc(this.xf[qa],-4*qa*ya+Ka,0,0<qa,Array.contains(this.sM,this.xf[qa].clientId),qa!==this.lza,Z);this.lza=0;this.ER.update(0,this.D6);this.zIndex=this.defaultZIndex;this.OY=!1;this.sjc(0);this.T1a&&this.dispose()}}b_b(){this.DOb&&this.ilc(!1);this.zIndex=this.defaultZIndex+1;let Z,qa,ya;({offsetX:qa,offsetY:Z,m3b:ya}=this.WKe());
for(let Ka=0;Ka<this.dN;Ka++)this.Ks[Ka].ONe(this.xf[Ka],qa,Z+(this.gS+2)*Ka,Ka!==this.lza,ya)}lN(){let Z=0,qa=0;this.D6&&(Z=this.Nfa,qa=-6);for(let ya=0;ya<this.dN;ya++)this.Ks[ya].hide(this.xf[ya],qa,Z);this.zIndex=this.defaultZIndex;this.visible=this.OY=!1;this.T1a&&this.dispose()}D4a(Z=0){Z?(this.HH=!0,L.Task.delay(Z).continueWith(()=>{this.oOb?this.J6d():this.pZ(!0);this.HH=!1})):this.oOb?this.hide():this.pZ()}J6d(){this.HH&&this.hide()}KLd(){if(A.AFrameworkApplication.Aa&&A.AFrameworkApplication.Aa.jb.m8&&
K.c()){const Z=appChrome.selectors.getShyState();return Z.isActive&&0!==Z.state}return!1}IF(Z,qa){Z=this.IU;this.KLd()||2!==qa.type&&(4!==qa.type||3===Z)?4===qa.type&&3===Z?(this.HH&&(this.HH=!1),this.D4a()):3!==qa.type||3!==Z||this.OY||(1<this.dN?(this.HH=!0,L.Task.delay(250).continueWith(()=>{this.pZ(!0);this.HH=!1})):this.D4a()):(this.HH&&(this.HH=!1),3!==Z&&(this.b_b(),3===qa.Vi.Wf&&this.D4a(2E3)));this.raiseEvent(r.a.Zo,qa)}c$(Z){3===Z.Wf?this.IF(this,new r.a(4,Z)):Z.eventName===u.a.pointerOver?
this.IF(this,new r.a(2,Z)):Z.eventName===u.a.pointerOut&&this.IF(this,new r.a(3,Z));return!1}Fgb(Z){this.element.style.width=Z+"px";this.element.style.height=this.gS+"px"}Sma(Z){this.ljc(Z);Z=this.vS(Z);if(!(0>Z)){var qa=this.xf[Z];Array.removeAt(this.xf,Z);delete this.fza[qa.clientId];qa=this.Ks[Z];this.LE.removeChild(qa.element);this.Ic.get(18,!1)&&qa.p0(Object(e.a)(this,this.IF,"onInteractivityChanged"));Array.removeAt(this.Ks,Z);qa.dispose()}}sjc(Z=5){if(this.qga.length){this.visible&&this.lN();
for(let qa=0;qa<this.qga.length;qa++)this.Sma(this.qga[qa]);Array.clear(this.qga);0>=this.xf.length||5===Z?this.hide():0===Z&&this.jfa()}}vS(Z){for(let qa=0;qa<this.xf.length;qa++)if(this.xf[qa].clientId===Z)return qa;return-1}nHd(Z){if(-1===this.vS(Z))h.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.sM,Z)){if(this.xf[0].clientId===Z)return;Array.remove(this.sM,Z)}Array.add(this.sM,Z);this.Adb(Z);1!==this.IU&&this.pZ()}}ljc(Z){-1===
this.vS(Z)?h.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.sM,Z)&&(Array.remove(this.sM,Z),this.xf[0].clientId===Z&&0<this.sM.length&&this.Adb(this.sM[this.sM.length-1]),this.xf[0].clientId===Z&&1===this.IU&&this.pZ())}ilc(Z){Z?Sys.UI.DomElement.addCssClass(this.LE,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.LE,"prBackgroundSelection")}WKe(){let Z,qa;qa=Z=0;var ya=this.Nfa;if(this.jTb){const Ka=this.jTb(this);if(!Ka)return{offsetX:Z,
offsetY:qa,m3b:ya};const Da=4===this.IU;ya=this.tBd.V0d(this.dN,Da?6:this.gS,this.gS,150,2,this.element,Ka);qa=ya.offsetTop;this.lza=this.M0d(ya.zpc,ya.offsetTop);ya=ya.n3b;ya!==this.Nfa&&(this.Pfb(ya),this.element.dir=3===ya?"rtl":"ltr",this.Nfa=ya);ya!==this.G0b()?(Z=this.ABd?-2:Da?-6:-this.gS,this.D6=!0):this.D6=!1}return{offsetX:Z,offsetY:qa,m3b:ya}}M0d(Z,qa){if(1===Z)return this.dN-1;Z=Math.abs(qa);return 0<Z?Z/(this.gS+2):0}Pfb(Z){for(let qa=0;qa<this.dN;qa++)this.Ks[qa].Pfb(Z)}G0b(){return this.Qi?
3:4}static F6a(){return String.format("{0}-{1}","presencetooltip",ea.vga++)}static q7a(Z){return Z.mc.rawEvent.relatedTarget}}ea.vga=0;Object(J.a)(ea,"ModernPresenceTooltipControl",m.a,[572,106]);var ia=d(219),ja=d(285),C=d(265);d.d(V,"a",function(){return pa});class pa{constructor(Z){this.Ic=Z;this.Ic.lD(10,ia.a.instance);this.Ic.lD(9,C.a.instance);this.Ic.lD(6,20);this.Ic.lD(13,ja.a.instance);this.Ic.lD(17,!1)}CGc(Z,qa){this.Ic.lD(15,!1);return new ea(Z,qa,this.Ic)}Lqb(Z){this.Ic.lD(15,!1);return new ea(Z,
20,this.Ic)}}Object(J.a)(pa,"ModernPresenceTooltipFactory",null,[571])},1110:function(J,V,d){J=d(0);var h=d(13),e=d(1166),m=d(229),r=d(230),v=d(65),A=d(95);class w extends m.a{constructor(Q,O){super(Q);this.xf=null;this.OH=O.get(8,!1);this.wR=O.get(6,0);this.element=Q;this.element.className=w.p6a;this.Y2a=this.createElement("ul");this.element.appendChild(this.Y2a);this.zn=O.get(10);this.zn.ob(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick"));this.Qo=O.get(9);this.Qo.ob(v.a.pointerOut,
this.element,Object(h.a)(this,this.iz,"onPointerOut"));this.Qo.ob(v.a.pointerDown,this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior"));this.vM=O.get(13);this.vM.ob(this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior"))}vV(Q){this.addHandler(r.a.Zo,Q)}p0(Q){this.removeHandler(r.a.Zo,Q)}get U$(){return this.xf}dispose(){this.element&&(this.zn.xb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.Qo.xb(v.a.pointerDown,this.element,
Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),this.Qo.xb(v.a.pointerOut,this.element,Object(h.a)(this,this.iz,"onPointerOut")),this.vM.xb(this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")));super.dispose()}hide(){this.visible=!1}show(Q,O,T){this.hide();!Q||0>=Q.length||(this.OH?this.element.style.right=O+"px":this.element.style.left=O+"px",this.element.style.top=T+"px",this.lId(Q),this.visible=!0)}lId(Q){this.xf=Q;A.a.ku(this.Y2a);for(let O=
Q.length-1;0<=O;O--)this.Fx(Q[O])}Fx(Q){const O=document.createElement("li");O.style.backgroundColor=Q.color;O.style.height=this.wR+"px";O.id="fly_"+Q.clientId;O.style.lineHeight=this.wR+"px";A.a.wx(O,Q.userName);O.setAttribute("dir","auto");this.Y2a.appendChild(O)}onClick(){this.hide();return!1}iz(Q){this.raiseEvent(r.a.Zo,new r.a(3,Q));return!1}}w.p6a="prFlyout UIFont";Object(J.a)(w,"PresenceTooltipFlyoutControl",m.a,[]);var y=d(73);class u extends m.a{constructor(Q,O,T){super(Q);this.AM=null;this.xf=
[];this.element.className="prGlyph";this.Ic=O;this.B6=this.Ic.get(9);this.en=this.Ic.get(10);this.vM=this.Ic.get(13);this.O6d();this.Fx(T);this.a1a=!1}get nO(){return this.xf.length}get U$(){return this.xf}vV(Q){this.addHandler(r.a.Zo,Q)}p0(Q){this.removeHandler(r.a.Zo,Q)}dispose(){this.BUe();super.dispose()}Fx(Q){Array.add(this.xf,Q);2===this.nO?this.R$(!0):1===this.nO?this.R$(!1):this.R$(this.a1a)}qJ(Q){this.yXd(Q)&&(1<this.nO&&this.R$(!0),1===this.nO?this.R$(!1):1>this.nO&&this.hide())}show(){this.R$(2<=
this.nO);this.visible=!0}hide(){this.visible=!1}I0d(Q){return Q?this.y0b(0,5):this.y0b(1,4)}yXd(Q){for(let O=0;O<this.nO;O++)if(this.xf[O].clientId===Q)return Q=this.xf[O],Array.removeAt(this.xf,O),Q;return null}R$(Q){this.a1a!==Q&&(this.AM&&this.element.removeChild(this.AM),this.AM=this.I0d(Q),this.element.appendChild(this.AM),this.a1a=Q);this.AM.childNodes[0].style.backgroundColor=this.xf[this.xf.length-1].color}y0b(Q,O){const T=this.Ic.get(6,0),K=this.Ic.get(14);return y.createClusteredImageFromClusterWithImageClass(T,
T,this.Ic.get(Q),this.Ic.get(O),"cui-img-cont-float cui-img-16by16","",!1,"",this.element.ownerDocument,K?K.cloneNode(!0):null)}zC(Q){3!==Q.Wf&&this.raiseEvent(r.a.Zo,new r.a(2,Q));return!1}onClick(Q){this.raiseEvent(r.a.Zo,new r.a(1,Q));return!0}iz(Q){3!==Q.Wf&&this.raiseEvent(r.a.Zo,new r.a(3,Q));return!1}BUe(){this.element&&(this.B6.xb(v.a.pointerDown,this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),this.B6.xb(v.a.pointerOver,this.element,Object(h.a)(this,this.zC,
"onPointerOver")),this.B6.xb(v.a.pointerOut,this.element,Object(h.a)(this,this.iz,"onPointerOut")),this.en.xb(v.a.doubleClick,this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),this.en.xb(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.vM.xb(this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")))}O6d(){this.element&&(this.B6.ob(v.a.pointerDown,this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),
this.B6.ob(v.a.pointerOver,this.element,Object(h.a)(this,this.zC,"onPointerOver")),this.B6.ob(v.a.pointerOut,this.element,Object(h.a)(this,this.iz,"onPointerOut")),this.en.ob(v.a.doubleClick,this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")),this.en.ob(v.a.click,this.element,Object(h.a)(this,this.onClick,"onClick")),this.vM.ob(this.element,Object(h.a)(this,this.yx,"stopPropagationAndPreventDefaultBehavior")))}}Object(J.a)(u,"PresenceTooltipGlyph",m.a,[]);var D=d(115);
d(63);var F=d(198);class I extends m.a{constructor(Q,O,T){super(Q);this.xf=[];this.Vl=[];this.LH=0;this.Yga=this.i6=!1;this.yLb=null;this.pga={};this.Ic=T;this.Qi=T.get(8,!1);this.eG=T.get(11,!1);Q=T.get(12,0);this.imageDimension=T.get(6,0);this.B2a=O;this.element.id=I.F6a();this.element.className=m.a.Sqb("prControl",this.Qi);Q&&(this.zIndex=Q);this.rtl=this.Qi;this.Fgb(O);this.vz=this.createElement("div");this.vz.className=this.eG?"prContainerV":"prContainerHr";this.element.appendChild(this.vz);
this.ONb=Array(this.LH);for(O=0;O<this.LH;O++)this.Tv[O]=new w(this.createElement("div"),this.Ic),this.Tv[O].vV(Object(h.a)(this,this.IF,"onInteractivityChanged")),this.element.appendChild(this.Tv[O].element)}get Leb(){return F.a.clone(this.xf)}getGlyph(Q){return this.pga[Q]}get Tv(){return this.ONb}get FTb(){return this.yLb}get xJa(){return this.imageDimension+2}get width(){return this.eG?this.xJa:this.B2a}get height(){return this.eG?this.B2a:this.xJa}vV(Q){this.addHandler(r.a.Zo,Q)}p0(Q){this.removeHandler(r.a.Zo,
Q)}dispose(){if(this.Tv)for(const Q of this.Tv)Q.p0(Object(h.a)(this,this.IF,"onInteractivityChanged")),D.a.rx(Q);D.a.rgd(this.Vl);this.Vl=this.ONb=null;super.dispose()}jfa(){this.lN();this.thb();this.visible=!0;this.i6=!1}vhb(){!this.Vl||1>this.Vl.length||(this.lN(),this.visible=!0,this.thb(),this.WHa(this.Vl[this.Vl.length-1]),this.i6=!0)}mxa(){if(this.Vl&&!(1>this.Vl.length)){this.visible=!0;this.thb();var Q=0;for(const O of this.Vl)this.WHa(O,Q++);this.i6=!1;this.Yga=!0}}hide(){this.visible=!1;
this.lN();for(let Q=0;Q<this.Vl.length;Q++)this.Vl[Q].hide();this.i6=!1}fWb(){if(!this.Yga)return!1;let Q=0;for(const O of this.Tv)O.visible&&Q++;return this.Yga=0<Q&&(this.xf.length<=this.LH?Q===this.xf.length:Q===this.LH)}Fx(Q){if(!(0>=this.LH)){Q.clientId||(Q.clientId=(I.vga++).toString());if(Q.clientId in this.pga){var O=this.vS(Q.clientId);if(0<=O){O=this.xf[O];if(O.color===Q.color&&O.userName===Q.userName)return;this.qJ(Q.clientId)}}O=this.fWb();var T=0;if(this.xf.length<this.LH){var K=new u(this.createElement("div"),
this.Ic,Q);K.vV(Object(h.a)(this,this.IF,"onInteractivityChanged"));this.Qi&&!this.eG&&0<this.xf.length?this.vz.insertBefore(K.element,this.vz.firstChild):(this.vz.appendChild(K.element),T=this.Vl.length);Array.add(this.Vl,K)}else this.Qi&&!this.eG?K=this.Vl[0]:(T=this.Vl.length-1,K=this.Vl[T]),K.Fx(Q);K.show();this.pga[Q.clientId]=K;Array.add(this.xf,Q);this.Woc(K,T);O&&this.mxa()}}qJ(Q){const O=this.fWb();O&&this.lN();this.Sma(Q);this.xf.length>=this.LH&&this.Vl.length<this.LH&&this.IEe();0>=this.xf.length?
this.hide():O&&this.mxa()}Adb(){}Sma(Q){var O=this.vS(Q);0>O||(Q=this.xf[O],Array.removeAt(this.xf,O),O=this.pga[Q.clientId],delete this.pga[Q.clientId],O.qJ(Q.clientId),this.Woc(O),0>=O.nO&&(this.vz.removeChild(O.element),Array.remove(this.Vl,O),O.dispose()))}$gb(){}IEe(){var Q=this.R1d();!Q||1>=Q.U$.length||(Q=Array.clone(this.xf),Q.forEach(O=>{this.Sma(O.clientId)}),Q.forEach(O=>{this.Fx(O)}))}vS(Q){for(let O=0;O<this.xf.length;O++)if(this.xf[O].clientId===Q)return O;return-1}R1d(){return this.Qi&&
!this.eG?this.Vl[0]:this.Vl[this.Vl.length-1]}position(Q,O){this.element.style.top=O+"px";this.element.style.left=Q+"px"}thb(){for(let Q=0;Q<this.Vl.length;Q++)this.Vl[Q].show()}lN(){for(let Q=0;Q<this.LH;Q++)this.Tv[Q].hide();this.Yga=!1}WHa(Q,O=0){if(Q)if(this.yLb=Q,this.eG){const T=this.imageDimension;if(1<Q.U$.length)this.Tv[O].show(Q.U$,T,this.height-this.imageDimension);else{const K=this.vz.children.length;for(let X=0;X<this.vz.children.length;X++)Q.element===this.vz.children[X]&&this.Tv[O].show(Q.U$,
T,this.height-(K-X)*this.xJa+2)}}else this.Tv[O].show(Q.U$,this.width,0)}IF(Q,O){var T=Object(e.a)(u,Q);T=T?this.q_b(T):-1;if(2===O.type||1===O.type&&-1!==T&&!this.Tv[T].visible)this.WHa(Q);else if(1===O.type)this.lN(),this.i6=!1;else if(3===O.type){if(this.WZb(O.Vi))return;this.i6||this.lN()}this.raiseEvent(r.a.Zo,O)}WZb(Q){Q=I.q7a(Q);let O=!1;for(const T of this.Tv)if(A.a.Qsa(T.element,Q)){O=!0;break}return this.vz!==Q&&A.a.Qsa(this.vz,Q)||O}Woc(Q,O=0){const T=this.J9d(Q);T&&0>=Q.nO?this.Tv[O].hide():
T?this.WHa(Q):this.Tv[O].hide()}q_b(Q){let O=0;for(const T of this.Vl){if(Q===T)return O;O++}return-1}J9d(Q){const O=this.q_b(Q);return!!this.FTb&&Q===this.FTb&&-1!==O&&this.Tv[O].visible}Fgb(Q){this.LH=Q===this.imageDimension?1:Math.floor(Q/this.xJa);this.eG?(this.element.style.height=Q+"px",this.element.style.width=this.imageDimension+"px"):(this.element.style.width=Q+"px",this.element.style.height=this.imageDimension+"px")}static F6a(){return String.format("{0}-{1}","presencetooltip",I.vga++)}static q7a(Q){Q=
Q.mc.rawEvent;return Q.relatedTarget||Q.toElement}}I.vga=0;Object(J.a)(I,"PresenceTooltipControl",m.a,[572,106]);var H=d(219),L=d(285),E=d(265);d.d(V,"a",function(){return aa});class aa{constructor(Q){this.Ic=Q;this.Ic.lD(10,H.a.instance);this.Ic.lD(9,E.a.instance);this.Ic.lD(6,16);this.Ic.lD(13,L.a.instance)}CGc(Q,O){return new I(Q,O,this.Ic)}Lqb(Q){return new I(Q,16,this.Ic)}}Object(J.a)(aa,"PresenceTooltipFactory",null,[571])},1210:function(J,V,d){d.r(V);var h=d(0),e=d(376),m=d(13),r=d(17),v=d(77),
A=d(78),w=d(35),y=d(2);class u{constructor(Sa,rb,pc,cd,zd,wd,Oa,jb,qc=!1){this.NKa=null;this.jud=!0;this.BBd=this.MR=this.Mqd=null;this.Pa=new v.a;this.TSh=Sa;this.hvf=rb;this.tsf=pc;this.rsf=cd;this.XYe=wd;u.Rd=zd;this.MUh=Oa;this.vMa=jb;this.CVh=qc;y.Task.WAA(rb,pc).continueWith(Object(m.a)(this,this.xyj,"initOnTaskReady"))}Sbh(){this.Pa.raiseEvent("u",null,this)}xyj(){this.hvf.result&&this.tsf.result&&(this.MR=this.hvf.result,this.BBd=this.tsf.result,this.MR.FBc(Object(m.a)(this,this.Wec,"onPresenceUpdated")),
this.Mqd=new A.a(2,2,this.XYe,Object(m.a)(this,this.tvl,"updateAwayClientsTask"),88),u.Rd.Cb(this.Mqd))}Wec(Sa,rb){(this.jud||this.kKk(rb.OKb))&&u.Rd.a5(this.Mqd,0)}kKk(Sa){for(let pc in Sa){var rb=this.rsf.teg({key:pc,value:Sa[pc]});if(rb&&rb.clientId&&(rb=rb.clientId.toLowerCase(),(rb=this.NKa[rb]||this.NKa[rb.toUpperCase()])&&2===rb.status))return!0}return!1}tvl(Sa){var rb=this.MR.$Zi();if(rb){var pc=new Date,cd=!1;if(this.jud){this.NKa=rb;this.jud=!1;var zd=this.NKa;for(var wd in zd){rb=wd;var Oa=
zd[wd];Oa.pxb<pc&&(pc=Oa.pxb);2===Oa.status&&(cd=!0,this.BBd.Ged(rb))}cd&&this.Sbh();u.Rd.a5(Sa,this.mdg(pc))}else{Oa=new r.a;wd=!1;var jb=this.NKa;for(zd in jb){jb=zd;if(!(jb in this.NKa)||this.TSh.clientId===jb)continue;var qc=this.NKa[jb];const ib=rb[jb];if(qc&&ib){qc=qc.status;const Cb=ib.status;2===qc&&1===Cb?(Oa.add(jb),e.ULS.sendTraceTag(38052609,392,50,jb+" returned from away")):1===qc&&2===Cb&&(wd=cd=!0,this.BBd.Ged(jb),e.ULS.sendTraceTag(38052610,392,50,jb+" went away"));1===Cb&&ib.pxb<
pc&&(pc=ib.pxb)}}this.NKa=rb;u.Rd.a5(Sa,this.mdg(pc));(0<Oa.count||cd)&&this.Sbh();0<Oa.count&&!this.CVh?(Sa=this.o1i(Oa),this.Lol(Sa)):Sa=new r.a;(wd||0<Sa.count)&&this.MUh(w.a.C4a,2)}}}Lol(Sa){if(Sa.count)for(let rb of Sa)Sa=this.vMa.nBa(String.format(CommonUIStrings.l_EditorsToastArriving,rb),!1),Sa.image=5,Sa.uca="CoAuth_AuthorStatus_16x16x32",this.vMa.Wh(Sa)}o1i(Sa){const rb=this.MR.bMc(),pc=new r.a;for(let cd in rb){const zd={key:cd,value:rb[cd]};if(Sa.contains(zd.key)){const wd=this.rsf.teg(zd);
wd&&(pc.add(wd.userName),Sa.remove(zd.key))}}pc.count||e.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return pc}mdg(Sa){return Math.max(Sa.getTime()+this.XYe-(new Date).getTime(),0)}}u.Rd=null;Object(h.a)(u,"AwayManager",null,[]);var D=d(568),F=d(25),I=d(287),H=d(55),L=d(329),E=d(68),aa=d(1103),Q=d(1029),O=d(962),T=d(688),K=d(686),X=d(187),P=d(961),ea=d(27),ia=d(691),ja=d(206),C=d(26),pa=d(762),Z=d(45),qa=d(1166),ya=d(22),Ka=d(932),Da=d(369),la=d(36),ma=d(61);class Ea{constructor(Sa,
rb){this.shapeNode=Sa;this.Puh=rb}}Object(h.a)(Ea,"ShapeNodeStartEditingNotificationTracking",null,[]);class ta{constructor(Sa,rb,pc,cd,zd="",wd=""){if(!Sa||!rb||0>pc)throw Error.argumentNull("LockEntry");this.dw=Sa;this.YA=rb;this.Qda=pc;this.P6j=cd;this.eSg=zd;this.ZRg=wd;this.KMg=new Date}get clientId(){return this.dw}get Rjd(){return this.YA}get shapeId(){return this.Qda}get lockType(){return this.P6j}get oxh(){return this.eSg}get axh(){return this.ZRg}get Mzg(){return!Z.a.Va(this.ZRg)&&!Z.a.Va(this.eSg)}get JBg(){return this.KMg}set JBg(Sa){this.KMg=
Sa}}Object(h.a)(ta,"LockEntry",null,[]);class Ga{constructor(Sa,rb,pc,cd,zd="",wd=""){this.clientId=Sa;this.slideId=rb;this.shapeId=pc;this.lockType=cd;this.rowId=zd;this.cellId=wd}}Object(h.a)(Ga,"SerializableLockData",null,[]);var oa=d(183),sa=d(210);class Ha{constructor(Sa,rb,pc,cd,zd,wd,Oa,jb,qc,ib,Cb,yc,gd,od,Mc,Rd,ye,oe,Bb,Ff,pg,xf){this.Lkj=new D.a("",ResourceStrings.L_GhostUserName,Ka.a.fXf,new pa.a(1));this.$zb={};this.aAb={};this.Zzb={};this.sMg=ea.App.Mm;this.Wne=null;this.jre={};this.fYc=
{};this.iYc={};this.tMg=ea.App.Mm;this.VRg=!0;this.gOg=this.yNg=0;this.x2c=(new Date(0)).getTime();this.y2c=(new Date(0)).getTime();this.Mac=(new Date(0)).getTime();this.tpe=(new Date(0)).getTime();this.URg=!1;this.TTa=Sa;this.YD=rb;this.hAb=pc;this.ybc=cd;this.Zb=zd;this.yb=wd;this.ra=Oa;this.C1j=jb;this.$q=qc;this.Ea=ib;this.tc=Cb;this.Vac=yc;this.Ihe=gd.Fug;this.ps=od;this.tX=Mc;this.ua=Rd;this.YQg=ye;this.od=oe;this.od.R7h(Object(m.a)(this,this.Fqk,"onShapeViewElementRequestUpdateAuthorInfo"));
(this.rv=F.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.ra.VH(Object(m.a)(this,this.kH,"onSelectionChanged"));this.ybc.zAa(Object(m.a)(this,this.pfc,"onUpdateNotificationReceived"));this.mbk=Bb;this.Ne=Ff;this.vak=pg;this.Ha=gd;this.zVa=xf;this.Dyj()}Dyj(){C.a.J(20821920,828,50,"CoauthStateChangesHandler:InitRttRelatedTasks - IsDedicatedSession: {0}, RttLockSettings: {1}",this.Ihe,this.ps.g_j());this.ps.OTd||(0<this.ps.Afb?this.yb.Cb(new A.a(2,2,this.ps.Afb,Object(m.a)(this,
this.removeExpiredLock,"removeExpiredLock"),90,"71")):C.a.J(20821922,804,10,"RemoveExipredLockIntervalMs is not set correctly while RTT lock is enabled"),0<this.ps.lJb?(this.yb.Cb(new A.a(2,2,this.ps.lJb/2,Object(m.a)(this,this.switchPendingSveToFidelity,"switchPendingSveToFidelity"),90,"72")),this.VRg=!1):C.a.J(21565471,804,50,"Switch to fidelity delay after unlock is disabled"),0<this.ps.J3b?this.yb.Cb(new A.a(2,2,this.ps.J3b,Object(m.a)(this,this.updateLockIfImeActive,"updateLockIfImeActive"),
90,"73")):C.a.J(20030493,804,50,"IME typing lock notification disabled"),0<this.ps.ndb?this.yb.Cb(new A.a(2,2,this.ps.ndb,Object(m.a)(this,this.detectLockLeak,"detectLockLeak"),90,"74")):C.a.J(21565474,804,50,"Lock leack detection is disabled"),this.C1j.addHandler(Da.a.TRf,(Sa,rb)=>{this.Asi(rb)}),this.ps.mIc||this.enc||(this.Vac.xAa(Object(m.a)(this,this.hZg,"onBeforeParagraphNodePropertyChanged")),0<this.ps.Pib?this.yb.Cb(new A.a(2,2,this.ps.Pib,Object(m.a)(this,this.updateLockForActiveShapeNodes,
"updateLockForActiveShapeNodes"),90,"75")):C.a.J(20821953,804,15,"DedicatedWorkerTypingUpdateIntervalMs is not set correctly")),this.enc&&(this.vak.xAa(Object(m.a)(this,this.C$c,"onTableCellNodePropertyChanged")),this.Vac.xAa(Object(m.a)(this,this.hZg,"onBeforeParagraphNodePropertyChanged")),this.mbk.initialize(),0<this.ps.Pib&&this.yb.Cb(new A.a(2,2,this.ps.Pib,Object(m.a)(this,this.updateLockForActiveTableCellNodes,"updateLockForActiveTableCellNodes"),90,"76")),0<this.ps.Afb&&this.yb.Cb(new A.a(2,
2,this.ps.Afb,Object(m.a)(this,this.removeExpiredTableCellLock,"removeExpiredTableCellLock"),90,"77"))))}get enc(){return this.ps.iVd&&this.ps.J0f}removeExpiredLock(){var Sa=sa.a(this.$zb);for(const rb of Sa){Sa=Object(qa.a)(121,this.$zb[rb]);if(!Sa){delete this.$zb[rb];continue}const pc=Sa.shapeNode;pc&&pc.isConnected?this.tX.vag(pc)||this.zcd(rb)||(delete this.$zb[rb],this.tX.I0b(pc)||Sa.ll?C.a.J(18956362,814,50,"Previous non wet changes lock is expired but the shape contains wet changes now"):
this.gCh(Sa)):delete this.$zb[rb]}}removeExpiredTableCellLock(){var Sa=sa.a(this.aAb);for(const rb of Sa){Sa=Object(qa.a)(1046,this.aAb[rb]);if(!Sa){delete this.aAb[rb];continue}const pc=Sa.tableCellNode;pc&&pc.isConnected?Z.a.Va(this.tX.v0b(pc))&&!this.zcd(rb)&&(delete this.aAb[rb],this.hCh(Sa)):delete this.aAb[rb]}}detectLockLeak(){const Sa=[],rb=new Date,pc=this.Ohg();for(const cd of pc)cd.Sp&&+rb-+cd.wXc>this.ps.ndb&&Sa.push(cd.shapeNode.sr);0<Sa.length&&C.a.J(21565510,828,15,"Following objects are locked longer than {0} : {1}",
this.ps.ndb,Sa.join(";"))}switchPendingSveToFidelity(){const Sa=new Date,rb=this.Ohg();for(const pc of rb)pc.Sp||pc.shapeNode.qd&&this.enc||!pc.Kn||pc.Ox||!(+Sa-+pc.cXj>this.ps.lJb)||pc.LA||pc.kJb()}updateLockIfImeActive(){if(this.sMg>=this.tMg&&this.Wne){const Sa=this.iUi(this.Wne);this.Bod(Sa)&&this.Lkc(Sa.slideId,Sa.get_shapeId(),2)}this.tMg=new Date}updateLockForActiveShapeNodes(){var Sa=sa.a(this.fYc);for(const rb of Sa)Sa=Object(qa.a)(4,this.fYc[rb]),this.Bod(Sa)&&this.Lkc(Sa.slideId,Sa.get_shapeId(),
3);this.fYc={}}updateLockForActiveTableCellNodes(){var Sa=sa.a(this.iYc);for(const rb of Sa)if(Sa=Object(qa.a)(127,this.iYc[rb]),this.Bod(Sa)){const pc=this.Ea.tn(Sa);this.Lkc(pc.slideId,pc.get_shapeId(),3,Sa.rowId.toString(),Sa.cellId.toString())}this.iYc={}}iUi(Sa){return(Sa=this.$q.jI(Sa))?this.Ea.tn(Sa.$a):null}hZg(Sa,rb){rb&&rb.node?(Sa=Object(qa.a)(5,rb.node),Sa)?Sa.loading||Sa.xhc||rb.property.id!==la.a.iq.id||(rb=this.Ea.hca(Sa),Sa=this.tc.XCa(Sa),rb&&(Sa?(rb=this.tMc(rb.slideId,rb.get_shapeId(),
Sa.rowId.toString(),Sa.cellId.toString()),this.iYc[rb]=Sa):(Sa=this.bub(rb.slideId,rb.get_shapeId()),this.fYc[Sa]=rb))):C.a.J(20821964,828,10,"Invalid argument."):C.a.J(20821962,828,10,"Invalid argument.")}i_k(Sa){const rb=new A.a(2,1,this.ps.ekd,Object(m.a)(this,this.rtcNotifyStartEditing,"rtcNotifyStartEditing"),90,"78");rb.customData=new Ea(Sa,!1);this.yb.Cb(rb);this.jre[this.bub(Sa.slideId,Sa.get_shapeId())]=rb}rtcNotifyStartEditing(Sa){Sa=Object(qa.a)(Ea,Sa.customData);const rb=Sa.shapeNode;
this.Bod(rb)&&this.iQj(rb)&&this.Lkc(rb.slideId,rb.get_shapeId(),1);Sa.Puh=!0}Bod(Sa){return Sa?Sa.isConnected:!1}iQj(Sa){return(Sa=this.Pk(Sa))?Sa.BN:!1}Pk(Sa){return Object(qa.a)(121,Sa.sg(this.Zb.nn.Ma))}Ohg(){const Sa=[];if(!this.ua.Ba)return Sa;var rb=this.ua.Ba.jl();if(!rb)return Sa;for(const pc of rb)(rb=this.Pk(pc))&&!rb.ll?Sa.push(rb):C.a.J(21836046,828,50,"Shape {0} on active slide doesn't have valid view element",pc.sr);return Sa}vqk(Sa){this.mrh(Sa)&&(this.TTa.amIAlone||this.i_k(Sa))}kH(Sa,
rb){for(Sa=0;Sa<rb.hE.length;Sa++){const cd=rb.hE[Sa];var pc=Object(qa.a)(4,cd.context.node);pc&&pc.isConnected&&(pc=Object(qa.a)(121,pc.oc(this.Ne)))&&(pc=this.YQg.kF(pc.shapeNode))&&(1===cd.Hba?pc.Jdc():0===cd.Hba&&pc.Tue())}}uqk(Sa){if(this.mrh(Sa)&&!this.ps.kIc){var rb=this.bub(Sa.slideId,Sa.get_shapeId()),pc=Object(qa.a)(A.a,this.jre[rb]);if(pc){const cd=Object(qa.a)(Ea,pc.customData);this.yb.Ng(pc);cd&&cd.Puh&&this.Lkc(Sa.slideId,Sa.get_shapeId(),4);this.jre[rb]=null}}}Fqk(Sa,rb){this.v3g(rb.xw)}v3g(Sa){Sa.NK()||
Sa.shapeNode.N8a?this.x2h(Sa):this.w3g(Sa)}C$c(Sa,rb){if((rb=Object(qa.a)(oa.TableCellNode,rb.node))&&(Sa=Object(qa.a)(1046,rb.sg(this.Ne)))&&rb.isConnected){rb=this.tX.v0b(rb);const pc=this.rDe(Sa.tableCellNode);Z.a.Va(rb)?pc?(this.zee(Sa,this.Ria(pc.clientId,Ha.VUd)),this.pVe(Sa)):Z.a.Va(rb)&&(this.rDe(Sa.tableCellNode)||this.hCh(Sa)):(this.zee(Sa,this.Ria(rb,Ha.VUd)),this.pVe(Sa))}}zee(Sa,rb){Sa.lock(rb)}hCh(Sa){Sa.unlock()}Lkc(Sa,rb,pc,cd="",zd=""){try{const wd=new Ga(this.hAb,Sa.Opc,rb,pc,cd,
zd);this.ybc.$ea(7,wd)}catch(wd){C.a.J(17602625,814,10,"LockManager.SendLockNotification : MyClientId: {0}; Exception: {1}. ",this.hAb,wd.stack)}}pfc(Sa,rb){this.Ha.pptCoauthSurveyFloodgateEnabled&&!this.URg&&8===rb.type&&this.zVa&&this.mcl(rb)&&(C.a.J(41185738,814,50,"Log coauth activity"),this.URg=!0,this.zVa.continueWith(()=>{this.zVa.result.logActivity("CoauthContentMerge","PptCoauthSurveyFloodgateEnabled")}));7===rb.type&&((Sa=rb.iya)?Sa.clientId===this.hAb?C.a.J(19145675,828,15,"Lock notification : lock notification from myself recieved"):
(C.a.J(17602627,828,50,"Lock notification : LockClientId {0}, MyClientId: {1}.",Sa.clientId,this.hAb),Sa=new ta(Sa.clientId,Sa.slideId,Sa.shapeId,Sa.lockType,Sa.rowId,Sa.cellId),this.N2h(Sa),this.BDk(Sa)):C.a.J(19145673,828,10,"Lock notification: invalid lock data recieved"))}w3g(Sa){if(!Sa||Sa.ll)C.a.J(18994447,828,15,"UpdateAuthorInfoTaskHandler: shapeViewElement is null: {0}.",!Sa);else{var rb=Sa.shapeNode;if(!(rb.Pf||this.Ihe&&rb.qd&&(this.ps.prb||this.enc))){var pc=this.tX.I0b(rb);pc?this.vXc(Sa,
this.Ria(pc,Ha.VUd)):(rb=this.tX.vag(rb))?(this.vXc(Sa,this.Ria(rb,Ha.KLi)),this.oVe(Sa)):(rb=this.rDe(Sa.shapeNode))?(this.vXc(Sa,this.Ria(rb.clientId,this.m1d(rb.lockType))),this.oVe(Sa)):Sa.Sp&&this.gCh(Sa)}}}gCh(Sa){const rb=this.YQg.kF(Sa.shapeNode);rb&&(rb.Znd(null),Sa.unlock(this.VRg||!rb.e6d))}vXc(Sa,rb){Sa.lock(rb);Sa.NK()&&this.ra.Uh()}mcl(Sa){if(!Sa||null===Sa.iya)return!1;Sa=this.Rvk(Sa.iya);for(const rb of Sa)rb&&rb.clientId&&(rb.clientId.toLowerCase()===this.hAb.toLowerCase()?(this.yNg++,
this.x2c=this.x2c===(new Date(0)).getTime()?(new Date).getTime():this.x2c,this.y2c=(new Date).getTime()):this.pLj(rb.clientId)||(this.gOg++,this.Mac=this.Mac===(new Date(0)).getTime()?(new Date).getTime():this.Mac,this.tpe=(new Date).getTime()));return 5<=this.yNg&&5<=this.gOg&&(this.tpe>=this.x2c&&this.Mac<=this.y2c||this.y2c>=this.Mac&&this.y2c<=this.tpe)&&1<=this.YD.Otb()?!0:!1}Rvk(Sa){let rb=null;try{rb=Sa}catch(pc){}if(null===rb||!rb.length){let pc=null;try{pc=Sa}catch(cd){C.a.J(41185744,828,
10,"UpdateHint can't convert to RTC message.")}if(null!==pc)return[pc]}return rb}pLj(Sa){Sa=this.Ria(Sa);const rb=this.Ria(this.hAb);return Sa&&rb&&Sa.userName===rb.userName&&Sa.email===rb.email?!0:!1}m1d(Sa){switch(Sa){case 1:return Ha.Jil;case 2:return Ha.dxj;case 3:return Ha.vtl;case 4:return Ha.WMi}C.a.J(20821976,828,10,"Unknown lock type");return"Unknown lock type"}N2h(Sa){if(Sa&&Sa.Rjd){var rb=Sa.Mzg?this.tMc(new ma.a(Sa.Rjd),Sa.shapeId,Sa.oxh,Sa.axh):this.bub(new ma.a(Sa.Rjd),Sa.shapeId);if(4===
Sa.lockType)this.Zzb[rb]=Sa;else{var pc=Object(qa.a)(ta,this.Zzb[rb]);pc?(pc=this.l1d(pc),this.l1d(Sa)>pc&&(this.Zzb[rb]=Sa)):this.Zzb[rb]=Sa}}}l1d(Sa){return this.W8i(Sa.lockType)-(+new Date-+Sa.JBg)}W8i(Sa){switch(Sa){case 1:return this.ps.dkd;case 2:return this.ps.IRc;case 3:return this.ps.jnd;case 4:return this.ps.Nrb}C.a.J(20821980,828,10,"Unknown lock type");return 0}rDe(Sa){if(Object(ya.a)(4,Sa)){Sa=Object(qa.a)(4,Sa);if(!Sa.slideId)return null;Sa=this.bub(Sa.slideId,Sa.get_shapeId());return this.zcd(Sa)}if(Object(ya.a)(127,
Sa)){Sa=Object(qa.a)(127,Sa);let rb=this.Ea.hca(Sa);if(!rb.slideId)return null;Sa=this.tMc(rb.slideId,rb.get_shapeId(),Sa.rowId.toString(),Sa.cellId.toString());return this.zcd(Sa)}return null}zcd(Sa){if(!Sa)return null;const rb=Object(qa.a)(ta,this.Zzb[Sa]);return rb?0>=this.l1d(rb)?this.Zzb[Sa]=null:rb:null}oVe(Sa){const rb=this.Iej(Sa);rb&&(this.$zb[rb]=Sa)}pVe(Sa){const rb=this.ghj(Sa);rb&&(this.aAb[rb]=Sa)}Iej(Sa){return Sa?this.bub(Sa.shapeNode.slideId,Sa.shapeNode.get_shapeId()):null}ghj(Sa){if(!Sa)return null;
Sa=Sa.tableCellNode;const rb=this.Ea.hca(Sa);return this.tMc(rb.slideId,rb.get_shapeId(),Sa.rowId.toString(),Sa.cellId.toString())}bub(Sa,rb){return String.format("{0}#{1}#{2}",Sa.sid,Sa.cid,rb)}tMc(Sa,rb,pc,cd){return String.format("{0}#{1}#{2}#{3}#{4}",Sa.sid,Sa.cid,rb,pc,cd)}UKj(Sa){const rb=Object(qa.a)(120,this.ua.Ba);return rb&&ma.a.Cth(Sa.Rjd,rb.Bb.Opc)?!0:!1}BDk(Sa){if(this.UKj(Sa)){var rb=Sa.shapeId,pc=Sa.clientId;this.ua.Ba&&(rb=this.ua.Ba.DS(rb))&&(Sa.Mzg&&this.ps.iVd?this.NDk(Sa,pc,rb):
this.HDk(Sa,pc,rb))}}HDk(Sa,rb,pc){pc.Pf||this.Ihe&&pc.qd&&(this.ps.prb||this.enc)||!(pc=this.Pk(pc))||(this.vXc(pc,this.Ria(rb,this.m1d(Sa.lockType))),this.oVe(pc))}NDk(Sa,rb,pc){if((pc=this.ihj(pc,Sa.oxh,Sa.axh))&&pc.isConnected){var cd=Object(qa.a)(1046,pc.sg(this.Ne));cd&&Z.a.Va(this.tX.v0b(pc))&&(this.zee(cd,this.Ria(rb,this.m1d(Sa.lockType))),this.pVe(cd))}}ihj(Sa,rb,pc){Sa=this.tc.iN(Object(qa.a)(4,Sa));if(!Sa)return null;var cd=this.tc.Zia(Sa);Sa=null;for(const zd of cd){cd=this.tc.z7a(zd);
for(const wd of cd)if(wd.rowId.toString()===rb&&wd.cellId.toString()===pc){Sa=wd;break}}return Sa}x2h(Sa){const rb=new A.a(0,1,0,()=>{this.w3g(Sa)},90,"79");this.yb.Cb(rb)}Asi(Sa){this.sMg=new Date;this.Wne=this.rTi(Sa.Ac)}rTi(Sa){return Sa?Sa.querySelector(".Paragraph"):null}Ria(Sa,rb=""){const pc=this.YD.Ria(Sa);if(pc)return pc;C.a.J(19140752,828,50,"Failed to find presence user for client id: {0}; DataSource: {1}.",Sa,rb);return this.Lkj}mrh(Sa){return!this.ps.OTd&&!(this.ps.prb&&Sa.qd)&&!Sa.Pf}}
Ha.VUd="EditingBy";Ha.KLi="EditingByInSameWorker";Ha.Jil="StartEditing";Ha.WMi="EndEditing";Ha.dxj="ImeTyping";Ha.vtl="Typing";Object(h.a)(Ha,"CoauthStateChangesHandler",null,[1353]);class bb{constructor(Sa){this.rta={};this.dw=Sa.yC;this.init(Sa)}init(Sa){if(Sa=Sa.zZ)for(const rb of Sa)rb.ID!==this.dw&&(this.rta[rb.ID]=new Date)}C1h(Sa){for(let rb=0;rb<Sa.length;rb++)Sa[rb]in this.rta||Sa[rb]===this.dw||(this.rta[Sa[rb]]=new Date)}Ijl(Sa){const rb=this.rta[Sa];rb&&(C.a.J(37590341,814,50,"EditorPresenceTracker : Presence of coauthoring user never appeared, but leaving coauth; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",
this.dw,Sa,(new Date).getTime()-rb.getTime()),delete this.rta[Sa])}Hjl(Sa){const rb=this.rta[Sa];rb&&(C.a.J(37590343,814,50,"EditorPresenceTracker : Presence of coauthoring user appeared; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",this.dw,Sa,(new Date).getTime()-rb.getTime()),delete this.rta[Sa])}Gjl(){for(const Sa of Object.keys(this.rta))C.a.J(37590345,814,15,"EditorPresenceTracker : Presence of coauthoring user never appear; MyClientID: {0}; Coauthor clientID: {1}; TimeElapsed: {2}",
this.dw,Sa,(new Date).getTime()-this.rta[Sa].getTime());this.rta={}}}Object(h.a)(bb,"EditorPresenceTracker",null,[1354]);class Ya{constructor(Sa){this.q9j=Sa;this.GL=new Q.a;this.GL.Dg(this.q9j)}}Object(h.a)(Ya,"PPTRtcProvider",null,[1352]);var ua=d(106),Ma=d(1165),Ca=d(683);class Va{constructor(Sa,rb,pc,cd,zd){this.oda=null;this.sT=!1;this.nhe=this.Aoe=null;this.I1j=ua.a.create();this.p_c=!1;this.x_b=0;this.zT=zd;pc.tg&&(this.findSessionResponse=Sa,cd.EFf(Object(m.a)(this,this.d2k,"sessionPropertiesChanged")));
this.oFa=new Ma.a(()=>rb())}get findSessionResponse(){return this.oda}set findSessionResponse(Sa){if(this.sT)C.a.J(50943949,814,15,"PptAssignRtcMachineStrategy : FindSessionResponse Not updating cached find session response as it is already set");else if(this.oda=Sa)this.sT=!0,this.Aoe=this.oda.MRf,this.nhe=this.oda.zA}get Nla(){return this.sT?this.Aoe:this.oFa.value.Nla}set Nla(Sa){this.sT?this.Aoe=Sa:this.oFa.value.Nla=Sa}uLe(Sa){this.oFa.value.uLe(Sa)}get zA(){return this.sT?this.nhe:this.oFa.value.zA}set zA(Sa){this.sT?
this.nhe=Sa:this.oFa.value.zA=Sa}rNc(){let Sa;C.a.J(51140180,814,50,"PptAssignRtcMachineStrategy : OnConnectionStateChanged isFindSessionResponseValid:{0}, havePerformedFindSessionWithLazyStrategy:{1}",this.sT,this.p_c);return this.sT?(Sa=this.oda.correlationId||this.I1j.toString(),C.a.J(40130654,500,50,"CorrelationId after FindSession: {0}",Sa),{returnValue:String.format("{0}&{1}={2}",this.oda.U4,F.AFrameworkApplication.xQd,Z.a.Qe(Sa)),correlationId:Sa}):this.p_c?this.oFa.value.rNc():(C.a.J(51140183,
814,50,"PptAssignRtcMachineStrategy : GetFindSessionRequestQs returning null QS to avoid crashing"),{returnValue:null,correlationId:null})}J2d(Sa,rb,pc,cd,zd){C.a.J(51140185,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.sT);this.sT?(Sa(this.oda.WWb),pc(new Ca.a(this.oda.U6c,this.oda.R6c,this.oda.Q6c,this.oda.SPc))):(this.oFa.value.J2d(Sa,rb,pc,cd,zd),this.p_c=!0);this.zT&&this.zT.Wh(26,!this.p_c)}gUd(){C.a.J(51140187,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",
this.sT);this.sT?this.sT=!1:this.oFa.value.gUd()}cma(Sa,rb){C.a.J(51140189,814,50,"PptAssignRtcMachineStrategy : GetRtcMachine isFindSessionResponseValid:{0}",this.sT);this.sT||this.oFa.value.cma(Sa,rb)}d2k(){C.a.J(40464838,814,50,"PptAssignRtcMachineStrategy : SessionPropertiesChanged; FindSessionQs refreshed isFindSessionResponseValid:{0}",this.sT);this.sT=!1}}Object(h.a)(Va,"PptAssignRtcMachineStrategy",null,[1351]);var Za=d(1122);class Db{constructor(){this.Yn=null}jUb(Sa,rb){this.Yn||(this.Yn=
{});this.Yn[rb]||(this.Yn[rb]=0);this.Yn[rb]+=Sa}getData(){return this.Yn}reset(){this.Yn=null}}Object(h.a)(Db,"MultiSumDataAggregator",null,[1496]);class Lb{constructor(Sa,rb){this.lqd=Za.a.TV(Sa,rb,new Db,!0)}zf(Sa){this.lqd.track(1,Sa)}}Object(h.a)(Lb,"MultiCounter",null,[1529]);class yb{constructor(Sa,rb,pc,cd){this.$y=Sa;this.g4=rb;this.Wak=pc;this.o4j=cd;this.$y.zAa(Object(m.a)(this,this.lYk,"rtcOnUpdateNotificationReceived"))}lYk(Sa,rb){0===rb.type&&(this.o4j.zf("CU"),this.Wak||this.fF())}fF(){!F.AFrameworkApplication.Vg&&
this.g4.vW&&this.g4.fF(null,null,null)}}Object(h.a)(yb,"ContentNotificationManager",null,[]);class Bc extends yb{constructor(Sa,rb,pc,cd){super(Sa,rb,pc,cd)}static init(){if(ea.App.Hb){var Sa=ea.App.Hb.Hd;if(Sa&&(Sa.FEf(Bc.RYg),Sa=Sa.Ci)&&(Sa=Sa.contentReplicator)){var rb=ea.App.Ih;if(rb&&rb.Zv&&(rb=H.a.instance.resolve("AppRealtimeChannel.IRealtimeChannel"))){var pc=F.AFrameworkApplication.fa.ka("Box4ThrottleInboundRequests"),cd=new Lb(11,1);Bc.SYc=Bc.SYc||new Bc(rb,Sa,pc,cd);Bc.SYc.fF()}}}}static RYg(Sa){Bc.SYc||
(Sa.Veh(Bc.RYg),Bc.init())}}Bc.SYc=null;Object(h.a)(Bc,"PptContentNotificationManager",yb,[]);var tb=d(101),Mb=d(336),Hb;(function(Sa){Sa[Sa.signalRConnectFailed=0]="signalRConnectFailed";Sa[Sa.findSessionFailed=1]="findSessionFailed"})(Hb||(Hb={}));Object(h.b)("RtcConnectFailureType",Hb);var vb=d(260);class Xb{constructor(Sa,rb,pc,cd,zd,wd){this.G2c=this.ENg=this.wbb=this.vbb=0;this.fbb=this.MFa=this.Tka=this.Q$b=this.F_c=this.u_=null;this.b0c=this.d0c=this.e0c=this.$_c=this.a0c=!1;this.rQg=Sa;this.vj=
rb;this.XN=pc;this.XN.uBc(Object(m.a)(this,this.wDb,"onNetworkHealthStateChanged"));this.Pj=cd;this.dre=wd;$addHandler(window,"visibilitychange",Object(m.a)(this,this.onVisibilityChange,"onVisibilityChange"));this.Y9j=zd;this.Y9j.H7h(Object(m.a)(this,this.Rpk,"onRtcConnectFailed"))}wDb(Sa,rb){rb.CUc||(this.d0c=this.e0c=!0)}onVisibilityChange(){window.document.hidden&&(this.$_c=this.a0c=!0)}Rpk(Sa,rb){Sa=rb.SRi;if(rb=rb.errorMessage){if(0===Sa){let cd,zd;({a7d:pc,b7d:cd,Wi:zd}=X.RtcUtils.u3f(rb.ErrorDetails));
rb.HttpErrorCode=pc;rb.HttpErrorStatus=cd;rb.Exception=zd;delete rb.ErrorDetails;if(!pc&&this.dre&&0<this.dre.length)try{var pc=!0;const wd=window.location.hostname.toLowerCase();for(const Oa of this.dre.split(";"))if(wd.endsWith(Oa)){pc=!1;break}rb.IsCORS=pc.toString()}catch(wd){rb.Unexpected=wd.message}}C.a.J(41445510,500,15,"PptRealtimeChannelMetrics:OnRtcConnectFailed; AmIAlone:{0}; IsPageHidden:{1}; IsNetworkHealthy:{2}; rtc connect failed type:{3}; errorMessage:{4}",this.vj.amIAlone,window.document.hidden,
this.Pj.gQ,Hb[Sa],tb.a.toJSON(rb));this.b0c||(this.b0c=this.pPj(Sa,rb))}}pPj(Sa,rb){const pc=vb.c(rb,"HttpErrorCode",-1);return 500<=pc&&599>=pc||1===Sa&&"FindSessionRequestFailed"!==rb.FindSessionFailureReason?!0:!1}Blg(){return this.u_&&1===this.wbb?this.a0c||this.e0c:this.Tka&&1<this.wbb?this.$_c||this.d0c:!1}vtj(){return this.Tka&&0<this.G2c?this.$_c||this.d0c:this.u_&&0<this.vbb?this.a0c||this.e0c:!1}Xdd(){this.vbb++;this.Q$b=new Date;this.u_||(this.u_=new Date,this.a0c=window.document.hidden,
this.e0c=!this.Pj.gQ)}NEe(){this.wch(0)}wch(Sa){this.wbb++;this.MFa=new Date;this.F_c?this.JFc>this.rQg.Zih&&(Sa={["hasExceededReconnectionThrehold"]:!0,["numberOfSuccessfullConnections"]:this.wbb,["numberOfConnectionAttempts"]:this.vbb,["firstConnectionAttempt"]:this.u_?this.u_.toISOString():"",["lastConnectionSuccess"]:this.MFa?this.MFa.toISOString():"",["lastUnexpectedDisconnect"]:this.Tka?this.Tka.toISOString():"",["lastExplicitDisconnect"]:this.fbb?this.fbb.toISOString():"",["reconnectDurationInMs"]:this.JFc,
["hasPageHiddenOrNetworkIssue"]:this.Blg()},C.a.J(36804373,500,15,tb.a.toJSON(Sa))):(this.F_c=this.MFa,Mb.a.instance.hc("FirstPresenceUpdated",(new Date).getTime().toString()),this.JFc>this.rQg.Zih&&(Sa={["hasExceededConnectionThrehold"]:!0,["numberOfConnectionAttempts"]:this.vbb,["firstConnectionAttempt"]:this.u_?this.u_.toISOString():"",["firstConnectionSuccess"]:this.F_c?this.F_c.toISOString():"",["lastExplicitDisconnect"]:this.fbb?this.fbb.toISOString():"",["connectDurationInMs"]:this.JFc,["connectionDurationFromStopWatchInMs"]:Sa,
["hasPageHiddenOrNetworkIssue"]:this.Blg()},C.a.J(36804373,500,15,tb.a.toJSON(Sa))))}Ydd(){this.ENg++;const Sa={["numberOfFailedConnections"]:this.ENg,["numberOfConnectionAttempts"]:this.vbb,["firstConnectionAttempt"]:this.u_?this.u_.toISOString():"",["lastConnectionAttempt"]:this.Q$b?this.Q$b.toISOString():"",["lastExplicitDisconnect"]:this.fbb?this.fbb.toISOString():"",["lastConnectionFail"]:(new Date).toISOString(),["disconnectedDurationMs"]:this.VIi,["hasPageHiddenOrNetworkIssue"]:this.vtj()};
this.b0c?e.ULS.sendTraceTag(41702299,500,15,tb.a.toJSON(Sa)):e.ULS.sendTraceTag(36804375,500,15,tb.a.toJSON(Sa))}Tic(){this.G2c++;this.Tka=new Date;this.$_c=window.document.hidden;this.d0c=!this.Pj.gQ}RKk(){this.fbl()&&this.Ydd();this.fbb=new Date;this.spi()}spi(){this.G2c=this.wbb=this.vbb=0;this.MFa=this.Tka=this.Q$b=this.u_=null;this.b0c=!1}fbl(){return!!this.Q$b&&!this.MFa&&!this.Tka}get JFc(){if(this.MFa){if(this.u_&&1===this.wbb)return this.vj.CMc(this.u_,this.MFa);if(this.Tka&&1<this.wbb)return this.vj.CMc(this.Tka,
this.MFa)}return 0}get VIi(){return this.Tka&&0<this.G2c?this.vj.CMc(this.Tka,new Date):this.u_&&0<this.vbb?this.vj.CMc(this.u_,new Date):0}}Object(h.a)(Xb,"PptRealtimeChannelMetrics",null,[1350]);var Uc=d(75),hb=d(31),Zb=d(37);class Fc{constructor(Sa,rb,pc,cd,zd){this.B7j=Sa.toLowerCase();this.TFa=rb;this.Cl=pc;this.Ot=cd;this.Eq=zd;this.Ot.tha(Object(m.a)(this,this.dfc,"onShapeNodeLoaded"));this.Eq.JFf(Object(m.a)(this,this.ffc,"onShapeViewElementUnlocked"))}dispose(){this.Ot.HXa(Object(m.a)(this,
this.dfc,"onShapeNodeLoaded"));this.Eq.Qfh(Object(m.a)(this,this.ffc,"onShapeViewElementUnlocked"))}OB(Sa){return this.uvi(Sa)||this.vSf(Sa)}vSf(Sa){if(!Sa||Sa.Pf)return!1;const rb=Sa.sa(Zb.a.UUd,"");return+new Date-+Sa.wXc<this.TFa&&!!rb&&rb.toLowerCase()!==this.B7j}uvi(Sa){return!!this.I0b(Sa)}vag(Sa){let rb="";Sa&&this.vSf(Sa)&&(rb=Sa.getValue(Zb.a.UUd));return rb}I0b(Sa){return Sa?Sa.sa(Zb.a.X_f,""):""}v0b(Sa){return Sa?Sa.sa(Zb.a.Tli,""):""}ryl(Sa){if(Sa&&(Sa.OB=this.OB(Sa),Sa.anchor)){const pc=
this.Cl.Nqa(Sa);for(;pc.moveNext();){var rb=pc.currentNode;hb.ParagraphReader.Vd(rb)&&(rb=Object(qa.a)(Uc.AParagraphNode,rb))&&(rb.OB=Sa.OB)}}}ffc(Sa,rb){this.ryl(rb.xw.shapeNode)}dfc(Sa,rb){Sa=rb.node;Sa.oxl();Sa.OB=this.OB(Sa)}}Object(h.a)(Fc,"PptWetChangeHandler",null,[1349,106]);class ob{constructor(Sa){this.Y8j=Sa}K2(){return this.Y8j.K2()}}Object(h.a)(ob,"PresenceCache",null,[]);var ac=d(903),pb=d(1102),nb=d(1190),Tb=d(989),Ub=d(1178);class hc extends v.a{constructor(){super();this.p3c=[]}qha(Sa){Sa&&
(C.a.J(8958528,814,50,"PresenceDataManager : AddPresence; clientId: {0}; presence: {1}",Sa.clientId,Sa.presence.toString()),Array.add(this.p3c,Sa))}Ged(Sa){(Sa=this.G7a(Sa))&&this.LFb(Sa);return Sa}LFb(Sa){Sa&&(C.a.J(8958530,814,50,"PresenceDataManager : RemovePresence; clientId: {0}; presence: {1}",Sa.clientId,Sa.presence.toString()),Array.remove(this.p3c,Sa))}G7a(Sa){for(const rb of this.p3c)if(rb.clientId===Sa)return rb;return null}K2(){return this.p3c}}Object(h.a)(hc,"PresenceDataManager",v.a,
[]);var Wb=d(39),fd=d(718);class fc{constructor(Sa,rb,pc,cd,zd,wd,Oa,jb,qc,ib,Cb){this.clientId=Sa;this.data=Oa;this.chatThreadId=rb;this.chatThreadDiscoveryUri=pc;this.inChat=cd;this.email=zd;this.capabilities=wd;this.userName=jb;this.clientType=qc;this.fHasClientEverExperiencedNetworkLoss=ib;this.isAnonymous=Cb}}Object(h.a)(fc,"SerializablePresenceInfo",null,[]);class bc{constructor(Sa,rb,pc,cd,zd,wd,Oa,jb,qc,ib,Cb){this.pbc=null;this.dw=Sa.toLowerCase();this.YA=rb;this.kqe=pc;this.gGg=cd;this.fGg=
zd;this.iKg=wd;this.b9b=Oa;this.XFg=jb;this.Jla=qc;this.pQg=ib;this.$Hg=Cb}S2d(){return new fc(this.dw,this.gGg,this.fGg,this.iKg,this.b9b,this.XFg.capabilities,this.kqe?this.kqe.S2d():null,this.Jla,this.pQg,this.$Hg,F.AFrameworkApplication.$ib||F.AFrameworkApplication.mQ)}Gtj(Sa){if(!(Sa&&this.Tj.equals(Sa.slideId)&&this.presence&&this.presence.lU))return!1;for(const rb of this.presence.lU)if(rb===Sa.get_shapeId())return!0;return!1}get presence(){return this.kqe}get clientId(){return this.dw}get chatThreadId(){return this.gGg}get chatThreadDiscoveryUri(){return this.fGg}get inChat(){return this.iKg}get email(){return this.b9b}get capabilities(){return this.XFg}get Tj(){return this.YA}get userName(){return this.Jla}get clientType(){return this.pQg}get fHasClientEverExperiencedNetworkLoss(){return this.$Hg}get presenceUser(){return this.pbc}set presenceUser(Sa){this.pbc&&
(Sa?!this.pbc.client||0===this.pbc.client||Sa.client&&0!==Sa.client||C.a.J(50942305,814,50,"PresenceEntry::SetPresenceUser; Specific to non-specific ClientType {0}.",this.dw):C.a.J(50942303,814,50,"PresenceEntry::SetPresenceUser; Non-null to null PresenceUser {0}.",this.dw));this.pbc=Sa}static DGc(Sa){if(!Sa||!Sa.clientId)return C.a.J(50942301,814,50,"PresenceEntry : CreateFromData; Invalid presence info"),null;const rb=fd.a.DGc(Sa.data);let pc=0;Sa.clientType&&8>=Sa.clientType&&(pc=Sa.clientType);
return new bc(Sa.clientId,rb.Tj,rb,Sa.chatThreadId,Sa.chatThreadDiscoveryUri,Sa.inChat,Sa.email,new pa.a(Sa.capabilities),Sa.userName,pc,Sa.fHasClientEverExperiencedNetworkLoss)}}Object(h.a)(bc,"PresenceEntry",null,[]);class cc extends Sys.EventArgs{constructor(Sa,rb,pc,cd,zd,wd){super();this.YA=Sa;this.Cbk=pc;this.J4c=rb;this.KPh=cd;this.V$j=zd;this.$8j=wd}get slideId(){return this.YA}get user(){return this.Cbk}get shapes(){return this.J4c}get Y7(){return this.KPh}get Pth(){return this.V$j}get C8g(){return this.$8j}}
Object(h.a)(cc,"SlidePresenceChangedEventArgs",Sys.EventArgs,[]);var kb=d(28);class ab extends v.a{constructor(Sa,rb,pc,cd,zd,wd,Oa,jb,qc,ib,Cb,yc,gd,od,Mc,Rd,ye,oe,Bb,Ff,pg,xf,qe,Oh,Cf,Bg,Gf){super();this.GQ=new hc;this.Ho=null;this.GGg=[];this.HGg=null;this.zyb=!0;this.Mab=!1;this.DMg=new Date;this.JVa=null;this.kIg=this.aIg=this.EJg=!1;this.o3c=null;this.h9=Sa;Sa.userName||(Sa.userName=Oh);this.fc=rb;this.$y=pc;this.dw=cd.clientId;this.C9=cd.zw;this.ue=zd;this.jc=pg;this.nbc=Ff;this.zT=xf;this.XN=
Cf;this.Kka=Gf;qe.execute(dh=>{this.Ho=dh});this.Quj();this.vj=gd;this.xq=od;this.jne=Mc.ryg;this.MLg=Mc.yPj;this.j$b=Mc.podsDefaultToRtcForPresenceEnabled;this.v5j=Mc.podsNoClientRtcConnectWhenAccessTokenExpiredEnabled;this.dMg=F.AFrameworkApplication.Kz;this.Ume=Mc.tg&&Mc.pptNoRtcConnectWhenReadOnlyEnabled;this.ra=wd;this.ra.VH(Object(m.a)(this,this.kH,"onSelectionChanged"));this.ks=Oa;this.ks.E8h(Object(m.a)(this,this.Yrk,"onValidShapeIdLoaded"));this.od=jb;this.od.uV(Object(m.a)(this,this.hjk,
"onActiveSlideDOMReady"));this.LI=qc;this.LI.tId(Object(m.a)(this,this.X8c,"onEditorTableUpdate"));this.Ei=Rd;this.Ei.IB(Object(m.a)(this,this.gB,"onSessionEnd"));this.Ei.JB(Object(m.a)(this,this.to,"onSessionRehydrated"));this.Ei.HNa(Object(m.a)(this,this.Uec,"onOutboundReplication"));this.T0j=Mc.pptAwayStatusTimeGapForPresenceUpdateInMs;this.pIg=Mc.hgl;this.ia=Cb;this.ua=ib;this.q3c=yc;this.YZc=ye;this.Zbb=oe;this.Gyb=Bb;Mc.tg&&(this.Ei.DFf(Object(m.a)(this,this.$ec,"onSessionAccessTokenExpiring")),
this.Ei.HBc(Object(m.a)(this,this.oma,"onSessionAccessTokenExpired")),this.Ei.SId(Object(m.a)(this,this.n$c,"onSessionExpired")),this.fc.ff(()=>{this.h9.userName=this.fc.appSettings.UserName;this.h9.email||(this.h9.email=F.AFrameworkApplication.fa.Ga("UserPrincipalName"));this.jc.WK||(C.a.J(512360717,814,50,"PresenceManager : Disconnect from RTC"),this.disconnect());this.Ume&&this.Ei.cba(Object(m.a)(this,this.jz,"onUnifiedAppStateChanged"))}),this.dMg&&this.Ei.KBc(Object(m.a)(this,this.uea,"onWopiTokenRefreshed")));
C.a.J(512360716,814,50,"PresenceManager - m_isWopiTokenRefreshEnabled:{0}",this.dMg)}ub(){this.ia.pa(kb.a.uXa,Wb.a.application,Object(m.a)(this,this.uXa,"querySlidePresenceUsers"),96)}uXa(Sa,rb,pc,cd,zd){zd.vmc=this.H1b(zd.slideId);zd.B8g=this.Otb();return 32}H1b(Sa){return(Sa=this.Yfg(Sa))?Sa.length:0}Quj(){this.$y.x3a(Object(m.a)(this,this.Oui,"connectionStateChanged"));this.$y.FBc(Object(m.a)(this,this.presenceUpdated,"presenceUpdated"));F.AFrameworkApplication.fa.ka("PPTForceUpdateEditorTableEnabled")&&
this.$y.zAa(Object(m.a)(this,this.xxl,"updateNotificationReceived"));K.a.getInstance().s5h(Object(m.a)(this,this.Y_g,"onGotCompletePersistentStateWithMetadata"));this.pIg&&this.XN.uBc(Object(m.a)(this,this.nok,"onNetworkHealthChanged"));this.JVa=this.C9.zi("WebServiceCall","RtcConnection");this.zT.fOi();this.$y.connect()}$ch(){const Sa=this.$y.bMc();this.bEh(new pb.a(Sa,null));this.Hkc()}nok(Sa,rb){rb.CUc||(this.zT.gOi(),this.aIg=!0)}Y_g(Sa,rb){this.zT.jOi(rb.XBk);K.a.getInstance().mRk(Object(m.a)(this,
this.Y_g,"onGotCompletePersistentStateWithMetadata"))}Oui(Sa,rb){C.a.J(512360715,814,50,"PresenceManager : Connection State changed; oldState: {0}; newState: {1}; MyClientId: {2}",ab.n_d(rb.oldState),ab.n_d(rb.newState),this.dw);switch(rb.newState){case 2:this.JVa.stop();Sa=this.JVa.Kq;this.zT.eOi();this.$ch();this.nbc.wch(Sa);break;case 1:2===rb.oldState&&this.nbc.Tic();this.nbc.Xdd();break;case 0:this.zyb?this.wpi():2===rb.oldState&&(window.setTimeout(()=>{this.$y.connect()},0),C.a.J(512360714,
814,50,"PresenceManager : Reconnect rtc; Session time: {0}",this.ue.x1b().getTime()),this.nbc.Tic())}}getSelectedShapes(){if(!this.MLg)return null;const Sa=[],rb=this.ra.Yd();for(let pc=0;pc<rb.length;++pc)Array.add(Sa,rb[pc].get_shapeId());0<Sa.length&&Sa.sort();return Sa}wpi(){var Sa=this.GQ.K2();if(Sa&&Sa.length){Sa=Array.clone(Sa);for(const rb of Sa)this.LFb(rb);this.raiseEvent("PresenceChanged")}}PJe(Sa,rb){try{this.h9.email||(this.h9.email=F.AFrameworkApplication.fa.Ga("UserPrincipalName"));
const pc=new fd.a(Sa,rb),cd=new bc(this.h9.clientId,Sa,pc,this.h9.chatThreadId,this.h9.chatThreadDiscoveryUri,this.h9.inChat,this.h9.email,this.h9.capabilities,this.h9.userName,1,this.aIg);this.h9.email||C.a.J(512360713,814,15,"PresenceManager : SendPresence; empty email for user");this.$y.PJe(cd.S2d()).continueWith(()=>{C.a.J(8958538,814,50,"PresenceManager : SendPresence; Send presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.dw,pc.toString(),this.ue.x1b().getTime())});this.DMg=
new Date;this.zT.sYj();this.OKk(Sa,rb);C.a.J(8958540,814,50,"PresenceManager : SendPresence; Sending presence update; MyClientId: {0}; presence: {1}; session time: {2}",this.dw,pc.toString(),this.ue.x1b().getTime());this.oLk(pc)}catch(pc){C.a.J(512360712,814,10,"PresenceManager : SendPresence; Exception creating presence data {0}; MyClientId: {1};",pc.toString(),this.dw)}}presenceUpdated(Sa,rb){Sa=!!this.Ho&&this.Ho.CZ;C.a.J(8958544,814,50,"PresenceManager : PresenceUpdated; Received presence update; MyClientId: {0}, Rehydrating: {1} ",
this.dw,Sa);if(!Sa){this.zT.uYj(rb.OKb);Sa=null;this.C9&&(Sa=this.C9.zi("ServerNotification","Presence Updated"));try{this.bEh(rb)}finally{Sa&&Sa.stop()}}}xxl(Sa,rb){C.a.J(512360711,814,50,"PresenceManager : Update notification received; Type: {0}; MyClientId: {1}",rb.type,this.dw)}bEh(Sa){this.O2h(Sa.OKb);this.FXa(Sa.tZf);C.a.J(8958546,814,50,"PresenceManager::UpdatePresenceCache; Refresh Peoples Well on presence update");this.raiseEvent("PresenceChanged")}Hkc(){this.ua.Tj?this.PJe(this.ua.Tj,this.getSelectedShapes()):
C.a.J(512360708,814,50,"PresenceManager::SendCurrentSelection: m_graphTopologyManager.CurrentSlideId is null")}kH(){if(this.ua.Tj){var Sa=this.getSelectedShapes();(ab.Ktj(this.HGg,this.ua.Tj)||ab.i6d(Sa,this.GGg))&&this.Hkc()}else C.a.J(512360707,814,50,"PresenceManager::OnSelectionChanged: m_graphTopologyManager.CurrentSlideId is null")}hjk(Sa,rb){rb.Ba?this.ua.Tj?this.Hkc():C.a.J(512360705,814,50,"PresenceManager::OnActiveSlideDOMReady: m_graphTopologyManager.CurrentSlideId is null"):C.a.J(512360706,
814,50,"PresenceManager::OnActiveSlideDOMReady: ActiveSlide is null")}Yrk(Sa,rb){this.ua.Tj?Array.contains(this.getSelectedShapes(),rb.shapeNode.get_shapeId())&&this.Hkc():C.a.J(512360704,814,50,"PresenceManager::OnValidShapeIdLoaded: m_graphTopologyManager.CurrentSlideId is null")}Bfl(Sa,rb,pc){rb=this.Z9f(rb);Sa=this.Z9f(Sa);this.ue.p1i().Knc.raiseEvent(ab.YUd,new nb.a(this.vj.yC,null,rb,Sa,null,0,0,pc))}Z9f(Sa){const rb=new Tb.a;for(let pc=0;pc<Sa.length;pc++){const cd=Sa[pc];if(!cd)continue;if(cd.ID===
this.vj.yC)continue;if(!cd.EmailAddress){rb.$(cd.ID,this.Y9f(cd));continue}const zd=this.GQ.G7a(this.vj.yC);zd&&zd.email&&cd.EmailAddress&&zd.email.toUpperCase()===cd.EmailAddress.toUpperCase()||rb.$(cd.EmailAddress.toUpperCase(),this.Y9f(cd))}return rb.values}Y9f(Sa){const rb=new Ub.a;rb.EmailAddress=Sa.EmailAddress;rb.Id=Sa.ID;rb.Name=Sa.Name;return rb}X8c(Sa,rb){this.Bfl(rb.$Bg,rb.YIf,rb.pIj);if(Sa=this.vj.zZ){var pc=rb.$Bg;for(var cd=0;cd<pc.length;cd++)this.YZc.Ijl(pc[cd].ID);pc=[];rb=rb.YIf;
for(cd=0;cd<rb.length;cd++){let wd=rb[cd];const Oa=wd.ID;if(Oa!==this.vj.yC){const jb=this.GQ.G7a(Oa);jb?this.Gyb.jLf(jb.email,wd.EmailAddress):Array.add(pc,Oa)}}this.YZc.C1h(pc);2<=Sa.length&&C.a.J(512360674,814,50,"PresenceManager : EditorTable has atleast 2 coauthors; MyClientID: {0}; EditorTableCount: {1}",this.dw,Sa.length);pc=[];rb=[];for(var zd of Sa)Array.add(pc,zd.ID),zd.ID===this.vj.yC||this.GQ.G7a(zd.ID)||Array.add(rb,zd.ID);C.a.J(512360673,814,50,"PresenceManager : OnEditorTableUpdate; Received Editor Table update; MyClientID: {0}; editorTableCount: {1}; ClientIDs : {2}; ClientIDs with missing presence: {3}",
this.dw,Sa.length,pc.join(","),rb.join(","));for(const wd of this.GQ.K2())({editor:zd}=this.vj.Mib(wd.clientId)).returnValue?this.Stj(zd.ColorIndex)?(this.kLk(wd),Sa=this.Zbb.$Ca(new ac.a(zd.EmailAddress,void 0,zd.Name),zd.ColorIndex,zd.ID,0),wd.presenceUser=new D.a(wd.clientId,zd.Name,Sa,new pa.a(1),null,null,wd.clientType),this.q3c.Ndd(new cc(wd.Tj,wd.presence.lU,wd.presenceUser,!0,this.H1b(wd.Tj),this.Otb())),C.a.J(512360671,814,50,"PresenceManager : OnEditorTableUpdate; Adding/Updating presence UI; ClientId: {0};  Presence: {1}; Color: {2}; MyClientId: {3};",
wd.clientId,wd.presence.toString(),wd.presenceUser.color,this.dw)):C.a.J(512360672,814,50,"PresenceManager : OnEditorTableUpdate; EditorInfo has no color assigned; ClientId: {0};  Presence: {1}; MyClientId: {2};",wd.clientId,wd.presence.toString(),this.dw):C.a.J(512360670,814,50,"PresenceManager : OnEditorTableUpdate; Client not in Editor table; ClientId: {0};  Presence: {1}: Color: {2}; MyClientId: {3};",wd.clientId,wd.presence.toString(),wd.presenceUser?wd.presenceUser.color:"",this.dw);this.raiseEvent("PresenceChanged")}else C.a.J(512360675,
814,50,"PresenceManager : OnEditorTableUpdate; Received null on Editor Table update; MyClientID: {0};",this.dw)}gB(Sa,rb){this.YZc.Gjl();5!==rb.vJ&&(C.a.J(512360669,814,50,"PresenceManager : OnSessionEnd - Disconnect from RTC"),this.disconnect())}$ec(){C.a.J(512360668,814,50,"PresenceManager : OnSessionAccessTokenExpiring");this.Mab||(C.a.J(512360667,814,50,"PresenceManager : OnSessionAccessTokenExpiring; Access token expired"),this.Mab=!0)}oma(){C.a.J(512360666,814,50,"PresenceManager : OnSessionAccessTokenExpired; Disconnecting from RTC");
this.Mab||(C.a.J(512360665,814,50,"PresenceManager : OnSessionAccessTokenExpired; Access token expired"),this.Mab=!0)}n$c(){C.a.J(512360664,814,50,"PresenceManager : OnSessionExpired - Disconnect from RTC");this.disconnect()}uea(Sa,rb){C.a.J(512360663,814,50,"PresenceManager : OnWopiTokenRefreshed");try{rb.YVc?(C.a.J(512360662,814,50,"PresenceManager::OnWopiTokenRefreshed Token refresh succeeded. - RTC Connection State: {0}",ab.n_d(this.$y.connectionState)),this.Mab=!1,this.Ume&&!this.jc.WK?C.a.J(512360661,
814,15,"PresenceManager : OnWopiTokenRefreshed; Do not connect to RTC in readonly mode"):this.zyb||2!==this.$y.connectionState?this.connect():(Sa={},Sa.qs=this.Kka.presentationId.string,C.a.J(512360660,814,50,"PresenceManager : OnWopiTokenRefreshed; Calling UpdateClientInfo"),this.$y.Sib(Sa))):C.a.J(512360659,814,15,"PresenceManager::OnWopiTokenRefreshed Token refresh failed.")}catch(pc){C.a.J(512360658,814,10,"PresenceManager::OnWopiTokenRefreshed Exception: {0}",pc)}}to(Sa,rb){this.v5j&&this.Mab||
this.Ume&&!this.jc.WK?C.a.J(512360657,814,50,"PresenceManager : OnSessionRehydrated; Do not connect to RTC; IsAccessTokenExpired={0}; IsInEditingModeOrCanEditAnyway={1};",this.Mab,this.jc.WK):4!==rb.zwa||this.zyb?this.connect():(C.a.J(512360656,814,50,"PresenceManager : OnSessionRehydrated - catch up presence"),this.$ch())}jz(Sa,rb){rb.zae&&!this.jc.WK&&(C.a.J(512360655,814,50,"PresenceManager : OnUnifiedAppStateChanged; Change to readonly, disconnect from RTC"),this.disconnect())}connect(){C.a.J(512360654,
814,50,"PresenceManager : Connect");this.zyb=!1;this.$y.connect()}Uec(){this.vbl()&&(C.a.J(512360653,814,50,"PresenceManager : OnOutboundReplication; Send presence update for editing actions"),this.Hkc())}vbl(){const Sa=this.$y.i$i();return Sa?2===Sa.status||+new Date-+this.DMg>this.T0j?!0:!1:!1}GNj(){const Sa=this.GQ.K2();if(0<Sa.length)for(const rb of Sa)if(rb.presence&&rb.presence.Tj)return!0;return!1}Tal(){return!this.EJg&&this.j$b&&2!==this.vj.Cba}O2h(Sa){for(let pc in Sa){var rb=Sa[pc];try{const cd=
bc.DGc(rb);if(!cd||cd.clientId===this.dw)continue;const zd=cd.clientId;this.Tal()&&(this.EJg=!0,this.xq.Soc(2),C.a.J(512360652,814,50,"PresenceManager : Update coauth status to Coauthoring from RTC"));C.a.J(39326610,814,50,"PresenceManager : AddOrUpdatePresence; ClientId: {0}; NewPresence: {1};",zd,cd.presence.toString());const wd=cd.email;if(!this.Gyb.J_d(wd)){let Oa;({editor:Oa}=this.vj.Mib(zd)).returnValue&&this.Gyb.jLf(wd,Oa.EmailAddress)}this.Q2h(cd);this.zT.dOi()}catch(cd){C.a.J(512360651,814,
10,"PresenceManager : AddOrUpdatePresence; Invalid Presence Data Received {0}; MyClientId: {1};",cd.toString(),this.dw)}}this.zT.tYj(Sa)}Q2h(Sa){this.aNi(Sa);const rb=this.$y.W2(Sa.clientId);rb&&2===rb.status?C.a.J(39326613,814,50,"PresenceManager : AddOrUpdatePresenceWithAwayStatus; Do not add presence for inactive user; ClientId: {0};",Sa.clientId):this.P2h(Sa)}P2h(Sa){const rb=this.GQ.G7a(Sa.clientId);if(rb){if(!this.Atj(rb,Sa))return;C.a.J(8958560,814,50,"PresenceManager : AddOrUpdatePresence; Updating existing presence; ClientId: {0};  ExistingPresence: {1}; NewPresence: {2}; MyClientId: {3};",
Sa.clientId,rb.presence.toString(),Sa.presence.toString(),this.dw);this.LFb(rb)}this.f3h(Sa)}LFb(Sa){Sa&&(this.GQ.LFb(Sa),Sa.presenceUser&&this.q3c.Ndd(new cc(Sa.Tj,Sa.presence.lU,Sa.presenceUser,!1,this.H1b(Sa.Tj),this.Otb())))}Q1f(Sa){if(Sa)if(Sa.presenceUser)C.a.J(512360649,814,100,"PresenceManager:AddOrUpdatePresence; PresenceUser already created for ClientId{0};",Sa.clientId);else{const rb=this.seg(Sa.clientId);rb?Sa.presenceUser=rb:C.a.J(512360650,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",
Sa.clientId)}}f3h(Sa){Sa&&(this.GQ.qha(Sa),this.YZc.Hjl(Sa.clientId),this.Q1f(Sa),Sa.presenceUser?this.q3c.Ndd(new cc(Sa.Tj,Sa.presence.lU,Sa.presenceUser,!0,this.H1b(Sa.Tj),this.Otb())):C.a.J(512360648,814,50,"PresenceManager:AddOrUpdatePresence; Null presence user for ClientId{0};",Sa.clientId))}Stj(Sa){return!this.jne||Sa?!0:!1}Atj(Sa,rb){let pc;(pc=!Sa.Tj.equals(rb.Tj))&&C.a.J(512360647,814,50,"Slide Presence Changed - CurrentSlide: {0} ; NewSlide: {1}",Sa.Tj,rb.Tj);(Sa=this.MLg&&ab.M9k(Sa,rb))&&
C.a.J(512360646,814,50,"Shape Presence Changed");return pc||Sa}FXa(Sa){if(Sa){for(let rb=0;rb<Sa.length;rb++)Sa[rb]=Sa[rb].toLowerCase();for(const rb of Sa)C.a.J(512360645,814,50,"PresenceManager : RemovePresence; Removing presence for disconnected clients; ClientId: {0}",rb),(Sa=this.GQ.Ged(rb))?Sa.presenceUser?this.q3c.Ndd(new cc(Sa.Tj,Sa.presence.lU,Sa.presenceUser,!1,this.H1b(Sa.Tj),this.Otb())):C.a.J(512360643,814,15,"PresenceManager : RemovePresence; entry.PresenceUser is null"):C.a.J(512360644,
814,15,"PresenceManager : RemovePresence; entry did not exist")}}Yfg(Sa){const rb=[];for(const pc of this.GQ.K2())pc.Tj.equals(Sa)&&pc.presenceUser&&Array.add(rb,pc.presenceUser);return rb}Hfg(Sa){const rb=[];for(const pc of this.GQ.K2())pc.presence&&pc.Gtj(Sa)&&pc.presenceUser&&Array.add(rb,pc.presenceUser);return rb}g0b(){const Sa=[];for(const rb of this.GQ.K2())rb.presenceUser&&Array.add(Sa,rb.presenceUser);return Sa}Otb(){const Sa=this.g0b();return Sa?Sa.length:0}Ria(Sa){if(!Sa)return null;Sa=
Sa.toLocaleLowerCase();for(const rb of this.GQ.K2())if(rb.presenceUser&&rb.presenceUser.clientId===Sa)return rb.presenceUser;return this.seg(Sa)}Ged(Sa){const rb=this.GQ.G7a(Sa);this.LFb(rb);C.a.J(512360641,814,50,"PresenceManager : RemoveUserPresence; Removing presence; ClientId: {0};  MyClientId: {1};",rb?rb.clientId:Sa+" not found",this.dw)}s7h(Sa){this.addHandler("PresenceChanged",Sa)}K2(){return this.GQ.K2()}connectionState(){return this.$y.connectionState}disconnect(){try{C.a.J(512360640,814,
50,"PresenceManager : Disconnect"),this.zyb||this.nbc.RKk(),this.zyb=!0,this.$y.disconnect()}catch(Sa){C.a.J(512360611,814,10,"PresenceManager : Disconnect; Exception disconnecting rtc; Message: {0}; Callstack: {1}",Sa.message,Sa.stack)}}OKk(Sa,rb){this.HGg=Sa;this.GGg=rb}seg(Sa){let rb;const pc=({editor:rb}=this.vj.Mib(Sa)).returnValue;var cd=this.$y.psa(Sa),zd=!!cd;if(!pc&&!zd)return C.a.J(512360610,814,50,"PresenceUser:GetPresenceUser; ClientId {0} neither in presence nor rtc.",Sa),null;cd=zd?
cd:null;pc||C.a.J(512360609,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in EditorTable",Sa);zd||C.a.J(512360608,814,50,"PresenceUser:GetPresenceUser; ClientId{0} not in Presence",Sa);zd&&pc&&C.a.J(512360607,814,50,"PresenceUser:GetPresenceUser; ClientId {0} in both. IsSameID={1}, IsSameEmail={2}.",Sa,cd.clientId!==rb.ID,cd.email!==rb.EmailAddress);var wd=pc?new ac.a(rb.EmailAddress,void 0,rb.Name):new ac.a(this.Gyb.J_d(cd.email)||cd.email,void 0,cd.userName);wd=this.Zbb.$Ca(wd,pc?rb.ColorIndex:
null,pc?rb.ID:cd.clientId,0);zd=zd?cd.clientType:0;return new D.a(Sa,pc?rb.Name:cd.userName,wd,new pa.a(1),null,null,zd)}kLk(Sa){this.ua.Tj.equals(Sa.Tj)&&Sa.presence.lU&&Sa.presence.lU.length&&C.a.J(512360606,814,50,"PresenceManager : {0}; Begin to add shape presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}","OnEditorTableUpdate",Sa.clientId,Sa.presence.toString(),this.dw,this.ue.x1b().getTime());C.a.J(512360605,814,50,"PresenceManager : {0}; Begin to add slide presence; ClientId: {1};  Presence data: {2}; MyClientId: {3}; Session time: {4}",
"OnEditorTableUpdate",Sa.clientId,Sa.presence.toString(),this.dw,this.ue.x1b().getTime())}oLk(Sa){const rb=[this.vj.userName];let pc=0;for(var cd of this.GQ.K2())cd.presence.Tj.equals(Sa.Tj)&&!ab.i6d(cd.presence.lU,Sa.lU)&&(pc++,cd.presenceUser&&Array.add(rb,cd.presenceUser.userName));if(0<pc){cd={};let zd=0,wd=0;for(let Oa=0;Oa<rb.length;++Oa){let jb=rb[Oa];jb&&jb.length||(jb="anonymous",wd++);jb in cd||(cd[jb]=!0,zd++)}C.a.J(512360604,814,50,"PresenceManager : {0} users, {2} unique users are selecting same {1}. {3} users have no identity",
pc+1,Sa.lU&&0<Sa.lU.length?"shape":"slide",zd,wd)}}aNi(Sa){try{!this.zT.DRi()||this.GQ.G7a(Sa.clientId)||this.pIg&&Sa.fHasClientEverExperiencedNetworkLoss||(this.Q1f(Sa),this.bNi(Sa.presenceUser))}catch(rb){C.a.J(512360603,814,15,"PresenceManager:EndPresenceBootTelemetry; Exception {0};",rb.toString())}}bNi(Sa){Sa&&Sa.clientId&&(this.kIg||this.o3c||(this.kIg=!0,this.o3c=H.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry")),this.o3c&&this.o3c.fNi(Sa.clientId,ab.sdj(Sa)))}static n_d(Sa){let rb=
"";switch(Sa){case 2:rb="Connected";break;case 1:rb="Connecting";break;case 0:rb="Disconnected"}return rb}static i6d(Sa,rb){if(!Sa&&!rb)return!1;if(!Sa&&rb||Sa&&!rb||Sa.length!==rb.length)return!0;for(let pc=0;pc<Sa.length;pc++)if(Sa[pc]!==rb[pc])return!0;return!1}static Ktj(Sa,rb){return!ma.a.kfa(Sa,rb)}static M9k(Sa,rb){return Sa.Tj.equals(rb.Tj)&&ab.i6d(Sa.presence.lU,rb.presence.lU)}static sdj(Sa){return Sa&&1===Sa.client?1:0}}ab.YUd="ETU";Object(h.a)(ab,"PresenceManager",v.a,[1345,1346,1347,
1348]);var Pb=d(1107),rc=d(1110),ic=d(1005),md=d(73),Fd=d(46),ne=d(297);class ud{constructor(Sa,rb,pc,cd,zd){this.St=null;this.rv=F.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled");rb=this.Abj(rb,cd,zd);this.St=this.rv?(new Pb.a(rb)).Lqb(Sa):(new rc.a(rb)).CGc(Sa,pc)}dispose(){this.St.dispose()}KBe(){return Fd.a.ei(document.getElementById(ne.a.zVb))}Abj(Sa,rb,pc){const cd=new ic.a;cd.add(0,md.getImageClassWithCluster(F.AFrameworkApplication.mN,"MoreUsersGlyph_16x16x32"));cd.add(5,F.AFrameworkApplication.gm);
cd.add(1,md.getImageClassWithCluster(F.AFrameworkApplication.mN,this.rv?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph_16x16x32"));cd.add(4,F.AFrameworkApplication.gm);cd.add(6,pc);cd.add(8,F.AFrameworkApplication.isRtl);cd.add(12,Sa);cd.add(11,rb);this.rv&&(cd.add(16,Object(m.a)(this,this.KBe,"presenceViewportBoundsCallback")),cd.add(17,!0));return cd}Fx(Sa){this.St?(C.a.J(8958619,814,50,"PresencePawn:AddUser at PresencePawn for ClientId {0}",Sa.clientId),this.St.Fx(Sa)):C.a.J(8958617,814,
10,"PresencePawn:AddUser - Presence tool tip is null, skipping AddUser for ClientID {0}",Sa.clientId)}qJ(Sa){this.St?(C.a.J(8958623,814,50,"PresencePawn:RemoveUser at PresencePawn for ClientId {0}",Sa.clientId),this.St.qJ(Sa.clientId)):C.a.J(8958621,814,15,"PresencePawn:RemoveUser - Presence tool tip is null, skipping RemoveUser for ClientId {0}",Sa.clientId)}clear(){if(this.St)if(C.a.J(8958627,814,50,"PresencePawn:Clear at PresencePawn "),this.K7())for(const Sa of this.K7())this.qJ(Sa);else C.a.J(8958657,
814,50,"PresencePawn:Clear - Pawn has no users");else C.a.J(8958625,814,15,"PresencePawn:Clear - Presence tool tip is null, skipping ClearPresence ")}K7(){return this.St?this.St.Leb:null}tOe(){this.St&&(this.rv&&this.St.jfa(),this.St.mxa())}B6d(){this.St&&this.St.jfa()}}Object(h.a)(ud,"PresencePawn",null,[1023,106]);class gb{LVf(Sa,rb,pc){return new ud(Sa,2,rb,!0,pc)}}Object(h.a)(gb,"PresencePawnFactory",null,[1146]);var Vb=d(30);class Lc{constructor(Sa,rb,pc,cd,zd,wd,Oa,jb,qc,ib,Cb){this.Kpe=[];
this.zVa=null;this.TIg=this.SIg=this.Ske=0;this.Y_c=this.Z_c=null;this.Y2c=[];if(!rb)throw Error.argumentNull("graphTopologyManager");if(!pc)throw Error.argumentNull("presenceManager");if(!cd)throw Error.argumentNull("dragInputManager");if(!zd)throw Error.argumentNull("coauthStateChangesHandler");this.od=Sa;this.ua=rb;this.YD=pc;this.Mt=cd;this.ahe=zd;this.jla=wd;this.Qb=Oa;this.Ne=jb;this.Wcb=qc;this.ila=ib;this.CQ=Cb;this.ila.B3a(Object(m.a)(this,this.Vjd,"slidePresenceChanged"));this.od.uV(Object(m.a)(this,
this.QWa,"onSlideNavigation"));this.od.YId(Object(m.a)(this,this.KDb,"onThumbnailRefresh"));this.od.kob(Object(m.a)(this,this.Qye,"onThumbnailVisibleRangeChanged"));this.EKg=F.AFrameworkApplication.fa.ka("PPTCanvasPresenceFloodGateSurveyEnabled");(this.rv=F.AFrameworkApplication.fa.ka("PPTCanvasPresenceBubbleUXEnabled"))&&this.EKg&&(this.SIg=F.AFrameworkApplication.fa.Cc("PPTCanvasPresenceFloodGateSurveyTimeLapseSec",30),this.TIg=F.AFrameworkApplication.fa.Cc("PPTCanvasPresenceFloodGateSurveyTriggerThreshold",
3),this.Ske=0,this.zVa=I.a.Ju(H.a.instance.Ka("Common.ISystemInitiatedFeedbackWithTimeLapse")));this.od.iob(Object(m.a)(this,this.V9k,"shapeViewElementAdded"));this.od.HFf(Object(m.a)(this,this.W9k,"shapeViewElementLocked"));this.od.V6h(Object(m.a)(this,this.Gqk,"onShapeViewElementShowLockHint"));this.od.W6h(Object(m.a)(this,this.Hqk,"onShapeViewElementShowPresenceHint"));this.od.T6h(Object(m.a)(this,this.Aqk,"onShapeViewElementHidePresenceHint"))}QWa(){this.ua.Tj&&(C.a.J(512263071,814,50,"PresencePresenter::OnSlideNavigation; refreshing shape presence for slideId: {0}",
this.ua.Tj),this.jMk(this.ua.Tj))}jMk(Sa){if(this.ua.Tj&&this.ua.Tj.equals(Sa)&&(C.a.J(512263070,814,50,"PresencePresenter::RefreshShapePresenceOnSlide refreshing presence for slideId: {0}",Sa),Sa=new Vb.GraphIterator,Sa.set(this.ua.Ba),Sa.Ab(1))){do if(0<Sa.currentNode.getValue(Zb.a.shapeId)){const rb=Object(qa.a)(4,Sa.currentNode);rb&&this.jdh(rb)}while(Sa.vf(1))}}Vjd(Sa,rb){this.Mt.SDa?(C.a.J(512263069,814,50,"PresencePresenter:SlidePresenceChanged - DragInputManager active."),this.Y_c||(this.Y_c=
new A.a(2,1,0,()=>{this.handlePendingPresenceChangedEvent(rb)},90,"68"),F.AFrameworkApplication.pe.Cb(this.Y_c)),rb&&this.Y2c.push(rb)):(this.KDk(rb),this.IDk(rb))}handlePendingPresenceChangedEvent(){this.Y_c=null;this.hMk();if(this.ua.Tj&&0<this.Y2c.length){const pc={},cd={};var Sa=this.ua.Tj;for(var rb of this.Y2c){if(!Sa.equals(rb.slideId))continue;if(!rb.shapes||!rb.user)continue;rb.user.clientId in cd||(pc[rb.user.clientId]=rb.user,cd[rb.user.clientId]=new Tb.a(0));const zd=cd[rb.user.clientId];
for(const wd of rb.shapes){const Oa=rb.Y7?1:0;zd.Jb(wd)?0<(zd.ga(wd)^Oa)&&zd.$(wd,Oa):zd.add(wd,Oa)}}for(let zd in pc){Sa=pc[zd];rb=zd;if(!(rb in cd))continue;const wd=[],Oa=[];cd[rb].forEach((jb,qc)=>{0<qc?Oa.push(jb):wd.push(jb);return!0});0<wd.length&&this.Neh(wd,Sa);0<Oa.length&&this.kEf(Oa,Sa)}this.Y2c=[]}}KDk(Sa){Sa.Y7?this.qha(Sa.slideId,Sa.user):this.FXa(Sa.slideId,Sa.user)}KDb(Sa,rb){this.hdh([rb.yyh])}Qye(Sa,rb){this.hdh(rb.xfa)}hdh(Sa){const rb=[];for(const pc of Sa)Sa=this.CQ?this.Qb.dPc(pc):
this.Qb.Via(pc),this.CQ&&0>=Sa.P0||Sa&&Array.add(rb,Sa);this.gdh(rb)}qha(Sa,rb){const pc=this.ghg(Sa);pc?(pc.qha(rb),this.Bee(),C.a.J(512263067,814,50,"ThumbnailNavigationPaneView : Add slide presence succeeded. slideId  = {0}",Sa.toString())):C.a.J(21770506,814,50,"ThumbnailNavigationPaneView : AddPresence - slideId is invalid {0}",Sa.toString())}FXa(Sa,rb){const pc=this.ghg(Sa);pc?pc.FXa(rb):C.a.J(512263066,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Sa.toString())}ghg(Sa){const rb=
this.Qb.Via(Sa);return rb?Object(qa.a)(537,rb.sg(this.Wcb)):(C.a.J(512263065,814,50,"ThumbnailNavigationPaneView : RemovePresence - slideId is invalid {0}",Sa.toString()),null)}hMk(){const Sa=this.ua.presentation;if(!Sa)throw Error.argumentNull("Presentation is null");this.gdh(Sa.slides||[])}gdh(Sa){for(const pc of Sa){var rb=Object(qa.a)(120,pc);rb?(Sa=rb.Bb,(rb=Object(qa.a)(537,rb.sg(this.Wcb)))?(C.a.J(512263062,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - updating presence for {0}",
Sa.toString()),rb.XZa(this.YD.Yfg(Sa))):C.a.J(512263063,814,50,"ThumbnailNavigationPaneView : RefreshPresenceForAllThumbnail - thumbnailViewElement is null for slide {0}",Sa.toString())):C.a.J(512263064,814,10,"ThumbnailNavigationPaneView : RefreshPresenceForThumbnails - could not cast slide to ISlideNode while updating presence for {0}",pc.Bb.toString())}}Bee(){this.rv&&this.EKg&&(this.Vql()||this.zVa&&this.zVa.continueWith(()=>{this.zVa.result.logActivity("PresenceBubbleRendered","PPTCanvasPresenceFloodGateSurveyEnabled",
this.SIg)&&this.Ske++}))}Vql(){return this.Ske>=this.TIg}IDk(Sa){this.ua.Tj&&this.ua.Tj.equals(Sa.slideId)&&Sa.shapes&&(Sa.Y7?this.kEf(Sa.shapes,Sa.user):this.Neh(Sa.shapes,Sa.user))}V9k(Sa,rb){Sa=rb.xw;this.izg(Sa.shapeNode)&&(this.Kpe.push(Sa),this.Z_c||(this.Z_c=new A.a(2,1,0,Object(m.a)(this,this.handlePendingShapePresenceUpdate,"handlePendingShapePresenceUpdate"),90,"69"),F.AFrameworkApplication.pe.Cb(this.Z_c)))}handlePendingShapePresenceUpdate(){this.Z_c=null;for(const Sa of this.Kpe){if(!this.izg(Sa.shapeNode))return;
this.jdh(Sa.shapeNode)}Array.clear(this.Kpe)}jdh(Sa){const rb=Object(qa.a)(121,Sa.oc(this.Ne));if(rb&&!Sa.get_smartArtModelId()){var pc=this.YD.Hfg(Sa);if(pc)if(pc.length){Sa=this.jla.AG(Sa);Sa.XPf();for(const cd of pc)Sa.qha(cd),this.Bee()}else(pc=this.jla.kF(Sa))&&pc.XPf();this.ahe.v3g(rb)}}kEf(Sa,rb){var pc=this.Kfg();let cd=!1;for(const zd of pc){if(!Array.contains(Sa,zd.get_shapeId())||zd.get_smartArtModelId())continue;pc=Object(qa.a)(121,zd.oc(this.Ne));if(!pc||zd.get_smartArtModelId())continue;
const wd=this.jla.AG(zd);wd?(pc.isSelected&&(wd.ipb=!1),wd.qha(rb),this.Bee(),pc.isSelected&&wd.Jdc()):cd=!0}cd||C.a.J(512263060,814,50,"PresencePresenter::AddShapePresence succeeded")}Neh(Sa,rb){var pc=this.Kfg();for(const cd of pc)Array.contains(Sa,cd.get_shapeId())&&(pc=this.jla.AG(cd))&&pc.FXa(rb)}Kfg(){let Sa=null;this.ua.Ba&&(Sa=this.ua.Ba.jl());return Sa||[]}izg(Sa){return!!this.ua.Ba&&this.ua.Ba.Bb.equals(Sa.slideId)}W9k(Sa,rb){this.jla.AG(rb.xw.shapeNode).Znd(rb.presenceUser)}Gqk(Sa,rb){(rb.xw.Sp||
rb.xw.ijd)&&(Sa=this.jla.kF(rb.xw.shapeNode))&&Sa.NNe()}Hqk(Sa,rb){(Sa=this.jla.kF(rb.xw.shapeNode))&&Sa.Mcl()}Aqk(Sa,rb){(Sa=this.jla.kF(rb.xw.shapeNode))&&Sa.NZ()}}Object(h.a)(Lc,"PresencePresenter",null,[]);class Xc{constructor(Sa){this.ybc=Sa}psa(Sa){return this.ybc.psa(Sa)}W2(Sa){return this.ybc.W2(Sa)}}Object(h.a)(Xc,"PresenceUserInfoGetter",null,[1148,1086]);class Ib{constructor(Sa=null){this.vj=Sa}teg(Sa){if(!Sa||!Sa.value)return null;Sa=Sa.value;let rb=Sa.userName;if(!rb&&this.vj){let pc;
({editor:pc}=this.vj.Mib(Sa.clientId)).returnValue&&(rb=pc.Name)}return Object.assign(new D.a,{clientId:Sa.clientId,chatThreadId:Sa.chatThreadId,chatThreadDiscoveryUri:Sa.chatThreadDiscoveryUri,inChat:Sa.inChat,email:Sa.email,capabilities:new pa.a(Sa.capabilities),userName:rb})}}Object(h.a)(Ib,"PresenceUtils",null,[1343]);var gc;(function(Sa){Sa[Sa.coauthHandlerResponse=0]="coauthHandlerResponse";Sa[Sa.popSessionResponse=1]="popSessionResponse";Sa[Sa.defaultFallback=2]="defaultFallback"})(gc||(gc=
{}));Object(h.b)("RtcDiscoverType",gc);class Fb{constructor(Sa,rb,pc,cd,zd,wd,Oa,jb,qc,ib,Cb,yc,gd,od,Mc,Rd){this.OTd=Sa;this.ekd=rb;this.dkd=pc;this.Nrb=cd;this.J3b=zd;this.IRc=wd;this.Pib=Oa;this.jnd=jb;this.Afb=qc;this.mIc=ib;this.kIc=Cb;this.lJb=yc;this.ndb=gd;this.prb=od;this.J0f=Mc;this.iVd=Rd}g_j(){return String.format("[DRL-{0},SEND-{1},SELE-{2},EELE-{3},IUI-{4},IULE-{5},TUI-{6},TULE-{7},RELI-{8},DTL-{9},DEL-{10}, STF-{11}, MLD-{12}, DTL-{13}, ETR-{14}, ETCL-{15}]",this.OTd,this.ekd,this.dkd,
this.Nrb,this.J3b,this.IRc,this.Pib,this.jnd,this.Afb,this.mIc,this.kIc,this.lJb,this.ndb,this.prb,this.J0f,this.iVd)}}Object(h.a)(Fb,"RttLockSettings",null,[]);var fb=d(331);class Pc{constructor(Sa,rb,pc,cd){this.Y$b=this.X$b=null;this.Bdf=!1;this.cak=Sa;this.Ea=rb;this.Hh=pc;this.tX=cd;this.EBb=new Date;this.TFa=-1}get $a(){return this.cak}get eWc(){return this.Bdf}set eWc(Sa){this.Bdf=Sa}ZQi(){return 0<this.TFa&&Date.now()>=this.TFa}Anh(Sa){this.TFa=Sa}Y1b(){return""}Z1b(){return""}tFb(Sa){this.X$b=
Sa?this.Y1b():this.Z1b();this.Y$b=new Date}gOd(){}iOd(){return!1}Vjh(Sa,rb){Sa=Sa||"";rb=rb||"";if(Sa.length!==rb.length)return null;const pc=[];for(let cd=0;cd<Sa.length;cd+=1)Sa.charAt(cd)!==rb.charAt(cd)&&pc.push(cd);return 0<pc.length?tb.a.tH("Length",Sa.length,"FirstDiffPos",pc[0],"DiffCount",pc.length):null}UQa(Sa){return Z.a.replaceAll(Sa,"\u00a0"," ").trim()}}Object(h.a)(Pc,"ATextContentRecord",null,[]);var dd=d(33),kd=d(41);class Td extends Pc{constructor(Sa,rb,pc,cd){super(Sa,rb,pc,cd);
this.uTg=Sa.fC}get shapeNode(){return Object(qa.a)(4,this.$a)}O8k(){this.uTg=this.shapeNode.fC}Y1b(){const Sa=new r.a;var rb=this.shapeNode.AD();for(const pc of rb)(rb=this.Hh.text(pc))&&0<rb.length&&Sa.add(rb);return Sa.toArray().join(" ")}Z1b(){return this.Ea.kca(this.shapeNode)}gOd(){try{const Sa=this.Y1b()||"",rb=this.X$b||"";if(Sa!==rb){const pc=this.UQa(Sa)===this.UQa(rb),cd=this.uTg||this.shapeNode.fC;if(!pc&&!cd&&!this.shapeNode.qd){const zd=tb.a.tH("Shape",this.shapeNode.sr,"Start",kd.a.$e(this.EBb),
"LastSnapshotTime",kd.a.$e(this.Y$b),"EverEdit",this.eWc,"Type",this.getShapeType());zd.Expiration=-1<this.TFa?(+new Date(this.TFa)-+this.EBb).toString():null;const wd=Sa.length-rb.length;wd?zd.TextLengthDelta=wd:zd.SameLengthDiffDetails=this.Vjh(Sa,rb);C.a.J(25539747,814,15,dd.c(zd))}}}catch(Sa){C.a.J(25981901,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Sa)}}iOd(){try{const Sa=this.tX.I0b(this.shapeNode);if(Sa&&0<Sa.length)return!1;const rb=this.Z1b()||"",pc=this.X$b||"";if(rb!==pc&&
0>rb.indexOf(pc)&&!(0<=this.UQa(rb).indexOf(this.UQa(pc))||this.shapeNode.qd)){const cd=tb.a.tH("Shape",this.shapeNode.sr,"Start",kd.a.$e(this.EBb),"LastSnapshotTime",kd.a.$e(this.Y$b),"TextLengthDelta",rb.length-pc.length,"Type",this.getShapeType());C.a.J(25981903,814,15,dd.c(cd))}}catch(Sa){C.a.J(25981905,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Sa)}return!0}getShapeType(){return this.shapeNode.qd?"Table":this.shapeNode.Pf?"SmartArt":this.shapeNode.Ny?"TextBox":this.shapeNode.Sk?
"PlaceHolder":this.shapeNode.bta?"Shape":"Unknown"}}Object(h.a)(Td,"ShapeContentRecord",Pc,[]);class ce{constructor(Sa,rb,pc,cd,zd,wd,Oa,jb,qc,ib,Cb,yc,gd){this.Pcb=this.IBb=null;this.iO={};this.bHa={};this.ra=jb;this.LI=qc;this.Mc=Sa;this.eq=rb;this.P3j=pc;this.Ot=cd;this.ua=zd;this.Ig=wd;this.tX=Oa;this.Ea=ib;this.tc=Cb;this.Ese=yc;this.ps=gd;this.ra.wFf(Object(m.a)(this,this.cpk,"onPreSelectionChanged"));this.ra.VH(Object(m.a)(this,this.HDb,"onSetSelectionFinished"));this.LI.n8h(Object(m.a)(this,
this.qrk,"onTableCellViewElementLocked"));this.Mc.u5h(Object(m.a)(this,this.Hdi,"beforeProcessInboundResponse"));this.eq.dUb(Object(m.a)(this,this.Dqk,"onShapeViewElementOpenTextEditView"));this.eq.IBc(Object(m.a)(this,this.xqk,"onShapeViewElementCloseTextEditView"));this.eq.HFf(Object(m.a)(this,this.Cqk,"onShapeViewElementLocked"));this.P3j.b7h(Object(m.a)(this,this.mrk,"onSuccessfulInbound"));this.Ot.Yj(Object(m.a)(this,this.fh,"onPropertyChanged"));this.Ig.UH(Object(m.a)(this,this.dB,"onActiveSlideChanged"))}Dqk(Sa,
rb){Sa=Object(qa.a)(4,Object(qa.a)(fb.a,rb.xw).$a);rb=this.Ese.PRd(Sa);this.iO[Sa.id.toString()]=rb;rb.tFb(!0)}xqk(Sa,rb){Sa=Object(qa.a)(4,Object(qa.a)(fb.a,rb.xw).$a).id.toString();Sa in this.iO&&this.iO[Sa].Anh(Date.now()+this.ps.Nrb)}Cqk(Sa,rb){Sa=Object(qa.a)(4,Object(qa.a)(fb.a,rb.xw).$a).id.toString();Sa in this.iO&&delete this.iO[Sa]}cpk(){this.IBb=this.jWf}HDb(){this.Pcb=this.jWf;if(!(!this.IBb&&!this.Pcb||this.IBb&&this.Pcb&&this.Pcb.id.equals(this.IBb.id))){if(this.IBb){var Sa=this.IBb.id.toString();
Sa in this.iO&&this.iO[Sa].Anh(Date.now()+this.ps.Nrb)}this.Pcb&&(Sa=this.Ese.PRd(this.Pcb),this.iO[this.Pcb.id.toString()]=Sa,Sa.tFb(!0))}}get jWf(){var Sa=this.ra.Oa;if(!Sa||!Sa.kb||Sa.kb.vl)return null;Sa=Sa.kb;return Sa.Ua.node&&Sa.Ua.node.isConnected?this.tc.XCa(Sa.Ua.node):null}qrk(Sa,rb){Sa=rb.tableCellNode.id.toString();Sa in this.iO&&delete this.iO[Sa]}Hdi(){this.geh();for(const Sa of Object.keys(this.iO))this.iO[Sa].tFb(!0)}mrk(){this.geh();for(const Sa of Object.keys(this.iO))this.iO[Sa].gOd();
for(const Sa of Object.keys(this.bHa))this.bHa[Sa].iOd()&&delete this.bHa[Sa]}fh(Sa,rb){if(rb&&rb.node&&rb.property.id===la.a.iq.id){Sa=Object(qa.a)(5,rb.node);rb=!rb.node.loading;const pc=this.tc.XCa(Sa);if(pc)this.DVg(pc,rb),this.EVg(pc,rb);else if(Sa=this.Ea.hca(Sa))this.DVg(Sa,rb),this.EVg(Sa,rb)}}dB(){this.bHa={}}geh(){for(const Sa of Object.keys(this.iO))this.iO[Sa].ZQi()&&delete this.iO[Sa]}DVg(Sa,rb){Sa=Sa.id.toString();if(Sa in this.iO){Sa=this.iO[Sa];const pc=Object(qa.a)(Td,Sa);pc&&pc.O8k();
Sa.tFb(!0);rb&&(Sa.eWc=!0)}}EVg(Sa,rb){var pc=this.Ea.tn(Sa);pc&&this.ua.Ba&&this.ua.Ba.sid===pc.get_sid()&&this.ua.Ba.cid===pc.get_cid()&&(pc=Sa.id.toString(),rb?pc in this.bHa&&delete this.bHa[pc]:(rb=Object(ya.a)(127,Sa)?this.tX.v0b(Object(qa.a)(127,Sa)):this.tX.I0b(Object(qa.a)(4,Sa)))&&0<rb.length&&(pc in this.bHa?this.bHa[pc].tFb(!1):(Sa=this.Ese.PRd(Sa),this.bHa[pc]=Sa,Sa.tFb(!1))))}}Object(h.a)(ce,"TextContentMonitor",null,[]);class ld extends Pc{constructor(Sa,rb,pc,cd,zd){super(Sa,rb,cd,
zd);this.tc=pc}get tableCellNode(){return Object(qa.a)(127,this.$a)}Y1b(){const Sa=new r.a;this.tc.hhc(this.tableCellNode,rb=>{(rb=this.Hh.text(rb))&&0<rb.length&&Sa.add(rb)});return Sa.toArray().join(" ")}Z1b(){const Sa=new r.a;this.tc.hhc(this.tableCellNode,rb=>{rb.Sa(la.a.iq)&&(rb=rb.getValue(la.a.iq))&&0<rb.length&&Sa.add(rb)});return Sa.toArray().join(" ")}gOd(){try{const Sa=this.Y1b()||"",rb=this.X$b||"";if(Sa!==rb&&this.UQa(Sa)!==this.UQa(rb)){const pc=tb.a.tH("TableCellNode",this.Eph+"/"+
this.tableCellNode.sr,"Start",kd.a.$e(this.EBb),"LastSnapshotTime",kd.a.$e(this.Y$b),"EverEdit",this.eWc);pc.Expiration=-1<this.TFa?(+new Date(this.TFa)-+this.EBb).toString():null;const cd=Sa.length-rb.length;cd?pc.TextLengthDelta=cd:pc.SameLengthDiffDetails=this.Vjh(Sa,rb);C.a.J(37748808,814,15,dd.c(pc))}}catch(Sa){C.a.J(37748810,814,10,"ShapeContentRecord:CheckTextContent failed. {0}",Sa)}}iOd(){try{const Sa=this.tX.v0b(this.tableCellNode);if(Sa&&0<Sa.length)return!1;const rb=this.Z1b()||"",pc=
this.X$b||"";if(rb!==pc&&0>rb.indexOf(pc)&&!(0<=this.UQa(rb).indexOf(this.UQa(pc)))){const cd=tb.a.tH("TableCellNode",this.Eph+"/"+this.tableCellNode.sr,"Start",kd.a.$e(this.EBb),"LastSnapshotTime",kd.a.$e(this.Y$b),"TextLengthDelta",rb.length-pc.length);C.a.J(37748812,814,15,dd.c(cd))}}catch(Sa){C.a.J(37748814,814,10,"ShapeContentRecord:CheckWetContentUpdate failed. {0}",Sa)}return!0}get Eph(){const Sa=this.Ea.tn(this.tableCellNode);return Sa?Sa.sr:"UnknownShape"}}Object(h.a)(ld,"TableCellContentRecord",
Pc,[]);class ad{constructor(Sa,rb,pc,cd){this.Ea=Sa;this.tc=rb;this.Hh=pc;this.tX=cd}PRd(Sa){return Object(ya.a)(4,Sa)?new Td(Object(qa.a)(4,Sa),this.Ea,this.Hh,this.tX):Object(ya.a)(127,Sa)?new ld(Object(qa.a)(127,Sa),this.Ea,this.tc,this.Hh,this.tX):null}}Object(h.a)(ad,"TextContentRecordFactory",null,[1147]);var Yf=d(619);class Xd{constructor(Sa,rb,pc,cd,zd){this.Mb=Sa;this.jla=rb;this.ra=pc;this.LI=cd;this.ay=zd;this.WZc=!1}initialize(){this.ra.VH(Object(m.a)(this,this.HDb,"onSetSelectionFinished"));
this.LI.u8h(Object(m.a)(this,this.s3g,"onTypingLockStatusChanged"))}dispose(){this.ra.Ffh(Object(m.a)(this,this.HDb,"onSetSelectionFinished"));this.LI.hTk(Object(m.a)(this,this.s3g,"onTypingLockStatusChanged"))}HDb(){var Sa=this.ra.Ey();let rb=null;for(const pc of Sa)if(Sa=Object(qa.a)(oa.TableCellNode,pc))if(Sa=Object(qa.a)(1046,Sa.sg(this.Mb.Ma)))if(rb=Sa.uXc)break;this.HEh(rb)}s3g(Sa,rb){this.HEh(rb.TEi)}HEh(Sa=null){this.ra.h8()?this.Okl(Sa):this.jXk()}Okl(Sa=null){if(this.Mb.editingView&&this.Mb.editingView.Kl){const rb=
this.K$f();rb&&(this.jla.AG(rb.shapeNode).Znd(Sa),Sa&&(rb.ijd=!0,this.ay.Bbh(new Yf.a(rb)),rb.ijd=!1));this.WZc||C.a.J(37573824,828,50,"TypingLockHandler:SuspectEditingView - ContentEditableView is switching to cell-lock mode");this.Mb.editingView.disable(!1,14);this.WZc=!0}}jXk(){if(this.Mb.editingView&&this.Mb.editingView.Kl){const Sa=this.K$f();Sa&&Sa.shapeNode.qd&&(this.jla.AG(Sa.shapeNode).Znd(null),Sa.C6d());this.WZc&&C.a.J(37573826,828,50,"TypingLockHandler:ResumeEditingView - ContentEditableView is switching back to edit mode");
this.Mb.editingView.uZa();this.WZc=!1}}K$f(){let Sa=null;const rb=this.ra.Yd();1===rb.length&&(Sa=Object(qa.a)(121,rb[0].oc(this.Mb.Ma)));return Sa}}Object(h.a)(Xd,"TypingLockHandler",null,[1214,106]);var fg=d(888);class ue{constructor(){this.s0c=this.mh=this.f4=this.E_c=this.YD=this.K=this.JI=null;this.s8b=0;this.i4c=null;this.Die=!1;this.SXc=null;this.Fke=!1;this.v_c=!0}get name(){return"Presence"}fui(){this.K.register(D.a,"Common.PresenceUser").as("Common.IPresenceUser").ma();this.K.register(Ib,
"PowerpointPresence.PresenceUtils").as("Common.IPresenceConverter").ma().na(()=>new Ib(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.Die=!0}Wb(Sa){this.s8b=(new Date).getTime();this.K!==Sa&&(this.K=Sa,this.f4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder"),this.mh=this.f4.NCa(1,this.name),this.Die=!1,this.Fke=this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptUseEarlyPresenceRefactoring);this.JI=this.K.resolve("Common.AFrameworkApplication");Sa=this.K.resolve("PowerPointWebEditor.IApplicationSettings");
this.v_c=!this.K.resolve("Common.IAppSettingsManager").ka("PPTODeprecateRtcFallback");this.Die||this.fui();const rb=Sa.Zmi&&Sa.VKb?!1:Sa.tg,pc=this.wCi(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("Common.IPresenceUser"),rb,Sa["368"]);pc&&(this.K.register(1144,"Common.IRealtimeChannelBasic").ma().na(()=>pc),this.K.register(1145,"AppRealtimeChannel.IRealtimeChannel").ma().na(()=>pc),this.cui(Sa))}cui(Sa){this.K.register(Ya,"PowerpointPresence.PPTRtcProvider").as("Common.Interface.IRtcBasicProvider").ma().na(()=>
new Ya(this.K.resolve("Common.IRealtimeChannelBasic")));this.K.register(bb,"PowerpointPresence.EditorPresenceTracker").as("PowerpointPresence.IEditorPresenceTracker").ma().na(()=>new bb(this.K.resolve("PowerPointWebEditor.ICoauthStateGetter")));this.K.register(Xb,"PowerpointPresence.PptRealtimeChannelMetrics").as("PowerpointPresence.IPptRealtimeChannelMetrics").ma().na(()=>new Xb(this.K.resolve("PowerpointPresence.RtcParams"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),
this.K.resolve("PowerPointWebEditor.Core.INetworkState"),K.a.getInstance(),Sa.rtcAllowCrossDomainAccessOrigins));this.K.register(ab,"PowerpointPresence.PresenceManager").as("PowerpointPresence.IPresenceManager").as("Common.IPresenceSender").as("PowerpointPresence.IPresenceUserManager").as("Common.IPresenceRemover").ma().na(()=>new ab(this.K.resolve("Common.IPresenceUser"),F.AFrameworkApplication.fa,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerpointPresence.RtcParams"),
this.JI.bS,this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventSource"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerpointPresence.IPresenceEventNotifier"),this.K.resolve("PowerPointWebEditor.ICoauthStateGetter"),
this.K.resolve("PowerPointWebEditor.ICoauthStateSetter"),Sa,this.K.resolve("PowerPointWebEditor.Core.ICoreEventSource"),this.K.resolve("PowerpointPresence.IEditorPresenceTracker"),this.K.resolve("PowerpointPresence.IPresenceColorProvider"),this.K.resolve("PowerpointPresence.IPresenceEmailConverter"),this.K.resolve("PowerpointPresence.IPptRealtimeChannelMetrics"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerpointPresence.IPresencePerfLogger"),this.K.Ka("PowerPointWebEditor.PodsPops.IPodSeamlessFailoverManager"),
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").GPc(),this.K.resolve("PowerPointWebEditor.Core.INetworkHealthManager"),this.K.resolve("PowerPointWebEditor.IPopWebService"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner")));this.K.register(ob,"PowerpointPresence.PresenceCache").ma().na(()=>new ob(this.K.resolve("PowerpointPresence.IPresenceManager")));this.K.register(Lc,"PowerpointPresence.PresencePresenter").ma().na(()=>new Lc(this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.DragInputManager"),this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("Box4.IPageView").Ma,this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView").Ma,
this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),Sa.podsNewThumbnailVisibleRangeFetchExperience));this.K.register(Fc,"PowerPointWebEditor.PptWetChangeHandler").as("PowerPointWebEditor.IWetChangeHandler").ma().na(()=>new Fc(this.K.resolve("Common.IPresenceUser").clientId,Sa.n$k,this.K.resolve("PowerPointWebEditor.Graph.ITraverserFactory"),this.K.resolve("Box4.Graph.IGraphInstance").vd(10),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers")));const rb=new Fb(Sa.OIi,
Sa.ekd,Sa.dkd,Sa.Nrb,Sa.J3b,Sa.IRc,Sa.Pib,Sa.jnd,Sa.Afb,Sa.mIc,Sa.kIc,Sa.lJb,Sa.ndb,Sa.prb,Sa.podsTableRTTEnabled,Sa.podsTableCellLockEnabled);this.K.register(Xd,"PowerpointPresence.TypingLockHandler").as("PowerpointPresence.ITypingLockHandler").ma().na(()=>new Xd(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventSource")));this.K.register(Ha,"PowerpointPresence.CoauthStateChangesHandler").as("PowerpointPresence.ICoauthStateChangesHandler").ma().na(()=>new Ha(ea.App.Ih,this.K.resolve("PowerpointPresence.IPresenceManager"),this.K.resolve("Common.IPresenceUser").clientId,this.K.resolve("AppRealtimeChannel.IRealtimeChannel"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),
this.K.resolve("Box4.ContentEditableViewEventSource"),this.K.resolve("PowerPointWebEditor.IViewElementHelper"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.Graph.IGraphInstance").vd(12),Sa,rb,this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapePresenceView>"),
this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("PowerpointPresence.ITypingLockHandler"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView").Ma,this.K.resolve("Box4.Graph.IGraphInstance").vd(16),I.a.Ju(H.a.instance.Ka("Common.ISystemInitiatedFeedback"))));this.K.register(1146,"PowerpointPresence.IPresencePawnFactory").ma().na(()=>new gb);this.K.register(1147,"PowerpointPresence.ITextContentRecordFactory").ma().na(()=>new ad(this.K.resolve("PowerPointWebEditor.IShapeReader"),
this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("Box4.IParagraphReader"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler")));this.K.register(ce,"PowerpointPresence.TextContentMonitor").ma().na(()=>new ce(this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),ia.a.instance,this.K.resolve("Box4.Graph.IGraphInstance").vd(12),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IWetChangeHandler"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IShapeReader"),this.K.resolve("PowerPointWebEditor.Graph.ITableReader"),this.K.resolve("PowerpointPresence.ITextContentRecordFactory"),rb));this.K.register(u,"Common.App.Presence.AwayManager").ma().na(()=>this.fyi(this.K.resolve("Common.IPresenceUser"),
this.K.resolve("Common.IRealtimeChannelBasic"),this.K.resolve("Common.IPresenceRemover"),this.K.resolve("Common.IPresenceConverter"),Sa.ka("PeoplesWellExtraButtonInfoIsEnabled")));this.K.register(1148,"PowerPointWebEditor.IDelayedPresenceUserInfoGetter").ma().na(()=>new Xc(this.K.resolve("AppRealtimeChannel.IRealtimeChannel")));this.GJc().Egb("RTCConfigured")}dcj(Sa){let rb;var pc=Sa;rb=0;if(Sa=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").tdj())return pc=this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").Yid(),
{iIe:Sa,gIe:rb,CWd:pc};rb=1;if(Sa=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").$ih)return pc=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").Yid,{iIe:Sa,gIe:rb,CWd:pc};if(this.v_c)return{iIe:pc,gIe:2,CWd:!0}}vCi(){const Sa=1E3*this.K.resolve("PowerPointWebEditor.IApplicationSettings").rtcDiscoveryTimeoutSeconds;0<Sa&&(this.i4c=new A.a(2,1,Sa,()=>{this.v_c?this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").a4f=!0:this.K.qb("AppRealtimeChannel.IRealtimeChannel")||C.a.J(509670485,
828,10,"PresencePackage::createRtcDiscoveryTimeoutTask RTC Discovery Timed Out after {0} ms and attempted to fallback",Sa);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").Cfh(Object(m.a)(this,this.oye,"onPopsRtcEndpointUrlReady"));this.K.qb("AppRealtimeChannel.IRealtimeChannel")||(this.Wb(H.a.instance),this.init())},90,"111"),this.K.resolve("Common.ITaskManager").Cb(this.i4c))}wCi(Sa,rb,pc,cd){C.a.J(512360602,828,50,"PresencePackage::CreateRtcInstance; isPodsEnabled:{0}",pc);rb.clientId=
Sa.clientId;var zd=null;rb=null;const wd=K.a.getInstance();if(pc){rb=cd+"rtc2";({iIe:rb,gIe:pc,CWd:cd}=this.dcj(rb));zd=!this.K.resolve("PowerPointWebEditor.ICoauthStateGetter").amIAlone;const Oa=this.v_c&&this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").a4f,jb=this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").dyg;C.a.J(512360601,828,15,"PresencePackage::CreateRtcInstance; Discovering RTC enabled; RtcDiscoverType:{0} fCoauthoring:{1} fDefaultConnectToRtc:{2} fUseFallback:{3} fPopsRtcConfigured:{4}",
gc[pc],zd,cd,Oa,jb);if(2===pc&&!Oa)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").o7h(Object(m.a)(this,this.oye,"onPopsRtcEndpointUrlReady")),this.vCi(),null;if(!cd&&!zd)return this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").rId(Object(m.a)(this,this.oDb,"onCoauthStatusChanged")),null;zd=this.$xi(Sa,rb,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),wd)}return L.RealtimeChannel.createInstance(Sa.clientId,Sa.userSessionId,Sa.egd,Sa.oba,Sa.cmh,
3,Sa.zw,rb,zd,wd)}fyi(Sa,rb,pc,cd,zd){const wd=new Q.a;wd.Dg(pc);pc=new Q.a;pc.Dg(rb);return new u(Sa,pc.task,wd.task,cd,this.K.resolve("Common.ITaskManager"),this.JI.bS.ld.wLd?6E4:this.JI.bS.ld.awayCoauthorThresholdMs,Object(m.a)(this.JI.bS.EK(),this.JI.bS.EK().processAction,"processAction"),ja.App.m3a.notificationBar,zd)}init(){const Sa=this.K.resolve("PowerpointPresence.IPresencePerfLogger");Sa.Wh(21,ue.Abc);Sa.Wh(22,this.s8b);Sa.Wh(24,(new Date).getTime());this.K.resolve("PowerPointWebEditor.PresentationContext").isValid?
this.GJc().Egb("PresentationId"):this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").uFf(Object(m.a)(this,this.Xec,"onPresentationIdReady"));this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").wvb(()=>{this.GJc().Egb("B2IFinished")})}Xec(){this.GJc().Egb("PresentationId");this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler").Dfh(Object(m.a)(this,this.Xec,"onPresentationIdReady"))}oye(){this.i4c&&this.K.resolve("Common.ITaskManager").Ng(this.i4c);this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").Cfh(Object(m.a)(this,
this.oye,"onPopsRtcEndpointUrlReady"));this.K.qb("AppRealtimeChannel.IRealtimeChannel")||(this.Wb(H.a.instance),this.init())}oDb(Sa,rb){2!==rb.RWg||this.K.qb("AppRealtimeChannel.IRealtimeChannel")||(this.Wb(H.a.instance),this.init());this.K.qb("AppRealtimeChannel.IRealtimeChannel")&&this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler").cGe(Object(m.a)(this,this.oDb,"onCoauthStatusChanged"))}GJc(){this.s0c||(this.s0c=new fg.a(Object(m.a)(this,this.dvb,"initInternal"),["PresentationId",
"B2IFinished","RTCConfigured"]));return this.s0c}dvb(){this.K.resolve("PowerpointPresence.IPresencePerfLogger").Wh(4,this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventSource").pEe);this.K.resolve("PowerpointPresence.IPresencePerfLogger").Wh(23,(new Date).getTime());this.yzj();this.qAj();this.s0c=null}qAj(){try{let Sa="";this.K.resolve("PowerPointWebEditor.IDelayedPresenceUserInfoGetter");Sa=this.mh.ju("presencemanager");this.rAj();this.mh.qu(Sa);this.K.resolve("PowerPointWebEditor.ICoauthStateSetter").gVc=
!0;C.a.J(8958608,814,50,"PresencePackage::Init; Presence downloaded");ea.App.bQd&&(Sa=this.mh.ju("contentnotification"),Bc.init(),this.mh.qu(Sa));Sa=this.mh.ju("resolve");this.K.resolve("PowerpointPresence.IPresencePerfLogger").xOi();this.YD=this.K.resolve("PowerpointPresence.IPresenceManager");this.K.resolve("Common.IPresenceConverter");this.K.resolve("Common.IRealtimeChannelBasic");this.JI.bS.ld.cQi&&(C.a.J(512360600,814,50,"PresencePackage::Init; Refresh Peoples well after Rtc ready"),this.JI.bS.EK().processAction(w.a.C4a,
2));this.K.resolve("PowerPointWebEditor.IWetChangeHandler");this.K.resolve("Common.Interface.IRtcBasicProvider");this.K.resolve("PowerpointPresence.ICoauthStateChangesHandler");this.K.resolve("PowerpointPresence.PresencePresenter");this.K.resolve("PowerpointPresence.IPresencePawnFactory");this.K.resolve("Common.App.Presence.AwayManager");this.JI.bS.ld.hermesMonitorShapeContentChangeEnabled&&this.K.resolve("PowerpointPresence.TextContentMonitor");this.mh.qu(Sa);this.K.resolve("PowerpointPresence.IPresencePerfLogger").iOi();
this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").xZj()}catch(Sa){C.a.J(512360599,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",Sa)}}dispose(){this.YD?this.YD.disconnect():C.a.J(512360598,814,10,"PresencePackage::Dispose; m_presenceManager is null.");this.K.resolve("PowerpointPresence.IPresencePerfLogger").dispose()}rAj(){this.K.resolve("PowerpointPresence.PresenceManager").ub();C.a.J(512360597,814,50,"PresencePackage::InitializePresenceManager; Presence Manager loaded and initialized")}$xi(Sa,
rb,pc,cd){let zd=rb;zd=zd.endsWith("/")?zd+"findsession":zd+"/findsession";C.a.J(512360596,814,50,"PresencePackage::CreateAssignRtcMachineStrategy; Using rtc path: {0}; WacClusterId: {1} ",zd,Sa.oba.Kfa);rb=()=>T.FindSessionStrategy.kAi(Sa.userSessionId,Sa.oba,zd,Sa.zw,F.AFrameworkApplication.buildVersion,Sa.clientId,ue.hYi(F.AFrameworkApplication.buildVersion),cd,Sa.cmh,()=>{if(F.AFrameworkApplication.hh)return F.AFrameworkApplication.hh;const Oa=this.K.resolve("PowerPointWebEditor.PresentationContext").presentationId.string;
Oa||C.a.J(512360595,814,15,"CreateAssignRtcMachineStrategy - returning a null query string");return Oa},this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").rdj());const wd=!!this.E_c;return this.Fke||wd?this.SXc=new Va(this.E_c,rb,pc,cd,this.K.resolve("PowerpointPresence.IPresencePerfLogger")):rb()}yzj(){var Sa;if(Sa=this.K.resolve("PowerPointWebEditor.IApplicationSettings").presenceEarlyFindSessionEnabled?this.K.resolve("PowerpointPresence.IPresencePrepCacheParser").getFindSessionResponse():
this.K.resolve("PowerPointWebEditor.Core.IFindRtcSessionSimpleStrategy").OXd)Sa=X.RtcUtils.deserialize(Sa,"PresencePackage","Deserialize existing FindSession response",!0),this.rad(Sa)}rad(Sa){if(Sa)try{this.E_c=Object.assign(new O.a,{U5b:Sa[P.a.uwb],errorMessage:Sa[P.a.errorMessage],WWb:Sa[P.a.QOe],U4:Sa[P.a.U4],zA:Sa[P.a.zA],SPc:Sa[P.a.H4d],Q6c:Sa[P.a.odb],R6c:Sa[P.a.aKa],U6c:Sa[P.a.qdb]}),this.Fke&&this.SXc&&(this.SXc.findSessionResponse=this.E_c)}catch(rb){C.a.J(512360594,828,10,"Exception caught while creating FindSessionResponse: {0}",
rb)}}static main(){ue.Abc=(new Date).getTime();const Sa=new ue;F.AFrameworkApplication.fa&&F.AFrameworkApplication.fa.ka("IsSyncConfigPresenceEnabled")?(Sa.Wb(H.a.instance),Sa.K.qb("AppRealtimeChannel.IRealtimeChannel")&&Sa.init()):E.a.instance.Bc(Sa)}static hYi(Sa){return String.format("{0}, {1}, {2}",ue.hOf(aa.a[3]),ue.hOf("browser"),Sa)}static hOf(Sa){return Sa?Sa.charAt(0).toLocaleUpperCase()+Sa.substring(1,Sa.length):Sa}}ue.Abc=0;Object(h.a)(ue,"PresencePackage",null,[2,3]);Type.registerNamespace("PowerPointWebEditor");
Type.registerNamespace("PowerpointPresence");window.g_hermesPresence1JS=new Date;Type.registerNamespace("Common.App.Presence");Type.registerNamespace("AppRealtimeChannel");ue.main()},187:function(J,V,d){d.r(V);d.d(V,"RtcUtils",function(){return r});J=d(0);var h=d(376),e=d(329),m=d(33);class r{static YNd(v,A=e.RealtimeChannel.Yte){let w;try{w=m.c(v)}catch(y){throw v=String.format("Failed to JSON-serialize payload : {0}",y),h.ULS.sendTraceTag(18637072,500,10,v),Error.argument("payload",v);}if(w.length>
A)throw v=String.format("Payload exceeds maximum length: {0} > {1}.",w.length,A),h.ULS.sendTraceTag(18637074,500,10,v),Error.argument("payload",v);return w}static deserialize(v,A,w){if(!v)return null;if(Object.getType(v)!==String){var y=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",A,Object.getType(v).getName(),w);h.ULS.sendTraceTag(18637075,500,10,y);return null}y=null;try{y=m.a(v)}catch(u){v=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",
A,u,w),h.ULS.sendTraceTag(18637077,500,10,v)}return y}static eDb(v){if(!v)return"";if("string"===typeof v)return v.toString();try{return m.c(v)}catch(A){return v.toString()}}static u3f(v){let A,w,y;A=0;y=w=null;if(!v)return{a7d:A,b7d:w,Wi:y};try{const u=v.source;u&&Object.getType(u)===String&&(y=u);const D=v.context;D&&(v=D,A=v.status?v.status:0,w=v.statusText?v.statusText:null)}catch(u){}return{a7d:A,b7d:w,Wi:y}}}Object(J.a)(r,"RtcUtils",null,[])},229:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);d=d(77);class h extends d.a{constructor(e){super();this._element=null;this.element=e}get element(){return this._element}set element(e){this._element=e}get visible(){return"visible"===this.element.style.visibility}set visible(e){this.element.style.visibility=e?"visible":"hidden"}get rtl(){return"rtl"===this.element.dir.toLowerCase()}set rtl(e){this.element.dir=e?"rtl":"ltr"}get zIndex(){return this.element.style.zIndex}set zIndex(e){this.element.style.zIndex=String(e)}dispose(){this.element&&
this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;super.dispose()}createElement(e){return this.element.ownerDocument.createElement(e)}yx(){return!0}static Sqb(e,m){return e+(m?"Rtl":"")}}Object(J.a)(h,"BasePresenceControl",d.a,[106,570])},230:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m){super();this.type=e;this.Vi=m}}h.Zo="InteractivityChanged";Object(J.a)(h,"InteractivityChangedEventArgs",Sys.EventArgs,
[])},304:function(J,V,d){d.r(V);J=d(0);var h=d(376),e=d(13),m=d(101),r;(function(y){y[y.SendNotification=0]="SendNotification";y[y.SendPersistentState=1]="SendPersistentState";y[y.FindSession=2]="FindSession";y[y.Last=3]="Last"})(r||(r={}));Object(J.b)("ApiType",r);var v;(function(y){y[y.AttemptCount=0]="AttemptCount";y[y.SuccessCount=1]="SuccessCount";y[y.DropCount=2]="DropCount";y[y.FailedCount=3]="FailedCount";y[y.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";y[y.LatencyUnderThresholdCount=
5]="LatencyUnderThresholdCount";y[y.ThrottledCount=6]="ThrottledCount";y[y.Last=7]="Last"})(v||(v={}));Object(J.b)("EventCountType",v);var A=d(682);d.d(V,"FrequentLoggingMetrics",function(){return w});class w{constructor(y){this.cSf=this.x5f=null;this.zUg=this.M7f=0;this.ut=null;this.Gff=this.Uyd=0;this.$h=y;this.dAj();this.Vtd=this.L4e=this.lzd=!1;this.Oyd=0}get eQi(){return this.Vtd}Ril(y){this.Gff=y;window.setInterval(Object(e.a)(this,this.Pee,"logMetricsBatchAndReset"),y);this.Uyd=(new Date).getTime()}IG(y,
u){this.z$k(y)&&!this.L4e||this.eQi||!window.navigator.onLine||this.$h.YDa||(this.ut[y][u]++,this.lzd=!0)}dAj(){this.ut=Array(3);for(let y=0;3>y;y++){this.ut[y]=Array(7);for(let u=0;7>u;u++)this.ut[y][u]=0}}Igi(){const y={};for(let u=0;3>u;u++)for(let D=0;7>D;D++)this.iSj(u,D)&&(y[r[u]+v[D]]=this.ut[u][D]);y.FSDomain=this.x5f;y.ConnectionDomain=this.cSf;y.FSRetryInterval=this.M7f;y.MaxPayloadSize=this.zUg;y.LogNumber=this.Oyd;1===this.Oyd&&(y.FSLatencies=A.a.instance.A5i(),y.ConLatencies=A.a.instance.S1i());
return y}iSj(y,u){return 2===y&&3!==u&&0!==u?!1:!0}z$k(y){return 2===y?!1:!0}Pee(){if(this.lzd){this.Oyd++;if((new Date).getTime()-this.Uyd<5E3+this.Gff){var y=m.a.toJSON(this.Igi());h.ULS.sendTraceTag(50644352,500,15,y)}this.Uyd=(new Date).getTime();for(y=0;3>y;y++)for(let u=0;7>u;u++)this.ut[y][u]=0;this.lzd=!1}}$ck(){this.L4e=!0}static get instance(){return w.Ja}static create(y){w.instance||(w.Ja=new w(y));return w.instance}}w.Ja=null;Object(J.a)(w,"FrequentLoggingMetrics",null,[1369])},329:function(J,
V,d){d.r(V);J=d(0);var h=d(376),e=d(13),m=d(1029),r=d(955),v=d(67),A=d(25);class w{constructor(Ma,Ca){this.status=Ma;this.pxb=Ca}}Object(J.a)(w,"UserStatusInfo",null,[]);var y=d(80),u=d(682);class D{constructor(Ma,Ca){this.data=Ma;this.timeStamp=Ca}}Object(J.a)(D,"PresenceData",null,[]);class F{constructor(Ma){this.Fpa=!1;this.Anb=0;this.esd=!1;this.setTimeout=F.WSd;this.clearTimeout=F.MSd;this.F_j=Object(e.a)(this,this.SZj,"logRtcConnectingUsageStatement");this.Qr=Ma}Tkk(){this.Fpa||(this.Anb=this.setTimeout(()=>
{this.Fpa=!1;this.LDg()},8E3),this.Fpa=!0,this.esd=!1)}Dlk(){this.PM()}lrk(){this.LDg()}LDg(){this.PM();this.esd||(this.esd=!0,this.F_j())}SZj(){h.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Qr)}PM(){this.Fpa&&this.clearTimeout(this.Anb);this.Anb=0;this.Fpa=!1}static WSd(Ma,Ca){return window.setTimeout(Ma,Ca)}static MSd(Ma){window.clearTimeout(Ma)}}Object(J.a)(F,"ConnectedUsageKpiLogger",null,[1400]);class I{constructor(){this.Xdd=this.KEe;this.NEe=
this.OEe;this.Ydd=this.MEe;this.Tic=this.QEe;this.Ach=this.PEe;this.XEe=this.YEe;this.UEe=this.VEe;this.lfb=this.SEe;this.Vic=this.TEe;this.vch=this.LEe;this.OCb=this.mve;this.Zdc=this.nve}KEe(){}OEe(){}MEe(){}QEe(){}PEe(){}VEe(){}TEe(){}SEe(){}YEe(){}LEe(){}mve(){}nve(){}}Object(J.a)(I,"NoopRealtimeChannelMetrics",null,[1393,241]);class H{}H.XZa="presenceUpdated";H.updateNotification="updateNotification";H.B6g="persistentStateCleared";H.updatePersistentState="persistentStateUpdated";Object(J.a)(H,
"RtcClientMethodNames",null,[]);class L{}L.wvj="realtimeChannelHub";L.XZa="UpdatePresence";L.$ea="SendUpdateNotification";L.m_d="GetCompletePersistentStateWithMetadata";L.updatePersistentState="UpdatePersistentState";L.Sib="UpdateClientInfo";Object(J.a)(L,"RtcHubMethodNames",null,[]);class E{constructor(Ma){this.Az=Ma}kOk(Ma){this.Az.on(H.XZa,Ma)}IOk(Ma){this.Az.on(H.updateNotification,Ma)}hOk(Ma){this.Az.on(H.updatePersistentState,Ma)}gOk(Ma){this.Az.on(H.B6g,Ma)}Dul(Ma){this.Az.off(H.XZa,Ma)}Hul(Ma){this.Az.off(H.updateNotification,
Ma)}Cul(Ma){this.Az.off(H.updatePersistentState,Ma)}Bul(Ma){this.Az.off(H.B6g,Ma)}XZa(Ma){return this.Az.invoke(L.XZa,Ma)}Sib(Ma){return this.Az.invoke(L.Sib,Ma)}$ea(Ma,Ca){return this.Az.invoke(L.$ea,Ma,Ca)}m_d(Ma){return this.Az.invoke(L.m_d,Ma)}updatePersistentState(Ma,Ca){return this.Az.invoke(L.updatePersistentState,Ma,Ca)}}Object(J.a)(E,"RealtimeChannelProxy",null,[1397,1398,1399]);class aa{constructor(){this.Ujb=this.WYe=!1;this.Tjb=0;this.Ord=this.TDd=this.SDd=this.nqd=!1;this.hud=0;this.fvf=
!1;this.evf=this.dvf=0;this.TCd=!1;this.XCd=this.VCd=this.YCd=this.UCd=0;this.WCd=!1}get wLd(){return this.Ujb}get awayCoauthorThresholdMs(){return this.Tjb}get i$h(){return this.nqd}get Kal(){return this.SDd}get Lal(){return this.TDd}get Upi(){return this.Ord}get x_b(){return this.hud}get kYk(){return this.fvf}get ajh(){return this.dvf}get jYk(){return this.evf}get eYk(){return this.TCd}get fYk(){return this.UCd}get ejh(){return this.YCd}get bjh(){return this.VCd}get djh(){return this.XCd}get cjh(){return this.WCd}static createInstance(Ma){const {RealtimeChannel:Ca}=
d(329);return Ma?Object.assign(new aa,{WYe:Ma.ka("AwayStatusManagerIsEnabled"),Ujb:Ma.ka("AwayStatusOneMinuteTimeoutIsEnabled"),Tjb:Ma.Cc("AwayCoauthorThresholdMs",9E5),nqd:Ma.ka("RtcAllowCrossDomainAccessEnabled"),SDd:Ma.ka("ShouldLogOnContentNotification"),TDd:Ma.ka("ShouldLogOnHostSubscriptionNotification"),Ord:Ma.ka("RtcClientMetricsEnabled"),hud:Ma.Cc("RtcFindSessionRequestTimeoutInMS",6E4),fvf:Ma.ka("RtcJsClientFrequentlyLogsMetrics"),dvf:Ma.Cc("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),evf:Ma.Cc("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),TCd:Ma.ka("RtcClientMessageTelemetryEnabled"),UCd:Ma.Cc("RtcClientMessageTelemetrySampleSize",5),YCd:Ma.Cc("RtcSendTelemetryMessageIntervalInMS",3E5),VCd:Ma.Cc("RtcLogClientMessageMetricsTimeOutInMs",2E4),XCd:Ma.Cc("RtcMaxPayloadSizeInCharactersOverride",Ca.Yte),WCd:Ma.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RTCLogSignalrHeartBeatMessages",!1)}):Object.assign(new aa,{WYe:!1,Ujb:!1,Tjb:9E5,nqd:!1,SDd:!1,TDd:!0,Ord:!1,hud:9E4,
TCd:!1,UCd:5,YCd:3E5,VCd:2E4,XCd:Ca.Yte,WCd:!1})}}Object(J.a)(aa,"RealtimeChannelSettings",null,[1396]);var Q=d(686),O=d(1166),T=d(161);class K{constructor(Ma){this.NSb=null;this.Mwa=0;this.T5a=!1;this.el=Ma;this.el.x3a(Object(e.a)(this,this.cma,"onConnectionStateChanged"))}cma(Ma,Ca){this.Mwa=Ca.newState}Crk(){h.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.el.Ldd()}Uyj(Ma){this.NSb.init(Ma)}}Object(J.a)(K,"ARtcMessageHandler",null,[]);var X=d(985);
class P{constructor(){this.Presence=null;this.TimeStamp=0}}Object(J.a)(P,"PresenceDataEntryForClients",null,[]);var ea=d(101);class ia{constructor(Ma,Ca=""){this.DWh=Ma;this.qza=Ca}send(){return this.DWh()}get messageId(){return this.qza}}Object(J.a)(ia,"MessageHandler",null,[1423]);var ja=d(713);class C extends Sys.EventArgs{constructor(Ma,Ca,Va,Za){super();this.UGe=Ma;this.reconnectDelay=Ca;this.reason=Va;this.DJe=Za}}Object(J.a)(C,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var pa=d(959);
class Z{constructor(){this.BEd=this.Fj=null}get Kq(){return this.Fj?this.BEd?this.BEd.getTime()-this.Fj.getTime():(new Date).getTime()-this.Fj.getTime():0}start(){this.Fj=new Date}stop(){this.BEd=new Date}}Object(J.a)(Z,"SimpleStopwatch",null,[]);var qa=d(960),ya;(function(Ma){Ma[Ma.contentUpdate=0]="contentUpdate";Ma[Ma.editorsTableUpdate=1]="editorsTableUpdate";Ma[Ma.fileNameUpdate=2]="fileNameUpdate";Ma[Ma.wetContentUpdate=3]="wetContentUpdate";Ma[Ma.persistedContentUpdate=4]="persistedContentUpdate";
Ma[Ma.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";Ma[Ma.replicationTelemetry=6]="replicationTelemetry";Ma[Ma.lockUpdate=7]="lockUpdate";Ma[Ma.collabServiceContentUpdate=8]="collabServiceContentUpdate";Ma[Ma.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";Ma[Ma.saveTargetUpdate=10]="saveTargetUpdate";Ma[Ma.uploadToOcsUpdate=11]="uploadToOcsUpdate";Ma[Ma.labelUpdate=12]="labelUpdate";Ma[Ma.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";Ma[Ma.subscribeOrExtend=
14]="subscribeOrExtend";Ma[Ma.elapsedBootTelemetry=15]="elapsedBootTelemetry";Ma[Ma.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";Ma[Ma.clientToClientResponseMessage=17]="clientToClientResponseMessage";Ma[Ma.verifyNotificationPipeline=18]="verifyNotificationPipeline";Ma[Ma.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";Ma[Ma.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";Ma[Ma.last=21]="last"})(ya||(ya={}));Object(J.b)("UpdateNotificationType",ya);var Ka=d(910),
Da=d(908),la=d(909);class ma extends K{constructor(Ma,Ca,Va,Za,Db,Lb,yb,Bc,tb,Mb){super(yb);this.Az=null;this.yff=!1;this.qza=0;this.jBd=new T.a;this.uRh=ma.c2i();this.PAd=A.AFrameworkApplication.fa.Ga("OwningFeatureCrewForRtcNotificationKpis");this.Ic=Ma;this.yhf=this.xhf=0;this.NSb=Ca;this.NSb.JBc(Object(e.a)(this,this.Crk,"onTooManyUndeliveredMessages"));this._clientId=Va;this.gVh=Db;this.el.y7h(Object(e.a)(this,this.zpk,"onRefreshProxyRequired"));this.el.w7h(Object(e.a)(this,this.xpk,"onRefreshAllPersistentStateRequest"));
this.el.K7h(Object(e.a)(this,this.$ea,"sendUpdateNotification"));this.el.z5h(Object(e.a)(this,this.tnk,"onInternalPresenceUpdated"));this.el.A5h(Object(e.a)(this,this.unk,"onInternalUpdateNotificationReceived"));this.el.y5h(Object(e.a)(this,this.snk,"onInternalPersistentStateUpdated"));this.el.x5h(Object(e.a)(this,this.rnk,"onInternalPersistentStateCleared"));this.el.J7h(Object(e.a)(this,this.OJe,"sendPersistentState"));this.el.B8h(Object(e.a)(this,this.Sib,"updateClientInfo"));this.Vh=Lb;this.Qr=
Za;this.ut=Bc;this.zM=tb;this.bQb=Mb;this.Jjb=Object(O.a)(String,A.AFrameworkApplication.$c.Application)||""}zpk(Ma,Ca){this.Az=this.gVh(Ca.hubConnection);this.NSb.reset();this.Az.kOk(Object(e.a)(this,this.Wec,"onPresenceUpdated"));this.Az.hOk(Object(e.a)(this,this.Y9c,"onPersistentStateUpdated"));this.Az.gOk(Object(e.a)(this,this.kye,"onPersistentStateCleared"));this.Az.IOk(Object(e.a)(this,this.pfc,"onUpdateNotificationReceived"))}cma(Ma,Ca){this.Mwa=Ca.newState;2===Ca.newState&&this.g1k()}g1k(){for(let Ma of this.jBd)this.$ea(null,
new pa.a(Ma.key,Ma.value,!1,new m.a));this.jBd=new T.a}xpk(Ma,Ca){Ca.rOd();for(Ma=0;3>Ma;++Ma)this.U0k(Ma,Ca)}U0k(Ma,Ca){try{this.Az.m_d(Ma).done(Va=>{Ca.$Kb(Ca.JPd,"GetCompletePresenceSuccess")&&(Ca.Mui.lrk(),h.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",this.Qr),this.el.ZHk(),this.Vok(Ma,Va),this.el.cHk(Va),Ca.a3f.Jb(Ma)&&this.el.ubh(Ma,Ca.a3f.ga(Ma),new m.a))}).fail(Va=>{const {RtcUtils:Za}=d(187);Ca.$Kb(Ca.JPd,"GetCompletePresenceFail")&&(h.ULS.sendTraceTag(3249541,
500,15,"Failed to retrieve complete session state : {0} for [{1}]",Za.eDb(Va),this.Qr),this.el.Ldd())}).always(()=>{Ca.ly&&Ca.ly.stop()})}catch(Va){h.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",Ca.JPd,Va.message)}}OJe(Ma,Ca){var {RtcUtils:Va}=d(187);Ma=Ca.presence;let Za;const Db=Ca.QJa;this.zM.IG(1,0);try{Za=Va.YNd(Ma,this.bQb)}catch(yb){this.zM.IG(1,
3);h.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",yb.message);Db.setException(yb);return}Va=new v.a;Va.$(this._clientId,Object.assign(new P,{Presence:Ma,TimeStamp:(new Date).getTime()}));this.el.Rbh(Ca.type,Va);if(2!==this.Mwa)this.ut.lfb(),this.zM.IG(1,2),Db.Dg(null);else{var Lb=this.qza.toString();++this.qza;Ma=new ia(()=>this.i1k(Ca.type,Za,Lb),Lb);Ma=this.syh(0,Ca.type).add(Ma);Ma.G9c(yb=>{2===yb&&this.zM.IG(1,6);Db.Dg(null)});
Ma.F9c(()=>{})}}i1k(Ma,Ca,Va){let Za=null;const Db=new Z,Lb=new ja.a;h.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.Qr);if(2!==this.Mwa)return this.ut.lfb(),this.zM.IG(1,2),h.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.Qr),Lb.Pte(),Lb;this.Vh&&20>this.xhf&&(Za=this.Vh.zi("WebServiceCall","Send Presence Message"),this.xhf++);Db.start();Lb.idc(1);try{this.Az.updatePersistentState(Ma,Ca).done(()=>{this.ut.UEe();this.zM.IG(1,
1);h.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",Va,this.Qr);Lb.gWa(1);Db&&(Db.stop(),Db.Kq>this.Ic.ajh?this.zM.IG(1,4):this.zM.IG(1,5))}).fail(yb=>{const {RtcUtils:Bc}=d(187);this.T5a||(this.ut.lfb(),this.zM.IG(1,3),h.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",Va,Bc.eDb(yb),this.Qr));Lb.gWa(2)}).always(()=>{Za&&Za.stop()})}catch(yb){h.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",
yb.message),this.zM.IG(1,3),Lb.gWa(2)}return Lb}Sib(Ma,Ca){({RtcUtils:Ma}=d(187));const Va=Ca.Tpi,Za=Ca.QJa;let Db;try{Db=Ma.YNd(Va,this.bQb)}catch(Lb){h.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",Lb.message);Za.setException(Lb);return}try{this.Az.Sib(Db).done(()=>{h.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(Lb=>{const {RtcUtils:yb}=d(187);this.T5a||h.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",
yb.eDb(Lb));Za.Dg(null)})}catch(Lb){h.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",Lb.message),Za.Dg(null)}}$ea(Ma,Ca){({RtcUtils:Ma}=d(187));const Va=Ca.type,Za=Ca.iya,Db=Ca.QGi,Lb=Ca.QJa;let yb;this.zM.IG(0,0);try{yb=Ma.YNd(Za,this.bQb)}catch(tb){this.zM.IG(0,3);h.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",tb.message);Lb.setException(tb);return}if(2!==this.Mwa)Db?this.jBd.$(Va,
Za):(this.ut.lfb(),this.zM.IG(0,2)),Lb.Dg(null);else{var Bc=this.qza.toString();++this.qza;Ca=new ia(()=>this.F1k(Va,yb,Bc),Bc);Ca=this.syh(1,Va).add(Ca);Ca.G9c(tb=>{2===tb&&this.zM.IG(0,6);Lb.Dg(null)});Ca.F9c(()=>{})}}F1k(Ma,Ca,Va){let Za=null;const Db=new Z,Lb=new ja.a;h.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Qr);if(2!==this.Mwa)return this.ut.lfb(),this.zM.IG(0,2),h.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",
this.Qr),Lb.Pte(),Lb;this.Vh&&3===Ma&&20>this.yhf&&(Za=this.Vh.zi("WebServiceCall","Send WetContent Update"),this.yhf++);Db.start();Lb.idc(1);this.Az.$ea(Ma,Ca).done(()=>{this.ut.UEe();this.zM.IG(0,1);h.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",Va,this.Qr);Lb.gWa(1);Db&&(Db.stop(),Db.Kq>this.Ic.ajh?this.zM.IG(0,4):this.zM.IG(0,5))}).fail(yb=>{const {RtcUtils:Bc}=d(187);this.T5a||(this.ut.lfb(),this.zM.IG(0,3),h.ULS.sendTraceTag(3249507,500,
15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",Va,Bc.eDb(yb),this.Qr));Lb.gWa(2)}).always(()=>{Za&&Za.stop()});return Lb}hya(){this.Az.Dul(Object(e.a)(this,this.Wec,"onPresenceUpdated"));this.Az.Cul(Object(e.a)(this,this.Y9c,"onPersistentStateUpdated"));this.Az.Bul(Object(e.a)(this,this.kye,"onPersistentStateCleared"));this.Az.Hul(Object(e.a)(this,this.pfc,"onUpdateNotificationReceived"))}tnk(Ma,Ca){this.Wec(Ca.OKb,Ca.tZf)}Wec(Ma){this.ut.Vic();this.Y9c(0,Ma)}snk(Ma,
Ca){this.Y9c(Ca.type,Ca.OKb)}Vok(Ma,Ca){const Va={};for(let Za in Ca)Va[Za]=Ca[Za].Presence;this.o1g(Ma,Va,Ca)}Y9c(Ma,Ca){this.ut.Vic();this.o1g(Ma,Ca)}o1g(Ma,Ca,Va=null){var {RtcUtils:Za}=d(187);if(h.ULS.lxa(500,100))for(var Db in Ca);delete Ca[this._clientId];if(!ea.a.isEmpty(Ca)){for(var Lb in Ca)Db=Lb,Ca[Db]=Za.deserialize(Ca[Lb],"Presence",Db,!1,this.bQb);Za=new v.a;Lb=(new Date).getTime();for(let yb in Ca){Db=Ca[yb];let Bc=yb,tb;Va?(tb=Va[Bc],tb.Presence=Db):tb=Object.assign(new P,{Presence:Db,
TimeStamp:Lb});Za.$(Bc,tb)}this.el.Rbh(Ma,Za);switch(Ma){case 0:this.yff||(h.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Qr),this.yff=!0,A.AFrameworkApplication.Tg&&A.AFrameworkApplication.Tg.Wck());this.el.kbh(Ca,[]);break;default:this.el.NHk(Ma,Ca)}}}rnk(Ma,Ca){this.kye(Ca.IOd)}kye(Ma){this.ut.Vic();if(h.ULS.lxa(500,100))for(let Ca=0;Ca<Ma.length;++Ca);Ma.length&&(this.el.bJk(Ma),this.el.MHk(Ma),this.el.kbh({},Ma))}unk(Ma,Ca){this.pfc(Ca.type,Ca.iya)}pfc(Ma,
Ca=null){this.Ic.Kal&&0===Ma&&h.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===Ma&&this.PAd&&0<this.PAd.length){var Va=Object.assign(new Ka.a,{topLevelKpiName:"ContentUpdateNotificationReceived",featureName:"RtcNotification",crewAlias:this.PAd,vetoPillar:"RealTimeCoauth"});(Va=X.a.getInstance(Va))&&Va.logKpiUsage(this.uRh)}this.Ic.Lal&&13===Ma&&h.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",
Ca||"<none>"));this.ut.Vic();5===Ma?(Ca=(Ma=this.Kvk(Ca))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",Ma.reason,Ma.reconnectDelay):"Received client reconnection request from the server without params.",h.ULS.sendTraceTag(18637071,500,50,Ca),this.el.Ldd(Ma)):(Ca=d(187).RtcUtils.deserialize(Ca,String.format("UpdateNotification-{0}",ya[Ma]),null,!1,this.bQb),this.el.aJk(Ma,Ca))}Kvk(Ma){try{if(!Ma||""===Ma)return null;const Ca=JSON.parse(Ma);return new C(Ca[qa.a.jIe],
Ca[qa.a.dYk],Ca[qa.a.hYk],Ca[qa.a.DJe])}catch(Ca){return h.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",Ca.message),null}}syh(Ma,Ca){return this.NSb.aij(this.bij(Ma,Ca))}bij(Ma,Ca){return Ma+","+Ca}static c2i(){var Ma=new Map;Ma.set("SkipAria","True");Ma=Object.assign(new Da.a,{extendedProperties:Ma});return Object.assign(new la.a,{kpiName:"ContentUpdateNotificationReceived",kpiType:0,optionalProperties:Ma,blockFutureEmissionDurationInMs:3E5})}}Object(J.a)(ma,"RtcMessageHandler",
K,[]);class Ea{OUf(Ma,Ca=""){const {MaxOutstandingThrottler:Va}=d(956);return Va.createInstance(Ma,Ca)}KAi(Ma,Ca=""){const {MaxRateThrottler:Va}=d(958);return Va.createInstance(Ma,Ca)}}Object(J.a)(Ea,"ThrottlerFactory",null,[1395]);var ta=d(77),Ga=d(683);class oa{constructor(Ma){this.Ic=null;this.cP=!1;this.Pa=new ta.a;this.gzd=new v.a;this.ezd=new v.a;this.AFd=Ma;this.glb=this.AFd.OUf(Ca=>Ca.send(),"GlobalMaxOustandingThrottler");this.glb.JBc(()=>{this.Pa.raiseEvent("TMUDM")})}init(Ma){this.cP||
(this.Ic=Ma,this.glb.init(this.Ic.aKa,this.Ic.Rkj),this.cP=!0)}aij(Ma){var {MaxRateThrottler:Ca}=d(958),{MaxOutstandingThrottler:Va}=d(956);this.cP||this.init(new Ga.a(Ca.TWf,Va.jXf,Va.ZWf,oa.bek));({value:Ca}=this.gzd.Rf(Ma)).returnValue||(({value:Ca}=this.ezd.Rf(Ma)).returnValue||(Ca="MaxOutstandingThrottler-"+Ma,Ca=this.AFd.OUf(Object(e.a)(this.glb,this.glb.add,"add"),Ca),Ca.init(this.Ic.aKa,this.Ic.aek),Ca.JBc(()=>{this.Pa.raiseEvent("TMUDM")}),this.ezd.add(Ma,Ca)),Va="MaxRateThrottler-"+Ma,Ca=
this.AFd.KAi(Object(e.a)(Ca,Ca.add,"add"),Va),Ca.init(this.Ic.Zek),this.gzd.add(Ma,Ca));return Ca}reset(){for(let Ma of this.gzd)Ma.value.WEe();for(let Ma of this.ezd)Ma.value.WEe(),Ma.value.reset();this.glb.WEe();this.glb.reset()}JBc(Ma){this.Pa.addHandler("TMUDM",Ma)}}oa.bek=1E3;Object(J.a)(oa,"ThrottlerManager",null,[1394]);var sa=d(1103);const Ha=(Ma,Ca,Va,Za,Db,Lb,yb,Bc,tb=null,Mb=null,Hb=null,vb=null)=>{const Xb=aa.createInstance(A.AFrameworkApplication.fa),Uc=A.AFrameworkApplication.buildVersion?
A.AFrameworkApplication.buildVersion:"1.0",hb=bb(Ma,Ca,yb,Uc),Zb=Xb.Upi?d(1101).RealtimeChannelMetrics.createInstance(hb):new I;var Fc=d(304).FrequentLoggingMetrics.create(Db);Xb.kYk&&Fc.Ril(Xb.jYk);var ob="";ob=tb&&""!==tb?tb:"/rtc2/";Fc.x5f=y.a.yD(ob);const ac=ob+"signalr";tb=ob+"findsession";const pb=L.wvj;ob=new Ea;Hb=Hb||Q.a.getInstance();h.ULS.shipAssertTag(556867617,500,Xb.djh<=d(329).RealtimeChannel.AUg,"Client attempting to override max payload size beyond absolute limit");const nb=Math.min(Xb.djh,
d(329).RealtimeChannel.AUg);Fc.zUg=nb;Fc=new ma(Xb,new oa(ob),Ma,hb,Tb=>new E(Tb.createHubProxy(pb)),Bc,Hb,Zb,Fc,nb);Mb||(Mb=d(688).FindSessionStrategy.createInstance(Ca,Db,tb,Bc,Uc,yb,Ma,hb,Hb,Lb,Za,vb));Mb.x_b=Xb.x_b;Ca=new F(hb);Va=Va?Va.split(","):null;Ma=new (d(329).RealtimeChannel)(Ma,Va,hb,Bc,()=>$.hubConnection(ac),Mb,Fc,Ca,Hb,Zb,Xb,Db);Ma.init();return Ma},bb=(Ma,Ca,Va)=>String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",Ma,Ya(sa.a[Va]),Ya("browser"),Ca),Ya=Ma=>Ma?Ma.charAt(0).toLocaleUpperCase()+
Ma.substring(1,Ma.length):Ma;d.d(V,"RealtimeChannel",function(){return ua});class ua{constructor(Ma,Ca,Va,Za,Db,Lb,yb,Bc,tb,Mb,Hb,vb){this.zEd=!1;this.GY=null;this.JR=new v.a;this.xMb=1;this.o1=null;this.UJ=!1;this.ayd=(new Date(0)).getTime();this.jxf=0;this._clientId=Ma;this.Pzc=Ca;this.HY=0;this.Vh=Za;this.dsd=Bc;this.oWh=yb;this.JIh=tb;this.sLh=Db;this.RKa=Lb;this.Qr=Va;this.ut=Mb;this.Ic=Hb;this.$h=vb;this.GXh=1>100*Math.random()}get Nla(){return this.RKa.Nla}set Nla(Ma){this.RKa.Nla=Ma}get aYa(){return this.oWh}get el(){return this.JIh}init(){this.el.x7h(Object(e.a)(this,
this.nIc,"disconnectAndCreateNewConnection"));this.el.D8h(Object(e.a)(this,this.Rrk,"onUpdatePersistentStateRequestReceivedInternal"));this.el.C8h(Object(e.a)(this,this.Qrk,"onUpdatePersistentStateClearedRequestReceived"));this.$h.aBc(this.ut);A.AFrameworkApplication.ofa(()=>{const {FrequentLoggingMetrics:Ma}=d(304);this.ut.XEe();Ma.instance&&Ma.instance.Pee()});this.VUf();this.NIi();this.el.EFf(Object(e.a)(this,this.Qvl,"updateConnectionQueryString"))}NIi(){try{const Va=$.signalR;if(!Va)throw Error.invalidOperation("Failed to retrieve Signalr object");
const Za=Va.version;if(!Za)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===Za){var Ma=Va.transports;if(!Ma)throw Error.invalidOperation("Failed to retrieve transports object");var Ca=Ma.longPolling;if(!Ca)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!Ca.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Ca.supportsKeepAlive=this.QCi()}}catch(Va){h.ULS.sendTraceTag(6432339,
500,15,"Failed to disable longPolling KeepAlives: {0}",Va.message)}}QCi(){return()=>!1}VUf(){const Ma=++this.xMb;this.ayd=(new Date(0)).getTime();this.o1=this.sLh();this.el.VHk(this.o1);this.o1.stateChanged(Ca=>{this.Xkk(Ca,Ma)});this.o1.connectionSlow(Object(e.a)(this,this.brk,"onSlowConnection"));this.o1.error(Object(e.a)(this,this.Nqk,"onSignalRError"));this.o1.log=Object(e.a)(this,this.Oqk,"onSignalRLog")}$Kb(Ma,Ca){return Ma!==this.xMb?(h.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",
Ca),!1):!0}connect(){2!==this.HY&&1!==this.HY&&(h.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Qr),this.dsd.Tkk(),u.a.instance.Sil(),this.cma(1,this.HY),this.Muh())}Muh(){const Ma=this.xMb;this.zEd=!1;this.ut.Xdd();this.RKa.J2d(Object(e.a)(this,this.Lui,"connectSignalrConnection"),Object(e.a)(this,this.y_g,"onFailureToConnect"),Object(e.a)(this.aYa,this.aYa.Uyj,"initThrottlerManager"),Object(e.a)(this,this.$Kb,"verifyConnectionToken"),Ma)}y_g(Ma=null){this.ut.Ydd();
let Ca=null;!Ma||"documentsessiondeleted"!==(Ca=Ma.toLowerCase())&&"documentsessionexpired"!==Ca?this.nIc():(h.ULS.sendTraceTag(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Qr,Ma),this.disconnect())}nIc(Ma,Ca=null){h.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.GY);Ma=(Ma=2===this.HY||1===this.HY)&&!this.aYa.T5a;let Va=!0,Za=0;Ca&&Object.getType(Ca)!==Object.getType(Sys.EventArgs.Empty)&&
Ca.UGe&&""!==Ca.UGe&&(Ma=!0,this.RKa.uLe(Ca.UGe),Va=Ca.DJe,Za=Ca.reconnectDelay);Ma&&this.cma(1,this.HY);++this.xMb;this.aYa.hya();this.Ejl(Va);this.RKa.gUd();this.VUf();Ma&&window.setTimeout(Object(e.a)(this,this.Muh,"startConnecting"),Math.min(Za,3E4))}Qvl(){let Ma=null;const Ca=({correlationId:Ma}=this.RKa.rNc()).returnValue;this.o1.qs=Ca;h.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Qr,Ma)}Lui(Ma){const {FrequentLoggingMetrics:Ca}=
d(304);this.ayd=(new Date).getTime();let Va=null;this.o1.qs=({correlationId:Va}=this.RKa.rNc()).returnValue;this.Ic.i$h&&(this.o1.url=Ma,Ca.instance&&(Ca.instance.cSf=y.a.yD(Ma)));let Za=null;this.Vh&&(Za=this.Vh.zi("WebServiceCall","ConnectToServer"));h.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Qr);Ma={};this.Pzc&&(Ma.transport=1===this.Pzc.length?this.Pzc[0]:this.Pzc);Ma.pingInterval=null;u.a.instance.Uic(1,0);Ma.waitForPageLoad=!1;this.o1.start(Ma,null).done(Db=>
{this.ut.NEe();u.a.instance.Uic(1,1,!0);h.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",Db.id,Va)}).fail(Db=>{h.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1},  ClientDetails: [{2}]",this.RKa.zA,Va,this.Qr);this.y_g();this.ut.vch(Db);u.a.instance.Uic(1,1,!1);this.el.rbh(0,{["CorrelationId"]:Va,["ErrorDetails"]:Db,["ConnectionState"]:r.a[this.HY]})}).always(()=>{const {FrequentLoggingMetrics:Db}=
d(304);Za&&Za.stop();Db.instance&&(Db.instance.Vtd=!1)})}disconnect(){const {FrequentLoggingMetrics:Ma}=d(304);0===this.HY?h.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Qr):(this.ut.Ach(),Ma.instance&&(Ma.instance.Vtd=!0),h.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Qr),this.aYa.T5a=!0,this.dsd.Dlk(),this.cma(0,this.HY),this.nIc(),this.aYa.T5a=!1)}Ejl(Ma){const Ca=this.ski(),Va=this.o1,Za=this.GY,
Db=()=>{if(this.zEd)h.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{this.zEd=!0,Va.stop(!0,Ma)}catch(Lb){h.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",Lb.message)}};0<Ca?(h.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",Za,Ca),window.setTimeout(Db,Ca)):(h.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",Za),Db())}ski(){let Ma=0;0===this.o1.state&&(Ma=this.ayd+ua.qCl-
(new Date).getTime(),0>Ma&&(Ma=0));return Ma}get connectionState(){return this.HY}x3a(Ma){this.el.x3a(Ma)}PJe(Ma){return this.OJe(0,Ma)}OJe(Ma,Ca){const Va=new m.a;this.el.ubh(Ma,Ca,Va);return Va.task}FBc(Ma){this.el.FBc(Ma)}psa(Ma){return this.gjj(Ma)}bMc(){return this.SZi()}SZi(){const Ma={};for(let Ca of this.JR)Ca.value.Jb(0)&&(Ma[Ca.key]=Ca.value.ga(0).data);return Ma}gjj(Ma){return this.JR.Jb(Ma)&&this.JR.ga(Ma).Jb(0)?this.JR.ga(Ma).ga(0).data:null}Rrk(Ma,Ca){for(let Va of Ca.uzl)this.JR.Jb(Va.key)||
this.JR.$(Va.key,new T.a),Ma=Va.value,this.JR.ga(Va.key).$(Ca.type,new D(Ma.Presence,new Date(Ma.TimeStamp))),Va.key===this._clientId&&0===Ca.type&&this.el.vHk(Ma.Presence)}Qrk(Ma,Ca){for(const Va of Ca.IOd)this.JR.remove(Va)}RZi(){const Ma=new T.a;if(!this.JR.Jb(this._clientId))return Ma;for(let Ca of this.JR.ga(this._clientId))Ma.$(Ca.key,Ca.value.data);return Ma}$ea(Ma,Ca=null,Va=!1){const Za=new m.a;this.el.sEe(Ma,Ca,Va,Za);return Za.task}zAa(Ma){this.el.zAa(Ma)}i$i(){return this.W2(this._clientId)}W2(Ma){let Ca,
Va;return({value:Ca}=this.JR.Rf(Ma)).returnValue&&({value:Va}=Ca.Rf(0)).returnValue?new w(this.kjj(Va),Va.timeStamp):null}$Zi(){const Ma={};for(let Ca of this.JR)Ca.value.Rf(0).returnValue&&(Ma[Ca.key]=this.W2(Ca.key));return Ma}Sib(Ma){const Ca=new m.a;this.el.$Ik(Ma,Ca);return Ca.task}get clientId(){return this._clientId}get Qfl(){return this.GXh}dispose(){const {FrequentLoggingMetrics:Ma}=d(304);this.UJ||(this.aYa.hya(),this.$h.Eed(this.ut),this.ut.XEe(),Ma.instance&&Ma.instance.Pee(),this.UJ=
!0)}Xkk(Ma,Ca){this.$Kb(Ca,"StateChangedSignalR")&&this.cma(this.$Sf(Ma.newState),this.$Sf(Ma.oldState))}cma(Ma,Ca){var {FrequentLoggingMetrics:Va}=d(304),{ClientToClientMessageTelemetry:Za}=d(1006);if((1!==this.HY||0!==Ca||1!==Ma)&&this.HY!==Ca){const Db=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.HY,Ca,Ma]));h.ULS.sendTraceTag(3290053,500,10,Db)}if(this.HY!==Ma){switch(Ma){case 2:Va.instance&&
Va.instance.$ck();this.GY=this.o1.id;h.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.GY,this.Qr);this.v_j(this.o1);h.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");Va=null;this.Vh&&(Va=this.Vh.zi("WebServiceCall","Receive First Presence"));Za=this.xMb;this.el.UHk(Object(e.a)(this,this.$Kb,"verifyConnectionToken"),Za,this.dsd,Object(e.a)(this,this.rOd,"clearExistingPersistentState"),this.RZi(),Va);this.Ic.eYk&&(Va=100*Math.random()<=this.Ic.fYk,
d(1006).ClientToClientMessageTelemetry.haj(this.el,this.Ic,Va).start());break;case 1:2===Ca&&h.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.GY);break;case 0:if(Za.instance&&Za.instance.stop(),this.aYa.T5a)h.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.GY);else{1===Ca&&(h.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",
this.GY),this.ut.Tic());2===Ca&&h.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.GY);this.nIc();return}}this.HY=Ma;this.el.GGk(Ma,Ca)}}v_j(Ma){if(Ma&&Ma.transport&&Ma.transport.name){Ma=Ma.transport.name;var Ca=Ma.toLowerCase();"websockets"===Ca?h.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",Ma,this.Qr):"serversentevents"===Ca?h.ULS.sendTraceTag(4290752,
500,50,"Transport name - {0} for [{1}]",Ma,this.Qr):"foreverframe"===Ca?h.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",Ma,this.Qr):"longpolling"===Ca?h.ULS.sendTraceTag(4290754,500,50,"Transport name - {0} for [{1}]",Ma,this.Qr):"mocktransport"!==Ca&&h.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",Ma)}else h.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")}brk(){if(this.Ic.cjh){const Ma=y.a.BS(this.Nla,"mid");h.ULS.sendTraceTag(3249544,
500,15,"Detected that the connection [{0}] is slow for target machine [{1}]",this.GY,Ma)}else h.ULS.sendTraceTag(522716053,500,50,"Detected that the connection [{0}] is slow",this.GY)}Nqk(){h.ULS.sendTraceTag(3249545,600,15,"SignalR ERROR for connection [{0}];",this.GY)}Oqk(Ma){Ma=d(187).RtcUtils.eDb(Ma);if(this.Ic.cjh&&Ma.startsWith("Keep alive timed out.")){const Ca=y.a.BS(this.Nla,"mid");h.ULS.sendTraceTag(522716054,500,15,"SignalR lib: {0}. Target Machine: {1}",Ma,Ca)}else this.Qfl&&2E3>this.jxf&&
!Ma.startsWith("Invok")&&!Ma.startsWith("Trigger")&&(h.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",Ma),this.jxf++)}rOd(){let Ma;const Ca=[];({value:Ma}=this.JR.Rf(this._clientId)).returnValue&&this.JR.remove(this._clientId);for(let Va of this.JR.keys)Array.add(Ca,Va);for(const Va of Ca)this.JR.remove(Va);Ma&&this.JR.$(this._clientId,Ma);this.el.lHk(Ca)}$Sf(Ma){switch(Ma){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",Ma,"Unknown SignalR state");
}}kjj(Ma){return Ma&&Ma.timeStamp?(new Date).getTime()-Ma.timeStamp.getTime()>(this.Ic.wLd?6E4:this.Ic.awayCoauthorThresholdMs)?2:1:1}static createInstance(Ma,Ca,Va,Za,Db,Lb,yb,Bc=null,tb=null,Mb=null,Hb=null,vb=null,Xb=null){return Ha(Ma,Ca,Va,Xb,Za,Db,Lb,yb,Bc,tb,Mb,vb,Hb)}}ua.AUg=31E3;ua.Yte=8E3;ua.qCl=15E3;Object(J.a)(ua,"RealtimeChannel",null,[1145,1144])},682:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.oyf=!1;this.HBd=null;this.r0e=0;this.gud=this.OVf();
this.yrc=this.OVf();this.V_a=this.dlb=0;this.gF=()=>new Date}get qkl(){return this.oyf}OVf(){const e=Array(6);for(let m=0;m<e.length;m++)e[m]=0;return e}A5i(){return this.gud.toString()}S1i(){return this.yrc.toString()}Sil(){this.HBd=this.gF()}Uic(e,m,r=!1){this.qkl||(r&&(this.oyf=!0),r=this.gF(),0===e&&5<this.dlb||1===e&&5<this.V_a||(this.r0e<e?(1===this.dlb%2&&(this.gud[this.dlb]=-1,this.dlb++),this.r0e=e,1===m&&(this.yrc[this.V_a]=-1,this.V_a++),this.yrc[this.V_a]=this.XPe(r),this.V_a++):0===e?
(this.gud[this.dlb]=this.XPe(r),this.dlb++):(this.yrc[this.V_a]=this.XPe(r),this.V_a++)))}XPe(e){const m=e.getTime()-this.HBd.getTime();this.HBd=e;return m}static get instance(){h.Ja||(h.Ja=new h);return h.Ja}static set instance(e){h.Ja=e}}h.Ja=null;Object(J.a)(h,"LatencyMetrics",null,[])},683:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,m,r,v){this.Zek=e;this.aKa=m;this.aek=r;this.Rkj=v}}Object(J.a)(h,"ThrottlerManagerSettings",null,[])},686:function(J,V,d){J=d(0);
class h extends Sys.EventArgs{constructor(T,K){super();this.newState=T;this.oldState=K}}Object(J.a)(h,"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);class e extends Sys.EventArgs{constructor(T,K){super();this.Tpi=T;this.QJa=K}}Object(J.a)(e,"ClientInfoEventArgs",Sys.EventArgs,[]);class m extends Sys.EventArgs{constructor(T){super();this.presence=T}}Object(J.a)(m,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);class r extends Sys.EventArgs{constructor(T){super();this.IOd=T}}Object(J.a)(r,"PersistentStateClearedEventArgs",
Sys.EventArgs,[]);class v extends Sys.EventArgs{constructor(T,K){super();this.type=T;this.OKb=K}}Object(J.a)(v,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var A=d(1102);class w extends Sys.EventArgs{constructor(T,K=null){super();this.lG=T;this.WZh=K}get type(){return this.lG}get iya(){return this.WZh}}Object(J.a)(w,"UpdateNotificationEventArgs",Sys.EventArgs,[]);class y extends Sys.EventArgs{constructor(T){super();this.XBk=T}}Object(J.a)(y,"GotCompletePersistentStateWithMetadataEventArgs",
Sys.EventArgs,[]);class u extends Sys.EventArgs{constructor(T,K,X,P,ea,ia){super();this.$Kb=T;this.JPd=K;this.Mui=X;this.a3f=ea;this.rOd=P;this.ly=ia}}Object(J.a)(u,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);class D extends Sys.EventArgs{constructor(T){super();this.hubConnection=T}}Object(J.a)(D,"RefreshProxyEventArgs",Sys.EventArgs,[]);class F extends Sys.EventArgs{constructor(T,K){super();this.SRi=T;this.errorMessage=K}}Object(J.a)(F,"RtcConnectFailedEventArgs",Sys.EventArgs,[]);class I extends Sys.EventArgs{constructor(T,
K,X){super();this.type=T;this.presence=K;this.QJa=X}}Object(J.a)(I,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var H=d(959);class L extends Sys.EventArgs{constructor(){super()}}Object(J.a)(L,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);class E extends Sys.EventArgs{constructor(T){super();this.IOd=T}}Object(J.a)(E,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);class aa extends Sys.EventArgs{constructor(T,K){super();this.type=T;this.uzl=K}}Object(J.a)(aa,"UpdatePersistentStateRequestEventArgs",
Sys.EventArgs,[]);var Q=d(77);d.d(V,"a",function(){return O});class O{constructor(){this.Pa=new Q.a}GGk(T,K){this.Pa.raiseEvent("CSC",new h(T,K))}VHk(T){this.Pa.raiseEvent("RP",new D(T))}Ldd(T){this.Pa.raiseEvent("RC",T)}ZHk(){this.Pa.raiseEvent("RMID")}UHk(T,K,X,P,ea,ia){this.Pa.raiseEvent("RPS",new u(T,K,X,P,ea,ia))}Rbh(T,K){this.Pa.raiseEvent("UPSR",new aa(T,K))}kbh(T,K){this.Pa.raiseEvent("PU",new A.a(T,K))}vHk(T){this.Pa.raiseEvent("MPU",new m(T))}sEe(T,K,X,P){this.Pa.raiseEvent("SUN",new H.a(T,
K,X,P))}aJk(T,K){this.Pa.raiseEvent("UNR",new w(T,K))}ubh(T,K,X){this.Pa.raiseEvent("SP",new I(T,K,X))}NHk(T,K){this.Pa.raiseEvent("PSU",new v(T,K))}MHk(T){this.Pa.raiseEvent("PSC",new r(T))}lHk(T){this.Pa.raiseEvent("IPSC",new r(T))}bJk(T){this.Pa.raiseEvent("UPSC",new E(T))}hIk(T,K){this.Pa.raiseEvent("SPC",new L(T,K))}rbh(T,K){this.Pa.raiseEvent("RCF",new F(T,K))}cHk(T){this.Pa.raiseEvent("CPSWM",new y(T))}$Ik(T,K){this.Pa.raiseEvent("UCI",new e(T,K))}x3a(T){this.Pa.addHandler("CSC",T)}y7h(T){this.Pa.addHandler("RP",
T)}x7h(T){this.Pa.addHandler("RC",T)}D7h(T){this.Pa.addHandler("RMID",T)}w7h(T){this.Pa.addHandler("RPS",T)}D8h(T){this.Pa.addHandler("UPSR",T)}FBc(T){this.Pa.addHandler("PU",T)}z5h(T){this.Pa.addHandler("IPU",T)}B8h(T){this.Pa.addHandler("UCI",T)}K7h(T){this.Pa.addHandler("SUN",T)}A5h(T){this.Pa.addHandler("IUNR",T)}zAa(T){this.Pa.addHandler("UNR",T)}y5h(T){this.Pa.addHandler("IPSU",T)}x5h(T){this.Pa.addHandler("IPSC",T)}C8h(T){this.Pa.addHandler("UPSC",T)}J7h(T){this.Pa.addHandler("SP",T)}EFf(T){this.Pa.addHandler("SPC",
T)}H7h(T){this.Pa.addHandler("RCF",T)}s5h(T){this.Pa.addHandler("CPSWM",T)}mRk(T){this.Pa.removeHandler("CPSWM",T)}static getInstance(){return O.Ja||(O.Ja=new O)}}O.Ja=null;Object(J.a)(O,"RtcEventHub",null,[1356])},688:function(J,V,d){d.r(V);J=d(0);var h=d(376),e=d(13),m=d(17),r=d(955),v=d(961),A=d(25),w=d(80),y=d(63),u=d(442),D=d(489),F=d(101),I=d(45),H=d(106),L=d(962);class E{}E.clientId="ClientId";E.Yzl="UserApp";E.userSessionId="usid";E.userType="UserType";E.mAl="UserVersion";E.qic="qs";E.Wpi=
"clientProtocol";E.hhk="NoAuth";Object(J.a)(E,"RtcFindSessionInputQueryParamConstants",null,[]);class aa{constructor(C,pa,Z,qa,ya,Ka){this.Z1a=null;const {FindSessionStrategy:Da}=d(688);this.kVh=C;C=String.format("{0}={1}",E.clientId,I.a.Qe(qa));C=String.format("{0}&{1}={2}",C,E.userSessionId,I.a.Qe(ya));C=String.format("{0}&{1}={2}",C,E.Yzl,I.a.Qe(Z.toString()));C=String.format("{0}&{1}={2}",C,E.userType,I.a.Qe("1"));C=String.format("{0}&{1}={2}",C,E.mAl,I.a.Qe(pa));C=String.format("{0}&{1}={2}",
C,E.Wpi,I.a.Qe(Da.Vpi));(pa=aa.y_i(Z,Ka))&&(C=String.format("{0}&{1}",C,pa));this.uLh=C}idh(){this.Z1a=this.kVh()}aYi(){this.Z1a&&""!==this.Z1a||(this.idh(),h.ULS.sendTraceTag(575784194,500,this.Z1a&&""!==this.Z1a?50:15,"Query signature delegate called for refresh returned: {0} ",this.Z1a));const C=String.format("{0}={1}",E.qic,I.a.Qe(this.Z1a));return String.format("{0}&{1}",C,this.uLh)}static y_i(C,pa){return 4===C?String.format("{0}={1}",E.hhk,"1"):pa?pa.ojj():null}}Object(J.a)(aa,"FindSessionQueryStringGenerator",
null,[]);var Q=d(304),O=d(682),T=d(187),K=d(683);class X{}X.hUi="FSType";Object(J.a)(X,"RtcFindSessionRequestHeaders",null,[]);class P{}P.XJk="polling";Object(J.a)(P,"RtcFindSessionTypes",null,[]);var ea=d(960);class ia{}ia.iBl="RTC-TokenProofkey";ia.ASj="RTC-IsWacJsBootFsRequest";Object(J.a)(ia,"RtcRequestHeaders",null,[]);d.d(V,"FindSessionStrategy",function(){return ja});class ja{constructor(C,pa,Z,qa,ya,Ka,Da,la,ma,Ea,ta,Ga,oa=null){this.ref=(new Date(0)).getTime();this.Mff=0;this.Dvc=!1;this.mwf=
null;this.fFe=36E5;this.vkb=ja.vog;this.yNb=0;this.Sfb=null;this.Mwa=0;this.uGb=this.dSf=null;this.RVh=[v.a.uwb,v.a.errorMessage,v.a.QOe,v.a.zA,v.a.U4,v.a.H4d,v.a.odb,v.a.aKa,v.a.qdb];this.QVh=[v.a.uwb,v.a.errorMessage];this.zA=this.Nla=null;this.F4e=new aa(ta?ta:()=>A.AFrameworkApplication.hh,ya,Ka,Da,C,pa);this.dMb=Ga;this.Vh=qa;this.$h=pa;this.RNh=Z;this.Qr=la;this.el=ma;this.KNb=oa;this.G4e=!1;this.x_b=9E4;Ea&&Ea.execute(sa=>{sa.CBc(()=>{h.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",
this.Qr);this.F4e.idh()})});2>=100*Math.random()&&(this.fFe=3E5);Q.FrequentLoggingMetrics.instance&&(Q.FrequentLoggingMetrics.instance.M7f=this.fFe)}uLe(C){this.uGb=C}init(){this.el.D7h(Object(e.a)(this,this.GVk,"resetGetMachineIdDelay"));this.el.x3a(Object(e.a)(this,this.cma,"onConnectionStateChanged"))}cma(C,pa){this.Mwa=pa.newState;2===pa.newState&&(this.yNb=0)}rNc(){let C;C=this.Sfb.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.Sfb.U4,ja.xQd,I.a.Qe(C)),correlationId:C}}J2d(C,
pa,Z,qa,ya){this.T0k(()=>{qa(ya,"GetMachineIdSuccess")&&(h.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",this.zA,this.Qr),C(this.mwf),Z(this.cij()))},Ka=>{qa(ya,"GetMachineIdFailure")&&(h.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",this.Qr),pa(Ka))},qa,ya)}gUd(){this.QPf();this.xxj()}T0k(C,pa,Z,qa){h.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",
this.zA);this.zA?C():window.setTimeout(()=>{this.sendFindSessionRequestToServerInternal(C,pa,Z,qa)},this.$ji())}sendFindSessionRequestToServerInternal(C,pa,Z,qa){Z(qa,"RequestMachineId")&&(this.ref=(new Date).getTime(),Z=y.a.sj(),this.Pag(ya=>{const Ka=y.a.sj();this.rad(ya);this.cLe();C();ya=y.a.sj()-Ka;h.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",ya)},ya=>{const Ka=y.a.sj();this.QPf();Q.FrequentLoggingMetrics.instance&&Q.FrequentLoggingMetrics.instance.IG(2,3);pa(ya);ya=
y.a.sj()-Ka;h.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ya)},!1),Z=y.a.sj()-Z,h.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",Z))}xxj(){this.vkb+=ja.h9i;this.vkb=Math.min(this.vkb,ja.Vdk)}$ji(){let C=this.ref+this.vkb-(new Date).getTime();0>C&&(C=0);return C}rad(C){try{this.Sfb=C,this.Nla=C.MRf,this.zA=C.zA,this.dSf=C.U4,this.mwf=C.WWb}catch(pa){h.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",pa.toString())}}QPf(){this.zA=
null;this.RPf()}cLe(){this.RPf();this.Dvc=!0;this.Mff=window.setTimeout(Object(e.a)(this,this.dMk,"refreshMachineId"),this.fFe)}RPf(){this.Dvc&&(window.clearTimeout(this.Mff),this.Dvc=!1)}dMk(){this.Dvc=!1;this.Pag(C=>{const pa=this.dSf!==C.U4,Z=this.zA!==C.zA,qa=this.zA;this.rad(C);0!==this.Mwa&&(Z?(h.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",qa||"null",C.zA),this.el.Ldd()):(this.el.hIk(pa,Z),this.cLe()))},()=>{Q.FrequentLoggingMetrics.instance&&
Q.FrequentLoggingMetrics.instance.IG(2,3);this.cLe()},!0)}GVk(){this.vkb=ja.vog}cij(){return new K.a(this.Sfb.U6c,this.Sfb.R6c,this.Sfb.Q6c,this.Sfb.SPc)}mql(C){if(Object.getType(C)!==Object)return null;for(let pa in C);return this.tzi(C)}tzi(C){if(!(v.a.uwb in C))return null;const pa=C[v.a.uwb];var Z=pa?this.RVh:this.QVh;for(const qa of Z)if(!(qa in C))return null;Z=Object.assign(new L.a,{U5b:C[v.a.uwb],errorMessage:C[v.a.errorMessage],correlationId:H.a.create().toString()});pa&&(Z.WWb=C[v.a.QOe],
Z.U4=C[v.a.U4],Z.zA=C[v.a.zA],Z.SPc=C[v.a.H4d],Z.Q6c=C[v.a.odb],Z.R6c=C[v.a.aKa],Z.U6c=C[v.a.qdb]);return Z}B5i(C,pa){h.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.KNb.fUi.continueWith(()=>{this.KNb.fUi.result?(h.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),C(this.KNb.gUi)):(h.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),pa(this.KNb.gUi))})}uhh(C,pa,Z,qa,ya=!1){return Ka=>{O.a.instance.Uic(0,
1);C&&C.stop();this.dMb=this.uGb=null;this.HDg(Ka.data,!0,pa);var Da=T.RtcUtils.deserialize(Ka.data.Sd,"FindSession",null);if(Da)if(Da=this.mql(Da)){if(Da.U5b&&Da.U4&&Da.zA){h.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",this.Qr);this.YXj(Ka.data);Z(Da);return}pa.FindSessionFailureReason="FindSessionInvalidResponse";pa.IsRtcEnabled=Da.U5b;pa.IsQueryStringEmpty=!Da.U4;pa.IsConnectionStringEmpty=!Da.zA;h.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
this.Qr,Da.U5b,!Da.U4,!Da.zA)}else pa.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",h.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",this.Qr);else pa.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",h.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",this.Qr);this.sbh(pa,ya);qa(null)}}mhh(C,pa,Z,qa=!1){return ya=>{O.a.instance.Uic(0,1);C&&C.stop();this.dMb=this.uGb=null;
this.HDg(ya.data,!1,pa);let Ka=null;var Da="unknown";let la="unknown";ya.data&&((Da=ya.data.qj)&&ja.lkc in Da&&(Ka=Da[ja.lkc].toString()),Da=D.a[ya.data.status],la=ya.data.Le.toString());pa.FindSessionFailureReason="FindSessionRequestFailed";pa.HttpErrorCode=la;pa.HttpErrorStatus=Da;pa[ja.lkc]=Ka;h.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",Da,la,this.Qr,Ka,qa);this.sbh(pa,qa);Z(la)}}Pag(C,pa,Z=
!1){let qa=null;h.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Qr);const ya={};var Ka=this.F4e.aYi();ya[u.a.hBa]=H.a.create().toString();this.uGb&&""!==this.uGb?Ka=String.format("{0}&{1}={2}",Ka,ea.a.jIe,this.uGb):this.dMb&&""!==this.dMb&&(Ka=String.format("{0}&{1}={2}",Ka,ea.a.jIe,this.dMb),ya[ia.iBl]="True",ya[ia.ASj]="True");Ka=this.RNh+"?"+Ka;Z&&(ya[X.hUi]=P.XJk);const Da={};Da.IsNetworkOfflineBeforeSendRequest=this.$h.YDa;Da.HasAvailableConnectionsBeforeSendRequest=
this.$h.Xkg;Da.MaxConnectionsAllowed=this.$h.vUg;Da.IsRefreshMachineId=Z;this.KNb&&!this.G4e?(this.B5i(this.uhh(null,Da,C,pa,Z),this.mhh(null,Da,pa,Z)),this.G4e=!0):(this.Vh&&(qa=this.Vh.zi("WebServiceCall","GetMachineIdFromTheServer")),Q.FrequentLoggingMetrics.instance&&Q.FrequentLoggingMetrics.instance.IG(2,0),0>this.$h.sV(Ka,1,null,ya,[ja.kGc,ja.lkc,ja.lec,ja.hIe,ja.lWg,ja.gYg,ja.fYg],1,this.uhh(qa,Da,C,pa,Z),this.mhh(qa,Da,pa,Z),null,null,!1,null,this.x_b,"3",null,!0)&&(5<this.yNb&&200>this.yNb&&
h.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.yNb),window.setTimeout(()=>{this.yNb++;pa("-1")},1E3)))}HDg(C,pa,Z){Z||(Z={});Z.IsNetworkOfflineAfterRequestComplete=this.$h.YDa;Z.IsRequestSucceeded=pa;C&&(Z.EnqueueTime=C.aI,Z.InvokedTime=C.Kt,Z.CompletedTime=C.Wu,C.qj&&(ja.kGc in C.qj&&(Z.CorrelationId=C.qj[ja.kGc]),ja.lec in C.qj&&(Z[ja.lec]=C.qj[ja.lec])));h.ULS.sendTraceTag(38633565,500,pa?50:15,T.RtcUtils.eDb(Z))}sbh(C,
pa){C||(C={});C.ConnectionState=r.a[this.Mwa];pa||this.el.rbh(1,C)}YXj(C){try{var pa=!1,Z=!1,qa=C.qj,ya=w.a.yD(C.request.get_url());if(qa&&ja.hIe in qa){const Ea=qa[ja.hIe].toString().toLocaleLowerCase();Z="true"===Ea;pa="false"===Ea}qa=!1;const ma=0<=ya.toLocaleLowerCase().indexOf("collab");Z&&!ma?qa=!0:pa&&ma&&(qa=!0);if(qa){pa={};pa.HostName=ya;pa.Status=D.a[C.status];pa.HttpStatus=C.Le.toString();var Ka=C.request.get_headers();for(let Ea in Ka){var Da=Ka[Ea];(ya=Ea)&&0<ya.length&&(Z=0,Da&&(Z=
Da.toString().length),pa["r_"+ya]=Z)}if(C.qj){const Ea=new m.a;Ea.add(ja.kGc);Ea.add(ja.lec);Ea.add(ja.lkc);Ea.add(ja.gYg);Ea.add(ja.fYg);Ea.add(ja.lWg);ja.o3h(pa,C.qj,Ea)}ja.j3h(C.request.get_url(),pa);var la=F.a.toJSON(pa);h.ULS.sendTraceTag(559437006,500,15,la)}}catch(ma){h.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",ma.toString())}}static createInstance(C,pa,Z,qa,ya,Ka,Da,la,ma,Ea,ta,Ga=null){return ja.KGc(C,pa,Z,qa,ya,Ka,Da,la,ma,Ea,null,ta,Ga)}static kAi(C,pa,
Z,qa,ya,Ka,Da,la,ma,Ea,ta=null){return ja.KGc(C,pa,Z,qa,ya,3,Ka,Da,la,ma,Ea,ta,null)}static KGc(C,pa,Z,qa,ya,Ka,Da,la,ma,Ea,ta,Ga,oa=null){C=C||H.a.create().toString();C=new ja(C,pa,Z,qa,ya,Ka,Da,la,ma,Ea,ta,Ga,oa);C.init();return C}static o3h(C,pa,Z){for(let qa of Z)qa in pa&&(C[qa]=pa[qa])}static j3h(C,pa){if(C){var Z=C.indexOf("?");if(-1!==Z)for(C=C.substr(Z+1).split("&"),Z=0;Z<C.length;++Z){var qa=C[Z].split("=");if(2===qa.length){const ya=qa[0];if(ya&&0<ya.length){let Ka=0;if(qa=qa[1])Ka=qa.length;
pa["q_"+ya]=Ka}}}}}}ja.h9i=3E3;ja.Vdk=3E5;ja.Vpi="1.0";ja.vog=1E3;ja.kGc="X-CorrelationId";ja.xQd="corrid";ja.lkc="RtcErrorCode";ja.lec="X-OfficeCluster";ja.hIe="X-NewEnv";ja.lWg="X-MSEdge-Ref";ja.fYg="X-OFFICEFD";ja.gYg="X-OfficeFE";Object(J.a)(ja,"FindSessionStrategy",null,[1351])},713:function(J,V,d){J=d(0);class h{constructor(){this.CZe=this.asd=!1;this.callback=null}xec(m){this.callback=m;this.zzh()}VTg(m){this.asd||(this.asd=!0,this.pLh=m,this.zzh())}zzh(){this.asd&&this.callback&&!this.CZe&&
(this.CZe=!0,this.callback(this.pLh))}}Object(J.a)(h,"CompletionTask",null,[]);d.d(V,"a",function(){return e});class e{constructor(){this.rgf=new h;this.pgf=new h}G9c(m){this.rgf.xec(m)}F9c(m){this.pgf.xec(m)}idc(m){this.rgf.VTg(m)}gWa(m){this.pgf.VTg(m)}Pte(){this.idc(2);this.gWa(2)}}Object(J.a)(e,"MessageStatus",null,[1422])},955:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.disconnected=0]="disconnected";e[e.connecting=1]="connecting";e[e.connected=2]="connected"})(h||
(h={}));Object(J.b)("ChannelConnectionState",h)},956:function(J,V,d){d.r(V);d.d(V,"MaxOutstandingThrottler",function(){return r});J=d(0);var h=d(13),e=d(77);V=d(957);var m=d(713);class r extends V.a{constructor(v,A=""){super(v,A);this.odb=this.aKa=0;this.Pa=new e.a;this.Flb=!1;this.mwc=this.Rrc=this.zrc=this.zFd=0;this.Hzc=[];this.clearTimeout=r.MSd}add(v){this.Glb||this.init(r.jXf,r.ZWf);this.O2a++;const A=new m.a;this.iwb?this.kid(v,A):this.mwc<this.odb?this.Kkc(v,A):(this.kid(v,A),this.Flb=!1);
return A}Kkc(v,A){v=this.awf(v);const w=this.setTimeout(Object(h.a)(this,this.$nk,"onMessageWaitTimeExpired"),this.aKa);++this.mwc;Array.add(this.Hzc,w);const y=this.zrc;v.G9c(u=>{A.idc(u)});v.F9c(u=>{this.zrc===y&&(this.Znk(y,w),A.gWa(u))})}Znk(v,A){this.zrc===v&&(--this.mwc,this.clearTimeout(A),Array.remove(this.Hzc,A),this.iwb&&this.y1k())}y1k(){this.iwb&&!this.Flb&&(this.zFd=this.setTimeout(Object(h.a)(this,this.z1k,"sendThrottledMessageFromTimer"),0),this.Flb=!0)}z1k(){this.Flb=!1;if(this.iwb){const v=
this.Dzc,A=this.znb;this.pWb(!1);this.Kkc(v,A)}}$nk(){++this.Rrc;this.Rrc>Math.floor(this.odb/2)&&(this.Rrc=-1E9,this.Pa.raiseEvent("TMUDM"))}JBc(v){this.Pa.addHandler("TMUDM",v)}reset(){this.O2a=this.MSb=this.iNb=this.Rrc=0;++this.zrc;for(const v of this.Hzc)this.clearTimeout(v);this.mwc=0;this.Hzc=[];this.pWb(!0);this.Flb&&(this.clearTimeout(this.zFd),this.zFd=0,this.Flb=!1)}init(v,A){this.Glb||(this.aKa=v,this.odb=A,this.Glb=!0)}static createInstance(v,A=""){return new r(v,A)}static MSd(v){window.clearTimeout(v)}}
r.jXf=15E3;r.ZWf=5;Object(J.a)(r,"MaxOutstandingThrottler",V.a,[1419,1420])},957:function(J,V,d){d.d(V,"a",function(){return e});J=d(0);var h=d(376);class e{constructor(m,r=""){this.iNb=this.MSb=0;this.Ywd=!1;this.znb=this.Dzc=null;this.Glb=!1;this.awf=m;this.tyh=r;this.setTimeout=e.WSd;this.O2a=this.MSb=this.iNb=0}WEe(){0<this.O2a&&0<this.iNb&&h.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.tyh,this.iNb,this.O2a);0<this.O2a&&0<this.MSb&&h.ULS.sendTraceTag(36545634,
500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.tyh,this.MSb,this.O2a)}get iwb(){return this.Ywd}kid(m,r){this.MSb++;this.pWb(!0);this.Ywd=!0;this.Dzc=m;this.znb=r}pWb(m){this.Ywd=!1;this.znb&&m&&(this.iNb++,this.znb.Pte());this.znb=this.Dzc=null}static WSd(m,r){return window.setTimeout(m,r)}}Object(J.a)(e,"ThrottlerBase",null,[])},958:function(J,V,d){d.r(V);d.d(V,"MaxRateThrottler",function(){return m});J=d(0);var h=d(13);V=d(957);var e=d(713);class m extends V.a{constructor(r,
v=""){super(r,v);this.qdb=0;this.DPb=(new Date(0)).getTime();this.currentTime=()=>(new Date).getTime()}init(r){this.Glb||(this.qdb=r,this.Glb=!0)}add(r){this.Glb||this.init(m.TWf);this.O2a++;const v=this.currentTime(),A=new e.a;this.DPb>v&&(this.DPb=v);this.iwb?(this.pWb(!0),this.kid(r,A)):this.DPb+this.qdb<=v?this.Kkc(r,A):(this.kid(r,A),this.setTimeout(Object(h.a)(this,this.x1k,"sendThrottledMessage"),this.DPb+this.qdb-v));return A}x1k(){if(this.iwb){const r=this.Dzc,v=this.znb;this.pWb(!1);this.Kkc(r,
v)}}Kkc(r,v){this.DPb=this.currentTime();r=this.awf(r);r.G9c(A=>{v.idc(A)});r.F9c(A=>{v.gWa(A)})}static createInstance(r,v=""){return new m(r,v)}}m.TWf=200;Object(J.a)(m,"MaxRateThrottler",V.a,[1421,1420])},959:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m,r,v){super();this.type=e;this.iya=m;this.QGi=r;this.QJa=v}}Object(J.a)(h,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},960:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}
h.jIe="rr";h.hYk="rd";h.dYk="rbp";h.DJe="sa";Object(J.a)(h,"RtcReconnectParams",null,[])},961:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.qdb="throttling_messageDelay";h.uwb="enabled";h.aKa="throttling_timeToWaitForResponse";h.odb="throttling_maxNumberOfOutstandingMessages";h.H4d="throttling_globalMaxNumberOfOutstandingMessages";h.errorMessage="errorMessage";h.QOe="url";h.U4="queryString";h.zA="connectionString";Object(J.a)(h,"RtcFindSessionOutputFieldNameConstants",null,[])},
962:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.SPc=this.Q6c=this.R6c=this.U6c=0;this.U5b=!1;this.correlationId=this.zA=this.U4=this.WWb=this.errorMessage=null}get MRf(){return this.WWb+"?"+this.U4}}Object(J.a)(h,"FindSessionResponse",null,[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.presence1.js.map