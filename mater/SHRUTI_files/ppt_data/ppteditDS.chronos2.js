'use strict';(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1008:function(J,V,d){J=d(0);class h{constructor(){this.Ver=1}}Object(J.a)(h,"CacheItem",null,[]);d.d(V,"a",function(){return e});class e{constructor(m){this.wvc=m}Isj(m){return Math.abs((new Date).getTime()-m.CreatedOn)<864E5*m.RR}n0i(m){const r=this.wvc.getItem(m);if(r){let v=new h;try{v=Sys.Serialization.JavaScriptSerializer.deserialize(r,!0)}catch(A){return this.wvc.removeItem(m),null}if(this.Isj(v))return v.Data?
v.Data:v.data;this.wvc.removeItem(m)}return null}W2k(m,r){const v=new h;v.Data=r;v.data=r;v.RR=1;v.CreatedOn=(new Date).getTime();this.wvc.setItem(m,Sys.Serialization.JavaScriptSerializer.serialize(v))}}Object(J.a)(e,"AppsDataCacheManager",null,[713])},1104:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=
0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}static z_i(e){switch(e){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}}}Object(J.a)(h,"WopiAuthContext",null,[763])},1202:function(J,V,d){d.r(V);var h=d(0),e=d(68),m=d(376),r=d(13),v=d(25),A=d(195),w=d(135),y;(function(t){t[t.error=0]="error";t[t.warning=1]="warning";t[t.tip=2]="tip";t[t.intelligentService=3]="intelligentService"})(y||(y={}));Object(h.b)("AccessibilityRuleCategory",y);var u=d(55),
D=d(70),F=d(35),I=d(124),H=d(180),L=d(114);class E{constructor(t,N,ha=null){this.Fpd=null;this.O$e=this.m9e=!1;this.nAa=t;this.mqc=N;this.Ca=ha;this.kn.ya(F.a.mqi,D.a.frame,Object(r.a)(this,this.tK,"closePane"))}get kn(){return this.Ca||(this.Ca=v.AFrameworkApplication.Ta)}set kn(t){this.Ca=t}yNi(){this.m9e||(this.nAa.initialize(this),this.mqc.initialize(this),this.m9e=!0)}Pwe(){L.c(19969184,200,50,"{0}",{["AccCheckInvoked"]:1});this.mqc.mYk()}Tl(t,N,ha){if(1===ha)return A.SessionStatusManager.instance.gja?
8:32;this.nAa.isVisible||this.yNi();this.Jel();return 32}tK(t,N,ha){1!==ha&&this.nAa.Ns();return 32}wye(){this.nAa.wsh(!0)}eUd(t){if(t){if(t.AccessibilityRules&&Object.keys(t.AccessibilityRules).length){const ha=t.AccessibilityRules;for(let za in ha){var N=za;const Ra=ha[za].RuleId+"";N!==Ra&&L.c(36214998,200,15,"AccessibilityRules is malformed: rule ID {0} maps to rule with ID {1}",N,Ra)}this.Fpd=ha}else!this.Fpd&&t.Results&&0<t.Results.length?(L.c(18993251,200,15,"No accessibility rule definitions available"),
t.IsSuccess=!1):t.AccessibilityRules=this.Fpd;t.IsSuccess||L.c(19969185,200,50,"{0}",{["accCheckFailed"]:1});this.cQk(t);this.TZj(t);this.nAa.eUd(t)}}cQk(t){const N=t.AccessibilityRules;if(t=t.Results)for(let ha=t.length-1;0<=ha;ha--){const za=t[ha];let Ra="";const qb=za.RuleId;za.ContentName||(Ra+="Result does not have content name. ");qb in N||(Ra+=String.format("No accessibility check rule exists for ID {0}.",qb));0<Ra.length&&(L.c(36214999,200,15,"Omitting invalid accessibility check result: "+
Ra),Array.removeAt(t,ha))}}Ldj(){return v.AFrameworkApplication.fa.ka("DynamicBundlesIsEnabled")?appResourceLoader.loadChunk("accessibility-checker-pane-strings"):u.a.instance.resolve("Common.IDynamicScriptLoaderProvider").Jv.loadScript("accessibility-checker-pane-strings")}Jel(){this.O$e?this.nAa.Tl():this.Ldj().then(()=>{this.O$e=!0;this.nAa.Tl()}).catch(t=>m.ULS.sendTraceTag(540034694,334,10,"Failed to load the resources for the accessibilityChecker feature: {0}",t))}TZj(t){var N={};const ha={};
var za=t.Results,Ra=[];Array.add(Ra,Object.assign(new I.a,{name:"FinalViolationCount",int64:0}));Array.add(Ra,Object.assign(new I.a,{name:"FinalErrorCount",string:"0"}));Array.add(Ra,Object.assign(new I.a,{name:"FinalWarningCount",string:"0"}));Array.add(Ra,Object.assign(new I.a,{name:"FinalTipCount",string:"0"}));Array.add(Ra,Object.assign(new I.a,{name:"FinalIntelligentServiceCount",string:"0"}));if(za){for(const vc of za)if(t.AccessibilityRules){var qb=t.AccessibilityRules[vc.RuleId];if(qb){if(N[y[qb.Category]]){let Zc=
N[y[qb.Category]];N[y[qb.Category]]=++Zc}else N[y[qb.Category]]=1;ha[vc.RuleId]?(qb=ha[vc.RuleId],ha[vc.RuleId]=++qb):ha[vc.RuleId]=1}}Ra[0].int64=za.length;for(var Qb in N)switch(t=N[Qb],za=Qb,za="Final"+za.charAt(0).toUpperCase()+za.substring(1,za.length)+"Count",za){case "FinalErrorCount":Ra[1].string=t.toString();break;case "FinalWarningCount":Ra[2].string=t.toString();break;case "FinalTipCount":Ra[3].string=t.toString();break;case "FinalIntelligentServiceCount":Ra[4].string=t.toString()}}w.a.sendTelemetryEvent(Object.assign(new H.a,
{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerViolationInformation"),dataFields:Ra}));for(let vc in ha)N=vc,Ra=ha[vc],Qb=[],Array.add(Qb,Object.assign(new I.a,{name:"RuleID",string:N})),Array.add(Qb,Object.assign(new I.a,{name:"FinalViolationCount",string:Ra.toString()})),w.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}","Office.UX.AccChecker","AccCheckerFinalViolationCountPerRule"),dataFields:Qb}))}dispose(){this.nAa&&this.nAa.dispose();this.mqc&&this.mqc.dispose()}}
Object(h.a)(E,"AAccessibilityCheckManager",null,[190,106]);var aa=d(78),Q=d(1166),O=d(61),T=d(273),K=d(26);class X extends E{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc){super(t,N);this.dcb=this.mGa=null;this.Fa=ha;this.yb=za;this.Eq=Ra;this.kX=qb;this.ua=Qb;this.ra=vc;this.Qb=Zc;this.Ire=!1}i4k(t){if(!t)return K.a.J(19227927,334,15,"Cannot navigate since violation data is null"),!1;if(t.sldIdField){var N=new O.a(Object.assign(new T.a,{Sid:t.sldIdField.sidField,Cid:t.sldIdField.cidField}));N=this.Qb.Via(N);
if(!N)return!1;let ha=null;if(t.spIdFieldSpecified&&(ha=N.ZB(t.spIdField),!ha&&this.Ire))return!1;this.k0k(N,ha)}else K.a.J(19227929,334,15,"There is no slide id info in violation data");return!0}Pwe(){this.Ire=!1;super.Pwe()}wye(){this.Ire=!0;super.wye()}k0k(t,N){if(t){const ha=this.ua.Ba!==t?!0:!1;N&&(this.dcb=N,ha?this.Eq.uV(Object(r.a)(this,this.kDb,"onActiveSlideDomChanged")):this.ilh());ha&&(this.kX.Ba=t);this.ra.Cy();this.Fa.Ad()}}kDb(){this.Eq.Tma(Object(r.a)(this,this.kDb,"onActiveSlideDomChanged"));
this.mGa||(this.mGa=new aa.a(2,1,0,Object(r.a)(this,this.pye,"onPostActiveSlideDomChangedTask"),90,"20"),this.yb.Cb(this.mGa))}pye(){this.mGa=null;this.ilh()}Ad(){this.kX.nK.$o||this.Fa.Ad()}ilh(){if(this.dcb){const t=Object(Q.a)(121,this.dcb.sg(this.kX.nK.Ma));t?t.ll?K.a.J(19227931,334,50,"Shape view element of node {0} has been disposed",this.dcb.id):t.Sp?t.Ejd():this.ra.selectShape(this.dcb,!0):K.a.J(19227933,334,50,"Try select node {0} but cannot find its shape view element",this.dcb.id);this.Ad();
this.dcb=null}}}Object(h.a)(X,"PptAccCheckManager",E,[]);class P{constructor(){this.AccessibilityRules=null;this.IsSuccess=this.IsPartialResult=!1;this.Results=null}static deserialize(t){t=Sys.Serialization.JavaScriptSerializer.deserialize(t);const N=t.AccessibilityRules,ha={};if(N)for(let za=0;za<N.length;++za){const Ra=N[za];ha[Ra.Key]=Ra.Value}t.AccessibilityRules=ha;return t}}Object(h.a)(P,"AccessibilityCheckResultCollection",null,[]);class ea{}Object(h.a)(ea,"AccessibilityCheckResult",null,[]);
class ia{}Object(h.a)(ia,"AccessibilityCheckRule",null,[]);class ja{constructor(t){this.JKa=null;this.J5e=t}get fileId(){return this.J5e?this.J5e():null}initialize(t){this.JKa=t}wZg(t){this.JKa.eUd(t)}}Object(h.a)(ja,"AAccessibilityCheckService",null,[191,106]);var C=d(17),pa=d(107);class Z extends pa.a{constructor(){super()}Ok(){return 56}}Object(h.a)(Z,"AccCheckRequest",pa.a,[]);var qa=d(240);class ya extends ja{constructor(t,N){super(null);this.pi=t;this.jVa=N}mYk(){const t=new qa.a(new Z,Object(r.a)(this,
this.ajk,"onAccCheckSucceed"),Object(r.a)(this,this.$ik,"onAccCheckFailed"));this.pi.Cb(t)}dispose(){}get GDj(){return 0<this.jVa.yTb.length}ajk(t){if(t&&t.ACResult&&(t=this.Efi(t.ACResult))){this.wZg(t);K.a.J(19227935,334,50,"Acc-check succeeded");return}this.STg("Succeeded but response is invalid")}$ik(t){this.STg(t.toString());return!0}STg(t){K.a.J(19227937,334,50,String.format("Acc-check failed: {0}",t));t=new P;t.IsSuccess=!1;this.wZg(t)}Efi(t){if(t){var N=null;try{N=JSON.parse(t)}catch(ha){return K.a.J(19227939,
334,10,"Cannot parse acc-check result json: {0}",ha.toString()),null}if(N){t=new P;t.IsSuccess=!0;t.IsPartialResult=N.isPartialResultField;t.AccessibilityRules={};if(N.violatedRulesField){const ha=new C.a;for(const za of N.violatedRulesField)if(N=this.Gfi(za)){t.AccessibilityRules[N.RuleId]=N;for(const Ra of za.violationsField){const qb=new ea;qb.RuleId=N.RuleId;qb.ContentName=Ra.labelField;qb.ContentId=Ra;ha.add(qb)}}t.Results=ha.toArray()}return t}}return null}Gfi(t){if(!t)return null;if(t.ruleIdField>=
this.jVa.yTb.length)return K.a.J(19227971,334,10,"Rule id {0} is bigger than total rule info list count {1}",t.ruleIdField,this.jVa.yTb.length),null;const N=new ia;N.RuleId=t.ruleIdField.toString();N.RuleName=this.jVa.yTb[t.ruleIdField].ruleTextField;switch(this.jVa.yTb[t.ruleIdField].ruleTypeField){case 0:N.Category=0;break;case 1:N.Category=1;break;case 2:N.Category=2;break;case 3:N.Category=3}return N}}Object(h.a)(ya,"PptAccCheckService",ja,[994,191,106]);class Ka{get Kvi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogActionButton}get Lvi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogBody}get Mvi(){return CommonUIStrings.l_AccCheckerContentNotFoundDialogTitle}get rtk(){return CommonUIStrings.l_AccCheckerOutOfSyncNotificationMessageBody}get ead(){return CommonUIStrings.l_AccCheckerPaneTitle}get Yvk(){return CommonUIStrings.l_AccCheckerPartialResultNotification}}
Object(h.a)(Ka,"AccessibilityCheckStringsProvider",null,[189]);class Da{constructor(){this.fjh=this.contentId=null}}Object(h.a)(Da,"ResultIds",null,[]);var la=d(65),ma=d(169);class Ea{constructor(t,N){this._element=null;this.zn=N;this.Lg=t}get element(){this._element||(this._element=this.VQd(),this.ow());return this._element}ahb(t){this._element=t}dispose(){this.element&&(this.Ona(),this.ahb(null))}ow(){this.zn&&this.Lg?(this.zn.ob(la.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),
this.Lg.ob(la.a.Xf,this.element,Object(r.a)(this,this.t0g,"onKeyPress"))):m.ULS.shipAssertTag(19789026,334,!1,String.format("ClickInputManager or KeyInputManager is null. Couldn't register events on element ( ID: {0}).",this.element.id))}Ona(){this.zn&&this.Lg&&(this.zn.xb(la.a.click,this.element,Object(r.a)(this,this.onClick,"onClick")),this.Lg.xb(la.a.Xf,this.element,Object(r.a)(this,this.t0g,"onKeyPress")))}onClick(){this.o0g();return!0}t0g(t){return this.vKj(t.mc.keyCode)?(this.o0g(),!0):!1}vKj(t){return t===
ma.a.YKb||t===ma.a.lq}}Object(h.a)(Ea,"AInteractivePaneElement",null,[253,106]);const ta=(t,N,ha)=>{t=document.createElement(t);N&&(t.id=N);ha&&(t.className=ha);t.setAttribute("Unselectable","on");return t};var Ga=d(73),oa=d(133),sa=d(95);class Ha extends Ea{constructor(t,N,ha){super(t,N);this.zTh=ha}hide(){this.element.removeAttribute(oa.a.Ye);oa.a.BO(this.element,oa.a.pK,oa.a.KB);this.element.style.display="none"}show(){oa.a.BO(this.element,oa.a.pK,oa.a.lqa);oa.a.BO(this.element,oa.a.Ye,oa.a.NKd);
this.element.style.display="block"}VQd(){const t=ta("div",this.uXg,"AccCheckerNotification");oa.a.BO(t,oa.a.OKd,oa.a.KB);oa.a.BO(t,oa.a.W1,this.Ive);t.tabIndex=0;const N=ta("span",this.tXg,"AccCheckerNotificationIcon");var ha=Ga.createClusteredImage(16,16,"Info_16x16x32","",!0,"");N.appendChild(ha);ha=ta("span",this.Ive,"AccCheckerNotificationText");sa.a.wx(ha,this.vXg);t.appendChild(N);t.appendChild(ha);return t}o0g(){this.zTh()}}Object(h.a)(Ha,"APopupNotification",Ea,[252,253,106]);class bb extends Ha{constructor(t,
N,ha,za){super(t,N,ha);this.Paa=za}get uXg(){return"AccCheckerOutOfSyncNotificationId"}get tXg(){return"AccCheckerOutOfSyncNotificationIconId"}get Ive(){return"AccCheckerOutOfSyncNotificationTextId"}get vXg(){return this.Paa.rtk}}Object(h.a)(bb,"OutOfSyncNotification",Ha,[]);class Ya extends Ha{constructor(t,N,ha,za){super(t,N,ha);this.Paa=za}get uXg(){return"AccCheckerPartialResultNotificationId"}get tXg(){return"AccCheckerPartialResultNotificationIconId"}get Ive(){return"AccCheckerPartialResultNotificationTextId"}get vXg(){return this.Paa.Yvk}}
Object(h.a)(Ya,"PartialResultNotification",Ha,[]);var ua=d(119),Ma=d(104);class Ca{constructor(t,N,ha,za=null,Ra=null,qb=null,Qb=null){this.yuf=this.G6=this.Lg=this.JKa=null;this.Q9a=za;this.zn=t;this.Kd=N;this.yR=ha;this.Paa=Qb||new Ka;this.JAd=Ra||new bb(this.Q9a,this.zn,Object(r.a)(this,this.CIi,"dimissOutOfSyncNotification"),this.Paa);this.YAd=qb||new Ya(this.Q9a,this.zn,Object(r.a)(this,this.DIi,"dimissPartialResultNotification"),this.Paa)}show(){}hide(){}get Q9a(){return this.Lg||(this.Lg=v.AFrameworkApplication.Aa.TF)}set Q9a(t){this.Lg=
t}YTf(){}Ns(){}dispose(){}jCh(){}thd(){}pDj(t){var N=this.yuf[t];t=N.contentId;if((N=N.fjh+"")&&N.length){const ha=[];Array.add(ha,Object.assign(new I.a,{name:"RuleID",string:N}));w.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}",Ca.zRe,"ViolationSelected"),dataFields:ha}))}this.Agk(t)}Agk(t){t&&this.JKa.i4k(t)||(this.Kd.NX(ua.AFrame.$Y,!1),this.idl())}CIi(){this.wsh(!1);this.thd()}DIi(){this.ysh(!1);this.thd()}idl(){const t=Object.assign(new Ma.StandardDialog(!0),{qr:v.AFrameworkApplication.Cca,
yd:1,XYa:!1});t.Zwa(1);t.Ue(1,this.Paa.Kvi);t.Ue(0,CommonUIStrings.l_DialogCancel);t.DO(this.Paa.Mvi,this.Paa.Lvi,N=>{1===N&&this.z9d()})}hhi(t){let N=null;if(t.Results&&0<t.Results.length){N={};let ha=0;for(const za of t.Results)za.ResultId=Ca.T_h+ ++ha,t=new Da,t.contentId=za.ContentId,t.fjh=za.RuleId,N[za.ResultId]=t}return N}a_j(){w.a.addNamespaceMapping(Ca.zRe,Ca.Wml);w.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}",Ca.zRe,"ShowTaskpane")}))}}Ca.T_h="AccCheckResult";
Ca.zRe="Office.UX.AccChecker";Ca.Wml="c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879";Object(h.a)(Ca,"BaseAccessibilityCheckPane",null,[192,106]);class Va{constructor(){this.type="AccCheckerTaskPaneProps";this.accessibilityCheckResultCollection=this.onRecheckExecute=null;this.resultsReady=!1;this.helpLink=this.onInvokeNavigateExecute=null;this.partialResult=this.outOfSync=!1;this.showHelpPane=this.updateLastScanTime=null}}Object(h.a)(Va,"AccCheckerTaskPaneProps",null,[]);
var Za=d(1124),Db=d(279);class Lb{constructor(){this.brc=new C.a}oIa(t){this.brc.add(t)}v6k(t){for(let N of this.brc)N(t)}}Object(h.a)(Lb,"ReactTaskPaneManager",null,[216]);var yb=d(637),Bc=d(141);class tb extends Ca{constructor(t,N,ha,za,Ra=null,qb=null,Qb,vc=null,Zc=null){super(N,ha,za,qb,void 0,void 0,vc);this.NXe=null;this.ftf=this.XAd=this.Kwc=this.lyc=this.Xxc=!1;this.mGd=null;this.hFd=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.jb&&v.AFrameworkApplication.Aa.jb.Jce;this.MNb=
this.doa=null;this.kOb=0;this.Ktc=null;this.Aqd=Ra;Zc&&(this.doa=Zc.g0h,this.MNb=Zc.NUi,this.kOb=Zc.muj);this.hpa=new Lb}get isVisible(){return this.ftf}SHb(t){this.ftf=t}eUd(t){t&&(this.NXe=t,t.IsSuccess&&(this.yuf=this.hhi(t),t.IsPartialResult&&this.ysh(!0)),this.Xxc=!0,this.lyc=!1,this.Yoc())}wsh(t){this.isVisible&&t!==this.Kwc&&(this.Kwc=t,this.Yoc())}ysh(t){this.XAd=t;this.Yoc()}Tl(){this.lyc||Bc.UISurfaces.Ms().then(t=>{Db.a.instance.Q1(tb.u_a+":PaneOpen:Start");t.showTaskPane(tb.u_a,this.Aba());
this.z9d();return null});this.isVisible?Bc.UISurfaces.Ms().then(t=>{t.setSelectedTaskPane(tb.u_a);return null}):this.a_j()}Yoc(){Bc.UISurfaces.Ms().then(t=>{t.updateTaskPane(tb.u_a,this.Aba());return null})}Aba(){var t=new Va;this.hpa.v6k(t);t=Object.assign(new yb.a,{title:this.Paa.ead,hideHeader:!1,width:320,location:2,contentProps:t,onOpen:()=>{this.l4k();this.SHb(!0);v.AFrameworkApplication.Aa.updateCommandUI()},onClose:()=>{this.zhd();this.SHb(!1);this.lyc=this.Xxc=!1;this.Yoc();v.AFrameworkApplication.Aa.updateCommandUI()},
isModernPane:!0});this.hFd&&(t.enableResize=!0,t.minResizeWidth=268,t.maxResizeWidth=920);return t}initialize(t){const N=this.Kd.Dc(tb.u_a);N.parent=ua.AFrame.jj;N.cL=!0;this.JKa=t;this.v0h()}dispose(){this.jCh();this.JAd&&(this.JAd.dispose(),this.JAd=null);this.YAd&&(this.YAd.dispose(),this.YAd=null);super.dispose()}v0h(){this.hpa.oIa(this.onRecheckExecute());this.hpa.oIa(this.kZi());this.hpa.oIa(this.Tcj());this.hpa.oIa(this.onInvokeNavigateExecute());this.hpa.oIa(this.E6i());this.hpa.oIa(this.qaj());
this.hpa.oIa(this.Taj());this.hpa.oIa(this.updateLastScanTime());this.hpa.oIa(this.showHelpPane())}onRecheckExecute(){return t=>{t.onRecheckExecute=()=>{this.z9d()}}}kZi(){return t=>{t.accessibilityCheckResultCollection=this.NXe}}Tcj(){return t=>{t.resultsReady=this.Xxc}}onInvokeNavigateExecute(){return t=>{t.onInvokeNavigateExecute=N=>{this.pDj(N)}}}E6i(){return t=>{t.helpLink=this.sQi}}qaj(){return t=>{t.outOfSync=this.Kwc}}Taj(){return t=>{t.partialResult=this.XAd}}updateLastScanTime(){return t=>
{t.updateLastScanTime=N=>{this.mGd=N}}}showHelpPane(){return t=>{t.showHelpPane=()=>{v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.WordHelpPaneFix")?v.AFrameworkApplication.dra||this.BIf()?this.Ktc?this.Ktc():this.doa.value&&this.MNb&&this.kOb&&this.doa.value.La(this.kOb,2,this.MNb):this.eth():this.BIf()?this.Ktc?this.Ktc():this.doa.value&&this.MNb&&this.kOb&&this.doa.value.La(this.kOb,2,this.MNb):this.eth()}}}BIf(){return!this.Aqd||
!this.Aqd.value}eth(){const t=this.Aqd.value;if(t){var N={};N.query=tb.jVh+tb.kvd;N=Object.assign(new Za.a,{nonPersistedSettings:N});t.nJa(tb.jvd,N)}}z9d(){this.XAd=this.Kwc=this.Xxc=!1;this.mGd&&this.mGd();this.Yoc();this.lyc=!0;this.JKa.Pwe()}l4k(){this.Kd.Bf(tb.u_a)}zhd(){this.Ice()&&this.Kd.Bf(this.Kd.m7)}Ice(){return!!this.Kd.ze&&this.Kd.ze.name===tb.u_a}}tb.u_a="AccessibilityCheckerPane";tb.kvd="a16f6de0-2f39-4a2b-8bd8-5ad801426c7f";tb.jvd="FA000000012";tb.jVh="AssetID=";Object(h.a)(tb,"ReactAccessibilityCheckPane",
Ca,[]);class Mb{constructor(t,N,ha){this.g0h=t;this.NUi=N;this.muj=ha}}Object(h.a)(Mb,"HelpPaneProperties",null,[]);var Hb=d(100),vb=d(28);class Xb extends tb{constructor(t,N,ha,za,Ra,qb,Qb,vc){super(null,N,ha,za,void 0,null,void 0,void 0,new Mb(Qb,Xb.L5i(),vb.a.nJa));this.kbc=t;this.i0j=Ra;this.fH=qb;this.QMg=Qb;this.ZD=vc}get isVisible(){return!!this.kbc&&this.kbc.isVisible}SHb(t){this.kbc&&(this.kbc.isVisible=t)}get sQi(){return this.i0j}Tl(){this.SHb(!0);this.fH.bM(this.kbc,!0,ResourceStrings.l_AccessibilityCheckerTaskPaneToolTip,
ua.AFrame.$Y);super.Tl();if(this.QMg){var t=this.QMg.value;if(t){t.processAction(vb.a.jCf,1);t=!1;try{this.ZD.selectRibbonTabById("AccessibleAuthoring"),t=!0}catch(N){K.a.J(544736533,822,10,"PptReactAccCheckControl: can't select ribbon tab AccessibleAuthoring: {0}",N.toString())}Hb.a("AccessibleAuthoringTab",t)}else K.a.J(544286875,822,10,"PptReactAccCheckControl: can't get IActionManagerExtended to show AccessibleAuthoring Ribbon Tab")}else K.a.J(544265629,822,10,"PptReactAccCheckControl: can't get Lazy<IActionManagerExtended> to show AccessibleAuthoring Ribbon Tab")}j9c(){}onBeforeLoadContent(){}onAfterLoadContent(){this.JKa&&
this.JKa.wye()}onAfterFirstSaveContent(){}static L5i(){const t={};t.CU=ResourceStrings.L_Help;t.assetId="FA000000012";t.nonPersistedSettings={query:"AssetID=a16f6de0-2f39-4a2b-8bd8-5ad801426c7f"};return t}}Object(h.a)(Xb,"PptReactAccCheckControl",tb,[354]);class Uc{constructor(){this.K=null}get name(){return"PowerPointWebEditor.Accessibility"}Wb(t){this.K=t;this.K.register(ya,"PowerPointWebEditor.Accessibility.PptAccCheckService").as("PowerPointWebEditor.Accessibility.IPptAccCheckService").as("Common.App.AccessibilityChecker.IAccessibilityCheckService").ma().na(()=>
new ya(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager")));this.K.register(192,"Common.App.AccessibilityChecker.IAccessibilityCheckPane").ma().na(()=>new Xb(this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IFocusManager"),this.K.resolve("Common.IF6Manager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointAccCheckHelpUrl,this.K.resolve("PowerPointWebEditor.ITaskPaneManager"),
this.K.le("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.register(190,"Common.App.AccessibilityChecker.IAccessibilityCheckManager").ma().na(()=>new X(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane"),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),
this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")))}init(){}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointEnableAccCheck&&(this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckService").dispose(),this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckPane").dispose(),
this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager").dispose())}static main(){e.a.instance.Bc(new Uc)}}Object(h.a)(Uc,"PptAccessibilityPackage",null,[2,3]);var hb=d(177),Zb=d(1171),Fc=d(232),ob=d(178),ac=d(524),pb=d(52),nb=d(122);class Tb{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc){this.ia=t;this.la=N;this.j0j=ha;this.k0j=za;this.l$a=Ra;this.ZD=Qb;this.jVa=qb;this.Fa=vc;this.uc=Zc;this.jVa.N5h(Object(r.a)(this,this.Zch,"refreshAccCheckButtonStatus"))}ub(){this.la.powerPointEnableAccCheck&&
(this.ia.pa(vb.a.A7g,pb.a.application,Object(r.a)(this,this.Imi,"checkAccessibility"),4),this.ia.pa(vb.a.nFk,pb.a.application,Object(r.a)(this,this.FEk,"queryCheckAccessibility"),97))}xe(){this.la.powerPointEnableAccCheck&&this.Fa.Dc(nb.a.SLf).bindAction(ob.KeyInputManager.Na(ma.a.cqc,ob.KeyInputManager.He|1),vb.a.A7g)}Imi(t,N,ha,za,Ra){return 1===ha?this.uc.Hj()?this.k0j.GDj?32:8:8:this.j0j.Tl(t,N,ha,za,Ra)}FEk(t,N,ha,za,Ra){Ra[ac.a.On]=this.l$a.isVisible;return 32}dispose(){this.jVa.vRk(Object(r.a)(this,
this.Zch,"refreshAccCheckButtonStatus"))}Zch(){this.ZD.JF()}}Object(h.a)(Tb,"AccCheckActor",null,[229,106]);class Ub{constructor(){this.C7b=this.K=null}get name(){return"PowerPointWebEditor.LazyActors"}Wb(t){this.K=t}init(){this.K.resolve("PowerPointWebEditor.IAppBootCompletedListener").wvb(()=>{this.dvb()})}dvb(){const t=this.K.resolve("Common.AFrameworkApplication").bS.ld,N=this.K.resolve("Common.IActionManagerExtended");t.powerPointEnableAccCheck&&(this.C7b=new Tb(N,t,this.K.resolve("Common.App.AccessibilityChecker.IAccessibilityCheckManager"),
this.K.resolve("PowerPointWebEditor.Accessibility.IPptAccCheckService"),this.K.resolve("PowerPointWebEditor.View.IAccCheckPane"),this.K.resolve("PowerPointWebEditor.IPresentationResourcesManager"),this.K.resolve("PowerPointWebEditor.IRibbonUser"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader")),this.C7b.ub(),this.C7b.xe());t.nee&&hb.a.get_instance().gk(7,Object(r.a)(this,this.nee,"loadInternalSlice"))}nee(){const t=Zb.a.create("pptedit.internal",
null,()=>d.e(16).then(d.bind(null,1216)));Fc.a.Kx(t)}dispose(){this.C7b&&this.C7b.dispose()}static main(){e.a.instance.Bc(new Ub)}}Object(h.a)(Ub,"PptLazyActorsPackage",null,[2,3]);var hc=d(207),Wb=d(573),fd=d(1174),fc=d(184),bc=d(164),cc=d(57),kb=d(46),ab=d(66),Pb=d(138),rc=d(618);class ic extends rc.a{constructor(){super();this.ee=this.createElement(ab.a.cSe)}e8k(t){this.xa.textContent=t}appendChild(t){if(!t.xa||!this.xa)throw Error.argumentNull();this.xa.appendChild(t.xa)}}Object(h.a)(ic,"HTMLText",
rc.a,[]);var md=d(321),Fd=d(193);class ne{constructor(t,N,ha,za,Ra,qb,Qb,vc){this.nd=1;this.cre=null;this.U_=new fc.a;this.Xt=new fc.a;this.Zm=null;this.Go=!1;this.HZc=null;this.eKg="";this.eFa=this.x9=!1;this.wcb=this.aUa=this.W$a=this.dFa=this.wyb=this.kda=null;this.XSa=!1;this.ta=t;this.yb=N;this.fe=ha;this.la=za;this.ia=Ra;this.Wc=qb;this.nb=Qb;this.vC=vc}eel(t){this.kda&&this.wcb&&(this.x9=!0,this.wcb.appendChild(this.kda.xa),this.nb.VH(Object(r.a)(this,this.rea,"onSelectionChange")),this.HZc=
new aa.a(3,1,this.la.Esh,Object(r.a)(this,this.dismissImageDescriptionBarTask,"dismissImageDescriptionBarTask"),90,"19"),this.xDh(t))}Rwl(t){this.ta===t&&this.x9&&this.xDh(this.ta.get_alt())}ym(t){this.wcb=t.xa;this.Xyi()}LC(t){if(this.x9&&!this.Go)switch(t){case 1:t=this.fe.hk("formatpainterobject.cur");this.dFa.Yk(kb.a.GP(t,ab.a.Qmc));break;case 0:this.dFa.Yk(ab.a.Qmc)}}Qp(){return null}kN(){return!1}xx(t){this.Go=t}dispose(){this.qIc();this.kda&&(this.aUa=this.W$a=this.wyb=this.dFa=this.kda=null)}Ay(){}CD(){return null}jB(){return[]}draw(){this.x9&&
this.WUe(!0)}get visible(){return this.eFa}set visible(t){this.x9&&(this.eFa!==t&&(this.eFa=t,this.kda.setVisibility(this.eFa)),this.eFa||this.qIc())}setPosition(){}Dj(t){this.nd=t;this.x9&&(this.nbd(),this.wDh())}Gq(t){this.U_=t;this.x9&&this.nbd()}Gu(t){this.Xt=t;this.x9&&this.nbd()}setZIndex(t){this.x9&&this.kda.pB(t)}nE(t,N){this.x9&&(this.WUe(!t&&N||!N),t||this.yb.a5(this.HZc,this.la.Esh))}setSelection(){}Xyi(){this.kda=new Pb.a;this.dFa=new md.a;this.dFa.jna("ImageDescriptionBarBackground");
this.Wc.ob(la.a.click,this.dFa.xa,Object(r.a)(this,this.dnk,"onImageDescriptonBarClickHandler"));this.wyb=new Fd.a;this.wyb.appendChild(this.dFa);this.W$a=new ic;this.W$a.jr("ImageDescriptionBarText");this.wDh();this.aUa=new Pb.a;this.aUa.jr("ImageDescriptionBarTextWrappingDiv");this.aUa.appendChild(this.W$a);this.kda.appendChild(this.wyb);this.kda.appendChild(this.aUa)}xDh(t){const N=t.indexOf("\n");this.eKg=-1===N?t:t.substring(0,N);this.W$a.e8k(ResourceStrings.L_ShapeAltText+": "+this.eKg);this.WUe(!0)}WUe(t){this.Zm=
this.ta.Uo;this.eFa=t;this.nbd();this.kda.setVisibility(this.eFa);this.XSa||(this.XSa=!0,this.yb.Cb(this.HZc))}wDh(){this.W$a.xa.style.fontSize=this.vC.Yha(29)}dnk(){this.ia.processAction(vb.a.cCc,2);return!0}rea(){this.qIc()}dismissImageDescriptionBarTask(){this.qIc()}qIc(){this.x9&&(this.eFa=this.x9=!1,this.nb.Ewa(Object(r.a)(this,this.rea,"onSelectionChange")),this.XSa&&(this.yb.Ng(this.HZc),this.XSa=!1),this.wcb&&this.wcb.contains(this.kda.xa)&&this.wcb.removeChild(this.kda.xa))}nbd(){if(this.x9&&
this.Zm){var t=this.Zm.copy();this.U_.ql(t);this.Xt.ql(t);this.cre=Wb.a.sO(cc.a.pG(t.ga(0),t.ga(1)));var N=t.ik(new bc.a(6)),ha=t.ik(new bc.a(4));t=t.ik(new bc.a(2));t=cc.a.$l(ha,t)*this.nd;ha=cc.a.$l(N,ha)*this.nd;if(60>ha||80>t)this.eFa=!1;else{t=this.wcb.children[0].style;this.wyb.setPosition(this.jKb(t.left),this.jKb(t.top));this.wyb.gh(this.jKb(t.width),this.jKb(t.height));var za=this.vC.Ie(fd.a.Ff(40,1),1);this.aUa.setPosition(N.x*this.nd,N.y*this.nd-za);this.aUa.gh(ha,za);this.aUa.xa.style.transform=
this.jPa(this.cre);this.W$a.gh(ha-9,za-6);var Ra=new fc.a;Ra.Q6(this.cre,new cc.a(0,za));Ra.HB(N.x*this.nd-this.jKb(t.left),N.y*this.nd-this.jKb(t.top)-za);this.dFa.pE(Ra,1);this.dFa.gh(ha,za)}}}jKb(t){t=parseFloat(t);return isNaN(t)?0:t}jPa(t){return"rotate("+t.toString()+"deg)"}}Object(h.a)(ne,"ImageDescriptionBarView",null,[997,535,536,106]);var ud=d(989),gb=d(45),Vb=d(37);class Lc{constructor(t,N,ha,za){this.shapeNode=t;this.sKc=N;this.SMj=ha;this.imageDescription=za}}Object(h.a)(Lc,"ImageDescriptionCache",
null,[]);var Xc=d(212);class Ib{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md){this.T8=new ud.a;this.Mb=t;this.pi=N;this.Eq=Qb;this.O$a=ha;this.nb=za;this.x_=qb;this.i4j=Ra;this.Ot=vc;this.Fb=Zc;this.Xb=Wc;this.Ple=Md}initialize(){this.Ot.Yj(Object(r.a)(this,this.fh,"onPropertyChanged"));this.Eq.nFf(Object(r.a)(this,this.IDb,"onShapeImageFirstDraw"));this.Eq.B6h(Object(r.a)(this,this.H0g,"onLocalImageViewDismissed"));this.O$a.w6h(Object(r.a)(this,this.e0g,"onImageDescriptionReady"))}dispose(){this.Ot.tm(Object(r.a)(this,
this.fh,"onPropertyChanged"));this.Eq.nGe(Object(r.a)(this,this.IDb,"onShapeImageFirstDraw"));this.Eq.XRk(Object(r.a)(this,this.H0g,"onLocalImageViewDismissed"));this.O$a.URk(Object(r.a)(this,this.e0g,"onImageDescriptionReady"))}fh(t,N){(t=N.node)&&t.wk&&(N=N.property,N===Vb.a.alt?((N=Object(Q.a)(121,t.oc(this.Mb.Ma)))&&N.aQ&&t.get_alt()&&this.Ple.AG(t).Rwl(t),this.i4j.hvl(t),t.get_alt()&&this.Ajd(t,t.get_alt())):N===Vb.a.JA?t.JA&&(N=Object(Q.a)(121,t.oc(this.Mb.Ma)))&&N.aQ&&(this.Ple.AG(t).visible=
!1):N===Vb.a.jh&&t.jh!==Xc.a.JS&&(N=Object(Q.a)(121,t.oc(this.Mb.Ma)))&&N.aQ&&!t.Yca&&this.T8.ga(t.id)&&this.T8.ga(t.id).sKc&&(this.Lsb(t,N),this.T8.remove(t.id)))}e0g(t,N){if(t=N.bQc){var ha=N.confidence,za=N.imageDescription,Ra=N.ZIj;N=N.sKc;var qb=this.x_.jca(t),Qb=qb?Object(Q.a)(121,qb.oc(this.Mb.Ma)):null;N?Qb&&Qb.aQ&&!qb.isLocal&&!qb.JA?this.Lsb(qb,Qb):this.T8.add(t,new Lc(qb,!0,!0,za)):!za||!Ra&&60>ha?K.a.J(33609505,815,15,"isGenerateSuggestion: {0}, confidence: {1}",Ra,ha):(za=this.vsi(ha,
za),Ra?this.iKe(qb,za,!1):(K.a.J(34194368,815,50,"Image description ready for show and save"),Qb&&Qb.aQ?(K.a.J(34194370,815,50,"Show image description immediately, GraphNodeId: {0}, TimeMs: {1}",t.toString(),(new Date).getTime()),this.Ajd(qb,za),qb.isLocal?this.T8.add(t,new Lc(qb,!1,!1,za)):(K.a.J(34194372,815,50,"Save image description immediately"),this.iKe(qb,za,!0))):this.T8.add(t,new Lc(qb,!1,!0,za))))}else K.a.J(33609503,815,15,"Graph node id is null")}IDb(t,N){t=N.bQc;K.a.J(34194374,815,50,
"OnShapeImageFirstDraw, GraphNodeId: {0}, TimeMs: {1}",t?t.toString():"",(new Date).getTime());this.T8.Jb(t)?this.w9g(t):(t=this.x_.jca(t))&&t.get_alt()&&this.Ajd(t,t.get_alt())}vsi(t,N){N+=String.fromCharCode(10,10);return N=80<=t?N+ResourceStrings.L_ImageDescriptionWithVeryHighConfidence:60<=t?N+ResourceStrings.L_ImageDescriptionWithHighConfidence:40<=t?N+ResourceStrings.L_ImageDescriptionWithMediumConfidence:20<=t?N+ResourceStrings.L_ImageDescriptionWithLowConfidence:N+ResourceStrings.L_ImageDescriptionWithVeryLowConfidence}H0g(t,
N){(t=N.zhl)&&this.T8.Jb(t.id)&&this.w9g(t.id)}w9g(t){const N=this.T8.ga(t).shapeNode;if(N){var ha=this.T8.ga(t).sKc,za=this.T8.ga(t).SMj,Ra=this.T8.ga(t).imageDescription;ha?(ha=Object(Q.a)(121,N.oc(this.Mb.Ma)))&&this.Lsb(N,ha):(za&&this.Ajd(N,Ra),N.isLocal?K.a.J(33609539,815,15,"Try to save alt text for local picture"):this.iKe(N,Ra,!0));this.T8.remove(t)}else K.a.J(37029889,815,15,"ProcessImageDescriptionInCache, shape node has been changed")}Lsb(t,N){this.pi.generateImageDescription(t.id,N.pPe,
t.get_isSVGBlipFilled(),!1)}iKe(t,N,ha){if(!ha||!t.get_alt()){var za=this.Fb.ke(ha?7:15);za.kc(t);t.YYa=ha;t.set_alt(gb.a.URa(N));za.dispose();ha&&this.pi.forceOutbound()}}Ajd(t,N){if(t.wk){this.Xb.Zc(t)&&K.a.J(34079445,815,50,"Graph node or parents blocked");var ha=this.nb.Yd();ha&&this.nb.uW(t)?(K.a.J(33609545,815,50,"ImageDescriptionManager::ShowImageDescriptionBar, GraphNodeId: {0}, TimeMs: {1}",t.id.toString(),(new Date).getTime()),this.Ple.AG(t).eel(N)):K.a.J(33609543,815,50,"Is selected shapes empty: {0}",
!ha)}else K.a.J(33609541,815,50,"ShapeNode.IsPicture: {0}",t.wk)}}Object(h.a)(Ib,"ImageDescriptionManager",null,[106]);var gc=d(93),Fb=d(332),fb=d(58),Pc=d(69),dd=d(38),kd=d(47);class Td{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id){this.ta=null;this.jT=0;this.c1c=!0;this.Rle=new ud.a(0);this.NE=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.jb&&v.AFrameworkApplication.Aa.jb.tW;this.lh=t;this.Ob=N;this.fe=ha;this.Fa=Wc;this.pi=za;this.Wc=Ra;this.nb=qb;this.RD=Qb;this.A_=vc;this.Fb=Zc;
this.O$a=Md;this.fH=Id;this.pb=document.createElement("div");this.pb.className=fb.a.yng;this.pb.id=fb.a.yng;this.pb.style.position=Pc.a.Dna;this.pb.setAttribute(oa.a.Ye,oa.a.GAa);this.pb.setAttribute(oa.a.W1,"ImageDescriptionPaneLabel");this.Wc.ob(la.a.click,this.pb,Object(r.a)(this,this.Mih,"rootElementClickHandler"));this.A_.addHandler(this.pb,la.a.Xf,Object(r.a)(this,this.Fsa,"inputKeyPressHandler"));this.Db=!1;this.rFa=kb.a.Ce();this.rFa.className="ImageDescriptionPaneLayoutRoot";this.mo=this.mBa("per",
"ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.mo,"ImageDescriptionPaneCloseButton");this.mo.setAttribute(oa.a.Ye,oa.a.hu);this.rFa.appendChild(this.mo);this.Wc.ob(la.a.click,this.mo,Object(r.a)(this,this.mqb,"closeButtonClickHandler"));this.A_.addHandler(this.mo,la.a.focus,Object(r.a)(this,this.rDb,"onElementFocused"));this.W9b=kb.a.Ce();this.W9b.id="ImageDescriptionPaneLabel";this.W9b.className="PaneLabel";this.W9b.innerText=ResourceStrings.L_ShapeAltText;this.rFa.appendChild(this.W9b);
this.p0c=kb.a.Ce();this.p0c.innerText=ResourceStrings.l_ImageDescriptionPaneLabel;this.p0c.className="ImageDescriptionLabel";this.rFa.appendChild(this.p0c);this.o0c=kb.a.Ce();this.o0c.innerText=ResourceStrings.L_ImageDescriptionPaneHint;this.o0c.className="ImageDescriptionHint";this.rFa.appendChild(this.o0c);this.Qle=kb.a.Ce();this.HI=document.createElement("textarea");this.HI.className="AltTextTextArea";this.HI.setAttribute(oa.a.Wr,ResourceStrings.L_ShapeAltText);this.HI.tabIndex=0;this.Qle.appendChild(this.HI);
this.rFa.appendChild(this.Qle);this.Wc.ob(la.a.click,this.HI,Object(r.a)(this,this.CGf,"altTextboxClickHandler"));this.A_.addHandler(this.HI,la.a.Xf,Object(r.a)(this,this.DGf,"altTextboxTypingHandler"));this.A_.addHandler(this.HI,la.a.focus,Object(r.a)(this,this.rDb,"onElementFocused"));t=kb.a.Fn();t.className="GenerateDescriptionButtonText";t.innerText=ResourceStrings.L_ImageDescriptionPaneButtonTooltip;t.setAttribute("Unselectable","on");this.nT=kb.a.vba();this.nT.className="ImageDescriptionPaneButton cui-ctl";
this.nT.setAttribute(oa.a.Ye,oa.a.hu);this.nT.tabIndex=0;this.nT.appendChild(t);this.rFa.appendChild(this.nT);this.Wc.ob(la.a.click,this.nT,Object(r.a)(this,this.b8f,"generateDescriptionClickHandler"));this.A_.addHandler(this.nT,la.a.focus,Object(r.a)(this,this.rDb,"onElementFocused"));this.RD.T7(kd.a.Bsa,kd.a.jj,this.pb,()=>{this.XT(!0)},()=>{this.XT(!1)},!0);this.RD.T7(kd.a.CJd,kd.a.jj,this.HI,()=>{this.P_g(!0)},()=>{this.P_g(!1)},!0);this.O$a.Y6h(Object(r.a)(this,this.s2g,"onShowHideAltTextPane"))}jzj(){this.Jmi()&&
(this.HI.disabled=!1,this.HI.value=this.ta.get_alt(),this.pb.appendChild(this.rFa),this.nT.style.display=this.ta.isLocal?Pc.a.Cf:Pc.a.Lk,this.Db=!0,this.pb.style.display=Pc.a.Lk,this.NE?(this.OAc(this.pb),this.fH.bM(this,this.Db,ResourceStrings.L_ShapeAltText,kd.a.Bsa)):this.Ob.Fq(),this.nb.VH(Object(r.a)(this,this.rea,"onSelectionChange")),K.a.J(512233536,815,50,"ImageDescriptionPane::InitializeAndShow"))}dispose(){this.GEc();this.O$a.nSk(Object(r.a)(this,this.s2g,"onShowHideAltTextPane"));this.Wc.xb(la.a.click,
this.pb,Object(r.a)(this,this.Mih,"rootElementClickHandler"));this.A_.removeHandler(this.pb,la.a.Xf,Object(r.a)(this,this.Fsa,"inputKeyPressHandler"));this.Wc.xb(la.a.click,this.mo,Object(r.a)(this,this.mqb,"closeButtonClickHandler"));this.A_.removeHandler(this.mo,la.a.focus,Object(r.a)(this,this.rDb,"onElementFocused"));this.Wc.xb(la.a.click,this.HI,Object(r.a)(this,this.CGf,"altTextboxClickHandler"));this.A_.removeHandler(this.HI,la.a.Xf,Object(r.a)(this,this.DGf,"altTextboxTypingHandler"));this.A_.removeHandler(this.HI,
la.a.focus,Object(r.a)(this,this.rDb,"onElementFocused"));this.Wc.xb(la.a.click,this.nT,Object(r.a)(this,this.b8f,"generateDescriptionClickHandler"));this.A_.removeHandler(this.nT,la.a.focus,Object(r.a)(this,this.rDb,"onElementFocused"));this.nT=this.HI=this.Qle=this.o0c=this.p0c=this.W9b=null;K.a.J(512233507,815,50,"ImageDescriptionPane::Dispose")}hvl(t){this.ta&&t===this.ta&&this.Db&&(this.Rle.Jb(t.id.toString())&&this.ta.jh!==this.Rle.ga(t.id.toString())&&K.a.J(512233506,815,50,"ImageDescriptionPane::UpdateAltTextbox - Image version have been changed after generate description"),
2!==this.jT&&(this.HI.value=this.ta.get_alt()))}layout(t,N){const ha=N?t.PC(this.width):t.QC(this.width);this.Db&&(N?(Sys.UI.DomElement.addCssClass(this.pb,fb.a.Ang),ha.PC(fb.a.n7d)):(Sys.UI.DomElement.addCssClass(this.pb,fb.a.zng),ha.QC(fb.a.n7d)));kb.a.A0(this.pb,ha);return t}get isVisible(){return this.Db}get xa(){return this.pb}get order(){return 10}XT(t){this.Db&&(t?0===this.jT&&this.lAh():this.jT=0)}P_g(t){this.Db&&(t||this.SKe(),this.Ob.updateCommandUI())}DGf(t){t.keyCode===ma.a.xY&&t.ctrlKey?
this.lHb():(2!==this.jT&&this.Smh(),this.jT=2)}Fsa(t){this.Db&&(t.keyCode===ma.a.lq||t.keyCode===ma.a.NO?1===this.jT?this.tK():3===this.jT?this.Lsb():2===this.jT&&(this.nT.style.display=Pc.a.Lk):2===this.jT&&(this.nT.style.display=Pc.a.Lk))}lAh(){gc.FocusManager.Mr(this.mo)?(this.lHb(),this.jT=1):K.a.J(512233505,815,50,"Fail to set focus on close button")}lHb(){this.Fa.IC(kd.a.Bsa)}Smh(){this.Fa.IC(kd.a.CJd)}Jmi(){const t=this.nb.Yd();if(!t||1<t.length||!t[0].wk)return K.a.J(512233504,815,50,"ImageDescriptionPane::CheckAndCacheShapeNode - shape node is null: {0}",
!t),!1;this.ta=t[0];return!0}mqb(){this.tK();return!0}tK(){this.Db&&(this.GEc(),this.Fa.Gj(kd.a.Bsa,!1),K.a.J(512233503,815,50,"ImageDescriptionPane::CloseButtonClickHandler - Image Description pane close button clicked."))}Mih(){this.Db&&(this.lHb(),this.jT=0);return!0}CGf(){this.Smh();this.jT=2;return!0}b8f(){this.lHb();this.Lsb();return!0}Lsb(){this.jT=3;this.nT.style.display=Pc.a.Cf;this.lAh();const t=this.ta?Object(Q.a)(121,this.ta.oc(0)):null;t?(this.Rle.add(this.ta.id.toString(),this.ta.jh),
this.pi.generateImageDescription(this.ta.id,t.pPe,this.ta.get_isSVGBlipFilled(),!0)):K.a.J(512233502,815,15,"ImageDescriptionPane::GenerateDescriptionClickHandler - Is shape node null {0}",!this.ta)}s2g(){this.Db?this.GEc():(this.jzj(),this.jT=0);this.Fa.Gj(kd.a.Bsa,this.Db);K.a.J(512233501,815,50,"ImageDescrptionPane::ShowOrHidePane {0}",!this.Db)}ivl(t){t=t.Yd();this.c1c&&this.SKe();1===t.length&&t[0].wk?(this.ta=t[0],this.c1c=!0,this.HI.value=this.ta.get_alt(),this.HI.disabled=!1,this.nT.style.display=
this.ta.isLocal?Pc.a.Cf:Pc.a.Lk):(this.nT.style.display=Pc.a.Cf,this.HI.disabled=!0,this.HI.value=null,this.c1c=!1)}rea(t){dd.a("ChangePictureAltTextFixEnabled")?this.ivl(t):this.GEc();this.lh.zo(kd.a.Bsa)}rDb(t){this.Db&&(t.target===this.mo?this.jT=1:t.target===this.HI?this.jT=2:t.target===this.nT&&(this.jT=3))}GEc(){this.Db&&(this.nb.Ewa(Object(r.a)(this,this.rea,"onSelectionChange")),this.c1c&&this.SKe(),this.Db=!1,this.pb.removeChild(this.rFa),this.pb.style.display=Pc.a.Cf,this.NE?(this.OAc(this.pb),
this.fH.bM(this,this.Db,ResourceStrings.L_ShapeAltText,kd.a.Bsa)):this.Ob.Fq(),K.a.J(512233500,815,50,"ImageDescriptionPane::CleanUpAndHide"))}OAc(t){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(t,fb.a.Ang):Sys.UI.DomElement.addCssClass(t,fb.a.zng)}SKe(){const t=this.HI.value;if(!(dd.a("ChangePictureAltTextFixEnabled")&&null===t||t===this.ta.get_alt())){var N=this.Fb.ke(15);N.kc(this.ta);this.ta.YYa=!1;this.ta.set_alt(t);N.dispose()}}mBa(t,N){return this.lBa(t,"cui-img-16by16","cui-ctl-iconContainer",
N,CommonUIStrings.l_DialogClose,null)}lBa(t,N,ha,za,Ra,qb){const Qb=kb.a.SB();Qb.alt=Ra;Qb.className=Ga.getImageClassWithCluster(t,za);Qb.src=this.fe.hk(t+".png");Qb.setAttribute("Unselectable","on");t=kb.a.Fn();t.className=N+" cui-img-cont-float";t.appendChild(Qb);N=kb.a.Fn();N.className=ha;N.setAttribute("Unselectable","on");N.appendChild(t);ha=kb.a.vba();ha.className="ImageDescriptionPaneNoBorderButton cui-ctl";ha.title=Ra;ha.setAttribute(oa.a.Ye,oa.a.hu);ha.tabIndex=0;ha.appendChild(N);qb&&(Ra=
kb.a.Fn(),Ra.className="cui-ctl-mediumlabel",Ra.setAttribute("Unselectable","on"),Ra.innerText=qb,ha.appendChild(Ra));return ha}get width(){return this.Db?fb.a.Hwj+fb.a.n7d+Fb.a.LIa:0}}Object(h.a)(Td,"ImageDescriptionPane",null,[984,716,106]);var ce=d(277);class ld{constructor(){this.K=null;this.NE=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.jb&&v.AFrameworkApplication.Aa.jb.tW}get name(){return"PowerPointWebEditor.ImageDescription"}Wb(t){this.K=t;this.K.register(488,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>").ma().na(()=>
new ce.a(N=>{let ha=null;const za=Object(Q.a)(121,N.oc(t.resolve("Box4.IPageView").Ma));za&&!za.ll&&(ha=new ne(N,this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IPageView").Fd),ha.ym(za.nU),za.Ypa(ha,4));return ha}));this.K.register(984,"PowerPointWebEditor.IImageDescriptionPane").ma().na(()=>
new Td(this.K.resolve("Common.IF6Manager"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(Ib,"PowerPointWebEditor.ImageDescriptionManager").ma().na(()=>new Ib(this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoreExtEventSource"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IImageDescriptionPane"),
this.K.resolve("PowerPointWebEditor.Graph.GraphHierarchyHelper"),this.K.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").vd(10),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IImageDescriptionBarView>")))}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").uSa&&
(this.NE||this.K.resolve("PowerPointWebEditor.IPaneManager").pP(this.K.resolve("PowerPointWebEditor.IImageDescriptionPane")),this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").initialize())}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").uSa&&this.K.resolve("PowerPointWebEditor.ImageDescriptionManager").dispose()}static main(){e.a.instance.Bc(hc.a(new ld,0))}}Object(h.a)(ld,"PPTWebEditorImageDescriptionPackage",null,[2,3]);var ad=d(82);class Yf extends ad.a{constructor(t){super(!1,
!1,!0);this.nqc=t}start(){const t={["id"]:"AccessibilitySettingsDialog",["bodyControls"]:{["tooltipPersistenceEnabled"]:this.nqc.$6d}};this.tj("",Object(r.a)(this,this.cXk,"resultHandler"),t)}cXk(t,N){1===t&&(this.nqc.$6d=N.tooltipPersistenceEnabled)}}Object(h.a)(Yf,"AccessibilitySettingsDialog",ad.a,[]);class Xd{constructor(t,N){this.Ca=t;this.nqc=N}ub(){this.Ca.ya(F.a.Hcl,D.a.frame,Object(r.a)(this,this.Icl,"showAccessibilitySettingsDialogHandler"))}Icl(){(new Yf(this.nqc)).start();return 32}}Object(h.a)(Xd,
"AccessibilitySettingsDialogActor",null,[927]);var fg=d(1029);const ue=t=>{const N=new fg.a;v.AFrameworkApplication.Ge.yj(Sa(t),1,null,null,!0,2,ha=>{200===ha.data.Le?N.Dg("true"===ha.data.Sd.toLowerCase()):N.Dg(!1)},()=>{N.Dg(!1)},null,void 0,void 0,void 0,void 0,"7");return N.task},Sa=t=>{let N=v.AFrameworkApplication.fa.appSettings.RoamingServiceHandlerWebServiceBase||"";v.AFrameworkApplication.fa.isChangeGateEnabled("OfficeVSO:7445267_RoamingServiceBaseURLFix")&&!N.endsWith("/")&&(N+="/");return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",
N,t,v.AFrameworkApplication.hh)};var rb=d(72);class pc{constructor(){this.mlb=null}get $6d(){return!!this.mlb}set $6d(t){t!==this.mlb&&(this.mlb=t,rb.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(t),this.Kyg()&&v.AFrameworkApplication.Ge.yj(Sa("saveHoverableRibbonTooltipIsEnabled"),2,t.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}eWj(){const t=new fg.a;if(this.mlb)t.Dg(this.mlb);else if(this.Kyg()){const N=ue("getHoverableRibbonTooltipIsEnabled");
N.continueWith(()=>{this.mlb=N.result;rb.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(N.result);t.Dg(N.result)},8)}else t.Dg(!1)}Kyg(){const t=v.AFrameworkApplication.fa.ka("IsRoamingServiceEnabled"),N=v.AFrameworkApplication.fa.ka("IsAnonymousUser");return t&&!N}}Object(h.a)(pc,"AccessibilitySettingsInfo",null,[928]);class cd{constructor(){this.Da=null}get name(){return"Common.App.AccessibilitySettings"}Wb(t){this.Da=t;this.Da.register(pc,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").na(()=>
new pc).ma();this.Da.register(Xd,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").na(()=>new Xd(v.AFrameworkApplication.Ta,this.Da.qb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))).ma()}init(){const t=this.Da.qb("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),N=this.Da.qb("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");t&&N?(N.ub(),t.eWj()):L.c(539637639,
200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")}dispose(){}static main(){e.a.instance.Bc(new cd)}}Object(h.a)(cd,"AccessibilitySettingsPackage",null,[2,3]);var zd=d(90),wd=d(245),Oa=d(1094),jb=d(80),qc=d(694);class ib extends Ma.StandardDialog{constructor(t,N,ha,za=null){super();this.I1=this.Vr=this.xLa=null;this.Pv=[];this.Xwc=N;this.eP=t;this.TOh=ha;this.wyc=za;this.mnb=new qc.a("LoadResource","LoadPrintablePdf")}nia(){this.yd=
5;this.width=40;const t=document.createElement("span");t.id=this.ji("DirectPrintHeaderContent");const N=document.createElement("span");N.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(N,"DirectPrintHeader");this.I1=document.createElement("iframe");this.I1.name="pdfObjectFrame";this.I1.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.I1.onload=Object(r.a)(this,this.yCk,"printablePdfLoaded");if(this.wyc&&0<this.wyc.count){var ha=jb.a.c2d(this.Xwc,this.wyc);const za=
jb.a.RFe(this.Xwc,this.wyc);this.Vr=document.createElement("form");this.Vr.id="printPreviewPostForm";this.Vr.method="POST";this.Vr.target=this.I1.name;this.Vr.action=za;for(let Ra of ha)ha=document.createElement("input"),ha.type="hidden",ha.name=Ra.key,ha.value=Ra.value,this.Vr.appendChild(ha)}else this.I1.setAttribute("src",this.Xwc);Sys.UI.DomElement.addCssClass(this.I1,wd.a.Ihf);this.TOh?(Sys.UI.DomElement.addCssClass(this.I1,"DirectPrintPdfObjectHidden"),N.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,
oa.a.BO(this.I1,oa.a.pK,oa.a.KB)):(Sys.UI.DomElement.addCssClass(this.I1,"DirectPrintPdfObject"),this.Pv.push(this.I1));t.appendChild(N);t.appendChild(document.createElement("br"));t.appendChild(this.I1);this.Vr&&t.appendChild(this.Vr);t.appendChild(document.createElement("br"));t.appendChild(this.Uui(this.Vr?"#":this.Xwc));this.mnb.start();this.pCb(CommonUIStrings.l_AppTitle,null,null,null,null,t);this.i5(this.ji("DirectPrintHeaderContent"));this.Vr&&this.Vr.submit();this.xzi();m.ULS.sendTraceTag(4771852,
328,50,"Direct Print Dialog launched.")}Uui(t){const N=document.createElement("span");var ha=document.createElement("span");ha.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;N.appendChild(ha);v.AFrameworkApplication.fa&&(2===v.AFrameworkApplication.Aa.jb.rm&&v.AFrameworkApplication.fa.ka("PPTDisableDirectPrintDialogDownloadPDFLink")||1===v.AFrameworkApplication.Aa.jb.rm&&v.AFrameworkApplication.fa.ka("XLODisableDirectPrintDialogOpenPDFLink"))?(t=document.createElement("span"),2===
v.AFrameworkApplication.Aa.jb.rm?t.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===v.AFrameworkApplication.Aa.jb.rm&&(t.innerText=CommonUIStrings.l_InternalError_Directive,m.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.xLa=t,N.appendChild(document.createElement("br")),N.appendChild(t)):(ha=document.createElement("a"),ha.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,ha.href=t,ha.target="_blank",ha.id="PrintPDFLink",ha.className=
"AllowBrowserClick",this.xLa=ha,N.appendChild(document.createElement("br")),N.appendChild(ha),this.Vr&&zd.a.addHandler(ha,"click",Object(r.a)(this,this.jrk,"onSubmit")),this.eP.ob(la.a.click,this.xLa,Object(r.a)(this,this.p_f,"downloadPDFLinkClicked"),null));this.Pv.push(this.xLa);return N}jrk(t){this.Vr&&(this.Vr.target="_blank",this.Vr.submit());t.preventDefault()}xzi(){if(0<this.Pv.length){const t=new Oa.a(this.Pv),N=gc.FocusManager.instance().il();N&&(this.xLa.focus(),N.uj=t,N.DW=!0)}}p_f(){m.ULS.sendTraceTag(4585050,
328,50,"Download PDF from Direct Print dialog clicked.");return!1}f$a(){m.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")}yCk(){m.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.mnb&&this.mnb.stop()}dispose(){this.xLa&&(this.eP.xb(la.a.click,this.xLa,Object(r.a)(this,this.p_f,"downloadPDFLinkClicked")),this.xLa=null);sa.a.vO(this.I1);this.I1=null;super.dispose()}}Object(h.a)(ib,"DirectPrintDialog",Ma.StandardDialog,[983]);class Cb{constructor(t){this.eP=
t}c4i(t,N){return new ib(this.eP,t,N,null)}}Object(h.a)(Cb,"DirectPrintDialogFactory",null,[966]);var yc=d(1165),gd=d(63);class od{constructor(t,N){this._url=t;this.JTh=N}SZf(){this.JTh?gd.a.downloadFile(this._url):gd.a.an(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")}dispose(){}}Object(h.a)(od,"OpenUrlInTabDialogDownloadBehavior",null,[796,106]);var Mc=d(54);class Rd extends Ma.StandardDialog{constructor(t,N=!0,ha=!1,za=null,Ra=null,qb=!1){super();this.clb=this.blb=this.Vr=
this.Aaa=null;var Qb=this.vSe?this.vSe:CommonUIStrings.l_DefaultDialogTitle;Rd.Hub=qb;this.otd=za||new od(t,!0);const vc=[],Zc=[];Rd.W0&&(this.PBc&&this.PBc.forEach(Id=>{Array.add(vc,Id)}),this.TFf&&this.TFf.forEach(Id=>{Array.add(Zc,Id)}));N?ha?(this.yd=4,this.Ue(1,this.buttonText),this.Ue(2,CommonUIStrings.l_DialogClose)):(this.yd=6,this.Ue(0,CommonUIStrings.l_DialogClose)):this.yd=5;qb=document.createElement("span");this.$Xb&&(qb.className=this.$Xb);za=document.createElement("a");za.innerText=
this.vxb;za.href=t;za.target="_blank";za.id=this.$6b;za.className=ua.AFrame.xGf;var Wc=!Mc.a.QS&&!!Ra&&0<Ra.count;if(Wc){const Id=jb.a.c2d(t,Ra);Ra=jb.a.RFe(t,Ra);za.href="#";za.target="_self";this.Vr=document.createElement("form");this.Vr.id="printPreviewPostForm1";this.Vr.method="post";this.Vr.target="_blank";this.Vr.action=Ra;for(var Md of Id)Ra=document.createElement("input"),Ra.type="hidden",Ra.name=Md.key,Ra.value=Md.value,this.Vr.appendChild(Ra)}else this.Vr=null;this.Vr||Rd.Hub?Rd.Hub||Array.add(Zc,
{["type"]:"AppLinkProps",["id"]:this.$6b,["text"]:this.vxb,["onExecute"]:()=>{this.$bh()}}):Array.add(Zc,{["type"]:"AppLinkProps",["id"]:this.$6b,["text"]:this.vxb,["handler"]:{["href"]:Wc?"#":t,["target"]:Wc?"_self":"_blank"}});this.Pla&&Array.add(vc,this.Pla);ha?(t=document.createElement("span"),t.innerText=this.Pla.replace("{0}",""),qb.appendChild(t)):this.dVg?(t=document.createElement("span"),t.id=this.ji("message"),Md=document.createElement("span"),Ra=document.createElement("span"),Wc=this.Pla.split("{0}"),
Md.innerText=Wc[0],Ra.innerText=Wc[1],t.appendChild(Md),t.appendChild(za),t.appendChild(Ra),qb.appendChild(t)):(t=document.createElement("span"),t.innerText=this.Pla,qb.appendChild(t),qb.appendChild(document.createElement("br")),qb.appendChild(document.createElement("br")),qb.appendChild(za),Rd.Hub||Array.add(vc,"{0}"));this.Vr&&qb.appendChild(this.Vr);Rd.W0&&(this.kTa&&(this.X6b?this.hDf(this.kTa,this.X6b):(Array.add(vc,"{0}"),Array.add(Zc,{["type"]:"AppLinkProps",["id"]:"LearnMoreLinkId",["text"]:this.kTa,
["onExecute"]:()=>{this.dXc()}}))),this.KAc(vc,Zc));this.pCb(Qb,null,this.d7d,null,Object(r.a)(this,this.t2,"dialogHandler"),Rd.W0?null:qb);this.i5(this.ji("message"));!Rd.W0&&this.X6b&&this.kTa&&(Qb=document.createElement("div"),Qb.className="WACDialogLearnMoreLinkContainer",this.Aaa=document.createElement("a"),this.Aaa.innerText=this.kTa,this.Aaa.href=this.X6b,this.Aaa.target="_blank",this.Aaa.id=this.ji("LearnMoreLinkId"),this.Aaa.className=ua.AFrame.xGf,Qb.appendChild(this.Aaa),N?this.rc.insertBefore(Qb,
this.rc.lastChild):this.rc.appendChild(Qb),this.i5(String.format("{0} {1}",this.ji("message"),this.ji("LearnMoreLinkId"))));this.cNb=za;ha?this.bR(this.XC):this.bR(this.cNb);this.o7b();v.AFrameworkApplication.Aa.jR.ob(la.a.click,this.cNb,Object(r.a)(this,this.o_f,"downloadLinkClicked"),null);this.Aaa&&v.AFrameworkApplication.Aa.jR.ob(la.a.click,this.Aaa,Object(r.a)(this,this.dXc,"learnMoreLinkClicked"),null);this.B2e=!1}get d7d(){return null}get vSe(){return null}get Pla(){return null}get X6b(){return null}get kTa(){return null}get dVg(){return!1}get buttonText(){return CommonUIStrings.l_Open}get $Xb(){return null}get PBc(){return null}get TFf(){return null}X6(){this.Vr&&
(this.blb||(this.blb=Object(r.a)(this,this.ejk,"onActionButtonClicked"),this.en.ob(la.a.click,this.XC,this.blb)),this.clb||(this.clb=Object(r.a)(this,this.fjk,"onActionButtonKeyUp"),this.Lg.ob(la.a.wl,this.XC,this.clb)));super.X6()}ejk(t){this.I2f(t);return!0}fjk(t){return this.CWc(t,Object(r.a)(this,this.I2f,"executeDismissActionButtonFromArgs"))}I2f(t){this.Vr&&this.Vr.submit();this.O5a(t.Ac)}f$a(){}o_f(){this.q7b();this.Vr?this.Vr.submit():this.otd.SZf();return!0}dXc(){return!1}dispose(){this.otd.dispose();
this.cNb&&(v.AFrameworkApplication.Aa.jR.xb(la.a.click,this.cNb,Object(r.a)(this,this.o_f,"downloadLinkClicked")),this.cNb=null);this.Aaa&&(v.AFrameworkApplication.Aa.jR.xb(la.a.click,this.Aaa,Object(r.a)(this,this.dXc,"learnMoreLinkClicked")),this.Aaa=null);this.en&&this.blb&&(this.en.xb(la.a.click,this.XC,this.blb),this.blb=null);this.Lg&&this.clb&&(this.Lg.xb(la.a.wl,this.XC,this.clb),this.clb=null);super.dispose()}$bh(){this.Vr&&(document.body.appendChild(this.Vr),this.Vr.submit(),document.body.removeChild(this.Vr))}t2(t){1===
t&&(this.f$a(),this.Vr?Rd.W0&&this.$bh():this.otd.SZf());this.dispose()}static get W0(){return v.AFrameworkApplication.Aa.jb.gC&&v.AFrameworkApplication.Aa.jb.xyg}static get Hub(){return Rd.S6e}static set Hub(t){Rd.S6e=t}}Rd.S6e=!1;Object(h.a)(Rd,"ADialogWithLinkToResource",Ma.StandardDialog,[]);class ye extends Rd{constructor(t,N,ha=null,za=!0,Ra=!1){super(t,!0,!(ye.g_a&&za),new od(t,N),ha,Ra);ye.g_a=ye.g_a&&za;if(ye.g_a){N=document.createElement("iframe");za=null;Ra=this.dIi;N.name="pdfObjectFrame";
N.id="pdfObjectIFrame";if(ha&&0<ha.count){const qb=jb.a.c2d(t,ha);t=jb.a.RFe(t,ha);za=document.createElement("form");za.id="printPreviewPostForm";za.method="POST";za.target=N.name;za.action=t;for(let Qb of qb)t=document.createElement("input"),t.type="hidden",t.name=Qb.key,t.value=Qb.value,za.appendChild(t)}else N.src=t;Ra.appendChild(N);za&&(Ra.appendChild(za),za.submit());Sys.UI.DomElement.addCssClass(N,"DirectPrintPdfObjectHidden");oa.a.BO(N,oa.a.pK,oa.a.KB)}}get d7d(){return"Print_32x32x32"}get vSe(){return ye.g_a?
CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}get Pla(){return ye.g_a?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}get PBc(){const t=[];Array.add(t,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Rd.Hub){let N=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==v.AFrameworkApplication.Aa.jb.uWf&&(N=v.AFrameworkApplication.Aa.jb.uWf);Array.add(t,N)}return ye.g_a?t:null}get vxb(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}get $6b(){return"PrintPDFLink"}get buttonText(){return CommonUIStrings.l_PrintDialogOpenPDF}get $Xb(){return v.AFrameworkApplication.ara?
"UIFontDialogTextLarge":null}o7b(){m.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")}q7b(){v.AFrameworkApplication.ej.t8a(9540,1);m.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")}f$a(){m.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")}static get g_a(){return!!v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.jb.gC&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Mc.a.QS||Mc.a.Aj||Mc.a.eg||Mc.a.W5b)&&!v.AFrameworkApplication.v6b&&
v.AFrameworkApplication.fa.ka("ShouldHostDefaultToNativeBrowserPrintExperience")}static set g_a(t){}}Object(h.a)(ye,"PrintDialogWithLinkToPdf",Rd,[]);class oe{constructor(t){this.isEnabled=Boolean.parse(t.DirectPrintIsEnabled||"false");this.JNj=Boolean.parse(t.DirectPrintProbeIsEnabled||"false");this.iKj=Boolean.parse(t.DirectPrintEnabledForInternetExplorer||"false");this.Shb=(t.DirectPrintSupportedMimeTypes||"").split(oe.JTd);this.rZa=(t.DirectPrintSupportedPlugins||"").split(oe.JTd);this.hxj=(t.DirectPrintImmersivePreviewPlugins||
"").split(oe.JTd);this.Zug=Boolean.parse(t.DirectPrintEnabledForEdge||"false");this.RFj=Boolean.parse(t.ChromePrintLayoutFixIsEnabled||"false");this.noi=parseInt(t.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.que=14;this.fVg=14394;if(t=t.DirectPrintMinimalSupportedEdgeVersion){const N=t.split(".");2===N.length?(this.que=parseInt(N[0]),this.fVg=parseInt(N[1])):m.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",t)}else m.ULS.sendTraceTag(20734113,
208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}}oe.JTd=",";Object(h.a)(oe,"DirectPrintBrsSettings",null,[]);class Bb{constructor(t,N){this.yQe=t;this.rZa=N}}Object(h.a)(Bb,"DirectPrintProbeResults",null,[]);var Ff=d(198),pg=d(101);class xf{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc){this.gAc=null;this.BMh=t;this.nQb=N;this.Izd=ha;this.fQh=za;this.XQh=Ra;this.cRb=new yc.a(Object(r.a)(this,this.Lbj,"getProbeResults"));this.Usd=qb;this.Tef=Zc;this.CEd=Qb;this.YQh=
vc;this.kRh=Wc}get xK(){return this.BMh}start(){}LCk(){this.xK.JNj&&this.CZj()}MFk(){const t=Array(this.xK.Shb.length);if(void 0!==this.nQb&&null!==this.nQb)for(let N=0;N<this.xK.Shb.length;N++)t[N]=this.xK.Shb[N]in this.nQb&&this.fQh(this.nQb[this.xK.Shb[N]]);return t}NFk(){const t=Array(this.xK.rZa.length),N=!(void 0===this.Izd||null===this.Izd);for(let ha=0;ha<this.xK.rZa.length;ha++){const za=this.xK.rZa[ha];t[ha]=N&&za in this.Izd?!0:this.XQh(za)}return t}Xgj(){const t=this.MFk(),N=Array(t.length);
for(let ha=0;ha<t.length;ha++)N[ha]=t[ha]?this.DQi(this.nQb[this.xK.Shb[ha]]):null;return N}DQi(t){if(void 0===t||null===t)return null;t=t.enabledPlugin;return void 0===t||null===t?null:t.name}CZj(){m.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this.cRb.value.yQe,this.cRb.value.rZa)}Lbj(){var t=this.Xgj();const N=this.NFk(),ha={},za={};for(let Ra=0;Ra<this.xK.Shb.length;Ra++)ha[this.xK.Shb[Ra]]=t[Ra];for(t=0;t<this.xK.rZa.length;t++)za[this.xK.rZa[t]]=N[t];return new Bb(ha,za)}ycl(){return this.kRh||
!this.xK.isEnabled||v.AFrameworkApplication.v6b?!1:this.Akl()}Nrh(){if(null!=this.gAc)return this.gAc;const t=xf.Xug(this.xK);return this.gAc=this.xK.Zug&&t||this.OFj()}OFj(){return Mc.a.Nj&&this.xK.RFj&&Mc.a.EEc>=this.xK.noi?!0:!1}Akl(){if(!this.YQh(this.xK))return!1;var t=pg.a.q4d(this.cRb.value.yQe);for(const N of t)if(void 0!==N&&null!==N)return!0;t=pg.a.q4d(this.cRb.value.rZa);for(const N of t)if(N)return!0;return!1}atj(){const t=pg.a.q4d(this.cRb.value.yQe);for(const N of t)if(Ff.a.contains(this.xK.hxj,
N))return!0;return!1}Psh(t){v.AFrameworkApplication.Aa&&v.AFrameworkApplication.fa.ka("DirectPrintDialogAsStandardDialogIsEnabled")?this.Tef(t,null):this.ycl()?this.kJi(t,this.atj()&&!0):this.Tef(t,null)}kJi(t,N){const ha=this.CEd.zi("UserAction","OpenDirectPrintDialog");this.Usd.c4i(t,N).nia();ha.stop()}static qQj(t){try{return new ActiveXObject(t),!0}catch(N){m.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",t)}return!1}static SHj(t){return void 0===t||null===
t?!1:!(void 0===t.enabledPlugin||null===t.enabledPlugin)}static create(t){const N=new oe(v.AFrameworkApplication.fa.appSettings);let ha=null;try{ha=window.navigator.mimeTypes}catch(Wc){m.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}let za=null;try{za=window.navigator.plugins}catch(Wc){m.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}const Ra=xf.SHj,qb=xf.qQj;t=t.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");const Qb=v.AFrameworkApplication.Aa.EU,
vc=xf.rQj,Zc=!!v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.jb.gC&&!v.AFrameworkApplication.fa.ka("PrintDialogFallbackLinkEnabled");return new xf(N,ha,za,Ra,qb,t,Qb,vc,(Wc,Md)=>new ye(Wc,!1,Md,!0,Zc),v.AFrameworkApplication.isEmbedded)}static rQj(t){return Mc.a.Nj||Mc.a.Aj&&t.iKj||t.Zug&&xf.Xug(t)?!0:!1}static Xug(t){var N=Mc.a.yPa;if(N){var ha=N.split(".");if(2===ha.length)return N=parseInt(ha[0]),ha=parseInt(ha[1]),N>t.que||N===t.que&&ha>=t.fVg}return!1}}Object(h.a)(xf,"DirectPrintManager",
null,[925]);class qe{constructor(){this.h2e=this.Da=null}get name(){return"Common.App.DirectPrint"}Wb(t){this.Da=t;t.register(Cb,"Common.App.DirectPrint.DirectPrintDialogFactory").ma().na(()=>new Cb(v.AFrameworkApplication.Aa.jR));t.register(925,"Common.App.DirectPrint.IDirectPrintManager").ma().na(()=>xf.create(this.Da))}init(){this.h2e=this.Da.resolve("Common.App.DirectPrint.IDirectPrintManager");this.h2e.start()}dispose(){}}Object(h.a)(qe,"PackageManager",null,[2,3]);var Oh=d(1096),Cf=d(300);class Bg{constructor(t,
N){this.uNb=null;this.Ca=t;this.eb=N}ub(){(this.uNb=this.eb.Ga("StatusBarEnvironmentNameToUse"))&&""!==this.uNb&&this.Ca.pa(F.a.p$g,D.a.frame,Object(r.a)(this,this.uwl,"updateEnvironmentName"),96)}uwl(t,N,ha,za,Ra){if(1===ha)return 32;Ra[Oh.a.Value]=this.uNb;Ra[Cf.a.labelText]=this.uNb;Ra[Oh.a.Visible]=!0;return 32}}Object(h.a)(Bg,"DisplayEnvironmentName",null,[]);class Gf{constructor(){this.Da=null}get name(){return"Common.App.DisplayEnvironmentName"}Wb(t){this.Da=t;this.Da.register(Bg,"Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ma().na(()=>
new Bg(v.AFrameworkApplication.Ta,v.AFrameworkApplication.fa))}init(){this.Da.resolve("Common.App.DisplayEnvironmentName.DisplayEnvironmentName").ub()}dispose(){}static main(){e.a.instance.Bc(new Gf)}}Object(h.a)(Gf,"DisplayEnvironmentNamePackage",null,[2,3]);var dh=d(170),qg=d(543);class Pf extends qg.a{constructor(t){super(t)}get sXb(){return!1}createElement(){const t=document.createElement("link");t.setAttribute("rel","stylesheet");t.setAttribute("type","text/css");t.setAttribute("href",this.ft);
return t}GGc(){return null}kjc(){this.element.setAttribute("href","");this.element.setAttribute("href",this.XL.ft)}}Object(h.a)(Pf,"CssResource",qg.a,[]);var qd=d(280),Tf=d(2);class Pg{constructor(){this.jxc=this.itc=null}bWj(){this.itc||(m.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),this.itc=Tf.Task.WAA(Pg.kWj(),Pg.SVj()),this.itc.continueWith(t=>{m.ULS.sendTraceTag(21030599,324,10,"{0}",gb.a.P_d(t.Wi))},5));return this.itc}cWj(){if(!this.jxc)try{m.ULS.sendTraceTag(39978390,
324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.jxc=Tf.Task.WAA(Pg.uVd(qd.a.create(v.AFrameworkApplication.fa.Ga("DimeUrl"),null,null))),this.jxc.continueWith(t=>{m.ULS.sendTraceTag(39978391,324,10,"{0}",gb.a.P_d(t.Wi))},5)}catch(t){m.ULS.sendTraceTag(594874951,324,10,"{0}",gb.a.P_d(t))}return this.jxc}static kWj(){var t=Pg.FPc("inproductmessaging.js");t=qd.a.create(t,null,null);return Pg.uVd(t)}static SVj(){var t=Pg.FPc("inproductmessaging.css");t=new Pf(t);return Pg.uVd(t)}static FPc(t){return dh.a.OWb(String.format("ipm/{0}",
t))}static uVd(t){Fc.a.Kx(t);return t.BEa}}Object(h.a)(Pg,"DependencyDownloader",null,[931]);class Ee{}Ee.Mtk="inProductMessagingOverlayDiv";Ee.Ixk="PlayButtonImage";Ee.mUk="ReplayButtonImage";Object(h.a)(Ee,"Constants",null,[]);class xe{constructor(){this.cxf=this.Fgf=this.UYe=!0;this.nUk=this.Jxk=null;this.tgk=!1;this.locale=null;this.IBh={}}get autoPlay(){return this.UYe}set autoPlay(t){this.UYe=t}get BVg(){return this.Fgf}set BVg(t){this.Fgf=t}get Gsh(){return this.cxf}set Gsh(t){(this.cxf=t)&&
this.f6k()}f6k(){this.zEf(Ee.Ixk,this.Jxk);this.zEf(Ee.mUk,this.nUk)}zEf(t,N){N&&(this.IBh[t]=N)}}Object(h.a)(xe,"FirstRunExperienceUISettings",null,[926]);class jh{constructor(){this.completed=this.fPk=!1}}Object(h.a)(jh,"FirstRunExperienceViewData",null,[924]);var yg=d(189);class xc{constructor(t,N,ha){this.Ca=t;this.Oh=N;this.auc=ha}ub(){this.Ca.pa(F.a.RUi,D.a.frame,Object(r.a)(this,this.QUi,"firstRunExperienceHandler"),64);this.Ca.ya(F.a.c6f,D.a.frame,Object(r.a)(this,this.oxj,"inProductMessagingTabHandler"));
this.Ca.ya(F.a.b6f,D.a.frame,Object(r.a)(this,this.nxj,"inProductMessagingShiftTabHandler"));this.Ca.ya(F.a.AIi,D.a.frame,Object(r.a)(this,this.BIi,"dimeLaunchHandler"));this.Ca.ya(F.a.Igh,D.a.frame,yg.ActionManager.Hg);this.Ca.ya(F.a.GUk,D.a.frame,yg.ActionManager.Hg);this.Ca.ya(F.a.HUk,D.a.frame,yg.ActionManager.Hg);this.Oh&&this.Oh.updateCommandUI()}QUi(t,N,ha,za,Ra){2===ha&&this.auc.hUj(Ra);return 32}BIi(t,N,ha,za,Ra){2===ha&&this.auc.gUj(Ra);return 32}oxj(t,N,ha){return 2===ha?this.auc.Oue():
32}nxj(t,N,ha){return 2===ha?this.auc.Hue():32}}Object(h.a)(xc,"InProductMessagingActor",null,[]);class me{constructor(){this.Qdh=this.c5=this.zxh=this.aXc=this.instance=null}}Object(h.a)(me,"DimeExperienceUISettings",null,[]);var Dd=d(515);class Qe{constructor(t,N,ha,za,Ra){this.HLc=!1;this.KYb=null;this.Ca=t;this.X2a=N;this.Txc=ha;this.T5=za;this.Qfa=Ra}Pzj(t){rb.b("getHeaderApi")?t.isFeatureEnabled("MsoPremiumBadge",!0).then(N=>{const ha=t.isFreemiumUpsellEnabled();ha&&(appChrome.getHeaderApi().then(za=>
{za.updatePremiumStatus(N,ha);return null}),t.sfb("MsoPremiumBadge",za=>{appChrome.getHeaderApi().then(Ra=>{Ra.updatePremiumStatus(za.isEnabled,ha);return null})}));return null}):m.ULS.sendTraceTag(593859840,324,10,"getHeaderApi not available")}hUj(t){this.Txc.bWj().continueWith(()=>{this.X2a.Efl(t)})}gUj(t){let N="gopremium",ha=null,za=()=>{};t?(t.experience&&""!==Object(Q.a)(String,t.experience)&&(N=Object(Q.a)(String,t.experience)),t.onTaskComplete&&(za=t.onTaskComplete),t.campaignId&&""!==Object(Q.a)(String,
t.campaignId)&&(ha=Object(Q.a)(String,t.campaignId))):m.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");this.PBg(N,za,ha)}PBg(t,N,ha=null){if(this.HLc&&this.KYb){const za={};za.experience=t||"gopremium";za.campaignId=ha||Dd.b(this.T5,this.Qfa,Object(Q.a)(String,za.experience),!0);this.Ca.processAction(F.a.Igh,2);m.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+za.experience);try{const Ra=Object.assign(new me,{instance:this.KYb,aXc:za,zxh:N||
(()=>{}),c5:qb=>{m.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+qb.status)},Qdh:()=>{m.ULS.sendTraceTag(51675406,324,10,"Dime launch error");this.HLc=!1;this.KYb=null}});this.X2a.Pdl(Ra)}catch(Ra){m.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Ra.message),this.HLc=!1,this.KYb=null,this.Ca.La(F.a.ILc,2,{["experience"]:za.experience})}}else m.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Ca.La(F.a.ILc,2,{["experience"]:t})}dWj(){this.Txc.cWj().continueWith(()=>
{try{var t=gb.a.wg(v.AFrameworkApplication.uiCulture);const za=Dd.c(this.T5);if(za){var N={};N.partnerId=za;N.language=t;N.sessionId=v.AFrameworkApplication.userSessionId;N.authHint=v.AFrameworkApplication.fa.Ga("UserPrincipalName");var ha=v.AFrameworkApplication.fa.Ga("Puid")||"";""!==ha&&(t={},t.puid=ha,N.userInfo=t);this.KYb=new Dime(N);this.HLc=!0;m.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else m.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(za){m.ULS.sendTraceTag(51675410,
324,10,"FreemiumUpsellDialogDependencies failed: "+za.message)}},3)}Oue(){return this.X2a.Oue()}Hue(){return this.X2a.Hue()}}Object(h.a)(Qe,"InProductMessagingUIManager",null,[923]);class tf{constructor(){this.Ozf=0;this.Rlb=Array(5);this.Rlb[0]=10;this.Rlb[1]=15;this.Rlb[2]=50;this.Rlb[3]=100;this.Rlb[4]=200}Init(t){this.Ozf=t}SendTrace(t,N){m.ULS.sendTraceTag(34182235,this.Ozf,this.Rlb[t],"{0}",N)}}Object(h.a)(tf,"DefaultNetworkingManager",null,[960]);var Rb=d(197);class Jc{constructor(t){this.Kd=
t}Efl(t){t&&(InProductMessaging.Networking.NetworkingMgr=new tf,InProductMessaging.Networking.NetworkingMgr.Init(387),InProductMessaging.Init(t.Gsh,t.BVg,t.autoPlay,t.tgk,t.locale,Object(r.a)(this,this.Glk,"onDismissFirstRunExperience"),t.IBh),this.j5(Ee.Mtk,!0))}Pdl(t){if(t&&t.instance&&t.aXc){let N=document.getElementById("wacDimeContainer");N||(N=document.createElement("div"),N.id="wacDimeContainer",document.body.appendChild(N));v.AFrameworkApplication.fa.ka("DimeFocusManagerIsEnabled")&&this.j5("wacDimeContainer",
!1);t.aXc.parentElementId="wacDimeContainer";t.instance.launch(t.aXc,t.zxh).then(ha=>{this.Nma();document.body.removeChild(N);t.c5(ha)}).catch(ha=>{this.Nma();document.body.removeChild(N);t.Qdh(ha)})}else throw Error.argument("DimeExperienceUISettings");}j5(t,N){if(this.Kd&&t&&(t=document.getElementById(t),this.Fzj(t),t=this.Kd.SP("InProductMessagingFocusId"))){const ha=this.Kd.ze;ha&&"InProductMessagingFocusId"===ha.name||this.Kd.NX("InProductMessagingFocusId",!1);N&&this.HEe(t.scope)}}Fzj(t){var N=
this.Kd.Dc("InProductMessagingFocusId");N.parent=ua.AFrame.mD;const ha=new Rb.DOMFocusListing(()=>t);ha.wfb=!1;ha.vo(3);ha.vo(2);ha.vo(4);N=this.Kd.Jha(()=>t,N,ha);N.xfb();N.DW=!0;N.IOa=!0}HEe(t){t.np(gc.FocusManager.instance().ypa);t.np(gc.FocusManager.instance().zpa);t.bindAction(gc.FocusManager.instance().ypa,F.a.c6f);t.bindAction(gc.FocusManager.instance().zpa,F.a.b6f)}Nma(){this.Kd&&(this.Kd.R4("InProductMessagingFocusId"),this.Kd.MFb("InProductMessagingFocusId"))}Glk(t,N){this.Nma();t=Object.assign(new jh,
{completed:t,fPk:N});v.AFrameworkApplication.Ta.La(F.a.PUi,2,t)}Oue(){const t=document.activeElement,N=this.Kd.il();return t&&N&&N.uj&&t===N.uj.lxb?(N.uj.wE(t),N.CCb()?32:8):4}Hue(){const t=document.activeElement,N=this.Kd.il();return t&&N&&N.uj&&t===N.uj.Aia?(N.uj.wE(t),N.ACb()?32:8):4}}Object(h.a)(Jc,"InProductMessagingUIWrapper",null,[922]);class Qc{constructor(){this.Da=null}get name(){return"Common.App.InProductMessaging"}Wb(t){t.register(Pg,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").ma().na(()=>
new Pg);t.register(Jc,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").ma().na(()=>new Jc(gc.FocusManager.instance()));t.register(Qe,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").ma().na(()=>new Qe(v.AFrameworkApplication.Ta,t.resolve("Common.IInProductMessagingUIWrapper"),t.resolve("Common.App.InProductMessaging.IDependencyDownloader"),v.AFrameworkApplication.Aa.jb.rm,v.AFrameworkApplication.Aa.jb.rHa));
t.register(xc,"Common.App.InProductMessaging.InProductMessagingActor").ma().na(()=>new xc(v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,t.resolve("Common.IInProductMessagingUIManager")));t.register(xe,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").ma().na(()=>new xe);t.register(jh,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").ma().na(()=>new jh);this.Da=t}init(){this.Da.resolve("Common.App.InProductMessaging.InProductMessagingActor").ub();
v.AFrameworkApplication.fa.ff(()=>{v.AFrameworkApplication.Aa.jb.xN&&hb.a.get_instance().gk(15,()=>{this.Da.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Pzj(t)})});v.AFrameworkApplication.fa.ka("FreemiumUpsellShowDialogIsEnabled")&&Dd.a()&&!Mc.a.Vw&&1!==v.AFrameworkApplication.Aa.jb.rm&&this.Da.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{t.isFeatureEnabled("MsoPremiumBadge",
!0).then(N=>{!N&&t.isFreemiumUpsellEnabled()&&this.Da.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").dWj();return null})})})}dispose(){}static main(){e.a.instance.Bc(new Qc)}}Object(h.a)(Qc,"InProductMessagingPackage",null,[2,3]);var Ph=d(381),ng=d(555);class se{static PMi(t){return se.tLf("New",t)}static QMi(t){return se.tLf("Open",t)}static cLf(t,N){return se.$3a("LoadingMenuSection",se.YWj,t,se.oVb("lblLoading",N))}static pVb(t,N,ha=null,za=null){return se.$3a("MessageMenuSection",
se.hWg,N,se.oVb("lblMessage",t,ha,za))}static Ogi(t){return se.cLf(t,CommonUIStrings.l_VoicedLoadingText)}static Pgi(t,N){return se.pVb(CommonUIStrings.l_NewCreationLocationMessage,t.labelText,N.VQ,N.CJa)}static Ngi(t,N){return se.pVb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,N.CJa,"\n\n"),t.labelText)}static eLf(t){return se.pVb(CommonUIStrings.l_NewGenericErrorMessage,t.labelText)}static Lgi(t,N,ha){return se.$3a("menuNewBlank",se.auj,ha?t.labelText:null,se.kVb(t.Tlg,t.Ulg,t.Vlg,
null,t.nDa,t.G3b,N,"blank"))}static uhi(){return se.oVb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)}static qLf(){return se.oVb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)}static vhi(t,N){return se.$3a("menuNewTemplates",t,null,N)}static Jgi(t,N){return se.$3a("menuNewMoreTemplates",se.Y6f,null,se.kVb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,t,N))}static Ofi(t,N,ha){let za="";ha&&N&&(za=se.$3a("BrowseMoreMenuSection",
se.Y6f,null,se.kVb("btnBrowseMore",N,N,null,null,null,t||"1959943459",ha)));return za}static oVb(t,N,ha=null,za=null){let Ra=za;N&&0<N.length&&(Ra=se.MWg.QHa(N).trimEnd(),Ra=0<=Ra.indexOf("{0}")?String.format(Ra,za):String.format("{0} {1}",Ra,za));ha=ha&&za?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',gb.a.je(ha),gb.a.je(za),gb.a.je(Ra)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',
gb.a.je(t||""),se.MWg.QHa(gb.a.je(N||"")),ha)}static kVb(t,N,ha,za,Ra,qb,Qb,vc){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',gb.a.je(t||""),gb.a.je(N||""),gb.a.je(ha||""),za||"32by32",gb.a.je(Ra||""),gb.a.je(qb||""),Qb,gb.a.je(vc||""))}static tLf(t,N){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
t,N)}static $3a(t,N,ha,za){ha=ha?String.format('Title="{0}"',gb.a.je(ha)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',gb.a.je(t||""),gb.a.je(N||""),ha,za)}}se.hWg="MenuMru";se.YWj="MenuLoading";se.auj="MenuHeader";se.Y6f="MenuFooter";se.MWg=ng.a.Lw("\n","&#10;");Object(h.a)(se,"NewAndOpenXmlUtilities",
null,[]);var pf=d(94);class $d{constructor(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}}Object(h.a)($d,"HostInformation",null,[]);var Ye=d(132),Kd=d(171),Yd=d(125),Zf=d(427),ef=d(516);class Ke{constructor(t,N,ha,za,Ra,qb){this.vzc=this.Xn=this.Wqc=null;this.Nyc=this.eEd=!1;this.ngf=0;this.RDd=this.hxd=!1;this.Fga=t;this.INb=N;this.mga=new yc.a(()=>new Ph.a(ha.value,Object(r.a)(this,this.LCa,"getMoreInfoEventReceived")));this.OSh=za;this.tMa=Ra;this.wXh=qb;this.fSb=this.jjd;2===
this.wX.Bva&&(this.RDd=!0);v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&this.ASi()}get U1(){switch(this.wX.Bva){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}ASi(){Ye.a.instance.Cb(new aa.a(5,1,0,()=>{this.getTemplateListJson()}))}ub(){const t=this.wX.PCb;t.ya(F.a.newDocument,D.a.frame,Object(r.a)(this,this.newDocument,"newDocument"));t.ya(F.a.TAe,
D.a.frame,Object(r.a)(this,this.TAe,"populateNewMenu"))}newDocument(t,N,ha,za,Ra){if(1===ha)return 32;if(2===ha&&Ra){if(v.AFrameworkApplication.fa.ka("BackstagePremiumTemplateExperienceEnabled")&&Ra.IsPremium)return appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!1)),v.AFrameworkApplication.Ta.processAction(F.a.zBk,2);if(Ra.MenuItemId&&Ra.SourceControlId)return"NewDocumentHome"===Ra.SourceControlId&&Hb.a("NewDocumentFromHomeTab"),this.W4a(Ra.MenuItemId,Ra.SourceControlId)}return 8}W4a(t,
N){var ha=this.N7c.pRd;if(null===ha)return 8;var za=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(v.AFrameworkApplication.K9a&&za){m.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");const Ra={};Ra[Kd.a.Sxh]=t;Ra[Kd.a.U1]=this.U1;Ra[Kd.a.lcid]=v.AFrameworkApplication.lcid.toString();Ra[Kd.a.reason]=Zf.a.WAi;v.AFrameworkApplication.ES().execute(qb=>{qb.sendMessage(Yd.a.W4a,Ra)})}else za=(new Date).getTime(),
N=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",ha,gb.a.Qe(this.Cva),gb.a.Qe(t),gb.a.Qe(this.U1),gb.a.Qe(v.AFrameworkApplication.lcid.toString()),gb.a.Qe(za.toString()),gb.a.Qe(N),gb.a.Qe(v.AFrameworkApplication.canary),v.AFrameworkApplication.hh),(ha=v.AFrameworkApplication.fa.Ga("ScenarioId"))&&""!==ha&&(N+="&wdscenarioid="+gb.a.Qe(ha)),N+="&"+v.AFrameworkApplication.eRa(),v.AFrameworkApplication.BSa&&(N+="&"+v.AFrameworkApplication.aOc()),
(ha=this.Xn?this.Xn.VQ:null)&&(N+="&DestinationUrl="+gb.a.Qe(ha)),gd.a.an(N,"_blank",void 0,"CreateNewDocument");2===this.wX.Bva&&m.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",{["AppType"]:ef.a[this.wX.Bva],["Template"]:t});return 32}s_j(t){let N=Number.MAX_VALUE,ha=Number.MIN_VALUE;const za=window.performance;if(za&&"undefined"!==typeof za.getEntriesByName){for(let qb=0;qb<t.length;qb++){var Ra=za.getEntriesByName(t[qb]);Ra&&0<Ra.length&&(Ra=Ra[0],N=Math.min(parseInt(String(Ra.fetchStart)),
N),ha=Math.max(parseInt(String(Ra.responseEnd)),ha))}ha>N&&m.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",{["TotalElapsedMs"]:ha-N,["MinFetchStart"]:N,["MaxResponseEnd"]:ha})}}TAe(t,N,ha,za,Ra){if(1===ha)return this.RDd&&(v.AFrameworkApplication.DN("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.RDd=!1),32;2!==ha||this.hxd||(this.ngf=(new Date).getTime(),m.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",{["ShouldShowTemplates"]:this.jjd,
["CachedNewMenuXmlExists"]:!!this.Wqc,["ShouldCallGetMoreInfo"]:this.wX.EJa}));v.AFrameworkApplication.qta("AdditionalDocumentTemplates-tf;AdditionalDocumentTemplates-cf");return this.Pyk(Ra)}Pyk(t){t&&(this.Wqc?t.PopulationXML=this.Wqc:(this.wX.EJa&&!this.Xn&&this.Xgk.ica("Opened New menu",!0),t.PopulationXML=this.eZi(this.getTemplateListJson())));return 32}Ayg(){return!this.wX.EJa||!!this.Xn&&3===this.Xn.state&&!!this.Xn.CJa&&!!this.Xn.VQ}bOj(){return v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.jb.hEa?
!0:this.Ayg()}getTemplateListJson(){if(!this.jjd||!this.bOj())return null;if(this.fSb&&!this.Nyc){var t="9";v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)&&(t="21");const N=v.AFrameworkApplication.fa.appSettings;"NumberOfTemplatesInBackstage"in N&&(t=N.NumberOfTemplatesInBackstage);let ha=this.U1;"TemplateCollectionId"in N&&(ha=N.TemplateCollectionId);t=String.format(this.wX.Xla+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",
gb.a.Qe(v.AFrameworkApplication.lcid.toString()),gb.a.Qe(ha),t);Boolean.parse(N.AppendOriginQueryParam||"false")&&(t+="&org=backstage");Boolean.parse(N.BackstagePremiumTemplateExperienceEnabled||"false")&&"TemplateTier"in N&&(t+="&templateTier="+N.TemplateTier);t+="&"+v.AFrameworkApplication.eRa();v.AFrameworkApplication.BSa&&(t+="&"+v.AFrameworkApplication.aOc());this.wX.$dc.yj(t,1,null,null,!1,2,za=>{this.wX.g$a("CreateNewActor.GetTemplateListJson",za.data);this.bnl(za.data.Sd)},za=>{this.wX.g$a("CreateNewActor.GetTemplateListJson",
za.data);this.anl()},null,void 0,void 0,void 0,void 0,"5");this.fSb=!1}return this.vzc}bnl(t){v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.WordOnline.AdditionalDocumentTemplates",!1)?this.vzc=this.kTi(t):this.vzc=t;this.fSb=!1;this.$ic();if(v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.jb.hEa&&rb.c()){t=v.AFrameworkApplication.fa.ka("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");const N=v.AFrameworkApplication.K9a;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.vzc,
!0,t&&N))}}anl(){this.Nyc=this.fSb=!0;this.$ic();v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.jb.hEa&&rb.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));pf.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)}kTi(t){t=JSON.parse(t);const N=new C.a;N.add("TM00002102");N.add("TM00002101");N.add("TM16392939");const ha=Ff.a.Zna(t,za=>N.contains(za.AssetId));t=t.slice(0,9);t.splice.apply(t,[2,0].concat(ha));
return JSON.stringify(t)}hij(t){var N=0;for(var ha=0;ha<t.length;ha++)if("ST"===t[ha].ImageType){N=ha;break}const za=t.length?t[N]:null;t=za?za.Url||"":"";var Ra;let qb=ha=N=!1;if(za&&(Ra=za.AspectRatio))Ra=parseFloat(Ra),1>Ra?N=!0:1.5<Ra?ha=!0:1===Ra&&(qb=!0);else switch(m.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",{["Url"]:t}),this.wX.Bva){case 3:N=!0;break;case 2:ha=!0;break;case 5:qb=!0}return{returnValue:t,RK:N?"95by123":ha?"123by69":qb?"100by100":"123by95"}}eZi(t){const N=
({Xid:t}=this.Mgi(t,this.N7c,this.N7c.uVb||"1056925771")).returnValue;t&&(this.Wqc=N,m.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{["ElapsedMsSinceMenuOpened"]:(new Date).getTime()-this.ngf}));return N}LCa(t,N){m.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Xn||3!==t.state?2===t.state&&(m.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.eEd=!0,this.$ic()):(this.Xn=t,N||this.$ic(),v.AFrameworkApplication.Aa&&
v.AFrameworkApplication.Aa.jb.hEa&&rb.c()&&rb.d("setFileMenuHostInformation")&&(t=Object.assign(new $d,{hostUrl:this.Xn.VQ,hostName:this.Xn.CJa,folderUrl:v.AFrameworkApplication.breadcrumbFolderUrl,folderName:v.AFrameworkApplication.breadcrumbFolderName}),m.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(t))))}Mgi(t,N,ha){let za;za=!1;const Ra=this.Ayg();let qb="";this.wX.EJa&&(this.eEd?(qb=se.eLf(N),this.eEd=
!1,m.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.Xn?Ra?qb=se.Pgi(N,this.Xn):this.Xn.zCj?(za=!0,this.fSb=!1,qb=se.Ngi(N,this.Xn),m.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message")):(za=!0,qb=se.eLf(N),m.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",{["PersonalFileStorageUrlIsSet"]:!!this.Xn.VQ,["StorageServiceDisplayNameIsSet"]:!!this.Xn.CJa})):
(qb=se.Ogi(N.labelText),m.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner")));Ra&&(qb+=se.Lgi(N,ha,!qb)+({Xid:za}=this.thi(t,ha)).returnValue);return{returnValue:se.PMi(qb),Xid:za}}thi(t,N){let ha;ha=!1;if(!this.jjd)return ha=!0,m.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Xid:ha};let za="",Ra="",qb="MenuTemplate";if(this.Nyc)za=se.qLf(),this.Nyc=!1,m.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");
else if(t){try{const Qb=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0);za=this.shi(Qb,N);m.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");v.AFrameworkApplication.OWg&&"OneDrive"===this.Cva&&(Ra=se.Jgi(this.Ygk,v.AFrameworkApplication.OWg))}catch(Qb){m.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",{["JsonToConvert"]:t}),za=se.qLf()}ha=!0}else qb="MenuLoading",za=se.uhi(),m.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");
return{returnValue:se.vhi(qb,za)+Ra,Xid:ha}}shi(t,N){let ha="";const za=[];for(let qb=0;qb<t.length;qb++){var Ra=t[qb];let Qb="";if(Ra){const vc=Ra.Title,Zc=Ra.AssetId;Ra=Ra.Thumbnails;Zc&&vc&&Ra&&({RK:Ra,returnValue:Qb}=this.hij(Ra),ha+=se.kVb("jbtnNewTemplate"+qb,vc,null,Ra,null,Qb,N,Zc))}za[qb]=Qb}t=new aa.a(4,1,5E3,()=>{this.s_j(za)},106);this.wX.L7c.Cb(t);return ha}$ic(){this.hxd=!0;this.wX.JWg.V0(this.N7c.N_b);this.hxd=!1}get wX(){return this.Fga.value}get N7c(){return this.INb.value}get Xgk(){return this.mga.value}get Ygk(){return this.OSh.value}get Cva(){return this.tMa.value}get jjd(){return this.wXh.value}}
Object(h.a)(Ke,"CreateNewActor",null,[]);class gi{constructor(){this._initialized=!1;this.JEd={}}aC(t){this.X1f();return this.get(t)}contains(t){this.X1f();return t.toString()in this.JEd}X1f(){this._initialized||(this.S3h(),this._initialized=!0)}bob(t,N){this.JEd[t.toString()]=N}get(t){return this.JEd[t.toString()]}}Object(h.a)(gi,"AIntlHelper",null,[]);class Rf extends gi{constructor(){super()}S3h(){this.bob(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.bob(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.bob(2,CommonUIStrings.l_Open);this.bob(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.bob(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.bob(5,CommonUIStrings.l_VoicedLoadingText)}static get instance(){return Rf.Ja||(Rf.Ja=new Rf)}static Psk(t){return Rf.instance.aC(t)}}Rf.Ja=null;Object(h.a)(Rf,"MruActorIntlHelper",gi,[]);var Uf;(function(t){t[t.success=0]="success";t[t.failure=1]="failure";t[t.spinner=2]="spinner";t[t.none=3]="none"})(Uf||(Uf={}));Object(h.b)("DisplayState",Uf);var Ed=d(33);
class vg{constructor(t,N,ha,za,Ra,qb,Qb,vc){this.nrd=null;this.CGd=!0;this.Vqc="";this.nZh=0;this.Qlb=null;this.dyd=3;this.eb=vc;this.Fga=t;this.Paa=N;this.JNh=ha;this.nKh=za;this.mKh=Ra;this.mga=new yc.a(()=>new Ph.a(qb.value,null));this.sOh=new yc.a(()=>new Ph.a(Qb.value,Object(r.a)(this,this.lgk,"mruEventResultReceived")));this.eb.ka("WacInTabOpenMRUIsEnabledForUiHost");this.eb.ka("UiHostSupportsDocRebootFeatures")}lgk(t,N){this.Qlb=t;N||this.edh()}oOk(){this.pO.PCb.pa(F.a.SAe,D.a.frame,Object(r.a)(this,
this.SAe,"populateMruMenu"),96)}SAe(t,N,ha,za,Ra){return 1!==ha&&Ra?this.Oyk(Ra):32}Oyk(t){this.sNi();this.rNi();t.PopulationXML=se.QMi(this.Vqc+this.nrd);return 32}sNi(){var t=3;let N=!1;if(this.Vqc&&this.nZh===this.Qlb.wol)m.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{["CacheRefresh"]:"Not Dirty"}),t=this.dyd;else{m.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{["CacheRefresh"]:"Starting"});var ha=this.pO.gF();
this.Qlb=this.kgk.ica("File Open opened",!0);this.Vqc&&2!==this.dyd&&3!==this.Qlb.state?N=!0:(t=this.pej(this.Qlb),v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.jb.hEa&&rb.c()&&t&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(t,!0)),this.Vqc=({Ogk:t}=this.fZi(this.Qlb)).returnValue);ha=this.pO.gF()-ha;m.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{["CacheRefresh"]:"Complete",["ElapsedMs"]:ha})}2!==t&&(ha={["DisplayState"]:Uf[t]},1!==t&&
(ha.IsStale=N),m.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",ha));this.dyd=t}pej(t){let N;try{N=Ed.c(t.cve)}catch(ha){N=null,m.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",ha)}return N}rNi(){this.CGd?(m.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary."),this.nrd=({uCl:this.CGd}=this.sck()).returnValue):m.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");
m.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",{["WaitingOnLinkInfo"]:this.CGd,["NotDisplayingLink"]:!this.nrd})}fZi(t){let N;1===t.state||0===t.state?(m.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",{["Display"]:"Spinner"}),t=2,N=se.cLf(this.ZCa(2),this.ZCa(5))):3===t.state&&t.cve?(N=this.Kgi(t.cve),t=0):(m.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",{["Display"]:"Server Error"}),N=se.pVb(this.ZCa(1),this.ZCa(2)),t=1);return{returnValue:N,Ogk:t}}Kgi(t){let N;
const ha=this.udc.uVb||"2155708348";if(t.length){N=se.oVb("lblRecentDocuments",this.ZCa(3));let za=0;for(let Ra=0;Ra<t.length;Ra++){const qb=t[Ra];"FileName"in qb&&"DocumentUrl"in qb&&"Path"in qb&&(N+=se.kVb("MruButton"+Ra,qb.FileName.toString(),qb.Path.toString(),null,this.udc.nDa,this.udc.G3b,ha,qb.DocumentUrl.toString()),qb.IsPinned&&za++)}N=se.$3a("RecentDocumentsMenuSection",se.hWg,this.ZCa(2),N);m.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",{["Display"]:"MRU List",["TotalDocuments"]:t.length,
["NumPinnedDocuments"]:za})}else N=se.pVb(this.ZCa(0),this.ZCa(2)),m.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",{["Display"]:"Empty MRU"});return N}sck(){let t;t=!0;let N=this.ffi;var ha=this.efi;if(N&&ha||!this.pO.EJa)t=!1;else{const za=this.eOc.ica("File Open",!1);3===za.state&&(N=za.VQ,ha=za.CJa,t=!1)}ha=ha?String.format(this.ZCa(4),ha):null;return{returnValue:se.Ofi(this.udc.uVb,ha,N),uCl:t}}edh(){this.pO.JWg.V0(this.udc.N_b)}get pO(){return this.Fga.value}get ZCa(){return this.Paa.value}get udc(){return this.JNh.value}get ffi(){return this.nKh.value}get efi(){return this.mKh.value}get eOc(){return this.mga.value}get kgk(){return this.sOh.value}}
Object(h.a)(vg,"MruRenderer",null,[]);var Jd=d(172),Ie=d(436);class gf{constructor(t,N,ha,za,Ra,qb,Qb){this.Xn=null;this.Hvf=!1;this.ALa=this.AZe=0;this.ZSh=t;this.dmb=N;this.cwc=ha;this.INb=za;this.tMa=Ra;this.Fga=qb;this.mga=new yc.a(()=>new Ph.a(Qb.value,Object(r.a)(this,this.LCa,"getMoreInfoEventReceived")))}W4a(){!this.Xn&&this.pve.EJa?this.eOc.ica("NewDocumentFromStream",!0):this.createNewDocumentFromStream()}LCa(t){if(!this.Xn&&3===t.state)this.Xn=t;else if(2===t.state){this.Hvf?m.ULS.sendTraceTag(24904471,
202,10,"After second try GetMoreResult still fail."):(this.eOc.ica("NewDocumentFromStream",!0),this.Hvf=!0);return}this.createNewDocumentFromStream()}createNewDocumentFromStream(){this.AZe=(new Date).getTime();var t=this.ISi.pRd;if(null===t)this.dmb(null);else{var N=this.cwc.menuItemId,ha=this.cwc.tU,za=this.cwc.Qjl,Ra=this.cwc.PSi;this.ALa="streamBase64"===za?Ra.length/1024:0;m.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.U1,this.ALa);var qb=(new Date).getTime();t=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",
t,gb.a.Qe(this.Cva),gb.a.Qe(N),gb.a.Qe(this.U1),gb.a.Qe(v.AFrameworkApplication.lcid.toString()),gb.a.Qe(qb.toString()),gb.a.Qe(ha),gb.a.Qe(v.AFrameworkApplication.canary),v.AFrameworkApplication.hh,gb.a.Qe(za));t+="&"+v.AFrameworkApplication.eRa();v.AFrameworkApplication.BSa&&(t+="&"+v.AFrameworkApplication.aOc());(N=this.Xn?this.Xn.VQ:null)&&(t+="&DestinationUrl="+gb.a.Qe(N));this.pve.$dc.yj(t,2,Ra,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(r.a)(this,this.Rgk,"newDocumentFromStreamSuccessHandler"),
Object(r.a)(this,this.Qgk,"newDocumentFromStreamFailureHandler"),null,void 0,void 0,void 0,void 0,"31")}}Rgk(t){if(t&&t.data&&t.data.Sd){var N;({ou:N}=Ed.d(t.data.Sd)).returnValue?(t=N,t.StatusCode!==Jd.a.py&&t.StatusCode!==Jd.a.WXb?(m.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.U1,this.ALa,t.StatusCode),this.dmb(null)):t.NewDocumentUrl&&""!==t.NewDocumentUrl?(m.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.U1,this.ALa,(new Date).getTime()-this.AZe),this.ZSh(t.NewDocumentUrl)):(m.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.U1,this.ALa),this.dmb(null))):(m.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.U1,this.ALa,{["ResponseData"]:Ie.a.woc(t.data.Sd)}),this.dmb(null))}else m.ULS.sendTraceTag(24904473,202,10,
"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.U1,this.ALa),this.dmb(null)}Qgk(t){t&&t.data&&m.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.U1,this.ALa,t.data.status);this.dmb(null)}get U1(){switch(this.pve.Bva){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}get ISi(){return this.INb.value}get Cva(){return this.tMa.value}get pve(){return this.Fga.value}get eOc(){return this.mga.value}}
Object(h.a)(gf,"NewDocumentFromStreamOperation",null,[]);class eh{constructor(t,N,ha,za){this.INb=t;this.tMa=N;this.Fga=ha;this.rOh=za}create(t,N,ha){return new gf(t,N,ha,this.INb,this.tMa,this.Fga,this.rOh)}}Object(h.a)(eh,"NewDocumentFromStreamOperationFactory",null,[958]);var rg=d(287);class Cg{get name(){return"Common.App.NewAndOpen.UX"}Wb(t){t.register(eh,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").ma().na(()=>
new eh(new yc.a(()=>v.AFrameworkApplication.Aa.jb.Y_d()),new yc.a(()=>v.AFrameworkApplication.Cva),new yc.a(()=>t.qb("Common.INewAndOpenCommonHelpers")),new yc.a(()=>t.qb("Common.IEventEmitter<Common.IGetMoreInfoResult>"))))}init(){v.AFrameworkApplication.fa.ff(()=>{this.rDa()})}rDa(){const t=rg.a.Ju(u.a.instance.Ka("Common.INewAndOpenCommonHelpers")),N=rg.a.Ju(u.a.instance.Ka("Common.IEventEmitter<Common.IGetMoreInfoResult>"));v.AFrameworkApplication.Cva&&Tf.Task.WAA.call(null,t,N).continueWith(()=>
{const ha=new Ke(new yc.a(()=>t.result),new yc.a(()=>v.AFrameworkApplication.Aa.jb.Y_d()),new yc.a(()=>N.result),new yc.a(()=>v.AFrameworkApplication.Aa.jb.Z_d().uVb||"1959943459"),new yc.a(()=>v.AFrameworkApplication.Cva),new yc.a(()=>v.AFrameworkApplication.wLj));ha.ub();ha.$ic()});if(v.AFrameworkApplication.DEe){const ha=rg.a.Ju(u.a.instance.Ka("Common.IEventEmitter<Common.IMruResult>"));Tf.Task.WAA.call(null,t,N,ha).continueWith(()=>{const za=new vg(new yc.a(()=>t.result),new yc.a(()=>Rf.Psk),
new yc.a(()=>v.AFrameworkApplication.Aa.jb.Z_d()),new yc.a(()=>v.AFrameworkApplication.Osk),new yc.a(()=>v.AFrameworkApplication.Nsk),new yc.a(()=>N.result),new yc.a(()=>ha.result),v.AFrameworkApplication.fa);za.oOk();za.edh()})}}dispose(){}}Object(h.a)(Cg,"UXPackageManager",null,[2,3,106]);class kh extends Ma.StandardDialog{constructor(){super();this.yd=0;this.Ue(1,CommonUIStrings.l_DialogClose)}Zu(t){this.jy(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)}IBa(t){this.jy(t,
CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}}Object(h.a)(kh,"ErrorDialog",Ma.StandardDialog,[934]);class De{K8f(){m.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");const t=new fg.a;t.Dg("api.onedrive.com");return t.task}}Object(h.a)(De,"OneDriveConsumerEndpointHelper",null,[908]);var Nd=d(163);class Od{constructor(t,N,ha,za){this.L1a=this.hma=null;this.JDd=this.LDd=!1;this.jmb=null;this.eb=t;this.Kjb=N;this.o1a=ha;this.qA=za}get QGf(){return this.Kjb}get fa(){return this.eb}Gtb(){this.jmb||
(this.jmb=this.ODb?qd.a.create(this.ODb,null,null,null,!1):null);return this.jmb}setup(t){this.L1a=t;this.LDd||this.JDd?this.LDd&&this.L1a&&this.L1a(!0):(t=this.Gtb())?(this.JDd=!0,t.BEa.continueWith(N=>{this.vok(N)}),Fc.a.Kx(t)):(m.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.L1a(!1))}Txe(t){m.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",t.Wi?t.Wi.toString():"No error detail.")}vok(t){this.JDd=!1;
if(t.hm)this.Txe(t),this.L1a(!1);else try{this.LDd=!0,m.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.f8d(),m.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.L1a(!0)}catch(N){m.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",N.toString()),this.L1a(!1)}}Kmc(t){this.hma=t;this.o1a?m.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(m.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),
this.setup(Object(r.a)(this,this.nwe,"onApiReady")))}nwe(t){t?this.bXc():this.it()}it(){this.qA().Zu(Nd.a.nsk)}onSuccess(t){m.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");this.hma&&this.hma(!0,t)}dispose(){this.jmb&&this.jmb.dispose()}}Object(h.a)(Od,"AOneDriveFilePickerApiManager",null,[959,106]);class mj extends Od{constructor(t,N,ha,za,Ra,qb){super(N,ha,za,qb);this.Zk=null;this.Oaa=t;this.BXh=Ra}get ODb(){return this.fa.Ga("OneDriveApiUrl")}start(t,N){this.Zk=
t;this.Kmc(N)}f8d(){WL.init(1===this.QGf||2===this.QGf?{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId}:{["client_id"]:this.fa.appSettings.UploadToSkyDriveClientId,["env"]:"INT"})}Kmc(t){this.hma=t;!this.o1a&&this.Oaa.T9d?(m.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(r.a)(this,this.nwe,"onApiReady"))):(m.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.BXh())}bXc(){try{m.ULS.sendTraceTag(17909027,
352,50,"Launching file dialogue"),WL.fileDialog(this.Zk).then(Object(r.a)(this,this.onSuccess,"onSuccess"),Object(r.a)(this,this.hz,"onFailure"))}catch(t){m.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",t,t.stack),this.it()}}hz(t){if(t&&t.error){if("user_canceled"===t.error.code){m.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}m.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else m.ULS.sendTraceTag(17909060,
352,50,"File Dialog returned with no response");this.hma&&this.hma(!1,t);this.it()}}Object(h.a)(mj,"OneDriveFilePickerApiManagerV5",Od,[]);class qi extends Od{constructor(t,N,ha,za,Ra){super(t,N,ha,za);this.Ntc=this.hif=null;this.iNh=Ra;this.options={};this.options.clientId=this.fa.Ga("OneDriveApiV7ClientId");this.options.cancel=Object(r.a)(this,this.jmd,"toggleHostDivVisibility")}get ODb(){return this.fa.Ga("OneDriveApiV72Url")}start(t,N){this.Ntc=N;const ha=this.iNh.K8f();ha.continueWith(()=>{m.ULS.sendTraceTag(24134241,
352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");this.hif=ha.result;this.Kmc((za,Ra)=>{this.jmd();t(za,Ra)})},3);ha.continueWith(()=>{m.ULS.sendTraceTag(24134242,352,15,ha.Wi.message);this.jmd()},5)}f8d(){this.options.success=t=>{const N={};N.data=t;this.onSuccess(N)};this.options.error=t=>{const N={};N.error=t;this.hz(N)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.hif;this.options.advanced.iframeParentDiv=this.Ntc}bXc(){try{m.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.jmd(),OneDrive.open(this.options)}catch(t){m.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",t.message),this.it()}}hz(t){this.hma&&this.hma(!1,t);this.it()}jmd(){this.Ntc.style.visibility="hidden"===this.Ntc.style.visibility?"":"hidden"}}Object(h.a)(qi,"OneDriveFilePickerApiManagerV7",Od,[]);class Vf extends Od{constructor(t,N,ha,za){super(t,N,ha,za);this.AJh=t;this.options={};this.options.advanced={};this.options.action=
"query";this.options.clientId=this.fa.Ga("OneDriveApiV72ClientId");this.options.advanced.trapFocus=!0}get ODb(){return this.fa.Ga("OneDriveApiV72Url")}start(t,N,ha,za){this.options.advanced.iframeParentDiv=ha;this.options.advanced.endpointHint=za;this.options.cancel=N;this.AJh.ka("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent=
{});this.Kmc(t)}Kmc(t){this.hma=t;this.o1a?m.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(m.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(r.a)(this,this.nwe,"onApiReady")))}f8d(){this.options.success=t=>{const N={};N.data=t;this.onSuccess(N)};this.options.error=t=>{const N={};N.error=t;this.hz(N)}}bXc(){try{m.ULS.sendTraceTag(23881879,216,50,"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(t){m.ULS.sendTraceTag(23881880,
216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",t.message,t.stack),this.it()}}Txe(t){m.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",t.Wi?t.Wi.toString():"No error detail.");Fc.a.CQk(this.ODb);this.jmb=null}it(){this.qA().IBa(Nd.a.tZk)}hz(t){this.hma&&this.hma(!1,t)}}Object(h.a)(Vf,"OneDriveFilePickerApiManagerV72",Od,[]);class Ai{constructor(t){this.olsSessionId=this.value=this.key=null;this.olsSessionId=t}}Object(h.a)(Ai,"IExtraData",null,
[]);class $g extends Vf{constructor(t,N,ha,za){super(t,N,ha,za);this.options.advanced.filter=t.Ga("OneDriveApiV72Filter")||"folder,photo";this.options.advanced.linkType="download";this.options.multiSelect=v.AFrameworkApplication.bHf;t.ka("OneDriveApiV72CommandModeEnabled")&&(this.options.commandMode=t.Ga("OneDriveApiV72CommandMode")||"none");t.ka("OneDriveApiV72QosExtraDataEnabled")&&(this.options.qosExtradata=new Ai(v.AFrameworkApplication.userSessionId))}get ODb(){return this.fa.Ga("OneDriveApiV72Url")}bXc(){try{m.ULS.sendTraceTag(26071182,
352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?this.options.qosExtradata.olsSessionId:"",v.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(t){m.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",t.message,t.stack),this.it()}}}Object(h.a)($g,"OneDriveFilePickerApiOpenManagerV72",
Vf,[]);class Ch{constructor(t){this.Nv=null;this.$h=t;this.GCd=3}K8f(){this.Nv=new fg.a;m.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint");this.JJe();return this.Nv.task}JJe(t=null){const N=String.format("GetMoreInfoHandler.ashx?{0}",v.AFrameworkApplication.$4a);this.$h.sV(N,1,null,t,["PersonalFileStorageUrl","X-NewKey"],2,Object(r.a)(this,this.Y9i,"getMoreInfoSucceeded"),Object(r.a)(this,this.W9i,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,
"21")}W9i(t){if(t.data.Le===Jd.a.ihc&&"X-NewKey"in t.data.qj){m.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");const N={};N["X-Key"]=t.data.qj["X-NewKey"];this.JJe(N)}else 0<this.GCd?(m.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.GCd),this.GCd--,this.JJe()):(m.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.Nv.setException(Error.create("GetMoreInfo request failed and no more retries remain")))}Y9i(t){"PersonalFileStorageUrl"in t.data.qj&&""!==t.data.qj.PersonalFileStorageUrl?(m.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Nv.Dg(t.data.qj.PersonalFileStorageUrl)):(m.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Nv.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}}
Object(h.a)(Ch,"OneDriveForBusinessEndpointHelper",null,[908]);var nf=d(345);class qf{constructor(){this.Da=null}get name(){return"Common.App.OneDriveFilePickerApi"}init(){}dispose(){}Wb(t){this.Da=t;this.Da.register(mj,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").ma().na(()=>new mj(nf.a.instance,v.AFrameworkApplication.fa,v.AFrameworkApplication.RPa,v.AFrameworkApplication.mQ,v.AFrameworkApplication.Tsh,()=>
new kh));v.AFrameworkApplication.Pwb?this.Da.register(908,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().na(()=>new De):this.Da.register(908,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").ma().na(()=>new Ch(v.AFrameworkApplication.Ge));this.Da.register(qi,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").ma().na(()=>new qi(v.AFrameworkApplication.fa,v.AFrameworkApplication.RPa,v.AFrameworkApplication.mQ,()=>new kh,this.Da.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper")));
this.Da.register(Vf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").ma().na(()=>new Vf(v.AFrameworkApplication.fa,v.AFrameworkApplication.RPa,v.AFrameworkApplication.mQ,()=>new kh));this.Da.register($g,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").ma().na(()=>new $g(v.AFrameworkApplication.fa,v.AFrameworkApplication.RPa,v.AFrameworkApplication.mQ,()=>new kh))}static main(){e.a.instance.Bc(new qf)}}Object(h.a)(qf,"PackageManager",null,[2,3]);var Wi=d(168),
Tg=d(179);class rd{constructor(t){this.B$a=this.Upe=this.Wbb=this.B1c=0;this.zoe=this.COg=null;t?(this.yb=t,this.qYb=Date.now,this.DBi(),this.cOk()):m.ULS.sendTraceTag(520955213,209,10,"Can not initialize PenMinutesManager because TaskManager is null")}d6k(){this.COg="Office.PowerPoint.Online.Data.Activity.PenInputMinutes"}cOk(){window.document.body.addEventListener("pointerenter",Object(r.a)(this,this.Yok,"onPointerEnter"));window.document.body.addEventListener("pointerleave",Object(r.a)(this,this.Zok,
"onPointerLeave"));u.a.instance.Ka("Common.App.VisibilityManagement.IVisibilityManager").execute(t=>{t.EBc(Object(r.a)(this,this.P2b,"handleVisibilityChange"))})}Yok(t){"pen"!==t.pointerType||this.Wbb||(this.Wbb=Math.floor(this.qYb()/1E3),this.Wbb<=this.B1c&&(this.Wbb=this.B1c),this.Upe=0)}Zok(){this.ikg()}ikg(){const t=Math.ceil(this.qYb()/1E3);this.Wbb&&t>this.B1c&&(this.Upe=t,this.B$a+=this.Upe-this.Wbb);this.B1c=t;this.Wbb=0}P2b(t,N){0!==N.newState&&this.ikg()}DBi(){this.zoe=new aa.a(4,2,6E4,
Object(r.a)(this,this.yZj,"logPenUsage"));this.yb.Cb(this.zoe)}yZj(){0<this.B$a&&this.Olh(this.B$a);this.B$a=0}Olh(t){const N=new Tg.a;N.name=this.COg;const ha=[];(t=Wi.a.F7("PenInputSec",t.toString(),3))&&Array.add(ha,t);N.dataFields=ha;w.a.sendActivityEvent(N)}dispose(){0<this.B$a&&this.Olh(this.B$a);this.yb.Ng(this.zoe)}}Object(h.a)(rd,"PenMinutesManager",null,[907]);class ze{constructor(){this.hBd=this.Da=null}get name(){return"Common.App.PenMinutesManager"}Wb(t){this.Da=t;const N=v.AFrameworkApplication.pe;
this.Da.register(907,"Common.App.PenMinutesManager.IPenMinutesManager").ma().na(()=>new rd(N))}init(){this.hBd=this.Da.resolve("Common.App.PenMinutesManager.IPenMinutesManager")}dispose(){this.hBd&&this.hBd.dispose()}static main(){e.a.instance.Bc(new ze)}}Object(h.a)(ze,"PenMinutesManagerPackage",null,[2,3]);class xh extends Ma.StandardDialog{constructor(t,N){super();this.lmb=!1;this.WJ=null;this.Ca=t;this.ANb=N;this.XYa=!1}Zu(t,N,ha){this.WJ=N;this.lmb=ha;m.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",
t,ha);t=this.$Nd(t);0===t?(this.yd=6,this.Ue(0,CommonUIStrings.l_DialogClose)):(this.yd=0,this.Ue(1,CommonUIStrings.l_DialogClose));0===t&&m.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.jy(Nd.a.sZk,this.Y3i(t),this.X3i(t,N),Object(r.a)(this,this.THe,"retryDialogHandler"),!0)}THe(t){1===t?(m.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.WJ?this.Ca.La(F.a.xGb,2,[this.WJ,this.lmb]):this.Ca.processAction(F.a.xGb,2)):m.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")}$Nd(t){return 0>t||6<t?(m.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",t),0):t}X3i(t,N){t=this.$Nd(t);return this.ANb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,N),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][t]:[CommonUIStrings.l_FailToSaveFile,
CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,N),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][t]}Y3i(t){t=this.$Nd(t);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][t]}}
Object(h.a)(xh,"ErrorRetryDialog",Ma.StandardDialog,[965]);class Qj{constructor(t,N){this.eb=t;this.Ca=N;this.ANb=this.eb.ka("SaveToHostWithExtraCharsInFileName")}create(){return new xh(this.Ca,this.ANb)}}Object(h.a)(Qj,"ErrorRetryDialogFactory",null,[936]);class ae extends ad.a{constructor(t,N,ha,za,Ra,qb,Qb=null){super();this.XU=null;this.Ca=N;this.gaa=za;this.hAa=qb;this.eb=t;this.qA=Ra;this.Oh=ha;this.ANb=this.eb.ka("SaveToHostWithExtraCharsInFileName");this.Zk=Qb;this.Ue(1,CommonUIStrings.l_SaveButtonLabel)}get Aa(){return this.Oh}gZf(t,
N){this.JC(1,!!t&&t!==N);this.XU=document.getElementById(ae.J4f);zd.a.addHandler(this.XU,"change",Object(r.a)(this,this.c9c,"onFileNameChange"));zd.a.addHandler(this.XU,"input",Object(r.a)(this,this.c9c,"onFileNameChange"));this.XU.focus()}I4f(t){return this.ANb?(new RegExp("["+this.r2f('\\/:*?"<>|')+"]")).test(t):(new RegExp("["+this.r2f('\\/:*?"<>|#{}%~&')+"]")).test(t)}r2f(t){return t.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")}d5d(){const t=gb.a.yG(v.AFrameworkApplication.pu.Ix);this.JC(1,
!!this.XU&&""!==this.XU.value&&this.XU.value!==t)}c9c(){this.XU&&window.setTimeout(()=>{this.d5d()},0)}AKc(t,N){if(1!==t)m.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{t=N[ae.J4f];N=ae.z4g in N?N[ae.z4g]:!1;m.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",gb.a.Uch(t),N);const ha=gb.a.WV(v.AFrameworkApplication.fileName);(t=t?t.trim():null)&&""!==t&&""!==ha||1===this.Aa.state?
this.I4f(t)?this.qA.create().Zu(1,t,N):this.hAa.K0(t+ha,N,this.Zk):this.qA.create().Zu(2,t,N)}}dispose(){this.XU&&(zd.a.removeHandler(this.XU,"change",Object(r.a)(this,this.c9c,"onFileNameChange")),zd.a.removeHandler(this.XU,"input",Object(r.a)(this,this.c9c,"onFileNameChange")),this.XU=null);super.dispose()}}ae.J4f="txtFileName";ae.z4g="chkOverwrite";Object(h.a)(ae,"FileNameDialogBase",ad.a,[]);class nj{static get mg(){return ad.a.UB(nj.fo,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}
nj.fo="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(h.a)(nj,"FileNameDialogHtml",null,[]);class Xi extends ae{constructor(t,N,ha,za,Ra,qb){super(t,N,ha,za,Ra,qb);this.mg=nj.mg;this.ng="FileNameDialog-SaveAsToHost"}nia(t,N){const ha=gb.a.yG(v.AFrameworkApplication.pu.Ix);N={["txtFileName"]:t||ha,["lblFolderName"]:CommonUIStrings.l_ToCurrentFolder,["chkOverwrite"]:N};this.tj(CommonUIStrings.L_SaveAs,Object(r.a)(this,this.AKc,"fileNameDialogHandler"),N);this.gZf(t,ha)}}Object(h.a)(Xi,"FileNameDialog",ae,[963]);class La{constructor(t,N,ha,za,Ra,
qb){this.Ca=N;this.eb=t;this.gaa=za;this.hAa=qb;this.qA=Ra;this.Oh=ha}create(){return new Xi(this.eb,this.Ca,this.Oh,this.gaa,this.qA,this.hAa)}}Object(h.a)(La,"FileNameDialogFactory",null,[935]);class lb{constructor(t,N,ha){this.hAa=ha;this.eud=N;this.eb=t}ub(){2===v.AFrameworkApplication.Aa.jb.rm?v.AFrameworkApplication.Ta.pa(F.a.xGb,D.a.frame,Object(r.a)(this,this.Zjh,"saveAsToHostActionDispatcher"),4):v.AFrameworkApplication.Ta.ya(F.a.xGb,D.a.frame,Object(r.a)(this,this.Zjh,"saveAsToHostActionDispatcher"))}Zjh(t,
N,ha,za,Ra){return N.contextId!==D.a.frame||t!==F.a.xGb?2:this.eb.ka("SaveAsToHostBrsIsEnabled")?1===ha?A.SessionStatusManager.instance.gja||v.AFrameworkApplication.hQ?8:32:2===ha?(m.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),t=this.eud.create(),Ra&&Object.getType(Ra)===Array&&2===Ra.length?t.nia(Ra[0],!!Ra[1]):t.nia(null,!1),32):8:8}}Object(h.a)(lb,"SaveAsToHostActor",null,[]);class Nb{constructor(t,N,ha,za,Ra,qb,Qb,vc){this.Bn=null;this.lmb=this.t1=
!1;this.gAa=this.Zk=this.WJ=null;this.eb=N;this.Waa=this.eb.appSettings.SaveAsToHostWebServiceBase;this.P8e=za;this.epa=Ra;this.$h=ha;this.qA=qb;this.Vh=vc;this.Oh=Qb;this.Ca=t;this.aza=N.Ga("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}omc(){1!==this.Oh.state&&(this.Bn=this.epa(),this.Bn.message=CommonUIStrings.l_CommentProgressTooltip,this.Bn.yd=5,this.Bn.qr=!1,this.Bn.wna(CommonUIStrings.l_DefaultDialogTitle,null,null))}iY(t=0){1!==this.Oh.state&&this.qA.create().Zu(t,gb.a.yG(this.WJ),
this.lmb)}qfb(){const t=this.eb.appSettings.BreadcrumbFolderUrl;m.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");gd.a.an(t,gd.a.Z$(3),void 0,"UploadToHostManager.RedirectToFolder")}pfb(t){let N=!1,ha=!1;this.eb&&(N=this.eb.ka("SaveACopyIsEnabledForUiHost"),ha=this.eb.ka("UiHostSupportsDocRebootFeatures"));m.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",t,N,ha);if(N&&ha){m.ULS.sendTraceTag(51245197,216,
50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const za={};za[Kd.a.sFb]="1";za[Kd.a.documentUrl]=t;za[Kd.a.reason]=Zf.a.GIe;v.AFrameworkApplication.ES().execute(Ra=>{Ra.sendMessage(Yd.a.KBa,za)})}else N&&!ha&&v.AFrameworkApplication.Ysa?gd.a.an(t,gd.a.Z$(4),void 0,"UploadToHostManager.RedirectToEditUrl"):gd.a.an(t,gd.a.Z$(3),void 0,"UploadToHostManager.RedirectToEditUrl")}K0(t,N,ha=null){m.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.P8e&&!this.P8e()&&
this.$h&&(this.Vh&&(this.gAa=this.Vh.zi("DialogShown","SaveAsToHostUploadTime")),this.omc(),this.lmb=N,this.WJ=t,(this.Zk=ha)&&"true"===this.Zk.SkipSaveToHost?this.UJc():this.C2())}C2(){32!==this.Ca.processAction(F.a.eYa,1)?(m.ULS.sendTraceTag(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),this.UJc()):this.Ca.La(F.a.eYa,2,[()=>{m.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");this.UJc()},(t,N)=>{m.ULS.sendTraceTag(18989380,
219,15,"The file change is not saved successfully, this operation may lead to data loss.");this.iY(N)}])}Wrk(t){this.u5a();this.t1=!1;if(t&&t.data&&t.data.Sd)if(({ou:N}=Ed.d(t.data.Sd)).returnValue)if(t=N,t.StatusCode!==Jd.a.py&&t.StatusCode!==Jd.a.WXb){m.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON.");var N={};N.FailureReason=t.StatusCode.toString();N.ExtraInfo=t.ExtraInfo;this.Fwa(N);this.iY(parseInt(t.ExtraInfo))}else{m.ULS.sendTraceTag(8194050,216,50,
"UploadToHost execute success.");this.cHe();try{t.NewDocumentUrl&&""!==t.NewDocumentUrl?this.pfb(t.NewDocumentUrl):this.qfb()}catch(ha){m.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",ha.toString())}this.ggc()}else m.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ie.a.woc(t.data.Sd)}),this.Fwa({["FailureReason"]:"Failed to deserialize response"}),this.iY();else m.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),
this.Fwa({["FailureReason"]:"null response"}),this.iY()}Vrk(t){5!==t.data.status&&12!==t.data.status||this.t1?(m.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{["Status"]:t.data.status,["HttpStatus"]:t.data.Le}),this.Fwa({["FailureReason"]:t.data.Le.toString()}),this.u5a(),this.iY(),this.ggc()):(m.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.t1=!0,this.Zk&&"true"===this.Zk.SkipSaveToHost?this.UJc():this.C2())}u5a(){this.Bn&&
(this.Bn.close(),this.Bn=null)}ggc(){this.gAa&&(this.gAa.stop(),this.gAa=null)}cHe(){this.Zk&&"VersionHistory"===this.Zk.SaveEntryPoint&&this.Ca.processAction(F.a.jfd,2)}Fwa(t){this.Zk&&"VersionHistory"===this.Zk.SaveEntryPoint&&this.Ca.La(F.a.dHe,2,t)}UJc(){let t=this.Waa+this.aza;t=jb.a.Ri(t,"qs",gb.a.Qe(v.AFrameworkApplication.hh));t=jb.a.Ri(t,"n",gb.a.Qe((new Date).getTime().toString()));t=jb.a.Ri(t,"ov",gb.a.Qe(this.lmb.toString()));t=jb.a.Ri(t,"fn",gb.a.Qe(this.WJ));this.Zk&&this.Zk.FileDownloadUrl&&
(t=jb.a.Ri(t,"furl",gb.a.Qe(this.Zk.FileDownloadUrl)));this.$h.yj(t,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(r.a)(this,this.Wrk,"onUploadFinished"),Object(r.a)(this,this.Vrk,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")}}Object(h.a)(Nb,"UploadToHostManager",null,[921]);var lc=d(546);class Rc{constructor(){this.Da=null}get name(){return"Common.App.SaveAsToHost"}init(){v.AFrameworkApplication.fa.ff(Object(r.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){v.AFrameworkApplication.fa.ka("SaveAsToHostBrsIsEnabled")&&
this.Da.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").ub()}Wb(t){this.Da=t;this.Da.register(Qj,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").na(()=>new Qj(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta)).ma();this.Da.register(Nb,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").na(()=>new Nb(v.AFrameworkApplication.Ta,v.AFrameworkApplication.fa,v.AFrameworkApplication.Ge,()=>v.AFrameworkApplication.Vg,
()=>(new lc.a).create(),t.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.EU)).ma();this.Da.register(La,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").na(()=>new La(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.jb,t.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),t.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma();
this.Da.register(lb,"Common.App.SaveAsToHost.SaveAsToHostActor").na(()=>new lb(v.AFrameworkApplication.fa,t.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),t.resolve("Common.App.SaveAsToHost.UploadToHostManager"))).ma()}dispose(){}static main(){e.a.instance.Bc(new Rc)}}Object(h.a)(Rc,"SaveAsToHostPackage",null,[2,3]);class Ud extends Ma.StandardDialog{constructor(){super();this.yd=0;this.Ue(1,CommonUIStrings.l_DialogClose)}Zu(t,N){this.CZf(t,N,Nd.a.uZk)}CZf(t,N,ha){m.ULS.sendTraceTag(25180161,
216,10,"Show upload error dialog with error code {0}.",ha);this.jy(ha,t,N,null)}IBa(t,N){m.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.jy(Nd.a.wZk,t,N,null,!0)}}Object(h.a)(Ud,"ErrorDialog",Ma.StandardDialog,[944]);class Pd{static get mg(){return ad.a.UB(Pd.fo,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}Pd.fo="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(h.a)(Pd,"FileNameDialogHtml",null,[]);class Sd extends ae{constructor(t,N,ha,za,Ra,qb,Qb,vc){super(t,N,ha,za,Ra,qb,vc);this.KLa=this.jDd=this.PH=null;this.Mhi=CommonUIStrings.l_SaveToAnotherFolder;this.mg=Pd.mg;this.ng="FileNameDialog-SaveToSharePoint";this.NRb=Qb;this.LTh=vc}nia(t){const N=gb.a.yG(v.AFrameworkApplication.pu.Ix),ha=v.AFrameworkApplication.breadcrumbFolderName,za=v.AFrameworkApplication.breadcrumbBrandName,Ra={["txtFileName"]:t||N};let qb=CommonUIStrings.L_SaveAs;2===v.AFrameworkApplication.Aa.jb.rm&&
(qb=CommonUIStrings.L_SaveACopy);this.tj(qb,Object(r.a)(this,this.AKc,"fileNameDialogHandler"),Ra);this.gZf(t,N);this.CTd.style.width="450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost")||(this.PH=document.getElementById("anotherFolder"),t=document.getElementById("folderLocation"),this.jDd=oa.a.eHf(t,this.PH,"anotherFolderDescribedBy",""),this.PH.className="WACButton WACDialogButtonNormal",
t=!1,ha&&ha.length?(this.NCf(this.PH,this.jDd,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,za,ha)),t=this.H0h(za,ha)):this.NCf(this.PH,this.jDd,CommonUIStrings.l_CurrentOnlineFolder),this.f2h(this.PH),this.J0h(this.PH),t?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.PH,"SaveToAnotherLocationTwo"),m.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.PH,"SaveToAnotherLocationOne"),
zd.a.addHandler(this.PH,la.a.click,Object(r.a)(this,this.Aye,"onSaveToAnotherLocationClick")),zd.a.addHandler(this.PH,la.a.Xf,Object(r.a)(this,this.U1g,"onSaveToAnotherLocationKeyDown")))}H0h(t,N){let ha;ha=!1;const za=document.getElementById("currentLocation");za.innerText="";const Ra=this.hdg(za,t),qb=this.hdg(za,N);let Qb=255,vc=255;255<Ra+qb&&(Qb=Math.max(238,408-Ra),vc=Math.max(170,408-qb),ha=!0);this.H3h(za,t,vc,N,Qb);return ha}hdg(t,N){const ha=document.createElement("div");ha.innerText=N;
ha.style.visibility="hidden";t.appendChild(ha);N=ha.clientWidth;t.removeChild(ha);return N}H3h(t,N,ha,za,Ra){N&&(this.MCf(t,N,ha),this.v3h(t));za&&this.MCf(t,za,Ra)}MCf(t,N,ha){const za=document.createElement("div");za.innerText=N;za.title=N;za.className="SaveToAnotherFolderBreadcrumb";za.style.maxWidth=ha.toString()+"px";t.appendChild(za)}v3h(t){const N=document.createElement("span");N.id="FolderSeparator";const ha=document.createElementNS("http://www.w3.org/2000/svg","svg");ha.setAttribute("class",
"SeparatorCaret");const za=document.createElementNS("http://www.w3.org/2000/svg","polygon");za.setAttribute("points","1 4 1 11 5 7.5");ha.appendChild(za);N.appendChild(ha);t.appendChild(N)}NCf(t,N,ha){ha=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,ha);N&&(N.innerText=ha);t.tabIndex=0;t.setAttribute(oa.a.Ye,oa.a.hu)}J0h(t){const N=document.createElement("span");N.id="anotherFolderText";N.innerText=this.Mhi;N.className="AnotherFolderTextSpan";t.appendChild(N)}f2h(t){const N=
document.createElement("span");N.className="cui-img-cont-float cui-img-16by16 ";this.KLa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.KLa.setAttribute("class","FolderIconSVG");const ha=document.createElementNS("http://www.w3.org/2000/svg","path");ha.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.KLa.appendChild(ha);N.appendChild(this.KLa);t.appendChild(N)}U1g(t){!t||t.keyCode!==
ma.a.lq&&t.keyCode!==ma.a.YKb||this.Aye(t)}Aye(){if(this.XU){const t=gb.a.WV(v.AFrameworkApplication.fileName);let N=this.XU.value;this.hide();N&&""!==N&&""!==t||1===this.Aa.state?(""!==t&&(N+=t),this.I4f(N)?this.qA.create().Zu(1,N,!1):this.NRb.start(N,this.LTh)):this.qA.create().Zu(2,N,!1)}}ymi(t){this.PH&&this.KLa&&(t?(this.PH.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.PH,"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.KLa,"DisabledFolderIconSVG")):(this.PH.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.PH,
"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.KLa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.PH,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.KLa,"DisabledFolderIconSVG"))))}d5d(){super.d5d();this.ymi(!!this.XU&&""!==this.XU.value)}dispose(){this.PH&&(zd.a.removeHandler(this.PH,la.a.click,Object(r.a)(this,this.Aye,"onSaveToAnotherLocationClick")),zd.a.removeHandler(this.PH,la.a.Xf,Object(r.a)(this,this.U1g,"onSaveToAnotherLocationKeyDown")),this.PH=
null);super.dispose()}}Object(h.a)(Sd,"FileNameDialog",ae,[969]);var Le=d(1167),af=d(1168),zf=d(901),yh=d(214);class gg{constructor(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}}Object(h.a)(gg,"SaveAsDialogInput",null,[]);class Dh{constructor(){this.properties=this.friendlyPath=this.folderName=null}}Object(h.a)(Dh,"SaveLocation",null,[]);var Ug=d(87);class ui{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc){this.wyd=null;this.WJ="";this.NRb=t;this.qA=
N;this.Zk=Zc;this.hAa=ha;this.Oh=Ra;this.HE=za;this.b3a=Qb;this.Xmb=vc;qb&&(this.wyd=new yc.a(()=>new Ph.a(qb.value,null)))}a3i(){const t=new Le.a(af.a.Tq());t.$("type","currentHost");return Object.assign(new Dh,{folderName:this.HE.breadcrumbFolderName,friendlyPath:this.HE.breadcrumbBrandName,properties:t})}DPj(t){return!!t&&"ClassicMru"===t.type&&!!t.service_info&&!!t.service_info.service_id&&-1!==t.service_info.service_id.indexOf("SHAREPOINT")}hfj(){if(!this.wyd||!this.b3a)return null;var t=this.wyd.value.ica("SaveAsToSharePointDialog",
!1);if(!t||3!==t.state||!t.iWg)return null;t=t.iWg;const N=new C.a;let ha=0,za=0;for(var Ra=0;Ra<t.length;Ra++){var qb=t[Ra];if(!this.DPj(qb))continue;ha++;if(!qb.sharepoint_info)continue;const Qb=qb.url,vc=qb.sharepoint_info.site_url,Zc=qb.title;qb=zf.b(qb,v.AFrameworkApplication.isRtl);if(!(Qb&&vc&&Zc&&qb))continue;za++;const Wc=new Le.a(af.a.Tq());Wc.$("type","SharePoint");Wc.$("siteUrl",vc);Wc.$("folderUrl",Qb);za++;N.add(Object.assign(new Dh,{folderName:Zc,friendlyPath:qb,properties:Wc}))}Ra=
new Map;Ra.set("NumPlaces",t.length.toString());Ra.set("NumSharepointPlaces",ha.toString());Ra.set("placesWithMetadata",za.toString());pf.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",Ra);0<ha&&(za?.5>1*za/ha&&pf.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):pf.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return N}W3i(){const t=new C.a;t.add(this.a3i());const N=
this.hfj();N&&t.addRange(N);return Object.assign(new gg,{enableMoreLocations:!v.AFrameworkApplication.fa.ka("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.WJ,extension:gb.a.WV(this.HE.Ix),saveLocations:t.toArray(),scenario:"SaveToSharePoint"})}$Mc(){const t=Object(r.a)(this,this.W3i,"getDialogInput"),N={};N.inputPropsCallback=t;return N}nia(t){this.WJ=t;this.WJ||(this.WJ=String.format(CommonUIStrings.l_SaveACopy_Filename,gb.a.yG(this.HE.Ix)));t={["id"]:"SaveAsDialog",["bodyControls"]:this.$Mc()};
let N=CommonUIStrings.L_SaveAs;2===this.Oh.jb.rm&&(N=CommonUIStrings.L_SaveACopy);const ha=new ad.a(!1,!1,!0);ha.yd=1;ha.ng="SaveAsDialog";ha.Ue(1,CommonUIStrings.l_SaveButtonLabel);ha.tj(N,Object(r.a)(this,this.qZk,"saveAsDialogHandler"),t)}xel(t,N){t&&""!==t&&""!==N||1===this.Oh.state?this.CPj()?this.wWj(t,N):(""!==N&&(t+=N),this.NRb.start(t,this.Zk)):(m.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.qA.create().Zu(2,t,!1))}wWj(t,N){pf.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);const ha=this.Xmb.ZQd(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,!1,null,"SaveACopy",2);this.Xmb.$_d(ha).then(za=>{if(za&&0<za.length){const Ra=za[0][Kd.a.pxk];za=za[0][Kd.a.AAe];if(""!==Ra&&""!==za)this.b3a.K0(za,t+N,Ra,this.Zk),pf.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{this.qA.create().Zu(0,t,!1);const qb=yh.a.Fz();qb&&(qb.set("SiteUrlAvailable",""===Ra?"false":"true"),qb.set("FolderUrlAvailable",""===za?"false":
"true"));pf.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new Ug.a,{extendedProperties:qb}))}}else this.qA.create().Zu(0,t,!1),pf.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(za=>{"Canceled"===za?((za=yh.a.Fz())&&za.set("IsCanceled","true"),pf.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Ug.a,{extendedProperties:za}))):pf.Health.instance.recordKpiFailure("SaveACopySFP",
za,!1,!1,null)})}CPj(){return this.Xmb?this.Xmb.ece():(m.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)}qZk(t,N){if(N&&1===t){t=N.fileName;var ha=gb.a.WV(this.HE.Ix);N.moreLocationsSelected&&this.xel(t,ha);if(N.locationCallback){var za=N.locationCallback();za?za.properties&&"currentHost"===za.properties.ga("type")?this.hAa.K0(t+ha,!1,this.Zk):za.properties&&"SharePoint"===za.properties.ga("type")?(N=za.properties.ga("siteUrl"),za=za.properties.ga("folderUrl"),this.b3a.K0(za,
t+ha,N,this.Zk)):m.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):m.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else m.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}}}Object(h.a)(ui,"ReactSaveAsDialog",null,[969]);class Uh{constructor(t,N,ha,za,Ra,qb,Qb,vc=null,Zc=null,Wc=null){this.Ca=N;this.eb=t;this.gaa=za;this.hAa=qb;this.qA=Ra;this.Oh=ha;this.Bvf=Qb;this.DRh=vc;this.b3a=Zc;this.Xmb=Wc}create(t){return this.Oh&&this.Oh.jb.gC?new ui(this.Bvf,
this.qA,this.hAa,v.AFrameworkApplication.pu,this.Oh,this.DRh,this.b3a,this.Xmb,t):new Sd(this.eb,this.Ca,this.Oh,this.gaa,this.qA,this.hAa,this.Bvf,t)}}Object(h.a)(Uh,"FileNameDialogFactory",null,[942]);class Yi{constructor(t,N,ha,za){this.Xn=this.Jga=null;this.w0a=t;this.Oh=ha;this.uUh=za;this.mga=new yc.a(()=>new Ph.a(N.value,Object(r.a)(this,this.LCa,"getMoreInfoEventReceived")))}get PDb(){this.Jga||(this.mga.value.ica("Save As",!0),this.Xn&&this.Xn.VQ&&this.Xn.VQ.length&&(this.Jga=this.O1d(this.Xn.VQ)));
return this.Jga}start(t){if(!this.PDb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.Jga=v.AFrameworkApplication.breadcrumbFolderUrl;else return m.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Xn),!1;const N=this.uUh();N.rOe();const ha=N.h2d();if(!ha)return m.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),
!1;this.w0a.start((za,Ra)=>{N.hide();t(za,Ra)},()=>{this.Nwe(N)},ha,this.Jga);return!0}Nwe(t){t.hide();m.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")}O1d(t){t=t.toLowerCase();t.endsWith("/")||(t+="/");const N=t.indexOf("/documents/");return-1!==N?t.substring(0,N+1)+"_layouts/15/onedrive.aspx":""}LCa(t){this.Xn||3!==t.state||(this.Xn=t)}}Object(h.a)(Yi,"OneDriveFilePickerHelper",null,[943]);class lh extends ad.a{constructor(){super()}rOe(){this.hsc="FilePickerDialog";
this.mg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.ng="PickerDialog-MsoSp";this.showDialog("",null)}h2d(){return document.getElementById("FilePickerDiv")}QF(){}Ema(){}}Object(h.a)(lh,"PickerDialog",ad.a,[941]);var jg=d(479);class cj{constructor(t,N,ha,za,Ra,qb,Qb){this.eb=t;this.eud=ha;this.Ca=N;this.NRb=za;this.w0a=Ra;this.yAd=qb;this.FKh=Qb}ub(){const t=this.w0a.Gtb();t?Mc.a.Vw||this.eb.ka("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.Ca.pa(F.a.hgb,D.a.frame,Object(r.a)(this,
this.rkh,"saveToSharePointActionDispatcher"),64):(t.BEa.continueWith(N=>{N.hm&&this.w0a.Txe(N)}),this.PDc()):m.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")}PDc(){Fc.a.ied(Object(r.a)(this,this.rkh,"saveToSharePointActionDispatcher"));Fc.a.JZb([new jg.a(F.a.hgb,D.a.frame,0)],this.w0a.Gtb())}get cxb(){return this.eb.ka("SaveToAnotherFolderBrsIsEnabled")}get ONf(){return this.eb.ka("UserCanWriteRelative")}rkh(t,N,ha,za,Ra){return N.contextId!==D.a.frame||
t!==F.a.hgb?2:this.cxb&&(this.yAd.PDb||this.ONf)?1===ha?A.SessionStatusManager.instance.gja||v.AFrameworkApplication.hQ?8:this.FKh()?32:8:2===ha?(m.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(Ra&&Ra.SaveEntryPoint&&"VersionHistory"===Ra.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.ONf?(m.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.eud.create(Ra).nia(null)):(m.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),
this.NRb.start(null,Ra)),32):8:8}}Object(h.a)(cj,"SaveToSharePointActor",null,[]);class oj{constructor(t,N,ha,za){this.Zk=this.ehf=null;this.b3a=t;this.qA=N;this.yAd=ha;this.Oh=za}start(t,N){m.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.ehf=t;this.Zk=N;this.yAd.start((ha,za)=>{this.VEb(ha,za)})||this.sOe()}VEb(t,N){if(t)this.onSuccess(N);else this.hz(N)}sOe(){1!==this.Oh.state&&this.qA().IBa(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}onSuccess(t){m.ULS.sendTraceTag(23881886,
216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(t&&t.data&&t.data.value&&t.data.value.length&&t.data.value[0].sharePoint){const N=t.data.value[0].sharePoint.url;t=t.data.value[0].sharePoint.listUrl;let ha=null;if(N&&(ha=t?this.ofj(t):this.nfj(N))){this.b3a.K0(N,this.ehf,ha,this.Zk);return}m.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!N,!ha)}m.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");
this.sOe()}nfj(t){t.endsWith("/")||(t+="/");let N=0;for(let ha=0;ha<t.length;ha++)if("/"===t.charAt(ha)&&5===++N)return t.substr(0,ha);return null}ofj(t){t.endsWith("/")&&(t=t.substring(0,t.length-1));const N=t.lastIndexOf("/");return-1!==N?t.substring(0,N):null}hz(t){m.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");t&&t.error?m.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",t.error.errorCode,t.error.message):m.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.sOe()}}Object(h.a)(oj,"SaveToSharePointManager",null,[940]);class hk{constructor(t,N,ha,za,Ra,qb,Qb,vc){this.Waa=t;this.WJ=N;this.Ykb=za;this.TBd=qb;this.Eoa=ha;this.MXh=Ra;this.aza=Qb;this.Zk=vc}execute(t,N){if(!v.AFrameworkApplication.Vg&&v.AFrameworkApplication.Ge){var ha=this.Waa+this.aza;ha=jb.a.Ri(ha,"fu",gb.a.Qe(this.Eoa));ha=jb.a.Ri(ha,"su",gb.a.Qe(this.MXh));ha=jb.a.Ri(ha,"fn",gb.a.Qe(this.WJ));ha=jb.a.Ri(ha,"n",gb.a.Qe((new Date).getTime().toString()));
this.Zk&&this.Zk.FileDownloadUrl&&(ha=jb.a.Ri(ha,"furl",gb.a.Qe(this.Zk.FileDownloadUrl)));ha=ha+"&"+this.TBd;this.Ykb&&this.Ykb.length?ha=jb.a.Ri(ha,"fnn",gb.a.Qe(this.Ykb)):m.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");m.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");v.AFrameworkApplication.Ge.yj(ha,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,t,N,null,void 0,void 0,void 0,void 0,"9")}}}Object(h.a)(hk,"SharePointSaveAsCaller",
null,[968]);class Vh{constructor(t){this.Lpa=t.appSettings.SaveAsToHostWebServiceBase;this.WJ=t.appSettings.FileName;this.aza=t.Ga("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}create(t,N,ha,za){return new hk(this.Lpa,this.WJ,t,N,ha,v.AFrameworkApplication.hh,this.aza,za)}}Object(h.a)(Vh,"SharePointUploadCallerFactory",null,[939]);var Ji=d(489);class Bi{constructor(t,N,ha,za,Ra){this.Bn=this.$Lb=null;this.pqd=!1;this.fDd=this.Eoa=null;this.oGd=N;this.epa=ha;this.qA=za;this.Oh=Ra;this.Ca=
t}K0(t,N,ha,za){this.pqd=!1;m.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.omc();this.Eoa=t;za&&za.SaveEntryPoint&&(this.fDd=za.SaveEntryPoint);this.$Lb=this.oGd.create(t,N,ha,za);za&&"true"===za.SkipSaveToHost?this.C2():this.CWi()}CWi(){const t=()=>{m.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.C2()};32!==this.Ca.La(F.a.eYa,2,[()=>{m.ULS.sendTraceTag(23881922,
216,50,"Call the force save file change successfully.");this.C2()},t])&&t()}C2(){m.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.$Lb.execute(Object(r.a)(this,this.$pk,"onSaveToSharePointUploadFinished"),Object(r.a)(this,this.Zpk,"onSaveToSharePointUploadFailed"))}$pk(t){if(t&&t.data&&t.data.Sd){var N;if(({ou:N}=Ed.d(t.data.Sd)).returnValue)if(N.StatusCode!==Jd.a.py&&N.StatusCode!==Jd.a.WXb)m.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
t.data.status,N.StatusCode),N.StatusCode!==Jd.a.lhh&&this.XZf(t.data.status)||(this.Fwa(N.StatusCode.toString()),this.zdl(N.StatusCode));else{m.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.cHe();try{N.NewDocumentUrl?this.pfb(N.NewDocumentUrl):this.qfb()}catch(ha){m.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",ha.toString())}}else m.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ie.a.woc(t.data.Sd)}),
this.CIc()||(this.Fwa("Failed to deserialize response"),this.mmc())}else m.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.CIc()||(this.Fwa("Unknown"),this.mmc())}Zpk(t){t&&t.data?this.XZf(t.data.status)||(m.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Fwa(Ji.a[t.data.status]),this.mmc()):(m.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.CIc()||(this.Fwa("Unknown"),this.mmc()))}CIc(){if(!this.pqd)return m.ULS.sendTraceTag(23881930,
216,10,"Upload fail. Retrying."),this.pqd=!0,this.C2(),!0;m.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}XZf(t){m.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",t);return this.CIc()}qfb(){m.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");gd.a.an(this.Eoa,gd.a.Z$(3),void 0,"UploadToSharePointManager.RedirectToFolder")}pfb(t){let N=!1,ha=!1;v.AFrameworkApplication.fa&&(N=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),
ha=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));m.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",t,N);if(N&&ha){m.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const za={};za[Kd.a.sFb]="1";za[Kd.a.documentUrl]=t;za[Kd.a.reason]=Zf.a.GIe;v.AFrameworkApplication.ES().execute(Ra=>{Ra.sendMessage(Yd.a.KBa,za)})}else gd.a.an(t,gd.a.Z$(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")}omc(){this.Oh&&
1===this.Oh.state||(this.Bn=this.epa(),this.Bn.message=CommonUIStrings.l_CommentProgressTooltip,this.Bn.yd=5,this.Bn.qr=!1,this.Bn.wna(CommonUIStrings.l_DefaultDialogTitle,null,null))}u5a(){this.Bn&&(this.Bn.close(),this.Bn=null)}mmc(){this.it(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)}Bel(){this.it(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)}Gdl(){const t=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);
this.it(CommonUIStrings.l_SaveAsFileTooLargeTitle,t,Nd.a.rZk)}it(t,N,ha=Nd.a.vZk){m.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",t,N);this.u5a();1!==this.Oh.state&&this.qA().CZf(t,N,ha)}zdl(t){m.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",t);switch(t){case Jd.a.PBh:this.Bel();break;case Jd.a.lhh:this.Gdl();break;default:this.mmc()}}cHe(){"VersionHistory"===this.fDd&&this.Ca.processAction(F.a.jfd,2)}Fwa(t){"VersionHistory"===this.fDd&&this.Ca.La(F.a.dHe,
2,{["FailureReason"]:t})}}Object(h.a)(Bi,"UploadToSharePointManager",null,[938]);class Eh{constructor(){this.Dyc=this.Czd=this.wzd=this.Da=null}get name(){return"Common.App.SaveToSharePoint"}init(){}dispose(){}Wb(t){this.Da=t;this.wzd=rg.a.Ju(t.Ka("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.Czd=rg.a.Ju(t.Ka("Common.IEventEmitter<Common.IMruResult>"));this.Dyc=rg.a.Ju(t.Ka("Common.App.SharedFilePicker.ISharedFilePicker"));Tf.Task.WAA.call(null,this.wzd,this.Czd,this.Dyc).continueWith(()=>
{this.sMk()})}sMk(){this.Da.register(Vh,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").na(()=>new Vh(v.AFrameworkApplication.fa)).ma();this.Da.register(Bi,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").na(()=>new Bi(v.AFrameworkApplication.Ta,this.Da.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),()=>(new lc.a).create(),()=>new Ud,
v.AFrameworkApplication.Aa)).ma();this.Da.register(oj,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").na(()=>new oj(this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),()=>new Ud,this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),v.AFrameworkApplication.Aa)).ma();this.Da.register(Yi,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").na(()=>
new Yi(this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new yc.a(()=>this.wzd.result),v.AFrameworkApplication.Aa,()=>new lh)).ma();this.Da.register(Uh,"Common.App.SaveToSharePoint.FileNameDialogFactory").na(()=>new Uh(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.jb,this.Da.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),this.Da.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),
new yc.a(()=>this.Czd.result),this.Da.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),this.Dyc?this.Dyc.result:null)).ma();this.Da.register(cj,"Common.App.SaveToSharePoint.SaveToSharePointActor").na(()=>new cj(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ta,this.Da.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),this.Da.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),this.Da.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),
this.Da.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),()=>v.AFrameworkApplication.Aa.ZDc)).ma();v.AFrameworkApplication.fa.ka("SaveToAnotherFolderBrsIsEnabled")&&this.Da.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").ub()}static main(){e.a.instance.Bc(new Eh)}}Object(h.a)(Eh,"PackageManager",null,[2,3]);class rh extends Ma.StandardDialog{constructor(){super();this.yd=0;this.Ue(1,CommonUIStrings.l_DialogClose)}Zu(t){this.jy(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)}}Object(h.a)(rh,"ErrorDialog",Ma.StandardDialog,[948]);class sg{}sg.default=0;Object(h.a)(sg,"SaveToCloudErrorCodes",null,[]);class ci{constructor(t,N,ha,za,Ra,qb){this.Zk=null;this.EXh=t;this.Oaa=N;this.eTb=ha;this.eb=za;this.Kjb=Ra;this.qA=qb}start(t){this.Zk=t;if("SharePointOnlineConsumer"===this.eb.Ga("FileSource")){const N=u.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(N){N.start(null,t);return}}this.Oaa.T9d?(m.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),
this.zki()):(m.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.kfl())}kfl(){this.EXh.create().nia()}it(){this.qA().Zu(sg.default)}zki(){try{m.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");let t={["client_id"]:this.eb.appSettings.UploadToSkyDriveClientId,["env"]:"INT"};if(1===this.Kjb||2===this.Kjb)t={["client_id"]:this.eb.appSettings.UploadToSkyDriveClientId};WL.init(t);m.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");
WL.fileDialog({["mode"]:"save",["lightbox"]:"grey"}).then(Object(r.a)(this,this.onSuccess,"onSuccess"),Object(r.a)(this,this.hz,"onFailure"))}catch(t){m.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",t,t.stack),this.it()}}onSuccess(t){m.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");t&&t.data&&t.data.folders&&this.eTb.K0(t.data.folders[0].id,t.data.folders[0].urls.viewInBrowser,null,this.Zk)}hz(t){if(t&&
t.error){if("user_canceled"===t.error.code){m.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}m.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else m.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.it()}}Object(h.a)(ci,"SaveToCloudManager",null,[946]);class dj{constructor(t,N,ha,za){this.Wxc=null;this.qWh=t;this.eb=ha;this.jif=N;this.hff=new fg.a;this.Vh=
za}cxb(){return this.eb.ka("SaveToCloudStorageUIIsEnabled")}v8f(){return F.a.PIe}PDc(){Fc.a.ied(Object(r.a)(this,this.okh,"saveToCloudActionDispatcher"));Fc.a.JZb([new jg.a(F.a.PIe,D.a.frame,0)],this.jif.Gtb())}ub(){const t=this.jif.Gtb();t?(t.ZR(()=>{this.hff.Dg(!0)}),this.PDc()):m.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")}Dch(){m.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")}okh(t,N,ha,za,Ra){return N.contextId!==
D.a.frame||t!==this.v8f()?2:this.cxb()?1===ha?A.SessionStatusManager.instance.gja||v.AFrameworkApplication.hQ?8:32:2===ha?(this.Dch(),Ra&&Ra.FileDownloadUrl&&m.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Vh&&(this.Wxc=this.Vh.zi("DialogShown","SaveToOneDriveReponseTime")),this.hff.task.continueWith(()=>{this.Wxc&&(this.Wxc.stop(),this.Wxc=null);this.qWh.start(Ra)}),32):8:8}}Object(h.a)(dj,"SaveToCloudStorageActor",null,[945]);var Zi=d(217);class Ri extends Ma.StandardDialog{constructor(t,
N,ha){super();this.Ca=t;this.Oaa=N;this.gaa=ha;this.cV=!1;this.yd=1;this.Zwa(1);this.Ue(1,CommonUIStrings.l_SignIn);this.Ue(0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}nia(){this.Oaa.GEf(Object(r.a)(this,this.u2g,"onSignIn"));this.nx(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(r.a)(this,this.nBj,"inputHandler"))}nBj(t){0===t?(m.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.Pad()}Nmi(){let t="2";if(this.gaa)switch(this.gaa.rm){case 3:t=
"0";break;case 2:t="3";break;case 1:t="1"}return t}hide(){this.Oaa.YQk(Object(r.a)(this,this.u2g,"onSignIn"));super.hide()}Pad(){var t=v.AFrameworkApplication.fa.ka("SignInAspxInWebAppsPortalIsEnabled")?"/start/signin.aspx":"Signin.aspx";t=new Zi.QueryStringBuilder(t);t.Ti("prompt","1");t.Ti("cbcxt",this.Nmi());v.AFrameworkApplication.BNa(t);gd.a.an(t.toString(),"LoginWindow",void 0,"SignInDialog")}u2g(){this.iQ&&this.hide();m.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");
this.Ca.processAction(F.a.PIe,2)}}Object(h.a)(Ri,"SignInDialog",Ma.StandardDialog,[970]);class Fh{constructor(t,N,ha){this.Ca=t;this.Oaa=N;this.gaa=ha}create(){return new Ri(this.Ca,this.Oaa,this.gaa)}}Object(h.a)(Fh,"SignInDialogFactory",null,[950]);class Rj{constructor(t,N,ha,za,Ra,qb,Qb){this.Waa=t;this.WJ=N;this.Ykb=ha;this.mtc=za;this.TBd=Ra;this.aza=qb;this.Zk=Qb}execute(t,N){if(!v.AFrameworkApplication.Vg&&v.AFrameworkApplication.Ge){var ha=this.Waa+this.aza;ha=jb.a.Ri(ha,"fo",gb.a.Qe(this.mtc));
ha=jb.a.Ri(ha,"fn",gb.a.Qe(this.WJ));ha=jb.a.Ri(ha,"qs",gb.a.Qe(this.TBd));ha=jb.a.Ri(ha,"n",gb.a.Qe((new Date).getTime().toString()));this.Zk&&this.Zk.FileDownloadUrl&&(ha=jb.a.Ri(ha,"furl",gb.a.Qe(this.Zk.FileDownloadUrl)));this.Ykb&&(ha=jb.a.Ri(ha,"fnn",gb.a.Qe(this.Ykb)));v.AFrameworkApplication.Ge.yj(ha,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,t,N,null)}}}Object(h.a)(Rj,"SkyDriveUploadCaller",null,[967]);class mh{constructor(t){this.eb=t;this.Lpa=t.appSettings.SkyDriveUploadWebServiceBase;
this.WJ=t.appSettings.FileName;this.aza=t.Ga("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}create(t,N,ha){return new Rj(this.Lpa,this.WJ,N,t,v.AFrameworkApplication.hh,this.aza,ha)}}Object(h.a)(mh,"SkydriveUploadCallerFactory",null,[949]);class va{constructor(t,N,ha,za,Ra){this.Eoa=this.Bn=this.$Lb=null;this.t1=!1;this.Zk=this.gAa=null;this.oGd=t;this.epa=N;this.qA=ha;this.Oh=za;this.Vh=Ra}omc(){this.Oh&&1===this.Oh.state||(this.Bn=this.epa(),this.Bn.message=CommonUIStrings.l_CommentProgressTooltip,
this.Bn.yd=5,this.Bn.qr=!1,this.Bn.wna(CommonUIStrings.l_DefaultDialogTitle,null,null))}u5a(){this.Bn&&(this.Bn.close(),this.Bn=null)}iY(){1!==v.AFrameworkApplication.Aa.state&&this.qA().Zu(sg.default)}qfb(){m.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");gd.a.an(this.Eoa,gd.a.Z$(3),void 0,"UploadToCloudManager.RedirectToFolder")}pfb(t){let N=!1,ha=!1;v.AFrameworkApplication.fa&&(N=v.AFrameworkApplication.fa.ka("SaveACopyIsEnabledForUiHost"),ha=v.AFrameworkApplication.fa.ka("UiHostSupportsDocRebootFeatures"));
m.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",t,N);if(N&&ha){m.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");const za={};za[Kd.a.sFb]="1";za[Kd.a.documentUrl]=t;v.AFrameworkApplication.ES().execute(Ra=>{Ra.sendMessage(Yd.a.KBa,za)})}else gd.a.an(t,gd.a.Z$(3),void 0,"UploadToCloudManager.RedirectToEditUrl")}K0(t,N,ha=null,za=null){m.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");
this.Vh&&(this.gAa=this.Vh.zi("DialogShown","SaveToOneDriveUploadTime"));this.omc();this.Eoa=N;this.$Lb=this.oGd.create(t,ha,za);this.Zk=za;this.C2()}C2(){m.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.$Lb.execute(Object(r.a)(this,this.Ypk,"onSaveToCloudUploadFinished"),Object(r.a)(this,this.Xpk,"onSaveToCloudUploadFailed"))}Ypk(t){this.u5a();this.t1=!1;if(t&&t.data&&t.data.Sd){var N;if(({ou:N}=Ed.d(t.data.Sd)).returnValue)if(t=N,t.StatusCode!==Jd.a.py&&t.StatusCode!==Jd.a.WXb)m.ULS.sendTraceTag(6590602,
216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.iY();else{m.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{t.NewDocumentUrl&&""!==t.NewDocumentUrl?this.pfb(t.NewDocumentUrl):this.qfb()}catch(ha){m.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",ha.toString())}this.ggc()}else m.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",{["ResponseData"]:Ie.a.woc(t.data.Sd)}),this.iY()}else m.ULS.sendTraceTag(6590601,
216,10,"UploadToCloudManager upload failure. Response data is null"),this.iY()}Xpk(t){5!==t.data.status&&12!==t.data.status||this.t1?(m.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",t.data.status),this.u5a(),this.iY(),this.ggc()):(m.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.t1=!0,this.C2())}ggc(){this.gAa&&(this.gAa.stop(),this.gAa=null)}}Object(h.a)(va,"UploadToCloudManager",null,[947]);class Qa{constructor(){this.Da=null}get name(){return"Common.App.SaveToCloudStorage"}init(){v.AFrameworkApplication.fa.ka("SaveToCloudStorageUIIsEnabled")&&
this.Da.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").ub()}dispose(){}Wb(t){this.Da=t;this.Da.register(Fh,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").na(()=>new Fh(v.AFrameworkApplication.Ta,nf.a.instance,v.AFrameworkApplication.Aa.jb)).ma();this.Da.register(mh,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").na(()=>new mh(v.AFrameworkApplication.fa)).ma();
this.Da.register(dj,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").na(()=>new dj(t.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),t.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Aa.EU)).ma();this.Da.register(va,"Common.App.SaveToCloudStorage.UploadToCloudManager").na(()=>new va(t.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new lc.a).create(),()=>new rh,v.AFrameworkApplication.Aa,
v.AFrameworkApplication.Aa.EU)).ma();this.Da.register(ci,"Common.App.SaveToCloudStorage.SaveToCloudManager").na(()=>new ci(t.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),nf.a.instance,t.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.RPa,()=>new rh)).ma()}static main(){e.a.instance.Bc(new Qa)}}Object(h.a)(Qa,"PackageManager",null,[2,3]);class db{static get mg(){return ad.a.UB(db.fo,CommonUIStrings.l_SaveACopyFileName)}}
db.fo="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(h.a)(db,"FileNameDialogHtml",null,[]);class Gb extends ad.a{constructor(t,N,ha,za){super();this.mtc=this.Eoa=null;this.Ca=t;this.gaa=N;this.eTb=ha;this.Ue(1,
CommonUIStrings.l_SaveButtonLabel);this.mg=db.mg;this.ng="FileNameDialog-SaveACopy";this.Zk=za}nia(t,N,ha){this.mtc=t;this.Eoa=ha;t={["txtFileName"]:gb.a.yG(v.AFrameworkApplication.pu.Ix),["lblFolderName"]:String.format(CommonUIStrings.l_DestinationFolder,N)};this.tj(CommonUIStrings.l_SaveToOneDrive,Object(r.a)(this,this.AKc,"fileNameDialogHandler"),t);m.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()}AKc(t,N){1!==t?
m.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(t=N.txtFileName.trim(),m.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),N=gb.a.WV(v.AFrameworkApplication.fileName),t&&""!==t&&""!==N&&(t+=N),this.eTb.K0(this.mtc,this.Eoa,t,this.Zk))}}Object(h.a)(Gb,"FileNameDialog",ad.a,[971]);class jc{constructor(t,N,ha){this.Ca=t;this.gaa=N;this.eTb=ha}create(t){return new Gb(this.Ca,this.gaa,this.eTb,t)}}Object(h.a)(jc,"FileNameDialogFactory",
null,[952]);class Ac extends Ma.StandardDialog{constructor(t){super();this.yd=1;this.Ue(1,CommonUIStrings.l_RetryButtonLabel);this.Ue(0,CommonUIStrings.l_DialogClose);this.Ca=t}Zu(t){m.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",t);this.jy(t,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(r.a)(this,this.THe,"retryDialogHandler"))}THe(t){1===t?(m.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.Ca.processAction(F.a.ukc,2)):
m.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")}}Object(h.a)(Ac,"RetryDialog",Ma.StandardDialog,[948]);class W extends dj{constructor(t,N,ha,za){super(t,N,ha,za);this.ETh=N}cxb(){return this.eb.ka("SaveACopyBrsIsEnabled")}v8f(){return F.a.ukc}PDc(){Fc.a.ied(Object(r.a)(this,this.okh,"saveToCloudActionDispatcher"));Fc.a.JZb([new jg.a(F.a.ukc,D.a.frame,0)],this.ETh.Gtb())}Dch(){v.AFrameworkApplication.qta("CreateCopy_cf;CreateCopy_tf");m.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")}}
Object(h.a)(W,"SaveACopyActor",dj,[]);class xa extends ci{constructor(t,N,ha,za,Ra,qb,Qb){super(N,ha,za,Ra,qb,Qb);this.INh=t}onSuccess(t){t&&t.data&&t.data.folders?(m.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.INh.create(this.Zk).nia(t.data.folders[0].id,t.data.folders[0].name,t.data.folders[0].urls.viewInBrowser)):(m.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.it())}hz(t){t&&t.error&&"user_canceled"===t.error.code&&m.ULS.sendTraceTag(7205457,
216,50,"User cancelled upload to their OneDrive in Save A Copy.");super.hz(t)}it(){m.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");super.it()}}Object(h.a)(xa,"SaveACopyManager",ci,[]);class da extends va{constructor(t,N,ha,za,Ra,qb){super(N,ha,za,Ra,qb);this.Ca=t}Ube(){return!!this.Zk&&!!this.Zk.SaveEntryPoint&&"VersionHistory"===this.Zk.SaveEntryPoint.toString()}iY(){m.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");this.Ube()&&this.Ca.La(F.a.dHe,2,{["FailureReason"]:"Unknown"});
super.iY()}qfb(){m.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Ube()&&this.Ca.processAction(F.a.jfd,2);super.qfb()}pfb(t){m.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",t);this.Ube()&&this.Ca.processAction(F.a.jfd,2);super.pfb(t)}C2(){this.Zk&&"true"===this.Zk.SkipSaveToHost?super.C2():32!==this.Ca.processAction(F.a.eYa,1)?(m.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),
super.C2()):this.Ca.La(F.a.eYa,2,[()=>{m.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");va.prototype.C2.call(this)},()=>{m.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");this.iY()}])}}Object(h.a)(da,"SaveACopyUploadToCloudManager",va,[]);class Fa{constructor(){this.Da=null}get name(){return"Common.App.SaveACopy"}init(){v.AFrameworkApplication.fa.ff(Object(r.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){v.AFrameworkApplication.fa.ka("SaveACopyBrsIsEnabled")&&
this.Da.resolve("Common.App.SaveACopy.SaveACopyActor").ub()}dispose(){}Wb(t){this.Da=t;this.Da.register(da,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").na(()=>new da(v.AFrameworkApplication.Ta,t.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),()=>(new lc.a).create(),()=>new Ac(v.AFrameworkApplication.Ta),v.AFrameworkApplication.Aa,v.AFrameworkApplication.Aa.EU)).ma();this.Da.register(jc,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").na(()=>
new jc(v.AFrameworkApplication.Ta,v.AFrameworkApplication.Aa.jb,t.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))).ma();this.Da.register(W,"Common.App.SaveACopy.SaveACopyActor").na(()=>new W(t.resolve("Common.App.SaveACopy.SaveACopyManager"),t.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.Aa.EU)).ma();this.Da.register(xa,"Common.App.SaveACopy.SaveACopyManager").na(()=>new xa(t.resolve("Common.App.SaveACopy.FileNameDialogFactory"),
t.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),nf.a.instance,t.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),v.AFrameworkApplication.fa,v.AFrameworkApplication.RPa,()=>new Ac(v.AFrameworkApplication.Ta))).ma()}static main(){e.a.instance.Bc(new Fa)}}Object(h.a)(Fa,"PackageManager",null,[2,3]);var Ua=d(364);class cb{constructor(t){this.qMg=null;m.ULS.sendTraceTag(527574681,306,50,"PhoneLinkManager - Initialize");this.fbc=v.AFrameworkApplication.fa.Ga("PhoneLinkServiceEndpoint");
(this.wL=t)||m.ULS.sendTraceTag(527574720,306,10,"PhoneLinkManager - OAuthManager is null");this.fbc&&this.fbc.length||m.ULS.sendTraceTag(527574721,306,10,"PhoneLinkManager - Missing service endpoint")}wSi(t){t&&(this.fbc="https://dcg-df.microsoft.com/",m.ULS.sendTraceTag(526697302,306,50,"PhoneLinkManager::FetchPhoneLinkData override endpoint to dogfood"));this.vSi()}vSi(){m.ULS.sendTraceTag(527214155,306,50,"PhoneLinkManager::FetchPhoneLinkData...");if(864E5>=+new Date-+this.qMg)m.ULS.sendTraceTag(527574722,
306,10,"PhoneLinkManager::FetchPhoneLinkData - Can't get more than 1 time within 1 day");else{this.qMg=new Date;var t=new Date;this.wL.KU("BayBridge",this.fbc).then(N=>{const ha=+new Date-+t;N.IsSuccess?(m.ULS.sendTraceTag(527574723,306,50,"PhoneLinkManager::FetchPhoneLinkData Phone Link Authentication Latency: {0}",ha),this.pSi(N.Token,this.k_i())):m.ULS.sendTraceTag(527574724,306,15,"PhoneLinkManager::FetchPhoneLinkData Failed to get AAD token with error, authDuration: {0}, ErrorCode: {1}, ErrorMessage: {2}",
ha,N.ErrorCode,N.ErrorMessage)}).catch(N=>{m.ULS.sendTraceTag(527574725,306,15,"PhoneLinkManager::FetchPhoneLinkData - Token retrival failed: {0}, Latency: {1}",N,+new Date-+t)})}}pSi(t,N){const ha={};ha.Authorization="Bearer "+t;ha["Authorization-Type"]="AAD";ha.Accept="application/json";ha["DCG-SessionId"]=v.AFrameworkApplication.userSessionId;v.AFrameworkApplication.Ge.yj(N,1,null,ha,!1,2,Object(r.a)(this,this.kgj,"getStatusSucceeded"),Object(r.a)(this,this.igj,"getStatusFailed"),null,void 0,void 0,
void 0,void 0,"39");Hb.a("FetchAccountLinkedStatus")}p0i(){const t=Ua.a.instance.getItem("AccountLinkedStatusCache");return t&&t.length?"true"===t.toLowerCase()?!0:!1:!1}k_i(){return this.fbc+"DeviceAuthProxy/IsAccountLinked?api-version=1.0.0"}igj(){m.ULS.sendTraceTag(527214156,306,15,"PhoneLinkManager FetchAccountLinkedStatus request failed")}kgj(t){m.ULS.sendTraceTag(527214157,352,50,"GetStatusSucceeded FetchAccountLinkedStatus request was successful");t=Ed.a(t.data.Sd).state+"";Ua.a.instance.setItem("AccountLinkedStatusCache",
t)}}Object(h.a)(cb,"PhoneLinkManager",null,[721]);class Jb{constructor(){this.Da=null}get name(){return"Common.App.PhoneLink"}Wb(t){this.Da=t;this.Da.register(721,"Common.App.PhoneLink.IPhoneLinkManager").ma().na(()=>new cb(this.Da.resolve("Common.App.OAuth.IOAuthManager")))}init(){v.AFrameworkApplication.fa.ff(()=>{this.rDa()})}rDa(){this.Da.resolve("Common.App.PhoneLink.IPhoneLinkManager")}dispose(){}static main(){e.a.instance.Bc(new Jb)}}Object(h.a)(Jb,"PhoneLinkPackage",null,[2,3]);var Gc;(function(t){t[t.myFiles=
0]="myFiles";t[t.recent=1]="recent";t[t.currentFolder=2]="currentFolder";t[t.yourPhone=3]="yourPhone"})(Gc||(Gc={}));Object(h.b)("SharedFilePickerLandingLocation",Gc);class pd{constructor(t){this.j8a=this.ZEb=null;this._initialized=!1;this.V6d=t}HVd(t){this._initialized||(t.fu(Yd.a.qch),t.kB(Yd.a.qch,Object(r.a)(this,this.vpk,"onReceivedPickerResponse")),this._initialized=!0)}$_d(t){return this.j8a=new Promise((N,ha)=>{const za={};za[Kd.a.oxk]=t;this.ZEb=(Ra,qb)=>{""===qb?(m.ULS.sendTraceTag(572548163,
306,50,"Resolving Promise with Picker Data"),N(Ra)):("Canceled"===qb?m.ULS.sendTraceTag(572548164,306,50,qb):m.ULS.sendTraceTag(556901065,306,10,qb),ha(qb))};this.V6d.execute(Ra=>{this.HVd(Ra);Ra.sendMessage(Yd.a.Vsk,za)})})}vpk(t){this.ZEb(t.Values[Kd.a.p0k],void 0===t.Values[Kd.a.tAe]||null===t.Values[Kd.a.tAe]?"":t.Values[Kd.a.tAe])}ece(){return v.AFrameworkApplication.fa.ka("UiHostCommonFilePicker")}ZQd(t,N,ha,za,Ra,qb,Qb,vc,Zc=null){const Wc={};Wc[Kd.a.$_k]=t;Wc[Kd.a.titleText]=N;Wc[Kd.a.j$h]=
ha;Wc[Kd.a.k$h]=za;Wc[Kd.a.l$h]=Ra;Wc[Kd.a.iJi]=!0;Wc[Kd.a.RSi]=qb;Wc[Kd.a.rxk]=Qb;Wc[Kd.a.qxk]=Gc[vc];rb.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Wc[Kd.a.sxk]="Dark");Zc&&(null!=Zc.wob&&(Wc[Kd.a.wob]=Zc.wob),null!=Zc.avb&&(Wc[Kd.a.avb]=Zc.avb));return Wc}}Object(h.a)(pd,"SharedFilePickerManager",null,[734]);class Ld{constructor(){this.Da=null}get name(){return"Common.App.SharedFilePicker"}Wb(t){this.Da=t;t.register(pd,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").ma().na(()=>
new pd(t.Ka("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa.ff(()=>{this.rDa()})}rDa(){this.Da.resolve("Common.App.SharedFilePicker.ISharedFilePicker")}dispose(){}static main(){e.a.instance.Bc(new Ld)}}Object(h.a)(Ld,"SharedFilePickerPackage",null,[2,3]);class de{constructor(t,N=3E4){this.dpl=9E5;this.hpl=1E4;this.PFg=this.nAb=null;this.zge=0;this.qYb=Date.now;this.yPc=t;this.pmd=N;this.eMc()}shg(t=!0){const N=this.qYb();if(N<this.zge+this.dpl)return N>this.zge+this.hpl&&this.eMc(),
this.PFg;t&&this.eMc();return null}getToken(t=!0){return(t=this.shg(t))?Promise.resolve(t):this.eMc()}eMc(){return this.nAb=this.nAb||new Promise(t=>{this.yPc().then(N=>{this.nAb=null;""!==N&&N&&(this.PFg=N,this.zge=this.qYb(),t(N));t(null)}).catch(()=>{this.nAb=null;t(null)});window.setTimeout(()=>{this.nAb=null;t(null)},this.pmd)})}}Object(h.a)(de,"OAuthCacheManager",null,[]);var Be=d(106),Mf=d(67);class Dg{static DZd(t){return""!==t&&t?Dg.K$h[t.toLowerCase()]:""}static mij(t,N){const ha=Date.now();
var za=Dg.LFc();const Ra=v.AFrameworkApplication.fa.Ga("UserPrincipalName"),qb=Dg.DZd(t);m.ULS.sendTraceTag(593862986,1300,50,"Begin SSO Request for app: "+t);if(""===Ra||!Ra)return m.ULS.sendTraceTag(593862985,1300,10,"Missing login hint for silent oAuth"),Promise.resolve("");if(""===qb||!qb)return m.ULS.sendTraceTag(593862984,1300,10,"Missing AAD appId for appName: "+t),Promise.resolve("");const Qb=Be.a.create().toString();za=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&login_hint={3}&redirect_uri={4}&state={5}&prompt=none",
"https://login.microsoftonline.com",qb,encodeURIComponent(N),encodeURIComponent(Ra),encodeURIComponent(za),Qb);const vc=document.createElement("iframe");vc.style.display="none";vc.setAttribute("sandbox","allow-forms allow-scripts allow-same-origin");vc.src=za;document.body.appendChild(vc);return new Promise(Zc=>{Dg.Jfk(vc.contentWindow).then(Wc=>{document.body.removeChild(vc);const Md=new Mf.a,Id=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let Xe;for(;Xe=Id.exec(Wc);)3!==Xe.length&&(m.ULS.sendTraceTag(593862983,
1300,10,"Unexpected Hash respones in OAuth header! Match length: {0}",Xe.length),Zc("")),Md.$(Xe[1],Xe[2]);Md.Jb("access_token")?(m.ULS.sendTraceTag(593862982,1300,50,"SSO Request successful for resource: {0} for app: {1} Latency: {2}",N,t,Date.now()-ha),Zc(Md.ga("access_token"))):(m.ULS.sendTraceTag(526668183,1300,10,"SSO Request failure for resource: {0} for app: {1}. Latency: {2}",N,t,(Date.now()-ha).toString()),Zc(""))}).catch(Wc=>{try{document.body.removeChild(vc)}catch(Md){}m.ULS.sendTraceTag(593862980,
1300,10,"SSO Request failure for resource: {0} for app: {1} Error: {2} Latency: {3}",N,t,JSON.stringify(Wc),(Date.now()-ha).toString());Zc("")})})}static LFc(){const t=window.location.protocol,N=window.location.host;var ha=v.AFrameworkApplication.fa.Ga("OAuthManagerHostPathOverride");if(void 0===ha||null===ha){ha=window.location.pathname;const za=ha.lastIndexOf("/");ha=0<=za?ha.substring(0,za+1):""}return t+"//"+N+ha+"WacOAuth.html"}static Jfk(t){return new Promise((N,ha)=>{let za=0,Ra=0;Ra=window.setInterval(()=>
{if(200<za++)window.clearInterval(Ra),ha("Exceeded 10000ms timeout after 200 polls");else{var qb=null,Qb=null;try{if(!t||t.closed){window.clearInterval(Ra);ha("Window or Frame is closed before completion");return}qb=t.location.href;Qb=t.location.hash}catch(vc){}qb&&"about:blank"!==qb&&Qb&&""!==Qb&&(window.clearInterval(Ra),N(Qb))}},50)})}}Dg.K$h={["smartlookup"]:"4d5c2d63-cf83-4365-853c-925fd1a64357",["search"]:"a9b49b65-0a12-430b-9540-c80b3332c127"};Object(h.a)(Dg,"OAuthHelper",null,[]);class yd{constructor(t,
N){this.token=t;this.source=N}}Object(h.a)(yd,"TokenResult",null,[]);class td{constructor(){this.wL=null;this.I3e={};this.PJb=new Le.a(af.a.Tq())}getToken(t,N,ha=!1){if(this.PJb.Jb(N))return this.PJb.ga(N).getToken();const za=new de(()=>ha?this.thg(t,N):this.yPc(t,N));this.PJb.$(N,za);return za.getToken()}kij(t,N,ha=!1){if(this.PJb.Jb(N))return this.PJb.ga(N).shg();const za=new de(()=>ha?this.thg(t,N):this.yPc(t,N));this.PJb.$(N,za);return null}yPc(t,N){const ha=Date.now();return Dg.mij(t,N).then(za=>
new yd(za,"SSOStack")).then(za=>new Promise(Ra=>{za.token&&""!==za.token?(m.ULS.sendTraceTag(593862979,1300,50,"{0}: SSO Token resolved from {1}. Latency: {2}",t,za.source,Date.now()-ha),this.qYa("GetTokenInternal",!0,Date.now()-ha,t,"","",N),Ra(za.token)):(m.ULS.sendTraceTag(593862978,1300,50,"{0}: SSO Token provider failed! Latency: {1}",t,Date.now()-ha),this.qYa("GetTokenInternal",!1,Date.now()-ha,t,"GetTokenSilent Failed","SSO Token provider failed!",N),Ra(""))}))}thg(t,N){if(!this.wL)try{this.wL=
u.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ha){m.ULS.sendTraceTag(51689675,1300,10,"Unable to resolve IOAuthManager: "+ha)}return this.wL?new Promise(ha=>{const za=Date.now();this.wL.KU(t,N).then(Ra=>{const qb=Ra.Token;!Ra.IsSuccess||this.nRj(qb)?(this.qYa("GetTokenInternalImplicitJS",!1,Date.now()-za,t,Ra.ErrorCode,Ra.ErrorMessage,N),ha(null)):(this.qYa("GetTokenInternalImplicitJS",!0,Date.now()-za,t,Ra.ErrorCode,Ra.ErrorMessage,N),ha(qb))}).catch(Ra=>{Ra=Ra?Ed.c(Ra):"";this.qYa("GetTokenInternalImplicitJS",
!1,Date.now()-za,t,"Caught Exception",Ra,N);ha(null)})}):new Promise(ha=>{this.qYa("GetTokenInternalImplicitJS",!1,0,t,"Null OAuthManager","OAuthManager not set");ha(null)})}qYa(t,N,ha,za,Ra="",qb="",Qb=""){var vc="Search"===za;const Zc=[];t=Wi.a.F7(vc?"Event":"EventName",t,2);za=Wi.a.F7("AppName",za,2);Array.add(Zc,t);Array.add(Zc,za);vc&&(za=Wi.a.F7("LatencyType","FetchToken",2),Array.add(Zc,za));Ra&&""!==Ra&&(Ra=Wi.a.F7("ErrorCode",Ra,2),Array.add(Zc,Ra));qb&&""!==qb&&(qb=Wi.a.F7("ErrorMessage",
qb,2),Array.add(Zc,qb));Qb&&""!==Qb&&(qb=!(Qb in this.I3e),this.I3e[Qb]=qb,qb=Wi.a.F7("WarmUpCall",qb.toString(),1),Array.add(Zc,qb),Qb=Wi.a.F7("Service",this.XOc(Qb),2),Array.add(Zc,Qb));vc=vc?"Office.TellMe.TellMeWAC.Latency":"Office.Insights.SmartLookup.Authentication";N=Object.assign(new Tg.a,{name:vc,samplingPolicy:2,dataFields:Zc,succeeded:N,durationMs:ha});w.a.sendActivityEvent(N)}XOc(t){return t===v.AFrameworkApplication.gfe?"Loki":t===v.AFrameworkApplication.uQe?"Substrate":v.AFrameworkApplication.fa&&
t===v.AFrameworkApplication.fa.Ga("SmartLookupShredderServiceEndpoint")?"Shredder":"Other"}nRj(t){return!t||!t.length}}Object(h.a)(td,"SearchOAuthManager",null,[715]);class id{constructor(){this.Da=null}get name(){return"Common.App.SearchOAuthManager"}Wb(t){this.Da=t;this.Da.register(715,"Common.App.SearchCommon.ISearchOAuthManager").ma().na(()=>new td)}init(){}dispose(){}static main(){e.a.instance.Bc(new id)}}Object(h.a)(id,"SearchOAuthPackage",null,[2,3]);var ed;(function(t){t[t.generalException=
0]="generalException";t[t.invalidArgument=1]="invalidArgument";t[t.notAllowed=2]="notAllowed";t[t.apiNotAvailable=3]="apiNotAvailable";t[t.unresolvedPendingRequest=4]="unresolvedPendingRequest";t[t.timeout=5]="timeout";t[t.adalTimeout=6]="adalTimeout";t[t.userNotSignedIn=7]="userNotSignedIn";t[t.userAborted=8]="userAborted";t[t.silentSignInFailed=9]="silentSignInFailed";t[t.invalidResourceUrl=10]="invalidResourceUrl";t[t.invalidGrant=11]="invalidGrant";t[t.connectionLost=12]="connectionLost";t[t.clientError=
13]="clientError";t[t.serverError=14]="serverError"})(ed||(ed={}));Object(h.b)("ErrorCodes",ed);class Oc{}Object(h.a)(Oc,"HostApplicationType",null,[]);class Wl{constructor(t,N){this.requestCallback=this.requestParameters=null;this.requestParameters=t;this.requestCallback=N}}Object(h.a)(Wl,"OutstandingRequest",null,[]);class Wh{}Wh.thk="AADSTS50058";Wh.invalidResourceUrl="AADSTS50001";Wh.nhk="AADSTS65001";Wh.Fhk="AADSTS70011";Wh.userAborted="13002";Wh.mzk="Popup Window is null";Wh.lzk="Popup Window closed";
Wh.adalTimeout="Token renewal operation failed due to timeout";Wh.ipl="tokenRevoked";Object(h.a)(Wh,"WopiHostErrorType",null,[]);var ik=d(234),Vj=d(342),Zm=d(1104);class Ok{constructor(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}}Object(h.a)(Ok,"WopiIdentityInfo",null,[762]);class rf{constructor(t,N,ha){this.expiration=this.authority=this.accessToken=null;this.accessToken=t;this.authority=N;this.expiration=ha}}Object(h.a)(rf,"WopiIdentityToken",
null,[761]);class Af{constructor(t){this._initialized=!1;this.TDb={};this.qkd={};this.E$=v.AFrameworkApplication.Aa.EU;this.V6d=t}HVd(t){this._initialized||(t.fu(Yd.a.p7g),t.kB(Yd.a.p7g,Object(r.a)(this,this.tpk,"onReceivedAccessToken")),this._initialized=!0)}getAccessToken(t,N,ha=null){this.D_j(t,N);return new Promise((za,Ra)=>{if(this.N9d(N))if(N in this.TDb)Ra("unresolvedPendingRequest");else{var qb=window.setTimeout(()=>{m.ULS.sendTraceTag(37856032,344,10,Ed.c({["error"]:"Request timeout.",["callerId"]:N}));
Ra("timeout")},12E4);this.nZd(t,N,ha,(Qb,vc)=>{window.clearTimeout(qb);Qb?za(Qb):(m.ULS.sendTraceTag(37856033,369,15,Ed.c({["error"]:ed[vc]})),Ra(vc))})}else m.ULS.sendTraceTag(37856034,344,10,Ed.c({["error"]:"Caller is not allowed."})),Ra("notAllowed")})}getPrimaryIdentityInfo(t){return new Promise((N,ha)=>{this.N9d(t)?this.Ibj((za,Ra)=>{za?N(za):(m.ULS.sendTraceTag(37856064,369,10,Ed.c({["error"]:Ra.toString()})),ha(Ra))}):(m.ULS.sendTraceTag(37856065,344,10,Ed.c({["error"]:"Caller is not allowed."})),
ha("notAllowed"))})}getAuthContext(t){return new Promise((N,ha)=>{const za=this.getAuthContextSync(t);za?N(za):ha("notAllowed")})}getAuthContextSync(t){if(this.N9d(t)){const N=new Zm.a;N.upn=v.AFrameworkApplication.fa.Ga("UserPrincipalName");N.userId=v.AFrameworkApplication.fa.Ga("LoggableUserId");N.authority=v.AFrameworkApplication.fa.Ga("HostAuthAuthority");N.tenantId=v.AFrameworkApplication.fa.Ga("TenantId");N.isAnonymous=v.AFrameworkApplication.fa.ka("IsAnonymousUser");N.supportsAuthToken=this.jvj(t);
t=v.AFrameworkApplication.fa.Ga("HostAuthType");N.authorityType="aad"===t.toLowerCase()?2:"msa"===t.toLowerCase()?1:0;return N}m.ULS.sendTraceTag(40751647,344,10,Ed.c({["error"]:"Caller is not allowed."}));return null}jvj(t){const N=ik.OAuthManagerSettings.i8a;return Mc.a.rEa?N&&ik.OAuthManagerSettings.Gxh?Array.contains(ik.OAuthManagerSettings.Gxh,t.toLowerCase()):!1:N}nZd(t,N,ha,za){var Ra=[];Array.add(Ra,Object.assign(new I.a,{name:"CallerId",string:N}));Array.add(Ra,Object.assign(new I.a,{name:Kd.a.zPe,
string:t.correlationId}));w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Ra}));Ra=Vj.a.create().toString();const qb="getAccessToken_"+Ra,Qb=this.E$.zi("ComponentAttach",qb);this.qkd[qb]=Qb;const vc={};vc[Kd.a.APe]=Ra;vc[Kd.a.til]=t.resource;vc[Kd.a.uil]=t.scope;vc[Kd.a.Huh]=v.AFrameworkApplication.fa.Ga("HostAuthType");vc[Kd.a.xil]=v.AFrameworkApplication.fa.Ga("UserPrincipalName");vc[Kd.a.vil]=t.silentLogin;vc[Kd.a.qil]=
t.options;vc[Kd.a.zPe]=t.correlationId;vc[Kd.a.ril]=N;ha&&(vc[Kd.a.addinName]=ha.AddinName,vc[Kd.a.pil]=ha.AddinTrustId);this.V6d.execute(Zc=>{this.HVd(Zc);Zc.sendMessage(Yd.a.getAuthToken,vc)});this.TDb[Ra]=new Wl(t,za)}Ibj(t){const N=v.AFrameworkApplication.fa.Ga("UserName"),ha=v.AFrameworkApplication.fa.Ga("UserPrincipalName"),za=v.AFrameworkApplication.fa.Ga("LoggableUserIdSpace"),Ra=new Ok;Ra.email=ha;Ra.displayName=N;switch(za){case "OrgIdPuid":Ra.authority="AzureActiveDirectoryAccount";break;
case "MsaCid":case "MsaPuid":Ra.authority="MicrosoftAccount";break;default:Ra.authority=za}t(Ra,null)}tpk(t){let N=null;try{let za=t.Values[Kd.a.APe];const Ra=t.Values[Kd.a.oil],qb=t.Values[Kd.a.Huh],Qb=t.Values[Kd.a.wil];let vc=null,Zc=null;const Wc=this.TDb[za];if("undefined"!==typeof Wc&&Wc){var ha=[];Array.add(ha,Object.assign(new I.a,{name:Kd.a.zPe,string:Wc.requestParameters.correlationId}));w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:ha}));N=Wc.requestCallback;delete this.TDb[za];"undefined"!==typeof Ra&&Ra&&Ra.length?Zc=new rf(Ra,qb,Qb):vc=ed[this.Sck(t)];ha="getAccessToken_"+za;ha in this.qkd&&(this.qkd[ha].stop(),delete this.qkd[ha]);N(Zc,vc)}else m.ULS.sendTraceTag(37856066,344,10,Ed.c({["error"]:"No matching outstanding request for request ID.",["requestId"]:za}))}catch(za){t=t.Values[Kd.a.APe],t in this.TDb&&delete this.TDb[t],this.yXc(),m.ULS.sendTraceTag(37856067,344,10,Ed.c({["error"]:za.message,["stack"]:za.stack})),
N&&N(null,"generalException")}}N9d(t){var N=v.AFrameworkApplication.Ekj();t=t.toLowerCase();for(const ha of N)if(t===ha.toLowerCase())return!0;N=ik.OAuthManagerSettings.KJd;for(let ha in N)if(t===N[ha].toLowerCase())return!0;return!1}Sck(t){t=t.Values[Kd.a.sil];this.yXc();m.ULS.sendTraceTag(39068821,344,15,Ed.c({["error"]:t}));return t?-1<t.indexOf(Wh.thk)?9:-1<t.indexOf(Wh.mzk)||-1<t.indexOf(Wh.lzk)?12:-1<t.indexOf(Wh.invalidResourceUrl)?10:-1<t.indexOf(Wh.userAborted)?8:-1<t.indexOf(Wh.Fhk)||-1<
t.indexOf(Wh.nhk)||t===Wh.ipl?11:-1<t.indexOf(Wh.adalTimeout)?6:0:13}D_j(t,N){t=this.QLk(t.resource);m.ULS.sendTraceTag(39921882,344,50,Ed.c({["callerId"]:N,["resource"]:t}))}yXc(){m.ULS.sendTraceTag(39068822,344,50,Ed.c({["userAgent"]:window.navigator.userAgent}))}QLk(t){return(t?t:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")}}Object(h.a)(Af,"WopiIdentityManager",null,[733]);class qk{constructor(){this.Da=null}get name(){return"Common.App.WopiIdentity"}Wb(t){this.Da=
t;t.register(Af,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").ma().na(()=>new Af(t.Ka("Postmessage.IHostPostmessenger")))}init(){v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ff(Object(r.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){try{this.Da.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(t){m.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+t)}}dispose(){}static main(){e.a.instance.Bc(new qk)}}
Object(h.a)(qk,"WopiIdentityPackage",null,[2,3]);var Dk=d(655);class ej extends Dk.a{constructor(t,N){super(t,jb.a.AS(N))}ywa(t,N){this.isEnabled()&&this.LAc(this.OJa)&&(this.fu(t),this.kB(t,N))}}Object(h.a)(ej,"InsertMediaCrossDocumentMessenger",Dk.a,[793,626,106]);class xj{getInstance(t,N){return new ej(t,N)}}Object(h.a)(xj,"InsertMediaCrossDocumentMessengerFactory",null,[748]);class Wj{constructor(t,N,ha){this.correlationId=null;this.C4=0;this.insertPictureTelemetryEndpoint=null;this.DTd=0;this.ZOh=
t;this.bTb=[];this.XOh=N;this.ryf=ha.split(";")}sIb(t,N){Array.clear(this.bTb);t=this.ZOh.value;t.pul(N.Lub);t.LAc(this.XOh);t.fu(N.Lub);t.kB(N.Lub,ha=>{this.Mxe(ha,N)});m.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");t.sendMessage(N.TVf,{["FileExtensionFilterList"]:this.ryf})}u4h(t){Array.contains(this.bTb,t)||Array.add(this.bTb,t)}Mxe(t,N){m.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");
t=N.y5g(t);const ha=[];for(let za=0;za<t.length;za++){const Ra=t[za];N.TTc(Ra,this.ryf)?Array.add(ha,Ra):this.u4h(N.Xeg(Ra))}ha&&ha.length?N.Gsa(ha):m.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.bTb.length&&(N=this.bTb.join(", "),m.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",N),this.Hfl(N))}Hfl(t){const N=new Ma.StandardDialog;N.yd=0;N.DO(CommonUIStrings.l_DefaultDialogTitle,
String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,t),null)}dispose(){}}Object(h.a)(Wj,"InsertMediaFromHostManager",null,[726,106]);class rk{constructor(t){this.BPh=t}getInstance(){return this.BPh}}Object(h.a)(rk,"InsertMediaFromHostManagerFactory",null,[876,877]);class ol{constructor(){this.ENb=document.createElement("iframe");this.ENb.src="about:blank";this.ENb.style.visibility="hidden";this.ENb.style.position="absolute";this.ENb.style.zIndex="-100"}get f6a(){return this.ENb}}
Object(h.a)(ol,"InsertMediaFromHostOneDriveHostFrame",null,[872]);class jm extends Dk.a{constructor(t,N){super(t,"*"===N?N:jb.a.AS(N));this.GCf(Yd.a.insertImage);this.GCf(Yd.a.H8d)}reportDocumentLoadedTime(){}}Object(h.a)(jm,"InsertMediaFromOneDriveCrossDocumentMessenger",Dk.a,[865,626,106]);var xd=d(268),Xl=d(530);class dl{kCc(t){switch(t){case 1:t=8;break;case 4:t=3;break;case 2:t=0;break;default:t=0}return t}Bgi(t,N){return String.format(N,this.kCc(t))}Agi(t,N,ha,za,Ra,qb,Qb){t=this.kCc(t);const vc=
xd.a.oe(v.AFrameworkApplication.lcid).name,Zc=v.AFrameworkApplication.buildVersion;v.AFrameworkApplication.qta("ShIns226;ShIns226cf");return String.format(N,v.AFrameworkApplication.lcid,vc,Zc,Ra,t,qb,ha,za,Qb)}Dgi(t,N){t=this.kCc(t);const ha=v.AFrameworkApplication.buildVersion,za=0<ha.indexOf(".")?ha.substring(0,ha.indexOf(".")):"16";return String.format(N,v.AFrameworkApplication.lcid,v.AFrameworkApplication.lcid,v.AFrameworkApplication.lcid,t,za,ha,"Video",0,0)}Cgi(t,N,ha,za,Ra,qb,Qb){const vc=
xd.a.oe(v.AFrameworkApplication.lcid).name;t=String.format(N,v.AFrameworkApplication.lcid,vc,v.AFrameworkApplication.buildVersion,ha,this.kCc(t),za);Ra&&(t+="&flipgrid=1");qb&&(Ra=new Zi.QueryStringBuilder(t),Ra.Ti("stream2","1"),t=Ra.toString());"defaultModal"!=Qb&&(Ra=new Zi.QueryStringBuilder(t),Ra.Ti("modalvariation",Qb),t=Ra.toString());return t}A5g(t){if(!t||!t.Values)return null;t=t.Values;if(!t)return null;let N="";"sourceProvider"in t&&(N=t.sourceProvider||"");return Object.assign(new Xl.a,
{Action:t.action||"",Caption:t.caption||"",ContentType:t.contentType||"",Type:t.extension||"",PageUrl:t.pageUrl||"",OriginalUrl:t.sourceUrl||"",ContentProvider:N,ThumbnailUrl:t.thumbnailUrl||"",LicenseUrl:t.licenseUrl||"",LicenseDisplayName:t.licenseDisplayName||"",Height:t.height||0,Width:t.width||0,SvgContent:t.svgContent||"",Description:t.description||"",ProviderName:t.providerName||""})}Hvk(t){const N=[];if(!t||!t.Values||!t.Values.Items)return N;t=t.Values.Items;for(let za=0;za<t.length;za++){var ha=
t[za];ha&&(ha=Object.assign(new Xl.a,{Type:ha.Extension||"",OriginalUrl:ha.SourceUrl||"",Caption:ha.caption,Description:ha.description||"",Height:ha.Height||0,Width:ha.Width||0}),Array.add(N,ha))}return N}TTc(t,N){if(!t)return!1;for(let ha=0;ha<N.length;ha++)if(0<=t.toLowerCase().indexOf(N[ha]))return!0;return!1}LBk(t){let N="";if(t)for(let ha=0;ha<t.length;ha++){const za=t[ha];za&&(N+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',za.OriginalUrl,za.Width,za.Height))}return N}Gjj(t){return(t=
dl.zYk.exec(t))&&2<t.length?t[2].trim():""}}dl.zYk=RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im");Object(h.a)(dl,"InsertMediaHelper",null,[747]);var kg=d(32);class km{constructor(t){this.IOb=kg.a.insertHyperlink;this.Ca=t}get Iy(){return this.IOb}set Iy(t){this.IOb=t}Gsa(t){try{m.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",t.length);for(let N=0;N<t.length;N++)this.Ca.La(this.Iy,2,t[N]);m.ULS.sendTraceTag(21612192,
352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",t.length)}catch(N){m.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",N.toString())}}}Object(h.a)(km,"InsertOneDriveFileHandler",null,[736]);class Ki extends km{constructor(t){super(t)}get TVf(){return Yd.a.H8d}get Lub(){return Yd.a.CBj}y5g(t){return t&&t.Values&&"Items"in t.Values?t.Values.Items:null}Xeg(){L.a(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");
return""}TTc(){return!0}D9g(t,N,ha){t=ha(t);t.length&&(ha={},ha.Items=t,N.sendMessage(this.Lub,ha))}z5g(t){const N=[];for(let ha=0;ha<t.data.value.length;ha++){const za=t.data.value[ha];if(za){const Ra={};Ra.DisplayText=za.name;Ra.Url=za.urls.download;Ra.sourceUrl=za.urls.download;Ra.caption=za.name;Array.add(N,Ra)}}return N}}Object(h.a)(Ki,"InsertOneDriveFileHelper",km,[735,736]);class vm extends ad.a{constructor(){super()}rOe(){this.hsc="FilePickerDialog";this.mg="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";
this.ng="PickerDialog-Livebooks";this.showDialog("",null)}h2d(){return document.getElementById("OpenFilePickerDiv")}QF(){}Ema(){}}Object(h.a)(vm,"PickerDialog",ad.a,[814]);class pj{constructor(t,N,ha){this.Xn=this.Jga=null;this.w0a=t;this.vBd=ha;this.mga=new yc.a(()=>new Ph.a(N.value,Object(r.a)(this,this.LCa,"getMoreInfoEventReceived")))}get PDb(){this.Jga||(this.mga.value.ica("InsertFromOneDrive",!0),this.Xn&&this.Xn.VQ&&this.Xn.VQ.length&&(this.Jga=this.O1d(this.Xn.VQ)));return this.Jga}O1d(t){t=
t.toLowerCase();t.endsWith("/")||(t+="/");const N=t.indexOf("/documents/");return-1!==N?t.substring(0,N+1)+"_layouts/15/onedrive.aspx":""}LCa(t){this.Xn||3!==t.state||(this.Xn=t)}start(t){if(!this.PDb)if(v.AFrameworkApplication.breadcrumbFolderUrl&&v.AFrameworkApplication.breadcrumbFolderUrl.length)this.Jga=v.AFrameworkApplication.breadcrumbFolderUrl;else{m.ULS.sendTraceTag(26071185,352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.Xn);return}const N=new vm;N.rOe();const ha=N.h2d();ha?this.w0a.start((za,Ra)=>{N.hide();this.VEb(za,Ra,t)},()=>{this.Nwe(N)},ha,this.Jga):m.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")}Nwe(t){t.hide();m.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")}VEb(t,N,ha){m.ULS.sendTraceTag(26071188,352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",t);t&&N&&N.data&&N.data.value&&
0<N.data.value.length?(t=this.vBd.getInstance(window.frames[0].parent,window.document.URL),ha.D9g(N,t,Object(r.a)(ha,ha.z5g,"parseOneDriveV7Response"))):m.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}}Object(h.a)(pj,"OneDriveFilePickerHelperV7",null,[794,795]);class Df{constructor(t,N,ha,za){this.ia=N;this.la=t;this.Y8=this.la.Hsa;this.w8=ha;this.IEg=za}get $R(){return this.IEg?this.IEg.instance:null}ub(){this.ia.pa(F.a.ZWc,pb.a.application,
Object(r.a)(this,this.gKa,"triggerCommandforAddinCommands"),4);this.ia.pa(F.a.t3a,pb.a.application,Object(r.a)(this,this.gKa,"triggerCommandforAddinCommands"),4);this.ia.pa(F.a.bFe,pb.a.application,Object(r.a)(this,this.gKa,"triggerCommandforAddinCommands"),4);this.ia.pa(F.a.Bhc,pb.a.application,Object(r.a)(this,this.Bhc,"queryAddInCommandsLoadStatus"),96);this.ia.ya(F.a.Srh,pb.a.application,Object(r.a)(this,this.gKa,"triggerCommandforAddinCommands"));this.ia.pa(F.a.mGb,pb.a.application,Object(r.a)(this,
this.gKa,"triggerCommandforAddinCommands"),64);this.ia.ya(F.a.lmc,pb.a.application,Object(r.a)(this,this.gKa,"triggerCommandforAddinCommands"));this.ia.pa(F.a.l3b,pb.a.application,Object(r.a)(this,this.gKa,"triggerCommandforAddinCommands"),64);this.ia.ya(F.a.mIb,pb.a.application,Object(r.a)(this,this.gKa,"triggerCommandforAddinCommands"));this.ia.ya(F.a.ZZb,pb.a.application,Object(r.a)(this,this.gKa,"triggerCommandforAddinCommands"))}xe(){}gKa(t,N,ha,za,Ra){if(!this.Y8)return 16;if(1===ha)return N=
t===F.a.t3a&&(!this.$R||!this.$R.Flj(Ra)),t=t===F.a.t3a&&!!this.$R&&this.$R.Q$k(Ra),N||t?8:32;if(this.$R)switch(t){case F.a.ZWc:this.$R.$Wc(Ra);break;case F.a.t3a:this.$R.y2b(Ra);break;case F.a.Bhc:this.$R.j$g(Ra);break;case F.a.Srh:this.$R.Lcl();break;case F.a.mGb:this.$R.mGb(Ra);break;case F.a.bFe:this.$R.SLk();break;case F.a.lmc:this.$R.lmc(Ra);break;case F.a.l3b:this.$R.l3b(Ra);break;case F.a.mIb:this.$R.mIb(Ra);break;case F.a.ZZb:this.$R.ZZb(Ra)}else this.w8.q4a(),this.w8.MTb(t,Ra);return 32}Bhc(t,
N,ha,za,Ra){if(!this.Y8)return 16;this.$R&&this.$R.j$g(Ra);return 32}}Object(h.a)(Df,"AddinCommandsActor",null,[229]);class Qh{}Qh.taskPaneWidth="TaskPaneWidth";Qh.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";Qh.CU="TaskPaneTitle";Qh.nonPersistedSettings="NonPersistedSettings";Qh.onTaskPaneClose="OnTaskPaneClose";Qh.Tva="OnRenderedCallback";Object(h.a)(Qh,"PropertyNames",null,[]);var Yl=d(964),qj=d(231);class pl{}pl.wWd="extId";pl.JV="ComponentId";pl.kze="OptionalProps";Object(h.a)(pl,
"ActionPropertyNames",null,[]);var Il=d(40),$m=d(81);class Hj{constructor(){this.idField=null;this.stateField=0}}Object(h.a)(Hj,"CT_OsfBackgroundAppData",null,[]);class el{constructor(){this.currentStoreTypeField=this.bkgdDataField=this.assetStoreIdField=this.assetIdField=this.appVersionField=null;this.heightField=0;this.heightFieldSpecified=!1;this.idField=null;this.isAddinCommandsField=!1;this.storeIdField=null;this.widthField=this.targetTypeField=0;this.widthFieldSpecified=!1}}Object(h.a)(el,"CT_OsfInsertionInfo",
null,[]);var ql=d(963),ri=d(965),un=d(326);class vn{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id){this.BCc=0;this.Vkg=!1;this.s0j="g_InstallOrigin";this.HRg=new Map([["InsertAddInsFromBackstage","Backstage"],["InsertAddIns","Ribbon"],["LaunchAddinDialogFromTellMe","TellMe"]]);this.Njg=(Xe,of,ih,Aj,$f)=>{of=this.ua.Ba;Aj=this.Zb.yf;if(!(this.Y8&&of&&Aj)||this.Af.Zc(of))return 8;if(!this.KIf)return m.ULS.sendTraceTag(512288602,802,50,"Web add-in insert blocked by doc IRM"),8;if(1===ih)return 32;dd.a("LogAddinInstallOriginEnabledForPPT")&&
(ih=$f?$f.SourceControlId:void 0,window[this.s0j]=this.HRg.get(ih)?this.HRg.get(ih):"Unknown");this.re?dd.a("UpdateLaunchInsertDialog")?(Xe=$f?$f.CommandValueId:null,"LaunchAddinDialogFromTellMe"==($f?$f.SourceControlId:void 0)&&Xe?this.re.iUj(Xe):this.re.launchInsertDialog()):this.re.launchInsertDialog():(this.w8.q4a(),this.w8.MTb(Xe,$f));return 32};this.Ojg=(Xe,of,ih,Aj,$f)=>{if(!this.KIf)return m.ULS.sendTraceTag(512288601,802,50,"Web add-in insert blocked by doc IRM"),16;if(!$f)return 8;if(0===
$f.targetType)return this.RBj($f,Xe);if(1===$f.targetType){if(this.Af.Zc(this.Zb.yf))return 16;this.D4j?$f.isAddinCommands?dd.a("AddinCommandsActionTypeUndefinedCheck")?void 0===$f.addinCommandsActionType||null===$f.addinCommandsActionType||0===$f.addinCommandsActionType?this.$Jb($f):1===$f.addinCommandsActionType?this.sSc($f):m.ULS.sendTraceTag(512288600,802,50,"HandleInsertAppForOfficeUpload invalid AddinCommandsActionType of "+$f.addinCommandsActionType.toString()):0===$f.addinCommandsActionType?
this.$Jb($f):1===$f.addinCommandsActionType&&this.sSc($f):(Xe={},Xe.solutionId=$f.solutionId,Xe.version=$f.version,Xe.storeType=$f.storeType,Xe.storeId=$f.storeId,Xe.targetData=$f,this.re.En.isAddinCommandsAsync(Xe,(Oi,wk,Ti)=>{wk?this.$Jb(Ti.targetData):this.sSc(Ti.targetData);Oi||(Oi=Ti.targetData,m.ULS.sendTraceTag(512288599,220,10,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(Oi.solutionId,Oi.storeType,Oi.assetId,null,null,Oi.storeId),Oi.storeType))})):
this.sSc($f);ql.a.add($f.solutionId,$f.targetType,$f.storeId,$f.storeType,$f.version);return 32}return 8};this.la=t;this.Y8=this.la.pptEditInsertAppsForOfficeEnabled;this.D4j=this.la.Hsa;this.xv=N;this.ia=ha;this.Zb=za;this.ua=Ra;this.V1c=Qb;this.Fb=qb;this.w8=vc;this.Zd=Zc;this.Nb=Wc;this.Af=Md;this.ol=Id}get KIf(){return this.Y8&&v.AFrameworkApplication.jqa}ub(){this.ia.pa(vb.a.dpg,pb.a.application,this.Njg,516);this.ia.pa(vb.a.dSc,pb.a.application,this.Ojg,4);this.ia.ya(vb.a.$Qc,pb.a.application,
Object(r.a)(this,this.Ynj,"handleHideAppForOfficeTaskPane"));this.ia.pa(vb.a.Hfb,pb.a.application,Object(r.a)(this,this.Mqj,"handleRenderAppForOfficeTaskPane"),4);this.ia.pa(vb.a.oXa,pb.a.application,Object(r.a)(this,this.oXa,"queryEntitledAppsForOffice"),96);this.ia.ya(vb.a.nJa,pb.a.application,Object(r.a)(this,this.Gkg,"handleShowFirstPartyTaskPane"));this.ia.ya(vb.a.ZEc,pb.a.application,Object(r.a)(this,this.Hmj,"handleCloseAppsForOfficeTaskPane"));this.ia.ya(F.a.Bdl,pb.a.application,Object(r.a)(this,
this.urj,"handleShowExtensionTaskPane"));this.ia.ya(F.a.wqi,pb.a.application,Object(r.a)(this,this.Imj,"handleCloseExtensionTaskPane"));this.ia.ya(F.a.PWk,pb.a.application,Object(r.a)(this,this.Wqj,"handleRestartExtensionTaskPane"));this.ia.ya(vb.a.KCh,pb.a.application,Object(r.a)(this,this.hsj,"handleUpdateBackgroundAppData"));dd.a("EnabledTellMeAddinOnPPTO")&&(this.ia.pa(F.a.npg,pb.a.application,this.Ojg,4),this.ia.pa(F.a.Ode,pb.a.application,this.Njg,4))}xe(){}get re(){return this.Zd.instance}urj(t,
N,ha,za,Ra){if(2!==ha)return 32;const qb=Ra[pl.wWd];Ra=Ra[pl.kze];const Qb={};Qb.CU=Ra.optionalProperties[Qh.CU];Qb.assetId=qb.getId();Qb.Tva=Ra.optionalProperties[Qh.Tva];Qb.nonPersistedSettings=Ra.yYf;Qb.npc=!0;return this.Gkg(t,N,ha,za,Qb)}Imj(t,N,ha,za,Ra){if(2!==ha)return 32;t=Ra[pl.wWd];Ra=Ra[pl.kze];N={};N.CU=Ra.optionalProperties[Qh.CU];N.assetId=t.getId();N.sourceLocationOverrideResourceId=Ra.optionalProperties[Qh.sourceLocationOverrideResourceId];N.Tva=Ra.optionalProperties[Qh.Tva];N.nonPersistedSettings=
Ra.yYf;N.npc=!0;Ra=this.re.c0b(N);return(Ra=this.re.DZ(Ra))&&this.re.OOd(Ra.instanceId)?32:8}Wqj(t,N,ha,za,Ra){if(2!==ha)return 32;t=Ra[pl.wWd];N=Ra[pl.kze];Ra={};Ra.CU=N.optionalProperties[Qh.CU];Ra.assetId=t.getId();Ra.sourceLocationOverrideResourceId=N.optionalProperties[Qh.sourceLocationOverrideResourceId];Ra.Tva=N.optionalProperties[Qh.Tva];Ra.nonPersistedSettings=N.yYf;Ra.npc=!0;t=this.re.c0b(Ra);return(t=this.re.DZ(t))?(this.re.cdh(t.instanceId,Ra),32):8}Ynj(t,N,ha,za,Ra){if(!this.Y8)return 16;
if(!Ra)return 8;if(1===ha)return 32;t=Object(Q.a)(String,Ra);if(!t||!t.length)return 8;if((N=this.re.PXd(t))&&N.taskpane){if(this.re.Ssa(t))return this.re.$Gb(t,!1),32;if(N.So&&OSF.OsfControl.isFirstPartyStoreString(N.So.storeType))return this.re.fUd(t),this.re.YGk(t),32;N=N.taskpane.ownerAddinSolutionId;if(this.re.SDj(t)||N)this.re.fUd(t);else if(N=this.re.hMc(),ha=this.Nb.Kc(N),t=this.re.A5f(t)){ha.Gk(Object(Q.a)($m.a,t));t=this.Fb.ud(4,void 0,void 0,void 0,!0);try{t.kc(N),ha.Ii()}finally{t&&t.dispose()}}}return 32}Mqj(t,
N,ha,za,Ra){if(!this.Y8)return 16;if(!Ra)return 8;if(1===ha)return 32;N=Object(Q.a)(String,Ra);if(!N||!N.length)return 8;this.re?this.re.Hfb(N):this.w8.MTb(t,Ra);return 32}Gkg(t,N,ha,za,Ra){if(!this.Y8)return 16;if(!Ra)return 8;if(1===ha)return 32;if(this.re){if(!Ra||!Ra.assetId||!v.AFrameworkApplication.Vbe(Ra.assetId))return 8;Ra.nonPersistedSettings||(Ra.nonPersistedSettings={});Ra.nonPersistedSettings.ShowFeedback=v.AFrameworkApplication.sE;!this.Vkg&&this.BCc&&(this.Vkg=!0,t=window.performance.now()-
this.BCc,m.ULS.sendTraceTag(512288597,220,50,"Apps for office load time {0}",t));t=this.re.c0b(Ra);if(t=this.re.DZ(t))return this.re.cdh(t.instanceId,Ra),32;this.re.yTk(Ra)}else this.BCc||(this.BCc=window.performance.now()),this.w8.q4a(),this.w8.MTb(t,Ra);return 32}hsj(t,N,ha,za,Ra){if(1===ha)return this.Y8?32:8;if(!this.Y8)return 16;if(!(Ra&&Ra.Rv&&-1!==Ra.Rv.state&&Ra.Rv.Nwa&&this.re))return 8;t=this.re.hCa(Ra.So.id);if(!t)return 8;N=this.Fb.ud(4,void 0,void 0,void 0,!0);try{N.kc(t),t.setValue(Vb.a.Zob,
Ra.Rv.state),t.setValue(Vb.a.R3a,Ra.Rv.Nwa),t.setValue(Il.a.vUb,Ra.So.storeType)}finally{N&&N.dispose()}return 32}Hmj(t,N,ha,za,Ra){return this.Y8?Ra?1===ha?32:this.re&&Ra&&Ra.length?this.re.OOd(Ra)?32:8:8:8:16}oXa(t,N,ha,za,Ra){var qb;if(2===ha){N=Ra.callback;if(!N)return 16;dd.a("AllowQueryAddinsForStoreTypes")?this.re?this.OEk(N,null!==(qb=Ra.storeType)&&void 0!==qb?qb:OSF.StoreTypeEnum.MarketPlace):(Ra=Object.assign({},Ra),this.w8.MTb(t,Ra)):this.NEk(N)}return 32}OEk(t,N){const ha=new Yl.a;ha.callbackFunc=
t;ha.storeType=N;ha.fromInsertDialog=!1;ha.refresh="true"===Ua.a.instance.getItem(qj.a.aJd);this.re.En.queryEntitlementDetails(ha)}NEk(t){const N=new Yl.a;N.callbackFunc=t;N.storeType=OSF.StoreTypeEnum.MarketPlace;N.fromInsertDialog=!1;N.refresh="true"===Ua.a.instance.getItem(qj.a.aJd);this.re.En.queryEntitlementDetails(N)}$Jb(t){const N=new C.a;N.add(t);t={};t[qj.a.MBc]=N;t[qj.a.S6]=3;this.ia.La(F.a.ZWc,2,t)}RBj(t,N){const ha=this.ua.Ba;if(!ha||this.Af.Zc(ha))return 16;if(!this.ol.yI(ha,1))return this.ol.AJ(ha),
16;try{return this.ppg(t,ha,ha.Bb,N)}catch(za){return 8}}ppg(t,N,ha,za){ha=N.oBi(t.width,t.height,N.ev()+1);ri.a.RDf(ha,t,this.re);this.xv.B2([Object(Q.a)(4,ha)],N,za);ql.a.add(t.solutionId,t.targetType,t.storeId,t.storeType,t.version);return 32}sSc(t){if(!this.re.DZ(t.solutionId)){var N=this.re.hCa(t.solutionId),ha=this.re.hMc();if(N){ha=new un.a(N);if(!ha.visibility){let za=this.Fb.ud(4,void 0,void 0,void 0,!0);try{za.kc(N),N.setValue(Il.a.xUb,!0),N.setValue(Il.a.vUb,t.storeType)}finally{za&&za.dispose()}}this.re.Hfb(ha.id)}else{N=
ri.a.Vxi(this.V1c.value,t,this.re);t=this.Fb.ud(4,void 0,void 0,void 0,!0);try{t.kc(ha),ri.a.K0h(ha,N)}finally{t&&t.dispose()}}}}}Object(h.a)(vn,"AppForOfficeActor",null,[229]);var Ci=d(85),Jl=d(166),Aa=d(41),wn=d(994);class Ij{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of,ih,Aj,$f,Oi,wk,Ti,mn,ki,nn,to,So,on){this.U8b=null;this.fFg=!1;this.tUa=null;this.lIg=dd.a("PartialDoc.SkipCutCopyCallout");if(!on)throw Error.argumentNull("calloutNotificationAdapter");this.ia=t;this.Af=N;this.Fa=ha;this.ra=
za;this.Xs=Ra;this.$D=qb;this.zQg=Qb;this.X3j=vc;this.b9j=Zc;this.gZc=Wc;this.Ob=Md;this.KJg=Oi.Fmg;this.zu=Id;this.uc=Ti;this.$_j=Oi.powerPointEditorDownloadACopyUiIsEnabled;this.D8j=Xe;this.MZc=of;this.Xa=$f;this.rVa=!Oi.tg;this.tPg=mn;this.fRg=nn;this.bMg=to;this.gw=So;this.ZGg=!Oi.printingEnabled||wk.ka("DisablePrint");this.$Gg=ih;this.yl=Aj;this.n2j=wk.Ga("DownloadPdfFromPodsUrl");this.m_printUrl=wk.Ga("PrintPdfFromPodsUrl");this.m2j=wk.Ga("DownloadOdpFromPodsUrl");this.kHg=wk.Ga("DownloadImagesFromPodsUrl");
this.y9j=wk.ka("UseToastForDeferredBlobsEnabled");this.r$j=Oi.pptAppendFileNameToQueryUrlForDocumentOperationsActor;t=(v.AFrameworkApplication.fileName||"").toLowerCase();Oi.tg&&Oi.lHj?(this.fFg=!0,this.U8b=wk.Ga("DownloadACopyPodsUrl")):!Oi.tg&&Oi.kOj&&(t.endsWith(".pptx")||t.endsWith(".ppsx"))?this.U8b=this.uck():this.U8b=v.AFrameworkApplication.vPa;this.Fle=ki;this.A5j=Oi.IUc;this.kva=u.a.instance.Ka("Common.ISystemInitiatedFeedback");this.O4j=wk.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CollabCornerFloodgateDownloadCopy",
!1);this.sQ=on}ub(){const t=!!this.$Gg&&!this.tPg();K.a.J(512500629,801,50,"Limited printing access: {0}, Message shown: {1}",this.ZGg,t);this.ZGg?t&&this.yl.bel(this.$Gg):(this.ia.ya(vb.a.print,pb.a.application,Object(r.a)(this,this.Wpj,"handlePrint")),this.ia.ya(vb.a.downloadACopy,pb.a.application,Object(r.a)(this,this.downloadACopy,"downloadACopy")),this.ia.ya(vb.a.QIc,pb.a.application,Object(r.a)(this,this.QIc,"downloadACopyAsPdf")),this.ia.ya(vb.a.PIc,pb.a.application,Object(r.a)(this,this.PIc,
"downloadACopyAsOdp")),this.ia.ya(vb.a.RIc,pb.a.application,Object(r.a)(this,this.RIc,"downloadAsImages")),this.ia.ya(vb.a.OIe,pb.a.application,Object(r.a)(this,this.OIe,"saveSlidesAsImages")),this.ia.ya(vb.a.Ebd,pb.a.application,Object(r.a)(this,this.eBk,"pptoSaveACopy")),this.ia.ya(vb.a.L7g,pb.a.application,Object(r.a)(this,this.fBk,"pptoSaveAsToHost")),this.ia.ya(vb.a.M7g,pb.a.application,Object(r.a)(this,this.gBk,"pptoSaveToSharePoint")),this.ia.ya(vb.a.V8g,pb.a.application,Object(r.a)(this,this.Ypj,
"handlePrintNotes")),this.ia.ya(vb.a.U8g,pb.a.application,Object(r.a)(this,this.Xpj,"handlePrintHandouts")));this.ia.ya(F.a.eYa,pb.a.application,Object(r.a)(this,this.eYa,"saveFileChange"));this.zQg&&this.ia.pa(vb.a.Rcd,pb.a.application,Object(r.a)(this,this.Rcd,"querySaveStatus"),96);this.Fle.execute(Object(r.a)(this,this.Hec,"onHostPostmessengerCreated"))}xe(){const t=this.Fa.Dc(nb.a.Shi);t.bindAction(ob.KeyInputManager.Na(ma.a.ujb,ob.KeyInputManager.He),vb.a.print);t.bindAction(ob.KeyInputManager.Na(ma.a.HKa,
ob.KeyInputManager.He),F.a.Ae);t.bindAction(ob.KeyInputManager.Na(ma.a.vpd,ob.KeyInputManager.He),F.a.Ae);t.bindAction(ob.KeyInputManager.Na(ma.a.xY,ob.KeyInputManager.He),F.a.Ae);t.bindAction(ob.KeyInputManager.Na(ma.a.xY,ob.KeyInputManager.He|4),F.a.Ae)}fBk(t,N,ha){return this.HIe(ha,F.a.xGb,"SaveAsToHost")}eBk(t,N,ha){return this.HIe(ha,F.a.ukc,"SaveACopy")}gBk(t,N,ha){return this.HIe(ha,F.a.hgb,"SaveToSharePoint")}HIe(t,N,ha){return 1===t?v.AFrameworkApplication.lJ||v.AFrameworkApplication.hQ?
8:this.ia.processAction(N,1):this.gw.hasDeferredContent()&&(K.a.J(512500628,843,15,"{0} is triggered while document has deferred content",ha),!this.y9j)?(this.gw.JNe(ha,null,null),8):this.Xa.Gca?(K.a.J(512500627,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",N),this.ia.La(vb.a.zGb,2,N)):this.ia.processAction(N,2)}downloadACopy(t,N,ha,za,Ra){if(this.Af.Zc(this.Xs))return 16;if(1===ha)return!this.uc.Hj()||v.AFrameworkApplication.hQ?8:Ij.K3f()?32:this.dqb();if(this.gw.hasDeferredContent())return K.a.J(512500626,
843,15,"DownloadACopy is triggered while document has deferred content"),this.lIg&&this.sQ.RTd(),this.gw.JNe("DownloadACopy",new wn.a,()=>{this.lTe(Ra)}),this.gw.Xpa("DownloadACopyRequestedTime",Aa.a.$e(new Date)),8;this.ra.Uh();this.Fa.Ad();K.a.J(512500625,801,50,"PPT save and download a copy");this.Xa.Gca?this.lTe(Ra):(this.zu.show(!0,t),this.$D.G2(!1,this.rVa,()=>{this.lTe(Ra)},Object(r.a)(this,this.Owa,"saveFailureCallback")));return 32}lTe(t){this.zu.hide();let N;N=Ij.K3f()?v.AFrameworkApplication.vPa:
this.fFg?this.Eob(this.U8b):this.U8b;t&&t.FileDownloadUrl&&(N=t.FileDownloadUrl.toString());this.ZXj();this.bMg&&!this.bMg()&&this.fRg&&this.fRg("3555692408")?this.tUa.sendMessage(Yd.a.download,{}):this.$_j?(this.D8j.Pel(N),this.gw.Xpa("DownloadModalTime",Aa.a.$e(new Date))):this.Ob.mO(!0,N,!0)}ZXj(){this.O4j&&this.kva&&this.kva.execute(t=>{t.logActivity("CollabCornerSurveyLogDownloadACopyCommandActivity","CollabCornerFloodgateSurveysIsEnabled")})}Rcd(t,N,ha,za,Ra){t="";this.zQg&&(t=this.X3j.kW(this.Xs)?
String.format(ResourceStrings.L_SavingStatus):this.KJg?String.format(CommonUIStrings.l_SavedToStatus,this.KJg):String.format(ResourceStrings.L_SavedStatus));Ra[Oh.a.Value]=t;return 32}Wpj(t,N,ha){return this.RBe(ha,0,t)}Ypj(t,N,ha){return this.RBe(ha,8,t)}Xpj(t,N,ha){return this.RBe(ha,4,t)}RBe(t,N,ha){if(this.Af.Zc(this.Xs))return 16;if(1===t)return!this.uc.Hj()||v.AFrameworkApplication.hQ?8:this.dqb();if(this.tPg())return K.a.J(512500624,328,50,"Printing not allowed for IRM protected documents"),
16;K.a.J(512500623,328,50,"PPT Editor print. PublishOption: {0}",N);this.ra.Uh();this.Fa.Ad();this.Xa.Gca?this.ckh(N):(this.zu.show(!0,ha),this.$D.G2(!1,this.rVa,()=>{this.ckh(N)},Object(r.a)(this,this.Owa,"saveFailureCallback")));return 32}ckh(t){this.zu.hide();this.b9j.print(this.Xa.presentationId.string,this.Eob(this.m_printUrl),t)}QIc(t,N,ha){if(this.Af.Zc(this.Xs))return 16;if(1===ha)return!this.uc.Hj()||v.AFrameworkApplication.hQ?8:this.dqb();this.MZc.r_f=new Date;this.ra.Uh();this.Fa.Ad();
this.Xa.Gca?this.$jh():(this.zu.show(!0,t),this.$D.G2(!1,this.rVa,()=>{this.$jh()},Object(r.a)(this,this.Owa,"saveFailureCallback")));return 32}$jh(){this.zu.hide();this.MZc.hkh=new Date;this.gZc.convert(this.Xa.presentationId.string,1,this.Eob(this.n2j))}RIc(t,N,ha){if(this.Af.Zc(this.Xs))return 16;if(1===ha)return!this.uc.Hj()||v.AFrameworkApplication.hQ?8:this.dqb();this.ra.Uh();this.Fa.Ad();this.Xa.Gca?this.akh():(this.zu.show(!0,t),this.$D.G2(!1,this.rVa,()=>{this.akh()},Object(r.a)(this,this.Owa,
"saveFailureCallback")));return 32}OIe(t,N,ha){if(this.Af.Zc(this.Xs))return 16;if(1===ha)return!this.uc.Hj()||v.AFrameworkApplication.hQ?8:this.dqb();this.ra.Uh();this.Fa.Ad();this.Xa.Gca?this.q_f():(this.zu.show(!0,t),this.$D.G2(!1,this.rVa,()=>{this.q_f()},Object(r.a)(this,this.Owa,"saveFailureCallback")));return 32}akh(){this.zu.hide();this.gZc.convert(this.Xa.presentationId.string,2,this.Eob(this.kHg))}q_f(){this.zu.hide();var t=this.Eob(this.kHg),N=this.ra.nf();0<N.length&&(N=Jl.c(N,ha=>ha.sid.toString()).join(","),
t=new Zi.QueryStringBuilder(t),t.Ti(Ci.a.vgl,N),this.gZc.convert(this.Xa.presentationId.string,2,t.toString()))}PIc(t,N,ha){if(this.Af.Zc(this.Xs))return 16;if(1===ha)return!this.uc.Hj()||v.AFrameworkApplication.hQ?8:this.dqb();if(this.gw.hasDeferredContent())return this.lIg&&this.sQ.RTd(),K.a.J(512500622,843,15,"DownloadACopyAsOdp is triggered while document has deferred content"),this.gw.JNe("DownloadACopyAsOdp",new wn.a,()=>{this.IIe()}),8;this.ra.Uh();this.Fa.Ad();this.Xa.Gca?this.IIe():(this.zu.show(!0,
t),this.$D.G2(!1,this.rVa,()=>{this.IIe()},Object(r.a)(this,this.Owa,"saveFailureCallback")));return 32}Owa(){this.zu.hide();return!1}IIe(){this.zu.hide();this.gZc.convert(this.Xa.presentationId.string,0,this.Eob(this.m2j))}eYa(t,N,ha,za,Ra){if(this.Af.Zc(this.Xs))return 16;if(1===ha)return 32;this.ra.Uh();this.Fa.Ad();this.$D.G2(!1,!0,qb=>{if(Ra&&1<=Ra.length)Ra[0](qb)},qb=>Ra&&2<=Ra.length?(Ra[1](qb,qb.ServerError.Code),!0):!1);return 32}uck(){const t=new Zi.QueryStringBuilder(jb.a.Ora("DownloadACopyHandler.ashx"));
t.Ti(Ci.a.lad,this.Xa.presentationId.string);t.Ti(Ci.a.vma,this.Xa.sessionInfo);t.Ti("fn",v.AFrameworkApplication.fileName);v.AFrameworkApplication.BNa(t);return t.toString()}Eob(t){if(t){const N=new Zi.QueryStringBuilder(t);this.Xa&&this.Xa.podSessionId&&0>t.indexOf(this.Xa.podSessionId)&&(N.SAc(Ci.a.g$+"="+this.Xa.podSessionId),K.a.J(512500620,801,50,"Append PodSessionId in url: {0}",this.Xa.podSessionId));this.r$j&&v.AFrameworkApplication.pu.Ix&&0<v.AFrameworkApplication.pu.Ix.length&&(N.Ti(Ci.a.m5g,
v.AFrameworkApplication.pu.Ix),K.a.J(512500619,801,50,"Appended FileName in url"));this.A5j&&(N.Ti(Ci.a.Luk,"true"),K.a.J(512500618,801,50,"Appended IsPasswordProtectedFile param"));v.AFrameworkApplication.BNa(N);return N.toString()}return null}Hec(t){this.tUa=t}dqb(){return v.AFrameworkApplication.lJ?8:32}static K3f(){const t=v.AFrameworkApplication.lJ,N=!gb.a.Va(v.AFrameworkApplication.vPa),ha=v.AFrameworkApplication.fa.ka("SupportsOfficeClientCoauthoring"),za=v.AFrameworkApplication.fa.ka("PPTClpSwitchEnabled");
K.a.J(512500617,801,50,"FIsClpProtectedFileAndDownloadEnabled - fProtected:{0} fHasDownload:{1} fClpTenantSwitchEnabled:{2} fClpPPTSwitchEnabled:{3}",t,N,ha,za);return t&&N&&ha&&za}}Object(h.a)(Ij,"DocumentOperationsActor",null,[229]);class Ig{}Ig.mg="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";Object(h.a)(Ig,"EmbedDialogHtml",null,[]);class vf{constructor(t,N,ha,za){this.jze=
t;this.a3=N;this.i4g=ha;this.value=za}}Object(h.a)(vf,"OptionInfo",null,[]);class xn{constructor(t,N,ha){this.bJe=t;this.Wub=N;this.a3=ha}}Object(h.a)(xn,"SectionInfo",null,[]);var sc=d(285);class Xf extends ad.a{constructor(t,N=!1){super(!1,!1,N);this.g3e=476;this.Isc=288;this.xMh=798;this.JUh=476;this.HUh=288;this.mad={};this.kYa=[];this.WO=this.Cza=this.DAd=this.vsc=this.Gwc=this.rmb=null;this.nNb=v.AFrameworkApplication.Mub;this.kxc=t;this.BAd=Object(r.a)(this,this.btk,"optionClickHandler");this.CAd=
Object(r.a)(this,this.ctk,"optionKeyHandler");this.Dqd=Object(r.a)(this,this.$bi,"arrowClickHandler");this.Ojb=Object(r.a)(this,this.aci,"arrowKeyHandler");this.wzc=Object(r.a)(this,this.nnl,"textAreaOnFocusHandler");this.LQh=N;this.mg=Ig.mg;this.yd=0;this.ng="EmbedDialog"}get klb(){return this.Isc}set klb(t){this.Isc=t}Ssh(t){const N={["id"]:this.ng,["bodyControls"]:{},["embedPreviewSectionTitle"]:CommonUIStrings.l_Preview,["embedCodeSectionTitle"]:CommonUIStrings.l_EmbedCode,["dimensionsSectionTitle"]:CommonUIStrings.l_Dimensions,
["interactionSectionTitle"]:CommonUIStrings.l_Interaction,["initialPreviewUrl"]:jb.a.Ri(this.kxc,"wdPreview","1"),["initialEmbedUrl"]:this.nNb,["getEmbedCode"]:Xf.Aag,["codeCopiedText"]:CommonUIStrings.l_EmbedCodeCopied};for(const ha of Object.keys(t))N[ha]=t[ha];this.yd=1;this.Ue(1,CommonUIStrings.l_CopyAction);this.Ue(0,CommonUIStrings.l_Close);this.tj(CommonUIStrings.l_Embed,null,N)}nIb(){if(this.LQh)this.Ssh({});else{this.showDialog(CommonUIStrings.l_Embed,null);this.rmb=document.getElementById("embedpreviewpane");
this.Gwc=document.getElementById("embedoptionpane");this.rmb.style.width=String.format("{0}px",this.JUh);this.Cza=document.createElement("iframe");this.Cza.className=Xf.GUh;this.Cza.frameBorder="0";this.Cza.style.height=String.format("{0}px",this.HUh);this.Cza.tabIndex=-1;this.rmb.appendChild(this.VGc(CommonUIStrings.l_Preview,this.Cza,Xf.zsf,Xf.IUh,Xf.zsf,!0));this.WO=document.createElement("textarea");this.WO.className=Xf.dNh;Sys.UI.DomElement.addCssClass(this.WO,sc.a.CAa);this.WO.id=Xf.eNh;Mc.a.Ki||
(this.WO.readOnly=!0);this.WO.rows=4;this.WO.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.WO.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;this.WO.setAttribute(oa.a.W1,String.format("{0} {1}",Xf.f3e,Xf.e3e));this.rmb.appendChild(this.VGc(CommonUIStrings.l_EmbedCode,this.WO,Xf.f3e));zd.a.addHandler(this.WO,"focus",this.wzc);var t=document.createElement("span");t.className=Xf.aOh;t.innerText=CommonUIStrings.l_CopyText;t.id=Xf.e3e;this.rmb.appendChild(t);this.vsc=document.createElement("div");
this.vsc.className=Xf.AMh;this.Gwc.appendChild(this.VGc(CommonUIStrings.l_Dimensions,this.vsc));this.DAd=document.createElement("div");this.Gwc.appendChild(this.uyi(Xf.MTh,this.DAd));this.yd=0;this.Ue(1,CommonUIStrings.l_Close);this.hDh();this.cEh();Mc.a.Ki||this.WO.focus()}}dispose(){if(this.mad){var t=this.mad;for(let N in t){const ha=t[N];this.en.xb(la.a.click,ha.jze,this.BAd);this.Lg.xb(la.a.Xf,ha.jze,this.CAd);this.Lg.xb(la.a.wl,ha.jze,this.CAd)}this.CAd=this.BAd=this.mad=null}if(this.kYa){for(t=
0;t<this.kYa.length;++t)this.en.xb(la.a.click,this.kYa[t].Wub,this.Dqd),this.Lg.xb(la.a.Xf,this.kYa[t].Wub,this.Ojb),this.Lg.xb(la.a.Qx,this.kYa[t].Wub,this.Ojb),this.Lg.xb(la.a.wl,this.kYa[t].Wub,this.Ojb);this.Lg=this.Dqd=this.kYa=null}this.wzc&&this.WO&&(zd.a.removeHandler(this.WO,"focus",this.wzc),this.wzc=null);this.WO=this.Cza=this.DAd=this.vsc=this.Gwc=this.rmb=null;super.dispose()}Ema(){super.Ema();this.rc.style.width=String.format("{0}px",this.xMh);this.RVb()}iDh(t,N){const ha=jb.a.Ri(this.nNb,
t,N);return this.nNb!==ha?(this.nNb=ha,this.kxc=jb.a.Ri(this.kxc,t,N),!0):!1}hDh(){this.WO&&(this.WO.innerText=Xf.Aag(this.nNb,this.g3e,this.Isc))}cEh(){this.Cza&&this.Cza.contentWindow.location.replace(jb.a.Ri(this.kxc,"wdPreview","1"))}rwl(t,N){this.iDh(t,N)&&(this.hDh(),this.cEh())}VGc(t,N,ha=null,za=null,Ra=null,qb=!1){const Qb=document.createElement("div");Qb.className=Xf.xWh;za&&(Qb.id=za);Ra&&Qb.setAttribute(oa.a.W1,Ra);qb&&(Qb.tabIndex=0);za=document.createElement("span");za.className=Xf.yWh;
za.innerText=t;ha&&(za.id=ha);Qb.appendChild(za);Qb.appendChild(N);return Qb}uyi(t,N){const ha=this.VGc(CommonUIStrings.l_Interaction,N),za=this.ai.createElement("div");za.className=Xf.HJh;za.id=Xf.JJh+t;za.setAttribute(oa.a.Ye,oa.a.hu);za.tabIndex=0;ha.insertBefore(za,N);t=Ga.createClusteredImage(16,16,Xf.IJh,Xf.KJh,!0,"");za.appendChild(t);t=t.childNodes[0];t.className=Ga.getImageClass(Xf.I2e);t.title=CommonUIStrings.l_Expand;za.title=CommonUIStrings.l_Expand;N.style.visibility="hidden";N=new xn(N,
za,t);Array.add(this.kYa,N);this.en.fU(la.a.click,za,this.Dqd,N);this.Lg.fU(la.a.Xf,za,this.Ojb,N);this.Lg.fU(la.a.Qx,za,this.Ojb,N);this.Lg.fU(la.a.wl,za,this.Ojb,N);return ha}$bi(t){this.wOf(t);return!0}aci(t){return this.CWc(t,Object(r.a)(this,this.wOf,"changeArrowState"))}wOf(t){t=t.TC;"visible"===t.bJe.style.visibility?(t.bJe.style.visibility="hidden",t.a3.className=Ga.getImageClass(Xf.I2e),t.a3.title=CommonUIStrings.l_Expand,t.Wub.title=CommonUIStrings.l_Expand):(t.bJe.style.visibility="visible",
t.a3.className=Ga.getImageClass(Xf.VZh),t.a3.title=CommonUIStrings.l_Collapse,t.Wub.title=CommonUIStrings.l_Collapse)}btk(t){this.h4g(t);return!0}ctk(t){return this.CWc(t,Object(r.a)(this,this.h4g,"optionHandler"))}h4g(t){const N=this.mad[t.TC.toString()];N.value?(N.value=0,N.a3.className=Ga.getImageClass(Xf.GZh),N.i4g.setAttribute(oa.a.NIf,oa.a.lqa)):(N.value=1,N.a3.className=Ga.getImageClass(Xf.OKh),N.i4g.setAttribute(oa.a.NIf,oa.a.KB));this.rwl(t.TC.toString(),N.value.toString())}nnl(){this.WO.select()}static Aag(t,
N,ha){if(!Xf.Ozd){const za=String.format('<a target="_blank" href="{0}">{1}</a>',gb.a.t3b("https://office.com"),CommonUIStrings.l_Office),Ra=String.format('<a target="_blank" href="{0}">{1}</a>',gb.a.t3b("https://office.com/webapps"),CommonUIStrings.l_WebAppName);Xf.Ozd=String.format(CommonUIStrings.l_NoFrames,za,Ra)}return String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',gb.a.t3b(t),N,ha,Xf.Ozd)}}Xf.Ozd=null;Xf.OKh="CheckboxChecked_16x16x32";Xf.GZh="CheckboxUnchecked_16x16x32";
Xf.VZh="OutlookSearchChevronUp_16x16x32";Xf.I2e="OutlookSearchChevronDown_16x16x32";Xf.IJh="UpArrowServer";Xf.xWh="EmbedSectionHeader";Xf.yWh="EmbedSectionName UIFontBold";Xf.aOh="EmbedCodeFooter";Xf.GUh="EmbedPreviewFrame";Xf.dNh="EmbedCodeTextArea";Xf.AMh="EmbedDimensionSection";Xf.KJh="EmbedArrowIcon";Xf.HJh="WACGlyph EmbedArrowHolder";Xf.eNh="EmbedCode";Xf.f3e="EmbedCodeHeader";Xf.zsf="Preview";Xf.IUh="PreviewHeader";Xf.MTh="Options";Xf.JJh="Arrow";Xf.e3e="EmbedCodeFooter";Object(h.a)(Xf,"EmbedDialog",
ad.a,[]);class Nc extends Xf{constructor(t,N){super(t,!0);N&&N&&!isNaN(N)||K.a.J(539762772,820,10,"Invalid aspectRatio in ReactEmbedDialog");this.iDh(Ci.a.Cuk,N.toString())}nIb(){const t=[];t.push({["id"]:"wdEaaCheck",["checkboxInitialValue"]:!1,["checkboxLabel"]:ResourceStrings.l_AutoAdvanceLabel,["urlTransformFunctionOnChange"]:Nc.TJk});this.Ssh({["dimensionsOptions"]:{["isMultipleChoice"]:!1,["defaultWidth"]:this.g3e,["defaultHeight"]:this.Isc,["minWidth"]:375,["minHeight"]:250,["widthLabel"]:ResourceStrings.l_EmbedSlideWidth,
["heightLabel"]:ResourceStrings.l_EmbedSlideHeight},["interactionOptions"]:t})}static TJk(t,N,ha){return"wdEaaCheck"===N?jb.a.Ri(t,N,ha?"1":"0"):t}}Object(h.a)(Nc,"ReactEmbedDialog",Xf,[]);class Jf{constructor(t,N,ha,za,Ra){this.KEa=null;this.fje=!1;this.tUa=null;this.Ob=t;this.mle=N;this.c9b=ha;this.Fle=za;this.Xa=Ra}nIb(t,N,ha){(t=(t=v.AFrameworkApplication.rO)||this.Xa.Gca)||this.fje||(t=!this.Yzh());return 1===ha?t?2:32:this.wdl()}wdl(){if(!this.fje)return 8;if(v.AFrameworkApplication.Mub&&this.c9b)this.gsh();
else{const t=v.AFrameworkApplication.YVe?this.tUa.sendMessage(Yd.a.GSi,null)?32:8:2;return 32!==t?this.Ob.mO(!0,v.AFrameworkApplication.hXd):t}return 32}vdl(t){t.Values.HostEmbeddedViewUrl&&(this.c9b=v.AFrameworkApplication.Mub=t.Values.HostEmbeddedViewUrl.toString(),this.gsh())}Yzh(){return!1}D1h(t,N){this.KEa=N;this.fje=!!this.Ob&&!!this.mle&&!(void 0===this.c9b||null===this.c9b)&&!!t&&!!N}gsh(){(new Nc(this.c9b,this.KEa)).nIb()}}Object(h.a)(Jf,"EmbedManager",null,[]);class fl{constructor(t,N,ha){this.KEa=
null;this.r3j={};for(N=0;N<t.length;N++)this.r3j[t[N].Format.toString()]=N;this.KEa=ha&&!isNaN(ha)&&isFinite(ha)?ha:0}}Object(h.a)(fl,"FormatPicker",null,[]);class Xj extends Jf{constructor(t,N,ha,za,Ra,qb,Qb,vc){super(t,N,ha,qb,Qb,vc);this.ia=za;this.Qb=Ra}ub(){this.ia.ya(vb.a.nIb,pb.a.application,Object(r.a)(this,this.nIb,"showEmbedDialog"));this.Fle.execute(Object(r.a)(this,this.Hec,"onHostPostmessengerCreated"))}xe(){}Yzh(){var t=this.Qb.su();if(!this.mle||!t.height)return!1;t=t.width/t.height;
const N=new fl(this.mle,!1,t);this.D1h(N,t);return!0}Hec(t){this.tUa=t;v.AFrameworkApplication.isEmbedded||v.AFrameworkApplication.Mub||!this.tUa||(this.tUa.fu(Yd.a.wNf),this.tUa.kB(Yd.a.wNf,Object(r.a)(this,this.vdl,"showEmbedDialogPostMessage")))}}Object(h.a)(Xj,"EmbedActor",Jf,[229]);var ff=d(39),rl=d(716),Jj=d(668);class ba{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id){this.ia=t;this.Hbb=N?N.xa:null;this.ua=ha;this.Xb=za;this.nb=Ra;this.Yx=qb;this.Fb=Qb;this.Dm=vc;this.Md=Zc;this.Yxb=null;this.Fa=
Wc;this.Xs=ha.presentation;this.Fe=Md;this.jg=null;this.rbb=Id}ub(){this.ia.pa(vb.a.gel,ff.a.application,Object(r.a)(this,this.jsj,"handleUploadAudioDialog"),4)}xe(){}jsj(t,N,ha){const za=this.ua.Ba;if(!za||this.Xb.Zc(za))return 16;if(1===ha)return 32;if(this.Hbb){this.jg=Aa.a.Pl("Audio::Insert");try{return Jj.a.JOe("audio/*",rl.b,()=>rl.a(t,Object(r.a)(this,this.sBj,"insertAudioSuccessAfterUploadUsingMediaUpload"),"audio",this.Fe,za),"audio",za,this.ua.presentation,this.Xb,this.Md,this.jg,!1,this.rbb,
50,10,3),this.jg&&this.jg.Wa("AudioDialogInitialized","true"),32}catch(Ra){K.a.J(509724633,818,10,"Error while rendering new audio selection dialog.")}}else return K.a.J(512500560,822,15,"Insert Audio initialization failed."),8;this.showErrorMessage(446,null);return 8}showErrorMessage(t,N){this.jg&&(this.jg.finish(),this.jg=null);this.Md.FG(t,ha=>{ha.NB=1;ha.XPa=N;return!1})}sBj(t,N,ha,za,Ra,qb,Qb){za.rN(ha)&&K.a.J(512500553,822,15,"Audio::InsertAudioSuccessAfterUploadUsingMediaUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+ha.Uha);za.GJ(ha);Ra&&Ra.Wa("AudioUploadToRC","true");Object(dd.a)("FixForInsertMediaSlideNavigationIssue")||(Qb=this.ua.Ba);ha=Qb.ev();var vc=this.Xs.slideWidth,Zc=this.Xs.slideHeight;za=fd.a.Ff(32,0);const Wc=fd.a.Ff(32,1);vc=vc/2-fd.a.Ff(16,0);Zc=Zc/2-fd.a.Ff(16,1);if(Qb&&Qb.isConnected){var Md=this.Fb.ud(15,void 0,void 0,()=>{this.Yx.CI=this.Yxb;this.nb.selectShape(this.Yxb,!0);this.Fa.Ad()});try{Md.kc(Qb);Md.fd=t;Ra&&Ra.Wa("CreatingAudioShape","true");this.Yxb=this.Dm.Y4a(!1,Qb.Bb.cid,
Qb.Bb.sid,0,10,vc,Zc,za,Wc,ha+1);const Id=qb.files[0].name;this.Yxb.SUb=N;this.Yxb.RUb=Id;Qb.GB(this.Yxb)}finally{Md&&Md.dispose()}Ra&&(Ra.Wa("AudioShapeSuccessfullyCreated","true"),Ra.finish(),Ra=null)}}}Object(h.a)(ba,"InsertAudioActor",null,[229]);class Zl{constructor(){this.avb=this.wob=null}}Object(h.a)(Zl,"CreatePickerCustomizationDictionaryOptions",null,[1541]);var bg=d(162),vi=d(27);class Vg{}Vg.mg="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";
Object(h.a)(Vg,"InsertMediaDialogHtml",null,[]);class Di{}Di.mg="<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";Object(h.a)(Di,"InsertMediaM365DialogHtml",null,[]);var Ei=d(453);class Li{static get mg(){return ad.a.UB(Li.fo,ResourceStrings.l_InsertOnlineVideoDescription,ResourceStrings.l_InsertOnlineVideoPrivacy,ResourceStrings.L_LearnMore,
"http://go.microsoft.com/fwlink/?linkid=2010177")}}Li.fo="<div class='VideoUrl' id='videourl'> <label id='labelVideoUrl' class='WACDialogLabel' for='url' >{0}</label> </div> <div class='VideoUrl' id='videourl'> <input type='text' id='url' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='VideoOutput' id='videooutput'> <label id='privacyandtos' class='WACDialogLabel' >{1}</label> </div> <div class='LearnMore' id='learnmore'> <a id='learnmore' class='LearnMore' href={3} target='newtab' >{2}</a> </div> <div class='VideoOutput' id='videooutput'> <label id='labelmessage' class='WACDialogLabel' >message</label> </div>";
Object(h.a)(Li,"InsertOnlineVideoDialogHtml",null,[]);class Kl extends ad.a{constructor(t){super();this.JC(1,!0);this.Ue(1,ResourceStrings.L_Insert);this.mg=Li.mg;this.W8=t;this.cV=!1}n5(){this.width=50;this.tj(ResourceStrings.L_OnlineVideo,Object(r.a)(this,this.QBj,"insertOnlineVideoDialogHandler"),{["url"]:""});document.getElementById("labelmessage").innerText="";document.getElementById("labelmessage").setAttribute(oa.a.SKd,oa.a.Pbi);const t=document.getElementById("url");this.JC(1,!!t&&0<t.value.length);
zd.a.addHandler(t,la.a.input,Object(r.a)(this,this.V9c,"onPatternChanged"));zd.a.addHandler(t,la.a.change,Object(r.a)(this,this.V9c,"onPatternChanged"));this.bR(t)}hide(){const t=document.getElementById("url");t&&(zd.a.removeHandler(t,la.a.input,Object(r.a)(this,this.V9c,"onPatternChanged")),zd.a.removeHandler(t,la.a.change,Object(r.a)(this,this.V9c,"onPatternChanged")));super.hide()}QBj(t,N){if(1===t){if(N){var ha=Aa.a.Pl("InsertOnlineVideo",1);ha.Kr=!0;t=N.url.trim();(t=this.W8.LQi(t))?this.W8.FAg(t)&&
this.W8.uSj(t)?(K.a.J(512500548,352,50,"[Insert Online Video] Creating Hubble request for {0}",this.W8.qag(t)),this.W8.requestVideoData(t,za=>{Aa.a.cF(ha,()=>{this.kY(za)})},Object(r.a)(this,this.NRi,"failCallback"))):(K.a.J(512500547,352,10,"[Insert Online Video] Dialog url doesn't match, given url: "+this.W8.qag(t)),this.fail(null,ResourceStrings.l_InsertOnlineVideoUnsupportedProvider)):(K.a.J(512500549,352,10,"[Insert Online Video] Dialog url is null!"),this.fail(null,ResourceStrings.l_InsertOnlineVideoIframeError))}}else this.hide()}kY(t){this.hide();
this.W8.isg(t)}NRi(t){this.fail(t,ResourceStrings.l_CannotInsertOnlineVideo)}fail(t,N){if(document.getElementById("labelmessage")){var ha=+new Date-+this.W8.startTime;document.getElementById("labelVideoUrl").removeAttribute("for");document.getElementById("labelmessage").innerText=N;document.getElementById("labelmessage").setAttribute("for","url");document.getElementById("url").focus();t&&K.a.J(512500545,352,10,"InsertOnlineVideoDialog:Fail {0}",JSON.stringify({["TimeMs"]:ha,["ResponseCode"]:t.data.Le}))}else K.a.J(512500546,
352,15,"[Insert Online Video] Request failed after the dialog dissapeared!")}V9c(){Aa.a.O9a();const t=document.getElementById("url");this.JC(1,!!t&&0<t.value.length)}}Object(h.a)(Kl,"InsertOnlineVideoDialog",ad.a,[816]);class gl{static get mg(){return ad.a.UB(gl.fo,ResourceStrings.l_InsertCameoExpDialogContent,ResourceStrings.L_LearnMore,"https://aka.ms/pptocameoblog")}}gl.fo="<div class='CameoExperimentTextDiv' id='cameoexperimenttextdiv'> <label id='cameoexperimenttext' class='WACDialogLabel' >{0}</label> </div> <div class='cameoexperimentlearnmorediv' id='CameoExperimentLearnMoreDiv'> <a id='cameoexperimentlearnmore' class='CameoExperimentLearnMore' href={2} target='newtab' >{1}</a> </div>";
Object(h.a)(gl,"InsertCameoDialogHtml",null,[]);class lm extends ad.a{constructor(){super();this.JC(1,!0);this.mg=gl.mg;this.yd=0}n5(){this.width=50;this.tj(ResourceStrings.l_InsertCameoExpDialogTitle);const t=document.getElementById("cameoexperimentlearnmore");t&&(t.onclick=()=>K.a.J(520119896,352,50,"InsertCameoDialog::showAndFocus : Click on learn more of insert cameo"))}}Object(h.a)(lm,"InsertCameoDialog",ad.a,[815]);var Gm=d(1064),Gh=d(59);class bf{constructor(t,N,ha){this.IOb=kg.a.tqa;this.YF=
null;this.Ca=t;this.JOb=N;this.bAa=ha}get kn(){return this.Ca}get W6(){return this.YF||(this.YF=u.a.instance.resolve("Common.Utils.IAriaNotifier"))}get Iy(){return this.IOb}set Iy(t){this.IOb=t}Gsa(t){try{m.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",t.length);const N=this.JOb.LBk(t);let ha=2;if(N&&0<N.length){const za=new Gm.DictionaryPropertySet;za.setValue(Gh.a.bU,N);za.setValue(Gh.a.kUc,!0);if(this.bAa){const Ra=this.bAa.KPe();Ra.rCc("insertOnlineImage");
za.setValue(Gh.a.BOa,Ra)}v.AFrameworkApplication.fa.ka("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.W6.sendNotification(Box4Intl.Box4Strings.l_ImageUploading,!0);ha=this.Ca.La(this.Iy,2,za)}m.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",t.length,32===ha,""===N)}catch(N){m.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",N.toString())}}}
Object(h.a)(bf,"InsertOnlineImageHandler",null,[736]);class Ll extends bf{constructor(t,N,ha=null){super(t,N,ha)}get TVf(){return Yd.a.insertImage}get Lub(){return Yd.a.IBj}y5g(t){return this.JOb.Hvk(t)}Xeg(t){return t.Type}TTc(t,N){return this.JOb.TTc(t.Type,N)}z5g(t){const N=[];if(t&&t.data&&t.data.value&&0<t.data.value.length)for(let za=0;za<t.data.value.length;za++)if(t.data.value[za]&&t.data.value[za].urls&&t.data.value[za].urls.download){var ha=t.data.value[za];ha=Object.assign(new Xl.a,{OriginalUrl:ha.urls.download,
Type:ha.extension||"",Caption:ha.name,ContentType:"",Height:ha.driveItem||ha.driveItem.image?ha.driveItem.image.height:0,Width:ha.driveItem||ha.driveItem.image?ha.driveItem.image.width:0});Array.add(N,ha)}N.length||m.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");return N}D9g(t,N,ha){ha=ha(t);if(ha.length){t=[];for(let za=0;za<ha.length;za++){const Ra=ha[za],qb={};qb.Extension=Ra.Type;qb.SourceUrl=Ra.OriginalUrl;qb.SourceUrl=
Ra.OriginalUrl;qb.Width=Ra.Width;qb.Height=Ra.Height;Array.add(t,qb)}ha={};ha.Items=t;N.sendMessage(this.Lub,ha)}}}Object(h.a)(Ll,"InsertOnlineImageHelperBox4",bf,[735,736]);class Hm extends Ll{constructor(t,N,ha){super(t,N);this.hte=ha.insertOnlineVideoUrlPatterns;this.Iy=vb.a.M8d}Gsa(t){if(t&&0<t.length){var N=jb.a.yD(t[0].OriginalUrl);N=this.Bce(N)?N:"unsupported";K.a.J(512517837,352,50,"InsertMediaCallback: Insert online video called for {0}",N);this.kn.La(this.Iy,2,t[0])}}Bce(t){if(!t)return!1;
t=t.trim();for(const N of this.hte)if((new RegExp(N)).test(t))return!0;return!1}}Object(h.a)(Hm,"InsertOnlineVideoHelper",Ll,[]);class re{static get mg(){return ad.a.UB(re.fo,ResourceStrings.l_InsertSocialMediaDialogMsg)}}re.fo="<div class='WACDialogRow' id='block1'> <div class='WACDialogGroupBox' id='SocialmediaLabelDiv' style=\"width:300px;word-wrap: break-word;\"> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> </div>";Object(h.a)(re,"InsertSocailMediaDialogHtml",null,[]);var M=
d(84),ca=d(242);class Na extends Sys.EventArgs{constructor(t,N,ha,za){super();this.slideId=t;this.jY=ha;this.shapeId=N;this.lDa=za}}Object(h.a)(Na,"IconChangedEventArgs",Sys.EventArgs,[]);var zb=d(486),$b=d(260);class Tc{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of,ih,Aj,$f,Oi,wk,Ti,mn,ki,nn,to,So,on,Dl,Fk,El){this.s1c=this.RTc=!1;this.xBb=this.moe=null;this.la=t;this.ia=N;this.Xb=ha;this.ra=za;this.Fa=Ra;this.ua=qb;this.Fb=Qb;this.v0c=vc;this.v4j=Zc;this.u0c=Wc;this.P3=Md;this.r$a=Id;this.vda=
Xe;this.Ita=of;this.Qb=ih;this.Dm=Aj;this.Ea=$f;this.Mb=Oi;this.Yx=wk;this.ol=Ti;this.Abb=mn;this.AUa=So;this.Pne=on;this.Lc=Dl;this.rT=t.KEb;this.fc=El;this.Abb&&(this.Abb.f6a.removeAttribute("style"),this.Abb.f6a.style.display="none");this.mpe=ki;this.w4j=nn;this.W8=to;this.u3=Fk;this.r$a.execute(Mn=>{Mn.isFeatureEnabled("MsoPremiumStockImages",!1).catch(qm=>K.a.J(593627152,352,10,"InsertMediaActor::Constructor - Failed to load the premium state from application feature helper: {0}",qm)).then(qm=>
{this.s1c=qm;this.s1c||(this.moe=Mn.sfb("MsoPremiumStockImages",()=>{this.s1c=!0;K.a.J(512517962,352,50,"InsertMediaActor::Constructor - Thanks for purchasing!")}));return null})})}ub(){this.o2h();this.ia.pa(vb.a.nSc,ff.a.application,Object(r.a)(this,this.Bzl,"uploadIcon"),4);dd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa(vb.a.nEc,ff.a.application,Object(r.a)(this,this.Cmi,"changeToIcon"),4):this.ia.pa(vb.a.nEc,ff.a.application,Object(r.a)(this,this.Dmi,"changeToIcon"),4);this.ia.pa(vb.a.B8a,
ff.a.application,Object(r.a)(this,this.iod,"uploadOnlinePicture"),4);dd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa(vb.a.XVb,ff.a.application,Object(r.a)(this,this.sEc,"changeToOnlinePicture"),4):this.ia.pa(vb.a.XVb,ff.a.application,Object(r.a)(this,this.tEc,"changeToOnlinePicture"),4);this.ia.pa(vb.a.qSc,ff.a.application,Object(r.a)(this,this.iod,"uploadOnlinePicture"),4);dd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa(vb.a.pEc,ff.a.application,Object(r.a)(this,this.sEc,"changeToOnlinePicture"),
4):this.ia.pa(vb.a.pEc,ff.a.application,Object(r.a)(this,this.tEc,"changeToOnlinePicture"),4);this.ia.pa(vb.a.rSc,ff.a.application,Object(r.a)(this,this.iod,"uploadOnlinePicture"),4);dd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa(vb.a.WVb,ff.a.application,Object(r.a)(this,this.sEc,"changeToOnlinePicture"),4):this.ia.pa(vb.a.WVb,ff.a.application,Object(r.a)(this,this.tEc,"changeToOnlinePicture"),4);this.n2h();this.ia.pa(vb.a.mpg,ff.a.application,Object(r.a)(this,this.iod,"uploadOnlinePicture"),
4);dd.a("ChangePictureOnMultiSelectFixEnabled")?this.ia.pa(vb.a.MNd,ff.a.application,Object(r.a)(this,this.sEc,"changeToOnlinePicture"),4):this.ia.pa(vb.a.MNd,ff.a.application,Object(r.a)(this,this.tEc,"changeToOnlinePicture"),4);this.p2h();this.m2h();this.ia.pa(vb.a.M8d,ff.a.application,Object(r.a)(this,this.Ezl,"uploadOnlineVideo"),4);this.ia.pa(vb.a.K8d,ff.a.application,Object(r.a)(this,this.Dzl,"uploadOnlineHubbleVideo"),4);this.ia.pa(vb.a.A$g,pb.a.application,Object(r.a)(this,this.twl,"updateEntryPoints"),
96)}o2h(){this.ia.pa(vb.a.I8d,ff.a.application,Object(r.a)(this,this.oJa,"showInsertMediaDialogFromM365"),4);this.ia.pa(vb.a.VVb,ff.a.application,Object(r.a)(this,this.oJa,"showInsertMediaDialogFromM365"),4);this.ia.pa(vb.a.insertOnlinePicture,ff.a.application,Object(r.a)(this,this.hOe,"showInsertPictureDialog"),4);this.ia.pa(vb.a.NNd,ff.a.application,Object(r.a)(this,this.hOe,"showInsertPictureDialog"),4);dd.a("InsertSocialMediaVideoIcon")&&this.ia.pa(vb.a.eCj,ff.a.application,Object(r.a)(this,this.jel,
"showInsertSocialMediaDialog"),4);dd.a("InsertDalleIcon")&&(this.ia.pa(vb.a.gpg,ff.a.application,Object(r.a)(this,this.oJa,"showInsertMediaDialogFromM365"),4),this.ia.pa(vb.a.hpg,ff.a.application,Object(r.a)(this,this.oJa,"showInsertMediaDialogFromM365"),4));this.ia.pa(vb.a.pSc,ff.a.application,Object(r.a)(this,this.oJa,"showInsertMediaDialogFromM365"),4);this.ia.pa(vb.a.oEc,ff.a.application,Object(r.a)(this,this.oJa,"showInsertMediaDialogFromM365"),4);this.ia.pa(vb.a.L8d,ff.a.application,Object(r.a)(this,
this.oJa,"showInsertMediaDialogFromM365"),4);this.ia.pa(vb.a.b4b,ff.a.application,Object(r.a)(this,this.iOe,"showInsertPictureFromHostDialog"),4);this.ia.pa(vb.a.ONd,ff.a.application,Object(r.a)(this,this.iOe,"showInsertPictureFromHostDialog"),4);this.la.ocpsIsEnabled&&(this.ia.yfb("ppt_insertOnlinePictures",vb.a.insertOnlinePicture,ff.a.application,Object(r.a)(this,this.hOe,"showInsertPictureDialog"),t=>{vi.App.Hb.YZa(t,Object(r.a)(this.u3,this.u3.wCa,"getCommandById"))}),this.ia.yfb("ppt_insertOnlinePictures",
vb.a.pSc,ff.a.application,Object(r.a)(this,this.oJa,"showInsertMediaDialogFromM365"),t=>{vi.App.Hb.YZa(t,Object(r.a)(this.u3,this.u3.wCa,"getCommandById"))}),this.ia.yfb("ppt_insertOnlinePictures",vb.a.L8d,ff.a.application,Object(r.a)(this,this.oJa,"showInsertMediaDialogFromM365"),t=>{vi.App.Hb.YZa(t,Object(r.a)(this.u3,this.u3.wCa,"getCommandById"))}),this.ia.yfb("ppt_insertOnlinePictures",vb.a.b4b,ff.a.application,Object(r.a)(this,this.iOe,"showInsertPictureFromHostDialog"),t=>{vi.App.Hb.YZa(t,
Object(r.a)(this.u3,this.u3.wCa,"getCommandById"))}))}n2h(){this.la.uSc&&this.fc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)&&(this.ia.pa(vb.a.Q8d,ff.a.application,Object(r.a)(this,this.Cjd,"showInsertPictureFromMobileDeviceDialog"),4),this.ia.pa(vb.a.QNd,ff.a.application,Object(r.a)(this,this.Cjd,"showInsertPictureFromMobileDeviceDialog"),4),this.la.ocpsIsEnabled&&(this.ia.yfb("mso_insertMobileDevicePictures",vb.a.Q8d,ff.a.application,Object(r.a)(this,
this.Cjd,"showInsertPictureFromMobileDeviceDialog"),t=>{vi.App.Hb.YZa(t,Object(r.a)(this.u3,this.u3.wCa,"getCommandById"))}),this.ia.yfb("mso_insertMobileDevicePictures",vb.a.QNd,ff.a.application,Object(r.a)(this,this.Cjd,"showInsertPictureFromMobileDeviceDialog"),t=>{vi.App.Hb.YZa(t,Object(r.a)(this.u3,this.u3.wCa,"getCommandById"))})))}p2h(){this.ia.pa(vb.a.ADa,ff.a.application,Object(r.a)(this,this.tIb,"showInsertVideoDialog"),4);this.la.ocpsIsEnabled&&this.ia.yfb("ppt_insertOnlineVideos",vb.a.ADa,
ff.a.application,Object(r.a)(this,this.tIb,"showInsertVideoDialog"),t=>{vi.App.Hb.YZa(t,Object(r.a)(this.u3,this.u3.wCa,"getCommandById"))})}m2h(){$b.a(this.fc.appSettings,"InsertCameoExperimentEnabled",!1)&&this.fc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertCameoExperimentEnabled",!1)&&this.ia.pa(vb.a.MBj,ff.a.application,this.hel.bind(this),4)}NBk(){v.AFrameworkApplication.h5b()&&v.AFrameworkApplication.Mrh()&&(v.AFrameworkApplication.Aa.get_element().appendChild(this.Abb.f6a),
zd.a.addHandler(this.Abb.f6a.contentWindow,"message",Object(r.a)(this,this.Nsh,"showOneDriveFilePickerDialog")),this.RTc=!0)}Nsh(t){if(t.rawEvent&&(t=t.rawEvent.data))try{K.a.J(512517961,352,50,"User select images.");const N=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0),ha=N.MessageId?N.MessageId.toString():null;N&&ha&&(ha===Yd.a.insertImage||ha===Yd.a.H8d)&&this.mpe.start(ha===Yd.a.insertImage?this.vda:this.w4j)}catch(N){K.a.J(512517960,352,10,"malformatted postmessage here.")}}xe(){}twl(){return 32}hOe(t,
N,ha){if(!this.l5(this.ua.Ba,t,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===ha)return 32;K.a.J(512517959,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");try{const za=Be.a.create(),Ra=gb.a.NM(this.la.pptEditingUserId).toString(),qb=t===vb.a.insertOnlinePicture&&this.la.uAk?1:0;let Qb=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,xd.a.oe(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,za.toString(),3,Ra,qb);0<this.la.insertPictureServiceEndpoint.search(RegExp("insertmedia.bing.office.net",
"gi"))&&(Qb=this.P3.Bgi(vi.App.mode,this.la.pptInsertOnlineContentImagesEnabled?this.la.insertOnlineContentImagesEndpoint:this.la.insertPictureServiceEndpoint));this.r$a.execute(vc=>{vc=this.v0c.getInstance(Qb,this.u0c,this.P3,vc,Vg.mg);vc.insertPictureTelemetryEndpoint=this.la.insertPictureTelemetryEndpoint;vc.correlationId=za;vc.C4=1;switch(t){case vb.a.NNd:this.Ita.Iy=vb.a.XVb;break;default:this.vda.Iy=vb.a.B8a}vc.sIb(CommonUIStrings.L_PictureInsertTitle,t===vb.a.insertOnlinePicture?this.vda:this.Ita);
K.a.J(512517958,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.")});return 32}catch(za){return K.a.J(512517957,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",za.toString()),Tc.it(M.a.e0b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}jel(t,N,ha){if(1===ha)return 32;t=new ad.a(void 0,void 0,!1);t.yd=5;t.mg=re.mg;t.tj(ResourceStrings.l_InsertSocialMediaDialogTitle,null,{["id"]:"SocialMediaExperimentDialog"});K.a.J(512517956,
352,15,"InsertMediaActor::ShowInsertSocialMediaDialog : Show dialog.");return 32}oJa(t,N,ha){if(!this.l5(this.ua.Ba,t,this.la.A8a))return 8;if(1===ha)return 32;let za,Ra;switch(t){case vb.a.pSc:case vb.a.L8d:N=new Zi.QueryStringBuilder(this.la.opg);this.fc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertDalle",!1)&&N.Ti("dalle","1");za=N.toString();Ra=1;this.vda.Iy=vb.a.qSc;break;case vb.a.gpg:case vb.a.hpg:N=new Zi.QueryStringBuilder(this.la.opg);N.Ti("dalle","1");N.Cz("initpivot",
"dalle");za=N.toString();Ra=1;this.vda.Iy=vb.a.qSc;break;case vb.a.I8d:za=this.la.oSc;Ra=1;this.vda.Iy=vb.a.nSc;break;case vb.a.VVb:dd.a("ChangePictureFromIconsFixEnabled")?(za=this.la.oSc,this.Ita.Iy=vb.a.pEc):(za=this.la.qmi,this.Ita.Iy=vb.a.nEc);Ra=0;break;case vb.a.oEc:za=this.la.rmi;Ra=0;this.Ita.Iy=vb.a.pEc;break;default:return K.a.J(512517955,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : unrecognized actionId",t.toString()),16}if(!za||!za.length)return 16;K.a.J(512517954,352,50,
"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog.");try{const qb=Be.a.create(),Qb=gb.a.NM(this.la.pptEditingUserId).toString();this.r$a.execute(vc=>{var Zc=this.la.PBj&&vc.isFreemiumUpsellEnabled();Zc=this.s1c?1:Zc?0:-1;var Wc=this.fc.ka("InsertOnlineM365ExperimentEnabled")?1:0;Wc=this.P3.Agi(vi.App.mode,za,Zc,Ra,qb.toString(),Qb,Wc);vc=this.v0c.getInstance(Wc,this.u0c,this.P3,vc,Di.mg);vc.correlationId=qb;vc.C4=2;vc.DTd=Zc;vc.sIb(CommonUIStrings.L_PictureInsertTitle,t===vb.a.VVb||t===
vb.a.oEc?this.Ita:this.vda);K.a.J(512517953,352,50,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Show dialog success.")});return 32}catch(qb){return K.a.J(512517952,352,10,"InsertMediaActor::ShowInsertMediaDialogFromM365 : Exception = [{0}]",qb.toString()),Tc.it(M.a.e0b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}iOe(t,N,ha){if(!this.l5(this.ua.Ba,t,v.AFrameworkApplication.h5b()&&(Tc.olg?!!this.mpe.PDb&&9<this.mpe.PDb.length:!0)))return 8;if(1===ha)return 32;
K.a.J(512517923,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{N=!0;let za=0;if(this.fc.ka("InsertMediaSharedFilePickerEnabled")){const qb=u.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(qb.ece()){N=!1;const Qb=this.la.qpg;ha=!1;this.la.uSc&&(ha=this.mZi());const vc=Object.assign(new Zl,{wob:ha,avb:!0}),Zc=qb.ZQd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,!0,Qb,"InsertPicture",0,vc);qb.$_d(Zc).then(Wc=>
{if(Wc&&0<Wc.length){const Md=[];for(let Id=0;Id<Wc.length;Id++){const Xe=Wc[Id][Kd.a.AAe],of={};of.Extension=Wc[Id][Kd.a.I6g];of.OriginalUrl=Kd.a.vAe in Wc[Id]?Wc[Id][Kd.a.vAe]:Xe;of.Type=Kd.a.wAe in Wc[Id]?Wc[Id][Kd.a.wAe]:"";of.Caption=Kd.a.zAe in Wc[Id]?Wc[Id][Kd.a.zAe]:"";of.Description=Kd.a.uAe in Wc[Id]?Wc[Id][Kd.a.uAe]:"";of.Width=Kd.a.yAe in Wc[Id]?Wc[Id][Kd.a.yAe]:0;of.Height=Kd.a.xAe in Wc[Id]?Wc[Id][Kd.a.xAe]:0;Array.add(Md,of)}this.v7i(t).Gsa(Md);K.a.J(512517922,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : SharedFilePicker Show dialog success.")}za=
32}).catch(Wc=>{K.a.J(512517921,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",Wc.toString());Tc.it(M.a.e0b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture);za=8})}}if(!N)return za;Tc.olg=!0;this.RTc||this.NBk();const Ra=this.v4j.getInstance();Ra.C4=4;switch(t){case vb.a.ONd:this.Ita.Iy=vb.a.WVb;break;default:this.vda.Iy=vb.a.rSc}Ra.sIb(CommonUIStrings.L_PictureInsertTitle,t===vb.a.b4b?this.vda:this.Ita);K.a.J(512517920,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");
return 32}catch(za){return K.a.J(512517919,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",za.toString()),Tc.it(M.a.e0b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlinePicture),8}}v7i(t){if(!dd.a("ChangePictureFromOneDriveFixEnabled"))return this.vda;const N=(t=t===vb.a.b4b)?this.vda:this.Ita;N.Iy=t?vb.a.rSc:vb.a.WVb;return N}mZi(){return u.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").p0i()}Cjd(t,N,ha){if(!this.l5(this.ua.Ba,
t,this.la.uSc&&this.fc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InsertMediaSharedFilePickerEnabled",!1)))return 8;if(1===ha)return 32;u.a.instance.resolve("Common.App.PhoneLink.IPhoneLinkManager").wSi(this.fc.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OverridePhoneLinkEndpointToDogfoodEnabled",!1));try{let za=0;const Ra=u.a.instance.resolve("Common.App.SharedFilePicker.ISharedFilePicker");if(Ra.ece()){const qb=t===vb.a.Q8d,Qb=this.la.qpg,vc=Object.assign(new Zl,{wob:!0,avb:!0}),
Zc=Ra.ZQd(CommonUIStrings.l_ImageUploadButtonText,CommonUIStrings.l_ImageUploadingTitle,!0,!1,qb,Qb,"InsertPictureFromMobile",3,vc);Ra.$_d(Zc).then(Wc=>{if(Wc&&0<Wc.length){const Md=[];let Id=!1;const Xe=this.fc.Ga("PhoneLinkServiceEndpoint");for(let of=0;of<Wc.length;of++){const ih=Wc[of][Kd.a.AAe],Aj=Wc[of],$f={};$f.Extension=Wc[of][Kd.a.I6g];$f.OriginalUrl=this.qFb(Aj,Kd.a.vAe,ih);$f.Type=this.qFb(Aj,Kd.a.wAe,"");$f.Caption=this.qFb(Aj,Kd.a.zAe,"");$f.Description=this.qFb(Aj,Kd.a.uAe,"");$f.Width=
this.qFb(Aj,Kd.a.yAe,0);$f.Height=this.qFb(Aj,Kd.a.xAe,0);Array.add(Md,$f);Id||(Id=-1!==$f.OriginalUrl.indexOf(Xe))}Wc=qb?this.vda:this.Ita;Wc.Iy=Id?qb?vb.a.mpg:vb.a.MNd:qb?vb.a.rSc:vb.a.WVb;Wc.Gsa(Md);K.a.J(512517918,352,50,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : SharedFilePicker Show dialog success.")}za=32}).catch(Wc=>{K.a.J(512517917,352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",Wc.toString());za=8})}return za}catch(za){return K.a.J(512517916,
352,10,"InsertMediaActor::ShowInsertPictureFromMobileDeviceDialog : Exception = [{0}]",za.toString()),8}}qFb(t,N,ha){return N in t?t[N]:ha}iod(t,N,ha,za,Ra){N=this.ua.Ba;if(!N)return K.a.J(512517915,352,50,"Active Slide is null"),8;if(!this.l5(N,t,this.la.pptInsertOnlinePictureEnabled))return 8;if(1===ha)return 32;if(!this.ol.yI(N,1))return this.ol.AJ(N),16;try{const qb=N.L2(this.ra.Yd());if(qb&&this.Xb.Zc(qb))return 16;const Qb=this.x7a(N,qb);let vc=null;const Zc=this.Fb.ud(15,void 0,()=>{this.ra.Cy();
this.ra.Uh();this.Fa.Ad()},()=>{this.ra.selectShape(Qb,!0);vc&&this.ra.selectShape(vc,!1)});try{Zc.kc(N);Zc.fd=vb.a.insertOnlinePicture;Zc.Dy[ca.a.PBa]=ca.a.online;ha=null;t={["actionId"]:t};if(this.la.pptInsertOnlinePictureAttributionIsEnabled)if(Ra.LicenseUrl&&Ra.LicenseDisplayName){const Wc=Tc.EBe(Ra);ha=bg.c(Wc);if(this.la.pptImageAttributionSelectionImprove){const Md=N.Bb;vc=this.Dm.Qqa(!0,Md.cid,Md.sid,0,0,0,fb.a.uX,fb.a.E4,N.ev()+1,!1)}}else t["result.LicenseDisplayName"]=Ra.LicenseDisplayName,
t["result.LicenseUrl"]=gb.a.NM(Ra.LicenseUrl);else t.IsEnabled=this.la.pptInsertOnlinePictureAttributionIsEnabled;K.a.J(512517914,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",t);Qb.vHb(Ra.OriginalUrl,Ra.LicenseUrl?null:Ra.Caption,ha,Ra.PageUrl);qb&&N.gU([qb]);N.GB(Qb);vc&&(N.GB(vc),Qb.P3a=vc.id,vc.m8a=!0)}finally{Zc&&Zc.dispose()}this.Yx.CI=Qb;return 32}catch(qb){return K.a.J(512517913,352,10,"InsertMediaActor::UploadOnlinePicture : Pic = [{0}], Exception = [{1}].",Ra.OriginalUrl,qb.toString()),
8}}tEc(t,N,ha,za,Ra){N=this.ua.Ba;if(!N)return K.a.J(512517912,352,50,"Active Slide is null"),8;if(!this.l5(N,t,this.la.YHa))return 8;if(1===ha)return 32;K.a.J(512517910,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Start changing.");if(!Ra)return 16;try{const qb=this.X6a()||this.vNc();if(!qb||this.Xb.Zc(qb))return 16;let Qb=null;const vc=this.Fb.ud(15,void 0,void 0,()=>{this.ra.selectShape(qb,!0);Qb&&this.ra.selectShape(Qb,!1);K.a.J(512517908,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Finish changing.")});
try{vc.kc(N);vc.fd=vb.a.XVb;vc.Dy[ca.a.PBa]=ca.a.online;t=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Ra.LicenseUrl&&Ra.LicenseDisplayName){const Zc=Tc.EBe(Ra);t=bg.c(Zc);if(this.la.pptImageAttributionSelectionImprove){const Wc=N.Bb;Qb=this.Dm.Qqa(!0,Wc.cid,Wc.sid,0,0,0,fb.a.uX,fb.a.E4,N.ev()+1,!1);K.a.J(512517907,352,50,"InsertMediaActor::changeToOnlinePictureSingleImage : Adding license info to attributionShapeNode.")}}qb.vHb(Ra.OriginalUrl,Ra.LicenseUrl?null:Ra.Caption,t,Ra.PageUrl);
qb.set_isSVGBlipFilled(!1);Qb&&(N.GB(Qb),qb.P3a=Qb.id,Qb.m8a=!0)}finally{vc&&vc.dispose()}this.Yx.CI=qb;return 32}catch(qb){return K.a.J(512517905,352,10,"InsertMediaActor::changeToOnlinePictureSingleImage : Pic = [{0}], Exception = [{1}].",Ra.OriginalUrl,qb.toString()),8}}sEc(t,N,ha,za,Ra){N=this.ua.Ba;if(!N)return K.a.J(512517911,352,50,"Active Slide is null"),8;if(!this.l5(N,t,this.la.YHa))return 8;if(1===ha)return 32;K.a.J(512517909,352,50,"InsertMediaActor::ChangeToOnlinePicture : Start changing.");
if(!Ra)return 16;try{var qb=this.ra.Yd();t=[];for(var Qb of qb)Qb.Jf||t.push(Qb);for(const Zc of t)if(!Zc||this.Xb.Zc(Zc))return 16;qb=null;const vc=this.Fb.ud(15,void 0,void 0);try{vc.kc(N);vc.fd=vb.a.XVb;vc.Dy[ca.a.PBa]=ca.a.online;Qb=null;if(this.la.pptInsertOnlinePictureAttributionIsEnabled&&Ra.LicenseUrl&&Ra.LicenseDisplayName){const Wc=Tc.EBe(Ra);Qb=bg.c(Wc);if(this.la.pptImageAttributionSelectionImprove){const Md=N.Bb;qb=this.Dm.Qqa(!0,Md.cid,Md.sid,0,0,0,fb.a.uX,fb.a.E4,N.ev()+1,!1);K.a.J(512517906,
352,50,"InsertMediaActor::ChangeToOnlinePicture : Adding license info to attributionShapeNode.")}}const Zc=Ra.LicenseUrl?null:Ra.Caption;for(const Wc of t)Wc.vHb(Ra.OriginalUrl,Zc,Qb,Ra.PageUrl),Wc.set_isSVGBlipFilled(!1),qb&&(N.GB(qb),Wc.P3a=qb.id,qb.m8a=!0)}finally{vc&&vc.dispose()}this.Yx.CI=t[0];return 32}catch(vc){return K.a.J(512517904,352,10,"InsertMediaActor::ChangeToOnlinePicture : Pic = [{0}], Exception = [{1}].",Ra.OriginalUrl,vc.toString()),8}}Bzl(t,N,ha,za,Ra){N=this.ua.Ba;if(!N)return K.a.J(512517903,
352,50,"Active Slide is null"),8;if(!this.l5(N,t,this.la.A8a))return 8;if(1===ha)return 32;K.a.J(512517902,352,50,"InsertMediaActor::UploadIcon : Start inserting.");if(!Ra||!Ra.length)return 16;if(!this.ol.yI(N,Ra.length))return this.ol.AJ(N),16;try{let qb=null;ha=null;if(!({Gxk:ha,wxk:qb}=this.ebj(Ra,N)).returnValue)return 16;const Qb=this.Fb.ud(15,void 0,()=>{this.ra.Cy();this.ra.Uh();this.Fa.Ad()},()=>{this.ra.mYa(qb,!0)});try{for(Qb.kc(N),Qb.fd=t,Qb.Dy[ca.a.PBa]=ca.a.icon,ha&&N.gU(ha),t=0;t<qb.length;t++)N.GB(qb[t])}finally{Qb&&
Qb.dispose()}this.Yx.CI=qb[qb.length-1];return 32}catch(qb){return K.a.J(512517901,352,10,"InsertMediaActor::UploadIcon : icon count = [{0}], Exception = [{1}].",Ra.length,qb.toString()),8}}ebj(t,N){let ha,za;ha=Array(t.length);za=Array(t.length);var Ra=N.JZd(this.ra.Yd());if(Ra&&0<Ra.length){var qb=0;for(const Qb of Ra)if(Qb&&!this.Xb.Zc(Qb)&&qb<t.length&&(ha[qb]=Qb,qb++,qb===t.length))break}Ra=!0;for(qb=0;qb<ha.length;qb++)this.la.svgIconLocalEditingIsEnabled&&t[qb].SvgContent&&0<t[qb].SvgContent.length&&
(!ha[qb]||ha[qb]&&15!==ha[qb].Cj)?za[qb]=this.cbj(N,ha[qb],t[qb],qb):(za[qb]=this.Ffg(N,ha[qb],t[qb],!0,qb),Ra=!1),Ra&&Aa.a.LO(!0,!0),za[qb].vHb(t[qb].OriginalUrl,t[qb].Caption,null,null);return{returnValue:!0,Gxk:ha,wxk:za}}cbj(t,N,ha,za){if(!t)return null;var Ra=t.Bb,qb=t.ev();let Qb;const vc=Object(Q.a)(553,t.oc(this.Mb.Ma));({cXd:Qb,MC:t}=this.AUa.HPd(N,ha.Width,ha.Height));za=N?0:za*Ei.a.a7;Ra=this.Dm.Qqa(!0,Ra.cid,Ra.sid,0,t.x+za,t.y+za,Qb.width,Qb.height,qb+1,!1);qb=this.AUa.ULd(this.Mb.Fd,
Qb,t,vc.bW);Ra.jU=qb;Ra.isResizable=!0;Ra.p5b=!0;Ra.ZK=!0;Ra.mHa=!0;Ra.set_isSVGBlipFilled(!0);ha=this.Pne.jZk(ha.SvgContent);Ra.Yca=ha?String.format("data:image/svg+xml;charset=utf8,{0}",encodeURIComponent(ha)):"";N&&(Ra.kba=N.id);return Ra}Cmi(t,N,ha,za,Ra){N=this.ua.Ba;if(!N)return K.a.J(512517900,352,50,"Active Slide is null"),8;if(!this.l5(N,t,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;if(1===ha)return 32;K.a.J(512517898,352,50,"InsertMediaActor::ChangeToIcon : Start changing.");if(!Ra||
!Ra.length)return 16;try{const qb=this.ra.Yd(),Qb=[];for(const Wc of qb)Wc.Jf||Qb.push(Wc);const vc=Ra[0].Caption;for(const Wc of Qb){if(!Qb||this.Xb.Zc(Wc))return 16;const Md=this.Ea.nr(Wc);vc&&Md&&this.Lc.Vah(new Na(N.Bb,Wc.get_shapeId(),Wc.get_smartArtModelId(),vc))}const Zc=this.Fb.ud(15,void 0,void 0,()=>{for(const Wc of Qb){const Md=this.Ea.nr(Wc);Md&&(this.Lc.wdd(),this.ra.selectShape(Md,!0),this.Lc.vdd())}K.a.J(512517896,352,50,"InsertMediaActor::ChangeToIcon : Finish changing.")});try{Zc.kc(Qb[0]);
Zc.fd=t;Zc.Dy[ca.a.PBa]=ca.a.icon;for(const Wc of Qb)Wc.set_isSVGBlipFilled(!0),Wc.vHb(Ra[0].OriginalUrl,vc,null,null)}finally{Zc&&Zc.dispose()}for(const Wc of Qb)this.Xb.sqa(N,Wc,this.Mb.Ma,t);return 32}catch(qb){return K.a.J(512517894,352,10,"InsertMediaActor::ChangeToIcon : icon count = [{0}], Exception = [{1}].",Ra.length,qb.toString()),8}}Dmi(t,N,ha,za,Ra){N=this.ua.Ba;if(!N)return K.a.J(512517899,352,50,"Active Slide is null"),8;if(!this.l5(N,t,this.la.pptSmartArtSubNodeIconChangeEnabled))return 8;
if(1===ha)return 32;K.a.J(512517897,352,50,"InsertMediaActor::changeToIconSingleIcon : Start changing.");if(!Ra||!Ra.length)return 16;try{const qb=this.vNc()||this.X6a();if(!qb||this.Xb.Zc(qb))return 16;const Qb=Ra[0].Caption,vc=this.Ea.nr(qb);Qb&&vc&&this.Lc.Vah(new Na(N.Bb,qb.get_shapeId(),qb.get_smartArtModelId(),Qb));const Zc=this.Fb.ud(15,void 0,void 0,()=>{vc&&(this.Lc.wdd(),this.ra.selectShape(vc,!0),this.Lc.vdd());K.a.J(512517895,352,50,"InsertMediaActor::changeToIconSingleIcon : Finish changing.")});
try{Zc.kc(qb),Zc.fd=t,Zc.Dy[ca.a.PBa]=ca.a.icon,qb.set_isSVGBlipFilled(!0),qb.vHb(Ra[0].OriginalUrl,Qb,null,null)}finally{Zc&&Zc.dispose()}(ha=vc||qb)&&this.Xb.sqa(N,ha,this.Mb.Ma,t);return 32}catch(qb){return K.a.J(512517893,352,10,"InsertMediaActor::changeToIconSingleIcon : icon count = [{0}], Exception = [{1}].",Ra.length,qb.toString()),8}}vNc(){let t=null;const N=this.ra.Yd();for(const ha of N)if(ha&&ha.get_isSVGBlipFilled())if(t)break;else t=ha;return t}X6a(){if(this.rT){const t=this.ra.Yd();
return t&&t.length?this.GKd(t)?t[0]:this.qtb():null}return this.qtb()}GKd(t){if(!t||!t.length)return!1;let N=t[0].wk,ha=1===t[0].mediaType;for(const za of t)N=N&&za.wk,ha=ha&&1===za.mediaType;return N||ha}qtb(){const t=this.ra.Yd();for(const N of t)if(N&&N.wk)return N;return null}RDg(t,N){const ha=this.fc.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");"defaultModal"!==ha&&K.a.J(t,352,15,`${N}::Modal:${ha}`)}tIb(t,N,ha){if(!this.l5(this.ua.Ba,t,this.la.pptInsertOnlineVideoEnabled))return 8;
if(1===ha)return 32;this.xBb=Aa.a.Pl("ShowInsertVideoDialog",1);const za=this.fc.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoModal","defaultModal");try{if(this.la.insertVideoOnlineFromHubbleEnabled){K.a.J(512517890,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video using Hubble");const qb=Be.a.create(),Qb=gb.a.NM(this.la.pptEditingUserId).toString();this.r$a.execute(vc=>{vc=this.v0c.getInstance(this.P3.Cgi(vi.App.mode,this.la.oCj,qb.toString(),Qb,this.la.Y8a,
this.la.Vwb,za),this.u0c,this.P3,vc,Di.mg);vc.correlationId=qb;vc.C4=5;const Zc=new Hm(this.ia,this.P3,this.la);Zc.Iy=vb.a.K8d;vc.sIb(CommonUIStrings.L_VideoInsertTitle,Zc)})}else this.la.insertVideoOnlineFromUrlEnabled?(K.a.J(512517889,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new Kl(this.W8)).n5()):(K.a.J(512517888,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.r$a.execute(qb=>{this.v0c.getInstance(this.P3.Dgi(vi.App.mode,this.la.insertVideoServiceEndpoint),
this.u0c,this.P3,qb,Vg.mg).sIb(CommonUIStrings.L_VideoInsertTitle,new Hm(this.ia,this.P3,this.la))}));this.RDg(512557208,"ShowInsertOnlineVideoDialog");null!=this.xBb&&Object(zb.a)(this.xBb.actionName,(new Date).getTime()-this.xBb.iD.getTime(),"InsertOnlineVideoDialog",this.xBb.actionId,this.xBb.Oj);const Ra=this.fc.getStringFeatureGate("Microsoft.Office.PowerPointOnline.InsertOnlineVideoToolTipMessage","InsertOnlineVideo");dd.a("LogInsertOnlineVideoCustomToolTip")&&"InsertOnlineVideo"!==Ra&&K.a.J(512517859,
352,15,"InsertOnlineVideo::ToolTipMessage : "+Ra);if("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo"in this.fc.dLc){const qb=this.fc.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.InsertSocialMediaVideo",!1)?"Visible":"NotVisible";K.a.J(512517858,352,15,"InsertOnlineVideo::SocialMediaIconIs"+qb)}K.a.J(512517857,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success.");return 32}catch(Ra){return K.a.J(512517856,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",
Ra.toString()),Tc.it(M.a.e0b,ResourceStrings.l_GenericDialogTitle,ResourceStrings.l_CannotInsertOnlineVideo),8}}hel(t,N,ha){if(!this.l5(this.ua.Ba,t,!0))return 8;if(1===ha)return 32;try{return K.a.J(512517855,352,50,"InsertMediaActor::ShowInsertCameoDialog : Insert cameo, creating dialog"),(new lm).n5(),32}catch(za){return K.a.J(512517854,352,10,"InsertMediaActor::ShowInsertCameoDialog : Exception = [{0}]",za.toString()),8}}Ezl(t,N,ha,za,Ra){N=this.ua.Ba;if(!N)return K.a.J(512517853,352,50,"Active Slide is null"),
8;if(!this.l5(N,t,this.la.pptInsertOnlineVideoEnabled))return 8;if(1===ha)return 32;if(!this.ol.yI(N,1))return this.ol.AJ(N),16;try{const qb=N.L2(this.ra.Yd());if(qb&&this.Xb.Zc(qb))return 16;const Qb=this.x7a(N,qb),vc=this.P3.Gjj(Ra.OriginalUrl);Qb.iLe(vc,Ra.ThumbnailUrl,Ra.Caption,Ra.Description,0<Ra.Width?Ra.Width:0,0<Ra.Height?Ra.Height:0);const Zc=this.Fb.ud(15,void 0,()=>{this.ra.Cy();this.ra.Uh();this.Fa.Ad()},()=>{this.ra.selectShape(Qb,!0)});try{Zc.kc(N),Zc.fd=t,qb&&N.gU([qb]),N.GB(Qb)}finally{Zc&&
Zc.dispose()}K.a.J(512517852,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video [{0}] is done.",Ra.OriginalUrl);this.Yx.CI=Qb;return 32}catch(qb){return K.a.J(512517851,352,10,"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",qb.toString()),8}}Dzl(t,N,ha,za,Ra){N=this.ua.Ba;if(!N)return K.a.J(512517850,352,50,"Active Slide is null"),8;if(!this.l5(N,t,this.la.insertVideoOnlineFromHubbleEnabled))return 8;if(1===ha)return 32;K.a.J(512517849,352,50,"InsertMediaActor::UploadOnlineHubbleVideo : Start inserting.");
if(!this.ol.yI(N,1))return this.ol.AJ(N),16;try{const qb=N.L2(this.ra.Yd());if(qb&&this.Xb.Zc(qb))return 16;const Qb=this.x7a(N,qb),vc=0<Ra.Width?Ra.Width:0,Zc=0<Ra.Height?Ra.Height:0;let Wc=Ra.PageUrl;this.la.Vwb&&"odspbusiness"===Ra.ProviderName.toLocaleLowerCase()&&(Wc=Ra.OriginalUrl);Qb.iLe(Wc,Ra.ThumbnailUrl,Ra.Caption,Ra.Description,vc,Zc);const Md=this.Fb.ud(15,void 0,()=>{this.ra.Cy();this.ra.Uh();this.Fa.Ad()},()=>{this.ra.selectShape(Qb,!0)});try{Md.kc(N),Md.fd=t,qb&&N.gU([qb]),N.GB(Qb)}finally{Md&&
Md.dispose()}this.RDg(512557200,"InsertOnlineHubbleVideo");K.a.J(512517848,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video [{0}] is done.",Ra.OriginalUrl);this.Yx.CI=Qb;return 32}catch(qb){return K.a.J(512517847,352,10,"InsertMediaActor::UploadOnlineHubbleVideo : Exception = [{0}].",qb.toString()),8}}l5(t,N,ha){t=!!t&&ha&&!this.Xb.Zc(t);switch(N){case vb.a.VVb:return t&&(!!this.X6a()||!!this.vNc());case vb.a.NNd:case vb.a.ONd:case vb.a.QNd:case vb.a.oEc:return t&&this.Nni();default:return t}}Nni(){const t=
this.X6a()||this.vNc();return t?this.Ea.nr(t)?!1:!0:!1}x7a(t,N){return this.Ffg(t,N,null,!1,0)}Ffg(t,N,ha,za,Ra){if(!t)return null;var qb=t.Bb;t=t.ev();let Qb;za?{width:ha,height:Qb}=Tc.Ygj(N,ha):(ha=fb.a.uX,Qb=fb.a.E4);let vc;vc=N?N.Ftb(ha,Qb):this.Qb.hsa(ha,Qb);Ra=N?0:Ra*Ei.a.a7;qb=this.Dm.Qqa(!0,qb.cid,qb.sid,0,vc.x+Ra,vc.y+Ra,ha,Qb,t+1,!0);qb.set_isSVGBlipFilled(za);N&&(qb.kba=N.id);return qb}dispose(){this.r$a.instance&&this.moe&&this.r$a.instance.HFb("MsoPremiumStockImages",this.moe);this.RTc&&
this.Abb.f6a.contentWindow&&(zd.a.removeHandler(this.Abb.f6a.contentWindow,"message",Object(r.a)(this,this.Nsh,"showOneDriveFilePickerDialog")),this.RTc=!1)}static jhi(){const t=CommonUIStrings.l_AttributionText.split(/[{}]+/);return Jl.e(t,N=>!!N)}static ygi(t,N){const ha=document.createElement("body");var za="";let Ra="",qb=CommonUIStrings.L_CCYYSA;void 0!==N&&null!==N&&(void 0!==N.PageUrl&&null!==N.PageUrl&&(za=N.PageUrl),void 0!==N.LicenseDisplayName&&null!==N.LicenseDisplayName&&0<N.LicenseDisplayName.length&&
(qb=N.LicenseDisplayName),void 0!==N.LicenseUrl&&null!==N.LicenseUrl&&(Ra=N.LicenseUrl));for(const Qb of t){switch(Qb){case "L_ThePhoto":t=Tc.$Kf(CommonUIStrings.l_ThePhoto,za);break;case "L_CCYYSA":t=Tc.$Kf(qb,Ra);break;case "L_PhotoAuthor":t=Tc.rLf(CommonUIStrings.l_PhotoAuthor);break;default:t=Tc.rLf(Qb)}t&&ha.appendChild(t)}za=document.createElement("html");za.appendChild(ha);return za}static rLf(t){const N=document.createElement("span");N.innerText=t;return N}static $Kf(t,N){const ha=document.createElement("A");
ha.setAttribute("href",N);ha.setAttribute("target","_blank");ha.setAttribute("rel","noreferrer");N=document.createElement("span");N.innerText=t;ha.appendChild(N);return ha}static EBe(t){const N=Tc.jhi();return Tc.ygi(N,t)}static it(){}static Ygj(t,N){let ha;t&&15===t.Cj?(ha=fd.a.Ie(t.LWe,0,!1),t=fd.a.Ie(t.s6d,0,!1)):N&&0<N.Width&&0<N.Height?(ha=N.Width,t=N.Height):(ha=fd.a.Ie(2,0,!1),t=fd.a.Ie(2,0,!1));return{width:ha,height:t}}}Tc.olg=!1;Object(h.a)(Tc,"InsertMediaActor",null,[229]);var hd=d(531);
class Hd{}Hd.nol=864E5;Hd.J8h=3;Hd.Zik=144E5;Object(h.a)(Hd,"AddinConstantsNum",null,[]);var le;(function(t){t[t.notSupported=-1]="notSupported";t[t.OMEX=0]="OMEX";t[t.spCatalog=1]="spCatalog";t[t.spApp=2]="spApp";t[t.fileSystem=3]="fileSystem";t[t.exchange=4]="exchange";t[t.oneDrive=5]="oneDrive";t[t.registry=6]="registry";t[t.inMemory=7]="inMemory";t[t.uploadFileDevCatalog=8]="uploadFileDevCatalog";t[t.hardCodedPreinstall=9]="hardCodedPreinstall";t[t.privateCatalog=10]="privateCatalog";t[t.wopiCatalog=
16]="wopiCatalog"})(le||(le={}));Object(h.b)("AddinProviderType",le);var ge=d(532);class Zd{constructor(t,N,ha,za=null){this.fa=za?za:v.AFrameworkApplication.fa;this.Tvd=2;this.evb=t;this.f_h=N;this.zw=ha}get S7(){return this.Tvd}get cAl(){return this.f_h}PHe(t){if(this.fa.ka("AgaveSupportsLiveIdSpoofing"))this.evb(t,this.S7,{["ak0"]:(new Date).getTime()});else if(this.Bca&&m.ULS.sendTraceTag(509653583,220,50,"RetrieveAddinCommands: providerType: {0}, InitLaunchOperationType: {1}",le[t],hd.a[this.S7]),
ge.a.obl(t)){this.Bca&&m.ULS.sendTraceTag(509653582,220,50,"RetrieveAddinCommands: RunAddinsLastUpdateCheck - providerType: {0}, InitLaunchOperationType: {1}",le[t],hd.a[this.S7]);var N=String.format(v.AFrameworkApplication.Aa.jb.Xla+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",v.AFrameworkApplication.Aa.jb.rm,this.cAl,v.AFrameworkApplication.hh);const ha=v.AFrameworkApplication.Ge;let za=null;this.zw&&(za=this.zw.zi("ComponentAttach",le[t]+hd.a[this.S7]));ha.yj(N,1,
null,null,!0,4,Ra=>{this.Bca&&m.ULS.sendTraceTag(509653581,220,50,"RetrieveAddinCommands: providerType: {0}, InitLaunchOperationType: {1}, the request succeeded.",le[t],hd.a[this.S7]);this.csk(t,Ra.data.Sd);za&&za.stop()},Ra=>{m.ULS.sendTraceTag(17438153,220,50,"GetLastUpdate request failed with {0}.",Ra.data.Le);za&&za.stop()},null)}else ge.a.Ukg(t)?(this.Bca&&m.ULS.sendTraceTag(509653580,220,50,"RetrieveAddinCommands: providerType: {0}, InitLaunchOperationType: {1}, HasAddinCommandsRibbonCache is true",
le[t],hd.a[this.S7]),N=ge.a.z8f(t),this.evb(t,this.S7,{["ak0"]:N})):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(this.Bca&&m.ULS.sendTraceTag(509653579,220,50,"RetrieveAddinCommands: providerType: {0}, InitLaunchOperationType: {1}, AddinDetailsServiceSupportEnabled is true",le[t],hd.a[this.S7]),this.evb(t,this.S7,null))}csk(t,N){if(N&&""!==N&&(N=Sys.Net.XMLDOM(N))){ge.a.kKb(qj.a.OFf,((new Date).getTime()+Hd.Zik).toString(),t);let ha=N.getElementsByTagName("update");
ha&&ha.length||(ha=N.getElementsByTagName("o:update"));ha&&0<ha.length&&(N=Date.parse(ha[0].firstChild.nodeValue),(ge.a.z8f(t)<N||ge.a.Ukg(t))&&this.evb(t,this.S7,{["ak0"]:N}))}}get Bca(){return this.fa?this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinCommandsInitResearch",!1):!1}}Object(h.a)(Zd,"AddinCommandsAnonymousAPIInitializer",null,[982]);class Oe{constructor(t,N,ha){this.Tvd=ha;this.evb=t;this.Vh=N}get S7(){return this.Tvd}PHe(t){let N=null;this.Vh&&(N=this.Vh.zi("ComponentAttach",
le[t]+hd.a[this.S7]));(null==this.oNe(t)?0:this.oNe(t))&&this.evb(t,this.S7,{["ak0"]:(new Date).getTime()-Hd.J8h*Hd.nol});N&&N.stop()}}Object(h.a)(Oe,"AddinCommandsInitializerBase",null,[982]);class tc extends Oe{constructor(t,N){super(t,N,5)}oNe(){return!0}}Object(h.a)(tc,"AddinCommandsInitializer",Oe,[]);class Xh extends Oe{constructor(t,N){super(t,N,1)}oNe(t){try{const N=qj.a.$ag()+t;return Boolean.parse(this.o0i(N)||"false")}catch(N){m.ULS.sendTraceTag(17306844,220,50,"LocalStorage is not allowed, {0}.",
N.toString())}return null}o0i(t){const N=localStorage;return void 0!==N&&null!==N?N.getItem(t):null}}Object(h.a)(Xh,"AddinCommandsLocalCacheInitializer",Oe,[]);class ii{constructor(t,N=null){this.zw=t;this.fa=N?N:v.AFrameworkApplication.fa}get appUILocale(){return xd.a.oe(v.AFrameworkApplication.lcid).name}izj(){if(this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinFlyoutEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",
!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GetAddinHomeTabEntranceEnabled",!1)&&this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.EnableTUIForBEPHomeTab",!1)){var t={};t[qj.a.uLi]="TeachingCallout";this.bCe(F.a.Uql,t)}const N=this.HZd();if(this.Bca){t={};for(var ha of N)t[le[ha.key]]=hd.a[ha.value];m.ULS.sendTraceTag(509653578,220,50,"InitializeAllAddinCommands: providerDict: {0}",JSON.stringify(t))}if(N)if(this.fa.ka("OcpsIsEnabled"))u.a.instance.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(za=>
{za.isFeatureEnabled("ConnectedServices",!0).then(Ra=>{for(let qb of N){if(!Ra&&0===qb.key){this.Bca&&m.ULS.sendTraceTag(509653577,220,50,"InitializeAllAddinCommands-A: providerType: {0}, operationType: {1}, skip the OMEX provider",le[qb.key],hd.a[qb.value]);continue}const Qb=this.e8f(qb.value);Qb&&(this.Bca&&m.ULS.sendTraceTag(509653576,220,50,"InitializeAllAddinCommands-A: providerType: {0}, operationType: {1}, call initializer's RetrieveAddinCommands",le[qb.key],hd.a[qb.value]),Qb.PHe(qb.key))}return null})});
else for(let za of N)this.Bca&&m.ULS.sendTraceTag(509653575,220,50,"InitializeAllAddinCommands-B: providerType: {0}, operationType: {1}",le[za.key],hd.a[za.value]),(ha=this.e8f(za.value))&&ha.PHe(za.key)}QHe(t,N,ha){ha&&ha[qj.a.oob]?(this.Bca&&m.ULS.sendTraceTag(509653574,220,50,"RetrieveAddinFlagCompleted: providerType: {0}, operationType: {1}, sends a RetrieveAddInCommandsEntitlementsList command",le[t],hd.a[N]),ha[qj.a.bqa]=t,ha[qj.a.S6]=N,this.bCe(F.a.mGb,ha),ge.a.kKb(qj.a.oob,ha[qj.a.oob].toString(),
t)):this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinDetailsServiceSupportEnabled",!1)&&(this.Bca&&m.ULS.sendTraceTag(509653573,220,50,"RetrieveAddinFlagCompleted: providerType: {0}, operationType: {1}, sends a QueryAddinDetails command",le[t],hd.a[N]),0===t&&(ha={},ha[qj.a.bqa]=t,ha[qj.a.S6]=N,this.bCe(F.a.BEk,ha)))}e8f(t){let N=null;switch(t){case 1:N=new Xh(Object(r.a)(this,this.QHe,"retrieveAddinFlagCompleted"),this.zw);break;case 2:N=new Zd(Object(r.a)(this,this.QHe,"retrieveAddinFlagCompleted"),
this.appUILocale,this.zw,this.fa);break;case 5:N=new tc(Object(r.a)(this,this.QHe,"retrieveAddinFlagCompleted"),this.zw)}return N}get Bca(){return this.fa?this.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AddinCommandsInitResearch",!1):!1}}Object(h.a)(ii,"AddinCommandsInitializerHost",null,[]);var Rh=d(1097),Wf=d(161);class Yh extends ii{constructor(t,N){super(t.rgg());this.wq=t;this.fc=N;Rh.a.p3b=Rh.a.Q7g}nsl(){this.izj()}HZd(){const t=new Wf.a;this.fc.ka("51")&&(t.$(0,2),t.$(16,5));this.fc.ka("187")&&
t.$(1,1);this.wq.ld.Hsa&&t.$(8,1);this.fc.ka("305")&&t.$(10,5);return t}bCe(t,N){this.wq.EK().La(t,2,N)}}Object(h.a)(Yh,"AddinCommandsInitService",ii,[812]);class Jg{constructor(){this.K=null}get name(){return"PowerPointWebEditor.AddinCommands"}Wb(t){this.K=t;u.a.instance.register(Yh,"PowerPointWebEditor.AddinCommandsInitService").as("PowerPointWebEditor.IAddinCommandsInitService").na(()=>new Yh(this.K.resolve("PowerPointWebEditor.IApplicationContext"),this.K.resolve("Common.IAppSettingsManager"))).ma()}init(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").htg&&
this.K.resolve("Common.IAppSettingsManager").ff(()=>{u.a.instance.resolve("PowerPointWebEditor.IAddinCommandsInitService").nsl()})}dispose(){}}Object(h.a)(Jg,"AddInCommandsInitPackage",null,[2,3]);class sb extends ye{constructor(t,N=null){super(t,!0,N,!1)}get d7d(){return null}get Pla(){return v.AFrameworkApplication.ara?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting}get vxb(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion}get buttonText(){return CommonUIStrings.l_Download}get PBc(){return null}}
Object(h.a)(sb,"DownloadAsPdfDialog",ye,[]);class Xa extends sb{constructor(t){super(t)}get Pla(){return v.AFrameworkApplication.ara?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}o7b(){K.a.J(25544926,801,50,"Images download dialog displayed")}q7b(){K.a.J(25544928,801,50,"Images download dialog link clicked")}f$a(){K.a.J(25544930,801,50,"Images download dialog button clicked")}}Object(h.a)(Xa,"DownloadACopyAsImagesDialog",sb,[]);var hl=d(194);class sl extends Rd{constructor(t){super(t,
void 0,v.AFrameworkApplication.ara)}get Pla(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady}get vxb(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion}get $6b(){return"DownloadOdpLink"}get buttonText(){return ResourceStrings.L_Download}get $Xb(){return v.AFrameworkApplication.ara?"UIFontDialogTextLarge":null}o7b(){K.a.J(8958087,801,50,"ODP download dialog displayed")}q7b(){K.a.J(8958089,801,50,"ODP download dialog link clicked")}f$a(){K.a.J(19505496,801,50,"ODP download dialog button clicked")}dXc(){hl.Redirect.showHelp("PPTODF");
return!0}get X6b(){return v.AFrameworkApplication.fa&&v.AFrameworkApplication.fa.ka("EnableReactDialogs")&&dd.a("ReactDialogsODPDialogFix")?null:"#"}get kTa(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText}get dVg(){return!v.AFrameworkApplication.ara}}Object(h.a)(sl,"DownloadACopyAsOdpDialog",Rd,[]);class Tn extends sb{constructor(t){super(t)}get Pla(){return v.AFrameworkApplication.ara?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady}o7b(){K.a.J(21050910,
801,50,"PDF download dialog displayed")}q7b(){K.a.J(21050912,801,50,"PDF download dialog link clicked")}f$a(){K.a.J(21050914,801,50,"PDF download dialog button clicked")}}Object(h.a)(Tn,"DownloadACopyAsPdfDialog",sb,[]);var fj=d(1121),Ml=d(379);class rj extends Ml.a{constructor(t,N,ha){super();this.lX=null;this.tZc=0;this.Md=this.MNg=null;this.e9j=t;this.C2j=N;this.W_j=ha;this.JWa=Object(r.a)(this,this.K4,"onRequestComplete");this.onError=Object(r.a)(this,this.Hpk,"onRequestError")}get kfc(){return this.MNg}set kfc(t){this.MNg=
t}get ru(){return this.Md}set ru(t){this.Md=t}start(){this.vIb()}vIb(){1!==v.AFrameworkApplication.Aa.state&&(this.lX=new fj.a,this.lX.qr=!1,this.lX.yd=5,this.lX.message=this.e9j,this.lX.wna(ResourceStrings.l_GenericDialogTitle,null,null),this.tZc=0)}GS(){this.lX&&(this.lX.close(),this.lX=null)}K4(t){this.GS();t.cQa?this.kfc(t):this.iY()}Hpk(t){t.UQi&&this.tZc<rj.WYk?(this.tZc+=1,t.start()):this.iY()}iY(){this.GS();if(1!==v.AFrameworkApplication.Aa.state){const t=new Ma.StandardDialog;t.yd=0;t.jy(this.W_j,
ResourceStrings.l_GenericDialogTitle,this.C2j,this.ru)}}}rj.WYk=3;Object(h.a)(rj,"UIBlockingTask",Ml.a,[]);var ep=d(275);class tl extends rj{constructor(t){super(ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,M.a.Lik);this.TA=t}start(){super.start();ep.a.Nwi(this.TA,Object(r.a)(this,this.pca,"handleWebserviceResponse"),Object(r.a)(this,this.oca,"handleWebserviceError"))}}Object(h.a)(tl,"ConvertToOdpTask",rj,[]);class an extends rj{constructor(t){super(ResourceStrings.L_PrintingProgressString,
ResourceStrings.l_ConvertingToPdfErrorString,M.a.Rwk);this.TA=t}start(){super.start();ep.a.Pwi(this.TA,Object(r.a)(this,this.pca,"handleWebserviceResponse"),Object(r.a)(this,this.oca,"handleWebserviceError"))}}Object(h.a)(an,"ConvertToPdfTask",rj,[]);class ul{constructor(t,N,ha){this.MZc=t;this.ue=N;this.Fie=ha}get Arb(){return this.MZc.value}convert(t,N,ha){let za=null;0===N?this.Fie?new sl(ha):(za=new tl(t),za.kfc=Object(r.a)(this,this.blk,"onConvertOdpRequestSucceeded"),za.start()):1===N?this.ue.ld.Zvg&&
this.Fie?new Tn(ha):Aa.a.BK(Aa.a.Eb,()=>{za=new an(t);za.kfc=Object(r.a)(this,this.dlk,"onConvertPdfRequestSucceeded");za.start()}):2===N?this.ue.ld.myg&&this.Fie&&new Xa(ha):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",N))}blk(t){t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=jb.a.Ora(t.PrintUrl),new sl(t))}dlk(t){t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=jb.a.Ora(t.PrintUrl),this.Arb.TSf=new Date,new Tn(t),this.Arb.CYf=new Date,K.a.J(21050908,801,
50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.Arb.r_f.toString(),this.Arb.hkh.toString(),this.Arb.TSf.toString(),this.Arb.CYf.toString()))}}Object(h.a)(ul,"Converter",null,[819]);class sk{constructor(){this.r_f=this.hkh=this.TSf=this.CYf=vi.App.Mm}}Object(h.a)(sk,"DownloadACopyAsPdfContext",null,[]);class wm extends rj{constructor(t,N){super(ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,
M.a.zCk);this.TA=t;this.zbk=N}start(){super.start();ep.a.print(this.TA,this.zbk,Object(r.a)(this,this.pca,"handleWebserviceResponse"),Object(r.a)(this,this.oca,"handleWebserviceError"))}}Object(h.a)(wm,"PrintTask",rj,[]);class yo{constructor(t,N,ha){if(!t)throw Error.argumentNull("directPrintManager");this.P8b=t;this.ue=N;this.R2j=ha}ipk(t){this.P8b.LCk();t=t.result;1!==v.AFrameworkApplication.Aa.state&&(t=jb.a.Ora(t.PrintUrl),this.P8b.Psh(t))}print(t,N,ha){this.ue.ld.Zvg&&this.R2j?(t=new Zi.QueryStringBuilder(N),
t.Ti(Ci.a.Vuk,this.P8b.Nrh().toString()),t.Ti(Ci.a.Ruk,ha.toString()),this.P8b.Psh(t.toString())):(ha=new wm(t,this.P8b.Nrh()),ha.kfc=Object(r.a)(this,this.ipk,"onPrintRequestSucceeded"),ha.start())}}Object(h.a)(yo,"Printer",null,[811]);class Nf{get name(){return"PowerPointWebEditor.PrintPackage"}Wb(){u.a.instance.register(yo,"PowerPointWebEditor.Printer").as("PowerPointWeb.IPrinter").ma().na(()=>new yo(u.a.instance.qb("Common.App.DirectPrint.IDirectPrintManager"),u.a.instance.qb("PowerPointWebEditor.IApplicationContext"),
u.a.instance.qb("PowerPointWebEditor.IApplicationSettings").tg));u.a.instance.register(ul,"PowerPointWeb.Converter").as("PowerPointWeb.IConverter").ma().na(()=>new ul(u.a.instance.le("PowerPointWebEditor.DownloadACopyAsPdfContext"),u.a.instance.qb("PowerPointWebEditor.IApplicationContext"),u.a.instance.qb("PowerPointWebEditor.IApplicationSettings").tg));u.a.instance.register(sk,"PowerPointWebEditor.DownloadACopyAsPdfContext").ma().na(()=>new sk)}init(){}dispose(){}}Object(h.a)(Nf,"PrintPackage",null,
[2,3]);class sh{constructor(t,N){this.actionId=t;this.kd=N}}Object(h.a)(sh,"CommandActionData",null,[]);class ho{constructor(t,N,ha,za,Ra){this.SSg=[];this.Lxg=!1;this.Pfe=null;this.WYc=new C.a;this.ia=t;this.eqe=N;this.DCf=!1;this.Nb=ha;this.JI=za;this.Pda=Ra;this.K2c=null}get knd(){return this.SSg}get eYg(){this.K2c||(this.K2c=v.AFrameworkApplication.Jj("officeExtensionMerge.js",5));return this.K2c}set eYg(t){this.K2c=t}get E$h(){if(!this.Pfe){const t=[this.Pda.LXb(this.eYg)];this.Pfe=Zb.a.create("pptedit.appforoffice",
t,()=>d.e(9).then(d.bind(null,1205)))}return this.Pfe}z3h(t){this.knd.push(t)}q4a(){this.Lxg||(Fc.a.Kx(this.E$h),this.Lxg=!0)}Oql(){for(const t of this.knd)t.rhb();this.SSg=[]}Pql(){var t=this.Nb.Kc(this.eqe.yf).Ab(18);t=this.Nb.Kc(t);var N=t.Ab(19);if(N){do N=t.pq,N=N.getValue(Vb.a.dZ),this.ia.La(vb.a.Hfb,2,N);while(t.vf(19))}}MTb(t,N){this.WYc.add(new sh(t,N))}Lmj(){if(0<this.WYc.count){for(let t of this.WYc)this.ia.La(t.actionId,2,t.kd);this.WYc.clear()}}M5d(){const t=!!this.knd&&0<this.knd.length;
let N=!1;if(this.eqe.yf&&!t){const ha=this.Nb.Kc(this.eqe.yf).Ab(18);ha&&0<this.Nb.Kc(ha).B7(19)&&(N=!0)}return t||N}}Object(h.a)(ho,"AppForOfficeManagerFactory",null,[791]);class Re extends Ll{constructor(t,N,ha){super(t,N);this.la=ha;this.Iy=vb.a.Ypb}Gsa(t){if(t&&t.length){var N=vb.a.Jz(this.Iy),ha=this.GFj(t[0]);try{K.a.J(512517845,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images, from command: {0} to command: {1}.",N,ha?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload");
if(32!==(ha?this.kn.La(vb.a.nEc,2,t):this.kn.La(this.Iy,2,t[0])))throw Error.invalidOperation(String.format("Failed to change online images, command: {0}.",ha?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload"));K.a.J(512517844,352,50,"ChangeOnlineImageHelper: InsertMediaCallback() - Change online images successfully, from command: {0} to command: {1}.",N,ha?"ChangeOnlineIconUpload":"ChangeOnlinePictureUpload")}catch(za){K.a.J(512517843,352,10,"ChangeOnlineImageHelper: InsertMediaCallback() - {0}: Exception = [{1}].",
N,za.toString())}}}GFj(t){(t=!!t&&!!t.OriginalUrl&&0<t.OriginalUrl.length&&this.la.pptSmartArtSubNodeIconChangeEnabled&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=t.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&t.OriginalUrl.toLowerCase().indexOf(".svg")===t.OriginalUrl.length-4)||K.a.J(512517842,352,50,"isChangeSvg = false");return t}}Object(h.a)(Re,"ChangeOnlineImageHelper",Ll,[]);class Ve extends Ll{constructor(t,
N,ha){super(t,N);this.la=ha;this.Iy=vb.a.B8a}Gsa(t){if(t&&t.length){var N=vb.a.Jz(this.Iy),ha=new Map;ha.set("InsertMediaCommand",N);pf.Health.instance.recordKpiUsageForAlertableKpi("InsertOnlineImage",null,ha);try{const Ra=[],qb=[];for(let vc=0;vc<t.length;vc++){const Zc=t[vc];this.vwg(Zc)?Array.add(Ra,Zc):Array.add(qb,Zc)}K.a.J(512517841,352,50,"InsertMediaCallback:  Insert {0} pictures {1} svg images, command: {2}.",qb.length,Ra.length,N);let Qb=this.Iy;Qb===vb.a.nSc&&(Qb=vb.a.qSc);for(t=0;t<qb.length;t++){var za=
this.kn.La(Qb,2,qb[t]);if(32!==za)throw Error.invalidOperation(String.format("Failed to upload picture {0} with command {1}.",qb.toString(),N));}if(this.vwg(Ra[0])&&(za=this.kn.La(vb.a.nSc,2,Ra),32!==za))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",Ra.toString()));K.a.J(512517840,352,50,"InsertMediaCallback: Insert {0} pictures {1} svg images success, command: {2}.",qb.length,Ra.length,N)}catch(Ra){K.a.J(512517839,352,10,"InsertMediaActor::{0}: Exception = [{1}].",
this.Iy.toString(),Ra.toString()),ha.set("Exception",Ra.toString()),pf.Health.instance.recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,Object.assign(new Ug.a,{extendedProperties:ha}))}}}vwg(t){(t=!!t&&!!t.OriginalUrl&&0<t.OriginalUrl.length&&this.la.A8a&&!!this.la.powerPointInsertContentSvgPath&&0<this.la.powerPointInsertContentSvgPath.length&&0<=t.OriginalUrl.toLowerCase().indexOf(this.la.powerPointInsertContentSvgPath.toLowerCase())&&t.OriginalUrl.toLowerCase().indexOf(".svg")===
t.OriginalUrl.length-4)||K.a.J(512517838,352,50,"isInsertSvg = false");return t}}Object(h.a)(Ve,"InsertOnlineImageHelper",Ll,[]);var Kg=d(703);class wf{constructor(t,N){this.Qab=!1;this.ibb=new Date(0);this.hbb=new Date(0);this.hre=t;this.yb=N}cjg(){this.Qab=!0}KIa(){this.Qab?K.a.J(593884831,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.ibb>this.hbb?K.a.J(593884829,813,100,"PrefetchScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+
this.ibb+". Last scan at "+this.hbb+"."):(this.ibb=new Date,this.yb.Cb(new aa.a(3,1,0,Object(r.a)(this,this.oIe,"runJob"),90,"112")))}oIe(){this.hbb=new Date;this.Qab?K.a.J(593884827,813,100,"PrefetchScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.hre()&&this.KIa()}}Object(h.a)(wf,"PrefetchScheduler",null,[]);class Ae{constructor(t,N,ha){this.IYc=null;this.bJg=N;this.rFg=ha;this.Rxb=t}k2k(t){this.Rxb!==t&&(this.Rxb=t,this.IYc=null)}Dfj(){this.IYc||
(this.IYc=this.lki());return this.IYc}lki(){const t=[];Array.add(t,this.Rxb);for(let N=1;N<=this.bJg||N<=this.rFg;N++)N<=this.bJg&&Array.add(t,this.Rxb+N),N<=this.rFg&&0<=this.Rxb-N&&Array.add(t,this.Rxb-N);return t}}Object(h.a)(Ae,"SlideWindow",null,[]);class lf{constructor(t,N,ha,za,Ra,qb,Qb,vc){this.Jcb=!1;this.lc=Ra;this.$p=za;this.hva=vc;this.Txb=new Kg.a;this.$z=new wf(Object(r.a)(this,this.fUe,"tryScan"),qb);this.yTg=new Ae(za&&za.Ba?za.Ba.slideIndex:0,Qb?Qb.Sjl:10,Qb?Qb.Rjl:5);this.mMe(t,
N,ha)}start(){this.Jcb?K.a.J(593884825,813,100,"StreamVideoPrefetchOrchestrator::Start: Trying to start StreamVideoPrefetchOrchestrator twice."):(K.a.J(593773075,813,100,"StreamVideoPrefetchOrchestrator Starting."),this.Jcb=!0,this.$z.KIa())}mMe(t,N,ha){t&&t.UH(Object(r.a)(this,this.W8c,"onEditSlideChanged"));N&&N.tha(Object(r.a)(this,this.T9c,"onPageContentLoaded"));ha&&ha.INa(Object(r.a)(this,this.Zqk,"onSlideshowSlideChanged"))}T9c(t,N){this.Jcb&&(t=Object(Q.a)(120,N.node))&&t.DD&&(this.Txb.remove(t.Bb),
this.$z.KIa())}W8c(t,N){N&&N.Wla&&this.dB(N.Wla.slideIndex)}Zqk(t,N){N&&this.dB(N.slideIndex)}dB(t){this.yTg.k2k(t);this.Jcb&&this.$z.KIa()}fUe(){const t=this.q3d();0<t.length&&this.SIe(t[0]);return 1<t.length}q3d(){const t=[];var N=this.$p.presentation;if(!N)throw Error.argumentNull("Presentation is null");N=N.slides||[];for(const ha of this.yTg.Dfj()){const za=N[ha];this.sbl(za)&&Array.add(t,za)}return t}sbl(t){return!!t&&t.DD&&!t.qN&&!this.Txb.contains(t.Bb)}SIe(t){this.Txb.add(t.Bb);t=this.ngj(t);
0<t.length&&(K.a.J(593773072,813,100,"StreamVideoPrefetchOrchestrator::ScanSlide: Found {0} videos.",t.length),this.hva?this.hva.jBk(t):K.a.J(593773070,813,10,"StreamVideoPrefetchOrchestrator::ScanSlide: Found videos to prefetch, but StreamPreFetchService is null."))}ngj(t){if(!this.lc)return K.a.J(593884821,813,10,"StreamVideoPrefetchOrchestrator::GetStreamVideosToLoadForSlide: SlideReader is null, so we cannot scan slides for Stream videos."),this.$z.cjg(),[];const N=[];if(!t)return N;t=Object(Q.a)(120,
t);if(!t)return N;for(const ha of t.jl())(t=ha.Vna)&&this.hva&&this.hva.E9a(t)&&Array.add(N,t);return N}static BNj(t){return!!t&&t.xzg&&!Mc.a.Ki&&!Mc.a.RDa&&!Mc.a.rI&&!Mc.a.fde}}Object(h.a)(lf,"StreamVideoPrefetchOrchestrator",null,[]);class wi{static addAppPLTEventToLog(t){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(t)}catch(N){}}static setIsPageLoadForFirstTime(t){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(t)}catch(N){}}}Object(h.a)(wi,
"VersionHistoryLogConnector",null,[]);class Se{constructor(t,N,ha,za){this.sX=null;this.Fhh=this.ResetAppVersionController;this.jw=t;this.yi=N;this.Ha=ha;this.uc=za;this.PVa={}}OnVersionHistorySelected(t,N){try{K.a.J(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");const ha=document.getElementById("VersionHistoryViewerSpinner");ha&&(ha.style.display="none");if(this.sX)this.sX.onVersionSelected(t,N,this.PVa)}catch(ha){K.a.J(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",
ha)}}ResetAppVersionController(t){try{if(this.sX)wi.setIsPageLoadForFirstTime(!1),this.sX.switchParentViewContainer(t);else{wi.setIsPageLoadForFirstTime(!0);const N=new PowerPointVersionHistory.AppBootSettings;N.RenderServiceBase="";N.IsRtl=!1;const ha=new PowerPointVersionHistory.AppCallbackBag;ha.animationDecoratorCallback=Object(r.a)(this.jw,this.jw.IQd,"createAnimationOrTransitionStar");ha.notesIconDecoratorCallback=Object(r.a)(this,this.CreateNotesIcon,"CreateNotesIcon");N.IsHighContrast=!1;
this.yi&&(N.IsHighContrast=this.yi.isInHighContrastMode);N.IsHighContrast&&(N.ClientColorSettings=this.yi.highContrastColors.foregroundTextColor+"_"+this.yi.highContrastColors.backgroundColor+"_"+this.yi.highContrastColors.linkColor);if(this.uc){const za=this.uc.cRa();N.DefaultSlideWidth=za.width;N.DefaultSlideHeight=za.height}N.UserSessionId=v.AFrameworkApplication.userSessionId;N.VersionViewerCssUrl=this.Ha.versionHistoryViewerCssUrl;N.ProgressImageResourceUrl=dh.a.uK(fb.a.Dma);this.sX=new PowerPointVersionHistory.AppVersionController(N,
t,ha)}}catch(N){K.a.J(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",N)}}CreateNotesIcon(){return Ga.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,"Notes")}}Object(h.a)(Se,"PPTVersionHistorySelectionHandler",null,[717]);class zo extends Rd{constructor(t){super(t,void 0,v.AFrameworkApplication.ara)}get Pla(){return CommonUIStrings.l_DownLoadACopyDialogMessage}get vxb(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion}get $6b(){return"PowerPointDownloadCopyLink"}get buttonText(){return CommonUIStrings.l_Download}get $Xb(){return v.AFrameworkApplication.ara?
"UIFontDialogTextLarge":null}o7b(){K.a.J(19743688,801,50,"Download a copy dialog displayed")}q7b(){K.a.J(19743690,801,50,"Download a copy dialog clicked")}f$a(){K.a.J(19743692,801,50,"Download a copy dialog button clicked")}}Object(h.a)(zo,"PowerPointDownloadACopyDialog",Rd,[]);class yj{Pel(t){new zo(t)}}Object(h.a)(yj,"PowerPointDownloadACopyDialogFactory",null,[680]);var sf;(function(t){t[t.unknown=0]="unknown";t[t.bing=1]="bing";t[t.M365=2]="M365";t[t.icons=3]="icons";t[t.oneDrive=4]="oneDrive";
t[t.hubbleVideos=5]="hubbleVideos"})(sf||(sf={}));Object(h.b)("InsertMediaProviders",sf);var og;(function(t){t[t.OK=0]="OK";t[t.cancel=1]="cancel";t[t.error=2]="error";t[t.open=3]="open"})(og||(og={}));Object(h.b)("HubbleAction",og);var Ao=d(522);class bn extends ad.a{constructor(t,N,ha,za,Ra){super();this.BM=null;this.Usc=!1;this.V9b=this.Ayd=this.YW=null;this.FMd="KeepFocusDiv";this.GMd="KeepFocusStartDiv";this.correlationId=null;this.C4=0;this.insertPictureTelemetryEndpoint=null;this.DTd=0;if(!t)throw Error.argumentNull("insertMediaSeviceEndpoint",
"insertMediaSeviceEndpoint cannot be null.");this.Z7e=t;this.b2e="";this.JOb=ha;this.f1=za;this.Rza=[];this.vBd=N;this.mg=Ra||Vg.mg;this.ng="InsertMediaDialog";this.O5d=!1;this.yd=5}sIb(t,N){this.b2e=t;this.Usc=!1;this.showDialog(this.b2e,null);this.YW=this.aNc(this.ji("insertmediaframe"));if(!this.YW)throw this.O5a(this.jDc),Error.invalidOperation("Couldn't get InsertMediaIframe.");(t=document.getElementById(this.ji("WACDialogPanel")))&&t.setAttribute(oa.a.Ye,oa.a.QKd);t=document.createElement("div");
t.setAttribute("Id",this.GMd);t.setAttribute("tabindex","0");t.setAttribute("position","absolute");t.setAttribute("width","-1000px");t.setAttribute("top","-1000px");this.YW.parentNode.insertBefore(t,this.YW.parentNode.firstChild);t=document.createElement("div");t.setAttribute("Id",this.FMd);t.setAttribute("tabindex","0");this.YW.parentNode.appendChild(t);t.setAttribute("position","absolute");t.setAttribute("width","-1000px");t.setAttribute("top","10000px");$addHandler(this.CTd,"keydown",Object(r.a)(this,
this.Lz,"keyDownHandler"));this.YW.setAttribute("src",this.Z7e);this.YW.setAttribute("width","100%");this.YW.setAttribute("height","100%");this.YW.setAttribute("frameborder","0");v.AFrameworkApplication.fa.ka("ShowInsertMediaIframeWhenIframeIsReady")&&(Mc.a.eg||Mc.a.W5b)?(this.YW.style.visibility="hidden",this.V9b=Object(r.a)(this,this.mnk,"onInsertMediaIframeLoaded"),zd.a.addHandler(this.YW,"load",this.V9b)):this.YW.style.visibility="visible";this.aNc(this.ji("WACDialogTitleText")).style.display=
"none";if(2===this.C4||5===this.C4)this.aNc(this.ji("WACDialogTitlePanel")).style.display="none",this.aNc(this.ji("WACDialogBodyPanel")).style.padding="0";gc.FocusManager.instance().il().scope.cL=!0;this.BM=this.vBd.getInstance(this.YW.contentWindow,this.Z7e);this.BM.ywa(Yd.a.CDf,ha=>{this.ijk(ha,Object(r.a)(N,N.Gsa,"insertMediaCallback"))});this.BM.ywa(Yd.a.insert,ha=>{this.Mxe(ha,Object(r.a)(N,N.Gsa,"insertMediaCallback"))});this.BM.ywa(Yd.a.R2h,ha=>{this.zok(ha)});this.BM.ywa(Yd.a.g3i,Object(r.a)(this,
this.vmk,"onGetCustomHeaders"));this.BM.ywa(Yd.a.yej,Object(r.a)(this,this.Gmk,"onGetSessionId"));this.BM.ywa(Yd.a.m0i,Object(r.a)(this,this.smk,"onGetCID"));this.BM.ywa(Yd.a.qli,Object(r.a)(this,this.pkk,"onCancelDialog"));2===this.C4&&0===this.DTd&&(this.BM.ywa(Yd.a.lUj,Object(r.a)(this,this.Hnk,"onLaunchM365Upsell")),this.Ayd=this.f1.sfb("MsoPremiumStockImages",ha=>{m.ULS.sendTraceTag(512497694,352,50,"OnCompleteM365Upsell: Thanks for purchasing!");this.BM.sendMessage(Yd.a.zzl,{["LicenseTier"]:ha.toString()})}));
this.Okc(3)}mnk(){this.YW&&(this.YW.style.visibility="visible",window.setTimeout(()=>{if(this.ai){const t=this.ai.getElementById("insertmediaframe");t&&t.focus()}},0))}Lz(t){t.keyCode===Sys.UI.Key.tab&&(t.target.id!==this.FMd||t.shiftKey?t.target.id===this.GMd&&t.shiftKey&&(t.preventDefault(),this.ai.getElementById(this.FMd).focus()):(t.preventDefault(),this.ai.getElementById(this.GMd).focus()))}dispose(){this.f1&&this.Ayd&&this.f1.HFb("MsoPremiumStockImages",this.Ayd);this.BM&&(this.BM.dispose(),
this.BM=null);this.V9b&&(zd.a.removeHandler(this.YW,"load",this.V9b),this.V9b=null);super.dispose()}ijk(t,N){m.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");if(t=this.JOb.A5g(t))50<this.Rza.length?m.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this.Rza,t),this.Usc&&(N(this.Rza),this.Usc=!1))}pkk(){m.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message.");this.O5a(this.jDc);this.Okc(1)}Okc(t){var N=RegExp("hubble","gi");if(this.insertPictureTelemetryEndpoint&&
0<this.insertPictureTelemetryEndpoint.search(N)&&this.correlationId){N=v.AFrameworkApplication.$c;var ha={};ha.InsertedFiles=this.Rza.length;ha.DialogResult=og[t];ha.DialogMode=this.q9i();ha.CorrelationId="{"+this.correlationId.toString()+"}";ha.Platform="Wac";ha.Provider=sf[this.C4]||"Unknown";ha.AudienceGroup=N&&"AudienceGroup"in N?N.AudienceGroup.toString():"Unknown";ha.Ring=N&&"Ring"in N?N.Ring.toString():"Unknown";ha.AppId=vi.App.mode;ha.Build=v.AFrameworkApplication.buildVersion;ha.Locale=xd.a.oe(v.AFrameworkApplication.lcid).name;
this.owa().send(JSON.stringify(ha))}if(2===this.C4||5===this.C4){const za=v.AFrameworkApplication.fa.Ga("InsertMediaDialogAriaTenantNameSpace");za&&""!==za&&(N=[],ha="InsertUnknownContent",2===this.C4?(Array.add(N,Object.assign(new I.a,{name:"DialogMode",string:"M365Content"})),Array.add(N,Object.assign(new I.a,{name:"Provider",string:"M365Content"})),ha="InsertM365Content"):5===this.C4&&(Array.add(N,Object.assign(new I.a,{name:"DialogMode",string:"HubbleVideo"})),Array.add(N,Object.assign(new I.a,
{name:"Provider",string:"HubbleVideo"})),ha="InsertHubbleVideo"),Array.add(N,Object.assign(new I.a,{name:"InsertedFiles",int64:this.Rza.length})),Array.add(N,Object.assign(new I.a,{name:"DialogResult",string:og[t]})),Array.add(N,Object.assign(new I.a,{name:"CorrelationId",string:this.correlationId.toString()})),w.a.sendTelemetryEvent(Object.assign(new H.a,{name:String.format("{0}.{1}",za,ha),dataFields:N})))}}q9i(){return 3===this.C4?"Icons":"Images"}aNc(t){const N=document.getElementById(t);if(!N)throw Error.invalidOperation(String.format("Couldn't get {0}.",
t));return N}owa(){const t=new XMLHttpRequest;t.open("POST",this.insertPictureTelemetryEndpoint,!0);t.setRequestHeader("Content-Type","");return t}Mxe(t,N){m.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message.");this.O5a(this.jDc);N?this.Rza&&0<this.Rza.length?(N(this.Rza),this.Okc(0)):(m.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this.Usc=!0,N(this.Rza),this.Okc(2)):this.Okc(2)}vmk(){this.BM&&(m.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this.BM.sendMessage(Yd.a.A3k,
{["CustomHeaders"]:""}))}Gmk(){this.BM&&(m.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this.BM.sendMessage(Yd.a.l7k,{["SessionId"]:v.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))}smk(){this.BM&&(m.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this.BM.sendMessage(Yd.a.V2k,{["CID"]:""}))}zok(t){t&&t.Values&&(t=t.Values,delete t.m_Origin,delete t.m_Source,delete t.m_ReceivedTime,m.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+
t.eventName||!1),w.a.sendOtelEvent(Object.assign(new Ao.a,{otelEvent:t})))}Hnk(){this.f1&&(m.ULS.sendTraceTag(512497693,352,50,"OnLaunchM365Upsell: Launch Dime Upsell flow from Stock Image picker."),this.f1.launchUpsellExperience("stockimages"))}}Object(h.a)(bn,"InsertMediaDialog",ad.a,[726,106]);class hf{getInstance(t,N,ha,za,Ra){return new bn(t,N,ha,za,Ra)}}Object(h.a)(hf,"PptInsertMediaDialogFactory",null,[712]);var Nl=d(110);class Im{constructor(t){this.vab=t;this.mMe(this.vab.Hk,this.vab.oOg)}mMe(t,
N){t&&t.UH(Object(r.a)(this,this.W8c,"onEditSlideChanged"));N&&N.tha(Object(r.a)(this,this.T9c,"onPageContentLoaded"))}jQk(t,N){t&&t.Y4(Object(r.a)(this,this.W8c,"onEditSlideChanged"));N&&N.HXa(Object(r.a)(this,this.T9c,"onPageContentLoaded"))}T9c(t,N){(t=Object(Q.a)(120,N.node))&&t.DD&&(this.vab.Txb.remove(t.Bb),this.vab.$z.KIa())}W8c(t,N){N&&N.Wla&&(this.vab.$Ta=N.Wla,this.vab.$z.KIa(),this.vab.zfe=new Date)}}Object(h.a)(Im,"SlideEventListener",null,[]);class cn{constructor(t,N,ha){this.kSg="";
this.Qab=!1;this.ibb=new Date(0);this.hbb=new Date(0);this.hre=t;this.yb=N;ha&&(this.kSg=ha)}cjg(){this.Qab=!0}KIa(){this.Qab?K.a.J(591003664,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we have been paused or halted."):this.ibb>this.hbb?K.a.J(591003662,813,100,"BackgroundJobScheduler::ScheduleJob: A scan has been requested but we are already waiting for a different scan. Last scan schedule at "+this.ibb+". Last scan at "+this.hbb+"."):(this.ibb=new Date,this.yb.Cb(new aa.a(3,
1,0,Object(r.a)(this,this.oIe,"runJob"),90,this.kSg)))}oIe(){this.hbb=new Date;this.Qab?K.a.J(591003660,813,100,"BackgroundJobScheduler::RunJob: We were halted while waiting to be scheduled, so we won't do our work."):this.hre()&&this.KIa()}}Object(h.a)(cn,"BackgroundJobScheduler",null,[]);class uf{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md){this.U4c=null;this.zfe=new Date;this.$Ta=null;this.MIg={};this.CSg={};this.VSg={};this.OHg={};if(!ha)throw Error.argumentNull("graphTopologyManager");if(!za)throw Error.argumentNull("fontUtilsManager");
this.$p=ha;this.Sy=za;this.Hk=t;this.oOg=N;this.vre=vc;this.dcc=Zc;this.wre=Wc;this.M4c=Md;this.Txb=new Kg.a;this.$z=new cn(Object(r.a)(this,this.fUe,"tryScan"),Ra,"");0<qb&&window.setInterval(Object(r.a)(this,this.yDg,"logMissingFonts"),qb);this.V6j=Qb;t=ha.Ba?ha.Ba.slideIndex:0;if(N=this.$p.presentation)N=N.slides||[],t<N.length&&(this.$Ta=N[t],this.zfe=new Date)}dispose(){this.stop();this.yDg()}start(){this.stop();this.U4c=new Im(this);this.$z.KIa()}stop(){this.U4c&&this.U4c.jQk(this.Hk,this.oOg);
this.U4c=null}q3d(){const t=[];this.$Ta&&t.push(this.$Ta);return t}fUe(){const t=this.q3d();0<t.length&&(this.SIe(t[0]),this.Txb.add(t[0].Bb));return 1<t.length}Gee(t,N,ha,za){const Ra=[];for(const qb of Object.keys(t))t[qb]||this.OHg[qb]||(Ra.push(qb),this.OHg[qb]=!0);t=Ra.length;0<t&&(K.a.J(ha,820,15,"{0}",t),N&&K.a.J(za,820,15,"{0}",Ra.join(",")))}SIe(t){const N=t.gRa();if(N&&(this.vre||this.wre||this.dcc||dd.a("ShouldLogMissingThirdPartyFontCount"))){var ha={},za={},Ra={};t.Z5f.split(",").forEach(Wc=>
{Wc&&(Wc=this.Sy.HF(Wc),ha[Wc]=!1)});t.ryh.split(",").forEach(Wc=>{Wc&&(Wc=this.Sy.HF(Wc),za[Wc]=!1)});t.cCh.split(",").forEach(Wc=>{Wc&&(Wc=this.Sy.HF(Wc),Ra[Wc]=!1)});t=[];var qb=[],Qb=[];for(let Wc=0;Wc<N.length;Wc++){var vc=N[Wc];vc=Array.isArray(vc.AD())?vc.AD():null;for(const Md of vc)for(vc=0;Md.Ra&&vc<Md.Ra.length;){var Zc=Md.Ra.ga(vc);Zc=Zc.formatting?this.Sy.HF(Nl.Font.ECa(Zc.formatting.cache.eN.trim().toLowerCase())):"";gb.a.Va(Zc)||(Zc in ha&&!ha[Zc]?(t.push(Zc),ha[Zc]=!0):Zc in za&&!za[Zc]?
(qb.push(Zc),za[Zc]=!0):Zc in ha||Zc in za||Ra[Zc]||(Qb.push(Zc),Ra[Zc]=!0));vc++}}this.vre&&(uf.o8d(this.MIg,t,this.Sy),this.Gee(ha,!0,555886295,555886296));if(this.dcc||dd.a("ShouldLogMissingThirdPartyFontCount"))uf.o8d(this.CSg,qb,this.Sy),this.Gee(za,this.dcc||this.M4c,555886297,555886298);this.wre&&(uf.o8d(this.VSg,Qb,this.Sy),this.Gee(Ra,this.M4c,555886299,555886300))}}yDg(){+new Date-+this.zfe<this.V6j||(this.vre&&uf.Qee(this.MIg,this.Sy,591003669,!0,"MissingFirstPartyFonts"),(this.dcc||dd.a("ShouldLogMissingThirdPartyFontCount"))&&
uf.Qee(this.CSg,this.Sy,591003667,this.dcc||this.M4c,"MissingThirdPartyFonts"),this.wre&&uf.Qee(this.VSg,this.Sy,587337796,this.M4c,"MissingNonLoggableFonts"))}static o8d(t,N,ha){N.forEach(za=>{dd.a("ShouldNormalizeFontNamesBeforeLogging")&&(za=ha.HF(za));if(void 0===t[za]||null===t[za])t[za]=!1})}static K9i(t,N){if(!t)throw Error.argumentNull("fonts");const ha=[];for(const za of Object.keys(t))t[za]||(N.e8(za)||N.e8('"'+za+'"')||ha.push(za),t[za]=!0);return ha}static Qee(t,N,ha,za,Ra){N=uf.K9i(t,
N);t=N.length;0<t&&(N=N.join(","),za&&587337796===ha?K.a.J(ha,820,15,"{0}",N):K.a.J(ha,820,15,"{0}",za?N:t.toString()),ha=new Map,za&&ha.set("Fonts",N),ha.set("FontsCount",t.toString()),pf.Health.instance.recordQosError(Ra,["MissingFont"],!1,!1,!0,!1,Object.assign(new Ug.a,{extendedProperties:ha})))}}Object(h.a)(uf,"FontLogger",null,[106]);var Pk=d(941);class xm{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id){if(!t)throw Error.argumentNull("applicationSettings");if(!N)throw Error.argumentNull("actionManager");
if(!ha)throw Error.argumentNull("graphTopologyManager");if(!za)throw Error.argumentNull("graphActionBlockingManager");if(!Ra)throw Error.argumentNull("pptSelectionManager");if(!qb)throw Error.argumentNull("ribbonChangeManager");if(!Qb)throw Error.argumentNull("transactionFactory");if(!vc)throw Error.argumentNull("shapeEditor");if(!Zc)throw Error.argumentNull("errorHandler");if(!Wc)throw Error.argumentNull("focusManager");if(!Md)throw Error.argumentNull("sessionInfo");if(!Id)throw Error.argumentNull("mediaUploaderFactory");
this.Ha=t;this.ia=N;this.ua=ha;this.Xb=za;this.nb=Ra;this.Yx=qb;this.Fb=Qb;this.Dm=vc;this.Md=Zc;this.Fa=Wc;this.Xs=ha.presentation;this.Fe=Md;this.rbb=Id;Pk.a.MAl=this.Ha.NFh;Pk.a.HBl=this.Ha.JBl}ub(){this.ia.pa(vb.a.tIb,ff.a.application,this.msj.bind(this),4)}xe(){}msj(t,N,ha){const za=this.ua.Ba;if(!za||this.Xb.Zc(za))return 16;if(1===ha)return 32;this.jg=Aa.a.Pl("Video::Insert");try{return Jj.a.JOe(this.Ha.NFh.toString(),rl.b,()=>rl.a(t,this.pCj.bind(this),"video",this.Fe,za),"video",za,this.ua.presentation,
this.Xb,this.Md,this.jg,!0,this.rbb,this.Ha.Fpc,this.Ha.Epc,this.Ha.Dpc),this.jg&&this.jg.Wa("VideoDialogInitialized","true"),32}catch(Ra){K.a.J(509724677,818,10,"Exception {0} while rendering file selection dialog.",Ra)}this.showErrorMessage(446,null);return 8}showErrorMessage(t,N){this.jg&&(this.jg.finish(),this.jg=null);this.Md.FG(t,ha=>{ha.NB=1;ha.XPa=N;return!1})}pCj(t,N,ha,za,Ra,qb,Qb){za.rN(ha)&&K.a.J(509724676,822,15,"Video::insertVideoSuccessAfterUpload:Presentation was blocked with loader for {0} milliseconds",
+new Date-+ha.Uha);za.GJ(Qb);ha=Qb.ev();var vc=this.Xs.slideHeight;za=this.Xs.slideWidth/2-fd.a.Ff(fb.a.uX/2,0);vc=vc/2-fd.a.Ff(fb.a.uX/2,1);if(Qb&&Qb.isConnected){var Zc=this.Fb.ud(15,void 0,void 0,()=>{this.Yx.CI=this.Wcc;this.nb.selectShape(this.Wcc,!0);this.Fa.Ad()});try{Zc.kc(Qb);Zc.fd=t;Ra&&Ra.Wa("CreatingVideoShape","true");this.Wcc=this.Dm.Y4a(!1,Qb.Bb.cid,Qb.Bb.sid,0,10,za,vc,fb.a.uX,fb.a.E4,ha+1);const Wc=qb.files[0].name;this.Wcc.Cpc=N;this.Wcc.Bpc=Wc;Qb.GB(this.Wcc)}finally{Zc&&Zc.dispose()}Ra&&
(Ra.Wa("VideoShapeSuccessfullyCreated","true"),Ra.finish(),Ra=null)}}}Object(h.a)(xm,"InsertVideoActor",null,[229]);class di{constructor(){this.Pda=this.mh=this.f4=this.K=null;this.GNg=[];this.J8b=[new Nf];this.hX=[]}get name(){return"PowerPointWebEditor.Chronos2"}Wb(t){this.K=t;this.f4=this.K.resolve("PowerPointWebEditor.Core.IBundleMetricRecorder");this.mh=this.f4.NCa(5,this.name);this.Pda=this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory");for(let Ra=0;Ra<this.J8b.length;++Ra)Array.add(this.hX,
hc.a(this.J8b[Ra],5));for(const Ra of this.hX)Ra.Wb(t);const N=this.K.resolve("PowerPointWebEditor.IApplicationContext"),ha=v.AFrameworkApplication.fa.ka("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),za=rg.a.Ju(this.K.Ka("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.K.register(ho,"PowerPointWebEditor.AppForOfficeManagerFactory").as("PowerPointWebEditor.IAppForOfficeManagerFactory").na(()=>new ho(this.K.resolve("Common.IActionManager"),this.K.resolve("PowerPointWebEditor.IPPTWorkspace"),
this.K.resolve("Box4.Graph.IGraphIteratorFactory"),this.K.resolve("PowerPointWebEditor.IPPTApp"),this.K.resolve("PowerPointWebEditor.IDelayLoadedScriptResourceFactory"))).ma();this.K.register(Se,"PowerPointWebEditor.PPTVersionHistorySelectionHandler").as("Common.IVersionHistorySelectionHandler").ma().na(()=>new Se(this.K.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.K.resolve("Common.Utils.IHighContrastDetector"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IPresentationReader")));
this.K.register(pj,"Box4.Media.OneDriveFilePickerHelperV7").as("Box4.Media.IImageFilePickerHelper").ma().na(()=>new pj(t.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72"),new yc.a(()=>za.result),t.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory")));this.K.register(Ki,"Box4.Media.InsertOneDriveFileHelper").ma().na(()=>new Ki(v.AFrameworkApplication.Ta));this.K.register(dl,"Box4.Media.InsertMediaHelper").as("Box4.Media.IInsertMediaHelper").ma().na(()=>new dl);
this.K.register(Ve,"PowerPointWebEditor.InsertOnlineImageHelper").ma().na(()=>new Ve(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(Re,"PowerPointWebEditor.ChangeOnlineImageHelper").ma().na(()=>new Re(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(rk,
"Box4.Media.InsertMediaFromHostManagerFactory").as("Box4.Media.IInsertMediaFromHostManagerFactory").ma().na(()=>new rk(new Wj(new yc.a(()=>{if(v.AFrameworkApplication.Mrh()){var Ra=this.K.resolve("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").f6a;Ra=new jm(Ra.contentWindow,"*")}else Ra=N.J6i();return Ra}),ha?jb.a.AS(window.document.URL):jb.a.AS(v.AFrameworkApplication.xma),v.AFrameworkApplication.fa.appSettings.ImageFetcherSupportedExtensions)));this.K.register(xj,"Box4.Media.InsertMediaCrossDocumentMessengerFactory").as("Box4.Media.IInsertMediaCrossDocumentMessengerFactory").ma();
this.K.register(ol,"Box4.Media.InsertMediaFromHostOneDriveHostFrame").as("Box4.Media.IInsertMediaFromHostOneDriveHostFrame").ma().na(()=>new ol);this.K.register(hf,"PowerPointWebEditor.PptInsertMediaDialogFactory").as("PowerPointWebEditor.IPptInsertMediaDialogFactory").ma();this.K.register(680,"PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory").ma().na(()=>new yj);this.K.register(lf,"PowerPointWebEditor.StreamVideoPrefetchOrchestrator").ma().na(()=>new lf(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),
this.K.resolve("Box4.Graph.IGraphInstance").vd(8),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISlideReader"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Video.IStreamPreFetchService")))}init(){let t=this.mh.ju("resolvechronos2");const N=this.K.resolve("Common.AFrameworkApplication"),ha=this.K.resolve("PowerPointWebEditor.IApplicationContext"),
za=ha.ld,Ra=N.kr,qb=this.K.resolve("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory"),Qb=this.K.resolve("Common.IActionManagerExtended"),vc=this.K.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory");var Zc=this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper");const Wc=this.K.resolve("PowerPointWebEditor.IFocusManager"),Md=Ra.Hd,Id=this.K.resolve("Common.Transaction.ITransactionFactory"),Xe=this.K.resolve("PowerPointWebEditor.IShapeEditor"),of=this.K.le("PowerPointWebEditor.IClassFactory"),
ih=this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),Aj=this.K.resolve("Box4.Graph.IGraphIteratorFactory"),$f=this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),Oi=this.K.resolve("PowerPointWebEditor.ShapeEdit.IShapeCountValidator"),wk=this.K.resolve("PowerPointWebEditor.IPresentationReader"),Ti=Ra.xeb,mn=this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),ki=this.K.resolve("PowerPointWebEditor.IGraphHotColdManager"),nn=this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),
to=this.K.resolve("PowerPointWebEditor.IRibbonChangeManager"),So=this.K.resolve("PowerPointWebEditor.IShapeReader"),on=this.K.resolve("PowerPointWebEditor.View.IPPTPageView");this.mh.qu(t);t=this.mh.ju("regactorschronos2");Zc=[new Df(za,Qb,vc,this.K.Ka("PowerPointWebEditor.IAddinCommandsManager")),new vn(za,Zc,Qb,Md,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),Id,of,vc,this.K.Ka("PowerPointWebEditor.IAppForOfficeManager"),Aj,$f,Oi),new Tc(za,Qb,$f,ih,Wc,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
Id,this.K.resolve("PowerPointWebEditor.IPptInsertMediaDialogFactory"),this.K.resolve("Box4.Media.IInsertMediaFromHostManagerFactory"),this.K.resolve("Box4.Media.IInsertMediaCrossDocumentMessengerFactory"),this.K.resolve("Box4.Media.InsertMediaHelper"),this.K.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),this.K.resolve("PowerPointWebEditor.InsertOnlineImageHelper"),this.K.resolve("PowerPointWebEditor.ChangeOnlineImageHelper"),wk,Xe,So,on,to,Oi,this.K.resolve("Box4.Media.InsertMediaFromHostOneDriveHostFrame"),
this.K.resolve("Box4.Media.IImageFilePickerHelper"),this.K.resolve("Box4.Media.InsertOneDriveFileHelper"),this.K.resolve("PowerPointWebEditor.IInsertOnlineVideoDialogHelper"),this.K.resolve("PowerPointWebEditor.IInsertImageHelper"),this.K.resolve("PowerPointWebEditor.IJSanityHelper"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("Common.IExternalUICommandDefinitionMapping"),this.K.resolve("Common.IAppSettingsManager")),new ba(Qb,this.K.resolve("PowerPointWebEditor.ISlidePane"),
this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),$f,ih,to,this.K.resolve("Common.Transaction.ITransactionFactory"),Xe,this.K.resolve("PowerPointWebEditor.IErrorHandler"),Wc,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader")),new xm(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),Qb,this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),$f,ih,to,this.K.resolve("Common.Transaction.ITransactionFactory"),
Xe,this.K.resolve("PowerPointWebEditor.IErrorHandler"),Wc,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),()=>this.K.resolve("PowerPointWebEditor.IMediaUploader"))];for(const Dl of Zc)Dl.ub(),Dl.xe();vc.DCf=!0;this.mh.qu(t);v.AFrameworkApplication.fa.ff(()=>{t=this.mh.ju("regfullactorschronos2");const Dl=[new Ij(Qb,$f,Wc,ih,this.K.resolve("PowerPointWebEditor.IPPTWorkspace").yf,mn,ha.aRa().SOj,ki,this.K.resolve("PowerPointWeb.IPrinter"),this.K.resolve("PowerPointWeb.IConverter"),this.K.resolve("Box4.IAppFrame"),
nn,qb,this.K.resolve("PowerPointWebEditor.DownloadACopyAsPdfContext"),N.irmPolicyDescription,this.K.resolve("PowerPointWebEditor.IBusinessBarController"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IAppSettingsManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),()=>v.AFrameworkApplication.rO,ha.C0d(),Fk=>v.AFrameworkApplication.Aa.jb.UMe(Fk),()=>v.AFrameworkApplication.v6b,this.K.resolve("PowerPointWebEditor.IDeferredContentManager"),
this.K.resolve("PowerPointWebEditor.ICalloutNotificationAdapter")),new Xj(Ra,za.IWi,Ti.embedPreviewUrl,Qb,wk,ha.C0d(),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"))];for(const Fk of Dl)Fk.ub(),Fk.xe();this.mh.qu(t)});K.a.J(512360593,809,50,"Chronos2Package::Init");for(const Dl of this.hX)this.mh.ju(Dl.name),Dl.init(),this.mh.qu(Dl.name);t=this.mh.ju("al");this.pzj();this.mh.qu(t);v.AFrameworkApplication.fa.ff(()=>{if(za.powerPointIdeasIsEnabled){t=
this.mh.ju("idea");var Dl=this.Vzj();this.Uzj(Dl);this.mh.qu(t)}za.powerPointSmartLookupIsEnabled&&(t=this.mh.ju("smartLookup"),this.JAj(),this.mh.qu(t));v.AFrameworkApplication.kWc()&&(t=this.mh.ju("versionhistory"),this.ZAj(),this.mh.qu(t));lf.BNj(za)&&hb.a.get_instance().gk(7,()=>{this.K.resolve("PowerPointWebEditor.StreamVideoPrefetchOrchestrator").start()});const Fk=this.K.resolve("PowerPointWebEditor.IApplicationSettings");if(Fk&&(Fk.Qqh||Fk.Pqh||Fk.Rqh)){const El=!gb.a.Va(v.AFrameworkApplication.fa.Ga("TenantId"))&&
Array.contains(Fk.gnl,v.AFrameworkApplication.fa.Ga("TenantId"));this.K.register(uf,"PowerPointWebEditor.Text.FontLogger").ma().na(()=>new uf(this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("Box4.Graph.IGraphInstance").vd(8),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IFontUtilsManager"),this.K.resolve("Common.ITaskManager"),Fk.qfk,Fk.pfk,Fk.Qqh,Fk.Pqh&&v.AFrameworkApplication.fa.ka("IsO365ConsumerHost"),
Fk.Rqh,Fk.DMi&&El));Dl=this.K.resolve("PowerPointWebEditor.Text.FontLogger");this.GNg.push(Dl);Dl.start()}});v.AFrameworkApplication.dra||(t=this.mh.ju("appforoffice"),this.mzj(),this.mh.qu(t));za.Mth&&this.K.resolve("PowerPointWebEditor.ISorterViewActorMain").qee()}dispose(){for(const t of this.hX)t.dispose();for(const t of this.GNg)try{t&&t.dispose()}catch(N){K.a.J(512360592,306,10,"Exception disposing a disposable. {0} {1}",N.message,N.stack)}}pzj(){K.a.J(512360591,809,50,"Start to download augloop.hermes.js file and its dependency files");
try{const t=Zb.a.create("pptedit.augloop",null,()=>d.e(10).then(d.bind(null,1206)));if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptAugLoopRuntimeIntegrationEnabled){const N=this.K.resolve("Common.ISharedDependencyLoader"),ha=v.AFrameworkApplication.Jj("augloop-runtime-shim-ie",2);N.Cxb(ha).continueWith(()=>{Fc.a.Kx(t)})}else Fc.a.Kx(t)}catch(t){K.a.J(512360590,306,10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",t.message,t.stack)}}Vzj(){K.a.J(512360588,
809,50,"Start to download infrared.hermes.js file");var t=[this.Pda.LXb(v.AFrameworkApplication.Jj("ir-plugin-ski.min.js",5))];t=Zb.a.create("pptedit.infrared",t,()=>d.e(13).then(d.bind(null,1212)));Fc.a.Kx(t);return t}Uzj(t){K.a.J(512360587,809,50,"Start to download ideas.hermes.js file");t=this.Pda.CRd(v.AFrameworkApplication.Jj("microsoft.ideas.runtime.js",5),[t],!1);t=Zb.a.create("pptedit.ideas",[t],()=>d.e(14).then(d.bind(null,1214)));Fc.a.Kx(t)}JAj(){K.a.J(512360586,809,50,"Start to download smartlookup.hermes.js file");
const t=Zb.a.create("pptedit.smartlookup",null,()=>d.e(12).then(d.bind(null,1209)));Fc.a.Kx(t)}ZAj(){const t=this.Pda.LXb(v.AFrameworkApplication.nfa+"pptVersionHistory.js");try{Fc.a.Kx(t)}catch(N){K.a.J(512360585,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",N.toString())}}mzj(){const t=this.K.resolve("PowerPointWebEditor.IApplicationSettings");u.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").M5d()?di.U7d():t.tg?
v.AFrameworkApplication.fa.ff(di.jog):hb.a.get_instance().gk(8,()=>{di.jog()})}static main(){v.AFrameworkApplication.Vg&&Mc.a.eg?K.a.J(512360584,809,15,"Firefox attempts to load chronos2 package when App is disposing"):e.a.instance.Bc(hc.a(new di,5))}static U7d(){u.a.instance.resolve("PowerPointWebEditor.IAppForOfficeManagerFactory").q4a();e.a.instance.Bc(new Jg)}static jog(){let t=!1;try{window.self.requestIdleCallback(di.U7d)}catch(N){t=!0}t&&window.setTimeout(di.U7d,0)}}Object(h.a)(di,"Chronos2Package",
null,[2,3]);var yn=d(243),dn;(function(t){t[t.unsupported=0]="unsupported";t[t.designer=1]="designer";t[t.blank=2]="blank"})(dn||(dn={}));Object(h.b)("AgendaSlideThemeType",dn);var Kf=d(111);class Kj{constructor(){this.AgendaSlideSid=this.AgendaSlideCid=0;this.CorrelationId=null}}Object(h.a)(Kj,"AgendaApplyInfo",null,[]);class te{constructor(){this.DeckSuggestionId=this.CorrelationId=this.AgendaSessionId=null;this.FIsBlankOption=!1}}Object(h.a)(te,"AgendaThemeApplyInfo",null,[]);class mf{constructor(t,
N){this.HWd=!1;this.NBe=[];this.KWf=t;this.eRi=N}}Object(h.a)(mf,"DeckOptionInformation",null,[]);class zn{constructor(){this.QSg=this.RSg=0;this.LGg=[]}get Gmd(){return this.RSg}set Gmd(t){this.RSg=t}get Fmd(){return this.QSg}set Fmd(t){this.QSg=t}get i5a(){return this.LGg}set i5a(t){this.LGg=t}e7g(t,N,ha){const za=new C.a;if(t)for(let Ra=0;Ra<ha-1&&Ra<t.length;Ra++)za.add(new mf(t[Ra],!1));gb.a.Va(N)||za.add(new mf(N,!0));this.i5a=za.toArray()}}Object(h.a)(zn,"AgendaDeckSessionInformation",null,
[]);class Bo{constructor(){this.J7b=this.K7b=this.OEg=0;this.kre=this.lYc=this.hpe=this.R2c=null}t2k(t){t&&(this.OEg=t.body.slideIndex)}S5k(t){t.body&&t.body.outlineRequestContent&&(this.R2c=JSON.stringify(t.body.outlineRequestContent))}p2k(t){t.body&&(this.J7b=t.body.slideCId)}s2k(t){t.body&&(this.K7b=t.body.slideSId)}q2k(t){this.lYc=t.id}YDj(t){return t===this.lYc?(this.lYc=this.R2c=null,!0):!1}URj(){return!gb.a.Va(this.R2c)&&!gb.a.Va(this.lYc)}H5k(t){t.body&&t.body.outlineRequestContent&&t.body.outlineRequestContent.Slides&&
(this.hpe=t.body.outlineRequestContent.Slides.length)}r2k(t){this.kre=t.body.score}}Object(h.a)(Bo,"AgendaDetection",null,[]);class Ek{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md){this.xta=this.NA=null;this.qYc=0;this.h_=null;this.nBb="";this.o_c=!1;this.dka=0;this.v8=new C.a;this.yKg=!1;this.pi=t;this.Qb=N;this.ua=ha;this.Xb=za;this.Ha=Ra;this.zq=qb;this.Je=vc;this.nb=Zc;this.aw=Wc;this.acb=Md;this.aw.Klk(this.Ha)}wzh(){this.Roh();this.Nxi();this.fsb()?(this.h_=new zn,this.h_.Gmd=this.IK(),this.sql()):
1!==this.dka||this.Ha.oJc?2===this.dka&&this.Ha.nJc&&(this.h_=new zn,this.h_.Gmd=this.IK(),this.Zql()):this.Yql()}Nxi(){this.xta=Be.a.create().toString();this.aw.BUk(this.xta);this.aw.jjk()}hTe(t,N){if(this.NA){if(!this.NA.K7b||!this.NA.J7b){var ha=this.Qb.CG(this.NA.OEg);this.NA.K7b=ha.Bb.sid;this.NA.J7b=ha.Bb.cid}ha=this.Qb.CG(0);this.pi.generateAgendaSuggestion(ha.Bb.cid,ha.Bb.sid,this.xta,this.NA.R2c,this.wYi(),t,N)}else N(null)}Yql(){this.hTe(Object(r.a)(this,this.Cok,"onPODSTriggerAgendaConversionSuccessV1"),
Object(r.a)(this,this.a1g,"onPODSTriggerAgendaConversionFailureV1"));this.Xb.blockContent(this.ua.presentation,"ApplyAgenda",!0)}Zql(){for(let t of this.v8)t&&t.xql();this.hTe(Object(r.a)(this,this.Dok,"onPODSTriggerAgendaConversionSuccessV2"),Object(r.a)(this,this.Bok,"onPODSTriggerAgendaConversionFailureV2"))}sql(){this.hTe(Object(r.a)(this,this.Eok,"onPODSTriggerAgendaConversionSuccessV3"),Object(r.a)(this,this.b1g,"onPODSTriggerAgendaConversionFailureV3"));this.Xb.blockContent(this.ua.presentation,
"ApplyAgenda",!0)}$db(t,N){if(N.property===Vb.a.eXa&&this.qYc){t=Object(Q.a)(526,N.node);if(t.eXa===Ek.iHh)for(let ha of this.v8)ha&&ha.Hjk();else if(t.eXa===Ek.jHh){for(let ha of this.v8)ha&&ha.PYg();this.o_c=!0}this.acb.tm(Object(r.a)(this,this.$db,"onPresentationPropertyChange"));this.qYc=0}}wYi(){const t={};this.Ha.nJc&&2===this.dka&&(t.shouldGenerateThemes="true",t.themeCount="3");this.fsb()&&(t.shouldNotConvertToGVMLBytes="true",t.shouldInsertBlankSlides="true");return Kf.c(t)}mYi(t){const N=
{};N.SlideCount=this.Hj().toString();N.isBlankThemeRequest=(this.h_.i5a[t].eRi&&!this.fsb()).toString();N.isRequestForDeckDesignerForNonBlankSlides=this.fsb();return Kf.c(N)}fsb(){return this.Ha.oJc&&(1===this.dka||0===this.dka)}rql(){this.nb.Uh();const t=this.ua.presentation;if(t){const N=this.zq.ke(15);try{N.kc(t),N.fd=vb.a.DUb,t.sob=Object.assign(new Kj,{CorrelationId:this.xta,AgendaSlideSid:this.NA.K7b,AgendaSlideCid:this.NA.J7b})}finally{N&&N.dispose()}this.Xb.Jw(t,vb.a.DUb);this.Xb.GJ(t)}else this.s8c()}xzh(t){this.nb.Uh();
this.aw.dbi(this.D_d(t));const N=this.ua.presentation;if(N){const ha=this.zq.ke(15);try{ha.kc(N),ha.fd=vb.a.DUb,N.eXa=Ek.hHh,this.qYc=this.IK(),this.acb.Yj(Object(r.a)(this,this.$db,"onPresentationPropertyChange")),N.tob=Object.assign(new te,{DeckSuggestionId:this.D_d(t),AgendaSessionId:this.xta,CorrelationId:Be.a.create().toString()})}finally{ha&&ha.dispose()}this.Xb.Jw(N,vb.a.DUb);this.Xb.GJ(N)}else this.s8c()}s8c(){for(let t of this.v8)t&&t.Gjk();this.Xb.GJ(this.ua.presentation)}Cok(){this.rql();
this.o_c=!0;for(let t of this.v8)t&&t.PYg()}Dok(t){this.h_.Fmd=this.IK();const N=this.Wag(),ha=new C.a;if(t.Images)for(const za of t.Images)ha.add("data:image/jpg;base64, "+za);ha.add(N);gb.a.Va(t.BlankSuggestionId)&&(t.BlankSuggestionId=Be.a.create().toString());this.h_.e7g(t.DeckSuggestionId,t.BlankSuggestionId,Ek.gXe);for(let za of this.v8)za&&za.Jjk(ha.toArray());this.kTe(0)}Eok(){this.h_.Fmd=this.IK();this.h_.e7g(null,Be.a.create().toString(),Ek.gXe);this.kTe(0)}kTe(t){this.fsb()?this.Czh(t,
Object(r.a)(this,this.Gok,"onPODSTriggerAgendaDeckSuggestionSuccessForNonBlankTheme"),Object(r.a)(this,this.b1g,"onPODSTriggerAgendaConversionFailureV3")):this.Czh(t,Object(r.a)(this,this.Fok,"onPODSTriggerAgendaDeckSuggestionSuccess"),Object(r.a)(this,this.c1g,"onPODSTriggerAgendaDeckSuggestionFailure"))}Czh(t,N,ha){if(this.h_.Fmd<this.h_.Gmd)this.wzh();else if(this.aw.Frk(t),this.nBb=this.D_d(t),this.ERi(this.h_.i5a[t])){var za=Be.a.create().toString();this.pi.generateAgendaDeckSuggestion(this.NA.J7b,
this.NA.K7b,za,this.xta,this.nBb,this.mYi(t),N,ha);K.a.J(512496859,813,50,"AgendaConverterManager::TriggerDifferentThemeWorkflow - CorrelationID: {0}, RequestDeckSuggestionId: {1}",za,this.nBb)}else this.xXg(this.h_.i5a[t].NBe,this.nBb),this.aw.LYg(t,!0)}Fok(t){if(t.Images&&t.Images.length){var N=new C.a;for(var ha of t.Images)N.add("data:image/jpg;base64, "+ha);this.xXg(N.toArray(),t.DeckSuggestionId);if(ha=({themeIndex:t}=this.S$f(t.DeckSuggestionId)).returnValue)ha.NBe=N.toArray(),ha.HWd=!0;this.aw.LYg(t,
!1)}else this.c1g(t)}Gok(t){t.Images&&t.Images.length?this.xzh(0):this.s8c()}xXg(t,N){for(let ha of this.v8)ha&&N===this.nBb&&ha.Cjk(t)}c1g(t){try{let N;const ha=({themeIndex:N}=this.S$f(t.DeckSuggestionId)).returnValue;ha&&(ha.HWd=!1,ha.NBe=[]);this.aw.Bjk(N);if(this.nBb!==t.DeckSuggestionId)return!0}catch(N){K.a.J(512496858,813,10,"Exception in OnPODSTriggerAgendaDeckSuggestionFailure: "+N.message)}for(let N of this.v8)N&&N.OYg();return!0}a1g(){this.s8c();return!0}b1g(t){return this.a1g(t)}Bok(){const t=
this.Wag(),N=new C.a;N.add(t);for(let ha of this.v8)ha&&(ha.Ijk(N.toArray()),ha.OYg());return!0}Wag(){const t=this.Qb.CG(0);return this.Je.VP(t.Bb).image.src}pRa(t,N){try{this.NA||(this.NA=new Bo);let ha=!1;N?this.NA.YDj(t.id)&&(this.nnh(!1,this.dka),ha=!0):(this.NA.t2k(t),this.NA.S5k(t),this.NA.p2k(t),this.NA.s2k(t),this.NA.q2k(t),this.NA.r2k(t),this.Roh(),this.NA.URj()&&(this.nnh(!0,this.dka),this.NA.H5k(t)));if(!(0>=this.v8.count))for(let za of this.v8)try{za&&(ha?window.setTimeout(()=>{za.wXg()},
100):za.wXg())}catch(Ra){K.a.J(512496857,813,10,"Exception message: "+Ra.message)}}catch(ha){K.a.J(512496856,813,10,"Exception message: "+ha.message)}}uMk(t){t&&this.v8.add(t)}nul(t){this.v8.remove(t)}nnh(t,N){this.yKg=this.Ha.oJc?t:t&&0!==N}hcg(){return this.yKg&&!this.o_c}Uye(t){this.o_c=!t}Hj(){return this.ua.presentation.sJa+this.NA.hpe}Roh(){this.dka=this.Zhj();this.aw.MUk(dn[this.dka]);this.vUk()}vUk(){this.fsb()?this.aw.YGe("V3"):1!==this.dka||this.Ha.oJc?2===this.dka&&this.Ha.nJc&&this.aw.YGe("V2"):
this.aw.YGe("V1")}Zhj(){try{const t=this.Qb.hI();if(t&&0<t.length)for(const N of t)if(N){const ha=N.ThemeFamilyId;if(this.Ha.nJc&&ha.toLowerCase()===Ek.uHh.toLowerCase())return 2;if(0<=Array.indexOf(this.Ha.T9h,ha))return 1}return 0}catch(t){return K.a.J(512496855,813,10,"AgendaConverterManager::IsThemeSupportedForAgendaV1: Exception message: "+t.message),0}}D_d(t){return this.h_.i5a[t].KWf}S$f(t){let N;N=0;for(const ha of this.h_.i5a){if(ha.KWf===t)return{returnValue:ha,themeIndex:N};N++}K.a.J(512496854,
813,10,"AgendaConverterManager::GetDeckOptionInfoWithDeckSuggestionID: cannot find DeckOptionInfo with deckSuggestionId "+t);return{returnValue:null,themeIndex:N}}ERi(t){return t?!t.HWd:(K.a.J(512496853,813,10,"AgendaConverterManager::FShouldQueryFreshPreview: DeckOptionInfo is null "),!1)}dispose(){this.acb.tm(Object(r.a)(this,this.$db,"onPresentationPropertyChange"));this.qYc=0}IK(){return(new Date).getTime()}}Ek.gXe=4;Ek.uHh="62F939B6-93AF-4DB8-9C6B-D6C7DFDC589F";Ek.jHh=1;Ek.iHh=2;Ek.hHh=0;Object(h.a)(Ek,
"AgendaConverterManager",null,[106]);class io{constructor(t,N,ha){this.aw=t;this.Lc=N;this.FN=ha;this.ow()}ow(){this.Lc.DBc(Object(r.a)(this,this.rma,"onUndoRedo"))}dispose(){this.Lc.Qed(Object(r.a)(this,this.rma,"onUndoRedo"))}O2b(t,N){t===vb.a.DUb&&(this.aw.Uye(N),this.FN.Uye(N))}rma(t,N){this.O2b(N.AUe,N.L9a)}}Object(h.a)(io,"AgendaConverterUndoRedoController",null,[696]);var Qk=d(77);class vl{constructor(){this.isEntryState=!1;this.pptAppFrameDomElement=null;this.maxTryAgainCount=0}}Object(h.a)(vl,
"IAgendaSettings",null,[]);class zj{constructor(t,N,ha,za,Ra){this.eMf="HighConfidenceAgendaDetected";this.Py=null;this.va=new Qk.a;this.kYc=null;this.T5c=0;this.la=ha;this.Ws=N;this.Fa=Ra;this.Py||(N=new vl,N.isEntryState=!0,N.pptAppFrameDomElement=this.Ws.hF(),N.maxTryAgainCount=this.la.tGf,this.Py=agendaConverter.AgendaConverterFactory.CREATE_AGENDA_CONVERTER_ACTOR(N));this.lkl();this.FN=t;this.la&&this.la.mJc&&this.FN.uMk(this);this.aw=za;this.o$a=!1}wXg(){this.FN&&(this.FN.hcg()?(this.aw.uUk(this.FN.NA.kre),
this.Urh(this.kYc),1===this.FN.NA.kre&&this.va.raiseEvent(this.eMf,null)):this.v6d())}xql(){this.Py&&(this.aw.Djk(),this.Py.showAgendaToPptDialog(this.FN.Hj()),this.Fa.XRc(kd.a.sGf,kd.a.jj,document.getElementById("AgendaToPptDialogHostElement")),this.Fa.Gj(kd.a.sGf,!0),this.o$a=!0)}PYg(){this.v6d();this.aw.Fjk();window.setTimeout(()=>{this.Fql()},8E3)}Jjk(t){this.ath(t);this.aw.MYg(!0)}Ijk(t){this.ath(t);this.aw.MYg(!1)}Cjk(t){this.Rel(t)}Gjk(){this.T5c>=this.la.tGf?this.Py.showAgendaToPptDismissCard():
(this.T5c+=1,this.Py.showAgendaToPptFailureCard());this.aw.J0g()}OYg(){this.Py&&this.o$a&&this.Py.showSlidePreviewError()}Hjk(){this.Py.showMergeSlidesError();this.aw.J0g()}Urh(t){this.la.mJc&&(this.gKe(t),this.Py&&this.kYc&&this.FN&&this.FN.hcg()&&(this.Py.showAgendaCard(this.kYc,this.FN.NA.hpe),this.aw.Ajk()))}v6d(){K.a.J(538469316,829,100,"AgendaConverterView::HideAgendaEntryCard");this.Py&&!this.o$a&&(this.Py.hideAgendaCard(),this.gKe(null))}ath(t){this.Py&&this.o$a&&this.Py.populateThemesInAgendaDialog(t)}Rel(t){this.Py&&
this.o$a&&this.Py.populatePreviewSlidesInAgendaDialog(t)}gKe(t){this.kYc=t}Fql(){if(this.la.yzk)try{const t=u.a.instance.Ka("Common.ISystemInitiatedFeedback");t&&(K.a.J(562422277,813,50,"AgendaConverterView::TriggerFpsForAgendaToPpt Floodgate survey for agenda to presentation triggered"),t.execute(N=>{N.logActivity("AgendaToPresentationActivity","PowerPointAgendaToPptSurveyEnabled")}))}catch(t){K.a.J(562422278,813,10,"Exception thrown while triggering floodgate survey. Exception: {0}",t)}}lkl(){this.Py.on(zj.kHh,
()=>{this.O9h()});this.Py.on(zj.nHh,()=>{this.R9h()});this.Py.on(zj.lHh,()=>{this.P9h()});this.Py.on(zj.mHh,()=>{this.Q9h()});this.Py.on(zj.rHh,t=>{this.N9h(t)});this.Py.on(zj.oHh,t=>{this.rGf(t,!1)});this.Py.on(zj.pHh,()=>{this.S9h()});this.Py.on(zj.qHh,t=>{this.rGf(t,!0)})}O9h(){this.Zuh()}R9h(){this.aw.Hrk();this.Zuh()}P9h(){this.qGf();this.aw.tZg()}Q9h(){this.qGf();this.aw.Flk()}qGf(){this.cleanup();this.FN.nul(this)}Zuh(){this.FN.wzh()}N9h(t){this.FN.kTe(t)}rGf(t,N){this.aw.Ejk(t,N);this.o$a=
!1;this.Py.hideAgendaToPptDialog();this.FN.xzh(t)}S9h(){this.o$a=!1;this.Py.hideAgendaToPptDialog();this.aw.tZg()}cleanup(){this.gKe(null);this.T5c=0;this.Py.cleanup()}t6h(t){this.va.addHandler(this.eMf,t)}}zj.kHh="AgendaCardAddSlides";zj.nHh="AgendaCardTryAgain";zj.lHh="AgendaCardCancel";zj.mHh="AgendaCardDismiss";zj.rHh="AgendaToPptDialogThemeSuggestionSelected";zj.oHh="AgendaToPptDialogApply";zj.pHh="AgendaToPptDialogCancel";zj.qHh="AgendaToPptDialogMergeTryAgain";Object(h.a)(zj,"AgendaConverterView",
null,[697,714]);var Co=d(666);class zh{constructor(){this.ebc={}}gkd(t){this.ebc[t]=new Co.a(t,!0)}OIb(t){if(t in this.ebc){var N=this.ebc[t];N.stop();N=N.VIc;delete this.ebc[t];return N}return-1}hze(t){return t in this.ebc}}Object(h.a)(zh,"AgendaPerfLogger",null,[]);class jk{constructor(){this.fUc=this.ltg=this.ntg=this.mtg=!1}VZj(){this.fUc&&!this.mtg&&(this.mtg=!0,Hb.b(jk.fii))}w_j(){this.fUc&&!this.ntg&&(this.ntg=!0,Hb.b(jk.gii))}WYj(){this.fUc&&!this.ltg&&(this.ltg=!0,Hb.b(jk.eii))}static XXj(t){t&&
t.NS&&Hb.b(jk.dii)}}jk.fii="WAC_Exp_AgendaToPPTHighConfidenceSeen";jk.gii="WAC_Exp_AgendaToPPTHighConfidenceTried";jk.eii="WAC_Exp_AgendaToPPTHighConfidenceKept";jk.dii="WAC_Exp_AgendaToPPTIsCreateNew";Object(h.a)(jk,"ExperimentationMetrics",null,[]);class Bp{constructor(){this.aie=this.Bhe=this.Ife=this.xta=null;this.oje=!1;this.JHg=this.NEg=this.nSg=this.Ha=null;this.Ase="";this.rje=!1;this.Hfe=""}reset(){this.nSg={};this.NEg=new zh;this.JHg=new jk;this.Ase="";this.rje=!1;this.Hfe="";this.aie=this.Bhe=
this.Ife=this.xta=null;this.oje=!1}get telemetryData(){return this.nSg}get dKc(){return this.JHg}get T6(){return this.NEg}get ld(){return this.Ha}set ld(t){this.Ha=t}get vld(){return this.Ase}set vld(t){this.Ase=t}get aQa(){return this.rje}set aQa(t){this.rje=t}get qP(){return this.Hfe}set qP(t){this.Hfe=t}get wV(){return this.xta}set wV(t){this.xta=t}get oG(){return this.Ife}set oG(t){this.Ife=t}get lS(){return this.Bhe}set lS(t){this.Bhe=t}get documentOpenType(){return this.aie}set documentOpenType(t){this.aie=
t}get s4b(){return this.oje}set s4b(t){this.oje=t}}Object(h.a)(Bp,"AgendaMetricsState",null,[]);var Jm=d(753);class Rk{constructor(t,N){if(!t)throw Error.argumentNull("AgendaThemetype is null");if(!N)throw Error.argumentNull("AgendaToPptFlowVersion is null");this.Rta=new Jm.a;this.Rta.nha(Object.assign(new I.a,{name:"AgendaThemeType",string:t}));this.Rta.nha(Object.assign(new I.a,{name:"AgendaFlowVersion",string:N}))}g5(t){gb.a.Va(t)||this.Rta.nha(Object.assign(new I.a,{name:"AgendaSessionId",string:t}));
return this}jhd(t){this.Rta.nha(Object.assign(new I.a,{name:"AgendaThemeIndexSelected",int64:t}));return this}vgb(t){gb.a.Va(t)||this.Rta.nha(Object.assign(new I.a,{name:"AgendaCardState",string:t}));return this}RIa(t){gb.a.Va(t)||this.Rta.nha(Object.assign(new I.a,{name:"AgendaDialogState",string:t}));return this}uYa(t){gb.a.Va(t)||this.Rta.nha(Object.assign(new I.a,{name:"AgendaButtonClickedType",string:t}));return this}Xhd(t){gb.a.Va(t)||this.Rta.nha(Object.assign(new I.a,{name:"AgendaSeenTriedKept",
string:t}));return this}z0(t){gb.a.Va(t)||this.Rta.nha(Object.assign(new I.a,{name:"DocumentOpenType",string:t}));return this}build(){return this.Rta.dataFields}}Object(h.a)(Rk,"AgendaToPptActivityDataPointBuilder",null,[]);class Wg{constructor(){this.Rc=null;this.JVa=new Co.a("AgendaToPpt",!1);this.nMe()}nMe(){this.Rc=new Bp;this.Rc.reset();this.Rc.telemetryData.Flights="";v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.AugloopAgendaTASClassifierModelIsEnabled",
!1)&&(this.Rc.telemetryData.Flights+="AugloopAgendaTASClassifierModelIsEnabled;");this.Rc.telemetryData.InitialUserThemeType=this.Rc.qP}Klk(t){t&&(this.Rc.ld=t,this.Rc.documentOpenType=Wg.o4i(t),jk.XXj(this.Rc.ld),this.Rc.telemetryData.IsDocumentOpenTypeCreateNew=this.Rc.ld.NS.toString())}NYg(t,N){if(this.Rc.T6.hze("AgendaToPptDialogThemeApply")&&"V2"===this.Rc.oG){var ha=this.Rc.T6.OIb("AgendaToPptDialogThemeApply");this.Rc.telemetryData.TotalTimeTakenToMerge=ha.toString();Hb.a(Wg.FV,t,ha,N)}else this.Rc.T6.hze("OnAddSlidesClicked")?
(ha=this.Rc.T6.OIb("OnAddSlidesClicked"),this.Rc.telemetryData.TotalTimeTakenToMerge=ha.toString(),Hb.a(Wg.FV,t,ha,N)):this.Rc.T6.hze("OnTryAgainClicked")&&(ha=this.Rc.T6.OIb("OnTryAgainClicked"),this.Rc.telemetryData.TotalTimeTakenToMerge=ha.toString(),Hb.a(Wg.FV,t,ha,N));this.Rc.s4b=!1}Ajk(){this.Rc.s4b=!1;if(!("Seen"in this.Rc.telemetryData)){this.nM("OnAgendaCardShown");this.JVa.start();this.Rc.telemetryData.Seen="true";K.a.J(576746627,813,50,"AgendaCard shown");const t=(new Rk(this.Rc.qP,this.Rc.oG)).vgb("AgendaCardShown").Xhd("Seen").z0(this.Rc.documentOpenType).build();
Hb.a(Wg.FV,!0,0,t);this.Rc.dKc.VZj()}}jjk(){this.Rc.s4b?this.y_j():this.mXj()}mXj(){this.nM("OnAddSlidesClicked");this.JVa.stop();this.Rc.telemetryData.Tried="true";this.Rc.T6.gkd("OnAddSlidesClicked");K.a.J(576746628,813,50,"AgendaCard tried in MS:{0}",this.JVa.VIc);const t=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).vgb("AgendaCardShown").uYa("AddSlides").Xhd("Tried").z0(this.Rc.documentOpenType).build();Hb.a(Wg.FV,!0,this.JVa.VIc,t);this.Rc.dKc.w_j()}Fjk(){this.nM("OnAgendaToPPTApply");this.Rc.aQa=
!0;this.Rc.telemetryData.Kept="true";this.Rc.telemetryData.Event="AgendaCompleted";const t=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).vgb("AgendaCompleted").z0(this.Rc.documentOpenType).build();this.NYg(!0,t);K.a.J(572842050,813,50,"AgendaToPPT Completed successfully")}Hrk(){this.Rc.s4b=!0;this.nM("OnTryAgainClicked");this.Rc.telemetryData.Tried="true";this.Rc.telemetryData.Event="AgendaTryAgain";this.Rc.T6.gkd("OnTryAgainClicked");K.a.J(556561858,813,50,"AgendaCard retry attempt")}y_j(){const t=
(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).vgb("AgendaMergeError").uYa("TryAgain").Xhd("Tried").z0(this.Rc.documentOpenType).build();Hb.a(Wg.FV,!0,0,t)}Djk(){this.nM("OnAgendaDialogShown");this.Rc.lS="Loading";K.a.J(556602440,813,50,"AgendaDialog shown");const t=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).RIa(this.Rc.lS).z0(this.Rc.documentOpenType).build();Hb.a(Wg.FV,!0,0,t)}MYg(t){this.nM("OnAgendaThemePaneLoadedSuccess");this.Rc.lS=t?"ThemeSuggestions":"ThemeSuggestionsFailure";t=this.Rc.T6.OIb("OnAddSlidesClicked");
this.Rc.telemetryData.ThemePaneLoadingTime=t.toString();const N=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).RIa(this.Rc.lS).z0(this.Rc.documentOpenType).build();Hb.a(Wg.FV,!0,t,N)}dbi(t){this.nM("ThemeDeckSuggestionId");this.Rc.telemetryData.SelectedDeckSuggestionId=t}Frk(t){"V2"===this.Rc.oG&&(this.nM("OnTriggerDifferentThemeWorkflow"),this.Rc.lS="ThemeSuggestions",this.Rc.T6.gkd("TriggerDeckLevelDesigner_"+t),t=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).RIa(this.Rc.lS).jhd(t).uYa("ThemeSelected").z0(this.Rc.documentOpenType).build(),
Hb.a(Wg.FV,!0,0,t))}LYg(t,N){this.nM("OnAgendaDeckPreviewLoaded");this.Rc.lS=N?"AgendaDeckPreviewLoadedFromCache":"AgendaDeckPreviewLoaded";N=this.Rc.T6.OIb("TriggerDeckLevelDesigner_"+t);this.Rc.telemetryData["DeckPreviewLoadTime_"+t]=N.toString();t=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).RIa(this.Rc.lS).jhd(t).z0(this.Rc.documentOpenType).build();Hb.a(Wg.FV,!0,N,t)}Bjk(t){const N=this.Rc.T6.OIb("TriggerDeckLevelDesigner_"+t);this.nM("OnAgendaDeckPreviewError");this.Rc.lS="AgendaDeckPreviewError";
let ha="";"DeckPreviewFailure"in this.Rc.telemetryData&&(ha=this.Rc.telemetryData.DeckPreviewFailure.toString());this.Rc.telemetryData.DeckPreviewFailure=ha+t.toString()+";";t=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).RIa(this.Rc.lS).jhd(t).z0(this.Rc.documentOpenType).build();Hb.a(Wg.FV,!1,N,t)}Ejk(t,N){this.nM("OnAgendaDialogThemeApply");this.Rc.lS=N?"AgendaDeckMergeError":this.Rc.lS;this.Rc.T6.gkd("AgendaToPptDialogThemeApply");t=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).jhd(t).RIa(this.Rc.lS).uYa(N?
"TryAgain":"Apply").z0(this.Rc.documentOpenType).build();Hb.a(Wg.FV,!0,0,t)}tZg(){this.nM("OnCancelClicked");this.Rc.aQa=!0;this.Rc.telemetryData.Kept="false";this.Rc.telemetryData.Event="AgendaCancelled";K.a.J(572842051,813,50,"AgendaToPPT clicked Cancel button");const t=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).uYa("Cancel").z0(this.Rc.documentOpenType);"V2"===this.Rc.oG?t.RIa(this.Rc.lS):t.vgb("AgendaMergeError");Hb.a(Wg.FV,!0,0,t.build())}Flk(){this.nM("OnDismissClicked");this.Rc.aQa=!0;
this.Rc.telemetryData.Kept="false";this.Rc.telemetryData.Event="AgendaDismissed";K.a.J(556607430,813,50,"AgendaToPPT clicked Dismiss button");const t=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).uYa("Dismiss").z0(this.Rc.documentOpenType);"V2"===this.Rc.oG?t.RIa(this.Rc.lS):t.vgb("AgendaMergeError");Hb.a(Wg.FV,!0,0,t.build())}J0g(){this.nM("OnMergingErrorInAgenda");this.Rc.aQa=!0;this.Rc.telemetryData.Kept="false";this.Rc.telemetryData.Event="AgendaError";const t=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).z0(this.Rc.documentOpenType);
"V2"===this.Rc.oG?(this.Rc.lS="AgendaMergeError",t.RIa("AgendaMergeError")):t.vgb("AgendaMergeError");this.NYg(!1,t.build())}Uye(t){let N=!1;this.nM("OnUndoRedoClicked");let ha=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).z0(this.Rc.documentOpenType);if("Kept"in this.Rc.telemetryData){this.Rc.telemetryData.Kept=(!t).toString();const za=t?"UndoClicked":"RedoClicked";this.Rc.telemetryData.Event=za;ha=ha.uYa(za)}else N=!0,ha.uYa("UndoRedoPostAgendaKept");Hb.a(Wg.FV,!0,0,ha.build());K.a.J(576746629,
813,50,"AgendaToPPT did UndoRedo: {0} and IsError:{1}",(!t).toString(),N.toString())}BUk(t){this.nM("ReportCorrelationID");this.Rc.telemetryData.CorrelationId=t;this.Rc.wV=t}MUk(t){this.nM("ReportInitialUserThemeType");this.Rc.telemetryData.InitialUserThemeType=t;this.Rc.qP=t}YGe(t){this.nM("ReportAgendaToPptFlowVersion");this.Rc.telemetryData.AgendaToPptFlowVersion=t;this.Rc.oG=t}uUk(t){this.nM("ReportAgendaScore");this.Rc.telemetryData.AgendaScore=t.toString();1===t&&this.KUk()}KUk(){this.nM("ReportHighConfidenceAgendaDetected");
this.Rc.telemetryData.HighConfidenceAgendaDetected="true";this.Rc.dKc.fUc=!0}dispose(){K.a.J(576746630,813,50,"AgendaToPPTMetrics: {0}",Kf.c(this.Rc.telemetryData))}TUk(){if(!this.Rc.telemetryData||!pg.a.count(this.Rc.telemetryData))return"";const t=Kf.c(this.Rc.telemetryData);if(this.Rc.vld===t)return"";this.Rc.vld=t;if("Kept"in this.Rc.telemetryData){const N=(new Rk(this.Rc.qP,this.Rc.oG)).g5(this.Rc.wV).Xhd("Kept").z0(this.Rc.documentOpenType).build(),ha=Boolean.parse(this.Rc.telemetryData.Kept.toString());
Hb.a(Wg.FV,ha,0,N);ha&&this.Rc.dKc.WYj()}this.Rc.aQa&&(this.nMe(),this.Rc.aQa=!1);K.a.J(572663111,813,50,"AgendaToPPTMetrics: {0}; isFinalTelemetryData: {1}",this.Rc.vld,this.Rc.aQa.toString());return t}nM(t){this.Rc.telemetryData||(K.a.J(574665996,813,15,"AgendaMetrics::ValidateTelemetryData null  for method :{0}",t),this.nMe())}static o4i(t){return t.NS?"NewDocument":t.fTa?"ViewOnlyDocument":"EditDocument"}}Wg.FV="AgendaToPptEvents";Object(h.a)(Wg,"AgendaMetrics",null,[695]);class Cp{constructor(){this.Ha=
this.K=null;this.yPg=!0;this.MEg="AugLoop_AgendaDetection_AgendaDetectionAnnotation";this.FN=null}get name(){return"PowerPointWebEditor.AgendaConverter"}Wb(t){this.K=t;this.K.register(695,"PowerPointWebEditor.IAgendaMetrics").ma().na(()=>new Wg);this.K.register(Ek,"PowerPointWebEditor.AgendaConverter.AgendaConverterManager").ma().na(()=>new Ek(this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IThumbnailNavigationPaneView"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("Box4.Graph.IGraphInstance").vd(7)));this.K.register(696,
"PowerPointWebEditor.IAgendaConverterUndoRedoController").ma().na(()=>new io(this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager")));this.K.resolve("PowerPointWebEditor.IAgendaConverterUndoRedoController");const N=yn.a(this.K);dd.a("AgendaToPPT.DisableLocalizedStrings")?N("agendaConverter").then(()=>{this.K.register(697,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().na(()=>
new zj(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{}):N("powerpoint-agenda-to-ppt-strings").then(()=>{N("agendaConverter").then(()=>{this.K.register(697,"PowerPointWebEditor.AgendaConverter.IAgendaConverterView").ma().na(()=>
new zj(this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager"),this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IAgendaMetrics"),this.K.resolve("PowerPointWebEditor.IFocusManager")));this.K.resolve("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")}).catch(()=>{})}).catch(()=>{})}init(){this.K.resolve("Common.IAppSettingsManager").ff(Object(r.a)(this,this.tMk,"registerAgendaDetectionEventHandler"))}dispose(){}tMk(){this.Ha=
this.K.resolve("PowerPointWebEditor.IApplicationSettings");this.FN=this.K.resolve("PowerPointWebEditor.AgendaConverter.AgendaConverterManager");const t=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.Ha.uMi&&this.yPg&&2===t.mode&&(this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager").execute(N=>{N.Pnb(this.MEg);N.vMk(this.MEg,Object(r.a)(this.FN,this.FN.pRa,"handleAnnotationEvent"))}),this.yPg=!1)}static main(){e.a.instance.Bc(new Cp)}}Object(h.a)(Cp,"AgendaConverterPackage",
null,[2,3]);var gj=d(667);class oh{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md){this.E7b=0;this.ia=t;this.Ob=N;this.la=ha;this.Fa=za;this.fe=Ra;this.ra=qb;this.Bm=Qb;this.$D=vc;this.zu=Zc;this.wq=Wc;this.lva=Md}ub(){this.w0h();this.la.ZBk&&this.P3f()&&this.lva.continueWith(()=>{this.lva.result.logActivity("HasPresentInTeamsSeen","PresentToTeamsTeachingUIEnabled")})}w0h(){this.ia.pa(vb.a.QEb,pb.a.application,Object(r.a)(this,this.QEb,"presentToTeams"),4);this.ia.pa(vb.a.x8g,pb.a.application,Object(r.a)(this,
this.QEb,"presentToTeams"),4);this.ia.pa(vb.a.LBe,pb.a.application,Object(r.a)(this,this.QEb,"presentToTeams"),4)}bkh(){this.zu.hide();this.RXd()}RXd(){let t;Aa.a.Kmd();t=this.Wsk();this.showDialog();return t}Wsk(){this.wq.I5b=!0;const t=Be.a.create().toString(),N=this.fe.documentUrl;try{const za={};za.pptSharingUrl=gj.b(N);const Ra=encodeURIComponent(Ed.c(za));let qb=String.format("msteams:/l/present?ver={0}&deeplinkId={1}&pptContext={2}","1",t,Ra);if(!gb.a.Va(null)){const Qb=jb.a.yD(null);qb=qb+
"&fqdn="+Qb;const vc=encodeURIComponent(Ed.c({joinUrl:null}));qb=qb+"&meetingContext="+vc}var ha=qb;m.ULS.sendTraceTag(556541766,838,50,"actionId: {0}, deepLinkId: {1}",this.E7b,t);window.open(ha,"_top")}catch(za){return m.ULS.sendTraceTag(523084876,838,15,"PresentToTeamsActor: failed with error: {0}",za),!1}return!0}showDialog(){const t=new Ma.StandardDialog;t.yd=4;t.Ue(1,ResourceStrings.l_PresentToTeamsResumeInPowerPoint);t.Ue(2,ResourceStrings.l_PresentToTeamsTryAgainInTeams);t.nx(ResourceStrings.l_PresentingFileInTeamsTitle,
ResourceStrings.l_PresentingFileInTeamsMessage,0,Object(r.a)(this,this.yhc,"protocolLaunchingDialogResultHandler"))}yhc(t){1===t||0===t?(m.ULS.sendTraceTag(523084877,838,50,"PresentToTeamsActor - restarting PPT session"),this.WXa()):2===t&&(m.ULS.sendTraceTag(523084878,838,50,"PresentToTeamsActor - retry present to teams"),this.ia.processAction(vb.a.LBe,2))}WXa(){this.ia.La(vb.a.refresh,2,{refreshtrigger:"PresentToTeamsActor::RestartApplication"})}P3f(){return!!this.fe.documentUrl}QEb(t,N,ha){if(!this.P3f())return m.ULS.sendTraceTag(523084879,
838,10,"PresentToTeamsActor: Document not supported"),8;if(1===ha)return 32;this.E7b=t;if(this.Bm.isPaused)return this.Fa.Ad(),this.RXd()?32:8;this.ra.Uh();this.Fa.Ad();if(t===vb.a.LBe||1===this.Ob.mode)return this.RXd()?32:8;this.$D.G2(!0,!0,()=>{this.bkh()},()=>{m.ULS.sendTraceTag(523084880,838,15,"PresentToTeamsActor: ForceSave failed");this.bkh();return!0});this.zu.show(!1,this.E7b);return 32}a$(){}Z9(){}}Object(h.a)(oh,"PresentToTeamsActor",null,[147]);class tk{constructor(){this.K=null}get name(){return"PowerPointWebEditor.PresentToTeams"}Wb(t){this.K=
t}init(){v.AFrameworkApplication.fa.ff(()=>{(new oh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IAppFrame"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("Box4.IReplicationScheduler"),this.K.resolve("PowerPointWebEditor.Storage.ISaveAndCloseHandler"),this.K.resolve("PowerPointWebEditor.ISaveBlockingUI"),
this.K.resolve("PowerPointWebEditor.IApplicationContext"),rg.a.Ju(u.a.instance.Ka("Common.ISystemInitiatedFeedback")))).ub()})}dispose(){}static main(){e.a.instance.Bc(new tk)}}Object(h.a)(tk,"PPTWebEditorPresentToTeamsPackage",null,[2,3]);var hj=d(717),Fi=d(22);class An{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.CorrelationId=null;this.SuggestionSid=this.SuggestionCid=0}}Object(h.a)(An,"DesignerSuggestionApplyInfo",null,[]);var Lj=d(328),jo=d(518),ym=d(108);class Ol{constructor(){this.wCc=
null}}Object(h.a)(Ol,"IdeasSlideSuggestionWrapper",null,[]);var wl=d(103);class Bn{constructor(){this.trigger=null;this.cid=this.sid=0;this.cQ=null;this.timestamp=new Date;this.correlationId=Be.a.create().toString()}}Object(h.a)(Bn,"DesignerRequestData",null,[]);var ko=d(196);class th{}Object(h.a)(th,"SlideSuggestionData",null,[]);class Sc{}Sc.ufk="mivTitle";Sc.tfk="mivSubtitle";Sc.m7c="mivContainer";Sc.sfk="mivButtonsContainer";Sc.vVg="mivButton";Sc.rfk="mivButtonImage";Sc.sCb="mivOverlayContainer";
Sc.uue="mivIcon";Sc.tCb="mivTerm";Sc.xVg="mivFrame";Sc.vfk="mivView";Sc.yVg="mivIdx";Sc.wue="mivKeepFocusStart";Sc.vue="mivKeepFocusEnd";Sc.h0f="Editor";Sc.XUd="EditorContainer";Sc.fMi="EditorTitle";Sc.bMi="EditorSubtitleContainer";Sc.j0f="EditorSubtitle";Sc.QLi="EditorBucketContainer";Sc.F5a="EditorPrev";Sc.tZb="EditorPrevDisabled";Sc.Hrb="EditorPrevEnabled";Sc.WUd="EditorBucketCurrent";Sc.RLi="EditorBucketTotalCount";Sc.Z_f="EditorBucketTotal";Sc.Frb="EditorNext";Sc.Grb="EditorNextEnabled";Sc.sZb=
"EditorNextDisabled";Sc.TLi="EditorDescription";Sc.WLi="EditorIgnoreContainer";Sc.rZb="EditorIgnore";Sc.$Li="EditorSeeMoreContainer";Sc.vZb="EditorSeeMoreLabel";Sc.$_f="EditorCardContent";Sc.m0f="EditorSuggestionsContainer";Sc.EPa="EditorSuggestionContainer";Sc.cJc="EditorSuggestionArrow";Sc.cMi="EditorSuggestionCheck";Sc.l0f="EditorSuggestionText";Sc.k0f="EditorSuggestionInstances";Sc.XLi="EditorNoMoreContainer";Sc.dMi="EditorSvgCheck";Sc.gMi="EditorWhiteCheck";Sc.VLi="EditorGreenFill";Sc.ULi="EditorGreenBorder";
Sc.YLi="EditorNoMoreLabel";Object(h.a)(Sc,"IdeasCss",null,[]);class Of{}Of.E3b="IdeasPane";Of.DPa="editorSuggestionIdx";Of.tK="ClosePane";Of.Xvj="IdeasPaneOpen";Of.odc=6;Of.Pdk=3;Of.WWf="Architecture Backgrounds Cities Nature People Technology".split(" ");Object(h.a)(Of,"IdeasPaneConstants",null,[]);class zc{}zc.koc="ToolbarButton";zc.RJb="ToolbarButtonHome";zc.insertPicture="InsertPicture";zc.cPe="SlideNavigationDesignMode";zc.Wfb="Retrigger";zc.refresh="Refresh";zc.typing="Typing";zc.VXf="DesignElementsDeleted";
zc.SNd="ChangeSlideSize";zc.Mob="ApplyTheme";zc.YOe="SlideChangeLayout";zc.kHa="NewSlide";zc.JNd="ChangeIconInSmartArt";zc.Ypb="ChangeIcon";zc.insertTable="InsertTable";zc.hwa="PasteTable";zc.fSc="InsertChart";zc.gKd="ApplyReplaceObject";zc.moreIdeas="MoreIdeas";zc.newDocument="NewDocument";zc.rTd="DesignTab";zc.makeItVisual="MakeItVisual";zc.MHa="PasteText";zc.qQd="ConvertedToPPT";zc.tJd="AgendaToPPT";Object(h.a)(zc,"DesignerTrigger",null,[]);var Ni=d(167);class Wd{constructor(t,N,ha,za,Ra,qb,Qb){this.Z9b=
null;this.ua=t;this.uc=N;this.la=ha;this.Pb=za;this.U3c=(t=this.la.useWideSuggestionThumbs)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.V3c=t?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.yb=Ra;this.fe=qb;this.Sxb=Qb}Pvk(t){const N=[];try{if(!t||!t.SlideSuggestions)return K.a.J(510248778,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse"),N;for(let ha=0;ha<t.SlideSuggestions.length;ha++){if(!t.SlideSuggestions[ha])continue;
const za=t.SlideSuggestions[ha].Base64Img;let Ra=null;try{Ra=Object.assign(new th,{suggestionIndex:t.SlideSuggestions[ha].Index.toString(),suggestionCid:t.SlideSuggestions[ha].SlideId.Cid.toString(),suggestionSid:t.SlideSuggestions[ha].SlideId.Sid.toString(),imageData:za.startsWith("data:image")?za:"data:image/png;base64,"+za,label:String.format(ResourceStrings.l_DesignerSuggestionItem,ha+1)})}catch(qb){K.a.J(510248777,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),
Ra=null}Ra||(Ra=Object.assign(new th,{suggestionIndex:t.SlideSuggestions[ha].Index.toString(),suggestionSid:t.SlideSuggestions[ha].SlideSid.toString(),imageData:za.startsWith("data:image")?za:"data:image/png;base64,"+za,label:String.format(ResourceStrings.l_DesignerSuggestionItem,ha+1)}));Array.add(N,Ra)}}catch(ha){K.a.J(510248776,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",ha)}return N}S3i(t,N,ha){if(!t)throw Error.argumentNull("suggestionsContainer");
return t.querySelector("#"+N+" ."+Wd.lOa+'[correlationId="'+ha+'"]')}j4d(){return this.la.wHi?this.la.vHi:this.la.uHi}MRc(t){if(!this.la.designerIncrementalRenderEnabled)return!1;let N=!0;switch(t){case zc.moreIdeas:N=!1;break;case zc.newDocument:N=!1}return N}IGe(t){K.a.J(510248775,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, FirstRender:{1}",this.Pb.correlationId,t.k6a);if(t.lrb&&t.cKc&&t.pfa){var N=this.G9d(),ha=t.pfa.parentNode.parentNode.id;if(t.KOe&&this.la.pPa&&t.k6a)switch(t.lrb.DocumentUpsellStatus){case 0:this.R3h(t.pfa);
break;case 1:this.j2h(t.pfa);break;case 2:this.S1h(t.pfa)}t.k6a&&this.la.mJc&&this.Zfh(t.pfa);var za;if(za=t.k6a?this.Yyi(t.cKc,t.Jh,t.pfa,N,t.nod):this.S3i(t.pfa,ha,t.Jh))try{const qb=this.Pb.qOa,Qb=!Ff.a.Va(qb)&&ha===Of.E3b,vc=this.rhi(t.lrb,Qb,qb);if(t.k6a){this.Pb.pSe=new Date;t.nod&&this.Nil(t.aQi);for(var Ra=0;Ra<za.childNodes.length;Ra++){let Zc=za.childNodes[Ra];t.nod&&this.Pbl(vc,Ra)?Wd.fel(N,Ra,Zc):this.EGe(Qb?qb[Ra].Type:0,t.pfa,Zc,ha,t.cKc,vc[Ra.toString()],Ra,t.KOe,t.lrb.DocumentUpsellStatus)}this.la.lia&&
t.lrb.HasPaginationInfo&&this.Lsh(t.pfa,t.Jh)}else if(t.nod){K.a.J(510248774,829,50,"DesignerViewHelper:RenderSuggestions. CorrelationId:{0}, Incremental Render. suggestionDataDict Count:{1}",this.Pb.correlationId,pg.a.count(vc));for(Ra of Object.keys(vc)){const Zc=parseInt(Ra);let Wc=t.pfa.querySelector("#"+ha+" ["+Wd.OAa+'="'+Zc+'"]');vc[Ra]&&Wc&&Sys.UI.DomElement.containsCssClass(Wc.firstChild,"IncSuggestionPlaceholder")&&this.EGe(Qb?qb[Zc].Type:0,t.pfa,Wc,ha,t.cKc,vc[Ra],Zc,t.KOe,t.lrb.DocumentUpsellStatus)}}}catch(qb){K.a.J(510248773,
829,10,"DesignerViewHelper:RenderSuggestions - exception. CorrelationId:{0}, Error:{1}",this.Pb.correlationId,qb)}}}GTk(t,N,ha,za){try{if(!(t&&t.SlideSuggestions&&t.SlideSuggestions.length&&N))return!1;this.cRc(N);const Ra=N.querySelector("."+Wd.lOa);if(!Ra)return!1;const qb=Ra.childNodes.length,Qb=Ra.childNodes.length+t.SlideSuggestions.length,vc=this.G9d(),Zc=N.parentNode.parentNode.id;for(let Wc=0;Wc<t.SlideSuggestions.length;++Wc){const Md=this.cUf(qb+Wc,Qb,vc);this.EGe(0,N,Md,Zc,Qb,t.SlideSuggestions[Wc],
qb+Wc,za,t.DocumentUpsellStatus);Ra.appendChild(Md)}t.HasPaginationInfo&&this.Lsh(N,ha);return!0}catch(Ra){return K.a.J(510248772,829,10,"DesignerViewHelper:RenderMoreIdeas - Exceptionstion {0}",Ra),!1}}rhi(t,N,ha){const za={};if(N)for(const Ra of ha)switch(Ra.Type){case 0:N=Ra;ha=null;for(const qb of t.SlideSuggestions)if(qb.Index===N.IndexInDesigner){ha=qb;break}za[Ra.Index.toString()]=ha;break;default:za[Ra.Index.toString()]=Ra}else for(const Ra of t.SlideSuggestions)za[Ra.Index.toString()]=Ra;
return za}Pbl(t,N){N=N.toString();return!(N in t)||!t[N]}R3h(t){const N=kb.a.Ce();N.className="DesignerFreeTrialCardContainer";const ha=kb.a.Ce();ha.className="DesignerFreeTrialCardTitle";ha.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialTitle;const za=kb.a.Ce();za.className="DesignerFreeTrialCardContent";za.innerText=String.format(ResourceStrings.l_DesignerUpsellStartFreeTrialContent,this.j4d());const Ra=kb.a.Ce();Ra.className="DesignerStartFreeTrialButtonsContainer";const qb=kb.a.Ce();
qb.className=Wd.xpb;qb.innerText=ResourceStrings.l_DesignerUpsellStartFreeTrialButtonText;qb.tabIndex=0;qb.setAttribute(oa.a.Wr,qb.innerText);qb.setAttribute(oa.a.Ye,oa.a.hu);const Qb=kb.a.Ce();Qb.className=Wd.xDc;const vc=document.createElement("i");vc.className=Wd.DDc;vc.style.lineHeight="20px";vc.setAttribute("Unselectable","on");const Zc=kb.a.Ce();Zc.className="DesignerStartTrialGoPremiumButtonText";Zc.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Zc.setAttribute("Unselectable","on");
Qb.setAttribute(oa.a.Wr,Zc.innerText);Qb.setAttribute(oa.a.Ye,oa.a.hu);Qb.tabIndex=0;Qb.appendChild(vc);Qb.appendChild(Zc);Ra.appendChild(qb);Ra.appendChild(Qb);N.appendChild(ha);N.appendChild(za);N.appendChild(Ra);N.setAttribute(oa.a.Wr,String.format("{0}. {1}",ha.innerText,za.innerText));N.setAttribute(oa.a.Ye,oa.a.GAa);t.appendChild(N)}tUf(){const t=kb.a.Ce();t.className="DesignerInFreeTrialView";const N=document.createElement("i");N.className=v.AFrameworkApplication.isRtl?"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIconRTL":
"ms-Icon ms-Icon--Diamond DesignerInFreeTrialViewIcon";const ha=kb.a.Ce();ha.className=Wd.CVb;ha.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;ha.tabIndex=0;const za=kb.a.Ce();za.className=v.AFrameworkApplication.isRtl?"DesignerInFreeTrialViewTextRTL":"DesignerInFreeTrialViewText";za.innerText=ResourceStrings.l_DesignerUpsellInFreeTrialText;ha.setAttribute(oa.a.Ye,oa.a.RKd);ha.setAttribute(oa.a.Pob,oa.a.lqa);ha.setAttribute(oa.a.Wr,ha.innerText);t.appendChild(N);t.appendChild(ha);t.appendChild(za);
t.setAttribute(oa.a.Wr,ha.innerText+" "+za.innerText);t.setAttribute(oa.a.Ye,oa.a.GAa);return t}fql(){const t=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(t)for(let N=0;N<t.length;N++){const ha=t[N];if(ha.parentNode){const za=this.tUf();ha.parentNode.replaceChild(za,ha)}}this.wCh()}j2h(t){const N=this.tUf();t.appendChild(N)}S1h(t){const N=kb.a.Ce();N.className="DesignerFreeTrialCardContainer";const ha=kb.a.Ce();ha.className="DesignerFreeTrialCardTitle";ha.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedTitle;
const za=kb.a.Ce();za.className="DesignerFreeTrialCardContent";za.innerText=ResourceStrings.l_DesignerUpsellFreeTrialExhaustedContent;const Ra=kb.a.Ce();Ra.className=Wd.BVb;const qb=document.createElement("i");qb.className=Wd.DDc;qb.style.lineHeight="20px";const Qb=kb.a.Ce();Qb.className="DesignerTrialExhaustedGoPremiumButtonText";Qb.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;Ra.setAttribute(oa.a.Wr,Qb.innerText);Ra.setAttribute(oa.a.Ye,oa.a.hu);Ra.tabIndex=0;Ra.appendChild(qb);Ra.appendChild(Qb);
N.appendChild(ha);N.appendChild(za);N.appendChild(Ra);N.setAttribute(oa.a.Wr,String.format("{0}. {1}",ha.innerText,za.innerText));N.setAttribute(oa.a.Ye,oa.a.GAa);t.appendChild(N)}Lsh(t,N){const ha=kb.a.Ce();ha.className=Wd.JMd;ha.setAttribute(Wd.wpb,N);ha.tabIndex=0;N=new Fd.a;N.gh(16,16);N.gxa("0,0,2048,2048");const za=new Ni.a;za.y0("M 1536 138 q 115 66 209 160 q 94 93 162 207 q 67 114 104 246 q 37 131 37 273 q 0 141 -36 272 q -37 131 -104 245 q -67 113 -160 207 q -94 93 -207 160 q -114 67 -245 104 q -131 36 -272 36 q -141 0 -272 -36 q -131 -37 -244 -104 q -114 -67 -207 -160 q -94 -94 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -145 39 -278 q 38 -134 108 -249 q 69 -116 167 -210 q 97 -94 216 -159 h -530 v -128 h 768 v 768 h -128 v -553 q -113 54 -207 137 q -95 83 -162 188 q -68 104 -105 227 q -38 123 -38 257 q 0 124 32 238 q 32 114 91 214 q 58 99 140 181 q 82 82 182 141 q 99 58 214 90 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -90 q 99 -59 181 -141 q 82 -82 141 -181 q 58 -100 90 -214 q 32 -115 32 -238 q 0 -114 -27 -220 q -28 -106 -78 -200 q -50 -94 -121 -173 q -71 -80 -158 -141 z");
N.appendChild(za);N=N.xa;N.setAttribute("class","DesignerMoreIdeasButtonIcon");ha.appendChild(N);N=kb.a.Ce();N.className="DesignerMoreIdeasButtonLabel";N.innerText=ResourceStrings.l_DesignerSeeMoreIdeas;ha.appendChild(N);ha.setAttribute(oa.a.Wr,N.innerText);ha.setAttribute(oa.a.Ye,oa.a.hu);t.appendChild(ha)}tel(t){if(t){var N=kb.a.SB();N.className="DesignerMoreIdeasLoading";N.src=dh.a.uK(fb.a.Dma);t.appendChild(N)}}cRc(t){if(t){var N=t.querySelector("."+Wd.JMd);N&&t.removeChild(N);(N=t.querySelector(".DesignerMoreIdeasLoading"))&&
t.removeChild(N)}}Yyi(t,N,ha,za,Ra){const qb=kb.a.Ce();qb.className=Wd.lOa;qb.setAttribute(Wd.wpb,N);qb.setAttribute(oa.a.Wr,ResourceStrings.l_DesignerSuggestions);qb.setAttribute(oa.a.Ye,oa.a.NUb);Ra&&(this.Pb.OVb=this.x0i());for(N=0;N<t;++N)qb.appendChild(this.cUf(N,t,za));ha.appendChild(qb);return qb}cUf(t,N,ha){const za=kb.a.Ce();za.className=ha?this.U3c+"4x3":this.U3c;za.setAttribute(Wd.OAa,t);za.tabIndex=0;za.setAttribute(oa.a.Wr,String.format(ResourceStrings.l_DesignerSuggestionItem,t+1));
za.setAttribute(oa.a.Ye,oa.a.UNa);za.setAttribute(oa.a.TKd,t+1);za.setAttribute(oa.a.UKd,N);return za}EGe(t,N,ha,za,Ra,qb,Qb,vc,Zc){let Wc=null;this.la.designerIncrementalRenderEnabled&&(N&&(Wc=N.querySelector("#"+za+' [IncSuggestionPlaceholder="'+Qb+'"]')),Wc&&Sys.UI.DomElement.addCssClass(Wc,"ShimmerPaused"),this.RYj(Qb,Ra));N=!1;switch(t){case 0:this.P7k(ha,qb,Qb);N=(t=vc&&this.la.pPa)&&1!==Zc;Ra=za=Zc=!1;if(qb&&qb.Categories)for(const Md of qb.Categories)2===Md?Zc=vc&&!t:1===Md?za=!0:3===Md?Ra=
!0:4===Md&&this.R7d(ha,"commoncontrolsmartalignandspace.svg",ResourceStrings.l_DesignerFixItSuggestionItem,Qb);(Zc||N)&&this.F8k(ha);za?this.R7d(ha,"commoncontrolvideocamerawithwhiteborder_24.svg",ResourceStrings.l_DesignerLoopingVideoSuggestionItem,Qb):Ra&&(this.R7d(ha,"commoncontrolanimationsuggestioniconnoborder.svg",ResourceStrings.l_DesignerAnimationSuggestionItem,Qb),ha.setAttribute(Wd.BMd,Wd.BMd),ha.setAttribute("title",ResourceStrings.l_DesignerAnimationSuggestionTooltip));this.la.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.Designer.EnableDesignDescriptions",
!1)&&this.u1h(ha,qb);break;case 1:this.ETk(ha,qb);break;case 2:this.vTk(ha);break;case 3:case 4:this.QTk(ha,qb)}Wc&&Wc.parentNode.removeChild(Wc);qb=kb.a.Ce();qb.className=Wd.HDc;N&&(qb.style.visibility=ab.a.visible,ha.removeAttribute("tabindex"),ha.setAttribute(oa.a.pK,oa.a.KB));ha.appendChild(qb)}ETk(t,N){if(N){t.className=Sc.m7c;t.setAttribute(oa.a.Wr,ResourceStrings.L_MakeItVisualCardTitle);var ha=kb.a.Fn();ha.className=Sc.ufk;ha.innerText=ResourceStrings.L_MakeItVisualCardTitle;var za=kb.a.Fn();
za.className=Sc.tfk;za.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var Ra=kb.a.Ce();Ra.className=Sc.sfk;Ra.setAttribute(oa.a.Ye,oa.a.NUb);var qb=0,Qb=new Kg.a,vc=Math.min(Of.odc,N.SearchTerms.length);for(let Zc=0;Zc<vc;Zc++)qb=this.JUf(N.SearchTerms[Zc].Term,Ra,Qb,Zc,qb);for(N=vc;N<Of.odc;N++)for(const Zc of Of.WWf)if(!Qb.contains(Zc)){qb=this.JUf(Zc,Ra,Qb,N,qb);break}t.appendChild(ha);t.appendChild(za);t.appendChild(Ra);this.Pb.E6c=!0}}JUf(t,N,ha,za,Ra){const qb=kb.a.Ce();qb.className=Sc.vVg;
qb.setAttribute(oa.a.Ye,oa.a.UNa);const Qb=Sc.tCb+"."+za,vc=kb.a.SB();vc.className=Sc.rfk;vc.src=({Rub:Ra}=this.j9i(t,ha,Ra)).returnValue;vc.setAttribute(oa.a.W1,Qb);ha=kb.a.Ce();ha.className=Sc.sCb;ha.tabIndex=0;ha.setAttribute(Sc.yVg,za);ha.setAttribute(oa.a.Ye,oa.a.hu);za=document.createElement("i");za.className=Sc.uue;za.innerText="\ue721";za.setAttribute(oa.a.Ye,oa.a.KM);const Zc=kb.a.Fn();Zc.className=Sc.tCb;Zc.innerText=t;Zc.id=Qb;qb.appendChild(vc);qb.appendChild(ha);ha.appendChild(za);ha.appendChild(Zc);
N.appendChild(qb);return Ra}j9i(t,N,ha){for(const za of Of.WWf)if(za.toLowerCase()===t.toLowerCase())return N.add(za),{returnValue:this.fe.hk(t+".png"),Rub:ha};return{returnValue:this.fe.hk("stock"+ha++ +".png"),Rub:ha}}O7k(t,N){if(t){var ha=document.createElement("video");ha.className="SuggestedVideoBackgroundContainer";ha.setAttribute("Src",N);ha.setAttributeNode(document.createAttribute("muted"));ko.a.fOj()||(ha.setAttributeNode(document.createAttribute("autoplay")),ha.setAttributeNode(document.createAttribute("loop")),
ha.addEventListener("canplay",()=>{ha.muted="true";ha.play()}));t.appendChild(ha)}}R7d(t,N,ha,za){if(t){var Ra=kb.a.SB();Ra.src=this.fe.hk(N);Ra.className="SuggestedMediaIcon";N=kb.a.Fn();N.className="SuggestedMediaContainer";N.appendChild(Ra);t.setAttribute(oa.a.Wr,String.format(ha,za+1));N.setAttribute("aria-hidden",oa.a.KB);N.setAttribute("Unselectable","on");t.appendChild(N)}}u1h(t,N){t&&N&&N.DesignDescription&&0!=N.DesignDescription.length&&t.setAttribute(oa.a.Wr,N.DesignDescription)}F8k(t){if(t)if(this.la.pPa)Sys.UI.DomElement.addCssClass(t,
ab.a.mgc);else{t.setAttribute(Wd.ADc,Wd.ADc);var N=t.getAttribute(oa.a.Wr);N&&t.setAttribute(oa.a.Wr,String.format("{0}. {1}",N.toString(),ResourceStrings.l_DesignerPremiumSuggestionItem));oa.a.BO(t,oa.a.Pob,oa.a.lqa);N=kb.a.Ce();N.className=Wd.GDc;var ha=document.createElement("i");ha.className=Wd.DDc;N.appendChild(ha);t.appendChild(N)}}wCh(){const t=document.getElementsByClassName(Wd.DVb);if(t)for(let N=0;N<t.length;N++){Sys.UI.DomElement.removeCssClass(t[N].parentNode,ab.a.mgc);t[N].parentNode.tabIndex=
0;t[N].parentNode.removeAttribute(oa.a.pK);const ha=sa.a.$ba(t[N].parentNode,Wd.HDc);!ha||ha.getAttribute(Wd.PMd)&&ha.getAttribute(Wd.PMd).toString()===Wd.vMf||(ha.style.visibility=ab.a.hidden)}}Oul(){if(this.la.pPa){var t=document.getElementsByClassName("DesignerFreeTrialCardContainer");if(t)for(var N=0;N<t.length;N++)t[N].parentNode.removeChild(t[N]);if(t=document.getElementsByClassName("DesignerInFreeTrialView"))for(N=0;N<t.length;N++)t[N].parentNode.removeChild(t[N]);this.wCh()}else if(t=document.getElementsByClassName(Wd.GDc))for(N=
0;N<t.length;N++){t[N].style.display="none";const za=t[N].parentNode;za.removeAttribute(Wd.ADc);za.removeAttribute(oa.a.Pob);var ha=za.getAttribute(oa.a.Wr);ha&&(ha=ha.toString(),ha=ha.replace(ResourceStrings.l_DesignerPremiumSuggestionItem,""),za.setAttribute(oa.a.Wr,ha))}}P7k(t,N,ha){if(t&&N)try{let za=!1;try{t.setAttribute(Wd.zpb,N.SlideId.Sid),t.setAttribute(Wd.OMd,N.SlideId.Cid),za=!0}catch(qb){K.a.J(510248771,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),
za=!1}za||t.setAttribute(Wd.zpb,N.SlideSid);const Ra=kb.a.SB();Ra.className=Wd.DVb;Ra.src=N.Base64Img;this.Pb.Zqa.contains(N.Index)||this.Pb.Zqa.add(N.Index);this.la.XHc&&!gb.a.Va(N.DesignerMediaURL)&&N.Categories&&Ff.a.contains(N.Categories,1)&&this.O7k(t,N.DesignerMediaURL);t.appendChild(Ra);K.a.J(510248770,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",ha,this.Pb.correlationId)}catch(za){t.parentNode.removeChild(t),K.a.J(510248769,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",
ha,this.Pb.correlationId,za)}}vTk(t){if(Ff.a.Va(this.Pb.RV)||!this.Pb.Qui())t.style.display=ab.a.none;else{t.className=Sc.XUd;var N=kb.a.Fn();N.className=Sc.fMi;N.innerText=ResourceStrings.L_ConsistencyCardTitle;var ha=kb.a.Ce();ha.className=Sc.bMi;var za=kb.a.Fn();za.className=za.id=Sc.j0f;za.innerText=za.title=this.Pb.RV[0].critiques[0].explanationLabel;var Ra=kb.a.Ce();Ra.className=Sc.QLi;var qb=kb.a.Fn();qb.innerText="<";qb.tabIndex=0;Sys.UI.DomElement.addCssClass(qb,Sc.F5a);Sys.UI.DomElement.addCssClass(qb,
Sc.tZb);qb.id=Sc.F5a;var Qb=kb.a.Fn();Qb.innerText="1";Qb.id=Sc.WUd;this.Pb.VM=0;var vc=kb.a.Fn();vc.innerText="/";var Zc=kb.a.Fn();Zc.className=Sc.RLi;Zc.id=Sc.Z_f;Zc.innerText=this.Pb.RV.length.toString();var Wc=kb.a.Fn();Wc.innerText=">";Wc.tabIndex=0;Wc.className=Wc.id=Sc.Frb;0<this.Pb.RV.length-1?Sys.UI.DomElement.addCssClass(Wc,Sc.Grb):Sys.UI.DomElement.addCssClass(Wc,Sc.sZb);Ra.appendChild(qb);Ra.appendChild(Qb);Ra.appendChild(vc);Ra.appendChild(Zc);Ra.appendChild(Wc);ha.appendChild(za);ha.appendChild(Ra);
za=kb.a.Fn();za.className=Sc.TLi;za.innerText=ResourceStrings.L_ConsistencyCardDescription;Ra=Wd.fUf();this.pkg(Ra,0);qb=kb.a.Ce();qb.className=Sc.WLi;Qb=kb.a.Ce();Qb.className=Sc.rZb;Qb.innerText=ResourceStrings.L_ConsistencyCardIgnore;Qb.title=ResourceStrings.L_ConsistencyCardIgnoreTitle;Qb.tabIndex=0;qb.appendChild(Qb);Qb=kb.a.Ce();Qb.className=Sc.$Li;vc=kb.a.Fn();vc.className=Sc.vZb;vc.innerText=ResourceStrings.L_ConsistencyCardSeeMore;vc.tabIndex=0;Qb.appendChild(vc);vc=kb.a.Ce();vc.id=Sc.$_f;
vc.appendChild(ha);vc.appendChild(za);vc.appendChild(Ra);vc.appendChild(qb);t.appendChild(N);t.appendChild(vc);t.appendChild(Qb);this.Pb.bJc=!0}}QTk(t,N){if(N){t.className=Wd.EMf;t.setAttribute(oa.a.Wr,N.TitleText);t.setAttribute(Wd.OAa,N.Index);var ha=this.skl(N.ExecutionActionName);if(ha){var za=kb.a.SB();za.src=this.fe.hk("pegal.png");za.className=ha;var Ra=kb.a.Fn();Ra.className="cui-img-container cui-img-24by24";Ra.appendChild(za);t.appendChild(Ra)}za=kb.a.Fn();za.className="DesignerSuggestedActionTitle";
za.innerText=N.TitleText;Ra=kb.a.Fn();Ra.className="DesignerSuggestedActionSubtitle";Ra.innerText=N.DescriptionText;N=kb.a.Ce();N.className=ha?"DesignerSuggestedActionDescriptionWithIcon":"DesignerSuggestedActionDescription";N.appendChild(za);N.appendChild(Ra);t.appendChild(N)}}Zfh(t){try{if(this.Sxb&&this.Sxb.instance){const N=kb.a.Ce();N.id="AgendaCardContainer";N.className="AgendaCardContainer";t.appendChild(N);this.Sxb.instance.Urh(N)}}catch(N){K.a.J(510248768,829,10,"DesignerViewHelper:RenderAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",
this.Pb.correlationId,N)}}Coi(){try{this.Sxb&&this.Sxb.instance&&this.Sxb.instance.v6d()}catch(t){K.a.J(510248729,829,10,"DesignerViewHelper:CleanUpAgendaCard failed with Exception. CorrelationId:{0}, Exception:{1}",this.Pb.correlationId,t)}}skl(t){switch(t){case "PowerPointConvertImageToTable":return"pegal_ImageToTable_24x24x32";default:return null}}pkg(t,N){N=this.Pb.RV[N].critiques[0].suggestions;const ha=Math.min(Of.Pdk,N.length);for(let za=0;za<ha;za++)this.Nqj(t,N[za].description,N[za].numberOfInstances,
za)}Nqj(t,N,ha,za){const Ra=kb.a.Ce();Ra.className=Sc.EPa;Ra.tabIndex=0;Ra.setAttribute(Of.DPa,za);const qb=kb.a.Fn();qb.className=Sc.cJc;qb.innerText="\u2192";qb.setAttribute(Of.DPa,za);const Qb=kb.a.Fn();Qb.className=Sc.l0f;Qb.innerText=N;Qb.setAttribute(Of.DPa,za);N=kb.a.Fn();N.className=Sc.k0f;N.innerText=String.format("[{0}]",ha);N.setAttribute(Of.DPa,za);Ra.appendChild(qb);Ra.appendChild(Qb);Ra.appendChild(N);t.appendChild(Ra)}Nil(t){this.pkd();this.Z9b=new aa.a(2,1,this.la.designerIncrementalRenderTimeoutInMs,
()=>{this.QYj(t)},void 0,"IncrementalRenderTimeoutTask");this.yb.Cb(this.Z9b)}pkd(){this.Z9b&&(this.yb.Ng(this.Z9b),this.Z9b=null)}QYj(t){this.pkd();for(let N=0;N<t;N++)this.Pb.Zqa.contains(N)||this.Pb.LRc.add(N)}RYj(t,N){if(!this.Pb.pOa.contains(t)&&(this.Pb.pOa.add(t),t=this.Pb.pOa.count,t===N&&(this.Pb.kUb=new Date,this.pkd()),!this.Pb.dLb&&t>=this.Pb.OVb)){for(N=0;N<this.Pb.OVb;N++)if(!this.Pb.pOa.contains(N))return;this.Pb.dLb=new Date}}x0i(){const t=document.getElementById("WACDocumentPanel");
if(t){const N=this.la.useWideSuggestionThumbs,ha=this.G9d();return Math.floor((t.offsetHeight-87)/(N||ha?135:101))}return 1}G9d(){const t=this.su();return.01>=Math.abs(t.width/t.height-1.33)}vPf(t,N){this.PVe(this.Qsb(t,N),N,!1)}qmh(t,N){this.PVe(t,N,!0)}Ptl(t){if(t&&(t=t.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var N=-1!==t.className.indexOf("4x3");this.PVe(t,N,!1)}}PVe(t,
N,ha){t&&(ha?(t.className=N?this.V3c+"4x3":this.V3c,oa.a.BO(t,oa.a.L3a,oa.a.KB)):(t.className=N?this.U3c+"4x3":this.U3c,oa.a.BO(t,oa.a.L3a,oa.a.lqa)))}su(){return this.uc.su()}Qsb(t,N){return t.querySelector("."+(N?this.V3c+"4x3":this.V3c))}get Ba(){return Object(Q.a)(120,this.ua.Ba)}Jkh(t,N){if(t){if(t=t.querySelector("["+Wd.OAa+'="'+N+'"]'))N=gd.a.ei(t),t.contains(gd.a.GQa(new Sys.UI.Point(N.x,N.y)))&&t.contains(gd.a.GQa(new Sys.UI.Point(N.x+N.width-1,N.y)))?t.contains(gd.a.GQa(new Sys.UI.Point(N.x,
N.y+N.height-1)))&&t.contains(gd.a.GQa(new Sys.UI.Point(N.x+N.width-1,N.y+N.height-1)))||t.scrollIntoView(!1):t.scrollIntoView(!dd.a("Designer.ScrollIntoViewFix"))}else K.a.J(510248728,829,15,"Designer view has been removed from DesignerViewContainer")}static pTd(t){let N=null;try{N=Ed.a(t)}catch(ha){K.a.J(510248727,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return N}static jvk(t){const N=t.CardData;let ha=null;try{if(ha=Ed.a(N),!t.SlideSuggestions&&
ha)for(ha=Jl.e(ha,za=>0!==za.Type),t=0;t<ha.length;t++)ha[t].Index=t}catch(za){K.a.J(510248726,829,10,"parsing cards failed with exception: {0}",za)}return ha}static fel(t,N,ha){ha.style.backgroundColor="white";const za=kb.a.Ce();za.className=t?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";za.setAttribute("IncSuggestionPlaceholder",N);(Mc.a.Nj||Mc.a.eg)&&Sys.UI.DomElement.addCssClass(za,"Shimmer");ha.appendChild(za)}static fUf(){const t=kb.a.Ce();t.className=
t.id=Sc.m0f;return t}}Wd.lOa="DesignerSuggestionList";Wd.wpb="correlationId";Wd.OAa="suggestionIndex";Wd.zpb="slideId";Wd.OMd="slideCid";Wd.ADc="isShownAsPremiumContent";Wd.BMd="containsAnimation";Wd.vMf="Refreshing";Wd.PMd="SourceTrigger";Wd.DVb="SuggestionImg";Wd.DDc="ms-Icon ms-Icon--Diamond";Wd.GDc="ShadowedTriangleContainer";Wd.HDc="DesignerSuggestionListDisabled";Wd.JMd="DesignerMoreIdeasButton";Wd.EMf="DesignerSuggestedActionResult";Wd.CVb="DesignerInFreeTrialViewGoPremiumText";Wd.BVb="DesignerFreeTrialCardGoPremiumButton";
Wd.xpb="DesignerStartFreeTrialButton";Wd.xDc="DesignerStartFreeTrialGoPremiumButton";Object(h.a)(Wd,"DesignerViewHelper",null,[684]);class Do{constructor(){this.cid=this.sid=0;this.mRc=this.cQ=this.trigger=null}}Object(h.a)(Do,"PendingRequest",null,[]);class xl{constructor(){this.Nqe=!1;this.Tzb=null}get Gyg(){return this.Nqe}get GBg(){return this.Tzb}static get inProgress(){const t=new xl;t.Nqe=!0;t.Tzb=new Date;return t}static get ready(){const t=new xl;t.Nqe=!1;t.Tzb=null;return t}}Object(h.a)(xl,
"RequestState",null,[]);var Eg=d(327),Eo=d(424);class Sh{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of,ih,Aj,$f,Oi,wk,Ti,mn,ki,nn,to,So,on,Dl,Fk,El,Mn){this.zL=null;this.aHa=this.dJg=0;this.cMg=!1;this.ATa=this.Ycb=null;this.UGg=!1;this.Fo=Qb;this.Xq=vc;this.Yq=Zc;this.Ry=Wc;this.Pb=Md;this.ia=t;this.hT=N;this.nb=Ra;this.Fa=qb;this.ua=Id;this.Ig=Xe;this.Lc=of;this.la=Aj;this.Xb=ha;this.Fb=za;this.pi=$f;this.ila=Oi;this.rla=xl.ready;this.P8=wk;this.Mb=Ti;this.Mc=mn;this.yb=ki;this.WBb=nn;this.a9b=
on;this.uc=Dl;this.wL=Fk;this.aw=El;this.LEg=Mn;this.cJg=Object(r.a)(this,this.Lnj,"handleFirstRunExperienceEvent");So&&So.isFeatureEnabled("PowerPointEnterpriseDesigner",!1).then(qm=>{this.cMg=qm;return null});this.ia.Jma(this)}ub(){this.la.zTc&&(this.ia.pa(vb.a.ush,pb.a.application,Object(r.a)(this,this.tsh,"showHideIdeas"),4),this.ia.pa(vb.a.WNe,pb.a.application,Object(r.a)(this,this.tsh,"showHideIdeas"),4),dd.a("Designer.QueryNewPane")&&this.ia.pa(vb.a.FDe,pb.a.application,Object(r.a)(this,this.vFk,
"queryShowHideDesignerPane"),96),this.ia.pa(vb.a.xKc,pb.a.application,Object(r.a)(this,this.UNe,"showHideDesigner"),4),this.ia.pa(vb.a.DAa,pb.a.application,Object(r.a)(this,this.DAa,"applyDesignerSuggestion"),4),this.ia.pa(vb.a.Iob,pb.a.application,Object(r.a)(this,this.DAa,"applyDesignerSuggestion"),4),this.ia.ya(vb.a.xWa,pb.a.application,Object(r.a)(this,this.vWa,"navigateDesignerSuggestion")),this.ia.ya(vb.a.KCb,pb.a.application,Object(r.a)(this,this.vWa,"navigateDesignerSuggestion")),this.ia.ya(vb.a.LCb,
pb.a.application,Object(r.a)(this,this.vWa,"navigateDesignerSuggestion")),this.ia.ya(vb.a.wWa,pb.a.application,Object(r.a)(this,this.vWa,"navigateDesignerSuggestion")),this.ia.ya(vb.a.HCb,pb.a.application,Object(r.a)(this,this.vWa,"navigateDesignerSuggestion")),this.ia.ya(vb.a.ICb,pb.a.application,Object(r.a)(this,this.vWa,"navigateDesignerSuggestion")),this.ia.ya(vb.a.JCb,pb.a.application,Object(r.a)(this,this.vWa,"navigateDesignerSuggestion")),this.ia.ya(vb.a.Ddb,pb.a.application,Object(r.a)(this,
this.vWa,"navigateDesignerSuggestion")),this.ia.pa(vb.a.Xma,pb.a.application,Object(r.a)(this,this.Xma,"reportSuggestionSessionInfo"),64),this.ia.ya(vb.a.gYf,pb.a.application,Object(r.a)(this,this.Kql,"triggerOnUndoRedo")),this.ia.ya(vb.a.P8d,pb.a.application,Object(r.a)(this,this.Kjg,"handleImageUploadForDesigner")),this.ia.ya(vb.a.tSc,pb.a.application,Object(r.a)(this,this.Kjg,"handleImageUploadForDesigner")),this.ila.B3a(Object(r.a)(this,this.f0,"onSlidePresenceChanged")),this.Ig.UH(Object(r.a)(this,
this.rHi,"designerTargetSlideChangedHandler")),this.la.designerIncrementalRenderEnabled&&this.Lc.M6h(Object(r.a)(this,this.Fpk,"onRenderSuggestions")),this.la.lia&&this.Lc.d5h(Object(r.a)(this,this.gok,"onMoreIdesClicked")),this.la.ZXf&&this.Lc.z3a(Object(r.a)(this,this.e$,"onRibbonTabSwitched")),this.la.Ly&&this.Ig.job(Object(r.a)(this,this.pHi,"designerSlidesSelectionChangedHandler")),this.la.designerSendAppliedSuggestionHistoryEnabled&&this.P8.bUb(Object(r.a)(this,this.lea,"onBlockingStateChanged")),
this.Ig.KEf(Object(r.a)(this,this.g9c,"onForceOutboundGraphTransactionDisposed")),this.WBb.aUb(Object(r.a)(this,this.Wdb,"onMarkedUndo")),this.la.vTd&&this.Mc.LNa(Object(r.a)(this,this.deb,"onSessionEnding")),this.Mc.JB(Object(r.a)(this,this.to,"onSessionRehydrated")),this.a9b&&this.a9b.execute(t=>{t.$Ef(Object(r.a)(this,this.pxe,"onEditorCritiques"))}),this.LEg&&this.LEg.execute(t=>{t.t6h(Object(r.a)(this,this.Zmk,"onHighConfidenceAgendaDetected"))}),this.la.kHi?(this.dJg=window.setTimeout(Object(r.a)(this,
this.oUe,"tryTriggerNewDocDesignerRequest"),this.la.jHi),window.addEventListener("FREDecisionEvent",this.cJg,!0)):this.oUe(),!gb.a.Va(this.la.iBe)&&this.sHi(this.la.iBe)&&(this.Rmj(),this.Gql(this.la.iBe)))}Lnj(t){window.removeEventListener("FREDecisionEvent",this.cJg,!0);window.clearTimeout(this.dJg);(t=t.detail)&&t.show&&t.show||this.oUe()}xe(){const t=this.Fa.Dc(kd.a.o7);t.bindAction(ob.KeyInputManager.Na(ma.a.$0,0),vb.a.xWa);t.bindAction(ob.KeyInputManager.Na(ma.a.vB,0),vb.a.xWa);t.bindAction(ob.KeyInputManager.Na(ma.a.zE,
0),vb.a.KCb);t.bindAction(ob.KeyInputManager.Na(ma.a.Iq,4),vb.a.LCb);t.bindAction(ob.KeyInputManager.Na(ma.a.Y0,0),vb.a.wWa);t.bindAction(ob.KeyInputManager.Na(ma.a.uB,0),vb.a.wWa);t.bindAction(ob.KeyInputManager.Na(ma.a.Ew,0),vb.a.HCb);t.bindAction(ob.KeyInputManager.Na(ma.a.Iq,0),vb.a.ICb);t.bindAction(ob.KeyInputManager.Na(ma.a.mR,0),vb.a.JCb);t.bindAction(ob.KeyInputManager.Na(ma.a.MO,0),vb.a.Ddb)}UNe(t,N,ha,za,Ra){return this.bM(this.Xq,kd.a.o7,ha,t,Ra)}tsh(t,N,ha,za,Ra){return Ra||!this.Fo.isVisible?
this.bM(this.Xq,kd.a.Qub,ha,t,Ra):0}bM(t,N,ha,za,Ra){var qb=this.ua.presentation;qb=!!this.ua.Ba&&!!qb&&!this.Xb.Zc(qb);if(this.la.Ly){const Qb=this.nb.nf();qb=!!Qb&&1===Qb.length&&qb}if(!qb)return 16;if(!this.Ry.isEnabled())return 8;if(1===ha)return 32;Ra||this.Fa.Gj(N,t.Hp.isVisible);za===vb.a.xKc?this.Pb.correlationId&&!this.Pb.Wwb(this.Pb.correlationId)||this.mca(zc.RJb):t.Hp.isVisible?t.Hp.kp(!1,Eg.a.$Ib):(this.mca(za===vb.a.WNe?zc.RJb:zc.koc),t.Hp.kp(!0,Eg.a.none));return 32}vFk(t,N,ha,za,Ra){if(!Object(Fi.a)(ym.a,
Ra)||!this.Xq||!this.Xq.Hp)return 8;Ra.Nf(this.Xq.Hp.isVisible);return 32}DAa(t,N,ha,za,Ra){N=this.ua.presentation;if(!this.ua.Ba||!N||this.Xb.Zc(N))return 16;za=null;let qb=!0;Object(Fi.a)(An,Ra)?za=Ra:Object(Fi.a)(Ol,Ra)&&(za=Ra.wCc,qb=!1);if(!this.Ry.isEnabled()||!za)return 8;if(this.Ry.juk())return K.a.J(512496589,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",za.CorrelationId,t),8;if(1===ha)return 32;if(!this.nb.wu()){if(1===this.nb.Yd().length&&
this.nb.Yd()[0].Mx)return this.nb.Uh(),K.a.J(512496588,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",za.CorrelationId,t),8;this.nb.Uh()}if(!this.la.lia&&this.Pb.fZ.sid===za.SuggestionSid)return K.a.J(512496587,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",za.CorrelationId,za.SuggestionSid),2;ha=this.Fb.ke(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&
(this.Pb.RNa=new Date),ha.kc(N),ha.fd=t,N.DBa=za,this.Pb.fZ=O.a.tE(za.SuggestionSid,za.SuggestionCid),this.Pb.XS=!0,K.a.J(512496586,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",za.CorrelationId,t,za.SuggestionSid)}finally{ha&&ha.dispose()}this.la.designerBlockApplyUntilDraw?this.Xb.sqa(N,this.ua.Ba,this.Mb.Ma,t):this.Xb.Jw(N,t);this.Fo.isVisible&&this.Fa.Bf(kd.a.Qub);qb&&this.Pb.Qte();return 32}vWa(t,N,ha){N=this.ua.presentation;if(!this.ua.Ba||
!N||this.Xb.Zc(N))return 16;if(!this.Ry.isEnabled())return 8;if(1===ha)return 32;this.Ry.Krj(t);return 32}Xma(t,N,ha,za,Ra){if(this.Ry.Xq.Hp.isVisible)return 0;this.SGb(Ra.PUc,Ra.RVk);return 32}SGb(t,N){const ha=this.Pb.correlationId;if(gb.a.Va(ha))K.a.J(512496585,829,50,"DesignerActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",N);else if(this.Pb.Wwb(ha))K.a.J(512496584,829,50,"DesignerActor::SendTraceRequest - skipped for closed correlation. CorrelationId:{0}, ResetReason:{1}",
ha,N);else{var za={};za.CachedTrigger=this.Pb.SMd;za.SuggestionSlideId=this.Pb.fZ.sid.toString();za.SuggestionSlideCreationId=this.Pb.fZ.cid.toString();za.AppliedSuggestion=this.Pb.XS;za.DisplaySuggestionsTimeoutInMs=this.la.uTd;za.SuggestionsTimeout=this.Pb.VSa;za.ClientAbort=this.Pb.Lvb||this.Ry.guk();za.DesignerPaneClosed=t;za.ResetReason=N;za.HoverPreviewDesignerTriggered=this.Pb.fwg;za.DesignerFixPaneOpenHint=this.la.aYf;za.DesignerSendTraceRequestOnSessionEnded=this.la.vTd;this.la.ZXf&&(za.DesignerDesignTabTriggerEnabled=
!0);this.Xq.yra()&&(this.la.pPa?(za[ca.a.TEh]=this.Yq.j4d(),za[ca.a.UEh]=!0,this.Pb.OPe&&(za.StartUpsellFreeTrial=!0)):za[ca.a.ySf]=!0);t=!!N&&0<=N.indexOf(zc.moreIdeas);this.la.lia&&(za.TermCorrelationId=Sh.U3d(),t||(za.TermAction=this.Bhj()));var Ra=Ed.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),qb={};qb.ClientOS=Ra.Os;qb.Browser=Ra.Browser||"";qb.BrowserVersion=Ra.BrowserVersion||"";qb.BrowserMajorVersion=Ra.BrowserMajorVersion||"";qb.BrowserMinorVersion=Ra.BrowserMinorVersion||
"";this.Pb.Zmc&&this.Pb.qfa&&this.Pb.qfa>this.Pb.Zmc&&(qb.SuggestionsE2ETimeMs=+this.Pb.qfa-+this.Pb.Zmc);this.la.designerIncrementalRenderEnabled&&(this.Yq.pkd(),this.TPe(),za[ca.a.$ng]=!0,qb.VisibleSuggestionsCount=this.Pb.OVb,0<this.Pb.LRc.count&&(qb.IncrementalRenderTimeoutIndexes=this.Pb.LRc.toArray().join(",")),0<this.Pb.$da.count&&(qb.MissingDesignerCardIndexes=this.Pb.$da.toArray().join(",")),0<this.Pb.pOa.count&&(qb.CardIndexes=this.Pb.pOa.toArray().join(",")),0<this.Pb.Zqa.count&&(qb.DesignerCardIndexes=
this.Pb.Zqa.toArray().join(",")),this.Pb.EP&&(this.Pb.Cdc&&this.Pb.Cdc>this.Pb.EP&&(qb.MissingDesignerCardsReceivedTime=+this.Pb.Cdc-+this.Pb.EP),this.Pb.kUb&&this.Pb.kUb>this.Pb.EP&&(qb.AllIncRenderReceivedTime=+this.Pb.kUb-+this.Pb.EP),this.Pb.dLb&&this.Pb.dLb>this.Pb.EP&&(qb.VisibleIncRenderReceivedTime=+this.Pb.dLb-+this.Pb.EP)));this.i2h(qb);try{if(this.aw.instance){const Qb=this.aw.instance.TUk();gb.a.Va(Qb)||(za.AgendaMetrics=Qb)}}catch(Qb){K.a.J(512496583,813,10,"exception while populating AgendaMetrics",
Qb)}za.BrowserData=qb;this.Pb.EP&&this.Pb.qfa&&this.Pb.qfa>this.Pb.EP&&(za.TimeToDisplaySuggestionsInMs=+this.Pb.qfa-+this.Pb.EP);this.Pb.pSe&&this.Pb.Ync&&(za.TimeSuggestionsRendered=this.Pb.pSe.toUTCString());this.Pb.Ync&&(za.TimeDesignerPaneClosed=this.Pb.Ync.toUTCString());this.Pb.IUb&&0<this.Pb.IUb.count&&(za.AppliedSuggestionHis=this.Pb.IUb.toArray().join(" "));this.pi.Xma(ha,Kf.c(za),N===Eg.a.fhd);this.Owl(ha,N);this.Pb.ZCf(ha,this.la.lia&&t);K.a.J(512496582,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",
N,ha)}}i2h(t){t.IdeasMivShown=this.Pb.E6c;t.IdeasMivDrillIn=this.Pb.Ite;t.IdeasEditorShown=this.Pb.bJc;t.IdeasEditorKept=this.Pb.aJc;t.IdeasEditorDrillIn=this.Pb.a0f;t.AnyCardShown=this.Pb.bJc||this.Pb.E6c||0<this.Pb.pOa.count;t.AnyCardKept=this.Pb.aJc||this.Pb.XS}Owl(t,N){this.Ry.oHa(t,N===Eg.a.$Ib||N===Eg.a.Fkd||N===Eg.a.noSuggestion||N===Eg.a.kZf?Lj.a.nHa:Lj.a.pending)}Fpk(t,N){N.$vh.addRange(this.Pb.Zqa);this.HOf(N.$vh,N.g3f,N.slideId,N.trigger,N.correlationId);N.k6a&&(this.ATa||this.Pb.$da.count||
this.Dil(N.trigger,N.g3f))}gok(t,N){this.mca(zc.moreIdeas,null,N.PWc)}e$(t,N){!N.V9||"PptRibbon.Design"!==N.V9&&"Design"!==N.V9||2!==N.jv&&3!==N.jv&&4!==N.jv||this.Ry.Xq.Hp.isVisible||32!==this.ia.processAction(vb.a.ZNe,1)||this.mca(zc.rTd)}Dil(t,N){this.TPe();const ha=this.ua.Ba.Bb,za=this.Pb.correlationId;this.ATa=new aa.a(2,1,this.la.retryMissingDesignerCardsCountdownInMs,()=>{this.Pb.Wwb(za)||this.HOf(this.Pb.Zqa,N,ha,t,za,N)},void 0,"CheckAndFetchMissingDesignerCardsTask");this.yb.Cb(this.ATa)}HOf(t,
N,ha,za,Ra,qb=-1){if(this.Pb.Zqa.count===N)this.TPe();else if(t&&t.count&&!(0<this.Pb.$da.count)){if(-1===qb)for(let Qb of t)Qb>qb&&(qb=Qb);this.hni(t,N,qb)&&this.Jrl(ha,za,Ra)}}hni(t,N,ha){for(let za=0;za<N&&(t.contains(za)||this.Pb.$da.contains(za)||this.Pb.$da.add(za),za!==ha||this.Pb.$da.count);za++);return 0<this.Pb.$da.count}Jrl(t,N,ha){const za={};za.MissingDesignerCardIndexes=this.Pb.$da.toArray().join(",");this.ATa=new aa.a(0,1,0,()=>{this.pi.Fia(t.cid,t.sid,ha,Sh.U3d(),N,null,Kf.c(za),()=>
{K.a.J(512496581,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",za.MissingDesignerCardIndexes,ha)},Ra=>{K.a.J(512496580,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",za.MissingDesignerCardIndexes,Ra.HttpStatusCode);return!0})},void 0,"FetchMissingDesignerCardsTask");this.yb.Cb(this.ATa)}TPe(){this.ATa&&
(this.yb.Ng(this.ATa),this.ATa=null)}f0(t,N){(t=this.ua.Ba)&&N.slideId.equals(t.Bb)&&(this.Ry.Vjd(N.Pth,N.C8g),this.Ry.Xq.Hp.isVisible&&!this.Ry.isEnabled()&&(K.a.J(512496579,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",N.Pth,N.C8g,this.Pb.correlationId),this.Fo.kp(!1,Eg.a.Hqi)),this.Fo.isVisible&&(this.Ry.isEnabled()||this.Ry.oHa(this.Pb.correlationId,
Lj.a.nHa)))}rHi(t,N){N.Wla?(t=Object.assign(new jo.a,{slideId:N.Wla.Bb}),this.ia.La(vb.a.uXa,2,t),this.Ry.Vjd(t.vmc,t.B8g),this.Fo.isVisible&&(K.a.J(512496577,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",this.Pb.correlationId),this.Ry.isEnabled()&&!N.Wla.qN?this.mca(zc.cPe):N.Wla.qN&&this.la.designerNewSlideEnabled||(this.Fo.kp(!1,Eg.a.slideNavigation),this.Ry.oHa(this.Pb.correlationId,Lj.a.nHa)))):K.a.J(512496578,829,50,
"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",this.Pb.correlationId)}L2b(t){this.la.designerRequestThrottlingEnabled&&(this.rla=xl.ready,this.zL&&(this.Fo.isVisible?(K.a.J(512496576,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",this.zL.trigger,this.zL.sid),t()):this.zL=null))}feb(t,N){this.L2b(N);K.a.J(512496547,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",
t.HttpStatusCode);return!0}pHi(){if(this.Ry.Xq.Hp.isVisible){const t=this.nb.nf();t&&1<t.length&&(K.a.J(512496546,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),this.Fo.isVisible&&this.Fo.kp(!1,Eg.a.ogk))}}lea(t,N){t=this.Pb.RNa;const ha=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";t&&Object(Q.a)(String,N.actionName)===ha&&(this.Pb.IUb.add(String.format("{0}:{1}:{2}",this.Pb.fZ,
+t-+this.Pb.qfa,+new Date-+t)),this.Pb.RNa=null)}deb(t,N){this.Ry.Xq.Hp.isVisible&&(K.a.J(512496545,829,50,"DesignerActor::OnSessionEnding. Correlation={0}, Reason={1}",this.Pb.correlationId,Eo.a[N.vJ]),1!==N.vJ&&3!==N.vJ||this.SGb(!0,Eg.a.fhd))}to(){K.a.J(512496544,829,50,"DesignerActor::OnSessionRehydrated");const t={};t[ca.a.rKc]=!0;this.mca(zc.refresh,t)}g9c(t,N){N&&this.$4d(N.actionId,N.transaction.Dy)}Wdb(t,N){if(N.hwb&&this.Ry.oAg(N.actionId)){t={};if(N.revisionId){const ha=Aa.a.ksa(wl.a.UX,
Aa.a.t7a(N.revisionId.toString()).toString());ha&&1===ha.length&&(t[ca.a.iD]=ha[0].iD)}this.$4d(N.actionId,t)}}Kjg(t,N,ha,za,Ra){switch(t){case vb.a.P8d:return this.Pb.pdk(Ra),32;case vb.a.tSc:return this.Pb.IQk(Ra),32;default:return 2}}Nck(t,N,ha){if(t!==zc.insertPicture&&t!==zc.hwa&&t!==zc.fSc)return null;const za=ha?ha[ca.a.W2b]:!1,Ra=ha?ha[ca.a.KQc]:!1,qb=ha?ha[ca.a.X2b]:!1,Qb=ha?ha[ca.a.JQc]:!1;let vc=null;switch(N){case vb.a.LHa:case vb.a.zad:vc=za?ca.a.Bwk:Ra?ca.a.Awk:qb?ca.a.Cwk:Qb?ca.a.zwk:
null;break;case vb.a.Bad:vc=za?ca.a.Fwk:Ra?ca.a.Ewk:qb?ca.a.Gwk:Qb?ca.a.Dwk:null;break;case vb.a.MKc:vc=ca.a.z7f;break;case vb.a.insertOnlinePicture:case vb.a.ADa:vc=ca.a.online;break;case vb.a.jpg:vc=ca.a.icon}vc||K.a.J(512496543,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",t,N,this.Pb.correlationId);delete ha[ca.a.W2b];delete ha[ca.a.KQc];delete ha[ca.a.X2b];delete ha[ca.a.JQc];return vc}Ock(t,N){switch(t){case vb.a.MKc:case vb.a.insertOnlinePicture:case vb.a.ADa:case vb.a.bgc:case vb.a.jpg:return zc.insertPicture;
case vb.a.Bad:case vb.a.LHa:case vb.a.zad:case vb.a.sbd:return N&&N[ca.a.W2b]||N&&N[ca.a.KQc]&&this.la.wql?zc.insertPicture:N&&N[ca.a.X2b]?zc.hwa:N&&N[ca.a.JQc]&&this.la.Bzh?zc.fSc:this.la.cya?zc.MHa:"";case vb.a.l4a:case vb.a.vOa:case vb.a.Mob:return zc.Mob;case vb.a.wqa:return zc.YOe;case vb.a.mlc:case vb.a.nlc:case vb.a.DLe:case vb.a.ELe:case vb.a.eid:return N&&ca.a.wub in N&&N[ca.a.wub]?zc.SNd:zc.refresh;case vb.a.VPf:case vb.a.v4a:return N&&ca.a.wub in N&&N[ca.a.wub]?zc.VXf:zc.refresh;case vb.a.hHa:case vb.a.Qfb:case vb.a.Mkc:case kg.a.ZRa:case vb.a.bringForward:case vb.a.bringToFront:case vb.a.sendToBack:case vb.a.sendBackward:return zc.Wfb;
case kg.a.fLd:case kg.a.iLd:case kg.a.WUb:case kg.a.hLd:case kg.a.jLd:case kg.a.kLd:case kg.a.YNa:case kg.a.lLd:case kg.a.mLd:case kg.a.nLd:case kg.a.oLd:case kg.a.qLd:case kg.a.sLd:case kg.a.backspace:case kg.a.KAa:case kg.a.wK:case kg.a.lPa:case kg.a.enter:case kg.a.cB:case kg.a.typing:return zc.typing;case vb.a.hwa:return zc.hwa;case vb.a.wbd:return zc.insertTable;case vb.a.dea:case vb.a.P7c:case vb.a.RCb:case vb.a.qS:return zc.kHa;case vb.a.QNa:return zc.gKd;case vb.a.AOf:return zc.JNd;case vb.a.Ypb:return zc.Ypb;
default:return zc.refresh}}Kql(){const t={};t[ca.a.undoRedo]=!0;this.mca(zc.refresh,t);return 32}$4d(t,N){if(!this.JDj(t)){var ha=qb=>{const Qb={};Qb[ca.a.timestamp]=qb.timestamp;Qb[ca.a.correlationId]=qb.correlationId;Qb[ca.a.trigger]=qb.trigger;Qb[ca.a.sid]=qb.sid;Qb[ca.a.cid]=qb.cid;Qb[ca.a.cQ]=qb.cQ;qb=this.Fb.ud(4);try{qb.kc(this.ua.presentation),qb.fd=vb.a.bYf,this.ua.presentation.krb=Kf.c(Qb)}finally{qb&&qb.dispose()}},za=this.Ock(t,N),Ra=this.Nck(za,t,N);gb.a.Va(Ra)||(N||(N={}),N[ca.a.PBa]=
Ra);this.Ry.oAg(t)&&this.Fo.isVisible?(this.Ycb&&this.yb.Ng(this.Ycb),this.Ry.oHa(this.Pb.correlationId,Lj.a.pending),this.Mhd(zc.typing),this.Ycb=new aa.a(2,1,this.la.designerTypeRefreshThrottleTimeoutMs,()=>{this.Fo.isVisible&&K.a.J(512496542,829,50,"Potential candidate for typing refresh request for designer pane");this.ccl(this.ua.Ba)||this.XJc(ha,za,N)},void 0,"DesignerTypingRefreshTask"),this.yb.Cb(this.Ycb)):this.XJc(ha,za,N)}}mca(t,N=null,ha=null){this.XJc(za=>{if(this.la.designerRequestThrottlingEnabled){if(this.rla.Gyg&&
+new Date-+this.rla.GBg<this.la.designerRequestThrottleIntervalMs){this.zL=new Do;this.zL.sid=za.sid;this.zL.cid=za.cid;this.zL.trigger=za.trigger;this.zL.mRc=za.cQ;K.a.J(512496541,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",t,za.sid);return}this.rla=xl.inProgress;this.zL=null}const Ra=()=>{this.mca(this.zL.trigger,this.zL.mRc,ha)};this.pi.Fia(za.cid,za.sid,za.correlationId,Sh.U3d(),za.trigger,ha,Kf.c(za.cQ),qb=>{qb&&qb.Status===ca.a.yhh?
this.Gfd(()=>{this.mca(za.trigger,za.cQ,ha)}):this.aHa=0;this.aHa||this.L2b(Ra)},qb=>this.feb(qb,Ra))},t,N)}Gfd(t){this.aHa<this.la.designerMaxRetryOnWait?this.yb.Cb(new aa.a(2,1,1E3,()=>{K.a.J(512496540,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.Pb.correlationId);this.rla=xl.ready;this.aHa++;t()},void 0,"RetryRequestOnWait")):K.a.J(512496539,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.Pb.correlationId)}G6i(t,
N=null){N=N||{};this.la.YHc&&t===zc.newDocument&&(N[ca.a.yMi]="true");this.la.qHi&&(N[ca.a.ykl]=this.cMg);this.Xq.yra()&&(this.la.pPa?(N[ca.a.TEh]=this.Yq.j4d(),N[ca.a.UEh]=!0):N[ca.a.ySf]=!0);this.Yq.MRc(t)&&(N[ca.a.$ng]=!0);this.Ry.dGj()&&(N[ca.a.XOd]=this.Ry.XOd());N.NewPaneEnabled=!0;var ha=!Ff.a.Va(this.Pb.RV);(N.RequestForEditorCardsForNewIdeasPane=ha)&&(N.NumEditorCritiques=this.Axi());ha={};ha.SupportsImageToTableSuggestedAction=32===this.ia.processAction(vb.a.dBe,1);N.PPTOEnabledSuggestedActions=
Kf.c(ha);this.la.cya&&t===zc.MHa&&(N[ca.a.ueb]=this.la.ueb,N[ca.a.Zze]=this.la.Zze,N[ca.a.Yze]=this.la.Yze);return N}Axi(){let t=0;for(const N of this.Pb.RV)for(const ha of N.critiques)t+=ha.suggestions.length;return t}JDj(t){if(void 0===t||null===t)return!0;switch(t){case vb.a.DAa:case vb.a.Iob:case vb.a.wWa:case vb.a.HCb:case vb.a.ICb:case vb.a.xWa:case vb.a.KCb:case vb.a.LCb:case vb.a.JCb:case vb.a.Ddb:case vb.a.bYf:return!0;case vb.a.hHa:case vb.a.Qfb:case vb.a.Mkc:case kg.a.ZRa:case vb.a.bringForward:case vb.a.bringToFront:case vb.a.sendToBack:case vb.a.sendBackward:return!this.Pb.XS;
default:return!1}}hCi(t,N=null){const ha=this.ua.Ba;return ha?Object.assign(new Bn,{trigger:t,sid:ha.sid,cid:ha.cid,cQ:this.G6i(t,N)}):null}oOj(t){return this.pOj(t)}pOj(t){if(!t||!t.sid||!this.fvg(t.trigger)&&!this.Fo.isVisible)return!1;switch(t.trigger){case zc.kHa:case zc.koc:case zc.RJb:case zc.insertPicture:case zc.Mob:case zc.rTd:case zc.qQd:case zc.hwa:case zc.cPe:case zc.YOe:case zc.insertTable:return!0;case zc.fSc:return this.la.Bzh;case zc.typing:return this.la.fYf&&this.Fo.isVisible;case zc.Wfb:return this.la.designerRetriggerEnabled&&
this.Pb.XS;case zc.SNd:case zc.VXf:return this.la.designerDesignElementsRemovedEnabled;case zc.MHa:return this.la.cya;case zc.gKd:case zc.JNd:case zc.Ypb:return this.la.triggerDesignerAfterApplyReplaceObject;case zc.refresh:return this.hOj(t.cQ);case zc.moreIdeas:return this.la.lia;case zc.newDocument:return this.la.YHc&&this.la.NS;case zc.tJd:return this.la.jTe;default:return K.a.J(512496538,829,15,"invalid trigger: {0}",t.trigger),!1}}hOj(t){return ca.a.rKc in t&&t[ca.a.rKc]||ca.a.undoRedo in t&&
t[ca.a.undoRedo]||this.la.nHi&&this.Ry.Xq.Hp.isVisible?!0:!1}fvg(t){switch(t){case zc.koc:case zc.RJb:case zc.insertPicture:case zc.fSc:case zc.YOe:case zc.SNd:case zc.Mob:case zc.hwa:case zc.newDocument:case zc.gKd:case zc.rTd:case zc.qQd:return!0;case zc.tJd:return this.la.jTe;case zc.MHa:return this.la.cya;default:return!1}}IDj(t){if(!(this.la.designerSendActionDuration&&ca.a.iD in t.cQ&&t.cQ[ca.a.iD]))return!1;switch(t.trigger){case zc.koc:case zc.RJb:case zc.cPe:case zc.newDocument:return!1;
case zc.refresh:return!(ca.a.rKc in t.cQ)||!(ca.a.undoRedo in t.cQ);default:return!0}}Mhd(t){const N=t===zc.typing?4:t===zc.moreIdeas?7:1;(this.Ry.Xq.Hp.isVisible||this.fvg(t))&&this.Xq.MYa(N)}iWd(t,N,ha=null){this.Ycb&&(this.yb.Ng(this.Ycb),this.Ycb=null);const za=this.hCi(N,ha);this.oOj(za)?this.Pb.$Pj(this.ua.Ba.sid)?(this.Mhd(za.trigger),this.Gfd(()=>{this.XJc(t,N,ha)})):(K.a.J(512496537,829,50,"trigger: {0}; sid: {1}; correlationId: {2}",za.trigger,za.sid,za.correlationId),this.Pb.correlationId&&
!this.Pb.Wwb(this.Pb.correlationId)&&this.SGb(this.Ry.Xq.Hp.isVisible,za.trigger),this.Pb.Zmc=new Date,this.Pb.correlationId=za.correlationId,this.Pb.SMd=za.trigger,this.Pb.EP=this.IDj(za)?za.cQ[ca.a.iD]:new Date,t(za),this.Mhd(za.trigger),this.Ry.oHa(za.correlationId,Lj.a.pending)):(K.a.J(512496536,829,50,"Designer call not currently allowed for trigger {0}",N),this.Fo.kp(!1,Eg.a.kZf))}XJc(t,N,ha=null){if(this.la.designerAuthEnabled&&this.wL){this.Mhd(N);ha||(ha={});var za=new Date;this.wL.KU(this.la.pptDesignerImplicitAuthAppName,
this.la.designerResourceUri).then(Ra=>{const qb=+new Date-+za;Ra.IsSuccess?(ha[ca.a.qSi]=qb,ha[ca.a.V1k]=Ra.Token):(ha[ca.a.A4f]=qb,K.a.J(512496535,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+Ra.ErrorCode+": "+Ra.ErrorMessage));this.iWd(t,N,ha)}).catch(Ra=>{K.a.J(512496534,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",Ra);ha[ca.a.A4f]=+new Date-+za;this.iWd(t,N,ha)})}else this.iWd(t,N,ha)}oUe(){if(this.la.YHc&&
this.la.NS)if(this.uc){var t=this.ua.presentation;if(!t)throw Error.argumentNull("Presentation is null");var N=this.uc.hI();if(!N||0>=N.length)K.a.J(512496531,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid");else{var ha="62f939b6-93af-4db8-9c6b-d6c7dfdc589f"===N[0].ThemeFamilyId.toLowerCase();ha&&1!==N.length?K.a.J(512496530,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters Length is invalid"):this.la.iTe||ha?!t.slides||0>=
t.slides.length?K.a.J(512496528,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):ha&&1!==t.slides.length?K.a.J(512496527,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes Length for blank theme invalid"):(t=null,this.la.w1k&&this.la.xld&&0<this.la.xld.length&&(t={},t.TemplateId=this.la.xld),K.a.J(512496526,829,50,"Triggering NewDocument designer request"),this.mca(zc.newDocument,t)):K.a.J(512496529,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid")}}else K.a.J(512496532,
829,15,"Triggering NewDocument designer request failed, PresentationReader invalid");else K.a.J(512496533,829,50,"Not Triggering NewDocument designer request, DesignerNewDocTriggerEnabled:{0}, IsCreateNew:{1}",this.la.YHc,this.la.NS)}pxe(t,N){this.Pb.pwl(N.uZb)}ccl(t){return!t||!this.Fo.isVisible}Bhj(){const t=document.querySelector("."+Wd.lOa);return t&&(this.Yq.Qsb(t,!1)||this.Yq.Qsb(t,!0))?"Kept":"NotKept"}ccg(t){const N=new C.a;if(t&&t.children)for(let ha=0;ha<t.children.length;ha++){const za=
t.children[ha].innerText;za&&0<za.length&&N.add(t.children[ha].innerText)}return N.toArray()}Yaj(t){if(!t)return null;var N=t.sa(Gh.a.veb,null);if(N)return N.replace("\r","\n").replace("\n\n","\n").split("\n");if(N=t.sa(Gh.a.bU,null))if(N=this.hT.$Wa(N))return this.ccg(N);if(N=t.sa(Gh.a.$ze,null))if(t=this.hT.$Wa(N))return this.ccg(t);return null}a$(){}Z9(t){if(this.la.cya&&t.actionId===vb.a.sbd&&32===t.response){var N=this.nb.Yd();if(N&&1===N.length&&N[0].id&&(N=this.Yaj(Object(Q.a)(10,t.kd)))&&
!(0>=N.length)){var ha={};ha[ca.a.Hwk]=N;this.$4d(t.actionId,ha)}}}sHi(t){switch(t){case ca.a.EGh:return this.la.wMi;default:return!1}}Rmj(){this.Fo.kp(!0,Eg.a.none);this.mca(zc.qQd);this.Xq.MYa(3)}Gql(t){switch(t){case ca.a.EGh:this.Hql()}}Hql(){if(this.la.Ezk)try{const t=u.a.instance.Ka("Common.ISystemInitiatedFeedback");t&&(K.a.J(512496525,829,50,"Floodgate survey for word to presentation triggered"),t.execute(N=>{N.logActivity("ConvertWordToPresentationActivity","PowerPointDesignerWordToPptSurveyEnabled")}))}catch(t){K.a.J(512496524,
829,10,"Exception thrown while triggering floodgate survey. Exception: {0}",t)}}Zmk(){this.la.jTe&&(this.Fo.isVisible||this.UGg||(this.Fo.kp(!0,Eg.a.none),this.mca(zc.tJd),this.Xq.MYa(3),K.a.J(512496523,829,50,"Auto opening designer pane for high confidence agenda")),this.UGg=!0)}static U3d(){const t=document.querySelector("."+Wd.lOa);return t&&t.getAttribute(Wd.wpb)?t.getAttribute(Wd.wpb).toString():null}}Object(h.a)(Sh,"DesignerActor",null,[147]);var dk=d(534),Sk=d(684);class $l{constructor(t){this.bucketId=
t;this.critiques=[]}}Object(h.a)($l,"BucketedEditorData",null,[]);class en{constructor(t){this.SMd=this.correlationId=this.VTa=this.DFg=null;this.Lvb=this.VSa=this.XS=!1;this.Ync=this.pSe=null;this.fwg=!1;this.qOa=this.suggestions=this.dLb=this.kUb=this.EP=this.RNa=this.Cdc=this.qfa=this.Zmc=null;this.VM=0;this.OPe=this.Ite=this.E6c=this.a0f=this.aJc=this.bJc=!1;this.Rge=[];this.Vre=[];this.M8b=t;this.fZ=O.a.empty;this.IUb=new C.a;this.pOa=new C.a;this.Zqa=new C.a;this.LRc=new C.a;this.$da=new C.a;
this.OVb=1}fdk(){this.rYa(0,0)}edk(){this.rYa(1,0)}Qte(){this.rYa(2,4)}rYa(t,N){this.M8b&&this.M8b.execute(ha=>{const za=Object.assign(new Sk.a,{cardId:dk.a.Nth,actionType:t,actionEngagement:N});ha.f8c(za)})}ZCf(t,N){this.Wwb(t)||(Array.add(this.Rge,t),K.a.J(22853508,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",t,this.Rge.length));this.wHe(!N)}Wwb(t){return Array.contains(this.Rge,t)}pdk(t){Array.add(this.Vre,t)}IQk(t){Array.remove(this.Vre,
t)}$Pj(t){return Array.contains(this.Vre,t)}get LPd(){return this.VTa}Qui(){if(this.VTa)return!0;try{const t=u.a.instance.qb("PowerPointWebEditor.Proofing.IConsistencyCheckActor");if(t)return this.VTa=t,!0}catch(t){K.a.J(42001674,829,15,"error resolving consistencyCheckActor. ex: {0}",t)}return!1}pwl(t){if(t){var N=[],ha=new ud.a;for(const za of t.critiques){t=za.bucketId;let Ra=ha.ga(t);Ra||(Ra=new $l(t),ha.$(t,Ra),N.push(Ra));Ra.critiques.push(za)}this.DFg=N}}get RV(){return this.DFg}wHe(t){this.correlationId=
"";this.fZ=O.a.empty;this.SMd="";this.Lvb=this.VSa=this.XS=!1;this.Ync=null;this.fwg=!1;this.RNa=this.Cdc=this.qfa=this.Zmc=null;this.IUb.clear();this.dLb=this.kUb=this.EP=null;this.OVb=1;this.pOa.clear();this.Zqa.clear();this.LRc.clear();this.$da.clear();this.VM=0;this.OPe=this.bJc=this.aJc=this.E6c=this.Ite=!1;t&&(this.suggestions=this.qOa=null)}}Object(h.a)(en,"DesignerContext",null,[687]);class Cn{constructor(){this.CardData=null;this.DocumentUpsellStatus=0;this.HasPaginationInfo=!1;this.SlideSuggestions=
null}}Object(h.a)(Cn,"DesignerSuggestions",null,[]);var zm;(function(t){t[t.init=0]="init";t[t.loading=1]="loading";t[t.noSuggestion=2]="noSuggestion";t[t.showSuggestion=3]="showSuggestion";t[t.refreshing=4]="refreshing";t[t.sameSlideCoauthNoSuggestion=5]="sameSlideCoauthNoSuggestion";t[t.makeItVisualDrillIn=6]="makeItVisualDrillIn";t[t.loadingMoreIdeas=7]="loadingMoreIdeas";t[t.moreIdeas=8]="moreIdeas";t[t.noSuggestionRibbon=9]="noSuggestionRibbon"})(zm||(zm={}));Object(h.b)("DesignerViewState",
zm);class Am{constructor(){this.suggestions=[]}}Object(h.a)(Am,"SlideSuggestionNotificationData",null,[]);var fp=d(256),uk=d(380);class am{constructor(t,N,ha){this.zlb=this.Lp=!1;t&&(this.KTa=t,this.KTa.isFeatureEnabled("PowerPointDesigner",!1).then(za=>{(this.Lp=za)?K.a.J(591942685,829,50,"DesignerStateManager:: Designer is enabled"):(this.zlb=this.KTa.isFreemiumUpsellEnabled(),this.isFreemiumUpsellEnabled?ha?K.a.J(591942691,829,50,"DesignerStateManager:: Usage based Upsell experience is enabled for deisgner"):
K.a.J(591942689,829,50,"DesignerStateManager:: Content based Upsell experience is enabled for deisgner"):K.a.J(591942687,829,50,"DesignerStateManager:: Upsell experience is disbaled"));return null}),this.v9j=this.KTa.sfb("PowerPointDesigner",Object(r.a)(this,this.ksb,"featureStateChangeCallback")),this.W7j=N)}yra(){return!this.isEnabled&&this.isFreemiumUpsellEnabled}dispose(){this.KTa&&(this.KTa.HFb("PowerPointDesigner",this.v9j),this.KTa=null)}get isEnabled(){return this.Lp}get isFreemiumUpsellEnabled(){return this.zlb}launchUpsellExperience(t){this.KTa&&
this.KTa.launchUpsellExperience(t)}ksb(t){t&&"PowerPointDesigner"===t.featureName&&(!this.isEnabled&&t.isEnabled&&this.W7j(),this.Lp=t.isEnabled)}}Object(h.a)(am,"DesignerStateManager",null,[]);class Fo{constructor(t,N,ha){this.kak=t;this.YA=N;this.O$j=ha}toString(){return"SuggestionIndex:"+this.kak+" SlideId:"+this.YA+" CreationId:"+this.O$j}}Object(h.a)(Fo,"LoggableSourceContext",null,[]);var Dp=d(1116),lo=d(937),Dn=d(533);class Km{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of){this.f$b=!1;
this.pte=0;this.mo=this.xyb=null;this.va=new Qk.a;this.NE=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.jb&&v.AFrameworkApplication.Aa.jb.tW;this.MQh=!!v.AFrameworkApplication.Aa&&!!v.AFrameworkApplication.Aa.jb&&v.AFrameworkApplication.Aa.jb.tW&&v.AFrameworkApplication.fa.ka("PptReactTabbedTaskPanesFocusV2IsEnabled");this.Ob=t;this.fe=N;this.Wc=ha;this.Ar=za;this.ia=Ra;this.Pb=qb;this.RD=Qb;this.Mc=vc;this.Wy=Zc;this.jc=Wc;this.Fa=Md;this.la=Id;this.qv=Xe;this.zF=Of.E3b;this.f8j=ResourceStrings.L_Designer;
this.fH=of;this.pb=document.createElement("div");this.pb.className=fb.a.lHi;this.pb.id=Of.E3b;this.pb.style.position=Pc.a.Dna;this.pb.setAttribute(oa.a.Ye,oa.a.GAa);this.pb.setAttribute(oa.a.W1,fb.a.tTd);this.Db=!1;this.bUa=kb.a.Ce();this.bUa.className="DesignerPaneLayoutRoot";this.pb.appendChild(this.bUa);t=v.AFrameworkApplication.fa.Ga("PPTFabricIconDiamondCssUrl");N=document.createElement("link");N.setAttribute("rel","stylesheet");N.setAttribute("type","text/css");N.setAttribute("href",t);this.pb.appendChild(N);
this.Ob.y3a(Object(r.a)(this,this.zX,"onSetOffline"))}dispose(){this.f2();this.pb.removeChild(this.bUa);this.Ob.SFb(Object(r.a)(this,this.zX,"onSetOffline"));K.a.J(22590850,829,50,"DesignerPane::Dispose")}initialize(){this.mo=Km.mBa(this.fe);Sys.UI.DomElement.addCssClass(this.mo,"DesignerPaneCloseButton");this.mo.setAttribute(oa.a.Ye,oa.a.hu);this.bUa.appendChild(this.mo);this.Wc.ob(la.a.click,this.mo,Object(r.a)(this,this.$Aa,"closePaneButtonClickHandler"));this.Ar.addHandler(this.mo,la.a.Xf,Object(r.a)(this,
this.Fsa,"inputKeyPressHandler"));this.xyb=kb.a.Ce();this.xyb.id=fb.a.tTd;this.xyb.className=fb.a.tTd;this.xyb.innerText=this.f8j;this.bUa.appendChild(this.xyb);this.RD.T7(this.bbg(),kd.a.jj,this.pb,t=>{this.MQh&&t===this.Fa.Dc(kd.a.IO)&&this.mo?this.jA(!0):this.XT(!0)},()=>{this.XT(!1)});this.Mc.cba(Object(r.a)(this,this.jz,"onUnifiedAppStateChanged"));this.Mc.JB(Object(r.a)(this,this.d$,"onPodSessionRehydrated"));this.Wy.hob(Object(r.a)(this,this.d$,"onPodSessionRehydrated"));K.a.J(22590852,829,
50,"DesignerPane::Initialize")}bbg(){return kd.a.o7}f2(){this.Wc&&0<this.bUa.childNodes.length&&(this.Wc.xb(la.a.click,this.mo,Object(r.a)(this,this.$Aa,"closePaneButtonClickHandler")),this.Ar.removeHandler(this.mo,la.a.Xf,Object(r.a)(this,this.Fsa,"inputKeyPressHandler")),this.bUa.removeChild(this.xyb),this.bUa.removeChild(this.mo));this.Mc.UFb(Object(r.a)(this,this.jz,"onUnifiedAppStateChanged"));this.Mc.Pea(Object(r.a)(this,this.d$,"onPodSessionRehydrated"));this.Wy.Ffb(Object(r.a)(this,this.d$,
"onPodSessionRehydrated"));this.Fa.ze&&this.Fa.ze.name===kd.a.o7&&this.Fa.Gj(kd.a.o7,!1)}jz(t,N){N.R8a&&!this.jc.un&&this.isVisible&&(K.a.J(24760967,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",this.Pb.correlationId),this.kp(!1,Eg.a.$Ib))}zX(t){t&&this.isVisible&&this.kp(!1,Eg.a.$Ib)}d$(){K.a.J(37861251,801,50,"Designer Pane is closed because session is rehydrated.");this.kp(!1,Eg.a.e2k)}layout(t,N){const ha=N?t.PC(this.width):
t.QC(this.width);this.isVisible&&(N?(Sys.UI.DomElement.addCssClass(this.pb,fb.a.eYf),ha.PC(fb.a.sTd)):(Sys.UI.DomElement.addCssClass(this.pb,fb.a.dYf),ha.QC(fb.a.sTd)));kb.a.A0(this.pb,ha);return t}kp(t,N){if(this.Db!==t){this.Db=t;var ha=this.la.aYf||this.id!==Of.E3b?ca.a.iuk:Of.Xvj;t?(N={},N[ha]=!0,this.qv.Skd(Kf.c(N)),this.initialize(),this.pb.style.display=Pc.a.Dxa,this.Pb.fdk(),K.a.J(22590854,829,50,"DesignerPane::SetIsVisible - Set to visible")):(t={},t[ha]=!1,this.qv.Skd(Kf.c(t)),this.f2(),
this.pb.style.display=Pc.a.Cf,this.Yfl(N)||(this.Pb.Ync=new Date,1===this.pte&&(this.Pb.Lvb=!0),this.ia.La(vb.a.Xma,2,new Dn.a(!0,N))),this.Pb.edk(),K.a.J(22590856,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.NE?(this.OAc(this.pb),ha=ResourceStrings.L_Designer,this.fH.bM(this,this.Db,this.id===Of.E3b?ha:ResourceStrings.L_ShowHideDesignerPane,this.bbg())):this.Ob.Fq()}}OAc(t){v.AFrameworkApplication.isRtl?Sys.UI.DomElement.addCssClass(t,fb.a.eYf):Sys.UI.DomElement.addCssClass(t,
fb.a.dYf)}Yfl(t){return t===Eg.a.CQf||this.isVisible&&t===Eg.a.$Ib}XT(t){t?this.va.raiseEvent("OnDesignerPaneFocusOn"):this.va.raiseEvent("OnDesignerPaneFocusBlur")}bFf(t){this.va.addHandler("OnDesignerPaneFocusOn",t)}mfh(t){this.va.removeHandler("OnDesignerPaneFocusOn",t)}cFf(t){this.va.addHandler("OnDesignerPaneFocusBlur",t)}nfh(t){this.va.removeHandler("OnDesignerPaneFocusBlur",t)}Fsa(t){!this.isVisible||t.keyCode!==ma.a.lq&&t.keyCode!==ma.a.NO||this.kp(!1,Eg.a.typing)}$Aa(){this.isVisible&&(K.a.J(22853525,
829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Pb.correlationId),this.kp(!1,Eg.a.$Ib));return!0}jA(t){(this.f$b=t)&&this.mo.focus()}get X$(){return this.pte}set X$(t){this.pte=t}Ngb(t){this.setFocus("#"+this.id+" ."+Sc.vVg+":nth-child("+t+") > ."+Sc.sCb)}O3k(){this.setFocus("#"+Sc.F5a)}N3k(){this.setFocus("#"+Sc.Frb)}uhd(t){this.setFocus("."+Sc.EPa+"["+Of.DPa+'="'+t+'"')}L3k(){this.setFocus("."+Sc.rZb)}M3k(){this.setFocus("."+Sc.vZb)}setFocus(t){(t=
document.querySelector(t))&&gc.FocusManager.Mr(t)}get isVisible(){return this.Db}get nSa(){return this.f$b}get xa(){return this.pb}get order(){return 7}get id(){return this.zF}get width(){let t=0;this.isVisible&&(t=fb.a.mHi,t+=fb.a.sTd+Fb.a.LIa);return t}static mBa(t){return Km.lBa(t,"per","cui-img-16by16","cui-ctl-iconContainer","ClosePaneGlyph_16x16x32",CommonUIStrings.l_DialogClose,null)}static lBa(t,N,ha,za,Ra,qb,Qb){const vc=kb.a.SB();vc.alt=qb;vc.className=Ga.getImageClassWithCluster(N,Ra);
vc.src=t.hk(N+".png");vc.setAttribute("Unselectable","on");t=kb.a.Fn();t.className=ha+" cui-img-cont-float";t.appendChild(vc);ha=kb.a.Fn();ha.className=za;ha.setAttribute("Unselectable","on");ha.appendChild(t);za=kb.a.vba();za.className="cui-ctl DesignerPaneButton";za.title=qb;za.setAttribute(oa.a.Ye,oa.a.hu);za.tabIndex=0;za.appendChild(ha);Qb&&(qb=kb.a.Fn(),qb.className="cui-ctl-mediumlabel",qb.setAttribute("Unselectable","on"),qb.innerText=Qb,za.appendChild(qb));return za}}Object(h.a)(Km,"DesignerPane",
null,[683,716,106]);class gp{constructor(t,N,ha,za,Ra,qb){this.M5c=this.f8b=this.jAb=this.lo=null;this.xme=this.Y4b=!1;this.dse=null;this.la=N;this.ia=t;this.X7j=qb;this.Wc=za;this.Ar=Ra;this.DHg=ob.KeyInputManager.Na(ma.a.ajb,0);this.ia.ya(vb.a.SEh,D.a.frame,Object(r.a)(this,this.qqi,"closeCallout"));this.fT=kb.a.Ce();this.fT.className="GoPremiumCalloutContainer";this.H$a=Km.mBa(ha);Sys.UI.DomElement.addCssClass(this.H$a,"GoPremiumCalloutClose");this.H$a.setAttribute(oa.a.Ye,oa.a.hu);this.fT.appendChild(this.H$a);
t=document.createElement("i");t.className=Wd.DDc;t.setAttribute(oa.a.Ye,oa.a.KM);t.setAttribute("Unselectable","on");t.setAttribute(oa.a.pK,oa.a.KB);this.fT.appendChild(t);this.pva=kb.a.Ce();this.pva.className="GoPremiumTitle";this.fT.appendChild(this.pva);this.iT=kb.a.Ce();this.iT.className="GoPremiumSubtitle";this.fT.appendChild(this.iT);this.Gka=kb.a.Ce();this.Gka.className="GoPremiumButton";t=kb.a.Fn();t.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;t.setAttribute("Unselectable","on");
t.setAttribute(oa.a.pK,oa.a.KB);this.Gka.appendChild(t);this.Gka.tabIndex=0;this.Gka.setAttribute(oa.a.Wr,t.innerText);this.Gka.setAttribute(oa.a.Ye,oa.a.hu);this.fT.appendChild(this.Gka);this.ow()}show(t,N,ha,za,Ra,qb){this.VK&&this.dismiss();this.jAb=za;this.f8b=N;this.M5c=Ra;this.dse=qb;this.jAb&&Sys.UI.DomElement.addCssClass(this.jAb,this.M5c);ha?(this.pva.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutTitle,this.iT.innerText=ResourceStrings.l_DesignerInFreeTrialCalloutContent):(this.pva.innerText=
ResourceStrings.l_DesignerUpsellCalloutTitle,this.iT.innerText=ResourceStrings.l_DesignerUpsellCalloutContent);N.setAttribute(oa.a.Pob,oa.a.KB);this.la.H0f?this.lo=new lo.a(t,document.body,v.AFrameworkApplication.Aa.jR,null):(this.lo=Dp.a.mRd(t,document.body,document.body,2,Object(r.a)(this,this.dismiss,"dismiss")),this.lo.qSe=120);this.lo.Y$=310;this.fT.setAttribute(oa.a.Wr,String.format("{0}. {1}",this.pva.innerText,this.iT.innerText));this.fT.setAttribute(oa.a.Ye,oa.a.GAa);this.Ar&&this.Ar.addHandler(this.fT,
la.a.Xf,Object(r.a)(this,this.Fsa,"inputKeyPressHandler"));this.lo.content=this.fT;this.Upa();N=new Sys.UI.Bounds(0,0,sa.a.LPc(),sa.a.KPc());this.lo.iZ=this.WZd(N,t,240,ha);this.lo.qr=!1;this.lo.r$c=()=>{this.fT.parentNode&&Sys.UI.DomElement.addCssClass(this.fT.parentNode,"GoPremiumCalloutContentContainer");this.lo.hJ&&(Sys.UI.DomElement.addCssClass(this.lo.hJ,"GoPremiumCalloutOuter"),this.lo.hJ.removeAttribute(oa.a.Ye),this.la.H0f||(this.lo.hJ.style.zIndex=String(v.AFrameworkApplication.Aa.Rnb)));
this.lo.CLe();this.bR(this.Gka);this.Y4b=!0};this.lo.show()}Upa(){if(gc.FocusManager.mM()){var t=gc.FocusManager.instance(),N=t.Dc("callout/modal");N.parent=kd.a.jj;t.JHd("callout/modal",kd.a.jj,this.fT);t.NX("callout/modal",!1);N.bindAction(this.DHg,vb.a.SEh);N=new Rb.DOMFocusListing(()=>this.fT);N.wfb=!0;N.vo(2);t=t.Jha(()=>this.fT,t.Dc("callout/modal"),N);t.xfb();t.DW=!0;t.IOa=!0}}Bfb(){if(gc.FocusManager.mM()&&!v.AFrameworkApplication.Vg){const N=gc.FocusManager.instance();var t=N.Dc("callout/modal");
t&&t.np(this.DHg);N.R4("callout/modal");(t=N.SP("callout/modal"))&&t.uj.wE(null);N.MFb("callout/modal")}}bR(t){gc.FocusManager.mM()?gc.FocusManager.instance().SP("callout/modal").uj.v6a(t):t.focus()}get VK(){return!!this.lo&&this.lo.VK}Nrj(){this.VK&&(this.Y4b?this.H$a.focus():this.Gka.focus(),this.Y4b=!this.Y4b)}vZf(){this.dismiss();return!0}qqi(){this.dismiss();return 32}dismiss(){if(!this.xme){this.xme=!0;try{this.Bfb(),this.f8b&&(this.f8b.setAttribute(oa.a.Pob,oa.a.lqa),gc.FocusManager.Mr(this.f8b),
this.f8b=null),this.jAb&&(Sys.UI.DomElement.removeCssClass(this.jAb,this.M5c),this.jAb=null),this.dse=this.M5c=null,this.Y4b=!1,this.lo&&(this.lo.dismiss(),this.lo.dispose(),this.lo=null),this.Ar&&this.Ar.removeHandler(this.fT,la.a.Xf,Object(r.a)(this,this.Fsa,"inputKeyPressHandler"))}finally{this.xme=!1}}}dispose(){this.dismiss();this.Ona();this.fT=this.H$a=this.Gka=null}Fsa(t){if(t.keyCode===ma.a.lq||t.keyCode===ma.a.NO){t.preventDefault();t=document.activeElement;try{t?t.click():K.a.J(590967751,
829,15,"PremiumContentCallout::InputKeyPressHandler active element is null.")}catch(N){K.a.J(590967749,829,15,"PremiumContentCallout::InputKeyPressHandler Exception: {0}",N)}}}X_g(){this.X7j(this.dse);return!0}ow(){this.Wc?(this.Wc.ob(la.a.click,this.H$a,Object(r.a)(this,this.vZf,"dismissAndReturn")),this.Wc.ob(la.a.click,this.Gka,Object(r.a)(this,this.X_g,"onGoPremiumClicked"))):K.a.J(594031904,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")}Ona(){this.Wc&&
(this.Wc.xb(la.a.click,this.H$a,Object(r.a)(this,this.vZf,"dismissAndReturn")),this.Wc.xb(la.a.click,this.Gka,Object(r.a)(this,this.X_g,"onGoPremiumClicked")))}WZd(t,N,ha,za){if(za)return 0;za=6;N.y-t.y<ha&&(za=3);return za}}Object(h.a)(gp,"PremiumContentCallout",null,[]);class En{constructor(t,N,ha,za,Ra,qb,Qb,vc){this.lrb=t;this.aQi=N;this.cKc=ha;this.Jh=za;this.pfa=Ra;this.k6a=qb;this.KOe=Qb;this.nod=vc}}Object(h.a)(En,"RenderSuggestionsArgs",null,[746]);class fn extends Sys.EventArgs{constructor(t){super();
this.card=t}}Object(h.a)(fn,"ClickSuggestedActionEventArgs",Sys.EventArgs,[]);class kk extends Sys.EventArgs{constructor(t){super();this.PWc=t}}Object(h.a)(kk,"DesignerClickMoreIdesEventArgs",Sys.EventArgs,[]);class bm extends Sys.EventArgs{constructor(t,N){super();this.t0k=t;this.vkl=N}}Object(h.a)(bm,"DesignerClickSuggestionEventArgs",Sys.EventArgs,[]);class Pl extends fp.a{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of){super(new uk.a,t,qb);this.X$a=this.Y$a=this.hL=this.p_=this.L8b=this.QW=
null;this.jJg=this.lJg=0;this.Lka=!1;this.sSg=this.UFa=this.HAb=null;this.Fo=ha;this.Yq=za;this.Pb=Ra;this.Fa=Qb;this.Wc=vc;this.fe=N;this.gp=Zc;this.Ar=Wc;this.ia=Md;this.Ee=Id;this.la=Xe;this.iFh=this.la.useWideSuggestionThumbs;this.FQ=new yc.a(()=>new gp(this.ia,this.la,N,vc,Wc,Object(r.a)(this,this.tig,"goPremiumExperience")));this.WGg=new am(of,Object(r.a)(this,this.djk,"onAccountUpgrade"),Xe.pPa);this.P3=new dl;this.x4j=Object.assign(new Ve(Md,this.P3,this.la),{Iy:vb.a.B8a})}dispose(){this.Lka&&
this.wPf();this.HAb&&(this.HAb.dispose(),this.HAb=null);this.FQ.h8a&&this.FQ.value.dispose();super.dispose();K.a.J(512496477,829,50,"DesignerView::Dispose")}S3b(){this.QW=kb.a.Ce();this.QW.className="DesignerViewContainer";this.container.appendChild(this.QW);this.Lka=!0;K.a.J(512496476,829,50,"DesignerView::InitializeView")}wPf(){this.la.mJc&&this.Yq.Coi();if(this.QW.children&&0<this.QW.children.length)for(const t=0;t<this.QW.children.length;)this.QW.removeChild(this.QW.children[t]);this.Fo.X$=0;
this.Fo.mfh(Object(r.a)(this,this.onFocus,"onFocus"));this.Fo.nfh(Object(r.a)(this,this.O_g,"onFocusBlur"));this.FQ.h8a&&this.FQ.value.dismiss();K.a.J(512496475,829,50,"DesignerView::CleanUpView")}MYa(t){K.a.J(512496474,829,50,"DesignerView.SetViewState. CorrelationId:{0}, ViewState:{1}",this.Pb.correlationId,zm[t]);this.PM();4!==t&&7!==t&&8!==t&&(this.wPf(),this.QW.id=this.Pb.correlationId);this.Fo.X$=t;switch(this.Fo.X$){case 1:this.oyj();this.m8k();break;case 7:this.l8k();break;case 2:this.vyj();
break;case 9:this.uyj();break;case 5:this.Gyj();break;case 3:this.Lyj();break;case 6:this.pyj();break;case 4:if(t=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(let N=0;N<t.length;N++)t[N].style.visibility=ab.a.visible,t[N].setAttribute(Wd.PMd,Wd.vMf)}this.Fo.bFf(Object(r.a)(this,this.onFocus,"onFocus"));this.Fo.cFf(Object(r.a)(this,this.O_g,"onFocusBlur"))}yra(){return this.la.hYf&&this.WGg.yra()}tig(t){this.la.hYf&&(K.a.J(512496473,829,50,"DesignerView::GoPremiumExperience SourceContext:{0}",
t?t.toString():""),this.FQ.h8a&&this.FQ.value.dismiss(),this.WGg.launchUpsellExperience(this.la.pPa?"designertrial":"designer"))}startFreeTrial(){this.FQ.h8a&&this.FQ.value.dismiss();this.Yq.fql();this.Pb.OPe=!0;this.ww(0,!0);K.a.J(512496472,829,50,"DesignerView::StartFreeTrial Free Trial started")}djk(){K.a.J(512496471,829,50,"DesignerView::OnAccountUpgrade Account has been upgraded");this.FQ.h8a&&this.FQ.value.dismiss();this.Yq.Oul()}oyj(){this.L8b=kb.a.Ce();this.L8b.className="DesignerLoadingView";
const t=kb.a.SB();t.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";t.src=dh.a.uK(fb.a.Dma);const N=kb.a.Ce();N.className=v.AFrameworkApplication.isRtl?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";N.innerText=ResourceStrings.L_DesignerLoading;this.L8b.appendChild(t);K.a.J(512496470,829,50,"DesignerView::spinner shows up");this.L8b.appendChild(N);this.QW.appendChild(this.L8b);K.a.J(512496469,829,50,"DesignerView::InitLoadingState")}wyj(){const t=
kb.a.Ce();t.className="DesignerNoSuggestionNewButton";t.tabIndex=0;t.innerText=ResourceStrings.L_DesignerLearnMoreShort;t.setAttribute("Unselectable","on");t.setAttribute(oa.a.Wr,t.innerText);t.setAttribute(oa.a.Ye,oa.a.hu);t.setAttribute("href",fb.a.cYf);this.Wc.ob(la.a.click,t,Object(r.a)(this,this.kQf,"clickSuggestionLinkHandler"));this.p_.appendChild(t)}tyj(){const t=kb.a.vba();t.className="DesignerNoSuggestionView-Link";t.setAttribute("href",fb.a.cYf);t.setAttribute("target","_blank");t.innerText=
ResourceStrings.L_DesignerLearnMore;t.tabIndex=0;t.setAttribute(oa.a.Ye,oa.a.RKd);this.p_.appendChild(t);this.Wc.ob(la.a.click,t,Object(r.a)(this,this.kQf,"clickSuggestionLinkHandler"))}vyj(){this.Fo.isVisible&&(this.W7d(!1),this.Y$a.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,this.X$a.innerText=ResourceStrings.L_DesignerNoSuggestionContent,K.a.J(512496468,829,50,"DesignerView::InitNoSuggestionState"))}uyj(){this.Fo.isVisible&&(this.W7d(!0),this.Y$a.innerText=ResourceStrings.L_DesignerNoIdeasHeader,
this.X$a.innerText=ResourceStrings.L_DesignerNoIdeas,K.a.J(512496467,829,50,"DesignerView::InitNoSuggestionState"))}Gyj(){this.Fo.isVisible&&(this.W7d(!1),this.Y$a.innerText=ResourceStrings.L_DesignerCoauthorHeader,this.X$a.innerText=ResourceStrings.L_DesignerCoauthorContent,K.a.J(512496466,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"))}W7d(t){this.p_=kb.a.Ce();this.p_.className=v.AFrameworkApplication.isRtl?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";this.Y$a=kb.a.Ce();
this.X$a=kb.a.Ce();this.Yq.Zfh(this.QW);if(t){this.Y$a.className="DesignerNoSuggestionNew-Header";this.X$a.className="DesignerNoSuggestionNew-Content";const N=kb.a.SB();N.src=this.fe.hk("DesignerNoIdeas.svg");N.className="DesignerNoIdeasIllustration";this.p_.appendChild(N)}else this.Y$a.className="DesignerNoSuggestionView-Header",this.X$a.className="DesignerNoSuggestionView-Content";this.p_.appendChild(this.Y$a);this.p_.appendChild(this.X$a);t?this.wyj():this.tyj();this.QW.appendChild(this.p_);this.Ar.addHandler(this.p_,
la.a.Xf,Object(r.a)(this,this.Fsa,"inputKeyPressHandler"))}Lyj(){this.Fo.isVisible||this.Fo.kp(!0,Eg.a.none);this.hL=kb.a.Ce();const t=this.iFh?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",N=this.iFh?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";this.hL.className=v.AFrameworkApplication.isRtl?N:t;this.QW.appendChild(this.hL);this.la.fYf||(this.Fa.Gj(kd.a.o7,!0),this.Fa.Ad());this.Wc.ob(la.a.click,this.hL,Object(r.a)(this,this.Spi,"clickSuggestionHandler"));this.Ar.addHandler(this.hL,
la.a.Xf,Object(r.a)(this,this.cSc,"inputKeyApplyHandler"));this.gp.ob(la.a.pointerOver,this.hL,Object(r.a)(this,this.zC,"onPointerOver"));this.gp.ob(la.a.pointerOut,this.hL,Object(r.a)(this,this.iz,"onPointerOut"));K.a.J(512496465,829,50,"DesignerView::InitShowSuggestionState")}cej(){return this.O1b(this.hL.querySelector("#"+this.Hp.id+" .DesignerSuggestionResultSelected"))}K6i(){return this.O1b(this.hL.querySelector("#"+this.Hp.id+" ["+Wd.zpb+"]:hover"))}O1b(t){let N;return({suggestionIndex:N}=this.Bgg(t)).returnValue?
parseInt(N):-1}Bgg(t){let N,ha,za;za=ha=N="";if(t){const Ra=t.getAttribute(Wd.OAa),qb=t.getAttribute(Wd.zpb);if(!Ra||!qb)return K.a.J(512496464,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",this.Pb.correlationId),{returnValue:!1,suggestionIndex:N,slideId:ha,aPe:za};N=Ra.toString();ha=qb.toString();(t=t.getAttribute(Wd.OMd))?za=t.toString():K.a.J(512496463,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",
this.Pb.correlationId);return{returnValue:!0,suggestionIndex:N,slideId:ha,aPe:za}}return{returnValue:!1,suggestionIndex:N,slideId:ha,aPe:za}}P1b(){return this.hL.querySelectorAll("#"+this.Hp.id+" ["+Wd.OAa+"]").length}kQf(t){return this.Fo.isVisible&&t&&t.LB?this.Gig(t.LB.className):!1}Xia(){const t=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",N=this.la.useWideSuggestionThumbs?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return this.container.querySelector("."+
(v.AFrameworkApplication.isRtl?N:t))}Rpi(t){t=t.getAttribute(Wd.OAa).toString();t=this.Pb.qOa[parseInt(t)];if(!t||3!==t.Type&&4!==t.Type)return!1;this.Ee.zGk(new fn(t));return!0}NKc(t,N){for(;t&&t.className!==N;)t=t.parentNode;return t}Spi(t){if(!this.Fo.isVisible||t.dA!==Sys.UI.MouseButton.leftButton||!this.Yq.Ba||!t.Ac)return!1;var N=t.Ac;try{if(N.className){if(N.className===Sc.sCb||N.className===Sc.tCb||N.className===Sc.uue||N.className===Sc.m7c)return this.Qpi(N);if(N.className.startsWith(Sc.h0f))return this.Ppi(N)}else K.a.J(512496462,
829,15,"DesignerView::ClickSuggestionHandler ClassName is null")}catch(Md){return K.a.J(512496461,829,15,"DesignerView::ClickSuggestionHandler unexpected exception: {1}",N.className,Md.message),!1}if(t=this.NKc(N,Wd.EMf))return this.Rpi(t);if(this.yra()){if(N.className===Wd.xpb)return this.startFreeTrial(),!0;if(N.className===Wd.CVb)return t=gd.a.ei(N),this.FQ.value.show(t,N,!0,N,"DesignerInFreeTrialViewGoPremiumTextSelected",null),!0;(t=this.NKc(N,Wd.BVb))||(t=this.NKc(N,Wd.xDc));if(t)return this.tig(null),
!0}if(this.la.lia&&(t=this.NKc(N,Wd.JMd))){this.Yq.cRc(this.Xia());if(!t.getAttribute(Wd.wpb))return!1;this.Yq.tel(this.Xia());t=new kk(t.getAttribute(Wd.wpb).toString());this.Ee.LGk(t);return!0}if(Sys.UI.DomElement.containsCssClass(N,"ms-Icon--Diamond")){if(N=N.parentNode,!N)return!1}else if(!(Sys.UI.DomElement.containsCssClass(N,Wd.GDc)||Sys.UI.DomElement.containsCssClass(N,Wd.DVb)||Sys.UI.DomElement.containsCssClass(N,Wd.HDc)||(N=N.firstChild,N)))return!1;t=N.parentNode;var ha=document.querySelector("#"+
this.Hp.id+" ."+Wd.lOa);if(!({suggestionIndex:vc,slideId:Zc,aPe:Wc}=this.Bgg(t)).returnValue)return!1;var za=parseInt(vc),Ra=parseInt(Zc);const qb=parseInt(Wc)||0;let Qb=this.Pb.fZ.sid===Ra;this.la.lia&&(Qb=this.Yq.Qsb(ha,!1)===t||this.Yq.Qsb(ha,!0)===t);if(Qb)return K.a.J(512496460,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),this.Ee.Qah(new bm(za,this.P1b())),!1;if(t&&t.getAttribute(Wd.ADc)){N=null;ha=t.childNodes;for(za=0;za<ha.length;za++)if(Ra=ha[za],Sys.UI.DomElement.containsCssClass(Ra,
Wd.GDc)){N=Ra;break}ha=new Fo(vc,Zc,Wc);N=gd.a.ei(N||t);this.FQ.value.show(N,t,!1,null,null,ha);return!1}if(Sys.UI.DomElement.containsCssClass(N,Wd.HDc))return!1;var vc=this.Fdj(N,Ra,qb);var Zc=Object.assign(new An,{SuggestionCid:qb,SuggestionSid:Ra,CorrelationId:ha.getAttribute("correlationId").toString(),ActiveSlideCid:this.Yq.Ba.cid,ActiveSlideSid:this.Yq.Ba.sid});var Wc=N;Wc=.01>=Math.abs(Wc.width/Wc.height-1.33);this.Yq.Qsb(ha,Wc)?(this.Yq.vPf(ha,Wc),vc&&vc.parentNode&&vc.parentNode.parentNode&&
this.Yq.vPf(vc.parentNode.parentNode,Wc),this.ia.La(vb.a.Iob,2,Zc),K.a.J(512496459,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(this.ia.La(vb.a.DAa,2,Zc),K.a.J(512496458,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));this.la.iHi&&t&&t.getAttribute(Wd.BMd)&&u.a.instance.Ka("Common.ISystemInitiatedFeedback").execute(Md=>{try{Md.logActivity("DesignerAnimationSuggestion",null)}catch(Id){K.a.J(512496457,829,10,"Designer Animation Suggestion teaching UI failed with exception: {0}",
Id)}});this.Yq.qmh(N.parentNode,Wc);vc&&this.Yq.qmh(vc.parentNode,Wc);this.Yq.Jkh(this.QW,za);this.Ee.Qah(new bm(za,this.P1b()));return!0}Fdj(t,N,ha){var za="["+Wd.zpb+'="'+N+'"] > .'+Wd.DVb;ha&&(za=String.format('[{0}="{1}"][{2}="{3}"] > .{4}',Wd.zpb,N,Wd.OMd,ha,Wd.DVb));N=document.querySelectorAll(za);if(!N)return null;for(ha=0;ha<N.length;ha++)if(za=N[ha],za!==t)return za;return null}Fsa(t){this.Fo.isVisible&&(t.keyCode!==ma.a.lq&&t.keyCode!==ma.a.NO||this.Gig(t.target.className))}cSc(t){!this.Fo.isVisible||
t.keyCode!==ma.a.lq&&t.keyCode!==ma.a.NO||(t.preventDefault(),(t=document.activeElement)&&t.click())}ww(t,N){if(!(0>t)){var ha=this.hL.querySelector("["+Wd.OAa+'="'+t+'"]');ha?N&&(gc.FocusManager.Mr(ha),this.Yq.Jkh(this.QW,t)):K.a.J(512496456,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",t)}}Jhg(){return this.yra()?this.hL.querySelector("."+Wd.CVb)?2:this.hL.querySelector("."+Wd.xpb)?1:this.hL.querySelector("."+Wd.BVb)?3:0:0}wzg(){return!!this.hL.querySelector("."+Wd.xpb+
":focus")}plc(t){const N=this.hL.querySelector("."+Wd.xpb);N?t?gc.FocusManager.Mr(N):N.blur():K.a.J(512496455,829,15,"DesignerView::SetStartFreeTrialFocus, StartFreeTrial Button is not present")}Kkg(){this.vAg()&&this.FQ.value.Nrj()}vAg(){return this.FQ.h8a&&this.FQ.value.VK}ORj(t){return t?!!t&&(t.className===Wd.xpb||t.className===Wd.xDc||t.className===Wd.CVb||t.className===Wd.BVb):!1}mna(t,N){let ha=null;1===N?ha=this.hL.querySelector("."+Wd.xDc):2===N?ha=this.hL.querySelector("."+Wd.CVb):3===N&&
(ha=this.hL.querySelector("."+Wd.BVb));ha?t?gc.FocusManager.Mr(ha):ha.blur():K.a.J(512496454,829,15,"DesignerView::SetGoPremiumFocus, Go Premium Button is not present for {0} for upsell View State",N)}Q7k(t,N){(N=9===N?this.p_.querySelector(".DesignerNoSuggestionNewButton"):this.p_.querySelector(".DesignerNoSuggestionView-Link"))?t?N.focus():N.blur():K.a.J(512496453,829,15,"DesignerView::SetSuggestionLinkFocus, Can't find linkelement")}oQj(t){return!(9===t?!this.p_.querySelector(".DesignerNoSuggestionNewButton:focus"):
!this.p_.querySelector(".DesignerNoSuggestionView-Link:focus"))}Gig(t){try{const N=this.p_.querySelector("."+t);if(!N)return!1;const ha=N.getAttribute("href").toString();if(!ha)return!1;gd.a.openWindow(4,ha);return!0}catch(N){return K.a.J(512496452,829,10,"DesignerView:GoToSuggestionLink exception: {0}",N),!1}}O_g(){this.Fo.isVisible&&this.FQ.h8a&&this.FQ.value.VK&&this.FQ.value.dismiss()}onFocus(){if(this.Fo.isVisible)if(2===this.Fo.X$)gc.FocusManager.Mr(this.p_.lastChild);else if(3===this.Fo.X$){var t=
this.Jhg();if(1===t)this.plc(!0);else if(3===t)this.mna(!0,t);else{t=this.cej();var N=this.K6i();-1===t?this.ww(-1===N?0:N,!0):this.ww(t,!0)}}}zC(t){return this.Fo.isVisible&&t.Ac?this.g0f(t.clientPoint):!1}iz(t){return this.Fo.isVisible&&t.Ac?this.g0f(t.clientPoint):!1}Unj(t){this.PM();this.MYa(2);K.a.J(512496451,829,50,"DesignerView::HandleGetSuggestionsTimeout, CorrelationId: {0}",t);this.Fo.isVisible&&(this.Pb.VSa=!0,this.ia.La(vb.a.Xma,2,new Dn.a(!1,Eg.a.Fkd)))}m8k(){const t=this.Pb.correlationId;
this.lJg=window.setTimeout(()=>{this.Unj(t)},this.la.uTd)}Tnj(t){this.PM();this.Yq.cRc(this.Xia());K.a.J(512496450,829,15,"DesignerView::HandleGetMoreIdeasTimeout, CorrelationId: {0}",t)}l8k(){const t=this.Pb.correlationId;this.jJg=window.setTimeout(()=>{this.Tnj(t)},this.la.uTd)}PM(){window.clearTimeout(this.lJg);window.clearTimeout(this.jJg)}get Hp(){return this.Fo}pyj(){this.hL.style.display=ab.a.none;this.Pb.Ite=!0;this.UFa=kb.a.Ce();this.UFa.className=Sc.vfk;const t=this.CUf(Sc.wue),N=document.createElement("iframe");
N.className=N.id=Sc.xVg;const ha=this.CUf(Sc.vue);this.UFa.appendChild(t);this.UFa.appendChild(N);this.UFa.appendChild(ha);this.QW.appendChild(this.UFa);const za=this.Fa.Dc(kd.a.xRc);za.parent=ua.AFrame.mD;this.Wc.RAc(kd.a.xRc,N);za.bba(()=>{N.focus();const Ra=Object.assign(new Rb.DOMFocusListing(()=>this.UFa),{wfb:!0});Ra.vo(3);Ra.vo(2);Ra.vo(4);Ra.vo(1);Ra.vo(6);Ra.vo(5);gc.FocusManager.instance().lMd(this.UFa,za,Ra);const qb=gc.FocusManager.instance().SP(kd.a.xRc);qb.xfb();qb.DW=!0;qb.IOa=!0;za.np(gc.FocusManager.instance().ypa);
za.np(gc.FocusManager.instance().zpa);Ra.wE(N)});this.Fa.Bf(kd.a.xRc);this.Ar.addHandler(this.UFa,la.a.Xf,Object(r.a)(this,this.Lz,"keyDownHandler"))}CUf(t){const N=document.createElement("div");N.setAttribute("Id",t);N.setAttribute("tabindex",0);N.setAttribute("position","absolute");N.setAttribute("width","-1000px");N.setAttribute("top","-1000px");return N}Lz(t){t.keyCode===Sys.UI.Key.tab&&(t.target.id!==Sc.vue||t.shiftKey?t.target.id===Sc.wue&&t.shiftKey&&this.Cnh(t,Sc.vue):this.Cnh(t,Sc.wue))}Cnh(t,
N){t.preventDefault();t.stopPropagation();(t=document.getElementById(N))&&t.focus()}Qpi(t){switch(t.className){case Sc.m7c:return this.Hp.Ngb(1),!0;case Sc.sCb:t=t.querySelector("."+Sc.tCb).innerText;break;case Sc.tCb:t=t.innerText;break;case Sc.uue:t=t.parentNode.querySelector("."+Sc.tCb).innerText;break;default:return!1}return this.FTk(t)}FTk(t){this.la.lia&&(this.sSg=this.Xia().querySelector("."+Wd.lOa).getAttribute("correlationId").toString());this.MYa(6);var N=gb.a.NM(this.la.pptEditingUserId).toString();
N=String.format(this.la.insertPictureServiceEndpoint,v.AFrameworkApplication.lcid,xd.a.oe(v.AFrameworkApplication.lcid).name,v.AFrameworkApplication.buildVersion,Be.a.create().toString(),3,N,0);N=N.replace(RegExp("&amp;","g"),"&").replace(RegExp("&p=3"),"&p=6")+"&q="+t;t=document.getElementById(Sc.xVg);t.setAttribute("src",N);t.style.visibility=ab.a.visible;this.HAb=(new xj).getInstance(t.contentWindow,N);this.HAb.ywa(Yd.a.CDf,ha=>{if(ha=this.P3.A5g(ha)){const za=[];Array.add(za,ha);this.ia.processAction(vb.a.zjd,
2);this.Hp.kp(!1,Eg.a.CQf);this.x4j.Gsa(za)}});this.HAb.ywa(Of.tK,()=>{this.MYa(3);const ha=new En(this.Pb.suggestions,this.Pb.suggestions?this.Pb.suggestions.SlideSuggestions.length:0,this.Pb.qOa.length,this.la.lia?this.sSg:this.Pb.correlationId,this.Xia(),!0,this.yra(),this.Yq.MRc(zc.makeItVisual));this.Yq.IGe(ha)});return!0}Ppi(t){return Sys.UI.DomElement.containsCssClass(t,Sc.Hrb)||Sys.UI.DomElement.containsCssClass(t,Sc.Grb)?this.xnj(t):Sys.UI.DomElement.containsCssClass(t,Sc.EPa)||Sys.UI.DomElement.containsCssClass(t,
Sc.cJc)||Sys.UI.DomElement.containsCssClass(t,Sc.l0f)||Sys.UI.DomElement.containsCssClass(t,Sc.k0f)?this.ynj(t):Sys.UI.DomElement.containsCssClass(t,Sc.rZb)?this.doj():Sys.UI.DomElement.containsCssClass(t,Sc.vZb)?this.hpj():!1}hpj(){this.ia.processAction(vb.a.fBe,2);this.Hp.kp(!1,Eg.a.xsk);return this.Pb.a0f=!0}g0f(t){const N=this.Pb.LPd;if(!N||Ff.a.Va(this.Pb.RV))return!1;t=gd.a.GQa(t);this.AHj(t)?N.kRc(this.H$f()):N.kRc([]);return!0}AHj(t){for(;t&&t.className!==Sc.XUd;)t=t.parentNode;return!!t&&
t.className===Sc.XUd}doj(){const t=this.Pb.LPd;if(!t)return!1;t.ignoreCritiques(this.H$f(),4);this.Pb.RV.splice(this.Pb.VM,1);if(this.Pb.VM===this.Pb.RV.length){let N;(N=this.Pb).VM=N.VM-1}this.aMk();return!0}H$f(){const t=[];for(const N of this.Pb.RV[this.Pb.VM].critiques)t.push(N.critiqueId);return t}xnj(t){if(Sys.UI.DomElement.containsCssClass(t,Sc.Hrb)){let N;(N=this.Pb).VM=N.VM-1;this.Pb.VM||(Sys.UI.DomElement.removeCssClass(t,Sc.Hrb),Sys.UI.DomElement.addCssClass(t,Sc.tZb));t=document.getElementById(Sc.Frb);
Sys.UI.DomElement.removeCssClass(t,Sc.sZb);Sys.UI.DomElement.addCssClass(t,Sc.Grb)}else{let N;(N=this.Pb).VM=N.VM+1;this.Pb.VM===this.Pb.RV.length-1&&(Sys.UI.DomElement.removeCssClass(t,Sc.Grb),Sys.UI.DomElement.addCssClass(t,Sc.sZb));t=document.getElementById(Sc.F5a);Sys.UI.DomElement.removeCssClass(t,Sc.tZb);Sys.UI.DomElement.addCssClass(t,Sc.Hrb)}document.getElementById(Sc.WUd).innerText=(this.Pb.VM+1).toString();this.eDh(this.Pb.VM);return!0}eDh(t){var N=this.Pb.RV[t].critiques[0].explanationLabel;
document.getElementById(Sc.j0f).innerText=N;N=document.getElementById(Sc.m0f);const ha=Wd.fUf();N.parentNode.replaceChild(ha,N);this.Yq.pkg(ha,t)}ynj(t){const N=this.Pb.LPd;if(Ff.a.Va(this.Pb.RV)||!N)return!1;t=t.getAttribute(Of.DPa);var ha=document.querySelector("."+Sc.cJc+"["+Of.DPa+'="'+t+'"]');ha&&(ha.innerText="\u2713",Sys.UI.DomElement.removeCssClass(ha,Sc.cJc),Sys.UI.DomElement.addCssClass(ha,Sc.cMi));ha=new ud.a(0);for(const za of this.Pb.RV[this.Pb.VM].critiques)ha.add(za.critiqueId,t);N.vxh(ha);
return this.Pb.aJc=!0}aMk(){var t=document.getElementById(Sc.Z_f);let N=parseInt(t.innerText);N--;if(0>=N)this.Ael(document.getElementById(Sc.$_f));else{t.innerText=N.toString();this.eDh(this.Pb.VM);t=this.Pb.VM===this.Pb.RV.length-1;const ha=document.getElementById(Sc.Frb);1<N&&!t?(Sys.UI.DomElement.addCssClass(ha,Sc.Grb),Sys.UI.DomElement.removeCssClass(ha,Sc.sZb)):(Sys.UI.DomElement.addCssClass(ha,Sc.sZb),Sys.UI.DomElement.removeCssClass(ha,Sc.Grb));t&&(document.getElementById(Sc.WUd).innerText=
N.toString());t=document.getElementById(Sc.F5a);1<N&&this.Pb.VM?(Sys.UI.DomElement.addCssClass(t,Sc.Hrb),Sys.UI.DomElement.removeCssClass(t,Sc.tZb)):(Sys.UI.DomElement.addCssClass(t,Sc.tZb),Sys.UI.DomElement.removeCssClass(t,Sc.Hrb))}}Ael(t){const N=kb.a.Ce();N.className=Sc.XLi;const ha=new Fd.a;ha.gh(40,40);ha.gxa("0,0,2048,2048");ha.jr(Sc.dMi);var za=new Ni.a;za.y0("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
const Ra=new Ni.a;Ra.y0("M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");Ra.xa.setAttribute("class",Sc.gMi);const qb=
new Ni.a;qb.y0("M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
qb.xa.setAttribute("class",Sc.VLi);const Qb=new Ni.a;Qb.y0("M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
Qb.xa.setAttribute("class",Sc.ULi);ha.appendChild(za);ha.appendChild(Ra);ha.appendChild(qb);ha.appendChild(Qb);za=kb.a.Fn();za.innerText=ResourceStrings.l_ConsistencyCardNoMore;za.className=Sc.YLi;N.appendChild(ha.xa);N.appendChild(za);t.parentNode.replaceChild(N,t)}}Pl.SLi=[Sc.F5a,Sc.Frb,Sc.EPa,Sc.rZb,Sc.vZb];Object(h.a)(Pl,"DesignerView",fp.a,[682,352,201,106]);var Lf=d(186);class no extends Sys.EventArgs{constructor(t,N){super();this.slideId=t.slideId;this.$vh=t.Xmc;this.g3f=t.L$;this.k6a=N;this.trigger=
t.trigger;this.correlationId=t.correlationId}}Object(h.a)(no,"RenderSuggestionsEventArgs",Sys.EventArgs,[]);class lk{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id){this.dKg=new Kg.a;this.Xq=t;this.Yq=N;this.Pb=ha;this.la=za;this.ia=Ra;this.ua=qb;this.Fb=Qb;this.Lc=vc;this.Fa=Zc;this.m8b=this.Zge=0;this.wUa=Wc;this.L0j=Md;this.lva=Id;this.ow()}ow(){this.Lc.h6h(Object(r.a)(this,this.X2g,"onSuggestionsUpdated"));this.Lc.g6h(Object(r.a)(this,this.FZg,"onCoauthModifiedSameSlide"));this.L0j.execute(t=>
{t.C3h(Object(r.a)(this,this.Lqk,"onShowMoreSuggestions"),()=>{this.iHb(this.Xq,3)})});this.la.designerIncrementalRenderEnabled&&this.Lc.e7h(Object(r.a)(this,this.y3g,"onUserBeginUploadPicture"));this.Lc.DBc(Object(r.a)(this,this.rma,"onUndoRedo"))}dispose(){this.Lc.KRk(Object(r.a)(this,this.X2g,"onSuggestionsUpdated"));this.Lc.JRk(Object(r.a)(this,this.FZg,"onCoauthModifiedSameSlide"));this.la.designerIncrementalRenderEnabled&&this.Lc.rSk(Object(r.a)(this,this.y3g,"onUserBeginUploadPicture"));this.Lc.Qed(Object(r.a)(this,
this.rma,"onUndoRedo"))}p1k(t){this.ia.La(vb.a.Xma,2,new Dn.a(!1,t))}iHb(t,N){t?t.MYa(N):K.a.J(512496522,829,50,"SetDesignerViewState - null view. CorrelationId:{0}, ViewState:{1}",this.Pb.correlationId,N)}Krj(t){const N=this.THi(t);if(N){var ha=N.Hp;K.a.J(512496521,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",t,zm[ha.X$]);switch(ha.X$){case 3:this.ygk(t,N);break;case 2:case 9:this.xgk(t,N,ha.X$)}}}THi(t){switch(t){case vb.a.wWa:case vb.a.HCb:case vb.a.ICb:case vb.a.xWa:case vb.a.KCb:case vb.a.LCb:case vb.a.JCb:case vb.a.Ddb:t=
this.Xq;break;default:return null}return t}ygk(t,N){if(N&&N.Hp){var ha=document.activeElement;if(ha){var za=ha.getAttribute(Wd.OAa),Ra=N.ORj(ha),qb=Sys.UI.DomElement.containsCssClass(ha,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(ha,"IdeasText"),Qb=this.wVg(ha)||this.b0f(ha),vc=N.vAg();if(za||qb||Qb||Ra||vc)if(za=za?parseInt(za.toString()):-1,Ra=N.P1b()-1,!(1>Ra))switch(qb=N.Hp,Qb=N.Jhg(),t){case vb.a.wWa:if(vc||1===Qb||3===Qb)break;qb.jA(!1);za<Ra&&(N.ww(za,!1),N.ww(za+1,!0));
break;case vb.a.HCb:if(vc||1===Qb||3===Qb)break;qb.jA(!1);za!==Ra&&(N.ww(za,!1),N.ww(Ra,!0));break;case vb.a.ICb:if(vc){N.Kkg();break}this.$oj(N,za,Ra,Qb);break;case vb.a.xWa:if(vc||1===Qb||3===Qb)break;qb.jA(!1);0<za&&(N.ww(za,!1),N.ww(za-1,!0));break;case vb.a.KCb:if(vc||1===Qb||3===Qb)break;qb.jA(!1);za&&(N.ww(za,!1),N.ww(0,!0));break;case vb.a.LCb:if(vc){N.Kkg();break}this.apj(N,za,Ra,Qb);break;case vb.a.JCb:case vb.a.Ddb:vc||1===Qb||3===Qb||(t=t===vb.a.Ddb,N=N.Hp,this.wVg(ha)?this.cpj(t,N):this.b0f(ha)&&
this.bpj(t,N))}}}}$oj(t,N,ha,za){const Ra=t.Hp;if(-1===N){switch(za){case 1:Ra.nSa?(Ra.jA(!1),t.plc(!0)):t.wzg()?(t.plc(!1),t.mna(!0,za)):(t.mna(!1,za),Ra.jA(!0));return;case 2:Ra.nSa?(Ra.jA(!1),t.ww(0,!0)):(t.mna(!1,za),Ra.jA(!0));return;case 3:N=Ra.nSa;Ra.jA(!N);t.mna(N,za);return}Ra.jA(!1);t.ww(0,!0)}else N===ha?(t.ww(N,!1),2===za?t.mna(!0,za):Ra.jA(!0)):(t.ww(N,!1),t.ww(N+1,!0))}apj(t,N,ha,za){const Ra=t.Hp;if(0<N)t.ww(N,!1),t.ww(N-1,!0);else if(-1===N){switch(za){case 1:Ra.nSa?(Ra.jA(!1),t.mna(!0,
za)):t.wzg()?(t.plc(!1),Ra.jA(!0)):(t.mna(!1,za),t.plc(!0));return;case 2:Ra.nSa?(Ra.jA(!1),t.mna(!0,za)):(t.mna(!1,za),t.ww(ha,!0));return;case 3:N=Ra.nSa;Ra.jA(!N);t.mna(N,za);return}Ra.nSa&&(Ra.jA(!1),t.ww(ha,!0))}else t.ww(0,!1),Ra.jA(!0)}xgk(t,N,ha){if(N){var za=N.Hp;if(t===vb.a.ICb||t===vb.a.LCb||t===vb.a.xWa||t===vb.a.wWa)t=N.oQj(ha),za.jA(t),N.Q7k(!t,ha)}}wVg(t){return Sys.UI.DomElement.containsCssClass(t,Sc.m7c)||Sys.UI.DomElement.containsCssClass(t,Sc.sCb)}b0f(t){return t.className.startsWith(Sc.h0f)}cpj(t,
N){var ha=document.activeElement;ha&&(Sys.UI.DomElement.containsCssClass(ha,Sc.sCb)?(ha=parseInt(ha.getAttribute(Sc.yVg).toString())+1,t?ha!==Of.odc?N.Ngb(ha+1):N.Ngb(1):1!==ha?N.Ngb(ha-1):N.Ngb(Of.odc)):t?N.Ngb(1):N.Ngb(Of.odc))}bpj(t,N){var ha=document.activeElement;if(ha){for(var za=Pl.SLi,Ra=0;!Sys.UI.DomElement.containsCssClass(ha,za[Ra]);)if(Ra++,Ra===za.length){Ra=-1;break}var qb=document.querySelectorAll("."+Sc.EPa).length;za[Ra]!==Sc.EPa?t?Ra!==za.length-1&&-1!==Ra?za[Ra+1]!==Sc.EPa?this.rub(za[Ra+
1],N):N.uhd(0):this.rub(za[0],N):Ra&&-1!==Ra?za[Ra-1]!==Sc.EPa?this.rub(za[Ra-1],N):N.uhd(qb-1):this.rub(za[za.length-1],N):(ha=parseInt(ha.getAttribute(Of.DPa).toString()),t?ha!==qb-1?N.uhd(ha+1):this.rub(za[Ra+1],N):ha?N.uhd(ha-1):this.rub(za[Ra-1],N))}}rub(t,N){switch(t){case Sc.F5a:N.O3k();break;case Sc.Frb:N.N3k();break;case Sc.rZb:N.L3k();break;case Sc.vZb:N.M3k()}}O2b(t,N){if(this.la.zTc&&this.Xq.Hp.isVisible){if(N&&(t===vb.a.DAa||t===vb.a.Iob)){this.Pb.fZ=O.a.empty;N=this.ua.presentation;
const ha=this.Fb.ud(7,void 0,void 0,void 0,!0);try{ha.kc(N),this.la.tHi&&(ha.fd=t),N.removeProperty(Vb.a.DBa)}finally{ha&&ha.dispose()}}this.Yq.Ptl(this.Xq.Xia());this.la.oHi&&t!==vb.a.DAa&&t!==vb.a.Iob&&this.ia.processAction(vb.a.gYf,2)}}rma(t,N){this.O2b(N.AUe,N.L9a)}bGj(t){return this.Pb.Wwb(t)}oAg(t){switch(t){case kg.a.fLd:case kg.a.iLd:case kg.a.WUb:case kg.a.hLd:case kg.a.jLd:case kg.a.kLd:case kg.a.YNa:case kg.a.lLd:case kg.a.mLd:case kg.a.nLd:case kg.a.oLd:case kg.a.qLd:case kg.a.sLd:case kg.a.backspace:case kg.a.KAa:case kg.a.wK:case kg.a.lPa:case kg.a.enter:case kg.a.cB:case kg.a.typing:return!0;
default:return!1}}isEnabled(){return this.la.zTc}dGj(){return 0<this.m8b}XOd(){return this.m8b}FZg(t,N){t=N.slideId;K.a.J(512496520,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",t.sid);if((N=this.ua.Ba)&&N.Bb.equals(t)){N="unopened";this.Xq.Hp.isVisible&&(this.Xq.Hp.isVisible&&this.iHb(this.Xq,5),N="set to SameSlideCoauthNoSuggestion UI");let ha="unopened";this.Xq.Hp.isVisible&&(this.oHa(this.Pb.correlationId,Lj.a.nHa),ha="closed");"unopened"===N&&"unopened"===
ha||K.a.J(512496519,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",N,ha,t.sid,t.cid,this.Pb.correlationId,this.Zge,this.m8b)}}X2g(t,N){K.a.J(512496518,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, CoauthCountInPresentation:{1}, CoauthCountInSlide:{2}, correlationId:{3}; trigger: {4}",this.la.zTc,this.Zge,
this.m8b,N.correlationId,N.trigger);if(this.isEnabled()){if(t=this.ua.Ba)if(N.slideId.equals(t.Bb))if(this.bGj(N.correlationId))K.a.J(512496515,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",N.correlationId);else if(this.lAl(N.correlationId))K.a.J(512496514,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",
N.correlationId);else{this.Pb.correlationId!==N.correlationId&&(this.Pb.ZCf(N.correlationId,this.la.lia&&N.trigger===zc.moreIdeas),K.a.J(512496513,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Pb.correlationId,N.correlationId));if(this.Pb.correlationId===N.correlationId&&this.Xq.Hp.isVisible&&3===this.Xq.Hp.X$)if(this.la.designerIncrementalRenderEnabled&&Ff.a.any(N.Xmc.toArray(),ha=>0<=this.Pb.$da.indexOf(ha)))this.Pb.Cdc=
new Date,K.a.J(512496512,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",N.correlationId,N.Xmc.toString(),this.Pb.$da.toString());else if(t=N.BJa,!this.la.designerIncrementalRenderEnabled||this.Pb.Zqa.contains(t)){K.a.J(512496483,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",N.correlationId,t.toString());
return}t=Wd.pTd(N.JBa);this.AZk(t,N);this.Mrj(N);this.Lrj(this.Xq,N,t,N.L$,Ff.a.Va(this.Pb.qOa)?N.L$:this.Pb.qOa.length)}else K.a.J(512496516,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",N.correlationId)}else K.a.J(512496517,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",N.correlationId)}AZk(t,N){if(t&&N.trigger!==zc.moreIdeas){this.Pb.suggestions||(this.Pb.suggestions=Object.assign(new Cn,
{CardData:t.CardData,SlideSuggestions:Array(N.H7d?N.L$:N.qZa)}));if(!Ff.a.Va(t.SlideSuggestions))for(const ha of t.SlideSuggestions)this.Pb.suggestions.SlideSuggestions[ha.Index]=ha;this.Pb.qOa||(this.Pb.qOa=Wd.jvk(t))}}Lrj(t,N,ha,za,Ra){K.a.J(512496482,829,50,"DesignerView.SetViewState. CorrelationId:{0}, Trigger:{1}, TotalSuggestions:{2}, DesignerCardCount:{3}",N.correlationId,N.trigger,N.L$,za);if(N.trigger===zc.moreIdeas)this.Pb.qfa||(this.Pb.qfa=new Date),za=t.P1b(),this.Yq.GTk(ha,t.Xia(),N.correlationId,
t.yra())||(this.Yq.cRc(t.Xia()),za=t.P1b()-1),t.ww(za,!0),this.iHb(t,8);else if(!za)!this.la.designerNewNoIdeasUxEnabled||N.trigger!==zc.koc&&N.trigger!==zc.RJb?this.iHb(t,2):this.iHb(t,9),this.Xq.Hp.isVisible?this.oHa(this.Pb.correlationId,Lj.a.nHa):this.p1k(Eg.a.noSuggestion);else if(this.Ibl(N.trigger,t.Hp)){var qb=!0;if(this.la.designerIncrementalRenderEnabled){qb=null;var Qb=t.Xia();Qb&&(qb=Qb.querySelector("#"+t.Hp.id+" ."+Wd.lOa+'[correlationId="'+N.correlationId+'"]'));qb=!qb;K.a.J(512496481,
829,50,"HandleSuggestionUpdate CorrelationId:{0}, Trigger:{1}, FirstRender:{2}",N.correlationId,N.trigger,qb);Qb=new no(N,qb);this.Lc.XHk(Qb)}if(qb){this.iHb(t,3);this.Pb.qfa||(this.Pb.qfa=new Date);try{this.la.oAk&&this.lva.execute(vc=>{vc.logActivity("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(vc){K.a.J(512496480,829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",vc)}}t=new En(ha,za,Ra,N.correlationId,t.Xia(),
qb,t.yra(),this.Yq.MRc(N.trigger));this.Yq.IGe(t)}}Mrj(t){t.H7d?(Ff.a.Va(this.Pb.suggestions.SlideSuggestions)||this.Pb.suggestions.SlideSuggestions.length===t.L$)&&this.oHa(t.correlationId,Lj.a.success,this.Pb.suggestions,t.trigger):this.oHa(t.correlationId,Lj.a.success,this.Pb.suggestions,t.trigger)}Ibl(t,N){return N.isVisible||t!==zc.kHa&&t!==zc.JNd&&t!==zc.Ypb}Vjd(t,N){this.m8b=t;this.Zge=N;this.Lc.mz(new Lf.a(1))}y3g(){this.Xq.Hp.isVisible&&3===this.Xq.Hp.X$&&(this.dKg.add(this.Pb.correlationId),
this.Xq.MYa(1))}lAl(t){return this.dKg.contains(t)}oHa(t,N,ha=null,za=""){K.a.J(512496479,829,50,"DesignerManager:NotifySuggestionsReadyForIdeas - CorrelationId:{0}, Status:{1}, Trigger:{2}",t,N,za);this.wUa.execute(Ra=>{const qb=this.Lwi(t,ha);gb.a.Va(za)||(qb.trigger=za);Ra.notifySlideSuggestion(N,qb)})}Lwi(t,N){const ha=new Am;ha.correlationId=t;if(!N)return K.a.J(512496478,829,50,"DesignerManager:ParseSlideSuggestionNotificationData - no suggestions to parse. CorrelationId:{0}",t),ha;ha.suggestions=
this.Yq.Pvk(N);return ha}Lqk(t){t=new En(this.Pb.suggestions,t.suggestions.length,t.suggestions.length,t.correlationId,this.Xq.Xia(),!0,this.Xq.yra(),this.Yq.MRc(t.trigger));this.Yq.IGe(t);this.Fa.Gj(kd.a.o7,!0)}juk(){return 4===this.Xq.Hp.X$}guk(){return 1===this.Xq.Hp.X$}}Object(h.a)(lk,"DesignerManager",null,[685,106]);class Je{constructor(t,N){this.ccb=this.oo=null;this.W$j=N;this.De=t;this.hr=!1}get zh(){return this.hr}setup(){this.zh||(this.ccb=kb.a.Ce(),this.ccb.setAttribute("Unselectable",
"on"),this.ccb.style.position=ab.a.absolute,this.De.addCssClass(this.ccb,"designerPreviewImageContainer"),this.oo=new Pb.a,this.hr=!0)}dispose(){this.zh&&(this.dismiss(),this.oo&&this.oo.xa.parentNode&&(this.oo.qq(),this.De.removeCssClass(this.oo.xa,"designerPreviewImageContainer")))}dismiss(){this.zh?(this.Oma(),this.oo.setVisibility(!1)):K.a.J(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")}nna(t){if(this.zh){this.ccb&&(this.ccb.appendChild(this.oo.xa),this.De.addCssClass(this.oo.xa,
"designerPreviewImageContainer"),this.oo.setVisibility(!1));var N=this.W$j.Gc;if(t=this.bia(t))this.Oma(),N.umc.appendChild(this.ccb),this.oo.xa.appendChild(t),this.oo.setVisibility(!0);this.oo.gh(N.mB.clientWidth,N.mB.clientHeight)}else K.a.J(38099037,829,15,"DesignerPreviewImageView::SetImage - called before setup")}bia(t){if(!gb.a.Va(t)){const N=kb.a.SB();N.setAttribute("Unselectable","on");N.src=t;N.style.height="100%";N.style.width="100%";return N}return null}Oma(){this.oo.xa.firstChild&&this.oo.xa.removeChild(this.oo.xa.firstChild)}}
Object(h.a)(Je,"DesignerPreviewImageView",null,[686]);var yl=d(157);class oo{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id){this.zL=null;this.aHa=0;this.ia=t;this.Fb=N;this.nb=ha;this.ua=za;this.Mb=Ra;this.la=qb;this.pi=Qb;this.mj=vc;this.Xb=Zc;this.P8=Wc;this.yb=Md;this.Md=Id;this.rla=xl.ready}ub(){this.ia.pa(vb.a.fixIt,pb.a.application,Object(r.a)(this,this.Mnj,"handleFixIt"),4);this.ia.pa(vb.a.q$g,pb.a.application,Object(r.a)(this,this.cqj,"handleQueryFixIt"),96);this.ia.pa(vb.a.Job,pb.a.application,
Object(r.a)(this,this.Job,"applyFixItSuggestion"),4);this.ia.pa(vb.a.LXa,pb.a.application,Object(r.a)(this,this.LXa,"reportFixItSessionInfo"),64);this.P8.bUb(Object(r.a)(this,this.lea,"onBlockingStateChanged"))}dispose(){this.P8.Led(Object(r.a)(this,this.lea,"onBlockingStateChanged"))}Mnj(t,N,ha){N=this.nb.Yd();if(2>N.length)return 8;if(1===ha)return 32;ha=this.ua.presentation;this.la.designerBlockApplyUntilDraw?this.Xb.sqa(ha,this.ua.Ba,this.Mb.Ma,t):this.Xb.Jw(ha,t);this.mj.oTc=!0;const za=[];N.forEach(Ra=>
{Array.add(za,Ra.get_shapeId())});t={};t.SelectedShapeIds=za.join(",");this.mj.fhb=za;this.f5d(t);this.mj.uib=window.setTimeout(()=>{this.Nnj(this.mj.correlationId)},this.la.j6f);return 32}Nnj(t){this.mj.VSa=!0;K.a.J(573961115,829,15,"FixItActor::HandleFixItTimeout, CorrelationId: {0}",t);this.ia.La(vb.a.LXa,2,Eg.a.Fkd);this.Md.gra(M.a.Qh(170),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}f5d(t=null,N=null){this.DPi(ha=>{if(this.la.designerRequestThrottlingEnabled){if(this.rla.Gyg&&
+new Date-+this.rla.GBg<this.la.designerRequestThrottleIntervalMs){this.zL=new Do;this.zL.sid=ha.sid;this.zL.cid=ha.cid;this.zL.mRc=ha.cQ;return}this.rla=xl.inProgress;this.zL=null}const za=()=>{this.f5d(this.zL.mRc,N)};this.pi.Fia(ha.cid,ha.sid,ha.correlationId,null,ca.a.fixIt,N,Kf.c(ha.cQ),Ra=>{Ra&&Ra.Status===ca.a.yhh?this.Gfd(()=>{this.f5d(ha.cQ,N)}):this.aHa=0;this.aHa||this.L2b(za)},Ra=>this.feb(Ra,za))},t)}Gfd(t){this.aHa<this.la.designerMaxRetryOnWait?this.yb.Cb(new aa.a(2,1,1E3,()=>{K.a.J(578937822,
829,50,"retry request due to waiting on pending edits. prior correlation: {0}",this.mj.correlationId);this.rla=xl.ready;this.aHa++;t()},void 0,"RetryRequestOnWait")):K.a.J(578937820,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",this.mj.correlationId)}Job(t,N,ha,za,Ra){N=this.ua.presentation;if(!this.ua.Ba||!N)return 16;za=null;Object(Fi.a)(An,Ra)&&(za=Ra);if(!za)return 8;if(1===ha)return 32;ha=this.Fb.ke(15);try{this.la.designerSendAppliedSuggestionHistoryEnabled&&
(this.mj.RNa=new Date),ha.kc(N),ha.fd=t,N.DBa=za,this.mj.fZ=O.a.tE(za.SuggestionSid,za.SuggestionCid),this.mj.XS=!0,K.a.J(578937818,829,50,"FixItActor::ApplyFixitSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",za.CorrelationId,t,za.SuggestionSid)}finally{ha&&ha.dispose()}return 32}DPi(t,N=null){const ha=this.ua.Ba;ha&&ha.sid&&(N=Object.assign(new Bn,{sid:ha.sid,cid:ha.cid,cQ:N||{}}),K.a.J(578937816,829,50,"FixIt; sid: {0}; correlationId: {1}",N.sid,N.correlationId),this.mj.correlationId&&
this.SGb(Eg.a.Wfb),this.mj.pZa=new Date,this.mj.correlationId=N.correlationId,this.mj.EP=new Date,t(N))}L2b(t){this.la.designerRequestThrottlingEnabled&&(this.rla=xl.ready,this.zL&&t())}feb(t,N){this.L2b(N);K.a.J(578937814,829,15,"FixItActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",t.HttpStatusCode);return!0}cqj(t,N,ha,za,Ra){this.tql();if(!Object(Fi.a)(ym.a,Ra))return 8;if(1<this.nb.Pgd()){let qb;(qb=this.mj).vpb=qb.vpb+1;return 32}return 8}LXa(t,N,ha,za,
Ra){if(Ra===Eg.a.noSuggestion||Ra===Eg.a.Fkd)this.la.designerBlockApplyUntilDraw?this.Xb.Moc(yl.e(this.ua.Ba,this.Mb.Ma)):this.Xb.GJ(this.ua.presentation);this.SGb(Ra);return 32}lea(t,N){if(this.mj.oTc){t=this.Xb.Zc(this.ua.presentation);const ha=this.la.designerBlockApplyUntilDraw?"UnblockContentWhenDraw":"SessionRehydrated";t||Object(Q.a)(String,N.actionName)!==ha||(window.clearTimeout(this.mj.uib),this.mj.VSa||(this.mj.oZa=new Date),this.mj.RNa=null,this.mj.oTc=!1)}}SGb(t){const N=this.mj.correlationId;
if(gb.a.Va(N))K.a.J(578937812,829,50,"FixItActor::SendTraceRequest - skipped for empty correlation. ResetReason:{0}",t);else{var ha={};this.mj.fZ&&(ha.SuggestionSlideId=this.mj.fZ.sid.toString(),ha.SuggestionSlideCreationId=this.mj.fZ.cid.toString());ha.AppliedSuggestion=this.mj.XS;ha.DisplaySuggestionsTimeoutInMs=this.la.j6f;ha.SuggestionsTimeout=this.mj.VSa;ha.ClientAbort=this.mj.Lvb;ha.ResetReason=t;ha.DesignerSendTraceRequestOnSessionEnded=this.la.vTd;var za=Ed.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()),
Ra={};Ra.ClientOS=za.Os;Ra.Browser=za.Browser||"";Ra.BrowserVersion=za.BrowserVersion||"";Ra.BrowserMajorVersion=za.BrowserMajorVersion||"";Ra.BrowserMinorVersion=za.BrowserMinorVersion||"";this.mj.pZa&&this.mj.aJb&&this.mj.aJb>this.mj.pZa&&(Ra.SuggestionsE2ETimeMs=+this.mj.aJb-+this.mj.pZa);this.mj.pZa&&this.mj.oZa&&this.mj.oZa>this.mj.pZa&&(Ra.SuggestionAppliedE2ETimeMs=+this.mj.oZa-+this.mj.pZa);ha.BrowserData=Ra;this.mj.EP&&this.mj.oZa&&this.mj.oZa>this.mj.EP&&(ha.TimeToDisplaySuggestionsInMs=
+this.mj.oZa-+this.mj.EP);this.mj.oSe&&(ha.TimeSuggestionsRendered=this.mj.oSe.toUTCString());this.pi.Xma(N,Kf.c(ha),t===Eg.a.fhd);this.mj.wHe();K.a.J(578937810,829,50,"FixItActor::SendTraceRequest - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",t,N)}}tql(){try{const t=u.a.instance.Ka("Common.ISystemInitiatedFeedback");t&&t.execute(N=>{N.logActivity("AutoFixInViewportActivity",null)})}catch(t){K.a.J(573649484,829,10,"Exception thrown while triggering AutoFixInViewportActivity. Exception: {0}",
t)}}a$(){}Z9(){}}Object(h.a)(oo,"FixItActor",null,[147]);class jl{constructor(){this.vpb=0;this.correlationId=this.fhb=null;this.uib=0;this.Lvb=this.oTc=this.XS=this.VSa=!1;this.suggestion=this.EP=this.oZa=this.RNa=this.aJb=this.pZa=this.oSe=null;this.fZ=O.a.empty}wHe(){this.vpb=0;this.correlationId=this.fhb=null;this.fZ=O.a.empty;this.uib=0;this.Lvb=this.oTc=this.XS=this.VSa=!1;this.EP=this.oZa=this.RNa=this.aJb=this.pZa=this.oSe=null}}Object(h.a)(jl,"FixItContext",null,[690]);var xi=d(933),ah=d(944),
aj=d(835),cm=d(900);class Fn{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc){this.ia=t;this.ua=N;this.Fb=ha;this.Lc=za;this.mj=Ra;this.Ig=qb;this.WBb=Qb;this.FI=vc;this.Mc=Zc;this.Md=Wc;this.ow()}ow(){this.WBb.aUb(Object(r.a)(this,this.iH,"onEvent"));this.Ig.UH(Object(r.a)(this,this.iH,"onEvent"));this.Mc.LNa(Object(r.a)(this,this.iH,"onEvent"));this.Mc.JB(Object(r.a)(this,this.iH,"onEvent"));this.Lc.r6h(Object(r.a)(this,this.W2g,"onSuggestionReceived"));this.Lc.DBc(Object(r.a)(this,this.rma,"onUndoRedo"))}dispose(){this.Lc.RRk(Object(r.a)(this,
this.W2g,"onSuggestionReceived"));this.Lc.Qed(Object(r.a)(this,this.rma,"onUndoRedo"))}W2g(t,N){if(t=this.ua.Ba)if(N.slideId.equals(t.Bb))if(this.mj.correlationId!==N.correlationId)K.a.J(578937806,829,50,"FixItManager::OnSuggestionReceived - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.mj.correlationId,N.correlationId);else if(t=Fn.pTd(N.JBa),t.SlideSuggestion)this.mj.aJb||(this.mj.aJb=new Date),N=Object.assign(new An,{SuggestionCid:t.SlideSuggestion.SlideId.Cid,
SuggestionSid:t.SlideSuggestion.SlideId.Sid,CorrelationId:N.correlationId,ActiveSlideCid:Object(Q.a)(120,this.ua.Ba).cid,ActiveSlideSid:Object(Q.a)(120,this.ua.Ba).sid}),this.ia.La(vb.a.Job,2,N);else switch(this.ia.La(vb.a.LXa,2,Eg.a.noSuggestion),t.ResponseDescription){case "Invalid request":this.Md.gra(M.a.Qh(122),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItInvalidRequest);break;case "No suggestion":this.Md.gra(M.a.Qh(132),0,ResourceStrings.errorTitle_PowerpointEditingStandard,
ResourceStrings.errorMessage_FixItNoSuggestion);break;default:this.Md.gra(M.a.Qh(134),0,ResourceStrings.errorTitle_PowerpointEditingStandard,ResourceStrings.errorMessage_FixItTryAgain)}else K.a.J(578937808,829,50,"FixItManager::OnSuggestionReceived - current slide node is different to suggestion slide node. CorrelationId:{0}",N.correlationId)}YP(t){this.mj.correlationId&&t!==vb.a.Job&&this.ia.La(vb.a.LXa,2,Eg.a.hLb+this.FI.c5(t))}O2b(t,N,ha){if(this.mj.correlationId&&ha&&N===vb.a.Job){this.mj.fZ=
O.a.empty;ha=this.ua.presentation;const za=this.Fb.ud(7,void 0,void 0,void 0,!0);try{za.kc(ha),za.fd=N,ha.removeProperty(Vb.a.DBa)}finally{za&&za.dispose()}this.ia.La(vb.a.LXa,2,Eg.a.hLb+this.FI.c5(t))}}rma(t,N){this.O2b(N.actionId,N.AUe,N.L9a)}iH(t,N){t=!1;let ha="";if(Object(Fi.a)(xi.a,N)){K.a.J(578937802,829,50,"FixItManager::OnSessionEnding. Correlation={0}, Reason={1}",this.mj.correlationId,Eo.a[Object(Q.a)(xi.a,N).vJ]);if(1===Object(Q.a)(xi.a,N).vJ||3===Object(Q.a)(xi.a,N).vJ)t=!0;ha=Eg.a.fhd}else Object(Fi.a)(ah.a,
N)?(K.a.J(578937800,829,50,"FixItManager::OnSessionRehydrated"),t=!0,ha=Eg.a.TOk):Object(Fi.a)(aj.a,N)?(t=!0,ha=Eg.a.slideNavigation):Object(Fi.a)(cm.a,N)&&Object(Q.a)(cm.a,N).hwb&&this.YP(Object(Q.a)(cm.a,N).actionId);t&&this.mj.correlationId&&this.ia.La(vb.a.LXa,2,ha);this.UZj()}UZj(){0<this.mj.vpb&&(K.a.J(574166159,829,50,"FixItActor::HandleQueryFixIt - FixIt button is enabled: {0}",this.mj.vpb),this.mj.vpb=0)}static pTd(t){let N=null;try{N=Ed.a(t)}catch(ha){K.a.J(578937804,829,10,"FixItManager::DeserializeSuggestionResponse - parsing suggestionResults failed")}return N}}
Object(h.a)(Fn,"FixItManager",null,[689,106]);var yi=d(996),Bm=d(15),Un;(function(t){t[t.seen=0]="seen";t[t.keep=1]="keep";t[t.drillIn=2]="drillIn"})(Un||(Un={}));Object(h.b)("IdeasCardAction",Un);var Gn;(function(t){t[t.designer=0]="designer";t[t.makeItVisual=1]="makeItVisual";t[t.editor=2]="editor";t[t.UNKNOWN=3]="UNKNOWN"})(Gn||(Gn={}));Object(h.b)("IdeasCardType",Gn);class mm{constructor(t,N){this.Fta=null;this.Tac=!1;this.ia=t;this.la=N;this.ia.ya(vb.a.ideasPaneOpened,pb.a.application,Object(r.a)(this,
this.coj,"handleIdeasPaneOpen"));this.ia.ya(vb.a.f7d,pb.a.application,Object(r.a)(this,this.boj,"handleIdeasPaneClose"));this.ia.ya(vb.a.cng,pb.a.application,Object(r.a)(this,this.Ijg,"handleIdeasKeep"));this.ia.ya(vb.a.dng,pb.a.application,Object(r.a)(this,this.j5d,"handleIdeasSee"));this.ia.ya(vb.a.ing,pb.a.application,Object(r.a)(this,this.j5d,"handleIdeasSee"));this.ia.ya(vb.a.jng,pb.a.application,Object(r.a)(this,this.i5d,"handleIdeasDrillIn"));this.ia.ya(vb.a.gng,pb.a.application,Object(r.a)(this,
this.Ijg,"handleIdeasKeep"));this.ia.ya(vb.a.hng,pb.a.application,Object(r.a)(this,this.j5d,"handleIdeasSee"));this.ia.ya(vb.a.eng,pb.a.application,Object(r.a)(this,this.i5d,"handleIdeasDrillIn"));this.ia.ya(vb.a.fng,pb.a.application,Object(r.a)(this,this.i5d,"handleIdeasDrillIn"))}coj(){if(!this.la.pptIdeasContextEnabled)return 2;this.Tac=!0;this.xGj()||this.Til(Be.a.create());return 32}boj(){if(!this.la.pptIdeasContextEnabled)return 2;this.Tac=!1;return 32}Ijg(t){if(!this.la.pptIdeasContextEnabled)return 2;
this.Kpl(this.BTd(t));return 32}j5d(t){if(!this.la.pptIdeasContextEnabled)return 2;this.tmd(this.BTd(t));return 32}i5d(t){if(!this.la.pptIdeasContextEnabled)return 2;this.Ipl(this.BTd(t));return 32}BTd(t){switch(t){case vb.a.cng:case vb.a.dng:case vb.a.eng:t=0;break;case vb.a.ing:case vb.a.jng:t=1;break;case vb.a.gng:case vb.a.hng:case vb.a.fng:t=2;break;default:t=3}return t}Til(){this.la.pptIdeasContextEnabled&&(this.Fta=new yi.a)}tmd(t){this.la.pptIdeasContextEnabled&&this.Tac&&3!==t&&this.Fta&&
!this.Fta.any(N=>N.key===t)&&this.Fta.add(new Bm.a(t,0))}Kpl(t){this.Tac&&3!==t&&this.Fta&&this.Fta.add(new Bm.a(t,1))}Ipl(t){this.Tac&&3!==t&&this.Fta&&this.Fta.add(new Bm.a(t,2))}xGj(){return!!this.Fta&&0<this.Fta.length}}Object(h.a)(mm,"IdeasContext",null,[688]);class Hn{constructor(){this.gz=this.fz=null;this.KD=this.Rx=0}}Object(h.a)(Hn,"ImageLocationInfo",null,[]);var vk=d(428);class po{}Object(h.a)(po,"ImageToTableRequest",null,[]);class dm{}dm.Ing="ImageToTableTile";dm.Gng="ImageToTable.Request";
dm.Hng="ImageToTable.Response";Object(h.a)(dm,"ImateToTableAugmentationSchemaNames",null,[]);class Go{constructor(){this.O_=this.j_=null}get WF(){return"ImageToTableALWorkflow"}get proto(){return""}get bpb(){this.j_||(this.j_=Object.assign(new vk.a,{name:"LambdaBefore_ImageToTableAL",inputSchema:dm.Ing,outputSchema:dm.Gng,func:Object(r.a)(this,this.T9a,"lambdaBeforeFunc")}));return this.j_}get rob(){return null}get FFb(){this.O_||(this.O_=Object.assign(new vk.a,{name:"LambdaRemote_ImageToTableAL",
inputSchema:dm.Gng,outputSchema:dm.Hng,func:null}));return this.O_}T9a(t,N,ha){t=Object.assign(new po,{image:t.image});ha(t)}}Object(h.a)(Go,"ImageToTableALWorkflow",null,[708]);class si{constructor(){this.html=this.processId=this.errorDescription=null;this.errorCode=this.shapeId=this.slideId=0}}Object(h.a)(si,"ImageToTableALv2ResponseWrapper",null,[]);class qo{constructor(){this.sessionId=null;this.shapeId=this.slideSid=0;this.image=this.j7b=null}}Object(h.a)(qo,"ImageToTableTile",null,[]);class nm{constructor(t,
N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md){this.ia=t;this.nb=N;this.Xb=ha;this.Hk=za;this.Sz=Ra;this.Qb=Qb;this.Dm=vc;this.dge=Zc;this.Jka=Wc;this.la=Md}initialize(){this.ia.ya(vb.a.dBe,pb.a.application,Object(r.a)(this,this.njg,"handleConvertImageToTable"));this.ia.ya(vb.a.jBe,pb.a.application,Object(r.a)(this,this.qkg,"handleReplaceImageWithHtmlTable"));this.Hk.UH(Object(r.a)(this,this.dB,"onActiveSlideChanged"));this.dge.execute(t=>{const N=new Go;t.registerSimpleRemoteWorkflow(N.WF,N.bpb,N.FFb,N.rob);t.addEventHandler(dm.Hng,
Object(r.a)(this,this.foj,"handleImageToTableALResults"));t.Pnb("AugLoop_ImageToTable_DetectedHtmlTableAnnotation");t.cjc("AugLoop_ImageToTable_DetectedHtmlTableAnnotation",Object(r.a)(this,this.pRa,"handleAnnotationEvent"))})}dispose(){this.ia.uO(vb.a.dBe,pb.a.application,Object(r.a)(this,this.njg,"handleConvertImageToTable"));this.ia.uO(vb.a.jBe,pb.a.application,Object(r.a)(this,this.qkg,"handleReplaceImageWithHtmlTable"));this.Hk.Y4(Object(r.a)(this,this.dB,"onActiveSlideChanged"))}dB(){this.Jka.close()}njg(t,
N,ha){if(!this.la.pptSuggestedActionImageToTableEnabled)return 16;if(1===ha)return 32;t=this.nb.Yd();if(1!==t.length)return 8;const za=this.Jka.ysk();if(!za)return K.a.J(512496449,829,15,"[ImageToTableActor::HandleConvertImageToTable] Failed to open the taskpane"),8;const Ra=t[0];this.la.f8g&&(this.Jka.w3k(za,Ra.slideSid,Ra.get_shapeId(),nm.lRd(Ra)),this.Jka.NZg(za));this.dge.execute(qb=>{qb.Czl(Ra.slideCid,Ra.slideSid,Ra.get_shapeId(),Qb=>{this.Jjg(za,Ra,Qb)},()=>{this.Jjg(za,Ra,null);return!0})});
return 32}pRa(t){if(t&&"errorDescription"in t&&"parentPath"in t&&"errorCode"in t){var N=new si,ha=t.errorDescription.split(";");N.errorDescription=ha[0].split(":")[1];N.processId=ha[1].split(":")[1];N.errorCode=t.errorCode;K.a.J(512496448,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",N.processId,N.errorCode,N.errorDescription);ha=t.parentPath[1].split("|");N.slideId=Number.parseInvariant(ha[0]);N.shapeId=Number.parseInvariant(ha[2]);N.html=t.html;
this.Jka.u3k(N);this.Jka.MZg()}}Jjg(t,N,ha){if(ha&&ha.ImgData)if(this.la.f8g)this.Jka.v3k(t,ha.ImgData),this.Jka.MZg();else{const za=nm.lRd(N),Ra=Object.assign(new qo,{sessionId:t,slideSid:N.slideSid,shapeId:N.get_shapeId(),j7b:za,image:ha.ImgData});this.dge.execute(qb=>{qb.submit(dm.Ing,Ra)});this.Jka.NZg(t)}else this.Jka.fnk(t)}foj(t,N,ha,za){K.a.J(512496419,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",za.processId,za.errorCode,za.errorDescription);
this.Jka.alk(N,za)}qkg(t,N,ha,za,Ra){t=this.Qb.VCa(Ra.slideSid);if(!t)return 8;ha=(N=t.DS(Ra.shapeId))?nm.lRd(N):Ra.j7b;if(!ha)return 8;K.a.J(512496418,829,50,"Replacing image with html table. Shape id: {0}",N.get_shapeId());Ra=this.Dm.vRd(!1,t.cid,t.sid,!1,ha.fz,ha.gz,ha.Rx,ha.KD,t.ev()+1,Ra.jxh,"");this.Sz.B2([Ra],t,0,null,N);this.Xb.Jw(t,"ImageToTable");return 32}static lRd(t){return Object.assign(new Hn,{fz:t.fz,gz:t.gz,Rx:t.Rx,KD:t.KD})}}Object(h.a)(nm,"ImageToTableActor",null,[]);class wc{constructor(t){this.shapeId=
this.slideId=0;this.r7d=null;this.VWe=0;this.p6d=!1;this.xfc=null;this.PUc=!1;this.HRc=this.v7d=this.AYg=this.X3g=null;this.sessionId=t}}Object(h.a)(wc,"ImageToTableConversionContext",null,[]);class Ql{constructor(){this.shapeId=this.slideSid=0;this.jxh=this.j7b=null}}Object(h.a)(Ql,"ReplaceImageWithHtmlTableData",null,[]);class Ho{constructor(t,N,ha,za){this.ia=t;this.Zd=N;this.Ha=ha;this.Poe=za;this.U8=null}initialize(){this.Zd.execute(t=>{t.GId(Object(r.a)(this,this.M_g,"onFirstPartyAddInHidden"))});
this.Poe.xId(Object(r.a)(this,this.Sjg,"handleMessage"))}dispose(){this.Zd.execute(t=>{t.QRk(Object(r.a)(this,this.M_g,"onFirstPartyAddInHidden"))});this.Poe.afh(Object(r.a)(this,this.Sjg,"handleMessage"))}ysk(){this.close();const t=new wc(Be.a.create().toString());t.X3g=new Promise(ha=>{t.AYg=()=>{ha(t.sessionId)}});const N={};N.CU=ResourceStrings.L_DataFromPicturePaneTitle;N.assetId="FA000000050";N.Tva=()=>{this.fye(t)};N.nonPersistedSettings={["SessionID"]:t.sessionId};N.npc=!0;N.sourceLocationOverrideResourceId=
this.Ha.pptImageToTableSourceLocationId;return 32===this.ia.La(vb.a.nJa,2,N)?(this.U8=t,this.U8.sessionId):this.U8=null}close(){this.TOd(this.U8)}fye(t){K.a.J(593867348,375,50,"[ImageToTablePane] Taskpane rendered. SessionId = {0}",t.sessionId);const N=this.Zd.instance.DZ("FA000000050");if(N&&N.settings&&"SessionID"in N.settings){var ha;({ou:ha}=Ed.d(N.settings.SessionID)).returnValue&&(t.sessionId===ha?(t.xfc=N.instanceId,K.a.J(593867346,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",
N.instanceId)):K.a.J(593867344,375,50,"[ImageToTablePane] Failed to find the taskpane"))}}TOd(t){t&&t.xfc&&(t.PUc=!0,this.ia.La(vb.a.ZEc,2,t.xfc))}w3k(t,N,ha,za){if(t=this.dtb(t))t.slideId=N,t.shapeId=ha,t.r7d=za}u3k(t){const N=this.U8;N&&N.slideId===t.slideId&&N.shapeId===t.shapeId&&(this.U8.HRc=t)}v3k(t,N){if(t=this.dtb(t))t.v7d=N}NZg(t){const N=this.dtb(t);N&&(N.VWe=window.setTimeout(()=>{this.Qmj(N)},this.Ha.pptImageToTableALWorkflowTimeoutMs))}alk(t,N){if(t&&N){var ha=this.dtb(t.sessionId);if(ha&&
!ha.p6d)if(ha.slideId=t.slideSid,ha.shapeId=t.shapeId,ha.r7d=t.j7b,window.clearTimeout(ha.VWe),0===N.errorCode){const za={};za.tableHtml=N.html;za.imageData=t.image;this.sendMessage(ha.sessionId,za)}else this.Wgd(t.sessionId,"Failed to convert image to table")}}MZg(){const t=this.U8;if(t&&!t.p6d&&t.HRc&&t.v7d)if(window.clearTimeout(t.VWe),0===t.HRc.errorCode){const N={};N.tableHtml=t.HRc.html;N.imageData=t.v7d;this.sendMessage(t.sessionId,N)}else this.Wgd(t.sessionId,"Failed to convert image to table")}fnk(t){this.Wgd(t,
"Failed to render the image shape")}Qmj(t){t.p6d=!0;this.Wgd(t.sessionId,"Failed to convert image to table using AL")}Sjg(t,N){N=N.message;(t=this.dtb(N.session_id))&&!t.PUc&&("ACK"===N.cmd_type?(K.a.J(593867342,375,50,"[ImageToTablePane::MessageReceivedHandler] ACK message received.",N.cmd_type),t.AYg()):"cancel"===N.cmd_type?(K.a.J(593867340,375,50,"[ImageToTablePane::MessageReceivedHandler] Cancel message received.",N.cmd_type),this.TOd(t)):"insert_html"===N.cmd_type?(K.a.J(593867338,375,50,"[ImageToTablePane::MessageReceivedHandler] Insert message received.",
N.cmd_type),N=Object.assign(new Ql,{slideSid:t.slideId,shapeId:t.shapeId,j7b:t.r7d,jxh:N.parameters}),this.TOd(t),this.ia.La(vb.a.jBe,2,N)):K.a.J(593867336,375,15,"[ImageToTablePane::MessageReceivedHandler] Unknown message received. Message type: {0}",N.cmd_type))}Wgd(t,N){this.sendMessage(t,{["errorMessage"]:N})}sendMessage(t,N){const ha=this.dtb(t);ha&&ha.sessionId===t&&ha.X3g.then(()=>{this.Poe.sendMessage(ha.xfc,N)})}dtb(t){return t&&this.U8&&this.U8.sessionId===t?this.U8:null}M_g(t,N){N&&this.U8&&
N.instanceId===this.U8.xfc&&(this.U8=null)}}Object(h.a)(Ho,"ImageToTablePane",null,[692]);class Yj extends Sys.EventArgs{constructor(t){super();this.message=t}}Object(h.a)(Yj,"ImageToTablePaneMessageReceivedArgs",Sys.EventArgs,[]);class Tk{constructor(t){this.va=new Qk.a;this.Ha=t}xId(t){this.va.addHandler("ImageToDocPaneMessageReceived",t)}afh(t){this.va.removeHandler("ImageToDocPaneMessageReceived",t)}initialize(){try{window.addEventListener?window.addEventListener("message",Object(r.a)(this,this.Adc,
"messageReceivedHandler"),!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",Object(r.a)(this,this.Adc,"messageReceivedHandler")):K.a.J(593867334,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window")}catch(t){K.a.J(593867332,375,10,"[ImageToTablePane::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",t.message,t.stack)}}sendMessage(t,N){const ha={["imageToTablePaneWildcard"]:"."};
for(const za of Object.keys(N))ha[za]=N[za];OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(t,"onCustomMessage",ha,za=>{za&&K.a.J(593867330,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",za)})}Adc(t){if(t&&this.w5b(t.origin)){var N;({ou:N}=Ed.d(t.data)).returnValue&&N&&(t=Object(Q.a)(Object,N),"."===t.imageToTablePaneWildcard&&this.va.raiseEvent("ImageToDocPaneMessageReceived",new Yj(t)))}}w5b(t){return t&&t.length&&"null"!==t?t===this.Ha.pptImageToTableAllowedOrigin:
!1}}Object(h.a)(Tk,"ImageToTablePaneMessenger",null,[691]);var Fe=d(1059);class Io{constructor(){this.Scenario=0;this.ShapeIds=null;this.SlideSid=this.SlideCid=0}}Object(h.a)(Io,"ImageTransformInfo",null,[]);class Mj{constructor(t,N,ha,za){this.ia=t;this.nb=N;this.ua=ha;this.Lc=za}initialize(){this.Lc.Z4h(Object(r.a)(this,this.V2g,"onSuggestedActionClick"))}dispose(){this.Lc.ZQk(Object(r.a)(this,this.V2g,"onSuggestedActionClick"))}V2g(t,N){if((t=N.card)&&this.ua.Ba){var ha=this.ua.Ba.jl(),za=[];N=
[];for(var Ra of ha)for(const qb of t.Selects)if(qb.Id===Ra.get_shapeId()){Array.add(za,Ra);Array.add(N,Ra.get_shapeId());break}this.nb.Cy();this.nb.Uh();this.nb.mYa(za,!0);if(4===t.Type){if(Ra=this.ua.presentation)Ra.Xub=Object.assign(new Io,{Scenario:t.Scenario,SlideSid:this.ua.Ba.sid,SlideCid:this.ua.Ba.cid,ShapeIds:N})}else this.ia.processAction(Fe.a.MDc(t.ExecutionActionName),2)}}}Object(h.a)(Mj,"SuggestedActionsHandler",null,[]);class sj{constructor(){this.K=null;this.aX=!1;this.NE=!!v.AFrameworkApplication.Aa&&
!!v.AFrameworkApplication.Aa.jb&&v.AFrameworkApplication.Aa.jb.tW}get name(){return"PowerPointWebEditor.Designer"}Wb(t){this.K=t;this.K.register(682,"PowerPointWebEditor.IDesignerView").ma().na(()=>new Pl(this.K.resolve("Box4.IHtmlViewRootFactory"),this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Box4.IViewManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("Common.IClickInputManager"),this.K.resolve("Common.IPointerInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IViewEventNotifier"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper")));this.K.register(683,"PowerPointWebEditor.IDesignerPane").ma().na(()=>new Km(this.K.resolve("Box4.IAppFrame"),
this.K.resolve("PowerPoint.IPathManager"),this.K.resolve("Common.IClickInputManager"),this.K.resolve("PowerPointWebEditor.IInputHandlerManager"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.K.resolve("PowerPointWebEditor.IFocusManager"),
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IInboundHelper"),this.K.resolve("PowerPointWebEditor.ITaskPaneManager")));this.K.register(684,"PowerPointWebEditor.IDesignerViewHelper").ma().na(()=>new Wd(this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("PowerPoint.IPathManager"),this.K.Ka("PowerPointWebEditor.AgendaConverter.IAgendaConverterView")));this.K.register(685,"PowerPointWebEditor.IDesignerManager").ma().na(()=>new lk(this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.Ka("PowerPointWebEditor.IDesignerServiceProvider"),this.K.Ka("PowerPointWebEditor.IApplyDesignerSuggestions"),this.K.Ka("Common.ISystemInitiatedFeedback")));this.K.register(686,"PowerPointWebEditor.Designer.IDesignerPreviewImageView").ma().na(()=>new Je(this.K.resolve("PowerPoint.IBrowserHelperManager"),this.K.resolve("PowerPointWebEditor.IActiveSlideViewManager")));
this.K.register(687,"PowerPointWebEditor.IDesignerContext").ma().na(()=>new en(this.K.Ka("PowerPointWebEditor.IDesignerServiceProvider")));this.K.register(688,"PowerPointWebEditor.Infrared.IIdeasContext").ma().na(()=>new mm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(689,"PowerPointWebEditor.IFixItManager").ma().na(()=>new Fn(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.IActionNameResolver"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler")));this.K.register(690,
"PowerPointWebEditor.IFixItContext").ma().na(()=>new jl);(this.aX=this.K.resolve("PowerPointWebEditor.IApplicationContext").ld.tg)&&this.K.register(hj.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>new hj.a(v.AFrameworkApplication.Ge,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),
this.K.resolve("Common.IAppSettingsManager")));this.K.register(nm,"PowerPointWebEditor.Designer.ImageToTableActor").ma().na(()=>new nm(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphTransactionHelper"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.IShapeEditor"),this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane"),this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(691,"PowerPointWebEditor.Designer.IImageToTablePaneMessenger").ma().na(()=>new Tk(this.K.resolve("PowerPointWebEditor.IApplicationSettings")));this.K.register(692,"PowerPointWebEditor.Designer.IImageToTablePane").ma().na(()=>
new Ho(this.K.resolve("Common.IActionManagerExtended"),this.K.Ka("PowerPointWebEditor.IAppForOfficeManager"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger")));this.K.register(Mj,"PowerPointWebEditor.Designer.SuggestedActionsHandler").ma().na(()=>new Mj(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IViewEventSource")))}init(){const t=this.K.resolve("Common.IAppSettingsManager");t.ff(()=>{if(t.ka("248")){this.aX&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");var N=this.K.resolve("PowerPointWebEditor.IDesignerView");const ha=u.a.instance.resolve("PowerPointWebEditor.IDesignerPane").xa;N.LAa(ha);N.S3b();this.NE||this.K.resolve("PowerPointWebEditor.IPaneManager").pP(this.K.resolve("PowerPointWebEditor.IDesignerPane"));N=null;if(t.ka("1034")&&(N=this.K.resolve("Common.App.OAuth.IOAuthManager"))){const za=
new Date;N.KU(t.Ga("1043"),t.Ga("1035")).then(Ra=>{const qb=+new Date-+za;Ra.IsSuccess?K.a.J(512262863,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+qb):(K.a.J(512262862,829,15,"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+Ra.ErrorCode+": "+Ra.ErrorMessage),K.a.J(512262861,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+qb))}).catch(Ra=>{K.a.J(512262860,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+
(+new Date-+za));K.a.J(512262859,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",Ra)})}N=new Sh(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Box4.IClipboardDataHelper"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.Graph.IPptGraphTransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.IFocusManager"),this.K.resolve("PowerPointWebEditor.IDesignerPane"),
this.K.resolve("PowerPointWebEditor.IDesignerView"),this.K.resolve("PowerPointWebEditor.IDesignerViewHelper"),this.K.resolve("PowerPointWebEditor.IDesignerManager"),this.K.resolve("PowerPointWebEditor.IDesignerContext"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IViewEventSource"),this.K.resolve("PowerPointWebEditor.CoreExt.ICoauthEventHandler"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerpointPresence.IPresenceEventHandlers"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),this.K.resolve("PowerPointWebEditor.Infrared.IIdeasContext"),this.K.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),
this.K.Ka("PowerPointWebEditor.Editor.Common.Model.IEditorRuntimeEventSource"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),N,this.K.Ka("PowerPointWebEditor.IAgendaMetrics"),this.K.Ka("PowerPointWebEditor.AgendaConverter.IAgendaConverterView"));N.ub();N.xe();(new oo(this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("Common.Transaction.ITransactionFactory"),this.K.resolve("PowerPointWebEditor.IPptSelectionManager"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
this.K.resolve("PowerPointWebEditor.View.IPPTPageView"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),this.K.resolve("PowerPointWebEditor.IFixItContext"),this.K.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),this.K.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),this.K.resolve("Common.ITaskManager"),this.K.resolve("PowerPointWebEditor.IErrorHandler"))).ub();this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").setup();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePaneMessenger").initialize();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").initialize();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").initialize();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").initialize();this.K.resolve("PowerPointWebEditor.IFixItManager")}else K.a.J(512262858,829,50,"Designer setting is disabled")})}dispose(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").designerHoverPreviewEnabled&&
this.K.resolve("PowerPointWebEditor.Designer.IDesignerPreviewImageView").dispose();this.K.resolve("PowerPointWebEditor.Designer.IImageToTablePane").dispose();this.K.resolve("PowerPointWebEditor.Designer.ImageToTableActor").dispose();this.K.resolve("PowerPointWebEditor.Designer.SuggestedActionsHandler").dispose();this.K.resolve("PowerPointWebEditor.IFixItManager").dispose()}static main(){e.a.instance.Bc(hc.a(new sj,0))}}Object(h.a)(sj,"PPTWebEditorDesignerPackage",null,[2,3]);class Vn{constructor(){this.K=
null}get name(){return"PowerPointWebEditor.PenMinutes"}Wb(t){this.K=t}init(){const t=this.K.qb("Common.App.PenMinutesManager.IPenMinutesManager");t&&t.d6k()}dispose(){}static main(){e.a.instance.Bc(new Vn)}}Object(h.a)(Vn,"PPTWebEditorPenMinutesPackage",null,[2,3]);var ip=d(902);class zl{}Object(h.a)(zl,"TextToSmartArtSuggestionData",null,[]);class Si{constructor(){this.suggestions=[]}}Object(h.a)(Si,"TextToSmartArtSuggestionNotificationData",null,[]);class Qg{}Qg.wMe="ShapePresence";Qg.slideNavigation=
"SlideNavigation";Qg.hLb="WebActionId:";Qg.mU="SelectionChanged";Qg.Glc="ShapePositionChanged";Qg.Wfb="Retrigger";Qg.zve="NoSuggestions";Qg.U_j="LowSuggestions";Qg.O7c="NewSession";Qg.Ggl="SlideShowStarted";Qg.serverError="ServerError";Qg.oQf="ClientSuggestionTimeOut";Object(h.a)(Qg,"ReplaceObjectResetReason",null,[]);class om{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of,ih,Aj,$f,Oi,wk){this.MUa=this.Tle=this.Bab=!1;this.ra=t;this.Fa=N;this.ua=ha;this.Xb=za;this.P8=Ra;this.Ig=qb;this.ia=Qb;
this.Yy=vc;this.qGa=Zc;this.Zy=Wc;this.WBb=Id;this.ila=Xe;this.M3c=of;this.Lc=ih;this.FI=Aj;this.yb=$f;this.Ob=Oi;this.Vt=Md;this.wUa=wk;this.hr=!1}get zh(){return this.hr}setup(){this.zh||(this.ow(),this.Tle=2===this.Ob.mode,this.hr=!0)}ow(){this.ra.VH(Object(r.a)(this,this.kH,"onSelectionChanged"));this.WBb.aUb(Object(r.a)(this,this.Rte,"markedUndo"));this.Ig.UH(Object(r.a)(this,this.dB,"onActiveSlideChanged"));this.ila.B3a(Object(r.a)(this,this.f0,"onSlidePresenceChanged"));this.Lc.N6h(Object(r.a)(this,
this.uye,"onReplaceObjectResponse"));this.qGa.O6h(Object(r.a)(this,this.vye,"onReplaceObjectViewDragEnd"));this.P8.bUb(Object(r.a)(this,this.rwe,"onApplyReplaceObjectBlockingStateChanged"));this.Ig.CId(Object(r.a)(this,this.Voc,"updateEditState"));this.Ob.JM(Object(r.a)(this,this.lw,"onAppFrameModeSwitched"));this.Lc.TEf(Object(r.a)(this,this.XYg,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval"));this.Lc.SEf(Object(r.a)(this,this.WYg,"onApplyReplaceObjectSuggestionAfterSelectionRemoval"));this.Lc.DBc(Object(r.a)(this,
this.rma,"onUndoRedo"))}dispose(){this.zh&&(this.ra.Ewa(Object(r.a)(this,this.kH,"onSelectionChanged")),this.WBb.eGe(Object(r.a)(this,this.Rte,"markedUndo")),this.Ig.Y4(Object(r.a)(this,this.dB,"onActiveSlideChanged")),this.ila.vGe(Object(r.a)(this,this.f0,"onSlidePresenceChanged")),this.Lc.fSk(Object(r.a)(this,this.uye,"onReplaceObjectResponse")),this.qGa.gSk(Object(r.a)(this,this.vye,"onReplaceObjectViewDragEnd")),this.P8.Led(Object(r.a)(this,this.rwe,"onApplyReplaceObjectBlockingStateChanged")),
this.Ob.QX(Object(r.a)(this,this.lw,"onAppFrameModeSwitched")),this.Ig.hGe(Object(r.a)(this,this.Voc,"updateEditState")),this.Lc.dfh(Object(r.a)(this,this.XYg,"onApplyReplaceObjectSuggestionBeforeSelectionRemoval")),this.Lc.cfh(Object(r.a)(this,this.WYg,"onApplyReplaceObjectSuggestionAfterSelectionRemoval")),this.Lc.Qed(Object(r.a)(this,this.rma,"onUndoRedo")),this.hr=!1)}SYa(t){return this.O$d()?this.M3c.xpc(t):!1}selectShape(t){t&&this.ra.selectShape(t,!1)}jUc(t){switch(t){case vb.a.QNa:case vb.a.Uue:case vb.a.Kdc:case vb.a.Ldc:case vb.a.Mdc:case vb.a.Ndc:case vb.a.hHa:return!0;
default:return!1}}O$d(){return this.Bab&&this.Tle}C5g(t,N){const ha=[];if(gb.a.Va(t))return ha;t=t.split(";");if(t.length<N)return K.a.J(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",N,t.length),ha;for(let za=0;za<N;++za){const Ra=t[za].split(":");if(3!==Ra.length)throw N=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",za,t[za]),K.a.J(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",N),Error.create(N);
const qb=ip.a.Uhj(Number.parseInvariant(Ra[1]));Array.add(ha,Object.assign(new zl,{index:Ra[0],labelText:gb.a.Va(qb)?ResourceStrings.L_SmartArt:qb,imageData:this.JNc(Ra[2])}))}return ha}XYg(){this.MUa=!0}WYg(){this.MUa=!1}rma(t,N){this.YP(N.actionId)}JNc(t){return gb.a.Va(t)?null:"data:image/png;base64,"+t}lw(t){K.a.J(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",t.mode);this.Tle=2===t.mode}Voc(){this.Bab||K.a.J(36544856,829,50,"BaseReplaceObjectManager::UpdateEditState, updating edit state");
this.Bab=!0}cDb(t,N,ha,za){this.wUa.execute(Ra=>{const qb=Object.assign(new Si,{correlationId:t,shapeId:N,suggestions:ha});Ra.notifyTextToSmartArtSuggestion(za,qb)})}rkg(t,N,ha){if(N.FD)if(N.q8&&0!==t.xIa)K.a.J(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",t.xIa);else{if(0===t.xIa){if(0>=t.Pca){K.a.J(38115482,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",t.correlationId);this.closeSession(N,Qg.zve);
return}if(t.Pca<ha.replaceObjectMinRequiredSuggestions){K.a.J(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",t.correlationId);this.closeSession(N,Qg.U_j);return}N.q8=!1;N.suggestions=this.C5g(t.JBa,t.Pca);N.zU=t.Pca;K.a.J(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",N.zU,t.correlationId)}else if(1===t.xIa){if(gb.a.Va(t.JBa)){K.a.J(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",
t.correlationId);return}N.suggestions=this.C5g(t.JBa,t.Pca);N.HJb=new Date;ha.powerPointIdeasIsEnabled&&this.cDb(t.correlationId,N.shapeId,N.suggestions,Lj.a.success)}else 2===t.xIa&&(N.cde=!1,N.shapeId=t.shapeId,this.cDb(N.correlationId,t.shapeId,N.suggestions,Lj.a.success));ha=N.shape;N.slide&&N.slide.isConnected&&ha&&ha.isConnected&&this.Vt.pEa(ha)&&this.O$d()&&(1===t.xIa?this.Zy.mdh(N.correlationId):this.Zy.Kjd(ha))}else K.a.J(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",
t.correlationId)}}Object(h.a)(om,"BaseReplaceObjectManager",null,[677,707]);class gn{}gn.none="";gn.Glc="ShapePositionChanged";Object(h.a)(gn,"ReplaceObjectRetriggerReason",null,[]);class pe{}pe.selectShape="SelectShape";pe.Wfb="Retrigger";pe.Uci="AugLoopRetrigger";pe.Tci="AugLoopDefault";Object(h.a)(pe,"ReplaceObjectTrigger",null,[]);var Jo=d(502);class jp extends om{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of,ih,Aj,$f,Oi,wk,Ti,mn,ki,nn){super(vc,ha,za,Ra,qb,Qb,Zc,Wc,Md,Id,Xe,ih,Aj,$f,Oi,
Ti,mn,ki,nn);this.eT=t;this.nFg=N;this.E9j=of;this.la=wk;this.JPg=this.la.replaceObjectGrayFloatieInTyping}ow(){this.la.replaceObjectUseClientAL?this.nFg.execute(t=>{t.addEventHandler("ShapeTextConvertable",Object(r.a)(this,this.J9g,"processShapeTextConvertibleClientAL"))}):this.eT.execute(t=>{t.addEventHandler("ShapeTextConvertable",Object(r.a)(this,this.wCe,"processShapeTextConvertible"))});this.Lc.e8h(Object(r.a)(this,this.v$c,"onSlideShowStarted"));super.ow()}dispose(){this.zh&&(this.la.replaceObjectUseClientAL?
this.nFg.execute(t=>{t.removeEventHandler("ShapeTextConvertable",Object(r.a)(this,this.J9g,"processShapeTextConvertibleClientAL"))}):this.eT.execute(t=>{t.removeEventHandler("ShapeTextConvertable",Object(r.a)(this,this.wCe,"processShapeTextConvertible"))}),this.Lc.WSk(Object(r.a)(this,this.v$c,"onSlideShowStarted")));super.dispose()}wCe(t,N){if(t&&N){try{var ha=Ed.a(t);var za=Ed.a(N)}catch(qb){K.a.J(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");
return}if(ha&&!isNaN(ha.sid)&&!isNaN(ha.cid)&&!isNaN(ha.shapeId)&&this.ua.Ba&&(t=new Date(ha.c),K.a.J(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",ha.sid,ha.cid,ha.shapeId,ha.t,ha.c?(new Date).getTime()-ha.c:-1),(N=this.ua.Ba.DS(ha.shapeId))&&(Ff.a.contains(this.rfg(),N.get_shapeId())||"activeSlideChanged"===ha.t)))if(za&&!za.isTextConvertible)this.Zy.Rma(N,!0);else{var Ra=this.Yy.q1b(N.get_shapeId());if(Ra&&Ra.Tba&&(Ra=new Jo.a(N,Ra.yfa),this.ia.La(vb.a.cfb,
2,Ra),!Ra.Rsa))return;this.SYa(N)&&this.Fia(this.ua.Ba,N,za&&za.smartArtInfo?za.smartArtInfo.length:0,ha.t||pe.Tci,gn.none,t)}}}J9g(t,N,ha,za){N&&za&&za.ContextId&&za.Payload&&this.wCe(za.ContextId,za.Payload)}v$c(){this.POd(Qg.Ggl)}kH(t,N){if(!this.zh)K.a.J(26042393,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.MUa&&(N.hE.length||!this.Fa.ze||this.Fa.ze.name!==kd.a.Bg)){t=this.rfg();for(let ha of this.Yy)ha.FD&&!Array.contains(t,ha.shapeId)&&
this.closeSession(ha,Qg.mU);this.JPg&&!Array.contains(t,this.Zy.oub)&&this.Zy.SPk()}}vye(t,N){this.zh?(t=this.Yy.q1b(N.shape.get_shapeId()))&&t.FD&&(N=t.shape,this.closeSession(t,Qg.Glc),this.SYa(N)&&this.Fia(this.ua.Ba,N,0,pe.Uci,gn.Glc)):K.a.J(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}Rte(t,N){N.hwb&&this.YP(N.actionId)}dB(){this.POd(Qg.slideNavigation)}f0(t,N){if(N.Y7&&N.shapes)for(const ha of N.shapes)(t=this.Yy.q1b(ha))&&t.FD&&this.closeSession(t,
Qg.wMe)}uye(t,N){(t=this.Yy.r7a(N.correlationId))?this.rkg(N,t,this.la):K.a.J(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",N.correlationId)}rwe(){if(this.zh)for(let t of this.Yy)t.K8a&&0===t.L0&&!this.Xb.Zc(this.ua.presentation)&&(t.K8a=!1,this.Zy.Rma(t.shape,!0))}SYa(t){const N=this.Yy.yCf;return 1<=N?(K.a.J(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",
N),!1):super.SYa(t)}Fia(t,N,ha,za,Ra,qb=null){try{let Qb=this.Yy.q1b(N.get_shapeId());Qb&&this.closeSession(Qb,Qg.O7c);Qb=this.Yy.QGc(t,N.get_shapeId(),za,Ra,this.la);Qb.Wnc=qb;Qb.Tba="richEditTextUnicodeChanged"===za;this.Zy.Toc(Qb.correlationId);const vc=this.E9j.Glh(Qb);K.a.J(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",Qb.correlationId,Qb.slide.sid,Qb.slide.cid,Qb.shapeId,vc);K.a.J(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",
Qb.correlationId,ha,Math.min(ha,this.la.replaceObjectSuggestionMaxCount),za);ha&&this.la.replaceObjectShowFloatieOnShapeTextConvertibleResponse&&(ha=Math.min(ha,this.la.replaceObjectSuggestionMaxCount),Qb.suggestions=this.GYi(ha),Qb.zU=ha,Qb.q8=!1,this.Zy.Kjd(N));0===vc&&this.la.powerPointIdeasIsEnabled&&this.cDb(Qb.correlationId,Qb.shapeId,[],Lj.a.pending)}catch(Qb){K.a.J(34152522,829,10,"GenerateSuggestion failed!! {0} ",Qb.message)}}GYi(t){const N=Array(t);for(let ha=0;ha<t;ha++)Array.add(N,Object.assign(new zl,
{index:ha.toString(),labelText:ResourceStrings.l_Loading,imageData:null}));return N}YP(t){this.zh?this.jUc(t)||this.POd(Qg.hLb+this.FI.c5(t)):K.a.J(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")}yal(t){if(!this.JPg)return!1;const N=this.ra.Yd();return t.Tba&&Array.contains(N,t.shape)}closeSession(t,N){0===t.L0&&(N===Qg.zve?this.Zy.Rma(t.shape,!0):t.Tba&&this.Zy.Rma(t.shape,!0,N!==Qg.O7c,this.yal(t)),this.Yy.KSc(t,N),this.la.powerPointIdeasIsEnabled&&this.cDb(t.correlationId,
t.shapeId,t.suggestions,Lj.a.nHa))}POd(t){for(let N of this.Yy)this.closeSession(N,t)}rfg(){const t=this.ra.Yd(),N=[];t&&t.forEach(ha=>{Array.add(N,ha.get_shapeId())});return N}}Object(h.a)(jp,"AugmentationLoopReplaceObjectManager",om,[]);class hn{constructor(t,N){this.disabled=!1;this.rMg=vi.App.Mm;this.la=t;this.yb=N}Omh(t){this.disabled=!0;this.rMg=new Date;const N=new aa.a(2,1,this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds,()=>{this.disabled&&+new Date-+this.rMg>=this.la.replaceObjectGrayFloatieTimeoutInMilliSeconds&&
t()});this.yb.Cb(N)}B4k(t){const N=new aa.a(2,1,550,()=>{t()});this.yb.Cb(N)}static Jzl(t,N){return 7<=t&&8>=t&&1!==N}}Object(h.a)(hn,"FlyoutAnchorTimer",null,[]);var Uk=d(360);class In{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of,ih){this.ns=null;this.MUa=!1;this.Lc=N;this.ra=t;this.Yy=ha;this.ua=za;this.Ea=Ra;this.la=qb;this.Zy=Qb;this.pi=vc;this.Vt=Zc;this.ila=Wc;this.P8=Md;this.oUa=Id;this.Pcc=Xe;this.FI=of;this.jc=ih}ow(){this.Lc.v6h(Object(r.a)(this,this.c0g,"onIconSuggestionNotification"));
this.ra.VH(Object(r.a)(this,this.kH,"onSelectionChanged"));this.Lc.TEf(Object(r.a)(this,this.VYg,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Lc.SEf(Object(r.a)(this,this.UYg,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Lc.u6h(Object(r.a)(this,this.b0g,"onIconChanged"));this.ila.B3a(Object(r.a)(this,this.f0,"onSlidePresenceChanged"));this.P8.bUb(Object(r.a)(this,this.lea,"onBlockingStateChanged"));this.Pcc.aUb(Object(r.a)(this,this.Wdb,"onMarkedUndo"))}wUe(){this.Lc.TRk(Object(r.a)(this,
this.c0g,"onIconSuggestionNotification"));this.ra.Ewa(Object(r.a)(this,this.kH,"onSelectionChanged"));this.Lc.dfh(Object(r.a)(this,this.VYg,"onApplyIconChunkingSuggestionBeforeSelectionRemoval"));this.Lc.cfh(Object(r.a)(this,this.UYg,"onApplyIconChunkingSuggestionAfterSelectionRemoval"));this.Lc.SRk(Object(r.a)(this,this.b0g,"onIconChanged"));this.ila.vGe(Object(r.a)(this,this.f0,"onSlidePresenceChanged"));this.P8.Led(Object(r.a)(this,this.lea,"onBlockingStateChanged"));this.Pcc.eGe(Object(r.a)(this,
this.Wdb,"onMarkedUndo"))}dispose(){this.wUe()}setup(){this.ow()}VYg(){this.MUa=!0}UYg(){this.MUa=!1}b0g(t,N){N&&this.ns&&this.ns.zkc&&this.ns.slide.sid===N.slideId.sid&&this.ns.slide.cid===N.slideId.cid&&this.ns.shapeId===N.shapeId&&this.ns.r5===N.jY&&(this.ns.dJe=N.lDa)}f0(t,N){if(N.Y7&&N.shapes&&this.ns)for(const ha of N.shapes)this.ns.shapeId===ha&&this.IV(Qg.wMe)}Wdb(t,N){N.hwb&&!this.jUc(N.actionId)&&this.IV(Qg.hLb+this.FI.c5(N.actionId))}jUc(t){switch(t){case vb.a.QNa:case vb.a.Uue:case vb.a.Kdc:case vb.a.Ldc:case vb.a.Mdc:case vb.a.Ndc:case vb.a.hHa:return!0;
default:return!1}}lea(){if(this.ns){const t=this.ns.shape,N=this.Ea.nr(t);t&&N&&!this.oUa.Zc(N)&&(this.ns.K8a=!1,this.Zy.Rma(t,!0),this.ns.Unc=new Date,this.ns.IV(Qg.mU))}}kH(){if(!this.MUa){var t=this.Ea.Y6a(this.ra.Yd());if(t){if(this.ns&&this.ns.FD){if(Uk.a.Flc(t.fY,this.ns.fY))return;this.IV(Qg.mU)}this.SYa(t)&&this.Fia(this.ua.Ba,t,pe.selectShape)}else this.ns&&this.ns.FD&&this.IV(Qg.mU)}}Fia(t,N,ha){this.ns=this.Yy.SOa(t,N.get_shapeId(),ha,"",this.la,N.get_smartArtModelId());this.ns.q8=!0;this.Zy.Toc(this.ns.correlationId);
K.a.J(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.ns.correlationId,this.ns.slide.sid,this.ns.slide.cid,this.ns.shapeId,this.ns.r5);const za=N.get_smartArtModelId()?this.Ea.nr(N):N;za?this.pi.DYi(t.cid,t.sid,za.get_shapeId(),this.Vt.$Oc(za),this.Vt.ZOc(za),N.get_smartArtModelId(),this.ns.correlationId,ha,Object(r.a)(this,this.cnk,"onIconSuggestionResponseSuccess"),Object(r.a)(this,this.feb,"onTaskFailure")):
K.a.J(38279305,829,15,"Parent ShapeNode of a {0} is null",N.get_smartArtModelId()?"SmartArtSubShape":"NormalShape")}cnk(t){if(t&&t.SuggestionResult){var N=t.CorrelationId,ha=this.Yy.r7a(N);if(ha)if(ha.FD){N=null;try{N=Sys.Serialization.JavaScriptSerializer.deserialize(t.SuggestionResult)}catch(za){K.a.J(38625546,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",za)}if(N){ha.suggestions=this.Cvk(N);ha.HJb=new Date;if(ha.q8){if(this.aug(ha)){K.a.J(39184097,829,
15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",ha.tWb,this.la.pptIconChunkingSuggestionTimeoutMs);this.IV(Qg.oQf);return}K.a.J(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");ha.zU=ha.suggestions?ha.suggestions.length:0;ha.q8=!1;this.Zy.Kjd(ha.shape)}this.Zy.mdh(ha.correlationId)}else this.IV(Qg.serverError),K.a.J(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else K.a.J(38279315,
829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.ns?this.ns.correlationId:"",N);else K.a.J(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",N)}else this.IV(Qg.serverError),K.a.J(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")}feb(t){this.IV(Qg.serverError);
K.a.J(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",t.HttpStatusCode);return!0}SYa(t){return this.jc.un?t.get_smartArtModelId()&&t.get_isSVGBlipFilled()?(t=this.Ea.nr(t),!!t&&!t.gs):!1:!1}IV(t){this.ns&&(this.Zy.Rma(this.ns.shape,!0),this.Yy.KSc(this.ns,t),this.ns=null)}JNc(t){return gb.a.Va(t)?null:t.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+encodeURIComponent(t):"data:image/png;base64,"+t}Cvk(t){const N=[];if(!t||
!t.length)return N;for(let ha=0;ha<t.length;++ha){const za=Object.assign(new zl,{index:t[ha].Index.toString(),labelText:t[ha].Label,imageData:this.JNc(t[ha].Render),renderData:this.JNc(t[ha].Replace)});Array.add(N,za)}return N}cAi(t,N){const ha=[];if(gb.a.Va(t)||!N)return ha;for(var za=0;za<N;++za){var Ra=Object.assign(new zl,{index:za.toString(),labelText:"",imageData:null,renderData:null});Array.add(ha,Ra)}t=t.split(";");if(t.length-1!==N)return K.a.J(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",
ha.length,N),ha;for(za=0;za<N;++za)Ra=t[za].indexOf(":"),0>Ra?K.a.J(38279321,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):ha[za].labelText=t[za].substr(Ra+1);return ha}Bvk(t){let N,ha,za,Ra;N="";za=ha=0;Ra=null;if(gb.a.Va(t))return K.a.J(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),{returnValue:!1,correlationId:N,Pca:ha,Jve:za,suggestions:Ra};const qb=t.split("|");if(4!==qb.length)return K.a.J(38279325,
829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+t.length),{returnValue:!1,correlationId:N,Pca:ha,Jve:za,suggestions:Ra};N=qb[0];ha=parseInt(qb[1]);za=Number.parseInvariant(qb[2]);Ra=this.cAi(qb[3],ha);return{returnValue:!0,correlationId:N,Pca:ha,Jve:za,suggestions:Ra}}c0g(t,N){let ha,za;if(({correlationId:t,Pca:N,Jve:ha,suggestions:za}=this.Bvk(N.JBa)).returnValue){var Ra=this.Yy.r7a(t);if(Ra)if(Ra.FD&&Ra.q8){var qb=Ra.shape;0===ha&&(0>=
N?(K.a.J(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",t),this.IV(Qg.zve)):this.aug(Ra)?(K.a.J(39184137,829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",Ra.tWb,this.la.pptIconChunkingSuggestionTimeoutMs),this.IV(Qg.oQf)):(Ra.q8=!1,Ra.zU=N,Ra.suggestions=za,K.a.J(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",
Ra.correlationId,Ra.zU),this.Zy.Kjd(qb)))}else K.a.J(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.ns?this.ns.correlationId:"",t,Ra.FD,Ra.q8);else K.a.J(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",t)}else K.a.J(38279327,829,50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}aug(t){const N=
new Date,ha=t.yfa,za=this.la.pptIconChunkingSuggestionTimeoutMs;return N&&ha&&0<za&&+N-+ha>za?(t.tWb=+N-+ha,!0):!1}}Object(h.a)(In,"ReplaceIconManager",null,[]);var Wn=d(685),Jn=d(970);class Ko extends Sys.EventArgs{constructor(t){super();this.fY=t}}Object(h.a)(Ko,"OnBeforeReplaceObjectSuggestionApplyEventArgs",Sys.EventArgs,[]);class Rl{constructor(){this.shape=null;this.action=0}}Object(h.a)(Rl,"ShowHideReplaceObjectGalleryData",null,[]);class z{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe){this.hr=
this.Bab=!1;this.ia=N;this.Fa=ha;this.ua=Ra;this.Ig=za;this.Xb=qb;this.rGa=Qb;this.Zy=Md;this.Mb=Id;this.Ea=Xe;this.ra=t;this.Lc=vc;this.Yy=Zc;this.Fb=Wc}get zh(){return this.hr}setup(){this.zh||(this.ow(),this.ub(),this.xe(),this.hr=!0)}dispose(){this.zh&&(this.wUe(),this.hr=!1)}ow(){this.Ig.CId(Object(r.a)(this,this.Voc,"updateEditState"))}wUe(){this.Ig.hGe(Object(r.a)(this,this.Voc,"updateEditState"))}ub(){this.ia.pa(vb.a.QNa,pb.a.application,Object(r.a)(this,this.QNa,"applyReplaceObjectSuggestion"),
4);this.ia.pa(vb.a.VYa,pb.a.application,Object(r.a)(this,this.VYa,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.pa(vb.a.qIb,pb.a.application,Object(r.a)(this,this.VYa,"showHideReplaceObjectSuggestionsGallery"),4);this.ia.pa(vb.a.Wdc,pb.a.application,Object(r.a)(this,this.AWg,"navigateReplaceObjectSuggestion"),4);this.ia.pa(vb.a.Vdc,pb.a.application,Object(r.a)(this,this.AWg,"navigateReplaceObjectSuggestion"),4)}xe(){const t=this.Fa.Dc(kd.a.LP),N=this.Fa.Dc(kd.a.Bg),ha=this.Fa.Dc(kd.a.XFb);
t.bindAction(ob.KeyInputManager.Na(ma.a.lq,2),vb.a.qIb);N.bindAction(ob.KeyInputManager.Na(ma.a.lq,2),vb.a.qIb);ha.bindAction(ob.KeyInputManager.Na(ma.a.lq,2),vb.a.qIb);ha.bindAction(ob.KeyInputManager.Na(ma.a.Z0,0),vb.a.qIb);ha.bindAction(ob.KeyInputManager.Na(ma.a.V$,0),vb.a.Wdc);ha.bindAction(ob.KeyInputManager.Na(ma.a.Ifa,0),vb.a.Vdc)}Voc(){this.Bab||K.a.J(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.Bab=!0}QNa(t,N,ha,za,Ra){if(!this.zh)return K.a.J(33698392,
829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),16;N=this.ua.presentation;if(!this.ua.Ba||!N||this.Xb.Zc(N))return 16;if(1===ha)return 32;ha=!0;za=null;Object(Fi.a)(Wn.a,Ra)?za=Ra:Object(Fi.a)(Jn.a,Ra)&&(za=Ra.wCc,ha=!1);Ra=new Uk.a(O.a.tE(za.ActiveSlideSid,za.ActiveSlideCid),za.ShapeId,za.SmartArtSubNodeId);const qb=new Ko(Ra);this.rGa.xHk(qb);const Qb=this.Yy.s7a(Ra);if(Qb&&Qb.shapeId===za.ShapeId){let vc=null;1===Qb.L0&&(vc=this.Ea.nr(Qb.shape));Ra=this.Fb.ud(15,
void 0,()=>{1===Qb.L0||this.ra.wu()||(this.Lc.wdd(),this.ra.Uh(),this.Lc.vdd())},()=>{vc&&(this.Lc.wdd(),this.ra.selectShape(vc,!0),this.Lc.vdd())});try{Ra.kc(N),Ra.fd=za.SmartArtSubNodeId?vb.a.AOf:t,N.ZFb=za,Qb.sCc=za.SuggestionSid,Qb.XJd=za.Label,Qb.XS=!0,Qb.Vnc=new Date,K.a.J(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",za.CorrelationId,t,za.SuggestionSid)}finally{Ra&&Ra.dispose()}Qb.cde=!0;Qb.K8a=!0;ha&&Qb.Qte();0===
Qb.L0?this.Xb.Jw(N,t):vc?this.Xb.sqa(N,vc,this.Mb.Ma,t):K.a.J(38854750,808,15,"Invalid smartArtShape")}else K.a.J(33863682,808,15,"Couldn't find active replaceObjectContext");return 32}VYa(t,N,ha,za,Ra){if(!this.zh)return K.a.J(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;N=this.ua.presentation;if(!this.ua.Ba||!N||this.Xb.Zc(N))return 16;if(1===ha)return 32;ha=null;N=0;if(t===vb.a.VYa){t=Object(Q.a)(Rl,Ra);if(!t)return 16;ha=t.shape;N=t.action}else if(t===
vb.a.qIb){t=this.ra.Yd();if(1!==t.length)return 32;ha=t[0]}if(!ha)return K.a.J(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;t=this.Yy.s7a(ha.fY);if(!t||!this.Bab&&t&&0===t.L0)return 2;if(t&&t.FD&&t.shapeId===ha.get_shapeId())switch(this.ra.kj(),this.Fa.Ad(),N){case 0:this.Zy.Wol(t.correlationId);break;case 1:this.Zy.ZA.isVisible||this.Zy.HOe(t.correlationId);break;case 2:this.Zy.I6d(ha)}return 32}AWg(t,N,ha){if(!this.zh)return K.a.J(33698396,829,15,
"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;N=this.ua.presentation;return this.ua.Ba&&N&&!this.Xb.Zc(N)?1===ha?32:this.Zy.ZA.isVisible?t===vb.a.Wdc?(this.Zy.Wdc(),32):t===vb.a.Vdc?(this.Zy.Vdc(),32):16:16:16}}Object(h.a)(z,"ReplaceObjectActor",null,[]);class U{constructor(t,N){this.o9=t;this.rYc=N}initialize(){this.o9.execute(t=>{t.registerSimpleRemoteWorkflow(this.rYc.WF,this.rYc.bpb,this.rYc.FFb,this.rYc.rob)})}}Object(h.a)(U,"ReplaceObjectAugLoopRuntimeManager",
null,[]);var ka=d(1063),Ba;(function(t){t[t.textToSmartArt=0]="textToSmartArt";t[t.iconChunking=1]="iconChunking"})(Ba||(Ba={}));Object(h.b)("ReplaceObjectType",Ba);class Ia{constructor(t,N){this.Vza=this.NR=this.la=null;this.shapeId=0;this.r5=null;this.L0=0;this.Tba=!1;this.sCc=0;this.XJd=null;this.nae=this.cae=this.K8a=this.XS=!1;this.Unc=this.Vnc=this.nSe=this.HJb=this.Znc=this.ZJa=this.Wnc=this.yfa=null;this.tsb=this.Ymc=0;this.HCd=this.V2a=this.roa=null;this.q8=!1;this.suggestions=null;this.tWb=
this.zU=0;this.cde=!1;this.igb=null;this.zkc=!1;this.dJe=null;this.uxd=!1;this.OAb=[];this.pi=t;this.M8b=N;this.reset()}SOa(t,N,ha,za,Ra,qb){this.FD&&this.IV(Qg.O7c);if(!t)throw Error.argumentNull("slide");const Qb=t.$tb(new Uk.a(t?t.Bb:null,N,qb));if(!Qb)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",N));this.NR=t;this.Vza=Qb;this.shapeId=N;this.r5=qb;this.roa=Be.a.create().toString();this.uxd=!0;this.V2a=ha;this.HCd=za;this.la=Ra;this.yfa=new Date;
this.L0=this.Tgj();return this.correlationId}QGc(t,N,ha,za,Ra){return this.SOa(t,N,ha,za,Ra,null)}Tgj(){const t=this.shape;return this.la.iconChunkingEnabled&&t&&this.r5&&t.get_isSVGBlipFilled()?1:0}IV(t){if(this.FD&&!this.INj(this.correlationId)){const N={};N.SuggestionCount=this.zU;N.ClientSuggestionTimeoutInMs=this.tWb;N.IsApplied=this.XS;N.AppliedSuggestionId=this.XS?this.sCc.toString():"";N.AppliedSuggestionLabel=this.XS?this.XJd:"";N.IsFloatieShown=this.cae;N.IsGalleryShown=this.nae;N.Trigger=
this.trigger;N.RetriggerReason=this.pXk;N.ResetReason=t;N.IconId=this.la.replaceObjectIconType;N.SlideCID=this.slide.cid;N.SlideSID=this.slide.sid;N.ShapeID=this.shapeId;N.AnimId=this.la.replaceObjectAnimId;N.AnimEnabled=this.la.YFb;N.GalleryHoverEnabled=this.la.replaceObjectGalleryHoverEnabled;N.ReplaceSuggestionType=Ba[this.L0];N.SeeMoreButtonClicked=this.zkc;N.SeeMoreIconName=this.zkc?this.dJe:"";this.yfa&&(N.SessionLiveTimeInMs=+new Date-+this.yfa);this.r5&&(N.SmartArtSubNodeId=this.r5);this.ZJa&&
this.HJb&&this.HJb>this.ZJa&&(N.SuggestionsReadyInMs=+this.HJb-+this.ZJa);0<this.Ymc&&(N.SuggestionsDisplayedForMs=this.Ymc);0<this.tsb&&(N.FloatieDisplayedForMs=this.tsb);this.ZJa&&this.yfa&&this.ZJa>this.yfa&&(N.FloatieReadyInMs=+this.ZJa-+this.yfa);this.yfa&&this.Wnc&&this.yfa>this.Wnc&&(N.TriggeredByAugLoopInMs=+this.yfa-+this.Wnc);this.Vnc&&this.Unc&&this.Unc>this.Vnc&&(N.SuggestionAppliedInMs=+this.Unc-+this.Vnc);if(0<this.suggestions.length){t=[];for(let ha=0;ha<this.suggestions.length;ha++)Array.add(t,
this.suggestions[ha].labelText);N.SuggestionLabels=Kf.c(t)}1!==this.L0||gb.a.Va(this.igb)||(t=ka.a.v7a(this.igb))&&t.hasChildNodes()&&(ka.a.IZb(),ka.a.$Ok(this.igb));this.pi.RUk(this.correlationId,Kf.c(N),void 0,Object(r.a)(this,this.Dec,"onFailureCallback"));this.bdk(this.correlationId)}this.reset()}reset(){this.uxd=!1;this.NR=null;this.cde=this.nae=this.cae=this.K8a=this.XS=this.Tba=!1;this.HCd=this.V2a=this.roa="";this.suggestions=[];this.sCc=0;this.XJd="";this.q8=!1;this.tWb=this.zU=0;this.Unc=
this.Vnc=this.nSe=this.HJb=this.Znc=this.ZJa=this.Wnc=this.yfa=null;this.L0=this.tsb=this.Ymc=0;this.igb="";this.Vza=null;this.zkc=!1;this.dJe=""}INj(t){return this.OAb?Array.contains(this.OAb,t):!1}bdk(t){this.OAb&&!Array.contains(this.OAb,t)&&(Array.add(this.OAb,t),K.a.J(512496034,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",t,this.OAb.length))}Dec(t){K.a.J(512496033,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",
t.HttpStatusCode);return!0}Qte(){this.aUg(2,4)}gdk(){this.aUg(3,3)}aUg(t,N){this.M8b&&this.M8b.execute(ha=>{const za=Object.assign(new Sk.a,{cardId:dk.a.Wth,actionType:t,actionEngagement:N});ha.f8c(za)})}get slide(){return this.NR}get shape(){return this.Vza}get correlationId(){return this.roa}get trigger(){return this.V2a}get pXk(){return this.HCd}get FD(){return this.uxd}get appSettings(){return this.la}get fY(){return new Uk.a(this.slide?this.slide.Bb:null,this.shapeId,this.r5)}}Object(h.a)(Ia,
"ReplaceObjectContext",null,[883]);class Ab{constructor(){this.va=new Qk.a}xHk(t){this.va.raiseEvent("ReplaceObjectBSA",t)}Y5h(t){this.va.addHandler("ReplaceObjectBSA",t)}DRk(t){this.va.removeHandler("ReplaceObjectBSA",t)}pbh(t){this.va.raiseEvent("ReplaceObjectSPOver",t)}C7h(t){this.va.addHandler("ReplaceObjectSPOver",t)}DSk(t){this.va.removeHandler("ReplaceObjectSPOver",t)}obh(t){this.va.raiseEvent("ReplaceObjectSPOut",t)}B7h(t){this.va.addHandler("ReplaceObjectSPOut",t)}CSk(t){this.va.removeHandler("ReplaceObjectSPOut",
t)}BHk(t){this.va.raiseEvent("ReplaceObjectViewDE",t)}O6h(t){this.va.addHandler("ReplaceObjectViewDE",t)}gSk(t){this.va.removeHandler("ReplaceObjectViewDE",t)}}Object(h.a)(Ab,"ReplaceObjectEventSource",null,[880,881,882]);class Ob extends om{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of,ih,Aj,$f,Oi,wk,Ti,mn){super(qb,t,N,ha,za,Ra,Qb,vc,Zc,Wc,Md,Xe,of,ih,Aj,Oi,wk,Ti,mn);this.ii=vc.Vag();this.pi=Id;this.la=$f}kH(t,N){if(!this.zh)K.a.J(25306451,829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");
else if(!this.MUa&&N.hE.length)if(t=this.ra.Yd(),1!==t.length)this.ii.FD&&this.closeSession(this.ii,Qg.mU);else{t=t[0];if(this.ii.FD){if(this.ii.shapeId===t.get_shapeId())return;this.closeSession(this.ii,Qg.mU)}this.SYa(t)&&this.Fia(this.ua.Ba,t,pe.selectShape,"")}}vye(t,N){this.zh?this.ii.FD&&this.ii.shape===N.shape&&(t=this.ii.shape,this.closeSession(this.ii,Qg.Glc),this.SYa(t)&&this.Fia(this.ua.Ba,t,pe.Wfb,gn.Glc)):K.a.J(25306453,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")}Rte(t,
N){N.hwb&&this.YP(N.actionId)}dB(){this.ii.FD&&this.closeSession(this.ii,Qg.slideNavigation)}f0(t,N){this.ii.FD&&N.Y7&&N.shapes&&Array.contains(N.shapes,this.ii.shapeId)&&this.closeSession(this.ii,Qg.wMe)}uye(t,N){N.correlationId!==this.ii.correlationId?K.a.J(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.ii.correlationId,N.correlationId):this.rkg(N,this.ii,this.la)}rwe(){this.zh&&this.ii.K8a&&0===this.ii.L0&&!this.Xb.Zc(this.ua.presentation)&&
(this.ii.K8a=!1,this.Zy.Rma(this.ii.shape,!0))}Fia(t,N,ha,za=""){try{const Ra=this.ii.QGc(t,N.get_shapeId(),ha,za,this.la);this.ii.q8=!0;this.Zy.Toc(this.ii.correlationId);this.pi.i8f(t.cid,t.sid,N.get_shapeId(),Ra,ha,this.Vt.$Oc(N),this.Vt.ZOc(N),void 0,Object(r.a)(this,this.feb,"onTaskFailure"));this.la.powerPointIdeasIsEnabled&&this.cDb(Ra,this.ii.shapeId,this.ii.suggestions,Lj.a.pending)}catch(Ra){K.a.J(34152532,829,15,"GenerateSuggestion failed!! {0} ",Ra.message)}}feb(t){K.a.J(36966422,829,
15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",t.HttpStatusCode);return!0}YP(t){this.zh?this.ii.FD&&!this.jUc(t)&&this.closeSession(this.ii,Qg.hLb+this.FI.c5(t)):K.a.J(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")}closeSession(t,N){t.Tba&&this.Zy.Rma(t.shape,!0);t.IV(N);this.la.powerPointIdeasIsEnabled&&this.cDb(t.correlationId,t.shapeId,t.suggestions,Lj.a.nHa)}}Object(h.a)(Ob,"ReplaceObjectManager",om,[]);var Yb=
d(21);class uc{constructor(t){this.PN=-1;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Xfe=Array.clone(t)}get_current(){if(-1===this.PN||this.PN>=this.Xfe.length)throw Error.invalidOperation();return this.Xfe[this.PN]}moveNext(){this.PN++;return this.PN<this.Xfe.length}reset(){this.PN=-1}}Object(h.a)(uc,"ArrayEnumerator",null,[142]);class mc{constructor(t){this.pGa=[];this.$$ge=this.getEnumerator;this.C9j=t}getEnumerator(){return new uc(this.pGa)}[Symbol.iterator](){return Object(Yb.a)(this.getEnumerator())}KSc(t,
N){t&&(t.IV(N),Array.remove(this.pGa,t))}r7a(t){for(const N of this.pGa)if(N.correlationId===t)return N;return null}s7a(t){for(const N of this.pGa)if(Uk.a.Flc(t,N.fY))return N;return null}Reg(t,N){for(const ha of this.pGa)if(ha.shapeId===t&&(!N&&!ha.r5||N&&N===ha.r5))return ha;return null}q1b(t){return this.Reg(t,null)}Vag(){return 0<this.pGa.length?this.pGa[0]:null}SOa(t,N,ha,za,Ra,qb){let Qb=this.s7a(new Uk.a(t.Bb,N,qb));Qb&&this.KSc(Qb,Qg.O7c);Qb=this.C9j(t,N,ha,za,Ra,qb);Array.add(this.pGa,Qb);
return Qb}QGc(t,N,ha,za,Ra){return this.SOa(t,N,ha,za,Ra,null)}get yCf(){let t=0;this.pGa.forEach(N=>{N.FD&&t++});return t}}Object(h.a)(mc,"ReplaceObjectMultipleContextManager",null,[676,141]);class Ec{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc){this.ua=t;this.KPg=N;this.F9j=ha;this.Vt=qb;this.qGa=Ra;this.Yy=za;this.ZA=Qb;this.Fa=vc;this.Ne=Zc;this.Ea=Wc;this.hr=!1;this.Dtc=-1}get zh(){return this.hr}get oub(){return this.Dtc}setup(){this.zh||(this.qGa.Y5h(Object(r.a)(this,this.iZg,"onBeforeReplaceObjectSuggestionApply")),
this.qGa.C7h(Object(r.a)(this,this.M1g,"onReplaceObjectSuggestionPointerOver")),this.qGa.B7h(Object(r.a)(this,this.L1g,"onReplaceObjectSuggestionPointerOut")),this.hr=!0)}dispose(){this.zh&&(this.qGa.DRk(Object(r.a)(this,this.iZg,"onBeforeReplaceObjectSuggestionApply")),this.qGa.DSk(Object(r.a)(this,this.M1g,"onReplaceObjectSuggestionPointerOver")),this.qGa.CSk(Object(r.a)(this,this.L1g,"onReplaceObjectSuggestionPointerOut")),this.hr=!1)}iZg(t,N){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");
(t=this.ua.Ba.$tb(N.fY))&&this.Rma(t,!1)}M1g(t,N){this.ua.Ba&&(t=new Uk.a(this.ua.Ba.Bb,N.shapeId,N.jY),(t=this.ua.Ba.$tb(t))&&this.GOe(t,N.Fng))}L1g(t,N){this.ua.Ba&&(t=new Uk.a(this.ua.Ba.Bb,N.shapeId,N.jY),(t=this.ua.Ba.$tb(t))&&this.k3b(t))}GOe(t,N){let ha=t;t.get_smartArtModelId()&&(ha=this.Ea.nr(t));if(t=this.Cgg(ha))this.Ash(ha,!1),t.GOe(N)}k3b(t){let N=t;t.get_smartArtModelId()&&(N=this.Ea.nr(t));if(t=this.Cgg(N))this.Ash(N,!0),t.k3b()}Cgg(t){return t&&!t.get_smartArtModelId()&&Object(Q.a)(121,
t.oc(this.Ne))?this.F9j.AG(t):null}wOi(t){return t&&Object(Q.a)(121,t.oc(this.Ne))?this.KPg.AG(t):null}z2d(t){return t&&Object(Q.a)(121,t.oc(this.Ne))?this.KPg.kF(t):null}Kjd(t){if(!this.zh)K.a.J(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(t){var N=this.wOi(t);if(N){const ha=this.Yy.s7a(t.fY);!ha||ha.Tba&&this.oub!==ha.shapeId||(ha.Tba?this.oub===ha.shapeId&&(N.pJc(),this.Dtc=-1):(this.Rma(t,!0,!(this.ZA.JXa&&this.ZA.isVisible&&Uk.a.Flc(t.fY,
this.ZA.JXa.fY))),N.display()),ha.Tba=!0)}}}SPk(){if(-1!==this.oub&&this.ua.Ba){var t=this.ua.Ba.DS(this.oub);t&&this.Rma(t,!0)}}Rma(t,N,ha=!0,za=!1){this.zh?t&&(N&&this.k3b(t),ha&&this.I6d(t),N=this.z2d(t))&&(za?(N.lIc(),this.Dtc=t.get_shapeId()):(this.oub===t.get_shapeId()&&(this.Dtc=-1),N.visible&&N.dismiss(),(za=this.Yy.s7a(t.fY))&&t.get_shapeId()===za.shapeId&&(za.Tba=!1))):K.a.J(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}Toc(t){this.ZA.Toc(t)}Wol(t){if(this.zh)if(this.ZA.isVisible){const N=
this.Yy.r7a(t);N&&N.FD&&N.correlationId===t&&this.k3b(N.shape);this.I6d(N.shape)}else this.HOe(t);else K.a.J(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup")}I6d(t){this.ZA.isVisible&&this.ZA.JXa&&Uk.a.Flc(this.ZA.JXa.fY,t.fY)&&(this.ZA.dismiss(),(t=this.z2d(this.ZA.JXa.shape))&&t.root&&(t.root.style.zIndex="0"),this.Fa.Gj(kd.a.XFb,!1))}HOe(t){const N=this.Yy.r7a(t);if(N&&N.correlationId===t&&N.FD){var ha=this.z2d(N.shape);if(ha){var za=ha.root;za?this.ZA.isVisible&&
this.ZA.JXa&&!Uk.a.Flc(this.ZA.JXa.fY,N.fY)||(za=this.Vt.getBounds(za),this.ZA.show(t,za.x,za.y),ha.root.style.zIndex=String(v.AFrameworkApplication.Aa.Rnb),this.Fa.Gj(kd.a.XFb,!0),N.nae=!0):K.a.J(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else K.a.J(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}mdh(t){this.zh?this.ZA.isVisible&&this.HOe(t):K.a.J(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}Wdc(){if(this.zh){var t=
this.ZA.l0d();t&&(-1===t?this.ZA.ww(0,!0):(this.ZA.ww(t,!1),this.ZA.ww(t-1,!0)))}else K.a.J(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup")}Vdc(){if(this.zh){var t=this.ZA.l0d();t+1!==this.ZA.Ogj()&&(-1===t?this.ZA.ww(0,!0):(this.ZA.ww(t,!1),this.ZA.ww(t+1,!0)))}else K.a.J(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup")}Ash(t,N){t&&(t=Object(Q.a)(121,t.oc(this.Ne)))&&((t=t.xa)?t.Ld(N):K.a.J(25306516,
829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}}Object(h.a)(Ec,"ReplaceObjectPresenter",null,[707]);class Yc{constructor(){this.shapeId=this.slideCid=this.slideSid=0;this.nEb=null;this.dAe=0}}Object(h.a)(Yc,"TaskItem",null,[]);class jd{constructor(t,N,ha){this.rcb=[];this.pi=t;this.Vt=N;this.SFg=ha}eUi(t,N,ha){for(let za=0;za<this.rcb.length;za++)if(this.rcb[za].slideSid===t&&this.rcb[za].slideCid===N&&this.rcb[za].shapeId===ha)return this.rcb[za];return null}Glh(t){var N=this.eUi(t.slide.sid,
t.slide.cid,t.shapeId);if(N)return N.nEb=t,N.dAe++,1;const ha=Object.assign(new Yc,{slideSid:t.slide.sid,slideCid:t.slide.cid,shapeId:t.shapeId,dAe:0,nEb:null});Array.add(this.rcb,ha);t.q8=!0;N=t.correlationId;const za=t.slide,Ra=t.shape;this.pi.i8f(za.cid,za.sid,Ra.get_shapeId(),N,t.trigger,this.SFg?this.Vt.$Oc(Ra):this.Vt.B1b(Ra),this.SFg?this.Vt.ZOc(Ra):this.Vt.A1b(Ra),()=>{this.f3g(ha)},qb=>{this.f3g(ha);K.a.J(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
qb.HttpStatusCode);return!0});return 0}f3g(t){Array.remove(this.rcb,t);t.nEb&&t.nEb.FD&&(K.a.J(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",t.nEb.correlationId,t.dAe-1),this.Glh(t.nEb))}}Object(h.a)(jd,"ReplaceObjectRequestManager",null,[675]);class vd{constructor(t){this.Cme=!0;this.$$cu=this.get_current;this.$$mn=this.moveNext;this.$$rst=this.reset;this.Dp=t}get_current(){return this.Dp}moveNext(){return this.Cme?(this.Cme=!1,!0):!1}reset(){this.Cme=
!0}}Object(h.a)(vd,"SingleEnumerator",null,[142]);class he{constructor(t){this.$$ge=this.getEnumerator;this.ii=t}getEnumerator(){return new vd(this.ii)}[Symbol.iterator](){return Object(Yb.a)(this.getEnumerator())}KSc(t,N){t&&t===this.ii&&t.IV(N)}r7a(){return this.ii}s7a(){return this.ii}q1b(){return this.ii}Reg(){return this.ii}Vag(){return this.ii}SOa(t,N,ha,za,Ra,qb){this.ii.SOa(t,N,ha,za,Ra,qb);return this.ii}QGc(t,N,ha,za,Ra){return this.SOa(t,N,ha,za,Ra,null)}get yCf(){return this.ii.FD?1:0}}
Object(h.a)(he,"ReplaceObjectSingleContextManager",null,[676,141]);var nd=d(131);class ee{constructor(t,N,ha,za,Ra){this.Kda=null;this.vBb=this.$he=!1;this.kla=null;this.visible=!1;this.vv=t;this.dT=N;this.I8=ha;this.Vt=Ra;this.Ebc=za;this.hr=!1}get zh(){return this.hr}setup(){this.zh||(this.kla=new Pb.a,this.Kda=this.Ebc.eCi(this.kla.xa),this.dT&&!this.dT.ll&&this.dT.nU&&(this.dT.nU.appendChild(this.kla),this.Ld(!1),this.vBb=!0,this.dT.Ypa(this,3),this.visible=this.dT.aQ||this.dT.Kn),this.hr=!0)}ym(){K.a.J(25306526,
829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")}LC(){}Qp(){if(!this.zh)return K.a.J(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.$he||!this.Kda.zh||!this.Kda.jN)return null;const t=kb.a.qn(this.Kda.jN.xa.style.left),N=kb.a.qn(this.Kda.jN.xa.style.top),ha=kb.a.qn(this.Kda.jN.xa.style.width),za=kb.a.qn(this.Kda.jN.xa.style.height);return new nd.a(new cc.a(t,N),new cc.a(t+ha,N),new cc.a(t+ha,N+
za),new cc.a(t,N+za))}kN(){return!1}xx(){}Ay(){}setPosition(){}Dj(){this.vBb=!0;this.Nr()}Gq(){this.vBb=!0;this.Nr()}Gu(){this.vBb=!0;this.Nr()}setZIndex(t){this.kla&&this.kla.pB(t)}nE(){}CD(){return null}jB(){return[]}draw(){}dispose(){this.I8();this.zh&&(this.Kda.dispose(),this.kla.xa.parentNode&&this.kla.qq(),this.kla=null,this.hr=!1)}GOe(t){this.zh?(this.Ykc(t),this.Nr()):K.a.J(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")}k3b(){this.zh?this.Bqa():
K.a.J(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")}Ykc(t){this.zh?(this.Kda.nna(t),this.Ld(!0)):K.a.J(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")}Bqa(){this.zh?(this.Kda.dismiss(),this.Ld(!1)):K.a.J(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")}setSelection(){}Nr(){if(this.$he&&this.vBb){var t=this.Vt.B1b(this.vv),N=this.Vt.A1b(this.vv);this.gh(t,N);this.kla&&(t=
this.Vt.ddj(this.vv),ko.a.setRotation(this.kla.xa,t));this.vBb=!1}}Ld(t){this.$he=t;this.kla.Ld(t)}gh(t,N){this.Kda&&this.Kda.gh(t,N)}}Object(h.a)(ee,"ReplaceObjectSuggestionPreviewView",null,[878,879,535,536,106,707]);var Ue=d(265),n=d(219),Y=d(248),ra=d(969),Pa=d(968);class eb extends Sys.EventArgs{constructor(t){super();this.shape=t}}Object(h.a)(eb,"ReplaceObjectViewDragEndEventArgs",Sys.EventArgs,[]);class Eb{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md){this.nRg=!1;this.s9=this.lUa=null;this.ia=
Ra;this.De=qb;this.od=Qb;this.Yy=vc;this.rGa=Zc;this.Ebc=za;this.I8=ha;this.vv=t;this.dT=N;this.Uz=!1;this.la=Wc;this.Iqe=Md;this.hr=this.visible=!1}get zh(){return this.hr}ftb(){return this.Yy.s7a(this.vv.fY)}setup(){if(!this.zh){var t=this.ftb();t=t?t.L0:0;this.nRg=1===t;this.s9=new Pb.a;this.lUa=this.Ebc.vzi(this.s9,Eb.zDc,Object(r.a)(this,this.jmk,"onFlyoutAnchorClick"),Object(r.a)(this,this.kmk,"onFlyoutAnchorHover"),t);this.dT&&!this.dT.ll&&this.dT.nU&&(this.ym(this.dT.nU),this.dT.Ypa(this,
3));this.hr=!0}}pJc(){this.zh?this.lUa&&this.lUa.pJc():K.a.J(512496032,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")}lIc(){this.zh?this.lUa&&this.lUa.lIc():K.a.J(512496031,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")}display(){if(!this.zh)K.a.J(512496030,829,15,"ShapeReplaceObjectView::Display - called before setup");else if(!this.visible){this.Nr();this.lUa.show();this.visible=!0;this.NKb();var t=this.ftb();if(t){t.cae=!0;const N=new Date;t.ZJa||
(t.ZJa=N);t.Znc=N;K.a.J(512496029,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",t.trigger,t.correlationId)}}}get root(){return this.zh?this.s9.xa:(K.a.J(512496027,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)}dismiss(){if(this.zh){this.lUa.dismiss();this.visible=!1;var t=this.ftb();t&&(t.Tba=!1,t.Znc&&(t.tsb+=+new Date-+t.Znc,K.a.J(512496025,829,50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",
t.tsb,t.Znc,t.trigger,t.correlationId)))}else K.a.J(512496026,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")}ym(){this.visible=!1;this.De.addCssClass(this.s9.xa,"replaceObjectBody");document.body.appendChild(this.s9.xa);this.od.eUb(Object(r.a)(this,this.onResize,"onResize"));this.Nr()}LC(){}Qp(){return null}kN(){return!1}xx(){}Ay(){}setPosition(){}Dj(){}Gq(){}Gu(){}setZIndex(){}nE(t){if(this.zh){if(t)this.visible=!1,this.NKb();else if(this.Uz){const N=new eb(this.vv);this.rGa.BHk(N)}this.Uz=
t}else K.a.J(512496024,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")}CD(){return null}jB(){return[]}draw(){this.zh?this.Nr():K.a.J(512496023,829,15,"ShapeReplaceObjectView::Draw - called before setup")}setSelection(){}dispose(){this.I8();this.zh&&(this.od.Tfh(Object(r.a)(this,this.onResize,"onResize")),this.s9&&(this.s9.xa.parentNode&&this.s9.qq(),this.De.removeCssClass(this.s9.xa,"replaceObjectBody")),this.dismiss(),this.lUa.dispose(),this.s9=null,this.hr=!1)}NKb(){this.s9.xa.style.visibility=
this.visible?ab.a.visible:ab.a.hidden;const t=this.ftb();t&&(t.Tba=this.visible)}Nr(){let t=null;var N=this.dT.nU;N&&(t=this.De.ei(N.xa));t?(N=t.x-(Eb.zDc+10),this.nRg&&this.dT&&this.dT.Gd&&(N=this.dT.Gd.Fd.Ie(this.vv.Rx,0),N=t.x+N+10),ko.a.Uhd(this.s9.xa,1),this.s9.setPosition(1*N,t.y),this.mvl(1*N,t.y)):K.a.J(512496022,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")}mvl(t,N){if(this.Iqe.isVisible){var ha=this.ftb(),za=this.Iqe.JXa;za&&ha&&za.correlationId===ha.correlationId&&
this.Iqe.updatePosition(t,N)}}jmk(t){if(t.dA!==Sys.UI.MouseButton.leftButton)return!1;this.ia.La(vb.a.VYa,2,Object.assign(new Rl,{shape:this.vv,action:0}));return!0}kmk(){if(!this.la.replaceObjectGalleryHoverEnabled)return!1;const t=this.ftb();if(t&&1===t.L0)return!1;this.ia.La(vb.a.VYa,2,Object.assign(new Rl,{shape:this.vv,action:1}));return!0}onResize(t,N){this.visible&&(t=null,N&&N.RF&&(t=N.RF.Ed),t&&t.Bb.equals(this.vv.slideId)&&this.Nr())}}Eb.zDc=32;Object(h.a)(Eb,"ShapeReplaceObjectView",null,
[705,706,535,536,106,707]);var Sb=d(636);class ub{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id){this.kVa=this.tda=this.mVa=this.t4=this.ro=null;this.n5c=0;this.jle=-1;this.nq=this.ii=null;this.De=t;this.Wc=ha;this.gp=N;this.ua=za;this.ia=Ra;this.RD=Zc;this.rGa=qb;this.Yy=Qb;this.A_=vc;this.Fa=Wc;this.la=Md;this.s$j=!Id.Nj;this.hr=this.Ilb=!1}get zh(){return this.hr}get isVisible(){return this.Ilb}get JXa(){return this.ii}setup(){this.zh||(this.ro=kb.a.Ce(),this.ro.setAttribute("Unselectable","on"),
this.ro.style.position=ab.a.absolute,this.De.addCssClass(this.ro,"replaceObjectContainer"),this.BHe(null),document.body.appendChild(this.ro),this.Hma(),this.RD.T7(kd.a.XFb,kd.a.jj,this.ro,()=>{},()=>{},!0),this.hr=!0)}dispose(){this.zh&&(this.dismiss(),this.Loc(),this.ro&&this.ro.parentNode&&this.ro.parentNode.removeChild(this.ro),this.hr=!1)}dismiss(){this.zh?(v.AFrameworkApplication.Aa.NPa(!0),this.setVisibility(!1),this.uCb.style.display=ab.a.none,this.uCb.style.zIndex="-1",this.kVa=this.tda=null,
this.BHe(null)):K.a.J(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")}show(t,N,ha){if(!this.zh)K.a.J(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");else if(!gb.a.Va(t)){var za=this.Yy.r7a(t);za&&za.correlationId===t&&za.FD&&!za.q8&&(this.ii=za,this.dzk(t,this.ii.suggestions),this.n5c=this.ii.zU,this.Mhh(),v.AFrameworkApplication.Aa.dOa(!0),this.uCb.style.zIndex=String(v.AFrameworkApplication.Aa.Qpa),this.ro.style.zIndex=String(v.AFrameworkApplication.Aa.Rnb),
this.uCb.style.visibility=ab.a.hidden,this.uCb.style.display=ab.a.block,this.uCb.style.visibility=ab.a.visible,this.Dja()?this.De.addCssClass(this.ro,"replaceIconObjectContainer"):this.De.removeCssClass(this.ro,"replaceIconObjectContainer"),this.updatePosition(N,ha),this.setVisibility(!0))}}updatePosition(t,N){let ha,za;this.setPosition(0,0);if(this.Dja()){ha=t+Eb.zDc+7;za=N;const Ra=Sb.a(0,0);ha+this.ro.offsetWidth>Ra.width&&(ha=t+Eb.zDc-this.ro.offsetWidth,za=N-7-this.ro.offsetHeight)}else ha=t,
za=N-7-this.ro.offsetHeight;this.setPosition(ha,za)}Ogj(){return this.zh?this.n5c:(K.a.J(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),0)}l0d(){return this.zh?this.isVisible?this.ro?this.ro.querySelector(".replaceObjectSuggestionsList")?this.jle:(K.a.J(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(K.a.J(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),
-1):-1:(K.a.J(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}ww(t,N){if(!this.zh)K.a.J(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>t)&&this.isVisible)if(this.ro)if(t>=this.n5c)K.a.J(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.n5c,t);else{var ha=this.ro.querySelector(".replaceObjectSuggestionsList");
ha?(ha=ha.children)?(ha=ha[t])?N?(this.jle=t,gc.FocusManager.Mr(ha)&&this.Osh(ha.firstChild)):(this.Mhh(),gc.FocusManager.rrl(ha)&&this.rmg(ha.firstChild)):K.a.J(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):K.a.J(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):K.a.J(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else K.a.J(25306584,
829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")}Toc(t){this.mVa&&(this.mVa.className="ReplaceObjectCorrelation "+t)}dzk(t,N){this.BHe(t);if(t=this.uDi(t,N))N=this.tDi(),this.ro.appendChild(N),this.ro.appendChild(t),this.Dja()&&(t=this.sDi(),this.ro.appendChild(t))}BHe(t){this.ro&&(this.t4&&(this.Wc.xb(la.a.click,this.t4,Object(r.a)(this,this.x0g,"onLinkClick")),this.t4=null),this.De.ku(this.ro),this.mVa=kb.a.Ce(),this.mVa.setAttribute("Unselectable",
"on"),this.mVa.className=gb.a.Va(t)?"ReplaceObjectCorrelation":"ReplaceObjectCorrelation "+t,this.mVa.style.position=ab.a.absolute,this.mVa.style.display=ab.a.none,this.ro.appendChild(this.mVa),this.ro.style.zIndex="-1")}tDi(){const t=kb.a.Fn();t.setAttribute("Unselectable","on");this.Dja()?(t.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,this.De.addCssClass(t,"replaceIconObjectContainerTitle")):(t.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,this.De.removeCssClass(t,
"replaceIconObjectContainerTitle"));this.De.addCssClass(t,"UIFont replaceObjectContainerTitle");return t}uDi(t,N){if(gb.a.Va(t))return K.a.J(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),null;if(!N||!N.length)return K.a.J(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),null;const ha=kb.a.TXb();ha.id=t;ha.setAttribute("Unselectable","on");ha.setAttribute(oa.a.Ye,oa.a.Ubi);
this.De.addCssClass(ha,"replaceObjectSuggestionsList");this.tda||(this.tda=new Mf.a);this.kVa||(this.kVa=new Mf.a);for(var za of N)gb.a.Va(za.imageData)||this.tda.$(za.index,za.imageData),this.Dja()&&!gb.a.Va(za.renderData)&&this.kVa.$(za.index,za.renderData),t=this.ggi(za.index,za.labelText),ha.appendChild(t);if(this.s$j&&0<this.kVa.count&&this.Dja()&&(gb.a.Va(this.ii.igb)&&(this.ii.igb=Vj.a.create().toString()),(za=ka.a.v7a(this.ii.igb))&&!za.hasChildNodes())){za.style.position=ab.a.absolute;za.style.left=
"0px";za.style.top="0px";for(let Ra of this.kVa.values)t=kb.a.SB(),t.src=Ra,t.style.display=ab.a.block,t.style.position=ab.a.absolute,za.appendChild(t);ka.a.aVb()}return ha}sDi(){this.t4=kb.a.Fn();this.t4.setAttribute("Unselectable","on");this.t4.setAttribute("tabindex","-1");this.t4.setAttribute(oa.a.Ye,oa.a.RKd);this.De.addCssClass(this.t4,"UIFont replaceObjectContainerLink");this.Dja()&&this.la.pptSmartArtSubNodeIconChangeEnabled&&this.la.A8a&&(this.t4.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,
this.Wc.ob(la.a.click,this.t4,Object(r.a)(this,this.x0g,"onLinkClick")));const t=kb.a.Ce();t.appendChild(this.t4);return t}Hma(){this.ro&&(this.Wc.ob(la.a.click,this.ro,Object(r.a)(this,this.onClick,"onClick")),this.A_.addHandler(this.ro,la.a.Xf,Object(r.a)(this,this.cSc,"inputKeyApplyHandler")),this.gp.ob(la.a.pointerOver,this.ro,Object(r.a)(this,this.zC,"onPointerOver")),this.gp.ob(la.a.pointerOut,this.ro,Object(r.a)(this,this.iz,"onPointerOut")))}Loc(){this.ro&&(this.Wc.xb(la.a.click,this.ro,Object(r.a)(this,
this.onClick,"onClick")),this.A_.removeHandler(this.ro,la.a.Xf,Object(r.a)(this,this.cSc,"inputKeyApplyHandler")),this.gp.xb(la.a.pointerOver,this.ro,Object(r.a)(this,this.zC,"onPointerOver")),this.gp.xb(la.a.pointerOut,this.ro,Object(r.a)(this,this.iz,"onPointerOut")))}zC(t){t=this.A3d(t.Ac);this.Osh(t);return!0}iz(t){t=this.A3d(t.Ac);this.rmg(t);return!0}cSc(t){if(this.isVisible&&!t.ctrlKey&&!t.altKey&&(!t.shiftKey||t.keyCode===ma.a.Iq&&this.Dja()))if(t.keyCode===ma.a.lq||t.keyCode===ma.a.NO)t.preventDefault(),
(t=this.ro.querySelector(":focus"))&&t.firstChild.click();else if(t.keyCode===ma.a.Iq&&this.Dja()){const N=this.ro.querySelector(":focus");N&&this.t4&&(N===this.t4?(t.preventDefault(),t.stopPropagation(),this.ww(0,!0)):N.parentNode&&N.parentNode.className&&0<=N.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(t.preventDefault(),t.stopPropagation(),this.ww(this.l0d(),!1),gc.FocusManager.Mr(this.t4)))}}onClick(t){if(t.dA!==Sys.UI.MouseButton.leftButton)return!1;var N=this.A3d(t.Ac);if(!this.Ace(N)||
!this.nQj(N))return!0;t=this.A2i(N);const ha=this.O1b(N);N=this.Rgj(N);gb.a.Va(t)||gb.a.Va(ha)||(t=Object.assign(new Wn.a,{SuggestionSid:parseInt(ha),ShapeId:this.ii.shapeId,CorrelationId:t,ActiveSlideCid:this.ua.Ba.cid,ActiveSlideSid:this.ua.Ba.sid,Label:N,SmartArtSubNodeId:this.ii.r5?this.ii.r5:null,ReplaceObjectType:this.ii.L0}),this.ia.La(vb.a.QNa,2,t));return!0}x0g(){this.ii&&(this.ii.zkc=!0);this.a5d();this.ia.processAction(vb.a.VVb,2);return!0}Osh(t){t&&this.Ace(t)&&(t=this.O1b(t),gb.a.Va(t)||
(t=this.Dja()?this.kVa.Jb(t)?this.kVa.ga(t):"":this.tda.Jb(t)?this.tda.ga(t):"",gb.a.Va(t)||(t=new Pa.a(this.ii.shapeId,t,this.ii.r5),this.rGa.pbh(t))))}rmg(t){t&&this.Ace(t)&&(t=new ra.a(this.ii.shapeId,this.ii.r5),this.rGa.obh(t))}A3d(t){if(!t)throw Error.argumentNull("sourceElement");return"a"===t.nodeName.toLowerCase()?t:t.parentNode}A2i(t){return t?t.parentNode.parentNode.id:null}O1b(t){if(!t)return null;t=t.id.split("_");return 2!==t.length?null:t[1]}Rgj(t){return t?t.title:null}Ace(t){return!!t&&
!gb.a.Va(t.className)&&-1!==t.className.indexOf("ObjectSuggestionContainer")}nQj(t){return!!t&&!gb.a.Va(t.className)&&-1===t.className.indexOf("ReplaceObjectSuggestionLoading")}ggi(t,N){const ha=this.tda.Jb(t);var za=ha?this.tda.ga(t):dh.a.uK(fb.a.Dma);ha||K.a.J(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");const Ra=kb.a.SB();Ra.setAttribute("Unselectable","on");Ra.src=za;Ra.title=N;Ra.setAttribute(oa.a.Ye,oa.a.KM);this.De.addCssClass(Ra,"replaceObjectSuggestionThumbnail");
za=kb.a.vba();za.id="ROS_"+t;za.setAttribute("Unselectable","on");za.title=N;za.setAttribute(oa.a.Ye,"none");let qb=this.Dja()?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";this.ii.XS&&this.ii.sCc.toString()===t&&(qb+="Selected");this.De.addCssClass(za,qb);ha||this.De.addCssClass(za,"ReplaceObjectSuggestionLoading");za.appendChild(Ra);t=this.De.DUf();t.setAttribute("Unselectable","on");t.setAttribute("tabindex","-1");t.setAttribute(oa.a.Ye,oa.a.KM);t.setAttribute(oa.a.Wr,
N);t.appendChild(za);return t}setPosition(t,N){this.zh?(0>t&&(t=0),0>N&&(N=0),this.ro.style.left=this.De.Nc(t),this.ro.style.top=this.De.Nc(N)):K.a.J(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")}setVisibility(t){if(this.ro){if(this.ii)if(t)this.ii.nSe=new Date,this.ii.gdk();else{let N;(N=this.ii).Ymc=N.Ymc+(+new Date-+this.ii.nSe)}this.ro.style.visibility=t?ab.a.visible:ab.a.hidden;this.Ilb=t;this.Fa.Gj(kd.a.XFb,t)}}Mhh(){this.jle=-1}Dja(){return!!this.ii&&
1===this.ii.L0}get uCb(){this.nq&&"undefined"!==typeof this.nq||(this.nq=this.De.Ce(),this.nq.setAttribute("id","ModalDiv"),this.De.addCssClass(this.nq,"cui-modalDiv"),this.nq.setAttribute("Unselectable","on"),document.body.appendChild(this.nq),Ue.a.instance.ob(la.a.pointerDown,this.nq,Object(r.a)(this,this.H9c,"onModalPointerDown")),Ue.a.instance.ob(la.a.XQ,this.nq,Object(r.a)(this,this.I9c,"onModalPointerUp")),Ue.a.instance.ob(la.a.ngc,this.nq,Object(r.a)(this,this.eok,"onModalPointerMove")),Ue.a.instance.ob(la.a.pointerOut,
this.nq,Object(r.a)(this,this.fok,"onModalPointerOut")),n.a.instance.ob(la.a.click,this.nq,Object(r.a)(this,this.dok,"onModalClick")),Y.a.instance.ob(la.a.zCb,this.nq,Object(r.a)(this,this.$xe,"onModalMouseWheel")));return this.nq}H9c(){return!0}I9c(){return this.a5d()}eok(){return!0}fok(){return!0}dok(){return this.a5d()}$xe(){return!0}a5d(){if(!this.ii||!this.ii.slide)return!0;const t=this.ii.shape;if(!t)return!0;this.ia.La(vb.a.VYa,2,Object.assign(new Rl,{action:2,shape:t}));return!0}}Object(h.a)(ub,
"ReplaceObjectSuggestionsGalleryView",null,[673,707]);class wb{constructor(t,N,ha,za){this.G9j=t;this.Vt=N;this.ua=ha;this.la=za}g_i(t){if(!this.ua.Ba)return!1;t=this.ua.Ba.DS(t);return this.xpc(t)}xpc(t){return!(t&&t.get_shapeId()&&t.hasText&&this.Vt.pEa(t))||t.get_shapeRotation()||t.gs||t.q3||t.Ny||!this.G9j.validate(t)?!1:!0}pSj(t){return!Array.contains(this.la.replaceObjectDisabledTriggers,t)}}Object(h.a)(wb,"ReplaceObjectValidationHelper",null,[]);class ec{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc){this.zr=
this.v_=null;this.hr=!1;this.jX=t;this.Wc=N;this.gp=ha;this.YN=za;this.Eda=Ra;this.fe=Qb;this.la=qb;this.p$a=Zc}get zh(){return this.hr}lIc(){this.la.YFb?this.zr.setAttribute("Src",this.fe.hk("BLUEBOLT_Deactivated.gif")):this.zr.style.opacity=".3";this.p$a.Omh(Object(r.a)(this,this.dismiss,"dismiss"))}pJc(){this.la.YFb?this.zr.setAttribute("Src",this.fe.hk("BLUEBOLT_Reactivated.gif")):this.zr.style.opacity="initial";this.p$a.disabled=!1}show(){this.la.YFb?this.zr.setAttribute("Src",this.fe.hk("BLUEBOLT_Entrance.gif")):
this.zr.setAttribute("Src",this.fe.hk("LightningIdeasOOUI_blue_32x.png"))}dismiss(){this.la.YFb?(this.zr.setAttribute("Src",this.fe.hk("BLUEBOLT_Exit.gif")),this.p$a.B4k(()=>{this.jX.xa.style.visibility=ab.a.hidden})):(this.zr.setAttribute("Src",""),this.jX.xa.style.visibility=ab.a.hidden)}setup(){this.zh||(this.jX?(this.v_=new Pb.a,this.v_.xa.style.visibility=ab.a.inherit,this.v_.xa.style.position=ab.a.absolute,this.zr=kb.a.SB(),this.zr.setAttribute("Unselectable","on"),this.zr.setAttribute(oa.a.Ye,
oa.a.KM),this.zr.className="gifFloatie",this.v_.xa.appendChild(this.zr),this.jX.appendChild(this.v_),this.Hma()):K.a.J(38072903,829,15,"parentElement is null"),this.hr=!0)}a0g(t){let N;switch(this.la.replaceObjectIconType){case 7:N="BLUEBOLT_Hover_on.gif";break;case 8:N="BLUEBOLT_HoverWhite_On.gif";break;default:N="BLUEBOLT_Hover_on.gif"}this.zr.setAttribute("Src",this.fe.hk(N));return this.Eda(t)}onBlur(){let t;switch(this.la.replaceObjectIconType){case 7:t="BLUEBOLT_Hover_off.gif";break;case 8:t=
"BLUEBOLT_HoverWhite_Off.gif";break;default:t="BLUEBOLT_Hover_off.gif"}this.zr.setAttribute("Src",this.fe.hk(t));return!0}Hma(){this.YN&&this.Wc.ob(la.a.click,this.zr,this.YN);this.Eda&&(this.gp.ob(la.a.pointerOver,this.zr,Object(r.a)(this,this.a0g,"onHover")),this.gp.ob(la.a.pointerOut,this.zr,Object(r.a)(this,this.onBlur,"onBlur")))}EUe(){this.YN&&this.Wc.xb(la.a.click,this.zr,this.YN);this.Eda&&(this.gp.xb(la.a.pointerOver,this.zr,Object(r.a)(this,this.a0g,"onHover")),this.gp.xb(la.a.pointerOut,
this.zr,Object(r.a)(this,this.onBlur,"onBlur")))}dispose(){this.dismiss();this.EUe();this.hr=!1}}Object(h.a)(ec,"GifFlyoutAnchor",null,[906,707]);class kc{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of){this.zr=this.ov=null;this.jX=t;this.qT=N;this.g4j=ha;this.l4j=za;this.$Jg=Id.replaceObjectIconType;this.VEg=Id.replaceObjectAnimId;this.WEg=Id.YFb;this.BGa=qb;this.Ebc=Ra;this.Wc=Qb;this.gp=vc;this.YN=Zc;this.Eda=Wc;this.De=Md;this.lak=Xe;this.p$a=of;this.hr=!1}get QYb(){return 1===this.lak?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:
this.p$a.disabled?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip}get zh(){return this.hr}setup(){this.zh||(this.ov=new Pb.a,this.zr=this.Ebc.dCi(),this.ov.xa.style.visibility=ab.a.inherit,this.Iha(),this.hr=!0)}lIc(){this.p$a.Omh(Object(r.a)(this,this.dismiss,"dismiss"));this.Bqa();this.Ykc();this.ov.nvi()||this.ov.jr("replaceObjectGrayedFlyoutAnchor")}show(){this.zh?this.Ykc(this.WEg):K.a.J(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")}pJc(){this.p$a.disabled=
!1;this.Bqa();this.Ykc();this.ov.zfb("replaceObjectGrayedFlyoutAnchor")}Ykc(t=!1){this.zh?this.zr.nna(this.k6i(t),""):K.a.J(25306443,829,15,"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")}k6i(t){const N=this.BGa.aRd(this.qT,this.qT,this.g4j,this.l4j,this.QYb,null);this.De.addCssClass(this.ov.xa,"replaceObjectFlyoutAnchorBase");this.De.addCssClass(this.ov.xa,"replaceObjectFlyoutAnchor"+this.$Jg);t&&(this.De.addCssClass(this.ov.xa,"replaceObjectFlyoutAnchorAnimBase"),this.De.addCssClass(this.ov.xa,
"replaceObjectFlyoutAnchorAnim"+this.VEg));return N}Bqa(){this.zh?(this.zr.clear(),this.De.removeCssClass(this.ov.xa,"replaceObjectFlyoutAnchorBase"),this.De.removeCssClass(this.ov.xa,"replaceObjectFlyoutAnchor"+this.$Jg),this.WEg&&(this.De.removeCssClass(this.ov.xa,"replaceObjectFlyoutAnchorAnimBase"),this.De.removeCssClass(this.ov.xa,"replaceObjectFlyoutAnchorAnim"+this.VEg))):K.a.J(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")}dispose(){this.zh&&(this.EUe(),this.ov&&
this.ov.xa.parentNode&&this.ov.qq(),this.dismiss(),this.zr.dispose(),this.ov=null,this.hr=!1)}dismiss(){this.zh?(this.Bqa(),this.jX.xa.style.visibility=ab.a.hidden):K.a.J(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")}Iha(){this.jX?(this.ov.xa.style.width=this.De.Nc(this.qT),this.ov.xa.style.height=this.De.Nc(this.qT),this.ov.xa.setAttribute(oa.a.Ye,oa.a.hu),this.jX.appendChild(this.ov),this.zr.Iha(this.ov.xa),this.Hma()):K.a.J(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")}Tdb(){return!0}Hma(){this.YN&&
this.Wc.ob(la.a.click,this.ov.xa,this.YN);this.Wc.ob(la.a.doubleClick,this.ov.xa,Object(r.a)(this,this.Tdb,"onDoubleClick"));this.Eda&&(this.gp.ob(la.a.pointerOver,this.ov.xa,this.Eda),this.gp.ob(la.a.pointerOver,this.ov.xa.firstChild,this.Eda),this.gp.ob(la.a.pointerOver,this.ov.xa.firstChild.firstChild,this.Eda))}EUe(){this.YN&&this.Wc.xb(la.a.click,this.ov.xa,this.YN);this.Wc.xb(la.a.doubleClick,this.ov.xa,Object(r.a)(this,this.Tdb,"onDoubleClick"));this.Eda&&(this.gp.xb(la.a.pointerOver,this.ov.xa,
this.Eda),this.gp.xb(la.a.pointerOver,this.ov.xa.firstChild,this.Eda),this.gp.xb(la.a.pointerOver,this.ov.xa.firstChild.firstChild,this.Eda))}}Object(h.a)(kc,"ReplaceObjectFlyoutAnchor",null,[906,707]);class bd{constructor(t,N){this.vz=null;this.Zh=t;this.De=N;this.hr=!1}get zh(){return this.hr}get jN(){return this.vz}setup(){this.zh||(this.vz=new Pb.a,this.Iha(),this.hr=!0)}Iha(){this.Zh?(this.Zh.appendChild(this.jN.xa),this.De.addCssClass(this.jN.xa,"replaceObjectPreviewContainer"),this.jN.setVisibility(!1)):
K.a.J(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")}nna(t){if(this.zh){if(t=this.bia(t))this.Oma(),this.jN.xa.appendChild(t),this.jN.setVisibility(!0)}else K.a.J(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")}gh(t,N){this.zh?this.jN.gh(t,N):K.a.J(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")}dispose(){this.zh&&(this.dismiss(),this.jN&&this.jN.xa.parentNode&&(this.jN.qq(),this.De.removeCssClass(this.jN.xa,
"replaceObjectPreviewContainer")),this.vz=null)}dismiss(){this.zh?(this.Oma(),this.jN.setVisibility(!1)):K.a.J(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")}bia(t){if(!gb.a.Va(t)){const N=kb.a.SB();N.setAttribute("Unselectable","on");N.src=t;N.style.height="100%";N.style.width="100%";return N}return null}Oma(){this.jN.xa.firstChild&&this.jN.xa.removeChild(this.jN.xa.firstChild)}}Object(h.a)(bd,"ReplaceObjectPreviewImageView",null,[707]);var Ad=d(677);class Vd{constructor(t,
N,ha,za,Ra,qb,Qb){this.Wc=t;this.gp=N;this.De=ha;this.BGa=za;this.la=Ra;this.fe=qb;this.UIg=Qb}vzi(t,N,ha,za,Ra){t=hn.Jzl(this.la.replaceObjectIconType,Ra)?new ec(t,this.Wc,this.gp,ha,za,this.la,this.fe,this.De,this.UIg):new kc(t,N,"per","PowerPointDesigner_32x32x32",this,this.BGa,this.Wc,this.gp,ha,za,this.De,this.la,Ra,this.UIg);t.setup();return t}eCi(t){t=new bd(t,this.De);t.setup();return t}dCi(){return new Ad.a(this.De)}}Object(h.a)(Vd,"ReplaceObjectViewFactory",null,[]);class df{constructor(t,
N,ha){this.De=t;this.ua=ha;this.BRg=N}$Oc(t){if(!t)throw Error.argumentNull("shape");var N=t.jU;t=this.Gqb(N.TopLeft);N=this.Gqb(N.TopRight);return cc.a.$l(t,N)}ZOc(t){if(!t)throw Error.argumentNull("shape");var N=t.jU;t=this.Gqb(N.TopRight);N=this.Gqb(N.BottomRight);return cc.a.$l(t,N)}B1b(t){return this.$Oc(t)*this.$hg()}A1b(t){return this.ZOc(t)*this.$hg()}ddj(t){if(!t)throw Error.argumentNull("shape");var N=t.jU;t=this.Gqb(N.TopLeft);N=this.Gqb(N.TopRight);return Wb.a.sO(cc.a.pG(t,N))}w8f(){return this.getBounds(this.BRg.Gc.mB)}getBounds(t){return this.De.ei(t)}$hg(){const t=
this.BRg.Gc;return t?t.bW:1}Gqb(t){return new cc.a(t.X,t.Y)}pEa(t){return t?!!this.ua.Ba&&this.ua.Ba.Bb.equals(t.slideId):!1}}Object(h.a)(df,"ReplaceObjectViewHelper",null,[]);var zg=d(429);class Rg{constructor(t,N,ha){this.O_=this.j_=null;this.eT=t;this.D9j=N;this.M3c=ha}get WF(){return"ReplaceObjectWacALWorkflow"}get proto(){return'syntax="proto3";message ShapeTextConvertable { string Topic = 1; string Payload = 2; string AppId = 3; string SessionId = 4; string ContextId = 5; };'}get bpb(){this.j_||
(this.j_=Object.assign(new vk.a,{name:"LambdaBefore_ReplaceObjectWacAL",inputSchema:zg.a.BMe,outputSchema:zg.a.BMe,func:Object(r.a)(this,this.T9a,"lambdaBeforeFunc")}));return this.j_}get rob(){return null}get FFb(){this.O_||(this.O_=Object.assign(new vk.a,{name:"LambdaRemote_ReplaceObjectWacAL",inputSchema:zg.a.BMe,outputSchema:"ShapeTextConvertable",func:Object(r.a)(this,this.vde,"lambdaRemoteFunc")}));return this.O_}T9a(t,N,ha){if(t&&this.D9j.O$d())if(t){try{var za=Ed.a(t.ContextId)}catch(Ra){K.a.J(37041409,
375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.WF);ha(null);return}this.M3c.pSj(za.t)?this.M3c.g_i(za.shapeId)?ha(t):(K.a.J(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.WF),ha(null)):(K.a.J(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.WF),ha(null))}else ha(null),K.a.J(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",this.WF);else K.a.J(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.WF),ha(null)}vde(t,N,ha){t?
t?this.eT.execute(za=>{za.Njc(t.Topic,t.Data,t.ContextId,Ra=>{this.BIa(Ra)},Ra=>{this.zIa(Ra)},ha)}):ha(null):ha(null)}BIa(t){if(!v.AFrameworkApplication.Vg&&t&&t.data){var N=t.data.state;if(N){try{var ha=Ed.a(t.data.Sd)}catch(za){N(null);K.a.J(36804442,375,10,"Try parse aug response failed:{0}",za.message);return}N(ha)}}}zIa(t){!v.AFrameworkApplication.Vg&&t&&t.data&&(t=t.data.state)&&t(null)}}Object(h.a)(Rg,"ReplaceObjectWacALWorkflow",null,[708]);class hh{constructor(){this.wve=null}xpc(t){return this.validate(t)?
this.wve?this.wve.xpc(t):!0:!1}E5k(t){this.wve=t}}Object(h.a)(hh,"ReplaceObjectWall",null,[]);class ph extends hh{constructor(){super();this.Vt=null}Bfg(t){const N=this.Vt.B1b(t);t=this.Vt.A1b(t);var ha=N*t;const za=this.Vt.w8f().width,Ra=this.Vt.w8f().height;ha=ha/(za*Ra)*100;K.a.J(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",N,t,za,Ra,ha);return ha}}Object(h.a)(ph,"AreaRatioWall",hh,[]);class dg extends ph{constructor(t,
N){super();this.d7j=t;this.Vt=N}validate(t){return this.Bfg(t)<=this.d7j}}Object(h.a)(dg,"MaxAreaRatio",ph,[]);class Zj extends hh{constructor(t,N){super();this.a7j=t;this.Vt=N}validate(t){return this.Vt.A1b(t)<=this.a7j}}Object(h.a)(Zj,"MaxShapeHeight",hh,[]);class ek extends hh{constructor(t,N){super();this.f7j=t;this.Vt=N}validate(t){return this.Vt.B1b(t)<=this.f7j}}Object(h.a)(ek,"MaxShapeWidth",hh,[]);class Zh extends ph{constructor(t,N){super();this.r7j=t;this.Vt=N}validate(t){return this.Bfg(t)>=
this.r7j}}Object(h.a)(Zh,"MinAreaRatio",ph,[]);var Vk=d(36);class Om extends hh{constructor(t,N){super();this.q7j=t;this.Ea=N}validate(t){return this.waj(t,this.Ea)>=this.q7j}waj(t,N){if(!t)return 0;let ha=0;N.kJ(t,za=>{za.Sa(Vk.a.iq)&&(za=za.getValue(Vk.a.iq))&&0<za.length&&ha++});return ha}}Object(h.a)(Om,"MinParagraphCount",hh,[]);class Xn extends hh{constructor(t,N){super();this.o7j=t;this.Vt=N}validate(t){return this.Vt.A1b(t)>=this.o7j}}Object(h.a)(Xn,"MinShapeHeight",hh,[]);class Hh extends hh{constructor(t,
N){super();this.u7j=t;this.Vt=N}validate(t){return this.Vt.B1b(t)>=this.u7j}}Object(h.a)(Hh,"MinShapeWidth",hh,[]);class Lo{constructor(t,N,ha){this.Zda=null;this.la=t;this.Ea=N;this.eCb=ha;this.init(this.la.replaceObjectClientWalls)}validate(t){return this.Zda?this.Zda.xpc(t):!0}init(t){t=this.cEi(t);this.Ahi(t)}cEi(t){const N={};if(gb.a.Va(t))return N;t=t.split(";");for(const ha of t)gb.a.Va(ha)||(t=ha.split(":"),2===t.length?N[t[0]]=t[1]:K.a.J(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",
ha));return N}Ahi(t){const N=[];"MinParagraphCount"in t&&Array.add(N,new Om($b.d(t,"MinParagraphCount",0),this.Ea));"MinShapeHeight"in t&&Array.add(N,new Xn($b.b(t,"MinShapeHeight",0),this.eCb));"MaxShapeHeight"in t&&Array.add(N,new Zj($b.b(t,"MaxShapeHeight",Number.MAX_VALUE),this.eCb));"MinShapeWidth"in t&&Array.add(N,new Hh($b.b(t,"MinShapeWidth",0),this.eCb));"MaxShapeWidth"in t&&Array.add(N,new ek($b.b(t,"MaxShapeWidth",Number.MAX_VALUE),this.eCb));"MinShapeAreaRatio"in t&&Array.add(N,new Zh($b.b(t,
"MinShapeAreaRatio",0),this.eCb));"MaxShapeAreaRatio"in t&&Array.add(N,new dg($b.b(t,"MaxShapeAreaRatio",Number.MAX_VALUE),this.eCb));for(t=0;t<N.length-1;t++)N[t].E5k(N[t+1]);0<N.length&&(this.Zda=N[0])}}Object(h.a)(Lo,"ReplaceObjectWalls",null,[674]);class Pm{constructor(){this.K=null;this.aX=this.Jme=this.sne=!1}get name(){return"PowerPointWebEditor.ReplaceObject"}Wb(t){this.K=t;(this.aX=this.K.resolve("PowerPointWebEditor.IApplicationContext").ld.tg)&&this.K.register(hj.a,"PowerPointWebEditor.PodsInfoSender").ma().na(()=>
new hj.a(v.AFrameworkApplication.Ge,this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.IErrorHandler"),this.K.resolve("Common.ITaskManager"),this.K.resolve("Common.IAppSettingsManager")));t.register(Ab,"PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventSource").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier").as("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers").ma().na(()=>
new Ab);t.register(df,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper").ma().na(()=>new df(t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.IActiveSlideViewManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager")));t.register(673,"PowerPointWebEditor.IReplaceObjectGalleryView").ma().na(()=>new ub(t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("Common.IPointerInputManager"),t.resolve("Common.IClickInputManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),
t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.IInputHandlerManager"),t.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("Common.IBrowserUtils")));t.register(674,"PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls").ma().na(()=>
new Lo(t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IShapeReader"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")));t.register(wb,"PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper").ma().na(()=>new wb(t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.IApplicationSettings")));
t.register(675,"PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager").ma().na(()=>new jd(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.IApplicationSettings").keepCalculateZoomInNativeConsistentWithClientFixIsEnabled));t.register(676,"PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager").ma().na(()=>t.resolve("Common.IAppSettingsManager").ka("473")?new mc((N,ha,za,
Ra,qb,Qb)=>{const vc=new Ia(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.Ka("PowerPointWebEditor.IDesignerServiceProvider"));vc.SOa(N,ha,za,Ra,qb,Qb);return vc}):new he(new Ia(t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.Ka("PowerPointWebEditor.IDesignerServiceProvider"))));t.register(677,"PowerPointWebEditor.IReplaceObjectManager").ma().na(()=>t.resolve("Common.IAppSettingsManager").ka("473")?new jp(t.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),
t.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),
t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager"),t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),
t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("Common.ITaskManager"),t.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),t.Ka("PowerPointWebEditor.IDesignerServiceProvider")):new Ob(t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),
t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),
t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("Common.ITaskManager"),t.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),t.Ka("PowerPointWebEditor.IDesignerServiceProvider")));t.register(Ec,
"PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").ma().na(()=>new Ec(t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>"),t.resolve("PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventHandlers"),
t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),t.resolve("PowerPointWebEditor.IReplaceObjectGalleryView"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("Box4.IPageView").Ma,t.resolve("PowerPointWebEditor.IShapeReader")));t.register(hn,"PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer").ma().na(()=>new hn(t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("Common.ITaskManager")));t.register(Vd,"PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory").ma().na(()=>
new Vd(t.resolve("Common.IClickInputManager"),t.resolve("Common.IPointerInputManager"),t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.ShapePresence.IShapeGlyphImageFactory"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPoint.IPathManager"),t.resolve("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer")));t.register(488,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectView>").ma().na(()=>new ce.a((N,
ha)=>{let za=null;const Ra=Object(Q.a)(121,N.oc(t.resolve("Box4.IPageView").Ma));Ra&&!Ra.ll&&Ra.nU&&(za=new Eb(N,Ra,ha,t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPoint.IBrowserHelperManager"),t.resolve("PowerPointWebEditor.ViewElements.IViewElementEventHandlers"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),
t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.IReplaceObjectGalleryView")),za.setup());return za}));t.register(488,"PowerPointWebEditor.ViewElements.IShapeComponentViewManager<PowerPointWebEditor.IShapeReplaceObjectSuggestionPreviewView>").ma().na(()=>new ce.a((N,ha)=>{let za=null;const Ra=Object(Q.a)(121,N.oc(t.resolve("Box4.IPageView").Ma));Ra&&!Ra.ll&&Ra.nU&&(za=new ee(N,Ra,ha,t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper")),
za.setup());return za}));t.register(Rg,"PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow").as("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow").ma().na(()=>new Rg(this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugmentationManager"),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager"),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper")));t.register(U,"PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").ma().na(()=>new U(this.K.Ka("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopRuntimeManager"),
this.K.resolve("PowerPointWebEditor.AugmentationLoop.IPPTAugLoopWorkflow")));t.register(z,"PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").ma().na(()=>new z(t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("Common.IActionManagerExtended"),t.resolve("PowerPointWebEditor.IFocusManager"),t.resolve("PowerPointWebEditor.Graph.IGraphOperationEventHandlers"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingManager"),
t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectEventNotifier"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("Common.Transaction.ITransactionFactory"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.View.IPPTPageView"),t.resolve("PowerPointWebEditor.IShapeReader")));t.register(In,"PowerPointWebEditor.ReplaceObject.ReplaceIconManager").ma().na(()=>
new In(t.resolve("PowerPointWebEditor.IPptSelectionManager"),t.resolve("PowerPointWebEditor.View.IViewEventSource"),t.resolve("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager"),t.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),t.resolve("PowerPointWebEditor.IShapeReader"),t.resolve("PowerPointWebEditor.IApplicationSettings"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter"),t.resolve("PowerPointWebEditor.Storage.IOutboundHelper"),t.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper"),
t.resolve("PowerpointPresence.IPresenceEventHandlers"),t.resolve("PowerPointWebEditor.IGraphActionBlockingEventHandlers"),t.resolve("PowerPointWebEditor.GraphActionBlocking.IGraphActionBlockingStatusChecker"),t.resolve("PowerPointWebEditor.UndoRedo.IUndoEventHandlers"),t.resolve("PowerPointWebEditor.IActionNameResolver"),t.resolve("PowerPointWebEditor.Core.IUnifiedAppState")))}init(){this.aX&&this.K.resolve("PowerPointWebEditor.PodsInfoSender");const t=this.K.resolve("Common.IAppSettingsManager");
t.ff(()=>{const N=new Date;t.getBooleanFeatureGate("Microsoft.Office.PowerPointOnline.TestEcsFeatureIsEnabled",!1)?K.a.J(512262752,324,50,"PPTO TestEcsFeature Client Flight Enabled."):K.a.J(512262751,324,50,"PPTO TestEcsFeature Client Flight Disabled.");if(this.sne=t.ka("463"))t.ka("499")&&this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager").initialize(),this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").setup();if(this.Jme=t.ka("676"))this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").setup(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").setup();K.a.J(512262750,829,
50,"ReplaceObject::Callback duration:{0}",+new Date-+N)})}dispose(){this.sne&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.IReplaceObjectManager").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose());this.Jme&&(this.K.resolve("PowerPointWebEditor.IReplaceObjectGalleryView").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter").dispose(),
this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor").dispose(),this.K.resolve("PowerPointWebEditor.ReplaceObject.ReplaceIconManager").dispose())}static main(){e.a.instance.Bc(hc.a(new Pm,0))}}Object(h.a)(Pm,"PPTWebEditorReplaceObjectPackage",null,[2,3]);var jn=d(269),Mo=d(386),Ep=d(1043);class kp{constructor(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=
null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}}Object(h.a)(kp,"AppSettings",null,[]);class Al{constructor(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=
null}}Object(h.a)(Al,"ControllerFactoryParameters",null,[]);var Fp=d(714),Kn=d(324);class ji{}ji.none="None";ji.vhFailedToLoadVersionList="VHFailedToLoadVersionList";ji.vhFailedToGetDownloadToken="VHFailedToGetDownloadToken";ji.vhFailedToParseVersionList="VHFailedToParseVersionList";ji.vhFetchFailed="VHFetchFailed";ji.vhVersioningNotEnabled="VHVersioningNotEnabled";ji.vhFileNotFound="VHFileNotFound";ji.vhVersionTooOld="VHVersionTooOld";ji.DBl="VHFailedToRenderThumbnails";ji.CBl="VHFailedToRenderSlide";
ji.BBl="VHFailedToRenderNotes";ji.zBl="VHFailedToRenderDiff";ji.EBl="VHFailedToShowAnimaitonIcon";ji.FBl="VHFailedToShowHiddenEffect";ji.ABl="VHFailedToRenderInitPresInfo";Object(h.a)(ji,"ErrorName",null,[]);class em{constructor(){this.DGa=new ud.a;this.DGa.add(0,ji.none);this.DGa.add(100,ji.vhFailedToLoadVersionList);this.DGa.add(101,ji.vhFailedToGetDownloadToken);this.DGa.add(102,ji.vhFailedToParseVersionList);this.DGa.add(103,ji.vhFetchFailed);this.DGa.add(104,ji.vhVersioningNotEnabled);this.DGa.add(105,
ji.vhFileNotFound);this.DGa.add(106,ji.vhVersionTooOld);this.$Ga=new ud.a;this.$Ga.add(0,ji.none);this.$Ga.add(100,ji.DBl);this.$Ga.add(101,ji.CBl);this.$Ga.add(102,ji.BBl);this.$Ga.add(103,ji.zBl);this.$Ga.add(104,ji.EBl);this.$Ga.add(105,ji.FBl);this.$Ga.add(106,ji.ABl)}get l$k(){return this.DGa}get TBl(){return this.$Ga}static Rfg(){em.EIe||(em.EIe=new em);return em.EIe}}em.XLf="ErrorCode";em.EIe=null;Object(h.a)(em,"VersionHistoryTelmetryHelper",null,[]);class Bl{constructor(t,N,ha,za,Ra,qb,Qb,
vc,Zc,Wc,Md,Id,Xe,of,ih,Aj,$f){this.Vcc=this.YD=this.hJg=this.c3c=this.$xb=this.C3=this.$se=this.sX=this.SG=null;this.Pta=-1;this.Eyb=null;if(!$f)throw Error.argumentNull("clientRequestManager");this.ia=t;this.jw=N;this.yi=ha;this.Ha=za;this.uc=Ra;this.PVa={};this.Fa=qb;this.lh=Qb;this.pBb={};this.jc=Zc;this.c6c={};this.I8j=vc;this.Hda=Wc;this.Xa=Md;this.Ahe=[];Id&&(this.hJg=Id,this.hJg.execute(Oi=>{this.YD=Oi}));this.gT=Xe;this.kh=of;this.vge=ih;this.r5c=Aj;this.ew=$f}ub(){this.ia.ya(F.a.MOe,D.a.frame,
Object(r.a)(this,this.Ifl,"showVersionHistoryDialogAction"));this.Ha.pptEnablePreviousVersionsOptionForOneDriveConsumer||this.ia.ya(vb.a.N7g,D.a.frame,Object(r.a)(this,this.sBe,"pptoShowFileVersion"));this.ia.ya(vb.a.sBl,D.a.frame,Object(r.a)(this,this.nsj,"handleVersionHistoryCopySlides"))}Ifl(t,N,ha){if(1===ha)return t=!1,this.Xa.Gca&&(t=!0),t?2:32;2===ha&&(v.AFrameworkApplication.DN("Microsoft.Office.Server.Powerpoint.Web.IDocsPptPPTVersionHistorySaveACopyOverFlowMenuSettings"),v.AFrameworkApplication.DN("Microsoft.Office.Server.Powerpoint.Web.IDocsPptVersionHistoryDeleteVersions"),
this.Vcc=Be.a.create().toString(),m.ULS.sendTraceTag(512508634,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.Vcc),Hb.c(vb.a.Zsk,!0),this.PVa.VersionHistoryLaunchSessionId=this.Vcc,this.pBb.VersionHistoryLaunchSessionId=this.Vcc,this.PVa.ShowVersionHistoryDialog=(new Date).getTime().toString(),this.c3c=[],this.SG||(this.SG=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new Al,{ulsLogger:new Mo.a,serviceBase:this.Ha.getSetting("VersionHistoryWebServiceBase"),
latestStreamServiceBase:this.Ha.ka("PPTVHPodsBootEnabled")?this.Ha.getSetting("PODSLatestServiceBase")+"&PodSID="+this.Ha.getSetting("PodSID"):"",docId:v.AFrameworkApplication.hh,appSettings:Object.assign(new kp,{appName:100,wdEnableDownloadTokens:!0,retryCount:this.Ha.getSetting("PodVHRetryCount"),wdEnableSaveACopy:this.jc.un,wdEnableRestore:this.jc.un,userSessionId:v.AFrameworkApplication.userSessionId,wacCluster:this.Ha.Ga("WacCluster"),uiLocale:this.Ha.UHa?this.Ha.UHa:"en-us",isRtl:v.AFrameworkApplication.isRtl,
disabledChangeGates:this.Ha.Ga("VHSDisabledChangeGates"),wdEnableSaveACopyOverFlowMenu:this.Ha.ka("PPTVersionHistorySaveACopyOverFlowMenuIsEnabled"),wdEnableDeleteVersions:this.Ha.ka("PPTVersionHistoryDeleteVersionsIsEnabled")}),perfTelemetryInfos:this.c3c}))),this.SG&&this.SG.setDisableSaveACopy(v.AFrameworkApplication.lJ),this.Jfl());return 32}sBe(t,N,ha){return 1===ha&&this.Xa.Gca?2:this.ia.processAction(F.a.PNe,ha)}nsj(t,N,ha){if(1===ha)return this.jrh()?2:32;this.sX.onCopySlides();return 32}Jfl(){var t;
if(!document.getElementById("VersionHistoryOverlay")){this.uNk();this.qNk();this.rNk();this.lNk();this.jNk();this.pNk();this.oNk();this.mNk();const N=document.createElement("div");N.id="VersionHistoryOverlay";N.style.width="100%";N.style.zIndex="998";N.style.display="block";N.style.position="absolute";N.style.top="0px";if(this.Ha.ka("RegionComposerIsEnabled")){const ha=(null===(t=document.getElementById("HeaderRegion"))||void 0===t?void 0:t.offsetHeight)||0;N.style.top=ha+"px";N.style.bottom="0px";
N.style.height=`calc(100vh - ${ha}px)`}else N.style.height="calc(100% + "+ua.AFrame.mkd+"px)";document.getElementById("WACInnerFrame").appendChild(N);this.$se=this.SG.createVersionHistoryDialog(N);this.chb()}document.getElementById("VersionHistoryOverlay").style.display="block";this.SG.getTipVersion&&this.Ha.ka("PPTVHPodsBootEnabled")&&this.SG.getTipVersion();this.SG.getVersions("");this.r0h()}r0h(){try{this.Eyb=this.I8j.V2i();for(let t=0;t<this.Eyb.length;t++)this.lh.zo(this.Eyb[t]);this.lh.lK(kd.a.ypc)}catch(t){m.ULS.sendTraceTag(512508633,
822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",t)}}nFi(){try{if(this.Eyb)for(let t=0;t<this.Eyb.length;t++)this.lh.lK(this.Eyb[t]);else m.ULS.sendTraceTag(512508632,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");this.lh.zo(kd.a.ypc)}catch(t){m.ULS.sendTraceTag(512508631,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",t)}}uNk(){this.SG.getFullAppErrorEvent().addListener(t=>{try{const N=em.Rfg().l$k.ga(t);this.pBb[em.XLf]=
N;m.ULS.sendTraceTag(512508630,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",N,this.Vcc)}catch(N){m.ULS.sendTraceTag(512508629,822,10,"Exception in FullAppErrorEvent call back: {0}.",N)}})}qNk(){this.SG.getVersionsReadyEvent().addListener(t=>{this.Fhh(t.containerDiv);this.A4h(t.versions);this.Fa.NX("VersionHistoryOverlay",!0);try{this.C3&&this.C3.DownloadUrl.length&&this.sX&&(this.KGh(),this.uog(),this.sX.onVersionSelected(this.C3,this.$xb,this.PVa),this.UPf())}catch(N){m.ULS.sendTraceTag(512508628,
822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",N)}})}A4h(t){const N=this.sX.getAppDataStore();for(const ha of t)N.AddVersionInfoToStore(ha)}rNk(){this.SG.getVersionSelectedEvent().addListener(t=>{this.C3=t.currentVersion;this.$xb=t.baseVersion;if(this.sX&&this.C3.DownloadUrl.length)try{this.KGh(),this.uog(),this.sX.onVersionSelected(t.currentVersion,t.baseVersion,this.PVa),this.JOk(),this.UPf()}catch(N){m.ULS.sendTraceTag(512508627,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",
N)}})}JOk(){const t=this.g2b(2);t&&(zd.a.addHandler(t,la.a.Xf,Object(r.a)(this,this.Lz,"keyDownHandler")),sc.a.instance.ob(t,Object(r.a)(this,this.PB,"contextMenuHandler")))}Iul(){const t=this.g2b(2);t&&(zd.a.removeHandler(t,la.a.Xf,Object(r.a)(this,this.Lz,"keyDownHandler")),sc.a.instance.xb(t,Object(r.a)(this,this.PB,"contextMenuHandler")))}Lz(t){try{if(t.shiftKey&&t.keyCode===ma.a.coa||t.keyCode===ma.a.xKa){const N=Ep.a.create(la.a.contextMenu,t,1);this.PB(N)}}catch(N){m.ULS.sendTraceTag(512508626,
822,10,"VersionHistoryPaneActor:  Exception in KeyDownHandler: {0}",N)}}PB(t){if(1===t.Wf){const N=this.g2b(2);N&&(t.clientPoint.x=gd.a.mMc(N)+fb.a.Kqa,t.clientPoint.y=gd.a.nMc(N)+fb.a.Kqa)}return 32===this.ia.La(vb.a.JSf,2,t)}lNk(){this.SG.getDownloadTokenReadyEvent().addListener(t=>{try{if(m.ULS.sendTraceTag(512508625,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),this.$xb)if(t&&t.updatedVersions&&2<=t.updatedVersions.length){let N=null,ha=null;const za=Bl.r1b(this.C3),Ra=
Bl.r1b(this.$xb);for(const qb of t.updatedVersions){const Qb=Bl.r1b(qb);za===Qb?N=qb:Ra===Qb&&(ha=qb);if(N&&ha)break}N&&ha?(this.C3=N,this.$xb=ha,this.sX.diff(this.C3,this.$xb)):m.ULS.sendTraceTag(512508623,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",za,Ra)}else m.ULS.sendTraceTag(512508622,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
else m.ULS.sendTraceTag(512508624,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(N){m.ULS.sendTraceTag(512508621,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",N)}})}pNk(){this.SG.getSaveACopySelectedEvent().addListener(t=>{m.ULS.sendTraceTag(512508620,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",t);this.Ha.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&Bl.uik();let N=
v.AFrameworkApplication.Pwb;this.Ha.ka("VHSaveACopyForOdcOnSpoEnabled")&&(N=32===this.ia.processAction(vb.a.Ebd,1));t=N?this.ia.La(vb.a.Ebd,2,{["FileDownloadUrl"]:t}):this.ia.La(F.a.hgb,2,{["FileDownloadUrl"]:t});32!==t?(Hb.c(vb.a.mQf,!1),m.ULS.sendTraceTag(512508619,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",t)):Hb.c(vb.a.mQf,!0)})}Nzh(t,N){try{(new Promise((ha,za)=>{this.SG.setRestoreInProgress();this.Hda.bFc(this.Xa.Bk,this.Xa.podSessionId,this.Xa.presentationId.string,this.Ha.getSetting("361"),
this.Xa.h$,!1,!0,()=>{ha(!0)},Ra=>{za("ClosePopWacSessionSync:: "+Ra.error.message)})})).then(()=>{(new Promise((ha,za)=>{this.Hda.xfd(this.Xa.presentationId.string,t,()=>{ha(!0)},Ra=>{za("RestoreFileVersion:: "+Ra.error.message)})})).then(()=>{const ha=Date.now()-N;m.ULS.sendTraceTag(512508618,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",ha);this.pBb.RestoreSucceededTime=ha;this.ia.La(vb.a.refresh,2,{["IsSourceVH"]:!0});Hb.c(vb.a.VEc,!0)}).catch(ha=>
{const za=Date.now()-N;this.SG.setRestoreFailedAtServer(()=>{this.ia.La(vb.a.refresh,2,{["IsSourceVH"]:!0})});m.ULS.sendTraceTag(512508617,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",ha,za);this.pBb.RestoreFailedTime=za;Hb.c(vb.a.VEc,!1)})})}catch(ha){m.ULS.sendTraceTag(512508616,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",ha.message),Hb.c(vb.a.VEc,!1)}}oNk(){this.SG.getRestoreVersionSelectedEvent().addListener(t=>{m.ULS.sendTraceTag(512508615,
832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",t);const N=Date.now();this.YD?(this.Ahe=this.YD.g0b(),0<this.Ahe.length?(m.ULS.sendTraceTag(512508614,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",this.Ahe.length),Hb.c(vb.a.VEc,!1),this.SG.setCoauthRestoreError(),this.Ha.ka("PPTVersionHistoryRestoreSurveyEnabled")&&Bl.sUj()):this.Nzh(t,N)):(m.ULS.sendTraceTag(512508613,832,10,"VersionHistoryPaneActor: presence manager is null"),this.Nzh(t,
N))})}mNk(){this.SG.getDownloadVersionSelectedEvent().addListener(t=>{m.ULS.sendTraceTag(512508612,832,50,"VersionHistoryPaneActor: RegisterForDownloadVersionSelectedEvent called");t=new Zi.QueryStringBuilder(t);t.Ti(Ci.a.m5g,v.AFrameworkApplication.fileName);t=this.ia.La(F.a.downloadACopy,2,{["FileDownloadUrl"]:t.toString()});32!==t?(Hb.c(vb.a.lQf,!1),m.ULS.sendTraceTag(512508611,832,10,"Download version failed with result: {0}",t)):Hb.c(vb.a.lQf,!0)})}KGh(){for(const t of this.c3c){const N=t.TelemetryEventKey?
t.TelemetryEventKey:t.telemetryEventKey?t.telemetryEventKey:"",ha=t.TelemetryEventData?t.TelemetryEventData:t.telemetryEventData?t.telemetryEventData:"";gb.a.Va(N)||gb.a.Va(ha)||(this.PVa[N]=ha)}}UPf(){this.c3c=[];this.PVa={}}jNk(){this.SG.getCloseSelectedEvent().addListener(()=>{this.Ha.ka("PowerPointVersionHistoryFloodGateIsEnabled")&&Bl.rUj();this.FQf()})}FQf(){this.nFi();this.Fa.R4("VersionHistoryOverlay");document.getElementById("VersionHistoryOverlay").style.display="none";this.Ha.OJf&&(this.C3=
null);m.ULS.sendTraceTag(512508610,822,50,Ed.c(this.pBb))}Fhh(t){try{if(this.sX)wi.setIsPageLoadForFirstTime(!1),this.sX.switchParentViewContainer(t);else{wi.setIsPageLoadForFirstTime(!0);const N=new PowerPointVersionHistory.AppBootSettings;N.RenderServiceBase="";N.IsRtl=v.AFrameworkApplication.isRtl;const ha=new PowerPointVersionHistory.AppCallbackBag;ha.animationDecoratorCallback=Object(r.a)(this.jw,this.jw.IQd,"createAnimationOrTransitionStar");ha.notesIconDecoratorCallback=Object(r.a)(this,this.dBi,
"createNotesIcon");ha.addToF6LoopCallback=Object(r.a)(this,this.i4h,"addToF6Loop");ha.copySlideCallback=Object(r.a)(this,this.copySlideCallback,"copySlideCallback");ha.reportViewerErrorCallback=za=>{this.pBb[em.XLf]=em.Rfg().TBl.ga(za);106!==za&&103!==za||this.SG.setViewerError(!0);m.ULS.sendTraceTag(512508609,822,50,"Versions viewer error: {0}",za);0!==za&&(v.AFrameworkApplication.jp(M.a.Qh(406)),pf.Health.instance.recordQosError("VersionHistoryFailed",["VersionHistoryACE"],!1,!1,!0,!1,null));return!0};
N.IsHighContrast=!1;this.yi&&(N.IsHighContrast=this.yi.isInHighContrastMode);N.IsHighContrast&&(N.ClientColorSettings=this.yi.highContrastColors.foregroundTextColor+"_"+this.yi.highContrastColors.backgroundColor+"_"+this.yi.highContrastColors.linkColor);if(this.uc){const za=this.uc.cRa();N.DefaultSlideWidth=za.width;N.DefaultSlideHeight=za.height}N.UserSessionId=v.AFrameworkApplication.userSessionId;N.VersionViewerCssUrl=this.Ha.versionHistoryViewerCssUrl;N.ProgressImageResourceUrl=dh.a.uK(fb.a.Dma);
N.ThumbnailShareOptimizationEnabled=this.Ha.pptvhThumbnailShareOptimizationEnabled;N.SlidePrefetchSettings=Object.assign(new PowerPointVersionHistory.SlidePrefetchSettings,{SlidePrefetchEnabled:this.Ha.ka("PPTVHSlidePrefetchEnabled"),SlidePrefetchAhead:this.Ha.getSetting("PPTVHSlidePrefetchAhead"),SlidePrefetchBehind:this.Ha.getSetting("PPTVHSlidePrefetchBehind"),SlidePrefetchChunkSize:this.Ha.getSetting("PPTVHSlidePrefetchChunkSize"),SlidePrefetchDelay:this.Ha.getSetting("PPTVHSlidePrefetchDelay")});
N.FileExtension=void 0!==this.Ha.THa&&null!==this.Ha.THa?gb.a.WV(this.Ha.THa).toLowerCase():"";N.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;N.NotesButtonLabel=ResourceStrings.L_Notes;N.SynchronizerTimeout=this.Ha.getSetting("PptVersionHistorySynchronizerTimeout");N.IsRtl=v.AFrameworkApplication.isRtl;N.IsCopySlidesEnabled=!0;N.SlidePaneLabel=ResourceStrings.L_SlidePaneLabelVH;N.ThumbnailPaneLabel=ResourceStrings.L_ThumbnailPaneLabelVH;N.NotesPaneLabel=ResourceStrings.L_NotesPaneLabelVH;
N.StatusBarLabel=ResourceStrings.L_StatusBarLabelVH;N.Lcid=v.AFrameworkApplication.lcid;N.EnableOverflowXOnSlideAndNotePane=this.Ha.ka("PodVHEnableOverflowXOnSlideAndNotePane");N.ThumbnailInfoLabel=ResourceStrings.L_ThumbnailInfoLabelVH;N.IsModernCatchUpUxEnable=!0;N.IsRevisionTrackingFlyoutEnabled=dd.a("EnableRevisionTrackingFlyoutForVH");N.RevisionTrackingFlyoutContent=ResourceStrings.l_SlideIsChanged;this.sX=new PowerPointVersionHistory.AppVersionController(N,t,ha)}}catch(N){this.SG.setViewerError(!0),
m.ULS.sendTraceTag(512508608,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",N)}}dBi(){return Ga.createClusteredImage(14,14,"ToolbarNotesActiveDark_14x14x32",null,!0,ResourceStrings.L_Notes)}chb(){const t=this.Fa.Dc("VersionHistoryOverlay");t.parent=ua.AFrame.jj;t.cL=!0;t.IHe=!0;t.$aa(N=>{N&&"dialog/modal"===N.name?this.SG.setSaveACopyCanceled():N&&N.name===ua.AFrame.tO||(this.Pta=-1,this.JAh(!0))});this.lh.P1("VersionHistoryOverlay");this.lh.blc(kd.a.ypc,
N=>{this.JAh(N)});this.lh.uHb(kd.a.ypc,()=>{2===this.Pta&&Sys.UI.DomElement.addCssClass(this.g2b(2),"PPTVHViewerElementSelected");3===this.Pta&&Sys.UI.DomElement.addCssClass(this.g2b(3),"PPTVHViewerElementSelected")})}JAh(t){try{const N=this.JPc();(this.Pta=this.v$i(t))?1===this.Pta?this.$se.then(ha=>{ha.enterHeaderFocusTrapZone();return null}):N&&gc.FocusManager.Mr(document.getElementById(N[this.Pta])):this.$se.then(ha=>{ha.enterFocusTrapZone();return null})}catch(N){m.ULS.sendTraceTag(512508579,
822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",N)}}v$i(t){const N=this.JPc();let ha=this.Pta;do if(t?N&&(ha=(ha+1)%N.length):N&&(ha=0<ha?ha-1:N.length-1),!ha||1===ha||N&&"none"!==document.getElementById(N[ha]).style.display)return ha;while(ha!==this.Pta);return 0}uog(){const t=Bl.r1b(this.C3);this.c6c[t]||(this.c6c[t]=["VersionListPane","vhHeader"],this.Pta=-1)}JPc(){if(!this.C3)return this.Ha.OJf?["VersionListPane","vhHeader"]:null;const t=Bl.r1b(this.C3);return this.c6c[t]?
this.c6c[t]:null}g2b(t){const N=this.JPc();return N&&N.length>t?document.getElementById(N[t]):null}i4h(t){try{const N=this.JPc();N&&N.push(t)}catch(N){m.ULS.sendTraceTag(512508578,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",N)}return!0}copySlideCallback(t){if(this.jrh())return!1;const N=Be.a.create().toString();m.ULS.sendTraceTag(512508577,832,50,"Execute CopySlideCallback - correlationid : {0}",N);const ha=this.gT.SQd(1,t.SlideIds.length),za={};za.WacSessionId=v.AFrameworkApplication.userSessionId;
za.CallerCorrelationId=N;var Ra={};Ra.Source=t.Source;Ra.SlideIds=t.SlideIds;Ra.CcpId=ha.Np;Ra.PackageAccessKey=ha.kz;t=JSON.stringify(Ra);Ra=String.format("{0}{1}",this.Ha.podsWebServiceBase,"vhcopyslide.ashx");const qb=Date.now();try{if(this.ew.yj(Ra,2,t,za,!1,0,Qb=>{Bl.yBl(Qb,qb,N)},Qb=>{Bl.xBl(Qb,qb,N)},null,null),this.kh.contentWindow&&this.kh.contentWindow.document&&this.kh.contentWindow.document.body){kb.a.MEc(this.kh);const Qb=kb.a.vba();Qb.innerText=kb.a.fXg;Qb.setAttribute(Kn.a.Np,ha.Np);
Qb.setAttribute(Kn.a.BE,ha.BE);Qb.setAttribute(Kn.a.count,ha.objectCount.toString());const vc=Fp.a(ha.dataType);Qb.setAttribute(Kn.a.type,vc);Qb.setAttribute(Kn.a.location,ha.location);Qb.setAttribute(Kn.a.kz,ha.kz);this.kh.contentWindow.document.body.appendChild(Qb);this.vge.mgb(this.kh);this.r5c.copy(this.kh)}else m.ULS.sendTraceTag(512508576,832,10,"VersionHistoryPaneActor cannot set minimal HTML metadata to system clipboard ")}catch(Qb){m.ULS.sendTraceTag(512508575,832,10,"VersionHistoryPaneActor exception in CopySlideCallback: {0}",
Qb)}return!0}jrh(){return v.AFrameworkApplication.fa.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RestrictCopyWithIRMEnabled",!1)?(v.AFrameworkApplication.rO||v.AFrameworkApplication.lJ)&&!v.AFrameworkApplication.KPa:!1}dispose(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&this.FQf();this.Iul()}static r1b(t){return t.RevisionID?t.RevisionID:t.revisionID?t.revisionID:""}static yBl(t,N,ha){const za=Date.now();try{JSON.parse(t.data.Sd).IsCopied?
m.ULS.sendTraceTag(512508574,832,50,"VhCopySlide operation succeeded : Duration : {0}, correlationId : {1}",za-N,ha):m.ULS.sendTraceTag(512508573,832,10,"VhCopySlide operation failed : Duration : {0}, correlationId : {1}",za-N,ha)}catch(Ra){m.ULS.sendTraceTag(512508572,832,10,"VersionHistoryPaneActor exception in VHCopySlideRequestSucceeded: {0}, correlationId : {1} ",Ra,ha)}}static xBl(t,N,ha){const za=Date.now();m.ULS.sendTraceTag(512508571,832,10,"VhCopySlide operation failed : Duration : {0}, HttpStatusCode : {1}, correlationId : {2}",
za-N,t.data?t.data.Le:-1,ha)}static rUj(){const t=u.a.instance.qb("Common.ISystemInitiatedFeedback");t?(t.logActivity("VersionHistoryExited",null),t.logActivity("VersionHistoryCheckExited",null)):m.ULS.sendTraceTag(512508570,822,50,"ISystemInitiatedFeedback was null")}static uik(){const t=u.a.instance.qb("Common.ISystemInitiatedFeedback");t?t.logActivity("VersionHistoryExited",null):m.ULS.sendTraceTag(512508569,822,10,"ISystemInitiatedFeedback was null")}static sUj(){const t=u.a.instance.qb("Common.ISystemInitiatedFeedback");
t?t.logActivity("VersionHistoryRestoreCoauthFailed",null):m.ULS.sendTraceTag(512508568,822,10,"LaunchVHRestoreFailedDuringCoauthFloodgateSurvey::ISystemInitiatedFeedback was null")}}Object(h.a)(Bl,"VersionHistoryPaneActor",null,[724,106]);class Ze{constructor(){this.Pwc=this.Da=null}get name(){return"PowerPointWebEditor.VersionHistory"}Wb(t){this.Da=t}init(){v.AFrameworkApplication.fa.ff(Object(r.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){v.AFrameworkApplication.kWc()?this.Da.resolve("PowerPointWebEditor.IApplicationSettings").IUc?
m.ULS.sendTraceTag(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected"):(m.ULS.sendTraceTag(39711108,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package"),hb.a.get_instance().gk(7,()=>{yn.a(this.Da)("versionHistory").catch(t=>m.ULS.sendTraceTag(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",t)).then(()=>this.$rk()).catch(t=>
m.ULS.sendTraceTag(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",t))})):m.ULS.sendTraceTag(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")}$rk(){this.yXb();return null}yXb(){this.Da.register(Bl,"PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor").na(()=>new Bl(v.AFrameworkApplication.Ta,this.Da.resolve("PowerPointWebEditor.IThumbnailViewHelper"),this.Da.resolve("Common.Utils.IHighContrastDetector"),
this.Da.resolve("PowerPointWebEditor.IApplicationSettings"),this.Da.resolve("PowerPointWebEditor.IPresentationReader"),gc.FocusManager.instance(),jn.a.instance,this.Da.resolve("PowerPointWebEditor.Core.IPPTAppFrame"),this.Da.resolve("PowerPointWebEditor.Core.IUnifiedAppState"),this.Da.resolve("PowerPointWebEditor.IPopWebService"),this.Da.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.Da.Ka("PowerpointPresence.IPresenceManager"),this.Da.resolve("PowerPointWebEditor.IClipServiceManager"),this.Da.resolve("PowerPointWebEditor.IDesignModeManager").XAa,
this.Da.resolve("PowerPoint.IBrowserHelperManager"),this.Da.resolve("PowerPointWebEditor.ISystemClipboard"),v.AFrameworkApplication.Ge)).ma();this.Pwc=this.Da.resolve("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor");this.Pwc.ub()}dispose(){this.Pwc&&this.Pwc.dispose()}}Object(h.a)(Ze,"PPTWebEditorVersionHistoryPackageManager",null,[2,3]);var Zp=d(448),mk=d(213),Ys=d(697),lp;(function(t){t[t.anyone=0]="anyone";t[t.organization=1]="organization"})(lp||(lp={}));Object(h.b)("AccessControlEnum",
lp);var Gp=d(371);class $p{constructor(){this.token=this.timeStamp=null}}Object(h.a)($p,"CachedAccessToken",null,[]);class Hp{constructor(t){this.yge={};this.F2j=t}Hji(t,N){if(!gb.a.Va(t)&&!gb.a.Va(N)){const ha=new $p;ha.token=N;ha.timeStamp=new Date;this.yge[t]=ha}}u9f(t){return t in this.yge&&(t=Object(Q.a)($p,this.yge[t]),+new Date-+t.timeStamp<6E4*this.F2j)?t.token:null}}Object(h.a)(Hp,"AccessTokenCache",null,[]);class mp{constructor(){this.reject=this.resolve=this.frame=this.Fea=this.jWe=this.resource=
this.appId=this.authority=this.id=null;this.uib=0;this.fHe=null;this.rgc=0;this.RAh=!1}}Object(h.a)(mp,"DirectAuthRequest",null,[]);class Cl{constructor(t){this.cbc={};this.la=t;this.UBb=new Hp(this.la.Ozk);window.addEventListener("message",Object(r.a)(this,this.bVk,"requestCompletionMessageHandler"),!1)}Bbg(t){const N={},ha=RegExp("[#?&]+([^=&]+)=([^&]*)","gi");let za;for(;za=ha.exec(t);)N[Object(Q.a)(String,za[1])]=Object(Q.a)(String,za[2]);return N}bVk(t){if("data"in t){var N;({ou:N}=Ed.d(t.data)).returnValue&&
N&&"DirectAuthRequestID"in N&&this.pub(N)}}pub(t){try{const za=t.DirectAuthRequestID;if(za in this.cbc){var N=null,ha=Object(Q.a)(mp,this.cbc[za]);if(ha&&ha.id===za){K.a.J(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling: {2}",za,"Timeouted"in t,"FromPolling"in t);window.clearTimeout(ha.uib);delete this.cbc[za];window.clearTimeout(ha.rgc);const Ra=new Gp.a;Ra.IsSuccess=!1;Ra.ErrorCode="";Ra.ErrorMessage="";Ra.Token="";"Timeouted"in t?(K.a.J(592238722,
833,10,"DirectAuth: Request timed out with host: "+window.location.host),Ra.ErrorCode="Timeout",Ra.ErrorMessage="No response received in time for the authentcation request",ha.resolve(Ra)):"PopupWindowClosed"in t&&ha.Fea?(Ra.ErrorCode="User_aborted",Ra.ErrorMessage="User aborted log in by closing the popup window",ha.resolve(Ra)):(ha.frame?N=this.Bbg(ha.frame.contentWindow.location.hash):ha.Fea&&!ha.Fea.closed&&(N=this.Bbg(ha.Fea.location.hash)),"access_token"in N?(Ra.IsSuccess=!0,Ra.Token=Object(Q.a)(String,
N.access_token),this.UBb&&this.UBb.Hji(ha.fHe,Ra.Token),ha.resolve(Ra)):(Ra.ErrorCode="error"in N?Object(Q.a)(String,N.error):"unknown",0<=Array.indexOf(this.la.Qzk,Ra.ErrorCode)&&ha.RAh&&ha.frame&&!ha.Fea?this.jzk(ha.authority,ha.appId,ha.resource,ha.jWe,this.la.Rzk).then(qb=>{ha.resolve(qb)}).catch(qb=>{ha.reject(qb)}):(Ra.ErrorMessage="error_description"in N?Object(Q.a)(String,N.error_description):"unknown",ha.resolve(Ra))));ha.frame?document.body.removeChild(ha.frame):ha.Fea&&!ha.Fea.closed&&
ha.Fea.close()}else K.a.J(594068425,833,10,"DirectAuth: Failed to find the request entry for ID: {0}",za)}else K.a.J(594405508,833,50,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(t))}catch(za){K.a.J(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+za.message)}}LFc(t){const N=window.location.protocol,ha=window.location.host;K.a.J(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",
N,ha,"ffc-powerpoint.officeapps.live.com"===ha||"ppc-powerpoint.officeapps.live.com"===ha);if(void 0===t||null===t){t=window.location.pathname;const za=t.lastIndexOf("/");t=0<=za?t.substring(0,za+1):""}return N+"//"+ha+t+"WacDirectAuth.html"}Vrl(t,N,ha,za,Ra,qb=!1){return this.Sfl(t,N,ha,za,Ra,qb)}jzk(t,N,ha,za,Ra){if(gb.a.Va(t))throw Error.argumentNull("authority");if(gb.a.Va(N))throw Error.argumentNull("appId");if(gb.a.Va(ha))throw Error.argumentNull("resource");if(gb.a.Va(za))throw Error.argumentNull("userUPN");
const qb=!gb.a.Va(za)&&za.indexOf("@")<za.indexOf("."),Qb=this.LFc("/p/"),vc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}",t,N,encodeURIComponent(ha),encodeURIComponent(Qb));if(this.UBb){const Md=this.UBb.u9f(vc);if(!gb.a.Va(Md))return K.a.J(593782154,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Id=>{const Xe=new Gp.a;Xe.IsSuccess=!0;Xe.ErrorCode="";Xe.ErrorMessage="";Xe.Token=
Md;Id(Xe)})}const Zc=Be.a.create().toString(),Wc=String.format("{0}&state={1}",vc,Zc);return new Promise((Md,Id)=>{const Xe=new mp;Xe.authority=t;Xe.appId=N;Xe.resource=ha;Xe.jWe=za;Xe.resolve=Md;Xe.reject=Id;Xe.id=Zc;Xe.fHe=vc;Xe.Fea=window.open("",Zc,"width=400, height=600");Xe.Fea?(this.cbc[Zc]=Xe,Xe.Fea.location.replace(Wc),K.a.J(593782152,833,50,"DirectAuth: New popup request created with ID of: {0}, IsUserUPNAlias: {1}",Zc,qb),this.Nuh(Xe,1E3*Ra).then(()=>{const of={};of.DirectAuthRequestID=
Zc;of.FromPolling=!0;this.pub(of)}).catch(of=>{"WindowClosed"===Object(Q.a)(String,of)&&(of={},of.DirectAuthRequestID=Zc,of.PopupWindowClosed=!0,K.a.J(593782150,833,10,"DirectAuth: Popup window closed for request with ID of: "+Zc),this.pub(of))}),Xe.uib=window.setTimeout(()=>{const of={};of.DirectAuthRequestID=Zc;of.Timeouted=!0;K.a.J(593782148,833,10,"DirectAuth: Popup request timedout with ID of: "+Zc);this.pub(of)},1E3*Ra)):(K.a.J(593364752,833,50,"DirectAuth: Popup window was blocked and cannot continue request of {0}",
Zc),Id=new Gp.a,Id.IsSuccess=!1,Id.ErrorCode="fail_to_open_popup",Id.ErrorMessage="Failed to create popup window!",Id.Token="",Md(Id))})}Sfl(t,N,ha,za,Ra,qb){if(gb.a.Va(t))throw Error.argumentNull("authority");if(gb.a.Va(N))throw Error.argumentNull("appId");if(gb.a.Va(ha))throw Error.argumentNull("resource");if(gb.a.Va(za))throw Error.argumentNull("userUPN");const Qb=!gb.a.Va(za)&&za.indexOf("@")<za.indexOf(".");var vc=this.LFc("/p/");const Zc=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",
t,N,encodeURIComponent(ha),encodeURIComponent(vc));if(this.UBb){const Id=this.UBb.u9f(Zc);if(!gb.a.Va(Id))return K.a.J(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(Xe=>{const of=new Gp.a;of.IsSuccess=!0;of.ErrorCode="";of.ErrorMessage="";of.Token=Id;Xe(of)})}const Wc=Be.a.create().toString();vc=Qb?String.format("{0}&login_hint={1}&state={2}",Zc,encodeURIComponent(za),Wc):String.format("{0}&state={1}",Zc,Wc);const Md=document.createElement("iframe");Md.style.display=
"none";Md.src=vc;return new Promise((Id,Xe)=>{const of=new mp;of.authority=t;of.appId=N;of.resource=ha;of.jWe=za;of.frame=Md;of.resolve=Id;of.reject=Xe;of.id=Wc;of.fHe=Zc;of.RAh=qb;document.body.appendChild(Md);K.a.J(594405504,833,50,"DirectAuth: New silent request created with ID of: {0}, IsUserUPNAlias: {1}",Wc,Qb);this.Nuh(of,1E3*Ra).then(()=>{const ih={};ih.DirectAuthRequestID=Wc;ih.FromPolling=!0;this.pub(ih)});of.uib=window.setTimeout(()=>{const ih={};ih.DirectAuthRequestID=Wc;ih.Timeouted=
!0;K.a.J(594405464,833,10,"DirectAuth: Silent request timedout with ID of: "+Wc);this.pub(ih)},1E3*Ra);this.cbc[Wc]=of})}Nuh(t,N){return new Promise((ha,za)=>{const Ra=N/50;let qb=0;t.rgc=window.setInterval(()=>{try{qb++>Ra&&(window.clearInterval(t.rgc),K.a.J(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",N,Ra),za(""));const Qb=t.frame?t.frame.contentWindow:t.Fea;if(!Qb||Qb.closed)window.clearInterval(t.rgc),K.a.J(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),
za("WindowClosed");let vc=null,Zc=null;try{vc=Qb.location.href,Zc=Qb.location.hash}catch(Wc){}vc&&"about:blank"!==vc?gb.a.Va(Zc)||(window.clearInterval(t.rgc),ha(Zc)):K.a.J(594068386,833,50,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===vc)}catch(Qb){K.a.J(594068384,833,15,"DirectAuth: WindowHashPoller: threw exception {0}",Qb.message)}},50)})}}Object(h.a)(Cl,"DirectAuthHelper",null,[]);class Vr{constructor(){this.welcomeScreenErrorImageUrl=this.welcomeScreenBackgroundImageUrl=
this.hostElement=null;this.urlBarHeightInPercentage=this.baseZIndex=0;this.reactionsBarLayerHostId=this.dialogLayerHostId=this.urlBarLayerHostId=this.calloutContainerId=this.welcomeScreenLayerHostId=null;this.isPowerpointLiveReactionEnabled=this.showTryAgainButton=!1;this.resourceCDNPath=this.onboardingScreenHostId=null;this.enableNewLiveWelcomeScreen=this.enablePrefetchLiveResource=!1;this.podsUrl=this.userSessionId=null}}Object(h.a)(Vr,"ILiveActorSettings",null,[]);class No{constructor(){this.react=
null;this.reactionCount=0;this.reactionImagePath=null;this.numberOfAnimationFrames=0}}Object(h.a)(No,"ILiveReaction",null,[]);class Wr{constructor(){this.isPaused=this.isPrivate=!1;this.participantsCount=0;this.sessionURLPromise=null;this.sessionCurrentState=0}}Object(h.a)(Wr,"ILiveSessionState",null,[]);class ro{constructor(){this.sessionQRCode=this.participantUrl=null}}Object(h.a)(ro,"ILiveSessionURL",null,[]);class Xr{constructor(){this.ROg=this.QOg=null}}Object(h.a)(Xr,"PollObjectInfo",null,[]);
var Oo;(function(t){t[t.none=0]="none";t[t.singleLineRibbon=1]="singleLineRibbon";t[t.multipleLineRibbon=2]="multipleLineRibbon";t[t.slideShowToolbar=3]="slideShowToolbar";t[t.slideShowKeyboardShortcut=4]="slideShowKeyboardShortcut";t[t.welcomeScreenTryAgain=5]="welcomeScreenTryAgain"})(Oo||(Oo={}));Object(h.b)("LiveEntryPoint",Oo);var Ip;(function(t){t[t.none=0]="none";t[t.callout=1]="callout";t[t.businessBar=2]="businessBar";t[t.pausedSessionTimeout=3]="pausedSessionTimeout";t[t.slideshowContextMenu=
4]="slideshowContextMenu";t[t.accessControlChange=5]="accessControlChange";t[t.welcomeScreenTryAgain=6]="welcomeScreenTryAgain"})(Ip||(Ip={}));Object(h.b)("LiveExitPoint",Ip);var Qm=d(663);class Zs{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of){this.va=new Qk.a;this.lFa=this.Ryb=this.q_c=this.pke=this.iIg=!1;this.u9b=this.bke=this.t_c=!0;this.ubc=this.CBb=!1;this.Ep=this.oj=this.ada=this.Mn=null;this.GTa=0;this.Yzb=-1;this.ZAb=30;this.eac=-1;this.Bd=this.ola=this.l_=null;this.OQg=this.wTg=this.C4c=
this.y4c=0;this.S7b=this.sta=this.BTa=null;this.doe=this.S$a=0;this.Dhb=null;this.Cse=new Set;this.Bse=new Map;this.D1c=null;this.xac=1;this.cac=this.eHg=this.bO=this.aWa=this.lte=this.Yhe=null;this.fe=za;this.la=t;this.rIg=!1;this.hb=ha;this.uc=qb;this.$p=Qb;this.Mc=vc;this.Wy=Zc;this.Xa=Wc;this.Fc=Md;this.Bl=Id;this.dVa=Xe;this.Fa=of;if(this.Ws=N)this.ada=N.hF();this.wL=Ra;this.GTa=this.Q3f?1:0;this.la.powerPointLiveBroadcastEnabled&&(this.Yhe=new Cl(this.la));this.Mc.JB(Object(r.a)(this,this.d$,
"onPodSessionRehydrated"));this.Wy.NId(Object(r.a)(this,this.BDb,"onPodSessionUnavailable"));this.ZPa()&&this.Bl.execute(ih=>{ih.show(ResourceStrings.L_LivePresentations_Disconnected,Qm.a.bDb);ih.hide()});K.a.J(512496260,833,50,"LivePresenter: Host auth type is: "+this.la.hostAuthType)}get lr(){return this.la.powerPointLiveBroadcastEnabled&&this.t_c}get $5a(){return this.pke}set $5a(t){(this.pke=t)&&this.va.raiseEvent("OnLiveResourcesLoaded",Sys.EventArgs.Empty)}get Rq(){return!!this.Ep}get Uba(){return this.rIg}set Uba(t){this.rIg=
t}get $Ba(){return this.iIg}set $Ba(t){this.iIg=t}get bQa(){return!!this.Ep&&this.Ep.isPaused}get fRi(){return this.q_c}get aCa(){return this.u9b}set aCa(t){this.u9b=t}get RQi(){return this.$5a&&this.lr&&!!this.Mn}get accessControl(){return this.GTa}set accessControl(t){this.GTa=t}get Q3f(){return"true"===this.Jeg("wdDisablePrivateSession")?!1:"aad"===this.la.hostAuthType}get L3f(){return this.lr&&this.Rq&&this.oj?this.oj.isWelcomeScreenVisible():!1}gsb(){return this.la.isMicButtonInSlideShowToolbarEnabled&&
this.la.Lbd&&this.Fc.d_b?this.Fc.isb?this.ubc=!0:this.Fc.b4f||this.ubc:!0}v$c(t,N,ha,za,Ra,qb,Qb,vc,Zc){if(this.lr){this.hb.FId(Object(r.a)(this,this.C2g,"onSlideShowEnterEndOfShow"));this.hb.HId(Object(r.a)(this,this.D2g,"onSlideShowLeaveEndOfShow"));this.hb.xBc(Object(r.a)(this,this.Lva,"onGetCurrentSlideDimensionsHandler"));this.Ryb=!1;this.lFa=!0;try{this.la.xbd&&this.YYi();const Wc=this.i1d(Ra,za);if(this.Mn)(this.$Ba||this.bQa)&&this.Mn.FetchDocumentDownloadURL(Wc);else{K.a.J(512496259,833,
50,"Creating Broadcast monitor ...");const Md=new PowerPointLive.PPTBroadcastMonitorSettings;Md.isBlueChicken=this.la.isBlueChicken;Md.fileDownloadUrl=Wc;Md.rendezvousSvcBaseUri=this.la.podLiveBroadcastRendezvousServiceBaseUri;Md.broadcastSubtitlesFromSpeechFrontDoor=!0;Md.pragueInitTimeoutInMS=this.la.Tzk;Md.preferredSubtitleLanguage=this.Fc.IPc();Md.useStateService=this.la.bAk;Md.numMaxAttempts=this.la.Wzk;Md.delayInSecsToCloseBroadcasterOnPause=this.la.Nzk;Md.batchedRequestsEnabled=this.la.Kzk;
Md.sharedSessionSettings={};Md.websocketAliveTimeAfterLoseFocusInMs=this.la.cAk;Md.pingTimeoutInMs=this.la.Uzk;Md.pongTimeoutInMs=this.la.Vzk;Md.enableTransientSessionHandling=this.la.yAk;Md.maxStateServiceRoundtripRaw=v.AFrameworkApplication.fa.Cc("PPTLiveMaxStateServiceRoundtripRaw",300);Md.sharedSessionSettings.MaxStateServiceRoundtripRaw=Md.maxStateServiceRoundtripRaw;Md.documentSnapshotRequestUrlGenerator=this.la.vAk?()=>this.i1d(this.Xa.podSessionId,this.Xa.fk):null;this.la.I7g&&(Md.sharedSessionSettings.IsAutomation=
!0);this.Mn=new PowerPointLive.PPTBroadcastMonitor(Md);this.Mn.RegisterParticipantsCountChangeEventListener(Id=>{this.Bd.telemetryData.maxParticipantCount=Math.max(this.Bd.telemetryData.maxParticipantCount,Id);this.oj&&this.oj.setParticipantCount(Id);this.va.raiseEvent("ParticipantsCountChanged",Sys.EventArgs.Empty)});this.Mn.RegisterNewReactionEventListener(Object(r.a)(this,this.Zgk,"newReactionHandler"));this.Mn.RegisterConnectionStateEventListener(Object(r.a)(this,this.Pui,"connectionStateHandler"))}this.Mn.SetCurrentPosition(t,
N-1,null);this.S$a=t;this.$Ba&&!this.Ep&&Zc?(this.Imc(v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.jb.Up?1:2,Qb,ha,Ra,vc),this.hri(t),this.sta=new Set):this.l_&&this.Iub();this.sta&&this.sta.add(t)}catch(Wc){K.a.J(512496258,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",Wc.toString())}}}Sql(){window.setTimeout(()=>{const t=this.S$a===this.doe;this.lr&&this.Rq&&t&&this.Ep&&!this.Ep.isPaused&&(K.a.J(512496257,833,50,"LivePresenter::TriggerSurveyOnLastSlide Triggering live survey on last slide"),
this.dnd(0),this.aKb(0))},6E4*this.la.Yzk)}Sqk(){this.lr&&(this.hb.jGe(Object(r.a)(this,this.C2g,"onSlideShowEnterEndOfShow")),this.hb.lGe(Object(r.a)(this,this.D2g,"onSlideShowLeaveEndOfShow")),this.hb.Med(Object(r.a)(this,this.Lva,"onGetCurrentSlideDimensionsHandler")),this.lFa=this.Ryb=!1,this.Rq&&this.oj&&(this.oj.hideAll(),this.dce()||(this.Mwk(),this.pel()),this.ZPa()&&this.Bl.instance.hide()))}Pil(t,N,ha,za,Ra,qb){try{const Qb=new PowerPointLive.RendezvousSessionConfig;Qb.userSessionId=t;Qb.webServiceBase=
N;Qb.podSessionId=ha;Qb.docId=za;Qb.sessionId=Ra;Qb.accessControl=1===this.GTa?"organization":"anyone";Qb.authTokenFunc=qb;Qb.locale=v.AFrameworkApplication.uiCulture;Qb.presentationName=gb.a.yG(v.AFrameworkApplication.fileName);Qb.slideHeight=this.uc.su().height;Qb.slideWidth=this.uc.su().width;Qb.correlationId=this.Bd.telemetryData.correlationId;Qb.showQRCodeAfterFetchingDocDownloadUrl=this.la.FAk;Qb.presenterTenantId=!this.la.isBlueChicken&&this.la.V7g?v.AFrameworkApplication.fa.Ga("TenantId"):
null;Qb.fileSource=v.AFrameworkApplication.fa.Ga("FileHost");this.la.$zk||(Qb.fileName=v.AFrameworkApplication.fileName,Qb.bootstrapperUrl=this.la.pptEditorSlideShowWrsEndpoint);const vc=this.Mn.StartLiveBroadcasting(Qb,this.Bd,!this.la.pBe);this.aAj();if(vc){this.Ep=new Wr;this.Ep.isPrivate=1===this.GTa;this.Ep.isPaused=!1;this.Ep.participantsCount=0;this.Ep.sessionCurrentState=0;const Zc=vc.then(Wc=>{const Md=new ro;Md.participantUrl=Wc.sessionInfo.shortParticipantUrl;Md.sessionQRCode=Wc.sessionInfo.sessionQRCode;
this.Ep.sessionCurrentState=1;return Md});this.Ep.sessionURLPromise=Zc;this.la.Mbd?this.cac.then(()=>{this.oj.actOnSessionRequested(this.Ep)}):this.oj.actOnSessionRequested(this.Ep);this.hb.ABc(Object(r.a)(this,this.E2g,"onSlideShowReady"));this.hb.pFf(Object(r.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.hb.IId(Object(r.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));vc.then(Wc=>{this.Bd.telemetryData.pragueDocId=Wc.sessionInfo.pragueDocId;this.Bd.telemetryData.sessionCreationWebServiceCallTimeInMS=
this.IK()-this.C4c;this.Bd.telemetryData.startAttemptCount=Wc.numAttempt;K.a.J(512496256,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",this.Bd.telemetryData.sessionId,this.Bd.telemetryData.sessionCreationWebServiceCallTimeInMS.toString());this.la.pBe?(this.Wkc(),this.Mn.InitializeStateService().then(()=>{this.uph(Wc);this.g_("StartLiveBroadcasting")}).catch(Md=>{this.Bd.telemetryData.sessionEndedBeforePragueInitialized||this.Bd.telemetryData.sessionId!==Ra||
(K.a.J(512496227,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",this.Bd.telemetryData.sessionId,Md?Md.toString():""),this.Bd.telemetryData.SetErrorCode(2,Md?Md.toString():""),this.g_("StartLiveBroadcasting"),this.Ljd())})):this.uph(Wc);this.la.xAk&&$addHandler(window,"visibilitychange",Object(r.a)(this,this.Mok,"onPageVisibilityChangedHandler"));this.g_("StartLiveBroadcasting")}).catch(Wc=>{K.a.J(512496226,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",
this.Bd.telemetryData.sessionId,Wc.toString());this.Bd.telemetryData.SetErrorCode(4,Wc.toString());this.g_("StartLiveBroadcasting");this.Ljd()})}else this.Ljd(),this.Bd.telemetryData.SetErrorCode(4,"Failed to create Promise object!"),K.a.J(512496225,833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(Qb){this.Ljd(),this.Bd.telemetryData.SetErrorCode(4,Qb.toString()),K.a.J(512496224,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",this.Bd.telemetryData.sessionId,
Qb.toString())}finally{this.g_("StartLiveBroadcasting")}}uph(t){const N=this.Fc.g1i(this.Fc.yna);N?this.Mn.SetDefaultSubtitlesLanguage(N):K.a.J(512496223,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",this.Bd.telemetryData.sessionId);this.hb.NJb(!0,this.Mn.GetPragueSessionInfoJSONString());this.hb.INa(Object(r.a)(this,this.ifc,"onSlideShowPositionChanged"));this.hb.oFf(Object(r.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.la.pBe&&!this.oj.isWelcomeScreenVisible()||
this.Wkc();this.va.raiseEvent("OnLiveSessionStarted",t.sessionInfo);this.gsb()||!this.Fc.d_b||this.Fc.b4f||this.ubc||!this.ZPa()||(this.CBb=!0,this.Bl.instance.show(ResourceStrings.l_LivePresentation_UnsupportedSpeechToast.replace("{0}",xd.a.oe(v.AFrameworkApplication.uiCulture).displayName),Qm.a.bDb));this.S7b=this.Mn.CreateSurvey(t.authToken,null,null,null);this.S7b.then(ha=>{if(ha){const za={};za.surveyeeName=v.AFrameworkApplication.userName;za.surveyId=ha.surveyId;za.surveyResponseUrl=ha.surveyResponseUrl;
this.Mn.SetAudienceFeedbackInfo(JSON.stringify(za))}});this.la.xbd&&(this.Bse.clear(),this.Cse.forEach(ha=>{try{const za=ha.QOg;this.Mn.CreateSurvey(t.authToken,null,za,ha.ROg).then(Ra=>{Ra?this.Bse.set(za,Ra.surveyId):K.a.J(512496222,833,10,"SessionId: {0}, Message: Duplicated poll info is not valid!",this.Bd.telemetryData.sessionId)}).catch(Ra=>{K.a.J(512496221,833,10,"SessionId: {0}, Message: Failed to duplicate poll as DuplicateSurvey request failed due to error!, Details: {1}",this.Bd.telemetryData.sessionId,
Ra.toString());this.Bd.telemetryData.SetErrorCode(13,t.toString())})}catch(za){K.a.J(512496220,833,10,"SessionId: {0}, Message: Exception when duplicating, Details: {1}",this.Bd.telemetryData.sessionId,za.toString())}}));this.dVa.init()?this.dVa.yId(Object(r.a)(this,this.Rec,"onNetworkConnectivityChanged")):K.a.J(512496219,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",this.Bd.telemetryData.sessionId)}Jeg(t){t=new RegExp(String.format("[\\?&]{0}=([^&#]*)",t));return(t=
window.location.search.match(t))&&2===t.length?t[1]:""}Imc(t,N,ha,za,Ra){this.lte=N;this.aWa=ha;this.bO=za;this.eHg=Ra;this.C4c=this.IK();this.y4c=this.IK();var qb=this.Jeg("wdSetLiveSessionId");qb="rdvSession_"+(qb.length?qb:Be.a.create().toString());this.Bd=new PowerPointLive.LiveSessionTelemetry;this.Bd.telemetryData.sessionId=qb;this.Bd.telemetryData.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Bd.telemetryData.accessControl=lp[this.GTa];this.Bd.telemetryData.sessionEntryPoint=
Oo[t];this.Bd.telemetryData.isSubtitleStartedByLive=this.Uba;this.Bd.telemetryData.isAutomation=this.la.I7g;this.Bd.telemetryData.correlationId=Be.a.create().toString();this.g_("StartLiveBroadcasting");try{this.lr&&this.Mn&&this.NZb()&&!this.Ep?(this.mWj(),this.hb.cUb(Object(r.a)(this,this.T_g,"onGetCurrentSlideShowPosition")),this.hb.getCurrentPosition(),this.FWd()&&this.oj&&this.cac&&this.cac.then(()=>{this.oj.showOnboardingScreen();this.JWe=!0}),this.Pil(N,ha,za,Ra,qb,()=>this.l0b("StartLiveBroadcasting",
this.Bd.telemetryData.sessionId))):(this.Bd.telemetryData.SetErrorCode(4,"Live actor or broadcast monitor is null while trying to start live session!"),K.a.J(512496218,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!")),this.Bd.telemetryData.isMordernSlideShow=!!this.hb&&this.hb instanceof Ys.SlideShowCoreFrame}catch(Qb){this.Bd.telemetryData.SetErrorCode(4,Qb.toString()),K.a.J(512496217,833,10,"SessionId: {0}, Message: Exception when starting Live session, Details: {1}",
this.Bd.telemetryData.sessionId,Qb.toString())}finally{this.g_("StartLiveBroadcasting")}}Mwk(){if(this.lr&&this.Rq&&this.Mn&&this.NZb()&&!this.Ep.isPaused){this.dnd(2);this.aKb(2);try{this.Bd.telemetryData.sessionPauseCount+=1,this.Bd.telemetryData.sessionActiveDurationInMS+=this.IK()-this.y4c,K.a.J(512496216,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",this.Bd.telemetryData.sessionId),this.oj.actOnSessionPaused(),this.Ep.isPaused=!0,this.OQg=this.IK(),this.Mn.PauseLiveBroadcasting(()=>
this.l0b("PauseLiveBroadcasting",this.Bd.telemetryData.sessionId)),this.va.raiseEvent("OnLiveSessionPaused",Sys.EventArgs.Empty),this.Wil(),this.hb.NJb(!1)}catch(t){this.Bd.telemetryData.SetErrorCode(5,t.toString()),K.a.J(512496215,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",this.Bd.telemetryData.sessionId,t.toString())}finally{this.g_("PauseLiveBroadcasting")}}}mih(){if(this.lr&&this.Rq&&this.Mn&&this.NZb()&&this.Ep.isPaused)try{this.y4c=this.IK(),this.Bd.telemetryData.sessionResumeCount+=
1,K.a.J(512496214,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",this.Bd.telemetryData.sessionId),this.Shh(),this.oj.actOnSessionResumed(),this.Mn.ResumeLiveBroadcasting(()=>this.l0b("ResumeLiveBroadcasting",this.Bd.telemetryData.sessionId)),this.Ep.isPaused=!1,this.va.raiseEvent("OnLiveSessionResumed",Sys.EventArgs.Empty),this.UPe(),this.hb.NJb(!0,this.Mn.GetPragueSessionInfoJSONString())}catch(t){this.Bd.telemetryData.SetErrorCode(6,t.toString()),K.a.J(512496213,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",
this.Bd.telemetryData.sessionId,t.toString())}finally{this.g_("ResumeLiveBroadcasting")}}GZb(t){if(this.lr&&this.Rq&&this.Mn&&this.NZb()){this.aKb(3);try{this.Bql(t,()=>{this.Bd.telemetryData.sessionExitPoint=Ip[t];this.Ep.isPaused||(this.Bd.telemetryData.sessionActiveDurationInMS+=this.IK()-this.y4c);this.l_&&this.Iub();this.UPe();this.ZPa()&&this.Bl.instance.hide();K.a.J(512496212,833,50,"SessionId: {0}, Message: End live broadcasting ...",this.Bd.telemetryData.sessionId);this.oj.actOnSessionEnded();
this.hb.Oed(Object(r.a)(this,this.E2g,"onSlideShowReady"));this.hb.Dfb(Object(r.a)(this,this.ifc,"onSlideShowPositionChanged"));this.hb.xfh(Object(r.a)(this,this.onSubtitleUpdated,"onSubtitleUpdated"));this.hb.yfh(Object(r.a)(this,this.onTranscriberStarted,"onTranscriberStarted"));this.dVa.bfh(Object(r.a)(this,this.Rec,"onNetworkConnectivityChanged"));this.hb.mGe(Object(r.a)(this,this.onPodSessionExpired,"onPodSessionExpired"));this.lFa&&this.hb.NJb(!1);this.S7b=this.Ep=null;this.va.raiseEvent("OnLiveSessionEnded",
Sys.EventArgs.Empty);this.la.Lbd&&this.Fc.d_b&&(this.ubc=this.CBb=!1);if(3!==t){const N=this.Mn.EndLiveBroadcasting(()=>this.l0b("EndLiveBroadcasting",this.Bd.telemetryData.sessionId));N?N.then(()=>{this.g_("EndLiveBroadcasting");K.a.J(512496211,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",this.Bd.telemetryData.sessionId)}).catch(ha=>{this.Bd.telemetryData.SetErrorCode(7,ha.toString());this.g_("EndLiveBroadcasting");K.a.J(512496210,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",
this.Bd.telemetryData.sessionId,ha.toString())}):(this.Bd.telemetryData.SetErrorCode(7,"EndLiveBroadcasting failed to created Promise object!"),K.a.J(512496209,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else this.Mn.CleanUpBroadcastBeforeEnd(),K.a.J(512496208,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");this.g_("EndLiveBroadcasting")})}catch(N){this.Bd.telemetryData.SetErrorCode(7),K.a.J(512496207,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",
this.Bd.telemetryData.sessionId,N.toString())}finally{3!==t&&this.Hib(),this.g_("EndLiveBroadcasting")}}}ynh(){this.lr&&this.Mn&&this.Mn.SetPresenterState("muted")}znh(){this.lr&&this.Mn&&this.Mn.SetPresenterState("unmuted")}showCallout(t){this.lr&&this.oj&&(this.q_c=!0,this.oj.showCallout(t))}showWelcomeScreen(){this.lr&&this.oj&&(this.oj.showWelcomeScreen(),this.aLe())}showEndSessionDialog(t,N){this.lr&&this.Rq&&this.oj&&this.oj.showEndSessionDialogWithCallbacks(t,N)}Ljd(){this.oj.isWelcomeScreenVisible()||
this.Ep.isPaused||this.showWelcomeScreen();this.Ep=null;this.oj.onSessionRequestError()}NZb(){if(this.lr&&!this.oj&&this.ada){const t=new Vr;t.hostElement=this.ada;t.baseZIndex=50005;t.welcomeScreenBackgroundImageUrl=this.fe.hk("LiveWelcomeScreenBackground.png");t.welcomeScreenErrorImageUrl=this.fe.hk("LiveWelcomeScreenError.png");t.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";t.calloutContainerId="LiveCalloutContainer";t.urlBarLayerHostId="LiveURLBarLayerHost";t.dialogLayerHostId="LiveDialogLayerHost";
t.reactionsBarLayerHostId="LiveReactionBarLayerHost";t.showTryAgainButton=!0;t.isPowerpointLiveReactionEnabled=!dd.a("PPTLive.ReactionToggleInLiveCallout");t.onboardingScreenHostId="LiveOnboardingScreenLayerHost";t.resourceCDNPath=this.la.Feb;t.enablePrefetchLiveResource=this.la.Mbd;t.enableNewLiveWelcomeScreen=this.la.Mbd;t.userSessionId=this.lte;t.podsUrl=this.aWa;this.oj=liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(t);this.oj.on("OnWelcomeScreenOpenedAction",()=>{this.VIa("LiveWelcomeScreenLayerHost");
this.aLe();this.wTg=Date.now();this.Bd.telemetryData.welcomeShownCount+=1});this.oj.on("OnWelcomeScreenClosedAction",()=>{this.Ryb&&this.oj.hideURLBar();this.PPf();this.hb.restoreFocus();this.Bd.telemetryData.welcomeScreenDurations.push(Date.now()-this.wTg);this.Bd.telemetryData.welcomeScreenFirstTimeDuration=this.Bd.telemetryData.welcomeScreenDurations[0];this.g_("OnWelcomeScreenClosedAction");this.Mn.SetWelcomeScreenState(!1);this.la.xbd&&this.Kzh();this.CBb&&this.ZPa()&&window.setTimeout(()=>{this.Bl.instance.hide();
this.CBb=!1},5E3)});this.oj.on("ResumeSessionAction",()=>{this.mih();this.Ryb||this.oj.showURLBar()});this.oj.on("EndSessionAction",()=>{this.GZb(this.lFa?1:2);this.hb.restoreFocus()});this.oj.on("OnCalloutOpenedAction",()=>{this.q_c=!0;this.va.raiseEvent("OnCalloutOpened",Sys.EventArgs.Empty);this.Bd.telemetryData.calloutShownCount+=1});this.oj.on("OnCalloutClosedAction",()=>{this.q_c=!1;this.va.raiseEvent("OnCalloutDismissed",Sys.EventArgs.Empty);this.hb.restoreFocus()});this.oj.on("OnEndSessionDialogOpenedAction",
()=>{this.j4k()});this.oj.on("OnEndSessionDialogClosedAction",()=>{this.TWk()});this.oj.on("OnCalloutMenuDefinitionChangedAction",()=>{this.va.raiseEvent("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty)});this.oj.on("OnTryAgainAction",()=>{K.a.J(512496206,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",this.Bd.telemetryData.sessionId);this.Imc(5,this.lte,this.aWa,this.bO,this.eHg)});this.oj.on("PresenterDisabledReactions",()=>{this.bke=!1});this.oj.on("PresenterEnabledReactions",()=>
{this.bke=!0});this.oj.on("OnOnboardingScreenOpenedAction",()=>{this.VIa("LiveOnboardingScreenLayerHost");this.aLe()});this.oj.on("OnOnboardingScreenClosedAction",()=>{this.Wkc()})}return!!this.oj}Wkc(){this.oj&&(this.FWd()&&this.oj.isOnboardingScreenVisible()?this.VIa("LiveOnboardingScreenLayerHost"):this.oj.isWelcomeScreenVisible()?this.VIa("LiveWelcomeScreenLayerHost"):(-1!==this.eac&&this.PPf(),this.hb.restoreFocus()))}DIj(){const t=document.getElementById("LiveWelcomeScreenLayerHost"),N=document.getElementById("LiveOnboardingScreenLayerHost");
let ha=!1;t&&(ha=t.contains(document.activeElement));return document.activeElement===N||document.activeElement===t||ha}aLe(){this.oj&&-1===this.eac&&(this.eac=window.setInterval(()=>{this.DIj()||this.Wkc()},500))}PPf(){window.clearInterval(this.eac);this.eac=-1}VIa(t){this.ada&&this.oj&&window.setTimeout(()=>{gc.FocusManager.Mr(this.ada.ownerDocument.getElementById(t))},50)}j4k(){this.lFa?this.VIa("LiveDialogLayerHost"):(this.Fa.XRc(kd.a.oBe,kd.a.jj,document.getElementById("LiveDialogLayerHost")),
this.Fa.Gj(kd.a.oBe,!0))}TWk(){this.lFa?this.hb.restoreFocus():this.Fa.Gj(kd.a.oBe,!1)}Tjg(){this.la.Lbd&&this.Fc.d_b&&(this.ZPa()&&this.CBb&&(this.Bl.instance.hide(),this.CBb=!1),this.ubc=!0)}mWj(){try{this.cac||!this.FWd()&&!this.la.Mbd||(this.cac=yn.a(u.a.instance)("liveActorLazy"))}catch(t){K.a.J(512496205,833,10,"SessionId: {0}, Message: Exception when loading the liveActorLazy, Details: {1}",this.Bd.telemetryData.sessionId,t.toString())}}E2g(){this.lr&&this.Mn&&(this.bQa?(window.setTimeout(()=>
{this.va.raiseEvent("OnRelaunchPausedSession",Sys.EventArgs.Empty)},500),this.mih()):this.Ep&&this.oj&&this.oj.isWelcomeScreenVisible()&&this.Wkc())}ifc(t,N){this.lr&&this.Mn&&(this.Mn.SetCurrentPosition(N.slideId,N.slideIndex,N.$nc),this.S$a!==N.slideId&&this.Shh(),this.S$a=N.slideId,this.sta&&(this.BTa&&10>this.xac&&10*this.sta.size>=this.xac*this.BTa.size&&(this.aKb(4),this.xac+=1),this.sta.add(N.slideId)),this.la.xbd&&this.Kzh(),t=!!this.BTa&&this.BTa.size>=this.la.Xzk,this.S$a===this.doe&&t&&
this.Sql())}C2g(){this.Ryb=!0;this.lr&&this.Rq&&this.oj&&(this.oj.hideURLBar(),this.dnd(1),this.aKb(1))}D2g(){this.Ryb=!1;this.lr&&this.Rq&&this.oj&&this.oj.showURLBar()}onSubtitleUpdated(t,N){this.lr&&this.Rq&&this.Mn&&(N.isFinal?this.Mn.UpdateFinalSubtitles(N.ozh):this.Mn.UpdatePartialSubtitles(N.ozh))}onTranscriberStarted(t,N){this.Bd.telemetryData.transcriberSessionIds+=N.nzh+",";this.lr&&this.Rq&&this.hb.NJb(!0,this.Mn.GetPragueSessionInfoJSONString())}Wil(){K.a.J(512496204,833,50,"SessionId: {0}, StartPausedSessionAutoExpireTimer.",
this.Bd.telemetryData.sessionId);-1!==this.Yzb&&window.clearInterval(this.Yzb);this.ZAb=30;this.Yzb=window.setInterval(Object(r.a)(this,this.Qwk,"pausedSessionAutoExpireTimerCallBack"),6E4)}UPe(){-1!==this.Yzb&&(K.a.J(512496203,833,50,"SessionId: {0}, StopPausedSessionAutoExpireTimer.",this.Bd.telemetryData.sessionId),window.clearInterval(this.Yzb),this.Yzb=-1)}Qwk(){--this.ZAb;0>=this.ZAb?(K.a.J(512496202,833,50,"SessionId: {0}, Ending long paused session.",this.Bd.telemetryData.sessionId),this.Iub(),
this.GZb(3)):this.l_&&(this.l_.message=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.ZAb.toString()))}pel(){if(!this.l_&&this.Ws&&!v.AFrameworkApplication.Vg&&0!==this.Ep.sessionCurrentState){var t=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.ZAb.toString());t=new Zp.a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,t,null);t.closeable=!0;t.i2=Object(r.a)(this,this.kkk,"onBusinessBarClosed");t.image=3;t.addButton(ResourceStrings.l_LiveBusinessBarButton_ResumeSession,
Object(r.a)(this,this.mkk,"onBusinessBarResumeSessionButtonClicked"),"");t.ZHd(ResourceStrings.l_LiveBusinessBarButton_EndSession,Object(r.a)(this,this.lkk,"onBusinessBarEndSessionButtonClicked"));this.Ws.businessBar.Wh(t,!1);this.Ws.Fq();this.l_=t}}dce(){var t=6E4*this.la.CAk;t=0<t?this.IK()-this.C4c>=t:!1;K.a.J(512496201,833,50,"LivePresenter::IsSessionStale {0}",t);return t}Iub(){try{this.Ws&&this.l_?(this.UPe(),this.Ws.businessBar.removeEntry(this.l_),this.Ws.Fq(),K.a.J(512496200,833,50,"LivePresenter::HideLiveSessionBusinessBar WasSuccessful: {0}",
!this.l_.businessBar),this.l_=null):K.a.J(512496199,833,15,"LivePresenter::HideLiveSessionBusinessBar failed: conditions: {0}, {1}",!!this.Ws,!!this.l_)}catch(t){K.a.J(512496198,833,15,"LivePresenter::HideLiveSessionBusinessBar threw an exception of {0}",t.toString())}}kkk(t){t===this.l_&&(this.l_=null)}mkk(t){t===this.l_&&this.oj&&(this.Iub(),this.dce()||v.AFrameworkApplication.Ta.processAction(vb.a.kZa,2))}lkk(t){t===this.l_&&this.oj&&(this.dce()?this.Iub():this.oj.showEndSessionDialog())}Mok(){const t=
this.IK(),N=window.document.hidden;K.a.J(512496197,833,50,"LivePresenter::OnPageVisibilityChangedHandler page {0} at {1}",N?"hidden":"visible",t);N||this.bQa&&18E5<=t-this.OQg&&this.Iub()}EZd(t,N,ha){return!this.la.powerPointLiveBroadcastEnabled||0===this.GTa&&this.la.isBlueChicken?new Promise(za=>{za(null)}):!ha&&!this.wL||ha&&!this.Yhe?(K.a.J(512496196,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",t,N,ha),new Promise((za,Ra)=>
{Ra("AuthHelperNotSet")})):new Promise((za,Ra)=>{let qb=this.la.hostAuthType,Qb="";if("aad"===qb||this.la.isBlueChicken)Qb=this.la.pptLiveResourceUri;else if("msa"===qb)Qb=this.la.BAk;else{K.a.J(512496195,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",t,N);Ra("HostAuthTypeInvalid");return}const vc="true"===v.AFrameworkApplication.fa.Ga("IsAnonymousUser").toLowerCase();let Zc=v.AFrameworkApplication.fa.Ga(v.AFrameworkApplication.FJ);gb.a.Va(Zc)&&(Zc=
"Unset");const Wc=new Date;let Md=null;Md=ha?this.Yhe.Vrl(this.la.Mzk,this.la.Lzk,Qb,v.AFrameworkApplication.fa.Ga("UserPrincipalName"),this.la.Zzk,this.la.Pzk&&"StartLiveBroadcasting"===t&&!this.la.V7g):this.wL.KU(this.la.pptLiveImplicitAuthAppName,Qb);Md.then(Id=>{this.mDg(N,t,qb,ha,vc,Zc,Id.IsSuccess,+new Date-+Wc,Id.ErrorCode,Id.ErrorMessage);Id.IsSuccess?za(Id.Token):Ra(Id.ErrorCode)}).catch(Id=>{this.mDg(N,t,qb,ha,vc,Zc,!1,+new Date-+Wc,"exception",Id.toString());Ra("exception")})})}l0b(t,N){if(!this.la.powerPointLiveBroadcastEnabled||
0===this.GTa&&this.la.isBlueChicken)return new Promise(za=>{za(null)});if("msa"===this.la.hostAuthType)return this.EZd(t,N,!1);const ha=this;return new Promise((za,Ra)=>{ha.EZd(t,N,!0).then(qb=>{za(qb)}).catch(()=>{ha.EZd(t,N,!1).then(qb=>{K.a.J(512496194,833,50,"LivePresenter::GetToken - WebAuth retry succeeded.");za(qb)}).catch(qb=>{Ra(qb)})})})}IK(){return(new Date).getTime()}mDg(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc){const Md={};Md.SessionId=t;Md.Action=N;Md.HostAuthType=ha;Md.UseDirectAuth=za;Md.IsAnonymousUser=
Ra;Md.UiHost=qb;Md.IsSuccess=Qb;Md.Latency=vc;Md.ErrorCode=Zc;Md.ErrorMessage=Wc;K.a.J(51197915,833,50,JSON.stringify(Md))}g_(t){this.Bd.telemetryData.action=t;this.Bd.telemetryData.sessionDurationInMS=this.IK()-this.C4c;this.Bd.telemetryData.hostAuthType=this.la.hostAuthType;this.Bd.SetStateServiceMetrics();this.Bd.telemetryData.errorCode.length&&(!this.Bd.telemetryData.errorMessage.length||0>Array.indexOf(this.la.Szk,this.Bd.telemetryData.errorMessage))&&(this.Bd.telemetryData.hasUnexpectedError=
!0);t=this.la.podLiveBroadcastRendezvousServiceBaseUri.toLowerCase();-1!==t.indexOf("pptservicescast.officeapps.live.com")?this.Bd.telemetryData.rendezvousServiceEnvironment="prod":-1!==t.indexOf("pptservicescast.edog.officeapps.live.com")?this.Bd.telemetryData.rendezvousServiceEnvironment="edog":-1!==t.indexOf("pptservicescast.officeapps.live-int.com")?this.Bd.telemetryData.rendezvousServiceEnvironment="int":this.Bd.telemetryData.rendezvousServiceEnvironment="dev";K.a.J(50706442,833,this.Bd.telemetryData.hasUnexpectedError?
15:50,JSON.stringify(this.Bd.telemetryData))}hri(t){if(this.uc)try{var N=this.$p.presentation;if(!N)throw Error.argumentNull("Presentation is null");const ha=N.slides||[];this.doe=ha[ha.length-1].sid;let za=N=!1;this.BTa=new Set;for(const Ra of ha)N||Ra.sid!==t||(N=!0,za=Ra.Rm),!N||Ra.Rm&&!za||this.BTa.add(Ra.sid),za&&!Ra.Rm&&(za=!1)}catch(ha){this.Bd.telemetryData.SetErrorCode(16,ha.toString()),K.a.J(512496193,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",
this.Bd.telemetryData.sessionId,ha.toString())}}dnd(t){return new Promise(N=>{if(this.lr&&this.Mn&&this.Ep&&this.S7b)try{this.S7b.then(ha=>{let za=!1;switch(t){case 2:if(!this.sta||!this.BTa||10*this.sta.size<8*this.BTa.size){N(!0);return}break;case 3:za=!0}const Ra={triggeredSurveyType:"Survey.AudienceFeedback"};Ra.isMandatory=za;Ra.triggerEventId=Be.a.create().toString();Ra.surveyeeName=v.AFrameworkApplication.userName;ha?(Ra.surveyId=ha.surveyId,Ra.surveyResponseUrl=ha.surveyResponseUrl):K.a.J(512496192,
833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",this.Bd.telemetryData.sessionId);this.Mn.TriggerSurvey(JSON.stringify(Ra));K.a.J(512496163,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",this.Bd.telemetryData.sessionId,t);N(!0)}).catch(ha=>{K.a.J(512496162,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",this.Bd.telemetryData.sessionId,ha.toString());this.Bd.telemetryData.SetErrorCode(13,
ha.toString());N(!1)})}catch(ha){this.Bd.telemetryData.SetErrorCode(17,ha.toString()),K.a.J(512496161,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",this.Bd.telemetryData.sessionId,ha.toString()),N(!1)}else N(!0)})}T_g(t,N){this.hb&&this.Mn&&N&&(this.hb.Cfb(Object(r.a)(this,this.T_g,"onGetCurrentSlideShowPosition")),this.Mn.SetCurrentPosition(N.slideId,N.slideIndex,N.$nc))}Lva(t,N){this.oj&&this.oj.actOnCurrentSlideDimensionChange(N.slideHeight,
N.Bth,N.slideWidth,N.Eth)}getCalloutMenuDefinition(){return this.NZb()?this.oj.getCalloutMenuDefinition():null}aAj(){const t=String.format("{0}{1}",this.la.Feb,"reactions/heart/default/240_anim_f/heart.png"),N=String.format("{0}{1}",this.la.Feb,"reactions/yes/default/240_anim_f/yes.png"),ha=String.format("{0}{1}",this.la.Feb,"reactions/clap/default/240_anim_f/clap.png"),za=String.format("{0}{1}",this.la.Feb,"reactions/laugh/default/240_anim_f/laugh.png"),Ra=String.format("{0}{1}",this.la.Feb,"reactions/surprised/default/240_anim_f/surprised.png"),
qb=String.format("{0}{1}",this.la.Feb,"reactions/wonder/default/240_anim_f/wonder.png");this.ola=[Object.assign(new No,{react:"yes",reactionCount:0,reactionImagePath:N,numberOfAnimationFrames:40}),Object.assign(new No,{react:"heart",reactionCount:0,reactionImagePath:t,numberOfAnimationFrames:16}),Object.assign(new No,{react:"clap",reactionCount:0,reactionImagePath:ha,numberOfAnimationFrames:40}),Object.assign(new No,{react:"laugh",reactionCount:0,reactionImagePath:za,numberOfAnimationFrames:77}),
Object.assign(new No,{react:"surprised",reactionCount:0,reactionImagePath:Ra,numberOfAnimationFrames:68}),Object.assign(new No,{react:"wonder",reactionCount:0,reactionImagePath:qb,numberOfAnimationFrames:70})];this.Dhb=new Map;this.xac=1;this.D1c=null}Shh(){if(this.ola){for(const t of this.ola)t.reactionCount=0;this.oj&&this.oj.resetReactions()}}Zgk(t){if(this.Dhb){var N=this.Dhb.has(t.slideId)?this.Dhb.get(t.slideId)+1:1;this.Dhb.set(t.slideId,N)}if(this.ola&&!this.bQa&&this.bke){for(const ha of this.ola)if(ha.react===
t.react){ha.reactionCount+=1;break}if(this.oj){t=Array(this.ola.length);for(N=0;N<this.ola.length;N++)t[N]=Object.assign(new No,{react:this.ola[N].react,reactionCount:this.ola[N].reactionCount,reactionImagePath:this.ola[N].reactionImagePath,numberOfAnimationFrames:this.ola[N].numberOfAnimationFrames});this.oj.setReactions(t)}}}aKb(t){return new Promise(N=>{if(this.lr&&this.Mn&&this.Ep)try{if(1>this.Dhb.size)K.a.J(512496160,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",
this.Bd.telemetryData.sessionId,t),N(!0);else if(2===t&&(!this.sta||1>this.sta.size))K.a.J(512496159,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",this.Bd.telemetryData.sessionId,t),N(!0);else{var ha=null,za=0;this.Dhb.forEach((qb,Qb)=>{qb>za&&(ha=Qb.toString(),za=qb)});if(this.D1c&&ha===this.D1c)K.a.J(512496158,833,50,"SessionId: {0}, Message: Already trigger for slideId, skip save thumbnails request, Reason: {1}",this.Bd.telemetryData.sessionId,
t),N(!0);else{var Ra=this.Mn.TriggerSaveThumbnails(()=>this.l0b("SaveThumbnails",this.Bd.telemetryData.sessionId),ha);Ra?Ra.then(()=>{this.D1c=ha;K.a.J(512496156,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",this.Bd.telemetryData.sessionId,t);N(!0)}).catch(qb=>{K.a.J(512496155,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",this.Bd.telemetryData.sessionId,qb.toString(),t);N(!1)}):(this.Bd.telemetryData.SetErrorCode(15,
"Triggering save thumbnails failed to created Promise object!"),K.a.J(512496157,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),N(!1))}}}catch(qb){this.Bd.telemetryData.SetErrorCode(15,qb.toString()),K.a.J(512496154,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",this.Bd.telemetryData.sessionId,qb.toString()),N(!1)}else N(!0)})}ZPa(){return this.la.pptEditorVoiceUXEnabled&&this.Bl&&this.Bl.instance?!0:!1}Pui(t){if(this.ZPa())switch(t){case 0:this.lFa&&
this.Bl.instance.show(ResourceStrings.L_LivePresentations_Disconnected,Qm.a.zWa);this.Bd.telemetryData.SetErrorCode(3);this.g_("DisconnectdToPrague");break;case 1:this.Bl.instance.hide();break;case 2:this.lFa&&this.Bl.instance.show(ResourceStrings.L_LivePresentations_Connecting,Qm.a.bDb);break;default:K.a.J(512496152,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Bd.telemetryData.sessionId)}else K.a.J(512496153,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",
this.Bd.telemetryData.sessionId)}Rec(t,N){this.ZPa()?N.isConnected?this.Bl.instance.hide():this.lFa&&this.Bl.instance.show(ResourceStrings.L_LivePresentations_InternetDisconnected,Qm.a.bDb):K.a.J(512496151,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Bd.telemetryData.sessionId)}i1d(t,N){t=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",this.la.podsWebServiceBase,t,N);this.la.aAk&&(t+="&shareable=true");return t}Bql(t,
N){try{const ha=new C.a;if(1===t||2===t||4===t)ha.add(this.dnd(3)),ha.add(this.aKb(3));ha.count?Promise.all(ha.toArray()).then(()=>N()).catch(()=>N()):N()}catch(ha){K.a.J(512496150,833,10,"failed to create end session task promises, error : {0}",ha),N()}}get JWe(){const t=mk.a.get("PPTLivePresentationOnboarded");return t?"true"===t.toLowerCase():!1}set JWe(t){mk.a.aM("PPTLivePresentationOnboarded",t.toString(),mk.a.JL)||K.a.J(512496149,833,10,"Failed to set cookie for PPTLivePresentationOnboarded to {0}",
t.toString())}FWd(){return this.la.DAk&&!this.JWe}d$(){try{if(K.a.J(512496148,833,15,"Pods session rehydrated!"),this.t_c=!0,this.lr&&this.Rq&&this.Mn){K.a.J(512496147,833,15,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Bd.telemetryData.sessionId,this.Xa.fk);const t=this.i1d(this.Xa.podSessionId,this.Xa.fk);this.Mn.OnPodSessionUpdated(t)}}catch(t){K.a.J(512496146,833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",t.toString())}}BDb(){this.t_c=
!1}onPodSessionExpired(){this.t_c=!1}Hib(){if(this.la.EAk)try{const t=u.a.instance.Ka("Common.ISystemInitiatedFeedback");t&&(K.a.J(512496145,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),t.execute(N=>{N.logActivity("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(t){K.a.J(512496144,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",t)}}leg(t){const N=document.createElement("a");N.setAttribute("href",
t);return(t=N.search.match(RegExp("[\\?&]Id=([^&#]*)")))&&2===t.length?t[1]:""}YYi(){var t=this.uc.Rfj();let N=1;this.Cse.clear();for(const ha of t){t=ha.jl();for(const za of t)if(!gb.a.Va(za.Ldb)){t=this.leg(za.Ldb);const Ra=new Xr;Ra.QOg=t;Ra.ROg=N.toString();this.Cse.add(Ra);N+=1}}}Kzh(){var t=this.uc.VCa(this.S$a).jl();for(const N of t)gb.a.Va(N.Ldb)||(t=this.leg(N.Ldb),t=this.Bse.get(t),gb.a.Va(t)||this.Mn.SetCurrentPollInfoState(t,this.S$a))}P6h(t){this.va.addHandler("OnLiveResourcesLoaded",
t)}hSk(t){this.va.removeHandler("OnLiveResourcesLoaded",t)}mFf(t){this.va.addHandler("OnLiveSessionStarted",t)}vfh(t){this.va.removeHandler("OnLiveSessionStarted",t)}kFf(t){this.va.addHandler("OnLiveSessionEnded",t)}ufh(t){this.va.removeHandler("OnLiveSessionEnded",t)}$5h(t){this.va.addHandler("OnCalloutDismissed",t)}ERk(t){this.va.removeHandler("OnCalloutDismissed",t)}iFf(t){this.va.addHandler("OnRelaunchPausedSession",t)}sfh(t){this.va.removeHandler("OnRelaunchPausedSession",t)}a6h(t){this.va.addHandler("CalloutMenuDefinitionChanged",
t)}FRk(t){this.va.removeHandler("CalloutMenuDefinitionChanged",t)}}Object(h.a)(Zs,"LivePresenter",null,[672]);class nk{constructor(){this.K=null;this.nOg=0}get name(){return"PowerPointWebEditor.Live"}Wb(t){this.K=t;const N=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(672,"PowerPointLive.ILivePresenter").ma().na(()=>new Zs(this.K.resolve("PowerPointWebEditor.IApplicationSettings"),N,this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPoint.IPathManager"),
this.K.resolve("Common.App.OAuth.IOAuthManager"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.Core.ICoreEventHandler"),this.K.resolve("PowerPointWebEditor.Core.IPodsPopsEventHandler"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.ISubtitleContext"),u.a.instance.Ka("PowerPointWebEditor.ISlideShowVoiceNotification"),this.K.resolve("PowerPointWebEditor.Core.INetworkConnectivityProvider"),
this.K.resolve("PowerPointWebEditor.IFocusManager")))}nWj(){try{this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled?(this.nOg=Date.now(),K.a.J(42869339,833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts"),hb.a.get_instance().gk(7,()=>{const t=this.K.resolve("Common.IDynamicScriptLoaderProvider").Jv,N=yn.a(this.K),ha=new C.a;ha.add(t.loadScript("PPTLiveBroadcast"));ha.add(t.loadScript("BroadcastMonitor"));ha.add(N("liveActor"));v.AFrameworkApplication.Aa.jb.Up||
ha.add(N("uiFabricLazy"));Promise.all(ha.toArray()).then(()=>this.Lnk()).catch(za=>K.a.J(42869341,833,10,"Failed to load scripts for the Live Presenter feature: {0}",za))})):K.a.J(42869337,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(t){K.a.J(42869343,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",t)}}Gm(){try{if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").powerPointLiveBroadcastEnabled){if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").wAk){const t=
gb.a.WV((v.AFrameworkApplication.fileName||"").toLowerCase());if(".ppt"===t||".pps"===t){K.a.J(592238732,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format by checking file extension.");return}".pptx"!==t&&K.a.J(592238730,833,15,"PPTWebEditorLivePackage: Allowing file extension: "+t)}this.K.resolve("PowerPointWebEditor.IApplicationSettings").zAk&&this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(4)?K.a.J(592328917,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for binary file format."):
this.K.resolve("PowerPointWebEditor.IApplicationSettings").AAk&&(this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32)||this.K.resolve("PowerPointWebEditor.Core.IUnifiedAppState").getState(32768))?K.a.J(592189026,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for protected file."):this.K.resolve("PowerPointWebEditor.IApplicationSettings").U7g&&"msa"===this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType?K.a.J(591685859,833,50,"PPTWebEditorLivePackage: Disabling Live broadcast feature for MSA users."):
this.K.Ka("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(t=>{t.isFeatureEnabled("PowerPointLivePresentations",!1).then(N=>{N?this.nWj():(K.a.J(592472007,822,50,"User doesn't have license for Live broadcast feature. Skipping loading Live package!"),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLive",!0)))})})}else K.a.J(592472009,833,50,"PPTWebEditorLivePackage: Live broadcast feature is not enabled.")}catch(t){K.a.J(592472005,833,10,"OnFullAppSettingsReady: exception in OnFullAppSettingsReady: {0}",
t)}}Lnk(){K.a.J(50860060,833,50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-this.nOg);this.K.resolve("PowerPointLive.ILivePresenter").$5a=!0;this.K.resolve("PowerPointWebEditor.IApplicationSettings").U7g||"msa"!==this.K.resolve("PowerPointWebEditor.IApplicationSettings").hostAuthType||appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("PresentLiveSetAccessControlOrganization",!0));return null}init(){v.AFrameworkApplication.fa.ff(Object(r.a)(this,this.Gm,"onFullAppSettingsReady"))}dispose(){}static main(){e.a.instance.Bc(new nk)}}
Object(h.a)(nk,"PPTWebEditorLivePackage",null,[2,3]);var so=d(708);class np{}Object(h.a)(np,"LokiTokenResult",null,[]);class aq{constructor(t){this.owc=t}Z8i(){const t=this.Y8i();return t?aq.bbe?new Promise((N,ha)=>{this.owc.continueWith(()=>{this.owc.Jn||this.owc.hm?ha(Error.create("Error downloading auth library")):this.owc.result.KU("Loki",t).then(za=>{za=v.AFrameworkApplication.fa.ka("ForceLokiFallbackToACLPTokenIsEnabled")?this.b9i():za.IsSuccess&&za.Token?Object.assign(new np,{isSuccess:!0,
token:za.Token,errorMessage:null}):Object.assign(new np,{isSuccess:!1,token:null,errorMessage:JSON.stringify(za)});N(za);return za})})}):Promise.resolve(Object.assign(new np,{isSuccess:!1,token:null,errorMessage:"Not attempting to fetch token because host is not an O365 host."})):Promise.resolve(Object.assign(new np,{isSuccess:!1,token:null,errorMessage:String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",so.a.V8f())}))}b9i(){const t=v.AFrameworkApplication.fa.Ga("LokiUserDataSignature")||
"";return Object.assign(new np,{isSuccess:!0,token:t,errorMessage:null})}Y8i(){let t=null;const N=so.a.kMc();2===N?t=v.AFrameworkApplication.fa.Ga("LokiAADAppId"):1===N&&(t=v.AFrameworkApplication.fa.Ga("LokiMSAAppId"));return t}static get bbe(){return v.AFrameworkApplication.fa.ka("IsO365CommercialHost")||v.AFrameworkApplication.fa.ka("IsO365ConsumerHost")}}Object(h.a)(aq,"LokiTokenManager",null,[709]);class Ln{get name(){return"Common.App.LivePersonaUtils"}init(){u.a.instance.resolve("Common.ILokiTokenManager")}dispose(){}Wb(t){t.register(aq,
"Common.App.LivePersonaUtils.LokiTokenManager").as("Common.ILokiTokenManager").ma().na(()=>new aq(rg.a.Ju(t.Ka("Common.App.OAuth.IOAuthManager"))))}static main(){e.a.instance.Bc(new Ln)}}Object(h.a)(Ln,"LivePersonaUtilsPackage",null,[2,3]);var $s=d(259);class Wk{constructor(){this.displayName=this.critique=null;this.optOut=!1;this.category=null}}Object(h.a)(Wk,"RehearsalCritique",null,[]);class Pe{static czj(){Pe.OX[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue;Pe.OX[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise;
Pe.OX[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud;Pe.OX[5]=ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet;Pe.qYf=ResourceStrings.L_SubtitleDetection_MicReady;Pe.rYf=ResourceStrings.L_SubtitleDetection_SoundReminder;Pe.k2f=ResourceStrings.L_SubtitleDetection_NoMicrophone;Pe.q2f=ResourceStrings.l_NoCamera;Pe.s8f=ResourceStrings.L_SpeechGenericRetryErrorMessage}}Pe.nMf=20;Pe.Idh=50002;Pe.OX=Array(Pe.nMf);Pe.qYf=null;Pe.rYf=null;Pe.k2f=null;Pe.q2f=null;Pe.s8f=null;Pe.tXd="fillerWords";
Pe.ktk="originality";Pe.zDl="wordsPerMinute";Pe.H1k="sensitivePhrases";Pe.vxi="correctedSensitivePhrases";Pe.ozk="positivity";Pe.N4d="grammar";Pe.zue="monotone";Pe.MCe="pronunciation";Pe.$Rd="crutchWords";Pe.ZFh="visionFace";Pe.aCl="visionGaze";Pe.$Bl="visionGazeGood";Pe.cCl="visionOcclusion";Pe.bCl="visionOcclusionGood";Pe.XBl="visionDistanceGood";Pe.YBl="visionDistanceTooClose";Pe.ZBl="visionDistanceTooFar";Pe.mgg="GetStartedButton";Pe.EVj="ListeningButtonPlayPauseButton";Pe.FVj="ListeningElement";
Pe.jvi="ContainerElement";Pe.Pwk="PausedElement";Pe.$hk="NotificationButtonElement";Pe.HCl="WelcomeCheckboxElement";Pe.Kdh="RehearsalFeedbackSettingPane";Pe.mBe="PPTCoachRehearsalFREShown";Object(h.a)(Pe,"RehearsalResourceString",null,[]);const pm=(t,N)=>gb.a.Va(N)?(m.ULS.sendTraceTag(587872E3,822,10,"RehearsalUtils:IsCritiqueEnabled Invalid critique name"),!1):t?N.toLowerCase()in t:!0,Po=(t,N)=>{let ha=null;try{if(!t||gb.a.Va(N))return m.ULS.sendTraceTag(587871971,822,10,"RehearsalUtils:getSupportedCritiquesForLanguage SourceLanguage from session information or appsettings is null or empty"),
null;const Ra=gb.a.Va(t.qed)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(t.qed,!0);ha={};for(let qb in Ra){t=qb;var za=Ra[qb];if(za){const Qb=pg.a.nVb(za.split(","));Qb&&N.toLowerCase()in Qb&&(ha[t.toLowerCase()]=!0)}}}catch(Ra){K.a.J(590136391,817,10,"RehearsalUtils:getSupportedCritiquesForLanguage Exception while building supported critique map from BRS: {0}",Ra.toString()),ha=null}return ha},lr=(t,N)=>{if(gb.a.Va(N)||gb.a.Va(t.S6g))return null;try{var ha=Sys.Serialization.JavaScriptSerializer.deserialize(t.S6g,
!0);if(gb.a.Va(N)){m.ULS.sendTraceTag(587871968,822,50,"RehearsalUtils:GetLanguageCodeFromLocale locale is null or empty.");var za=null}else za=N.split("-")[0].toLowerCase();return ha[za]}catch(Ra){return K.a.J(587872025,817,10,"RehearsalUtils:getPacingGaugeRangeLocale Exception while parsing BRS PodRehearsalLocaleBasedPacingGaugeRange: {0}",Ra.toString()),null}},op=t=>{if(t&&3<t.length){let N="";"ws"===t.substring(0,2)?N="http"+t.substring(2,t.length):"wss"===t.substring(0,3)&&(N="https"+t.substring(3,
t.length));return N}return t},Qo=t=>{if(gb.a.Va(t))return m.ULS.sendTraceTag(559548251,822,10,"GetMappedSourceLanguage: SourceLanguage from session information is not valid, defaulting to english. SourceLanguage: {0}",t),"en-US";switch(t.toLowerCase()){case "en-au":case "en-ca":case "en-gb":case "en-in":case "en-us":return"en-US";default:return t}};class ti{constructor(){this.userCritiques=null}}Object(h.a)(ti,"RehearseRoamingSettings",null,[]);class Ro{constructor(){this.critiquesDisabledByDefault=
this.critiquesDisabled=null}}Object(h.a)(Ro,"UserCritiqueSettings",null,[]);class at{constructor(t,N,ha,za){this.va=new Qk.a;this.SI=this.y8b=this.DT=null;this.jL=!1;this.ZFg=null;this.Mua=this.Nua=0;this.ew=t;this.la=N;this.JFa=ha;this.ia=za}eBj(){try{this.Neg(()=>{this.va.raiseEvent("OnRehearsalOptOutSettingsRequestFinished",new Sys.EventArgs)})}catch(t){K.a.J(557602759,822,10,"InitiateRehearsalOptOutSettingsRequest catched exception: {0}",t.toString())}}mVc(){return 2===this.Nua&&2===this.Mua}nUe(){try{0!==
this.Nua&&3!==this.Nua||this.Neg(Object(r.a)(this,this.qEe,"raiseRehearsalGetCritiquesEvent")),0!==this.Mua&&3!==this.Mua||this.Q4i()}catch(t){K.a.J(559548259,822,10,"TryToInitiateCritiquesFetchingRequest catched exception: {0}",t.toString())}}L2i(){if(!this.y8b)return K.a.J(559548288,822,10,"GetCritiquesListForSettingsPane empty critique list"),null;try{if(this.SI)for(let t of this.y8b)this.SI.contains(t.critique.toLowerCase())?t.optOut=!0:t.optOut=!1}catch(t){K.a.J(557602760,822,10,"GetCritiquesListForSettingsPane catched exception: {0}",
t.toString())}return this.y8b.toArray()}Axl(t,N){this.UDh(t,N);"vision"===t.toLowerCase()&&(this.jL=!N,t={},t.triggerPoint=Pe.Kdh,this.ia.La(vb.a.hoc,2,t))}Fdg(t=!1){let N="";if(this.SI&&0<this.SI.count)if(dd.a("RehearsalFilterOptOutCritiqueEnabled")&&t){a:{var ha=this.la;t=this.la.wwa;var za=null;try{if(!ha||gb.a.Va(t)){m.ULS.sendTraceTag(554837597,822,10,"RehearsalUtils:getCritiquesStatusForLanguage SourceLanguage from session information or appsettings is null or empty");var Ra=null;break a}var qb=
gb.a.Va(ha.qed)?{}:Sys.Serialization.JavaScriptSerializer.deserialize(ha.qed,!0);za={};for(let vc in qb){Ra=vc;var Qb=qb[vc];if(Qb){const Zc=pg.a.nVb(Qb.split(","));za[Ra.toLowerCase()]=Zc&&t.toLowerCase()in Zc?!0:!1}}}catch(vc){K.a.J(554837598,817,10,"RehearsalUtils:getCritiquesStatusForLanguage Exception while building supported critique map from BRS: {0}",vc.toString()),za=null}Ra=za}if(Qb=Ra)for(let vc of this.SI)if(qb="vision"===vc?Pe.ZFh.toLowerCase():vc.toLowerCase(),qb in Qb?Qb[qb]:1)N=gb.a.Va(N)?
vc.toLowerCase():N+","+vc.toLowerCase()}else for(za of this.SI)N=gb.a.Va(N)?za.toLowerCase():N+","+za.toLowerCase();return N}ugd(){if(2!==this.Nua)K.a.J(557602761,822,50,"SaveRehearseUserCritiques(), skipping save operation as Get request call is not succeeded");else if(this.TOj()){K.a.J(559548291,822,50,"SaveRehearseUserCritiques(), Start sending write request to FE");var t=new ti;t.userCritiques=Object.assign(new Ro,{critiquesDisabled:this.Fdg(),critiquesDisabledByDefault:this.DT.userCritiques.critiquesDisabledByDefault});
var N=Ed.c(t),ha=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","savePowerPointRehearseUserCritiques",v.AFrameworkApplication.hh),za={};za["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.ew.yj(ha,2,N,za,!1,2,Ra=>{this.bqk(Ra,t)},Object(r.a)(this,this.aqk,"onSaveUserCritiquesFailed"),null,void 0,void 0,void 0,void 0,$s.a("17"))}else K.a.J(559548290,822,50,"SaveRehearseUserCritiques(), skipping save operation")}get RWd(){return this.jL}set RWd(t){this.jL=
t;this.UDh("vision",!this.jL);this.mVc()&&this.va.raiseEvent("OnRehearsalSettingsUpdatedExternally",Sys.EventArgs.Empty)}I6h(t){this.va.addHandler("OnRehearsalOptOutSettingsRequestFinished",t)}cSk(t){this.va.removeHandler("OnRehearsalOptOutSettingsRequestFinished",t)}H6h(t){this.va.addHandler("OnRehearsalGetCritiquesSucceeded",t)}bSk(t){this.va.removeHandler("OnRehearsalGetCritiquesSucceeded",t)}G6h(t){this.va.addHandler("OnRehearsalGetCritiquesFailed",t)}aSk(t){this.va.removeHandler("OnRehearsalGetCritiquesFailed",
t)}J6h(t){this.va.addHandler("OnRehearsalSettingsUpdatedExternally",t)}dSk(t){this.va.removeHandler("OnRehearsalSettingsUpdatedExternally",t)}UDh(t,N){this.SI&&(t=t.toLowerCase(),N&&!this.SI.contains(t)?this.SI.add(t):!N&&this.SI.contains(t)&&this.SI.remove(t),dd.a("RehearsalRoamingSettingAutoSaveEnabled")&&this.ugd())}TOj(){let t=!1;try{var N=gb.a.Va(this.DT.userCritiques.critiquesDisabled);if(!this.SI||!this.SI.count&&N)return!1;if(N&&0<this.SI.count||!N&&!this.SI.count)return!0;const ha=new Set(this.DT.userCritiques.critiquesDisabled.split(","));
if(this.SI.count!==ha.size)return!0;for(N=0;N<this.SI.count;N++)if(!ha.has(this.SI.ga(N).toLowerCase())){t=!0;break}}catch(ha){K.a.J(557602762,822,10,"IsSaveRehearsalSettingsRequired catched exception: {0}",ha.toString())}return t}bqk(t,N){this.DT=N;K.a.J(559548292,822,50,"OnSaveUserCritiquesSucceeded, TotalTimeMs:{0}, QueueTimeMs:{1}",+t.data.Wu-+t.data.aI,+t.data.Kt-+t.data.aI)}aqk(t){const N=this.JFa.Nia(t);K.a.J(559548293,822,50,"OnSaveUserCritiquesFailed: Web service failed with {0}, NumSlides={1}",
N,t.data.state)}Neg(t){const N=this.la.roamingServiceHandlerWebServiceBase+String.format("RoamingServiceHandler.ashx?action={0}&{1}","getPowerPointRehearseUserCritiques",v.AFrameworkApplication.hh),ha={};ha["X-StatelessPopsAffinityRoutingEnabled"]=this.la.pptStatelessPOPSRequestAffinityEnabled.toString();this.ew.yj(N,1,null,ha,!1,2,za=>{this.Nmk(za,t)},za=>{this.Mmk(za,t)},null,void 0,void 0,void 0,void 0,$s.a("16"));this.Nua=1}Nmk(t,N){let ha=0;try{t.data.Sd&&0<t.data.Sd.trim().length&&(ha=t.data.Sd.length,
this.DT=JSON.parse(t.data.Sd));this.DT&&this.DT.userCritiques||(this.DT=new ti,this.DT.userCritiques=new Ro);gb.a.Va(this.DT.userCritiques.critiquesDisabledByDefault)&&(this.DT.userCritiques.critiquesDisabledByDefault="vision",gb.a.Va(this.DT.userCritiques.critiquesDisabled)?this.DT.userCritiques.critiquesDisabled="vision":this.DT.userCritiques.critiquesDisabled+=",vision");this.SI=new C.a;if(!gb.a.Va(this.DT.userCritiques.critiquesDisabled)){const za=this.DT.userCritiques.critiquesDisabled.split(",");
for(const Ra of za)this.SI.add(Ra.toLowerCase())}this.jL=!this.SI.contains("vision");this.Nua=2}catch(za){this.Nua=3,K.a.J(559548294,822,10,"OnGetUserCritiquesSucceeded catched exception: {0}",za.toString())}N&&N();t=String.format("OnGetUserCritiquesSucceeded, responseSize={0}, EnqueueTime={1}, InvokedTime={2}, CompletedTime={3}",ha,JSON.stringify(t.data.aI),JSON.stringify(t.data.Kt),JSON.stringify(t.data.Wu));K.a.J(559548295,822,50,t)}Mmk(t,N){this.Nua=3;N&&N();t=this.JFa.Nia(t);K.a.J(559548296,
822,50,"OnGetUserCritiquesFailed: Web service failed with {0}",t)}Q4i(){try{const N=this.cSi();if(gb.a.Va(N))K.a.J(559548297,822,10,"GetEnabledCritiquesForClientAndLocale failed to generate FD url for GetCritiques request");else{var t=new XMLHttpRequest;t.open("GET",N,!0);t.onreadystatechange=()=>{if(4===t.readyState){if(200===t.status){K.a.J(559548298,822,50,"GetEnabledCritiquesForClientAndLocale: GetCritiques call successfuly completed");const ha=Ed.b(t.responseText);if(ha){this.y8b=new C.a;for(const za of ha.critiquesData)this.y8b.add(Object.assign(new Wk,
{category:za.category,displayName:za.displayName,optOut:!1,critique:za.critique.toLowerCase()}));this.ZFg=ha.categoriesData;this.Mua=2}else this.Mua=3}else this.Mua=3;this.qEe()}};t.send("");this.Mua=1}}catch(N){this.Mua=3,this.qEe(),K.a.J(559548299,822,10,"GetEnabledCritiquesForClientAndLocale catched exception: {0}",N.toString())}}cSi(){const t=Ed.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).Ring||"Unknown",N=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");
return N&&N.length?String.format("{0}GetCritiqueListHandler.ashx?action=GetCritiqueList&client=web&audiencegroup={1}&locale={2}",N,t,Qo(this.la.wwa)):null}qEe(){0!==this.Nua&&1!==this.Nua&&0!==this.Mua&&1!==this.Mua&&(this.mVc()?this.va.raiseEvent("OnRehearsalGetCritiquesSucceeded",new Sys.EventArgs):this.va.raiseEvent("OnRehearsalGetCritiquesFailed",new Sys.EventArgs))}}Object(h.a)(at,"RehearsalFeedbackSettings",null,[643]);class Iq{constructor(){this.type="RehearsalCritiqueWithGroupProps";this.retryToFetchCritiqueSettings=
this.locale=this.updateCritiqueState=this.categoriesData=this.groupItems=null;this.isExternalUpdated=this.showErrorMessage=this.showLoadingMessage=!1}}Object(h.a)(Iq,"RehearsalCritiqueWithGroupProps",null,[]);class bq{constructor(t,N,ha,za,Ra){this.DFa=this.Db=!1;t.loadScript("powerpoint-presenter-coach-strings").then(()=>{this.DFa=!0;K.a.J(559548252,822,50,"powerpoint-presenter-coach-strings loaded successfully")}).catch(qb=>{K.a.J(559548253,822,10,"Failed to load powerpoint-presenter-coach-strings "+
qb.toString())});this.ia=N;this.la=Ra;this.RD=ha;this.Wx=za;this.ia.Jma(this)}ub(){this.ia.ya(vb.a.Ijd,pb.a.application,Object(r.a)(this,this.Ijd,"showRehearsalFeedbackSettingsPane"));this.ia.ya(vb.a.cOe,pb.a.application,Object(r.a)(this,this.cOe,"showHideRehearsalFeedbackSettingsPane"));this.ia.pa(vb.a.GDe,pb.a.application,Object(r.a)(this,this.GDe,"queryShowHideRehearsalFeedbackSettingsPane"),96)}xe(){}a$(){}Z9(){}Ijd(t,N,ha){if(N.contextId!==pb.a.application||!this.DFa)return 2;if(1===ha)return 32;
this.Db?Bc.UISurfaces.Ms().then(za=>{za.setSelectedTaskPane(kd.a.ufb);this.jA(!0);return null}).catch(za=>{K.a.J(554447887,822,10,"RehearsalFeedbackSettingsPane::ShowRehearsalFeedbackSettingsPane exception: {0}",za.toString())}):(this.Db=!0,this.Fdh(),(t=!this.Wx.mVc())&&this.Wx.nUe(),t=this.YB(t,!1),this.fmc(t),K.a.J(555832795,822,50,"RehearsalFeedbackSettingsPaneActor::ShowRehearsalFeedbackSettingsPane"));return 32}cOe(t,N,ha){if(N.contextId!==pb.a.application||!this.DFa)return 2;if(1===ha)return 32;
(this.Db=!this.Db)?(this.Fdh(),(t=!this.Wx.mVc())&&this.Wx.nUe(),t=this.YB(t,!1),this.fmc(t),K.a.J(559548254,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane show")):(this.xqi(),K.a.J(559548255,822,50,"RehearsalFeedbackSettingsPaneActor::ShowHideRehearsalFeedbackSettingsPane close"));return 32}GDe(t,N,ha,za,Ra){if(!Object(Fi.a)(ym.a,Ra))return 8;Ra.Nf(this.Db);return 32}fmc(t,N=!1){const ha=Object.assign(new yb.a,{title:ResourceStrings.L_RehearseFeedbackSettings,hideHeader:!1,
width:320,location:2,contentProps:t,onOpen:()=>{},onClose:()=>{this.Db=!1;this.TGi();this.Wx.ugd()},onHide:()=>{this.Wx.ugd()},isModernPane:!0});t=document.getElementById("RehearsalFeedbackSettingsPaneFocus-panel");this.RD.T7(kd.a.ufb,kd.a.jj,t,()=>{this.jA(!0)},()=>{this.jA(!1)});Bc.UISurfaces.Ms().then(za=>{N?this.Db&&za.updateTaskPane(kd.a.ufb,ha):za.showTaskPane(kd.a.ufb,ha);return null}).catch(za=>{K.a.J(559548256,822,10,"RehearsalFeedbackSettingsPaneActor::ShowFeedbackSettingPane exception: {0}",
za.toString())})}xqi(){Bc.UISurfaces.Ms().then(t=>{t.hideTaskPane(kd.a.ufb,2);return null}).catch(t=>{K.a.J(559548257,822,10,"RehearsalFeedbackSettingsPaneActor::CloseFeedbackSettingPane exception: {0}",t.toString())})}YB(t,N){return Object.assign(new Iq,{groupItems:t||N?null:this.Wx.L2i(),categoriesData:this.Wx.ZFg,locale:this.la.wwa,updateCritiqueState:(ha,za)=>{this.Wx.Axl(ha,za)},retryToFetchCritiqueSettings:()=>{this.Wx.nUe()},showLoadingMessage:t,showErrorMessage:N})}jA(t){const N=document.getElementById("TaskPaneCloseBtnRehearsalFeedbackSettingsPaneFocus");
t&&N&&N.focus()}Fdh(){this.Wx.H6h(Object(r.a)(this,this.F1g,"onRehearsalGetCritiquesSucceeded"));this.Wx.G6h(Object(r.a)(this,this.E1g,"onRehearsalGetCritiquesFailed"));this.Wx.J6h(Object(r.a)(this,this.H1g,"onRehearsalSettingsUpdatedExternally"))}TGi(){this.Wx.bSk(Object(r.a)(this,this.F1g,"onRehearsalGetCritiquesSucceeded"));this.Wx.aSk(Object(r.a)(this,this.E1g,"onRehearsalGetCritiquesFailed"));this.Wx.dSk(Object(r.a)(this,this.H1g,"onRehearsalSettingsUpdatedExternally"))}F1g(){const t=this.YB(!1,
!1);this.fmc(t,!0)}E1g(){const t=this.YB(!1,!0);this.fmc(t,!0)}H1g(){const t=this.YB(!1,!1);t.isExternalUpdated=!0;this.fmc(t,!0)}}Object(h.a)(bq,"RehearsalFeedbackSettingsPane",null,[147]);var kn;(function(t){t[t.none=0]="none";t[t.ribbon=1]="ribbon";t[t.slideShowToolbar=2]="slideShowToolbar";t[t.summaryPage=3]="summaryPage";t[t.ribbonTopBar=4]="ribbonTopBar";t[t.deepLink=5]="deepLink"})(kn||(kn={}));Object(h.b)("RehearsalEntryPoint",kn);class Yr{constructor(){this.imagesBaseFilePath=this.slideState=
this.rootContainer=null;this.zIndex=0;this.fUseCountdownWelcomeScreen=this.fShowRealtimeFeedbackEnabledCheckbox=this.fEnableVision=!1;this.speechFDBase=null;this.fUseNewRealtimeCheckbox=this.fUseNewRealtimePanel=this.fDontShowTooltips=!1}}Object(h.a)(Yr,"ICoachActorConfig",null,[]);class ln{constructor(){this.rootContainer=this.imagesBaseFilePath=null;this.zIndex=0}}Object(h.a)(ln,"ICoachFREActorConfig",null,[]);class bt{constructor(){this.customSettings=this.requestedRehearsalOptOutFeatures=this.requestedCoachFeatures=
this.documentDownloadConfig=this.userSessionId=this.disabledCoachRealtimeFeatures=this.logger=null;this.fEnableVision=!1;this.supportedRehearsalTemplates=this.sourceLanguage=this.entryPoint=this.wacDatacenter=this.wacHost=this.locale=this.buildVersion=this.audienceGroup=this.audienceChannel=this.identityProvider=this.tenantId=this.userId=this.speechFDBase=this.webcamConfig=null;this.fEnableServiceSideAggregationForCoach=!1;this.httpTimeoutForCoachSummaryData=0;this.enableTimeStampedCritiqueTelemetry=
this.fSendClientMetaDataOnSessionStart=!1;this.audioInputDeviceCount=0}}Object(h.a)(bt,"ICoachSessionConfig",null,[]);class mr{constructor(){this.docId=this.podsSessionId=this.webServiceBase=this.userDataCenterClusterId=null}}Object(h.a)(mr,"IDocumentDownloadConfig",null,[]);class cq{constructor(){this.totalSlideCount=this.currentSlideIndex=0}}Object(h.a)(cq,"ISlideState",null,[]);class nr{constructor(){this.workingCanvas=this.videoView=null;this.requestedVideoHeight=this.requestedVideoWidth=this.webcamFrameWidth=
this.numFramesPerSecond=0}}Object(h.a)(nr,"IWebcamConfig",null,[]);var Jq=d(664);class Kq{constructor(t,N,ha,za,Ra,qb,Qb,vc,Zc,Wc,Md,Id,Xe,of){this.iUa=!1;this.fw=this.Yge=this.MW=this.ada=null;this.Cbc=0;this.oPg=-1;this.Hcc=0;this.r6c=this.i6c=null;this.eke=this.Vje=!1;this.zqe=this.pla=0;this.jL=!1;this.va=new Qk.a;this.KVa=null;this.vIg=this.nte=this.cge=!1;this.Bqe=null;this.T7b=this.kGg=0;this.mRg=this.PHg=!1;this.WHg=v.AFrameworkApplication.fa.ka("FirstRehearsalExperienceEnabled");this.r2j=
ha;N&&(this.ada=N.hF());this.hb=za;this.ia=t;this.uc=Ra;this.ua=qb;this.Xa=Qb;this.la=vc;this.Bl=Zc;this.pda=Wc;this.Bbc=Md;this.Wx=Id;this.IN=Xe;this.ZD=of;this.g_b()&&this.Wx.I6h(Object(r.a)(this,this.G1g,"onRehearsalOptOutSettingsRequestFinished"))}ub(){this.ia.ya(vb.a.Lmc,pb.a.application,Object(r.a)(this,this.Lmc,"startRehearsalManager"));this.ia.ya(vb.a.hoc,pb.a.application,Object(r.a)(this,this.hoc,"toggleRehearsalVisionEnabled"));this.ia.ya(vb.a.sed,pb.a.application,Object(r.a)(this,this.sed,
"rehearsePresentationDropDown"));this.ia.pa(vb.a.iic,pb.a.application,Object(r.a)(this,this.iic,"queryRehearsalVisionEnabled"),96)}iic(t,N,ha,za,Ra){if(!Ra||!Object(Fi.a)(ym.a,Ra))return K.a.J(512496082,822,10,"RehearsalManager::QueryRehearsalVisionEnabled requires actionData"),8;Ra.Nf(this.jL);return 32}sed(t,N,ha){switch(ha){case 1:if(this.iUa&&this.Sce())return this.ia.processAction(vb.a.Kma,1);break;default:K.a.J(512496081,822,10,"RehearsePresentationDropDown: Unimplemented action behavior")}return 8}hoc(t,
N,ha,za,Ra){switch(ha){case 2:return this.jL=!this.jL,v.AFrameworkApplication.Aa&&v.AFrameworkApplication.Aa.jb.Up&&vi.App.Hb.VF({ToggleRehearsalVisionEnabled:"CheckboxModel"}),this.g_b()&&Ra&&Ra.triggerPoint!==Pe.Kdh&&(this.Wx.RWd=this.jL),32;case 1:if(this.iUa&&this.Sce())return 32;break;default:K.a.J(512496080,822,10,"ToggleVisionEnabled: Unimplemented action behavior")}return 8}Lmc(t,N,ha,za,Ra){switch(ha){case 2:return this.$il(Ra),32;case 1:if(this.iUa&&this.Sce())return 32;break;default:K.a.J(512496079,
822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8}h7b(){try{this.kGg=Date.now();const t=this.r2j.Jv;t.loadScript("powerpoint-presenter-coach-strings").then(()=>{const N=new C.a;N.add(t.loadScript("CoachActorPackage"));N.add(t.loadScript("CoachPackage"));Promise.all(N.toArray()).then(()=>{this.Ikk();return null}).catch(ha=>{K.a.J(512496078,801,10,"Failed to load scripts for the Presenter Coach feature: {0}",ha);return null})})}catch(t){K.a.J(512496077,822,10,"RehearsalManager: Exception in LoadResources : {0}.",
t)}}b6h(t){this.va.addHandler("OnCoachResourcesLoaded",t)}GRk(t){this.va.removeHandler("OnCoachResourcesLoaded",t)}Ikk(){const t=v.AFrameworkApplication.fa.Ga("CoachPackageCssUrl"),N=document.createElement("link");N.setAttribute("rel","stylesheet");N.setAttribute("type","text/css");N.setAttribute("href",t);$addHandler(N,"load",()=>{this.iUa=!0;dd.a("PollToRefreshCoachEntryPointOnRibbon")&&this.ZD&&this.ZD.JF();this.va.raiseEvent("OnCoachResourcesLoaded",new Sys.EventArgs);K.a.J(512496076,822,50,"RehearsalManager: Coach package loading time: {0}ms",
Date.now()-this.kGg)});document.body.appendChild(N)}zOk(){this.hb.ABc(Object(r.a)(this,this.K2g,"onSlideshowReady"));this.hb.INa(Object(r.a)(this,this.ifc,"onSlideShowPositionChanged"));this.hb.sha(Object(r.a)(this,this.tea,"onSlideshowExitHandler"));this.hb.BBc(Object(r.a)(this,this.Vva,"onSpecialKeyHandler"))}UGi(){this.hb.Oed(Object(r.a)(this,this.K2g,"onSlideshowReady"));this.hb.Dfb(Object(r.a)(this,this.ifc,"onSlideShowPositionChanged"));this.hb.Nea(Object(r.a)(this,this.tea,"onSlideshowExitHandler"));
this.hb.Ped(Object(r.a)(this,this.Vva,"onSpecialKeyHandler"))}Vva(t,N){N.key===ma.a.pLb&&this.IKe()}IKe(){if(0===this.pla){var t=this.fw.getCoachElement(Pe.mgg);t&&this.VIa(t)}else 2===this.pla?(t=this.fw.getCoachElement(Pe.Pwk))&&this.VIa(t):1===this.pla&&(t=this.fw.getCoachElement(Pe.FVj))&&this.VIa(t)}VIa(t){this.ada&&this.fw&&window.setTimeout(()=>{gc.FocusManager.Mr(t)},50)}Lz(t){try{const Ra=this.fw.getCoachElement(Pe.mgg),qb=this.fw.getCoachElement(Pe.EVj),Qb=this.fw.getCoachElement(Pe.HCl),
vc=this.fw.getCoachElement(Pe.$hk);if(t.keyCode===ma.a.Iq){if(!dd.a("PresenterCoachTabFix")){var N=!Qb&&!!Ra&&t.target===Ra||!!Qb&&t.target===Qb,ha=!!Ra&&!!qb&&qb.contains(t.target),za=!!vc&&t.target===vc;(N||ha||za)&&this.hb.restoreFocus()}}else t.keyCode===ma.a.mR||t.keyCode===ma.a.$0?(this.hb.prev(),this.IKe()):t.keyCode===ma.a.MO||t.keyCode===ma.a.Y0?(this.hb.next(),this.IKe()):t.keyCode===ma.a.lq||t.keyCode===ma.a.YKb||t.shiftKey||this.hb.restoreFocus()}catch(Ra){K.a.J(512496075,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",
Ra)}}LNk(){const t=this.fw.getCoachElement(Pe.jvi);if(dd.a("PresenterCoachTabFix")){var N=document.getElementById("HiddenFocusTrapAnchor");this.ada.insertBefore(t,N)}else N=document.getElementById("slideshowEndFocusTrap"),this.ada.insertBefore(t,N);t&&zd.a.addHandler(t,la.a.Xf,Object(r.a)(this,this.Lz,"keyDownHandler"))}$il(t){if(!this.ua.Ba)throw Error.argumentNull("ActiveSlide is null");Pe.czj();this.zOk();this.g_b()&&(this.Wx.ugd(),this.Wx.cSk(Object(r.a)(this,this.G1g,"onRehearsalOptOutSettingsRequestFinished")));
const N=new cq;this.KVa=Po(this.la,this.la.wwa);this.jL&&!this.la.pptRehearsalVisionEnabled&&K.a.J(512496074,822,10,"RehearsalManager::startRehearsalSession: vision enabled but BRS is disabled.");this.jL=this.jL&&this.la.pptRehearsalVisionEnabled;var ha=new Mo.a,za=Object(Q.a)(119,this.uc.VCa(this.ua.Ba.Bb.sid));N.currentSlideIndex=za?za.we:0;N.totalSlideCount=this.uc.Hj();za=this.k1i(N);this.fw=(new CoachActorPackage.CoachActorFactory).createCoachActorManager(za,ha);this.jL&&(this.i6c=this.fw.getRehearsalVideoElement(),
this.r6c=this.fw.getRehearsalVideoCanvas());this.zqe=t;t=this.f_d(N,this.i6c,this.r6c);this.MW=(new CoachPackage.CoachSessionFactory).createCoachManager(t);t=this.l1i();this.Yge=(new CoachActorPackage.CoachFREActorFactory).createCoachFREActorManager(t,ha);dd.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.IN.enumerateDevices(Object(r.a)(this,this.Cec,"onEnumerateDevicesSuccess"),Object(r.a)(this,this.IWa,"onDevicesFailure"),Object(r.a)(this,this.TWa,"onUnsupported"));this.DMk();this.EMk();
this.Cbc=0;this.eke=!1;this.LNk();2===this.zqe&&(ha=localStorage.getItem(Pe.mBe),this.WHg&&!ha?this.Quh():this.EPe())}EPe(){this.pla=0;this.pda.execute(t=>{t.JC(Jq.a.SubtitlesButton,!1);t.JC(Jq.a.LiveButton,!1);t.JC(Jq.a.CoachButton,!1);t.JC(Jq.a.MicButton,!1)});this.MW.startSession(!0)}Quh(){this.Yge.showCoachFREUI(t=>{localStorage.setItem(Pe.mBe,"true");this.mRg=t;this.EPe()})}Cec(t){this.T7b=0;if(t.length)for(var N of t)"audioinput"===N.kind&&(this.T7b+=1);else this.T7b=0;this.PHg=!0;t=new cq;
N=Object(Q.a)(119,this.uc.VCa(this.ua.Ba.Bb.sid));t.currentSlideIndex=N?N.we:0;t.totalSlideCount=this.uc.Hj();t=this.f_d(t,this.i6c,this.r6c);this.MW.updateSessionConfiguration(t)}IWa(t){K.a.J(512496073,822,50,"RehearsalManager::OnDevicesFailure unable to get devices. Error: {0}",t.toString())}TWa(){K.a.J(512496072,822,10,"RehearsalManager::OnDevicesUnsupported mediaDevices API not available for browser: {0}",Mc.a.zy)}K2g(){const t=localStorage.getItem(Pe.mBe);this.WHg&&!t?this.Quh():this.EPe()}ifc(t,
N){t=new cq;t.currentSlideIndex=N.slideIndex;t.totalSlideCount=this.uc.Hj();N=this.f_d(t,this.i6c,this.r6c);this.MW.updateSessionConfiguration(N);this.fw.updateCoachSlideComponent(t)}getTraceRequestMetadata(t,N){const ha={};if(t)for(let za in t)ha[za]=t[za];if(N)for(let za in N)ha[za]=N[za];t=Ed.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());ha.AudienceGroup=t.Ring||"Unknown";ha.BuildVersion=v.AFrameworkApplication.buildVersion||"Unknown";ha.ClientType="web";ha.IdentityProvider=
this.la.hostAuthType||v.AFrameworkApplication.fa.Ga("HostAuthType")||"Unknown";ha.Locale=this.la.UHa||"Unknown";ha.SpeechMode="rehearsal";ha.TenantId=v.AFrameworkApplication.fa.Ga("TenantId");ha.UserId=this.getUserId();ha.WacDatacenter=t.WACDatacenter||"Unknown";ha.WacHost=t.Host||"Unknown";ha.SourceLanguage=this.la.LQf||Qo(this.la.wwa);return ha}getUserId(){let t=v.AFrameworkApplication.fa.Ga("PptEditingUserId");gb.a.Va(t)&&(t=v.AFrameworkApplication.fa.Ga("LoggableUserId"),m.ULS.sendTraceTag(512496071,
822,50,"GetUserId PptEditingUserId is empty. LoggableUserId is null or empty {0}",gb.a.Va(t)));return t}e1k(){if(this.la.Nxk){var t=this.MW.getTraceRequestMetadata(),N=this.fw.getTraceRequestMetadata(),ha=this.la.pptEditorSpeechHandlerBaseUri.replace("wss","https");if(ha&&ha.length){var za=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",ha);ha=new XMLHttpRequest;ha.open("POST",za,!0);za=Be.a.create().toString();ha.setRequestHeader("X-Correlation",za);try{m.ULS.sendTraceTag(512496069,
822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",za);const Ra=this.getTraceRequestMetadata(t,N);ha.send(Ed.c(Ra))}catch(Ra){m.ULS.sendTraceTag(512496068,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",za)}}else m.ULS.sendTraceTag(512496070,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}}tea(){this.UGi();this.pla=3;this.MW.stopSession();this.Yge.hideCoachFREAndWelcomeUI();this.fw.hideCoachUI();this.nte=this.cge=!1;try{this.MW.getSessionSummary(t=>
{t.timeSpentInSeconds=this.Cbc;this.ia.processAction(vb.a.rJc,2);this.ia.processAction(vb.a.qJc,2);window.clearInterval(this.oPg);this.eke&&this.Bbc.instance.qJa(t,this.jL,this.KVa,this.Bqe,()=>{this.e1k()})})}catch(t){m.ULS.sendTraceTag(512496067,822,10,"OnSlideshowExitHandler - getSessionSummary failed. Exception:{0}",t)}}Ncj(){let t=",visionFace";this.la.NAk&&(t+=","+Pe.aCl+","+Pe.$Bl);this.la.OAk&&(t+=","+Pe.cCl+","+Pe.bCl);this.la.MAk&&(t+=","+Pe.XBl+","+Pe.YBl+","+Pe.ZBl);return Pe.zDl+(pm(this.KVa,
Pe.tXd)?","+Pe.tXd:"")+","+Pe.H1k+","+Pe.vxi+","+Pe.ktk+","+Pe.ozk+(this.la.nBe&&pm(this.KVa,Pe.N4d)?","+Pe.N4d:"")+(this.la.JAe&&pm(this.KVa,Pe.zue)?","+Pe.zue:"")+(this.la.pptRehearsalVisionEnabled&&pm(this.KVa,Pe.ZFh)?t:"")+(this.la.pptRehearsalPronunciationEnabled&&pm(this.KVa,Pe.MCe)?","+Pe.MCe:"")+(this.la.pptRehearsalCrutchWordsEnabled&&pm(this.KVa,Pe.$Rd)?","+Pe.$Rd:"")}f_d(t,N,ha){const za=new bt;za.disabledCoachRealtimeFeatures="";za.userSessionId=v.AFrameworkApplication.userSessionId;var Ra=
new mr;Ra.docId=v.AFrameworkApplication.hh;Ra.podsSessionId=this.Xa.podSessionId;Ra.userDataCenterClusterId=this.Xa.fk;Ra.webServiceBase=this.la.podsWebServiceBase;za.documentDownloadConfig=Ra;Ra=new Mo.a;za.logger=Ra;Ra={};Ra.currentSlideIndex=t.currentSlideIndex.toString();za.customSettings=Ra;za.fEnableServiceSideAggregationForCoach=this.la.Pbd;za.httpTimeoutForCoachSummaryData=this.la.ZAk;za.fSendClientMetaDataOnSessionStart=this.la.MMi;za.speechFDBase=this.la.pptEditorSpeechHandlerBaseUri;za.requestedCoachFeatures=
this.Ncj();this.g_b()&&(this.Bqe=this.Wx.Fdg(!0),za.requestedRehearsalOptOutFeatures=this.Bqe);dd.a("RehearsalTimeStampedCritiqueTelemetryEnabled")&&(za.enableTimeStampedCritiqueTelemetry=!0);za.entryPoint=kn[this.zqe];za.fEnableVision=this.jL;za.fEnableVision&&N&&ha&&(za.webcamConfig=Object.assign(new nr,{videoView:N,workingCanvas:ha,numFramesPerSecond:this.la.pptRehearsalVisionFramesPerSecond,webcamFrameWidth:this.la.QAk}));za.supportedRehearsalTemplates=this.fw.getSupportedRehearsalTemplates();
dd.a("PPTORehearsalLogAudioInputDeviceCountTelemetry")&&this.PHg&&(za.audioInputDeviceCount=this.T7b);t=Ed.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString());za.userId=this.getUserId();za.tenantId=v.AFrameworkApplication.fa.Ga("TenantId");za.identityProvider=this.la.hostAuthType||v.AFrameworkApplication.fa.Ga("HostAuthType")||"Unknown";za.audienceChannel="";za.audienceGroup=t.Ring||"Unknown";za.buildVersion=v.AFrameworkApplication.buildVersion||"Unknown";za.locale=this.la.UHa||
"Unknown";za.wacHost=t.Host||"Unknown";za.wacDatacenter=t.WACDatacenter||"Unknown";za.sourceLanguage=this.la.LQf||Qo(this.la.wwa);K.a.J(512496066,822,50,"getCoachSessionConfig: Language values are PodsUICulture: {0}, RegionalSettingsUserLanguage: {1}.",this.la.UHa,this.la.wwa);return za}l1i(){const t=new ln;t.rootContainer=this.ada;t.zIndex=Pe.Idh;t.imagesBaseFilePath=v.AFrameworkApplication.fa.Ga("CoachImagesBaseFilePath");return t}k1i(t){const N=new Yr;N.rootContainer=this.ada;N.slideState=t;N.imagesBaseFilePath=
v.AFrameworkApplication.fa.Ga("CoachImagesBaseFilePath");N.zIndex=Pe.Idh;N.fEnableVision=this.jL;N.fShowRealtimeFeedbackEnabledCheckbox=this.la.Mxk;N.fUseNewRealtimePanel=this.la.ped;N.fUseCountdownWelcomeScreen=v.AFrameworkApplication.fa.ka("PptCoachEnableCountdownWelcomeUI");N.speechFDBase=op(this.la.pptEditorSpeechHandlerBaseUri);N.fDontShowTooltips=Mc.a.eg;N.fUseNewRealtimeCheckbox=dd.a("UseNewRealtimeCheckbox");return N}Rxl(){2!==this.pla&&(this.Cbc+=1,this.fw&&this.fw.updateTimer(this.Cbc))}DMk(){this.fw.on("CoachSessionStarted",
()=>{this.pla=1;this.oPg=window.setInterval(Object(r.a)(this,this.Rxl,"updatePresentationTimer"),1E3);this.MW.enableVoiceStreaming();this.ofl();this.eke=!0});this.fw.on("CoachSessionPaused",()=>{this.pla=2;this.MW.pauseSession();this.via()&&this.Bl.instance.hide()});this.fw.on("CoachSessionResumed",()=>{this.pla=1;this.MW.resumeSession()})}EMk(){this.MW.on("SpeechRecognitionStarted",()=>{this.Vje&&this.via()&&(this.Bl.instance.hide(),this.Vje=!1)});this.MW.on("PPTCoachRealtimeNotification",t=>{this.Kmj(t)});
this.MW.on("QualityStatusChanged",t=>{this.$pj(t)});this.MW.on("MediaStatusChanged",t=>{this.Joj(t)});this.MW.on("Error",t=>{this.handleError(t)});this.MW.on("ConnectionRetry",()=>{this.Snj()})}Snj(){this.Vje=!0;this.via()&&this.Bl.instance.show(Pe.s8f,Qm.a.zWa)}Kmj(t){this.fw.updateCoachRealtimeNotification(t)}handleError(t){t=Object(Q.a)(String,t);this.pla=4;t?t.startsWith("ErrorAudio")?(this.fw&&this.fw.showCoachDisabledUI(0),this.via()&&this.Bl.instance.show(Pe.k2f,Qm.a.zWa)):t.startsWith("ErrorVideo")?
(this.fw&&this.fw.showCoachDisabledUI(1),this.via()&&this.Bl.instance.show(Pe.q2f,Qm.a.zWa)):K.a.J(512496064,822,10,"RehearsalManager::handleError unhandled errorInfo"):K.a.J(512496065,822,10,"RehearsalManager::handleError errorInfo null")}Kuh(){this.fw&&(this.jL&&this.fw.enableCoachVideoUI(),this.fw.showCoachRealtimeUI(this.mRg));this.via()&&this.Bl.instance.show(Pe.qYf,Qm.a.e8c)}Joj(t){"AudioDeviceConnected"===t.mediaStatus?(this.cge=!0,this.jL&&!this.nte||this.Kuh()):"VideoSetupCompleted"===t.mediaStatus&&
(this.nte=!0,this.cge&&(this.fw&&this.fw.enableCoachVideoUI(),this.Kuh()))}$pj(t){if(this.la.pptEditorVoiceUXEnabled){var N=t.severity,ha=t.shortCode;if(0<ha&&ha<Pe.nMf&&Pe.OX[ha])switch(N){case 0:this.via()&&this.Bl.instance.hide();break;case 1:(t=0<ha?Pe.OX[ha]:t.shortString)&&this.via()&&this.Bl.instance.show(t,Qm.a.bDb);break;case 2:(t=0<ha?Pe.OX[ha]:t.shortString)&&this.via()&&this.Bl.instance.show(t,Qm.a.zWa)}else K.a.J(512496035,822,10,"onQualityStatusChanged: Invalid short code")}}via(){return this.la.pptEditorVoiceUXEnabled&&
this.Bl&&this.Bl.instance&&2!==this.pla?!0:!1}ofl(){this.via()&&(this.Bl.instance.show(Pe.rYf,Qm.a.e8c),this.Hcc=window.setTimeout(Object(r.a)(this,this.H6d,"hideSoundReminderNotification"),3E3))}H6d(){this.via()&&(window.clearTimeout(this.Hcc),this.Bl.instance.hide())}g_b(){return this.la.LEb&&!!this.Wx}Sce(){return this.g_b()?this.vIg:!0}G1g(){this.vIg=!0;this.jL=this.Wx.RWd;dd.a("PollToRefreshCoachEntryPointOnRibbon")&&this.ZD&&this.ZD.JF()}}Object(h.a)(Kq,"RehearsalManager",null,[644]);class Jp{constructor(t,
N,ha){this.so=t;this.ia=N;this.la=ha}qJa(t,N,ha,za,Ra){try{const vc=document.createElement("div");vc.id="SummaryPageOverlay";vc.style.width="100%";vc.style.height="100%";vc.style.zIndex="999";vc.style.display="flex";vc.style.flexDirection="column";vc.style.justifyContent="center";vc.style.position="absolute";var qb=document.getElementById("SummaryPageOverlay");qb&&document.body.removeChild(qb);document.body.insertBefore(vc,document.body.firstChild);const Zc=vc.parentNode;zd.a.addHandler(Zc,la.a.Xf,
Object(r.a)(this,this.j1g,"onParentNodeKeyDownHandler"));var Qb=t.thumbIndices;if(Qb){qb={};let Xe=0;const of=this.Gfj(Qb);for(let ih=0;ih<Qb.length;ih++)qb[Qb[ih].toString()]=of[ih],of[ih]||Xe++;K.a.J(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",Qb.length,Xe);t.slideImageSrcs=qb}else t.slideImageSrcs={},K.a.J(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");
const Wc=v.AFrameworkApplication.sE;Wc||K.a.J(557424734,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback card is dsiabled");ha||(ha=Po(this.la,this.la.wwa));Qb={};const Md=Ed.b(v.AFrameworkApplication.fa.appSettings.SessionStartInfoJson.toString()).WACSessionID;Qb.fFeedbackCardEnabled=this.la.Oxk&&Wc;Qb.fShowFeedbackButton=Wc;Qb.fMonotoneEnabled=this.la.JAe&&pm(ha,Pe.zue);Qb.fGrammarEnabled=this.la.nBe&&pm(ha,Pe.N4d);Qb.fFillersCardEnabled=pm(ha,Pe.tXd);Qb.locale=this.la.wwa;Qb.fPronunciationCardEnabled=
this.la.pptRehearsalPronunciationEnabled&&pm(ha,Pe.MCe);Qb.fCrutchWordCardEnabled=this.la.pptRehearsalCrutchWordsEnabled&&pm(ha,Pe.$Rd);Qb.fVisionEnabled=N&&this.la.PAk&&this.la.pptRehearsalVisionEnabled;const Id=lr(this.la,this.la.wwa);gb.a.Va(Id)||(Qb.fPacingGaugeRange=Id);gb.a.Va(Md)||(Qb.clientSessionId=Md);this.la.LEb&&(Qb.rehearsalOptOutFeatures=za);(new rehearsalSummaryPage.RehearsalSummaryPageController(vc,t,()=>{K.a.J(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");
Ra&&Ra();this.ia&&(vc.parentNode.removeChild(vc),this.ia.La(vb.a.Kma,2,{entryPoint:3}))},()=>{Ra&&Ra();zd.a.removeHandler(Zc,la.a.Xf,Object(r.a)(this,this.j1g,"onParentNodeKeyDownHandler"))},this.la.podsWebServiceBase,decodeURIComponent(this.la.Yad),()=>{this.Fdl()},Qb,op(this.la.pptEditorSpeechHandlerBaseUri),"Web",()=>{this.cdl()})).renderSummaryPage()}catch(vc){K.a.J(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",vc.toString())}}j1g(t){"MainApp"===
t.target.id&&(t.preventDefault(),t.stopPropagation())}cdl(){K.a.J(556012420,817,50,"RehearsalSummaryPageHelper::ShowCoachSettingsTaskPane: Rehearsal opt out card clicked.");this.ia&&this.la.LEb&&this.ia.La(vb.a.Ijd,2,null)}Fdl(){K.a.J(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");this.ia&&(this.la.gAk?this.ia.La(vb.a.Ndh,2,null):this.ia.La(F.a.giveFeedback,2,!1))}Gfj(t){const N=Array(t.length);if(!this.so)return N;const ha=this.so.LK(),za=this.so.iRa();
for(let Ra=0;Ra<t.length;Ra++){const qb=za[ha[t[Ra]].sid.toString()];qb&&qb.thumbnailImage.length&&(N[Ra]=qb.thumbnailImage)}return N}}Object(h.a)(Jp,"RehearsalSummaryPageHelper",null,[]);class or{constructor(t,N,ha,za,Ra){this.iUa=!1;this.va=new Qk.a;this.ia=t;this.h0c=new Jp(N,this.ia,za);this.toe=ha;this.Q4c=Ra}ub(){this.ia.ya(vb.a.qJa,pb.a.application,Object(r.a)(this,this.rfl,"showSummaryPage"));this.ia.ya(vb.a.Ndh,pb.a.application,Object(r.a)(this,this.Mdl,"showFloodgateSurvey"))}qJa(t,N,ha,
za,Ra){this.h0c.qJa(t,N,ha,za,Ra)}rfl(t,N,ha,za,Ra){switch(ha){case 2:return this.h0c.qJa(Ra,!1,null,null,null),32;case 1:if(this.iUa)return 32;break;default:K.a.J(41793168,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8}Mdl(t,N,ha){switch(ha){case 2:return this.Q4c.execute(za=>{za.yIb("PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")}),32;case 1:if(this.iUa)return 32;break;default:K.a.J(42825479,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8}h7b(){const t=
Date.now();this.toe("rehearsalSummaryPage").then(()=>{const N=v.AFrameworkApplication.fa.Ga("RehearsalSummaryPageCssUrl"),ha=document.createElement("link");ha.setAttribute("rel","stylesheet");ha.setAttribute("type","text/css");ha.setAttribute("href",N);$addHandler(ha,"load",()=>{this.iUa=!0;this.va.raiseEvent("OnRehearsalSummaryResourcesLoaded",new Sys.EventArgs);K.a.J(555798673,817,50,"RehearsalSummaryPage: Loading time: {0}ms",Date.now()-t)});document.body.appendChild(ha);return null})}K6h(t){this.va.addHandler("OnRehearsalSummaryResourcesLoaded",
t)}eSk(t){this.va.removeHandler("OnRehearsalSummaryResourcesLoaded",t)}}Object(h.a)(or,"RehearsalSummaryPageActor",null,[642]);class Lq{constructor(t,N,ha,za,Ra){this.Cyg=this.dug=!1;this.ia=t;this.Ha=N;this.Aqe=ha;this.Bbc=za;this.lva=Ra;this.Aqe.execute(qb=>{qb.b6h(Object(r.a)(this,this.EZg,"onCoachResourcesLoaded"))});this.Bbc.execute(qb=>{qb.K6h(Object(r.a)(this,this.I1g,"onRehearsalSummaryResourcesLoaded"))})}dispose(){this.Aqe.instance&&this.Aqe.instance.GRk(Object(r.a)(this,this.EZg,"onCoachResourcesLoaded"));
this.Bbc.instance&&this.Bbc.instance.eSk(Object(r.a)(this,this.I1g,"onRehearsalSummaryResourcesLoaded"))}EZg(){this.dug=!0;this.Lzh()}I1g(){this.Cyg=!0;this.Lzh()}Lzh(){this.dug&&this.Cyg&&hb.a.get_instance().gk(10,null).continueWith(()=>{if(this.Ha.zrh&&this.Ha.LAk){const t=document.getElementById("rehearsal-loading-dialog-modal");t?(t.style.display="none",K.a.J(560468302,822,50,"Rehearsal Trigger: Hide rehearsal loading dialog")):K.a.J(560468303,822,10,"Rehearsal Trigger: Rehearsal deep link session triggered with no loading dialog element")}if(32===
this.ia.processAction(vb.a.Kma,1))if(this.Ha.zrh)this.ia.La(vb.a.Kma,2,{entryPoint:5});else if(!this.Ha.NS&&this.Ha.Z7g&&this.Ha.nAk)try{this.lva.continueWith(()=>{this.lva.result.logActivity("HasCoachInPresentDropDownSeen","PPTCoachInPresentDropDownTeachingUIEnabled")}),K.a.J(590120386,822,50,"Rehearsal Trigger: Teaching UI triggered for Coach in Present Drop Down")}catch(t){K.a.J(590120384,822,10,"Rehearsal Trigger: Exception thrown when trying to trigger teaching UI. Exception: {0}",t)}})}}Object(h.a)(Lq,
"RehearsalTrigger",null,[645]);class pr{constructor(){this.K=this.Wx=null}get name(){return"PowerPointWebEditor.Rehearsal"}jui(){this.K.register(642,"PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ma().na(()=>new or(v.AFrameworkApplication.Ta,this.K.resolve("PowerPointWebEditor.IThumbnailDataStoreManager"),yn.a(this.K),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.Ka("Common.ISystemInitiatedFeedback")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").ub()}Wb(t){this.K=
t;this.K.Ka("PowerPointWebEditor.IThumbnailDataStoreManager").execute(()=>{this.jui()});if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled){this.K.register(643,"PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings").ma().na(()=>new at(v.AFrameworkApplication.Ge,this.K.resolve("PowerPointWebEditor.IApplicationSettings"),this.K.resolve("PowerPointWebEditor.IJsonpHelperManager"),this.K.resolve("Common.IActionManagerExtended")));this.Wx=this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalFeedbackSettings");
const N=this.K.resolve("PowerPointWebEditor.Core.IPPTAppFrame");this.K.register(644,"PowerPointWebEditor.Rehearsal.IRehearsalManager").ma().na(()=>new Kq(v.AFrameworkApplication.Ta,N,this.K.resolve("Common.IDynamicScriptLoaderProvider"),this.K.resolve("PowerPointWebEditor.ISlideshowFrame"),this.K.resolve("PowerPointWebEditor.IPresentationReader"),this.K.resolve("PowerPointWebEditor.Graph.IGraphTopologyManager"),this.K.resolve("PowerPointWebEditor.ISessionInfoOwner"),this.K.resolve("PowerPointWebEditor.IApplicationSettings"),
u.a.instance.Ka("PowerPointWebEditor.ISlideShowVoiceNotification"),u.a.instance.Ka("PowerPointWebEditor.ISlideshowToolbar"),u.a.instance.Ka("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),this.Wx,this.K.resolve("PowerPointWebEditor.Core.IAudioSettingsContext"),this.K.resolve("PowerPointWebEditor.IRibbonUser")));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").ub();this.K.register(645,"PowerPointWebEditor.Rehearsal.IRehearsalTrigger").ma().na(()=>new Lq(v.AFrameworkApplication.Ta,
this.K.resolve("PowerPointWebEditor.IApplicationSettings"),u.a.instance.Ka("PowerPointWebEditor.Rehearsal.IRehearsalManager"),u.a.instance.Ka("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor"),rg.a.Ju(u.a.instance.Ka("Common.ISystemInitiatedFeedback"))));this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalTrigger")}}init(){v.AFrameworkApplication.fa.ff(Object(r.a)(this,this.Gm,"onFullAppSettingsReady"))}Gm(){this.K.resolve("PowerPointWebEditor.IApplicationSettings").t6b&&hb.a.get_instance().gk(7,
()=>{this.K.Ka("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").execute(()=>{this.initialize()})})}initialize(){this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor").h7b();this.K.resolve("PowerPointWebEditor.IApplicationSettings").pptEditorRehearsalSpeechClientEnabled&&this.K.resolve("PowerPointWebEditor.Rehearsal.IRehearsalManager").h7b();if(this.K.resolve("PowerPointWebEditor.IApplicationSettings").LEb){const t=new bq(this.K.resolve("Common.IDynamicScriptLoaderProvider").Jv,
this.K.resolve("Common.IActionManagerExtended"),this.K.resolve("PowerPointWebEditor.View.IFocusManagerHelper"),this.Wx,this.K.resolve("PowerPointWebEditor.IApplicationSettings"));t.ub();t.xe();this.Wx.eBj()}}dispose(){}static main(){e.a.instance.Bc(new pr)}}Object(h.a)(pr,"PPTWebEditorRehearsalPackage",null,[2,3]);class Me{constructor(){this.message=null;this.gv=0}}Object(h.a)(Me,"HttpRequstToPromiseRejectData",null,[]);class qr{constructor(t,N){this.tLh="https://consent.config.office.com/consentcheckin/v1.0/consents";
this.eb=t;this.$h=N}EXb(t,N,ha=null,za=null){return new Promise((Ra,qb)=>{const Qb=null!=ha?ha:this.eb.Cc("ApplicationFeatureHelperRequestQueueTimeout",1E3),vc=null!=za?za:this.eb.Cc("ApplicationFeatureHelperRequestSentTimeout",2E3);let Zc=this.eb.Ga("UCNoticeCheckinStateUrl");Zc&&Zc.length||(Zc=this.tLh);this.$h.sV(Zc,1,null,this.z0d(t),null,0,Wc=>{try{if(void 0===Wc||null===Wc||void 0===Wc.data||null===Wc.data||void 0===Wc.data.Sd||null===Wc.data.Sd){w.a.sendTelemetryEvent(Object.assign(new H.a,
{name:"Office.Online.UnifiedConsent.ConsentGetFailed",dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ConsentCheckinStatus: Invalid RequestSucceededEventArgs"})]}));let Id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}","UnifiedConsent.ConsentGetFailed");qb(this.Sia(Id,Wc))}else if(Wc.data.Le!==Jd.a.py){w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.UnifiedConsent.ConsentGetFailed",
dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ConsentCheckinStatus: HttpStatusCode_"+Wc.data.Le.toString()})]}));let Id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Wc.data.Le,"UnifiedConsent.ConsentGetFailed");qb(this.Sia(Id,Wc))}else{var Md=N(Wc.data.Sd);if(Md.KPd.length)Ra(Md);else{w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.UnifiedConsent.ConsentGetFailed",
dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ConsentCheckinStatus: UC Checkin status Parse Failure"})]}));let Id=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}","UnifiedConsent.ConsentGetFailed");qb(this.Sia(Id,Wc))}}}catch(Id){w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.UnifiedConsent.ConsentGetFailed",dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ConsentCheckinStatus: Unexpected Failure"})]})),
Md=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Id,"UnifiedConsent.ConsentGetFailed"),qb(this.Sia(Md,Wc))}},Wc=>{let Md;Wc.data?(w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.UnifiedConsent.ConsentGetFailed",dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ConsentCheckinStatus: HttpStatusCode_"+Wc.data.Le.toString()})]})),gb.a.ROc(Wc.data.Sd||"No Data"),Md=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, request - {1}",
Wc.data.Le,"UnifiedConsent.ConsentGetFailed")):(w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online.UnifiedConsent.ConsentGetFailed",dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ConsentCheckinStatus: Invalid RequestFailedEventArgs"})]})),Md=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}","UnifiedConsent.ConsentGetFailed"));qb(this.Sia(Md,Wc))},null,void 0,void 0,Qb,vc)})}Sia(t,N){const ha=
new Me;ha.message=t;ha.gv=N&&N.data?N.data.Le:-1;return ha}z0d(t){const N={},ha=this.eb.Ga("UICulture")||"en-US";N["Accept-Language"]=this.eb.Ga("DataCulture")||ha;N.consentsurface="AppStart";N.platform="Web";N.formfactor=this.eb.ka("IsMobileMode")?"Mobile":"Desktop";N["x-Cid"]=Be.a.create();N.Authorization="Bearer "+t;return N}}Object(h.a)(qr,"HttpRequestToPromiseUtility",null,[]);var Rm=d(1008);class vu{constructor(){this.accountType="MSA";this.modelType=null;this.appEnv=0;this.emailId=this.deviceId=
this.consentLanguage=this.appVersion=this.appId=this.appName=null;this.formFactor="Unknown";this.token=this.region=this.osVersion=this.os=null;this.useCache=!1;this.userId=null}}Object(h.a)(vu,"WebSdkAdapterProps",null,[]);class fm{constructor(t,N,ha,za){this.l7e=null;this.Kjb=za;this.eb=t;this.UJh=ha;this.$h=N}fdl(){"MSA"===this.eb.Ga("HostAuthType").toUpperCase()&&this.UJh.execute(t=>{t.KU("Consent",fm.EYh).then(N=>{if(N.IsSuccess){const ha=this.Q9i(this.T1i(N.Token));ha&&""!==ha&&t.KU("Consent",
fm.GYh).then(za=>{za.IsSuccess?this.Cel(za,ha):w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online."+fm.h1a,dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ShowConsentNotice: Web token error: "+za.ErrorCode+": "+za.ErrorMessage})]}));return{}})}else w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online."+fm.h1a,dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ShowConsentNotice: Checkin token error: "+N.ErrorCode+": "+N.ErrorMessage})]}));return{}})})}T1i(t){this.l7e=
new qr(this.eb,this.$h);let N=null,ha=null;try{ha=new Rm.a(Ua.a.instance);const za=this.eb.Ga("LoggableUserId")+this.eb.Ga("DataCulture")||this.eb.Ga("UICulture")||"en-US",Ra=ha.n0i(za);if(Ra&&0<Ra.length)return{ou:N}=Ed.d(Ra),N;this.l7e.EXb(t,Object(r.a)(this,this.qvk,"parseConsentCheckinState")).then(qb=>{qb.KPd[0].Igk&&!qb.KPd[0].dek||ha.W2k(za,Ed.c(qb));return qb},qb=>{w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online."+fm.h1a,dataFields:[Object.assign(new I.a,{name:"ErrorMessage",
string:"ShowConsentNotice: Checkin status error: "+qb.toString()})]}));return null});return null}catch(za){w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online."+fm.h1a,dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ShowConsentNotice: Checkin Api call failure"})]}))}return N}qvk(t){({ou:t}=Ed.d(t));return t}Q9i(t){if(t)for(const N of t.KPd)if(N.Igk&&!N.dek)return N.modelType;w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online."+fm.h1a,dataFields:[Object.assign(new I.a,
{name:"ErrorMessage",string:"ShowConsentNotice: modelType not found in the response"})]}));return null}Cel(t,N){if(rb.a("showConsentNotice")){const ha=document.createElement("div");document.body.appendChild(ha);appChrome.api.showConsentNotice(this.getDimensions(t.Token,N),ha)}else w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online."+fm.h1a,dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ShowConsentNotice: appChrome API not found"})]}))}getDimensions(t,N){const ha=this.eb.Ga("UICulture")||
"en-US",za=this.b8d(this.eb.Ga("SessionStartInfoJson"));return Object.assign(new vu,{token:t,modelType:N,emailId:this.eb.Ga("UserPrincipalName"),userId:this.eb.Ga("LoggableUserId"),accountType:"AAD"===this.eb.Ga("HostAuthType").toUpperCase()?"AAD":"MSA",appId:this.eb.Ga("OfficeApplicationId"),appVersion:this.eb.Ga("appVersion"),appName:"Application"in za?za.Application:"",appEnv:this.Kjb,consentLanguage:this.eb.Ga("DataCulture")||ha,formFactor:this.eb.ka("IsMobileMode")?"Mobile":"Desktop",os:"Os"in
za?za.Os:"",osVersion:"OsVersion"in za?za.OsVersion:"",region:this.eb.Ga("region"),useCache:!0})}b8d(t){let N={};try{N=Ed.b(t)}catch(ha){w.a.sendTelemetryEvent(Object.assign(new H.a,{name:"Office.Online."+fm.h1a,dataFields:[Object.assign(new I.a,{name:"ErrorMessage",string:"ShowConsentNotice: ShowConsentNotice session details not found: "+ha.message})]}))}return N}}fm.GYh="https://consentservice.microsoft.com/web";fm.EYh="https://consentservice.microsoft.com/checkin";fm.h1a="UnifiedConsent.ConsentGetFailed";
Object(h.a)(fm,"ConsentNoticeManager",null,[694]);class Zr{constructor(){this.Da=null}get name(){return"Common.App.ConsentNoticeDialog"}Wb(t){this.Da=t;t.register(fm,"Common.App.ConsentNoticeDialog.ConsentNoticeManager").as("Common.App.ConsentNoticeDialog.IConsentNoticeManager").ma().na(()=>new fm(v.AFrameworkApplication.fa,v.AFrameworkApplication.Ge,t.Ka("Common.App.OAuth.IOAuthManager"),v.AFrameworkApplication.RPa))}init(){this.Da.resolve("Common.App.ConsentNoticeDialog.IConsentNoticeManager")}dispose(){}static main(){e.a.instance.Bc(new Zr)}}
Object(h.a)(Zr,"ConsentNoticeDialogPackage",null,[2,3]);Type.registerNamespace("Box4.Media");Type.registerNamespace("Common.App.VersionHistory");Type.registerNamespace("PPTe");Type.registerNamespace("PowerPointLive");Type.registerNamespace("PowerPointVersionHistory");Type.registerNamespace("PowerPointWeb");Type.registerNamespace("PowerPointWebEditor");Type.registerNamespace("PowerPointWebEditor.Accessibility");Type.registerNamespace("PowerPointWebEditor.AgendaConverter");Type.registerNamespace("PowerPointWebEditor.Designer");
Type.registerNamespace("PowerPointWebEditor.ImageDescription");Type.registerNamespace("PowerPointWebEditor.Infrared");Type.registerNamespace("PowerPointWebEditor.Live");Type.registerNamespace("PowerPointWebEditor.PenMinutes");Type.registerNamespace("PowerPointWebEditor.PresentToTeams");Type.registerNamespace("PowerPointWebEditor.Rehearsal");Type.registerNamespace("PowerPointWebEditor.ReplaceObject");Type.registerNamespace("PowerPointWebEditor.StreamVideoPrefetchOrchestratorUtility");Type.registerNamespace("PowerPointWebEditor.Text");
Type.registerNamespace("PowerPointWebEditor.VersionHistory");Type.registerNamespace("Common.App.AccessibilityChecker");Uc.main();Ub.main();ld.main();Type.registerNamespace("Common.App.AddinCommands");Type.registerNamespace("Common.App.AccessibilitySettings");cd.main();Type.registerNamespace("Common.App.DirectPrint");e.a.instance.Bc(new qe);Type.registerNamespace("Common.App.DisplayEnvironmentName");Gf.main();Type.registerNamespace("Common.App.Embed");Type.registerNamespace("Common.App.InProductMessaging");
Qc.main();Type.registerNamespace("Common.App.NewAndOpen.UX");e.a.instance.Bc(new Cg);Type.registerNamespace("Common.App.OneDriveFilePickerApi");qf.main();Type.registerNamespace("Common.App.PenMinutesManager");ze.main();Type.registerNamespace("Common.App.SaveAsToHost");Rc.main();Type.registerNamespace("Common.App.SaveToSharePoint");Eh.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Qa.main();Type.registerNamespace("Common.App.SaveACopy");Fa.main();Type.registerNamespace("Common.App.PhoneLink");
Jb.main();Type.registerNamespace("Common.App.SharedFilePicker");Ld.main();Type.registerNamespace("Common.Search");Type.registerNamespace("Common.App.SearchOAuthManager");id.main();Type.registerNamespace("Common.App.WopiIdentity");qk.main();Type.registerNamespace("Common.App.AppsForOfficeOauth");Type.registerNamespace("Common.App.SmartLookup");Type.registerNamespace("Common.App.ConsentNoticeDialog");Zr.main();di.main();Cp.main();tk.main();sj.main();Vn.main();Pm.main();e.a.instance.Bc(hc.a(new Ze,0));
nk.main();Type.registerNamespace("Common.App.LivePersonaUtils");Ln.main();pr.main()},326:function(J,V,d){d.d(V,"a",function(){return D});J=d(0);var h=d(1166),e=d(40),m=d(472),r=d(165),v=d(37),A=d(61),w=d(26),y=d(966),u=d(967);class D{constructor(F){this.aH=F}get node(){return this.aH}get propertySet(){return this.aH}get yy(){if(1074135132===this.aH.Oe)return 0;if(1074135137===this.aH.Oe)return 1;w.a.J(18354962,802,10,"Invalid AppType {0}",m.a[this.aH.Oe]);return-1}get id(){return 0===this.yy?this.propertySet.sa(v.a.dZ,
null)+this.shapeId.toString()+this.slideId.toString():this.propertySet.sa(v.a.dZ,null)}get $Zf(){return this.propertySet.sa(e.a.QJd,null)}get visibility(){return this.propertySet.sa(e.a.xUb,!1)}get width(){return this.propertySet.sa(e.a.O$h,320)}get row(){return this.propertySet.sa(e.a.N$h,0)}get ktg(){return this.propertySet.sa(r.a.isForUILessAction,!1)}get vwa(){return this.propertySet.sa(e.a.Cob,null)}get version(){return this.propertySet.sa(e.a.oCc,null)}get store(){return this.propertySet.sa(e.a.nCc,
null)}get storeType(){return this.propertySet.getValue(v.a.uUb)}get ownerAddinSolutionId(){return this.propertySet.sa(v.a.B4g,null)}get sharedRuntimeId(){return this.propertySet.sa(r.a.sharedRuntimeId,null)}get settings(){const F={};y.a(this.node,(I,H)=>{u.b(H,F)});return F}get slideId(){if(0===this.yy){const F=this.aH.getValue(v.a.sid),I=this.aH.getValue(v.a.cid);return A.a.tE(F,I)}return null}get shapeId(){const F=Object(h.a)(4,this.aH);return 0===this.yy&&F?F.get_shapeId():0}get ownerAddinStoreType(){return this.propertySet.sa(v.a.ownerAddinStoreType,
null)}get Zob(){return this.propertySet.sa(v.a.Zob,-1)}get R3a(){return this.propertySet.sa(v.a.R3a,null)}}Object(J.a)(D,"AppReader",null,[813])},327:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.none=null;h.Hqi="CoAuth";h.f7d="IdeasPaneClosed";h.ogk="MultiSlidesSelected";h.Wfb="Retrigger";h.fhd="SessionEnded";h.e2k="SessionRehydrated";h.slideNavigation="SlideNavigation";h.$Ib="SuggestionPaneClosed";h.Fkd="SuggestionsLoadingTimeout";h.noSuggestion="NoSuggestion";h.typing="Typing";
h.hLb="WebActionId:";h.TOk="Rehydrated";h.kZf="DisallowedRequest";h.CQf="CloseSecondPane";h.xsk="OpenEditorPane";Object(J.a)(h,"DesignerResetReason",null,[])},328:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.invalid="Invalid";h.success="Success";h.error="Error";h.pending="Pending";h.nHa="NoResult";Object(J.a)(h,"ProviderResultStatus",null,[])},381:function(J,V,d){J=d(0);class h{static u$i(){return h._nextEventReceiverId++}}h._nextEventReceiverId=0;Object(J.a)(h,"EventReceiverIdCounter",
null,[]);d.d(V,"a",function(){return e});class e{constructor(m,r){this.qNh=m;this._id=h.u$i();this.WVh=r}get id(){return this._id}notify(m,r){this.WVh(m,r)}ica(m,r){return this.qNh.VEk(m,r?this:null)}}Object(J.a)(e,"EventReceiver",null,[836])},530:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"OnlineMediaSearchResult",null,[])},531:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);var h;(function(e){e[e.notSupported=0]="notSupported";e[e.launchByLocalCacheInitializer=
1]="launchByLocalCacheInitializer";e[e.launchByAnonymousApiInitializer=2]="launchByAnonymousApiInitializer";e[e.launchByInsertion=3]="launchByInsertion";e[e.launchByRefresh=4]="launchByRefresh";e[e.launchByLastUpdateInitializer=5]="launchByLastUpdateInitializer";e[e.launchByDynamicCall=6]="launchByDynamicCall"})(h||(h={}));Object(J.b)("AddinCommandsLaunchOperationType",h)},532:function(J,V,d){d.d(V,"a",function(){return m});J=d(0);var h=d(376),e=d(231);class m{static obl(r){return parseInt(m.FTe(e.a.OFf,
r)||"-1")<=(new Date).getTime()}static z8f(r){return parseInt(m.FTe(e.a.oob,r)||"-1")}static Ukg(r){return Boolean.parse(m.FTe(e.a.gUb,r)||"false")}static FTe(r,v){let A=null;try{const w=m.ZNc();if(void 0!==w&&w){const y=e.a.y8f(r)+v;A=w.getItem(y)}else h.ULS.sendTraceTag(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(w){h.ULS.sendTraceTag(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",r,v)}return A}static kKb(r,v,A){try{const w=
m.ZNc();if(void 0!==w&&w){const y=e.a.y8f(r)+A;w.setItem(y,v)}else h.ULS.sendTraceTag(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(w){h.ULS.sendTraceTag(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",r,A)}}static ZNc(){if(!m.e3b)return null;let r=null;try{r=localStorage}catch(v){m.e3b=!1,r=null}return r}}m.e3b=!0;Object(J.a)(m,"AddinUtil",null,[])},533:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(e,
m){this.e8j=e;this.M9j=m}get PUc(){return this.e8j}get RVk(){return this.M9j}}Object(J.a)(h,"ReportSuggestionSessionActionData",null,[])},534:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}h.i0f="Provider.UCI.Editor";h.c0f="EntityGroup.UCI.Editor";h.Oth="Provider.Designer.Slide";h.Nth="EntityGroup.Designer.Slide.Suggestion";h.Xth="Provider.Designer.TextToSmartArt";h.Wth="EntityGroup.Designer.TextToSmartArt.Suggestion";Object(J.a)(h,"InfraredConstant",null,[])},677:function(J,V,d){d.d(V,
"a",function(){return e});J=d(0);var h=d(66);class e{constructor(m){this.O8=this.Fka=null;this.De=m}dispose(){this.clear();this.Fka.parentNode.removeChild(this.Fka)}Iha(m){this.Fka=this.zXb(m,"prContainerHr");this.O8=this.zXb(this.Fka,"prGlyph")}clear(){this.Oma()}nna(m,r){m&&(this.Oma(),this.O8.appendChild(m),this.O8.style.backgroundColor=r,this.Fka.style.visibility=h.a.visible)}zXb(m,r){const v=this.De.Ce();this.De.addCssClass(v,r);m.appendChild(v);return v}Oma(){this.O8.firstChild&&this.O8.removeChild(this.O8.firstChild)}}
Object(J.a)(e,"ShapePawnGlyph",null,[])},684:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"ProviderActionInfo",null,[])},685:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.ActiveSlideSid=this.ActiveSlideCid=0;this.Label=this.CorrelationId=null;this.ShapeId=this.ReplaceObjectType=0;this.SmartArtSubNodeId=null;this.SuggestionSid=0}}Object(J.a)(h,"ReplaceObjectSuggestionApplyInfo",null,[])},963:function(J,V,d){d.d(V,"a",function(){return h});
J=d(0);class h{static add(e,m,r,v,A){h.hFg[h.n8f(e,m,r,v,A)]=!0}static contains(e,m,r,v,A){return h.n8f(e,m,r,v,A)in h.hFg}static n8f(e,m,r,v,A){return String.format("{0}|{1}|{2}|{3}|{4}",e.toLowerCase(),m,r.toLowerCase(),v.toLowerCase(),A.toLowerCase())}}h.hFg={};Object(J.a)(h,"AppsInsertedStorage",null,[])},964:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{}Object(J.a)(h,"AppsForOfficeEntitlementQueryInfo",null,[])},965:function(J,V,d){d.d(V,"a",function(){return D});J=d(0);var h=
d(101),e=d(1166),m=d(36),r=d(40),v=d(30),A=d(81),w=d(241),y=d(37),u=d(966);class D{static Vxi(F,I,H){F=Object(e.a)(A.a,F.createInstance(1074135137));D.RDf(F,I,H);return F}static K0h(F,I){v.GraphIterator.mb(F).pl(I,19)}static RDf(F,I,H){F.setValue(r.a.jCc,0===I.targetType);F.setValue(r.a.Cob,I.solutionId);F.setValue(r.a.oCc,I.version);F.setValue(r.a.vUb,I.storeType);F.setValue(r.a.nCc,I.storeId);F.setValue(y.a.uUb,H.$Fc(I.storeType));I.assetId&&F.setValue(y.a.JJd,I.assetId);F.setValue(y.a.NGf,I.assetStoreId);
void 0===I.isAddinCommands?F.setValue(y.a.isAddinCommands,!1):F.setValue(y.a.isAddinCommands,I.isAddinCommands);I.sharedRuntimeId&&-1!==I.backgroundState&&(F.setValue(y.a.Zob,I.backgroundState),F.setValue(y.a.R3a,I.sharedRuntimeId));0===I.targetType&&(F.setValue(y.a.Uq,!0),H=I.height?I.height:200,F.setValue(m.a.Rx,I.width?I.width:200),F.setValue(m.a.KD,H))}static GCh(F,I,H){const L=h.a.Alc(H);u.b(I,aa=>{aa=aa.getValue(r.a.lCc);return!!aa&&!(aa in L)});u.a(I,(aa,Q)=>{const O=Q.getValue(r.a.lCc);O&&
O in L&&(D.Uul(Q,L[O],aa),delete L[O])});const E=v.GraphIterator.mb(I);h.a.forEach(L,(aa,Q)=>{E.pl(D.Wxi(F,aa,Q),21)},null)}static Wxi(F,I,H){F=Object(e.a)(A.a,F.createInstance(1074135139));F.setValue(r.a.lCc,I);F.setValue(r.a.mCc,H);return F}static Uul(F,I,H){F.setValue(r.a.mCc,I);H.sa(r.a.jCc,!0)?w.d(H,F,D.NYk):w.d(H,F,D.fZk)}}D.NYk=[y.a.sid,y.a.cid,y.a.shapeId];D.fZk=[r.a.Cob];Object(J.a)(D,"AppEditor",null,[])},966:function(J,V,d){d.d(V,"a",function(){return m});d.d(V,"b",function(){return r});
var h=d(30),e=d(967);const m=(v,A)=>{const w=new h.GraphIterator;w.set(v);let y=w.Ab(21);for(;y;)e.a(y)&&A(v,y),y=w.vf(21)},r=(v,A)=>{const w=new h.GraphIterator;w.set(v);let y=w.Ab(21);for(;y&&y!==v;)y=e.a(y)&&A(y)?w.rPa(21):w.zj(21)}},967:function(J,V,d){d.d(V,"b",function(){return e});d.d(V,"a",function(){return m});var h=d(40);const e=(r,v)=>{const A=r.getValue(h.a.lCc);r=r.getValue(h.a.mCc);v[A]=r},m=r=>1074135139===r.Oe},968:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,
m,r=null){super();this.shapeId=e;this.Fng=m;this.jY=r}}Object(J.a)(h,"ReplaceObjectSuggestionPointerOverEventArgs",Sys.EventArgs,[])},969:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h extends Sys.EventArgs{constructor(e,m=null){super();this.shapeId=e;this.jY=m}}Object(J.a)(h,"ReplaceObjectSuggestionPointerOutEventArgs",Sys.EventArgs,[])},970:function(J,V,d){d.d(V,"a",function(){return h});J=d(0);class h{constructor(){this.wCc=null}}Object(J.a)(h,"IdeasSmartArtSuggestionWrapper",null,
[])}}]);

//# sourceMappingURL=https://res-dev.cdn.officeppe.net/1js/build/17844168/wdjs/ppteditDS.chronos2.js.map